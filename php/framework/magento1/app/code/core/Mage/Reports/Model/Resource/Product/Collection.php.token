[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Reports\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Products Report collection\n *\n * @category    Mage\n * @package     Mage_Reports\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Reports_Model_Resource_Product_Collection",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Catalog_Model_Resource_Product_Collection",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_CONST","const",37],["T_WHITESPACE"," ",37],["T_STRING","SELECT_COUNT_SQL_TYPE_CART",37],["T_WHITESPACE","           ",37],"=",["T_WHITESPACE"," ",37],["T_LNUMBER","1",37],";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * Product entity identifier\n     *\n     * @var int\n     *\/",39],["T_WHITESPACE","\n    ",43],["T_PROTECTED","protected",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$_productEntityId",44],";",["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * Product entity table name\n     *\n     * @var string\n     *\/",46],["T_WHITESPACE","\n    ",50],["T_PROTECTED","protected",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$_productEntityTableName",51],";",["T_WHITESPACE","\n\n    ",51],["T_DOC_COMMENT","\/**\n     * Product entity type identifier\n     *\n     * @var int\n     *\/",53],["T_WHITESPACE","\n    ",57],["T_PROTECTED","protected",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$_productEntityTypeId",58],";",["T_WHITESPACE","\n\n    ",58],["T_DOC_COMMENT","\/**\n     * select count\n     *\n     * @var int\n     *\/",60],["T_WHITESPACE","\n    ",64],["T_PROTECTED","protected",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$_selectCountSqlType",65],["T_WHITESPACE","               ",65],"=",["T_WHITESPACE"," ",65],["T_LNUMBER","0",65],";",["T_WHITESPACE","\n\n    ",65],["T_DOC_COMMENT","\/**\n     * Init main class options\n     *\n     *\/",67],["T_WHITESPACE","\n    ",70],["T_PUBLIC","public",71],["T_WHITESPACE"," ",71],["T_FUNCTION","function",71],["T_WHITESPACE"," ",71],["T_STRING","__construct",71],"(",")",["T_WHITESPACE","\n    ",71],"{",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$product",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_STRING","Mage",73],["T_DOUBLE_COLON","::",73],["T_STRING","getResourceSingleton",73],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",73],")",";",["T_WHITESPACE","\n        ",73],["T_COMMENT","\/* @var $product Mage_Catalog_Model_Entity_Product *\/",74],["T_WHITESPACE","\n        ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","setProductEntityId",75],"(",["T_VARIABLE","$product",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getEntityIdField",75],"(",")",")",";",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","setProductEntityTableName",76],"(",["T_VARIABLE","$product",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getEntityTable",76],"(",")",")",";",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","setProductEntityTypeId",77],"(",["T_VARIABLE","$product",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getTypeId",77],"(",")",")",";",["T_WHITESPACE","\n\n        ",77],["T_STRING","parent",79],["T_DOUBLE_COLON","::",79],["T_STRING","__construct",79],"(",")",";",["T_WHITESPACE","\n    ",79],"}",["T_WHITESPACE","\n    ",80],["T_DOC_COMMENT","\/**\n     * Set Type for COUNT SQL Select\n     *\n     * @param int $type\n     * @return Mage_Reports_Model_Resource_Product_Collection\n     *\/",81],["T_WHITESPACE","\n    ",86],["T_PUBLIC","public",87],["T_WHITESPACE"," ",87],["T_FUNCTION","function",87],["T_WHITESPACE"," ",87],["T_STRING","setSelectCountSqlType",87],"(",["T_VARIABLE","$type",87],")",["T_WHITESPACE","\n    ",87],"{",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","_selectCountSqlType",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$type",89],";",["T_WHITESPACE","\n        ",89],["T_RETURN","return",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],";",["T_WHITESPACE","\n    ",90],"}",["T_WHITESPACE","\n\n    ",91],["T_DOC_COMMENT","\/**\n     * Set product entity id\n     *\n     * @param int $value\n     * @return Mage_Reports_Model_Resource_Product_Collection\n     *\/",93],["T_WHITESPACE","\n    ",98],["T_PUBLIC","public",99],["T_WHITESPACE"," ",99],["T_FUNCTION","function",99],["T_WHITESPACE"," ",99],["T_STRING","setProductEntityId",99],"(",["T_VARIABLE","$entityId",99],")",["T_WHITESPACE","\n    ",99],"{",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","_productEntityId",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_INT_CAST","(int)",101],["T_VARIABLE","$entityId",101],";",["T_WHITESPACE","\n        ",101],["T_RETURN","return",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],";",["T_WHITESPACE","\n    ",102],"}",["T_WHITESPACE","\n\n    ",103],["T_DOC_COMMENT","\/**\n     * Get product entity id\n     *\n     * @return int\n     *\/",105],["T_WHITESPACE","\n    ",109],["T_PUBLIC","public",110],["T_WHITESPACE"," ",110],["T_FUNCTION","function",110],["T_WHITESPACE"," ",110],["T_STRING","getProductEntityId",110],"(",")",["T_WHITESPACE","\n    ",110],"{",["T_WHITESPACE","\n        ",111],["T_RETURN","return",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","_productEntityId",112],";",["T_WHITESPACE","\n    ",112],"}",["T_WHITESPACE","\n\n    ",113],["T_DOC_COMMENT","\/**\n     * Set product entity table name\n     *\n     * @param string $value\n     * @return Mage_Reports_Model_Resource_Product_Collection\n     *\/",115],["T_WHITESPACE","\n    ",120],["T_PUBLIC","public",121],["T_WHITESPACE"," ",121],["T_FUNCTION","function",121],["T_WHITESPACE"," ",121],["T_STRING","setProductEntityTableName",121],"(",["T_VARIABLE","$value",121],")",["T_WHITESPACE","\n    ",121],"{",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","_productEntityTableName",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$value",123],";",["T_WHITESPACE","\n        ",123],["T_RETURN","return",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],";",["T_WHITESPACE","\n    ",124],"}",["T_WHITESPACE","\n\n    ",125],["T_DOC_COMMENT","\/**\n     * Get product entity table name\n     *\n     * @return string\n     *\/",127],["T_WHITESPACE","\n    ",131],["T_PUBLIC","public",132],["T_WHITESPACE"," ",132],["T_FUNCTION","function",132],["T_WHITESPACE"," ",132],["T_STRING","getProductEntityTableName",132],"(",")",["T_WHITESPACE","\n    ",132],"{",["T_WHITESPACE","\n        ",133],["T_RETURN","return",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","_productEntityTableName",134],";",["T_WHITESPACE","\n    ",134],"}",["T_WHITESPACE","\n\n    ",135],["T_DOC_COMMENT","\/**\n     * Set product entity type id\n     *\n     * @param int $value\n     * @return Mage_Reports_Model_Resource_Product_Collection\n     *\/",137],["T_WHITESPACE","\n    ",142],["T_PUBLIC","public",143],["T_WHITESPACE"," ",143],["T_FUNCTION","function",143],["T_WHITESPACE"," ",143],["T_STRING","setProductEntityTypeId",143],"(",["T_VARIABLE","$value",143],")",["T_WHITESPACE","\n    ",143],"{",["T_WHITESPACE","\n        ",144],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","_productEntityTypeId",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_VARIABLE","$value",145],";",["T_WHITESPACE","\n        ",145],["T_RETURN","return",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$this",146],";",["T_WHITESPACE","\n    ",146],"}",["T_WHITESPACE","\n\n    ",147],["T_DOC_COMMENT","\/**\n     * Get product entity tyoe id\n     *\n     * @return int\n     *\/",149],["T_WHITESPACE","\n    ",153],["T_PUBLIC","public",154],["T_WHITESPACE"," ",154],["T_FUNCTION","function",154],["T_WHITESPACE"," ",154],["T_STRING","getProductEntityTypeId",154],"(",")",["T_WHITESPACE","\n    ",154],"{",["T_WHITESPACE","\n        ",155],["T_RETURN","return",156],["T_WHITESPACE","  ",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","_productEntityTypeId",156],";",["T_WHITESPACE","\n    ",156],"}",["T_WHITESPACE","\n\n    ",157],["T_DOC_COMMENT","\/**\n     * Join fields\n     *\n     * @return Mage_Reports_Model_Resource_Product_Collection\n     *\/",159],["T_WHITESPACE","\n    ",163],["T_PROTECTED","protected",164],["T_WHITESPACE"," ",164],["T_FUNCTION","function",164],["T_WHITESPACE"," ",164],["T_STRING","_joinFields",164],"(",")",["T_WHITESPACE","\n    ",164],"{",["T_WHITESPACE","\n        ",165],["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","_totals",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_NEW","new",166],["T_WHITESPACE"," ",166],["T_STRING","Varien_Object",166],"(",")",";",["T_WHITESPACE","\n\n        ",166],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","addAttributeToSelect",168],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",168],")",["T_WHITESPACE","\n            ",168],["T_OBJECT_OPERATOR","->",169],["T_STRING","addAttributeToSelect",169],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",169],")",["T_WHITESPACE","\n            ",169],["T_OBJECT_OPERATOR","->",170],["T_STRING","addAttributeToSelect",170],"(",["T_CONSTANT_ENCAPSED_STRING","'price'",170],")",";",["T_WHITESPACE","\n\n        ",170],["T_RETURN","return",172],["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],";",["T_WHITESPACE","\n    ",172],"}",["T_WHITESPACE","\n\n    ",173],["T_DOC_COMMENT","\/**\n     * Get select count sql\n     *\n     * @return unknown\n     *\/",175],["T_WHITESPACE","\n    ",179],["T_PUBLIC","public",180],["T_WHITESPACE"," ",180],["T_FUNCTION","function",180],["T_WHITESPACE"," ",180],["T_STRING","getSelectCountSql",180],"(",")",["T_WHITESPACE","\n    ",180],"{",["T_WHITESPACE","\n        ",181],["T_IF","if",182],["T_WHITESPACE"," ",182],"(",["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","_selectCountSqlType",182],["T_WHITESPACE"," ",182],["T_IS_EQUAL","==",182],["T_WHITESPACE"," ",182],["T_STRING","self",182],["T_DOUBLE_COLON","::",182],["T_STRING","SELECT_COUNT_SQL_TYPE_CART",182],")",["T_WHITESPACE"," ",182],"{",["T_WHITESPACE","\n            ",182],["T_VARIABLE","$countSelect",183],["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_CLONE","clone",183],["T_WHITESPACE"," ",183],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","getSelect",183],"(",")",";",["T_WHITESPACE","\n            ",183],["T_VARIABLE","$countSelect",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","reset",184],"(",")",["T_WHITESPACE","\n                ",184],["T_OBJECT_OPERATOR","->",185],["T_STRING","from",185],"(",["T_WHITESPACE","\n                    ",185],["T_ARRAY","array",186],"(",["T_CONSTANT_ENCAPSED_STRING","'quote_item_table'",186],["T_WHITESPACE"," ",186],["T_DOUBLE_ARROW","=>",186],["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","getTable",186],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/quote_item'",186],")",")",",",["T_WHITESPACE","\n                    ",186],["T_ARRAY","array",187],"(",["T_CONSTANT_ENCAPSED_STRING","'COUNT(DISTINCT quote_item_table.product_id)'",187],")",")",["T_WHITESPACE","\n                ",187],["T_OBJECT_OPERATOR","->",188],["T_STRING","join",188],"(",["T_WHITESPACE","\n                    ",188],["T_ARRAY","array",189],"(",["T_CONSTANT_ENCAPSED_STRING","'quote_table'",189],["T_WHITESPACE"," ",189],["T_DOUBLE_ARROW","=>",189],["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getTable",189],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/quote'",189],")",")",",",["T_WHITESPACE","\n                    ",189],["T_CONSTANT_ENCAPSED_STRING","'quote_table.entity_id = quote_item_table.quote_id AND quote_table.is_active = 1'",190],",",["T_WHITESPACE","\n                    ",190],["T_ARRAY","array",191],"(",")",["T_WHITESPACE","\n                ",191],")",";",["T_WHITESPACE","\n            ",192],["T_RETURN","return",193],["T_WHITESPACE"," ",193],["T_VARIABLE","$countSelect",193],";",["T_WHITESPACE","\n        ",193],"}",["T_WHITESPACE","\n\n        ",194],["T_VARIABLE","$countSelect",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_CLONE","clone",196],["T_WHITESPACE"," ",196],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","getSelect",196],"(",")",";",["T_WHITESPACE","\n        ",196],["T_VARIABLE","$countSelect",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","reset",197],"(",["T_STRING","Zend_Db_Select",197],["T_DOUBLE_COLON","::",197],["T_STRING","ORDER",197],")",";",["T_WHITESPACE","\n        ",197],["T_VARIABLE","$countSelect",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","reset",198],"(",["T_STRING","Zend_Db_Select",198],["T_DOUBLE_COLON","::",198],["T_STRING","LIMIT_COUNT",198],")",";",["T_WHITESPACE","\n        ",198],["T_VARIABLE","$countSelect",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","reset",199],"(",["T_STRING","Zend_Db_Select",199],["T_DOUBLE_COLON","::",199],["T_STRING","LIMIT_OFFSET",199],")",";",["T_WHITESPACE","\n        ",199],["T_VARIABLE","$countSelect",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","reset",200],"(",["T_STRING","Zend_Db_Select",200],["T_DOUBLE_COLON","::",200],["T_STRING","COLUMNS",200],")",";",["T_WHITESPACE","\n        ",200],["T_VARIABLE","$countSelect",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","reset",201],"(",["T_STRING","Zend_Db_Select",201],["T_DOUBLE_COLON","::",201],["T_STRING","GROUP",201],")",";",["T_WHITESPACE","\n        ",201],["T_VARIABLE","$countSelect",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","reset",202],"(",["T_STRING","Zend_Db_Select",202],["T_DOUBLE_COLON","::",202],["T_STRING","HAVING",202],")",";",["T_WHITESPACE","\n        ",202],["T_VARIABLE","$countSelect",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","columns",203],"(",["T_CONSTANT_ENCAPSED_STRING","\"count(DISTINCT e.entity_id)\"",203],")",";",["T_WHITESPACE","\n\n        ",203],["T_RETURN","return",205],["T_WHITESPACE"," ",205],["T_VARIABLE","$countSelect",205],";",["T_WHITESPACE","\n    ",205],"}",["T_WHITESPACE","\n\n    ",206],["T_DOC_COMMENT","\/**\n     * Add carts count\n     *\n     * @return Mage_Reports_Model_Resource_Product_Collection\n     *\/",208],["T_WHITESPACE","\n    ",212],["T_PUBLIC","public",213],["T_WHITESPACE"," ",213],["T_FUNCTION","function",213],["T_WHITESPACE"," ",213],["T_STRING","addCartsCount",213],"(",")",["T_WHITESPACE","\n    ",213],"{",["T_WHITESPACE","\n        ",214],["T_VARIABLE","$countSelect",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_CLONE","clone",215],["T_WHITESPACE"," ",215],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","getSelect",215],"(",")",";",["T_WHITESPACE","\n        ",215],["T_VARIABLE","$countSelect",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","reset",216],"(",")",";",["T_WHITESPACE","\n\n        ",216],["T_VARIABLE","$countSelect",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","from",218],"(",["T_ARRAY","array",218],"(",["T_CONSTANT_ENCAPSED_STRING","'quote_items'",218],["T_WHITESPACE"," ",218],["T_DOUBLE_ARROW","=>",218],["T_WHITESPACE"," ",218],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","getTable",218],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/quote_item'",218],")",")",",",["T_WHITESPACE"," ",218],["T_CONSTANT_ENCAPSED_STRING","'COUNT(*)'",218],")",["T_WHITESPACE","\n            ",218],["T_OBJECT_OPERATOR","->",219],["T_STRING","join",219],"(",["T_ARRAY","array",219],"(",["T_CONSTANT_ENCAPSED_STRING","'quotes'",219],["T_WHITESPACE"," ",219],["T_DOUBLE_ARROW","=>",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","getTable",219],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/quote'",219],")",")",",",["T_WHITESPACE","\n                ",219],["T_CONSTANT_ENCAPSED_STRING","'quotes.entity_id = quote_items.quote_id AND quotes.is_active = 1'",220],",",["T_WHITESPACE","\n                ",220],["T_ARRAY","array",221],"(",")",")",["T_WHITESPACE","\n            ",221],["T_OBJECT_OPERATOR","->",222],["T_STRING","where",222],"(",["T_CONSTANT_ENCAPSED_STRING","\"quote_items.product_id = e.entity_id\"",222],")",";",["T_WHITESPACE","\n\n        ",222],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","getSelect",224],"(",")",["T_WHITESPACE","\n            ",224],["T_OBJECT_OPERATOR","->",225],["T_STRING","columns",225],"(",["T_ARRAY","array",225],"(",["T_CONSTANT_ENCAPSED_STRING","\"carts\"",225],["T_WHITESPACE"," ",225],["T_DOUBLE_ARROW","=>",225],["T_WHITESPACE"," ",225],"\"",["T_ENCAPSED_AND_WHITESPACE","(",225],["T_CURLY_OPEN","{",225],["T_VARIABLE","$countSelect",225],"}",["T_ENCAPSED_AND_WHITESPACE",")",225],"\"",")",")",["T_WHITESPACE","\n            ",225],["T_OBJECT_OPERATOR","->",226],["T_STRING","group",226],"(","\"",["T_ENCAPSED_AND_WHITESPACE","e.",226],["T_CURLY_OPEN","{",226],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","getProductEntityId",226],"(",")","}","\"",")",["T_WHITESPACE","\n            ",226],["T_OBJECT_OPERATOR","->",227],["T_STRING","having",227],"(",["T_CONSTANT_ENCAPSED_STRING","'carts > ?'",227],",",["T_WHITESPACE"," ",227],["T_LNUMBER","0",227],")",";",["T_WHITESPACE","\n\n        ",227],["T_RETURN","return",229],["T_WHITESPACE"," ",229],["T_VARIABLE","$this",229],";",["T_WHITESPACE","\n    ",229],"}",["T_WHITESPACE","\n\n    ",230],["T_DOC_COMMENT","\/**\n     * Add orders count\n     *\n     * @param string $from\n     * @param string $to\n     * @return Mage_Reports_Model_Resource_Product_Collection\n     *\/",232],["T_WHITESPACE","\n    ",238],["T_PUBLIC","public",239],["T_WHITESPACE"," ",239],["T_FUNCTION","function",239],["T_WHITESPACE"," ",239],["T_STRING","addOrdersCount",239],"(",["T_VARIABLE","$from",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_CONSTANT_ENCAPSED_STRING","''",239],",",["T_WHITESPACE"," ",239],["T_VARIABLE","$to",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_CONSTANT_ENCAPSED_STRING","''",239],")",["T_WHITESPACE","\n    ",239],"{",["T_WHITESPACE","\n        ",240],["T_VARIABLE","$orderItemTableName",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","getTable",241],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order_item'",241],")",";",["T_WHITESPACE","\n        ",241],["T_VARIABLE","$productFieldName",242],["T_WHITESPACE","   ",242],"=",["T_WHITESPACE"," ",242],["T_STRING","sprintf",242],"(",["T_CONSTANT_ENCAPSED_STRING","'e.%s'",242],",",["T_WHITESPACE"," ",242],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","getProductEntityId",242],"(",")",")",";",["T_WHITESPACE","\n\n        ",242],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","getSelect",244],"(",")",["T_WHITESPACE","\n            ",244],["T_OBJECT_OPERATOR","->",245],["T_STRING","joinLeft",245],"(",["T_WHITESPACE","\n                ",245],["T_ARRAY","array",246],"(",["T_CONSTANT_ENCAPSED_STRING","'order_items'",246],["T_WHITESPACE"," ",246],["T_DOUBLE_ARROW","=>",246],["T_WHITESPACE"," ",246],["T_VARIABLE","$orderItemTableName",246],")",",",["T_WHITESPACE","\n                ",246],"\"",["T_ENCAPSED_AND_WHITESPACE","order_items.product_id = ",247],["T_CURLY_OPEN","{",247],["T_VARIABLE","$productFieldName",247],"}","\"",",",["T_WHITESPACE","\n                ",247],["T_ARRAY","array",248],"(",")",")",["T_WHITESPACE","\n            ",248],["T_OBJECT_OPERATOR","->",249],["T_STRING","columns",249],"(",["T_ARRAY","array",249],"(",["T_CONSTANT_ENCAPSED_STRING","'orders'",249],["T_WHITESPACE"," ",249],["T_DOUBLE_ARROW","=>",249],["T_WHITESPACE"," ",249],["T_CONSTANT_ENCAPSED_STRING","'COUNT(order_items2.item_id)'",249],")",")",["T_WHITESPACE","\n            ",249],["T_OBJECT_OPERATOR","->",250],["T_STRING","group",250],"(",["T_VARIABLE","$productFieldName",250],")",";",["T_WHITESPACE","\n\n        ",250],["T_VARIABLE","$dateFilter",252],["T_WHITESPACE"," ",252],"=",["T_WHITESPACE"," ",252],["T_ARRAY","array",252],"(",["T_CONSTANT_ENCAPSED_STRING","'order_items2.item_id = order_items.item_id'",252],")",";",["T_WHITESPACE","\n        ",252],["T_IF","if",253],["T_WHITESPACE"," ",253],"(",["T_VARIABLE","$from",253],["T_WHITESPACE"," ",253],["T_IS_NOT_EQUAL","!=",253],["T_WHITESPACE"," ",253],["T_CONSTANT_ENCAPSED_STRING","''",253],["T_WHITESPACE"," ",253],["T_BOOLEAN_AND","&&",253],["T_WHITESPACE"," ",253],["T_VARIABLE","$to",253],["T_WHITESPACE"," ",253],["T_IS_NOT_EQUAL","!=",253],["T_WHITESPACE"," ",253],["T_CONSTANT_ENCAPSED_STRING","''",253],")",["T_WHITESPACE"," ",253],"{",["T_WHITESPACE","\n            ",253],["T_VARIABLE","$dateFilter",254],"[","]",["T_WHITESPACE"," ",254],"=",["T_WHITESPACE"," ",254],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","_prepareBetweenSql",254],"(",["T_CONSTANT_ENCAPSED_STRING","'order_items2.created_at'",254],",",["T_WHITESPACE"," ",254],["T_VARIABLE","$from",254],",",["T_WHITESPACE"," ",254],["T_VARIABLE","$to",254],")",";",["T_WHITESPACE","\n        ",254],"}",["T_WHITESPACE","\n\n        ",255],["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","getSelect",257],"(",")",["T_WHITESPACE","\n            ",257],["T_OBJECT_OPERATOR","->",258],["T_STRING","joinLeft",258],"(",["T_WHITESPACE","\n                ",258],["T_ARRAY","array",259],"(",["T_CONSTANT_ENCAPSED_STRING","'order_items2'",259],["T_WHITESPACE"," ",259],["T_DOUBLE_ARROW","=>",259],["T_WHITESPACE"," ",259],["T_VARIABLE","$orderItemTableName",259],")",",",["T_WHITESPACE","\n                ",259],["T_STRING","implode",260],"(",["T_CONSTANT_ENCAPSED_STRING","' AND '",260],",",["T_WHITESPACE"," ",260],["T_VARIABLE","$dateFilter",260],")",",",["T_WHITESPACE","\n                ",260],["T_ARRAY","array",261],"(",")",["T_WHITESPACE","\n            ",261],")",";",["T_WHITESPACE","\n\n        ",262],["T_RETURN","return",264],["T_WHITESPACE"," ",264],["T_VARIABLE","$this",264],";",["T_WHITESPACE","\n    ",264],"}",["T_WHITESPACE","\n\n    ",265],["T_DOC_COMMENT","\/**\n     * Add ordered qty's\n     *\n     * @param string $from\n     * @param string $to\n     * @return Mage_Reports_Model_Resource_Product_Collection\n     *\/",267],["T_WHITESPACE","\n    ",273],["T_PUBLIC","public",274],["T_WHITESPACE"," ",274],["T_FUNCTION","function",274],["T_WHITESPACE"," ",274],["T_STRING","addOrderedQty",274],"(",["T_VARIABLE","$from",274],["T_WHITESPACE"," ",274],"=",["T_WHITESPACE"," ",274],["T_CONSTANT_ENCAPSED_STRING","''",274],",",["T_WHITESPACE"," ",274],["T_VARIABLE","$to",274],["T_WHITESPACE"," ",274],"=",["T_WHITESPACE"," ",274],["T_CONSTANT_ENCAPSED_STRING","''",274],")",["T_WHITESPACE","\n    ",274],"{",["T_WHITESPACE","\n        ",275],["T_VARIABLE","$adapter",276],["T_WHITESPACE","              ",276],"=",["T_WHITESPACE"," ",276],["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","getConnection",276],"(",")",";",["T_WHITESPACE","\n        ",276],["T_VARIABLE","$compositeTypeIds",277],["T_WHITESPACE","     ",277],"=",["T_WHITESPACE"," ",277],["T_STRING","Mage",277],["T_DOUBLE_COLON","::",277],["T_STRING","getSingleton",277],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_type'",277],")",["T_OBJECT_OPERATOR","->",277],["T_STRING","getCompositeTypes",277],"(",")",";",["T_WHITESPACE","\n        ",277],["T_VARIABLE","$orderTableAliasName",278],["T_WHITESPACE","  ",278],"=",["T_WHITESPACE"," ",278],["T_VARIABLE","$adapter",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","quoteIdentifier",278],"(",["T_CONSTANT_ENCAPSED_STRING","'order'",278],")",";",["T_WHITESPACE","\n\n        ",278],["T_VARIABLE","$orderJoinCondition",280],["T_WHITESPACE","   ",280],"=",["T_WHITESPACE"," ",280],["T_ARRAY","array",280],"(",["T_WHITESPACE","\n            ",280],["T_VARIABLE","$orderTableAliasName",281],["T_WHITESPACE"," ",281],".",["T_WHITESPACE"," ",281],["T_CONSTANT_ENCAPSED_STRING","'.entity_id = order_items.order_id'",281],",",["T_WHITESPACE","\n            ",281],["T_VARIABLE","$adapter",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","quoteInto",282],"(","\"",["T_CURLY_OPEN","{",282],["T_VARIABLE","$orderTableAliasName",282],"}",["T_ENCAPSED_AND_WHITESPACE",".state <> ?",282],"\"",",",["T_WHITESPACE"," ",282],["T_STRING","Mage_Sales_Model_Order",282],["T_DOUBLE_COLON","::",282],["T_STRING","STATE_CANCELED",282],")",",",["T_WHITESPACE","\n\n        ",282],")",";",["T_WHITESPACE","\n\n        ",284],["T_VARIABLE","$productJoinCondition",286],["T_WHITESPACE"," ",286],"=",["T_WHITESPACE"," ",286],["T_ARRAY","array",286],"(",["T_WHITESPACE","\n            ",286],["T_VARIABLE","$adapter",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","quoteInto",287],"(",["T_CONSTANT_ENCAPSED_STRING","'(e.type_id NOT IN (?))'",287],",",["T_WHITESPACE"," ",287],["T_VARIABLE","$compositeTypeIds",287],")",",",["T_WHITESPACE","\n            ",287],["T_CONSTANT_ENCAPSED_STRING","'e.entity_id = order_items.product_id'",288],",",["T_WHITESPACE","\n            ",288],["T_VARIABLE","$adapter",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","quoteInto",289],"(",["T_CONSTANT_ENCAPSED_STRING","'e.entity_type_id = ?'",289],",",["T_WHITESPACE"," ",289],["T_VARIABLE","$this",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","getProductEntityTypeId",289],"(",")",")",["T_WHITESPACE","\n        ",289],")",";",["T_WHITESPACE","\n\n        ",290],["T_IF","if",292],["T_WHITESPACE"," ",292],"(",["T_VARIABLE","$from",292],["T_WHITESPACE"," ",292],["T_IS_NOT_EQUAL","!=",292],["T_WHITESPACE"," ",292],["T_CONSTANT_ENCAPSED_STRING","''",292],["T_WHITESPACE"," ",292],["T_BOOLEAN_AND","&&",292],["T_WHITESPACE"," ",292],["T_VARIABLE","$to",292],["T_WHITESPACE"," ",292],["T_IS_NOT_EQUAL","!=",292],["T_WHITESPACE"," ",292],["T_CONSTANT_ENCAPSED_STRING","''",292],")",["T_WHITESPACE"," ",292],"{",["T_WHITESPACE","\n            ",292],["T_VARIABLE","$fieldName",293],["T_WHITESPACE","            ",293],"=",["T_WHITESPACE"," ",293],["T_VARIABLE","$orderTableAliasName",293],["T_WHITESPACE"," ",293],".",["T_WHITESPACE"," ",293],["T_CONSTANT_ENCAPSED_STRING","'.created_at'",293],";",["T_WHITESPACE","\n            ",293],["T_VARIABLE","$orderJoinCondition",294],"[","]",["T_WHITESPACE"," ",294],"=",["T_WHITESPACE"," ",294],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","_prepareBetweenSql",294],"(",["T_VARIABLE","$fieldName",294],",",["T_WHITESPACE"," ",294],["T_VARIABLE","$from",294],",",["T_WHITESPACE"," ",294],["T_VARIABLE","$to",294],")",";",["T_WHITESPACE","\n        ",294],"}",["T_WHITESPACE","\n\n        ",295],["T_VARIABLE","$this",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","getSelect",297],"(",")",["T_OBJECT_OPERATOR","->",297],["T_STRING","reset",297],"(",")",["T_WHITESPACE","\n            ",297],["T_OBJECT_OPERATOR","->",298],["T_STRING","from",298],"(",["T_WHITESPACE","\n                ",298],["T_ARRAY","array",299],"(",["T_CONSTANT_ENCAPSED_STRING","'order_items'",299],["T_WHITESPACE"," ",299],["T_DOUBLE_ARROW","=>",299],["T_WHITESPACE"," ",299],["T_VARIABLE","$this",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","getTable",299],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order_item'",299],")",")",",",["T_WHITESPACE","\n                ",299],["T_ARRAY","array",300],"(",["T_WHITESPACE","\n                    ",300],["T_CONSTANT_ENCAPSED_STRING","'ordered_qty'",301],["T_WHITESPACE"," ",301],["T_DOUBLE_ARROW","=>",301],["T_WHITESPACE"," ",301],["T_CONSTANT_ENCAPSED_STRING","'SUM(order_items.qty_ordered)'",301],",",["T_WHITESPACE","\n                    ",301],["T_CONSTANT_ENCAPSED_STRING","'order_items_name'",302],["T_WHITESPACE"," ",302],["T_DOUBLE_ARROW","=>",302],["T_WHITESPACE"," ",302],["T_CONSTANT_ENCAPSED_STRING","'order_items.name'",302],["T_WHITESPACE","\n                ",302],")",")",["T_WHITESPACE","\n            ",303],["T_OBJECT_OPERATOR","->",304],["T_STRING","joinInner",304],"(",["T_WHITESPACE","\n                ",304],["T_ARRAY","array",305],"(",["T_CONSTANT_ENCAPSED_STRING","'order'",305],["T_WHITESPACE"," ",305],["T_DOUBLE_ARROW","=>",305],["T_WHITESPACE"," ",305],["T_VARIABLE","$this",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","getTable",305],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order'",305],")",")",",",["T_WHITESPACE","\n                ",305],["T_STRING","implode",306],"(",["T_CONSTANT_ENCAPSED_STRING","' AND '",306],",",["T_WHITESPACE"," ",306],["T_VARIABLE","$orderJoinCondition",306],")",",",["T_WHITESPACE","\n                ",306],["T_ARRAY","array",307],"(",")",")",["T_WHITESPACE","\n            ",307],["T_OBJECT_OPERATOR","->",308],["T_STRING","joinLeft",308],"(",["T_WHITESPACE","\n                ",308],["T_ARRAY","array",309],"(",["T_CONSTANT_ENCAPSED_STRING","'e'",309],["T_WHITESPACE"," ",309],["T_DOUBLE_ARROW","=>",309],["T_WHITESPACE"," ",309],["T_VARIABLE","$this",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","getProductEntityTableName",309],"(",")",")",",",["T_WHITESPACE","\n                ",309],["T_STRING","implode",310],"(",["T_CONSTANT_ENCAPSED_STRING","' AND '",310],",",["T_WHITESPACE"," ",310],["T_VARIABLE","$productJoinCondition",310],")",",",["T_WHITESPACE","\n                ",310],["T_ARRAY","array",311],"(",["T_WHITESPACE","\n                    ",311],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",312],["T_WHITESPACE"," ",312],["T_DOUBLE_ARROW","=>",312],["T_WHITESPACE"," ",312],["T_CONSTANT_ENCAPSED_STRING","'order_items.product_id'",312],",",["T_WHITESPACE","\n                    ",312],["T_CONSTANT_ENCAPSED_STRING","'entity_type_id'",313],["T_WHITESPACE"," ",313],["T_DOUBLE_ARROW","=>",313],["T_WHITESPACE"," ",313],["T_CONSTANT_ENCAPSED_STRING","'e.entity_type_id'",313],",",["T_WHITESPACE","\n                    ",313],["T_CONSTANT_ENCAPSED_STRING","'attribute_set_id'",314],["T_WHITESPACE"," ",314],["T_DOUBLE_ARROW","=>",314],["T_WHITESPACE"," ",314],["T_CONSTANT_ENCAPSED_STRING","'e.attribute_set_id'",314],",",["T_WHITESPACE","\n                    ",314],["T_CONSTANT_ENCAPSED_STRING","'type_id'",315],["T_WHITESPACE"," ",315],["T_DOUBLE_ARROW","=>",315],["T_WHITESPACE"," ",315],["T_CONSTANT_ENCAPSED_STRING","'e.type_id'",315],",",["T_WHITESPACE","\n                    ",315],["T_CONSTANT_ENCAPSED_STRING","'sku'",316],["T_WHITESPACE"," ",316],["T_DOUBLE_ARROW","=>",316],["T_WHITESPACE"," ",316],["T_CONSTANT_ENCAPSED_STRING","'e.sku'",316],",",["T_WHITESPACE","\n                    ",316],["T_CONSTANT_ENCAPSED_STRING","'has_options'",317],["T_WHITESPACE"," ",317],["T_DOUBLE_ARROW","=>",317],["T_WHITESPACE"," ",317],["T_CONSTANT_ENCAPSED_STRING","'e.has_options'",317],",",["T_WHITESPACE","\n                    ",317],["T_CONSTANT_ENCAPSED_STRING","'required_options'",318],["T_WHITESPACE"," ",318],["T_DOUBLE_ARROW","=>",318],["T_WHITESPACE"," ",318],["T_CONSTANT_ENCAPSED_STRING","'e.required_options'",318],",",["T_WHITESPACE","\n                    ",318],["T_CONSTANT_ENCAPSED_STRING","'created_at'",319],["T_WHITESPACE"," ",319],["T_DOUBLE_ARROW","=>",319],["T_WHITESPACE"," ",319],["T_CONSTANT_ENCAPSED_STRING","'e.created_at'",319],",",["T_WHITESPACE","\n                    ",319],["T_CONSTANT_ENCAPSED_STRING","'updated_at'",320],["T_WHITESPACE"," ",320],["T_DOUBLE_ARROW","=>",320],["T_WHITESPACE"," ",320],["T_CONSTANT_ENCAPSED_STRING","'e.updated_at'",320],["T_WHITESPACE","\n                ",320],")",")",["T_WHITESPACE","\n            ",321],["T_OBJECT_OPERATOR","->",322],["T_STRING","where",322],"(",["T_CONSTANT_ENCAPSED_STRING","'parent_item_id IS NULL'",322],")",["T_WHITESPACE","\n            ",322],["T_OBJECT_OPERATOR","->",323],["T_STRING","group",323],"(",["T_CONSTANT_ENCAPSED_STRING","'order_items.product_id'",323],")",["T_WHITESPACE","\n            ",323],["T_OBJECT_OPERATOR","->",324],["T_STRING","having",324],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(order_items.qty_ordered) > ?'",324],",",["T_WHITESPACE"," ",324],["T_LNUMBER","0",324],")",";",["T_WHITESPACE","\n        ",324],["T_RETURN","return",325],["T_WHITESPACE"," ",325],["T_VARIABLE","$this",325],";",["T_WHITESPACE","\n    ",325],"}",["T_WHITESPACE","\n\n    ",326],["T_DOC_COMMENT","\/**\n     * Set order\n     *\n     * @param string $attribute\n     * @param string $dir\n     * @return Mage_Reports_Model_Resource_Product_Collection\n     *\/",328],["T_WHITESPACE","\n    ",334],["T_PUBLIC","public",335],["T_WHITESPACE"," ",335],["T_FUNCTION","function",335],["T_WHITESPACE"," ",335],["T_STRING","setOrder",335],"(",["T_VARIABLE","$attribute",335],",",["T_WHITESPACE"," ",335],["T_VARIABLE","$dir",335],["T_WHITESPACE"," ",335],"=",["T_WHITESPACE"," ",335],["T_STRING","self",335],["T_DOUBLE_COLON","::",335],["T_STRING","SORT_ORDER_DESC",335],")",["T_WHITESPACE","\n    ",335],"{",["T_WHITESPACE","\n        ",336],["T_IF","if",337],["T_WHITESPACE"," ",337],"(",["T_STRING","in_array",337],"(",["T_VARIABLE","$attribute",337],",",["T_WHITESPACE"," ",337],["T_ARRAY","array",337],"(",["T_CONSTANT_ENCAPSED_STRING","'carts'",337],",",["T_WHITESPACE"," ",337],["T_CONSTANT_ENCAPSED_STRING","'orders'",337],",",["T_WHITESPACE"," ",337],["T_CONSTANT_ENCAPSED_STRING","'ordered_qty'",337],")",")",")",["T_WHITESPACE"," ",337],"{",["T_WHITESPACE","\n            ",337],["T_VARIABLE","$this",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","getSelect",338],"(",")",["T_OBJECT_OPERATOR","->",338],["T_STRING","order",338],"(",["T_VARIABLE","$attribute",338],["T_WHITESPACE"," ",338],".",["T_WHITESPACE"," ",338],["T_CONSTANT_ENCAPSED_STRING","' '",338],["T_WHITESPACE"," ",338],".",["T_WHITESPACE"," ",338],["T_VARIABLE","$dir",338],")",";",["T_WHITESPACE","\n        ",338],"}",["T_WHITESPACE"," ",339],["T_ELSE","else",339],["T_WHITESPACE"," ",339],"{",["T_WHITESPACE","\n            ",339],["T_STRING","parent",340],["T_DOUBLE_COLON","::",340],["T_STRING","setOrder",340],"(",["T_VARIABLE","$attribute",340],",",["T_WHITESPACE"," ",340],["T_VARIABLE","$dir",340],")",";",["T_WHITESPACE","\n        ",340],"}",["T_WHITESPACE","\n\n        ",341],["T_RETURN","return",343],["T_WHITESPACE"," ",343],["T_VARIABLE","$this",343],";",["T_WHITESPACE","\n    ",343],"}",["T_WHITESPACE","\n\n    ",344],["T_DOC_COMMENT","\/**\n     * Add views count\n     *\n     * @param string $from\n     * @param string $to\n     * @return Mage_Reports_Model_Resource_Product_Collection\n     *\/",346],["T_WHITESPACE","\n    ",352],["T_PUBLIC","public",353],["T_WHITESPACE"," ",353],["T_FUNCTION","function",353],["T_WHITESPACE"," ",353],["T_STRING","addViewsCount",353],"(",["T_VARIABLE","$from",353],["T_WHITESPACE"," ",353],"=",["T_WHITESPACE"," ",353],["T_CONSTANT_ENCAPSED_STRING","''",353],",",["T_WHITESPACE"," ",353],["T_VARIABLE","$to",353],["T_WHITESPACE"," ",353],"=",["T_WHITESPACE"," ",353],["T_CONSTANT_ENCAPSED_STRING","''",353],")",["T_WHITESPACE","\n    ",353],"{",["T_WHITESPACE","\n        ",354],["T_DOC_COMMENT","\/**\n         * Getting event type id for catalog_product_view event\n         *\/",355],["T_WHITESPACE","\n        ",357],["T_FOREACH","foreach",358],["T_WHITESPACE"," ",358],"(",["T_STRING","Mage",358],["T_DOUBLE_COLON","::",358],["T_STRING","getModel",358],"(",["T_CONSTANT_ENCAPSED_STRING","'reports\/event_type'",358],")",["T_OBJECT_OPERATOR","->",358],["T_STRING","getCollection",358],"(",")",["T_WHITESPACE"," ",358],["T_AS","as",358],["T_WHITESPACE"," ",358],["T_VARIABLE","$eventType",358],")",["T_WHITESPACE"," ",358],"{",["T_WHITESPACE","\n            ",358],["T_IF","if",359],["T_WHITESPACE"," ",359],"(",["T_VARIABLE","$eventType",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","getEventName",359],"(",")",["T_WHITESPACE"," ",359],["T_IS_EQUAL","==",359],["T_WHITESPACE"," ",359],["T_CONSTANT_ENCAPSED_STRING","'catalog_product_view'",359],")",["T_WHITESPACE"," ",359],"{",["T_WHITESPACE","\n                ",359],["T_VARIABLE","$productViewEvent",360],["T_WHITESPACE"," ",360],"=",["T_WHITESPACE"," ",360],["T_INT_CAST","(int)",360],["T_VARIABLE","$eventType",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","getId",360],"(",")",";",["T_WHITESPACE","\n                ",360],["T_BREAK","break",361],";",["T_WHITESPACE","\n            ",361],"}",["T_WHITESPACE","\n        ",362],"}",["T_WHITESPACE","\n\n        ",363],["T_VARIABLE","$this",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","getSelect",365],"(",")",["T_OBJECT_OPERATOR","->",365],["T_STRING","reset",365],"(",")",["T_WHITESPACE","\n            ",365],["T_OBJECT_OPERATOR","->",366],["T_STRING","from",366],"(",["T_WHITESPACE","\n                ",366],["T_ARRAY","array",367],"(",["T_CONSTANT_ENCAPSED_STRING","'report_table_views'",367],["T_WHITESPACE"," ",367],["T_DOUBLE_ARROW","=>",367],["T_WHITESPACE"," ",367],["T_VARIABLE","$this",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","getTable",367],"(",["T_CONSTANT_ENCAPSED_STRING","'reports\/event'",367],")",")",",",["T_WHITESPACE","\n                ",367],["T_ARRAY","array",368],"(",["T_CONSTANT_ENCAPSED_STRING","'views'",368],["T_WHITESPACE"," ",368],["T_DOUBLE_ARROW","=>",368],["T_WHITESPACE"," ",368],["T_CONSTANT_ENCAPSED_STRING","'COUNT(report_table_views.event_id)'",368],")",")",["T_WHITESPACE","\n            ",368],["T_OBJECT_OPERATOR","->",369],["T_STRING","join",369],"(",["T_ARRAY","array",369],"(",["T_CONSTANT_ENCAPSED_STRING","'e'",369],["T_WHITESPACE"," ",369],["T_DOUBLE_ARROW","=>",369],["T_WHITESPACE"," ",369],["T_VARIABLE","$this",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","getProductEntityTableName",369],"(",")",")",",",["T_WHITESPACE","\n                ",369],["T_VARIABLE","$this",370],["T_OBJECT_OPERATOR","->",370],["T_STRING","getConnection",370],"(",")",["T_OBJECT_OPERATOR","->",370],["T_STRING","quoteInto",370],"(",["T_WHITESPACE","\n                    ",370],["T_CONSTANT_ENCAPSED_STRING","\"e.entity_id = report_table_views.object_id AND e.entity_type_id = ?\"",371],",",["T_WHITESPACE","\n                    ",371],["T_VARIABLE","$this",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","getProductEntityTypeId",372],"(",")",")",")",["T_WHITESPACE","\n            ",372],["T_OBJECT_OPERATOR","->",373],["T_STRING","where",373],"(",["T_CONSTANT_ENCAPSED_STRING","'report_table_views.event_type_id = ?'",373],",",["T_WHITESPACE"," ",373],["T_VARIABLE","$productViewEvent",373],")",["T_WHITESPACE","\n            ",373],["T_OBJECT_OPERATOR","->",374],["T_STRING","group",374],"(",["T_CONSTANT_ENCAPSED_STRING","'e.entity_id'",374],")",["T_WHITESPACE","\n            ",374],["T_OBJECT_OPERATOR","->",375],["T_STRING","order",375],"(",["T_CONSTANT_ENCAPSED_STRING","'views '",375],["T_WHITESPACE"," ",375],".",["T_WHITESPACE"," ",375],["T_STRING","self",375],["T_DOUBLE_COLON","::",375],["T_STRING","SORT_ORDER_DESC",375],")",["T_WHITESPACE","\n            ",375],["T_OBJECT_OPERATOR","->",376],["T_STRING","having",376],"(",["T_CONSTANT_ENCAPSED_STRING","'COUNT(report_table_views.event_id) > ?'",376],",",["T_WHITESPACE"," ",376],["T_LNUMBER","0",376],")",";",["T_WHITESPACE","\n\n        ",376],["T_IF","if",378],["T_WHITESPACE"," ",378],"(",["T_VARIABLE","$from",378],["T_WHITESPACE"," ",378],["T_IS_NOT_EQUAL","!=",378],["T_WHITESPACE"," ",378],["T_CONSTANT_ENCAPSED_STRING","''",378],["T_WHITESPACE"," ",378],["T_BOOLEAN_AND","&&",378],["T_WHITESPACE"," ",378],["T_VARIABLE","$to",378],["T_WHITESPACE"," ",378],["T_IS_NOT_EQUAL","!=",378],["T_WHITESPACE"," ",378],["T_CONSTANT_ENCAPSED_STRING","''",378],")",["T_WHITESPACE"," ",378],"{",["T_WHITESPACE","\n            ",378],["T_VARIABLE","$this",379],["T_OBJECT_OPERATOR","->",379],["T_STRING","getSelect",379],"(",")",["T_WHITESPACE","\n                ",379],["T_OBJECT_OPERATOR","->",380],["T_STRING","where",380],"(",["T_CONSTANT_ENCAPSED_STRING","'logged_at >= ?'",380],",",["T_WHITESPACE"," ",380],["T_VARIABLE","$from",380],")",["T_WHITESPACE","\n                ",380],["T_OBJECT_OPERATOR","->",381],["T_STRING","where",381],"(",["T_CONSTANT_ENCAPSED_STRING","'logged_at <= ?'",381],",",["T_WHITESPACE"," ",381],["T_VARIABLE","$to",381],")",";",["T_WHITESPACE","\n        ",381],"}",["T_WHITESPACE","\n\n        ",382],["T_VARIABLE","$this",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","_useAnalyticFunction",384],["T_WHITESPACE"," ",384],"=",["T_WHITESPACE"," ",384],["T_STRING","true",384],";",["T_WHITESPACE","\n        ",384],["T_RETURN","return",385],["T_WHITESPACE"," ",385],["T_VARIABLE","$this",385],";",["T_WHITESPACE","\n    ",385],"}",["T_WHITESPACE","\n\n    ",386],["T_DOC_COMMENT","\/**\n     * Prepare between sql\n     *\n     * @param  string $fieldName Field name with table suffix ('created_at' or 'main_table.created_at')\n     * @param  string $from\n     * @param  string $to\n     * @return string Formatted sql string\n     *\/",388],["T_WHITESPACE","\n    ",395],["T_PROTECTED","protected",396],["T_WHITESPACE"," ",396],["T_FUNCTION","function",396],["T_WHITESPACE"," ",396],["T_STRING","_prepareBetweenSql",396],"(",["T_VARIABLE","$fieldName",396],",",["T_WHITESPACE"," ",396],["T_VARIABLE","$from",396],",",["T_WHITESPACE"," ",396],["T_VARIABLE","$to",396],")",["T_WHITESPACE","\n    ",396],"{",["T_WHITESPACE","\n        ",397],["T_RETURN","return",398],["T_WHITESPACE"," ",398],["T_STRING","sprintf",398],"(",["T_CONSTANT_ENCAPSED_STRING","'(%s BETWEEN %s AND %s)'",398],",",["T_WHITESPACE","\n            ",398],["T_VARIABLE","$fieldName",399],",",["T_WHITESPACE","\n            ",399],["T_VARIABLE","$this",400],["T_OBJECT_OPERATOR","->",400],["T_STRING","getConnection",400],"(",")",["T_OBJECT_OPERATOR","->",400],["T_STRING","quote",400],"(",["T_VARIABLE","$from",400],")",",",["T_WHITESPACE","\n            ",400],["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","getConnection",401],"(",")",["T_OBJECT_OPERATOR","->",401],["T_STRING","quote",401],"(",["T_VARIABLE","$to",401],")",["T_WHITESPACE","\n        ",401],")",";",["T_WHITESPACE","\n    ",402],"}",["T_WHITESPACE","\n\n    ",403],["T_DOC_COMMENT","\/**\n     * Add store restrictions to product collection\n     *\n     * @param  array $storeIds\n     * @param  array $websiteIds\n     * @return Mage_Reports_Model_Resource_Product_Collection\n     *\/",405],["T_WHITESPACE","\n    ",411],["T_PUBLIC","public",412],["T_WHITESPACE"," ",412],["T_FUNCTION","function",412],["T_WHITESPACE"," ",412],["T_STRING","addStoreRestrictions",412],"(",["T_VARIABLE","$storeIds",412],",",["T_WHITESPACE"," ",412],["T_VARIABLE","$websiteIds",412],")",["T_WHITESPACE","\n    ",412],"{",["T_WHITESPACE","\n        ",413],["T_IF","if",414],["T_WHITESPACE"," ",414],"(","!",["T_STRING","is_array",414],"(",["T_VARIABLE","$storeIds",414],")",")",["T_WHITESPACE"," ",414],"{",["T_WHITESPACE","\n            ",414],["T_VARIABLE","$storeIds",415],["T_WHITESPACE"," ",415],"=",["T_WHITESPACE"," ",415],["T_ARRAY","array",415],"(",["T_VARIABLE","$storeIds",415],")",";",["T_WHITESPACE","\n        ",415],"}",["T_WHITESPACE","\n        ",416],["T_IF","if",417],["T_WHITESPACE"," ",417],"(","!",["T_STRING","is_array",417],"(",["T_VARIABLE","$websiteIds",417],")",")",["T_WHITESPACE"," ",417],"{",["T_WHITESPACE","\n            ",417],["T_VARIABLE","$websiteIds",418],["T_WHITESPACE"," ",418],"=",["T_WHITESPACE"," ",418],["T_ARRAY","array",418],"(",["T_VARIABLE","$websiteIds",418],")",";",["T_WHITESPACE","\n        ",418],"}",["T_WHITESPACE","\n\n        ",419],["T_VARIABLE","$filters",421],["T_WHITESPACE"," ",421],"=",["T_WHITESPACE"," ",421],["T_VARIABLE","$this",421],["T_OBJECT_OPERATOR","->",421],["T_STRING","_productLimitationFilters",421],";",["T_WHITESPACE","\n        ",421],["T_IF","if",422],["T_WHITESPACE"," ",422],"(",["T_ISSET","isset",422],"(",["T_VARIABLE","$filters",422],"[",["T_CONSTANT_ENCAPSED_STRING","'store_id'",422],"]",")",")",["T_WHITESPACE"," ",422],"{",["T_WHITESPACE","\n            ",422],["T_IF","if",423],["T_WHITESPACE"," ",423],"(","!",["T_STRING","in_array",423],"(",["T_VARIABLE","$filters",423],"[",["T_CONSTANT_ENCAPSED_STRING","'store_id'",423],"]",",",["T_WHITESPACE"," ",423],["T_VARIABLE","$storeIds",423],")",")",["T_WHITESPACE"," ",423],"{",["T_WHITESPACE","\n                ",423],["T_VARIABLE","$this",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","addStoreFilter",424],"(",["T_VARIABLE","$filters",424],"[",["T_CONSTANT_ENCAPSED_STRING","'store_id'",424],"]",")",";",["T_WHITESPACE","\n            ",424],"}",["T_WHITESPACE"," ",425],["T_ELSE","else",425],["T_WHITESPACE"," ",425],"{",["T_WHITESPACE","\n                ",425],["T_VARIABLE","$this",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","addStoreFilter",426],"(",["T_VARIABLE","$this",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","getStoreId",426],"(",")",")",";",["T_WHITESPACE","\n            ",426],"}",["T_WHITESPACE","\n        ",427],"}",["T_WHITESPACE"," ",428],["T_ELSE","else",428],["T_WHITESPACE"," ",428],"{",["T_WHITESPACE","\n            ",428],["T_VARIABLE","$this",429],["T_OBJECT_OPERATOR","->",429],["T_STRING","addWebsiteFilter",429],"(",["T_VARIABLE","$websiteIds",429],")",";",["T_WHITESPACE","\n        ",429],"}",["T_WHITESPACE","\n\n        ",430],["T_RETURN","return",432],["T_WHITESPACE"," ",432],["T_VARIABLE","$this",432],";",["T_WHITESPACE","\n    ",432],"}",["T_WHITESPACE","\n",433],"}",["T_WHITESPACE","\n",434]]