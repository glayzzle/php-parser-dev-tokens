[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Core\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Core Http Helper\n *\n * @category    Mage\n * @package     Mage_Core\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Core_Helper_Http",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Core_Helper_Abstract",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_CONST","const",36],["T_WHITESPACE"," ",36],["T_STRING","XML_NODE_REMOTE_ADDR_HEADERS",36],["T_WHITESPACE","  ",36],"=",["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'global\/remote_addr_headers'",36],";",["T_WHITESPACE","\n\n    ",36],["T_DOC_COMMENT","\/**\n     * Remote address cache\n     *\n     * @var string\n     *\/",38],["T_WHITESPACE","\n    ",42],["T_PROTECTED","protected",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$_remoteAddr",43],";",["T_WHITESPACE","\n\n    ",43],["T_DOC_COMMENT","\/**\n     * Validate and retrieve user and password from HTTP\n     *\n     * @return array\n     *\/",45],["T_WHITESPACE","\n    ",49],["T_PUBLIC","public",50],["T_WHITESPACE"," ",50],["T_FUNCTION","function",50],["T_WHITESPACE"," ",50],["T_STRING","authValidate",50],"(",["T_VARIABLE","$headers",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_STRING","null",50],")",["T_WHITESPACE","\n    ",50],"{",["T_WHITESPACE","\n        ",51],["T_IF","if",52],"(","!",["T_STRING","is_null",52],"(",["T_VARIABLE","$headers",52],")",")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n            ",52],["T_VARIABLE","$_SERVER",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$headers",53],";",["T_WHITESPACE","\n        ",53],"}",["T_WHITESPACE","\n\n        ",54],["T_VARIABLE","$user",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","''",56],";",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$pass",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","''",57],";",["T_WHITESPACE","\n\n        ",57],["T_COMMENT","\/\/ moshe's fix for CGI\n",59],["T_WHITESPACE","        ",60],["T_IF","if",60],["T_WHITESPACE"," ",60],"(",["T_EMPTY","empty",60],"(",["T_VARIABLE","$_SERVER",60],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_AUTHORIZATION'",60],"]",")",")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n            ",60],["T_FOREACH","foreach",61],["T_WHITESPACE"," ",61],"(",["T_VARIABLE","$_SERVER",61],["T_WHITESPACE"," ",61],["T_AS","as",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$k",61],["T_DOUBLE_ARROW","=>",61],["T_VARIABLE","$v",61],")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n                ",61],["T_IF","if",62],["T_WHITESPACE"," ",62],"(",["T_STRING","substr",62],"(",["T_VARIABLE","$k",62],",",["T_WHITESPACE"," ",62],"-",["T_LNUMBER","18",62],")",["T_IS_IDENTICAL","===",62],["T_CONSTANT_ENCAPSED_STRING","'HTTP_AUTHORIZATION'",62],["T_WHITESPACE"," ",62],["T_BOOLEAN_AND","&&",62],["T_WHITESPACE"," ",62],"!",["T_EMPTY","empty",62],"(",["T_VARIABLE","$v",62],")",")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n                    ",62],["T_VARIABLE","$_SERVER",63],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_AUTHORIZATION'",63],"]",["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_VARIABLE","$v",63],";",["T_WHITESPACE","\n                    ",63],["T_BREAK","break",64],";",["T_WHITESPACE","\n                ",64],"}",["T_WHITESPACE","\n            ",65],"}",["T_WHITESPACE","\n        ",66],"}",["T_WHITESPACE","\n\n        ",67],["T_IF","if",69],["T_WHITESPACE"," ",69],"(",["T_ISSET","isset",69],"(",["T_VARIABLE","$_SERVER",69],"[",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_USER'",69],"]",")",["T_WHITESPACE"," ",69],["T_BOOLEAN_AND","&&",69],["T_WHITESPACE"," ",69],["T_ISSET","isset",69],"(",["T_VARIABLE","$_SERVER",69],"[",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_PW'",69],"]",")",")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n            ",69],["T_VARIABLE","$user",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$_SERVER",70],"[",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_USER'",70],"]",";",["T_WHITESPACE","\n            ",70],["T_VARIABLE","$pass",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$_SERVER",71],"[",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_PW'",71],"]",";",["T_WHITESPACE","\n        ",71],"}",["T_WHITESPACE","\n        ",72],["T_COMMENT","\/\/  IIS Note::  For HTTP Authentication to work with IIS,\n",73],["T_WHITESPACE","        ",74],["T_COMMENT","\/\/ the PHP directive cgi.rfc2616_headers must be set to 0 (the default value).\n",74],["T_WHITESPACE","        ",75],["T_ELSEIF","elseif",75],["T_WHITESPACE"," ",75],"(","!",["T_EMPTY","empty",75],"(",["T_VARIABLE","$_SERVER",75],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_AUTHORIZATION'",75],"]",")",")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n            ",75],["T_VARIABLE","$auth",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$_SERVER",76],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_AUTHORIZATION'",76],"]",";",["T_WHITESPACE","\n            ",76],["T_LIST","list",77],"(",["T_VARIABLE","$user",77],",",["T_WHITESPACE"," ",77],["T_VARIABLE","$pass",77],")",["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_STRING","explode",77],"(",["T_CONSTANT_ENCAPSED_STRING","':'",77],",",["T_WHITESPACE"," ",77],["T_STRING","base64_decode",77],"(",["T_STRING","substr",77],"(",["T_VARIABLE","$auth",77],",",["T_WHITESPACE"," ",77],["T_STRING","strpos",77],"(",["T_VARIABLE","$auth",77],",",["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","\" \"",77],")",["T_WHITESPACE"," ",77],"+",["T_WHITESPACE"," ",77],["T_LNUMBER","1",77],")",")",")",";",["T_WHITESPACE","\n        ",77],"}",["T_WHITESPACE","\n        ",78],["T_ELSEIF","elseif",79],["T_WHITESPACE"," ",79],"(","!",["T_EMPTY","empty",79],"(",["T_VARIABLE","$_SERVER",79],"[",["T_CONSTANT_ENCAPSED_STRING","'Authorization'",79],"]",")",")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n            ",79],["T_VARIABLE","$auth",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$_SERVER",80],"[",["T_CONSTANT_ENCAPSED_STRING","'Authorization'",80],"]",";",["T_WHITESPACE","\n            ",80],["T_LIST","list",81],"(",["T_VARIABLE","$user",81],",",["T_WHITESPACE"," ",81],["T_VARIABLE","$pass",81],")",["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_STRING","explode",81],"(",["T_CONSTANT_ENCAPSED_STRING","':'",81],",",["T_WHITESPACE"," ",81],["T_STRING","base64_decode",81],"(",["T_STRING","substr",81],"(",["T_VARIABLE","$auth",81],",",["T_WHITESPACE"," ",81],["T_STRING","strpos",81],"(",["T_VARIABLE","$auth",81],",",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","\" \"",81],")",["T_WHITESPACE"," ",81],"+",["T_WHITESPACE"," ",81],["T_LNUMBER","1",81],")",")",")",";",["T_WHITESPACE","\n        ",81],"}",["T_WHITESPACE","\n\n        ",82],["T_IF","if",84],["T_WHITESPACE"," ",84],"(","!",["T_VARIABLE","$user",84],["T_WHITESPACE"," ",84],["T_BOOLEAN_OR","||",84],["T_WHITESPACE"," ",84],"!",["T_VARIABLE","$pass",84],")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n            ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","authFailed",85],"(",")",";",["T_WHITESPACE","\n        ",85],"}",["T_WHITESPACE","\n\n        ",86],["T_RETURN","return",88],["T_WHITESPACE"," ",88],["T_ARRAY","array",88],"(",["T_VARIABLE","$user",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$pass",88],")",";",["T_WHITESPACE","\n    ",88],"}",["T_WHITESPACE","\n\n    ",89],["T_DOC_COMMENT","\/**\n     * Send auth failed Headers and exit\n     *\n     *\/",91],["T_WHITESPACE","\n    ",94],["T_PUBLIC","public",95],["T_WHITESPACE"," ",95],["T_FUNCTION","function",95],["T_WHITESPACE"," ",95],["T_STRING","authFailed",95],"(",")",["T_WHITESPACE","\n    ",95],"{",["T_WHITESPACE","\n        ",96],["T_STRING","Mage",97],["T_DOUBLE_COLON","::",97],["T_STRING","app",97],"(",")",["T_OBJECT_OPERATOR","->",97],["T_STRING","getResponse",97],"(",")",["T_WHITESPACE","\n            ",97],["T_OBJECT_OPERATOR","->",98],["T_STRING","setHeader",98],"(",["T_CONSTANT_ENCAPSED_STRING","'HTTP\/1.1'",98],",",["T_CONSTANT_ENCAPSED_STRING","'401 Unauthorized'",98],")",["T_WHITESPACE","\n            ",98],["T_OBJECT_OPERATOR","->",99],["T_STRING","setHeader",99],"(",["T_CONSTANT_ENCAPSED_STRING","'WWW-Authenticate'",99],",",["T_CONSTANT_ENCAPSED_STRING","'Basic realm=\"RSS Feeds\"'",99],")",["T_WHITESPACE","\n            ",99],["T_OBJECT_OPERATOR","->",100],["T_STRING","setBody",100],"(",["T_CONSTANT_ENCAPSED_STRING","'<h1>401 Unauthorized<\/h1>'",100],")",["T_WHITESPACE","\n            ",100],["T_OBJECT_OPERATOR","->",101],["T_STRING","sendResponse",101],"(",")",";",["T_WHITESPACE","\n        ",101],["T_EXIT","exit",102],";",["T_WHITESPACE","\n    ",102],"}",["T_WHITESPACE","\n\n    ",103],["T_DOC_COMMENT","\/**\n     * Retrieve Remote Addresses Additional check Headers\n     *\n     * @return array\n     *\/",105],["T_WHITESPACE","\n    ",109],["T_PUBLIC","public",110],["T_WHITESPACE"," ",110],["T_FUNCTION","function",110],["T_WHITESPACE"," ",110],["T_STRING","getRemoteAddrHeaders",110],"(",")",["T_WHITESPACE","\n    ",110],"{",["T_WHITESPACE","\n        ",111],["T_VARIABLE","$headers",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_ARRAY","array",112],"(",")",";",["T_WHITESPACE","\n        ",112],["T_VARIABLE","$element",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_STRING","Mage",113],["T_DOUBLE_COLON","::",113],["T_STRING","getConfig",113],"(",")",["T_OBJECT_OPERATOR","->",113],["T_STRING","getNode",113],"(",["T_STRING","self",113],["T_DOUBLE_COLON","::",113],["T_STRING","XML_NODE_REMOTE_ADDR_HEADERS",113],")",";",["T_WHITESPACE","\n        ",113],["T_IF","if",114],["T_WHITESPACE"," ",114],"(",["T_VARIABLE","$element",114],["T_WHITESPACE"," ",114],["T_INSTANCEOF","instanceof",114],["T_WHITESPACE"," ",114],["T_STRING","Mage_Core_Model_Config_Element",114],")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n            ",114],["T_FOREACH","foreach",115],["T_WHITESPACE"," ",115],"(",["T_VARIABLE","$element",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","children",115],"(",")",["T_WHITESPACE"," ",115],["T_AS","as",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$node",115],")",["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n                ",115],["T_VARIABLE","$headers",116],"[","]",["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_STRING_CAST","(string)",116],["T_VARIABLE","$node",116],";",["T_WHITESPACE","\n            ",116],"}",["T_WHITESPACE","\n        ",117],"}",["T_WHITESPACE","\n\n        ",118],["T_RETURN","return",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$headers",120],";",["T_WHITESPACE","\n    ",120],"}",["T_WHITESPACE","\n\n    ",121],["T_DOC_COMMENT","\/**\n     * Retrieve Client Remote Address\n     *\n     * @param bool $ipToLong converting IP to long format\n     * @return string IPv4|long\n     *\/",123],["T_WHITESPACE","\n    ",128],["T_PUBLIC","public",129],["T_WHITESPACE"," ",129],["T_FUNCTION","function",129],["T_WHITESPACE"," ",129],["T_STRING","getRemoteAddr",129],"(",["T_VARIABLE","$ipToLong",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_STRING","false",129],")",["T_WHITESPACE","\n    ",129],"{",["T_WHITESPACE","\n        ",130],["T_IF","if",131],["T_WHITESPACE"," ",131],"(",["T_STRING","is_null",131],"(",["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","_remoteAddr",131],")",")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n            ",131],["T_VARIABLE","$headers",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","getRemoteAddrHeaders",132],"(",")",";",["T_WHITESPACE","\n            ",132],["T_FOREACH","foreach",133],["T_WHITESPACE"," ",133],"(",["T_VARIABLE","$headers",133],["T_WHITESPACE"," ",133],["T_AS","as",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$var",133],")",["T_WHITESPACE"," ",133],"{",["T_WHITESPACE","\n                ",133],["T_IF","if",134],["T_WHITESPACE"," ",134],"(",["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","_getRequest",134],"(",")",["T_OBJECT_OPERATOR","->",134],["T_STRING","getServer",134],"(",["T_VARIABLE","$var",134],",",["T_WHITESPACE"," ",134],["T_STRING","false",134],")",")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n                    ",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","_remoteAddr",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_VARIABLE","$_SERVER",135],"[",["T_VARIABLE","$var",135],"]",";",["T_WHITESPACE","\n                    ",135],["T_BREAK","break",136],";",["T_WHITESPACE","\n                ",136],"}",["T_WHITESPACE","\n            ",137],"}",["T_WHITESPACE","\n\n            ",138],["T_IF","if",140],["T_WHITESPACE"," ",140],"(","!",["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","_remoteAddr",140],")",["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n                ",140],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","_remoteAddr",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","_getRequest",141],"(",")",["T_OBJECT_OPERATOR","->",141],["T_STRING","getServer",141],"(",["T_CONSTANT_ENCAPSED_STRING","'REMOTE_ADDR'",141],")",";",["T_WHITESPACE","\n            ",141],"}",["T_WHITESPACE","\n        ",142],"}",["T_WHITESPACE","\n\n        ",143],["T_IF","if",145],["T_WHITESPACE"," ",145],"(","!",["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","_remoteAddr",145],")",["T_WHITESPACE"," ",145],"{",["T_WHITESPACE","\n            ",145],["T_RETURN","return",146],["T_WHITESPACE"," ",146],["T_STRING","false",146],";",["T_WHITESPACE","\n        ",146],"}",["T_WHITESPACE","\n\n        ",147],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_VARIABLE","$ipToLong",149],["T_WHITESPACE"," ",149],"?",["T_WHITESPACE"," ",149],["T_STRING","inet_pton",149],"(",["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","_remoteAddr",149],")",["T_WHITESPACE"," ",149],":",["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","_remoteAddr",149],";",["T_WHITESPACE","\n    ",149],"}",["T_WHITESPACE","\n\n    ",150],["T_DOC_COMMENT","\/**\n     * Retrieve Server IP address\n     *\n     * @param bool $ipToLong converting IP to long format\n     * @return string IPv4|long\n     *\/",152],["T_WHITESPACE","\n    ",157],["T_PUBLIC","public",158],["T_WHITESPACE"," ",158],["T_FUNCTION","function",158],["T_WHITESPACE"," ",158],["T_STRING","getServerAddr",158],"(",["T_VARIABLE","$ipToLong",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_STRING","false",158],")",["T_WHITESPACE","\n    ",158],"{",["T_WHITESPACE","\n        ",159],["T_VARIABLE","$address",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","_getRequest",160],"(",")",["T_OBJECT_OPERATOR","->",160],["T_STRING","getServer",160],"(",["T_CONSTANT_ENCAPSED_STRING","'SERVER_ADDR'",160],")",";",["T_WHITESPACE","\n        ",160],["T_IF","if",161],["T_WHITESPACE"," ",161],"(","!",["T_VARIABLE","$address",161],")",["T_WHITESPACE"," ",161],"{",["T_WHITESPACE","\n            ",161],["T_RETURN","return",162],["T_WHITESPACE"," ",162],["T_STRING","false",162],";",["T_WHITESPACE","\n        ",162],"}",["T_WHITESPACE","\n        ",163],["T_RETURN","return",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$ipToLong",164],["T_WHITESPACE"," ",164],"?",["T_WHITESPACE"," ",164],["T_STRING","inet_pton",164],"(",["T_VARIABLE","$address",164],")",["T_WHITESPACE"," ",164],":",["T_WHITESPACE"," ",164],["T_VARIABLE","$address",164],";",["T_WHITESPACE","\n    ",164],"}",["T_WHITESPACE","\n\n    ",165],["T_DOC_COMMENT","\/**\n     * Retrieve HTTP \"clean\" value\n     *\n     * @param string $var\n     * @param boolean $clean clean non UTF-8 characters\n     * @return string\n     *\/",167],["T_WHITESPACE","\n    ",173],["T_PROTECTED","protected",174],["T_WHITESPACE"," ",174],["T_FUNCTION","function",174],["T_WHITESPACE"," ",174],["T_STRING","_getHttpCleanValue",174],"(",["T_VARIABLE","$var",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$clean",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_STRING","true",174],")",["T_WHITESPACE","\n    ",174],"{",["T_WHITESPACE","\n        ",175],["T_VARIABLE","$value",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","_getRequest",176],"(",")",["T_OBJECT_OPERATOR","->",176],["T_STRING","getServer",176],"(",["T_VARIABLE","$var",176],",",["T_WHITESPACE"," ",176],["T_CONSTANT_ENCAPSED_STRING","''",176],")",";",["T_WHITESPACE","\n        ",176],["T_IF","if",177],["T_WHITESPACE"," ",177],"(",["T_VARIABLE","$clean",177],")",["T_WHITESPACE"," ",177],"{",["T_WHITESPACE","\n            ",177],["T_VARIABLE","$value",178],["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_STRING","Mage",178],["T_DOUBLE_COLON","::",178],["T_STRING","helper",178],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/string'",178],")",["T_OBJECT_OPERATOR","->",178],["T_STRING","cleanString",178],"(",["T_VARIABLE","$value",178],")",";",["T_WHITESPACE","\n        ",178],"}",["T_WHITESPACE","\n\n        ",179],["T_RETURN","return",181],["T_WHITESPACE"," ",181],["T_VARIABLE","$value",181],";",["T_WHITESPACE","\n    ",181],"}",["T_WHITESPACE","\n\n    ",182],["T_DOC_COMMENT","\/**\n     * Retrieve HTTP HOST\n     *\n     * @param boolean $clean clean non UTF-8 characters\n     * @return string\n     *\/",184],["T_WHITESPACE","\n    ",189],["T_PUBLIC","public",190],["T_WHITESPACE"," ",190],["T_FUNCTION","function",190],["T_WHITESPACE"," ",190],["T_STRING","getHttpHost",190],"(",["T_VARIABLE","$clean",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_STRING","true",190],")",["T_WHITESPACE","\n    ",190],"{",["T_WHITESPACE","\n        ",191],["T_RETURN","return",192],["T_WHITESPACE"," ",192],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","_getHttpCleanValue",192],"(",["T_CONSTANT_ENCAPSED_STRING","'HTTP_HOST'",192],",",["T_WHITESPACE"," ",192],["T_VARIABLE","$clean",192],")",";",["T_WHITESPACE","\n    ",192],"}",["T_WHITESPACE","\n\n    ",193],["T_DOC_COMMENT","\/**\n     * Retrieve HTTP USER AGENT\n     *\n     * @param boolean $clean clean non UTF-8 characters\n     * @return string\n     *\/",195],["T_WHITESPACE","\n    ",200],["T_PUBLIC","public",201],["T_WHITESPACE"," ",201],["T_FUNCTION","function",201],["T_WHITESPACE"," ",201],["T_STRING","getHttpUserAgent",201],"(",["T_VARIABLE","$clean",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_STRING","true",201],")",["T_WHITESPACE","\n    ",201],"{",["T_WHITESPACE","\n        ",202],["T_RETURN","return",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","_getHttpCleanValue",203],"(",["T_CONSTANT_ENCAPSED_STRING","'HTTP_USER_AGENT'",203],",",["T_WHITESPACE"," ",203],["T_VARIABLE","$clean",203],")",";",["T_WHITESPACE","\n    ",203],"}",["T_WHITESPACE","\n\n    ",204],["T_DOC_COMMENT","\/**\n     * Retrieve HTTP ACCEPT LANGUAGE\n     *\n     * @param boolean $clean clean non UTF-8 characters\n     * @return string\n     *\/",206],["T_WHITESPACE","\n    ",211],["T_PUBLIC","public",212],["T_WHITESPACE"," ",212],["T_FUNCTION","function",212],["T_WHITESPACE"," ",212],["T_STRING","getHttpAcceptLanguage",212],"(",["T_VARIABLE","$clean",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_STRING","true",212],")",["T_WHITESPACE","\n    ",212],"{",["T_WHITESPACE","\n        ",213],["T_RETURN","return",214],["T_WHITESPACE"," ",214],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","_getHttpCleanValue",214],"(",["T_CONSTANT_ENCAPSED_STRING","'HTTP_ACCEPT_LANGUAGE'",214],",",["T_WHITESPACE"," ",214],["T_VARIABLE","$clean",214],")",";",["T_WHITESPACE","\n    ",214],"}",["T_WHITESPACE","\n\n    ",215],["T_DOC_COMMENT","\/**\n     * Retrieve HTTP ACCEPT CHARSET\n     *\n     * @param boolean $clean clean non UTF-8 characters\n     * @return string\n     *\/",217],["T_WHITESPACE","\n    ",222],["T_PUBLIC","public",223],["T_WHITESPACE"," ",223],["T_FUNCTION","function",223],["T_WHITESPACE"," ",223],["T_STRING","getHttpAcceptCharset",223],"(",["T_VARIABLE","$clean",223],["T_WHITESPACE"," ",223],"=",["T_WHITESPACE"," ",223],["T_STRING","true",223],")",["T_WHITESPACE","\n    ",223],"{",["T_WHITESPACE","\n        ",224],["T_RETURN","return",225],["T_WHITESPACE"," ",225],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","_getHttpCleanValue",225],"(",["T_CONSTANT_ENCAPSED_STRING","'HTTP_ACCEPT_CHARSET'",225],",",["T_WHITESPACE"," ",225],["T_VARIABLE","$clean",225],")",";",["T_WHITESPACE","\n    ",225],"}",["T_WHITESPACE","\n\n    ",226],["T_DOC_COMMENT","\/**\n     * Retrieve HTTP REFERER\n     *\n     * @param boolean $clean clean non UTF-8 characters\n     * @return string\n     *\/",228],["T_WHITESPACE","\n    ",233],["T_PUBLIC","public",234],["T_WHITESPACE"," ",234],["T_FUNCTION","function",234],["T_WHITESPACE"," ",234],["T_STRING","getHttpReferer",234],"(",["T_VARIABLE","$clean",234],["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_STRING","true",234],")",["T_WHITESPACE","\n    ",234],"{",["T_WHITESPACE","\n        ",235],["T_RETURN","return",236],["T_WHITESPACE"," ",236],["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","_getHttpCleanValue",236],"(",["T_CONSTANT_ENCAPSED_STRING","'HTTP_REFERER'",236],",",["T_WHITESPACE"," ",236],["T_VARIABLE","$clean",236],")",";",["T_WHITESPACE","\n    ",236],"}",["T_WHITESPACE","\n\n    ",237],["T_DOC_COMMENT","\/**\n     * Returns the REQUEST_URI taking into account\n     * platform differences between Apache and IIS\n     *\n     * @param boolean $clean clean non UTF-8 characters\n     * @return string\n     *\/",239],["T_WHITESPACE","\n    ",245],["T_PUBLIC","public",246],["T_WHITESPACE"," ",246],["T_FUNCTION","function",246],["T_WHITESPACE"," ",246],["T_STRING","getRequestUri",246],"(",["T_VARIABLE","$clean",246],["T_WHITESPACE"," ",246],"=",["T_WHITESPACE"," ",246],["T_STRING","false",246],")",["T_WHITESPACE","\n    ",246],"{",["T_WHITESPACE","\n        ",247],["T_VARIABLE","$uri",248],["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","_getRequest",248],"(",")",["T_OBJECT_OPERATOR","->",248],["T_STRING","getRequestUri",248],"(",")",";",["T_WHITESPACE","\n        ",248],["T_IF","if",249],["T_WHITESPACE"," ",249],"(",["T_VARIABLE","$clean",249],")",["T_WHITESPACE"," ",249],"{",["T_WHITESPACE","\n            ",249],["T_VARIABLE","$uri",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_STRING","Mage",250],["T_DOUBLE_COLON","::",250],["T_STRING","helper",250],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/string'",250],")",["T_OBJECT_OPERATOR","->",250],["T_STRING","cleanString",250],"(",["T_VARIABLE","$uri",250],")",";",["T_WHITESPACE","\n        ",250],"}",["T_WHITESPACE","\n        ",251],["T_RETURN","return",252],["T_WHITESPACE"," ",252],["T_VARIABLE","$uri",252],";",["T_WHITESPACE","\n    ",252],"}",["T_WHITESPACE","\n\n    ",253],["T_DOC_COMMENT","\/**\n     * Validate IP address\n     *\n     * @param string $address\n     * @return boolean\n     *\/",255],["T_WHITESPACE","\n    ",260],["T_PUBLIC","public",261],["T_WHITESPACE"," ",261],["T_FUNCTION","function",261],["T_WHITESPACE"," ",261],["T_STRING","validateIpAddr",261],"(",["T_VARIABLE","$address",261],")",["T_WHITESPACE","\n    ",261],"{",["T_WHITESPACE","\n        ",262],["T_RETURN","return",263],["T_WHITESPACE"," ",263],["T_STRING","preg_match",263],"(",["T_CONSTANT_ENCAPSED_STRING","'#^(1?\\d{1,2}|2([0-4]\\d|5[0-5]))(\\.(1?\\d{1,2}|2([0-4]\\d|5[0-5]))){3}$#'",263],",",["T_WHITESPACE"," ",263],["T_VARIABLE","$address",263],")",";",["T_WHITESPACE","\n    ",263],"}",["T_WHITESPACE","\n",264],"}",["T_WHITESPACE","\n",265]]