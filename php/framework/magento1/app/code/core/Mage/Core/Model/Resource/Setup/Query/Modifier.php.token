[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Core\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Modifier of queries, developed for backwards compatibility on MySQL,\n * while creating foreign keys\n *\n * @category    Mage\n * @package     Mage_Core\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Model_Resource_Setup_Query_Modifier",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * MySQL adapter instance\n     *\n     * @var Varien_Db_Adapter_Pdo_Mysql\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_adapter",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Types of column we process for foreign keys\n     *\n     * @var array\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_processedTypes",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_ARRAY","array",49],"(",["T_CONSTANT_ENCAPSED_STRING","'tinyint'",49],",",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'smallint'",49],",",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'mediumint'",49],",",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'int'",49],",",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'longint'",49],")",";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Inits query modifier\n     *\n     * @param $adapter Varien_Db_Adapter_Pdo_Mysql\n     * @return void\n     *\/",51],["T_WHITESPACE","\n    ",56],["T_PUBLIC","public",57],["T_WHITESPACE"," ",57],["T_FUNCTION","function",57],["T_WHITESPACE"," ",57],["T_STRING","__construct",57],"(",["T_VARIABLE","$args",57],")",["T_WHITESPACE","\n    ",57],"{",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","_adapter",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$args",59],"[",["T_LNUMBER","0",59],"]",";",["T_WHITESPACE","\n    ",59],"}",["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * Returns column definition from CREATE TABLE sql\n     *\n     * @param string $sql\n     * @param string $column\n     * @return array\n     *\/",62],["T_WHITESPACE","\n    ",68],["T_PROTECTED","protected",69],["T_WHITESPACE"," ",69],["T_FUNCTION","function",69],["T_WHITESPACE"," ",69],["T_STRING","_getColumnDefinitionFromSql",69],"(",["T_VARIABLE","$sql",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$column",69],")",["T_WHITESPACE","\n    ",69],"{",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$result",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_STRING","null",71],";",["T_WHITESPACE","\n        ",71],["T_FOREACH","foreach",72],["T_WHITESPACE"," ",72],"(",["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","_processedTypes",72],["T_WHITESPACE"," ",72],["T_AS","as",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$type",72],")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n            ",72],["T_VARIABLE","$pattern",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'\/\\s([^\\s]+)\\s+'",73],["T_WHITESPACE"," ",73],".",["T_WHITESPACE"," ",73],["T_VARIABLE","$type",73],["T_WHITESPACE"," ",73],".",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'[^\\s]*(\\s+[^,]+)\/i'",73],";",["T_WHITESPACE","\n            ",73],["T_IF","if",74],["T_WHITESPACE"," ",74],"(","!",["T_STRING","preg_match_all",74],"(",["T_VARIABLE","$pattern",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$sql",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$matches",74],",",["T_WHITESPACE"," ",74],["T_STRING","PREG_SET_ORDER",74],")",")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n                ",74],["T_CONTINUE","continue",75],";",["T_WHITESPACE","\n            ",75],"}",["T_WHITESPACE","\n            ",76],["T_FOREACH","foreach",77],["T_WHITESPACE"," ",77],"(",["T_VARIABLE","$matches",77],["T_WHITESPACE"," ",77],["T_AS","as",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$match",77],")",["T_WHITESPACE"," ",77],"{",["T_WHITESPACE","\n                ",77],["T_VARIABLE","$gotColumn",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","_prepareIdentifier",78],"(",["T_VARIABLE","$match",78],"[",["T_LNUMBER","1",78],"]",")",";",["T_WHITESPACE","\n                ",78],["T_IF","if",79],["T_WHITESPACE"," ",79],"(",["T_VARIABLE","$gotColumn",79],["T_WHITESPACE"," ",79],["T_IS_NOT_EQUAL","!=",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$column",79],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n                    ",79],["T_CONTINUE","continue",80],";",["T_WHITESPACE","\n                ",80],"}",["T_WHITESPACE","\n\n                ",81],["T_VARIABLE","$definition",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$match",83],"[",["T_LNUMBER","2",83],"]",";",["T_WHITESPACE","\n                ",83],["T_VARIABLE","$unsigned",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_STRING","preg_match",84],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\\sUNSIGNED\/i'",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$definition",84],")",["T_WHITESPACE"," ",84],">",["T_WHITESPACE"," ",84],["T_LNUMBER","0",84],";",["T_WHITESPACE","\n\n                ",84],["T_VARIABLE","$result",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_ARRAY","array",86],"(",["T_WHITESPACE","\n                    ",86],["T_CONSTANT_ENCAPSED_STRING","'type'",87],["T_WHITESPACE"," ",87],["T_DOUBLE_ARROW","=>",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$type",87],",",["T_WHITESPACE","\n                    ",87],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$unsigned",88],["T_WHITESPACE","\n                ",88],")",";",["T_WHITESPACE","\n                ",89],["T_BREAK","break",90],";",["T_WHITESPACE","\n            ",90],"}",["T_WHITESPACE","\n            ",91],["T_IF","if",92],["T_WHITESPACE"," ",92],"(",["T_VARIABLE","$result",92],")",["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n                ",92],["T_BREAK","break",93],";",["T_WHITESPACE","\n            ",93],"}",["T_WHITESPACE","\n        ",94],"}",["T_WHITESPACE","\n\n        ",95],["T_RETURN","return",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$result",97],";",["T_WHITESPACE","\n    ",97],"}",["T_WHITESPACE","\n\n    ",98],["T_DOC_COMMENT","\/**\n     * Replaces first occurence of $needle in a $haystack\n     *\n     * @param string $haystack\n     * @param string $needle\n     * @param array $replacement\n     * @param bool $caseInsensitive\n     * @return string\n     *\/",100],["T_WHITESPACE","\n    ",108],["T_PROTECTED","protected",109],["T_WHITESPACE"," ",109],["T_FUNCTION","function",109],["T_WHITESPACE"," ",109],["T_STRING","_firstReplace",109],"(",["T_VARIABLE","$haystack",109],",",["T_WHITESPACE"," ",109],["T_VARIABLE","$needle",109],",",["T_WHITESPACE"," ",109],["T_VARIABLE","$replacement",109],",",["T_WHITESPACE"," ",109],["T_VARIABLE","$caseInsensitive",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_STRING","false",109],")",["T_WHITESPACE","\n    ",109],"{",["T_WHITESPACE","\n        ",110],["T_VARIABLE","$pos",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_VARIABLE","$caseInsensitive",111],["T_WHITESPACE"," ",111],"?",["T_WHITESPACE"," ",111],["T_STRING","stripos",111],"(",["T_VARIABLE","$haystack",111],",",["T_WHITESPACE"," ",111],["T_VARIABLE","$needle",111],")",["T_WHITESPACE"," ",111],":",["T_WHITESPACE"," ",111],["T_STRING","strpos",111],"(",["T_VARIABLE","$haystack",111],",",["T_WHITESPACE"," ",111],["T_VARIABLE","$needle",111],")",";",["T_WHITESPACE","\n        ",111],["T_IF","if",112],["T_WHITESPACE"," ",112],"(",["T_VARIABLE","$pos",112],["T_WHITESPACE"," ",112],["T_IS_IDENTICAL","===",112],["T_WHITESPACE"," ",112],["T_STRING","false",112],")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n            ",112],["T_RETURN","return",113],["T_WHITESPACE"," ",113],["T_VARIABLE","$haystack",113],";",["T_WHITESPACE","\n        ",113],"}",["T_WHITESPACE","\n\n        ",114],["T_RETURN","return",116],["T_WHITESPACE"," ",116],["T_STRING","substr",116],"(",["T_VARIABLE","$haystack",116],",",["T_WHITESPACE"," ",116],["T_LNUMBER","0",116],",",["T_WHITESPACE"," ",116],["T_VARIABLE","$pos",116],")",["T_WHITESPACE"," ",116],".",["T_WHITESPACE"," ",116],["T_VARIABLE","$replacement",116],["T_WHITESPACE"," ",116],".",["T_WHITESPACE"," ",116],["T_STRING","substr",116],"(",["T_VARIABLE","$haystack",116],",",["T_WHITESPACE"," ",116],["T_VARIABLE","$pos",116],["T_WHITESPACE"," ",116],"+",["T_WHITESPACE"," ",116],["T_STRING","strlen",116],"(",["T_VARIABLE","$needle",116],")",")",";",["T_WHITESPACE","\n    ",116],"}",["T_WHITESPACE","\n\n    ",117],["T_DOC_COMMENT","\/**\n     * Fixes column definition in CREATE TABLE sql to match defintion of column it's set to\n     *\n     * @param string $sql\n     * @param string $column\n     * @param array $refColumnDefinition\n     * @return Mage_Core_Model_Resource_Setup_Query_Modifier\n     *\/",119],["T_WHITESPACE","\n    ",126],["T_PROTECTED","protected",127],["T_WHITESPACE"," ",127],["T_FUNCTION","function",127],["T_WHITESPACE"," ",127],["T_STRING","_fixColumnDefinitionInSql",127],"(","&",["T_VARIABLE","$sql",127],",",["T_WHITESPACE"," ",127],["T_VARIABLE","$column",127],",",["T_WHITESPACE"," ",127],["T_VARIABLE","$refColumnDefinition",127],")",["T_WHITESPACE","\n    ",127],"{",["T_WHITESPACE","\n        ",128],["T_VARIABLE","$pos",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_STRING","stripos",129],"(",["T_VARIABLE","$sql",129],",",["T_WHITESPACE"," ",129],"\"",["T_ENCAPSED_AND_WHITESPACE","`",129],["T_CURLY_OPEN","{",129],["T_VARIABLE","$column",129],"}",["T_ENCAPSED_AND_WHITESPACE","`",129],"\"",")",";",["T_WHITESPACE"," ",129],["T_COMMENT","\/\/ First try to find column directly recorded\n",129],["T_WHITESPACE","        ",130],["T_IF","if",130],["T_WHITESPACE"," ",130],"(",["T_VARIABLE","$pos",130],["T_WHITESPACE"," ",130],["T_IS_IDENTICAL","===",130],["T_WHITESPACE"," ",130],["T_STRING","false",130],")",["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n            ",130],["T_VARIABLE","$pattern",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","'\/[`\\s]'",131],["T_WHITESPACE"," ",131],".",["T_WHITESPACE"," ",131],["T_STRING","preg_quote",131],"(",["T_VARIABLE","$column",131],",",["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","'\/'",131],")",["T_WHITESPACE"," ",131],".",["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","'[`\\s]\/i'",131],";",["T_WHITESPACE","\n            ",131],["T_IF","if",132],["T_WHITESPACE"," ",132],"(","!",["T_STRING","preg_match",132],"(",["T_VARIABLE","$pattern",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$sql",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$matches",132],")",")",["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n                ",132],["T_RETURN","return",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],";",["T_WHITESPACE","\n            ",133],"}",["T_WHITESPACE","\n\n            ",134],["T_VARIABLE","$columnEntry",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_VARIABLE","$matches",136],"[",["T_LNUMBER","0",136],"]",";",["T_WHITESPACE","\n            ",136],["T_VARIABLE","$pos",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_STRING","strpos",137],"(",["T_VARIABLE","$sql",137],",",["T_WHITESPACE"," ",137],["T_VARIABLE","$columnEntry",137],")",";",["T_WHITESPACE","\n            ",137],["T_IF","if",138],["T_WHITESPACE"," ",138],"(",["T_VARIABLE","$pos",138],["T_WHITESPACE"," ",138],["T_IS_IDENTICAL","===",138],["T_WHITESPACE"," ",138],["T_STRING","false",138],")",["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n                ",138],["T_RETURN","return",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],";",["T_WHITESPACE","\n            ",139],"}",["T_WHITESPACE","\n        ",140],"}",["T_WHITESPACE","\n\n        ",141],["T_VARIABLE","$startSql",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_STRING","substr",143],"(",["T_VARIABLE","$sql",143],",",["T_WHITESPACE"," ",143],["T_LNUMBER","0",143],",",["T_WHITESPACE"," ",143],["T_VARIABLE","$pos",143],")",";",["T_WHITESPACE","\n        ",143],["T_VARIABLE","$restSql",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_STRING","substr",144],"(",["T_VARIABLE","$sql",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$pos",144],")",";",["T_WHITESPACE","\n\n        ",144],["T_COMMENT","\/\/ Column type definition\n",146],["T_WHITESPACE","        ",147],["T_VARIABLE","$columnDefinition",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","_getColumnDefinitionFromSql",147],"(",["T_VARIABLE","$sql",147],",",["T_WHITESPACE"," ",147],["T_VARIABLE","$column",147],")",";",["T_WHITESPACE","\n        ",147],["T_IF","if",148],["T_WHITESPACE"," ",148],"(","!",["T_VARIABLE","$columnDefinition",148],")",["T_WHITESPACE"," ",148],"{",["T_WHITESPACE","\n            ",148],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],";",["T_WHITESPACE","\n        ",149],"}",["T_WHITESPACE","\n\n        ",150],["T_COMMENT","\/\/ Find pattern for type defintion\n",152],["T_WHITESPACE","        ",153],["T_VARIABLE","$pattern",153],["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_CONSTANT_ENCAPSED_STRING","'\/\\s*([^\\s]+)\\s+('",153],["T_WHITESPACE"," ",153],".",["T_WHITESPACE"," ",153],["T_VARIABLE","$columnDefinition",153],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",153],"]",["T_WHITESPACE"," ",153],".",["T_WHITESPACE"," ",153],["T_CONSTANT_ENCAPSED_STRING","'[^\\s]*)\\s+([^,]+)\/i'",153],";",["T_WHITESPACE","\n        ",153],["T_IF","if",154],["T_WHITESPACE"," ",154],"(","!",["T_STRING","preg_match",154],"(",["T_VARIABLE","$pattern",154],",",["T_WHITESPACE"," ",154],["T_VARIABLE","$restSql",154],",",["T_WHITESPACE"," ",154],["T_VARIABLE","$matches",154],")",")",["T_WHITESPACE"," ",154],"{",["T_WHITESPACE","\n            ",154],["T_RETURN","return",155],["T_WHITESPACE"," ",155],["T_VARIABLE","$this",155],";",["T_WHITESPACE","\n        ",155],"}",["T_WHITESPACE","\n\n        ",156],["T_COMMENT","\/\/ Replace defined type with needed type\n",158],["T_WHITESPACE","        ",159],["T_VARIABLE","$typeDefined",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_VARIABLE","$matches",159],"[",["T_LNUMBER","2",159],"]",";",["T_WHITESPACE","\n        ",159],["T_VARIABLE","$typeNeeded",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_VARIABLE","$refColumnDefinition",160],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",160],"]",";",["T_WHITESPACE","\n        ",160],["T_IF","if",161],["T_WHITESPACE"," ",161],"(",["T_VARIABLE","$refColumnDefinition",161],"[",["T_CONSTANT_ENCAPSED_STRING","'unsigned'",161],"]",["T_WHITESPACE"," ",161],["T_BOOLEAN_AND","&&",161],["T_WHITESPACE"," ",161],"!",["T_VARIABLE","$columnDefinition",161],"[",["T_CONSTANT_ENCAPSED_STRING","'unsigned'",161],"]",")",["T_WHITESPACE"," ",161],"{",["T_WHITESPACE","\n            ",161],["T_VARIABLE","$typeNeeded",162],["T_WHITESPACE"," ",162],["T_CONCAT_EQUAL",".=",162],["T_WHITESPACE"," ",162],["T_CONSTANT_ENCAPSED_STRING","' unsigned'",162],";",["T_WHITESPACE","\n        ",162],"}",["T_WHITESPACE","\n\n        ",163],["T_VARIABLE","$restSql",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","_firstReplace",165],"(",["T_VARIABLE","$restSql",165],",",["T_WHITESPACE"," ",165],["T_VARIABLE","$typeDefined",165],",",["T_WHITESPACE"," ",165],["T_VARIABLE","$typeNeeded",165],")",";",["T_WHITESPACE","\n\n        ",165],["T_IF","if",167],["T_WHITESPACE"," ",167],"(","!",["T_VARIABLE","$refColumnDefinition",167],"[",["T_CONSTANT_ENCAPSED_STRING","'unsigned'",167],"]",["T_WHITESPACE"," ",167],["T_BOOLEAN_AND","&&",167],["T_WHITESPACE"," ",167],"(",["T_VARIABLE","$columnDefinition",167],"[",["T_CONSTANT_ENCAPSED_STRING","'unsigned'",167],"]",")",")",["T_WHITESPACE"," ",167],"{",["T_WHITESPACE","\n            ",167],["T_VARIABLE","$restSql",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","_firstReplace",168],"(",["T_VARIABLE","$restSql",168],",",["T_WHITESPACE"," ",168],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",168],",",["T_WHITESPACE"," ",168],["T_CONSTANT_ENCAPSED_STRING","''",168],",",["T_WHITESPACE"," ",168],["T_STRING","true",168],")",";",["T_WHITESPACE","\n        ",168],"}",["T_WHITESPACE","\n\n        ",169],["T_COMMENT","\/\/ Compose SQL back\n",171],["T_WHITESPACE","        ",172],["T_VARIABLE","$sql",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_VARIABLE","$startSql",172],["T_WHITESPACE"," ",172],".",["T_WHITESPACE"," ",172],["T_VARIABLE","$restSql",172],";",["T_WHITESPACE","\n\n        ",172],["T_RETURN","return",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],";",["T_WHITESPACE","\n    ",174],"}",["T_WHITESPACE","\n\n    ",175],["T_DOC_COMMENT","\/**\n     * Fixes column definition in already existing table, so outgoing foreign key will be successfully set\n     *\n     * @param string $sql\n     * @param string $column\n     * @param array $refColumnDefinition\n     * @return Mage_Core_Model_Resource_Setup_Query_Modifier\n     *\/",177],["T_WHITESPACE","\n    ",184],["T_PROTECTED","protected",185],["T_WHITESPACE"," ",185],["T_FUNCTION","function",185],["T_WHITESPACE"," ",185],["T_STRING","_fixColumnDefinitionInTable",185],"(",["T_VARIABLE","$table",185],",",["T_WHITESPACE"," ",185],["T_VARIABLE","$column",185],",",["T_WHITESPACE"," ",185],["T_VARIABLE","$refColumnDefinition",185],")",["T_WHITESPACE","\n    ",185],"{",["T_WHITESPACE","\n        ",186],["T_VARIABLE","$description",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","_adapter",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","fetchAll",187],"(",["T_CONSTANT_ENCAPSED_STRING","'DESCRIBE '",187],["T_WHITESPACE"," ",187],".",["T_WHITESPACE"," ",187],["T_VARIABLE","$table",187],")",";",["T_WHITESPACE","\n        ",187],["T_FOREACH","foreach",188],["T_WHITESPACE"," ",188],"(",["T_VARIABLE","$description",188],["T_WHITESPACE"," ",188],["T_AS","as",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$columnData",188],")",["T_WHITESPACE"," ",188],"{",["T_WHITESPACE","\n            ",188],["T_VARIABLE","$columnName",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","_prepareIdentifier",189],"(",["T_VARIABLE","$columnData",189],"[",["T_CONSTANT_ENCAPSED_STRING","'Field'",189],"]",")",";",["T_WHITESPACE","\n            ",189],["T_IF","if",190],["T_WHITESPACE"," ",190],"(",["T_VARIABLE","$columnName",190],["T_WHITESPACE"," ",190],["T_IS_NOT_EQUAL","!=",190],["T_WHITESPACE"," ",190],["T_VARIABLE","$column",190],")",["T_WHITESPACE"," ",190],"{",["T_WHITESPACE","\n                ",190],["T_CONTINUE","continue",191],";",["T_WHITESPACE","\n            ",191],"}",["T_WHITESPACE","\n            ",192],["T_VARIABLE","$definition",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_VARIABLE","$refColumnDefinition",193],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",193],"]",";",["T_WHITESPACE","\n            ",193],["T_IF","if",194],["T_WHITESPACE"," ",194],"(",["T_VARIABLE","$refColumnDefinition",194],"[",["T_CONSTANT_ENCAPSED_STRING","'unsigned'",194],"]",")",["T_WHITESPACE"," ",194],"{",["T_WHITESPACE","\n                ",194],["T_VARIABLE","$definition",195],["T_WHITESPACE"," ",195],["T_CONCAT_EQUAL",".=",195],["T_WHITESPACE"," ",195],["T_CONSTANT_ENCAPSED_STRING","' UNSIGNED'",195],";",["T_WHITESPACE","\n            ",195],"}",["T_WHITESPACE","\n            ",196],["T_IF","if",197],["T_WHITESPACE"," ",197],"(",["T_VARIABLE","$columnData",197],"[",["T_CONSTANT_ENCAPSED_STRING","'Null'",197],"]",["T_WHITESPACE"," ",197],["T_IS_EQUAL","==",197],["T_WHITESPACE"," ",197],["T_CONSTANT_ENCAPSED_STRING","'YES'",197],")",["T_WHITESPACE"," ",197],"{",["T_WHITESPACE","\n                ",197],["T_VARIABLE","$definition",198],["T_WHITESPACE"," ",198],["T_CONCAT_EQUAL",".=",198],["T_WHITESPACE"," ",198],["T_CONSTANT_ENCAPSED_STRING","' NULL'",198],";",["T_WHITESPACE","\n            ",198],"}",["T_WHITESPACE"," ",199],["T_ELSE","else",199],["T_WHITESPACE"," ",199],"{",["T_WHITESPACE","\n                ",199],["T_VARIABLE","$definition",200],["T_WHITESPACE"," ",200],["T_CONCAT_EQUAL",".=",200],["T_WHITESPACE"," ",200],["T_CONSTANT_ENCAPSED_STRING","' NOT NULL'",200],";",["T_WHITESPACE","\n            ",200],"}",["T_WHITESPACE","\n            ",201],["T_IF","if",202],["T_WHITESPACE"," ",202],"(",["T_VARIABLE","$columnData",202],"[",["T_CONSTANT_ENCAPSED_STRING","'Default'",202],"]",")",["T_WHITESPACE"," ",202],"{",["T_WHITESPACE","\n                ",202],["T_VARIABLE","$definition",203],["T_WHITESPACE"," ",203],["T_CONCAT_EQUAL",".=",203],["T_WHITESPACE"," ",203],["T_CONSTANT_ENCAPSED_STRING","' DEFAULT '",203],["T_WHITESPACE"," ",203],".",["T_WHITESPACE"," ",203],["T_VARIABLE","$columnData",203],"[",["T_CONSTANT_ENCAPSED_STRING","'Default'",203],"]",";",["T_WHITESPACE","\n            ",203],"}",["T_WHITESPACE","\n            ",204],["T_IF","if",205],["T_WHITESPACE"," ",205],"(",["T_VARIABLE","$columnData",205],"[",["T_CONSTANT_ENCAPSED_STRING","'Extra'",205],"]",")",["T_WHITESPACE"," ",205],"{",["T_WHITESPACE","\n                ",205],["T_VARIABLE","$definition",206],["T_WHITESPACE"," ",206],["T_CONCAT_EQUAL",".=",206],["T_WHITESPACE"," ",206],["T_CONSTANT_ENCAPSED_STRING","' '",206],["T_WHITESPACE"," ",206],".",["T_WHITESPACE"," ",206],["T_VARIABLE","$columnData",206],"[",["T_CONSTANT_ENCAPSED_STRING","'Extra'",206],"]",";",["T_WHITESPACE","\n            ",206],"}",["T_WHITESPACE","\n\n            ",207],["T_VARIABLE","$query",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_CONSTANT_ENCAPSED_STRING","'ALTER TABLE '",209],["T_WHITESPACE"," ",209],".",["T_WHITESPACE"," ",209],["T_VARIABLE","$table",209],["T_WHITESPACE"," ",209],".",["T_WHITESPACE"," ",209],["T_CONSTANT_ENCAPSED_STRING","' MODIFY COLUMN '",209],["T_WHITESPACE"," ",209],".",["T_WHITESPACE"," ",209],["T_VARIABLE","$column",209],["T_WHITESPACE"," ",209],".",["T_WHITESPACE"," ",209],["T_CONSTANT_ENCAPSED_STRING","' '",209],["T_WHITESPACE"," ",209],".",["T_WHITESPACE"," ",209],["T_VARIABLE","$definition",209],";",["T_WHITESPACE","\n            ",209],["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","_adapter",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","query",210],"(",["T_VARIABLE","$query",210],")",";",["T_WHITESPACE","\n        ",210],"}",["T_WHITESPACE","\n        ",211],["T_RETURN","return",212],["T_WHITESPACE"," ",212],["T_VARIABLE","$this",212],";",["T_WHITESPACE","\n    ",212],"}",["T_WHITESPACE","\n\n    ",213],["T_DOC_COMMENT","\/**\n     * Returns column definition from already existing table\n     *\n     * @param string $sql\n     * @param string $column\n     * @return array|null\n     *\/",215],["T_WHITESPACE","\n    ",221],["T_PROTECTED","protected",222],["T_WHITESPACE"," ",222],["T_FUNCTION","function",222],["T_WHITESPACE"," ",222],["T_STRING","_getColumnDefinitionFromTable",222],"(",["T_VARIABLE","$table",222],",",["T_WHITESPACE"," ",222],["T_VARIABLE","$column",222],")",["T_WHITESPACE","\n    ",222],"{",["T_WHITESPACE","\n        ",223],["T_VARIABLE","$description",224],["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","_adapter",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","describeTable",224],"(",["T_VARIABLE","$table",224],")",";",["T_WHITESPACE","\n        ",224],["T_IF","if",225],["T_WHITESPACE"," ",225],"(","!",["T_ISSET","isset",225],"(",["T_VARIABLE","$description",225],"[",["T_VARIABLE","$column",225],"]",")",")",["T_WHITESPACE"," ",225],"{",["T_WHITESPACE","\n            ",225],["T_RETURN","return",226],["T_WHITESPACE"," ",226],["T_STRING","null",226],";",["T_WHITESPACE","\n        ",226],"}",["T_WHITESPACE","\n\n        ",227],["T_RETURN","return",229],["T_WHITESPACE"," ",229],["T_ARRAY","array",229],"(",["T_WHITESPACE","\n            ",229],["T_CONSTANT_ENCAPSED_STRING","'type'",230],["T_WHITESPACE"," ",230],["T_DOUBLE_ARROW","=>",230],["T_WHITESPACE"," ",230],["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","_prepareIdentifier",230],"(",["T_VARIABLE","$description",230],"[",["T_VARIABLE","$column",230],"]","[",["T_CONSTANT_ENCAPSED_STRING","'DATA_TYPE'",230],"]",")",",",["T_WHITESPACE","\n            ",230],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",231],["T_WHITESPACE"," ",231],["T_DOUBLE_ARROW","=>",231],["T_WHITESPACE"," ",231],["T_BOOL_CAST","(bool)",231],["T_WHITESPACE"," ",231],["T_VARIABLE","$description",231],"[",["T_VARIABLE","$column",231],"]","[",["T_CONSTANT_ENCAPSED_STRING","'UNSIGNED'",231],"]",["T_WHITESPACE","\n        ",231],")",";",["T_WHITESPACE","\n    ",232],"}",["T_WHITESPACE","\n\n    ",233],["T_DOC_COMMENT","\/**\n     * Returns whether table exists\n     *\n     * @param string $table\n     * @return bool\n     *\/",235],["T_WHITESPACE","\n    ",240],["T_PROTECTED","protected",241],["T_WHITESPACE"," ",241],["T_FUNCTION","function",241],["T_WHITESPACE"," ",241],["T_STRING","_tableExists",241],"(",["T_VARIABLE","$table",241],")",["T_WHITESPACE","\n    ",241],"{",["T_WHITESPACE","\n        ",242],["T_VARIABLE","$rows",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","_adapter",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","fetchAll",243],"(",["T_CONSTANT_ENCAPSED_STRING","'SHOW TABLES'",243],")",";",["T_WHITESPACE","\n        ",243],["T_FOREACH","foreach",244],["T_WHITESPACE"," ",244],"(",["T_VARIABLE","$rows",244],["T_WHITESPACE"," ",244],["T_AS","as",244],["T_WHITESPACE"," ",244],["T_VARIABLE","$row",244],")",["T_WHITESPACE"," ",244],"{",["T_WHITESPACE","\n            ",244],["T_VARIABLE","$tableFound",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_STRING","strtolower",245],"(",["T_STRING","current",245],"(",["T_VARIABLE","$row",245],")",")",";",["T_WHITESPACE","\n            ",245],["T_IF","if",246],["T_WHITESPACE"," ",246],"(",["T_VARIABLE","$table",246],["T_WHITESPACE"," ",246],["T_IS_EQUAL","==",246],["T_WHITESPACE"," ",246],["T_VARIABLE","$tableFound",246],")",["T_WHITESPACE"," ",246],"{",["T_WHITESPACE","\n                ",246],["T_RETURN","return",247],["T_WHITESPACE"," ",247],["T_STRING","true",247],";",["T_WHITESPACE","\n            ",247],"}",["T_WHITESPACE","\n        ",248],"}",["T_WHITESPACE","\n        ",249],["T_RETURN","return",250],["T_WHITESPACE"," ",250],["T_STRING","false",250],";",["T_WHITESPACE","\n    ",250],"}",["T_WHITESPACE","\n\n    ",251],["T_DOC_COMMENT","\/**\n     * Trims and lowercases identifier, to make common view of all of them\n     *\n     * @param string $identifier\n     * @return string\n     *\/",253],["T_WHITESPACE","\n    ",258],["T_PROTECTED","protected",259],["T_WHITESPACE"," ",259],["T_FUNCTION","function",259],["T_WHITESPACE"," ",259],["T_STRING","_prepareIdentifier",259],"(",["T_VARIABLE","$identifier",259],")",["T_WHITESPACE","\n    ",259],"{",["T_WHITESPACE","\n        ",260],["T_RETURN","return",261],["T_WHITESPACE"," ",261],["T_STRING","strtolower",261],"(",["T_STRING","trim",261],"(",["T_VARIABLE","$identifier",261],",",["T_WHITESPACE"," ",261],["T_CONSTANT_ENCAPSED_STRING","\"`\\n\\r\\t\"",261],")",")",";",["T_WHITESPACE","\n    ",261],"}",["T_WHITESPACE","\n\n    ",262],["T_DOC_COMMENT","\/**\n     * Processes query, modifies targeted columns to fit foreign keys restrictions\n     *\n     * @param string $sql\n     * @param array $bind\n     * @return Mage_Core_Model_Resource_Setup_Query_Modifier\n     *\/",264],["T_WHITESPACE","\n    ",270],["T_PUBLIC","public",271],["T_WHITESPACE"," ",271],["T_FUNCTION","function",271],["T_WHITESPACE"," ",271],["T_STRING","processQuery",271],"(","&",["T_VARIABLE","$sql",271],",",["T_WHITESPACE"," ",271],"&",["T_VARIABLE","$bind",271],")",["T_WHITESPACE","\n    ",271],"{",["T_WHITESPACE","\n        ",272],["T_COMMENT","\/\/ Quick test to skip queries without foreign keys\n",273],["T_WHITESPACE","        ",274],["T_IF","if",274],["T_WHITESPACE"," ",274],"(","!",["T_STRING","stripos",274],"(",["T_VARIABLE","$sql",274],",",["T_WHITESPACE"," ",274],["T_CONSTANT_ENCAPSED_STRING","'foreign'",274],")",")",["T_WHITESPACE"," ",274],"{",["T_WHITESPACE","\n            ",274],["T_RETURN","return",275],["T_WHITESPACE"," ",275],["T_VARIABLE","$this",275],";",["T_WHITESPACE","\n        ",275],"}",["T_WHITESPACE","\n\n        ",276],["T_COMMENT","\/\/ Find foreign keys set\n",278],["T_WHITESPACE","        ",279],["T_VARIABLE","$pattern",279],["T_WHITESPACE"," ",279],"=",["T_WHITESPACE"," ",279],["T_CONSTANT_ENCAPSED_STRING","'\/CONSTRAINT\\s+[^\\s]+\\s+FOREIGN\\s+KEY[^(]+\\\\(([^),]+)\\\\)\\s+REFERENCES\\s+([^\\s.]+)\\s+\\\\(([^)]+)\\\\)\/i'",279],";",["T_WHITESPACE","\n        ",279],["T_IF","if",280],["T_WHITESPACE"," ",280],"(","!",["T_STRING","preg_match_all",280],"(",["T_VARIABLE","$pattern",280],",",["T_WHITESPACE"," ",280],["T_VARIABLE","$sql",280],",",["T_WHITESPACE"," ",280],["T_VARIABLE","$matchesFk",280],",",["T_WHITESPACE"," ",280],["T_STRING","PREG_SET_ORDER",280],")",")",["T_WHITESPACE"," ",280],"{",["T_WHITESPACE","\n            ",280],["T_RETURN","return",281],["T_WHITESPACE"," ",281],["T_VARIABLE","$this",281],";",["T_WHITESPACE","\n        ",281],"}",["T_WHITESPACE","\n\n        ",282],["T_COMMENT","\/\/ Get current table name\n",284],["T_WHITESPACE","        ",285],["T_IF","if",285],["T_WHITESPACE"," ",285],"(","!",["T_STRING","preg_match",285],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\\s*(CREATE|ALTER)\\s+TABLE\\s+([^\\s.]+)\/i'",285],",",["T_WHITESPACE"," ",285],["T_VARIABLE","$sql",285],",",["T_WHITESPACE"," ",285],["T_VARIABLE","$match",285],")",")",["T_WHITESPACE"," ",285],"{",["T_WHITESPACE","\n            ",285],["T_RETURN","return",286],["T_WHITESPACE"," ",286],["T_VARIABLE","$this",286],";",["T_WHITESPACE","\n        ",286],"}",["T_WHITESPACE","\n\n        ",287],["T_VARIABLE","$operation",289],["T_WHITESPACE"," ",289],"=",["T_WHITESPACE"," ",289],["T_VARIABLE","$this",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","_prepareIdentifier",289],"(",["T_VARIABLE","$match",289],"[",["T_LNUMBER","1",289],"]",")",";",["T_WHITESPACE","\n        ",289],["T_VARIABLE","$table",290],["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],["T_VARIABLE","$this",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","_prepareIdentifier",290],"(",["T_VARIABLE","$match",290],"[",["T_LNUMBER","2",290],"]",")",";",["T_WHITESPACE","\n\n        ",290],["T_COMMENT","\/\/ Process all\n",292],["T_WHITESPACE","        ",293],["T_FOREACH","foreach",293],["T_WHITESPACE"," ",293],"(",["T_VARIABLE","$matchesFk",293],["T_WHITESPACE"," ",293],["T_AS","as",293],["T_WHITESPACE"," ",293],["T_VARIABLE","$match",293],")",["T_WHITESPACE"," ",293],"{",["T_WHITESPACE","\n            ",293],["T_VARIABLE","$column",294],["T_WHITESPACE"," ",294],"=",["T_WHITESPACE"," ",294],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","_prepareIdentifier",294],"(",["T_VARIABLE","$match",294],"[",["T_LNUMBER","1",294],"]",")",";",["T_WHITESPACE","\n            ",294],["T_VARIABLE","$refTable",295],["T_WHITESPACE"," ",295],"=",["T_WHITESPACE"," ",295],["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","_prepareIdentifier",295],"(",["T_VARIABLE","$match",295],"[",["T_LNUMBER","2",295],"]",")",";",["T_WHITESPACE","\n            ",295],["T_VARIABLE","$refColumn",296],["T_WHITESPACE"," ",296],"=",["T_WHITESPACE"," ",296],["T_VARIABLE","$this",296],["T_OBJECT_OPERATOR","->",296],["T_STRING","_prepareIdentifier",296],"(",["T_VARIABLE","$match",296],"[",["T_LNUMBER","3",296],"]",")",";",["T_WHITESPACE","\n\n            ",296],["T_COMMENT","\/\/ Check tables existance\n",298],["T_WHITESPACE","            ",299],["T_IF","if",299],["T_WHITESPACE"," ",299],"(","(",["T_VARIABLE","$operation",299],["T_WHITESPACE"," ",299],["T_IS_NOT_EQUAL","!=",299],["T_WHITESPACE"," ",299],["T_CONSTANT_ENCAPSED_STRING","'create'",299],")",["T_WHITESPACE"," ",299],["T_BOOLEAN_AND","&&",299],["T_WHITESPACE"," ",299],"!","(",["T_VARIABLE","$this",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","_tableExists",299],"(",["T_VARIABLE","$table",299],")",")",")",["T_WHITESPACE"," ",299],"{",["T_WHITESPACE","\n                ",299],["T_CONTINUE","continue",300],";",["T_WHITESPACE","\n            ",300],"}",["T_WHITESPACE","\n            ",301],["T_IF","if",302],["T_WHITESPACE"," ",302],"(","!",["T_VARIABLE","$this",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","_tableExists",302],"(",["T_VARIABLE","$refTable",302],")",")",["T_WHITESPACE"," ",302],"{",["T_WHITESPACE","\n                ",302],["T_CONTINUE","continue",303],";",["T_WHITESPACE","\n            ",303],"}",["T_WHITESPACE","\n\n            ",304],["T_COMMENT","\/\/ Self references are out of our fix scope\n",306],["T_WHITESPACE","            ",307],["T_IF","if",307],["T_WHITESPACE"," ",307],"(",["T_VARIABLE","$refTable",307],["T_WHITESPACE"," ",307],["T_IS_EQUAL","==",307],["T_WHITESPACE"," ",307],["T_VARIABLE","$table",307],")",["T_WHITESPACE"," ",307],"{",["T_WHITESPACE","\n                ",307],["T_CONTINUE","continue",308],";",["T_WHITESPACE","\n            ",308],"}",["T_WHITESPACE","\n\n            ",309],["T_COMMENT","\/\/ Extract column type\n",311],["T_WHITESPACE","            ",312],["T_IF","if",312],["T_WHITESPACE"," ",312],"(",["T_VARIABLE","$operation",312],["T_WHITESPACE"," ",312],["T_IS_EQUAL","==",312],["T_WHITESPACE"," ",312],["T_CONSTANT_ENCAPSED_STRING","'create'",312],")",["T_WHITESPACE"," ",312],"{",["T_WHITESPACE","\n                ",312],["T_VARIABLE","$columnDefinition",313],["T_WHITESPACE"," ",313],"=",["T_WHITESPACE"," ",313],["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","_getColumnDefinitionFromSql",313],"(",["T_VARIABLE","$sql",313],",",["T_WHITESPACE"," ",313],["T_VARIABLE","$column",313],")",";",["T_WHITESPACE","\n            ",313],"}",["T_WHITESPACE"," ",314],["T_ELSE","else",314],["T_WHITESPACE"," ",314],"{",["T_WHITESPACE","\n                ",314],["T_VARIABLE","$columnDefinition",315],["T_WHITESPACE"," ",315],"=",["T_WHITESPACE"," ",315],["T_VARIABLE","$this",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","_getColumnDefinitionFromTable",315],"(",["T_VARIABLE","$table",315],",",["T_WHITESPACE"," ",315],["T_VARIABLE","$column",315],")",";",["T_WHITESPACE","\n            ",315],"}",["T_WHITESPACE","\n\n            ",316],["T_COMMENT","\/\/ We fix only int columns\n",318],["T_WHITESPACE","            ",319],["T_IF","if",319],["T_WHITESPACE"," ",319],"(","!",["T_VARIABLE","$columnDefinition",319],["T_WHITESPACE"," ",319],["T_BOOLEAN_OR","||",319],["T_WHITESPACE"," ",319],"!",["T_STRING","in_array",319],"(",["T_VARIABLE","$columnDefinition",319],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",319],"]",",",["T_WHITESPACE"," ",319],["T_VARIABLE","$this",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","_processedTypes",319],")",")",["T_WHITESPACE"," ",319],"{",["T_WHITESPACE","\n                ",319],["T_CONTINUE","continue",320],";",["T_WHITESPACE","\n            ",320],"}",["T_WHITESPACE","\n\n            ",321],["T_COMMENT","\/\/ Extract referenced column type\n",323],["T_WHITESPACE","            ",324],["T_VARIABLE","$refColumnDefinition",324],["T_WHITESPACE"," ",324],"=",["T_WHITESPACE"," ",324],["T_VARIABLE","$this",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","_getColumnDefinitionFromTable",324],"(",["T_VARIABLE","$refTable",324],",",["T_WHITESPACE"," ",324],["T_VARIABLE","$refColumn",324],")",";",["T_WHITESPACE","\n            ",324],["T_IF","if",325],["T_WHITESPACE"," ",325],"(","!",["T_VARIABLE","$refColumnDefinition",325],")",["T_WHITESPACE"," ",325],"{",["T_WHITESPACE","\n                ",325],["T_CONTINUE","continue",326],";",["T_WHITESPACE","\n            ",326],"}",["T_WHITESPACE","\n\n            ",327],["T_COMMENT","\/\/ We fix only int columns\n",329],["T_WHITESPACE","            ",330],["T_IF","if",330],["T_WHITESPACE"," ",330],"(","!",["T_VARIABLE","$refColumnDefinition",330],["T_WHITESPACE"," ",330],["T_BOOLEAN_OR","||",330],["T_WHITESPACE"," ",330],"!",["T_STRING","in_array",330],"(",["T_VARIABLE","$refColumnDefinition",330],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",330],"]",",",["T_WHITESPACE"," ",330],["T_VARIABLE","$this",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","_processedTypes",330],")",")",["T_WHITESPACE"," ",330],"{",["T_WHITESPACE","\n                ",330],["T_CONTINUE","continue",331],";",["T_WHITESPACE","\n            ",331],"}",["T_WHITESPACE","\n\n            ",332],["T_COMMENT","\/\/ Whether we need to fix\n",334],["T_WHITESPACE","            ",335],["T_IF","if",335],["T_WHITESPACE"," ",335],"(",["T_VARIABLE","$refColumnDefinition",335],["T_WHITESPACE"," ",335],["T_IS_EQUAL","==",335],["T_WHITESPACE"," ",335],["T_VARIABLE","$columnDefinition",335],")",["T_WHITESPACE"," ",335],"{",["T_WHITESPACE","\n                ",335],["T_CONTINUE","continue",336],";",["T_WHITESPACE","\n            ",336],"}",["T_WHITESPACE","\n\n            ",337],["T_COMMENT","\/\/ Fix column to be the same type as referenced one\n",339],["T_WHITESPACE","            ",340],["T_IF","if",340],["T_WHITESPACE"," ",340],"(",["T_VARIABLE","$operation",340],["T_WHITESPACE"," ",340],["T_IS_EQUAL","==",340],["T_WHITESPACE"," ",340],["T_CONSTANT_ENCAPSED_STRING","'create'",340],")",["T_WHITESPACE"," ",340],"{",["T_WHITESPACE","\n                ",340],["T_VARIABLE","$this",341],["T_OBJECT_OPERATOR","->",341],["T_STRING","_fixColumnDefinitionInSql",341],"(",["T_VARIABLE","$sql",341],",",["T_WHITESPACE"," ",341],["T_VARIABLE","$column",341],",",["T_WHITESPACE"," ",341],["T_VARIABLE","$refColumnDefinition",341],")",";",["T_WHITESPACE","\n            ",341],"}",["T_WHITESPACE"," ",342],["T_ELSE","else",342],["T_WHITESPACE"," ",342],"{",["T_WHITESPACE","\n                ",342],["T_VARIABLE","$this",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","_fixColumnDefinitionInTable",343],"(",["T_VARIABLE","$table",343],",",["T_WHITESPACE"," ",343],["T_VARIABLE","$column",343],",",["T_WHITESPACE"," ",343],["T_VARIABLE","$refColumnDefinition",343],")",";",["T_WHITESPACE","\n            ",343],"}",["T_WHITESPACE","\n        ",344],"}",["T_WHITESPACE","\n\n        ",345],["T_RETURN","return",347],["T_WHITESPACE"," ",347],["T_VARIABLE","$this",347],";",["T_WHITESPACE","\n    ",347],"}",["T_WHITESPACE","\n",348],"}",["T_WHITESPACE","\n",349]]