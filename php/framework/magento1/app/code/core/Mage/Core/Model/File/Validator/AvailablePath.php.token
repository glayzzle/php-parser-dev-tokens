[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Core\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Validator for check not protected\/available path\n *\n * Mask symbols from path:\n * \"?\" - something directory with any name\n * \"*\" - something directory structure, which can not exist\n * Note: For set directory structure which must be exist, need to set mask \"\/?\/{@*}\"\n * Mask symbols from filename:\n * \"*\" - something symbols in file name\n * Example:\n * <code>\n * \/\/set available path\n * $validator->setAvailablePath(array('\/path\/to\/?\/*fileMask.xml'));\n * $validator->isValid('\/path\/to\/MyDir\/Some-fileMask.xml'); \/\/return true\n * $validator->setAvailablePath(array('\/path\/to\/{@*}*.xml'));\n * $validator->isValid('\/path\/to\/my.xml'); \/\/return true, because directory structure can't exist\n * <\/code>\n *\n * @category   Mage\n * @package    Mage_Core\n * @author     Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",49],["T_CLASS","class",50],["T_WHITESPACE"," ",50],["T_STRING","Mage_Core_Model_File_Validator_AvailablePath",50],["T_WHITESPACE"," ",50],["T_EXTENDS","extends",50],["T_WHITESPACE"," ",50],["T_STRING","Zend_Validate_Abstract",50],["T_WHITESPACE","\n",50],"{",["T_WHITESPACE","\n    ",51],["T_CONST","const",52],["T_WHITESPACE"," ",52],["T_STRING","PROTECTED_PATH",52],["T_WHITESPACE","     ",52],"=",["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'protectedPath'",52],";",["T_WHITESPACE","\n    ",52],["T_CONST","const",53],["T_WHITESPACE"," ",53],["T_STRING","NOT_AVAILABLE_PATH",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","'notAvailablePath'",53],";",["T_WHITESPACE","\n    ",53],["T_CONST","const",54],["T_WHITESPACE"," ",54],["T_STRING","PROTECTED_LFI",54],["T_WHITESPACE","      ",54],"=",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'protectedLfi'",54],";",["T_WHITESPACE","\n\n    ",54],["T_DOC_COMMENT","\/**\n     * The path\n     *\n     * @var string\n     *\/",56],["T_WHITESPACE","\n    ",60],["T_PROTECTED","protected",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$_value",61],";",["T_WHITESPACE","\n\n    ",61],["T_DOC_COMMENT","\/**\n     * Protected paths\n     *\n     * @var array\n     *\/",63],["T_WHITESPACE","\n    ",67],["T_PROTECTED","protected",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$_protectedPaths",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_ARRAY","array",68],"(",")",";",["T_WHITESPACE","\n\n    ",68],["T_DOC_COMMENT","\/**\n     * Available paths\n     *\n     * @var array\n     *\/",70],["T_WHITESPACE","\n    ",74],["T_PROTECTED","protected",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$_availablePaths",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_ARRAY","array",75],"(",")",";",["T_WHITESPACE","\n\n    ",75],["T_DOC_COMMENT","\/**\n     * Cache of made regular expressions from path masks\n     *\n     * @var array\n     *\/",77],["T_WHITESPACE","\n    ",81],["T_PROTECTED","protected",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$_pathsData",82],";",["T_WHITESPACE","\n\n    ",82],["T_DOC_COMMENT","\/**\n     * Construct\n     *\/",84],["T_WHITESPACE","\n    ",86],["T_PUBLIC","public",87],["T_WHITESPACE"," ",87],["T_FUNCTION","function",87],["T_WHITESPACE"," ",87],["T_STRING","__construct",87],"(",")",["T_WHITESPACE","\n    ",87],"{",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","_initMessageTemplates",89],"(",")",";",["T_WHITESPACE","\n    ",89],"}",["T_WHITESPACE","\n\n    ",90],["T_DOC_COMMENT","\/**\n     * Initialize message templates with translating\n     *\n     * @return Mage_Core_Model_File_Validator_AvailablePath\n     *\/",92],["T_WHITESPACE","\n    ",96],["T_PROTECTED","protected",97],["T_WHITESPACE"," ",97],["T_FUNCTION","function",97],["T_WHITESPACE"," ",97],["T_STRING","_initMessageTemplates",97],"(",")",["T_WHITESPACE","\n    ",97],"{",["T_WHITESPACE","\n        ",98],["T_IF","if",99],["T_WHITESPACE"," ",99],"(","!",["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","_messageTemplates",99],")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n            ",99],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","_messageTemplates",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_ARRAY","array",100],"(",["T_WHITESPACE","\n                ",100],["T_STRING","self",101],["T_DOUBLE_COLON","::",101],["T_STRING","PROTECTED_PATH",101],["T_WHITESPACE"," ",101],["T_DOUBLE_ARROW","=>",101],["T_WHITESPACE","\n                    ",101],["T_STRING","Mage",102],["T_DOUBLE_COLON","::",102],["T_STRING","helper",102],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",102],")",["T_OBJECT_OPERATOR","->",102],["T_STRING","__",102],"(",["T_CONSTANT_ENCAPSED_STRING","'Path \"%value%\" is protected and cannot be used.'",102],")",",",["T_WHITESPACE","\n                ",102],["T_STRING","self",103],["T_DOUBLE_COLON","::",103],["T_STRING","NOT_AVAILABLE_PATH",103],["T_WHITESPACE"," ",103],["T_DOUBLE_ARROW","=>",103],["T_WHITESPACE","\n                    ",103],["T_STRING","Mage",104],["T_DOUBLE_COLON","::",104],["T_STRING","helper",104],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",104],")",["T_OBJECT_OPERATOR","->",104],["T_STRING","__",104],"(",["T_CONSTANT_ENCAPSED_STRING","'Path \"%value%\" is not available and cannot be used.'",104],")",",",["T_WHITESPACE","\n                ",104],["T_STRING","self",105],["T_DOUBLE_COLON","::",105],["T_STRING","PROTECTED_LFI",105],["T_WHITESPACE"," ",105],["T_DOUBLE_ARROW","=>",105],["T_WHITESPACE","\n                    ",105],["T_STRING","Mage",106],["T_DOUBLE_COLON","::",106],["T_STRING","helper",106],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",106],")",["T_OBJECT_OPERATOR","->",106],["T_STRING","__",106],"(",["T_CONSTANT_ENCAPSED_STRING","'Path \"%value%\" may not include parent directory traversal (\"..\/\", \"..\\\\\").'",106],")",",",["T_WHITESPACE","\n            ",106],")",";",["T_WHITESPACE","\n        ",107],"}",["T_WHITESPACE","\n        ",108],["T_RETURN","return",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],";",["T_WHITESPACE","\n    ",109],"}",["T_WHITESPACE","\n\n    ",110],["T_DOC_COMMENT","\/**\n     * Set paths masks\n     *\n     * @param array $paths  All paths masks types.\n     *                      E.g.: array('available' => array(...), 'protected' => array(...))\n     * @return Mage_Core_Model_File_Validator_AvailablePath\n     *\/",112],["T_WHITESPACE","\n    ",118],["T_PUBLIC","public",119],["T_WHITESPACE"," ",119],["T_FUNCTION","function",119],["T_WHITESPACE"," ",119],["T_STRING","setPaths",119],"(",["T_ARRAY","array",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$paths",119],")",["T_WHITESPACE","\n    ",119],"{",["T_WHITESPACE","\n        ",120],["T_IF","if",121],["T_WHITESPACE"," ",121],"(",["T_ISSET","isset",121],"(",["T_VARIABLE","$paths",121],"[",["T_CONSTANT_ENCAPSED_STRING","'available'",121],"]",")",["T_WHITESPACE"," ",121],["T_BOOLEAN_AND","&&",121],["T_WHITESPACE"," ",121],["T_STRING","is_array",121],"(",["T_VARIABLE","$paths",121],"[",["T_CONSTANT_ENCAPSED_STRING","'available'",121],"]",")",")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n            ",121],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","_availablePaths",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_VARIABLE","$paths",122],"[",["T_CONSTANT_ENCAPSED_STRING","'available'",122],"]",";",["T_WHITESPACE","\n        ",122],"}",["T_WHITESPACE","\n        ",123],["T_IF","if",124],["T_WHITESPACE"," ",124],"(",["T_ISSET","isset",124],"(",["T_VARIABLE","$paths",124],"[",["T_CONSTANT_ENCAPSED_STRING","'protected'",124],"]",")",["T_WHITESPACE"," ",124],["T_BOOLEAN_AND","&&",124],["T_WHITESPACE"," ",124],["T_STRING","is_array",124],"(",["T_VARIABLE","$paths",124],"[",["T_CONSTANT_ENCAPSED_STRING","'protected'",124],"]",")",")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n            ",124],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","_protectedPaths",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_VARIABLE","$paths",125],"[",["T_CONSTANT_ENCAPSED_STRING","'protected'",125],"]",";",["T_WHITESPACE","\n        ",125],"}",["T_WHITESPACE","\n        ",126],["T_RETURN","return",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$this",127],";",["T_WHITESPACE","\n    ",127],"}",["T_WHITESPACE","\n\n    ",128],["T_DOC_COMMENT","\/**\n     * Set protected paths masks\n     *\n     * @param array $paths\n     * @return Mage_Core_Model_File_Validator_AvailablePath\n     *\/",130],["T_WHITESPACE","\n    ",135],["T_PUBLIC","public",136],["T_WHITESPACE"," ",136],["T_FUNCTION","function",136],["T_WHITESPACE"," ",136],["T_STRING","setProtectedPaths",136],"(",["T_ARRAY","array",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$paths",136],")",["T_WHITESPACE","\n    ",136],"{",["T_WHITESPACE","\n        ",137],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","_protectedPaths",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_VARIABLE","$paths",138],";",["T_WHITESPACE","\n        ",138],["T_RETURN","return",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],";",["T_WHITESPACE","\n    ",139],"}",["T_WHITESPACE","\n\n    ",140],["T_DOC_COMMENT","\/**\n     * Add protected paths masks\n     *\n     * @param string|array $path\n     * @return Mage_Core_Model_File_Validator_AvailablePath\n     *\/",142],["T_WHITESPACE","\n    ",147],["T_PUBLIC","public",148],["T_WHITESPACE"," ",148],["T_FUNCTION","function",148],["T_WHITESPACE"," ",148],["T_STRING","addProtectedPath",148],"(",["T_VARIABLE","$path",148],")",["T_WHITESPACE","\n    ",148],"{",["T_WHITESPACE","\n        ",149],["T_IF","if",150],["T_WHITESPACE"," ",150],"(",["T_STRING","is_array",150],"(",["T_VARIABLE","$path",150],")",")",["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n            ",150],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","_protectedPaths",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_STRING","array_merge",151],"(",["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","_protectedPaths",151],",",["T_WHITESPACE"," ",151],["T_VARIABLE","$path",151],")",";",["T_WHITESPACE","\n        ",151],"}",["T_WHITESPACE"," ",152],["T_ELSE","else",152],["T_WHITESPACE"," ",152],"{",["T_WHITESPACE","\n            ",152],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","_protectedPaths",153],"[","]",["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_VARIABLE","$path",153],";",["T_WHITESPACE","\n        ",153],"}",["T_WHITESPACE","\n        ",154],["T_RETURN","return",155],["T_WHITESPACE"," ",155],["T_VARIABLE","$this",155],";",["T_WHITESPACE","\n    ",155],"}",["T_WHITESPACE","\n\n    ",156],["T_DOC_COMMENT","\/**\n     * Get protected paths masks\n     *\n     * @return array\n     *\/",158],["T_WHITESPACE","\n    ",162],["T_PUBLIC","public",163],["T_WHITESPACE"," ",163],["T_FUNCTION","function",163],["T_WHITESPACE"," ",163],["T_STRING","getProtectedPaths",163],"(",")",["T_WHITESPACE","\n    ",163],"{",["T_WHITESPACE","\n        ",164],["T_RETURN","return",165],["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","_protectedPaths",165],";",["T_WHITESPACE","\n    ",165],"}",["T_WHITESPACE","\n\n    ",166],["T_DOC_COMMENT","\/**\n     * Set available paths masks\n     *\n     * @param array $paths\n     * @return Mage_Core_Model_File_Validator_AvailablePath\n     *\/",168],["T_WHITESPACE","\n    ",173],["T_PUBLIC","public",174],["T_WHITESPACE"," ",174],["T_FUNCTION","function",174],["T_WHITESPACE"," ",174],["T_STRING","setAvailablePaths",174],"(",["T_ARRAY","array",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$paths",174],")",["T_WHITESPACE","\n    ",174],"{",["T_WHITESPACE","\n        ",175],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","_availablePaths",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_VARIABLE","$paths",176],";",["T_WHITESPACE","\n        ",176],["T_RETURN","return",177],["T_WHITESPACE"," ",177],["T_VARIABLE","$this",177],";",["T_WHITESPACE","\n    ",177],"}",["T_WHITESPACE","\n\n    ",178],["T_DOC_COMMENT","\/**\n     * Add available paths mask\n     *\n     * @param string|array $path\n     * @return Mage_Core_Model_File_Validator_AvailablePath\n     *\/",180],["T_WHITESPACE","\n    ",185],["T_PUBLIC","public",186],["T_WHITESPACE"," ",186],["T_FUNCTION","function",186],["T_WHITESPACE"," ",186],["T_STRING","addAvailablePath",186],"(",["T_VARIABLE","$path",186],")",["T_WHITESPACE","\n    ",186],"{",["T_WHITESPACE","\n        ",187],["T_IF","if",188],["T_WHITESPACE"," ",188],"(",["T_STRING","is_array",188],"(",["T_VARIABLE","$path",188],")",")",["T_WHITESPACE"," ",188],"{",["T_WHITESPACE","\n            ",188],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","_availablePaths",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_STRING","array_merge",189],"(",["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","_availablePaths",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$path",189],")",";",["T_WHITESPACE","\n        ",189],"}",["T_WHITESPACE"," ",190],["T_ELSE","else",190],["T_WHITESPACE"," ",190],"{",["T_WHITESPACE","\n            ",190],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","_availablePaths",191],"[","]",["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_VARIABLE","$path",191],";",["T_WHITESPACE","\n        ",191],"}",["T_WHITESPACE","\n        ",192],["T_RETURN","return",193],["T_WHITESPACE"," ",193],["T_VARIABLE","$this",193],";",["T_WHITESPACE","\n    ",193],"}",["T_WHITESPACE","\n\n    ",194],["T_DOC_COMMENT","\/**\n     * Get available paths masks\n     *\n     * @return array\n     *\/",196],["T_WHITESPACE","\n    ",200],["T_PUBLIC","public",201],["T_WHITESPACE"," ",201],["T_FUNCTION","function",201],["T_WHITESPACE"," ",201],["T_STRING","getAvailablePaths",201],"(",")",["T_WHITESPACE","\n    ",201],"{",["T_WHITESPACE","\n        ",202],["T_RETURN","return",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","_availablePaths",203],";",["T_WHITESPACE","\n    ",203],"}",["T_WHITESPACE","\n\n\n    ",204],["T_DOC_COMMENT","\/**\n     * Returns true if and only if $value meets the validation requirements\n     *\n     * If $value fails validation, then this method returns false, and\n     * getMessages() will return an array of messages that explain why the\n     * validation failed.\n     *\n     * @throws Exception        Throw exception on empty both paths masks types\n     * @param string $value     File\/dir path\n     * @return bool\n     *\/",207],["T_WHITESPACE","\n    ",217],["T_PUBLIC","public",218],["T_WHITESPACE"," ",218],["T_FUNCTION","function",218],["T_WHITESPACE"," ",218],["T_STRING","isValid",218],"(",["T_VARIABLE","$value",218],")",["T_WHITESPACE","\n    ",218],"{",["T_WHITESPACE","\n        ",219],["T_VARIABLE","$value",220],["T_WHITESPACE"," ",220],"=",["T_WHITESPACE"," ",220],["T_STRING","trim",220],"(",["T_VARIABLE","$value",220],")",";",["T_WHITESPACE","\n        ",220],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","_setValue",221],"(",["T_VARIABLE","$value",221],")",";",["T_WHITESPACE","\n\n        ",221],["T_IF","if",223],["T_WHITESPACE"," ",223],"(","!",["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","_availablePaths",223],["T_WHITESPACE"," ",223],["T_BOOLEAN_AND","&&",223],["T_WHITESPACE"," ",223],"!",["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","_protectedPaths",223],")",["T_WHITESPACE"," ",223],"{",["T_WHITESPACE","\n            ",223],["T_THROW","throw",224],["T_WHITESPACE"," ",224],["T_NEW","new",224],["T_WHITESPACE"," ",224],["T_STRING","Exception",224],"(",["T_STRING","Mage",224],["T_DOUBLE_COLON","::",224],["T_STRING","helper",224],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",224],")",["T_OBJECT_OPERATOR","->",224],["T_STRING","__",224],"(",["T_CONSTANT_ENCAPSED_STRING","'Please set available and\/or protected paths list(s) before validation.'",224],")",")",";",["T_WHITESPACE","\n        ",224],"}",["T_WHITESPACE","\n\n        ",225],["T_IF","if",227],["T_WHITESPACE"," ",227],"(",["T_STRING","preg_match",227],"(",["T_CONSTANT_ENCAPSED_STRING","'#\\.\\.[\\\\\\\/]#'",227],",",["T_WHITESPACE"," ",227],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","_value",227],")",")",["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n            ",227],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","_error",228],"(",["T_STRING","self",228],["T_DOUBLE_COLON","::",228],["T_STRING","PROTECTED_LFI",228],",",["T_WHITESPACE"," ",228],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","_value",228],")",";",["T_WHITESPACE","\n            ",228],["T_RETURN","return",229],["T_WHITESPACE"," ",229],["T_STRING","false",229],";",["T_WHITESPACE","\n        ",229],"}",["T_WHITESPACE","\n\n        ",230],["T_COMMENT","\/\/validation\n",232],["T_WHITESPACE","        ",233],["T_VARIABLE","$value",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_STRING","str_replace",233],"(",["T_ARRAY","array",233],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",233],",",["T_WHITESPACE"," ",233],["T_CONSTANT_ENCAPSED_STRING","'\\\\'",233],")",",",["T_WHITESPACE"," ",233],["T_STRING","DS",233],",",["T_WHITESPACE"," ",233],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","_value",233],")",";",["T_WHITESPACE","\n        ",233],["T_VARIABLE","$valuePathInfo",234],["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_STRING","pathinfo",234],"(",["T_STRING","ltrim",234],"(",["T_VARIABLE","$value",234],",",["T_WHITESPACE"," ",234],["T_CONSTANT_ENCAPSED_STRING","'\\\\\/'",234],")",")",";",["T_WHITESPACE","\n        ",234],["T_IF","if",235],["T_WHITESPACE"," ",235],"(",["T_VARIABLE","$valuePathInfo",235],"[",["T_CONSTANT_ENCAPSED_STRING","'dirname'",235],"]",["T_WHITESPACE"," ",235],["T_IS_EQUAL","==",235],["T_WHITESPACE"," ",235],["T_CONSTANT_ENCAPSED_STRING","'.'",235],["T_WHITESPACE"," ",235],["T_BOOLEAN_OR","||",235],["T_WHITESPACE"," ",235],["T_VARIABLE","$valuePathInfo",235],"[",["T_CONSTANT_ENCAPSED_STRING","'dirname'",235],"]",["T_WHITESPACE"," ",235],["T_IS_EQUAL","==",235],["T_WHITESPACE"," ",235],["T_STRING","DS",235],")",["T_WHITESPACE"," ",235],"{",["T_WHITESPACE","\n            ",235],["T_VARIABLE","$valuePathInfo",236],"[",["T_CONSTANT_ENCAPSED_STRING","'dirname'",236],"]",["T_WHITESPACE"," ",236],"=",["T_WHITESPACE"," ",236],["T_CONSTANT_ENCAPSED_STRING","''",236],";",["T_WHITESPACE","\n        ",236],"}",["T_WHITESPACE","\n\n        ",237],["T_IF","if",239],["T_WHITESPACE"," ",239],"(",["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","_protectedPaths",239],["T_WHITESPACE"," ",239],["T_BOOLEAN_AND","&&",239],["T_WHITESPACE"," ",239],"!",["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","_isValidByPaths",239],"(",["T_VARIABLE","$valuePathInfo",239],",",["T_WHITESPACE"," ",239],["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","_protectedPaths",239],",",["T_WHITESPACE"," ",239],["T_STRING","true",239],")",")",["T_WHITESPACE"," ",239],"{",["T_WHITESPACE","\n            ",239],["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","_error",240],"(",["T_STRING","self",240],["T_DOUBLE_COLON","::",240],["T_STRING","PROTECTED_PATH",240],",",["T_WHITESPACE"," ",240],["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","_value",240],")",";",["T_WHITESPACE","\n            ",240],["T_RETURN","return",241],["T_WHITESPACE"," ",241],["T_STRING","false",241],";",["T_WHITESPACE","\n        ",241],"}",["T_WHITESPACE","\n        ",242],["T_IF","if",243],["T_WHITESPACE"," ",243],"(",["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","_availablePaths",243],["T_WHITESPACE"," ",243],["T_BOOLEAN_AND","&&",243],["T_WHITESPACE"," ",243],"!",["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","_isValidByPaths",243],"(",["T_VARIABLE","$valuePathInfo",243],",",["T_WHITESPACE"," ",243],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","_availablePaths",243],",",["T_WHITESPACE"," ",243],["T_STRING","false",243],")",")",["T_WHITESPACE"," ",243],"{",["T_WHITESPACE","\n            ",243],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","_error",244],"(",["T_STRING","self",244],["T_DOUBLE_COLON","::",244],["T_STRING","NOT_AVAILABLE_PATH",244],",",["T_WHITESPACE"," ",244],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","_value",244],")",";",["T_WHITESPACE","\n            ",244],["T_RETURN","return",245],["T_WHITESPACE"," ",245],["T_STRING","false",245],";",["T_WHITESPACE","\n        ",245],"}",["T_WHITESPACE","\n\n        ",246],["T_RETURN","return",248],["T_WHITESPACE"," ",248],["T_STRING","true",248],";",["T_WHITESPACE","\n    ",248],"}",["T_WHITESPACE","\n\n    ",249],["T_DOC_COMMENT","\/**\n     * Validate value by path masks\n     *\n     * @param array $valuePathInfo  Path info from value path\n     * @param array $paths          Protected\/available paths masks\n     * @param bool $protected       Paths masks is protected?\n     * @return bool\n     *\/",251],["T_WHITESPACE","\n    ",258],["T_PROTECTED","protected",259],["T_WHITESPACE"," ",259],["T_FUNCTION","function",259],["T_WHITESPACE"," ",259],["T_STRING","_isValidByPaths",259],"(",["T_VARIABLE","$valuePathInfo",259],",",["T_WHITESPACE"," ",259],["T_VARIABLE","$paths",259],",",["T_WHITESPACE"," ",259],["T_VARIABLE","$protected",259],")",["T_WHITESPACE","\n    ",259],"{",["T_WHITESPACE","\n        ",260],["T_FOREACH","foreach",261],["T_WHITESPACE"," ",261],"(",["T_VARIABLE","$paths",261],["T_WHITESPACE"," ",261],["T_AS","as",261],["T_WHITESPACE"," ",261],["T_VARIABLE","$path",261],")",["T_WHITESPACE"," ",261],"{",["T_WHITESPACE","\n            ",261],["T_VARIABLE","$path",262],["T_WHITESPACE"," ",262],"=",["T_WHITESPACE"," ",262],["T_STRING","ltrim",262],"(",["T_VARIABLE","$path",262],",",["T_WHITESPACE"," ",262],["T_CONSTANT_ENCAPSED_STRING","'\\\\\/'",262],")",";",["T_WHITESPACE","\n            ",262],["T_IF","if",263],["T_WHITESPACE"," ",263],"(","!",["T_ISSET","isset",263],"(",["T_VARIABLE","$this",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","_pathsData",263],"[",["T_VARIABLE","$path",263],"]","[",["T_CONSTANT_ENCAPSED_STRING","'regFilename'",263],"]",")",")",["T_WHITESPACE"," ",263],"{",["T_WHITESPACE","\n                ",263],["T_VARIABLE","$pathInfo",264],["T_WHITESPACE"," ",264],"=",["T_WHITESPACE"," ",264],["T_STRING","pathinfo",264],"(",["T_VARIABLE","$path",264],")",";",["T_WHITESPACE","\n                ",264],["T_VARIABLE","$options",265],"[",["T_CONSTANT_ENCAPSED_STRING","'file_mask'",265],"]",["T_WHITESPACE"," ",265],"=",["T_WHITESPACE"," ",265],["T_VARIABLE","$pathInfo",265],"[",["T_CONSTANT_ENCAPSED_STRING","'basename'",265],"]",";",["T_WHITESPACE","\n                ",265],["T_IF","if",266],["T_WHITESPACE"," ",266],"(",["T_VARIABLE","$pathInfo",266],"[",["T_CONSTANT_ENCAPSED_STRING","'dirname'",266],"]",["T_WHITESPACE"," ",266],["T_IS_EQUAL","==",266],["T_WHITESPACE"," ",266],["T_CONSTANT_ENCAPSED_STRING","'.'",266],["T_WHITESPACE"," ",266],["T_BOOLEAN_OR","||",266],["T_WHITESPACE"," ",266],["T_VARIABLE","$pathInfo",266],"[",["T_CONSTANT_ENCAPSED_STRING","'dirname'",266],"]",["T_WHITESPACE"," ",266],["T_IS_EQUAL","==",266],["T_WHITESPACE"," ",266],["T_STRING","DS",266],")",["T_WHITESPACE"," ",266],"{",["T_WHITESPACE","\n                    ",266],["T_VARIABLE","$pathInfo",267],"[",["T_CONSTANT_ENCAPSED_STRING","'dirname'",267],"]",["T_WHITESPACE"," ",267],"=",["T_WHITESPACE"," ",267],["T_CONSTANT_ENCAPSED_STRING","''",267],";",["T_WHITESPACE","\n                ",267],"}",["T_WHITESPACE"," ",268],["T_ELSE","else",268],["T_WHITESPACE"," ",268],"{",["T_WHITESPACE","\n                    ",268],["T_VARIABLE","$pathInfo",269],"[",["T_CONSTANT_ENCAPSED_STRING","'dirname'",269],"]",["T_WHITESPACE"," ",269],"=",["T_WHITESPACE"," ",269],["T_STRING","str_replace",269],"(",["T_ARRAY","array",269],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",269],",",["T_WHITESPACE"," ",269],["T_CONSTANT_ENCAPSED_STRING","'\\\\'",269],")",",",["T_WHITESPACE"," ",269],["T_STRING","DS",269],",",["T_WHITESPACE"," ",269],["T_VARIABLE","$pathInfo",269],"[",["T_CONSTANT_ENCAPSED_STRING","'dirname'",269],"]",")",";",["T_WHITESPACE","\n                ",269],"}",["T_WHITESPACE","\n                ",270],["T_VARIABLE","$options",271],"[",["T_CONSTANT_ENCAPSED_STRING","'dir_mask'",271],"]",["T_WHITESPACE"," ",271],"=",["T_WHITESPACE"," ",271],["T_VARIABLE","$pathInfo",271],"[",["T_CONSTANT_ENCAPSED_STRING","'dirname'",271],"]",";",["T_WHITESPACE","\n                ",271],["T_VARIABLE","$this",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","_pathsData",272],"[",["T_VARIABLE","$path",272],"]","[",["T_CONSTANT_ENCAPSED_STRING","'options'",272],"]",["T_WHITESPACE"," ",272],"=",["T_WHITESPACE"," ",272],["T_VARIABLE","$options",272],";",["T_WHITESPACE","\n            ",272],"}",["T_WHITESPACE"," ",273],["T_ELSE","else",273],["T_WHITESPACE"," ",273],"{",["T_WHITESPACE","\n                ",273],["T_VARIABLE","$options",274],["T_WHITESPACE"," ",274],"=",["T_WHITESPACE"," ",274],["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","_pathsData",274],"[",["T_VARIABLE","$path",274],"]","[",["T_CONSTANT_ENCAPSED_STRING","'options'",274],"]",";",["T_WHITESPACE","\n            ",274],"}",["T_WHITESPACE","\n\n            ",275],["T_COMMENT","\/\/file mask\n",277],["T_WHITESPACE","            ",278],["T_IF","if",278],["T_WHITESPACE"," ",278],"(",["T_STRING","false",278],["T_WHITESPACE"," ",278],["T_IS_NOT_IDENTICAL","!==",278],["T_WHITESPACE"," ",278],"(",["T_STRING","strpos",278],"(",["T_VARIABLE","$options",278],"[",["T_CONSTANT_ENCAPSED_STRING","'file_mask'",278],"]",",",["T_WHITESPACE"," ",278],["T_CONSTANT_ENCAPSED_STRING","'*'",278],")",")",")",["T_WHITESPACE"," ",278],"{",["T_WHITESPACE","\n                ",278],["T_IF","if",279],["T_WHITESPACE"," ",279],"(","!",["T_ISSET","isset",279],"(",["T_VARIABLE","$this",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","_pathsData",279],"[",["T_VARIABLE","$path",279],"]","[",["T_CONSTANT_ENCAPSED_STRING","'regFilename'",279],"]",")",")",["T_WHITESPACE"," ",279],"{",["T_WHITESPACE","\n                    ",279],["T_COMMENT","\/\/make regular\n",280],["T_WHITESPACE","                    ",281],["T_VARIABLE","$reg",281],["T_WHITESPACE"," ",281],"=",["T_WHITESPACE"," ",281],["T_VARIABLE","$options",281],"[",["T_CONSTANT_ENCAPSED_STRING","'file_mask'",281],"]",";",["T_WHITESPACE","\n                    ",281],["T_VARIABLE","$reg",282],["T_WHITESPACE"," ",282],"=",["T_WHITESPACE"," ",282],["T_STRING","str_replace",282],"(",["T_CONSTANT_ENCAPSED_STRING","'.'",282],",",["T_WHITESPACE"," ",282],["T_CONSTANT_ENCAPSED_STRING","'\\.'",282],",",["T_WHITESPACE"," ",282],["T_VARIABLE","$reg",282],")",";",["T_WHITESPACE","\n                    ",282],["T_VARIABLE","$reg",283],["T_WHITESPACE"," ",283],"=",["T_WHITESPACE"," ",283],["T_STRING","str_replace",283],"(",["T_CONSTANT_ENCAPSED_STRING","'*'",283],",",["T_WHITESPACE"," ",283],["T_CONSTANT_ENCAPSED_STRING","'.*?'",283],",",["T_WHITESPACE"," ",283],["T_VARIABLE","$reg",283],")",";",["T_WHITESPACE","\n                    ",283],["T_VARIABLE","$reg",284],["T_WHITESPACE"," ",284],"=",["T_WHITESPACE"," ",284],"\"",["T_ENCAPSED_AND_WHITESPACE","\/^(",284],["T_VARIABLE","$reg",284],["T_ENCAPSED_AND_WHITESPACE",")$\/",284],"\"",";",["T_WHITESPACE","\n                ",284],"}",["T_WHITESPACE"," ",285],["T_ELSE","else",285],["T_WHITESPACE"," ",285],"{",["T_WHITESPACE","\n                    ",285],["T_VARIABLE","$reg",286],["T_WHITESPACE"," ",286],"=",["T_WHITESPACE"," ",286],["T_VARIABLE","$this",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","_pathsData",286],"[",["T_VARIABLE","$path",286],"]","[",["T_CONSTANT_ENCAPSED_STRING","'regFilename'",286],"]",";",["T_WHITESPACE","\n                ",286],"}",["T_WHITESPACE","\n                ",287],["T_VARIABLE","$resultFile",288],["T_WHITESPACE"," ",288],"=",["T_WHITESPACE"," ",288],["T_STRING","preg_match",288],"(",["T_VARIABLE","$reg",288],",",["T_WHITESPACE"," ",288],["T_VARIABLE","$valuePathInfo",288],"[",["T_CONSTANT_ENCAPSED_STRING","'basename'",288],"]",")",";",["T_WHITESPACE","\n            ",288],"}",["T_WHITESPACE"," ",289],["T_ELSE","else",289],["T_WHITESPACE"," ",289],"{",["T_WHITESPACE","\n                ",289],["T_VARIABLE","$resultFile",290],["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],"(",["T_VARIABLE","$options",290],"[",["T_CONSTANT_ENCAPSED_STRING","'file_mask'",290],"]",["T_WHITESPACE"," ",290],["T_IS_EQUAL","==",290],["T_WHITESPACE"," ",290],["T_VARIABLE","$valuePathInfo",290],"[",["T_CONSTANT_ENCAPSED_STRING","'basename'",290],"]",")",";",["T_WHITESPACE","\n            ",290],"}",["T_WHITESPACE","\n\n            ",291],["T_COMMENT","\/\/directory mask\n",293],["T_WHITESPACE","            ",294],["T_VARIABLE","$reg",294],["T_WHITESPACE"," ",294],"=",["T_WHITESPACE"," ",294],["T_VARIABLE","$options",294],"[",["T_CONSTANT_ENCAPSED_STRING","'dir_mask'",294],"]",["T_WHITESPACE"," ",294],".",["T_WHITESPACE"," ",294],["T_STRING","DS",294],";",["T_WHITESPACE","\n            ",294],["T_IF","if",295],["T_WHITESPACE"," ",295],"(","!",["T_ISSET","isset",295],"(",["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","_pathsData",295],"[",["T_VARIABLE","$path",295],"]","[",["T_CONSTANT_ENCAPSED_STRING","'regDir'",295],"]",")",")",["T_WHITESPACE"," ",295],"{",["T_WHITESPACE","\n                ",295],["T_COMMENT","\/\/make regular\n",296],["T_WHITESPACE","                ",297],["T_VARIABLE","$reg",297],["T_WHITESPACE"," ",297],"=",["T_WHITESPACE"," ",297],["T_STRING","str_replace",297],"(",["T_CONSTANT_ENCAPSED_STRING","'.'",297],",",["T_WHITESPACE"," ",297],["T_CONSTANT_ENCAPSED_STRING","'\\.'",297],",",["T_WHITESPACE"," ",297],["T_VARIABLE","$reg",297],")",";",["T_WHITESPACE","\n                ",297],["T_VARIABLE","$reg",298],["T_WHITESPACE"," ",298],"=",["T_WHITESPACE"," ",298],["T_STRING","str_replace",298],"(",["T_CONSTANT_ENCAPSED_STRING","'*\\\\'",298],",",["T_WHITESPACE"," ",298],["T_CONSTANT_ENCAPSED_STRING","'||'",298],",",["T_WHITESPACE"," ",298],["T_VARIABLE","$reg",298],")",";",["T_WHITESPACE","\n                ",298],["T_VARIABLE","$reg",299],["T_WHITESPACE"," ",299],"=",["T_WHITESPACE"," ",299],["T_STRING","str_replace",299],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/'",299],",",["T_WHITESPACE"," ",299],["T_CONSTANT_ENCAPSED_STRING","'||'",299],",",["T_WHITESPACE"," ",299],["T_VARIABLE","$reg",299],")",";",["T_WHITESPACE","\n                ",299],["T_COMMENT","\/\/$reg = str_replace('*', '||', $reg);\n",300],["T_WHITESPACE","                ",301],["T_VARIABLE","$reg",301],["T_WHITESPACE"," ",301],"=",["T_WHITESPACE"," ",301],["T_STRING","str_replace",301],"(",["T_STRING","DS",301],",",["T_WHITESPACE"," ",301],["T_CONSTANT_ENCAPSED_STRING","'[\\\\'",301],["T_WHITESPACE"," ",301],".",["T_WHITESPACE"," ",301],["T_STRING","DS",301],["T_WHITESPACE"," ",301],".",["T_WHITESPACE"," ",301],["T_CONSTANT_ENCAPSED_STRING","']'",301],",",["T_WHITESPACE"," ",301],["T_VARIABLE","$reg",301],")",";",["T_WHITESPACE","\n                ",301],["T_VARIABLE","$reg",302],["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],["T_STRING","str_replace",302],"(",["T_CONSTANT_ENCAPSED_STRING","'?'",302],",",["T_WHITESPACE"," ",302],["T_CONSTANT_ENCAPSED_STRING","'([^\\\\'",302],["T_WHITESPACE"," ",302],".",["T_WHITESPACE"," ",302],["T_STRING","DS",302],["T_WHITESPACE"," ",302],".",["T_WHITESPACE"," ",302],["T_CONSTANT_ENCAPSED_STRING","']+)'",302],",",["T_WHITESPACE"," ",302],["T_VARIABLE","$reg",302],")",";",["T_WHITESPACE","\n                ",302],["T_VARIABLE","$reg",303],["T_WHITESPACE"," ",303],"=",["T_WHITESPACE"," ",303],["T_STRING","str_replace",303],"(",["T_CONSTANT_ENCAPSED_STRING","'||'",303],",",["T_WHITESPACE"," ",303],["T_CONSTANT_ENCAPSED_STRING","'(.*[\\\\'",303],["T_WHITESPACE"," ",303],".",["T_WHITESPACE"," ",303],["T_STRING","DS",303],["T_WHITESPACE"," ",303],".",["T_WHITESPACE"," ",303],["T_CONSTANT_ENCAPSED_STRING","'])?'",303],",",["T_WHITESPACE"," ",303],["T_VARIABLE","$reg",303],")",";",["T_WHITESPACE","\n                ",303],["T_VARIABLE","$reg",304],["T_WHITESPACE"," ",304],"=",["T_WHITESPACE"," ",304],"\"",["T_ENCAPSED_AND_WHITESPACE","\/^",304],["T_VARIABLE","$reg",304],["T_ENCAPSED_AND_WHITESPACE","$\/",304],"\"",";",["T_WHITESPACE","\n            ",304],"}",["T_WHITESPACE"," ",305],["T_ELSE","else",305],["T_WHITESPACE"," ",305],"{",["T_WHITESPACE","\n                ",305],["T_VARIABLE","$reg",306],["T_WHITESPACE"," ",306],"=",["T_WHITESPACE"," ",306],["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","_pathsData",306],"[",["T_VARIABLE","$path",306],"]","[",["T_CONSTANT_ENCAPSED_STRING","'regDir'",306],"]",";",["T_WHITESPACE","\n            ",306],"}",["T_WHITESPACE","\n            ",307],["T_VARIABLE","$resultDir",308],["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],["T_STRING","preg_match",308],"(",["T_VARIABLE","$reg",308],",",["T_WHITESPACE"," ",308],["T_VARIABLE","$valuePathInfo",308],"[",["T_CONSTANT_ENCAPSED_STRING","'dirname'",308],"]",["T_WHITESPACE"," ",308],".",["T_WHITESPACE"," ",308],["T_STRING","DS",308],")",";",["T_WHITESPACE","\n\n            ",308],["T_IF","if",310],["T_WHITESPACE"," ",310],"(",["T_VARIABLE","$protected",310],["T_WHITESPACE"," ",310],["T_BOOLEAN_AND","&&",310],["T_WHITESPACE"," ",310],"(",["T_VARIABLE","$resultDir",310],["T_WHITESPACE"," ",310],["T_BOOLEAN_AND","&&",310],["T_WHITESPACE"," ",310],["T_VARIABLE","$resultFile",310],")",")",["T_WHITESPACE"," ",310],"{",["T_WHITESPACE","\n                ",310],["T_RETURN","return",311],["T_WHITESPACE"," ",311],["T_STRING","false",311],";",["T_WHITESPACE","\n            ",311],"}",["T_WHITESPACE"," ",312],["T_ELSEIF","elseif",312],["T_WHITESPACE"," ",312],"(","!",["T_VARIABLE","$protected",312],["T_WHITESPACE"," ",312],["T_BOOLEAN_AND","&&",312],["T_WHITESPACE"," ",312],"(",["T_VARIABLE","$resultDir",312],["T_WHITESPACE"," ",312],["T_BOOLEAN_AND","&&",312],["T_WHITESPACE"," ",312],["T_VARIABLE","$resultFile",312],")",")",["T_WHITESPACE"," ",312],"{",["T_WHITESPACE","\n                ",312],["T_COMMENT","\/\/return true because one match with available path mask\n",313],["T_WHITESPACE","                ",314],["T_RETURN","return",314],["T_WHITESPACE"," ",314],["T_STRING","true",314],";",["T_WHITESPACE","\n            ",314],"}",["T_WHITESPACE","\n        ",315],"}",["T_WHITESPACE","\n        ",316],["T_IF","if",317],["T_WHITESPACE"," ",317],"(",["T_VARIABLE","$protected",317],")",["T_WHITESPACE"," ",317],"{",["T_WHITESPACE","\n            ",317],["T_RETURN","return",318],["T_WHITESPACE"," ",318],["T_STRING","true",318],";",["T_WHITESPACE","\n        ",318],"}",["T_WHITESPACE"," ",319],["T_ELSE","else",319],["T_WHITESPACE"," ",319],"{",["T_WHITESPACE","\n            ",319],["T_COMMENT","\/\/return false because no one match with available path mask\n",320],["T_WHITESPACE","            ",321],["T_RETURN","return",321],["T_WHITESPACE"," ",321],["T_STRING","false",321],";",["T_WHITESPACE","\n        ",321],"}",["T_WHITESPACE","\n    ",322],"}",["T_WHITESPACE","\n",323],"}",["T_WHITESPACE","\n",324]]