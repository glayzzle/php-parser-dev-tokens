[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Core\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_CLASS","class",28],["T_WHITESPACE"," ",28],["T_STRING","Mage_Core_Model_Session_Abstract_Varien",28],["T_WHITESPACE"," ",28],["T_EXTENDS","extends",28],["T_WHITESPACE"," ",28],["T_STRING","Varien_Object",28],["T_WHITESPACE","\n",28],"{",["T_WHITESPACE","\n    ",29],["T_CONST","const",30],["T_WHITESPACE"," ",30],["T_STRING","VALIDATOR_KEY",30],["T_WHITESPACE","                         ",30],"=",["T_WHITESPACE"," ",30],["T_CONSTANT_ENCAPSED_STRING","'_session_validator_data'",30],";",["T_WHITESPACE","\n    ",30],["T_CONST","const",31],["T_WHITESPACE"," ",31],["T_STRING","VALIDATOR_HTTP_USER_AGENT_KEY",31],["T_WHITESPACE","         ",31],"=",["T_WHITESPACE"," ",31],["T_CONSTANT_ENCAPSED_STRING","'http_user_agent'",31],";",["T_WHITESPACE","\n    ",31],["T_CONST","const",32],["T_WHITESPACE"," ",32],["T_STRING","VALIDATOR_HTTP_X_FORVARDED_FOR_KEY",32],["T_WHITESPACE","    ",32],"=",["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","'http_x_forwarded_for'",32],";",["T_WHITESPACE","\n    ",32],["T_CONST","const",33],["T_WHITESPACE"," ",33],["T_STRING","VALIDATOR_HTTP_VIA_KEY",33],["T_WHITESPACE","                ",33],"=",["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'http_via'",33],";",["T_WHITESPACE","\n    ",33],["T_CONST","const",34],["T_WHITESPACE"," ",34],["T_STRING","VALIDATOR_REMOTE_ADDR_KEY",34],["T_WHITESPACE","             ",34],"=",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","'remote_addr'",34],";",["T_WHITESPACE","\n    ",34],["T_CONST","const",35],["T_WHITESPACE"," ",35],["T_STRING","VALIDATOR_SESSION_EXPIRE_TIMESTAMP",35],["T_WHITESPACE","    ",35],"=",["T_WHITESPACE"," ",35],["T_CONSTANT_ENCAPSED_STRING","'session_expire_timestamp'",35],";",["T_WHITESPACE","\n    ",35],["T_CONST","const",36],["T_WHITESPACE"," ",36],["T_STRING","SECURE_COOKIE_CHECK_KEY",36],["T_WHITESPACE","               ",36],"=",["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'_secure_cookie_check'",36],";",["T_WHITESPACE","\n\n    ",36],["T_DOC_COMMENT","\/**\n     * Map of session enabled hosts\n     * @example array('host.name' => true)\n     * @var array\n     *\/",38],["T_WHITESPACE","\n    ",42],["T_PROTECTED","protected",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$_sessionHosts",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_ARRAY","array",43],"(",")",";",["T_WHITESPACE","\n\n    ",43],["T_DOC_COMMENT","\/**\n     * Configure and start session\n     *\n     * @param string $sessionName\n     * @return Mage_Core_Model_Session_Abstract_Varien\n     *\/",45],["T_WHITESPACE","\n    ",50],["T_PUBLIC","public",51],["T_WHITESPACE"," ",51],["T_FUNCTION","function",51],["T_WHITESPACE"," ",51],["T_STRING","start",51],"(",["T_VARIABLE","$sessionName",51],"=",["T_STRING","null",51],")",["T_WHITESPACE","\n    ",51],"{",["T_WHITESPACE","\n        ",52],["T_IF","if",53],["T_WHITESPACE"," ",53],"(",["T_ISSET","isset",53],"(",["T_VARIABLE","$_SESSION",53],")",["T_WHITESPACE"," ",53],["T_BOOLEAN_AND","&&",53],["T_WHITESPACE"," ",53],"!",["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","getSkipEmptySessionCheck",53],"(",")",")",["T_WHITESPACE"," ",53],"{",["T_WHITESPACE","\n            ",53],["T_RETURN","return",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$this",54],";",["T_WHITESPACE","\n        ",54],"}",["T_WHITESPACE","\n\n        ",55],["T_COMMENT","\/\/ getSessionSaveMethod has to return correct version of handler in any case\n",57],["T_WHITESPACE","        ",58],["T_VARIABLE","$moduleName",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","getSessionSaveMethod",58],"(",")",";",["T_WHITESPACE","\n        ",58],["T_SWITCH","switch",59],["T_WHITESPACE"," ",59],"(",["T_VARIABLE","$moduleName",59],")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n            ",59],["T_DOC_COMMENT","\/**\n             * backward compatibility with db argument (option is @deprecated after 1.12.0.2)\n             *\/",60],["T_WHITESPACE","\n            ",62],["T_CASE","case",63],["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","'db'",63],":",["T_WHITESPACE","\n                ",63],["T_VARIABLE","$moduleName",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'user'",64],";",["T_WHITESPACE","\n                ",64],["T_COMMENT","\/* @var $sessionResource Mage_Core_Model_Resource_Session *\/",65],["T_WHITESPACE","\n                ",65],["T_VARIABLE","$sessionResource",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_STRING","Mage",66],["T_DOUBLE_COLON","::",66],["T_STRING","getResourceSingleton",66],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/session'",66],")",";",["T_WHITESPACE","\n                ",66],["T_VARIABLE","$sessionResource",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","setSaveHandler",67],"(",")",";",["T_WHITESPACE","\n                ",67],["T_BREAK","break",68],";",["T_WHITESPACE","\n            ",68],["T_CASE","case",69],["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'user'",69],":",["T_WHITESPACE","\n                ",69],["T_COMMENT","\/\/ getSessionSavePath represents static function for custom session handler setup\n",70],["T_WHITESPACE","                ",71],["T_STRING","call_user_func",71],"(",["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getSessionSavePath",71],"(",")",")",";",["T_WHITESPACE","\n                ",71],["T_BREAK","break",72],";",["T_WHITESPACE","\n            ",72],["T_CASE","case",73],["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'files'",73],":",["T_WHITESPACE","\n                ",73],["T_COMMENT","\/\/don't change path if it's not writable\n",74],["T_WHITESPACE","                ",75],["T_IF","if",75],["T_WHITESPACE"," ",75],"(","!",["T_STRING","is_writable",75],"(",["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getSessionSavePath",75],"(",")",")",")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n                    ",75],["T_BREAK","break",76],";",["T_WHITESPACE","\n                ",76],"}",["T_WHITESPACE","\n            ",77],["T_DEFAULT","default",78],":",["T_WHITESPACE","\n                ",78],["T_STRING","session_save_path",79],"(",["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","getSessionSavePath",79],"(",")",")",";",["T_WHITESPACE","\n                ",79],["T_BREAK","break",80],";",["T_WHITESPACE","\n        ",80],"}",["T_WHITESPACE","\n        ",81],["T_STRING","session_module_name",82],"(",["T_VARIABLE","$moduleName",82],")",";",["T_WHITESPACE","\n\n        ",82],["T_VARIABLE","$cookie",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getCookie",84],"(",")",";",["T_WHITESPACE","\n        ",84],["T_IF","if",85],["T_WHITESPACE"," ",85],"(",["T_STRING","Mage",85],["T_DOUBLE_COLON","::",85],["T_STRING","app",85],"(",")",["T_OBJECT_OPERATOR","->",85],["T_STRING","getStore",85],"(",")",["T_OBJECT_OPERATOR","->",85],["T_STRING","isAdmin",85],"(",")",")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n            ",85],["T_VARIABLE","$sessionMaxLifetime",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_STRING","Mage_Core_Model_Resource_Session",86],["T_DOUBLE_COLON","::",86],["T_STRING","SEESION_MAX_COOKIE_LIFETIME",86],";",["T_WHITESPACE","\n            ",86],["T_VARIABLE","$adminSessionLifetime",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_INT_CAST","(int)",87],["T_STRING","Mage",87],["T_DOUBLE_COLON","::",87],["T_STRING","getStoreConfig",87],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/security\/session_cookie_lifetime'",87],")",";",["T_WHITESPACE","\n            ",87],["T_IF","if",88],["T_WHITESPACE"," ",88],"(",["T_VARIABLE","$adminSessionLifetime",88],["T_WHITESPACE"," ",88],">",["T_WHITESPACE"," ",88],["T_VARIABLE","$sessionMaxLifetime",88],")",["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n                ",88],["T_VARIABLE","$adminSessionLifetime",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$sessionMaxLifetime",89],";",["T_WHITESPACE","\n            ",89],"}",["T_WHITESPACE","\n            ",90],["T_IF","if",91],["T_WHITESPACE"," ",91],"(",["T_VARIABLE","$adminSessionLifetime",91],["T_WHITESPACE"," ",91],">",["T_WHITESPACE"," ",91],["T_LNUMBER","60",91],")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n                ",91],["T_VARIABLE","$cookie",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","setLifetime",92],"(",["T_VARIABLE","$adminSessionLifetime",92],")",";",["T_WHITESPACE","\n            ",92],"}",["T_WHITESPACE","\n        ",93],"}",["T_WHITESPACE","\n\n        ",94],["T_COMMENT","\/\/ session cookie params\n",96],["T_WHITESPACE","        ",97],["T_VARIABLE","$cookieParams",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_ARRAY","array",97],"(",["T_WHITESPACE","\n            ",97],["T_CONSTANT_ENCAPSED_STRING","'lifetime'",98],["T_WHITESPACE"," ",98],["T_DOUBLE_ARROW","=>",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$cookie",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getLifetime",98],"(",")",",",["T_WHITESPACE","\n            ",98],["T_CONSTANT_ENCAPSED_STRING","'path'",99],["T_WHITESPACE","     ",99],["T_DOUBLE_ARROW","=>",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$cookie",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","getPath",99],"(",")",",",["T_WHITESPACE","\n            ",99],["T_CONSTANT_ENCAPSED_STRING","'domain'",100],["T_WHITESPACE","   ",100],["T_DOUBLE_ARROW","=>",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$cookie",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getConfigDomain",100],"(",")",",",["T_WHITESPACE","\n            ",100],["T_CONSTANT_ENCAPSED_STRING","'secure'",101],["T_WHITESPACE","   ",101],["T_DOUBLE_ARROW","=>",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$cookie",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","isSecure",101],"(",")",",",["T_WHITESPACE","\n            ",101],["T_CONSTANT_ENCAPSED_STRING","'httponly'",102],["T_WHITESPACE"," ",102],["T_DOUBLE_ARROW","=>",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$cookie",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getHttponly",102],"(",")",["T_WHITESPACE","\n        ",102],")",";",["T_WHITESPACE","\n\n        ",103],["T_IF","if",105],["T_WHITESPACE"," ",105],"(","!",["T_VARIABLE","$cookieParams",105],"[",["T_CONSTANT_ENCAPSED_STRING","'httponly'",105],"]",")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n            ",105],["T_UNSET","unset",106],"(",["T_VARIABLE","$cookieParams",106],"[",["T_CONSTANT_ENCAPSED_STRING","'httponly'",106],"]",")",";",["T_WHITESPACE","\n            ",106],["T_IF","if",107],["T_WHITESPACE"," ",107],"(","!",["T_VARIABLE","$cookieParams",107],"[",["T_CONSTANT_ENCAPSED_STRING","'secure'",107],"]",")",["T_WHITESPACE"," ",107],"{",["T_WHITESPACE","\n                ",107],["T_UNSET","unset",108],"(",["T_VARIABLE","$cookieParams",108],"[",["T_CONSTANT_ENCAPSED_STRING","'secure'",108],"]",")",";",["T_WHITESPACE","\n                ",108],["T_IF","if",109],["T_WHITESPACE"," ",109],"(","!",["T_VARIABLE","$cookieParams",109],"[",["T_CONSTANT_ENCAPSED_STRING","'domain'",109],"]",")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n                    ",109],["T_UNSET","unset",110],"(",["T_VARIABLE","$cookieParams",110],"[",["T_CONSTANT_ENCAPSED_STRING","'domain'",110],"]",")",";",["T_WHITESPACE","\n                ",110],"}",["T_WHITESPACE","\n            ",111],"}",["T_WHITESPACE","\n        ",112],"}",["T_WHITESPACE","\n\n        ",113],["T_IF","if",115],["T_WHITESPACE"," ",115],"(",["T_ISSET","isset",115],"(",["T_VARIABLE","$cookieParams",115],"[",["T_CONSTANT_ENCAPSED_STRING","'domain'",115],"]",")",")",["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n            ",115],["T_VARIABLE","$cookieParams",116],"[",["T_CONSTANT_ENCAPSED_STRING","'domain'",116],"]",["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_VARIABLE","$cookie",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getDomain",116],"(",")",";",["T_WHITESPACE","\n        ",116],"}",["T_WHITESPACE","\n\n        ",117],["T_STRING","call_user_func_array",119],"(",["T_CONSTANT_ENCAPSED_STRING","'session_set_cookie_params'",119],",",["T_WHITESPACE"," ",119],["T_VARIABLE","$cookieParams",119],")",";",["T_WHITESPACE","\n\n        ",119],["T_IF","if",121],["T_WHITESPACE"," ",121],"(","!",["T_EMPTY","empty",121],"(",["T_VARIABLE","$sessionName",121],")",")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n            ",121],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","setSessionName",122],"(",["T_VARIABLE","$sessionName",122],")",";",["T_WHITESPACE","\n        ",122],"}",["T_WHITESPACE","\n\n        ",123],["T_COMMENT","\/\/ potential custom logic for session id (ex. switching between hosts)\n",125],["T_WHITESPACE","        ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","setSessionId",126],"(",")",";",["T_WHITESPACE","\n\n        ",126],["T_STRING","Varien_Profiler",128],["T_DOUBLE_COLON","::",128],["T_STRING","start",128],"(",["T_METHOD_C","__METHOD__",128],".",["T_CONSTANT_ENCAPSED_STRING","'\/start'",128],")",";",["T_WHITESPACE","\n        ",128],["T_VARIABLE","$sessionCacheLimiter",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_STRING","Mage",129],["T_DOUBLE_COLON","::",129],["T_STRING","getConfig",129],"(",")",["T_OBJECT_OPERATOR","->",129],["T_STRING","getNode",129],"(",["T_CONSTANT_ENCAPSED_STRING","'global\/session_cache_limiter'",129],")",";",["T_WHITESPACE","\n        ",129],["T_IF","if",130],["T_WHITESPACE"," ",130],"(",["T_VARIABLE","$sessionCacheLimiter",130],")",["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n            ",130],["T_STRING","session_cache_limiter",131],"(",["T_STRING_CAST","(string)",131],["T_VARIABLE","$sessionCacheLimiter",131],")",";",["T_WHITESPACE","\n        ",131],"}",["T_WHITESPACE","\n\n        ",132],["T_STRING","session_start",134],"(",")",";",["T_WHITESPACE","\n\n        ",134],["T_IF","if",136],["T_WHITESPACE"," ",136],"(",["T_STRING","Mage",136],["T_DOUBLE_COLON","::",136],["T_STRING","app",136],"(",")",["T_OBJECT_OPERATOR","->",136],["T_STRING","getFrontController",136],"(",")",["T_OBJECT_OPERATOR","->",136],["T_STRING","getRequest",136],"(",")",["T_OBJECT_OPERATOR","->",136],["T_STRING","isSecure",136],"(",")",["T_WHITESPACE"," ",136],["T_BOOLEAN_AND","&&",136],["T_WHITESPACE"," ",136],["T_EMPTY","empty",136],"(",["T_VARIABLE","$cookieParams",136],"[",["T_CONSTANT_ENCAPSED_STRING","'secure'",136],"]",")",")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n            ",136],["T_COMMENT","\/\/ secure cookie check to prevent MITM attack\n",137],["T_WHITESPACE","            ",138],["T_VARIABLE","$secureCookieName",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_VARIABLE","$sessionName",138],["T_WHITESPACE"," ",138],".",["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","'_cid'",138],";",["T_WHITESPACE","\n            ",138],["T_IF","if",139],["T_WHITESPACE"," ",139],"(",["T_ISSET","isset",139],"(",["T_VARIABLE","$_SESSION",139],"[",["T_STRING","self",139],["T_DOUBLE_COLON","::",139],["T_STRING","SECURE_COOKIE_CHECK_KEY",139],"]",")",["T_WHITESPACE","\n                ",139],["T_BOOLEAN_AND","&&",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$_SESSION",140],"[",["T_STRING","self",140],["T_DOUBLE_COLON","::",140],["T_STRING","SECURE_COOKIE_CHECK_KEY",140],"]",["T_WHITESPACE"," ",140],["T_IS_NOT_IDENTICAL","!==",140],["T_WHITESPACE"," ",140],["T_STRING","md5",140],"(",["T_VARIABLE","$cookie",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","get",140],"(",["T_VARIABLE","$secureCookieName",140],")",")",["T_WHITESPACE","\n            ",140],")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n                ",141],["T_STRING","session_regenerate_id",142],"(",["T_STRING","false",142],")",";",["T_WHITESPACE","\n                ",142],["T_VARIABLE","$sessionHosts",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getSessionHosts",143],"(",")",";",["T_WHITESPACE","\n                ",143],["T_VARIABLE","$currentCookieDomain",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_VARIABLE","$cookie",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","getDomain",144],"(",")",";",["T_WHITESPACE","\n                ",144],["T_FOREACH","foreach",145],["T_WHITESPACE"," ",145],"(",["T_STRING","array_keys",145],"(",["T_VARIABLE","$sessionHosts",145],")",["T_WHITESPACE"," ",145],["T_AS","as",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$host",145],")",["T_WHITESPACE"," ",145],"{",["T_WHITESPACE","\n                    ",145],["T_COMMENT","\/\/ Delete cookies with the same name for parent domains\n",146],["T_WHITESPACE","                    ",147],["T_IF","if",147],["T_WHITESPACE"," ",147],"(",["T_STRING","strpos",147],"(",["T_VARIABLE","$currentCookieDomain",147],",",["T_WHITESPACE"," ",147],["T_VARIABLE","$host",147],")",["T_WHITESPACE"," ",147],">",["T_WHITESPACE"," ",147],["T_LNUMBER","0",147],")",["T_WHITESPACE"," ",147],"{",["T_WHITESPACE","\n                        ",147],["T_VARIABLE","$cookie",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","delete",148],"(",["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","getSessionName",148],"(",")",",",["T_WHITESPACE"," ",148],["T_STRING","null",148],",",["T_WHITESPACE"," ",148],["T_VARIABLE","$host",148],")",";",["T_WHITESPACE","\n                    ",148],"}",["T_WHITESPACE","\n                ",149],"}",["T_WHITESPACE","\n                ",150],["T_VARIABLE","$_SESSION",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_ARRAY","array",151],"(",")",";",["T_WHITESPACE","\n            ",151],"}",["T_WHITESPACE","\n            ",152],["T_IF","if",153],["T_WHITESPACE"," ",153],"(","!",["T_ISSET","isset",153],"(",["T_VARIABLE","$_SESSION",153],"[",["T_STRING","self",153],["T_DOUBLE_COLON","::",153],["T_STRING","SECURE_COOKIE_CHECK_KEY",153],"]",")",")",["T_WHITESPACE"," ",153],"{",["T_WHITESPACE","\n                ",153],["T_VARIABLE","$checkId",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_STRING","Mage",154],["T_DOUBLE_COLON","::",154],["T_STRING","helper",154],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",154],")",["T_OBJECT_OPERATOR","->",154],["T_STRING","getRandomString",154],"(",["T_LNUMBER","16",154],")",";",["T_WHITESPACE","\n                ",154],["T_VARIABLE","$cookie",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","set",155],"(",["T_VARIABLE","$secureCookieName",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$checkId",155],",",["T_WHITESPACE"," ",155],["T_STRING","null",155],",",["T_WHITESPACE"," ",155],["T_STRING","null",155],",",["T_WHITESPACE"," ",155],["T_STRING","null",155],",",["T_WHITESPACE"," ",155],["T_STRING","true",155],")",";",["T_WHITESPACE","\n                ",155],["T_VARIABLE","$_SESSION",156],"[",["T_STRING","self",156],["T_DOUBLE_COLON","::",156],["T_STRING","SECURE_COOKIE_CHECK_KEY",156],"]",["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_STRING","md5",156],"(",["T_VARIABLE","$checkId",156],")",";",["T_WHITESPACE","\n            ",156],"}",["T_WHITESPACE","\n        ",157],"}",["T_WHITESPACE","\n\n        ",158],["T_DOC_COMMENT","\/**\n        * Renew cookie expiration time if session id did not change\n        *\/",160],["T_WHITESPACE","\n        ",162],["T_IF","if",163],["T_WHITESPACE"," ",163],"(",["T_VARIABLE","$cookie",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","get",163],"(",["T_STRING","session_name",163],"(",")",")",["T_WHITESPACE"," ",163],["T_IS_EQUAL","==",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","getSessionId",163],"(",")",")",["T_WHITESPACE"," ",163],"{",["T_WHITESPACE","\n            ",163],["T_VARIABLE","$cookie",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","renew",164],"(",["T_STRING","session_name",164],"(",")",")",";",["T_WHITESPACE","\n        ",164],"}",["T_WHITESPACE","\n        ",165],["T_STRING","Varien_Profiler",166],["T_DOUBLE_COLON","::",166],["T_STRING","stop",166],"(",["T_METHOD_C","__METHOD__",166],".",["T_CONSTANT_ENCAPSED_STRING","'\/start'",166],")",";",["T_WHITESPACE","\n\n        ",166],["T_RETURN","return",168],["T_WHITESPACE"," ",168],["T_VARIABLE","$this",168],";",["T_WHITESPACE","\n    ",168],"}",["T_WHITESPACE","\n\n    ",169],["T_DOC_COMMENT","\/**\n     * Get session hosts\n     *\n     * @return array\n     *\/",171],["T_WHITESPACE","\n    ",175],["T_PUBLIC","public",176],["T_WHITESPACE"," ",176],["T_FUNCTION","function",176],["T_WHITESPACE"," ",176],["T_STRING","getSessionHosts",176],"(",")",["T_WHITESPACE","\n    ",176],"{",["T_WHITESPACE","\n        ",177],["T_RETURN","return",178],["T_WHITESPACE"," ",178],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","_sessionHosts",178],";",["T_WHITESPACE","\n    ",178],"}",["T_WHITESPACE","\n\n    ",179],["T_DOC_COMMENT","\/**\n     * Set session hosts\n     *\n     * @param array $hosts\n     * @return Mage_Core_Model_Session_Abstract_Varien\n     *\/",181],["T_WHITESPACE","\n    ",186],["T_PUBLIC","public",187],["T_WHITESPACE"," ",187],["T_FUNCTION","function",187],["T_WHITESPACE"," ",187],["T_STRING","setSessionHosts",187],"(",["T_ARRAY","array",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$hosts",187],")",["T_WHITESPACE","\n    ",187],"{",["T_WHITESPACE","\n        ",188],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","_sessionHosts",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_VARIABLE","$hosts",189],";",["T_WHITESPACE","\n        ",189],["T_RETURN","return",190],["T_WHITESPACE"," ",190],["T_VARIABLE","$this",190],";",["T_WHITESPACE","\n    ",190],"}",["T_WHITESPACE","\n\n    ",191],["T_DOC_COMMENT","\/**\n     * Retrieve cookie object\n     *\n     * @return Mage_Core_Model_Cookie\n     *\/",193],["T_WHITESPACE","\n    ",197],["T_PUBLIC","public",198],["T_WHITESPACE"," ",198],["T_FUNCTION","function",198],["T_WHITESPACE"," ",198],["T_STRING","getCookie",198],"(",")",["T_WHITESPACE","\n    ",198],"{",["T_WHITESPACE","\n        ",199],["T_RETURN","return",200],["T_WHITESPACE"," ",200],["T_STRING","Mage",200],["T_DOUBLE_COLON","::",200],["T_STRING","getSingleton",200],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/cookie'",200],")",";",["T_WHITESPACE","\n    ",200],"}",["T_WHITESPACE","\n\n    ",201],["T_DOC_COMMENT","\/**\n     * Revalidate cookie\n     * @deprecated after 1.4 cookie renew moved to session start method\n     * @return Mage_Core_Model_Session_Abstract_Varien\n     *\/",203],["T_WHITESPACE","\n    ",207],["T_PUBLIC","public",208],["T_WHITESPACE"," ",208],["T_FUNCTION","function",208],["T_WHITESPACE"," ",208],["T_STRING","revalidateCookie",208],"(",")",["T_WHITESPACE","\n    ",208],"{",["T_WHITESPACE","\n        ",209],["T_RETURN","return",210],["T_WHITESPACE"," ",210],["T_VARIABLE","$this",210],";",["T_WHITESPACE","\n    ",210],"}",["T_WHITESPACE","\n\n    ",211],["T_DOC_COMMENT","\/**\n     * Init session with namespace\n     *\n     * @param string $namespace\n     * @param string $sessionName\n     * @return Mage_Core_Model_Session_Abstract_Varien\n     *\/",213],["T_WHITESPACE","\n    ",219],["T_PUBLIC","public",220],["T_WHITESPACE"," ",220],["T_FUNCTION","function",220],["T_WHITESPACE"," ",220],["T_STRING","init",220],"(",["T_VARIABLE","$namespace",220],",",["T_WHITESPACE"," ",220],["T_VARIABLE","$sessionName",220],"=",["T_STRING","null",220],")",["T_WHITESPACE","\n    ",220],"{",["T_WHITESPACE","\n        ",221],["T_IF","if",222],["T_WHITESPACE"," ",222],"(","!",["T_ISSET","isset",222],"(",["T_VARIABLE","$_SESSION",222],")",")",["T_WHITESPACE"," ",222],"{",["T_WHITESPACE","\n            ",222],["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","start",223],"(",["T_VARIABLE","$sessionName",223],")",";",["T_WHITESPACE","\n        ",223],"}",["T_WHITESPACE","\n        ",224],["T_IF","if",225],["T_WHITESPACE"," ",225],"(","!",["T_ISSET","isset",225],"(",["T_VARIABLE","$_SESSION",225],"[",["T_VARIABLE","$namespace",225],"]",")",")",["T_WHITESPACE"," ",225],"{",["T_WHITESPACE","\n            ",225],["T_VARIABLE","$_SESSION",226],"[",["T_VARIABLE","$namespace",226],"]",["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_ARRAY","array",226],"(",")",";",["T_WHITESPACE","\n        ",226],"}",["T_WHITESPACE","\n\n        ",227],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","_data",229],["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],"&",["T_VARIABLE","$_SESSION",229],"[",["T_VARIABLE","$namespace",229],"]",";",["T_WHITESPACE","\n\n        ",229],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","validate",231],"(",")",";",["T_WHITESPACE","\n        ",231],["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","revalidateCookie",232],"(",")",";",["T_WHITESPACE","\n\n        ",232],["T_RETURN","return",234],["T_WHITESPACE"," ",234],["T_VARIABLE","$this",234],";",["T_WHITESPACE","\n    ",234],"}",["T_WHITESPACE","\n\n    ",235],["T_DOC_COMMENT","\/**\n     * Additional get data with clear mode\n     *\n     * @param string $key\n     * @param bool $clear\n     * @return mixed\n     *\/",237],["T_WHITESPACE","\n    ",243],["T_PUBLIC","public",244],["T_WHITESPACE"," ",244],["T_FUNCTION","function",244],["T_WHITESPACE"," ",244],["T_STRING","getData",244],"(",["T_VARIABLE","$key",244],"=",["T_CONSTANT_ENCAPSED_STRING","''",244],",",["T_WHITESPACE"," ",244],["T_VARIABLE","$clear",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_STRING","false",244],")",["T_WHITESPACE","\n    ",244],"{",["T_WHITESPACE","\n        ",245],["T_VARIABLE","$data",246],["T_WHITESPACE"," ",246],"=",["T_WHITESPACE"," ",246],["T_STRING","parent",246],["T_DOUBLE_COLON","::",246],["T_STRING","getData",246],"(",["T_VARIABLE","$key",246],")",";",["T_WHITESPACE","\n        ",246],["T_IF","if",247],["T_WHITESPACE"," ",247],"(",["T_VARIABLE","$clear",247],["T_WHITESPACE"," ",247],["T_BOOLEAN_AND","&&",247],["T_WHITESPACE"," ",247],["T_ISSET","isset",247],"(",["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","_data",247],"[",["T_VARIABLE","$key",247],"]",")",")",["T_WHITESPACE"," ",247],"{",["T_WHITESPACE","\n            ",247],["T_UNSET","unset",248],"(",["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","_data",248],"[",["T_VARIABLE","$key",248],"]",")",";",["T_WHITESPACE","\n        ",248],"}",["T_WHITESPACE","\n        ",249],["T_RETURN","return",250],["T_WHITESPACE"," ",250],["T_VARIABLE","$data",250],";",["T_WHITESPACE","\n    ",250],"}",["T_WHITESPACE","\n\n    ",251],["T_DOC_COMMENT","\/**\n     * Retrieve session Id\n     *\n     * @return string\n     *\/",253],["T_WHITESPACE","\n    ",257],["T_PUBLIC","public",258],["T_WHITESPACE"," ",258],["T_FUNCTION","function",258],["T_WHITESPACE"," ",258],["T_STRING","getSessionId",258],"(",")",["T_WHITESPACE","\n    ",258],"{",["T_WHITESPACE","\n        ",259],["T_RETURN","return",260],["T_WHITESPACE"," ",260],["T_STRING","session_id",260],"(",")",";",["T_WHITESPACE","\n    ",260],"}",["T_WHITESPACE","\n\n    ",261],["T_DOC_COMMENT","\/**\n     * Set custom session id\n     *\n     * @param string $id\n     * @return Mage_Core_Model_Session_Abstract_Varien\n     *\/",263],["T_WHITESPACE","\n    ",268],["T_PUBLIC","public",269],["T_WHITESPACE"," ",269],["T_FUNCTION","function",269],["T_WHITESPACE"," ",269],["T_STRING","setSessionId",269],"(",["T_VARIABLE","$id",269],"=",["T_STRING","null",269],")",["T_WHITESPACE","\n    ",269],"{",["T_WHITESPACE","\n        ",270],["T_IF","if",271],["T_WHITESPACE"," ",271],"(","!",["T_STRING","is_null",271],"(",["T_VARIABLE","$id",271],")",["T_WHITESPACE"," ",271],["T_BOOLEAN_AND","&&",271],["T_WHITESPACE"," ",271],["T_STRING","preg_match",271],"(",["T_CONSTANT_ENCAPSED_STRING","'#^[0-9a-zA-Z,-]+$#'",271],",",["T_WHITESPACE"," ",271],["T_VARIABLE","$id",271],")",")",["T_WHITESPACE"," ",271],"{",["T_WHITESPACE","\n            ",271],["T_STRING","session_id",272],"(",["T_VARIABLE","$id",272],")",";",["T_WHITESPACE","\n        ",272],"}",["T_WHITESPACE","\n        ",273],["T_RETURN","return",274],["T_WHITESPACE"," ",274],["T_VARIABLE","$this",274],";",["T_WHITESPACE","\n    ",274],"}",["T_WHITESPACE","\n\n    ",275],["T_DOC_COMMENT","\/**\n     * Retrieve session name\n     *\n     * @return string\n     *\/",277],["T_WHITESPACE","\n    ",281],["T_PUBLIC","public",282],["T_WHITESPACE"," ",282],["T_FUNCTION","function",282],["T_WHITESPACE"," ",282],["T_STRING","getSessionName",282],"(",")",["T_WHITESPACE","\n    ",282],"{",["T_WHITESPACE","\n        ",283],["T_RETURN","return",284],["T_WHITESPACE"," ",284],["T_STRING","session_name",284],"(",")",";",["T_WHITESPACE","\n    ",284],"}",["T_WHITESPACE","\n\n    ",285],["T_DOC_COMMENT","\/**\n     * Set session name\n     *\n     * @param string $name\n     * @return Mage_Core_Model_Session_Abstract_Varien\n     *\/",287],["T_WHITESPACE","\n    ",292],["T_PUBLIC","public",293],["T_WHITESPACE"," ",293],["T_FUNCTION","function",293],["T_WHITESPACE"," ",293],["T_STRING","setSessionName",293],"(",["T_VARIABLE","$name",293],")",["T_WHITESPACE","\n    ",293],"{",["T_WHITESPACE","\n        ",294],["T_STRING","session_name",295],"(",["T_VARIABLE","$name",295],")",";",["T_WHITESPACE","\n        ",295],["T_RETURN","return",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$this",296],";",["T_WHITESPACE","\n    ",296],"}",["T_WHITESPACE","\n\n    ",297],["T_DOC_COMMENT","\/**\n     * Unset all data\n     *\n     * @return Mage_Core_Model_Session_Abstract_Varien\n     *\/",299],["T_WHITESPACE","\n    ",303],["T_PUBLIC","public",304],["T_WHITESPACE"," ",304],["T_FUNCTION","function",304],["T_WHITESPACE"," ",304],["T_STRING","unsetAll",304],"(",")",["T_WHITESPACE","\n    ",304],"{",["T_WHITESPACE","\n        ",305],["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","unsetData",306],"(",")",";",["T_WHITESPACE","\n        ",306],["T_RETURN","return",307],["T_WHITESPACE"," ",307],["T_VARIABLE","$this",307],";",["T_WHITESPACE","\n    ",307],"}",["T_WHITESPACE","\n\n    ",308],["T_DOC_COMMENT","\/**\n     * Alias for unsetAll\n     *\n     * @return Mage_Core_Model_Session_Abstract_Varien\n     *\/",310],["T_WHITESPACE","\n    ",314],["T_PUBLIC","public",315],["T_WHITESPACE"," ",315],["T_FUNCTION","function",315],["T_WHITESPACE"," ",315],["T_STRING","clear",315],"(",")",["T_WHITESPACE","\n    ",315],"{",["T_WHITESPACE","\n        ",316],["T_RETURN","return",317],["T_WHITESPACE"," ",317],["T_VARIABLE","$this",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","unsetAll",317],"(",")",";",["T_WHITESPACE","\n    ",317],"}",["T_WHITESPACE","\n\n    ",318],["T_DOC_COMMENT","\/**\n     * Retrieve session save method\n     * Default files\n     *\n     * @return string\n     *\/",320],["T_WHITESPACE","\n    ",325],["T_PUBLIC","public",326],["T_WHITESPACE"," ",326],["T_FUNCTION","function",326],["T_WHITESPACE"," ",326],["T_STRING","getSessionSaveMethod",326],"(",")",["T_WHITESPACE","\n    ",326],"{",["T_WHITESPACE","\n        ",327],["T_RETURN","return",328],["T_WHITESPACE"," ",328],["T_CONSTANT_ENCAPSED_STRING","'files'",328],";",["T_WHITESPACE","\n    ",328],"}",["T_WHITESPACE","\n\n    ",329],["T_DOC_COMMENT","\/**\n     * Get sesssion save path\n     *\n     * @return string\n     *\/",331],["T_WHITESPACE","\n    ",335],["T_PUBLIC","public",336],["T_WHITESPACE"," ",336],["T_FUNCTION","function",336],["T_WHITESPACE"," ",336],["T_STRING","getSessionSavePath",336],"(",")",["T_WHITESPACE","\n    ",336],"{",["T_WHITESPACE","\n        ",337],["T_RETURN","return",338],["T_WHITESPACE"," ",338],["T_STRING","Mage",338],["T_DOUBLE_COLON","::",338],["T_STRING","getBaseDir",338],"(",["T_CONSTANT_ENCAPSED_STRING","'session'",338],")",";",["T_WHITESPACE","\n    ",338],"}",["T_WHITESPACE","\n\n    ",339],["T_DOC_COMMENT","\/**\n     * Use REMOTE_ADDR in validator key\n     *\n     * @return bool\n     *\/",341],["T_WHITESPACE","\n    ",345],["T_PUBLIC","public",346],["T_WHITESPACE"," ",346],["T_FUNCTION","function",346],["T_WHITESPACE"," ",346],["T_STRING","useValidateRemoteAddr",346],"(",")",["T_WHITESPACE","\n    ",346],"{",["T_WHITESPACE","\n        ",347],["T_RETURN","return",348],["T_WHITESPACE"," ",348],["T_STRING","true",348],";",["T_WHITESPACE","\n    ",348],"}",["T_WHITESPACE","\n\n    ",349],["T_DOC_COMMENT","\/**\n     * Use HTTP_VIA in validator key\n     *\n     * @return bool\n     *\/",351],["T_WHITESPACE","\n    ",355],["T_PUBLIC","public",356],["T_WHITESPACE"," ",356],["T_FUNCTION","function",356],["T_WHITESPACE"," ",356],["T_STRING","useValidateHttpVia",356],"(",")",["T_WHITESPACE","\n    ",356],"{",["T_WHITESPACE","\n        ",357],["T_RETURN","return",358],["T_WHITESPACE"," ",358],["T_STRING","true",358],";",["T_WHITESPACE","\n    ",358],"}",["T_WHITESPACE","\n\n    ",359],["T_DOC_COMMENT","\/**\n     * Use HTTP_X_FORWARDED_FOR in validator key\n     *\n     * @return bool\n     *\/",361],["T_WHITESPACE","\n    ",365],["T_PUBLIC","public",366],["T_WHITESPACE"," ",366],["T_FUNCTION","function",366],["T_WHITESPACE"," ",366],["T_STRING","useValidateHttpXForwardedFor",366],"(",")",["T_WHITESPACE","\n    ",366],"{",["T_WHITESPACE","\n        ",367],["T_RETURN","return",368],["T_WHITESPACE"," ",368],["T_STRING","true",368],";",["T_WHITESPACE","\n    ",368],"}",["T_WHITESPACE","\n\n    ",369],["T_DOC_COMMENT","\/**\n     * Use HTTP_USER_AGENT in validator key\n     *\n     * @return bool\n     *\/",371],["T_WHITESPACE","\n    ",375],["T_PUBLIC","public",376],["T_WHITESPACE"," ",376],["T_FUNCTION","function",376],["T_WHITESPACE"," ",376],["T_STRING","useValidateHttpUserAgent",376],"(",")",["T_WHITESPACE","\n    ",376],"{",["T_WHITESPACE","\n        ",377],["T_RETURN","return",378],["T_WHITESPACE"," ",378],["T_STRING","true",378],";",["T_WHITESPACE","\n    ",378],"}",["T_WHITESPACE","\n\n    ",379],["T_DOC_COMMENT","\/**\n     * Use session expire timestamp in validator key\n     *\n     * @return bool\n     *\/",381],["T_WHITESPACE","\n    ",385],["T_PUBLIC","public",386],["T_WHITESPACE"," ",386],["T_FUNCTION","function",386],["T_WHITESPACE"," ",386],["T_STRING","useValidateSessionExpire",386],"(",")",["T_WHITESPACE","\n    ",386],"{",["T_WHITESPACE","\n        ",387],["T_RETURN","return",388],["T_WHITESPACE"," ",388],["T_VARIABLE","$this",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","getCookie",388],"(",")",["T_OBJECT_OPERATOR","->",388],["T_STRING","getLifetime",388],"(",")",["T_WHITESPACE"," ",388],">",["T_WHITESPACE"," ",388],["T_LNUMBER","0",388],";",["T_WHITESPACE","\n    ",388],"}",["T_WHITESPACE","\n\n    ",389],["T_DOC_COMMENT","\/**\n     * Retrieve skip User Agent validation strings (Flash etc)\n     *\n     * @return array\n     *\/",391],["T_WHITESPACE","\n    ",395],["T_PUBLIC","public",396],["T_WHITESPACE"," ",396],["T_FUNCTION","function",396],["T_WHITESPACE"," ",396],["T_STRING","getValidateHttpUserAgentSkip",396],"(",")",["T_WHITESPACE","\n    ",396],"{",["T_WHITESPACE","\n        ",397],["T_RETURN","return",398],["T_WHITESPACE"," ",398],["T_ARRAY","array",398],"(",")",";",["T_WHITESPACE","\n    ",398],"}",["T_WHITESPACE","\n\n    ",399],["T_DOC_COMMENT","\/**\n     * Validate session\n     *\n     * @param string $namespace\n     * @return Mage_Core_Model_Session_Abstract_Varien\n     *\/",401],["T_WHITESPACE","\n    ",406],["T_PUBLIC","public",407],["T_WHITESPACE"," ",407],["T_FUNCTION","function",407],["T_WHITESPACE"," ",407],["T_STRING","validate",407],"(",")",["T_WHITESPACE","\n    ",407],"{",["T_WHITESPACE","\n        ",408],["T_IF","if",409],["T_WHITESPACE"," ",409],"(","!",["T_ISSET","isset",409],"(",["T_VARIABLE","$this",409],["T_OBJECT_OPERATOR","->",409],["T_STRING","_data",409],"[",["T_STRING","self",409],["T_DOUBLE_COLON","::",409],["T_STRING","VALIDATOR_KEY",409],"]",")",")",["T_WHITESPACE"," ",409],"{",["T_WHITESPACE","\n            ",409],["T_VARIABLE","$this",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","_data",410],"[",["T_STRING","self",410],["T_DOUBLE_COLON","::",410],["T_STRING","VALIDATOR_KEY",410],"]",["T_WHITESPACE"," ",410],"=",["T_WHITESPACE"," ",410],["T_VARIABLE","$this",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","getValidatorData",410],"(",")",";",["T_WHITESPACE","\n        ",410],"}",["T_WHITESPACE","\n        ",411],["T_ELSE","else",412],["T_WHITESPACE"," ",412],"{",["T_WHITESPACE","\n            ",412],["T_IF","if",413],["T_WHITESPACE"," ",413],"(","!",["T_VARIABLE","$this",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","_validate",413],"(",")",")",["T_WHITESPACE"," ",413],"{",["T_WHITESPACE","\n                ",413],["T_VARIABLE","$this",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","getCookie",414],"(",")",["T_OBJECT_OPERATOR","->",414],["T_STRING","delete",414],"(",["T_STRING","session_name",414],"(",")",")",";",["T_WHITESPACE","\n                ",414],["T_COMMENT","\/\/ throw core session exception\n",415],["T_WHITESPACE","                ",416],["T_THROW","throw",416],["T_WHITESPACE"," ",416],["T_NEW","new",416],["T_WHITESPACE"," ",416],["T_STRING","Mage_Core_Model_Session_Exception",416],"(",["T_CONSTANT_ENCAPSED_STRING","''",416],")",";",["T_WHITESPACE","\n            ",416],"}",["T_WHITESPACE","\n        ",417],"}",["T_WHITESPACE","\n\n        ",418],["T_RETURN","return",420],["T_WHITESPACE"," ",420],["T_VARIABLE","$this",420],";",["T_WHITESPACE","\n    ",420],"}",["T_WHITESPACE","\n\n    ",421],["T_DOC_COMMENT","\/**\n     * Validate data\n     *\n     * @return bool\n     *\/",423],["T_WHITESPACE","\n    ",427],["T_PROTECTED","protected",428],["T_WHITESPACE"," ",428],["T_FUNCTION","function",428],["T_WHITESPACE"," ",428],["T_STRING","_validate",428],"(",")",["T_WHITESPACE","\n    ",428],"{",["T_WHITESPACE","\n        ",429],["T_VARIABLE","$sessionData",430],["T_WHITESPACE"," ",430],"=",["T_WHITESPACE"," ",430],["T_VARIABLE","$this",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","_data",430],"[",["T_STRING","self",430],["T_DOUBLE_COLON","::",430],["T_STRING","VALIDATOR_KEY",430],"]",";",["T_WHITESPACE","\n        ",430],["T_VARIABLE","$validatorData",431],["T_WHITESPACE"," ",431],"=",["T_WHITESPACE"," ",431],["T_VARIABLE","$this",431],["T_OBJECT_OPERATOR","->",431],["T_STRING","getValidatorData",431],"(",")",";",["T_WHITESPACE","\n\n        ",431],["T_IF","if",433],["T_WHITESPACE"," ",433],"(",["T_VARIABLE","$this",433],["T_OBJECT_OPERATOR","->",433],["T_STRING","useValidateRemoteAddr",433],"(",")",["T_WHITESPACE","\n                ",433],["T_BOOLEAN_AND","&&",434],["T_WHITESPACE"," ",434],["T_VARIABLE","$sessionData",434],"[",["T_STRING","self",434],["T_DOUBLE_COLON","::",434],["T_STRING","VALIDATOR_REMOTE_ADDR_KEY",434],"]",["T_WHITESPACE"," ",434],["T_IS_NOT_EQUAL","!=",434],["T_WHITESPACE"," ",434],["T_VARIABLE","$validatorData",434],"[",["T_STRING","self",434],["T_DOUBLE_COLON","::",434],["T_STRING","VALIDATOR_REMOTE_ADDR_KEY",434],"]",")",["T_WHITESPACE"," ",434],"{",["T_WHITESPACE","\n            ",434],["T_RETURN","return",435],["T_WHITESPACE"," ",435],["T_STRING","false",435],";",["T_WHITESPACE","\n        ",435],"}",["T_WHITESPACE","\n        ",436],["T_IF","if",437],["T_WHITESPACE"," ",437],"(",["T_VARIABLE","$this",437],["T_OBJECT_OPERATOR","->",437],["T_STRING","useValidateHttpVia",437],"(",")",["T_WHITESPACE","\n                ",437],["T_BOOLEAN_AND","&&",438],["T_WHITESPACE"," ",438],["T_VARIABLE","$sessionData",438],"[",["T_STRING","self",438],["T_DOUBLE_COLON","::",438],["T_STRING","VALIDATOR_HTTP_VIA_KEY",438],"]",["T_WHITESPACE"," ",438],["T_IS_NOT_EQUAL","!=",438],["T_WHITESPACE"," ",438],["T_VARIABLE","$validatorData",438],"[",["T_STRING","self",438],["T_DOUBLE_COLON","::",438],["T_STRING","VALIDATOR_HTTP_VIA_KEY",438],"]",")",["T_WHITESPACE"," ",438],"{",["T_WHITESPACE","\n            ",438],["T_RETURN","return",439],["T_WHITESPACE"," ",439],["T_STRING","false",439],";",["T_WHITESPACE","\n        ",439],"}",["T_WHITESPACE","\n\n        ",440],["T_VARIABLE","$sessionValidateHttpXForwardedForKey",442],["T_WHITESPACE"," ",442],"=",["T_WHITESPACE"," ",442],["T_VARIABLE","$sessionData",442],"[",["T_STRING","self",442],["T_DOUBLE_COLON","::",442],["T_STRING","VALIDATOR_HTTP_X_FORVARDED_FOR_KEY",442],"]",";",["T_WHITESPACE","\n        ",442],["T_VARIABLE","$validatorValidateHttpXForwardedForKey",443],["T_WHITESPACE"," ",443],"=",["T_WHITESPACE"," ",443],["T_VARIABLE","$validatorData",443],"[",["T_STRING","self",443],["T_DOUBLE_COLON","::",443],["T_STRING","VALIDATOR_HTTP_X_FORVARDED_FOR_KEY",443],"]",";",["T_WHITESPACE","\n        ",443],["T_IF","if",444],["T_WHITESPACE"," ",444],"(",["T_VARIABLE","$this",444],["T_OBJECT_OPERATOR","->",444],["T_STRING","useValidateHttpXForwardedFor",444],"(",")",["T_WHITESPACE","\n            ",444],["T_BOOLEAN_AND","&&",445],["T_WHITESPACE"," ",445],["T_VARIABLE","$sessionValidateHttpXForwardedForKey",445],["T_WHITESPACE"," ",445],["T_IS_NOT_EQUAL","!=",445],["T_WHITESPACE"," ",445],["T_VARIABLE","$validatorValidateHttpXForwardedForKey",445],["T_WHITESPACE"," ",445],")",["T_WHITESPACE"," ",445],"{",["T_WHITESPACE","\n            ",445],["T_RETURN","return",446],["T_WHITESPACE"," ",446],["T_STRING","false",446],";",["T_WHITESPACE","\n        ",446],"}",["T_WHITESPACE","\n        ",447],["T_IF","if",448],["T_WHITESPACE"," ",448],"(",["T_VARIABLE","$this",448],["T_OBJECT_OPERATOR","->",448],["T_STRING","useValidateHttpUserAgent",448],"(",")",["T_WHITESPACE","\n            ",448],["T_BOOLEAN_AND","&&",449],["T_WHITESPACE"," ",449],["T_VARIABLE","$sessionData",449],"[",["T_STRING","self",449],["T_DOUBLE_COLON","::",449],["T_STRING","VALIDATOR_HTTP_USER_AGENT_KEY",449],"]",["T_WHITESPACE"," ",449],["T_IS_NOT_EQUAL","!=",449],["T_WHITESPACE"," ",449],["T_VARIABLE","$validatorData",449],"[",["T_STRING","self",449],["T_DOUBLE_COLON","::",449],["T_STRING","VALIDATOR_HTTP_USER_AGENT_KEY",449],"]",["T_WHITESPACE","\n        ",449],")",["T_WHITESPACE"," ",450],"{",["T_WHITESPACE","\n            ",450],["T_VARIABLE","$userAgentValidated",451],["T_WHITESPACE"," ",451],"=",["T_WHITESPACE"," ",451],["T_VARIABLE","$this",451],["T_OBJECT_OPERATOR","->",451],["T_STRING","getValidateHttpUserAgentSkip",451],"(",")",";",["T_WHITESPACE","\n            ",451],["T_FOREACH","foreach",452],["T_WHITESPACE"," ",452],"(",["T_VARIABLE","$userAgentValidated",452],["T_WHITESPACE"," ",452],["T_AS","as",452],["T_WHITESPACE"," ",452],["T_VARIABLE","$agent",452],")",["T_WHITESPACE"," ",452],"{",["T_WHITESPACE","\n                ",452],["T_IF","if",453],["T_WHITESPACE"," ",453],"(",["T_STRING","preg_match",453],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",453],["T_WHITESPACE"," ",453],".",["T_WHITESPACE"," ",453],["T_VARIABLE","$agent",453],["T_WHITESPACE"," ",453],".",["T_WHITESPACE"," ",453],["T_CONSTANT_ENCAPSED_STRING","'\/iu'",453],",",["T_WHITESPACE"," ",453],["T_VARIABLE","$validatorData",453],"[",["T_STRING","self",453],["T_DOUBLE_COLON","::",453],["T_STRING","VALIDATOR_HTTP_USER_AGENT_KEY",453],"]",")",")",["T_WHITESPACE"," ",453],"{",["T_WHITESPACE","\n                    ",453],["T_RETURN","return",454],["T_WHITESPACE"," ",454],["T_STRING","true",454],";",["T_WHITESPACE","\n                ",454],"}",["T_WHITESPACE","\n            ",455],"}",["T_WHITESPACE","\n            ",456],["T_RETURN","return",457],["T_WHITESPACE"," ",457],["T_STRING","false",457],";",["T_WHITESPACE","\n        ",457],"}",["T_WHITESPACE","\n\n        ",458],["T_IF","if",460],["T_WHITESPACE"," ",460],"(",["T_VARIABLE","$this",460],["T_OBJECT_OPERATOR","->",460],["T_STRING","useValidateSessionExpire",460],"(",")",["T_WHITESPACE","\n            ",460],["T_BOOLEAN_AND","&&",461],["T_WHITESPACE"," ",461],["T_ISSET","isset",461],"(",["T_VARIABLE","$sessionData",461],"[",["T_STRING","self",461],["T_DOUBLE_COLON","::",461],["T_STRING","VALIDATOR_SESSION_EXPIRE_TIMESTAMP",461],"]",")",["T_WHITESPACE","\n            ",461],["T_BOOLEAN_AND","&&",462],["T_WHITESPACE"," ",462],["T_VARIABLE","$sessionData",462],"[",["T_STRING","self",462],["T_DOUBLE_COLON","::",462],["T_STRING","VALIDATOR_SESSION_EXPIRE_TIMESTAMP",462],"]",["T_WHITESPACE"," ",462],"<",["T_WHITESPACE"," ",462],["T_STRING","time",462],"(",")",["T_WHITESPACE"," ",462],")",["T_WHITESPACE"," ",462],"{",["T_WHITESPACE","\n            ",462],["T_RETURN","return",463],["T_WHITESPACE"," ",463],["T_STRING","false",463],";",["T_WHITESPACE","\n        ",463],"}",["T_WHITESPACE"," ",464],["T_ELSE","else",464],["T_WHITESPACE"," ",464],"{",["T_WHITESPACE","\n            ",464],["T_VARIABLE","$this",465],["T_OBJECT_OPERATOR","->",465],["T_STRING","_data",465],"[",["T_STRING","self",465],["T_DOUBLE_COLON","::",465],["T_STRING","VALIDATOR_KEY",465],"]","[",["T_STRING","self",465],["T_DOUBLE_COLON","::",465],["T_STRING","VALIDATOR_SESSION_EXPIRE_TIMESTAMP",465],"]",["T_WHITESPACE","\n                ",465],"=",["T_WHITESPACE"," ",466],["T_VARIABLE","$validatorData",466],"[",["T_STRING","self",466],["T_DOUBLE_COLON","::",466],["T_STRING","VALIDATOR_SESSION_EXPIRE_TIMESTAMP",466],"]",";",["T_WHITESPACE","\n        ",466],"}",["T_WHITESPACE","\n\n        ",467],["T_RETURN","return",469],["T_WHITESPACE"," ",469],["T_STRING","true",469],";",["T_WHITESPACE","\n    ",469],"}",["T_WHITESPACE","\n\n    ",470],["T_DOC_COMMENT","\/**\n     * Retrieve unique user data for validator\n     *\n     * @return array\n     *\/",472],["T_WHITESPACE","\n    ",476],["T_PUBLIC","public",477],["T_WHITESPACE"," ",477],["T_FUNCTION","function",477],["T_WHITESPACE"," ",477],["T_STRING","getValidatorData",477],"(",")",["T_WHITESPACE","\n    ",477],"{",["T_WHITESPACE","\n        ",478],["T_VARIABLE","$parts",479],["T_WHITESPACE"," ",479],"=",["T_WHITESPACE"," ",479],["T_ARRAY","array",479],"(",["T_WHITESPACE","\n            ",479],["T_STRING","self",480],["T_DOUBLE_COLON","::",480],["T_STRING","VALIDATOR_REMOTE_ADDR_KEY",480],["T_WHITESPACE","             ",480],["T_DOUBLE_ARROW","=>",480],["T_WHITESPACE"," ",480],["T_CONSTANT_ENCAPSED_STRING","''",480],",",["T_WHITESPACE","\n            ",480],["T_STRING","self",481],["T_DOUBLE_COLON","::",481],["T_STRING","VALIDATOR_HTTP_VIA_KEY",481],["T_WHITESPACE","                ",481],["T_DOUBLE_ARROW","=>",481],["T_WHITESPACE"," ",481],["T_CONSTANT_ENCAPSED_STRING","''",481],",",["T_WHITESPACE","\n            ",481],["T_STRING","self",482],["T_DOUBLE_COLON","::",482],["T_STRING","VALIDATOR_HTTP_X_FORVARDED_FOR_KEY",482],["T_WHITESPACE","    ",482],["T_DOUBLE_ARROW","=>",482],["T_WHITESPACE"," ",482],["T_CONSTANT_ENCAPSED_STRING","''",482],",",["T_WHITESPACE","\n            ",482],["T_STRING","self",483],["T_DOUBLE_COLON","::",483],["T_STRING","VALIDATOR_HTTP_USER_AGENT_KEY",483],["T_WHITESPACE","         ",483],["T_DOUBLE_ARROW","=>",483],["T_WHITESPACE"," ",483],["T_CONSTANT_ENCAPSED_STRING","''",483],["T_WHITESPACE","\n        ",483],")",";",["T_WHITESPACE","\n\n        ",484],["T_COMMENT","\/\/ collect ip data\n",486],["T_WHITESPACE","        ",487],["T_IF","if",487],["T_WHITESPACE"," ",487],"(",["T_STRING","Mage",487],["T_DOUBLE_COLON","::",487],["T_STRING","helper",487],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/http'",487],")",["T_OBJECT_OPERATOR","->",487],["T_STRING","getRemoteAddr",487],"(",")",")",["T_WHITESPACE"," ",487],"{",["T_WHITESPACE","\n            ",487],["T_VARIABLE","$parts",488],"[",["T_STRING","self",488],["T_DOUBLE_COLON","::",488],["T_STRING","VALIDATOR_REMOTE_ADDR_KEY",488],"]",["T_WHITESPACE"," ",488],"=",["T_WHITESPACE"," ",488],["T_STRING","Mage",488],["T_DOUBLE_COLON","::",488],["T_STRING","helper",488],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/http'",488],")",["T_OBJECT_OPERATOR","->",488],["T_STRING","getRemoteAddr",488],"(",")",";",["T_WHITESPACE","\n        ",488],"}",["T_WHITESPACE","\n        ",489],["T_IF","if",490],["T_WHITESPACE"," ",490],"(",["T_ISSET","isset",490],"(",["T_VARIABLE","$_ENV",490],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_VIA'",490],"]",")",")",["T_WHITESPACE"," ",490],"{",["T_WHITESPACE","\n            ",490],["T_VARIABLE","$parts",491],"[",["T_STRING","self",491],["T_DOUBLE_COLON","::",491],["T_STRING","VALIDATOR_HTTP_VIA_KEY",491],"]",["T_WHITESPACE"," ",491],"=",["T_WHITESPACE"," ",491],["T_STRING_CAST","(string)",491],["T_VARIABLE","$_ENV",491],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_VIA'",491],"]",";",["T_WHITESPACE","\n        ",491],"}",["T_WHITESPACE","\n        ",492],["T_IF","if",493],["T_WHITESPACE"," ",493],"(",["T_ISSET","isset",493],"(",["T_VARIABLE","$_ENV",493],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_X_FORWARDED_FOR'",493],"]",")",")",["T_WHITESPACE"," ",493],"{",["T_WHITESPACE","\n            ",493],["T_VARIABLE","$parts",494],"[",["T_STRING","self",494],["T_DOUBLE_COLON","::",494],["T_STRING","VALIDATOR_HTTP_X_FORVARDED_FOR_KEY",494],"]",["T_WHITESPACE"," ",494],"=",["T_WHITESPACE"," ",494],["T_STRING_CAST","(string)",494],["T_VARIABLE","$_ENV",494],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_X_FORWARDED_FOR'",494],"]",";",["T_WHITESPACE","\n        ",494],"}",["T_WHITESPACE","\n\n        ",495],["T_COMMENT","\/\/ collect user agent data\n",497],["T_WHITESPACE","        ",498],["T_IF","if",498],["T_WHITESPACE"," ",498],"(",["T_ISSET","isset",498],"(",["T_VARIABLE","$_SERVER",498],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_USER_AGENT'",498],"]",")",")",["T_WHITESPACE"," ",498],"{",["T_WHITESPACE","\n            ",498],["T_VARIABLE","$parts",499],"[",["T_STRING","self",499],["T_DOUBLE_COLON","::",499],["T_STRING","VALIDATOR_HTTP_USER_AGENT_KEY",499],"]",["T_WHITESPACE"," ",499],"=",["T_WHITESPACE"," ",499],["T_STRING_CAST","(string)",499],["T_VARIABLE","$_SERVER",499],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_USER_AGENT'",499],"]",";",["T_WHITESPACE","\n        ",499],"}",["T_WHITESPACE","\n\n        ",500],["T_VARIABLE","$parts",502],"[",["T_STRING","self",502],["T_DOUBLE_COLON","::",502],["T_STRING","VALIDATOR_SESSION_EXPIRE_TIMESTAMP",502],"]",["T_WHITESPACE"," ",502],"=",["T_WHITESPACE"," ",502],["T_STRING","time",502],"(",")",["T_WHITESPACE"," ",502],"+",["T_WHITESPACE"," ",502],["T_VARIABLE","$this",502],["T_OBJECT_OPERATOR","->",502],["T_STRING","getCookie",502],"(",")",["T_OBJECT_OPERATOR","->",502],["T_STRING","getLifetime",502],"(",")",";",["T_WHITESPACE","\n\n        ",502],["T_RETURN","return",504],["T_WHITESPACE"," ",504],["T_VARIABLE","$parts",504],";",["T_WHITESPACE","\n    ",504],"}",["T_WHITESPACE","\n\n    ",505],["T_DOC_COMMENT","\/**\n     * Regenerate session Id\n     *\n     * @return Mage_Core_Model_Session_Abstract_Varien\n     *\/",507],["T_WHITESPACE","\n    ",511],["T_PUBLIC","public",512],["T_WHITESPACE"," ",512],["T_FUNCTION","function",512],["T_WHITESPACE"," ",512],["T_STRING","regenerateSessionId",512],"(",")",["T_WHITESPACE","\n    ",512],"{",["T_WHITESPACE","\n        ",513],["T_STRING","session_regenerate_id",514],"(",["T_STRING","true",514],")",";",["T_WHITESPACE","\n        ",514],["T_RETURN","return",515],["T_WHITESPACE"," ",515],["T_VARIABLE","$this",515],";",["T_WHITESPACE","\n    ",515],"}",["T_WHITESPACE","\n",516],"}",["T_WHITESPACE","\n",517]]