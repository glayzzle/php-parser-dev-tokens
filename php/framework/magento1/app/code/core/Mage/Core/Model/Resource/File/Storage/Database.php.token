[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Core\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * File storage database resource resource model class\n *\n * @category    Mage\n * @package     Mage_Core\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Model_Resource_File_Storage_Database",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Model_Resource_File_Storage_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Define table name and id field for resource\n     *\/",37],["T_WHITESPACE","\n    ",39],["T_PROTECTED","protected",40],["T_WHITESPACE"," ",40],["T_FUNCTION","function",40],["T_WHITESPACE"," ",40],["T_STRING","_construct",40],"(",")",["T_WHITESPACE","\n    ",40],"{",["T_WHITESPACE","\n        ",41],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","_init",42],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/file_storage'",42],",",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'file_id'",42],")",";",["T_WHITESPACE","\n    ",42],"}",["T_WHITESPACE","\n\n    ",43],["T_DOC_COMMENT","\/**\n     * Create database scheme for storing files\n     *\n     * @return Mage_Core_Model_Resource_File_Storage_Database\n     *\/",45],["T_WHITESPACE","\n    ",49],["T_PUBLIC","public",50],["T_WHITESPACE"," ",50],["T_FUNCTION","function",50],["T_WHITESPACE"," ",50],["T_STRING","createDatabaseScheme",50],"(",")",["T_WHITESPACE","\n    ",50],"{",["T_WHITESPACE","\n        ",51],["T_VARIABLE","$adapter",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","_getWriteAdapter",52],"(",")",";",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$table",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","getMainTable",53],"(",")",";",["T_WHITESPACE","\n        ",53],["T_IF","if",54],["T_WHITESPACE"," ",54],"(",["T_VARIABLE","$adapter",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","isTableExists",54],"(",["T_VARIABLE","$table",54],")",")",["T_WHITESPACE"," ",54],"{",["T_WHITESPACE","\n            ",54],["T_RETURN","return",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$this",55],";",["T_WHITESPACE","\n        ",55],"}",["T_WHITESPACE","\n\n        ",56],["T_VARIABLE","$dirStorageTable",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","getTable",58],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/directory_storage'",58],")",";",["T_WHITESPACE"," ",58],["T_COMMENT","\/\/ For foreign key\n",58],["T_WHITESPACE","\n        ",59],["T_VARIABLE","$ddlTable",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$adapter",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","newTable",60],"(",["T_VARIABLE","$table",60],")",["T_WHITESPACE","\n            ",60],["T_OBJECT_OPERATOR","->",61],["T_STRING","addColumn",61],"(",["T_CONSTANT_ENCAPSED_STRING","'file_id'",61],",",["T_WHITESPACE"," ",61],["T_STRING","Varien_Db_Ddl_Table",61],["T_DOUBLE_COLON","::",61],["T_STRING","TYPE_INTEGER",61],",",["T_WHITESPACE"," ",61],["T_STRING","null",61],",",["T_WHITESPACE"," ",61],["T_ARRAY","array",61],"(",["T_WHITESPACE","\n                ",61],["T_CONSTANT_ENCAPSED_STRING","'identity'",62],["T_WHITESPACE","  ",62],["T_DOUBLE_ARROW","=>",62],["T_WHITESPACE"," ",62],["T_STRING","true",62],",",["T_WHITESPACE","\n                ",62],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",63],["T_WHITESPACE","  ",63],["T_DOUBLE_ARROW","=>",63],["T_WHITESPACE"," ",63],["T_STRING","true",63],",",["T_WHITESPACE","\n                ",63],["T_CONSTANT_ENCAPSED_STRING","'nullable'",64],["T_WHITESPACE","  ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_STRING","false",64],",",["T_WHITESPACE","\n                ",64],["T_CONSTANT_ENCAPSED_STRING","'primary'",65],["T_WHITESPACE","   ",65],["T_DOUBLE_ARROW","=>",65],["T_WHITESPACE"," ",65],["T_STRING","true",65],["T_WHITESPACE","\n                ",65],")",",",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'File Id'",66],")",["T_WHITESPACE","\n            ",66],["T_OBJECT_OPERATOR","->",67],["T_STRING","addColumn",67],"(",["T_CONSTANT_ENCAPSED_STRING","'content'",67],",",["T_WHITESPACE"," ",67],["T_STRING","Varien_Db_Ddl_Table",67],["T_DOUBLE_COLON","::",67],["T_STRING","TYPE_VARBINARY",67],",",["T_WHITESPACE"," ",67],["T_STRING","Varien_Db_Ddl_Table",67],["T_DOUBLE_COLON","::",67],["T_STRING","MAX_VARBINARY_SIZE",67],",",["T_WHITESPACE"," ",67],["T_ARRAY","array",67],"(",["T_WHITESPACE","\n                ",67],["T_CONSTANT_ENCAPSED_STRING","'nullable'",68],["T_WHITESPACE"," ",68],["T_DOUBLE_ARROW","=>",68],["T_WHITESPACE"," ",68],["T_STRING","false",68],["T_WHITESPACE","\n                ",68],")",",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'File Content'",69],")",["T_WHITESPACE","\n            ",69],["T_OBJECT_OPERATOR","->",70],["T_STRING","addColumn",70],"(",["T_CONSTANT_ENCAPSED_STRING","'upload_time'",70],",",["T_WHITESPACE"," ",70],["T_STRING","Varien_Db_Ddl_Table",70],["T_DOUBLE_COLON","::",70],["T_STRING","TYPE_TIMESTAMP",70],",",["T_WHITESPACE"," ",70],["T_STRING","null",70],",",["T_WHITESPACE"," ",70],["T_ARRAY","array",70],"(",["T_WHITESPACE","\n                ",70],["T_CONSTANT_ENCAPSED_STRING","'nullable'",71],["T_WHITESPACE"," ",71],["T_DOUBLE_ARROW","=>",71],["T_WHITESPACE"," ",71],["T_STRING","false",71],",",["T_WHITESPACE","\n                ",71],["T_CONSTANT_ENCAPSED_STRING","'default'",72],["T_WHITESPACE"," ",72],["T_DOUBLE_ARROW","=>",72],["T_WHITESPACE"," ",72],["T_STRING","Varien_Db_Ddl_Table",72],["T_DOUBLE_COLON","::",72],["T_STRING","TIMESTAMP_INIT",72],["T_WHITESPACE","\n                ",72],")",",",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'Upload Timestamp'",73],")",["T_WHITESPACE","\n            ",73],["T_OBJECT_OPERATOR","->",74],["T_STRING","addColumn",74],"(",["T_CONSTANT_ENCAPSED_STRING","'filename'",74],",",["T_WHITESPACE"," ",74],["T_STRING","Varien_Db_Ddl_Table",74],["T_DOUBLE_COLON","::",74],["T_STRING","TYPE_TEXT",74],",",["T_WHITESPACE"," ",74],["T_LNUMBER","100",74],",",["T_WHITESPACE"," ",74],["T_ARRAY","array",74],"(",["T_WHITESPACE","\n                ",74],["T_CONSTANT_ENCAPSED_STRING","'nullable'",75],["T_WHITESPACE"," ",75],["T_DOUBLE_ARROW","=>",75],["T_WHITESPACE"," ",75],["T_STRING","false",75],["T_WHITESPACE","\n                ",75],")",",",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'Filename'",76],")",["T_WHITESPACE","\n            ",76],["T_OBJECT_OPERATOR","->",77],["T_STRING","addColumn",77],"(",["T_CONSTANT_ENCAPSED_STRING","'directory_id'",77],",",["T_WHITESPACE"," ",77],["T_STRING","Varien_Db_Ddl_Table",77],["T_DOUBLE_COLON","::",77],["T_STRING","TYPE_INTEGER",77],",",["T_WHITESPACE"," ",77],["T_STRING","null",77],",",["T_WHITESPACE"," ",77],["T_ARRAY","array",77],"(",["T_WHITESPACE","\n                ",77],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",78],["T_WHITESPACE"," ",78],["T_DOUBLE_ARROW","=>",78],["T_WHITESPACE"," ",78],["T_STRING","true",78],",",["T_WHITESPACE","\n                ",78],["T_CONSTANT_ENCAPSED_STRING","'default'",79],["T_WHITESPACE"," ",79],["T_DOUBLE_ARROW","=>",79],["T_WHITESPACE"," ",79],["T_STRING","null",79],["T_WHITESPACE","\n                ",79],")",",",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'Identifier of Directory where File is Located'",80],")",["T_WHITESPACE","\n            ",80],["T_OBJECT_OPERATOR","->",81],["T_STRING","addColumn",81],"(",["T_CONSTANT_ENCAPSED_STRING","'directory'",81],",",["T_WHITESPACE"," ",81],["T_STRING","Varien_Db_Ddl_Table",81],["T_DOUBLE_COLON","::",81],["T_STRING","TYPE_TEXT",81],",",["T_WHITESPACE"," ",81],["T_LNUMBER","255",81],",",["T_WHITESPACE"," ",81],["T_ARRAY","array",81],"(",["T_WHITESPACE","\n                ",81],["T_CONSTANT_ENCAPSED_STRING","'default'",82],["T_WHITESPACE"," ",82],["T_DOUBLE_ARROW","=>",82],["T_WHITESPACE"," ",82],["T_STRING","null",82],["T_WHITESPACE","\n                ",82],")",",",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'Directory Path'",83],")",["T_WHITESPACE","\n            ",83],["T_OBJECT_OPERATOR","->",84],["T_STRING","addIndex",84],"(",["T_VARIABLE","$adapter",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getIndexName",84],"(",["T_VARIABLE","$table",84],",",["T_WHITESPACE"," ",84],["T_ARRAY","array",84],"(",["T_CONSTANT_ENCAPSED_STRING","'filename'",84],",",["T_WHITESPACE"," ",84],["T_CONSTANT_ENCAPSED_STRING","'directory_id'",84],")",",",["T_WHITESPACE","\n                ",84],["T_STRING","Varien_Db_Adapter_Interface",85],["T_DOUBLE_COLON","::",85],["T_STRING","INDEX_TYPE_UNIQUE",85],")",",",["T_WHITESPACE","\n                ",85],["T_ARRAY","array",86],"(",["T_CONSTANT_ENCAPSED_STRING","'filename'",86],",",["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","'directory_id'",86],")",",",["T_WHITESPACE"," ",86],["T_ARRAY","array",86],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",86],["T_WHITESPACE"," ",86],["T_DOUBLE_ARROW","=>",86],["T_WHITESPACE"," ",86],["T_STRING","Varien_Db_Adapter_Interface",86],["T_DOUBLE_COLON","::",86],["T_STRING","INDEX_TYPE_UNIQUE",86],")",")",["T_WHITESPACE","\n            ",86],["T_OBJECT_OPERATOR","->",87],["T_STRING","addIndex",87],"(",["T_VARIABLE","$adapter",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getIndexName",87],"(",["T_VARIABLE","$table",87],",",["T_WHITESPACE"," ",87],["T_ARRAY","array",87],"(",["T_CONSTANT_ENCAPSED_STRING","'directory_id'",87],")",")",",",["T_WHITESPACE"," ",87],["T_ARRAY","array",87],"(",["T_CONSTANT_ENCAPSED_STRING","'directory_id'",87],")",")",["T_WHITESPACE","\n            ",87],["T_OBJECT_OPERATOR","->",88],["T_STRING","addForeignKey",88],"(",["T_VARIABLE","$adapter",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","getForeignKeyName",88],"(",["T_VARIABLE","$table",88],",",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'directory_id'",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$dirStorageTable",88],",",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'directory_id'",88],")",",",["T_WHITESPACE","\n                ",88],["T_CONSTANT_ENCAPSED_STRING","'directory_id'",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$dirStorageTable",89],",",["T_WHITESPACE"," ",89],["T_CONSTANT_ENCAPSED_STRING","'directory_id'",89],",",["T_WHITESPACE","\n                ",89],["T_STRING","Varien_Db_Ddl_Table",90],["T_DOUBLE_COLON","::",90],["T_STRING","ACTION_CASCADE",90],",",["T_WHITESPACE"," ",90],["T_STRING","Varien_Db_Ddl_Table",90],["T_DOUBLE_COLON","::",90],["T_STRING","ACTION_CASCADE",90],")",["T_WHITESPACE","\n            ",90],["T_OBJECT_OPERATOR","->",91],["T_STRING","setComment",91],"(",["T_CONSTANT_ENCAPSED_STRING","'File Storage'",91],")",";",["T_WHITESPACE","\n\n        ",91],["T_VARIABLE","$adapter",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","createTable",93],"(",["T_VARIABLE","$ddlTable",93],")",";",["T_WHITESPACE","\n        ",93],["T_RETURN","return",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],";",["T_WHITESPACE","\n    ",94],"}",["T_WHITESPACE","\n\n    ",95],["T_DOC_COMMENT","\/**\n     * Decodes blob content retrieved by DB driver\n     *\n     * @param  array $row Table row with 'content' key in it\n     * @return array\n     *\/",97],["T_WHITESPACE","\n    ",102],["T_PROTECTED","protected",103],["T_WHITESPACE"," ",103],["T_FUNCTION","function",103],["T_WHITESPACE"," ",103],["T_STRING","_decodeFileContent",103],"(",["T_VARIABLE","$row",103],")",["T_WHITESPACE","\n    ",103],"{",["T_WHITESPACE","\n        ",104],["T_VARIABLE","$row",105],"[",["T_CONSTANT_ENCAPSED_STRING","'content'",105],"]",["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","_getReadAdapter",105],"(",")",["T_OBJECT_OPERATOR","->",105],["T_STRING","decodeVarbinary",105],"(",["T_VARIABLE","$row",105],"[",["T_CONSTANT_ENCAPSED_STRING","'content'",105],"]",")",";",["T_WHITESPACE","\n        ",105],["T_RETURN","return",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$row",106],";",["T_WHITESPACE","\n    ",106],"}",["T_WHITESPACE","\n\n    ",107],["T_DOC_COMMENT","\/**\n     * Decodes blob content retrieved by Database driver\n     *\n     * @param  array $rows Array of table rows (files), each containing 'content' key\n     * @return array\n     *\/",109],["T_WHITESPACE","\n    ",114],["T_PROTECTED","protected",115],["T_WHITESPACE"," ",115],["T_FUNCTION","function",115],["T_WHITESPACE"," ",115],["T_STRING","_decodeAllFilesContent",115],"(",["T_VARIABLE","$rows",115],")",["T_WHITESPACE","\n    ",115],"{",["T_WHITESPACE","\n        ",116],["T_FOREACH","foreach",117],["T_WHITESPACE"," ",117],"(",["T_VARIABLE","$rows",117],["T_WHITESPACE"," ",117],["T_AS","as",117],["T_WHITESPACE"," ",117],["T_VARIABLE","$key",117],["T_WHITESPACE"," ",117],["T_DOUBLE_ARROW","=>",117],["T_WHITESPACE"," ",117],["T_VARIABLE","$row",117],")",["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n            ",117],["T_VARIABLE","$rows",118],"[",["T_VARIABLE","$key",118],"]",["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","_decodeFileContent",118],"(",["T_VARIABLE","$row",118],")",";",["T_WHITESPACE","\n        ",118],"}",["T_WHITESPACE","\n        ",119],["T_RETURN","return",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$rows",120],";",["T_WHITESPACE","\n    ",120],"}",["T_WHITESPACE","\n\n    ",121],["T_DOC_COMMENT","\/**\n     * Load entity by filename\n     *\n     * @param  Mage_Core_Model_File_Storage_Database $object\n     * @param  string $filename\n     * @param  string $path\n     * @return Mage_Core_Model_Mysql4_File_Storage_Database\n     *\/",123],["T_WHITESPACE","\n    ",130],["T_PUBLIC","public",131],["T_WHITESPACE"," ",131],["T_FUNCTION","function",131],["T_WHITESPACE"," ",131],["T_STRING","loadByFilename",131],"(",["T_STRING","Mage_Core_Model_File_Storage_Database",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$object",131],",",["T_WHITESPACE"," ",131],["T_VARIABLE","$filename",131],",",["T_WHITESPACE"," ",131],["T_VARIABLE","$path",131],")",["T_WHITESPACE","\n    ",131],"{",["T_WHITESPACE","\n        ",132],["T_VARIABLE","$adapter",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_getReadAdapter",133],"(",")",";",["T_WHITESPACE","\n\n        ",133],["T_VARIABLE","$select",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_VARIABLE","$adapter",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","select",135],"(",")",["T_WHITESPACE","\n            ",135],["T_OBJECT_OPERATOR","->",136],["T_STRING","from",136],"(",["T_ARRAY","array",136],"(",["T_CONSTANT_ENCAPSED_STRING","'e'",136],["T_WHITESPACE"," ",136],["T_DOUBLE_ARROW","=>",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getMainTable",136],"(",")",")",")",["T_WHITESPACE","\n            ",136],["T_OBJECT_OPERATOR","->",137],["T_STRING","where",137],"(",["T_CONSTANT_ENCAPSED_STRING","'filename = ?'",137],",",["T_WHITESPACE"," ",137],["T_VARIABLE","$filename",137],")",["T_WHITESPACE","\n            ",137],["T_OBJECT_OPERATOR","->",138],["T_STRING","where",138],"(",["T_VARIABLE","$adapter",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","prepareSqlCondition",138],"(",["T_CONSTANT_ENCAPSED_STRING","'directory'",138],",",["T_WHITESPACE"," ",138],["T_ARRAY","array",138],"(",["T_CONSTANT_ENCAPSED_STRING","'seq'",138],["T_WHITESPACE"," ",138],["T_DOUBLE_ARROW","=>",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$path",138],")",")",")",";",["T_WHITESPACE","\n\n        ",138],["T_VARIABLE","$row",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_VARIABLE","$adapter",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","fetchRow",140],"(",["T_VARIABLE","$select",140],")",";",["T_WHITESPACE","\n        ",140],["T_IF","if",141],["T_WHITESPACE"," ",141],"(",["T_VARIABLE","$row",141],")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n            ",141],["T_VARIABLE","$row",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","_decodeFileContent",142],"(",["T_VARIABLE","$row",142],")",";",["T_WHITESPACE","\n            ",142],["T_VARIABLE","$object",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","setData",143],"(",["T_VARIABLE","$row",143],")",";",["T_WHITESPACE","\n            ",143],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","_afterLoad",144],"(",["T_VARIABLE","$object",144],")",";",["T_WHITESPACE","\n        ",144],"}",["T_WHITESPACE","\n\n        ",145],["T_RETURN","return",147],["T_WHITESPACE"," ",147],["T_VARIABLE","$this",147],";",["T_WHITESPACE","\n    ",147],"}",["T_WHITESPACE","\n\n    ",148],["T_DOC_COMMENT","\/**\n     * Clear files in storage\n     *\n     * @return Mage_Core_Model_Mysql4_File_Storage_Database\n     *\/",150],["T_WHITESPACE","\n    ",154],["T_PUBLIC","public",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","clearFiles",155],"(",")",["T_WHITESPACE","\n    ",155],"{",["T_WHITESPACE","\n        ",156],["T_VARIABLE","$adapter",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","_getWriteAdapter",157],"(",")",";",["T_WHITESPACE","\n        ",157],["T_VARIABLE","$adapter",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","delete",158],"(",["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","getMainTable",158],"(",")",")",";",["T_WHITESPACE","\n\n        ",158],["T_RETURN","return",160],["T_WHITESPACE"," ",160],["T_VARIABLE","$this",160],";",["T_WHITESPACE","\n    ",160],"}",["T_WHITESPACE","\n\n    ",161],["T_DOC_COMMENT","\/**\n     * Get files from storage at defined range\n     *\n     * @param  int $offset\n     * @param  int $count\n     * @return array\n     *\/",163],["T_WHITESPACE","\n    ",169],["T_PUBLIC","public",170],["T_WHITESPACE"," ",170],["T_FUNCTION","function",170],["T_WHITESPACE"," ",170],["T_STRING","getFiles",170],"(",["T_VARIABLE","$offset",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_LNUMBER","0",170],",",["T_WHITESPACE"," ",170],["T_VARIABLE","$count",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_LNUMBER","100",170],")",["T_WHITESPACE","\n    ",170],"{",["T_WHITESPACE","\n        ",171],["T_VARIABLE","$adapter",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","_getReadAdapter",172],"(",")",";",["T_WHITESPACE","\n\n        ",172],["T_VARIABLE","$select",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_VARIABLE","$adapter",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","select",174],"(",")",["T_WHITESPACE","\n            ",174],["T_OBJECT_OPERATOR","->",175],["T_STRING","from",175],"(",["T_WHITESPACE","\n                ",175],["T_ARRAY","array",176],"(",["T_CONSTANT_ENCAPSED_STRING","'e'",176],["T_WHITESPACE"," ",176],["T_DOUBLE_ARROW","=>",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","getMainTable",176],"(",")",")",",",["T_WHITESPACE","\n                ",176],["T_ARRAY","array",177],"(",["T_CONSTANT_ENCAPSED_STRING","'filename'",177],",",["T_WHITESPACE"," ",177],["T_CONSTANT_ENCAPSED_STRING","'content'",177],",",["T_WHITESPACE"," ",177],["T_CONSTANT_ENCAPSED_STRING","'directory'",177],")",["T_WHITESPACE","\n            ",177],")",["T_WHITESPACE","\n            ",178],["T_OBJECT_OPERATOR","->",179],["T_STRING","order",179],"(",["T_CONSTANT_ENCAPSED_STRING","'file_id'",179],")",["T_WHITESPACE","\n            ",179],["T_OBJECT_OPERATOR","->",180],["T_STRING","limit",180],"(",["T_VARIABLE","$count",180],",",["T_WHITESPACE"," ",180],["T_VARIABLE","$offset",180],")",";",["T_WHITESPACE","\n\n        ",180],["T_VARIABLE","$rows",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_VARIABLE","$adapter",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","fetchAll",182],"(",["T_VARIABLE","$select",182],")",";",["T_WHITESPACE","\n        ",182],["T_RETURN","return",183],["T_WHITESPACE"," ",183],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","_decodeAllFilesContent",183],"(",["T_VARIABLE","$rows",183],")",";",["T_WHITESPACE","\n    ",183],"}",["T_WHITESPACE","\n\n    ",184],["T_DOC_COMMENT","\/**\n     * Save file to storage\n     *\n     * @param  Mage_Core_Model_File_Storage_Database|array $object\n     * @return Mage_Core_Model_Mysql4_File_Storage_Database\n     *\/",186],["T_WHITESPACE","\n    ",191],["T_PUBLIC","public",192],["T_WHITESPACE"," ",192],["T_FUNCTION","function",192],["T_WHITESPACE"," ",192],["T_STRING","saveFile",192],"(",["T_VARIABLE","$file",192],")",["T_WHITESPACE","\n    ",192],"{",["T_WHITESPACE","\n        ",193],["T_VARIABLE","$adapter",194],["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","_getWriteAdapter",194],"(",")",";",["T_WHITESPACE","\n\n        ",194],["T_VARIABLE","$contentParam",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_NEW","new",196],["T_WHITESPACE"," ",196],["T_STRING","Varien_Db_Statement_Parameter",196],"(",["T_VARIABLE","$file",196],"[",["T_CONSTANT_ENCAPSED_STRING","'content'",196],"]",")",";",["T_WHITESPACE","\n        ",196],["T_VARIABLE","$contentParam",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","setIsBlob",197],"(",["T_STRING","true",197],")",";",["T_WHITESPACE","\n        ",197],["T_VARIABLE","$data",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_ARRAY","array",198],"(",["T_WHITESPACE","\n            ",198],["T_CONSTANT_ENCAPSED_STRING","'content'",199],["T_WHITESPACE","        ",199],["T_DOUBLE_ARROW","=>",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$contentParam",199],",",["T_WHITESPACE","\n            ",199],["T_CONSTANT_ENCAPSED_STRING","'upload_time'",200],["T_WHITESPACE","    ",200],["T_DOUBLE_ARROW","=>",200],["T_WHITESPACE"," ",200],["T_VARIABLE","$file",200],"[",["T_CONSTANT_ENCAPSED_STRING","'update_time'",200],"]",",",["T_WHITESPACE","\n            ",200],["T_CONSTANT_ENCAPSED_STRING","'filename'",201],["T_WHITESPACE","       ",201],["T_DOUBLE_ARROW","=>",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$file",201],"[",["T_CONSTANT_ENCAPSED_STRING","'filename'",201],"]",",",["T_WHITESPACE","\n            ",201],["T_CONSTANT_ENCAPSED_STRING","'directory_id'",202],["T_WHITESPACE","   ",202],["T_DOUBLE_ARROW","=>",202],["T_WHITESPACE"," ",202],["T_VARIABLE","$file",202],"[",["T_CONSTANT_ENCAPSED_STRING","'directory_id'",202],"]",",",["T_WHITESPACE","\n            ",202],["T_CONSTANT_ENCAPSED_STRING","'directory'",203],["T_WHITESPACE","      ",203],["T_DOUBLE_ARROW","=>",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$file",203],"[",["T_CONSTANT_ENCAPSED_STRING","'directory'",203],"]",["T_WHITESPACE","\n        ",203],")",";",["T_WHITESPACE","\n\n        ",204],["T_VARIABLE","$adapter",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","insertOnDuplicate",206],"(",["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","getMainTable",206],"(",")",",",["T_WHITESPACE"," ",206],["T_VARIABLE","$data",206],",",["T_WHITESPACE"," ",206],["T_ARRAY","array",206],"(",["T_CONSTANT_ENCAPSED_STRING","'content'",206],",",["T_WHITESPACE"," ",206],["T_CONSTANT_ENCAPSED_STRING","'upload_time'",206],")",")",";",["T_WHITESPACE","\n\n        ",206],["T_RETURN","return",208],["T_WHITESPACE"," ",208],["T_VARIABLE","$this",208],";",["T_WHITESPACE","\n    ",208],"}",["T_WHITESPACE","\n\n    ",209],["T_DOC_COMMENT","\/**\n     * Rename files in database\n     *\n     * @param  string $oldFilename\n     * @param  string $oldPath\n     * @param  string $newFilename\n     * @param  string $newPath\n     * @return Mage_Core_Model_Mysql4_File_Storage_Database\n     *\/",211],["T_WHITESPACE","\n    ",219],["T_PUBLIC","public",220],["T_WHITESPACE"," ",220],["T_FUNCTION","function",220],["T_WHITESPACE"," ",220],["T_STRING","renameFile",220],"(",["T_VARIABLE","$oldFilename",220],",",["T_WHITESPACE"," ",220],["T_VARIABLE","$oldPath",220],",",["T_WHITESPACE"," ",220],["T_VARIABLE","$newFilename",220],",",["T_WHITESPACE"," ",220],["T_VARIABLE","$newPath",220],")",["T_WHITESPACE","\n    ",220],"{",["T_WHITESPACE","\n        ",221],["T_VARIABLE","$adapter",222],["T_WHITESPACE","    ",222],"=",["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","_getWriteAdapter",222],"(",")",";",["T_WHITESPACE","\n        ",222],["T_VARIABLE","$dataUpdate",223],["T_WHITESPACE"," ",223],"=",["T_WHITESPACE"," ",223],["T_ARRAY","array",223],"(",["T_CONSTANT_ENCAPSED_STRING","'filename'",223],["T_WHITESPACE"," ",223],["T_DOUBLE_ARROW","=>",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$newFilename",223],",",["T_WHITESPACE"," ",223],["T_CONSTANT_ENCAPSED_STRING","'directory'",223],["T_WHITESPACE"," ",223],["T_DOUBLE_ARROW","=>",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$newPath",223],")",";",["T_WHITESPACE","\n\n        ",223],["T_VARIABLE","$dataWhere",225],["T_WHITESPACE","  ",225],"=",["T_WHITESPACE"," ",225],["T_ARRAY","array",225],"(",["T_CONSTANT_ENCAPSED_STRING","'filename = ?'",225],["T_WHITESPACE"," ",225],["T_DOUBLE_ARROW","=>",225],["T_WHITESPACE"," ",225],["T_VARIABLE","$oldFilename",225],")",";",["T_WHITESPACE","\n        ",225],["T_VARIABLE","$dataWhere",226],"[","]",["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_NEW","new",226],["T_WHITESPACE"," ",226],["T_STRING","Zend_Db_Expr",226],"(",["T_VARIABLE","$adapter",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","prepareSqlCondition",226],"(",["T_CONSTANT_ENCAPSED_STRING","'directory'",226],",",["T_WHITESPACE"," ",226],["T_ARRAY","array",226],"(",["T_CONSTANT_ENCAPSED_STRING","'seq'",226],["T_WHITESPACE"," ",226],["T_DOUBLE_ARROW","=>",226],["T_WHITESPACE"," ",226],["T_VARIABLE","$oldPath",226],")",")",")",";",["T_WHITESPACE","\n\n        ",226],["T_VARIABLE","$adapter",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","update",228],"(",["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getMainTable",228],"(",")",",",["T_WHITESPACE"," ",228],["T_VARIABLE","$dataUpdate",228],",",["T_WHITESPACE"," ",228],["T_VARIABLE","$dataWhere",228],")",";",["T_WHITESPACE","\n\n        ",228],["T_RETURN","return",230],["T_WHITESPACE"," ",230],["T_VARIABLE","$this",230],";",["T_WHITESPACE","\n    ",230],"}",["T_WHITESPACE","\n\n    ",231],["T_DOC_COMMENT","\/**\n     * Copy files in database\n     *\n     * @param  string $oldFilename\n     * @param  string $oldPath\n     * @param  string $newFilename\n     * @param  string $newPath\n     * @return Mage_Core_Model_Mysql4_File_Storage_Database\n     *\/",233],["T_WHITESPACE","\n    ",241],["T_PUBLIC","public",242],["T_WHITESPACE"," ",242],["T_FUNCTION","function",242],["T_WHITESPACE"," ",242],["T_STRING","copyFile",242],"(",["T_VARIABLE","$oldFilename",242],",",["T_WHITESPACE"," ",242],["T_VARIABLE","$oldPath",242],",",["T_WHITESPACE"," ",242],["T_VARIABLE","$newFilename",242],",",["T_WHITESPACE"," ",242],["T_VARIABLE","$newPath",242],")",["T_WHITESPACE","\n    ",242],"{",["T_WHITESPACE","\n        ",243],["T_VARIABLE","$adapter",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","_getReadAdapter",244],"(",")",";",["T_WHITESPACE","\n\n        ",244],["T_VARIABLE","$select",246],["T_WHITESPACE"," ",246],"=",["T_WHITESPACE"," ",246],["T_VARIABLE","$adapter",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","select",246],"(",")",["T_WHITESPACE","\n            ",246],["T_OBJECT_OPERATOR","->",247],["T_STRING","from",247],"(",["T_ARRAY","array",247],"(",["T_CONSTANT_ENCAPSED_STRING","'e'",247],["T_WHITESPACE"," ",247],["T_DOUBLE_ARROW","=>",247],["T_WHITESPACE"," ",247],["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","getMainTable",247],"(",")",")",")",["T_WHITESPACE","\n            ",247],["T_OBJECT_OPERATOR","->",248],["T_STRING","where",248],"(",["T_CONSTANT_ENCAPSED_STRING","'filename = ?'",248],",",["T_WHITESPACE"," ",248],["T_VARIABLE","$oldFilename",248],")",["T_WHITESPACE","\n            ",248],["T_OBJECT_OPERATOR","->",249],["T_STRING","where",249],"(",["T_VARIABLE","$adapter",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","prepareSqlCondition",249],"(",["T_CONSTANT_ENCAPSED_STRING","'directory'",249],",",["T_WHITESPACE"," ",249],["T_ARRAY","array",249],"(",["T_CONSTANT_ENCAPSED_STRING","'seq'",249],["T_WHITESPACE"," ",249],["T_DOUBLE_ARROW","=>",249],["T_WHITESPACE"," ",249],["T_VARIABLE","$oldPath",249],")",")",")",";",["T_WHITESPACE","\n\n        ",249],["T_VARIABLE","$data",251],["T_WHITESPACE"," ",251],"=",["T_WHITESPACE"," ",251],["T_VARIABLE","$adapter",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","fetchRow",251],"(",["T_VARIABLE","$select",251],")",";",["T_WHITESPACE","\n        ",251],["T_IF","if",252],["T_WHITESPACE"," ",252],"(","!",["T_VARIABLE","$data",252],")",["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n            ",252],["T_RETURN","return",253],["T_WHITESPACE"," ",253],["T_VARIABLE","$this",253],";",["T_WHITESPACE","\n        ",253],"}",["T_WHITESPACE","\n\n        ",254],["T_IF","if",256],["T_WHITESPACE"," ",256],"(",["T_ISSET","isset",256],"(",["T_VARIABLE","$data",256],"[",["T_CONSTANT_ENCAPSED_STRING","'file_id'",256],"]",")",["T_WHITESPACE"," ",256],["T_BOOLEAN_AND","&&",256],["T_WHITESPACE"," ",256],["T_ISSET","isset",256],"(",["T_VARIABLE","$data",256],"[",["T_CONSTANT_ENCAPSED_STRING","'filename'",256],"]",")",")",["T_WHITESPACE"," ",256],"{",["T_WHITESPACE","\n            ",256],["T_UNSET","unset",257],"(",["T_VARIABLE","$data",257],"[",["T_CONSTANT_ENCAPSED_STRING","'file_id'",257],"]",")",";",["T_WHITESPACE","\n            ",257],["T_VARIABLE","$data",258],"[",["T_CONSTANT_ENCAPSED_STRING","'filename'",258],"]",["T_WHITESPACE"," ",258],"=",["T_WHITESPACE"," ",258],["T_VARIABLE","$newFilename",258],";",["T_WHITESPACE","\n            ",258],["T_VARIABLE","$data",259],"[",["T_CONSTANT_ENCAPSED_STRING","'directory'",259],"]",["T_WHITESPACE"," ",259],"=",["T_WHITESPACE"," ",259],["T_VARIABLE","$newPath",259],";",["T_WHITESPACE","\n\n            ",259],["T_VARIABLE","$writeAdapter",261],["T_WHITESPACE"," ",261],"=",["T_WHITESPACE"," ",261],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","_getWriteAdapter",261],"(",")",";",["T_WHITESPACE","\n            ",261],["T_VARIABLE","$writeAdapter",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","insertOnDuplicate",262],"(",["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","getMainTable",262],"(",")",",",["T_WHITESPACE"," ",262],["T_VARIABLE","$data",262],",",["T_WHITESPACE"," ",262],["T_ARRAY","array",262],"(",["T_CONSTANT_ENCAPSED_STRING","'content'",262],",",["T_WHITESPACE"," ",262],["T_CONSTANT_ENCAPSED_STRING","'upload_time'",262],")",")",";",["T_WHITESPACE","\n        ",262],"}",["T_WHITESPACE","\n\n        ",263],["T_RETURN","return",265],["T_WHITESPACE"," ",265],["T_VARIABLE","$this",265],";",["T_WHITESPACE","\n    ",265],"}",["T_WHITESPACE","\n\n    ",266],["T_DOC_COMMENT","\/**\n     * Check whether file exists in DB\n     *\n     * @param string $filename\n     * @param string $path\n     * @return bool\n     *\/",268],["T_WHITESPACE","\n    ",274],["T_PUBLIC","public",275],["T_WHITESPACE"," ",275],["T_FUNCTION","function",275],["T_WHITESPACE"," ",275],["T_STRING","fileExists",275],"(",["T_VARIABLE","$filename",275],",",["T_WHITESPACE"," ",275],["T_VARIABLE","$path",275],")",["T_WHITESPACE","\n    ",275],"{",["T_WHITESPACE","\n        ",276],["T_VARIABLE","$adapter",277],["T_WHITESPACE"," ",277],"=",["T_WHITESPACE"," ",277],["T_VARIABLE","$this",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","_getReadAdapter",277],"(",")",";",["T_WHITESPACE","\n\n        ",277],["T_VARIABLE","$select",279],["T_WHITESPACE"," ",279],"=",["T_WHITESPACE"," ",279],["T_VARIABLE","$adapter",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","select",279],"(",")",["T_WHITESPACE","\n            ",279],["T_OBJECT_OPERATOR","->",280],["T_STRING","from",280],"(",["T_ARRAY","array",280],"(",["T_CONSTANT_ENCAPSED_STRING","'e'",280],["T_WHITESPACE"," ",280],["T_DOUBLE_ARROW","=>",280],["T_WHITESPACE"," ",280],["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","getMainTable",280],"(",")",")",")",["T_WHITESPACE","\n            ",280],["T_OBJECT_OPERATOR","->",281],["T_STRING","where",281],"(",["T_CONSTANT_ENCAPSED_STRING","'filename = ?'",281],",",["T_WHITESPACE"," ",281],["T_VARIABLE","$filename",281],")",["T_WHITESPACE","\n            ",281],["T_OBJECT_OPERATOR","->",282],["T_STRING","where",282],"(",["T_VARIABLE","$adapter",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","prepareSqlCondition",282],"(",["T_CONSTANT_ENCAPSED_STRING","'directory'",282],",",["T_WHITESPACE"," ",282],["T_ARRAY","array",282],"(",["T_CONSTANT_ENCAPSED_STRING","'seq'",282],["T_WHITESPACE"," ",282],["T_DOUBLE_ARROW","=>",282],["T_WHITESPACE"," ",282],["T_VARIABLE","$path",282],")",")",")",["T_WHITESPACE","\n            ",282],["T_OBJECT_OPERATOR","->",283],["T_STRING","limit",283],"(",["T_LNUMBER","1",283],")",";",["T_WHITESPACE","\n\n        ",283],["T_VARIABLE","$data",285],["T_WHITESPACE"," ",285],"=",["T_WHITESPACE"," ",285],["T_VARIABLE","$adapter",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","fetchRow",285],"(",["T_VARIABLE","$select",285],")",";",["T_WHITESPACE","\n        ",285],["T_RETURN","return",286],["T_WHITESPACE"," ",286],["T_BOOL_CAST","(bool)",286],["T_VARIABLE","$data",286],";",["T_WHITESPACE","\n    ",286],"}",["T_WHITESPACE","\n\n    ",287],["T_DOC_COMMENT","\/**\n     * Delete files that starts with given $folderName\n     *\n     * @param string $folderName\n     *\/",289],["T_WHITESPACE","\n    ",293],["T_PUBLIC","public",294],["T_WHITESPACE"," ",294],["T_FUNCTION","function",294],["T_WHITESPACE"," ",294],["T_STRING","deleteFolder",294],"(",["T_VARIABLE","$folderName",294],["T_WHITESPACE"," ",294],"=",["T_WHITESPACE"," ",294],["T_CONSTANT_ENCAPSED_STRING","''",294],")",["T_WHITESPACE","\n    ",294],"{",["T_WHITESPACE","\n        ",295],["T_VARIABLE","$folderName",296],["T_WHITESPACE"," ",296],"=",["T_WHITESPACE"," ",296],["T_STRING","rtrim",296],"(",["T_VARIABLE","$folderName",296],",",["T_WHITESPACE"," ",296],["T_CONSTANT_ENCAPSED_STRING","'\/'",296],")",";",["T_WHITESPACE","\n        ",296],["T_IF","if",297],["T_WHITESPACE"," ",297],"(","!",["T_STRING","strlen",297],"(",["T_VARIABLE","$folderName",297],")",")",["T_WHITESPACE"," ",297],"{",["T_WHITESPACE","\n            ",297],["T_RETURN","return",298],";",["T_WHITESPACE","\n        ",298],"}",["T_WHITESPACE","\n\n        ",299],["T_COMMENT","\/* @var $resHelper Mage_Core_Model_Resource_Helper_Abstract *\/",301],["T_WHITESPACE","\n        ",301],["T_VARIABLE","$resHelper",302],["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],["T_STRING","Mage",302],["T_DOUBLE_COLON","::",302],["T_STRING","getResourceHelper",302],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",302],")",";",["T_WHITESPACE","\n        ",302],["T_VARIABLE","$likeExpression",303],["T_WHITESPACE"," ",303],"=",["T_WHITESPACE"," ",303],["T_VARIABLE","$resHelper",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","addLikeEscape",303],"(",["T_VARIABLE","$folderName",303],["T_WHITESPACE"," ",303],".",["T_WHITESPACE"," ",303],["T_CONSTANT_ENCAPSED_STRING","'\/'",303],",",["T_WHITESPACE"," ",303],["T_ARRAY","array",303],"(",["T_CONSTANT_ENCAPSED_STRING","'position'",303],["T_WHITESPACE"," ",303],["T_DOUBLE_ARROW","=>",303],["T_WHITESPACE"," ",303],["T_CONSTANT_ENCAPSED_STRING","'start'",303],")",")",";",["T_WHITESPACE","\n        ",303],["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","_getWriteAdapter",304],"(",")",["T_WHITESPACE","\n            ",304],["T_OBJECT_OPERATOR","->",305],["T_STRING","delete",305],"(",["T_VARIABLE","$this",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","getMainTable",305],"(",")",",",["T_WHITESPACE"," ",305],["T_NEW","new",305],["T_WHITESPACE"," ",305],["T_STRING","Zend_Db_Expr",305],"(",["T_CONSTANT_ENCAPSED_STRING","'directory LIKE '",305],["T_WHITESPACE"," ",305],".",["T_WHITESPACE"," ",305],["T_VARIABLE","$likeExpression",305],")",")",";",["T_WHITESPACE","\n    ",305],"}",["T_WHITESPACE","\n\n    ",306],["T_DOC_COMMENT","\/**\n     * Delete file\n     *\n     * @param string $filename\n     * @param string $directory\n     *\/",308],["T_WHITESPACE","\n    ",313],["T_PUBLIC","public",314],["T_WHITESPACE"," ",314],["T_FUNCTION","function",314],["T_WHITESPACE"," ",314],["T_STRING","deleteFile",314],"(",["T_VARIABLE","$filename",314],",",["T_WHITESPACE"," ",314],["T_VARIABLE","$directory",314],")",["T_WHITESPACE","\n    ",314],"{",["T_WHITESPACE","\n        ",315],["T_VARIABLE","$adapter",316],["T_WHITESPACE"," ",316],"=",["T_WHITESPACE"," ",316],["T_VARIABLE","$this",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","_getWriteAdapter",316],"(",")",";",["T_WHITESPACE","\n\n        ",316],["T_VARIABLE","$where",318],["T_WHITESPACE"," ",318],"=",["T_WHITESPACE"," ",318],["T_ARRAY","array",318],"(",["T_CONSTANT_ENCAPSED_STRING","'filename = ?'",318],["T_WHITESPACE"," ",318],["T_DOUBLE_ARROW","=>",318],["T_WHITESPACE"," ",318],["T_VARIABLE","$filename",318],")",";",["T_WHITESPACE","\n        ",318],["T_VARIABLE","$where",319],"[","]",["T_WHITESPACE"," ",319],"=",["T_WHITESPACE"," ",319],["T_NEW","new",319],["T_WHITESPACE"," ",319],["T_STRING","Zend_Db_Expr",319],"(",["T_VARIABLE","$adapter",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","prepareSqlCondition",319],"(",["T_CONSTANT_ENCAPSED_STRING","'directory'",319],",",["T_WHITESPACE"," ",319],["T_ARRAY","array",319],"(",["T_CONSTANT_ENCAPSED_STRING","'seq'",319],["T_WHITESPACE"," ",319],["T_DOUBLE_ARROW","=>",319],["T_WHITESPACE"," ",319],["T_VARIABLE","$directory",319],")",")",")",";",["T_WHITESPACE","\n\n        ",319],["T_VARIABLE","$adapter",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","delete",321],"(",["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","getMainTable",321],"(",")",",",["T_WHITESPACE"," ",321],["T_VARIABLE","$where",321],")",";",["T_WHITESPACE","\n    ",321],"}",["T_WHITESPACE","\n\n    ",322],["T_DOC_COMMENT","\/**\n     * Return directory file listing\n     *\n     * @param string $directory\n     * @return mixed\n     *\/",324],["T_WHITESPACE","\n    ",329],["T_PUBLIC","public",330],["T_WHITESPACE"," ",330],["T_FUNCTION","function",330],["T_WHITESPACE"," ",330],["T_STRING","getDirectoryFiles",330],"(",["T_VARIABLE","$directory",330],")",["T_WHITESPACE","\n    ",330],"{",["T_WHITESPACE","\n        ",331],["T_VARIABLE","$directory",332],["T_WHITESPACE"," ",332],"=",["T_WHITESPACE"," ",332],["T_STRING","trim",332],"(",["T_VARIABLE","$directory",332],",",["T_WHITESPACE"," ",332],["T_CONSTANT_ENCAPSED_STRING","'\/'",332],")",";",["T_WHITESPACE","\n        ",332],["T_VARIABLE","$adapter",333],["T_WHITESPACE"," ",333],"=",["T_WHITESPACE"," ",333],["T_VARIABLE","$this",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","_getReadAdapter",333],"(",")",";",["T_WHITESPACE","\n\n        ",333],["T_VARIABLE","$select",335],["T_WHITESPACE"," ",335],"=",["T_WHITESPACE"," ",335],["T_VARIABLE","$adapter",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","select",335],"(",")",["T_WHITESPACE","\n            ",335],["T_OBJECT_OPERATOR","->",336],["T_STRING","from",336],"(",["T_WHITESPACE","\n                ",336],["T_ARRAY","array",337],"(",["T_CONSTANT_ENCAPSED_STRING","'e'",337],["T_WHITESPACE"," ",337],["T_DOUBLE_ARROW","=>",337],["T_WHITESPACE"," ",337],["T_VARIABLE","$this",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","getMainTable",337],"(",")",")",",",["T_WHITESPACE","\n                ",337],["T_ARRAY","array",338],"(",["T_WHITESPACE","\n                    ",338],["T_CONSTANT_ENCAPSED_STRING","'filename'",339],",",["T_WHITESPACE","\n                    ",339],["T_CONSTANT_ENCAPSED_STRING","'directory'",340],",",["T_WHITESPACE","\n                    ",340],["T_CONSTANT_ENCAPSED_STRING","'content'",341],["T_WHITESPACE","\n                ",341],")",["T_WHITESPACE","\n            ",342],")",["T_WHITESPACE","\n            ",343],["T_OBJECT_OPERATOR","->",344],["T_STRING","where",344],"(",["T_VARIABLE","$adapter",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","prepareSqlCondition",344],"(",["T_CONSTANT_ENCAPSED_STRING","'directory'",344],",",["T_WHITESPACE"," ",344],["T_ARRAY","array",344],"(",["T_CONSTANT_ENCAPSED_STRING","'seq'",344],["T_WHITESPACE"," ",344],["T_DOUBLE_ARROW","=>",344],["T_WHITESPACE"," ",344],["T_VARIABLE","$directory",344],")",")",")",["T_WHITESPACE","\n            ",344],["T_OBJECT_OPERATOR","->",345],["T_STRING","order",345],"(",["T_CONSTANT_ENCAPSED_STRING","'file_id'",345],")",";",["T_WHITESPACE","\n\n        ",345],["T_VARIABLE","$rows",347],["T_WHITESPACE"," ",347],"=",["T_WHITESPACE"," ",347],["T_VARIABLE","$adapter",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","fetchAll",347],"(",["T_VARIABLE","$select",347],")",";",["T_WHITESPACE","\n        ",347],["T_RETURN","return",348],["T_WHITESPACE"," ",348],["T_VARIABLE","$this",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","_decodeAllFilesContent",348],"(",["T_VARIABLE","$rows",348],")",";",["T_WHITESPACE","\n    ",348],"}",["T_WHITESPACE","\n",349],"}",["T_WHITESPACE","\n",350]]