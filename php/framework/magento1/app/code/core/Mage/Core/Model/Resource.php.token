[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Core\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Resources and connections registry and factory\n *\n *\/",28],["T_WHITESPACE","\n",31],["T_CLASS","class",32],["T_WHITESPACE"," ",32],["T_STRING","Mage_Core_Model_Resource",32],["T_WHITESPACE","\n",32],"{",["T_WHITESPACE","\n    ",33],["T_CONST","const",34],["T_WHITESPACE"," ",34],["T_STRING","AUTO_UPDATE_CACHE_KEY",34],["T_WHITESPACE","  ",34],"=",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","'DB_AUTOUPDATE'",34],";",["T_WHITESPACE","\n    ",34],["T_CONST","const",35],["T_WHITESPACE"," ",35],["T_STRING","AUTO_UPDATE_ONCE",35],["T_WHITESPACE","       ",35],"=",["T_WHITESPACE"," ",35],["T_LNUMBER","0",35],";",["T_WHITESPACE","\n    ",35],["T_CONST","const",36],["T_WHITESPACE"," ",36],["T_STRING","AUTO_UPDATE_NEVER",36],["T_WHITESPACE","      ",36],"=",["T_WHITESPACE"," ",36],"-",["T_LNUMBER","1",36],";",["T_WHITESPACE","\n    ",36],["T_CONST","const",37],["T_WHITESPACE"," ",37],["T_STRING","AUTO_UPDATE_ALWAYS",37],["T_WHITESPACE","     ",37],"=",["T_WHITESPACE"," ",37],["T_LNUMBER","1",37],";",["T_WHITESPACE","\n\n    ",37],["T_CONST","const",39],["T_WHITESPACE"," ",39],["T_STRING","DEFAULT_READ_RESOURCE",39],["T_WHITESPACE","  ",39],"=",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'core_read'",39],";",["T_WHITESPACE","\n    ",39],["T_CONST","const",40],["T_WHITESPACE"," ",40],["T_STRING","DEFAULT_WRITE_RESOURCE",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'core_write'",40],";",["T_WHITESPACE","\n    ",40],["T_CONST","const",41],["T_WHITESPACE"," ",41],["T_STRING","DEFAULT_SETUP_RESOURCE",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'core_setup'",41],";",["T_WHITESPACE","\n\n    ",41],["T_DOC_COMMENT","\/**\n     * Instances of classes for connection types\n     *\n     * @var array\n     *\/",43],["T_WHITESPACE","\n    ",47],["T_PROTECTED","protected",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$_connectionTypes",48],["T_WHITESPACE","    ",48],"=",["T_WHITESPACE"," ",48],["T_ARRAY","array",48],"(",")",";",["T_WHITESPACE","\n\n    ",48],["T_DOC_COMMENT","\/**\n     * Instances of actual connections\n     *\n     * @var array\n     *\/",50],["T_WHITESPACE","\n    ",54],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$_connections",55],["T_WHITESPACE","        ",55],"=",["T_WHITESPACE"," ",55],["T_ARRAY","array",55],"(",")",";",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * Names of actual connections that wait to set cache\n     *\n     * @var array\n     *\/",57],["T_WHITESPACE","\n    ",61],["T_PROTECTED","protected",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$_skippedConnections",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_ARRAY","array",62],"(",")",";",["T_WHITESPACE","\n\n    ",62],["T_DOC_COMMENT","\/**\n     * Registry of resource entities\n     *\n     * @var array\n     *\/",64],["T_WHITESPACE","\n    ",68],["T_PROTECTED","protected",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$_entities",69],["T_WHITESPACE","           ",69],"=",["T_WHITESPACE"," ",69],["T_ARRAY","array",69],"(",")",";",["T_WHITESPACE","\n\n    ",69],["T_DOC_COMMENT","\/**\n     * Mapped tables cache array\n     *\n     * @var array\n     *\/",71],["T_WHITESPACE","\n    ",75],["T_PROTECTED","protected",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$_mappedTableNames",76],";",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * Creates a connection to resource whenever needed\n     *\n     * @param string $name\n     * @return Varien_Db_Adapter_Interface\n     *\/",78],["T_WHITESPACE","\n    ",83],["T_PUBLIC","public",84],["T_WHITESPACE"," ",84],["T_FUNCTION","function",84],["T_WHITESPACE"," ",84],["T_STRING","getConnection",84],"(",["T_VARIABLE","$name",84],")",["T_WHITESPACE","\n    ",84],"{",["T_WHITESPACE","\n        ",85],["T_IF","if",86],["T_WHITESPACE"," ",86],"(",["T_ISSET","isset",86],"(",["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","_connections",86],"[",["T_VARIABLE","$name",86],"]",")",")",["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n            ",86],["T_VARIABLE","$connection",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","_connections",87],"[",["T_VARIABLE","$name",87],"]",";",["T_WHITESPACE","\n            ",87],["T_IF","if",88],["T_WHITESPACE"," ",88],"(",["T_ISSET","isset",88],"(",["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","_skippedConnections",88],"[",["T_VARIABLE","$name",88],"]",")",["T_WHITESPACE"," ",88],["T_BOOLEAN_AND","&&",88],["T_WHITESPACE"," ",88],"!",["T_STRING","Mage",88],["T_DOUBLE_COLON","::",88],["T_STRING","app",88],"(",")",["T_OBJECT_OPERATOR","->",88],["T_STRING","getIsCacheLocked",88],"(",")",")",["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n                ",88],["T_VARIABLE","$connection",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","setCacheAdapter",89],"(",["T_STRING","Mage",89],["T_DOUBLE_COLON","::",89],["T_STRING","app",89],"(",")",["T_OBJECT_OPERATOR","->",89],["T_STRING","getCache",89],"(",")",")",";",["T_WHITESPACE","\n                ",89],["T_UNSET","unset",90],"(",["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","_skippedConnections",90],"[",["T_VARIABLE","$name",90],"]",")",";",["T_WHITESPACE","\n            ",90],"}",["T_WHITESPACE","\n            ",91],["T_RETURN","return",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$connection",92],";",["T_WHITESPACE","\n        ",92],"}",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$connConfig",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_STRING","Mage",94],["T_DOUBLE_COLON","::",94],["T_STRING","getConfig",94],"(",")",["T_OBJECT_OPERATOR","->",94],["T_STRING","getResourceConnectionConfig",94],"(",["T_VARIABLE","$name",94],")",";",["T_WHITESPACE","\n\n        ",94],["T_IF","if",96],["T_WHITESPACE"," ",96],"(","!",["T_VARIABLE","$connConfig",96],")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n            ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","_connections",97],"[",["T_VARIABLE","$name",97],"]",["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","_getDefaultConnection",97],"(",["T_VARIABLE","$name",97],")",";",["T_WHITESPACE","\n            ",97],["T_RETURN","return",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","_connections",98],"[",["T_VARIABLE","$name",98],"]",";",["T_WHITESPACE","\n        ",98],"}",["T_WHITESPACE","\n        ",99],["T_IF","if",100],["T_WHITESPACE"," ",100],"(","!",["T_VARIABLE","$connConfig",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","is",100],"(",["T_CONSTANT_ENCAPSED_STRING","'active'",100],",",["T_WHITESPACE"," ",100],["T_LNUMBER","1",100],")",")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n            ",100],["T_RETURN","return",101],["T_WHITESPACE"," ",101],["T_STRING","false",101],";",["T_WHITESPACE","\n        ",101],"}",["T_WHITESPACE","\n\n        ",102],["T_VARIABLE","$origName",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$connConfig",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getParent",104],"(",")",["T_OBJECT_OPERATOR","->",104],["T_STRING","getName",104],"(",")",";",["T_WHITESPACE","\n        ",104],["T_IF","if",105],["T_WHITESPACE"," ",105],"(",["T_ISSET","isset",105],"(",["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","_connections",105],"[",["T_VARIABLE","$origName",105],"]",")",")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n            ",105],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","_connections",106],"[",["T_VARIABLE","$name",106],"]",["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","_connections",106],"[",["T_VARIABLE","$origName",106],"]",";",["T_WHITESPACE","\n            ",106],["T_RETURN","return",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","_connections",107],"[",["T_VARIABLE","$origName",107],"]",";",["T_WHITESPACE","\n        ",107],"}",["T_WHITESPACE","\n\n        ",108],["T_VARIABLE","$connection",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","_newConnection",110],"(",["T_STRING_CAST","(string)",110],["T_VARIABLE","$connConfig",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","type",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$connConfig",110],")",";",["T_WHITESPACE","\n        ",110],["T_IF","if",111],["T_WHITESPACE"," ",111],"(",["T_VARIABLE","$connection",111],")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n            ",111],["T_IF","if",112],["T_WHITESPACE"," ",112],"(",["T_STRING","Mage",112],["T_DOUBLE_COLON","::",112],["T_STRING","app",112],"(",")",["T_OBJECT_OPERATOR","->",112],["T_STRING","getIsCacheLocked",112],"(",")",")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n                ",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","_skippedConnections",113],"[",["T_VARIABLE","$name",113],"]",["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_STRING","true",113],";",["T_WHITESPACE","\n            ",113],"}",["T_WHITESPACE"," ",114],["T_ELSE","else",114],["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n                ",114],["T_VARIABLE","$connection",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","setCacheAdapter",115],"(",["T_STRING","Mage",115],["T_DOUBLE_COLON","::",115],["T_STRING","app",115],"(",")",["T_OBJECT_OPERATOR","->",115],["T_STRING","getCache",115],"(",")",")",";",["T_WHITESPACE","\n            ",115],"}",["T_WHITESPACE","\n        ",116],"}",["T_WHITESPACE","\n\n        ",117],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_connections",119],"[",["T_VARIABLE","$name",119],"]",["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$connection",119],";",["T_WHITESPACE","\n        ",119],["T_IF","if",120],["T_WHITESPACE"," ",120],"(",["T_VARIABLE","$origName",120],["T_WHITESPACE"," ",120],["T_IS_NOT_IDENTICAL","!==",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$name",120],")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n            ",120],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","_connections",121],"[",["T_VARIABLE","$origName",121],"]",["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_VARIABLE","$connection",121],";",["T_WHITESPACE","\n        ",121],"}",["T_WHITESPACE","\n\n        ",122],["T_RETURN","return",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$connection",124],";",["T_WHITESPACE","\n    ",124],"}",["T_WHITESPACE","\n\n    ",125],["T_DOC_COMMENT","\/**\n     * Get Instances of actual connections\n     *\n     * @return array\n     *\/",127],["T_WHITESPACE","\n    ",131],["T_PUBLIC","public",132],["T_WHITESPACE"," ",132],["T_FUNCTION","function",132],["T_WHITESPACE"," ",132],["T_STRING","getConnections",132],"(",")",["T_WHITESPACE","\n    ",132],"{",["T_WHITESPACE","\n        ",133],["T_RETURN","return",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","_connections",134],";",["T_WHITESPACE","\n    ",134],"}",["T_WHITESPACE","\n\n    ",135],["T_DOC_COMMENT","\/**\n     * Retrieve connection adapter class name by connection type\n     *\n     * @param string $type  the connection type\n     * @return string|false\n     *\/",137],["T_WHITESPACE","\n    ",142],["T_PROTECTED","protected",143],["T_WHITESPACE"," ",143],["T_FUNCTION","function",143],["T_WHITESPACE"," ",143],["T_STRING","_getConnectionAdapterClassName",143],"(",["T_VARIABLE","$type",143],")",["T_WHITESPACE","\n    ",143],"{",["T_WHITESPACE","\n        ",144],["T_VARIABLE","$config",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_STRING","Mage",145],["T_DOUBLE_COLON","::",145],["T_STRING","getConfig",145],"(",")",["T_OBJECT_OPERATOR","->",145],["T_STRING","getResourceTypeConfig",145],"(",["T_VARIABLE","$type",145],")",";",["T_WHITESPACE","\n        ",145],["T_IF","if",146],["T_WHITESPACE"," ",146],"(","!",["T_EMPTY","empty",146],"(",["T_VARIABLE","$config",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","adapter",146],")",")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n            ",146],["T_RETURN","return",147],["T_WHITESPACE"," ",147],["T_STRING_CAST","(string)",147],["T_VARIABLE","$config",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","adapter",147],";",["T_WHITESPACE","\n        ",147],"}",["T_WHITESPACE","\n        ",148],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_STRING","false",149],";",["T_WHITESPACE","\n    ",149],"}",["T_WHITESPACE","\n\n    ",150],["T_DOC_COMMENT","\/**\n     * Create new connection adapter instance by connection type and config\n     *\n     * @param string $type the connection type\n     * @param Mage_Core_Model_Config_Element|array $config the connection configuration\n     * @return Varien_Db_Adapter_Interface|false\n     *\/",152],["T_WHITESPACE","\n    ",158],["T_PROTECTED","protected",159],["T_WHITESPACE"," ",159],["T_FUNCTION","function",159],["T_WHITESPACE"," ",159],["T_STRING","_newConnection",159],"(",["T_VARIABLE","$type",159],",",["T_WHITESPACE"," ",159],["T_VARIABLE","$config",159],")",["T_WHITESPACE","\n    ",159],"{",["T_WHITESPACE","\n        ",160],["T_IF","if",161],["T_WHITESPACE"," ",161],"(",["T_VARIABLE","$config",161],["T_WHITESPACE"," ",161],["T_INSTANCEOF","instanceof",161],["T_WHITESPACE"," ",161],["T_STRING","Mage_Core_Model_Config_Element",161],")",["T_WHITESPACE"," ",161],"{",["T_WHITESPACE","\n            ",161],["T_VARIABLE","$config",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_VARIABLE","$config",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","asArray",162],"(",")",";",["T_WHITESPACE","\n        ",162],"}",["T_WHITESPACE","\n        ",163],["T_IF","if",164],["T_WHITESPACE"," ",164],"(","!",["T_STRING","is_array",164],"(",["T_VARIABLE","$config",164],")",")",["T_WHITESPACE"," ",164],"{",["T_WHITESPACE","\n            ",164],["T_RETURN","return",165],["T_WHITESPACE"," ",165],["T_STRING","false",165],";",["T_WHITESPACE","\n        ",165],"}",["T_WHITESPACE","\n\n        ",166],["T_VARIABLE","$connection",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_STRING","false",168],";",["T_WHITESPACE","\n        ",168],["T_COMMENT","\/\/ try to get adapter and create connection\n",169],["T_WHITESPACE","        ",170],["T_VARIABLE","$className",170],["T_WHITESPACE","  ",170],"=",["T_WHITESPACE"," ",170],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","_getConnectionAdapterClassName",170],"(",["T_VARIABLE","$type",170],")",";",["T_WHITESPACE","\n        ",170],["T_IF","if",171],["T_WHITESPACE"," ",171],"(",["T_VARIABLE","$className",171],")",["T_WHITESPACE"," ",171],"{",["T_WHITESPACE","\n            ",171],["T_COMMENT","\/\/ define profiler settings\n",172],["T_WHITESPACE","            ",173],["T_VARIABLE","$config",173],"[",["T_CONSTANT_ENCAPSED_STRING","'profiler'",173],"]",["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_ISSET","isset",173],"(",["T_VARIABLE","$config",173],"[",["T_CONSTANT_ENCAPSED_STRING","'profiler'",173],"]",")",["T_WHITESPACE"," ",173],["T_BOOLEAN_AND","&&",173],["T_WHITESPACE"," ",173],["T_VARIABLE","$config",173],"[",["T_CONSTANT_ENCAPSED_STRING","'profiler'",173],"]",["T_WHITESPACE"," ",173],["T_IS_NOT_EQUAL","!=",173],["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","'false'",173],";",["T_WHITESPACE","\n\n            ",173],["T_VARIABLE","$connection",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_NEW","new",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$className",175],"(",["T_VARIABLE","$config",175],")",";",["T_WHITESPACE","\n            ",175],["T_IF","if",176],["T_WHITESPACE"," ",176],"(",["T_VARIABLE","$connection",176],["T_WHITESPACE"," ",176],["T_INSTANCEOF","instanceof",176],["T_WHITESPACE"," ",176],["T_STRING","Varien_Db_Adapter_Interface",176],")",["T_WHITESPACE"," ",176],"{",["T_WHITESPACE","\n                ",176],["T_COMMENT","\/\/ run after initialization statements\n",177],["T_WHITESPACE","                ",178],["T_IF","if",178],["T_WHITESPACE"," ",178],"(","!",["T_EMPTY","empty",178],"(",["T_VARIABLE","$config",178],"[",["T_CONSTANT_ENCAPSED_STRING","'initStatements'",178],"]",")",")",["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n                    ",178],["T_VARIABLE","$connection",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","query",179],"(",["T_VARIABLE","$config",179],"[",["T_CONSTANT_ENCAPSED_STRING","'initStatements'",179],"]",")",";",["T_WHITESPACE","\n                ",179],"}",["T_WHITESPACE","\n            ",180],"}",["T_WHITESPACE"," ",181],["T_ELSE","else",181],["T_WHITESPACE"," ",181],"{",["T_WHITESPACE","\n                ",181],["T_VARIABLE","$connection",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_STRING","false",182],";",["T_WHITESPACE","\n            ",182],"}",["T_WHITESPACE","\n        ",183],"}",["T_WHITESPACE","\n\n        ",184],["T_COMMENT","\/\/ try to get connection from type\n",186],["T_WHITESPACE","        ",187],["T_IF","if",187],["T_WHITESPACE"," ",187],"(","!",["T_VARIABLE","$connection",187],")",["T_WHITESPACE"," ",187],"{",["T_WHITESPACE","\n            ",187],["T_VARIABLE","$typeInstance",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getConnectionTypeInstance",188],"(",["T_VARIABLE","$type",188],")",";",["T_WHITESPACE","\n            ",188],["T_VARIABLE","$connection",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_VARIABLE","$typeInstance",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getConnection",189],"(",["T_VARIABLE","$config",189],")",";",["T_WHITESPACE","\n            ",189],["T_IF","if",190],["T_WHITESPACE"," ",190],"(","!",["T_VARIABLE","$connection",190],["T_WHITESPACE"," ",190],["T_INSTANCEOF","instanceof",190],["T_WHITESPACE"," ",190],["T_STRING","Varien_Db_Adapter_Interface",190],")",["T_WHITESPACE"," ",190],"{",["T_WHITESPACE","\n                ",190],["T_VARIABLE","$connection",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_STRING","false",191],";",["T_WHITESPACE","\n            ",191],"}",["T_WHITESPACE","\n        ",192],"}",["T_WHITESPACE","\n\n        ",193],["T_RETURN","return",195],["T_WHITESPACE"," ",195],["T_VARIABLE","$connection",195],";",["T_WHITESPACE","\n    ",195],"}",["T_WHITESPACE","\n\n    ",196],["T_DOC_COMMENT","\/**\n     * Retrieve default connection name by required connection name\n     *\n     * @param string $requiredConnectionName\n     * @return string\n     *\/",198],["T_WHITESPACE","\n    ",203],["T_PROTECTED","protected",204],["T_WHITESPACE"," ",204],["T_FUNCTION","function",204],["T_WHITESPACE"," ",204],["T_STRING","_getDefaultConnection",204],"(",["T_VARIABLE","$requiredConnectionName",204],")",["T_WHITESPACE","\n    ",204],"{",["T_WHITESPACE","\n        ",205],["T_IF","if",206],["T_WHITESPACE"," ",206],"(",["T_STRING","strpos",206],"(",["T_VARIABLE","$requiredConnectionName",206],",",["T_WHITESPACE"," ",206],["T_CONSTANT_ENCAPSED_STRING","'read'",206],")",["T_WHITESPACE"," ",206],["T_IS_NOT_IDENTICAL","!==",206],["T_WHITESPACE"," ",206],["T_STRING","false",206],")",["T_WHITESPACE"," ",206],"{",["T_WHITESPACE","\n            ",206],["T_RETURN","return",207],["T_WHITESPACE"," ",207],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","getConnection",207],"(",["T_STRING","self",207],["T_DOUBLE_COLON","::",207],["T_STRING","DEFAULT_READ_RESOURCE",207],")",";",["T_WHITESPACE","\n        ",207],"}",["T_WHITESPACE","\n        ",208],["T_RETURN","return",209],["T_WHITESPACE"," ",209],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","getConnection",209],"(",["T_STRING","self",209],["T_DOUBLE_COLON","::",209],["T_STRING","DEFAULT_WRITE_RESOURCE",209],")",";",["T_WHITESPACE","\n    ",209],"}",["T_WHITESPACE","\n\n    ",210],["T_DOC_COMMENT","\/**\n     * Get connection type instance\n     *\n     * Creates new if doesn't exist\n     *\n     * @param string $type\n     * @return Mage_Core_Model_Resource_Type_Abstract\n     *\/",212],["T_WHITESPACE","\n    ",219],["T_PUBLIC","public",220],["T_WHITESPACE"," ",220],["T_FUNCTION","function",220],["T_WHITESPACE"," ",220],["T_STRING","getConnectionTypeInstance",220],"(",["T_VARIABLE","$type",220],")",["T_WHITESPACE","\n    ",220],"{",["T_WHITESPACE","\n        ",221],["T_IF","if",222],["T_WHITESPACE"," ",222],"(","!",["T_ISSET","isset",222],"(",["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","_connectionTypes",222],"[",["T_VARIABLE","$type",222],"]",")",")",["T_WHITESPACE"," ",222],"{",["T_WHITESPACE","\n            ",222],["T_VARIABLE","$config",223],["T_WHITESPACE"," ",223],"=",["T_WHITESPACE"," ",223],["T_STRING","Mage",223],["T_DOUBLE_COLON","::",223],["T_STRING","getConfig",223],"(",")",["T_OBJECT_OPERATOR","->",223],["T_STRING","getResourceTypeConfig",223],"(",["T_VARIABLE","$type",223],")",";",["T_WHITESPACE","\n            ",223],["T_VARIABLE","$typeClass",224],["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],["T_VARIABLE","$config",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","getClassName",224],"(",")",";",["T_WHITESPACE","\n            ",224],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","_connectionTypes",225],"[",["T_VARIABLE","$type",225],"]",["T_WHITESPACE"," ",225],"=",["T_WHITESPACE"," ",225],["T_NEW","new",225],["T_WHITESPACE"," ",225],["T_VARIABLE","$typeClass",225],"(",")",";",["T_WHITESPACE","\n        ",225],"}",["T_WHITESPACE","\n        ",226],["T_RETURN","return",227],["T_WHITESPACE"," ",227],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","_connectionTypes",227],"[",["T_VARIABLE","$type",227],"]",";",["T_WHITESPACE","\n    ",227],"}",["T_WHITESPACE","\n\n    ",228],["T_DOC_COMMENT","\/**\n     * Get resource entity\n     *\n     * @param string $model\n     * @param string $entity\n     * @return Varien_Simplexml_Config\n     *\/",230],["T_WHITESPACE","\n    ",236],["T_PUBLIC","public",237],["T_WHITESPACE"," ",237],["T_FUNCTION","function",237],["T_WHITESPACE"," ",237],["T_STRING","getEntity",237],"(",["T_VARIABLE","$model",237],",",["T_WHITESPACE"," ",237],["T_VARIABLE","$entity",237],")",["T_WHITESPACE","\n    ",237],"{",["T_WHITESPACE","\n        ",238],["T_VARIABLE","$modelsNode",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_STRING","Mage",239],["T_DOUBLE_COLON","::",239],["T_STRING","getConfig",239],"(",")",["T_OBJECT_OPERATOR","->",239],["T_STRING","getNode",239],"(",")",["T_OBJECT_OPERATOR","->",239],["T_STRING","global",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","models",239],";",["T_WHITESPACE","\n        ",239],["T_VARIABLE","$entityConfig",240],["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],["T_VARIABLE","$modelsNode",240],["T_OBJECT_OPERATOR","->",240],["T_VARIABLE","$model",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","entities",240],["T_OBJECT_OPERATOR","->",240],"{",["T_VARIABLE","$entity",240],"}",";",["T_WHITESPACE","\n\n        ",240],["T_DOC_COMMENT","\/**\n         * Backwards compatibility for pre-MMDB extensions.\n         * In MMDB release resource nodes <..._mysql4> were renamed to <..._resource>. So <deprecatedNode> is left\n         * to keep name of previously used nodes, that still may be used by non-updated extensions.\n         *\/",242],["T_WHITESPACE","\n        ",246],["T_IF","if",247],["T_WHITESPACE"," ",247],"(",["T_ISSET","isset",247],"(",["T_VARIABLE","$modelsNode",247],["T_OBJECT_OPERATOR","->",247],["T_VARIABLE","$model",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","deprecatedNode",247],")",")",["T_WHITESPACE"," ",247],"{",["T_WHITESPACE","\n            ",247],["T_VARIABLE","$deprecatedNode",248],["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_VARIABLE","$modelsNode",248],["T_OBJECT_OPERATOR","->",248],["T_VARIABLE","$model",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","deprecatedNode",248],";",["T_WHITESPACE","\n            ",248],["T_IF","if",249],["T_WHITESPACE"," ",249],"(",["T_ISSET","isset",249],"(",["T_VARIABLE","$modelsNode",249],["T_OBJECT_OPERATOR","->",249],["T_VARIABLE","$deprecatedNode",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","entities",249],["T_OBJECT_OPERATOR","->",249],["T_VARIABLE","$entity",249],")",")",["T_WHITESPACE"," ",249],"{",["T_WHITESPACE","\n                ",249],["T_VARIABLE","$entityConfig",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_VARIABLE","$modelsNode",250],["T_OBJECT_OPERATOR","->",250],["T_VARIABLE","$deprecatedNode",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","entities",250],["T_OBJECT_OPERATOR","->",250],["T_VARIABLE","$entity",250],";",["T_WHITESPACE","\n            ",250],"}",["T_WHITESPACE","\n        ",251],"}",["T_WHITESPACE","\n\n        ",252],["T_RETURN","return",254],["T_WHITESPACE"," ",254],["T_VARIABLE","$entityConfig",254],";",["T_WHITESPACE","\n    ",254],"}",["T_WHITESPACE","\n\n    ",255],["T_DOC_COMMENT","\/**\n     * Get resource table name, validated by db adapter\n     *\n     * @param   string|array $modelEntity\n     * @return  string\n     *\/",257],["T_WHITESPACE","\n    ",262],["T_PUBLIC","public",263],["T_WHITESPACE"," ",263],["T_FUNCTION","function",263],["T_WHITESPACE"," ",263],["T_STRING","getTableName",263],"(",["T_VARIABLE","$modelEntity",263],")",["T_WHITESPACE","\n    ",263],"{",["T_WHITESPACE","\n        ",264],["T_VARIABLE","$tableSuffix",265],["T_WHITESPACE"," ",265],"=",["T_WHITESPACE"," ",265],["T_STRING","null",265],";",["T_WHITESPACE","\n        ",265],["T_IF","if",266],["T_WHITESPACE"," ",266],"(",["T_STRING","is_array",266],"(",["T_VARIABLE","$modelEntity",266],")",")",["T_WHITESPACE"," ",266],"{",["T_WHITESPACE","\n            ",266],["T_LIST","list",267],"(",["T_VARIABLE","$modelEntity",267],",",["T_WHITESPACE"," ",267],["T_VARIABLE","$tableSuffix",267],")",["T_WHITESPACE"," ",267],"=",["T_WHITESPACE"," ",267],["T_VARIABLE","$modelEntity",267],";",["T_WHITESPACE","\n        ",267],"}",["T_WHITESPACE","\n\n        ",268],["T_VARIABLE","$parts",270],["T_WHITESPACE"," ",270],"=",["T_WHITESPACE"," ",270],["T_STRING","explode",270],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",270],",",["T_WHITESPACE"," ",270],["T_VARIABLE","$modelEntity",270],")",";",["T_WHITESPACE","\n        ",270],["T_IF","if",271],["T_WHITESPACE"," ",271],"(",["T_ISSET","isset",271],"(",["T_VARIABLE","$parts",271],"[",["T_LNUMBER","1",271],"]",")",")",["T_WHITESPACE"," ",271],"{",["T_WHITESPACE","\n            ",271],["T_LIST","list",272],"(",["T_VARIABLE","$model",272],",",["T_WHITESPACE"," ",272],["T_VARIABLE","$entity",272],")",["T_WHITESPACE"," ",272],"=",["T_WHITESPACE"," ",272],["T_VARIABLE","$parts",272],";",["T_WHITESPACE","\n            ",272],["T_VARIABLE","$entityConfig",273],["T_WHITESPACE"," ",273],"=",["T_WHITESPACE"," ",273],["T_STRING","false",273],";",["T_WHITESPACE","\n            ",273],["T_IF","if",274],["T_WHITESPACE"," ",274],"(","!",["T_EMPTY","empty",274],"(",["T_STRING","Mage",274],["T_DOUBLE_COLON","::",274],["T_STRING","getConfig",274],"(",")",["T_OBJECT_OPERATOR","->",274],["T_STRING","getNode",274],"(",")",["T_OBJECT_OPERATOR","->",274],["T_STRING","global",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","models",274],["T_OBJECT_OPERATOR","->",274],"{",["T_VARIABLE","$model",274],"}",["T_OBJECT_OPERATOR","->",274],["T_STRING","resourceModel",274],")",")",["T_WHITESPACE"," ",274],"{",["T_WHITESPACE","\n                ",274],["T_VARIABLE","$resourceModel",275],["T_WHITESPACE"," ",275],"=",["T_WHITESPACE"," ",275],["T_STRING_CAST","(string)",275],["T_STRING","Mage",275],["T_DOUBLE_COLON","::",275],["T_STRING","getConfig",275],"(",")",["T_OBJECT_OPERATOR","->",275],["T_STRING","getNode",275],"(",")",["T_OBJECT_OPERATOR","->",275],["T_STRING","global",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","models",275],["T_OBJECT_OPERATOR","->",275],"{",["T_VARIABLE","$model",275],"}",["T_OBJECT_OPERATOR","->",275],["T_STRING","resourceModel",275],";",["T_WHITESPACE","\n                ",275],["T_VARIABLE","$entityConfig",276],["T_WHITESPACE","  ",276],"=",["T_WHITESPACE"," ",276],["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","getEntity",276],"(",["T_VARIABLE","$resourceModel",276],",",["T_WHITESPACE"," ",276],["T_VARIABLE","$entity",276],")",";",["T_WHITESPACE","\n            ",276],"}",["T_WHITESPACE","\n\n            ",277],["T_IF","if",279],["T_WHITESPACE"," ",279],"(",["T_VARIABLE","$entityConfig",279],["T_WHITESPACE"," ",279],["T_BOOLEAN_AND","&&",279],["T_WHITESPACE"," ",279],"!",["T_EMPTY","empty",279],"(",["T_VARIABLE","$entityConfig",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","table",279],")",")",["T_WHITESPACE"," ",279],"{",["T_WHITESPACE","\n                ",279],["T_VARIABLE","$tableName",280],["T_WHITESPACE"," ",280],"=",["T_WHITESPACE"," ",280],["T_STRING_CAST","(string)",280],["T_VARIABLE","$entityConfig",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","table",280],";",["T_WHITESPACE","\n            ",280],"}",["T_WHITESPACE"," ",281],["T_ELSE","else",281],["T_WHITESPACE"," ",281],"{",["T_WHITESPACE","\n                ",281],["T_STRING","Mage",282],["T_DOUBLE_COLON","::",282],["T_STRING","throwException",282],"(",["T_STRING","Mage",282],["T_DOUBLE_COLON","::",282],["T_STRING","helper",282],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",282],")",["T_OBJECT_OPERATOR","->",282],["T_STRING","__",282],"(",["T_CONSTANT_ENCAPSED_STRING","'Can\\'t retrieve entity config: %s'",282],",",["T_WHITESPACE"," ",282],["T_VARIABLE","$modelEntity",282],")",")",";",["T_WHITESPACE","\n            ",282],"}",["T_WHITESPACE","\n        ",283],"}",["T_WHITESPACE"," ",284],["T_ELSE","else",284],["T_WHITESPACE"," ",284],"{",["T_WHITESPACE","\n            ",284],["T_VARIABLE","$tableName",285],["T_WHITESPACE"," ",285],"=",["T_WHITESPACE"," ",285],["T_VARIABLE","$modelEntity",285],";",["T_WHITESPACE","\n        ",285],"}",["T_WHITESPACE","\n\n        ",286],["T_STRING","Mage",288],["T_DOUBLE_COLON","::",288],["T_STRING","dispatchEvent",288],"(",["T_CONSTANT_ENCAPSED_STRING","'resource_get_tablename'",288],",",["T_WHITESPACE"," ",288],["T_ARRAY","array",288],"(",["T_WHITESPACE","\n            ",288],["T_CONSTANT_ENCAPSED_STRING","'resource'",289],["T_WHITESPACE","      ",289],["T_DOUBLE_ARROW","=>",289],["T_WHITESPACE"," ",289],["T_VARIABLE","$this",289],",",["T_WHITESPACE","\n            ",289],["T_CONSTANT_ENCAPSED_STRING","'model_entity'",290],["T_WHITESPACE","  ",290],["T_DOUBLE_ARROW","=>",290],["T_WHITESPACE"," ",290],["T_VARIABLE","$modelEntity",290],",",["T_WHITESPACE","\n            ",290],["T_CONSTANT_ENCAPSED_STRING","'table_name'",291],["T_WHITESPACE","    ",291],["T_DOUBLE_ARROW","=>",291],["T_WHITESPACE"," ",291],["T_VARIABLE","$tableName",291],",",["T_WHITESPACE","\n            ",291],["T_CONSTANT_ENCAPSED_STRING","'table_suffix'",292],["T_WHITESPACE","  ",292],["T_DOUBLE_ARROW","=>",292],["T_WHITESPACE"," ",292],["T_VARIABLE","$tableSuffix",292],["T_WHITESPACE","\n        ",292],")",")",";",["T_WHITESPACE","\n\n        ",293],["T_VARIABLE","$mappedTableName",295],["T_WHITESPACE"," ",295],"=",["T_WHITESPACE"," ",295],["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","getMappedTableName",295],"(",["T_VARIABLE","$tableName",295],")",";",["T_WHITESPACE","\n        ",295],["T_IF","if",296],["T_WHITESPACE"," ",296],"(",["T_VARIABLE","$mappedTableName",296],")",["T_WHITESPACE"," ",296],"{",["T_WHITESPACE","\n            ",296],["T_VARIABLE","$tableName",297],["T_WHITESPACE"," ",297],"=",["T_WHITESPACE"," ",297],["T_VARIABLE","$mappedTableName",297],";",["T_WHITESPACE","\n        ",297],"}",["T_WHITESPACE"," ",298],["T_ELSE","else",298],["T_WHITESPACE"," ",298],"{",["T_WHITESPACE","\n            ",298],["T_VARIABLE","$tablePrefix",299],["T_WHITESPACE"," ",299],"=",["T_WHITESPACE"," ",299],["T_STRING_CAST","(string)",299],["T_STRING","Mage",299],["T_DOUBLE_COLON","::",299],["T_STRING","getConfig",299],"(",")",["T_OBJECT_OPERATOR","->",299],["T_STRING","getTablePrefix",299],"(",")",";",["T_WHITESPACE","\n            ",299],["T_VARIABLE","$tableName",300],["T_WHITESPACE"," ",300],"=",["T_WHITESPACE"," ",300],["T_VARIABLE","$tablePrefix",300],["T_WHITESPACE"," ",300],".",["T_WHITESPACE"," ",300],["T_VARIABLE","$tableName",300],";",["T_WHITESPACE","\n        ",300],"}",["T_WHITESPACE","\n\n        ",301],["T_IF","if",303],["T_WHITESPACE"," ",303],"(","!",["T_STRING","is_null",303],"(",["T_VARIABLE","$tableSuffix",303],")",")",["T_WHITESPACE"," ",303],"{",["T_WHITESPACE","\n            ",303],["T_VARIABLE","$tableName",304],["T_WHITESPACE"," ",304],["T_CONCAT_EQUAL",".=",304],["T_WHITESPACE"," ",304],["T_CONSTANT_ENCAPSED_STRING","'_'",304],["T_WHITESPACE"," ",304],".",["T_WHITESPACE"," ",304],["T_VARIABLE","$tableSuffix",304],";",["T_WHITESPACE","\n        ",304],"}",["T_WHITESPACE","\n        ",305],["T_RETURN","return",306],["T_WHITESPACE"," ",306],["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","getConnection",306],"(",["T_STRING","self",306],["T_DOUBLE_COLON","::",306],["T_STRING","DEFAULT_READ_RESOURCE",306],")",["T_OBJECT_OPERATOR","->",306],["T_STRING","getTableName",306],"(",["T_VARIABLE","$tableName",306],")",";",["T_WHITESPACE","\n    ",306],"}",["T_WHITESPACE","\n\n    ",307],["T_DOC_COMMENT","\/**\n     * Set mapped table name\n     *\n     * @param string $tableName\n     * @param string $mappedName\n     * @return Mage_Core_Model_Resource\n     *\/",309],["T_WHITESPACE","\n    ",315],["T_PUBLIC","public",316],["T_WHITESPACE"," ",316],["T_FUNCTION","function",316],["T_WHITESPACE"," ",316],["T_STRING","setMappedTableName",316],"(",["T_VARIABLE","$tableName",316],",",["T_WHITESPACE"," ",316],["T_VARIABLE","$mappedName",316],")",["T_WHITESPACE","\n    ",316],"{",["T_WHITESPACE","\n        ",317],["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","_mappedTableNames",318],"[",["T_VARIABLE","$tableName",318],"]",["T_WHITESPACE"," ",318],"=",["T_WHITESPACE"," ",318],["T_VARIABLE","$mappedName",318],";",["T_WHITESPACE","\n        ",318],["T_RETURN","return",319],["T_WHITESPACE"," ",319],["T_VARIABLE","$this",319],";",["T_WHITESPACE","\n    ",319],"}",["T_WHITESPACE","\n\n    ",320],["T_DOC_COMMENT","\/**\n     * Get mapped table name\n     *\n     * @param string $tableName\n     * @return bool|string\n     *\/",322],["T_WHITESPACE","\n    ",327],["T_PUBLIC","public",328],["T_WHITESPACE"," ",328],["T_FUNCTION","function",328],["T_WHITESPACE"," ",328],["T_STRING","getMappedTableName",328],"(",["T_VARIABLE","$tableName",328],")",["T_WHITESPACE","\n    ",328],"{",["T_WHITESPACE","\n        ",329],["T_IF","if",330],["T_WHITESPACE"," ",330],"(",["T_ISSET","isset",330],"(",["T_VARIABLE","$this",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","_mappedTableNames",330],"[",["T_VARIABLE","$tableName",330],"]",")",")",["T_WHITESPACE"," ",330],"{",["T_WHITESPACE","\n            ",330],["T_RETURN","return",331],["T_WHITESPACE"," ",331],["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","_mappedTableNames",331],"[",["T_VARIABLE","$tableName",331],"]",";",["T_WHITESPACE","\n        ",331],"}",["T_WHITESPACE"," ",332],["T_ELSE","else",332],["T_WHITESPACE"," ",332],"{",["T_WHITESPACE","\n            ",332],["T_RETURN","return",333],["T_WHITESPACE"," ",333],["T_STRING","false",333],";",["T_WHITESPACE","\n        ",333],"}",["T_WHITESPACE","\n    ",334],"}",["T_WHITESPACE","\n\n    ",335],["T_DOC_COMMENT","\/**\n     * Clean db row\n     *\n     * @param array $row\n     * @return Mage_Core_Model_Resource\n     *\/",337],["T_WHITESPACE","\n    ",342],["T_PUBLIC","public",343],["T_WHITESPACE"," ",343],["T_FUNCTION","function",343],["T_WHITESPACE"," ",343],["T_STRING","cleanDbRow",343],"(","&",["T_VARIABLE","$row",343],")",["T_WHITESPACE","\n    ",343],"{",["T_WHITESPACE","\n        ",344],["T_VARIABLE","$zeroDate",345],["T_WHITESPACE"," ",345],"=",["T_WHITESPACE"," ",345],["T_VARIABLE","$this",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","getConnection",345],"(",["T_STRING","self",345],["T_DOUBLE_COLON","::",345],["T_STRING","DEFAULT_READ_RESOURCE",345],")",["T_OBJECT_OPERATOR","->",345],["T_STRING","getSuggestedZeroDate",345],"(",")",";",["T_WHITESPACE","\n        ",345],["T_IF","if",346],["T_WHITESPACE"," ",346],"(","!",["T_EMPTY","empty",346],"(",["T_VARIABLE","$row",346],")",["T_WHITESPACE"," ",346],["T_BOOLEAN_AND","&&",346],["T_WHITESPACE"," ",346],["T_STRING","is_array",346],"(",["T_VARIABLE","$row",346],")",")",["T_WHITESPACE"," ",346],"{",["T_WHITESPACE","\n            ",346],["T_FOREACH","foreach",347],["T_WHITESPACE"," ",347],"(",["T_VARIABLE","$row",347],["T_WHITESPACE"," ",347],["T_AS","as",347],["T_WHITESPACE"," ",347],["T_VARIABLE","$key",347],["T_DOUBLE_ARROW","=>",347],"&",["T_VARIABLE","$value",347],")",["T_WHITESPACE"," ",347],"{",["T_WHITESPACE","\n                ",347],["T_IF","if",348],["T_WHITESPACE"," ",348],"(",["T_STRING","is_string",348],"(",["T_VARIABLE","$value",348],")",["T_WHITESPACE"," ",348],["T_BOOLEAN_AND","&&",348],["T_WHITESPACE"," ",348],["T_VARIABLE","$value",348],["T_WHITESPACE"," ",348],["T_IS_IDENTICAL","===",348],["T_WHITESPACE"," ",348],["T_VARIABLE","$zeroDate",348],")",["T_WHITESPACE"," ",348],"{",["T_WHITESPACE","\n                    ",348],["T_VARIABLE","$value",349],["T_WHITESPACE"," ",349],"=",["T_WHITESPACE"," ",349],["T_CONSTANT_ENCAPSED_STRING","''",349],";",["T_WHITESPACE","\n                ",349],"}",["T_WHITESPACE","\n            ",350],"}",["T_WHITESPACE","\n        ",351],"}",["T_WHITESPACE","\n        ",352],["T_RETURN","return",353],["T_WHITESPACE"," ",353],["T_VARIABLE","$this",353],";",["T_WHITESPACE","\n    ",353],"}",["T_WHITESPACE","\n\n    ",354],["T_DOC_COMMENT","\/**\n     * Create new connection with custom config\n     *\n     * @param string $name\n     * @param string $type\n     * @param array $config\n     * @return unknown\n     *\/",356],["T_WHITESPACE","\n    ",363],["T_PUBLIC","public",364],["T_WHITESPACE"," ",364],["T_FUNCTION","function",364],["T_WHITESPACE"," ",364],["T_STRING","createConnection",364],"(",["T_VARIABLE","$name",364],",",["T_WHITESPACE"," ",364],["T_VARIABLE","$type",364],",",["T_WHITESPACE"," ",364],["T_VARIABLE","$config",364],")",["T_WHITESPACE","\n    ",364],"{",["T_WHITESPACE","\n        ",365],["T_IF","if",366],["T_WHITESPACE"," ",366],"(","!",["T_ISSET","isset",366],"(",["T_VARIABLE","$this",366],["T_OBJECT_OPERATOR","->",366],["T_STRING","_connections",366],"[",["T_VARIABLE","$name",366],"]",")",")",["T_WHITESPACE"," ",366],"{",["T_WHITESPACE","\n            ",366],["T_VARIABLE","$connection",367],["T_WHITESPACE"," ",367],"=",["T_WHITESPACE"," ",367],["T_VARIABLE","$this",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","_newConnection",367],"(",["T_VARIABLE","$type",367],",",["T_WHITESPACE"," ",367],["T_VARIABLE","$config",367],")",";",["T_WHITESPACE","\n\n            ",367],["T_VARIABLE","$this",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","_connections",369],"[",["T_VARIABLE","$name",369],"]",["T_WHITESPACE"," ",369],"=",["T_WHITESPACE"," ",369],["T_VARIABLE","$connection",369],";",["T_WHITESPACE","\n        ",369],"}",["T_WHITESPACE","\n        ",370],["T_RETURN","return",371],["T_WHITESPACE"," ",371],["T_VARIABLE","$this",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","_connections",371],"[",["T_VARIABLE","$name",371],"]",";",["T_WHITESPACE","\n    ",371],"}",["T_WHITESPACE","\n\n    ",372],["T_PUBLIC","public",374],["T_WHITESPACE"," ",374],["T_FUNCTION","function",374],["T_WHITESPACE"," ",374],["T_STRING","checkDbConnection",374],"(",")",["T_WHITESPACE","\n    ",374],"{",["T_WHITESPACE","\n        ",375],["T_IF","if",376],["T_WHITESPACE"," ",376],"(","!",["T_VARIABLE","$this",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","getConnection",376],"(",["T_CONSTANT_ENCAPSED_STRING","'core_read'",376],")",")",["T_WHITESPACE"," ",376],"{",["T_WHITESPACE","\n            ",376],["T_COMMENT","\/\/Mage::app()->getResponse()->setRedirect(Mage::getUrl('install'));\n",377],["T_WHITESPACE","        ",378],"}",["T_WHITESPACE","\n    ",378],"}",["T_WHITESPACE","\n\n    ",379],["T_PUBLIC","public",381],["T_WHITESPACE"," ",381],["T_FUNCTION","function",381],["T_WHITESPACE"," ",381],["T_STRING","getAutoUpdate",381],"(",")",["T_WHITESPACE","\n    ",381],"{",["T_WHITESPACE","\n        ",382],["T_RETURN","return",383],["T_WHITESPACE"," ",383],["T_STRING","self",383],["T_DOUBLE_COLON","::",383],["T_STRING","AUTO_UPDATE_ALWAYS",383],";",["T_WHITESPACE","\n        ",383],["T_COMMENT","#return Mage::app()->loadCache(self::AUTO_UPDATE_CACHE_KEY);\n",384],["T_WHITESPACE","    ",385],"}",["T_WHITESPACE","\n\n    ",385],["T_PUBLIC","public",387],["T_WHITESPACE"," ",387],["T_FUNCTION","function",387],["T_WHITESPACE"," ",387],["T_STRING","setAutoUpdate",387],"(",["T_VARIABLE","$value",387],")",["T_WHITESPACE","\n    ",387],"{",["T_WHITESPACE","\n        ",388],["T_COMMENT","#Mage::app()->saveCache($value, self::AUTO_UPDATE_CACHE_KEY);\n",389],["T_WHITESPACE","        ",390],["T_RETURN","return",390],["T_WHITESPACE"," ",390],["T_VARIABLE","$this",390],";",["T_WHITESPACE","\n    ",390],"}",["T_WHITESPACE","\n    ",391],["T_DOC_COMMENT","\/**\n     * Retrieve 32bit UNIQUE HASH for a Table index\n     *\n     * @param string $tableName\n     * @param array|string $fields\n     * @param string $indexType\n     * @return string\n     *\/",392],["T_WHITESPACE","\n    ",399],["T_PUBLIC","public",400],["T_WHITESPACE"," ",400],["T_FUNCTION","function",400],["T_WHITESPACE"," ",400],["T_STRING","getIdxName",400],"(",["T_VARIABLE","$tableName",400],",",["T_WHITESPACE"," ",400],["T_VARIABLE","$fields",400],",",["T_WHITESPACE"," ",400],["T_VARIABLE","$indexType",400],["T_WHITESPACE"," ",400],"=",["T_WHITESPACE"," ",400],["T_STRING","Varien_Db_Adapter_Interface",400],["T_DOUBLE_COLON","::",400],["T_STRING","INDEX_TYPE_INDEX",400],")",["T_WHITESPACE","\n    ",400],"{",["T_WHITESPACE","\n        ",401],["T_RETURN","return",402],["T_WHITESPACE"," ",402],["T_VARIABLE","$this",402],["T_OBJECT_OPERATOR","->",402],["T_STRING","getConnection",402],"(",["T_STRING","self",402],["T_DOUBLE_COLON","::",402],["T_STRING","DEFAULT_READ_RESOURCE",402],")",["T_WHITESPACE","\n            ",402],["T_OBJECT_OPERATOR","->",403],["T_STRING","getIndexName",403],"(",["T_VARIABLE","$this",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","getTableName",403],"(",["T_VARIABLE","$tableName",403],")",",",["T_WHITESPACE"," ",403],["T_VARIABLE","$fields",403],",",["T_WHITESPACE"," ",403],["T_VARIABLE","$indexType",403],")",";",["T_WHITESPACE","\n    ",403],"}",["T_WHITESPACE","\n\n    ",404],["T_DOC_COMMENT","\/**\n     * Retrieve 32bit UNIQUE HASH for a Table foreign key\n     *\n     * @param string $priTableName  the target table name\n     * @param string $priColumnName the target table column name\n     * @param string $refTableName  the reference table name\n     * @param string $refColumnName the reference table column name\n     * @return string\n     *\/",406],["T_WHITESPACE","\n    ",414],["T_PUBLIC","public",415],["T_WHITESPACE"," ",415],["T_FUNCTION","function",415],["T_WHITESPACE"," ",415],["T_STRING","getFkName",415],"(",["T_VARIABLE","$priTableName",415],",",["T_WHITESPACE"," ",415],["T_VARIABLE","$priColumnName",415],",",["T_WHITESPACE"," ",415],["T_VARIABLE","$refTableName",415],",",["T_WHITESPACE"," ",415],["T_VARIABLE","$refColumnName",415],")",["T_WHITESPACE","\n    ",415],"{",["T_WHITESPACE","\n        ",416],["T_RETURN","return",417],["T_WHITESPACE"," ",417],["T_VARIABLE","$this",417],["T_OBJECT_OPERATOR","->",417],["T_STRING","getConnection",417],"(",["T_STRING","self",417],["T_DOUBLE_COLON","::",417],["T_STRING","DEFAULT_READ_RESOURCE",417],")",["T_WHITESPACE","\n            ",417],["T_OBJECT_OPERATOR","->",418],["T_STRING","getForeignKeyName",418],"(",["T_VARIABLE","$this",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","getTableName",418],"(",["T_VARIABLE","$priTableName",418],")",",",["T_WHITESPACE"," ",418],["T_VARIABLE","$priColumnName",418],",",["T_WHITESPACE","\n                ",418],["T_VARIABLE","$this",419],["T_OBJECT_OPERATOR","->",419],["T_STRING","getTableName",419],"(",["T_VARIABLE","$refTableName",419],")",",",["T_WHITESPACE"," ",419],["T_VARIABLE","$refColumnName",419],")",";",["T_WHITESPACE","\n    ",419],"}",["T_WHITESPACE","\n",420],"}",["T_WHITESPACE","\n",421]]