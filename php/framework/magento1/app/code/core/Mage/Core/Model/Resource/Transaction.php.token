[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Core\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Resource transaction model\n *\n * @todo need collect conection by name\n * @category   Mage\n * @package    Mage_Core\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",35],["T_CLASS","class",36],["T_WHITESPACE"," ",36],["T_STRING","Mage_Core_Model_Resource_Transaction",36],["T_WHITESPACE","\n",36],"{",["T_WHITESPACE","\n    ",37],["T_DOC_COMMENT","\/**\n     * Objects which will be involved to transaction\n     *\n     * @var array\n     *\/",38],["T_WHITESPACE","\n    ",42],["T_PROTECTED","protected",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$_objects",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_ARRAY","array",43],"(",")",";",["T_WHITESPACE","\n\n    ",43],["T_DOC_COMMENT","\/**\n     * Transaction objects array with alias key\n     *\n     * @var array\n     *\/",45],["T_WHITESPACE","\n    ",49],["T_PROTECTED","protected",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$_objectsByAlias",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_ARRAY","array",50],"(",")",";",["T_WHITESPACE","\n\n    ",50],["T_DOC_COMMENT","\/**\n     * Callbacks array.\n     *\n     * @var array\n     *\/",52],["T_WHITESPACE","\n    ",56],["T_PROTECTED","protected",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$_beforeCommitCallbacks",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_ARRAY","array",57],"(",")",";",["T_WHITESPACE","\n    ",57],["T_DOC_COMMENT","\/**\n     * Begin transaction for all involved object resources\n     *\n     * @return Mage_Core_Model_Resource_Transaction\n     *\/",58],["T_WHITESPACE","\n    ",62],["T_PROTECTED","protected",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","_startTransaction",63],"(",")",["T_WHITESPACE","\n    ",63],"{",["T_WHITESPACE","\n        ",64],["T_FOREACH","foreach",65],["T_WHITESPACE"," ",65],"(",["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","_objects",65],["T_WHITESPACE"," ",65],["T_AS","as",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$object",65],")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n            ",65],["T_VARIABLE","$object",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getResource",66],"(",")",["T_OBJECT_OPERATOR","->",66],["T_STRING","beginTransaction",66],"(",")",";",["T_WHITESPACE","\n        ",66],"}",["T_WHITESPACE","\n        ",67],["T_RETURN","return",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$this",68],";",["T_WHITESPACE","\n    ",68],"}",["T_WHITESPACE","\n\n    ",69],["T_DOC_COMMENT","\/**\n     * Commit transaction for all resources\n     *\n     * @return Mage_Core_Model_Resource_Transaction\n     *\/",71],["T_WHITESPACE","\n    ",75],["T_PROTECTED","protected",76],["T_WHITESPACE"," ",76],["T_FUNCTION","function",76],["T_WHITESPACE"," ",76],["T_STRING","_commitTransaction",76],"(",")",["T_WHITESPACE","\n    ",76],"{",["T_WHITESPACE","\n        ",77],["T_FOREACH","foreach",78],["T_WHITESPACE"," ",78],"(",["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","_objects",78],["T_WHITESPACE"," ",78],["T_AS","as",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$object",78],")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n            ",78],["T_VARIABLE","$object",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","getResource",79],"(",")",["T_OBJECT_OPERATOR","->",79],["T_STRING","commit",79],"(",")",";",["T_WHITESPACE","\n        ",79],"}",["T_WHITESPACE","\n        ",80],["T_RETURN","return",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],";",["T_WHITESPACE","\n    ",81],"}",["T_WHITESPACE","\n\n    ",82],["T_DOC_COMMENT","\/**\n     * Rollback transaction\n     *\n     * @return Mage_Core_Model_Resource_Transaction\n     *\/",84],["T_WHITESPACE","\n    ",88],["T_PROTECTED","protected",89],["T_WHITESPACE"," ",89],["T_FUNCTION","function",89],["T_WHITESPACE"," ",89],["T_STRING","_rollbackTransaction",89],"(",")",["T_WHITESPACE","\n    ",89],"{",["T_WHITESPACE","\n        ",90],["T_FOREACH","foreach",91],["T_WHITESPACE"," ",91],"(",["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","_objects",91],["T_WHITESPACE"," ",91],["T_AS","as",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$object",91],")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n            ",91],["T_VARIABLE","$object",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getResource",92],"(",")",["T_OBJECT_OPERATOR","->",92],["T_STRING","rollBack",92],"(",")",";",["T_WHITESPACE","\n        ",92],"}",["T_WHITESPACE","\n        ",93],["T_RETURN","return",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],";",["T_WHITESPACE","\n    ",94],"}",["T_WHITESPACE","\n\n    ",95],["T_DOC_COMMENT","\/**\n     * Run all configured object callbacks\n     *\n     * @return Mage_Core_Model_Resource_Transaction\n     *\/",97],["T_WHITESPACE","\n    ",101],["T_PROTECTED","protected",102],["T_WHITESPACE"," ",102],["T_FUNCTION","function",102],["T_WHITESPACE"," ",102],["T_STRING","_runCallbacks",102],"(",")",["T_WHITESPACE","\n    ",102],"{",["T_WHITESPACE","\n        ",103],["T_FOREACH","foreach",104],["T_WHITESPACE"," ",104],"(",["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","_beforeCommitCallbacks",104],["T_WHITESPACE"," ",104],["T_AS","as",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$callback",104],")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n            ",104],["T_STRING","call_user_func",105],"(",["T_VARIABLE","$callback",105],")",";",["T_WHITESPACE","\n        ",105],"}",["T_WHITESPACE","\n        ",106],["T_RETURN","return",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$this",107],";",["T_WHITESPACE","\n    ",107],"}",["T_WHITESPACE","\n\n    ",108],["T_DOC_COMMENT","\/**\n     * Adding object for using in transaction\n     *\n     * @param Mage_Core_Model_Abstract $object\n     * @param string $alias\n     * @return Mage_Core_Model_Resource_Transaction\n     *\/",110],["T_WHITESPACE","\n    ",116],["T_PUBLIC","public",117],["T_WHITESPACE"," ",117],["T_FUNCTION","function",117],["T_WHITESPACE"," ",117],["T_STRING","addObject",117],"(",["T_STRING","Mage_Core_Model_Abstract",117],["T_WHITESPACE"," ",117],["T_VARIABLE","$object",117],",",["T_WHITESPACE"," ",117],["T_VARIABLE","$alias",117],"=",["T_CONSTANT_ENCAPSED_STRING","''",117],")",["T_WHITESPACE","\n    ",117],"{",["T_WHITESPACE","\n        ",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_objects",119],"[","]",["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$object",119],";",["T_WHITESPACE","\n        ",119],["T_IF","if",120],["T_WHITESPACE"," ",120],"(","!",["T_EMPTY","empty",120],"(",["T_VARIABLE","$alias",120],")",")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n            ",120],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","_objectsByAlias",121],"[",["T_VARIABLE","$alias",121],"]",["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_VARIABLE","$object",121],";",["T_WHITESPACE","\n        ",121],"}",["T_WHITESPACE","\n        ",122],["T_RETURN","return",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],";",["T_WHITESPACE","\n    ",123],"}",["T_WHITESPACE","\n\n    ",124],["T_DOC_COMMENT","\/**\n     * Add callback function which will be called before commit transactions\n     *\n     * @param callback $callback\n     * @return Mage_Core_Model_Resource_Transaction\n     *\/",126],["T_WHITESPACE","\n    ",131],["T_PUBLIC","public",132],["T_WHITESPACE"," ",132],["T_FUNCTION","function",132],["T_WHITESPACE"," ",132],["T_STRING","addCommitCallback",132],"(",["T_VARIABLE","$callback",132],")",["T_WHITESPACE","\n    ",132],"{",["T_WHITESPACE","\n        ",133],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","_beforeCommitCallbacks",134],"[","]",["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_VARIABLE","$callback",134],";",["T_WHITESPACE","\n        ",134],["T_RETURN","return",135],["T_WHITESPACE"," ",135],["T_VARIABLE","$this",135],";",["T_WHITESPACE","\n    ",135],"}",["T_WHITESPACE","\n\n    ",136],["T_DOC_COMMENT","\/**\n     * Initialize objects save transaction\n     *\n     * @return Mage_Core_Model_Resource_Transaction\n     * @throws Exception\n     *\/",138],["T_WHITESPACE","\n    ",143],["T_PUBLIC","public",144],["T_WHITESPACE"," ",144],["T_FUNCTION","function",144],["T_WHITESPACE"," ",144],["T_STRING","save",144],"(",")",["T_WHITESPACE","\n    ",144],"{",["T_WHITESPACE","\n        ",145],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","_startTransaction",146],"(",")",";",["T_WHITESPACE","\n        ",146],["T_VARIABLE","$error",147],["T_WHITESPACE","     ",147],"=",["T_WHITESPACE"," ",147],["T_STRING","false",147],";",["T_WHITESPACE","\n\n        ",147],["T_TRY","try",149],["T_WHITESPACE"," ",149],"{",["T_WHITESPACE","\n            ",149],["T_FOREACH","foreach",150],["T_WHITESPACE"," ",150],"(",["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","_objects",150],["T_WHITESPACE"," ",150],["T_AS","as",150],["T_WHITESPACE"," ",150],["T_VARIABLE","$object",150],")",["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n                ",150],["T_VARIABLE","$object",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","save",151],"(",")",";",["T_WHITESPACE","\n            ",151],"}",["T_WHITESPACE","\n        ",152],"}",["T_WHITESPACE"," ",153],["T_CATCH","catch",153],["T_WHITESPACE"," ",153],"(",["T_STRING","Exception",153],["T_WHITESPACE"," ",153],["T_VARIABLE","$e",153],")",["T_WHITESPACE"," ",153],"{",["T_WHITESPACE","\n            ",153],["T_VARIABLE","$error",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_VARIABLE","$e",154],";",["T_WHITESPACE","\n        ",154],"}",["T_WHITESPACE","\n\n        ",155],["T_IF","if",157],["T_WHITESPACE"," ",157],"(",["T_VARIABLE","$error",157],["T_WHITESPACE"," ",157],["T_IS_IDENTICAL","===",157],["T_WHITESPACE"," ",157],["T_STRING","false",157],")",["T_WHITESPACE"," ",157],"{",["T_WHITESPACE","\n            ",157],["T_TRY","try",158],["T_WHITESPACE"," ",158],"{",["T_WHITESPACE","\n                ",158],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","_runCallbacks",159],"(",")",";",["T_WHITESPACE","\n            ",159],"}",["T_WHITESPACE"," ",160],["T_CATCH","catch",160],["T_WHITESPACE"," ",160],"(",["T_STRING","Exception",160],["T_WHITESPACE"," ",160],["T_VARIABLE","$e",160],")",["T_WHITESPACE"," ",160],"{",["T_WHITESPACE","\n                ",160],["T_VARIABLE","$error",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_VARIABLE","$e",161],";",["T_WHITESPACE","\n            ",161],"}",["T_WHITESPACE","\n        ",162],"}",["T_WHITESPACE","\n\n        ",163],["T_IF","if",165],["T_WHITESPACE"," ",165],"(",["T_VARIABLE","$error",165],")",["T_WHITESPACE"," ",165],"{",["T_WHITESPACE","\n            ",165],["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","_rollbackTransaction",166],"(",")",";",["T_WHITESPACE","\n            ",166],["T_THROW","throw",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$error",167],";",["T_WHITESPACE","\n        ",167],"}",["T_WHITESPACE"," ",168],["T_ELSE","else",168],["T_WHITESPACE"," ",168],"{",["T_WHITESPACE","\n            ",168],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","_commitTransaction",169],"(",")",";",["T_WHITESPACE","\n        ",169],"}",["T_WHITESPACE","\n\n        ",170],["T_RETURN","return",172],["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],";",["T_WHITESPACE","\n    ",172],"}",["T_WHITESPACE","\n\n    ",173],["T_DOC_COMMENT","\/**\n     * Initialize objects delete transaction\n     *\n     * @return Mage_Core_Model_Resource_Transaction\n     * @throws Exception\n     *\/",175],["T_WHITESPACE","\n    ",180],["T_PUBLIC","public",181],["T_WHITESPACE"," ",181],["T_FUNCTION","function",181],["T_WHITESPACE"," ",181],["T_STRING","delete",181],"(",")",["T_WHITESPACE","\n    ",181],"{",["T_WHITESPACE","\n        ",182],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","_startTransaction",183],"(",")",";",["T_WHITESPACE","\n        ",183],["T_VARIABLE","$error",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_STRING","false",184],";",["T_WHITESPACE","\n\n        ",184],["T_TRY","try",186],["T_WHITESPACE"," ",186],"{",["T_WHITESPACE","\n            ",186],["T_FOREACH","foreach",187],["T_WHITESPACE"," ",187],"(",["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","_objects",187],["T_WHITESPACE"," ",187],["T_AS","as",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$object",187],")",["T_WHITESPACE"," ",187],"{",["T_WHITESPACE","\n                ",187],["T_VARIABLE","$object",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","delete",188],"(",")",";",["T_WHITESPACE","\n            ",188],"}",["T_WHITESPACE","\n        ",189],"}",["T_WHITESPACE"," ",190],["T_CATCH","catch",190],["T_WHITESPACE"," ",190],"(",["T_STRING","Exception",190],["T_WHITESPACE"," ",190],["T_VARIABLE","$e",190],")",["T_WHITESPACE"," ",190],"{",["T_WHITESPACE","\n            ",190],["T_VARIABLE","$error",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_VARIABLE","$e",191],";",["T_WHITESPACE","\n        ",191],"}",["T_WHITESPACE","\n\n        ",192],["T_IF","if",194],["T_WHITESPACE"," ",194],"(",["T_VARIABLE","$error",194],["T_WHITESPACE"," ",194],["T_IS_IDENTICAL","===",194],["T_WHITESPACE"," ",194],["T_STRING","false",194],")",["T_WHITESPACE"," ",194],"{",["T_WHITESPACE","\n            ",194],["T_TRY","try",195],["T_WHITESPACE"," ",195],"{",["T_WHITESPACE","\n                ",195],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","_runCallbacks",196],"(",")",";",["T_WHITESPACE","\n            ",196],"}",["T_WHITESPACE"," ",197],["T_CATCH","catch",197],["T_WHITESPACE"," ",197],"(",["T_STRING","Exception",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$e",197],")",["T_WHITESPACE"," ",197],"{",["T_WHITESPACE","\n                ",197],["T_VARIABLE","$error",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_VARIABLE","$e",198],";",["T_WHITESPACE","\n            ",198],"}",["T_WHITESPACE","\n        ",199],"}",["T_WHITESPACE","\n\n        ",200],["T_IF","if",202],["T_WHITESPACE"," ",202],"(",["T_VARIABLE","$error",202],")",["T_WHITESPACE"," ",202],"{",["T_WHITESPACE","\n            ",202],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","_rollbackTransaction",203],"(",")",";",["T_WHITESPACE","\n            ",203],["T_THROW","throw",204],["T_WHITESPACE"," ",204],["T_VARIABLE","$error",204],";",["T_WHITESPACE","\n        ",204],"}",["T_WHITESPACE"," ",205],["T_ELSE","else",205],["T_WHITESPACE"," ",205],"{",["T_WHITESPACE","\n            ",205],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","_commitTransaction",206],"(",")",";",["T_WHITESPACE","\n        ",206],"}",["T_WHITESPACE","\n        ",207],["T_RETURN","return",208],["T_WHITESPACE"," ",208],["T_VARIABLE","$this",208],";",["T_WHITESPACE","\n    ",208],"}",["T_WHITESPACE","\n\n",209],"}",["T_WHITESPACE","\n",211]]