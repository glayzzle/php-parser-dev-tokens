[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_GiftMessage\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * GiftMessage api\n *\n * @category   Mage\n * @package    Mage_GiftMessage\n * @author     Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_GiftMessage_Model_Api",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Checkout_Model_Api_Resource_Product",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Return an Array of attributes.\n     *\n     * @param Array $obj\n     * @return Array\n     *\/",36],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","_prepareData",42],"(",["T_VARIABLE","$arr",42],")",["T_WHITESPACE","\n    ",42],"{",["T_WHITESPACE","\n        ",43],["T_IF","if",44],["T_WHITESPACE"," ",44],"(",["T_STRING","is_array",44],"(",["T_VARIABLE","$arr",44],")",")",["T_WHITESPACE"," ",44],"{",["T_WHITESPACE","\n            ",44],["T_RETURN","return",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$arr",45],";",["T_WHITESPACE","\n        ",45],"}",["T_WHITESPACE","\n        ",46],["T_RETURN","return",47],["T_WHITESPACE"," ",47],["T_ARRAY","array",47],"(",")",";",["T_WHITESPACE","\n    ",47],"}",["T_WHITESPACE","\n\n    ",48],["T_DOC_COMMENT","\/**\n     * Raise event for setting a giftMessage.\n     *\n     * @param String $entityId\n     * @param Mage_Core_Controller_Request_Http $request\n     * @param Mage_Sales_Model_Quote $quote\n     * @return AssociativeArray\n     *\/",50],["T_WHITESPACE","\n    ",57],["T_PROTECTED","protected",58],["T_WHITESPACE"," ",58],["T_FUNCTION","function",58],["T_WHITESPACE"," ",58],["T_STRING","_setGiftMessage",58],"(",["T_VARIABLE","$entityId",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$request",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$quote",58],")",["T_WHITESPACE","\n    ",58],"{",["T_WHITESPACE","\n\n        ",59],["T_DOC_COMMENT","\/**\n         * Below code will catch exceptions only in DeveloperMode\n         * @see Mage_Core_Model_App::_callObserverMethod($object, $method, $observer)\n         * And result of Mage::dispatchEvent will always return an Object of Mage_Core_Model_App.\n         *\/",61],["T_WHITESPACE","\n        ",65],["T_TRY","try",66],["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n            ",66],["T_STRING","Mage",67],["T_DOUBLE_COLON","::",67],["T_STRING","dispatchEvent",67],"(",["T_WHITESPACE","\n                ",67],["T_CONSTANT_ENCAPSED_STRING","'checkout_controller_onepage_save_shipping_method'",68],",",["T_WHITESPACE","\n                ",68],["T_ARRAY","array",69],"(",["T_CONSTANT_ENCAPSED_STRING","'request'",69],["T_WHITESPACE"," ",69],["T_DOUBLE_ARROW","=>",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$request",69],",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'quote'",69],["T_WHITESPACE"," ",69],["T_DOUBLE_ARROW","=>",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$quote",69],")",["T_WHITESPACE","\n            ",69],")",";",["T_WHITESPACE","\n            ",70],["T_RETURN","return",71],["T_WHITESPACE"," ",71],["T_ARRAY","array",71],"(",["T_CONSTANT_ENCAPSED_STRING","'entityId'",71],["T_WHITESPACE"," ",71],["T_DOUBLE_ARROW","=>",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$entityId",71],",",["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'result'",71],["T_WHITESPACE"," ",71],["T_DOUBLE_ARROW","=>",71],["T_WHITESPACE"," ",71],["T_STRING","true",71],",",["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'error'",71],["T_WHITESPACE"," ",71],["T_DOUBLE_ARROW","=>",71],["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","''",71],")",";",["T_WHITESPACE","\n        ",71],"}",["T_WHITESPACE"," ",72],["T_CATCH","catch",72],["T_WHITESPACE"," ",72],"(",["T_STRING","Exception",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$e",72],")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n            ",72],["T_RETURN","return",73],["T_WHITESPACE"," ",73],["T_ARRAY","array",73],"(",["T_CONSTANT_ENCAPSED_STRING","'entityId'",73],["T_WHITESPACE"," ",73],["T_DOUBLE_ARROW","=>",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$entityId",73],",",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'result'",73],["T_WHITESPACE"," ",73],["T_DOUBLE_ARROW","=>",73],["T_WHITESPACE"," ",73],["T_STRING","false",73],",",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'error'",73],["T_WHITESPACE"," ",73],["T_DOUBLE_ARROW","=>",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$e",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","getMessage",73],"(",")",")",";",["T_WHITESPACE","\n        ",73],"}",["T_WHITESPACE","\n    ",74],"}",["T_WHITESPACE","\n\n    ",75],["T_DOC_COMMENT","\/**\n     * Set GiftMessage for a Quote.\n     *\n     * @param String $quoteId\n     * @param AssociativeArray $giftMessage\n     * @param String $store\n     * @return AssociativeArray\n     *\/",77],["T_WHITESPACE","\n    ",84],["T_PUBLIC","public",85],["T_WHITESPACE"," ",85],["T_FUNCTION","function",85],["T_WHITESPACE"," ",85],["T_STRING","setForQuote",85],"(",["T_VARIABLE","$quoteId",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$giftMessage",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$store",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_STRING","null",85],")",["T_WHITESPACE","\n    ",85],"{",["T_WHITESPACE","\n        ",86],["T_DOC_COMMENT","\/** @var $quote Mage_Sales_Model_Quote *\/",87],["T_WHITESPACE","\n        ",87],["T_VARIABLE","$quote",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","_getQuote",88],"(",["T_VARIABLE","$quoteId",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$store",88],")",";",["T_WHITESPACE","\n\n        ",88],["T_VARIABLE","$giftMessage",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","_prepareData",90],"(",["T_VARIABLE","$giftMessage",90],")",";",["T_WHITESPACE","\n        ",90],["T_IF","if",91],["T_WHITESPACE"," ",91],"(",["T_EMPTY","empty",91],"(",["T_VARIABLE","$giftMessage",91],")",")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n            ",91],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","_fault",92],"(",["T_CONSTANT_ENCAPSED_STRING","'giftmessage_invalid_data'",92],")",";",["T_WHITESPACE","\n        ",92],"}",["T_WHITESPACE","\n\n        ",93],["T_VARIABLE","$giftMessage",95],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",95],"]",["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","'quote'",95],";",["T_WHITESPACE","\n        ",95],["T_VARIABLE","$giftMessages",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_ARRAY","array",96],"(",["T_VARIABLE","$quoteId",96],["T_WHITESPACE"," ",96],["T_DOUBLE_ARROW","=>",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$giftMessage",96],")",";",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$request",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_NEW","new",97],["T_WHITESPACE"," ",97],["T_STRING","Mage_Core_Controller_Request_Http",97],"(",")",";",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$request",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","setParam",98],"(",["T_CONSTANT_ENCAPSED_STRING","\"giftmessage\"",98],",",["T_WHITESPACE"," ",98],["T_VARIABLE","$giftMessages",98],")",";",["T_WHITESPACE","\n\n        ",98],["T_RETURN","return",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","_setGiftMessage",100],"(",["T_VARIABLE","$quote",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getId",100],"(",")",",",["T_WHITESPACE"," ",100],["T_VARIABLE","$request",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$quote",100],")",";",["T_WHITESPACE","\n    ",100],"}",["T_WHITESPACE","\n\n    ",101],["T_DOC_COMMENT","\/**\n     * Set a GiftMessage to QuoteItem by product\n     *\n     * @param String $quoteId\n     * @param Array $productsAndMessages\n     * @param String $store\n     * @return array\n     *\/",103],["T_WHITESPACE","\n    ",110],["T_PUBLIC","public",111],["T_WHITESPACE"," ",111],["T_FUNCTION","function",111],["T_WHITESPACE"," ",111],["T_STRING","setForQuoteProduct",111],"(",["T_VARIABLE","$quoteId",111],",",["T_WHITESPACE"," ",111],["T_VARIABLE","$productsAndMessages",111],",",["T_WHITESPACE"," ",111],["T_VARIABLE","$store",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_STRING","null",111],")",["T_WHITESPACE","\n    ",111],"{",["T_WHITESPACE","\n        ",112],["T_DOC_COMMENT","\/** @var $quote Mage_Sales_Model_Quote *\/",113],["T_WHITESPACE","\n        ",113],["T_VARIABLE","$quote",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","_getQuote",114],"(",["T_VARIABLE","$quoteId",114],",",["T_WHITESPACE"," ",114],["T_VARIABLE","$store",114],")",";",["T_WHITESPACE","\n\n        ",114],["T_VARIABLE","$productsAndMessages",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","_prepareData",116],"(",["T_VARIABLE","$productsAndMessages",116],")",";",["T_WHITESPACE","\n        ",116],["T_IF","if",117],["T_WHITESPACE"," ",117],"(",["T_EMPTY","empty",117],"(",["T_VARIABLE","$productsAndMessages",117],")",")",["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n            ",117],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","_fault",118],"(",["T_CONSTANT_ENCAPSED_STRING","'invalid_data'",118],")",";",["T_WHITESPACE","\n        ",118],"}",["T_WHITESPACE","\n\n        ",119],["T_IF","if",121],["T_WHITESPACE"," ",121],"(",["T_STRING","count",121],"(",["T_VARIABLE","$productsAndMessages",121],")",["T_WHITESPACE"," ",121],["T_IS_EQUAL","==",121],["T_WHITESPACE"," ",121],["T_LNUMBER","2",121],["T_WHITESPACE","\n                ",121],["T_BOOLEAN_AND","&&",122],["T_WHITESPACE"," ",122],["T_ISSET","isset",122],"(",["T_VARIABLE","$productsAndMessages",122],"[",["T_CONSTANT_ENCAPSED_STRING","'product'",122],"]",")",["T_WHITESPACE","\n                ",122],["T_BOOLEAN_AND","&&",123],["T_WHITESPACE"," ",123],["T_ISSET","isset",123],"(",["T_VARIABLE","$productsAndMessages",123],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",123],"]",")",")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n            ",123],["T_VARIABLE","$productsAndMessages",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_ARRAY","array",124],"(",["T_VARIABLE","$productsAndMessages",124],")",";",["T_WHITESPACE","\n        ",124],"}",["T_WHITESPACE","\n\n        ",125],["T_VARIABLE","$results",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_ARRAY","array",127],"(",")",";",["T_WHITESPACE","\n        ",127],["T_FOREACH","foreach",128],["T_WHITESPACE"," ",128],"(",["T_VARIABLE","$productsAndMessages",128],["T_WHITESPACE"," ",128],["T_AS","as",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$productAndMessage",128],")",["T_WHITESPACE"," ",128],"{",["T_WHITESPACE","\n            ",128],["T_IF","if",129],["T_WHITESPACE"," ",129],"(",["T_ISSET","isset",129],"(",["T_VARIABLE","$productAndMessage",129],"[",["T_CONSTANT_ENCAPSED_STRING","'product'",129],"]",")",["T_WHITESPACE"," ",129],["T_BOOLEAN_AND","&&",129],["T_WHITESPACE"," ",129],["T_ISSET","isset",129],"(",["T_VARIABLE","$productAndMessage",129],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",129],"]",")",")",["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n                ",129],["T_VARIABLE","$product",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","_prepareData",130],"(",["T_VARIABLE","$productAndMessage",130],"[",["T_CONSTANT_ENCAPSED_STRING","'product'",130],"]",")",";",["T_WHITESPACE","\n                ",130],["T_IF","if",131],["T_WHITESPACE"," ",131],"(",["T_EMPTY","empty",131],"(",["T_VARIABLE","$product",131],")",")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n                    ",131],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","_fault",132],"(",["T_CONSTANT_ENCAPSED_STRING","'product_invalid_data'",132],")",";",["T_WHITESPACE","\n                ",132],"}",["T_WHITESPACE","\n                ",133],["T_VARIABLE","$message",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","_prepareData",134],"(",["T_VARIABLE","$productAndMessage",134],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",134],"]",")",";",["T_WHITESPACE","\n                ",134],["T_IF","if",135],["T_WHITESPACE"," ",135],"(",["T_EMPTY","empty",135],"(",["T_VARIABLE","$message",135],")",")",["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n                    ",135],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","_fault",136],"(",["T_CONSTANT_ENCAPSED_STRING","'giftmessage_invalid_data'",136],")",";",["T_WHITESPACE","\n                ",136],"}",["T_WHITESPACE","\n\n                ",137],["T_IF","if",139],["T_WHITESPACE"," ",139],"(",["T_ISSET","isset",139],"(",["T_VARIABLE","$product",139],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",139],"]",")",")",["T_WHITESPACE"," ",139],"{",["T_WHITESPACE","\n                    ",139],["T_VARIABLE","$productByItem",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","_getProduct",140],"(",["T_VARIABLE","$product",140],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",140],"]",",",["T_WHITESPACE"," ",140],["T_VARIABLE","$store",140],",",["T_WHITESPACE"," ",140],["T_CONSTANT_ENCAPSED_STRING","\"id\"",140],")",";",["T_WHITESPACE","\n                ",140],"}",["T_WHITESPACE"," ",141],["T_ELSEIF","elseif",141],["T_WHITESPACE"," ",141],"(",["T_ISSET","isset",141],"(",["T_VARIABLE","$product",141],"[",["T_CONSTANT_ENCAPSED_STRING","'sku'",141],"]",")",")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n                    ",141],["T_VARIABLE","$productByItem",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","_getProduct",142],"(",["T_VARIABLE","$product",142],"[",["T_CONSTANT_ENCAPSED_STRING","'sku'",142],"]",",",["T_WHITESPACE"," ",142],["T_VARIABLE","$store",142],",",["T_WHITESPACE"," ",142],["T_CONSTANT_ENCAPSED_STRING","\"sku\"",142],")",";",["T_WHITESPACE","\n                ",142],"}",["T_WHITESPACE"," ",143],["T_ELSE","else",143],["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n                    ",143],["T_CONTINUE","continue",144],";",["T_WHITESPACE","\n                ",144],"}",["T_WHITESPACE","\n\n                ",145],["T_VARIABLE","$productObj",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","_getProductRequest",147],"(",["T_VARIABLE","$product",147],")",";",["T_WHITESPACE","\n                ",147],["T_VARIABLE","$quoteItem",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","_getQuoteItemByProduct",148],"(",["T_VARIABLE","$quote",148],",",["T_WHITESPACE"," ",148],["T_VARIABLE","$productByItem",148],",",["T_WHITESPACE"," ",148],["T_VARIABLE","$productObj",148],")",";",["T_WHITESPACE","\n                ",148],["T_VARIABLE","$results",149],"[","]",["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","setForQuoteItem",149],"(",["T_VARIABLE","$quoteItem",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","getId",149],"(",")",",",["T_WHITESPACE"," ",149],["T_VARIABLE","$message",149],",",["T_WHITESPACE"," ",149],["T_VARIABLE","$store",149],")",";",["T_WHITESPACE","\n            ",149],"}",["T_WHITESPACE","\n        ",150],"}",["T_WHITESPACE","\n\n        ",151],["T_RETURN","return",153],["T_WHITESPACE"," ",153],["T_VARIABLE","$results",153],";",["T_WHITESPACE","\n    ",153],"}",["T_WHITESPACE","\n\n    ",154],["T_DOC_COMMENT","\/**\n     * Set GiftMessage for a QuoteItem by its Id.\n     *\n     * @param String $quoteItemId\n     * @param AssociativeArray $giftMessage\n     * @param String $store\n     * @return AssociativeArray\n     *\/",156],["T_WHITESPACE","\n    ",163],["T_PUBLIC","public",164],["T_WHITESPACE"," ",164],["T_FUNCTION","function",164],["T_WHITESPACE"," ",164],["T_STRING","setForQuoteItem",164],"(",["T_VARIABLE","$quoteItemId",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$giftMessage",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$store",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_STRING","null",164],")",["T_WHITESPACE","\n    ",164],"{",["T_WHITESPACE","\n        ",165],["T_DOC_COMMENT","\/** @var $quote Mage_Sales_Model_Quote_Item *\/",166],["T_WHITESPACE","\n        ",166],["T_VARIABLE","$quoteItem",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_STRING","Mage",167],["T_DOUBLE_COLON","::",167],["T_STRING","getModel",167],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/quote_item'",167],")",["T_OBJECT_OPERATOR","->",167],["T_STRING","load",167],"(",["T_VARIABLE","$quoteItemId",167],")",";",["T_WHITESPACE","\n        ",167],["T_IF","if",168],["T_WHITESPACE"," ",168],"(",["T_STRING","is_null",168],"(",["T_VARIABLE","$quoteItem",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","getId",168],"(",")",")",")",["T_WHITESPACE"," ",168],"{",["T_WHITESPACE","\n            ",168],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","_fault",169],"(",["T_CONSTANT_ENCAPSED_STRING","\"quote_item_not_exists\"",169],")",";",["T_WHITESPACE","\n        ",169],"}",["T_WHITESPACE","\n\n        ",170],["T_DOC_COMMENT","\/** @var $quote Mage_Sales_Model_Quote *\/",172],["T_WHITESPACE","\n        ",172],["T_VARIABLE","$quote",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","_getQuote",173],"(",["T_VARIABLE","$quoteItem",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","getQuoteId",173],"(",")",",",["T_WHITESPACE"," ",173],["T_VARIABLE","$store",173],")",";",["T_WHITESPACE","\n\n        ",173],["T_VARIABLE","$giftMessage",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","_prepareData",175],"(",["T_VARIABLE","$giftMessage",175],")",";",["T_WHITESPACE","\n        ",175],["T_VARIABLE","$giftMessage",176],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",176],"]",["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_CONSTANT_ENCAPSED_STRING","'quote_item'",176],";",["T_WHITESPACE","\n\n        ",176],["T_VARIABLE","$giftMessages",178],["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_ARRAY","array",178],"(",["T_VARIABLE","$quoteItem",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","getId",178],"(",")",["T_WHITESPACE"," ",178],["T_DOUBLE_ARROW","=>",178],["T_WHITESPACE"," ",178],["T_VARIABLE","$giftMessage",178],")",";",["T_WHITESPACE","\n\n        ",178],["T_VARIABLE","$request",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_NEW","new",180],["T_WHITESPACE"," ",180],["T_STRING","Mage_Core_Controller_Request_Http",180],"(",")",";",["T_WHITESPACE","\n        ",180],["T_VARIABLE","$request",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","setParam",181],"(",["T_CONSTANT_ENCAPSED_STRING","\"giftmessage\"",181],",",["T_WHITESPACE"," ",181],["T_VARIABLE","$giftMessages",181],")",";",["T_WHITESPACE","\n\n        ",181],["T_RETURN","return",183],["T_WHITESPACE"," ",183],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","_setGiftMessage",183],"(",["T_VARIABLE","$quoteItemId",183],",",["T_WHITESPACE"," ",183],["T_VARIABLE","$request",183],",",["T_WHITESPACE"," ",183],["T_VARIABLE","$quote",183],")",";",["T_WHITESPACE","\n    ",183],"}",["T_WHITESPACE","\n",184],"}",["T_WHITESPACE","\n",185]]