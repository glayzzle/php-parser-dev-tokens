[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_GiftMessage\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Gift Message helper\n *\n * @category   Mage\n * @package    Mage_GiftMessage\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_GiftMessage_Helper_Message",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Helper_Data",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Giftmessages allow section in configuration\n     *\n     *\/",37],["T_WHITESPACE","\n    ",40],["T_CONST","const",41],["T_WHITESPACE"," ",41],["T_STRING","XPATH_CONFIG_GIFT_MESSAGE_ALLOW_ITEMS",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'sales\/gift_options\/allow_items'",41],";",["T_WHITESPACE","\n    ",41],["T_CONST","const",42],["T_WHITESPACE"," ",42],["T_STRING","XPATH_CONFIG_GIFT_MESSAGE_ALLOW_ORDER",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'sales\/gift_options\/allow_order'",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Next id for edit gift message block\n     *\n     * @var integer\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_nextId",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_LNUMBER","0",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Inner cache\n     *\n     * @var array\n     *\/",51],["T_WHITESPACE","\n    ",55],["T_PROTECTED","protected",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$_innerCache",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_ARRAY","array",56],"(",")",";",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * Retrive old stule edit button html for editing of giftmessage in popup\n     *\n     * @param string $type\n     * @param Varien_Object $entity\n     * @return string\n     *\/",58],["T_WHITESPACE","\n    ",64],["T_PUBLIC","public",65],["T_WHITESPACE"," ",65],["T_FUNCTION","function",65],["T_WHITESPACE"," ",65],["T_STRING","getButton",65],"(",["T_VARIABLE","$type",65],",",["T_WHITESPACE"," ",65],["T_STRING","Varien_Object",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$entity",65],")",["T_WHITESPACE","\n    ",65],"{",["T_WHITESPACE","\n        ",66],["T_IF","if",67],["T_WHITESPACE"," ",67],"(","!",["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","isMessagesAvailable",67],"(",["T_VARIABLE","$type",67],",",["T_WHITESPACE"," ",67],["T_VARIABLE","$entity",67],")",")",["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n            ",67],["T_RETURN","return",68],["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'&nbsp;'",68],";",["T_WHITESPACE","\n        ",68],"}",["T_WHITESPACE","\n\n        ",69],["T_RETURN","return",71],["T_WHITESPACE"," ",71],["T_STRING","Mage",71],["T_DOUBLE_COLON","::",71],["T_STRING","getSingleton",71],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/layout'",71],")",["T_OBJECT_OPERATOR","->",71],["T_STRING","createBlock",71],"(",["T_CONSTANT_ENCAPSED_STRING","'giftmessage\/message_helper'",71],")",["T_WHITESPACE","\n            ",71],["T_OBJECT_OPERATOR","->",72],["T_STRING","setId",72],"(",["T_CONSTANT_ENCAPSED_STRING","'giftmessage_button_'",72],["T_WHITESPACE"," ",72],".",["T_WHITESPACE"," ",72],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","_nextId",72],["T_INC","++",72],")",["T_WHITESPACE","\n            ",72],["T_OBJECT_OPERATOR","->",73],["T_STRING","setCanDisplayContainer",73],"(",["T_STRING","true",73],")",["T_WHITESPACE","\n            ",73],["T_OBJECT_OPERATOR","->",74],["T_STRING","setEntity",74],"(",["T_VARIABLE","$entity",74],")",["T_WHITESPACE","\n            ",74],["T_OBJECT_OPERATOR","->",75],["T_STRING","setType",75],"(",["T_VARIABLE","$type",75],")",["T_OBJECT_OPERATOR","->",75],["T_STRING","toHtml",75],"(",")",";",["T_WHITESPACE","\n    ",75],"}",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * Retrive inline giftmessage edit form for specified entity\n     *\n     * @param string $type\n     * @param Varien_Object $entity\n     * @param boolean $dontDisplayContainer\n     * @return string\n     *\/",78],["T_WHITESPACE","\n    ",85],["T_PUBLIC","public",86],["T_WHITESPACE"," ",86],["T_FUNCTION","function",86],["T_WHITESPACE"," ",86],["T_STRING","getInline",86],"(",["T_VARIABLE","$type",86],",",["T_WHITESPACE"," ",86],["T_STRING","Varien_Object",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$entity",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$dontDisplayContainer",86],"=",["T_STRING","false",86],")",["T_WHITESPACE","\n    ",86],"{",["T_WHITESPACE","\n        ",87],["T_IF","if",88],["T_WHITESPACE"," ",88],"(","!",["T_STRING","in_array",88],"(",["T_VARIABLE","$type",88],",",["T_WHITESPACE"," ",88],["T_ARRAY","array",88],"(",["T_CONSTANT_ENCAPSED_STRING","'onepage_checkout'",88],",",["T_CONSTANT_ENCAPSED_STRING","'multishipping_adress'",88],")",")",["T_WHITESPACE","\n            ",88],["T_BOOLEAN_AND","&&",89],["T_WHITESPACE"," ",89],"!",["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","isMessagesAvailable",89],"(",["T_VARIABLE","$type",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$entity",89],")",["T_WHITESPACE","\n        ",89],")",["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n            ",90],["T_RETURN","return",91],["T_WHITESPACE"," ",91],["T_CONSTANT_ENCAPSED_STRING","''",91],";",["T_WHITESPACE","\n        ",91],"}",["T_WHITESPACE","\n\n        ",92],["T_RETURN","return",94],["T_WHITESPACE"," ",94],["T_STRING","Mage",94],["T_DOUBLE_COLON","::",94],["T_STRING","getSingleton",94],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/layout'",94],")",["T_OBJECT_OPERATOR","->",94],["T_STRING","createBlock",94],"(",["T_CONSTANT_ENCAPSED_STRING","'giftmessage\/message_inline'",94],")",["T_WHITESPACE","\n            ",94],["T_OBJECT_OPERATOR","->",95],["T_STRING","setId",95],"(",["T_CONSTANT_ENCAPSED_STRING","'giftmessage_form_'",95],["T_WHITESPACE"," ",95],".",["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","_nextId",95],["T_INC","++",95],")",["T_WHITESPACE","\n            ",95],["T_OBJECT_OPERATOR","->",96],["T_STRING","setDontDisplayContainer",96],"(",["T_VARIABLE","$dontDisplayContainer",96],")",["T_WHITESPACE","\n            ",96],["T_OBJECT_OPERATOR","->",97],["T_STRING","setEntity",97],"(",["T_VARIABLE","$entity",97],")",["T_WHITESPACE","\n            ",97],["T_OBJECT_OPERATOR","->",98],["T_STRING","setType",98],"(",["T_VARIABLE","$type",98],")",["T_OBJECT_OPERATOR","->",98],["T_STRING","toHtml",98],"(",")",";",["T_WHITESPACE","\n    ",98],"}",["T_WHITESPACE","\n\n    ",99],["T_DOC_COMMENT","\/**\n     * Check availability of giftmessages for specified entity.\n     *\n     * @param string $type\n     * @param Varien_Object $entity\n     * @param Mage_Core_Model_Store|integer $store\n     * @return boolean\n     *\/",101],["T_WHITESPACE","\n    ",108],["T_PUBLIC","public",109],["T_WHITESPACE"," ",109],["T_FUNCTION","function",109],["T_WHITESPACE"," ",109],["T_STRING","isMessagesAvailable",109],"(",["T_VARIABLE","$type",109],",",["T_WHITESPACE"," ",109],["T_STRING","Varien_Object",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$entity",109],",",["T_WHITESPACE"," ",109],["T_VARIABLE","$store",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_STRING","null",109],")",["T_WHITESPACE","\n    ",109],"{",["T_WHITESPACE","\n        ",110],["T_IF","if",111],["T_WHITESPACE"," ",111],"(",["T_VARIABLE","$type",111],["T_WHITESPACE"," ",111],["T_IS_EQUAL","==",111],["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","'items'",111],")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n            ",111],["T_VARIABLE","$items",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$entity",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","getAllItems",112],"(",")",";",["T_WHITESPACE","\n            ",112],["T_IF","if",113],"(","!",["T_STRING","is_array",113],"(",["T_VARIABLE","$items",113],")",["T_WHITESPACE"," ",113],["T_BOOLEAN_OR","||",113],["T_WHITESPACE"," ",113],["T_EMPTY","empty",113],"(",["T_VARIABLE","$items",113],")",")",["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n                ",113],["T_RETURN","return",114],["T_WHITESPACE"," ",114],["T_STRING","Mage",114],["T_DOUBLE_COLON","::",114],["T_STRING","getStoreConfig",114],"(",["T_STRING","self",114],["T_DOUBLE_COLON","::",114],["T_STRING","XPATH_CONFIG_GIFT_MESSAGE_ALLOW_ITEMS",114],",",["T_WHITESPACE"," ",114],["T_VARIABLE","$store",114],")",";",["T_WHITESPACE","\n            ",114],"}",["T_WHITESPACE","\n            ",115],["T_IF","if",116],"(",["T_VARIABLE","$entity",116],["T_WHITESPACE"," ",116],["T_INSTANCEOF","instanceof",116],["T_WHITESPACE"," ",116],["T_STRING","Mage_Sales_Model_Quote",116],")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n                ",116],["T_VARIABLE","$_type",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_VARIABLE","$entity",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getIsMultiShipping",117],"(",")",["T_WHITESPACE"," ",117],"?",["T_WHITESPACE"," ",117],["T_CONSTANT_ENCAPSED_STRING","'address_item'",117],["T_WHITESPACE"," ",117],":",["T_WHITESPACE"," ",117],["T_CONSTANT_ENCAPSED_STRING","'item'",117],";",["T_WHITESPACE","\n            ",117],"}",["T_WHITESPACE","\n            ",118],["T_ELSE","else",119],["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n                ",119],["T_VARIABLE","$_type",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_CONSTANT_ENCAPSED_STRING","'order_item'",120],";",["T_WHITESPACE","\n            ",120],"}",["T_WHITESPACE","\n\n            ",121],["T_FOREACH","foreach",123],["T_WHITESPACE"," ",123],"(",["T_VARIABLE","$items",123],["T_WHITESPACE"," ",123],["T_AS","as",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$item",123],")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n                ",123],["T_IF","if",124],["T_WHITESPACE"," ",124],"(",["T_VARIABLE","$item",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","getParentItem",124],"(",")",")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n                    ",124],["T_CONTINUE","continue",125],";",["T_WHITESPACE","\n                ",125],"}",["T_WHITESPACE","\n                ",126],["T_IF","if",127],["T_WHITESPACE"," ",127],"(",["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","isMessagesAvailable",127],"(",["T_VARIABLE","$_type",127],",",["T_WHITESPACE"," ",127],["T_VARIABLE","$item",127],",",["T_WHITESPACE"," ",127],["T_VARIABLE","$store",127],")",")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n                    ",127],["T_RETURN","return",128],["T_WHITESPACE"," ",128],["T_STRING","true",128],";",["T_WHITESPACE","\n                ",128],"}",["T_WHITESPACE","\n            ",129],"}",["T_WHITESPACE","\n        ",130],"}",["T_WHITESPACE"," ",131],["T_ELSEIF","elseif",131],["T_WHITESPACE"," ",131],"(",["T_VARIABLE","$type",131],["T_WHITESPACE"," ",131],["T_IS_EQUAL","==",131],["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","'item'",131],")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n            ",131],["T_RETURN","return",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","_getDependenceFromStoreConfig",132],"(",["T_WHITESPACE","\n                ",132],["T_VARIABLE","$entity",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getProduct",133],"(",")",["T_OBJECT_OPERATOR","->",133],["T_STRING","getGiftMessageAvailable",133],"(",")",",",["T_WHITESPACE","\n                ",133],["T_VARIABLE","$store",134],["T_WHITESPACE","\n            ",134],")",";",["T_WHITESPACE","\n        ",135],"}",["T_WHITESPACE"," ",136],["T_ELSEIF","elseif",136],["T_WHITESPACE"," ",136],"(",["T_VARIABLE","$type",136],["T_WHITESPACE"," ",136],["T_IS_EQUAL","==",136],["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","'order_item'",136],")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n            ",136],["T_RETURN","return",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","_getDependenceFromStoreConfig",137],"(",["T_WHITESPACE","\n                ",137],["T_VARIABLE","$entity",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","getGiftMessageAvailable",138],"(",")",",",["T_WHITESPACE","\n                ",138],["T_VARIABLE","$store",139],["T_WHITESPACE","\n            ",139],")",";",["T_WHITESPACE","\n        ",140],"}",["T_WHITESPACE"," ",141],["T_ELSEIF","elseif",141],["T_WHITESPACE"," ",141],"(",["T_VARIABLE","$type",141],["T_WHITESPACE"," ",141],["T_IS_EQUAL","==",141],["T_WHITESPACE"," ",141],["T_CONSTANT_ENCAPSED_STRING","'address_item'",141],")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n            ",141],["T_VARIABLE","$storeId",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_STRING","is_numeric",142],"(",["T_VARIABLE","$store",142],")",["T_WHITESPACE"," ",142],"?",["T_WHITESPACE"," ",142],["T_VARIABLE","$store",142],["T_WHITESPACE"," ",142],":",["T_WHITESPACE"," ",142],["T_STRING","Mage",142],["T_DOUBLE_COLON","::",142],["T_STRING","app",142],"(",")",["T_OBJECT_OPERATOR","->",142],["T_STRING","getStore",142],"(",["T_VARIABLE","$store",142],")",["T_OBJECT_OPERATOR","->",142],["T_STRING","getId",142],"(",")",";",["T_WHITESPACE","\n\n            ",142],["T_IF","if",144],["T_WHITESPACE"," ",144],"(","!",["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","isCached",144],"(",["T_CONSTANT_ENCAPSED_STRING","'address_item_'",144],["T_WHITESPACE"," ",144],".",["T_WHITESPACE"," ",144],["T_VARIABLE","$entity",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","getProductId",144],"(",")",")",")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n                ",144],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","setCached",145],"(",["T_WHITESPACE","\n                    ",145],["T_CONSTANT_ENCAPSED_STRING","'address_item_'",146],["T_WHITESPACE"," ",146],".",["T_WHITESPACE"," ",146],["T_VARIABLE","$entity",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","getProductId",146],"(",")",",",["T_WHITESPACE","\n                    ",146],["T_STRING","Mage",147],["T_DOUBLE_COLON","::",147],["T_STRING","getModel",147],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",147],")",["T_WHITESPACE","\n                        ",147],["T_OBJECT_OPERATOR","->",148],["T_STRING","setStoreId",148],"(",["T_VARIABLE","$storeId",148],")",["T_WHITESPACE","\n                        ",148],["T_OBJECT_OPERATOR","->",149],["T_STRING","load",149],"(",["T_VARIABLE","$entity",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","getProductId",149],"(",")",")",["T_WHITESPACE","\n                        ",149],["T_OBJECT_OPERATOR","->",150],["T_STRING","getGiftMessageAvailable",150],"(",")",["T_WHITESPACE","\n                ",150],")",";",["T_WHITESPACE","\n            ",151],"}",["T_WHITESPACE","\n            ",152],["T_RETURN","return",153],["T_WHITESPACE"," ",153],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","_getDependenceFromStoreConfig",153],"(",["T_WHITESPACE","\n                ",153],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","getCached",154],"(",["T_CONSTANT_ENCAPSED_STRING","'address_item_'",154],["T_WHITESPACE"," ",154],".",["T_WHITESPACE"," ",154],["T_VARIABLE","$entity",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","getProductId",154],"(",")",")",",",["T_WHITESPACE","\n                ",154],["T_VARIABLE","$store",155],["T_WHITESPACE","\n            ",155],")",";",["T_WHITESPACE","\n        ",156],"}",["T_WHITESPACE"," ",157],["T_ELSE","else",157],["T_WHITESPACE"," ",157],"{",["T_WHITESPACE","\n            ",157],["T_RETURN","return",158],["T_WHITESPACE"," ",158],["T_STRING","Mage",158],["T_DOUBLE_COLON","::",158],["T_STRING","getStoreConfig",158],"(",["T_STRING","self",158],["T_DOUBLE_COLON","::",158],["T_STRING","XPATH_CONFIG_GIFT_MESSAGE_ALLOW_ORDER",158],",",["T_WHITESPACE"," ",158],["T_VARIABLE","$store",158],")",";",["T_WHITESPACE","\n        ",158],"}",["T_WHITESPACE","\n\n        ",159],["T_RETURN","return",161],["T_WHITESPACE"," ",161],["T_STRING","false",161],";",["T_WHITESPACE","\n    ",161],"}",["T_WHITESPACE","\n\n    ",162],["T_DOC_COMMENT","\/**\n     * Check availablity of gift messages from store config if flag eq 2.\n     *\n     * @param int $productGiftMessageAllow\n     * @param Mage_Core_Model_Store|integer $store\n     * @return boolean\n     *\/",164],["T_WHITESPACE","\n    ",170],["T_PROTECTED","protected",171],["T_WHITESPACE"," ",171],["T_FUNCTION","function",171],["T_WHITESPACE"," ",171],["T_STRING","_getDependenceFromStoreConfig",171],"(",["T_VARIABLE","$productGiftMessageAllow",171],",",["T_WHITESPACE"," ",171],["T_VARIABLE","$store",171],"=",["T_STRING","null",171],")",["T_WHITESPACE","\n    ",171],"{",["T_WHITESPACE","\n        ",172],["T_VARIABLE","$result",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_STRING","Mage",173],["T_DOUBLE_COLON","::",173],["T_STRING","getStoreConfig",173],"(",["T_STRING","self",173],["T_DOUBLE_COLON","::",173],["T_STRING","XPATH_CONFIG_GIFT_MESSAGE_ALLOW_ITEMS",173],",",["T_WHITESPACE"," ",173],["T_VARIABLE","$store",173],")",";",["T_WHITESPACE","\n        ",173],["T_IF","if",174],["T_WHITESPACE"," ",174],"(",["T_VARIABLE","$productGiftMessageAllow",174],["T_WHITESPACE"," ",174],["T_IS_IDENTICAL","===",174],["T_WHITESPACE"," ",174],["T_CONSTANT_ENCAPSED_STRING","''",174],["T_WHITESPACE"," ",174],["T_BOOLEAN_OR","||",174],["T_WHITESPACE"," ",174],["T_STRING","is_null",174],"(",["T_VARIABLE","$productGiftMessageAllow",174],")",")",["T_WHITESPACE"," ",174],"{",["T_WHITESPACE","\n            ",174],["T_RETURN","return",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$result",175],";",["T_WHITESPACE","\n        ",175],"}",["T_WHITESPACE"," ",176],["T_ELSE","else",176],["T_WHITESPACE"," ",176],"{",["T_WHITESPACE","\n            ",176],["T_RETURN","return",177],["T_WHITESPACE"," ",177],["T_VARIABLE","$productGiftMessageAllow",177],";",["T_WHITESPACE","\n        ",177],"}",["T_WHITESPACE","\n    ",178],"}",["T_WHITESPACE","\n\n    ",179],["T_DOC_COMMENT","\/**\n     * Alias for isMessagesAvailable(...)\n     *\n     * @param string $type\n     * @param Varien_Object $entity\n     * @param Mage_Core_Model_Store|integer $store\n     * @return boolen\n     *\/",181],["T_WHITESPACE","\n    ",188],["T_PUBLIC","public",189],["T_WHITESPACE"," ",189],["T_FUNCTION","function",189],["T_WHITESPACE"," ",189],["T_STRING","getIsMessagesAvailable",189],"(",["T_VARIABLE","$type",189],",",["T_WHITESPACE"," ",189],["T_STRING","Varien_Object",189],["T_WHITESPACE"," ",189],["T_VARIABLE","$entity",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$store",189],"=",["T_STRING","null",189],")",["T_WHITESPACE","\n    ",189],"{",["T_WHITESPACE","\n        ",190],["T_RETURN","return",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","isMessagesAvailable",191],"(",["T_VARIABLE","$type",191],",",["T_WHITESPACE"," ",191],["T_VARIABLE","$entity",191],",",["T_WHITESPACE"," ",191],["T_VARIABLE","$store",191],")",";",["T_WHITESPACE","\n    ",191],"}",["T_WHITESPACE","\n\n    ",192],["T_DOC_COMMENT","\/**\n     * Retrive escaped and preformated gift message text for specified entity\n     *\n     * @param Varien_Object $entity\n     * @return unknown\n     *\/",194],["T_WHITESPACE","\n    ",199],["T_PUBLIC","public",200],["T_WHITESPACE"," ",200],["T_FUNCTION","function",200],["T_WHITESPACE"," ",200],["T_STRING","getEscapedGiftMessage",200],"(",["T_STRING","Varien_Object",200],["T_WHITESPACE"," ",200],["T_VARIABLE","$entity",200],")",["T_WHITESPACE","\n    ",200],"{",["T_WHITESPACE","\n        ",201],["T_VARIABLE","$message",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","getGiftMessageForEntity",202],"(",["T_VARIABLE","$entity",202],")",";",["T_WHITESPACE","\n        ",202],["T_IF","if",203],["T_WHITESPACE"," ",203],"(",["T_VARIABLE","$message",203],")",["T_WHITESPACE"," ",203],"{",["T_WHITESPACE","\n            ",203],["T_RETURN","return",204],["T_WHITESPACE"," ",204],["T_STRING","nl2br",204],"(",["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","escapeHtml",204],"(",["T_VARIABLE","$message",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","getMessage",204],"(",")",")",")",";",["T_WHITESPACE","\n        ",204],"}",["T_WHITESPACE","\n        ",205],["T_RETURN","return",206],["T_WHITESPACE"," ",206],["T_STRING","null",206],";",["T_WHITESPACE","\n    ",206],"}",["T_WHITESPACE","\n\n    ",207],["T_DOC_COMMENT","\/**\n     * Retrive gift message for entity. If message not exists return null\n     *\n     * @param Varien_Object $entity\n     * @return Mage_GiftMessage_Model_Message\n     *\/",209],["T_WHITESPACE","\n    ",214],["T_PUBLIC","public",215],["T_WHITESPACE"," ",215],["T_FUNCTION","function",215],["T_WHITESPACE"," ",215],["T_STRING","getGiftMessageForEntity",215],"(",["T_STRING","Varien_Object",215],["T_WHITESPACE"," ",215],["T_VARIABLE","$entity",215],")",["T_WHITESPACE","\n    ",215],"{",["T_WHITESPACE","\n        ",216],["T_IF","if",217],"(",["T_VARIABLE","$entity",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","getGiftMessageId",217],"(",")",["T_WHITESPACE"," ",217],["T_BOOLEAN_AND","&&",217],["T_WHITESPACE"," ",217],"!",["T_VARIABLE","$entity",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","getGiftMessage",217],"(",")",")",["T_WHITESPACE"," ",217],"{",["T_WHITESPACE","\n            ",217],["T_VARIABLE","$message",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","getGiftMessage",218],"(",["T_VARIABLE","$entity",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","getGiftMessageId",218],"(",")",")",";",["T_WHITESPACE","\n            ",218],["T_VARIABLE","$entity",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","setGiftMessage",219],"(",["T_VARIABLE","$message",219],")",";",["T_WHITESPACE","\n        ",219],"}",["T_WHITESPACE","\n        ",220],["T_RETURN","return",221],["T_WHITESPACE"," ",221],["T_VARIABLE","$entity",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","getGiftMessage",221],"(",")",";",["T_WHITESPACE","\n    ",221],"}",["T_WHITESPACE","\n\n    ",222],["T_DOC_COMMENT","\/**\n     * Retrive internal cached data with specified key.\n     *\n     * If cached data not found return null.\n     *\n     * @param string $key\n     * @return mixed|null\n     *\/",224],["T_WHITESPACE","\n    ",231],["T_PUBLIC","public",232],["T_WHITESPACE"," ",232],["T_FUNCTION","function",232],["T_WHITESPACE"," ",232],["T_STRING","getCached",232],"(",["T_VARIABLE","$key",232],")",["T_WHITESPACE","\n    ",232],"{",["T_WHITESPACE","\n        ",233],["T_IF","if",234],"(",["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","isCached",234],"(",["T_VARIABLE","$key",234],")",")",["T_WHITESPACE"," ",234],"{",["T_WHITESPACE","\n            ",234],["T_RETURN","return",235],["T_WHITESPACE"," ",235],["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","_innerCache",235],"[",["T_VARIABLE","$key",235],"]",";",["T_WHITESPACE","\n        ",235],"}",["T_WHITESPACE","\n\n        ",236],["T_RETURN","return",238],["T_WHITESPACE"," ",238],["T_STRING","null",238],";",["T_WHITESPACE","\n    ",238],"}",["T_WHITESPACE","\n\n    ",239],["T_DOC_COMMENT","\/**\n     * Check availability for internal cached data with specified key\n     *\n     * @param string $key\n     * @return boolean\n     *\/",241],["T_WHITESPACE","\n    ",246],["T_PUBLIC","public",247],["T_WHITESPACE"," ",247],["T_FUNCTION","function",247],["T_WHITESPACE"," ",247],["T_STRING","isCached",247],"(",["T_VARIABLE","$key",247],")",["T_WHITESPACE","\n    ",247],"{",["T_WHITESPACE","\n        ",248],["T_RETURN","return",249],["T_WHITESPACE"," ",249],["T_ISSET","isset",249],"(",["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","_innerCache",249],"[",["T_VARIABLE","$key",249],"]",")",";",["T_WHITESPACE","\n    ",249],"}",["T_WHITESPACE","\n\n    ",250],["T_DOC_COMMENT","\/**\n     * Set internal cache data with specified key\n     *\n     * @param string $key\n     * @param mixed $value\n     * @return Mage_GiftMessage_Helper_Message\n     *\/",252],["T_WHITESPACE","\n    ",258],["T_PUBLIC","public",259],["T_WHITESPACE"," ",259],["T_FUNCTION","function",259],["T_WHITESPACE"," ",259],["T_STRING","setCached",259],"(",["T_VARIABLE","$key",259],",",["T_WHITESPACE"," ",259],["T_VARIABLE","$value",259],")",["T_WHITESPACE","\n    ",259],"{",["T_WHITESPACE","\n        ",260],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","_innerCache",261],"[",["T_VARIABLE","$key",261],"]",["T_WHITESPACE"," ",261],"=",["T_WHITESPACE"," ",261],["T_VARIABLE","$value",261],";",["T_WHITESPACE","\n        ",261],["T_RETURN","return",262],["T_WHITESPACE"," ",262],["T_VARIABLE","$this",262],";",["T_WHITESPACE","\n    ",262],"}",["T_WHITESPACE","\n\n    ",263],["T_DOC_COMMENT","\/**\n     * Check availability for onepage checkout items\n     *\n     * @param array $items\n     * @param Mage_Core_Model_Store|integer $store\n     * @return boolen\n     *\/",265],["T_WHITESPACE","\n    ",271],["T_PUBLIC","public",272],["T_WHITESPACE"," ",272],["T_FUNCTION","function",272],["T_WHITESPACE"," ",272],["T_STRING","getAvailableForQuoteItems",272],"(",["T_VARIABLE","$quote",272],",",["T_WHITESPACE"," ",272],["T_VARIABLE","$store",272],"=",["T_STRING","null",272],")",["T_WHITESPACE","\n    ",272],"{",["T_WHITESPACE","\n        ",273],["T_FOREACH","foreach",274],"(",["T_VARIABLE","$quote",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","getAllItems",274],"(",")",["T_WHITESPACE"," ",274],["T_AS","as",274],["T_WHITESPACE"," ",274],["T_VARIABLE","$item",274],")",["T_WHITESPACE"," ",274],"{",["T_WHITESPACE","\n            ",274],["T_IF","if",275],"(",["T_VARIABLE","$this",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","isMessagesAvailable",275],"(",["T_CONSTANT_ENCAPSED_STRING","'item'",275],",",["T_WHITESPACE"," ",275],["T_VARIABLE","$item",275],",",["T_WHITESPACE"," ",275],["T_VARIABLE","$store",275],")",")",["T_WHITESPACE"," ",275],"{",["T_WHITESPACE","\n                ",275],["T_RETURN","return",276],["T_WHITESPACE"," ",276],["T_STRING","true",276],";",["T_WHITESPACE","\n            ",276],"}",["T_WHITESPACE","\n        ",277],"}",["T_WHITESPACE","\n\n        ",278],["T_RETURN","return",280],["T_WHITESPACE"," ",280],["T_STRING","false",280],";",["T_WHITESPACE","\n    ",280],"}",["T_WHITESPACE","\n\n    ",281],["T_DOC_COMMENT","\/**\n     * Check availability for multishiping checkout items\n     *\n     * @param array $items\n     * @param Mage_Core_Model_Store|integer $store\n     * @return boolen\n     *\/",283],["T_WHITESPACE","\n    ",289],["T_PUBLIC","public",290],["T_WHITESPACE"," ",290],["T_FUNCTION","function",290],["T_WHITESPACE"," ",290],["T_STRING","getAvailableForAddressItems",290],"(",["T_VARIABLE","$items",290],",",["T_WHITESPACE"," ",290],["T_VARIABLE","$store",290],"=",["T_STRING","null",290],")",["T_WHITESPACE","\n    ",290],"{",["T_WHITESPACE","\n        ",291],["T_FOREACH","foreach",292],"(",["T_VARIABLE","$items",292],["T_WHITESPACE"," ",292],["T_AS","as",292],["T_WHITESPACE"," ",292],["T_VARIABLE","$item",292],")",["T_WHITESPACE"," ",292],"{",["T_WHITESPACE","\n            ",292],["T_IF","if",293],"(",["T_VARIABLE","$this",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","isMessagesAvailable",293],"(",["T_CONSTANT_ENCAPSED_STRING","'address_item'",293],",",["T_WHITESPACE"," ",293],["T_VARIABLE","$item",293],",",["T_WHITESPACE"," ",293],["T_VARIABLE","$store",293],")",")",["T_WHITESPACE"," ",293],"{",["T_WHITESPACE","\n                ",293],["T_RETURN","return",294],["T_WHITESPACE"," ",294],["T_STRING","true",294],";",["T_WHITESPACE","\n            ",294],"}",["T_WHITESPACE","\n        ",295],"}",["T_WHITESPACE","\n        ",296],["T_RETURN","return",297],["T_WHITESPACE"," ",297],["T_STRING","false",297],";",["T_WHITESPACE","\n    ",297],"}",["T_WHITESPACE","\n\n    ",298],["T_DOC_COMMENT","\/**\n     * Retrive gift message with specified id\n     *\n     * @param integer $messageId\n     * @return Mage_GiftMessage_Model_Message\n     *\/",300],["T_WHITESPACE","\n    ",305],["T_PUBLIC","public",306],["T_WHITESPACE"," ",306],["T_FUNCTION","function",306],["T_WHITESPACE"," ",306],["T_STRING","getGiftMessage",306],"(",["T_VARIABLE","$messageId",306],"=",["T_STRING","null",306],")",["T_WHITESPACE","\n    ",306],"{",["T_WHITESPACE","\n        ",307],["T_VARIABLE","$message",308],["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],["T_STRING","Mage",308],["T_DOUBLE_COLON","::",308],["T_STRING","getModel",308],"(",["T_CONSTANT_ENCAPSED_STRING","'giftmessage\/message'",308],")",";",["T_WHITESPACE","\n        ",308],["T_IF","if",309],"(","!",["T_STRING","is_null",309],"(",["T_VARIABLE","$messageId",309],")",")",["T_WHITESPACE"," ",309],"{",["T_WHITESPACE","\n            ",309],["T_VARIABLE","$message",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","load",310],"(",["T_VARIABLE","$messageId",310],")",";",["T_WHITESPACE","\n        ",310],"}",["T_WHITESPACE","\n\n        ",311],["T_RETURN","return",313],["T_WHITESPACE"," ",313],["T_VARIABLE","$message",313],";",["T_WHITESPACE","\n    ",313],"}",["T_WHITESPACE","\n\n",314],"}",["T_WHITESPACE","\n",316]]