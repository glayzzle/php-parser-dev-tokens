[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_AdminNotification\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * AdminNotification Feed model\n *\n * @category   Mage\n * @package    Mage_AdminNotification\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_AdminNotification_Model_Feed",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Model_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_CONST","const",37],["T_WHITESPACE"," ",37],["T_STRING","XML_USE_HTTPS_PATH",37],["T_WHITESPACE","    ",37],"=",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'system\/adminnotification\/use_https'",37],";",["T_WHITESPACE","\n    ",37],["T_CONST","const",38],["T_WHITESPACE"," ",38],["T_STRING","XML_FEED_URL_PATH",38],["T_WHITESPACE","     ",38],"=",["T_WHITESPACE"," ",38],["T_CONSTANT_ENCAPSED_STRING","'system\/adminnotification\/feed_url'",38],";",["T_WHITESPACE","\n    ",38],["T_CONST","const",39],["T_WHITESPACE"," ",39],["T_STRING","XML_FREQUENCY_PATH",39],["T_WHITESPACE","    ",39],"=",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'system\/adminnotification\/frequency'",39],";",["T_WHITESPACE","\n    ",39],["T_CONST","const",40],["T_WHITESPACE"," ",40],["T_STRING","XML_LAST_UPDATE_PATH",40],["T_WHITESPACE","  ",40],"=",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'system\/adminnotification\/last_update'",40],";",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/**\n     * Feed url\n     *\n     * @var string\n     *\/",42],["T_WHITESPACE","\n    ",46],["T_PROTECTED","protected",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$_feedUrl",47],";",["T_WHITESPACE","\n\n    ",47],["T_DOC_COMMENT","\/**\n     * Init model\n     *\n     *\/",49],["T_WHITESPACE","\n    ",52],["T_PROTECTED","protected",53],["T_WHITESPACE"," ",53],["T_FUNCTION","function",53],["T_WHITESPACE"," ",53],["T_STRING","_construct",53],"(",")",["T_WHITESPACE","\n    ",53],"{","}",["T_WHITESPACE","\n\n    ",54],["T_DOC_COMMENT","\/**\n     * Retrieve feed url\n     *\n     * @return string\n     *\/",56],["T_WHITESPACE","\n    ",60],["T_PUBLIC","public",61],["T_WHITESPACE"," ",61],["T_FUNCTION","function",61],["T_WHITESPACE"," ",61],["T_STRING","getFeedUrl",61],"(",")",["T_WHITESPACE","\n    ",61],"{",["T_WHITESPACE","\n        ",62],["T_IF","if",63],["T_WHITESPACE"," ",63],"(",["T_STRING","is_null",63],"(",["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","_feedUrl",63],")",")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n            ",63],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","_feedUrl",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],"(",["T_STRING","Mage",64],["T_DOUBLE_COLON","::",64],["T_STRING","getStoreConfigFlag",64],"(",["T_STRING","self",64],["T_DOUBLE_COLON","::",64],["T_STRING","XML_USE_HTTPS_PATH",64],")",["T_WHITESPACE"," ",64],"?",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/'",64],["T_WHITESPACE"," ",64],":",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/'",64],")",["T_WHITESPACE","\n                ",64],".",["T_WHITESPACE"," ",65],["T_STRING","Mage",65],["T_DOUBLE_COLON","::",65],["T_STRING","getStoreConfig",65],"(",["T_STRING","self",65],["T_DOUBLE_COLON","::",65],["T_STRING","XML_FEED_URL_PATH",65],")",";",["T_WHITESPACE","\n        ",65],"}",["T_WHITESPACE","\n        ",66],["T_RETURN","return",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","_feedUrl",67],";",["T_WHITESPACE","\n    ",67],"}",["T_WHITESPACE","\n\n    ",68],["T_DOC_COMMENT","\/**\n     * Check feed for modification\n     *\n     * @return Mage_AdminNotification_Model_Feed\n     *\/",70],["T_WHITESPACE","\n    ",74],["T_PUBLIC","public",75],["T_WHITESPACE"," ",75],["T_FUNCTION","function",75],["T_WHITESPACE"," ",75],["T_STRING","checkUpdate",75],"(",")",["T_WHITESPACE","\n    ",75],"{",["T_WHITESPACE","\n        ",76],["T_IF","if",77],["T_WHITESPACE"," ",77],"(","(",["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getFrequency",77],"(",")",["T_WHITESPACE"," ",77],"+",["T_WHITESPACE"," ",77],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getLastUpdate",77],"(",")",")",["T_WHITESPACE"," ",77],">",["T_WHITESPACE"," ",77],["T_STRING","time",77],"(",")",")",["T_WHITESPACE"," ",77],"{",["T_WHITESPACE","\n            ",77],["T_RETURN","return",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$this",78],";",["T_WHITESPACE","\n        ",78],"}",["T_WHITESPACE","\n\n        ",79],["T_VARIABLE","$feedData",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_ARRAY","array",81],"(",")",";",["T_WHITESPACE","\n\n        ",81],["T_VARIABLE","$feedXml",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","getFeedData",83],"(",")",";",["T_WHITESPACE","\n\n        ",83],["T_IF","if",85],["T_WHITESPACE"," ",85],"(",["T_VARIABLE","$feedXml",85],["T_WHITESPACE"," ",85],["T_BOOLEAN_AND","&&",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$feedXml",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","channel",85],["T_WHITESPACE"," ",85],["T_BOOLEAN_AND","&&",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$feedXml",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","channel",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","item",85],")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n            ",85],["T_FOREACH","foreach",86],["T_WHITESPACE"," ",86],"(",["T_VARIABLE","$feedXml",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","channel",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","item",86],["T_WHITESPACE"," ",86],["T_AS","as",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$item",86],")",["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n                ",86],["T_VARIABLE","$feedData",87],"[","]",["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_ARRAY","array",87],"(",["T_WHITESPACE","\n                    ",87],["T_CONSTANT_ENCAPSED_STRING","'severity'",88],["T_WHITESPACE","      ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_INT_CAST","(int)",88],["T_VARIABLE","$item",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","severity",88],",",["T_WHITESPACE","\n                    ",88],["T_CONSTANT_ENCAPSED_STRING","'date_added'",89],["T_WHITESPACE","    ",89],["T_DOUBLE_ARROW","=>",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getDate",89],"(",["T_STRING_CAST","(string)",89],["T_VARIABLE","$item",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","pubDate",89],")",",",["T_WHITESPACE","\n                    ",89],["T_CONSTANT_ENCAPSED_STRING","'title'",90],["T_WHITESPACE","         ",90],["T_DOUBLE_ARROW","=>",90],["T_WHITESPACE"," ",90],["T_STRING_CAST","(string)",90],["T_VARIABLE","$item",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","title",90],",",["T_WHITESPACE","\n                    ",90],["T_CONSTANT_ENCAPSED_STRING","'description'",91],["T_WHITESPACE","   ",91],["T_DOUBLE_ARROW","=>",91],["T_WHITESPACE"," ",91],["T_STRING_CAST","(string)",91],["T_VARIABLE","$item",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","description",91],",",["T_WHITESPACE","\n                    ",91],["T_CONSTANT_ENCAPSED_STRING","'url'",92],["T_WHITESPACE","           ",92],["T_DOUBLE_ARROW","=>",92],["T_WHITESPACE"," ",92],["T_STRING_CAST","(string)",92],["T_VARIABLE","$item",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","link",92],",",["T_WHITESPACE","\n                ",92],")",";",["T_WHITESPACE","\n            ",93],"}",["T_WHITESPACE","\n\n            ",94],["T_IF","if",96],["T_WHITESPACE"," ",96],"(",["T_VARIABLE","$feedData",96],")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n                ",96],["T_STRING","Mage",97],["T_DOUBLE_COLON","::",97],["T_STRING","getModel",97],"(",["T_CONSTANT_ENCAPSED_STRING","'adminnotification\/inbox'",97],")",["T_OBJECT_OPERATOR","->",97],["T_STRING","parse",97],"(",["T_STRING","array_reverse",97],"(",["T_VARIABLE","$feedData",97],")",")",";",["T_WHITESPACE","\n            ",97],"}",["T_WHITESPACE","\n\n        ",98],"}",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","setLastUpdate",101],"(",")",";",["T_WHITESPACE","\n\n        ",101],["T_RETURN","return",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],";",["T_WHITESPACE","\n    ",103],"}",["T_WHITESPACE","\n\n    ",104],["T_DOC_COMMENT","\/**\n     * Retrieve DB date from RSS date\n     *\n     * @param string $rssDate\n     * @return string YYYY-MM-DD YY:HH:SS\n     *\/",106],["T_WHITESPACE","\n    ",111],["T_PUBLIC","public",112],["T_WHITESPACE"," ",112],["T_FUNCTION","function",112],["T_WHITESPACE"," ",112],["T_STRING","getDate",112],"(",["T_VARIABLE","$rssDate",112],")",["T_WHITESPACE","\n    ",112],"{",["T_WHITESPACE","\n        ",113],["T_RETURN","return",114],["T_WHITESPACE"," ",114],["T_STRING","gmdate",114],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d H:i:s'",114],",",["T_WHITESPACE"," ",114],["T_STRING","strtotime",114],"(",["T_VARIABLE","$rssDate",114],")",")",";",["T_WHITESPACE","\n    ",114],"}",["T_WHITESPACE","\n\n    ",115],["T_DOC_COMMENT","\/**\n     * Retrieve Update Frequency\n     *\n     * @return int\n     *\/",117],["T_WHITESPACE","\n    ",121],["T_PUBLIC","public",122],["T_WHITESPACE"," ",122],["T_FUNCTION","function",122],["T_WHITESPACE"," ",122],["T_STRING","getFrequency",122],"(",")",["T_WHITESPACE","\n    ",122],"{",["T_WHITESPACE","\n        ",123],["T_RETURN","return",124],["T_WHITESPACE"," ",124],["T_STRING","Mage",124],["T_DOUBLE_COLON","::",124],["T_STRING","getStoreConfig",124],"(",["T_STRING","self",124],["T_DOUBLE_COLON","::",124],["T_STRING","XML_FREQUENCY_PATH",124],")",["T_WHITESPACE"," ",124],"*",["T_WHITESPACE"," ",124],["T_LNUMBER","3600",124],";",["T_WHITESPACE","\n    ",124],"}",["T_WHITESPACE","\n\n    ",125],["T_DOC_COMMENT","\/**\n     * Retrieve Last update time\n     *\n     * @return int\n     *\/",127],["T_WHITESPACE","\n    ",131],["T_PUBLIC","public",132],["T_WHITESPACE"," ",132],["T_FUNCTION","function",132],["T_WHITESPACE"," ",132],["T_STRING","getLastUpdate",132],"(",")",["T_WHITESPACE","\n    ",132],"{",["T_WHITESPACE","\n        ",133],["T_RETURN","return",134],["T_WHITESPACE"," ",134],["T_STRING","Mage",134],["T_DOUBLE_COLON","::",134],["T_STRING","app",134],"(",")",["T_OBJECT_OPERATOR","->",134],["T_STRING","loadCache",134],"(",["T_CONSTANT_ENCAPSED_STRING","'admin_notifications_lastcheck'",134],")",";",["T_WHITESPACE","\n",134],["T_COMMENT","\/\/        return Mage::getStoreConfig(self::XML_LAST_UPDATE_PATH);\n",135],["T_WHITESPACE","    ",136],"}",["T_WHITESPACE","\n\n    ",136],["T_DOC_COMMENT","\/**\n     * Set last update time (now)\n     *\n     * @return Mage_AdminNotification_Model_Feed\n     *\/",138],["T_WHITESPACE","\n    ",142],["T_PUBLIC","public",143],["T_WHITESPACE"," ",143],["T_FUNCTION","function",143],["T_WHITESPACE"," ",143],["T_STRING","setLastUpdate",143],"(",")",["T_WHITESPACE","\n    ",143],"{",["T_WHITESPACE","\n        ",144],["T_STRING","Mage",145],["T_DOUBLE_COLON","::",145],["T_STRING","app",145],"(",")",["T_OBJECT_OPERATOR","->",145],["T_STRING","saveCache",145],"(",["T_STRING","time",145],"(",")",",",["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","'admin_notifications_lastcheck'",145],")",";",["T_WHITESPACE","\n",145],["T_COMMENT","\/\/        $config = Mage::getModel('core\/config');\n",146],["T_COMMENT","\/\/        \/* @var $config Mage_Core_Model_Config *\/\n",147],["T_COMMENT","\/\/        $config->saveConfig(self::XML_LAST_UPDATE_PATH, time());\n",148],["T_WHITESPACE","        ",149],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],";",["T_WHITESPACE","\n    ",149],"}",["T_WHITESPACE","\n\n    ",150],["T_DOC_COMMENT","\/**\n     * Retrieve feed data as XML element\n     *\n     * @return SimpleXMLElement\n     *\/",152],["T_WHITESPACE","\n    ",156],["T_PUBLIC","public",157],["T_WHITESPACE"," ",157],["T_FUNCTION","function",157],["T_WHITESPACE"," ",157],["T_STRING","getFeedData",157],"(",")",["T_WHITESPACE","\n    ",157],"{",["T_WHITESPACE","\n        ",158],["T_VARIABLE","$curl",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_NEW","new",159],["T_WHITESPACE"," ",159],["T_STRING","Varien_Http_Adapter_Curl",159],"(",")",";",["T_WHITESPACE","\n        ",159],["T_VARIABLE","$curl",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","setConfig",160],"(",["T_ARRAY","array",160],"(",["T_WHITESPACE","\n            ",160],["T_CONSTANT_ENCAPSED_STRING","'timeout'",161],["T_WHITESPACE","   ",161],["T_DOUBLE_ARROW","=>",161],["T_WHITESPACE"," ",161],["T_LNUMBER","2",161],["T_WHITESPACE","\n        ",161],")",")",";",["T_WHITESPACE","\n        ",162],["T_VARIABLE","$curl",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","write",163],"(",["T_STRING","Zend_Http_Client",163],["T_DOUBLE_COLON","::",163],["T_STRING","GET",163],",",["T_WHITESPACE"," ",163],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","getFeedUrl",163],"(",")",",",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","'1.0'",163],")",";",["T_WHITESPACE","\n        ",163],["T_VARIABLE","$data",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_VARIABLE","$curl",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","read",164],"(",")",";",["T_WHITESPACE","\n        ",164],["T_IF","if",165],["T_WHITESPACE"," ",165],"(",["T_VARIABLE","$data",165],["T_WHITESPACE"," ",165],["T_IS_IDENTICAL","===",165],["T_WHITESPACE"," ",165],["T_STRING","false",165],")",["T_WHITESPACE"," ",165],"{",["T_WHITESPACE","\n            ",165],["T_RETURN","return",166],["T_WHITESPACE"," ",166],["T_STRING","false",166],";",["T_WHITESPACE","\n        ",166],"}",["T_WHITESPACE","\n        ",167],["T_VARIABLE","$data",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_STRING","preg_split",168],"(",["T_CONSTANT_ENCAPSED_STRING","'\/^\\r?$\/m'",168],",",["T_WHITESPACE"," ",168],["T_VARIABLE","$data",168],",",["T_WHITESPACE"," ",168],["T_LNUMBER","2",168],")",";",["T_WHITESPACE","\n        ",168],["T_VARIABLE","$data",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_STRING","trim",169],"(",["T_VARIABLE","$data",169],"[",["T_LNUMBER","1",169],"]",")",";",["T_WHITESPACE","\n        ",169],["T_VARIABLE","$curl",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","close",170],"(",")",";",["T_WHITESPACE","\n\n        ",170],["T_TRY","try",172],["T_WHITESPACE"," ",172],"{",["T_WHITESPACE","\n            ",172],["T_VARIABLE","$xml",173],["T_WHITESPACE","  ",173],"=",["T_WHITESPACE"," ",173],["T_NEW","new",173],["T_WHITESPACE"," ",173],["T_STRING","SimpleXMLElement",173],"(",["T_VARIABLE","$data",173],")",";",["T_WHITESPACE","\n        ",173],"}",["T_WHITESPACE","\n        ",174],["T_CATCH","catch",175],["T_WHITESPACE"," ",175],"(",["T_STRING","Exception",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$e",175],")",["T_WHITESPACE"," ",175],"{",["T_WHITESPACE","\n            ",175],["T_RETURN","return",176],["T_WHITESPACE"," ",176],["T_STRING","false",176],";",["T_WHITESPACE","\n        ",176],"}",["T_WHITESPACE","\n\n        ",177],["T_RETURN","return",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$xml",179],";",["T_WHITESPACE","\n    ",179],"}",["T_WHITESPACE","\n\n    ",180],["T_PUBLIC","public",182],["T_WHITESPACE"," ",182],["T_FUNCTION","function",182],["T_WHITESPACE"," ",182],["T_STRING","getFeedXml",182],"(",")",["T_WHITESPACE","\n    ",182],"{",["T_WHITESPACE","\n        ",183],["T_TRY","try",184],["T_WHITESPACE"," ",184],"{",["T_WHITESPACE","\n            ",184],["T_VARIABLE","$data",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","getFeedData",185],"(",")",";",["T_WHITESPACE","\n            ",185],["T_VARIABLE","$xml",186],["T_WHITESPACE","  ",186],"=",["T_WHITESPACE"," ",186],["T_NEW","new",186],["T_WHITESPACE"," ",186],["T_STRING","SimpleXMLElement",186],"(",["T_VARIABLE","$data",186],")",";",["T_WHITESPACE","\n        ",186],"}",["T_WHITESPACE","\n        ",187],["T_CATCH","catch",188],["T_WHITESPACE"," ",188],"(",["T_STRING","Exception",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$e",188],")",["T_WHITESPACE"," ",188],"{",["T_WHITESPACE","\n            ",188],["T_VARIABLE","$xml",189],["T_WHITESPACE","  ",189],"=",["T_WHITESPACE"," ",189],["T_NEW","new",189],["T_WHITESPACE"," ",189],["T_STRING","SimpleXMLElement",189],"(",["T_CONSTANT_ENCAPSED_STRING","'<?xml version=\"1.0\" encoding=\"utf-8\" ?>'",189],")",";",["T_WHITESPACE","\n        ",189],"}",["T_WHITESPACE","\n\n        ",190],["T_RETURN","return",192],["T_WHITESPACE"," ",192],["T_VARIABLE","$xml",192],";",["T_WHITESPACE","\n    ",192],"}",["T_WHITESPACE","\n",193],"}",["T_WHITESPACE","\n",194]]