[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Customer\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Customer session model\n *\n * @category   Mage\n * @package    Mage_Customer\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Customer_Model_Session",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Core_Model_Session_Abstract",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Customer object\n     *\n     * @var Mage_Customer_Model_Customer\n     *\/",36],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$_customer",41],";",["T_WHITESPACE","\n\n    ",41],["T_DOC_COMMENT","\/**\n     * Flag with customer id validations result\n     *\n     * @var bool\n     *\/",43],["T_WHITESPACE","\n    ",47],["T_PROTECTED","protected",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$_isCustomerIdChecked",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_STRING","null",48],";",["T_WHITESPACE","\n\n    ",48],["T_DOC_COMMENT","\/**\n     * Persistent customer group id\n     *\n     * @var null|int\n     *\/",50],["T_WHITESPACE","\n    ",54],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$_persistentCustomerGroupId",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","null",55],";",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * Retrieve customer sharing configuration model\n     *\n     * @return Mage_Customer_Model_Config_Share\n     *\/",57],["T_WHITESPACE","\n    ",61],["T_PUBLIC","public",62],["T_WHITESPACE"," ",62],["T_FUNCTION","function",62],["T_WHITESPACE"," ",62],["T_STRING","getCustomerConfigShare",62],"(",")",["T_WHITESPACE","\n    ",62],"{",["T_WHITESPACE","\n        ",63],["T_RETURN","return",64],["T_WHITESPACE"," ",64],["T_STRING","Mage",64],["T_DOUBLE_COLON","::",64],["T_STRING","getSingleton",64],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/config_share'",64],")",";",["T_WHITESPACE","\n    ",64],"}",["T_WHITESPACE","\n\n    ",65],["T_PUBLIC","public",67],["T_WHITESPACE"," ",67],["T_FUNCTION","function",67],["T_WHITESPACE"," ",67],["T_STRING","__construct",67],"(",")",["T_WHITESPACE","\n    ",67],"{",["T_WHITESPACE","\n        ",68],["T_VARIABLE","$namespace",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'customer'",69],";",["T_WHITESPACE","\n        ",69],["T_IF","if",70],["T_WHITESPACE"," ",70],"(",["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getCustomerConfigShare",70],"(",")",["T_OBJECT_OPERATOR","->",70],["T_STRING","isWebsiteScope",70],"(",")",")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n            ",70],["T_VARIABLE","$namespace",71],["T_WHITESPACE"," ",71],["T_CONCAT_EQUAL",".=",71],["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'_'",71],["T_WHITESPACE"," ",71],".",["T_WHITESPACE"," ",71],"(",["T_STRING","Mage",71],["T_DOUBLE_COLON","::",71],["T_STRING","app",71],"(",")",["T_OBJECT_OPERATOR","->",71],["T_STRING","getStore",71],"(",")",["T_OBJECT_OPERATOR","->",71],["T_STRING","getWebsite",71],"(",")",["T_OBJECT_OPERATOR","->",71],["T_STRING","getCode",71],"(",")",")",";",["T_WHITESPACE","\n        ",71],"}",["T_WHITESPACE","\n\n        ",72],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","init",74],"(",["T_VARIABLE","$namespace",74],")",";",["T_WHITESPACE","\n        ",74],["T_STRING","Mage",75],["T_DOUBLE_COLON","::",75],["T_STRING","dispatchEvent",75],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_session_init'",75],",",["T_WHITESPACE"," ",75],["T_ARRAY","array",75],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_session'",75],["T_DOUBLE_ARROW","=>",75],["T_VARIABLE","$this",75],")",")",";",["T_WHITESPACE","\n    ",75],"}",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * Set customer object and setting customer id in session\n     *\n     * @param   Mage_Customer_Model_Customer $customer\n     * @return  Mage_Customer_Model_Session\n     *\/",78],["T_WHITESPACE","\n    ",83],["T_PUBLIC","public",84],["T_WHITESPACE"," ",84],["T_FUNCTION","function",84],["T_WHITESPACE"," ",84],["T_STRING","setCustomer",84],"(",["T_STRING","Mage_Customer_Model_Customer",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$customer",84],")",["T_WHITESPACE","\n    ",84],"{",["T_WHITESPACE","\n        ",85],["T_COMMENT","\/\/ check if customer is not confirmed\n",86],["T_WHITESPACE","        ",87],["T_IF","if",87],["T_WHITESPACE"," ",87],"(",["T_VARIABLE","$customer",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","isConfirmationRequired",87],"(",")",")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n            ",87],["T_IF","if",88],["T_WHITESPACE"," ",88],"(",["T_VARIABLE","$customer",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","getConfirmation",88],"(",")",")",["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n                ",88],["T_RETURN","return",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","_logout",89],"(",")",";",["T_WHITESPACE","\n            ",89],"}",["T_WHITESPACE","\n        ",90],"}",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","_customer",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$customer",92],";",["T_WHITESPACE","\n        ",92],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","setId",93],"(",["T_VARIABLE","$customer",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getId",93],"(",")",")",";",["T_WHITESPACE","\n        ",93],["T_COMMENT","\/\/ save customer as confirmed, if it is not\n",94],["T_WHITESPACE","        ",95],["T_IF","if",95],["T_WHITESPACE"," ",95],"(","(","!",["T_VARIABLE","$customer",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","isConfirmationRequired",95],"(",")",")",["T_WHITESPACE"," ",95],["T_BOOLEAN_AND","&&",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$customer",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getConfirmation",95],"(",")",")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n            ",95],["T_VARIABLE","$customer",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","setConfirmation",96],"(",["T_STRING","null",96],")",["T_OBJECT_OPERATOR","->",96],["T_STRING","save",96],"(",")",";",["T_WHITESPACE","\n            ",96],["T_VARIABLE","$customer",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","setIsJustConfirmed",97],"(",["T_STRING","true",97],")",";",["T_WHITESPACE","\n        ",97],"}",["T_WHITESPACE","\n        ",98],["T_RETURN","return",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$this",99],";",["T_WHITESPACE","\n    ",99],"}",["T_WHITESPACE","\n\n    ",100],["T_DOC_COMMENT","\/**\n     * Retrieve customer model object\n     *\n     * @return Mage_Customer_Model_Customer\n     *\/",102],["T_WHITESPACE","\n    ",106],["T_PUBLIC","public",107],["T_WHITESPACE"," ",107],["T_FUNCTION","function",107],["T_WHITESPACE"," ",107],["T_STRING","getCustomer",107],"(",")",["T_WHITESPACE","\n    ",107],"{",["T_WHITESPACE","\n        ",108],["T_IF","if",109],["T_WHITESPACE"," ",109],"(",["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","_customer",109],["T_WHITESPACE"," ",109],["T_INSTANCEOF","instanceof",109],["T_WHITESPACE"," ",109],["T_STRING","Mage_Customer_Model_Customer",109],")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n            ",109],["T_RETURN","return",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","_customer",110],";",["T_WHITESPACE","\n        ",110],"}",["T_WHITESPACE","\n\n        ",111],["T_VARIABLE","$customer",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_STRING","Mage",113],["T_DOUBLE_COLON","::",113],["T_STRING","getModel",113],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/customer'",113],")",["T_WHITESPACE","\n            ",113],["T_OBJECT_OPERATOR","->",114],["T_STRING","setWebsiteId",114],"(",["T_STRING","Mage",114],["T_DOUBLE_COLON","::",114],["T_STRING","app",114],"(",")",["T_OBJECT_OPERATOR","->",114],["T_STRING","getStore",114],"(",")",["T_OBJECT_OPERATOR","->",114],["T_STRING","getWebsiteId",114],"(",")",")",";",["T_WHITESPACE","\n        ",114],["T_IF","if",115],["T_WHITESPACE"," ",115],"(",["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","getId",115],"(",")",")",["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n            ",115],["T_VARIABLE","$customer",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","load",116],"(",["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getId",116],"(",")",")",";",["T_WHITESPACE","\n        ",116],"}",["T_WHITESPACE","\n\n        ",117],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","setCustomer",119],"(",["T_VARIABLE","$customer",119],")",";",["T_WHITESPACE","\n        ",119],["T_RETURN","return",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","_customer",120],";",["T_WHITESPACE","\n    ",120],"}",["T_WHITESPACE","\n\n    ",121],["T_DOC_COMMENT","\/**\n     * Set customer id\n     *\n     * @param int|null $id\n     * @return Mage_Customer_Model_Session\n     *\/",123],["T_WHITESPACE","\n    ",128],["T_PUBLIC","public",129],["T_WHITESPACE"," ",129],["T_FUNCTION","function",129],["T_WHITESPACE"," ",129],["T_STRING","setCustomerId",129],"(",["T_VARIABLE","$id",129],")",["T_WHITESPACE","\n    ",129],"{",["T_WHITESPACE","\n        ",130],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","setData",131],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",131],",",["T_WHITESPACE"," ",131],["T_VARIABLE","$id",131],")",";",["T_WHITESPACE","\n        ",131],["T_RETURN","return",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],";",["T_WHITESPACE","\n    ",132],"}",["T_WHITESPACE","\n\n    ",133],["T_DOC_COMMENT","\/**\n     * Retrieve customer id from current session\n     *\n     * @return int|null\n     *\/",135],["T_WHITESPACE","\n    ",139],["T_PUBLIC","public",140],["T_WHITESPACE"," ",140],["T_FUNCTION","function",140],["T_WHITESPACE"," ",140],["T_STRING","getCustomerId",140],"(",")",["T_WHITESPACE","\n    ",140],"{",["T_WHITESPACE","\n        ",141],["T_IF","if",142],["T_WHITESPACE"," ",142],"(",["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","getData",142],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",142],")",")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n            ",142],["T_RETURN","return",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getData",143],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",143],")",";",["T_WHITESPACE","\n        ",143],"}",["T_WHITESPACE","\n        ",144],["T_RETURN","return",145],["T_WHITESPACE"," ",145],"(",["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","isLoggedIn",145],"(",")",")",["T_WHITESPACE"," ",145],"?",["T_WHITESPACE"," ",145],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getId",145],"(",")",["T_WHITESPACE"," ",145],":",["T_WHITESPACE"," ",145],["T_STRING","null",145],";",["T_WHITESPACE","\n    ",145],"}",["T_WHITESPACE","\n\n    ",146],["T_DOC_COMMENT","\/**\n     * Set customer group id\n     *\n     * @param int|null $id\n     * @return Mage_Customer_Model_Session\n     *\/",148],["T_WHITESPACE","\n    ",153],["T_PUBLIC","public",154],["T_WHITESPACE"," ",154],["T_FUNCTION","function",154],["T_WHITESPACE"," ",154],["T_STRING","setCustomerGroupId",154],"(",["T_VARIABLE","$id",154],")",["T_WHITESPACE","\n    ",154],"{",["T_WHITESPACE","\n        ",155],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","setData",156],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",156],",",["T_WHITESPACE"," ",156],["T_VARIABLE","$id",156],")",";",["T_WHITESPACE","\n        ",156],["T_RETURN","return",157],["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],";",["T_WHITESPACE","\n    ",157],"}",["T_WHITESPACE","\n\n    ",158],["T_DOC_COMMENT","\/**\n     * Get customer group id\n     * If customer is not logged in system, 'not logged in' group id will be returned\n     *\n     * @return int\n     *\/",160],["T_WHITESPACE","\n    ",165],["T_PUBLIC","public",166],["T_WHITESPACE"," ",166],["T_FUNCTION","function",166],["T_WHITESPACE"," ",166],["T_STRING","getCustomerGroupId",166],"(",")",["T_WHITESPACE","\n    ",166],"{",["T_WHITESPACE","\n        ",167],["T_IF","if",168],["T_WHITESPACE"," ",168],"(",["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","getData",168],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",168],")",")",["T_WHITESPACE"," ",168],"{",["T_WHITESPACE","\n            ",168],["T_RETURN","return",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","getData",169],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",169],")",";",["T_WHITESPACE","\n        ",169],"}",["T_WHITESPACE","\n        ",170],["T_IF","if",171],["T_WHITESPACE"," ",171],"(",["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","isLoggedIn",171],"(",")",["T_WHITESPACE"," ",171],["T_BOOLEAN_AND","&&",171],["T_WHITESPACE"," ",171],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","getCustomer",171],"(",")",")",["T_WHITESPACE"," ",171],"{",["T_WHITESPACE","\n            ",171],["T_RETURN","return",172],["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","getCustomer",172],"(",")",["T_OBJECT_OPERATOR","->",172],["T_STRING","getGroupId",172],"(",")",";",["T_WHITESPACE","\n        ",172],"}",["T_WHITESPACE","\n        ",173],["T_RETURN","return",174],["T_WHITESPACE"," ",174],["T_STRING","Mage_Customer_Model_Group",174],["T_DOUBLE_COLON","::",174],["T_STRING","NOT_LOGGED_IN_ID",174],";",["T_WHITESPACE","\n    ",174],"}",["T_WHITESPACE","\n\n    ",175],["T_DOC_COMMENT","\/**\n     * Checking customer login status\n     *\n     * @return bool\n     *\/",177],["T_WHITESPACE","\n    ",181],["T_PUBLIC","public",182],["T_WHITESPACE"," ",182],["T_FUNCTION","function",182],["T_WHITESPACE"," ",182],["T_STRING","isLoggedIn",182],"(",")",["T_WHITESPACE","\n    ",182],"{",["T_WHITESPACE","\n        ",183],["T_RETURN","return",184],["T_WHITESPACE"," ",184],["T_BOOL_CAST","(bool)",184],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getId",184],"(",")",["T_WHITESPACE"," ",184],["T_BOOLEAN_AND","&&",184],["T_WHITESPACE"," ",184],["T_BOOL_CAST","(bool)",184],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","checkCustomerId",184],"(",["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getId",184],"(",")",")",";",["T_WHITESPACE","\n    ",184],"}",["T_WHITESPACE","\n\n    ",185],["T_DOC_COMMENT","\/**\n     * Check exists customer (light check)\n     *\n     * @param int $customerId\n     * @return bool\n     *\/",187],["T_WHITESPACE","\n    ",192],["T_PUBLIC","public",193],["T_WHITESPACE"," ",193],["T_FUNCTION","function",193],["T_WHITESPACE"," ",193],["T_STRING","checkCustomerId",193],"(",["T_VARIABLE","$customerId",193],")",["T_WHITESPACE","\n    ",193],"{",["T_WHITESPACE","\n        ",194],["T_IF","if",195],["T_WHITESPACE"," ",195],"(",["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","_isCustomerIdChecked",195],["T_WHITESPACE"," ",195],["T_IS_IDENTICAL","===",195],["T_WHITESPACE"," ",195],["T_STRING","null",195],")",["T_WHITESPACE"," ",195],"{",["T_WHITESPACE","\n            ",195],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","_isCustomerIdChecked",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_STRING","Mage",196],["T_DOUBLE_COLON","::",196],["T_STRING","getResourceSingleton",196],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/customer'",196],")",["T_OBJECT_OPERATOR","->",196],["T_STRING","checkCustomerId",196],"(",["T_VARIABLE","$customerId",196],")",";",["T_WHITESPACE","\n        ",196],"}",["T_WHITESPACE","\n        ",197],["T_RETURN","return",198],["T_WHITESPACE"," ",198],["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","_isCustomerIdChecked",198],";",["T_WHITESPACE","\n    ",198],"}",["T_WHITESPACE","\n\n    ",199],["T_DOC_COMMENT","\/**\n     * Customer authorization\n     *\n     * @param   string $username\n     * @param   string $password\n     * @return  bool\n     *\/",201],["T_WHITESPACE","\n    ",207],["T_PUBLIC","public",208],["T_WHITESPACE"," ",208],["T_FUNCTION","function",208],["T_WHITESPACE"," ",208],["T_STRING","login",208],"(",["T_VARIABLE","$username",208],",",["T_WHITESPACE"," ",208],["T_VARIABLE","$password",208],")",["T_WHITESPACE","\n    ",208],"{",["T_WHITESPACE","\n        ",209],["T_DOC_COMMENT","\/** @var $customer Mage_Customer_Model_Customer *\/",210],["T_WHITESPACE","\n        ",210],["T_VARIABLE","$customer",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_STRING","Mage",211],["T_DOUBLE_COLON","::",211],["T_STRING","getModel",211],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/customer'",211],")",["T_WHITESPACE","\n            ",211],["T_OBJECT_OPERATOR","->",212],["T_STRING","setWebsiteId",212],"(",["T_STRING","Mage",212],["T_DOUBLE_COLON","::",212],["T_STRING","app",212],"(",")",["T_OBJECT_OPERATOR","->",212],["T_STRING","getStore",212],"(",")",["T_OBJECT_OPERATOR","->",212],["T_STRING","getWebsiteId",212],"(",")",")",";",["T_WHITESPACE","\n\n        ",212],["T_IF","if",214],["T_WHITESPACE"," ",214],"(",["T_VARIABLE","$customer",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","authenticate",214],"(",["T_VARIABLE","$username",214],",",["T_WHITESPACE"," ",214],["T_VARIABLE","$password",214],")",")",["T_WHITESPACE"," ",214],"{",["T_WHITESPACE","\n            ",214],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","setCustomerAsLoggedIn",215],"(",["T_VARIABLE","$customer",215],")",";",["T_WHITESPACE","\n            ",215],["T_RETURN","return",216],["T_WHITESPACE"," ",216],["T_STRING","true",216],";",["T_WHITESPACE","\n        ",216],"}",["T_WHITESPACE","\n        ",217],["T_RETURN","return",218],["T_WHITESPACE"," ",218],["T_STRING","false",218],";",["T_WHITESPACE","\n    ",218],"}",["T_WHITESPACE","\n\n    ",219],["T_PUBLIC","public",221],["T_WHITESPACE"," ",221],["T_FUNCTION","function",221],["T_WHITESPACE"," ",221],["T_STRING","setCustomerAsLoggedIn",221],"(",["T_VARIABLE","$customer",221],")",["T_WHITESPACE","\n    ",221],"{",["T_WHITESPACE","\n        ",222],["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","setCustomer",223],"(",["T_VARIABLE","$customer",223],")",";",["T_WHITESPACE","\n        ",223],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","renewSession",224],"(",")",";",["T_WHITESPACE","\n        ",224],["T_STRING","Mage",225],["T_DOUBLE_COLON","::",225],["T_STRING","getSingleton",225],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/session'",225],")",["T_OBJECT_OPERATOR","->",225],["T_STRING","renewFormKey",225],"(",")",";",["T_WHITESPACE","\n        ",225],["T_STRING","Mage",226],["T_DOUBLE_COLON","::",226],["T_STRING","dispatchEvent",226],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_login'",226],",",["T_WHITESPACE"," ",226],["T_ARRAY","array",226],"(",["T_CONSTANT_ENCAPSED_STRING","'customer'",226],["T_DOUBLE_ARROW","=>",226],["T_VARIABLE","$customer",226],")",")",";",["T_WHITESPACE","\n        ",226],["T_RETURN","return",227],["T_WHITESPACE"," ",227],["T_VARIABLE","$this",227],";",["T_WHITESPACE","\n    ",227],"}",["T_WHITESPACE","\n\n    ",228],["T_DOC_COMMENT","\/**\n     * Authorization customer by identifier\n     *\n     * @param   int $customerId\n     * @return  bool\n     *\/",230],["T_WHITESPACE","\n    ",235],["T_PUBLIC","public",236],["T_WHITESPACE"," ",236],["T_FUNCTION","function",236],["T_WHITESPACE"," ",236],["T_STRING","loginById",236],"(",["T_VARIABLE","$customerId",236],")",["T_WHITESPACE","\n    ",236],"{",["T_WHITESPACE","\n        ",237],["T_VARIABLE","$customer",238],["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],["T_STRING","Mage",238],["T_DOUBLE_COLON","::",238],["T_STRING","getModel",238],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/customer'",238],")",["T_OBJECT_OPERATOR","->",238],["T_STRING","load",238],"(",["T_VARIABLE","$customerId",238],")",";",["T_WHITESPACE","\n        ",238],["T_IF","if",239],["T_WHITESPACE"," ",239],"(",["T_VARIABLE","$customer",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","getId",239],"(",")",")",["T_WHITESPACE"," ",239],"{",["T_WHITESPACE","\n            ",239],["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","setCustomerAsLoggedIn",240],"(",["T_VARIABLE","$customer",240],")",";",["T_WHITESPACE","\n            ",240],["T_RETURN","return",241],["T_WHITESPACE"," ",241],["T_STRING","true",241],";",["T_WHITESPACE","\n        ",241],"}",["T_WHITESPACE","\n        ",242],["T_RETURN","return",243],["T_WHITESPACE"," ",243],["T_STRING","false",243],";",["T_WHITESPACE","\n    ",243],"}",["T_WHITESPACE","\n\n    ",244],["T_DOC_COMMENT","\/**\n     * Logout customer\n     *\n     * @return Mage_Customer_Model_Session\n     *\/",246],["T_WHITESPACE","\n    ",250],["T_PUBLIC","public",251],["T_WHITESPACE"," ",251],["T_FUNCTION","function",251],["T_WHITESPACE"," ",251],["T_STRING","logout",251],"(",")",["T_WHITESPACE","\n    ",251],"{",["T_WHITESPACE","\n        ",252],["T_IF","if",253],["T_WHITESPACE"," ",253],"(",["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","isLoggedIn",253],"(",")",")",["T_WHITESPACE"," ",253],"{",["T_WHITESPACE","\n            ",253],["T_STRING","Mage",254],["T_DOUBLE_COLON","::",254],["T_STRING","dispatchEvent",254],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_logout'",254],",",["T_WHITESPACE"," ",254],["T_ARRAY","array",254],"(",["T_CONSTANT_ENCAPSED_STRING","'customer'",254],["T_WHITESPACE"," ",254],["T_DOUBLE_ARROW","=>",254],["T_WHITESPACE"," ",254],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","getCustomer",254],"(",")",")",["T_WHITESPACE"," ",254],")",";",["T_WHITESPACE","\n            ",254],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","_logout",255],"(",")",";",["T_WHITESPACE","\n        ",255],"}",["T_WHITESPACE","\n        ",256],["T_RETURN","return",257],["T_WHITESPACE"," ",257],["T_VARIABLE","$this",257],";",["T_WHITESPACE","\n    ",257],"}",["T_WHITESPACE","\n\n    ",258],["T_DOC_COMMENT","\/**\n     * Authenticate controller action by login customer\n     *\n     * @param   Mage_Core_Controller_Varien_Action $action\n     * @param   bool $loginUrl\n     * @return  bool\n     *\/",260],["T_WHITESPACE","\n    ",266],["T_PUBLIC","public",267],["T_WHITESPACE"," ",267],["T_FUNCTION","function",267],["T_WHITESPACE"," ",267],["T_STRING","authenticate",267],"(",["T_STRING","Mage_Core_Controller_Varien_Action",267],["T_WHITESPACE"," ",267],["T_VARIABLE","$action",267],",",["T_WHITESPACE"," ",267],["T_VARIABLE","$loginUrl",267],["T_WHITESPACE"," ",267],"=",["T_WHITESPACE"," ",267],["T_STRING","null",267],")",["T_WHITESPACE","\n    ",267],"{",["T_WHITESPACE","\n        ",268],["T_IF","if",269],["T_WHITESPACE"," ",269],"(",["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","isLoggedIn",269],"(",")",")",["T_WHITESPACE"," ",269],"{",["T_WHITESPACE","\n            ",269],["T_RETURN","return",270],["T_WHITESPACE"," ",270],["T_STRING","true",270],";",["T_WHITESPACE","\n        ",270],"}",["T_WHITESPACE","\n\n        ",271],["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","setBeforeAuthUrl",273],"(",["T_STRING","Mage",273],["T_DOUBLE_COLON","::",273],["T_STRING","getUrl",273],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/*'",273],",",["T_WHITESPACE"," ",273],["T_ARRAY","array",273],"(",["T_CONSTANT_ENCAPSED_STRING","'_current'",273],["T_WHITESPACE"," ",273],["T_DOUBLE_ARROW","=>",273],["T_WHITESPACE"," ",273],["T_STRING","true",273],")",")",")",";",["T_WHITESPACE","\n        ",273],["T_IF","if",274],["T_WHITESPACE"," ",274],"(",["T_ISSET","isset",274],"(",["T_VARIABLE","$loginUrl",274],")",")",["T_WHITESPACE"," ",274],"{",["T_WHITESPACE","\n            ",274],["T_VARIABLE","$action",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","getResponse",275],"(",")",["T_OBJECT_OPERATOR","->",275],["T_STRING","setRedirect",275],"(",["T_VARIABLE","$loginUrl",275],")",";",["T_WHITESPACE","\n        ",275],"}",["T_WHITESPACE"," ",276],["T_ELSE","else",276],["T_WHITESPACE"," ",276],"{",["T_WHITESPACE","\n            ",276],["T_VARIABLE","$action",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","setRedirectWithCookieCheck",277],"(",["T_STRING","Mage_Customer_Helper_Data",277],["T_DOUBLE_COLON","::",277],["T_STRING","ROUTE_ACCOUNT_LOGIN",277],",",["T_WHITESPACE","\n                ",277],["T_STRING","Mage",278],["T_DOUBLE_COLON","::",278],["T_STRING","helper",278],"(",["T_CONSTANT_ENCAPSED_STRING","'customer'",278],")",["T_OBJECT_OPERATOR","->",278],["T_STRING","getLoginUrlParams",278],"(",")",["T_WHITESPACE","\n            ",278],")",";",["T_WHITESPACE","\n        ",279],"}",["T_WHITESPACE","\n\n        ",280],["T_RETURN","return",282],["T_WHITESPACE"," ",282],["T_STRING","false",282],";",["T_WHITESPACE","\n    ",282],"}",["T_WHITESPACE","\n\n    ",283],["T_DOC_COMMENT","\/**\n     * Set auth url\n     *\n     * @param string $key\n     * @param string $url\n     * @return Mage_Customer_Model_Session\n     *\/",285],["T_WHITESPACE","\n    ",291],["T_PROTECTED","protected",292],["T_WHITESPACE"," ",292],["T_FUNCTION","function",292],["T_WHITESPACE"," ",292],["T_STRING","_setAuthUrl",292],"(",["T_VARIABLE","$key",292],",",["T_WHITESPACE"," ",292],["T_VARIABLE","$url",292],")",["T_WHITESPACE","\n    ",292],"{",["T_WHITESPACE","\n        ",293],["T_VARIABLE","$url",294],["T_WHITESPACE"," ",294],"=",["T_WHITESPACE"," ",294],["T_STRING","Mage",294],["T_DOUBLE_COLON","::",294],["T_STRING","helper",294],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/url'",294],")",["T_WHITESPACE","\n            ",294],["T_OBJECT_OPERATOR","->",295],["T_STRING","removeRequestParam",295],"(",["T_VARIABLE","$url",295],",",["T_WHITESPACE"," ",295],["T_STRING","Mage",295],["T_DOUBLE_COLON","::",295],["T_STRING","getSingleton",295],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/session'",295],")",["T_OBJECT_OPERATOR","->",295],["T_STRING","getSessionIdQueryParam",295],"(",")",")",";",["T_WHITESPACE","\n        ",295],["T_COMMENT","\/\/ Add correct session ID to URL if needed\n",296],["T_WHITESPACE","        ",297],["T_VARIABLE","$url",297],["T_WHITESPACE"," ",297],"=",["T_WHITESPACE"," ",297],["T_STRING","Mage",297],["T_DOUBLE_COLON","::",297],["T_STRING","getModel",297],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/url'",297],")",["T_OBJECT_OPERATOR","->",297],["T_STRING","getRebuiltUrl",297],"(",["T_VARIABLE","$url",297],")",";",["T_WHITESPACE","\n        ",297],["T_RETURN","return",298],["T_WHITESPACE"," ",298],["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","setData",298],"(",["T_VARIABLE","$key",298],",",["T_WHITESPACE"," ",298],["T_VARIABLE","$url",298],")",";",["T_WHITESPACE","\n    ",298],"}",["T_WHITESPACE","\n\n    ",299],["T_DOC_COMMENT","\/**\n     * Logout without dispatching event\n     *\n     * @return Mage_Customer_Model_Session\n     *\/",301],["T_WHITESPACE","\n    ",305],["T_PROTECTED","protected",306],["T_WHITESPACE"," ",306],["T_FUNCTION","function",306],["T_WHITESPACE"," ",306],["T_STRING","_logout",306],"(",")",["T_WHITESPACE","\n    ",306],"{",["T_WHITESPACE","\n        ",307],["T_VARIABLE","$this",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","setId",308],"(",["T_STRING","null",308],")",";",["T_WHITESPACE","\n        ",308],["T_VARIABLE","$this",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","setCustomerGroupId",309],"(",["T_STRING","Mage_Customer_Model_Group",309],["T_DOUBLE_COLON","::",309],["T_STRING","NOT_LOGGED_IN_ID",309],")",";",["T_WHITESPACE","\n        ",309],["T_VARIABLE","$this",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","getCookie",310],"(",")",["T_OBJECT_OPERATOR","->",310],["T_STRING","delete",310],"(",["T_VARIABLE","$this",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","getSessionName",310],"(",")",")",";",["T_WHITESPACE","\n        ",310],["T_STRING","Mage",311],["T_DOUBLE_COLON","::",311],["T_STRING","getSingleton",311],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/session'",311],")",["T_OBJECT_OPERATOR","->",311],["T_STRING","renewFormKey",311],"(",")",";",["T_WHITESPACE","\n        ",311],["T_RETURN","return",312],["T_WHITESPACE"," ",312],["T_VARIABLE","$this",312],";",["T_WHITESPACE","\n    ",312],"}",["T_WHITESPACE","\n\n    ",313],["T_DOC_COMMENT","\/**\n     * Set Before auth url\n     *\n     * @param string $url\n     * @return Mage_Customer_Model_Session\n     *\/",315],["T_WHITESPACE","\n    ",320],["T_PUBLIC","public",321],["T_WHITESPACE"," ",321],["T_FUNCTION","function",321],["T_WHITESPACE"," ",321],["T_STRING","setBeforeAuthUrl",321],"(",["T_VARIABLE","$url",321],")",["T_WHITESPACE","\n    ",321],"{",["T_WHITESPACE","\n        ",322],["T_RETURN","return",323],["T_WHITESPACE"," ",323],["T_VARIABLE","$this",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","_setAuthUrl",323],"(",["T_CONSTANT_ENCAPSED_STRING","'before_auth_url'",323],",",["T_WHITESPACE"," ",323],["T_VARIABLE","$url",323],")",";",["T_WHITESPACE","\n    ",323],"}",["T_WHITESPACE","\n\n    ",324],["T_DOC_COMMENT","\/**\n     * Set After auth url\n     *\n     * @param string $url\n     * @return Mage_Customer_Model_Session\n     *\/",326],["T_WHITESPACE","\n    ",331],["T_PUBLIC","public",332],["T_WHITESPACE"," ",332],["T_FUNCTION","function",332],["T_WHITESPACE"," ",332],["T_STRING","setAfterAuthUrl",332],"(",["T_VARIABLE","$url",332],")",["T_WHITESPACE","\n    ",332],"{",["T_WHITESPACE","\n        ",333],["T_RETURN","return",334],["T_WHITESPACE"," ",334],["T_VARIABLE","$this",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","_setAuthUrl",334],"(",["T_CONSTANT_ENCAPSED_STRING","'after_auth_url'",334],",",["T_WHITESPACE"," ",334],["T_VARIABLE","$url",334],")",";",["T_WHITESPACE","\n    ",334],"}",["T_WHITESPACE","\n\n    ",335],["T_DOC_COMMENT","\/**\n     * Reset core session hosts after reseting session ID\n     *\n     * @return Mage_Customer_Model_Session\n     *\/",337],["T_WHITESPACE","\n    ",341],["T_PUBLIC","public",342],["T_WHITESPACE"," ",342],["T_FUNCTION","function",342],["T_WHITESPACE"," ",342],["T_STRING","renewSession",342],"(",")",["T_WHITESPACE","\n    ",342],"{",["T_WHITESPACE","\n        ",343],["T_STRING","parent",344],["T_DOUBLE_COLON","::",344],["T_STRING","renewSession",344],"(",")",";",["T_WHITESPACE","\n        ",344],["T_STRING","Mage",345],["T_DOUBLE_COLON","::",345],["T_STRING","getSingleton",345],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/session'",345],")",["T_OBJECT_OPERATOR","->",345],["T_STRING","unsSessionHosts",345],"(",")",";",["T_WHITESPACE","\n\n        ",345],["T_RETURN","return",347],["T_WHITESPACE"," ",347],["T_VARIABLE","$this",347],";",["T_WHITESPACE","\n    ",347],"}",["T_WHITESPACE","\n",348],"}",["T_WHITESPACE","\n",349]]