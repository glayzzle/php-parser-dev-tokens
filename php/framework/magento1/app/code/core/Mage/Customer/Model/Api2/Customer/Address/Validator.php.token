[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Customer\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * API2 class for customer address rest\n *\n * @category   Mage\n * @package    Mage_Customer\n * @author     Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Customer_Model_Api2_Customer_Address_Validator",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Api2_Model_Resource_Validator_Eav",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Separator for multistreet\n     *\/",36],["T_WHITESPACE","\n    ",38],["T_CONST","const",39],["T_WHITESPACE"," ",39],["T_STRING","STREET_SEPARATOR",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'; '",39],";",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * Filter request data.\n     *\n     * @param  array $data\n     * @return array Filtered data\n     *\/",41],["T_WHITESPACE","\n    ",46],["T_PUBLIC","public",47],["T_WHITESPACE"," ",47],["T_FUNCTION","function",47],["T_WHITESPACE"," ",47],["T_STRING","filter",47],"(",["T_ARRAY","array",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$data",47],")",["T_WHITESPACE","\n    ",47],"{",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$filteredData",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_STRING","parent",49],["T_DOUBLE_COLON","::",49],["T_STRING","filter",49],"(",["T_VARIABLE","$data",49],")",";",["T_WHITESPACE","\n\n        ",49],["T_COMMENT","\/\/ If the array contains more than two elements, then combine the extra elements in a string\n",51],["T_WHITESPACE","        ",52],["T_IF","if",52],["T_WHITESPACE"," ",52],"(",["T_ISSET","isset",52],"(",["T_VARIABLE","$filteredData",52],"[",["T_CONSTANT_ENCAPSED_STRING","'street'",52],"]",")",["T_WHITESPACE"," ",52],["T_BOOLEAN_AND","&&",52],["T_WHITESPACE"," ",52],["T_STRING","is_array",52],"(",["T_VARIABLE","$filteredData",52],"[",["T_CONSTANT_ENCAPSED_STRING","'street'",52],"]",")",["T_WHITESPACE"," ",52],["T_BOOLEAN_AND","&&",52],["T_WHITESPACE"," ",52],["T_STRING","count",52],"(",["T_VARIABLE","$filteredData",52],"[",["T_CONSTANT_ENCAPSED_STRING","'street'",52],"]",")",["T_WHITESPACE"," ",52],">",["T_WHITESPACE"," ",52],["T_LNUMBER","2",52],")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n            ",52],["T_VARIABLE","$filteredData",53],"[",["T_CONSTANT_ENCAPSED_STRING","'street'",53],"]","[",["T_LNUMBER","1",53],"]",["T_WHITESPACE"," ",53],["T_CONCAT_EQUAL",".=",53],["T_WHITESPACE"," ",53],["T_STRING","self",53],["T_DOUBLE_COLON","::",53],["T_STRING","STREET_SEPARATOR",53],["T_WHITESPACE","\n                ",53],".",["T_WHITESPACE"," ",54],["T_STRING","implode",54],"(",["T_STRING","self",54],["T_DOUBLE_COLON","::",54],["T_STRING","STREET_SEPARATOR",54],",",["T_WHITESPACE"," ",54],["T_STRING","array_slice",54],"(",["T_VARIABLE","$filteredData",54],"[",["T_CONSTANT_ENCAPSED_STRING","'street'",54],"]",",",["T_WHITESPACE"," ",54],["T_LNUMBER","2",54],")",")",";",["T_WHITESPACE","\n            ",54],["T_VARIABLE","$filteredData",55],"[",["T_CONSTANT_ENCAPSED_STRING","'street'",55],"]",["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","array_slice",55],"(",["T_VARIABLE","$filteredData",55],"[",["T_CONSTANT_ENCAPSED_STRING","'street'",55],"]",",",["T_WHITESPACE"," ",55],["T_LNUMBER","0",55],",",["T_WHITESPACE"," ",55],["T_LNUMBER","2",55],")",";",["T_WHITESPACE","\n        ",55],"}",["T_WHITESPACE","\n        ",56],["T_COMMENT","\/\/ pass default addresses info\n",57],["T_WHITESPACE","        ",58],["T_IF","if",58],["T_WHITESPACE"," ",58],"(",["T_ISSET","isset",58],"(",["T_VARIABLE","$data",58],"[",["T_CONSTANT_ENCAPSED_STRING","'is_default_billing'",58],"]",")",")",["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n            ",58],["T_VARIABLE","$filteredData",59],"[",["T_CONSTANT_ENCAPSED_STRING","'is_default_billing'",59],"]",["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$data",59],"[",["T_CONSTANT_ENCAPSED_STRING","'is_default_billing'",59],"]",";",["T_WHITESPACE","\n        ",59],"}",["T_WHITESPACE","\n        ",60],["T_IF","if",61],["T_WHITESPACE"," ",61],"(",["T_ISSET","isset",61],"(",["T_VARIABLE","$data",61],"[",["T_CONSTANT_ENCAPSED_STRING","'is_default_shipping'",61],"]",")",")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n            ",61],["T_VARIABLE","$filteredData",62],"[",["T_CONSTANT_ENCAPSED_STRING","'is_default_shipping'",62],"]",["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_VARIABLE","$data",62],"[",["T_CONSTANT_ENCAPSED_STRING","'is_default_shipping'",62],"]",";",["T_WHITESPACE","\n        ",62],"}",["T_WHITESPACE","\n        ",63],["T_RETURN","return",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$filteredData",64],";",["T_WHITESPACE","\n    ",64],"}",["T_WHITESPACE","\n\n    ",65],["T_DOC_COMMENT","\/**\n     * Validate data for create association with the country\n     *\n     * @param array $data\n     * @return bool\n     *\/",67],["T_WHITESPACE","\n    ",72],["T_PUBLIC","public",73],["T_WHITESPACE"," ",73],["T_FUNCTION","function",73],["T_WHITESPACE"," ",73],["T_STRING","isValidDataForCreateAssociationWithCountry",73],"(",["T_ARRAY","array",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$data",73],")",["T_WHITESPACE","\n    ",73],"{",["T_WHITESPACE","\n        ",74],["T_RETURN","return",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","_checkRegion",75],"(",["T_VARIABLE","$data",75],",",["T_WHITESPACE"," ",75],["T_STRING","Mage",75],["T_DOUBLE_COLON","::",75],["T_STRING","getModel",75],"(",["T_CONSTANT_ENCAPSED_STRING","'directory\/country'",75],")",["T_OBJECT_OPERATOR","->",75],["T_STRING","loadByCode",75],"(",["T_VARIABLE","$data",75],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",75],"]",")",")",";",["T_WHITESPACE","\n    ",75],"}",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * Validate data for change association with the country\n     *\n     * @param Mage_Customer_Model_Address $address\n     * @param array $data\n     * @return bool\n     *\/",78],["T_WHITESPACE","\n    ",84],["T_PUBLIC","public",85],["T_WHITESPACE"," ",85],["T_FUNCTION","function",85],["T_WHITESPACE"," ",85],["T_STRING","isValidDataForChangeAssociationWithCountry",85],"(",["T_STRING","Mage_Customer_Model_Address",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$address",85],",",["T_WHITESPACE"," ",85],["T_ARRAY","array",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$data",85],")",["T_WHITESPACE","\n    ",85],"{",["T_WHITESPACE","\n        ",86],["T_IF","if",87],["T_WHITESPACE"," ",87],"(","!",["T_ISSET","isset",87],"(",["T_VARIABLE","$data",87],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",87],"]",")",["T_WHITESPACE"," ",87],["T_BOOLEAN_AND","&&",87],["T_WHITESPACE"," ",87],"!",["T_ISSET","isset",87],"(",["T_VARIABLE","$data",87],"[",["T_CONSTANT_ENCAPSED_STRING","'region'",87],"]",")",")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n            ",87],["T_RETURN","return",88],["T_WHITESPACE"," ",88],["T_STRING","true",88],";",["T_WHITESPACE","\n        ",88],"}",["T_WHITESPACE","\n        ",89],["T_COMMENT","\/\/ If country is in data - it has been already validated. If no - load current country.\n",90],["T_WHITESPACE","        ",91],["T_IF","if",91],["T_WHITESPACE"," ",91],"(",["T_ISSET","isset",91],"(",["T_VARIABLE","$data",91],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",91],"]",")",")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n            ",91],["T_VARIABLE","$country",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_STRING","Mage",92],["T_DOUBLE_COLON","::",92],["T_STRING","getModel",92],"(",["T_CONSTANT_ENCAPSED_STRING","'directory\/country'",92],")",["T_OBJECT_OPERATOR","->",92],["T_STRING","loadByCode",92],"(",["T_VARIABLE","$data",92],"[",["T_CONSTANT_ENCAPSED_STRING","'country_id'",92],"]",")",";",["T_WHITESPACE","\n        ",92],"}",["T_WHITESPACE"," ",93],["T_ELSE","else",93],["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n            ",93],["T_VARIABLE","$country",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_VARIABLE","$address",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getCountryModel",94],"(",")",";",["T_WHITESPACE","\n        ",94],"}",["T_WHITESPACE","\n        ",95],["T_RETURN","return",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","_checkRegion",96],"(",["T_VARIABLE","$data",96],",",["T_WHITESPACE"," ",96],["T_VARIABLE","$country",96],")",";",["T_WHITESPACE","\n    ",96],"}",["T_WHITESPACE","\n\n    ",97],["T_DOC_COMMENT","\/**\n     * Check region\n     *\n     * @param array $data\n     * @param Mage_Directory_Model_Country $country\n     * @return bool\n     *\/",99],["T_WHITESPACE","\n    ",105],["T_PROTECTED","protected",106],["T_WHITESPACE"," ",106],["T_FUNCTION","function",106],["T_WHITESPACE"," ",106],["T_STRING","_checkRegion",106],"(",["T_VARIABLE","$data",106],",",["T_WHITESPACE"," ",106],["T_STRING","Mage_Directory_Model_Country",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$country",106],")",["T_WHITESPACE","\n    ",106],"{",["T_WHITESPACE","\n        ",107],["T_COMMENT","\/* @var $regions Mage_Directory_Model_Resource_Region_Collection *\/",108],["T_WHITESPACE","\n        ",108],["T_VARIABLE","$regions",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$country",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getRegions",109],"(",")",";",["T_WHITESPACE","\n        ",109],["T_COMMENT","\/\/ Is it the country with predifined regions?\n",110],["T_WHITESPACE","        ",111],["T_IF","if",111],["T_WHITESPACE"," ",111],"(",["T_VARIABLE","$regions",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","count",111],"(",")",")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n            ",111],["T_IF","if",112],["T_WHITESPACE"," ",112],"(","!",["T_STRING","array_key_exists",112],"(",["T_CONSTANT_ENCAPSED_STRING","'region'",112],",",["T_WHITESPACE"," ",112],["T_VARIABLE","$data",112],")",["T_WHITESPACE"," ",112],["T_BOOLEAN_OR","||",112],["T_WHITESPACE"," ",112],["T_EMPTY","empty",112],"(",["T_VARIABLE","$data",112],"[",["T_CONSTANT_ENCAPSED_STRING","'region'",112],"]",")",")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n                ",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","_addError",113],"(",["T_CONSTANT_ENCAPSED_STRING","'\"State\/Province\" is required.'",113],")",";",["T_WHITESPACE","\n                ",113],["T_RETURN","return",114],["T_WHITESPACE"," ",114],["T_STRING","false",114],";",["T_WHITESPACE","\n            ",114],"}",["T_WHITESPACE","\n\n            ",115],["T_IF","if",117],["T_WHITESPACE"," ",117],"(","!",["T_STRING","is_string",117],"(",["T_VARIABLE","$data",117],"[",["T_CONSTANT_ENCAPSED_STRING","'region'",117],"]",")",")",["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n                ",117],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","_addError",118],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid \"State\/Province\" type.'",118],")",";",["T_WHITESPACE","\n                ",118],["T_RETURN","return",119],["T_WHITESPACE"," ",119],["T_STRING","false",119],";",["T_WHITESPACE","\n            ",119],"}",["T_WHITESPACE","\n\n            ",120],["T_VARIABLE","$count",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_VARIABLE","$regions",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","addFieldToFilter",122],"(",["T_ARRAY","array",122],"(",["T_CONSTANT_ENCAPSED_STRING","'default_name'",122],",",["T_WHITESPACE"," ",122],["T_CONSTANT_ENCAPSED_STRING","'code'",122],")",",",["T_WHITESPACE"," ",122],["T_ARRAY","array",122],"(",["T_VARIABLE","$data",122],"[",["T_CONSTANT_ENCAPSED_STRING","'region'",122],"]",",",["T_WHITESPACE"," ",122],["T_VARIABLE","$data",122],"[",["T_CONSTANT_ENCAPSED_STRING","'region'",122],"]",")",")",["T_WHITESPACE","\n                ",122],["T_OBJECT_OPERATOR","->",123],["T_STRING","clear",123],"(",")",["T_WHITESPACE","\n                ",123],["T_OBJECT_OPERATOR","->",124],["T_STRING","count",124],"(",")",";",["T_WHITESPACE","\n            ",124],["T_IF","if",125],["T_WHITESPACE"," ",125],"(","!",["T_VARIABLE","$count",125],")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n                ",125],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","_addError",126],"(",["T_CONSTANT_ENCAPSED_STRING","'State\/Province does not exist.'",126],")",";",["T_WHITESPACE","\n                ",126],["T_RETURN","return",127],["T_WHITESPACE"," ",127],["T_STRING","false",127],";",["T_WHITESPACE","\n            ",127],"}",["T_WHITESPACE","\n        ",128],"}",["T_WHITESPACE"," ",129],["T_ELSE","else",129],["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n            ",129],["T_IF","if",130],["T_WHITESPACE"," ",130],"(",["T_STRING","array_key_exists",130],"(",["T_CONSTANT_ENCAPSED_STRING","'region'",130],",",["T_WHITESPACE"," ",130],["T_VARIABLE","$data",130],")",["T_WHITESPACE"," ",130],["T_BOOLEAN_AND","&&",130],["T_WHITESPACE"," ",130],"!",["T_STRING","is_string",130],"(",["T_VARIABLE","$data",130],"[",["T_CONSTANT_ENCAPSED_STRING","'region'",130],"]",")",")",["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n                ",130],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","_addError",131],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid \"State\/Province\" type.'",131],")",";",["T_WHITESPACE","\n                ",131],["T_RETURN","return",132],["T_WHITESPACE"," ",132],["T_STRING","false",132],";",["T_WHITESPACE","\n            ",132],"}",["T_WHITESPACE","\n        ",133],"}",["T_WHITESPACE","\n\n        ",134],["T_RETURN","return",136],["T_WHITESPACE"," ",136],["T_STRING","true",136],";",["T_WHITESPACE","\n    ",136],"}",["T_WHITESPACE","\n",137],"}",["T_WHITESPACE","\n",138]]