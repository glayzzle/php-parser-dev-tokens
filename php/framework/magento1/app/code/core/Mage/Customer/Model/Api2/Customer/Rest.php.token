[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Customer\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Abstract API2 class for customer\n *\n * @category   Mage\n * @package    Mage_Customer\n * @author     Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_ABSTRACT","abstract",34],["T_WHITESPACE"," ",34],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Customer_Model_Api2_Customer_Rest",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Customer_Model_Api2_Customer",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Create customer\n     *\n     * @param array $data\n     * @return string\n     *\/",36],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","_create",42],"(",["T_ARRAY","array",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$data",42],")",["T_WHITESPACE","\n    ",42],"{",["T_WHITESPACE","\n        ",43],["T_DOC_COMMENT","\/** @var $validator Mage_Api2_Model_Resource_Validator_Eav *\/",44],["T_WHITESPACE","\n        ",44],["T_VARIABLE","$validator",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_STRING","Mage",45],["T_DOUBLE_COLON","::",45],["T_STRING","getResourceModel",45],"(",["T_CONSTANT_ENCAPSED_STRING","'api2\/validator_eav'",45],",",["T_WHITESPACE"," ",45],["T_ARRAY","array",45],"(",["T_CONSTANT_ENCAPSED_STRING","'resource'",45],["T_WHITESPACE"," ",45],["T_DOUBLE_ARROW","=>",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$this",45],")",")",";",["T_WHITESPACE","\n\n        ",45],["T_VARIABLE","$data",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$validator",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","filter",47],"(",["T_VARIABLE","$data",47],")",";",["T_WHITESPACE","\n        ",47],["T_IF","if",48],["T_WHITESPACE"," ",48],"(","!",["T_VARIABLE","$validator",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","isValidData",48],"(",["T_VARIABLE","$data",48],")",")",["T_WHITESPACE"," ",48],"{",["T_WHITESPACE","\n            ",48],["T_FOREACH","foreach",49],["T_WHITESPACE"," ",49],"(",["T_VARIABLE","$validator",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","getErrors",49],"(",")",["T_WHITESPACE"," ",49],["T_AS","as",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$error",49],")",["T_WHITESPACE"," ",49],"{",["T_WHITESPACE","\n                ",49],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","_error",50],"(",["T_VARIABLE","$error",50],",",["T_WHITESPACE"," ",50],["T_STRING","Mage_Api2_Model_Server",50],["T_DOUBLE_COLON","::",50],["T_STRING","HTTP_BAD_REQUEST",50],")",";",["T_WHITESPACE","\n            ",50],"}",["T_WHITESPACE","\n            ",51],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","_critical",52],"(",["T_STRING","self",52],["T_DOUBLE_COLON","::",52],["T_STRING","RESOURCE_DATA_PRE_VALIDATION_ERROR",52],")",";",["T_WHITESPACE","\n        ",52],"}",["T_WHITESPACE","\n\n        ",53],["T_DOC_COMMENT","\/** @var $customer Mage_Customer_Model_Customer *\/",55],["T_WHITESPACE","\n        ",55],["T_VARIABLE","$customer",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_STRING","Mage",56],["T_DOUBLE_COLON","::",56],["T_STRING","getModel",56],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/customer'",56],")",";",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$customer",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","setData",57],"(",["T_VARIABLE","$data",57],")",";",["T_WHITESPACE","\n\n        ",57],["T_TRY","try",59],["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n            ",59],["T_VARIABLE","$customer",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","save",60],"(",")",";",["T_WHITESPACE","\n        ",60],"}",["T_WHITESPACE"," ",61],["T_CATCH","catch",61],["T_WHITESPACE"," ",61],"(",["T_STRING","Mage_Core_Exception",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$e",61],")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n            ",61],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","_error",62],"(",["T_VARIABLE","$e",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","getMessage",62],"(",")",",",["T_WHITESPACE"," ",62],["T_STRING","Mage_Api2_Model_Server",62],["T_DOUBLE_COLON","::",62],["T_STRING","HTTP_INTERNAL_ERROR",62],")",";",["T_WHITESPACE","\n        ",62],"}",["T_WHITESPACE"," ",63],["T_CATCH","catch",63],["T_WHITESPACE"," ",63],"(",["T_STRING","Exception",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$e",63],")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n            ",63],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","_critical",64],"(",["T_STRING","self",64],["T_DOUBLE_COLON","::",64],["T_STRING","RESOURCE_INTERNAL_ERROR",64],")",";",["T_WHITESPACE","\n        ",64],"}",["T_WHITESPACE","\n\n        ",65],["T_RETURN","return",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","_getLocation",67],"(",["T_VARIABLE","$customer",67],")",";",["T_WHITESPACE","\n    ",67],"}",["T_WHITESPACE","\n\n    ",68],["T_DOC_COMMENT","\/**\n     * Retrieve information about customer\n     *\n     * @throws Mage_Api2_Exception\n     * @return array\n     *\/",70],["T_WHITESPACE","\n    ",75],["T_PROTECTED","protected",76],["T_WHITESPACE"," ",76],["T_FUNCTION","function",76],["T_WHITESPACE"," ",76],["T_STRING","_retrieve",76],"(",")",["T_WHITESPACE","\n    ",76],"{",["T_WHITESPACE","\n        ",77],["T_DOC_COMMENT","\/** @var $customer Mage_Customer_Model_Customer *\/",78],["T_WHITESPACE","\n        ",78],["T_VARIABLE","$customer",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","_loadCustomerById",79],"(",["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","getRequest",79],"(",")",["T_OBJECT_OPERATOR","->",79],["T_STRING","getParam",79],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",79],")",")",";",["T_WHITESPACE","\n        ",79],["T_RETURN","return",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$customer",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getData",80],"(",")",";",["T_WHITESPACE","\n    ",80],"}",["T_WHITESPACE","\n\n    ",81],["T_DOC_COMMENT","\/**\n     * Get customers list\n     *\n     * @return array\n     *\/",83],["T_WHITESPACE","\n    ",87],["T_PROTECTED","protected",88],["T_WHITESPACE"," ",88],["T_FUNCTION","function",88],["T_WHITESPACE"," ",88],["T_STRING","_retrieveCollection",88],"(",")",["T_WHITESPACE","\n    ",88],"{",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$data",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","_getCollectionForRetrieve",90],"(",")",["T_OBJECT_OPERATOR","->",90],["T_STRING","load",90],"(",")",["T_OBJECT_OPERATOR","->",90],["T_STRING","toArray",90],"(",")",";",["T_WHITESPACE","\n        ",90],["T_RETURN","return",91],["T_WHITESPACE"," ",91],["T_ISSET","isset",91],"(",["T_VARIABLE","$data",91],"[",["T_CONSTANT_ENCAPSED_STRING","'items'",91],"]",")",["T_WHITESPACE"," ",91],"?",["T_WHITESPACE"," ",91],["T_VARIABLE","$data",91],"[",["T_CONSTANT_ENCAPSED_STRING","'items'",91],"]",["T_WHITESPACE"," ",91],":",["T_WHITESPACE"," ",91],["T_VARIABLE","$data",91],";",["T_WHITESPACE","\n    ",91],"}",["T_WHITESPACE","\n\n    ",92],["T_DOC_COMMENT","\/**\n     * Update customer\n     *\n     * @param array $data\n     * @throws Mage_Api2_Exception\n     *\/",94],["T_WHITESPACE","\n    ",99],["T_PROTECTED","protected",100],["T_WHITESPACE"," ",100],["T_FUNCTION","function",100],["T_WHITESPACE"," ",100],["T_STRING","_update",100],"(",["T_ARRAY","array",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$data",100],")",["T_WHITESPACE","\n    ",100],"{",["T_WHITESPACE","\n        ",101],["T_DOC_COMMENT","\/** @var $customer Mage_Customer_Model_Customer *\/",102],["T_WHITESPACE","\n        ",102],["T_VARIABLE","$customer",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","_loadCustomerById",103],"(",["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getRequest",103],"(",")",["T_OBJECT_OPERATOR","->",103],["T_STRING","getParam",103],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",103],")",")",";",["T_WHITESPACE","\n        ",103],["T_DOC_COMMENT","\/** @var $validator Mage_Api2_Model_Resource_Validator_Eav *\/",104],["T_WHITESPACE","\n        ",104],["T_VARIABLE","$validator",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_STRING","Mage",105],["T_DOUBLE_COLON","::",105],["T_STRING","getResourceModel",105],"(",["T_CONSTANT_ENCAPSED_STRING","'api2\/validator_eav'",105],",",["T_WHITESPACE"," ",105],["T_ARRAY","array",105],"(",["T_CONSTANT_ENCAPSED_STRING","'resource'",105],["T_WHITESPACE"," ",105],["T_DOUBLE_ARROW","=>",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],")",")",";",["T_WHITESPACE","\n\n        ",105],["T_VARIABLE","$data",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_VARIABLE","$validator",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","filter",107],"(",["T_VARIABLE","$data",107],")",";",["T_WHITESPACE","\n\n        ",107],["T_UNSET","unset",109],"(",["T_VARIABLE","$data",109],"[",["T_CONSTANT_ENCAPSED_STRING","'website_id'",109],"]",")",";",["T_WHITESPACE"," ",109],["T_COMMENT","\/\/ website is not allowed to change\n",109],["T_WHITESPACE","\n        ",110],["T_IF","if",111],["T_WHITESPACE"," ",111],"(","!",["T_VARIABLE","$validator",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","isValidData",111],"(",["T_VARIABLE","$data",111],",",["T_WHITESPACE"," ",111],["T_STRING","true",111],")",")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n            ",111],["T_FOREACH","foreach",112],["T_WHITESPACE"," ",112],"(",["T_VARIABLE","$validator",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","getErrors",112],"(",")",["T_WHITESPACE"," ",112],["T_AS","as",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$error",112],")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n                ",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","_error",113],"(",["T_VARIABLE","$error",113],",",["T_WHITESPACE"," ",113],["T_STRING","Mage_Api2_Model_Server",113],["T_DOUBLE_COLON","::",113],["T_STRING","HTTP_BAD_REQUEST",113],")",";",["T_WHITESPACE","\n            ",113],"}",["T_WHITESPACE","\n            ",114],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","_critical",115],"(",["T_STRING","self",115],["T_DOUBLE_COLON","::",115],["T_STRING","RESOURCE_DATA_PRE_VALIDATION_ERROR",115],")",";",["T_WHITESPACE","\n        ",115],"}",["T_WHITESPACE","\n\n        ",116],["T_VARIABLE","$customer",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","addData",118],"(",["T_VARIABLE","$data",118],")",";",["T_WHITESPACE","\n\n        ",118],["T_TRY","try",120],["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n            ",120],["T_VARIABLE","$customer",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","save",121],"(",")",";",["T_WHITESPACE","\n        ",121],"}",["T_WHITESPACE"," ",122],["T_CATCH","catch",122],["T_WHITESPACE"," ",122],"(",["T_STRING","Mage_Core_Exception",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$e",122],")",["T_WHITESPACE"," ",122],"{",["T_WHITESPACE","\n            ",122],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","_error",123],"(",["T_VARIABLE","$e",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getMessage",123],"(",")",",",["T_WHITESPACE"," ",123],["T_STRING","Mage_Api2_Model_Server",123],["T_DOUBLE_COLON","::",123],["T_STRING","HTTP_INTERNAL_ERROR",123],")",";",["T_WHITESPACE","\n        ",123],"}",["T_WHITESPACE"," ",124],["T_CATCH","catch",124],["T_WHITESPACE"," ",124],"(",["T_STRING","Exception",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$e",124],")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n            ",124],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","_critical",125],"(",["T_STRING","self",125],["T_DOUBLE_COLON","::",125],["T_STRING","RESOURCE_INTERNAL_ERROR",125],")",";",["T_WHITESPACE","\n        ",125],"}",["T_WHITESPACE","\n    ",126],"}",["T_WHITESPACE","\n\n    ",127],["T_DOC_COMMENT","\/**\n     * Load customer by id\n     *\n     * @param int $id\n     * @throws Mage_Api2_Exception\n     * @return Mage_Customer_Model_Customer\n     *\/",129],["T_WHITESPACE","\n    ",135],["T_PROTECTED","protected",136],["T_WHITESPACE"," ",136],["T_FUNCTION","function",136],["T_WHITESPACE"," ",136],["T_STRING","_loadCustomerById",136],"(",["T_VARIABLE","$id",136],")",["T_WHITESPACE","\n    ",136],"{",["T_WHITESPACE","\n        ",137],["T_DOC_COMMENT","\/** @var $customer Mage_Customer_Model_Customer *\/",138],["T_WHITESPACE","\n        ",138],["T_VARIABLE","$customer",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_STRING","Mage",139],["T_DOUBLE_COLON","::",139],["T_STRING","getModel",139],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/customer'",139],")",["T_OBJECT_OPERATOR","->",139],["T_STRING","load",139],"(",["T_VARIABLE","$id",139],")",";",["T_WHITESPACE","\n        ",139],["T_IF","if",140],["T_WHITESPACE"," ",140],"(","!",["T_VARIABLE","$customer",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","getId",140],"(",")",")",["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n            ",140],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","_critical",141],"(",["T_STRING","self",141],["T_DOUBLE_COLON","::",141],["T_STRING","RESOURCE_NOT_FOUND",141],")",";",["T_WHITESPACE","\n        ",141],"}",["T_WHITESPACE","\n        ",142],["T_RETURN","return",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$customer",143],";",["T_WHITESPACE","\n    ",143],"}",["T_WHITESPACE","\n\n    ",144],["T_DOC_COMMENT","\/**\n     * Retrieve collection instances\n     *\n     * @return Mage_Customer_Model_Resource_Customer_Collection\n     *\/",146],["T_WHITESPACE","\n    ",150],["T_PROTECTED","protected",151],["T_WHITESPACE"," ",151],["T_FUNCTION","function",151],["T_WHITESPACE"," ",151],["T_STRING","_getCollectionForRetrieve",151],"(",")",["T_WHITESPACE","\n    ",151],"{",["T_WHITESPACE","\n        ",152],["T_DOC_COMMENT","\/** @var $collection Mage_Customer_Model_Resource_Customer_Collection *\/",153],["T_WHITESPACE","\n        ",153],["T_VARIABLE","$collection",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_STRING","Mage",154],["T_DOUBLE_COLON","::",154],["T_STRING","getResourceModel",154],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/customer_collection'",154],")",";",["T_WHITESPACE","\n        ",154],["T_VARIABLE","$collection",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","addAttributeToSelect",155],"(",["T_STRING","array_keys",155],"(",["T_WHITESPACE","\n            ",155],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","getAvailableAttributes",156],"(",["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","getUserType",156],"(",")",",",["T_WHITESPACE"," ",156],["T_STRING","Mage_Api2_Model_Resource",156],["T_DOUBLE_COLON","::",156],["T_STRING","OPERATION_ATTRIBUTE_READ",156],")",["T_WHITESPACE","\n        ",156],")",")",";",["T_WHITESPACE","\n\n        ",157],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","_applyCollectionModifiers",159],"(",["T_VARIABLE","$collection",159],")",";",["T_WHITESPACE","\n        ",159],["T_RETURN","return",160],["T_WHITESPACE"," ",160],["T_VARIABLE","$collection",160],";",["T_WHITESPACE","\n    ",160],"}",["T_WHITESPACE","\n",161],"}",["T_WHITESPACE","\n",162]]