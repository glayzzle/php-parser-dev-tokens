[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_ImportExport\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Import entity configurable product type model\n *\n * @category    Mage\n * @package     Mage_ImportExport\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_ImportExport_Model_Import_Entity_Product_Type_Configurable",34],["T_WHITESPACE","\n    ",34],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_ImportExport_Model_Import_Entity_Product_Type_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Error codes.\n     *\/",37],["T_WHITESPACE","\n    ",39],["T_CONST","const",40],["T_WHITESPACE"," ",40],["T_STRING","ERROR_ATTRIBUTE_CODE_IS_NOT_SUPER",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'attrCodeIsNotSuper'",40],";",["T_WHITESPACE","\n    ",40],["T_CONST","const",41],["T_WHITESPACE"," ",41],["T_STRING","ERROR_INVALID_PRICE_CORRECTION",41],["T_WHITESPACE","    ",41],"=",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'invalidPriceCorr'",41],";",["T_WHITESPACE","\n    ",41],["T_CONST","const",42],["T_WHITESPACE"," ",42],["T_STRING","ERROR_INVALID_OPTION_VALUE",42],["T_WHITESPACE","        ",42],"=",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'invalidOptionValue'",42],";",["T_WHITESPACE","\n    ",42],["T_CONST","const",43],["T_WHITESPACE"," ",43],["T_STRING","ERROR_INVALID_WEBSITE",43],["T_WHITESPACE","             ",43],"=",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'invalidSuperAttrWebsite'",43],";",["T_WHITESPACE","\n\n    ",43],["T_DOC_COMMENT","\/**\n     * Validation failure message template definitions\n     *\n     * @var array\n     *\/",45],["T_WHITESPACE","\n    ",49],["T_PROTECTED","protected",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$_messageTemplates",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_ARRAY","array",50],"(",["T_WHITESPACE","\n        ",50],["T_STRING","self",51],["T_DOUBLE_COLON","::",51],["T_STRING","ERROR_ATTRIBUTE_CODE_IS_NOT_SUPER",51],["T_WHITESPACE"," ",51],["T_DOUBLE_ARROW","=>",51],["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","'Attribute with this code is not super'",51],",",["T_WHITESPACE","\n        ",51],["T_STRING","self",52],["T_DOUBLE_COLON","::",52],["T_STRING","ERROR_INVALID_PRICE_CORRECTION",52],["T_WHITESPACE","    ",52],["T_DOUBLE_ARROW","=>",52],["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'Super attribute price correction value is invalid'",52],",",["T_WHITESPACE","\n        ",52],["T_STRING","self",53],["T_DOUBLE_COLON","::",53],["T_STRING","ERROR_INVALID_OPTION_VALUE",53],["T_WHITESPACE","        ",53],["T_DOUBLE_ARROW","=>",53],["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","'Invalid option value'",53],",",["T_WHITESPACE","\n        ",53],["T_STRING","self",54],["T_DOUBLE_COLON","::",54],["T_STRING","ERROR_INVALID_WEBSITE",54],["T_WHITESPACE","             ",54],["T_DOUBLE_ARROW","=>",54],["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'Invalid website code for super attribute'",54],["T_WHITESPACE","\n    ",54],")",";",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * Column names that holds values with particular meaning.\n     *\n     * @var array\n     *\/",57],["T_WHITESPACE","\n    ",61],["T_PROTECTED","protected",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$_particularAttributes",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_ARRAY","array",62],"(",["T_WHITESPACE","\n        ",62],["T_CONSTANT_ENCAPSED_STRING","'_super_products_sku'",63],",",["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","'_super_attribute_code'",63],",",["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","'_super_attribute_option'",63],",",["T_WHITESPACE","\n        ",63],["T_CONSTANT_ENCAPSED_STRING","'_super_attribute_price_corr'",64],",",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'_super_attribute_price_website'",64],["T_WHITESPACE","\n    ",64],")",";",["T_WHITESPACE","\n\n    ",65],["T_DOC_COMMENT","\/**\n     * Reference array of existing product-attribute to product super attribute ID.\n     *\n     * product_1 (underscore) attribute_id_1 => product_super_attr_id_1,\n     * product_1 (underscore) attribute_id_2 => product_super_attr_id_2,\n     * ...,\n     * product_n (underscore) attribute_id_n => product_super_attr_id_n\n     *\n     * @var array\n     *\/",67],["T_WHITESPACE","\n    ",76],["T_PROTECTED","protected",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$_productSuperAttrs",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_ARRAY","array",77],"(",")",";",["T_WHITESPACE","\n\n    ",77],["T_DOC_COMMENT","\/**\n     * Array of SKU to array of super attribute values for all products.\n     *\n     * array (\n     *     attr_set_name_1 => array(\n     *         product_id_1 => array(\n     *             super_attribute_code_1 => attr_value_1,\n     *             ...\n     *             super_attribute_code_n => attr_value_n\n     *         ),\n     *         ...\n     *     ),\n     *   ...\n     * )\n     *\n     * @var array\n     *\/",79],["T_WHITESPACE","\n    ",95],["T_PROTECTED","protected",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$_skuSuperAttributeValues",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_ARRAY","array",96],"(",")",";",["T_WHITESPACE","\n\n    ",96],["T_DOC_COMMENT","\/**\n     * Array of SKU to array of super attributes data for validation new associated products.\n     *\n     * array (\n     *     product_id_1 => array(\n     *         super_attribute_id_1 => array(\n     *             value_index_1 => TRUE,\n     *             ...\n     *             value_index_n => TRUE\n     *         ),\n     *         ...\n     *     ),\n     *   ...\n     * )\n     *\n     * @var array\n     *\/",98],["T_WHITESPACE","\n    ",114],["T_PROTECTED","protected",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$_skuSuperData",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_ARRAY","array",115],"(",")",";",["T_WHITESPACE","\n\n    ",115],["T_DOC_COMMENT","\/**\n     * Super attributes codes in a form of code => TRUE array pairs.\n     *\n     * @var array\n     *\/",117],["T_WHITESPACE","\n    ",121],["T_PROTECTED","protected",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$_superAttributes",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_ARRAY","array",122],"(",")",";",["T_WHITESPACE","\n\n    ",122],["T_DOC_COMMENT","\/**\n     * All super attributes values combinations for each attribute set.\n     *\n     * @var array\n     *\/",124],["T_WHITESPACE","\n    ",128],["T_PROTECTED","protected",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$_superAttrValuesCombs",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_STRING","null",129],";",["T_WHITESPACE","\n\n    ",129],["T_DOC_COMMENT","\/**\n     * Add attribute parameters to appropriate attribute set.\n     *\n     * @param string $attrParams Name of attribute set.\n     * @param array $attrParams Refined attribute parameters.\n     * @return Mage_ImportExport_Model_Import_Entity_Product_Type_Abstract\n     *\/",131],["T_WHITESPACE","\n    ",137],["T_PROTECTED","protected",138],["T_WHITESPACE"," ",138],["T_FUNCTION","function",138],["T_WHITESPACE"," ",138],["T_STRING","_addAttributeParams",138],"(",["T_VARIABLE","$attrSetName",138],",",["T_WHITESPACE"," ",138],["T_ARRAY","array",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$attrParams",138],")",["T_WHITESPACE","\n    ",138],"{",["T_WHITESPACE","\n        ",139],["T_COMMENT","\/\/ save super attributes for simplier and quicker search in future\n",140],["T_WHITESPACE","        ",141],["T_IF","if",141],["T_WHITESPACE"," ",141],"(",["T_CONSTANT_ENCAPSED_STRING","'select'",141],["T_WHITESPACE"," ",141],["T_IS_EQUAL","==",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$attrParams",141],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",141],"]",["T_WHITESPACE"," ",141],["T_BOOLEAN_AND","&&",141],["T_WHITESPACE"," ",141],["T_LNUMBER","1",141],["T_WHITESPACE"," ",141],["T_IS_EQUAL","==",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$attrParams",141],"[",["T_CONSTANT_ENCAPSED_STRING","'is_global'",141],"]",["T_WHITESPACE"," ",141],["T_BOOLEAN_AND","&&",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$attrParams",141],"[",["T_CONSTANT_ENCAPSED_STRING","'for_configurable'",141],"]",")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n            ",141],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","_superAttributes",142],"[",["T_VARIABLE","$attrParams",142],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",142],"]","]",["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_VARIABLE","$attrParams",142],";",["T_WHITESPACE","\n        ",142],"}",["T_WHITESPACE","\n        ",143],["T_RETURN","return",144],["T_WHITESPACE"," ",144],["T_STRING","parent",144],["T_DOUBLE_COLON","::",144],["T_STRING","_addAttributeParams",144],"(",["T_VARIABLE","$attrSetName",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$attrParams",144],")",";",["T_WHITESPACE","\n    ",144],"}",["T_WHITESPACE","\n\n    ",145],["T_DOC_COMMENT","\/**\n     * Get super attribute ID (if it is not possible - return NULL).\n     *\n     * @param int $productId\n     * @param int $attributeId\n     * @return array|null\n     *\/",147],["T_WHITESPACE","\n    ",153],["T_PROTECTED","protected",154],["T_WHITESPACE"," ",154],["T_FUNCTION","function",154],["T_WHITESPACE"," ",154],["T_STRING","_getSuperAttributeId",154],"(",["T_VARIABLE","$productId",154],",",["T_WHITESPACE"," ",154],["T_VARIABLE","$attributeId",154],")",["T_WHITESPACE","\n    ",154],"{",["T_WHITESPACE","\n        ",155],["T_IF","if",156],["T_WHITESPACE"," ",156],"(",["T_ISSET","isset",156],"(",["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","_productSuperAttrs",156],"[","\"",["T_CURLY_OPEN","{",156],["T_VARIABLE","$productId",156],"}",["T_ENCAPSED_AND_WHITESPACE","_",156],["T_CURLY_OPEN","{",156],["T_VARIABLE","$attributeId",156],"}","\"","]",")",")",["T_WHITESPACE"," ",156],"{",["T_WHITESPACE","\n            ",156],["T_RETURN","return",157],["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","_productSuperAttrs",157],"[","\"",["T_CURLY_OPEN","{",157],["T_VARIABLE","$productId",157],"}",["T_ENCAPSED_AND_WHITESPACE","_",157],["T_CURLY_OPEN","{",157],["T_VARIABLE","$attributeId",157],"}","\"","]",";",["T_WHITESPACE","\n        ",157],"}",["T_WHITESPACE"," ",158],["T_ELSE","else",158],["T_WHITESPACE"," ",158],"{",["T_WHITESPACE","\n            ",158],["T_RETURN","return",159],["T_WHITESPACE"," ",159],["T_STRING","null",159],";",["T_WHITESPACE","\n        ",159],"}",["T_WHITESPACE","\n    ",160],"}",["T_WHITESPACE","\n\n    ",161],["T_DOC_COMMENT","\/**\n     * Have we check attribute for is_required? Used as last chance to disable this type of check.\n     *\n     * @param string $attrCode\n     * @return bool\n     *\/",163],["T_WHITESPACE","\n    ",168],["T_PROTECTED","protected",169],["T_WHITESPACE"," ",169],["T_FUNCTION","function",169],["T_WHITESPACE"," ",169],["T_STRING","_isAttributeRequiredCheckNeeded",169],"(",["T_VARIABLE","$attrCode",169],")",["T_WHITESPACE","\n    ",169],"{",["T_WHITESPACE","\n        ",170],["T_RETURN","return",171],["T_WHITESPACE"," ",171],"!",["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","_isAttributeSuper",171],"(",["T_VARIABLE","$attrCode",171],")",";",["T_WHITESPACE"," ",171],["T_COMMENT","\/\/ do not check super attributes\n",171],["T_WHITESPACE","    ",172],"}",["T_WHITESPACE","\n\n    ",172],["T_DOC_COMMENT","\/**\n     * Is attribute is super-attribute?\n     *\n     * @param string $attrCode\n     * @return boolean\n     *\/",174],["T_WHITESPACE","\n    ",179],["T_PROTECTED","protected",180],["T_WHITESPACE"," ",180],["T_FUNCTION","function",180],["T_WHITESPACE"," ",180],["T_STRING","_isAttributeSuper",180],"(",["T_VARIABLE","$attrCode",180],")",["T_WHITESPACE","\n    ",180],"{",["T_WHITESPACE","\n        ",181],["T_RETURN","return",182],["T_WHITESPACE"," ",182],["T_ISSET","isset",182],"(",["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","_superAttributes",182],"[",["T_VARIABLE","$attrCode",182],"]",")",";",["T_WHITESPACE","\n    ",182],"}",["T_WHITESPACE","\n\n    ",183],["T_DOC_COMMENT","\/**\n     * Validate particular attributes columns.\n     *\n     * @param array $rowData\n     * @param int $rowNum\n     * @return bool\n     *\/",185],["T_WHITESPACE","\n    ",191],["T_PROTECTED","protected",192],["T_WHITESPACE"," ",192],["T_FUNCTION","function",192],["T_WHITESPACE"," ",192],["T_STRING","_isParticularAttributesValid",192],"(",["T_ARRAY","array",192],["T_WHITESPACE"," ",192],["T_VARIABLE","$rowData",192],",",["T_WHITESPACE"," ",192],["T_VARIABLE","$rowNum",192],")",["T_WHITESPACE","\n    ",192],"{",["T_WHITESPACE","\n        ",193],["T_IF","if",194],["T_WHITESPACE"," ",194],"(","!",["T_EMPTY","empty",194],"(",["T_VARIABLE","$rowData",194],"[",["T_CONSTANT_ENCAPSED_STRING","'_super_attribute_code'",194],"]",")",")",["T_WHITESPACE"," ",194],"{",["T_WHITESPACE","\n            ",194],["T_VARIABLE","$superAttrCode",195],["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_VARIABLE","$rowData",195],"[",["T_CONSTANT_ENCAPSED_STRING","'_super_attribute_code'",195],"]",";",["T_WHITESPACE","\n\n            ",195],["T_IF","if",197],["T_WHITESPACE"," ",197],"(","!",["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","_isAttributeSuper",197],"(",["T_VARIABLE","$superAttrCode",197],")",")",["T_WHITESPACE"," ",197],"{",["T_WHITESPACE"," ",197],["T_COMMENT","\/\/ check attribute superity\n",197],["T_WHITESPACE","                ",198],["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","_entityModel",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","addRowError",198],"(",["T_STRING","self",198],["T_DOUBLE_COLON","::",198],["T_STRING","ERROR_ATTRIBUTE_CODE_IS_NOT_SUPER",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$rowNum",198],")",";",["T_WHITESPACE","\n                ",198],["T_RETURN","return",199],["T_WHITESPACE"," ",199],["T_STRING","false",199],";",["T_WHITESPACE","\n            ",199],"}",["T_WHITESPACE"," ",200],["T_ELSEIF","elseif",200],["T_WHITESPACE"," ",200],"(",["T_ISSET","isset",200],"(",["T_VARIABLE","$rowData",200],"[",["T_CONSTANT_ENCAPSED_STRING","'_super_attribute_option'",200],"]",")",["T_WHITESPACE"," ",200],["T_BOOLEAN_AND","&&",200],["T_WHITESPACE"," ",200],["T_STRING","strlen",200],"(",["T_VARIABLE","$rowData",200],"[",["T_CONSTANT_ENCAPSED_STRING","'_super_attribute_option'",200],"]",")",")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n                ",200],["T_VARIABLE","$optionKey",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_STRING","strtolower",201],"(",["T_VARIABLE","$rowData",201],"[",["T_CONSTANT_ENCAPSED_STRING","'_super_attribute_option'",201],"]",")",";",["T_WHITESPACE","\n                ",201],["T_IF","if",202],["T_WHITESPACE"," ",202],"(","!",["T_ISSET","isset",202],"(",["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","_superAttributes",202],"[",["T_VARIABLE","$superAttrCode",202],"]","[",["T_CONSTANT_ENCAPSED_STRING","'options'",202],"]","[",["T_VARIABLE","$optionKey",202],"]",")",")",["T_WHITESPACE"," ",202],"{",["T_WHITESPACE","\n                    ",202],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","_entityModel",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","addRowError",203],"(",["T_STRING","self",203],["T_DOUBLE_COLON","::",203],["T_STRING","ERROR_INVALID_OPTION_VALUE",203],",",["T_WHITESPACE"," ",203],["T_VARIABLE","$rowNum",203],")",";",["T_WHITESPACE","\n                    ",203],["T_RETURN","return",204],["T_WHITESPACE"," ",204],["T_STRING","false",204],";",["T_WHITESPACE","\n                ",204],"}",["T_WHITESPACE","\n                ",205],["T_COMMENT","\/\/ check price value\n",206],["T_WHITESPACE","                ",207],["T_IF","if",207],["T_WHITESPACE"," ",207],"(","!",["T_EMPTY","empty",207],"(",["T_VARIABLE","$rowData",207],"[",["T_CONSTANT_ENCAPSED_STRING","'_super_attribute_price_corr'",207],"]",")",["T_WHITESPACE","\n                    ",207],["T_BOOLEAN_AND","&&",208],["T_WHITESPACE"," ",208],"!",["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","_isPriceCorr",208],"(",["T_VARIABLE","$rowData",208],"[",["T_CONSTANT_ENCAPSED_STRING","'_super_attribute_price_corr'",208],"]",")",["T_WHITESPACE","\n                ",208],")",["T_WHITESPACE"," ",209],"{",["T_WHITESPACE","\n                    ",209],["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","_entityModel",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","addRowError",210],"(",["T_STRING","self",210],["T_DOUBLE_COLON","::",210],["T_STRING","ERROR_INVALID_PRICE_CORRECTION",210],",",["T_WHITESPACE"," ",210],["T_VARIABLE","$rowNum",210],")",";",["T_WHITESPACE","\n                    ",210],["T_RETURN","return",211],["T_WHITESPACE"," ",211],["T_STRING","false",211],";",["T_WHITESPACE","\n                ",211],"}",["T_WHITESPACE","\n            ",212],"}",["T_WHITESPACE","\n        ",213],"}",["T_WHITESPACE","\n        ",214],["T_RETURN","return",215],["T_WHITESPACE"," ",215],["T_STRING","true",215],";",["T_WHITESPACE","\n    ",215],"}",["T_WHITESPACE","\n\n    ",216],["T_DOC_COMMENT","\/**\n     * Array of SKU to array of super attribute values for all products.\n     *\n     * @return Mage_ImportExport_Model_Import_Entity_Product_Type_Configurable\n     *\/",218],["T_WHITESPACE","\n    ",222],["T_PROTECTED","protected",223],["T_WHITESPACE"," ",223],["T_FUNCTION","function",223],["T_WHITESPACE"," ",223],["T_STRING","_loadSkuSuperAttributeValues",223],"(",")",["T_WHITESPACE","\n    ",223],"{",["T_WHITESPACE","\n        ",224],["T_IF","if",225],["T_WHITESPACE"," ",225],"(",["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","_superAttributes",225],")",["T_WHITESPACE"," ",225],"{",["T_WHITESPACE","\n            ",225],["T_VARIABLE","$attrSetIdToName",226],["T_WHITESPACE","   ",226],"=",["T_WHITESPACE"," ",226],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","_entityModel",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","getAttrSetIdToName",226],"(",")",";",["T_WHITESPACE","\n            ",226],["T_VARIABLE","$allowProductTypes",227],["T_WHITESPACE"," ",227],"=",["T_WHITESPACE"," ",227],["T_ARRAY","array",227],"(",")",";",["T_WHITESPACE","\n\n            ",227],["T_FOREACH","foreach",229],["T_WHITESPACE"," ",229],"(",["T_STRING","Mage",229],["T_DOUBLE_COLON","::",229],["T_STRING","getConfig",229],"(",")",["T_WHITESPACE","\n                    ",229],["T_OBJECT_OPERATOR","->",230],["T_STRING","getNode",230],"(",["T_CONSTANT_ENCAPSED_STRING","'global\/catalog\/product\/type\/configurable\/allow_product_types'",230],")",["T_OBJECT_OPERATOR","->",230],["T_STRING","children",230],"(",")",["T_WHITESPACE"," ",230],["T_AS","as",230],["T_WHITESPACE"," ",230],["T_VARIABLE","$type",230],")",["T_WHITESPACE"," ",230],"{",["T_WHITESPACE","\n                ",230],["T_VARIABLE","$allowProductTypes",231],"[","]",["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],["T_VARIABLE","$type",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","getName",231],"(",")",";",["T_WHITESPACE","\n            ",231],"}",["T_WHITESPACE","\n            ",232],["T_DOC_COMMENT","\/** @var Mage_Catalog_Model_Resource_Product_Collection $collection *\/",233],["T_WHITESPACE","\n            ",233],["T_VARIABLE","$collection",234],["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_STRING","Mage",234],["T_DOUBLE_COLON","::",234],["T_STRING","getResourceModel",234],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_collection'",234],")",["T_WHITESPACE","\n                        ",234],["T_OBJECT_OPERATOR","->",235],["T_STRING","addFieldToFilter",235],"(",["T_CONSTANT_ENCAPSED_STRING","'type_id'",235],",",["T_WHITESPACE"," ",235],["T_VARIABLE","$allowProductTypes",235],")",["T_WHITESPACE","\n                        ",235],["T_OBJECT_OPERATOR","->",236],["T_STRING","addAttributeToSelect",236],"(",["T_STRING","array_keys",236],"(",["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","_superAttributes",236],")",")",";",["T_WHITESPACE","\n\n            ",236],["T_VARIABLE","$collectionSize",238],["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],["T_VARIABLE","$collection",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","getSize",238],"(",")",";",["T_WHITESPACE","\n            ",238],["T_IF","if",239],["T_WHITESPACE"," ",239],"(",["T_VARIABLE","$collectionSize",239],")",["T_WHITESPACE"," ",239],"{",["T_WHITESPACE","\n                ",239],["T_VARIABLE","$configPageSize",240],["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],["T_STRING","Mage",240],["T_DOUBLE_COLON","::",240],["T_STRING","helper",240],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",240],")",["T_OBJECT_OPERATOR","->",240],["T_STRING","getImportConfigurablePageSize",240],"(",")",";",["T_WHITESPACE","\n                ",240],["T_VARIABLE","$pageSize",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],"(",["T_VARIABLE","$configPageSize",241],["T_WHITESPACE"," ",241],">",["T_WHITESPACE"," ",241],["T_LNUMBER","0",241],")",["T_WHITESPACE"," ",241],"?",["T_WHITESPACE"," ",241],["T_VARIABLE","$configPageSize",241],["T_WHITESPACE"," ",241],":",["T_WHITESPACE"," ",241],["T_VARIABLE","$collectionSize",241],";",["T_WHITESPACE","\n                ",241],["T_VARIABLE","$page",242],["T_WHITESPACE"," ",242],"=",["T_WHITESPACE"," ",242],["T_LNUMBER","0",242],";",["T_WHITESPACE","\n                ",242],["T_VARIABLE","$collection",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","setPageSize",243],"(",["T_VARIABLE","$pageSize",243],")",";",["T_WHITESPACE","\n                ",243],["T_WHILE","while",244],["T_WHITESPACE"," ",244],"(",["T_VARIABLE","$pageSize",244],["T_WHITESPACE"," ",244],"*",["T_WHITESPACE"," ",244],["T_VARIABLE","$page",244],["T_WHITESPACE"," ",244],"<",["T_WHITESPACE"," ",244],["T_VARIABLE","$collectionSize",244],")",["T_WHITESPACE"," ",244],"{",["T_WHITESPACE","\n                    ",244],["T_VARIABLE","$page",245],["T_INC","++",245],";",["T_WHITESPACE","\n                    ",245],["T_VARIABLE","$collection",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","setCurPage",246],"(",["T_VARIABLE","$page",246],")",";",["T_WHITESPACE","\n\n                    ",246],["T_FOREACH","foreach",248],["T_WHITESPACE"," ",248],"(",["T_VARIABLE","$collection",248],["T_WHITESPACE"," ",248],["T_AS","as",248],["T_WHITESPACE"," ",248],["T_VARIABLE","$product",248],")",["T_WHITESPACE"," ",248],"{",["T_WHITESPACE","\n                        ",248],["T_VARIABLE","$attrSetName",249],["T_WHITESPACE"," ",249],"=",["T_WHITESPACE"," ",249],["T_VARIABLE","$attrSetIdToName",249],"[",["T_VARIABLE","$product",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","getAttributeSetId",249],"(",")","]",";",["T_WHITESPACE","\n\n                        ",249],["T_VARIABLE","$data",251],["T_WHITESPACE"," ",251],"=",["T_WHITESPACE"," ",251],["T_STRING","array_intersect_key",251],"(",["T_WHITESPACE","\n                            ",251],["T_VARIABLE","$product",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","getData",252],"(",")",",",["T_WHITESPACE","\n                            ",252],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","_superAttributes",253],["T_WHITESPACE","\n                        ",253],")",";",["T_WHITESPACE","\n                        ",254],["T_FOREACH","foreach",255],["T_WHITESPACE"," ",255],"(",["T_VARIABLE","$data",255],["T_WHITESPACE"," ",255],["T_AS","as",255],["T_WHITESPACE"," ",255],["T_VARIABLE","$attrCode",255],["T_WHITESPACE"," ",255],["T_DOUBLE_ARROW","=>",255],["T_WHITESPACE"," ",255],["T_VARIABLE","$value",255],")",["T_WHITESPACE"," ",255],"{",["T_WHITESPACE","\n                            ",255],["T_VARIABLE","$attrId",256],["T_WHITESPACE"," ",256],"=",["T_WHITESPACE"," ",256],["T_VARIABLE","$this",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","_superAttributes",256],"[",["T_VARIABLE","$attrCode",256],"]","[",["T_CONSTANT_ENCAPSED_STRING","'id'",256],"]",";",["T_WHITESPACE","\n                            ",256],["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","_skuSuperAttributeValues",257],"[",["T_VARIABLE","$attrSetName",257],"]","[",["T_VARIABLE","$product",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","getId",257],"(",")","]","[",["T_VARIABLE","$attrId",257],"]",["T_WHITESPACE"," ",257],"=",["T_WHITESPACE"," ",257],["T_VARIABLE","$value",257],";",["T_WHITESPACE","\n                        ",257],"}",["T_WHITESPACE","\n                    ",258],"}",["T_WHITESPACE","\n                    ",259],["T_VARIABLE","$collection",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","clear",260],"(",")",";",["T_WHITESPACE","\n                ",260],"}",["T_WHITESPACE","\n            ",261],"}",["T_WHITESPACE","\n        ",262],"}",["T_WHITESPACE","\n        ",263],["T_RETURN","return",264],["T_WHITESPACE"," ",264],["T_VARIABLE","$this",264],";",["T_WHITESPACE","\n    ",264],"}",["T_WHITESPACE","\n\n    ",265],["T_DOC_COMMENT","\/**\n     * Array of SKU to array of super attribute values for all products.\n     *\n     * @return Mage_ImportExport_Model_Import_Entity_Product_Type_Configurable\n     *\/",267],["T_WHITESPACE","\n    ",271],["T_PROTECTED","protected",272],["T_WHITESPACE"," ",272],["T_FUNCTION","function",272],["T_WHITESPACE"," ",272],["T_STRING","_loadSkuSuperData",272],"(",")",["T_WHITESPACE","\n    ",272],"{",["T_WHITESPACE","\n        ",273],["T_IF","if",274],["T_WHITESPACE"," ",274],"(","!",["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","_skuSuperData",274],")",["T_WHITESPACE"," ",274],"{",["T_WHITESPACE","\n            ",274],["T_VARIABLE","$connection",275],["T_WHITESPACE"," ",275],"=",["T_WHITESPACE"," ",275],["T_VARIABLE","$this",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","_entityModel",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","getConnection",275],"(",")",";",["T_WHITESPACE","\n            ",275],["T_VARIABLE","$mainTable",276],["T_WHITESPACE","  ",276],"=",["T_WHITESPACE"," ",276],["T_STRING","Mage",276],["T_DOUBLE_COLON","::",276],["T_STRING","getSingleton",276],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/resource'",276],")",["T_OBJECT_OPERATOR","->",276],["T_STRING","getTableName",276],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_super_attribute'",276],")",";",["T_WHITESPACE","\n            ",276],["T_VARIABLE","$priceTable",277],["T_WHITESPACE"," ",277],"=",["T_WHITESPACE"," ",277],["T_STRING","Mage",277],["T_DOUBLE_COLON","::",277],["T_STRING","getSingleton",277],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/resource'",277],")",["T_OBJECT_OPERATOR","->",277],["T_STRING","getTableName",277],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_super_attribute_pricing'",277],")",";",["T_WHITESPACE","\n            ",277],["T_VARIABLE","$select",278],["T_WHITESPACE","     ",278],"=",["T_WHITESPACE"," ",278],["T_VARIABLE","$connection",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","select",278],"(",")",["T_WHITESPACE","\n                    ",278],["T_OBJECT_OPERATOR","->",279],["T_STRING","from",279],"(",["T_ARRAY","array",279],"(",["T_CONSTANT_ENCAPSED_STRING","'m'",279],["T_WHITESPACE"," ",279],["T_DOUBLE_ARROW","=>",279],["T_WHITESPACE"," ",279],["T_VARIABLE","$mainTable",279],")",",",["T_WHITESPACE"," ",279],["T_ARRAY","array",279],"(",["T_CONSTANT_ENCAPSED_STRING","'product_id'",279],",",["T_WHITESPACE"," ",279],["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",279],",",["T_WHITESPACE"," ",279],["T_CONSTANT_ENCAPSED_STRING","'product_super_attribute_id'",279],")",")",["T_WHITESPACE","\n                    ",279],["T_OBJECT_OPERATOR","->",280],["T_STRING","joinLeft",280],"(",["T_WHITESPACE","\n                        ",280],["T_ARRAY","array",281],"(",["T_CONSTANT_ENCAPSED_STRING","'p'",281],["T_WHITESPACE"," ",281],["T_DOUBLE_ARROW","=>",281],["T_WHITESPACE"," ",281],["T_VARIABLE","$priceTable",281],")",",",["T_WHITESPACE","\n                        ",281],["T_VARIABLE","$connection",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","quoteIdentifier",282],"(",["T_CONSTANT_ENCAPSED_STRING","'p.product_super_attribute_id'",282],")",["T_WHITESPACE"," ",282],".",["T_WHITESPACE"," ",282],["T_CONSTANT_ENCAPSED_STRING","' = '",282],["T_WHITESPACE","\n                        ",282],".",["T_WHITESPACE"," ",283],["T_VARIABLE","$connection",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","quoteIdentifier",283],"(",["T_CONSTANT_ENCAPSED_STRING","'m.product_super_attribute_id'",283],")",",",["T_WHITESPACE","\n                        ",283],["T_ARRAY","array",284],"(",["T_CONSTANT_ENCAPSED_STRING","'value_index'",284],")",["T_WHITESPACE","\n                    ",284],")",";",["T_WHITESPACE","\n\n            ",285],["T_FOREACH","foreach",287],["T_WHITESPACE"," ",287],"(",["T_VARIABLE","$connection",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","fetchAll",287],"(",["T_VARIABLE","$select",287],")",["T_WHITESPACE"," ",287],["T_AS","as",287],["T_WHITESPACE"," ",287],["T_VARIABLE","$row",287],")",["T_WHITESPACE"," ",287],"{",["T_WHITESPACE","\n                ",287],["T_VARIABLE","$attrId",288],["T_WHITESPACE"," ",288],"=",["T_WHITESPACE"," ",288],["T_VARIABLE","$row",288],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",288],"]",";",["T_WHITESPACE","\n                ",288],["T_VARIABLE","$productId",289],["T_WHITESPACE"," ",289],"=",["T_WHITESPACE"," ",289],["T_VARIABLE","$row",289],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",289],"]",";",["T_WHITESPACE","\n                ",289],["T_IF","if",290],["T_WHITESPACE"," ",290],"(",["T_VARIABLE","$row",290],"[",["T_CONSTANT_ENCAPSED_STRING","'value_index'",290],"]",")",["T_WHITESPACE"," ",290],"{",["T_WHITESPACE","\n                    ",290],["T_VARIABLE","$this",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","_skuSuperData",291],"[",["T_VARIABLE","$productId",291],"]","[",["T_VARIABLE","$attrId",291],"]","[",["T_VARIABLE","$row",291],"[",["T_CONSTANT_ENCAPSED_STRING","'value_index'",291],"]","]",["T_WHITESPACE"," ",291],"=",["T_WHITESPACE"," ",291],["T_STRING","true",291],";",["T_WHITESPACE","\n                ",291],"}",["T_WHITESPACE","\n                ",292],["T_VARIABLE","$this",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","_productSuperAttrs",293],"[","\"",["T_CURLY_OPEN","{",293],["T_VARIABLE","$productId",293],"}",["T_ENCAPSED_AND_WHITESPACE","_",293],["T_CURLY_OPEN","{",293],["T_VARIABLE","$attrId",293],"}","\"","]",["T_WHITESPACE"," ",293],"=",["T_WHITESPACE"," ",293],["T_VARIABLE","$row",293],"[",["T_CONSTANT_ENCAPSED_STRING","'product_super_attribute_id'",293],"]",";",["T_WHITESPACE","\n            ",293],"}",["T_WHITESPACE","\n        ",294],"}",["T_WHITESPACE","\n        ",295],["T_RETURN","return",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$this",296],";",["T_WHITESPACE","\n    ",296],"}",["T_WHITESPACE","\n\n    ",297],["T_DOC_COMMENT","\/**\n     * Validate and prepare data about super attributes and associated products.\n     *\n     * @param array $superData\n     * @param array $superAttributes\n     * @return Mage_ImportExport_Model_Import_Entity_Product_Type_Configurable\n     *\/",299],["T_WHITESPACE","\n    ",305],["T_PROTECTED","protected",306],["T_WHITESPACE"," ",306],["T_FUNCTION","function",306],["T_WHITESPACE"," ",306],["T_STRING","_processSuperData",306],"(",["T_ARRAY","array",306],["T_WHITESPACE"," ",306],["T_VARIABLE","$superData",306],",",["T_WHITESPACE"," ",306],["T_ARRAY","array",306],["T_WHITESPACE"," ",306],"&",["T_VARIABLE","$superAttributes",306],")",["T_WHITESPACE","\n    ",306],"{",["T_WHITESPACE","\n        ",307],["T_IF","if",308],["T_WHITESPACE"," ",308],"(",["T_VARIABLE","$superData",308],")",["T_WHITESPACE"," ",308],"{",["T_WHITESPACE","\n            ",308],["T_VARIABLE","$usedCombs",309],["T_WHITESPACE"," ",309],"=",["T_WHITESPACE"," ",309],["T_ARRAY","array",309],"(",")",";",["T_WHITESPACE","\n            ",309],["T_COMMENT","\/\/ is associated products applicable?\n",310],["T_WHITESPACE","            ",311],["T_FOREACH","foreach",311],["T_WHITESPACE"," ",311],"(",["T_STRING","array_keys",311],"(",["T_VARIABLE","$superData",311],"[",["T_CONSTANT_ENCAPSED_STRING","'assoc_ids'",311],"]",")",["T_WHITESPACE"," ",311],["T_AS","as",311],["T_WHITESPACE"," ",311],["T_VARIABLE","$assocId",311],")",["T_WHITESPACE"," ",311],"{",["T_WHITESPACE","\n                ",311],["T_IF","if",312],["T_WHITESPACE"," ",312],"(","!",["T_ISSET","isset",312],"(",["T_VARIABLE","$this",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","_skuSuperAttributeValues",312],"[",["T_VARIABLE","$superData",312],"[",["T_CONSTANT_ENCAPSED_STRING","'attr_set_code'",312],"]","]","[",["T_VARIABLE","$assocId",312],"]",")",")",["T_WHITESPACE"," ",312],"{",["T_WHITESPACE","\n                    ",312],["T_CONTINUE","continue",313],";",["T_WHITESPACE","\n                ",313],"}",["T_WHITESPACE","\n                ",314],["T_IF","if",315],["T_WHITESPACE"," ",315],"(",["T_VARIABLE","$superData",315],"[",["T_CONSTANT_ENCAPSED_STRING","'used_attributes'",315],"]",")",["T_WHITESPACE"," ",315],"{",["T_WHITESPACE","\n                    ",315],["T_VARIABLE","$skuSuperValues",316],["T_WHITESPACE"," ",316],"=",["T_WHITESPACE"," ",316],["T_VARIABLE","$this",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","_skuSuperAttributeValues",316],"[",["T_VARIABLE","$superData",316],"[",["T_CONSTANT_ENCAPSED_STRING","'attr_set_code'",316],"]","]","[",["T_VARIABLE","$assocId",316],"]",";",["T_WHITESPACE","\n                    ",316],["T_VARIABLE","$usedCombParts",317],["T_WHITESPACE","  ",317],"=",["T_WHITESPACE"," ",317],["T_ARRAY","array",317],"(",")",";",["T_WHITESPACE","\n\n                    ",317],["T_FOREACH","foreach",319],["T_WHITESPACE"," ",319],"(",["T_VARIABLE","$superData",319],"[",["T_CONSTANT_ENCAPSED_STRING","'used_attributes'",319],"]",["T_WHITESPACE"," ",319],["T_AS","as",319],["T_WHITESPACE"," ",319],["T_VARIABLE","$usedAttrId",319],["T_WHITESPACE"," ",319],["T_DOUBLE_ARROW","=>",319],["T_WHITESPACE"," ",319],["T_VARIABLE","$usedValues",319],")",["T_WHITESPACE"," ",319],"{",["T_WHITESPACE","\n                        ",319],["T_IF","if",320],["T_WHITESPACE"," ",320],"(",["T_EMPTY","empty",320],"(",["T_VARIABLE","$skuSuperValues",320],"[",["T_VARIABLE","$usedAttrId",320],"]",")",["T_WHITESPACE"," ",320],["T_BOOLEAN_OR","||",320],["T_WHITESPACE"," ",320],"!",["T_ISSET","isset",320],"(",["T_VARIABLE","$usedValues",320],"[",["T_VARIABLE","$skuSuperValues",320],"[",["T_VARIABLE","$usedAttrId",320],"]","]",")",")",["T_WHITESPACE"," ",320],"{",["T_WHITESPACE","\n                            ",320],["T_CONTINUE","continue",321],";",["T_WHITESPACE"," ",321],["T_COMMENT","\/\/ invalid value or value does not exists for associated product\n",321],["T_WHITESPACE","                        ",322],"}",["T_WHITESPACE","\n                        ",322],["T_VARIABLE","$usedCombParts",323],"[","]",["T_WHITESPACE"," ",323],"=",["T_WHITESPACE"," ",323],["T_VARIABLE","$skuSuperValues",323],"[",["T_VARIABLE","$usedAttrId",323],"]",";",["T_WHITESPACE","\n                        ",323],["T_VARIABLE","$superData",324],"[",["T_CONSTANT_ENCAPSED_STRING","'used_attributes'",324],"]","[",["T_VARIABLE","$usedAttrId",324],"]","[",["T_VARIABLE","$skuSuperValues",324],"[",["T_VARIABLE","$usedAttrId",324],"]","]",["T_WHITESPACE"," ",324],"=",["T_WHITESPACE"," ",324],["T_STRING","true",324],";",["T_WHITESPACE","\n                    ",324],"}",["T_WHITESPACE","\n                    ",325],["T_VARIABLE","$comb",326],["T_WHITESPACE"," ",326],"=",["T_WHITESPACE"," ",326],["T_STRING","implode",326],"(",["T_CONSTANT_ENCAPSED_STRING","'|'",326],",",["T_WHITESPACE"," ",326],["T_VARIABLE","$usedCombParts",326],")",";",["T_WHITESPACE","\n\n                    ",326],["T_IF","if",328],["T_WHITESPACE"," ",328],"(",["T_ISSET","isset",328],"(",["T_VARIABLE","$usedCombs",328],"[",["T_VARIABLE","$comb",328],"]",")",")",["T_WHITESPACE"," ",328],"{",["T_WHITESPACE","\n                        ",328],["T_CONTINUE","continue",329],";",["T_WHITESPACE"," ",329],["T_COMMENT","\/\/ super attributes values combination was already used\n",329],["T_WHITESPACE","                    ",330],"}",["T_WHITESPACE","\n                    ",330],["T_VARIABLE","$usedCombs",331],"[",["T_VARIABLE","$comb",331],"]",["T_WHITESPACE"," ",331],"=",["T_WHITESPACE"," ",331],["T_STRING","true",331],";",["T_WHITESPACE","\n                ",331],"}",["T_WHITESPACE","\n                ",332],["T_VARIABLE","$superAttributes",333],"[",["T_CONSTANT_ENCAPSED_STRING","'super_link'",333],"]","[","]",["T_WHITESPACE"," ",333],"=",["T_WHITESPACE"," ",333],["T_ARRAY","array",333],"(",["T_WHITESPACE","\n                    ",333],["T_CONSTANT_ENCAPSED_STRING","'product_id'",334],["T_WHITESPACE"," ",334],["T_DOUBLE_ARROW","=>",334],["T_WHITESPACE"," ",334],["T_VARIABLE","$assocId",334],",",["T_WHITESPACE"," ",334],["T_CONSTANT_ENCAPSED_STRING","'parent_id'",334],["T_WHITESPACE"," ",334],["T_DOUBLE_ARROW","=>",334],["T_WHITESPACE"," ",334],["T_VARIABLE","$superData",334],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",334],"]",["T_WHITESPACE","\n                ",334],")",";",["T_WHITESPACE","\n                ",335],["T_VARIABLE","$superAttributes",336],"[",["T_CONSTANT_ENCAPSED_STRING","'relation'",336],"]","[","]",["T_WHITESPACE"," ",336],"=",["T_WHITESPACE"," ",336],["T_ARRAY","array",336],"(",["T_WHITESPACE","\n                    ",336],["T_CONSTANT_ENCAPSED_STRING","'parent_id'",337],["T_WHITESPACE"," ",337],["T_DOUBLE_ARROW","=>",337],["T_WHITESPACE"," ",337],["T_VARIABLE","$superData",337],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",337],"]",",",["T_WHITESPACE"," ",337],["T_CONSTANT_ENCAPSED_STRING","'child_id'",337],["T_WHITESPACE"," ",337],["T_DOUBLE_ARROW","=>",337],["T_WHITESPACE"," ",337],["T_VARIABLE","$assocId",337],["T_WHITESPACE","\n                ",337],")",";",["T_WHITESPACE","\n            ",338],"}",["T_WHITESPACE","\n            ",339],["T_COMMENT","\/\/ clean up unused values pricing\n",340],["T_WHITESPACE","            ",341],["T_FOREACH","foreach",341],["T_WHITESPACE"," ",341],"(",["T_VARIABLE","$superData",341],"[",["T_CONSTANT_ENCAPSED_STRING","'used_attributes'",341],"]",["T_WHITESPACE"," ",341],["T_AS","as",341],["T_WHITESPACE"," ",341],["T_VARIABLE","$usedAttrId",341],["T_WHITESPACE"," ",341],["T_DOUBLE_ARROW","=>",341],["T_WHITESPACE"," ",341],["T_VARIABLE","$usedValues",341],")",["T_WHITESPACE"," ",341],"{",["T_WHITESPACE","\n                ",341],["T_FOREACH","foreach",342],["T_WHITESPACE"," ",342],"(",["T_VARIABLE","$usedValues",342],["T_WHITESPACE"," ",342],["T_AS","as",342],["T_WHITESPACE"," ",342],["T_VARIABLE","$optionId",342],["T_WHITESPACE"," ",342],["T_DOUBLE_ARROW","=>",342],["T_WHITESPACE"," ",342],["T_VARIABLE","$isUsed",342],")",["T_WHITESPACE"," ",342],"{",["T_WHITESPACE","\n                    ",342],["T_IF","if",343],["T_WHITESPACE"," ",343],"(","!",["T_VARIABLE","$isUsed",343],["T_WHITESPACE","\n                        ",343],["T_BOOLEAN_AND","&&",344],["T_WHITESPACE"," ",344],["T_ISSET","isset",344],"(",["T_VARIABLE","$superAttributes",344],"[",["T_CONSTANT_ENCAPSED_STRING","'pricing'",344],"]","[",["T_VARIABLE","$superData",344],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",344],"]","]","[",["T_VARIABLE","$usedAttrId",344],"]",")",["T_WHITESPACE","\n                    ",344],")",["T_WHITESPACE"," ",345],"{",["T_WHITESPACE","\n                        ",345],["T_FOREACH","foreach",346],["T_WHITESPACE"," ",346],"(",["T_VARIABLE","$superAttributes",346],"[",["T_CONSTANT_ENCAPSED_STRING","'pricing'",346],"]","[",["T_VARIABLE","$superData",346],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",346],"]","]","[",["T_VARIABLE","$usedAttrId",346],"]",["T_WHITESPACE"," ",346],["T_AS","as",346],["T_WHITESPACE"," ",346],["T_VARIABLE","$k",346],["T_WHITESPACE"," ",346],["T_DOUBLE_ARROW","=>",346],["T_WHITESPACE"," ",346],["T_VARIABLE","$params",346],")",["T_WHITESPACE"," ",346],"{",["T_WHITESPACE","\n                            ",346],["T_IF","if",347],["T_WHITESPACE"," ",347],"(",["T_VARIABLE","$optionId",347],["T_WHITESPACE"," ",347],["T_IS_EQUAL","==",347],["T_WHITESPACE"," ",347],["T_VARIABLE","$params",347],"[",["T_CONSTANT_ENCAPSED_STRING","'value_index'",347],"]",")",["T_WHITESPACE"," ",347],"{",["T_WHITESPACE","\n                                ",347],["T_UNSET","unset",348],"(",["T_VARIABLE","$superAttributes",348],"[",["T_CONSTANT_ENCAPSED_STRING","'pricing'",348],"]","[",["T_VARIABLE","$superData",348],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",348],"]","]","[",["T_VARIABLE","$usedAttrId",348],"]","[",["T_VARIABLE","$k",348],"]",")",";",["T_WHITESPACE","\n                            ",348],"}",["T_WHITESPACE","\n                        ",349],"}",["T_WHITESPACE","\n                    ",350],"}",["T_WHITESPACE","\n                ",351],"}",["T_WHITESPACE","\n            ",352],"}",["T_WHITESPACE","\n        ",353],"}",["T_WHITESPACE","\n        ",354],["T_RETURN","return",355],["T_WHITESPACE"," ",355],["T_VARIABLE","$this",355],";",["T_WHITESPACE","\n    ",355],"}",["T_WHITESPACE","\n\n    ",356],["T_DOC_COMMENT","\/**\n     * Save product type specific data.\n     *\n     * @throws Exception\n     * @return Mage_ImportExport_Model_Import_Entity_Product_Type_Abstract\n     *\/",358],["T_WHITESPACE","\n    ",363],["T_PUBLIC","public",364],["T_WHITESPACE"," ",364],["T_FUNCTION","function",364],["T_WHITESPACE"," ",364],["T_STRING","saveData",364],"(",")",["T_WHITESPACE","\n    ",364],"{",["T_WHITESPACE","\n        ",365],["T_VARIABLE","$connection",366],["T_WHITESPACE","      ",366],"=",["T_WHITESPACE"," ",366],["T_VARIABLE","$this",366],["T_OBJECT_OPERATOR","->",366],["T_STRING","_entityModel",366],["T_OBJECT_OPERATOR","->",366],["T_STRING","getConnection",366],"(",")",";",["T_WHITESPACE","\n        ",366],["T_VARIABLE","$mainTable",367],["T_WHITESPACE","       ",367],"=",["T_WHITESPACE"," ",367],["T_STRING","Mage",367],["T_DOUBLE_COLON","::",367],["T_STRING","getSingleton",367],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/resource'",367],")",["T_OBJECT_OPERATOR","->",367],["T_STRING","getTableName",367],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_super_attribute'",367],")",";",["T_WHITESPACE","\n        ",367],["T_VARIABLE","$labelTable",368],["T_WHITESPACE","      ",368],"=",["T_WHITESPACE"," ",368],["T_STRING","Mage",368],["T_DOUBLE_COLON","::",368],["T_STRING","getSingleton",368],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/resource'",368],")",["T_OBJECT_OPERATOR","->",368],["T_STRING","getTableName",368],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_super_attribute_label'",368],")",";",["T_WHITESPACE","\n        ",368],["T_VARIABLE","$priceTable",369],["T_WHITESPACE","      ",369],"=",["T_WHITESPACE"," ",369],["T_STRING","Mage",369],["T_DOUBLE_COLON","::",369],["T_STRING","getSingleton",369],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/resource'",369],")",["T_OBJECT_OPERATOR","->",369],["T_STRING","getTableName",369],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_super_attribute_pricing'",369],")",";",["T_WHITESPACE","\n        ",369],["T_VARIABLE","$linkTable",370],["T_WHITESPACE","       ",370],"=",["T_WHITESPACE"," ",370],["T_STRING","Mage",370],["T_DOUBLE_COLON","::",370],["T_STRING","getSingleton",370],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/resource'",370],")",["T_OBJECT_OPERATOR","->",370],["T_STRING","getTableName",370],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_super_link'",370],")",";",["T_WHITESPACE","\n        ",370],["T_VARIABLE","$relationTable",371],["T_WHITESPACE","   ",371],"=",["T_WHITESPACE"," ",371],["T_STRING","Mage",371],["T_DOUBLE_COLON","::",371],["T_STRING","getSingleton",371],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/resource'",371],")",["T_OBJECT_OPERATOR","->",371],["T_STRING","getTableName",371],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_relation'",371],")",";",["T_WHITESPACE","\n        ",371],["T_VARIABLE","$newSku",372],["T_WHITESPACE","          ",372],"=",["T_WHITESPACE"," ",372],["T_VARIABLE","$this",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","_entityModel",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","getNewSku",372],"(",")",";",["T_WHITESPACE","\n        ",372],["T_VARIABLE","$oldSku",373],["T_WHITESPACE","          ",373],"=",["T_WHITESPACE"," ",373],["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","_entityModel",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","getOldSku",373],"(",")",";",["T_WHITESPACE","\n        ",373],["T_VARIABLE","$productSuperData",374],["T_WHITESPACE"," ",374],"=",["T_WHITESPACE"," ",374],["T_ARRAY","array",374],"(",")",";",["T_WHITESPACE","\n        ",374],["T_VARIABLE","$productData",375],["T_WHITESPACE","     ",375],"=",["T_WHITESPACE"," ",375],["T_STRING","null",375],";",["T_WHITESPACE","\n        ",375],["T_VARIABLE","$nextAttrId",376],["T_WHITESPACE","      ",376],"=",["T_WHITESPACE"," ",376],["T_STRING","Mage",376],["T_DOUBLE_COLON","::",376],["T_STRING","getResourceHelper",376],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",376],")",["T_OBJECT_OPERATOR","->",376],["T_STRING","getNextAutoincrement",376],"(",["T_VARIABLE","$mainTable",376],")",";",["T_WHITESPACE","\n\n        ",376],["T_IF","if",378],["T_WHITESPACE"," ",378],"(",["T_VARIABLE","$this",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","_entityModel",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","getBehavior",378],"(",")",["T_WHITESPACE"," ",378],["T_IS_EQUAL","==",378],["T_WHITESPACE"," ",378],["T_STRING","Mage_ImportExport_Model_Import",378],["T_DOUBLE_COLON","::",378],["T_STRING","BEHAVIOR_APPEND",378],")",["T_WHITESPACE"," ",378],"{",["T_WHITESPACE","\n            ",378],["T_VARIABLE","$this",379],["T_OBJECT_OPERATOR","->",379],["T_STRING","_loadSkuSuperData",379],"(",")",";",["T_WHITESPACE","\n        ",379],"}",["T_WHITESPACE","\n        ",380],["T_VARIABLE","$this",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","_loadSkuSuperAttributeValues",381],"(",")",";",["T_WHITESPACE","\n\n        ",381],["T_WHILE","while",383],["T_WHITESPACE"," ",383],"(",["T_VARIABLE","$bunch",383],["T_WHITESPACE"," ",383],"=",["T_WHITESPACE"," ",383],["T_VARIABLE","$this",383],["T_OBJECT_OPERATOR","->",383],["T_STRING","_entityModel",383],["T_OBJECT_OPERATOR","->",383],["T_STRING","getNextBunch",383],"(",")",")",["T_WHITESPACE"," ",383],"{",["T_WHITESPACE","\n            ",383],["T_VARIABLE","$superAttributes",384],["T_WHITESPACE"," ",384],"=",["T_WHITESPACE"," ",384],["T_ARRAY","array",384],"(",["T_WHITESPACE","\n                ",384],["T_CONSTANT_ENCAPSED_STRING","'attributes'",385],["T_WHITESPACE"," ",385],["T_DOUBLE_ARROW","=>",385],["T_WHITESPACE"," ",385],["T_ARRAY","array",385],"(",")",",",["T_WHITESPACE","\n                ",385],["T_CONSTANT_ENCAPSED_STRING","'labels'",386],["T_WHITESPACE","     ",386],["T_DOUBLE_ARROW","=>",386],["T_WHITESPACE"," ",386],["T_ARRAY","array",386],"(",")",",",["T_WHITESPACE","\n                ",386],["T_CONSTANT_ENCAPSED_STRING","'pricing'",387],["T_WHITESPACE","    ",387],["T_DOUBLE_ARROW","=>",387],["T_WHITESPACE"," ",387],["T_ARRAY","array",387],"(",")",",",["T_WHITESPACE","\n                ",387],["T_CONSTANT_ENCAPSED_STRING","'super_link'",388],["T_WHITESPACE"," ",388],["T_DOUBLE_ARROW","=>",388],["T_WHITESPACE"," ",388],["T_ARRAY","array",388],"(",")",",",["T_WHITESPACE","\n                ",388],["T_CONSTANT_ENCAPSED_STRING","'relation'",389],["T_WHITESPACE","   ",389],["T_DOUBLE_ARROW","=>",389],["T_WHITESPACE"," ",389],["T_ARRAY","array",389],"(",")",["T_WHITESPACE","\n            ",389],")",";",["T_WHITESPACE","\n            ",390],["T_FOREACH","foreach",391],["T_WHITESPACE"," ",391],"(",["T_VARIABLE","$bunch",391],["T_WHITESPACE"," ",391],["T_AS","as",391],["T_WHITESPACE"," ",391],["T_VARIABLE","$rowNum",391],["T_WHITESPACE"," ",391],["T_DOUBLE_ARROW","=>",391],["T_WHITESPACE"," ",391],["T_VARIABLE","$rowData",391],")",["T_WHITESPACE"," ",391],"{",["T_WHITESPACE","\n                ",391],["T_IF","if",392],["T_WHITESPACE"," ",392],"(","!",["T_VARIABLE","$this",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","_entityModel",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","isRowAllowedToImport",392],"(",["T_VARIABLE","$rowData",392],",",["T_WHITESPACE"," ",392],["T_VARIABLE","$rowNum",392],")",")",["T_WHITESPACE"," ",392],"{",["T_WHITESPACE","\n                    ",392],["T_CONTINUE","continue",393],";",["T_WHITESPACE","\n                ",393],"}",["T_WHITESPACE","\n                ",394],["T_COMMENT","\/\/ remember SCOPE_DEFAULT row data\n",395],["T_WHITESPACE","                ",396],["T_VARIABLE","$scope",396],["T_WHITESPACE"," ",396],"=",["T_WHITESPACE"," ",396],["T_VARIABLE","$this",396],["T_OBJECT_OPERATOR","->",396],["T_STRING","_entityModel",396],["T_OBJECT_OPERATOR","->",396],["T_STRING","getRowScope",396],"(",["T_VARIABLE","$rowData",396],")",";",["T_WHITESPACE","\n                ",396],["T_IF","if",397],["T_WHITESPACE"," ",397],"(",["T_STRING","Mage_ImportExport_Model_Import_Entity_Product",397],["T_DOUBLE_COLON","::",397],["T_STRING","SCOPE_DEFAULT",397],["T_WHITESPACE"," ",397],["T_IS_EQUAL","==",397],["T_WHITESPACE"," ",397],["T_VARIABLE","$scope",397],")",["T_WHITESPACE"," ",397],"{",["T_WHITESPACE","\n                    ",397],["T_VARIABLE","$productData",398],["T_WHITESPACE"," ",398],"=",["T_WHITESPACE"," ",398],["T_VARIABLE","$newSku",398],"[",["T_VARIABLE","$rowData",398],"[",["T_STRING","Mage_ImportExport_Model_Import_Entity_Product",398],["T_DOUBLE_COLON","::",398],["T_STRING","COL_SKU",398],"]","]",";",["T_WHITESPACE","\n\n                    ",398],["T_IF","if",400],["T_WHITESPACE"," ",400],"(",["T_VARIABLE","$this",400],["T_OBJECT_OPERATOR","->",400],["T_STRING","_type",400],["T_WHITESPACE"," ",400],["T_IS_NOT_EQUAL","!=",400],["T_WHITESPACE"," ",400],["T_VARIABLE","$productData",400],"[",["T_CONSTANT_ENCAPSED_STRING","'type_id'",400],"]",")",["T_WHITESPACE"," ",400],"{",["T_WHITESPACE","\n                        ",400],["T_VARIABLE","$productData",401],["T_WHITESPACE"," ",401],"=",["T_WHITESPACE"," ",401],["T_STRING","null",401],";",["T_WHITESPACE","\n                        ",401],["T_CONTINUE","continue",402],";",["T_WHITESPACE","\n                    ",402],"}",["T_WHITESPACE","\n                    ",403],["T_VARIABLE","$productId",404],["T_WHITESPACE"," ",404],"=",["T_WHITESPACE"," ",404],["T_VARIABLE","$productData",404],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",404],"]",";",["T_WHITESPACE","\n\n                    ",404],["T_VARIABLE","$this",406],["T_OBJECT_OPERATOR","->",406],["T_STRING","_processSuperData",406],"(",["T_VARIABLE","$productSuperData",406],",",["T_WHITESPACE"," ",406],["T_VARIABLE","$superAttributes",406],")",";",["T_WHITESPACE","\n\n                    ",406],["T_VARIABLE","$productSuperData",408],["T_WHITESPACE"," ",408],"=",["T_WHITESPACE"," ",408],["T_ARRAY","array",408],"(",["T_WHITESPACE","\n                        ",408],["T_CONSTANT_ENCAPSED_STRING","'product_id'",409],["T_WHITESPACE","      ",409],["T_DOUBLE_ARROW","=>",409],["T_WHITESPACE"," ",409],["T_VARIABLE","$productId",409],",",["T_WHITESPACE","\n                        ",409],["T_CONSTANT_ENCAPSED_STRING","'attr_set_code'",410],["T_WHITESPACE","   ",410],["T_DOUBLE_ARROW","=>",410],["T_WHITESPACE"," ",410],["T_VARIABLE","$productData",410],"[",["T_CONSTANT_ENCAPSED_STRING","'attr_set_code'",410],"]",",",["T_WHITESPACE","\n                        ",410],["T_CONSTANT_ENCAPSED_STRING","'used_attributes'",411],["T_WHITESPACE"," ",411],["T_DOUBLE_ARROW","=>",411],["T_WHITESPACE"," ",411],["T_EMPTY","empty",411],"(",["T_VARIABLE","$this",411],["T_OBJECT_OPERATOR","->",411],["T_STRING","_skuSuperData",411],"[",["T_VARIABLE","$productId",411],"]",")",["T_WHITESPACE","\n                                             ",411],"?",["T_WHITESPACE"," ",412],["T_ARRAY","array",412],"(",")",["T_WHITESPACE"," ",412],":",["T_WHITESPACE"," ",412],["T_VARIABLE","$this",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","_skuSuperData",412],"[",["T_VARIABLE","$productId",412],"]",",",["T_WHITESPACE","\n                        ",412],["T_CONSTANT_ENCAPSED_STRING","'assoc_ids'",413],["T_WHITESPACE","       ",413],["T_DOUBLE_ARROW","=>",413],["T_WHITESPACE"," ",413],["T_ARRAY","array",413],"(",")",["T_WHITESPACE","\n                    ",413],")",";",["T_WHITESPACE","\n                ",414],"}",["T_WHITESPACE"," ",415],["T_ELSEIF","elseif",415],["T_WHITESPACE"," ",415],"(",["T_STRING","null",415],["T_WHITESPACE"," ",415],["T_IS_IDENTICAL","===",415],["T_WHITESPACE"," ",415],["T_VARIABLE","$productData",415],")",["T_WHITESPACE"," ",415],"{",["T_WHITESPACE","\n                    ",415],["T_CONTINUE","continue",416],";",["T_WHITESPACE","\n                ",416],"}",["T_WHITESPACE","\n                ",417],["T_IF","if",418],["T_WHITESPACE"," ",418],"(","!",["T_EMPTY","empty",418],"(",["T_VARIABLE","$rowData",418],"[",["T_CONSTANT_ENCAPSED_STRING","'_super_products_sku'",418],"]",")",")",["T_WHITESPACE"," ",418],"{",["T_WHITESPACE","\n                    ",418],["T_IF","if",419],["T_WHITESPACE"," ",419],"(",["T_ISSET","isset",419],"(",["T_VARIABLE","$newSku",419],"[",["T_VARIABLE","$rowData",419],"[",["T_CONSTANT_ENCAPSED_STRING","'_super_products_sku'",419],"]","]",")",")",["T_WHITESPACE"," ",419],"{",["T_WHITESPACE","\n                        ",419],["T_VARIABLE","$productSuperData",420],"[",["T_CONSTANT_ENCAPSED_STRING","'assoc_ids'",420],"]","[",["T_VARIABLE","$newSku",420],"[",["T_VARIABLE","$rowData",420],"[",["T_CONSTANT_ENCAPSED_STRING","'_super_products_sku'",420],"]","]","[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",420],"]","]",["T_WHITESPACE"," ",420],"=",["T_WHITESPACE"," ",420],["T_STRING","true",420],";",["T_WHITESPACE","\n                    ",420],"}",["T_WHITESPACE"," ",421],["T_ELSEIF","elseif",421],["T_WHITESPACE"," ",421],"(",["T_ISSET","isset",421],"(",["T_VARIABLE","$oldSku",421],"[",["T_VARIABLE","$rowData",421],"[",["T_CONSTANT_ENCAPSED_STRING","'_super_products_sku'",421],"]","]",")",")",["T_WHITESPACE"," ",421],"{",["T_WHITESPACE","\n                        ",421],["T_VARIABLE","$productSuperData",422],"[",["T_CONSTANT_ENCAPSED_STRING","'assoc_ids'",422],"]","[",["T_VARIABLE","$oldSku",422],"[",["T_VARIABLE","$rowData",422],"[",["T_CONSTANT_ENCAPSED_STRING","'_super_products_sku'",422],"]","]","[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",422],"]","]",["T_WHITESPACE"," ",422],"=",["T_WHITESPACE"," ",422],["T_STRING","true",422],";",["T_WHITESPACE","\n                    ",422],"}",["T_WHITESPACE","\n                ",423],"}",["T_WHITESPACE","\n                ",424],["T_IF","if",425],["T_WHITESPACE"," ",425],"(",["T_EMPTY","empty",425],"(",["T_VARIABLE","$rowData",425],"[",["T_CONSTANT_ENCAPSED_STRING","'_super_attribute_code'",425],"]",")",")",["T_WHITESPACE"," ",425],"{",["T_WHITESPACE","\n                    ",425],["T_CONTINUE","continue",426],";",["T_WHITESPACE","\n                ",426],"}",["T_WHITESPACE","\n                ",427],["T_VARIABLE","$attrParams",428],["T_WHITESPACE"," ",428],"=",["T_WHITESPACE"," ",428],["T_VARIABLE","$this",428],["T_OBJECT_OPERATOR","->",428],["T_STRING","_superAttributes",428],"[",["T_VARIABLE","$rowData",428],"[",["T_CONSTANT_ENCAPSED_STRING","'_super_attribute_code'",428],"]","]",";",["T_WHITESPACE","\n\n                ",428],["T_IF","if",430],["T_WHITESPACE"," ",430],"(",["T_VARIABLE","$this",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","_getSuperAttributeId",430],"(",["T_VARIABLE","$productId",430],",",["T_WHITESPACE"," ",430],["T_VARIABLE","$attrParams",430],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",430],"]",")",")",["T_WHITESPACE"," ",430],"{",["T_WHITESPACE","\n                    ",430],["T_VARIABLE","$productSuperAttrId",431],["T_WHITESPACE"," ",431],"=",["T_WHITESPACE"," ",431],["T_VARIABLE","$this",431],["T_OBJECT_OPERATOR","->",431],["T_STRING","_getSuperAttributeId",431],"(",["T_VARIABLE","$productId",431],",",["T_WHITESPACE"," ",431],["T_VARIABLE","$attrParams",431],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",431],"]",")",";",["T_WHITESPACE","\n                ",431],"}",["T_WHITESPACE"," ",432],["T_ELSEIF","elseif",432],["T_WHITESPACE"," ",432],"(","!",["T_ISSET","isset",432],"(",["T_VARIABLE","$superAttributes",432],"[",["T_CONSTANT_ENCAPSED_STRING","'attributes'",432],"]","[",["T_VARIABLE","$productId",432],"]","[",["T_VARIABLE","$attrParams",432],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",432],"]","]",")",")",["T_WHITESPACE"," ",432],"{",["T_WHITESPACE","\n                    ",432],["T_VARIABLE","$productSuperAttrId",433],["T_WHITESPACE"," ",433],"=",["T_WHITESPACE"," ",433],["T_VARIABLE","$nextAttrId",433],["T_INC","++",433],";",["T_WHITESPACE","\n                    ",433],["T_VARIABLE","$superAttributes",434],"[",["T_CONSTANT_ENCAPSED_STRING","'attributes'",434],"]","[",["T_VARIABLE","$productId",434],"]","[",["T_VARIABLE","$attrParams",434],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",434],"]","]",["T_WHITESPACE"," ",434],"=",["T_WHITESPACE"," ",434],["T_ARRAY","array",434],"(",["T_WHITESPACE","\n                        ",434],["T_CONSTANT_ENCAPSED_STRING","'product_super_attribute_id'",435],["T_WHITESPACE"," ",435],["T_DOUBLE_ARROW","=>",435],["T_WHITESPACE"," ",435],["T_VARIABLE","$productSuperAttrId",435],",",["T_WHITESPACE"," ",435],["T_CONSTANT_ENCAPSED_STRING","'position'",435],["T_WHITESPACE"," ",435],["T_DOUBLE_ARROW","=>",435],["T_WHITESPACE"," ",435],["T_LNUMBER","0",435],["T_WHITESPACE","\n                    ",435],")",";",["T_WHITESPACE","\n                    ",436],["T_VARIABLE","$superAttributes",437],"[",["T_CONSTANT_ENCAPSED_STRING","'labels'",437],"]","[","]",["T_WHITESPACE"," ",437],"=",["T_WHITESPACE"," ",437],["T_ARRAY","array",437],"(",["T_WHITESPACE","\n                        ",437],["T_CONSTANT_ENCAPSED_STRING","'product_super_attribute_id'",438],["T_WHITESPACE"," ",438],["T_DOUBLE_ARROW","=>",438],["T_WHITESPACE"," ",438],["T_VARIABLE","$productSuperAttrId",438],",",["T_WHITESPACE","\n                        ",438],["T_CONSTANT_ENCAPSED_STRING","'store_id'",439],["T_WHITESPACE","    ",439],["T_DOUBLE_ARROW","=>",439],["T_WHITESPACE"," ",439],["T_LNUMBER","0",439],",",["T_WHITESPACE","\n                        ",439],["T_CONSTANT_ENCAPSED_STRING","'use_default'",440],["T_WHITESPACE"," ",440],["T_DOUBLE_ARROW","=>",440],["T_WHITESPACE"," ",440],["T_LNUMBER","1",440],",",["T_WHITESPACE","\n                        ",440],["T_CONSTANT_ENCAPSED_STRING","'value'",441],["T_WHITESPACE","       ",441],["T_DOUBLE_ARROW","=>",441],["T_WHITESPACE"," ",441],["T_VARIABLE","$attrParams",441],"[",["T_CONSTANT_ENCAPSED_STRING","'frontend_label'",441],"]",["T_WHITESPACE","\n                    ",441],")",";",["T_WHITESPACE","\n                ",442],"}",["T_WHITESPACE","\n                ",443],["T_IF","if",444],["T_WHITESPACE"," ",444],"(",["T_ISSET","isset",444],"(",["T_VARIABLE","$rowData",444],"[",["T_CONSTANT_ENCAPSED_STRING","'_super_attribute_option'",444],"]",")",["T_WHITESPACE"," ",444],["T_BOOLEAN_AND","&&",444],["T_WHITESPACE"," ",444],["T_STRING","strlen",444],"(",["T_VARIABLE","$rowData",444],"[",["T_CONSTANT_ENCAPSED_STRING","'_super_attribute_option'",444],"]",")",")",["T_WHITESPACE"," ",444],"{",["T_WHITESPACE","\n                    ",444],["T_VARIABLE","$optionId",445],["T_WHITESPACE"," ",445],"=",["T_WHITESPACE"," ",445],["T_VARIABLE","$attrParams",445],"[",["T_CONSTANT_ENCAPSED_STRING","'options'",445],"]","[",["T_STRING","strtolower",445],"(",["T_VARIABLE","$rowData",445],"[",["T_CONSTANT_ENCAPSED_STRING","'_super_attribute_option'",445],"]",")","]",";",["T_WHITESPACE","\n\n                    ",445],["T_IF","if",447],["T_WHITESPACE"," ",447],"(","!",["T_ISSET","isset",447],"(",["T_VARIABLE","$productSuperData",447],"[",["T_CONSTANT_ENCAPSED_STRING","'used_attributes'",447],"]","[",["T_VARIABLE","$attrParams",447],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",447],"]","]","[",["T_VARIABLE","$optionId",447],"]",")",")",["T_WHITESPACE"," ",447],"{",["T_WHITESPACE","\n                        ",447],["T_VARIABLE","$productSuperData",448],"[",["T_CONSTANT_ENCAPSED_STRING","'used_attributes'",448],"]","[",["T_VARIABLE","$attrParams",448],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",448],"]","]","[",["T_VARIABLE","$optionId",448],"]",["T_WHITESPACE"," ",448],"=",["T_WHITESPACE"," ",448],["T_STRING","false",448],";",["T_WHITESPACE","\n                    ",448],"}",["T_WHITESPACE","\n                    ",449],["T_IF","if",450],["T_WHITESPACE"," ",450],"(","!",["T_EMPTY","empty",450],"(",["T_VARIABLE","$rowData",450],"[",["T_CONSTANT_ENCAPSED_STRING","'_super_attribute_price_corr'",450],"]",")",")",["T_WHITESPACE"," ",450],"{",["T_WHITESPACE","\n                        ",450],["T_VARIABLE","$superAttributes",451],"[",["T_CONSTANT_ENCAPSED_STRING","'pricing'",451],"]","[","]",["T_WHITESPACE"," ",451],"=",["T_WHITESPACE"," ",451],["T_ARRAY","array",451],"(",["T_WHITESPACE","\n                            ",451],["T_CONSTANT_ENCAPSED_STRING","'product_super_attribute_id'",452],["T_WHITESPACE"," ",452],["T_DOUBLE_ARROW","=>",452],["T_WHITESPACE"," ",452],["T_VARIABLE","$productSuperAttrId",452],",",["T_WHITESPACE","\n                            ",452],["T_CONSTANT_ENCAPSED_STRING","'value_index'",453],["T_WHITESPACE","   ",453],["T_DOUBLE_ARROW","=>",453],["T_WHITESPACE"," ",453],["T_VARIABLE","$optionId",453],",",["T_WHITESPACE","\n                            ",453],["T_CONSTANT_ENCAPSED_STRING","'is_percent'",454],["T_WHITESPACE","    ",454],["T_DOUBLE_ARROW","=>",454],["T_WHITESPACE"," ",454],["T_CONSTANT_ENCAPSED_STRING","'%'",454],["T_WHITESPACE"," ",454],["T_IS_EQUAL","==",454],["T_WHITESPACE"," ",454],["T_STRING","substr",454],"(",["T_VARIABLE","$rowData",454],"[",["T_CONSTANT_ENCAPSED_STRING","'_super_attribute_price_corr'",454],"]",",",["T_WHITESPACE"," ",454],"-",["T_LNUMBER","1",454],")",",",["T_WHITESPACE","\n                            ",454],["T_CONSTANT_ENCAPSED_STRING","'pricing_value'",455],["T_WHITESPACE"," ",455],["T_DOUBLE_ARROW","=>",455],["T_WHITESPACE"," ",455],["T_DOUBLE_CAST","(float)",455],["T_WHITESPACE"," ",455],["T_STRING","rtrim",455],"(",["T_VARIABLE","$rowData",455],"[",["T_CONSTANT_ENCAPSED_STRING","'_super_attribute_price_corr'",455],"]",",",["T_WHITESPACE"," ",455],["T_CONSTANT_ENCAPSED_STRING","'%'",455],")",",",["T_WHITESPACE","\n                            ",455],["T_CONSTANT_ENCAPSED_STRING","'website_id'",456],["T_WHITESPACE","    ",456],["T_DOUBLE_ARROW","=>",456],["T_WHITESPACE"," ",456],["T_LNUMBER","0",456],["T_WHITESPACE","\n                        ",456],")",";",["T_WHITESPACE","\n                    ",457],"}",["T_WHITESPACE","\n                ",458],"}",["T_WHITESPACE","\n            ",459],"}",["T_WHITESPACE","\n            ",460],["T_COMMENT","\/\/ save last product super data\n",461],["T_WHITESPACE","            ",462],["T_VARIABLE","$this",462],["T_OBJECT_OPERATOR","->",462],["T_STRING","_processSuperData",462],"(",["T_VARIABLE","$productSuperData",462],",",["T_WHITESPACE"," ",462],["T_VARIABLE","$superAttributes",462],")",";",["T_WHITESPACE","\n\n            ",462],["T_COMMENT","\/\/ remove old data if needed\n",464],["T_WHITESPACE","            ",465],["T_IF","if",465],["T_WHITESPACE"," ",465],"(",["T_VARIABLE","$this",465],["T_OBJECT_OPERATOR","->",465],["T_STRING","_entityModel",465],["T_OBJECT_OPERATOR","->",465],["T_STRING","getBehavior",465],"(",")",["T_WHITESPACE"," ",465],["T_IS_NOT_EQUAL","!=",465],["T_WHITESPACE"," ",465],["T_STRING","Mage_ImportExport_Model_Import",465],["T_DOUBLE_COLON","::",465],["T_STRING","BEHAVIOR_APPEND",465],["T_WHITESPACE","\n                ",465],["T_BOOLEAN_AND","&&",466],["T_WHITESPACE"," ",466],["T_VARIABLE","$superAttributes",466],"[",["T_CONSTANT_ENCAPSED_STRING","'attributes'",466],"]",")",["T_WHITESPACE"," ",466],"{",["T_WHITESPACE","\n                ",466],["T_VARIABLE","$quoted",467],["T_WHITESPACE"," ",467],"=",["T_WHITESPACE"," ",467],["T_VARIABLE","$connection",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","quoteInto",467],"(",["T_CONSTANT_ENCAPSED_STRING","'IN (?)'",467],",",["T_WHITESPACE"," ",467],["T_STRING","array_keys",467],"(",["T_VARIABLE","$superAttributes",467],"[",["T_CONSTANT_ENCAPSED_STRING","'attributes'",467],"]",")",")",";",["T_WHITESPACE","\n                ",467],["T_VARIABLE","$connection",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","delete",468],"(",["T_VARIABLE","$mainTable",468],",",["T_WHITESPACE"," ",468],"\"",["T_ENCAPSED_AND_WHITESPACE","product_id ",468],["T_CURLY_OPEN","{",468],["T_VARIABLE","$quoted",468],"}","\"",")",";",["T_WHITESPACE","\n                ",468],["T_VARIABLE","$connection",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","delete",469],"(",["T_VARIABLE","$linkTable",469],",",["T_WHITESPACE"," ",469],"\"",["T_ENCAPSED_AND_WHITESPACE","parent_id ",469],["T_CURLY_OPEN","{",469],["T_VARIABLE","$quoted",469],"}","\"",")",";",["T_WHITESPACE","\n                ",469],["T_VARIABLE","$connection",470],["T_OBJECT_OPERATOR","->",470],["T_STRING","delete",470],"(",["T_VARIABLE","$relationTable",470],",",["T_WHITESPACE"," ",470],"\"",["T_ENCAPSED_AND_WHITESPACE","parent_id ",470],["T_CURLY_OPEN","{",470],["T_VARIABLE","$quoted",470],"}","\"",")",";",["T_WHITESPACE","\n            ",470],"}",["T_WHITESPACE","\n            ",471],["T_VARIABLE","$mainData",472],["T_WHITESPACE"," ",472],"=",["T_WHITESPACE"," ",472],["T_ARRAY","array",472],"(",")",";",["T_WHITESPACE","\n\n            ",472],["T_FOREACH","foreach",474],["T_WHITESPACE"," ",474],"(",["T_VARIABLE","$superAttributes",474],"[",["T_CONSTANT_ENCAPSED_STRING","'attributes'",474],"]",["T_WHITESPACE"," ",474],["T_AS","as",474],["T_WHITESPACE"," ",474],["T_VARIABLE","$productId",474],["T_WHITESPACE"," ",474],["T_DOUBLE_ARROW","=>",474],["T_WHITESPACE"," ",474],["T_VARIABLE","$attributesData",474],")",["T_WHITESPACE"," ",474],"{",["T_WHITESPACE","\n                ",474],["T_FOREACH","foreach",475],["T_WHITESPACE"," ",475],"(",["T_VARIABLE","$attributesData",475],["T_WHITESPACE"," ",475],["T_AS","as",475],["T_WHITESPACE"," ",475],["T_VARIABLE","$attrId",475],["T_WHITESPACE"," ",475],["T_DOUBLE_ARROW","=>",475],["T_WHITESPACE"," ",475],["T_VARIABLE","$row",475],")",["T_WHITESPACE"," ",475],"{",["T_WHITESPACE","\n                    ",475],["T_VARIABLE","$row",476],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",476],"]",["T_WHITESPACE","   ",476],"=",["T_WHITESPACE"," ",476],["T_VARIABLE","$productId",476],";",["T_WHITESPACE","\n                    ",476],["T_VARIABLE","$row",477],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",477],"]",["T_WHITESPACE"," ",477],"=",["T_WHITESPACE"," ",477],["T_VARIABLE","$attrId",477],";",["T_WHITESPACE","\n                    ",477],["T_VARIABLE","$mainData",478],"[","]",["T_WHITESPACE","          ",478],"=",["T_WHITESPACE"," ",478],["T_VARIABLE","$row",478],";",["T_WHITESPACE","\n                ",478],"}",["T_WHITESPACE","\n            ",479],"}",["T_WHITESPACE","\n            ",480],["T_IF","if",481],["T_WHITESPACE"," ",481],"(",["T_VARIABLE","$mainData",481],")",["T_WHITESPACE"," ",481],"{",["T_WHITESPACE","\n                ",481],["T_VARIABLE","$connection",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","insertOnDuplicate",482],"(",["T_VARIABLE","$mainTable",482],",",["T_WHITESPACE"," ",482],["T_VARIABLE","$mainData",482],")",";",["T_WHITESPACE","\n            ",482],"}",["T_WHITESPACE","\n            ",483],["T_IF","if",484],["T_WHITESPACE"," ",484],"(",["T_VARIABLE","$superAttributes",484],"[",["T_CONSTANT_ENCAPSED_STRING","'labels'",484],"]",")",["T_WHITESPACE"," ",484],"{",["T_WHITESPACE","\n                ",484],["T_VARIABLE","$connection",485],["T_OBJECT_OPERATOR","->",485],["T_STRING","insertOnDuplicate",485],"(",["T_VARIABLE","$labelTable",485],",",["T_WHITESPACE"," ",485],["T_VARIABLE","$superAttributes",485],"[",["T_CONSTANT_ENCAPSED_STRING","'labels'",485],"]",")",";",["T_WHITESPACE","\n            ",485],"}",["T_WHITESPACE","\n            ",486],["T_IF","if",487],["T_WHITESPACE"," ",487],"(",["T_VARIABLE","$superAttributes",487],"[",["T_CONSTANT_ENCAPSED_STRING","'pricing'",487],"]",")",["T_WHITESPACE"," ",487],"{",["T_WHITESPACE","\n                ",487],["T_VARIABLE","$connection",488],["T_OBJECT_OPERATOR","->",488],["T_STRING","insertOnDuplicate",488],"(",["T_WHITESPACE","\n                    ",488],["T_VARIABLE","$priceTable",489],",",["T_WHITESPACE","\n                    ",489],["T_VARIABLE","$superAttributes",490],"[",["T_CONSTANT_ENCAPSED_STRING","'pricing'",490],"]",",",["T_WHITESPACE","\n                    ",490],["T_ARRAY","array",491],"(",["T_CONSTANT_ENCAPSED_STRING","'is_percent'",491],",",["T_WHITESPACE"," ",491],["T_CONSTANT_ENCAPSED_STRING","'pricing_value'",491],")",["T_WHITESPACE","\n                ",491],")",";",["T_WHITESPACE","\n            ",492],"}",["T_WHITESPACE","\n            ",493],["T_IF","if",494],["T_WHITESPACE"," ",494],"(",["T_VARIABLE","$superAttributes",494],"[",["T_CONSTANT_ENCAPSED_STRING","'super_link'",494],"]",")",["T_WHITESPACE"," ",494],"{",["T_WHITESPACE","\n                ",494],["T_VARIABLE","$connection",495],["T_OBJECT_OPERATOR","->",495],["T_STRING","insertOnDuplicate",495],"(",["T_VARIABLE","$linkTable",495],",",["T_WHITESPACE"," ",495],["T_VARIABLE","$superAttributes",495],"[",["T_CONSTANT_ENCAPSED_STRING","'super_link'",495],"]",")",";",["T_WHITESPACE","\n            ",495],"}",["T_WHITESPACE","\n            ",496],["T_IF","if",497],["T_WHITESPACE"," ",497],"(",["T_VARIABLE","$superAttributes",497],"[",["T_CONSTANT_ENCAPSED_STRING","'relation'",497],"]",")",["T_WHITESPACE"," ",497],"{",["T_WHITESPACE","\n                ",497],["T_VARIABLE","$connection",498],["T_OBJECT_OPERATOR","->",498],["T_STRING","insertOnDuplicate",498],"(",["T_VARIABLE","$relationTable",498],",",["T_WHITESPACE"," ",498],["T_VARIABLE","$superAttributes",498],"[",["T_CONSTANT_ENCAPSED_STRING","'relation'",498],"]",")",";",["T_WHITESPACE","\n            ",498],"}",["T_WHITESPACE","\n        ",499],"}",["T_WHITESPACE","\n        ",500],["T_RETURN","return",501],["T_WHITESPACE"," ",501],["T_VARIABLE","$this",501],";",["T_WHITESPACE","\n    ",501],"}",["T_WHITESPACE","\n",502],"}",["T_WHITESPACE","\n",503]]