[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_ImportExport\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Export model\n *\n * @category    Mage\n * @package     Mage_ImportExport\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_ImportExport_Model_Export",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_ImportExport_Model_Abstract",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_CONST","const",36],["T_WHITESPACE"," ",36],["T_STRING","FILTER_ELEMENT_GROUP",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'export_filter'",36],";",["T_WHITESPACE","\n    ",36],["T_CONST","const",37],["T_WHITESPACE"," ",37],["T_STRING","FILTER_ELEMENT_SKIP",37],["T_WHITESPACE","  ",37],"=",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'skip_attr'",37],";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * Filter fields types.\n     *\/",39],["T_WHITESPACE","\n    ",41],["T_CONST","const",42],["T_WHITESPACE"," ",42],["T_STRING","FILTER_TYPE_SELECT",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'select'",42],";",["T_WHITESPACE","\n    ",42],["T_CONST","const",43],["T_WHITESPACE"," ",43],["T_STRING","FILTER_TYPE_INPUT",43],["T_WHITESPACE","  ",43],"=",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'input'",43],";",["T_WHITESPACE","\n    ",43],["T_CONST","const",44],["T_WHITESPACE"," ",44],["T_STRING","FILTER_TYPE_DATE",44],["T_WHITESPACE","   ",44],"=",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'date'",44],";",["T_WHITESPACE","\n    ",44],["T_CONST","const",45],["T_WHITESPACE"," ",45],["T_STRING","FILTER_TYPE_NUMBER",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'number'",45],";",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * Config keys.\n     *\/",47],["T_WHITESPACE","\n    ",49],["T_CONST","const",50],["T_WHITESPACE"," ",50],["T_STRING","CONFIG_KEY_ENTITIES",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","'global\/importexport\/export_entities'",50],";",["T_WHITESPACE","\n    ",50],["T_CONST","const",51],["T_WHITESPACE"," ",51],["T_STRING","CONFIG_KEY_FORMATS",51],["T_WHITESPACE","  ",51],"=",["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","'global\/importexport\/export_file_formats'",51],";",["T_WHITESPACE","\n\n    ",51],["T_DOC_COMMENT","\/**\n     * Entity adapter.\n     *\n     * @var Mage_ImportExport_Model_Export_Entity_Abstract\n     *\/",53],["T_WHITESPACE","\n    ",57],["T_PROTECTED","protected",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$_entityAdapter",58],";",["T_WHITESPACE","\n\n    ",58],["T_DOC_COMMENT","\/**\n     * Writer object instance.\n     *\n     * @var Mage_ImportExport_Model_Export_Adapter_Abstract\n     *\/",60],["T_WHITESPACE","\n    ",64],["T_PROTECTED","protected",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$_writer",65],";",["T_WHITESPACE","\n\n    ",65],["T_DOC_COMMENT","\/**\n     * Create instance of entity adapter and returns it.\n     *\n     * @throws Exception\n     * @return Mage_ImportExport_Model_Export_Entity_Abstract\n     *\/",67],["T_WHITESPACE","\n    ",72],["T_PROTECTED","protected",73],["T_WHITESPACE"," ",73],["T_FUNCTION","function",73],["T_WHITESPACE"," ",73],["T_STRING","_getEntityAdapter",73],"(",")",["T_WHITESPACE","\n    ",73],"{",["T_WHITESPACE","\n        ",74],["T_IF","if",75],["T_WHITESPACE"," ",75],"(","!",["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","_entityAdapter",75],")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n            ",75],["T_VARIABLE","$validTypes",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_STRING","Mage_ImportExport_Model_Config",76],["T_DOUBLE_COLON","::",76],["T_STRING","getModels",76],"(",["T_STRING","self",76],["T_DOUBLE_COLON","::",76],["T_STRING","CONFIG_KEY_ENTITIES",76],")",";",["T_WHITESPACE","\n\n            ",76],["T_IF","if",78],["T_WHITESPACE"," ",78],"(",["T_ISSET","isset",78],"(",["T_VARIABLE","$validTypes",78],"[",["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getEntity",78],"(",")","]",")",")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n                ",78],["T_TRY","try",79],["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n                    ",79],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","_entityAdapter",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_STRING","Mage",80],["T_DOUBLE_COLON","::",80],["T_STRING","getModel",80],"(",["T_VARIABLE","$validTypes",80],"[",["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getEntity",80],"(",")","]","[",["T_CONSTANT_ENCAPSED_STRING","'model'",80],"]",")",";",["T_WHITESPACE","\n                ",80],"}",["T_WHITESPACE"," ",81],["T_CATCH","catch",81],["T_WHITESPACE"," ",81],"(",["T_STRING","Exception",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$e",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n                    ",81],["T_STRING","Mage",82],["T_DOUBLE_COLON","::",82],["T_STRING","logException",82],"(",["T_VARIABLE","$e",82],")",";",["T_WHITESPACE","\n                    ",82],["T_STRING","Mage",83],["T_DOUBLE_COLON","::",83],["T_STRING","throwException",83],"(",["T_WHITESPACE","\n                        ",83],["T_STRING","Mage",84],["T_DOUBLE_COLON","::",84],["T_STRING","helper",84],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",84],")",["T_OBJECT_OPERATOR","->",84],["T_STRING","__",84],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid entity model'",84],")",["T_WHITESPACE","\n                    ",84],")",";",["T_WHITESPACE","\n                ",85],"}",["T_WHITESPACE","\n                ",86],["T_IF","if",87],["T_WHITESPACE"," ",87],"(","!",["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","_entityAdapter",87],["T_WHITESPACE"," ",87],["T_INSTANCEOF","instanceof",87],["T_WHITESPACE"," ",87],["T_STRING","Mage_ImportExport_Model_Export_Entity_Abstract",87],")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n                    ",87],["T_STRING","Mage",88],["T_DOUBLE_COLON","::",88],["T_STRING","throwException",88],"(",["T_WHITESPACE","\n                        ",88],["T_STRING","Mage",89],["T_DOUBLE_COLON","::",89],["T_STRING","helper",89],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",89],")",["T_OBJECT_OPERATOR","->",89],["T_STRING","__",89],"(",["T_CONSTANT_ENCAPSED_STRING","'Entity adapter obejct must be an instance of Mage_ImportExport_Model_Export_Entity_Abstract'",89],")",["T_WHITESPACE","\n                    ",89],")",";",["T_WHITESPACE","\n                ",90],"}",["T_WHITESPACE","\n            ",91],"}",["T_WHITESPACE"," ",92],["T_ELSE","else",92],["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n                ",92],["T_STRING","Mage",93],["T_DOUBLE_COLON","::",93],["T_STRING","throwException",93],"(",["T_STRING","Mage",93],["T_DOUBLE_COLON","::",93],["T_STRING","helper",93],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",93],")",["T_OBJECT_OPERATOR","->",93],["T_STRING","__",93],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid entity'",93],")",")",";",["T_WHITESPACE","\n            ",93],"}",["T_WHITESPACE","\n            ",94],["T_COMMENT","\/\/ check for entity codes integrity\n",95],["T_WHITESPACE","            ",96],["T_IF","if",96],["T_WHITESPACE"," ",96],"(",["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getEntity",96],"(",")",["T_WHITESPACE"," ",96],["T_IS_NOT_EQUAL","!=",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","_entityAdapter",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getEntityTypeCode",96],"(",")",")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n                ",96],["T_STRING","Mage",97],["T_DOUBLE_COLON","::",97],["T_STRING","throwException",97],"(",["T_WHITESPACE","\n                    ",97],["T_STRING","Mage",98],["T_DOUBLE_COLON","::",98],["T_STRING","helper",98],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",98],")",["T_OBJECT_OPERATOR","->",98],["T_STRING","__",98],"(",["T_CONSTANT_ENCAPSED_STRING","'Input entity code is not equal to entity adapter code'",98],")",["T_WHITESPACE","\n                ",98],")",";",["T_WHITESPACE","\n            ",99],"}",["T_WHITESPACE","\n            ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","_entityAdapter",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","setParameters",101],"(",["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getData",101],"(",")",")",";",["T_WHITESPACE","\n        ",101],"}",["T_WHITESPACE","\n        ",102],["T_RETURN","return",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","_entityAdapter",103],";",["T_WHITESPACE","\n    ",103],"}",["T_WHITESPACE","\n\n    ",104],["T_DOC_COMMENT","\/**\n     * Get writer object.\n     *\n     * @throws Mage_Core_Exception\n     * @return Mage_ImportExport_Model_Export_Adapter_Abstract\n     *\/",106],["T_WHITESPACE","\n    ",111],["T_PROTECTED","protected",112],["T_WHITESPACE"," ",112],["T_FUNCTION","function",112],["T_WHITESPACE"," ",112],["T_STRING","_getWriter",112],"(",")",["T_WHITESPACE","\n    ",112],"{",["T_WHITESPACE","\n        ",113],["T_IF","if",114],["T_WHITESPACE"," ",114],"(","!",["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","_writer",114],")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n            ",114],["T_VARIABLE","$validWriters",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_STRING","Mage_ImportExport_Model_Config",115],["T_DOUBLE_COLON","::",115],["T_STRING","getModels",115],"(",["T_STRING","self",115],["T_DOUBLE_COLON","::",115],["T_STRING","CONFIG_KEY_FORMATS",115],")",";",["T_WHITESPACE","\n\n            ",115],["T_IF","if",117],["T_WHITESPACE"," ",117],"(",["T_ISSET","isset",117],"(",["T_VARIABLE","$validWriters",117],"[",["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getFileFormat",117],"(",")","]",")",")",["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n                ",117],["T_TRY","try",118],["T_WHITESPACE"," ",118],"{",["T_WHITESPACE","\n                    ",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_writer",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_STRING","Mage",119],["T_DOUBLE_COLON","::",119],["T_STRING","getModel",119],"(",["T_VARIABLE","$validWriters",119],"[",["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getFileFormat",119],"(",")","]","[",["T_CONSTANT_ENCAPSED_STRING","'model'",119],"]",")",";",["T_WHITESPACE","\n                ",119],"}",["T_WHITESPACE"," ",120],["T_CATCH","catch",120],["T_WHITESPACE"," ",120],"(",["T_STRING","Exception",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$e",120],")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n                    ",120],["T_STRING","Mage",121],["T_DOUBLE_COLON","::",121],["T_STRING","logException",121],"(",["T_VARIABLE","$e",121],")",";",["T_WHITESPACE","\n                    ",121],["T_STRING","Mage",122],["T_DOUBLE_COLON","::",122],["T_STRING","throwException",122],"(",["T_WHITESPACE","\n                        ",122],["T_STRING","Mage",123],["T_DOUBLE_COLON","::",123],["T_STRING","helper",123],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",123],")",["T_OBJECT_OPERATOR","->",123],["T_STRING","__",123],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid entity model'",123],")",["T_WHITESPACE","\n                    ",123],")",";",["T_WHITESPACE","\n                ",124],"}",["T_WHITESPACE","\n                ",125],["T_IF","if",126],["T_WHITESPACE"," ",126],"(","!",["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","_writer",126],["T_WHITESPACE"," ",126],["T_INSTANCEOF","instanceof",126],["T_WHITESPACE"," ",126],["T_STRING","Mage_ImportExport_Model_Export_Adapter_Abstract",126],")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n                    ",126],["T_STRING","Mage",127],["T_DOUBLE_COLON","::",127],["T_STRING","throwException",127],"(",["T_WHITESPACE","\n                        ",127],["T_STRING","Mage",128],["T_DOUBLE_COLON","::",128],["T_STRING","helper",128],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",128],")",["T_OBJECT_OPERATOR","->",128],["T_STRING","__",128],"(",["T_CONSTANT_ENCAPSED_STRING","'Adapter object must be an instance of %s'",128],",",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'Mage_ImportExport_Model_Export_Adapter_Abstract'",128],")",["T_WHITESPACE","\n                    ",128],")",";",["T_WHITESPACE","\n                ",129],"}",["T_WHITESPACE","\n            ",130],"}",["T_WHITESPACE"," ",131],["T_ELSE","else",131],["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n                ",131],["T_STRING","Mage",132],["T_DOUBLE_COLON","::",132],["T_STRING","throwException",132],"(",["T_STRING","Mage",132],["T_DOUBLE_COLON","::",132],["T_STRING","helper",132],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",132],")",["T_OBJECT_OPERATOR","->",132],["T_STRING","__",132],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid file format'",132],")",")",";",["T_WHITESPACE","\n            ",132],"}",["T_WHITESPACE","\n        ",133],"}",["T_WHITESPACE","\n        ",134],["T_RETURN","return",135],["T_WHITESPACE"," ",135],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","_writer",135],";",["T_WHITESPACE","\n    ",135],"}",["T_WHITESPACE","\n\n    ",136],["T_DOC_COMMENT","\/**\n     * Export data and return contents of temporary file.\n     *\n     * @deprecated after ver 1.9.2.4 use $this->exportFile() instead\n     *\n     * @throws Mage_Core_Exception\n     * @return string\n     *\/",138],["T_WHITESPACE","\n    ",145],["T_PUBLIC","public",146],["T_WHITESPACE"," ",146],["T_FUNCTION","function",146],["T_WHITESPACE"," ",146],["T_STRING","export",146],"(",")",["T_WHITESPACE","\n    ",146],"{",["T_WHITESPACE","\n        ",147],["T_IF","if",148],["T_WHITESPACE"," ",148],"(",["T_ISSET","isset",148],"(",["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","_data",148],"[",["T_STRING","self",148],["T_DOUBLE_COLON","::",148],["T_STRING","FILTER_ELEMENT_GROUP",148],"]",")",")",["T_WHITESPACE"," ",148],"{",["T_WHITESPACE","\n            ",148],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","addLogComment",149],"(",["T_STRING","Mage",149],["T_DOUBLE_COLON","::",149],["T_STRING","helper",149],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",149],")",["T_OBJECT_OPERATOR","->",149],["T_STRING","__",149],"(",["T_CONSTANT_ENCAPSED_STRING","'Begin export of %s'",149],",",["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","getEntity",149],"(",")",")",")",";",["T_WHITESPACE","\n            ",149],["T_VARIABLE","$result",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","_getEntityAdapter",150],"(",")",["T_WHITESPACE","\n                ",150],["T_OBJECT_OPERATOR","->",151],["T_STRING","setWriter",151],"(",["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","_getWriter",151],"(",")",")",["T_WHITESPACE","\n                ",151],["T_OBJECT_OPERATOR","->",152],["T_STRING","export",152],"(",")",";",["T_WHITESPACE","\n            ",152],["T_VARIABLE","$countRows",153],["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_STRING","substr_count",153],"(",["T_STRING","trim",153],"(",["T_VARIABLE","$result",153],")",",",["T_WHITESPACE"," ",153],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",153],")",";",["T_WHITESPACE","\n            ",153],["T_IF","if",154],["T_WHITESPACE"," ",154],"(","!",["T_VARIABLE","$countRows",154],")",["T_WHITESPACE"," ",154],"{",["T_WHITESPACE","\n                ",154],["T_STRING","Mage",155],["T_DOUBLE_COLON","::",155],["T_STRING","throwException",155],"(",["T_WHITESPACE","\n                    ",155],["T_STRING","Mage",156],["T_DOUBLE_COLON","::",156],["T_STRING","helper",156],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",156],")",["T_OBJECT_OPERATOR","->",156],["T_STRING","__",156],"(",["T_CONSTANT_ENCAPSED_STRING","'There is no data for export'",156],")",["T_WHITESPACE","\n                ",156],")",";",["T_WHITESPACE","\n            ",157],"}",["T_WHITESPACE","\n            ",158],["T_IF","if",159],["T_WHITESPACE"," ",159],"(",["T_VARIABLE","$result",159],")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n                ",159],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","addLogComment",160],"(",["T_ARRAY","array",160],"(",["T_WHITESPACE","\n                    ",160],["T_STRING","Mage",161],["T_DOUBLE_COLON","::",161],["T_STRING","helper",161],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",161],")",["T_OBJECT_OPERATOR","->",161],["T_STRING","__",161],"(",["T_CONSTANT_ENCAPSED_STRING","'Exported %s rows.'",161],",",["T_WHITESPACE"," ",161],["T_VARIABLE","$countRows",161],")",",",["T_WHITESPACE","\n                    ",161],["T_STRING","Mage",162],["T_DOUBLE_COLON","::",162],["T_STRING","helper",162],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",162],")",["T_OBJECT_OPERATOR","->",162],["T_STRING","__",162],"(",["T_CONSTANT_ENCAPSED_STRING","'Export has been done.'",162],")",["T_WHITESPACE","\n                ",162],")",")",";",["T_WHITESPACE","\n            ",163],"}",["T_WHITESPACE","\n            ",164],["T_RETURN","return",165],["T_WHITESPACE"," ",165],["T_VARIABLE","$result",165],";",["T_WHITESPACE","\n        ",165],"}",["T_WHITESPACE"," ",166],["T_ELSE","else",166],["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n            ",166],["T_STRING","Mage",167],["T_DOUBLE_COLON","::",167],["T_STRING","throwException",167],"(",["T_WHITESPACE","\n                ",167],["T_STRING","Mage",168],["T_DOUBLE_COLON","::",168],["T_STRING","helper",168],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",168],")",["T_OBJECT_OPERATOR","->",168],["T_STRING","__",168],"(",["T_CONSTANT_ENCAPSED_STRING","'No filter data provided'",168],")",["T_WHITESPACE","\n            ",168],")",";",["T_WHITESPACE","\n        ",169],"}",["T_WHITESPACE","\n    ",170],"}",["T_WHITESPACE","\n\n    ",171],["T_DOC_COMMENT","\/**\n     * Export data and return temporary file through array.\n     *\n     * This method will return following array:\n     *\n     * array(\n     *     'rows'  => count of written rows,\n     *     'value' => path to created file,\n     *     'type'  => 'file'\n     * )\n     *\n     * @throws Mage_Core_Exception\n     * @return array\n     *\/",173],["T_WHITESPACE","\n    ",186],["T_PUBLIC","public",187],["T_WHITESPACE"," ",187],["T_FUNCTION","function",187],["T_WHITESPACE"," ",187],["T_STRING","exportFile",187],"(",")",["T_WHITESPACE","\n    ",187],"{",["T_WHITESPACE","\n        ",188],["T_IF","if",189],["T_WHITESPACE"," ",189],"(",["T_ISSET","isset",189],"(",["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","_data",189],"[",["T_STRING","self",189],["T_DOUBLE_COLON","::",189],["T_STRING","FILTER_ELEMENT_GROUP",189],"]",")",")",["T_WHITESPACE"," ",189],"{",["T_WHITESPACE","\n            ",189],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","addLogComment",190],"(",["T_STRING","Mage",190],["T_DOUBLE_COLON","::",190],["T_STRING","helper",190],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",190],")",["T_OBJECT_OPERATOR","->",190],["T_STRING","__",190],"(",["T_CONSTANT_ENCAPSED_STRING","'Begin export of %s'",190],",",["T_WHITESPACE"," ",190],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","getEntity",190],"(",")",")",")",";",["T_WHITESPACE","\n            ",190],["T_VARIABLE","$result",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","_getEntityAdapter",191],"(",")",["T_WHITESPACE","\n                ",191],["T_OBJECT_OPERATOR","->",192],["T_STRING","setWriter",192],"(",["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","_getWriter",192],"(",")",")",["T_WHITESPACE","\n                ",192],["T_OBJECT_OPERATOR","->",193],["T_STRING","exportFile",193],"(",")",";",["T_WHITESPACE","\n\n            ",193],["T_IF","if",195],["T_WHITESPACE"," ",195],"(",["T_ISSET","isset",195],"(",["T_VARIABLE","$result",195],"[",["T_CONSTANT_ENCAPSED_STRING","'rows'",195],"]",")",")",["T_WHITESPACE"," ",195],"{",["T_WHITESPACE","\n                ",195],["T_IF","if",196],["T_WHITESPACE"," ",196],"(","!",["T_VARIABLE","$result",196],"[",["T_CONSTANT_ENCAPSED_STRING","'rows'",196],"]",")",["T_WHITESPACE"," ",196],"{",["T_WHITESPACE","\n                    ",196],["T_STRING","Mage",197],["T_DOUBLE_COLON","::",197],["T_STRING","throwException",197],"(",["T_WHITESPACE","\n                        ",197],["T_STRING","Mage",198],["T_DOUBLE_COLON","::",198],["T_STRING","helper",198],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",198],")",["T_OBJECT_OPERATOR","->",198],["T_STRING","__",198],"(",["T_CONSTANT_ENCAPSED_STRING","'There is no data for export'",198],")",["T_WHITESPACE","\n                    ",198],")",";",["T_WHITESPACE","\n                ",199],"}",["T_WHITESPACE","\n                ",200],["T_IF","if",201],["T_WHITESPACE"," ",201],"(",["T_VARIABLE","$result",201],"[",["T_CONSTANT_ENCAPSED_STRING","'rows'",201],"]",")",["T_WHITESPACE"," ",201],"{",["T_WHITESPACE","\n                    ",201],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","addLogComment",202],"(",["T_ARRAY","array",202],"(",["T_WHITESPACE","\n                        ",202],["T_STRING","Mage",203],["T_DOUBLE_COLON","::",203],["T_STRING","helper",203],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",203],")",["T_OBJECT_OPERATOR","->",203],["T_STRING","__",203],"(",["T_CONSTANT_ENCAPSED_STRING","'Exported %s rows.'",203],",",["T_WHITESPACE"," ",203],["T_VARIABLE","$result",203],"[",["T_CONSTANT_ENCAPSED_STRING","'rows'",203],"]",")",",",["T_WHITESPACE","\n                        ",203],["T_STRING","Mage",204],["T_DOUBLE_COLON","::",204],["T_STRING","helper",204],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",204],")",["T_OBJECT_OPERATOR","->",204],["T_STRING","__",204],"(",["T_CONSTANT_ENCAPSED_STRING","'Export has been done.'",204],")",["T_WHITESPACE","\n                    ",204],")",")",";",["T_WHITESPACE","\n                ",205],"}",["T_WHITESPACE","\n            ",206],"}",["T_WHITESPACE","\n\n            ",207],["T_RETURN","return",209],["T_WHITESPACE"," ",209],["T_VARIABLE","$result",209],";",["T_WHITESPACE","\n        ",209],"}",["T_WHITESPACE"," ",210],["T_ELSE","else",210],["T_WHITESPACE"," ",210],"{",["T_WHITESPACE","\n            ",210],["T_STRING","Mage",211],["T_DOUBLE_COLON","::",211],["T_STRING","throwException",211],"(",["T_WHITESPACE","\n                ",211],["T_STRING","Mage",212],["T_DOUBLE_COLON","::",212],["T_STRING","helper",212],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",212],")",["T_OBJECT_OPERATOR","->",212],["T_STRING","__",212],"(",["T_CONSTANT_ENCAPSED_STRING","'No filter data provided'",212],")",["T_WHITESPACE","\n            ",212],")",";",["T_WHITESPACE","\n        ",213],"}",["T_WHITESPACE","\n    ",214],"}",["T_WHITESPACE","\n\n    ",215],["T_DOC_COMMENT","\/**\n     * Clean up already loaded attribute collection.\n     *\n     * @param Mage_Eav_Model_Resource_Entity_Attribute_Collection $collection\n     * @return Mage_Eav_Model_Resource_Entity_Attribute_Collection\n     *\/",217],["T_WHITESPACE","\n    ",222],["T_PUBLIC","public",223],["T_WHITESPACE"," ",223],["T_FUNCTION","function",223],["T_WHITESPACE"," ",223],["T_STRING","filterAttributeCollection",223],"(",["T_STRING","Mage_Eav_Model_Resource_Entity_Attribute_Collection",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$collection",223],")",["T_WHITESPACE","\n    ",223],"{",["T_WHITESPACE","\n        ",224],["T_RETURN","return",225],["T_WHITESPACE"," ",225],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","_getEntityAdapter",225],"(",")",["T_OBJECT_OPERATOR","->",225],["T_STRING","filterAttributeCollection",225],"(",["T_VARIABLE","$collection",225],")",";",["T_WHITESPACE","\n    ",225],"}",["T_WHITESPACE","\n\n    ",226],["T_DOC_COMMENT","\/**\n     * Determine filter type for specified attribute.\n     *\n     * @static\n     * @param Mage_Eav_Model_Entity_Attribute $attribute\n     * @throws Exception\n     * @return string\n     *\/",228],["T_WHITESPACE","\n    ",235],["T_PUBLIC","public",236],["T_WHITESPACE"," ",236],["T_STATIC","static",236],["T_WHITESPACE"," ",236],["T_FUNCTION","function",236],["T_WHITESPACE"," ",236],["T_STRING","getAttributeFilterType",236],"(",["T_STRING","Mage_Eav_Model_Entity_Attribute",236],["T_WHITESPACE"," ",236],["T_VARIABLE","$attribute",236],")",["T_WHITESPACE","\n    ",236],"{",["T_WHITESPACE","\n        ",237],["T_IF","if",238],["T_WHITESPACE"," ",238],"(",["T_VARIABLE","$attribute",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","usesSource",238],"(",")",["T_WHITESPACE"," ",238],["T_BOOLEAN_OR","||",238],["T_WHITESPACE"," ",238],["T_VARIABLE","$attribute",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","getFilterOptions",238],"(",")",")",["T_WHITESPACE"," ",238],"{",["T_WHITESPACE","\n            ",238],["T_RETURN","return",239],["T_WHITESPACE"," ",239],["T_STRING","self",239],["T_DOUBLE_COLON","::",239],["T_STRING","FILTER_TYPE_SELECT",239],";",["T_WHITESPACE","\n        ",239],"}",["T_WHITESPACE"," ",240],["T_ELSEIF","elseif",240],["T_WHITESPACE"," ",240],"(",["T_CONSTANT_ENCAPSED_STRING","'datetime'",240],["T_WHITESPACE"," ",240],["T_IS_EQUAL","==",240],["T_WHITESPACE"," ",240],["T_VARIABLE","$attribute",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","getBackendType",240],"(",")",")",["T_WHITESPACE"," ",240],"{",["T_WHITESPACE","\n            ",240],["T_RETURN","return",241],["T_WHITESPACE"," ",241],["T_STRING","self",241],["T_DOUBLE_COLON","::",241],["T_STRING","FILTER_TYPE_DATE",241],";",["T_WHITESPACE","\n        ",241],"}",["T_WHITESPACE"," ",242],["T_ELSEIF","elseif",242],["T_WHITESPACE"," ",242],"(",["T_CONSTANT_ENCAPSED_STRING","'decimal'",242],["T_WHITESPACE"," ",242],["T_IS_EQUAL","==",242],["T_WHITESPACE"," ",242],["T_VARIABLE","$attribute",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","getBackendType",242],"(",")",["T_WHITESPACE"," ",242],["T_BOOLEAN_OR","||",242],["T_WHITESPACE"," ",242],["T_CONSTANT_ENCAPSED_STRING","'int'",242],["T_WHITESPACE"," ",242],["T_IS_EQUAL","==",242],["T_WHITESPACE"," ",242],["T_VARIABLE","$attribute",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","getBackendType",242],"(",")",")",["T_WHITESPACE"," ",242],"{",["T_WHITESPACE","\n            ",242],["T_RETURN","return",243],["T_WHITESPACE"," ",243],["T_STRING","self",243],["T_DOUBLE_COLON","::",243],["T_STRING","FILTER_TYPE_NUMBER",243],";",["T_WHITESPACE","\n        ",243],"}",["T_WHITESPACE"," ",244],["T_ELSEIF","elseif",244],["T_WHITESPACE"," ",244],"(",["T_VARIABLE","$attribute",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","isStatic",244],"(",")",["T_WHITESPACE","\n                  ",244],["T_BOOLEAN_OR","||",245],["T_WHITESPACE"," ",245],["T_CONSTANT_ENCAPSED_STRING","'varchar'",245],["T_WHITESPACE"," ",245],["T_IS_EQUAL","==",245],["T_WHITESPACE"," ",245],["T_VARIABLE","$attribute",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","getBackendType",245],"(",")",["T_WHITESPACE","\n                  ",245],["T_BOOLEAN_OR","||",246],["T_WHITESPACE"," ",246],["T_CONSTANT_ENCAPSED_STRING","'text'",246],["T_WHITESPACE"," ",246],["T_IS_EQUAL","==",246],["T_WHITESPACE"," ",246],["T_VARIABLE","$attribute",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","getBackendType",246],"(",")",["T_WHITESPACE","\n        ",246],")",["T_WHITESPACE"," ",247],"{",["T_WHITESPACE","\n            ",247],["T_RETURN","return",248],["T_WHITESPACE"," ",248],["T_STRING","self",248],["T_DOUBLE_COLON","::",248],["T_STRING","FILTER_TYPE_INPUT",248],";",["T_WHITESPACE","\n        ",248],"}",["T_WHITESPACE"," ",249],["T_ELSE","else",249],["T_WHITESPACE"," ",249],"{",["T_WHITESPACE","\n            ",249],["T_STRING","Mage",250],["T_DOUBLE_COLON","::",250],["T_STRING","throwException",250],"(",["T_WHITESPACE","\n                ",250],["T_STRING","Mage",251],["T_DOUBLE_COLON","::",251],["T_STRING","helper",251],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",251],")",["T_OBJECT_OPERATOR","->",251],["T_STRING","__",251],"(",["T_CONSTANT_ENCAPSED_STRING","'Can not determine attribute filter type'",251],")",["T_WHITESPACE","\n            ",251],")",";",["T_WHITESPACE","\n        ",252],"}",["T_WHITESPACE","\n    ",253],"}",["T_WHITESPACE","\n\n    ",254],["T_DOC_COMMENT","\/**\n     * MIME-type for 'Content-Type' header.\n     *\n     * @return string\n     *\/",256],["T_WHITESPACE","\n    ",260],["T_PUBLIC","public",261],["T_WHITESPACE"," ",261],["T_FUNCTION","function",261],["T_WHITESPACE"," ",261],["T_STRING","getContentType",261],"(",")",["T_WHITESPACE","\n    ",261],"{",["T_WHITESPACE","\n        ",262],["T_RETURN","return",263],["T_WHITESPACE"," ",263],["T_VARIABLE","$this",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","_getWriter",263],"(",")",["T_OBJECT_OPERATOR","->",263],["T_STRING","getContentType",263],"(",")",";",["T_WHITESPACE","\n    ",263],"}",["T_WHITESPACE","\n\n    ",264],["T_DOC_COMMENT","\/**\n     * Override standard entity getter.\n     *\n     * @throw Exception\n     * @return string\n     *\/",266],["T_WHITESPACE","\n    ",271],["T_PUBLIC","public",272],["T_WHITESPACE"," ",272],["T_FUNCTION","function",272],["T_WHITESPACE"," ",272],["T_STRING","getEntity",272],"(",")",["T_WHITESPACE","\n    ",272],"{",["T_WHITESPACE","\n        ",273],["T_IF","if",274],["T_WHITESPACE"," ",274],"(",["T_EMPTY","empty",274],"(",["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","_data",274],"[",["T_CONSTANT_ENCAPSED_STRING","'entity'",274],"]",")",")",["T_WHITESPACE"," ",274],"{",["T_WHITESPACE","\n            ",274],["T_STRING","Mage",275],["T_DOUBLE_COLON","::",275],["T_STRING","throwException",275],"(",["T_STRING","Mage",275],["T_DOUBLE_COLON","::",275],["T_STRING","helper",275],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",275],")",["T_OBJECT_OPERATOR","->",275],["T_STRING","__",275],"(",["T_CONSTANT_ENCAPSED_STRING","'Entity is unknown'",275],")",")",";",["T_WHITESPACE","\n        ",275],"}",["T_WHITESPACE","\n        ",276],["T_RETURN","return",277],["T_WHITESPACE"," ",277],["T_VARIABLE","$this",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","_data",277],"[",["T_CONSTANT_ENCAPSED_STRING","'entity'",277],"]",";",["T_WHITESPACE","\n    ",277],"}",["T_WHITESPACE","\n\n    ",278],["T_DOC_COMMENT","\/**\n     * Entity attributes collection getter.\n     *\n     * @return Mage_Eav_Model_Resource_Entity_Attribute_Collection\n     *\/",280],["T_WHITESPACE","\n    ",284],["T_PUBLIC","public",285],["T_WHITESPACE"," ",285],["T_FUNCTION","function",285],["T_WHITESPACE"," ",285],["T_STRING","getEntityAttributeCollection",285],"(",")",["T_WHITESPACE","\n    ",285],"{",["T_WHITESPACE","\n        ",286],["T_RETURN","return",287],["T_WHITESPACE"," ",287],["T_VARIABLE","$this",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","_getEntityAdapter",287],"(",")",["T_OBJECT_OPERATOR","->",287],["T_STRING","getAttributeCollection",287],"(",")",";",["T_WHITESPACE","\n    ",287],"}",["T_WHITESPACE","\n\n    ",288],["T_DOC_COMMENT","\/**\n     * Override standard entity getter.\n     *\n     * @throw Exception\n     * @return string\n     *\/",290],["T_WHITESPACE","\n    ",295],["T_PUBLIC","public",296],["T_WHITESPACE"," ",296],["T_FUNCTION","function",296],["T_WHITESPACE"," ",296],["T_STRING","getFileFormat",296],"(",")",["T_WHITESPACE","\n    ",296],"{",["T_WHITESPACE","\n        ",297],["T_IF","if",298],["T_WHITESPACE"," ",298],"(",["T_EMPTY","empty",298],"(",["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","_data",298],"[",["T_CONSTANT_ENCAPSED_STRING","'file_format'",298],"]",")",")",["T_WHITESPACE"," ",298],"{",["T_WHITESPACE","\n            ",298],["T_STRING","Mage",299],["T_DOUBLE_COLON","::",299],["T_STRING","throwException",299],"(",["T_STRING","Mage",299],["T_DOUBLE_COLON","::",299],["T_STRING","helper",299],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",299],")",["T_OBJECT_OPERATOR","->",299],["T_STRING","__",299],"(",["T_CONSTANT_ENCAPSED_STRING","'File format is unknown'",299],")",")",";",["T_WHITESPACE","\n        ",299],"}",["T_WHITESPACE","\n        ",300],["T_RETURN","return",301],["T_WHITESPACE"," ",301],["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","_data",301],"[",["T_CONSTANT_ENCAPSED_STRING","'file_format'",301],"]",";",["T_WHITESPACE","\n    ",301],"}",["T_WHITESPACE","\n\n    ",302],["T_DOC_COMMENT","\/**\n     * Return file name for downloading.\n     *\n     * @return string\n     *\/",304],["T_WHITESPACE","\n    ",308],["T_PUBLIC","public",309],["T_WHITESPACE"," ",309],["T_FUNCTION","function",309],["T_WHITESPACE"," ",309],["T_STRING","getFileName",309],"(",")",["T_WHITESPACE","\n    ",309],"{",["T_WHITESPACE","\n        ",310],["T_RETURN","return",311],["T_WHITESPACE"," ",311],["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","getEntity",311],"(",")",["T_WHITESPACE"," ",311],".",["T_WHITESPACE"," ",311],["T_CONSTANT_ENCAPSED_STRING","'_'",311],["T_WHITESPACE"," ",311],".",["T_WHITESPACE"," ",311],["T_STRING","date",311],"(",["T_CONSTANT_ENCAPSED_STRING","'Ymd_His'",311],")",["T_WHITESPACE"," ",311],".",["T_WHITESPACE","  ",311],["T_CONSTANT_ENCAPSED_STRING","'.'",311],["T_WHITESPACE"," ",311],".",["T_WHITESPACE"," ",311],["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","_getWriter",311],"(",")",["T_OBJECT_OPERATOR","->",311],["T_STRING","getFileExtension",311],"(",")",";",["T_WHITESPACE","\n    ",311],"}",["T_WHITESPACE","\n",312],"}",["T_WHITESPACE","\n",313]]