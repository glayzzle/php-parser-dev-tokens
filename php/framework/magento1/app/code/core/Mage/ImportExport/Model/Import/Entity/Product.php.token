[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_ImportExport\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Import entity product model\n *\n * @category    Mage\n * @package     Mage_ImportExport\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_ImportExport_Model_Import_Entity_Product",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_ImportExport_Model_Import_Entity_Abstract",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Configuration key for product type\n     *\/",36],["T_WHITESPACE","\n    ",38],["T_CONST","const",39],["T_WHITESPACE"," ",39],["T_STRING","CONFIG_KEY_PRODUCT_TYPES",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'global\/importexport\/import_product_types'",39],";",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * Size of bunch - part of products to save in one step.\n     *\/",41],["T_WHITESPACE","\n    ",43],["T_CONST","const",44],["T_WHITESPACE"," ",44],["T_STRING","BUNCH_SIZE",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_LNUMBER","20",44],";",["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * Value that means all entities (e.g. websites, groups etc.)\n     *\/",46],["T_WHITESPACE","\n    ",48],["T_CONST","const",49],["T_WHITESPACE"," ",49],["T_STRING","VALUE_ALL",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'all'",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Default Scope\n     *\/",51],["T_WHITESPACE","\n    ",53],["T_CONST","const",54],["T_WHITESPACE"," ",54],["T_STRING","SCOPE_DEFAULT",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_LNUMBER","1",54],";",["T_WHITESPACE","\n\n    ",54],["T_DOC_COMMENT","\/**\n     * Website Scope\n     *\/",56],["T_WHITESPACE","\n    ",58],["T_CONST","const",59],["T_WHITESPACE"," ",59],["T_STRING","SCOPE_WEBSITE",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_LNUMBER","2",59],";",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * Store Scope\n     *\/",61],["T_WHITESPACE","\n    ",63],["T_CONST","const",64],["T_WHITESPACE"," ",64],["T_STRING","SCOPE_STORE",64],["T_WHITESPACE","   ",64],"=",["T_WHITESPACE"," ",64],["T_LNUMBER","0",64],";",["T_WHITESPACE","\n\n    ",64],["T_DOC_COMMENT","\/**\n     * Null Scope\n     *\/",66],["T_WHITESPACE","\n    ",68],["T_CONST","const",69],["T_WHITESPACE"," ",69],["T_STRING","SCOPE_NULL",69],["T_WHITESPACE","    ",69],"=",["T_WHITESPACE"," ",69],"-",["T_LNUMBER","1",69],";",["T_WHITESPACE","\n    ",69],["T_COMMENT","\/**#@-*\/",70],["T_WHITESPACE","\n\n    ",70],["T_COMMENT","\/**#@+\n     * Permanent column names.\n     *\n     * Names that begins with underscore is not an attribute. This name convention is for\n     * to avoid interference with same attribute name.\n     *\/",72],["T_WHITESPACE","\n    ",77],["T_CONST","const",78],["T_WHITESPACE"," ",78],["T_STRING","COL_STORE",78],["T_WHITESPACE","    ",78],"=",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'_store'",78],";",["T_WHITESPACE","\n\n    ",78],["T_DOC_COMMENT","\/**\n     * Col Attr Set\n     *\/",80],["T_WHITESPACE","\n    ",82],["T_CONST","const",83],["T_WHITESPACE"," ",83],["T_STRING","COL_ATTR_SET",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'_attribute_set'",83],";",["T_WHITESPACE","\n\n    ",83],["T_DOC_COMMENT","\/**\n     * Col Type\n     *\/",85],["T_WHITESPACE","\n    ",87],["T_CONST","const",88],["T_WHITESPACE"," ",88],["T_STRING","COL_TYPE",88],["T_WHITESPACE","     ",88],"=",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'_type'",88],";",["T_WHITESPACE","\n\n    ",88],["T_DOC_COMMENT","\/**\n     * Col Category\n     *\/",90],["T_WHITESPACE","\n    ",92],["T_CONST","const",93],["T_WHITESPACE"," ",93],["T_STRING","COL_CATEGORY",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","'_category'",93],";",["T_WHITESPACE","\n\n    ",93],["T_DOC_COMMENT","\/**\n     * Col Root Category\n     *\/",95],["T_WHITESPACE","\n    ",97],["T_CONST","const",98],["T_WHITESPACE"," ",98],["T_STRING","COL_ROOT_CATEGORY",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'_root_category'",98],";",["T_WHITESPACE","\n\n    ",98],["T_DOC_COMMENT","\/**\n     * Col Sku\n     *\/",100],["T_WHITESPACE","\n    ",102],["T_CONST","const",103],["T_WHITESPACE"," ",103],["T_STRING","COL_SKU",103],["T_WHITESPACE","      ",103],"=",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'sku'",103],";",["T_WHITESPACE","\n    ",103],["T_COMMENT","\/**#@-*\/",104],["T_WHITESPACE","\n\n    ",104],["T_COMMENT","\/**#@+\n     * Error codes.\n     *\/",106],["T_WHITESPACE","\n    ",108],["T_CONST","const",109],["T_WHITESPACE"," ",109],["T_STRING","ERROR_INVALID_SCOPE",109],["T_WHITESPACE","                ",109],"=",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'invalidScope'",109],";",["T_WHITESPACE","\n\n    ",109],["T_DOC_COMMENT","\/**\n     * Error - invalid website\n     *\/",111],["T_WHITESPACE","\n    ",113],["T_CONST","const",114],["T_WHITESPACE"," ",114],["T_STRING","ERROR_INVALID_WEBSITE",114],["T_WHITESPACE","              ",114],"=",["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","'invalidWebsite'",114],";",["T_WHITESPACE","\n\n    ",114],["T_DOC_COMMENT","\/**\n     * Error - invalid store\n     *\/",116],["T_WHITESPACE","\n    ",118],["T_CONST","const",119],["T_WHITESPACE"," ",119],["T_STRING","ERROR_INVALID_STORE",119],["T_WHITESPACE","                ",119],"=",["T_WHITESPACE"," ",119],["T_CONSTANT_ENCAPSED_STRING","'invalidStore'",119],";",["T_WHITESPACE","\n\n    ",119],["T_DOC_COMMENT","\/**\n     * Error - invalid attr set\n     *\/",121],["T_WHITESPACE","\n    ",123],["T_CONST","const",124],["T_WHITESPACE"," ",124],["T_STRING","ERROR_INVALID_ATTR_SET",124],["T_WHITESPACE","             ",124],"=",["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","'invalidAttrSet'",124],";",["T_WHITESPACE","\n\n    ",124],["T_DOC_COMMENT","\/**\n     * Error - invalid type\n     *\/",126],["T_WHITESPACE","\n    ",128],["T_CONST","const",129],["T_WHITESPACE"," ",129],["T_STRING","ERROR_INVALID_TYPE",129],["T_WHITESPACE","                 ",129],"=",["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","'invalidType'",129],";",["T_WHITESPACE","\n\n    ",129],["T_DOC_COMMENT","\/**\n     * Error - invalid category\n     *\/",131],["T_WHITESPACE","\n    ",133],["T_CONST","const",134],["T_WHITESPACE"," ",134],["T_STRING","ERROR_INVALID_CATEGORY",134],["T_WHITESPACE","             ",134],"=",["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","'invalidCategory'",134],";",["T_WHITESPACE","\n\n    ",134],["T_DOC_COMMENT","\/**\n     * Error - value is required\n     *\/",136],["T_WHITESPACE","\n    ",138],["T_CONST","const",139],["T_WHITESPACE"," ",139],["T_STRING","ERROR_VALUE_IS_REQUIRED",139],["T_WHITESPACE","            ",139],"=",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'isRequired'",139],";",["T_WHITESPACE","\n\n    ",139],["T_DOC_COMMENT","\/**\n     * Error - type changed\n     *\/",141],["T_WHITESPACE","\n    ",143],["T_CONST","const",144],["T_WHITESPACE"," ",144],["T_STRING","ERROR_TYPE_CHANGED",144],["T_WHITESPACE","                 ",144],"=",["T_WHITESPACE"," ",144],["T_CONSTANT_ENCAPSED_STRING","'typeChanged'",144],";",["T_WHITESPACE","\n\n    ",144],["T_DOC_COMMENT","\/**\n     * Error - sku is empty\n     *\/",146],["T_WHITESPACE","\n    ",148],["T_CONST","const",149],["T_WHITESPACE"," ",149],["T_STRING","ERROR_SKU_IS_EMPTY",149],["T_WHITESPACE","                 ",149],"=",["T_WHITESPACE"," ",149],["T_CONSTANT_ENCAPSED_STRING","'skuEmpty'",149],";",["T_WHITESPACE","\n\n    ",149],["T_DOC_COMMENT","\/**\n     * Error - no default row\n     *\/",151],["T_WHITESPACE","\n    ",153],["T_CONST","const",154],["T_WHITESPACE"," ",154],["T_STRING","ERROR_NO_DEFAULT_ROW",154],["T_WHITESPACE","               ",154],"=",["T_WHITESPACE"," ",154],["T_CONSTANT_ENCAPSED_STRING","'noDefaultRow'",154],";",["T_WHITESPACE","\n\n    ",154],["T_DOC_COMMENT","\/**\n     * Error - change type\n     *\/",156],["T_WHITESPACE","\n    ",158],["T_CONST","const",159],["T_WHITESPACE"," ",159],["T_STRING","ERROR_CHANGE_TYPE",159],["T_WHITESPACE","                  ",159],"=",["T_WHITESPACE"," ",159],["T_CONSTANT_ENCAPSED_STRING","'changeProductType'",159],";",["T_WHITESPACE","\n\n    ",159],["T_DOC_COMMENT","\/**\n     * Error - duplicate scope\n     *\/",161],["T_WHITESPACE","\n    ",163],["T_CONST","const",164],["T_WHITESPACE"," ",164],["T_STRING","ERROR_DUPLICATE_SCOPE",164],["T_WHITESPACE","              ",164],"=",["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","'duplicateScope'",164],";",["T_WHITESPACE","\n\n    ",164],["T_DOC_COMMENT","\/**\n     * Error - duplicate sku\n     *\/",166],["T_WHITESPACE","\n    ",168],["T_CONST","const",169],["T_WHITESPACE"," ",169],["T_STRING","ERROR_DUPLICATE_SKU",169],["T_WHITESPACE","                ",169],"=",["T_WHITESPACE"," ",169],["T_CONSTANT_ENCAPSED_STRING","'duplicateSKU'",169],";",["T_WHITESPACE","\n\n    ",169],["T_DOC_COMMENT","\/**\n     * Error - change attr set\n     *\/",171],["T_WHITESPACE","\n    ",173],["T_CONST","const",174],["T_WHITESPACE"," ",174],["T_STRING","ERROR_CHANGE_ATTR_SET",174],["T_WHITESPACE","              ",174],"=",["T_WHITESPACE"," ",174],["T_CONSTANT_ENCAPSED_STRING","'changeAttrSet'",174],";",["T_WHITESPACE","\n\n    ",174],["T_DOC_COMMENT","\/**\n     * Error - type unsupported\n     *\/",176],["T_WHITESPACE","\n    ",178],["T_CONST","const",179],["T_WHITESPACE"," ",179],["T_STRING","ERROR_TYPE_UNSUPPORTED",179],["T_WHITESPACE","             ",179],"=",["T_WHITESPACE"," ",179],["T_CONSTANT_ENCAPSED_STRING","'productTypeUnsupported'",179],";",["T_WHITESPACE","\n\n    ",179],["T_DOC_COMMENT","\/**\n     * Error - row is orphan\n     *\/",181],["T_WHITESPACE","\n    ",183],["T_CONST","const",184],["T_WHITESPACE"," ",184],["T_STRING","ERROR_ROW_IS_ORPHAN",184],["T_WHITESPACE","                ",184],"=",["T_WHITESPACE"," ",184],["T_CONSTANT_ENCAPSED_STRING","'rowIsOrphan'",184],";",["T_WHITESPACE","\n\n    ",184],["T_DOC_COMMENT","\/**\n     * Error - invalid tier price qty\n     *\/",186],["T_WHITESPACE","\n    ",188],["T_CONST","const",189],["T_WHITESPACE"," ",189],["T_STRING","ERROR_INVALID_TIER_PRICE_QTY",189],["T_WHITESPACE","       ",189],"=",["T_WHITESPACE"," ",189],["T_CONSTANT_ENCAPSED_STRING","'invalidTierPriceOrQty'",189],";",["T_WHITESPACE","\n\n    ",189],["T_DOC_COMMENT","\/**\n     * Error - invalid tier price site\n     *\/",191],["T_WHITESPACE","\n    ",193],["T_CONST","const",194],["T_WHITESPACE"," ",194],["T_STRING","ERROR_INVALID_TIER_PRICE_SITE",194],["T_WHITESPACE","      ",194],"=",["T_WHITESPACE"," ",194],["T_CONSTANT_ENCAPSED_STRING","'tierPriceWebsiteInvalid'",194],";",["T_WHITESPACE","\n\n    ",194],["T_DOC_COMMENT","\/**\n     * Error - invalid tier price group\n     *\/",196],["T_WHITESPACE","\n    ",198],["T_CONST","const",199],["T_WHITESPACE"," ",199],["T_STRING","ERROR_INVALID_TIER_PRICE_GROUP",199],["T_WHITESPACE","     ",199],"=",["T_WHITESPACE"," ",199],["T_CONSTANT_ENCAPSED_STRING","'tierPriceGroupInvalid'",199],";",["T_WHITESPACE","\n\n    ",199],["T_DOC_COMMENT","\/**\n     * Error - tier data incomplete\n     *\/",201],["T_WHITESPACE","\n    ",203],["T_CONST","const",204],["T_WHITESPACE"," ",204],["T_STRING","ERROR_TIER_DATA_INCOMPLETE",204],["T_WHITESPACE","         ",204],"=",["T_WHITESPACE"," ",204],["T_CONSTANT_ENCAPSED_STRING","'tierPriceDataIsIncomplete'",204],";",["T_WHITESPACE","\n\n    ",204],["T_DOC_COMMENT","\/**\n     * Error - invalid group price site\n     *\/",206],["T_WHITESPACE","\n    ",208],["T_CONST","const",209],["T_WHITESPACE"," ",209],["T_STRING","ERROR_INVALID_GROUP_PRICE_SITE",209],["T_WHITESPACE","     ",209],"=",["T_WHITESPACE"," ",209],["T_CONSTANT_ENCAPSED_STRING","'groupPriceWebsiteInvalid'",209],";",["T_WHITESPACE","\n\n    ",209],["T_DOC_COMMENT","\/**\n     * Error - invalid group price group\n     *\/",211],["T_WHITESPACE","\n    ",213],["T_CONST","const",214],["T_WHITESPACE"," ",214],["T_STRING","ERROR_INVALID_GROUP_PRICE_GROUP",214],["T_WHITESPACE","    ",214],"=",["T_WHITESPACE"," ",214],["T_CONSTANT_ENCAPSED_STRING","'groupPriceGroupInvalid'",214],";",["T_WHITESPACE","\n\n    ",214],["T_DOC_COMMENT","\/**\n     * Error - group price data incompelte\n     *\/",216],["T_WHITESPACE","\n    ",218],["T_CONST","const",219],["T_WHITESPACE"," ",219],["T_STRING","ERROR_GROUP_PRICE_DATA_INCOMPLETE",219],["T_WHITESPACE","  ",219],"=",["T_WHITESPACE"," ",219],["T_CONSTANT_ENCAPSED_STRING","'groupPriceDataIsIncomplete'",219],";",["T_WHITESPACE","\n\n    ",219],["T_DOC_COMMENT","\/**\n     * Error - sku not found for delete\n     *\/",221],["T_WHITESPACE","\n    ",223],["T_CONST","const",224],["T_WHITESPACE"," ",224],["T_STRING","ERROR_SKU_NOT_FOUND_FOR_DELETE",224],["T_WHITESPACE","     ",224],"=",["T_WHITESPACE"," ",224],["T_CONSTANT_ENCAPSED_STRING","'skuNotFoundToDelete'",224],";",["T_WHITESPACE","\n\n    ",224],["T_DOC_COMMENT","\/**\n     * Error - super products sku not found\n     *\/",226],["T_WHITESPACE","\n    ",228],["T_CONST","const",229],["T_WHITESPACE"," ",229],["T_STRING","ERROR_SUPER_PRODUCTS_SKU_NOT_FOUND",229],["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],["T_CONSTANT_ENCAPSED_STRING","'superProductsSkuNotFound'",229],";",["T_WHITESPACE","\n    ",229],["T_COMMENT","\/**#@-*\/",230],["T_WHITESPACE","\n\n    ",230],["T_DOC_COMMENT","\/**\n     * Pairs of attribute set ID-to-name.\n     *\n     * @var array\n     *\/",232],["T_WHITESPACE","\n    ",236],["T_PROTECTED","protected",237],["T_WHITESPACE"," ",237],["T_VARIABLE","$_attrSetIdToName",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_ARRAY","array",237],"(",")",";",["T_WHITESPACE","\n\n    ",237],["T_DOC_COMMENT","\/**\n     * Pairs of attribute set name-to-ID.\n     *\n     * @var array\n     *\/",239],["T_WHITESPACE","\n    ",243],["T_PROTECTED","protected",244],["T_WHITESPACE"," ",244],["T_VARIABLE","$_attrSetNameToId",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_ARRAY","array",244],"(",")",";",["T_WHITESPACE","\n\n    ",244],["T_DOC_COMMENT","\/**\n     * Categories text-path to ID hash.\n     *\n     * @var array\n     *\/",246],["T_WHITESPACE","\n    ",250],["T_PROTECTED","protected",251],["T_WHITESPACE"," ",251],["T_VARIABLE","$_categories",251],["T_WHITESPACE"," ",251],"=",["T_WHITESPACE"," ",251],["T_ARRAY","array",251],"(",")",";",["T_WHITESPACE","\n\n    ",251],["T_DOC_COMMENT","\/**\n     * Categories text-path to ID hash with roots checking.\n     *\n     * @var array\n     *\/",253],["T_WHITESPACE","\n    ",257],["T_PROTECTED","protected",258],["T_WHITESPACE"," ",258],["T_VARIABLE","$_categoriesWithRoots",258],["T_WHITESPACE"," ",258],"=",["T_WHITESPACE"," ",258],["T_ARRAY","array",258],"(",")",";",["T_WHITESPACE","\n\n    ",258],["T_DOC_COMMENT","\/**\n     * Customer groups ID-to-name.\n     *\n     * @var array\n     *\/",260],["T_WHITESPACE","\n    ",264],["T_PROTECTED","protected",265],["T_WHITESPACE"," ",265],["T_VARIABLE","$_customerGroups",265],["T_WHITESPACE"," ",265],"=",["T_WHITESPACE"," ",265],["T_ARRAY","array",265],"(",")",";",["T_WHITESPACE","\n\n    ",265],["T_DOC_COMMENT","\/**\n     * Attributes with index (not label) value.\n     *\n     * @var array\n     *\/",267],["T_WHITESPACE","\n    ",271],["T_PROTECTED","protected",272],["T_WHITESPACE"," ",272],["T_VARIABLE","$_indexValueAttributes",272],["T_WHITESPACE"," ",272],"=",["T_WHITESPACE"," ",272],["T_ARRAY","array",272],"(",["T_WHITESPACE","\n        ",272],["T_CONSTANT_ENCAPSED_STRING","'status'",273],",",["T_WHITESPACE","\n        ",273],["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",274],",",["T_WHITESPACE","\n        ",274],["T_CONSTANT_ENCAPSED_STRING","'visibility'",275],",",["T_WHITESPACE","\n        ",275],["T_CONSTANT_ENCAPSED_STRING","'gift_message_available'",276],",",["T_WHITESPACE","\n        ",276],["T_CONSTANT_ENCAPSED_STRING","'custom_design'",277],["T_WHITESPACE","\n    ",277],")",";",["T_WHITESPACE","\n\n    ",278],["T_DOC_COMMENT","\/**\n     * Links attribute name-to-link type ID.\n     *\n     * @var array\n     *\/",280],["T_WHITESPACE","\n    ",284],["T_PROTECTED","protected",285],["T_WHITESPACE"," ",285],["T_VARIABLE","$_linkNameToId",285],["T_WHITESPACE"," ",285],"=",["T_WHITESPACE"," ",285],["T_ARRAY","array",285],"(",["T_WHITESPACE","\n        ",285],["T_CONSTANT_ENCAPSED_STRING","'_links_related_'",286],["T_WHITESPACE","   ",286],["T_DOUBLE_ARROW","=>",286],["T_WHITESPACE"," ",286],["T_STRING","Mage_Catalog_Model_Product_Link",286],["T_DOUBLE_COLON","::",286],["T_STRING","LINK_TYPE_RELATED",286],",",["T_WHITESPACE","\n        ",286],["T_CONSTANT_ENCAPSED_STRING","'_links_crosssell_'",287],["T_WHITESPACE"," ",287],["T_DOUBLE_ARROW","=>",287],["T_WHITESPACE"," ",287],["T_STRING","Mage_Catalog_Model_Product_Link",287],["T_DOUBLE_COLON","::",287],["T_STRING","LINK_TYPE_CROSSSELL",287],",",["T_WHITESPACE","\n        ",287],["T_CONSTANT_ENCAPSED_STRING","'_links_upsell_'",288],["T_WHITESPACE","    ",288],["T_DOUBLE_ARROW","=>",288],["T_WHITESPACE"," ",288],["T_STRING","Mage_Catalog_Model_Product_Link",288],["T_DOUBLE_COLON","::",288],["T_STRING","LINK_TYPE_UPSELL",288],["T_WHITESPACE","\n    ",288],")",";",["T_WHITESPACE","\n\n    ",289],["T_DOC_COMMENT","\/**\n     * Validation failure message template definitions\n     *\n     * @var array\n     *\/",291],["T_WHITESPACE","\n    ",295],["T_PROTECTED","protected",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$_messageTemplates",296],["T_WHITESPACE"," ",296],"=",["T_WHITESPACE"," ",296],["T_ARRAY","array",296],"(",["T_WHITESPACE","\n        ",296],["T_STRING","self",297],["T_DOUBLE_COLON","::",297],["T_STRING","ERROR_INVALID_SCOPE",297],["T_WHITESPACE","                ",297],["T_DOUBLE_ARROW","=>",297],["T_WHITESPACE"," ",297],["T_CONSTANT_ENCAPSED_STRING","'Invalid value in Scope column'",297],",",["T_WHITESPACE","\n        ",297],["T_STRING","self",298],["T_DOUBLE_COLON","::",298],["T_STRING","ERROR_INVALID_WEBSITE",298],["T_WHITESPACE","              ",298],["T_DOUBLE_ARROW","=>",298],["T_WHITESPACE"," ",298],["T_CONSTANT_ENCAPSED_STRING","'Invalid value in Website column (website does not exists?)'",298],",",["T_WHITESPACE","\n        ",298],["T_STRING","self",299],["T_DOUBLE_COLON","::",299],["T_STRING","ERROR_INVALID_STORE",299],["T_WHITESPACE","                ",299],["T_DOUBLE_ARROW","=>",299],["T_WHITESPACE"," ",299],["T_CONSTANT_ENCAPSED_STRING","'Invalid value in Store column (store does not exists?)'",299],",",["T_WHITESPACE","\n        ",299],["T_STRING","self",300],["T_DOUBLE_COLON","::",300],["T_STRING","ERROR_INVALID_ATTR_SET",300],["T_WHITESPACE","             ",300],["T_DOUBLE_ARROW","=>",300],["T_WHITESPACE"," ",300],["T_CONSTANT_ENCAPSED_STRING","'Invalid value for Attribute Set column (set does not exists?)'",300],",",["T_WHITESPACE","\n        ",300],["T_STRING","self",301],["T_DOUBLE_COLON","::",301],["T_STRING","ERROR_INVALID_TYPE",301],["T_WHITESPACE","                 ",301],["T_DOUBLE_ARROW","=>",301],["T_WHITESPACE"," ",301],["T_CONSTANT_ENCAPSED_STRING","'Product Type is invalid or not supported'",301],",",["T_WHITESPACE","\n        ",301],["T_STRING","self",302],["T_DOUBLE_COLON","::",302],["T_STRING","ERROR_INVALID_CATEGORY",302],["T_WHITESPACE","             ",302],["T_DOUBLE_ARROW","=>",302],["T_WHITESPACE"," ",302],["T_CONSTANT_ENCAPSED_STRING","'Category does not exists'",302],",",["T_WHITESPACE","\n        ",302],["T_STRING","self",303],["T_DOUBLE_COLON","::",303],["T_STRING","ERROR_VALUE_IS_REQUIRED",303],["T_WHITESPACE","            ",303],["T_DOUBLE_ARROW","=>",303],["T_WHITESPACE"," ",303],["T_CONSTANT_ENCAPSED_STRING","\"Required attribute '%s' has an empty value\"",303],",",["T_WHITESPACE","\n        ",303],["T_STRING","self",304],["T_DOUBLE_COLON","::",304],["T_STRING","ERROR_TYPE_CHANGED",304],["T_WHITESPACE","                 ",304],["T_DOUBLE_ARROW","=>",304],["T_WHITESPACE"," ",304],["T_CONSTANT_ENCAPSED_STRING","'Trying to change type of existing products'",304],",",["T_WHITESPACE","\n        ",304],["T_STRING","self",305],["T_DOUBLE_COLON","::",305],["T_STRING","ERROR_SKU_IS_EMPTY",305],["T_WHITESPACE","                 ",305],["T_DOUBLE_ARROW","=>",305],["T_WHITESPACE"," ",305],["T_CONSTANT_ENCAPSED_STRING","'SKU is empty'",305],",",["T_WHITESPACE","\n        ",305],["T_STRING","self",306],["T_DOUBLE_COLON","::",306],["T_STRING","ERROR_NO_DEFAULT_ROW",306],["T_WHITESPACE","               ",306],["T_DOUBLE_ARROW","=>",306],["T_WHITESPACE"," ",306],["T_CONSTANT_ENCAPSED_STRING","'Default values row does not exists'",306],",",["T_WHITESPACE","\n        ",306],["T_STRING","self",307],["T_DOUBLE_COLON","::",307],["T_STRING","ERROR_CHANGE_TYPE",307],["T_WHITESPACE","                  ",307],["T_DOUBLE_ARROW","=>",307],["T_WHITESPACE"," ",307],["T_CONSTANT_ENCAPSED_STRING","'Product type change is not allowed'",307],",",["T_WHITESPACE","\n        ",307],["T_STRING","self",308],["T_DOUBLE_COLON","::",308],["T_STRING","ERROR_DUPLICATE_SCOPE",308],["T_WHITESPACE","              ",308],["T_DOUBLE_ARROW","=>",308],["T_WHITESPACE"," ",308],["T_CONSTANT_ENCAPSED_STRING","'Duplicate scope'",308],",",["T_WHITESPACE","\n        ",308],["T_STRING","self",309],["T_DOUBLE_COLON","::",309],["T_STRING","ERROR_DUPLICATE_SKU",309],["T_WHITESPACE","                ",309],["T_DOUBLE_ARROW","=>",309],["T_WHITESPACE"," ",309],["T_CONSTANT_ENCAPSED_STRING","'Duplicate SKU'",309],",",["T_WHITESPACE","\n        ",309],["T_STRING","self",310],["T_DOUBLE_COLON","::",310],["T_STRING","ERROR_CHANGE_ATTR_SET",310],["T_WHITESPACE","              ",310],["T_DOUBLE_ARROW","=>",310],["T_WHITESPACE"," ",310],["T_CONSTANT_ENCAPSED_STRING","'Product attribute set change is not allowed'",310],",",["T_WHITESPACE","\n        ",310],["T_STRING","self",311],["T_DOUBLE_COLON","::",311],["T_STRING","ERROR_TYPE_UNSUPPORTED",311],["T_WHITESPACE","             ",311],["T_DOUBLE_ARROW","=>",311],["T_WHITESPACE"," ",311],["T_CONSTANT_ENCAPSED_STRING","'Product type is not supported'",311],",",["T_WHITESPACE","\n        ",311],["T_STRING","self",312],["T_DOUBLE_COLON","::",312],["T_STRING","ERROR_ROW_IS_ORPHAN",312],["T_WHITESPACE","                ",312],["T_DOUBLE_ARROW","=>",312],["T_WHITESPACE"," ",312],["T_CONSTANT_ENCAPSED_STRING","'Orphan rows that will be skipped due default row errors'",312],",",["T_WHITESPACE","\n        ",312],["T_STRING","self",313],["T_DOUBLE_COLON","::",313],["T_STRING","ERROR_INVALID_TIER_PRICE_QTY",313],["T_WHITESPACE","       ",313],["T_DOUBLE_ARROW","=>",313],["T_WHITESPACE"," ",313],["T_CONSTANT_ENCAPSED_STRING","'Tier Price data price or quantity value is invalid'",313],",",["T_WHITESPACE","\n        ",313],["T_STRING","self",314],["T_DOUBLE_COLON","::",314],["T_STRING","ERROR_INVALID_TIER_PRICE_SITE",314],["T_WHITESPACE","      ",314],["T_DOUBLE_ARROW","=>",314],["T_WHITESPACE"," ",314],["T_CONSTANT_ENCAPSED_STRING","'Tier Price data website is invalid'",314],",",["T_WHITESPACE","\n        ",314],["T_STRING","self",315],["T_DOUBLE_COLON","::",315],["T_STRING","ERROR_INVALID_TIER_PRICE_GROUP",315],["T_WHITESPACE","     ",315],["T_DOUBLE_ARROW","=>",315],["T_WHITESPACE"," ",315],["T_CONSTANT_ENCAPSED_STRING","'Tier Price customer group ID is invalid'",315],",",["T_WHITESPACE","\n        ",315],["T_STRING","self",316],["T_DOUBLE_COLON","::",316],["T_STRING","ERROR_TIER_DATA_INCOMPLETE",316],["T_WHITESPACE","         ",316],["T_DOUBLE_ARROW","=>",316],["T_WHITESPACE"," ",316],["T_CONSTANT_ENCAPSED_STRING","'Tier Price data is incomplete'",316],",",["T_WHITESPACE","\n        ",316],["T_STRING","self",317],["T_DOUBLE_COLON","::",317],["T_STRING","ERROR_SKU_NOT_FOUND_FOR_DELETE",317],["T_WHITESPACE","     ",317],["T_DOUBLE_ARROW","=>",317],["T_WHITESPACE"," ",317],["T_CONSTANT_ENCAPSED_STRING","'Product with specified SKU not found'",317],",",["T_WHITESPACE","\n        ",317],["T_STRING","self",318],["T_DOUBLE_COLON","::",318],["T_STRING","ERROR_SUPER_PRODUCTS_SKU_NOT_FOUND",318],["T_WHITESPACE"," ",318],["T_DOUBLE_ARROW","=>",318],["T_WHITESPACE"," ",318],["T_CONSTANT_ENCAPSED_STRING","'Product with specified super products SKU not found'",318],["T_WHITESPACE","\n    ",318],")",";",["T_WHITESPACE","\n\n    ",319],["T_DOC_COMMENT","\/**\n     * Dry-runned products information from import file.\n     *\n     * [SKU] => array(\n     *     'type_id'        => (string) product type\n     *     'attr_set_id'    => (int) product attribute set ID\n     *     'entity_id'      => (int) product ID (value for new products will be set after entity save)\n     *     'attr_set_code'  => (string) attribute set code\n     * )\n     *\n     * @var array\n     *\/",321],["T_WHITESPACE","\n    ",332],["T_PROTECTED","protected",333],["T_WHITESPACE"," ",333],["T_VARIABLE","$_newSku",333],["T_WHITESPACE"," ",333],"=",["T_WHITESPACE"," ",333],["T_ARRAY","array",333],"(",")",";",["T_WHITESPACE","\n\n    ",333],["T_DOC_COMMENT","\/**\n     * Existing products SKU-related information in form of array:\n     *\n     * [SKU] => array(\n     *     'type_id'        => (string) product type\n     *     'attr_set_id'    => (int) product attribute set ID\n     *     'entity_id'      => (int) product ID\n     *     'supported_type' => (boolean) is product type supported by current version of import module\n     * )\n     *\n     * @var array\n     *\/",335],["T_WHITESPACE","\n    ",346],["T_PROTECTED","protected",347],["T_WHITESPACE"," ",347],["T_VARIABLE","$_oldSku",347],["T_WHITESPACE"," ",347],"=",["T_WHITESPACE"," ",347],["T_ARRAY","array",347],"(",")",";",["T_WHITESPACE","\n\n    ",347],["T_DOC_COMMENT","\/**\n     * Column names that holds values with particular meaning.\n     *\n     * @var array\n     *\/",349],["T_WHITESPACE","\n    ",353],["T_PROTECTED","protected",354],["T_WHITESPACE"," ",354],["T_VARIABLE","$_particularAttributes",354],["T_WHITESPACE"," ",354],"=",["T_WHITESPACE"," ",354],["T_ARRAY","array",354],"(",["T_WHITESPACE","\n        ",354],["T_CONSTANT_ENCAPSED_STRING","'_store'",355],",",["T_WHITESPACE"," ",355],["T_CONSTANT_ENCAPSED_STRING","'_attribute_set'",355],",",["T_WHITESPACE"," ",355],["T_CONSTANT_ENCAPSED_STRING","'_type'",355],",",["T_WHITESPACE"," ",355],["T_STRING","self",355],["T_DOUBLE_COLON","::",355],["T_STRING","COL_CATEGORY",355],",",["T_WHITESPACE"," ",355],["T_STRING","self",355],["T_DOUBLE_COLON","::",355],["T_STRING","COL_ROOT_CATEGORY",355],",",["T_WHITESPACE"," ",355],["T_CONSTANT_ENCAPSED_STRING","'_product_websites'",355],",",["T_WHITESPACE","\n        ",355],["T_CONSTANT_ENCAPSED_STRING","'_tier_price_website'",356],",",["T_WHITESPACE"," ",356],["T_CONSTANT_ENCAPSED_STRING","'_tier_price_customer_group'",356],",",["T_WHITESPACE"," ",356],["T_CONSTANT_ENCAPSED_STRING","'_tier_price_qty'",356],",",["T_WHITESPACE"," ",356],["T_CONSTANT_ENCAPSED_STRING","'_tier_price_price'",356],",",["T_WHITESPACE","\n        ",356],["T_CONSTANT_ENCAPSED_STRING","'_links_related_sku'",357],",",["T_WHITESPACE"," ",357],["T_CONSTANT_ENCAPSED_STRING","'_group_price_website'",357],",",["T_WHITESPACE"," ",357],["T_CONSTANT_ENCAPSED_STRING","'_group_price_customer_group'",357],",",["T_WHITESPACE"," ",357],["T_CONSTANT_ENCAPSED_STRING","'_group_price_price'",357],",",["T_WHITESPACE","\n        ",357],["T_CONSTANT_ENCAPSED_STRING","'_links_related_position'",358],",",["T_WHITESPACE"," ",358],["T_CONSTANT_ENCAPSED_STRING","'_links_crosssell_sku'",358],",",["T_WHITESPACE"," ",358],["T_CONSTANT_ENCAPSED_STRING","'_links_crosssell_position'",358],",",["T_WHITESPACE"," ",358],["T_CONSTANT_ENCAPSED_STRING","'_links_upsell_sku'",358],",",["T_WHITESPACE","\n        ",358],["T_CONSTANT_ENCAPSED_STRING","'_links_upsell_position'",359],",",["T_WHITESPACE"," ",359],["T_CONSTANT_ENCAPSED_STRING","'_custom_option_store'",359],",",["T_WHITESPACE"," ",359],["T_CONSTANT_ENCAPSED_STRING","'_custom_option_type'",359],",",["T_WHITESPACE"," ",359],["T_CONSTANT_ENCAPSED_STRING","'_custom_option_title'",359],",",["T_WHITESPACE","\n        ",359],["T_CONSTANT_ENCAPSED_STRING","'_custom_option_is_required'",360],",",["T_WHITESPACE"," ",360],["T_CONSTANT_ENCAPSED_STRING","'_custom_option_price'",360],",",["T_WHITESPACE"," ",360],["T_CONSTANT_ENCAPSED_STRING","'_custom_option_sku'",360],",",["T_WHITESPACE"," ",360],["T_CONSTANT_ENCAPSED_STRING","'_custom_option_max_characters'",360],",",["T_WHITESPACE","\n        ",360],["T_CONSTANT_ENCAPSED_STRING","'_custom_option_sort_order'",361],",",["T_WHITESPACE"," ",361],["T_CONSTANT_ENCAPSED_STRING","'_custom_option_file_extension'",361],",",["T_WHITESPACE"," ",361],["T_CONSTANT_ENCAPSED_STRING","'_custom_option_image_size_x'",361],",",["T_WHITESPACE","\n        ",361],["T_CONSTANT_ENCAPSED_STRING","'_custom_option_image_size_y'",362],",",["T_WHITESPACE"," ",362],["T_CONSTANT_ENCAPSED_STRING","'_custom_option_row_title'",362],",",["T_WHITESPACE"," ",362],["T_CONSTANT_ENCAPSED_STRING","'_custom_option_row_price'",362],",",["T_WHITESPACE","\n        ",362],["T_CONSTANT_ENCAPSED_STRING","'_custom_option_row_sku'",363],",",["T_WHITESPACE"," ",363],["T_CONSTANT_ENCAPSED_STRING","'_custom_option_row_sort'",363],",",["T_WHITESPACE"," ",363],["T_CONSTANT_ENCAPSED_STRING","'_media_attribute_id'",363],",",["T_WHITESPACE"," ",363],["T_CONSTANT_ENCAPSED_STRING","'_media_image'",363],",",["T_WHITESPACE"," ",363],["T_CONSTANT_ENCAPSED_STRING","'_media_lable'",363],",",["T_WHITESPACE","\n        ",363],["T_CONSTANT_ENCAPSED_STRING","'_media_position'",364],",",["T_WHITESPACE"," ",364],["T_CONSTANT_ENCAPSED_STRING","'_media_is_disabled'",364],["T_WHITESPACE","\n    ",364],")",";",["T_WHITESPACE","\n\n    ",365],["T_DOC_COMMENT","\/**\n     * Column names that holds images files names\n     *\n     * @var array\n     *\/",367],["T_WHITESPACE","\n    ",371],["T_PROTECTED","protected",372],["T_WHITESPACE"," ",372],["T_VARIABLE","$_imagesArrayKeys",372],["T_WHITESPACE"," ",372],"=",["T_WHITESPACE"," ",372],["T_ARRAY","array",372],"(",["T_WHITESPACE","\n        ",372],["T_CONSTANT_ENCAPSED_STRING","'_media_image'",373],",",["T_WHITESPACE"," ",373],["T_CONSTANT_ENCAPSED_STRING","'image'",373],",",["T_WHITESPACE"," ",373],["T_CONSTANT_ENCAPSED_STRING","'small_image'",373],",",["T_WHITESPACE"," ",373],["T_CONSTANT_ENCAPSED_STRING","'thumbnail'",373],["T_WHITESPACE","\n    ",373],")",";",["T_WHITESPACE","\n\n    ",374],["T_DOC_COMMENT","\/**\n     * Permanent entity columns.\n     *\n     * @var array\n     *\/",376],["T_WHITESPACE","\n    ",380],["T_PROTECTED","protected",381],["T_WHITESPACE"," ",381],["T_VARIABLE","$_permanentAttributes",381],["T_WHITESPACE"," ",381],"=",["T_WHITESPACE"," ",381],["T_ARRAY","array",381],"(",["T_STRING","self",381],["T_DOUBLE_COLON","::",381],["T_STRING","COL_SKU",381],")",";",["T_WHITESPACE","\n\n    ",381],["T_DOC_COMMENT","\/**\n     * Array of supported product types as keys with appropriate model object as value.\n     *\n     * @var array\n     *\/",383],["T_WHITESPACE","\n    ",387],["T_PROTECTED","protected",388],["T_WHITESPACE"," ",388],["T_VARIABLE","$_productTypeModels",388],["T_WHITESPACE"," ",388],"=",["T_WHITESPACE"," ",388],["T_ARRAY","array",388],"(",")",";",["T_WHITESPACE","\n\n    ",388],["T_DOC_COMMENT","\/**\n     * All stores code-ID pairs.\n     *\n     * @var array\n     *\/",390],["T_WHITESPACE","\n    ",394],["T_PROTECTED","protected",395],["T_WHITESPACE"," ",395],["T_VARIABLE","$_storeCodeToId",395],["T_WHITESPACE"," ",395],"=",["T_WHITESPACE"," ",395],["T_ARRAY","array",395],"(",")",";",["T_WHITESPACE","\n\n    ",395],["T_DOC_COMMENT","\/**\n     * Store ID to its website stores IDs.\n     *\n     * @var array\n     *\/",397],["T_WHITESPACE","\n    ",401],["T_PROTECTED","protected",402],["T_WHITESPACE"," ",402],["T_VARIABLE","$_storeIdToWebsiteStoreIds",402],["T_WHITESPACE"," ",402],"=",["T_WHITESPACE"," ",402],["T_ARRAY","array",402],"(",")",";",["T_WHITESPACE","\n\n    ",402],["T_DOC_COMMENT","\/**\n     * Website code-to-ID\n     *\n     * @var array\n     *\/",404],["T_WHITESPACE","\n    ",408],["T_PROTECTED","protected",409],["T_WHITESPACE"," ",409],["T_VARIABLE","$_websiteCodeToId",409],["T_WHITESPACE"," ",409],"=",["T_WHITESPACE"," ",409],["T_ARRAY","array",409],"(",")",";",["T_WHITESPACE","\n\n    ",409],["T_DOC_COMMENT","\/**\n     * Website code to store code-to-ID pairs which it consists.\n     *\n     * @var array\n     *\/",411],["T_WHITESPACE","\n    ",415],["T_PROTECTED","protected",416],["T_WHITESPACE"," ",416],["T_VARIABLE","$_websiteCodeToStoreIds",416],["T_WHITESPACE"," ",416],"=",["T_WHITESPACE"," ",416],["T_ARRAY","array",416],"(",")",";",["T_WHITESPACE","\n\n    ",416],["T_DOC_COMMENT","\/**\n     * Media files uploader\n     *\n     * @var Mage_ImportExport_Model_Import_Uploader\n     *\/",418],["T_WHITESPACE","\n    ",422],["T_PROTECTED","protected",423],["T_WHITESPACE"," ",423],["T_VARIABLE","$_fileUploader",423],";",["T_WHITESPACE","\n\n    ",423],["T_DOC_COMMENT","\/**\n     * url_key attribute id\n     *\n     * @var int\n     *\/",425],["T_WHITESPACE","\n    ",429],["T_PROTECTED","protected",430],["T_WHITESPACE"," ",430],["T_VARIABLE","$_urlKeyAttributeId",430],";",["T_WHITESPACE","\n\n    ",430],["T_DOC_COMMENT","\/**\n     * Constructor.\n     *\n     *\/",432],["T_WHITESPACE","\n    ",435],["T_PUBLIC","public",436],["T_WHITESPACE"," ",436],["T_FUNCTION","function",436],["T_WHITESPACE"," ",436],["T_STRING","__construct",436],"(",")",["T_WHITESPACE","\n    ",436],"{",["T_WHITESPACE","\n        ",437],["T_STRING","parent",438],["T_DOUBLE_COLON","::",438],["T_STRING","__construct",438],"(",")",";",["T_WHITESPACE","\n\n        ",438],["T_VARIABLE","$this",440],["T_OBJECT_OPERATOR","->",440],["T_STRING","_initWebsites",440],"(",")",["T_WHITESPACE","\n            ",440],["T_OBJECT_OPERATOR","->",441],["T_STRING","_initStores",441],"(",")",["T_WHITESPACE","\n            ",441],["T_OBJECT_OPERATOR","->",442],["T_STRING","_initAttributeSets",442],"(",")",["T_WHITESPACE","\n            ",442],["T_OBJECT_OPERATOR","->",443],["T_STRING","_initTypeModels",443],"(",")",["T_WHITESPACE","\n            ",443],["T_OBJECT_OPERATOR","->",444],["T_STRING","_initCategories",444],"(",")",["T_WHITESPACE","\n            ",444],["T_OBJECT_OPERATOR","->",445],["T_STRING","_initSkus",445],"(",")",["T_WHITESPACE","\n            ",445],["T_OBJECT_OPERATOR","->",446],["T_STRING","_initCustomerGroups",446],"(",")",";",["T_WHITESPACE","\n    ",446],"}",["T_WHITESPACE","\n\n    ",447],["T_DOC_COMMENT","\/**\n     * Delete products.\n     *\n     * @return Mage_ImportExport_Model_Import_Entity_Product\n     *\/",449],["T_WHITESPACE","\n    ",453],["T_PROTECTED","protected",454],["T_WHITESPACE"," ",454],["T_FUNCTION","function",454],["T_WHITESPACE"," ",454],["T_STRING","_deleteProducts",454],"(",")",["T_WHITESPACE","\n    ",454],"{",["T_WHITESPACE","\n        ",455],["T_VARIABLE","$productEntityTable",456],["T_WHITESPACE"," ",456],"=",["T_WHITESPACE"," ",456],["T_STRING","Mage",456],["T_DOUBLE_COLON","::",456],["T_STRING","getModel",456],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport\/import_proxy_product_resource'",456],")",["T_OBJECT_OPERATOR","->",456],["T_STRING","getEntityTable",456],"(",")",";",["T_WHITESPACE","\n\n        ",456],["T_WHILE","while",458],["T_WHITESPACE"," ",458],"(",["T_VARIABLE","$bunch",458],["T_WHITESPACE"," ",458],"=",["T_WHITESPACE"," ",458],["T_VARIABLE","$this",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","_dataSourceModel",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","getNextBunch",458],"(",")",")",["T_WHITESPACE"," ",458],"{",["T_WHITESPACE","\n            ",458],["T_VARIABLE","$idToDelete",459],["T_WHITESPACE"," ",459],"=",["T_WHITESPACE"," ",459],["T_ARRAY","array",459],"(",")",";",["T_WHITESPACE","\n\n            ",459],["T_FOREACH","foreach",461],["T_WHITESPACE"," ",461],"(",["T_VARIABLE","$bunch",461],["T_WHITESPACE"," ",461],["T_AS","as",461],["T_WHITESPACE"," ",461],["T_VARIABLE","$rowNum",461],["T_WHITESPACE"," ",461],["T_DOUBLE_ARROW","=>",461],["T_WHITESPACE"," ",461],["T_VARIABLE","$rowData",461],")",["T_WHITESPACE"," ",461],"{",["T_WHITESPACE","\n                ",461],["T_IF","if",462],["T_WHITESPACE"," ",462],"(",["T_VARIABLE","$this",462],["T_OBJECT_OPERATOR","->",462],["T_STRING","validateRow",462],"(",["T_VARIABLE","$rowData",462],",",["T_WHITESPACE"," ",462],["T_VARIABLE","$rowNum",462],")",["T_WHITESPACE"," ",462],["T_BOOLEAN_AND","&&",462],["T_WHITESPACE"," ",462],["T_STRING","self",462],["T_DOUBLE_COLON","::",462],["T_STRING","SCOPE_DEFAULT",462],["T_WHITESPACE"," ",462],["T_IS_EQUAL","==",462],["T_WHITESPACE"," ",462],["T_VARIABLE","$this",462],["T_OBJECT_OPERATOR","->",462],["T_STRING","getRowScope",462],"(",["T_VARIABLE","$rowData",462],")",")",["T_WHITESPACE"," ",462],"{",["T_WHITESPACE","\n                    ",462],["T_VARIABLE","$idToDelete",463],"[","]",["T_WHITESPACE"," ",463],"=",["T_WHITESPACE"," ",463],["T_VARIABLE","$this",463],["T_OBJECT_OPERATOR","->",463],["T_STRING","_oldSku",463],"[",["T_VARIABLE","$rowData",463],"[",["T_STRING","self",463],["T_DOUBLE_COLON","::",463],["T_STRING","COL_SKU",463],"]","]","[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",463],"]",";",["T_WHITESPACE","\n                ",463],"}",["T_WHITESPACE","\n            ",464],"}",["T_WHITESPACE","\n            ",465],["T_IF","if",466],["T_WHITESPACE"," ",466],"(",["T_VARIABLE","$idToDelete",466],")",["T_WHITESPACE"," ",466],"{",["T_WHITESPACE","\n                ",466],["T_VARIABLE","$this",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","_connection",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","query",467],"(",["T_WHITESPACE","\n                    ",467],["T_VARIABLE","$this",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","_connection",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","quoteInto",468],"(",["T_WHITESPACE","\n                        ",468],"\"",["T_ENCAPSED_AND_WHITESPACE","DELETE FROM `",469],["T_CURLY_OPEN","{",469],["T_VARIABLE","$productEntityTable",469],"}",["T_ENCAPSED_AND_WHITESPACE","` WHERE `entity_id` IN (?)",469],"\"",",",["T_WHITESPACE"," ",469],["T_VARIABLE","$idToDelete",469],["T_WHITESPACE","\n                    ",469],")",["T_WHITESPACE","\n                ",470],")",";",["T_WHITESPACE","\n            ",471],"}",["T_WHITESPACE","\n        ",472],"}",["T_WHITESPACE","\n        ",473],["T_RETURN","return",474],["T_WHITESPACE"," ",474],["T_VARIABLE","$this",474],";",["T_WHITESPACE","\n    ",474],"}",["T_WHITESPACE","\n\n    ",475],["T_DOC_COMMENT","\/**\n     * Create Product entity from raw data.\n     *\n     * @throws Exception\n     * @return bool Result of operation.\n     *\/",477],["T_WHITESPACE","\n    ",482],["T_PROTECTED","protected",483],["T_WHITESPACE"," ",483],["T_FUNCTION","function",483],["T_WHITESPACE"," ",483],["T_STRING","_importData",483],"(",")",["T_WHITESPACE","\n    ",483],"{",["T_WHITESPACE","\n        ",484],["T_IF","if",485],["T_WHITESPACE"," ",485],"(",["T_STRING","Mage_ImportExport_Model_Import",485],["T_DOUBLE_COLON","::",485],["T_STRING","BEHAVIOR_DELETE",485],["T_WHITESPACE"," ",485],["T_IS_EQUAL","==",485],["T_WHITESPACE"," ",485],["T_VARIABLE","$this",485],["T_OBJECT_OPERATOR","->",485],["T_STRING","getBehavior",485],"(",")",")",["T_WHITESPACE"," ",485],"{",["T_WHITESPACE","\n            ",485],["T_VARIABLE","$this",486],["T_OBJECT_OPERATOR","->",486],["T_STRING","_deleteProducts",486],"(",")",";",["T_WHITESPACE","\n        ",486],"}",["T_WHITESPACE"," ",487],["T_ELSE","else",487],["T_WHITESPACE"," ",487],"{",["T_WHITESPACE","\n            ",487],["T_VARIABLE","$this",488],["T_OBJECT_OPERATOR","->",488],["T_STRING","_saveProducts",488],"(",")",";",["T_WHITESPACE","\n            ",488],["T_VARIABLE","$this",489],["T_OBJECT_OPERATOR","->",489],["T_STRING","_saveStockItem",489],"(",")",";",["T_WHITESPACE","\n            ",489],["T_VARIABLE","$this",490],["T_OBJECT_OPERATOR","->",490],["T_STRING","_saveLinks",490],"(",")",";",["T_WHITESPACE","\n            ",490],["T_VARIABLE","$this",491],["T_OBJECT_OPERATOR","->",491],["T_STRING","_saveCustomOptions",491],"(",")",";",["T_WHITESPACE","\n            ",491],["T_FOREACH","foreach",492],["T_WHITESPACE"," ",492],"(",["T_VARIABLE","$this",492],["T_OBJECT_OPERATOR","->",492],["T_STRING","_productTypeModels",492],["T_WHITESPACE"," ",492],["T_AS","as",492],["T_WHITESPACE"," ",492],["T_VARIABLE","$productType",492],["T_WHITESPACE"," ",492],["T_DOUBLE_ARROW","=>",492],["T_WHITESPACE"," ",492],["T_VARIABLE","$productTypeModel",492],")",["T_WHITESPACE"," ",492],"{",["T_WHITESPACE","\n                ",492],["T_VARIABLE","$productTypeModel",493],["T_OBJECT_OPERATOR","->",493],["T_STRING","saveData",493],"(",")",";",["T_WHITESPACE","\n            ",493],"}",["T_WHITESPACE","\n        ",494],"}",["T_WHITESPACE","\n        ",495],["T_STRING","Mage",496],["T_DOUBLE_COLON","::",496],["T_STRING","dispatchEvent",496],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_import_finish_before'",496],",",["T_WHITESPACE"," ",496],["T_ARRAY","array",496],"(",["T_CONSTANT_ENCAPSED_STRING","'adapter'",496],["T_WHITESPACE"," ",496],["T_DOUBLE_ARROW","=>",496],["T_WHITESPACE"," ",496],["T_VARIABLE","$this",496],")",")",";",["T_WHITESPACE","\n        ",496],["T_RETURN","return",497],["T_WHITESPACE"," ",497],["T_STRING","true",497],";",["T_WHITESPACE","\n    ",497],"}",["T_WHITESPACE","\n\n    ",498],["T_DOC_COMMENT","\/**\n     * Initialize attribute sets code-to-id pairs.\n     *\n     * @return Mage_ImportExport_Model_Import_Entity_Product\n     *\/",500],["T_WHITESPACE","\n    ",504],["T_PROTECTED","protected",505],["T_WHITESPACE"," ",505],["T_FUNCTION","function",505],["T_WHITESPACE"," ",505],["T_STRING","_initAttributeSets",505],"(",")",["T_WHITESPACE","\n    ",505],"{",["T_WHITESPACE","\n        ",506],["T_FOREACH","foreach",507],["T_WHITESPACE"," ",507],"(",["T_STRING","Mage",507],["T_DOUBLE_COLON","::",507],["T_STRING","getResourceModel",507],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/entity_attribute_set_collection'",507],")",["T_WHITESPACE","\n                ",507],["T_OBJECT_OPERATOR","->",508],["T_STRING","setEntityTypeFilter",508],"(",["T_VARIABLE","$this",508],["T_OBJECT_OPERATOR","->",508],["T_STRING","_entityTypeId",508],")",["T_WHITESPACE"," ",508],["T_AS","as",508],["T_WHITESPACE"," ",508],["T_VARIABLE","$attributeSet",508],")",["T_WHITESPACE"," ",508],"{",["T_WHITESPACE","\n            ",508],["T_VARIABLE","$this",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","_attrSetNameToId",509],"[",["T_VARIABLE","$attributeSet",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","getAttributeSetName",509],"(",")","]",["T_WHITESPACE"," ",509],"=",["T_WHITESPACE"," ",509],["T_VARIABLE","$attributeSet",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","getId",509],"(",")",";",["T_WHITESPACE","\n            ",509],["T_VARIABLE","$this",510],["T_OBJECT_OPERATOR","->",510],["T_STRING","_attrSetIdToName",510],"[",["T_VARIABLE","$attributeSet",510],["T_OBJECT_OPERATOR","->",510],["T_STRING","getId",510],"(",")","]",["T_WHITESPACE"," ",510],"=",["T_WHITESPACE"," ",510],["T_VARIABLE","$attributeSet",510],["T_OBJECT_OPERATOR","->",510],["T_STRING","getAttributeSetName",510],"(",")",";",["T_WHITESPACE","\n        ",510],"}",["T_WHITESPACE","\n        ",511],["T_RETURN","return",512],["T_WHITESPACE"," ",512],["T_VARIABLE","$this",512],";",["T_WHITESPACE","\n    ",512],"}",["T_WHITESPACE","\n\n    ",513],["T_DOC_COMMENT","\/**\n     * Initialize categories text-path to ID hash.\n     *\n     * @return Mage_ImportExport_Model_Import_Entity_Product\n     *\/",515],["T_WHITESPACE","\n    ",519],["T_PROTECTED","protected",520],["T_WHITESPACE"," ",520],["T_FUNCTION","function",520],["T_WHITESPACE"," ",520],["T_STRING","_initCategories",520],"(",")",["T_WHITESPACE","\n    ",520],"{",["T_WHITESPACE","\n        ",521],["T_VARIABLE","$collection",522],["T_WHITESPACE"," ",522],"=",["T_WHITESPACE"," ",522],["T_STRING","Mage",522],["T_DOUBLE_COLON","::",522],["T_STRING","getResourceModel",522],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category_collection'",522],")",["T_OBJECT_OPERATOR","->",522],["T_STRING","addNameToResult",522],"(",")",";",["T_WHITESPACE","\n        ",522],["T_COMMENT","\/* @var $collection Mage_Catalog_Model_Resource_Eav_Mysql4_Category_Collection *\/",523],["T_WHITESPACE","\n        ",523],["T_FOREACH","foreach",524],["T_WHITESPACE"," ",524],"(",["T_VARIABLE","$collection",524],["T_WHITESPACE"," ",524],["T_AS","as",524],["T_WHITESPACE"," ",524],["T_VARIABLE","$category",524],")",["T_WHITESPACE"," ",524],"{",["T_WHITESPACE","\n            ",524],["T_VARIABLE","$structure",525],["T_WHITESPACE"," ",525],"=",["T_WHITESPACE"," ",525],["T_STRING","explode",525],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",525],",",["T_WHITESPACE"," ",525],["T_VARIABLE","$category",525],["T_OBJECT_OPERATOR","->",525],["T_STRING","getPath",525],"(",")",")",";",["T_WHITESPACE","\n            ",525],["T_VARIABLE","$pathSize",526],["T_WHITESPACE","  ",526],"=",["T_WHITESPACE"," ",526],["T_STRING","count",526],"(",["T_VARIABLE","$structure",526],")",";",["T_WHITESPACE","\n            ",526],["T_IF","if",527],["T_WHITESPACE"," ",527],"(",["T_VARIABLE","$pathSize",527],["T_WHITESPACE"," ",527],">",["T_WHITESPACE"," ",527],["T_LNUMBER","1",527],")",["T_WHITESPACE"," ",527],"{",["T_WHITESPACE","\n                ",527],["T_VARIABLE","$path",528],["T_WHITESPACE"," ",528],"=",["T_WHITESPACE"," ",528],["T_ARRAY","array",528],"(",")",";",["T_WHITESPACE","\n                ",528],["T_FOR","for",529],["T_WHITESPACE"," ",529],"(",["T_VARIABLE","$i",529],["T_WHITESPACE"," ",529],"=",["T_WHITESPACE"," ",529],["T_LNUMBER","1",529],";",["T_WHITESPACE"," ",529],["T_VARIABLE","$i",529],["T_WHITESPACE"," ",529],"<",["T_WHITESPACE"," ",529],["T_VARIABLE","$pathSize",529],";",["T_WHITESPACE"," ",529],["T_VARIABLE","$i",529],["T_INC","++",529],")",["T_WHITESPACE"," ",529],"{",["T_WHITESPACE","\n                    ",529],["T_VARIABLE","$path",530],"[","]",["T_WHITESPACE"," ",530],"=",["T_WHITESPACE"," ",530],["T_VARIABLE","$collection",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","getItemById",530],"(",["T_VARIABLE","$structure",530],"[",["T_VARIABLE","$i",530],"]",")",["T_OBJECT_OPERATOR","->",530],["T_STRING","getName",530],"(",")",";",["T_WHITESPACE","\n                ",530],"}",["T_WHITESPACE","\n                ",531],["T_VARIABLE","$rootCategoryName",532],["T_WHITESPACE"," ",532],"=",["T_WHITESPACE"," ",532],["T_STRING","array_shift",532],"(",["T_VARIABLE","$path",532],")",";",["T_WHITESPACE","\n                ",532],["T_IF","if",533],["T_WHITESPACE"," ",533],"(","!",["T_ISSET","isset",533],"(",["T_VARIABLE","$this",533],["T_OBJECT_OPERATOR","->",533],["T_STRING","_categoriesWithRoots",533],"[",["T_VARIABLE","$rootCategoryName",533],"]",")",")",["T_WHITESPACE"," ",533],"{",["T_WHITESPACE","\n                    ",533],["T_VARIABLE","$this",534],["T_OBJECT_OPERATOR","->",534],["T_STRING","_categoriesWithRoots",534],"[",["T_VARIABLE","$rootCategoryName",534],"]",["T_WHITESPACE"," ",534],"=",["T_WHITESPACE"," ",534],["T_ARRAY","array",534],"(",")",";",["T_WHITESPACE","\n                ",534],"}",["T_WHITESPACE","\n                ",535],["T_VARIABLE","$index",536],["T_WHITESPACE"," ",536],"=",["T_WHITESPACE"," ",536],["T_STRING","implode",536],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",536],",",["T_WHITESPACE"," ",536],["T_VARIABLE","$path",536],")",";",["T_WHITESPACE","\n                ",536],["T_VARIABLE","$this",537],["T_OBJECT_OPERATOR","->",537],["T_STRING","_categoriesWithRoots",537],"[",["T_VARIABLE","$rootCategoryName",537],"]","[",["T_VARIABLE","$index",537],"]",["T_WHITESPACE"," ",537],"=",["T_WHITESPACE"," ",537],["T_VARIABLE","$category",537],["T_OBJECT_OPERATOR","->",537],["T_STRING","getId",537],"(",")",";",["T_WHITESPACE","\n                ",537],["T_IF","if",538],["T_WHITESPACE"," ",538],"(",["T_VARIABLE","$pathSize",538],["T_WHITESPACE"," ",538],">",["T_WHITESPACE"," ",538],["T_LNUMBER","2",538],")",["T_WHITESPACE"," ",538],"{",["T_WHITESPACE","\n                    ",538],["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","_categories",539],"[",["T_VARIABLE","$index",539],"]",["T_WHITESPACE"," ",539],"=",["T_WHITESPACE"," ",539],["T_VARIABLE","$category",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","getId",539],"(",")",";",["T_WHITESPACE","\n                ",539],"}",["T_WHITESPACE","\n            ",540],"}",["T_WHITESPACE","\n        ",541],"}",["T_WHITESPACE","\n        ",542],["T_RETURN","return",543],["T_WHITESPACE"," ",543],["T_VARIABLE","$this",543],";",["T_WHITESPACE","\n    ",543],"}",["T_WHITESPACE","\n\n    ",544],["T_DOC_COMMENT","\/**\n     * Initialize customer groups.\n     *\n     * @return Mage_ImportExport_Model_Import_Entity_Product\n     *\/",546],["T_WHITESPACE","\n    ",550],["T_PROTECTED","protected",551],["T_WHITESPACE"," ",551],["T_FUNCTION","function",551],["T_WHITESPACE"," ",551],["T_STRING","_initCustomerGroups",551],"(",")",["T_WHITESPACE","\n    ",551],"{",["T_WHITESPACE","\n        ",552],["T_FOREACH","foreach",553],["T_WHITESPACE"," ",553],"(",["T_STRING","Mage",553],["T_DOUBLE_COLON","::",553],["T_STRING","getResourceModel",553],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/group_collection'",553],")",["T_WHITESPACE"," ",553],["T_AS","as",553],["T_WHITESPACE"," ",553],["T_VARIABLE","$customerGroup",553],")",["T_WHITESPACE"," ",553],"{",["T_WHITESPACE","\n            ",553],["T_VARIABLE","$this",554],["T_OBJECT_OPERATOR","->",554],["T_STRING","_customerGroups",554],"[",["T_VARIABLE","$customerGroup",554],["T_OBJECT_OPERATOR","->",554],["T_STRING","getId",554],"(",")","]",["T_WHITESPACE"," ",554],"=",["T_WHITESPACE"," ",554],["T_STRING","true",554],";",["T_WHITESPACE","\n        ",554],"}",["T_WHITESPACE","\n        ",555],["T_RETURN","return",556],["T_WHITESPACE"," ",556],["T_VARIABLE","$this",556],";",["T_WHITESPACE","\n    ",556],"}",["T_WHITESPACE","\n\n    ",557],["T_DOC_COMMENT","\/**\n     * Initialize existent product SKUs.\n     *\n     * @return Mage_ImportExport_Model_Import_Entity_Product\n     *\/",559],["T_WHITESPACE","\n    ",563],["T_PROTECTED","protected",564],["T_WHITESPACE"," ",564],["T_FUNCTION","function",564],["T_WHITESPACE"," ",564],["T_STRING","_initSkus",564],"(",")",["T_WHITESPACE","\n    ",564],"{",["T_WHITESPACE","\n        ",565],["T_VARIABLE","$columns",566],["T_WHITESPACE"," ",566],"=",["T_WHITESPACE"," ",566],["T_ARRAY","array",566],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",566],",",["T_WHITESPACE"," ",566],["T_CONSTANT_ENCAPSED_STRING","'type_id'",566],",",["T_WHITESPACE"," ",566],["T_CONSTANT_ENCAPSED_STRING","'attribute_set_id'",566],",",["T_WHITESPACE"," ",566],["T_CONSTANT_ENCAPSED_STRING","'sku'",566],")",";",["T_WHITESPACE","\n        ",566],["T_FOREACH","foreach",567],["T_WHITESPACE"," ",567],"(",["T_STRING","Mage",567],["T_DOUBLE_COLON","::",567],["T_STRING","getModel",567],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",567],")",["T_OBJECT_OPERATOR","->",567],["T_STRING","getProductEntitiesInfo",567],"(",["T_VARIABLE","$columns",567],")",["T_WHITESPACE"," ",567],["T_AS","as",567],["T_WHITESPACE"," ",567],["T_VARIABLE","$info",567],")",["T_WHITESPACE"," ",567],"{",["T_WHITESPACE","\n            ",567],["T_VARIABLE","$typeId",568],["T_WHITESPACE"," ",568],"=",["T_WHITESPACE"," ",568],["T_VARIABLE","$info",568],"[",["T_CONSTANT_ENCAPSED_STRING","'type_id'",568],"]",";",["T_WHITESPACE","\n            ",568],["T_VARIABLE","$sku",569],["T_WHITESPACE"," ",569],"=",["T_WHITESPACE"," ",569],["T_VARIABLE","$info",569],"[",["T_CONSTANT_ENCAPSED_STRING","'sku'",569],"]",";",["T_WHITESPACE","\n            ",569],["T_VARIABLE","$this",570],["T_OBJECT_OPERATOR","->",570],["T_STRING","_oldSku",570],"[",["T_VARIABLE","$sku",570],"]",["T_WHITESPACE"," ",570],"=",["T_WHITESPACE"," ",570],["T_ARRAY","array",570],"(",["T_WHITESPACE","\n                ",570],["T_CONSTANT_ENCAPSED_STRING","'type_id'",571],["T_WHITESPACE","        ",571],["T_DOUBLE_ARROW","=>",571],["T_WHITESPACE"," ",571],["T_VARIABLE","$typeId",571],",",["T_WHITESPACE","\n                ",571],["T_CONSTANT_ENCAPSED_STRING","'attr_set_id'",572],["T_WHITESPACE","    ",572],["T_DOUBLE_ARROW","=>",572],["T_WHITESPACE"," ",572],["T_VARIABLE","$info",572],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_set_id'",572],"]",",",["T_WHITESPACE","\n                ",572],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",573],["T_WHITESPACE","      ",573],["T_DOUBLE_ARROW","=>",573],["T_WHITESPACE"," ",573],["T_VARIABLE","$info",573],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",573],"]",",",["T_WHITESPACE","\n                ",573],["T_CONSTANT_ENCAPSED_STRING","'supported_type'",574],["T_WHITESPACE"," ",574],["T_DOUBLE_ARROW","=>",574],["T_WHITESPACE"," ",574],["T_ISSET","isset",574],"(",["T_VARIABLE","$this",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","_productTypeModels",574],"[",["T_VARIABLE","$typeId",574],"]",")",["T_WHITESPACE","\n            ",574],")",";",["T_WHITESPACE","\n        ",575],"}",["T_WHITESPACE","\n        ",576],["T_RETURN","return",577],["T_WHITESPACE"," ",577],["T_VARIABLE","$this",577],";",["T_WHITESPACE","\n    ",577],"}",["T_WHITESPACE","\n\n    ",578],["T_DOC_COMMENT","\/**\n     * Initialize stores hash.\n     *\n     * @return Mage_ImportExport_Model_Import_Entity_Product\n     *\/",580],["T_WHITESPACE","\n    ",584],["T_PROTECTED","protected",585],["T_WHITESPACE"," ",585],["T_FUNCTION","function",585],["T_WHITESPACE"," ",585],["T_STRING","_initStores",585],"(",")",["T_WHITESPACE","\n    ",585],"{",["T_WHITESPACE","\n        ",586],["T_FOREACH","foreach",587],["T_WHITESPACE"," ",587],"(",["T_STRING","Mage",587],["T_DOUBLE_COLON","::",587],["T_STRING","app",587],"(",")",["T_OBJECT_OPERATOR","->",587],["T_STRING","getStores",587],"(",")",["T_WHITESPACE"," ",587],["T_AS","as",587],["T_WHITESPACE"," ",587],["T_VARIABLE","$store",587],")",["T_WHITESPACE"," ",587],"{",["T_WHITESPACE","\n            ",587],["T_VARIABLE","$this",588],["T_OBJECT_OPERATOR","->",588],["T_STRING","_storeCodeToId",588],"[",["T_VARIABLE","$store",588],["T_OBJECT_OPERATOR","->",588],["T_STRING","getCode",588],"(",")","]",["T_WHITESPACE"," ",588],"=",["T_WHITESPACE"," ",588],["T_VARIABLE","$store",588],["T_OBJECT_OPERATOR","->",588],["T_STRING","getId",588],"(",")",";",["T_WHITESPACE","\n            ",588],["T_VARIABLE","$this",589],["T_OBJECT_OPERATOR","->",589],["T_STRING","_storeIdToWebsiteStoreIds",589],"[",["T_VARIABLE","$store",589],["T_OBJECT_OPERATOR","->",589],["T_STRING","getId",589],"(",")","]",["T_WHITESPACE"," ",589],"=",["T_WHITESPACE"," ",589],["T_VARIABLE","$store",589],["T_OBJECT_OPERATOR","->",589],["T_STRING","getWebsite",589],"(",")",["T_OBJECT_OPERATOR","->",589],["T_STRING","getStoreIds",589],"(",")",";",["T_WHITESPACE","\n        ",589],"}",["T_WHITESPACE","\n        ",590],["T_RETURN","return",591],["T_WHITESPACE"," ",591],["T_VARIABLE","$this",591],";",["T_WHITESPACE","\n    ",591],"}",["T_WHITESPACE","\n\n    ",592],["T_DOC_COMMENT","\/**\n     * Initialize product type models.\n     *\n     * @throws Exception\n     * @return Mage_ImportExport_Model_Import_Entity_Product\n     *\/",594],["T_WHITESPACE","\n    ",599],["T_PROTECTED","protected",600],["T_WHITESPACE"," ",600],["T_FUNCTION","function",600],["T_WHITESPACE"," ",600],["T_STRING","_initTypeModels",600],"(",")",["T_WHITESPACE","\n    ",600],"{",["T_WHITESPACE","\n        ",601],["T_VARIABLE","$config",602],["T_WHITESPACE"," ",602],"=",["T_WHITESPACE"," ",602],["T_STRING","Mage",602],["T_DOUBLE_COLON","::",602],["T_STRING","getConfig",602],"(",")",["T_OBJECT_OPERATOR","->",602],["T_STRING","getNode",602],"(",["T_STRING","self",602],["T_DOUBLE_COLON","::",602],["T_STRING","CONFIG_KEY_PRODUCT_TYPES",602],")",["T_OBJECT_OPERATOR","->",602],["T_STRING","asCanonicalArray",602],"(",")",";",["T_WHITESPACE","\n        ",602],["T_FOREACH","foreach",603],["T_WHITESPACE"," ",603],"(",["T_VARIABLE","$config",603],["T_WHITESPACE"," ",603],["T_AS","as",603],["T_WHITESPACE"," ",603],["T_VARIABLE","$type",603],["T_WHITESPACE"," ",603],["T_DOUBLE_ARROW","=>",603],["T_WHITESPACE"," ",603],["T_VARIABLE","$typeModel",603],")",["T_WHITESPACE"," ",603],"{",["T_WHITESPACE","\n            ",603],["T_VARIABLE","$model",604],["T_WHITESPACE"," ",604],"=",["T_WHITESPACE"," ",604],["T_STRING","Mage",604],["T_DOUBLE_COLON","::",604],["T_STRING","getModel",604],"(",["T_VARIABLE","$typeModel",604],",",["T_WHITESPACE"," ",604],["T_ARRAY","array",604],"(",["T_VARIABLE","$this",604],",",["T_WHITESPACE"," ",604],["T_VARIABLE","$type",604],")",")",";",["T_WHITESPACE","\n            ",604],["T_IF","if",605],["T_WHITESPACE"," ",605],"(","!",["T_VARIABLE","$model",605],")",["T_WHITESPACE"," ",605],"{",["T_WHITESPACE","\n                ",605],["T_STRING","Mage",606],["T_DOUBLE_COLON","::",606],["T_STRING","throwException",606],"(","\"",["T_ENCAPSED_AND_WHITESPACE","Entity type model '",606],["T_CURLY_OPEN","{",606],["T_VARIABLE","$typeModel",606],"}",["T_ENCAPSED_AND_WHITESPACE","' is not found",606],"\"",")",";",["T_WHITESPACE","\n            ",606],"}",["T_WHITESPACE","\n            ",607],["T_IF","if",608],["T_WHITESPACE"," ",608],"(","!",["T_WHITESPACE"," ",608],["T_VARIABLE","$model",608],["T_WHITESPACE"," ",608],["T_INSTANCEOF","instanceof",608],["T_WHITESPACE"," ",608],["T_STRING","Mage_ImportExport_Model_Import_Entity_Product_Type_Abstract",608],")",["T_WHITESPACE"," ",608],"{",["T_WHITESPACE","\n                ",608],["T_STRING","Mage",609],["T_DOUBLE_COLON","::",609],["T_STRING","throwException",609],"(",["T_WHITESPACE","\n                    ",609],["T_STRING","Mage",610],["T_DOUBLE_COLON","::",610],["T_STRING","helper",610],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",610],")",["T_OBJECT_OPERATOR","->",610],["T_STRING","__",610],"(",["T_CONSTANT_ENCAPSED_STRING","'Entity type model must be an instance of Mage_ImportExport_Model_Import_Entity_Product_Type_Abstract'",610],")",["T_WHITESPACE","\n                ",610],")",";",["T_WHITESPACE","\n            ",611],"}",["T_WHITESPACE","\n            ",612],["T_IF","if",613],["T_WHITESPACE"," ",613],"(",["T_VARIABLE","$model",613],["T_OBJECT_OPERATOR","->",613],["T_STRING","isSuitable",613],"(",")",")",["T_WHITESPACE"," ",613],"{",["T_WHITESPACE","\n                ",613],["T_VARIABLE","$this",614],["T_OBJECT_OPERATOR","->",614],["T_STRING","_productTypeModels",614],"[",["T_VARIABLE","$type",614],"]",["T_WHITESPACE"," ",614],"=",["T_WHITESPACE"," ",614],["T_VARIABLE","$model",614],";",["T_WHITESPACE","\n            ",614],"}",["T_WHITESPACE","\n            ",615],["T_VARIABLE","$this",616],["T_OBJECT_OPERATOR","->",616],["T_STRING","_particularAttributes",616],["T_WHITESPACE"," ",616],"=",["T_WHITESPACE"," ",616],["T_STRING","array_merge",616],"(",["T_WHITESPACE","\n                ",616],["T_VARIABLE","$this",617],["T_OBJECT_OPERATOR","->",617],["T_STRING","_particularAttributes",617],",",["T_WHITESPACE","\n                ",617],["T_VARIABLE","$model",618],["T_OBJECT_OPERATOR","->",618],["T_STRING","getParticularAttributes",618],"(",")",["T_WHITESPACE","\n            ",618],")",";",["T_WHITESPACE","\n        ",619],"}",["T_WHITESPACE","\n        ",620],["T_COMMENT","\/\/ remove doubles\n",621],["T_WHITESPACE","        ",622],["T_VARIABLE","$this",622],["T_OBJECT_OPERATOR","->",622],["T_STRING","_particularAttributes",622],["T_WHITESPACE"," ",622],"=",["T_WHITESPACE"," ",622],["T_STRING","array_unique",622],"(",["T_VARIABLE","$this",622],["T_OBJECT_OPERATOR","->",622],["T_STRING","_particularAttributes",622],")",";",["T_WHITESPACE","\n\n        ",622],["T_RETURN","return",624],["T_WHITESPACE"," ",624],["T_VARIABLE","$this",624],";",["T_WHITESPACE","\n    ",624],"}",["T_WHITESPACE","\n\n    ",625],["T_DOC_COMMENT","\/**\n     * Initialize website values.\n     *\n     * @return Mage_ImportExport_Model_Import_Entity_Product\n     *\/",627],["T_WHITESPACE","\n    ",631],["T_PROTECTED","protected",632],["T_WHITESPACE"," ",632],["T_FUNCTION","function",632],["T_WHITESPACE"," ",632],["T_STRING","_initWebsites",632],"(",")",["T_WHITESPACE","\n    ",632],"{",["T_WHITESPACE","\n        ",633],["T_DOC_COMMENT","\/** @var $website Mage_Core_Model_Website *\/",634],["T_WHITESPACE","\n        ",634],["T_FOREACH","foreach",635],["T_WHITESPACE"," ",635],"(",["T_STRING","Mage",635],["T_DOUBLE_COLON","::",635],["T_STRING","app",635],"(",")",["T_OBJECT_OPERATOR","->",635],["T_STRING","getWebsites",635],"(",")",["T_WHITESPACE"," ",635],["T_AS","as",635],["T_WHITESPACE"," ",635],["T_VARIABLE","$website",635],")",["T_WHITESPACE"," ",635],"{",["T_WHITESPACE","\n            ",635],["T_VARIABLE","$this",636],["T_OBJECT_OPERATOR","->",636],["T_STRING","_websiteCodeToId",636],"[",["T_VARIABLE","$website",636],["T_OBJECT_OPERATOR","->",636],["T_STRING","getCode",636],"(",")","]",["T_WHITESPACE"," ",636],"=",["T_WHITESPACE"," ",636],["T_VARIABLE","$website",636],["T_OBJECT_OPERATOR","->",636],["T_STRING","getId",636],"(",")",";",["T_WHITESPACE","\n            ",636],["T_VARIABLE","$this",637],["T_OBJECT_OPERATOR","->",637],["T_STRING","_websiteCodeToStoreIds",637],"[",["T_VARIABLE","$website",637],["T_OBJECT_OPERATOR","->",637],["T_STRING","getCode",637],"(",")","]",["T_WHITESPACE"," ",637],"=",["T_WHITESPACE"," ",637],["T_STRING","array_flip",637],"(",["T_VARIABLE","$website",637],["T_OBJECT_OPERATOR","->",637],["T_STRING","getStoreCodes",637],"(",")",")",";",["T_WHITESPACE","\n        ",637],"}",["T_WHITESPACE","\n        ",638],["T_RETURN","return",639],["T_WHITESPACE"," ",639],["T_VARIABLE","$this",639],";",["T_WHITESPACE","\n    ",639],"}",["T_WHITESPACE","\n\n    ",640],["T_DOC_COMMENT","\/**\n     * Check product category validity.\n     *\n     * @param array $rowData\n     * @param int $rowNum\n     * @return bool\n     *\/",642],["T_WHITESPACE","\n    ",648],["T_PROTECTED","protected",649],["T_WHITESPACE"," ",649],["T_FUNCTION","function",649],["T_WHITESPACE"," ",649],["T_STRING","_isProductCategoryValid",649],"(",["T_ARRAY","array",649],["T_WHITESPACE"," ",649],["T_VARIABLE","$rowData",649],",",["T_WHITESPACE"," ",649],["T_VARIABLE","$rowNum",649],")",["T_WHITESPACE","\n    ",649],"{",["T_WHITESPACE","\n        ",650],["T_VARIABLE","$emptyCategory",651],["T_WHITESPACE"," ",651],"=",["T_WHITESPACE"," ",651],["T_EMPTY","empty",651],"(",["T_VARIABLE","$rowData",651],"[",["T_STRING","self",651],["T_DOUBLE_COLON","::",651],["T_STRING","COL_CATEGORY",651],"]",")",";",["T_WHITESPACE","\n        ",651],["T_VARIABLE","$emptyRootCategory",652],["T_WHITESPACE"," ",652],"=",["T_WHITESPACE"," ",652],["T_EMPTY","empty",652],"(",["T_VARIABLE","$rowData",652],"[",["T_STRING","self",652],["T_DOUBLE_COLON","::",652],["T_STRING","COL_ROOT_CATEGORY",652],"]",")",";",["T_WHITESPACE","\n        ",652],["T_VARIABLE","$hasCategory",653],["T_WHITESPACE"," ",653],"=",["T_WHITESPACE"," ",653],["T_VARIABLE","$emptyCategory",653],["T_WHITESPACE"," ",653],"?",["T_WHITESPACE"," ",653],["T_STRING","false",653],["T_WHITESPACE"," ",653],":",["T_WHITESPACE"," ",653],["T_ISSET","isset",653],"(",["T_VARIABLE","$this",653],["T_OBJECT_OPERATOR","->",653],["T_STRING","_categories",653],"[",["T_VARIABLE","$rowData",653],"[",["T_STRING","self",653],["T_DOUBLE_COLON","::",653],["T_STRING","COL_CATEGORY",653],"]","]",")",";",["T_WHITESPACE","\n        ",653],["T_VARIABLE","$category",654],["T_WHITESPACE"," ",654],"=",["T_WHITESPACE"," ",654],["T_VARIABLE","$emptyRootCategory",654],["T_WHITESPACE"," ",654],"?",["T_WHITESPACE"," ",654],["T_STRING","null",654],["T_WHITESPACE"," ",654],":",["T_WHITESPACE"," ",654],["T_VARIABLE","$this",654],["T_OBJECT_OPERATOR","->",654],["T_STRING","_categoriesWithRoots",654],"[",["T_VARIABLE","$rowData",654],"[",["T_STRING","self",654],["T_DOUBLE_COLON","::",654],["T_STRING","COL_ROOT_CATEGORY",654],"]","]",";",["T_WHITESPACE","\n        ",654],["T_IF","if",655],["T_WHITESPACE"," ",655],"(","!",["T_VARIABLE","$emptyCategory",655],["T_WHITESPACE"," ",655],["T_BOOLEAN_AND","&&",655],["T_WHITESPACE"," ",655],"!",["T_VARIABLE","$hasCategory",655],["T_WHITESPACE","\n            ",655],["T_BOOLEAN_OR","||",656],["T_WHITESPACE"," ",656],"!",["T_VARIABLE","$emptyRootCategory",656],["T_WHITESPACE"," ",656],["T_BOOLEAN_AND","&&",656],["T_WHITESPACE"," ",656],"!",["T_ISSET","isset",656],"(",["T_VARIABLE","$category",656],")",["T_WHITESPACE","\n            ",656],["T_BOOLEAN_OR","||",657],["T_WHITESPACE"," ",657],"!",["T_VARIABLE","$emptyRootCategory",657],["T_WHITESPACE"," ",657],["T_BOOLEAN_AND","&&",657],["T_WHITESPACE"," ",657],"!",["T_VARIABLE","$emptyCategory",657],["T_WHITESPACE"," ",657],["T_BOOLEAN_AND","&&",657],["T_WHITESPACE"," ",657],"!",["T_ISSET","isset",657],"(",["T_VARIABLE","$category",657],"[",["T_VARIABLE","$rowData",657],"[",["T_STRING","self",657],["T_DOUBLE_COLON","::",657],["T_STRING","COL_CATEGORY",657],"]","]",")",["T_WHITESPACE","\n        ",657],")",["T_WHITESPACE"," ",658],"{",["T_WHITESPACE","\n            ",658],["T_VARIABLE","$this",659],["T_OBJECT_OPERATOR","->",659],["T_STRING","addRowError",659],"(",["T_STRING","self",659],["T_DOUBLE_COLON","::",659],["T_STRING","ERROR_INVALID_CATEGORY",659],",",["T_WHITESPACE"," ",659],["T_VARIABLE","$rowNum",659],")",";",["T_WHITESPACE","\n            ",659],["T_RETURN","return",660],["T_WHITESPACE"," ",660],["T_STRING","false",660],";",["T_WHITESPACE","\n        ",660],"}",["T_WHITESPACE","\n        ",661],["T_RETURN","return",662],["T_WHITESPACE"," ",662],["T_STRING","true",662],";",["T_WHITESPACE","\n    ",662],"}",["T_WHITESPACE","\n\n    ",663],["T_DOC_COMMENT","\/**\n     * Check product website belonging.\n     *\n     * @param array $rowData\n     * @param int $rowNum\n     * @return bool\n     *\/",665],["T_WHITESPACE","\n    ",671],["T_PROTECTED","protected",672],["T_WHITESPACE"," ",672],["T_FUNCTION","function",672],["T_WHITESPACE"," ",672],["T_STRING","_isProductWebsiteValid",672],"(",["T_ARRAY","array",672],["T_WHITESPACE"," ",672],["T_VARIABLE","$rowData",672],",",["T_WHITESPACE"," ",672],["T_VARIABLE","$rowNum",672],")",["T_WHITESPACE","\n    ",672],"{",["T_WHITESPACE","\n        ",673],["T_IF","if",674],["T_WHITESPACE"," ",674],"(","!",["T_EMPTY","empty",674],"(",["T_VARIABLE","$rowData",674],"[",["T_CONSTANT_ENCAPSED_STRING","'_product_websites'",674],"]",")",["T_WHITESPACE"," ",674],["T_BOOLEAN_AND","&&",674],["T_WHITESPACE"," ",674],"!",["T_ISSET","isset",674],"(",["T_VARIABLE","$this",674],["T_OBJECT_OPERATOR","->",674],["T_STRING","_websiteCodeToId",674],"[",["T_VARIABLE","$rowData",674],"[",["T_CONSTANT_ENCAPSED_STRING","'_product_websites'",674],"]","]",")",")",["T_WHITESPACE"," ",674],"{",["T_WHITESPACE","\n            ",674],["T_VARIABLE","$this",675],["T_OBJECT_OPERATOR","->",675],["T_STRING","addRowError",675],"(",["T_STRING","self",675],["T_DOUBLE_COLON","::",675],["T_STRING","ERROR_INVALID_WEBSITE",675],",",["T_WHITESPACE"," ",675],["T_VARIABLE","$rowNum",675],")",";",["T_WHITESPACE","\n            ",675],["T_RETURN","return",676],["T_WHITESPACE"," ",676],["T_STRING","false",676],";",["T_WHITESPACE","\n        ",676],"}",["T_WHITESPACE","\n        ",677],["T_RETURN","return",678],["T_WHITESPACE"," ",678],["T_STRING","true",678],";",["T_WHITESPACE","\n    ",678],"}",["T_WHITESPACE","\n\n    ",679],["T_DOC_COMMENT","\/**\n     * Set valid attribute set and product type to rows with all scopes\n     * to ensure that existing products doesn't changed.\n     *\n     * @param array $rowData\n     * @return array\n     *\/",681],["T_WHITESPACE","\n    ",687],["T_PROTECTED","protected",688],["T_WHITESPACE"," ",688],["T_FUNCTION","function",688],["T_WHITESPACE"," ",688],["T_STRING","_prepareRowForDb",688],"(",["T_ARRAY","array",688],["T_WHITESPACE"," ",688],["T_VARIABLE","$rowData",688],")",["T_WHITESPACE","\n    ",688],"{",["T_WHITESPACE","\n        ",689],["T_VARIABLE","$rowData",690],["T_WHITESPACE"," ",690],"=",["T_WHITESPACE"," ",690],["T_STRING","parent",690],["T_DOUBLE_COLON","::",690],["T_STRING","_prepareRowForDb",690],"(",["T_VARIABLE","$rowData",690],")",";",["T_WHITESPACE","\n\n        ",690],["T_STATIC","static",692],["T_WHITESPACE"," ",692],["T_VARIABLE","$lastSku",692],["T_WHITESPACE","  ",692],"=",["T_WHITESPACE"," ",692],["T_STRING","null",692],";",["T_WHITESPACE","\n\n        ",692],["T_IF","if",694],["T_WHITESPACE"," ",694],"(",["T_STRING","Mage_ImportExport_Model_Import",694],["T_DOUBLE_COLON","::",694],["T_STRING","BEHAVIOR_DELETE",694],["T_WHITESPACE"," ",694],["T_IS_EQUAL","==",694],["T_WHITESPACE"," ",694],["T_VARIABLE","$this",694],["T_OBJECT_OPERATOR","->",694],["T_STRING","getBehavior",694],"(",")",")",["T_WHITESPACE"," ",694],"{",["T_WHITESPACE","\n            ",694],["T_RETURN","return",695],["T_WHITESPACE"," ",695],["T_VARIABLE","$rowData",695],";",["T_WHITESPACE","\n        ",695],"}",["T_WHITESPACE","\n        ",696],["T_IF","if",697],["T_WHITESPACE"," ",697],"(",["T_STRING","self",697],["T_DOUBLE_COLON","::",697],["T_STRING","SCOPE_DEFAULT",697],["T_WHITESPACE"," ",697],["T_IS_EQUAL","==",697],["T_WHITESPACE"," ",697],["T_VARIABLE","$this",697],["T_OBJECT_OPERATOR","->",697],["T_STRING","getRowScope",697],"(",["T_VARIABLE","$rowData",697],")",")",["T_WHITESPACE"," ",697],"{",["T_WHITESPACE","\n            ",697],["T_VARIABLE","$lastSku",698],["T_WHITESPACE"," ",698],"=",["T_WHITESPACE"," ",698],["T_VARIABLE","$rowData",698],"[",["T_STRING","self",698],["T_DOUBLE_COLON","::",698],["T_STRING","COL_SKU",698],"]",";",["T_WHITESPACE","\n        ",698],"}",["T_WHITESPACE","\n        ",699],["T_IF","if",700],["T_WHITESPACE"," ",700],"(",["T_ISSET","isset",700],"(",["T_VARIABLE","$this",700],["T_OBJECT_OPERATOR","->",700],["T_STRING","_oldSku",700],"[",["T_VARIABLE","$lastSku",700],"]",")",")",["T_WHITESPACE"," ",700],"{",["T_WHITESPACE","\n            ",700],["T_VARIABLE","$rowData",701],"[",["T_STRING","self",701],["T_DOUBLE_COLON","::",701],["T_STRING","COL_ATTR_SET",701],"]",["T_WHITESPACE"," ",701],"=",["T_WHITESPACE"," ",701],["T_VARIABLE","$this",701],["T_OBJECT_OPERATOR","->",701],["T_STRING","_newSku",701],"[",["T_VARIABLE","$lastSku",701],"]","[",["T_CONSTANT_ENCAPSED_STRING","'attr_set_code'",701],"]",";",["T_WHITESPACE","\n            ",701],["T_VARIABLE","$rowData",702],"[",["T_STRING","self",702],["T_DOUBLE_COLON","::",702],["T_STRING","COL_TYPE",702],"]",["T_WHITESPACE","     ",702],"=",["T_WHITESPACE"," ",702],["T_VARIABLE","$this",702],["T_OBJECT_OPERATOR","->",702],["T_STRING","_newSku",702],"[",["T_VARIABLE","$lastSku",702],"]","[",["T_CONSTANT_ENCAPSED_STRING","'type_id'",702],"]",";",["T_WHITESPACE","\n        ",702],"}",["T_WHITESPACE","\n\n        ",703],["T_RETURN","return",705],["T_WHITESPACE"," ",705],["T_VARIABLE","$rowData",705],";",["T_WHITESPACE","\n    ",705],"}",["T_WHITESPACE","\n\n    ",706],["T_DOC_COMMENT","\/**\n     * Check tier price data validity.\n     *\n     * @param array $rowData\n     * @param int $rowNum\n     * @return bool\n     *\/",708],["T_WHITESPACE","\n    ",714],["T_PROTECTED","protected",715],["T_WHITESPACE"," ",715],["T_FUNCTION","function",715],["T_WHITESPACE"," ",715],["T_STRING","_isTierPriceValid",715],"(",["T_ARRAY","array",715],["T_WHITESPACE"," ",715],["T_VARIABLE","$rowData",715],",",["T_WHITESPACE"," ",715],["T_VARIABLE","$rowNum",715],")",["T_WHITESPACE","\n    ",715],"{",["T_WHITESPACE","\n        ",716],["T_IF","if",717],["T_WHITESPACE"," ",717],"(","(",["T_ISSET","isset",717],"(",["T_VARIABLE","$rowData",717],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_website'",717],"]",")",["T_WHITESPACE"," ",717],["T_BOOLEAN_AND","&&",717],["T_WHITESPACE"," ",717],["T_STRING","strlen",717],"(",["T_VARIABLE","$rowData",717],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_website'",717],"]",")",")",["T_WHITESPACE","\n                ",717],["T_BOOLEAN_OR","||",718],["T_WHITESPACE"," ",718],"(",["T_ISSET","isset",718],"(",["T_VARIABLE","$rowData",718],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_customer_group'",718],"]",")",["T_WHITESPACE"," ",718],["T_BOOLEAN_AND","&&",718],["T_WHITESPACE"," ",718],["T_STRING","strlen",718],"(",["T_VARIABLE","$rowData",718],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_customer_group'",718],"]",")",")",["T_WHITESPACE","\n                ",718],["T_BOOLEAN_OR","||",719],["T_WHITESPACE"," ",719],"(",["T_ISSET","isset",719],"(",["T_VARIABLE","$rowData",719],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_qty'",719],"]",")",["T_WHITESPACE"," ",719],["T_BOOLEAN_AND","&&",719],["T_WHITESPACE"," ",719],["T_STRING","strlen",719],"(",["T_VARIABLE","$rowData",719],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_qty'",719],"]",")",")",["T_WHITESPACE","\n                ",719],["T_BOOLEAN_OR","||",720],["T_WHITESPACE"," ",720],"(",["T_ISSET","isset",720],"(",["T_VARIABLE","$rowData",720],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_price'",720],"]",")",["T_WHITESPACE"," ",720],["T_BOOLEAN_AND","&&",720],["T_WHITESPACE"," ",720],["T_STRING","strlen",720],"(",["T_VARIABLE","$rowData",720],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_price'",720],"]",")",")",["T_WHITESPACE","\n        ",720],")",["T_WHITESPACE"," ",721],"{",["T_WHITESPACE","\n            ",721],["T_IF","if",722],["T_WHITESPACE"," ",722],"(","!",["T_ISSET","isset",722],"(",["T_VARIABLE","$rowData",722],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_website'",722],"]",")",["T_WHITESPACE"," ",722],["T_BOOLEAN_OR","||",722],["T_WHITESPACE"," ",722],"!",["T_ISSET","isset",722],"(",["T_VARIABLE","$rowData",722],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_customer_group'",722],"]",")",["T_WHITESPACE","\n                    ",722],["T_BOOLEAN_OR","||",723],["T_WHITESPACE"," ",723],"!",["T_ISSET","isset",723],"(",["T_VARIABLE","$rowData",723],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_qty'",723],"]",")",["T_WHITESPACE"," ",723],["T_BOOLEAN_OR","||",723],["T_WHITESPACE"," ",723],"!",["T_ISSET","isset",723],"(",["T_VARIABLE","$rowData",723],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_price'",723],"]",")",["T_WHITESPACE","\n                    ",723],["T_BOOLEAN_OR","||",724],["T_WHITESPACE"," ",724],"!",["T_STRING","strlen",724],"(",["T_VARIABLE","$rowData",724],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_website'",724],"]",")",["T_WHITESPACE"," ",724],["T_BOOLEAN_OR","||",724],["T_WHITESPACE"," ",724],"!",["T_STRING","strlen",724],"(",["T_VARIABLE","$rowData",724],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_customer_group'",724],"]",")",["T_WHITESPACE","\n                    ",724],["T_BOOLEAN_OR","||",725],["T_WHITESPACE"," ",725],"!",["T_STRING","strlen",725],"(",["T_VARIABLE","$rowData",725],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_qty'",725],"]",")",["T_WHITESPACE"," ",725],["T_BOOLEAN_OR","||",725],["T_WHITESPACE"," ",725],"!",["T_STRING","strlen",725],"(",["T_VARIABLE","$rowData",725],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_price'",725],"]",")",["T_WHITESPACE","\n            ",725],")",["T_WHITESPACE"," ",726],"{",["T_WHITESPACE","\n                ",726],["T_VARIABLE","$this",727],["T_OBJECT_OPERATOR","->",727],["T_STRING","addRowError",727],"(",["T_STRING","self",727],["T_DOUBLE_COLON","::",727],["T_STRING","ERROR_TIER_DATA_INCOMPLETE",727],",",["T_WHITESPACE"," ",727],["T_VARIABLE","$rowNum",727],")",";",["T_WHITESPACE","\n                ",727],["T_RETURN","return",728],["T_WHITESPACE"," ",728],["T_STRING","false",728],";",["T_WHITESPACE","\n            ",728],"}",["T_WHITESPACE"," ",729],["T_ELSEIF","elseif",729],["T_WHITESPACE"," ",729],"(",["T_VARIABLE","$rowData",729],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_website'",729],"]",["T_WHITESPACE"," ",729],["T_IS_NOT_EQUAL","!=",729],["T_WHITESPACE"," ",729],["T_STRING","self",729],["T_DOUBLE_COLON","::",729],["T_STRING","VALUE_ALL",729],["T_WHITESPACE","\n                    ",729],["T_BOOLEAN_AND","&&",730],["T_WHITESPACE"," ",730],"!",["T_ISSET","isset",730],"(",["T_VARIABLE","$this",730],["T_OBJECT_OPERATOR","->",730],["T_STRING","_websiteCodeToId",730],"[",["T_VARIABLE","$rowData",730],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_website'",730],"]","]",")",")",["T_WHITESPACE"," ",730],"{",["T_WHITESPACE","\n                ",730],["T_VARIABLE","$this",731],["T_OBJECT_OPERATOR","->",731],["T_STRING","addRowError",731],"(",["T_STRING","self",731],["T_DOUBLE_COLON","::",731],["T_STRING","ERROR_INVALID_TIER_PRICE_SITE",731],",",["T_WHITESPACE"," ",731],["T_VARIABLE","$rowNum",731],")",";",["T_WHITESPACE","\n                ",731],["T_RETURN","return",732],["T_WHITESPACE"," ",732],["T_STRING","false",732],";",["T_WHITESPACE","\n            ",732],"}",["T_WHITESPACE"," ",733],["T_ELSEIF","elseif",733],["T_WHITESPACE"," ",733],"(",["T_VARIABLE","$rowData",733],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_customer_group'",733],"]",["T_WHITESPACE"," ",733],["T_IS_NOT_EQUAL","!=",733],["T_WHITESPACE"," ",733],["T_STRING","self",733],["T_DOUBLE_COLON","::",733],["T_STRING","VALUE_ALL",733],["T_WHITESPACE","\n                    ",733],["T_BOOLEAN_AND","&&",734],["T_WHITESPACE"," ",734],"!",["T_ISSET","isset",734],"(",["T_VARIABLE","$this",734],["T_OBJECT_OPERATOR","->",734],["T_STRING","_customerGroups",734],"[",["T_VARIABLE","$rowData",734],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_customer_group'",734],"]","]",")",")",["T_WHITESPACE"," ",734],"{",["T_WHITESPACE","\n                ",734],["T_VARIABLE","$this",735],["T_OBJECT_OPERATOR","->",735],["T_STRING","addRowError",735],"(",["T_STRING","self",735],["T_DOUBLE_COLON","::",735],["T_STRING","ERROR_INVALID_TIER_PRICE_GROUP",735],",",["T_WHITESPACE"," ",735],["T_VARIABLE","$rowNum",735],")",";",["T_WHITESPACE","\n                ",735],["T_RETURN","return",736],["T_WHITESPACE"," ",736],["T_STRING","false",736],";",["T_WHITESPACE","\n            ",736],"}",["T_WHITESPACE"," ",737],["T_ELSEIF","elseif",737],["T_WHITESPACE"," ",737],"(",["T_VARIABLE","$rowData",737],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_qty'",737],"]",["T_WHITESPACE"," ",737],["T_IS_SMALLER_OR_EQUAL","<=",737],["T_WHITESPACE"," ",737],["T_LNUMBER","0",737],["T_WHITESPACE"," ",737],["T_BOOLEAN_OR","||",737],["T_WHITESPACE"," ",737],["T_VARIABLE","$rowData",737],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_price'",737],"]",["T_WHITESPACE"," ",737],["T_IS_SMALLER_OR_EQUAL","<=",737],["T_WHITESPACE"," ",737],["T_LNUMBER","0",737],")",["T_WHITESPACE"," ",737],"{",["T_WHITESPACE","\n                ",737],["T_VARIABLE","$this",738],["T_OBJECT_OPERATOR","->",738],["T_STRING","addRowError",738],"(",["T_STRING","self",738],["T_DOUBLE_COLON","::",738],["T_STRING","ERROR_INVALID_TIER_PRICE_QTY",738],",",["T_WHITESPACE"," ",738],["T_VARIABLE","$rowNum",738],")",";",["T_WHITESPACE","\n                ",738],["T_RETURN","return",739],["T_WHITESPACE"," ",739],["T_STRING","false",739],";",["T_WHITESPACE","\n            ",739],"}",["T_WHITESPACE","\n        ",740],"}",["T_WHITESPACE","\n        ",741],["T_RETURN","return",742],["T_WHITESPACE"," ",742],["T_STRING","true",742],";",["T_WHITESPACE","\n    ",742],"}",["T_WHITESPACE","\n\n    ",743],["T_DOC_COMMENT","\/**\n     * Check group price data validity.\n     *\n     * @param array $rowData\n     * @param int $rowNum\n     * @return bool\n     *\/",745],["T_WHITESPACE","\n    ",751],["T_PROTECTED","protected",752],["T_WHITESPACE"," ",752],["T_FUNCTION","function",752],["T_WHITESPACE"," ",752],["T_STRING","_isGroupPriceValid",752],"(",["T_ARRAY","array",752],["T_WHITESPACE"," ",752],["T_VARIABLE","$rowData",752],",",["T_WHITESPACE"," ",752],["T_VARIABLE","$rowNum",752],")",["T_WHITESPACE","\n    ",752],"{",["T_WHITESPACE","\n        ",753],["T_IF","if",754],["T_WHITESPACE"," ",754],"(","(",["T_ISSET","isset",754],"(",["T_VARIABLE","$rowData",754],"[",["T_CONSTANT_ENCAPSED_STRING","'_group_price_website'",754],"]",")",["T_WHITESPACE"," ",754],["T_BOOLEAN_AND","&&",754],["T_WHITESPACE"," ",754],["T_STRING","strlen",754],"(",["T_VARIABLE","$rowData",754],"[",["T_CONSTANT_ENCAPSED_STRING","'_group_price_website'",754],"]",")",")",["T_WHITESPACE","\n            ",754],["T_BOOLEAN_OR","||",755],["T_WHITESPACE"," ",755],"(",["T_ISSET","isset",755],"(",["T_VARIABLE","$rowData",755],"[",["T_CONSTANT_ENCAPSED_STRING","'_group_price_customer_group'",755],"]",")",["T_WHITESPACE"," ",755],["T_BOOLEAN_AND","&&",755],["T_WHITESPACE"," ",755],["T_STRING","strlen",755],"(",["T_VARIABLE","$rowData",755],"[",["T_CONSTANT_ENCAPSED_STRING","'_group_price_customer_group'",755],"]",")",")",["T_WHITESPACE","\n            ",755],["T_BOOLEAN_OR","||",756],["T_WHITESPACE"," ",756],"(",["T_ISSET","isset",756],"(",["T_VARIABLE","$rowData",756],"[",["T_CONSTANT_ENCAPSED_STRING","'_group_price_price'",756],"]",")",["T_WHITESPACE"," ",756],["T_BOOLEAN_AND","&&",756],["T_WHITESPACE"," ",756],["T_STRING","strlen",756],"(",["T_VARIABLE","$rowData",756],"[",["T_CONSTANT_ENCAPSED_STRING","'_group_price_price'",756],"]",")",")",["T_WHITESPACE","\n        ",756],")",["T_WHITESPACE"," ",757],"{",["T_WHITESPACE","\n            ",757],["T_IF","if",758],["T_WHITESPACE"," ",758],"(","!",["T_ISSET","isset",758],"(",["T_VARIABLE","$rowData",758],"[",["T_CONSTANT_ENCAPSED_STRING","'_group_price_website'",758],"]",")",["T_WHITESPACE"," ",758],["T_BOOLEAN_OR","||",758],["T_WHITESPACE"," ",758],"!",["T_ISSET","isset",758],"(",["T_VARIABLE","$rowData",758],"[",["T_CONSTANT_ENCAPSED_STRING","'_group_price_customer_group'",758],"]",")",["T_WHITESPACE","\n                ",758],["T_BOOLEAN_OR","||",759],["T_WHITESPACE"," ",759],"!",["T_STRING","strlen",759],"(",["T_VARIABLE","$rowData",759],"[",["T_CONSTANT_ENCAPSED_STRING","'_group_price_website'",759],"]",")",["T_WHITESPACE"," ",759],["T_BOOLEAN_OR","||",759],["T_WHITESPACE"," ",759],"!",["T_STRING","strlen",759],"(",["T_VARIABLE","$rowData",759],"[",["T_CONSTANT_ENCAPSED_STRING","'_group_price_customer_group'",759],"]",")",["T_WHITESPACE","\n                ",759],["T_BOOLEAN_OR","||",760],["T_WHITESPACE"," ",760],"!",["T_STRING","strlen",760],"(",["T_VARIABLE","$rowData",760],"[",["T_CONSTANT_ENCAPSED_STRING","'_group_price_price'",760],"]",")",["T_WHITESPACE","\n            ",760],")",["T_WHITESPACE"," ",761],"{",["T_WHITESPACE","\n                ",761],["T_VARIABLE","$this",762],["T_OBJECT_OPERATOR","->",762],["T_STRING","addRowError",762],"(",["T_STRING","self",762],["T_DOUBLE_COLON","::",762],["T_STRING","ERROR_GROUP_PRICE_DATA_INCOMPLETE",762],",",["T_WHITESPACE"," ",762],["T_VARIABLE","$rowNum",762],")",";",["T_WHITESPACE","\n                ",762],["T_RETURN","return",763],["T_WHITESPACE"," ",763],["T_STRING","false",763],";",["T_WHITESPACE","\n            ",763],"}",["T_WHITESPACE"," ",764],["T_ELSEIF","elseif",764],["T_WHITESPACE"," ",764],"(",["T_VARIABLE","$rowData",764],"[",["T_CONSTANT_ENCAPSED_STRING","'_group_price_website'",764],"]",["T_WHITESPACE"," ",764],["T_IS_NOT_EQUAL","!=",764],["T_WHITESPACE"," ",764],["T_STRING","self",764],["T_DOUBLE_COLON","::",764],["T_STRING","VALUE_ALL",764],["T_WHITESPACE","\n                ",764],["T_BOOLEAN_AND","&&",765],["T_WHITESPACE"," ",765],"!",["T_ISSET","isset",765],"(",["T_VARIABLE","$this",765],["T_OBJECT_OPERATOR","->",765],["T_STRING","_websiteCodeToId",765],"[",["T_VARIABLE","$rowData",765],"[",["T_CONSTANT_ENCAPSED_STRING","'_group_price_website'",765],"]","]",")",["T_WHITESPACE","\n            ",765],")",["T_WHITESPACE"," ",766],"{",["T_WHITESPACE","\n                ",766],["T_VARIABLE","$this",767],["T_OBJECT_OPERATOR","->",767],["T_STRING","addRowError",767],"(",["T_STRING","self",767],["T_DOUBLE_COLON","::",767],["T_STRING","ERROR_INVALID_GROUP_PRICE_SITE",767],",",["T_WHITESPACE"," ",767],["T_VARIABLE","$rowNum",767],")",";",["T_WHITESPACE","\n                ",767],["T_RETURN","return",768],["T_WHITESPACE"," ",768],["T_STRING","false",768],";",["T_WHITESPACE","\n            ",768],"}",["T_WHITESPACE"," ",769],["T_ELSEIF","elseif",769],["T_WHITESPACE"," ",769],"(",["T_VARIABLE","$rowData",769],"[",["T_CONSTANT_ENCAPSED_STRING","'_group_price_customer_group'",769],"]",["T_WHITESPACE"," ",769],["T_IS_NOT_EQUAL","!=",769],["T_WHITESPACE"," ",769],["T_STRING","self",769],["T_DOUBLE_COLON","::",769],["T_STRING","VALUE_ALL",769],["T_WHITESPACE","\n                ",769],["T_BOOLEAN_AND","&&",770],["T_WHITESPACE"," ",770],"!",["T_ISSET","isset",770],"(",["T_VARIABLE","$this",770],["T_OBJECT_OPERATOR","->",770],["T_STRING","_customerGroups",770],"[",["T_VARIABLE","$rowData",770],"[",["T_CONSTANT_ENCAPSED_STRING","'_group_price_customer_group'",770],"]","]",")",["T_WHITESPACE","\n            ",770],")",["T_WHITESPACE"," ",771],"{",["T_WHITESPACE","\n                ",771],["T_VARIABLE","$this",772],["T_OBJECT_OPERATOR","->",772],["T_STRING","addRowError",772],"(",["T_STRING","self",772],["T_DOUBLE_COLON","::",772],["T_STRING","ERROR_INVALID_GROUP_PRICE_GROUP",772],",",["T_WHITESPACE"," ",772],["T_VARIABLE","$rowNum",772],")",";",["T_WHITESPACE","\n                ",772],["T_RETURN","return",773],["T_WHITESPACE"," ",773],["T_STRING","false",773],";",["T_WHITESPACE","\n            ",773],"}",["T_WHITESPACE","\n        ",774],"}",["T_WHITESPACE","\n        ",775],["T_RETURN","return",776],["T_WHITESPACE"," ",776],["T_STRING","true",776],";",["T_WHITESPACE","\n    ",776],"}",["T_WHITESPACE","\n\n    ",777],["T_DOC_COMMENT","\/**\n     * Check super products SKU\n     *\n     * @param array $rowData\n     * @param int $rowNum\n     * @return bool\n     *\/",779],["T_WHITESPACE","\n    ",785],["T_PROTECTED","protected",786],["T_WHITESPACE"," ",786],["T_FUNCTION","function",786],["T_WHITESPACE"," ",786],["T_STRING","_isSuperProductsSkuValid",786],"(",["T_VARIABLE","$rowData",786],",",["T_WHITESPACE"," ",786],["T_VARIABLE","$rowNum",786],")",["T_WHITESPACE","\n    ",786],"{",["T_WHITESPACE","\n        ",787],["T_IF","if",788],["T_WHITESPACE"," ",788],"(","!",["T_EMPTY","empty",788],"(",["T_VARIABLE","$rowData",788],"[",["T_CONSTANT_ENCAPSED_STRING","'_super_products_sku'",788],"]",")",["T_WHITESPACE","\n            ",788],["T_BOOLEAN_AND","&&",789],["T_WHITESPACE"," ",789],"(","!",["T_ISSET","isset",789],"(",["T_VARIABLE","$this",789],["T_OBJECT_OPERATOR","->",789],["T_STRING","_oldSku",789],"[",["T_VARIABLE","$rowData",789],"[",["T_CONSTANT_ENCAPSED_STRING","'_super_products_sku'",789],"]","]",")",["T_WHITESPACE","\n                ",789],["T_BOOLEAN_AND","&&",790],["T_WHITESPACE"," ",790],"!",["T_ISSET","isset",790],"(",["T_VARIABLE","$this",790],["T_OBJECT_OPERATOR","->",790],["T_STRING","_newSku",790],"[",["T_VARIABLE","$rowData",790],"[",["T_CONSTANT_ENCAPSED_STRING","'_super_products_sku'",790],"]","]",")",["T_WHITESPACE","\n            ",790],")",["T_WHITESPACE","\n        ",791],")",["T_WHITESPACE"," ",792],"{",["T_WHITESPACE","\n            ",792],["T_VARIABLE","$this",793],["T_OBJECT_OPERATOR","->",793],["T_STRING","addRowError",793],"(",["T_STRING","self",793],["T_DOUBLE_COLON","::",793],["T_STRING","ERROR_SUPER_PRODUCTS_SKU_NOT_FOUND",793],",",["T_WHITESPACE"," ",793],["T_VARIABLE","$rowNum",793],")",";",["T_WHITESPACE","\n            ",793],["T_RETURN","return",794],["T_WHITESPACE"," ",794],["T_STRING","false",794],";",["T_WHITESPACE","\n        ",794],"}",["T_WHITESPACE","\n        ",795],["T_RETURN","return",796],["T_WHITESPACE"," ",796],["T_STRING","true",796],";",["T_WHITESPACE","\n    ",796],"}",["T_WHITESPACE","\n\n    ",797],["T_DOC_COMMENT","\/**\n     * Custom options save.\n     *\n     * @return Mage_ImportExport_Model_Import_Entity_Product\n     *\/",799],["T_WHITESPACE","\n    ",803],["T_PROTECTED","protected",804],["T_WHITESPACE"," ",804],["T_FUNCTION","function",804],["T_WHITESPACE"," ",804],["T_STRING","_saveCustomOptions",804],"(",")",["T_WHITESPACE","\n    ",804],"{",["T_WHITESPACE","\n        ",805],["T_DOC_COMMENT","\/** @var $coreResource Mage_Core_Model_Resource *\/",806],["T_WHITESPACE","\n        ",806],["T_VARIABLE","$coreResource",807],["T_WHITESPACE","   ",807],"=",["T_WHITESPACE"," ",807],["T_STRING","Mage",807],["T_DOUBLE_COLON","::",807],["T_STRING","getSingleton",807],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/resource'",807],")",";",["T_WHITESPACE","\n        ",807],["T_VARIABLE","$productTable",808],["T_WHITESPACE","   ",808],"=",["T_WHITESPACE"," ",808],["T_VARIABLE","$coreResource",808],["T_OBJECT_OPERATOR","->",808],["T_STRING","getTableName",808],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",808],")",";",["T_WHITESPACE","\n        ",808],["T_VARIABLE","$optionTable",809],["T_WHITESPACE","    ",809],"=",["T_WHITESPACE"," ",809],["T_VARIABLE","$coreResource",809],["T_OBJECT_OPERATOR","->",809],["T_STRING","getTableName",809],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_option'",809],")",";",["T_WHITESPACE","\n        ",809],["T_VARIABLE","$priceTable",810],["T_WHITESPACE","     ",810],"=",["T_WHITESPACE"," ",810],["T_VARIABLE","$coreResource",810],["T_OBJECT_OPERATOR","->",810],["T_STRING","getTableName",810],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_option_price'",810],")",";",["T_WHITESPACE","\n        ",810],["T_VARIABLE","$titleTable",811],["T_WHITESPACE","     ",811],"=",["T_WHITESPACE"," ",811],["T_VARIABLE","$coreResource",811],["T_OBJECT_OPERATOR","->",811],["T_STRING","getTableName",811],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_option_title'",811],")",";",["T_WHITESPACE","\n        ",811],["T_VARIABLE","$typePriceTable",812],["T_WHITESPACE"," ",812],"=",["T_WHITESPACE"," ",812],["T_VARIABLE","$coreResource",812],["T_OBJECT_OPERATOR","->",812],["T_STRING","getTableName",812],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_option_type_price'",812],")",";",["T_WHITESPACE","\n        ",812],["T_VARIABLE","$typeTitleTable",813],["T_WHITESPACE"," ",813],"=",["T_WHITESPACE"," ",813],["T_VARIABLE","$coreResource",813],["T_OBJECT_OPERATOR","->",813],["T_STRING","getTableName",813],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_option_type_title'",813],")",";",["T_WHITESPACE","\n        ",813],["T_VARIABLE","$typeValueTable",814],["T_WHITESPACE"," ",814],"=",["T_WHITESPACE"," ",814],["T_VARIABLE","$coreResource",814],["T_OBJECT_OPERATOR","->",814],["T_STRING","getTableName",814],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_option_type_value'",814],")",";",["T_WHITESPACE","\n        ",814],["T_VARIABLE","$nextOptionId",815],["T_WHITESPACE","   ",815],"=",["T_WHITESPACE"," ",815],["T_STRING","Mage",815],["T_DOUBLE_COLON","::",815],["T_STRING","getResourceHelper",815],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",815],")",["T_OBJECT_OPERATOR","->",815],["T_STRING","getNextAutoincrement",815],"(",["T_VARIABLE","$optionTable",815],")",";",["T_WHITESPACE","\n        ",815],["T_VARIABLE","$nextValueId",816],["T_WHITESPACE","    ",816],"=",["T_WHITESPACE"," ",816],["T_STRING","Mage",816],["T_DOUBLE_COLON","::",816],["T_STRING","getResourceHelper",816],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",816],")",["T_OBJECT_OPERATOR","->",816],["T_STRING","getNextAutoincrement",816],"(",["T_VARIABLE","$typeValueTable",816],")",";",["T_WHITESPACE","\n        ",816],["T_VARIABLE","$priceIsGlobal",817],["T_WHITESPACE","  ",817],"=",["T_WHITESPACE"," ",817],["T_STRING","Mage",817],["T_DOUBLE_COLON","::",817],["T_STRING","helper",817],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",817],")",["T_OBJECT_OPERATOR","->",817],["T_STRING","isPriceGlobal",817],"(",")",";",["T_WHITESPACE","\n        ",817],["T_VARIABLE","$type",818],["T_WHITESPACE","           ",818],"=",["T_WHITESPACE"," ",818],["T_STRING","null",818],";",["T_WHITESPACE","\n        ",818],["T_VARIABLE","$typeSpecific",819],["T_WHITESPACE","   ",819],"=",["T_WHITESPACE"," ",819],["T_ARRAY","array",819],"(",["T_WHITESPACE","\n            ",819],["T_CONSTANT_ENCAPSED_STRING","'date'",820],["T_WHITESPACE","      ",820],["T_DOUBLE_ARROW","=>",820],["T_WHITESPACE"," ",820],["T_ARRAY","array",820],"(",["T_CONSTANT_ENCAPSED_STRING","'price'",820],",",["T_WHITESPACE"," ",820],["T_CONSTANT_ENCAPSED_STRING","'sku'",820],")",",",["T_WHITESPACE","\n            ",820],["T_CONSTANT_ENCAPSED_STRING","'date_time'",821],["T_WHITESPACE"," ",821],["T_DOUBLE_ARROW","=>",821],["T_WHITESPACE"," ",821],["T_ARRAY","array",821],"(",["T_CONSTANT_ENCAPSED_STRING","'price'",821],",",["T_WHITESPACE"," ",821],["T_CONSTANT_ENCAPSED_STRING","'sku'",821],")",",",["T_WHITESPACE","\n            ",821],["T_CONSTANT_ENCAPSED_STRING","'time'",822],["T_WHITESPACE","      ",822],["T_DOUBLE_ARROW","=>",822],["T_WHITESPACE"," ",822],["T_ARRAY","array",822],"(",["T_CONSTANT_ENCAPSED_STRING","'price'",822],",",["T_WHITESPACE"," ",822],["T_CONSTANT_ENCAPSED_STRING","'sku'",822],")",",",["T_WHITESPACE","\n            ",822],["T_CONSTANT_ENCAPSED_STRING","'field'",823],["T_WHITESPACE","     ",823],["T_DOUBLE_ARROW","=>",823],["T_WHITESPACE"," ",823],["T_ARRAY","array",823],"(",["T_CONSTANT_ENCAPSED_STRING","'price'",823],",",["T_WHITESPACE"," ",823],["T_CONSTANT_ENCAPSED_STRING","'sku'",823],",",["T_WHITESPACE"," ",823],["T_CONSTANT_ENCAPSED_STRING","'max_characters'",823],")",",",["T_WHITESPACE","\n            ",823],["T_CONSTANT_ENCAPSED_STRING","'area'",824],["T_WHITESPACE","      ",824],["T_DOUBLE_ARROW","=>",824],["T_WHITESPACE"," ",824],["T_ARRAY","array",824],"(",["T_CONSTANT_ENCAPSED_STRING","'price'",824],",",["T_WHITESPACE"," ",824],["T_CONSTANT_ENCAPSED_STRING","'sku'",824],",",["T_WHITESPACE"," ",824],["T_CONSTANT_ENCAPSED_STRING","'max_characters'",824],")",",",["T_WHITESPACE","\n            ",824],["T_COMMENT","\/\/'file'      => array('price', 'sku', 'file_extension', 'image_size_x', 'image_size_y'),\n",825],["T_WHITESPACE","            ",826],["T_CONSTANT_ENCAPSED_STRING","'drop_down'",826],["T_WHITESPACE"," ",826],["T_DOUBLE_ARROW","=>",826],["T_WHITESPACE"," ",826],["T_STRING","true",826],",",["T_WHITESPACE","\n            ",826],["T_CONSTANT_ENCAPSED_STRING","'radio'",827],["T_WHITESPACE","     ",827],["T_DOUBLE_ARROW","=>",827],["T_WHITESPACE"," ",827],["T_STRING","true",827],",",["T_WHITESPACE","\n            ",827],["T_CONSTANT_ENCAPSED_STRING","'checkbox'",828],["T_WHITESPACE","  ",828],["T_DOUBLE_ARROW","=>",828],["T_WHITESPACE"," ",828],["T_STRING","true",828],",",["T_WHITESPACE","\n            ",828],["T_CONSTANT_ENCAPSED_STRING","'multiple'",829],["T_WHITESPACE","  ",829],["T_DOUBLE_ARROW","=>",829],["T_WHITESPACE"," ",829],["T_STRING","true",829],["T_WHITESPACE","\n        ",829],")",";",["T_WHITESPACE","\n\n        ",830],["T_VARIABLE","$alreadyUsedProductIds",832],["T_WHITESPACE"," ",832],"=",["T_WHITESPACE"," ",832],["T_ARRAY","array",832],"(",")",";",["T_WHITESPACE","\n        ",832],["T_VARIABLE","$lastStoreId",833],["T_WHITESPACE","           ",833],"=",["T_WHITESPACE"," ",833],["T_STRING","null",833],";",["T_WHITESPACE","\n        ",833],["T_VARIABLE","$lastProductId",834],["T_WHITESPACE","         ",834],"=",["T_WHITESPACE"," ",834],["T_STRING","null",834],";",["T_WHITESPACE","\n        ",834],["T_VARIABLE","$currentValueId",835],["T_WHITESPACE","        ",835],"=",["T_WHITESPACE"," ",835],["T_STRING","null",835],";",["T_WHITESPACE","\n        ",835],["T_WHILE","while",836],["T_WHITESPACE"," ",836],"(",["T_VARIABLE","$bunch",836],["T_WHITESPACE"," ",836],"=",["T_WHITESPACE"," ",836],["T_VARIABLE","$this",836],["T_OBJECT_OPERATOR","->",836],["T_STRING","_dataSourceModel",836],["T_OBJECT_OPERATOR","->",836],["T_STRING","getNextBunch",836],"(",")",")",["T_WHITESPACE"," ",836],"{",["T_WHITESPACE","\n            ",836],["T_VARIABLE","$customOptions",837],["T_WHITESPACE"," ",837],"=",["T_WHITESPACE"," ",837],["T_ARRAY","array",837],"(",["T_WHITESPACE","\n                ",837],["T_CONSTANT_ENCAPSED_STRING","'product_id'",838],["T_WHITESPACE","    ",838],["T_DOUBLE_ARROW","=>",838],["T_WHITESPACE"," ",838],["T_ARRAY","array",838],"(",")",",",["T_WHITESPACE","\n                ",838],["T_VARIABLE","$optionTable",839],["T_WHITESPACE","    ",839],["T_DOUBLE_ARROW","=>",839],["T_WHITESPACE"," ",839],["T_ARRAY","array",839],"(",")",",",["T_WHITESPACE","\n                ",839],["T_VARIABLE","$priceTable",840],["T_WHITESPACE","     ",840],["T_DOUBLE_ARROW","=>",840],["T_WHITESPACE"," ",840],["T_ARRAY","array",840],"(",")",",",["T_WHITESPACE","\n                ",840],["T_VARIABLE","$titleTable",841],["T_WHITESPACE","     ",841],["T_DOUBLE_ARROW","=>",841],["T_WHITESPACE"," ",841],["T_ARRAY","array",841],"(",")",",",["T_WHITESPACE","\n                ",841],["T_VARIABLE","$typePriceTable",842],["T_WHITESPACE"," ",842],["T_DOUBLE_ARROW","=>",842],["T_WHITESPACE"," ",842],["T_ARRAY","array",842],"(",")",",",["T_WHITESPACE","\n                ",842],["T_VARIABLE","$typeTitleTable",843],["T_WHITESPACE"," ",843],["T_DOUBLE_ARROW","=>",843],["T_WHITESPACE"," ",843],["T_ARRAY","array",843],"(",")",",",["T_WHITESPACE","\n                ",843],["T_VARIABLE","$typeValueTable",844],["T_WHITESPACE"," ",844],["T_DOUBLE_ARROW","=>",844],["T_WHITESPACE"," ",844],["T_ARRAY","array",844],"(",")",["T_WHITESPACE","\n            ",844],")",";",["T_WHITESPACE","\n            ",845],["T_VARIABLE","$flagNewOption",846],["T_WHITESPACE","  ",846],"=",["T_WHITESPACE"," ",846],["T_STRING","true",846],";",["T_WHITESPACE","\n            ",846],["T_VARIABLE","$firstKeyOption",847],["T_WHITESPACE"," ",847],"=",["T_WHITESPACE"," ",847],["T_STRING","null",847],";",["T_WHITESPACE","\n            ",847],["T_FOREACH","foreach",848],["T_WHITESPACE"," ",848],"(",["T_VARIABLE","$bunch",848],["T_WHITESPACE"," ",848],["T_AS","as",848],["T_WHITESPACE"," ",848],["T_VARIABLE","$rowNum",848],["T_WHITESPACE"," ",848],["T_DOUBLE_ARROW","=>",848],["T_WHITESPACE"," ",848],["T_VARIABLE","$rowData",848],")",["T_WHITESPACE"," ",848],"{",["T_WHITESPACE","\n                ",848],["T_VARIABLE","$this",849],["T_OBJECT_OPERATOR","->",849],["T_STRING","_filterRowData",849],"(",["T_VARIABLE","$rowData",849],")",";",["T_WHITESPACE","\n                ",849],["T_IF","if",850],["T_WHITESPACE"," ",850],"(","!",["T_VARIABLE","$this",850],["T_OBJECT_OPERATOR","->",850],["T_STRING","isRowAllowedToImport",850],"(",["T_VARIABLE","$rowData",850],",",["T_WHITESPACE"," ",850],["T_VARIABLE","$rowNum",850],")",")",["T_WHITESPACE"," ",850],"{",["T_WHITESPACE","\n                    ",850],["T_CONTINUE","continue",851],";",["T_WHITESPACE","\n                ",851],"}",["T_WHITESPACE","\n                ",852],["T_IF","if",853],["T_WHITESPACE"," ",853],"(",["T_STRING","self",853],["T_DOUBLE_COLON","::",853],["T_STRING","SCOPE_DEFAULT",853],["T_WHITESPACE"," ",853],["T_IS_EQUAL","==",853],["T_WHITESPACE"," ",853],["T_VARIABLE","$this",853],["T_OBJECT_OPERATOR","->",853],["T_STRING","getRowScope",853],"(",["T_VARIABLE","$rowData",853],")",")",["T_WHITESPACE"," ",853],"{",["T_WHITESPACE","\n                    ",853],["T_VARIABLE","$productId",854],["T_WHITESPACE"," ",854],"=",["T_WHITESPACE"," ",854],["T_VARIABLE","$this",854],["T_OBJECT_OPERATOR","->",854],["T_STRING","_newSku",854],"[",["T_VARIABLE","$rowData",854],"[",["T_STRING","self",854],["T_DOUBLE_COLON","::",854],["T_STRING","COL_SKU",854],"]","]","[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",854],"]",";",["T_WHITESPACE","\n                ",854],"}",["T_WHITESPACE"," ",855],["T_ELSEIF","elseif",855],["T_WHITESPACE"," ",855],"(","!",["T_ISSET","isset",855],"(",["T_VARIABLE","$productId",855],")",")",["T_WHITESPACE"," ",855],"{",["T_WHITESPACE","\n                    ",855],["T_CONTINUE","continue",856],";",["T_WHITESPACE","\n                ",856],"}",["T_WHITESPACE","\n\n                ",857],["T_IF","if",859],["T_WHITESPACE"," ",859],"(",["T_VARIABLE","$lastProductId",859],["T_WHITESPACE"," ",859],["T_IS_NOT_EQUAL","!=",859],["T_WHITESPACE"," ",859],["T_VARIABLE","$productId",859],")",["T_WHITESPACE"," ",859],"{",["T_WHITESPACE","\n                    ",859],["T_VARIABLE","$lastStoreId",860],["T_WHITESPACE","    ",860],"=",["T_WHITESPACE"," ",860],["T_STRING","Mage_Catalog_Model_Abstract",860],["T_DOUBLE_COLON","::",860],["T_STRING","DEFAULT_STORE_ID",860],";",["T_WHITESPACE","\n                    ",860],["T_VARIABLE","$currentValueId",861],["T_WHITESPACE"," ",861],"=",["T_WHITESPACE"," ",861],["T_STRING","null",861],";",["T_WHITESPACE","\n                    ",861],["T_VARIABLE","$lastProductId",862],["T_WHITESPACE","  ",862],"=",["T_WHITESPACE"," ",862],["T_VARIABLE","$productId",862],";",["T_WHITESPACE","\n                ",862],"}",["T_WHITESPACE","\n\n                ",863],["T_IF","if",865],["T_WHITESPACE"," ",865],"(","!",["T_EMPTY","empty",865],"(",["T_VARIABLE","$rowData",865],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_store'",865],"]",")",")",["T_WHITESPACE"," ",865],"{",["T_WHITESPACE","\n                    ",865],["T_IF","if",866],["T_WHITESPACE"," ",866],"(","!",["T_ISSET","isset",866],"(",["T_VARIABLE","$this",866],["T_OBJECT_OPERATOR","->",866],["T_STRING","_storeCodeToId",866],"[",["T_VARIABLE","$rowData",866],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_store'",866],"]","]",")",")",["T_WHITESPACE"," ",866],"{",["T_WHITESPACE","\n                        ",866],["T_CONTINUE","continue",867],";",["T_WHITESPACE","\n                    ",867],"}",["T_WHITESPACE","\n                    ",868],["T_VARIABLE","$storeId",869],["T_WHITESPACE"," ",869],"=",["T_WHITESPACE"," ",869],["T_VARIABLE","$this",869],["T_OBJECT_OPERATOR","->",869],["T_STRING","_storeCodeToId",869],"[",["T_VARIABLE","$rowData",869],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_store'",869],"]","]",";",["T_WHITESPACE","\n                ",869],"}",["T_WHITESPACE"," ",870],["T_ELSE","else",870],["T_WHITESPACE"," ",870],"{",["T_WHITESPACE","\n                    ",870],["T_VARIABLE","$storeId",871],["T_WHITESPACE"," ",871],"=",["T_WHITESPACE"," ",871],["T_STRING","Mage_Catalog_Model_Abstract",871],["T_DOUBLE_COLON","::",871],["T_STRING","DEFAULT_STORE_ID",871],";",["T_WHITESPACE","\n                ",871],"}",["T_WHITESPACE","\n                ",872],["T_IF","if",873],["T_WHITESPACE"," ",873],"(","!",["T_EMPTY","empty",873],"(",["T_VARIABLE","$rowData",873],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_type'",873],"]",")",")",["T_WHITESPACE"," ",873],"{",["T_WHITESPACE"," ",873],["T_COMMENT","\/\/ get CO type if its specified\n",873],["T_WHITESPACE","                    ",874],["T_IF","if",874],["T_WHITESPACE"," ",874],"(","!",["T_ISSET","isset",874],"(",["T_VARIABLE","$typeSpecific",874],"[",["T_VARIABLE","$rowData",874],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_type'",874],"]","]",")",")",["T_WHITESPACE"," ",874],"{",["T_WHITESPACE","\n                        ",874],["T_VARIABLE","$type",875],["T_WHITESPACE"," ",875],"=",["T_WHITESPACE"," ",875],["T_STRING","null",875],";",["T_WHITESPACE","\n                        ",875],["T_CONTINUE","continue",876],";",["T_WHITESPACE","\n                    ",876],"}",["T_WHITESPACE","\n                    ",877],["T_VARIABLE","$type",878],["T_WHITESPACE"," ",878],"=",["T_WHITESPACE"," ",878],["T_VARIABLE","$rowData",878],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_type'",878],"]",";",["T_WHITESPACE","\n                    ",878],["T_VARIABLE","$rowIsMain",879],["T_WHITESPACE"," ",879],"=",["T_WHITESPACE"," ",879],["T_STRING","true",879],";",["T_WHITESPACE","\n                ",879],"}",["T_WHITESPACE"," ",880],["T_ELSE","else",880],["T_WHITESPACE"," ",880],"{",["T_WHITESPACE","\n                    ",880],["T_IF","if",881],["T_WHITESPACE"," ",881],"(",["T_STRING","null",881],["T_WHITESPACE"," ",881],["T_IS_IDENTICAL","===",881],["T_WHITESPACE"," ",881],["T_VARIABLE","$type",881],")",["T_WHITESPACE"," ",881],"{",["T_WHITESPACE","\n                        ",881],["T_CONTINUE","continue",882],";",["T_WHITESPACE","\n                    ",882],"}",["T_WHITESPACE","\n                    ",883],["T_VARIABLE","$rowIsMain",884],["T_WHITESPACE"," ",884],"=",["T_WHITESPACE"," ",884],["T_STRING","false",884],";",["T_WHITESPACE","\n                ",884],"}",["T_WHITESPACE","\n                ",885],["T_IF","if",886],["T_WHITESPACE"," ",886],"(","!",["T_ISSET","isset",886],"(",["T_VARIABLE","$customOptions",886],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",886],"]","[",["T_VARIABLE","$productId",886],"]",")",")",["T_WHITESPACE"," ",886],"{",["T_WHITESPACE"," ",886],["T_COMMENT","\/\/ for update product entity table\n",886],["T_WHITESPACE","                    ",887],["T_VARIABLE","$customOptions",887],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",887],"]","[",["T_VARIABLE","$productId",887],"]",["T_WHITESPACE"," ",887],"=",["T_WHITESPACE"," ",887],["T_ARRAY","array",887],"(",["T_WHITESPACE","\n                        ",887],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",888],["T_WHITESPACE","        ",888],["T_DOUBLE_ARROW","=>",888],["T_WHITESPACE"," ",888],["T_VARIABLE","$productId",888],",",["T_WHITESPACE","\n                        ",888],["T_CONSTANT_ENCAPSED_STRING","'has_options'",889],["T_WHITESPACE","      ",889],["T_DOUBLE_ARROW","=>",889],["T_WHITESPACE"," ",889],["T_LNUMBER","0",889],",",["T_WHITESPACE","\n                        ",889],["T_CONSTANT_ENCAPSED_STRING","'required_options'",890],["T_WHITESPACE"," ",890],["T_DOUBLE_ARROW","=>",890],["T_WHITESPACE"," ",890],["T_LNUMBER","0",890],",",["T_WHITESPACE","\n                        ",890],["T_CONSTANT_ENCAPSED_STRING","'updated_at'",891],["T_WHITESPACE","       ",891],["T_DOUBLE_ARROW","=>",891],["T_WHITESPACE"," ",891],["T_STRING","now",891],"(",")",["T_WHITESPACE","\n                    ",891],")",";",["T_WHITESPACE","\n                ",892],"}",["T_WHITESPACE","\n                ",893],["T_IF","if",894],["T_WHITESPACE"," ",894],"(",["T_VARIABLE","$rowIsMain",894],")",["T_WHITESPACE"," ",894],"{",["T_WHITESPACE","\n                    ",894],["T_VARIABLE","$solidParams",895],["T_WHITESPACE"," ",895],"=",["T_WHITESPACE"," ",895],["T_ARRAY","array",895],"(",["T_WHITESPACE","\n                        ",895],["T_CONSTANT_ENCAPSED_STRING","'option_id'",896],["T_WHITESPACE","      ",896],["T_DOUBLE_ARROW","=>",896],["T_WHITESPACE"," ",896],["T_VARIABLE","$nextOptionId",896],",",["T_WHITESPACE","\n                        ",896],["T_CONSTANT_ENCAPSED_STRING","'sku'",897],["T_WHITESPACE","            ",897],["T_DOUBLE_ARROW","=>",897],["T_WHITESPACE"," ",897],["T_CONSTANT_ENCAPSED_STRING","''",897],",",["T_WHITESPACE","\n                        ",897],["T_CONSTANT_ENCAPSED_STRING","'max_characters'",898],["T_WHITESPACE"," ",898],["T_DOUBLE_ARROW","=>",898],["T_WHITESPACE"," ",898],["T_LNUMBER","0",898],",",["T_WHITESPACE","\n                        ",898],["T_CONSTANT_ENCAPSED_STRING","'file_extension'",899],["T_WHITESPACE"," ",899],["T_DOUBLE_ARROW","=>",899],["T_WHITESPACE"," ",899],["T_STRING","null",899],",",["T_WHITESPACE","\n                        ",899],["T_CONSTANT_ENCAPSED_STRING","'image_size_x'",900],["T_WHITESPACE","   ",900],["T_DOUBLE_ARROW","=>",900],["T_WHITESPACE"," ",900],["T_LNUMBER","0",900],",",["T_WHITESPACE","\n                        ",900],["T_CONSTANT_ENCAPSED_STRING","'image_size_y'",901],["T_WHITESPACE","   ",901],["T_DOUBLE_ARROW","=>",901],["T_WHITESPACE"," ",901],["T_LNUMBER","0",901],",",["T_WHITESPACE","\n                        ",901],["T_CONSTANT_ENCAPSED_STRING","'product_id'",902],["T_WHITESPACE","     ",902],["T_DOUBLE_ARROW","=>",902],["T_WHITESPACE"," ",902],["T_VARIABLE","$productId",902],",",["T_WHITESPACE","\n                        ",902],["T_CONSTANT_ENCAPSED_STRING","'type'",903],["T_WHITESPACE","           ",903],["T_DOUBLE_ARROW","=>",903],["T_WHITESPACE"," ",903],["T_VARIABLE","$type",903],",",["T_WHITESPACE","\n                        ",903],["T_CONSTANT_ENCAPSED_STRING","'is_require'",904],["T_WHITESPACE","     ",904],["T_DOUBLE_ARROW","=>",904],["T_WHITESPACE"," ",904],["T_EMPTY","empty",904],"(",["T_VARIABLE","$rowData",904],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_is_required'",904],"]",")",["T_WHITESPACE"," ",904],"?",["T_WHITESPACE"," ",904],["T_LNUMBER","0",904],["T_WHITESPACE"," ",904],":",["T_WHITESPACE"," ",904],["T_LNUMBER","1",904],",",["T_WHITESPACE","\n                        ",904],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",905],["T_WHITESPACE","     ",905],["T_DOUBLE_ARROW","=>",905],["T_WHITESPACE"," ",905],["T_EMPTY","empty",905],"(",["T_VARIABLE","$rowData",905],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_sort_order'",905],"]",")",["T_WHITESPACE","\n                                            ",905],"?",["T_WHITESPACE"," ",906],["T_LNUMBER","0",906],["T_WHITESPACE"," ",906],":",["T_WHITESPACE"," ",906],["T_STRING","abs",906],"(",["T_VARIABLE","$rowData",906],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_sort_order'",906],"]",")",["T_WHITESPACE","\n                    ",906],")",";",["T_WHITESPACE","\n\n                    ",907],["T_IF","if",909],["T_WHITESPACE"," ",909],"(",["T_STRING","true",909],["T_WHITESPACE"," ",909],["T_IS_NOT_IDENTICAL","!==",909],["T_WHITESPACE"," ",909],["T_VARIABLE","$typeSpecific",909],"[",["T_VARIABLE","$type",909],"]",")",["T_WHITESPACE"," ",909],"{",["T_WHITESPACE"," ",909],["T_COMMENT","\/\/ simple option may have optional params\n",909],["T_WHITESPACE","                        ",910],["T_VARIABLE","$priceTableRow",910],["T_WHITESPACE"," ",910],"=",["T_WHITESPACE"," ",910],["T_ARRAY","array",910],"(",["T_WHITESPACE","\n                            ",910],["T_CONSTANT_ENCAPSED_STRING","'option_id'",911],["T_WHITESPACE","  ",911],["T_DOUBLE_ARROW","=>",911],["T_WHITESPACE"," ",911],["T_VARIABLE","$nextOptionId",911],",",["T_WHITESPACE","\n                            ",911],["T_CONSTANT_ENCAPSED_STRING","'store_id'",912],["T_WHITESPACE","   ",912],["T_DOUBLE_ARROW","=>",912],["T_WHITESPACE"," ",912],["T_STRING","Mage_Catalog_Model_Abstract",912],["T_DOUBLE_COLON","::",912],["T_STRING","DEFAULT_STORE_ID",912],",",["T_WHITESPACE","\n                            ",912],["T_CONSTANT_ENCAPSED_STRING","'price'",913],["T_WHITESPACE","      ",913],["T_DOUBLE_ARROW","=>",913],["T_WHITESPACE"," ",913],["T_LNUMBER","0",913],",",["T_WHITESPACE","\n                            ",913],["T_CONSTANT_ENCAPSED_STRING","'price_type'",914],["T_WHITESPACE"," ",914],["T_DOUBLE_ARROW","=>",914],["T_WHITESPACE"," ",914],["T_CONSTANT_ENCAPSED_STRING","'fixed'",914],["T_WHITESPACE","\n                        ",914],")",";",["T_WHITESPACE","\n\n                        ",915],["T_FOREACH","foreach",917],["T_WHITESPACE"," ",917],"(",["T_VARIABLE","$typeSpecific",917],"[",["T_VARIABLE","$type",917],"]",["T_WHITESPACE"," ",917],["T_AS","as",917],["T_WHITESPACE"," ",917],["T_VARIABLE","$paramSuffix",917],")",["T_WHITESPACE"," ",917],"{",["T_WHITESPACE","\n                            ",917],["T_IF","if",918],["T_WHITESPACE"," ",918],"(",["T_ISSET","isset",918],"(",["T_VARIABLE","$rowData",918],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_'",918],["T_WHITESPACE"," ",918],".",["T_WHITESPACE"," ",918],["T_VARIABLE","$paramSuffix",918],"]",")",")",["T_WHITESPACE"," ",918],"{",["T_WHITESPACE","\n                                ",918],["T_VARIABLE","$data",919],["T_WHITESPACE"," ",919],"=",["T_WHITESPACE"," ",919],["T_VARIABLE","$rowData",919],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_'",919],["T_WHITESPACE"," ",919],".",["T_WHITESPACE"," ",919],["T_VARIABLE","$paramSuffix",919],"]",";",["T_WHITESPACE","\n\n                                ",919],["T_IF","if",921],["T_WHITESPACE"," ",921],"(",["T_STRING","array_key_exists",921],"(",["T_VARIABLE","$paramSuffix",921],",",["T_WHITESPACE"," ",921],["T_VARIABLE","$solidParams",921],")",")",["T_WHITESPACE"," ",921],"{",["T_WHITESPACE","\n                                    ",921],["T_VARIABLE","$solidParams",922],"[",["T_VARIABLE","$paramSuffix",922],"]",["T_WHITESPACE"," ",922],"=",["T_WHITESPACE"," ",922],["T_VARIABLE","$data",922],";",["T_WHITESPACE","\n                                ",922],"}",["T_WHITESPACE"," ",923],["T_ELSEIF","elseif",923],["T_WHITESPACE"," ",923],"(",["T_CONSTANT_ENCAPSED_STRING","'price'",923],["T_WHITESPACE"," ",923],["T_IS_EQUAL","==",923],["T_WHITESPACE"," ",923],["T_VARIABLE","$paramSuffix",923],")",["T_WHITESPACE"," ",923],"{",["T_WHITESPACE","\n                                    ",923],["T_IF","if",924],["T_WHITESPACE"," ",924],"(",["T_CONSTANT_ENCAPSED_STRING","'%'",924],["T_WHITESPACE"," ",924],["T_IS_EQUAL","==",924],["T_WHITESPACE"," ",924],["T_STRING","substr",924],"(",["T_VARIABLE","$data",924],",",["T_WHITESPACE"," ",924],"-",["T_LNUMBER","1",924],")",")",["T_WHITESPACE"," ",924],"{",["T_WHITESPACE","\n                                        ",924],["T_VARIABLE","$priceTableRow",925],"[",["T_CONSTANT_ENCAPSED_STRING","'price_type'",925],"]",["T_WHITESPACE"," ",925],"=",["T_WHITESPACE"," ",925],["T_CONSTANT_ENCAPSED_STRING","'percent'",925],";",["T_WHITESPACE","\n                                    ",925],"}",["T_WHITESPACE","\n                                    ",926],["T_VARIABLE","$priceTableRow",927],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",927],"]",["T_WHITESPACE"," ",927],"=",["T_WHITESPACE"," ",927],["T_DOUBLE_CAST","(float)",927],["T_WHITESPACE"," ",927],["T_STRING","rtrim",927],"(",["T_VARIABLE","$data",927],",",["T_WHITESPACE"," ",927],["T_CONSTANT_ENCAPSED_STRING","'%'",927],")",";",["T_WHITESPACE","\n                                ",927],"}",["T_WHITESPACE","\n                            ",928],"}",["T_WHITESPACE","\n                        ",929],"}",["T_WHITESPACE","\n                        ",930],["T_VARIABLE","$customOptions",931],"[",["T_VARIABLE","$priceTable",931],"]","[","]",["T_WHITESPACE"," ",931],"=",["T_WHITESPACE"," ",931],["T_VARIABLE","$priceTableRow",931],";",["T_WHITESPACE","\n                    ",931],"}",["T_WHITESPACE","\n                    ",932],["T_VARIABLE","$customOptions",933],"[",["T_VARIABLE","$optionTable",933],"]","[","]",["T_WHITESPACE"," ",933],"=",["T_WHITESPACE"," ",933],["T_VARIABLE","$solidParams",933],";",["T_WHITESPACE","\n                    ",933],["T_VARIABLE","$customOptions",934],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",934],"]","[",["T_VARIABLE","$productId",934],"]","[",["T_CONSTANT_ENCAPSED_STRING","'has_options'",934],"]",["T_WHITESPACE"," ",934],"=",["T_WHITESPACE"," ",934],["T_LNUMBER","1",934],";",["T_WHITESPACE","\n\n                    ",934],["T_IF","if",936],["T_WHITESPACE"," ",936],"(","!",["T_EMPTY","empty",936],"(",["T_VARIABLE","$rowData",936],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_is_required'",936],"]",")",")",["T_WHITESPACE"," ",936],"{",["T_WHITESPACE","\n                        ",936],["T_VARIABLE","$customOptions",937],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",937],"]","[",["T_VARIABLE","$productId",937],"]","[",["T_CONSTANT_ENCAPSED_STRING","'required_options'",937],"]",["T_WHITESPACE"," ",937],"=",["T_WHITESPACE"," ",937],["T_LNUMBER","1",937],";",["T_WHITESPACE","\n                    ",937],"}",["T_WHITESPACE","\n                    ",938],["T_VARIABLE","$prevOptionId",939],["T_WHITESPACE"," ",939],"=",["T_WHITESPACE"," ",939],["T_VARIABLE","$nextOptionId",939],["T_INC","++",939],";",["T_WHITESPACE"," ",939],["T_COMMENT","\/\/ increment option id, but preserve value for $typeValueTable\n",939],["T_WHITESPACE","                ",940],"}",["T_WHITESPACE","\n\n                ",940],["T_IF","if",942],["T_WHITESPACE"," ",942],"(",["T_VARIABLE","$typeSpecific",942],"[",["T_VARIABLE","$type",942],"]",["T_WHITESPACE"," ",942],["T_IS_IDENTICAL","===",942],["T_WHITESPACE"," ",942],["T_STRING","true",942],["T_WHITESPACE"," ",942],["T_BOOLEAN_AND","&&",942],["T_WHITESPACE"," ",942],"!",["T_EMPTY","empty",942],"(",["T_VARIABLE","$rowData",942],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_row_title'",942],"]",")",")",["T_WHITESPACE"," ",942],"{",["T_WHITESPACE","\n                    ",942],["T_IF","if",943],["T_WHITESPACE"," ",943],"(",["T_EMPTY","empty",943],"(",["T_VARIABLE","$rowData",943],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_store'",943],"]",")",")",["T_WHITESPACE"," ",943],"{",["T_WHITESPACE","\n                        ",943],["T_COMMENT","\/\/ complex CO option row\n",944],["T_WHITESPACE","                        ",945],["T_VARIABLE","$customOptions",945],"[",["T_VARIABLE","$typeValueTable",945],"]","[",["T_VARIABLE","$prevOptionId",945],"]","[","]",["T_WHITESPACE"," ",945],"=",["T_WHITESPACE"," ",945],["T_ARRAY","array",945],"(",["T_WHITESPACE","\n                            ",945],["T_CONSTANT_ENCAPSED_STRING","'option_type_id'",946],["T_WHITESPACE"," ",946],["T_DOUBLE_ARROW","=>",946],["T_WHITESPACE"," ",946],["T_VARIABLE","$nextValueId",946],",",["T_WHITESPACE","\n                            ",946],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",947],["T_WHITESPACE","     ",947],["T_DOUBLE_ARROW","=>",947],["T_WHITESPACE"," ",947],["T_EMPTY","empty",947],"(",["T_VARIABLE","$rowData",947],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_row_sort'",947],"]",")",["T_WHITESPACE","\n                                ",947],"?",["T_WHITESPACE"," ",948],["T_LNUMBER","0",948],["T_WHITESPACE"," ",948],":",["T_WHITESPACE"," ",948],["T_STRING","abs",948],"(",["T_VARIABLE","$rowData",948],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_row_sort'",948],"]",")",",",["T_WHITESPACE","\n                            ",948],["T_CONSTANT_ENCAPSED_STRING","'sku'",949],["T_WHITESPACE","            ",949],["T_DOUBLE_ARROW","=>",949],["T_WHITESPACE"," ",949],"!",["T_EMPTY","empty",949],"(",["T_VARIABLE","$rowData",949],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_row_sku'",949],"]",")",["T_WHITESPACE","\n                                ",949],"?",["T_WHITESPACE"," ",950],["T_VARIABLE","$rowData",950],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_row_sku'",950],"]",["T_WHITESPACE"," ",950],":",["T_WHITESPACE"," ",950],["T_CONSTANT_ENCAPSED_STRING","''",950],["T_WHITESPACE","\n                        ",950],")",";",["T_WHITESPACE","\n                        ",951],["T_IF","if",952],["T_WHITESPACE"," ",952],"(","!",["T_ISSET","isset",952],"(",["T_VARIABLE","$customOptions",952],"[",["T_VARIABLE","$typeTitleTable",952],"]","[",["T_VARIABLE","$nextValueId",952],"]","[",["T_LNUMBER","0",952],"]",")",")",["T_WHITESPACE"," ",952],"{",["T_WHITESPACE"," ",952],["T_COMMENT","\/\/ ensure default title is set\n",952],["T_WHITESPACE","                            ",953],["T_VARIABLE","$customOptions",953],"[",["T_VARIABLE","$typeTitleTable",953],"]","[",["T_VARIABLE","$nextValueId",953],"]","[",["T_LNUMBER","0",953],"]",["T_WHITESPACE"," ",953],"=",["T_WHITESPACE"," ",953],["T_VARIABLE","$rowData",953],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_row_title'",953],"]",";",["T_WHITESPACE","\n                        ",953],"}",["T_WHITESPACE","\n                        ",954],["T_VARIABLE","$customOptions",955],"[",["T_VARIABLE","$typeTitleTable",955],"]","[",["T_VARIABLE","$nextValueId",955],"]","[",["T_VARIABLE","$storeId",955],"]",["T_WHITESPACE"," ",955],"=",["T_WHITESPACE"," ",955],["T_VARIABLE","$rowData",955],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_row_title'",955],"]",";",["T_WHITESPACE","\n\n                        ",955],["T_IF","if",957],["T_WHITESPACE"," ",957],"(","!",["T_EMPTY","empty",957],"(",["T_VARIABLE","$rowData",957],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_row_price'",957],"]",")",")",["T_WHITESPACE"," ",957],"{",["T_WHITESPACE","\n                            ",957],["T_VARIABLE","$typePriceRow",958],["T_WHITESPACE"," ",958],"=",["T_WHITESPACE"," ",958],["T_ARRAY","array",958],"(",["T_WHITESPACE","\n                                ",958],["T_CONSTANT_ENCAPSED_STRING","'price'",959],["T_WHITESPACE","      ",959],["T_DOUBLE_ARROW","=>",959],["T_WHITESPACE"," ",959],["T_DOUBLE_CAST","(float)",959],["T_WHITESPACE"," ",959],["T_STRING","rtrim",959],"(",["T_VARIABLE","$rowData",959],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_row_price'",959],"]",",",["T_WHITESPACE"," ",959],["T_CONSTANT_ENCAPSED_STRING","'%'",959],")",",",["T_WHITESPACE","\n                                ",959],["T_CONSTANT_ENCAPSED_STRING","'price_type'",960],["T_WHITESPACE"," ",960],["T_DOUBLE_ARROW","=>",960],["T_WHITESPACE"," ",960],["T_CONSTANT_ENCAPSED_STRING","'fixed'",960],["T_WHITESPACE","\n                            ",960],")",";",["T_WHITESPACE","\n                            ",961],["T_IF","if",962],["T_WHITESPACE"," ",962],"(",["T_CONSTANT_ENCAPSED_STRING","'%'",962],["T_WHITESPACE"," ",962],["T_IS_EQUAL","==",962],["T_WHITESPACE"," ",962],["T_STRING","substr",962],"(",["T_VARIABLE","$rowData",962],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_row_price'",962],"]",",",["T_WHITESPACE"," ",962],"-",["T_LNUMBER","1",962],")",")",["T_WHITESPACE"," ",962],"{",["T_WHITESPACE","\n                                ",962],["T_VARIABLE","$typePriceRow",963],"[",["T_CONSTANT_ENCAPSED_STRING","'price_type'",963],"]",["T_WHITESPACE"," ",963],"=",["T_WHITESPACE"," ",963],["T_CONSTANT_ENCAPSED_STRING","'percent'",963],";",["T_WHITESPACE","\n                            ",963],"}",["T_WHITESPACE","\n                            ",964],["T_IF","if",965],["T_WHITESPACE"," ",965],"(",["T_VARIABLE","$priceIsGlobal",965],")",["T_WHITESPACE"," ",965],"{",["T_WHITESPACE","\n                                ",965],["T_VARIABLE","$customOptions",966],"[",["T_VARIABLE","$typePriceTable",966],"]","[",["T_VARIABLE","$nextValueId",966],"]","[",["T_LNUMBER","0",966],"]",["T_WHITESPACE"," ",966],"=",["T_WHITESPACE"," ",966],["T_VARIABLE","$typePriceRow",966],";",["T_WHITESPACE","\n                            ",966],"}",["T_WHITESPACE"," ",967],["T_ELSE","else",967],["T_WHITESPACE"," ",967],"{",["T_WHITESPACE","\n                                ",967],["T_COMMENT","\/\/ ensure default price is set\n",968],["T_WHITESPACE","                                ",969],["T_IF","if",969],["T_WHITESPACE"," ",969],"(","!",["T_ISSET","isset",969],"(",["T_VARIABLE","$customOptions",969],"[",["T_VARIABLE","$typePriceTable",969],"]","[",["T_VARIABLE","$nextValueId",969],"]","[",["T_LNUMBER","0",969],"]",")",")",["T_WHITESPACE"," ",969],"{",["T_WHITESPACE","\n                                    ",969],["T_VARIABLE","$customOptions",970],"[",["T_VARIABLE","$typePriceTable",970],"]","[",["T_VARIABLE","$nextValueId",970],"]","[",["T_LNUMBER","0",970],"]",["T_WHITESPACE"," ",970],"=",["T_WHITESPACE"," ",970],["T_VARIABLE","$typePriceRow",970],";",["T_WHITESPACE","\n                                ",970],"}",["T_WHITESPACE","\n                                ",971],["T_VARIABLE","$customOptions",972],"[",["T_VARIABLE","$typePriceTable",972],"]","[",["T_VARIABLE","$nextValueId",972],"]","[",["T_VARIABLE","$storeId",972],"]",["T_WHITESPACE"," ",972],"=",["T_WHITESPACE"," ",972],["T_VARIABLE","$typePriceRow",972],";",["T_WHITESPACE","\n                            ",972],"}",["T_WHITESPACE","\n                        ",973],"}",["T_WHITESPACE","\n                        ",974],["T_IF","if",975],["T_WHITESPACE"," ",975],"(",["T_VARIABLE","$flagNewOption",975],")",["T_WHITESPACE"," ",975],"{",["T_WHITESPACE","\n                            ",975],["T_VARIABLE","$firstKeyOption",976],["T_WHITESPACE"," ",976],"=",["T_WHITESPACE"," ",976],["T_VARIABLE","$nextValueId",976],";",["T_WHITESPACE","\n                            ",976],["T_VARIABLE","$flagNewOption",977],["T_WHITESPACE","  ",977],"=",["T_WHITESPACE"," ",977],["T_STRING","false",977],";",["T_WHITESPACE","\n                        ",977],"}",["T_WHITESPACE","\n                        ",978],["T_VARIABLE","$nextValueId",979],["T_INC","++",979],";",["T_WHITESPACE","\n                    ",979],"}",["T_WHITESPACE"," ",980],["T_ELSE","else",980],["T_WHITESPACE"," ",980],"{",["T_WHITESPACE","\n                        ",980],["T_VARIABLE","$flagNewOption",981],["T_WHITESPACE"," ",981],"=",["T_WHITESPACE"," ",981],["T_STRING","true",981],";",["T_WHITESPACE","\n                        ",981],["T_IF","if",982],["T_WHITESPACE"," ",982],"(",["T_VARIABLE","$lastStoreId",982],["T_WHITESPACE"," ",982],["T_IS_NOT_EQUAL","!=",982],["T_WHITESPACE"," ",982],["T_VARIABLE","$storeId",982],")",["T_WHITESPACE"," ",982],"{",["T_WHITESPACE","\n                            ",982],["T_IF","if",983],["T_WHITESPACE"," ",983],"(","!",["T_VARIABLE","$firstKeyOption",983],")",["T_WHITESPACE"," ",983],"{",["T_WHITESPACE","\n                                ",983],["T_STRING","reset",984],"(",["T_VARIABLE","$customOptions",984],"[",["T_VARIABLE","$typeTitleTable",984],"]",")",";",["T_WHITESPACE","\n                                ",984],["T_VARIABLE","$firstKeyOption",985],["T_WHITESPACE"," ",985],"=",["T_WHITESPACE"," ",985],["T_STRING","key",985],"(",["T_VARIABLE","$customOptions",985],"[",["T_VARIABLE","$typeTitleTable",985],"]",")",";",["T_WHITESPACE","\n                            ",985],"}",["T_WHITESPACE","\n                            ",986],["T_VARIABLE","$currentValueId",987],["T_WHITESPACE"," ",987],"=",["T_WHITESPACE"," ",987],["T_VARIABLE","$firstKeyOption",987],";",["T_WHITESPACE","\n                            ",987],["T_VARIABLE","$lastStoreId",988],["T_WHITESPACE","    ",988],"=",["T_WHITESPACE"," ",988],["T_VARIABLE","$storeId",988],";",["T_WHITESPACE","\n                        ",988],"}",["T_WHITESPACE"," ",989],["T_ELSE","else",989],["T_WHITESPACE"," ",989],"{",["T_WHITESPACE","\n                            ",989],["T_VARIABLE","$currentValueId",990],["T_INC","++",990],";",["T_WHITESPACE","\n                        ",990],"}",["T_WHITESPACE","\n\n                        ",991],["T_VARIABLE","$defaultValue",993],["T_WHITESPACE"," ",993],"=",["T_WHITESPACE"," ",993],["T_VARIABLE","$customOptions",993],"[",["T_VARIABLE","$typeTitleTable",993],"]","[",["T_VARIABLE","$currentValueId",993],"]","[",["T_LNUMBER","0",993],"]",";",["T_WHITESPACE","\n                        ",993],["T_IF","if",994],["T_WHITESPACE"," ",994],"(",["T_VARIABLE","$defaultValue",994],["T_WHITESPACE"," ",994],["T_IS_NOT_EQUAL","!=",994],["T_WHITESPACE"," ",994],["T_VARIABLE","$rowData",994],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_row_title'",994],"]",")",["T_WHITESPACE"," ",994],"{",["T_WHITESPACE","\n                            ",994],["T_VARIABLE","$customOptions",995],"[",["T_VARIABLE","$typeTitleTable",995],"]","[",["T_VARIABLE","$currentValueId",995],"]","[",["T_VARIABLE","$storeId",995],"]",["T_WHITESPACE","\n                                ",995],"=",["T_WHITESPACE"," ",996],["T_VARIABLE","$rowData",996],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_row_title'",996],"]",";",["T_WHITESPACE","\n                        ",996],"}",["T_WHITESPACE","\n                    ",997],"}",["T_WHITESPACE","\n                ",998],"}",["T_WHITESPACE","\n\n                ",999],["T_IF","if",1001],["T_WHITESPACE"," ",1001],"(","!",["T_EMPTY","empty",1001],"(",["T_VARIABLE","$rowData",1001],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_title'",1001],"]",")",")",["T_WHITESPACE"," ",1001],"{",["T_WHITESPACE","\n                    ",1001],["T_IF","if",1002],["T_WHITESPACE"," ",1002],"(","!",["T_ISSET","isset",1002],"(",["T_VARIABLE","$customOptions",1002],"[",["T_VARIABLE","$titleTable",1002],"]","[",["T_VARIABLE","$prevOptionId",1002],"]","[",["T_LNUMBER","0",1002],"]",")",")",["T_WHITESPACE"," ",1002],"{",["T_WHITESPACE"," ",1002],["T_COMMENT","\/\/ ensure default title is set\n",1002],["T_WHITESPACE","                        ",1003],["T_VARIABLE","$customOptions",1003],"[",["T_VARIABLE","$titleTable",1003],"]","[",["T_VARIABLE","$prevOptionId",1003],"]","[",["T_LNUMBER","0",1003],"]",["T_WHITESPACE"," ",1003],"=",["T_WHITESPACE"," ",1003],["T_VARIABLE","$rowData",1003],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_title'",1003],"]",";",["T_WHITESPACE","\n                    ",1003],"}",["T_WHITESPACE","\n                    ",1004],["T_VARIABLE","$customOptions",1005],"[",["T_VARIABLE","$titleTable",1005],"]","[",["T_VARIABLE","$prevOptionId",1005],"]","[",["T_VARIABLE","$storeId",1005],"]",["T_WHITESPACE"," ",1005],"=",["T_WHITESPACE"," ",1005],["T_VARIABLE","$rowData",1005],"[",["T_CONSTANT_ENCAPSED_STRING","'_custom_option_title'",1005],"]",";",["T_WHITESPACE","\n                ",1005],"}",["T_WHITESPACE","\n            ",1006],"}",["T_WHITESPACE","\n            ",1007],["T_VARIABLE","$productIds",1008],["T_WHITESPACE"," ",1008],"=",["T_WHITESPACE"," ",1008],["T_STRING","array_keys",1008],"(",["T_VARIABLE","$customOptions",1008],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",1008],"]",")",";",["T_WHITESPACE","\n            ",1008],["T_VARIABLE","$productIds",1009],["T_WHITESPACE"," ",1009],"=",["T_WHITESPACE"," ",1009],["T_STRING","array_diff",1009],"(",["T_VARIABLE","$productIds",1009],",",["T_WHITESPACE"," ",1009],["T_VARIABLE","$alreadyUsedProductIds",1009],")",";",["T_WHITESPACE","\n            ",1009],["T_IF","if",1010],["T_WHITESPACE"," ",1010],"(",["T_VARIABLE","$this",1010],["T_OBJECT_OPERATOR","->",1010],["T_STRING","getBehavior",1010],"(",")",["T_WHITESPACE"," ",1010],["T_IS_NOT_EQUAL","!=",1010],["T_WHITESPACE"," ",1010],["T_STRING","Mage_ImportExport_Model_Import",1010],["T_DOUBLE_COLON","::",1010],["T_STRING","BEHAVIOR_APPEND",1010],["T_WHITESPACE","\n                ",1010],["T_BOOLEAN_AND","&&",1011],["T_WHITESPACE"," ",1011],"!",["T_EMPTY","empty",1011],"(",["T_VARIABLE","$productIds",1011],")",["T_WHITESPACE","\n            ",1011],")",["T_WHITESPACE"," ",1012],"{",["T_WHITESPACE"," ",1012],["T_COMMENT","\/\/ remove old data?\n",1012],["T_WHITESPACE","                ",1013],["T_VARIABLE","$this",1013],["T_OBJECT_OPERATOR","->",1013],["T_STRING","_connection",1013],["T_OBJECT_OPERATOR","->",1013],["T_STRING","delete",1013],"(",["T_WHITESPACE","\n                    ",1013],["T_VARIABLE","$optionTable",1014],",",["T_WHITESPACE","\n                    ",1014],["T_VARIABLE","$this",1015],["T_OBJECT_OPERATOR","->",1015],["T_STRING","_connection",1015],["T_OBJECT_OPERATOR","->",1015],["T_STRING","quoteInto",1015],"(",["T_CONSTANT_ENCAPSED_STRING","'product_id IN (?)'",1015],",",["T_WHITESPACE"," ",1015],["T_VARIABLE","$productIds",1015],")",["T_WHITESPACE","\n                ",1015],")",";",["T_WHITESPACE","\n            ",1016],"}",["T_WHITESPACE","\n            ",1017],["T_COMMENT","\/\/ if complex options does not contain values - ignore them\n",1018],["T_WHITESPACE","            ",1019],["T_FOREACH","foreach",1019],["T_WHITESPACE"," ",1019],"(",["T_VARIABLE","$customOptions",1019],"[",["T_VARIABLE","$optionTable",1019],"]",["T_WHITESPACE"," ",1019],["T_AS","as",1019],["T_WHITESPACE"," ",1019],["T_VARIABLE","$key",1019],["T_WHITESPACE"," ",1019],["T_DOUBLE_ARROW","=>",1019],["T_WHITESPACE"," ",1019],["T_VARIABLE","$optionData",1019],")",["T_WHITESPACE"," ",1019],"{",["T_WHITESPACE","\n                ",1019],["T_IF","if",1020],["T_WHITESPACE"," ",1020],"(",["T_VARIABLE","$typeSpecific",1020],"[",["T_VARIABLE","$optionData",1020],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",1020],"]","]",["T_WHITESPACE"," ",1020],["T_IS_IDENTICAL","===",1020],["T_WHITESPACE"," ",1020],["T_STRING","true",1020],["T_WHITESPACE","\n                        ",1020],["T_BOOLEAN_AND","&&",1021],["T_WHITESPACE"," ",1021],"!",["T_ISSET","isset",1021],"(",["T_VARIABLE","$customOptions",1021],"[",["T_VARIABLE","$typeValueTable",1021],"]","[",["T_VARIABLE","$optionData",1021],"[",["T_CONSTANT_ENCAPSED_STRING","'option_id'",1021],"]","]",")",["T_WHITESPACE","\n                ",1021],")",["T_WHITESPACE"," ",1022],"{",["T_WHITESPACE","\n                    ",1022],["T_UNSET","unset",1023],"(",["T_VARIABLE","$customOptions",1023],"[",["T_VARIABLE","$optionTable",1023],"]","[",["T_VARIABLE","$key",1023],"]",",",["T_WHITESPACE"," ",1023],["T_VARIABLE","$customOptions",1023],"[",["T_VARIABLE","$titleTable",1023],"]","[",["T_VARIABLE","$optionData",1023],"[",["T_CONSTANT_ENCAPSED_STRING","'option_id'",1023],"]","]",")",";",["T_WHITESPACE","\n                ",1023],"}",["T_WHITESPACE","\n            ",1024],"}",["T_WHITESPACE","\n\n            ",1025],["T_IF","if",1027],["T_WHITESPACE"," ",1027],"(",["T_VARIABLE","$customOptions",1027],"[",["T_VARIABLE","$optionTable",1027],"]",")",["T_WHITESPACE"," ",1027],"{",["T_WHITESPACE","\n                ",1027],["T_VARIABLE","$this",1028],["T_OBJECT_OPERATOR","->",1028],["T_STRING","_connection",1028],["T_OBJECT_OPERATOR","->",1028],["T_STRING","insertMultiple",1028],"(",["T_VARIABLE","$optionTable",1028],",",["T_WHITESPACE"," ",1028],["T_VARIABLE","$customOptions",1028],"[",["T_VARIABLE","$optionTable",1028],"]",")",";",["T_WHITESPACE","\n            ",1028],"}",["T_WHITESPACE","\n            ",1029],["T_VARIABLE","$titleRows",1030],["T_WHITESPACE"," ",1030],"=",["T_WHITESPACE"," ",1030],["T_ARRAY","array",1030],"(",")",";",["T_WHITESPACE","\n\n            ",1030],["T_FOREACH","foreach",1032],["T_WHITESPACE"," ",1032],"(",["T_VARIABLE","$customOptions",1032],"[",["T_VARIABLE","$titleTable",1032],"]",["T_WHITESPACE"," ",1032],["T_AS","as",1032],["T_WHITESPACE"," ",1032],["T_VARIABLE","$optionId",1032],["T_WHITESPACE"," ",1032],["T_DOUBLE_ARROW","=>",1032],["T_WHITESPACE"," ",1032],["T_VARIABLE","$storeInfo",1032],")",["T_WHITESPACE"," ",1032],"{",["T_WHITESPACE","\n                ",1032],["T_FOREACH","foreach",1033],["T_WHITESPACE"," ",1033],"(",["T_VARIABLE","$storeInfo",1033],["T_WHITESPACE"," ",1033],["T_AS","as",1033],["T_WHITESPACE"," ",1033],["T_VARIABLE","$storeId",1033],["T_WHITESPACE"," ",1033],["T_DOUBLE_ARROW","=>",1033],["T_WHITESPACE"," ",1033],["T_VARIABLE","$title",1033],")",["T_WHITESPACE"," ",1033],"{",["T_WHITESPACE","\n                    ",1033],["T_VARIABLE","$titleRows",1034],"[","]",["T_WHITESPACE"," ",1034],"=",["T_WHITESPACE"," ",1034],["T_ARRAY","array",1034],"(",["T_CONSTANT_ENCAPSED_STRING","'option_id'",1034],["T_WHITESPACE"," ",1034],["T_DOUBLE_ARROW","=>",1034],["T_WHITESPACE"," ",1034],["T_VARIABLE","$optionId",1034],",",["T_WHITESPACE"," ",1034],["T_CONSTANT_ENCAPSED_STRING","'store_id'",1034],["T_WHITESPACE"," ",1034],["T_DOUBLE_ARROW","=>",1034],["T_WHITESPACE"," ",1034],["T_VARIABLE","$storeId",1034],",",["T_WHITESPACE"," ",1034],["T_CONSTANT_ENCAPSED_STRING","'title'",1034],["T_WHITESPACE"," ",1034],["T_DOUBLE_ARROW","=>",1034],["T_WHITESPACE"," ",1034],["T_VARIABLE","$title",1034],")",";",["T_WHITESPACE","\n                ",1034],"}",["T_WHITESPACE","\n            ",1035],"}",["T_WHITESPACE","\n            ",1036],["T_IF","if",1037],["T_WHITESPACE"," ",1037],"(",["T_VARIABLE","$titleRows",1037],")",["T_WHITESPACE"," ",1037],"{",["T_WHITESPACE","\n                ",1037],["T_VARIABLE","$this",1038],["T_OBJECT_OPERATOR","->",1038],["T_STRING","_connection",1038],["T_OBJECT_OPERATOR","->",1038],["T_STRING","insertOnDuplicate",1038],"(",["T_VARIABLE","$titleTable",1038],",",["T_WHITESPACE"," ",1038],["T_VARIABLE","$titleRows",1038],",",["T_WHITESPACE"," ",1038],["T_ARRAY","array",1038],"(",["T_CONSTANT_ENCAPSED_STRING","'title'",1038],")",")",";",["T_WHITESPACE","\n            ",1038],"}",["T_WHITESPACE","\n            ",1039],["T_IF","if",1040],["T_WHITESPACE"," ",1040],"(",["T_VARIABLE","$customOptions",1040],"[",["T_VARIABLE","$priceTable",1040],"]",")",["T_WHITESPACE"," ",1040],"{",["T_WHITESPACE","\n                ",1040],["T_VARIABLE","$this",1041],["T_OBJECT_OPERATOR","->",1041],["T_STRING","_connection",1041],["T_OBJECT_OPERATOR","->",1041],["T_STRING","insertOnDuplicate",1041],"(",["T_WHITESPACE","\n                    ",1041],["T_VARIABLE","$priceTable",1042],",",["T_WHITESPACE","\n                    ",1042],["T_VARIABLE","$customOptions",1043],"[",["T_VARIABLE","$priceTable",1043],"]",",",["T_WHITESPACE","\n                    ",1043],["T_ARRAY","array",1044],"(",["T_CONSTANT_ENCAPSED_STRING","'price'",1044],",",["T_WHITESPACE"," ",1044],["T_CONSTANT_ENCAPSED_STRING","'price_type'",1044],")",["T_WHITESPACE","\n                ",1044],")",";",["T_WHITESPACE","\n            ",1045],"}",["T_WHITESPACE","\n            ",1046],["T_VARIABLE","$typeValueRows",1047],["T_WHITESPACE"," ",1047],"=",["T_WHITESPACE"," ",1047],["T_ARRAY","array",1047],"(",")",";",["T_WHITESPACE","\n\n            ",1047],["T_FOREACH","foreach",1049],["T_WHITESPACE"," ",1049],"(",["T_VARIABLE","$customOptions",1049],"[",["T_VARIABLE","$typeValueTable",1049],"]",["T_WHITESPACE"," ",1049],["T_AS","as",1049],["T_WHITESPACE"," ",1049],["T_VARIABLE","$optionId",1049],["T_WHITESPACE"," ",1049],["T_DOUBLE_ARROW","=>",1049],["T_WHITESPACE"," ",1049],["T_VARIABLE","$optionInfo",1049],")",["T_WHITESPACE"," ",1049],"{",["T_WHITESPACE","\n                ",1049],["T_FOREACH","foreach",1050],["T_WHITESPACE"," ",1050],"(",["T_VARIABLE","$optionInfo",1050],["T_WHITESPACE"," ",1050],["T_AS","as",1050],["T_WHITESPACE"," ",1050],["T_VARIABLE","$row",1050],")",["T_WHITESPACE"," ",1050],"{",["T_WHITESPACE","\n                    ",1050],["T_VARIABLE","$row",1051],"[",["T_CONSTANT_ENCAPSED_STRING","'option_id'",1051],"]",["T_WHITESPACE"," ",1051],"=",["T_WHITESPACE"," ",1051],["T_VARIABLE","$optionId",1051],";",["T_WHITESPACE","\n                    ",1051],["T_VARIABLE","$typeValueRows",1052],"[","]",["T_WHITESPACE","  ",1052],"=",["T_WHITESPACE"," ",1052],["T_VARIABLE","$row",1052],";",["T_WHITESPACE","\n                ",1052],"}",["T_WHITESPACE","\n            ",1053],"}",["T_WHITESPACE","\n            ",1054],["T_IF","if",1055],["T_WHITESPACE"," ",1055],"(",["T_VARIABLE","$typeValueRows",1055],")",["T_WHITESPACE"," ",1055],"{",["T_WHITESPACE","\n                ",1055],["T_VARIABLE","$this",1056],["T_OBJECT_OPERATOR","->",1056],["T_STRING","_connection",1056],["T_OBJECT_OPERATOR","->",1056],["T_STRING","insertMultiple",1056],"(",["T_VARIABLE","$typeValueTable",1056],",",["T_WHITESPACE"," ",1056],["T_VARIABLE","$typeValueRows",1056],")",";",["T_WHITESPACE","\n            ",1056],"}",["T_WHITESPACE","\n            ",1057],["T_VARIABLE","$optionTypePriceRows",1058],["T_WHITESPACE"," ",1058],"=",["T_WHITESPACE"," ",1058],["T_ARRAY","array",1058],"(",")",";",["T_WHITESPACE","\n            ",1058],["T_VARIABLE","$optionTypeTitleRows",1059],["T_WHITESPACE"," ",1059],"=",["T_WHITESPACE"," ",1059],["T_ARRAY","array",1059],"(",")",";",["T_WHITESPACE","\n\n            ",1059],["T_FOREACH","foreach",1061],["T_WHITESPACE"," ",1061],"(",["T_VARIABLE","$customOptions",1061],"[",["T_VARIABLE","$typePriceTable",1061],"]",["T_WHITESPACE"," ",1061],["T_AS","as",1061],["T_WHITESPACE"," ",1061],["T_VARIABLE","$optionTypeId",1061],["T_WHITESPACE"," ",1061],["T_DOUBLE_ARROW","=>",1061],["T_WHITESPACE"," ",1061],["T_VARIABLE","$storesData",1061],")",["T_WHITESPACE"," ",1061],"{",["T_WHITESPACE","\n                ",1061],["T_FOREACH","foreach",1062],["T_WHITESPACE"," ",1062],"(",["T_VARIABLE","$storesData",1062],["T_WHITESPACE"," ",1062],["T_AS","as",1062],["T_WHITESPACE"," ",1062],["T_VARIABLE","$storeId",1062],["T_WHITESPACE"," ",1062],["T_DOUBLE_ARROW","=>",1062],["T_WHITESPACE"," ",1062],["T_VARIABLE","$row",1062],")",["T_WHITESPACE"," ",1062],"{",["T_WHITESPACE","\n                    ",1062],["T_VARIABLE","$row",1063],"[",["T_CONSTANT_ENCAPSED_STRING","'option_type_id'",1063],"]",["T_WHITESPACE"," ",1063],"=",["T_WHITESPACE"," ",1063],["T_VARIABLE","$optionTypeId",1063],";",["T_WHITESPACE","\n                    ",1063],["T_VARIABLE","$row",1064],"[",["T_CONSTANT_ENCAPSED_STRING","'store_id'",1064],"]",["T_WHITESPACE","       ",1064],"=",["T_WHITESPACE"," ",1064],["T_VARIABLE","$storeId",1064],";",["T_WHITESPACE","\n                    ",1064],["T_VARIABLE","$optionTypePriceRows",1065],"[","]",["T_WHITESPACE"," ",1065],"=",["T_WHITESPACE"," ",1065],["T_VARIABLE","$row",1065],";",["T_WHITESPACE","\n                ",1065],"}",["T_WHITESPACE","\n            ",1066],"}",["T_WHITESPACE","\n            ",1067],["T_FOREACH","foreach",1068],["T_WHITESPACE"," ",1068],"(",["T_VARIABLE","$customOptions",1068],"[",["T_VARIABLE","$typeTitleTable",1068],"]",["T_WHITESPACE"," ",1068],["T_AS","as",1068],["T_WHITESPACE"," ",1068],["T_VARIABLE","$optionTypeId",1068],["T_WHITESPACE"," ",1068],["T_DOUBLE_ARROW","=>",1068],["T_WHITESPACE"," ",1068],["T_VARIABLE","$storesData",1068],")",["T_WHITESPACE"," ",1068],"{",["T_WHITESPACE","\n                ",1068],["T_FOREACH","foreach",1069],["T_WHITESPACE"," ",1069],"(",["T_VARIABLE","$storesData",1069],["T_WHITESPACE"," ",1069],["T_AS","as",1069],["T_WHITESPACE"," ",1069],["T_VARIABLE","$storeId",1069],["T_WHITESPACE"," ",1069],["T_DOUBLE_ARROW","=>",1069],["T_WHITESPACE"," ",1069],["T_VARIABLE","$title",1069],")",["T_WHITESPACE"," ",1069],"{",["T_WHITESPACE","\n                    ",1069],["T_VARIABLE","$optionTypeTitleRows",1070],"[","]",["T_WHITESPACE"," ",1070],"=",["T_WHITESPACE"," ",1070],["T_ARRAY","array",1070],"(",["T_WHITESPACE","\n                        ",1070],["T_CONSTANT_ENCAPSED_STRING","'option_type_id'",1071],["T_WHITESPACE"," ",1071],["T_DOUBLE_ARROW","=>",1071],["T_WHITESPACE"," ",1071],["T_VARIABLE","$optionTypeId",1071],",",["T_WHITESPACE","\n                        ",1071],["T_CONSTANT_ENCAPSED_STRING","'store_id'",1072],["T_WHITESPACE","       ",1072],["T_DOUBLE_ARROW","=>",1072],["T_WHITESPACE"," ",1072],["T_VARIABLE","$storeId",1072],",",["T_WHITESPACE","\n                        ",1072],["T_CONSTANT_ENCAPSED_STRING","'title'",1073],["T_WHITESPACE","          ",1073],["T_DOUBLE_ARROW","=>",1073],["T_WHITESPACE"," ",1073],["T_VARIABLE","$title",1073],["T_WHITESPACE","\n                    ",1073],")",";",["T_WHITESPACE","\n                ",1074],"}",["T_WHITESPACE","\n            ",1075],"}",["T_WHITESPACE","\n            ",1076],["T_IF","if",1077],["T_WHITESPACE"," ",1077],"(",["T_VARIABLE","$optionTypePriceRows",1077],")",["T_WHITESPACE"," ",1077],"{",["T_WHITESPACE","\n                ",1077],["T_VARIABLE","$this",1078],["T_OBJECT_OPERATOR","->",1078],["T_STRING","_connection",1078],["T_OBJECT_OPERATOR","->",1078],["T_STRING","insertOnDuplicate",1078],"(",["T_WHITESPACE","\n                    ",1078],["T_VARIABLE","$typePriceTable",1079],",",["T_WHITESPACE","\n                    ",1079],["T_VARIABLE","$optionTypePriceRows",1080],",",["T_WHITESPACE","\n                    ",1080],["T_ARRAY","array",1081],"(",["T_CONSTANT_ENCAPSED_STRING","'price'",1081],",",["T_WHITESPACE"," ",1081],["T_CONSTANT_ENCAPSED_STRING","'price_type'",1081],")",["T_WHITESPACE","\n                ",1081],")",";",["T_WHITESPACE","\n            ",1082],"}",["T_WHITESPACE","\n            ",1083],["T_IF","if",1084],["T_WHITESPACE"," ",1084],"(",["T_VARIABLE","$optionTypeTitleRows",1084],")",["T_WHITESPACE"," ",1084],"{",["T_WHITESPACE","\n                ",1084],["T_VARIABLE","$this",1085],["T_OBJECT_OPERATOR","->",1085],["T_STRING","_connection",1085],["T_OBJECT_OPERATOR","->",1085],["T_STRING","insertOnDuplicate",1085],"(",["T_VARIABLE","$typeTitleTable",1085],",",["T_WHITESPACE"," ",1085],["T_VARIABLE","$optionTypeTitleRows",1085],",",["T_WHITESPACE"," ",1085],["T_ARRAY","array",1085],"(",["T_CONSTANT_ENCAPSED_STRING","'title'",1085],")",")",";",["T_WHITESPACE","\n            ",1085],"}",["T_WHITESPACE","\n\n            ",1086],["T_IF","if",1088],["T_WHITESPACE"," ",1088],"(",["T_VARIABLE","$productIds",1088],")",["T_WHITESPACE"," ",1088],"{",["T_WHITESPACE"," ",1088],["T_COMMENT","\/\/ update product entity table to show that product has options\n",1088],["T_WHITESPACE","                ",1089],["T_VARIABLE","$customOptionsProducts",1089],["T_WHITESPACE"," ",1089],"=",["T_WHITESPACE"," ",1089],["T_VARIABLE","$customOptions",1089],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",1089],"]",";",["T_WHITESPACE","\n\n                ",1089],["T_FOREACH","foreach",1091],["T_WHITESPACE"," ",1091],"(",["T_VARIABLE","$customOptionsProducts",1091],["T_WHITESPACE"," ",1091],["T_AS","as",1091],["T_WHITESPACE"," ",1091],["T_VARIABLE","$key",1091],["T_WHITESPACE"," ",1091],["T_DOUBLE_ARROW","=>",1091],["T_WHITESPACE"," ",1091],["T_VARIABLE","$value",1091],")",["T_WHITESPACE"," ",1091],"{",["T_WHITESPACE","\n                    ",1091],["T_IF","if",1092],["T_WHITESPACE"," ",1092],"(","!",["T_STRING","in_array",1092],"(",["T_VARIABLE","$key",1092],",",["T_WHITESPACE"," ",1092],["T_VARIABLE","$productIds",1092],")",")",["T_WHITESPACE"," ",1092],"{",["T_WHITESPACE","\n                        ",1092],["T_UNSET","unset",1093],"(",["T_VARIABLE","$customOptionsProducts",1093],"[",["T_VARIABLE","$key",1093],"]",")",";",["T_WHITESPACE","\n                    ",1093],"}",["T_WHITESPACE","\n                ",1094],"}",["T_WHITESPACE","\n                ",1095],["T_VARIABLE","$this",1096],["T_OBJECT_OPERATOR","->",1096],["T_STRING","_connection",1096],["T_OBJECT_OPERATOR","->",1096],["T_STRING","insertOnDuplicate",1096],"(",["T_WHITESPACE","\n                    ",1096],["T_VARIABLE","$productTable",1097],",",["T_WHITESPACE","\n                    ",1097],["T_VARIABLE","$customOptionsProducts",1098],",",["T_WHITESPACE","\n                    ",1098],["T_ARRAY","array",1099],"(",["T_CONSTANT_ENCAPSED_STRING","'has_options'",1099],",",["T_WHITESPACE"," ",1099],["T_CONSTANT_ENCAPSED_STRING","'required_options'",1099],",",["T_WHITESPACE"," ",1099],["T_CONSTANT_ENCAPSED_STRING","'updated_at'",1099],")",["T_WHITESPACE","\n                ",1099],")",";",["T_WHITESPACE","\n            ",1100],"}",["T_WHITESPACE","\n\n            ",1101],["T_VARIABLE","$alreadyUsedProductIds",1103],["T_WHITESPACE"," ",1103],"=",["T_WHITESPACE"," ",1103],["T_STRING","array_merge",1103],"(",["T_VARIABLE","$alreadyUsedProductIds",1103],",",["T_WHITESPACE"," ",1103],["T_VARIABLE","$productIds",1103],")",";",["T_WHITESPACE","\n        ",1103],"}",["T_WHITESPACE","\n        ",1104],["T_RETURN","return",1105],["T_WHITESPACE"," ",1105],["T_VARIABLE","$this",1105],";",["T_WHITESPACE","\n    ",1105],"}",["T_WHITESPACE","\n\n    ",1106],["T_DOC_COMMENT","\/**\n     * Gather and save information about product links.\n     * Must be called after ALL products saving done.\n     *\n     * @return Mage_ImportExport_Model_Import_Entity_Product\n     *\/",1108],["T_WHITESPACE","\n    ",1113],["T_PROTECTED","protected",1114],["T_WHITESPACE"," ",1114],["T_FUNCTION","function",1114],["T_WHITESPACE"," ",1114],["T_STRING","_saveLinks",1114],"(",")",["T_WHITESPACE","\n    ",1114],"{",["T_WHITESPACE","\n        ",1115],["T_VARIABLE","$resource",1116],["T_WHITESPACE","       ",1116],"=",["T_WHITESPACE"," ",1116],["T_STRING","Mage",1116],["T_DOUBLE_COLON","::",1116],["T_STRING","getResourceModel",1116],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_link'",1116],")",";",["T_WHITESPACE","\n        ",1116],["T_VARIABLE","$mainTable",1117],["T_WHITESPACE","      ",1117],"=",["T_WHITESPACE"," ",1117],["T_VARIABLE","$resource",1117],["T_OBJECT_OPERATOR","->",1117],["T_STRING","getMainTable",1117],"(",")",";",["T_WHITESPACE","\n        ",1117],["T_VARIABLE","$positionAttrId",1118],["T_WHITESPACE"," ",1118],"=",["T_WHITESPACE"," ",1118],["T_ARRAY","array",1118],"(",")",";",["T_WHITESPACE","\n        ",1118],["T_DOC_COMMENT","\/** @var Varien_Db_Adapter_Interface $adapter *\/",1119],["T_WHITESPACE","\n        ",1119],["T_VARIABLE","$adapter",1120],["T_WHITESPACE"," ",1120],"=",["T_WHITESPACE"," ",1120],["T_VARIABLE","$this",1120],["T_OBJECT_OPERATOR","->",1120],["T_STRING","_connection",1120],";",["T_WHITESPACE","\n\n        ",1120],["T_COMMENT","\/\/ pre-load 'position' attributes ID for each link type once\n",1122],["T_WHITESPACE","        ",1123],["T_FOREACH","foreach",1123],["T_WHITESPACE"," ",1123],"(",["T_VARIABLE","$this",1123],["T_OBJECT_OPERATOR","->",1123],["T_STRING","_linkNameToId",1123],["T_WHITESPACE"," ",1123],["T_AS","as",1123],["T_WHITESPACE"," ",1123],["T_VARIABLE","$linkName",1123],["T_WHITESPACE"," ",1123],["T_DOUBLE_ARROW","=>",1123],["T_WHITESPACE"," ",1123],["T_VARIABLE","$linkId",1123],")",["T_WHITESPACE"," ",1123],"{",["T_WHITESPACE","\n            ",1123],["T_VARIABLE","$select",1124],["T_WHITESPACE"," ",1124],"=",["T_WHITESPACE"," ",1124],["T_VARIABLE","$adapter",1124],["T_OBJECT_OPERATOR","->",1124],["T_STRING","select",1124],"(",")",["T_WHITESPACE","\n                ",1124],["T_OBJECT_OPERATOR","->",1125],["T_STRING","from",1125],"(",["T_WHITESPACE","\n                    ",1125],["T_VARIABLE","$resource",1126],["T_OBJECT_OPERATOR","->",1126],["T_STRING","getTable",1126],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_link_attribute'",1126],")",",",["T_WHITESPACE","\n                    ",1126],["T_ARRAY","array",1127],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",1127],["T_WHITESPACE"," ",1127],["T_DOUBLE_ARROW","=>",1127],["T_WHITESPACE"," ",1127],["T_CONSTANT_ENCAPSED_STRING","'product_link_attribute_id'",1127],")",["T_WHITESPACE","\n                ",1127],")",["T_WHITESPACE","\n                ",1128],["T_OBJECT_OPERATOR","->",1129],["T_STRING","where",1129],"(",["T_CONSTANT_ENCAPSED_STRING","'link_type_id = :link_id AND product_link_attribute_code = :position'",1129],")",";",["T_WHITESPACE","\n            ",1129],["T_VARIABLE","$bind",1130],["T_WHITESPACE"," ",1130],"=",["T_WHITESPACE"," ",1130],["T_ARRAY","array",1130],"(",["T_WHITESPACE","\n                ",1130],["T_CONSTANT_ENCAPSED_STRING","':link_id'",1131],["T_WHITESPACE"," ",1131],["T_DOUBLE_ARROW","=>",1131],["T_WHITESPACE"," ",1131],["T_VARIABLE","$linkId",1131],",",["T_WHITESPACE","\n                ",1131],["T_CONSTANT_ENCAPSED_STRING","':position'",1132],["T_WHITESPACE"," ",1132],["T_DOUBLE_ARROW","=>",1132],["T_WHITESPACE"," ",1132],["T_CONSTANT_ENCAPSED_STRING","'position'",1132],["T_WHITESPACE","\n            ",1132],")",";",["T_WHITESPACE","\n            ",1133],["T_VARIABLE","$positionAttrId",1134],"[",["T_VARIABLE","$linkId",1134],"]",["T_WHITESPACE"," ",1134],"=",["T_WHITESPACE"," ",1134],["T_VARIABLE","$adapter",1134],["T_OBJECT_OPERATOR","->",1134],["T_STRING","fetchOne",1134],"(",["T_VARIABLE","$select",1134],",",["T_WHITESPACE"," ",1134],["T_VARIABLE","$bind",1134],")",";",["T_WHITESPACE","\n        ",1134],"}",["T_WHITESPACE","\n        ",1135],["T_VARIABLE","$nextLinkId",1136],["T_WHITESPACE"," ",1136],"=",["T_WHITESPACE"," ",1136],["T_STRING","Mage",1136],["T_DOUBLE_COLON","::",1136],["T_STRING","getResourceHelper",1136],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",1136],")",["T_OBJECT_OPERATOR","->",1136],["T_STRING","getNextAutoincrement",1136],"(",["T_VARIABLE","$mainTable",1136],")",";",["T_WHITESPACE","\n        ",1136],["T_WHILE","while",1137],["T_WHITESPACE"," ",1137],"(",["T_VARIABLE","$bunch",1137],["T_WHITESPACE"," ",1137],"=",["T_WHITESPACE"," ",1137],["T_VARIABLE","$this",1137],["T_OBJECT_OPERATOR","->",1137],["T_STRING","_dataSourceModel",1137],["T_OBJECT_OPERATOR","->",1137],["T_STRING","getNextBunch",1137],"(",")",")",["T_WHITESPACE"," ",1137],"{",["T_WHITESPACE","\n            ",1137],["T_VARIABLE","$productIds",1138],["T_WHITESPACE","   ",1138],"=",["T_WHITESPACE"," ",1138],["T_ARRAY","array",1138],"(",")",";",["T_WHITESPACE","\n            ",1138],["T_VARIABLE","$linkRows",1139],["T_WHITESPACE","     ",1139],"=",["T_WHITESPACE"," ",1139],["T_ARRAY","array",1139],"(",")",";",["T_WHITESPACE","\n            ",1139],["T_VARIABLE","$positionRows",1140],["T_WHITESPACE"," ",1140],"=",["T_WHITESPACE"," ",1140],["T_ARRAY","array",1140],"(",")",";",["T_WHITESPACE","\n\n            ",1140],["T_FOREACH","foreach",1142],["T_WHITESPACE"," ",1142],"(",["T_VARIABLE","$bunch",1142],["T_WHITESPACE"," ",1142],["T_AS","as",1142],["T_WHITESPACE"," ",1142],["T_VARIABLE","$rowNum",1142],["T_WHITESPACE"," ",1142],["T_DOUBLE_ARROW","=>",1142],["T_WHITESPACE"," ",1142],["T_VARIABLE","$rowData",1142],")",["T_WHITESPACE"," ",1142],"{",["T_WHITESPACE","\n                ",1142],["T_VARIABLE","$this",1143],["T_OBJECT_OPERATOR","->",1143],["T_STRING","_filterRowData",1143],"(",["T_VARIABLE","$rowData",1143],")",";",["T_WHITESPACE","\n                ",1143],["T_IF","if",1144],["T_WHITESPACE"," ",1144],"(","!",["T_VARIABLE","$this",1144],["T_OBJECT_OPERATOR","->",1144],["T_STRING","isRowAllowedToImport",1144],"(",["T_VARIABLE","$rowData",1144],",",["T_WHITESPACE"," ",1144],["T_VARIABLE","$rowNum",1144],")",")",["T_WHITESPACE"," ",1144],"{",["T_WHITESPACE","\n                    ",1144],["T_CONTINUE","continue",1145],";",["T_WHITESPACE","\n                ",1145],"}",["T_WHITESPACE","\n                ",1146],["T_IF","if",1147],["T_WHITESPACE"," ",1147],"(",["T_STRING","self",1147],["T_DOUBLE_COLON","::",1147],["T_STRING","SCOPE_DEFAULT",1147],["T_WHITESPACE"," ",1147],["T_IS_EQUAL","==",1147],["T_WHITESPACE"," ",1147],["T_VARIABLE","$this",1147],["T_OBJECT_OPERATOR","->",1147],["T_STRING","getRowScope",1147],"(",["T_VARIABLE","$rowData",1147],")",")",["T_WHITESPACE"," ",1147],"{",["T_WHITESPACE","\n                    ",1147],["T_VARIABLE","$sku",1148],["T_WHITESPACE"," ",1148],"=",["T_WHITESPACE"," ",1148],["T_VARIABLE","$rowData",1148],"[",["T_STRING","self",1148],["T_DOUBLE_COLON","::",1148],["T_STRING","COL_SKU",1148],"]",";",["T_WHITESPACE","\n                ",1148],"}",["T_WHITESPACE","\n                ",1149],["T_FOREACH","foreach",1150],["T_WHITESPACE"," ",1150],"(",["T_VARIABLE","$this",1150],["T_OBJECT_OPERATOR","->",1150],["T_STRING","_linkNameToId",1150],["T_WHITESPACE"," ",1150],["T_AS","as",1150],["T_WHITESPACE"," ",1150],["T_VARIABLE","$linkName",1150],["T_WHITESPACE"," ",1150],["T_DOUBLE_ARROW","=>",1150],["T_WHITESPACE"," ",1150],["T_VARIABLE","$linkId",1150],")",["T_WHITESPACE"," ",1150],"{",["T_WHITESPACE","\n                    ",1150],["T_IF","if",1151],["T_WHITESPACE"," ",1151],"(",["T_ISSET","isset",1151],"(",["T_VARIABLE","$rowData",1151],"[",["T_VARIABLE","$linkName",1151],["T_WHITESPACE"," ",1151],".",["T_WHITESPACE"," ",1151],["T_CONSTANT_ENCAPSED_STRING","'sku'",1151],"]",")",")",["T_WHITESPACE"," ",1151],"{",["T_WHITESPACE","\n                        ",1151],["T_VARIABLE","$productId",1152],["T_WHITESPACE","    ",1152],"=",["T_WHITESPACE"," ",1152],["T_VARIABLE","$this",1152],["T_OBJECT_OPERATOR","->",1152],["T_STRING","_newSku",1152],"[",["T_VARIABLE","$sku",1152],"]","[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1152],"]",";",["T_WHITESPACE","\n                        ",1152],["T_VARIABLE","$productIds",1153],"[","]",["T_WHITESPACE"," ",1153],"=",["T_WHITESPACE"," ",1153],["T_VARIABLE","$productId",1153],";",["T_WHITESPACE","\n                        ",1153],["T_VARIABLE","$linkedSku",1154],["T_WHITESPACE","    ",1154],"=",["T_WHITESPACE"," ",1154],["T_VARIABLE","$rowData",1154],"[",["T_VARIABLE","$linkName",1154],["T_WHITESPACE"," ",1154],".",["T_WHITESPACE"," ",1154],["T_CONSTANT_ENCAPSED_STRING","'sku'",1154],"]",";",["T_WHITESPACE","\n\n                        ",1154],["T_IF","if",1156],["T_WHITESPACE"," ",1156],"(","(",["T_ISSET","isset",1156],"(",["T_VARIABLE","$this",1156],["T_OBJECT_OPERATOR","->",1156],["T_STRING","_newSku",1156],"[",["T_VARIABLE","$linkedSku",1156],"]",")",["T_WHITESPACE"," ",1156],["T_BOOLEAN_OR","||",1156],["T_WHITESPACE"," ",1156],["T_ISSET","isset",1156],"(",["T_VARIABLE","$this",1156],["T_OBJECT_OPERATOR","->",1156],["T_STRING","_oldSku",1156],"[",["T_VARIABLE","$linkedSku",1156],"]",")",")",["T_WHITESPACE","\n                            ",1156],["T_BOOLEAN_AND","&&",1157],["T_WHITESPACE"," ",1157],["T_VARIABLE","$linkedSku",1157],["T_WHITESPACE"," ",1157],["T_IS_NOT_EQUAL","!=",1157],["T_WHITESPACE"," ",1157],["T_VARIABLE","$sku",1157],")",["T_WHITESPACE"," ",1157],"{",["T_WHITESPACE","\n                            ",1157],["T_IF","if",1158],["T_WHITESPACE"," ",1158],"(",["T_ISSET","isset",1158],"(",["T_VARIABLE","$this",1158],["T_OBJECT_OPERATOR","->",1158],["T_STRING","_newSku",1158],"[",["T_VARIABLE","$linkedSku",1158],"]",")",")",["T_WHITESPACE"," ",1158],"{",["T_WHITESPACE","\n                                ",1158],["T_VARIABLE","$linkedId",1159],["T_WHITESPACE"," ",1159],"=",["T_WHITESPACE"," ",1159],["T_VARIABLE","$this",1159],["T_OBJECT_OPERATOR","->",1159],["T_STRING","_newSku",1159],"[",["T_VARIABLE","$linkedSku",1159],"]","[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1159],"]",";",["T_WHITESPACE","\n                            ",1159],"}",["T_WHITESPACE"," ",1160],["T_ELSE","else",1160],["T_WHITESPACE"," ",1160],"{",["T_WHITESPACE","\n                                ",1160],["T_VARIABLE","$linkedId",1161],["T_WHITESPACE"," ",1161],"=",["T_WHITESPACE"," ",1161],["T_VARIABLE","$this",1161],["T_OBJECT_OPERATOR","->",1161],["T_STRING","_oldSku",1161],"[",["T_VARIABLE","$linkedSku",1161],"]","[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1161],"]",";",["T_WHITESPACE","\n                            ",1161],"}",["T_WHITESPACE","\n                            ",1162],["T_VARIABLE","$linkKey",1163],["T_WHITESPACE"," ",1163],"=",["T_WHITESPACE"," ",1163],"\"",["T_CURLY_OPEN","{",1163],["T_VARIABLE","$productId",1163],"}",["T_ENCAPSED_AND_WHITESPACE","-",1163],["T_CURLY_OPEN","{",1163],["T_VARIABLE","$linkedId",1163],"}",["T_ENCAPSED_AND_WHITESPACE","-",1163],["T_CURLY_OPEN","{",1163],["T_VARIABLE","$linkId",1163],"}","\"",";",["T_WHITESPACE","\n\n                            ",1163],["T_IF","if",1165],["T_WHITESPACE"," ",1165],"(","!",["T_ISSET","isset",1165],"(",["T_VARIABLE","$linkRows",1165],"[",["T_VARIABLE","$linkKey",1165],"]",")",")",["T_WHITESPACE"," ",1165],"{",["T_WHITESPACE","\n                                ",1165],["T_VARIABLE","$linkRows",1166],"[",["T_VARIABLE","$linkKey",1166],"]",["T_WHITESPACE"," ",1166],"=",["T_WHITESPACE"," ",1166],["T_ARRAY","array",1166],"(",["T_WHITESPACE","\n                                    ",1166],["T_CONSTANT_ENCAPSED_STRING","'link_id'",1167],["T_WHITESPACE","           ",1167],["T_DOUBLE_ARROW","=>",1167],["T_WHITESPACE"," ",1167],["T_VARIABLE","$nextLinkId",1167],",",["T_WHITESPACE","\n                                    ",1167],["T_CONSTANT_ENCAPSED_STRING","'product_id'",1168],["T_WHITESPACE","        ",1168],["T_DOUBLE_ARROW","=>",1168],["T_WHITESPACE"," ",1168],["T_VARIABLE","$productId",1168],",",["T_WHITESPACE","\n                                    ",1168],["T_CONSTANT_ENCAPSED_STRING","'linked_product_id'",1169],["T_WHITESPACE"," ",1169],["T_DOUBLE_ARROW","=>",1169],["T_WHITESPACE"," ",1169],["T_VARIABLE","$linkedId",1169],",",["T_WHITESPACE","\n                                    ",1169],["T_CONSTANT_ENCAPSED_STRING","'link_type_id'",1170],["T_WHITESPACE","      ",1170],["T_DOUBLE_ARROW","=>",1170],["T_WHITESPACE"," ",1170],["T_VARIABLE","$linkId",1170],["T_WHITESPACE","\n                                ",1170],")",";",["T_WHITESPACE","\n                                ",1171],["T_IF","if",1172],["T_WHITESPACE"," ",1172],"(","!",["T_EMPTY","empty",1172],"(",["T_VARIABLE","$rowData",1172],"[",["T_VARIABLE","$linkName",1172],["T_WHITESPACE"," ",1172],".",["T_WHITESPACE"," ",1172],["T_CONSTANT_ENCAPSED_STRING","'position'",1172],"]",")",")",["T_WHITESPACE"," ",1172],"{",["T_WHITESPACE","\n                                    ",1172],["T_VARIABLE","$positionRows",1173],"[","]",["T_WHITESPACE"," ",1173],"=",["T_WHITESPACE"," ",1173],["T_ARRAY","array",1173],"(",["T_WHITESPACE","\n                                        ",1173],["T_CONSTANT_ENCAPSED_STRING","'link_id'",1174],["T_WHITESPACE","                   ",1174],["T_DOUBLE_ARROW","=>",1174],["T_WHITESPACE"," ",1174],["T_VARIABLE","$nextLinkId",1174],",",["T_WHITESPACE","\n                                        ",1174],["T_CONSTANT_ENCAPSED_STRING","'product_link_attribute_id'",1175],["T_WHITESPACE"," ",1175],["T_DOUBLE_ARROW","=>",1175],["T_WHITESPACE"," ",1175],["T_VARIABLE","$positionAttrId",1175],"[",["T_VARIABLE","$linkId",1175],"]",",",["T_WHITESPACE","\n                                        ",1175],["T_CONSTANT_ENCAPSED_STRING","'value'",1176],["T_WHITESPACE","                     ",1176],["T_DOUBLE_ARROW","=>",1176],["T_WHITESPACE"," ",1176],["T_VARIABLE","$rowData",1176],"[",["T_VARIABLE","$linkName",1176],["T_WHITESPACE"," ",1176],".",["T_WHITESPACE"," ",1176],["T_CONSTANT_ENCAPSED_STRING","'position'",1176],"]",["T_WHITESPACE","\n                                    ",1176],")",";",["T_WHITESPACE","\n                                ",1177],"}",["T_WHITESPACE","\n                                ",1178],["T_VARIABLE","$nextLinkId",1179],["T_INC","++",1179],";",["T_WHITESPACE","\n                            ",1179],"}",["T_WHITESPACE","\n                        ",1180],"}",["T_WHITESPACE","\n                    ",1181],"}",["T_WHITESPACE","\n                ",1182],"}",["T_WHITESPACE","\n            ",1183],"}",["T_WHITESPACE","\n            ",1184],["T_IF","if",1185],["T_WHITESPACE"," ",1185],"(",["T_STRING","Mage_ImportExport_Model_Import",1185],["T_DOUBLE_COLON","::",1185],["T_STRING","BEHAVIOR_APPEND",1185],["T_WHITESPACE"," ",1185],["T_IS_NOT_EQUAL","!=",1185],["T_WHITESPACE"," ",1185],["T_VARIABLE","$this",1185],["T_OBJECT_OPERATOR","->",1185],["T_STRING","getBehavior",1185],"(",")",["T_WHITESPACE"," ",1185],["T_BOOLEAN_AND","&&",1185],["T_WHITESPACE"," ",1185],["T_VARIABLE","$productIds",1185],")",["T_WHITESPACE"," ",1185],"{",["T_WHITESPACE","\n                ",1185],["T_VARIABLE","$adapter",1186],["T_OBJECT_OPERATOR","->",1186],["T_STRING","delete",1186],"(",["T_WHITESPACE","\n                    ",1186],["T_VARIABLE","$mainTable",1187],",",["T_WHITESPACE","\n                    ",1187],["T_VARIABLE","$adapter",1188],["T_OBJECT_OPERATOR","->",1188],["T_STRING","quoteInto",1188],"(",["T_CONSTANT_ENCAPSED_STRING","'product_id IN (?)'",1188],",",["T_WHITESPACE"," ",1188],["T_STRING","array_unique",1188],"(",["T_VARIABLE","$productIds",1188],")",")",["T_WHITESPACE","\n                ",1188],")",";",["T_WHITESPACE","\n            ",1189],"}",["T_WHITESPACE","\n            ",1190],["T_IF","if",1191],["T_WHITESPACE"," ",1191],"(",["T_VARIABLE","$linkRows",1191],")",["T_WHITESPACE"," ",1191],"{",["T_WHITESPACE","\n                ",1191],["T_VARIABLE","$adapter",1192],["T_OBJECT_OPERATOR","->",1192],["T_STRING","insertOnDuplicate",1192],"(",["T_WHITESPACE","\n                    ",1192],["T_VARIABLE","$mainTable",1193],",",["T_WHITESPACE","\n                    ",1193],["T_VARIABLE","$linkRows",1194],",",["T_WHITESPACE","\n                    ",1194],["T_ARRAY","array",1195],"(",["T_CONSTANT_ENCAPSED_STRING","'link_id'",1195],")",["T_WHITESPACE","\n                ",1195],")",";",["T_WHITESPACE","\n                ",1196],["T_VARIABLE","$adapter",1197],["T_OBJECT_OPERATOR","->",1197],["T_STRING","changeTableAutoIncrement",1197],"(",["T_VARIABLE","$mainTable",1197],",",["T_WHITESPACE"," ",1197],["T_VARIABLE","$nextLinkId",1197],")",";",["T_WHITESPACE","\n            ",1197],"}",["T_WHITESPACE","\n            ",1198],["T_IF","if",1199],["T_WHITESPACE"," ",1199],"(",["T_VARIABLE","$positionRows",1199],")",["T_WHITESPACE"," ",1199],"{",["T_WHITESPACE"," ",1199],["T_COMMENT","\/\/ process linked product positions\n",1199],["T_WHITESPACE","                ",1200],["T_VARIABLE","$adapter",1200],["T_OBJECT_OPERATOR","->",1200],["T_STRING","insertOnDuplicate",1200],"(",["T_WHITESPACE","\n                    ",1200],["T_VARIABLE","$resource",1201],["T_OBJECT_OPERATOR","->",1201],["T_STRING","getAttributeTypeTable",1201],"(",["T_CONSTANT_ENCAPSED_STRING","'int'",1201],")",",",["T_WHITESPACE","\n                    ",1201],["T_VARIABLE","$positionRows",1202],",",["T_WHITESPACE","\n                    ",1202],["T_ARRAY","array",1203],"(",["T_CONSTANT_ENCAPSED_STRING","'value'",1203],")",["T_WHITESPACE","\n                ",1203],")",";",["T_WHITESPACE","\n            ",1204],"}",["T_WHITESPACE","\n        ",1205],"}",["T_WHITESPACE","\n        ",1206],["T_RETURN","return",1207],["T_WHITESPACE"," ",1207],["T_VARIABLE","$this",1207],";",["T_WHITESPACE","\n    ",1207],"}",["T_WHITESPACE","\n\n    ",1208],["T_DOC_COMMENT","\/**\n     * Save product attributes.\n     *\n     * @param array $attributesData\n     * @return Mage_ImportExport_Model_Import_Entity_Product\n     *\/",1210],["T_WHITESPACE","\n    ",1215],["T_PROTECTED","protected",1216],["T_WHITESPACE"," ",1216],["T_FUNCTION","function",1216],["T_WHITESPACE"," ",1216],["T_STRING","_saveProductAttributes",1216],"(",["T_ARRAY","array",1216],["T_WHITESPACE"," ",1216],["T_VARIABLE","$attributesData",1216],")",["T_WHITESPACE","\n    ",1216],"{",["T_WHITESPACE","\n        ",1217],["T_FOREACH","foreach",1218],["T_WHITESPACE"," ",1218],"(",["T_VARIABLE","$attributesData",1218],["T_WHITESPACE"," ",1218],["T_AS","as",1218],["T_WHITESPACE"," ",1218],["T_VARIABLE","$tableName",1218],["T_WHITESPACE"," ",1218],["T_DOUBLE_ARROW","=>",1218],["T_WHITESPACE"," ",1218],["T_VARIABLE","$skuData",1218],")",["T_WHITESPACE"," ",1218],"{",["T_WHITESPACE","\n            ",1218],["T_VARIABLE","$tableData",1219],["T_WHITESPACE"," ",1219],"=",["T_WHITESPACE"," ",1219],["T_ARRAY","array",1219],"(",")",";",["T_WHITESPACE","\n\n            ",1219],["T_FOREACH","foreach",1221],["T_WHITESPACE"," ",1221],"(",["T_VARIABLE","$skuData",1221],["T_WHITESPACE"," ",1221],["T_AS","as",1221],["T_WHITESPACE"," ",1221],["T_VARIABLE","$sku",1221],["T_WHITESPACE"," ",1221],["T_DOUBLE_ARROW","=>",1221],["T_WHITESPACE"," ",1221],["T_VARIABLE","$attributes",1221],")",["T_WHITESPACE"," ",1221],"{",["T_WHITESPACE","\n                ",1221],["T_VARIABLE","$productId",1222],["T_WHITESPACE"," ",1222],"=",["T_WHITESPACE"," ",1222],["T_VARIABLE","$this",1222],["T_OBJECT_OPERATOR","->",1222],["T_STRING","_newSku",1222],"[",["T_VARIABLE","$sku",1222],"]","[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1222],"]",";",["T_WHITESPACE","\n\n                ",1222],["T_FOREACH","foreach",1224],["T_WHITESPACE"," ",1224],"(",["T_VARIABLE","$attributes",1224],["T_WHITESPACE"," ",1224],["T_AS","as",1224],["T_WHITESPACE"," ",1224],["T_VARIABLE","$attributeId",1224],["T_WHITESPACE"," ",1224],["T_DOUBLE_ARROW","=>",1224],["T_WHITESPACE"," ",1224],["T_VARIABLE","$storeValues",1224],")",["T_WHITESPACE"," ",1224],"{",["T_WHITESPACE","\n                    ",1224],["T_FOREACH","foreach",1225],["T_WHITESPACE"," ",1225],"(",["T_VARIABLE","$storeValues",1225],["T_WHITESPACE"," ",1225],["T_AS","as",1225],["T_WHITESPACE"," ",1225],["T_VARIABLE","$storeId",1225],["T_WHITESPACE"," ",1225],["T_DOUBLE_ARROW","=>",1225],["T_WHITESPACE"," ",1225],["T_VARIABLE","$storeValue",1225],")",["T_WHITESPACE"," ",1225],"{",["T_WHITESPACE","\n                        ",1225],["T_VARIABLE","$tableData",1226],"[","]",["T_WHITESPACE"," ",1226],"=",["T_WHITESPACE"," ",1226],["T_ARRAY","array",1226],"(",["T_WHITESPACE","\n                            ",1226],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1227],["T_WHITESPACE","      ",1227],["T_DOUBLE_ARROW","=>",1227],["T_WHITESPACE"," ",1227],["T_VARIABLE","$productId",1227],",",["T_WHITESPACE","\n                            ",1227],["T_CONSTANT_ENCAPSED_STRING","'entity_type_id'",1228],["T_WHITESPACE"," ",1228],["T_DOUBLE_ARROW","=>",1228],["T_WHITESPACE"," ",1228],["T_VARIABLE","$this",1228],["T_OBJECT_OPERATOR","->",1228],["T_STRING","_entityTypeId",1228],",",["T_WHITESPACE","\n                            ",1228],["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",1229],["T_WHITESPACE","   ",1229],["T_DOUBLE_ARROW","=>",1229],["T_WHITESPACE"," ",1229],["T_VARIABLE","$attributeId",1229],",",["T_WHITESPACE","\n                            ",1229],["T_CONSTANT_ENCAPSED_STRING","'store_id'",1230],["T_WHITESPACE","       ",1230],["T_DOUBLE_ARROW","=>",1230],["T_WHITESPACE"," ",1230],["T_VARIABLE","$storeId",1230],",",["T_WHITESPACE","\n                            ",1230],["T_CONSTANT_ENCAPSED_STRING","'value'",1231],["T_WHITESPACE","          ",1231],["T_DOUBLE_ARROW","=>",1231],["T_WHITESPACE"," ",1231],["T_VARIABLE","$storeValue",1231],["T_WHITESPACE","\n                        ",1231],")",";",["T_WHITESPACE","\n                    ",1232],"}",["T_WHITESPACE","\n\n                    ",1233],["T_IF","if",1235],["T_WHITESPACE"," ",1235],"(",["T_VARIABLE","$attributeId",1235],["T_WHITESPACE"," ",1235],["T_IS_EQUAL","==",1235],["T_WHITESPACE"," ",1235],["T_VARIABLE","$this",1235],["T_OBJECT_OPERATOR","->",1235],["T_STRING","_getUrlKeyAttributeId",1235],"(",")",")",["T_WHITESPACE"," ",1235],"{",["T_WHITESPACE","\n                        ",1235],["T_COMMENT","\/*\n                        If the store based values are not provided for a particular store,\n                        we default to the default scope values.\n                        In this case, remove all the existing store based values stored in the table.\n                        *\/",1236],["T_WHITESPACE","\n                        ",1240],["T_VARIABLE","$where",1241],["T_WHITESPACE"," ",1241],"=",["T_WHITESPACE"," ",1241],["T_VARIABLE","$this",1241],["T_OBJECT_OPERATOR","->",1241],["T_STRING","_connection",1241],["T_OBJECT_OPERATOR","->",1241],["T_STRING","quoteInto",1241],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id NOT IN (?)'",1241],",",["T_WHITESPACE"," ",1241],["T_STRING","array_keys",1241],"(",["T_VARIABLE","$storeValues",1241],")",")",["T_WHITESPACE"," ",1241],".",["T_WHITESPACE","\n                            ",1241],["T_VARIABLE","$this",1242],["T_OBJECT_OPERATOR","->",1242],["T_STRING","_connection",1242],["T_OBJECT_OPERATOR","->",1242],["T_STRING","quoteInto",1242],"(",["T_CONSTANT_ENCAPSED_STRING","' AND attribute_id = ?'",1242],",",["T_WHITESPACE"," ",1242],["T_VARIABLE","$attributeId",1242],")",["T_WHITESPACE"," ",1242],".",["T_WHITESPACE","\n                            ",1242],["T_VARIABLE","$this",1243],["T_OBJECT_OPERATOR","->",1243],["T_STRING","_connection",1243],["T_OBJECT_OPERATOR","->",1243],["T_STRING","quoteInto",1243],"(",["T_CONSTANT_ENCAPSED_STRING","' AND entity_id = ?'",1243],",",["T_WHITESPACE"," ",1243],["T_VARIABLE","$productId",1243],")",["T_WHITESPACE"," ",1243],".",["T_WHITESPACE","\n                            ",1243],["T_VARIABLE","$this",1244],["T_OBJECT_OPERATOR","->",1244],["T_STRING","_connection",1244],["T_OBJECT_OPERATOR","->",1244],["T_STRING","quoteInto",1244],"(",["T_CONSTANT_ENCAPSED_STRING","' AND entity_type_id = ?'",1244],",",["T_WHITESPACE"," ",1244],["T_VARIABLE","$this",1244],["T_OBJECT_OPERATOR","->",1244],["T_STRING","_entityTypeId",1244],")",";",["T_WHITESPACE","\n\n                        ",1244],["T_VARIABLE","$this",1246],["T_OBJECT_OPERATOR","->",1246],["T_STRING","_connection",1246],["T_OBJECT_OPERATOR","->",1246],["T_STRING","delete",1246],"(",["T_WHITESPACE","\n                            ",1246],["T_VARIABLE","$tableName",1247],",",["T_WHITESPACE"," ",1247],["T_VARIABLE","$where",1247],["T_WHITESPACE","\n                        ",1247],")",";",["T_WHITESPACE","\n                    ",1248],"}",["T_WHITESPACE","\n                ",1249],"}",["T_WHITESPACE","\n            ",1250],"}",["T_WHITESPACE","\n            ",1251],["T_VARIABLE","$this",1252],["T_OBJECT_OPERATOR","->",1252],["T_STRING","_connection",1252],["T_OBJECT_OPERATOR","->",1252],["T_STRING","insertOnDuplicate",1252],"(",["T_VARIABLE","$tableName",1252],",",["T_WHITESPACE"," ",1252],["T_VARIABLE","$tableData",1252],",",["T_WHITESPACE"," ",1252],["T_ARRAY","array",1252],"(",["T_CONSTANT_ENCAPSED_STRING","'value'",1252],")",")",";",["T_WHITESPACE","\n        ",1252],"}",["T_WHITESPACE","\n        ",1253],["T_RETURN","return",1254],["T_WHITESPACE"," ",1254],["T_VARIABLE","$this",1254],";",["T_WHITESPACE","\n    ",1254],"}",["T_WHITESPACE","\n\n    ",1255],["T_DOC_COMMENT","\/**\n     * Save product categories.\n     *\n     * @param array $categoriesData\n     * @return Mage_ImportExport_Model_Import_Entity_Product\n     *\/",1257],["T_WHITESPACE","\n    ",1262],["T_PROTECTED","protected",1263],["T_WHITESPACE"," ",1263],["T_FUNCTION","function",1263],["T_WHITESPACE"," ",1263],["T_STRING","_saveProductCategories",1263],"(",["T_ARRAY","array",1263],["T_WHITESPACE"," ",1263],["T_VARIABLE","$categoriesData",1263],")",["T_WHITESPACE","\n    ",1263],"{",["T_WHITESPACE","\n        ",1264],["T_STATIC","static",1265],["T_WHITESPACE"," ",1265],["T_VARIABLE","$tableName",1265],["T_WHITESPACE"," ",1265],"=",["T_WHITESPACE"," ",1265],["T_STRING","null",1265],";",["T_WHITESPACE","\n\n        ",1265],["T_IF","if",1267],["T_WHITESPACE"," ",1267],"(","!",["T_VARIABLE","$tableName",1267],")",["T_WHITESPACE"," ",1267],"{",["T_WHITESPACE","\n            ",1267],["T_VARIABLE","$tableName",1268],["T_WHITESPACE"," ",1268],"=",["T_WHITESPACE"," ",1268],["T_STRING","Mage",1268],["T_DOUBLE_COLON","::",1268],["T_STRING","getModel",1268],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport\/import_proxy_product_resource'",1268],")",["T_OBJECT_OPERATOR","->",1268],["T_STRING","getProductCategoryTable",1268],"(",")",";",["T_WHITESPACE","\n        ",1268],"}",["T_WHITESPACE","\n        ",1269],["T_IF","if",1270],["T_WHITESPACE"," ",1270],"(",["T_VARIABLE","$categoriesData",1270],")",["T_WHITESPACE"," ",1270],"{",["T_WHITESPACE","\n            ",1270],["T_VARIABLE","$categoriesIn",1271],["T_WHITESPACE"," ",1271],"=",["T_WHITESPACE"," ",1271],["T_ARRAY","array",1271],"(",")",";",["T_WHITESPACE","\n            ",1271],["T_VARIABLE","$delProductId",1272],["T_WHITESPACE"," ",1272],"=",["T_WHITESPACE"," ",1272],["T_ARRAY","array",1272],"(",")",";",["T_WHITESPACE","\n\n            ",1272],["T_FOREACH","foreach",1274],["T_WHITESPACE"," ",1274],"(",["T_VARIABLE","$categoriesData",1274],["T_WHITESPACE"," ",1274],["T_AS","as",1274],["T_WHITESPACE"," ",1274],["T_VARIABLE","$delSku",1274],["T_WHITESPACE"," ",1274],["T_DOUBLE_ARROW","=>",1274],["T_WHITESPACE"," ",1274],["T_VARIABLE","$categories",1274],")",["T_WHITESPACE"," ",1274],"{",["T_WHITESPACE","\n                ",1274],["T_VARIABLE","$productId",1275],["T_WHITESPACE","      ",1275],"=",["T_WHITESPACE"," ",1275],["T_VARIABLE","$this",1275],["T_OBJECT_OPERATOR","->",1275],["T_STRING","_newSku",1275],"[",["T_VARIABLE","$delSku",1275],"]","[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1275],"]",";",["T_WHITESPACE","\n                ",1275],["T_VARIABLE","$delProductId",1276],"[","]",["T_WHITESPACE"," ",1276],"=",["T_WHITESPACE"," ",1276],["T_VARIABLE","$productId",1276],";",["T_WHITESPACE","\n\n                ",1276],["T_FOREACH","foreach",1278],["T_WHITESPACE"," ",1278],"(",["T_STRING","array_keys",1278],"(",["T_VARIABLE","$categories",1278],")",["T_WHITESPACE"," ",1278],["T_AS","as",1278],["T_WHITESPACE"," ",1278],["T_VARIABLE","$categoryId",1278],")",["T_WHITESPACE"," ",1278],"{",["T_WHITESPACE","\n                    ",1278],["T_VARIABLE","$categoriesIn",1279],"[","]",["T_WHITESPACE"," ",1279],"=",["T_WHITESPACE"," ",1279],["T_ARRAY","array",1279],"(",["T_CONSTANT_ENCAPSED_STRING","'product_id'",1279],["T_WHITESPACE"," ",1279],["T_DOUBLE_ARROW","=>",1279],["T_WHITESPACE"," ",1279],["T_VARIABLE","$productId",1279],",",["T_WHITESPACE"," ",1279],["T_CONSTANT_ENCAPSED_STRING","'category_id'",1279],["T_WHITESPACE"," ",1279],["T_DOUBLE_ARROW","=>",1279],["T_WHITESPACE"," ",1279],["T_VARIABLE","$categoryId",1279],",",["T_WHITESPACE"," ",1279],["T_CONSTANT_ENCAPSED_STRING","'position'",1279],["T_WHITESPACE"," ",1279],["T_DOUBLE_ARROW","=>",1279],["T_WHITESPACE"," ",1279],["T_LNUMBER","1",1279],")",";",["T_WHITESPACE","\n                ",1279],"}",["T_WHITESPACE","\n            ",1280],"}",["T_WHITESPACE","\n            ",1281],["T_IF","if",1282],["T_WHITESPACE"," ",1282],"(",["T_STRING","Mage_ImportExport_Model_Import",1282],["T_DOUBLE_COLON","::",1282],["T_STRING","BEHAVIOR_APPEND",1282],["T_WHITESPACE"," ",1282],["T_IS_NOT_EQUAL","!=",1282],["T_WHITESPACE"," ",1282],["T_VARIABLE","$this",1282],["T_OBJECT_OPERATOR","->",1282],["T_STRING","getBehavior",1282],"(",")",")",["T_WHITESPACE"," ",1282],"{",["T_WHITESPACE","\n                ",1282],["T_VARIABLE","$this",1283],["T_OBJECT_OPERATOR","->",1283],["T_STRING","_connection",1283],["T_OBJECT_OPERATOR","->",1283],["T_STRING","delete",1283],"(",["T_WHITESPACE","\n                    ",1283],["T_VARIABLE","$tableName",1284],",",["T_WHITESPACE","\n                    ",1284],["T_VARIABLE","$this",1285],["T_OBJECT_OPERATOR","->",1285],["T_STRING","_connection",1285],["T_OBJECT_OPERATOR","->",1285],["T_STRING","quoteInto",1285],"(",["T_CONSTANT_ENCAPSED_STRING","'product_id IN (?)'",1285],",",["T_WHITESPACE"," ",1285],["T_VARIABLE","$delProductId",1285],")",["T_WHITESPACE","\n                ",1285],")",";",["T_WHITESPACE","\n            ",1286],"}",["T_WHITESPACE","\n            ",1287],["T_IF","if",1288],["T_WHITESPACE"," ",1288],"(",["T_VARIABLE","$categoriesIn",1288],")",["T_WHITESPACE"," ",1288],"{",["T_WHITESPACE","\n                ",1288],["T_VARIABLE","$this",1289],["T_OBJECT_OPERATOR","->",1289],["T_STRING","_connection",1289],["T_OBJECT_OPERATOR","->",1289],["T_STRING","insertOnDuplicate",1289],"(",["T_VARIABLE","$tableName",1289],",",["T_WHITESPACE"," ",1289],["T_VARIABLE","$categoriesIn",1289],",",["T_WHITESPACE"," ",1289],["T_ARRAY","array",1289],"(",["T_CONSTANT_ENCAPSED_STRING","'position'",1289],")",")",";",["T_WHITESPACE","\n            ",1289],"}",["T_WHITESPACE","\n        ",1290],"}",["T_WHITESPACE","\n        ",1291],["T_RETURN","return",1292],["T_WHITESPACE"," ",1292],["T_VARIABLE","$this",1292],";",["T_WHITESPACE","\n    ",1292],"}",["T_WHITESPACE","\n\n    ",1293],["T_DOC_COMMENT","\/**\n     * Update and insert data in entity table.\n     *\n     * @param array $entityRowsIn Row for insert\n     * @param array $entityRowsUp Row for update\n     * @return Mage_ImportExport_Model_Import_Entity_Product\n     *\/",1295],["T_WHITESPACE","\n    ",1301],["T_PROTECTED","protected",1302],["T_WHITESPACE"," ",1302],["T_FUNCTION","function",1302],["T_WHITESPACE"," ",1302],["T_STRING","_saveProductEntity",1302],"(",["T_ARRAY","array",1302],["T_WHITESPACE"," ",1302],["T_VARIABLE","$entityRowsIn",1302],",",["T_WHITESPACE"," ",1302],["T_ARRAY","array",1302],["T_WHITESPACE"," ",1302],["T_VARIABLE","$entityRowsUp",1302],")",["T_WHITESPACE","\n    ",1302],"{",["T_WHITESPACE","\n        ",1303],["T_STATIC","static",1304],["T_WHITESPACE"," ",1304],["T_VARIABLE","$entityTable",1304],["T_WHITESPACE"," ",1304],"=",["T_WHITESPACE"," ",1304],["T_STRING","null",1304],";",["T_WHITESPACE","\n\n        ",1304],["T_IF","if",1306],["T_WHITESPACE"," ",1306],"(","!",["T_VARIABLE","$entityTable",1306],")",["T_WHITESPACE"," ",1306],"{",["T_WHITESPACE","\n            ",1306],["T_VARIABLE","$entityTable",1307],["T_WHITESPACE"," ",1307],"=",["T_WHITESPACE"," ",1307],["T_STRING","Mage",1307],["T_DOUBLE_COLON","::",1307],["T_STRING","getModel",1307],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport\/import_proxy_product_resource'",1307],")",["T_OBJECT_OPERATOR","->",1307],["T_STRING","getEntityTable",1307],"(",")",";",["T_WHITESPACE","\n        ",1307],"}",["T_WHITESPACE","\n        ",1308],["T_IF","if",1309],["T_WHITESPACE"," ",1309],"(",["T_VARIABLE","$entityRowsUp",1309],")",["T_WHITESPACE"," ",1309],"{",["T_WHITESPACE","\n            ",1309],["T_VARIABLE","$this",1310],["T_OBJECT_OPERATOR","->",1310],["T_STRING","_connection",1310],["T_OBJECT_OPERATOR","->",1310],["T_STRING","insertOnDuplicate",1310],"(",["T_WHITESPACE","\n                ",1310],["T_VARIABLE","$entityTable",1311],",",["T_WHITESPACE","\n                ",1311],["T_VARIABLE","$entityRowsUp",1312],",",["T_WHITESPACE","\n                ",1312],["T_ARRAY","array",1313],"(",["T_CONSTANT_ENCAPSED_STRING","'updated_at'",1313],")",["T_WHITESPACE","\n            ",1313],")",";",["T_WHITESPACE","\n        ",1314],"}",["T_WHITESPACE","\n        ",1315],["T_IF","if",1316],["T_WHITESPACE"," ",1316],"(",["T_VARIABLE","$entityRowsIn",1316],")",["T_WHITESPACE"," ",1316],"{",["T_WHITESPACE","\n            ",1316],["T_VARIABLE","$this",1317],["T_OBJECT_OPERATOR","->",1317],["T_STRING","_connection",1317],["T_OBJECT_OPERATOR","->",1317],["T_STRING","insertMultiple",1317],"(",["T_VARIABLE","$entityTable",1317],",",["T_WHITESPACE"," ",1317],["T_VARIABLE","$entityRowsIn",1317],")",";",["T_WHITESPACE","\n\n            ",1317],["T_VARIABLE","$newProducts",1319],["T_WHITESPACE"," ",1319],"=",["T_WHITESPACE"," ",1319],["T_VARIABLE","$this",1319],["T_OBJECT_OPERATOR","->",1319],["T_STRING","_connection",1319],["T_OBJECT_OPERATOR","->",1319],["T_STRING","fetchPairs",1319],"(",["T_VARIABLE","$this",1319],["T_OBJECT_OPERATOR","->",1319],["T_STRING","_connection",1319],["T_OBJECT_OPERATOR","->",1319],["T_STRING","select",1319],"(",")",["T_WHITESPACE","\n                ",1319],["T_OBJECT_OPERATOR","->",1320],["T_STRING","from",1320],"(",["T_VARIABLE","$entityTable",1320],",",["T_WHITESPACE"," ",1320],["T_ARRAY","array",1320],"(",["T_CONSTANT_ENCAPSED_STRING","'sku'",1320],",",["T_WHITESPACE"," ",1320],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1320],")",")",["T_WHITESPACE","\n                ",1320],["T_OBJECT_OPERATOR","->",1321],["T_STRING","where",1321],"(",["T_CONSTANT_ENCAPSED_STRING","'sku IN (?)'",1321],",",["T_WHITESPACE"," ",1321],["T_STRING","array_keys",1321],"(",["T_VARIABLE","$entityRowsIn",1321],")",")",["T_WHITESPACE","\n            ",1321],")",";",["T_WHITESPACE","\n            ",1322],["T_FOREACH","foreach",1323],["T_WHITESPACE"," ",1323],"(",["T_VARIABLE","$newProducts",1323],["T_WHITESPACE"," ",1323],["T_AS","as",1323],["T_WHITESPACE"," ",1323],["T_VARIABLE","$sku",1323],["T_WHITESPACE"," ",1323],["T_DOUBLE_ARROW","=>",1323],["T_WHITESPACE"," ",1323],["T_VARIABLE","$newId",1323],")",["T_WHITESPACE"," ",1323],"{",["T_WHITESPACE"," ",1323],["T_COMMENT","\/\/ fill up entity_id for new products\n",1323],["T_WHITESPACE","                ",1324],["T_VARIABLE","$this",1324],["T_OBJECT_OPERATOR","->",1324],["T_STRING","_newSku",1324],"[",["T_VARIABLE","$sku",1324],"]","[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1324],"]",["T_WHITESPACE"," ",1324],"=",["T_WHITESPACE"," ",1324],["T_VARIABLE","$newId",1324],";",["T_WHITESPACE","\n            ",1324],"}",["T_WHITESPACE","\n        ",1325],"}",["T_WHITESPACE","\n        ",1326],["T_RETURN","return",1327],["T_WHITESPACE"," ",1327],["T_VARIABLE","$this",1327],";",["T_WHITESPACE","\n    ",1327],"}",["T_WHITESPACE","\n\n    ",1328],["T_DOC_COMMENT","\/**\n     * Gather and save information about product entities.\n     *\n     * @return Mage_ImportExport_Model_Import_Entity_Product\n     *\/",1330],["T_WHITESPACE","\n    ",1334],["T_PROTECTED","protected",1335],["T_WHITESPACE"," ",1335],["T_FUNCTION","function",1335],["T_WHITESPACE"," ",1335],["T_STRING","_saveProducts",1335],"(",")",["T_WHITESPACE","\n    ",1335],"{",["T_WHITESPACE","\n        ",1336],["T_VARIABLE","$priceIsGlobal",1337],["T_WHITESPACE","  ",1337],"=",["T_WHITESPACE"," ",1337],["T_STRING","Mage",1337],["T_DOUBLE_COLON","::",1337],["T_STRING","helper",1337],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",1337],")",["T_OBJECT_OPERATOR","->",1337],["T_STRING","isPriceGlobal",1337],"(",")",";",["T_WHITESPACE","\n        ",1337],["T_VARIABLE","$productLimit",1338],["T_WHITESPACE","   ",1338],"=",["T_WHITESPACE"," ",1338],["T_STRING","null",1338],";",["T_WHITESPACE","\n        ",1338],["T_VARIABLE","$productsQty",1339],["T_WHITESPACE","    ",1339],"=",["T_WHITESPACE"," ",1339],["T_STRING","null",1339],";",["T_WHITESPACE","\n\n        ",1339],["T_WHILE","while",1341],["T_WHITESPACE"," ",1341],"(",["T_VARIABLE","$bunch",1341],["T_WHITESPACE"," ",1341],"=",["T_WHITESPACE"," ",1341],["T_VARIABLE","$this",1341],["T_OBJECT_OPERATOR","->",1341],["T_STRING","_dataSourceModel",1341],["T_OBJECT_OPERATOR","->",1341],["T_STRING","getNextBunch",1341],"(",")",")",["T_WHITESPACE"," ",1341],"{",["T_WHITESPACE","\n            ",1341],["T_VARIABLE","$entityRowsIn",1342],["T_WHITESPACE"," ",1342],"=",["T_WHITESPACE"," ",1342],["T_ARRAY","array",1342],"(",")",";",["T_WHITESPACE","\n            ",1342],["T_VARIABLE","$entityRowsUp",1343],["T_WHITESPACE"," ",1343],"=",["T_WHITESPACE"," ",1343],["T_ARRAY","array",1343],"(",")",";",["T_WHITESPACE","\n            ",1343],["T_VARIABLE","$attributes",1344],["T_WHITESPACE","   ",1344],"=",["T_WHITESPACE"," ",1344],["T_ARRAY","array",1344],"(",")",";",["T_WHITESPACE","\n            ",1344],["T_VARIABLE","$websites",1345],["T_WHITESPACE","     ",1345],"=",["T_WHITESPACE"," ",1345],["T_ARRAY","array",1345],"(",")",";",["T_WHITESPACE","\n            ",1345],["T_VARIABLE","$categories",1346],["T_WHITESPACE","   ",1346],"=",["T_WHITESPACE"," ",1346],["T_ARRAY","array",1346],"(",")",";",["T_WHITESPACE","\n            ",1346],["T_VARIABLE","$tierPrices",1347],["T_WHITESPACE","   ",1347],"=",["T_WHITESPACE"," ",1347],["T_ARRAY","array",1347],"(",")",";",["T_WHITESPACE","\n            ",1347],["T_VARIABLE","$groupPrices",1348],["T_WHITESPACE","  ",1348],"=",["T_WHITESPACE"," ",1348],["T_ARRAY","array",1348],"(",")",";",["T_WHITESPACE","\n            ",1348],["T_VARIABLE","$mediaGallery",1349],["T_WHITESPACE"," ",1349],"=",["T_WHITESPACE"," ",1349],["T_ARRAY","array",1349],"(",")",";",["T_WHITESPACE","\n            ",1349],["T_VARIABLE","$uploadedGalleryFiles",1350],["T_WHITESPACE"," ",1350],"=",["T_WHITESPACE"," ",1350],["T_ARRAY","array",1350],"(",")",";",["T_WHITESPACE","\n            ",1350],["T_VARIABLE","$previousType",1351],["T_WHITESPACE"," ",1351],"=",["T_WHITESPACE"," ",1351],["T_STRING","null",1351],";",["T_WHITESPACE","\n            ",1351],["T_VARIABLE","$previousAttributeSet",1352],["T_WHITESPACE"," ",1352],"=",["T_WHITESPACE"," ",1352],["T_STRING","null",1352],";",["T_WHITESPACE","\n\n            ",1352],["T_FOREACH","foreach",1354],["T_WHITESPACE"," ",1354],"(",["T_VARIABLE","$bunch",1354],["T_WHITESPACE"," ",1354],["T_AS","as",1354],["T_WHITESPACE"," ",1354],["T_VARIABLE","$rowNum",1354],["T_WHITESPACE"," ",1354],["T_DOUBLE_ARROW","=>",1354],["T_WHITESPACE"," ",1354],["T_VARIABLE","$rowData",1354],")",["T_WHITESPACE"," ",1354],"{",["T_WHITESPACE","\n                ",1354],["T_VARIABLE","$this",1355],["T_OBJECT_OPERATOR","->",1355],["T_STRING","_filterRowData",1355],"(",["T_VARIABLE","$rowData",1355],")",";",["T_WHITESPACE","\n                ",1355],["T_IF","if",1356],["T_WHITESPACE"," ",1356],"(","!",["T_VARIABLE","$this",1356],["T_OBJECT_OPERATOR","->",1356],["T_STRING","validateRow",1356],"(",["T_VARIABLE","$rowData",1356],",",["T_WHITESPACE"," ",1356],["T_VARIABLE","$rowNum",1356],")",")",["T_WHITESPACE"," ",1356],"{",["T_WHITESPACE","\n                    ",1356],["T_CONTINUE","continue",1357],";",["T_WHITESPACE","\n                ",1357],"}",["T_WHITESPACE","\n                ",1358],["T_VARIABLE","$rowScope",1359],["T_WHITESPACE"," ",1359],"=",["T_WHITESPACE"," ",1359],["T_VARIABLE","$this",1359],["T_OBJECT_OPERATOR","->",1359],["T_STRING","getRowScope",1359],"(",["T_VARIABLE","$rowData",1359],")",";",["T_WHITESPACE","\n\n                ",1359],["T_IF","if",1361],["T_WHITESPACE"," ",1361],"(",["T_STRING","self",1361],["T_DOUBLE_COLON","::",1361],["T_STRING","SCOPE_DEFAULT",1361],["T_WHITESPACE"," ",1361],["T_IS_EQUAL","==",1361],["T_WHITESPACE"," ",1361],["T_VARIABLE","$rowScope",1361],")",["T_WHITESPACE"," ",1361],"{",["T_WHITESPACE","\n                    ",1361],["T_VARIABLE","$rowSku",1362],["T_WHITESPACE"," ",1362],"=",["T_WHITESPACE"," ",1362],["T_VARIABLE","$rowData",1362],"[",["T_STRING","self",1362],["T_DOUBLE_COLON","::",1362],["T_STRING","COL_SKU",1362],"]",";",["T_WHITESPACE","\n\n                    ",1362],["T_COMMENT","\/\/ 1. Entity phase\n",1364],["T_WHITESPACE","                    ",1365],["T_IF","if",1365],["T_WHITESPACE"," ",1365],"(",["T_ISSET","isset",1365],"(",["T_VARIABLE","$this",1365],["T_OBJECT_OPERATOR","->",1365],["T_STRING","_oldSku",1365],"[",["T_VARIABLE","$rowSku",1365],"]",")",")",["T_WHITESPACE"," ",1365],"{",["T_WHITESPACE"," ",1365],["T_COMMENT","\/\/ existing row\n",1365],["T_WHITESPACE","                        ",1366],["T_VARIABLE","$entityRowsUp",1366],"[","]",["T_WHITESPACE"," ",1366],"=",["T_WHITESPACE"," ",1366],["T_ARRAY","array",1366],"(",["T_WHITESPACE","\n                            ",1366],["T_CONSTANT_ENCAPSED_STRING","'updated_at'",1367],["T_WHITESPACE"," ",1367],["T_DOUBLE_ARROW","=>",1367],["T_WHITESPACE"," ",1367],["T_STRING","now",1367],"(",")",",",["T_WHITESPACE","\n                            ",1367],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1368],["T_WHITESPACE","  ",1368],["T_DOUBLE_ARROW","=>",1368],["T_WHITESPACE"," ",1368],["T_VARIABLE","$this",1368],["T_OBJECT_OPERATOR","->",1368],["T_STRING","_oldSku",1368],"[",["T_VARIABLE","$rowSku",1368],"]","[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1368],"]",["T_WHITESPACE","\n                        ",1368],")",";",["T_WHITESPACE","\n                    ",1369],"}",["T_WHITESPACE"," ",1370],["T_ELSE","else",1370],["T_WHITESPACE"," ",1370],"{",["T_WHITESPACE"," ",1370],["T_COMMENT","\/\/ new row\n",1370],["T_WHITESPACE","                        ",1371],["T_IF","if",1371],["T_WHITESPACE"," ",1371],"(","!",["T_VARIABLE","$productLimit",1371],["T_WHITESPACE"," ",1371],["T_BOOLEAN_OR","||",1371],["T_WHITESPACE"," ",1371],["T_VARIABLE","$productsQty",1371],["T_WHITESPACE"," ",1371],"<",["T_WHITESPACE"," ",1371],["T_VARIABLE","$productLimit",1371],")",["T_WHITESPACE"," ",1371],"{",["T_WHITESPACE","\n                            ",1371],["T_VARIABLE","$entityRowsIn",1372],"[",["T_VARIABLE","$rowSku",1372],"]",["T_WHITESPACE"," ",1372],"=",["T_WHITESPACE"," ",1372],["T_ARRAY","array",1372],"(",["T_WHITESPACE","\n                                ",1372],["T_CONSTANT_ENCAPSED_STRING","'entity_type_id'",1373],["T_WHITESPACE","   ",1373],["T_DOUBLE_ARROW","=>",1373],["T_WHITESPACE"," ",1373],["T_VARIABLE","$this",1373],["T_OBJECT_OPERATOR","->",1373],["T_STRING","_entityTypeId",1373],",",["T_WHITESPACE","\n                                ",1373],["T_CONSTANT_ENCAPSED_STRING","'attribute_set_id'",1374],["T_WHITESPACE"," ",1374],["T_DOUBLE_ARROW","=>",1374],["T_WHITESPACE"," ",1374],["T_VARIABLE","$this",1374],["T_OBJECT_OPERATOR","->",1374],["T_STRING","_newSku",1374],"[",["T_VARIABLE","$rowSku",1374],"]","[",["T_CONSTANT_ENCAPSED_STRING","'attr_set_id'",1374],"]",",",["T_WHITESPACE","\n                                ",1374],["T_CONSTANT_ENCAPSED_STRING","'type_id'",1375],["T_WHITESPACE","          ",1375],["T_DOUBLE_ARROW","=>",1375],["T_WHITESPACE"," ",1375],["T_VARIABLE","$this",1375],["T_OBJECT_OPERATOR","->",1375],["T_STRING","_newSku",1375],"[",["T_VARIABLE","$rowSku",1375],"]","[",["T_CONSTANT_ENCAPSED_STRING","'type_id'",1375],"]",",",["T_WHITESPACE","\n                                ",1375],["T_CONSTANT_ENCAPSED_STRING","'sku'",1376],["T_WHITESPACE","              ",1376],["T_DOUBLE_ARROW","=>",1376],["T_WHITESPACE"," ",1376],["T_VARIABLE","$rowSku",1376],",",["T_WHITESPACE","\n                                ",1376],["T_CONSTANT_ENCAPSED_STRING","'created_at'",1377],["T_WHITESPACE","       ",1377],["T_DOUBLE_ARROW","=>",1377],["T_WHITESPACE"," ",1377],["T_STRING","now",1377],"(",")",",",["T_WHITESPACE","\n                                ",1377],["T_CONSTANT_ENCAPSED_STRING","'updated_at'",1378],["T_WHITESPACE","       ",1378],["T_DOUBLE_ARROW","=>",1378],["T_WHITESPACE"," ",1378],["T_STRING","now",1378],"(",")",["T_WHITESPACE","\n                            ",1378],")",";",["T_WHITESPACE","\n                            ",1379],["T_VARIABLE","$productsQty",1380],["T_INC","++",1380],";",["T_WHITESPACE","\n                        ",1380],"}",["T_WHITESPACE"," ",1381],["T_ELSE","else",1381],["T_WHITESPACE"," ",1381],"{",["T_WHITESPACE","\n                            ",1381],["T_VARIABLE","$rowSku",1382],["T_WHITESPACE"," ",1382],"=",["T_WHITESPACE"," ",1382],["T_STRING","null",1382],";",["T_WHITESPACE"," ",1382],["T_COMMENT","\/\/ sign for child rows to be skipped\n",1382],["T_WHITESPACE","                            ",1383],["T_VARIABLE","$this",1383],["T_OBJECT_OPERATOR","->",1383],["T_STRING","_rowsToSkip",1383],"[",["T_VARIABLE","$rowNum",1383],"]",["T_WHITESPACE"," ",1383],"=",["T_WHITESPACE"," ",1383],["T_STRING","true",1383],";",["T_WHITESPACE","\n                            ",1383],["T_CONTINUE","continue",1384],";",["T_WHITESPACE","\n                        ",1384],"}",["T_WHITESPACE","\n                    ",1385],"}",["T_WHITESPACE","\n                ",1386],"}",["T_WHITESPACE"," ",1387],["T_ELSEIF","elseif",1387],["T_WHITESPACE"," ",1387],"(",["T_STRING","null",1387],["T_WHITESPACE"," ",1387],["T_IS_IDENTICAL","===",1387],["T_WHITESPACE"," ",1387],["T_VARIABLE","$rowSku",1387],")",["T_WHITESPACE"," ",1387],"{",["T_WHITESPACE","\n                    ",1387],["T_VARIABLE","$this",1388],["T_OBJECT_OPERATOR","->",1388],["T_STRING","_rowsToSkip",1388],"[",["T_VARIABLE","$rowNum",1388],"]",["T_WHITESPACE"," ",1388],"=",["T_WHITESPACE"," ",1388],["T_STRING","true",1388],";",["T_WHITESPACE","\n                    ",1388],["T_CONTINUE","continue",1389],";",["T_WHITESPACE"," ",1389],["T_COMMENT","\/\/ skip rows when SKU is NULL\n",1389],["T_WHITESPACE","                ",1390],"}",["T_WHITESPACE"," ",1390],["T_ELSEIF","elseif",1390],["T_WHITESPACE"," ",1390],"(",["T_STRING","self",1390],["T_DOUBLE_COLON","::",1390],["T_STRING","SCOPE_STORE",1390],["T_WHITESPACE"," ",1390],["T_IS_EQUAL","==",1390],["T_WHITESPACE"," ",1390],["T_VARIABLE","$rowScope",1390],")",["T_WHITESPACE"," ",1390],"{",["T_WHITESPACE"," ",1390],["T_COMMENT","\/\/ set necessary data from SCOPE_DEFAULT row\n",1390],["T_WHITESPACE","                    ",1391],["T_VARIABLE","$rowData",1391],"[",["T_STRING","self",1391],["T_DOUBLE_COLON","::",1391],["T_STRING","COL_TYPE",1391],"]",["T_WHITESPACE","     ",1391],"=",["T_WHITESPACE"," ",1391],["T_VARIABLE","$this",1391],["T_OBJECT_OPERATOR","->",1391],["T_STRING","_newSku",1391],"[",["T_VARIABLE","$rowSku",1391],"]","[",["T_CONSTANT_ENCAPSED_STRING","'type_id'",1391],"]",";",["T_WHITESPACE","\n                    ",1391],["T_VARIABLE","$rowData",1392],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_set_id'",1392],"]",["T_WHITESPACE"," ",1392],"=",["T_WHITESPACE"," ",1392],["T_VARIABLE","$this",1392],["T_OBJECT_OPERATOR","->",1392],["T_STRING","_newSku",1392],"[",["T_VARIABLE","$rowSku",1392],"]","[",["T_CONSTANT_ENCAPSED_STRING","'attr_set_id'",1392],"]",";",["T_WHITESPACE","\n                    ",1392],["T_VARIABLE","$rowData",1393],"[",["T_STRING","self",1393],["T_DOUBLE_COLON","::",1393],["T_STRING","COL_ATTR_SET",1393],"]",["T_WHITESPACE"," ",1393],"=",["T_WHITESPACE"," ",1393],["T_VARIABLE","$this",1393],["T_OBJECT_OPERATOR","->",1393],["T_STRING","_newSku",1393],"[",["T_VARIABLE","$rowSku",1393],"]","[",["T_CONSTANT_ENCAPSED_STRING","'attr_set_code'",1393],"]",";",["T_WHITESPACE","\n                ",1393],"}",["T_WHITESPACE","\n                ",1394],["T_IF","if",1395],["T_WHITESPACE"," ",1395],"(","!",["T_EMPTY","empty",1395],"(",["T_VARIABLE","$rowData",1395],"[",["T_CONSTANT_ENCAPSED_STRING","'_product_websites'",1395],"]",")",")",["T_WHITESPACE"," ",1395],"{",["T_WHITESPACE"," ",1395],["T_COMMENT","\/\/ 2. Product-to-Website phase\n",1395],["T_WHITESPACE","                    ",1396],["T_VARIABLE","$websites",1396],"[",["T_VARIABLE","$rowSku",1396],"]","[",["T_VARIABLE","$this",1396],["T_OBJECT_OPERATOR","->",1396],["T_STRING","_websiteCodeToId",1396],"[",["T_VARIABLE","$rowData",1396],"[",["T_CONSTANT_ENCAPSED_STRING","'_product_websites'",1396],"]","]","]",["T_WHITESPACE"," ",1396],"=",["T_WHITESPACE"," ",1396],["T_STRING","true",1396],";",["T_WHITESPACE","\n                ",1396],"}",["T_WHITESPACE","\n\n                ",1397],["T_COMMENT","\/\/ 3. Categories phase\n",1399],["T_WHITESPACE","                ",1400],["T_VARIABLE","$categoryPath",1400],["T_WHITESPACE"," ",1400],"=",["T_WHITESPACE"," ",1400],["T_EMPTY","empty",1400],"(",["T_VARIABLE","$rowData",1400],"[",["T_STRING","self",1400],["T_DOUBLE_COLON","::",1400],["T_STRING","COL_CATEGORY",1400],"]",")",["T_WHITESPACE"," ",1400],"?",["T_WHITESPACE"," ",1400],["T_CONSTANT_ENCAPSED_STRING","''",1400],["T_WHITESPACE"," ",1400],":",["T_WHITESPACE"," ",1400],["T_VARIABLE","$rowData",1400],"[",["T_STRING","self",1400],["T_DOUBLE_COLON","::",1400],["T_STRING","COL_CATEGORY",1400],"]",";",["T_WHITESPACE","\n                ",1400],["T_IF","if",1401],["T_WHITESPACE"," ",1401],"(","!",["T_EMPTY","empty",1401],"(",["T_VARIABLE","$rowData",1401],"[",["T_STRING","self",1401],["T_DOUBLE_COLON","::",1401],["T_STRING","COL_ROOT_CATEGORY",1401],"]",")",")",["T_WHITESPACE"," ",1401],"{",["T_WHITESPACE","\n                    ",1401],["T_VARIABLE","$categoryId",1402],["T_WHITESPACE"," ",1402],"=",["T_WHITESPACE"," ",1402],["T_VARIABLE","$this",1402],["T_OBJECT_OPERATOR","->",1402],["T_STRING","_categoriesWithRoots",1402],"[",["T_VARIABLE","$rowData",1402],"[",["T_STRING","self",1402],["T_DOUBLE_COLON","::",1402],["T_STRING","COL_ROOT_CATEGORY",1402],"]","]","[",["T_VARIABLE","$categoryPath",1402],"]",";",["T_WHITESPACE","\n                    ",1402],["T_VARIABLE","$categories",1403],"[",["T_VARIABLE","$rowSku",1403],"]","[",["T_VARIABLE","$categoryId",1403],"]",["T_WHITESPACE"," ",1403],"=",["T_WHITESPACE"," ",1403],["T_STRING","true",1403],";",["T_WHITESPACE","\n                ",1403],"}",["T_WHITESPACE"," ",1404],["T_ELSEIF","elseif",1404],["T_WHITESPACE"," ",1404],"(","!",["T_EMPTY","empty",1404],"(",["T_VARIABLE","$categoryPath",1404],")",")",["T_WHITESPACE"," ",1404],"{",["T_WHITESPACE","\n                    ",1404],["T_VARIABLE","$categories",1405],"[",["T_VARIABLE","$rowSku",1405],"]","[",["T_VARIABLE","$this",1405],["T_OBJECT_OPERATOR","->",1405],["T_STRING","_categories",1405],"[",["T_VARIABLE","$categoryPath",1405],"]","]",["T_WHITESPACE"," ",1405],"=",["T_WHITESPACE"," ",1405],["T_STRING","true",1405],";",["T_WHITESPACE","\n                ",1405],"}",["T_WHITESPACE","\n\n                ",1406],["T_IF","if",1408],["T_WHITESPACE"," ",1408],"(","!",["T_EMPTY","empty",1408],"(",["T_VARIABLE","$rowData",1408],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_website'",1408],"]",")",")",["T_WHITESPACE"," ",1408],"{",["T_WHITESPACE"," ",1408],["T_COMMENT","\/\/ 4.1. Tier prices phase\n",1408],["T_WHITESPACE","                    ",1409],["T_VARIABLE","$tierPrices",1409],"[",["T_VARIABLE","$rowSku",1409],"]","[","]",["T_WHITESPACE"," ",1409],"=",["T_WHITESPACE"," ",1409],["T_ARRAY","array",1409],"(",["T_WHITESPACE","\n                        ",1409],["T_CONSTANT_ENCAPSED_STRING","'all_groups'",1410],["T_WHITESPACE","        ",1410],["T_DOUBLE_ARROW","=>",1410],["T_WHITESPACE"," ",1410],["T_VARIABLE","$rowData",1410],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_customer_group'",1410],"]",["T_WHITESPACE"," ",1410],["T_IS_EQUAL","==",1410],["T_WHITESPACE"," ",1410],["T_STRING","self",1410],["T_DOUBLE_COLON","::",1410],["T_STRING","VALUE_ALL",1410],",",["T_WHITESPACE","\n                        ",1410],["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",1411],["T_WHITESPACE"," ",1411],["T_DOUBLE_ARROW","=>",1411],["T_WHITESPACE"," ",1411],"(",["T_VARIABLE","$rowData",1411],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_customer_group'",1411],"]",["T_WHITESPACE"," ",1411],["T_IS_EQUAL","==",1411],["T_WHITESPACE"," ",1411],["T_STRING","self",1411],["T_DOUBLE_COLON","::",1411],["T_STRING","VALUE_ALL",1411],")",["T_WHITESPACE","\n                            ",1411],"?",["T_WHITESPACE"," ",1412],["T_LNUMBER","0",1412],["T_WHITESPACE"," ",1412],":",["T_WHITESPACE"," ",1412],["T_VARIABLE","$rowData",1412],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_customer_group'",1412],"]",",",["T_WHITESPACE","\n                        ",1412],["T_CONSTANT_ENCAPSED_STRING","'qty'",1413],["T_WHITESPACE","               ",1413],["T_DOUBLE_ARROW","=>",1413],["T_WHITESPACE"," ",1413],["T_VARIABLE","$rowData",1413],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_qty'",1413],"]",",",["T_WHITESPACE","\n                        ",1413],["T_CONSTANT_ENCAPSED_STRING","'value'",1414],["T_WHITESPACE","             ",1414],["T_DOUBLE_ARROW","=>",1414],["T_WHITESPACE"," ",1414],["T_VARIABLE","$rowData",1414],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_price'",1414],"]",",",["T_WHITESPACE","\n                        ",1414],["T_CONSTANT_ENCAPSED_STRING","'website_id'",1415],["T_WHITESPACE","        ",1415],["T_DOUBLE_ARROW","=>",1415],["T_WHITESPACE"," ",1415],"(",["T_STRING","self",1415],["T_DOUBLE_COLON","::",1415],["T_STRING","VALUE_ALL",1415],["T_WHITESPACE"," ",1415],["T_IS_EQUAL","==",1415],["T_WHITESPACE"," ",1415],["T_VARIABLE","$rowData",1415],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_website'",1415],"]",["T_WHITESPACE"," ",1415],["T_BOOLEAN_OR","||",1415],["T_WHITESPACE"," ",1415],["T_VARIABLE","$priceIsGlobal",1415],")",["T_WHITESPACE","\n                            ",1415],"?",["T_WHITESPACE"," ",1416],["T_LNUMBER","0",1416],["T_WHITESPACE"," ",1416],":",["T_WHITESPACE"," ",1416],["T_VARIABLE","$this",1416],["T_OBJECT_OPERATOR","->",1416],["T_STRING","_websiteCodeToId",1416],"[",["T_VARIABLE","$rowData",1416],"[",["T_CONSTANT_ENCAPSED_STRING","'_tier_price_website'",1416],"]","]",["T_WHITESPACE","\n                    ",1416],")",";",["T_WHITESPACE","\n                ",1417],"}",["T_WHITESPACE","\n                ",1418],["T_IF","if",1419],["T_WHITESPACE"," ",1419],"(","!",["T_EMPTY","empty",1419],"(",["T_VARIABLE","$rowData",1419],"[",["T_CONSTANT_ENCAPSED_STRING","'_group_price_website'",1419],"]",")",")",["T_WHITESPACE"," ",1419],"{",["T_WHITESPACE"," ",1419],["T_COMMENT","\/\/ 4.2. Group prices phase\n",1419],["T_WHITESPACE","                    ",1420],["T_VARIABLE","$groupPrices",1420],"[",["T_VARIABLE","$rowSku",1420],"]","[","]",["T_WHITESPACE"," ",1420],"=",["T_WHITESPACE"," ",1420],["T_ARRAY","array",1420],"(",["T_WHITESPACE","\n                        ",1420],["T_CONSTANT_ENCAPSED_STRING","'all_groups'",1421],["T_WHITESPACE","        ",1421],["T_DOUBLE_ARROW","=>",1421],["T_WHITESPACE"," ",1421],["T_VARIABLE","$rowData",1421],"[",["T_CONSTANT_ENCAPSED_STRING","'_group_price_customer_group'",1421],"]",["T_WHITESPACE"," ",1421],["T_IS_EQUAL","==",1421],["T_WHITESPACE"," ",1421],["T_STRING","self",1421],["T_DOUBLE_COLON","::",1421],["T_STRING","VALUE_ALL",1421],",",["T_WHITESPACE","\n                        ",1421],["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",1422],["T_WHITESPACE"," ",1422],["T_DOUBLE_ARROW","=>",1422],["T_WHITESPACE"," ",1422],"(",["T_VARIABLE","$rowData",1422],"[",["T_CONSTANT_ENCAPSED_STRING","'_group_price_customer_group'",1422],"]",["T_WHITESPACE"," ",1422],["T_IS_EQUAL","==",1422],["T_WHITESPACE"," ",1422],["T_STRING","self",1422],["T_DOUBLE_COLON","::",1422],["T_STRING","VALUE_ALL",1422],")",["T_WHITESPACE","\n                            ",1422],"?",["T_WHITESPACE"," ",1423],["T_LNUMBER","0",1423],["T_WHITESPACE"," ",1423],":",["T_WHITESPACE"," ",1423],["T_VARIABLE","$rowData",1423],"[",["T_CONSTANT_ENCAPSED_STRING","'_group_price_customer_group'",1423],"]",",",["T_WHITESPACE","\n                        ",1423],["T_CONSTANT_ENCAPSED_STRING","'value'",1424],["T_WHITESPACE","             ",1424],["T_DOUBLE_ARROW","=>",1424],["T_WHITESPACE"," ",1424],["T_VARIABLE","$rowData",1424],"[",["T_CONSTANT_ENCAPSED_STRING","'_group_price_price'",1424],"]",",",["T_WHITESPACE","\n                        ",1424],["T_CONSTANT_ENCAPSED_STRING","'website_id'",1425],["T_WHITESPACE","        ",1425],["T_DOUBLE_ARROW","=>",1425],["T_WHITESPACE"," ",1425],"(",["T_STRING","self",1425],["T_DOUBLE_COLON","::",1425],["T_STRING","VALUE_ALL",1425],["T_WHITESPACE"," ",1425],["T_IS_EQUAL","==",1425],["T_WHITESPACE"," ",1425],["T_VARIABLE","$rowData",1425],"[",["T_CONSTANT_ENCAPSED_STRING","'_group_price_website'",1425],"]",["T_WHITESPACE"," ",1425],["T_BOOLEAN_OR","||",1425],["T_WHITESPACE"," ",1425],["T_VARIABLE","$priceIsGlobal",1425],")",["T_WHITESPACE","\n                            ",1425],"?",["T_WHITESPACE"," ",1426],["T_LNUMBER","0",1426],["T_WHITESPACE"," ",1426],":",["T_WHITESPACE"," ",1426],["T_VARIABLE","$this",1426],["T_OBJECT_OPERATOR","->",1426],["T_STRING","_websiteCodeToId",1426],"[",["T_VARIABLE","$rowData",1426],"[",["T_CONSTANT_ENCAPSED_STRING","'_group_price_website'",1426],"]","]",["T_WHITESPACE","\n                    ",1426],")",";",["T_WHITESPACE","\n                ",1427],"}",["T_WHITESPACE","\n                ",1428],["T_FOREACH","foreach",1429],["T_WHITESPACE"," ",1429],"(",["T_VARIABLE","$this",1429],["T_OBJECT_OPERATOR","->",1429],["T_STRING","_imagesArrayKeys",1429],["T_WHITESPACE"," ",1429],["T_AS","as",1429],["T_WHITESPACE"," ",1429],["T_VARIABLE","$imageCol",1429],")",["T_WHITESPACE"," ",1429],"{",["T_WHITESPACE","\n                    ",1429],["T_IF","if",1430],["T_WHITESPACE"," ",1430],"(","!",["T_EMPTY","empty",1430],"(",["T_VARIABLE","$rowData",1430],"[",["T_VARIABLE","$imageCol",1430],"]",")",")",["T_WHITESPACE"," ",1430],"{",["T_WHITESPACE"," ",1430],["T_COMMENT","\/\/ 5. Media gallery phase\n",1430],["T_WHITESPACE","                        ",1431],["T_IF","if",1431],["T_WHITESPACE"," ",1431],"(","!",["T_STRING","array_key_exists",1431],"(",["T_VARIABLE","$rowData",1431],"[",["T_VARIABLE","$imageCol",1431],"]",",",["T_WHITESPACE"," ",1431],["T_VARIABLE","$uploadedGalleryFiles",1431],")",")",["T_WHITESPACE"," ",1431],"{",["T_WHITESPACE","\n                            ",1431],["T_VARIABLE","$uploadedGalleryFiles",1432],"[",["T_VARIABLE","$rowData",1432],"[",["T_VARIABLE","$imageCol",1432],"]","]",["T_WHITESPACE"," ",1432],"=",["T_WHITESPACE"," ",1432],["T_VARIABLE","$this",1432],["T_OBJECT_OPERATOR","->",1432],["T_STRING","_uploadMediaFiles",1432],"(",["T_VARIABLE","$rowData",1432],"[",["T_VARIABLE","$imageCol",1432],"]",")",";",["T_WHITESPACE","\n                        ",1432],"}",["T_WHITESPACE","\n                        ",1433],["T_VARIABLE","$rowData",1434],"[",["T_VARIABLE","$imageCol",1434],"]",["T_WHITESPACE"," ",1434],"=",["T_WHITESPACE"," ",1434],["T_VARIABLE","$uploadedGalleryFiles",1434],"[",["T_VARIABLE","$rowData",1434],"[",["T_VARIABLE","$imageCol",1434],"]","]",";",["T_WHITESPACE","\n                    ",1434],"}",["T_WHITESPACE","\n                ",1435],"}",["T_WHITESPACE","\n                ",1436],["T_IF","if",1437],["T_WHITESPACE"," ",1437],"(","!",["T_EMPTY","empty",1437],"(",["T_VARIABLE","$rowData",1437],"[",["T_CONSTANT_ENCAPSED_STRING","'_media_image'",1437],"]",")",")",["T_WHITESPACE"," ",1437],"{",["T_WHITESPACE","\n                    ",1437],["T_VARIABLE","$mediaGallery",1438],"[",["T_VARIABLE","$rowSku",1438],"]","[","]",["T_WHITESPACE"," ",1438],"=",["T_WHITESPACE"," ",1438],["T_ARRAY","array",1438],"(",["T_WHITESPACE","\n                        ",1438],["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",1439],["T_WHITESPACE"," ",1439],["T_DOUBLE_ARROW","=>",1439],["T_WHITESPACE"," ",1439],["T_ISSET","isset",1439],"(",["T_VARIABLE","$rowData",1439],"[",["T_CONSTANT_ENCAPSED_STRING","'_media_attribute_id'",1439],"]",")",["T_WHITESPACE"," ",1439],"?",["T_WHITESPACE"," ",1439],["T_VARIABLE","$rowData",1439],"[",["T_CONSTANT_ENCAPSED_STRING","'_media_attribute_id'",1439],"]",["T_WHITESPACE"," ",1439],":",["T_WHITESPACE"," ",1439],["T_CONSTANT_ENCAPSED_STRING","''",1439],",",["T_WHITESPACE","\n                        ",1439],["T_CONSTANT_ENCAPSED_STRING","'label'",1440],["T_WHITESPACE","        ",1440],["T_DOUBLE_ARROW","=>",1440],["T_WHITESPACE"," ",1440],["T_ISSET","isset",1440],"(",["T_VARIABLE","$rowData",1440],"[",["T_CONSTANT_ENCAPSED_STRING","'_media_lable'",1440],"]",")",["T_WHITESPACE"," ",1440],"?",["T_WHITESPACE"," ",1440],["T_VARIABLE","$rowData",1440],"[",["T_CONSTANT_ENCAPSED_STRING","'_media_lable'",1440],"]",["T_WHITESPACE"," ",1440],":",["T_WHITESPACE"," ",1440],["T_CONSTANT_ENCAPSED_STRING","''",1440],",",["T_WHITESPACE","\n                        ",1440],["T_CONSTANT_ENCAPSED_STRING","'position'",1441],["T_WHITESPACE","     ",1441],["T_DOUBLE_ARROW","=>",1441],["T_WHITESPACE"," ",1441],["T_ISSET","isset",1441],"(",["T_VARIABLE","$rowData",1441],"[",["T_CONSTANT_ENCAPSED_STRING","'_media_position'",1441],"]",")",["T_WHITESPACE"," ",1441],"?",["T_WHITESPACE"," ",1441],["T_VARIABLE","$rowData",1441],"[",["T_CONSTANT_ENCAPSED_STRING","'_media_position'",1441],"]",["T_WHITESPACE"," ",1441],":",["T_WHITESPACE"," ",1441],["T_CONSTANT_ENCAPSED_STRING","''",1441],",",["T_WHITESPACE","\n                        ",1441],["T_CONSTANT_ENCAPSED_STRING","'disabled'",1442],["T_WHITESPACE","     ",1442],["T_DOUBLE_ARROW","=>",1442],["T_WHITESPACE"," ",1442],["T_ISSET","isset",1442],"(",["T_VARIABLE","$rowData",1442],"[",["T_CONSTANT_ENCAPSED_STRING","'_media_is_disabled'",1442],"]",")",["T_WHITESPACE"," ",1442],"?",["T_WHITESPACE"," ",1442],["T_VARIABLE","$rowData",1442],"[",["T_CONSTANT_ENCAPSED_STRING","'_media_is_disabled'",1442],"]",["T_WHITESPACE"," ",1442],":",["T_WHITESPACE"," ",1442],["T_CONSTANT_ENCAPSED_STRING","''",1442],",",["T_WHITESPACE","\n                        ",1442],["T_CONSTANT_ENCAPSED_STRING","'value'",1443],["T_WHITESPACE","        ",1443],["T_DOUBLE_ARROW","=>",1443],["T_WHITESPACE"," ",1443],["T_VARIABLE","$rowData",1443],"[",["T_CONSTANT_ENCAPSED_STRING","'_media_image'",1443],"]",["T_WHITESPACE","\n                    ",1443],")",";",["T_WHITESPACE","\n                ",1444],"}",["T_WHITESPACE","\n                ",1445],["T_COMMENT","\/\/ 6. Attributes phase\n",1446],["T_WHITESPACE","                ",1447],["T_VARIABLE","$rowStore",1447],["T_WHITESPACE","     ",1447],"=",["T_WHITESPACE"," ",1447],["T_STRING","self",1447],["T_DOUBLE_COLON","::",1447],["T_STRING","SCOPE_STORE",1447],["T_WHITESPACE"," ",1447],["T_IS_EQUAL","==",1447],["T_WHITESPACE"," ",1447],["T_VARIABLE","$rowScope",1447],["T_WHITESPACE"," ",1447],"?",["T_WHITESPACE"," ",1447],["T_VARIABLE","$this",1447],["T_OBJECT_OPERATOR","->",1447],["T_STRING","_storeCodeToId",1447],"[",["T_VARIABLE","$rowData",1447],"[",["T_STRING","self",1447],["T_DOUBLE_COLON","::",1447],["T_STRING","COL_STORE",1447],"]","]",["T_WHITESPACE"," ",1447],":",["T_WHITESPACE"," ",1447],["T_LNUMBER","0",1447],";",["T_WHITESPACE","\n                ",1447],["T_VARIABLE","$productType",1448],["T_WHITESPACE","  ",1448],"=",["T_WHITESPACE"," ",1448],["T_ISSET","isset",1448],"(",["T_VARIABLE","$rowData",1448],"[",["T_STRING","self",1448],["T_DOUBLE_COLON","::",1448],["T_STRING","COL_TYPE",1448],"]",")",["T_WHITESPACE"," ",1448],"?",["T_WHITESPACE"," ",1448],["T_VARIABLE","$rowData",1448],"[",["T_STRING","self",1448],["T_DOUBLE_COLON","::",1448],["T_STRING","COL_TYPE",1448],"]",["T_WHITESPACE"," ",1448],":",["T_WHITESPACE"," ",1448],["T_STRING","null",1448],";",["T_WHITESPACE","\n                ",1448],["T_IF","if",1449],["T_WHITESPACE"," ",1449],"(","!",["T_STRING","is_null",1449],"(",["T_VARIABLE","$productType",1449],")",")",["T_WHITESPACE"," ",1449],"{",["T_WHITESPACE","\n                    ",1449],["T_VARIABLE","$previousType",1450],["T_WHITESPACE"," ",1450],"=",["T_WHITESPACE"," ",1450],["T_VARIABLE","$productType",1450],";",["T_WHITESPACE","\n                ",1450],"}",["T_WHITESPACE","\n                ",1451],["T_IF","if",1452],["T_WHITESPACE"," ",1452],"(",["T_ISSET","isset",1452],"(",["T_VARIABLE","$rowData",1452],"[",["T_STRING","self",1452],["T_DOUBLE_COLON","::",1452],["T_STRING","COL_ATTR_SET",1452],"]",")",["T_WHITESPACE"," ",1452],["T_BOOLEAN_AND","&&",1452],["T_WHITESPACE"," ",1452],"!",["T_STRING","is_null",1452],"(",["T_VARIABLE","$rowData",1452],"[",["T_STRING","self",1452],["T_DOUBLE_COLON","::",1452],["T_STRING","COL_ATTR_SET",1452],"]",")",")",["T_WHITESPACE"," ",1452],"{",["T_WHITESPACE","\n                    ",1452],["T_VARIABLE","$previousAttributeSet",1453],["T_WHITESPACE"," ",1453],"=",["T_WHITESPACE"," ",1453],["T_VARIABLE","$rowData",1453],"[",["T_STRING","Mage_ImportExport_Model_Import_Entity_Product",1453],["T_DOUBLE_COLON","::",1453],["T_STRING","COL_ATTR_SET",1453],"]",";",["T_WHITESPACE","\n                ",1453],"}",["T_WHITESPACE","\n                ",1454],["T_IF","if",1455],["T_WHITESPACE"," ",1455],"(",["T_STRING","self",1455],["T_DOUBLE_COLON","::",1455],["T_STRING","SCOPE_NULL",1455],["T_WHITESPACE"," ",1455],["T_IS_EQUAL","==",1455],["T_WHITESPACE"," ",1455],["T_VARIABLE","$rowScope",1455],")",["T_WHITESPACE"," ",1455],"{",["T_WHITESPACE","\n                    ",1455],["T_COMMENT","\/\/ for multiselect attributes only\n",1456],["T_WHITESPACE","                    ",1457],["T_IF","if",1457],["T_WHITESPACE"," ",1457],"(","!",["T_STRING","is_null",1457],"(",["T_VARIABLE","$previousAttributeSet",1457],")",")",["T_WHITESPACE"," ",1457],"{",["T_WHITESPACE","\n                         ",1457],["T_VARIABLE","$rowData",1458],"[",["T_STRING","Mage_ImportExport_Model_Import_Entity_Product",1458],["T_DOUBLE_COLON","::",1458],["T_STRING","COL_ATTR_SET",1458],"]",["T_WHITESPACE"," ",1458],"=",["T_WHITESPACE"," ",1458],["T_VARIABLE","$previousAttributeSet",1458],";",["T_WHITESPACE","\n                    ",1458],"}",["T_WHITESPACE","\n                    ",1459],["T_IF","if",1460],["T_WHITESPACE"," ",1460],"(",["T_STRING","is_null",1460],"(",["T_VARIABLE","$productType",1460],")",["T_WHITESPACE"," ",1460],["T_BOOLEAN_AND","&&",1460],["T_WHITESPACE"," ",1460],"!",["T_STRING","is_null",1460],"(",["T_VARIABLE","$previousType",1460],")",")",["T_WHITESPACE"," ",1460],"{",["T_WHITESPACE","\n                        ",1460],["T_VARIABLE","$productType",1461],["T_WHITESPACE"," ",1461],"=",["T_WHITESPACE"," ",1461],["T_VARIABLE","$previousType",1461],";",["T_WHITESPACE","\n                    ",1461],"}",["T_WHITESPACE","\n                    ",1462],["T_IF","if",1463],["T_WHITESPACE"," ",1463],"(",["T_STRING","is_null",1463],"(",["T_VARIABLE","$productType",1463],")",")",["T_WHITESPACE"," ",1463],"{",["T_WHITESPACE","\n                        ",1463],["T_CONTINUE","continue",1464],";",["T_WHITESPACE","\n                    ",1464],"}",["T_WHITESPACE","\n                ",1465],"}",["T_WHITESPACE","\n                ",1466],["T_VARIABLE","$rowData",1467],["T_WHITESPACE"," ",1467],"=",["T_WHITESPACE"," ",1467],["T_VARIABLE","$this",1467],["T_OBJECT_OPERATOR","->",1467],["T_STRING","_productTypeModels",1467],"[",["T_VARIABLE","$productType",1467],"]",["T_OBJECT_OPERATOR","->",1467],["T_STRING","prepareAttributesForSave",1467],"(",["T_WHITESPACE","\n                    ",1467],["T_VARIABLE","$rowData",1468],",",["T_WHITESPACE","\n                    ",1468],"!",["T_ISSET","isset",1469],"(",["T_VARIABLE","$this",1469],["T_OBJECT_OPERATOR","->",1469],["T_STRING","_oldSku",1469],"[",["T_VARIABLE","$rowSku",1469],"]",")",["T_WHITESPACE"," ",1469],["T_BOOLEAN_AND","&&",1469],["T_WHITESPACE"," ",1469],"(",["T_STRING","self",1469],["T_DOUBLE_COLON","::",1469],["T_STRING","SCOPE_DEFAULT",1469],["T_WHITESPACE"," ",1469],["T_IS_EQUAL","==",1469],["T_WHITESPACE"," ",1469],["T_VARIABLE","$rowScope",1469],")",["T_WHITESPACE","\n                ",1469],")",";",["T_WHITESPACE","\n                ",1470],["T_TRY","try",1471],["T_WHITESPACE"," ",1471],"{",["T_WHITESPACE","\n                    ",1471],["T_VARIABLE","$attributes",1472],["T_WHITESPACE"," ",1472],"=",["T_WHITESPACE"," ",1472],["T_VARIABLE","$this",1472],["T_OBJECT_OPERATOR","->",1472],["T_STRING","_prepareAttributes",1472],"(",["T_VARIABLE","$rowData",1472],",",["T_WHITESPACE"," ",1472],["T_VARIABLE","$rowScope",1472],",",["T_WHITESPACE"," ",1472],["T_VARIABLE","$attributes",1472],",",["T_WHITESPACE"," ",1472],["T_VARIABLE","$rowSku",1472],",",["T_WHITESPACE"," ",1472],["T_VARIABLE","$rowStore",1472],")",";",["T_WHITESPACE","\n                ",1472],"}",["T_WHITESPACE"," ",1473],["T_CATCH","catch",1473],["T_WHITESPACE"," ",1473],"(",["T_STRING","Exception",1473],["T_WHITESPACE"," ",1473],["T_VARIABLE","$e",1473],")",["T_WHITESPACE"," ",1473],"{",["T_WHITESPACE","\n                    ",1473],["T_STRING","Mage",1474],["T_DOUBLE_COLON","::",1474],["T_STRING","logException",1474],"(",["T_VARIABLE","$e",1474],")",";",["T_WHITESPACE","\n                    ",1474],["T_CONTINUE","continue",1475],";",["T_WHITESPACE","\n                ",1475],"}",["T_WHITESPACE","\n            ",1476],"}",["T_WHITESPACE","\n\n            ",1477],["T_VARIABLE","$this",1479],["T_OBJECT_OPERATOR","->",1479],["T_STRING","_saveProductEntity",1479],"(",["T_VARIABLE","$entityRowsIn",1479],",",["T_WHITESPACE"," ",1479],["T_VARIABLE","$entityRowsUp",1479],")",["T_WHITESPACE","\n                ",1479],["T_OBJECT_OPERATOR","->",1480],["T_STRING","_saveProductWebsites",1480],"(",["T_VARIABLE","$websites",1480],")",["T_WHITESPACE","\n                ",1480],["T_OBJECT_OPERATOR","->",1481],["T_STRING","_saveProductCategories",1481],"(",["T_VARIABLE","$categories",1481],")",["T_WHITESPACE","\n                ",1481],["T_OBJECT_OPERATOR","->",1482],["T_STRING","_saveProductTierPrices",1482],"(",["T_VARIABLE","$tierPrices",1482],")",["T_WHITESPACE","\n                ",1482],["T_OBJECT_OPERATOR","->",1483],["T_STRING","_saveProductGroupPrices",1483],"(",["T_VARIABLE","$groupPrices",1483],")",["T_WHITESPACE","\n                ",1483],["T_OBJECT_OPERATOR","->",1484],["T_STRING","_saveMediaGallery",1484],"(",["T_VARIABLE","$mediaGallery",1484],")",["T_WHITESPACE","\n                ",1484],["T_OBJECT_OPERATOR","->",1485],["T_STRING","_saveProductAttributes",1485],"(",["T_VARIABLE","$attributes",1485],")",";",["T_WHITESPACE","\n        ",1485],"}",["T_WHITESPACE","\n        ",1486],["T_RETURN","return",1487],["T_WHITESPACE"," ",1487],["T_VARIABLE","$this",1487],";",["T_WHITESPACE","\n    ",1487],"}",["T_WHITESPACE","\n\n    ",1488],["T_DOC_COMMENT","\/**\n     * Retrieve pattern for time formatting\n     *\n     * @return string\n     *\/",1490],["T_WHITESPACE","\n    ",1494],["T_PROTECTED","protected",1495],["T_WHITESPACE"," ",1495],["T_FUNCTION","function",1495],["T_WHITESPACE"," ",1495],["T_STRING","_getStrftimeFormat",1495],"(",")",["T_WHITESPACE","\n    ",1495],"{",["T_WHITESPACE","\n        ",1496],["T_RETURN","return",1497],["T_WHITESPACE"," ",1497],["T_STRING","Varien_Date",1497],["T_DOUBLE_COLON","::",1497],["T_STRING","convertZendToStrftime",1497],"(",["T_STRING","Varien_Date",1497],["T_DOUBLE_COLON","::",1497],["T_STRING","DATETIME_INTERNAL_FORMAT",1497],",",["T_WHITESPACE"," ",1497],["T_STRING","true",1497],",",["T_WHITESPACE"," ",1497],["T_STRING","true",1497],")",";",["T_WHITESPACE","\n    ",1497],"}",["T_WHITESPACE","\n\n    ",1498],["T_DOC_COMMENT","\/**\n     * Retrieve attribute by specified code\n     *\n     * @param string $code\n     * @return Mage_Eav_Model_Entity_Attribute_Abstract\n     *\/",1500],["T_WHITESPACE","\n    ",1505],["T_PROTECTED","protected",1506],["T_WHITESPACE"," ",1506],["T_FUNCTION","function",1506],["T_WHITESPACE"," ",1506],["T_STRING","_getAttribute",1506],"(",["T_VARIABLE","$code",1506],")",["T_WHITESPACE","\n    ",1506],"{",["T_WHITESPACE","\n        ",1507],["T_VARIABLE","$attribute",1508],["T_WHITESPACE"," ",1508],"=",["T_WHITESPACE"," ",1508],["T_STRING","Mage",1508],["T_DOUBLE_COLON","::",1508],["T_STRING","getSingleton",1508],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport\/import_proxy_product_resource'",1508],")",["T_OBJECT_OPERATOR","->",1508],["T_STRING","getAttribute",1508],"(",["T_VARIABLE","$code",1508],")",";",["T_WHITESPACE","\n        ",1508],["T_VARIABLE","$backendModelName",1509],["T_WHITESPACE"," ",1509],"=",["T_WHITESPACE"," ",1509],["T_STRING_CAST","(string)",1509],["T_STRING","Mage",1509],["T_DOUBLE_COLON","::",1509],["T_STRING","getConfig",1509],"(",")",["T_OBJECT_OPERATOR","->",1509],["T_STRING","getNode",1509],"(",["T_WHITESPACE","\n            ",1509],["T_CONSTANT_ENCAPSED_STRING","'global\/importexport\/import\/catalog_product\/attributes\/'",1510],["T_WHITESPACE"," ",1510],".",["T_WHITESPACE"," ",1510],["T_VARIABLE","$attribute",1510],["T_OBJECT_OPERATOR","->",1510],["T_STRING","getAttributeCode",1510],"(",")",["T_WHITESPACE"," ",1510],".",["T_WHITESPACE"," ",1510],["T_CONSTANT_ENCAPSED_STRING","'\/backend_model'",1510],["T_WHITESPACE","\n        ",1510],")",";",["T_WHITESPACE","\n        ",1511],["T_IF","if",1512],["T_WHITESPACE"," ",1512],"(","!",["T_EMPTY","empty",1512],"(",["T_VARIABLE","$backendModelName",1512],")",")",["T_WHITESPACE"," ",1512],"{",["T_WHITESPACE","\n            ",1512],["T_VARIABLE","$attribute",1513],["T_OBJECT_OPERATOR","->",1513],["T_STRING","setBackendModel",1513],"(",["T_VARIABLE","$backendModelName",1513],")",";",["T_WHITESPACE","\n        ",1513],"}",["T_WHITESPACE","\n        ",1514],["T_RETURN","return",1515],["T_WHITESPACE"," ",1515],["T_VARIABLE","$attribute",1515],";",["T_WHITESPACE","\n    ",1515],"}",["T_WHITESPACE","\n\n    ",1516],["T_DOC_COMMENT","\/**\n     * Prepare attributes data\n     *\n     * @param array $rowData\n     * @param int $rowScope\n     * @param array $attributes\n     * @param string|null $rowSku\n     * @param int $rowStore\n     * @return array\n     *\/",1518],["T_WHITESPACE","\n    ",1527],["T_PROTECTED","protected",1528],["T_WHITESPACE"," ",1528],["T_FUNCTION","function",1528],["T_WHITESPACE"," ",1528],["T_STRING","_prepareAttributes",1528],"(",["T_VARIABLE","$rowData",1528],",",["T_WHITESPACE"," ",1528],["T_VARIABLE","$rowScope",1528],",",["T_WHITESPACE"," ",1528],["T_VARIABLE","$attributes",1528],",",["T_WHITESPACE"," ",1528],["T_VARIABLE","$rowSku",1528],",",["T_WHITESPACE"," ",1528],["T_VARIABLE","$rowStore",1528],")",["T_WHITESPACE","\n    ",1528],"{",["T_WHITESPACE","\n        ",1529],["T_VARIABLE","$product",1530],["T_WHITESPACE"," ",1530],"=",["T_WHITESPACE"," ",1530],["T_STRING","Mage",1530],["T_DOUBLE_COLON","::",1530],["T_STRING","getModel",1530],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport\/import_proxy_product'",1530],",",["T_WHITESPACE"," ",1530],["T_VARIABLE","$rowData",1530],")",";",["T_WHITESPACE","\n\n        ",1530],["T_FOREACH","foreach",1532],["T_WHITESPACE"," ",1532],"(",["T_VARIABLE","$rowData",1532],["T_WHITESPACE"," ",1532],["T_AS","as",1532],["T_WHITESPACE"," ",1532],["T_VARIABLE","$attrCode",1532],["T_WHITESPACE"," ",1532],["T_DOUBLE_ARROW","=>",1532],["T_WHITESPACE"," ",1532],["T_VARIABLE","$attrValue",1532],")",["T_WHITESPACE"," ",1532],"{",["T_WHITESPACE","\n            ",1532],["T_VARIABLE","$attribute",1533],["T_WHITESPACE"," ",1533],"=",["T_WHITESPACE"," ",1533],["T_VARIABLE","$this",1533],["T_OBJECT_OPERATOR","->",1533],["T_STRING","_getAttribute",1533],"(",["T_VARIABLE","$attrCode",1533],")",";",["T_WHITESPACE","\n            ",1533],["T_IF","if",1534],["T_WHITESPACE"," ",1534],"(",["T_CONSTANT_ENCAPSED_STRING","'multiselect'",1534],["T_WHITESPACE"," ",1534],["T_IS_NOT_EQUAL","!=",1534],["T_WHITESPACE"," ",1534],["T_VARIABLE","$attribute",1534],["T_OBJECT_OPERATOR","->",1534],["T_STRING","getFrontendInput",1534],"(",")",["T_WHITESPACE","\n                ",1534],["T_BOOLEAN_AND","&&",1535],["T_WHITESPACE"," ",1535],["T_STRING","self",1535],["T_DOUBLE_COLON","::",1535],["T_STRING","SCOPE_NULL",1535],["T_WHITESPACE"," ",1535],["T_IS_EQUAL","==",1535],["T_WHITESPACE"," ",1535],["T_VARIABLE","$rowScope",1535],["T_WHITESPACE","\n            ",1535],")",["T_WHITESPACE"," ",1536],"{",["T_WHITESPACE","\n                ",1536],["T_CONTINUE","continue",1537],";",["T_WHITESPACE"," ",1537],["T_COMMENT","\/\/ skip attribute processing for SCOPE_NULL rows\n",1537],["T_WHITESPACE","            ",1538],"}",["T_WHITESPACE","\n            ",1538],["T_VARIABLE","$attrId",1539],["T_WHITESPACE"," ",1539],"=",["T_WHITESPACE"," ",1539],["T_VARIABLE","$attribute",1539],["T_OBJECT_OPERATOR","->",1539],["T_STRING","getId",1539],"(",")",";",["T_WHITESPACE","\n            ",1539],["T_VARIABLE","$backModel",1540],["T_WHITESPACE"," ",1540],"=",["T_WHITESPACE"," ",1540],["T_VARIABLE","$attribute",1540],["T_OBJECT_OPERATOR","->",1540],["T_STRING","getBackendModel",1540],"(",")",";",["T_WHITESPACE","\n            ",1540],["T_VARIABLE","$attrTable",1541],["T_WHITESPACE"," ",1541],"=",["T_WHITESPACE"," ",1541],["T_VARIABLE","$attribute",1541],["T_OBJECT_OPERATOR","->",1541],["T_STRING","getBackend",1541],"(",")",["T_OBJECT_OPERATOR","->",1541],["T_STRING","getTable",1541],"(",")",";",["T_WHITESPACE","\n            ",1541],["T_VARIABLE","$storeIds",1542],["T_WHITESPACE"," ",1542],"=",["T_WHITESPACE"," ",1542],["T_ARRAY","array",1542],"(",["T_LNUMBER","0",1542],")",";",["T_WHITESPACE","\n\n            ",1542],["T_IF","if",1544],["T_WHITESPACE"," ",1544],"(",["T_CONSTANT_ENCAPSED_STRING","'datetime'",1544],["T_WHITESPACE"," ",1544],["T_IS_EQUAL","==",1544],["T_WHITESPACE"," ",1544],["T_VARIABLE","$attribute",1544],["T_OBJECT_OPERATOR","->",1544],["T_STRING","getBackendType",1544],"(",")",["T_WHITESPACE"," ",1544],["T_BOOLEAN_AND","&&",1544],["T_WHITESPACE"," ",1544],["T_STRING","strtotime",1544],"(",["T_VARIABLE","$attrValue",1544],")",")",["T_WHITESPACE"," ",1544],"{",["T_WHITESPACE","\n                ",1544],["T_VARIABLE","$attrValue",1545],["T_WHITESPACE"," ",1545],"=",["T_WHITESPACE"," ",1545],["T_STRING","gmstrftime",1545],"(",["T_VARIABLE","$this",1545],["T_OBJECT_OPERATOR","->",1545],["T_STRING","_getStrftimeFormat",1545],"(",")",",",["T_WHITESPACE"," ",1545],["T_STRING","strtotime",1545],"(",["T_VARIABLE","$attrValue",1545],")",")",";",["T_WHITESPACE","\n            ",1545],"}",["T_WHITESPACE"," ",1546],["T_ELSEIF","elseif",1546],["T_WHITESPACE"," ",1546],"(",["T_CONSTANT_ENCAPSED_STRING","'url_key'",1546],["T_WHITESPACE"," ",1546],["T_IS_EQUAL","==",1546],["T_WHITESPACE"," ",1546],["T_VARIABLE","$attribute",1546],["T_OBJECT_OPERATOR","->",1546],["T_STRING","getAttributeCode",1546],"(",")",")",["T_WHITESPACE"," ",1546],"{",["T_WHITESPACE","\n                ",1546],["T_IF","if",1547],["T_WHITESPACE"," ",1547],"(",["T_EMPTY","empty",1547],"(",["T_VARIABLE","$attrValue",1547],")",")",["T_WHITESPACE"," ",1547],"{",["T_WHITESPACE","\n                    ",1547],["T_VARIABLE","$attrValue",1548],["T_WHITESPACE"," ",1548],"=",["T_WHITESPACE"," ",1548],["T_VARIABLE","$product",1548],["T_OBJECT_OPERATOR","->",1548],["T_STRING","formatUrlKey",1548],"(",["T_VARIABLE","$product",1548],["T_OBJECT_OPERATOR","->",1548],["T_STRING","getName",1548],"(",")",")",";",["T_WHITESPACE","\n                ",1548],"}",["T_WHITESPACE","\n            ",1549],"}",["T_WHITESPACE"," ",1550],["T_ELSEIF","elseif",1550],["T_WHITESPACE"," ",1550],"(",["T_VARIABLE","$backModel",1550],")",["T_WHITESPACE"," ",1550],"{",["T_WHITESPACE","\n                ",1550],["T_VARIABLE","$attribute",1551],["T_OBJECT_OPERATOR","->",1551],["T_STRING","getBackend",1551],"(",")",["T_OBJECT_OPERATOR","->",1551],["T_STRING","beforeSave",1551],"(",["T_VARIABLE","$product",1551],")",";",["T_WHITESPACE","\n                ",1551],["T_VARIABLE","$attrValue",1552],["T_WHITESPACE"," ",1552],"=",["T_WHITESPACE"," ",1552],["T_VARIABLE","$product",1552],["T_OBJECT_OPERATOR","->",1552],["T_STRING","getData",1552],"(",["T_VARIABLE","$attribute",1552],["T_OBJECT_OPERATOR","->",1552],["T_STRING","getAttributeCode",1552],"(",")",")",";",["T_WHITESPACE","\n            ",1552],"}",["T_WHITESPACE","\n            ",1553],["T_IF","if",1554],["T_WHITESPACE"," ",1554],"(",["T_STRING","self",1554],["T_DOUBLE_COLON","::",1554],["T_STRING","SCOPE_STORE",1554],["T_WHITESPACE"," ",1554],["T_IS_EQUAL","==",1554],["T_WHITESPACE"," ",1554],["T_VARIABLE","$rowScope",1554],")",["T_WHITESPACE"," ",1554],"{",["T_WHITESPACE","\n                ",1554],["T_IF","if",1555],["T_WHITESPACE"," ",1555],"(",["T_STRING","self",1555],["T_DOUBLE_COLON","::",1555],["T_STRING","SCOPE_WEBSITE",1555],["T_WHITESPACE"," ",1555],["T_IS_EQUAL","==",1555],["T_WHITESPACE"," ",1555],["T_VARIABLE","$attribute",1555],["T_OBJECT_OPERATOR","->",1555],["T_STRING","getIsGlobal",1555],"(",")",")",["T_WHITESPACE"," ",1555],"{",["T_WHITESPACE","\n                    ",1555],["T_COMMENT","\/\/ check website defaults already set\n",1556],["T_WHITESPACE","                    ",1557],["T_IF","if",1557],["T_WHITESPACE"," ",1557],"(","!",["T_ISSET","isset",1557],"(",["T_VARIABLE","$attributes",1557],"[",["T_VARIABLE","$attrTable",1557],"]","[",["T_VARIABLE","$rowSku",1557],"]","[",["T_VARIABLE","$attrId",1557],"]","[",["T_VARIABLE","$rowStore",1557],"]",")",")",["T_WHITESPACE"," ",1557],"{",["T_WHITESPACE","\n                        ",1557],["T_VARIABLE","$storeIds",1558],["T_WHITESPACE"," ",1558],"=",["T_WHITESPACE"," ",1558],["T_VARIABLE","$this",1558],["T_OBJECT_OPERATOR","->",1558],["T_STRING","_storeIdToWebsiteStoreIds",1558],"[",["T_VARIABLE","$rowStore",1558],"]",";",["T_WHITESPACE","\n                    ",1558],"}",["T_WHITESPACE"," ",1559],["T_ELSE","else",1559],["T_WHITESPACE"," ",1559],"{",["T_WHITESPACE","\n                        ",1559],["T_VARIABLE","$storeIds",1560],["T_WHITESPACE"," ",1560],"=",["T_WHITESPACE"," ",1560],["T_ARRAY","array",1560],"(",["T_VARIABLE","$rowStore",1560],")",";",["T_WHITESPACE","\n                    ",1560],"}",["T_WHITESPACE","\n                ",1561],"}",["T_WHITESPACE"," ",1562],["T_ELSEIF","elseif",1562],["T_WHITESPACE"," ",1562],"(",["T_STRING","self",1562],["T_DOUBLE_COLON","::",1562],["T_STRING","SCOPE_STORE",1562],["T_WHITESPACE"," ",1562],["T_IS_EQUAL","==",1562],["T_WHITESPACE"," ",1562],["T_VARIABLE","$attribute",1562],["T_OBJECT_OPERATOR","->",1562],["T_STRING","getIsGlobal",1562],"(",")",")",["T_WHITESPACE"," ",1562],"{",["T_WHITESPACE","\n                    ",1562],["T_VARIABLE","$storeIds",1563],["T_WHITESPACE"," ",1563],"=",["T_WHITESPACE"," ",1563],["T_ARRAY","array",1563],"(",["T_VARIABLE","$rowStore",1563],")",";",["T_WHITESPACE","\n                ",1563],"}",["T_WHITESPACE","\n            ",1564],"}",["T_WHITESPACE","\n            ",1565],["T_FOREACH","foreach",1566],["T_WHITESPACE"," ",1566],"(",["T_VARIABLE","$storeIds",1566],["T_WHITESPACE"," ",1566],["T_AS","as",1566],["T_WHITESPACE"," ",1566],["T_VARIABLE","$storeId",1566],")",["T_WHITESPACE"," ",1566],"{",["T_WHITESPACE","\n                ",1566],["T_IF","if",1567],["T_WHITESPACE"," ",1567],"(",["T_CONSTANT_ENCAPSED_STRING","'multiselect'",1567],["T_WHITESPACE"," ",1567],["T_IS_EQUAL","==",1567],["T_WHITESPACE"," ",1567],["T_VARIABLE","$attribute",1567],["T_OBJECT_OPERATOR","->",1567],["T_STRING","getFrontendInput",1567],"(",")",")",["T_WHITESPACE"," ",1567],"{",["T_WHITESPACE","\n                    ",1567],["T_IF","if",1568],["T_WHITESPACE"," ",1568],"(","!",["T_ISSET","isset",1568],"(",["T_VARIABLE","$attributes",1568],"[",["T_VARIABLE","$attrTable",1568],"]","[",["T_VARIABLE","$rowSku",1568],"]","[",["T_VARIABLE","$attrId",1568],"]","[",["T_VARIABLE","$storeId",1568],"]",")",")",["T_WHITESPACE"," ",1568],"{",["T_WHITESPACE","\n                        ",1568],["T_VARIABLE","$attributes",1569],"[",["T_VARIABLE","$attrTable",1569],"]","[",["T_VARIABLE","$rowSku",1569],"]","[",["T_VARIABLE","$attrId",1569],"]","[",["T_VARIABLE","$storeId",1569],"]",["T_WHITESPACE"," ",1569],"=",["T_WHITESPACE"," ",1569],["T_CONSTANT_ENCAPSED_STRING","''",1569],";",["T_WHITESPACE","\n                    ",1569],"}",["T_WHITESPACE"," ",1570],["T_ELSE","else",1570],["T_WHITESPACE"," ",1570],"{",["T_WHITESPACE","\n                        ",1570],["T_VARIABLE","$attributes",1571],"[",["T_VARIABLE","$attrTable",1571],"]","[",["T_VARIABLE","$rowSku",1571],"]","[",["T_VARIABLE","$attrId",1571],"]","[",["T_VARIABLE","$storeId",1571],"]",["T_WHITESPACE"," ",1571],["T_CONCAT_EQUAL",".=",1571],["T_WHITESPACE"," ",1571],["T_CONSTANT_ENCAPSED_STRING","','",1571],";",["T_WHITESPACE","\n                    ",1571],"}",["T_WHITESPACE","\n                    ",1572],["T_VARIABLE","$attributes",1573],"[",["T_VARIABLE","$attrTable",1573],"]","[",["T_VARIABLE","$rowSku",1573],"]","[",["T_VARIABLE","$attrId",1573],"]","[",["T_VARIABLE","$storeId",1573],"]",["T_WHITESPACE"," ",1573],["T_CONCAT_EQUAL",".=",1573],["T_WHITESPACE"," ",1573],["T_VARIABLE","$attrValue",1573],";",["T_WHITESPACE","\n                ",1573],"}",["T_WHITESPACE"," ",1574],["T_ELSE","else",1574],["T_WHITESPACE"," ",1574],"{",["T_WHITESPACE","\n                    ",1574],["T_VARIABLE","$attributes",1575],"[",["T_VARIABLE","$attrTable",1575],"]","[",["T_VARIABLE","$rowSku",1575],"]","[",["T_VARIABLE","$attrId",1575],"]","[",["T_VARIABLE","$storeId",1575],"]",["T_WHITESPACE"," ",1575],"=",["T_WHITESPACE"," ",1575],["T_VARIABLE","$attrValue",1575],";",["T_WHITESPACE","\n                ",1575],"}",["T_WHITESPACE","\n            ",1576],"}",["T_WHITESPACE","\n            ",1577],["T_VARIABLE","$attribute",1578],["T_OBJECT_OPERATOR","->",1578],["T_STRING","setBackendModel",1578],"(",["T_VARIABLE","$backModel",1578],")",";",["T_WHITESPACE"," ",1578],["T_COMMENT","\/\/ restore 'backend_model' to avoid 'default' setting\n",1578],["T_WHITESPACE","        ",1579],"}",["T_WHITESPACE","\n        ",1579],["T_RETURN","return",1580],["T_WHITESPACE"," ",1580],["T_VARIABLE","$attributes",1580],";",["T_WHITESPACE","\n    ",1580],"}",["T_WHITESPACE","\n\n    ",1581],["T_DOC_COMMENT","\/**\n     * Save product tier prices.\n     *\n     * @param array $tierPriceData\n     * @return Mage_ImportExport_Model_Import_Entity_Product\n     *\/",1583],["T_WHITESPACE","\n    ",1588],["T_PROTECTED","protected",1589],["T_WHITESPACE"," ",1589],["T_FUNCTION","function",1589],["T_WHITESPACE"," ",1589],["T_STRING","_saveProductTierPrices",1589],"(",["T_ARRAY","array",1589],["T_WHITESPACE"," ",1589],["T_VARIABLE","$tierPriceData",1589],")",["T_WHITESPACE","\n    ",1589],"{",["T_WHITESPACE","\n        ",1590],["T_STATIC","static",1591],["T_WHITESPACE"," ",1591],["T_VARIABLE","$tableName",1591],["T_WHITESPACE"," ",1591],"=",["T_WHITESPACE"," ",1591],["T_STRING","null",1591],";",["T_WHITESPACE","\n\n        ",1591],["T_IF","if",1593],["T_WHITESPACE"," ",1593],"(","!",["T_VARIABLE","$tableName",1593],")",["T_WHITESPACE"," ",1593],"{",["T_WHITESPACE","\n            ",1593],["T_VARIABLE","$tableName",1594],["T_WHITESPACE"," ",1594],"=",["T_WHITESPACE"," ",1594],["T_STRING","Mage",1594],["T_DOUBLE_COLON","::",1594],["T_STRING","getModel",1594],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport\/import_proxy_product_resource'",1594],")",["T_WHITESPACE","\n                    ",1594],["T_OBJECT_OPERATOR","->",1595],["T_STRING","getTable",1595],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_attribute_tier_price'",1595],")",";",["T_WHITESPACE","\n        ",1595],"}",["T_WHITESPACE","\n        ",1596],["T_IF","if",1597],["T_WHITESPACE"," ",1597],"(",["T_VARIABLE","$tierPriceData",1597],")",["T_WHITESPACE"," ",1597],"{",["T_WHITESPACE","\n            ",1597],["T_VARIABLE","$tierPriceIn",1598],["T_WHITESPACE","  ",1598],"=",["T_WHITESPACE"," ",1598],["T_ARRAY","array",1598],"(",")",";",["T_WHITESPACE","\n            ",1598],["T_VARIABLE","$delProductId",1599],["T_WHITESPACE"," ",1599],"=",["T_WHITESPACE"," ",1599],["T_ARRAY","array",1599],"(",")",";",["T_WHITESPACE","\n\n            ",1599],["T_FOREACH","foreach",1601],["T_WHITESPACE"," ",1601],"(",["T_VARIABLE","$tierPriceData",1601],["T_WHITESPACE"," ",1601],["T_AS","as",1601],["T_WHITESPACE"," ",1601],["T_VARIABLE","$delSku",1601],["T_WHITESPACE"," ",1601],["T_DOUBLE_ARROW","=>",1601],["T_WHITESPACE"," ",1601],["T_VARIABLE","$tierPriceRows",1601],")",["T_WHITESPACE"," ",1601],"{",["T_WHITESPACE","\n                ",1601],["T_VARIABLE","$productId",1602],["T_WHITESPACE","      ",1602],"=",["T_WHITESPACE"," ",1602],["T_VARIABLE","$this",1602],["T_OBJECT_OPERATOR","->",1602],["T_STRING","_newSku",1602],"[",["T_VARIABLE","$delSku",1602],"]","[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1602],"]",";",["T_WHITESPACE","\n                ",1602],["T_VARIABLE","$delProductId",1603],"[","]",["T_WHITESPACE"," ",1603],"=",["T_WHITESPACE"," ",1603],["T_VARIABLE","$productId",1603],";",["T_WHITESPACE","\n\n                ",1603],["T_FOREACH","foreach",1605],["T_WHITESPACE"," ",1605],"(",["T_VARIABLE","$tierPriceRows",1605],["T_WHITESPACE"," ",1605],["T_AS","as",1605],["T_WHITESPACE"," ",1605],["T_VARIABLE","$row",1605],")",["T_WHITESPACE"," ",1605],"{",["T_WHITESPACE","\n                    ",1605],["T_VARIABLE","$row",1606],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1606],"]",["T_WHITESPACE"," ",1606],"=",["T_WHITESPACE"," ",1606],["T_VARIABLE","$productId",1606],";",["T_WHITESPACE","\n                    ",1606],["T_VARIABLE","$tierPriceIn",1607],"[","]",["T_WHITESPACE","  ",1607],"=",["T_WHITESPACE"," ",1607],["T_VARIABLE","$row",1607],";",["T_WHITESPACE","\n                ",1607],"}",["T_WHITESPACE","\n            ",1608],"}",["T_WHITESPACE","\n            ",1609],["T_IF","if",1610],["T_WHITESPACE"," ",1610],"(",["T_STRING","Mage_ImportExport_Model_Import",1610],["T_DOUBLE_COLON","::",1610],["T_STRING","BEHAVIOR_APPEND",1610],["T_WHITESPACE"," ",1610],["T_IS_NOT_EQUAL","!=",1610],["T_WHITESPACE"," ",1610],["T_VARIABLE","$this",1610],["T_OBJECT_OPERATOR","->",1610],["T_STRING","getBehavior",1610],"(",")",")",["T_WHITESPACE"," ",1610],"{",["T_WHITESPACE","\n                ",1610],["T_VARIABLE","$this",1611],["T_OBJECT_OPERATOR","->",1611],["T_STRING","_connection",1611],["T_OBJECT_OPERATOR","->",1611],["T_STRING","delete",1611],"(",["T_WHITESPACE","\n                    ",1611],["T_VARIABLE","$tableName",1612],",",["T_WHITESPACE","\n                    ",1612],["T_VARIABLE","$this",1613],["T_OBJECT_OPERATOR","->",1613],["T_STRING","_connection",1613],["T_OBJECT_OPERATOR","->",1613],["T_STRING","quoteInto",1613],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id IN (?)'",1613],",",["T_WHITESPACE"," ",1613],["T_VARIABLE","$delProductId",1613],")",["T_WHITESPACE","\n                ",1613],")",";",["T_WHITESPACE","\n            ",1614],"}",["T_WHITESPACE","\n            ",1615],["T_IF","if",1616],["T_WHITESPACE"," ",1616],"(",["T_VARIABLE","$tierPriceIn",1616],")",["T_WHITESPACE"," ",1616],"{",["T_WHITESPACE","\n                ",1616],["T_VARIABLE","$this",1617],["T_OBJECT_OPERATOR","->",1617],["T_STRING","_connection",1617],["T_OBJECT_OPERATOR","->",1617],["T_STRING","insertOnDuplicate",1617],"(",["T_VARIABLE","$tableName",1617],",",["T_WHITESPACE"," ",1617],["T_VARIABLE","$tierPriceIn",1617],",",["T_WHITESPACE"," ",1617],["T_ARRAY","array",1617],"(",["T_CONSTANT_ENCAPSED_STRING","'value'",1617],")",")",";",["T_WHITESPACE","\n            ",1617],"}",["T_WHITESPACE","\n        ",1618],"}",["T_WHITESPACE","\n        ",1619],["T_RETURN","return",1620],["T_WHITESPACE"," ",1620],["T_VARIABLE","$this",1620],";",["T_WHITESPACE","\n    ",1620],"}",["T_WHITESPACE","\n\n    ",1621],["T_DOC_COMMENT","\/**\n     * Save product group prices.\n     *\n     * @param array $groupPriceData\n     * @return Mage_ImportExport_Model_Import_Entity_Product\n     *\/",1623],["T_WHITESPACE","\n    ",1628],["T_PROTECTED","protected",1629],["T_WHITESPACE"," ",1629],["T_FUNCTION","function",1629],["T_WHITESPACE"," ",1629],["T_STRING","_saveProductGroupPrices",1629],"(",["T_ARRAY","array",1629],["T_WHITESPACE"," ",1629],["T_VARIABLE","$groupPriceData",1629],")",["T_WHITESPACE","\n    ",1629],"{",["T_WHITESPACE","\n        ",1630],["T_STATIC","static",1631],["T_WHITESPACE"," ",1631],["T_VARIABLE","$tableName",1631],["T_WHITESPACE"," ",1631],"=",["T_WHITESPACE"," ",1631],["T_STRING","null",1631],";",["T_WHITESPACE","\n\n        ",1631],["T_IF","if",1633],["T_WHITESPACE"," ",1633],"(","!",["T_VARIABLE","$tableName",1633],")",["T_WHITESPACE"," ",1633],"{",["T_WHITESPACE","\n            ",1633],["T_VARIABLE","$tableName",1634],["T_WHITESPACE"," ",1634],"=",["T_WHITESPACE"," ",1634],["T_STRING","Mage",1634],["T_DOUBLE_COLON","::",1634],["T_STRING","getModel",1634],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport\/import_proxy_product_resource'",1634],")",["T_WHITESPACE","\n                ",1634],["T_OBJECT_OPERATOR","->",1635],["T_STRING","getTable",1635],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_attribute_group_price'",1635],")",";",["T_WHITESPACE","\n        ",1635],"}",["T_WHITESPACE","\n        ",1636],["T_IF","if",1637],["T_WHITESPACE"," ",1637],"(",["T_VARIABLE","$groupPriceData",1637],")",["T_WHITESPACE"," ",1637],"{",["T_WHITESPACE","\n            ",1637],["T_VARIABLE","$groupPriceIn",1638],["T_WHITESPACE"," ",1638],"=",["T_WHITESPACE"," ",1638],["T_ARRAY","array",1638],"(",")",";",["T_WHITESPACE","\n            ",1638],["T_VARIABLE","$delProductId",1639],["T_WHITESPACE"," ",1639],"=",["T_WHITESPACE"," ",1639],["T_ARRAY","array",1639],"(",")",";",["T_WHITESPACE","\n\n            ",1639],["T_FOREACH","foreach",1641],["T_WHITESPACE"," ",1641],"(",["T_VARIABLE","$groupPriceData",1641],["T_WHITESPACE"," ",1641],["T_AS","as",1641],["T_WHITESPACE"," ",1641],["T_VARIABLE","$delSku",1641],["T_WHITESPACE"," ",1641],["T_DOUBLE_ARROW","=>",1641],["T_WHITESPACE"," ",1641],["T_VARIABLE","$groupPriceRows",1641],")",["T_WHITESPACE"," ",1641],"{",["T_WHITESPACE","\n                ",1641],["T_VARIABLE","$productId",1642],["T_WHITESPACE","      ",1642],"=",["T_WHITESPACE"," ",1642],["T_VARIABLE","$this",1642],["T_OBJECT_OPERATOR","->",1642],["T_STRING","_newSku",1642],"[",["T_VARIABLE","$delSku",1642],"]","[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1642],"]",";",["T_WHITESPACE","\n                ",1642],["T_VARIABLE","$delProductId",1643],"[","]",["T_WHITESPACE"," ",1643],"=",["T_WHITESPACE"," ",1643],["T_VARIABLE","$productId",1643],";",["T_WHITESPACE","\n\n                ",1643],["T_FOREACH","foreach",1645],["T_WHITESPACE"," ",1645],"(",["T_VARIABLE","$groupPriceRows",1645],["T_WHITESPACE"," ",1645],["T_AS","as",1645],["T_WHITESPACE"," ",1645],["T_VARIABLE","$row",1645],")",["T_WHITESPACE"," ",1645],"{",["T_WHITESPACE","\n                    ",1645],["T_VARIABLE","$row",1646],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1646],"]",["T_WHITESPACE"," ",1646],"=",["T_WHITESPACE"," ",1646],["T_VARIABLE","$productId",1646],";",["T_WHITESPACE","\n                    ",1646],["T_VARIABLE","$groupPriceIn",1647],"[","]",["T_WHITESPACE","  ",1647],"=",["T_WHITESPACE"," ",1647],["T_VARIABLE","$row",1647],";",["T_WHITESPACE","\n                ",1647],"}",["T_WHITESPACE","\n            ",1648],"}",["T_WHITESPACE","\n            ",1649],["T_IF","if",1650],["T_WHITESPACE"," ",1650],"(",["T_STRING","Mage_ImportExport_Model_Import",1650],["T_DOUBLE_COLON","::",1650],["T_STRING","BEHAVIOR_APPEND",1650],["T_WHITESPACE"," ",1650],["T_IS_NOT_EQUAL","!=",1650],["T_WHITESPACE"," ",1650],["T_VARIABLE","$this",1650],["T_OBJECT_OPERATOR","->",1650],["T_STRING","getBehavior",1650],"(",")",")",["T_WHITESPACE"," ",1650],"{",["T_WHITESPACE","\n                ",1650],["T_VARIABLE","$this",1651],["T_OBJECT_OPERATOR","->",1651],["T_STRING","_connection",1651],["T_OBJECT_OPERATOR","->",1651],["T_STRING","delete",1651],"(",["T_WHITESPACE","\n                    ",1651],["T_VARIABLE","$tableName",1652],",",["T_WHITESPACE","\n                    ",1652],["T_VARIABLE","$this",1653],["T_OBJECT_OPERATOR","->",1653],["T_STRING","_connection",1653],["T_OBJECT_OPERATOR","->",1653],["T_STRING","quoteInto",1653],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id IN (?)'",1653],",",["T_WHITESPACE"," ",1653],["T_VARIABLE","$delProductId",1653],")",["T_WHITESPACE","\n                ",1653],")",";",["T_WHITESPACE","\n            ",1654],"}",["T_WHITESPACE","\n            ",1655],["T_IF","if",1656],["T_WHITESPACE"," ",1656],"(",["T_VARIABLE","$groupPriceIn",1656],")",["T_WHITESPACE"," ",1656],"{",["T_WHITESPACE","\n                ",1656],["T_VARIABLE","$this",1657],["T_OBJECT_OPERATOR","->",1657],["T_STRING","_connection",1657],["T_OBJECT_OPERATOR","->",1657],["T_STRING","insertOnDuplicate",1657],"(",["T_VARIABLE","$tableName",1657],",",["T_WHITESPACE"," ",1657],["T_VARIABLE","$groupPriceIn",1657],",",["T_WHITESPACE"," ",1657],["T_ARRAY","array",1657],"(",["T_CONSTANT_ENCAPSED_STRING","'value'",1657],")",")",";",["T_WHITESPACE","\n            ",1657],"}",["T_WHITESPACE","\n        ",1658],"}",["T_WHITESPACE","\n        ",1659],["T_RETURN","return",1660],["T_WHITESPACE"," ",1660],["T_VARIABLE","$this",1660],";",["T_WHITESPACE","\n    ",1660],"}",["T_WHITESPACE","\n\n    ",1661],["T_DOC_COMMENT","\/**\n     * Returns an object for upload a media files\n     *\/",1663],["T_WHITESPACE","\n    ",1665],["T_PROTECTED","protected",1666],["T_WHITESPACE"," ",1666],["T_FUNCTION","function",1666],["T_WHITESPACE"," ",1666],["T_STRING","_getUploader",1666],"(",")",["T_WHITESPACE","\n    ",1666],"{",["T_WHITESPACE","\n        ",1667],["T_IF","if",1668],["T_WHITESPACE"," ",1668],"(",["T_STRING","is_null",1668],"(",["T_VARIABLE","$this",1668],["T_OBJECT_OPERATOR","->",1668],["T_STRING","_fileUploader",1668],")",")",["T_WHITESPACE"," ",1668],"{",["T_WHITESPACE","\n            ",1668],["T_VARIABLE","$this",1669],["T_OBJECT_OPERATOR","->",1669],["T_STRING","_fileUploader",1669],["T_WHITESPACE","    ",1669],"=",["T_WHITESPACE"," ",1669],["T_NEW","new",1669],["T_WHITESPACE"," ",1669],["T_STRING","Mage_ImportExport_Model_Import_Uploader",1669],"(",")",";",["T_WHITESPACE","\n\n            ",1669],["T_VARIABLE","$this",1671],["T_OBJECT_OPERATOR","->",1671],["T_STRING","_fileUploader",1671],["T_OBJECT_OPERATOR","->",1671],["T_STRING","init",1671],"(",")",";",["T_WHITESPACE","\n\n            ",1671],["T_VARIABLE","$tmpDir",1673],["T_WHITESPACE","     ",1673],"=",["T_WHITESPACE"," ",1673],["T_STRING","Mage",1673],["T_DOUBLE_COLON","::",1673],["T_STRING","getConfig",1673],"(",")",["T_OBJECT_OPERATOR","->",1673],["T_STRING","getOptions",1673],"(",")",["T_OBJECT_OPERATOR","->",1673],["T_STRING","getMediaDir",1673],"(",")",["T_WHITESPACE"," ",1673],".",["T_WHITESPACE"," ",1673],["T_CONSTANT_ENCAPSED_STRING","'\/import'",1673],";",["T_WHITESPACE","\n            ",1673],["T_VARIABLE","$destDir",1674],["T_WHITESPACE","    ",1674],"=",["T_WHITESPACE"," ",1674],["T_STRING","Mage",1674],["T_DOUBLE_COLON","::",1674],["T_STRING","getConfig",1674],"(",")",["T_OBJECT_OPERATOR","->",1674],["T_STRING","getOptions",1674],"(",")",["T_OBJECT_OPERATOR","->",1674],["T_STRING","getMediaDir",1674],"(",")",["T_WHITESPACE"," ",1674],".",["T_WHITESPACE"," ",1674],["T_CONSTANT_ENCAPSED_STRING","'\/catalog\/product'",1674],";",["T_WHITESPACE","\n            ",1674],["T_IF","if",1675],["T_WHITESPACE"," ",1675],"(","!",["T_STRING","is_writable",1675],"(",["T_VARIABLE","$destDir",1675],")",")",["T_WHITESPACE"," ",1675],"{",["T_WHITESPACE","\n                ",1675],"@",["T_STRING","mkdir",1676],"(",["T_VARIABLE","$destDir",1676],",",["T_WHITESPACE"," ",1676],["T_LNUMBER","0777",1676],",",["T_WHITESPACE"," ",1676],["T_STRING","true",1676],")",";",["T_WHITESPACE","\n            ",1676],"}",["T_WHITESPACE","\n            ",1677],["T_IF","if",1678],["T_WHITESPACE"," ",1678],"(","!",["T_VARIABLE","$this",1678],["T_OBJECT_OPERATOR","->",1678],["T_STRING","_fileUploader",1678],["T_OBJECT_OPERATOR","->",1678],["T_STRING","setTmpDir",1678],"(",["T_VARIABLE","$tmpDir",1678],")",")",["T_WHITESPACE"," ",1678],"{",["T_WHITESPACE","\n                ",1678],["T_STRING","Mage",1679],["T_DOUBLE_COLON","::",1679],["T_STRING","throwException",1679],"(","\"",["T_ENCAPSED_AND_WHITESPACE","File directory '",1679],["T_CURLY_OPEN","{",1679],["T_VARIABLE","$tmpDir",1679],"}",["T_ENCAPSED_AND_WHITESPACE","' is not readable.",1679],"\"",")",";",["T_WHITESPACE","\n            ",1679],"}",["T_WHITESPACE","\n            ",1680],["T_IF","if",1681],["T_WHITESPACE"," ",1681],"(","!",["T_VARIABLE","$this",1681],["T_OBJECT_OPERATOR","->",1681],["T_STRING","_fileUploader",1681],["T_OBJECT_OPERATOR","->",1681],["T_STRING","setDestDir",1681],"(",["T_VARIABLE","$destDir",1681],")",")",["T_WHITESPACE"," ",1681],"{",["T_WHITESPACE","\n                ",1681],["T_STRING","Mage",1682],["T_DOUBLE_COLON","::",1682],["T_STRING","throwException",1682],"(","\"",["T_ENCAPSED_AND_WHITESPACE","File directory '",1682],["T_CURLY_OPEN","{",1682],["T_VARIABLE","$destDir",1682],"}",["T_ENCAPSED_AND_WHITESPACE","' is not writable.",1682],"\"",")",";",["T_WHITESPACE","\n            ",1682],"}",["T_WHITESPACE","\n        ",1683],"}",["T_WHITESPACE","\n        ",1684],["T_RETURN","return",1685],["T_WHITESPACE"," ",1685],["T_VARIABLE","$this",1685],["T_OBJECT_OPERATOR","->",1685],["T_STRING","_fileUploader",1685],";",["T_WHITESPACE","\n    ",1685],"}",["T_WHITESPACE","\n\n    ",1686],["T_DOC_COMMENT","\/**\n     * Uploading files into the \"catalog\/product\" media folder.\n     * Return a new file name if the same file is already exists.\n     *\n     * @param string $fileName\n     * @return string\n     *\/",1688],["T_WHITESPACE","\n    ",1694],["T_PROTECTED","protected",1695],["T_WHITESPACE"," ",1695],["T_FUNCTION","function",1695],["T_WHITESPACE"," ",1695],["T_STRING","_uploadMediaFiles",1695],"(",["T_VARIABLE","$fileName",1695],")",["T_WHITESPACE","\n    ",1695],"{",["T_WHITESPACE","\n        ",1696],["T_TRY","try",1697],["T_WHITESPACE"," ",1697],"{",["T_WHITESPACE","\n            ",1697],["T_VARIABLE","$res",1698],["T_WHITESPACE"," ",1698],"=",["T_WHITESPACE"," ",1698],["T_VARIABLE","$this",1698],["T_OBJECT_OPERATOR","->",1698],["T_STRING","_getUploader",1698],"(",")",["T_OBJECT_OPERATOR","->",1698],["T_STRING","move",1698],"(",["T_VARIABLE","$fileName",1698],")",";",["T_WHITESPACE","\n            ",1698],["T_RETURN","return",1699],["T_WHITESPACE"," ",1699],["T_VARIABLE","$res",1699],"[",["T_CONSTANT_ENCAPSED_STRING","'file'",1699],"]",";",["T_WHITESPACE","\n        ",1699],"}",["T_WHITESPACE"," ",1700],["T_CATCH","catch",1700],["T_WHITESPACE"," ",1700],"(",["T_STRING","Exception",1700],["T_WHITESPACE"," ",1700],["T_VARIABLE","$e",1700],")",["T_WHITESPACE"," ",1700],"{",["T_WHITESPACE","\n            ",1700],["T_RETURN","return",1701],["T_WHITESPACE"," ",1701],["T_CONSTANT_ENCAPSED_STRING","''",1701],";",["T_WHITESPACE","\n        ",1701],"}",["T_WHITESPACE","\n    ",1702],"}",["T_WHITESPACE","\n\n    ",1703],["T_DOC_COMMENT","\/**\n     * Save product media gallery.\n     *\n     * @param array $mediaGalleryData\n     * @return Mage_ImportExport_Model_Import_Entity_Product\n     *\/",1705],["T_WHITESPACE","\n    ",1710],["T_PROTECTED","protected",1711],["T_WHITESPACE"," ",1711],["T_FUNCTION","function",1711],["T_WHITESPACE"," ",1711],["T_STRING","_saveMediaGallery",1711],"(",["T_ARRAY","array",1711],["T_WHITESPACE"," ",1711],["T_VARIABLE","$mediaGalleryData",1711],")",["T_WHITESPACE","\n    ",1711],"{",["T_WHITESPACE","\n        ",1712],["T_IF","if",1713],["T_WHITESPACE"," ",1713],"(",["T_EMPTY","empty",1713],"(",["T_VARIABLE","$mediaGalleryData",1713],")",")",["T_WHITESPACE"," ",1713],"{",["T_WHITESPACE","\n            ",1713],["T_RETURN","return",1714],["T_WHITESPACE"," ",1714],["T_VARIABLE","$this",1714],";",["T_WHITESPACE","\n        ",1714],"}",["T_WHITESPACE","\n\n        ",1715],["T_STATIC","static",1717],["T_WHITESPACE"," ",1717],["T_VARIABLE","$mediaGalleryTableName",1717],["T_WHITESPACE"," ",1717],"=",["T_WHITESPACE"," ",1717],["T_STRING","null",1717],";",["T_WHITESPACE","\n        ",1717],["T_STATIC","static",1718],["T_WHITESPACE"," ",1718],["T_VARIABLE","$mediaValueTableName",1718],["T_WHITESPACE"," ",1718],"=",["T_WHITESPACE"," ",1718],["T_STRING","null",1718],";",["T_WHITESPACE","\n        ",1718],["T_STATIC","static",1719],["T_WHITESPACE"," ",1719],["T_VARIABLE","$productId",1719],["T_WHITESPACE"," ",1719],"=",["T_WHITESPACE"," ",1719],["T_STRING","null",1719],";",["T_WHITESPACE","\n\n        ",1719],["T_IF","if",1721],["T_WHITESPACE"," ",1721],"(","!",["T_VARIABLE","$mediaGalleryTableName",1721],")",["T_WHITESPACE"," ",1721],"{",["T_WHITESPACE","\n            ",1721],["T_VARIABLE","$mediaGalleryTableName",1722],["T_WHITESPACE"," ",1722],"=",["T_WHITESPACE"," ",1722],["T_STRING","Mage",1722],["T_DOUBLE_COLON","::",1722],["T_STRING","getModel",1722],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport\/import_proxy_product_resource'",1722],")",["T_WHITESPACE","\n                    ",1722],["T_OBJECT_OPERATOR","->",1723],["T_STRING","getTable",1723],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_attribute_media_gallery'",1723],")",";",["T_WHITESPACE","\n        ",1723],"}",["T_WHITESPACE","\n\n        ",1724],["T_IF","if",1726],["T_WHITESPACE"," ",1726],"(","!",["T_VARIABLE","$mediaValueTableName",1726],")",["T_WHITESPACE"," ",1726],"{",["T_WHITESPACE","\n            ",1726],["T_VARIABLE","$mediaValueTableName",1727],["T_WHITESPACE"," ",1727],"=",["T_WHITESPACE"," ",1727],["T_STRING","Mage",1727],["T_DOUBLE_COLON","::",1727],["T_STRING","getModel",1727],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport\/import_proxy_product_resource'",1727],")",["T_WHITESPACE","\n                    ",1727],["T_OBJECT_OPERATOR","->",1728],["T_STRING","getTable",1728],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_attribute_media_gallery_value'",1728],")",";",["T_WHITESPACE","\n        ",1728],"}",["T_WHITESPACE","\n\n        ",1729],["T_FOREACH","foreach",1731],["T_WHITESPACE"," ",1731],"(",["T_VARIABLE","$mediaGalleryData",1731],["T_WHITESPACE"," ",1731],["T_AS","as",1731],["T_WHITESPACE"," ",1731],["T_VARIABLE","$productSku",1731],["T_WHITESPACE"," ",1731],["T_DOUBLE_ARROW","=>",1731],["T_WHITESPACE"," ",1731],["T_VARIABLE","$mediaGalleryRows",1731],")",["T_WHITESPACE"," ",1731],"{",["T_WHITESPACE","\n            ",1731],["T_VARIABLE","$productId",1732],["T_WHITESPACE"," ",1732],"=",["T_WHITESPACE"," ",1732],["T_VARIABLE","$this",1732],["T_OBJECT_OPERATOR","->",1732],["T_STRING","_newSku",1732],"[",["T_VARIABLE","$productSku",1732],"]","[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1732],"]",";",["T_WHITESPACE","\n            ",1732],["T_VARIABLE","$insertedGalleryImgs",1733],["T_WHITESPACE"," ",1733],"=",["T_WHITESPACE"," ",1733],["T_ARRAY","array",1733],"(",")",";",["T_WHITESPACE","\n\n            ",1733],["T_IF","if",1735],["T_WHITESPACE"," ",1735],"(",["T_STRING","Mage_ImportExport_Model_Import",1735],["T_DOUBLE_COLON","::",1735],["T_STRING","BEHAVIOR_APPEND",1735],["T_WHITESPACE"," ",1735],["T_IS_NOT_EQUAL","!=",1735],["T_WHITESPACE"," ",1735],["T_VARIABLE","$this",1735],["T_OBJECT_OPERATOR","->",1735],["T_STRING","getBehavior",1735],"(",")",")",["T_WHITESPACE"," ",1735],"{",["T_WHITESPACE","\n                ",1735],["T_VARIABLE","$this",1736],["T_OBJECT_OPERATOR","->",1736],["T_STRING","_connection",1736],["T_OBJECT_OPERATOR","->",1736],["T_STRING","delete",1736],"(",["T_WHITESPACE","\n                    ",1736],["T_VARIABLE","$mediaGalleryTableName",1737],",",["T_WHITESPACE","\n                    ",1737],["T_VARIABLE","$this",1738],["T_OBJECT_OPERATOR","->",1738],["T_STRING","_connection",1738],["T_OBJECT_OPERATOR","->",1738],["T_STRING","quoteInto",1738],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id IN (?)'",1738],",",["T_WHITESPACE"," ",1738],["T_VARIABLE","$productId",1738],")",["T_WHITESPACE","\n                ",1738],")",";",["T_WHITESPACE","\n            ",1739],"}",["T_WHITESPACE","\n\n            ",1740],["T_FOREACH","foreach",1742],["T_WHITESPACE"," ",1742],"(",["T_VARIABLE","$mediaGalleryRows",1742],["T_WHITESPACE"," ",1742],["T_AS","as",1742],["T_WHITESPACE"," ",1742],["T_VARIABLE","$insertValue",1742],")",["T_WHITESPACE"," ",1742],"{",["T_WHITESPACE","\n\n                ",1742],["T_IF","if",1744],["T_WHITESPACE"," ",1744],"(","!",["T_STRING","in_array",1744],"(",["T_VARIABLE","$insertValue",1744],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",1744],"]",",",["T_WHITESPACE"," ",1744],["T_VARIABLE","$insertedGalleryImgs",1744],")",")",["T_WHITESPACE"," ",1744],"{",["T_WHITESPACE","\n                    ",1744],["T_VARIABLE","$valueArr",1745],["T_WHITESPACE"," ",1745],"=",["T_WHITESPACE"," ",1745],["T_ARRAY","array",1745],"(",["T_WHITESPACE","\n                        ",1745],["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",1746],["T_WHITESPACE"," ",1746],["T_DOUBLE_ARROW","=>",1746],["T_WHITESPACE"," ",1746],["T_VARIABLE","$insertValue",1746],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",1746],"]",",",["T_WHITESPACE","\n                        ",1746],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1747],["T_WHITESPACE","    ",1747],["T_DOUBLE_ARROW","=>",1747],["T_WHITESPACE"," ",1747],["T_VARIABLE","$productId",1747],",",["T_WHITESPACE","\n                        ",1747],["T_CONSTANT_ENCAPSED_STRING","'value'",1748],["T_WHITESPACE","        ",1748],["T_DOUBLE_ARROW","=>",1748],["T_WHITESPACE"," ",1748],["T_VARIABLE","$insertValue",1748],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",1748],"]",["T_WHITESPACE","\n                    ",1748],")",";",["T_WHITESPACE","\n\n                    ",1749],["T_VARIABLE","$this",1751],["T_OBJECT_OPERATOR","->",1751],["T_STRING","_connection",1751],["T_WHITESPACE","\n                            ",1751],["T_OBJECT_OPERATOR","->",1752],["T_STRING","insertOnDuplicate",1752],"(",["T_VARIABLE","$mediaGalleryTableName",1752],",",["T_WHITESPACE"," ",1752],["T_VARIABLE","$valueArr",1752],",",["T_WHITESPACE"," ",1752],["T_ARRAY","array",1752],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1752],")",")",";",["T_WHITESPACE","\n\n                    ",1752],["T_VARIABLE","$insertedGalleryImgs",1754],"[","]",["T_WHITESPACE"," ",1754],"=",["T_WHITESPACE"," ",1754],["T_VARIABLE","$insertValue",1754],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",1754],"]",";",["T_WHITESPACE","\n                ",1754],"}",["T_WHITESPACE","\n\n                ",1755],["T_VARIABLE","$newMediaValues",1757],["T_WHITESPACE"," ",1757],"=",["T_WHITESPACE"," ",1757],["T_VARIABLE","$this",1757],["T_OBJECT_OPERATOR","->",1757],["T_STRING","_connection",1757],["T_OBJECT_OPERATOR","->",1757],["T_STRING","fetchPairs",1757],"(",["T_VARIABLE","$this",1757],["T_OBJECT_OPERATOR","->",1757],["T_STRING","_connection",1757],["T_OBJECT_OPERATOR","->",1757],["T_STRING","select",1757],"(",")",["T_WHITESPACE","\n                                        ",1757],["T_OBJECT_OPERATOR","->",1758],["T_STRING","from",1758],"(",["T_VARIABLE","$mediaGalleryTableName",1758],",",["T_WHITESPACE"," ",1758],["T_ARRAY","array",1758],"(",["T_CONSTANT_ENCAPSED_STRING","'value'",1758],",",["T_WHITESPACE"," ",1758],["T_CONSTANT_ENCAPSED_STRING","'value_id'",1758],")",")",["T_WHITESPACE","\n                                        ",1758],["T_OBJECT_OPERATOR","->",1759],["T_STRING","where",1759],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id IN (?)'",1759],",",["T_WHITESPACE"," ",1759],["T_VARIABLE","$productId",1759],")",["T_WHITESPACE","\n                ",1759],")",";",["T_WHITESPACE","\n\n                ",1760],["T_IF","if",1762],["T_WHITESPACE"," ",1762],"(",["T_STRING","array_key_exists",1762],"(",["T_VARIABLE","$insertValue",1762],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",1762],"]",",",["T_WHITESPACE"," ",1762],["T_VARIABLE","$newMediaValues",1762],")",")",["T_WHITESPACE"," ",1762],"{",["T_WHITESPACE","\n                    ",1762],["T_VARIABLE","$insertValue",1763],"[",["T_CONSTANT_ENCAPSED_STRING","'value_id'",1763],"]",["T_WHITESPACE"," ",1763],"=",["T_WHITESPACE"," ",1763],["T_VARIABLE","$newMediaValues",1763],"[",["T_VARIABLE","$insertValue",1763],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",1763],"]","]",";",["T_WHITESPACE","\n                ",1763],"}",["T_WHITESPACE","\n\n                ",1764],["T_VARIABLE","$valueArr",1766],["T_WHITESPACE"," ",1766],"=",["T_WHITESPACE"," ",1766],["T_ARRAY","array",1766],"(",["T_WHITESPACE","\n                    ",1766],["T_CONSTANT_ENCAPSED_STRING","'value_id'",1767],["T_WHITESPACE"," ",1767],["T_DOUBLE_ARROW","=>",1767],["T_WHITESPACE"," ",1767],["T_VARIABLE","$insertValue",1767],"[",["T_CONSTANT_ENCAPSED_STRING","'value_id'",1767],"]",",",["T_WHITESPACE","\n                    ",1767],["T_CONSTANT_ENCAPSED_STRING","'store_id'",1768],["T_WHITESPACE"," ",1768],["T_DOUBLE_ARROW","=>",1768],["T_WHITESPACE"," ",1768],["T_STRING","Mage_Catalog_Model_Abstract",1768],["T_DOUBLE_COLON","::",1768],["T_STRING","DEFAULT_STORE_ID",1768],",",["T_WHITESPACE","\n                    ",1768],["T_CONSTANT_ENCAPSED_STRING","'label'",1769],["T_WHITESPACE","    ",1769],["T_DOUBLE_ARROW","=>",1769],["T_WHITESPACE"," ",1769],["T_VARIABLE","$insertValue",1769],"[",["T_CONSTANT_ENCAPSED_STRING","'label'",1769],"]",",",["T_WHITESPACE","\n                    ",1769],["T_CONSTANT_ENCAPSED_STRING","'position'",1770],["T_WHITESPACE"," ",1770],["T_DOUBLE_ARROW","=>",1770],["T_WHITESPACE"," ",1770],["T_VARIABLE","$insertValue",1770],"[",["T_CONSTANT_ENCAPSED_STRING","'position'",1770],"]",",",["T_WHITESPACE","\n                    ",1770],["T_CONSTANT_ENCAPSED_STRING","'disabled'",1771],["T_WHITESPACE"," ",1771],["T_DOUBLE_ARROW","=>",1771],["T_WHITESPACE"," ",1771],["T_VARIABLE","$insertValue",1771],"[",["T_CONSTANT_ENCAPSED_STRING","'disabled'",1771],"]",["T_WHITESPACE","\n                ",1771],")",";",["T_WHITESPACE","\n\n                ",1772],["T_TRY","try",1774],["T_WHITESPACE"," ",1774],"{",["T_WHITESPACE","\n                    ",1774],["T_VARIABLE","$this",1775],["T_OBJECT_OPERATOR","->",1775],["T_STRING","_connection",1775],["T_WHITESPACE","\n                            ",1775],["T_OBJECT_OPERATOR","->",1776],["T_STRING","insertOnDuplicate",1776],"(",["T_VARIABLE","$mediaValueTableName",1776],",",["T_WHITESPACE"," ",1776],["T_VARIABLE","$valueArr",1776],",",["T_WHITESPACE"," ",1776],["T_ARRAY","array",1776],"(",["T_CONSTANT_ENCAPSED_STRING","'value_id'",1776],")",")",";",["T_WHITESPACE","\n                ",1776],"}",["T_WHITESPACE"," ",1777],["T_CATCH","catch",1777],["T_WHITESPACE"," ",1777],"(",["T_STRING","Exception",1777],["T_WHITESPACE"," ",1777],["T_VARIABLE","$e",1777],")",["T_WHITESPACE"," ",1777],"{",["T_WHITESPACE","\n                    ",1777],["T_VARIABLE","$this",1778],["T_OBJECT_OPERATOR","->",1778],["T_STRING","_connection",1778],["T_OBJECT_OPERATOR","->",1778],["T_STRING","delete",1778],"(",["T_WHITESPACE","\n                            ",1778],["T_VARIABLE","$mediaGalleryTableName",1779],",",["T_WHITESPACE"," ",1779],["T_VARIABLE","$this",1779],["T_OBJECT_OPERATOR","->",1779],["T_STRING","_connection",1779],["T_OBJECT_OPERATOR","->",1779],["T_STRING","quoteInto",1779],"(",["T_CONSTANT_ENCAPSED_STRING","'value_id IN (?)'",1779],",",["T_WHITESPACE"," ",1779],["T_VARIABLE","$newMediaValues",1779],")",["T_WHITESPACE","\n                    ",1779],")",";",["T_WHITESPACE","\n                ",1780],"}",["T_WHITESPACE","\n            ",1781],"}",["T_WHITESPACE","\n        ",1782],"}",["T_WHITESPACE","\n\n        ",1783],["T_RETURN","return",1785],["T_WHITESPACE"," ",1785],["T_VARIABLE","$this",1785],";",["T_WHITESPACE","\n    ",1785],"}",["T_WHITESPACE","\n\n    ",1786],["T_DOC_COMMENT","\/**\n     * Save product websites.\n     *\n     * @param array $websiteData\n     * @return Mage_ImportExport_Model_Import_Entity_Product\n     *\/",1788],["T_WHITESPACE","\n    ",1793],["T_PROTECTED","protected",1794],["T_WHITESPACE"," ",1794],["T_FUNCTION","function",1794],["T_WHITESPACE"," ",1794],["T_STRING","_saveProductWebsites",1794],"(",["T_ARRAY","array",1794],["T_WHITESPACE"," ",1794],["T_VARIABLE","$websiteData",1794],")",["T_WHITESPACE","\n    ",1794],"{",["T_WHITESPACE","\n        ",1795],["T_STATIC","static",1796],["T_WHITESPACE"," ",1796],["T_VARIABLE","$tableName",1796],["T_WHITESPACE"," ",1796],"=",["T_WHITESPACE"," ",1796],["T_STRING","null",1796],";",["T_WHITESPACE","\n\n        ",1796],["T_IF","if",1798],["T_WHITESPACE"," ",1798],"(","!",["T_VARIABLE","$tableName",1798],")",["T_WHITESPACE"," ",1798],"{",["T_WHITESPACE","\n            ",1798],["T_VARIABLE","$tableName",1799],["T_WHITESPACE"," ",1799],"=",["T_WHITESPACE"," ",1799],["T_STRING","Mage",1799],["T_DOUBLE_COLON","::",1799],["T_STRING","getModel",1799],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport\/import_proxy_product_resource'",1799],")",["T_OBJECT_OPERATOR","->",1799],["T_STRING","getProductWebsiteTable",1799],"(",")",";",["T_WHITESPACE","\n        ",1799],"}",["T_WHITESPACE","\n        ",1800],["T_IF","if",1801],["T_WHITESPACE"," ",1801],"(",["T_VARIABLE","$websiteData",1801],")",["T_WHITESPACE"," ",1801],"{",["T_WHITESPACE","\n            ",1801],["T_VARIABLE","$websitesData",1802],["T_WHITESPACE"," ",1802],"=",["T_WHITESPACE"," ",1802],["T_ARRAY","array",1802],"(",")",";",["T_WHITESPACE","\n            ",1802],["T_VARIABLE","$delProductId",1803],["T_WHITESPACE"," ",1803],"=",["T_WHITESPACE"," ",1803],["T_ARRAY","array",1803],"(",")",";",["T_WHITESPACE","\n\n            ",1803],["T_FOREACH","foreach",1805],["T_WHITESPACE"," ",1805],"(",["T_VARIABLE","$websiteData",1805],["T_WHITESPACE"," ",1805],["T_AS","as",1805],["T_WHITESPACE"," ",1805],["T_VARIABLE","$delSku",1805],["T_WHITESPACE"," ",1805],["T_DOUBLE_ARROW","=>",1805],["T_WHITESPACE"," ",1805],["T_VARIABLE","$websites",1805],")",["T_WHITESPACE"," ",1805],"{",["T_WHITESPACE","\n                ",1805],["T_VARIABLE","$productId",1806],["T_WHITESPACE","      ",1806],"=",["T_WHITESPACE"," ",1806],["T_VARIABLE","$this",1806],["T_OBJECT_OPERATOR","->",1806],["T_STRING","_newSku",1806],"[",["T_VARIABLE","$delSku",1806],"]","[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1806],"]",";",["T_WHITESPACE","\n                ",1806],["T_VARIABLE","$delProductId",1807],"[","]",["T_WHITESPACE"," ",1807],"=",["T_WHITESPACE"," ",1807],["T_VARIABLE","$productId",1807],";",["T_WHITESPACE","\n\n                ",1807],["T_FOREACH","foreach",1809],["T_WHITESPACE"," ",1809],"(",["T_STRING","array_keys",1809],"(",["T_VARIABLE","$websites",1809],")",["T_WHITESPACE"," ",1809],["T_AS","as",1809],["T_WHITESPACE"," ",1809],["T_VARIABLE","$websiteId",1809],")",["T_WHITESPACE"," ",1809],"{",["T_WHITESPACE","\n                    ",1809],["T_VARIABLE","$websitesData",1810],"[","]",["T_WHITESPACE"," ",1810],"=",["T_WHITESPACE"," ",1810],["T_ARRAY","array",1810],"(",["T_WHITESPACE","\n                        ",1810],["T_CONSTANT_ENCAPSED_STRING","'product_id'",1811],["T_WHITESPACE"," ",1811],["T_DOUBLE_ARROW","=>",1811],["T_WHITESPACE"," ",1811],["T_VARIABLE","$productId",1811],",",["T_WHITESPACE","\n                        ",1811],["T_CONSTANT_ENCAPSED_STRING","'website_id'",1812],["T_WHITESPACE"," ",1812],["T_DOUBLE_ARROW","=>",1812],["T_WHITESPACE"," ",1812],["T_VARIABLE","$websiteId",1812],["T_WHITESPACE","\n                    ",1812],")",";",["T_WHITESPACE","\n                ",1813],"}",["T_WHITESPACE","\n            ",1814],"}",["T_WHITESPACE","\n            ",1815],["T_IF","if",1816],["T_WHITESPACE"," ",1816],"(",["T_STRING","Mage_ImportExport_Model_Import",1816],["T_DOUBLE_COLON","::",1816],["T_STRING","BEHAVIOR_APPEND",1816],["T_WHITESPACE"," ",1816],["T_IS_NOT_EQUAL","!=",1816],["T_WHITESPACE"," ",1816],["T_VARIABLE","$this",1816],["T_OBJECT_OPERATOR","->",1816],["T_STRING","getBehavior",1816],"(",")",")",["T_WHITESPACE"," ",1816],"{",["T_WHITESPACE","\n                ",1816],["T_VARIABLE","$this",1817],["T_OBJECT_OPERATOR","->",1817],["T_STRING","_connection",1817],["T_OBJECT_OPERATOR","->",1817],["T_STRING","delete",1817],"(",["T_WHITESPACE","\n                    ",1817],["T_VARIABLE","$tableName",1818],",",["T_WHITESPACE","\n                    ",1818],["T_VARIABLE","$this",1819],["T_OBJECT_OPERATOR","->",1819],["T_STRING","_connection",1819],["T_OBJECT_OPERATOR","->",1819],["T_STRING","quoteInto",1819],"(",["T_CONSTANT_ENCAPSED_STRING","'product_id IN (?)'",1819],",",["T_WHITESPACE"," ",1819],["T_VARIABLE","$delProductId",1819],")",["T_WHITESPACE","\n                ",1819],")",";",["T_WHITESPACE","\n            ",1820],"}",["T_WHITESPACE","\n            ",1821],["T_IF","if",1822],["T_WHITESPACE"," ",1822],"(",["T_VARIABLE","$websitesData",1822],")",["T_WHITESPACE"," ",1822],"{",["T_WHITESPACE","\n                ",1822],["T_VARIABLE","$this",1823],["T_OBJECT_OPERATOR","->",1823],["T_STRING","_connection",1823],["T_OBJECT_OPERATOR","->",1823],["T_STRING","insertOnDuplicate",1823],"(",["T_VARIABLE","$tableName",1823],",",["T_WHITESPACE"," ",1823],["T_VARIABLE","$websitesData",1823],")",";",["T_WHITESPACE","\n            ",1823],"}",["T_WHITESPACE","\n        ",1824],"}",["T_WHITESPACE","\n        ",1825],["T_RETURN","return",1826],["T_WHITESPACE"," ",1826],["T_VARIABLE","$this",1826],";",["T_WHITESPACE","\n    ",1826],"}",["T_WHITESPACE","\n\n    ",1827],["T_DOC_COMMENT","\/**\n     * Returns resource model\n     *\n     * @param string $resourceModelName\n     * @return Object\n     *\/",1829],["T_WHITESPACE","\n    ",1834],["T_PROTECTED","protected",1835],["T_WHITESPACE"," ",1835],["T_FUNCTION","function",1835],["T_WHITESPACE"," ",1835],["T_STRING","getResourceModel",1835],"(",["T_VARIABLE","$resourceModelName",1835],")",["T_WHITESPACE","\n    ",1835],"{",["T_WHITESPACE","\n        ",1836],["T_RETURN","return",1837],["T_WHITESPACE"," ",1837],["T_STRING","Mage",1837],["T_DOUBLE_COLON","::",1837],["T_STRING","getResourceModel",1837],"(",["T_VARIABLE","$resourceModelName",1837],")",";",["T_WHITESPACE","\n    ",1837],"}",["T_WHITESPACE","\n\n    ",1838],["T_DOC_COMMENT","\/**\n     * Returns helper\n     *\n     * @param string $helperName\n     * @return Mage_Core_Helper_Abstract\n     *\/",1840],["T_WHITESPACE","\n    ",1845],["T_PROTECTED","protected",1846],["T_WHITESPACE"," ",1846],["T_FUNCTION","function",1846],["T_WHITESPACE"," ",1846],["T_STRING","getHelper",1846],"(",["T_VARIABLE","$helperName",1846],")",["T_WHITESPACE","\n    ",1846],"{",["T_WHITESPACE","\n        ",1847],["T_RETURN","return",1848],["T_WHITESPACE"," ",1848],["T_STRING","Mage",1848],["T_DOUBLE_COLON","::",1848],["T_STRING","helper",1848],"(",["T_VARIABLE","$helperName",1848],")",";",["T_WHITESPACE","\n    ",1848],"}",["T_WHITESPACE","\n\n    ",1849],["T_DOC_COMMENT","\/**\n     * Returns model\n     *\n     * @param string $modelName\n     * @return bool|Mage_Core_Model_Abstract\n     *\/",1851],["T_WHITESPACE","\n    ",1856],["T_PROTECTED","protected",1857],["T_WHITESPACE"," ",1857],["T_FUNCTION","function",1857],["T_WHITESPACE"," ",1857],["T_STRING","getModel",1857],"(",["T_VARIABLE","$modelName",1857],")",["T_WHITESPACE","\n    ",1857],"{",["T_WHITESPACE","\n        ",1858],["T_RETURN","return",1859],["T_WHITESPACE"," ",1859],["T_STRING","Mage",1859],["T_DOUBLE_COLON","::",1859],["T_STRING","getModel",1859],"(",["T_VARIABLE","$modelName",1859],")",";",["T_WHITESPACE","\n    ",1859],"}",["T_WHITESPACE","\n\n    ",1860],["T_DOC_COMMENT","\/**\n     * Stock item saving.\n     *\n     * @return Mage_ImportExport_Model_Import_Entity_Product\n     *\/",1862],["T_WHITESPACE","\n    ",1866],["T_PROTECTED","protected",1867],["T_WHITESPACE"," ",1867],["T_FUNCTION","function",1867],["T_WHITESPACE"," ",1867],["T_STRING","_saveStockItem",1867],"(",")",["T_WHITESPACE","\n    ",1867],"{",["T_WHITESPACE","\n        ",1868],["T_VARIABLE","$defaultStockData",1869],["T_WHITESPACE"," ",1869],"=",["T_WHITESPACE"," ",1869],["T_ARRAY","array",1869],"(",["T_WHITESPACE","\n            ",1869],["T_CONSTANT_ENCAPSED_STRING","'manage_stock'",1870],["T_WHITESPACE","                  ",1870],["T_DOUBLE_ARROW","=>",1870],["T_WHITESPACE"," ",1870],["T_LNUMBER","1",1870],",",["T_WHITESPACE","\n            ",1870],["T_CONSTANT_ENCAPSED_STRING","'use_config_manage_stock'",1871],["T_WHITESPACE","       ",1871],["T_DOUBLE_ARROW","=>",1871],["T_WHITESPACE"," ",1871],["T_LNUMBER","1",1871],",",["T_WHITESPACE","\n            ",1871],["T_CONSTANT_ENCAPSED_STRING","'qty'",1872],["T_WHITESPACE","                           ",1872],["T_DOUBLE_ARROW","=>",1872],["T_WHITESPACE"," ",1872],["T_LNUMBER","0",1872],",",["T_WHITESPACE","\n            ",1872],["T_CONSTANT_ENCAPSED_STRING","'min_qty'",1873],["T_WHITESPACE","                       ",1873],["T_DOUBLE_ARROW","=>",1873],["T_WHITESPACE"," ",1873],["T_LNUMBER","0",1873],",",["T_WHITESPACE","\n            ",1873],["T_CONSTANT_ENCAPSED_STRING","'use_config_min_qty'",1874],["T_WHITESPACE","            ",1874],["T_DOUBLE_ARROW","=>",1874],["T_WHITESPACE"," ",1874],["T_LNUMBER","1",1874],",",["T_WHITESPACE","\n            ",1874],["T_CONSTANT_ENCAPSED_STRING","'min_sale_qty'",1875],["T_WHITESPACE","                  ",1875],["T_DOUBLE_ARROW","=>",1875],["T_WHITESPACE"," ",1875],["T_LNUMBER","1",1875],",",["T_WHITESPACE","\n            ",1875],["T_CONSTANT_ENCAPSED_STRING","'use_config_min_sale_qty'",1876],["T_WHITESPACE","       ",1876],["T_DOUBLE_ARROW","=>",1876],["T_WHITESPACE"," ",1876],["T_LNUMBER","1",1876],",",["T_WHITESPACE","\n            ",1876],["T_CONSTANT_ENCAPSED_STRING","'max_sale_qty'",1877],["T_WHITESPACE","                  ",1877],["T_DOUBLE_ARROW","=>",1877],["T_WHITESPACE"," ",1877],["T_LNUMBER","10000",1877],",",["T_WHITESPACE","\n            ",1877],["T_CONSTANT_ENCAPSED_STRING","'use_config_max_sale_qty'",1878],["T_WHITESPACE","       ",1878],["T_DOUBLE_ARROW","=>",1878],["T_WHITESPACE"," ",1878],["T_LNUMBER","1",1878],",",["T_WHITESPACE","\n            ",1878],["T_CONSTANT_ENCAPSED_STRING","'is_qty_decimal'",1879],["T_WHITESPACE","                ",1879],["T_DOUBLE_ARROW","=>",1879],["T_WHITESPACE"," ",1879],["T_LNUMBER","0",1879],",",["T_WHITESPACE","\n            ",1879],["T_CONSTANT_ENCAPSED_STRING","'backorders'",1880],["T_WHITESPACE","                    ",1880],["T_DOUBLE_ARROW","=>",1880],["T_WHITESPACE"," ",1880],["T_LNUMBER","0",1880],",",["T_WHITESPACE","\n            ",1880],["T_CONSTANT_ENCAPSED_STRING","'use_config_backorders'",1881],["T_WHITESPACE","         ",1881],["T_DOUBLE_ARROW","=>",1881],["T_WHITESPACE"," ",1881],["T_LNUMBER","1",1881],",",["T_WHITESPACE","\n            ",1881],["T_CONSTANT_ENCAPSED_STRING","'notify_stock_qty'",1882],["T_WHITESPACE","              ",1882],["T_DOUBLE_ARROW","=>",1882],["T_WHITESPACE"," ",1882],["T_LNUMBER","1",1882],",",["T_WHITESPACE","\n            ",1882],["T_CONSTANT_ENCAPSED_STRING","'use_config_notify_stock_qty'",1883],["T_WHITESPACE","   ",1883],["T_DOUBLE_ARROW","=>",1883],["T_WHITESPACE"," ",1883],["T_LNUMBER","1",1883],",",["T_WHITESPACE","\n            ",1883],["T_CONSTANT_ENCAPSED_STRING","'enable_qty_increments'",1884],["T_WHITESPACE","         ",1884],["T_DOUBLE_ARROW","=>",1884],["T_WHITESPACE"," ",1884],["T_LNUMBER","0",1884],",",["T_WHITESPACE","\n            ",1884],["T_CONSTANT_ENCAPSED_STRING","'use_config_enable_qty_inc'",1885],["T_WHITESPACE","     ",1885],["T_DOUBLE_ARROW","=>",1885],["T_WHITESPACE"," ",1885],["T_LNUMBER","1",1885],",",["T_WHITESPACE","\n            ",1885],["T_CONSTANT_ENCAPSED_STRING","'qty_increments'",1886],["T_WHITESPACE","                ",1886],["T_DOUBLE_ARROW","=>",1886],["T_WHITESPACE"," ",1886],["T_LNUMBER","0",1886],",",["T_WHITESPACE","\n            ",1886],["T_CONSTANT_ENCAPSED_STRING","'use_config_qty_increments'",1887],["T_WHITESPACE","     ",1887],["T_DOUBLE_ARROW","=>",1887],["T_WHITESPACE"," ",1887],["T_LNUMBER","1",1887],",",["T_WHITESPACE","\n            ",1887],["T_CONSTANT_ENCAPSED_STRING","'is_in_stock'",1888],["T_WHITESPACE","                   ",1888],["T_DOUBLE_ARROW","=>",1888],["T_WHITESPACE"," ",1888],["T_LNUMBER","0",1888],",",["T_WHITESPACE","\n            ",1888],["T_CONSTANT_ENCAPSED_STRING","'low_stock_date'",1889],["T_WHITESPACE","                ",1889],["T_DOUBLE_ARROW","=>",1889],["T_WHITESPACE"," ",1889],["T_STRING","null",1889],",",["T_WHITESPACE","\n            ",1889],["T_CONSTANT_ENCAPSED_STRING","'stock_status_changed_auto'",1890],["T_WHITESPACE","     ",1890],["T_DOUBLE_ARROW","=>",1890],["T_WHITESPACE"," ",1890],["T_LNUMBER","0",1890],",",["T_WHITESPACE","\n            ",1890],["T_CONSTANT_ENCAPSED_STRING","'is_decimal_divided'",1891],["T_WHITESPACE","            ",1891],["T_DOUBLE_ARROW","=>",1891],["T_WHITESPACE"," ",1891],["T_LNUMBER","0",1891],["T_WHITESPACE","\n        ",1891],")",";",["T_WHITESPACE","\n\n        ",1892],["T_VARIABLE","$entityTable",1894],["T_WHITESPACE"," ",1894],"=",["T_WHITESPACE"," ",1894],["T_VARIABLE","$this",1894],["T_OBJECT_OPERATOR","->",1894],["T_STRING","getResourceModel",1894],"(",["T_CONSTANT_ENCAPSED_STRING","'cataloginventory\/stock_item'",1894],")",["T_OBJECT_OPERATOR","->",1894],["T_STRING","getMainTable",1894],"(",")",";",["T_WHITESPACE","\n        ",1894],["T_VARIABLE","$helper",1895],["T_WHITESPACE","      ",1895],"=",["T_WHITESPACE"," ",1895],["T_VARIABLE","$this",1895],["T_OBJECT_OPERATOR","->",1895],["T_STRING","getHelper",1895],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogInventory'",1895],")",";",["T_WHITESPACE","\n\n        ",1895],["T_WHILE","while",1897],["T_WHITESPACE"," ",1897],"(",["T_VARIABLE","$bunch",1897],["T_WHITESPACE"," ",1897],"=",["T_WHITESPACE"," ",1897],["T_VARIABLE","$this",1897],["T_OBJECT_OPERATOR","->",1897],["T_STRING","getNextBunch",1897],"(",")",")",["T_WHITESPACE"," ",1897],"{",["T_WHITESPACE","\n            ",1897],["T_VARIABLE","$stockData",1898],["T_WHITESPACE"," ",1898],"=",["T_WHITESPACE"," ",1898],["T_ARRAY","array",1898],"(",")",";",["T_WHITESPACE","\n\n            ",1898],["T_COMMENT","\/\/ Format bunch to stock data rows\n",1900],["T_WHITESPACE","            ",1901],["T_FOREACH","foreach",1901],["T_WHITESPACE"," ",1901],"(",["T_VARIABLE","$bunch",1901],["T_WHITESPACE"," ",1901],["T_AS","as",1901],["T_WHITESPACE"," ",1901],["T_VARIABLE","$rowNum",1901],["T_WHITESPACE"," ",1901],["T_DOUBLE_ARROW","=>",1901],["T_WHITESPACE"," ",1901],["T_VARIABLE","$rowData",1901],")",["T_WHITESPACE"," ",1901],"{",["T_WHITESPACE","\n                ",1901],["T_VARIABLE","$this",1902],["T_OBJECT_OPERATOR","->",1902],["T_STRING","_filterRowData",1902],"(",["T_VARIABLE","$rowData",1902],")",";",["T_WHITESPACE","\n                ",1902],["T_IF","if",1903],["T_WHITESPACE"," ",1903],"(","!",["T_VARIABLE","$this",1903],["T_OBJECT_OPERATOR","->",1903],["T_STRING","isRowAllowedToImport",1903],"(",["T_VARIABLE","$rowData",1903],",",["T_WHITESPACE"," ",1903],["T_VARIABLE","$rowNum",1903],")",")",["T_WHITESPACE"," ",1903],"{",["T_WHITESPACE","\n                    ",1903],["T_CONTINUE","continue",1904],";",["T_WHITESPACE","\n                ",1904],"}",["T_WHITESPACE","\n                ",1905],["T_COMMENT","\/\/ only SCOPE_DEFAULT can contain stock data\n",1906],["T_WHITESPACE","                ",1907],["T_IF","if",1907],["T_WHITESPACE"," ",1907],"(",["T_STRING","self",1907],["T_DOUBLE_COLON","::",1907],["T_STRING","SCOPE_DEFAULT",1907],["T_WHITESPACE"," ",1907],["T_IS_NOT_EQUAL","!=",1907],["T_WHITESPACE"," ",1907],["T_VARIABLE","$this",1907],["T_OBJECT_OPERATOR","->",1907],["T_STRING","getRowScope",1907],"(",["T_VARIABLE","$rowData",1907],")",")",["T_WHITESPACE"," ",1907],"{",["T_WHITESPACE","\n                    ",1907],["T_CONTINUE","continue",1908],";",["T_WHITESPACE","\n                ",1908],"}",["T_WHITESPACE","\n\n                ",1909],["T_VARIABLE","$row",1911],["T_WHITESPACE"," ",1911],"=",["T_WHITESPACE"," ",1911],["T_ARRAY","array",1911],"(",")",";",["T_WHITESPACE","\n                ",1911],["T_VARIABLE","$row",1912],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",1912],"]",["T_WHITESPACE"," ",1912],"=",["T_WHITESPACE"," ",1912],["T_VARIABLE","$this",1912],["T_OBJECT_OPERATOR","->",1912],["T_STRING","_newSku",1912],"[",["T_VARIABLE","$rowData",1912],"[",["T_STRING","self",1912],["T_DOUBLE_COLON","::",1912],["T_STRING","COL_SKU",1912],"]","]","[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",1912],"]",";",["T_WHITESPACE","\n                ",1912],["T_VARIABLE","$row",1913],"[",["T_CONSTANT_ENCAPSED_STRING","'stock_id'",1913],"]",["T_WHITESPACE"," ",1913],"=",["T_WHITESPACE"," ",1913],["T_LNUMBER","1",1913],";",["T_WHITESPACE","\n\n                ",1913],["T_DOC_COMMENT","\/** @var $stockItem Mage_CatalogInventory_Model_Stock_Item *\/",1915],["T_WHITESPACE","\n                ",1915],["T_VARIABLE","$stockItem",1916],["T_WHITESPACE"," ",1916],"=",["T_WHITESPACE"," ",1916],["T_VARIABLE","$this",1916],["T_OBJECT_OPERATOR","->",1916],["T_STRING","getModel",1916],"(",["T_CONSTANT_ENCAPSED_STRING","'cataloginventory\/stock_item'",1916],")",";",["T_WHITESPACE","\n                ",1916],["T_VARIABLE","$stockItem",1917],["T_OBJECT_OPERATOR","->",1917],["T_STRING","loadByProduct",1917],"(",["T_VARIABLE","$row",1917],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",1917],"]",")",";",["T_WHITESPACE","\n                ",1917],["T_VARIABLE","$existStockData",1918],["T_WHITESPACE"," ",1918],"=",["T_WHITESPACE"," ",1918],["T_VARIABLE","$stockItem",1918],["T_OBJECT_OPERATOR","->",1918],["T_STRING","getData",1918],"(",")",";",["T_WHITESPACE","\n\n                ",1918],["T_VARIABLE","$row",1920],["T_WHITESPACE"," ",1920],"=",["T_WHITESPACE"," ",1920],["T_STRING","array_merge",1920],"(",["T_WHITESPACE","\n                    ",1920],["T_VARIABLE","$defaultStockData",1921],",",["T_WHITESPACE","\n                    ",1921],["T_STRING","array_intersect_key",1922],"(",["T_VARIABLE","$existStockData",1922],",",["T_WHITESPACE"," ",1922],["T_VARIABLE","$defaultStockData",1922],")",",",["T_WHITESPACE","\n                    ",1922],["T_STRING","array_intersect_key",1923],"(",["T_VARIABLE","$rowData",1923],",",["T_WHITESPACE"," ",1923],["T_VARIABLE","$defaultStockData",1923],")",",",["T_WHITESPACE","\n                    ",1923],["T_VARIABLE","$row",1924],["T_WHITESPACE","\n                ",1924],")",";",["T_WHITESPACE","\n\n                ",1925],["T_VARIABLE","$stockItem",1927],["T_OBJECT_OPERATOR","->",1927],["T_STRING","setData",1927],"(",["T_VARIABLE","$row",1927],")",";",["T_WHITESPACE","\n                ",1927],["T_UNSET","unset",1928],"(",["T_VARIABLE","$row",1928],")",";",["T_WHITESPACE","\n                ",1928],["T_IF","if",1929],["T_WHITESPACE"," ",1929],"(",["T_VARIABLE","$helper",1929],["T_OBJECT_OPERATOR","->",1929],["T_STRING","isQty",1929],"(",["T_VARIABLE","$this",1929],["T_OBJECT_OPERATOR","->",1929],["T_STRING","_newSku",1929],"[",["T_VARIABLE","$rowData",1929],"[",["T_STRING","self",1929],["T_DOUBLE_COLON","::",1929],["T_STRING","COL_SKU",1929],"]","]","[",["T_CONSTANT_ENCAPSED_STRING","'type_id'",1929],"]",")",")",["T_WHITESPACE"," ",1929],"{",["T_WHITESPACE","\n                    ",1929],["T_IF","if",1930],["T_WHITESPACE"," ",1930],"(",["T_VARIABLE","$stockItem",1930],["T_OBJECT_OPERATOR","->",1930],["T_STRING","verifyNotification",1930],"(",")",")",["T_WHITESPACE"," ",1930],"{",["T_WHITESPACE","\n                        ",1930],["T_VARIABLE","$stockItem",1931],["T_OBJECT_OPERATOR","->",1931],["T_STRING","setLowStockDate",1931],"(",["T_STRING","Mage",1931],["T_DOUBLE_COLON","::",1931],["T_STRING","app",1931],"(",")",["T_OBJECT_OPERATOR","->",1931],["T_STRING","getLocale",1931],"(",")",["T_WHITESPACE","\n                            ",1931],["T_OBJECT_OPERATOR","->",1932],["T_STRING","date",1932],"(",["T_STRING","null",1932],",",["T_WHITESPACE"," ",1932],["T_STRING","null",1932],",",["T_WHITESPACE"," ",1932],["T_STRING","null",1932],",",["T_WHITESPACE"," ",1932],["T_STRING","false",1932],")",["T_WHITESPACE","\n                            ",1932],["T_OBJECT_OPERATOR","->",1933],["T_STRING","toString",1933],"(",["T_STRING","Varien_Date",1933],["T_DOUBLE_COLON","::",1933],["T_STRING","DATETIME_INTERNAL_FORMAT",1933],")",["T_WHITESPACE","\n                        ",1933],")",";",["T_WHITESPACE","\n                    ",1934],"}",["T_WHITESPACE","\n                    ",1935],["T_VARIABLE","$stockItem",1936],["T_OBJECT_OPERATOR","->",1936],["T_STRING","setStockStatusChangedAutomatically",1936],"(",["T_INT_CAST","(int)",1936],["T_WHITESPACE"," ",1936],"!",["T_VARIABLE","$stockItem",1936],["T_OBJECT_OPERATOR","->",1936],["T_STRING","verifyStock",1936],"(",")",")",";",["T_WHITESPACE","\n                ",1936],"}",["T_WHITESPACE"," ",1937],["T_ELSE","else",1937],["T_WHITESPACE"," ",1937],"{",["T_WHITESPACE","\n                    ",1937],["T_VARIABLE","$stockItem",1938],["T_OBJECT_OPERATOR","->",1938],["T_STRING","setQty",1938],"(",["T_LNUMBER","0",1938],")",";",["T_WHITESPACE","\n                ",1938],"}",["T_WHITESPACE","\n                ",1939],["T_VARIABLE","$stockData",1940],"[","]",["T_WHITESPACE"," ",1940],"=",["T_WHITESPACE"," ",1940],["T_VARIABLE","$stockItem",1940],["T_OBJECT_OPERATOR","->",1940],["T_STRING","unsetOldData",1940],"(",")",["T_OBJECT_OPERATOR","->",1940],["T_STRING","getData",1940],"(",")",";",["T_WHITESPACE","\n            ",1940],"}",["T_WHITESPACE","\n\n            ",1941],["T_COMMENT","\/\/ Insert rows\n",1943],["T_WHITESPACE","            ",1944],["T_IF","if",1944],["T_WHITESPACE"," ",1944],"(",["T_VARIABLE","$stockData",1944],")",["T_WHITESPACE"," ",1944],"{",["T_WHITESPACE","\n                ",1944],["T_VARIABLE","$this",1945],["T_OBJECT_OPERATOR","->",1945],["T_STRING","_connection",1945],["T_OBJECT_OPERATOR","->",1945],["T_STRING","insertOnDuplicate",1945],"(",["T_VARIABLE","$entityTable",1945],",",["T_WHITESPACE"," ",1945],["T_VARIABLE","$stockData",1945],")",";",["T_WHITESPACE","\n            ",1945],"}",["T_WHITESPACE","\n        ",1946],"}",["T_WHITESPACE","\n        ",1947],["T_RETURN","return",1948],["T_WHITESPACE"," ",1948],["T_VARIABLE","$this",1948],";",["T_WHITESPACE","\n    ",1948],"}",["T_WHITESPACE","\n\n    ",1949],["T_DOC_COMMENT","\/**\n     * Removes empty keys in case value is null or empty string\n     *\n     * @param array $rowData\n     *\/",1951],["T_WHITESPACE","\n    ",1955],["T_PROTECTED","protected",1956],["T_WHITESPACE"," ",1956],["T_FUNCTION","function",1956],["T_WHITESPACE"," ",1956],["T_STRING","_filterRowData",1956],"(","&",["T_VARIABLE","$rowData",1956],")",["T_WHITESPACE","\n    ",1956],"{",["T_WHITESPACE","\n        ",1957],["T_VARIABLE","$rowData",1958],["T_WHITESPACE"," ",1958],"=",["T_WHITESPACE"," ",1958],["T_STRING","array_filter",1958],"(",["T_VARIABLE","$rowData",1958],",",["T_WHITESPACE"," ",1958],["T_CONSTANT_ENCAPSED_STRING","'strlen'",1958],")",";",["T_WHITESPACE","\n        ",1958],["T_COMMENT","\/\/ Exceptions - for sku - put them back in\n",1959],["T_WHITESPACE","        ",1960],["T_IF","if",1960],["T_WHITESPACE"," ",1960],"(","!",["T_ISSET","isset",1960],"(",["T_VARIABLE","$rowData",1960],"[",["T_STRING","self",1960],["T_DOUBLE_COLON","::",1960],["T_STRING","COL_SKU",1960],"]",")",")",["T_WHITESPACE"," ",1960],"{",["T_WHITESPACE","\n            ",1960],["T_VARIABLE","$rowData",1961],"[",["T_STRING","self",1961],["T_DOUBLE_COLON","::",1961],["T_STRING","COL_SKU",1961],"]",["T_WHITESPACE"," ",1961],"=",["T_WHITESPACE"," ",1961],["T_STRING","null",1961],";",["T_WHITESPACE","\n        ",1961],"}",["T_WHITESPACE","\n    ",1962],"}",["T_WHITESPACE","\n\n    ",1963],["T_DOC_COMMENT","\/**\n     * Atttribute set ID-to-name pairs getter.\n     *\n     * @return array\n     *\/",1965],["T_WHITESPACE","\n    ",1969],["T_PUBLIC","public",1970],["T_WHITESPACE"," ",1970],["T_FUNCTION","function",1970],["T_WHITESPACE"," ",1970],["T_STRING","getAttrSetIdToName",1970],"(",")",["T_WHITESPACE","\n    ",1970],"{",["T_WHITESPACE","\n        ",1971],["T_RETURN","return",1972],["T_WHITESPACE"," ",1972],["T_VARIABLE","$this",1972],["T_OBJECT_OPERATOR","->",1972],["T_STRING","_attrSetIdToName",1972],";",["T_WHITESPACE","\n    ",1972],"}",["T_WHITESPACE","\n\n    ",1973],["T_DOC_COMMENT","\/**\n     * DB connection getter.\n     *\n     * @return Varien_Db_Adapter_Pdo_Mysql\n     *\/",1975],["T_WHITESPACE","\n    ",1979],["T_PUBLIC","public",1980],["T_WHITESPACE"," ",1980],["T_FUNCTION","function",1980],["T_WHITESPACE"," ",1980],["T_STRING","getConnection",1980],"(",")",["T_WHITESPACE","\n    ",1980],"{",["T_WHITESPACE","\n        ",1981],["T_RETURN","return",1982],["T_WHITESPACE"," ",1982],["T_VARIABLE","$this",1982],["T_OBJECT_OPERATOR","->",1982],["T_STRING","_connection",1982],";",["T_WHITESPACE","\n    ",1982],"}",["T_WHITESPACE","\n\n    ",1983],["T_DOC_COMMENT","\/**\n     * EAV entity type code getter.\n     *\n     * @abstract\n     * @return string\n     *\/",1985],["T_WHITESPACE","\n    ",1990],["T_PUBLIC","public",1991],["T_WHITESPACE"," ",1991],["T_FUNCTION","function",1991],["T_WHITESPACE"," ",1991],["T_STRING","getEntityTypeCode",1991],"(",")",["T_WHITESPACE","\n    ",1991],"{",["T_WHITESPACE","\n        ",1992],["T_RETURN","return",1993],["T_WHITESPACE"," ",1993],["T_CONSTANT_ENCAPSED_STRING","'catalog_product'",1993],";",["T_WHITESPACE","\n    ",1993],"}",["T_WHITESPACE","\n\n    ",1994],["T_DOC_COMMENT","\/**\n     * New products SKU data.\n     *\n     * @return array\n     *\/",1996],["T_WHITESPACE","\n    ",2000],["T_PUBLIC","public",2001],["T_WHITESPACE"," ",2001],["T_FUNCTION","function",2001],["T_WHITESPACE"," ",2001],["T_STRING","getNewSku",2001],"(",")",["T_WHITESPACE","\n    ",2001],"{",["T_WHITESPACE","\n        ",2002],["T_RETURN","return",2003],["T_WHITESPACE"," ",2003],["T_VARIABLE","$this",2003],["T_OBJECT_OPERATOR","->",2003],["T_STRING","_newSku",2003],";",["T_WHITESPACE","\n    ",2003],"}",["T_WHITESPACE","\n\n    ",2004],["T_DOC_COMMENT","\/**\n     * Get next bunch of validatetd rows.\n     *\n     * @return array|null\n     *\/",2006],["T_WHITESPACE","\n    ",2010],["T_PUBLIC","public",2011],["T_WHITESPACE"," ",2011],["T_FUNCTION","function",2011],["T_WHITESPACE"," ",2011],["T_STRING","getNextBunch",2011],"(",")",["T_WHITESPACE","\n    ",2011],"{",["T_WHITESPACE","\n        ",2012],["T_RETURN","return",2013],["T_WHITESPACE"," ",2013],["T_VARIABLE","$this",2013],["T_OBJECT_OPERATOR","->",2013],["T_STRING","_dataSourceModel",2013],["T_OBJECT_OPERATOR","->",2013],["T_STRING","getNextBunch",2013],"(",")",";",["T_WHITESPACE","\n    ",2013],"}",["T_WHITESPACE","\n\n    ",2014],["T_DOC_COMMENT","\/**\n     * Existing products SKU getter.\n     *\n     * @return array\n     *\/",2016],["T_WHITESPACE","\n    ",2020],["T_PUBLIC","public",2021],["T_WHITESPACE"," ",2021],["T_FUNCTION","function",2021],["T_WHITESPACE"," ",2021],["T_STRING","getOldSku",2021],"(",")",["T_WHITESPACE","\n    ",2021],"{",["T_WHITESPACE","\n        ",2022],["T_RETURN","return",2023],["T_WHITESPACE"," ",2023],["T_VARIABLE","$this",2023],["T_OBJECT_OPERATOR","->",2023],["T_STRING","_oldSku",2023],";",["T_WHITESPACE","\n    ",2023],"}",["T_WHITESPACE","\n\n    ",2024],["T_DOC_COMMENT","\/**\n     * Obtain scope of the row from row data.\n     *\n     * @param array $rowData\n     * @return int\n     *\/",2026],["T_WHITESPACE","\n    ",2031],["T_PUBLIC","public",2032],["T_WHITESPACE"," ",2032],["T_FUNCTION","function",2032],["T_WHITESPACE"," ",2032],["T_STRING","getRowScope",2032],"(",["T_ARRAY","array",2032],["T_WHITESPACE"," ",2032],["T_VARIABLE","$rowData",2032],")",["T_WHITESPACE","\n    ",2032],"{",["T_WHITESPACE","\n        ",2033],["T_IF","if",2034],["T_WHITESPACE"," ",2034],"(",["T_ISSET","isset",2034],"(",["T_VARIABLE","$rowData",2034],"[",["T_STRING","self",2034],["T_DOUBLE_COLON","::",2034],["T_STRING","COL_SKU",2034],"]",")",["T_WHITESPACE"," ",2034],["T_BOOLEAN_AND","&&",2034],["T_WHITESPACE"," ",2034],["T_STRING","strlen",2034],"(",["T_STRING","trim",2034],"(",["T_VARIABLE","$rowData",2034],"[",["T_STRING","self",2034],["T_DOUBLE_COLON","::",2034],["T_STRING","COL_SKU",2034],"]",")",")",")",["T_WHITESPACE"," ",2034],"{",["T_WHITESPACE","\n            ",2034],["T_RETURN","return",2035],["T_WHITESPACE"," ",2035],["T_STRING","self",2035],["T_DOUBLE_COLON","::",2035],["T_STRING","SCOPE_DEFAULT",2035],";",["T_WHITESPACE","\n        ",2035],"}",["T_WHITESPACE"," ",2036],["T_ELSEIF","elseif",2036],["T_WHITESPACE"," ",2036],"(",["T_EMPTY","empty",2036],"(",["T_VARIABLE","$rowData",2036],"[",["T_STRING","self",2036],["T_DOUBLE_COLON","::",2036],["T_STRING","COL_STORE",2036],"]",")",")",["T_WHITESPACE"," ",2036],"{",["T_WHITESPACE","\n            ",2036],["T_RETURN","return",2037],["T_WHITESPACE"," ",2037],["T_STRING","self",2037],["T_DOUBLE_COLON","::",2037],["T_STRING","SCOPE_NULL",2037],";",["T_WHITESPACE","\n        ",2037],"}",["T_WHITESPACE"," ",2038],["T_ELSE","else",2038],["T_WHITESPACE"," ",2038],"{",["T_WHITESPACE","\n            ",2038],["T_RETURN","return",2039],["T_WHITESPACE"," ",2039],["T_STRING","self",2039],["T_DOUBLE_COLON","::",2039],["T_STRING","SCOPE_STORE",2039],";",["T_WHITESPACE","\n        ",2039],"}",["T_WHITESPACE","\n    ",2040],"}",["T_WHITESPACE","\n\n    ",2041],["T_DOC_COMMENT","\/**\n     * All website codes to ID getter.\n     *\n     * @return array\n     *\/",2043],["T_WHITESPACE","\n    ",2047],["T_PUBLIC","public",2048],["T_WHITESPACE"," ",2048],["T_FUNCTION","function",2048],["T_WHITESPACE"," ",2048],["T_STRING","getWebsiteCodes",2048],"(",")",["T_WHITESPACE","\n    ",2048],"{",["T_WHITESPACE","\n        ",2049],["T_RETURN","return",2050],["T_WHITESPACE"," ",2050],["T_VARIABLE","$this",2050],["T_OBJECT_OPERATOR","->",2050],["T_STRING","_websiteCodeToId",2050],";",["T_WHITESPACE","\n    ",2050],"}",["T_WHITESPACE","\n\n    ",2051],["T_DOC_COMMENT","\/**\n     * Validate data row.\n     *\n     * @param array $rowData\n     * @param int $rowNum\n     * @return boolean\n     *\/",2053],["T_WHITESPACE","\n    ",2059],["T_PUBLIC","public",2060],["T_WHITESPACE"," ",2060],["T_FUNCTION","function",2060],["T_WHITESPACE"," ",2060],["T_STRING","validateRow",2060],"(",["T_ARRAY","array",2060],["T_WHITESPACE"," ",2060],["T_VARIABLE","$rowData",2060],",",["T_WHITESPACE"," ",2060],["T_VARIABLE","$rowNum",2060],")",["T_WHITESPACE","\n    ",2060],"{",["T_WHITESPACE","\n        ",2061],["T_STATIC","static",2062],["T_WHITESPACE"," ",2062],["T_VARIABLE","$sku",2062],["T_WHITESPACE"," ",2062],"=",["T_WHITESPACE"," ",2062],["T_STRING","null",2062],";",["T_WHITESPACE"," ",2062],["T_COMMENT","\/\/ SKU is remembered through all product rows\n",2062],["T_WHITESPACE","\n        ",2063],["T_IF","if",2064],["T_WHITESPACE"," ",2064],"(",["T_ISSET","isset",2064],"(",["T_VARIABLE","$this",2064],["T_OBJECT_OPERATOR","->",2064],["T_STRING","_validatedRows",2064],"[",["T_VARIABLE","$rowNum",2064],"]",")",")",["T_WHITESPACE"," ",2064],"{",["T_WHITESPACE"," ",2064],["T_COMMENT","\/\/ check that row is already validated\n",2064],["T_WHITESPACE","            ",2065],["T_RETURN","return",2065],["T_WHITESPACE"," ",2065],"!",["T_ISSET","isset",2065],"(",["T_VARIABLE","$this",2065],["T_OBJECT_OPERATOR","->",2065],["T_STRING","_invalidRows",2065],"[",["T_VARIABLE","$rowNum",2065],"]",")",";",["T_WHITESPACE","\n        ",2065],"}",["T_WHITESPACE","\n        ",2066],["T_VARIABLE","$this",2067],["T_OBJECT_OPERATOR","->",2067],["T_STRING","_validatedRows",2067],"[",["T_VARIABLE","$rowNum",2067],"]",["T_WHITESPACE"," ",2067],"=",["T_WHITESPACE"," ",2067],["T_STRING","true",2067],";",["T_WHITESPACE","\n\n        ",2067],["T_IF","if",2069],["T_WHITESPACE"," ",2069],"(",["T_ISSET","isset",2069],"(",["T_VARIABLE","$this",2069],["T_OBJECT_OPERATOR","->",2069],["T_STRING","_newSku",2069],"[",["T_VARIABLE","$rowData",2069],"[",["T_STRING","self",2069],["T_DOUBLE_COLON","::",2069],["T_STRING","COL_SKU",2069],"]","]",")",")",["T_WHITESPACE"," ",2069],"{",["T_WHITESPACE","\n            ",2069],["T_VARIABLE","$this",2070],["T_OBJECT_OPERATOR","->",2070],["T_STRING","addRowError",2070],"(",["T_STRING","self",2070],["T_DOUBLE_COLON","::",2070],["T_STRING","ERROR_DUPLICATE_SKU",2070],",",["T_WHITESPACE"," ",2070],["T_VARIABLE","$rowNum",2070],")",";",["T_WHITESPACE","\n            ",2070],["T_RETURN","return",2071],["T_WHITESPACE"," ",2071],["T_STRING","false",2071],";",["T_WHITESPACE","\n        ",2071],"}",["T_WHITESPACE","\n        ",2072],["T_VARIABLE","$rowScope",2073],["T_WHITESPACE"," ",2073],"=",["T_WHITESPACE"," ",2073],["T_VARIABLE","$this",2073],["T_OBJECT_OPERATOR","->",2073],["T_STRING","getRowScope",2073],"(",["T_VARIABLE","$rowData",2073],")",";",["T_WHITESPACE","\n\n        ",2073],["T_COMMENT","\/\/ BEHAVIOR_DELETE use specific validation logic\n",2075],["T_WHITESPACE","        ",2076],["T_IF","if",2076],["T_WHITESPACE"," ",2076],"(",["T_STRING","Mage_ImportExport_Model_Import",2076],["T_DOUBLE_COLON","::",2076],["T_STRING","BEHAVIOR_DELETE",2076],["T_WHITESPACE"," ",2076],["T_IS_EQUAL","==",2076],["T_WHITESPACE"," ",2076],["T_VARIABLE","$this",2076],["T_OBJECT_OPERATOR","->",2076],["T_STRING","getBehavior",2076],"(",")",")",["T_WHITESPACE"," ",2076],"{",["T_WHITESPACE","\n            ",2076],["T_IF","if",2077],["T_WHITESPACE"," ",2077],"(",["T_STRING","self",2077],["T_DOUBLE_COLON","::",2077],["T_STRING","SCOPE_DEFAULT",2077],["T_WHITESPACE"," ",2077],["T_IS_EQUAL","==",2077],["T_WHITESPACE"," ",2077],["T_VARIABLE","$rowScope",2077],["T_WHITESPACE"," ",2077],["T_BOOLEAN_AND","&&",2077],["T_WHITESPACE"," ",2077],"!",["T_ISSET","isset",2077],"(",["T_VARIABLE","$this",2077],["T_OBJECT_OPERATOR","->",2077],["T_STRING","_oldSku",2077],"[",["T_VARIABLE","$rowData",2077],"[",["T_STRING","self",2077],["T_DOUBLE_COLON","::",2077],["T_STRING","COL_SKU",2077],"]","]",")",")",["T_WHITESPACE"," ",2077],"{",["T_WHITESPACE","\n                ",2077],["T_VARIABLE","$this",2078],["T_OBJECT_OPERATOR","->",2078],["T_STRING","addRowError",2078],"(",["T_STRING","self",2078],["T_DOUBLE_COLON","::",2078],["T_STRING","ERROR_SKU_NOT_FOUND_FOR_DELETE",2078],",",["T_WHITESPACE"," ",2078],["T_VARIABLE","$rowNum",2078],")",";",["T_WHITESPACE","\n                ",2078],["T_RETURN","return",2079],["T_WHITESPACE"," ",2079],["T_STRING","false",2079],";",["T_WHITESPACE","\n            ",2079],"}",["T_WHITESPACE","\n            ",2080],["T_RETURN","return",2081],["T_WHITESPACE"," ",2081],["T_STRING","true",2081],";",["T_WHITESPACE","\n        ",2081],"}",["T_WHITESPACE","\n\n        ",2082],["T_VARIABLE","$this",2084],["T_OBJECT_OPERATOR","->",2084],["T_STRING","_validate",2084],"(",["T_VARIABLE","$rowData",2084],",",["T_WHITESPACE"," ",2084],["T_VARIABLE","$rowNum",2084],",",["T_WHITESPACE"," ",2084],["T_VARIABLE","$sku",2084],")",";",["T_WHITESPACE","\n\n        ",2084],["T_IF","if",2086],["T_WHITESPACE"," ",2086],"(",["T_STRING","self",2086],["T_DOUBLE_COLON","::",2086],["T_STRING","SCOPE_DEFAULT",2086],["T_WHITESPACE"," ",2086],["T_IS_EQUAL","==",2086],["T_WHITESPACE"," ",2086],["T_VARIABLE","$rowScope",2086],")",["T_WHITESPACE"," ",2086],"{",["T_WHITESPACE"," ",2086],["T_COMMENT","\/\/ SKU is specified, row is SCOPE_DEFAULT, new product block begins\n",2086],["T_WHITESPACE","            ",2087],["T_VARIABLE","$this",2087],["T_OBJECT_OPERATOR","->",2087],["T_STRING","_processedEntitiesCount",2087],["T_WHITESPACE"," ",2087],["T_INC","++",2087],";",["T_WHITESPACE","\n\n            ",2087],["T_VARIABLE","$sku",2089],["T_WHITESPACE"," ",2089],"=",["T_WHITESPACE"," ",2089],["T_VARIABLE","$rowData",2089],"[",["T_STRING","self",2089],["T_DOUBLE_COLON","::",2089],["T_STRING","COL_SKU",2089],"]",";",["T_WHITESPACE","\n\n            ",2089],["T_IF","if",2091],["T_WHITESPACE"," ",2091],"(",["T_ISSET","isset",2091],"(",["T_VARIABLE","$this",2091],["T_OBJECT_OPERATOR","->",2091],["T_STRING","_oldSku",2091],"[",["T_VARIABLE","$sku",2091],"]",")",")",["T_WHITESPACE"," ",2091],"{",["T_WHITESPACE"," ",2091],["T_COMMENT","\/\/ can we get all necessary data from existant DB product?\n",2091],["T_WHITESPACE","                ",2092],["T_COMMENT","\/\/ check for supported type of existing product\n",2092],["T_WHITESPACE","                ",2093],["T_IF","if",2093],["T_WHITESPACE"," ",2093],"(",["T_ISSET","isset",2093],"(",["T_VARIABLE","$this",2093],["T_OBJECT_OPERATOR","->",2093],["T_STRING","_productTypeModels",2093],"[",["T_VARIABLE","$this",2093],["T_OBJECT_OPERATOR","->",2093],["T_STRING","_oldSku",2093],"[",["T_VARIABLE","$sku",2093],"]","[",["T_CONSTANT_ENCAPSED_STRING","'type_id'",2093],"]","]",")",")",["T_WHITESPACE"," ",2093],"{",["T_WHITESPACE","\n                    ",2093],["T_VARIABLE","$this",2094],["T_OBJECT_OPERATOR","->",2094],["T_STRING","_newSku",2094],"[",["T_VARIABLE","$sku",2094],"]",["T_WHITESPACE"," ",2094],"=",["T_WHITESPACE"," ",2094],["T_ARRAY","array",2094],"(",["T_WHITESPACE","\n                        ",2094],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",2095],["T_WHITESPACE","     ",2095],["T_DOUBLE_ARROW","=>",2095],["T_WHITESPACE"," ",2095],["T_VARIABLE","$this",2095],["T_OBJECT_OPERATOR","->",2095],["T_STRING","_oldSku",2095],"[",["T_VARIABLE","$sku",2095],"]","[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",2095],"]",",",["T_WHITESPACE","\n                        ",2095],["T_CONSTANT_ENCAPSED_STRING","'type_id'",2096],["T_WHITESPACE","       ",2096],["T_DOUBLE_ARROW","=>",2096],["T_WHITESPACE"," ",2096],["T_VARIABLE","$this",2096],["T_OBJECT_OPERATOR","->",2096],["T_STRING","_oldSku",2096],"[",["T_VARIABLE","$sku",2096],"]","[",["T_CONSTANT_ENCAPSED_STRING","'type_id'",2096],"]",",",["T_WHITESPACE","\n                        ",2096],["T_CONSTANT_ENCAPSED_STRING","'attr_set_id'",2097],["T_WHITESPACE","   ",2097],["T_DOUBLE_ARROW","=>",2097],["T_WHITESPACE"," ",2097],["T_VARIABLE","$this",2097],["T_OBJECT_OPERATOR","->",2097],["T_STRING","_oldSku",2097],"[",["T_VARIABLE","$sku",2097],"]","[",["T_CONSTANT_ENCAPSED_STRING","'attr_set_id'",2097],"]",",",["T_WHITESPACE","\n                        ",2097],["T_CONSTANT_ENCAPSED_STRING","'attr_set_code'",2098],["T_WHITESPACE"," ",2098],["T_DOUBLE_ARROW","=>",2098],["T_WHITESPACE"," ",2098],["T_VARIABLE","$this",2098],["T_OBJECT_OPERATOR","->",2098],["T_STRING","_attrSetIdToName",2098],"[",["T_VARIABLE","$this",2098],["T_OBJECT_OPERATOR","->",2098],["T_STRING","_oldSku",2098],"[",["T_VARIABLE","$sku",2098],"]","[",["T_CONSTANT_ENCAPSED_STRING","'attr_set_id'",2098],"]","]",["T_WHITESPACE","\n                    ",2098],")",";",["T_WHITESPACE","\n                ",2099],"}",["T_WHITESPACE"," ",2100],["T_ELSE","else",2100],["T_WHITESPACE"," ",2100],"{",["T_WHITESPACE","\n                    ",2100],["T_VARIABLE","$this",2101],["T_OBJECT_OPERATOR","->",2101],["T_STRING","addRowError",2101],"(",["T_STRING","self",2101],["T_DOUBLE_COLON","::",2101],["T_STRING","ERROR_TYPE_UNSUPPORTED",2101],",",["T_WHITESPACE"," ",2101],["T_VARIABLE","$rowNum",2101],")",";",["T_WHITESPACE","\n                    ",2101],["T_VARIABLE","$sku",2102],["T_WHITESPACE"," ",2102],"=",["T_WHITESPACE"," ",2102],["T_STRING","false",2102],";",["T_WHITESPACE"," ",2102],["T_COMMENT","\/\/ child rows of legacy products with unsupported types are orphans\n",2102],["T_WHITESPACE","                ",2103],"}",["T_WHITESPACE","\n            ",2103],"}",["T_WHITESPACE"," ",2104],["T_ELSE","else",2104],["T_WHITESPACE"," ",2104],"{",["T_WHITESPACE"," ",2104],["T_COMMENT","\/\/ validate new product type and attribute set\n",2104],["T_WHITESPACE","                ",2105],["T_IF","if",2105],["T_WHITESPACE"," ",2105],"(","!",["T_ISSET","isset",2105],"(",["T_VARIABLE","$rowData",2105],"[",["T_STRING","self",2105],["T_DOUBLE_COLON","::",2105],["T_STRING","COL_TYPE",2105],"]",")",["T_WHITESPACE","\n                    ",2105],["T_BOOLEAN_OR","||",2106],["T_WHITESPACE"," ",2106],"!",["T_ISSET","isset",2106],"(",["T_VARIABLE","$this",2106],["T_OBJECT_OPERATOR","->",2106],["T_STRING","_productTypeModels",2106],"[",["T_VARIABLE","$rowData",2106],"[",["T_STRING","self",2106],["T_DOUBLE_COLON","::",2106],["T_STRING","COL_TYPE",2106],"]","]",")",["T_WHITESPACE","\n                ",2106],")",["T_WHITESPACE"," ",2107],"{",["T_WHITESPACE","\n                    ",2107],["T_VARIABLE","$this",2108],["T_OBJECT_OPERATOR","->",2108],["T_STRING","addRowError",2108],"(",["T_STRING","self",2108],["T_DOUBLE_COLON","::",2108],["T_STRING","ERROR_INVALID_TYPE",2108],",",["T_WHITESPACE"," ",2108],["T_VARIABLE","$rowNum",2108],")",";",["T_WHITESPACE","\n                ",2108],"}",["T_WHITESPACE"," ",2109],["T_ELSEIF","elseif",2109],["T_WHITESPACE"," ",2109],"(","!",["T_ISSET","isset",2109],"(",["T_VARIABLE","$rowData",2109],"[",["T_STRING","self",2109],["T_DOUBLE_COLON","::",2109],["T_STRING","COL_ATTR_SET",2109],"]",")",["T_WHITESPACE","\n                          ",2109],["T_BOOLEAN_OR","||",2110],["T_WHITESPACE"," ",2110],"!",["T_ISSET","isset",2110],"(",["T_VARIABLE","$this",2110],["T_OBJECT_OPERATOR","->",2110],["T_STRING","_attrSetNameToId",2110],"[",["T_VARIABLE","$rowData",2110],"[",["T_STRING","self",2110],["T_DOUBLE_COLON","::",2110],["T_STRING","COL_ATTR_SET",2110],"]","]",")",["T_WHITESPACE","\n                ",2110],")",["T_WHITESPACE"," ",2111],"{",["T_WHITESPACE","\n                    ",2111],["T_VARIABLE","$this",2112],["T_OBJECT_OPERATOR","->",2112],["T_STRING","addRowError",2112],"(",["T_STRING","self",2112],["T_DOUBLE_COLON","::",2112],["T_STRING","ERROR_INVALID_ATTR_SET",2112],",",["T_WHITESPACE"," ",2112],["T_VARIABLE","$rowNum",2112],")",";",["T_WHITESPACE","\n                ",2112],"}",["T_WHITESPACE"," ",2113],["T_ELSEIF","elseif",2113],["T_WHITESPACE"," ",2113],"(","!",["T_ISSET","isset",2113],"(",["T_VARIABLE","$this",2113],["T_OBJECT_OPERATOR","->",2113],["T_STRING","_newSku",2113],"[",["T_VARIABLE","$sku",2113],"]",")",")",["T_WHITESPACE"," ",2113],"{",["T_WHITESPACE","\n                    ",2113],["T_VARIABLE","$this",2114],["T_OBJECT_OPERATOR","->",2114],["T_STRING","_newSku",2114],"[",["T_VARIABLE","$sku",2114],"]",["T_WHITESPACE"," ",2114],"=",["T_WHITESPACE"," ",2114],["T_ARRAY","array",2114],"(",["T_WHITESPACE","\n                        ",2114],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",2115],["T_WHITESPACE","     ",2115],["T_DOUBLE_ARROW","=>",2115],["T_WHITESPACE"," ",2115],["T_STRING","null",2115],",",["T_WHITESPACE","\n                        ",2115],["T_CONSTANT_ENCAPSED_STRING","'type_id'",2116],["T_WHITESPACE","       ",2116],["T_DOUBLE_ARROW","=>",2116],["T_WHITESPACE"," ",2116],["T_VARIABLE","$rowData",2116],"[",["T_STRING","self",2116],["T_DOUBLE_COLON","::",2116],["T_STRING","COL_TYPE",2116],"]",",",["T_WHITESPACE","\n                        ",2116],["T_CONSTANT_ENCAPSED_STRING","'attr_set_id'",2117],["T_WHITESPACE","   ",2117],["T_DOUBLE_ARROW","=>",2117],["T_WHITESPACE"," ",2117],["T_VARIABLE","$this",2117],["T_OBJECT_OPERATOR","->",2117],["T_STRING","_attrSetNameToId",2117],"[",["T_VARIABLE","$rowData",2117],"[",["T_STRING","self",2117],["T_DOUBLE_COLON","::",2117],["T_STRING","COL_ATTR_SET",2117],"]","]",",",["T_WHITESPACE","\n                        ",2117],["T_CONSTANT_ENCAPSED_STRING","'attr_set_code'",2118],["T_WHITESPACE"," ",2118],["T_DOUBLE_ARROW","=>",2118],["T_WHITESPACE"," ",2118],["T_VARIABLE","$rowData",2118],"[",["T_STRING","self",2118],["T_DOUBLE_COLON","::",2118],["T_STRING","COL_ATTR_SET",2118],"]",["T_WHITESPACE","\n                    ",2118],")",";",["T_WHITESPACE","\n                ",2119],"}",["T_WHITESPACE","\n                ",2120],["T_IF","if",2121],["T_WHITESPACE"," ",2121],"(",["T_ISSET","isset",2121],"(",["T_VARIABLE","$this",2121],["T_OBJECT_OPERATOR","->",2121],["T_STRING","_invalidRows",2121],"[",["T_VARIABLE","$rowNum",2121],"]",")",")",["T_WHITESPACE"," ",2121],"{",["T_WHITESPACE","\n                    ",2121],["T_COMMENT","\/\/ mark SCOPE_DEFAULT row as invalid for future child rows if product not in DB already\n",2122],["T_WHITESPACE","                    ",2123],["T_VARIABLE","$sku",2123],["T_WHITESPACE"," ",2123],"=",["T_WHITESPACE"," ",2123],["T_STRING","false",2123],";",["T_WHITESPACE","\n                ",2123],"}",["T_WHITESPACE","\n            ",2124],"}",["T_WHITESPACE","\n        ",2125],"}",["T_WHITESPACE"," ",2126],["T_ELSE","else",2126],["T_WHITESPACE"," ",2126],"{",["T_WHITESPACE","\n            ",2126],["T_IF","if",2127],["T_WHITESPACE"," ",2127],"(",["T_STRING","null",2127],["T_WHITESPACE"," ",2127],["T_IS_IDENTICAL","===",2127],["T_WHITESPACE"," ",2127],["T_VARIABLE","$sku",2127],")",["T_WHITESPACE"," ",2127],"{",["T_WHITESPACE","\n                ",2127],["T_VARIABLE","$this",2128],["T_OBJECT_OPERATOR","->",2128],["T_STRING","addRowError",2128],"(",["T_STRING","self",2128],["T_DOUBLE_COLON","::",2128],["T_STRING","ERROR_SKU_IS_EMPTY",2128],",",["T_WHITESPACE"," ",2128],["T_VARIABLE","$rowNum",2128],")",";",["T_WHITESPACE","\n            ",2128],"}",["T_WHITESPACE"," ",2129],["T_ELSEIF","elseif",2129],["T_WHITESPACE"," ",2129],"(",["T_STRING","false",2129],["T_WHITESPACE"," ",2129],["T_IS_IDENTICAL","===",2129],["T_WHITESPACE"," ",2129],["T_VARIABLE","$sku",2129],")",["T_WHITESPACE"," ",2129],"{",["T_WHITESPACE","\n                ",2129],["T_VARIABLE","$this",2130],["T_OBJECT_OPERATOR","->",2130],["T_STRING","addRowError",2130],"(",["T_STRING","self",2130],["T_DOUBLE_COLON","::",2130],["T_STRING","ERROR_ROW_IS_ORPHAN",2130],",",["T_WHITESPACE"," ",2130],["T_VARIABLE","$rowNum",2130],")",";",["T_WHITESPACE","\n            ",2130],"}",["T_WHITESPACE"," ",2131],["T_ELSEIF","elseif",2131],["T_WHITESPACE"," ",2131],"(",["T_STRING","self",2131],["T_DOUBLE_COLON","::",2131],["T_STRING","SCOPE_STORE",2131],["T_WHITESPACE"," ",2131],["T_IS_EQUAL","==",2131],["T_WHITESPACE"," ",2131],["T_VARIABLE","$rowScope",2131],["T_WHITESPACE"," ",2131],["T_BOOLEAN_AND","&&",2131],["T_WHITESPACE"," ",2131],"!",["T_ISSET","isset",2131],"(",["T_VARIABLE","$this",2131],["T_OBJECT_OPERATOR","->",2131],["T_STRING","_storeCodeToId",2131],"[",["T_VARIABLE","$rowData",2131],"[",["T_STRING","self",2131],["T_DOUBLE_COLON","::",2131],["T_STRING","COL_STORE",2131],"]","]",")",")",["T_WHITESPACE"," ",2131],"{",["T_WHITESPACE","\n                ",2131],["T_VARIABLE","$this",2132],["T_OBJECT_OPERATOR","->",2132],["T_STRING","addRowError",2132],"(",["T_STRING","self",2132],["T_DOUBLE_COLON","::",2132],["T_STRING","ERROR_INVALID_STORE",2132],",",["T_WHITESPACE"," ",2132],["T_VARIABLE","$rowNum",2132],")",";",["T_WHITESPACE","\n            ",2132],"}",["T_WHITESPACE","\n        ",2133],"}",["T_WHITESPACE","\n        ",2134],["T_IF","if",2135],["T_WHITESPACE"," ",2135],"(","!",["T_ISSET","isset",2135],"(",["T_VARIABLE","$this",2135],["T_OBJECT_OPERATOR","->",2135],["T_STRING","_invalidRows",2135],"[",["T_VARIABLE","$rowNum",2135],"]",")",")",["T_WHITESPACE"," ",2135],"{",["T_WHITESPACE","\n            ",2135],["T_COMMENT","\/\/ set attribute set code into row data for followed attribute validation in type model\n",2136],["T_WHITESPACE","            ",2137],["T_VARIABLE","$rowData",2137],"[",["T_STRING","self",2137],["T_DOUBLE_COLON","::",2137],["T_STRING","COL_ATTR_SET",2137],"]",["T_WHITESPACE"," ",2137],"=",["T_WHITESPACE"," ",2137],["T_VARIABLE","$this",2137],["T_OBJECT_OPERATOR","->",2137],["T_STRING","_newSku",2137],"[",["T_VARIABLE","$sku",2137],"]","[",["T_CONSTANT_ENCAPSED_STRING","'attr_set_code'",2137],"]",";",["T_WHITESPACE","\n\n            ",2137],["T_VARIABLE","$rowAttributesValid",2139],["T_WHITESPACE"," ",2139],"=",["T_WHITESPACE"," ",2139],["T_VARIABLE","$this",2139],["T_OBJECT_OPERATOR","->",2139],["T_STRING","_productTypeModels",2139],"[",["T_VARIABLE","$this",2139],["T_OBJECT_OPERATOR","->",2139],["T_STRING","_newSku",2139],"[",["T_VARIABLE","$sku",2139],"]","[",["T_CONSTANT_ENCAPSED_STRING","'type_id'",2139],"]","]",["T_OBJECT_OPERATOR","->",2139],["T_STRING","isRowValid",2139],"(",["T_WHITESPACE","\n                ",2139],["T_VARIABLE","$rowData",2140],",",["T_WHITESPACE"," ",2140],["T_VARIABLE","$rowNum",2140],",",["T_WHITESPACE"," ",2140],"!",["T_ISSET","isset",2140],"(",["T_VARIABLE","$this",2140],["T_OBJECT_OPERATOR","->",2140],["T_STRING","_oldSku",2140],"[",["T_VARIABLE","$sku",2140],"]",")",["T_WHITESPACE","\n            ",2140],")",";",["T_WHITESPACE","\n            ",2141],["T_IF","if",2142],["T_WHITESPACE"," ",2142],"(","!",["T_VARIABLE","$rowAttributesValid",2142],["T_WHITESPACE"," ",2142],["T_BOOLEAN_AND","&&",2142],["T_WHITESPACE"," ",2142],["T_STRING","self",2142],["T_DOUBLE_COLON","::",2142],["T_STRING","SCOPE_DEFAULT",2142],["T_WHITESPACE"," ",2142],["T_IS_EQUAL","==",2142],["T_WHITESPACE"," ",2142],["T_VARIABLE","$rowScope",2142],")",["T_WHITESPACE"," ",2142],"{",["T_WHITESPACE","\n                ",2142],["T_VARIABLE","$sku",2143],["T_WHITESPACE"," ",2143],"=",["T_WHITESPACE"," ",2143],["T_STRING","false",2143],";",["T_WHITESPACE"," ",2143],["T_COMMENT","\/\/ mark SCOPE_DEFAULT row as invalid for future child rows\n",2143],["T_WHITESPACE","            ",2144],"}",["T_WHITESPACE","\n        ",2144],"}",["T_WHITESPACE","\n        ",2145],["T_RETURN","return",2146],["T_WHITESPACE"," ",2146],"!",["T_ISSET","isset",2146],"(",["T_VARIABLE","$this",2146],["T_OBJECT_OPERATOR","->",2146],["T_STRING","_invalidRows",2146],"[",["T_VARIABLE","$rowNum",2146],"]",")",";",["T_WHITESPACE","\n    ",2146],"}",["T_WHITESPACE","\n\n    ",2147],["T_DOC_COMMENT","\/**\n     * Common validation\n     *\n     * @param array $rowData\n     * @param int $rowNum\n     * @param string|false|null $sku\n     *\/",2149],["T_WHITESPACE","\n    ",2155],["T_PROTECTED","protected",2156],["T_WHITESPACE"," ",2156],["T_FUNCTION","function",2156],["T_WHITESPACE"," ",2156],["T_STRING","_validate",2156],"(",["T_VARIABLE","$rowData",2156],",",["T_WHITESPACE"," ",2156],["T_VARIABLE","$rowNum",2156],",",["T_WHITESPACE"," ",2156],["T_VARIABLE","$sku",2156],")",["T_WHITESPACE","\n    ",2156],"{",["T_WHITESPACE","\n        ",2157],["T_VARIABLE","$this",2158],["T_OBJECT_OPERATOR","->",2158],["T_STRING","_isProductWebsiteValid",2158],"(",["T_VARIABLE","$rowData",2158],",",["T_WHITESPACE"," ",2158],["T_VARIABLE","$rowNum",2158],")",";",["T_WHITESPACE","\n        ",2158],["T_VARIABLE","$this",2159],["T_OBJECT_OPERATOR","->",2159],["T_STRING","_isProductCategoryValid",2159],"(",["T_VARIABLE","$rowData",2159],",",["T_WHITESPACE"," ",2159],["T_VARIABLE","$rowNum",2159],")",";",["T_WHITESPACE","\n        ",2159],["T_VARIABLE","$this",2160],["T_OBJECT_OPERATOR","->",2160],["T_STRING","_isTierPriceValid",2160],"(",["T_VARIABLE","$rowData",2160],",",["T_WHITESPACE"," ",2160],["T_VARIABLE","$rowNum",2160],")",";",["T_WHITESPACE","\n        ",2160],["T_VARIABLE","$this",2161],["T_OBJECT_OPERATOR","->",2161],["T_STRING","_isGroupPriceValid",2161],"(",["T_VARIABLE","$rowData",2161],",",["T_WHITESPACE"," ",2161],["T_VARIABLE","$rowNum",2161],")",";",["T_WHITESPACE","\n        ",2161],["T_VARIABLE","$this",2162],["T_OBJECT_OPERATOR","->",2162],["T_STRING","_isSuperProductsSkuValid",2162],"(",["T_VARIABLE","$rowData",2162],",",["T_WHITESPACE"," ",2162],["T_VARIABLE","$rowNum",2162],")",";",["T_WHITESPACE","\n    ",2162],"}",["T_WHITESPACE","\n\n    ",2163],["T_DOC_COMMENT","\/**\n     * Get array of affected products\n     *\n     * @return array\n     *\/",2165],["T_WHITESPACE","\n    ",2169],["T_PUBLIC","public",2170],["T_WHITESPACE"," ",2170],["T_FUNCTION","function",2170],["T_WHITESPACE"," ",2170],["T_STRING","getAffectedEntityIds",2170],"(",")",["T_WHITESPACE","\n    ",2170],"{",["T_WHITESPACE","\n        ",2171],["T_VARIABLE","$productIds",2172],["T_WHITESPACE"," ",2172],"=",["T_WHITESPACE"," ",2172],["T_ARRAY","array",2172],"(",")",";",["T_WHITESPACE","\n        ",2172],["T_WHILE","while",2173],["T_WHITESPACE"," ",2173],"(",["T_VARIABLE","$bunch",2173],["T_WHITESPACE"," ",2173],"=",["T_WHITESPACE"," ",2173],["T_VARIABLE","$this",2173],["T_OBJECT_OPERATOR","->",2173],["T_STRING","_dataSourceModel",2173],["T_OBJECT_OPERATOR","->",2173],["T_STRING","getNextBunch",2173],"(",")",")",["T_WHITESPACE"," ",2173],"{",["T_WHITESPACE","\n            ",2173],["T_FOREACH","foreach",2174],["T_WHITESPACE"," ",2174],"(",["T_VARIABLE","$bunch",2174],["T_WHITESPACE"," ",2174],["T_AS","as",2174],["T_WHITESPACE"," ",2174],["T_VARIABLE","$rowNum",2174],["T_WHITESPACE"," ",2174],["T_DOUBLE_ARROW","=>",2174],["T_WHITESPACE"," ",2174],["T_VARIABLE","$rowData",2174],")",["T_WHITESPACE"," ",2174],"{",["T_WHITESPACE","\n                ",2174],["T_IF","if",2175],["T_WHITESPACE"," ",2175],"(","!",["T_VARIABLE","$this",2175],["T_OBJECT_OPERATOR","->",2175],["T_STRING","isRowAllowedToImport",2175],"(",["T_VARIABLE","$rowData",2175],",",["T_WHITESPACE"," ",2175],["T_VARIABLE","$rowNum",2175],")",")",["T_WHITESPACE"," ",2175],"{",["T_WHITESPACE","\n                    ",2175],["T_CONTINUE","continue",2176],";",["T_WHITESPACE","\n                ",2176],"}",["T_WHITESPACE","\n                ",2177],["T_IF","if",2178],["T_WHITESPACE"," ",2178],"(","!",["T_ISSET","isset",2178],"(",["T_VARIABLE","$this",2178],["T_OBJECT_OPERATOR","->",2178],["T_STRING","_newSku",2178],"[",["T_VARIABLE","$rowData",2178],"[",["T_STRING","self",2178],["T_DOUBLE_COLON","::",2178],["T_STRING","COL_SKU",2178],"]","]","[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",2178],"]",")",")",["T_WHITESPACE"," ",2178],"{",["T_WHITESPACE","\n                    ",2178],["T_CONTINUE","continue",2179],";",["T_WHITESPACE","\n                ",2179],"}",["T_WHITESPACE","\n                ",2180],["T_VARIABLE","$productIds",2181],"[","]",["T_WHITESPACE"," ",2181],"=",["T_WHITESPACE"," ",2181],["T_VARIABLE","$this",2181],["T_OBJECT_OPERATOR","->",2181],["T_STRING","_newSku",2181],"[",["T_VARIABLE","$rowData",2181],"[",["T_STRING","self",2181],["T_DOUBLE_COLON","::",2181],["T_STRING","COL_SKU",2181],"]","]","[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",2181],"]",";",["T_WHITESPACE","\n            ",2181],"}",["T_WHITESPACE","\n        ",2182],"}",["T_WHITESPACE","\n        ",2183],["T_RETURN","return",2184],["T_WHITESPACE"," ",2184],["T_VARIABLE","$productIds",2184],";",["T_WHITESPACE","\n    ",2184],"}",["T_WHITESPACE","\n\n    ",2185],["T_DOC_COMMENT","\/**\n     * Get product url_key attribute id\n     *\n     * @return null|int\n     *\/",2187],["T_WHITESPACE","\n    ",2191],["T_PROTECTED","protected",2192],["T_WHITESPACE"," ",2192],["T_FUNCTION","function",2192],["T_WHITESPACE"," ",2192],["T_STRING","_getUrlKeyAttributeId",2192],"(",")",["T_WHITESPACE","\n    ",2192],"{",["T_WHITESPACE","\n        ",2193],["T_IF","if",2194],["T_WHITESPACE"," ",2194],"(",["T_VARIABLE","$this",2194],["T_OBJECT_OPERATOR","->",2194],["T_STRING","_urlKeyAttributeId",2194],["T_WHITESPACE"," ",2194],["T_IS_IDENTICAL","===",2194],["T_WHITESPACE"," ",2194],["T_STRING","null",2194],")",["T_WHITESPACE"," ",2194],"{",["T_WHITESPACE","\n            ",2194],["T_VARIABLE","$adapter",2195],["T_WHITESPACE","  ",2195],"=",["T_WHITESPACE"," ",2195],["T_VARIABLE","$this",2195],["T_OBJECT_OPERATOR","->",2195],["T_STRING","getConnection",2195],"(",")",";",["T_WHITESPACE","\n            ",2195],["T_VARIABLE","$resource",2196],["T_WHITESPACE"," ",2196],"=",["T_WHITESPACE"," ",2196],["T_VARIABLE","$this",2196],["T_OBJECT_OPERATOR","->",2196],["T_STRING","getResourceModel",2196],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/entity_attribute'",2196],")",";",["T_WHITESPACE","\n\n            ",2196],["T_VARIABLE","$select",2198],["T_WHITESPACE"," ",2198],"=",["T_WHITESPACE"," ",2198],["T_VARIABLE","$adapter",2198],["T_OBJECT_OPERATOR","->",2198],["T_STRING","select",2198],"(",")",["T_WHITESPACE","\n                ",2198],["T_OBJECT_OPERATOR","->",2199],["T_STRING","from",2199],"(",["T_WHITESPACE","\n                    ",2199],["T_VARIABLE","$resource",2200],["T_OBJECT_OPERATOR","->",2200],["T_STRING","getMainTable",2200],"(",")",",",["T_WHITESPACE","\n                    ",2200],["T_ARRAY","array",2201],"(",["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",2201],")",["T_WHITESPACE","\n                ",2201],")",["T_WHITESPACE","\n                ",2202],["T_OBJECT_OPERATOR","->",2203],["T_STRING","where",2203],"(",["T_CONSTANT_ENCAPSED_STRING","'attribute_code = ?'",2203],",",["T_WHITESPACE"," ",2203],["T_CONSTANT_ENCAPSED_STRING","'url_key'",2203],")",["T_WHITESPACE","\n                ",2203],["T_OBJECT_OPERATOR","->",2204],["T_STRING","where",2204],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_type_id = ?'",2204],",",["T_WHITESPACE"," ",2204],["T_VARIABLE","$this",2204],["T_OBJECT_OPERATOR","->",2204],["T_STRING","_entityTypeId",2204],")",";",["T_WHITESPACE","\n\n            ",2204],["T_VARIABLE","$this",2206],["T_OBJECT_OPERATOR","->",2206],["T_STRING","_urlKeyAttributeId",2206],["T_WHITESPACE"," ",2206],"=",["T_WHITESPACE"," ",2206],["T_VARIABLE","$adapter",2206],["T_OBJECT_OPERATOR","->",2206],["T_STRING","fetchOne",2206],"(",["T_VARIABLE","$select",2206],")",";",["T_WHITESPACE","\n        ",2206],"}",["T_WHITESPACE","\n\n        ",2207],["T_RETURN","return",2209],["T_WHITESPACE"," ",2209],["T_VARIABLE","$this",2209],["T_OBJECT_OPERATOR","->",2209],["T_STRING","_urlKeyAttributeId",2209],";",["T_WHITESPACE","\n    ",2209],"}",["T_WHITESPACE","\n",2210],"}",["T_WHITESPACE","\n",2211]]