[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_ImportExport\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Import entity customer model\n *\n * @category    Mage\n * @package     Mage_ImportExport\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_ImportExport_Model_Import_Entity_Customer",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_ImportExport_Model_Import_Entity_Abstract",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Size of bunch - part of entities to save in one step.\n     *\/",36],["T_WHITESPACE","\n    ",38],["T_CONST","const",39],["T_WHITESPACE"," ",39],["T_STRING","BUNCH_SIZE",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_LNUMBER","20",39],";",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * Data row scopes.\n     *\/",41],["T_WHITESPACE","\n    ",43],["T_CONST","const",44],["T_WHITESPACE"," ",44],["T_STRING","SCOPE_DEFAULT",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_LNUMBER","1",44],";",["T_WHITESPACE","\n    ",44],["T_CONST","const",45],["T_WHITESPACE"," ",45],["T_STRING","SCOPE_ADDRESS",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],"-",["T_LNUMBER","1",45],";",["T_WHITESPACE","\n    ",45],["T_CONST","const",46],["T_WHITESPACE"," ",46],["T_STRING","SCOPE_OPTIONS",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_LNUMBER","2",46],";",["T_WHITESPACE","\n\n    ",46],["T_DOC_COMMENT","\/**\n     * Permanent column names.\n     *\n     * Names that begins with underscore is not an attribute. This name convention is for\n     * to avoid interference with same attribute name.\n     *\/",48],["T_WHITESPACE","\n    ",53],["T_CONST","const",54],["T_WHITESPACE"," ",54],["T_STRING","COL_EMAIL",54],["T_WHITESPACE","    ",54],"=",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'email'",54],";",["T_WHITESPACE","\n    ",54],["T_CONST","const",55],["T_WHITESPACE"," ",55],["T_STRING","COL_WEBSITE",55],["T_WHITESPACE","  ",55],"=",["T_WHITESPACE"," ",55],["T_CONSTANT_ENCAPSED_STRING","'_website'",55],";",["T_WHITESPACE","\n    ",55],["T_CONST","const",56],["T_WHITESPACE"," ",56],["T_STRING","COL_STORE",56],["T_WHITESPACE","    ",56],"=",["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'_store'",56],";",["T_WHITESPACE","\n    ",56],["T_CONST","const",57],["T_WHITESPACE"," ",57],["T_STRING","COL_POSTCODE",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'_address_postcode'",57],";",["T_WHITESPACE","\n\n    ",57],["T_DOC_COMMENT","\/**\n     * Error codes.\n     *\/",59],["T_WHITESPACE","\n    ",61],["T_CONST","const",62],["T_WHITESPACE"," ",62],["T_STRING","ERROR_INVALID_WEBSITE",62],["T_WHITESPACE","      ",62],"=",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'invalidWebsite'",62],";",["T_WHITESPACE","\n    ",62],["T_CONST","const",63],["T_WHITESPACE"," ",63],["T_STRING","ERROR_INVALID_EMAIL",63],["T_WHITESPACE","        ",63],"=",["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","'invalidEmail'",63],";",["T_WHITESPACE","\n    ",63],["T_CONST","const",64],["T_WHITESPACE"," ",64],["T_STRING","ERROR_DUPLICATE_EMAIL_SITE",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'duplicateEmailSite'",64],";",["T_WHITESPACE","\n    ",64],["T_CONST","const",65],["T_WHITESPACE"," ",65],["T_STRING","ERROR_EMAIL_IS_EMPTY",65],["T_WHITESPACE","       ",65],"=",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'emailIsEmpty'",65],";",["T_WHITESPACE","\n    ",65],["T_CONST","const",66],["T_WHITESPACE"," ",66],["T_STRING","ERROR_ROW_IS_ORPHAN",66],["T_WHITESPACE","        ",66],"=",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'rowIsOrphan'",66],";",["T_WHITESPACE","\n    ",66],["T_CONST","const",67],["T_WHITESPACE"," ",67],["T_STRING","ERROR_VALUE_IS_REQUIRED",67],["T_WHITESPACE","    ",67],"=",["T_WHITESPACE"," ",67],["T_CONSTANT_ENCAPSED_STRING","'valueIsRequired'",67],";",["T_WHITESPACE","\n    ",67],["T_CONST","const",68],["T_WHITESPACE"," ",68],["T_STRING","ERROR_INVALID_STORE",68],["T_WHITESPACE","        ",68],"=",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'invalidStore'",68],";",["T_WHITESPACE","\n    ",68],["T_CONST","const",69],["T_WHITESPACE"," ",69],["T_STRING","ERROR_EMAIL_SITE_NOT_FOUND",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'emailSiteNotFound'",69],";",["T_WHITESPACE","\n    ",69],["T_CONST","const",70],["T_WHITESPACE"," ",70],["T_STRING","ERROR_PASSWORD_LENGTH",70],["T_WHITESPACE","      ",70],"=",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'passwordLength'",70],";",["T_WHITESPACE","\n\n    ",70],["T_DOC_COMMENT","\/**\n     * Customer constants\n     *\n     *\/",72],["T_WHITESPACE","\n    ",75],["T_CONST","const",76],["T_WHITESPACE"," ",76],["T_STRING","DEFAULT_GROUP_ID",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_LNUMBER","1",76],";",["T_WHITESPACE","\n    ",76],["T_CONST","const",77],["T_WHITESPACE"," ",77],["T_STRING","MAX_PASSWD_LENGTH",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_LNUMBER","6",77],";",["T_WHITESPACE","\n\n    ",77],["T_DOC_COMMENT","\/**\n     * Customer address import entity model.\n     *\n     * @var Mage_ImportExport_Model_Import_Entity_Customer_Address\n     *\/",79],["T_WHITESPACE","\n    ",83],["T_PROTECTED","protected",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$_addressEntity",84],";",["T_WHITESPACE","\n\n    ",84],["T_DOC_COMMENT","\/**\n     * Customer attributes parameters.\n     *\n     *  [attr_code_1] => array(\n     *      'options' => array(),\n     *      'type' => 'text', 'price', 'textarea', 'select', etc.\n     *      'id' => ..\n     *  ),\n     *  ...\n     *\n     * @var array\n     *\/",86],["T_WHITESPACE","\n    ",97],["T_PROTECTED","protected",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$_attributes",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_ARRAY","array",98],"(",")",";",["T_WHITESPACE","\n\n    ",98],["T_DOC_COMMENT","\/**\n     * MultiSelect Attributes\n     *\n     * @var array\n     *\/",100],["T_WHITESPACE","\n    ",104],["T_PROTECTED","protected",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$_multiSelectAttributes",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_ARRAY","array",105],"(",")",";",["T_WHITESPACE","\n\n    ",105],["T_DOC_COMMENT","\/**\n     * Customer account sharing. TRUE - is global, FALSE - is per website.\n     *\n     * @var boolean\n     *\/",107],["T_WHITESPACE","\n    ",111],["T_PROTECTED","protected",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$_customerGlobal",112],";",["T_WHITESPACE","\n\n    ",112],["T_DOC_COMMENT","\/**\n     * Customer groups ID-to-name.\n     *\n     * @var array\n     *\/",114],["T_WHITESPACE","\n    ",118],["T_PROTECTED","protected",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$_customerGroups",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_ARRAY","array",119],"(",")",";",["T_WHITESPACE","\n\n    ",119],["T_DOC_COMMENT","\/**\n     * Customer entity DB table name.\n     *\n     * @var string\n     *\/",121],["T_WHITESPACE","\n    ",125],["T_PROTECTED","protected",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$_entityTable",126],";",["T_WHITESPACE","\n\n    ",126],["T_DOC_COMMENT","\/**\n     * Array of attribute codes which will be ignored in validation and import procedures.\n     * For example, when entity attribute has own validation and import procedures\n     * or just to deny this attribute processing.\n     *\n     * @var array\n     *\/",128],["T_WHITESPACE","\n    ",134],["T_PROTECTED","protected",135],["T_WHITESPACE"," ",135],["T_VARIABLE","$_ignoredAttributes",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_ARRAY","array",135],"(",["T_CONSTANT_ENCAPSED_STRING","'website_id'",135],",",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","'store_id'",135],",",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","'default_billing'",135],",",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","'default_shipping'",135],")",";",["T_WHITESPACE","\n\n    ",135],["T_DOC_COMMENT","\/**\n     * Attributes with index (not label) value.\n     *\n     * @var array\n     *\/",137],["T_WHITESPACE","\n    ",141],["T_PROTECTED","protected",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$_indexValueAttributes",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_ARRAY","array",142],"(",["T_CONSTANT_ENCAPSED_STRING","'group_id'",142],")",";",["T_WHITESPACE","\n\n    ",142],["T_DOC_COMMENT","\/**\n     * Validation failure message template definitions\n     *\n     * @var array\n     *\/",144],["T_WHITESPACE","\n    ",148],["T_PROTECTED","protected",149],["T_WHITESPACE"," ",149],["T_VARIABLE","$_messageTemplates",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_ARRAY","array",149],"(",["T_WHITESPACE","\n        ",149],["T_STRING","self",150],["T_DOUBLE_COLON","::",150],["T_STRING","ERROR_INVALID_WEBSITE",150],["T_WHITESPACE","      ",150],["T_DOUBLE_ARROW","=>",150],["T_WHITESPACE"," ",150],["T_CONSTANT_ENCAPSED_STRING","'Invalid value in Website column (website does not exists?)'",150],",",["T_WHITESPACE","\n        ",150],["T_STRING","self",151],["T_DOUBLE_COLON","::",151],["T_STRING","ERROR_INVALID_EMAIL",151],["T_WHITESPACE","        ",151],["T_DOUBLE_ARROW","=>",151],["T_WHITESPACE"," ",151],["T_CONSTANT_ENCAPSED_STRING","'E-mail is invalid'",151],",",["T_WHITESPACE","\n        ",151],["T_STRING","self",152],["T_DOUBLE_COLON","::",152],["T_STRING","ERROR_DUPLICATE_EMAIL_SITE",152],["T_WHITESPACE"," ",152],["T_DOUBLE_ARROW","=>",152],["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","'E-mail is duplicated in import file'",152],",",["T_WHITESPACE","\n        ",152],["T_STRING","self",153],["T_DOUBLE_COLON","::",153],["T_STRING","ERROR_EMAIL_IS_EMPTY",153],["T_WHITESPACE","       ",153],["T_DOUBLE_ARROW","=>",153],["T_WHITESPACE"," ",153],["T_CONSTANT_ENCAPSED_STRING","'E-mail is not specified'",153],",",["T_WHITESPACE","\n        ",153],["T_STRING","self",154],["T_DOUBLE_COLON","::",154],["T_STRING","ERROR_ROW_IS_ORPHAN",154],["T_WHITESPACE","        ",154],["T_DOUBLE_ARROW","=>",154],["T_WHITESPACE"," ",154],["T_CONSTANT_ENCAPSED_STRING","'Orphan rows that will be skipped due default row errors'",154],",",["T_WHITESPACE","\n        ",154],["T_STRING","self",155],["T_DOUBLE_COLON","::",155],["T_STRING","ERROR_VALUE_IS_REQUIRED",155],["T_WHITESPACE","    ",155],["T_DOUBLE_ARROW","=>",155],["T_WHITESPACE"," ",155],["T_CONSTANT_ENCAPSED_STRING","\"Required attribute '%s' has an empty value\"",155],",",["T_WHITESPACE","\n        ",155],["T_STRING","self",156],["T_DOUBLE_COLON","::",156],["T_STRING","ERROR_INVALID_STORE",156],["T_WHITESPACE","        ",156],["T_DOUBLE_ARROW","=>",156],["T_WHITESPACE"," ",156],["T_CONSTANT_ENCAPSED_STRING","'Invalid value in Store column (store does not exists?)'",156],",",["T_WHITESPACE","\n        ",156],["T_STRING","self",157],["T_DOUBLE_COLON","::",157],["T_STRING","ERROR_EMAIL_SITE_NOT_FOUND",157],["T_WHITESPACE"," ",157],["T_DOUBLE_ARROW","=>",157],["T_WHITESPACE"," ",157],["T_CONSTANT_ENCAPSED_STRING","'E-mail and website combination is not found'",157],",",["T_WHITESPACE","\n        ",157],["T_STRING","self",158],["T_DOUBLE_COLON","::",158],["T_STRING","ERROR_PASSWORD_LENGTH",158],["T_WHITESPACE","      ",158],["T_DOUBLE_ARROW","=>",158],["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","'Invalid password length'",158],["T_WHITESPACE","\n    ",158],")",";",["T_WHITESPACE","\n\n    ",159],["T_DOC_COMMENT","\/**\n     * Dry-runned customers information from import file.\n     *\n     * @var array\n     *\/",161],["T_WHITESPACE","\n    ",165],["T_PROTECTED","protected",166],["T_WHITESPACE"," ",166],["T_VARIABLE","$_newCustomers",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_ARRAY","array",166],"(",")",";",["T_WHITESPACE","\n\n    ",166],["T_DOC_COMMENT","\/**\n     * Existing customers information. In form of:\n     *\n     * [customer e-mail] => array(\n     *    [website code 1] => customer_id 1,\n     *    [website code 2] => customer_id 2,\n     *           ...       =>     ...      ,\n     *    [website code n] => customer_id n,\n     * )\n     *\n     * @var array\n     *\/",168],["T_WHITESPACE","\n    ",179],["T_PROTECTED","protected",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$_oldCustomers",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_ARRAY","array",180],"(",")",";",["T_WHITESPACE","\n\n    ",180],["T_DOC_COMMENT","\/**\n     * Column names that holds values with particular meaning.\n     *\n     * @var array\n     *\/",182],["T_WHITESPACE","\n    ",186],["T_PROTECTED","protected",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$_particularAttributes",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_ARRAY","array",187],"(",["T_STRING","self",187],["T_DOUBLE_COLON","::",187],["T_STRING","COL_WEBSITE",187],",",["T_WHITESPACE"," ",187],["T_STRING","self",187],["T_DOUBLE_COLON","::",187],["T_STRING","COL_STORE",187],")",";",["T_WHITESPACE","\n\n    ",187],["T_DOC_COMMENT","\/**\n     * Permanent entity columns.\n     *\n     * @var array\n     *\/",189],["T_WHITESPACE","\n    ",193],["T_PROTECTED","protected",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$_permanentAttributes",194],["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],["T_ARRAY","array",194],"(",["T_STRING","self",194],["T_DOUBLE_COLON","::",194],["T_STRING","COL_EMAIL",194],",",["T_WHITESPACE"," ",194],["T_STRING","self",194],["T_DOUBLE_COLON","::",194],["T_STRING","COL_WEBSITE",194],")",";",["T_WHITESPACE","\n\n    ",194],["T_DOC_COMMENT","\/**\n     * All stores code-ID pairs.\n     *\n     * @var array\n     *\/",196],["T_WHITESPACE","\n    ",200],["T_PROTECTED","protected",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$_storeCodeToId",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_ARRAY","array",201],"(",")",";",["T_WHITESPACE","\n\n    ",201],["T_DOC_COMMENT","\/**\n     * Website code-to-ID\n     *\n     * @var array\n     *\/",203],["T_WHITESPACE","\n    ",207],["T_PROTECTED","protected",208],["T_WHITESPACE"," ",208],["T_VARIABLE","$_websiteCodeToId",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_ARRAY","array",208],"(",")",";",["T_WHITESPACE","\n\n    ",208],["T_DOC_COMMENT","\/**\n     * Website ID-to-code\n     *\n     * @var array\n     *\/",210],["T_WHITESPACE","\n    ",214],["T_PROTECTED","protected",215],["T_WHITESPACE"," ",215],["T_VARIABLE","$_websiteIdToCode",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_ARRAY","array",215],"(",")",";",["T_WHITESPACE","\n\n    ",215],["T_DOC_COMMENT","\/**\n     * Constructor.\n     *\n     * @return void\n     *\/",217],["T_WHITESPACE","\n    ",221],["T_PUBLIC","public",222],["T_WHITESPACE"," ",222],["T_FUNCTION","function",222],["T_WHITESPACE"," ",222],["T_STRING","__construct",222],"(",")",["T_WHITESPACE","\n    ",222],"{",["T_WHITESPACE","\n        ",223],["T_STRING","parent",224],["T_DOUBLE_COLON","::",224],["T_STRING","__construct",224],"(",")",";",["T_WHITESPACE","\n\n        ",224],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","_initWebsites",226],"(",")",["T_WHITESPACE","\n            ",226],["T_OBJECT_OPERATOR","->",227],["T_STRING","_initStores",227],"(",")",["T_WHITESPACE","\n            ",227],["T_OBJECT_OPERATOR","->",228],["T_STRING","_initCustomerGroups",228],"(",")",["T_WHITESPACE","\n            ",228],["T_OBJECT_OPERATOR","->",229],["T_STRING","_initAttributes",229],"(",")",["T_WHITESPACE","\n            ",229],["T_OBJECT_OPERATOR","->",230],["T_STRING","_initCustomers",230],"(",")",";",["T_WHITESPACE","\n\n        ",230],["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","_entityTable",232],["T_WHITESPACE","   ",232],"=",["T_WHITESPACE"," ",232],["T_STRING","Mage",232],["T_DOUBLE_COLON","::",232],["T_STRING","getModel",232],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/customer'",232],")",["T_OBJECT_OPERATOR","->",232],["T_STRING","getResource",232],"(",")",["T_OBJECT_OPERATOR","->",232],["T_STRING","getEntityTable",232],"(",")",";",["T_WHITESPACE","\n        ",232],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","_addressEntity",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_STRING","Mage",233],["T_DOUBLE_COLON","::",233],["T_STRING","getModel",233],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport\/import_entity_customer_address'",233],",",["T_WHITESPACE"," ",233],["T_VARIABLE","$this",233],")",";",["T_WHITESPACE","\n    ",233],"}",["T_WHITESPACE","\n\n    ",234],["T_DOC_COMMENT","\/**\n     * Delete customers.\n     *\n     * @return Mage_ImportExport_Model_Import_Entity_Customer\n     *\/",236],["T_WHITESPACE","\n    ",240],["T_PROTECTED","protected",241],["T_WHITESPACE"," ",241],["T_FUNCTION","function",241],["T_WHITESPACE"," ",241],["T_STRING","_deleteCustomers",241],"(",")",["T_WHITESPACE","\n    ",241],"{",["T_WHITESPACE","\n        ",242],["T_WHILE","while",243],["T_WHITESPACE"," ",243],"(",["T_VARIABLE","$bunch",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","_dataSourceModel",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","getNextBunch",243],"(",")",")",["T_WHITESPACE"," ",243],"{",["T_WHITESPACE","\n            ",243],["T_VARIABLE","$idToDelete",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_ARRAY","array",244],"(",")",";",["T_WHITESPACE","\n\n            ",244],["T_FOREACH","foreach",246],["T_WHITESPACE"," ",246],"(",["T_VARIABLE","$bunch",246],["T_WHITESPACE"," ",246],["T_AS","as",246],["T_WHITESPACE"," ",246],["T_VARIABLE","$rowNum",246],["T_WHITESPACE"," ",246],["T_DOUBLE_ARROW","=>",246],["T_WHITESPACE"," ",246],["T_VARIABLE","$rowData",246],")",["T_WHITESPACE"," ",246],"{",["T_WHITESPACE","\n                ",246],["T_IF","if",247],["T_WHITESPACE"," ",247],"(",["T_STRING","self",247],["T_DOUBLE_COLON","::",247],["T_STRING","SCOPE_DEFAULT",247],["T_WHITESPACE"," ",247],["T_IS_EQUAL","==",247],["T_WHITESPACE"," ",247],["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","getRowScope",247],"(",["T_VARIABLE","$rowData",247],")",["T_WHITESPACE"," ",247],["T_BOOLEAN_AND","&&",247],["T_WHITESPACE"," ",247],["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","validateRow",247],"(",["T_VARIABLE","$rowData",247],",",["T_WHITESPACE"," ",247],["T_VARIABLE","$rowNum",247],")",")",["T_WHITESPACE"," ",247],"{",["T_WHITESPACE","\n                    ",247],["T_VARIABLE","$idToDelete",248],"[","]",["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","_oldCustomers",248],"[",["T_VARIABLE","$rowData",248],"[",["T_STRING","self",248],["T_DOUBLE_COLON","::",248],["T_STRING","COL_EMAIL",248],"]","]","[",["T_VARIABLE","$rowData",248],"[",["T_STRING","self",248],["T_DOUBLE_COLON","::",248],["T_STRING","COL_WEBSITE",248],"]","]",";",["T_WHITESPACE","\n                ",248],"}",["T_WHITESPACE","\n            ",249],"}",["T_WHITESPACE","\n            ",250],["T_IF","if",251],["T_WHITESPACE"," ",251],"(",["T_VARIABLE","$idToDelete",251],")",["T_WHITESPACE"," ",251],"{",["T_WHITESPACE","\n                ",251],["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","_connection",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","query",252],"(",["T_WHITESPACE","\n                    ",252],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","_connection",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","quoteInto",253],"(",["T_WHITESPACE","\n                        ",253],"\"",["T_ENCAPSED_AND_WHITESPACE","DELETE FROM `",254],["T_CURLY_OPEN","{",254],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","_entityTable",254],"}",["T_ENCAPSED_AND_WHITESPACE","` WHERE `entity_id` IN (?)",254],"\"",",",["T_WHITESPACE"," ",254],["T_VARIABLE","$idToDelete",254],["T_WHITESPACE","\n                    ",254],")",["T_WHITESPACE","\n                ",255],")",";",["T_WHITESPACE","\n            ",256],"}",["T_WHITESPACE","\n        ",257],"}",["T_WHITESPACE","\n        ",258],["T_RETURN","return",259],["T_WHITESPACE"," ",259],["T_VARIABLE","$this",259],";",["T_WHITESPACE","\n    ",259],"}",["T_WHITESPACE","\n\n    ",260],["T_DOC_COMMENT","\/**\n     * Save customer data to DB.\n     *\n     * @throws Exception\n     * @return bool Result of operation.\n     *\/",262],["T_WHITESPACE","\n    ",267],["T_PROTECTED","protected",268],["T_WHITESPACE"," ",268],["T_FUNCTION","function",268],["T_WHITESPACE"," ",268],["T_STRING","_importData",268],"(",")",["T_WHITESPACE","\n    ",268],"{",["T_WHITESPACE","\n        ",269],["T_IF","if",270],["T_WHITESPACE"," ",270],"(",["T_STRING","Mage_ImportExport_Model_Import",270],["T_DOUBLE_COLON","::",270],["T_STRING","BEHAVIOR_DELETE",270],["T_WHITESPACE"," ",270],["T_IS_EQUAL","==",270],["T_WHITESPACE"," ",270],["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","getBehavior",270],"(",")",")",["T_WHITESPACE"," ",270],"{",["T_WHITESPACE","\n            ",270],["T_VARIABLE","$this",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","_deleteCustomers",271],"(",")",";",["T_WHITESPACE","\n        ",271],"}",["T_WHITESPACE"," ",272],["T_ELSE","else",272],["T_WHITESPACE"," ",272],"{",["T_WHITESPACE","\n            ",272],["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","_saveCustomers",273],"(",")",";",["T_WHITESPACE","\n            ",273],["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","_addressEntity",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","importData",274],"(",")",";",["T_WHITESPACE","\n        ",274],"}",["T_WHITESPACE","\n        ",275],["T_RETURN","return",276],["T_WHITESPACE"," ",276],["T_STRING","true",276],";",["T_WHITESPACE","\n    ",276],"}",["T_WHITESPACE","\n\n    ",277],["T_DOC_COMMENT","\/**\n     * Initialize customer attributes.\n     *\n     * @return Mage_ImportExport_Model_Import_Entity_Customer\n     *\/",279],["T_WHITESPACE","\n    ",283],["T_PROTECTED","protected",284],["T_WHITESPACE"," ",284],["T_FUNCTION","function",284],["T_WHITESPACE"," ",284],["T_STRING","_initAttributes",284],"(",")",["T_WHITESPACE","\n    ",284],"{",["T_WHITESPACE","\n        ",285],["T_VARIABLE","$collection",286],["T_WHITESPACE"," ",286],"=",["T_WHITESPACE"," ",286],["T_STRING","Mage",286],["T_DOUBLE_COLON","::",286],["T_STRING","getResourceModel",286],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/attribute_collection'",286],")",["T_OBJECT_OPERATOR","->",286],["T_STRING","addSystemHiddenFilterWithPasswordHash",286],"(",")",";",["T_WHITESPACE","\n        ",286],["T_FOREACH","foreach",287],["T_WHITESPACE"," ",287],"(",["T_VARIABLE","$collection",287],["T_WHITESPACE"," ",287],["T_AS","as",287],["T_WHITESPACE"," ",287],["T_VARIABLE","$attribute",287],")",["T_WHITESPACE"," ",287],"{",["T_WHITESPACE","\n            ",287],["T_VARIABLE","$attributeArray",288],["T_WHITESPACE"," ",288],"=",["T_WHITESPACE"," ",288],["T_ARRAY","array",288],"(",["T_WHITESPACE","\n                ",288],["T_CONSTANT_ENCAPSED_STRING","'id'",289],["T_WHITESPACE","          ",289],["T_DOUBLE_ARROW","=>",289],["T_WHITESPACE"," ",289],["T_VARIABLE","$attribute",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","getId",289],"(",")",",",["T_WHITESPACE","\n                ",289],["T_CONSTANT_ENCAPSED_STRING","'is_required'",290],["T_WHITESPACE"," ",290],["T_DOUBLE_ARROW","=>",290],["T_WHITESPACE"," ",290],["T_VARIABLE","$attribute",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","getIsRequired",290],"(",")",",",["T_WHITESPACE","\n                ",290],["T_CONSTANT_ENCAPSED_STRING","'is_static'",291],["T_WHITESPACE","   ",291],["T_DOUBLE_ARROW","=>",291],["T_WHITESPACE"," ",291],["T_VARIABLE","$attribute",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","isStatic",291],"(",")",",",["T_WHITESPACE","\n                ",291],["T_CONSTANT_ENCAPSED_STRING","'rules'",292],["T_WHITESPACE","       ",292],["T_DOUBLE_ARROW","=>",292],["T_WHITESPACE"," ",292],["T_VARIABLE","$attribute",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","getValidateRules",292],"(",")",["T_WHITESPACE"," ",292],"?",["T_WHITESPACE"," ",292],["T_STRING","unserialize",292],"(",["T_VARIABLE","$attribute",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","getValidateRules",292],"(",")",")",["T_WHITESPACE"," ",292],":",["T_WHITESPACE"," ",292],["T_STRING","null",292],",",["T_WHITESPACE","\n                ",292],["T_CONSTANT_ENCAPSED_STRING","'type'",293],["T_WHITESPACE","        ",293],["T_DOUBLE_ARROW","=>",293],["T_WHITESPACE"," ",293],["T_STRING","Mage_ImportExport_Model_Import",293],["T_DOUBLE_COLON","::",293],["T_STRING","getAttributeType",293],"(",["T_VARIABLE","$attribute",293],")",",",["T_WHITESPACE","\n                ",293],["T_CONSTANT_ENCAPSED_STRING","'options'",294],["T_WHITESPACE","     ",294],["T_DOUBLE_ARROW","=>",294],["T_WHITESPACE"," ",294],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","getAttributeOptions",294],"(",["T_VARIABLE","$attribute",294],")",["T_WHITESPACE","\n            ",294],")",";",["T_WHITESPACE","\n            ",295],["T_VARIABLE","$this",296],["T_OBJECT_OPERATOR","->",296],["T_STRING","_attributes",296],"[",["T_VARIABLE","$attribute",296],["T_OBJECT_OPERATOR","->",296],["T_STRING","getAttributeCode",296],"(",")","]",["T_WHITESPACE"," ",296],"=",["T_WHITESPACE"," ",296],["T_VARIABLE","$attributeArray",296],";",["T_WHITESPACE","\n            ",296],["T_IF","if",297],["T_WHITESPACE"," ",297],"(",["T_STRING","Mage_ImportExport_Model_Import",297],["T_DOUBLE_COLON","::",297],["T_STRING","getAttributeType",297],"(",["T_VARIABLE","$attribute",297],")",["T_WHITESPACE"," ",297],["T_IS_EQUAL","==",297],["T_WHITESPACE"," ",297],["T_CONSTANT_ENCAPSED_STRING","'multiselect'",297],")",["T_WHITESPACE"," ",297],"{",["T_WHITESPACE","\n                ",297],["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","_multiSelectAttributes",298],"[",["T_VARIABLE","$attribute",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","getAttributeCode",298],"(",")","]",["T_WHITESPACE"," ",298],"=",["T_WHITESPACE"," ",298],["T_VARIABLE","$attributeArray",298],";",["T_WHITESPACE","\n            ",298],"}",["T_WHITESPACE","\n        ",299],"}",["T_WHITESPACE","\n        ",300],["T_RETURN","return",301],["T_WHITESPACE"," ",301],["T_VARIABLE","$this",301],";",["T_WHITESPACE","\n    ",301],"}",["T_WHITESPACE","\n\n    ",302],["T_DOC_COMMENT","\/**\n     * Initialize customer groups.\n     *\n     * @return Mage_ImportExport_Model_Import_Entity_Customer\n     *\/",304],["T_WHITESPACE","\n    ",308],["T_PROTECTED","protected",309],["T_WHITESPACE"," ",309],["T_FUNCTION","function",309],["T_WHITESPACE"," ",309],["T_STRING","_initCustomerGroups",309],"(",")",["T_WHITESPACE","\n    ",309],"{",["T_WHITESPACE","\n        ",310],["T_FOREACH","foreach",311],["T_WHITESPACE"," ",311],"(",["T_STRING","Mage",311],["T_DOUBLE_COLON","::",311],["T_STRING","getResourceModel",311],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/group_collection'",311],")",["T_WHITESPACE"," ",311],["T_AS","as",311],["T_WHITESPACE"," ",311],["T_VARIABLE","$customerGroup",311],")",["T_WHITESPACE"," ",311],"{",["T_WHITESPACE","\n            ",311],["T_VARIABLE","$this",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","_customerGroups",312],"[",["T_VARIABLE","$customerGroup",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","getId",312],"(",")","]",["T_WHITESPACE"," ",312],"=",["T_WHITESPACE"," ",312],["T_STRING","true",312],";",["T_WHITESPACE","\n        ",312],"}",["T_WHITESPACE","\n        ",313],["T_RETURN","return",314],["T_WHITESPACE"," ",314],["T_VARIABLE","$this",314],";",["T_WHITESPACE","\n    ",314],"}",["T_WHITESPACE","\n\n    ",315],["T_DOC_COMMENT","\/**\n     * Initialize existent customers data.\n     *\n     * @return Mage_ImportExport_Model_Import_Entity_Customer\n     *\/",317],["T_WHITESPACE","\n    ",321],["T_PROTECTED","protected",322],["T_WHITESPACE"," ",322],["T_FUNCTION","function",322],["T_WHITESPACE"," ",322],["T_STRING","_initCustomers",322],"(",")",["T_WHITESPACE","\n    ",322],"{",["T_WHITESPACE","\n        ",323],["T_FOREACH","foreach",324],["T_WHITESPACE"," ",324],"(",["T_STRING","Mage",324],["T_DOUBLE_COLON","::",324],["T_STRING","getResourceModel",324],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/customer_collection'",324],")",["T_WHITESPACE"," ",324],["T_AS","as",324],["T_WHITESPACE"," ",324],["T_VARIABLE","$customer",324],")",["T_WHITESPACE"," ",324],"{",["T_WHITESPACE","\n            ",324],["T_VARIABLE","$email",325],["T_WHITESPACE"," ",325],"=",["T_WHITESPACE"," ",325],["T_VARIABLE","$customer",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","getEmail",325],"(",")",";",["T_WHITESPACE","\n\n            ",325],["T_IF","if",327],["T_WHITESPACE"," ",327],"(","!",["T_ISSET","isset",327],"(",["T_VARIABLE","$this",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","_oldCustomers",327],"[",["T_VARIABLE","$email",327],"]",")",")",["T_WHITESPACE"," ",327],"{",["T_WHITESPACE","\n                ",327],["T_VARIABLE","$this",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","_oldCustomers",328],"[",["T_VARIABLE","$email",328],"]",["T_WHITESPACE"," ",328],"=",["T_WHITESPACE"," ",328],["T_ARRAY","array",328],"(",")",";",["T_WHITESPACE","\n            ",328],"}",["T_WHITESPACE","\n            ",329],["T_VARIABLE","$this",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","_oldCustomers",330],"[",["T_VARIABLE","$email",330],"]","[",["T_VARIABLE","$this",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","_websiteIdToCode",330],"[",["T_VARIABLE","$customer",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","getWebsiteId",330],"(",")","]","]",["T_WHITESPACE"," ",330],"=",["T_WHITESPACE"," ",330],["T_VARIABLE","$customer",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","getId",330],"(",")",";",["T_WHITESPACE","\n        ",330],"}",["T_WHITESPACE","\n        ",331],["T_VARIABLE","$this",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","_customerGlobal",332],["T_WHITESPACE"," ",332],"=",["T_WHITESPACE"," ",332],["T_STRING","Mage",332],["T_DOUBLE_COLON","::",332],["T_STRING","getModel",332],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/customer'",332],")",["T_OBJECT_OPERATOR","->",332],["T_STRING","getSharingConfig",332],"(",")",["T_OBJECT_OPERATOR","->",332],["T_STRING","isGlobalScope",332],"(",")",";",["T_WHITESPACE","\n\n        ",332],["T_RETURN","return",334],["T_WHITESPACE"," ",334],["T_VARIABLE","$this",334],";",["T_WHITESPACE","\n    ",334],"}",["T_WHITESPACE","\n\n    ",335],["T_DOC_COMMENT","\/**\n     * Initialize stores hash.\n     *\n     * @return Mage_ImportExport_Model_Import_Entity_Customer\n     *\/",337],["T_WHITESPACE","\n    ",341],["T_PROTECTED","protected",342],["T_WHITESPACE"," ",342],["T_FUNCTION","function",342],["T_WHITESPACE"," ",342],["T_STRING","_initStores",342],"(",")",["T_WHITESPACE","\n    ",342],"{",["T_WHITESPACE","\n        ",343],["T_FOREACH","foreach",344],["T_WHITESPACE"," ",344],"(",["T_STRING","Mage",344],["T_DOUBLE_COLON","::",344],["T_STRING","app",344],"(",")",["T_OBJECT_OPERATOR","->",344],["T_STRING","getStores",344],"(",["T_STRING","true",344],")",["T_WHITESPACE"," ",344],["T_AS","as",344],["T_WHITESPACE"," ",344],["T_VARIABLE","$store",344],")",["T_WHITESPACE"," ",344],"{",["T_WHITESPACE","\n            ",344],["T_VARIABLE","$this",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","_storeCodeToId",345],"[",["T_VARIABLE","$store",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","getCode",345],"(",")","]",["T_WHITESPACE"," ",345],"=",["T_WHITESPACE"," ",345],["T_VARIABLE","$store",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","getId",345],"(",")",";",["T_WHITESPACE","\n        ",345],"}",["T_WHITESPACE","\n        ",346],["T_RETURN","return",347],["T_WHITESPACE"," ",347],["T_VARIABLE","$this",347],";",["T_WHITESPACE","\n    ",347],"}",["T_WHITESPACE","\n\n    ",348],["T_DOC_COMMENT","\/**\n     * Initialize website values.\n     *\n     * @return Mage_ImportExport_Model_Import_Entity_Customer\n     *\/",350],["T_WHITESPACE","\n    ",354],["T_PROTECTED","protected",355],["T_WHITESPACE"," ",355],["T_FUNCTION","function",355],["T_WHITESPACE"," ",355],["T_STRING","_initWebsites",355],"(",")",["T_WHITESPACE","\n    ",355],"{",["T_WHITESPACE","\n        ",356],["T_DOC_COMMENT","\/** @var $website Mage_Core_Model_Website *\/",357],["T_WHITESPACE","\n        ",357],["T_FOREACH","foreach",358],["T_WHITESPACE"," ",358],"(",["T_STRING","Mage",358],["T_DOUBLE_COLON","::",358],["T_STRING","app",358],"(",")",["T_OBJECT_OPERATOR","->",358],["T_STRING","getWebsites",358],"(",["T_STRING","true",358],")",["T_WHITESPACE"," ",358],["T_AS","as",358],["T_WHITESPACE"," ",358],["T_VARIABLE","$website",358],")",["T_WHITESPACE"," ",358],"{",["T_WHITESPACE","\n            ",358],["T_VARIABLE","$this",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","_websiteCodeToId",359],"[",["T_VARIABLE","$website",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","getCode",359],"(",")","]",["T_WHITESPACE"," ",359],"=",["T_WHITESPACE"," ",359],["T_VARIABLE","$website",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","getId",359],"(",")",";",["T_WHITESPACE","\n            ",359],["T_VARIABLE","$this",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","_websiteIdToCode",360],"[",["T_VARIABLE","$website",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","getId",360],"(",")","]",["T_WHITESPACE","   ",360],"=",["T_WHITESPACE"," ",360],["T_VARIABLE","$website",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","getCode",360],"(",")",";",["T_WHITESPACE","\n        ",360],"}",["T_WHITESPACE","\n        ",361],["T_RETURN","return",362],["T_WHITESPACE"," ",362],["T_VARIABLE","$this",362],";",["T_WHITESPACE","\n    ",362],"}",["T_WHITESPACE","\n\n    ",363],["T_DOC_COMMENT","\/**\n     * Gather and save information about customer entities.\n     *\n     * @return Mage_ImportExport_Model_Import_Entity_Customer\n     *\/",365],["T_WHITESPACE","\n    ",369],["T_PROTECTED","protected",370],["T_WHITESPACE"," ",370],["T_FUNCTION","function",370],["T_WHITESPACE"," ",370],["T_STRING","_saveCustomers",370],"(",")",["T_WHITESPACE","\n    ",370],"{",["T_WHITESPACE","\n        ",371],["T_DOC_COMMENT","\/** @var $resource Mage_Customer_Model_Customer *\/",372],["T_WHITESPACE","\n        ",372],["T_VARIABLE","$resource",373],["T_WHITESPACE","       ",373],"=",["T_WHITESPACE"," ",373],["T_STRING","Mage",373],["T_DOUBLE_COLON","::",373],["T_STRING","getModel",373],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/customer'",373],")",";",["T_WHITESPACE","\n        ",373],["T_VARIABLE","$strftimeFormat",374],["T_WHITESPACE"," ",374],"=",["T_WHITESPACE"," ",374],["T_STRING","Varien_Date",374],["T_DOUBLE_COLON","::",374],["T_STRING","convertZendToStrftime",374],"(",["T_STRING","Varien_Date",374],["T_DOUBLE_COLON","::",374],["T_STRING","DATETIME_INTERNAL_FORMAT",374],",",["T_WHITESPACE"," ",374],["T_STRING","true",374],",",["T_WHITESPACE"," ",374],["T_STRING","true",374],")",";",["T_WHITESPACE","\n        ",374],["T_VARIABLE","$table",375],["T_WHITESPACE"," ",375],"=",["T_WHITESPACE"," ",375],["T_VARIABLE","$resource",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","getResource",375],"(",")",["T_OBJECT_OPERATOR","->",375],["T_STRING","getEntityTable",375],"(",")",";",["T_WHITESPACE","\n        ",375],["T_VARIABLE","$nextEntityId",376],["T_WHITESPACE","   ",376],"=",["T_WHITESPACE"," ",376],["T_STRING","Mage",376],["T_DOUBLE_COLON","::",376],["T_STRING","getResourceHelper",376],"(",["T_CONSTANT_ENCAPSED_STRING","'importexport'",376],")",["T_OBJECT_OPERATOR","->",376],["T_STRING","getNextAutoincrement",376],"(",["T_VARIABLE","$table",376],")",";",["T_WHITESPACE","\n        ",376],["T_VARIABLE","$passId",377],["T_WHITESPACE","         ",377],"=",["T_WHITESPACE"," ",377],["T_VARIABLE","$resource",377],["T_OBJECT_OPERATOR","->",377],["T_STRING","getAttribute",377],"(",["T_CONSTANT_ENCAPSED_STRING","'password_hash'",377],")",["T_OBJECT_OPERATOR","->",377],["T_STRING","getId",377],"(",")",";",["T_WHITESPACE","\n        ",377],["T_VARIABLE","$passTable",378],["T_WHITESPACE","      ",378],"=",["T_WHITESPACE"," ",378],["T_VARIABLE","$resource",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","getAttribute",378],"(",["T_CONSTANT_ENCAPSED_STRING","'password_hash'",378],")",["T_OBJECT_OPERATOR","->",378],["T_STRING","getBackend",378],"(",")",["T_OBJECT_OPERATOR","->",378],["T_STRING","getTable",378],"(",")",";",["T_WHITESPACE","\n        ",378],["T_VARIABLE","$multiSelect",379],["T_WHITESPACE","    ",379],"=",["T_WHITESPACE"," ",379],["T_ARRAY","array",379],"(",")",";",["T_WHITESPACE","\n\n        ",379],["T_WHILE","while",381],["T_WHITESPACE"," ",381],"(",["T_VARIABLE","$bunch",381],["T_WHITESPACE"," ",381],"=",["T_WHITESPACE"," ",381],["T_VARIABLE","$this",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","_dataSourceModel",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","getNextBunch",381],"(",")",")",["T_WHITESPACE"," ",381],"{",["T_WHITESPACE","\n            ",381],["T_VARIABLE","$entityRowsIn",382],["T_WHITESPACE"," ",382],"=",["T_WHITESPACE"," ",382],["T_ARRAY","array",382],"(",")",";",["T_WHITESPACE","\n            ",382],["T_VARIABLE","$entityRowsUp",383],["T_WHITESPACE"," ",383],"=",["T_WHITESPACE"," ",383],["T_ARRAY","array",383],"(",")",";",["T_WHITESPACE","\n            ",383],["T_VARIABLE","$attributes",384],["T_WHITESPACE","   ",384],"=",["T_WHITESPACE"," ",384],["T_ARRAY","array",384],"(",")",";",["T_WHITESPACE","\n\n            ",384],["T_VARIABLE","$oldCustomersToLower",386],["T_WHITESPACE"," ",386],"=",["T_WHITESPACE"," ",386],["T_STRING","array_change_key_case",386],"(",["T_VARIABLE","$this",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","_oldCustomers",386],",",["T_WHITESPACE"," ",386],["T_STRING","CASE_LOWER",386],")",";",["T_WHITESPACE","\n\n            ",386],["T_FOREACH","foreach",388],["T_WHITESPACE"," ",388],"(",["T_VARIABLE","$bunch",388],["T_WHITESPACE"," ",388],["T_AS","as",388],["T_WHITESPACE"," ",388],["T_VARIABLE","$rowNum",388],["T_WHITESPACE"," ",388],["T_DOUBLE_ARROW","=>",388],["T_WHITESPACE"," ",388],["T_VARIABLE","$rowData",388],")",["T_WHITESPACE"," ",388],"{",["T_WHITESPACE","\n                ",388],["T_IF","if",389],["T_WHITESPACE"," ",389],"(","!",["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","validateRow",389],"(",["T_VARIABLE","$rowData",389],",",["T_WHITESPACE"," ",389],["T_VARIABLE","$rowNum",389],")",")",["T_WHITESPACE"," ",389],"{",["T_WHITESPACE","\n                    ",389],["T_CONTINUE","continue",390],";",["T_WHITESPACE","\n                ",390],"}",["T_WHITESPACE","\n                ",391],["T_IF","if",392],["T_WHITESPACE"," ",392],"(",["T_STRING","self",392],["T_DOUBLE_COLON","::",392],["T_STRING","SCOPE_DEFAULT",392],["T_WHITESPACE"," ",392],["T_IS_EQUAL","==",392],["T_WHITESPACE"," ",392],["T_VARIABLE","$this",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","getRowScope",392],"(",["T_VARIABLE","$rowData",392],")",")",["T_WHITESPACE"," ",392],"{",["T_WHITESPACE","\n                    ",392],["T_COMMENT","\/\/ entity table data\n",393],["T_WHITESPACE","                    ",394],["T_VARIABLE","$entityRow",394],["T_WHITESPACE"," ",394],"=",["T_WHITESPACE"," ",394],["T_ARRAY","array",394],"(",["T_WHITESPACE","\n                        ",394],["T_CONSTANT_ENCAPSED_STRING","'group_id'",395],["T_WHITESPACE","   ",395],["T_DOUBLE_ARROW","=>",395],["T_WHITESPACE"," ",395],["T_EMPTY","empty",395],"(",["T_VARIABLE","$rowData",395],"[",["T_CONSTANT_ENCAPSED_STRING","'group_id'",395],"]",")",["T_WHITESPACE"," ",395],"?",["T_WHITESPACE"," ",395],["T_STRING","self",395],["T_DOUBLE_COLON","::",395],["T_STRING","DEFAULT_GROUP_ID",395],["T_WHITESPACE"," ",395],":",["T_WHITESPACE"," ",395],["T_VARIABLE","$rowData",395],"[",["T_CONSTANT_ENCAPSED_STRING","'group_id'",395],"]",",",["T_WHITESPACE","\n                        ",395],["T_CONSTANT_ENCAPSED_STRING","'store_id'",396],["T_WHITESPACE","   ",396],["T_DOUBLE_ARROW","=>",396],["T_WHITESPACE"," ",396],["T_EMPTY","empty",396],"(",["T_VARIABLE","$rowData",396],"[",["T_STRING","self",396],["T_DOUBLE_COLON","::",396],["T_STRING","COL_STORE",396],"]",")",["T_WHITESPACE","\n                                        ",396],"?",["T_WHITESPACE"," ",397],["T_LNUMBER","0",397],["T_WHITESPACE"," ",397],":",["T_WHITESPACE"," ",397],["T_VARIABLE","$this",397],["T_OBJECT_OPERATOR","->",397],["T_STRING","_storeCodeToId",397],"[",["T_VARIABLE","$rowData",397],"[",["T_STRING","self",397],["T_DOUBLE_COLON","::",397],["T_STRING","COL_STORE",397],"]","]",",",["T_WHITESPACE","\n                        ",397],["T_CONSTANT_ENCAPSED_STRING","'created_at'",398],["T_WHITESPACE"," ",398],["T_DOUBLE_ARROW","=>",398],["T_WHITESPACE"," ",398],["T_EMPTY","empty",398],"(",["T_VARIABLE","$rowData",398],"[",["T_CONSTANT_ENCAPSED_STRING","'created_at'",398],"]",")",["T_WHITESPACE","\n                                        ",398],"?",["T_WHITESPACE"," ",399],["T_STRING","now",399],"(",")",["T_WHITESPACE"," ",399],":",["T_WHITESPACE"," ",399],["T_STRING","gmstrftime",399],"(",["T_VARIABLE","$strftimeFormat",399],",",["T_WHITESPACE"," ",399],["T_STRING","strtotime",399],"(",["T_VARIABLE","$rowData",399],"[",["T_CONSTANT_ENCAPSED_STRING","'created_at'",399],"]",")",")",",",["T_WHITESPACE","\n                        ",399],["T_CONSTANT_ENCAPSED_STRING","'updated_at'",400],["T_WHITESPACE"," ",400],["T_DOUBLE_ARROW","=>",400],["T_WHITESPACE"," ",400],["T_STRING","now",400],"(",")",["T_WHITESPACE","\n                    ",400],")",";",["T_WHITESPACE","\n\n                    ",401],["T_VARIABLE","$emailToLower",403],["T_WHITESPACE"," ",403],"=",["T_WHITESPACE"," ",403],["T_STRING","strtolower",403],"(",["T_VARIABLE","$rowData",403],"[",["T_STRING","self",403],["T_DOUBLE_COLON","::",403],["T_STRING","COL_EMAIL",403],"]",")",";",["T_WHITESPACE","\n                    ",403],["T_IF","if",404],["T_WHITESPACE"," ",404],"(",["T_ISSET","isset",404],"(",["T_VARIABLE","$oldCustomersToLower",404],"[",["T_VARIABLE","$emailToLower",404],"]","[",["T_VARIABLE","$rowData",404],"[",["T_STRING","self",404],["T_DOUBLE_COLON","::",404],["T_STRING","COL_WEBSITE",404],"]","]",")",")",["T_WHITESPACE"," ",404],"{",["T_WHITESPACE"," ",404],["T_COMMENT","\/\/ edit\n",404],["T_WHITESPACE","                        ",405],["T_VARIABLE","$entityId",405],["T_WHITESPACE"," ",405],"=",["T_WHITESPACE"," ",405],["T_VARIABLE","$oldCustomersToLower",405],"[",["T_VARIABLE","$emailToLower",405],"]","[",["T_VARIABLE","$rowData",405],"[",["T_STRING","self",405],["T_DOUBLE_COLON","::",405],["T_STRING","COL_WEBSITE",405],"]","]",";",["T_WHITESPACE","\n                        ",405],["T_VARIABLE","$entityRow",406],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",406],"]",["T_WHITESPACE"," ",406],"=",["T_WHITESPACE"," ",406],["T_VARIABLE","$entityId",406],";",["T_WHITESPACE","\n                        ",406],["T_VARIABLE","$entityRowsUp",407],"[","]",["T_WHITESPACE"," ",407],"=",["T_WHITESPACE"," ",407],["T_VARIABLE","$entityRow",407],";",["T_WHITESPACE","\n                    ",407],"}",["T_WHITESPACE"," ",408],["T_ELSE","else",408],["T_WHITESPACE"," ",408],"{",["T_WHITESPACE"," ",408],["T_COMMENT","\/\/ create\n",408],["T_WHITESPACE","                        ",409],["T_VARIABLE","$entityId",409],["T_WHITESPACE","                      ",409],"=",["T_WHITESPACE"," ",409],["T_VARIABLE","$nextEntityId",409],["T_INC","++",409],";",["T_WHITESPACE","\n                        ",409],["T_VARIABLE","$entityRow",410],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",410],"]",["T_WHITESPACE","        ",410],"=",["T_WHITESPACE"," ",410],["T_VARIABLE","$entityId",410],";",["T_WHITESPACE","\n                        ",410],["T_VARIABLE","$entityRow",411],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_type_id'",411],"]",["T_WHITESPACE","   ",411],"=",["T_WHITESPACE"," ",411],["T_VARIABLE","$this",411],["T_OBJECT_OPERATOR","->",411],["T_STRING","_entityTypeId",411],";",["T_WHITESPACE","\n                        ",411],["T_VARIABLE","$entityRow",412],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_set_id'",412],"]",["T_WHITESPACE"," ",412],"=",["T_WHITESPACE"," ",412],["T_LNUMBER","0",412],";",["T_WHITESPACE","\n                        ",412],["T_VARIABLE","$entityRow",413],"[",["T_CONSTANT_ENCAPSED_STRING","'website_id'",413],"]",["T_WHITESPACE","       ",413],"=",["T_WHITESPACE"," ",413],["T_VARIABLE","$this",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","_websiteCodeToId",413],"[",["T_VARIABLE","$rowData",413],"[",["T_STRING","self",413],["T_DOUBLE_COLON","::",413],["T_STRING","COL_WEBSITE",413],"]","]",";",["T_WHITESPACE","\n                        ",413],["T_VARIABLE","$entityRow",414],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",414],"]",["T_WHITESPACE","            ",414],"=",["T_WHITESPACE"," ",414],["T_VARIABLE","$rowData",414],"[",["T_STRING","self",414],["T_DOUBLE_COLON","::",414],["T_STRING","COL_EMAIL",414],"]",";",["T_WHITESPACE","\n                        ",414],["T_VARIABLE","$entityRow",415],"[",["T_CONSTANT_ENCAPSED_STRING","'is_active'",415],"]",["T_WHITESPACE","        ",415],"=",["T_WHITESPACE"," ",415],["T_LNUMBER","1",415],";",["T_WHITESPACE","\n                        ",415],["T_VARIABLE","$entityRowsIn",416],"[","]",["T_WHITESPACE","                ",416],"=",["T_WHITESPACE"," ",416],["T_VARIABLE","$entityRow",416],";",["T_WHITESPACE","\n\n                        ",416],["T_VARIABLE","$this",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","_newCustomers",418],"[",["T_VARIABLE","$rowData",418],"[",["T_STRING","self",418],["T_DOUBLE_COLON","::",418],["T_STRING","COL_EMAIL",418],"]","]","[",["T_VARIABLE","$rowData",418],"[",["T_STRING","self",418],["T_DOUBLE_COLON","::",418],["T_STRING","COL_WEBSITE",418],"]","]",["T_WHITESPACE"," ",418],"=",["T_WHITESPACE"," ",418],["T_VARIABLE","$entityId",418],";",["T_WHITESPACE","\n                    ",418],"}",["T_WHITESPACE","\n                    ",419],["T_COMMENT","\/\/ attribute values\n",420],["T_WHITESPACE","                    ",421],["T_FOREACH","foreach",421],["T_WHITESPACE"," ",421],"(",["T_STRING","array_intersect_key",421],"(",["T_VARIABLE","$rowData",421],",",["T_WHITESPACE"," ",421],["T_VARIABLE","$this",421],["T_OBJECT_OPERATOR","->",421],["T_STRING","_attributes",421],")",["T_WHITESPACE"," ",421],["T_AS","as",421],["T_WHITESPACE"," ",421],["T_VARIABLE","$attrCode",421],["T_WHITESPACE"," ",421],["T_DOUBLE_ARROW","=>",421],["T_WHITESPACE"," ",421],["T_VARIABLE","$value",421],")",["T_WHITESPACE"," ",421],"{",["T_WHITESPACE","\n                        ",421],["T_IF","if",422],["T_WHITESPACE"," ",422],"(","!",["T_VARIABLE","$this",422],["T_OBJECT_OPERATOR","->",422],["T_STRING","_attributes",422],"[",["T_VARIABLE","$attrCode",422],"]","[",["T_CONSTANT_ENCAPSED_STRING","'is_static'",422],"]",["T_WHITESPACE"," ",422],["T_BOOLEAN_AND","&&",422],["T_WHITESPACE"," ",422],["T_STRING","strlen",422],"(",["T_VARIABLE","$value",422],")",")",["T_WHITESPACE"," ",422],"{",["T_WHITESPACE","\n                            ",422],["T_DOC_COMMENT","\/** @var $attribute Mage_Customer_Model_Attribute *\/",423],["T_WHITESPACE","\n                            ",423],["T_VARIABLE","$attribute",424],["T_WHITESPACE","  ",424],"=",["T_WHITESPACE"," ",424],["T_VARIABLE","$resource",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","getAttribute",424],"(",["T_VARIABLE","$attrCode",424],")",";",["T_WHITESPACE","\n                            ",424],["T_VARIABLE","$backModel",425],["T_WHITESPACE","  ",425],"=",["T_WHITESPACE"," ",425],["T_VARIABLE","$attribute",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","getBackendModel",425],"(",")",";",["T_WHITESPACE","\n                            ",425],["T_VARIABLE","$attrParams",426],["T_WHITESPACE"," ",426],"=",["T_WHITESPACE"," ",426],["T_VARIABLE","$this",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","_attributes",426],"[",["T_VARIABLE","$attrCode",426],"]",";",["T_WHITESPACE","\n\n                            ",426],["T_IF","if",428],["T_WHITESPACE"," ",428],"(",["T_CONSTANT_ENCAPSED_STRING","'select'",428],["T_WHITESPACE"," ",428],["T_IS_EQUAL","==",428],["T_WHITESPACE"," ",428],["T_VARIABLE","$attrParams",428],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",428],"]",")",["T_WHITESPACE"," ",428],"{",["T_WHITESPACE","\n                                ",428],["T_VARIABLE","$value",429],["T_WHITESPACE"," ",429],"=",["T_WHITESPACE"," ",429],["T_VARIABLE","$attrParams",429],"[",["T_CONSTANT_ENCAPSED_STRING","'options'",429],"]","[",["T_STRING","strtolower",429],"(",["T_VARIABLE","$value",429],")","]",";",["T_WHITESPACE","\n                            ",429],"}",["T_WHITESPACE"," ",430],["T_ELSEIF","elseif",430],["T_WHITESPACE"," ",430],"(",["T_CONSTANT_ENCAPSED_STRING","'datetime'",430],["T_WHITESPACE"," ",430],["T_IS_EQUAL","==",430],["T_WHITESPACE"," ",430],["T_VARIABLE","$attrParams",430],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",430],"]",")",["T_WHITESPACE"," ",430],"{",["T_WHITESPACE","\n                                ",430],["T_VARIABLE","$value",431],["T_WHITESPACE"," ",431],"=",["T_WHITESPACE"," ",431],["T_STRING","gmstrftime",431],"(",["T_VARIABLE","$strftimeFormat",431],",",["T_WHITESPACE"," ",431],["T_STRING","strtotime",431],"(",["T_VARIABLE","$value",431],")",")",";",["T_WHITESPACE","\n                            ",431],"}",["T_WHITESPACE"," ",432],["T_ELSEIF","elseif",432],["T_WHITESPACE"," ",432],"(",["T_CONSTANT_ENCAPSED_STRING","'multiselect'",432],["T_WHITESPACE"," ",432],["T_IS_EQUAL","==",432],["T_WHITESPACE"," ",432],["T_VARIABLE","$attrParams",432],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",432],"]",")",["T_WHITESPACE"," ",432],"{",["T_WHITESPACE","\n                                ",432],["T_VARIABLE","$value",433],["T_WHITESPACE"," ",433],"=",["T_WHITESPACE"," ",433],["T_ARRAY_CAST","(array)",433],["T_VARIABLE","$attrParams",433],"[",["T_CONSTANT_ENCAPSED_STRING","'options'",433],"]","[",["T_STRING","strtolower",433],"(",["T_VARIABLE","$value",433],")","]",";",["T_WHITESPACE","\n                                ",433],["T_VARIABLE","$attribute",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","getBackend",434],"(",")",["T_OBJECT_OPERATOR","->",434],["T_STRING","beforeSave",434],"(",["T_VARIABLE","$resource",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","setData",434],"(",["T_VARIABLE","$attrCode",434],",",["T_WHITESPACE"," ",434],["T_VARIABLE","$value",434],")",")",";",["T_WHITESPACE","\n                                ",434],["T_VARIABLE","$value",435],["T_WHITESPACE"," ",435],"=",["T_WHITESPACE"," ",435],["T_VARIABLE","$resource",435],["T_OBJECT_OPERATOR","->",435],["T_STRING","getData",435],"(",["T_VARIABLE","$attrCode",435],")",";",["T_WHITESPACE","\n                                ",435],["T_VARIABLE","$multiSelect",436],"[",["T_VARIABLE","$entityId",436],"]","[","]",["T_WHITESPACE"," ",436],"=",["T_WHITESPACE"," ",436],["T_VARIABLE","$value",436],";",["T_WHITESPACE","\n                            ",436],"}",["T_WHITESPACE"," ",437],["T_ELSEIF","elseif",437],["T_WHITESPACE"," ",437],"(",["T_VARIABLE","$backModel",437],")",["T_WHITESPACE"," ",437],"{",["T_WHITESPACE","\n                                ",437],["T_VARIABLE","$attribute",438],["T_OBJECT_OPERATOR","->",438],["T_STRING","getBackend",438],"(",")",["T_OBJECT_OPERATOR","->",438],["T_STRING","beforeSave",438],"(",["T_VARIABLE","$resource",438],["T_OBJECT_OPERATOR","->",438],["T_STRING","setData",438],"(",["T_VARIABLE","$attrCode",438],",",["T_WHITESPACE"," ",438],["T_VARIABLE","$value",438],")",")",";",["T_WHITESPACE","\n                                ",438],["T_VARIABLE","$value",439],["T_WHITESPACE"," ",439],"=",["T_WHITESPACE"," ",439],["T_VARIABLE","$resource",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","getData",439],"(",["T_VARIABLE","$attrCode",439],")",";",["T_WHITESPACE","\n                            ",439],"}",["T_WHITESPACE","\n                            ",440],["T_VARIABLE","$attributes",441],"[",["T_VARIABLE","$attribute",441],["T_OBJECT_OPERATOR","->",441],["T_STRING","getBackend",441],"(",")",["T_OBJECT_OPERATOR","->",441],["T_STRING","getTable",441],"(",")","]","[",["T_VARIABLE","$entityId",441],"]","[",["T_VARIABLE","$attrParams",441],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",441],"]","]",["T_WHITESPACE"," ",441],"=",["T_WHITESPACE"," ",441],["T_VARIABLE","$value",441],";",["T_WHITESPACE","\n\n                            ",441],["T_COMMENT","\/\/ restore 'backend_model' to avoid default setting\n",443],["T_WHITESPACE","                            ",444],["T_VARIABLE","$attribute",444],["T_OBJECT_OPERATOR","->",444],["T_STRING","setBackendModel",444],"(",["T_VARIABLE","$backModel",444],")",";",["T_WHITESPACE","\n                        ",444],"}",["T_WHITESPACE","\n                    ",445],"}",["T_WHITESPACE","\n                    ",446],["T_COMMENT","\/\/ password change\/set\n",447],["T_WHITESPACE","                    ",448],["T_IF","if",448],["T_WHITESPACE"," ",448],"(",["T_ISSET","isset",448],"(",["T_VARIABLE","$rowData",448],"[",["T_CONSTANT_ENCAPSED_STRING","'password'",448],"]",")",["T_WHITESPACE"," ",448],["T_BOOLEAN_AND","&&",448],["T_WHITESPACE"," ",448],["T_STRING","strlen",448],"(",["T_VARIABLE","$rowData",448],"[",["T_CONSTANT_ENCAPSED_STRING","'password'",448],"]",")",")",["T_WHITESPACE"," ",448],"{",["T_WHITESPACE","\n                        ",448],["T_VARIABLE","$attributes",449],"[",["T_VARIABLE","$passTable",449],"]","[",["T_VARIABLE","$entityId",449],"]","[",["T_VARIABLE","$passId",449],"]",["T_WHITESPACE"," ",449],"=",["T_WHITESPACE"," ",449],["T_VARIABLE","$resource",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","hashPassword",449],"(",["T_VARIABLE","$rowData",449],"[",["T_CONSTANT_ENCAPSED_STRING","'password'",449],"]",")",";",["T_WHITESPACE","\n                    ",449],"}",["T_WHITESPACE","\n                ",450],"}",["T_WHITESPACE"," ",451],["T_ELSEIF","elseif",451],["T_WHITESPACE"," ",451],"(",["T_STRING","self",451],["T_DOUBLE_COLON","::",451],["T_STRING","SCOPE_OPTIONS",451],["T_WHITESPACE"," ",451],["T_IS_EQUAL","==",451],["T_WHITESPACE"," ",451],["T_VARIABLE","$this",451],["T_OBJECT_OPERATOR","->",451],["T_STRING","getRowScope",451],"(",["T_VARIABLE","$rowData",451],")",")",["T_WHITESPACE"," ",451],"{",["T_WHITESPACE","\n                    ",451],["T_FOREACH","foreach",452],["T_WHITESPACE"," ",452],"(",["T_STRING","array_intersect_key",452],"(",["T_VARIABLE","$rowData",452],",",["T_WHITESPACE"," ",452],["T_VARIABLE","$this",452],["T_OBJECT_OPERATOR","->",452],["T_STRING","_attributes",452],")",["T_WHITESPACE"," ",452],["T_AS","as",452],["T_WHITESPACE"," ",452],["T_VARIABLE","$attrCode",452],["T_WHITESPACE"," ",452],["T_DOUBLE_ARROW","=>",452],["T_WHITESPACE"," ",452],["T_VARIABLE","$value",452],")",["T_WHITESPACE"," ",452],"{",["T_WHITESPACE","\n                        ",452],["T_VARIABLE","$attribute",453],["T_WHITESPACE","  ",453],"=",["T_WHITESPACE"," ",453],["T_VARIABLE","$resource",453],["T_OBJECT_OPERATOR","->",453],["T_STRING","getAttribute",453],"(",["T_VARIABLE","$attrCode",453],")",";",["T_WHITESPACE","\n                        ",453],["T_VARIABLE","$attrParams",454],["T_WHITESPACE"," ",454],"=",["T_WHITESPACE"," ",454],["T_VARIABLE","$this",454],["T_OBJECT_OPERATOR","->",454],["T_STRING","_attributes",454],"[",["T_VARIABLE","$attrCode",454],"]",";",["T_WHITESPACE","\n                        ",454],["T_IF","if",455],["T_WHITESPACE"," ",455],"(",["T_VARIABLE","$attrParams",455],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",455],"]",["T_WHITESPACE"," ",455],["T_IS_EQUAL","==",455],["T_WHITESPACE"," ",455],["T_CONSTANT_ENCAPSED_STRING","'multiselect'",455],")",["T_WHITESPACE"," ",455],"{",["T_WHITESPACE","\n                            ",455],["T_IF","if",456],["T_WHITESPACE"," ",456],"(","!",["T_ISSET","isset",456],"(",["T_VARIABLE","$attrParams",456],"[",["T_CONSTANT_ENCAPSED_STRING","'options'",456],"]","[",["T_STRING","strtolower",456],"(",["T_VARIABLE","$value",456],")","]",")",")",["T_WHITESPACE"," ",456],"{",["T_WHITESPACE","\n                                ",456],["T_CONTINUE","continue",457],";",["T_WHITESPACE","\n                            ",457],"}",["T_WHITESPACE","\n                            ",458],["T_VARIABLE","$value",459],["T_WHITESPACE"," ",459],"=",["T_WHITESPACE"," ",459],["T_VARIABLE","$attrParams",459],"[",["T_CONSTANT_ENCAPSED_STRING","'options'",459],"]","[",["T_STRING","strtolower",459],"(",["T_VARIABLE","$value",459],")","]",";",["T_WHITESPACE","\n                            ",459],["T_IF","if",460],["T_WHITESPACE"," ",460],"(",["T_ISSET","isset",460],"(",["T_VARIABLE","$multiSelect",460],"[",["T_VARIABLE","$entityId",460],"]",")",")",["T_WHITESPACE"," ",460],"{",["T_WHITESPACE","\n                                ",460],["T_VARIABLE","$multiSelect",461],"[",["T_VARIABLE","$entityId",461],"]","[","]",["T_WHITESPACE"," ",461],"=",["T_WHITESPACE"," ",461],["T_VARIABLE","$value",461],";",["T_WHITESPACE","\n                                ",461],["T_VARIABLE","$value",462],["T_WHITESPACE"," ",462],"=",["T_WHITESPACE"," ",462],["T_VARIABLE","$multiSelect",462],"[",["T_VARIABLE","$entityId",462],"]",";",["T_WHITESPACE","\n                            ",462],"}",["T_WHITESPACE","\n                            ",463],["T_VARIABLE","$attribute",464],["T_OBJECT_OPERATOR","->",464],["T_STRING","getBackend",464],"(",")",["T_OBJECT_OPERATOR","->",464],["T_STRING","beforeSave",464],"(",["T_VARIABLE","$resource",464],["T_OBJECT_OPERATOR","->",464],["T_STRING","setData",464],"(",["T_VARIABLE","$attrCode",464],",",["T_WHITESPACE"," ",464],["T_VARIABLE","$value",464],")",")",";",["T_WHITESPACE","\n                            ",464],["T_VARIABLE","$value",465],["T_WHITESPACE"," ",465],"=",["T_WHITESPACE"," ",465],["T_VARIABLE","$resource",465],["T_OBJECT_OPERATOR","->",465],["T_STRING","getData",465],"(",["T_VARIABLE","$attrCode",465],")",";",["T_WHITESPACE","\n                            ",465],["T_VARIABLE","$attributes",466],"[",["T_VARIABLE","$attribute",466],["T_OBJECT_OPERATOR","->",466],["T_STRING","getBackend",466],"(",")",["T_OBJECT_OPERATOR","->",466],["T_STRING","getTable",466],"(",")","]","[",["T_VARIABLE","$entityId",466],"]","[",["T_VARIABLE","$attrParams",466],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",466],"]","]",["T_WHITESPACE"," ",466],"=",["T_WHITESPACE"," ",466],["T_VARIABLE","$value",466],";",["T_WHITESPACE","\n                        ",466],"}",["T_WHITESPACE","\n                    ",467],"}",["T_WHITESPACE","\n                ",468],"}",["T_WHITESPACE","\n            ",469],"}",["T_WHITESPACE","\n            ",470],["T_VARIABLE","$this",471],["T_OBJECT_OPERATOR","->",471],["T_STRING","_saveCustomerEntity",471],"(",["T_VARIABLE","$entityRowsIn",471],",",["T_WHITESPACE"," ",471],["T_VARIABLE","$entityRowsUp",471],")",["T_OBJECT_OPERATOR","->",471],["T_STRING","_saveCustomerAttributes",471],"(",["T_VARIABLE","$attributes",471],")",";",["T_WHITESPACE","\n        ",471],"}",["T_WHITESPACE","\n        ",472],["T_RETURN","return",473],["T_WHITESPACE"," ",473],["T_VARIABLE","$this",473],";",["T_WHITESPACE","\n    ",473],"}",["T_WHITESPACE","\n\n    ",474],["T_DOC_COMMENT","\/**\n     * Save customer attributes.\n     *\n     * @param array $attributesData\n     * @return Mage_ImportExport_Model_Import_Entity_Customer\n     *\/",476],["T_WHITESPACE","\n    ",481],["T_PROTECTED","protected",482],["T_WHITESPACE"," ",482],["T_FUNCTION","function",482],["T_WHITESPACE"," ",482],["T_STRING","_saveCustomerAttributes",482],"(",["T_ARRAY","array",482],["T_WHITESPACE"," ",482],["T_VARIABLE","$attributesData",482],")",["T_WHITESPACE","\n    ",482],"{",["T_WHITESPACE","\n        ",483],["T_FOREACH","foreach",484],["T_WHITESPACE"," ",484],"(",["T_VARIABLE","$attributesData",484],["T_WHITESPACE"," ",484],["T_AS","as",484],["T_WHITESPACE"," ",484],["T_VARIABLE","$tableName",484],["T_WHITESPACE"," ",484],["T_DOUBLE_ARROW","=>",484],["T_WHITESPACE"," ",484],["T_VARIABLE","$data",484],")",["T_WHITESPACE"," ",484],"{",["T_WHITESPACE","\n            ",484],["T_VARIABLE","$tableData",485],["T_WHITESPACE"," ",485],"=",["T_WHITESPACE"," ",485],["T_ARRAY","array",485],"(",")",";",["T_WHITESPACE","\n\n            ",485],["T_FOREACH","foreach",487],["T_WHITESPACE"," ",487],"(",["T_VARIABLE","$data",487],["T_WHITESPACE"," ",487],["T_AS","as",487],["T_WHITESPACE"," ",487],["T_VARIABLE","$customerId",487],["T_WHITESPACE"," ",487],["T_DOUBLE_ARROW","=>",487],["T_WHITESPACE"," ",487],["T_VARIABLE","$attrData",487],")",["T_WHITESPACE"," ",487],"{",["T_WHITESPACE","\n                ",487],["T_FOREACH","foreach",488],["T_WHITESPACE"," ",488],"(",["T_VARIABLE","$attrData",488],["T_WHITESPACE"," ",488],["T_AS","as",488],["T_WHITESPACE"," ",488],["T_VARIABLE","$attributeId",488],["T_WHITESPACE"," ",488],["T_DOUBLE_ARROW","=>",488],["T_WHITESPACE"," ",488],["T_VARIABLE","$value",488],")",["T_WHITESPACE"," ",488],"{",["T_WHITESPACE","\n                    ",488],["T_VARIABLE","$tableData",489],"[","]",["T_WHITESPACE"," ",489],"=",["T_WHITESPACE"," ",489],["T_ARRAY","array",489],"(",["T_WHITESPACE","\n                        ",489],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",490],["T_WHITESPACE","      ",490],["T_DOUBLE_ARROW","=>",490],["T_WHITESPACE"," ",490],["T_VARIABLE","$customerId",490],",",["T_WHITESPACE","\n                        ",490],["T_CONSTANT_ENCAPSED_STRING","'entity_type_id'",491],["T_WHITESPACE"," ",491],["T_DOUBLE_ARROW","=>",491],["T_WHITESPACE"," ",491],["T_VARIABLE","$this",491],["T_OBJECT_OPERATOR","->",491],["T_STRING","_entityTypeId",491],",",["T_WHITESPACE","\n                        ",491],["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",492],["T_WHITESPACE","   ",492],["T_DOUBLE_ARROW","=>",492],["T_WHITESPACE"," ",492],["T_VARIABLE","$attributeId",492],",",["T_WHITESPACE","\n                        ",492],["T_CONSTANT_ENCAPSED_STRING","'value'",493],["T_WHITESPACE","          ",493],["T_DOUBLE_ARROW","=>",493],["T_WHITESPACE"," ",493],["T_VARIABLE","$value",493],["T_WHITESPACE","\n                    ",493],")",";",["T_WHITESPACE","\n                ",494],"}",["T_WHITESPACE","\n            ",495],"}",["T_WHITESPACE","\n            ",496],["T_VARIABLE","$this",497],["T_OBJECT_OPERATOR","->",497],["T_STRING","_connection",497],["T_OBJECT_OPERATOR","->",497],["T_STRING","insertOnDuplicate",497],"(",["T_VARIABLE","$tableName",497],",",["T_WHITESPACE"," ",497],["T_VARIABLE","$tableData",497],",",["T_WHITESPACE"," ",497],["T_ARRAY","array",497],"(",["T_CONSTANT_ENCAPSED_STRING","'value'",497],")",")",";",["T_WHITESPACE","\n        ",497],"}",["T_WHITESPACE","\n        ",498],["T_RETURN","return",499],["T_WHITESPACE"," ",499],["T_VARIABLE","$this",499],";",["T_WHITESPACE","\n    ",499],"}",["T_WHITESPACE","\n\n    ",500],["T_DOC_COMMENT","\/**\n     * Update and insert data in entity table.\n     *\n     * @param array $entityRowsIn Row for insert\n     * @param array $entityRowsUp Row for update\n     * @return Mage_ImportExport_Model_Import_Entity_Customer\n     *\/",502],["T_WHITESPACE","\n    ",508],["T_PROTECTED","protected",509],["T_WHITESPACE"," ",509],["T_FUNCTION","function",509],["T_WHITESPACE"," ",509],["T_STRING","_saveCustomerEntity",509],"(",["T_ARRAY","array",509],["T_WHITESPACE"," ",509],["T_VARIABLE","$entityRowsIn",509],",",["T_WHITESPACE"," ",509],["T_ARRAY","array",509],["T_WHITESPACE"," ",509],["T_VARIABLE","$entityRowsUp",509],")",["T_WHITESPACE","\n    ",509],"{",["T_WHITESPACE","\n        ",510],["T_IF","if",511],["T_WHITESPACE"," ",511],"(",["T_VARIABLE","$entityRowsIn",511],")",["T_WHITESPACE"," ",511],"{",["T_WHITESPACE","\n            ",511],["T_VARIABLE","$this",512],["T_OBJECT_OPERATOR","->",512],["T_STRING","_connection",512],["T_OBJECT_OPERATOR","->",512],["T_STRING","insertMultiple",512],"(",["T_VARIABLE","$this",512],["T_OBJECT_OPERATOR","->",512],["T_STRING","_entityTable",512],",",["T_WHITESPACE"," ",512],["T_VARIABLE","$entityRowsIn",512],")",";",["T_WHITESPACE","\n        ",512],"}",["T_WHITESPACE","\n        ",513],["T_IF","if",514],["T_WHITESPACE"," ",514],"(",["T_VARIABLE","$entityRowsUp",514],")",["T_WHITESPACE"," ",514],"{",["T_WHITESPACE","\n            ",514],["T_VARIABLE","$this",515],["T_OBJECT_OPERATOR","->",515],["T_STRING","_connection",515],["T_OBJECT_OPERATOR","->",515],["T_STRING","insertOnDuplicate",515],"(",["T_WHITESPACE","\n                ",515],["T_VARIABLE","$this",516],["T_OBJECT_OPERATOR","->",516],["T_STRING","_entityTable",516],",",["T_WHITESPACE","\n                ",516],["T_VARIABLE","$entityRowsUp",517],",",["T_WHITESPACE","\n                ",517],["T_ARRAY","array",518],"(",["T_CONSTANT_ENCAPSED_STRING","'group_id'",518],",",["T_WHITESPACE"," ",518],["T_CONSTANT_ENCAPSED_STRING","'store_id'",518],",",["T_WHITESPACE"," ",518],["T_CONSTANT_ENCAPSED_STRING","'updated_at'",518],",",["T_WHITESPACE"," ",518],["T_CONSTANT_ENCAPSED_STRING","'created_at'",518],")",["T_WHITESPACE","\n            ",518],")",";",["T_WHITESPACE","\n        ",519],"}",["T_WHITESPACE","\n        ",520],["T_RETURN","return",521],["T_WHITESPACE"," ",521],["T_VARIABLE","$this",521],";",["T_WHITESPACE","\n    ",521],"}",["T_WHITESPACE","\n\n    ",522],["T_DOC_COMMENT","\/**\n     * Get customer ID. Method tries to find ID from old and new customers. If it fails - it returns NULL.\n     *\n     * @param string $email\n     * @param string $websiteCode\n     * @return string|null\n     *\/",524],["T_WHITESPACE","\n    ",530],["T_PUBLIC","public",531],["T_WHITESPACE"," ",531],["T_FUNCTION","function",531],["T_WHITESPACE"," ",531],["T_STRING","getCustomerId",531],"(",["T_VARIABLE","$email",531],",",["T_WHITESPACE"," ",531],["T_VARIABLE","$websiteCode",531],")",["T_WHITESPACE","\n    ",531],"{",["T_WHITESPACE","\n        ",532],["T_IF","if",533],["T_WHITESPACE"," ",533],"(",["T_ISSET","isset",533],"(",["T_VARIABLE","$this",533],["T_OBJECT_OPERATOR","->",533],["T_STRING","_oldCustomers",533],"[",["T_VARIABLE","$email",533],"]","[",["T_VARIABLE","$websiteCode",533],"]",")",")",["T_WHITESPACE"," ",533],"{",["T_WHITESPACE","\n            ",533],["T_RETURN","return",534],["T_WHITESPACE"," ",534],["T_VARIABLE","$this",534],["T_OBJECT_OPERATOR","->",534],["T_STRING","_oldCustomers",534],"[",["T_VARIABLE","$email",534],"]","[",["T_VARIABLE","$websiteCode",534],"]",";",["T_WHITESPACE","\n        ",534],"}",["T_WHITESPACE"," ",535],["T_ELSEIF","elseif",535],["T_WHITESPACE"," ",535],"(",["T_ISSET","isset",535],"(",["T_VARIABLE","$this",535],["T_OBJECT_OPERATOR","->",535],["T_STRING","_newCustomers",535],"[",["T_VARIABLE","$email",535],"]","[",["T_VARIABLE","$websiteCode",535],"]",")",")",["T_WHITESPACE"," ",535],"{",["T_WHITESPACE","\n            ",535],["T_RETURN","return",536],["T_WHITESPACE"," ",536],["T_VARIABLE","$this",536],["T_OBJECT_OPERATOR","->",536],["T_STRING","_newCustomers",536],"[",["T_VARIABLE","$email",536],"]","[",["T_VARIABLE","$websiteCode",536],"]",";",["T_WHITESPACE","\n        ",536],"}",["T_WHITESPACE"," ",537],["T_ELSE","else",537],["T_WHITESPACE"," ",537],"{",["T_WHITESPACE","\n            ",537],["T_RETURN","return",538],["T_WHITESPACE"," ",538],["T_STRING","null",538],";",["T_WHITESPACE","\n        ",538],"}",["T_WHITESPACE","\n    ",539],"}",["T_WHITESPACE","\n\n    ",540],["T_DOC_COMMENT","\/**\n     * EAV entity type code getter.\n     *\n     * @abstract\n     * @return string\n     *\/",542],["T_WHITESPACE","\n    ",547],["T_PUBLIC","public",548],["T_WHITESPACE"," ",548],["T_FUNCTION","function",548],["T_WHITESPACE"," ",548],["T_STRING","getEntityTypeCode",548],"(",")",["T_WHITESPACE","\n    ",548],"{",["T_WHITESPACE","\n        ",549],["T_RETURN","return",550],["T_WHITESPACE"," ",550],["T_CONSTANT_ENCAPSED_STRING","'customer'",550],";",["T_WHITESPACE","\n    ",550],"}",["T_WHITESPACE","\n\n    ",551],["T_DOC_COMMENT","\/**\n     * Obtain scope of the row from row data.\n     *\n     * @param array $rowData\n     * @return int\n     *\/",553],["T_WHITESPACE","\n    ",558],["T_PUBLIC","public",559],["T_WHITESPACE"," ",559],["T_FUNCTION","function",559],["T_WHITESPACE"," ",559],["T_STRING","getRowScope",559],"(",["T_ARRAY","array",559],["T_WHITESPACE"," ",559],["T_VARIABLE","$rowData",559],")",["T_WHITESPACE","\n    ",559],"{",["T_WHITESPACE","\n        ",560],["T_VARIABLE","$foundOptions",561],["T_WHITESPACE"," ",561],"=",["T_WHITESPACE"," ",561],["T_STRING","false",561],";",["T_WHITESPACE","\n        ",561],["T_FOREACH","foreach",562],["T_WHITESPACE"," ",562],"(",["T_VARIABLE","$this",562],["T_OBJECT_OPERATOR","->",562],["T_STRING","_multiSelectAttributes",562],["T_WHITESPACE"," ",562],["T_AS","as",562],["T_WHITESPACE"," ",562],["T_VARIABLE","$attrCode",562],["T_WHITESPACE"," ",562],["T_DOUBLE_ARROW","=>",562],["T_WHITESPACE"," ",562],["T_VARIABLE","$attribute",562],")",["T_WHITESPACE"," ",562],"{",["T_WHITESPACE","\n            ",562],["T_IF","if",563],["T_WHITESPACE"," ",563],"(",["T_VARIABLE","$rowData",563],"[",["T_VARIABLE","$attrCode",563],"]",")",["T_WHITESPACE"," ",563],"{",["T_WHITESPACE","\n                ",563],["T_VARIABLE","$foundOptions",564],["T_WHITESPACE"," ",564],"=",["T_WHITESPACE"," ",564],["T_STRING","true",564],";",["T_WHITESPACE","\n            ",564],"}",["T_WHITESPACE","\n        ",565],"}",["T_WHITESPACE","\n\n        ",566],["T_VARIABLE","$scope",568],["T_WHITESPACE"," ",568],"=",["T_WHITESPACE"," ",568],["T_STRING","self",568],["T_DOUBLE_COLON","::",568],["T_STRING","SCOPE_OPTIONS",568],";",["T_WHITESPACE","\n        ",568],["T_IF","if",569],["T_WHITESPACE"," ",569],"(",["T_STRING","strlen",569],"(",["T_STRING","trim",569],"(",["T_VARIABLE","$rowData",569],"[",["T_STRING","self",569],["T_DOUBLE_COLON","::",569],["T_STRING","COL_EMAIL",569],"]",")",")",")",["T_WHITESPACE"," ",569],"{",["T_WHITESPACE","\n            ",569],["T_VARIABLE","$scope",570],["T_WHITESPACE"," ",570],"=",["T_WHITESPACE"," ",570],["T_STRING","self",570],["T_DOUBLE_COLON","::",570],["T_STRING","SCOPE_DEFAULT",570],";",["T_WHITESPACE","\n        ",570],"}",["T_WHITESPACE"," ",571],["T_ELSEIF","elseif",571],["T_WHITESPACE"," ",571],"(",["T_VARIABLE","$foundOptions",571],")",["T_WHITESPACE"," ",571],"{",["T_WHITESPACE","\n            ",571],["T_VARIABLE","$scope",572],["T_WHITESPACE"," ",572],"=",["T_WHITESPACE"," ",572],["T_STRING","self",572],["T_DOUBLE_COLON","::",572],["T_STRING","SCOPE_OPTIONS",572],";",["T_WHITESPACE","\n        ",572],"}",["T_WHITESPACE"," ",573],["T_ELSEIF","elseif",573],["T_WHITESPACE"," ",573],"(",["T_STRING","strlen",573],"(",["T_STRING","trim",573],"(",["T_VARIABLE","$rowData",573],"[",["T_STRING","self",573],["T_DOUBLE_COLON","::",573],["T_STRING","COL_POSTCODE",573],"]",")",")",")",["T_WHITESPACE"," ",573],"{",["T_WHITESPACE","\n            ",573],["T_VARIABLE","$scope",574],["T_WHITESPACE"," ",574],"=",["T_WHITESPACE"," ",574],["T_STRING","self",574],["T_DOUBLE_COLON","::",574],["T_STRING","SCOPE_ADDRESS",574],";",["T_WHITESPACE","\n        ",574],"}",["T_WHITESPACE","\n        ",575],["T_RETURN","return",576],["T_WHITESPACE"," ",576],["T_VARIABLE","$scope",576],";",["T_WHITESPACE","\n    ",576],"}",["T_WHITESPACE","\n\n    ",577],["T_DOC_COMMENT","\/**\n     * Is attribute contains particular data (not plain entity attribute).\n     *\n     * @param string $attrCode\n     * @return bool\n     *\/",579],["T_WHITESPACE","\n    ",584],["T_PUBLIC","public",585],["T_WHITESPACE"," ",585],["T_FUNCTION","function",585],["T_WHITESPACE"," ",585],["T_STRING","isAttributeParticular",585],"(",["T_VARIABLE","$attrCode",585],")",["T_WHITESPACE","\n    ",585],"{",["T_WHITESPACE","\n        ",586],["T_RETURN","return",587],["T_WHITESPACE"," ",587],["T_STRING","parent",587],["T_DOUBLE_COLON","::",587],["T_STRING","isAttributeParticular",587],"(",["T_VARIABLE","$attrCode",587],")",["T_WHITESPACE"," ",587],["T_BOOLEAN_OR","||",587],["T_WHITESPACE"," ",587],["T_VARIABLE","$this",587],["T_OBJECT_OPERATOR","->",587],["T_STRING","_addressEntity",587],["T_OBJECT_OPERATOR","->",587],["T_STRING","isAttributeParticular",587],"(",["T_VARIABLE","$attrCode",587],")",";",["T_WHITESPACE","\n    ",587],"}",["T_WHITESPACE","\n\n    ",588],["T_DOC_COMMENT","\/**\n     * Validate data row.\n     *\n     * @param array $rowData\n     * @param int $rowNum\n     * @return boolean\n     *\/",590],["T_WHITESPACE","\n    ",596],["T_PUBLIC","public",597],["T_WHITESPACE"," ",597],["T_FUNCTION","function",597],["T_WHITESPACE"," ",597],["T_STRING","validateRow",597],"(",["T_ARRAY","array",597],["T_WHITESPACE"," ",597],["T_VARIABLE","$rowData",597],",",["T_WHITESPACE"," ",597],["T_VARIABLE","$rowNum",597],")",["T_WHITESPACE","\n    ",597],"{",["T_WHITESPACE","\n        ",598],["T_STATIC","static",599],["T_WHITESPACE"," ",599],["T_VARIABLE","$email",599],["T_WHITESPACE","   ",599],"=",["T_WHITESPACE"," ",599],["T_STRING","null",599],";",["T_WHITESPACE"," ",599],["T_COMMENT","\/\/ e-mail is remembered through all customer rows\n",599],["T_WHITESPACE","        ",600],["T_STATIC","static",600],["T_WHITESPACE"," ",600],["T_VARIABLE","$website",600],["T_WHITESPACE"," ",600],"=",["T_WHITESPACE"," ",600],["T_STRING","null",600],";",["T_WHITESPACE"," ",600],["T_COMMENT","\/\/ website is remembered through all customer rows\n",600],["T_WHITESPACE","\n        ",601],["T_IF","if",602],["T_WHITESPACE"," ",602],"(",["T_ISSET","isset",602],"(",["T_VARIABLE","$this",602],["T_OBJECT_OPERATOR","->",602],["T_STRING","_validatedRows",602],"[",["T_VARIABLE","$rowNum",602],"]",")",")",["T_WHITESPACE"," ",602],"{",["T_WHITESPACE"," ",602],["T_COMMENT","\/\/ check that row is already validated\n",602],["T_WHITESPACE","            ",603],["T_RETURN","return",603],["T_WHITESPACE"," ",603],"!",["T_ISSET","isset",603],"(",["T_VARIABLE","$this",603],["T_OBJECT_OPERATOR","->",603],["T_STRING","_invalidRows",603],"[",["T_VARIABLE","$rowNum",603],"]",")",";",["T_WHITESPACE","\n        ",603],"}",["T_WHITESPACE","\n        ",604],["T_VARIABLE","$this",605],["T_OBJECT_OPERATOR","->",605],["T_STRING","_validatedRows",605],"[",["T_VARIABLE","$rowNum",605],"]",["T_WHITESPACE"," ",605],"=",["T_WHITESPACE"," ",605],["T_STRING","true",605],";",["T_WHITESPACE","\n\n        ",605],["T_VARIABLE","$rowScope",607],["T_WHITESPACE"," ",607],"=",["T_WHITESPACE"," ",607],["T_VARIABLE","$this",607],["T_OBJECT_OPERATOR","->",607],["T_STRING","getRowScope",607],"(",["T_VARIABLE","$rowData",607],")",";",["T_WHITESPACE","\n\n        ",607],["T_IF","if",609],["T_WHITESPACE"," ",609],"(",["T_STRING","self",609],["T_DOUBLE_COLON","::",609],["T_STRING","SCOPE_DEFAULT",609],["T_WHITESPACE"," ",609],["T_IS_EQUAL","==",609],["T_WHITESPACE"," ",609],["T_VARIABLE","$rowScope",609],")",["T_WHITESPACE"," ",609],"{",["T_WHITESPACE","\n            ",609],["T_VARIABLE","$this",610],["T_OBJECT_OPERATOR","->",610],["T_STRING","_processedEntitiesCount",610],["T_WHITESPACE"," ",610],["T_INC","++",610],";",["T_WHITESPACE","\n        ",610],"}",["T_WHITESPACE","\n\n\n        ",611],["T_VARIABLE","$email",614],["T_WHITESPACE","        ",614],"=",["T_WHITESPACE"," ",614],["T_VARIABLE","$rowData",614],"[",["T_STRING","self",614],["T_DOUBLE_COLON","::",614],["T_STRING","COL_EMAIL",614],"]",";",["T_WHITESPACE","\n        ",614],["T_VARIABLE","$emailToLower",615],["T_WHITESPACE"," ",615],"=",["T_WHITESPACE"," ",615],["T_STRING","strtolower",615],"(",["T_VARIABLE","$rowData",615],"[",["T_STRING","self",615],["T_DOUBLE_COLON","::",615],["T_STRING","COL_EMAIL",615],"]",")",";",["T_WHITESPACE","\n        ",615],["T_VARIABLE","$website",616],["T_WHITESPACE","      ",616],"=",["T_WHITESPACE"," ",616],["T_VARIABLE","$rowData",616],"[",["T_STRING","self",616],["T_DOUBLE_COLON","::",616],["T_STRING","COL_WEBSITE",616],"]",";",["T_WHITESPACE","\n\n        ",616],["T_VARIABLE","$oldCustomersToLower",618],["T_WHITESPACE"," ",618],"=",["T_WHITESPACE"," ",618],["T_STRING","array_change_key_case",618],"(",["T_VARIABLE","$this",618],["T_OBJECT_OPERATOR","->",618],["T_STRING","_oldCustomers",618],",",["T_WHITESPACE"," ",618],["T_STRING","CASE_LOWER",618],")",";",["T_WHITESPACE","\n        ",618],["T_VARIABLE","$newCustomersToLower",619],["T_WHITESPACE"," ",619],"=",["T_WHITESPACE"," ",619],["T_STRING","array_change_key_case",619],"(",["T_VARIABLE","$this",619],["T_OBJECT_OPERATOR","->",619],["T_STRING","_newCustomers",619],",",["T_WHITESPACE"," ",619],["T_STRING","CASE_LOWER",619],")",";",["T_WHITESPACE","\n\n        ",619],["T_COMMENT","\/\/ BEHAVIOR_DELETE use specific validation logic\n",621],["T_WHITESPACE","        ",622],["T_IF","if",622],["T_WHITESPACE"," ",622],"(",["T_STRING","Mage_ImportExport_Model_Import",622],["T_DOUBLE_COLON","::",622],["T_STRING","BEHAVIOR_DELETE",622],["T_WHITESPACE"," ",622],["T_IS_EQUAL","==",622],["T_WHITESPACE"," ",622],["T_VARIABLE","$this",622],["T_OBJECT_OPERATOR","->",622],["T_STRING","getBehavior",622],"(",")",")",["T_WHITESPACE"," ",622],"{",["T_WHITESPACE","\n            ",622],["T_IF","if",623],["T_WHITESPACE"," ",623],"(",["T_STRING","self",623],["T_DOUBLE_COLON","::",623],["T_STRING","SCOPE_DEFAULT",623],["T_WHITESPACE"," ",623],["T_IS_EQUAL","==",623],["T_WHITESPACE"," ",623],["T_VARIABLE","$rowScope",623],["T_WHITESPACE","\n                ",623],["T_BOOLEAN_AND","&&",624],["T_WHITESPACE"," ",624],"!",["T_ISSET","isset",624],"(",["T_VARIABLE","$oldCustomersToLower",624],"[",["T_VARIABLE","$emailToLower",624],"]","[",["T_VARIABLE","$website",624],"]",")",")",["T_WHITESPACE"," ",624],"{",["T_WHITESPACE","\n                ",624],["T_VARIABLE","$this",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","addRowError",625],"(",["T_STRING","self",625],["T_DOUBLE_COLON","::",625],["T_STRING","ERROR_EMAIL_SITE_NOT_FOUND",625],",",["T_WHITESPACE"," ",625],["T_VARIABLE","$rowNum",625],")",";",["T_WHITESPACE","\n            ",625],"}",["T_WHITESPACE","\n        ",626],"}",["T_WHITESPACE"," ",627],["T_ELSEIF","elseif",627],["T_WHITESPACE"," ",627],"(",["T_STRING","self",627],["T_DOUBLE_COLON","::",627],["T_STRING","SCOPE_DEFAULT",627],["T_WHITESPACE"," ",627],["T_IS_EQUAL","==",627],["T_WHITESPACE"," ",627],["T_VARIABLE","$rowScope",627],")",["T_WHITESPACE"," ",627],"{",["T_WHITESPACE"," ",627],["T_COMMENT","\/\/ row is SCOPE_DEFAULT = new customer block begins\n",627],["T_WHITESPACE","            ",628],["T_IF","if",628],["T_WHITESPACE"," ",628],"(","!",["T_STRING","Zend_Validate",628],["T_DOUBLE_COLON","::",628],["T_STRING","is",628],"(",["T_VARIABLE","$email",628],",",["T_WHITESPACE"," ",628],["T_CONSTANT_ENCAPSED_STRING","'EmailAddress'",628],")",")",["T_WHITESPACE"," ",628],"{",["T_WHITESPACE","\n                ",628],["T_VARIABLE","$this",629],["T_OBJECT_OPERATOR","->",629],["T_STRING","addRowError",629],"(",["T_STRING","self",629],["T_DOUBLE_COLON","::",629],["T_STRING","ERROR_INVALID_EMAIL",629],",",["T_WHITESPACE"," ",629],["T_VARIABLE","$rowNum",629],")",";",["T_WHITESPACE","\n            ",629],"}",["T_WHITESPACE"," ",630],["T_ELSEIF","elseif",630],["T_WHITESPACE"," ",630],"(","!",["T_ISSET","isset",630],"(",["T_VARIABLE","$this",630],["T_OBJECT_OPERATOR","->",630],["T_STRING","_websiteCodeToId",630],"[",["T_VARIABLE","$website",630],"]",")",")",["T_WHITESPACE"," ",630],"{",["T_WHITESPACE","\n                ",630],["T_VARIABLE","$this",631],["T_OBJECT_OPERATOR","->",631],["T_STRING","addRowError",631],"(",["T_STRING","self",631],["T_DOUBLE_COLON","::",631],["T_STRING","ERROR_INVALID_WEBSITE",631],",",["T_WHITESPACE"," ",631],["T_VARIABLE","$rowNum",631],")",";",["T_WHITESPACE","\n            ",631],"}",["T_WHITESPACE"," ",632],["T_ELSE","else",632],["T_WHITESPACE"," ",632],"{",["T_WHITESPACE","\n                ",632],["T_IF","if",633],["T_WHITESPACE"," ",633],"(",["T_ISSET","isset",633],"(",["T_VARIABLE","$newCustomersToLower",633],"[",["T_VARIABLE","$emailToLower",633],"]","[",["T_VARIABLE","$website",633],"]",")",")",["T_WHITESPACE"," ",633],"{",["T_WHITESPACE","\n                    ",633],["T_VARIABLE","$this",634],["T_OBJECT_OPERATOR","->",634],["T_STRING","addRowError",634],"(",["T_STRING","self",634],["T_DOUBLE_COLON","::",634],["T_STRING","ERROR_DUPLICATE_EMAIL_SITE",634],",",["T_WHITESPACE"," ",634],["T_VARIABLE","$rowNum",634],")",";",["T_WHITESPACE","\n                ",634],"}",["T_WHITESPACE","\n                ",635],["T_VARIABLE","$this",636],["T_OBJECT_OPERATOR","->",636],["T_STRING","_newCustomers",636],"[",["T_VARIABLE","$email",636],"]","[",["T_VARIABLE","$website",636],"]",["T_WHITESPACE"," ",636],"=",["T_WHITESPACE"," ",636],["T_STRING","false",636],";",["T_WHITESPACE","\n\n                ",636],["T_IF","if",638],["T_WHITESPACE"," ",638],"(","!",["T_EMPTY","empty",638],"(",["T_VARIABLE","$rowData",638],"[",["T_STRING","self",638],["T_DOUBLE_COLON","::",638],["T_STRING","COL_STORE",638],"]",")",["T_WHITESPACE"," ",638],["T_BOOLEAN_AND","&&",638],["T_WHITESPACE"," ",638],"!",["T_ISSET","isset",638],"(",["T_VARIABLE","$this",638],["T_OBJECT_OPERATOR","->",638],["T_STRING","_storeCodeToId",638],"[",["T_VARIABLE","$rowData",638],"[",["T_STRING","self",638],["T_DOUBLE_COLON","::",638],["T_STRING","COL_STORE",638],"]","]",")",")",["T_WHITESPACE"," ",638],"{",["T_WHITESPACE","\n                    ",638],["T_VARIABLE","$this",639],["T_OBJECT_OPERATOR","->",639],["T_STRING","addRowError",639],"(",["T_STRING","self",639],["T_DOUBLE_COLON","::",639],["T_STRING","ERROR_INVALID_STORE",639],",",["T_WHITESPACE"," ",639],["T_VARIABLE","$rowNum",639],")",";",["T_WHITESPACE","\n                ",639],"}",["T_WHITESPACE","\n                ",640],["T_COMMENT","\/\/ check password\n",641],["T_WHITESPACE","                ",642],["T_IF","if",642],["T_WHITESPACE"," ",642],"(",["T_ISSET","isset",642],"(",["T_VARIABLE","$rowData",642],"[",["T_CONSTANT_ENCAPSED_STRING","'password'",642],"]",")",["T_WHITESPACE"," ",642],["T_BOOLEAN_AND","&&",642],["T_WHITESPACE"," ",642],["T_STRING","strlen",642],"(",["T_VARIABLE","$rowData",642],"[",["T_CONSTANT_ENCAPSED_STRING","'password'",642],"]",")",["T_WHITESPACE","\n                    ",642],["T_BOOLEAN_AND","&&",643],["T_WHITESPACE"," ",643],["T_STRING","Mage",643],["T_DOUBLE_COLON","::",643],["T_STRING","helper",643],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/string'",643],")",["T_OBJECT_OPERATOR","->",643],["T_STRING","strlen",643],"(",["T_VARIABLE","$rowData",643],"[",["T_CONSTANT_ENCAPSED_STRING","'password'",643],"]",")",["T_WHITESPACE"," ",643],"<",["T_WHITESPACE"," ",643],["T_STRING","self",643],["T_DOUBLE_COLON","::",643],["T_STRING","MAX_PASSWD_LENGTH",643],["T_WHITESPACE","\n                ",643],")",["T_WHITESPACE"," ",644],"{",["T_WHITESPACE","\n                    ",644],["T_VARIABLE","$this",645],["T_OBJECT_OPERATOR","->",645],["T_STRING","addRowError",645],"(",["T_STRING","self",645],["T_DOUBLE_COLON","::",645],["T_STRING","ERROR_PASSWORD_LENGTH",645],",",["T_WHITESPACE"," ",645],["T_VARIABLE","$rowNum",645],")",";",["T_WHITESPACE","\n                ",645],"}",["T_WHITESPACE","\n                ",646],["T_COMMENT","\/\/ check simple attributes\n",647],["T_WHITESPACE","                ",648],["T_FOREACH","foreach",648],["T_WHITESPACE"," ",648],"(",["T_VARIABLE","$this",648],["T_OBJECT_OPERATOR","->",648],["T_STRING","_attributes",648],["T_WHITESPACE"," ",648],["T_AS","as",648],["T_WHITESPACE"," ",648],["T_VARIABLE","$attrCode",648],["T_WHITESPACE"," ",648],["T_DOUBLE_ARROW","=>",648],["T_WHITESPACE"," ",648],["T_VARIABLE","$attrParams",648],")",["T_WHITESPACE"," ",648],"{",["T_WHITESPACE","\n                    ",648],["T_IF","if",649],["T_WHITESPACE"," ",649],"(",["T_STRING","in_array",649],"(",["T_VARIABLE","$attrCode",649],",",["T_WHITESPACE"," ",649],["T_VARIABLE","$this",649],["T_OBJECT_OPERATOR","->",649],["T_STRING","_ignoredAttributes",649],")",")",["T_WHITESPACE"," ",649],"{",["T_WHITESPACE","\n                        ",649],["T_CONTINUE","continue",650],";",["T_WHITESPACE","\n                    ",650],"}",["T_WHITESPACE","\n                    ",651],["T_IF","if",652],["T_WHITESPACE"," ",652],"(",["T_ISSET","isset",652],"(",["T_VARIABLE","$rowData",652],"[",["T_VARIABLE","$attrCode",652],"]",")",["T_WHITESPACE"," ",652],["T_BOOLEAN_AND","&&",652],["T_WHITESPACE"," ",652],["T_STRING","strlen",652],"(",["T_VARIABLE","$rowData",652],"[",["T_VARIABLE","$attrCode",652],"]",")",")",["T_WHITESPACE"," ",652],"{",["T_WHITESPACE","\n                        ",652],["T_VARIABLE","$this",653],["T_OBJECT_OPERATOR","->",653],["T_STRING","isAttributeValid",653],"(",["T_VARIABLE","$attrCode",653],",",["T_WHITESPACE"," ",653],["T_VARIABLE","$attrParams",653],",",["T_WHITESPACE"," ",653],["T_VARIABLE","$rowData",653],",",["T_WHITESPACE"," ",653],["T_VARIABLE","$rowNum",653],")",";",["T_WHITESPACE","\n                    ",653],"}",["T_WHITESPACE"," ",654],["T_ELSEIF","elseif",654],["T_WHITESPACE"," ",654],"(",["T_VARIABLE","$attrParams",654],"[",["T_CONSTANT_ENCAPSED_STRING","'is_required'",654],"]",["T_WHITESPACE"," ",654],["T_BOOLEAN_AND","&&",654],["T_WHITESPACE"," ",654],"!",["T_ISSET","isset",654],"(",["T_VARIABLE","$oldCustomersToLower",654],"[",["T_VARIABLE","$emailToLower",654],"]","[",["T_VARIABLE","$website",654],"]",")",")",["T_WHITESPACE"," ",654],"{",["T_WHITESPACE","\n                        ",654],["T_VARIABLE","$this",655],["T_OBJECT_OPERATOR","->",655],["T_STRING","addRowError",655],"(",["T_STRING","self",655],["T_DOUBLE_COLON","::",655],["T_STRING","ERROR_VALUE_IS_REQUIRED",655],",",["T_WHITESPACE"," ",655],["T_VARIABLE","$rowNum",655],",",["T_WHITESPACE"," ",655],["T_VARIABLE","$attrCode",655],")",";",["T_WHITESPACE","\n                    ",655],"}",["T_WHITESPACE","\n                ",656],"}",["T_WHITESPACE","\n            ",657],"}",["T_WHITESPACE","\n            ",658],["T_IF","if",659],["T_WHITESPACE"," ",659],"(",["T_ISSET","isset",659],"(",["T_VARIABLE","$this",659],["T_OBJECT_OPERATOR","->",659],["T_STRING","_invalidRows",659],"[",["T_VARIABLE","$rowNum",659],"]",")",")",["T_WHITESPACE"," ",659],"{",["T_WHITESPACE","\n                ",659],["T_VARIABLE","$email",660],["T_WHITESPACE"," ",660],"=",["T_WHITESPACE"," ",660],["T_STRING","false",660],";",["T_WHITESPACE"," ",660],["T_COMMENT","\/\/ mark row as invalid for next address rows\n",660],["T_WHITESPACE","            ",661],"}",["T_WHITESPACE","\n        ",661],"}",["T_WHITESPACE"," ",662],["T_ELSEIF","elseif",662],["T_WHITESPACE"," ",662],"(",["T_STRING","self",662],["T_DOUBLE_COLON","::",662],["T_STRING","SCOPE_OPTIONS",662],["T_WHITESPACE"," ",662],["T_IS_NOT_EQUAL","!=",662],["T_WHITESPACE"," ",662],["T_VARIABLE","$rowScope",662],")",["T_WHITESPACE"," ",662],"{",["T_WHITESPACE","\n            ",662],["T_IF","if",663],["T_WHITESPACE"," ",663],"(",["T_STRING","null",663],["T_WHITESPACE"," ",663],["T_IS_IDENTICAL","===",663],["T_WHITESPACE"," ",663],["T_VARIABLE","$email",663],")",["T_WHITESPACE"," ",663],"{",["T_WHITESPACE"," ",663],["T_COMMENT","\/\/ first row is not SCOPE_DEFAULT\n",663],["T_WHITESPACE","                ",664],["T_VARIABLE","$this",664],["T_OBJECT_OPERATOR","->",664],["T_STRING","addRowError",664],"(",["T_STRING","self",664],["T_DOUBLE_COLON","::",664],["T_STRING","ERROR_EMAIL_IS_EMPTY",664],",",["T_WHITESPACE"," ",664],["T_VARIABLE","$rowNum",664],")",";",["T_WHITESPACE","\n            ",664],"}",["T_WHITESPACE"," ",665],["T_ELSEIF","elseif",665],["T_WHITESPACE"," ",665],"(",["T_STRING","false",665],["T_WHITESPACE"," ",665],["T_IS_IDENTICAL","===",665],["T_WHITESPACE"," ",665],["T_VARIABLE","$email",665],")",["T_WHITESPACE"," ",665],"{",["T_WHITESPACE"," ",665],["T_COMMENT","\/\/ SCOPE_DEFAULT row is invalid\n",665],["T_WHITESPACE","                ",666],["T_VARIABLE","$this",666],["T_OBJECT_OPERATOR","->",666],["T_STRING","addRowError",666],"(",["T_STRING","self",666],["T_DOUBLE_COLON","::",666],["T_STRING","ERROR_ROW_IS_ORPHAN",666],",",["T_WHITESPACE"," ",666],["T_VARIABLE","$rowNum",666],")",";",["T_WHITESPACE","\n            ",666],"}",["T_WHITESPACE","\n        ",667],"}",["T_WHITESPACE","\n\n        ",668],["T_IF","if",670],["T_WHITESPACE"," ",670],"(",["T_VARIABLE","$rowScope",670],["T_WHITESPACE"," ",670],["T_IS_NOT_EQUAL","!=",670],["T_WHITESPACE"," ",670],["T_STRING","self",670],["T_DOUBLE_COLON","::",670],["T_STRING","SCOPE_OPTIONS",670],")",["T_WHITESPACE"," ",670],"{",["T_WHITESPACE","\n            ",670],["T_VARIABLE","$this",671],["T_OBJECT_OPERATOR","->",671],["T_STRING","_addressEntity",671],["T_OBJECT_OPERATOR","->",671],["T_STRING","validateRow",671],"(",["T_VARIABLE","$rowData",671],",",["T_WHITESPACE"," ",671],["T_VARIABLE","$rowNum",671],")",";",["T_WHITESPACE","\n        ",671],"}",["T_WHITESPACE","\n\n        ",672],["T_RETURN","return",674],["T_WHITESPACE"," ",674],"!",["T_ISSET","isset",674],"(",["T_VARIABLE","$this",674],["T_OBJECT_OPERATOR","->",674],["T_STRING","_invalidRows",674],"[",["T_VARIABLE","$rowNum",674],"]",")",";",["T_WHITESPACE","\n    ",674],"}",["T_WHITESPACE","\n",675],"}",["T_WHITESPACE","\n",676]]