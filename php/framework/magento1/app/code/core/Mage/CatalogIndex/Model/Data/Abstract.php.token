[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_CatalogIndex\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * CatalogIndex Data Retreiver Abstract Model\n *\n * @category   Mage\n * @package    Mage_CatalogIndex\n * @author     Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_CatalogIndex_Model_Data_Abstract",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Model_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Product Type instance\n     *\n     * @var Mage_Catalog_Model_Product_Type_Abstract\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_typeInstance",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Defines when product type has children\n     *\n     * @var boolean\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_haveChildren",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_ARRAY","array",49],"(",["T_WHITESPACE","\n                        ",49],["T_STRING","Mage_CatalogIndex_Model_Retreiver",50],["T_DOUBLE_COLON","::",50],["T_STRING","CHILDREN_FOR_TIERS",50],["T_DOUBLE_ARROW","=>",50],["T_STRING","true",50],",",["T_WHITESPACE","\n                        ",50],["T_STRING","Mage_CatalogIndex_Model_Retreiver",51],["T_DOUBLE_COLON","::",51],["T_STRING","CHILDREN_FOR_PRICES",51],["T_DOUBLE_ARROW","=>",51],["T_STRING","true",51],",",["T_WHITESPACE","\n                        ",51],["T_STRING","Mage_CatalogIndex_Model_Retreiver",52],["T_DOUBLE_COLON","::",52],["T_STRING","CHILDREN_FOR_ATTRIBUTES",52],["T_DOUBLE_ARROW","=>",52],["T_STRING","true",52],",",["T_WHITESPACE","\n                        ",52],")",";",["T_WHITESPACE","\n\n    ",53],["T_DOC_COMMENT","\/**\n     * Defines when product type has parents\n     *\n     * @var boolean\n     *\/",55],["T_WHITESPACE","\n    ",59],["T_PROTECTED","protected",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$_haveParents",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_STRING","true",60],";",["T_WHITESPACE","\n\n    ",60],["T_CONST","const",62],["T_WHITESPACE"," ",62],["T_STRING","LINK_GET_CHILDREN",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_LNUMBER","1",62],";",["T_WHITESPACE","\n    ",62],["T_CONST","const",63],["T_WHITESPACE"," ",63],["T_STRING","LINK_GET_PARENTS",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_LNUMBER","1",63],";",["T_WHITESPACE","\n\n    ",63],["T_DOC_COMMENT","\/**\n     * Initialize abstract resource model\n     *\n     *\/",65],["T_WHITESPACE","\n    ",68],["T_PROTECTED","protected",69],["T_WHITESPACE"," ",69],["T_FUNCTION","function",69],["T_WHITESPACE"," ",69],["T_STRING","_construct",69],"(",")",["T_WHITESPACE","\n    ",69],"{",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","_init",71],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogindex\/data_abstract'",71],")",";",["T_WHITESPACE","\n    ",71],"}",["T_WHITESPACE","\n\n    ",72],["T_DOC_COMMENT","\/**\n     * Return all children ids\n     *\n     * @param Mage_Core_Model_Store $store\n     * @param int $parentId\n     * @return mixed\n     *\/",74],["T_WHITESPACE","\n    ",80],["T_PUBLIC","public",81],["T_WHITESPACE"," ",81],["T_FUNCTION","function",81],["T_WHITESPACE"," ",81],["T_STRING","getChildProductIds",81],"(",["T_VARIABLE","$store",81],",",["T_WHITESPACE"," ",81],["T_VARIABLE","$parentIds",81],")",["T_WHITESPACE","\n    ",81],"{",["T_WHITESPACE","\n        ",82],["T_IF","if",83],["T_WHITESPACE"," ",83],"(","!",["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","_haveChildren",83],")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n            ",83],["T_RETURN","return",84],["T_WHITESPACE"," ",84],["T_STRING","false",84],";",["T_WHITESPACE","\n        ",84],"}",["T_WHITESPACE","\n\n        ",85],["T_IF","if",87],["T_WHITESPACE"," ",87],"(","!",["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","_getLinkSettings",87],"(",")",")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n            ",87],["T_RETURN","return",88],["T_WHITESPACE"," ",88],["T_STRING","false",88],";",["T_WHITESPACE","\n        ",88],"}",["T_WHITESPACE","\n\n        ",89],["T_RETURN","return",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","fetchLinkInformation",91],"(",["T_VARIABLE","$store",91],",",["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","_getLinkSettings",91],"(",")",",",["T_WHITESPACE"," ",91],["T_STRING","self",91],["T_DOUBLE_COLON","::",91],["T_STRING","LINK_GET_CHILDREN",91],",",["T_WHITESPACE"," ",91],["T_VARIABLE","$parentIds",91],")",";",["T_WHITESPACE","\n    ",91],"}",["T_WHITESPACE","\n\n    ",92],["T_DOC_COMMENT","\/**\n     * Return all parent ids\n     *\n     * @param Mage_Core_Model_Store $store\n     * @param int $childId\n     * @return mixed\n     *\/",94],["T_WHITESPACE","\n    ",100],["T_PUBLIC","public",101],["T_WHITESPACE"," ",101],["T_FUNCTION","function",101],["T_WHITESPACE"," ",101],["T_STRING","getParentProductIds",101],"(",["T_VARIABLE","$store",101],",",["T_WHITESPACE"," ",101],["T_VARIABLE","$childIds",101],")",["T_WHITESPACE","\n    ",101],"{",["T_WHITESPACE","\n        ",102],["T_IF","if",103],["T_WHITESPACE"," ",103],"(","!",["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","_haveParents",103],")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n            ",103],["T_RETURN","return",104],["T_WHITESPACE"," ",104],["T_STRING","false",104],";",["T_WHITESPACE","\n        ",104],"}",["T_WHITESPACE","\n\n        ",105],["T_IF","if",107],["T_WHITESPACE"," ",107],"(","!",["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","_getLinkSettings",107],"(",")",")",["T_WHITESPACE"," ",107],"{",["T_WHITESPACE","\n            ",107],["T_RETURN","return",108],["T_WHITESPACE"," ",108],["T_STRING","false",108],";",["T_WHITESPACE","\n        ",108],"}",["T_WHITESPACE","\n\n        ",109],["T_RETURN","return",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","fetchLinkInformation",111],"(",["T_VARIABLE","$store",111],",",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","_getLinkSettings",111],"(",")",",",["T_WHITESPACE"," ",111],["T_STRING","self",111],["T_DOUBLE_COLON","::",111],["T_STRING","LINK_GET_PARENTS",111],",",["T_WHITESPACE"," ",111],["T_VARIABLE","$childIds",111],")",";",["T_WHITESPACE","\n    ",111],"}",["T_WHITESPACE","\n\n    ",112],["T_DOC_COMMENT","\/**\n     * Returns an array of product children\/parents\n     *\n     * @param Mage_Core_Model_Store $store\n     * @param array $settings\n     * @param int $type\n     * @param int $suppliedId\n     *\/",114],["T_WHITESPACE","\n    ",121],["T_PROTECTED","protected",122],["T_WHITESPACE"," ",122],["T_FUNCTION","function",122],["T_WHITESPACE"," ",122],["T_STRING","fetchLinkInformation",122],"(",["T_VARIABLE","$store",122],",",["T_WHITESPACE"," ",122],["T_VARIABLE","$settings",122],",",["T_WHITESPACE"," ",122],["T_VARIABLE","$type",122],",",["T_WHITESPACE"," ",122],["T_VARIABLE","$suppliedId",122],")",["T_WHITESPACE","\n    ",122],"{",["T_WHITESPACE","\n        ",123],["T_SWITCH","switch",124],["T_WHITESPACE"," ",124],"(",["T_VARIABLE","$type",124],")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n            ",124],["T_CASE","case",125],["T_WHITESPACE"," ",125],["T_STRING","self",125],["T_DOUBLE_COLON","::",125],["T_STRING","LINK_GET_CHILDREN",125],":",["T_WHITESPACE","\n                ",125],["T_VARIABLE","$whereField",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$settings",126],"[",["T_CONSTANT_ENCAPSED_STRING","'parent_field'",126],"]",";",["T_WHITESPACE","\n                ",126],["T_VARIABLE","$idField",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_VARIABLE","$settings",127],"[",["T_CONSTANT_ENCAPSED_STRING","'child_field'",127],"]",";",["T_WHITESPACE","\n                ",127],["T_BREAK","break",128],";",["T_WHITESPACE","\n\n            ",128],["T_CASE","case",130],["T_WHITESPACE"," ",130],["T_STRING","self",130],["T_DOUBLE_COLON","::",130],["T_STRING","LINK_GET_PARENTS",130],":",["T_WHITESPACE","\n                ",130],["T_VARIABLE","$idField",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_VARIABLE","$settings",131],"[",["T_CONSTANT_ENCAPSED_STRING","'parent_field'",131],"]",";",["T_WHITESPACE","\n                ",131],["T_VARIABLE","$whereField",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_VARIABLE","$settings",132],"[",["T_CONSTANT_ENCAPSED_STRING","'child_field'",132],"]",";",["T_WHITESPACE","\n                ",132],["T_BREAK","break",133],";",["T_WHITESPACE","\n        ",133],"}",["T_WHITESPACE","\n\n        ",134],["T_VARIABLE","$additional",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_ARRAY","array",136],"(",")",";",["T_WHITESPACE","\n        ",136],["T_IF","if",137],["T_WHITESPACE"," ",137],"(",["T_ISSET","isset",137],"(",["T_VARIABLE","$settings",137],"[",["T_CONSTANT_ENCAPSED_STRING","'additional'",137],"]",")",["T_WHITESPACE"," ",137],["T_BOOLEAN_AND","&&",137],["T_WHITESPACE"," ",137],["T_STRING","is_array",137],"(",["T_VARIABLE","$settings",137],"[",["T_CONSTANT_ENCAPSED_STRING","'additional'",137],"]",")",")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n            ",137],["T_VARIABLE","$additional",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_VARIABLE","$settings",138],"[",["T_CONSTANT_ENCAPSED_STRING","'additional'",138],"]",";",["T_WHITESPACE","\n        ",138],"}",["T_WHITESPACE","\n\n        ",139],["T_RETURN","return",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getResource",141],"(",")",["T_OBJECT_OPERATOR","->",141],["T_STRING","fetchLinkInformation",141],"(",["T_VARIABLE","$store",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getId",141],"(",")",",",["T_WHITESPACE"," ",141],["T_VARIABLE","$settings",141],"[",["T_CONSTANT_ENCAPSED_STRING","'table'",141],"]",",",["T_WHITESPACE"," ",141],["T_VARIABLE","$idField",141],",",["T_WHITESPACE"," ",141],["T_VARIABLE","$whereField",141],",",["T_WHITESPACE"," ",141],["T_VARIABLE","$suppliedId",141],",",["T_WHITESPACE"," ",141],["T_VARIABLE","$additional",141],")",";",["T_WHITESPACE","\n    ",141],"}",["T_WHITESPACE","\n\n    ",142],["T_DOC_COMMENT","\/**\n     * Fetch final price for product\n     *\n     * @param int $product\n     * @param Mage_Core_Model_Store $store\n     * @param Mage_Customer_Model_Group $group\n     * @return float\n     *\/",144],["T_WHITESPACE","\n    ",151],["T_PUBLIC","public",152],["T_WHITESPACE"," ",152],["T_FUNCTION","function",152],["T_WHITESPACE"," ",152],["T_STRING","getFinalPrice",152],"(",["T_VARIABLE","$product",152],",",["T_WHITESPACE"," ",152],["T_VARIABLE","$store",152],",",["T_WHITESPACE"," ",152],["T_VARIABLE","$group",152],")",["T_WHITESPACE","\n    ",152],"{",["T_WHITESPACE","\n        ",153],["T_VARIABLE","$basePrice",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_VARIABLE","$specialPrice",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_VARIABLE","$specialPriceFrom",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_VARIABLE","$specialPriceTo",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_STRING","null",154],";",["T_WHITESPACE","\n        ",154],["T_VARIABLE","$priceId",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_STRING","Mage",155],["T_DOUBLE_COLON","::",155],["T_STRING","getSingleton",155],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/entity_attribute'",155],")",["T_OBJECT_OPERATOR","->",155],["T_STRING","getIdByCode",155],"(",["T_STRING","Mage_Catalog_Model_Product",155],["T_DOUBLE_COLON","::",155],["T_STRING","ENTITY",155],",",["T_WHITESPACE"," ",155],["T_CONSTANT_ENCAPSED_STRING","'price'",155],")",";",["T_WHITESPACE","\n        ",155],["T_VARIABLE","$specialPriceId",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_STRING","Mage",156],["T_DOUBLE_COLON","::",156],["T_STRING","getSingleton",156],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/entity_attribute'",156],")",["T_OBJECT_OPERATOR","->",156],["T_STRING","getIdByCode",156],"(",["T_STRING","Mage_Catalog_Model_Product",156],["T_DOUBLE_COLON","::",156],["T_STRING","ENTITY",156],",",["T_WHITESPACE"," ",156],["T_CONSTANT_ENCAPSED_STRING","'special_price'",156],")",";",["T_WHITESPACE","\n        ",156],["T_VARIABLE","$specialPriceFromId",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_STRING","Mage",157],["T_DOUBLE_COLON","::",157],["T_STRING","getSingleton",157],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/entity_attribute'",157],")",["T_OBJECT_OPERATOR","->",157],["T_STRING","getIdByCode",157],"(",["T_STRING","Mage_Catalog_Model_Product",157],["T_DOUBLE_COLON","::",157],["T_STRING","ENTITY",157],",",["T_WHITESPACE"," ",157],["T_CONSTANT_ENCAPSED_STRING","'special_from_date'",157],")",";",["T_WHITESPACE","\n        ",157],["T_VARIABLE","$specialPriceToId",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_STRING","Mage",158],["T_DOUBLE_COLON","::",158],["T_STRING","getSingleton",158],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/entity_attribute'",158],")",["T_OBJECT_OPERATOR","->",158],["T_STRING","getIdByCode",158],"(",["T_STRING","Mage_Catalog_Model_Product",158],["T_DOUBLE_COLON","::",158],["T_STRING","ENTITY",158],",",["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","'special_to_date'",158],")",";",["T_WHITESPACE","\n\n        ",158],["T_VARIABLE","$attributes",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_ARRAY","array",160],"(",["T_VARIABLE","$priceId",160],",",["T_WHITESPACE"," ",160],["T_VARIABLE","$specialPriceId",160],",",["T_WHITESPACE"," ",160],["T_VARIABLE","$specialPriceFromId",160],",",["T_WHITESPACE"," ",160],["T_VARIABLE","$specialPriceToId",160],")",";",["T_WHITESPACE","\n\n        ",160],["T_VARIABLE","$productData",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","getAttributeData",162],"(",["T_VARIABLE","$product",162],",",["T_WHITESPACE"," ",162],["T_VARIABLE","$attributes",162],",",["T_WHITESPACE"," ",162],["T_VARIABLE","$store",162],")",";",["T_WHITESPACE","\n        ",162],["T_FOREACH","foreach",163],["T_WHITESPACE"," ",163],"(",["T_VARIABLE","$productData",163],["T_WHITESPACE"," ",163],["T_AS","as",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$row",163],")",["T_WHITESPACE"," ",163],"{",["T_WHITESPACE","\n            ",163],["T_SWITCH","switch",164],["T_WHITESPACE"," ",164],"(",["T_VARIABLE","$row",164],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",164],"]",")",["T_WHITESPACE"," ",164],"{",["T_WHITESPACE","\n                ",164],["T_CASE","case",165],["T_WHITESPACE"," ",165],["T_VARIABLE","$priceId",165],":",["T_WHITESPACE","\n                    ",165],["T_VARIABLE","$basePrice",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_VARIABLE","$row",166],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",166],"]",";",["T_WHITESPACE","\n                ",166],["T_BREAK","break",167],";",["T_WHITESPACE","\n                ",167],["T_CASE","case",168],["T_WHITESPACE"," ",168],["T_VARIABLE","$specialPriceId",168],":",["T_WHITESPACE","\n                    ",168],["T_VARIABLE","$specialPrice",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_VARIABLE","$row",169],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",169],"]",";",["T_WHITESPACE","\n                ",169],["T_BREAK","break",170],";",["T_WHITESPACE","\n                ",170],["T_CASE","case",171],["T_WHITESPACE"," ",171],["T_VARIABLE","$specialPriceFromId",171],":",["T_WHITESPACE","\n                    ",171],["T_VARIABLE","$specialPriceFrom",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_VARIABLE","$row",172],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",172],"]",";",["T_WHITESPACE","\n                ",172],["T_BREAK","break",173],";",["T_WHITESPACE","\n                ",173],["T_CASE","case",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$specialPriceToId",174],":",["T_WHITESPACE","\n                    ",174],["T_VARIABLE","$specialPriceTo",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_VARIABLE","$row",175],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",175],"]",";",["T_WHITESPACE","\n                ",175],["T_BREAK","break",176],";",["T_WHITESPACE","\n            ",176],"}",["T_WHITESPACE","\n        ",177],"}",["T_WHITESPACE","\n\n        ",178],["T_VARIABLE","$finalPrice",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_STRING","Mage",180],["T_DOUBLE_COLON","::",180],["T_STRING","getSingleton",180],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_type'",180],")",["T_WHITESPACE","\n            ",180],["T_OBJECT_OPERATOR","->",181],["T_STRING","priceFactory",181],"(",["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","getTypeCode",181],"(",")",")",["T_WHITESPACE","\n            ",181],["T_OBJECT_OPERATOR","->",182],["T_STRING","calculatePrice",182],"(",["T_VARIABLE","$basePrice",182],",",["T_WHITESPACE"," ",182],["T_VARIABLE","$specialPrice",182],",",["T_WHITESPACE"," ",182],["T_VARIABLE","$specialPriceFrom",182],",",["T_WHITESPACE"," ",182],["T_VARIABLE","$specialPriceTo",182],",",["T_WHITESPACE"," ",182],["T_STRING","false",182],",",["T_WHITESPACE"," ",182],["T_VARIABLE","$store",182],",",["T_WHITESPACE"," ",182],["T_VARIABLE","$group",182],",",["T_WHITESPACE"," ",182],["T_VARIABLE","$product",182],")",";",["T_WHITESPACE","\n\n        ",182],["T_RETURN","return",184],["T_WHITESPACE"," ",184],["T_VARIABLE","$finalPrice",184],";",["T_WHITESPACE","\n    ",184],"}",["T_WHITESPACE","\n\n    ",185],["T_DOC_COMMENT","\/**\n     * Return minimal prices for specified products\n     *\n     * @param array $products\n     * @param Mage_Core_Model_Store $store\n     * @return array\n     *\/",187],["T_WHITESPACE","\n    ",193],["T_PUBLIC","public",194],["T_WHITESPACE"," ",194],["T_FUNCTION","function",194],["T_WHITESPACE"," ",194],["T_STRING","getMinimalPrice",194],"(",["T_VARIABLE","$products",194],",",["T_WHITESPACE"," ",194],["T_VARIABLE","$store",194],")",["T_WHITESPACE","\n    ",194],"{",["T_WHITESPACE","\n        ",195],["T_VARIABLE","$priceAttributes",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_ARRAY","array",196],"(",["T_WHITESPACE","\n            ",196],["T_STRING","Mage",197],["T_DOUBLE_COLON","::",197],["T_STRING","getSingleton",197],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/entity_attribute'",197],")",["T_OBJECT_OPERATOR","->",197],["T_STRING","getIdByCode",197],"(",["T_STRING","Mage_Catalog_Model_Product",197],["T_DOUBLE_COLON","::",197],["T_STRING","ENTITY",197],",",["T_WHITESPACE"," ",197],["T_CONSTANT_ENCAPSED_STRING","'tier_price'",197],")",",",["T_WHITESPACE","\n            ",197],["T_STRING","Mage",198],["T_DOUBLE_COLON","::",198],["T_STRING","getSingleton",198],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/entity_attribute'",198],")",["T_OBJECT_OPERATOR","->",198],["T_STRING","getIdByCode",198],"(",["T_STRING","Mage_Catalog_Model_Product",198],["T_DOUBLE_COLON","::",198],["T_STRING","ENTITY",198],",",["T_WHITESPACE"," ",198],["T_CONSTANT_ENCAPSED_STRING","'price'",198],")",")",";",["T_WHITESPACE","\n\n        ",198],["T_VARIABLE","$data",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","getResource",200],"(",")",["T_OBJECT_OPERATOR","->",200],["T_STRING","getMinimalPrice",200],"(",["T_VARIABLE","$products",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$priceAttributes",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$store",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","getId",200],"(",")",")",";",["T_WHITESPACE","\n\n        ",200],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","setMinimalPriceData",202],"(",["T_VARIABLE","$data",202],")",";",["T_WHITESPACE","\n        ",202],["T_VARIABLE","$eventData",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_ARRAY","array",203],"(",["T_CONSTANT_ENCAPSED_STRING","'indexer'",203],["T_DOUBLE_ARROW","=>",203],["T_VARIABLE","$this",203],",",["T_WHITESPACE"," ",203],["T_CONSTANT_ENCAPSED_STRING","'product_ids'",203],["T_DOUBLE_ARROW","=>",203],["T_VARIABLE","$products",203],",",["T_WHITESPACE"," ",203],["T_CONSTANT_ENCAPSED_STRING","'store'",203],["T_DOUBLE_ARROW","=>",203],["T_VARIABLE","$store",203],")",";",["T_WHITESPACE","\n        ",203],["T_STRING","Mage",204],["T_DOUBLE_COLON","::",204],["T_STRING","dispatchEvent",204],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogindex_get_minimal_price'",204],",",["T_WHITESPACE"," ",204],["T_VARIABLE","$eventData",204],")",";",["T_WHITESPACE","\n        ",204],["T_VARIABLE","$data",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","getMinimalPriceData",205],"(",")",";",["T_WHITESPACE","\n\n        ",205],["T_RETURN","return",207],["T_WHITESPACE"," ",207],["T_VARIABLE","$data",207],";",["T_WHITESPACE","\n    ",207],"}",["T_WHITESPACE","\n\n    ",208],["T_DOC_COMMENT","\/**\n     * Get tax class id for a product\n     *\n     * @param int $productId\n     * @param Mage_Core_Model_Store $store\n     * @return int\n     *\/",210],["T_WHITESPACE","\n    ",216],["T_PUBLIC","public",217],["T_WHITESPACE"," ",217],["T_FUNCTION","function",217],["T_WHITESPACE"," ",217],["T_STRING","getTaxClassId",217],"(",["T_VARIABLE","$productId",217],",",["T_WHITESPACE"," ",217],["T_VARIABLE","$store",217],")",["T_WHITESPACE","\n    ",217],"{",["T_WHITESPACE","\n        ",218],["T_VARIABLE","$attributeId",219],["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],["T_STRING","Mage",219],["T_DOUBLE_COLON","::",219],["T_STRING","getSingleton",219],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/entity_attribute'",219],")",["T_OBJECT_OPERATOR","->",219],["T_STRING","getIdByCode",219],"(",["T_STRING","Mage_Catalog_Model_Product",219],["T_DOUBLE_COLON","::",219],["T_STRING","ENTITY",219],",",["T_WHITESPACE"," ",219],["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",219],")",";",["T_WHITESPACE","\n        ",219],["T_VARIABLE","$taxClassId",220],["T_WHITESPACE","  ",220],"=",["T_WHITESPACE"," ",220],["T_VARIABLE","$this",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","getResource",220],"(",")",["T_OBJECT_OPERATOR","->",220],["T_STRING","getAttributeData",220],"(",["T_ARRAY","array",220],"(",["T_VARIABLE","$productId",220],")",",",["T_WHITESPACE"," ",220],["T_ARRAY","array",220],"(",["T_VARIABLE","$attributeId",220],")",",",["T_WHITESPACE"," ",220],["T_VARIABLE","$store",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","getId",220],"(",")",")",";",["T_WHITESPACE","\n        ",220],["T_IF","if",221],["T_WHITESPACE"," ",221],"(",["T_STRING","is_array",221],"(",["T_VARIABLE","$taxClassId",221],")",["T_WHITESPACE"," ",221],["T_BOOLEAN_AND","&&",221],["T_WHITESPACE"," ",221],["T_ISSET","isset",221],"(",["T_VARIABLE","$taxClassId",221],"[",["T_LNUMBER","0",221],"]","[",["T_CONSTANT_ENCAPSED_STRING","'value'",221],"]",")",")",["T_WHITESPACE"," ",221],"{",["T_WHITESPACE","\n            ",221],["T_VARIABLE","$taxClassId",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_VARIABLE","$taxClassId",222],"[",["T_LNUMBER","0",222],"]","[",["T_CONSTANT_ENCAPSED_STRING","'value'",222],"]",";",["T_WHITESPACE","\n        ",222],"}",["T_WHITESPACE","\n        ",223],["T_ELSE","else",224],["T_WHITESPACE"," ",224],"{",["T_WHITESPACE","\n            ",224],["T_VARIABLE","$taxClassId",225],["T_WHITESPACE"," ",225],"=",["T_WHITESPACE"," ",225],["T_LNUMBER","0",225],";",["T_WHITESPACE","\n        ",225],"}",["T_WHITESPACE","\n        ",226],["T_RETURN","return",227],["T_WHITESPACE"," ",227],["T_VARIABLE","$taxClassId",227],";",["T_WHITESPACE","\n    ",227],"}",["T_WHITESPACE","\n\n    ",228],["T_DOC_COMMENT","\/**\n     * Return tier data for specified products in specified store\n     *\n     * @param array $products\n     * @param Mage_Core_Model_Store $store\n     * @return mixed\n     *\/",230],["T_WHITESPACE","\n    ",236],["T_PUBLIC","public",237],["T_WHITESPACE"," ",237],["T_FUNCTION","function",237],["T_WHITESPACE"," ",237],["T_STRING","getTierPrices",237],"(",["T_VARIABLE","$products",237],",",["T_WHITESPACE"," ",237],["T_VARIABLE","$store",237],")",["T_WHITESPACE","\n    ",237],"{",["T_WHITESPACE","\n        ",238],["T_RETURN","return",239],["T_WHITESPACE"," ",239],["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","getResource",239],"(",")",["T_OBJECT_OPERATOR","->",239],["T_STRING","getTierPrices",239],"(",["T_VARIABLE","$products",239],",",["T_WHITESPACE"," ",239],["T_VARIABLE","$store",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","getWebsiteId",239],"(",")",")",";",["T_WHITESPACE","\n    ",239],"}",["T_WHITESPACE","\n\n    ",240],["T_DOC_COMMENT","\/**\n     * Retreive specified attribute data for specified products from specified store\n     *\n     * @param array $products\n     * @param array $attributes\n     * @param Mage_Core_Model_Store $store\n     *\/",242],["T_WHITESPACE","\n    ",248],["T_PUBLIC","public",249],["T_WHITESPACE"," ",249],["T_FUNCTION","function",249],["T_WHITESPACE"," ",249],["T_STRING","getAttributeData",249],"(",["T_VARIABLE","$products",249],",",["T_WHITESPACE"," ",249],["T_VARIABLE","$attributes",249],",",["T_WHITESPACE"," ",249],["T_VARIABLE","$store",249],")",["T_WHITESPACE","\n    ",249],"{",["T_WHITESPACE","\n        ",250],["T_RETURN","return",251],["T_WHITESPACE"," ",251],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","getResource",251],"(",")",["T_OBJECT_OPERATOR","->",251],["T_STRING","getAttributeData",251],"(",["T_VARIABLE","$products",251],",",["T_WHITESPACE"," ",251],["T_VARIABLE","$attributes",251],",",["T_WHITESPACE"," ",251],["T_VARIABLE","$store",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","getId",251],"(",")",")",";",["T_WHITESPACE","\n    ",251],"}",["T_WHITESPACE","\n\n    ",252],["T_DOC_COMMENT","\/**\n     * Retreive product type code\n     *\n     * @return string\n     *\/",254],["T_WHITESPACE","\n    ",258],["T_PUBLIC","public",259],["T_WHITESPACE"," ",259],["T_FUNCTION","function",259],["T_WHITESPACE"," ",259],["T_STRING","getTypeCode",259],"(",")",["T_WHITESPACE","\n    ",259],"{",["T_WHITESPACE","\n        ",260],["T_STRING","Mage",261],["T_DOUBLE_COLON","::",261],["T_STRING","throwException",261],"(",["T_CONSTANT_ENCAPSED_STRING","'Define custom data retreiver with getTypeCode function'",261],")",";",["T_WHITESPACE","\n    ",261],"}",["T_WHITESPACE","\n\n    ",262],["T_DOC_COMMENT","\/**\n     * Get child link table and field settings\n     *\n     * @return mixed\n     *\/",264],["T_WHITESPACE","\n    ",268],["T_PROTECTED","protected",269],["T_WHITESPACE"," ",269],["T_FUNCTION","function",269],["T_WHITESPACE"," ",269],["T_STRING","_getLinkSettings",269],"(",")",["T_WHITESPACE","\n    ",269],"{",["T_WHITESPACE","\n        ",270],["T_RETURN","return",271],["T_WHITESPACE"," ",271],["T_STRING","false",271],";",["T_WHITESPACE","\n    ",271],"}",["T_WHITESPACE","\n\n    ",272],["T_DOC_COMMENT","\/**\n     * Returns if type supports children of the specified type\n     *\n     * @param int $type\n     * @return bool\n     *\/",274],["T_WHITESPACE","\n    ",279],["T_PUBLIC","public",280],["T_WHITESPACE"," ",280],["T_FUNCTION","function",280],["T_WHITESPACE"," ",280],["T_STRING","areChildrenIndexable",280],"(",["T_VARIABLE","$type",280],")",["T_WHITESPACE","\n    ",280],"{",["T_WHITESPACE","\n        ",281],["T_IF","if",282],["T_WHITESPACE"," ",282],"(","!",["T_VARIABLE","$this",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","_haveChildren",282],["T_WHITESPACE"," ",282],["T_BOOLEAN_OR","||",282],["T_WHITESPACE"," ",282],"!",["T_ISSET","isset",282],"(",["T_VARIABLE","$this",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","_haveChildren",282],"[",["T_VARIABLE","$type",282],"]",")",["T_WHITESPACE"," ",282],["T_BOOLEAN_OR","||",282],["T_WHITESPACE"," ",282],"!",["T_VARIABLE","$this",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","_haveChildren",282],"[",["T_VARIABLE","$type",282],"]",")",["T_WHITESPACE"," ",282],"{",["T_WHITESPACE","\n            ",282],["T_RETURN","return",283],["T_WHITESPACE"," ",283],["T_STRING","false",283],";",["T_WHITESPACE","\n        ",283],"}",["T_WHITESPACE","\n        ",284],["T_RETURN","return",285],["T_WHITESPACE"," ",285],["T_STRING","true",285],";",["T_WHITESPACE","\n    ",285],"}",["T_WHITESPACE","\n\n    ",286],["T_DOC_COMMENT","\/**\n     * Retrieve Product Type Instance\n     *\n     * @return Mage_Catalog_Model_Product_Type_Abstract\n     *\/",288],["T_WHITESPACE","\n    ",292],["T_PUBLIC","public",293],["T_WHITESPACE"," ",293],["T_FUNCTION","function",293],["T_WHITESPACE"," ",293],["T_STRING","getTypeInstance",293],"(",")",["T_WHITESPACE","\n    ",293],"{",["T_WHITESPACE","\n        ",294],["T_IF","if",295],["T_WHITESPACE"," ",295],"(",["T_STRING","is_null",295],"(",["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","_typeInstance",295],")",")",["T_WHITESPACE"," ",295],"{",["T_WHITESPACE","\n            ",295],["T_VARIABLE","$product",296],["T_WHITESPACE"," ",296],"=",["T_WHITESPACE"," ",296],["T_NEW","new",296],["T_WHITESPACE"," ",296],["T_STRING","Varien_Object",296],"(",")",";",["T_WHITESPACE","\n            ",296],["T_VARIABLE","$product",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","setTypeId",297],"(",["T_VARIABLE","$this",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","getTypeCode",297],"(",")",")",";",["T_WHITESPACE","\n            ",297],["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","_typeInstance",298],["T_WHITESPACE"," ",298],"=",["T_WHITESPACE"," ",298],["T_STRING","Mage",298],["T_DOUBLE_COLON","::",298],["T_STRING","getSingleton",298],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_type'",298],")",["T_WHITESPACE","\n                ",298],["T_OBJECT_OPERATOR","->",299],["T_STRING","factory",299],"(",["T_VARIABLE","$product",299],",",["T_WHITESPACE"," ",299],["T_STRING","true",299],")",";",["T_WHITESPACE","\n        ",299],"}",["T_WHITESPACE","\n        ",300],["T_RETURN","return",301],["T_WHITESPACE"," ",301],["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","_typeInstance",301],";",["T_WHITESPACE","\n    ",301],"}",["T_WHITESPACE","\n",302],"}",["T_WHITESPACE","\n",303]]