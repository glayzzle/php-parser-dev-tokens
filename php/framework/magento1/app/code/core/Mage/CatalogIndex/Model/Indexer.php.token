[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_CatalogIndex\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * CatalogIndex Index operation model\n *\n * @method Mage_CatalogIndex_Model_Resource_Indexer _getResource()\n * @method Mage_CatalogIndex_Model_Resource_Indexer getResource()\n * @method int getEntityTypeId()\n * @method Mage_CatalogIndex_Model_Indexer setEntityTypeId(int $value)\n * @method int getAttributeSetId()\n * @method Mage_CatalogIndex_Model_Indexer setAttributeSetId(int $value)\n * @method string getTypeId()\n * @method Mage_CatalogIndex_Model_Indexer setTypeId(string $value)\n * @method string getSku()\n * @method Mage_CatalogIndex_Model_Indexer setSku(string $value)\n * @method int getHasOptions()\n * @method Mage_CatalogIndex_Model_Indexer setHasOptions(int $value)\n * @method int getRequiredOptions()\n * @method Mage_CatalogIndex_Model_Indexer setRequiredOptions(int $value)\n * @method string getCreatedAt()\n * @method Mage_CatalogIndex_Model_Indexer setCreatedAt(string $value)\n * @method string getUpdatedAt()\n * @method Mage_CatalogIndex_Model_Indexer setUpdatedAt(string $value)\n *\n * @category    Mage\n * @package     Mage_CatalogIndex\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",53],["T_CLASS","class",54],["T_WHITESPACE"," ",54],["T_STRING","Mage_CatalogIndex_Model_Indexer",54],["T_WHITESPACE"," ",54],["T_EXTENDS","extends",54],["T_WHITESPACE"," ",54],["T_STRING","Mage_Core_Model_Abstract",54],["T_WHITESPACE","\n",54],"{",["T_WHITESPACE","\n    ",55],["T_CONST","const",56],["T_WHITESPACE"," ",56],["T_STRING","REINDEX_TYPE_ALL",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_LNUMBER","0",56],";",["T_WHITESPACE","\n    ",56],["T_CONST","const",57],["T_WHITESPACE"," ",57],["T_STRING","REINDEX_TYPE_PRICE",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_LNUMBER","1",57],";",["T_WHITESPACE","\n    ",57],["T_CONST","const",58],["T_WHITESPACE"," ",58],["T_STRING","REINDEX_TYPE_ATTRIBUTE",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_LNUMBER","2",58],";",["T_WHITESPACE","\n\n    ",58],["T_CONST","const",60],["T_WHITESPACE"," ",60],["T_STRING","STEP_SIZE",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_LNUMBER","1000",60],";",["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * Set of available indexers\n     * Each indexer type is responsable for index data storage\n     *\n     * @var array\n     *\/",62],["T_WHITESPACE","\n    ",67],["T_PROTECTED","protected",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$_indexers",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_ARRAY","array",68],"(",")",";",["T_WHITESPACE","\n\n    ",68],["T_DOC_COMMENT","\/**\n     * Predefined set of indexer types which are related with product price\n     *\n     * @var array\n     *\/",70],["T_WHITESPACE","\n    ",74],["T_PROTECTED","protected",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$_priceIndexers",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_ARRAY","array",75],"(",["T_CONSTANT_ENCAPSED_STRING","'price'",75],",",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'tier_price'",75],",",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'minimal_price'",75],")",";",["T_WHITESPACE","\n\n    ",75],["T_DOC_COMMENT","\/**\n     * Predefined sets of indexer types which are related\n     * with product filterable attributes\n     *\n     * @var array\n     *\/",77],["T_WHITESPACE","\n    ",82],["T_PROTECTED","protected",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$_attributeIndexers",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_ARRAY","array",83],"(",["T_CONSTANT_ENCAPSED_STRING","'eav'",83],")",";",["T_WHITESPACE","\n\n    ",83],["T_DOC_COMMENT","\/**\n     * Tproduct types sorted by index priority\n     *\n     * @var array\n     *\/",85],["T_WHITESPACE","\n    ",89],["T_PROTECTED","protected",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$_productTypePriority",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_STRING","null",90],";",["T_WHITESPACE","\n\n    ",90],["T_DOC_COMMENT","\/**\n     * Initialize all indexers and resource model\n     *\n     *\/",92],["T_WHITESPACE","\n    ",95],["T_PROTECTED","protected",96],["T_WHITESPACE"," ",96],["T_FUNCTION","function",96],["T_WHITESPACE"," ",96],["T_STRING","_construct",96],"(",")",["T_WHITESPACE","\n    ",96],"{",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","_loadIndexers",98],"(",")",";",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","_init",99],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogindex\/indexer'",99],")",";",["T_WHITESPACE","\n    ",99],"}",["T_WHITESPACE","\n\n    ",100],["T_DOC_COMMENT","\/**\n     * Create instances of all index types\n     *\n     * @return Mage_CatalogIndex_Model_Indexer\n     *\/",102],["T_WHITESPACE","\n    ",106],["T_PROTECTED","protected",107],["T_WHITESPACE"," ",107],["T_FUNCTION","function",107],["T_WHITESPACE"," ",107],["T_STRING","_loadIndexers",107],"(",")",["T_WHITESPACE","\n    ",107],"{",["T_WHITESPACE","\n        ",108],["T_FOREACH","foreach",109],["T_WHITESPACE"," ",109],"(",["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","_getRegisteredIndexers",109],"(",")",["T_WHITESPACE"," ",109],["T_AS","as",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$name",109],["T_DOUBLE_ARROW","=>",109],["T_VARIABLE","$class",109],")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n            ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","_indexers",110],"[",["T_VARIABLE","$name",110],"]",["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_STRING","Mage",110],["T_DOUBLE_COLON","::",110],["T_STRING","getSingleton",110],"(",["T_VARIABLE","$class",110],")",";",["T_WHITESPACE","\n        ",110],"}",["T_WHITESPACE","\n        ",111],["T_RETURN","return",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],";",["T_WHITESPACE","\n    ",112],"}",["T_WHITESPACE","\n\n    ",113],["T_DOC_COMMENT","\/**\n     * Get all registered in configuration indexers\n     *\n     * @return array\n     *\/",115],["T_WHITESPACE","\n    ",119],["T_PROTECTED","protected",120],["T_WHITESPACE"," ",120],["T_FUNCTION","function",120],["T_WHITESPACE"," ",120],["T_STRING","_getRegisteredIndexers",120],"(",")",["T_WHITESPACE","\n    ",120],"{",["T_WHITESPACE","\n        ",121],["T_VARIABLE","$result",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_ARRAY","array",122],"(",")",";",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$indexerRegistry",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_STRING","Mage",123],["T_DOUBLE_COLON","::",123],["T_STRING","getConfig",123],"(",")",["T_OBJECT_OPERATOR","->",123],["T_STRING","getNode",123],"(",["T_CONSTANT_ENCAPSED_STRING","'global\/catalogindex\/indexer'",123],")",";",["T_WHITESPACE","\n\n        ",123],["T_FOREACH","foreach",125],["T_WHITESPACE"," ",125],"(",["T_VARIABLE","$indexerRegistry",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","children",125],"(",")",["T_WHITESPACE"," ",125],["T_AS","as",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$node",125],")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n            ",125],["T_VARIABLE","$result",126],"[",["T_VARIABLE","$node",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getName",126],"(",")","]",["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_STRING_CAST","(string)",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$node",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","class",126],";",["T_WHITESPACE","\n        ",126],"}",["T_WHITESPACE","\n        ",127],["T_RETURN","return",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$result",128],";",["T_WHITESPACE","\n    ",128],"}",["T_WHITESPACE","\n\n    ",129],["T_DOC_COMMENT","\/**\n     * Get array of attribute codes required for indexing\n     * Each indexer type provide his own set of attributes\n     *\n     * @return array\n     *\/",131],["T_WHITESPACE","\n    ",136],["T_PROTECTED","protected",137],["T_WHITESPACE"," ",137],["T_FUNCTION","function",137],["T_WHITESPACE"," ",137],["T_STRING","_getIndexableAttributeCodes",137],"(",")",["T_WHITESPACE","\n    ",137],"{",["T_WHITESPACE","\n        ",138],["T_VARIABLE","$result",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_ARRAY","array",139],"(",")",";",["T_WHITESPACE","\n        ",139],["T_FOREACH","foreach",140],["T_WHITESPACE"," ",140],"(",["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","_indexers",140],["T_WHITESPACE"," ",140],["T_AS","as",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$indexer",140],")",["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n            ",140],["T_VARIABLE","$codes",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_VARIABLE","$indexer",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getIndexableAttributeCodes",141],"(",")",";",["T_WHITESPACE","\n\n            ",141],["T_IF","if",143],["T_WHITESPACE"," ",143],"(",["T_STRING","is_array",143],"(",["T_VARIABLE","$codes",143],")",")",["T_WHITESPACE","\n                ",143],["T_VARIABLE","$result",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_STRING","array_merge",144],"(",["T_VARIABLE","$result",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$codes",144],")",";",["T_WHITESPACE","\n        ",144],"}",["T_WHITESPACE","\n        ",145],["T_RETURN","return",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$result",146],";",["T_WHITESPACE","\n    ",146],"}",["T_WHITESPACE","\n\n    ",147],["T_DOC_COMMENT","\/**\n     * Retreive store collection\n     *\n     * @return array\n     *\/",149],["T_WHITESPACE","\n    ",153],["T_PROTECTED","protected",154],["T_WHITESPACE"," ",154],["T_FUNCTION","function",154],["T_WHITESPACE"," ",154],["T_STRING","_getStores",154],"(",")",["T_WHITESPACE","\n    ",154],"{",["T_WHITESPACE","\n        ",155],["T_VARIABLE","$stores",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","getData",156],"(",["T_CONSTANT_ENCAPSED_STRING","'_stores'",156],")",";",["T_WHITESPACE","\n        ",156],["T_IF","if",157],["T_WHITESPACE"," ",157],"(",["T_STRING","is_null",157],"(",["T_VARIABLE","$stores",157],")",")",["T_WHITESPACE"," ",157],"{",["T_WHITESPACE","\n            ",157],["T_VARIABLE","$stores",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_STRING","Mage",158],["T_DOUBLE_COLON","::",158],["T_STRING","app",158],"(",")",["T_OBJECT_OPERATOR","->",158],["T_STRING","getStores",158],"(",")",";",["T_WHITESPACE","\n            ",158],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","setData",159],"(",["T_CONSTANT_ENCAPSED_STRING","'_stores'",159],",",["T_WHITESPACE"," ",159],["T_VARIABLE","$stores",159],")",";",["T_WHITESPACE","\n        ",159],"}",["T_WHITESPACE","\n        ",160],["T_RETURN","return",161],["T_WHITESPACE"," ",161],["T_VARIABLE","$stores",161],";",["T_WHITESPACE","\n    ",161],"}",["T_WHITESPACE","\n\n    ",162],["T_DOC_COMMENT","\/**\n     * Retreive store collection\n     *\n     * @return Mage_Core_Model_Mysql4_Store_Collection\n     *\/",164],["T_WHITESPACE","\n    ",168],["T_PROTECTED","protected",169],["T_WHITESPACE"," ",169],["T_FUNCTION","function",169],["T_WHITESPACE"," ",169],["T_STRING","_getWebsites",169],"(",")",["T_WHITESPACE","\n    ",169],"{",["T_WHITESPACE","\n        ",170],["T_VARIABLE","$websites",171],["T_WHITESPACE"," ",171],"=",["T_WHITESPACE"," ",171],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","getData",171],"(",["T_CONSTANT_ENCAPSED_STRING","'_websites'",171],")",";",["T_WHITESPACE","\n        ",171],["T_IF","if",172],["T_WHITESPACE"," ",172],"(",["T_STRING","is_null",172],"(",["T_VARIABLE","$websites",172],")",")",["T_WHITESPACE"," ",172],"{",["T_WHITESPACE","\n            ",172],["T_VARIABLE","$websites",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_STRING","Mage",173],["T_DOUBLE_COLON","::",173],["T_STRING","getModel",173],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/website'",173],")",["T_OBJECT_OPERATOR","->",173],["T_STRING","getCollection",173],"(",")",["T_OBJECT_OPERATOR","->",173],["T_STRING","load",173],"(",")",";",["T_WHITESPACE","\n            ",173],["T_COMMENT","\/* @var $stores Mage_Core_Model_Mysql4_Website_Collection *\/",174],["T_WHITESPACE","\n\n            ",174],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","setData",176],"(",["T_CONSTANT_ENCAPSED_STRING","'_websites'",176],",",["T_WHITESPACE"," ",176],["T_VARIABLE","$websites",176],")",";",["T_WHITESPACE","\n        ",176],"}",["T_WHITESPACE","\n        ",177],["T_RETURN","return",178],["T_WHITESPACE"," ",178],["T_VARIABLE","$websites",178],";",["T_WHITESPACE","\n    ",178],"}",["T_WHITESPACE","\n\n    ",179],["T_DOC_COMMENT","\/**\n     * Remove index data for specifuc product\n     *\n     * @param   mixed $product\n     * @return  Mage_CatalogIndex_Model_Indexer\n     *\/",181],["T_WHITESPACE","\n    ",186],["T_PUBLIC","public",187],["T_WHITESPACE"," ",187],["T_FUNCTION","function",187],["T_WHITESPACE"," ",187],["T_STRING","cleanup",187],"(",["T_VARIABLE","$product",187],")",["T_WHITESPACE","\n    ",187],"{",["T_WHITESPACE","\n        ",188],["T_VARIABLE","$store",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_VARIABLE","$product",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getNeedStoreForReindex",189],"(",")",["T_WHITESPACE"," ",189],["T_IS_IDENTICAL","===",189],["T_WHITESPACE"," ",189],["T_STRING","true",189],["T_WHITESPACE"," ",189],"?",["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","_getStores",189],"(",")",["T_WHITESPACE"," ",189],":",["T_WHITESPACE"," ",189],["T_STRING","null",189],";",["T_WHITESPACE","\n        ",189],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","_getResource",190],"(",")",["T_OBJECT_OPERATOR","->",190],["T_STRING","clear",190],"(",["T_STRING","true",190],",",["T_WHITESPACE"," ",190],["T_STRING","true",190],",",["T_WHITESPACE"," ",190],["T_STRING","true",190],",",["T_WHITESPACE"," ",190],["T_STRING","true",190],",",["T_WHITESPACE"," ",190],["T_STRING","true",190],",",["T_WHITESPACE"," ",190],["T_VARIABLE","$product",190],",",["T_WHITESPACE"," ",190],["T_VARIABLE","$store",190],")",";",["T_WHITESPACE","\n\n        ",190],["T_RETURN","return",192],["T_WHITESPACE"," ",192],["T_VARIABLE","$this",192],";",["T_WHITESPACE","\n    ",192],"}",["T_WHITESPACE","\n\n    ",193],["T_DOC_COMMENT","\/**\n     * Reindex catalog product data which used in layered navigation and in product list\n     *\n     * @param   mixed $products\n     * @param   mixed $attributes\n     * @param   mixed $stores\n     * @return  Mage_CatalogIndex_Model_Indexer\n     *\/",195],["T_WHITESPACE","\n    ",202],["T_PUBLIC","public",203],["T_WHITESPACE"," ",203],["T_FUNCTION","function",203],["T_WHITESPACE"," ",203],["T_STRING","plainReindex",203],"(",["T_VARIABLE","$products",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_STRING","null",203],",",["T_WHITESPACE"," ",203],["T_VARIABLE","$attributes",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_STRING","null",203],",",["T_WHITESPACE"," ",203],["T_VARIABLE","$stores",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_STRING","null",203],")",["T_WHITESPACE","\n    ",203],"{",["T_WHITESPACE","\n        ",204],["T_DOC_COMMENT","\/**\n         * Check indexer flag\n         *\/",205],["T_WHITESPACE","\n        ",207],["T_VARIABLE","$flag",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_STRING","Mage",208],["T_DOUBLE_COLON","::",208],["T_STRING","getModel",208],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogindex\/catalog_index_flag'",208],")",["T_OBJECT_OPERATOR","->",208],["T_STRING","loadSelf",208],"(",")",";",["T_WHITESPACE","\n        ",208],["T_IF","if",209],["T_WHITESPACE"," ",209],"(",["T_VARIABLE","$flag",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","getState",209],"(",")",["T_WHITESPACE"," ",209],["T_IS_EQUAL","==",209],["T_WHITESPACE"," ",209],["T_STRING","Mage_CatalogIndex_Model_Catalog_Index_Flag",209],["T_DOUBLE_COLON","::",209],["T_STRING","STATE_RUNNING",209],")",["T_WHITESPACE"," ",209],"{",["T_WHITESPACE","\n            ",209],["T_RETURN","return",210],["T_WHITESPACE"," ",210],["T_VARIABLE","$this",210],";",["T_WHITESPACE","\n        ",210],"}",["T_WHITESPACE","\n        ",211],["T_COMMENT","\/*if ($flag->getState() == Mage_CatalogIndex_Model_Catalog_Index_Flag::STATE_QUEUED)*\/",212],["T_WHITESPACE","\n        ",212],["T_ELSE","else",213],["T_WHITESPACE"," ",213],"{",["T_WHITESPACE","\n            ",213],["T_VARIABLE","$flag",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","setState",214],"(",["T_STRING","Mage_CatalogIndex_Model_Catalog_Index_Flag",214],["T_DOUBLE_COLON","::",214],["T_STRING","STATE_RUNNING",214],")",["T_OBJECT_OPERATOR","->",214],["T_STRING","save",214],"(",")",";",["T_WHITESPACE","\n        ",214],"}",["T_WHITESPACE","\n\n        ",215],["T_TRY","try",217],["T_WHITESPACE"," ",217],"{",["T_WHITESPACE","\n            ",217],["T_DOC_COMMENT","\/**\n             * Collect initialization data\n             *\/",218],["T_WHITESPACE","\n            ",220],["T_VARIABLE","$websites",221],["T_WHITESPACE"," ",221],"=",["T_WHITESPACE"," ",221],["T_ARRAY","array",221],"(",")",";",["T_WHITESPACE","\n            ",221],["T_VARIABLE","$attributeCodes",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_VARIABLE","$priceAttributeCodes",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_ARRAY","array",222],"(",")",";",["T_WHITESPACE","\n",222],["T_COMMENT","\/\/            $status = Mage_Catalog_Model_Product_Status::STATUS_ENABLED;\n",223],["T_COMMENT","\/\/            $visibility = array(\n",224],["T_COMMENT","\/\/                Mage_Catalog_Model_Product_Visibility::VISIBILITY_BOTH,\n",225],["T_COMMENT","\/\/                Mage_Catalog_Model_Product_Visibility::VISIBILITY_IN_CATALOG,\n",226],["T_COMMENT","\/\/                Mage_Catalog_Model_Product_Visibility::VISIBILITY_IN_SEARCH,\n",227],["T_COMMENT","\/\/            );\n",228],["T_WHITESPACE","\n            ",229],["T_DOC_COMMENT","\/**\n             * Prepare stores and websites information\n             *\/",230],["T_WHITESPACE","\n            ",232],["T_IF","if",233],["T_WHITESPACE"," ",233],"(",["T_STRING","is_null",233],"(",["T_VARIABLE","$stores",233],")",")",["T_WHITESPACE"," ",233],"{",["T_WHITESPACE","\n                ",233],["T_VARIABLE","$stores",234],["T_WHITESPACE","     ",234],"=",["T_WHITESPACE"," ",234],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","_getStores",234],"(",")",";",["T_WHITESPACE","\n                ",234],["T_VARIABLE","$websites",235],["T_WHITESPACE","   ",235],"=",["T_WHITESPACE"," ",235],["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","_getWebsites",235],"(",")",";",["T_WHITESPACE","\n            ",235],"}",["T_WHITESPACE","\n            ",236],["T_ELSEIF","elseif",237],["T_WHITESPACE"," ",237],"(",["T_VARIABLE","$stores",237],["T_WHITESPACE"," ",237],["T_INSTANCEOF","instanceof",237],["T_WHITESPACE"," ",237],["T_STRING","Mage_Core_Model_Store",237],")",["T_WHITESPACE"," ",237],"{",["T_WHITESPACE","\n                ",237],["T_VARIABLE","$websites",238],"[","]",["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],["T_VARIABLE","$stores",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","getWebsiteId",238],"(",")",";",["T_WHITESPACE","\n                ",238],["T_VARIABLE","$stores",239],["T_WHITESPACE","     ",239],"=",["T_WHITESPACE"," ",239],["T_ARRAY","array",239],"(",["T_VARIABLE","$stores",239],")",";",["T_WHITESPACE","\n            ",239],"}",["T_WHITESPACE","\n            ",240],["T_ELSEIF","elseif",241],["T_WHITESPACE"," ",241],"(",["T_STRING","is_array",241],"(",["T_VARIABLE","$stores",241],")",")",["T_WHITESPACE"," ",241],"{",["T_WHITESPACE","\n                ",241],["T_FOREACH","foreach",242],["T_WHITESPACE"," ",242],"(",["T_VARIABLE","$stores",242],["T_WHITESPACE"," ",242],["T_AS","as",242],["T_WHITESPACE"," ",242],["T_VARIABLE","$one",242],")",["T_WHITESPACE"," ",242],"{",["T_WHITESPACE","\n                    ",242],["T_VARIABLE","$websites",243],"[","]",["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_STRING","Mage",243],["T_DOUBLE_COLON","::",243],["T_STRING","app",243],"(",")",["T_OBJECT_OPERATOR","->",243],["T_STRING","getStore",243],"(",["T_VARIABLE","$one",243],")",["T_OBJECT_OPERATOR","->",243],["T_STRING","getWebsiteId",243],"(",")",";",["T_WHITESPACE","\n                ",243],"}",["T_WHITESPACE","\n            ",244],"}",["T_WHITESPACE","\n            ",245],["T_ELSEIF","elseif",246],["T_WHITESPACE"," ",246],"(","!",["T_STRING","is_array",246],"(",["T_VARIABLE","$stores",246],")",")",["T_WHITESPACE"," ",246],"{",["T_WHITESPACE","\n                ",246],["T_STRING","Mage",247],["T_DOUBLE_COLON","::",247],["T_STRING","throwException",247],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid stores supplied for indexing'",247],")",";",["T_WHITESPACE","\n            ",247],"}",["T_WHITESPACE","\n\n            ",248],["T_DOC_COMMENT","\/**\n             * Prepare attributes data\n             *\/",250],["T_WHITESPACE","\n            ",252],["T_IF","if",253],["T_WHITESPACE"," ",253],"(",["T_STRING","is_null",253],"(",["T_VARIABLE","$attributes",253],")",")",["T_WHITESPACE"," ",253],"{",["T_WHITESPACE","\n                ",253],["T_VARIABLE","$priceAttributeCodes",254],["T_WHITESPACE"," ",254],"=",["T_WHITESPACE"," ",254],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","_indexers",254],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",254],"]",["T_OBJECT_OPERATOR","->",254],["T_STRING","getIndexableAttributeCodes",254],"(",")",";",["T_WHITESPACE","\n                ",254],["T_VARIABLE","$attributeCodes",255],["T_WHITESPACE"," ",255],"=",["T_WHITESPACE"," ",255],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","_indexers",255],"[",["T_CONSTANT_ENCAPSED_STRING","'eav'",255],"]",["T_OBJECT_OPERATOR","->",255],["T_STRING","getIndexableAttributeCodes",255],"(",")",";",["T_WHITESPACE","\n            ",255],"}",["T_WHITESPACE","\n            ",256],["T_ELSEIF","elseif",257],["T_WHITESPACE"," ",257],"(",["T_VARIABLE","$attributes",257],["T_WHITESPACE"," ",257],["T_INSTANCEOF","instanceof",257],["T_WHITESPACE"," ",257],["T_STRING","Mage_Eav_Model_Entity_Attribute_Abstract",257],")",["T_WHITESPACE"," ",257],"{",["T_WHITESPACE","\n                ",257],["T_IF","if",258],["T_WHITESPACE"," ",258],"(",["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","_indexers",258],"[",["T_CONSTANT_ENCAPSED_STRING","'eav'",258],"]",["T_OBJECT_OPERATOR","->",258],["T_STRING","isAttributeIndexable",258],"(",["T_VARIABLE","$attributes",258],")",")",["T_WHITESPACE"," ",258],"{",["T_WHITESPACE","\n                    ",258],["T_VARIABLE","$attributeCodes",259],"[","]",["T_WHITESPACE"," ",259],"=",["T_WHITESPACE"," ",259],["T_VARIABLE","$attributes",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","getAttributeId",259],"(",")",";",["T_WHITESPACE","\n                ",259],"}",["T_WHITESPACE","\n                ",260],["T_IF","if",261],["T_WHITESPACE"," ",261],"(",["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","_indexers",261],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",261],"]",["T_OBJECT_OPERATOR","->",261],["T_STRING","isAttributeIndexable",261],"(",["T_VARIABLE","$attributes",261],")",")",["T_WHITESPACE"," ",261],"{",["T_WHITESPACE","\n                    ",261],["T_VARIABLE","$priceAttributeCodes",262],"[","]",["T_WHITESPACE"," ",262],"=",["T_WHITESPACE"," ",262],["T_VARIABLE","$attributes",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","getAttributeId",262],"(",")",";",["T_WHITESPACE","\n                ",262],"}",["T_WHITESPACE","\n            ",263],"}",["T_WHITESPACE","\n            ",264],["T_ELSEIF","elseif",265],["T_WHITESPACE"," ",265],"(",["T_VARIABLE","$attributes",265],["T_WHITESPACE"," ",265],["T_IS_EQUAL","==",265],["T_WHITESPACE"," ",265],["T_STRING","self",265],["T_DOUBLE_COLON","::",265],["T_STRING","REINDEX_TYPE_PRICE",265],")",["T_WHITESPACE"," ",265],"{",["T_WHITESPACE","\n                ",265],["T_VARIABLE","$priceAttributeCodes",266],["T_WHITESPACE"," ",266],"=",["T_WHITESPACE"," ",266],["T_VARIABLE","$this",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","_indexers",266],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",266],"]",["T_OBJECT_OPERATOR","->",266],["T_STRING","getIndexableAttributeCodes",266],"(",")",";",["T_WHITESPACE","\n            ",266],"}",["T_WHITESPACE","\n            ",267],["T_ELSEIF","elseif",268],["T_WHITESPACE"," ",268],"(",["T_VARIABLE","$attributes",268],["T_WHITESPACE"," ",268],["T_IS_EQUAL","==",268],["T_WHITESPACE"," ",268],["T_STRING","self",268],["T_DOUBLE_COLON","::",268],["T_STRING","REINDEX_TYPE_ATTRIBUTE",268],")",["T_WHITESPACE"," ",268],"{",["T_WHITESPACE","\n                ",268],["T_VARIABLE","$attributeCodes",269],["T_WHITESPACE"," ",269],"=",["T_WHITESPACE"," ",269],["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","_indexers",269],"[",["T_CONSTANT_ENCAPSED_STRING","'eav'",269],"]",["T_OBJECT_OPERATOR","->",269],["T_STRING","getIndexableAttributeCodes",269],"(",")",";",["T_WHITESPACE","\n            ",269],"}",["T_WHITESPACE","\n            ",270],["T_ELSE","else",271],["T_WHITESPACE"," ",271],"{",["T_WHITESPACE","\n                ",271],["T_STRING","Mage",272],["T_DOUBLE_COLON","::",272],["T_STRING","throwException",272],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid attributes supplied for indexing'",272],")",";",["T_WHITESPACE","\n            ",272],"}",["T_WHITESPACE","\n\n            ",273],["T_DOC_COMMENT","\/**\n             * Delete index data\n             *\/",275],["T_WHITESPACE","\n            ",277],["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","_getResource",278],"(",")",["T_OBJECT_OPERATOR","->",278],["T_STRING","clear",278],"(",["T_WHITESPACE","\n                ",278],["T_VARIABLE","$attributeCodes",279],",",["T_WHITESPACE","\n                ",279],["T_VARIABLE","$priceAttributeCodes",280],",",["T_WHITESPACE","\n                ",280],["T_STRING","count",281],"(",["T_VARIABLE","$priceAttributeCodes",281],")",">",["T_LNUMBER","0",281],",",["T_WHITESPACE","\n                ",281],["T_STRING","count",282],"(",["T_VARIABLE","$priceAttributeCodes",282],")",">",["T_LNUMBER","0",282],",",["T_WHITESPACE","\n                ",282],["T_STRING","count",283],"(",["T_VARIABLE","$priceAttributeCodes",283],")",">",["T_LNUMBER","0",283],",",["T_WHITESPACE","\n                ",283],["T_VARIABLE","$products",284],",",["T_WHITESPACE","\n                ",284],["T_VARIABLE","$stores",285],["T_WHITESPACE","\n            ",285],")",";",["T_WHITESPACE","\n\n            ",286],["T_DOC_COMMENT","\/**\n             * Process index price data per each website\n             * (prices depends from website level)\n             *\/",288],["T_WHITESPACE","\n            ",291],["T_FOREACH","foreach",292],["T_WHITESPACE"," ",292],"(",["T_VARIABLE","$websites",292],["T_WHITESPACE"," ",292],["T_AS","as",292],["T_WHITESPACE"," ",292],["T_VARIABLE","$website",292],")",["T_WHITESPACE"," ",292],"{",["T_WHITESPACE","\n                ",292],["T_VARIABLE","$ws",293],["T_WHITESPACE"," ",293],"=",["T_WHITESPACE"," ",293],["T_STRING","Mage",293],["T_DOUBLE_COLON","::",293],["T_STRING","app",293],"(",")",["T_OBJECT_OPERATOR","->",293],["T_STRING","getWebsite",293],"(",["T_VARIABLE","$website",293],")",";",["T_WHITESPACE","\n                ",293],["T_IF","if",294],["T_WHITESPACE"," ",294],"(","!",["T_VARIABLE","$ws",294],")",["T_WHITESPACE"," ",294],"{",["T_WHITESPACE","\n                    ",294],["T_CONTINUE","continue",295],";",["T_WHITESPACE","\n                ",295],"}",["T_WHITESPACE","\n\n                ",296],["T_VARIABLE","$group",298],["T_WHITESPACE"," ",298],"=",["T_WHITESPACE"," ",298],["T_VARIABLE","$ws",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","getDefaultGroup",298],"(",")",";",["T_WHITESPACE","\n                ",298],["T_IF","if",299],["T_WHITESPACE"," ",299],"(","!",["T_VARIABLE","$group",299],")",["T_WHITESPACE"," ",299],"{",["T_WHITESPACE","\n                    ",299],["T_CONTINUE","continue",300],";",["T_WHITESPACE","\n                ",300],"}",["T_WHITESPACE","\n\n                ",301],["T_VARIABLE","$store",303],["T_WHITESPACE"," ",303],"=",["T_WHITESPACE"," ",303],["T_VARIABLE","$group",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","getDefaultStore",303],"(",")",";",["T_WHITESPACE","\n\n                ",303],["T_DOC_COMMENT","\/**\n                 * It can happens when website with store was created but store view not yet\n                 *\/",305],["T_WHITESPACE","\n                ",307],["T_IF","if",308],["T_WHITESPACE"," ",308],"(","!",["T_VARIABLE","$store",308],")",["T_WHITESPACE"," ",308],"{",["T_WHITESPACE","\n                    ",308],["T_CONTINUE","continue",309],";",["T_WHITESPACE","\n                ",309],"}",["T_WHITESPACE","\n\n                ",310],["T_FOREACH","foreach",312],["T_WHITESPACE"," ",312],"(",["T_VARIABLE","$this",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","_getPriorifiedProductTypes",312],"(",")",["T_WHITESPACE"," ",312],["T_AS","as",312],["T_WHITESPACE"," ",312],["T_VARIABLE","$type",312],")",["T_WHITESPACE"," ",312],"{",["T_WHITESPACE","\n                    ",312],["T_VARIABLE","$collection",313],["T_WHITESPACE"," ",313],"=",["T_WHITESPACE"," ",313],["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","_getProductCollection",313],"(",["T_VARIABLE","$store",313],",",["T_WHITESPACE"," ",313],["T_VARIABLE","$products",313],")",";",["T_WHITESPACE","\n                    ",313],["T_VARIABLE","$collection",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","addAttributeToFilter",314],"(",["T_WHITESPACE","\n                        ",314],["T_CONSTANT_ENCAPSED_STRING","'status'",315],",",["T_WHITESPACE","\n                        ",315],["T_ARRAY","array",316],"(",["T_CONSTANT_ENCAPSED_STRING","'in'",316],["T_DOUBLE_ARROW","=>",316],["T_STRING","Mage",316],["T_DOUBLE_COLON","::",316],["T_STRING","getModel",316],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_status'",316],")",["T_OBJECT_OPERATOR","->",316],["T_STRING","getSaleableStatusIds",316],"(",")",")",["T_WHITESPACE","\n                    ",316],")",";",["T_WHITESPACE","\n                    ",317],["T_VARIABLE","$collection",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","addFieldToFilter",318],"(",["T_CONSTANT_ENCAPSED_STRING","'type_id'",318],",",["T_WHITESPACE"," ",318],["T_VARIABLE","$type",318],")",";",["T_WHITESPACE","\n                    ",318],["T_VARIABLE","$this",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","_walkCollection",319],"(",["T_VARIABLE","$collection",319],",",["T_WHITESPACE"," ",319],["T_VARIABLE","$store",319],",",["T_WHITESPACE"," ",319],["T_ARRAY","array",319],"(",")",",",["T_WHITESPACE"," ",319],["T_VARIABLE","$priceAttributeCodes",319],")",";",["T_WHITESPACE","\n                    ",319],["T_IF","if",320],["T_WHITESPACE"," ",320],"(","!",["T_STRING","is_null",320],"(",["T_VARIABLE","$products",320],")",["T_WHITESPACE"," ",320],["T_BOOLEAN_AND","&&",320],["T_WHITESPACE"," ",320],"!",["T_VARIABLE","$this",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","getRetreiver",320],"(",["T_VARIABLE","$type",320],")",["T_OBJECT_OPERATOR","->",320],["T_STRING","getTypeInstance",320],"(",")",["T_OBJECT_OPERATOR","->",320],["T_STRING","isComposite",320],"(",")",")",["T_WHITESPACE"," ",320],"{",["T_WHITESPACE","\n                        ",320],["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","_walkCollectionRelation",321],"(",["T_VARIABLE","$collection",321],",",["T_WHITESPACE"," ",321],["T_VARIABLE","$ws",321],",",["T_WHITESPACE"," ",321],["T_ARRAY","array",321],"(",")",",",["T_WHITESPACE"," ",321],["T_VARIABLE","$priceAttributeCodes",321],")",";",["T_WHITESPACE","\n                    ",321],"}",["T_WHITESPACE","\n                ",322],"}",["T_WHITESPACE","\n            ",323],"}",["T_WHITESPACE","\n\n            ",324],["T_DOC_COMMENT","\/**\n             * Process EAV attributes per each store view\n             *\/",326],["T_WHITESPACE","\n            ",328],["T_FOREACH","foreach",329],["T_WHITESPACE"," ",329],"(",["T_VARIABLE","$stores",329],["T_WHITESPACE"," ",329],["T_AS","as",329],["T_WHITESPACE"," ",329],["T_VARIABLE","$store",329],")",["T_WHITESPACE"," ",329],"{",["T_WHITESPACE","\n                ",329],["T_FOREACH","foreach",330],["T_WHITESPACE"," ",330],"(",["T_VARIABLE","$this",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","_getPriorifiedProductTypes",330],"(",")",["T_WHITESPACE"," ",330],["T_AS","as",330],["T_WHITESPACE"," ",330],["T_VARIABLE","$type",330],")",["T_WHITESPACE"," ",330],"{",["T_WHITESPACE","\n                    ",330],["T_VARIABLE","$collection",331],["T_WHITESPACE"," ",331],"=",["T_WHITESPACE"," ",331],["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","_getProductCollection",331],"(",["T_VARIABLE","$store",331],",",["T_WHITESPACE"," ",331],["T_VARIABLE","$products",331],")",";",["T_WHITESPACE","\n                    ",331],["T_STRING","Mage",332],["T_DOUBLE_COLON","::",332],["T_STRING","getSingleton",332],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_visibility'",332],")",["T_OBJECT_OPERATOR","->",332],["T_STRING","addVisibleInSiteFilterToCollection",332],"(",["T_VARIABLE","$collection",332],")",";",["T_WHITESPACE","\n                    ",332],["T_VARIABLE","$collection",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","addFieldToFilter",333],"(",["T_CONSTANT_ENCAPSED_STRING","'type_id'",333],",",["T_WHITESPACE"," ",333],["T_VARIABLE","$type",333],")",";",["T_WHITESPACE","\n\n                    ",333],["T_VARIABLE","$this",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","_walkCollection",335],"(",["T_VARIABLE","$collection",335],",",["T_WHITESPACE"," ",335],["T_VARIABLE","$store",335],",",["T_WHITESPACE"," ",335],["T_VARIABLE","$attributeCodes",335],")",";",["T_WHITESPACE","\n                    ",335],["T_IF","if",336],["T_WHITESPACE"," ",336],"(","!",["T_STRING","is_null",336],"(",["T_VARIABLE","$products",336],")",["T_WHITESPACE"," ",336],["T_BOOLEAN_AND","&&",336],["T_WHITESPACE"," ",336],"!",["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","getRetreiver",336],"(",["T_VARIABLE","$type",336],")",["T_OBJECT_OPERATOR","->",336],["T_STRING","getTypeInstance",336],"(",")",["T_OBJECT_OPERATOR","->",336],["T_STRING","isComposite",336],"(",")",")",["T_WHITESPACE"," ",336],"{",["T_WHITESPACE","\n                        ",336],["T_VARIABLE","$this",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","_walkCollectionRelation",337],"(",["T_VARIABLE","$collection",337],",",["T_WHITESPACE"," ",337],["T_VARIABLE","$store",337],",",["T_WHITESPACE"," ",337],["T_VARIABLE","$attributeCodes",337],")",";",["T_WHITESPACE","\n                    ",337],"}",["T_WHITESPACE","\n                ",338],"}",["T_WHITESPACE","\n            ",339],"}",["T_WHITESPACE","\n\n            ",340],["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","_afterPlainReindex",342],"(",["T_VARIABLE","$stores",342],",",["T_WHITESPACE"," ",342],["T_VARIABLE","$products",342],")",";",["T_WHITESPACE","\n\n            ",342],["T_DOC_COMMENT","\/**\n             * Catalog Product Flat price update\n             *\/",344],["T_WHITESPACE","\n            ",346],["T_DOC_COMMENT","\/** @var $productFlatHelper Mage_Catalog_Helper_Product_Flat *\/",347],["T_WHITESPACE","\n            ",347],["T_VARIABLE","$productFlatHelper",348],["T_WHITESPACE"," ",348],"=",["T_WHITESPACE"," ",348],["T_STRING","Mage",348],["T_DOUBLE_COLON","::",348],["T_STRING","helper",348],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_flat'",348],")",";",["T_WHITESPACE","\n            ",348],["T_IF","if",349],["T_WHITESPACE"," ",349],"(",["T_VARIABLE","$productFlatHelper",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","isAvailable",349],"(",")",["T_WHITESPACE"," ",349],["T_BOOLEAN_AND","&&",349],["T_WHITESPACE"," ",349],["T_VARIABLE","$productFlatHelper",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","isBuilt",349],"(",")",")",["T_WHITESPACE"," ",349],"{",["T_WHITESPACE","\n                ",349],["T_FOREACH","foreach",350],["T_WHITESPACE"," ",350],"(",["T_VARIABLE","$stores",350],["T_WHITESPACE"," ",350],["T_AS","as",350],["T_WHITESPACE"," ",350],["T_VARIABLE","$store",350],")",["T_WHITESPACE"," ",350],"{",["T_WHITESPACE","\n                    ",350],["T_VARIABLE","$this",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","updateCatalogProductFlat",351],"(",["T_VARIABLE","$store",351],",",["T_WHITESPACE"," ",351],["T_VARIABLE","$products",351],")",";",["T_WHITESPACE","\n                ",351],"}",["T_WHITESPACE","\n            ",352],"}",["T_WHITESPACE","\n\n        ",353],"}",["T_WHITESPACE"," ",355],["T_CATCH","catch",355],["T_WHITESPACE"," ",355],"(",["T_STRING","Exception",355],["T_WHITESPACE"," ",355],["T_VARIABLE","$e",355],")",["T_WHITESPACE"," ",355],"{",["T_WHITESPACE","\n            ",355],["T_VARIABLE","$flag",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","delete",356],"(",")",";",["T_WHITESPACE","\n            ",356],["T_THROW","throw",357],["T_WHITESPACE"," ",357],["T_VARIABLE","$e",357],";",["T_WHITESPACE","\n        ",357],"}",["T_WHITESPACE","\n\n        ",358],["T_IF","if",360],["T_WHITESPACE"," ",360],"(",["T_VARIABLE","$flag",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","getState",360],"(",")",["T_WHITESPACE"," ",360],["T_IS_EQUAL","==",360],["T_WHITESPACE"," ",360],["T_STRING","Mage_CatalogIndex_Model_Catalog_Index_Flag",360],["T_DOUBLE_COLON","::",360],["T_STRING","STATE_RUNNING",360],")",["T_WHITESPACE"," ",360],"{",["T_WHITESPACE","\n            ",360],["T_VARIABLE","$flag",361],["T_OBJECT_OPERATOR","->",361],["T_STRING","delete",361],"(",")",";",["T_WHITESPACE","\n        ",361],"}",["T_WHITESPACE","\n\n        ",362],["T_RETURN","return",364],["T_WHITESPACE"," ",364],["T_VARIABLE","$this",364],";",["T_WHITESPACE","\n    ",364],"}",["T_WHITESPACE","\n\n    ",365],["T_DOC_COMMENT","\/**\n     * After plain reindex process\n     *\n     * @param Mage_Core_Model_Store|array|int|Mage_Core_Model_Website $store\n     * @param int|array|Mage_Catalog_Model_Product_Condition_Interface|Mage_Catalog_Model_Product $products\n     * @return Mage_CatalogIndex_Model_Indexer\n     *\/",367],["T_WHITESPACE","\n    ",373],["T_PROTECTED","protected",374],["T_WHITESPACE"," ",374],["T_FUNCTION","function",374],["T_WHITESPACE"," ",374],["T_STRING","_afterPlainReindex",374],"(",["T_VARIABLE","$store",374],",",["T_WHITESPACE"," ",374],["T_VARIABLE","$products",374],["T_WHITESPACE"," ",374],"=",["T_WHITESPACE"," ",374],["T_STRING","null",374],")",["T_WHITESPACE","\n    ",374],"{",["T_WHITESPACE","\n        ",375],["T_STRING","Mage",376],["T_DOUBLE_COLON","::",376],["T_STRING","dispatchEvent",376],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogindex_plain_reindex_after'",376],",",["T_WHITESPACE"," ",376],["T_ARRAY","array",376],"(",["T_WHITESPACE","\n            ",376],["T_CONSTANT_ENCAPSED_STRING","'products'",377],["T_WHITESPACE"," ",377],["T_DOUBLE_ARROW","=>",377],["T_WHITESPACE"," ",377],["T_VARIABLE","$products",377],["T_WHITESPACE","\n        ",377],")",")",";",["T_WHITESPACE","\n\n        ",378],["T_DOC_COMMENT","\/**\n         * Catalog Product Flat price update\n         *\/",380],["T_WHITESPACE","\n        ",382],["T_DOC_COMMENT","\/** @var $productFlatHelper Mage_Catalog_Helper_Product_Flat *\/",383],["T_WHITESPACE","\n        ",383],["T_VARIABLE","$productFlatHelper",384],["T_WHITESPACE"," ",384],"=",["T_WHITESPACE"," ",384],["T_STRING","Mage",384],["T_DOUBLE_COLON","::",384],["T_STRING","helper",384],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_flat'",384],")",";",["T_WHITESPACE","\n        ",384],["T_IF","if",385],["T_WHITESPACE"," ",385],"(",["T_VARIABLE","$productFlatHelper",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","isAvailable",385],"(",")",["T_WHITESPACE"," ",385],["T_BOOLEAN_AND","&&",385],["T_WHITESPACE"," ",385],["T_VARIABLE","$productFlatHelper",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","isBuilt",385],"(",")",")",["T_WHITESPACE"," ",385],"{",["T_WHITESPACE","\n            ",385],["T_IF","if",386],["T_WHITESPACE"," ",386],"(",["T_VARIABLE","$store",386],["T_WHITESPACE"," ",386],["T_INSTANCEOF","instanceof",386],["T_WHITESPACE"," ",386],["T_STRING","Mage_Core_Model_Website",386],")",["T_WHITESPACE"," ",386],"{",["T_WHITESPACE","\n                ",386],["T_FOREACH","foreach",387],["T_WHITESPACE"," ",387],"(",["T_VARIABLE","$store",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","getStores",387],"(",")",["T_WHITESPACE"," ",387],["T_AS","as",387],["T_WHITESPACE"," ",387],["T_VARIABLE","$storeObject",387],")",["T_WHITESPACE"," ",387],"{",["T_WHITESPACE","\n                    ",387],["T_VARIABLE","$this",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","_afterPlainReindex",388],"(",["T_VARIABLE","$storeObject",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","getId",388],"(",")",",",["T_WHITESPACE"," ",388],["T_VARIABLE","$products",388],")",";",["T_WHITESPACE","\n                ",388],"}",["T_WHITESPACE","\n                ",389],["T_RETURN","return",390],["T_WHITESPACE"," ",390],["T_VARIABLE","$this",390],";",["T_WHITESPACE","\n            ",390],"}",["T_WHITESPACE","\n            ",391],["T_ELSEIF","elseif",392],["T_WHITESPACE"," ",392],"(",["T_VARIABLE","$store",392],["T_WHITESPACE"," ",392],["T_INSTANCEOF","instanceof",392],["T_WHITESPACE"," ",392],["T_STRING","Mage_Core_Model_Store",392],")",["T_WHITESPACE"," ",392],"{",["T_WHITESPACE","\n                ",392],["T_VARIABLE","$store",393],["T_WHITESPACE"," ",393],"=",["T_WHITESPACE"," ",393],["T_VARIABLE","$store",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","getId",393],"(",")",";",["T_WHITESPACE","\n            ",393],"}",["T_WHITESPACE","\n            ",394],["T_COMMENT","\/\/ array of stores\n",395],["T_WHITESPACE","            ",396],["T_ELSEIF","elseif",396],["T_WHITESPACE"," ",396],"(",["T_STRING","is_array",396],"(",["T_VARIABLE","$store",396],")",")",["T_WHITESPACE"," ",396],"{",["T_WHITESPACE","\n                ",396],["T_FOREACH","foreach",397],["T_WHITESPACE"," ",397],"(",["T_VARIABLE","$store",397],["T_WHITESPACE"," ",397],["T_AS","as",397],["T_WHITESPACE"," ",397],["T_VARIABLE","$storeObject",397],")",["T_WHITESPACE"," ",397],"{",["T_WHITESPACE","\n                    ",397],["T_VARIABLE","$this",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","_afterPlainReindex",398],"(",["T_VARIABLE","$storeObject",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","getId",398],"(",")",",",["T_WHITESPACE"," ",398],["T_VARIABLE","$products",398],")",";",["T_WHITESPACE","\n                ",398],"}",["T_WHITESPACE","\n                ",399],["T_RETURN","return",400],["T_WHITESPACE"," ",400],["T_VARIABLE","$this",400],";",["T_WHITESPACE","\n            ",400],"}",["T_WHITESPACE","\n\n            ",401],["T_VARIABLE","$this",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","updateCatalogProductFlat",403],"(",["T_VARIABLE","$store",403],",",["T_WHITESPACE"," ",403],["T_VARIABLE","$products",403],")",";",["T_WHITESPACE","\n        ",403],"}",["T_WHITESPACE","\n\n        ",404],["T_RETURN","return",406],["T_WHITESPACE"," ",406],["T_VARIABLE","$this",406],";",["T_WHITESPACE","\n    ",406],"}",["T_WHITESPACE","\n\n    ",407],["T_DOC_COMMENT","\/**\n     * Return collection with product and store filters\n     *\n     * @param Mage_Core_Model_Store $store\n     * @param mixed $products\n     * @return Mage_Catalog_Model_Resource_Eav_Mysql4_Product_Collection\n     *\/",409],["T_WHITESPACE","\n    ",415],["T_PROTECTED","protected",416],["T_WHITESPACE"," ",416],["T_FUNCTION","function",416],["T_WHITESPACE"," ",416],["T_STRING","_getProductCollection",416],"(",["T_VARIABLE","$store",416],",",["T_WHITESPACE"," ",416],["T_VARIABLE","$products",416],")",["T_WHITESPACE","\n    ",416],"{",["T_WHITESPACE","\n        ",417],["T_VARIABLE","$collection",418],["T_WHITESPACE"," ",418],"=",["T_WHITESPACE"," ",418],["T_STRING","Mage",418],["T_DOUBLE_COLON","::",418],["T_STRING","getModel",418],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",418],")",["T_WHITESPACE","\n            ",418],["T_OBJECT_OPERATOR","->",419],["T_STRING","getCollection",419],"(",")",["T_WHITESPACE","\n            ",419],["T_OBJECT_OPERATOR","->",420],["T_STRING","setStoreId",420],"(",["T_VARIABLE","$store",420],")",["T_WHITESPACE","\n            ",420],["T_OBJECT_OPERATOR","->",421],["T_STRING","addStoreFilter",421],"(",["T_VARIABLE","$store",421],")",";",["T_WHITESPACE","\n        ",421],["T_IF","if",422],["T_WHITESPACE"," ",422],"(",["T_VARIABLE","$products",422],["T_WHITESPACE"," ",422],["T_INSTANCEOF","instanceof",422],["T_WHITESPACE"," ",422],["T_STRING","Mage_Catalog_Model_Product",422],")",["T_WHITESPACE"," ",422],"{",["T_WHITESPACE","\n            ",422],["T_VARIABLE","$collection",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","addIdFilter",423],"(",["T_VARIABLE","$products",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","getId",423],"(",")",")",";",["T_WHITESPACE","\n        ",423],"}",["T_WHITESPACE"," ",424],["T_ELSE","else",424],["T_WHITESPACE"," ",424],["T_IF","if",424],["T_WHITESPACE"," ",424],"(",["T_STRING","is_array",424],"(",["T_VARIABLE","$products",424],")",["T_WHITESPACE"," ",424],["T_BOOLEAN_OR","||",424],["T_WHITESPACE"," ",424],["T_STRING","is_numeric",424],"(",["T_VARIABLE","$products",424],")",")",["T_WHITESPACE"," ",424],"{",["T_WHITESPACE","\n            ",424],["T_VARIABLE","$collection",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","addIdFilter",425],"(",["T_VARIABLE","$products",425],")",";",["T_WHITESPACE","\n        ",425],"}",["T_WHITESPACE"," ",426],["T_ELSEIF","elseif",426],["T_WHITESPACE"," ",426],"(",["T_VARIABLE","$products",426],["T_WHITESPACE"," ",426],["T_INSTANCEOF","instanceof",426],["T_WHITESPACE"," ",426],["T_STRING","Mage_Catalog_Model_Product_Condition_Interface",426],")",["T_WHITESPACE"," ",426],"{",["T_WHITESPACE","\n            ",426],["T_VARIABLE","$products",427],["T_OBJECT_OPERATOR","->",427],["T_STRING","applyToCollection",427],"(",["T_VARIABLE","$collection",427],")",";",["T_WHITESPACE","\n        ",427],"}",["T_WHITESPACE","\n\n        ",428],["T_RETURN","return",430],["T_WHITESPACE"," ",430],["T_VARIABLE","$collection",430],";",["T_WHITESPACE","\n    ",430],"}",["T_WHITESPACE","\n\n    ",431],["T_DOC_COMMENT","\/**\n     * Walk Product Collection for Relation Parent products\n     *\n     * @param Mage_Catalog_Model_Resource_Eav_Mysql4_Product_Collection $collection\n     * @param Mage_Core_Model_Store|Mage_Core_Model_Website $store\n     * @param array $attributes\n     * @param array $prices\n     * @return Mage_CatalogIndex_Model_Indexer\n     *\/",433],["T_WHITESPACE","\n    ",441],["T_PUBLIC","public",442],["T_WHITESPACE"," ",442],["T_FUNCTION","function",442],["T_WHITESPACE"," ",442],["T_STRING","_walkCollectionRelation",442],"(",["T_VARIABLE","$collection",442],",",["T_WHITESPACE"," ",442],["T_VARIABLE","$store",442],",",["T_WHITESPACE"," ",442],["T_VARIABLE","$attributes",442],["T_WHITESPACE"," ",442],"=",["T_WHITESPACE"," ",442],["T_ARRAY","array",442],"(",")",",",["T_WHITESPACE"," ",442],["T_VARIABLE","$prices",442],["T_WHITESPACE"," ",442],"=",["T_WHITESPACE"," ",442],["T_ARRAY","array",442],"(",")",")",["T_WHITESPACE","\n    ",442],"{",["T_WHITESPACE","\n        ",443],["T_IF","if",444],["T_WHITESPACE"," ",444],"(",["T_VARIABLE","$store",444],["T_WHITESPACE"," ",444],["T_INSTANCEOF","instanceof",444],["T_WHITESPACE"," ",444],["T_STRING","Mage_Core_Model_Website",444],")",["T_WHITESPACE"," ",444],"{",["T_WHITESPACE","\n            ",444],["T_VARIABLE","$storeObject",445],["T_WHITESPACE"," ",445],"=",["T_WHITESPACE"," ",445],["T_VARIABLE","$store",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","getDefaultStore",445],"(",")",";",["T_WHITESPACE","\n        ",445],"}",["T_WHITESPACE","\n        ",446],["T_ELSEIF","elseif",447],["T_WHITESPACE"," ",447],"(",["T_VARIABLE","$store",447],["T_WHITESPACE"," ",447],["T_INSTANCEOF","instanceof",447],["T_WHITESPACE"," ",447],["T_STRING","Mage_Core_Model_Store",447],")",["T_WHITESPACE"," ",447],"{",["T_WHITESPACE","\n            ",447],["T_VARIABLE","$storeObject",448],["T_WHITESPACE"," ",448],"=",["T_WHITESPACE"," ",448],["T_VARIABLE","$store",448],";",["T_WHITESPACE","\n        ",448],"}",["T_WHITESPACE","\n\n        ",449],["T_VARIABLE","$statusCond",451],["T_WHITESPACE"," ",451],"=",["T_WHITESPACE"," ",451],["T_ARRAY","array",451],"(",["T_WHITESPACE","\n            ",451],["T_CONSTANT_ENCAPSED_STRING","'in'",452],["T_WHITESPACE"," ",452],["T_DOUBLE_ARROW","=>",452],["T_WHITESPACE"," ",452],["T_STRING","Mage",452],["T_DOUBLE_COLON","::",452],["T_STRING","getSingleton",452],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_status'",452],")",["T_OBJECT_OPERATOR","->",452],["T_STRING","getSaleableStatusIds",452],"(",")",["T_WHITESPACE","\n        ",452],")",";",["T_WHITESPACE","\n\n        ",453],["T_VARIABLE","$productCount",455],["T_WHITESPACE"," ",455],"=",["T_WHITESPACE"," ",455],["T_VARIABLE","$collection",455],["T_OBJECT_OPERATOR","->",455],["T_STRING","getSize",455],"(",")",";",["T_WHITESPACE","\n        ",455],["T_VARIABLE","$iterateCount",456],["T_WHITESPACE"," ",456],"=",["T_WHITESPACE"," ",456],"(",["T_VARIABLE","$productCount",456],["T_WHITESPACE"," ",456],"\/",["T_WHITESPACE"," ",456],["T_STRING","self",456],["T_DOUBLE_COLON","::",456],["T_STRING","STEP_SIZE",456],")",";",["T_WHITESPACE","\n        ",456],["T_FOR","for",457],["T_WHITESPACE"," ",457],"(",["T_VARIABLE","$i",457],["T_WHITESPACE"," ",457],"=",["T_WHITESPACE"," ",457],["T_LNUMBER","0",457],";",["T_WHITESPACE"," ",457],["T_VARIABLE","$i",457],["T_WHITESPACE"," ",457],"<",["T_WHITESPACE"," ",457],["T_VARIABLE","$iterateCount",457],";",["T_WHITESPACE"," ",457],["T_VARIABLE","$i",457],["T_INC","++",457],")",["T_WHITESPACE"," ",457],"{",["T_WHITESPACE","\n            ",457],["T_VARIABLE","$stepData",458],["T_WHITESPACE"," ",458],"=",["T_WHITESPACE"," ",458],["T_VARIABLE","$collection",458],["T_WHITESPACE","\n                ",458],["T_OBJECT_OPERATOR","->",459],["T_STRING","getAllIds",459],"(",["T_STRING","self",459],["T_DOUBLE_COLON","::",459],["T_STRING","STEP_SIZE",459],",",["T_WHITESPACE"," ",459],["T_VARIABLE","$i",459],["T_WHITESPACE"," ",459],"*",["T_WHITESPACE"," ",459],["T_STRING","self",459],["T_DOUBLE_COLON","::",459],["T_STRING","STEP_SIZE",459],")",";",["T_WHITESPACE","\n            ",459],["T_FOREACH","foreach",460],["T_WHITESPACE"," ",460],"(",["T_VARIABLE","$this",460],["T_OBJECT_OPERATOR","->",460],["T_STRING","_getPriorifiedProductTypes",460],"(",")",["T_WHITESPACE"," ",460],["T_AS","as",460],["T_WHITESPACE"," ",460],["T_VARIABLE","$type",460],")",["T_WHITESPACE"," ",460],"{",["T_WHITESPACE","\n                ",460],["T_VARIABLE","$retriever",461],["T_WHITESPACE"," ",461],"=",["T_WHITESPACE"," ",461],["T_VARIABLE","$this",461],["T_OBJECT_OPERATOR","->",461],["T_STRING","getRetreiver",461],"(",["T_VARIABLE","$type",461],")",";",["T_WHITESPACE","\n                ",461],["T_IF","if",462],["T_WHITESPACE"," ",462],"(","!",["T_VARIABLE","$retriever",462],["T_OBJECT_OPERATOR","->",462],["T_STRING","getTypeInstance",462],"(",")",["T_OBJECT_OPERATOR","->",462],["T_STRING","isComposite",462],"(",")",")",["T_WHITESPACE"," ",462],"{",["T_WHITESPACE","\n                    ",462],["T_CONTINUE","continue",463],";",["T_WHITESPACE","\n                ",463],"}",["T_WHITESPACE","\n\n                ",464],["T_VARIABLE","$parentIds",466],["T_WHITESPACE"," ",466],"=",["T_WHITESPACE"," ",466],["T_VARIABLE","$retriever",466],["T_OBJECT_OPERATOR","->",466],["T_STRING","getTypeInstance",466],"(",")",["T_WHITESPACE","\n                    ",466],["T_OBJECT_OPERATOR","->",467],["T_STRING","getParentIdsByChild",467],"(",["T_VARIABLE","$stepData",467],")",";",["T_WHITESPACE","\n                ",467],["T_IF","if",468],["T_WHITESPACE"," ",468],"(",["T_VARIABLE","$parentIds",468],")",["T_WHITESPACE"," ",468],"{",["T_WHITESPACE","\n                    ",468],["T_VARIABLE","$parentCollection",469],["T_WHITESPACE"," ",469],"=",["T_WHITESPACE"," ",469],["T_VARIABLE","$this",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","_getProductCollection",469],"(",["T_VARIABLE","$storeObject",469],",",["T_WHITESPACE"," ",469],["T_VARIABLE","$parentIds",469],")",";",["T_WHITESPACE","\n                    ",469],["T_VARIABLE","$parentCollection",470],["T_OBJECT_OPERATOR","->",470],["T_STRING","addAttributeToFilter",470],"(",["T_CONSTANT_ENCAPSED_STRING","'status'",470],",",["T_WHITESPACE"," ",470],["T_VARIABLE","$statusCond",470],")",";",["T_WHITESPACE","\n                    ",470],["T_VARIABLE","$parentCollection",471],["T_OBJECT_OPERATOR","->",471],["T_STRING","addFieldToFilter",471],"(",["T_CONSTANT_ENCAPSED_STRING","'type_id'",471],",",["T_WHITESPACE"," ",471],["T_VARIABLE","$type",471],")",";",["T_WHITESPACE","\n                    ",471],["T_VARIABLE","$this",472],["T_OBJECT_OPERATOR","->",472],["T_STRING","_walkCollection",472],"(",["T_VARIABLE","$parentCollection",472],",",["T_WHITESPACE"," ",472],["T_VARIABLE","$storeObject",472],",",["T_WHITESPACE"," ",472],["T_VARIABLE","$attributes",472],",",["T_WHITESPACE"," ",472],["T_VARIABLE","$prices",472],")",";",["T_WHITESPACE","\n\n                    ",472],["T_VARIABLE","$this",474],["T_OBJECT_OPERATOR","->",474],["T_STRING","_afterPlainReindex",474],"(",["T_VARIABLE","$store",474],",",["T_WHITESPACE"," ",474],["T_VARIABLE","$parentIds",474],")",";",["T_WHITESPACE","\n                ",474],"}",["T_WHITESPACE","\n            ",475],"}",["T_WHITESPACE","\n        ",476],"}",["T_WHITESPACE","\n\n        ",477],["T_RETURN","return",479],["T_WHITESPACE"," ",479],["T_VARIABLE","$this",479],";",["T_WHITESPACE","\n    ",479],"}",["T_WHITESPACE","\n\n    ",480],["T_DOC_COMMENT","\/**\n     * Run indexing process for product collection\n     *\n     * @param   Mage_Catalog_Resource_Eav_Mysql4_Product_Collection $collection\n     * @param   mixed $store\n     * @param   array $attributes\n     * @param   array $prices\n     * @return  Mage_CatalogIndex_Model_Indexer\n     *\/",482],["T_WHITESPACE","\n    ",490],["T_PROTECTED","protected",491],["T_WHITESPACE"," ",491],["T_FUNCTION","function",491],["T_WHITESPACE"," ",491],["T_STRING","_walkCollection",491],"(",["T_VARIABLE","$collection",491],",",["T_WHITESPACE"," ",491],["T_VARIABLE","$store",491],",",["T_WHITESPACE"," ",491],["T_VARIABLE","$attributes",491],["T_WHITESPACE"," ",491],"=",["T_WHITESPACE"," ",491],["T_ARRAY","array",491],"(",")",",",["T_WHITESPACE"," ",491],["T_VARIABLE","$prices",491],["T_WHITESPACE"," ",491],"=",["T_WHITESPACE"," ",491],["T_ARRAY","array",491],"(",")",")",["T_WHITESPACE","\n    ",491],"{",["T_WHITESPACE","\n        ",492],["T_VARIABLE","$productCount",493],["T_WHITESPACE"," ",493],"=",["T_WHITESPACE"," ",493],["T_VARIABLE","$collection",493],["T_OBJECT_OPERATOR","->",493],["T_STRING","getSize",493],"(",")",";",["T_WHITESPACE","\n        ",493],["T_IF","if",494],["T_WHITESPACE"," ",494],"(","!",["T_VARIABLE","$productCount",494],")",["T_WHITESPACE"," ",494],"{",["T_WHITESPACE","\n            ",494],["T_RETURN","return",495],["T_WHITESPACE"," ",495],["T_VARIABLE","$this",495],";",["T_WHITESPACE","\n        ",495],"}",["T_WHITESPACE","\n\n        ",496],["T_FOR","for",498],["T_WHITESPACE"," ",498],"(",["T_VARIABLE","$i",498],"=",["T_LNUMBER","0",498],";",["T_VARIABLE","$i",498],"<",["T_VARIABLE","$productCount",498],"\/",["T_STRING","self",498],["T_DOUBLE_COLON","::",498],["T_STRING","STEP_SIZE",498],";",["T_VARIABLE","$i",498],["T_INC","++",498],")",["T_WHITESPACE"," ",498],"{",["T_WHITESPACE","\n            ",498],["T_VARIABLE","$this",499],["T_OBJECT_OPERATOR","->",499],["T_STRING","_getResource",499],"(",")",["T_OBJECT_OPERATOR","->",499],["T_STRING","beginTransaction",499],"(",")",";",["T_WHITESPACE","\n\n            ",499],["T_VARIABLE","$stepData",501],["T_WHITESPACE"," ",501],"=",["T_WHITESPACE"," ",501],["T_VARIABLE","$collection",501],["T_OBJECT_OPERATOR","->",501],["T_STRING","getAllIds",501],"(",["T_STRING","self",501],["T_DOUBLE_COLON","::",501],["T_STRING","STEP_SIZE",501],",",["T_WHITESPACE"," ",501],["T_VARIABLE","$i",501],"*",["T_STRING","self",501],["T_DOUBLE_COLON","::",501],["T_STRING","STEP_SIZE",501],")",";",["T_WHITESPACE","\n\n            ",501],["T_DOC_COMMENT","\/**\n             * Reindex EAV attributes if required\n             *\/",503],["T_WHITESPACE","\n            ",505],["T_IF","if",506],["T_WHITESPACE"," ",506],"(",["T_STRING","count",506],"(",["T_VARIABLE","$attributes",506],")",")",["T_WHITESPACE"," ",506],"{",["T_WHITESPACE","\n                ",506],["T_VARIABLE","$this",507],["T_OBJECT_OPERATOR","->",507],["T_STRING","_getResource",507],"(",")",["T_OBJECT_OPERATOR","->",507],["T_STRING","reindexAttributes",507],"(",["T_VARIABLE","$stepData",507],",",["T_WHITESPACE"," ",507],["T_VARIABLE","$attributes",507],",",["T_WHITESPACE"," ",507],["T_VARIABLE","$store",507],")",";",["T_WHITESPACE","\n            ",507],"}",["T_WHITESPACE","\n\n            ",508],["T_DOC_COMMENT","\/**\n             * Reindex prices if required\n             *\/",510],["T_WHITESPACE","\n            ",512],["T_IF","if",513],["T_WHITESPACE"," ",513],"(",["T_STRING","count",513],"(",["T_VARIABLE","$prices",513],")",")",["T_WHITESPACE"," ",513],"{",["T_WHITESPACE","\n                ",513],["T_VARIABLE","$this",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","_getResource",514],"(",")",["T_OBJECT_OPERATOR","->",514],["T_STRING","reindexPrices",514],"(",["T_VARIABLE","$stepData",514],",",["T_WHITESPACE"," ",514],["T_VARIABLE","$prices",514],",",["T_WHITESPACE"," ",514],["T_VARIABLE","$store",514],")",";",["T_WHITESPACE","\n                ",514],["T_VARIABLE","$this",515],["T_OBJECT_OPERATOR","->",515],["T_STRING","_getResource",515],"(",")",["T_OBJECT_OPERATOR","->",515],["T_STRING","reindexTiers",515],"(",["T_VARIABLE","$stepData",515],",",["T_WHITESPACE"," ",515],["T_VARIABLE","$store",515],")",";",["T_WHITESPACE","\n                ",515],["T_VARIABLE","$this",516],["T_OBJECT_OPERATOR","->",516],["T_STRING","_getResource",516],"(",")",["T_OBJECT_OPERATOR","->",516],["T_STRING","reindexMinimalPrices",516],"(",["T_VARIABLE","$stepData",516],",",["T_WHITESPACE"," ",516],["T_VARIABLE","$store",516],")",";",["T_WHITESPACE","\n                ",516],["T_VARIABLE","$this",517],["T_OBJECT_OPERATOR","->",517],["T_STRING","_getResource",517],"(",")",["T_OBJECT_OPERATOR","->",517],["T_STRING","reindexFinalPrices",517],"(",["T_VARIABLE","$stepData",517],",",["T_WHITESPACE"," ",517],["T_VARIABLE","$store",517],")",";",["T_WHITESPACE","\n            ",517],"}",["T_WHITESPACE","\n\n            ",518],["T_STRING","Mage",520],["T_DOUBLE_COLON","::",520],["T_STRING","getResourceSingleton",520],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",520],")",["T_OBJECT_OPERATOR","->",520],["T_STRING","refreshEnabledIndex",520],"(",["T_VARIABLE","$store",520],",",["T_WHITESPACE"," ",520],["T_VARIABLE","$stepData",520],")",";",["T_WHITESPACE","\n\n            ",520],["T_VARIABLE","$kill",522],["T_WHITESPACE"," ",522],"=",["T_WHITESPACE"," ",522],["T_STRING","Mage",522],["T_DOUBLE_COLON","::",522],["T_STRING","getModel",522],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogindex\/catalog_index_kill_flag'",522],")",["T_OBJECT_OPERATOR","->",522],["T_STRING","loadSelf",522],"(",")",";",["T_WHITESPACE","\n            ",522],["T_IF","if",523],["T_WHITESPACE"," ",523],"(",["T_VARIABLE","$kill",523],["T_OBJECT_OPERATOR","->",523],["T_STRING","checkIsThisProcess",523],"(",")",")",["T_WHITESPACE"," ",523],"{",["T_WHITESPACE","\n                ",523],["T_VARIABLE","$this",524],["T_OBJECT_OPERATOR","->",524],["T_STRING","_getResource",524],"(",")",["T_OBJECT_OPERATOR","->",524],["T_STRING","rollBack",524],"(",")",";",["T_WHITESPACE","\n                ",524],["T_VARIABLE","$kill",525],["T_OBJECT_OPERATOR","->",525],["T_STRING","delete",525],"(",")",";",["T_WHITESPACE","\n            ",525],"}",["T_WHITESPACE"," ",526],["T_ELSE","else",526],["T_WHITESPACE"," ",526],"{",["T_WHITESPACE","\n                ",526],["T_VARIABLE","$this",527],["T_OBJECT_OPERATOR","->",527],["T_STRING","_getResource",527],"(",")",["T_OBJECT_OPERATOR","->",527],["T_STRING","commit",527],"(",")",";",["T_WHITESPACE","\n            ",527],"}",["T_WHITESPACE","\n        ",528],"}",["T_WHITESPACE","\n        ",529],["T_RETURN","return",530],["T_WHITESPACE"," ",530],["T_VARIABLE","$this",530],";",["T_WHITESPACE","\n    ",530],"}",["T_WHITESPACE","\n\n    ",531],["T_DOC_COMMENT","\/**\n     * Retrieve Data retreiver\n     *\n     * @param string $type\n     * @return Mage_CatalogIndex_Model_Data_Abstract\n     *\/",533],["T_WHITESPACE","\n    ",538],["T_PUBLIC","public",539],["T_WHITESPACE"," ",539],["T_FUNCTION","function",539],["T_WHITESPACE"," ",539],["T_STRING","getRetreiver",539],"(",["T_VARIABLE","$type",539],")",["T_WHITESPACE","\n    ",539],"{",["T_WHITESPACE","\n        ",540],["T_RETURN","return",541],["T_WHITESPACE"," ",541],["T_STRING","Mage",541],["T_DOUBLE_COLON","::",541],["T_STRING","getSingleton",541],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogindex\/retreiver'",541],")",["T_OBJECT_OPERATOR","->",541],["T_STRING","getRetreiver",541],"(",["T_VARIABLE","$type",541],")",";",["T_WHITESPACE","\n    ",541],"}",["T_WHITESPACE","\n\n    ",542],["T_DOC_COMMENT","\/**\n     * Set CatalogIndex Flag as queue Indexing\n     *\n     * @return Mage_CatalogIndex_Model_Indexer\n     *\/",544],["T_WHITESPACE","\n    ",548],["T_PUBLIC","public",549],["T_WHITESPACE"," ",549],["T_FUNCTION","function",549],["T_WHITESPACE"," ",549],["T_STRING","queueIndexing",549],"(",")",["T_WHITESPACE","\n    ",549],"{",["T_WHITESPACE","\n        ",550],["T_STRING","Mage",551],["T_DOUBLE_COLON","::",551],["T_STRING","getModel",551],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogindex\/catalog_index_flag'",551],")",["T_WHITESPACE","\n            ",551],["T_OBJECT_OPERATOR","->",552],["T_STRING","loadSelf",552],"(",")",["T_WHITESPACE","\n            ",552],["T_OBJECT_OPERATOR","->",553],["T_STRING","setState",553],"(",["T_STRING","Mage_CatalogIndex_Model_Catalog_Index_Flag",553],["T_DOUBLE_COLON","::",553],["T_STRING","STATE_QUEUED",553],")",["T_WHITESPACE","\n            ",553],["T_OBJECT_OPERATOR","->",554],["T_STRING","save",554],"(",")",";",["T_WHITESPACE","\n\n        ",554],["T_RETURN","return",556],["T_WHITESPACE"," ",556],["T_VARIABLE","$this",556],";",["T_WHITESPACE","\n    ",556],"}",["T_WHITESPACE","\n\n    ",557],["T_DOC_COMMENT","\/**\n     * Get product types list by type priority\n     * type priority is important in index process\n     * example: before indexing complex (configurable, grouped etc.) products\n     * we have to index all simple products\n     *\n     * @return array\n     *\/",559],["T_WHITESPACE","\n    ",566],["T_PROTECTED","protected",567],["T_WHITESPACE"," ",567],["T_FUNCTION","function",567],["T_WHITESPACE"," ",567],["T_STRING","_getPriorifiedProductTypes",567],"(",")",["T_WHITESPACE","\n    ",567],"{",["T_WHITESPACE","\n        ",568],["T_IF","if",569],["T_WHITESPACE"," ",569],"(",["T_STRING","is_null",569],"(",["T_VARIABLE","$this",569],["T_OBJECT_OPERATOR","->",569],["T_STRING","_productTypePriority",569],")",")",["T_WHITESPACE"," ",569],"{",["T_WHITESPACE","\n            ",569],["T_VARIABLE","$this",570],["T_OBJECT_OPERATOR","->",570],["T_STRING","_productTypePriority",570],["T_WHITESPACE"," ",570],"=",["T_WHITESPACE"," ",570],["T_ARRAY","array",570],"(",")",";",["T_WHITESPACE","\n            ",570],["T_VARIABLE","$config",571],["T_WHITESPACE"," ",571],"=",["T_WHITESPACE"," ",571],["T_STRING","Mage",571],["T_DOUBLE_COLON","::",571],["T_STRING","getConfig",571],"(",")",["T_OBJECT_OPERATOR","->",571],["T_STRING","getNode",571],"(",["T_CONSTANT_ENCAPSED_STRING","'global\/catalog\/product\/type'",571],")",";",["T_WHITESPACE","\n\n            ",571],["T_FOREACH","foreach",573],["T_WHITESPACE"," ",573],"(",["T_VARIABLE","$config",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","children",573],"(",")",["T_WHITESPACE"," ",573],["T_AS","as",573],["T_WHITESPACE"," ",573],["T_VARIABLE","$type",573],")",["T_WHITESPACE"," ",573],"{",["T_WHITESPACE","\n                ",573],["T_VARIABLE","$typeName",574],["T_WHITESPACE"," ",574],"=",["T_WHITESPACE"," ",574],["T_VARIABLE","$type",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","getName",574],"(",")",";",["T_WHITESPACE","\n                ",574],["T_VARIABLE","$typePriority",575],["T_WHITESPACE"," ",575],"=",["T_WHITESPACE"," ",575],["T_STRING_CAST","(string)",575],["T_WHITESPACE"," ",575],["T_VARIABLE","$type",575],["T_OBJECT_OPERATOR","->",575],["T_STRING","index_priority",575],";",["T_WHITESPACE","\n                ",575],["T_VARIABLE","$this",576],["T_OBJECT_OPERATOR","->",576],["T_STRING","_productTypePriority",576],"[",["T_VARIABLE","$typePriority",576],"]",["T_WHITESPACE"," ",576],"=",["T_WHITESPACE"," ",576],["T_VARIABLE","$typeName",576],";",["T_WHITESPACE","\n            ",576],"}",["T_WHITESPACE","\n            ",577],["T_STRING","ksort",578],"(",["T_VARIABLE","$this",578],["T_OBJECT_OPERATOR","->",578],["T_STRING","_productTypePriority",578],")",";",["T_WHITESPACE","\n        ",578],"}",["T_WHITESPACE","\n        ",579],["T_RETURN","return",580],["T_WHITESPACE"," ",580],["T_VARIABLE","$this",580],["T_OBJECT_OPERATOR","->",580],["T_STRING","_productTypePriority",580],";",["T_WHITESPACE","\n    ",580],"}",["T_WHITESPACE","\n\n    ",581],["T_DOC_COMMENT","\/**\n     * Retrieve Base to Specified Currency Rate\n     *\n     * @param string $code\n     * @return double\n     *\/",583],["T_WHITESPACE","\n    ",588],["T_PROTECTED","protected",589],["T_WHITESPACE"," ",589],["T_FUNCTION","function",589],["T_WHITESPACE"," ",589],["T_STRING","_getBaseToSpecifiedCurrencyRate",589],"(",["T_VARIABLE","$code",589],")",["T_WHITESPACE","\n    ",589],"{",["T_WHITESPACE","\n        ",590],["T_RETURN","return",591],["T_WHITESPACE"," ",591],["T_STRING","Mage",591],["T_DOUBLE_COLON","::",591],["T_STRING","app",591],"(",")",["T_OBJECT_OPERATOR","->",591],["T_STRING","getStore",591],"(",")",["T_OBJECT_OPERATOR","->",591],["T_STRING","getBaseCurrency",591],"(",")",["T_OBJECT_OPERATOR","->",591],["T_STRING","getRate",591],"(",["T_VARIABLE","$code",591],")",";",["T_WHITESPACE","\n    ",591],"}",["T_WHITESPACE","\n\n    ",592],["T_DOC_COMMENT","\/**\n     * Build Entity price filter\n     *\n     * @param array $attributes\n     * @param array $values\n     * @param array $filteredAttributes\n     * @param Mage_Catalog_Model_Resource_Eav_Mysql4_Product_Collection $productCollection\n     * @return array\n     *\/",594],["T_WHITESPACE","\n    ",602],["T_PUBLIC","public",603],["T_WHITESPACE"," ",603],["T_FUNCTION","function",603],["T_WHITESPACE"," ",603],["T_STRING","buildEntityPriceFilter",603],"(",["T_VARIABLE","$attributes",603],",",["T_WHITESPACE"," ",603],["T_VARIABLE","$values",603],",",["T_WHITESPACE"," ",603],"&",["T_VARIABLE","$filteredAttributes",603],",",["T_WHITESPACE"," ",603],["T_VARIABLE","$productCollection",603],")",["T_WHITESPACE","\n    ",603],"{",["T_WHITESPACE","\n        ",604],["T_VARIABLE","$additionalCalculations",605],["T_WHITESPACE"," ",605],"=",["T_WHITESPACE"," ",605],["T_ARRAY","array",605],"(",")",";",["T_WHITESPACE","\n        ",605],["T_VARIABLE","$filter",606],["T_WHITESPACE"," ",606],"=",["T_WHITESPACE"," ",606],["T_ARRAY","array",606],"(",")",";",["T_WHITESPACE","\n        ",606],["T_VARIABLE","$store",607],["T_WHITESPACE"," ",607],"=",["T_WHITESPACE"," ",607],["T_STRING","Mage",607],["T_DOUBLE_COLON","::",607],["T_STRING","app",607],"(",")",["T_OBJECT_OPERATOR","->",607],["T_STRING","getStore",607],"(",")",["T_OBJECT_OPERATOR","->",607],["T_STRING","getId",607],"(",")",";",["T_WHITESPACE","\n        ",607],["T_VARIABLE","$website",608],["T_WHITESPACE"," ",608],"=",["T_WHITESPACE"," ",608],["T_STRING","Mage",608],["T_DOUBLE_COLON","::",608],["T_STRING","app",608],"(",")",["T_OBJECT_OPERATOR","->",608],["T_STRING","getStore",608],"(",")",["T_OBJECT_OPERATOR","->",608],["T_STRING","getWebsiteId",608],"(",")",";",["T_WHITESPACE","\n\n        ",608],["T_VARIABLE","$currentStoreCurrency",610],["T_WHITESPACE"," ",610],"=",["T_WHITESPACE"," ",610],["T_STRING","Mage",610],["T_DOUBLE_COLON","::",610],["T_STRING","app",610],"(",")",["T_OBJECT_OPERATOR","->",610],["T_STRING","getStore",610],"(",")",["T_OBJECT_OPERATOR","->",610],["T_STRING","getCurrentCurrencyCode",610],"(",")",";",["T_WHITESPACE","\n\n        ",610],["T_FOREACH","foreach",612],["T_WHITESPACE"," ",612],"(",["T_VARIABLE","$attributes",612],["T_WHITESPACE"," ",612],["T_AS","as",612],["T_WHITESPACE"," ",612],["T_VARIABLE","$attribute",612],")",["T_WHITESPACE"," ",612],"{",["T_WHITESPACE","\n            ",612],["T_VARIABLE","$code",613],["T_WHITESPACE"," ",613],"=",["T_WHITESPACE"," ",613],["T_VARIABLE","$attribute",613],["T_OBJECT_OPERATOR","->",613],["T_STRING","getAttributeCode",613],"(",")",";",["T_WHITESPACE","\n            ",613],["T_IF","if",614],["T_WHITESPACE"," ",614],"(",["T_ISSET","isset",614],"(",["T_VARIABLE","$values",614],"[",["T_VARIABLE","$code",614],"]",")",")",["T_WHITESPACE"," ",614],"{",["T_WHITESPACE","\n                ",614],["T_FOREACH","foreach",615],["T_WHITESPACE"," ",615],"(",["T_VARIABLE","$this",615],["T_OBJECT_OPERATOR","->",615],["T_STRING","_priceIndexers",615],["T_WHITESPACE"," ",615],["T_AS","as",615],["T_WHITESPACE"," ",615],["T_VARIABLE","$indexerName",615],")",["T_WHITESPACE"," ",615],"{",["T_WHITESPACE","\n                    ",615],["T_VARIABLE","$indexer",616],["T_WHITESPACE"," ",616],"=",["T_WHITESPACE"," ",616],["T_VARIABLE","$this",616],["T_OBJECT_OPERATOR","->",616],["T_STRING","_indexers",616],"[",["T_VARIABLE","$indexerName",616],"]",";",["T_WHITESPACE","\n                    ",616],["T_COMMENT","\/* @var $indexer Mage_CatalogIndex_Model_Indexer_Abstract *\/",617],["T_WHITESPACE","\n                    ",617],["T_IF","if",618],["T_WHITESPACE"," ",618],"(",["T_VARIABLE","$indexer",618],["T_OBJECT_OPERATOR","->",618],["T_STRING","isAttributeIndexable",618],"(",["T_VARIABLE","$attribute",618],")",")",["T_WHITESPACE"," ",618],"{",["T_WHITESPACE","\n                        ",618],["T_IF","if",619],["T_WHITESPACE"," ",619],"(",["T_VARIABLE","$values",619],"[",["T_VARIABLE","$code",619],"]",")",["T_WHITESPACE"," ",619],"{",["T_WHITESPACE","\n                            ",619],["T_IF","if",620],["T_WHITESPACE"," ",620],"(",["T_ISSET","isset",620],"(",["T_VARIABLE","$values",620],"[",["T_VARIABLE","$code",620],"]","[",["T_CONSTANT_ENCAPSED_STRING","'from'",620],"]",")",["T_WHITESPACE"," ",620],["T_BOOLEAN_AND","&&",620],["T_WHITESPACE"," ",620],["T_ISSET","isset",620],"(",["T_VARIABLE","$values",620],"[",["T_VARIABLE","$code",620],"]","[",["T_CONSTANT_ENCAPSED_STRING","'to'",620],"]",")",["T_WHITESPACE","\n                                ",620],["T_BOOLEAN_AND","&&",621],["T_WHITESPACE"," ",621],"(",["T_STRING","strlen",621],"(",["T_VARIABLE","$values",621],"[",["T_VARIABLE","$code",621],"]","[",["T_CONSTANT_ENCAPSED_STRING","'from'",621],"]",")",["T_WHITESPACE"," ",621],["T_IS_EQUAL","==",621],["T_WHITESPACE"," ",621],["T_LNUMBER","0",621],["T_WHITESPACE"," ",621],["T_BOOLEAN_AND","&&",621],["T_WHITESPACE"," ",621],["T_STRING","strlen",621],"(",["T_VARIABLE","$values",621],"[",["T_VARIABLE","$code",621],"]","[",["T_CONSTANT_ENCAPSED_STRING","'to'",621],"]",")",["T_WHITESPACE"," ",621],["T_IS_EQUAL","==",621],["T_WHITESPACE"," ",621],["T_LNUMBER","0",621],")",")",["T_WHITESPACE"," ",621],"{",["T_WHITESPACE","\n                                ",621],["T_CONTINUE","continue",622],";",["T_WHITESPACE","\n                            ",622],"}",["T_WHITESPACE","\n                            ",623],["T_VARIABLE","$table",624],["T_WHITESPACE"," ",624],"=",["T_WHITESPACE"," ",624],["T_VARIABLE","$indexer",624],["T_OBJECT_OPERATOR","->",624],["T_STRING","getResource",624],"(",")",["T_OBJECT_OPERATOR","->",624],["T_STRING","getMainTable",624],"(",")",";",["T_WHITESPACE","\n                            ",624],["T_IF","if",625],["T_WHITESPACE"," ",625],"(","!",["T_ISSET","isset",625],"(",["T_VARIABLE","$filter",625],"[",["T_VARIABLE","$code",625],"]",")",")",["T_WHITESPACE"," ",625],"{",["T_WHITESPACE","\n                                ",625],["T_VARIABLE","$filter",626],"[",["T_VARIABLE","$code",626],"]",["T_WHITESPACE"," ",626],"=",["T_WHITESPACE"," ",626],["T_VARIABLE","$this",626],["T_OBJECT_OPERATOR","->",626],["T_STRING","_getSelect",626],"(",")",";",["T_WHITESPACE","\n                                ",626],["T_VARIABLE","$filter",627],"[",["T_VARIABLE","$code",627],"]",["T_OBJECT_OPERATOR","->",627],["T_STRING","from",627],"(",["T_VARIABLE","$table",627],",",["T_WHITESPACE"," ",627],["T_ARRAY","array",627],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",627],")",")",";",["T_WHITESPACE","\n                                ",627],["T_VARIABLE","$filter",628],"[",["T_VARIABLE","$code",628],"]",["T_OBJECT_OPERATOR","->",628],["T_STRING","distinct",628],"(",["T_STRING","true",628],")",";",["T_WHITESPACE","\n\n                                ",628],["T_VARIABLE","$response",630],["T_WHITESPACE"," ",630],"=",["T_WHITESPACE"," ",630],["T_NEW","new",630],["T_WHITESPACE"," ",630],["T_STRING","Varien_Object",630],"(",")",";",["T_WHITESPACE","\n                                ",630],["T_VARIABLE","$response",631],["T_OBJECT_OPERATOR","->",631],["T_STRING","setAdditionalCalculations",631],"(",["T_ARRAY","array",631],"(",")",")",";",["T_WHITESPACE","\n                                ",631],["T_VARIABLE","$args",632],["T_WHITESPACE"," ",632],"=",["T_WHITESPACE"," ",632],["T_ARRAY","array",632],"(",["T_WHITESPACE","\n                                    ",632],["T_CONSTANT_ENCAPSED_STRING","'select'",633],["T_DOUBLE_ARROW","=>",633],["T_VARIABLE","$filter",633],"[",["T_VARIABLE","$code",633],"]",",",["T_WHITESPACE","\n                                    ",633],["T_CONSTANT_ENCAPSED_STRING","'table'",634],["T_DOUBLE_ARROW","=>",634],["T_VARIABLE","$table",634],",",["T_WHITESPACE","\n                                    ",634],["T_CONSTANT_ENCAPSED_STRING","'store_id'",635],["T_DOUBLE_ARROW","=>",635],["T_VARIABLE","$store",635],",",["T_WHITESPACE","\n                                    ",635],["T_CONSTANT_ENCAPSED_STRING","'response_object'",636],["T_DOUBLE_ARROW","=>",636],["T_VARIABLE","$response",636],",",["T_WHITESPACE","\n                                ",636],")",";",["T_WHITESPACE","\n                                ",637],["T_STRING","Mage",638],["T_DOUBLE_COLON","::",638],["T_STRING","dispatchEvent",638],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogindex_prepare_price_select'",638],",",["T_WHITESPACE"," ",638],["T_VARIABLE","$args",638],")",";",["T_WHITESPACE","\n                                ",638],["T_VARIABLE","$additionalCalculations",639],"[",["T_VARIABLE","$code",639],"]",["T_WHITESPACE"," ",639],"=",["T_WHITESPACE"," ",639],["T_VARIABLE","$response",639],["T_OBJECT_OPERATOR","->",639],["T_STRING","getAdditionalCalculations",639],"(",")",";",["T_WHITESPACE","\n\n                                ",639],["T_IF","if",641],["T_WHITESPACE"," ",641],"(",["T_VARIABLE","$indexer",641],["T_OBJECT_OPERATOR","->",641],["T_STRING","isAttributeIdUsed",641],"(",")",")",["T_WHITESPACE"," ",641],"{",["T_WHITESPACE","\n                                    ",641],["T_COMMENT","\/\/$filter[$code]->where(\"$table.attribute_id = ?\", $attribute->getId());\n",642],["T_WHITESPACE","                                ",643],"}",["T_WHITESPACE","\n                            ",643],"}",["T_WHITESPACE","\n                            ",644],["T_IF","if",645],["T_WHITESPACE"," ",645],"(",["T_STRING","is_array",645],"(",["T_VARIABLE","$values",645],"[",["T_VARIABLE","$code",645],"]",")",")",["T_WHITESPACE"," ",645],"{",["T_WHITESPACE","\n                                ",645],["T_VARIABLE","$rateConversion",646],["T_WHITESPACE"," ",646],"=",["T_WHITESPACE"," ",646],["T_LNUMBER","1",646],";",["T_WHITESPACE","\n                                ",646],["T_VARIABLE","$filter",647],"[",["T_VARIABLE","$code",647],"]",["T_OBJECT_OPERATOR","->",647],["T_STRING","distinct",647],"(",["T_STRING","true",647],")",";",["T_WHITESPACE","\n\n                                ",647],["T_IF","if",649],["T_WHITESPACE"," ",649],"(",["T_ISSET","isset",649],"(",["T_VARIABLE","$values",649],"[",["T_VARIABLE","$code",649],"]","[",["T_CONSTANT_ENCAPSED_STRING","'from'",649],"]",")",["T_WHITESPACE"," ",649],["T_BOOLEAN_AND","&&",649],["T_WHITESPACE"," ",649],["T_ISSET","isset",649],"(",["T_VARIABLE","$values",649],"[",["T_VARIABLE","$code",649],"]","[",["T_CONSTANT_ENCAPSED_STRING","'to'",649],"]",")",")",["T_WHITESPACE"," ",649],"{",["T_WHITESPACE","\n                                    ",649],["T_IF","if",650],["T_WHITESPACE"," ",650],"(",["T_ISSET","isset",650],"(",["T_VARIABLE","$values",650],"[",["T_VARIABLE","$code",650],"]","[",["T_CONSTANT_ENCAPSED_STRING","'currency'",650],"]",")",")",["T_WHITESPACE"," ",650],"{",["T_WHITESPACE","\n                                        ",650],["T_VARIABLE","$rateConversion",651],["T_WHITESPACE"," ",651],"=",["T_WHITESPACE"," ",651],["T_VARIABLE","$this",651],["T_OBJECT_OPERATOR","->",651],["T_STRING","_getBaseToSpecifiedCurrencyRate",651],"(",["T_WHITESPACE","\n                                            ",651],["T_VARIABLE","$values",652],"[",["T_VARIABLE","$code",652],"]","[",["T_CONSTANT_ENCAPSED_STRING","'currency'",652],"]",["T_WHITESPACE","\n                                        ",652],")",";",["T_WHITESPACE","\n                                    ",653],"}",["T_WHITESPACE"," ",654],["T_ELSE","else",654],["T_WHITESPACE"," ",654],"{",["T_WHITESPACE","\n                                        ",654],["T_VARIABLE","$rateConversion",655],["T_WHITESPACE"," ",655],"=",["T_WHITESPACE"," ",655],["T_VARIABLE","$this",655],["T_OBJECT_OPERATOR","->",655],["T_STRING","_getBaseToSpecifiedCurrencyRate",655],"(",["T_VARIABLE","$currentStoreCurrency",655],")",";",["T_WHITESPACE","\n                                    ",655],"}",["T_WHITESPACE","\n\n                                    ",656],["T_IF","if",658],["T_WHITESPACE"," ",658],"(",["T_STRING","strlen",658],"(",["T_VARIABLE","$values",658],"[",["T_VARIABLE","$code",658],"]","[",["T_CONSTANT_ENCAPSED_STRING","'from'",658],"]",")",["T_WHITESPACE"," ",658],">",["T_WHITESPACE"," ",658],["T_LNUMBER","0",658],")",["T_WHITESPACE"," ",658],"{",["T_WHITESPACE","\n                                        ",658],["T_VARIABLE","$filter",659],"[",["T_VARIABLE","$code",659],"]",["T_OBJECT_OPERATOR","->",659],["T_STRING","where",659],"(",["T_WHITESPACE","\n                                            ",659],"\"",["T_ENCAPSED_AND_WHITESPACE","(",660],["T_VARIABLE","$table",660],["T_ENCAPSED_AND_WHITESPACE",".min_price",660],"\"",["T_WHITESPACE","\n                                            ",660],".",["T_WHITESPACE"," ",661],["T_STRING","implode",661],"(",["T_CONSTANT_ENCAPSED_STRING","''",661],",",["T_WHITESPACE"," ",661],["T_VARIABLE","$additionalCalculations",661],"[",["T_VARIABLE","$code",661],"]",")",".","\"",["T_ENCAPSED_AND_WHITESPACE",")*",661],["T_CURLY_OPEN","{",661],["T_VARIABLE","$rateConversion",661],"}",["T_ENCAPSED_AND_WHITESPACE"," >= ?",661],"\"",",",["T_WHITESPACE","\n                                            ",661],["T_VARIABLE","$values",662],"[",["T_VARIABLE","$code",662],"]","[",["T_CONSTANT_ENCAPSED_STRING","'from'",662],"]",["T_WHITESPACE","\n                                        ",662],")",";",["T_WHITESPACE","\n                                    ",663],"}",["T_WHITESPACE","\n\n                                    ",664],["T_IF","if",666],["T_WHITESPACE"," ",666],"(",["T_STRING","strlen",666],"(",["T_VARIABLE","$values",666],"[",["T_VARIABLE","$code",666],"]","[",["T_CONSTANT_ENCAPSED_STRING","'to'",666],"]",")",["T_WHITESPACE"," ",666],">",["T_WHITESPACE"," ",666],["T_LNUMBER","0",666],")",["T_WHITESPACE"," ",666],"{",["T_WHITESPACE","\n                                        ",666],["T_VARIABLE","$filter",667],"[",["T_VARIABLE","$code",667],"]",["T_OBJECT_OPERATOR","->",667],["T_STRING","where",667],"(",["T_WHITESPACE","\n                                            ",667],"\"",["T_ENCAPSED_AND_WHITESPACE","(",668],["T_VARIABLE","$table",668],["T_ENCAPSED_AND_WHITESPACE",".min_price",668],"\"",["T_WHITESPACE","\n                                            ",668],".",["T_WHITESPACE"," ",669],["T_STRING","implode",669],"(",["T_CONSTANT_ENCAPSED_STRING","''",669],",",["T_WHITESPACE"," ",669],["T_VARIABLE","$additionalCalculations",669],"[",["T_VARIABLE","$code",669],"]",")",".","\"",["T_ENCAPSED_AND_WHITESPACE",")*",669],["T_CURLY_OPEN","{",669],["T_VARIABLE","$rateConversion",669],"}",["T_ENCAPSED_AND_WHITESPACE"," <= ?",669],"\"",",",["T_WHITESPACE","\n                                            ",669],["T_VARIABLE","$values",670],"[",["T_VARIABLE","$code",670],"]","[",["T_CONSTANT_ENCAPSED_STRING","'to'",670],"]",["T_WHITESPACE","\n                                        ",670],")",";",["T_WHITESPACE","\n                                    ",671],"}",["T_WHITESPACE","\n                                ",672],"}",["T_WHITESPACE","\n                            ",673],"}",["T_WHITESPACE","\n                            ",674],["T_VARIABLE","$filter",675],"[",["T_VARIABLE","$code",675],"]",["T_OBJECT_OPERATOR","->",675],["T_STRING","where",675],"(","\"",["T_VARIABLE","$table",675],["T_ENCAPSED_AND_WHITESPACE",".website_id = ?",675],"\"",",",["T_WHITESPACE"," ",675],["T_VARIABLE","$website",675],")",";",["T_WHITESPACE","\n\n                            ",675],["T_IF","if",677],["T_WHITESPACE"," ",677],"(",["T_VARIABLE","$code",677],["T_WHITESPACE"," ",677],["T_IS_EQUAL","==",677],["T_WHITESPACE"," ",677],["T_CONSTANT_ENCAPSED_STRING","'price'",677],")",["T_WHITESPACE"," ",677],"{",["T_WHITESPACE","\n                                ",677],["T_VARIABLE","$filter",678],"[",["T_VARIABLE","$code",678],"]",["T_OBJECT_OPERATOR","->",678],["T_STRING","where",678],"(",["T_WHITESPACE","\n                                    ",678],["T_VARIABLE","$table",679],["T_WHITESPACE"," ",679],".",["T_WHITESPACE"," ",679],["T_CONSTANT_ENCAPSED_STRING","'.customer_group_id = ?'",679],",",["T_WHITESPACE","\n                                    ",679],["T_STRING","Mage",680],["T_DOUBLE_COLON","::",680],["T_STRING","getSingleton",680],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",680],")",["T_OBJECT_OPERATOR","->",680],["T_STRING","getCustomerGroupId",680],"(",")",["T_WHITESPACE","\n                                ",680],")",";",["T_WHITESPACE","\n                            ",681],"}",["T_WHITESPACE","\n\n                            ",682],["T_VARIABLE","$filteredAttributes",684],"[","]","=",["T_VARIABLE","$code",684],";",["T_WHITESPACE","\n                        ",684],"}",["T_WHITESPACE","\n                    ",685],"}",["T_WHITESPACE","\n                ",686],"}",["T_WHITESPACE","\n            ",687],"}",["T_WHITESPACE","\n        ",688],"}",["T_WHITESPACE","\n        ",689],["T_RETURN","return",690],["T_WHITESPACE"," ",690],["T_VARIABLE","$filter",690],";",["T_WHITESPACE","\n    ",690],"}",["T_WHITESPACE","\n\n    ",691],["T_DOC_COMMENT","\/**\n     * Build Entity filter\n     *\n     * @param array $attributes\n     * @param array $values\n     * @param array $filteredAttributes\n     * @param Mage_Catalog_Model_Resource_Eav_Mysql4_Product_Collection $productCollection\n     * @return array\n     *\/",693],["T_WHITESPACE","\n    ",701],["T_PUBLIC","public",702],["T_WHITESPACE"," ",702],["T_FUNCTION","function",702],["T_WHITESPACE"," ",702],["T_STRING","buildEntityFilter",702],"(",["T_VARIABLE","$attributes",702],",",["T_WHITESPACE"," ",702],["T_VARIABLE","$values",702],",",["T_WHITESPACE"," ",702],"&",["T_VARIABLE","$filteredAttributes",702],",",["T_WHITESPACE"," ",702],["T_VARIABLE","$productCollection",702],")",["T_WHITESPACE","\n    ",702],"{",["T_WHITESPACE","\n        ",703],["T_VARIABLE","$filter",704],["T_WHITESPACE"," ",704],"=",["T_WHITESPACE"," ",704],["T_ARRAY","array",704],"(",")",";",["T_WHITESPACE","\n        ",704],["T_VARIABLE","$store",705],["T_WHITESPACE"," ",705],"=",["T_WHITESPACE"," ",705],["T_STRING","Mage",705],["T_DOUBLE_COLON","::",705],["T_STRING","app",705],"(",")",["T_OBJECT_OPERATOR","->",705],["T_STRING","getStore",705],"(",")",["T_OBJECT_OPERATOR","->",705],["T_STRING","getId",705],"(",")",";",["T_WHITESPACE","\n\n        ",705],["T_FOREACH","foreach",707],["T_WHITESPACE"," ",707],"(",["T_VARIABLE","$attributes",707],["T_WHITESPACE"," ",707],["T_AS","as",707],["T_WHITESPACE"," ",707],["T_VARIABLE","$attribute",707],")",["T_WHITESPACE"," ",707],"{",["T_WHITESPACE","\n            ",707],["T_VARIABLE","$code",708],["T_WHITESPACE"," ",708],"=",["T_WHITESPACE"," ",708],["T_VARIABLE","$attribute",708],["T_OBJECT_OPERATOR","->",708],["T_STRING","getAttributeCode",708],"(",")",";",["T_WHITESPACE","\n            ",708],["T_IF","if",709],["T_WHITESPACE"," ",709],"(",["T_ISSET","isset",709],"(",["T_VARIABLE","$values",709],"[",["T_VARIABLE","$code",709],"]",")",")",["T_WHITESPACE"," ",709],"{",["T_WHITESPACE","\n                ",709],["T_FOREACH","foreach",710],["T_WHITESPACE"," ",710],"(",["T_VARIABLE","$this",710],["T_OBJECT_OPERATOR","->",710],["T_STRING","_attributeIndexers",710],["T_WHITESPACE"," ",710],["T_AS","as",710],["T_WHITESPACE"," ",710],["T_VARIABLE","$indexerName",710],")",["T_WHITESPACE"," ",710],"{",["T_WHITESPACE","\n                    ",710],["T_VARIABLE","$indexer",711],["T_WHITESPACE"," ",711],"=",["T_WHITESPACE"," ",711],["T_VARIABLE","$this",711],["T_OBJECT_OPERATOR","->",711],["T_STRING","_indexers",711],"[",["T_VARIABLE","$indexerName",711],"]",";",["T_WHITESPACE","\n                    ",711],["T_COMMENT","\/* @var $indexer Mage_CatalogIndex_Model_Indexer_Abstract *\/",712],["T_WHITESPACE","\n                    ",712],["T_IF","if",713],["T_WHITESPACE"," ",713],"(",["T_VARIABLE","$indexer",713],["T_OBJECT_OPERATOR","->",713],["T_STRING","isAttributeIndexable",713],"(",["T_VARIABLE","$attribute",713],")",")",["T_WHITESPACE"," ",713],"{",["T_WHITESPACE","\n                        ",713],["T_IF","if",714],["T_WHITESPACE"," ",714],"(",["T_VARIABLE","$values",714],"[",["T_VARIABLE","$code",714],"]",")",["T_WHITESPACE"," ",714],"{",["T_WHITESPACE","\n                            ",714],["T_IF","if",715],["T_WHITESPACE"," ",715],"(",["T_ISSET","isset",715],"(",["T_VARIABLE","$values",715],"[",["T_VARIABLE","$code",715],"]","[",["T_CONSTANT_ENCAPSED_STRING","'from'",715],"]",")",["T_WHITESPACE"," ",715],["T_BOOLEAN_AND","&&",715],["T_WHITESPACE"," ",715],["T_ISSET","isset",715],"(",["T_VARIABLE","$values",715],"[",["T_VARIABLE","$code",715],"]","[",["T_CONSTANT_ENCAPSED_STRING","'to'",715],"]",")",["T_WHITESPACE","\n                                ",715],["T_BOOLEAN_AND","&&",716],["T_WHITESPACE"," ",716],"(","!",["T_VARIABLE","$values",716],"[",["T_VARIABLE","$code",716],"]","[",["T_CONSTANT_ENCAPSED_STRING","'from'",716],"]",["T_WHITESPACE"," ",716],["T_BOOLEAN_AND","&&",716],["T_WHITESPACE"," ",716],"!",["T_VARIABLE","$values",716],"[",["T_VARIABLE","$code",716],"]","[",["T_CONSTANT_ENCAPSED_STRING","'to'",716],"]",")",")",["T_WHITESPACE"," ",716],"{",["T_WHITESPACE","\n                                ",716],["T_CONTINUE","continue",717],";",["T_WHITESPACE","\n                            ",717],"}",["T_WHITESPACE","\n\n                            ",718],["T_VARIABLE","$table",720],["T_WHITESPACE"," ",720],"=",["T_WHITESPACE"," ",720],["T_VARIABLE","$indexer",720],["T_OBJECT_OPERATOR","->",720],["T_STRING","getResource",720],"(",")",["T_OBJECT_OPERATOR","->",720],["T_STRING","getMainTable",720],"(",")",";",["T_WHITESPACE","\n                            ",720],["T_IF","if",721],["T_WHITESPACE"," ",721],"(","!",["T_ISSET","isset",721],"(",["T_VARIABLE","$filter",721],"[",["T_VARIABLE","$code",721],"]",")",")",["T_WHITESPACE"," ",721],"{",["T_WHITESPACE","\n                                ",721],["T_VARIABLE","$filter",722],"[",["T_VARIABLE","$code",722],"]",["T_WHITESPACE"," ",722],"=",["T_WHITESPACE"," ",722],["T_VARIABLE","$this",722],["T_OBJECT_OPERATOR","->",722],["T_STRING","_getSelect",722],"(",")",";",["T_WHITESPACE","\n                                ",722],["T_VARIABLE","$filter",723],"[",["T_VARIABLE","$code",723],"]",["T_OBJECT_OPERATOR","->",723],["T_STRING","from",723],"(",["T_VARIABLE","$table",723],",",["T_WHITESPACE"," ",723],["T_ARRAY","array",723],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",723],")",")",";",["T_WHITESPACE","\n                            ",723],"}",["T_WHITESPACE","\n                            ",724],["T_IF","if",725],["T_WHITESPACE"," ",725],"(",["T_VARIABLE","$indexer",725],["T_OBJECT_OPERATOR","->",725],["T_STRING","isAttributeIdUsed",725],"(",")",")",["T_WHITESPACE"," ",725],"{",["T_WHITESPACE","\n                                ",725],["T_VARIABLE","$filter",726],"[",["T_VARIABLE","$code",726],"]",["T_OBJECT_OPERATOR","->",726],["T_STRING","where",726],"(",["T_CONSTANT_ENCAPSED_STRING","'attribute_id = ?'",726],",",["T_WHITESPACE"," ",726],["T_VARIABLE","$attribute",726],["T_OBJECT_OPERATOR","->",726],["T_STRING","getId",726],"(",")",")",";",["T_WHITESPACE","\n                            ",726],"}",["T_WHITESPACE","\n                            ",727],["T_IF","if",728],["T_WHITESPACE"," ",728],"(",["T_STRING","is_array",728],"(",["T_VARIABLE","$values",728],"[",["T_VARIABLE","$code",728],"]",")",")",["T_WHITESPACE"," ",728],"{",["T_WHITESPACE","\n                                ",728],["T_IF","if",729],["T_WHITESPACE"," ",729],"(",["T_ISSET","isset",729],"(",["T_VARIABLE","$values",729],"[",["T_VARIABLE","$code",729],"]","[",["T_CONSTANT_ENCAPSED_STRING","'from'",729],"]",")",["T_WHITESPACE"," ",729],["T_BOOLEAN_AND","&&",729],["T_WHITESPACE"," ",729],["T_ISSET","isset",729],"(",["T_VARIABLE","$values",729],"[",["T_VARIABLE","$code",729],"]","[",["T_CONSTANT_ENCAPSED_STRING","'to'",729],"]",")",")",["T_WHITESPACE"," ",729],"{",["T_WHITESPACE","\n\n                                    ",729],["T_IF","if",731],["T_WHITESPACE"," ",731],"(",["T_VARIABLE","$values",731],"[",["T_VARIABLE","$code",731],"]","[",["T_CONSTANT_ENCAPSED_STRING","'from'",731],"]",")",["T_WHITESPACE"," ",731],"{",["T_WHITESPACE","\n                                        ",731],["T_IF","if",732],["T_WHITESPACE"," ",732],"(","!",["T_STRING","is_numeric",732],"(",["T_VARIABLE","$values",732],"[",["T_VARIABLE","$code",732],"]","[",["T_CONSTANT_ENCAPSED_STRING","'from'",732],"]",")",")",["T_WHITESPACE"," ",732],"{",["T_WHITESPACE","\n                                            ",732],["T_VARIABLE","$_date",733],["T_WHITESPACE"," ",733],"=",["T_WHITESPACE"," ",733],["T_STRING","date",733],"(",["T_CONSTANT_ENCAPSED_STRING","\"Y-m-d H:i:s\"",733],",",["T_WHITESPACE"," ",733],["T_STRING","strtotime",733],"(",["T_VARIABLE","$values",733],"[",["T_VARIABLE","$code",733],"]","[",["T_CONSTANT_ENCAPSED_STRING","'from'",733],"]",")",")",";",["T_WHITESPACE","\n                                            ",733],["T_VARIABLE","$values",734],"[",["T_VARIABLE","$code",734],"]","[",["T_CONSTANT_ENCAPSED_STRING","'from'",734],"]",["T_WHITESPACE"," ",734],"=",["T_WHITESPACE"," ",734],["T_VARIABLE","$_date",734],";",["T_WHITESPACE","\n                                        ",734],"}",["T_WHITESPACE","\n\n                                        ",735],["T_VARIABLE","$filter",737],"[",["T_VARIABLE","$code",737],"]",["T_OBJECT_OPERATOR","->",737],["T_STRING","where",737],"(",["T_CONSTANT_ENCAPSED_STRING","\"value >= ?\"",737],",",["T_WHITESPACE"," ",737],["T_VARIABLE","$values",737],"[",["T_VARIABLE","$code",737],"]","[",["T_CONSTANT_ENCAPSED_STRING","'from'",737],"]",")",";",["T_WHITESPACE","\n                                    ",737],"}",["T_WHITESPACE","\n\n\n                                    ",738],["T_IF","if",741],["T_WHITESPACE"," ",741],"(",["T_VARIABLE","$values",741],"[",["T_VARIABLE","$code",741],"]","[",["T_CONSTANT_ENCAPSED_STRING","'to'",741],"]",")",["T_WHITESPACE"," ",741],"{",["T_WHITESPACE","\n                                        ",741],["T_IF","if",742],["T_WHITESPACE"," ",742],"(","!",["T_STRING","is_numeric",742],"(",["T_VARIABLE","$values",742],"[",["T_VARIABLE","$code",742],"]","[",["T_CONSTANT_ENCAPSED_STRING","'to'",742],"]",")",")",["T_WHITESPACE"," ",742],"{",["T_WHITESPACE","\n                                            ",742],["T_VARIABLE","$values",743],"[",["T_VARIABLE","$code",743],"]","[",["T_CONSTANT_ENCAPSED_STRING","'to'",743],"]",["T_WHITESPACE"," ",743],"=",["T_WHITESPACE"," ",743],["T_STRING","date",743],"(",["T_CONSTANT_ENCAPSED_STRING","\"Y-m-d H:i:s\"",743],",",["T_WHITESPACE"," ",743],["T_STRING","strtotime",743],"(",["T_VARIABLE","$values",743],"[",["T_VARIABLE","$code",743],"]","[",["T_CONSTANT_ENCAPSED_STRING","'to'",743],"]",")",")",";",["T_WHITESPACE","\n                                        ",743],"}",["T_WHITESPACE","\n                                        ",744],["T_VARIABLE","$filter",745],"[",["T_VARIABLE","$code",745],"]",["T_OBJECT_OPERATOR","->",745],["T_STRING","where",745],"(",["T_CONSTANT_ENCAPSED_STRING","\"value <= ?\"",745],",",["T_WHITESPACE"," ",745],["T_VARIABLE","$values",745],"[",["T_VARIABLE","$code",745],"]","[",["T_CONSTANT_ENCAPSED_STRING","'to'",745],"]",")",";",["T_WHITESPACE","\n                                    ",745],"}",["T_WHITESPACE","\n                                ",746],"}",["T_WHITESPACE"," ",747],["T_ELSE","else",747],["T_WHITESPACE"," ",747],"{",["T_WHITESPACE","\n                                    ",747],["T_VARIABLE","$filter",748],"[",["T_VARIABLE","$code",748],"]",["T_OBJECT_OPERATOR","->",748],["T_STRING","where",748],"(",["T_CONSTANT_ENCAPSED_STRING","'value in (?)'",748],",",["T_WHITESPACE"," ",748],["T_VARIABLE","$values",748],"[",["T_VARIABLE","$code",748],"]",")",";",["T_WHITESPACE","\n                                ",748],"}",["T_WHITESPACE","\n                            ",749],"}",["T_WHITESPACE"," ",750],["T_ELSE","else",750],["T_WHITESPACE"," ",750],"{",["T_WHITESPACE","\n                                ",750],["T_VARIABLE","$filter",751],"[",["T_VARIABLE","$code",751],"]",["T_OBJECT_OPERATOR","->",751],["T_STRING","where",751],"(",["T_CONSTANT_ENCAPSED_STRING","'value = ?'",751],",",["T_WHITESPACE"," ",751],["T_VARIABLE","$values",751],"[",["T_VARIABLE","$code",751],"]",")",";",["T_WHITESPACE","\n                            ",751],"}",["T_WHITESPACE","\n                            ",752],["T_VARIABLE","$filter",753],"[",["T_VARIABLE","$code",753],"]",["T_OBJECT_OPERATOR","->",753],["T_STRING","where",753],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id = ?'",753],",",["T_WHITESPACE"," ",753],["T_VARIABLE","$store",753],")",";",["T_WHITESPACE","\n                            ",753],["T_VARIABLE","$filteredAttributes",754],"[","]","=",["T_VARIABLE","$code",754],";",["T_WHITESPACE","\n                        ",754],"}",["T_WHITESPACE","\n                    ",755],"}",["T_WHITESPACE","\n                ",756],"}",["T_WHITESPACE","\n            ",757],"}",["T_WHITESPACE","\n        ",758],"}",["T_WHITESPACE","\n        ",759],["T_RETURN","return",760],["T_WHITESPACE"," ",760],["T_VARIABLE","$filter",760],";",["T_WHITESPACE","\n    ",760],"}",["T_WHITESPACE","\n\n    ",761],["T_DOC_COMMENT","\/**\n     * Retrieve SELECT object\n     *\n     * @return Varien_Db_Select\n     *\/",763],["T_WHITESPACE","\n    ",767],["T_PROTECTED","protected",768],["T_WHITESPACE"," ",768],["T_FUNCTION","function",768],["T_WHITESPACE"," ",768],["T_STRING","_getSelect",768],"(",")",["T_WHITESPACE","\n    ",768],"{",["T_WHITESPACE","\n        ",769],["T_RETURN","return",770],["T_WHITESPACE"," ",770],["T_VARIABLE","$this",770],["T_OBJECT_OPERATOR","->",770],["T_STRING","_getResource",770],"(",")",["T_OBJECT_OPERATOR","->",770],["T_STRING","getReadConnection",770],"(",")",["T_OBJECT_OPERATOR","->",770],["T_STRING","select",770],"(",")",";",["T_WHITESPACE","\n    ",770],"}",["T_WHITESPACE","\n\n    ",771],["T_DOC_COMMENT","\/**\n     * Add indexable attributes to product collection select\n     *\n     * @deprecated\n     * @param   $collection\n     * @return  Mage_CatalogIndex_Model_Indexer\n     *\/",773],["T_WHITESPACE","\n    ",779],["T_PROTECTED","protected",780],["T_WHITESPACE"," ",780],["T_FUNCTION","function",780],["T_WHITESPACE"," ",780],["T_STRING","_addFilterableAttributesToCollection",780],"(",["T_VARIABLE","$collection",780],")",["T_WHITESPACE","\n    ",780],"{",["T_WHITESPACE","\n        ",781],["T_VARIABLE","$attributeCodes",782],["T_WHITESPACE"," ",782],"=",["T_WHITESPACE"," ",782],["T_VARIABLE","$this",782],["T_OBJECT_OPERATOR","->",782],["T_STRING","_getIndexableAttributeCodes",782],"(",")",";",["T_WHITESPACE","\n        ",782],["T_FOREACH","foreach",783],["T_WHITESPACE"," ",783],"(",["T_VARIABLE","$attributeCodes",783],["T_WHITESPACE"," ",783],["T_AS","as",783],["T_WHITESPACE"," ",783],["T_VARIABLE","$code",783],")",["T_WHITESPACE"," ",783],"{",["T_WHITESPACE","\n            ",783],["T_VARIABLE","$collection",784],["T_OBJECT_OPERATOR","->",784],["T_STRING","addAttributeToSelect",784],"(",["T_VARIABLE","$code",784],")",";",["T_WHITESPACE","\n        ",784],"}",["T_WHITESPACE","\n\n        ",785],["T_RETURN","return",787],["T_WHITESPACE"," ",787],["T_VARIABLE","$this",787],";",["T_WHITESPACE","\n    ",787],"}",["T_WHITESPACE","\n\n",788],["T_DOC_COMMENT","\/**\n     * Prepare Catalog Product Flat Columns\n     *\n     * @param Varien_Object $object\n     * @return Mage_CatalogIndex_Model_Indexer\n     *\/",790],["T_WHITESPACE","\n    ",795],["T_PUBLIC","public",796],["T_WHITESPACE"," ",796],["T_FUNCTION","function",796],["T_WHITESPACE"," ",796],["T_STRING","prepareCatalogProductFlatColumns",796],"(",["T_STRING","Varien_Object",796],["T_WHITESPACE"," ",796],["T_VARIABLE","$object",796],")",["T_WHITESPACE","\n    ",796],"{",["T_WHITESPACE","\n        ",797],["T_VARIABLE","$this",798],["T_OBJECT_OPERATOR","->",798],["T_STRING","_getResource",798],"(",")",["T_OBJECT_OPERATOR","->",798],["T_STRING","prepareCatalogProductFlatColumns",798],"(",["T_VARIABLE","$object",798],")",";",["T_WHITESPACE","\n\n        ",798],["T_RETURN","return",800],["T_WHITESPACE"," ",800],["T_VARIABLE","$this",800],";",["T_WHITESPACE","\n    ",800],"}",["T_WHITESPACE","\n\n    ",801],["T_DOC_COMMENT","\/**\n     * Prepare Catalog Product Flat Indexes\n     *\n     * @param Varien_Object $object\n     * @return Mage_CatalogIndex_Model_Indexer\n     *\/",803],["T_WHITESPACE","\n    ",808],["T_PUBLIC","public",809],["T_WHITESPACE"," ",809],["T_FUNCTION","function",809],["T_WHITESPACE"," ",809],["T_STRING","prepareCatalogProductFlatIndexes",809],"(",["T_STRING","Varien_Object",809],["T_WHITESPACE"," ",809],["T_VARIABLE","$object",809],")",["T_WHITESPACE","\n    ",809],"{",["T_WHITESPACE","\n        ",810],["T_VARIABLE","$this",811],["T_OBJECT_OPERATOR","->",811],["T_STRING","_getResource",811],"(",")",["T_OBJECT_OPERATOR","->",811],["T_STRING","prepareCatalogProductFlatIndexes",811],"(",["T_VARIABLE","$object",811],")",";",["T_WHITESPACE","\n\n        ",811],["T_RETURN","return",813],["T_WHITESPACE"," ",813],["T_VARIABLE","$this",813],";",["T_WHITESPACE","\n    ",813],"}",["T_WHITESPACE","\n\n    ",814],["T_DOC_COMMENT","\/**\n     * Update price process for catalog product flat\n     *\n     * @param mixed $storeId\n     * @param string $resourceTable\n     * @param mixed $products\n     * @return Mage_CatalogIndex_Model_Indexer\n     *\/",816],["T_WHITESPACE","\n    ",823],["T_PUBLIC","public",824],["T_WHITESPACE"," ",824],["T_FUNCTION","function",824],["T_WHITESPACE"," ",824],["T_STRING","updateCatalogProductFlat",824],"(",["T_VARIABLE","$store",824],",",["T_WHITESPACE"," ",824],["T_VARIABLE","$products",824],["T_WHITESPACE"," ",824],"=",["T_WHITESPACE"," ",824],["T_STRING","null",824],",",["T_WHITESPACE"," ",824],["T_VARIABLE","$resourceTable",824],["T_WHITESPACE"," ",824],"=",["T_WHITESPACE"," ",824],["T_STRING","null",824],")",["T_WHITESPACE","\n    ",824],"{",["T_WHITESPACE","\n        ",825],["T_IF","if",826],["T_WHITESPACE"," ",826],"(",["T_VARIABLE","$store",826],["T_WHITESPACE"," ",826],["T_INSTANCEOF","instanceof",826],["T_WHITESPACE"," ",826],["T_STRING","Mage_Core_Model_Store",826],")",["T_WHITESPACE"," ",826],"{",["T_WHITESPACE","\n            ",826],["T_VARIABLE","$store",827],["T_WHITESPACE"," ",827],"=",["T_WHITESPACE"," ",827],["T_VARIABLE","$store",827],["T_OBJECT_OPERATOR","->",827],["T_STRING","getId",827],"(",")",";",["T_WHITESPACE","\n        ",827],"}",["T_WHITESPACE","\n        ",828],["T_IF","if",829],["T_WHITESPACE"," ",829],"(",["T_VARIABLE","$products",829],["T_WHITESPACE"," ",829],["T_INSTANCEOF","instanceof",829],["T_WHITESPACE"," ",829],["T_STRING","Mage_Catalog_Model_Product",829],")",["T_WHITESPACE"," ",829],"{",["T_WHITESPACE","\n            ",829],["T_VARIABLE","$products",830],["T_WHITESPACE"," ",830],"=",["T_WHITESPACE"," ",830],["T_VARIABLE","$products",830],["T_OBJECT_OPERATOR","->",830],["T_STRING","getId",830],"(",")",";",["T_WHITESPACE","\n        ",830],"}",["T_WHITESPACE","\n        ",831],["T_VARIABLE","$this",832],["T_OBJECT_OPERATOR","->",832],["T_STRING","_getResource",832],"(",")",["T_OBJECT_OPERATOR","->",832],["T_STRING","updateCatalogProductFlat",832],"(",["T_VARIABLE","$store",832],",",["T_WHITESPACE"," ",832],["T_VARIABLE","$products",832],",",["T_WHITESPACE"," ",832],["T_VARIABLE","$resourceTable",832],")",";",["T_WHITESPACE","\n\n        ",832],["T_RETURN","return",834],["T_WHITESPACE"," ",834],["T_VARIABLE","$this",834],";",["T_WHITESPACE","\n    ",834],"}",["T_WHITESPACE","\n",835],"}",["T_WHITESPACE","\n",836]]