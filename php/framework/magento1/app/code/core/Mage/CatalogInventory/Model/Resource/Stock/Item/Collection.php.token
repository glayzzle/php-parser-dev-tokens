[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_CatalogInventory\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Stock item collection resource model\n *\n * @category    Mage\n * @package     Mage_CatalogInventory\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_CatalogInventory_Model_Resource_Stock_Item_Collection",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Model_Resource_Db_Collection_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Initialize resource model\n     *\n     *\/",37],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_FUNCTION","function",41],["T_WHITESPACE"," ",41],["T_STRING","_construct",41],"(",")",["T_WHITESPACE","\n    ",41],"{",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","_init",43],"(",["T_CONSTANT_ENCAPSED_STRING","'cataloginventory\/stock_item'",43],")",";",["T_WHITESPACE","\n    ",43],"}",["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * Add stock filter to collection\n     *\n     * @param mixed $stock\n     * @return Mage_CatalogInventory_Model_Resource_Stock_Item_Collection\n     *\/",46],["T_WHITESPACE","\n    ",51],["T_PUBLIC","public",52],["T_WHITESPACE"," ",52],["T_FUNCTION","function",52],["T_WHITESPACE"," ",52],["T_STRING","addStockFilter",52],"(",["T_VARIABLE","$stock",52],")",["T_WHITESPACE","\n    ",52],"{",["T_WHITESPACE","\n        ",53],["T_IF","if",54],["T_WHITESPACE"," ",54],"(",["T_VARIABLE","$stock",54],["T_WHITESPACE"," ",54],["T_INSTANCEOF","instanceof",54],["T_WHITESPACE"," ",54],["T_STRING","Mage_CatalogInventory_Model_Stock",54],")",["T_WHITESPACE"," ",54],"{",["T_WHITESPACE","\n            ",54],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","addFieldToFilter",55],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.stock_id'",55],",",["T_WHITESPACE"," ",55],["T_VARIABLE","$stock",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","getId",55],"(",")",")",";",["T_WHITESPACE","\n        ",55],"}",["T_WHITESPACE"," ",56],["T_ELSE","else",56],["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n            ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","addFieldToFilter",57],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.stock_id'",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$stock",57],")",";",["T_WHITESPACE","\n        ",57],"}",["T_WHITESPACE","\n        ",58],["T_RETURN","return",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$this",59],";",["T_WHITESPACE","\n    ",59],"}",["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * Add product filter to collection\n     *\n     * @param array $products\n     * @return Mage_CatalogInventory_Model_Resource_Stock_Item_Collection\n     *\/",62],["T_WHITESPACE","\n    ",67],["T_PUBLIC","public",68],["T_WHITESPACE"," ",68],["T_FUNCTION","function",68],["T_WHITESPACE"," ",68],["T_STRING","addProductsFilter",68],"(",["T_VARIABLE","$products",68],")",["T_WHITESPACE","\n    ",68],"{",["T_WHITESPACE","\n        ",69],["T_VARIABLE","$productIds",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_ARRAY","array",70],"(",")",";",["T_WHITESPACE","\n        ",70],["T_FOREACH","foreach",71],["T_WHITESPACE"," ",71],"(",["T_VARIABLE","$products",71],["T_WHITESPACE"," ",71],["T_AS","as",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$product",71],")",["T_WHITESPACE"," ",71],"{",["T_WHITESPACE","\n            ",71],["T_IF","if",72],["T_WHITESPACE"," ",72],"(",["T_VARIABLE","$product",72],["T_WHITESPACE"," ",72],["T_INSTANCEOF","instanceof",72],["T_WHITESPACE"," ",72],["T_STRING","Mage_Catalog_Model_Product",72],")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n                ",72],["T_VARIABLE","$productIds",73],"[","]",["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$product",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","getId",73],"(",")",";",["T_WHITESPACE","\n            ",73],"}",["T_WHITESPACE"," ",74],["T_ELSE","else",74],["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n                ",74],["T_VARIABLE","$productIds",75],"[","]",["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$product",75],";",["T_WHITESPACE","\n            ",75],"}",["T_WHITESPACE","\n        ",76],"}",["T_WHITESPACE","\n        ",77],["T_IF","if",78],["T_WHITESPACE"," ",78],"(",["T_EMPTY","empty",78],"(",["T_VARIABLE","$productIds",78],")",")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n            ",78],["T_VARIABLE","$productIds",79],"[","]",["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_STRING","false",79],";",["T_WHITESPACE","\n            ",79],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","_setIsLoaded",80],"(",["T_STRING","true",80],")",";",["T_WHITESPACE","\n        ",80],"}",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","addFieldToFilter",82],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.product_id'",82],",",["T_WHITESPACE"," ",82],["T_ARRAY","array",82],"(",["T_CONSTANT_ENCAPSED_STRING","'in'",82],["T_WHITESPACE"," ",82],["T_DOUBLE_ARROW","=>",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$productIds",82],")",")",";",["T_WHITESPACE","\n        ",82],["T_RETURN","return",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],";",["T_WHITESPACE","\n    ",83],"}",["T_WHITESPACE","\n\n    ",84],["T_DOC_COMMENT","\/**\n     * Join Stock Status to collection\n     *\n     * @param int $storeId\n     * @return Mage_CatalogInventory_Model_Resource_Stock_Item_Collection\n     *\/",86],["T_WHITESPACE","\n    ",91],["T_PUBLIC","public",92],["T_WHITESPACE"," ",92],["T_FUNCTION","function",92],["T_WHITESPACE"," ",92],["T_STRING","joinStockStatus",92],"(",["T_VARIABLE","$storeId",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_STRING","null",92],")",["T_WHITESPACE","\n    ",92],"{",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$websiteId",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_STRING","Mage",94],["T_DOUBLE_COLON","::",94],["T_STRING","app",94],"(",")",["T_OBJECT_OPERATOR","->",94],["T_STRING","getStore",94],"(",["T_VARIABLE","$storeId",94],")",["T_OBJECT_OPERATOR","->",94],["T_STRING","getWebsiteId",94],"(",")",";",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getSelect",95],"(",")",["T_OBJECT_OPERATOR","->",95],["T_STRING","joinLeft",95],"(",["T_WHITESPACE","\n            ",95],["T_ARRAY","array",96],"(",["T_CONSTANT_ENCAPSED_STRING","'status_table'",96],["T_WHITESPACE"," ",96],["T_DOUBLE_ARROW","=>",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getTable",96],"(",["T_CONSTANT_ENCAPSED_STRING","'cataloginventory\/stock_status'",96],")",")",",",["T_WHITESPACE","\n                ",96],["T_CONSTANT_ENCAPSED_STRING","'main_table.product_id=status_table.product_id'",97],["T_WHITESPACE","\n                ",97],".",["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","' AND main_table.stock_id=status_table.stock_id'",98],["T_WHITESPACE","\n                ",98],".",["T_WHITESPACE"," ",99],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","getConnection",99],"(",")",["T_OBJECT_OPERATOR","->",99],["T_STRING","quoteInto",99],"(",["T_CONSTANT_ENCAPSED_STRING","' AND status_table.website_id=?'",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$websiteId",99],")",",",["T_WHITESPACE","\n            ",99],["T_ARRAY","array",100],"(",["T_CONSTANT_ENCAPSED_STRING","'stock_status'",100],")",["T_WHITESPACE","\n        ",100],")",";",["T_WHITESPACE","\n\n        ",101],["T_RETURN","return",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],";",["T_WHITESPACE","\n    ",103],"}",["T_WHITESPACE","\n\n    ",104],["T_DOC_COMMENT","\/**\n     * Add Managed Stock products filter to collection\n     *\n     * @param boolean $isStockManagedInConfig\n     * @return Mage_CatalogInventory_Model_Resource_Stock_Item_Collection\n     *\/",106],["T_WHITESPACE","\n    ",111],["T_PUBLIC","public",112],["T_WHITESPACE"," ",112],["T_FUNCTION","function",112],["T_WHITESPACE"," ",112],["T_STRING","addManagedFilter",112],"(",["T_VARIABLE","$isStockManagedInConfig",112],")",["T_WHITESPACE","\n    ",112],"{",["T_WHITESPACE","\n        ",113],["T_IF","if",114],["T_WHITESPACE"," ",114],"(",["T_VARIABLE","$isStockManagedInConfig",114],")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n            ",114],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","getSelect",115],"(",")",["T_OBJECT_OPERATOR","->",115],["T_STRING","where",115],"(",["T_CONSTANT_ENCAPSED_STRING","'(manage_stock = 1 OR use_config_manage_stock = 1)'",115],")",";",["T_WHITESPACE","\n        ",115],"}",["T_WHITESPACE"," ",116],["T_ELSE","else",116],["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n            ",116],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","addFieldToFilter",117],"(",["T_CONSTANT_ENCAPSED_STRING","'manage_stock'",117],",",["T_WHITESPACE"," ",117],["T_LNUMBER","1",117],")",";",["T_WHITESPACE","\n        ",117],"}",["T_WHITESPACE","\n\n        ",118],["T_RETURN","return",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],";",["T_WHITESPACE","\n    ",120],"}",["T_WHITESPACE","\n\n    ",121],["T_DOC_COMMENT","\/**\n     * Add filter by quantity to collection\n     *\n     * @param string $comparsionMethod\n     * @param float $qty\n     * @return Mage_CatalogInventory_Model_Resource_Stock_Item_Collection\n     *\/",123],["T_WHITESPACE","\n    ",129],["T_PUBLIC","public",130],["T_WHITESPACE"," ",130],["T_FUNCTION","function",130],["T_WHITESPACE"," ",130],["T_STRING","addQtyFilter",130],"(",["T_VARIABLE","$comparsionMethod",130],",",["T_WHITESPACE"," ",130],["T_VARIABLE","$qty",130],")",["T_WHITESPACE","\n    ",130],"{",["T_WHITESPACE","\n        ",131],["T_VARIABLE","$methods",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_ARRAY","array",132],"(",["T_WHITESPACE","\n            ",132],["T_CONSTANT_ENCAPSED_STRING","'<'",133],["T_WHITESPACE","  ",133],["T_DOUBLE_ARROW","=>",133],["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'lt'",133],",",["T_WHITESPACE","\n            ",133],["T_CONSTANT_ENCAPSED_STRING","'>'",134],["T_WHITESPACE","  ",134],["T_DOUBLE_ARROW","=>",134],["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","'gt'",134],",",["T_WHITESPACE","\n            ",134],["T_CONSTANT_ENCAPSED_STRING","'='",135],["T_WHITESPACE","  ",135],["T_DOUBLE_ARROW","=>",135],["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","'eq'",135],",",["T_WHITESPACE","\n            ",135],["T_CONSTANT_ENCAPSED_STRING","'<='",136],["T_WHITESPACE"," ",136],["T_DOUBLE_ARROW","=>",136],["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","'lteq'",136],",",["T_WHITESPACE","\n            ",136],["T_CONSTANT_ENCAPSED_STRING","'>='",137],["T_WHITESPACE"," ",137],["T_DOUBLE_ARROW","=>",137],["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'gteq'",137],",",["T_WHITESPACE","\n            ",137],["T_CONSTANT_ENCAPSED_STRING","'<>'",138],["T_WHITESPACE"," ",138],["T_DOUBLE_ARROW","=>",138],["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","'neq'",138],["T_WHITESPACE","\n        ",138],")",";",["T_WHITESPACE","\n        ",139],["T_IF","if",140],["T_WHITESPACE"," ",140],"(","!",["T_ISSET","isset",140],"(",["T_VARIABLE","$methods",140],"[",["T_VARIABLE","$comparsionMethod",140],"]",")",")",["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n            ",140],["T_STRING","Mage",141],["T_DOUBLE_COLON","::",141],["T_STRING","throwException",141],"(",["T_WHITESPACE","\n                ",141],["T_STRING","Mage",142],["T_DOUBLE_COLON","::",142],["T_STRING","helper",142],"(",["T_CONSTANT_ENCAPSED_STRING","'cataloginventory'",142],")",["T_OBJECT_OPERATOR","->",142],["T_STRING","__",142],"(",["T_CONSTANT_ENCAPSED_STRING","'%s is not a correct comparsion method.'",142],",",["T_WHITESPACE"," ",142],["T_VARIABLE","$comparsionMethod",142],")",["T_WHITESPACE","\n            ",142],")",";",["T_WHITESPACE","\n        ",143],"}",["T_WHITESPACE","\n\n        ",144],["T_RETURN","return",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","addFieldToFilter",146],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.qty'",146],",",["T_WHITESPACE"," ",146],["T_ARRAY","array",146],"(",["T_VARIABLE","$methods",146],"[",["T_VARIABLE","$comparsionMethod",146],"]",["T_WHITESPACE"," ",146],["T_DOUBLE_ARROW","=>",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$qty",146],")",")",";",["T_WHITESPACE","\n    ",146],"}",["T_WHITESPACE","\n\n    ",147],["T_DOC_COMMENT","\/**\n     * Initialize select object\n     *\n     * @return Mage_CatalogInventory_Model_Resource_Stock_Item_Collection\n     *\/",149],["T_WHITESPACE","\n    ",153],["T_PROTECTED","protected",154],["T_WHITESPACE"," ",154],["T_FUNCTION","function",154],["T_WHITESPACE"," ",154],["T_STRING","_initSelect",154],"(",")",["T_WHITESPACE","\n    ",154],"{",["T_WHITESPACE","\n        ",155],["T_RETURN","return",156],["T_WHITESPACE"," ",156],["T_STRING","parent",156],["T_DOUBLE_COLON","::",156],["T_STRING","_initSelect",156],"(",")",["T_OBJECT_OPERATOR","->",156],["T_STRING","getSelect",156],"(",")",["T_WHITESPACE","\n            ",156],["T_OBJECT_OPERATOR","->",157],["T_STRING","join",157],"(",["T_WHITESPACE","\n                ",157],["T_ARRAY","array",158],"(",["T_CONSTANT_ENCAPSED_STRING","'cp_table'",158],["T_WHITESPACE"," ",158],["T_DOUBLE_ARROW","=>",158],["T_WHITESPACE"," ",158],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","getTable",158],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",158],")",")",",",["T_WHITESPACE","\n                ",158],["T_CONSTANT_ENCAPSED_STRING","'main_table.product_id = cp_table.entity_id'",159],",",["T_WHITESPACE","\n                ",159],["T_ARRAY","array",160],"(",["T_CONSTANT_ENCAPSED_STRING","'type_id'",160],")",["T_WHITESPACE","\n            ",160],")",";",["T_WHITESPACE","\n    ",161],"}",["T_WHITESPACE","\n",162],"}",["T_WHITESPACE","\n",163]]