[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_CatalogInventory\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Stock resource model\n *\n * @category    Mage\n * @package     Mage_CatalogInventory\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_CatalogInventory_Model_Resource_Stock",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Model_Resource_Db_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Is initialized configuration flag\n     *\n     * @var boolean\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_isConfig",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Manage Stock flag\n     *\n     * @var boolean\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_isConfigManageStock",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Backorders\n     *\n     * @var boolean\n     *\/",51],["T_WHITESPACE","\n    ",55],["T_PROTECTED","protected",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$_isConfigBackorders",56],";",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * Minimum quantity allowed in shopping card\n     *\n     * @var int\n     *\/",58],["T_WHITESPACE","\n    ",62],["T_PROTECTED","protected",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$_configMinQty",63],";",["T_WHITESPACE","\n\n    ",63],["T_DOC_COMMENT","\/**\n     * Product types that could have quantities\n     *\n     * @var array\n     *\/",65],["T_WHITESPACE","\n    ",69],["T_PROTECTED","protected",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$_configTypeIds",70],";",["T_WHITESPACE","\n\n    ",70],["T_DOC_COMMENT","\/**\n     * Notify for quantity below _configNotifyStockQty value\n     *\n     * @var int\n     *\/",72],["T_WHITESPACE","\n    ",76],["T_PROTECTED","protected",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$_configNotifyStockQty",77],";",["T_WHITESPACE","\n\n    ",77],["T_DOC_COMMENT","\/**\n     * Ctalog Inventory Stock instance\n     *\n     * @var Mage_CatalogInventory_Model_Stock\n     *\/",79],["T_WHITESPACE","\n    ",83],["T_PROTECTED","protected",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$_stock",84],";",["T_WHITESPACE","\n\n    ",84],["T_DOC_COMMENT","\/**\n     * Define main table and initialize connection\n     *\n     *\/",86],["T_WHITESPACE","\n    ",89],["T_PROTECTED","protected",90],["T_WHITESPACE"," ",90],["T_FUNCTION","function",90],["T_WHITESPACE"," ",90],["T_STRING","_construct",90],"(",")",["T_WHITESPACE","\n    ",90],"{",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","_init",92],"(",["T_CONSTANT_ENCAPSED_STRING","'cataloginventory\/stock'",92],",",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'stock_id'",92],")",";",["T_WHITESPACE","\n    ",92],"}",["T_WHITESPACE","\n\n    ",93],["T_DOC_COMMENT","\/**\n     * Lock product items\n     *\n     * @param Mage_CatalogInventory_Model_Stock $stock\n     * @param int|array $productIds\n     * @return Mage_CatalogInventory_Model_Resource_Stock\n     *\/",95],["T_WHITESPACE","\n    ",101],["T_PUBLIC","public",102],["T_WHITESPACE"," ",102],["T_FUNCTION","function",102],["T_WHITESPACE"," ",102],["T_STRING","lockProductItems",102],"(",["T_VARIABLE","$stock",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$productIds",102],")",["T_WHITESPACE","\n    ",102],"{",["T_WHITESPACE","\n        ",103],["T_VARIABLE","$itemTable",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getTable",104],"(",["T_CONSTANT_ENCAPSED_STRING","'cataloginventory\/stock_item'",104],")",";",["T_WHITESPACE","\n        ",104],["T_VARIABLE","$select",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","_getWriteAdapter",105],"(",")",["T_OBJECT_OPERATOR","->",105],["T_STRING","select",105],"(",")",["T_WHITESPACE","\n            ",105],["T_OBJECT_OPERATOR","->",106],["T_STRING","from",106],"(",["T_VARIABLE","$itemTable",106],")",["T_WHITESPACE","\n            ",106],["T_OBJECT_OPERATOR","->",107],["T_STRING","where",107],"(",["T_CONSTANT_ENCAPSED_STRING","'stock_id=?'",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$stock",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","getId",107],"(",")",")",["T_WHITESPACE","\n            ",107],["T_OBJECT_OPERATOR","->",108],["T_STRING","where",108],"(",["T_CONSTANT_ENCAPSED_STRING","'product_id IN(?)'",108],",",["T_WHITESPACE"," ",108],["T_VARIABLE","$productIds",108],")",["T_WHITESPACE","\n            ",108],["T_OBJECT_OPERATOR","->",109],["T_STRING","forUpdate",109],"(",["T_STRING","true",109],")",";",["T_WHITESPACE","\n        ",109],["T_DOC_COMMENT","\/**\n         * We use write adapter for resolving problems with replication\n         *\/",110],["T_WHITESPACE","\n        ",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","_getWriteAdapter",113],"(",")",["T_OBJECT_OPERATOR","->",113],["T_STRING","query",113],"(",["T_VARIABLE","$select",113],")",";",["T_WHITESPACE","\n        ",113],["T_RETURN","return",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$this",114],";",["T_WHITESPACE","\n    ",114],"}",["T_WHITESPACE","\n\n    ",115],["T_DOC_COMMENT","\/**\n     * Get stock items data for requested products\n     *\n     * @param Mage_CatalogInventory_Model_Stock $stock\n     * @param array $productIds\n     * @param bool $lockRows\n     * @return array\n     *\/",117],["T_WHITESPACE","\n    ",124],["T_PUBLIC","public",125],["T_WHITESPACE"," ",125],["T_FUNCTION","function",125],["T_WHITESPACE"," ",125],["T_STRING","getProductsStock",125],"(",["T_VARIABLE","$stock",125],",",["T_WHITESPACE"," ",125],["T_VARIABLE","$productIds",125],",",["T_WHITESPACE"," ",125],["T_VARIABLE","$lockRows",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_STRING","false",125],")",["T_WHITESPACE","\n    ",125],"{",["T_WHITESPACE","\n        ",126],["T_IF","if",127],["T_WHITESPACE"," ",127],"(",["T_EMPTY","empty",127],"(",["T_VARIABLE","$productIds",127],")",")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n            ",127],["T_RETURN","return",128],["T_WHITESPACE"," ",128],["T_ARRAY","array",128],"(",")",";",["T_WHITESPACE","\n        ",128],"}",["T_WHITESPACE","\n        ",129],["T_VARIABLE","$itemTable",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getTable",130],"(",["T_CONSTANT_ENCAPSED_STRING","'cataloginventory\/stock_item'",130],")",";",["T_WHITESPACE","\n        ",130],["T_VARIABLE","$productTable",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","getTable",131],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",131],")",";",["T_WHITESPACE","\n        ",131],["T_VARIABLE","$select",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","_getWriteAdapter",132],"(",")",["T_OBJECT_OPERATOR","->",132],["T_STRING","select",132],"(",")",["T_WHITESPACE","\n            ",132],["T_OBJECT_OPERATOR","->",133],["T_STRING","from",133],"(",["T_ARRAY","array",133],"(",["T_CONSTANT_ENCAPSED_STRING","'si'",133],["T_WHITESPACE"," ",133],["T_DOUBLE_ARROW","=>",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$itemTable",133],")",")",["T_WHITESPACE","\n            ",133],["T_OBJECT_OPERATOR","->",134],["T_STRING","join",134],"(",["T_ARRAY","array",134],"(",["T_CONSTANT_ENCAPSED_STRING","'p'",134],["T_WHITESPACE"," ",134],["T_DOUBLE_ARROW","=>",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$productTable",134],")",",",["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","'p.entity_id=si.product_id'",134],",",["T_WHITESPACE"," ",134],["T_ARRAY","array",134],"(",["T_CONSTANT_ENCAPSED_STRING","'type_id'",134],")",")",["T_WHITESPACE","\n            ",134],["T_OBJECT_OPERATOR","->",135],["T_STRING","where",135],"(",["T_CONSTANT_ENCAPSED_STRING","'stock_id=?'",135],",",["T_WHITESPACE"," ",135],["T_VARIABLE","$stock",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getId",135],"(",")",")",["T_WHITESPACE","\n            ",135],["T_OBJECT_OPERATOR","->",136],["T_STRING","where",136],"(",["T_CONSTANT_ENCAPSED_STRING","'product_id IN(?)'",136],",",["T_WHITESPACE"," ",136],["T_VARIABLE","$productIds",136],")",["T_WHITESPACE","\n            ",136],["T_OBJECT_OPERATOR","->",137],["T_STRING","forUpdate",137],"(",["T_VARIABLE","$lockRows",137],")",";",["T_WHITESPACE","\n        ",137],["T_RETURN","return",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","_getWriteAdapter",138],"(",")",["T_OBJECT_OPERATOR","->",138],["T_STRING","fetchAll",138],"(",["T_VARIABLE","$select",138],")",";",["T_WHITESPACE","\n    ",138],"}",["T_WHITESPACE","\n\n    ",139],["T_DOC_COMMENT","\/**\n     * Correct particular stock products qty based on operator\n     *\n     * @param Mage_CatalogInventory_Model_Stock $stock\n     * @param array $productQtys\n     * @param string $operator +\/-\n     * @return Mage_CatalogInventory_Model_Resource_Stock\n     *\/",141],["T_WHITESPACE","\n    ",148],["T_PUBLIC","public",149],["T_WHITESPACE"," ",149],["T_FUNCTION","function",149],["T_WHITESPACE"," ",149],["T_STRING","correctItemsQty",149],"(",["T_VARIABLE","$stock",149],",",["T_WHITESPACE"," ",149],["T_VARIABLE","$productQtys",149],",",["T_WHITESPACE"," ",149],["T_VARIABLE","$operator",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_CONSTANT_ENCAPSED_STRING","'-'",149],")",["T_WHITESPACE","\n    ",149],"{",["T_WHITESPACE","\n        ",150],["T_IF","if",151],["T_WHITESPACE"," ",151],"(",["T_EMPTY","empty",151],"(",["T_VARIABLE","$productQtys",151],")",")",["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n            ",151],["T_RETURN","return",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],";",["T_WHITESPACE","\n        ",152],"}",["T_WHITESPACE","\n\n        ",153],["T_VARIABLE","$adapter",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","_getWriteAdapter",155],"(",")",";",["T_WHITESPACE","\n        ",155],["T_VARIABLE","$conditions",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_ARRAY","array",156],"(",")",";",["T_WHITESPACE","\n        ",156],["T_FOREACH","foreach",157],["T_WHITESPACE"," ",157],"(",["T_VARIABLE","$productQtys",157],["T_WHITESPACE"," ",157],["T_AS","as",157],["T_WHITESPACE"," ",157],["T_VARIABLE","$productId",157],["T_WHITESPACE"," ",157],["T_DOUBLE_ARROW","=>",157],["T_WHITESPACE"," ",157],["T_VARIABLE","$qty",157],")",["T_WHITESPACE"," ",157],"{",["T_WHITESPACE","\n            ",157],["T_VARIABLE","$case",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_VARIABLE","$adapter",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","quoteInto",158],"(",["T_CONSTANT_ENCAPSED_STRING","'?'",158],",",["T_WHITESPACE"," ",158],["T_VARIABLE","$productId",158],")",";",["T_WHITESPACE","\n            ",158],["T_VARIABLE","$result",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_VARIABLE","$adapter",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","quoteInto",159],"(","\"",["T_ENCAPSED_AND_WHITESPACE","qty",159],["T_CURLY_OPEN","{",159],["T_VARIABLE","$operator",159],"}",["T_ENCAPSED_AND_WHITESPACE","?",159],"\"",",",["T_WHITESPACE"," ",159],["T_VARIABLE","$qty",159],")",";",["T_WHITESPACE","\n            ",159],["T_VARIABLE","$conditions",160],"[",["T_VARIABLE","$case",160],"]",["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_VARIABLE","$result",160],";",["T_WHITESPACE","\n        ",160],"}",["T_WHITESPACE","\n\n        ",161],["T_VARIABLE","$value",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_VARIABLE","$adapter",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","getCaseSql",163],"(",["T_CONSTANT_ENCAPSED_STRING","'product_id'",163],",",["T_WHITESPACE"," ",163],["T_VARIABLE","$conditions",163],",",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","'qty'",163],")",";",["T_WHITESPACE","\n\n        ",163],["T_VARIABLE","$where",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_ARRAY","array",165],"(",["T_WHITESPACE","\n            ",165],["T_CONSTANT_ENCAPSED_STRING","'product_id IN (?)'",166],["T_WHITESPACE"," ",166],["T_DOUBLE_ARROW","=>",166],["T_WHITESPACE"," ",166],["T_STRING","array_keys",166],"(",["T_VARIABLE","$productQtys",166],")",",",["T_WHITESPACE","\n            ",166],["T_CONSTANT_ENCAPSED_STRING","'stock_id = ?'",167],["T_WHITESPACE","      ",167],["T_DOUBLE_ARROW","=>",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$stock",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","getId",167],"(",")",["T_WHITESPACE","\n        ",167],")",";",["T_WHITESPACE","\n\n        ",168],["T_VARIABLE","$adapter",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","beginTransaction",170],"(",")",";",["T_WHITESPACE","\n        ",170],["T_VARIABLE","$adapter",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","update",171],"(",["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","getTable",171],"(",["T_CONSTANT_ENCAPSED_STRING","'cataloginventory\/stock_item'",171],")",",",["T_WHITESPACE"," ",171],["T_ARRAY","array",171],"(",["T_CONSTANT_ENCAPSED_STRING","'qty'",171],["T_WHITESPACE"," ",171],["T_DOUBLE_ARROW","=>",171],["T_WHITESPACE"," ",171],["T_VARIABLE","$value",171],")",",",["T_WHITESPACE"," ",171],["T_VARIABLE","$where",171],")",";",["T_WHITESPACE","\n        ",171],["T_VARIABLE","$adapter",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","commit",172],"(",")",";",["T_WHITESPACE","\n\n        ",172],["T_RETURN","return",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],";",["T_WHITESPACE","\n    ",174],"}",["T_WHITESPACE","\n\n    ",175],["T_DOC_COMMENT","\/**\n     * add join to select only in stock products\n     *\n     * @param Mage_Catalog_Model_Resource_Product_Link_Product_Collection $collection\n     * @return Mage_CatalogInventory_Model_Resource_Stock\n     *\/",177],["T_WHITESPACE","\n    ",182],["T_PUBLIC","public",183],["T_WHITESPACE"," ",183],["T_FUNCTION","function",183],["T_WHITESPACE"," ",183],["T_STRING","setInStockFilterToCollection",183],"(",["T_VARIABLE","$collection",183],")",["T_WHITESPACE","\n    ",183],"{",["T_WHITESPACE","\n        ",184],["T_VARIABLE","$manageStock",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_STRING","Mage",185],["T_DOUBLE_COLON","::",185],["T_STRING","getStoreConfig",185],"(",["T_STRING","Mage_CatalogInventory_Model_Stock_Item",185],["T_DOUBLE_COLON","::",185],["T_STRING","XML_PATH_MANAGE_STOCK",185],")",";",["T_WHITESPACE","\n        ",185],["T_VARIABLE","$cond",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_ARRAY","array",186],"(",["T_WHITESPACE","\n            ",186],["T_CONSTANT_ENCAPSED_STRING","'{{table}}.use_config_manage_stock = 0 AND {{table}}.manage_stock=1 AND {{table}}.is_in_stock=1'",187],",",["T_WHITESPACE","\n            ",187],["T_CONSTANT_ENCAPSED_STRING","'{{table}}.use_config_manage_stock = 0 AND {{table}}.manage_stock=0'",188],",",["T_WHITESPACE","\n        ",188],")",";",["T_WHITESPACE","\n\n        ",189],["T_IF","if",191],["T_WHITESPACE"," ",191],"(",["T_VARIABLE","$manageStock",191],")",["T_WHITESPACE"," ",191],"{",["T_WHITESPACE","\n            ",191],["T_VARIABLE","$cond",192],"[","]",["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_CONSTANT_ENCAPSED_STRING","'{{table}}.use_config_manage_stock = 1 AND {{table}}.is_in_stock=1'",192],";",["T_WHITESPACE","\n        ",192],"}",["T_WHITESPACE"," ",193],["T_ELSE","else",193],["T_WHITESPACE"," ",193],"{",["T_WHITESPACE","\n            ",193],["T_VARIABLE","$cond",194],"[","]",["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],["T_CONSTANT_ENCAPSED_STRING","'{{table}}.use_config_manage_stock = 1'",194],";",["T_WHITESPACE","\n        ",194],"}",["T_WHITESPACE","\n\n        ",195],["T_VARIABLE","$collection",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","joinField",197],"(",["T_WHITESPACE","\n            ",197],["T_CONSTANT_ENCAPSED_STRING","'inventory_in_stock'",198],",",["T_WHITESPACE","\n            ",198],["T_CONSTANT_ENCAPSED_STRING","'cataloginventory\/stock_item'",199],",",["T_WHITESPACE","\n            ",199],["T_CONSTANT_ENCAPSED_STRING","'is_in_stock'",200],",",["T_WHITESPACE","\n            ",200],["T_CONSTANT_ENCAPSED_STRING","'product_id=entity_id'",201],",",["T_WHITESPACE","\n            ",201],["T_CONSTANT_ENCAPSED_STRING","'('",202],["T_WHITESPACE"," ",202],".",["T_WHITESPACE"," ",202],["T_STRING","join",202],"(",["T_CONSTANT_ENCAPSED_STRING","') OR ('",202],",",["T_WHITESPACE"," ",202],["T_VARIABLE","$cond",202],")",["T_WHITESPACE"," ",202],".",["T_WHITESPACE"," ",202],["T_CONSTANT_ENCAPSED_STRING","')'",202],["T_WHITESPACE","\n        ",202],")",";",["T_WHITESPACE","\n        ",203],["T_RETURN","return",204],["T_WHITESPACE"," ",204],["T_VARIABLE","$this",204],";",["T_WHITESPACE","\n    ",204],"}",["T_WHITESPACE","\n\n    ",205],["T_DOC_COMMENT","\/**\n     * Load some inventory configuration settings\n     *\n     *\/",207],["T_WHITESPACE","\n    ",210],["T_PROTECTED","protected",211],["T_WHITESPACE"," ",211],["T_FUNCTION","function",211],["T_WHITESPACE"," ",211],["T_STRING","_initConfig",211],"(",")",["T_WHITESPACE","\n    ",211],"{",["T_WHITESPACE","\n        ",212],["T_IF","if",213],["T_WHITESPACE"," ",213],"(","!",["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","_isConfig",213],")",["T_WHITESPACE"," ",213],"{",["T_WHITESPACE","\n            ",213],["T_VARIABLE","$configMap",214],["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_ARRAY","array",214],"(",["T_WHITESPACE","\n                ",214],["T_CONSTANT_ENCAPSED_STRING","'_isConfigManageStock'",215],["T_WHITESPACE","  ",215],["T_DOUBLE_ARROW","=>",215],["T_WHITESPACE"," ",215],["T_STRING","Mage_CatalogInventory_Model_Stock_Item",215],["T_DOUBLE_COLON","::",215],["T_STRING","XML_PATH_MANAGE_STOCK",215],",",["T_WHITESPACE","\n                ",215],["T_CONSTANT_ENCAPSED_STRING","'_isConfigBackorders'",216],["T_WHITESPACE","   ",216],["T_DOUBLE_ARROW","=>",216],["T_WHITESPACE"," ",216],["T_STRING","Mage_CatalogInventory_Model_Stock_Item",216],["T_DOUBLE_COLON","::",216],["T_STRING","XML_PATH_BACKORDERS",216],",",["T_WHITESPACE","\n                ",216],["T_CONSTANT_ENCAPSED_STRING","'_configMinQty'",217],["T_WHITESPACE","         ",217],["T_DOUBLE_ARROW","=>",217],["T_WHITESPACE"," ",217],["T_STRING","Mage_CatalogInventory_Model_Stock_Item",217],["T_DOUBLE_COLON","::",217],["T_STRING","XML_PATH_MIN_QTY",217],",",["T_WHITESPACE","\n                ",217],["T_CONSTANT_ENCAPSED_STRING","'_configNotifyStockQty'",218],["T_WHITESPACE"," ",218],["T_DOUBLE_ARROW","=>",218],["T_WHITESPACE"," ",218],["T_STRING","Mage_CatalogInventory_Model_Stock_Item",218],["T_DOUBLE_COLON","::",218],["T_STRING","XML_PATH_NOTIFY_STOCK_QTY",218],["T_WHITESPACE","\n            ",218],")",";",["T_WHITESPACE","\n\n            ",219],["T_FOREACH","foreach",221],["T_WHITESPACE"," ",221],"(",["T_VARIABLE","$configMap",221],["T_WHITESPACE"," ",221],["T_AS","as",221],["T_WHITESPACE"," ",221],["T_VARIABLE","$field",221],["T_WHITESPACE"," ",221],["T_DOUBLE_ARROW","=>",221],["T_WHITESPACE"," ",221],["T_VARIABLE","$const",221],")",["T_WHITESPACE"," ",221],"{",["T_WHITESPACE","\n                ",221],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_VARIABLE","$field",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_INT_CAST","(int)",222],["T_STRING","Mage",222],["T_DOUBLE_COLON","::",222],["T_STRING","getStoreConfig",222],"(",["T_VARIABLE","$const",222],")",";",["T_WHITESPACE","\n            ",222],"}",["T_WHITESPACE","\n\n            ",223],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","_isConfig",225],["T_WHITESPACE"," ",225],"=",["T_WHITESPACE"," ",225],["T_STRING","true",225],";",["T_WHITESPACE","\n            ",225],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","_stock",226],["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_STRING","Mage",226],["T_DOUBLE_COLON","::",226],["T_STRING","getModel",226],"(",["T_CONSTANT_ENCAPSED_STRING","'cataloginventory\/stock'",226],")",";",["T_WHITESPACE","\n            ",226],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","_configTypeIds",227],["T_WHITESPACE"," ",227],"=",["T_WHITESPACE"," ",227],["T_STRING","array_keys",227],"(",["T_STRING","Mage",227],["T_DOUBLE_COLON","::",227],["T_STRING","helper",227],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogInventory'",227],")",["T_OBJECT_OPERATOR","->",227],["T_STRING","getIsQtyTypeIds",227],"(",["T_STRING","true",227],")",")",";",["T_WHITESPACE","\n        ",227],"}",["T_WHITESPACE","\n    ",228],"}",["T_WHITESPACE","\n\n    ",229],["T_DOC_COMMENT","\/**\n     * Set items out of stock basing on their quantities and config settings\n     *\n     *\/",231],["T_WHITESPACE","\n    ",234],["T_PUBLIC","public",235],["T_WHITESPACE"," ",235],["T_FUNCTION","function",235],["T_WHITESPACE"," ",235],["T_STRING","updateSetOutOfStock",235],"(",")",["T_WHITESPACE","\n    ",235],"{",["T_WHITESPACE","\n        ",236],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","_initConfig",237],"(",")",";",["T_WHITESPACE","\n        ",237],["T_VARIABLE","$adapter",238],["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","_getWriteAdapter",238],"(",")",";",["T_WHITESPACE","\n        ",238],["T_VARIABLE","$values",239],["T_WHITESPACE","  ",239],"=",["T_WHITESPACE"," ",239],["T_ARRAY","array",239],"(",["T_WHITESPACE","\n            ",239],["T_CONSTANT_ENCAPSED_STRING","'is_in_stock'",240],["T_WHITESPACE","                  ",240],["T_DOUBLE_ARROW","=>",240],["T_WHITESPACE"," ",240],["T_LNUMBER","0",240],",",["T_WHITESPACE","\n            ",240],["T_CONSTANT_ENCAPSED_STRING","'stock_status_changed_auto'",241],["T_WHITESPACE","    ",241],["T_DOUBLE_ARROW","=>",241],["T_WHITESPACE"," ",241],["T_LNUMBER","1",241],["T_WHITESPACE","\n        ",241],")",";",["T_WHITESPACE","\n\n        ",242],["T_VARIABLE","$select",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_VARIABLE","$adapter",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","select",244],"(",")",["T_WHITESPACE","\n            ",244],["T_OBJECT_OPERATOR","->",245],["T_STRING","from",245],"(",["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","getTable",245],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",245],")",",",["T_WHITESPACE"," ",245],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",245],")",["T_WHITESPACE","\n            ",245],["T_OBJECT_OPERATOR","->",246],["T_STRING","where",246],"(",["T_CONSTANT_ENCAPSED_STRING","'type_id IN(?)'",246],",",["T_WHITESPACE"," ",246],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","_configTypeIds",246],")",";",["T_WHITESPACE","\n\n        ",246],["T_VARIABLE","$where",248],["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_STRING","sprintf",248],"(",["T_CONSTANT_ENCAPSED_STRING","'stock_id = %1$d'",248],["T_WHITESPACE","\n            ",248],".",["T_WHITESPACE"," ",249],["T_CONSTANT_ENCAPSED_STRING","' AND is_in_stock = 1'",249],["T_WHITESPACE","\n            ",249],".",["T_WHITESPACE"," ",250],["T_CONSTANT_ENCAPSED_STRING","' AND ((use_config_manage_stock = 1 AND 1 = %2$d) OR (use_config_manage_stock = 0 AND manage_stock = 1))'",250],["T_WHITESPACE","\n            ",250],".",["T_WHITESPACE"," ",251],["T_CONSTANT_ENCAPSED_STRING","' AND ((use_config_backorders = 1 AND %3$d = %4$d) OR (use_config_backorders = 0 AND backorders = %3$d))'",251],["T_WHITESPACE","\n            ",251],".",["T_WHITESPACE"," ",252],["T_CONSTANT_ENCAPSED_STRING","' AND ((use_config_min_qty = 1 AND qty <= %5$d) OR (use_config_min_qty = 0 AND qty <= min_qty))'",252],["T_WHITESPACE","\n            ",252],".",["T_WHITESPACE"," ",253],["T_CONSTANT_ENCAPSED_STRING","' AND product_id IN (%6$s)'",253],",",["T_WHITESPACE","\n            ",253],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","_stock",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","getId",254],"(",")",",",["T_WHITESPACE","\n            ",254],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","_isConfigManageStock",255],",",["T_WHITESPACE","\n            ",255],["T_STRING","Mage_CatalogInventory_Model_Stock",256],["T_DOUBLE_COLON","::",256],["T_STRING","BACKORDERS_NO",256],",",["T_WHITESPACE","\n            ",256],["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","_isConfigBackorders",257],",",["T_WHITESPACE","\n            ",257],["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","_configMinQty",258],",",["T_WHITESPACE","\n            ",258],["T_VARIABLE","$select",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","assemble",259],"(",")",["T_WHITESPACE","\n        ",259],")",";",["T_WHITESPACE","\n\n        ",260],["T_VARIABLE","$adapter",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","update",262],"(",["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","getTable",262],"(",["T_CONSTANT_ENCAPSED_STRING","'cataloginventory\/stock_item'",262],")",",",["T_WHITESPACE"," ",262],["T_VARIABLE","$values",262],",",["T_WHITESPACE"," ",262],["T_VARIABLE","$where",262],")",";",["T_WHITESPACE","\n    ",262],"}",["T_WHITESPACE","\n\n    ",263],["T_DOC_COMMENT","\/**\n     * Set items in stock basing on their quantities and config settings\n     *\n     *\/",265],["T_WHITESPACE","\n    ",268],["T_PUBLIC","public",269],["T_WHITESPACE"," ",269],["T_FUNCTION","function",269],["T_WHITESPACE"," ",269],["T_STRING","updateSetInStock",269],"(",")",["T_WHITESPACE","\n    ",269],"{",["T_WHITESPACE","\n        ",270],["T_VARIABLE","$this",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","_initConfig",271],"(",")",";",["T_WHITESPACE","\n        ",271],["T_VARIABLE","$adapter",272],["T_WHITESPACE"," ",272],"=",["T_WHITESPACE"," ",272],["T_VARIABLE","$this",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","_getWriteAdapter",272],"(",")",";",["T_WHITESPACE","\n        ",272],["T_VARIABLE","$values",273],["T_WHITESPACE","  ",273],"=",["T_WHITESPACE"," ",273],["T_ARRAY","array",273],"(",["T_WHITESPACE","\n            ",273],["T_CONSTANT_ENCAPSED_STRING","'is_in_stock'",274],["T_WHITESPACE","   ",274],["T_DOUBLE_ARROW","=>",274],["T_WHITESPACE"," ",274],["T_LNUMBER","1",274],",",["T_WHITESPACE","\n        ",274],")",";",["T_WHITESPACE","\n\n        ",275],["T_VARIABLE","$select",277],["T_WHITESPACE"," ",277],"=",["T_WHITESPACE"," ",277],["T_VARIABLE","$adapter",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","select",277],"(",")",["T_WHITESPACE","\n            ",277],["T_OBJECT_OPERATOR","->",278],["T_STRING","from",278],"(",["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","getTable",278],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",278],")",",",["T_WHITESPACE"," ",278],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",278],")",["T_WHITESPACE","\n            ",278],["T_OBJECT_OPERATOR","->",279],["T_STRING","where",279],"(",["T_CONSTANT_ENCAPSED_STRING","'type_id IN(?)'",279],",",["T_WHITESPACE"," ",279],["T_VARIABLE","$this",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","_configTypeIds",279],")",";",["T_WHITESPACE","\n\n        ",279],["T_VARIABLE","$where",281],["T_WHITESPACE"," ",281],"=",["T_WHITESPACE"," ",281],["T_STRING","sprintf",281],"(",["T_CONSTANT_ENCAPSED_STRING","'stock_id = %1$d'",281],["T_WHITESPACE","\n            ",281],".",["T_WHITESPACE"," ",282],["T_CONSTANT_ENCAPSED_STRING","' AND is_in_stock = 0'",282],["T_WHITESPACE","\n            ",282],".",["T_WHITESPACE"," ",283],["T_CONSTANT_ENCAPSED_STRING","' AND stock_status_changed_auto = 1'",283],["T_WHITESPACE","\n            ",283],".",["T_WHITESPACE"," ",284],["T_CONSTANT_ENCAPSED_STRING","' AND ((use_config_manage_stock = 1 AND 1 = %2$d) OR (use_config_manage_stock = 0 AND manage_stock = 1))'",284],["T_WHITESPACE","\n            ",284],".",["T_WHITESPACE"," ",285],["T_CONSTANT_ENCAPSED_STRING","' AND ((use_config_min_qty = 1 AND qty > %3$d) OR (use_config_min_qty = 0 AND qty > min_qty))'",285],["T_WHITESPACE","\n            ",285],".",["T_WHITESPACE"," ",286],["T_CONSTANT_ENCAPSED_STRING","' AND product_id IN (%4$s)'",286],",",["T_WHITESPACE","\n            ",286],["T_VARIABLE","$this",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","_stock",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","getId",287],"(",")",",",["T_WHITESPACE","\n            ",287],["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","_isConfigManageStock",288],",",["T_WHITESPACE","\n            ",288],["T_VARIABLE","$this",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","_configMinQty",289],",",["T_WHITESPACE","\n            ",289],["T_VARIABLE","$select",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","assemble",290],"(",")",["T_WHITESPACE","\n        ",290],")",";",["T_WHITESPACE","\n\n        ",291],["T_VARIABLE","$adapter",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","update",293],"(",["T_VARIABLE","$this",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","getTable",293],"(",["T_CONSTANT_ENCAPSED_STRING","'cataloginventory\/stock_item'",293],")",",",["T_WHITESPACE"," ",293],["T_VARIABLE","$values",293],",",["T_WHITESPACE"," ",293],["T_VARIABLE","$where",293],")",";",["T_WHITESPACE","\n    ",293],"}",["T_WHITESPACE","\n\n    ",294],["T_DOC_COMMENT","\/**\n     * Update items low stock date basing on their quantities and config settings\n     *\n     *\/",296],["T_WHITESPACE","\n    ",299],["T_PUBLIC","public",300],["T_WHITESPACE"," ",300],["T_FUNCTION","function",300],["T_WHITESPACE"," ",300],["T_STRING","updateLowStockDate",300],"(",")",["T_WHITESPACE","\n    ",300],"{",["T_WHITESPACE","\n        ",301],["T_VARIABLE","$this",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","_initConfig",302],"(",")",";",["T_WHITESPACE","\n\n        ",302],["T_VARIABLE","$adapter",304],["T_WHITESPACE"," ",304],"=",["T_WHITESPACE"," ",304],["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","_getWriteAdapter",304],"(",")",";",["T_WHITESPACE","\n        ",304],["T_VARIABLE","$condition",305],["T_WHITESPACE"," ",305],"=",["T_WHITESPACE"," ",305],["T_VARIABLE","$adapter",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","quoteInto",305],"(",["T_CONSTANT_ENCAPSED_STRING","'(use_config_notify_stock_qty = 1 AND qty < ?)'",305],",",["T_WHITESPACE","\n            ",305],["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","_configNotifyStockQty",306],")",["T_WHITESPACE"," ",306],".",["T_WHITESPACE"," ",306],["T_CONSTANT_ENCAPSED_STRING","' OR (use_config_notify_stock_qty = 0 AND qty < notify_stock_qty)'",306],";",["T_WHITESPACE","\n        ",306],["T_VARIABLE","$currentDbTime",307],["T_WHITESPACE"," ",307],"=",["T_WHITESPACE"," ",307],["T_VARIABLE","$adapter",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","quoteInto",307],"(",["T_CONSTANT_ENCAPSED_STRING","'?'",307],",",["T_WHITESPACE"," ",307],["T_VARIABLE","$this",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","formatDate",307],"(",["T_STRING","true",307],")",")",";",["T_WHITESPACE","\n        ",307],["T_VARIABLE","$conditionalDate",308],["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],["T_VARIABLE","$adapter",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","getCheckSql",308],"(",["T_VARIABLE","$condition",308],",",["T_WHITESPACE"," ",308],["T_VARIABLE","$currentDbTime",308],",",["T_WHITESPACE"," ",308],["T_CONSTANT_ENCAPSED_STRING","'NULL'",308],")",";",["T_WHITESPACE","\n\n        ",308],["T_VARIABLE","$value",310],["T_WHITESPACE","  ",310],"=",["T_WHITESPACE"," ",310],["T_ARRAY","array",310],"(",["T_WHITESPACE","\n            ",310],["T_CONSTANT_ENCAPSED_STRING","'low_stock_date'",311],["T_WHITESPACE"," ",311],["T_DOUBLE_ARROW","=>",311],["T_WHITESPACE"," ",311],["T_NEW","new",311],["T_WHITESPACE"," ",311],["T_STRING","Zend_Db_Expr",311],"(",["T_VARIABLE","$conditionalDate",311],")",",",["T_WHITESPACE","\n        ",311],")",";",["T_WHITESPACE","\n\n        ",312],["T_VARIABLE","$select",314],["T_WHITESPACE"," ",314],"=",["T_WHITESPACE"," ",314],["T_VARIABLE","$adapter",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","select",314],"(",")",["T_WHITESPACE","\n            ",314],["T_OBJECT_OPERATOR","->",315],["T_STRING","from",315],"(",["T_VARIABLE","$this",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","getTable",315],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",315],")",",",["T_WHITESPACE"," ",315],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",315],")",["T_WHITESPACE","\n            ",315],["T_OBJECT_OPERATOR","->",316],["T_STRING","where",316],"(",["T_CONSTANT_ENCAPSED_STRING","'type_id IN(?)'",316],",",["T_WHITESPACE"," ",316],["T_VARIABLE","$this",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","_configTypeIds",316],")",";",["T_WHITESPACE","\n\n        ",316],["T_VARIABLE","$where",318],["T_WHITESPACE"," ",318],"=",["T_WHITESPACE"," ",318],["T_STRING","sprintf",318],"(",["T_CONSTANT_ENCAPSED_STRING","'stock_id = %1$d'",318],["T_WHITESPACE","\n            ",318],".",["T_WHITESPACE"," ",319],["T_CONSTANT_ENCAPSED_STRING","' AND ((use_config_manage_stock = 1 AND 1 = %2$d) OR (use_config_manage_stock = 0 AND manage_stock = 1))'",319],["T_WHITESPACE","\n            ",319],".",["T_WHITESPACE"," ",320],["T_CONSTANT_ENCAPSED_STRING","' AND product_id IN (%3$s)'",320],",",["T_WHITESPACE","\n            ",320],["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","_stock",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","getId",321],"(",")",",",["T_WHITESPACE","\n            ",321],["T_VARIABLE","$this",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","_isConfigManageStock",322],",",["T_WHITESPACE","\n            ",322],["T_VARIABLE","$select",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","assemble",323],"(",")",["T_WHITESPACE","\n        ",323],")",";",["T_WHITESPACE","\n\n        ",324],["T_VARIABLE","$adapter",326],["T_OBJECT_OPERATOR","->",326],["T_STRING","update",326],"(",["T_VARIABLE","$this",326],["T_OBJECT_OPERATOR","->",326],["T_STRING","getTable",326],"(",["T_CONSTANT_ENCAPSED_STRING","'cataloginventory\/stock_item'",326],")",",",["T_WHITESPACE"," ",326],["T_VARIABLE","$value",326],",",["T_WHITESPACE"," ",326],["T_VARIABLE","$where",326],")",";",["T_WHITESPACE","\n    ",326],"}",["T_WHITESPACE","\n\n    ",327],["T_DOC_COMMENT","\/**\n     * Add low stock filter to product collection\n     *\n     * @param Mage_Catalog_Model_Resource_Product_Collection $collection\n     * @param array $fields\n     * @return Mage_CatalogInventory_Model_Resource_Stock\n     *\/",329],["T_WHITESPACE","\n    ",335],["T_PUBLIC","public",336],["T_WHITESPACE"," ",336],["T_FUNCTION","function",336],["T_WHITESPACE"," ",336],["T_STRING","addLowStockFilter",336],"(",["T_STRING","Mage_Catalog_Model_Resource_Product_Collection",336],["T_WHITESPACE"," ",336],["T_VARIABLE","$collection",336],",",["T_WHITESPACE"," ",336],["T_VARIABLE","$fields",336],")",["T_WHITESPACE","\n    ",336],"{",["T_WHITESPACE","\n        ",337],["T_VARIABLE","$this",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","_initConfig",338],"(",")",";",["T_WHITESPACE","\n        ",338],["T_VARIABLE","$adapter",339],["T_WHITESPACE"," ",339],"=",["T_WHITESPACE"," ",339],["T_VARIABLE","$collection",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","getSelect",339],"(",")",["T_OBJECT_OPERATOR","->",339],["T_STRING","getAdapter",339],"(",")",";",["T_WHITESPACE","\n        ",339],["T_VARIABLE","$qtyIf",340],["T_WHITESPACE"," ",340],"=",["T_WHITESPACE"," ",340],["T_VARIABLE","$adapter",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","getCheckSql",340],"(",["T_WHITESPACE","\n            ",340],["T_CONSTANT_ENCAPSED_STRING","'invtr.use_config_notify_stock_qty'",341],",",["T_WHITESPACE","\n            ",341],["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","_configNotifyStockQty",342],",",["T_WHITESPACE","\n            ",342],["T_CONSTANT_ENCAPSED_STRING","'invtr.notify_stock_qty'",343],["T_WHITESPACE","\n        ",343],")",";",["T_WHITESPACE","\n        ",344],["T_VARIABLE","$conditions",345],["T_WHITESPACE"," ",345],"=",["T_WHITESPACE"," ",345],["T_ARRAY","array",345],"(",["T_WHITESPACE","\n            ",345],["T_ARRAY","array",346],"(",["T_WHITESPACE","\n                ",346],["T_VARIABLE","$adapter",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","prepareSqlCondition",347],"(",["T_CONSTANT_ENCAPSED_STRING","'invtr.use_config_manage_stock'",347],",",["T_WHITESPACE"," ",347],["T_LNUMBER","1",347],")",",",["T_WHITESPACE","\n                ",347],["T_VARIABLE","$adapter",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","prepareSqlCondition",348],"(",["T_VARIABLE","$this",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","_isConfigManageStock",348],",",["T_WHITESPACE"," ",348],["T_LNUMBER","1",348],")",",",["T_WHITESPACE","\n                ",348],["T_VARIABLE","$adapter",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","prepareSqlCondition",349],"(",["T_CONSTANT_ENCAPSED_STRING","'invtr.qty'",349],",",["T_WHITESPACE"," ",349],["T_ARRAY","array",349],"(",["T_CONSTANT_ENCAPSED_STRING","'lt'",349],["T_WHITESPACE"," ",349],["T_DOUBLE_ARROW","=>",349],["T_WHITESPACE"," ",349],["T_VARIABLE","$qtyIf",349],")",")",["T_WHITESPACE","\n            ",349],")",",",["T_WHITESPACE","\n            ",350],["T_ARRAY","array",351],"(",["T_WHITESPACE","\n                ",351],["T_VARIABLE","$adapter",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","prepareSqlCondition",352],"(",["T_CONSTANT_ENCAPSED_STRING","'invtr.use_config_manage_stock'",352],",",["T_WHITESPACE"," ",352],["T_LNUMBER","0",352],")",",",["T_WHITESPACE","\n                ",352],["T_VARIABLE","$adapter",353],["T_OBJECT_OPERATOR","->",353],["T_STRING","prepareSqlCondition",353],"(",["T_CONSTANT_ENCAPSED_STRING","'invtr.manage_stock'",353],",",["T_WHITESPACE"," ",353],["T_LNUMBER","1",353],")",["T_WHITESPACE","\n            ",353],")",["T_WHITESPACE","\n        ",354],")",";",["T_WHITESPACE","\n\n        ",355],["T_VARIABLE","$where",357],["T_WHITESPACE"," ",357],"=",["T_WHITESPACE"," ",357],["T_ARRAY","array",357],"(",")",";",["T_WHITESPACE","\n        ",357],["T_FOREACH","foreach",358],["T_WHITESPACE"," ",358],"(",["T_VARIABLE","$conditions",358],["T_WHITESPACE"," ",358],["T_AS","as",358],["T_WHITESPACE"," ",358],["T_VARIABLE","$k",358],["T_WHITESPACE"," ",358],["T_DOUBLE_ARROW","=>",358],["T_WHITESPACE"," ",358],["T_VARIABLE","$part",358],")",["T_WHITESPACE"," ",358],"{",["T_WHITESPACE","\n            ",358],["T_VARIABLE","$where",359],"[",["T_VARIABLE","$k",359],"]",["T_WHITESPACE"," ",359],"=",["T_WHITESPACE"," ",359],["T_STRING","join",359],"(",["T_CONSTANT_ENCAPSED_STRING","' '",359],["T_WHITESPACE"," ",359],".",["T_WHITESPACE"," ",359],["T_STRING","Zend_Db_Select",359],["T_DOUBLE_COLON","::",359],["T_STRING","SQL_AND",359],["T_WHITESPACE"," ",359],".",["T_WHITESPACE"," ",359],["T_CONSTANT_ENCAPSED_STRING","' '",359],",",["T_WHITESPACE"," ",359],["T_VARIABLE","$part",359],")",";",["T_WHITESPACE","\n        ",359],"}",["T_WHITESPACE","\n\n        ",360],["T_VARIABLE","$where",362],["T_WHITESPACE"," ",362],"=",["T_WHITESPACE"," ",362],["T_VARIABLE","$adapter",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","prepareSqlCondition",362],"(",["T_CONSTANT_ENCAPSED_STRING","'invtr.low_stock_date'",362],",",["T_WHITESPACE"," ",362],["T_ARRAY","array",362],"(",["T_CONSTANT_ENCAPSED_STRING","'notnull'",362],["T_WHITESPACE"," ",362],["T_DOUBLE_ARROW","=>",362],["T_WHITESPACE"," ",362],["T_STRING","true",362],")",")",["T_WHITESPACE","\n            ",362],".",["T_WHITESPACE"," ",363],["T_CONSTANT_ENCAPSED_STRING","' '",363],["T_WHITESPACE"," ",363],".",["T_WHITESPACE"," ",363],["T_STRING","Zend_Db_Select",363],["T_DOUBLE_COLON","::",363],["T_STRING","SQL_AND",363],["T_WHITESPACE"," ",363],".",["T_WHITESPACE"," ",363],["T_CONSTANT_ENCAPSED_STRING","' (('",363],["T_WHITESPACE","\n            ",363],".",["T_WHITESPACE","  ",364],["T_STRING","join",364],"(",["T_CONSTANT_ENCAPSED_STRING","') '",364],["T_WHITESPACE"," ",364],".",["T_WHITESPACE"," ",364],["T_STRING","Zend_Db_Select",364],["T_DOUBLE_COLON","::",364],["T_STRING","SQL_OR",364],["T_WHITESPACE"," ",364],".",["T_CONSTANT_ENCAPSED_STRING","' ('",364],",",["T_WHITESPACE"," ",364],["T_VARIABLE","$where",364],")",["T_WHITESPACE","\n            ",364],".",["T_WHITESPACE"," ",365],["T_CONSTANT_ENCAPSED_STRING","'))'",365],";",["T_WHITESPACE","\n\n        ",365],["T_VARIABLE","$collection",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","joinTable",367],"(",["T_ARRAY","array",367],"(",["T_CONSTANT_ENCAPSED_STRING","'invtr'",367],["T_WHITESPACE"," ",367],["T_DOUBLE_ARROW","=>",367],["T_WHITESPACE"," ",367],["T_CONSTANT_ENCAPSED_STRING","'cataloginventory\/stock_item'",367],")",",",["T_WHITESPACE","\n            ",367],["T_CONSTANT_ENCAPSED_STRING","'product_id = entity_id'",368],",",["T_WHITESPACE","\n            ",368],["T_VARIABLE","$fields",369],",",["T_WHITESPACE","\n            ",369],["T_VARIABLE","$where",370],["T_WHITESPACE","\n        ",370],")",";",["T_WHITESPACE","\n        ",371],["T_RETURN","return",372],["T_WHITESPACE"," ",372],["T_VARIABLE","$this",372],";",["T_WHITESPACE","\n    ",372],"}",["T_WHITESPACE","\n",373],"}",["T_WHITESPACE","\n",374]]