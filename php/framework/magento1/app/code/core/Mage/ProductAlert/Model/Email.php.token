[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_ProductAlert\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * ProductAlert Email processor\n *\n * @category   Mage\n * @package    Mage_ProductAlert\n * @author     Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_ProductAlert_Model_Email",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Model_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_CONST","const",37],["T_WHITESPACE"," ",37],["T_STRING","XML_PATH_EMAIL_PRICE_TEMPLATE",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'catalog\/productalert\/email_price_template'",37],";",["T_WHITESPACE","\n    ",37],["T_CONST","const",38],["T_WHITESPACE"," ",38],["T_STRING","XML_PATH_EMAIL_STOCK_TEMPLATE",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_CONSTANT_ENCAPSED_STRING","'catalog\/productalert\/email_stock_template'",38],";",["T_WHITESPACE","\n    ",38],["T_CONST","const",39],["T_WHITESPACE"," ",39],["T_STRING","XML_PATH_EMAIL_IDENTITY",39],["T_WHITESPACE","       ",39],"=",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'catalog\/productalert\/email_identity'",39],";",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * Type\n     *\n     * @var string\n     *\/",41],["T_WHITESPACE","\n    ",45],["T_PROTECTED","protected",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$_type",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'price'",46],";",["T_WHITESPACE","\n\n    ",46],["T_DOC_COMMENT","\/**\n     * Website Model\n     *\n     * @var Mage_Core_Model_Website\n     *\/",48],["T_WHITESPACE","\n    ",52],["T_PROTECTED","protected",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$_website",53],";",["T_WHITESPACE","\n\n    ",53],["T_DOC_COMMENT","\/**\n     * Customer model\n     *\n     * @var Mage_Customer_Model_Customer\n     *\/",55],["T_WHITESPACE","\n    ",59],["T_PROTECTED","protected",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$_customer",60],";",["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * Products collection where changed price\n     *\n     * @var array\n     *\/",62],["T_WHITESPACE","\n    ",66],["T_PROTECTED","protected",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$_priceProducts",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_ARRAY","array",67],"(",")",";",["T_WHITESPACE","\n\n    ",67],["T_DOC_COMMENT","\/**\n     * Product collection which of back in stock\n     *\n     * @var array\n     *\/",69],["T_WHITESPACE","\n    ",73],["T_PROTECTED","protected",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$_stockProducts",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_ARRAY","array",74],"(",")",";",["T_WHITESPACE","\n\n    ",74],["T_DOC_COMMENT","\/**\n     * Price block\n     *\n     * @var Mage_ProductAlert_Block_Email_Price\n     *\/",76],["T_WHITESPACE","\n    ",80],["T_PROTECTED","protected",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$_priceBlock",81],";",["T_WHITESPACE","\n\n    ",81],["T_DOC_COMMENT","\/**\n     * Stock block\n     *\n     * @var Mage_ProductAlert_Block_Email_Stock\n     *\/",83],["T_WHITESPACE","\n    ",87],["T_PROTECTED","protected",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$_stockBlock",88],";",["T_WHITESPACE","\n\n    ",88],["T_DOC_COMMENT","\/**\n     * Set model type\n     *\n     * @param string $type\n     *\/",90],["T_WHITESPACE","\n    ",94],["T_PUBLIC","public",95],["T_WHITESPACE"," ",95],["T_FUNCTION","function",95],["T_WHITESPACE"," ",95],["T_STRING","setType",95],"(",["T_VARIABLE","$type",95],")",["T_WHITESPACE","\n    ",95],"{",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","_type",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$type",97],";",["T_WHITESPACE","\n    ",97],"}",["T_WHITESPACE","\n\n    ",98],["T_DOC_COMMENT","\/**\n     * Retrieve model type\n     *\n     * @return string\n     *\/",100],["T_WHITESPACE","\n    ",104],["T_PUBLIC","public",105],["T_WHITESPACE"," ",105],["T_FUNCTION","function",105],["T_WHITESPACE"," ",105],["T_STRING","getType",105],"(",")",["T_WHITESPACE","\n    ",105],"{",["T_WHITESPACE","\n        ",106],["T_RETURN","return",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","_type",107],";",["T_WHITESPACE","\n    ",107],"}",["T_WHITESPACE","\n\n    ",108],["T_DOC_COMMENT","\/**\n     * Set website model\n     *\n     * @param Mage_Core_Model_Website $website\n     * @return Mage_ProductAlert_Model_Email\n     *\/",110],["T_WHITESPACE","\n    ",115],["T_PUBLIC","public",116],["T_WHITESPACE"," ",116],["T_FUNCTION","function",116],["T_WHITESPACE"," ",116],["T_STRING","setWebsite",116],"(",["T_STRING","Mage_Core_Model_Website",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$website",116],")",["T_WHITESPACE","\n    ",116],"{",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","_website",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$website",118],";",["T_WHITESPACE","\n        ",118],["T_RETURN","return",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],";",["T_WHITESPACE","\n    ",119],"}",["T_WHITESPACE","\n\n    ",120],["T_DOC_COMMENT","\/**\n     * Set website id\n     *\n     * @param int $websiteId\n     * @return Mage_ProductAlert_Model_Email\n     *\/",122],["T_WHITESPACE","\n    ",127],["T_PUBLIC","public",128],["T_WHITESPACE"," ",128],["T_FUNCTION","function",128],["T_WHITESPACE"," ",128],["T_STRING","setWebsiteId",128],"(",["T_VARIABLE","$websiteId",128],")",["T_WHITESPACE","\n    ",128],"{",["T_WHITESPACE","\n        ",129],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","_website",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_STRING","Mage",130],["T_DOUBLE_COLON","::",130],["T_STRING","app",130],"(",")",["T_OBJECT_OPERATOR","->",130],["T_STRING","getWebsite",130],"(",["T_VARIABLE","$websiteId",130],")",";",["T_WHITESPACE","\n        ",130],["T_RETURN","return",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],";",["T_WHITESPACE","\n    ",131],"}",["T_WHITESPACE","\n\n    ",132],["T_DOC_COMMENT","\/**\n     * Set customer by id\n     *\n     * @param int $customerId\n     * @return Mage_ProductAlert_Model_Email\n     *\/",134],["T_WHITESPACE","\n    ",139],["T_PUBLIC","public",140],["T_WHITESPACE"," ",140],["T_FUNCTION","function",140],["T_WHITESPACE"," ",140],["T_STRING","setCustomerId",140],"(",["T_VARIABLE","$customerId",140],")",["T_WHITESPACE","\n    ",140],"{",["T_WHITESPACE","\n        ",141],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","_customer",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_STRING","Mage",142],["T_DOUBLE_COLON","::",142],["T_STRING","getModel",142],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/customer'",142],")",["T_OBJECT_OPERATOR","->",142],["T_STRING","load",142],"(",["T_VARIABLE","$customerId",142],")",";",["T_WHITESPACE","\n        ",142],["T_RETURN","return",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],";",["T_WHITESPACE","\n    ",143],"}",["T_WHITESPACE","\n\n    ",144],["T_DOC_COMMENT","\/**\n     * Set customer model\n     *\n     * @param Mage_Customer_Model_Customer $customer\n     * @return Mage_ProductAlert_Model_Email\n     *\/",146],["T_WHITESPACE","\n    ",151],["T_PUBLIC","public",152],["T_WHITESPACE"," ",152],["T_FUNCTION","function",152],["T_WHITESPACE"," ",152],["T_STRING","setCustomer",152],"(",["T_STRING","Mage_Customer_Model_Customer",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$customer",152],")",["T_WHITESPACE","\n    ",152],"{",["T_WHITESPACE","\n        ",153],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","_customer",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_VARIABLE","$customer",154],";",["T_WHITESPACE","\n        ",154],["T_RETURN","return",155],["T_WHITESPACE"," ",155],["T_VARIABLE","$this",155],";",["T_WHITESPACE","\n    ",155],"}",["T_WHITESPACE","\n\n    ",156],["T_DOC_COMMENT","\/**\n     * Clean data\n     *\n     * @return Mage_ProductAlert_Model_Email\n     *\/",158],["T_WHITESPACE","\n    ",162],["T_PUBLIC","public",163],["T_WHITESPACE"," ",163],["T_FUNCTION","function",163],["T_WHITESPACE"," ",163],["T_STRING","clean",163],"(",")",["T_WHITESPACE","\n    ",163],"{",["T_WHITESPACE","\n        ",164],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","_customer",165],["T_WHITESPACE","      ",165],"=",["T_WHITESPACE"," ",165],["T_STRING","null",165],";",["T_WHITESPACE","\n        ",165],["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","_priceProducts",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_ARRAY","array",166],"(",")",";",["T_WHITESPACE","\n        ",166],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","_stockProducts",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_ARRAY","array",167],"(",")",";",["T_WHITESPACE","\n\n        ",167],["T_RETURN","return",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$this",169],";",["T_WHITESPACE","\n    ",169],"}",["T_WHITESPACE","\n\n    ",170],["T_DOC_COMMENT","\/**\n     * Add product (price change) to collection\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return Mage_ProductAlert_Model_Email\n     *\/",172],["T_WHITESPACE","\n    ",177],["T_PUBLIC","public",178],["T_WHITESPACE"," ",178],["T_FUNCTION","function",178],["T_WHITESPACE"," ",178],["T_STRING","addPriceProduct",178],"(",["T_STRING","Mage_Catalog_Model_Product",178],["T_WHITESPACE"," ",178],["T_VARIABLE","$product",178],")",["T_WHITESPACE","\n    ",178],"{",["T_WHITESPACE","\n        ",179],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","_priceProducts",180],"[",["T_VARIABLE","$product",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","getId",180],"(",")","]",["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_VARIABLE","$product",180],";",["T_WHITESPACE","\n        ",180],["T_RETURN","return",181],["T_WHITESPACE"," ",181],["T_VARIABLE","$this",181],";",["T_WHITESPACE","\n    ",181],"}",["T_WHITESPACE","\n\n    ",182],["T_DOC_COMMENT","\/**\n     * Add product (back in stock) to collection\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return Mage_ProductAlert_Model_Email\n     *\/",184],["T_WHITESPACE","\n    ",189],["T_PUBLIC","public",190],["T_WHITESPACE"," ",190],["T_FUNCTION","function",190],["T_WHITESPACE"," ",190],["T_STRING","addStockProduct",190],"(",["T_STRING","Mage_Catalog_Model_Product",190],["T_WHITESPACE"," ",190],["T_VARIABLE","$product",190],")",["T_WHITESPACE","\n    ",190],"{",["T_WHITESPACE","\n        ",191],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","_stockProducts",192],"[",["T_VARIABLE","$product",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","getId",192],"(",")","]",["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_VARIABLE","$product",192],";",["T_WHITESPACE","\n        ",192],["T_RETURN","return",193],["T_WHITESPACE"," ",193],["T_VARIABLE","$this",193],";",["T_WHITESPACE","\n    ",193],"}",["T_WHITESPACE","\n\n    ",194],["T_DOC_COMMENT","\/**\n     * Retrieve price block\n     *\n     * @return Mage_ProductAlert_Block_Email_Price\n     *\/",196],["T_WHITESPACE","\n    ",200],["T_PROTECTED","protected",201],["T_WHITESPACE"," ",201],["T_FUNCTION","function",201],["T_WHITESPACE"," ",201],["T_STRING","_getPriceBlock",201],"(",")",["T_WHITESPACE","\n    ",201],"{",["T_WHITESPACE","\n        ",202],["T_IF","if",203],["T_WHITESPACE"," ",203],"(",["T_STRING","is_null",203],"(",["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","_priceBlock",203],")",")",["T_WHITESPACE"," ",203],"{",["T_WHITESPACE","\n            ",203],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","_priceBlock",204],["T_WHITESPACE"," ",204],"=",["T_WHITESPACE"," ",204],["T_STRING","Mage",204],["T_DOUBLE_COLON","::",204],["T_STRING","helper",204],"(",["T_CONSTANT_ENCAPSED_STRING","'productalert'",204],")",["T_WHITESPACE","\n                ",204],["T_OBJECT_OPERATOR","->",205],["T_STRING","createBlock",205],"(",["T_CONSTANT_ENCAPSED_STRING","'productalert\/email_price'",205],")",";",["T_WHITESPACE","\n        ",205],"}",["T_WHITESPACE","\n        ",206],["T_RETURN","return",207],["T_WHITESPACE"," ",207],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","_priceBlock",207],";",["T_WHITESPACE","\n    ",207],"}",["T_WHITESPACE","\n\n    ",208],["T_DOC_COMMENT","\/**\n     * Retrieve stock block\n     *\n     * @return Mage_ProductAlert_Block_Email_Stock\n     *\/",210],["T_WHITESPACE","\n    ",214],["T_PROTECTED","protected",215],["T_WHITESPACE"," ",215],["T_FUNCTION","function",215],["T_WHITESPACE"," ",215],["T_STRING","_getStockBlock",215],"(",")",["T_WHITESPACE","\n    ",215],"{",["T_WHITESPACE","\n        ",216],["T_IF","if",217],["T_WHITESPACE"," ",217],"(",["T_STRING","is_null",217],"(",["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","_stockBlock",217],")",")",["T_WHITESPACE"," ",217],"{",["T_WHITESPACE","\n            ",217],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","_stockBlock",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_STRING","Mage",218],["T_DOUBLE_COLON","::",218],["T_STRING","helper",218],"(",["T_CONSTANT_ENCAPSED_STRING","'productalert'",218],")",["T_WHITESPACE","\n                ",218],["T_OBJECT_OPERATOR","->",219],["T_STRING","createBlock",219],"(",["T_CONSTANT_ENCAPSED_STRING","'productalert\/email_stock'",219],")",";",["T_WHITESPACE","\n        ",219],"}",["T_WHITESPACE","\n        ",220],["T_RETURN","return",221],["T_WHITESPACE"," ",221],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","_stockBlock",221],";",["T_WHITESPACE","\n    ",221],"}",["T_WHITESPACE","\n\n    ",222],["T_DOC_COMMENT","\/**\n     * Send customer email\n     *\n     * @return bool\n     *\/",224],["T_WHITESPACE","\n    ",228],["T_PUBLIC","public",229],["T_WHITESPACE"," ",229],["T_FUNCTION","function",229],["T_WHITESPACE"," ",229],["T_STRING","send",229],"(",")",["T_WHITESPACE","\n    ",229],"{",["T_WHITESPACE","\n        ",230],["T_IF","if",231],["T_WHITESPACE"," ",231],"(",["T_STRING","is_null",231],"(",["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","_website",231],")",["T_WHITESPACE"," ",231],["T_BOOLEAN_OR","||",231],["T_WHITESPACE"," ",231],["T_STRING","is_null",231],"(",["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","_customer",231],")",")",["T_WHITESPACE"," ",231],"{",["T_WHITESPACE","\n            ",231],["T_RETURN","return",232],["T_WHITESPACE"," ",232],["T_STRING","false",232],";",["T_WHITESPACE","\n        ",232],"}",["T_WHITESPACE","\n        ",233],["T_IF","if",234],["T_WHITESPACE"," ",234],"(","(",["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","_type",234],["T_WHITESPACE"," ",234],["T_IS_EQUAL","==",234],["T_WHITESPACE"," ",234],["T_CONSTANT_ENCAPSED_STRING","'price'",234],["T_WHITESPACE"," ",234],["T_BOOLEAN_AND","&&",234],["T_WHITESPACE"," ",234],["T_STRING","count",234],"(",["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","_priceProducts",234],")",["T_WHITESPACE"," ",234],["T_IS_EQUAL","==",234],["T_WHITESPACE"," ",234],["T_LNUMBER","0",234],")",["T_WHITESPACE","\n            ",234],["T_BOOLEAN_OR","||",235],["T_WHITESPACE"," ",235],"(",["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","_type",235],["T_WHITESPACE"," ",235],["T_IS_EQUAL","==",235],["T_WHITESPACE"," ",235],["T_CONSTANT_ENCAPSED_STRING","'stock'",235],["T_WHITESPACE"," ",235],["T_BOOLEAN_AND","&&",235],["T_WHITESPACE"," ",235],["T_STRING","count",235],"(",["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","_stockProducts",235],")",["T_WHITESPACE"," ",235],["T_IS_EQUAL","==",235],["T_WHITESPACE"," ",235],["T_LNUMBER","0",235],")",["T_WHITESPACE","\n        ",235],")",["T_WHITESPACE"," ",236],"{",["T_WHITESPACE","\n            ",236],["T_RETURN","return",237],["T_WHITESPACE"," ",237],["T_STRING","false",237],";",["T_WHITESPACE","\n        ",237],"}",["T_WHITESPACE","\n        ",238],["T_IF","if",239],["T_WHITESPACE"," ",239],"(","!",["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","_website",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","getDefaultGroup",239],"(",")",["T_WHITESPACE"," ",239],["T_BOOLEAN_OR","||",239],["T_WHITESPACE"," ",239],"!",["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","_website",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","getDefaultGroup",239],"(",")",["T_OBJECT_OPERATOR","->",239],["T_STRING","getDefaultStore",239],"(",")",")",["T_WHITESPACE"," ",239],"{",["T_WHITESPACE","\n            ",239],["T_RETURN","return",240],["T_WHITESPACE"," ",240],["T_STRING","false",240],";",["T_WHITESPACE","\n        ",240],"}",["T_WHITESPACE","\n\n        ",241],["T_VARIABLE","$store",243],["T_WHITESPACE","      ",243],"=",["T_WHITESPACE"," ",243],["T_STRING","Mage",243],["T_DOUBLE_COLON","::",243],["T_STRING","getModel",243],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/store'",243],")",["T_OBJECT_OPERATOR","->",243],["T_STRING","load",243],"(",["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","_customer",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","getStoreId",243],"(",")",")",";",["T_WHITESPACE","\n        ",243],["T_VARIABLE","$storeId",244],["T_WHITESPACE","    ",244],"=",["T_WHITESPACE"," ",244],["T_VARIABLE","$store",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","getId",244],"(",")",";",["T_WHITESPACE","\n\n        ",244],["T_IF","if",246],["T_WHITESPACE"," ",246],"(",["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","_type",246],["T_WHITESPACE"," ",246],["T_IS_EQUAL","==",246],["T_WHITESPACE"," ",246],["T_CONSTANT_ENCAPSED_STRING","'price'",246],["T_WHITESPACE"," ",246],["T_BOOLEAN_AND","&&",246],["T_WHITESPACE"," ",246],"!",["T_STRING","Mage",246],["T_DOUBLE_COLON","::",246],["T_STRING","getStoreConfig",246],"(",["T_STRING","self",246],["T_DOUBLE_COLON","::",246],["T_STRING","XML_PATH_EMAIL_PRICE_TEMPLATE",246],",",["T_WHITESPACE"," ",246],["T_VARIABLE","$storeId",246],")",")",["T_WHITESPACE"," ",246],"{",["T_WHITESPACE","\n            ",246],["T_RETURN","return",247],["T_WHITESPACE"," ",247],["T_STRING","false",247],";",["T_WHITESPACE","\n        ",247],"}",["T_WHITESPACE"," ",248],["T_ELSEIF","elseif",248],["T_WHITESPACE"," ",248],"(",["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","_type",248],["T_WHITESPACE"," ",248],["T_IS_EQUAL","==",248],["T_WHITESPACE"," ",248],["T_CONSTANT_ENCAPSED_STRING","'stock'",248],["T_WHITESPACE"," ",248],["T_BOOLEAN_AND","&&",248],["T_WHITESPACE"," ",248],"!",["T_STRING","Mage",248],["T_DOUBLE_COLON","::",248],["T_STRING","getStoreConfig",248],"(",["T_STRING","self",248],["T_DOUBLE_COLON","::",248],["T_STRING","XML_PATH_EMAIL_STOCK_TEMPLATE",248],",",["T_WHITESPACE"," ",248],["T_VARIABLE","$storeId",248],")",")",["T_WHITESPACE"," ",248],"{",["T_WHITESPACE","\n            ",248],["T_RETURN","return",249],["T_WHITESPACE"," ",249],["T_STRING","false",249],";",["T_WHITESPACE","\n        ",249],"}",["T_WHITESPACE","\n\n        ",250],["T_IF","if",252],["T_WHITESPACE"," ",252],"(",["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","_type",252],["T_WHITESPACE"," ",252],["T_IS_NOT_EQUAL","!=",252],["T_WHITESPACE"," ",252],["T_CONSTANT_ENCAPSED_STRING","'price'",252],["T_WHITESPACE"," ",252],["T_BOOLEAN_AND","&&",252],["T_WHITESPACE"," ",252],["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","_type",252],["T_WHITESPACE"," ",252],["T_IS_NOT_EQUAL","!=",252],["T_WHITESPACE"," ",252],["T_CONSTANT_ENCAPSED_STRING","'stock'",252],")",["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n            ",252],["T_RETURN","return",253],["T_WHITESPACE"," ",253],["T_STRING","false",253],";",["T_WHITESPACE","\n        ",253],"}",["T_WHITESPACE","\n\n        ",254],["T_VARIABLE","$appEmulation",256],["T_WHITESPACE"," ",256],"=",["T_WHITESPACE"," ",256],["T_STRING","Mage",256],["T_DOUBLE_COLON","::",256],["T_STRING","getSingleton",256],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/app_emulation'",256],")",";",["T_WHITESPACE","\n        ",256],["T_VARIABLE","$initialEnvironmentInfo",257],["T_WHITESPACE"," ",257],"=",["T_WHITESPACE"," ",257],["T_VARIABLE","$appEmulation",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","startEnvironmentEmulation",257],"(",["T_VARIABLE","$storeId",257],")",";",["T_WHITESPACE","\n        ",257],["T_STRING","Mage",258],["T_DOUBLE_COLON","::",258],["T_STRING","app",258],"(",")",["T_OBJECT_OPERATOR","->",258],["T_STRING","getTranslator",258],"(",")",["T_OBJECT_OPERATOR","->",258],["T_STRING","init",258],"(",["T_CONSTANT_ENCAPSED_STRING","'frontend'",258],",",["T_WHITESPACE"," ",258],["T_STRING","true",258],")",";",["T_WHITESPACE","\n\n        ",258],["T_IF","if",260],["T_WHITESPACE"," ",260],"(",["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","_type",260],["T_WHITESPACE"," ",260],["T_IS_EQUAL","==",260],["T_WHITESPACE"," ",260],["T_CONSTANT_ENCAPSED_STRING","'price'",260],")",["T_WHITESPACE"," ",260],"{",["T_WHITESPACE","\n            ",260],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","_getPriceBlock",261],"(",")",["T_WHITESPACE","\n                ",261],["T_OBJECT_OPERATOR","->",262],["T_STRING","setStore",262],"(",["T_VARIABLE","$store",262],")",["T_WHITESPACE","\n                ",262],["T_OBJECT_OPERATOR","->",263],["T_STRING","reset",263],"(",")",";",["T_WHITESPACE","\n            ",263],["T_FOREACH","foreach",264],["T_WHITESPACE"," ",264],"(",["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","_priceProducts",264],["T_WHITESPACE"," ",264],["T_AS","as",264],["T_WHITESPACE"," ",264],["T_VARIABLE","$product",264],")",["T_WHITESPACE"," ",264],"{",["T_WHITESPACE","\n                ",264],["T_VARIABLE","$product",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","setCustomerGroupId",265],"(",["T_VARIABLE","$this",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","_customer",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","getGroupId",265],"(",")",")",";",["T_WHITESPACE","\n                ",265],["T_VARIABLE","$this",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","_getPriceBlock",266],"(",")",["T_OBJECT_OPERATOR","->",266],["T_STRING","addProduct",266],"(",["T_VARIABLE","$product",266],")",";",["T_WHITESPACE","\n            ",266],"}",["T_WHITESPACE","\n            ",267],["T_VARIABLE","$block",268],["T_WHITESPACE"," ",268],"=",["T_WHITESPACE"," ",268],["T_VARIABLE","$this",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","_getPriceBlock",268],"(",")",["T_OBJECT_OPERATOR","->",268],["T_STRING","toHtml",268],"(",")",";",["T_WHITESPACE","\n            ",268],["T_VARIABLE","$templateId",269],["T_WHITESPACE"," ",269],"=",["T_WHITESPACE"," ",269],["T_STRING","Mage",269],["T_DOUBLE_COLON","::",269],["T_STRING","getStoreConfig",269],"(",["T_STRING","self",269],["T_DOUBLE_COLON","::",269],["T_STRING","XML_PATH_EMAIL_PRICE_TEMPLATE",269],",",["T_WHITESPACE"," ",269],["T_VARIABLE","$storeId",269],")",";",["T_WHITESPACE","\n        ",269],"}",["T_WHITESPACE"," ",270],["T_ELSE","else",270],["T_WHITESPACE"," ",270],"{",["T_WHITESPACE","\n            ",270],["T_VARIABLE","$this",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","_getStockBlock",271],"(",")",["T_WHITESPACE","\n                ",271],["T_OBJECT_OPERATOR","->",272],["T_STRING","setStore",272],"(",["T_VARIABLE","$store",272],")",["T_WHITESPACE","\n                ",272],["T_OBJECT_OPERATOR","->",273],["T_STRING","reset",273],"(",")",";",["T_WHITESPACE","\n            ",273],["T_FOREACH","foreach",274],["T_WHITESPACE"," ",274],"(",["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","_stockProducts",274],["T_WHITESPACE"," ",274],["T_AS","as",274],["T_WHITESPACE"," ",274],["T_VARIABLE","$product",274],")",["T_WHITESPACE"," ",274],"{",["T_WHITESPACE","\n                ",274],["T_VARIABLE","$product",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","setCustomerGroupId",275],"(",["T_VARIABLE","$this",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","_customer",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","getGroupId",275],"(",")",")",";",["T_WHITESPACE","\n                ",275],["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","_getStockBlock",276],"(",")",["T_OBJECT_OPERATOR","->",276],["T_STRING","addProduct",276],"(",["T_VARIABLE","$product",276],")",";",["T_WHITESPACE","\n            ",276],"}",["T_WHITESPACE","\n            ",277],["T_VARIABLE","$block",278],["T_WHITESPACE"," ",278],"=",["T_WHITESPACE"," ",278],["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","_getStockBlock",278],"(",")",["T_OBJECT_OPERATOR","->",278],["T_STRING","toHtml",278],"(",")",";",["T_WHITESPACE","\n            ",278],["T_VARIABLE","$templateId",279],["T_WHITESPACE"," ",279],"=",["T_WHITESPACE"," ",279],["T_STRING","Mage",279],["T_DOUBLE_COLON","::",279],["T_STRING","getStoreConfig",279],"(",["T_STRING","self",279],["T_DOUBLE_COLON","::",279],["T_STRING","XML_PATH_EMAIL_STOCK_TEMPLATE",279],",",["T_WHITESPACE"," ",279],["T_VARIABLE","$storeId",279],")",";",["T_WHITESPACE","\n        ",279],"}",["T_WHITESPACE","\n\n        ",280],["T_VARIABLE","$appEmulation",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","stopEnvironmentEmulation",282],"(",["T_VARIABLE","$initialEnvironmentInfo",282],")",";",["T_WHITESPACE","\n\n        ",282],["T_STRING","Mage",284],["T_DOUBLE_COLON","::",284],["T_STRING","getModel",284],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/email_template'",284],")",["T_WHITESPACE","\n            ",284],["T_OBJECT_OPERATOR","->",285],["T_STRING","setDesignConfig",285],"(",["T_ARRAY","array",285],"(",["T_WHITESPACE","\n                ",285],["T_CONSTANT_ENCAPSED_STRING","'area'",286],["T_WHITESPACE","  ",286],["T_DOUBLE_ARROW","=>",286],["T_WHITESPACE"," ",286],["T_CONSTANT_ENCAPSED_STRING","'frontend'",286],",",["T_WHITESPACE","\n                ",286],["T_CONSTANT_ENCAPSED_STRING","'store'",287],["T_WHITESPACE"," ",287],["T_DOUBLE_ARROW","=>",287],["T_WHITESPACE"," ",287],["T_VARIABLE","$storeId",287],["T_WHITESPACE","\n            ",287],")",")",["T_OBJECT_OPERATOR","->",288],["T_STRING","sendTransactional",288],"(",["T_WHITESPACE","\n                ",288],["T_VARIABLE","$templateId",289],",",["T_WHITESPACE","\n                ",289],["T_STRING","Mage",290],["T_DOUBLE_COLON","::",290],["T_STRING","getStoreConfig",290],"(",["T_STRING","self",290],["T_DOUBLE_COLON","::",290],["T_STRING","XML_PATH_EMAIL_IDENTITY",290],",",["T_WHITESPACE"," ",290],["T_VARIABLE","$storeId",290],")",",",["T_WHITESPACE","\n                ",290],["T_VARIABLE","$this",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","_customer",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","getEmail",291],"(",")",",",["T_WHITESPACE","\n                ",291],["T_VARIABLE","$this",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","_customer",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","getName",292],"(",")",",",["T_WHITESPACE","\n                ",292],["T_ARRAY","array",293],"(",["T_WHITESPACE","\n                    ",293],["T_CONSTANT_ENCAPSED_STRING","'customerName'",294],["T_WHITESPACE","  ",294],["T_DOUBLE_ARROW","=>",294],["T_WHITESPACE"," ",294],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","_customer",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","getName",294],"(",")",",",["T_WHITESPACE","\n                    ",294],["T_CONSTANT_ENCAPSED_STRING","'alertGrid'",295],["T_WHITESPACE","     ",295],["T_DOUBLE_ARROW","=>",295],["T_WHITESPACE"," ",295],["T_VARIABLE","$block",295],["T_WHITESPACE","\n                ",295],")",["T_WHITESPACE","\n            ",296],")",";",["T_WHITESPACE","\n\n        ",297],["T_RETURN","return",299],["T_WHITESPACE"," ",299],["T_STRING","true",299],";",["T_WHITESPACE","\n    ",299],"}",["T_WHITESPACE","\n",300],"}",["T_WHITESPACE","\n",301]]