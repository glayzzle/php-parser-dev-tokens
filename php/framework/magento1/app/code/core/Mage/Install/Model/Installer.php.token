[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Install\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Installer model\n *\n * @category   Mage\n * @package    Mage_Install\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Install_Model_Installer",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Varien_Object",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n\n    ",36],["T_DOC_COMMENT","\/**\n     * Installer host response used to check urls\n     *\n     *\/",38],["T_WHITESPACE","\n    ",41],["T_CONST","const",42],["T_WHITESPACE"," ",42],["T_STRING","INSTALLER_HOST_RESPONSE",42],["T_WHITESPACE","   ",42],"=",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'MAGENTO'",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Installer data model used to store data between installation steps\n     *\n     * @var Varien_Object\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_dataModel",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Checking install status of application\n     *\n     * @return bool\n     *\/",51],["T_WHITESPACE","\n    ",55],["T_PUBLIC","public",56],["T_WHITESPACE"," ",56],["T_FUNCTION","function",56],["T_WHITESPACE"," ",56],["T_STRING","isApplicationInstalled",56],"(",")",["T_WHITESPACE","\n    ",56],"{",["T_WHITESPACE","\n        ",57],["T_RETURN","return",58],["T_WHITESPACE"," ",58],["T_STRING","Mage",58],["T_DOUBLE_COLON","::",58],["T_STRING","isInstalled",58],"(",")",";",["T_WHITESPACE","\n    ",58],"}",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * Get data model\n     *\n     * @return Varien_Object\n     *\/",61],["T_WHITESPACE","\n    ",65],["T_PUBLIC","public",66],["T_WHITESPACE"," ",66],["T_FUNCTION","function",66],["T_WHITESPACE"," ",66],["T_STRING","getDataModel",66],"(",")",["T_WHITESPACE","\n    ",66],"{",["T_WHITESPACE","\n        ",67],["T_IF","if",68],["T_WHITESPACE"," ",68],"(",["T_STRING","is_null",68],"(",["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","_dataModel",68],")",")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n            ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","setDataModel",69],"(",["T_STRING","Mage",69],["T_DOUBLE_COLON","::",69],["T_STRING","getSingleton",69],"(",["T_CONSTANT_ENCAPSED_STRING","'install\/session'",69],")",")",";",["T_WHITESPACE","\n        ",69],"}",["T_WHITESPACE","\n        ",70],["T_RETURN","return",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","_dataModel",71],";",["T_WHITESPACE","\n    ",71],"}",["T_WHITESPACE","\n\n    ",72],["T_DOC_COMMENT","\/**\n     * Set data model to store data between installation steps\n     *\n     * @param Varien_Object $model\n     * @return Mage_Install_Model_Installer\n     *\/",74],["T_WHITESPACE","\n    ",79],["T_PUBLIC","public",80],["T_WHITESPACE"," ",80],["T_FUNCTION","function",80],["T_WHITESPACE"," ",80],["T_STRING","setDataModel",80],"(",["T_STRING","Varien_Object",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$model",80],")",["T_WHITESPACE","\n    ",80],"{",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","_dataModel",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$model",82],";",["T_WHITESPACE","\n        ",82],["T_RETURN","return",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],";",["T_WHITESPACE","\n    ",83],"}",["T_WHITESPACE","\n\n    ",84],["T_DOC_COMMENT","\/**\n     * Check packages (pear) downloads\n     *\n     * @return boolean\n     *\/",86],["T_WHITESPACE","\n    ",90],["T_PUBLIC","public",91],["T_WHITESPACE"," ",91],["T_FUNCTION","function",91],["T_WHITESPACE"," ",91],["T_STRING","checkDownloads",91],"(",")",["T_WHITESPACE","\n    ",91],"{",["T_WHITESPACE","\n        ",92],["T_TRY","try",93],["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n            ",93],["T_VARIABLE","$result",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_STRING","Mage",94],["T_DOUBLE_COLON","::",94],["T_STRING","getModel",94],"(",["T_CONSTANT_ENCAPSED_STRING","'install\/installer_pear'",94],")",["T_OBJECT_OPERATOR","->",94],["T_STRING","checkDownloads",94],"(",")",";",["T_WHITESPACE","\n            ",94],["T_VARIABLE","$result",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_STRING","true",95],";",["T_WHITESPACE","\n        ",95],"}",["T_WHITESPACE"," ",96],["T_CATCH","catch",96],["T_WHITESPACE"," ",96],"(",["T_STRING","Exception",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$e",96],")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n            ",96],["T_VARIABLE","$result",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_STRING","false",97],";",["T_WHITESPACE","\n        ",97],"}",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","setDownloadCheckStatus",99],"(",["T_VARIABLE","$result",99],")",";",["T_WHITESPACE","\n        ",99],["T_RETURN","return",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$result",100],";",["T_WHITESPACE","\n    ",100],"}",["T_WHITESPACE","\n\n    ",101],["T_DOC_COMMENT","\/**\n     * Check server settings\n     *\n     * @return bool\n     *\/",103],["T_WHITESPACE","\n    ",107],["T_PUBLIC","public",108],["T_WHITESPACE"," ",108],["T_FUNCTION","function",108],["T_WHITESPACE"," ",108],["T_STRING","checkServer",108],"(",")",["T_WHITESPACE","\n    ",108],"{",["T_WHITESPACE","\n        ",109],["T_TRY","try",110],["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n            ",110],["T_STRING","Mage",111],["T_DOUBLE_COLON","::",111],["T_STRING","getModel",111],"(",["T_CONSTANT_ENCAPSED_STRING","'install\/installer_filesystem'",111],")",["T_OBJECT_OPERATOR","->",111],["T_STRING","install",111],"(",")",";",["T_WHITESPACE","\n\n            ",111],["T_STRING","Mage",113],["T_DOUBLE_COLON","::",113],["T_STRING","getModel",113],"(",["T_CONSTANT_ENCAPSED_STRING","'install\/installer_env'",113],")",["T_OBJECT_OPERATOR","->",113],["T_STRING","install",113],"(",")",";",["T_WHITESPACE","\n            ",113],["T_VARIABLE","$result",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_STRING","true",114],";",["T_WHITESPACE","\n        ",114],"}",["T_WHITESPACE"," ",115],["T_CATCH","catch",115],["T_WHITESPACE"," ",115],"(",["T_STRING","Exception",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$e",115],")",["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n            ",115],["T_VARIABLE","$result",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_STRING","false",116],";",["T_WHITESPACE","\n        ",116],"}",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","setData",118],"(",["T_CONSTANT_ENCAPSED_STRING","'server_check_status'",118],",",["T_WHITESPACE"," ",118],["T_VARIABLE","$result",118],")",";",["T_WHITESPACE","\n        ",118],["T_RETURN","return",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$result",119],";",["T_WHITESPACE","\n    ",119],"}",["T_WHITESPACE","\n\n    ",120],["T_DOC_COMMENT","\/**\n     * Retrieve server checking result status\n     *\n     * @return unknown\n     *\/",122],["T_WHITESPACE","\n    ",126],["T_PUBLIC","public",127],["T_WHITESPACE"," ",127],["T_FUNCTION","function",127],["T_WHITESPACE"," ",127],["T_STRING","getServerCheckStatus",127],"(",")",["T_WHITESPACE","\n    ",127],"{",["T_WHITESPACE","\n        ",128],["T_VARIABLE","$status",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getData",129],"(",["T_CONSTANT_ENCAPSED_STRING","'server_check_status'",129],")",";",["T_WHITESPACE","\n        ",129],["T_IF","if",130],["T_WHITESPACE"," ",130],"(",["T_STRING","is_null",130],"(",["T_VARIABLE","$status",130],")",")",["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n            ",130],["T_VARIABLE","$status",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","checkServer",131],"(",")",";",["T_WHITESPACE","\n        ",131],"}",["T_WHITESPACE","\n        ",132],["T_RETURN","return",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$status",133],";",["T_WHITESPACE","\n    ",133],"}",["T_WHITESPACE","\n\n    ",134],["T_DOC_COMMENT","\/**\n     * Installation config data\n     *\n     * @param   array $data\n     * @return  Mage_Install_Model_Installer\n     *\/",136],["T_WHITESPACE","\n    ",141],["T_PUBLIC","public",142],["T_WHITESPACE"," ",142],["T_FUNCTION","function",142],["T_WHITESPACE"," ",142],["T_STRING","installConfig",142],"(",["T_VARIABLE","$data",142],")",["T_WHITESPACE","\n    ",142],"{",["T_WHITESPACE","\n        ",143],["T_VARIABLE","$data",144],"[",["T_CONSTANT_ENCAPSED_STRING","'db_active'",144],"]",["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_STRING","true",144],";",["T_WHITESPACE","\n\n        ",144],["T_VARIABLE","$data",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_STRING","Mage",146],["T_DOUBLE_COLON","::",146],["T_STRING","getSingleton",146],"(",["T_CONSTANT_ENCAPSED_STRING","'install\/installer_db'",146],")",["T_OBJECT_OPERATOR","->",146],["T_STRING","checkDbConnectionData",146],"(",["T_VARIABLE","$data",146],")",";",["T_WHITESPACE","\n\n        ",146],["T_STRING","Mage",148],["T_DOUBLE_COLON","::",148],["T_STRING","getSingleton",148],"(",["T_CONSTANT_ENCAPSED_STRING","'install\/installer_config'",148],")",["T_WHITESPACE","\n            ",148],["T_OBJECT_OPERATOR","->",149],["T_STRING","setConfigData",149],"(",["T_VARIABLE","$data",149],")",["T_WHITESPACE","\n            ",149],["T_OBJECT_OPERATOR","->",150],["T_STRING","install",150],"(",")",";",["T_WHITESPACE","\n        ",150],["T_RETURN","return",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$this",151],";",["T_WHITESPACE","\n    ",151],"}",["T_WHITESPACE","\n\n    ",152],["T_DOC_COMMENT","\/**\n     * Database installation\n     *\n     * @return Mage_Install_Model_Installer\n     *\/",154],["T_WHITESPACE","\n    ",158],["T_PUBLIC","public",159],["T_WHITESPACE"," ",159],["T_FUNCTION","function",159],["T_WHITESPACE"," ",159],["T_STRING","installDb",159],"(",")",["T_WHITESPACE","\n    ",159],"{",["T_WHITESPACE","\n        ",160],["T_STRING","Mage_Core_Model_Resource_Setup",161],["T_DOUBLE_COLON","::",161],["T_STRING","applyAllUpdates",161],"(",")",";",["T_WHITESPACE","\n        ",161],["T_VARIABLE","$data",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","getDataModel",162],"(",")",["T_OBJECT_OPERATOR","->",162],["T_STRING","getConfigData",162],"(",")",";",["T_WHITESPACE","\n\n        ",162],["T_DOC_COMMENT","\/**\n         * Saving host information into DB\n         *\/",164],["T_WHITESPACE","\n        ",166],["T_VARIABLE","$setupModel",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_NEW","new",167],["T_WHITESPACE"," ",167],["T_STRING","Mage_Core_Model_Resource_Setup",167],"(",["T_CONSTANT_ENCAPSED_STRING","'core_setup'",167],")",";",["T_WHITESPACE","\n\n        ",167],["T_IF","if",169],["T_WHITESPACE"," ",169],"(","!",["T_EMPTY","empty",169],"(",["T_VARIABLE","$data",169],"[",["T_CONSTANT_ENCAPSED_STRING","'use_rewrites'",169],"]",")",")",["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n            ",169],["T_VARIABLE","$setupModel",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","setConfigData",170],"(",["T_STRING","Mage_Core_Model_Store",170],["T_DOUBLE_COLON","::",170],["T_STRING","XML_PATH_USE_REWRITES",170],",",["T_WHITESPACE"," ",170],["T_LNUMBER","1",170],")",";",["T_WHITESPACE","\n        ",170],"}",["T_WHITESPACE","\n\n        ",171],["T_IF","if",173],["T_WHITESPACE"," ",173],"(","!",["T_EMPTY","empty",173],"(",["T_VARIABLE","$data",173],"[",["T_CONSTANT_ENCAPSED_STRING","'enable_charts'",173],"]",")",")",["T_WHITESPACE"," ",173],"{",["T_WHITESPACE","\n            ",173],["T_VARIABLE","$setupModel",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","setConfigData",174],"(",["T_STRING","Mage_Adminhtml_Block_Dashboard",174],["T_DOUBLE_COLON","::",174],["T_STRING","XML_PATH_ENABLE_CHARTS",174],",",["T_WHITESPACE"," ",174],["T_LNUMBER","1",174],")",";",["T_WHITESPACE","\n        ",174],"}",["T_WHITESPACE"," ",175],["T_ELSE","else",175],["T_WHITESPACE"," ",175],"{",["T_WHITESPACE","\n            ",175],["T_VARIABLE","$setupModel",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","setConfigData",176],"(",["T_STRING","Mage_Adminhtml_Block_Dashboard",176],["T_DOUBLE_COLON","::",176],["T_STRING","XML_PATH_ENABLE_CHARTS",176],",",["T_WHITESPACE"," ",176],["T_LNUMBER","0",176],")",";",["T_WHITESPACE","\n        ",176],"}",["T_WHITESPACE","\n\n\n        ",177],["T_VARIABLE","$unsecureBaseUrl",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_STRING","Mage",180],["T_DOUBLE_COLON","::",180],["T_STRING","getBaseUrl",180],"(",["T_CONSTANT_ENCAPSED_STRING","'web'",180],")",";",["T_WHITESPACE","\n        ",180],["T_IF","if",181],["T_WHITESPACE"," ",181],"(","!",["T_EMPTY","empty",181],"(",["T_VARIABLE","$data",181],"[",["T_CONSTANT_ENCAPSED_STRING","'unsecure_base_url'",181],"]",")",")",["T_WHITESPACE"," ",181],"{",["T_WHITESPACE","\n            ",181],["T_VARIABLE","$unsecureBaseUrl",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_VARIABLE","$data",182],"[",["T_CONSTANT_ENCAPSED_STRING","'unsecure_base_url'",182],"]",";",["T_WHITESPACE","\n            ",182],["T_VARIABLE","$setupModel",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","setConfigData",183],"(",["T_STRING","Mage_Core_Model_Store",183],["T_DOUBLE_COLON","::",183],["T_STRING","XML_PATH_UNSECURE_BASE_URL",183],",",["T_WHITESPACE"," ",183],["T_VARIABLE","$unsecureBaseUrl",183],")",";",["T_WHITESPACE","\n        ",183],"}",["T_WHITESPACE","\n\n        ",184],["T_IF","if",186],["T_WHITESPACE"," ",186],"(","!",["T_EMPTY","empty",186],"(",["T_VARIABLE","$data",186],"[",["T_CONSTANT_ENCAPSED_STRING","'use_secure'",186],"]",")",")",["T_WHITESPACE"," ",186],"{",["T_WHITESPACE","\n            ",186],["T_VARIABLE","$setupModel",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","setConfigData",187],"(",["T_STRING","Mage_Core_Model_Store",187],["T_DOUBLE_COLON","::",187],["T_STRING","XML_PATH_SECURE_IN_FRONTEND",187],",",["T_WHITESPACE"," ",187],["T_LNUMBER","1",187],")",";",["T_WHITESPACE","\n            ",187],["T_VARIABLE","$setupModel",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","setConfigData",188],"(",["T_STRING","Mage_Core_Model_Store",188],["T_DOUBLE_COLON","::",188],["T_STRING","XML_PATH_SECURE_BASE_URL",188],",",["T_WHITESPACE"," ",188],["T_VARIABLE","$data",188],"[",["T_CONSTANT_ENCAPSED_STRING","'secure_base_url'",188],"]",")",";",["T_WHITESPACE","\n            ",188],["T_IF","if",189],["T_WHITESPACE"," ",189],"(","!",["T_EMPTY","empty",189],"(",["T_VARIABLE","$data",189],"[",["T_CONSTANT_ENCAPSED_STRING","'use_secure_admin'",189],"]",")",")",["T_WHITESPACE"," ",189],"{",["T_WHITESPACE","\n                ",189],["T_VARIABLE","$setupModel",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","setConfigData",190],"(",["T_STRING","Mage_Core_Model_Store",190],["T_DOUBLE_COLON","::",190],["T_STRING","XML_PATH_SECURE_IN_ADMINHTML",190],",",["T_WHITESPACE"," ",190],["T_LNUMBER","1",190],")",";",["T_WHITESPACE","\n            ",190],"}",["T_WHITESPACE","\n        ",191],"}",["T_WHITESPACE","\n        ",192],["T_ELSEIF","elseif",193],["T_WHITESPACE"," ",193],"(","!",["T_EMPTY","empty",193],"(",["T_VARIABLE","$data",193],"[",["T_CONSTANT_ENCAPSED_STRING","'unsecure_base_url'",193],"]",")",")",["T_WHITESPACE"," ",193],"{",["T_WHITESPACE","\n            ",193],["T_VARIABLE","$setupModel",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","setConfigData",194],"(",["T_STRING","Mage_Core_Model_Store",194],["T_DOUBLE_COLON","::",194],["T_STRING","XML_PATH_SECURE_BASE_URL",194],",",["T_WHITESPACE"," ",194],["T_VARIABLE","$unsecureBaseUrl",194],")",";",["T_WHITESPACE","\n        ",194],"}",["T_WHITESPACE","\n\n        ",195],["T_DOC_COMMENT","\/**\n         * Saving locale information into DB\n         *\/",197],["T_WHITESPACE","\n        ",199],["T_VARIABLE","$locale",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","getDataModel",200],"(",")",["T_OBJECT_OPERATOR","->",200],["T_STRING","getLocaleData",200],"(",")",";",["T_WHITESPACE","\n        ",200],["T_IF","if",201],["T_WHITESPACE"," ",201],"(","!",["T_EMPTY","empty",201],"(",["T_VARIABLE","$locale",201],"[",["T_CONSTANT_ENCAPSED_STRING","'locale'",201],"]",")",")",["T_WHITESPACE"," ",201],"{",["T_WHITESPACE","\n            ",201],["T_VARIABLE","$setupModel",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","setConfigData",202],"(",["T_STRING","Mage_Core_Model_Locale",202],["T_DOUBLE_COLON","::",202],["T_STRING","XML_PATH_DEFAULT_LOCALE",202],",",["T_WHITESPACE"," ",202],["T_VARIABLE","$locale",202],"[",["T_CONSTANT_ENCAPSED_STRING","'locale'",202],"]",")",";",["T_WHITESPACE","\n        ",202],"}",["T_WHITESPACE","\n        ",203],["T_IF","if",204],["T_WHITESPACE"," ",204],"(","!",["T_EMPTY","empty",204],"(",["T_VARIABLE","$locale",204],"[",["T_CONSTANT_ENCAPSED_STRING","'timezone'",204],"]",")",")",["T_WHITESPACE"," ",204],"{",["T_WHITESPACE","\n            ",204],["T_VARIABLE","$setupModel",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","setConfigData",205],"(",["T_STRING","Mage_Core_Model_Locale",205],["T_DOUBLE_COLON","::",205],["T_STRING","XML_PATH_DEFAULT_TIMEZONE",205],",",["T_WHITESPACE"," ",205],["T_VARIABLE","$locale",205],"[",["T_CONSTANT_ENCAPSED_STRING","'timezone'",205],"]",")",";",["T_WHITESPACE","\n        ",205],"}",["T_WHITESPACE","\n        ",206],["T_IF","if",207],["T_WHITESPACE"," ",207],"(","!",["T_EMPTY","empty",207],"(",["T_VARIABLE","$locale",207],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",207],"]",")",")",["T_WHITESPACE"," ",207],"{",["T_WHITESPACE","\n            ",207],["T_VARIABLE","$setupModel",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","setConfigData",208],"(",["T_STRING","Mage_Directory_Model_Currency",208],["T_DOUBLE_COLON","::",208],["T_STRING","XML_PATH_CURRENCY_BASE",208],",",["T_WHITESPACE"," ",208],["T_VARIABLE","$locale",208],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",208],"]",")",";",["T_WHITESPACE","\n            ",208],["T_VARIABLE","$setupModel",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","setConfigData",209],"(",["T_STRING","Mage_Directory_Model_Currency",209],["T_DOUBLE_COLON","::",209],["T_STRING","XML_PATH_CURRENCY_DEFAULT",209],",",["T_WHITESPACE"," ",209],["T_VARIABLE","$locale",209],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",209],"]",")",";",["T_WHITESPACE","\n            ",209],["T_VARIABLE","$setupModel",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","setConfigData",210],"(",["T_STRING","Mage_Directory_Model_Currency",210],["T_DOUBLE_COLON","::",210],["T_STRING","XML_PATH_CURRENCY_ALLOW",210],",",["T_WHITESPACE"," ",210],["T_VARIABLE","$locale",210],"[",["T_CONSTANT_ENCAPSED_STRING","'currency'",210],"]",")",";",["T_WHITESPACE","\n        ",210],"}",["T_WHITESPACE","\n\n        ",211],["T_RETURN","return",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$this",213],";",["T_WHITESPACE","\n    ",213],"}",["T_WHITESPACE","\n\n    ",214],["T_DOC_COMMENT","\/**\n     * Prepare admin user data in model and validate it.\n     * Returns TRUE or array of error messages.\n     *\n     * @param array $data\n     * @return mixed\n     *\/",216],["T_WHITESPACE","\n    ",222],["T_PUBLIC","public",223],["T_WHITESPACE"," ",223],["T_FUNCTION","function",223],["T_WHITESPACE"," ",223],["T_STRING","validateAndPrepareAdministrator",223],"(",["T_VARIABLE","$data",223],")",["T_WHITESPACE","\n    ",223],"{",["T_WHITESPACE","\n        ",224],["T_VARIABLE","$user",225],["T_WHITESPACE"," ",225],"=",["T_WHITESPACE"," ",225],["T_STRING","Mage",225],["T_DOUBLE_COLON","::",225],["T_STRING","getModel",225],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/user'",225],")",["T_WHITESPACE","\n            ",225],["T_OBJECT_OPERATOR","->",226],["T_STRING","load",226],"(",["T_VARIABLE","$data",226],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",226],"]",",",["T_WHITESPACE"," ",226],["T_CONSTANT_ENCAPSED_STRING","'username'",226],")",";",["T_WHITESPACE","\n        ",226],["T_VARIABLE","$user",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","addData",227],"(",["T_VARIABLE","$data",227],")",";",["T_WHITESPACE","\n\n        ",227],["T_VARIABLE","$result",229],["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],["T_VARIABLE","$user",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","validate",229],"(",")",";",["T_WHITESPACE","\n        ",229],["T_IF","if",230],["T_WHITESPACE"," ",230],"(",["T_STRING","is_array",230],"(",["T_VARIABLE","$result",230],")",")",["T_WHITESPACE"," ",230],"{",["T_WHITESPACE","\n            ",230],["T_FOREACH","foreach",231],["T_WHITESPACE"," ",231],"(",["T_VARIABLE","$result",231],["T_WHITESPACE"," ",231],["T_AS","as",231],["T_WHITESPACE"," ",231],["T_VARIABLE","$error",231],")",["T_WHITESPACE"," ",231],"{",["T_WHITESPACE","\n                ",231],["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","getDataModel",232],"(",")",["T_OBJECT_OPERATOR","->",232],["T_STRING","addError",232],"(",["T_VARIABLE","$error",232],")",";",["T_WHITESPACE","\n            ",232],"}",["T_WHITESPACE","\n            ",233],["T_RETURN","return",234],["T_WHITESPACE"," ",234],["T_VARIABLE","$result",234],";",["T_WHITESPACE","\n        ",234],"}",["T_WHITESPACE","\n        ",235],["T_RETURN","return",236],["T_WHITESPACE"," ",236],["T_VARIABLE","$user",236],";",["T_WHITESPACE","\n    ",236],"}",["T_WHITESPACE","\n\n    ",237],["T_DOC_COMMENT","\/**\n     * Create admin user.\n     * Paramater can be prepared user model or array of data.\n     * Returns TRUE or throws exception.\n     *\n     * @param mixed $data\n     * @return bool\n     *\/",239],["T_WHITESPACE","\n    ",246],["T_PUBLIC","public",247],["T_WHITESPACE"," ",247],["T_FUNCTION","function",247],["T_WHITESPACE"," ",247],["T_STRING","createAdministrator",247],"(",["T_VARIABLE","$data",247],")",["T_WHITESPACE","\n    ",247],"{",["T_WHITESPACE","\n        ",248],["T_VARIABLE","$user",249],["T_WHITESPACE"," ",249],"=",["T_WHITESPACE"," ",249],["T_STRING","Mage",249],["T_DOUBLE_COLON","::",249],["T_STRING","getModel",249],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/user'",249],")",["T_WHITESPACE","\n            ",249],["T_OBJECT_OPERATOR","->",250],["T_STRING","load",250],"(",["T_CONSTANT_ENCAPSED_STRING","'admin'",250],",",["T_WHITESPACE"," ",250],["T_CONSTANT_ENCAPSED_STRING","'username'",250],")",";",["T_WHITESPACE","\n        ",250],["T_IF","if",251],["T_WHITESPACE"," ",251],"(",["T_VARIABLE","$user",251],["T_WHITESPACE"," ",251],["T_BOOLEAN_AND","&&",251],["T_WHITESPACE"," ",251],["T_VARIABLE","$user",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","getPassword",251],"(",")",["T_WHITESPACE"," ",251],["T_IS_EQUAL","==",251],["T_WHITESPACE"," ",251],["T_CONSTANT_ENCAPSED_STRING","'4297f44b13955235245b2497399d7a93'",251],")",["T_WHITESPACE"," ",251],"{",["T_WHITESPACE","\n            ",251],["T_VARIABLE","$user",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","delete",252],"(",")",";",["T_WHITESPACE","\n        ",252],"}",["T_WHITESPACE","\n\n        ",253],["T_COMMENT","\/\/to support old logic checking if real data was passed\n",255],["T_WHITESPACE","        ",256],["T_IF","if",256],["T_WHITESPACE"," ",256],"(",["T_STRING","is_array",256],"(",["T_VARIABLE","$data",256],")",")",["T_WHITESPACE"," ",256],"{",["T_WHITESPACE","\n            ",256],["T_VARIABLE","$data",257],["T_WHITESPACE"," ",257],"=",["T_WHITESPACE"," ",257],["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","validateAndPrepareAdministrator",257],"(",["T_VARIABLE","$data",257],")",";",["T_WHITESPACE","\n            ",257],["T_IF","if",258],["T_WHITESPACE"," ",258],"(",["T_STRING","is_array",258],"(",["T_STRING","data",258],")",")",["T_WHITESPACE"," ",258],"{",["T_WHITESPACE","\n                ",258],["T_THROW","throw",259],["T_WHITESPACE"," ",259],["T_NEW","new",259],["T_WHITESPACE"," ",259],["T_STRING","Exception",259],"(",["T_STRING","Mage",259],["T_DOUBLE_COLON","::",259],["T_STRING","helper",259],"(",["T_CONSTANT_ENCAPSED_STRING","'install'",259],")",["T_OBJECT_OPERATOR","->",259],["T_STRING","__",259],"(",["T_CONSTANT_ENCAPSED_STRING","'Please correct the user data and try again.'",259],")",")",";",["T_WHITESPACE","\n            ",259],"}",["T_WHITESPACE","\n        ",260],"}",["T_WHITESPACE","\n\n        ",261],["T_COMMENT","\/\/run time flag to force saving entered password\n",263],["T_WHITESPACE","        ",264],["T_VARIABLE","$data",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","setForceNewPassword",264],"(",["T_STRING","true",264],")",";",["T_WHITESPACE","\n\n        ",264],["T_VARIABLE","$data",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","save",266],"(",")",";",["T_WHITESPACE","\n        ",266],["T_VARIABLE","$data",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","setRoleIds",267],"(",["T_ARRAY","array",267],"(",["T_LNUMBER","1",267],")",")",["T_OBJECT_OPERATOR","->",267],["T_STRING","saveRelations",267],"(",")",";",["T_WHITESPACE","\n\n        ",267],["T_COMMENT","\/*Mage::getModel(\"permissions\/user\")->setRoleId(1)\n            ->setUserId($user->getId())\n            ->setFirstname($user->getFirstname())\n            ->add();*\/",269],["T_WHITESPACE","\n\n        ",272],["T_RETURN","return",274],["T_WHITESPACE"," ",274],["T_STRING","true",274],";",["T_WHITESPACE","\n    ",274],"}",["T_WHITESPACE","\n\n    ",275],["T_DOC_COMMENT","\/**\n     * Validating encryption key.\n     * Returns TRUE or array of error messages.\n     *\n     * @param $key\n     * @return unknown_type\n     *\/",277],["T_WHITESPACE","\n    ",283],["T_PUBLIC","public",284],["T_WHITESPACE"," ",284],["T_FUNCTION","function",284],["T_WHITESPACE"," ",284],["T_STRING","validateEncryptionKey",284],"(",["T_VARIABLE","$key",284],")",["T_WHITESPACE","\n    ",284],"{",["T_WHITESPACE","\n        ",285],["T_VARIABLE","$errors",286],["T_WHITESPACE"," ",286],"=",["T_WHITESPACE"," ",286],["T_ARRAY","array",286],"(",")",";",["T_WHITESPACE","\n\n        ",286],["T_TRY","try",288],["T_WHITESPACE"," ",288],"{",["T_WHITESPACE","\n            ",288],["T_IF","if",289],["T_WHITESPACE"," ",289],"(",["T_VARIABLE","$key",289],")",["T_WHITESPACE"," ",289],"{",["T_WHITESPACE","\n                ",289],["T_STRING","Mage",290],["T_DOUBLE_COLON","::",290],["T_STRING","helper",290],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",290],")",["T_OBJECT_OPERATOR","->",290],["T_STRING","validateKey",290],"(",["T_VARIABLE","$key",290],")",";",["T_WHITESPACE","\n            ",290],"}",["T_WHITESPACE","\n        ",291],"}",["T_WHITESPACE"," ",292],["T_CATCH","catch",292],["T_WHITESPACE"," ",292],"(",["T_STRING","Exception",292],["T_WHITESPACE"," ",292],["T_VARIABLE","$e",292],")",["T_WHITESPACE"," ",292],"{",["T_WHITESPACE","\n            ",292],["T_VARIABLE","$errors",293],"[","]",["T_WHITESPACE"," ",293],"=",["T_WHITESPACE"," ",293],["T_VARIABLE","$e",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","getMessage",293],"(",")",";",["T_WHITESPACE","\n            ",293],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","getDataModel",294],"(",")",["T_OBJECT_OPERATOR","->",294],["T_STRING","addError",294],"(",["T_VARIABLE","$e",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","getMessage",294],"(",")",")",";",["T_WHITESPACE","\n        ",294],"}",["T_WHITESPACE","\n\n        ",295],["T_IF","if",297],["T_WHITESPACE"," ",297],"(","!",["T_EMPTY","empty",297],"(",["T_VARIABLE","$errors",297],")",")",["T_WHITESPACE"," ",297],"{",["T_WHITESPACE","\n            ",297],["T_RETURN","return",298],["T_WHITESPACE"," ",298],["T_VARIABLE","$errors",298],";",["T_WHITESPACE","\n        ",298],"}",["T_WHITESPACE","\n\n        ",299],["T_RETURN","return",301],["T_WHITESPACE"," ",301],["T_STRING","true",301],";",["T_WHITESPACE","\n    ",301],"}",["T_WHITESPACE","\n\n    ",302],["T_DOC_COMMENT","\/**\n     * Set encryption key\n     *\n     * @param string $key\n     * @return Mage_Install_Model_Installer\n     *\/",304],["T_WHITESPACE","\n    ",309],["T_PUBLIC","public",310],["T_WHITESPACE"," ",310],["T_FUNCTION","function",310],["T_WHITESPACE"," ",310],["T_STRING","installEnryptionKey",310],"(",["T_VARIABLE","$key",310],")",["T_WHITESPACE","\n    ",310],"{",["T_WHITESPACE","\n        ",311],["T_IF","if",312],["T_WHITESPACE"," ",312],"(",["T_VARIABLE","$key",312],")",["T_WHITESPACE"," ",312],"{",["T_WHITESPACE","\n            ",312],["T_STRING","Mage",313],["T_DOUBLE_COLON","::",313],["T_STRING","helper",313],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",313],")",["T_OBJECT_OPERATOR","->",313],["T_STRING","validateKey",313],"(",["T_VARIABLE","$key",313],")",";",["T_WHITESPACE","\n        ",313],"}",["T_WHITESPACE","\n        ",314],["T_STRING","Mage",315],["T_DOUBLE_COLON","::",315],["T_STRING","getSingleton",315],"(",["T_CONSTANT_ENCAPSED_STRING","'install\/installer_config'",315],")",["T_OBJECT_OPERATOR","->",315],["T_STRING","replaceTmpEncryptKey",315],"(",["T_VARIABLE","$key",315],")",";",["T_WHITESPACE","\n        ",315],["T_RETURN","return",316],["T_WHITESPACE"," ",316],["T_VARIABLE","$this",316],";",["T_WHITESPACE","\n    ",316],"}",["T_WHITESPACE","\n\n    ",317],["T_PUBLIC","public",319],["T_WHITESPACE"," ",319],["T_FUNCTION","function",319],["T_WHITESPACE"," ",319],["T_STRING","finish",319],"(",")",["T_WHITESPACE","\n    ",319],"{",["T_WHITESPACE","\n        ",320],["T_STRING","Mage",321],["T_DOUBLE_COLON","::",321],["T_STRING","getSingleton",321],"(",["T_CONSTANT_ENCAPSED_STRING","'install\/installer_config'",321],")",["T_OBJECT_OPERATOR","->",321],["T_STRING","replaceTmpInstallDate",321],"(",")",";",["T_WHITESPACE","\n        ",321],["T_STRING","Mage",322],["T_DOUBLE_COLON","::",322],["T_STRING","app",322],"(",")",["T_OBJECT_OPERATOR","->",322],["T_STRING","cleanCache",322],"(",")",";",["T_WHITESPACE","\n\n        ",322],["T_VARIABLE","$cacheData",324],["T_WHITESPACE"," ",324],"=",["T_WHITESPACE"," ",324],["T_ARRAY","array",324],"(",")",";",["T_WHITESPACE","\n        ",324],["T_FOREACH","foreach",325],["T_WHITESPACE"," ",325],"(",["T_STRING","Mage",325],["T_DOUBLE_COLON","::",325],["T_STRING","helper",325],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",325],")",["T_OBJECT_OPERATOR","->",325],["T_STRING","getCacheTypes",325],"(",")",["T_WHITESPACE"," ",325],["T_AS","as",325],["T_WHITESPACE"," ",325],["T_VARIABLE","$type",325],["T_WHITESPACE"," ",325],["T_DOUBLE_ARROW","=>",325],["T_WHITESPACE"," ",325],["T_VARIABLE","$label",325],")",["T_WHITESPACE"," ",325],"{",["T_WHITESPACE","\n            ",325],["T_VARIABLE","$cacheData",326],"[",["T_VARIABLE","$type",326],"]",["T_WHITESPACE"," ",326],"=",["T_WHITESPACE"," ",326],["T_LNUMBER","1",326],";",["T_WHITESPACE","\n        ",326],"}",["T_WHITESPACE","\n        ",327],["T_STRING","Mage",328],["T_DOUBLE_COLON","::",328],["T_STRING","app",328],"(",")",["T_OBJECT_OPERATOR","->",328],["T_STRING","saveUseCache",328],"(",["T_VARIABLE","$cacheData",328],")",";",["T_WHITESPACE","\n        ",328],["T_RETURN","return",329],["T_WHITESPACE"," ",329],["T_VARIABLE","$this",329],";",["T_WHITESPACE","\n    ",329],"}",["T_WHITESPACE","\n\n",330],"}",["T_WHITESPACE","\n",332]]