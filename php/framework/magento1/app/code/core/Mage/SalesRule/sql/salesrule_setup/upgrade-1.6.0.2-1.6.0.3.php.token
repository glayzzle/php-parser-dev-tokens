[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_SalesRule\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_COMMENT","\/* @var $installer Mage_Core_Model_Resource_Setup *\/",27],["T_WHITESPACE","\n",27],["T_VARIABLE","$installer",28],["T_WHITESPACE","           ",28],"=",["T_WHITESPACE"," ",28],["T_VARIABLE","$this",28],";",["T_WHITESPACE","\n",28],["T_VARIABLE","$connection",29],["T_WHITESPACE","          ",29],"=",["T_WHITESPACE"," ",29],["T_VARIABLE","$installer",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","getConnection",29],"(",")",";",["T_WHITESPACE","\n\n",29],["T_VARIABLE","$rulesTable",31],["T_WHITESPACE","          ",31],"=",["T_WHITESPACE"," ",31],["T_VARIABLE","$installer",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","getTable",31],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/rule'",31],")",";",["T_WHITESPACE","\n",31],["T_VARIABLE","$websitesTable",32],["T_WHITESPACE","       ",32],"=",["T_WHITESPACE"," ",32],["T_VARIABLE","$installer",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","getTable",32],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/website'",32],")",";",["T_WHITESPACE","\n",32],["T_VARIABLE","$customerGroupsTable",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_VARIABLE","$installer",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","getTable",33],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/customer_group'",33],")",";",["T_WHITESPACE","\n",33],["T_VARIABLE","$rulesWebsitesTable",34],["T_WHITESPACE","  ",34],"=",["T_WHITESPACE"," ",34],["T_VARIABLE","$installer",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","getTable",34],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/website'",34],")",";",["T_WHITESPACE","\n",34],["T_VARIABLE","$rulesCustomerGroupsTable",35],["T_WHITESPACE","  ",35],"=",["T_WHITESPACE"," ",35],["T_VARIABLE","$installer",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","getTable",35],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/customer_group'",35],")",";",["T_WHITESPACE","\n\n",35],["T_VARIABLE","$installer",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","startSetup",37],"(",")",";",["T_WHITESPACE","\n",37],["T_DOC_COMMENT","\/**\n * Create table 'salesrule\/website' if not exists. This table will be used instead of\n * column website_ids of main catalog rules table\n *\/",38],["T_WHITESPACE","\n",41],["T_VARIABLE","$table",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_VARIABLE","$connection",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","newTable",42],"(",["T_VARIABLE","$rulesWebsitesTable",42],")",["T_WHITESPACE","\n    ",42],["T_OBJECT_OPERATOR","->",43],["T_STRING","addColumn",43],"(",["T_CONSTANT_ENCAPSED_STRING","'rule_id'",43],",",["T_WHITESPACE"," ",43],["T_STRING","Varien_Db_Ddl_Table",43],["T_DOUBLE_COLON","::",43],["T_STRING","TYPE_INTEGER",43],",",["T_WHITESPACE"," ",43],["T_STRING","null",43],",",["T_WHITESPACE"," ",43],["T_ARRAY","array",43],"(",["T_WHITESPACE","\n        ",43],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",44],["T_WHITESPACE","  ",44],["T_DOUBLE_ARROW","=>",44],["T_WHITESPACE"," ",44],["T_STRING","true",44],",",["T_WHITESPACE","\n        ",44],["T_CONSTANT_ENCAPSED_STRING","'nullable'",45],["T_WHITESPACE","  ",45],["T_DOUBLE_ARROW","=>",45],["T_WHITESPACE"," ",45],["T_STRING","false",45],",",["T_WHITESPACE","\n        ",45],["T_CONSTANT_ENCAPSED_STRING","'primary'",46],["T_WHITESPACE","   ",46],["T_DOUBLE_ARROW","=>",46],["T_WHITESPACE"," ",46],["T_STRING","true",46],["T_WHITESPACE","\n        ",46],")",",",["T_WHITESPACE","\n        ",47],["T_CONSTANT_ENCAPSED_STRING","'Rule Id'",48],["T_WHITESPACE","\n        ",48],")",["T_WHITESPACE","\n    ",49],["T_OBJECT_OPERATOR","->",50],["T_STRING","addColumn",50],"(",["T_CONSTANT_ENCAPSED_STRING","'website_id'",50],",",["T_WHITESPACE"," ",50],["T_STRING","Varien_Db_Ddl_Table",50],["T_DOUBLE_COLON","::",50],["T_STRING","TYPE_SMALLINT",50],",",["T_WHITESPACE"," ",50],["T_STRING","null",50],",",["T_WHITESPACE"," ",50],["T_ARRAY","array",50],"(",["T_WHITESPACE","\n        ",50],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",51],["T_WHITESPACE","  ",51],["T_DOUBLE_ARROW","=>",51],["T_WHITESPACE"," ",51],["T_STRING","true",51],",",["T_WHITESPACE","\n        ",51],["T_CONSTANT_ENCAPSED_STRING","'nullable'",52],["T_WHITESPACE","  ",52],["T_DOUBLE_ARROW","=>",52],["T_WHITESPACE"," ",52],["T_STRING","false",52],",",["T_WHITESPACE","\n        ",52],["T_CONSTANT_ENCAPSED_STRING","'primary'",53],["T_WHITESPACE","   ",53],["T_DOUBLE_ARROW","=>",53],["T_WHITESPACE"," ",53],["T_STRING","true",53],["T_WHITESPACE","\n        ",53],")",",",["T_WHITESPACE","\n        ",54],["T_CONSTANT_ENCAPSED_STRING","'Website Id'",55],["T_WHITESPACE","\n    ",55],")",["T_WHITESPACE","\n    ",56],["T_OBJECT_OPERATOR","->",57],["T_STRING","addIndex",57],"(",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$installer",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","getIdxName",58],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/website'",58],",",["T_WHITESPACE"," ",58],["T_ARRAY","array",58],"(",["T_CONSTANT_ENCAPSED_STRING","'rule_id'",58],")",")",",",["T_WHITESPACE","\n        ",58],["T_ARRAY","array",59],"(",["T_CONSTANT_ENCAPSED_STRING","'rule_id'",59],")",["T_WHITESPACE","\n    ",59],")",["T_WHITESPACE","\n    ",60],["T_OBJECT_OPERATOR","->",61],["T_STRING","addIndex",61],"(",["T_WHITESPACE","\n        ",61],["T_VARIABLE","$installer",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","getIdxName",62],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/website'",62],",",["T_WHITESPACE"," ",62],["T_ARRAY","array",62],"(",["T_CONSTANT_ENCAPSED_STRING","'website_id'",62],")",")",",",["T_WHITESPACE","\n        ",62],["T_ARRAY","array",63],"(",["T_CONSTANT_ENCAPSED_STRING","'website_id'",63],")",["T_WHITESPACE","\n    ",63],")",["T_WHITESPACE","\n    ",64],["T_OBJECT_OPERATOR","->",65],["T_STRING","addForeignKey",65],"(",["T_VARIABLE","$installer",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getFkName",65],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/website'",65],",",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'rule_id'",65],",",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'salesrule\/rule'",65],",",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'rule_id'",65],")",",",["T_WHITESPACE","\n        ",65],["T_CONSTANT_ENCAPSED_STRING","'rule_id'",66],",",["T_WHITESPACE"," ",66],["T_VARIABLE","$rulesTable",66],",",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'rule_id'",66],",",["T_WHITESPACE","\n        ",66],["T_STRING","Varien_Db_Ddl_Table",67],["T_DOUBLE_COLON","::",67],["T_STRING","ACTION_CASCADE",67],",",["T_WHITESPACE"," ",67],["T_STRING","Varien_Db_Ddl_Table",67],["T_DOUBLE_COLON","::",67],["T_STRING","ACTION_CASCADE",67],["T_WHITESPACE","\n    ",67],")",["T_WHITESPACE","\n    ",68],["T_OBJECT_OPERATOR","->",69],["T_STRING","addForeignKey",69],"(",["T_VARIABLE","$installer",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getFkName",69],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/website'",69],",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'website_id'",69],",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'core\/website'",69],",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'website_id'",69],")",",",["T_WHITESPACE","\n        ",69],["T_CONSTANT_ENCAPSED_STRING","'website_id'",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$websitesTable",70],",",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'website_id'",70],",",["T_WHITESPACE","\n        ",70],["T_STRING","Varien_Db_Ddl_Table",71],["T_DOUBLE_COLON","::",71],["T_STRING","ACTION_CASCADE",71],",",["T_WHITESPACE"," ",71],["T_STRING","Varien_Db_Ddl_Table",71],["T_DOUBLE_COLON","::",71],["T_STRING","ACTION_CASCADE",71],["T_WHITESPACE","\n    ",71],")",["T_WHITESPACE","\n    ",72],["T_OBJECT_OPERATOR","->",73],["T_STRING","setComment",73],"(",["T_CONSTANT_ENCAPSED_STRING","'Sales Rules To Websites Relations'",73],")",";",["T_WHITESPACE","\n\n",73],["T_VARIABLE","$connection",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","createTable",75],"(",["T_VARIABLE","$table",75],")",";",["T_WHITESPACE","\n\n\n",75],["T_DOC_COMMENT","\/**\n * Create table 'salesrule\/customer_group' if not exists. This table will be used instead of\n * column customer_group_ids of main catalog rules table\n *\/",78],["T_WHITESPACE","\n",81],["T_VARIABLE","$table",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$connection",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","newTable",82],"(",["T_VARIABLE","$rulesCustomerGroupsTable",82],")",["T_WHITESPACE","\n    ",82],["T_OBJECT_OPERATOR","->",83],["T_STRING","addColumn",83],"(",["T_CONSTANT_ENCAPSED_STRING","'rule_id'",83],",",["T_WHITESPACE"," ",83],["T_STRING","Varien_Db_Ddl_Table",83],["T_DOUBLE_COLON","::",83],["T_STRING","TYPE_INTEGER",83],",",["T_WHITESPACE"," ",83],["T_STRING","null",83],",",["T_WHITESPACE"," ",83],["T_ARRAY","array",83],"(",["T_WHITESPACE","\n        ",83],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",84],["T_WHITESPACE","  ",84],["T_DOUBLE_ARROW","=>",84],["T_WHITESPACE"," ",84],["T_STRING","true",84],",",["T_WHITESPACE","\n        ",84],["T_CONSTANT_ENCAPSED_STRING","'nullable'",85],["T_WHITESPACE","  ",85],["T_DOUBLE_ARROW","=>",85],["T_WHITESPACE"," ",85],["T_STRING","false",85],",",["T_WHITESPACE","\n        ",85],["T_CONSTANT_ENCAPSED_STRING","'primary'",86],["T_WHITESPACE","   ",86],["T_DOUBLE_ARROW","=>",86],["T_WHITESPACE"," ",86],["T_STRING","true",86],["T_WHITESPACE","\n        ",86],")",",",["T_WHITESPACE","\n        ",87],["T_CONSTANT_ENCAPSED_STRING","'Rule Id'",88],["T_WHITESPACE","\n    ",88],")",["T_WHITESPACE","\n    ",89],["T_OBJECT_OPERATOR","->",90],["T_STRING","addColumn",90],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",90],",",["T_WHITESPACE"," ",90],["T_STRING","Varien_Db_Ddl_Table",90],["T_DOUBLE_COLON","::",90],["T_STRING","TYPE_SMALLINT",90],",",["T_WHITESPACE"," ",90],["T_STRING","null",90],",",["T_WHITESPACE"," ",90],["T_ARRAY","array",90],"(",["T_WHITESPACE","\n        ",90],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",91],["T_WHITESPACE","  ",91],["T_DOUBLE_ARROW","=>",91],["T_WHITESPACE"," ",91],["T_STRING","true",91],",",["T_WHITESPACE","\n        ",91],["T_CONSTANT_ENCAPSED_STRING","'nullable'",92],["T_WHITESPACE","  ",92],["T_DOUBLE_ARROW","=>",92],["T_WHITESPACE"," ",92],["T_STRING","false",92],",",["T_WHITESPACE","\n        ",92],["T_CONSTANT_ENCAPSED_STRING","'primary'",93],["T_WHITESPACE","   ",93],["T_DOUBLE_ARROW","=>",93],["T_WHITESPACE"," ",93],["T_STRING","true",93],["T_WHITESPACE","\n        ",93],")",",",["T_WHITESPACE","\n        ",94],["T_CONSTANT_ENCAPSED_STRING","'Customer Group Id'",95],["T_WHITESPACE","\n    ",95],")",["T_WHITESPACE","\n    ",96],["T_OBJECT_OPERATOR","->",97],["T_STRING","addIndex",97],"(",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$installer",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getIdxName",98],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/customer_group'",98],",",["T_WHITESPACE"," ",98],["T_ARRAY","array",98],"(",["T_CONSTANT_ENCAPSED_STRING","'rule_id'",98],")",")",",",["T_WHITESPACE","\n        ",98],["T_ARRAY","array",99],"(",["T_CONSTANT_ENCAPSED_STRING","'rule_id'",99],")",["T_WHITESPACE","\n    ",99],")",["T_WHITESPACE","\n    ",100],["T_OBJECT_OPERATOR","->",101],["T_STRING","addIndex",101],"(",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$installer",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getIdxName",102],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/customer_group'",102],",",["T_WHITESPACE"," ",102],["T_ARRAY","array",102],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",102],")",")",",",["T_WHITESPACE","\n        ",102],["T_ARRAY","array",103],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",103],")",["T_WHITESPACE","\n    ",103],")",["T_WHITESPACE","\n    ",104],["T_OBJECT_OPERATOR","->",105],["T_STRING","addForeignKey",105],"(",["T_VARIABLE","$installer",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getFkName",105],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/customer_group'",105],",",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'rule_id'",105],",",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'salesrule\/rule'",105],",",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'rule_id'",105],")",",",["T_WHITESPACE","\n        ",105],["T_CONSTANT_ENCAPSED_STRING","'rule_id'",106],",",["T_WHITESPACE"," ",106],["T_VARIABLE","$rulesTable",106],",",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'rule_id'",106],",",["T_WHITESPACE","\n        ",106],["T_STRING","Varien_Db_Ddl_Table",107],["T_DOUBLE_COLON","::",107],["T_STRING","ACTION_CASCADE",107],",",["T_WHITESPACE"," ",107],["T_STRING","Varien_Db_Ddl_Table",107],["T_DOUBLE_COLON","::",107],["T_STRING","ACTION_CASCADE",107],["T_WHITESPACE","\n    ",107],")",["T_WHITESPACE","\n    ",108],["T_OBJECT_OPERATOR","->",109],["T_STRING","addForeignKey",109],"(",["T_WHITESPACE","\n        ",109],["T_VARIABLE","$installer",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getFkName",110],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/customer_group'",110],",",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",110],",",["T_WHITESPACE","\n            ",110],["T_CONSTANT_ENCAPSED_STRING","'customer\/customer_group'",111],",",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",111],["T_WHITESPACE","\n        ",111],")",",",["T_WHITESPACE","\n        ",112],["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$customerGroupsTable",113],",",["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",113],",",["T_WHITESPACE","\n        ",113],["T_STRING","Varien_Db_Ddl_Table",114],["T_DOUBLE_COLON","::",114],["T_STRING","ACTION_CASCADE",114],",",["T_WHITESPACE"," ",114],["T_STRING","Varien_Db_Ddl_Table",114],["T_DOUBLE_COLON","::",114],["T_STRING","ACTION_CASCADE",114],["T_WHITESPACE","\n    ",114],")",["T_WHITESPACE","\n    ",115],["T_OBJECT_OPERATOR","->",116],["T_STRING","setComment",116],"(",["T_CONSTANT_ENCAPSED_STRING","'Sales Rules To Customer Groups Relations'",116],")",";",["T_WHITESPACE","\n\n",116],["T_VARIABLE","$connection",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","createTable",118],"(",["T_VARIABLE","$table",118],")",";",["T_WHITESPACE","\n\n\n",118],["T_DOC_COMMENT","\/**\n * Fill out relation table 'salesrule\/website' with website Ids\n *\/",121],["T_WHITESPACE","\n",123],["T_VARIABLE","$select",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$connection",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","select",124],"(",")",["T_WHITESPACE","\n    ",124],["T_OBJECT_OPERATOR","->",125],["T_STRING","from",125],"(",["T_ARRAY","array",125],"(",["T_CONSTANT_ENCAPSED_STRING","'sr'",125],["T_WHITESPACE"," ",125],["T_DOUBLE_ARROW","=>",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$rulesTable",125],")",",",["T_WHITESPACE"," ",125],["T_ARRAY","array",125],"(",["T_CONSTANT_ENCAPSED_STRING","'sr.rule_id'",125],",",["T_WHITESPACE"," ",125],["T_CONSTANT_ENCAPSED_STRING","'cw.website_id'",125],")",")",["T_WHITESPACE","\n    ",125],["T_OBJECT_OPERATOR","->",126],["T_STRING","join",126],"(",["T_WHITESPACE","\n        ",126],["T_ARRAY","array",127],"(",["T_CONSTANT_ENCAPSED_STRING","'cw'",127],["T_WHITESPACE"," ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$websitesTable",127],")",",",["T_WHITESPACE","\n        ",127],["T_VARIABLE","$connection",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","prepareSqlCondition",128],"(",["T_WHITESPACE","\n           ",128],["T_CONSTANT_ENCAPSED_STRING","'sr.website_ids'",129],",",["T_WHITESPACE"," ",129],["T_ARRAY","array",129],"(",["T_CONSTANT_ENCAPSED_STRING","'finset'",129],["T_WHITESPACE"," ",129],["T_DOUBLE_ARROW","=>",129],["T_WHITESPACE","  ",129],["T_NEW","new",129],["T_WHITESPACE"," ",129],["T_STRING","Zend_Db_Expr",129],"(",["T_CONSTANT_ENCAPSED_STRING","'cw.website_id'",129],")",")",["T_WHITESPACE","\n        ",129],")",",",["T_WHITESPACE","\n        ",130],["T_ARRAY","array",131],"(",")",["T_WHITESPACE","\n    ",131],")",";",["T_WHITESPACE","\n",132],["T_VARIABLE","$query",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_VARIABLE","$select",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","insertFromSelect",133],"(",["T_VARIABLE","$rulesWebsitesTable",133],",",["T_WHITESPACE"," ",133],["T_ARRAY","array",133],"(",["T_CONSTANT_ENCAPSED_STRING","'rule_id'",133],",",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'website_id'",133],")",")",";",["T_WHITESPACE","\n",133],["T_VARIABLE","$connection",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","query",134],"(",["T_VARIABLE","$query",134],")",";",["T_WHITESPACE","\n\n\n",134],["T_DOC_COMMENT","\/**\n * Fill out relation table 'salesrule\/customer_group' with customer group Ids\n *\/",137],["T_WHITESPACE","\n\n",139],["T_VARIABLE","$select",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_VARIABLE","$connection",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","select",141],"(",")",["T_WHITESPACE","\n    ",141],["T_OBJECT_OPERATOR","->",142],["T_STRING","from",142],"(",["T_ARRAY","array",142],"(",["T_CONSTANT_ENCAPSED_STRING","'sr'",142],["T_WHITESPACE"," ",142],["T_DOUBLE_ARROW","=>",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$rulesTable",142],")",",",["T_WHITESPACE"," ",142],["T_ARRAY","array",142],"(",["T_CONSTANT_ENCAPSED_STRING","'sr.rule_id'",142],",",["T_WHITESPACE"," ",142],["T_CONSTANT_ENCAPSED_STRING","'cg.customer_group_id'",142],")",")",["T_WHITESPACE","\n    ",142],["T_OBJECT_OPERATOR","->",143],["T_STRING","join",143],"(",["T_WHITESPACE","\n        ",143],["T_ARRAY","array",144],"(",["T_CONSTANT_ENCAPSED_STRING","'cg'",144],["T_WHITESPACE"," ",144],["T_DOUBLE_ARROW","=>",144],["T_WHITESPACE"," ",144],["T_VARIABLE","$customerGroupsTable",144],")",",",["T_WHITESPACE","\n        ",144],["T_VARIABLE","$connection",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","prepareSqlCondition",145],"(",["T_WHITESPACE","\n            ",145],["T_CONSTANT_ENCAPSED_STRING","'sr.customer_group_ids'",146],",",["T_WHITESPACE"," ",146],["T_ARRAY","array",146],"(",["T_CONSTANT_ENCAPSED_STRING","'finset'",146],["T_WHITESPACE"," ",146],["T_DOUBLE_ARROW","=>",146],["T_WHITESPACE","  ",146],["T_NEW","new",146],["T_WHITESPACE"," ",146],["T_STRING","Zend_Db_Expr",146],"(",["T_CONSTANT_ENCAPSED_STRING","'cg.customer_group_id'",146],")",")",["T_WHITESPACE","\n        ",146],")",",",["T_WHITESPACE","\n        ",147],["T_ARRAY","array",148],"(",")",["T_WHITESPACE","\n    ",148],")",";",["T_WHITESPACE","\n",149],["T_VARIABLE","$query",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_VARIABLE","$select",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","insertFromSelect",150],"(",["T_VARIABLE","$rulesCustomerGroupsTable",150],",",["T_WHITESPACE"," ",150],["T_ARRAY","array",150],"(",["T_CONSTANT_ENCAPSED_STRING","'rule_id'",150],",",["T_WHITESPACE"," ",150],["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",150],")",")",";",["T_WHITESPACE","\n",150],["T_VARIABLE","$connection",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","query",151],"(",["T_VARIABLE","$query",151],")",";",["T_WHITESPACE","\n\n",151],["T_DOC_COMMENT","\/**\n * Eliminate obsolete columns\n *\/",153],["T_WHITESPACE","\n",155],["T_VARIABLE","$connection",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","dropColumn",156],"(",["T_VARIABLE","$rulesTable",156],",",["T_WHITESPACE"," ",156],["T_CONSTANT_ENCAPSED_STRING","'website_ids'",156],")",";",["T_WHITESPACE","\n",156],["T_VARIABLE","$connection",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","dropColumn",157],"(",["T_VARIABLE","$rulesTable",157],",",["T_WHITESPACE"," ",157],["T_CONSTANT_ENCAPSED_STRING","'customer_group_ids'",157],")",";",["T_WHITESPACE","\n\n",157],["T_DOC_COMMENT","\/**\n * Change default value to \"null\" for \"from\" and \"to\" dates columns\n *\/",159],["T_WHITESPACE","\n",161],["T_VARIABLE","$connection",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","modifyColumn",162],"(",["T_WHITESPACE","\n    ",162],["T_VARIABLE","$rulesTable",163],",",["T_WHITESPACE","\n    ",163],["T_CONSTANT_ENCAPSED_STRING","'from_date'",164],",",["T_WHITESPACE","\n    ",164],["T_ARRAY","array",165],"(",["T_WHITESPACE","\n        ",165],["T_CONSTANT_ENCAPSED_STRING","'type'",166],["T_WHITESPACE","      ",166],["T_DOUBLE_ARROW","=>",166],["T_WHITESPACE"," ",166],["T_STRING","Varien_Db_Ddl_Table",166],["T_DOUBLE_COLON","::",166],["T_STRING","TYPE_DATE",166],",",["T_WHITESPACE","\n        ",166],["T_CONSTANT_ENCAPSED_STRING","'nullable'",167],["T_WHITESPACE","  ",167],["T_DOUBLE_ARROW","=>",167],["T_WHITESPACE"," ",167],["T_STRING","true",167],",",["T_WHITESPACE","\n        ",167],["T_CONSTANT_ENCAPSED_STRING","'default'",168],["T_WHITESPACE","   ",168],["T_DOUBLE_ARROW","=>",168],["T_WHITESPACE"," ",168],["T_STRING","null",168],["T_WHITESPACE","\n    ",168],")",["T_WHITESPACE","\n",169],")",";",["T_WHITESPACE","\n\n",170],["T_VARIABLE","$connection",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","modifyColumn",172],"(",["T_WHITESPACE","\n    ",172],["T_VARIABLE","$rulesTable",173],",",["T_WHITESPACE","\n    ",173],["T_CONSTANT_ENCAPSED_STRING","'to_date'",174],",",["T_WHITESPACE","\n    ",174],["T_ARRAY","array",175],"(",["T_WHITESPACE","\n        ",175],["T_CONSTANT_ENCAPSED_STRING","'type'",176],["T_WHITESPACE","      ",176],["T_DOUBLE_ARROW","=>",176],["T_WHITESPACE"," ",176],["T_STRING","Varien_Db_Ddl_Table",176],["T_DOUBLE_COLON","::",176],["T_STRING","TYPE_DATE",176],",",["T_WHITESPACE","\n        ",176],["T_CONSTANT_ENCAPSED_STRING","'nullable'",177],["T_WHITESPACE","  ",177],["T_DOUBLE_ARROW","=>",177],["T_WHITESPACE"," ",177],["T_STRING","true",177],",",["T_WHITESPACE","\n        ",177],["T_CONSTANT_ENCAPSED_STRING","'default'",178],["T_WHITESPACE","   ",178],["T_DOUBLE_ARROW","=>",178],["T_WHITESPACE"," ",178],["T_STRING","null",178],["T_WHITESPACE","\n    ",178],")",["T_WHITESPACE","\n",179],")",";",["T_WHITESPACE","\n\n",180],["T_VARIABLE","$installer",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","endSetup",182],"(",")",";",["T_WHITESPACE","\n",182]]