[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_SalesRule\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Shopping Cart Rule data model\n *\n * @method Mage_SalesRule_Model_Resource_Rule _getResource()\n * @method Mage_SalesRule_Model_Resource_Rule getResource()\n * @method string getName()\n * @method Mage_SalesRule_Model_Rule setName(string $value)\n * @method string getDescription()\n * @method Mage_SalesRule_Model_Rule setDescription(string $value)\n * @method string getFromDate()\n * @method Mage_SalesRule_Model_Rule setFromDate(string $value)\n * @method string getToDate()\n * @method Mage_SalesRule_Model_Rule setToDate(string $value)\n * @method int getUsesPerCustomer()\n * @method Mage_SalesRule_Model_Rule setUsesPerCustomer(int $value)\n * @method int getUsesPerCoupon()\n * @method Mage_SalesRule_Model_Rule setUsesPerCoupon(int $value)\n * @method string getCustomerGroupIds()\n * @method Mage_SalesRule_Model_Rule setCustomerGroupIds(string $value)\n * @method int getIsActive()\n * @method Mage_SalesRule_Model_Rule setIsActive(int $value)\n * @method string getConditionsSerialized()\n * @method Mage_SalesRule_Model_Rule setConditionsSerialized(string $value)\n * @method string getActionsSerialized()\n * @method Mage_SalesRule_Model_Rule setActionsSerialized(string $value)\n * @method int getStopRulesProcessing()\n * @method Mage_SalesRule_Model_Rule setStopRulesProcessing(int $value)\n * @method int getIsAdvanced()\n * @method Mage_SalesRule_Model_Rule setIsAdvanced(int $value)\n * @method string getProductIds()\n * @method Mage_SalesRule_Model_Rule setProductIds(string $value)\n * @method int getSortOrder()\n * @method Mage_SalesRule_Model_Rule setSortOrder(int $value)\n * @method string getSimpleAction()\n * @method Mage_SalesRule_Model_Rule setSimpleAction(string $value)\n * @method float getDiscountAmount()\n * @method Mage_SalesRule_Model_Rule setDiscountAmount(float $value)\n * @method float getDiscountQty()\n * @method Mage_SalesRule_Model_Rule setDiscountQty(float $value)\n * @method int getDiscountStep()\n * @method Mage_SalesRule_Model_Rule setDiscountStep(int $value)\n * @method int getSimpleFreeShipping()\n * @method Mage_SalesRule_Model_Rule setSimpleFreeShipping(int $value)\n * @method int getApplyToShipping()\n * @method Mage_SalesRule_Model_Rule setApplyToShipping(int $value)\n * @method int getTimesUsed()\n * @method Mage_SalesRule_Model_Rule setTimesUsed(int $value)\n * @method int getIsRss()\n * @method Mage_SalesRule_Model_Rule setIsRss(int $value)\n * @method string getWebsiteIds()\n * @method Mage_SalesRule_Model_Rule setWebsiteIds(string $value)\n * @method int getCouponType()\n * @method Mage_SalesRule_Model_Rule setCouponType(int $value)\n * @method int getUseAutoGeneration()\n * @method Mage_SalesRule_Model_Rule setUseAutoGeneration(int $value)\n * @method string getCouponCode()\n * @method Mage_SalesRule_Model_Rule setCouponCode(string $value)\n *\n * @category    Mage\n * @package     Mage_SalesRule\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",89],["T_CLASS","class",90],["T_WHITESPACE"," ",90],["T_STRING","Mage_SalesRule_Model_Rule",90],["T_WHITESPACE"," ",90],["T_EXTENDS","extends",90],["T_WHITESPACE"," ",90],["T_STRING","Mage_Rule_Model_Abstract",90],["T_WHITESPACE","\n",90],"{",["T_WHITESPACE","\n    ",91],["T_DOC_COMMENT","\/**\n     * Free Shipping option \"For matching items only\"\n     *\/",92],["T_WHITESPACE","\n    ",94],["T_CONST","const",95],["T_WHITESPACE"," ",95],["T_STRING","FREE_SHIPPING_ITEM",95],["T_WHITESPACE","    ",95],"=",["T_WHITESPACE"," ",95],["T_LNUMBER","1",95],";",["T_WHITESPACE","\n\n    ",95],["T_DOC_COMMENT","\/**\n     * Free Shipping option \"For shipment with matching items\"\n     *\/",97],["T_WHITESPACE","\n    ",99],["T_CONST","const",100],["T_WHITESPACE"," ",100],["T_STRING","FREE_SHIPPING_ADDRESS",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_LNUMBER","2",100],";",["T_WHITESPACE","\n\n    ",100],["T_DOC_COMMENT","\/**\n     * Coupon types\n     *\/",102],["T_WHITESPACE","\n    ",104],["T_CONST","const",105],["T_WHITESPACE"," ",105],["T_STRING","COUPON_TYPE_NO_COUPON",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_LNUMBER","1",105],";",["T_WHITESPACE","\n    ",105],["T_CONST","const",106],["T_WHITESPACE"," ",106],["T_STRING","COUPON_TYPE_SPECIFIC",106],["T_WHITESPACE","  ",106],"=",["T_WHITESPACE"," ",106],["T_LNUMBER","2",106],";",["T_WHITESPACE","\n    ",106],["T_CONST","const",107],["T_WHITESPACE"," ",107],["T_STRING","COUPON_TYPE_AUTO",107],["T_WHITESPACE","      ",107],"=",["T_WHITESPACE"," ",107],["T_LNUMBER","3",107],";",["T_WHITESPACE","\n\n    ",107],["T_DOC_COMMENT","\/**\n     * Rule type actions\n     *\/",109],["T_WHITESPACE","\n    ",111],["T_CONST","const",112],["T_WHITESPACE"," ",112],["T_STRING","TO_PERCENT_ACTION",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'to_percent'",112],";",["T_WHITESPACE","\n    ",112],["T_CONST","const",113],["T_WHITESPACE"," ",113],["T_STRING","BY_PERCENT_ACTION",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","'by_percent'",113],";",["T_WHITESPACE","\n    ",113],["T_CONST","const",114],["T_WHITESPACE"," ",114],["T_STRING","TO_FIXED_ACTION",114],["T_WHITESPACE","   ",114],"=",["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","'to_fixed'",114],";",["T_WHITESPACE","\n    ",114],["T_CONST","const",115],["T_WHITESPACE"," ",115],["T_STRING","BY_FIXED_ACTION",115],["T_WHITESPACE","   ",115],"=",["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'by_fixed'",115],";",["T_WHITESPACE","\n    ",115],["T_CONST","const",116],["T_WHITESPACE"," ",116],["T_STRING","CART_FIXED_ACTION",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","'cart_fixed'",116],";",["T_WHITESPACE","\n    ",116],["T_CONST","const",117],["T_WHITESPACE"," ",117],["T_STRING","BUY_X_GET_Y_ACTION",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_CONSTANT_ENCAPSED_STRING","'buy_x_get_y'",117],";",["T_WHITESPACE","\n\n    ",117],["T_DOC_COMMENT","\/**\n     * Store coupon code generator instance\n     *\n     * @var Mage_SalesRule_Model_Coupon_CodegeneratorInterface\n     *\/",119],["T_WHITESPACE","\n    ",123],["T_PROTECTED","protected",124],["T_WHITESPACE"," ",124],["T_STATIC","static",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$_couponCodeGenerator",124],";",["T_WHITESPACE","\n\n    ",124],["T_DOC_COMMENT","\/**\n     * Prefix of model events names\n     *\n     * @var string\n     *\/",126],["T_WHITESPACE","\n    ",130],["T_PROTECTED","protected",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$_eventPrefix",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","'salesrule_rule'",131],";",["T_WHITESPACE","\n\n    ",131],["T_DOC_COMMENT","\/**\n     * Parameter name in event\n     *\n     * In observe method you can use $observer->getEvent()->getRule() in this case\n     *\n     * @var string\n     *\/",133],["T_WHITESPACE","\n    ",139],["T_PROTECTED","protected",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$_eventObject",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_CONSTANT_ENCAPSED_STRING","'rule'",140],";",["T_WHITESPACE","\n\n    ",140],["T_DOC_COMMENT","\/**\n     * Contain sores labels\n     *\n     * @deprecated after 1.6.2.0\n     *\n     * @var array\n     *\/",142],["T_WHITESPACE","\n    ",148],["T_PROTECTED","protected",149],["T_WHITESPACE"," ",149],["T_VARIABLE","$_labels",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_ARRAY","array",149],"(",")",";",["T_WHITESPACE","\n\n    ",149],["T_DOC_COMMENT","\/**\n     * Rule's primary coupon\n     *\n     * @var Mage_SalesRule_Model_Coupon\n     *\/",151],["T_WHITESPACE","\n    ",155],["T_PROTECTED","protected",156],["T_WHITESPACE"," ",156],["T_VARIABLE","$_primaryCoupon",156],";",["T_WHITESPACE","\n\n    ",156],["T_DOC_COMMENT","\/**\n     * Rule's subordinate coupons\n     *\n     * @var array of Mage_SalesRule_Model_Coupon\n     *\/",158],["T_WHITESPACE","\n    ",162],["T_PROTECTED","protected",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$_coupons",163],";",["T_WHITESPACE","\n\n    ",163],["T_DOC_COMMENT","\/**\n     * Coupon types cache for lazy getter\n     *\n     * @var array\n     *\/",165],["T_WHITESPACE","\n    ",169],["T_PROTECTED","protected",170],["T_WHITESPACE"," ",170],["T_VARIABLE","$_couponTypes",170],";",["T_WHITESPACE","\n\n    ",170],["T_DOC_COMMENT","\/**\n     * Store already validated addresses and validation results\n     *\n     * @var array\n     *\/",172],["T_WHITESPACE","\n    ",176],["T_PROTECTED","protected",177],["T_WHITESPACE"," ",177],["T_VARIABLE","$_validatedAddresses",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_ARRAY","array",177],"(",")",";",["T_WHITESPACE","\n\n    ",177],["T_DOC_COMMENT","\/**\n     * Set resource model and Id field name\n     *\/",179],["T_WHITESPACE","\n    ",181],["T_PROTECTED","protected",182],["T_WHITESPACE"," ",182],["T_FUNCTION","function",182],["T_WHITESPACE"," ",182],["T_STRING","_construct",182],"(",")",["T_WHITESPACE","\n    ",182],"{",["T_WHITESPACE","\n        ",183],["T_STRING","parent",184],["T_DOUBLE_COLON","::",184],["T_STRING","_construct",184],"(",")",";",["T_WHITESPACE","\n        ",184],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","_init",185],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/rule'",185],")",";",["T_WHITESPACE","\n        ",185],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","setIdFieldName",186],"(",["T_CONSTANT_ENCAPSED_STRING","'rule_id'",186],")",";",["T_WHITESPACE","\n    ",186],"}",["T_WHITESPACE","\n\n    ",187],["T_DOC_COMMENT","\/**\n     * Returns code mass generator instance for auto generated specific coupons\n     *\n     * @return Mage_SalesRule_Model_Coupon_MassgneratorInterface\n     *\/",189],["T_WHITESPACE","\n    ",193],["T_PUBLIC","public",194],["T_WHITESPACE"," ",194],["T_STATIC","static",194],["T_WHITESPACE"," ",194],["T_FUNCTION","function",194],["T_WHITESPACE"," ",194],["T_STRING","getCouponMassGenerator",194],"(",")",["T_WHITESPACE","\n    ",194],"{",["T_WHITESPACE","\n        ",195],["T_RETURN","return",196],["T_WHITESPACE"," ",196],["T_STRING","Mage",196],["T_DOUBLE_COLON","::",196],["T_STRING","getSingleton",196],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/coupon_massgenerator'",196],")",";",["T_WHITESPACE","\n    ",196],"}",["T_WHITESPACE","\n\n    ",197],["T_DOC_COMMENT","\/**\n     * Set coupon code and uses per coupon\n     *\n     * @return Mage_SalesRule_Model_Rule\n     *\/",199],["T_WHITESPACE","\n    ",203],["T_PROTECTED","protected",204],["T_WHITESPACE"," ",204],["T_FUNCTION","function",204],["T_WHITESPACE"," ",204],["T_STRING","_afterLoad",204],"(",")",["T_WHITESPACE","\n    ",204],"{",["T_WHITESPACE","\n        ",205],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","setCouponCode",206],"(",["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","getPrimaryCoupon",206],"(",")",["T_OBJECT_OPERATOR","->",206],["T_STRING","getCode",206],"(",")",")",";",["T_WHITESPACE","\n        ",206],["T_IF","if",207],["T_WHITESPACE"," ",207],"(",["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","getUsesPerCoupon",207],"(",")",["T_WHITESPACE"," ",207],["T_IS_NOT_IDENTICAL","!==",207],["T_WHITESPACE"," ",207],["T_STRING","null",207],["T_WHITESPACE"," ",207],["T_BOOLEAN_AND","&&",207],["T_WHITESPACE"," ",207],"!",["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","getUseAutoGeneration",207],"(",")",")",["T_WHITESPACE"," ",207],"{",["T_WHITESPACE","\n            ",207],["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","setUsesPerCoupon",208],"(",["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","getPrimaryCoupon",208],"(",")",["T_OBJECT_OPERATOR","->",208],["T_STRING","getUsageLimit",208],"(",")",")",";",["T_WHITESPACE","\n        ",208],"}",["T_WHITESPACE","\n        ",209],["T_RETURN","return",210],["T_WHITESPACE"," ",210],["T_STRING","parent",210],["T_DOUBLE_COLON","::",210],["T_STRING","_afterLoad",210],"(",")",";",["T_WHITESPACE","\n    ",210],"}",["T_WHITESPACE","\n\n    ",211],["T_DOC_COMMENT","\/**\n     * Save\/delete coupon\n     *\n     * @return Mage_SalesRule_Model_Rule\n     *\/",213],["T_WHITESPACE","\n    ",217],["T_PROTECTED","protected",218],["T_WHITESPACE"," ",218],["T_FUNCTION","function",218],["T_WHITESPACE"," ",218],["T_STRING","_afterSave",218],"(",")",["T_WHITESPACE","\n    ",218],"{",["T_WHITESPACE","\n        ",219],["T_VARIABLE","$couponCode",220],["T_WHITESPACE"," ",220],"=",["T_WHITESPACE"," ",220],["T_STRING","trim",220],"(",["T_VARIABLE","$this",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","getCouponCode",220],"(",")",")",";",["T_WHITESPACE","\n        ",220],["T_IF","if",221],["T_WHITESPACE"," ",221],"(",["T_STRING","strlen",221],"(",["T_VARIABLE","$couponCode",221],")",["T_WHITESPACE","\n            ",221],["T_BOOLEAN_AND","&&",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","getCouponType",222],"(",")",["T_WHITESPACE"," ",222],["T_IS_EQUAL","==",222],["T_WHITESPACE"," ",222],["T_STRING","self",222],["T_DOUBLE_COLON","::",222],["T_STRING","COUPON_TYPE_SPECIFIC",222],["T_WHITESPACE","\n            ",222],["T_BOOLEAN_AND","&&",223],["T_WHITESPACE"," ",223],"!",["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","getUseAutoGeneration",223],"(",")",["T_WHITESPACE","\n        ",223],")",["T_WHITESPACE"," ",224],"{",["T_WHITESPACE","\n            ",224],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","getPrimaryCoupon",225],"(",")",["T_WHITESPACE","\n                ",225],["T_OBJECT_OPERATOR","->",226],["T_STRING","setCode",226],"(",["T_VARIABLE","$couponCode",226],")",["T_WHITESPACE","\n                ",226],["T_OBJECT_OPERATOR","->",227],["T_STRING","setUsageLimit",227],"(",["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","getUsesPerCoupon",227],"(",")",["T_WHITESPACE"," ",227],"?",["T_WHITESPACE"," ",227],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","getUsesPerCoupon",227],"(",")",["T_WHITESPACE"," ",227],":",["T_WHITESPACE"," ",227],["T_STRING","null",227],")",["T_WHITESPACE","\n                ",227],["T_OBJECT_OPERATOR","->",228],["T_STRING","setUsagePerCustomer",228],"(",["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getUsesPerCustomer",228],"(",")",["T_WHITESPACE"," ",228],"?",["T_WHITESPACE"," ",228],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getUsesPerCustomer",228],"(",")",["T_WHITESPACE"," ",228],":",["T_WHITESPACE"," ",228],["T_STRING","null",228],")",["T_WHITESPACE","\n                ",228],["T_OBJECT_OPERATOR","->",229],["T_STRING","setExpirationDate",229],"(",["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","getToDate",229],"(",")",")",["T_WHITESPACE","\n                ",229],["T_OBJECT_OPERATOR","->",230],["T_STRING","save",230],"(",")",";",["T_WHITESPACE","\n        ",230],"}",["T_WHITESPACE"," ",231],["T_ELSE","else",231],["T_WHITESPACE"," ",231],"{",["T_WHITESPACE","\n            ",231],["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","getPrimaryCoupon",232],"(",")",["T_OBJECT_OPERATOR","->",232],["T_STRING","delete",232],"(",")",";",["T_WHITESPACE","\n        ",232],"}",["T_WHITESPACE","\n\n        ",233],["T_STRING","parent",235],["T_DOUBLE_COLON","::",235],["T_STRING","_afterSave",235],"(",")",";",["T_WHITESPACE","\n        ",235],["T_RETURN","return",236],["T_WHITESPACE"," ",236],["T_VARIABLE","$this",236],";",["T_WHITESPACE","\n    ",236],"}",["T_WHITESPACE","\n\n    ",237],["T_DOC_COMMENT","\/**\n     * Initialize rule model data from array.\n     * Set store labels if applicable.\n     *\n     * @param array $data\n     *\n     * @return Mage_SalesRule_Model_Rule\n     *\/",239],["T_WHITESPACE","\n    ",246],["T_PUBLIC","public",247],["T_WHITESPACE"," ",247],["T_FUNCTION","function",247],["T_WHITESPACE"," ",247],["T_STRING","loadPost",247],"(",["T_ARRAY","array",247],["T_WHITESPACE"," ",247],["T_VARIABLE","$data",247],")",["T_WHITESPACE","\n    ",247],"{",["T_WHITESPACE","\n        ",248],["T_STRING","parent",249],["T_DOUBLE_COLON","::",249],["T_STRING","loadPost",249],"(",["T_VARIABLE","$data",249],")",";",["T_WHITESPACE","\n\n        ",249],["T_IF","if",251],["T_WHITESPACE"," ",251],"(",["T_ISSET","isset",251],"(",["T_VARIABLE","$data",251],"[",["T_CONSTANT_ENCAPSED_STRING","'store_labels'",251],"]",")",")",["T_WHITESPACE"," ",251],"{",["T_WHITESPACE","\n            ",251],["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","setStoreLabels",252],"(",["T_VARIABLE","$data",252],"[",["T_CONSTANT_ENCAPSED_STRING","'store_labels'",252],"]",")",";",["T_WHITESPACE","\n        ",252],"}",["T_WHITESPACE","\n\n        ",253],["T_RETURN","return",255],["T_WHITESPACE"," ",255],["T_VARIABLE","$this",255],";",["T_WHITESPACE","\n    ",255],"}",["T_WHITESPACE","\n\n    ",256],["T_DOC_COMMENT","\/**\n     * Get rule condition combine model instance\n     *\n     * @return Mage_SalesRule_Model_Rule_Condition_Combine\n     *\/",258],["T_WHITESPACE","\n    ",262],["T_PUBLIC","public",263],["T_WHITESPACE"," ",263],["T_FUNCTION","function",263],["T_WHITESPACE"," ",263],["T_STRING","getConditionsInstance",263],"(",")",["T_WHITESPACE","\n    ",263],"{",["T_WHITESPACE","\n        ",264],["T_RETURN","return",265],["T_WHITESPACE"," ",265],["T_STRING","Mage",265],["T_DOUBLE_COLON","::",265],["T_STRING","getModel",265],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/rule_condition_combine'",265],")",";",["T_WHITESPACE","\n    ",265],"}",["T_WHITESPACE","\n\n    ",266],["T_DOC_COMMENT","\/**\n     * Get rule condition product combine model instance\n     *\n     * @return Mage_SalesRule_Model_Rule_Condition_Product_Combine\n     *\/",268],["T_WHITESPACE","\n    ",272],["T_PUBLIC","public",273],["T_WHITESPACE"," ",273],["T_FUNCTION","function",273],["T_WHITESPACE"," ",273],["T_STRING","getActionsInstance",273],"(",")",["T_WHITESPACE","\n    ",273],"{",["T_WHITESPACE","\n        ",274],["T_RETURN","return",275],["T_WHITESPACE"," ",275],["T_STRING","Mage",275],["T_DOUBLE_COLON","::",275],["T_STRING","getModel",275],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/rule_condition_product_combine'",275],")",";",["T_WHITESPACE","\n    ",275],"}",["T_WHITESPACE","\n\n    ",276],["T_DOC_COMMENT","\/**\n     * Returns code generator instance for auto generated coupons\n     *\n     * @return Mage_SalesRule_Model_Coupon_CodegeneratorInterface\n     *\/",278],["T_WHITESPACE","\n    ",282],["T_PUBLIC","public",283],["T_WHITESPACE"," ",283],["T_STATIC","static",283],["T_WHITESPACE"," ",283],["T_FUNCTION","function",283],["T_WHITESPACE"," ",283],["T_STRING","getCouponCodeGenerator",283],"(",")",["T_WHITESPACE","\n    ",283],"{",["T_WHITESPACE","\n        ",284],["T_IF","if",285],["T_WHITESPACE"," ",285],"(","!",["T_STRING","self",285],["T_DOUBLE_COLON","::",285],["T_VARIABLE","$_couponCodeGenerator",285],")",["T_WHITESPACE"," ",285],"{",["T_WHITESPACE","\n            ",285],["T_RETURN","return",286],["T_WHITESPACE"," ",286],["T_STRING","Mage",286],["T_DOUBLE_COLON","::",286],["T_STRING","getSingleton",286],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/coupon_codegenerator'",286],",",["T_WHITESPACE"," ",286],["T_ARRAY","array",286],"(",["T_CONSTANT_ENCAPSED_STRING","'length'",286],["T_WHITESPACE"," ",286],["T_DOUBLE_ARROW","=>",286],["T_WHITESPACE"," ",286],["T_LNUMBER","16",286],")",")",";",["T_WHITESPACE","\n        ",286],"}",["T_WHITESPACE","\n        ",287],["T_RETURN","return",288],["T_WHITESPACE"," ",288],["T_STRING","self",288],["T_DOUBLE_COLON","::",288],["T_VARIABLE","$_couponCodeGenerator",288],";",["T_WHITESPACE","\n    ",288],"}",["T_WHITESPACE","\n\n    ",289],["T_DOC_COMMENT","\/**\n     * Set code generator instance for auto generated coupons\n     *\n     * @param Mage_SalesRule_Model_Coupon_CodegeneratorInterface\n     *\/",291],["T_WHITESPACE","\n    ",295],["T_PUBLIC","public",296],["T_WHITESPACE"," ",296],["T_STATIC","static",296],["T_WHITESPACE"," ",296],["T_FUNCTION","function",296],["T_WHITESPACE"," ",296],["T_STRING","setCouponCodeGenerator",296],"(",["T_STRING","Mage_SalesRule_Model_Coupon_CodegeneratorInterface",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$codeGenerator",296],")",["T_WHITESPACE","\n    ",296],"{",["T_WHITESPACE","\n        ",297],["T_STRING","self",298],["T_DOUBLE_COLON","::",298],["T_VARIABLE","$_couponCodeGenerator",298],["T_WHITESPACE"," ",298],"=",["T_WHITESPACE"," ",298],["T_VARIABLE","$codeGenerator",298],";",["T_WHITESPACE","\n    ",298],"}",["T_WHITESPACE","\n\n    ",299],["T_DOC_COMMENT","\/**\n     * Retrieve rule's primary coupon\n     *\n     * @return Mage_SalesRule_Model_Coupon\n     *\/",301],["T_WHITESPACE","\n    ",305],["T_PUBLIC","public",306],["T_WHITESPACE"," ",306],["T_FUNCTION","function",306],["T_WHITESPACE"," ",306],["T_STRING","getPrimaryCoupon",306],"(",")",["T_WHITESPACE","\n    ",306],"{",["T_WHITESPACE","\n        ",307],["T_IF","if",308],["T_WHITESPACE"," ",308],"(",["T_VARIABLE","$this",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","_primaryCoupon",308],["T_WHITESPACE"," ",308],["T_IS_IDENTICAL","===",308],["T_WHITESPACE"," ",308],["T_STRING","null",308],")",["T_WHITESPACE"," ",308],"{",["T_WHITESPACE","\n            ",308],["T_VARIABLE","$this",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","_primaryCoupon",309],["T_WHITESPACE"," ",309],"=",["T_WHITESPACE"," ",309],["T_STRING","Mage",309],["T_DOUBLE_COLON","::",309],["T_STRING","getModel",309],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/coupon'",309],")",";",["T_WHITESPACE","\n            ",309],["T_VARIABLE","$this",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","_primaryCoupon",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","loadPrimaryByRule",310],"(",["T_VARIABLE","$this",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","getId",310],"(",")",")",";",["T_WHITESPACE","\n            ",310],["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","_primaryCoupon",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","setRule",311],"(",["T_VARIABLE","$this",311],")",["T_OBJECT_OPERATOR","->",311],["T_STRING","setIsPrimary",311],"(",["T_STRING","true",311],")",";",["T_WHITESPACE","\n        ",311],"}",["T_WHITESPACE","\n        ",312],["T_RETURN","return",313],["T_WHITESPACE"," ",313],["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","_primaryCoupon",313],";",["T_WHITESPACE","\n    ",313],"}",["T_WHITESPACE","\n\n    ",314],["T_DOC_COMMENT","\/**\n     * Get sales rule customer group Ids\n     *\n     * @return array\n     *\/",316],["T_WHITESPACE","\n    ",320],["T_PUBLIC","public",321],["T_WHITESPACE"," ",321],["T_FUNCTION","function",321],["T_WHITESPACE"," ",321],["T_STRING","getCustomerGroupIds",321],"(",")",["T_WHITESPACE","\n    ",321],"{",["T_WHITESPACE","\n        ",322],["T_IF","if",323],["T_WHITESPACE"," ",323],"(","!",["T_VARIABLE","$this",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","hasCustomerGroupIds",323],"(",")",")",["T_WHITESPACE"," ",323],"{",["T_WHITESPACE","\n            ",323],["T_VARIABLE","$customerGroupIds",324],["T_WHITESPACE"," ",324],"=",["T_WHITESPACE"," ",324],["T_VARIABLE","$this",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","_getResource",324],"(",")",["T_OBJECT_OPERATOR","->",324],["T_STRING","getCustomerGroupIds",324],"(",["T_VARIABLE","$this",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","getId",324],"(",")",")",";",["T_WHITESPACE","\n            ",324],["T_VARIABLE","$this",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","setData",325],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_group_ids'",325],",",["T_WHITESPACE"," ",325],["T_ARRAY_CAST","(array)",325],["T_VARIABLE","$customerGroupIds",325],")",";",["T_WHITESPACE","\n        ",325],"}",["T_WHITESPACE","\n        ",326],["T_RETURN","return",327],["T_WHITESPACE"," ",327],["T_VARIABLE","$this",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","_getData",327],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_group_ids'",327],")",";",["T_WHITESPACE","\n    ",327],"}",["T_WHITESPACE","\n\n    ",328],["T_DOC_COMMENT","\/**\n     * Get Rule label by specified store\n     *\n     * @param Mage_Core_Model_Store|int|bool|null $store\n     *\n     * @return string|bool\n     *\/",330],["T_WHITESPACE","\n    ",336],["T_PUBLIC","public",337],["T_WHITESPACE"," ",337],["T_FUNCTION","function",337],["T_WHITESPACE"," ",337],["T_STRING","getStoreLabel",337],"(",["T_VARIABLE","$store",337],["T_WHITESPACE"," ",337],"=",["T_WHITESPACE"," ",337],["T_STRING","null",337],")",["T_WHITESPACE","\n    ",337],"{",["T_WHITESPACE","\n        ",338],["T_VARIABLE","$storeId",339],["T_WHITESPACE"," ",339],"=",["T_WHITESPACE"," ",339],["T_STRING","Mage",339],["T_DOUBLE_COLON","::",339],["T_STRING","app",339],"(",")",["T_OBJECT_OPERATOR","->",339],["T_STRING","getStore",339],"(",["T_VARIABLE","$store",339],")",["T_OBJECT_OPERATOR","->",339],["T_STRING","getId",339],"(",")",";",["T_WHITESPACE","\n        ",339],["T_VARIABLE","$labels",340],["T_WHITESPACE"," ",340],"=",["T_WHITESPACE"," ",340],["T_ARRAY_CAST","(array)",340],["T_VARIABLE","$this",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","getStoreLabels",340],"(",")",";",["T_WHITESPACE","\n\n        ",340],["T_IF","if",342],["T_WHITESPACE"," ",342],"(",["T_ISSET","isset",342],"(",["T_VARIABLE","$labels",342],"[",["T_VARIABLE","$storeId",342],"]",")",")",["T_WHITESPACE"," ",342],"{",["T_WHITESPACE","\n            ",342],["T_RETURN","return",343],["T_WHITESPACE"," ",343],["T_VARIABLE","$labels",343],"[",["T_VARIABLE","$storeId",343],"]",";",["T_WHITESPACE","\n        ",343],"}",["T_WHITESPACE"," ",344],["T_ELSEIF","elseif",344],["T_WHITESPACE"," ",344],"(",["T_ISSET","isset",344],"(",["T_VARIABLE","$labels",344],"[",["T_LNUMBER","0",344],"]",")",["T_WHITESPACE"," ",344],["T_BOOLEAN_AND","&&",344],["T_WHITESPACE"," ",344],["T_VARIABLE","$labels",344],"[",["T_LNUMBER","0",344],"]",")",["T_WHITESPACE"," ",344],"{",["T_WHITESPACE","\n            ",344],["T_RETURN","return",345],["T_WHITESPACE"," ",345],["T_VARIABLE","$labels",345],"[",["T_LNUMBER","0",345],"]",";",["T_WHITESPACE","\n        ",345],"}",["T_WHITESPACE","\n\n        ",346],["T_RETURN","return",348],["T_WHITESPACE"," ",348],["T_STRING","false",348],";",["T_WHITESPACE","\n    ",348],"}",["T_WHITESPACE","\n\n    ",349],["T_DOC_COMMENT","\/**\n     * Set if not yet and retrieve rule store labels\n     *\n     * @return array\n     *\/",351],["T_WHITESPACE","\n    ",355],["T_PUBLIC","public",356],["T_WHITESPACE"," ",356],["T_FUNCTION","function",356],["T_WHITESPACE"," ",356],["T_STRING","getStoreLabels",356],"(",")",["T_WHITESPACE","\n    ",356],"{",["T_WHITESPACE","\n        ",357],["T_IF","if",358],["T_WHITESPACE"," ",358],"(","!",["T_VARIABLE","$this",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","hasStoreLabels",358],"(",")",")",["T_WHITESPACE"," ",358],"{",["T_WHITESPACE","\n            ",358],["T_VARIABLE","$labels",359],["T_WHITESPACE"," ",359],"=",["T_WHITESPACE"," ",359],["T_VARIABLE","$this",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","_getResource",359],"(",")",["T_OBJECT_OPERATOR","->",359],["T_STRING","getStoreLabels",359],"(",["T_VARIABLE","$this",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","getId",359],"(",")",")",";",["T_WHITESPACE","\n            ",359],["T_VARIABLE","$this",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","setStoreLabels",360],"(",["T_VARIABLE","$labels",360],")",";",["T_WHITESPACE","\n        ",360],"}",["T_WHITESPACE","\n\n        ",361],["T_RETURN","return",363],["T_WHITESPACE"," ",363],["T_VARIABLE","$this",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","_getData",363],"(",["T_CONSTANT_ENCAPSED_STRING","'store_labels'",363],")",";",["T_WHITESPACE","\n    ",363],"}",["T_WHITESPACE","\n\n    ",364],["T_DOC_COMMENT","\/**\n     * Retrieve subordinate coupons\n     *\n     * @return array of Mage_SalesRule_Model_Coupon\n     *\/",366],["T_WHITESPACE","\n    ",370],["T_PUBLIC","public",371],["T_WHITESPACE"," ",371],["T_FUNCTION","function",371],["T_WHITESPACE"," ",371],["T_STRING","getCoupons",371],"(",")",["T_WHITESPACE","\n    ",371],"{",["T_WHITESPACE","\n        ",372],["T_IF","if",373],["T_WHITESPACE"," ",373],"(",["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","_coupons",373],["T_WHITESPACE"," ",373],["T_IS_IDENTICAL","===",373],["T_WHITESPACE"," ",373],["T_STRING","null",373],")",["T_WHITESPACE"," ",373],"{",["T_WHITESPACE","\n            ",373],["T_VARIABLE","$collection",374],["T_WHITESPACE"," ",374],"=",["T_WHITESPACE"," ",374],["T_STRING","Mage",374],["T_DOUBLE_COLON","::",374],["T_STRING","getResourceModel",374],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/coupon_collection'",374],")",";",["T_WHITESPACE","\n            ",374],["T_DOC_COMMENT","\/** @var Mage_SalesRule_Model_Resource_Coupon_Collection *\/",375],["T_WHITESPACE","\n            ",375],["T_VARIABLE","$collection",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","addRuleToFilter",376],"(",["T_VARIABLE","$this",376],")",";",["T_WHITESPACE","\n            ",376],["T_VARIABLE","$this",377],["T_OBJECT_OPERATOR","->",377],["T_STRING","_coupons",377],["T_WHITESPACE"," ",377],"=",["T_WHITESPACE"," ",377],["T_VARIABLE","$collection",377],["T_OBJECT_OPERATOR","->",377],["T_STRING","getItems",377],"(",")",";",["T_WHITESPACE","\n        ",377],"}",["T_WHITESPACE","\n        ",378],["T_RETURN","return",379],["T_WHITESPACE"," ",379],["T_VARIABLE","$this",379],["T_OBJECT_OPERATOR","->",379],["T_STRING","_coupons",379],";",["T_WHITESPACE","\n    ",379],"}",["T_WHITESPACE","\n\n    ",380],["T_DOC_COMMENT","\/**\n     * Retrieve coupon types\n     *\n     * @return array\n     *\/",382],["T_WHITESPACE","\n    ",386],["T_PUBLIC","public",387],["T_WHITESPACE"," ",387],["T_FUNCTION","function",387],["T_WHITESPACE"," ",387],["T_STRING","getCouponTypes",387],"(",")",["T_WHITESPACE","\n    ",387],"{",["T_WHITESPACE","\n        ",388],["T_IF","if",389],["T_WHITESPACE"," ",389],"(",["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","_couponTypes",389],["T_WHITESPACE"," ",389],["T_IS_IDENTICAL","===",389],["T_WHITESPACE"," ",389],["T_STRING","null",389],")",["T_WHITESPACE"," ",389],"{",["T_WHITESPACE","\n            ",389],["T_VARIABLE","$this",390],["T_OBJECT_OPERATOR","->",390],["T_STRING","_couponTypes",390],["T_WHITESPACE"," ",390],"=",["T_WHITESPACE"," ",390],["T_ARRAY","array",390],"(",["T_WHITESPACE","\n                ",390],["T_STRING","Mage_SalesRule_Model_Rule",391],["T_DOUBLE_COLON","::",391],["T_STRING","COUPON_TYPE_NO_COUPON",391],["T_WHITESPACE"," ",391],["T_DOUBLE_ARROW","=>",391],["T_WHITESPACE"," ",391],["T_STRING","Mage",391],["T_DOUBLE_COLON","::",391],["T_STRING","helper",391],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule'",391],")",["T_OBJECT_OPERATOR","->",391],["T_STRING","__",391],"(",["T_CONSTANT_ENCAPSED_STRING","'No Coupon'",391],")",",",["T_WHITESPACE","\n                ",391],["T_STRING","Mage_SalesRule_Model_Rule",392],["T_DOUBLE_COLON","::",392],["T_STRING","COUPON_TYPE_SPECIFIC",392],["T_WHITESPACE","  ",392],["T_DOUBLE_ARROW","=>",392],["T_WHITESPACE"," ",392],["T_STRING","Mage",392],["T_DOUBLE_COLON","::",392],["T_STRING","helper",392],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule'",392],")",["T_OBJECT_OPERATOR","->",392],["T_STRING","__",392],"(",["T_CONSTANT_ENCAPSED_STRING","'Specific Coupon'",392],")",",",["T_WHITESPACE","\n            ",392],")",";",["T_WHITESPACE","\n            ",393],["T_VARIABLE","$transport",394],["T_WHITESPACE"," ",394],"=",["T_WHITESPACE"," ",394],["T_NEW","new",394],["T_WHITESPACE"," ",394],["T_STRING","Varien_Object",394],"(",["T_ARRAY","array",394],"(",["T_WHITESPACE","\n                ",394],["T_CONSTANT_ENCAPSED_STRING","'coupon_types'",395],["T_WHITESPACE","                ",395],["T_DOUBLE_ARROW","=>",395],["T_WHITESPACE"," ",395],["T_VARIABLE","$this",395],["T_OBJECT_OPERATOR","->",395],["T_STRING","_couponTypes",395],",",["T_WHITESPACE","\n                ",395],["T_CONSTANT_ENCAPSED_STRING","'is_coupon_type_auto_visible'",396],["T_WHITESPACE"," ",396],["T_DOUBLE_ARROW","=>",396],["T_WHITESPACE"," ",396],["T_STRING","false",396],["T_WHITESPACE","\n            ",396],")",")",";",["T_WHITESPACE","\n            ",397],["T_STRING","Mage",398],["T_DOUBLE_COLON","::",398],["T_STRING","dispatchEvent",398],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule_rule_get_coupon_types'",398],",",["T_WHITESPACE"," ",398],["T_ARRAY","array",398],"(",["T_CONSTANT_ENCAPSED_STRING","'transport'",398],["T_WHITESPACE"," ",398],["T_DOUBLE_ARROW","=>",398],["T_WHITESPACE"," ",398],["T_VARIABLE","$transport",398],")",")",";",["T_WHITESPACE","\n            ",398],["T_VARIABLE","$this",399],["T_OBJECT_OPERATOR","->",399],["T_STRING","_couponTypes",399],["T_WHITESPACE"," ",399],"=",["T_WHITESPACE"," ",399],["T_VARIABLE","$transport",399],["T_OBJECT_OPERATOR","->",399],["T_STRING","getCouponTypes",399],"(",")",";",["T_WHITESPACE","\n            ",399],["T_IF","if",400],["T_WHITESPACE"," ",400],"(",["T_VARIABLE","$transport",400],["T_OBJECT_OPERATOR","->",400],["T_STRING","getIsCouponTypeAutoVisible",400],"(",")",")",["T_WHITESPACE"," ",400],"{",["T_WHITESPACE","\n                ",400],["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","_couponTypes",401],"[",["T_STRING","Mage_SalesRule_Model_Rule",401],["T_DOUBLE_COLON","::",401],["T_STRING","COUPON_TYPE_AUTO",401],"]",["T_WHITESPACE"," ",401],"=",["T_WHITESPACE"," ",401],["T_STRING","Mage",401],["T_DOUBLE_COLON","::",401],["T_STRING","helper",401],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule'",401],")",["T_OBJECT_OPERATOR","->",401],["T_STRING","__",401],"(",["T_CONSTANT_ENCAPSED_STRING","'Auto'",401],")",";",["T_WHITESPACE","\n            ",401],"}",["T_WHITESPACE","\n        ",402],"}",["T_WHITESPACE","\n        ",403],["T_RETURN","return",404],["T_WHITESPACE"," ",404],["T_VARIABLE","$this",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","_couponTypes",404],";",["T_WHITESPACE","\n    ",404],"}",["T_WHITESPACE","\n\n    ",405],["T_DOC_COMMENT","\/**\n     * Acquire coupon instance\n     *\n     * @param bool $saveNewlyCreated Whether or not to save newly created coupon\n     * @param int $saveAttemptCount Number of attempts to save newly created coupon\n     *\n     * @return Mage_SalesRule_Model_Coupon|null\n     *\/",407],["T_WHITESPACE","\n    ",414],["T_PUBLIC","public",415],["T_WHITESPACE"," ",415],["T_FUNCTION","function",415],["T_WHITESPACE"," ",415],["T_STRING","acquireCoupon",415],"(",["T_VARIABLE","$saveNewlyCreated",415],["T_WHITESPACE"," ",415],"=",["T_WHITESPACE"," ",415],["T_STRING","true",415],",",["T_WHITESPACE"," ",415],["T_VARIABLE","$saveAttemptCount",415],["T_WHITESPACE"," ",415],"=",["T_WHITESPACE"," ",415],["T_LNUMBER","10",415],")",["T_WHITESPACE","\n    ",415],"{",["T_WHITESPACE","\n        ",416],["T_IF","if",417],["T_WHITESPACE"," ",417],"(",["T_VARIABLE","$this",417],["T_OBJECT_OPERATOR","->",417],["T_STRING","getCouponType",417],"(",")",["T_WHITESPACE"," ",417],["T_IS_EQUAL","==",417],["T_WHITESPACE"," ",417],["T_STRING","self",417],["T_DOUBLE_COLON","::",417],["T_STRING","COUPON_TYPE_NO_COUPON",417],")",["T_WHITESPACE"," ",417],"{",["T_WHITESPACE","\n            ",417],["T_RETURN","return",418],["T_WHITESPACE"," ",418],["T_STRING","null",418],";",["T_WHITESPACE","\n        ",418],"}",["T_WHITESPACE","\n        ",419],["T_IF","if",420],["T_WHITESPACE"," ",420],"(",["T_VARIABLE","$this",420],["T_OBJECT_OPERATOR","->",420],["T_STRING","getCouponType",420],"(",")",["T_WHITESPACE"," ",420],["T_IS_EQUAL","==",420],["T_WHITESPACE"," ",420],["T_STRING","self",420],["T_DOUBLE_COLON","::",420],["T_STRING","COUPON_TYPE_SPECIFIC",420],")",["T_WHITESPACE"," ",420],"{",["T_WHITESPACE","\n            ",420],["T_RETURN","return",421],["T_WHITESPACE"," ",421],["T_VARIABLE","$this",421],["T_OBJECT_OPERATOR","->",421],["T_STRING","getPrimaryCoupon",421],"(",")",";",["T_WHITESPACE","\n        ",421],"}",["T_WHITESPACE","\n        ",422],["T_DOC_COMMENT","\/** @var Mage_SalesRule_Model_Coupon $coupon *\/",423],["T_WHITESPACE","\n        ",423],["T_VARIABLE","$coupon",424],["T_WHITESPACE"," ",424],"=",["T_WHITESPACE"," ",424],["T_STRING","Mage",424],["T_DOUBLE_COLON","::",424],["T_STRING","getModel",424],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/coupon'",424],")",";",["T_WHITESPACE","\n        ",424],["T_VARIABLE","$coupon",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","setRule",425],"(",["T_VARIABLE","$this",425],")",["T_WHITESPACE","\n            ",425],["T_OBJECT_OPERATOR","->",426],["T_STRING","setIsPrimary",426],"(",["T_STRING","false",426],")",["T_WHITESPACE","\n            ",426],["T_OBJECT_OPERATOR","->",427],["T_STRING","setUsageLimit",427],"(",["T_VARIABLE","$this",427],["T_OBJECT_OPERATOR","->",427],["T_STRING","getUsesPerCoupon",427],"(",")",["T_WHITESPACE"," ",427],"?",["T_WHITESPACE"," ",427],["T_VARIABLE","$this",427],["T_OBJECT_OPERATOR","->",427],["T_STRING","getUsesPerCoupon",427],"(",")",["T_WHITESPACE"," ",427],":",["T_WHITESPACE"," ",427],["T_STRING","null",427],")",["T_WHITESPACE","\n            ",427],["T_OBJECT_OPERATOR","->",428],["T_STRING","setUsagePerCustomer",428],"(",["T_VARIABLE","$this",428],["T_OBJECT_OPERATOR","->",428],["T_STRING","getUsesPerCustomer",428],"(",")",["T_WHITESPACE"," ",428],"?",["T_WHITESPACE"," ",428],["T_VARIABLE","$this",428],["T_OBJECT_OPERATOR","->",428],["T_STRING","getUsesPerCustomer",428],"(",")",["T_WHITESPACE"," ",428],":",["T_WHITESPACE"," ",428],["T_STRING","null",428],")",["T_WHITESPACE","\n            ",428],["T_OBJECT_OPERATOR","->",429],["T_STRING","setExpirationDate",429],"(",["T_VARIABLE","$this",429],["T_OBJECT_OPERATOR","->",429],["T_STRING","getToDate",429],"(",")",")",";",["T_WHITESPACE","\n\n        ",429],["T_VARIABLE","$couponCode",431],["T_WHITESPACE"," ",431],"=",["T_WHITESPACE"," ",431],["T_STRING","self",431],["T_DOUBLE_COLON","::",431],["T_STRING","getCouponCodeGenerator",431],"(",")",["T_OBJECT_OPERATOR","->",431],["T_STRING","generateCode",431],"(",")",";",["T_WHITESPACE","\n        ",431],["T_VARIABLE","$coupon",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","setCode",432],"(",["T_VARIABLE","$couponCode",432],")",";",["T_WHITESPACE","\n\n        ",432],["T_VARIABLE","$ok",434],["T_WHITESPACE"," ",434],"=",["T_WHITESPACE"," ",434],["T_STRING","false",434],";",["T_WHITESPACE","\n        ",434],["T_IF","if",435],["T_WHITESPACE"," ",435],"(","!",["T_VARIABLE","$saveNewlyCreated",435],")",["T_WHITESPACE"," ",435],"{",["T_WHITESPACE","\n            ",435],["T_VARIABLE","$ok",436],["T_WHITESPACE"," ",436],"=",["T_WHITESPACE"," ",436],["T_STRING","true",436],";",["T_WHITESPACE","\n        ",436],"}",["T_WHITESPACE"," ",437],["T_ELSE","else",437],["T_WHITESPACE"," ",437],["T_IF","if",437],["T_WHITESPACE"," ",437],"(",["T_VARIABLE","$this",437],["T_OBJECT_OPERATOR","->",437],["T_STRING","getId",437],"(",")",")",["T_WHITESPACE"," ",437],"{",["T_WHITESPACE","\n            ",437],["T_FOR","for",438],["T_WHITESPACE"," ",438],"(",["T_VARIABLE","$attemptNum",438],["T_WHITESPACE"," ",438],"=",["T_WHITESPACE"," ",438],["T_LNUMBER","0",438],";",["T_WHITESPACE"," ",438],["T_VARIABLE","$attemptNum",438],["T_WHITESPACE"," ",438],"<",["T_WHITESPACE"," ",438],["T_VARIABLE","$saveAttemptCount",438],";",["T_WHITESPACE"," ",438],["T_VARIABLE","$attemptNum",438],["T_INC","++",438],")",["T_WHITESPACE"," ",438],"{",["T_WHITESPACE","\n                ",438],["T_TRY","try",439],["T_WHITESPACE"," ",439],"{",["T_WHITESPACE","\n                    ",439],["T_VARIABLE","$coupon",440],["T_OBJECT_OPERATOR","->",440],["T_STRING","save",440],"(",")",";",["T_WHITESPACE","\n                ",440],"}",["T_WHITESPACE"," ",441],["T_CATCH","catch",441],["T_WHITESPACE"," ",441],"(",["T_STRING","Exception",441],["T_WHITESPACE"," ",441],["T_VARIABLE","$e",441],")",["T_WHITESPACE"," ",441],"{",["T_WHITESPACE","\n                    ",441],["T_IF","if",442],["T_WHITESPACE"," ",442],"(",["T_VARIABLE","$e",442],["T_WHITESPACE"," ",442],["T_INSTANCEOF","instanceof",442],["T_WHITESPACE"," ",442],["T_STRING","Mage_Core_Exception",442],["T_WHITESPACE"," ",442],["T_BOOLEAN_OR","||",442],["T_WHITESPACE"," ",442],["T_VARIABLE","$coupon",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","getId",442],"(",")",")",["T_WHITESPACE"," ",442],"{",["T_WHITESPACE","\n                        ",442],["T_THROW","throw",443],["T_WHITESPACE"," ",443],["T_VARIABLE","$e",443],";",["T_WHITESPACE","\n                    ",443],"}",["T_WHITESPACE","\n                    ",444],["T_VARIABLE","$coupon",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","setCode",445],"(",["T_WHITESPACE","\n                        ",445],["T_VARIABLE","$couponCode",446],["T_WHITESPACE"," ",446],".",["T_WHITESPACE","\n                        ",446],["T_STRING","self",447],["T_DOUBLE_COLON","::",447],["T_STRING","getCouponCodeGenerator",447],"(",")",["T_OBJECT_OPERATOR","->",447],["T_STRING","getDelimiter",447],"(",")",["T_WHITESPACE"," ",447],".",["T_WHITESPACE","\n                        ",447],["T_STRING","sprintf",448],"(",["T_CONSTANT_ENCAPSED_STRING","'%04u'",448],",",["T_WHITESPACE"," ",448],["T_STRING","rand",448],"(",["T_LNUMBER","0",448],",",["T_WHITESPACE"," ",448],["T_LNUMBER","9999",448],")",")",["T_WHITESPACE","\n                    ",448],")",";",["T_WHITESPACE","\n                    ",449],["T_CONTINUE","continue",450],";",["T_WHITESPACE","\n                ",450],"}",["T_WHITESPACE","\n                ",451],["T_VARIABLE","$ok",452],["T_WHITESPACE"," ",452],"=",["T_WHITESPACE"," ",452],["T_STRING","true",452],";",["T_WHITESPACE","\n                ",452],["T_BREAK","break",453],";",["T_WHITESPACE","\n            ",453],"}",["T_WHITESPACE","\n        ",454],"}",["T_WHITESPACE","\n        ",455],["T_IF","if",456],["T_WHITESPACE"," ",456],"(","!",["T_VARIABLE","$ok",456],")",["T_WHITESPACE"," ",456],"{",["T_WHITESPACE","\n            ",456],["T_STRING","Mage",457],["T_DOUBLE_COLON","::",457],["T_STRING","throwException",457],"(",["T_STRING","Mage",457],["T_DOUBLE_COLON","::",457],["T_STRING","helper",457],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule'",457],")",["T_OBJECT_OPERATOR","->",457],["T_STRING","__",457],"(",["T_CONSTANT_ENCAPSED_STRING","'Can\\'t acquire coupon.'",457],")",")",";",["T_WHITESPACE","\n        ",457],"}",["T_WHITESPACE","\n\n        ",458],["T_RETURN","return",460],["T_WHITESPACE"," ",460],["T_VARIABLE","$coupon",460],";",["T_WHITESPACE","\n    ",460],"}",["T_WHITESPACE","\n\n    ",461],["T_DOC_COMMENT","\/**\n     * Check cached validation result for specific address\n     *\n     * @param   Mage_Sales_Model_Quote_Address $address\n     * @return  bool\n     *\/",463],["T_WHITESPACE","\n    ",468],["T_PUBLIC","public",469],["T_WHITESPACE"," ",469],["T_FUNCTION","function",469],["T_WHITESPACE"," ",469],["T_STRING","hasIsValidForAddress",469],"(",["T_VARIABLE","$address",469],")",["T_WHITESPACE","\n    ",469],"{",["T_WHITESPACE","\n        ",470],["T_VARIABLE","$addressId",471],["T_WHITESPACE"," ",471],"=",["T_WHITESPACE"," ",471],["T_VARIABLE","$this",471],["T_OBJECT_OPERATOR","->",471],["T_STRING","_getAddressId",471],"(",["T_VARIABLE","$address",471],")",";",["T_WHITESPACE","\n        ",471],["T_RETURN","return",472],["T_WHITESPACE"," ",472],["T_ISSET","isset",472],"(",["T_VARIABLE","$this",472],["T_OBJECT_OPERATOR","->",472],["T_STRING","_validatedAddresses",472],"[",["T_VARIABLE","$addressId",472],"]",")",["T_WHITESPACE"," ",472],"?",["T_WHITESPACE"," ",472],["T_STRING","true",472],["T_WHITESPACE"," ",472],":",["T_WHITESPACE"," ",472],["T_STRING","false",472],";",["T_WHITESPACE","\n    ",472],"}",["T_WHITESPACE","\n\n    ",473],["T_DOC_COMMENT","\/**\n     * Set validation result for specific address to results cache\n     *\n     * @param   Mage_Sales_Model_Quote_Address $address\n     * @param   bool $validationResult\n     * @return  Mage_SalesRule_Model_Rule\n     *\/",475],["T_WHITESPACE","\n    ",481],["T_PUBLIC","public",482],["T_WHITESPACE"," ",482],["T_FUNCTION","function",482],["T_WHITESPACE"," ",482],["T_STRING","setIsValidForAddress",482],"(",["T_VARIABLE","$address",482],",",["T_WHITESPACE"," ",482],["T_VARIABLE","$validationResult",482],")",["T_WHITESPACE","\n    ",482],"{",["T_WHITESPACE","\n        ",483],["T_VARIABLE","$addressId",484],["T_WHITESPACE"," ",484],"=",["T_WHITESPACE"," ",484],["T_VARIABLE","$this",484],["T_OBJECT_OPERATOR","->",484],["T_STRING","_getAddressId",484],"(",["T_VARIABLE","$address",484],")",";",["T_WHITESPACE","\n        ",484],["T_VARIABLE","$this",485],["T_OBJECT_OPERATOR","->",485],["T_STRING","_validatedAddresses",485],"[",["T_VARIABLE","$addressId",485],"]",["T_WHITESPACE"," ",485],"=",["T_WHITESPACE"," ",485],["T_VARIABLE","$validationResult",485],";",["T_WHITESPACE","\n        ",485],["T_RETURN","return",486],["T_WHITESPACE"," ",486],["T_VARIABLE","$this",486],";",["T_WHITESPACE","\n    ",486],"}",["T_WHITESPACE","\n\n    ",487],["T_DOC_COMMENT","\/**\n     * Get cached validation result for specific address\n     *\n     * @param   Mage_Sales_Model_Quote_Address $address\n     * @return  bool\n     *\/",489],["T_WHITESPACE","\n    ",494],["T_PUBLIC","public",495],["T_WHITESPACE"," ",495],["T_FUNCTION","function",495],["T_WHITESPACE"," ",495],["T_STRING","getIsValidForAddress",495],"(",["T_VARIABLE","$address",495],")",["T_WHITESPACE","\n    ",495],"{",["T_WHITESPACE","\n        ",496],["T_VARIABLE","$addressId",497],["T_WHITESPACE"," ",497],"=",["T_WHITESPACE"," ",497],["T_VARIABLE","$this",497],["T_OBJECT_OPERATOR","->",497],["T_STRING","_getAddressId",497],"(",["T_VARIABLE","$address",497],")",";",["T_WHITESPACE","\n        ",497],["T_RETURN","return",498],["T_WHITESPACE"," ",498],["T_ISSET","isset",498],"(",["T_VARIABLE","$this",498],["T_OBJECT_OPERATOR","->",498],["T_STRING","_validatedAddresses",498],"[",["T_VARIABLE","$addressId",498],"]",")",["T_WHITESPACE"," ",498],"?",["T_WHITESPACE"," ",498],["T_VARIABLE","$this",498],["T_OBJECT_OPERATOR","->",498],["T_STRING","_validatedAddresses",498],"[",["T_VARIABLE","$addressId",498],"]",["T_WHITESPACE"," ",498],":",["T_WHITESPACE"," ",498],["T_STRING","false",498],";",["T_WHITESPACE","\n    ",498],"}",["T_WHITESPACE","\n\n    ",499],["T_DOC_COMMENT","\/**\n     * Return id for address\n     *\n     * @param   Mage_Sales_Model_Quote_Address $address\n     * @return  string\n     *\/",501],["T_WHITESPACE","\n    ",506],["T_PRIVATE","private",507],["T_WHITESPACE"," ",507],["T_FUNCTION","function",507],["T_WHITESPACE"," ",507],["T_STRING","_getAddressId",507],"(",["T_VARIABLE","$address",507],")",["T_WHITESPACE"," ",507],"{",["T_WHITESPACE","\n        ",507],["T_IF","if",508],"(",["T_VARIABLE","$address",508],["T_WHITESPACE"," ",508],["T_INSTANCEOF","instanceof",508],["T_WHITESPACE"," ",508],["T_STRING","Mage_Sales_Model_Quote_Address",508],")",["T_WHITESPACE"," ",508],"{",["T_WHITESPACE","\n            ",508],["T_RETURN","return",509],["T_WHITESPACE"," ",509],["T_VARIABLE","$address",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","getId",509],"(",")",";",["T_WHITESPACE","\n        ",509],"}",["T_WHITESPACE","\n        ",510],["T_RETURN","return",511],["T_WHITESPACE"," ",511],["T_VARIABLE","$address",511],";",["T_WHITESPACE","\n    ",511],"}",["T_WHITESPACE","\n\n\n\n\n\n    ",512],["T_DOC_COMMENT","\/**\n     * Collect all product attributes used in serialized rule's action or condition\n     *\n     * @deprecated after 1.6.2.0 use Mage_SalesRule_Model_Resource_Rule::getProductAttributes() instead\n     *\n     * @param string $serializedString\n     *\n     * @return array\n     *\/",518],["T_WHITESPACE","\n    ",526],["T_PROTECTED","protected",527],["T_WHITESPACE"," ",527],["T_FUNCTION","function",527],["T_WHITESPACE"," ",527],["T_STRING","_getUsedAttributes",527],"(",["T_VARIABLE","$serializedString",527],")",["T_WHITESPACE","\n    ",527],"{",["T_WHITESPACE","\n        ",528],["T_RETURN","return",529],["T_WHITESPACE"," ",529],["T_VARIABLE","$this",529],["T_OBJECT_OPERATOR","->",529],["T_STRING","_getResource",529],"(",")",["T_OBJECT_OPERATOR","->",529],["T_STRING","getProductAttributes",529],"(",["T_VARIABLE","$serializedString",529],")",";",["T_WHITESPACE","\n    ",529],"}",["T_WHITESPACE","\n\n    ",530],["T_DOC_COMMENT","\/**\n     * @deprecated after 1.6.2.0\n     *\n     * @param string $format\n     *\n     * @return string\n     *\/",532],["T_WHITESPACE","\n    ",538],["T_PUBLIC","public",539],["T_WHITESPACE"," ",539],["T_FUNCTION","function",539],["T_WHITESPACE"," ",539],["T_STRING","toString",539],"(",["T_VARIABLE","$format",539],"=",["T_CONSTANT_ENCAPSED_STRING","''",539],")",["T_WHITESPACE","\n    ",539],"{",["T_WHITESPACE","\n        ",540],["T_RETURN","return",541],["T_WHITESPACE"," ",541],["T_CONSTANT_ENCAPSED_STRING","''",541],";",["T_WHITESPACE","\n    ",541],"}",["T_WHITESPACE","\n\n    ",542],["T_DOC_COMMENT","\/**\n     * Returns rule as an array for admin interface\n     *\n     * @deprecated after 1.6.2.0\n     *\n     * @param array $arrAttributes\n     *\n     * Output example:\n     * array(\n     *   'name'=>'Example rule',\n     *   'conditions'=>{condition_combine::toArray}\n     *   'actions'=>{action_collection::toArray}\n     * )\n     *\n     * @return array\n     *\/",544],["T_WHITESPACE","\n    ",559],["T_PUBLIC","public",560],["T_WHITESPACE"," ",560],["T_FUNCTION","function",560],["T_WHITESPACE"," ",560],["T_STRING","toArray",560],"(",["T_ARRAY","array",560],["T_WHITESPACE"," ",560],["T_VARIABLE","$arrAttributes",560],["T_WHITESPACE"," ",560],"=",["T_WHITESPACE"," ",560],["T_ARRAY","array",560],"(",")",")",["T_WHITESPACE","\n    ",560],"{",["T_WHITESPACE","\n        ",561],["T_RETURN","return",562],["T_WHITESPACE"," ",562],["T_STRING","parent",562],["T_DOUBLE_COLON","::",562],["T_STRING","toArray",562],"(",["T_VARIABLE","$arrAttributes",562],")",";",["T_WHITESPACE","\n    ",562],"}",["T_WHITESPACE","\n",563],"}",["T_WHITESPACE","\n",564]]