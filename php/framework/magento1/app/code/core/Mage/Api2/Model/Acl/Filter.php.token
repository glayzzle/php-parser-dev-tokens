[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Api2\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * API ACL filter\n *\n * @category   Mage\n * @package    Mage_Api2\n * @author     Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Api2_Model_Acl_Filter",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Attributes allowed for use\n     *\n     * @var array\n     *\/",36],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$_allowedAttributes",41],";",["T_WHITESPACE","\n\n    ",41],["T_DOC_COMMENT","\/**\n     * A list of attributes to be included into output\n     *\n     * @var array\n     *\/",43],["T_WHITESPACE","\n    ",47],["T_PROTECTED","protected",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$_attributesToInclude",48],";",["T_WHITESPACE","\n\n    ",48],["T_DOC_COMMENT","\/**\n     * Associated resource model\n     *\n     * @var Mage_Api2_Model_Resource\n     *\/",50],["T_WHITESPACE","\n    ",54],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$_resource",55],";",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * Object constructor\n     *\n     * @param Mage_Api2_Model_Resource $resource\n     *\/",57],["T_WHITESPACE","\n    ",61],["T_PUBLIC","public",62],["T_WHITESPACE"," ",62],["T_FUNCTION","function",62],["T_WHITESPACE"," ",62],["T_STRING","__construct",62],"(",["T_STRING","Mage_Api2_Model_Resource",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$resource",62],")",["T_WHITESPACE","\n    ",62],"{",["T_WHITESPACE","\n        ",63],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","_resource",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$resource",64],";",["T_WHITESPACE","\n    ",64],"}",["T_WHITESPACE","\n\n    ",65],["T_DOC_COMMENT","\/**\n     * Return only the data which keys are allowed\n     *\n     * @param array $allowedAttributes List of attributes available to use\n     * @param array $data Associative array attribute to value\n     * @return array\n     *\/",67],["T_WHITESPACE","\n    ",73],["T_PROTECTED","protected",74],["T_WHITESPACE"," ",74],["T_FUNCTION","function",74],["T_WHITESPACE"," ",74],["T_STRING","_filter",74],"(",["T_ARRAY","array",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$allowedAttributes",74],",",["T_WHITESPACE"," ",74],["T_ARRAY","array",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$data",74],")",["T_WHITESPACE","\n    ",74],"{",["T_WHITESPACE","\n        ",75],["T_FOREACH","foreach",76],["T_WHITESPACE"," ",76],"(",["T_VARIABLE","$data",76],["T_WHITESPACE"," ",76],["T_AS","as",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$attribute",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$value",76],")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n            ",76],["T_IF","if",77],["T_WHITESPACE"," ",77],"(","!",["T_STRING","in_array",77],"(",["T_VARIABLE","$attribute",77],",",["T_WHITESPACE"," ",77],["T_VARIABLE","$allowedAttributes",77],")",")",["T_WHITESPACE"," ",77],"{",["T_WHITESPACE","\n                ",77],["T_UNSET","unset",78],"(",["T_VARIABLE","$data",78],"[",["T_VARIABLE","$attribute",78],"]",")",";",["T_WHITESPACE","\n            ",78],"}",["T_WHITESPACE","\n        ",79],"}",["T_WHITESPACE","\n        ",80],["T_RETURN","return",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$data",81],";",["T_WHITESPACE","\n    ",81],"}",["T_WHITESPACE","\n\n    ",82],["T_DOC_COMMENT","\/**\n     * Strip attributes in of collection items\n     *\n     * @param array $items\n     * @return array\n     *\/",84],["T_WHITESPACE","\n    ",89],["T_PUBLIC","public",90],["T_WHITESPACE"," ",90],["T_FUNCTION","function",90],["T_WHITESPACE"," ",90],["T_STRING","collectionIn",90],"(",["T_VARIABLE","$items",90],")",["T_WHITESPACE","\n    ",90],"{",["T_WHITESPACE","\n        ",91],["T_FOREACH","foreach",92],["T_WHITESPACE"," ",92],"(",["T_VARIABLE","$items",92],["T_WHITESPACE"," ",92],["T_AS","as",92],["T_WHITESPACE"," ",92],"&",["T_VARIABLE","$data",92],")",["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n            ",92],["T_VARIABLE","$data",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_STRING","is_array",93],"(",["T_VARIABLE","$data",93],")",["T_WHITESPACE"," ",93],"?",["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","in",93],"(",["T_VARIABLE","$data",93],")",["T_WHITESPACE"," ",93],":",["T_WHITESPACE"," ",93],["T_ARRAY","array",93],"(",")",";",["T_WHITESPACE","\n        ",93],"}",["T_WHITESPACE","\n        ",94],["T_RETURN","return",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$items",95],";",["T_WHITESPACE","\n    ",95],"}",["T_WHITESPACE","\n\n    ",96],["T_DOC_COMMENT","\/**\n     * Strip attributes out of collection items\n     *\n     * @param array $items\n     * @return array\n     *\/",98],["T_WHITESPACE","\n    ",103],["T_PUBLIC","public",104],["T_WHITESPACE"," ",104],["T_FUNCTION","function",104],["T_WHITESPACE"," ",104],["T_STRING","collectionOut",104],"(",["T_VARIABLE","$items",104],")",["T_WHITESPACE","\n    ",104],"{",["T_WHITESPACE","\n        ",105],["T_FOREACH","foreach",106],["T_WHITESPACE"," ",106],"(",["T_VARIABLE","$items",106],["T_WHITESPACE"," ",106],["T_AS","as",106],["T_WHITESPACE"," ",106],"&",["T_VARIABLE","$data",106],")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n            ",106],["T_VARIABLE","$data",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","out",107],"(",["T_VARIABLE","$data",107],")",";",["T_WHITESPACE","\n        ",107],"}",["T_WHITESPACE","\n        ",108],["T_RETURN","return",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$items",109],";",["T_WHITESPACE","\n    ",109],"}",["T_WHITESPACE","\n\n    ",110],["T_DOC_COMMENT","\/**\n     * Fetch array of allowed attributes for given resource type, operation and user type.\n     *\n     * @param string $operationType OPTIONAL One of Mage_Api2_Model_Resource::OPERATION_ATTRIBUTE_... constant\n     * @return array\n     *\/",112],["T_WHITESPACE","\n    ",117],["T_PUBLIC","public",118],["T_WHITESPACE"," ",118],["T_FUNCTION","function",118],["T_WHITESPACE"," ",118],["T_STRING","getAllowedAttributes",118],"(",["T_VARIABLE","$operationType",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_STRING","null",118],")",["T_WHITESPACE","\n    ",118],"{",["T_WHITESPACE","\n        ",119],["T_IF","if",120],["T_WHITESPACE"," ",120],"(",["T_STRING","null",120],["T_WHITESPACE"," ",120],["T_IS_IDENTICAL","===",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","_allowedAttributes",120],")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n            ",120],["T_DOC_COMMENT","\/** @var $helper Mage_Api2_Helper_Data *\/",121],["T_WHITESPACE","\n            ",121],["T_VARIABLE","$helper",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_STRING","Mage",122],["T_DOUBLE_COLON","::",122],["T_STRING","helper",122],"(",["T_CONSTANT_ENCAPSED_STRING","'api2\/data'",122],")",";",["T_WHITESPACE","\n\n            ",122],["T_IF","if",124],["T_WHITESPACE"," ",124],"(",["T_STRING","null",124],["T_WHITESPACE"," ",124],["T_IS_IDENTICAL","===",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$operationType",124],")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n                ",124],["T_VARIABLE","$operationType",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_VARIABLE","$helper",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","getTypeOfOperation",125],"(",["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","_resource",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","getOperation",125],"(",")",")",";",["T_WHITESPACE","\n            ",125],"}",["T_WHITESPACE","\n            ",126],["T_IF","if",127],["T_WHITESPACE"," ",127],"(",["T_VARIABLE","$helper",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","isAllAttributesAllowed",127],"(",["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","_resource",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","getUserType",127],"(",")",")",")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n                ",127],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","_allowedAttributes",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_STRING","array_keys",128],"(",["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","_resource",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","getAvailableAttributes",128],"(",["T_WHITESPACE","\n                    ",128],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","_resource",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getUserType",129],"(",")",",",["T_WHITESPACE"," ",129],["T_VARIABLE","$operationType",129],["T_WHITESPACE","\n                ",129],")",")",";",["T_WHITESPACE","\n            ",130],"}",["T_WHITESPACE"," ",131],["T_ELSE","else",131],["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n                ",131],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","_allowedAttributes",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_VARIABLE","$helper",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","getAllowedAttributes",132],"(",["T_WHITESPACE","\n                    ",132],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_resource",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getUserType",133],"(",")",",",["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_resource",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getResourceType",133],"(",")",",",["T_WHITESPACE"," ",133],["T_VARIABLE","$operationType",133],["T_WHITESPACE","\n                ",133],")",";",["T_WHITESPACE","\n            ",134],"}",["T_WHITESPACE","\n            ",135],["T_COMMENT","\/\/ force attributes to be no filtered\n",136],["T_WHITESPACE","            ",137],["T_FOREACH","foreach",137],["T_WHITESPACE"," ",137],"(",["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","_resource",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","getForcedAttributes",137],"(",")",["T_WHITESPACE"," ",137],["T_AS","as",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$forcedAttr",137],")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n                ",137],["T_IF","if",138],["T_WHITESPACE"," ",138],"(","!",["T_STRING","in_array",138],"(",["T_VARIABLE","$forcedAttr",138],",",["T_WHITESPACE"," ",138],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","_allowedAttributes",138],")",")",["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n                    ",138],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","_allowedAttributes",139],"[","]",["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$forcedAttr",139],";",["T_WHITESPACE","\n                ",139],"}",["T_WHITESPACE","\n            ",140],"}",["T_WHITESPACE","\n        ",141],"}",["T_WHITESPACE","\n        ",142],["T_RETURN","return",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","_allowedAttributes",143],";",["T_WHITESPACE","\n    ",143],"}",["T_WHITESPACE","\n\n    ",144],["T_DOC_COMMENT","\/**\n     * Retrieve a list of attributes to be included in output based on available and requested attributes\n     *\n     * @return array\n     *\/",146],["T_WHITESPACE","\n    ",150],["T_PUBLIC","public",151],["T_WHITESPACE"," ",151],["T_FUNCTION","function",151],["T_WHITESPACE"," ",151],["T_STRING","getAttributesToInclude",151],"(",")",["T_WHITESPACE","\n    ",151],"{",["T_WHITESPACE","\n        ",152],["T_IF","if",153],["T_WHITESPACE"," ",153],"(",["T_STRING","null",153],["T_WHITESPACE"," ",153],["T_IS_IDENTICAL","===",153],["T_WHITESPACE"," ",153],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","_attributesToInclude",153],")",["T_WHITESPACE"," ",153],"{",["T_WHITESPACE","\n            ",153],["T_VARIABLE","$allowedAttrs",154],["T_WHITESPACE","   ",154],"=",["T_WHITESPACE"," ",154],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","getAllowedAttributes",154],"(",["T_STRING","Mage_Api2_Model_Resource",154],["T_DOUBLE_COLON","::",154],["T_STRING","OPERATION_ATTRIBUTE_READ",154],")",";",["T_WHITESPACE","\n            ",154],["T_VARIABLE","$requestedAttrs",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","_resource",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","getRequest",155],"(",")",["T_OBJECT_OPERATOR","->",155],["T_STRING","getRequestedAttributes",155],"(",")",";",["T_WHITESPACE","\n\n            ",155],["T_IF","if",157],["T_WHITESPACE"," ",157],"(",["T_VARIABLE","$requestedAttrs",157],")",["T_WHITESPACE"," ",157],"{",["T_WHITESPACE","\n                ",157],["T_FOREACH","foreach",158],["T_WHITESPACE"," ",158],"(",["T_VARIABLE","$allowedAttrs",158],["T_WHITESPACE"," ",158],["T_AS","as",158],["T_WHITESPACE"," ",158],["T_VARIABLE","$allowedAttr",158],")",["T_WHITESPACE"," ",158],"{",["T_WHITESPACE","\n                    ",158],["T_IF","if",159],["T_WHITESPACE"," ",159],"(",["T_STRING","in_array",159],"(",["T_VARIABLE","$allowedAttr",159],",",["T_WHITESPACE"," ",159],["T_VARIABLE","$requestedAttrs",159],")",")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n                        ",159],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","_attributesToInclude",160],"[","]",["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_VARIABLE","$allowedAttr",160],";",["T_WHITESPACE","\n                    ",160],"}",["T_WHITESPACE","\n                ",161],"}",["T_WHITESPACE","\n            ",162],"}",["T_WHITESPACE"," ",163],["T_ELSE","else",163],["T_WHITESPACE"," ",163],"{",["T_WHITESPACE","\n                ",163],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","_attributesToInclude",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_VARIABLE","$allowedAttrs",164],";",["T_WHITESPACE","\n            ",164],"}",["T_WHITESPACE","\n        ",165],"}",["T_WHITESPACE","\n        ",166],["T_RETURN","return",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","_attributesToInclude",167],";",["T_WHITESPACE","\n    ",167],"}",["T_WHITESPACE","\n\n    ",168],["T_DOC_COMMENT","\/**\n     * Filter data for write operations\n     *\n     * @param array $requestData\n     * @return array\n     *\/",170],["T_WHITESPACE","\n    ",175],["T_PUBLIC","public",176],["T_WHITESPACE"," ",176],["T_FUNCTION","function",176],["T_WHITESPACE"," ",176],["T_STRING","in",176],"(",["T_ARRAY","array",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$requestData",176],")",["T_WHITESPACE","\n    ",176],"{",["T_WHITESPACE","\n        ",177],["T_VARIABLE","$allowedAttributes",178],["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","getAllowedAttributes",178],"(",["T_STRING","Mage_Api2_Model_Resource",178],["T_DOUBLE_COLON","::",178],["T_STRING","OPERATION_ATTRIBUTE_WRITE",178],")",";",["T_WHITESPACE","\n\n        ",178],["T_RETURN","return",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","_filter",180],"(",["T_VARIABLE","$allowedAttributes",180],",",["T_WHITESPACE"," ",180],["T_VARIABLE","$requestData",180],")",";",["T_WHITESPACE","\n    ",180],"}",["T_WHITESPACE","\n\n    ",181],["T_DOC_COMMENT","\/**\n     * Filter data before output\n     *\n     * @param array $retrievedData\n     * @return array\n     *\/",183],["T_WHITESPACE","\n    ",188],["T_PUBLIC","public",189],["T_WHITESPACE"," ",189],["T_FUNCTION","function",189],["T_WHITESPACE"," ",189],["T_STRING","out",189],"(",["T_ARRAY","array",189],["T_WHITESPACE"," ",189],["T_VARIABLE","$retrievedData",189],")",["T_WHITESPACE","\n    ",189],"{",["T_WHITESPACE","\n        ",190],["T_RETURN","return",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","_filter",191],"(",["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","getAttributesToInclude",191],"(",")",",",["T_WHITESPACE"," ",191],["T_VARIABLE","$retrievedData",191],")",";",["T_WHITESPACE","\n    ",191],"}",["T_WHITESPACE","\n",192],"}",["T_WHITESPACE","\n",193]]