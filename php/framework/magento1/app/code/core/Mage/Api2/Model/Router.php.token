[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Api2\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Webservice api2 router model\n *\n * @category   Mage\n * @package    Mage_Api2\n * @author     Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Api2_Model_Router",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Routes which are stored in module config files api2.xml\n     *\n     * @var array\n     *\/",36],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$_routes",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_ARRAY","array",41],"(",")",";",["T_WHITESPACE","\n\n    ",41],["T_DOC_COMMENT","\/**\n     * Set routes\n     *\n     * @param array $routes\n     * @return Mage_Api2_Model_Router\n     *\/",43],["T_WHITESPACE","\n    ",48],["T_PUBLIC","public",49],["T_WHITESPACE"," ",49],["T_FUNCTION","function",49],["T_WHITESPACE"," ",49],["T_STRING","setRoutes",49],"(",["T_ARRAY","array",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$routes",49],")",["T_WHITESPACE","\n    ",49],"{",["T_WHITESPACE","\n        ",50],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","_routes",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$routes",51],";",["T_WHITESPACE","\n\n        ",51],["T_RETURN","return",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$this",53],";",["T_WHITESPACE","\n    ",53],"}",["T_WHITESPACE","\n\n    ",54],["T_DOC_COMMENT","\/**\n     * Get routes\n     *\n     * @return array\n     *\/",56],["T_WHITESPACE","\n    ",60],["T_PUBLIC","public",61],["T_WHITESPACE"," ",61],["T_FUNCTION","function",61],["T_WHITESPACE"," ",61],["T_STRING","getRoutes",61],"(",")",["T_WHITESPACE","\n    ",61],"{",["T_WHITESPACE","\n        ",62],["T_RETURN","return",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","_routes",63],";",["T_WHITESPACE","\n    ",63],"}",["T_WHITESPACE","\n\n    ",64],["T_DOC_COMMENT","\/**\n     * Route the Request, the only responsibility of the class\n     * Find route that match current URL, set parameters of the route to Request object\n     *\n     * @param Mage_Api2_Model_Request $request\n     * @return Mage_Api2_Model_Request\n     * @throws Mage_Api2_Exception\n     *\/",66],["T_WHITESPACE","\n    ",73],["T_PUBLIC","public",74],["T_WHITESPACE"," ",74],["T_FUNCTION","function",74],["T_WHITESPACE"," ",74],["T_STRING","route",74],"(",["T_STRING","Mage_Api2_Model_Request",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$request",74],")",["T_WHITESPACE","\n    ",74],"{",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$isMatched",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_STRING","false",76],";",["T_WHITESPACE","\n\n        ",76],["T_DOC_COMMENT","\/** @var $route Mage_Api2_Model_Route_Interface *\/",78],["T_WHITESPACE","\n        ",78],["T_FOREACH","foreach",79],["T_WHITESPACE"," ",79],"(",["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","getRoutes",79],"(",")",["T_WHITESPACE"," ",79],["T_AS","as",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$route",79],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n            ",79],["T_IF","if",80],["T_WHITESPACE"," ",80],"(",["T_VARIABLE","$params",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$route",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","match",80],"(",["T_VARIABLE","$request",80],")",")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n                ",80],["T_VARIABLE","$request",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","setParams",81],"(",["T_VARIABLE","$params",81],")",";",["T_WHITESPACE","\n                ",81],["T_VARIABLE","$isMatched",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_STRING","true",82],";",["T_WHITESPACE","\n                ",82],["T_BREAK","break",83],";",["T_WHITESPACE","\n            ",83],"}",["T_WHITESPACE","\n        ",84],"}",["T_WHITESPACE","\n        ",85],["T_IF","if",86],["T_WHITESPACE"," ",86],"(","!",["T_VARIABLE","$isMatched",86],")",["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n            ",86],["T_THROW","throw",87],["T_WHITESPACE"," ",87],["T_NEW","new",87],["T_WHITESPACE"," ",87],["T_STRING","Mage_Api2_Exception",87],"(",["T_CONSTANT_ENCAPSED_STRING","'Request does not match any route.'",87],",",["T_WHITESPACE"," ",87],["T_STRING","Mage_Api2_Model_Server",87],["T_DOUBLE_COLON","::",87],["T_STRING","HTTP_NOT_FOUND",87],")",";",["T_WHITESPACE","\n        ",87],"}",["T_WHITESPACE","\n        ",88],["T_IF","if",89],["T_WHITESPACE"," ",89],"(","!",["T_VARIABLE","$request",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getResourceType",89],"(",")",["T_WHITESPACE"," ",89],["T_BOOLEAN_OR","||",89],["T_WHITESPACE"," ",89],"!",["T_VARIABLE","$request",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getModel",89],"(",")",")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n            ",89],["T_THROW","throw",90],["T_WHITESPACE"," ",90],["T_NEW","new",90],["T_WHITESPACE"," ",90],["T_STRING","Mage_Api2_Exception",90],"(",["T_CONSTANT_ENCAPSED_STRING","'Matched resource is not properly set.'",90],",",["T_WHITESPACE","\n                ",90],["T_STRING","Mage_Api2_Model_Server",91],["T_DOUBLE_COLON","::",91],["T_STRING","HTTP_INTERNAL_ERROR",91],")",";",["T_WHITESPACE","\n        ",91],"}",["T_WHITESPACE","\n        ",92],["T_RETURN","return",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$request",93],";",["T_WHITESPACE","\n    ",93],"}",["T_WHITESPACE","\n\n    ",94],["T_DOC_COMMENT","\/**\n     * Set API type to request as a result of one pass route\n     *\n     * @param Mage_Api2_Model_Request $request\n     * @param boolean $trimApiTypePath OPTIONAL If TRUE - \/api\/:api_type part of request path info will be trimmed\n     * @return Mage_Api2_Model_Router\n     * @throws Mage_Api2_Exception\n     *\/",96],["T_WHITESPACE","\n    ",103],["T_PUBLIC","public",104],["T_WHITESPACE"," ",104],["T_FUNCTION","function",104],["T_WHITESPACE"," ",104],["T_STRING","routeApiType",104],"(",["T_STRING","Mage_Api2_Model_Request",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$request",104],",",["T_WHITESPACE"," ",104],["T_VARIABLE","$trimApiTypePath",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_STRING","true",104],")",["T_WHITESPACE","\n    ",104],"{",["T_WHITESPACE","\n        ",105],["T_DOC_COMMENT","\/** @var $apiTypeRoute Mage_Api2_Model_Route_ApiType *\/",106],["T_WHITESPACE","\n        ",106],["T_VARIABLE","$apiTypeRoute",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_STRING","Mage",107],["T_DOUBLE_COLON","::",107],["T_STRING","getModel",107],"(",["T_CONSTANT_ENCAPSED_STRING","'api2\/route_apiType'",107],")",";",["T_WHITESPACE","\n\n        ",107],["T_IF","if",109],["T_WHITESPACE"," ",109],"(","!","(",["T_VARIABLE","$apiTypeMatch",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$apiTypeRoute",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","match",109],"(",["T_VARIABLE","$request",109],",",["T_WHITESPACE"," ",109],["T_STRING","true",109],")",")",")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n            ",109],["T_THROW","throw",110],["T_WHITESPACE"," ",110],["T_NEW","new",110],["T_WHITESPACE"," ",110],["T_STRING","Mage_Api2_Exception",110],"(",["T_CONSTANT_ENCAPSED_STRING","'Request does not match type route.'",110],",",["T_WHITESPACE"," ",110],["T_STRING","Mage_Api2_Model_Server",110],["T_DOUBLE_COLON","::",110],["T_STRING","HTTP_NOT_FOUND",110],")",";",["T_WHITESPACE","\n        ",110],"}",["T_WHITESPACE","\n        ",111],["T_COMMENT","\/\/ Trim matched URI path for next routes\n",112],["T_WHITESPACE","        ",113],["T_IF","if",113],["T_WHITESPACE"," ",113],"(",["T_VARIABLE","$trimApiTypePath",113],")",["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n            ",113],["T_VARIABLE","$matchedPathLength",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_STRING","strlen",114],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",114],["T_WHITESPACE"," ",114],".",["T_WHITESPACE"," ",114],["T_STRING","ltrim",114],"(",["T_VARIABLE","$apiTypeRoute",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","getMatchedPath",114],"(",")",",",["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","'\/'",114],")",")",";",["T_WHITESPACE","\n\n            ",114],["T_VARIABLE","$request",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","setPathInfo",116],"(",["T_STRING","substr",116],"(",["T_VARIABLE","$request",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getPathInfo",116],"(",")",",",["T_WHITESPACE"," ",116],["T_VARIABLE","$matchedPathLength",116],")",")",";",["T_WHITESPACE","\n        ",116],"}",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$request",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","setParam",118],"(",["T_CONSTANT_ENCAPSED_STRING","'api_type'",118],",",["T_WHITESPACE"," ",118],["T_VARIABLE","$apiTypeMatch",118],"[",["T_CONSTANT_ENCAPSED_STRING","'api_type'",118],"]",")",";",["T_WHITESPACE","\n\n        ",118],["T_RETURN","return",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],";",["T_WHITESPACE","\n    ",120],"}",["T_WHITESPACE","\n",121],"}",["T_WHITESPACE","\n",122]]