[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Api2\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Webservice api2 dispatcher model\n *\n * @category   Mage\n * @package    Mage_Api2\n * @author     Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Api2_Model_Dispatcher",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Template for retrieve resource class name\n     *\/",36],["T_WHITESPACE","\n    ",38],["T_CONST","const",39],["T_WHITESPACE"," ",39],["T_STRING","RESOURCE_CLASS_TEMPLATE",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","':resource_:api_:user_v:version'",39],";",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * API User object\n     *\n     * @var Mage_Api2_Model_Auth_User_Abstract\n     *\/",41],["T_WHITESPACE","\n    ",45],["T_PROTECTED","protected",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$_apiUser",46],";",["T_WHITESPACE","\n\n    ",46],["T_DOC_COMMENT","\/**\n     * Instantiate resource class, set parameters to the instance, run resource internal dispatch method\n     *\n     * @param Mage_Api2_Model_Request $request\n     * @param Mage_Api2_Model_Response $response\n     * @return Mage_Api2_Model_Dispatcher\n     * @throws Mage_Api2_Exception\n     *\/",48],["T_WHITESPACE","\n    ",55],["T_PUBLIC","public",56],["T_WHITESPACE"," ",56],["T_FUNCTION","function",56],["T_WHITESPACE"," ",56],["T_STRING","dispatch",56],"(",["T_STRING","Mage_Api2_Model_Request",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$request",56],",",["T_WHITESPACE"," ",56],["T_STRING","Mage_Api2_Model_Response",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$response",56],")",["T_WHITESPACE","\n    ",56],"{",["T_WHITESPACE","\n        ",57],["T_IF","if",58],["T_WHITESPACE"," ",58],"(","!",["T_VARIABLE","$request",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","getModel",58],"(",")",["T_WHITESPACE"," ",58],["T_BOOLEAN_OR","||",58],["T_WHITESPACE"," ",58],"!",["T_VARIABLE","$request",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","getApiType",58],"(",")",")",["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n            ",58],["T_THROW","throw",59],["T_WHITESPACE"," ",59],["T_NEW","new",59],["T_WHITESPACE"," ",59],["T_STRING","Mage_Api2_Exception",59],"(",["T_WHITESPACE","\n                ",59],["T_CONSTANT_ENCAPSED_STRING","'Request does not contains all necessary data'",60],",",["T_WHITESPACE"," ",60],["T_STRING","Mage_Api2_Model_Server",60],["T_DOUBLE_COLON","::",60],["T_STRING","HTTP_BAD_REQUEST",60],["T_WHITESPACE","\n            ",60],")",";",["T_WHITESPACE","\n        ",61],"}",["T_WHITESPACE","\n        ",62],["T_VARIABLE","$model",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_STRING","self",63],["T_DOUBLE_COLON","::",63],["T_STRING","loadResourceModel",63],"(",["T_WHITESPACE","\n            ",63],["T_VARIABLE","$request",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","getModel",64],"(",")",",",["T_WHITESPACE","\n            ",64],["T_VARIABLE","$request",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getApiType",65],"(",")",",",["T_WHITESPACE","\n            ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getApiUser",66],"(",")",["T_OBJECT_OPERATOR","->",66],["T_STRING","getType",66],"(",")",",",["T_WHITESPACE","\n            ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getVersion",67],"(",["T_VARIABLE","$request",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getResourceType",67],"(",")",",",["T_WHITESPACE"," ",67],["T_VARIABLE","$request",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getVersion",67],"(",")",")",["T_WHITESPACE","\n        ",67],")",";",["T_WHITESPACE","\n\n        ",68],["T_VARIABLE","$model",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","setRequest",70],"(",["T_VARIABLE","$request",70],")",";",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$model",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","setResponse",71],"(",["T_VARIABLE","$response",71],")",";",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$model",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","setApiUser",72],"(",["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","getApiUser",72],"(",")",")",";",["T_WHITESPACE","\n\n        ",72],["T_VARIABLE","$model",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","dispatch",74],"(",")",";",["T_WHITESPACE","\n\n        ",74],["T_RETURN","return",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],";",["T_WHITESPACE","\n    ",76],"}",["T_WHITESPACE","\n\n    ",77],["T_DOC_COMMENT","\/**\n     * Pack resource model class path from components and try to load it\n     *\n     * @param string $apiType API type\n     * @param string $userType API User type (e.g. admin, customer, guest)\n     * @param int $version Requested version\n     * @return Mage_Api2_Model_Resource\n     * @throws Mage_Api2_Exception\n     *\/",79],["T_WHITESPACE","\n    ",87],["T_PUBLIC","public",88],["T_WHITESPACE"," ",88],["T_STATIC","static",88],["T_WHITESPACE"," ",88],["T_FUNCTION","function",88],["T_WHITESPACE"," ",88],["T_STRING","loadResourceModel",88],"(",["T_VARIABLE","$model",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$apiType",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$userType",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$version",88],")",["T_WHITESPACE","\n    ",88],"{",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$class",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_STRING","strtr",90],"(",["T_WHITESPACE","\n            ",90],["T_STRING","self",91],["T_DOUBLE_COLON","::",91],["T_STRING","RESOURCE_CLASS_TEMPLATE",91],",",["T_WHITESPACE","\n            ",91],["T_ARRAY","array",92],"(",["T_CONSTANT_ENCAPSED_STRING","':resource'",92],["T_WHITESPACE"," ",92],["T_DOUBLE_ARROW","=>",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$model",92],",",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","':api'",92],["T_WHITESPACE"," ",92],["T_DOUBLE_ARROW","=>",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$apiType",92],",",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","':user'",92],["T_WHITESPACE"," ",92],["T_DOUBLE_ARROW","=>",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$userType",92],",",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","':version'",92],["T_WHITESPACE"," ",92],["T_DOUBLE_ARROW","=>",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$version",92],")",["T_WHITESPACE","\n        ",92],")",";",["T_WHITESPACE","\n\n        ",93],["T_TRY","try",95],["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n            ",95],["T_DOC_COMMENT","\/** @var $modelObj Mage_Api2_Model_Resource *\/",96],["T_WHITESPACE","\n            ",96],["T_VARIABLE","$modelObj",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_STRING","Mage",97],["T_DOUBLE_COLON","::",97],["T_STRING","getModel",97],"(",["T_VARIABLE","$class",97],")",";",["T_WHITESPACE","\n        ",97],"}",["T_WHITESPACE"," ",98],["T_CATCH","catch",98],["T_WHITESPACE"," ",98],"(",["T_STRING","Exception",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$e",98],")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n            ",98],["T_COMMENT","\/\/ getModel() throws exception when in application is in development mode - skip it to next check\n",99],["T_WHITESPACE","        ",100],"}",["T_WHITESPACE","\n        ",100],["T_IF","if",101],["T_WHITESPACE"," ",101],"(",["T_EMPTY","empty",101],"(",["T_VARIABLE","$modelObj",101],")",["T_WHITESPACE"," ",101],["T_BOOLEAN_OR","||",101],["T_WHITESPACE"," ",101],"!",["T_VARIABLE","$modelObj",101],["T_WHITESPACE"," ",101],["T_INSTANCEOF","instanceof",101],["T_WHITESPACE"," ",101],["T_STRING","Mage_Api2_Model_Resource",101],")",["T_WHITESPACE"," ",101],"{",["T_WHITESPACE","\n            ",101],["T_THROW","throw",102],["T_WHITESPACE"," ",102],["T_NEW","new",102],["T_WHITESPACE"," ",102],["T_STRING","Mage_Api2_Exception",102],"(",["T_CONSTANT_ENCAPSED_STRING","'Resource not found'",102],",",["T_WHITESPACE"," ",102],["T_STRING","Mage_Api2_Model_Server",102],["T_DOUBLE_COLON","::",102],["T_STRING","HTTP_NOT_FOUND",102],")",";",["T_WHITESPACE","\n        ",102],"}",["T_WHITESPACE","\n        ",103],["T_RETURN","return",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$modelObj",104],";",["T_WHITESPACE","\n    ",104],"}",["T_WHITESPACE","\n\n    ",105],["T_DOC_COMMENT","\/**\n     * Set API user object\n     *\n     * @param Mage_Api2_Model_Auth_User_Abstract $apiUser\n     * @return Mage_Api2_Model_Dispatcher\n     *\/",107],["T_WHITESPACE","\n    ",112],["T_PUBLIC","public",113],["T_WHITESPACE"," ",113],["T_FUNCTION","function",113],["T_WHITESPACE"," ",113],["T_STRING","setApiUser",113],"(",["T_STRING","Mage_Api2_Model_Auth_User_Abstract",113],["T_WHITESPACE"," ",113],["T_VARIABLE","$apiUser",113],")",["T_WHITESPACE","\n    ",113],"{",["T_WHITESPACE","\n        ",114],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","_apiUser",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$apiUser",115],";",["T_WHITESPACE","\n\n        ",115],["T_RETURN","return",117],["T_WHITESPACE"," ",117],["T_VARIABLE","$this",117],";",["T_WHITESPACE","\n    ",117],"}",["T_WHITESPACE","\n\n    ",118],["T_DOC_COMMENT","\/**\n     * Get API user object\n     *\n     * @return Mage_Api2_Model_Auth_User_Abstract\n     *\/",120],["T_WHITESPACE","\n    ",124],["T_PUBLIC","public",125],["T_WHITESPACE"," ",125],["T_FUNCTION","function",125],["T_WHITESPACE"," ",125],["T_STRING","getApiUser",125],"(",")",["T_WHITESPACE","\n    ",125],"{",["T_WHITESPACE","\n        ",126],["T_IF","if",127],["T_WHITESPACE"," ",127],"(","!",["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","_apiUser",127],")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n            ",127],["T_THROW","throw",128],["T_WHITESPACE"," ",128],["T_NEW","new",128],["T_WHITESPACE"," ",128],["T_STRING","Exception",128],"(",["T_CONSTANT_ENCAPSED_STRING","'API user is not set.'",128],")",";",["T_WHITESPACE","\n        ",128],"}",["T_WHITESPACE","\n\n        ",129],["T_RETURN","return",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","_apiUser",131],";",["T_WHITESPACE","\n    ",131],"}",["T_WHITESPACE","\n\n    ",132],["T_DOC_COMMENT","\/**\n     * Get correct version of the resource model\n     *\n     * @param string $resourceType\n     * @param string|bool $requestedVersion\n     * @return int\n     * @throws Mage_Api2_Exception\n     *\/",134],["T_WHITESPACE","\n    ",141],["T_PUBLIC","public",142],["T_WHITESPACE"," ",142],["T_FUNCTION","function",142],["T_WHITESPACE"," ",142],["T_STRING","getVersion",142],"(",["T_VARIABLE","$resourceType",142],",",["T_WHITESPACE"," ",142],["T_VARIABLE","$requestedVersion",142],")",["T_WHITESPACE","\n    ",142],"{",["T_WHITESPACE","\n        ",143],["T_IF","if",144],["T_WHITESPACE"," ",144],"(",["T_STRING","false",144],["T_WHITESPACE"," ",144],["T_IS_NOT_IDENTICAL","!==",144],["T_WHITESPACE"," ",144],["T_VARIABLE","$requestedVersion",144],["T_WHITESPACE"," ",144],["T_BOOLEAN_AND","&&",144],["T_WHITESPACE"," ",144],"!",["T_STRING","preg_match",144],"(",["T_CONSTANT_ENCAPSED_STRING","'\/^[1-9]\\d*$\/'",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$requestedVersion",144],")",")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n            ",144],["T_THROW","throw",145],["T_WHITESPACE"," ",145],["T_NEW","new",145],["T_WHITESPACE"," ",145],["T_STRING","Mage_Api2_Exception",145],"(",["T_WHITESPACE","\n                ",145],["T_STRING","sprintf",146],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid version \"%s\" requested.'",146],",",["T_WHITESPACE"," ",146],["T_STRING","htmlspecialchars",146],"(",["T_VARIABLE","$requestedVersion",146],")",")",",",["T_WHITESPACE","\n                ",146],["T_STRING","Mage_Api2_Model_Server",147],["T_DOUBLE_COLON","::",147],["T_STRING","HTTP_BAD_REQUEST",147],["T_WHITESPACE","\n            ",147],")",";",["T_WHITESPACE","\n        ",148],"}",["T_WHITESPACE","\n        ",149],["T_RETURN","return",150],["T_WHITESPACE"," ",150],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","getConfig",150],"(",")",["T_OBJECT_OPERATOR","->",150],["T_STRING","getResourceLastVersion",150],"(",["T_VARIABLE","$resourceType",150],",",["T_WHITESPACE"," ",150],["T_VARIABLE","$requestedVersion",150],")",";",["T_WHITESPACE","\n    ",150],"}",["T_WHITESPACE","\n\n    ",151],["T_DOC_COMMENT","\/**\n     * Get config\n     *\n     * @return Mage_Api2_Model_Config\n     *\/",153],["T_WHITESPACE","\n    ",157],["T_PUBLIC","public",158],["T_WHITESPACE"," ",158],["T_FUNCTION","function",158],["T_WHITESPACE"," ",158],["T_STRING","getConfig",158],"(",")",["T_WHITESPACE","\n    ",158],"{",["T_WHITESPACE","\n        ",159],["T_RETURN","return",160],["T_WHITESPACE"," ",160],["T_STRING","Mage",160],["T_DOUBLE_COLON","::",160],["T_STRING","getModel",160],"(",["T_CONSTANT_ENCAPSED_STRING","'api2\/config'",160],")",";",["T_WHITESPACE","\n    ",160],"}",["T_WHITESPACE","\n",161],"}",["T_WHITESPACE","\n",162]]