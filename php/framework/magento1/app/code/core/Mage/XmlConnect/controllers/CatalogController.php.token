[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_XmlConnect\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * XmlConnect catalog controller\n *\n * @category    Mage\n * @package     Mage_XmlConnect\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_XmlConnect_CatalogController",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_XmlConnect_Controller_Action",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Category list\n     *\n     * @return null\n     *\/",36],["T_WHITESPACE","\n    ",40],["T_PUBLIC","public",41],["T_WHITESPACE"," ",41],["T_FUNCTION","function",41],["T_WHITESPACE"," ",41],["T_STRING","categoryAction",41],"(",")",["T_WHITESPACE","\n    ",41],"{",["T_WHITESPACE","\n        ",42],["T_IF","if",43],["T_WHITESPACE"," ",43],"(",["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","_checkApiForward",43],"(",["T_CONSTANT_ENCAPSED_STRING","'categoryDetails'",43],",",["T_WHITESPACE"," ",43],["T_STRING","Mage_XmlConnect_Helper_Data",43],["T_DOUBLE_COLON","::",43],["T_STRING","DEVICE_API_V_23",43],")",")",["T_WHITESPACE"," ",43],"{",["T_WHITESPACE","\n            ",43],["T_RETURN","return",44],";",["T_WHITESPACE","\n        ",44],"}",["T_WHITESPACE","\n        ",45],["T_TRY","try",46],["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n            ",46],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","loadLayout",47],"(",["T_STRING","false",47],")",";",["T_WHITESPACE","\n            ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","renderLayout",48],"(",")",";",["T_WHITESPACE","\n        ",48],"}",["T_WHITESPACE"," ",49],["T_CATCH","catch",49],["T_WHITESPACE"," ",49],"(",["T_STRING","Mage_Core_Exception",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$e",49],")",["T_WHITESPACE"," ",49],"{",["T_WHITESPACE","\n            ",49],["T_STRING","Mage",50],["T_DOUBLE_COLON","::",50],["T_STRING","logException",50],"(",["T_VARIABLE","$e",50],")",";",["T_WHITESPACE","\n            ",50],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","_message",51],"(",["T_VARIABLE","$e",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","getMessage",51],"(",")",",",["T_WHITESPACE"," ",51],["T_STRING","self",51],["T_DOUBLE_COLON","::",51],["T_STRING","MESSAGE_STATUS_ERROR",51],")",";",["T_WHITESPACE","\n        ",51],"}",["T_WHITESPACE"," ",52],["T_CATCH","catch",52],["T_WHITESPACE"," ",52],"(",["T_STRING","Exception",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$e",52],")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n            ",52],["T_STRING","Mage",53],["T_DOUBLE_COLON","::",53],["T_STRING","logException",53],"(",["T_VARIABLE","$e",53],")",";",["T_WHITESPACE","\n            ",53],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","_message",54],"(",["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","__",54],"(",["T_CONSTANT_ENCAPSED_STRING","'An error occurred while loading categories.'",54],")",",",["T_WHITESPACE"," ",54],["T_STRING","self",54],["T_DOUBLE_COLON","::",54],["T_STRING","MESSAGE_STATUS_ERROR",54],")",";",["T_WHITESPACE","\n        ",54],"}",["T_WHITESPACE","\n    ",55],"}",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * Category list details\n     *\n     * @return null\n     *\/",58],["T_WHITESPACE","\n    ",62],["T_PUBLIC","public",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","categoryDetailsAction",63],"(",")",["T_WHITESPACE","\n    ",63],"{",["T_WHITESPACE","\n        ",64],["T_TRY","try",65],["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n            ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","loadLayout",66],"(",["T_STRING","false",66],")",";",["T_WHITESPACE","\n            ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","renderLayout",67],"(",")",";",["T_WHITESPACE","\n        ",67],"}",["T_WHITESPACE"," ",68],["T_CATCH","catch",68],["T_WHITESPACE"," ",68],"(",["T_STRING","Mage_Core_Exception",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$e",68],")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n            ",68],["T_STRING","Mage",69],["T_DOUBLE_COLON","::",69],["T_STRING","logException",69],"(",["T_VARIABLE","$e",69],")",";",["T_WHITESPACE","\n            ",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","_message",70],"(",["T_VARIABLE","$e",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getMessage",70],"(",")",",",["T_WHITESPACE"," ",70],["T_STRING","self",70],["T_DOUBLE_COLON","::",70],["T_STRING","MESSAGE_STATUS_ERROR",70],")",";",["T_WHITESPACE","\n        ",70],"}",["T_WHITESPACE"," ",71],["T_CATCH","catch",71],["T_WHITESPACE"," ",71],"(",["T_STRING","Exception",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$e",71],")",["T_WHITESPACE"," ",71],"{",["T_WHITESPACE","\n            ",71],["T_STRING","Mage",72],["T_DOUBLE_COLON","::",72],["T_STRING","logException",72],"(",["T_VARIABLE","$e",72],")",";",["T_WHITESPACE","\n            ",72],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","_message",73],"(",["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","__",73],"(",["T_CONSTANT_ENCAPSED_STRING","'An error occurred while loading categories.'",73],")",",",["T_WHITESPACE"," ",73],["T_STRING","self",73],["T_DOUBLE_COLON","::",73],["T_STRING","MESSAGE_STATUS_ERROR",73],")",";",["T_WHITESPACE","\n        ",73],"}",["T_WHITESPACE","\n    ",74],"}",["T_WHITESPACE","\n\n    ",75],["T_DOC_COMMENT","\/**\n     * Filter product list\n     *\n     * @return null\n     *\/",77],["T_WHITESPACE","\n    ",81],["T_PUBLIC","public",82],["T_WHITESPACE"," ",82],["T_FUNCTION","function",82],["T_WHITESPACE"," ",82],["T_STRING","filtersAction",82],"(",")",["T_WHITESPACE","\n    ",82],"{",["T_WHITESPACE","\n        ",83],["T_TRY","try",84],["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n            ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","loadLayout",85],"(",["T_STRING","false",85],")",";",["T_WHITESPACE","\n            ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","renderLayout",86],"(",")",";",["T_WHITESPACE","\n        ",86],"}",["T_WHITESPACE"," ",87],["T_CATCH","catch",87],["T_WHITESPACE"," ",87],"(",["T_STRING","Mage_Core_Exception",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$e",87],")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n            ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","_message",88],"(",["T_VARIABLE","$e",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","getMessage",88],"(",")",",",["T_WHITESPACE"," ",88],["T_STRING","self",88],["T_DOUBLE_COLON","::",88],["T_STRING","MESSAGE_STATUS_ERROR",88],")",";",["T_WHITESPACE","\n        ",88],"}",["T_WHITESPACE"," ",89],["T_CATCH","catch",89],["T_WHITESPACE"," ",89],"(",["T_STRING","Exception",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$e",89],")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n            ",89],["T_STRING","Mage",90],["T_DOUBLE_COLON","::",90],["T_STRING","logException",90],"(",["T_VARIABLE","$e",90],")",";",["T_WHITESPACE","\n            ",90],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","_message",91],"(",["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","__",91],"(",["T_CONSTANT_ENCAPSED_STRING","'An error occurred while loading category filters.'",91],")",",",["T_WHITESPACE"," ",91],["T_STRING","self",91],["T_DOUBLE_COLON","::",91],["T_STRING","MESSAGE_STATUS_ERROR",91],")",";",["T_WHITESPACE","\n        ",91],"}",["T_WHITESPACE","\n    ",92],"}",["T_WHITESPACE","\n\n    ",93],["T_DOC_COMMENT","\/**\n     * Product information\n     *\n     * @return null\n     *\/",95],["T_WHITESPACE","\n    ",99],["T_PUBLIC","public",100],["T_WHITESPACE"," ",100],["T_FUNCTION","function",100],["T_WHITESPACE"," ",100],["T_STRING","productAction",100],"(",")",["T_WHITESPACE","\n    ",100],"{",["T_WHITESPACE","\n        ",101],["T_IF","if",102],["T_WHITESPACE"," ",102],"(",["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","_checkApiForward",102],"(",["T_CONSTANT_ENCAPSED_STRING","'productView'",102],",",["T_WHITESPACE"," ",102],["T_STRING","Mage_XmlConnect_Helper_Data",102],["T_DOUBLE_COLON","::",102],["T_STRING","DEVICE_API_V_23",102],")",")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n            ",102],["T_RETURN","return",103],";",["T_WHITESPACE","\n        ",103],"}",["T_WHITESPACE","\n        ",104],["T_TRY","try",105],["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n            ",105],["T_COMMENT","\/\/ Prepare data\n",106],["T_WHITESPACE","            ",107],["T_DOC_COMMENT","\/** @var $productHelper Mage_Catalog_Helper_Product *\/",107],["T_WHITESPACE","\n            ",107],["T_VARIABLE","$productHelper",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_STRING","Mage",108],["T_DOUBLE_COLON","::",108],["T_STRING","helper",108],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",108],")",";",["T_WHITESPACE","\n            ",108],["T_VARIABLE","$productId",109],["T_WHITESPACE","  ",109],"=",["T_WHITESPACE"," ",109],["T_INT_CAST","(int)",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getRequest",109],"(",")",["T_OBJECT_OPERATOR","->",109],["T_STRING","getParam",109],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",109],")",";",["T_WHITESPACE","\n            ",109],["T_VARIABLE","$params",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_NEW","new",110],["T_WHITESPACE"," ",110],["T_STRING","Varien_Object",110],"(",")",";",["T_WHITESPACE","\n            ",110],["T_VARIABLE","$params",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","setCategoryId",111],"(",["T_STRING","false",111],")",";",["T_WHITESPACE","\n\n            ",111],["T_COMMENT","\/\/ Standard algorithm to prepare and render product view page\n",113],["T_WHITESPACE","            ",114],["T_VARIABLE","$product",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_VARIABLE","$productHelper",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","initProduct",114],"(",["T_VARIABLE","$productId",114],",",["T_WHITESPACE"," ",114],["T_VARIABLE","$this",114],",",["T_WHITESPACE"," ",114],["T_VARIABLE","$params",114],")",";",["T_WHITESPACE","\n\n            ",114],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","loadLayout",116],"(",["T_STRING","false",116],")",";",["T_WHITESPACE","\n            ",116],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getLayout",117],"(",")",["T_OBJECT_OPERATOR","->",117],["T_STRING","getBlock",117],"(",["T_CONSTANT_ENCAPSED_STRING","'xmlconnect.catalog.product'",117],")",["T_OBJECT_OPERATOR","->",117],["T_STRING","setProduct",117],"(",["T_VARIABLE","$product",117],")",";",["T_WHITESPACE","\n            ",117],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","renderLayout",118],"(",")",";",["T_WHITESPACE","\n            ",118],["T_RETURN","return",119],";",["T_WHITESPACE","\n        ",119],"}",["T_WHITESPACE"," ",120],["T_CATCH","catch",120],["T_WHITESPACE"," ",120],"(",["T_STRING","Mage_Core_Exception",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$e",120],")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n            ",120],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","_message",121],"(",["T_VARIABLE","$e",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","getMessage",121],"(",")",",",["T_WHITESPACE"," ",121],["T_STRING","self",121],["T_DOUBLE_COLON","::",121],["T_STRING","MESSAGE_STATUS_ERROR",121],")",";",["T_WHITESPACE","\n        ",121],"}",["T_WHITESPACE"," ",122],["T_CATCH","catch",122],["T_WHITESPACE"," ",122],"(",["T_STRING","Exception",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$e",122],")",["T_WHITESPACE"," ",122],"{",["T_WHITESPACE","\n            ",122],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","_message",123],"(",["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","__",123],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to load product info.'",123],")",",",["T_WHITESPACE"," ",123],["T_STRING","self",123],["T_DOUBLE_COLON","::",123],["T_STRING","MESSAGE_STATUS_ERROR",123],")",";",["T_WHITESPACE","\n            ",123],["T_STRING","Mage",124],["T_DOUBLE_COLON","::",124],["T_STRING","logException",124],"(",["T_VARIABLE","$e",124],")",";",["T_WHITESPACE","\n        ",124],"}",["T_WHITESPACE","\n    ",125],"}",["T_WHITESPACE","\n\n    ",126],["T_DOC_COMMENT","\/**\n     * Product view\n     *\n     * @return null\n     *\/",128],["T_WHITESPACE","\n    ",132],["T_PUBLIC","public",133],["T_WHITESPACE"," ",133],["T_FUNCTION","function",133],["T_WHITESPACE"," ",133],["T_STRING","productViewAction",133],"(",")",["T_WHITESPACE","\n    ",133],"{",["T_WHITESPACE","\n        ",134],["T_TRY","try",135],["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n            ",135],["T_COMMENT","\/\/ Prepare data\n",136],["T_WHITESPACE","            ",137],["T_DOC_COMMENT","\/** @var $productHelper Mage_Catalog_Helper_Product *\/",137],["T_WHITESPACE","\n            ",137],["T_VARIABLE","$productHelper",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_STRING","Mage",138],["T_DOUBLE_COLON","::",138],["T_STRING","helper",138],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",138],")",";",["T_WHITESPACE","\n            ",138],["T_VARIABLE","$productId",139],["T_WHITESPACE","  ",139],"=",["T_WHITESPACE"," ",139],["T_INT_CAST","(int)",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getRequest",139],"(",")",["T_OBJECT_OPERATOR","->",139],["T_STRING","getParam",139],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",139],")",";",["T_WHITESPACE","\n            ",139],["T_VARIABLE","$params",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_NEW","new",140],["T_WHITESPACE"," ",140],["T_STRING","Varien_Object",140],"(",")",";",["T_WHITESPACE","\n            ",140],["T_VARIABLE","$params",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","setCategoryId",141],"(",["T_STRING","false",141],")",";",["T_WHITESPACE","\n\n            ",141],["T_COMMENT","\/\/ Standard algorithm to prepare and render product view page\n",143],["T_WHITESPACE","            ",144],["T_VARIABLE","$product",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_VARIABLE","$productHelper",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","initProduct",144],"(",["T_VARIABLE","$productId",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$this",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$params",144],")",";",["T_WHITESPACE","\n\n            ",144],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","loadLayout",146],"(",["T_STRING","false",146],")",";",["T_WHITESPACE","\n            ",146],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","getLayout",147],"(",")",["T_OBJECT_OPERATOR","->",147],["T_STRING","getBlock",147],"(",["T_CONSTANT_ENCAPSED_STRING","'xmlconnect.catalog.product'",147],")",["T_OBJECT_OPERATOR","->",147],["T_STRING","setProduct",147],"(",["T_VARIABLE","$product",147],")",";",["T_WHITESPACE","\n            ",147],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","renderLayout",148],"(",")",";",["T_WHITESPACE","\n            ",148],["T_RETURN","return",149],";",["T_WHITESPACE","\n        ",149],"}",["T_WHITESPACE"," ",150],["T_CATCH","catch",150],["T_WHITESPACE"," ",150],"(",["T_STRING","Mage_Core_Exception",150],["T_WHITESPACE"," ",150],["T_VARIABLE","$e",150],")",["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n            ",150],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","_message",151],"(",["T_VARIABLE","$e",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","getMessage",151],"(",")",",",["T_WHITESPACE"," ",151],["T_STRING","self",151],["T_DOUBLE_COLON","::",151],["T_STRING","MESSAGE_STATUS_ERROR",151],")",";",["T_WHITESPACE","\n        ",151],"}",["T_WHITESPACE"," ",152],["T_CATCH","catch",152],["T_WHITESPACE"," ",152],"(",["T_STRING","Exception",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$e",152],")",["T_WHITESPACE"," ",152],"{",["T_WHITESPACE","\n            ",152],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","_message",153],"(",["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","__",153],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to load product info.'",153],")",",",["T_WHITESPACE"," ",153],["T_STRING","self",153],["T_DOUBLE_COLON","::",153],["T_STRING","MESSAGE_STATUS_ERROR",153],")",";",["T_WHITESPACE","\n            ",153],["T_STRING","Mage",154],["T_DOUBLE_COLON","::",154],["T_STRING","logException",154],"(",["T_VARIABLE","$e",154],")",";",["T_WHITESPACE","\n        ",154],"}",["T_WHITESPACE","\n    ",155],"}",["T_WHITESPACE","\n\n    ",156],["T_DOC_COMMENT","\/**\n     * Product options list\n     *\n     * @return null\n     *\/",158],["T_WHITESPACE","\n    ",162],["T_PUBLIC","public",163],["T_WHITESPACE"," ",163],["T_FUNCTION","function",163],["T_WHITESPACE"," ",163],["T_STRING","productOptionsAction",163],"(",")",["T_WHITESPACE","\n    ",163],"{",["T_WHITESPACE","\n        ",164],["T_TRY","try",165],["T_WHITESPACE"," ",165],"{",["T_WHITESPACE","\n            ",165],["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","loadLayout",166],"(",["T_STRING","false",166],")",";",["T_WHITESPACE","\n            ",166],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","renderLayout",167],"(",")",";",["T_WHITESPACE","\n        ",167],"}",["T_WHITESPACE"," ",168],["T_CATCH","catch",168],["T_WHITESPACE"," ",168],"(",["T_STRING","Mage_Core_Exception",168],["T_WHITESPACE"," ",168],["T_VARIABLE","$e",168],")",["T_WHITESPACE"," ",168],"{",["T_WHITESPACE","\n            ",168],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","_message",169],"(",["T_VARIABLE","$e",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","getMessage",169],"(",")",",",["T_WHITESPACE"," ",169],["T_STRING","self",169],["T_DOUBLE_COLON","::",169],["T_STRING","MESSAGE_STATUS_ERROR",169],")",";",["T_WHITESPACE","\n        ",169],"}",["T_WHITESPACE"," ",170],["T_CATCH","catch",170],["T_WHITESPACE"," ",170],"(",["T_STRING","Exception",170],["T_WHITESPACE"," ",170],["T_VARIABLE","$e",170],")",["T_WHITESPACE"," ",170],"{",["T_WHITESPACE","\n            ",170],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","_message",171],"(",["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","__",171],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to load product options.'",171],")",",",["T_WHITESPACE"," ",171],["T_STRING","self",171],["T_DOUBLE_COLON","::",171],["T_STRING","MESSAGE_STATUS_ERROR",171],")",";",["T_WHITESPACE","\n            ",171],["T_STRING","Mage",172],["T_DOUBLE_COLON","::",172],["T_STRING","logException",172],"(",["T_VARIABLE","$e",172],")",";",["T_WHITESPACE","\n        ",172],"}",["T_WHITESPACE","\n    ",173],"}",["T_WHITESPACE","\n\n    ",174],["T_DOC_COMMENT","\/**\n     * Product gallery images list\n     *\n     * @return null\n     *\/",176],["T_WHITESPACE","\n    ",180],["T_PUBLIC","public",181],["T_WHITESPACE"," ",181],["T_FUNCTION","function",181],["T_WHITESPACE"," ",181],["T_STRING","productGalleryAction",181],"(",")",["T_WHITESPACE","\n    ",181],"{",["T_WHITESPACE","\n        ",182],["T_TRY","try",183],["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n            ",183],["T_VARIABLE","$productId",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getRequest",184],"(",")",["T_OBJECT_OPERATOR","->",184],["T_STRING","getParam",184],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",184],",",["T_WHITESPACE"," ",184],["T_STRING","null",184],")",";",["T_WHITESPACE","\n\n            ",184],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","loadLayout",186],"(",["T_STRING","false",186],")",";",["T_WHITESPACE","\n            ",186],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","getLayout",187],"(",")",["T_OBJECT_OPERATOR","->",187],["T_STRING","getBlock",187],"(",["T_CONSTANT_ENCAPSED_STRING","'xmlconnect.catalog.product.gallery'",187],")",["T_OBJECT_OPERATOR","->",187],["T_STRING","setProductId",187],"(",["T_VARIABLE","$productId",187],")",";",["T_WHITESPACE","\n            ",187],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","renderLayout",188],"(",")",";",["T_WHITESPACE","\n        ",188],"}",["T_WHITESPACE"," ",189],["T_CATCH","catch",189],["T_WHITESPACE"," ",189],"(",["T_STRING","Mage_Core_Exception",189],["T_WHITESPACE"," ",189],["T_VARIABLE","$e",189],")",["T_WHITESPACE"," ",189],"{",["T_WHITESPACE","\n            ",189],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","_message",190],"(",["T_VARIABLE","$e",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","getMessage",190],"(",")",",",["T_WHITESPACE"," ",190],["T_STRING","self",190],["T_DOUBLE_COLON","::",190],["T_STRING","MESSAGE_STATUS_ERROR",190],")",";",["T_WHITESPACE","\n        ",190],"}",["T_WHITESPACE"," ",191],["T_CATCH","catch",191],["T_WHITESPACE"," ",191],"(",["T_STRING","Exception",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$e",191],")",["T_WHITESPACE"," ",191],"{",["T_WHITESPACE","\n            ",191],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","_message",192],"(",["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","__",192],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to load product gallery.'",192],")",",",["T_WHITESPACE"," ",192],["T_STRING","self",192],["T_DOUBLE_COLON","::",192],["T_STRING","MESSAGE_STATUS_ERROR",192],")",";",["T_WHITESPACE","\n            ",192],["T_STRING","Mage",193],["T_DOUBLE_COLON","::",193],["T_STRING","logException",193],"(",["T_VARIABLE","$e",193],")",";",["T_WHITESPACE","\n        ",193],"}",["T_WHITESPACE","\n    ",194],"}",["T_WHITESPACE","\n\n    ",195],["T_DOC_COMMENT","\/**\n     * Product reviews list\n     *\n     * @return null\n     *\/",197],["T_WHITESPACE","\n    ",201],["T_PUBLIC","public",202],["T_WHITESPACE"," ",202],["T_FUNCTION","function",202],["T_WHITESPACE"," ",202],["T_STRING","productReviewsAction",202],"(",")",["T_WHITESPACE","\n    ",202],"{",["T_WHITESPACE","\n        ",203],["T_TRY","try",204],["T_WHITESPACE"," ",204],"{",["T_WHITESPACE","\n            ",204],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","loadLayout",205],"(",["T_STRING","false",205],")",";",["T_WHITESPACE","\n            ",205],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","renderLayout",206],"(",")",";",["T_WHITESPACE","\n        ",206],"}",["T_WHITESPACE"," ",207],["T_CATCH","catch",207],["T_WHITESPACE"," ",207],"(",["T_STRING","Mage_Core_Exception",207],["T_WHITESPACE"," ",207],["T_VARIABLE","$e",207],")",["T_WHITESPACE"," ",207],"{",["T_WHITESPACE","\n            ",207],["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","_message",208],"(",["T_VARIABLE","$e",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","getMessage",208],"(",")",",",["T_WHITESPACE"," ",208],["T_STRING","self",208],["T_DOUBLE_COLON","::",208],["T_STRING","MESSAGE_STATUS_ERROR",208],")",";",["T_WHITESPACE","\n        ",208],"}",["T_WHITESPACE"," ",209],["T_CATCH","catch",209],["T_WHITESPACE"," ",209],"(",["T_STRING","Exception",209],["T_WHITESPACE"," ",209],["T_VARIABLE","$e",209],")",["T_WHITESPACE"," ",209],"{",["T_WHITESPACE","\n            ",209],["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","_message",210],"(",["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","__",210],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to load product reviews.'",210],")",",",["T_WHITESPACE"," ",210],["T_STRING","self",210],["T_DOUBLE_COLON","::",210],["T_STRING","MESSAGE_STATUS_ERROR",210],")",";",["T_WHITESPACE","\n            ",210],["T_STRING","Mage",211],["T_DOUBLE_COLON","::",211],["T_STRING","logException",211],"(",["T_VARIABLE","$e",211],")",";",["T_WHITESPACE","\n        ",211],"}",["T_WHITESPACE","\n    ",212],"}",["T_WHITESPACE","\n\n    ",213],["T_DOC_COMMENT","\/**\n     * Add new review\n     *\n     * @return null\n     *\/",215],["T_WHITESPACE","\n    ",219],["T_PUBLIC","public",220],["T_WHITESPACE"," ",220],["T_FUNCTION","function",220],["T_WHITESPACE"," ",220],["T_STRING","productReviewAction",220],"(",")",["T_WHITESPACE","\n    ",220],"{",["T_WHITESPACE","\n        ",221],["T_TRY","try",222],["T_WHITESPACE"," ",222],"{",["T_WHITESPACE","\n            ",222],["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","loadLayout",223],"(",["T_STRING","false",223],")",";",["T_WHITESPACE","\n            ",223],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","renderLayout",224],"(",")",";",["T_WHITESPACE","\n        ",224],"}",["T_WHITESPACE"," ",225],["T_CATCH","catch",225],["T_WHITESPACE"," ",225],"(",["T_STRING","Mage_Core_Exception",225],["T_WHITESPACE"," ",225],["T_VARIABLE","$e",225],")",["T_WHITESPACE"," ",225],"{",["T_WHITESPACE","\n            ",225],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","_message",226],"(",["T_VARIABLE","$e",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","getMessage",226],"(",")",",",["T_WHITESPACE"," ",226],["T_STRING","self",226],["T_DOUBLE_COLON","::",226],["T_STRING","MESSAGE_STATUS_ERROR",226],")",";",["T_WHITESPACE","\n        ",226],"}",["T_WHITESPACE"," ",227],["T_CATCH","catch",227],["T_WHITESPACE"," ",227],"(",["T_STRING","Exception",227],["T_WHITESPACE"," ",227],["T_VARIABLE","$e",227],")",["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n            ",227],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","_message",228],"(",["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","__",228],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to load product review.'",228],")",",",["T_WHITESPACE"," ",228],["T_STRING","self",228],["T_DOUBLE_COLON","::",228],["T_STRING","MESSAGE_STATUS_ERROR",228],")",";",["T_WHITESPACE","\n            ",228],["T_STRING","Mage",229],["T_DOUBLE_COLON","::",229],["T_STRING","logException",229],"(",["T_VARIABLE","$e",229],")",";",["T_WHITESPACE","\n        ",229],"}",["T_WHITESPACE","\n    ",230],"}",["T_WHITESPACE","\n\n    ",231],["T_DOC_COMMENT","\/**\n     * Perform search products\n     *\n     * @return null\n     *\/",233],["T_WHITESPACE","\n    ",237],["T_PUBLIC","public",238],["T_WHITESPACE"," ",238],["T_FUNCTION","function",238],["T_WHITESPACE"," ",238],["T_STRING","searchAction",238],"(",")",["T_WHITESPACE","\n    ",238],"{",["T_WHITESPACE","\n        ",239],["T_IF","if",240],["T_WHITESPACE"," ",240],"(",["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","_checkApiForward",240],"(",["T_CONSTANT_ENCAPSED_STRING","'searchDetails'",240],",",["T_WHITESPACE"," ",240],["T_STRING","Mage_XmlConnect_Helper_Data",240],["T_DOUBLE_COLON","::",240],["T_STRING","DEVICE_API_V_23",240],")",")",["T_WHITESPACE"," ",240],"{",["T_WHITESPACE","\n            ",240],["T_RETURN","return",241],";",["T_WHITESPACE","\n        ",241],"}",["T_WHITESPACE","\n        ",242],["T_DOC_COMMENT","\/** @var $_helper Mage_CatalogSearch_Helper_Data *\/",243],["T_WHITESPACE","\n        ",243],["T_VARIABLE","$_helper",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_STRING","Mage",244],["T_DOUBLE_COLON","::",244],["T_STRING","helper",244],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogsearch'",244],")",";",["T_WHITESPACE","\n        ",244],["T_VARIABLE","$queryParam",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_STRING","str_replace",245],"(",["T_CONSTANT_ENCAPSED_STRING","'%20'",245],",",["T_WHITESPACE"," ",245],["T_CONSTANT_ENCAPSED_STRING","' '",245],",",["T_WHITESPACE"," ",245],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","getRequest",245],"(",")",["T_OBJECT_OPERATOR","->",245],["T_STRING","getParam",245],"(",["T_CONSTANT_ENCAPSED_STRING","'query'",245],")",")",";",["T_WHITESPACE","\n        ",245],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","getRequest",246],"(",")",["T_OBJECT_OPERATOR","->",246],["T_STRING","setParam",246],"(",["T_VARIABLE","$_helper",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","getQueryParamName",246],"(",")",",",["T_WHITESPACE"," ",246],["T_VARIABLE","$queryParam",246],")",";",["T_WHITESPACE","\n        ",246],["T_DOC_COMMENT","\/** @var $query Mage_CatalogSearch_Model_Query *\/",247],["T_WHITESPACE","\n        ",247],["T_VARIABLE","$query",248],["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_VARIABLE","$_helper",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","getQuery",248],"(",")",";",["T_WHITESPACE","\n        ",248],["T_VARIABLE","$query",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","setStoreId",249],"(",["T_STRING","Mage",249],["T_DOUBLE_COLON","::",249],["T_STRING","app",249],"(",")",["T_OBJECT_OPERATOR","->",249],["T_STRING","getStore",249],"(",")",["T_OBJECT_OPERATOR","->",249],["T_STRING","getId",249],"(",")",")",";",["T_WHITESPACE","\n\n        ",249],["T_IF","if",251],["T_WHITESPACE"," ",251],"(",["T_VARIABLE","$query",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","getQueryText",251],"(",")",")",["T_WHITESPACE"," ",251],"{",["T_WHITESPACE","\n            ",251],["T_IF","if",252],["T_WHITESPACE"," ",252],"(",["T_VARIABLE","$_helper",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","isMinQueryLength",252],"(",")",")",["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n                ",252],["T_VARIABLE","$query",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","setId",253],"(",["T_LNUMBER","0",253],")",["T_OBJECT_OPERATOR","->",253],["T_STRING","setIsActive",253],"(",["T_LNUMBER","1",253],")",["T_OBJECT_OPERATOR","->",253],["T_STRING","setIsProcessed",253],"(",["T_LNUMBER","1",253],")",";",["T_WHITESPACE","\n            ",253],"}",["T_WHITESPACE"," ",254],["T_ELSE","else",254],["T_WHITESPACE"," ",254],"{",["T_WHITESPACE","\n                ",254],["T_IF","if",255],["T_WHITESPACE"," ",255],"(",["T_VARIABLE","$query",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","getId",255],"(",")",")",["T_WHITESPACE"," ",255],"{",["T_WHITESPACE","\n                    ",255],["T_VARIABLE","$query",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","setPopularity",256],"(",["T_VARIABLE","$query",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","getPopularity",256],"(",")",["T_WHITESPACE"," ",256],"+",["T_WHITESPACE"," ",256],["T_LNUMBER","1",256],")",";",["T_WHITESPACE","\n                ",256],"}",["T_WHITESPACE"," ",257],["T_ELSE","else",257],["T_WHITESPACE"," ",257],"{",["T_WHITESPACE","\n                    ",257],["T_VARIABLE","$query",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","setPopularity",258],"(",["T_LNUMBER","1",258],")",";",["T_WHITESPACE","\n                ",258],"}",["T_WHITESPACE","\n\n                ",259],["T_DOC_COMMENT","\/**\n                 * We don't support redirect at this moment\n                 *\n                 * @todo add redirect support for mobile application\n                 *\/",261],["T_WHITESPACE","\n                ",265],["T_IF","if",266],["T_WHITESPACE"," ",266],"(",["T_STRING","false",266],["T_WHITESPACE"," ",266],["T_BOOLEAN_AND","&&",266],["T_WHITESPACE"," ",266],["T_VARIABLE","$query",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","getRedirect",266],"(",")",")",["T_WHITESPACE"," ",266],"{",["T_WHITESPACE","\n                    ",266],["T_VARIABLE","$query",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","save",267],"(",")",";",["T_WHITESPACE","\n                    ",267],["T_VARIABLE","$this",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","getResponse",268],"(",")",["T_OBJECT_OPERATOR","->",268],["T_STRING","setRedirect",268],"(",["T_VARIABLE","$query",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","getRedirect",268],"(",")",")",";",["T_WHITESPACE","\n                    ",268],["T_RETURN","return",269],";",["T_WHITESPACE","\n                ",269],"}",["T_WHITESPACE"," ",270],["T_ELSE","else",270],["T_WHITESPACE"," ",270],"{",["T_WHITESPACE","\n                    ",270],["T_VARIABLE","$query",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","prepare",271],"(",")",";",["T_WHITESPACE","\n                ",271],"}",["T_WHITESPACE","\n            ",272],"}",["T_WHITESPACE","\n\n            ",273],["T_VARIABLE","$_helper",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","checkNotes",275],"(",")",";",["T_WHITESPACE","\n\n            ",275],["T_IF","if",277],["T_WHITESPACE"," ",277],"(","!",["T_VARIABLE","$_helper",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","isMinQueryLength",277],"(",")",")",["T_WHITESPACE"," ",277],"{",["T_WHITESPACE","\n                ",277],["T_VARIABLE","$query",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","save",278],"(",")",";",["T_WHITESPACE","\n            ",278],"}",["T_WHITESPACE","\n        ",279],"}",["T_WHITESPACE","\n\n        ",280],["T_TRY","try",282],["T_WHITESPACE"," ",282],"{",["T_WHITESPACE","\n            ",282],["T_VARIABLE","$this",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","loadLayout",283],"(",["T_STRING","false",283],")",";",["T_WHITESPACE","\n            ",283],["T_VARIABLE","$this",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","renderLayout",284],"(",")",";",["T_WHITESPACE","\n        ",284],"}",["T_WHITESPACE"," ",285],["T_CATCH","catch",285],["T_WHITESPACE"," ",285],"(",["T_STRING","Mage_Core_Exception",285],["T_WHITESPACE"," ",285],["T_VARIABLE","$e",285],")",["T_WHITESPACE"," ",285],"{",["T_WHITESPACE","\n            ",285],["T_VARIABLE","$this",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","_message",286],"(",["T_VARIABLE","$e",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","getMessage",286],"(",")",",",["T_WHITESPACE"," ",286],["T_STRING","self",286],["T_DOUBLE_COLON","::",286],["T_STRING","MESSAGE_STATUS_ERROR",286],")",";",["T_WHITESPACE","\n        ",286],"}",["T_WHITESPACE"," ",287],["T_CATCH","catch",287],["T_WHITESPACE"," ",287],"(",["T_STRING","Exception",287],["T_WHITESPACE"," ",287],["T_VARIABLE","$e",287],")",["T_WHITESPACE"," ",287],"{",["T_WHITESPACE","\n            ",287],["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","_message",288],"(",["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","__",288],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to load search.'",288],")",",",["T_WHITESPACE"," ",288],["T_STRING","self",288],["T_DOUBLE_COLON","::",288],["T_STRING","MESSAGE_STATUS_ERROR",288],")",";",["T_WHITESPACE","\n            ",288],["T_STRING","Mage",289],["T_DOUBLE_COLON","::",289],["T_STRING","logException",289],"(",["T_VARIABLE","$e",289],")",";",["T_WHITESPACE","\n        ",289],"}",["T_WHITESPACE","\n    ",290],"}",["T_WHITESPACE","\n\n    ",291],["T_DOC_COMMENT","\/**\n     * Perform search products details\n     *\n     * @return null\n     *\/",293],["T_WHITESPACE","\n    ",297],["T_PUBLIC","public",298],["T_WHITESPACE"," ",298],["T_FUNCTION","function",298],["T_WHITESPACE"," ",298],["T_STRING","searchDetailsAction",298],"(",")",["T_WHITESPACE","\n    ",298],"{",["T_WHITESPACE","\n        ",299],["T_DOC_COMMENT","\/** @var $_helper Mage_CatalogSearch_Helper_Data *\/",300],["T_WHITESPACE","\n        ",300],["T_VARIABLE","$_helper",301],["T_WHITESPACE"," ",301],"=",["T_WHITESPACE"," ",301],["T_STRING","Mage",301],["T_DOUBLE_COLON","::",301],["T_STRING","helper",301],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogsearch'",301],")",";",["T_WHITESPACE","\n        ",301],["T_VARIABLE","$queryParam",302],["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],["T_STRING","str_replace",302],"(",["T_CONSTANT_ENCAPSED_STRING","'%20'",302],",",["T_WHITESPACE"," ",302],["T_CONSTANT_ENCAPSED_STRING","' '",302],",",["T_WHITESPACE"," ",302],["T_VARIABLE","$this",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","getRequest",302],"(",")",["T_OBJECT_OPERATOR","->",302],["T_STRING","getParam",302],"(",["T_CONSTANT_ENCAPSED_STRING","'query'",302],")",")",";",["T_WHITESPACE","\n        ",302],["T_VARIABLE","$this",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","getRequest",303],"(",")",["T_OBJECT_OPERATOR","->",303],["T_STRING","setParam",303],"(",["T_VARIABLE","$_helper",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","getQueryParamName",303],"(",")",",",["T_WHITESPACE"," ",303],["T_VARIABLE","$queryParam",303],")",";",["T_WHITESPACE","\n        ",303],["T_DOC_COMMENT","\/** @var $query Mage_CatalogSearch_Model_Query *\/",304],["T_WHITESPACE","\n        ",304],["T_VARIABLE","$query",305],["T_WHITESPACE"," ",305],"=",["T_WHITESPACE"," ",305],["T_VARIABLE","$_helper",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","getQuery",305],"(",")",";",["T_WHITESPACE","\n        ",305],["T_VARIABLE","$query",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","setStoreId",306],"(",["T_STRING","Mage",306],["T_DOUBLE_COLON","::",306],["T_STRING","app",306],"(",")",["T_OBJECT_OPERATOR","->",306],["T_STRING","getStore",306],"(",")",["T_OBJECT_OPERATOR","->",306],["T_STRING","getId",306],"(",")",")",";",["T_WHITESPACE","\n\n        ",306],["T_IF","if",308],["T_WHITESPACE"," ",308],"(",["T_VARIABLE","$query",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","getQueryText",308],"(",")",")",["T_WHITESPACE"," ",308],"{",["T_WHITESPACE","\n            ",308],["T_IF","if",309],["T_WHITESPACE"," ",309],"(",["T_VARIABLE","$_helper",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","isMinQueryLength",309],"(",")",")",["T_WHITESPACE"," ",309],"{",["T_WHITESPACE","\n                ",309],["T_VARIABLE","$query",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","setId",310],"(",["T_LNUMBER","0",310],")",["T_OBJECT_OPERATOR","->",310],["T_STRING","setIsActive",310],"(",["T_LNUMBER","1",310],")",["T_OBJECT_OPERATOR","->",310],["T_STRING","setIsProcessed",310],"(",["T_LNUMBER","1",310],")",";",["T_WHITESPACE","\n            ",310],"}",["T_WHITESPACE"," ",311],["T_ELSE","else",311],["T_WHITESPACE"," ",311],"{",["T_WHITESPACE","\n                ",311],["T_IF","if",312],["T_WHITESPACE"," ",312],"(",["T_VARIABLE","$query",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","getId",312],"(",")",")",["T_WHITESPACE"," ",312],"{",["T_WHITESPACE","\n                    ",312],["T_VARIABLE","$query",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","setPopularity",313],"(",["T_VARIABLE","$query",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","getPopularity",313],"(",")",["T_WHITESPACE"," ",313],"+",["T_WHITESPACE"," ",313],["T_LNUMBER","1",313],")",";",["T_WHITESPACE","\n                ",313],"}",["T_WHITESPACE"," ",314],["T_ELSE","else",314],["T_WHITESPACE"," ",314],"{",["T_WHITESPACE","\n                    ",314],["T_VARIABLE","$query",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","setPopularity",315],"(",["T_LNUMBER","1",315],")",";",["T_WHITESPACE","\n                ",315],"}",["T_WHITESPACE","\n\n                ",316],["T_DOC_COMMENT","\/**\n                 * We don't support redirect at this moment\n                 *\n                 * @todo add redirect support for mobile application\n                 *\/",318],["T_WHITESPACE","\n                ",322],["T_IF","if",323],["T_WHITESPACE"," ",323],"(",["T_STRING","false",323],["T_WHITESPACE"," ",323],["T_BOOLEAN_AND","&&",323],["T_WHITESPACE"," ",323],["T_VARIABLE","$query",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","getRedirect",323],"(",")",")",["T_WHITESPACE"," ",323],"{",["T_WHITESPACE","\n                    ",323],["T_VARIABLE","$query",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","save",324],"(",")",";",["T_WHITESPACE","\n                    ",324],["T_VARIABLE","$this",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","getResponse",325],"(",")",["T_OBJECT_OPERATOR","->",325],["T_STRING","setRedirect",325],"(",["T_VARIABLE","$query",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","getRedirect",325],"(",")",")",";",["T_WHITESPACE","\n                    ",325],["T_RETURN","return",326],";",["T_WHITESPACE","\n                ",326],"}",["T_WHITESPACE"," ",327],["T_ELSE","else",327],["T_WHITESPACE"," ",327],"{",["T_WHITESPACE","\n                    ",327],["T_VARIABLE","$query",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","prepare",328],"(",")",";",["T_WHITESPACE","\n                ",328],"}",["T_WHITESPACE","\n            ",329],"}",["T_WHITESPACE","\n\n            ",330],["T_VARIABLE","$_helper",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","checkNotes",332],"(",")",";",["T_WHITESPACE","\n\n            ",332],["T_IF","if",334],["T_WHITESPACE"," ",334],"(","!",["T_VARIABLE","$_helper",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","isMinQueryLength",334],"(",")",")",["T_WHITESPACE"," ",334],"{",["T_WHITESPACE","\n                ",334],["T_VARIABLE","$query",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","save",335],"(",")",";",["T_WHITESPACE","\n            ",335],"}",["T_WHITESPACE","\n        ",336],"}",["T_WHITESPACE","\n\n        ",337],["T_TRY","try",339],["T_WHITESPACE"," ",339],"{",["T_WHITESPACE","\n            ",339],["T_VARIABLE","$this",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","loadLayout",340],"(",["T_STRING","false",340],")",";",["T_WHITESPACE","\n            ",340],["T_VARIABLE","$this",341],["T_OBJECT_OPERATOR","->",341],["T_STRING","renderLayout",341],"(",")",";",["T_WHITESPACE","\n        ",341],"}",["T_WHITESPACE"," ",342],["T_CATCH","catch",342],["T_WHITESPACE"," ",342],"(",["T_STRING","Mage_Core_Exception",342],["T_WHITESPACE"," ",342],["T_VARIABLE","$e",342],")",["T_WHITESPACE"," ",342],"{",["T_WHITESPACE","\n            ",342],["T_VARIABLE","$this",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","_message",343],"(",["T_VARIABLE","$e",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","getMessage",343],"(",")",",",["T_WHITESPACE"," ",343],["T_STRING","self",343],["T_DOUBLE_COLON","::",343],["T_STRING","MESSAGE_STATUS_ERROR",343],")",";",["T_WHITESPACE","\n        ",343],"}",["T_WHITESPACE"," ",344],["T_CATCH","catch",344],["T_WHITESPACE"," ",344],"(",["T_STRING","Exception",344],["T_WHITESPACE"," ",344],["T_VARIABLE","$e",344],")",["T_WHITESPACE"," ",344],"{",["T_WHITESPACE","\n            ",344],["T_VARIABLE","$this",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","_message",345],"(",["T_VARIABLE","$this",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","__",345],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to load search.'",345],")",",",["T_WHITESPACE"," ",345],["T_STRING","self",345],["T_DOUBLE_COLON","::",345],["T_STRING","MESSAGE_STATUS_ERROR",345],")",";",["T_WHITESPACE","\n            ",345],["T_STRING","Mage",346],["T_DOUBLE_COLON","::",346],["T_STRING","logException",346],"(",["T_VARIABLE","$e",346],")",";",["T_WHITESPACE","\n        ",346],"}",["T_WHITESPACE","\n    ",347],"}",["T_WHITESPACE","\n\n    ",348],["T_DOC_COMMENT","\/**\n     * Retrieve suggestions based on search query\n     *\n     * @return null\n     *\/",350],["T_WHITESPACE","\n    ",354],["T_PUBLIC","public",355],["T_WHITESPACE"," ",355],["T_FUNCTION","function",355],["T_WHITESPACE"," ",355],["T_STRING","searchSuggestAction",355],"(",")",["T_WHITESPACE","\n    ",355],"{",["T_WHITESPACE","\n        ",356],["T_VARIABLE","$this",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","getRequest",357],"(",")",["T_OBJECT_OPERATOR","->",357],["T_STRING","setParam",357],"(",["T_CONSTANT_ENCAPSED_STRING","'q'",357],",",["T_WHITESPACE"," ",357],["T_VARIABLE","$this",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","getRequest",357],"(",")",["T_OBJECT_OPERATOR","->",357],["T_STRING","getParam",357],"(",["T_CONSTANT_ENCAPSED_STRING","'query'",357],")",")",";",["T_WHITESPACE","\n        ",357],["T_TRY","try",358],["T_WHITESPACE"," ",358],"{",["T_WHITESPACE","\n            ",358],["T_VARIABLE","$this",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","loadLayout",359],"(",["T_STRING","false",359],")",";",["T_WHITESPACE","\n            ",359],["T_VARIABLE","$this",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","renderLayout",360],"(",")",";",["T_WHITESPACE","\n        ",360],"}",["T_WHITESPACE"," ",361],["T_CATCH","catch",361],["T_WHITESPACE"," ",361],"(",["T_STRING","Mage_Core_Exception",361],["T_WHITESPACE"," ",361],["T_VARIABLE","$e",361],")",["T_WHITESPACE"," ",361],"{",["T_WHITESPACE","\n            ",361],["T_VARIABLE","$this",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","_message",362],"(",["T_VARIABLE","$e",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","getMessage",362],"(",")",",",["T_WHITESPACE"," ",362],["T_STRING","self",362],["T_DOUBLE_COLON","::",362],["T_STRING","MESSAGE_STATUS_ERROR",362],")",";",["T_WHITESPACE","\n        ",362],"}",["T_WHITESPACE"," ",363],["T_CATCH","catch",363],["T_WHITESPACE"," ",363],"(",["T_STRING","Exception",363],["T_WHITESPACE"," ",363],["T_VARIABLE","$e",363],")",["T_WHITESPACE"," ",363],"{",["T_WHITESPACE","\n            ",363],["T_VARIABLE","$this",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","_message",364],"(",["T_VARIABLE","$this",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","__",364],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to load search.'",364],")",",",["T_WHITESPACE"," ",364],["T_STRING","self",364],["T_DOUBLE_COLON","::",364],["T_STRING","MESSAGE_STATUS_ERROR",364],")",";",["T_WHITESPACE","\n            ",364],["T_STRING","Mage",365],["T_DOUBLE_COLON","::",365],["T_STRING","logException",365],"(",["T_VARIABLE","$e",365],")",";",["T_WHITESPACE","\n        ",365],"}",["T_WHITESPACE","\n    ",366],"}",["T_WHITESPACE","\n\n    ",367],["T_DOC_COMMENT","\/**\n     * Send product link to friend action\n     *\n     * @return Mage_XmlConnect_CatalogController\n     *\/",369],["T_WHITESPACE","\n    ",373],["T_PUBLIC","public",374],["T_WHITESPACE"," ",374],["T_FUNCTION","function",374],["T_WHITESPACE"," ",374],["T_STRING","sendEmailAction",374],"(",")",["T_WHITESPACE","\n    ",374],"{",["T_WHITESPACE","\n        ",375],["T_COMMENT","\/* @var $helper Mage_Sendfriend_Helper_Data *\/",376],["T_WHITESPACE","\n        ",376],["T_VARIABLE","$helper",377],["T_WHITESPACE"," ",377],"=",["T_WHITESPACE"," ",377],["T_STRING","Mage",377],["T_DOUBLE_COLON","::",377],["T_STRING","helper",377],"(",["T_CONSTANT_ENCAPSED_STRING","'sendfriend'",377],")",";",["T_WHITESPACE","\n        ",377],["T_COMMENT","\/* @var $session Mage_Customer_Model_Session *\/",378],["T_WHITESPACE","\n        ",378],["T_VARIABLE","$session",379],["T_WHITESPACE"," ",379],"=",["T_WHITESPACE"," ",379],["T_STRING","Mage",379],["T_DOUBLE_COLON","::",379],["T_STRING","getSingleton",379],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",379],")",";",["T_WHITESPACE","\n\n        ",379],["T_IF","if",381],["T_WHITESPACE"," ",381],"(","!",["T_VARIABLE","$helper",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","isEnabled",381],"(",")",")",["T_WHITESPACE"," ",381],"{",["T_WHITESPACE","\n            ",381],["T_VARIABLE","$this",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","_message",382],"(",["T_VARIABLE","$this",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","__",382],"(",["T_CONSTANT_ENCAPSED_STRING","'Tell a Friend is disabled.'",382],")",",",["T_WHITESPACE"," ",382],["T_STRING","self",382],["T_DOUBLE_COLON","::",382],["T_STRING","MESSAGE_STATUS_ERROR",382],")",";",["T_WHITESPACE","\n            ",382],["T_RETURN","return",383],["T_WHITESPACE"," ",383],["T_VARIABLE","$this",383],";",["T_WHITESPACE","\n        ",383],"}",["T_WHITESPACE","\n\n        ",384],["T_IF","if",386],["T_WHITESPACE"," ",386],"(","!",["T_VARIABLE","$helper",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","isAllowForGuest",386],"(",")",["T_WHITESPACE"," ",386],["T_BOOLEAN_AND","&&",386],["T_WHITESPACE"," ",386],"!",["T_VARIABLE","$session",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","isLoggedIn",386],"(",")",")",["T_WHITESPACE"," ",386],"{",["T_WHITESPACE","\n            ",386],["T_VARIABLE","$this",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","_message",387],"(",["T_WHITESPACE","\n                ",387],["T_VARIABLE","$this",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","__",388],"(",["T_CONSTANT_ENCAPSED_STRING","'Customer not logged in.'",388],")",",",["T_WHITESPACE"," ",388],["T_STRING","self",388],["T_DOUBLE_COLON","::",388],["T_STRING","MESSAGE_STATUS_ERROR",388],",",["T_WHITESPACE"," ",388],["T_ARRAY","array",388],"(",["T_CONSTANT_ENCAPSED_STRING","'logged_in'",388],["T_WHITESPACE"," ",388],["T_DOUBLE_ARROW","=>",388],["T_WHITESPACE"," ",388],["T_CONSTANT_ENCAPSED_STRING","'0'",388],")",["T_WHITESPACE","\n            ",388],")",";",["T_WHITESPACE","\n            ",389],["T_RETURN","return",390],["T_WHITESPACE"," ",390],["T_VARIABLE","$this",390],";",["T_WHITESPACE","\n        ",390],"}",["T_WHITESPACE","\n\n        ",391],["T_DOC_COMMENT","\/**\n         * Initialize product\n         *\/",393],["T_WHITESPACE","\n        ",395],["T_VARIABLE","$productId",396],["T_WHITESPACE","  ",396],"=",["T_WHITESPACE"," ",396],["T_INT_CAST","(int)",396],["T_VARIABLE","$this",396],["T_OBJECT_OPERATOR","->",396],["T_STRING","getRequest",396],"(",")",["T_OBJECT_OPERATOR","->",396],["T_STRING","getParam",396],"(",["T_CONSTANT_ENCAPSED_STRING","'product_id'",396],")",";",["T_WHITESPACE","\n        ",396],["T_IF","if",397],["T_WHITESPACE"," ",397],"(","!",["T_VARIABLE","$productId",397],")",["T_WHITESPACE"," ",397],"{",["T_WHITESPACE","\n            ",397],["T_VARIABLE","$this",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","_message",398],"(",["T_VARIABLE","$this",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","__",398],"(",["T_CONSTANT_ENCAPSED_STRING","'No product selected.'",398],")",",",["T_WHITESPACE"," ",398],["T_STRING","self",398],["T_DOUBLE_COLON","::",398],["T_STRING","MESSAGE_STATUS_ERROR",398],")",";",["T_WHITESPACE","\n            ",398],["T_RETURN","return",399],["T_WHITESPACE"," ",399],["T_VARIABLE","$this",399],";",["T_WHITESPACE","\n        ",399],"}",["T_WHITESPACE","\n        ",400],["T_VARIABLE","$product",401],["T_WHITESPACE"," ",401],"=",["T_WHITESPACE"," ",401],["T_STRING","Mage",401],["T_DOUBLE_COLON","::",401],["T_STRING","getModel",401],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",401],")",["T_OBJECT_OPERATOR","->",401],["T_STRING","load",401],"(",["T_VARIABLE","$productId",401],")",";",["T_WHITESPACE","\n        ",401],["T_IF","if",402],["T_WHITESPACE"," ",402],"(","!",["T_VARIABLE","$product",402],["T_OBJECT_OPERATOR","->",402],["T_STRING","getId",402],"(",")",["T_WHITESPACE"," ",402],["T_BOOLEAN_OR","||",402],["T_WHITESPACE"," ",402],"!",["T_VARIABLE","$product",402],["T_OBJECT_OPERATOR","->",402],["T_STRING","isVisibleInCatalog",402],"(",")",")",["T_WHITESPACE"," ",402],"{",["T_WHITESPACE","\n            ",402],["T_VARIABLE","$this",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","_message",403],"(",["T_VARIABLE","$this",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","__",403],"(",["T_CONSTANT_ENCAPSED_STRING","'Selected product is unavailable.'",403],")",",",["T_WHITESPACE"," ",403],["T_STRING","self",403],["T_DOUBLE_COLON","::",403],["T_STRING","MESSAGE_STATUS_ERROR",403],")",";",["T_WHITESPACE","\n            ",403],["T_RETURN","return",404],["T_WHITESPACE"," ",404],["T_VARIABLE","$this",404],";",["T_WHITESPACE","\n        ",404],"}",["T_WHITESPACE","\n\n        ",405],["T_STRING","Mage",407],["T_DOUBLE_COLON","::",407],["T_STRING","register",407],"(",["T_CONSTANT_ENCAPSED_STRING","'product'",407],",",["T_WHITESPACE"," ",407],["T_VARIABLE","$product",407],")",";",["T_WHITESPACE","\n\n        ",407],["T_DOC_COMMENT","\/**\n         * Initialize send friend model\n         *\/",409],["T_WHITESPACE","\n        ",411],["T_VARIABLE","$model",412],["T_WHITESPACE","  ",412],"=",["T_WHITESPACE"," ",412],["T_STRING","Mage",412],["T_DOUBLE_COLON","::",412],["T_STRING","getModel",412],"(",["T_CONSTANT_ENCAPSED_STRING","'sendfriend\/sendfriend'",412],")",";",["T_WHITESPACE","\n        ",412],["T_VARIABLE","$model",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","setRemoteAddr",413],"(",["T_STRING","Mage",413],["T_DOUBLE_COLON","::",413],["T_STRING","helper",413],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/http'",413],")",["T_OBJECT_OPERATOR","->",413],["T_STRING","getRemoteAddr",413],"(",["T_STRING","true",413],")",")",";",["T_WHITESPACE","\n        ",413],["T_VARIABLE","$model",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","setCookie",414],"(",["T_STRING","Mage",414],["T_DOUBLE_COLON","::",414],["T_STRING","app",414],"(",")",["T_OBJECT_OPERATOR","->",414],["T_STRING","getCookie",414],"(",")",")",";",["T_WHITESPACE","\n        ",414],["T_VARIABLE","$model",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","setWebsiteId",415],"(",["T_STRING","Mage",415],["T_DOUBLE_COLON","::",415],["T_STRING","app",415],"(",")",["T_OBJECT_OPERATOR","->",415],["T_STRING","getStore",415],"(",")",["T_OBJECT_OPERATOR","->",415],["T_STRING","getWebsiteId",415],"(",")",")",";",["T_WHITESPACE","\n\n        ",415],["T_STRING","Mage",417],["T_DOUBLE_COLON","::",417],["T_STRING","register",417],"(",["T_CONSTANT_ENCAPSED_STRING","'send_to_friend_model'",417],",",["T_WHITESPACE"," ",417],["T_VARIABLE","$model",417],")",";",["T_WHITESPACE","\n",417],["T_COMMENT","\/*\n        if ($model->getMaxSendsToFriend()) {\n            $this->_message($this->__('Messages cannot be sent more than %d times in an hour.',\n                    $model->getMaxSendsToFriend()),\n                    self::MESSAGE_STATUS_WARNING);\n            return $this;\n        }\n*\/",418],["T_WHITESPACE","\n        ",425],["T_VARIABLE","$data",426],["T_WHITESPACE"," ",426],"=",["T_WHITESPACE"," ",426],["T_VARIABLE","$this",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","getRequest",426],"(",")",["T_OBJECT_OPERATOR","->",426],["T_STRING","getPost",426],"(",")",";",["T_WHITESPACE","\n\n        ",426],["T_IF","if",428],["T_WHITESPACE"," ",428],"(","!",["T_VARIABLE","$data",428],")",["T_WHITESPACE"," ",428],"{",["T_WHITESPACE","\n            ",428],["T_VARIABLE","$this",429],["T_OBJECT_OPERATOR","->",429],["T_STRING","_message",429],"(",["T_VARIABLE","$this",429],["T_OBJECT_OPERATOR","->",429],["T_STRING","__",429],"(",["T_CONSTANT_ENCAPSED_STRING","'Specified invalid data.'",429],")",",",["T_WHITESPACE"," ",429],["T_STRING","self",429],["T_DOUBLE_COLON","::",429],["T_STRING","MESSAGE_STATUS_ERROR",429],")",";",["T_WHITESPACE","\n            ",429],["T_RETURN","return",430],["T_WHITESPACE"," ",430],["T_VARIABLE","$this",430],";",["T_WHITESPACE","\n        ",430],"}",["T_WHITESPACE","\n\n        ",431],["T_VARIABLE","$sender",433],["T_WHITESPACE"," ",433],"=",["T_WHITESPACE"," ",433],["T_ARRAY_CAST","(array)",433],["T_VARIABLE","$this",433],["T_OBJECT_OPERATOR","->",433],["T_STRING","getRequest",433],"(",")",["T_OBJECT_OPERATOR","->",433],["T_STRING","getPost",433],"(",["T_CONSTANT_ENCAPSED_STRING","'sender'",433],")",";",["T_WHITESPACE","\n        ",433],["T_IF","if",434],["T_WHITESPACE"," ",434],"(",["T_VARIABLE","$session",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","isLoggedIn",434],"(",")",")",["T_WHITESPACE"," ",434],"{",["T_WHITESPACE","\n            ",434],["T_VARIABLE","$sender",435],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",435],"]",["T_WHITESPACE"," ",435],"=",["T_WHITESPACE"," ",435],["T_VARIABLE","$session",435],["T_OBJECT_OPERATOR","->",435],["T_STRING","getCustomer",435],"(",")",["T_OBJECT_OPERATOR","->",435],["T_STRING","getEmail",435],"(",")",";",["T_WHITESPACE","\n            ",435],["T_VARIABLE","$sender",436],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",436],"]",["T_WHITESPACE"," ",436],"=",["T_WHITESPACE"," ",436],["T_VARIABLE","$session",436],["T_OBJECT_OPERATOR","->",436],["T_STRING","getCustomer",436],"(",")",["T_OBJECT_OPERATOR","->",436],["T_STRING","getFirstName",436],"(",")",["T_WHITESPACE"," ",436],".",["T_WHITESPACE"," ",436],["T_CONSTANT_ENCAPSED_STRING","' '",436],["T_WHITESPACE"," ",436],".",["T_WHITESPACE"," ",436],["T_VARIABLE","$session",436],["T_OBJECT_OPERATOR","->",436],["T_STRING","getCustomer",436],"(",")",["T_OBJECT_OPERATOR","->",436],["T_STRING","getLastName",436],"(",")",";",["T_WHITESPACE","\n        ",436],"}",["T_WHITESPACE","\n\n        ",437],["T_DOC_COMMENT","\/**\n         * Initialize category and set it to product\n         *\/",439],["T_WHITESPACE","\n        ",441],["T_VARIABLE","$categoryId",442],["T_WHITESPACE"," ",442],"=",["T_WHITESPACE"," ",442],["T_VARIABLE","$this",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","getRequest",442],"(",")",["T_OBJECT_OPERATOR","->",442],["T_STRING","getParam",442],"(",["T_CONSTANT_ENCAPSED_STRING","'category_id'",442],",",["T_WHITESPACE"," ",442],["T_STRING","null",442],")",";",["T_WHITESPACE","\n        ",442],["T_IF","if",443],["T_WHITESPACE"," ",443],"(",["T_VARIABLE","$categoryId",443],")",["T_WHITESPACE"," ",443],"{",["T_WHITESPACE","\n            ",443],["T_VARIABLE","$category",444],["T_WHITESPACE"," ",444],"=",["T_WHITESPACE"," ",444],["T_STRING","Mage",444],["T_DOUBLE_COLON","::",444],["T_STRING","getModel",444],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",444],")",["T_OBJECT_OPERATOR","->",444],["T_STRING","load",444],"(",["T_VARIABLE","$categoryId",444],")",";",["T_WHITESPACE","\n            ",444],["T_VARIABLE","$product",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","setCategory",445],"(",["T_VARIABLE","$category",445],")",";",["T_WHITESPACE","\n            ",445],["T_STRING","Mage",446],["T_DOUBLE_COLON","::",446],["T_STRING","register",446],"(",["T_CONSTANT_ENCAPSED_STRING","'current_category'",446],",",["T_WHITESPACE"," ",446],["T_VARIABLE","$category",446],")",";",["T_WHITESPACE","\n        ",446],"}",["T_WHITESPACE","\n\n        ",447],["T_VARIABLE","$model",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","setSender",449],"(",["T_VARIABLE","$sender",449],")",";",["T_WHITESPACE","\n        ",449],["T_VARIABLE","$model",450],["T_OBJECT_OPERATOR","->",450],["T_STRING","setRecipients",450],"(",["T_VARIABLE","$this",450],["T_OBJECT_OPERATOR","->",450],["T_STRING","getRequest",450],"(",")",["T_OBJECT_OPERATOR","->",450],["T_STRING","getPost",450],"(",["T_CONSTANT_ENCAPSED_STRING","'recipients'",450],")",")",";",["T_WHITESPACE","\n        ",450],["T_VARIABLE","$model",451],["T_OBJECT_OPERATOR","->",451],["T_STRING","setProduct",451],"(",["T_VARIABLE","$product",451],")",";",["T_WHITESPACE","\n\n        ",451],["T_TRY","try",453],["T_WHITESPACE"," ",453],"{",["T_WHITESPACE","\n            ",453],["T_VARIABLE","$validate",454],["T_WHITESPACE"," ",454],"=",["T_WHITESPACE"," ",454],["T_VARIABLE","$model",454],["T_OBJECT_OPERATOR","->",454],["T_STRING","validate",454],"(",")",";",["T_WHITESPACE","\n            ",454],["T_IF","if",455],["T_WHITESPACE"," ",455],"(",["T_VARIABLE","$validate",455],["T_WHITESPACE"," ",455],["T_IS_IDENTICAL","===",455],["T_WHITESPACE"," ",455],["T_STRING","true",455],")",["T_WHITESPACE"," ",455],"{",["T_WHITESPACE","\n                ",455],["T_VARIABLE","$model",456],["T_OBJECT_OPERATOR","->",456],["T_STRING","send",456],"(",")",";",["T_WHITESPACE","\n                ",456],["T_VARIABLE","$this",457],["T_OBJECT_OPERATOR","->",457],["T_STRING","_message",457],"(",["T_VARIABLE","$this",457],["T_OBJECT_OPERATOR","->",457],["T_STRING","__",457],"(",["T_CONSTANT_ENCAPSED_STRING","'Tell a Friend link has been sent.'",457],")",",",["T_WHITESPACE"," ",457],["T_STRING","self",457],["T_DOUBLE_COLON","::",457],["T_STRING","MESSAGE_STATUS_SUCCESS",457],")",";",["T_WHITESPACE","\n                ",457],["T_RETURN","return",458],";",["T_WHITESPACE","\n            ",458],"}",["T_WHITESPACE"," ",459],["T_ELSE","else",459],["T_WHITESPACE"," ",459],"{",["T_WHITESPACE","\n                ",459],["T_IF","if",460],["T_WHITESPACE"," ",460],"(",["T_STRING","is_array",460],"(",["T_VARIABLE","$validate",460],")",")",["T_WHITESPACE"," ",460],"{",["T_WHITESPACE","\n                    ",460],["T_VARIABLE","$this",461],["T_OBJECT_OPERATOR","->",461],["T_STRING","_message",461],"(",["T_STRING","implode",461],"(",["T_CONSTANT_ENCAPSED_STRING","' '",461],",",["T_WHITESPACE"," ",461],["T_VARIABLE","$validate",461],")",",",["T_WHITESPACE"," ",461],["T_STRING","self",461],["T_DOUBLE_COLON","::",461],["T_STRING","MESSAGE_STATUS_ERROR",461],")",";",["T_WHITESPACE","\n                    ",461],["T_RETURN","return",462],";",["T_WHITESPACE","\n                ",462],"}",["T_WHITESPACE"," ",463],["T_ELSE","else",463],["T_WHITESPACE"," ",463],"{",["T_WHITESPACE","\n                    ",463],["T_VARIABLE","$this",464],["T_OBJECT_OPERATOR","->",464],["T_STRING","_message",464],"(",["T_VARIABLE","$this",464],["T_OBJECT_OPERATOR","->",464],["T_STRING","__",464],"(",["T_CONSTANT_ENCAPSED_STRING","'There were some problems with the data.'",464],")",",",["T_WHITESPACE"," ",464],["T_STRING","self",464],["T_DOUBLE_COLON","::",464],["T_STRING","MESSAGE_STATUS_ERROR",464],")",";",["T_WHITESPACE","\n                    ",464],["T_RETURN","return",465],";",["T_WHITESPACE","\n                ",465],"}",["T_WHITESPACE","\n            ",466],"}",["T_WHITESPACE","\n        ",467],"}",["T_WHITESPACE"," ",468],["T_CATCH","catch",468],["T_WHITESPACE"," ",468],"(",["T_STRING","Mage_Core_Exception",468],["T_WHITESPACE"," ",468],["T_VARIABLE","$e",468],")",["T_WHITESPACE"," ",468],"{",["T_WHITESPACE","\n            ",468],["T_VARIABLE","$this",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","_message",469],"(",["T_VARIABLE","$e",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","getMessage",469],"(",")",",",["T_WHITESPACE"," ",469],["T_STRING","self",469],["T_DOUBLE_COLON","::",469],["T_STRING","MESSAGE_STATUS_ERROR",469],")",";",["T_WHITESPACE","\n        ",469],"}",["T_WHITESPACE"," ",470],["T_CATCH","catch",470],["T_WHITESPACE"," ",470],"(",["T_STRING","Exception",470],["T_WHITESPACE"," ",470],["T_VARIABLE","$e",470],")",["T_WHITESPACE"," ",470],"{",["T_WHITESPACE","\n            ",470],["T_VARIABLE","$this",471],["T_OBJECT_OPERATOR","->",471],["T_STRING","_message",471],"(",["T_VARIABLE","$this",471],["T_OBJECT_OPERATOR","->",471],["T_STRING","__",471],"(",["T_CONSTANT_ENCAPSED_STRING","'Some emails were not sent.'",471],")",",",["T_WHITESPACE"," ",471],["T_STRING","self",471],["T_DOUBLE_COLON","::",471],["T_STRING","MESSAGE_STATUS_ERROR",471],")",";",["T_WHITESPACE","\n        ",471],"}",["T_WHITESPACE","\n        ",472],["T_RETURN","return",473],["T_WHITESPACE"," ",473],["T_VARIABLE","$this",473],";",["T_WHITESPACE","\n    ",473],"}",["T_WHITESPACE","\n",474],"}",["T_WHITESPACE","\n",475]]