[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_XmlConnect\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * One page checkout payment methods xml renderer\n *\n * @category    Mage\n * @package     Mage_XmlConnect\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_XmlConnect_Block_Checkout_Payment_Method_List",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Payment_Block_Form_Container",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Pre-defined array of methods that we are going to render\n     *\n     * @var array\n     *\/",36],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$_methodArray",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_ARRAY","array",41],"(",["T_WHITESPACE","\n        ",41],["T_CONSTANT_ENCAPSED_STRING","'payment_ccsave'",42],["T_WHITESPACE","            ",42],["T_DOUBLE_ARROW","=>",42],["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'Mage_Payment_Model_Method_Cc'",42],",",["T_WHITESPACE","\n        ",42],["T_CONSTANT_ENCAPSED_STRING","'payment_checkmo'",43],["T_WHITESPACE","           ",43],["T_DOUBLE_ARROW","=>",43],["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'Mage_Payment_Model_Method_Checkmo'",43],",",["T_WHITESPACE","\n        ",43],["T_CONSTANT_ENCAPSED_STRING","'payment_purchaseorder'",44],["T_WHITESPACE","     ",44],["T_DOUBLE_ARROW","=>",44],["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'Mage_Payment_Model_Method_Purchaseorder'",44],["T_WHITESPACE","\n    ",44],")",";",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * Payment bridge methods array\n     *\n     * Core block renderer by method code\n     * - 'pbridge_authorizenet'  => 'Enterprise_Pbridge_Model_Payment_Method_Authorizenet',\n     * - 'pbridge_paypal'        => 'Enterprise_Pbridge_Model_Payment_Method_Paypal',\n     * - 'pbridge_verisign'      => 'Enterprise_Pbridge_Model_Payment_Method_Payflow_Pro',\n     * - 'pbridge_paypaluk'      => 'Enterprise_Pbridge_Model_Payment_Method_Paypaluk',\n     *\n     * @var array\n     *\/",47],["T_WHITESPACE","\n    ",57],["T_PROTECTED","protected",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$_pbridgeMethodArray",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_ARRAY","array",58],"(",["T_WHITESPACE","\n        ",58],["T_CONSTANT_ENCAPSED_STRING","'pbridge_authorizenet'",59],",",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'pbridge_paypal'",59],",",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'pbridge_verisign'",59],",",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'pbridge_paypaluk'",59],["T_WHITESPACE","\n    ",59],")",";",["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * Prevent parent set children\n     *\n     * @return Mage_XmlConnect_Block_Checkout_Payment_Method_List\n     *\/",62],["T_WHITESPACE","\n    ",66],["T_PROTECTED","protected",67],["T_WHITESPACE"," ",67],["T_FUNCTION","function",67],["T_WHITESPACE"," ",67],["T_STRING","_prepareLayout",67],"(",")",["T_WHITESPACE","\n    ",67],"{",["T_WHITESPACE","\n        ",68],["T_RETURN","return",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$this",69],";",["T_WHITESPACE","\n    ",69],"}",["T_WHITESPACE","\n\n    ",70],["T_DOC_COMMENT","\/**\n     * Retrieve quote model object\n     *\n     * @return Mage_Sales_Model_Quote\n     *\/",72],["T_WHITESPACE","\n    ",76],["T_PUBLIC","public",77],["T_WHITESPACE"," ",77],["T_FUNCTION","function",77],["T_WHITESPACE"," ",77],["T_STRING","getQuote",77],"(",")",["T_WHITESPACE","\n    ",77],"{",["T_WHITESPACE","\n        ",78],["T_RETURN","return",79],["T_WHITESPACE"," ",79],["T_STRING","Mage",79],["T_DOUBLE_COLON","::",79],["T_STRING","getSingleton",79],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/session'",79],")",["T_OBJECT_OPERATOR","->",79],["T_STRING","getQuote",79],"(",")",";",["T_WHITESPACE","\n    ",79],"}",["T_WHITESPACE","\n\n    ",80],["T_DOC_COMMENT","\/**\n     * Add gift card details to XML object\n     *\n     * @param Mage_XmlConnect_Model_Simplexml_Element $methodsXmlObj\n     *\/",82],["T_WHITESPACE","\n    ",86],["T_PUBLIC","public",87],["T_WHITESPACE"," ",87],["T_FUNCTION","function",87],["T_WHITESPACE"," ",87],["T_STRING","addGiftcardToXmlObj",87],"(",["T_STRING","Mage_XmlConnect_Model_Simplexml_Element",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$methodsXmlObj",87],")",["T_WHITESPACE","\n    ",87],"{",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$giftcardInfoBlock",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getLayout",89],"(",")",["T_OBJECT_OPERATOR","->",89],["T_STRING","addBlock",89],"(",["T_WHITESPACE","\n            ",89],["T_CONSTANT_ENCAPSED_STRING","'enterprise_giftcardaccount\/checkout_onepage_payment_additional'",90],",",["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'giftcard_info'",90],["T_WHITESPACE","\n        ",90],")",";",["T_WHITESPACE","\n\n        ",91],["T_IF","if",93],["T_WHITESPACE"," ",93],"(",["T_STRING","intval",93],"(",["T_VARIABLE","$giftcardInfoBlock",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getAppliedGiftCardAmount",93],"(",")",")",")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n            ",93],["T_VARIABLE","$amount",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getQuote",94],"(",")",["T_OBJECT_OPERATOR","->",94],["T_STRING","getStore",94],"(",")",["T_OBJECT_OPERATOR","->",94],["T_STRING","formatPrice",94],"(",["T_VARIABLE","$giftcardInfoBlock",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getAppliedGiftCardAmount",94],"(",")",",",["T_WHITESPACE"," ",94],["T_STRING","false",94],")",";",["T_WHITESPACE","\n            ",94],["T_VARIABLE","$amount",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","__",95],"(",["T_CONSTANT_ENCAPSED_STRING","'Gift Card amount applied to order: %s'",95],",",["T_WHITESPACE"," ",95],["T_VARIABLE","$amount",95],")",";",["T_WHITESPACE","\n\n            ",95],["T_VARIABLE","$methodsXmlObj",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","addCustomChild",97],"(",["T_CONSTANT_ENCAPSED_STRING","'information'",97],",",["T_WHITESPACE"," ",97],["T_STRING","null",97],",",["T_WHITESPACE"," ",97],["T_ARRAY","array",97],"(",["T_CONSTANT_ENCAPSED_STRING","'label'",97],["T_WHITESPACE"," ",97],["T_DOUBLE_ARROW","=>",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$amount",97],",",["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","'disabled'",97],["T_WHITESPACE"," ",97],["T_DOUBLE_ARROW","=>",97],["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","'1'",97],")",")",";",["T_WHITESPACE","\n\n            ",97],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","setIsUsedGiftCard",99],"(",["T_STRING","true",99],")",";",["T_WHITESPACE","\n        ",99],"}",["T_WHITESPACE","\n    ",100],"}",["T_WHITESPACE","\n\n    ",101],["T_DOC_COMMENT","\/**\n     * Check is payment required for a quote\n     *\n     * @return bool\n     *\/",103],["T_WHITESPACE","\n    ",107],["T_PROTECTED","protected",108],["T_WHITESPACE"," ",108],["T_FUNCTION","function",108],["T_WHITESPACE"," ",108],["T_STRING","_isPaymentRequired",108],"(",")",["T_WHITESPACE","\n    ",108],"{",["T_WHITESPACE","\n        ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getQuote",110],"(",")",["T_OBJECT_OPERATOR","->",110],["T_STRING","collectTotals",110],"(",")",";",["T_WHITESPACE","\n        ",110],["T_RETURN","return",111],["T_WHITESPACE"," ",111],"!",["T_STRING","intval",111],"(",["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","getQuote",111],"(",")",["T_OBJECT_OPERATOR","->",111],["T_STRING","getGrandTotal",111],"(",")",")",["T_WHITESPACE"," ",111],["T_BOOLEAN_AND","&&",111],["T_WHITESPACE"," ",111],"!",["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","getQuote",111],"(",")",["T_OBJECT_OPERATOR","->",111],["T_STRING","hasNominalItems",111],"(",")",";",["T_WHITESPACE","\n    ",111],"}",["T_WHITESPACE","\n\n    ",112],["T_DOC_COMMENT","\/**\n     * Get payment methods array as code => renderer and set payment blocks to layout\n     *\n     * @return array\n     *\/",114],["T_WHITESPACE","\n    ",118],["T_PROTECTED","protected",119],["T_WHITESPACE"," ",119],["T_FUNCTION","function",119],["T_WHITESPACE"," ",119],["T_STRING","_getPaymentMethodArray",119],"(",")",["T_WHITESPACE","\n    ",119],"{",["T_WHITESPACE","\n        ",120],["T_VARIABLE","$methodArray",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","_methodArray",121],";",["T_WHITESPACE","\n\n        ",121],["T_DOC_COMMENT","\/**\n         * Check is available Payment Bridge and add methods for rendering\n         *\/",123],["T_WHITESPACE","\n        ",125],["T_IF","if",126],["T_WHITESPACE"," ",126],"(",["T_STRING","is_object",126],"(",["T_STRING","Mage",126],["T_DOUBLE_COLON","::",126],["T_STRING","getConfig",126],"(",")",["T_OBJECT_OPERATOR","->",126],["T_STRING","getNode",126],"(",["T_CONSTANT_ENCAPSED_STRING","'modules\/Enterprise_Pbridge'",126],")",")",")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n\n            ",126],["T_VARIABLE","$pbBlockRenderer",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'xmlconnect\/checkout_payment_method_'",128],";",["T_WHITESPACE","\n            ",128],["T_VARIABLE","$pbBlockName",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","'xmlconnect.checkout.payment.method.'",129],";",["T_WHITESPACE","\n\n            ",129],["T_FOREACH","foreach",131],["T_WHITESPACE"," ",131],"(",["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","_pbridgeMethodArray",131],["T_WHITESPACE"," ",131],["T_AS","as",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$block",131],")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n                ",131],["T_VARIABLE","$currentBlockRenderer",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_VARIABLE","$pbBlockRenderer",132],["T_WHITESPACE"," ",132],".",["T_WHITESPACE"," ",132],["T_VARIABLE","$block",132],";",["T_WHITESPACE","\n                ",132],["T_VARIABLE","$currentBlockName",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_VARIABLE","$pbBlockName",133],["T_WHITESPACE"," ",133],".",["T_WHITESPACE"," ",133],["T_VARIABLE","$block",133],";",["T_WHITESPACE","\n                ",133],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","getLayout",134],"(",")",["T_OBJECT_OPERATOR","->",134],["T_STRING","addBlock",134],"(",["T_VARIABLE","$currentBlockRenderer",134],",",["T_WHITESPACE"," ",134],["T_VARIABLE","$currentBlockName",134],")",";",["T_WHITESPACE","\n                ",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","setChild",135],"(",["T_VARIABLE","$block",135],",",["T_WHITESPACE"," ",135],["T_VARIABLE","$currentBlockName",135],")",";",["T_WHITESPACE","\n            ",135],"}",["T_WHITESPACE","\n            ",136],["T_VARIABLE","$methodArray",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_VARIABLE","$methodArray",137],["T_WHITESPACE"," ",137],"+",["T_WHITESPACE"," ",137],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","_pbridgeMethodArray",137],";",["T_WHITESPACE","\n        ",137],"}",["T_WHITESPACE","\n        ",138],["T_RETURN","return",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$methodArray",139],";",["T_WHITESPACE","\n    ",139],"}",["T_WHITESPACE","\n\n    ",140],["T_DOC_COMMENT","\/**\n     * Render payment methods xml\n     *\n     * @return string\n     *\/",142],["T_WHITESPACE","\n    ",146],["T_PROTECTED","protected",147],["T_WHITESPACE"," ",147],["T_FUNCTION","function",147],["T_WHITESPACE"," ",147],["T_STRING","_toHtml",147],"(",")",["T_WHITESPACE","\n    ",147],"{",["T_WHITESPACE","\n        ",148],["T_DOC_COMMENT","\/** @var $methodsXmlObj Mage_XmlConnect_Model_Simplexml_Element *\/",149],["T_WHITESPACE","\n        ",149],["T_VARIABLE","$methodsXmlObj",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_STRING","Mage",150],["T_DOUBLE_COLON","::",150],["T_STRING","getModel",150],"(",["T_CONSTANT_ENCAPSED_STRING","'xmlconnect\/simplexml_element'",150],",",["T_WHITESPACE"," ",150],["T_CONSTANT_ENCAPSED_STRING","'<payment_methods><\/payment_methods>'",150],")",";",["T_WHITESPACE","\n\n        ",150],["T_IF","if",152],["T_WHITESPACE"," ",152],"(",["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","_addGiftCard",152],"(",["T_VARIABLE","$methodsXmlObj",152],")",")",["T_WHITESPACE"," ",152],"{",["T_WHITESPACE","\n            ",152],["T_RETURN","return",153],["T_WHITESPACE"," ",153],["T_VARIABLE","$methodsXmlObj",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","asNiceXml",153],"(",")",";",["T_WHITESPACE","\n        ",153],"}",["T_WHITESPACE","\n\n        ",154],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","addCustomerBalanceToXmlObj",156],"(",["T_VARIABLE","$methodsXmlObj",156],")",["T_OBJECT_OPERATOR","->",156],["T_STRING","_buildPaymentMethods",156],"(",["T_VARIABLE","$methodsXmlObj",156],")",";",["T_WHITESPACE","\n        ",156],["T_RETURN","return",157],["T_WHITESPACE"," ",157],["T_VARIABLE","$methodsXmlObj",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","asNiceXml",157],"(",")",";",["T_WHITESPACE","\n    ",157],"}",["T_WHITESPACE","\n\n    ",158],["T_DOC_COMMENT","\/**\n     * Add free payment method xml to payment method list\n     *\n     * @param Mage_XmlConnect_Model_Simplexml_Element $methodsXmlObj\n     * @return Mage_XmlConnect_Block_Checkout_Payment_Method_List\n     *\/",160],["T_WHITESPACE","\n    ",165],["T_PROTECTED","protected",166],["T_WHITESPACE"," ",166],["T_FUNCTION","function",166],["T_WHITESPACE"," ",166],["T_STRING","_addFreePaymentToXmlObj",166],"(",["T_STRING","Mage_XmlConnect_Model_Simplexml_Element",166],["T_WHITESPACE"," ",166],["T_VARIABLE","$methodsXmlObj",166],")",["T_WHITESPACE","\n    ",166],"{",["T_WHITESPACE","\n        ",167],["T_VARIABLE","$methodsXmlObj",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","addCustomChild",168],"(",["T_CONSTANT_ENCAPSED_STRING","'method'",168],",",["T_WHITESPACE"," ",168],["T_STRING","null",168],",",["T_WHITESPACE"," ",168],["T_ARRAY","array",168],"(",["T_WHITESPACE","\n            ",168],["T_CONSTANT_ENCAPSED_STRING","'id'",169],["T_WHITESPACE"," ",169],["T_DOUBLE_ARROW","=>",169],["T_WHITESPACE"," ",169],["T_CONSTANT_ENCAPSED_STRING","'free'",169],",",["T_WHITESPACE","\n            ",169],["T_CONSTANT_ENCAPSED_STRING","'code'",170],["T_WHITESPACE"," ",170],["T_DOUBLE_ARROW","=>",170],["T_WHITESPACE"," ",170],["T_CONSTANT_ENCAPSED_STRING","'free'",170],",",["T_WHITESPACE","\n            ",170],["T_CONSTANT_ENCAPSED_STRING","'post_name'",171],["T_WHITESPACE"," ",171],["T_DOUBLE_ARROW","=>",171],["T_WHITESPACE"," ",171],["T_CONSTANT_ENCAPSED_STRING","'payment[method]'",171],",",["T_WHITESPACE","\n            ",171],["T_CONSTANT_ENCAPSED_STRING","'label'",172],["T_WHITESPACE"," ",172],["T_DOUBLE_ARROW","=>",172],["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","__",172],"(",["T_CONSTANT_ENCAPSED_STRING","'No Payment Information Required'",172],")",",",["T_WHITESPACE","\n            ",172],["T_CONSTANT_ENCAPSED_STRING","'selected'",173],["T_WHITESPACE"," ",173],["T_DOUBLE_ARROW","=>",173],["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","'1'",173],",",["T_WHITESPACE","\n            ",173],["T_CONSTANT_ENCAPSED_STRING","'disabled'",174],["T_WHITESPACE"," ",174],["T_DOUBLE_ARROW","=>",174],["T_WHITESPACE"," ",174],["T_CONSTANT_ENCAPSED_STRING","'1'",174],["T_WHITESPACE","\n        ",174],")",")",";",["T_WHITESPACE","\n        ",175],["T_RETURN","return",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$this",176],";",["T_WHITESPACE","\n    ",176],"}",["T_WHITESPACE","\n\n    ",177],["T_DOC_COMMENT","\/**\n     * Check and prepare payment method model\n     *\n     * @param mixed $method\n     * @return bool\n     *\/",179],["T_WHITESPACE","\n    ",184],["T_PROTECTED","protected",185],["T_WHITESPACE"," ",185],["T_FUNCTION","function",185],["T_WHITESPACE"," ",185],["T_STRING","_canUseMethod",185],"(",["T_VARIABLE","$method",185],")",["T_WHITESPACE","\n    ",185],"{",["T_WHITESPACE","\n        ",186],["T_IF","if",187],["T_WHITESPACE"," ",187],"(","!","(",["T_VARIABLE","$method",187],["T_WHITESPACE"," ",187],["T_INSTANCEOF","instanceof",187],["T_WHITESPACE"," ",187],["T_STRING","Mage_Payment_Model_Method_Abstract",187],")",["T_WHITESPACE"," ",187],["T_BOOLEAN_OR","||",187],["T_WHITESPACE"," ",187],"!",["T_VARIABLE","$method",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","canUseCheckout",187],"(",")",["T_WHITESPACE","\n            ",187],["T_BOOLEAN_OR","||",188],["T_WHITESPACE"," ",188],"!",["T_VARIABLE","$method",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","isAvailable",188],"(",["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getQuote",188],"(",")",")",["T_WHITESPACE","\n        ",188],")",["T_WHITESPACE"," ",189],"{",["T_WHITESPACE","\n            ",189],["T_RETURN","return",190],["T_WHITESPACE"," ",190],["T_STRING","false",190],";",["T_WHITESPACE","\n        ",190],"}",["T_WHITESPACE","\n        ",191],["T_RETURN","return",192],["T_WHITESPACE"," ",192],["T_STRING","parent",192],["T_DOUBLE_COLON","::",192],["T_STRING","_canUseMethod",192],"(",["T_VARIABLE","$method",192],")",";",["T_WHITESPACE","\n    ",192],"}",["T_WHITESPACE","\n\n    ",193],["T_DOC_COMMENT","\/**\n     * Add gift card info to xml and check is covered a quote\n     *\n     * @param Mage_XmlConnect_Model_Simplexml_Element $methodsXmlObj\n     * @return bool\n     *\/",195],["T_WHITESPACE","\n    ",200],["T_PROTECTED","protected",201],["T_WHITESPACE"," ",201],["T_FUNCTION","function",201],["T_WHITESPACE"," ",201],["T_STRING","_addGiftCard",201],"(",["T_STRING","Mage_XmlConnect_Model_Simplexml_Element",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$methodsXmlObj",201],")",["T_WHITESPACE","\n    ",201],"{",["T_WHITESPACE","\n        ",202],["T_IF","if",203],["T_WHITESPACE"," ",203],"(",["T_STRING","is_object",203],"(",["T_STRING","Mage",203],["T_DOUBLE_COLON","::",203],["T_STRING","getConfig",203],"(",")",["T_OBJECT_OPERATOR","->",203],["T_STRING","getNode",203],"(",["T_CONSTANT_ENCAPSED_STRING","'modules\/Enterprise_GiftCardAccount'",203],")",")",")",["T_WHITESPACE"," ",203],"{",["T_WHITESPACE","\n            ",203],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","addGiftcardToXmlObj",204],"(",["T_VARIABLE","$methodsXmlObj",204],")",";",["T_WHITESPACE","\n            ",204],["T_IF","if",205],["T_WHITESPACE"," ",205],"(",["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","getIsUsedGiftCard",205],"(",")",["T_WHITESPACE"," ",205],["T_BOOLEAN_AND","&&",205],["T_WHITESPACE"," ",205],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","_isPaymentRequired",205],"(",")",")",["T_WHITESPACE"," ",205],"{",["T_WHITESPACE","\n                ",205],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","_addFreePaymentToXmlObj",206],"(",["T_VARIABLE","$methodsXmlObj",206],")",";",["T_WHITESPACE","\n                ",206],["T_RETURN","return",207],["T_WHITESPACE"," ",207],["T_STRING","true",207],";",["T_WHITESPACE","\n            ",207],"}",["T_WHITESPACE","\n        ",208],"}",["T_WHITESPACE","\n        ",209],["T_RETURN","return",210],["T_WHITESPACE"," ",210],["T_STRING","false",210],";",["T_WHITESPACE","\n    ",210],"}",["T_WHITESPACE","\n\n    ",211],["T_DOC_COMMENT","\/**\n     * Add customer balance details to XML object\n     *\n     * @param Mage_XmlConnect_Model_Simplexml_Element $methodsXmlObj\n     * @return Mage_XmlConnect_Block_Checkout_Payment_Method_List\n     *\/",213],["T_WHITESPACE","\n    ",218],["T_PUBLIC","public",219],["T_WHITESPACE"," ",219],["T_FUNCTION","function",219],["T_WHITESPACE"," ",219],["T_STRING","addCustomerBalanceToXmlObj",219],"(",["T_STRING","Mage_XmlConnect_Model_Simplexml_Element",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$methodsXmlObj",219],")",["T_WHITESPACE","\n    ",219],"{",["T_WHITESPACE","\n        ",220],["T_IF","if",221],["T_WHITESPACE"," ",221],"(",["T_STRING","is_object",221],"(",["T_STRING","Mage",221],["T_DOUBLE_COLON","::",221],["T_STRING","getConfig",221],"(",")",["T_OBJECT_OPERATOR","->",221],["T_STRING","getNode",221],"(",["T_CONSTANT_ENCAPSED_STRING","'modules\/Enterprise_CustomerBalance'",221],")",")",")",["T_WHITESPACE"," ",221],"{",["T_WHITESPACE","\n            ",221],["T_DOC_COMMENT","\/** @var $customerBalanceBlock Enterprise_CustomerBalance_Block_Checkout_Onepage_Payment_Additional *\/",222],["T_WHITESPACE","\n            ",222],["T_VARIABLE","$customerBalanceBlock",223],["T_WHITESPACE"," ",223],"=",["T_WHITESPACE"," ",223],["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","getLayout",223],"(",")",["T_WHITESPACE","\n                ",223],["T_OBJECT_OPERATOR","->",224],["T_STRING","addBlock",224],"(",["T_CONSTANT_ENCAPSED_STRING","'enterprise_customerbalance\/checkout_onepage_payment_additional'",224],",",["T_WHITESPACE"," ",224],["T_CONSTANT_ENCAPSED_STRING","'customer_balance'",224],")",";",["T_WHITESPACE","\n            ",224],["T_VARIABLE","$storeCreditFlag",225],["T_WHITESPACE"," ",225],"=",["T_WHITESPACE"," ",225],["T_INT_CAST","(int)",225],["T_WHITESPACE"," ",225],["T_STRING","Mage",225],["T_DOUBLE_COLON","::",225],["T_STRING","getStoreConfig",225],"(",["T_STRING","Enterprise_CustomerBalance_Helper_Data",225],["T_DOUBLE_COLON","::",225],["T_STRING","XML_PATH_ENABLED",225],")",";",["T_WHITESPACE","\n            ",225],["T_IF","if",226],["T_WHITESPACE"," ",226],"(",["T_VARIABLE","$storeCreditFlag",226],["T_WHITESPACE"," ",226],["T_BOOLEAN_AND","&&",226],["T_WHITESPACE"," ",226],["T_VARIABLE","$customerBalanceBlock",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","isDisplayContainer",226],"(",")",")",["T_WHITESPACE"," ",226],"{",["T_WHITESPACE","\n                ",226],["T_VARIABLE","$balance",227],["T_WHITESPACE"," ",227],"=",["T_WHITESPACE"," ",227],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","getQuote",227],"(",")",["T_OBJECT_OPERATOR","->",227],["T_STRING","getStore",227],"(",")",["T_OBJECT_OPERATOR","->",227],["T_STRING","formatPrice",227],"(",["T_VARIABLE","$customerBalanceBlock",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","getBalance",227],"(",")",",",["T_WHITESPACE"," ",227],["T_STRING","false",227],")",";",["T_WHITESPACE","\n                ",227],["T_VARIABLE","$methodsXmlObj",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","addCustomChild",228],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_balance'",228],",",["T_WHITESPACE"," ",228],["T_STRING","null",228],",",["T_WHITESPACE"," ",228],["T_ARRAY","array",228],"(",["T_WHITESPACE","\n                    ",228],["T_CONSTANT_ENCAPSED_STRING","'post_name'",229],["T_WHITESPACE"," ",229],["T_DOUBLE_ARROW","=>",229],["T_WHITESPACE"," ",229],["T_CONSTANT_ENCAPSED_STRING","'payment[use_customer_balance]'",229],",",["T_WHITESPACE","\n                    ",229],["T_CONSTANT_ENCAPSED_STRING","'code'",230],["T_WHITESPACE","      ",230],["T_DOUBLE_ARROW","=>",230],["T_WHITESPACE"," ",230],["T_LNUMBER","1",230],",",["T_WHITESPACE","\n                    ",230],["T_CONSTANT_ENCAPSED_STRING","'label'",231],["T_WHITESPACE","     ",231],["T_DOUBLE_ARROW","=>",231],["T_WHITESPACE"," ",231],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","__",231],"(",["T_CONSTANT_ENCAPSED_STRING","'Use Store Credit (%s available)'",231],",",["T_WHITESPACE"," ",231],["T_VARIABLE","$balance",231],")",",",["T_WHITESPACE","\n                    ",231],["T_CONSTANT_ENCAPSED_STRING","'is_cover_a_quote'",232],["T_WHITESPACE"," ",232],["T_DOUBLE_ARROW","=>",232],["T_WHITESPACE"," ",232],["T_STRING","intval",232],"(",["T_VARIABLE","$customerBalanceBlock",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","isFullyPaidAfterApplication",232],"(",")",")",",",["T_WHITESPACE","\n                    ",232],["T_CONSTANT_ENCAPSED_STRING","'selected'",233],["T_WHITESPACE","  ",233],["T_DOUBLE_ARROW","=>",233],["T_WHITESPACE"," ",233],["T_STRING","intval",233],"(",["T_VARIABLE","$customerBalanceBlock",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","isCustomerBalanceUsed",233],"(",")",")",["T_WHITESPACE","\n                ",233],")",")",";",["T_WHITESPACE","\n            ",234],"}",["T_WHITESPACE","\n        ",235],"}",["T_WHITESPACE","\n        ",236],["T_RETURN","return",237],["T_WHITESPACE"," ",237],["T_VARIABLE","$this",237],";",["T_WHITESPACE","\n    ",237],"}",["T_WHITESPACE","\n\n    ",238],["T_DOC_COMMENT","\/**\n     * Add payment methods info to xml object\n     *\n     * @throw Mage_Core_Exception\n     * @param Mage_XmlConnect_Model_Simplexml_Element $methodsXmlObj\n     * @return Mage_XmlConnect_Block_Checkout_Payment_Method_List\n     *\/",240],["T_WHITESPACE","\n    ",246],["T_PROTECTED","protected",247],["T_WHITESPACE"," ",247],["T_FUNCTION","function",247],["T_WHITESPACE"," ",247],["T_STRING","_buildPaymentMethods",247],"(",["T_STRING","Mage_XmlConnect_Model_Simplexml_Element",247],["T_WHITESPACE"," ",247],["T_VARIABLE","$methodsXmlObj",247],")",["T_WHITESPACE","\n    ",247],"{",["T_WHITESPACE","\n        ",248],["T_VARIABLE","$methodArray",249],["T_WHITESPACE"," ",249],"=",["T_WHITESPACE"," ",249],["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","_getPaymentMethodArray",249],"(",")",";",["T_WHITESPACE","\n        ",249],["T_VARIABLE","$usedMethods",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_VARIABLE","$sortedAvailableMethodCodes",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_VARIABLE","$usedCodes",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_ARRAY","array",250],"(",")",";",["T_WHITESPACE","\n\n        ",250],["T_DOC_COMMENT","\/**\n         * Receive available methods for checkout\n         *\/",252],["T_WHITESPACE","\n        ",254],["T_VARIABLE","$allAvailableMethods",255],["T_WHITESPACE","  ",255],"=",["T_WHITESPACE"," ",255],["T_STRING","Mage",255],["T_DOUBLE_COLON","::",255],["T_STRING","helper",255],"(",["T_CONSTANT_ENCAPSED_STRING","'payment'",255],")",["T_OBJECT_OPERATOR","->",255],["T_STRING","getStoreMethods",255],"(",["T_WHITESPACE","\n            ",255],["T_STRING","Mage",256],["T_DOUBLE_COLON","::",256],["T_STRING","app",256],"(",")",["T_OBJECT_OPERATOR","->",256],["T_STRING","getStore",256],"(",")",",",["T_WHITESPACE"," ",256],["T_VARIABLE","$this",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","getQuote",256],"(",")",["T_WHITESPACE","\n        ",256],")",";",["T_WHITESPACE","\n\n        ",257],["T_VARIABLE","$total",259],["T_WHITESPACE"," ",259],"=",["T_WHITESPACE"," ",259],["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","getQuote",259],"(",")",["T_OBJECT_OPERATOR","->",259],["T_STRING","getGrandTotal",259],"(",")",";",["T_WHITESPACE","\n        ",259],["T_FOREACH","foreach",260],["T_WHITESPACE"," ",260],"(",["T_VARIABLE","$allAvailableMethods",260],["T_WHITESPACE"," ",260],["T_AS","as",260],["T_WHITESPACE"," ",260],["T_VARIABLE","$key",260],["T_WHITESPACE"," ",260],["T_DOUBLE_ARROW","=>",260],["T_WHITESPACE"," ",260],["T_VARIABLE","$method",260],")",["T_WHITESPACE"," ",260],"{",["T_WHITESPACE","\n            ",260],["T_IF","if",261],["T_WHITESPACE"," ",261],"(",["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","_canUseMethod",261],"(",["T_VARIABLE","$method",261],")",["T_WHITESPACE"," ",261],["T_BOOLEAN_AND","&&",261],["T_WHITESPACE"," ",261],"(",["T_VARIABLE","$total",261],["T_WHITESPACE"," ",261],["T_IS_NOT_EQUAL","!=",261],["T_WHITESPACE"," ",261],["T_LNUMBER","0",261],["T_WHITESPACE"," ",261],["T_BOOLEAN_OR","||",261],["T_WHITESPACE"," ",261],["T_VARIABLE","$method",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","getCode",261],"(",")",["T_WHITESPACE"," ",261],["T_IS_EQUAL","==",261],["T_WHITESPACE"," ",261],["T_CONSTANT_ENCAPSED_STRING","'free'",261],["T_WHITESPACE","\n                ",261],["T_BOOLEAN_OR","||",262],["T_WHITESPACE"," ",262],"(",["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","getQuote",262],"(",")",["T_OBJECT_OPERATOR","->",262],["T_STRING","hasRecurringItems",262],"(",")",["T_WHITESPACE"," ",262],["T_BOOLEAN_AND","&&",262],["T_WHITESPACE"," ",262],["T_VARIABLE","$method",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","canManageRecurringProfiles",262],"(",")",")",")",["T_WHITESPACE","\n            ",262],")",["T_WHITESPACE"," ",263],"{",["T_WHITESPACE","\n                ",263],["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","_assignMethod",264],"(",["T_VARIABLE","$method",264],")",";",["T_WHITESPACE","\n            ",264],"}",["T_WHITESPACE"," ",265],["T_ELSE","else",265],["T_WHITESPACE"," ",265],"{",["T_WHITESPACE","\n                ",265],["T_UNSET","unset",266],"(",["T_VARIABLE","$allAvailableMethods",266],"[",["T_VARIABLE","$key",266],"]",")",";",["T_WHITESPACE","\n            ",266],"}",["T_WHITESPACE","\n        ",267],"}",["T_WHITESPACE","\n\n        ",268],["T_DOC_COMMENT","\/**\n         * Get sorted codes of available methods\n         *\/",270],["T_WHITESPACE","\n        ",272],["T_FOREACH","foreach",273],["T_WHITESPACE"," ",273],"(",["T_VARIABLE","$allAvailableMethods",273],["T_WHITESPACE"," ",273],["T_AS","as",273],["T_WHITESPACE"," ",273],["T_VARIABLE","$method",273],")",["T_WHITESPACE"," ",273],"{",["T_WHITESPACE","\n            ",273],["T_VARIABLE","$sortedAvailableMethodCodes",274],"[","]",["T_WHITESPACE"," ",274],"=",["T_WHITESPACE"," ",274],["T_VARIABLE","$method",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","getCode",274],"(",")",";",["T_WHITESPACE","\n        ",274],"}",["T_WHITESPACE","\n\n        ",275],["T_DOC_COMMENT","\/**\n         * Get blocks for layout to check available renderers\n         *\/",277],["T_WHITESPACE","\n        ",279],["T_VARIABLE","$methodBlocks",280],["T_WHITESPACE"," ",280],"=",["T_WHITESPACE"," ",280],["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","getChild",280],"(",")",";",["T_WHITESPACE","\n\n        ",280],["T_DOC_COMMENT","\/**\n         * Collect directly supported by xmlconnect methods\n         *\/",282],["T_WHITESPACE","\n        ",284],["T_IF","if",285],["T_WHITESPACE"," ",285],"(","!",["T_EMPTY","empty",285],"(",["T_VARIABLE","$methodBlocks",285],")",["T_WHITESPACE"," ",285],["T_BOOLEAN_AND","&&",285],["T_WHITESPACE"," ",285],["T_STRING","is_array",285],"(",["T_VARIABLE","$methodBlocks",285],")",")",["T_WHITESPACE"," ",285],"{",["T_WHITESPACE","\n            ",285],["T_FOREACH","foreach",286],["T_WHITESPACE"," ",286],"(",["T_VARIABLE","$methodBlocks",286],["T_WHITESPACE"," ",286],["T_AS","as",286],["T_WHITESPACE"," ",286],["T_VARIABLE","$block",286],")",["T_WHITESPACE"," ",286],"{",["T_WHITESPACE","\n                ",286],["T_IF","if",287],["T_WHITESPACE"," ",287],"(","!",["T_VARIABLE","$block",287],")",["T_WHITESPACE"," ",287],"{",["T_WHITESPACE","\n                    ",287],["T_CONTINUE","continue",288],";",["T_WHITESPACE","\n                ",288],"}",["T_WHITESPACE","\n                ",289],["T_VARIABLE","$method",290],["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],["T_VARIABLE","$block",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","getMethod",290],"(",")",";",["T_WHITESPACE","\n                ",290],["T_IF","if",291],["T_WHITESPACE"," ",291],"(","!",["T_VARIABLE","$this",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","_canUseMethod",291],"(",["T_VARIABLE","$method",291],")",["T_WHITESPACE"," ",291],["T_BOOLEAN_OR","||",291],["T_WHITESPACE"," ",291],["T_STRING","in_array",291],"(",["T_VARIABLE","$method",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","getCode",291],"(",")",",",["T_WHITESPACE"," ",291],["T_VARIABLE","$usedCodes",291],")",")",["T_WHITESPACE"," ",291],"{",["T_WHITESPACE","\n                    ",291],["T_CONTINUE","continue",292],";",["T_WHITESPACE","\n                ",292],"}",["T_WHITESPACE","\n                ",293],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","_assignMethod",294],"(",["T_VARIABLE","$method",294],")",";",["T_WHITESPACE","\n                ",294],["T_VARIABLE","$usedCodes",295],"[","]",["T_WHITESPACE"," ",295],"=",["T_WHITESPACE"," ",295],["T_VARIABLE","$method",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","getCode",295],"(",")",";",["T_WHITESPACE","\n                ",295],["T_VARIABLE","$usedMethods",296],"[",["T_VARIABLE","$method",296],["T_OBJECT_OPERATOR","->",296],["T_STRING","getCode",296],"(",")","]",["T_WHITESPACE"," ",296],"=",["T_WHITESPACE"," ",296],["T_ARRAY","array",296],"(",["T_CONSTANT_ENCAPSED_STRING","'renderer'",296],["T_WHITESPACE"," ",296],["T_DOUBLE_ARROW","=>",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$block",296],",",["T_WHITESPACE"," ",296],["T_CONSTANT_ENCAPSED_STRING","'method'",296],["T_WHITESPACE"," ",296],["T_DOUBLE_ARROW","=>",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$method",296],")",";",["T_WHITESPACE","\n            ",296],"}",["T_WHITESPACE","\n        ",297],"}",["T_WHITESPACE","\n\n        ",298],["T_DOC_COMMENT","\/**\n         * Collect all \"Credit Card\" \/ \"CheckMo\" \/ \"Purchaseorder\" method compatible methods\n         *\/",300],["T_WHITESPACE","\n        ",302],["T_FOREACH","foreach",303],["T_WHITESPACE"," ",303],"(",["T_VARIABLE","$methodArray",303],["T_WHITESPACE"," ",303],["T_AS","as",303],["T_WHITESPACE"," ",303],["T_VARIABLE","$methodName",303],["T_WHITESPACE"," ",303],["T_DOUBLE_ARROW","=>",303],["T_WHITESPACE"," ",303],["T_VARIABLE","$methodModelClassName",303],")",["T_WHITESPACE"," ",303],"{",["T_WHITESPACE","\n            ",303],["T_VARIABLE","$methodRenderer",304],["T_WHITESPACE"," ",304],"=",["T_WHITESPACE"," ",304],["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","getChild",304],"(",["T_VARIABLE","$methodName",304],")",";",["T_WHITESPACE","\n            ",304],["T_IF","if",305],["T_WHITESPACE"," ",305],"(","!",["T_EMPTY","empty",305],"(",["T_VARIABLE","$methodRenderer",305],")",")",["T_WHITESPACE"," ",305],"{",["T_WHITESPACE","\n                ",305],["T_FOREACH","foreach",306],["T_WHITESPACE"," ",306],"(",["T_VARIABLE","$sortedAvailableMethodCodes",306],["T_WHITESPACE"," ",306],["T_AS","as",306],["T_WHITESPACE"," ",306],["T_VARIABLE","$methodCode",306],")",["T_WHITESPACE"," ",306],"{",["T_WHITESPACE","\n                    ",306],["T_DOC_COMMENT","\/**\n                     * Skip used methods\n                     *\/",307],["T_WHITESPACE","\n                    ",309],["T_IF","if",310],["T_WHITESPACE"," ",310],"(",["T_STRING","in_array",310],"(",["T_VARIABLE","$methodCode",310],",",["T_WHITESPACE"," ",310],["T_VARIABLE","$usedCodes",310],")",")",["T_WHITESPACE"," ",310],"{",["T_WHITESPACE","\n                        ",310],["T_CONTINUE","continue",311],";",["T_WHITESPACE","\n                    ",311],"}",["T_WHITESPACE","\n                    ",312],["T_TRY","try",313],["T_WHITESPACE"," ",313],"{",["T_WHITESPACE","\n                        ",313],["T_VARIABLE","$method",314],["T_WHITESPACE"," ",314],"=",["T_WHITESPACE"," ",314],["T_STRING","Mage",314],["T_DOUBLE_COLON","::",314],["T_STRING","helper",314],"(",["T_CONSTANT_ENCAPSED_STRING","'payment'",314],")",["T_OBJECT_OPERATOR","->",314],["T_STRING","getMethodInstance",314],"(",["T_VARIABLE","$methodCode",314],")",";",["T_WHITESPACE","\n                        ",314],["T_IF","if",315],["T_WHITESPACE"," ",315],"(","!",["T_STRING","is_subclass_of",315],"(",["T_VARIABLE","$method",315],",",["T_WHITESPACE"," ",315],["T_VARIABLE","$methodModelClassName",315],")",")",["T_WHITESPACE"," ",315],"{",["T_WHITESPACE","\n                            ",315],["T_CONTINUE","continue",316],";",["T_WHITESPACE","\n                        ",316],"}",["T_WHITESPACE","\n                        ",317],["T_IF","if",318],["T_WHITESPACE"," ",318],"(","!",["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","_canUseMethod",318],"(",["T_VARIABLE","$method",318],")",")",["T_WHITESPACE"," ",318],"{",["T_WHITESPACE","\n                            ",318],["T_CONTINUE","continue",319],";",["T_WHITESPACE","\n                        ",319],"}",["T_WHITESPACE","\n\n                        ",320],["T_VARIABLE","$this",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","_assignMethod",322],"(",["T_VARIABLE","$method",322],")",";",["T_WHITESPACE","\n                        ",322],["T_VARIABLE","$usedCodes",323],"[","]",["T_WHITESPACE"," ",323],"=",["T_WHITESPACE"," ",323],["T_VARIABLE","$method",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","getCode",323],"(",")",";",["T_WHITESPACE","\n                        ",323],["T_VARIABLE","$usedMethods",324],"[",["T_VARIABLE","$method",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","getCode",324],"(",")","]",["T_WHITESPACE"," ",324],"=",["T_WHITESPACE"," ",324],["T_ARRAY","array",324],"(",["T_CONSTANT_ENCAPSED_STRING","'renderer'",324],["T_WHITESPACE"," ",324],["T_DOUBLE_ARROW","=>",324],["T_WHITESPACE"," ",324],["T_VARIABLE","$methodRenderer",324],",",["T_WHITESPACE"," ",324],["T_CONSTANT_ENCAPSED_STRING","'method'",324],["T_WHITESPACE"," ",324],["T_DOUBLE_ARROW","=>",324],["T_WHITESPACE"," ",324],["T_VARIABLE","$method",324],")",";",["T_WHITESPACE","\n                    ",324],"}",["T_WHITESPACE"," ",325],["T_CATCH","catch",325],["T_WHITESPACE"," ",325],"(",["T_STRING","Exception",325],["T_WHITESPACE"," ",325],["T_VARIABLE","$e",325],")",["T_WHITESPACE"," ",325],"{",["T_WHITESPACE","\n                        ",325],["T_STRING","Mage",326],["T_DOUBLE_COLON","::",326],["T_STRING","logException",326],"(",["T_VARIABLE","$e",326],")",";",["T_WHITESPACE","\n                    ",326],"}",["T_WHITESPACE","\n                ",327],"}",["T_WHITESPACE","\n            ",328],"}",["T_WHITESPACE","\n        ",329],"}",["T_WHITESPACE","\n\n        ",330],["T_DOC_COMMENT","\/**\n         * Generate methods XML according to sort order\n         *\/",332],["T_WHITESPACE","\n        ",334],["T_FOREACH","foreach",335],["T_WHITESPACE"," ",335],"(",["T_VARIABLE","$sortedAvailableMethodCodes",335],["T_WHITESPACE"," ",335],["T_AS","as",335],["T_WHITESPACE"," ",335],["T_VARIABLE","$code",335],")",["T_WHITESPACE"," ",335],"{",["T_WHITESPACE","\n            ",335],["T_IF","if",336],["T_WHITESPACE"," ",336],"(","!",["T_STRING","in_array",336],"(",["T_VARIABLE","$code",336],",",["T_WHITESPACE"," ",336],["T_VARIABLE","$usedCodes",336],")",")",["T_WHITESPACE"," ",336],"{",["T_WHITESPACE","\n                ",336],["T_CONTINUE","continue",337],";",["T_WHITESPACE","\n            ",337],"}",["T_WHITESPACE","\n            ",338],["T_VARIABLE","$method",339],["T_WHITESPACE","   ",339],"=",["T_WHITESPACE"," ",339],["T_VARIABLE","$usedMethods",339],"[",["T_VARIABLE","$code",339],"]","[",["T_CONSTANT_ENCAPSED_STRING","'method'",339],"]",";",["T_WHITESPACE","\n            ",339],["T_VARIABLE","$renderer",340],["T_WHITESPACE"," ",340],"=",["T_WHITESPACE"," ",340],["T_VARIABLE","$usedMethods",340],"[",["T_VARIABLE","$code",340],"]","[",["T_CONSTANT_ENCAPSED_STRING","'renderer'",340],"]",";",["T_WHITESPACE","\n            ",340],["T_DOC_COMMENT","\/**\n             * Render all Credit Card method compatible methods\n             *\/",341],["T_WHITESPACE","\n            ",343],["T_IF","if",344],["T_WHITESPACE"," ",344],"(",["T_VARIABLE","$renderer",344],["T_WHITESPACE"," ",344],["T_INSTANCEOF","instanceOf",344],["T_WHITESPACE"," ",344],["T_STRING","Mage_XmlConnect_Block_Checkout_Payment_Method_Ccsave",344],")",["T_WHITESPACE"," ",344],"{",["T_WHITESPACE","\n                ",344],["T_VARIABLE","$renderer",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","setData",345],"(",["T_CONSTANT_ENCAPSED_STRING","'method'",345],",",["T_WHITESPACE"," ",345],["T_VARIABLE","$method",345],")",";",["T_WHITESPACE","\n            ",345],"}",["T_WHITESPACE","\n\n            ",346],["T_VARIABLE","$options",348],["T_WHITESPACE"," ",348],"=",["T_WHITESPACE"," ",348],["T_ARRAY","array",348],"(",["T_WHITESPACE","\n                ",348],["T_CONSTANT_ENCAPSED_STRING","'id'",349],["T_WHITESPACE"," ",349],["T_DOUBLE_ARROW","=>",349],["T_WHITESPACE"," ",349],["T_VARIABLE","$method",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","getCode",349],"(",")",",",["T_WHITESPACE","\n                ",349],["T_CONSTANT_ENCAPSED_STRING","'code'",350],["T_WHITESPACE"," ",350],["T_DOUBLE_ARROW","=>",350],["T_WHITESPACE"," ",350],["T_VARIABLE","$method",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","getCode",350],"(",")",",",["T_WHITESPACE","\n                ",350],["T_CONSTANT_ENCAPSED_STRING","'post_name'",351],["T_WHITESPACE"," ",351],["T_DOUBLE_ARROW","=>",351],["T_WHITESPACE"," ",351],["T_CONSTANT_ENCAPSED_STRING","'payment[method]'",351],",",["T_WHITESPACE","\n                ",351],["T_CONSTANT_ENCAPSED_STRING","'label'",352],["T_WHITESPACE"," ",352],["T_DOUBLE_ARROW","=>",352],["T_WHITESPACE"," ",352],["T_VARIABLE","$methodsXmlObj",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","escapeXml",352],"(",["T_VARIABLE","$method",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","getTitle",352],"(",")",")",",",["T_WHITESPACE","\n            ",352],")",";",["T_WHITESPACE","\n\n            ",353],["T_IF","if",355],["T_WHITESPACE"," ",355],"(",["T_VARIABLE","$this",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","getQuote",355],"(",")",["T_OBJECT_OPERATOR","->",355],["T_STRING","getPayment",355],"(",")",["T_OBJECT_OPERATOR","->",355],["T_STRING","getMethod",355],"(",")",["T_WHITESPACE"," ",355],["T_IS_EQUAL","==",355],["T_WHITESPACE"," ",355],["T_VARIABLE","$method",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","getCode",355],"(",")",")",["T_WHITESPACE"," ",355],"{",["T_WHITESPACE","\n                ",355],["T_VARIABLE","$options",356],"[",["T_CONSTANT_ENCAPSED_STRING","'selected'",356],"]",["T_WHITESPACE"," ",356],"=",["T_WHITESPACE"," ",356],["T_LNUMBER","1",356],";",["T_WHITESPACE","\n            ",356],"}",["T_WHITESPACE","\n\n            ",357],["T_VARIABLE","$methodItemXmlObj",359],["T_WHITESPACE"," ",359],"=",["T_WHITESPACE"," ",359],["T_VARIABLE","$methodsXmlObj",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","addCustomChild",359],"(",["T_CONSTANT_ENCAPSED_STRING","'method'",359],",",["T_WHITESPACE"," ",359],["T_STRING","null",359],",",["T_WHITESPACE"," ",359],["T_VARIABLE","$options",359],")",";",["T_WHITESPACE","\n            ",359],["T_VARIABLE","$renderer",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","addPaymentFormToXmlObj",360],"(",["T_VARIABLE","$methodItemXmlObj",360],")",";",["T_WHITESPACE","\n        ",360],"}",["T_WHITESPACE","\n\n        ",361],["T_IF","if",363],["T_WHITESPACE"," ",363],"(",["T_STRING","count",363],"(",["T_VARIABLE","$allAvailableMethods",363],")",["T_WHITESPACE"," ",363],["T_IS_EQUAL","==",363],["T_WHITESPACE"," ",363],["T_LNUMBER","1",363],["T_WHITESPACE"," ",363],["T_BOOLEAN_AND","&&",363],["T_WHITESPACE"," ",363],["T_ISSET","isset",363],"(",["T_VARIABLE","$sortedAvailableMethodCodes",363],"[",["T_LNUMBER","0",363],"]",")",["T_WHITESPACE","\n            ",363],["T_BOOLEAN_AND","&&",364],["T_WHITESPACE"," ",364],["T_VARIABLE","$sortedAvailableMethodCodes",364],"[",["T_LNUMBER","0",364],"]",["T_WHITESPACE"," ",364],["T_IS_EQUAL","==",364],["T_WHITESPACE"," ",364],["T_CONSTANT_ENCAPSED_STRING","'free'",364],")",["T_WHITESPACE"," ",364],"{",["T_WHITESPACE","\n            ",364],["T_IF","if",365],["T_WHITESPACE"," ",365],"(",["T_VARIABLE","$this",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","_isPaymentRequired",365],"(",")",")",["T_WHITESPACE"," ",365],"{",["T_WHITESPACE","\n                ",365],["T_VARIABLE","$this",366],["T_OBJECT_OPERATOR","->",366],["T_STRING","_addFreePaymentToXmlObj",366],"(",["T_VARIABLE","$methodsXmlObj",366],")",";",["T_WHITESPACE","\n            ",366],"}",["T_WHITESPACE","\n        ",367],"}",["T_WHITESPACE","\n\n        ",368],["T_IF","if",370],["T_WHITESPACE"," ",370],"(","!",["T_STRING","count",370],"(",["T_VARIABLE","$allAvailableMethods",370],")",")",["T_WHITESPACE"," ",370],"{",["T_WHITESPACE","\n            ",370],["T_STRING","Mage",371],["T_DOUBLE_COLON","::",371],["T_STRING","throwException",371],"(",["T_VARIABLE","$this",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","__",371],"(",["T_CONSTANT_ENCAPSED_STRING","'Your order cannot be completed at this time as there is no payment methods available for it.'",371],")",")",";",["T_WHITESPACE","\n        ",371],"}",["T_WHITESPACE","\n        ",372],["T_RETURN","return",373],["T_WHITESPACE"," ",373],["T_VARIABLE","$this",373],";",["T_WHITESPACE","\n    ",373],"}",["T_WHITESPACE","\n\n    ",374],["T_DOC_COMMENT","\/**\n     * Deprecated function adding Payment method to the xml\n     *\n     * @deprecated after 1.4.2.0\n     * @param Mage_Core_Block_Template $block\n     * @param Mage_XmlConnect_Model_Simplexml_Element $methodsXmlObj\n     * @param array $usedCodes\n     * @return bool\n     *\/",376],["T_WHITESPACE","\n    ",384],["T_PROTECTED","protected",385],["T_WHITESPACE"," ",385],["T_FUNCTION","function",385],["T_WHITESPACE"," ",385],["T_STRING","_addToXml",385],"(",["T_VARIABLE","$block",385],",",["T_WHITESPACE"," ",385],["T_VARIABLE","$methodsXmlObj",385],",",["T_WHITESPACE"," ",385],["T_VARIABLE","$usedCodes",385],")",["T_WHITESPACE","\n    ",385],"{",["T_WHITESPACE","\n        ",386],["T_RETURN","return",387],["T_WHITESPACE"," ",387],["T_STRING","false",387],";",["T_WHITESPACE","\n    ",387],"}",["T_WHITESPACE","\n\n    ",388],["T_DOC_COMMENT","\/**\n     * Deprecated function check method status\n     *\n     * @deprecated after 1.4.2.0\n     * @param Mage_Payment_Model_Method_Abstract $method\n     * @return bool\n     *\/",390],["T_WHITESPACE","\n    ",396],["T_PUBLIC","public",397],["T_WHITESPACE"," ",397],["T_FUNCTION","function",397],["T_WHITESPACE"," ",397],["T_STRING","isAvailable",397],"(",["T_VARIABLE","$method",397],")",["T_WHITESPACE","\n    ",397],"{",["T_WHITESPACE","\n        ",398],["T_RETURN","return",399],["T_WHITESPACE"," ",399],["T_VARIABLE","$method",399],["T_OBJECT_OPERATOR","->",399],["T_STRING","isAvailable",399],"(",["T_VARIABLE","$this",399],["T_OBJECT_OPERATOR","->",399],["T_STRING","getQuote",399],"(",")",")",";",["T_WHITESPACE","\n    ",399],"}",["T_WHITESPACE","\n",400],"}",["T_WHITESPACE","\n",401]]