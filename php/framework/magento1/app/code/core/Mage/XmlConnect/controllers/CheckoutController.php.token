[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_XmlConnect\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * XmlConnect checkout controller\n *\n * @category    Mage\n * @package     Mage_Xmlconnect\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_XmlConnect_CheckoutController",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_XmlConnect_Controller_Action",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Make sure customer is logged in\n     *\n     * @return null\n     *\/",36],["T_WHITESPACE","\n    ",40],["T_PUBLIC","public",41],["T_WHITESPACE"," ",41],["T_FUNCTION","function",41],["T_WHITESPACE"," ",41],["T_STRING","preDispatch",41],"(",")",["T_WHITESPACE","\n    ",41],"{",["T_WHITESPACE","\n        ",42],["T_STRING","parent",43],["T_DOUBLE_COLON","::",43],["T_STRING","preDispatch",43],"(",")",";",["T_WHITESPACE","\n        ",43],["T_IF","if",44],["T_WHITESPACE"," ",44],"(","!",["T_STRING","Mage",44],["T_DOUBLE_COLON","::",44],["T_STRING","getSingleton",44],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",44],")",["T_OBJECT_OPERATOR","->",44],["T_STRING","isLoggedIn",44],"(",")",["T_WHITESPACE","\n            ",44],["T_BOOLEAN_AND","&&",45],["T_WHITESPACE"," ",45],"!",["T_STRING","Mage",45],["T_DOUBLE_COLON","::",45],["T_STRING","getSingleton",45],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/session'",45],")",["T_OBJECT_OPERATOR","->",45],["T_STRING","getQuote",45],"(",")",["T_OBJECT_OPERATOR","->",45],["T_STRING","isAllowedGuestCheckout",45],"(",")",["T_WHITESPACE","\n        ",45],")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n            ",46],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","setFlag",47],"(",["T_CONSTANT_ENCAPSED_STRING","''",47],",",["T_WHITESPACE"," ",47],["T_STRING","self",47],["T_DOUBLE_COLON","::",47],["T_STRING","FLAG_NO_DISPATCH",47],",",["T_WHITESPACE"," ",47],["T_STRING","true",47],")",";",["T_WHITESPACE","\n            ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","_message",48],"(",["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","__",48],"(",["T_CONSTANT_ENCAPSED_STRING","'Customer not logged in.'",48],")",",",["T_WHITESPACE"," ",48],["T_STRING","self",48],["T_DOUBLE_COLON","::",48],["T_STRING","MESSAGE_STATUS_ERROR",48],",",["T_WHITESPACE"," ",48],["T_ARRAY","array",48],"(",["T_WHITESPACE","\n                ",48],["T_CONSTANT_ENCAPSED_STRING","'logged_in'",49],["T_WHITESPACE"," ",49],["T_DOUBLE_ARROW","=>",49],["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'0'",49],["T_WHITESPACE","\n            ",49],")",")",";",["T_WHITESPACE","\n            ",50],["T_RETURN","return",51],["T_WHITESPACE"," ",51],";",["T_WHITESPACE","\n        ",51],"}",["T_WHITESPACE","\n    ",52],"}",["T_WHITESPACE","\n\n    ",53],["T_DOC_COMMENT","\/**\n     * Get one page checkout model\n     *\n     * @return Mage_Checkout_Model_Type_Onepage\n     *\/",55],["T_WHITESPACE","\n    ",59],["T_PUBLIC","public",60],["T_WHITESPACE"," ",60],["T_FUNCTION","function",60],["T_WHITESPACE"," ",60],["T_STRING","getOnepage",60],"(",")",["T_WHITESPACE","\n    ",60],"{",["T_WHITESPACE","\n        ",61],["T_RETURN","return",62],["T_WHITESPACE"," ",62],["T_STRING","Mage",62],["T_DOUBLE_COLON","::",62],["T_STRING","getSingleton",62],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/type_onepage'",62],")",";",["T_WHITESPACE","\n    ",62],"}",["T_WHITESPACE","\n\n    ",63],["T_DOC_COMMENT","\/**\n     * Onepage Checkout page\n     *\n     * @return null\n     *\/",65],["T_WHITESPACE","\n    ",69],["T_PUBLIC","public",70],["T_WHITESPACE"," ",70],["T_FUNCTION","function",70],["T_WHITESPACE"," ",70],["T_STRING","indexAction",70],"(",")",["T_WHITESPACE","\n    ",70],"{",["T_WHITESPACE","\n        ",71],["T_IF","if",72],["T_WHITESPACE"," ",72],"(",["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","_checkApiForward",72],"(",["T_CONSTANT_ENCAPSED_STRING","'addressmassaction'",72],",",["T_WHITESPACE"," ",72],["T_STRING","Mage_XmlConnect_Helper_Data",72],["T_DOUBLE_COLON","::",72],["T_STRING","DEVICE_API_V_23",72],")",")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n            ",72],["T_RETURN","return",73],";",["T_WHITESPACE","\n        ",73],"}",["T_WHITESPACE","\n        ",74],["T_IF","if",75],["T_WHITESPACE"," ",75],"(","!",["T_STRING","Mage",75],["T_DOUBLE_COLON","::",75],["T_STRING","helper",75],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout'",75],")",["T_OBJECT_OPERATOR","->",75],["T_STRING","canOnepageCheckout",75],"(",")",")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n            ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","_message",76],"(",["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","__",76],"(",["T_CONSTANT_ENCAPSED_STRING","'Onepage checkout is disabled.'",76],")",",",["T_WHITESPACE"," ",76],["T_STRING","self",76],["T_DOUBLE_COLON","::",76],["T_STRING","MESSAGE_STATUS_ERROR",76],")",";",["T_WHITESPACE","\n            ",76],["T_RETURN","return",77],";",["T_WHITESPACE","\n        ",77],"}",["T_WHITESPACE","\n        ",78],["T_DOC_COMMENT","\/** @var $quote Mage_Sales_Model_Quote *\/",79],["T_WHITESPACE","\n        ",79],["T_VARIABLE","$quote",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getOnepage",80],"(",")",["T_OBJECT_OPERATOR","->",80],["T_STRING","getQuote",80],"(",")",";",["T_WHITESPACE","\n        ",80],["T_IF","if",81],["T_WHITESPACE"," ",81],"(",["T_VARIABLE","$quote",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getHasError",81],"(",")",")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n            ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","_message",82],"(",["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","__",82],"(",["T_CONSTANT_ENCAPSED_STRING","'Cart has some errors.'",82],")",",",["T_WHITESPACE"," ",82],["T_STRING","self",82],["T_DOUBLE_COLON","::",82],["T_STRING","MESSAGE_STATUS_ERROR",82],")",";",["T_WHITESPACE","\n            ",82],["T_RETURN","return",83],";",["T_WHITESPACE","\n        ",83],"}",["T_WHITESPACE"," ",84],["T_ELSE","else",84],["T_WHITESPACE"," ",84],["T_IF","if",84],["T_WHITESPACE"," ",84],"(","!",["T_VARIABLE","$quote",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","hasItems",84],"(",")",")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n            ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","_message",85],"(",["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","__",85],"(",["T_CONSTANT_ENCAPSED_STRING","'Cart is empty.'",85],")",",",["T_WHITESPACE"," ",85],["T_STRING","self",85],["T_DOUBLE_COLON","::",85],["T_STRING","MESSAGE_STATUS_ERROR",85],")",";",["T_WHITESPACE","\n            ",85],["T_RETURN","return",86],";",["T_WHITESPACE","\n        ",86],"}",["T_WHITESPACE"," ",87],["T_ELSE","else",87],["T_WHITESPACE"," ",87],["T_IF","if",87],["T_WHITESPACE"," ",87],"(","!",["T_VARIABLE","$quote",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","validateMinimumAmount",87],"(",")",")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n            ",87],["T_VARIABLE","$error",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_STRING","Mage",88],["T_DOUBLE_COLON","::",88],["T_STRING","getStoreConfig",88],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/minimum_order\/error_message'",88],")",";",["T_WHITESPACE","\n            ",88],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","_message",89],"(",["T_VARIABLE","$error",89],",",["T_WHITESPACE"," ",89],["T_STRING","self",89],["T_DOUBLE_COLON","::",89],["T_STRING","MESSAGE_STATUS_ERROR",89],")",";",["T_WHITESPACE","\n            ",89],["T_RETURN","return",90],";",["T_WHITESPACE","\n        ",90],"}",["T_WHITESPACE","\n        ",91],["T_STRING","Mage",92],["T_DOUBLE_COLON","::",92],["T_STRING","getSingleton",92],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/session'",92],")",["T_OBJECT_OPERATOR","->",92],["T_STRING","setCartWasUpdated",92],"(",["T_STRING","false",92],")",";",["T_WHITESPACE","\n        ",92],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getOnepage",93],"(",")",["T_OBJECT_OPERATOR","->",93],["T_STRING","initCheckout",93],"(",")",";",["T_WHITESPACE","\n\n        ",93],["T_TRY","try",95],["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n            ",95],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","loadLayout",96],"(",["T_STRING","false",96],")",";",["T_WHITESPACE","\n            ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","renderLayout",97],"(",")",";",["T_WHITESPACE","\n        ",97],"}",["T_WHITESPACE"," ",98],["T_CATCH","catch",98],["T_WHITESPACE"," ",98],"(",["T_STRING","Mage_Core_Exception",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$e",98],")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n            ",98],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","_message",99],"(",["T_VARIABLE","$e",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","getMessage",99],"(",")",",",["T_WHITESPACE"," ",99],["T_STRING","self",99],["T_DOUBLE_COLON","::",99],["T_STRING","MESSAGE_STATUS_ERROR",99],")",";",["T_WHITESPACE","\n        ",99],"}",["T_WHITESPACE"," ",100],["T_CATCH","catch",100],["T_WHITESPACE"," ",100],"(",["T_STRING","Exception",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$e",100],")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n            ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","_message",101],"(",["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","__",101],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to load checkout.'",101],")",",",["T_WHITESPACE"," ",101],["T_STRING","self",101],["T_DOUBLE_COLON","::",101],["T_STRING","MESSAGE_STATUS_ERROR",101],")",";",["T_WHITESPACE","\n            ",101],["T_STRING","Mage",102],["T_DOUBLE_COLON","::",102],["T_STRING","logException",102],"(",["T_VARIABLE","$e",102],")",";",["T_WHITESPACE","\n        ",102],"}",["T_WHITESPACE","\n    ",103],"}",["T_WHITESPACE","\n\n    ",104],["T_DOC_COMMENT","\/**\n     * Display customer new billing address form\n     *\n     * @return null\n     *\/",106],["T_WHITESPACE","\n    ",110],["T_PUBLIC","public",111],["T_WHITESPACE"," ",111],["T_FUNCTION","function",111],["T_WHITESPACE"," ",111],["T_STRING","newBillingAddressFormAction",111],"(",")",["T_WHITESPACE","\n    ",111],"{",["T_WHITESPACE","\n        ",112],["T_TRY","try",113],["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n            ",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","loadLayout",114],"(",["T_STRING","false",114],")",";",["T_WHITESPACE","\n            ",114],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","renderLayout",115],"(",")",";",["T_WHITESPACE","\n        ",115],"}",["T_WHITESPACE"," ",116],["T_CATCH","catch",116],["T_WHITESPACE"," ",116],"(",["T_STRING","Mage_Core_Exception",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$e",116],")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n            ",116],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","_message",117],"(",["T_VARIABLE","$e",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getMessage",117],"(",")",",",["T_WHITESPACE"," ",117],["T_STRING","self",117],["T_DOUBLE_COLON","::",117],["T_STRING","MESSAGE_STATUS_ERROR",117],")",";",["T_WHITESPACE","\n        ",117],"}",["T_WHITESPACE"," ",118],["T_CATCH","catch",118],["T_WHITESPACE"," ",118],"(",["T_STRING","Exception",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$e",118],")",["T_WHITESPACE"," ",118],"{",["T_WHITESPACE","\n            ",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_message",119],"(",["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","__",119],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to load billing address form.'",119],")",",",["T_WHITESPACE"," ",119],["T_STRING","self",119],["T_DOUBLE_COLON","::",119],["T_STRING","MESSAGE_STATUS_ERROR",119],")",";",["T_WHITESPACE","\n            ",119],["T_STRING","Mage",120],["T_DOUBLE_COLON","::",120],["T_STRING","logException",120],"(",["T_VARIABLE","$e",120],")",";",["T_WHITESPACE","\n        ",120],"}",["T_WHITESPACE","\n    ",121],"}",["T_WHITESPACE","\n\n    ",122],["T_DOC_COMMENT","\/**\n     * Display customer new shipping address form\n     *\n     * @return null\n     *\/",124],["T_WHITESPACE","\n    ",128],["T_PUBLIC","public",129],["T_WHITESPACE"," ",129],["T_FUNCTION","function",129],["T_WHITESPACE"," ",129],["T_STRING","newShippingAddressFormAction",129],"(",")",["T_WHITESPACE","\n    ",129],"{",["T_WHITESPACE","\n        ",130],["T_TRY","try",131],["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n            ",131],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","loadLayout",132],"(",["T_STRING","false",132],")",";",["T_WHITESPACE","\n            ",132],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","renderLayout",133],"(",")",";",["T_WHITESPACE","\n        ",133],"}",["T_WHITESPACE"," ",134],["T_CATCH","catch",134],["T_WHITESPACE"," ",134],"(",["T_STRING","Mage_Core_Exception",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$e",134],")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n            ",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","_message",135],"(",["T_VARIABLE","$e",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getMessage",135],"(",")",",",["T_WHITESPACE"," ",135],["T_STRING","self",135],["T_DOUBLE_COLON","::",135],["T_STRING","MESSAGE_STATUS_ERROR",135],")",";",["T_WHITESPACE","\n        ",135],"}",["T_WHITESPACE"," ",136],["T_CATCH","catch",136],["T_WHITESPACE"," ",136],"(",["T_STRING","Exception",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$e",136],")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n            ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","_message",137],"(",["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","__",137],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to load shipping address form.'",137],")",",",["T_WHITESPACE"," ",137],["T_STRING","self",137],["T_DOUBLE_COLON","::",137],["T_STRING","MESSAGE_STATUS_ERROR",137],")",";",["T_WHITESPACE","\n            ",137],["T_STRING","Mage",138],["T_DOUBLE_COLON","::",138],["T_STRING","logException",138],"(",["T_VARIABLE","$e",138],")",";",["T_WHITESPACE","\n        ",138],"}",["T_WHITESPACE","\n    ",139],"}",["T_WHITESPACE","\n\n    ",140],["T_DOC_COMMENT","\/**\n     * Billing addresses list action\n     *\n     * @return null\n     *\/",142],["T_WHITESPACE","\n    ",146],["T_PUBLIC","public",147],["T_WHITESPACE"," ",147],["T_FUNCTION","function",147],["T_WHITESPACE"," ",147],["T_STRING","billingAddressAction",147],"(",")",["T_WHITESPACE","\n    ",147],"{",["T_WHITESPACE","\n        ",148],["T_TRY","try",149],["T_WHITESPACE"," ",149],"{",["T_WHITESPACE","\n            ",149],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","loadLayout",150],"(",["T_STRING","false",150],")",";",["T_WHITESPACE","\n            ",150],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","renderLayout",151],"(",")",";",["T_WHITESPACE","\n        ",151],"}",["T_WHITESPACE"," ",152],["T_CATCH","catch",152],["T_WHITESPACE"," ",152],"(",["T_STRING","Mage_Core_Exception",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$e",152],")",["T_WHITESPACE"," ",152],"{",["T_WHITESPACE","\n            ",152],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","_message",153],"(",["T_VARIABLE","$e",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","getMessage",153],"(",")",",",["T_WHITESPACE"," ",153],["T_STRING","self",153],["T_DOUBLE_COLON","::",153],["T_STRING","MESSAGE_STATUS_ERROR",153],")",";",["T_WHITESPACE","\n        ",153],"}",["T_WHITESPACE"," ",154],["T_CATCH","catch",154],["T_WHITESPACE"," ",154],"(",["T_STRING","Exception",154],["T_WHITESPACE"," ",154],["T_VARIABLE","$e",154],")",["T_WHITESPACE"," ",154],"{",["T_WHITESPACE","\n            ",154],["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","_message",155],"(",["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","__",155],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to load billing address.'",155],")",",",["T_WHITESPACE"," ",155],["T_STRING","self",155],["T_DOUBLE_COLON","::",155],["T_STRING","MESSAGE_STATUS_ERROR",155],")",";",["T_WHITESPACE","\n            ",155],["T_STRING","Mage",156],["T_DOUBLE_COLON","::",156],["T_STRING","logException",156],"(",["T_VARIABLE","$e",156],")",";",["T_WHITESPACE","\n        ",156],"}",["T_WHITESPACE","\n    ",157],"}",["T_WHITESPACE","\n\n    ",158],["T_DOC_COMMENT","\/**\n     * Save billing address to current quote using onepage model\n     *\n     * @return null\n     *\/",160],["T_WHITESPACE","\n    ",164],["T_PUBLIC","public",165],["T_WHITESPACE"," ",165],["T_FUNCTION","function",165],["T_WHITESPACE"," ",165],["T_STRING","saveBillingAddressAction",165],"(",")",["T_WHITESPACE","\n    ",165],"{",["T_WHITESPACE","\n        ",166],["T_IF","if",167],["T_WHITESPACE"," ",167],"(","!",["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","getRequest",167],"(",")",["T_OBJECT_OPERATOR","->",167],["T_STRING","isPost",167],"(",")",")",["T_WHITESPACE"," ",167],"{",["T_WHITESPACE","\n            ",167],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","_message",168],"(",["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","__",168],"(",["T_CONSTANT_ENCAPSED_STRING","'Specified invalid data.'",168],")",",",["T_WHITESPACE"," ",168],["T_STRING","self",168],["T_DOUBLE_COLON","::",168],["T_STRING","MESSAGE_STATUS_ERROR",168],")",";",["T_WHITESPACE","\n            ",168],["T_RETURN","return",169],";",["T_WHITESPACE","\n        ",169],"}",["T_WHITESPACE","\n\n        ",170],["T_VARIABLE","$data",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","getRequest",172],"(",")",["T_OBJECT_OPERATOR","->",172],["T_STRING","getPost",172],"(",["T_CONSTANT_ENCAPSED_STRING","'billing'",172],",",["T_WHITESPACE"," ",172],["T_ARRAY","array",172],"(",")",")",";",["T_WHITESPACE","\n        ",172],["T_VARIABLE","$customerAddressId",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","getRequest",173],"(",")",["T_OBJECT_OPERATOR","->",173],["T_STRING","getPost",173],"(",["T_CONSTANT_ENCAPSED_STRING","'billing_address_id'",173],",",["T_WHITESPACE"," ",173],["T_STRING","false",173],")",";",["T_WHITESPACE","\n        ",173],["T_IF","if",174],["T_WHITESPACE"," ",174],"(",["T_ISSET","isset",174],"(",["T_VARIABLE","$data",174],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",174],"]",")",")",["T_WHITESPACE"," ",174],"{",["T_WHITESPACE","\n            ",174],["T_VARIABLE","$data",175],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",175],"]",["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_STRING","trim",175],"(",["T_VARIABLE","$data",175],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",175],"]",")",";",["T_WHITESPACE","\n        ",175],"}",["T_WHITESPACE","\n        ",176],["T_VARIABLE","$result",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","getOnepage",177],"(",")",["T_OBJECT_OPERATOR","->",177],["T_STRING","saveBilling",177],"(",["T_VARIABLE","$data",177],",",["T_WHITESPACE"," ",177],["T_VARIABLE","$customerAddressId",177],")",";",["T_WHITESPACE","\n        ",177],["T_IF","if",178],["T_WHITESPACE"," ",178],"(","!",["T_ISSET","isset",178],"(",["T_VARIABLE","$result",178],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",178],"]",")",")",["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n            ",178],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","_message",179],"(",["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","__",179],"(",["T_CONSTANT_ENCAPSED_STRING","'Billing address has been set.'",179],")",",",["T_WHITESPACE"," ",179],["T_STRING","self",179],["T_DOUBLE_COLON","::",179],["T_STRING","MESSAGE_STATUS_SUCCESS",179],")",";",["T_WHITESPACE","\n        ",179],"}",["T_WHITESPACE"," ",180],["T_ELSE","else",180],["T_WHITESPACE"," ",180],"{",["T_WHITESPACE","\n            ",180],["T_IF","if",181],["T_WHITESPACE"," ",181],"(","!",["T_STRING","is_array",181],"(",["T_VARIABLE","$result",181],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",181],"]",")",")",["T_WHITESPACE"," ",181],"{",["T_WHITESPACE","\n                ",181],["T_VARIABLE","$result",182],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",182],"]",["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_ARRAY","array",182],"(",["T_VARIABLE","$result",182],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",182],"]",")",";",["T_WHITESPACE","\n            ",182],"}",["T_WHITESPACE","\n            ",183],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","_message",184],"(",["T_STRING","implode",184],"(",["T_CONSTANT_ENCAPSED_STRING","'. '",184],",",["T_WHITESPACE"," ",184],["T_VARIABLE","$result",184],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",184],"]",")",",",["T_WHITESPACE"," ",184],["T_STRING","self",184],["T_DOUBLE_COLON","::",184],["T_STRING","MESSAGE_STATUS_ERROR",184],")",";",["T_WHITESPACE","\n        ",184],"}",["T_WHITESPACE","\n    ",185],"}",["T_WHITESPACE","\n\n    ",186],["T_DOC_COMMENT","\/**\n     * Shipping addresses list action\n     *\n     * @return null\n     *\/",188],["T_WHITESPACE","\n    ",192],["T_PUBLIC","public",193],["T_WHITESPACE"," ",193],["T_FUNCTION","function",193],["T_WHITESPACE"," ",193],["T_STRING","shippingAddressAction",193],"(",")",["T_WHITESPACE","\n    ",193],"{",["T_WHITESPACE","\n        ",194],["T_TRY","try",195],["T_WHITESPACE"," ",195],"{",["T_WHITESPACE","\n            ",195],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","loadLayout",196],"(",["T_STRING","false",196],")",";",["T_WHITESPACE","\n            ",196],["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","renderLayout",197],"(",")",";",["T_WHITESPACE","\n        ",197],"}",["T_WHITESPACE"," ",198],["T_CATCH","catch",198],["T_WHITESPACE"," ",198],"(",["T_STRING","Mage_Core_Exception",198],["T_WHITESPACE"," ",198],["T_VARIABLE","$e",198],")",["T_WHITESPACE"," ",198],"{",["T_WHITESPACE","\n            ",198],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","_message",199],"(",["T_VARIABLE","$e",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","getMessage",199],"(",")",",",["T_WHITESPACE"," ",199],["T_STRING","self",199],["T_DOUBLE_COLON","::",199],["T_STRING","MESSAGE_STATUS_ERROR",199],")",";",["T_WHITESPACE","\n        ",199],"}",["T_WHITESPACE"," ",200],["T_CATCH","catch",200],["T_WHITESPACE"," ",200],"(",["T_STRING","Exception",200],["T_WHITESPACE"," ",200],["T_VARIABLE","$e",200],")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n            ",200],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","_message",201],"(",["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","__",201],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to load billing address.'",201],")",",",["T_WHITESPACE"," ",201],["T_STRING","self",201],["T_DOUBLE_COLON","::",201],["T_STRING","MESSAGE_STATUS_ERROR",201],")",";",["T_WHITESPACE","\n            ",201],["T_STRING","Mage",202],["T_DOUBLE_COLON","::",202],["T_STRING","logException",202],"(",["T_VARIABLE","$e",202],")",";",["T_WHITESPACE","\n        ",202],"}",["T_WHITESPACE","\n    ",203],"}",["T_WHITESPACE","\n\n    ",204],["T_DOC_COMMENT","\/**\n     * Save shipping address to current quote using onepage model\n     *\n     * @return null\n     *\/",206],["T_WHITESPACE","\n    ",210],["T_PUBLIC","public",211],["T_WHITESPACE"," ",211],["T_FUNCTION","function",211],["T_WHITESPACE"," ",211],["T_STRING","saveShippingAddressAction",211],"(",")",["T_WHITESPACE","\n    ",211],"{",["T_WHITESPACE","\n        ",212],["T_IF","if",213],["T_WHITESPACE"," ",213],"(","!",["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","getRequest",213],"(",")",["T_OBJECT_OPERATOR","->",213],["T_STRING","isPost",213],"(",")",")",["T_WHITESPACE"," ",213],"{",["T_WHITESPACE","\n            ",213],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","_message",214],"(",["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","__",214],"(",["T_CONSTANT_ENCAPSED_STRING","'Specified invalid data.'",214],")",",",["T_WHITESPACE"," ",214],["T_STRING","self",214],["T_DOUBLE_COLON","::",214],["T_STRING","MESSAGE_STATUS_ERROR",214],")",";",["T_WHITESPACE","\n            ",214],["T_RETURN","return",215],";",["T_WHITESPACE","\n        ",215],"}",["T_WHITESPACE","\n\n        ",216],["T_VARIABLE","$data",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","getRequest",218],"(",")",["T_OBJECT_OPERATOR","->",218],["T_STRING","getPost",218],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping'",218],",",["T_WHITESPACE"," ",218],["T_ARRAY","array",218],"(",")",")",";",["T_WHITESPACE","\n        ",218],["T_VARIABLE","$customerAddressId",219],["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","getRequest",219],"(",")",["T_OBJECT_OPERATOR","->",219],["T_STRING","getPost",219],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_id'",219],",",["T_WHITESPACE"," ",219],["T_STRING","false",219],")",";",["T_WHITESPACE","\n        ",219],["T_DOC_COMMENT","\/**\n         * For future use, please do not remove for now\n         *\/",220],["T_WHITESPACE","\n        ",222],["T_VARIABLE","$useForShipping",223],["T_WHITESPACE"," ",223],"=",["T_WHITESPACE"," ",223],["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","getRequest",223],"(",")",["T_OBJECT_OPERATOR","->",223],["T_STRING","getPost",223],"(",["T_CONSTANT_ENCAPSED_STRING","'use_for_shipping'",223],")",";",["T_WHITESPACE","\n\n        ",223],["T_VARIABLE","$billingAddress",225],["T_WHITESPACE"," ",225],"=",["T_WHITESPACE"," ",225],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","getOnepage",225],"(",")",["T_OBJECT_OPERATOR","->",225],["T_STRING","getQuote",225],"(",")",["T_OBJECT_OPERATOR","->",225],["T_STRING","getBillingAddress",225],"(",")",";",["T_WHITESPACE","\n        ",225],["T_DOC_COMMENT","\/**\n         * Checking whether shipping address is the same with billing address?\n         * This should be removed when mobile app will send just the 'use_for_shipping' flag\n         *\/",226],["T_WHITESPACE","\n        ",229],["T_IF","if",230],["T_WHITESPACE"," ",230],"(",["T_STRING","is_null",230],"(",["T_VARIABLE","$useForShipping",230],")",")",["T_WHITESPACE"," ",230],"{",["T_WHITESPACE","\n            ",230],["T_VARIABLE","$useForShipping",231],["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","_checkUseForShipping",231],"(",["T_VARIABLE","$data",231],",",["T_WHITESPACE"," ",231],["T_VARIABLE","$billingAddress",231],",",["T_WHITESPACE"," ",231],["T_VARIABLE","$customerAddressId",231],")",";",["T_WHITESPACE","\n        ",231],"}",["T_WHITESPACE","\n\n        ",232],["T_IF","if",234],["T_WHITESPACE"," ",234],"(",["T_VARIABLE","$useForShipping",234],")",["T_WHITESPACE"," ",234],"{",["T_WHITESPACE","\n            ",234],["T_DOC_COMMENT","\/**\n             * Set address Id with the billing address Id\n             *\/",235],["T_WHITESPACE","\n            ",237],["T_VARIABLE","$customerAddressId",238],["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],["T_VARIABLE","$billingAddress",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","getId",238],"(",")",";",["T_WHITESPACE","\n            ",238],["T_DOC_COMMENT","\/**\n             * Set flag of shipping address is same as billing address\n             *\/",239],["T_WHITESPACE","\n            ",241],["T_VARIABLE","$data",242],"[",["T_CONSTANT_ENCAPSED_STRING","'same_as_billing'",242],"]",["T_WHITESPACE"," ",242],"=",["T_WHITESPACE"," ",242],["T_STRING","true",242],";",["T_WHITESPACE","\n        ",242],"}",["T_WHITESPACE","\n        ",243],["T_VARIABLE","$result",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","getOnepage",244],"(",")",["T_OBJECT_OPERATOR","->",244],["T_STRING","saveShipping",244],"(",["T_VARIABLE","$data",244],",",["T_WHITESPACE"," ",244],["T_VARIABLE","$customerAddressId",244],")",";",["T_WHITESPACE","\n        ",244],["T_IF","if",245],["T_WHITESPACE"," ",245],"(","!",["T_ISSET","isset",245],"(",["T_VARIABLE","$result",245],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",245],"]",")",")",["T_WHITESPACE"," ",245],"{",["T_WHITESPACE","\n            ",245],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","_message",246],"(",["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","__",246],"(",["T_CONSTANT_ENCAPSED_STRING","'Shipping address has been set.'",246],")",",",["T_WHITESPACE"," ",246],["T_STRING","self",246],["T_DOUBLE_COLON","::",246],["T_STRING","MESSAGE_STATUS_SUCCESS",246],")",";",["T_WHITESPACE","\n        ",246],"}",["T_WHITESPACE"," ",247],["T_ELSE","else",247],["T_WHITESPACE"," ",247],"{",["T_WHITESPACE","\n            ",247],["T_IF","if",248],["T_WHITESPACE"," ",248],"(","!",["T_STRING","is_array",248],"(",["T_VARIABLE","$result",248],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",248],"]",")",")",["T_WHITESPACE"," ",248],"{",["T_WHITESPACE","\n                ",248],["T_VARIABLE","$result",249],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",249],"]",["T_WHITESPACE"," ",249],"=",["T_WHITESPACE"," ",249],["T_ARRAY","array",249],"(",["T_VARIABLE","$result",249],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",249],"]",")",";",["T_WHITESPACE","\n            ",249],"}",["T_WHITESPACE","\n            ",250],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","_message",251],"(",["T_STRING","implode",251],"(",["T_CONSTANT_ENCAPSED_STRING","'. '",251],",",["T_WHITESPACE"," ",251],["T_VARIABLE","$result",251],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",251],"]",")",",",["T_WHITESPACE"," ",251],["T_STRING","self",251],["T_DOUBLE_COLON","::",251],["T_STRING","MESSAGE_STATUS_ERROR",251],")",";",["T_WHITESPACE","\n        ",251],"}",["T_WHITESPACE","\n    ",252],"}",["T_WHITESPACE","\n\n    ",253],["T_DOC_COMMENT","\/**\n     * Checks the shipping address is equal with billing address\n     *\n     * ATTENTION!!!\n     * It should be removed when mobile app will send just the 'use_for_shipping' flag\n     * instead of send shipping address same as a billing address\n     *\n     * @todo Remove when mobile app will send just the 'use_for_shipping' flag\n     * @param array $data\n     * @param Mage_Sales_Model_Quote_Address $billingAddress\n     * @param integer $shippingAddressId\n     * @return bool\n     *\/",255],["T_WHITESPACE","\n    ",267],["T_PROTECTED","protected",268],["T_WHITESPACE"," ",268],["T_FUNCTION","function",268],["T_WHITESPACE"," ",268],["T_STRING","_checkUseForShipping",268],"(",["T_ARRAY","array",268],["T_WHITESPACE"," ",268],["T_VARIABLE","$data",268],",",["T_WHITESPACE"," ",268],["T_VARIABLE","$billingAddress",268],",",["T_WHITESPACE"," ",268],["T_VARIABLE","$shippingAddressId",268],")",["T_WHITESPACE","\n    ",268],"{",["T_WHITESPACE","\n        ",269],["T_VARIABLE","$useForShipping",270],["T_WHITESPACE"," ",270],"=",["T_WHITESPACE"," ",270],"!",["T_VARIABLE","$shippingAddressId",270],["T_WHITESPACE"," ",270],["T_BOOLEAN_OR","||",270],["T_WHITESPACE"," ",270],["T_VARIABLE","$billingAddress",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","getId",270],"(",")",["T_WHITESPACE"," ",270],["T_IS_EQUAL","==",270],["T_WHITESPACE"," ",270],["T_VARIABLE","$shippingAddressId",270],";",["T_WHITESPACE","\n\n        ",270],["T_IF","if",272],["T_WHITESPACE"," ",272],"(",["T_VARIABLE","$useForShipping",272],")",["T_WHITESPACE"," ",272],"{",["T_WHITESPACE","\n            ",272],["T_FOREACH","foreach",273],["T_WHITESPACE"," ",273],"(",["T_VARIABLE","$data",273],["T_WHITESPACE"," ",273],["T_AS","as",273],["T_WHITESPACE"," ",273],["T_VARIABLE","$key",273],["T_WHITESPACE"," ",273],["T_DOUBLE_ARROW","=>",273],["T_WHITESPACE"," ",273],["T_VARIABLE","$value",273],")",["T_WHITESPACE"," ",273],"{",["T_WHITESPACE","\n                ",273],["T_IF","if",274],["T_WHITESPACE"," ",274],"(",["T_VARIABLE","$key",274],["T_WHITESPACE"," ",274],["T_IS_EQUAL","==",274],["T_WHITESPACE"," ",274],["T_CONSTANT_ENCAPSED_STRING","'save_in_address_book'",274],")",["T_WHITESPACE"," ",274],"{",["T_WHITESPACE","\n                    ",274],["T_CONTINUE","continue",275],";",["T_WHITESPACE","\n                ",275],"}",["T_WHITESPACE","\n                ",276],["T_VARIABLE","$billingData",277],["T_WHITESPACE"," ",277],"=",["T_WHITESPACE"," ",277],["T_VARIABLE","$billingAddress",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","getDataUsingMethod",277],"(",["T_VARIABLE","$key",277],")",";",["T_WHITESPACE","\n                ",277],["T_IF","if",278],["T_WHITESPACE"," ",278],"(",["T_STRING","is_array",278],"(",["T_VARIABLE","$value",278],")",["T_WHITESPACE"," ",278],["T_BOOLEAN_AND","&&",278],["T_WHITESPACE"," ",278],["T_STRING","is_array",278],"(",["T_VARIABLE","$billingData",278],")",")",["T_WHITESPACE"," ",278],"{",["T_WHITESPACE","\n                    ",278],["T_FOREACH","foreach",279],["T_WHITESPACE"," ",279],"(",["T_VARIABLE","$value",279],["T_WHITESPACE"," ",279],["T_AS","as",279],["T_WHITESPACE"," ",279],["T_VARIABLE","$k",279],["T_WHITESPACE"," ",279],["T_DOUBLE_ARROW","=>",279],["T_WHITESPACE"," ",279],["T_VARIABLE","$v",279],")",["T_WHITESPACE"," ",279],"{",["T_WHITESPACE","\n                        ",279],["T_IF","if",280],["T_WHITESPACE"," ",280],"(","!",["T_ISSET","isset",280],"(",["T_VARIABLE","$billingData",280],"[",["T_VARIABLE","$k",280],"]",")",["T_WHITESPACE"," ",280],["T_BOOLEAN_OR","||",280],["T_WHITESPACE"," ",280],["T_VARIABLE","$billingData",280],"[",["T_VARIABLE","$k",280],"]",["T_WHITESPACE"," ",280],["T_IS_NOT_EQUAL","!=",280],["T_WHITESPACE"," ",280],["T_STRING","trim",280],"(",["T_VARIABLE","$v",280],")",")",["T_WHITESPACE"," ",280],"{",["T_WHITESPACE","\n                            ",280],["T_VARIABLE","$useForShipping",281],["T_WHITESPACE"," ",281],"=",["T_WHITESPACE"," ",281],["T_STRING","false",281],";",["T_WHITESPACE","\n                            ",281],["T_BREAK","break",282],";",["T_WHITESPACE","\n                        ",282],"}",["T_WHITESPACE","\n                    ",283],"}",["T_WHITESPACE","\n                ",284],"}",["T_WHITESPACE"," ",285],["T_ELSE","else",285],["T_WHITESPACE"," ",285],"{",["T_WHITESPACE","\n                    ",285],["T_IF","if",286],["T_WHITESPACE"," ",286],"(",["T_STRING","is_string",286],"(",["T_VARIABLE","$value",286],")",["T_WHITESPACE"," ",286],["T_BOOLEAN_AND","&&",286],["T_WHITESPACE"," ",286],["T_VARIABLE","$billingData",286],["T_WHITESPACE"," ",286],["T_IS_NOT_EQUAL","!=",286],["T_WHITESPACE"," ",286],["T_STRING","trim",286],"(",["T_VARIABLE","$value",286],")",")",["T_WHITESPACE"," ",286],"{",["T_WHITESPACE","\n                        ",286],["T_VARIABLE","$useForShipping",287],["T_WHITESPACE"," ",287],"=",["T_WHITESPACE"," ",287],["T_STRING","false",287],";",["T_WHITESPACE","\n                        ",287],["T_BREAK","break",288],";",["T_WHITESPACE","\n                    ",288],"}",["T_WHITESPACE"," ",289],["T_ELSE","else",289],["T_WHITESPACE"," ",289],"{",["T_WHITESPACE","\n                        ",289],["T_VARIABLE","$useForShipping",290],["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],["T_STRING","false",290],";",["T_WHITESPACE","\n                        ",290],["T_BREAK","break",291],";",["T_WHITESPACE","\n                    ",291],"}",["T_WHITESPACE","\n                ",292],"}",["T_WHITESPACE","\n            ",293],"}",["T_WHITESPACE","\n        ",294],"}",["T_WHITESPACE","\n        ",295],["T_RETURN","return",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$useForShipping",296],";",["T_WHITESPACE","\n    ",296],"}",["T_WHITESPACE","\n\n    ",297],["T_DOC_COMMENT","\/**\n     * Get shipping methods for current quote\n     *\n     * @return null\n     *\/",299],["T_WHITESPACE","\n    ",303],["T_PUBLIC","public",304],["T_WHITESPACE"," ",304],["T_FUNCTION","function",304],["T_WHITESPACE"," ",304],["T_STRING","shippingMethodsAction",304],"(",")",["T_WHITESPACE","\n    ",304],"{",["T_WHITESPACE","\n        ",305],["T_TRY","try",306],["T_WHITESPACE"," ",306],"{",["T_WHITESPACE","\n            ",306],["T_VARIABLE","$result",307],["T_WHITESPACE"," ",307],"=",["T_WHITESPACE"," ",307],["T_ARRAY","array",307],"(",["T_CONSTANT_ENCAPSED_STRING","'error'",307],["T_WHITESPACE"," ",307],["T_DOUBLE_ARROW","=>",307],["T_WHITESPACE"," ",307],["T_VARIABLE","$this",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","__",307],"(",["T_CONSTANT_ENCAPSED_STRING","'Error'",307],")",")",";",["T_WHITESPACE","\n            ",307],["T_VARIABLE","$this",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","getOnepage",308],"(",")",["T_OBJECT_OPERATOR","->",308],["T_STRING","getQuote",308],"(",")",["T_OBJECT_OPERATOR","->",308],["T_STRING","getShippingAddress",308],"(",")",["T_OBJECT_OPERATOR","->",308],["T_STRING","setCollectShippingRates",308],"(",["T_STRING","true",308],")",";",["T_WHITESPACE","\n            ",308],["T_VARIABLE","$this",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","getOnepage",309],"(",")",["T_OBJECT_OPERATOR","->",309],["T_STRING","getQuote",309],"(",")",["T_OBJECT_OPERATOR","->",309],["T_STRING","collectTotals",309],"(",")",["T_OBJECT_OPERATOR","->",309],["T_STRING","save",309],"(",")",";",["T_WHITESPACE","\n            ",309],["T_VARIABLE","$this",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","loadLayout",310],"(",["T_STRING","false",310],")",";",["T_WHITESPACE","\n            ",310],["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","renderLayout",311],"(",")",";",["T_WHITESPACE","\n            ",311],["T_RETURN","return",312],";",["T_WHITESPACE","\n        ",312],"}",["T_WHITESPACE"," ",313],["T_CATCH","catch",313],["T_WHITESPACE"," ",313],"(",["T_STRING","Mage_Core_Exception",313],["T_WHITESPACE"," ",313],["T_VARIABLE","$e",313],")",["T_WHITESPACE"," ",313],"{",["T_WHITESPACE","\n            ",313],["T_VARIABLE","$result",314],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",314],"]",["T_WHITESPACE"," ",314],"=",["T_WHITESPACE"," ",314],["T_VARIABLE","$e",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","getMessage",314],"(",")",";",["T_WHITESPACE","\n        ",314],"}",["T_WHITESPACE","\n        ",315],["T_VARIABLE","$this",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","_message",316],"(",["T_VARIABLE","$result",316],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",316],"]",",",["T_WHITESPACE"," ",316],["T_STRING","self",316],["T_DOUBLE_COLON","::",316],["T_STRING","MESSAGE_STATUS_ERROR",316],")",";",["T_WHITESPACE","\n    ",316],"}",["T_WHITESPACE","\n\n    ",317],["T_DOC_COMMENT","\/**\n     * Get shipping methods for current quote API v23\n     *\n     * @return null\n     *\/",319],["T_WHITESPACE","\n    ",323],["T_PUBLIC","public",324],["T_WHITESPACE"," ",324],["T_FUNCTION","function",324],["T_WHITESPACE"," ",324],["T_STRING","shippingMethodsListAction",324],"(",")",["T_WHITESPACE","\n    ",324],"{",["T_WHITESPACE","\n        ",325],["T_TRY","try",326],["T_WHITESPACE"," ",326],"{",["T_WHITESPACE","\n            ",326],["T_VARIABLE","$result",327],["T_WHITESPACE"," ",327],"=",["T_WHITESPACE"," ",327],["T_ARRAY","array",327],"(",["T_CONSTANT_ENCAPSED_STRING","'error'",327],["T_WHITESPACE"," ",327],["T_DOUBLE_ARROW","=>",327],["T_WHITESPACE"," ",327],["T_VARIABLE","$this",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","__",327],"(",["T_CONSTANT_ENCAPSED_STRING","'Error'",327],")",")",";",["T_WHITESPACE","\n            ",327],["T_VARIABLE","$this",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","getOnepage",328],"(",")",["T_OBJECT_OPERATOR","->",328],["T_STRING","getQuote",328],"(",")",["T_OBJECT_OPERATOR","->",328],["T_STRING","getShippingAddress",328],"(",")",["T_OBJECT_OPERATOR","->",328],["T_STRING","setCollectShippingRates",328],"(",["T_STRING","true",328],")",";",["T_WHITESPACE","\n            ",328],["T_VARIABLE","$this",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","getOnepage",329],"(",")",["T_OBJECT_OPERATOR","->",329],["T_STRING","getQuote",329],"(",")",["T_OBJECT_OPERATOR","->",329],["T_STRING","collectTotals",329],"(",")",["T_OBJECT_OPERATOR","->",329],["T_STRING","save",329],"(",")",";",["T_WHITESPACE","\n            ",329],["T_VARIABLE","$this",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","loadLayout",330],"(",["T_STRING","false",330],")",";",["T_WHITESPACE","\n            ",330],["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","renderLayout",331],"(",")",";",["T_WHITESPACE","\n            ",331],["T_RETURN","return",332],";",["T_WHITESPACE","\n        ",332],"}",["T_WHITESPACE"," ",333],["T_CATCH","catch",333],["T_WHITESPACE"," ",333],"(",["T_STRING","Mage_Core_Exception",333],["T_WHITESPACE"," ",333],["T_VARIABLE","$e",333],")",["T_WHITESPACE"," ",333],"{",["T_WHITESPACE","\n            ",333],["T_VARIABLE","$result",334],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",334],"]",["T_WHITESPACE"," ",334],"=",["T_WHITESPACE"," ",334],["T_VARIABLE","$e",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","getMessage",334],"(",")",";",["T_WHITESPACE","\n        ",334],"}",["T_WHITESPACE","\n        ",335],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","_message",336],"(",["T_VARIABLE","$result",336],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",336],"]",",",["T_WHITESPACE"," ",336],["T_STRING","self",336],["T_DOUBLE_COLON","::",336],["T_STRING","MESSAGE_STATUS_ERROR",336],")",";",["T_WHITESPACE","\n    ",336],"}",["T_WHITESPACE","\n\n    ",337],["T_DOC_COMMENT","\/**\n     * Shipping method save action\n     *\n     * @return null\n     *\/",339],["T_WHITESPACE","\n    ",343],["T_PUBLIC","public",344],["T_WHITESPACE"," ",344],["T_FUNCTION","function",344],["T_WHITESPACE"," ",344],["T_STRING","saveShippingMethodAction",344],"(",")",["T_WHITESPACE","\n    ",344],"{",["T_WHITESPACE","\n        ",345],["T_IF","if",346],["T_WHITESPACE"," ",346],"(","!",["T_VARIABLE","$this",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","getRequest",346],"(",")",["T_OBJECT_OPERATOR","->",346],["T_STRING","isPost",346],"(",")",")",["T_WHITESPACE"," ",346],"{",["T_WHITESPACE","\n            ",346],["T_VARIABLE","$this",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","_message",347],"(",["T_VARIABLE","$this",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","__",347],"(",["T_CONSTANT_ENCAPSED_STRING","'Specified invalid data.'",347],")",",",["T_WHITESPACE"," ",347],["T_STRING","self",347],["T_DOUBLE_COLON","::",347],["T_STRING","MESSAGE_STATUS_ERROR",347],")",";",["T_WHITESPACE","\n            ",347],["T_RETURN","return",348],";",["T_WHITESPACE","\n        ",348],"}",["T_WHITESPACE","\n\n        ",349],["T_VARIABLE","$data",351],["T_WHITESPACE"," ",351],"=",["T_WHITESPACE"," ",351],["T_VARIABLE","$this",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","getRequest",351],"(",")",["T_OBJECT_OPERATOR","->",351],["T_STRING","getPost",351],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",351],",",["T_WHITESPACE"," ",351],["T_CONSTANT_ENCAPSED_STRING","''",351],")",";",["T_WHITESPACE","\n        ",351],["T_VARIABLE","$result",352],["T_WHITESPACE"," ",352],"=",["T_WHITESPACE"," ",352],["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","getOnepage",352],"(",")",["T_OBJECT_OPERATOR","->",352],["T_STRING","saveShippingMethod",352],"(",["T_VARIABLE","$data",352],")",";",["T_WHITESPACE","\n        ",352],["T_IF","if",353],["T_WHITESPACE"," ",353],"(","!",["T_VARIABLE","$result",353],")",["T_WHITESPACE"," ",353],"{",["T_WHITESPACE","\n\n            ",353],["T_STRING","Mage",355],["T_DOUBLE_COLON","::",355],["T_STRING","dispatchEvent",355],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout_controller_onepage_save_shipping_method'",355],",",["T_WHITESPACE"," ",355],["T_ARRAY","array",355],"(",["T_WHITESPACE","\n                ",355],["T_CONSTANT_ENCAPSED_STRING","'request'",356],["T_WHITESPACE"," ",356],["T_DOUBLE_ARROW","=>",356],["T_WHITESPACE"," ",356],["T_VARIABLE","$this",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","getRequest",356],"(",")",",",["T_WHITESPACE","\n                ",356],["T_CONSTANT_ENCAPSED_STRING","'quote'",357],["T_WHITESPACE"," ",357],["T_DOUBLE_ARROW","=>",357],["T_WHITESPACE"," ",357],["T_VARIABLE","$this",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","getOnepage",357],"(",")",["T_OBJECT_OPERATOR","->",357],["T_STRING","getQuote",357],"(",")",["T_WHITESPACE","\n            ",357],")",")",";",["T_WHITESPACE","\n            ",358],["T_VARIABLE","$this",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","getOnepage",359],"(",")",["T_OBJECT_OPERATOR","->",359],["T_STRING","getQuote",359],"(",")",["T_OBJECT_OPERATOR","->",359],["T_STRING","collectTotals",359],"(",")",["T_OBJECT_OPERATOR","->",359],["T_STRING","save",359],"(",")",";",["T_WHITESPACE","\n            ",359],["T_IF","if",360],["T_WHITESPACE"," ",360],"(",["T_VARIABLE","$this",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","_checkApiForward",360],"(",["T_CONSTANT_ENCAPSED_STRING","'paymentmethodlist'",360],",",["T_WHITESPACE"," ",360],["T_STRING","Mage_XmlConnect_Helper_Data",360],["T_DOUBLE_COLON","::",360],["T_STRING","DEVICE_API_V_23",360],")",")",["T_WHITESPACE"," ",360],"{",["T_WHITESPACE","\n                ",360],["T_RETURN","return",361],";",["T_WHITESPACE","\n            ",361],"}",["T_WHITESPACE","\n            ",362],["T_VARIABLE","$this",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","_message",363],"(",["T_VARIABLE","$this",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","__",363],"(",["T_CONSTANT_ENCAPSED_STRING","'Shipping method has been set.'",363],")",",",["T_WHITESPACE"," ",363],["T_STRING","self",363],["T_DOUBLE_COLON","::",363],["T_STRING","MESSAGE_STATUS_SUCCESS",363],")",";",["T_WHITESPACE","\n        ",363],"}",["T_WHITESPACE"," ",364],["T_ELSEIF","elseif",364],["T_WHITESPACE"," ",364],"(",["T_ISSET","isset",364],"(",["T_VARIABLE","$result",364],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",364],"]",")",")",["T_WHITESPACE"," ",364],"{",["T_WHITESPACE","\n            ",364],["T_IF","if",365],["T_WHITESPACE"," ",365],"(","!",["T_STRING","is_array",365],"(",["T_VARIABLE","$result",365],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",365],"]",")",")",["T_WHITESPACE"," ",365],"{",["T_WHITESPACE","\n                ",365],["T_VARIABLE","$result",366],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",366],"]",["T_WHITESPACE"," ",366],"=",["T_WHITESPACE"," ",366],["T_ARRAY","array",366],"(",["T_VARIABLE","$result",366],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",366],"]",")",";",["T_WHITESPACE","\n            ",366],"}",["T_WHITESPACE","\n            ",367],["T_STRING","Mage",368],["T_DOUBLE_COLON","::",368],["T_STRING","dispatchEvent",368],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout_controller_onepage_save_shipping_method'",368],",",["T_WHITESPACE"," ",368],["T_ARRAY","array",368],"(",["T_WHITESPACE","\n                ",368],["T_CONSTANT_ENCAPSED_STRING","'request'",369],["T_WHITESPACE"," ",369],["T_DOUBLE_ARROW","=>",369],["T_WHITESPACE"," ",369],["T_VARIABLE","$this",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","getRequest",369],"(",")",",",["T_WHITESPACE","\n                ",369],["T_CONSTANT_ENCAPSED_STRING","'quote'",370],["T_WHITESPACE"," ",370],["T_DOUBLE_ARROW","=>",370],["T_WHITESPACE"," ",370],["T_VARIABLE","$this",370],["T_OBJECT_OPERATOR","->",370],["T_STRING","getOnepage",370],"(",")",["T_OBJECT_OPERATOR","->",370],["T_STRING","getQuote",370],"(",")",["T_WHITESPACE","\n            ",370],")",")",";",["T_WHITESPACE","\n            ",371],["T_VARIABLE","$this",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","getOnepage",372],"(",")",["T_OBJECT_OPERATOR","->",372],["T_STRING","getQuote",372],"(",")",["T_OBJECT_OPERATOR","->",372],["T_STRING","collectTotals",372],"(",")",["T_OBJECT_OPERATOR","->",372],["T_STRING","save",372],"(",")",";",["T_WHITESPACE","\n            ",372],["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","_message",373],"(",["T_STRING","implode",373],"(",["T_CONSTANT_ENCAPSED_STRING","'. '",373],",",["T_WHITESPACE"," ",373],["T_VARIABLE","$result",373],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",373],"]",")",",",["T_WHITESPACE"," ",373],["T_STRING","self",373],["T_DOUBLE_COLON","::",373],["T_STRING","MESSAGE_STATUS_ERROR",373],")",";",["T_WHITESPACE","\n        ",373],"}",["T_WHITESPACE","\n    ",374],"}",["T_WHITESPACE","\n\n\n    ",375],["T_DOC_COMMENT","\/**\n     * Save checkout method\n     *\n     * @return null\n     *\/",378],["T_WHITESPACE","\n    ",382],["T_PUBLIC","public",383],["T_WHITESPACE"," ",383],["T_FUNCTION","function",383],["T_WHITESPACE"," ",383],["T_STRING","saveMethodAction",383],"(",")",["T_WHITESPACE","\n    ",383],"{",["T_WHITESPACE","\n        ",384],["T_IF","if",385],["T_WHITESPACE"," ",385],"(",["T_VARIABLE","$this",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","getRequest",385],"(",")",["T_OBJECT_OPERATOR","->",385],["T_STRING","isPost",385],"(",")",")",["T_WHITESPACE"," ",385],"{",["T_WHITESPACE","\n            ",385],["T_VARIABLE","$method",386],["T_WHITESPACE"," ",386],"=",["T_WHITESPACE"," ",386],["T_STRING_CAST","(string)",386],["T_WHITESPACE"," ",386],["T_VARIABLE","$this",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","getRequest",386],"(",")",["T_OBJECT_OPERATOR","->",386],["T_STRING","getPost",386],"(",["T_CONSTANT_ENCAPSED_STRING","'method'",386],")",";",["T_WHITESPACE","\n            ",386],["T_VARIABLE","$result",387],["T_WHITESPACE"," ",387],"=",["T_WHITESPACE"," ",387],["T_VARIABLE","$this",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","getOnepage",387],"(",")",["T_OBJECT_OPERATOR","->",387],["T_STRING","saveCheckoutMethod",387],"(",["T_VARIABLE","$method",387],")",";",["T_WHITESPACE","\n            ",387],["T_IF","if",388],["T_WHITESPACE"," ",388],"(","!",["T_ISSET","isset",388],"(",["T_VARIABLE","$result",388],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",388],"]",")",")",["T_WHITESPACE"," ",388],"{",["T_WHITESPACE","\n                ",388],["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","_message",389],"(",["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","__",389],"(",["T_CONSTANT_ENCAPSED_STRING","'Payment Method has been set.'",389],")",",",["T_WHITESPACE"," ",389],["T_STRING","self",389],["T_DOUBLE_COLON","::",389],["T_STRING","MESSAGE_STATUS_SUCCESS",389],")",";",["T_WHITESPACE","\n            ",389],"}",["T_WHITESPACE"," ",390],["T_ELSE","else",390],["T_WHITESPACE"," ",390],"{",["T_WHITESPACE","\n                ",390],["T_IF","if",391],["T_WHITESPACE"," ",391],"(","!",["T_STRING","is_array",391],"(",["T_VARIABLE","$result",391],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",391],"]",")",")",["T_WHITESPACE"," ",391],"{",["T_WHITESPACE","\n                    ",391],["T_VARIABLE","$result",392],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",392],"]",["T_WHITESPACE"," ",392],"=",["T_WHITESPACE"," ",392],["T_ARRAY","array",392],"(",["T_VARIABLE","$result",392],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",392],"]",")",";",["T_WHITESPACE","\n                ",392],"}",["T_WHITESPACE","\n                ",393],["T_VARIABLE","$this",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","_message",394],"(",["T_STRING","implode",394],"(",["T_CONSTANT_ENCAPSED_STRING","'. '",394],",",["T_WHITESPACE"," ",394],["T_VARIABLE","$result",394],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",394],"]",")",",",["T_WHITESPACE"," ",394],["T_STRING","self",394],["T_DOUBLE_COLON","::",394],["T_STRING","MESSAGE_STATUS_ERROR",394],")",";",["T_WHITESPACE","\n            ",394],"}",["T_WHITESPACE","\n        ",395],"}",["T_WHITESPACE","\n    ",396],"}",["T_WHITESPACE","\n\n    ",397],["T_DOC_COMMENT","\/**\n     * Get payment methods action API v23\n     *\n     * @return null\n     *\/",399],["T_WHITESPACE","\n    ",403],["T_PUBLIC","public",404],["T_WHITESPACE"," ",404],["T_FUNCTION","function",404],["T_WHITESPACE"," ",404],["T_STRING","paymentMethodListAction",404],"(",")",["T_WHITESPACE","\n    ",404],"{",["T_WHITESPACE","\n        ",405],["T_TRY","try",406],["T_WHITESPACE"," ",406],"{",["T_WHITESPACE","\n            ",406],["T_VARIABLE","$this",407],["T_OBJECT_OPERATOR","->",407],["T_STRING","loadLayout",407],"(",["T_STRING","false",407],")",";",["T_WHITESPACE","\n            ",407],["T_DOC_COMMENT","\/** @var $paymentMethodsBlock Mage_XmlConnect_Block_Checkout_Payment_Method_List *\/",408],["T_WHITESPACE","\n            ",408],["T_VARIABLE","$paymentMethodsBlock",409],["T_WHITESPACE"," ",409],"=",["T_WHITESPACE"," ",409],["T_VARIABLE","$this",409],["T_OBJECT_OPERATOR","->",409],["T_STRING","getLayout",409],"(",")",["T_OBJECT_OPERATOR","->",409],["T_STRING","getBlock",409],"(",["T_CONSTANT_ENCAPSED_STRING","'payment.methods'",409],")",";",["T_WHITESPACE","\n            ",409],["T_VARIABLE","$response",410],["T_WHITESPACE"," ",410],"=",["T_WHITESPACE"," ",410],["T_VARIABLE","$paymentMethodsBlock",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","toHtml",410],"(",")",";",["T_WHITESPACE","\n            ",410],["T_VARIABLE","$this",411],["T_OBJECT_OPERATOR","->",411],["T_STRING","getResponse",411],"(",")",["T_OBJECT_OPERATOR","->",411],["T_STRING","setBody",411],"(",["T_VARIABLE","$response",411],")",";",["T_WHITESPACE","\n            ",411],["T_RETURN","return",412],";",["T_WHITESPACE","\n        ",412],"}",["T_WHITESPACE"," ",413],["T_CATCH","catch",413],["T_WHITESPACE"," ",413],"(",["T_STRING","Mage_Core_Exception",413],["T_WHITESPACE"," ",413],["T_VARIABLE","$e",413],")",["T_WHITESPACE"," ",413],"{",["T_WHITESPACE","\n            ",413],["T_VARIABLE","$result",414],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",414],"]",["T_WHITESPACE"," ",414],"=",["T_WHITESPACE"," ",414],["T_VARIABLE","$e",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","getMessage",414],"(",")",";",["T_WHITESPACE","\n        ",414],"}",["T_WHITESPACE","\n        ",415],["T_VARIABLE","$this",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","_message",416],"(",["T_VARIABLE","$result",416],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",416],"]",",",["T_WHITESPACE"," ",416],["T_STRING","self",416],["T_DOUBLE_COLON","::",416],["T_STRING","MESSAGE_STATUS_ERROR",416],")",";",["T_WHITESPACE","\n    ",416],"}",["T_WHITESPACE","\n\n    ",417],["T_DOC_COMMENT","\/**\n     * Get payment methods action\n     *\n     * @return null\n     *\/",419],["T_WHITESPACE","\n    ",423],["T_PUBLIC","public",424],["T_WHITESPACE"," ",424],["T_FUNCTION","function",424],["T_WHITESPACE"," ",424],["T_STRING","paymentMethodsAction",424],"(",")",["T_WHITESPACE","\n    ",424],"{",["T_WHITESPACE","\n        ",425],["T_IF","if",426],["T_WHITESPACE"," ",426],"(",["T_VARIABLE","$this",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","_checkApiForward",426],"(",["T_CONSTANT_ENCAPSED_STRING","'paymentmethodlist'",426],",",["T_WHITESPACE"," ",426],["T_STRING","Mage_XmlConnect_Helper_Data",426],["T_DOUBLE_COLON","::",426],["T_STRING","DEVICE_API_V_23",426],")",")",["T_WHITESPACE"," ",426],"{",["T_WHITESPACE","\n            ",426],["T_RETURN","return",427],";",["T_WHITESPACE","\n        ",427],"}",["T_WHITESPACE","\n        ",428],["T_VARIABLE","$this",429],["T_OBJECT_OPERATOR","->",429],["T_STRING","paymentMethodListAction",429],"(",")",";",["T_WHITESPACE","\n    ",429],"}",["T_WHITESPACE","\n\n    ",430],["T_DOC_COMMENT","\/**\n     * Save payment action\n     *\n     * @return null\n     *\/",432],["T_WHITESPACE","\n    ",436],["T_PUBLIC","public",437],["T_WHITESPACE"," ",437],["T_FUNCTION","function",437],["T_WHITESPACE"," ",437],["T_STRING","savePaymentAction",437],"(",")",["T_WHITESPACE","\n    ",437],"{",["T_WHITESPACE","\n        ",438],["T_IF","if",439],["T_WHITESPACE"," ",439],"(","!",["T_VARIABLE","$this",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","getRequest",439],"(",")",["T_OBJECT_OPERATOR","->",439],["T_STRING","isPost",439],"(",")",")",["T_WHITESPACE"," ",439],"{",["T_WHITESPACE","\n            ",439],["T_VARIABLE","$this",440],["T_OBJECT_OPERATOR","->",440],["T_STRING","_message",440],"(",["T_VARIABLE","$this",440],["T_OBJECT_OPERATOR","->",440],["T_STRING","__",440],"(",["T_CONSTANT_ENCAPSED_STRING","'Specified invalid data.'",440],")",",",["T_WHITESPACE"," ",440],["T_STRING","self",440],["T_DOUBLE_COLON","::",440],["T_STRING","MESSAGE_STATUS_ERROR",440],")",";",["T_WHITESPACE","\n            ",440],["T_RETURN","return",441],";",["T_WHITESPACE","\n        ",441],"}",["T_WHITESPACE","\n        ",442],["T_COMMENT","\/\/ set payment to quote\n",443],["T_WHITESPACE","        ",444],["T_VARIABLE","$result",444],["T_WHITESPACE"," ",444],"=",["T_WHITESPACE"," ",444],["T_ARRAY","array",444],"(",")",";",["T_WHITESPACE","\n        ",444],["T_VARIABLE","$data",445],["T_WHITESPACE"," ",445],"=",["T_WHITESPACE"," ",445],["T_VARIABLE","$this",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","getRequest",445],"(",")",["T_OBJECT_OPERATOR","->",445],["T_STRING","getPost",445],"(",["T_CONSTANT_ENCAPSED_STRING","'payment'",445],",",["T_WHITESPACE"," ",445],["T_ARRAY","array",445],"(",")",")",";",["T_WHITESPACE","\n        ",445],["T_TRY","try",446],["T_WHITESPACE"," ",446],"{",["T_WHITESPACE","\n            ",446],["T_VARIABLE","$result",447],["T_WHITESPACE"," ",447],"=",["T_WHITESPACE"," ",447],["T_VARIABLE","$this",447],["T_OBJECT_OPERATOR","->",447],["T_STRING","getOnepage",447],"(",")",["T_OBJECT_OPERATOR","->",447],["T_STRING","savePayment",447],"(",["T_VARIABLE","$data",447],")",";",["T_WHITESPACE","\n            ",447],["T_IF","if",448],["T_WHITESPACE"," ",448],"(",["T_EMPTY","empty",448],"(",["T_VARIABLE","$result",448],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",448],"]",")",")",["T_WHITESPACE"," ",448],"{",["T_WHITESPACE","\n                ",448],["T_VARIABLE","$method",449],["T_WHITESPACE"," ",449],"=",["T_WHITESPACE"," ",449],["T_STRING","Mage",449],["T_DOUBLE_COLON","::",449],["T_STRING","getSingleton",449],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/session'",449],")",["T_OBJECT_OPERATOR","->",449],["T_STRING","getQuote",449],"(",")",["T_OBJECT_OPERATOR","->",449],["T_STRING","getPayment",449],"(",")",["T_OBJECT_OPERATOR","->",449],["T_STRING","getMethodInstance",449],"(",")",";",["T_WHITESPACE","\n                ",449],["T_VARIABLE","$sentinelData",450],["T_WHITESPACE"," ",450],"=",["T_WHITESPACE"," ",450],["T_ARRAY","array",450],"(",")",";",["T_WHITESPACE","\n                ",450],["T_IF","if",451],["T_WHITESPACE"," ",451],"(",["T_VARIABLE","$method",451],["T_OBJECT_OPERATOR","->",451],["T_STRING","getIsCentinelValidationEnabled",451],"(",")",")",["T_WHITESPACE"," ",451],"{",["T_WHITESPACE","\n                    ",451],["T_VARIABLE","$centinel",452],["T_WHITESPACE"," ",452],"=",["T_WHITESPACE"," ",452],["T_VARIABLE","$method",452],["T_OBJECT_OPERATOR","->",452],["T_STRING","getCentinelValidator",452],"(",")",";",["T_WHITESPACE","\n                    ",452],["T_IF","if",453],["T_WHITESPACE"," ",453],"(",["T_VARIABLE","$centinel",453],["T_WHITESPACE"," ",453],["T_BOOLEAN_AND","&&",453],["T_WHITESPACE"," ",453],["T_VARIABLE","$centinel",453],["T_OBJECT_OPERATOR","->",453],["T_STRING","shouldAuthenticate",453],"(",")",")",["T_WHITESPACE"," ",453],"{",["T_WHITESPACE","\n                        ",453],["T_VARIABLE","$sentinelData",454],["T_WHITESPACE"," ",454],"=",["T_WHITESPACE"," ",454],["T_ARRAY","array",454],"(",["T_CONSTANT_ENCAPSED_STRING","'sentinel_secure'",454],["T_WHITESPACE"," ",454],["T_DOUBLE_ARROW","=>",454],["T_WHITESPACE"," ",454],["T_STRING","Mage",454],["T_DOUBLE_COLON","::",454],["T_STRING","getUrl",454],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/cms\/sentinelsecure'",454],")",")",";",["T_WHITESPACE","\n                    ",454],"}",["T_WHITESPACE","\n                ",455],"}",["T_WHITESPACE","\n\n                ",456],["T_IF","if",458],["T_WHITESPACE"," ",458],"(",["T_VARIABLE","$this",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","_checkApiForward",458],"(",["T_CONSTANT_ENCAPSED_STRING","'ordersummary'",458],",",["T_WHITESPACE"," ",458],["T_STRING","Mage_XmlConnect_Helper_Data",458],["T_DOUBLE_COLON","::",458],["T_STRING","DEVICE_API_V_23",458],")",")",["T_WHITESPACE"," ",458],"{",["T_WHITESPACE","\n                    ",458],["T_RETURN","return",459],";",["T_WHITESPACE","\n                ",459],"}",["T_WHITESPACE","\n                ",460],["T_VARIABLE","$this",461],["T_OBJECT_OPERATOR","->",461],["T_STRING","_message",461],"(",["T_WHITESPACE","\n                    ",461],["T_VARIABLE","$this",462],["T_OBJECT_OPERATOR","->",462],["T_STRING","__",462],"(",["T_CONSTANT_ENCAPSED_STRING","'Payment method was successfully set.'",462],")",",",["T_WHITESPACE"," ",462],["T_STRING","self",462],["T_DOUBLE_COLON","::",462],["T_STRING","MESSAGE_STATUS_SUCCESS",462],",",["T_WHITESPACE"," ",462],["T_VARIABLE","$sentinelData",462],["T_WHITESPACE","\n                ",462],")",";",["T_WHITESPACE","\n                ",463],["T_RETURN","return",464],";",["T_WHITESPACE","\n            ",464],"}",["T_WHITESPACE","\n\n        ",465],"}",["T_WHITESPACE"," ",467],["T_CATCH","catch",467],["T_WHITESPACE"," ",467],"(",["T_STRING","Mage_Payment_Exception",467],["T_WHITESPACE"," ",467],["T_VARIABLE","$e",467],")",["T_WHITESPACE"," ",467],"{",["T_WHITESPACE","\n            ",467],["T_VARIABLE","$result",468],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",468],"]",["T_WHITESPACE"," ",468],"=",["T_WHITESPACE"," ",468],["T_VARIABLE","$e",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","getMessage",468],"(",")",";",["T_WHITESPACE","\n            ",468],["T_STRING","Mage",469],["T_DOUBLE_COLON","::",469],["T_STRING","logException",469],"(",["T_VARIABLE","$e",469],")",";",["T_WHITESPACE","\n        ",469],"}",["T_WHITESPACE"," ",470],["T_CATCH","catch",470],["T_WHITESPACE"," ",470],"(",["T_STRING","Mage_Core_Exception",470],["T_WHITESPACE"," ",470],["T_VARIABLE","$e",470],")",["T_WHITESPACE"," ",470],"{",["T_WHITESPACE","\n            ",470],["T_VARIABLE","$result",471],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",471],"]",["T_WHITESPACE"," ",471],"=",["T_WHITESPACE"," ",471],["T_VARIABLE","$e",471],["T_OBJECT_OPERATOR","->",471],["T_STRING","getMessage",471],"(",")",";",["T_WHITESPACE","\n            ",471],["T_STRING","Mage",472],["T_DOUBLE_COLON","::",472],["T_STRING","logException",472],"(",["T_VARIABLE","$e",472],")",";",["T_WHITESPACE","\n        ",472],"}",["T_WHITESPACE"," ",473],["T_CATCH","catch",473],["T_WHITESPACE"," ",473],"(",["T_STRING","Exception",473],["T_WHITESPACE"," ",473],["T_VARIABLE","$e",473],")",["T_WHITESPACE"," ",473],"{",["T_WHITESPACE","\n            ",473],["T_STRING","Mage",474],["T_DOUBLE_COLON","::",474],["T_STRING","logException",474],"(",["T_VARIABLE","$e",474],")",";",["T_WHITESPACE","\n            ",474],["T_VARIABLE","$result",475],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",475],"]",["T_WHITESPACE"," ",475],"=",["T_WHITESPACE"," ",475],["T_VARIABLE","$e",475],["T_OBJECT_OPERATOR","->",475],["T_STRING","getMessage",475],"(",")",";",["T_WHITESPACE","\n        ",475],"}",["T_WHITESPACE","\n        ",476],["T_VARIABLE","$this",477],["T_OBJECT_OPERATOR","->",477],["T_STRING","_message",477],"(",["T_VARIABLE","$result",477],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",477],"]",",",["T_WHITESPACE"," ",477],["T_STRING","self",477],["T_DOUBLE_COLON","::",477],["T_STRING","MESSAGE_STATUS_ERROR",477],")",";",["T_WHITESPACE","\n    ",477],"}",["T_WHITESPACE","\n\n    ",478],["T_DOC_COMMENT","\/**\n     * Order review action\n     *\n     * @return null\n     *\/",480],["T_WHITESPACE","\n    ",484],["T_PUBLIC","public",485],["T_WHITESPACE"," ",485],["T_FUNCTION","function",485],["T_WHITESPACE"," ",485],["T_STRING","orderReviewAction",485],"(",")",["T_WHITESPACE","\n    ",485],"{",["T_WHITESPACE","\n        ",486],["T_VARIABLE","$this",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","getOnepage",487],"(",")",["T_OBJECT_OPERATOR","->",487],["T_STRING","getQuote",487],"(",")",["T_OBJECT_OPERATOR","->",487],["T_STRING","collectTotals",487],"(",")",["T_OBJECT_OPERATOR","->",487],["T_STRING","save",487],"(",")",";",["T_WHITESPACE","\n        ",487],["T_TRY","try",488],["T_WHITESPACE"," ",488],"{",["T_WHITESPACE","\n            ",488],["T_VARIABLE","$this",489],["T_OBJECT_OPERATOR","->",489],["T_STRING","loadLayout",489],"(",["T_STRING","false",489],")",";",["T_WHITESPACE","\n            ",489],["T_VARIABLE","$this",490],["T_OBJECT_OPERATOR","->",490],["T_STRING","renderLayout",490],"(",")",";",["T_WHITESPACE","\n        ",490],"}",["T_WHITESPACE"," ",491],["T_CATCH","catch",491],["T_WHITESPACE"," ",491],"(",["T_STRING","Mage_Core_Exception",491],["T_WHITESPACE"," ",491],["T_VARIABLE","$e",491],")",["T_WHITESPACE"," ",491],"{",["T_WHITESPACE","\n            ",491],["T_VARIABLE","$this",492],["T_OBJECT_OPERATOR","->",492],["T_STRING","_message",492],"(",["T_VARIABLE","$e",492],["T_OBJECT_OPERATOR","->",492],["T_STRING","getMessage",492],"(",")",",",["T_WHITESPACE"," ",492],["T_STRING","self",492],["T_DOUBLE_COLON","::",492],["T_STRING","MESSAGE_STATUS_ERROR",492],")",";",["T_WHITESPACE","\n        ",492],"}",["T_WHITESPACE"," ",493],["T_CATCH","catch",493],["T_WHITESPACE"," ",493],"(",["T_STRING","Exception",493],["T_WHITESPACE"," ",493],["T_VARIABLE","$e",493],")",["T_WHITESPACE"," ",493],"{",["T_WHITESPACE","\n            ",493],["T_VARIABLE","$this",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","_message",494],"(",["T_VARIABLE","$this",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","__",494],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to load order review.'",494],")",",",["T_WHITESPACE"," ",494],["T_STRING","self",494],["T_DOUBLE_COLON","::",494],["T_STRING","MESSAGE_STATUS_ERROR",494],")",";",["T_WHITESPACE","\n            ",494],["T_STRING","Mage",495],["T_DOUBLE_COLON","::",495],["T_STRING","logException",495],"(",["T_VARIABLE","$e",495],")",";",["T_WHITESPACE","\n        ",495],"}",["T_WHITESPACE","\n    ",496],"}",["T_WHITESPACE","\n\n    ",497],["T_DOC_COMMENT","\/**\n     * Checkout order summary info action\n     *\n     * @return null\n     *\/",499],["T_WHITESPACE","\n    ",503],["T_PUBLIC","public",504],["T_WHITESPACE"," ",504],["T_FUNCTION","function",504],["T_WHITESPACE"," ",504],["T_STRING","orderSummaryAction",504],"(",")",["T_WHITESPACE","\n    ",504],"{",["T_WHITESPACE","\n        ",505],["T_VARIABLE","$this",506],["T_OBJECT_OPERATOR","->",506],["T_STRING","getOnepage",506],"(",")",["T_OBJECT_OPERATOR","->",506],["T_STRING","getQuote",506],"(",")",["T_OBJECT_OPERATOR","->",506],["T_STRING","collectTotals",506],"(",")",["T_OBJECT_OPERATOR","->",506],["T_STRING","save",506],"(",")",";",["T_WHITESPACE","\n        ",506],["T_TRY","try",507],["T_WHITESPACE"," ",507],"{",["T_WHITESPACE","\n            ",507],["T_VARIABLE","$this",508],["T_OBJECT_OPERATOR","->",508],["T_STRING","loadLayout",508],"(",["T_STRING","false",508],")",";",["T_WHITESPACE","\n            ",508],["T_VARIABLE","$this",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","renderLayout",509],"(",")",";",["T_WHITESPACE","\n        ",509],"}",["T_WHITESPACE"," ",510],["T_CATCH","catch",510],["T_WHITESPACE"," ",510],"(",["T_STRING","Mage_Core_Exception",510],["T_WHITESPACE"," ",510],["T_VARIABLE","$e",510],")",["T_WHITESPACE"," ",510],"{",["T_WHITESPACE","\n            ",510],["T_VARIABLE","$this",511],["T_OBJECT_OPERATOR","->",511],["T_STRING","_message",511],"(",["T_VARIABLE","$e",511],["T_OBJECT_OPERATOR","->",511],["T_STRING","getMessage",511],"(",")",",",["T_WHITESPACE"," ",511],["T_STRING","self",511],["T_DOUBLE_COLON","::",511],["T_STRING","MESSAGE_STATUS_ERROR",511],")",";",["T_WHITESPACE","\n        ",511],"}",["T_WHITESPACE"," ",512],["T_CATCH","catch",512],["T_WHITESPACE"," ",512],"(",["T_STRING","Exception",512],["T_WHITESPACE"," ",512],["T_VARIABLE","$e",512],")",["T_WHITESPACE"," ",512],"{",["T_WHITESPACE","\n            ",512],["T_VARIABLE","$this",513],["T_OBJECT_OPERATOR","->",513],["T_STRING","_message",513],"(",["T_VARIABLE","$this",513],["T_OBJECT_OPERATOR","->",513],["T_STRING","__",513],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to load order review.'",513],")",",",["T_WHITESPACE"," ",513],["T_STRING","self",513],["T_DOUBLE_COLON","::",513],["T_STRING","MESSAGE_STATUS_ERROR",513],")",";",["T_WHITESPACE","\n            ",513],["T_STRING","Mage",514],["T_DOUBLE_COLON","::",514],["T_STRING","logException",514],"(",["T_VARIABLE","$e",514],")",";",["T_WHITESPACE","\n        ",514],"}",["T_WHITESPACE","\n    ",515],"}",["T_WHITESPACE","\n\n    ",516],["T_DOC_COMMENT","\/**\n     * Create order action\n     *\n     * @return null\n     *\/",518],["T_WHITESPACE","\n    ",522],["T_PUBLIC","public",523],["T_WHITESPACE"," ",523],["T_FUNCTION","function",523],["T_WHITESPACE"," ",523],["T_STRING","saveOrderAction",523],"(",")",["T_WHITESPACE","\n    ",523],"{",["T_WHITESPACE","\n        ",524],["T_IF","if",525],["T_WHITESPACE"," ",525],"(","!",["T_VARIABLE","$this",525],["T_OBJECT_OPERATOR","->",525],["T_STRING","getRequest",525],"(",")",["T_OBJECT_OPERATOR","->",525],["T_STRING","isPost",525],"(",")",")",["T_WHITESPACE"," ",525],"{",["T_WHITESPACE","\n            ",525],["T_VARIABLE","$this",526],["T_OBJECT_OPERATOR","->",526],["T_STRING","_message",526],"(",["T_VARIABLE","$this",526],["T_OBJECT_OPERATOR","->",526],["T_STRING","__",526],"(",["T_CONSTANT_ENCAPSED_STRING","'Specified invalid data.'",526],")",",",["T_WHITESPACE"," ",526],["T_STRING","self",526],["T_DOUBLE_COLON","::",526],["T_STRING","MESSAGE_STATUS_ERROR",526],")",";",["T_WHITESPACE","\n            ",526],["T_RETURN","return",527],";",["T_WHITESPACE","\n        ",527],"}",["T_WHITESPACE","\n\n        ",528],["T_TRY","try",530],["T_WHITESPACE"," ",530],"{",["T_WHITESPACE","\n            ",530],["T_VARIABLE","$requiredAgreements",531],["T_WHITESPACE"," ",531],"=",["T_WHITESPACE"," ",531],["T_STRING","Mage",531],["T_DOUBLE_COLON","::",531],["T_STRING","helper",531],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout'",531],")",["T_OBJECT_OPERATOR","->",531],["T_STRING","getRequiredAgreementIds",531],"(",")",";",["T_WHITESPACE","\n            ",531],["T_IF","if",532],["T_WHITESPACE"," ",532],"(","!",["T_EMPTY","empty",532],"(",["T_VARIABLE","$requiredAgreements",532],")",")",["T_WHITESPACE"," ",532],"{",["T_WHITESPACE","\n                ",532],["T_VARIABLE","$postedAgreements",533],["T_WHITESPACE"," ",533],"=",["T_WHITESPACE"," ",533],["T_STRING","array_keys",533],"(",["T_VARIABLE","$this",533],["T_OBJECT_OPERATOR","->",533],["T_STRING","getRequest",533],"(",")",["T_OBJECT_OPERATOR","->",533],["T_STRING","getPost",533],"(",["T_CONSTANT_ENCAPSED_STRING","'agreement'",533],",",["T_WHITESPACE"," ",533],["T_ARRAY","array",533],"(",")",")",")",";",["T_WHITESPACE","\n                ",533],["T_IF","if",534],["T_WHITESPACE"," ",534],"(",["T_STRING","array_diff",534],"(",["T_VARIABLE","$requiredAgreements",534],",",["T_WHITESPACE"," ",534],["T_VARIABLE","$postedAgreements",534],")",")",["T_WHITESPACE"," ",534],"{",["T_WHITESPACE","\n                    ",534],["T_VARIABLE","$error",535],["T_WHITESPACE"," ",535],"=",["T_WHITESPACE"," ",535],["T_VARIABLE","$this",535],["T_OBJECT_OPERATOR","->",535],["T_STRING","__",535],"(",["T_CONSTANT_ENCAPSED_STRING","'Please agree to all the terms and conditions before placing the order.'",535],")",";",["T_WHITESPACE","\n                    ",535],["T_VARIABLE","$this",536],["T_OBJECT_OPERATOR","->",536],["T_STRING","_message",536],"(",["T_VARIABLE","$error",536],",",["T_WHITESPACE"," ",536],["T_STRING","self",536],["T_DOUBLE_COLON","::",536],["T_STRING","MESSAGE_STATUS_ERROR",536],")",";",["T_WHITESPACE","\n                    ",536],["T_RETURN","return",537],";",["T_WHITESPACE","\n                ",537],"}",["T_WHITESPACE","\n            ",538],"}",["T_WHITESPACE","\n            ",539],["T_VARIABLE","$data",540],["T_WHITESPACE"," ",540],"=",["T_WHITESPACE"," ",540],["T_VARIABLE","$this",540],["T_OBJECT_OPERATOR","->",540],["T_STRING","getRequest",540],"(",")",["T_OBJECT_OPERATOR","->",540],["T_STRING","getPost",540],"(",["T_CONSTANT_ENCAPSED_STRING","'payment'",540],",",["T_WHITESPACE"," ",540],["T_STRING","false",540],")",";",["T_WHITESPACE","\n            ",540],["T_IF","if",541],["T_WHITESPACE"," ",541],"(",["T_VARIABLE","$data",541],")",["T_WHITESPACE"," ",541],"{",["T_WHITESPACE","\n                ",541],["T_VARIABLE","$this",542],["T_OBJECT_OPERATOR","->",542],["T_STRING","getOnepage",542],"(",")",["T_OBJECT_OPERATOR","->",542],["T_STRING","getQuote",542],"(",")",["T_OBJECT_OPERATOR","->",542],["T_STRING","getPayment",542],"(",")",["T_OBJECT_OPERATOR","->",542],["T_STRING","importData",542],"(",["T_VARIABLE","$data",542],")",";",["T_WHITESPACE","\n            ",542],"}",["T_WHITESPACE","\n            ",543],["T_VARIABLE","$this",544],["T_OBJECT_OPERATOR","->",544],["T_STRING","getOnepage",544],"(",")",["T_OBJECT_OPERATOR","->",544],["T_STRING","saveOrder",544],"(",")",";",["T_WHITESPACE","\n\n            ",544],["T_DOC_COMMENT","\/** @var $message Mage_XmlConnect_Model_Simplexml_Element *\/",546],["T_WHITESPACE","\n            ",546],["T_VARIABLE","$message",547],["T_WHITESPACE"," ",547],"=",["T_WHITESPACE"," ",547],["T_STRING","Mage",547],["T_DOUBLE_COLON","::",547],["T_STRING","getModel",547],"(",["T_CONSTANT_ENCAPSED_STRING","'xmlconnect\/simplexml_element'",547],",",["T_WHITESPACE"," ",547],["T_CONSTANT_ENCAPSED_STRING","'<message><\/message>'",547],")",";",["T_WHITESPACE","\n            ",547],["T_VARIABLE","$message",548],["T_OBJECT_OPERATOR","->",548],["T_STRING","addChild",548],"(",["T_CONSTANT_ENCAPSED_STRING","'status'",548],",",["T_WHITESPACE"," ",548],["T_STRING","self",548],["T_DOUBLE_COLON","::",548],["T_STRING","MESSAGE_STATUS_SUCCESS",548],")",";",["T_WHITESPACE","\n\n            ",548],["T_VARIABLE","$orderId",550],["T_WHITESPACE"," ",550],"=",["T_WHITESPACE"," ",550],["T_VARIABLE","$this",550],["T_OBJECT_OPERATOR","->",550],["T_STRING","getOnepage",550],"(",")",["T_OBJECT_OPERATOR","->",550],["T_STRING","getLastOrderId",550],"(",")",";",["T_WHITESPACE","\n\n            ",550],["T_VARIABLE","$text",552],["T_WHITESPACE"," ",552],"=",["T_WHITESPACE"," ",552],["T_VARIABLE","$this",552],["T_OBJECT_OPERATOR","->",552],["T_STRING","__",552],"(",["T_CONSTANT_ENCAPSED_STRING","'Thank you for your purchase! '",552],")",";",["T_WHITESPACE","\n            ",552],["T_VARIABLE","$text",553],["T_WHITESPACE"," ",553],["T_CONCAT_EQUAL",".=",553],["T_WHITESPACE"," ",553],["T_VARIABLE","$this",553],["T_OBJECT_OPERATOR","->",553],["T_STRING","__",553],"(",["T_CONSTANT_ENCAPSED_STRING","'Your order # is: %s. '",553],",",["T_WHITESPACE"," ",553],["T_VARIABLE","$orderId",553],")",";",["T_WHITESPACE","\n            ",553],["T_VARIABLE","$text",554],["T_WHITESPACE"," ",554],["T_CONCAT_EQUAL",".=",554],["T_WHITESPACE"," ",554],["T_VARIABLE","$this",554],["T_OBJECT_OPERATOR","->",554],["T_STRING","__",554],"(",["T_CONSTANT_ENCAPSED_STRING","'You will receive an order confirmation email with details of your order and a link to track its progress.'",554],")",";",["T_WHITESPACE","\n            ",554],["T_VARIABLE","$message",555],["T_OBJECT_OPERATOR","->",555],["T_STRING","addChild",555],"(",["T_CONSTANT_ENCAPSED_STRING","'text'",555],",",["T_WHITESPACE"," ",555],["T_VARIABLE","$text",555],")",";",["T_WHITESPACE","\n\n            ",555],["T_VARIABLE","$message",557],["T_OBJECT_OPERATOR","->",557],["T_STRING","addChild",557],"(",["T_CONSTANT_ENCAPSED_STRING","'order_id'",557],",",["T_WHITESPACE"," ",557],["T_VARIABLE","$orderId",557],")",";",["T_WHITESPACE","\n\n            ",557],["T_VARIABLE","$this",559],["T_OBJECT_OPERATOR","->",559],["T_STRING","getOnepage",559],"(",")",["T_OBJECT_OPERATOR","->",559],["T_STRING","getQuote",559],"(",")",["T_OBJECT_OPERATOR","->",559],["T_STRING","save",559],"(",")",";",["T_WHITESPACE","\n            ",559],["T_VARIABLE","$this",560],["T_OBJECT_OPERATOR","->",560],["T_STRING","getOnepage",560],"(",")",["T_OBJECT_OPERATOR","->",560],["T_STRING","getCheckout",560],"(",")",["T_OBJECT_OPERATOR","->",560],["T_STRING","clear",560],"(",")",";",["T_WHITESPACE","\n\n            ",560],["T_VARIABLE","$this",562],["T_OBJECT_OPERATOR","->",562],["T_STRING","getResponse",562],"(",")",["T_OBJECT_OPERATOR","->",562],["T_STRING","setBody",562],"(",["T_VARIABLE","$message",562],["T_OBJECT_OPERATOR","->",562],["T_STRING","asNiceXml",562],"(",")",")",";",["T_WHITESPACE","\n            ",562],["T_RETURN","return",563],";",["T_WHITESPACE","\n        ",563],"}",["T_WHITESPACE"," ",564],["T_CATCH","catch",564],["T_WHITESPACE"," ",564],"(",["T_STRING","Mage_Core_Exception",564],["T_WHITESPACE"," ",564],["T_VARIABLE","$e",564],")",["T_WHITESPACE"," ",564],"{",["T_WHITESPACE","\n            ",564],["T_STRING","Mage",565],["T_DOUBLE_COLON","::",565],["T_STRING","logException",565],"(",["T_VARIABLE","$e",565],")",";",["T_WHITESPACE","\n            ",565],["T_STRING","Mage",566],["T_DOUBLE_COLON","::",566],["T_STRING","helper",566],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout'",566],")",["T_OBJECT_OPERATOR","->",566],["T_STRING","sendPaymentFailedEmail",566],"(",["T_VARIABLE","$this",566],["T_OBJECT_OPERATOR","->",566],["T_STRING","getOnepage",566],"(",")",["T_OBJECT_OPERATOR","->",566],["T_STRING","getQuote",566],"(",")",",",["T_WHITESPACE"," ",566],["T_VARIABLE","$e",566],["T_OBJECT_OPERATOR","->",566],["T_STRING","getMessage",566],"(",")",")",";",["T_WHITESPACE","\n            ",566],["T_VARIABLE","$error",567],["T_WHITESPACE"," ",567],"=",["T_WHITESPACE"," ",567],["T_VARIABLE","$e",567],["T_OBJECT_OPERATOR","->",567],["T_STRING","getMessage",567],"(",")",";",["T_WHITESPACE","\n        ",567],"}",["T_WHITESPACE"," ",568],["T_CATCH","catch",568],["T_WHITESPACE"," ",568],"(",["T_STRING","Exception",568],["T_WHITESPACE"," ",568],["T_VARIABLE","$e",568],")",["T_WHITESPACE"," ",568],"{",["T_WHITESPACE","\n            ",568],["T_STRING","Mage",569],["T_DOUBLE_COLON","::",569],["T_STRING","logException",569],"(",["T_VARIABLE","$e",569],")",";",["T_WHITESPACE","\n            ",569],["T_STRING","Mage",570],["T_DOUBLE_COLON","::",570],["T_STRING","helper",570],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout'",570],")",["T_OBJECT_OPERATOR","->",570],["T_STRING","sendPaymentFailedEmail",570],"(",["T_VARIABLE","$this",570],["T_OBJECT_OPERATOR","->",570],["T_STRING","getOnepage",570],"(",")",["T_OBJECT_OPERATOR","->",570],["T_STRING","getQuote",570],"(",")",",",["T_WHITESPACE"," ",570],["T_VARIABLE","$e",570],["T_OBJECT_OPERATOR","->",570],["T_STRING","getMessage",570],"(",")",")",";",["T_WHITESPACE","\n            ",570],["T_VARIABLE","$error",571],["T_WHITESPACE"," ",571],"=",["T_WHITESPACE"," ",571],["T_VARIABLE","$this",571],["T_OBJECT_OPERATOR","->",571],["T_STRING","__",571],"(",["T_CONSTANT_ENCAPSED_STRING","'An error occurred while processing your order. Please contact us or try again later.'",571],")",";",["T_WHITESPACE","\n        ",571],"}",["T_WHITESPACE","\n        ",572],["T_VARIABLE","$this",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","getOnepage",573],"(",")",["T_OBJECT_OPERATOR","->",573],["T_STRING","getQuote",573],"(",")",["T_OBJECT_OPERATOR","->",573],["T_STRING","save",573],"(",")",";",["T_WHITESPACE","\n        ",573],["T_VARIABLE","$this",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","_message",574],"(",["T_VARIABLE","$error",574],",",["T_WHITESPACE"," ",574],["T_STRING","self",574],["T_DOUBLE_COLON","::",574],["T_STRING","MESSAGE_STATUS_ERROR",574],")",";",["T_WHITESPACE","\n    ",574],"}",["T_WHITESPACE","\n\n    ",575],["T_DOC_COMMENT","\/**\n     * Action return address form and customer saved addresses\n     *\n     * @return null\n     *\/",577],["T_WHITESPACE","\n    ",581],["T_PUBLIC","public",582],["T_WHITESPACE"," ",582],["T_FUNCTION","function",582],["T_WHITESPACE"," ",582],["T_STRING","addressMassactionAction",582],"(",")",["T_WHITESPACE","\n    ",582],"{",["T_WHITESPACE","\n        ",583],["T_IF","if",584],["T_WHITESPACE"," ",584],"(","!",["T_STRING","Mage",584],["T_DOUBLE_COLON","::",584],["T_STRING","helper",584],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout'",584],")",["T_OBJECT_OPERATOR","->",584],["T_STRING","canOnepageCheckout",584],"(",")",")",["T_WHITESPACE"," ",584],"{",["T_WHITESPACE","\n            ",584],["T_VARIABLE","$this",585],["T_OBJECT_OPERATOR","->",585],["T_STRING","_message",585],"(",["T_VARIABLE","$this",585],["T_OBJECT_OPERATOR","->",585],["T_STRING","__",585],"(",["T_CONSTANT_ENCAPSED_STRING","'Onepage checkout is disabled.'",585],")",",",["T_WHITESPACE"," ",585],["T_STRING","self",585],["T_DOUBLE_COLON","::",585],["T_STRING","MESSAGE_STATUS_ERROR",585],")",";",["T_WHITESPACE","\n            ",585],["T_RETURN","return",586],";",["T_WHITESPACE","\n        ",586],"}",["T_WHITESPACE","\n        ",587],["T_TRY","try",588],["T_WHITESPACE"," ",588],"{",["T_WHITESPACE","\n            ",588],["T_DOC_COMMENT","\/** @var $quote Mage_Sales_Model_Quote *\/",589],["T_WHITESPACE","\n            ",589],["T_VARIABLE","$quote",590],["T_WHITESPACE"," ",590],"=",["T_WHITESPACE"," ",590],["T_VARIABLE","$this",590],["T_OBJECT_OPERATOR","->",590],["T_STRING","getOnepage",590],"(",")",["T_OBJECT_OPERATOR","->",590],["T_STRING","getQuote",590],"(",")",";",["T_WHITESPACE","\n            ",590],["T_IF","if",591],["T_WHITESPACE"," ",591],"(",["T_VARIABLE","$quote",591],["T_OBJECT_OPERATOR","->",591],["T_STRING","getHasError",591],"(",")",")",["T_WHITESPACE"," ",591],"{",["T_WHITESPACE","\n                ",591],["T_VARIABLE","$this",592],["T_OBJECT_OPERATOR","->",592],["T_STRING","_message",592],"(",["T_VARIABLE","$this",592],["T_OBJECT_OPERATOR","->",592],["T_STRING","__",592],"(",["T_CONSTANT_ENCAPSED_STRING","'Cart has some errors.'",592],")",",",["T_WHITESPACE"," ",592],["T_STRING","self",592],["T_DOUBLE_COLON","::",592],["T_STRING","MESSAGE_STATUS_ERROR",592],")",";",["T_WHITESPACE","\n                ",592],["T_RETURN","return",593],";",["T_WHITESPACE","\n            ",593],"}",["T_WHITESPACE"," ",594],["T_ELSEIF","elseif",594],["T_WHITESPACE"," ",594],"(","!",["T_VARIABLE","$quote",594],["T_OBJECT_OPERATOR","->",594],["T_STRING","hasItems",594],"(",")",")",["T_WHITESPACE"," ",594],"{",["T_WHITESPACE","\n                ",594],["T_VARIABLE","$this",595],["T_OBJECT_OPERATOR","->",595],["T_STRING","_message",595],"(",["T_VARIABLE","$this",595],["T_OBJECT_OPERATOR","->",595],["T_STRING","__",595],"(",["T_CONSTANT_ENCAPSED_STRING","'Cart is empty.'",595],")",",",["T_WHITESPACE"," ",595],["T_STRING","self",595],["T_DOUBLE_COLON","::",595],["T_STRING","MESSAGE_STATUS_ERROR",595],")",";",["T_WHITESPACE","\n                ",595],["T_RETURN","return",596],";",["T_WHITESPACE","\n            ",596],"}",["T_WHITESPACE"," ",597],["T_ELSEIF","elseif",597],["T_WHITESPACE"," ",597],"(","!",["T_VARIABLE","$quote",597],["T_OBJECT_OPERATOR","->",597],["T_STRING","validateMinimumAmount",597],"(",")",")",["T_WHITESPACE"," ",597],"{",["T_WHITESPACE","\n                ",597],["T_VARIABLE","$error",598],["T_WHITESPACE"," ",598],"=",["T_WHITESPACE"," ",598],["T_STRING","Mage",598],["T_DOUBLE_COLON","::",598],["T_STRING","getStoreConfig",598],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/minimum_order\/error_message'",598],")",";",["T_WHITESPACE","\n                ",598],["T_VARIABLE","$this",599],["T_OBJECT_OPERATOR","->",599],["T_STRING","_message",599],"(",["T_VARIABLE","$error",599],",",["T_WHITESPACE"," ",599],["T_STRING","self",599],["T_DOUBLE_COLON","::",599],["T_STRING","MESSAGE_STATUS_ERROR",599],")",";",["T_WHITESPACE","\n                ",599],["T_RETURN","return",600],";",["T_WHITESPACE","\n            ",600],"}",["T_WHITESPACE","\n            ",601],["T_STRING","Mage",602],["T_DOUBLE_COLON","::",602],["T_STRING","getSingleton",602],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/session'",602],")",["T_OBJECT_OPERATOR","->",602],["T_STRING","setCartWasUpdated",602],"(",["T_STRING","false",602],")",";",["T_WHITESPACE","\n            ",602],["T_VARIABLE","$this",603],["T_OBJECT_OPERATOR","->",603],["T_STRING","getOnepage",603],"(",")",["T_OBJECT_OPERATOR","->",603],["T_STRING","initCheckout",603],"(",")",";",["T_WHITESPACE","\n\n            ",603],["T_VARIABLE","$this",605],["T_OBJECT_OPERATOR","->",605],["T_STRING","loadLayout",605],"(",["T_STRING","false",605],")",";",["T_WHITESPACE","\n            ",605],["T_VARIABLE","$this",606],["T_OBJECT_OPERATOR","->",606],["T_STRING","renderLayout",606],"(",")",";",["T_WHITESPACE","\n        ",606],"}",["T_WHITESPACE"," ",607],["T_CATCH","catch",607],["T_WHITESPACE"," ",607],"(",["T_STRING","Mage_Core_Exception",607],["T_WHITESPACE"," ",607],["T_VARIABLE","$e",607],")",["T_WHITESPACE"," ",607],"{",["T_WHITESPACE","\n            ",607],["T_VARIABLE","$this",608],["T_OBJECT_OPERATOR","->",608],["T_STRING","_message",608],"(",["T_VARIABLE","$e",608],["T_OBJECT_OPERATOR","->",608],["T_STRING","getMessage",608],"(",")",",",["T_WHITESPACE"," ",608],["T_STRING","self",608],["T_DOUBLE_COLON","::",608],["T_STRING","MESSAGE_STATUS_ERROR",608],")",";",["T_WHITESPACE","\n        ",608],"}",["T_WHITESPACE"," ",609],["T_CATCH","catch",609],["T_WHITESPACE"," ",609],"(",["T_STRING","Exception",609],["T_WHITESPACE"," ",609],["T_VARIABLE","$e",609],")",["T_WHITESPACE"," ",609],"{",["T_WHITESPACE","\n            ",609],["T_VARIABLE","$this",610],["T_OBJECT_OPERATOR","->",610],["T_STRING","_message",610],"(",["T_VARIABLE","$this",610],["T_OBJECT_OPERATOR","->",610],["T_STRING","__",610],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to load addresses.'",610],")",",",["T_WHITESPACE"," ",610],["T_STRING","self",610],["T_DOUBLE_COLON","::",610],["T_STRING","MESSAGE_STATUS_ERROR",610],")",";",["T_WHITESPACE","\n            ",610],["T_STRING","Mage",611],["T_DOUBLE_COLON","::",611],["T_STRING","logException",611],"(",["T_VARIABLE","$e",611],")",";",["T_WHITESPACE","\n        ",611],"}",["T_WHITESPACE","\n    ",612],"}",["T_WHITESPACE","\n\n    ",613],["T_DOC_COMMENT","\/**\n     * Action save customer addresses info\n     *\n     * @return null\n     *\/",615],["T_WHITESPACE","\n    ",619],["T_PUBLIC","public",620],["T_WHITESPACE"," ",620],["T_FUNCTION","function",620],["T_WHITESPACE"," ",620],["T_STRING","saveAddressInfoAction",620],"(",")",["T_WHITESPACE","\n    ",620],"{",["T_WHITESPACE","\n        ",621],["T_IF","if",622],["T_WHITESPACE"," ",622],"(","!",["T_VARIABLE","$this",622],["T_OBJECT_OPERATOR","->",622],["T_STRING","getRequest",622],"(",")",["T_OBJECT_OPERATOR","->",622],["T_STRING","isPost",622],"(",")",")",["T_WHITESPACE"," ",622],"{",["T_WHITESPACE","\n            ",622],["T_VARIABLE","$this",623],["T_OBJECT_OPERATOR","->",623],["T_STRING","_message",623],"(",["T_VARIABLE","$this",623],["T_OBJECT_OPERATOR","->",623],["T_STRING","__",623],"(",["T_CONSTANT_ENCAPSED_STRING","'Specified invalid data.'",623],")",",",["T_WHITESPACE"," ",623],["T_STRING","self",623],["T_DOUBLE_COLON","::",623],["T_STRING","MESSAGE_STATUS_ERROR",623],")",";",["T_WHITESPACE","\n            ",623],["T_RETURN","return",624],";",["T_WHITESPACE","\n        ",624],"}",["T_WHITESPACE","\n\n        ",625],["T_DOC_COMMENT","\/** Save billing address *\/",627],["T_WHITESPACE","\n        ",627],["T_VARIABLE","$useForShipping",628],["T_WHITESPACE"," ",628],"=",["T_WHITESPACE"," ",628],["T_STRING","false",628],";",["T_WHITESPACE","\n        ",628],["T_VARIABLE","$isVirtual",629],["T_WHITESPACE"," ",629],"=",["T_WHITESPACE"," ",629],["T_STRING","Mage",629],["T_DOUBLE_COLON","::",629],["T_STRING","helper",629],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/cart'",629],")",["T_OBJECT_OPERATOR","->",629],["T_STRING","getIsVirtualQuote",629],"(",")",";",["T_WHITESPACE","\n        ",629],["T_VARIABLE","$billingAddressId",630],["T_WHITESPACE"," ",630],"=",["T_WHITESPACE"," ",630],["T_VARIABLE","$this",630],["T_OBJECT_OPERATOR","->",630],["T_STRING","getRequest",630],"(",")",["T_OBJECT_OPERATOR","->",630],["T_STRING","getPost",630],"(",["T_CONSTANT_ENCAPSED_STRING","'billing_address_id'",630],",",["T_WHITESPACE"," ",630],["T_STRING","false",630],")",";",["T_WHITESPACE","\n        ",630],["T_VARIABLE","$billingData",631],["T_WHITESPACE"," ",631],"=",["T_WHITESPACE"," ",631],["T_VARIABLE","$this",631],["T_OBJECT_OPERATOR","->",631],["T_STRING","getRequest",631],"(",")",["T_OBJECT_OPERATOR","->",631],["T_STRING","getPost",631],"(",["T_CONSTANT_ENCAPSED_STRING","'billing'",631],",",["T_WHITESPACE"," ",631],["T_ARRAY","array",631],"(",")",")",";",["T_WHITESPACE","\n        ",631],["T_IF","if",632],["T_WHITESPACE"," ",632],"(",["T_ISSET","isset",632],"(",["T_VARIABLE","$billingData",632],"[",["T_CONSTANT_ENCAPSED_STRING","'use_for_shipping'",632],"]",")",["T_WHITESPACE"," ",632],["T_BOOLEAN_AND","&&",632],["T_WHITESPACE"," ",632],["T_VARIABLE","$billingData",632],"[",["T_CONSTANT_ENCAPSED_STRING","'use_for_shipping'",632],"]",["T_WHITESPACE"," ",632],["T_IS_EQUAL","==",632],["T_WHITESPACE"," ",632],["T_LNUMBER","1",632],")",["T_WHITESPACE"," ",632],"{",["T_WHITESPACE","\n            ",632],["T_VARIABLE","$useForShipping",633],["T_WHITESPACE"," ",633],"=",["T_WHITESPACE"," ",633],["T_STRING","true",633],";",["T_WHITESPACE","\n        ",633],"}",["T_WHITESPACE","\n        ",634],["T_TRY","try",635],["T_WHITESPACE"," ",635],"{",["T_WHITESPACE","\n            ",635],["T_IF","if",636],["T_WHITESPACE"," ",636],"(",["T_VARIABLE","$billingAddressId",636],")",["T_WHITESPACE"," ",636],"{",["T_WHITESPACE","\n                ",636],["T_VARIABLE","$billingData",637],["T_WHITESPACE"," ",637],"=",["T_WHITESPACE"," ",637],["T_STRING","Mage",637],["T_DOUBLE_COLON","::",637],["T_STRING","getModel",637],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/address'",637],")",["T_OBJECT_OPERATOR","->",637],["T_STRING","load",637],"(",["T_VARIABLE","$billingAddressId",637],")",["T_OBJECT_OPERATOR","->",637],["T_STRING","getData",637],"(",")",";",["T_WHITESPACE","\n            ",637],"}",["T_WHITESPACE","\n            ",638],["T_IF","if",639],["T_WHITESPACE"," ",639],"(",["T_ISSET","isset",639],"(",["T_VARIABLE","$billingData",639],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",639],"]",")",")",["T_WHITESPACE"," ",639],"{",["T_WHITESPACE","\n                ",639],["T_VARIABLE","$billingData",640],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",640],"]",["T_WHITESPACE"," ",640],"=",["T_WHITESPACE"," ",640],["T_STRING","trim",640],"(",["T_VARIABLE","$billingData",640],"[",["T_CONSTANT_ENCAPSED_STRING","'email'",640],"]",")",";",["T_WHITESPACE","\n            ",640],"}",["T_WHITESPACE","\n            ",641],["T_VARIABLE","$billingSaveResult",642],["T_WHITESPACE"," ",642],"=",["T_WHITESPACE"," ",642],["T_VARIABLE","$this",642],["T_OBJECT_OPERATOR","->",642],["T_STRING","getOnepage",642],"(",")",["T_OBJECT_OPERATOR","->",642],["T_STRING","saveBilling",642],"(",["T_VARIABLE","$billingData",642],",",["T_WHITESPACE"," ",642],["T_VARIABLE","$billingAddressId",642],")",";",["T_WHITESPACE","\n            ",642],["T_IF","if",643],["T_WHITESPACE"," ",643],"(",["T_ISSET","isset",643],"(",["T_VARIABLE","$billingSaveResult",643],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",643],"]",")",")",["T_WHITESPACE"," ",643],"{",["T_WHITESPACE","\n                ",643],["T_IF","if",644],["T_WHITESPACE"," ",644],"(","!",["T_STRING","is_array",644],"(",["T_VARIABLE","$billingSaveResult",644],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",644],"]",")",")",["T_WHITESPACE"," ",644],"{",["T_WHITESPACE","\n                    ",644],["T_VARIABLE","$billingSaveResult",645],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",645],"]",["T_WHITESPACE"," ",645],"=",["T_WHITESPACE"," ",645],["T_ARRAY","array",645],"(",["T_VARIABLE","$billingSaveResult",645],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",645],"]",")",";",["T_WHITESPACE","\n                ",645],"}",["T_WHITESPACE","\n                ",646],["T_VARIABLE","$this",647],["T_OBJECT_OPERATOR","->",647],["T_STRING","_message",647],"(",["T_STRING","implode",647],"(",["T_CONSTANT_ENCAPSED_STRING","'. '",647],",",["T_WHITESPACE"," ",647],["T_VARIABLE","$billingSaveResult",647],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",647],"]",")",",",["T_WHITESPACE"," ",647],["T_STRING","self",647],["T_DOUBLE_COLON","::",647],["T_STRING","MESSAGE_STATUS_ERROR",647],")",";",["T_WHITESPACE","\n                ",647],["T_RETURN","return",648],";",["T_WHITESPACE","\n            ",648],"}",["T_WHITESPACE","\n\n            ",649],["T_IF","if",651],["T_WHITESPACE"," ",651],"(","!",["T_VARIABLE","$useForShipping",651],["T_WHITESPACE"," ",651],["T_BOOLEAN_AND","&&",651],["T_WHITESPACE"," ",651],"!",["T_VARIABLE","$isVirtual",651],")",["T_WHITESPACE"," ",651],"{",["T_WHITESPACE","\n                ",651],["T_VARIABLE","$shippingAddressId",652],["T_WHITESPACE"," ",652],"=",["T_WHITESPACE"," ",652],["T_VARIABLE","$this",652],["T_OBJECT_OPERATOR","->",652],["T_STRING","getRequest",652],"(",")",["T_OBJECT_OPERATOR","->",652],["T_STRING","getPost",652],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping_address_id'",652],",",["T_WHITESPACE"," ",652],["T_STRING","false",652],")",";",["T_WHITESPACE","\n                ",652],["T_IF","if",653],["T_WHITESPACE"," ",653],"(",["T_VARIABLE","$shippingAddressId",653],")",["T_WHITESPACE"," ",653],"{",["T_WHITESPACE","\n                    ",653],["T_VARIABLE","$shippingData",654],["T_WHITESPACE"," ",654],"=",["T_WHITESPACE"," ",654],["T_STRING","Mage",654],["T_DOUBLE_COLON","::",654],["T_STRING","getModel",654],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/address'",654],")",["T_OBJECT_OPERATOR","->",654],["T_STRING","load",654],"(",["T_VARIABLE","$shippingAddressId",654],")",["T_OBJECT_OPERATOR","->",654],["T_STRING","getData",654],"(",")",";",["T_WHITESPACE","\n                ",654],"}",["T_WHITESPACE"," ",655],["T_ELSE","else",655],["T_WHITESPACE"," ",655],"{",["T_WHITESPACE","\n                    ",655],["T_VARIABLE","$shippingData",656],["T_WHITESPACE"," ",656],"=",["T_WHITESPACE"," ",656],["T_VARIABLE","$this",656],["T_OBJECT_OPERATOR","->",656],["T_STRING","getRequest",656],"(",")",["T_OBJECT_OPERATOR","->",656],["T_STRING","getPost",656],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping'",656],",",["T_WHITESPACE"," ",656],["T_ARRAY","array",656],"(",")",")",";",["T_WHITESPACE","\n                ",656],"}",["T_WHITESPACE","\n                ",657],["T_VARIABLE","$shippingSaveResult",658],["T_WHITESPACE"," ",658],"=",["T_WHITESPACE"," ",658],["T_VARIABLE","$this",658],["T_OBJECT_OPERATOR","->",658],["T_STRING","getOnepage",658],"(",")",["T_OBJECT_OPERATOR","->",658],["T_STRING","saveShipping",658],"(",["T_VARIABLE","$shippingData",658],",",["T_WHITESPACE"," ",658],["T_VARIABLE","$shippingAddressId",658],")",";",["T_WHITESPACE","\n                ",658],["T_IF","if",659],["T_WHITESPACE"," ",659],"(",["T_ISSET","isset",659],"(",["T_VARIABLE","$shippingSaveResult",659],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",659],"]",")",")",["T_WHITESPACE"," ",659],"{",["T_WHITESPACE","\n                    ",659],["T_IF","if",660],["T_WHITESPACE"," ",660],"(","!",["T_STRING","is_array",660],"(",["T_VARIABLE","$shippingSaveResult",660],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",660],"]",")",")",["T_WHITESPACE"," ",660],"{",["T_WHITESPACE","\n                        ",660],["T_VARIABLE","$shippingSaveResult",661],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",661],"]",["T_WHITESPACE"," ",661],"=",["T_WHITESPACE"," ",661],["T_ARRAY","array",661],"(",["T_VARIABLE","$shippingSaveResult",661],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",661],"]",")",";",["T_WHITESPACE","\n                    ",661],"}",["T_WHITESPACE","\n                    ",662],["T_VARIABLE","$this",663],["T_OBJECT_OPERATOR","->",663],["T_STRING","_message",663],"(",["T_STRING","implode",663],"(",["T_CONSTANT_ENCAPSED_STRING","'. '",663],",",["T_WHITESPACE"," ",663],["T_VARIABLE","$shippingSaveResult",663],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",663],"]",")",",",["T_WHITESPACE"," ",663],["T_STRING","self",663],["T_DOUBLE_COLON","::",663],["T_STRING","MESSAGE_STATUS_ERROR",663],")",";",["T_WHITESPACE","\n                    ",663],["T_RETURN","return",664],";",["T_WHITESPACE","\n                ",664],"}",["T_WHITESPACE","\n            ",665],"}",["T_WHITESPACE"," ",666],["T_ELSE","else",666],["T_WHITESPACE"," ",666],"{",["T_WHITESPACE","\n                ",666],["T_VARIABLE","$result",667],["T_WHITESPACE"," ",667],"=",["T_WHITESPACE"," ",667],["T_VARIABLE","$this",667],["T_OBJECT_OPERATOR","->",667],["T_STRING","getOnepage",667],"(",")",["T_OBJECT_OPERATOR","->",667],["T_STRING","saveShipping",667],"(",["T_VARIABLE","$billingData",667],",",["T_WHITESPACE"," ",667],["T_VARIABLE","$billingAddressId",667],")",";",["T_WHITESPACE","\n                ",667],["T_IF","if",668],["T_WHITESPACE"," ",668],"(",["T_ISSET","isset",668],"(",["T_VARIABLE","$result",668],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",668],"]",")",")",["T_WHITESPACE"," ",668],"{",["T_WHITESPACE","\n                    ",668],["T_IF","if",669],["T_WHITESPACE"," ",669],"(","!",["T_STRING","is_array",669],"(",["T_VARIABLE","$result",669],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",669],"]",")",")",["T_WHITESPACE"," ",669],"{",["T_WHITESPACE","\n                        ",669],["T_VARIABLE","$result",670],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",670],"]",["T_WHITESPACE"," ",670],"=",["T_WHITESPACE"," ",670],["T_ARRAY","array",670],"(",["T_VARIABLE","$result",670],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",670],"]",")",";",["T_WHITESPACE","\n                    ",670],"}",["T_WHITESPACE","\n                    ",671],["T_VARIABLE","$this",672],["T_OBJECT_OPERATOR","->",672],["T_STRING","_message",672],"(",["T_STRING","implode",672],"(",["T_CONSTANT_ENCAPSED_STRING","'. '",672],",",["T_WHITESPACE"," ",672],["T_VARIABLE","$result",672],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",672],"]",")",",",["T_WHITESPACE"," ",672],["T_STRING","self",672],["T_DOUBLE_COLON","::",672],["T_STRING","MESSAGE_STATUS_ERROR",672],")",";",["T_WHITESPACE","\n                    ",672],["T_RETURN","return",673],";",["T_WHITESPACE","\n                ",673],"}",["T_WHITESPACE","\n            ",674],"}",["T_WHITESPACE","\n\n            ",675],["T_IF","if",677],["T_WHITESPACE"," ",677],"(",["T_VARIABLE","$isVirtual",677],")",["T_WHITESPACE"," ",677],"{",["T_WHITESPACE","\n                ",677],["T_DOC_COMMENT","\/** If quote is virtual - redirect to payment methods list *\/",678],["T_WHITESPACE","\n                ",678],["T_VARIABLE","$this",679],["T_OBJECT_OPERATOR","->",679],["T_STRING","_forward",679],"(",["T_CONSTANT_ENCAPSED_STRING","'paymentmethods'",679],",",["T_WHITESPACE"," ",679],["T_STRING","null",679],",",["T_WHITESPACE"," ",679],["T_STRING","null",679],",",["T_WHITESPACE"," ",679],["T_ARRAY","array",679],"(",["T_WHITESPACE","\n                    ",679],["T_STRING","Mage_XmlConnect_Helper_Data",680],["T_DOUBLE_COLON","::",680],["T_STRING","API_VERSION_REQUEST_PARAM",680],["T_WHITESPACE","\n                        ",680],["T_DOUBLE_ARROW","=>",681],["T_WHITESPACE"," ",681],["T_STRING","Mage_XmlConnect_Helper_Data",681],["T_DOUBLE_COLON","::",681],["T_STRING","DEVICE_API_V_23",681],["T_WHITESPACE","\n                ",681],")",")",";",["T_WHITESPACE","\n            ",682],"}",["T_WHITESPACE"," ",683],["T_ELSE","else",683],["T_WHITESPACE"," ",683],"{",["T_WHITESPACE","\n                ",683],["T_DOC_COMMENT","\/** Redirect to shipping methods list *\/",684],["T_WHITESPACE","\n                ",684],["T_VARIABLE","$this",685],["T_OBJECT_OPERATOR","->",685],["T_STRING","_forward",685],"(",["T_CONSTANT_ENCAPSED_STRING","'shippingMethodsList'",685],")",";",["T_WHITESPACE","\n            ",685],"}",["T_WHITESPACE","\n            ",686],["T_RETURN","return",687],";",["T_WHITESPACE","\n        ",687],"}",["T_WHITESPACE"," ",688],["T_CATCH","catch",688],["T_WHITESPACE"," ",688],"(",["T_STRING","Mage_Core_Exception",688],["T_WHITESPACE"," ",688],["T_VARIABLE","$e",688],")",["T_WHITESPACE"," ",688],"{",["T_WHITESPACE","\n            ",688],["T_VARIABLE","$this",689],["T_OBJECT_OPERATOR","->",689],["T_STRING","_message",689],"(",["T_VARIABLE","$e",689],["T_OBJECT_OPERATOR","->",689],["T_STRING","getMessage",689],"(",")",",",["T_WHITESPACE"," ",689],["T_STRING","self",689],["T_DOUBLE_COLON","::",689],["T_STRING","MESSAGE_STATUS_ERROR",689],")",";",["T_WHITESPACE","\n            ",689],["T_STRING","Mage",690],["T_DOUBLE_COLON","::",690],["T_STRING","logException",690],"(",["T_VARIABLE","$e",690],")",";",["T_WHITESPACE","\n        ",690],"}",["T_WHITESPACE"," ",691],["T_CATCH","catch",691],["T_WHITESPACE"," ",691],"(",["T_STRING","Exception",691],["T_WHITESPACE"," ",691],["T_VARIABLE","$e",691],")",["T_WHITESPACE"," ",691],"{",["T_WHITESPACE","\n            ",691],["T_VARIABLE","$this",692],["T_OBJECT_OPERATOR","->",692],["T_STRING","_message",692],"(",["T_VARIABLE","$this",692],["T_OBJECT_OPERATOR","->",692],["T_STRING","__",692],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to load addresses.'",692],")",",",["T_WHITESPACE"," ",692],["T_STRING","self",692],["T_DOUBLE_COLON","::",692],["T_STRING","MESSAGE_STATUS_ERROR",692],")",";",["T_WHITESPACE","\n            ",692],["T_STRING","Mage",693],["T_DOUBLE_COLON","::",693],["T_STRING","logException",693],"(",["T_VARIABLE","$e",693],")",";",["T_WHITESPACE","\n        ",693],"}",["T_WHITESPACE","\n    ",694],"}",["T_WHITESPACE","\n",695],"}",["T_WHITESPACE","\n",696]]