[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_XmlConnect\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Catalog category link model\n *\n * @category    Mage\n * @package     Mage_XmlConnect\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_XmlConnect_Model_Catalog_Category_Image",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Catalog_Model_Product_Image",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Set file names for base file and new file\n     *\n     * @param string $file\n     * @return Mage_Catalog_Model_Product_Image\n     *\/",36],["T_WHITESPACE","\n    ",41],["T_PUBLIC","public",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","setBaseFile",42],"(",["T_VARIABLE","$file",42],")",["T_WHITESPACE","\n    ",42],"{",["T_WHITESPACE","\n        ",43],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","_isBaseFilePlaceholder",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_STRING","false",44],";",["T_WHITESPACE","\n\n        ",44],["T_IF","if",46],["T_WHITESPACE"," ",46],"(","(",["T_VARIABLE","$file",46],")",["T_WHITESPACE"," ",46],["T_BOOLEAN_AND","&&",46],["T_WHITESPACE"," ",46],"(",["T_LNUMBER","0",46],["T_WHITESPACE"," ",46],["T_IS_NOT_IDENTICAL","!==",46],["T_WHITESPACE"," ",46],["T_STRING","strpos",46],"(",["T_VARIABLE","$file",46],",",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'\/'",46],",",["T_WHITESPACE"," ",46],["T_LNUMBER","0",46],")",")",")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n            ",46],["T_VARIABLE","$file",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_CONSTANT_ENCAPSED_STRING","'\/'",47],["T_WHITESPACE"," ",47],".",["T_WHITESPACE"," ",47],["T_VARIABLE","$file",47],";",["T_WHITESPACE","\n        ",47],"}",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$baseDir",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_STRING","Mage",49],["T_DOUBLE_COLON","::",49],["T_STRING","getSingleton",49],"(",["T_CONSTANT_ENCAPSED_STRING","'xmlconnect\/catalog_category_media_config'",49],")",["T_OBJECT_OPERATOR","->",49],["T_STRING","getBaseMediaPath",49],"(",")",";",["T_WHITESPACE","\n\n        ",49],["T_IF","if",51],["T_WHITESPACE"," ",51],"(",["T_CONSTANT_ENCAPSED_STRING","'\/no_selection'",51],["T_WHITESPACE"," ",51],["T_IS_EQUAL","==",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$file",51],")",["T_WHITESPACE"," ",51],"{",["T_WHITESPACE","\n            ",51],["T_VARIABLE","$file",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_STRING","null",52],";",["T_WHITESPACE","\n        ",52],"}",["T_WHITESPACE","\n        ",53],["T_IF","if",54],["T_WHITESPACE"," ",54],"(",["T_VARIABLE","$file",54],")",["T_WHITESPACE"," ",54],"{",["T_WHITESPACE","\n            ",54],["T_IF","if",55],["T_WHITESPACE"," ",55],"(","(","!",["T_STRING","file_exists",55],"(",["T_VARIABLE","$baseDir",55],["T_WHITESPACE"," ",55],".",["T_WHITESPACE"," ",55],["T_VARIABLE","$file",55],")",")",["T_WHITESPACE"," ",55],["T_BOOLEAN_OR","||",55],["T_WHITESPACE"," ",55],"!",["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","_checkMemory",55],"(",["T_VARIABLE","$baseDir",55],["T_WHITESPACE"," ",55],".",["T_WHITESPACE"," ",55],["T_VARIABLE","$file",55],")",")",["T_WHITESPACE"," ",55],"{",["T_WHITESPACE","\n                ",55],["T_VARIABLE","$file",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_STRING","null",56],";",["T_WHITESPACE","\n            ",56],"}",["T_WHITESPACE","\n        ",57],"}",["T_WHITESPACE","\n        ",58],["T_IF","if",59],["T_WHITESPACE"," ",59],"(","!",["T_VARIABLE","$file",59],")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n            ",59],["T_COMMENT","\/\/ check if placeholder defined in config\n",60],["T_WHITESPACE","            ",61],["T_VARIABLE","$isConfigPlaceholder",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_STRING","Mage",61],["T_DOUBLE_COLON","::",61],["T_STRING","getStoreConfig",61],"(",["T_WHITESPACE","\n                ",61],["T_CONSTANT_ENCAPSED_STRING","'catalog\/placeholder\/'",62],["T_WHITESPACE"," ",62],".",["T_WHITESPACE"," ",62],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","getDestinationSubdir",62],"(",")",["T_WHITESPACE"," ",62],".",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'_placeholder'",62],["T_WHITESPACE","\n            ",62],")",";",["T_WHITESPACE","\n            ",63],["T_VARIABLE","$configPlaceholder",64],["T_WHITESPACE","   ",64],"=",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'\/placeholder\/'",64],["T_WHITESPACE"," ",64],".",["T_WHITESPACE"," ",64],["T_VARIABLE","$isConfigPlaceholder",64],";",["T_WHITESPACE","\n            ",64],["T_IF","if",65],["T_WHITESPACE"," ",65],"(",["T_VARIABLE","$isConfigPlaceholder",65],["T_WHITESPACE"," ",65],["T_BOOLEAN_AND","&&",65],["T_WHITESPACE"," ",65],["T_STRING","file_exists",65],"(",["T_VARIABLE","$baseDir",65],["T_WHITESPACE"," ",65],".",["T_WHITESPACE"," ",65],["T_VARIABLE","$configPlaceholder",65],")",")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n                ",65],["T_VARIABLE","$file",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$configPlaceholder",66],";",["T_WHITESPACE","\n            ",66],"}",["T_WHITESPACE"," ",67],["T_ELSE","else",67],["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n                ",67],["T_COMMENT","\/\/ replace file with skin or default skin placeholder\n",68],["T_WHITESPACE","                ",69],["T_VARIABLE","$skinBaseDir",69],["T_WHITESPACE","     ",69],"=",["T_WHITESPACE"," ",69],["T_STRING","Mage",69],["T_DOUBLE_COLON","::",69],["T_STRING","getDesign",69],"(",")",["T_OBJECT_OPERATOR","->",69],["T_STRING","getSkinBaseDir",69],"(",")",";",["T_WHITESPACE","\n                ",69],["T_VARIABLE","$skinPlaceholder",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'\/images\/xmlconnect\/catalog\/category\/placeholder\/'",70],["T_WHITESPACE"," ",70],".",["T_WHITESPACE"," ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getDestinationSubdir",70],"(",")",["T_WHITESPACE","\n                    ",70],".",["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'.jpg'",71],";",["T_WHITESPACE","\n\n                ",71],["T_VARIABLE","$file",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$skinPlaceholder",73],";",["T_WHITESPACE","\n                ",73],["T_IF","if",74],["T_WHITESPACE"," ",74],"(",["T_STRING","file_exists",74],"(",["T_VARIABLE","$skinBaseDir",74],["T_WHITESPACE"," ",74],".",["T_WHITESPACE"," ",74],["T_VARIABLE","$file",74],")",")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n                    ",74],["T_VARIABLE","$baseDir",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$skinBaseDir",75],";",["T_WHITESPACE","\n                ",75],"}",["T_WHITESPACE"," ",76],["T_ELSE","else",76],["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n                    ",76],["T_VARIABLE","$baseDir",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_STRING","Mage",77],["T_DOUBLE_COLON","::",77],["T_STRING","getDesign",77],"(",")",["T_OBJECT_OPERATOR","->",77],["T_STRING","getSkinBaseDir",77],"(",["T_ARRAY","array",77],"(",["T_CONSTANT_ENCAPSED_STRING","'_theme'",77],["T_WHITESPACE"," ",77],["T_DOUBLE_ARROW","=>",77],["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","'default'",77],")",")",";",["T_WHITESPACE","\n                    ",77],["T_IF","if",78],["T_WHITESPACE"," ",78],"(","!",["T_STRING","file_exists",78],"(",["T_VARIABLE","$baseDir",78],["T_WHITESPACE"," ",78],".",["T_WHITESPACE"," ",78],["T_VARIABLE","$file",78],")",")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n                        ",78],["T_VARIABLE","$baseDir",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_STRING","Mage",79],["T_DOUBLE_COLON","::",79],["T_STRING","getDesign",79],"(",")",["T_OBJECT_OPERATOR","->",79],["T_STRING","getSkinBaseDir",79],"(",["T_WHITESPACE","\n                            ",79],["T_ARRAY","array",80],"(",["T_CONSTANT_ENCAPSED_STRING","'_theme'",80],["T_WHITESPACE"," ",80],["T_DOUBLE_ARROW","=>",80],["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'default'",80],",",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'_package'",80],["T_WHITESPACE"," ",80],["T_DOUBLE_ARROW","=>",80],["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'base'",80],")",["T_WHITESPACE","\n                        ",80],")",";",["T_WHITESPACE","\n                    ",81],"}",["T_WHITESPACE","\n                ",82],"}",["T_WHITESPACE","\n            ",83],"}",["T_WHITESPACE","\n            ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","_isBaseFilePlaceholder",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_STRING","true",85],";",["T_WHITESPACE","\n        ",85],"}",["T_WHITESPACE","\n\n        ",86],["T_VARIABLE","$baseFile",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$baseDir",88],["T_WHITESPACE"," ",88],".",["T_WHITESPACE"," ",88],["T_VARIABLE","$file",88],";",["T_WHITESPACE","\n\n        ",88],["T_IF","if",90],["T_WHITESPACE"," ",90],"(","(","!",["T_VARIABLE","$file",90],")",["T_WHITESPACE"," ",90],["T_BOOLEAN_OR","||",90],["T_WHITESPACE"," ",90],"(","!",["T_STRING","file_exists",90],"(",["T_VARIABLE","$baseFile",90],")",")",")",["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n            ",90],["T_STRING","Mage",91],["T_DOUBLE_COLON","::",91],["T_STRING","throwException",91],"(",["T_STRING","Mage",91],["T_DOUBLE_COLON","::",91],["T_STRING","helper",91],"(",["T_CONSTANT_ENCAPSED_STRING","'xmlconnect'",91],")",["T_OBJECT_OPERATOR","->",91],["T_STRING","__",91],"(",["T_CONSTANT_ENCAPSED_STRING","'Image file was not found.'",91],")",")",";",["T_WHITESPACE","\n        ",91],"}",["T_WHITESPACE","\n\n        ",92],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","_baseFile",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_VARIABLE","$baseFile",94],";",["T_WHITESPACE","\n\n        ",94],["T_COMMENT","\/\/ build new filename (most important params)\n",96],["T_WHITESPACE","        ",97],["T_VARIABLE","$path",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_ARRAY","array",97],"(",["T_STRING","Mage",97],["T_DOUBLE_COLON","::",97],["T_STRING","getSingleton",97],"(",["T_CONSTANT_ENCAPSED_STRING","'xmlconnect\/catalog_category_media_config'",97],")",["T_OBJECT_OPERATOR","->",97],["T_STRING","getBaseMediaPath",97],"(",")",",",["T_WHITESPACE","\n            ",97],["T_CONSTANT_ENCAPSED_STRING","'cache'",98],",",["T_WHITESPACE"," ",98],["T_STRING","Mage",98],["T_DOUBLE_COLON","::",98],["T_STRING","app",98],"(",")",["T_OBJECT_OPERATOR","->",98],["T_STRING","getStore",98],"(",")",["T_OBJECT_OPERATOR","->",98],["T_STRING","getId",98],"(",")",",",["T_WHITESPACE"," ",98],["T_VARIABLE","$path",98],"[","]",["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getDestinationSubdir",98],"(",")",")",";",["T_WHITESPACE","\n\n        ",98],["T_IF","if",100],["T_WHITESPACE"," ",100],"(","(","!",["T_EMPTY","empty",100],"(",["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","_width",100],")",")",["T_WHITESPACE"," ",100],["T_BOOLEAN_OR","||",100],["T_WHITESPACE"," ",100],"(","!",["T_EMPTY","empty",100],"(",["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","_height",100],")",")",")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n            ",100],["T_VARIABLE","$path",101],"[","]",["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],"\"",["T_CURLY_OPEN","{",101],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","_width",101],"}",["T_ENCAPSED_AND_WHITESPACE","x",101],["T_CURLY_OPEN","{",101],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","_height",101],"}","\"",";",["T_WHITESPACE","\n        ",101],"}",["T_WHITESPACE","\n\n        ",102],["T_COMMENT","\/\/ add misk params as a hash\n",104],["T_WHITESPACE","        ",105],["T_VARIABLE","$miscParams",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_ARRAY","array",105],"(",["T_WHITESPACE","\n            ",105],"(",["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","_keepAspectRatio",106],["T_WHITESPACE","  ",106],"?",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","''",106],["T_WHITESPACE"," ",106],":",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'non'",106],")",["T_WHITESPACE"," ",106],".",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'proportional'",106],",",["T_WHITESPACE","\n            ",106],"(",["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","_keepFrame",107],["T_WHITESPACE","        ",107],"?",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","''",107],["T_WHITESPACE"," ",107],":",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'no'",107],")",["T_WHITESPACE","  ",107],".",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'frame'",107],",",["T_WHITESPACE","\n            ",107],"(",["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","_keepTransparency",108],["T_WHITESPACE"," ",108],"?",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","''",108],["T_WHITESPACE"," ",108],":",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'no'",108],")",["T_WHITESPACE","  ",108],".",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'transparency'",108],",",["T_WHITESPACE","\n            ",108],"(",["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","_constrainOnly",109],["T_WHITESPACE"," ",109],"?",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'do'",109],["T_WHITESPACE"," ",109],":",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'not'",109],")",["T_WHITESPACE","  ",109],".",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'constrainonly'",109],",",["T_WHITESPACE","\n            ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","_rgbToString",110],"(",["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","_backgroundColor",110],")",",",["T_WHITESPACE","\n            ",110],["T_CONSTANT_ENCAPSED_STRING","'angle'",111],["T_WHITESPACE"," ",111],".",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","_angle",111],",",["T_WHITESPACE","\n            ",111],["T_CONSTANT_ENCAPSED_STRING","'quality'",112],["T_WHITESPACE"," ",112],".",["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","_quality",112],["T_WHITESPACE","\n        ",112],")",";",["T_WHITESPACE","\n\n        ",113],["T_COMMENT","\/\/ if has watermark add watermark params to hash\n",115],["T_WHITESPACE","        ",116],["T_IF","if",116],["T_WHITESPACE"," ",116],"(",["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getWatermarkFile",116],"(",")",")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n            ",116],["T_VARIABLE","$miscParams",117],"[","]",["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getWatermarkFile",117],"(",")",";",["T_WHITESPACE","\n            ",117],["T_VARIABLE","$miscParams",118],"[","]",["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","getWatermarkImageOpacity",118],"(",")",";",["T_WHITESPACE","\n            ",118],["T_VARIABLE","$miscParams",119],"[","]",["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getWatermarkPosition",119],"(",")",";",["T_WHITESPACE","\n            ",119],["T_VARIABLE","$miscParams",120],"[","]",["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","getWatermarkWidth",120],"(",")",";",["T_WHITESPACE","\n            ",120],["T_VARIABLE","$miscParams",121],"[","]",["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","getWatermarkHeigth",121],"(",")",";",["T_WHITESPACE","\n        ",121],"}",["T_WHITESPACE","\n\n        ",122],["T_VARIABLE","$path",124],"[","]",["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_STRING","md5",124],"(",["T_STRING","implode",124],"(",["T_CONSTANT_ENCAPSED_STRING","'_'",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$miscParams",124],")",")",";",["T_WHITESPACE","\n\n        ",124],["T_COMMENT","\/\/ append prepared filename\n",126],["T_WHITESPACE","        ",127],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","_newFile",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_STRING","implode",127],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",127],",",["T_WHITESPACE"," ",127],["T_VARIABLE","$path",127],")",["T_WHITESPACE"," ",127],".",["T_WHITESPACE"," ",127],["T_VARIABLE","$file",127],";",["T_WHITESPACE"," ",127],["T_COMMENT","\/\/ the $file contains heading slash\n",127],["T_WHITESPACE","\n        ",128],["T_RETURN","return",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$this",129],";",["T_WHITESPACE","\n    ",129],"}",["T_WHITESPACE","\n\n    ",130],["T_DOC_COMMENT","\/**\n     * Set new file\n     *\n     * @param string $filePath\n     * @return Mage_XmlConnect_Model_Catalog_Category_Image\n     *\/",132],["T_WHITESPACE","\n    ",137],["T_PUBLIC","public",138],["T_WHITESPACE"," ",138],["T_FUNCTION","function",138],["T_WHITESPACE"," ",138],["T_STRING","setNewFile",138],"(",["T_VARIABLE","$filePath",138],")",["T_WHITESPACE","\n    ",138],"{",["T_WHITESPACE","\n        ",139],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","_newFile",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_VARIABLE","$filePath",140],";",["T_WHITESPACE","\n        ",140],["T_RETURN","return",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$this",141],";",["T_WHITESPACE","\n    ",141],"}",["T_WHITESPACE","\n\n    ",142],["T_DOC_COMMENT","\/**\n     * Get relative watermark file path\n     * or false if file not found\n     *\n     * @return string|bool\n     *\/",144],["T_WHITESPACE","\n    ",149],["T_PROTECTED","protected",150],["T_WHITESPACE"," ",150],["T_FUNCTION","function",150],["T_WHITESPACE"," ",150],["T_STRING","_getWatermarkFilePath",150],"(",")",["T_WHITESPACE","\n    ",150],"{",["T_WHITESPACE","\n        ",151],["T_VARIABLE","$filePath",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_STRING","false",152],";",["T_WHITESPACE","\n\n        ",152],["T_IF","if",154],["T_WHITESPACE"," ",154],"(","!",["T_VARIABLE","$file",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","getWatermarkFile",154],"(",")",")",["T_WHITESPACE"," ",154],"{",["T_WHITESPACE","\n            ",154],["T_RETURN","return",155],["T_WHITESPACE"," ",155],["T_VARIABLE","$filePath",155],";",["T_WHITESPACE","\n        ",155],"}",["T_WHITESPACE","\n\n        ",156],["T_VARIABLE","$baseDir",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_STRING","Mage",158],["T_DOUBLE_COLON","::",158],["T_STRING","getSingleton",158],"(",["T_CONSTANT_ENCAPSED_STRING","'xmlconnect\/catalog_category_media_config'",158],")",["T_OBJECT_OPERATOR","->",158],["T_STRING","getBaseMediaPath",158],"(",")",";",["T_WHITESPACE","\n\n        ",158],["T_IF","if",160],["T_WHITESPACE"," ",160],"(",["T_STRING","file_exists",160],"(",["T_VARIABLE","$baseDir",160],["T_WHITESPACE"," ",160],".",["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","'\/watermark\/stores\/'",160],["T_WHITESPACE"," ",160],".",["T_WHITESPACE"," ",160],["T_STRING","Mage",160],["T_DOUBLE_COLON","::",160],["T_STRING","app",160],"(",")",["T_OBJECT_OPERATOR","->",160],["T_STRING","getStore",160],"(",")",["T_OBJECT_OPERATOR","->",160],["T_STRING","getId",160],"(",")",["T_WHITESPACE"," ",160],".",["T_WHITESPACE"," ",160],["T_VARIABLE","$file",160],")",")",["T_WHITESPACE"," ",160],"{",["T_WHITESPACE","\n            ",160],["T_VARIABLE","$filePath",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_VARIABLE","$baseDir",161],["T_WHITESPACE"," ",161],".",["T_WHITESPACE"," ",161],["T_CONSTANT_ENCAPSED_STRING","'\/watermark\/stores\/'",161],["T_WHITESPACE"," ",161],".",["T_WHITESPACE"," ",161],["T_STRING","Mage",161],["T_DOUBLE_COLON","::",161],["T_STRING","app",161],"(",")",["T_OBJECT_OPERATOR","->",161],["T_STRING","getStore",161],"(",")",["T_OBJECT_OPERATOR","->",161],["T_STRING","getId",161],"(",")",["T_WHITESPACE"," ",161],".",["T_WHITESPACE"," ",161],["T_VARIABLE","$file",161],";",["T_WHITESPACE","\n        ",161],"}",["T_WHITESPACE"," ",162],["T_ELSEIF","elseif",162],["T_WHITESPACE"," ",162],"(",["T_STRING","file_exists",162],"(",["T_VARIABLE","$baseDir",162],["T_WHITESPACE"," ",162],".",["T_WHITESPACE"," ",162],["T_CONSTANT_ENCAPSED_STRING","'\/watermark\/websites\/'",162],["T_WHITESPACE"," ",162],".",["T_WHITESPACE"," ",162],["T_STRING","Mage",162],["T_DOUBLE_COLON","::",162],["T_STRING","app",162],"(",")",["T_OBJECT_OPERATOR","->",162],["T_STRING","getWebsite",162],"(",")",["T_OBJECT_OPERATOR","->",162],["T_STRING","getId",162],"(",")",["T_WHITESPACE"," ",162],".",["T_WHITESPACE"," ",162],["T_VARIABLE","$file",162],")",")",["T_WHITESPACE"," ",162],"{",["T_WHITESPACE","\n            ",162],["T_VARIABLE","$filePath",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_VARIABLE","$baseDir",163],["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","'\/watermark\/websites\/'",163],["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_STRING","Mage",163],["T_DOUBLE_COLON","::",163],["T_STRING","app",163],"(",")",["T_OBJECT_OPERATOR","->",163],["T_STRING","getWebsite",163],"(",")",["T_OBJECT_OPERATOR","->",163],["T_STRING","getId",163],"(",")",["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_VARIABLE","$file",163],";",["T_WHITESPACE","\n        ",163],"}",["T_WHITESPACE"," ",164],["T_ELSEIF","elseif",164],["T_WHITESPACE"," ",164],"(",["T_STRING","file_exists",164],"(",["T_VARIABLE","$baseDir",164],["T_WHITESPACE"," ",164],".",["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","'\/watermark\/default\/'",164],["T_WHITESPACE"," ",164],".",["T_WHITESPACE"," ",164],["T_VARIABLE","$file",164],")",")",["T_WHITESPACE"," ",164],"{",["T_WHITESPACE","\n            ",164],["T_VARIABLE","$filePath",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_VARIABLE","$baseDir",165],["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","'\/watermark\/default\/'",165],["T_WHITESPACE"," ",165],".",["T_WHITESPACE"," ",165],["T_VARIABLE","$file",165],";",["T_WHITESPACE","\n        ",165],"}",["T_WHITESPACE"," ",166],["T_ELSEIF","elseif",166],["T_WHITESPACE"," ",166],"(",["T_STRING","file_exists",166],"(",["T_VARIABLE","$baseDir",166],["T_WHITESPACE"," ",166],".",["T_WHITESPACE"," ",166],["T_CONSTANT_ENCAPSED_STRING","'\/watermark\/'",166],["T_WHITESPACE"," ",166],".",["T_WHITESPACE"," ",166],["T_VARIABLE","$file",166],")",")",["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n            ",166],["T_VARIABLE","$filePath",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_VARIABLE","$baseDir",167],["T_WHITESPACE"," ",167],".",["T_WHITESPACE"," ",167],["T_CONSTANT_ENCAPSED_STRING","'\/watermark\/'",167],["T_WHITESPACE"," ",167],".",["T_WHITESPACE"," ",167],["T_VARIABLE","$file",167],";",["T_WHITESPACE","\n        ",167],"}",["T_WHITESPACE"," ",168],["T_ELSE","else",168],["T_WHITESPACE"," ",168],"{",["T_WHITESPACE","\n            ",168],["T_VARIABLE","$baseDir",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_STRING","Mage",169],["T_DOUBLE_COLON","::",169],["T_STRING","getDesign",169],"(",")",["T_OBJECT_OPERATOR","->",169],["T_STRING","getSkinBaseDir",169],"(",")",";",["T_WHITESPACE","\n            ",169],["T_IF","if",170],["T_WHITESPACE"," ",170],"(",["T_STRING","file_exists",170],"(",["T_VARIABLE","$baseDir",170],["T_WHITESPACE"," ",170],".",["T_WHITESPACE"," ",170],["T_VARIABLE","$file",170],")",")",["T_WHITESPACE"," ",170],"{",["T_WHITESPACE","\n                ",170],["T_VARIABLE","$filePath",171],["T_WHITESPACE"," ",171],"=",["T_WHITESPACE"," ",171],["T_VARIABLE","$baseDir",171],["T_WHITESPACE"," ",171],".",["T_WHITESPACE"," ",171],["T_VARIABLE","$file",171],";",["T_WHITESPACE","\n            ",171],"}",["T_WHITESPACE","\n        ",172],"}",["T_WHITESPACE","\n\n        ",173],["T_RETURN","return",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$filePath",175],";",["T_WHITESPACE","\n    ",175],"}",["T_WHITESPACE","\n\n    ",176],["T_DOC_COMMENT","\/**\n     * Clear catalog cache\n     *\n     * @return null\n     *\/",178],["T_WHITESPACE","\n    ",182],["T_PUBLIC","public",183],["T_WHITESPACE"," ",183],["T_FUNCTION","function",183],["T_WHITESPACE"," ",183],["T_STRING","clearCache",183],"(",")",["T_WHITESPACE","\n    ",183],"{",["T_WHITESPACE","\n        ",184],["T_VARIABLE","$directory",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_STRING","Mage",185],["T_DOUBLE_COLON","::",185],["T_STRING","getBaseDir",185],"(",["T_CONSTANT_ENCAPSED_STRING","'media'",185],")",["T_WHITESPACE"," ",185],".",["T_WHITESPACE"," ",185],["T_STRING","DS",185],["T_WHITESPACE"," ",185],".",["T_WHITESPACE"," ",185],["T_CONSTANT_ENCAPSED_STRING","'catalog'",185],["T_WHITESPACE"," ",185],".",["T_WHITESPACE"," ",185],["T_STRING","DS",185],["T_WHITESPACE"," ",185],".",["T_WHITESPACE"," ",185],["T_CONSTANT_ENCAPSED_STRING","'category'",185],["T_WHITESPACE"," ",185],".",["T_WHITESPACE"," ",185],["T_STRING","DS",185],["T_WHITESPACE"," ",185],".",["T_WHITESPACE"," ",185],["T_CONSTANT_ENCAPSED_STRING","'cache'",185],["T_WHITESPACE"," ",185],".",["T_WHITESPACE"," ",185],["T_STRING","DS",185],";",["T_WHITESPACE","\n        ",185],["T_VARIABLE","$ioFile",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_NEW","new",186],["T_WHITESPACE"," ",186],["T_STRING","Varien_Io_File",186],"(",")",";",["T_WHITESPACE","\n        ",186],["T_VARIABLE","$ioFile",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","rmdir",187],"(",["T_VARIABLE","$directory",187],",",["T_WHITESPACE"," ",187],["T_STRING","true",187],")",";",["T_WHITESPACE","\n    ",187],"}",["T_WHITESPACE","\n\n    ",188],["T_DOC_COMMENT","\/**\n     * Convert array of 3 items (decimal r, g, b) to string of their hex values\n     *\n     * @param array $rgbArray\n     * @return string\n     *\/",190],["T_WHITESPACE","\n    ",195],["T_PROTECTED","protected",196],["T_WHITESPACE"," ",196],["T_FUNCTION","function",196],["T_WHITESPACE"," ",196],["T_STRING","_rgbToString",196],"(",["T_VARIABLE","$rgbArray",196],")",["T_WHITESPACE","\n    ",196],"{",["T_WHITESPACE","\n        ",197],["T_VARIABLE","$result",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_ARRAY","array",198],"(",")",";",["T_WHITESPACE","\n        ",198],["T_FOREACH","foreach",199],["T_WHITESPACE"," ",199],"(",["T_VARIABLE","$rgbArray",199],["T_WHITESPACE"," ",199],["T_AS","as",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$value",199],")",["T_WHITESPACE"," ",199],"{",["T_WHITESPACE","\n            ",199],["T_IF","if",200],["T_WHITESPACE"," ",200],"(",["T_STRING","null",200],["T_WHITESPACE"," ",200],["T_IS_IDENTICAL","===",200],["T_WHITESPACE"," ",200],["T_VARIABLE","$value",200],")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n                ",200],["T_VARIABLE","$result",201],"[","]",["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_CONSTANT_ENCAPSED_STRING","'null'",201],";",["T_WHITESPACE","\n            ",201],"}",["T_WHITESPACE"," ",202],["T_ELSE","else",202],["T_WHITESPACE"," ",202],"{",["T_WHITESPACE","\n                ",202],["T_VARIABLE","$result",203],"[","]",["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_STRING","sprintf",203],"(",["T_CONSTANT_ENCAPSED_STRING","'%02s'",203],",",["T_WHITESPACE"," ",203],["T_STRING","dechex",203],"(",["T_VARIABLE","$value",203],")",")",";",["T_WHITESPACE","\n            ",203],"}",["T_WHITESPACE","\n        ",204],"}",["T_WHITESPACE","\n        ",205],["T_RETURN","return",206],["T_WHITESPACE"," ",206],["T_STRING","implode",206],"(",["T_VARIABLE","$result",206],")",";",["T_WHITESPACE","\n    ",206],"}",["T_WHITESPACE","\n",207],"}",["T_WHITESPACE","\n",208]]