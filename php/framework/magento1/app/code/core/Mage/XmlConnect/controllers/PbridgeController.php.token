[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_XmlConnect\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Payment bridge controller\n *\n * @category    Mage\n * @package     Mage_XmlConnect\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_XmlConnect_PbridgeController",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Core_Controller_Front_Action",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Load only action layout handles\n     *\n     * @return Mage_XmlConnect_PbridgeController\n     *\/",36],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_FUNCTION","function",41],["T_WHITESPACE"," ",41],["T_STRING","_initActionLayout",41],"(",")",["T_WHITESPACE","\n    ",41],"{",["T_WHITESPACE","\n        ",42],["T_IF","if",43],["T_WHITESPACE"," ",43],"(","!",["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","_checkPbridge",43],"(",")",")",["T_WHITESPACE"," ",43],"{",["T_WHITESPACE","\n            ",43],["T_RETURN","return",44],";",["T_WHITESPACE","\n        ",44],"}",["T_WHITESPACE","\n        ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","_checkPbridge",46],"(",")",";",["T_WHITESPACE","\n        ",46],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","addActionLayoutHandles",47],"(",")",";",["T_WHITESPACE","\n        ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","loadLayoutUpdates",48],"(",")",";",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","generateLayoutXml",49],"(",")",";",["T_WHITESPACE","\n        ",49],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","generateLayoutBlocks",50],"(",")",";",["T_WHITESPACE","\n        ",50],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","_isLayoutLoaded",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_STRING","true",51],";",["T_WHITESPACE","\n        ",51],["T_RETURN","return",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$this",52],";",["T_WHITESPACE","\n    ",52],"}",["T_WHITESPACE","\n\n    ",53],["T_DOC_COMMENT","\/**\n     * Check is available Payment Bridge module\n     *\n     * @return bool\n     *\/",55],["T_WHITESPACE","\n    ",59],["T_PROTECTED","protected",60],["T_WHITESPACE"," ",60],["T_FUNCTION","function",60],["T_WHITESPACE"," ",60],["T_STRING","_checkPbridge",60],"(",")",["T_WHITESPACE","\n    ",60],"{",["T_WHITESPACE","\n        ",61],["T_IF","if",62],["T_WHITESPACE"," ",62],"(","!",["T_STRING","is_object",62],"(",["T_STRING","Mage",62],["T_DOUBLE_COLON","::",62],["T_STRING","getConfig",62],"(",")",["T_OBJECT_OPERATOR","->",62],["T_STRING","getNode",62],"(",["T_CONSTANT_ENCAPSED_STRING","'modules\/Enterprise_Pbridge'",62],")",")",")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n            ",62],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","getResponse",63],"(",")",["T_OBJECT_OPERATOR","->",63],["T_STRING","setBody",63],"(",["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","__",63],"(",["T_CONSTANT_ENCAPSED_STRING","'Payment Bridge module unavailable.'",63],")",")",";",["T_WHITESPACE","\n            ",63],["T_RETURN","return",64],["T_WHITESPACE"," ",64],["T_STRING","false",64],";",["T_WHITESPACE","\n        ",64],"}",["T_WHITESPACE","\n        ",65],["T_RETURN","return",66],["T_WHITESPACE"," ",66],["T_STRING","true",66],";",["T_WHITESPACE","\n    ",66],"}",["T_WHITESPACE","\n\n    ",67],["T_DOC_COMMENT","\/**\n     * Index Action.\n     * Forward to result action\n     *\n     * @return null\n     *\/",69],["T_WHITESPACE","\n    ",74],["T_PUBLIC","public",75],["T_WHITESPACE"," ",75],["T_FUNCTION","function",75],["T_WHITESPACE"," ",75],["T_STRING","indexAction",75],"(",")",["T_WHITESPACE","\n    ",75],"{",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","_forward",77],"(",["T_CONSTANT_ENCAPSED_STRING","'result'",77],")",";",["T_WHITESPACE","\n    ",77],"}",["T_WHITESPACE","\n\n    ",78],["T_DOC_COMMENT","\/**\n     * Result Action\n     *\n     * @return null\n     *\/",80],["T_WHITESPACE","\n    ",84],["T_PUBLIC","public",85],["T_WHITESPACE"," ",85],["T_FUNCTION","function",85],["T_WHITESPACE"," ",85],["T_STRING","resultAction",85],"(",")",["T_WHITESPACE","\n    ",85],"{",["T_WHITESPACE","\n        ",86],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","_initActionLayout",87],"(",")",";",["T_WHITESPACE","\n        ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","renderLayout",88],"(",")",";",["T_WHITESPACE","\n    ",88],"}",["T_WHITESPACE","\n\n    ",89],["T_DOC_COMMENT","\/**\n     * Output action with params that was given by payment bridge\n     *\n     * @return null\n     *\/",91],["T_WHITESPACE","\n    ",95],["T_PUBLIC","public",96],["T_WHITESPACE"," ",96],["T_FUNCTION","function",96],["T_WHITESPACE"," ",96],["T_STRING","outputAction",96],"(",")",["T_WHITESPACE","\n    ",96],"{",["T_WHITESPACE","\n        ",97],["T_IF","if",98],["T_WHITESPACE"," ",98],"(","!",["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","_checkPbridge",98],"(",")",")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n            ",98],["T_RETURN","return",99],";",["T_WHITESPACE","\n        ",99],"}",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","loadLayout",101],"(",["T_STRING","false",101],")",";",["T_WHITESPACE","\n\n        ",101],["T_DOC_COMMENT","\/** @var $helper Mage_Core_Helper_Data *\/",103],["T_WHITESPACE","\n        ",103],["T_VARIABLE","$helper",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_STRING","Mage",104],["T_DOUBLE_COLON","::",104],["T_STRING","helper",104],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",104],")",";",["T_WHITESPACE","\n        ",104],["T_VARIABLE","$method",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$helper",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","escapeHtml",105],"(",["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getRequest",105],"(",")",["T_OBJECT_OPERATOR","->",105],["T_STRING","getParam",105],"(",["T_CONSTANT_ENCAPSED_STRING","'method'",105],",",["T_WHITESPACE"," ",105],["T_STRING","false",105],")",")",";",["T_WHITESPACE","\n        ",105],["T_VARIABLE","$originalPaymentMethod",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_VARIABLE","$helper",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","escapeHtml",106],"(",["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","getRequest",106],"(",")",["T_OBJECT_OPERATOR","->",106],["T_STRING","getParam",106],"(",["T_CONSTANT_ENCAPSED_STRING","'original_payment_method'",106],",",["T_WHITESPACE"," ",106],["T_STRING","false",106],")",")",";",["T_WHITESPACE","\n        ",106],["T_VARIABLE","$token",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_VARIABLE","$helper",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","escapeHtml",107],"(",["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","getRequest",107],"(",")",["T_OBJECT_OPERATOR","->",107],["T_STRING","getParam",107],"(",["T_CONSTANT_ENCAPSED_STRING","'token'",107],",",["T_WHITESPACE"," ",107],["T_STRING","false",107],")",")",";",["T_WHITESPACE","\n        ",107],["T_VARIABLE","$ccLast4",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$helper",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","escapeHtml",108],"(",["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getRequest",108],"(",")",["T_OBJECT_OPERATOR","->",108],["T_STRING","getParam",108],"(",["T_CONSTANT_ENCAPSED_STRING","'cc_last4'",108],",",["T_WHITESPACE"," ",108],["T_STRING","false",108],")",")",";",["T_WHITESPACE","\n        ",108],["T_VARIABLE","$ccType",109],["T_WHITESPACE","  ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$helper",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","escapeHtml",109],"(",["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getRequest",109],"(",")",["T_OBJECT_OPERATOR","->",109],["T_STRING","getParam",109],"(",["T_CONSTANT_ENCAPSED_STRING","'cc_type'",109],",",["T_WHITESPACE"," ",109],["T_STRING","false",109],")",")",";",["T_WHITESPACE","\n\n        ",109],["T_IF","if",111],["T_WHITESPACE"," ",111],"(",["T_VARIABLE","$originalPaymentMethod",111],["T_WHITESPACE"," ",111],["T_BOOLEAN_AND","&&",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$token",111],["T_WHITESPACE"," ",111],["T_BOOLEAN_AND","&&",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$ccLast4",111],["T_WHITESPACE"," ",111],["T_BOOLEAN_AND","&&",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$ccType",111],")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n            ",111],["T_VARIABLE","$message",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_STRING","Mage",112],["T_DOUBLE_COLON","::",112],["T_STRING","helper",112],"(",["T_CONSTANT_ENCAPSED_STRING","'enterprise_pbridge'",112],")",["T_OBJECT_OPERATOR","->",112],["T_STRING","__",112],"(",["T_CONSTANT_ENCAPSED_STRING","'Payment Bridge Selected'",112],")",";",["T_WHITESPACE","\n            ",112],["T_VARIABLE","$methodName",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","'payment[pbridge_data][original_payment_method]'",113],";",["T_WHITESPACE","\n            ",113],["T_VARIABLE","$inputType",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","'<input type=\"hidden\"'",114],";",["T_WHITESPACE","\n            ",114],["T_VARIABLE","$body",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_START_HEREDOC","<<<EOT\n",115],["T_ENCAPSED_AND_WHITESPACE","    <div id=\"payment_form_",116],["T_CURLY_OPEN","{",116],["T_VARIABLE","$method",116],"}",["T_ENCAPSED_AND_WHITESPACE","\">\n        ",116],["T_CURLY_OPEN","{",117],["T_VARIABLE","$message",117],"}",["T_ENCAPSED_AND_WHITESPACE","\n        ",117],["T_CURLY_OPEN","{",118],["T_VARIABLE","$inputType",118],"}",["T_ENCAPSED_AND_WHITESPACE"," id=\"",118],["T_CURLY_OPEN","{",118],["T_VARIABLE","$method",118],"}",["T_ENCAPSED_AND_WHITESPACE","_original_payment_method\" name=\"",118],["T_CURLY_OPEN","{",118],["T_VARIABLE","$methodName",118],"}",["T_ENCAPSED_AND_WHITESPACE","\" value=\"",118],["T_CURLY_OPEN","{",118],["T_VARIABLE","$originalPaymentMethod",118],"}",["T_ENCAPSED_AND_WHITESPACE","\">\n        ",118],["T_CURLY_OPEN","{",119],["T_VARIABLE","$inputType",119],"}",["T_ENCAPSED_AND_WHITESPACE"," id=\"",119],["T_CURLY_OPEN","{",119],["T_VARIABLE","$method",119],"}",["T_ENCAPSED_AND_WHITESPACE","_token\" name=\"payment[pbridge_data][token]\" value=\"",119],["T_CURLY_OPEN","{",119],["T_VARIABLE","$token",119],"}",["T_ENCAPSED_AND_WHITESPACE","\">\n        ",119],["T_CURLY_OPEN","{",120],["T_VARIABLE","$inputType",120],"}",["T_ENCAPSED_AND_WHITESPACE"," id=\"",120],["T_CURLY_OPEN","{",120],["T_VARIABLE","$method",120],"}",["T_ENCAPSED_AND_WHITESPACE","_cc_last4\" name=\"payment[pbridge_data][cc_last4]\" value=\"",120],["T_CURLY_OPEN","{",120],["T_VARIABLE","$ccLast4",120],"}",["T_ENCAPSED_AND_WHITESPACE","\">\n        ",120],["T_CURLY_OPEN","{",121],["T_VARIABLE","$inputType",121],"}",["T_ENCAPSED_AND_WHITESPACE"," id=\"",121],["T_CURLY_OPEN","{",121],["T_VARIABLE","$method",121],"}",["T_ENCAPSED_AND_WHITESPACE","_cc_type\" name=\"payment[pbridge_data][cc_type]\" value=\"",121],["T_CURLY_OPEN","{",121],["T_VARIABLE","$ccType",121],"}",["T_ENCAPSED_AND_WHITESPACE","\">\n    <\/div>\n",121],["T_END_HEREDOC","EOT",123],";",["T_WHITESPACE","\n        ",123],"}",["T_WHITESPACE"," ",124],["T_ELSE","else",124],["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n            ",124],["T_VARIABLE","$message",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","__",125],"(",["T_CONSTANT_ENCAPSED_STRING","'Error while reading data from Payment Bridge. Please, try again.'",125],")",";",["T_WHITESPACE","\n            ",125],["T_VARIABLE","$body",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_START_HEREDOC","<<<EOT\n",126],["T_ENCAPSED_AND_WHITESPACE","    <div id=\"payment_form_error\">\n        ",127],["T_CURLY_OPEN","{",128],["T_VARIABLE","$message",128],"}",["T_ENCAPSED_AND_WHITESPACE","\n    <\/div>\n",128],["T_END_HEREDOC","EOT",130],";",["T_WHITESPACE","\n        ",130],"}",["T_WHITESPACE","\n        ",131],["T_VARIABLE","$replacePattern",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","'{{content}}'",132],";",["T_WHITESPACE","\n        ",132],["T_VARIABLE","$content",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_STRING","html_entity_decode",133],"(",["T_STRING","Mage",133],["T_DOUBLE_COLON","::",133],["T_STRING","helper",133],"(",["T_CONSTANT_ENCAPSED_STRING","'xmlconnect'",133],")",["T_OBJECT_OPERATOR","->",133],["T_STRING","htmlize",133],"(",["T_VARIABLE","$replacePattern",133],")",")",";",["T_WHITESPACE","\n        ",133],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","getResponse",134],"(",")",["T_OBJECT_OPERATOR","->",134],["T_STRING","setBody",134],"(",["T_STRING","str_replace",134],"(",["T_VARIABLE","$replacePattern",134],",",["T_WHITESPACE"," ",134],["T_VARIABLE","$body",134],",",["T_WHITESPACE"," ",134],["T_VARIABLE","$content",134],")",")",";",["T_WHITESPACE","\n    ",134],"}",["T_WHITESPACE","\n",135],"}",["T_WHITESPACE","\n",136]]