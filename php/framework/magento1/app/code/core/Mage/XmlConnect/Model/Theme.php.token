[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_XmlConnect\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * XmlConnect Theme model\n *\n * @category    Mage\n * @package     Mage_Xmlconnect\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_XmlConnect_Model_Theme",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Current theme file\n     *\n     * @var string|null\n     *\/",36],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$_file",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_STRING","null",41],";",["T_WHITESPACE","\n\n    ",41],["T_DOC_COMMENT","\/**\n     * Loaded theme xml object\n     *\n     * @var SimpleXMLElement|null\n     *\/",43],["T_WHITESPACE","\n    ",47],["T_PROTECTED","protected",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$_xml",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_STRING","null",48],";",["T_WHITESPACE","\n\n    ",48],["T_DOC_COMMENT","\/**\n     * Theme configuration\n     *\n     * @var array|null\n     *\/",50],["T_WHITESPACE","\n    ",54],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$_conf",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","null",55],";",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * Load Theme xml from $file\n     *\n     * @param string $file\n     * @throws Mage_Core_Exception\n     *\/",57],["T_WHITESPACE","\n    ",62],["T_PUBLIC","public",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","__construct",63],"(",["T_VARIABLE","$file",63],")",["T_WHITESPACE","\n    ",63],"{",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$io",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_NEW","new",65],["T_WHITESPACE"," ",65],["T_STRING","Varien_Io_File",65],"(",")",";",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","_file",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$file",66],";",["T_WHITESPACE","\n        ",66],["T_IF","if",67],["T_WHITESPACE"," ",67],"(","!",["T_STRING","file_exists",67],"(",["T_VARIABLE","$file",67],")",")",["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n            ",67],["T_STRING","Mage",68],["T_DOUBLE_COLON","::",68],["T_STRING","throwException",68],"(",["T_STRING","Mage",68],["T_DOUBLE_COLON","::",68],["T_STRING","helper",68],"(",["T_CONSTANT_ENCAPSED_STRING","'xmlconnect'",68],")",["T_OBJECT_OPERATOR","->",68],["T_STRING","__",68],"(",["T_CONSTANT_ENCAPSED_STRING","'File doesn\\'t exist \"%s\".'",68],",",["T_WHITESPACE","\n                ",68],["T_VARIABLE","$io",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getFilteredPath",69],"(",["T_VARIABLE","$file",69],")",")",")",";",["T_WHITESPACE","\n        ",69],"}",["T_WHITESPACE","\n        ",70],["T_IF","if",71],["T_WHITESPACE"," ",71],"(","!",["T_STRING","is_readable",71],"(",["T_VARIABLE","$file",71],")",")",["T_WHITESPACE"," ",71],"{",["T_WHITESPACE","\n            ",71],["T_STRING","Mage",72],["T_DOUBLE_COLON","::",72],["T_STRING","throwException",72],"(",["T_STRING","Mage",72],["T_DOUBLE_COLON","::",72],["T_STRING","helper",72],"(",["T_CONSTANT_ENCAPSED_STRING","'xmlconnect'",72],")",["T_OBJECT_OPERATOR","->",72],["T_STRING","__",72],"(",["T_CONSTANT_ENCAPSED_STRING","'Can\\'t read file \"%s\".'",72],",",["T_WHITESPACE"," ",72],["T_VARIABLE","$io",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","getFilteredPath",72],"(",["T_VARIABLE","$file",72],")",")",")",";",["T_WHITESPACE","\n        ",72],"}",["T_WHITESPACE","\n        ",73],["T_TRY","try",74],["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n            ",74],["T_VARIABLE","$text",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_STRING","file_get_contents",75],"(",["T_VARIABLE","$file",75],")",";",["T_WHITESPACE","\n            ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","_xml",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_STRING","simplexml_load_string",76],"(",["T_VARIABLE","$text",76],")",";",["T_WHITESPACE","\n        ",76],"}",["T_WHITESPACE"," ",77],["T_CATCH","catch",77],["T_WHITESPACE"," ",77],"(",["T_STRING","Exception",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$e",77],")",["T_WHITESPACE"," ",77],"{",["T_WHITESPACE","\n            ",77],["T_STRING","Mage",78],["T_DOUBLE_COLON","::",78],["T_STRING","throwException",78],"(",["T_STRING","Mage",78],["T_DOUBLE_COLON","::",78],["T_STRING","helper",78],"(",["T_CONSTANT_ENCAPSED_STRING","'xmlconnect'",78],")",["T_OBJECT_OPERATOR","->",78],["T_STRING","__",78],"(",["T_CONSTANT_ENCAPSED_STRING","'Can\\'t load XML.'",78],")",")",";",["T_WHITESPACE","\n        ",78],"}",["T_WHITESPACE","\n        ",79],["T_IF","if",80],["T_WHITESPACE"," ",80],"(",["T_EMPTY","empty",80],"(",["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","_xml",80],")",")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n            ",80],["T_STRING","Mage",81],["T_DOUBLE_COLON","::",81],["T_STRING","throwException",81],"(",["T_STRING","Mage",81],["T_DOUBLE_COLON","::",81],["T_STRING","helper",81],"(",["T_CONSTANT_ENCAPSED_STRING","'xmlconnect'",81],")",["T_OBJECT_OPERATOR","->",81],["T_STRING","__",81],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid XML.'",81],")",")",";",["T_WHITESPACE","\n        ",81],"}",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","_conf",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","_xmlToArray",83],"(",["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","_xml",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","configuration",83],")",";",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","_conf",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","_conf",84],"[",["T_CONSTANT_ENCAPSED_STRING","'configuration'",84],"]",";",["T_WHITESPACE","\n        ",84],["T_IF","if",85],["T_WHITESPACE"," ",85],"(","!",["T_STRING","is_array",85],"(",["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","_conf",85],")",")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n            ",85],["T_STRING","Mage",86],["T_DOUBLE_COLON","::",86],["T_STRING","throwException",86],"(",["T_STRING","Mage",86],["T_DOUBLE_COLON","::",86],["T_STRING","helper",86],"(",["T_CONSTANT_ENCAPSED_STRING","'xmlconnect'",86],")",["T_OBJECT_OPERATOR","->",86],["T_STRING","__",86],"(",["T_CONSTANT_ENCAPSED_STRING","'Wrong theme format.'",86],")",")",";",["T_WHITESPACE","\n        ",86],"}",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n\n    ",88],["T_DOC_COMMENT","\/**\n     * Get theme xml as array\n     *\n     * @param array $xml\n     * @return array\n     *\/",90],["T_WHITESPACE","\n    ",95],["T_PROTECTED","protected",96],["T_WHITESPACE"," ",96],["T_FUNCTION","function",96],["T_WHITESPACE"," ",96],["T_STRING","_xmlToArray",96],"(",["T_VARIABLE","$xml",96],")",["T_WHITESPACE","\n    ",96],"{",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$result",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_ARRAY","array",98],"(",")",";",["T_WHITESPACE","\n        ",98],["T_FOREACH","foreach",99],["T_WHITESPACE"," ",99],"(",["T_VARIABLE","$xml",99],["T_WHITESPACE"," ",99],["T_AS","as",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$key",99],["T_WHITESPACE"," ",99],["T_DOUBLE_ARROW","=>",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$value",99],")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n            ",99],["T_IF","if",100],["T_WHITESPACE"," ",100],"(",["T_STRING","count",100],"(",["T_VARIABLE","$value",100],")",")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n                ",100],["T_VARIABLE","$result",101],"[",["T_VARIABLE","$key",101],"]",["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","_xmlToArray",101],"(",["T_VARIABLE","$value",101],")",";",["T_WHITESPACE","\n            ",101],"}",["T_WHITESPACE"," ",102],["T_ELSE","else",102],["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n                ",102],["T_VARIABLE","$result",103],"[",["T_VARIABLE","$key",103],"]",["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_STRING_CAST","(string)",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$value",103],";",["T_WHITESPACE","\n            ",103],"}",["T_WHITESPACE","\n        ",104],"}",["T_WHITESPACE","\n        ",105],["T_RETURN","return",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$result",106],";",["T_WHITESPACE","\n    ",106],"}",["T_WHITESPACE","\n\n    ",107],["T_DOC_COMMENT","\/**\n     * Get theme file\n     *\n     * @return null|string\n     *\/",109],["T_WHITESPACE","\n    ",113],["T_PROTECTED","protected",114],["T_WHITESPACE"," ",114],["T_FUNCTION","function",114],["T_WHITESPACE"," ",114],["T_STRING","_getThemeFile",114],"(",")",["T_WHITESPACE","\n    ",114],"{",["T_WHITESPACE","\n        ",115],["T_RETURN","return",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","_file",116],";",["T_WHITESPACE","\n    ",116],"}",["T_WHITESPACE","\n\n    ",117],["T_DOC_COMMENT","\/**\n     * Get theme name\n     *\n     * @return string\n     *\/",119],["T_WHITESPACE","\n    ",123],["T_PUBLIC","public",124],["T_WHITESPACE"," ",124],["T_FUNCTION","function",124],["T_WHITESPACE"," ",124],["T_STRING","getName",124],"(",")",["T_WHITESPACE","\n    ",124],"{",["T_WHITESPACE","\n        ",125],["T_RETURN","return",126],["T_WHITESPACE"," ",126],["T_STRING_CAST","(string)",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","_xml",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","manifest",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","name",126],";",["T_WHITESPACE","\n    ",126],"}",["T_WHITESPACE","\n\n    ",127],["T_DOC_COMMENT","\/**\n     * Set theme name\n     *\n     * @param  $name\n     * @return Mage_XmlConnect_Model_Theme\n     *\/",129],["T_WHITESPACE","\n    ",134],["T_PUBLIC","public",135],["T_WHITESPACE"," ",135],["T_FUNCTION","function",135],["T_WHITESPACE"," ",135],["T_STRING","setName",135],"(",["T_VARIABLE","$name",135],")",["T_WHITESPACE","\n    ",135],"{",["T_WHITESPACE","\n        ",136],["T_VARIABLE","$name",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_STRING","trim",137],"(",["T_STRING_CAST","(string)",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$name",137],")",";",["T_WHITESPACE","\n        ",137],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","_xml",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","manifest",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","name",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_STRING","htmlentities",138],"(",["T_VARIABLE","$name",138],",",["T_WHITESPACE"," ",138],["T_STRING","ENT_QUOTES",138],",",["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",138],")",";",["T_WHITESPACE","\n        ",138],["T_RETURN","return",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],";",["T_WHITESPACE","\n    ",139],"}",["T_WHITESPACE","\n\n    ",140],["T_DOC_COMMENT","\/**\n     * Get theme Label\n     *\n     * @return string\n     *\/",142],["T_WHITESPACE","\n    ",146],["T_PUBLIC","public",147],["T_WHITESPACE"," ",147],["T_FUNCTION","function",147],["T_WHITESPACE"," ",147],["T_STRING","getLabel",147],"(",")",["T_WHITESPACE","\n    ",147],"{",["T_WHITESPACE","\n        ",148],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_STRING_CAST","(string)",149],["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","_xml",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","manifest",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","label",149],";",["T_WHITESPACE","\n    ",149],"}",["T_WHITESPACE","\n\n    ",150],["T_DOC_COMMENT","\/**\n     * Set theme Label\n     *\n     * @param  $label\n     * @return Mage_XmlConnect_Model_Theme\n     *\/",152],["T_WHITESPACE","\n    ",157],["T_PUBLIC","public",158],["T_WHITESPACE"," ",158],["T_FUNCTION","function",158],["T_WHITESPACE"," ",158],["T_STRING","setLabel",158],"(",["T_VARIABLE","$label",158],")",["T_WHITESPACE","\n    ",158],"{",["T_WHITESPACE","\n        ",159],["T_VARIABLE","$label",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_STRING","trim",160],"(",["T_STRING_CAST","(string)",160],["T_WHITESPACE"," ",160],["T_VARIABLE","$label",160],")",";",["T_WHITESPACE","\n        ",160],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","_xml",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","manifest",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","label",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_STRING","htmlentities",161],"(",["T_VARIABLE","$label",161],",",["T_WHITESPACE"," ",161],["T_STRING","ENT_QUOTES",161],",",["T_WHITESPACE"," ",161],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",161],")",";",["T_WHITESPACE","\n        ",161],["T_RETURN","return",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],";",["T_WHITESPACE","\n    ",162],"}",["T_WHITESPACE","\n\n    ",163],["T_DOC_COMMENT","\/**\n     * Generate full file name for custome theme in media\n     *\n     * @return string\n     *\/",165],["T_WHITESPACE","\n    ",169],["T_PROTECTED","protected",170],["T_WHITESPACE"," ",170],["T_FUNCTION","function",170],["T_WHITESPACE"," ",170],["T_STRING","_createThemeName",170],"(",")",["T_WHITESPACE","\n    ",170],"{",["T_WHITESPACE","\n        ",171],["T_DOC_COMMENT","\/** @var $themesHelper Mage_XmlConnect_Helper_Theme *\/",172],["T_WHITESPACE","\n        ",172],["T_VARIABLE","$themesHelper",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_STRING","Mage",173],["T_DOUBLE_COLON","::",173],["T_STRING","helper",173],"(",["T_CONSTANT_ENCAPSED_STRING","'xmlconnect\/theme'",173],")",";",["T_WHITESPACE","\n        ",173],["T_DOC_COMMENT","\/** @var $coreHelper Mage_Core_Helper_Data *\/",174],["T_WHITESPACE","\n        ",174],["T_VARIABLE","$coreHelper",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_STRING","Mage",175],["T_DOUBLE_COLON","::",175],["T_STRING","helper",175],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",175],")",";",["T_WHITESPACE","\n\n        ",175],["T_VARIABLE","$themeFileName",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_VARIABLE","$themesHelper",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","getMediaThemePath",177],"(",")",["T_WHITESPACE"," ",177],".",["T_WHITESPACE"," ",177],["T_STRING","DS",177],["T_WHITESPACE"," ",177],".",["T_VARIABLE","$themesHelper",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","getCustomThemeName",177],"(",")",["T_WHITESPACE"," ",177],".",["T_WHITESPACE"," ",177],["T_CONSTANT_ENCAPSED_STRING","'_'",177],["T_WHITESPACE"," ",177],".",["T_WHITESPACE"," ",177],["T_STRING","time",177],"(",")",["T_WHITESPACE","\n            ",177],".",["T_WHITESPACE"," ",178],["T_CONSTANT_ENCAPSED_STRING","'_'",178],["T_WHITESPACE"," ",178],".",["T_WHITESPACE"," ",178],["T_VARIABLE","$coreHelper",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","getRandomString",178],"(",["T_LNUMBER","10",178],",",["T_WHITESPACE"," ",178],["T_CONSTANT_ENCAPSED_STRING","'abcdefghijklmnopqrstuvwxyz0123456789'",178],")",["T_WHITESPACE"," ",178],".",["T_WHITESPACE"," ",178],["T_CONSTANT_ENCAPSED_STRING","'.xml'",178],";",["T_WHITESPACE","\n        ",178],["T_RETURN","return",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$themeFileName",179],";",["T_WHITESPACE","\n    ",179],"}",["T_WHITESPACE","\n\n    ",180],["T_DOC_COMMENT","\/**\n     * Copy current theme to specified file\n     *\n     * @param  $filePath\n     * @return string new file\n     *\/",182],["T_WHITESPACE","\n    ",187],["T_PROTECTED","protected",188],["T_WHITESPACE"," ",188],["T_FUNCTION","function",188],["T_WHITESPACE"," ",188],["T_STRING","_createCopy",188],"(",["T_VARIABLE","$filePath",188],")",["T_WHITESPACE","\n    ",188],"{",["T_WHITESPACE","\n        ",189],["T_VARIABLE","$currentThemeFileName",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","_getThemeFile",190],"(",")",";",["T_WHITESPACE","\n\n        ",190],["T_VARIABLE","$ioFile",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_NEW","new",192],["T_WHITESPACE"," ",192],["T_STRING","Varien_Io_File",192],"(",")",";",["T_WHITESPACE","\n        ",192],["T_IF","if",193],["T_WHITESPACE"," ",193],"(","!",["T_VARIABLE","$ioFile",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","cp",193],"(",["T_VARIABLE","$currentThemeFileName",193],",",["T_WHITESPACE"," ",193],["T_VARIABLE","$filePath",193],")",")",["T_WHITESPACE"," ",193],"{",["T_WHITESPACE","\n            ",193],["T_STRING","Mage",194],["T_DOUBLE_COLON","::",194],["T_STRING","throwException",194],"(",["T_WHITESPACE","\n                ",194],["T_STRING","Mage",195],["T_DOUBLE_COLON","::",195],["T_STRING","helper",195],"(",["T_CONSTANT_ENCAPSED_STRING","'xmlconnect'",195],")",["T_OBJECT_OPERATOR","->",195],["T_STRING","__",195],"(",["T_CONSTANT_ENCAPSED_STRING","'Can\\'t copy file \"%s\" to \"%s\".'",195],",",["T_WHITESPACE","\n                    ",195],["T_VARIABLE","$ioFile",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","getFilteredPath",196],"(",["T_VARIABLE","$currentThemeFileName",196],")",",",["T_WHITESPACE"," ",196],["T_VARIABLE","$ioFile",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","getFilteredPath",196],"(",["T_VARIABLE","$filePath",196],")",")",["T_WHITESPACE","\n            ",196],")",";",["T_WHITESPACE","\n        ",197],"}",["T_WHITESPACE"," ",198],["T_ELSE","else",198],["T_WHITESPACE"," ",198],"{",["T_WHITESPACE","\n            ",198],["T_VARIABLE","$ioFile",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","chmod",199],"(",["T_VARIABLE","$filePath",199],",",["T_WHITESPACE"," ",199],["T_LNUMBER","0755",199],")",";",["T_WHITESPACE","\n        ",199],"}",["T_WHITESPACE","\n\n        ",200],["T_RETURN","return",202],["T_WHITESPACE"," ",202],["T_VARIABLE","$filePath",202],";",["T_WHITESPACE","\n    ",202],"}",["T_WHITESPACE","\n\n    ",203],["T_DOC_COMMENT","\/**\n     * Create a copy of current instance with specified data\n     *\n     * @param  $themeName new theme label\n     * @param  $data theme config array\n     * @return Mage_XmlConnect_Model_Theme\n     *\/",205],["T_WHITESPACE","\n    ",211],["T_PUBLIC","public",212],["T_WHITESPACE"," ",212],["T_FUNCTION","function",212],["T_WHITESPACE"," ",212],["T_STRING","createNewTheme",212],"(",["T_VARIABLE","$themeName",212],",",["T_WHITESPACE"," ",212],["T_VARIABLE","$data",212],")",["T_WHITESPACE","\n    ",212],"{",["T_WHITESPACE","\n        ",213],["T_VARIABLE","$filePath",214],["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","_createThemeName",214],"(",")",";",["T_WHITESPACE","\n        ",214],["T_VARIABLE","$themeFileName",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","_createCopy",215],"(",["T_VARIABLE","$filePath",215],")",";",["T_WHITESPACE","\n\n        ",215],["T_DOC_COMMENT","\/** @var $themeFileName Mage_XmlConnect_Model_Theme *\/",217],["T_WHITESPACE","\n        ",217],["T_VARIABLE","$themeFileName",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_STRING","Mage",218],["T_DOUBLE_COLON","::",218],["T_STRING","getModel",218],"(",["T_CONSTANT_ENCAPSED_STRING","'xmlconnect\/theme'",218],",",["T_WHITESPACE"," ",218],["T_VARIABLE","$filePath",218],")",";",["T_WHITESPACE","\n        ",218],["T_VARIABLE","$themeFileName",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","setLabel",219],"(",["T_VARIABLE","$themeName",219],")",";",["T_WHITESPACE","\n        ",219],["T_VARIABLE","$fileName",220],["T_WHITESPACE"," ",220],"=",["T_WHITESPACE"," ",220],["T_STRING","basename",220],"(",["T_VARIABLE","$filePath",220],")",";",["T_WHITESPACE","\n        ",220],["T_VARIABLE","$themeFileName",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","setName",221],"(",["T_STRING","substr",221],"(",["T_VARIABLE","$fileName",221],",",["T_WHITESPACE"," ",221],["T_LNUMBER","0",221],",",["T_WHITESPACE"," ",221],"-",["T_LNUMBER","4",221],")",")",";",["T_WHITESPACE","\n        ",221],["T_VARIABLE","$themeFileName",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","importAndSaveData",222],"(",["T_VARIABLE","$data",222],")",";",["T_WHITESPACE","\n        ",222],["T_RETURN","return",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$themeFileName",223],";",["T_WHITESPACE","\n    ",223],"}",["T_WHITESPACE","\n\n    ",224],["T_DOC_COMMENT","\/**\n     * Load data (flat array) for Varien_Data_Form\n     *\n     * @return array\n     *\/",226],["T_WHITESPACE","\n    ",230],["T_PUBLIC","public",231],["T_WHITESPACE"," ",231],["T_FUNCTION","function",231],["T_WHITESPACE"," ",231],["T_STRING","getFormData",231],"(",")",["T_WHITESPACE","\n    ",231],"{",["T_WHITESPACE","\n        ",232],["T_RETURN","return",233],["T_WHITESPACE"," ",233],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","_flatArray",233],"(",["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","_conf",233],",",["T_WHITESPACE"," ",233],["T_CONSTANT_ENCAPSED_STRING","'conf'",233],")",";",["T_WHITESPACE","\n    ",233],"}",["T_WHITESPACE","\n\n    ",234],["T_DOC_COMMENT","\/**\n     * Load data (flat array) for Varien_Data_Form\n     *\n     * @param array $subTree\n     * @param string $prefix\n     * @return array\n     *\/",236],["T_WHITESPACE","\n    ",242],["T_PROTECTED","protected",243],["T_WHITESPACE"," ",243],["T_FUNCTION","function",243],["T_WHITESPACE"," ",243],["T_STRING","_flatArray",243],"(",["T_VARIABLE","$subTree",243],",",["T_WHITESPACE"," ",243],["T_VARIABLE","$prefix",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_STRING","null",243],")",["T_WHITESPACE","\n    ",243],"{",["T_WHITESPACE","\n        ",244],["T_VARIABLE","$result",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_ARRAY","array",245],"(",")",";",["T_WHITESPACE","\n        ",245],["T_FOREACH","foreach",246],["T_WHITESPACE"," ",246],"(",["T_VARIABLE","$subTree",246],["T_WHITESPACE"," ",246],["T_AS","as",246],["T_WHITESPACE"," ",246],["T_VARIABLE","$key",246],["T_WHITESPACE"," ",246],["T_DOUBLE_ARROW","=>",246],["T_WHITESPACE"," ",246],["T_VARIABLE","$value",246],")",["T_WHITESPACE"," ",246],"{",["T_WHITESPACE","\n            ",246],["T_IF","if",247],["T_WHITESPACE"," ",247],"(",["T_STRING","is_null",247],"(",["T_VARIABLE","$prefix",247],")",")",["T_WHITESPACE"," ",247],"{",["T_WHITESPACE","\n                ",247],["T_VARIABLE","$name",248],["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_VARIABLE","$key",248],";",["T_WHITESPACE","\n            ",248],"}",["T_WHITESPACE"," ",249],["T_ELSE","else",249],["T_WHITESPACE"," ",249],"{",["T_WHITESPACE","\n                ",249],["T_VARIABLE","$name",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_VARIABLE","$prefix",250],["T_WHITESPACE"," ",250],".",["T_WHITESPACE"," ",250],["T_CONSTANT_ENCAPSED_STRING","'['",250],["T_WHITESPACE"," ",250],".",["T_WHITESPACE"," ",250],["T_VARIABLE","$key",250],["T_WHITESPACE"," ",250],".",["T_WHITESPACE"," ",250],["T_CONSTANT_ENCAPSED_STRING","']'",250],";",["T_WHITESPACE","\n            ",250],"}",["T_WHITESPACE","\n\n            ",251],["T_IF","if",253],["T_WHITESPACE"," ",253],"(",["T_STRING","is_array",253],"(",["T_VARIABLE","$value",253],")",")",["T_WHITESPACE"," ",253],"{",["T_WHITESPACE","\n                ",253],["T_VARIABLE","$result",254],["T_WHITESPACE"," ",254],"=",["T_WHITESPACE"," ",254],["T_STRING","array_merge",254],"(",["T_VARIABLE","$result",254],",",["T_WHITESPACE"," ",254],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","_flatArray",254],"(",["T_VARIABLE","$value",254],",",["T_WHITESPACE"," ",254],["T_VARIABLE","$name",254],")",")",";",["T_WHITESPACE","\n            ",254],"}",["T_WHITESPACE"," ",255],["T_ELSE","else",255],["T_WHITESPACE"," ",255],"{",["T_WHITESPACE","\n                ",255],["T_VARIABLE","$result",256],"[",["T_VARIABLE","$name",256],"]",["T_WHITESPACE"," ",256],"=",["T_WHITESPACE"," ",256],["T_VARIABLE","$value",256],";",["T_WHITESPACE","\n            ",256],"}",["T_WHITESPACE","\n        ",257],"}",["T_WHITESPACE","\n        ",258],["T_RETURN","return",259],["T_WHITESPACE"," ",259],["T_VARIABLE","$result",259],";",["T_WHITESPACE","\n    ",259],"}",["T_WHITESPACE","\n\n    ",260],["T_DOC_COMMENT","\/**\n     * Validate input Array, recursive\n     *\n     * @param array $data\n     * @param array $xml\n     * @return array\n     *\/",262],["T_WHITESPACE","\n    ",268],["T_PROTECTED","protected",269],["T_WHITESPACE"," ",269],["T_FUNCTION","function",269],["T_WHITESPACE"," ",269],["T_STRING","_validateFormInput",269],"(",["T_VARIABLE","$data",269],",",["T_WHITESPACE"," ",269],["T_VARIABLE","$xml",269],["T_WHITESPACE"," ",269],"=",["T_WHITESPACE"," ",269],["T_STRING","null",269],")",["T_WHITESPACE","\n    ",269],"{",["T_WHITESPACE","\n        ",270],["T_VARIABLE","$root",271],["T_WHITESPACE"," ",271],"=",["T_WHITESPACE"," ",271],["T_STRING","false",271],";",["T_WHITESPACE","\n        ",271],["T_VARIABLE","$result",272],["T_WHITESPACE"," ",272],"=",["T_WHITESPACE"," ",272],["T_ARRAY","array",272],"(",")",";",["T_WHITESPACE","\n        ",272],["T_IF","if",273],["T_WHITESPACE"," ",273],"(",["T_STRING","is_null",273],"(",["T_VARIABLE","$xml",273],")",")",["T_WHITESPACE"," ",273],"{",["T_WHITESPACE","\n            ",273],["T_VARIABLE","$root",274],["T_WHITESPACE"," ",274],"=",["T_WHITESPACE"," ",274],["T_STRING","true",274],";",["T_WHITESPACE","\n            ",274],["T_VARIABLE","$data",275],["T_WHITESPACE"," ",275],"=",["T_WHITESPACE"," ",275],["T_ARRAY","array",275],"(",["T_CONSTANT_ENCAPSED_STRING","'configuration'",275],["T_WHITESPACE"," ",275],["T_DOUBLE_ARROW","=>",275],["T_WHITESPACE"," ",275],["T_VARIABLE","$data",275],")",";",["T_WHITESPACE","\n            ",275],["T_VARIABLE","$xml",276],["T_WHITESPACE"," ",276],"=",["T_WHITESPACE"," ",276],["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","_xml",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","configuration",276],";",["T_WHITESPACE","\n        ",276],"}",["T_WHITESPACE","\n        ",277],["T_FOREACH","foreach",278],["T_WHITESPACE"," ",278],"(",["T_VARIABLE","$xml",278],["T_WHITESPACE"," ",278],["T_AS","as",278],["T_WHITESPACE"," ",278],["T_VARIABLE","$key",278],["T_WHITESPACE"," ",278],["T_DOUBLE_ARROW","=>",278],["T_WHITESPACE"," ",278],["T_VARIABLE","$value",278],")",["T_WHITESPACE"," ",278],"{",["T_WHITESPACE","\n            ",278],["T_IF","if",279],["T_WHITESPACE"," ",279],"(",["T_ISSET","isset",279],"(",["T_VARIABLE","$data",279],"[",["T_VARIABLE","$key",279],"]",")",")",["T_WHITESPACE"," ",279],"{",["T_WHITESPACE","\n                ",279],["T_IF","if",280],["T_WHITESPACE"," ",280],"(",["T_STRING","is_array",280],"(",["T_VARIABLE","$data",280],"[",["T_VARIABLE","$key",280],"]",")",")",["T_WHITESPACE"," ",280],"{",["T_WHITESPACE","\n                    ",280],["T_VARIABLE","$result",281],"[",["T_VARIABLE","$key",281],"]",["T_WHITESPACE"," ",281],"=",["T_WHITESPACE"," ",281],["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","_validateFormInput",281],"(",["T_VARIABLE","$data",281],"[",["T_VARIABLE","$key",281],"]",",",["T_WHITESPACE"," ",281],["T_VARIABLE","$value",281],")",";",["T_WHITESPACE","\n                ",281],"}",["T_WHITESPACE"," ",282],["T_ELSE","else",282],["T_WHITESPACE"," ",282],"{",["T_WHITESPACE","\n                    ",282],["T_VARIABLE","$result",283],"[",["T_VARIABLE","$key",283],"]",["T_WHITESPACE"," ",283],"=",["T_WHITESPACE"," ",283],["T_VARIABLE","$data",283],"[",["T_VARIABLE","$key",283],"]",";",["T_WHITESPACE","\n                ",283],"}",["T_WHITESPACE","\n            ",284],"}",["T_WHITESPACE","\n        ",285],"}",["T_WHITESPACE","\n        ",286],["T_IF","if",287],["T_WHITESPACE"," ",287],"(",["T_VARIABLE","$root",287],")",["T_WHITESPACE"," ",287],"{",["T_WHITESPACE","\n            ",287],["T_VARIABLE","$result",288],["T_WHITESPACE"," ",288],"=",["T_WHITESPACE"," ",288],["T_VARIABLE","$result",288],"[",["T_CONSTANT_ENCAPSED_STRING","'configuration'",288],"]",";",["T_WHITESPACE","\n        ",288],"}",["T_WHITESPACE","\n        ",289],["T_RETURN","return",290],["T_WHITESPACE"," ",290],["T_VARIABLE","$result",290],";",["T_WHITESPACE","\n    ",290],"}",["T_WHITESPACE","\n\n    ",291],["T_DOC_COMMENT","\/**\n     * Build XML object recursively from $data array\n     *\n     * @param SimpleXMLElement $parent\n     * @param array $data\n     * @return null\n     *\/",293],["T_WHITESPACE","\n    ",299],["T_PROTECTED","protected",300],["T_WHITESPACE"," ",300],["T_FUNCTION","function",300],["T_WHITESPACE"," ",300],["T_STRING","_buildRecursive",300],"(",["T_VARIABLE","$parent",300],",",["T_WHITESPACE"," ",300],["T_VARIABLE","$data",300],")",["T_WHITESPACE","\n    ",300],"{",["T_WHITESPACE","\n        ",301],["T_FOREACH","foreach",302],["T_WHITESPACE"," ",302],"(",["T_VARIABLE","$data",302],["T_WHITESPACE"," ",302],["T_AS","as",302],["T_WHITESPACE"," ",302],["T_VARIABLE","$key",302],["T_WHITESPACE"," ",302],["T_DOUBLE_ARROW","=>",302],["T_WHITESPACE"," ",302],["T_VARIABLE","$value",302],")",["T_WHITESPACE"," ",302],"{",["T_WHITESPACE","\n            ",302],["T_IF","if",303],["T_WHITESPACE"," ",303],"(",["T_STRING","is_array",303],"(",["T_VARIABLE","$value",303],")",")",["T_WHITESPACE"," ",303],"{",["T_WHITESPACE","\n                ",303],["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","_buildRecursive",304],"(",["T_VARIABLE","$parent",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","addChild",304],"(",["T_VARIABLE","$key",304],")",",",["T_WHITESPACE"," ",304],["T_VARIABLE","$value",304],")",";",["T_WHITESPACE","\n            ",304],"}",["T_WHITESPACE"," ",305],["T_ELSE","else",305],["T_WHITESPACE"," ",305],"{",["T_WHITESPACE","\n                ",305],["T_VARIABLE","$parent",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","addChild",306],"(",["T_VARIABLE","$key",306],",",["T_WHITESPACE"," ",306],["T_VARIABLE","$value",306],")",";",["T_WHITESPACE","\n            ",306],"}",["T_WHITESPACE","\n        ",307],"}",["T_WHITESPACE","\n    ",308],"}",["T_WHITESPACE","\n\n    ",309],["T_DOC_COMMENT","\/**\n     * Import data into theme form $data array, and save XML to file\n     *\n     * @throws Mage_Core_Exception\n     * @param array $data\n     * @return null\n     *\/",311],["T_WHITESPACE","\n    ",317],["T_PUBLIC","public",318],["T_WHITESPACE"," ",318],["T_FUNCTION","function",318],["T_WHITESPACE"," ",318],["T_STRING","importAndSaveData",318],"(",["T_VARIABLE","$data",318],")",["T_WHITESPACE","\n    ",318],"{",["T_WHITESPACE","\n        ",319],["T_VARIABLE","$xml",320],["T_WHITESPACE"," ",320],"=",["T_WHITESPACE"," ",320],["T_NEW","new",320],["T_WHITESPACE"," ",320],["T_STRING","SimpleXMLElement",320],"(",["T_CONSTANT_ENCAPSED_STRING","'<theme>'",320],["T_WHITESPACE"," ",320],".",["T_WHITESPACE"," ",320],["T_VARIABLE","$this",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","_xml",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","manifest",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","asXML",320],"(",")",["T_WHITESPACE"," ",320],".",["T_WHITESPACE"," ",320],["T_CONSTANT_ENCAPSED_STRING","'<\/theme>'",320],")",";",["T_WHITESPACE","\n        ",320],["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","_buildRecursive",321],"(",["T_VARIABLE","$xml",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","addChild",321],"(",["T_CONSTANT_ENCAPSED_STRING","'configuration'",321],")",",",["T_WHITESPACE"," ",321],["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","_validateFormInput",321],"(",["T_VARIABLE","$data",321],")",")",";",["T_WHITESPACE","\n        ",321],["T_STRING","clearstatcache",322],"(",")",";",["T_WHITESPACE","\n        ",322],["T_IF","if",323],["T_WHITESPACE"," ",323],"(",["T_STRING","is_writeable",323],"(",["T_VARIABLE","$this",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","_file",323],")",")",["T_WHITESPACE"," ",323],"{",["T_WHITESPACE","\n            ",323],["T_STRING","file_put_contents",324],"(",["T_VARIABLE","$this",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","_file",324],",",["T_WHITESPACE"," ",324],["T_VARIABLE","$xml",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","asXML",324],"(",")",")",";",["T_WHITESPACE","\n        ",324],"}",["T_WHITESPACE"," ",325],["T_ELSE","else",325],["T_WHITESPACE"," ",325],"{",["T_WHITESPACE","\n            ",325],["T_VARIABLE","$io",326],["T_WHITESPACE"," ",326],"=",["T_WHITESPACE"," ",326],["T_NEW","new",326],["T_WHITESPACE"," ",326],["T_STRING","Varien_Io_File",326],"(",")",";",["T_WHITESPACE","\n            ",326],["T_STRING","Mage",327],["T_DOUBLE_COLON","::",327],["T_STRING","throwException",327],"(",["T_STRING","Mage",327],["T_DOUBLE_COLON","::",327],["T_STRING","helper",327],"(",["T_CONSTANT_ENCAPSED_STRING","'xmlconnect'",327],")",["T_OBJECT_OPERATOR","->",327],["T_STRING","__",327],"(",["T_CONSTANT_ENCAPSED_STRING","'Can\\'t write to file \"%s\".'",327],",",["T_WHITESPACE","\n                ",327],["T_VARIABLE","$io",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","getFilteredPath",328],"(",["T_VARIABLE","$this",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","_file",328],")",")",")",";",["T_WHITESPACE","\n        ",328],"}",["T_WHITESPACE","\n    ",329],"}",["T_WHITESPACE","\n",330],"}",["T_WHITESPACE","\n",331]]