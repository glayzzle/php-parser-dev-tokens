[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Payment\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_CLASS","class",28],["T_WHITESPACE"," ",28],["T_STRING","Mage_Payment_Model_Method_Cc",28],["T_WHITESPACE"," ",28],["T_EXTENDS","extends",28],["T_WHITESPACE"," ",28],["T_STRING","Mage_Payment_Model_Method_Abstract",28],["T_WHITESPACE","\n",28],"{",["T_WHITESPACE","\n    ",29],["T_PROTECTED","protected",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$_formBlockType",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_CONSTANT_ENCAPSED_STRING","'payment\/form_cc'",30],";",["T_WHITESPACE","\n    ",30],["T_PROTECTED","protected",31],["T_WHITESPACE"," ",31],["T_VARIABLE","$_infoBlockType",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_CONSTANT_ENCAPSED_STRING","'payment\/info_cc'",31],";",["T_WHITESPACE","\n    ",31],["T_PROTECTED","protected",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$_canSaveCc",32],["T_WHITESPACE","     ",32],"=",["T_WHITESPACE"," ",32],["T_STRING","false",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * Assign data to info model instance\n     *\n     * @param   mixed $data\n     * @return  Mage_Payment_Model_Info\n     *\/",34],["T_WHITESPACE","\n    ",39],["T_PUBLIC","public",40],["T_WHITESPACE"," ",40],["T_FUNCTION","function",40],["T_WHITESPACE"," ",40],["T_STRING","assignData",40],"(",["T_VARIABLE","$data",40],")",["T_WHITESPACE","\n    ",40],"{",["T_WHITESPACE","\n        ",41],["T_IF","if",42],["T_WHITESPACE"," ",42],"(","!","(",["T_VARIABLE","$data",42],["T_WHITESPACE"," ",42],["T_INSTANCEOF","instanceof",42],["T_WHITESPACE"," ",42],["T_STRING","Varien_Object",42],")",")",["T_WHITESPACE"," ",42],"{",["T_WHITESPACE","\n            ",42],["T_VARIABLE","$data",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_NEW","new",43],["T_WHITESPACE"," ",43],["T_STRING","Varien_Object",43],"(",["T_VARIABLE","$data",43],")",";",["T_WHITESPACE","\n        ",43],"}",["T_WHITESPACE","\n        ",44],["T_VARIABLE","$info",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","getInfoInstance",45],"(",")",";",["T_WHITESPACE","\n        ",45],["T_VARIABLE","$info",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","setCcType",46],"(",["T_VARIABLE","$data",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","getCcType",46],"(",")",")",["T_WHITESPACE","\n            ",46],["T_OBJECT_OPERATOR","->",47],["T_STRING","setCcOwner",47],"(",["T_VARIABLE","$data",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","getCcOwner",47],"(",")",")",["T_WHITESPACE","\n            ",47],["T_OBJECT_OPERATOR","->",48],["T_STRING","setCcLast4",48],"(",["T_STRING","substr",48],"(",["T_VARIABLE","$data",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","getCcNumber",48],"(",")",",",["T_WHITESPACE"," ",48],"-",["T_LNUMBER","4",48],")",")",["T_WHITESPACE","\n            ",48],["T_OBJECT_OPERATOR","->",49],["T_STRING","setCcNumber",49],"(",["T_VARIABLE","$data",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","getCcNumber",49],"(",")",")",["T_WHITESPACE","\n            ",49],["T_OBJECT_OPERATOR","->",50],["T_STRING","setCcCid",50],"(",["T_VARIABLE","$data",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","getCcCid",50],"(",")",")",["T_WHITESPACE","\n            ",50],["T_OBJECT_OPERATOR","->",51],["T_STRING","setCcExpMonth",51],"(",["T_VARIABLE","$data",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","getCcExpMonth",51],"(",")",")",["T_WHITESPACE","\n            ",51],["T_OBJECT_OPERATOR","->",52],["T_STRING","setCcExpYear",52],"(",["T_VARIABLE","$data",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","getCcExpYear",52],"(",")",")",["T_WHITESPACE","\n            ",52],["T_OBJECT_OPERATOR","->",53],["T_STRING","setCcSsIssue",53],"(",["T_VARIABLE","$data",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","getCcSsIssue",53],"(",")",")",["T_WHITESPACE","\n            ",53],["T_OBJECT_OPERATOR","->",54],["T_STRING","setCcSsStartMonth",54],"(",["T_VARIABLE","$data",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","getCcSsStartMonth",54],"(",")",")",["T_WHITESPACE","\n            ",54],["T_OBJECT_OPERATOR","->",55],["T_STRING","setCcSsStartYear",55],"(",["T_VARIABLE","$data",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","getCcSsStartYear",55],"(",")",")",["T_WHITESPACE","\n            ",55],";",["T_WHITESPACE","\n        ",56],["T_RETURN","return",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$this",57],";",["T_WHITESPACE","\n    ",57],"}",["T_WHITESPACE","\n\n    ",58],["T_DOC_COMMENT","\/**\n     * Prepare info instance for save\n     *\n     * @return Mage_Payment_Model_Abstract\n     *\/",60],["T_WHITESPACE","\n    ",64],["T_PUBLIC","public",65],["T_WHITESPACE"," ",65],["T_FUNCTION","function",65],["T_WHITESPACE"," ",65],["T_STRING","prepareSave",65],"(",")",["T_WHITESPACE","\n    ",65],"{",["T_WHITESPACE","\n        ",66],["T_VARIABLE","$info",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getInfoInstance",67],"(",")",";",["T_WHITESPACE","\n        ",67],["T_IF","if",68],["T_WHITESPACE"," ",68],"(",["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","_canSaveCc",68],")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n            ",68],["T_VARIABLE","$info",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","setCcNumberEnc",69],"(",["T_VARIABLE","$info",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","encrypt",69],"(",["T_VARIABLE","$info",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getCcNumber",69],"(",")",")",")",";",["T_WHITESPACE","\n        ",69],"}",["T_WHITESPACE","\n        ",70],["T_COMMENT","\/\/$info->setCcCidEnc($info->encrypt($info->getCcCid()));\n",71],["T_WHITESPACE","        ",72],["T_VARIABLE","$info",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","setCcNumber",72],"(",["T_STRING","null",72],")",["T_WHITESPACE","\n            ",72],["T_OBJECT_OPERATOR","->",73],["T_STRING","setCcCid",73],"(",["T_STRING","null",73],")",";",["T_WHITESPACE","\n        ",73],["T_RETURN","return",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$this",74],";",["T_WHITESPACE","\n    ",74],"}",["T_WHITESPACE","\n\n    ",75],["T_DOC_COMMENT","\/**\n     * Validate payment method information object\n     *\n     * @param   Mage_Payment_Model_Info $info\n     * @return  Mage_Payment_Model_Abstract\n     *\/",77],["T_WHITESPACE","\n    ",82],["T_PUBLIC","public",83],["T_WHITESPACE"," ",83],["T_FUNCTION","function",83],["T_WHITESPACE"," ",83],["T_STRING","validate",83],"(",")",["T_WHITESPACE","\n    ",83],"{",["T_WHITESPACE","\n        ",84],["T_COMMENT","\/*\n        * calling parent validate function\n        *\/",85],["T_WHITESPACE","\n        ",87],["T_STRING","parent",88],["T_DOUBLE_COLON","::",88],["T_STRING","validate",88],"(",")",";",["T_WHITESPACE","\n\n        ",88],["T_VARIABLE","$info",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","getInfoInstance",90],"(",")",";",["T_WHITESPACE","\n        ",90],["T_VARIABLE","$errorMsg",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_STRING","false",91],";",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$availableTypes",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_STRING","explode",92],"(",["T_CONSTANT_ENCAPSED_STRING","','",92],",",["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getConfigData",92],"(",["T_CONSTANT_ENCAPSED_STRING","'cctypes'",92],")",")",";",["T_WHITESPACE","\n\n        ",92],["T_VARIABLE","$ccNumber",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_VARIABLE","$info",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getCcNumber",94],"(",")",";",["T_WHITESPACE","\n\n        ",94],["T_COMMENT","\/\/ remove credit card number delimiters such as \"-\" and space\n",96],["T_WHITESPACE","        ",97],["T_VARIABLE","$ccNumber",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_STRING","preg_replace",97],"(",["T_CONSTANT_ENCAPSED_STRING","'\/[\\-\\s]+\/'",97],",",["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","''",97],",",["T_WHITESPACE"," ",97],["T_VARIABLE","$ccNumber",97],")",";",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$info",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","setCcNumber",98],"(",["T_VARIABLE","$ccNumber",98],")",";",["T_WHITESPACE","\n\n        ",98],["T_VARIABLE","$ccType",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","''",100],";",["T_WHITESPACE","\n\n        ",100],["T_IF","if",102],["T_WHITESPACE"," ",102],"(",["T_STRING","in_array",102],"(",["T_VARIABLE","$info",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getCcType",102],"(",")",",",["T_WHITESPACE"," ",102],["T_VARIABLE","$availableTypes",102],")",")","{",["T_WHITESPACE","\n            ",102],["T_IF","if",103],["T_WHITESPACE"," ",103],"(",["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","validateCcNum",103],"(",["T_VARIABLE","$ccNumber",103],")",["T_WHITESPACE","\n                ",103],["T_COMMENT","\/\/ Other credit card type number validation\n",104],["T_WHITESPACE","                ",105],["T_BOOLEAN_OR","||",105],["T_WHITESPACE"," ",105],"(",["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","OtherCcType",105],"(",["T_VARIABLE","$info",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getCcType",105],"(",")",")",["T_WHITESPACE"," ",105],["T_BOOLEAN_AND","&&",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","validateCcNumOther",105],"(",["T_VARIABLE","$ccNumber",105],")",")",")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n\n                ",105],["T_VARIABLE","$ccType",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'OT'",107],";",["T_WHITESPACE","\n                ",107],["T_VARIABLE","$discoverNetworkRegexp",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'\/^(30[0-5]\\d{13}|3095\\d{12}|35(2[8-9]\\d{12}|[3-8]\\d{13})|36\\d{12}'",108],["T_WHITESPACE","\n                    ",108],".",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'|3[8-9]\\d{14}|6011(0\\d{11}|[2-4]\\d{11}|74\\d{10}|7[7-9]\\d{10}|8[6-9]\\d{10}|9\\d{11})'",109],["T_WHITESPACE","\n                    ",109],".",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'|62(2(12[6-9]\\d{10}|1[3-9]\\d{11}|[2-8]\\d{12}|9[0-1]\\d{11}|92[0-5]\\d{10})|[4-6]\\d{13}'",110],["T_WHITESPACE","\n                    ",110],".",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","'|8[2-8]\\d{12})|6(4[4-9]\\d{13}|5\\d{14}))$\/'",111],";",["T_WHITESPACE","\n                ",111],["T_VARIABLE","$ccTypeRegExpList",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_ARRAY","array",112],"(",["T_WHITESPACE","\n                    ",112],["T_COMMENT","\/\/Solo, Switch or Maestro. International safe\n",113],["T_WHITESPACE","                    ",114],["T_COMMENT","\/*\n                    \/\/ Maestro \/ Solo\n                    'SS'  => '\/^((6759[0-9]{12})|(6334|6767[0-9]{12})|(6334|6767[0-9]{14,15})'\n                               . '|(5018|5020|5038|6304|6759|6761|6763[0-9]{12,19})|(49[013][1356][0-9]{12})'\n                               . '|(633[34][0-9]{12})|(633110[0-9]{10})|(564182[0-9]{10}))([0-9]{2,3})?$\/',\n                    *\/",114],["T_WHITESPACE","\n                    ",119],["T_COMMENT","\/\/ Solo only\n",120],["T_WHITESPACE","                    ",121],["T_CONSTANT_ENCAPSED_STRING","'SO'",121],["T_WHITESPACE"," ",121],["T_DOUBLE_ARROW","=>",121],["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","'\/(^(6334)[5-9](\\d{11}$|\\d{13,14}$))|(^(6767)(\\d{12}$|\\d{14,15}$))\/'",121],",",["T_WHITESPACE","\n                    ",121],["T_COMMENT","\/\/ Visa\n",122],["T_WHITESPACE","                    ",123],["T_CONSTANT_ENCAPSED_STRING","'VI'",123],["T_WHITESPACE","  ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'\/^4[0-9]{12}([0-9]{3})?$\/'",123],",",["T_WHITESPACE","\n                    ",123],["T_COMMENT","\/\/ Master Card\n",124],["T_WHITESPACE","                    ",125],["T_CONSTANT_ENCAPSED_STRING","'MC'",125],["T_WHITESPACE","  ",125],["T_DOUBLE_ARROW","=>",125],["T_WHITESPACE"," ",125],["T_CONSTANT_ENCAPSED_STRING","'\/^(5[1-5][0-9]{14}|2(22[1-9][0-9]{12}|2[3-9][0-9]{13}|[3-6][0-9]{14}|7[0-1][0-9]{13}|720[0-9]{12}))$\/'",125],",",["T_WHITESPACE","\n                    ",125],["T_COMMENT","\/\/ American Express\n",126],["T_WHITESPACE","                    ",127],["T_CONSTANT_ENCAPSED_STRING","'AE'",127],["T_WHITESPACE","  ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","'\/^3[47][0-9]{13}$\/'",127],",",["T_WHITESPACE","\n                    ",127],["T_COMMENT","\/\/ Discover Network\n",128],["T_WHITESPACE","                    ",129],["T_CONSTANT_ENCAPSED_STRING","'DI'",129],["T_WHITESPACE","  ",129],["T_DOUBLE_ARROW","=>",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$discoverNetworkRegexp",129],",",["T_WHITESPACE","\n                    ",129],["T_COMMENT","\/\/ Dinners Club (Belongs to Discover Network)\n",130],["T_WHITESPACE","                    ",131],["T_CONSTANT_ENCAPSED_STRING","'DICL'",131],["T_WHITESPACE"," ",131],["T_DOUBLE_ARROW","=>",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$discoverNetworkRegexp",131],",",["T_WHITESPACE","\n                    ",131],["T_COMMENT","\/\/ JCB (Belongs to Discover Network)\n",132],["T_WHITESPACE","                    ",133],["T_CONSTANT_ENCAPSED_STRING","'JCB'",133],["T_WHITESPACE"," ",133],["T_DOUBLE_ARROW","=>",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$discoverNetworkRegexp",133],",",["T_WHITESPACE","\n\n                    ",133],["T_COMMENT","\/\/ Maestro & Switch\n",135],["T_WHITESPACE","                    ",136],["T_CONSTANT_ENCAPSED_STRING","'SM'",136],["T_WHITESPACE"," ",136],["T_DOUBLE_ARROW","=>",136],["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","'\/(^(5[0678])\\d{11,18}$)|(^(6[^05])\\d{11,18}$)|(^(601)[^1]\\d{9,16}$)|(^(6011)\\d{9,11}$)'",136],["T_WHITESPACE","\n                    ",136],".",["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'|(^(6011)\\d{13,16}$)|(^(65)\\d{11,13}$)|(^(65)\\d{15,18}$)'",137],["T_WHITESPACE","\n                    ",137],".",["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","'|(^(49030)[2-9](\\d{10}$|\\d{12,13}$))|(^(49033)[5-9](\\d{10}$|\\d{12,13}$))'",138],["T_WHITESPACE","\n                    ",138],".",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'|(^(49110)[1-2](\\d{10}$|\\d{12,13}$))|(^(49117)[4-9](\\d{10}$|\\d{12,13}$))'",139],["T_WHITESPACE","\n                    ",139],".",["T_WHITESPACE"," ",140],["T_CONSTANT_ENCAPSED_STRING","'|(^(49118)[0-2](\\d{10}$|\\d{12,13}$))|(^(4936)(\\d{12}$|\\d{14,15}$))\/'",140],["T_WHITESPACE","\n                ",140],")",";",["T_WHITESPACE","\n\n                ",141],["T_VARIABLE","$specifiedCCType",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_VARIABLE","$info",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getCcType",143],"(",")",";",["T_WHITESPACE","\n                ",143],["T_IF","if",144],["T_WHITESPACE"," ",144],"(",["T_STRING","array_key_exists",144],"(",["T_VARIABLE","$specifiedCCType",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$ccTypeRegExpList",144],")",")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n                    ",144],["T_VARIABLE","$ccTypeRegExp",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_VARIABLE","$ccTypeRegExpList",145],"[",["T_VARIABLE","$specifiedCCType",145],"]",";",["T_WHITESPACE","\n                    ",145],["T_IF","if",146],["T_WHITESPACE"," ",146],"(","!",["T_STRING","preg_match",146],"(",["T_VARIABLE","$ccTypeRegExp",146],",",["T_WHITESPACE"," ",146],["T_VARIABLE","$ccNumber",146],")",")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n                        ",146],["T_VARIABLE","$errorMsg",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_STRING","Mage",147],["T_DOUBLE_COLON","::",147],["T_STRING","helper",147],"(",["T_CONSTANT_ENCAPSED_STRING","'payment'",147],")",["T_OBJECT_OPERATOR","->",147],["T_STRING","__",147],"(",["T_CONSTANT_ENCAPSED_STRING","'Credit card number mismatch with credit card type.'",147],")",";",["T_WHITESPACE","\n                    ",147],"}",["T_WHITESPACE","\n                ",148],"}",["T_WHITESPACE","\n            ",149],"}",["T_WHITESPACE","\n            ",150],["T_ELSE","else",151],["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n                ",151],["T_VARIABLE","$errorMsg",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_STRING","Mage",152],["T_DOUBLE_COLON","::",152],["T_STRING","helper",152],"(",["T_CONSTANT_ENCAPSED_STRING","'payment'",152],")",["T_OBJECT_OPERATOR","->",152],["T_STRING","__",152],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid Credit Card Number'",152],")",";",["T_WHITESPACE","\n            ",152],"}",["T_WHITESPACE","\n\n        ",153],"}",["T_WHITESPACE","\n        ",155],["T_ELSE","else",156],["T_WHITESPACE"," ",156],"{",["T_WHITESPACE","\n            ",156],["T_VARIABLE","$errorMsg",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_STRING","Mage",157],["T_DOUBLE_COLON","::",157],["T_STRING","helper",157],"(",["T_CONSTANT_ENCAPSED_STRING","'payment'",157],")",["T_OBJECT_OPERATOR","->",157],["T_STRING","__",157],"(",["T_CONSTANT_ENCAPSED_STRING","'Credit card type is not allowed for this payment method.'",157],")",";",["T_WHITESPACE","\n        ",157],"}",["T_WHITESPACE","\n\n        ",158],["T_COMMENT","\/\/validate credit card verification number\n",160],["T_WHITESPACE","        ",161],["T_IF","if",161],["T_WHITESPACE"," ",161],"(",["T_VARIABLE","$errorMsg",161],["T_WHITESPACE"," ",161],["T_IS_IDENTICAL","===",161],["T_WHITESPACE"," ",161],["T_STRING","false",161],["T_WHITESPACE"," ",161],["T_BOOLEAN_AND","&&",161],["T_WHITESPACE"," ",161],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","hasVerification",161],"(",")",")",["T_WHITESPACE"," ",161],"{",["T_WHITESPACE","\n            ",161],["T_VARIABLE","$verifcationRegEx",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","getVerificationRegEx",162],"(",")",";",["T_WHITESPACE","\n            ",162],["T_VARIABLE","$regExp",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_ISSET","isset",163],"(",["T_VARIABLE","$verifcationRegEx",163],"[",["T_VARIABLE","$info",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","getCcType",163],"(",")","]",")",["T_WHITESPACE"," ",163],"?",["T_WHITESPACE"," ",163],["T_VARIABLE","$verifcationRegEx",163],"[",["T_VARIABLE","$info",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","getCcType",163],"(",")","]",["T_WHITESPACE"," ",163],":",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","''",163],";",["T_WHITESPACE","\n            ",163],["T_IF","if",164],["T_WHITESPACE"," ",164],"(","!",["T_VARIABLE","$info",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","getCcCid",164],"(",")",["T_WHITESPACE"," ",164],["T_BOOLEAN_OR","||",164],["T_WHITESPACE"," ",164],"!",["T_VARIABLE","$regExp",164],["T_WHITESPACE"," ",164],["T_BOOLEAN_OR","||",164],["T_WHITESPACE"," ",164],"!",["T_STRING","preg_match",164],"(",["T_VARIABLE","$regExp",164],["T_WHITESPACE"," ",164],",",["T_VARIABLE","$info",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","getCcCid",164],"(",")",")",")","{",["T_WHITESPACE","\n                ",164],["T_VARIABLE","$errorMsg",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_STRING","Mage",165],["T_DOUBLE_COLON","::",165],["T_STRING","helper",165],"(",["T_CONSTANT_ENCAPSED_STRING","'payment'",165],")",["T_OBJECT_OPERATOR","->",165],["T_STRING","__",165],"(",["T_CONSTANT_ENCAPSED_STRING","'Please enter a valid credit card verification number.'",165],")",";",["T_WHITESPACE","\n            ",165],"}",["T_WHITESPACE","\n        ",166],"}",["T_WHITESPACE","\n\n        ",167],["T_IF","if",169],["T_WHITESPACE"," ",169],"(",["T_VARIABLE","$ccType",169],["T_WHITESPACE"," ",169],["T_IS_NOT_EQUAL","!=",169],["T_WHITESPACE"," ",169],["T_CONSTANT_ENCAPSED_STRING","'SS'",169],["T_WHITESPACE"," ",169],["T_BOOLEAN_AND","&&",169],["T_WHITESPACE"," ",169],"!",["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","_validateExpDate",169],"(",["T_VARIABLE","$info",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","getCcExpYear",169],"(",")",",",["T_WHITESPACE"," ",169],["T_VARIABLE","$info",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","getCcExpMonth",169],"(",")",")",")",["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n            ",169],["T_VARIABLE","$errorMsg",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_STRING","Mage",170],["T_DOUBLE_COLON","::",170],["T_STRING","helper",170],"(",["T_CONSTANT_ENCAPSED_STRING","'payment'",170],")",["T_OBJECT_OPERATOR","->",170],["T_STRING","__",170],"(",["T_CONSTANT_ENCAPSED_STRING","'Incorrect credit card expiration date.'",170],")",";",["T_WHITESPACE","\n        ",170],"}",["T_WHITESPACE","\n\n        ",171],["T_IF","if",173],"(",["T_VARIABLE","$errorMsg",173],")","{",["T_WHITESPACE","\n            ",173],["T_STRING","Mage",174],["T_DOUBLE_COLON","::",174],["T_STRING","throwException",174],"(",["T_VARIABLE","$errorMsg",174],")",";",["T_WHITESPACE","\n        ",174],"}",["T_WHITESPACE","\n\n        ",175],["T_COMMENT","\/\/This must be after all validation conditions\n",177],["T_WHITESPACE","        ",178],["T_IF","if",178],["T_WHITESPACE"," ",178],"(",["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","getIsCentinelValidationEnabled",178],"(",")",")",["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n            ",178],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","getCentinelValidator",179],"(",")",["T_OBJECT_OPERATOR","->",179],["T_STRING","validate",179],"(",["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","getCentinelValidationData",179],"(",")",")",";",["T_WHITESPACE","\n        ",179],"}",["T_WHITESPACE","\n\n        ",180],["T_RETURN","return",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$this",182],";",["T_WHITESPACE","\n    ",182],"}",["T_WHITESPACE","\n\n    ",183],["T_PUBLIC","public",185],["T_WHITESPACE"," ",185],["T_FUNCTION","function",185],["T_WHITESPACE"," ",185],["T_STRING","hasVerification",185],"(",")",["T_WHITESPACE","\n    ",185],"{",["T_WHITESPACE","\n        ",186],["T_VARIABLE","$configData",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","getConfigData",187],"(",["T_CONSTANT_ENCAPSED_STRING","'useccv'",187],")",";",["T_WHITESPACE","\n        ",187],["T_IF","if",188],"(",["T_STRING","is_null",188],"(",["T_VARIABLE","$configData",188],")",")","{",["T_WHITESPACE","\n            ",188],["T_RETURN","return",189],["T_WHITESPACE"," ",189],["T_STRING","true",189],";",["T_WHITESPACE","\n        ",189],"}",["T_WHITESPACE","\n        ",190],["T_RETURN","return",191],["T_WHITESPACE"," ",191],["T_BOOL_CAST","(bool)",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$configData",191],";",["T_WHITESPACE","\n    ",191],"}",["T_WHITESPACE","\n\n    ",192],["T_PUBLIC","public",194],["T_WHITESPACE"," ",194],["T_FUNCTION","function",194],["T_WHITESPACE"," ",194],["T_STRING","getVerificationRegEx",194],"(",")",["T_WHITESPACE","\n    ",194],"{",["T_WHITESPACE","\n        ",195],["T_VARIABLE","$verificationExpList",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_ARRAY","array",196],"(",["T_WHITESPACE","\n            ",196],["T_CONSTANT_ENCAPSED_STRING","'VI'",197],["T_WHITESPACE"," ",197],["T_DOUBLE_ARROW","=>",197],["T_WHITESPACE"," ",197],["T_CONSTANT_ENCAPSED_STRING","'\/^[0-9]{3}$\/'",197],",",["T_WHITESPACE"," ",197],["T_COMMENT","\/\/ Visa\n",197],["T_WHITESPACE","            ",198],["T_CONSTANT_ENCAPSED_STRING","'MC'",198],["T_WHITESPACE"," ",198],["T_DOUBLE_ARROW","=>",198],["T_WHITESPACE"," ",198],["T_CONSTANT_ENCAPSED_STRING","'\/^[0-9]{3}$\/'",198],",",["T_WHITESPACE","       ",198],["T_COMMENT","\/\/ Master Card\n",198],["T_WHITESPACE","            ",199],["T_CONSTANT_ENCAPSED_STRING","'AE'",199],["T_WHITESPACE"," ",199],["T_DOUBLE_ARROW","=>",199],["T_WHITESPACE"," ",199],["T_CONSTANT_ENCAPSED_STRING","'\/^[0-9]{4}$\/'",199],",",["T_WHITESPACE","        ",199],["T_COMMENT","\/\/ American Express\n",199],["T_WHITESPACE","            ",200],["T_CONSTANT_ENCAPSED_STRING","'DI'",200],["T_WHITESPACE"," ",200],["T_DOUBLE_ARROW","=>",200],["T_WHITESPACE"," ",200],["T_CONSTANT_ENCAPSED_STRING","'\/^[0-9]{3}$\/'",200],",",["T_WHITESPACE","          ",200],["T_COMMENT","\/\/ Discovery\n",200],["T_WHITESPACE","            ",201],["T_CONSTANT_ENCAPSED_STRING","'SS'",201],["T_WHITESPACE"," ",201],["T_DOUBLE_ARROW","=>",201],["T_WHITESPACE"," ",201],["T_CONSTANT_ENCAPSED_STRING","'\/^[0-9]{3,4}$\/'",201],",",["T_WHITESPACE","\n            ",201],["T_CONSTANT_ENCAPSED_STRING","'SM'",202],["T_WHITESPACE"," ",202],["T_DOUBLE_ARROW","=>",202],["T_WHITESPACE"," ",202],["T_CONSTANT_ENCAPSED_STRING","'\/^[0-9]{3,4}$\/'",202],",",["T_WHITESPACE"," ",202],["T_COMMENT","\/\/ Switch or Maestro\n",202],["T_WHITESPACE","            ",203],["T_CONSTANT_ENCAPSED_STRING","'SO'",203],["T_WHITESPACE"," ",203],["T_DOUBLE_ARROW","=>",203],["T_WHITESPACE"," ",203],["T_CONSTANT_ENCAPSED_STRING","'\/^[0-9]{3,4}$\/'",203],",",["T_WHITESPACE"," ",203],["T_COMMENT","\/\/ Solo\n",203],["T_WHITESPACE","            ",204],["T_CONSTANT_ENCAPSED_STRING","'OT'",204],["T_WHITESPACE"," ",204],["T_DOUBLE_ARROW","=>",204],["T_WHITESPACE"," ",204],["T_CONSTANT_ENCAPSED_STRING","'\/^[0-9]{3,4}$\/'",204],",",["T_WHITESPACE","\n            ",204],["T_CONSTANT_ENCAPSED_STRING","'JCB'",205],["T_WHITESPACE"," ",205],["T_DOUBLE_ARROW","=>",205],["T_WHITESPACE"," ",205],["T_CONSTANT_ENCAPSED_STRING","'\/^[0-9]{3,4}$\/'",205],["T_WHITESPACE"," ",205],["T_COMMENT","\/\/JCB\n",205],["T_WHITESPACE","        ",206],")",";",["T_WHITESPACE","\n        ",206],["T_RETURN","return",207],["T_WHITESPACE"," ",207],["T_VARIABLE","$verificationExpList",207],";",["T_WHITESPACE","\n    ",207],"}",["T_WHITESPACE","\n\n    ",208],["T_PROTECTED","protected",210],["T_WHITESPACE"," ",210],["T_FUNCTION","function",210],["T_WHITESPACE"," ",210],["T_STRING","_validateExpDate",210],"(",["T_VARIABLE","$expYear",210],",",["T_WHITESPACE"," ",210],["T_VARIABLE","$expMonth",210],")",["T_WHITESPACE","\n    ",210],"{",["T_WHITESPACE","\n        ",211],["T_VARIABLE","$date",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_STRING","Mage",212],["T_DOUBLE_COLON","::",212],["T_STRING","app",212],"(",")",["T_OBJECT_OPERATOR","->",212],["T_STRING","getLocale",212],"(",")",["T_OBJECT_OPERATOR","->",212],["T_STRING","date",212],"(",")",";",["T_WHITESPACE","\n        ",212],["T_IF","if",213],["T_WHITESPACE"," ",213],"(","!",["T_VARIABLE","$expYear",213],["T_WHITESPACE"," ",213],["T_BOOLEAN_OR","||",213],["T_WHITESPACE"," ",213],"!",["T_VARIABLE","$expMonth",213],["T_WHITESPACE"," ",213],["T_BOOLEAN_OR","||",213],["T_WHITESPACE"," ",213],"(",["T_VARIABLE","$date",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","compareYear",213],"(",["T_VARIABLE","$expYear",213],")",["T_WHITESPACE"," ",213],["T_IS_EQUAL","==",213],["T_WHITESPACE"," ",213],["T_LNUMBER","1",213],")",["T_WHITESPACE","\n            ",213],["T_BOOLEAN_OR","||",214],["T_WHITESPACE"," ",214],"(",["T_VARIABLE","$date",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","compareYear",214],"(",["T_VARIABLE","$expYear",214],")",["T_WHITESPACE"," ",214],["T_IS_EQUAL","==",214],["T_WHITESPACE"," ",214],["T_LNUMBER","0",214],["T_WHITESPACE"," ",214],["T_BOOLEAN_AND","&&",214],["T_WHITESPACE"," ",214],"(",["T_VARIABLE","$date",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","compareMonth",214],"(",["T_VARIABLE","$expMonth",214],")",["T_WHITESPACE"," ",214],["T_IS_EQUAL","==",214],["T_WHITESPACE"," ",214],["T_LNUMBER","1",214],")",")",["T_WHITESPACE","\n        ",214],")",["T_WHITESPACE"," ",215],"{",["T_WHITESPACE","\n            ",215],["T_RETURN","return",216],["T_WHITESPACE"," ",216],["T_STRING","false",216],";",["T_WHITESPACE","\n        ",216],"}",["T_WHITESPACE","\n        ",217],["T_RETURN","return",218],["T_WHITESPACE"," ",218],["T_STRING","true",218],";",["T_WHITESPACE","\n    ",218],"}",["T_WHITESPACE","\n\n    ",219],["T_PUBLIC","public",221],["T_WHITESPACE"," ",221],["T_FUNCTION","function",221],["T_WHITESPACE"," ",221],["T_STRING","OtherCcType",221],"(",["T_VARIABLE","$type",221],")",["T_WHITESPACE","\n    ",221],"{",["T_WHITESPACE","\n        ",222],["T_RETURN","return",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$type",223],["T_IS_EQUAL","==",223],["T_CONSTANT_ENCAPSED_STRING","'OT'",223],";",["T_WHITESPACE","\n    ",223],"}",["T_WHITESPACE","\n\n    ",224],["T_DOC_COMMENT","\/**\n     * Validate credit card number\n     *\n     * @param   string $cc_number\n     * @return  bool\n     *\/",226],["T_WHITESPACE","\n    ",231],["T_PUBLIC","public",232],["T_WHITESPACE"," ",232],["T_FUNCTION","function",232],["T_WHITESPACE"," ",232],["T_STRING","validateCcNum",232],"(",["T_VARIABLE","$ccNumber",232],")",["T_WHITESPACE","\n    ",232],"{",["T_WHITESPACE","\n        ",233],["T_VARIABLE","$cardNumber",234],["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_STRING","strrev",234],"(",["T_VARIABLE","$ccNumber",234],")",";",["T_WHITESPACE","\n        ",234],["T_VARIABLE","$numSum",235],["T_WHITESPACE"," ",235],"=",["T_WHITESPACE"," ",235],["T_LNUMBER","0",235],";",["T_WHITESPACE","\n\n        ",235],["T_FOR","for",237],["T_WHITESPACE"," ",237],"(",["T_VARIABLE","$i",237],"=",["T_LNUMBER","0",237],";",["T_WHITESPACE"," ",237],["T_VARIABLE","$i",237],"<",["T_STRING","strlen",237],"(",["T_VARIABLE","$cardNumber",237],")",";",["T_WHITESPACE"," ",237],["T_VARIABLE","$i",237],["T_INC","++",237],")",["T_WHITESPACE"," ",237],"{",["T_WHITESPACE","\n            ",237],["T_VARIABLE","$currentNum",238],["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],["T_STRING","substr",238],"(",["T_VARIABLE","$cardNumber",238],",",["T_WHITESPACE"," ",238],["T_VARIABLE","$i",238],",",["T_WHITESPACE"," ",238],["T_LNUMBER","1",238],")",";",["T_WHITESPACE","\n\n            ",238],["T_DOC_COMMENT","\/**\n             * Double every second digit\n             *\/",240],["T_WHITESPACE","\n            ",242],["T_IF","if",243],["T_WHITESPACE"," ",243],"(",["T_VARIABLE","$i",243],["T_WHITESPACE"," ",243],"%",["T_WHITESPACE"," ",243],["T_LNUMBER","2",243],["T_WHITESPACE"," ",243],["T_IS_EQUAL","==",243],["T_WHITESPACE"," ",243],["T_LNUMBER","1",243],")",["T_WHITESPACE"," ",243],"{",["T_WHITESPACE","\n                ",243],["T_VARIABLE","$currentNum",244],["T_WHITESPACE"," ",244],["T_MUL_EQUAL","*=",244],["T_WHITESPACE"," ",244],["T_LNUMBER","2",244],";",["T_WHITESPACE","\n            ",244],"}",["T_WHITESPACE","\n\n            ",245],["T_DOC_COMMENT","\/**\n             * Add digits of 2-digit numbers together\n             *\/",247],["T_WHITESPACE","\n            ",249],["T_IF","if",250],["T_WHITESPACE"," ",250],"(",["T_VARIABLE","$currentNum",250],["T_WHITESPACE"," ",250],">",["T_WHITESPACE"," ",250],["T_LNUMBER","9",250],")",["T_WHITESPACE"," ",250],"{",["T_WHITESPACE","\n                ",250],["T_VARIABLE","$firstNum",251],["T_WHITESPACE"," ",251],"=",["T_WHITESPACE"," ",251],["T_VARIABLE","$currentNum",251],["T_WHITESPACE"," ",251],"%",["T_WHITESPACE"," ",251],["T_LNUMBER","10",251],";",["T_WHITESPACE","\n                ",251],["T_VARIABLE","$secondNum",252],["T_WHITESPACE"," ",252],"=",["T_WHITESPACE"," ",252],"(",["T_VARIABLE","$currentNum",252],["T_WHITESPACE"," ",252],"-",["T_WHITESPACE"," ",252],["T_VARIABLE","$firstNum",252],")",["T_WHITESPACE"," ",252],"\/",["T_WHITESPACE"," ",252],["T_LNUMBER","10",252],";",["T_WHITESPACE","\n                ",252],["T_VARIABLE","$currentNum",253],["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],["T_VARIABLE","$firstNum",253],["T_WHITESPACE"," ",253],"+",["T_WHITESPACE"," ",253],["T_VARIABLE","$secondNum",253],";",["T_WHITESPACE","\n            ",253],"}",["T_WHITESPACE","\n\n            ",254],["T_VARIABLE","$numSum",256],["T_WHITESPACE"," ",256],["T_PLUS_EQUAL","+=",256],["T_WHITESPACE"," ",256],["T_VARIABLE","$currentNum",256],";",["T_WHITESPACE","\n        ",256],"}",["T_WHITESPACE","\n\n        ",257],["T_DOC_COMMENT","\/**\n         * If the total has no remainder it's OK\n         *\/",259],["T_WHITESPACE","\n        ",261],["T_RETURN","return",262],["T_WHITESPACE"," ",262],"(",["T_VARIABLE","$numSum",262],["T_WHITESPACE"," ",262],"%",["T_WHITESPACE"," ",262],["T_LNUMBER","10",262],["T_WHITESPACE"," ",262],["T_IS_EQUAL","==",262],["T_WHITESPACE"," ",262],["T_LNUMBER","0",262],")",";",["T_WHITESPACE","\n    ",262],"}",["T_WHITESPACE","\n\n    ",263],["T_DOC_COMMENT","\/**\n     * Other credit cart type number validation\n     *\n     * @param string $ccNumber\n     * @return boolean\n     *\/",265],["T_WHITESPACE","\n    ",270],["T_PUBLIC","public",271],["T_WHITESPACE"," ",271],["T_FUNCTION","function",271],["T_WHITESPACE"," ",271],["T_STRING","validateCcNumOther",271],"(",["T_VARIABLE","$ccNumber",271],")",["T_WHITESPACE","\n    ",271],"{",["T_WHITESPACE","\n        ",272],["T_RETURN","return",273],["T_WHITESPACE"," ",273],["T_STRING","preg_match",273],"(",["T_CONSTANT_ENCAPSED_STRING","'\/^\\\\d+$\/'",273],",",["T_WHITESPACE"," ",273],["T_VARIABLE","$ccNumber",273],")",";",["T_WHITESPACE","\n    ",273],"}",["T_WHITESPACE","\n\n    ",274],["T_DOC_COMMENT","\/**\n     * Check whether there are CC types set in configuration\n     *\n     * @param Mage_Sales_Model_Quote|null $quote\n     * @return bool\n     *\/",276],["T_WHITESPACE","\n    ",281],["T_PUBLIC","public",282],["T_WHITESPACE"," ",282],["T_FUNCTION","function",282],["T_WHITESPACE"," ",282],["T_STRING","isAvailable",282],"(",["T_VARIABLE","$quote",282],["T_WHITESPACE"," ",282],"=",["T_WHITESPACE"," ",282],["T_STRING","null",282],")",["T_WHITESPACE","\n    ",282],"{",["T_WHITESPACE","\n        ",283],["T_RETURN","return",284],["T_WHITESPACE"," ",284],["T_VARIABLE","$this",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","getConfigData",284],"(",["T_CONSTANT_ENCAPSED_STRING","'cctypes'",284],",",["T_WHITESPACE"," ",284],"(",["T_VARIABLE","$quote",284],["T_WHITESPACE"," ",284],"?",["T_WHITESPACE"," ",284],["T_VARIABLE","$quote",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","getStoreId",284],"(",")",["T_WHITESPACE"," ",284],":",["T_WHITESPACE"," ",284],["T_STRING","null",284],")",")",["T_WHITESPACE","\n            ",284],["T_BOOLEAN_AND","&&",285],["T_WHITESPACE"," ",285],["T_STRING","parent",285],["T_DOUBLE_COLON","::",285],["T_STRING","isAvailable",285],"(",["T_VARIABLE","$quote",285],")",";",["T_WHITESPACE","\n    ",285],"}",["T_WHITESPACE","\n\n    ",286],["T_DOC_COMMENT","\/**\n     * Whether centinel service is enabled\n     *\n     * @return bool\n     *\/",288],["T_WHITESPACE","\n    ",292],["T_PUBLIC","public",293],["T_WHITESPACE"," ",293],["T_FUNCTION","function",293],["T_WHITESPACE"," ",293],["T_STRING","getIsCentinelValidationEnabled",293],"(",")",["T_WHITESPACE","\n    ",293],"{",["T_WHITESPACE","\n        ",294],["T_RETURN","return",295],["T_WHITESPACE"," ",295],["T_STRING","false",295],["T_WHITESPACE"," ",295],["T_IS_NOT_IDENTICAL","!==",295],["T_WHITESPACE"," ",295],["T_STRING","Mage",295],["T_DOUBLE_COLON","::",295],["T_STRING","getConfig",295],"(",")",["T_OBJECT_OPERATOR","->",295],["T_STRING","getNode",295],"(",["T_CONSTANT_ENCAPSED_STRING","'modules\/Mage_Centinel'",295],")",["T_WHITESPACE"," ",295],["T_BOOLEAN_AND","&&",295],["T_WHITESPACE"," ",295],["T_LNUMBER","1",295],["T_WHITESPACE"," ",295],["T_IS_EQUAL","==",295],["T_WHITESPACE"," ",295],["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","getConfigData",295],"(",["T_CONSTANT_ENCAPSED_STRING","'centinel'",295],")",";",["T_WHITESPACE","\n    ",295],"}",["T_WHITESPACE","\n\n    ",296],["T_DOC_COMMENT","\/**\n     * Instantiate centinel validator model\n     *\n     * @return Mage_Centinel_Model_Service\n     *\/",298],["T_WHITESPACE","\n    ",302],["T_PUBLIC","public",303],["T_WHITESPACE"," ",303],["T_FUNCTION","function",303],["T_WHITESPACE"," ",303],["T_STRING","getCentinelValidator",303],"(",")",["T_WHITESPACE","\n    ",303],"{",["T_WHITESPACE","\n        ",304],["T_VARIABLE","$validator",305],["T_WHITESPACE"," ",305],"=",["T_WHITESPACE"," ",305],["T_STRING","Mage",305],["T_DOUBLE_COLON","::",305],["T_STRING","getSingleton",305],"(",["T_CONSTANT_ENCAPSED_STRING","'centinel\/service'",305],")",";",["T_WHITESPACE","\n        ",305],["T_VARIABLE","$validator",306],["T_WHITESPACE","\n            ",306],["T_OBJECT_OPERATOR","->",307],["T_STRING","setIsModeStrict",307],"(",["T_VARIABLE","$this",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","getConfigData",307],"(",["T_CONSTANT_ENCAPSED_STRING","'centinel_is_mode_strict'",307],")",")",["T_WHITESPACE","\n            ",307],["T_OBJECT_OPERATOR","->",308],["T_STRING","setCustomApiEndpointUrl",308],"(",["T_VARIABLE","$this",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","getConfigData",308],"(",["T_CONSTANT_ENCAPSED_STRING","'centinel_api_url'",308],")",")",["T_WHITESPACE","\n            ",308],["T_OBJECT_OPERATOR","->",309],["T_STRING","setStore",309],"(",["T_VARIABLE","$this",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","getStore",309],"(",")",")",["T_WHITESPACE","\n            ",309],["T_OBJECT_OPERATOR","->",310],["T_STRING","setIsPlaceOrder",310],"(",["T_VARIABLE","$this",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","_isPlaceOrder",310],"(",")",")",";",["T_WHITESPACE","\n        ",310],["T_RETURN","return",311],["T_WHITESPACE"," ",311],["T_VARIABLE","$validator",311],";",["T_WHITESPACE","\n    ",311],"}",["T_WHITESPACE","\n\n    ",312],["T_DOC_COMMENT","\/**\n     * Return data for Centinel validation\n     *\n     * @return Varien_Object\n     *\/",314],["T_WHITESPACE","\n    ",318],["T_PUBLIC","public",319],["T_WHITESPACE"," ",319],["T_FUNCTION","function",319],["T_WHITESPACE"," ",319],["T_STRING","getCentinelValidationData",319],"(",")",["T_WHITESPACE","\n    ",319],"{",["T_WHITESPACE","\n        ",320],["T_VARIABLE","$info",321],["T_WHITESPACE"," ",321],"=",["T_WHITESPACE"," ",321],["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","getInfoInstance",321],"(",")",";",["T_WHITESPACE","\n        ",321],["T_VARIABLE","$params",322],["T_WHITESPACE"," ",322],"=",["T_WHITESPACE"," ",322],["T_NEW","new",322],["T_WHITESPACE"," ",322],["T_STRING","Varien_Object",322],"(",")",";",["T_WHITESPACE","\n        ",322],["T_VARIABLE","$params",323],["T_WHITESPACE","\n            ",323],["T_OBJECT_OPERATOR","->",324],["T_STRING","setPaymentMethodCode",324],"(",["T_VARIABLE","$this",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","getCode",324],"(",")",")",["T_WHITESPACE","\n            ",324],["T_OBJECT_OPERATOR","->",325],["T_STRING","setCardType",325],"(",["T_VARIABLE","$info",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","getCcType",325],"(",")",")",["T_WHITESPACE","\n            ",325],["T_OBJECT_OPERATOR","->",326],["T_STRING","setCardNumber",326],"(",["T_VARIABLE","$info",326],["T_OBJECT_OPERATOR","->",326],["T_STRING","getCcNumber",326],"(",")",")",["T_WHITESPACE","\n            ",326],["T_OBJECT_OPERATOR","->",327],["T_STRING","setCardExpMonth",327],"(",["T_VARIABLE","$info",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","getCcExpMonth",327],"(",")",")",["T_WHITESPACE","\n            ",327],["T_OBJECT_OPERATOR","->",328],["T_STRING","setCardExpYear",328],"(",["T_VARIABLE","$info",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","getCcExpYear",328],"(",")",")",["T_WHITESPACE","\n            ",328],["T_OBJECT_OPERATOR","->",329],["T_STRING","setAmount",329],"(",["T_VARIABLE","$this",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","_getAmount",329],"(",")",")",["T_WHITESPACE","\n            ",329],["T_OBJECT_OPERATOR","->",330],["T_STRING","setCurrencyCode",330],"(",["T_VARIABLE","$this",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","_getCurrencyCode",330],"(",")",")",["T_WHITESPACE","\n            ",330],["T_OBJECT_OPERATOR","->",331],["T_STRING","setOrderNumber",331],"(",["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","_getOrderId",331],"(",")",")",";",["T_WHITESPACE","\n        ",331],["T_RETURN","return",332],["T_WHITESPACE"," ",332],["T_VARIABLE","$params",332],";",["T_WHITESPACE","\n    ",332],"}",["T_WHITESPACE","\n\n    ",333],["T_DOC_COMMENT","\/**\n     * Order increment ID getter (either real from order or a reserved from quote)\n     *\n     * @return string\n     *\/",335],["T_WHITESPACE","\n    ",339],["T_PRIVATE","private",340],["T_WHITESPACE"," ",340],["T_FUNCTION","function",340],["T_WHITESPACE"," ",340],["T_STRING","_getOrderId",340],"(",")",["T_WHITESPACE","\n    ",340],"{",["T_WHITESPACE","\n        ",341],["T_VARIABLE","$info",342],["T_WHITESPACE"," ",342],"=",["T_WHITESPACE"," ",342],["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","getInfoInstance",342],"(",")",";",["T_WHITESPACE","\n\n        ",342],["T_IF","if",344],["T_WHITESPACE"," ",344],"(",["T_VARIABLE","$this",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","_isPlaceOrder",344],"(",")",")",["T_WHITESPACE"," ",344],"{",["T_WHITESPACE","\n            ",344],["T_RETURN","return",345],["T_WHITESPACE"," ",345],["T_VARIABLE","$info",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","getOrder",345],"(",")",["T_OBJECT_OPERATOR","->",345],["T_STRING","getIncrementId",345],"(",")",";",["T_WHITESPACE","\n        ",345],"}",["T_WHITESPACE"," ",346],["T_ELSE","else",346],["T_WHITESPACE"," ",346],"{",["T_WHITESPACE","\n            ",346],["T_IF","if",347],["T_WHITESPACE"," ",347],"(","!",["T_VARIABLE","$info",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","getQuote",347],"(",")",["T_OBJECT_OPERATOR","->",347],["T_STRING","getReservedOrderId",347],"(",")",")",["T_WHITESPACE"," ",347],"{",["T_WHITESPACE","\n                ",347],["T_VARIABLE","$info",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","getQuote",348],"(",")",["T_OBJECT_OPERATOR","->",348],["T_STRING","reserveOrderId",348],"(",")",";",["T_WHITESPACE","\n            ",348],"}",["T_WHITESPACE","\n            ",349],["T_RETURN","return",350],["T_WHITESPACE"," ",350],["T_VARIABLE","$info",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","getQuote",350],"(",")",["T_OBJECT_OPERATOR","->",350],["T_STRING","getReservedOrderId",350],"(",")",";",["T_WHITESPACE","\n        ",350],"}",["T_WHITESPACE","\n    ",351],"}",["T_WHITESPACE","\n\n    ",352],["T_DOC_COMMENT","\/**\n     * Grand total getter\n     *\n     * @return string\n     *\/",354],["T_WHITESPACE","\n    ",358],["T_PRIVATE","private",359],["T_WHITESPACE"," ",359],["T_FUNCTION","function",359],["T_WHITESPACE"," ",359],["T_STRING","_getAmount",359],"(",")",["T_WHITESPACE","\n    ",359],"{",["T_WHITESPACE","\n        ",360],["T_VARIABLE","$info",361],["T_WHITESPACE"," ",361],"=",["T_WHITESPACE"," ",361],["T_VARIABLE","$this",361],["T_OBJECT_OPERATOR","->",361],["T_STRING","getInfoInstance",361],"(",")",";",["T_WHITESPACE","\n        ",361],["T_IF","if",362],["T_WHITESPACE"," ",362],"(",["T_VARIABLE","$this",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","_isPlaceOrder",362],"(",")",")",["T_WHITESPACE"," ",362],"{",["T_WHITESPACE","\n            ",362],["T_RETURN","return",363],["T_WHITESPACE"," ",363],["T_DOUBLE_CAST","(double)",363],["T_VARIABLE","$info",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","getOrder",363],"(",")",["T_OBJECT_OPERATOR","->",363],["T_STRING","getQuoteBaseGrandTotal",363],"(",")",";",["T_WHITESPACE","\n        ",363],"}",["T_WHITESPACE"," ",364],["T_ELSE","else",364],["T_WHITESPACE"," ",364],"{",["T_WHITESPACE","\n            ",364],["T_RETURN","return",365],["T_WHITESPACE"," ",365],["T_DOUBLE_CAST","(double)",365],["T_VARIABLE","$info",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","getQuote",365],"(",")",["T_OBJECT_OPERATOR","->",365],["T_STRING","getBaseGrandTotal",365],"(",")",";",["T_WHITESPACE","\n        ",365],"}",["T_WHITESPACE","\n    ",366],"}",["T_WHITESPACE","\n\n    ",367],["T_DOC_COMMENT","\/**\n     * Currency code getter\n     *\n     * @return string\n     *\/",369],["T_WHITESPACE","\n    ",373],["T_PRIVATE","private",374],["T_WHITESPACE"," ",374],["T_FUNCTION","function",374],["T_WHITESPACE"," ",374],["T_STRING","_getCurrencyCode",374],"(",")",["T_WHITESPACE","\n    ",374],"{",["T_WHITESPACE","\n        ",375],["T_VARIABLE","$info",376],["T_WHITESPACE"," ",376],"=",["T_WHITESPACE"," ",376],["T_VARIABLE","$this",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","getInfoInstance",376],"(",")",";",["T_WHITESPACE","\n\n        ",376],["T_IF","if",378],["T_WHITESPACE"," ",378],"(",["T_VARIABLE","$this",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","_isPlaceOrder",378],"(",")",")",["T_WHITESPACE"," ",378],"{",["T_WHITESPACE","\n        ",378],["T_RETURN","return",379],["T_WHITESPACE"," ",379],["T_VARIABLE","$info",379],["T_OBJECT_OPERATOR","->",379],["T_STRING","getOrder",379],"(",")",["T_OBJECT_OPERATOR","->",379],["T_STRING","getBaseCurrencyCode",379],"(",")",";",["T_WHITESPACE","\n        ",379],"}",["T_WHITESPACE"," ",380],["T_ELSE","else",380],["T_WHITESPACE"," ",380],"{",["T_WHITESPACE","\n        ",380],["T_RETURN","return",381],["T_WHITESPACE"," ",381],["T_VARIABLE","$info",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","getQuote",381],"(",")",["T_OBJECT_OPERATOR","->",381],["T_STRING","getBaseCurrencyCode",381],"(",")",";",["T_WHITESPACE","\n        ",381],"}",["T_WHITESPACE","\n    ",382],"}",["T_WHITESPACE","\n\n    ",383],["T_DOC_COMMENT","\/**\n     * Whether current operation is order placement\n     *\n     * @return bool\n     *\/",385],["T_WHITESPACE","\n    ",389],["T_PRIVATE","private",390],["T_WHITESPACE"," ",390],["T_FUNCTION","function",390],["T_WHITESPACE"," ",390],["T_STRING","_isPlaceOrder",390],"(",")",["T_WHITESPACE","\n    ",390],"{",["T_WHITESPACE","\n        ",391],["T_VARIABLE","$info",392],["T_WHITESPACE"," ",392],"=",["T_WHITESPACE"," ",392],["T_VARIABLE","$this",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","getInfoInstance",392],"(",")",";",["T_WHITESPACE","\n        ",392],["T_IF","if",393],["T_WHITESPACE"," ",393],"(",["T_VARIABLE","$info",393],["T_WHITESPACE"," ",393],["T_INSTANCEOF","instanceof",393],["T_WHITESPACE"," ",393],["T_STRING","Mage_Sales_Model_Quote_Payment",393],")",["T_WHITESPACE"," ",393],"{",["T_WHITESPACE","\n            ",393],["T_RETURN","return",394],["T_WHITESPACE"," ",394],["T_STRING","false",394],";",["T_WHITESPACE","\n        ",394],"}",["T_WHITESPACE"," ",395],["T_ELSEIF","elseif",395],["T_WHITESPACE"," ",395],"(",["T_VARIABLE","$info",395],["T_WHITESPACE"," ",395],["T_INSTANCEOF","instanceof",395],["T_WHITESPACE"," ",395],["T_STRING","Mage_Sales_Model_Order_Payment",395],")",["T_WHITESPACE"," ",395],"{",["T_WHITESPACE","\n            ",395],["T_RETURN","return",396],["T_WHITESPACE"," ",396],["T_STRING","true",396],";",["T_WHITESPACE","\n        ",396],"}",["T_WHITESPACE","\n    ",397],"}",["T_WHITESPACE","\n",398],"}",["T_WHITESPACE","\n",399]]