[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Centinel\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * 3D Secure Validation Model\n *\/",27],["T_WHITESPACE","\n",29],["T_CLASS","class",30],["T_WHITESPACE"," ",30],["T_STRING","Mage_Centinel_Model_Service",30],["T_WHITESPACE"," ",30],["T_EXTENDS","extends",30],["T_WHITESPACE"," ",30],["T_STRING","Varien_Object",30],["T_WHITESPACE","\n",30],"{",["T_WHITESPACE","\n    ",31],["T_DOC_COMMENT","\/**\n     * Cmpi public keys\n     *\/",32],["T_WHITESPACE","\n    ",34],["T_CONST","const",35],["T_WHITESPACE"," ",35],["T_STRING","CMPI_PARES",35],["T_WHITESPACE","    ",35],"=",["T_WHITESPACE"," ",35],["T_CONSTANT_ENCAPSED_STRING","'centinel_authstatus'",35],";",["T_WHITESPACE","\n    ",35],["T_CONST","const",36],["T_WHITESPACE"," ",36],["T_STRING","CMPI_ENROLLED",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'centinel_mpivendor'",36],";",["T_WHITESPACE","\n    ",36],["T_CONST","const",37],["T_WHITESPACE"," ",37],["T_STRING","CMPI_CAVV",37],["T_WHITESPACE","     ",37],"=",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'centinel_cavv'",37],";",["T_WHITESPACE","\n    ",37],["T_CONST","const",38],["T_WHITESPACE"," ",38],["T_STRING","CMPI_ECI",38],["T_WHITESPACE","      ",38],"=",["T_WHITESPACE"," ",38],["T_CONSTANT_ENCAPSED_STRING","'centinel_eci'",38],";",["T_WHITESPACE","\n    ",38],["T_CONST","const",39],["T_WHITESPACE"," ",39],["T_STRING","CMPI_XID",39],["T_WHITESPACE","      ",39],"=",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'centinel_xid'",39],";",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * State cmpi results to public map\n     *\n     * @var array\n     *\/",41],["T_WHITESPACE","\n    ",45],["T_PROTECTED","protected",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$_cmpiMap",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_ARRAY","array",46],"(",["T_WHITESPACE","\n        ",46],["T_CONSTANT_ENCAPSED_STRING","'lookup_enrolled'",47],["T_WHITESPACE","      ",47],["T_DOUBLE_ARROW","=>",47],["T_WHITESPACE"," ",47],["T_STRING","self",47],["T_DOUBLE_COLON","::",47],["T_STRING","CMPI_ENROLLED",47],",",["T_WHITESPACE","\n        ",47],["T_CONSTANT_ENCAPSED_STRING","'lookup_eci_flag'",48],["T_WHITESPACE","      ",48],["T_DOUBLE_ARROW","=>",48],["T_WHITESPACE"," ",48],["T_STRING","self",48],["T_DOUBLE_COLON","::",48],["T_STRING","CMPI_ECI",48],",",["T_WHITESPACE","\n        ",48],["T_CONSTANT_ENCAPSED_STRING","'authenticate_pa_res_status'",49],["T_WHITESPACE"," ",49],["T_DOUBLE_ARROW","=>",49],["T_WHITESPACE"," ",49],["T_STRING","self",49],["T_DOUBLE_COLON","::",49],["T_STRING","CMPI_PARES",49],",",["T_WHITESPACE","\n        ",49],["T_CONSTANT_ENCAPSED_STRING","'authenticate_cavv'",50],["T_WHITESPACE","          ",50],["T_DOUBLE_ARROW","=>",50],["T_WHITESPACE"," ",50],["T_STRING","self",50],["T_DOUBLE_COLON","::",50],["T_STRING","CMPI_CAVV",50],",",["T_WHITESPACE","\n        ",50],["T_CONSTANT_ENCAPSED_STRING","'authenticate_eci_flag'",51],["T_WHITESPACE","      ",51],["T_DOUBLE_ARROW","=>",51],["T_WHITESPACE"," ",51],["T_STRING","self",51],["T_DOUBLE_COLON","::",51],["T_STRING","CMPI_ECI",51],",",["T_WHITESPACE","\n        ",51],["T_CONSTANT_ENCAPSED_STRING","'authenticate_xid'",52],["T_WHITESPACE","           ",52],["T_DOUBLE_ARROW","=>",52],["T_WHITESPACE"," ",52],["T_STRING","self",52],["T_DOUBLE_COLON","::",52],["T_STRING","CMPI_XID",52],",",["T_WHITESPACE","\n    ",52],")",";",["T_WHITESPACE","\n\n    ",53],["T_DOC_COMMENT","\/**\n     * Validation api model\n     *\n     * @var Mage_Centinel_Model_Api\n     *\/",55],["T_WHITESPACE","\n    ",59],["T_PROTECTED","protected",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$_api",60],";",["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * Validation state model\n     *\n     * @var Mage_Centinel_Model_StateAbstract\n     *\/",62],["T_WHITESPACE","\n    ",66],["T_PROTECTED","protected",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$_validationState",67],";",["T_WHITESPACE","\n\n    ",67],["T_DOC_COMMENT","\/**\n     * Return validation session object\n     *\n     * @return Mage_Centinel_Model_Session\n     *\/",69],["T_WHITESPACE","\n    ",73],["T_PROTECTED","protected",74],["T_WHITESPACE"," ",74],["T_FUNCTION","function",74],["T_WHITESPACE"," ",74],["T_STRING","_getSession",74],"(",")",["T_WHITESPACE","\n    ",74],"{",["T_WHITESPACE","\n        ",75],["T_RETURN","return",76],["T_WHITESPACE"," ",76],["T_STRING","Mage",76],["T_DOUBLE_COLON","::",76],["T_STRING","getSingleton",76],"(",["T_CONSTANT_ENCAPSED_STRING","'centinel\/session'",76],")",";",["T_WHITESPACE","\n    ",76],"}",["T_WHITESPACE","\n\n    ",77],["T_DOC_COMMENT","\/**\n     * Return value from section of centinel config\n     *\n     * @param string $path\n     * @return string\n     *\/",79],["T_WHITESPACE","\n    ",84],["T_PROTECTED","protected",85],["T_WHITESPACE"," ",85],["T_FUNCTION","function",85],["T_WHITESPACE"," ",85],["T_STRING","_getConfig",85],"(",")",["T_WHITESPACE","\n    ",85],"{",["T_WHITESPACE","\n        ",86],["T_VARIABLE","$config",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_STRING","Mage",87],["T_DOUBLE_COLON","::",87],["T_STRING","getSingleton",87],"(",["T_CONSTANT_ENCAPSED_STRING","'centinel\/config'",87],")",";",["T_WHITESPACE","\n        ",87],["T_RETURN","return",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$config",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","setStore",88],"(",["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","getStore",88],"(",")",")",";",["T_WHITESPACE","\n    ",88],"}",["T_WHITESPACE","\n\n    ",89],["T_DOC_COMMENT","\/**\n     * Generate checksum from all passed parameters\n     *\n     * @param string $cardType\n     * @param string $cardNumber\n     * @param string $cardExpMonth\n     * @param string $cardExpYear\n     * @param double $amount\n     * @param string $currencyCode\n     * @return string\n     *\/",91],["T_WHITESPACE","\n    ",101],["T_PROTECTED","protected",102],["T_WHITESPACE"," ",102],["T_FUNCTION","function",102],["T_WHITESPACE"," ",102],["T_STRING","_generateChecksum",102],"(",["T_VARIABLE","$paymentMethodCode",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$cardType",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$cardNumber",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$cardExpMonth",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$cardExpYear",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$amount",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$currencyCode",102],")",["T_WHITESPACE","\n    ",102],"{",["T_WHITESPACE","\n        ",103],["T_RETURN","return",104],["T_WHITESPACE"," ",104],["T_STRING","md5",104],"(",["T_STRING","implode",104],"(",["T_STRING","func_get_args",104],"(",")",",",["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'_'",104],")",")",";",["T_WHITESPACE","\n    ",104],"}",["T_WHITESPACE","\n\n    ",105],["T_DOC_COMMENT","\/**\n     * Unified validation\/authentication URL getter\n     *\n     * @param string $suffix\n     * @param bool $current\n     * @return string\n     *\/",107],["T_WHITESPACE","\n    ",113],["T_PRIVATE","private",114],["T_WHITESPACE"," ",114],["T_FUNCTION","function",114],["T_WHITESPACE"," ",114],["T_STRING","_getUrl",114],"(",["T_VARIABLE","$suffix",114],",",["T_WHITESPACE"," ",114],["T_VARIABLE","$current",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_STRING","false",114],")",["T_WHITESPACE","\n    ",114],"{",["T_WHITESPACE","\n        ",115],["T_VARIABLE","$params",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_ARRAY","array",116],"(",["T_WHITESPACE","\n            ",116],["T_CONSTANT_ENCAPSED_STRING","'_secure'",117],["T_WHITESPACE","  ",117],["T_DOUBLE_ARROW","=>",117],["T_WHITESPACE"," ",117],["T_STRING","true",117],",",["T_WHITESPACE","\n            ",117],["T_CONSTANT_ENCAPSED_STRING","'_current'",118],["T_WHITESPACE"," ",118],["T_DOUBLE_ARROW","=>",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$current",118],",",["T_WHITESPACE","\n            ",118],["T_CONSTANT_ENCAPSED_STRING","'form_key'",119],["T_WHITESPACE"," ",119],["T_DOUBLE_ARROW","=>",119],["T_WHITESPACE"," ",119],["T_STRING","Mage",119],["T_DOUBLE_COLON","::",119],["T_STRING","getSingleton",119],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/session'",119],")",["T_OBJECT_OPERATOR","->",119],["T_STRING","getFormKey",119],"(",")",",",["T_WHITESPACE","\n            ",119],["T_CONSTANT_ENCAPSED_STRING","'isIframe'",120],["T_WHITESPACE"," ",120],["T_DOUBLE_ARROW","=>",120],["T_WHITESPACE"," ",120],["T_STRING","true",120],["T_WHITESPACE","\n        ",120],")",";",["T_WHITESPACE","\n        ",121],["T_IF","if",122],["T_WHITESPACE"," ",122],"(",["T_STRING","Mage",122],["T_DOUBLE_COLON","::",122],["T_STRING","app",122],"(",")",["T_OBJECT_OPERATOR","->",122],["T_STRING","getStore",122],"(",")",["T_OBJECT_OPERATOR","->",122],["T_STRING","isAdmin",122],"(",")",")",["T_WHITESPACE"," ",122],"{",["T_WHITESPACE","\n            ",122],["T_RETURN","return",123],["T_WHITESPACE"," ",123],["T_STRING","Mage",123],["T_DOUBLE_COLON","::",123],["T_STRING","getSingleton",123],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/url'",123],")",["T_OBJECT_OPERATOR","->",123],["T_STRING","getUrl",123],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/centinel_index\/'",123],["T_WHITESPACE"," ",123],".",["T_WHITESPACE"," ",123],["T_VARIABLE","$suffix",123],",",["T_WHITESPACE"," ",123],["T_VARIABLE","$params",123],")",";",["T_WHITESPACE","\n        ",123],"}",["T_WHITESPACE"," ",124],["T_ELSE","else",124],["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n            ",124],["T_RETURN","return",125],["T_WHITESPACE"," ",125],["T_STRING","Mage",125],["T_DOUBLE_COLON","::",125],["T_STRING","getUrl",125],"(",["T_CONSTANT_ENCAPSED_STRING","'centinel\/index\/'",125],["T_WHITESPACE"," ",125],".",["T_WHITESPACE"," ",125],["T_VARIABLE","$suffix",125],",",["T_WHITESPACE"," ",125],["T_VARIABLE","$params",125],")",";",["T_WHITESPACE","\n        ",125],"}",["T_WHITESPACE","\n    ",126],"}",["T_WHITESPACE","\n\n    ",127],["T_DOC_COMMENT","\/**\n     * Return validation api model\n     *\n     * @return Mage_Centinel_Model_Api\n     *\/",129],["T_WHITESPACE","\n    ",133],["T_PROTECTED","protected",134],["T_WHITESPACE"," ",134],["T_FUNCTION","function",134],["T_WHITESPACE"," ",134],["T_STRING","_getApi",134],"(",")",["T_WHITESPACE","\n    ",134],"{",["T_WHITESPACE","\n        ",135],["T_IF","if",136],["T_WHITESPACE"," ",136],"(","!",["T_STRING","is_null",136],"(",["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","_api",136],")",")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n            ",136],["T_RETURN","return",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","_api",137],";",["T_WHITESPACE","\n        ",137],"}",["T_WHITESPACE","\n\n        ",138],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","_api",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_STRING","Mage",140],["T_DOUBLE_COLON","::",140],["T_STRING","getSingleton",140],"(",["T_CONSTANT_ENCAPSED_STRING","'centinel\/api'",140],")",";",["T_WHITESPACE","\n        ",140],["T_VARIABLE","$config",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","_getConfig",141],"(",")",";",["T_WHITESPACE","\n        ",141],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","_api",142],["T_WHITESPACE","\n           ",142],["T_OBJECT_OPERATOR","->",143],["T_STRING","setProcessorId",143],"(",["T_VARIABLE","$config",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getProcessorId",143],"(",")",")",["T_WHITESPACE","\n           ",143],["T_OBJECT_OPERATOR","->",144],["T_STRING","setMerchantId",144],"(",["T_VARIABLE","$config",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","getMerchantId",144],"(",")",")",["T_WHITESPACE","\n           ",144],["T_OBJECT_OPERATOR","->",145],["T_STRING","setTransactionPwd",145],"(",["T_VARIABLE","$config",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getTransactionPwd",145],"(",")",")",["T_WHITESPACE","\n           ",145],["T_OBJECT_OPERATOR","->",146],["T_STRING","setIsTestMode",146],"(",["T_VARIABLE","$config",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","getIsTestMode",146],"(",")",")",["T_WHITESPACE","\n           ",146],["T_OBJECT_OPERATOR","->",147],["T_STRING","setDebugFlag",147],"(",["T_VARIABLE","$config",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","getDebugFlag",147],"(",")",")",["T_WHITESPACE","\n           ",147],["T_OBJECT_OPERATOR","->",148],["T_STRING","setApiEndpointUrl",148],"(",["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","getCustomApiEndpointUrl",148],"(",")",")",";",["T_WHITESPACE","\n        ",148],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","_api",149],";",["T_WHITESPACE","\n    ",149],"}",["T_WHITESPACE","\n\n    ",150],["T_DOC_COMMENT","\/**\n     * Create and return validation state model for card type\n     *\n     * @param string $cardType\n     * @return Mage_Centinel_Model_StateAbstract\n     *\/",152],["T_WHITESPACE","\n    ",157],["T_PROTECTED","protected",158],["T_WHITESPACE"," ",158],["T_FUNCTION","function",158],["T_WHITESPACE"," ",158],["T_STRING","_getValidationStateModel",158],"(",["T_VARIABLE","$cardType",158],")",["T_WHITESPACE","\n    ",158],"{",["T_WHITESPACE","\n        ",159],["T_IF","if",160],["T_WHITESPACE"," ",160],"(",["T_VARIABLE","$modelClass",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","_getConfig",160],"(",")",["T_OBJECT_OPERATOR","->",160],["T_STRING","getStateModelClass",160],"(",["T_VARIABLE","$cardType",160],")",")",["T_WHITESPACE"," ",160],"{",["T_WHITESPACE","\n            ",160],["T_RETURN","return",161],["T_WHITESPACE"," ",161],["T_STRING","Mage",161],["T_DOUBLE_COLON","::",161],["T_STRING","getModel",161],"(",["T_VARIABLE","$modelClass",161],")",";",["T_WHITESPACE","\n        ",161],"}",["T_WHITESPACE","\n        ",162],["T_RETURN","return",163],["T_WHITESPACE"," ",163],["T_STRING","false",163],";",["T_WHITESPACE","\n    ",163],"}",["T_WHITESPACE","\n\n    ",164],["T_DOC_COMMENT","\/**\n     * Return validation state model\n     *\n     * @param string $cardType\n     * @return Mage_Centinel_Model_StateAbstract\n     *\/",166],["T_WHITESPACE","\n    ",171],["T_PROTECTED","protected",172],["T_WHITESPACE"," ",172],["T_FUNCTION","function",172],["T_WHITESPACE"," ",172],["T_STRING","_getValidationState",172],"(",["T_VARIABLE","$cardType",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_STRING","null",172],")",["T_WHITESPACE","\n    ",172],"{",["T_WHITESPACE","\n        ",173],["T_VARIABLE","$type",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_VARIABLE","$cardType",174],["T_WHITESPACE"," ",174],"?",["T_WHITESPACE"," ",174],["T_VARIABLE","$cardType",174],["T_WHITESPACE"," ",174],":",["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","_getSession",174],"(",")",["T_OBJECT_OPERATOR","->",174],["T_STRING","getData",174],"(",["T_CONSTANT_ENCAPSED_STRING","'card_type'",174],")",";",["T_WHITESPACE","\n        ",174],["T_IF","if",175],["T_WHITESPACE"," ",175],"(","!",["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","_validationState",175],["T_WHITESPACE"," ",175],["T_BOOLEAN_AND","&&",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$type",175],")",["T_WHITESPACE"," ",175],"{",["T_WHITESPACE","\n            ",175],["T_VARIABLE","$model",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","_getValidationStateModel",176],"(",["T_VARIABLE","$type",176],")",";",["T_WHITESPACE","\n            ",176],["T_IF","if",177],["T_WHITESPACE"," ",177],"(","!",["T_VARIABLE","$model",177],")",["T_WHITESPACE"," ",177],"{",["T_WHITESPACE","\n                ",177],["T_RETURN","return",178],["T_WHITESPACE"," ",178],["T_STRING","false",178],";",["T_WHITESPACE","\n            ",178],"}",["T_WHITESPACE","\n            ",179],["T_VARIABLE","$model",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","setDataStorage",180],"(",["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","_getSession",180],"(",")",")",";",["T_WHITESPACE","\n            ",180],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","_validationState",181],["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_VARIABLE","$model",181],";",["T_WHITESPACE","\n        ",181],"}",["T_WHITESPACE","\n        ",182],["T_RETURN","return",183],["T_WHITESPACE"," ",183],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","_validationState",183],";",["T_WHITESPACE","\n    ",183],"}",["T_WHITESPACE","\n\n    ",184],["T_DOC_COMMENT","\/**\n     * Drop validation state model\n     *\n     *\/",186],["T_WHITESPACE","\n    ",189],["T_PROTECTED","protected",190],["T_WHITESPACE"," ",190],["T_FUNCTION","function",190],["T_WHITESPACE"," ",190],["T_STRING","_resetValidationState",190],"(",")",["T_WHITESPACE","\n    ",190],"{",["T_WHITESPACE","\n        ",191],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","_getSession",192],"(",")",["T_OBJECT_OPERATOR","->",192],["T_STRING","setData",192],"(",["T_ARRAY","array",192],"(",")",")",";",["T_WHITESPACE","\n        ",192],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","_validationState",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_STRING","false",193],";",["T_WHITESPACE","\n    ",193],"}",["T_WHITESPACE","\n\n    ",194],["T_DOC_COMMENT","\/**\n     * Drop old and init new validation state model\n     *\n     * @param string $cardType\n     * @param string $dataChecksum\n     * @return Mage_Centinel_Model_StateAbstract\n     *\/",196],["T_WHITESPACE","\n    ",202],["T_PROTECTED","protected",203],["T_WHITESPACE"," ",203],["T_FUNCTION","function",203],["T_WHITESPACE"," ",203],["T_STRING","_initValidationState",203],"(",["T_VARIABLE","$cardType",203],",",["T_WHITESPACE"," ",203],["T_VARIABLE","$dataChecksum",203],")",["T_WHITESPACE","\n    ",203],"{",["T_WHITESPACE","\n        ",204],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","_resetValidationState",205],"(",")",";",["T_WHITESPACE","\n        ",205],["T_VARIABLE","$state",206],["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","_getValidationStateModel",206],"(",["T_VARIABLE","$cardType",206],")",";",["T_WHITESPACE","\n        ",206],["T_VARIABLE","$state",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","setDataStorage",207],"(",["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","_getSession",207],"(",")",")",["T_WHITESPACE","\n            ",207],["T_OBJECT_OPERATOR","->",208],["T_STRING","setCardType",208],"(",["T_VARIABLE","$cardType",208],")",["T_WHITESPACE","\n            ",208],["T_OBJECT_OPERATOR","->",209],["T_STRING","setChecksum",209],"(",["T_VARIABLE","$dataChecksum",209],")",["T_WHITESPACE","\n            ",209],["T_OBJECT_OPERATOR","->",210],["T_STRING","setIsModeStrict",210],"(",["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","getIsModeStrict",210],"(",")",")",";",["T_WHITESPACE","\n        ",210],["T_RETURN","return",211],["T_WHITESPACE"," ",211],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","_getValidationState",211],"(",")",";",["T_WHITESPACE","\n    ",211],"}",["T_WHITESPACE","\n\n    ",212],["T_DOC_COMMENT","\/**\n     * Process lookup validation and init new validation state model\n     *\n     * @param Varien_Object $data\n     *\/",214],["T_WHITESPACE","\n    ",218],["T_PUBLIC","public",219],["T_WHITESPACE"," ",219],["T_FUNCTION","function",219],["T_WHITESPACE"," ",219],["T_STRING","lookup",219],"(",["T_VARIABLE","$data",219],")",["T_WHITESPACE","\n    ",219],"{",["T_WHITESPACE","\n        ",220],["T_VARIABLE","$newChecksum",221],["T_WHITESPACE"," ",221],"=",["T_WHITESPACE"," ",221],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","_generateChecksum",221],"(",["T_WHITESPACE","\n            ",221],["T_VARIABLE","$data",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","getPaymentMethodCode",222],"(",")",",",["T_WHITESPACE","\n            ",222],["T_VARIABLE","$data",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","getCardType",223],"(",")",",",["T_WHITESPACE","\n            ",223],["T_VARIABLE","$data",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","getCardNumber",224],"(",")",",",["T_WHITESPACE","\n            ",224],["T_VARIABLE","$data",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","getCardExpMonth",225],"(",")",",",["T_WHITESPACE","\n            ",225],["T_VARIABLE","$data",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","getCardExpYear",226],"(",")",",",["T_WHITESPACE","\n            ",226],["T_VARIABLE","$data",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","getAmount",227],"(",")",",",["T_WHITESPACE","\n            ",227],["T_VARIABLE","$data",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getCurrencyCode",228],"(",")",["T_WHITESPACE","\n        ",228],")",";",["T_WHITESPACE","\n\n        ",229],["T_VARIABLE","$validationState",231],["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","_initValidationState",231],"(",["T_VARIABLE","$data",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","getCardType",231],"(",")",",",["T_WHITESPACE"," ",231],["T_VARIABLE","$newChecksum",231],")",";",["T_WHITESPACE","\n\n        ",231],["T_VARIABLE","$api",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","_getApi",233],"(",")",";",["T_WHITESPACE","\n        ",233],["T_VARIABLE","$result",234],["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_VARIABLE","$api",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","callLookup",234],"(",["T_VARIABLE","$data",234],")",";",["T_WHITESPACE","\n        ",234],["T_VARIABLE","$validationState",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","setLookupResult",235],"(",["T_VARIABLE","$result",235],")",";",["T_WHITESPACE","\n    ",235],"}",["T_WHITESPACE","\n\n    ",236],["T_DOC_COMMENT","\/**\n     * Process authenticate validation\n     *\n     * @param Varien_Object $data\n     *\/",238],["T_WHITESPACE","\n    ",242],["T_PUBLIC","public",243],["T_WHITESPACE"," ",243],["T_FUNCTION","function",243],["T_WHITESPACE"," ",243],["T_STRING","authenticate",243],"(",["T_VARIABLE","$data",243],")",["T_WHITESPACE","\n    ",243],"{",["T_WHITESPACE","\n        ",244],["T_VARIABLE","$validationState",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","_getValidationState",245],"(",")",";",["T_WHITESPACE","\n        ",245],["T_IF","if",246],["T_WHITESPACE"," ",246],"(","!",["T_VARIABLE","$validationState",246],["T_WHITESPACE"," ",246],["T_BOOLEAN_OR","||",246],["T_WHITESPACE"," ",246],["T_VARIABLE","$data",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","getTransactionId",246],"(",")",["T_WHITESPACE"," ",246],["T_IS_NOT_EQUAL","!=",246],["T_WHITESPACE"," ",246],["T_VARIABLE","$validationState",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","getLookupTransactionId",246],"(",")",")",["T_WHITESPACE"," ",246],"{",["T_WHITESPACE","\n            ",246],["T_THROW","throw",247],["T_WHITESPACE"," ",247],["T_NEW","new",247],["T_WHITESPACE"," ",247],["T_STRING","Exception",247],"(",["T_CONSTANT_ENCAPSED_STRING","'Authentication impossible: transaction id or validation state is wrong.'",247],")",";",["T_WHITESPACE","\n        ",247],"}",["T_WHITESPACE","\n\n        ",248],["T_VARIABLE","$api",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_VARIABLE","$this",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","_getApi",250],"(",")",";",["T_WHITESPACE","\n        ",250],["T_VARIABLE","$result",251],["T_WHITESPACE"," ",251],"=",["T_WHITESPACE"," ",251],["T_VARIABLE","$api",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","callAuthentication",251],"(",["T_VARIABLE","$data",251],")",";",["T_WHITESPACE","\n        ",251],["T_VARIABLE","$validationState",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","setAuthenticateResult",252],"(",["T_VARIABLE","$result",252],")",";",["T_WHITESPACE","\n        ",252],["T_IF","if",253],["T_WHITESPACE"," ",253],"(","!",["T_VARIABLE","$validationState",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","isAuthenticateSuccessful",253],"(",")",")",["T_WHITESPACE"," ",253],"{",["T_WHITESPACE","\n            ",253],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","reset",254],"(",")",";",["T_WHITESPACE","\n        ",254],"}",["T_WHITESPACE","\n    ",255],"}",["T_WHITESPACE","\n\n    ",256],["T_DOC_COMMENT","\/**\n     * Validate payment data\n     *\n     * This check is performed on payment information submission, as well as on placing order.\n     * Workflow state is stored validation state model\n     *\n     * @param Varien_Object $data\n     * @throws Mage_Core_Exception\n     *\/",258],["T_WHITESPACE","\n    ",266],["T_PUBLIC","public",267],["T_WHITESPACE"," ",267],["T_FUNCTION","function",267],["T_WHITESPACE"," ",267],["T_STRING","validate",267],"(",["T_VARIABLE","$data",267],")",["T_WHITESPACE","\n    ",267],"{",["T_WHITESPACE","\n        ",268],["T_VARIABLE","$newChecksum",269],["T_WHITESPACE"," ",269],"=",["T_WHITESPACE"," ",269],["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","_generateChecksum",269],"(",["T_WHITESPACE","\n            ",269],["T_VARIABLE","$data",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","getPaymentMethodCode",270],"(",")",",",["T_WHITESPACE","\n            ",270],["T_VARIABLE","$data",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","getCardType",271],"(",")",",",["T_WHITESPACE","\n            ",271],["T_VARIABLE","$data",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","getCardNumber",272],"(",")",",",["T_WHITESPACE","\n            ",272],["T_VARIABLE","$data",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","getCardExpMonth",273],"(",")",",",["T_WHITESPACE","\n            ",273],["T_VARIABLE","$data",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","getCardExpYear",274],"(",")",",",["T_WHITESPACE","\n            ",274],["T_VARIABLE","$data",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","getAmount",275],"(",")",",",["T_WHITESPACE","\n            ",275],["T_VARIABLE","$data",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","getCurrencyCode",276],"(",")",["T_WHITESPACE","\n        ",276],")",";",["T_WHITESPACE","\n\n        ",277],["T_VARIABLE","$validationState",279],["T_WHITESPACE"," ",279],"=",["T_WHITESPACE"," ",279],["T_VARIABLE","$this",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","_getValidationState",279],"(",["T_VARIABLE","$data",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","getCardType",279],"(",")",")",";",["T_WHITESPACE","\n        ",279],["T_IF","if",280],["T_WHITESPACE"," ",280],"(","!",["T_VARIABLE","$validationState",280],")",["T_WHITESPACE"," ",280],"{",["T_WHITESPACE","\n            ",280],["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","_resetValidationState",281],"(",")",";",["T_WHITESPACE","\n            ",281],["T_RETURN","return",282],";",["T_WHITESPACE","\n        ",282],"}",["T_WHITESPACE","\n\n        ",283],["T_COMMENT","\/\/ check whether is authenticated before placing order\n",285],["T_WHITESPACE","        ",286],["T_IF","if",286],["T_WHITESPACE"," ",286],"(",["T_VARIABLE","$this",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","getIsPlaceOrder",286],"(",")",")",["T_WHITESPACE"," ",286],"{",["T_WHITESPACE","\n            ",286],["T_IF","if",287],["T_WHITESPACE"," ",287],"(",["T_VARIABLE","$validationState",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","getChecksum",287],"(",")",["T_WHITESPACE"," ",287],["T_IS_NOT_EQUAL","!=",287],["T_WHITESPACE"," ",287],["T_VARIABLE","$newChecksum",287],")",["T_WHITESPACE"," ",287],"{",["T_WHITESPACE","\n                ",287],["T_STRING","Mage",288],["T_DOUBLE_COLON","::",288],["T_STRING","throwException",288],"(",["T_STRING","Mage",288],["T_DOUBLE_COLON","::",288],["T_STRING","helper",288],"(",["T_CONSTANT_ENCAPSED_STRING","'centinel'",288],")",["T_OBJECT_OPERATOR","->",288],["T_STRING","__",288],"(",["T_CONSTANT_ENCAPSED_STRING","'Payment information error. Please start over.'",288],")",")",";",["T_WHITESPACE","\n            ",288],"}",["T_WHITESPACE","\n            ",289],["T_IF","if",290],["T_WHITESPACE"," ",290],"(",["T_VARIABLE","$validationState",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","isAuthenticateSuccessful",290],"(",")",")",["T_WHITESPACE"," ",290],"{",["T_WHITESPACE","\n                ",290],["T_RETURN","return",291],";",["T_WHITESPACE","\n            ",291],"}",["T_WHITESPACE","\n            ",292],["T_STRING","Mage",293],["T_DOUBLE_COLON","::",293],["T_STRING","throwException",293],"(",["T_STRING","Mage",293],["T_DOUBLE_COLON","::",293],["T_STRING","helper",293],"(",["T_CONSTANT_ENCAPSED_STRING","'centinel'",293],")",["T_OBJECT_OPERATOR","->",293],["T_STRING","__",293],"(",["T_CONSTANT_ENCAPSED_STRING","'Please verify the card with the issuer bank before placing the order.'",293],")",")",";",["T_WHITESPACE","\n        ",293],"}",["T_WHITESPACE"," ",294],["T_ELSE","else",294],["T_WHITESPACE"," ",294],"{",["T_WHITESPACE","\n            ",294],["T_IF","if",295],["T_WHITESPACE"," ",295],"(",["T_VARIABLE","$validationState",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","getChecksum",295],"(",")",["T_WHITESPACE"," ",295],["T_IS_NOT_EQUAL","!=",295],["T_WHITESPACE"," ",295],["T_VARIABLE","$newChecksum",295],["T_WHITESPACE"," ",295],["T_BOOLEAN_OR","||",295],["T_WHITESPACE"," ",295],"!",["T_VARIABLE","$validationState",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","isLookupSuccessful",295],"(",")",")",["T_WHITESPACE"," ",295],"{",["T_WHITESPACE","\n                ",295],["T_VARIABLE","$this",296],["T_OBJECT_OPERATOR","->",296],["T_STRING","lookup",296],"(",["T_VARIABLE","$data",296],")",";",["T_WHITESPACE","\n                ",296],["T_VARIABLE","$validationState",297],["T_WHITESPACE"," ",297],"=",["T_WHITESPACE"," ",297],["T_VARIABLE","$this",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","_getValidationState",297],"(",")",";",["T_WHITESPACE","\n            ",297],"}",["T_WHITESPACE","\n            ",298],["T_IF","if",299],["T_WHITESPACE"," ",299],"(",["T_VARIABLE","$validationState",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","isLookupSuccessful",299],"(",")",")",["T_WHITESPACE"," ",299],"{",["T_WHITESPACE","\n                ",299],["T_RETURN","return",300],";",["T_WHITESPACE","\n            ",300],"}",["T_WHITESPACE","\n            ",301],["T_STRING","Mage",302],["T_DOUBLE_COLON","::",302],["T_STRING","throwException",302],"(",["T_STRING","Mage",302],["T_DOUBLE_COLON","::",302],["T_STRING","helper",302],"(",["T_CONSTANT_ENCAPSED_STRING","'centinel'",302],")",["T_OBJECT_OPERATOR","->",302],["T_STRING","__",302],"(",["T_CONSTANT_ENCAPSED_STRING","'This card has failed validation and cannot be used.'",302],")",")",";",["T_WHITESPACE","\n        ",302],"}",["T_WHITESPACE","\n    ",303],"}",["T_WHITESPACE","\n\n    ",304],["T_DOC_COMMENT","\/**\n     * Reset validation state and drop api object\n     *\n     * @return Mage_Centinel_Model_Service\n     *\/",306],["T_WHITESPACE","\n    ",310],["T_PUBLIC","public",311],["T_WHITESPACE"," ",311],["T_FUNCTION","function",311],["T_WHITESPACE"," ",311],["T_STRING","reset",311],"(",")",["T_WHITESPACE","\n    ",311],"{",["T_WHITESPACE","\n        ",312],["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","_resetValidationState",313],"(",")",";",["T_WHITESPACE","\n        ",313],["T_VARIABLE","$this",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","_api",314],["T_WHITESPACE"," ",314],"=",["T_WHITESPACE"," ",314],["T_STRING","null",314],";",["T_WHITESPACE","\n        ",314],["T_RETURN","return",315],["T_WHITESPACE"," ",315],["T_VARIABLE","$this",315],";",["T_WHITESPACE","\n    ",315],"}",["T_WHITESPACE","\n\n    ",316],["T_DOC_COMMENT","\/**\n     * Return URL for authentication\n     *\n     * @return string\n     *\/",318],["T_WHITESPACE","\n    ",322],["T_PUBLIC","public",323],["T_WHITESPACE"," ",323],["T_FUNCTION","function",323],["T_WHITESPACE"," ",323],["T_STRING","getAuthenticationStartUrl",323],"(",")",["T_WHITESPACE","\n    ",323],"{",["T_WHITESPACE","\n        ",324],["T_RETURN","return",325],["T_WHITESPACE"," ",325],["T_VARIABLE","$this",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","_getUrl",325],"(",["T_CONSTANT_ENCAPSED_STRING","'authenticationstart'",325],")",";",["T_WHITESPACE","\n    ",325],"}",["T_WHITESPACE","\n\n    ",326],["T_DOC_COMMENT","\/**\n     * Return URL for validation\n     *\n     * @return string\n     *\/",328],["T_WHITESPACE","\n    ",332],["T_PUBLIC","public",333],["T_WHITESPACE"," ",333],["T_FUNCTION","function",333],["T_WHITESPACE"," ",333],["T_STRING","getValidatePaymentDataUrl",333],"(",")",["T_WHITESPACE","\n    ",333],"{",["T_WHITESPACE","\n        ",334],["T_RETURN","return",335],["T_WHITESPACE"," ",335],["T_VARIABLE","$this",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","_getUrl",335],"(",["T_CONSTANT_ENCAPSED_STRING","'validatepaymentdata'",335],")",";",["T_WHITESPACE","\n    ",335],"}",["T_WHITESPACE","\n\n    ",336],["T_DOC_COMMENT","\/**\n     * If authenticate is should return true\n     *\n     * @return bool\n     *\/",338],["T_WHITESPACE","\n    ",342],["T_PUBLIC","public",343],["T_WHITESPACE"," ",343],["T_FUNCTION","function",343],["T_WHITESPACE"," ",343],["T_STRING","shouldAuthenticate",343],"(",")",["T_WHITESPACE","\n    ",343],"{",["T_WHITESPACE","\n        ",344],["T_VARIABLE","$validationState",345],["T_WHITESPACE"," ",345],"=",["T_WHITESPACE"," ",345],["T_VARIABLE","$this",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","_getValidationState",345],"(",")",";",["T_WHITESPACE","\n        ",345],["T_RETURN","return",346],["T_WHITESPACE"," ",346],["T_VARIABLE","$validationState",346],["T_WHITESPACE"," ",346],["T_BOOLEAN_AND","&&",346],["T_WHITESPACE"," ",346],["T_VARIABLE","$validationState",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","isAuthenticateAllowed",346],"(",")",";",["T_WHITESPACE","\n    ",346],"}",["T_WHITESPACE","\n\n    ",347],["T_DOC_COMMENT","\/**\n     * Return data for start authentication (redirect customer to bank page)\n     *\n     * @return array\n     *\/",349],["T_WHITESPACE","\n    ",353],["T_PUBLIC","public",354],["T_WHITESPACE"," ",354],["T_FUNCTION","function",354],["T_WHITESPACE"," ",354],["T_STRING","getAuthenticateStartData",354],"(",")",["T_WHITESPACE","\n    ",354],"{",["T_WHITESPACE","\n        ",355],["T_VARIABLE","$validationState",356],["T_WHITESPACE"," ",356],"=",["T_WHITESPACE"," ",356],["T_VARIABLE","$this",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","_getValidationState",356],"(",")",";",["T_WHITESPACE","\n        ",356],["T_IF","if",357],["T_WHITESPACE"," ",357],"(","!",["T_VARIABLE","$validationState",357],["T_WHITESPACE"," ",357],["T_BOOLEAN_AND","&&",357],["T_WHITESPACE"," ",357],["T_VARIABLE","$this",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","shouldAuthenticate",357],"(",")",")",["T_WHITESPACE"," ",357],"{",["T_WHITESPACE","\n            ",357],["T_THROW","throw",358],["T_WHITESPACE"," ",358],["T_NEW","new",358],["T_WHITESPACE"," ",358],["T_STRING","Exception",358],"(",["T_CONSTANT_ENCAPSED_STRING","'Authentication impossible: validation state is wrong.'",358],")",";",["T_WHITESPACE","\n        ",358],"}",["T_WHITESPACE","\n        ",359],["T_VARIABLE","$data",360],["T_WHITESPACE"," ",360],"=",["T_WHITESPACE"," ",360],["T_ARRAY","array",360],"(",["T_WHITESPACE","\n            ",360],["T_CONSTANT_ENCAPSED_STRING","'acs_url'",361],["T_WHITESPACE"," ",361],["T_DOUBLE_ARROW","=>",361],["T_WHITESPACE"," ",361],["T_VARIABLE","$validationState",361],["T_OBJECT_OPERATOR","->",361],["T_STRING","getLookupAcsUrl",361],"(",")",",",["T_WHITESPACE","\n            ",361],["T_CONSTANT_ENCAPSED_STRING","'pa_req'",362],["T_WHITESPACE"," ",362],["T_DOUBLE_ARROW","=>",362],["T_WHITESPACE"," ",362],["T_VARIABLE","$validationState",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","getLookupPayload",362],"(",")",",",["T_WHITESPACE","\n            ",362],["T_CONSTANT_ENCAPSED_STRING","'term_url'",363],["T_WHITESPACE"," ",363],["T_DOUBLE_ARROW","=>",363],["T_WHITESPACE"," ",363],["T_VARIABLE","$this",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","_getUrl",363],"(",["T_CONSTANT_ENCAPSED_STRING","'authenticationcomplete'",363],",",["T_WHITESPACE"," ",363],["T_STRING","true",363],")",",",["T_WHITESPACE","\n            ",363],["T_CONSTANT_ENCAPSED_STRING","'md'",364],["T_WHITESPACE"," ",364],["T_DOUBLE_ARROW","=>",364],["T_WHITESPACE"," ",364],["T_VARIABLE","$validationState",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","getLookupTransactionId",364],"(",")",["T_WHITESPACE","\n        ",364],")",";",["T_WHITESPACE","\n        ",365],["T_RETURN","return",366],["T_WHITESPACE"," ",366],["T_VARIABLE","$data",366],";",["T_WHITESPACE","\n    ",366],"}",["T_WHITESPACE","\n\n    ",367],["T_DOC_COMMENT","\/**\n     * If authenticate is successful return true\n     *\n     * @return bool\n     *\/",369],["T_WHITESPACE","\n    ",373],["T_PUBLIC","public",374],["T_WHITESPACE"," ",374],["T_FUNCTION","function",374],["T_WHITESPACE"," ",374],["T_STRING","isAuthenticateSuccessful",374],"(",")",["T_WHITESPACE","\n    ",374],"{",["T_WHITESPACE","\n        ",375],["T_VARIABLE","$validationState",376],["T_WHITESPACE"," ",376],"=",["T_WHITESPACE"," ",376],["T_VARIABLE","$this",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","_getValidationState",376],"(",")",";",["T_WHITESPACE","\n        ",376],["T_RETURN","return",377],["T_WHITESPACE"," ",377],["T_VARIABLE","$validationState",377],["T_WHITESPACE"," ",377],["T_BOOLEAN_AND","&&",377],["T_WHITESPACE"," ",377],["T_VARIABLE","$validationState",377],["T_OBJECT_OPERATOR","->",377],["T_STRING","isAuthenticateSuccessful",377],"(",")",";",["T_WHITESPACE","\n    ",377],"}",["T_WHITESPACE","\n\n     ",378],["T_DOC_COMMENT","\/**\n     * Export cmpi lookups and authentication information stored in session into array\n     *\n     * @param mixed $to\n     * @param array $map\n     * @return mixed $to\n     *\/",380],["T_WHITESPACE","\n    ",386],["T_PUBLIC","public",387],["T_WHITESPACE"," ",387],["T_FUNCTION","function",387],["T_WHITESPACE"," ",387],["T_STRING","exportCmpiData",387],"(",["T_VARIABLE","$to",387],",",["T_WHITESPACE"," ",387],["T_VARIABLE","$map",387],["T_WHITESPACE"," ",387],"=",["T_WHITESPACE"," ",387],["T_STRING","false",387],")",["T_WHITESPACE","\n    ",387],"{",["T_WHITESPACE","\n        ",388],["T_IF","if",389],["T_WHITESPACE"," ",389],"(","!",["T_VARIABLE","$map",389],")",["T_WHITESPACE"," ",389],"{",["T_WHITESPACE","\n            ",389],["T_VARIABLE","$map",390],["T_WHITESPACE"," ",390],"=",["T_WHITESPACE"," ",390],["T_VARIABLE","$this",390],["T_OBJECT_OPERATOR","->",390],["T_STRING","_cmpiMap",390],";",["T_WHITESPACE","\n        ",390],"}",["T_WHITESPACE","\n        ",391],["T_IF","if",392],["T_WHITESPACE"," ",392],"(",["T_VARIABLE","$validationState",392],["T_WHITESPACE"," ",392],"=",["T_WHITESPACE"," ",392],["T_VARIABLE","$this",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","_getValidationState",392],"(",")",")",["T_WHITESPACE"," ",392],"{",["T_WHITESPACE","\n            ",392],["T_VARIABLE","$to",393],["T_WHITESPACE"," ",393],"=",["T_WHITESPACE"," ",393],["T_STRING","Varien_Object_Mapper",393],["T_DOUBLE_COLON","::",393],["T_STRING","accumulateByMap",393],"(",["T_VARIABLE","$validationState",393],",",["T_WHITESPACE"," ",393],["T_VARIABLE","$to",393],",",["T_WHITESPACE"," ",393],["T_VARIABLE","$map",393],")",";",["T_WHITESPACE","\n        ",393],"}",["T_WHITESPACE","\n        ",394],["T_RETURN","return",395],["T_WHITESPACE"," ",395],["T_VARIABLE","$to",395],";",["T_WHITESPACE","\n    ",395],"}",["T_WHITESPACE","\n",396],"}",["T_WHITESPACE","\n\n",397]]