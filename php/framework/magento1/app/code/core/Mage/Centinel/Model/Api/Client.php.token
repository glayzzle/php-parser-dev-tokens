[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Centinel\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * 3D Secure Validation Library for Payment\n *\/",27],["T_WHITESPACE","\n",29],["T_INCLUDE_ONCE","include_once",30],["T_WHITESPACE"," ",30],["T_CONSTANT_ENCAPSED_STRING","'3Dsecure\/CentinelClient.php'",30],";",["T_WHITESPACE","\n\n",30],["T_DOC_COMMENT","\/**\n * 3D Secure Validation Api\n *\/",32],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Centinel_Model_Api_Client",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","CentinelClient",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_PUBLIC","public",37],["T_WHITESPACE"," ",37],["T_FUNCTION","function",37],["T_WHITESPACE"," ",37],["T_STRING","sendHttp",37],"(",["T_VARIABLE","$url",37],",",["T_WHITESPACE"," ",37],["T_VARIABLE","$connectTimeout",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","\"\"",37],",",["T_WHITESPACE"," ",37],["T_VARIABLE","$timeout",37],")",["T_WHITESPACE","\n    ",37],"{",["T_WHITESPACE","\n        ",38],["T_COMMENT","\/\/ verify that the URL uses a supported protocol.\n",39],["T_WHITESPACE","        ",40],["T_IF","if",40],["T_WHITESPACE"," ",40],"(","(",["T_STRING","strpos",40],"(",["T_VARIABLE","$url",40],",",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","\"http:\/\/\"",40],")",["T_WHITESPACE"," ",40],["T_IS_IDENTICAL","===",40],["T_WHITESPACE"," ",40],["T_LNUMBER","0",40],")",["T_WHITESPACE"," ",40],["T_BOOLEAN_OR","||",40],["T_WHITESPACE"," ",40],"(",["T_STRING","strpos",40],"(",["T_VARIABLE","$url",40],",",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","\"https:\/\/\"",40],")",["T_WHITESPACE"," ",40],["T_IS_IDENTICAL","===",40],["T_WHITESPACE"," ",40],["T_LNUMBER","0",40],")",")",["T_WHITESPACE"," ",40],"{",["T_WHITESPACE","\n\n            ",40],["T_COMMENT","\/\/Construct the payload to POST to the url.\n",42],["T_WHITESPACE","            ",43],["T_VARIABLE","$data",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","getRequestXml",43],"(",")",";",["T_WHITESPACE","\n\n            ",43],["T_COMMENT","\/\/ create a new cURL resource\n",45],["T_WHITESPACE","            ",46],["T_VARIABLE","$ch",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_STRING","curl_init",46],"(",["T_VARIABLE","$url",46],")",";",["T_WHITESPACE","\n\n            ",46],["T_COMMENT","\/\/ set URL and other appropriate options\n",48],["T_WHITESPACE","            ",49],["T_STRING","curl_setopt",49],"(",["T_VARIABLE","$ch",49],",",["T_WHITESPACE"," ",49],["T_STRING","CURLOPT_POST",49],["T_WHITESPACE"," ",49],",",["T_LNUMBER","1",49],")",";",["T_WHITESPACE","\n            ",49],["T_STRING","curl_setopt",50],"(",["T_VARIABLE","$ch",50],",",["T_WHITESPACE"," ",50],["T_STRING","CURLOPT_POSTFIELDS",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$data",50],")",";",["T_WHITESPACE","\n            ",50],["T_STRING","curl_setopt",51],"(",["T_VARIABLE","$ch",51],",",["T_WHITESPACE"," ",51],["T_STRING","CURLOPT_SSL_VERIFYHOST",51],",",["T_WHITESPACE"," ",51],["T_LNUMBER","2",51],")",";",["T_WHITESPACE","\n            ",51],["T_STRING","curl_setopt",52],"(",["T_VARIABLE","$ch",52],",",["T_WHITESPACE"," ",52],["T_STRING","CURLOPT_RETURNTRANSFER",52],",",["T_WHITESPACE"," ",52],["T_LNUMBER","1",52],")",";",["T_WHITESPACE","\n            ",52],["T_STRING","curl_setopt",53],"(",["T_VARIABLE","$ch",53],",",["T_WHITESPACE"," ",53],["T_STRING","CURLOPT_SSL_VERIFYPEER",53],",",["T_WHITESPACE"," ",53],["T_LNUMBER","1",53],")",";",["T_WHITESPACE","\n            ",53],["T_STRING","curl_setopt",54],"(",["T_VARIABLE","$ch",54],",",["T_WHITESPACE"," ",54],["T_STRING","CURLOPT_TIMEOUT",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$timeout",54],")",";",["T_WHITESPACE","\n\n            ",54],["T_COMMENT","\/\/ Execute the request.\n",56],["T_WHITESPACE","            ",57],["T_VARIABLE","$result",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_STRING","curl_exec",57],"(",["T_VARIABLE","$ch",57],")",";",["T_WHITESPACE","\n            ",57],["T_VARIABLE","$succeeded",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_STRING","curl_errno",58],"(",["T_VARIABLE","$ch",58],")",["T_WHITESPACE"," ",58],["T_IS_EQUAL","==",58],["T_WHITESPACE"," ",58],["T_LNUMBER","0",58],["T_WHITESPACE"," ",58],"?",["T_WHITESPACE"," ",58],["T_STRING","true",58],["T_WHITESPACE"," ",58],":",["T_WHITESPACE"," ",58],["T_STRING","false",58],";",["T_WHITESPACE","\n\n            ",58],["T_COMMENT","\/\/ close cURL resource, and free up system resources\n",60],["T_WHITESPACE","            ",61],["T_STRING","curl_close",61],"(",["T_VARIABLE","$ch",61],")",";",["T_WHITESPACE","\n\n            ",61],["T_COMMENT","\/\/ If Communication was not successful set error result, otherwise\n",63],["T_WHITESPACE","            ",64],["T_IF","if",64],["T_WHITESPACE"," ",64],"(","!",["T_VARIABLE","$succeeded",64],")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n                ",64],["T_VARIABLE","$result",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","setErrorResponse",65],"(",["T_STRING","CENTINEL_ERROR_CODE_8030",65],",",["T_WHITESPACE"," ",65],["T_STRING","CENTINEL_ERROR_CODE_8030_DESC",65],")",";",["T_WHITESPACE","\n            ",65],"}",["T_WHITESPACE","\n\n            ",66],["T_COMMENT","\/\/ Assert that we received an expected Centinel Message in reponse.\n",68],["T_WHITESPACE","            ",69],["T_IF","if",69],["T_WHITESPACE"," ",69],"(",["T_STRING","strpos",69],"(",["T_VARIABLE","$result",69],",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","\"<CardinalMPI>\"",69],")",["T_WHITESPACE"," ",69],["T_IS_IDENTICAL","===",69],["T_WHITESPACE"," ",69],["T_STRING","false",69],")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n                ",69],["T_VARIABLE","$result",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","setErrorResponse",70],"(",["T_STRING","CENTINEL_ERROR_CODE_8010",70],",",["T_WHITESPACE"," ",70],["T_STRING","CENTINEL_ERROR_CODE_8010_DESC",70],")",";",["T_WHITESPACE","\n            ",70],"}",["T_WHITESPACE","\n        ",71],"}",["T_WHITESPACE"," ",72],["T_ELSE","else",72],["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n            ",72],["T_VARIABLE","$result",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","setErrorResponse",73],"(",["T_STRING","CENTINEL_ERROR_CODE_8000",73],",",["T_WHITESPACE"," ",73],["T_STRING","CENTINEL_ERROR_CODE_8000_DESC",73],")",";",["T_WHITESPACE","\n        ",73],"}",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$parser",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_NEW","new",75],["T_WHITESPACE"," ",75],["T_STRING","XMLParser",75],";",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$parser",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","deserializeXml",76],"(",["T_VARIABLE","$result",76],")",";",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","response",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$parser",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","deserializedResponse",77],";",["T_WHITESPACE","\n    ",77],"}",["T_WHITESPACE","\n",78],"}",["T_WHITESPACE","\n",79]]