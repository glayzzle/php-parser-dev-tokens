[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Tag\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Tag model\n *\n * @method Mage_Tag_Model_Resource_Tag _getResource()\n * @method Mage_Tag_Model_Resource_Tag getResource()\n * @method Mage_Tag_Model_Tag setName(string $value)\n * @method int getStatus()\n * @method Mage_Tag_Model_Tag setStatus(int $value)\n * @method int getFirstCustomerId()\n * @method Mage_Tag_Model_Tag setFirstCustomerId(int $value)\n * @method int getFirstStoreId()\n * @method Mage_Tag_Model_Tag setFirstStoreId(int $value)\n *\n * @category    Mage\n * @package     Mage_Tag\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n\n",43],["T_CLASS","class",45],["T_WHITESPACE"," ",45],["T_STRING","Mage_Tag_Model_Tag",45],["T_WHITESPACE"," ",45],["T_EXTENDS","extends",45],["T_WHITESPACE"," ",45],["T_STRING","Mage_Core_Model_Abstract",45],["T_WHITESPACE","\n",45],"{",["T_WHITESPACE","\n    ",46],["T_CONST","const",47],["T_WHITESPACE"," ",47],["T_STRING","STATUS_DISABLED",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],"-",["T_LNUMBER","1",47],";",["T_WHITESPACE","\n    ",47],["T_CONST","const",48],["T_WHITESPACE"," ",48],["T_STRING","STATUS_PENDING",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_LNUMBER","0",48],";",["T_WHITESPACE","\n    ",48],["T_CONST","const",49],["T_WHITESPACE"," ",49],["T_STRING","STATUS_APPROVED",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_LNUMBER","1",49],";",["T_WHITESPACE","\n\n    ",49],["T_COMMENT","\/\/ statuses for tag relation add\n",51],["T_WHITESPACE","    ",52],["T_CONST","const",52],["T_WHITESPACE"," ",52],["T_STRING","ADD_STATUS_SUCCESS",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'success'",52],";",["T_WHITESPACE","\n    ",52],["T_CONST","const",53],["T_WHITESPACE"," ",53],["T_STRING","ADD_STATUS_NEW",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","'new'",53],";",["T_WHITESPACE","\n    ",53],["T_CONST","const",54],["T_WHITESPACE"," ",54],["T_STRING","ADD_STATUS_EXIST",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'exist'",54],";",["T_WHITESPACE","\n    ",54],["T_CONST","const",55],["T_WHITESPACE"," ",55],["T_STRING","ADD_STATUS_REJECTED",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_CONSTANT_ENCAPSED_STRING","'rejected'",55],";",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * Entity code.\n     * Can be used as part of method name for entity processing\n     *\/",57],["T_WHITESPACE","\n    ",60],["T_CONST","const",61],["T_WHITESPACE"," ",61],["T_STRING","ENTITY",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'tag'",61],";",["T_WHITESPACE","\n\n    ",61],["T_DOC_COMMENT","\/**\n     * Event prefix for observer\n     *\n     * @var string\n     *\/",63],["T_WHITESPACE","\n    ",67],["T_PROTECTED","protected",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$_eventPrefix",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'tag'",68],";",["T_WHITESPACE","\n\n    ",68],["T_DOC_COMMENT","\/**\n     * This flag means should we or not add base popularity on tag load\n     *\n     * @var bool\n     *\/",70],["T_WHITESPACE","\n    ",74],["T_PROTECTED","protected",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$_addBasePopularity",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_STRING","false",75],";",["T_WHITESPACE","\n\n    ",75],["T_PROTECTED","protected",77],["T_WHITESPACE"," ",77],["T_FUNCTION","function",77],["T_WHITESPACE"," ",77],["T_STRING","_construct",77],"(",")",["T_WHITESPACE","\n    ",77],"{",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","_init",79],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/tag'",79],")",";",["T_WHITESPACE","\n    ",79],"}",["T_WHITESPACE","\n\n    ",80],["T_DOC_COMMENT","\/**\n     * Init indexing process after tag data commit\n     *\n     * @return Mage_Tag_Model_Tag\n     *\/",82],["T_WHITESPACE","\n    ",86],["T_PUBLIC","public",87],["T_WHITESPACE"," ",87],["T_FUNCTION","function",87],["T_WHITESPACE"," ",87],["T_STRING","afterCommitCallback",87],"(",")",["T_WHITESPACE","\n    ",87],"{",["T_WHITESPACE","\n        ",88],["T_STRING","parent",89],["T_DOUBLE_COLON","::",89],["T_STRING","afterCommitCallback",89],"(",")",";",["T_WHITESPACE","\n        ",89],["T_STRING","Mage",90],["T_DOUBLE_COLON","::",90],["T_STRING","getSingleton",90],"(",["T_CONSTANT_ENCAPSED_STRING","'index\/indexer'",90],")",["T_OBJECT_OPERATOR","->",90],["T_STRING","processEntityAction",90],"(",["T_WHITESPACE","\n            ",90],["T_VARIABLE","$this",91],",",["T_WHITESPACE"," ",91],["T_STRING","self",91],["T_DOUBLE_COLON","::",91],["T_STRING","ENTITY",91],",",["T_WHITESPACE"," ",91],["T_STRING","Mage_Index_Model_Event",91],["T_DOUBLE_COLON","::",91],["T_STRING","TYPE_SAVE",91],["T_WHITESPACE","\n        ",91],")",";",["T_WHITESPACE","\n        ",92],["T_RETURN","return",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],";",["T_WHITESPACE","\n    ",93],"}",["T_WHITESPACE","\n\n    ",94],["T_DOC_COMMENT","\/**\n     * Setter for addBasePopularity flag\n     *\n     * @param bool $flag\n     * @return Mage_Tag_Model_Tag\n     *\/",96],["T_WHITESPACE","\n    ",101],["T_PUBLIC","public",102],["T_WHITESPACE"," ",102],["T_FUNCTION","function",102],["T_WHITESPACE"," ",102],["T_STRING","setAddBasePopularity",102],"(",["T_VARIABLE","$flag",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_STRING","true",102],")",["T_WHITESPACE","\n    ",102],"{",["T_WHITESPACE","\n        ",103],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","_addBasePopularity",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$flag",104],";",["T_WHITESPACE","\n        ",104],["T_RETURN","return",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],";",["T_WHITESPACE","\n    ",105],"}",["T_WHITESPACE","\n\n    ",106],["T_DOC_COMMENT","\/**\n     * Getter for addBasePopularity flag\n     *\n     * @return bool\n     *\/",108],["T_WHITESPACE","\n    ",112],["T_PUBLIC","public",113],["T_WHITESPACE"," ",113],["T_FUNCTION","function",113],["T_WHITESPACE"," ",113],["T_STRING","getAddBasePopularity",113],"(",")",["T_WHITESPACE","\n    ",113],"{",["T_WHITESPACE","\n        ",114],["T_RETURN","return",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","_addBasePopularity",115],";",["T_WHITESPACE","\n    ",115],"}",["T_WHITESPACE","\n\n    ",116],["T_DOC_COMMENT","\/**\n     * Product event tags collection getter\n     *\n     * @param  Varien_Event_Observer $observer\n     * @return Mage_Tag_Model_Mysql4_Tag_Collection\n     *\/",118],["T_WHITESPACE","\n    ",123],["T_PROTECTED","protected",124],["T_WHITESPACE"," ",124],["T_FUNCTION","function",124],["T_WHITESPACE"," ",124],["T_STRING","_getProductEventTagsCollection",124],"(",["T_STRING","Varien_Event_Observer",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$observer",124],")",["T_WHITESPACE","\n    ",124],"{",["T_WHITESPACE","\n        ",125],["T_RETURN","return",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getResourceCollection",126],"(",")",["T_WHITESPACE","\n                        ",126],["T_OBJECT_OPERATOR","->",127],["T_STRING","joinRel",127],"(",")",["T_WHITESPACE","\n                        ",127],["T_OBJECT_OPERATOR","->",128],["T_STRING","addProductFilter",128],"(",["T_VARIABLE","$observer",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","getEvent",128],"(",")",["T_OBJECT_OPERATOR","->",128],["T_STRING","getProduct",128],"(",")",["T_OBJECT_OPERATOR","->",128],["T_STRING","getId",128],"(",")",")",["T_WHITESPACE","\n                        ",128],["T_OBJECT_OPERATOR","->",129],["T_STRING","addTagGroup",129],"(",")",["T_WHITESPACE","\n                        ",129],["T_OBJECT_OPERATOR","->",130],["T_STRING","load",130],"(",")",";",["T_WHITESPACE","\n    ",130],"}",["T_WHITESPACE","\n\n    ",131],["T_PUBLIC","public",133],["T_WHITESPACE"," ",133],["T_FUNCTION","function",133],["T_WHITESPACE"," ",133],["T_STRING","getPopularity",133],"(",")",["T_WHITESPACE","\n    ",133],"{",["T_WHITESPACE","\n        ",134],["T_RETURN","return",135],["T_WHITESPACE"," ",135],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","_getData",135],"(",["T_CONSTANT_ENCAPSED_STRING","'popularity'",135],")",";",["T_WHITESPACE","\n    ",135],"}",["T_WHITESPACE","\n\n    ",136],["T_PUBLIC","public",138],["T_WHITESPACE"," ",138],["T_FUNCTION","function",138],["T_WHITESPACE"," ",138],["T_STRING","getName",138],"(",")",["T_WHITESPACE","\n    ",138],"{",["T_WHITESPACE","\n        ",139],["T_RETURN","return",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","_getData",140],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",140],")",";",["T_WHITESPACE","\n    ",140],"}",["T_WHITESPACE","\n\n    ",141],["T_PUBLIC","public",143],["T_WHITESPACE"," ",143],["T_FUNCTION","function",143],["T_WHITESPACE"," ",143],["T_STRING","getTagId",143],"(",")",["T_WHITESPACE","\n    ",143],"{",["T_WHITESPACE","\n        ",144],["T_RETURN","return",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","_getData",145],"(",["T_CONSTANT_ENCAPSED_STRING","'tag_id'",145],")",";",["T_WHITESPACE","\n    ",145],"}",["T_WHITESPACE","\n\n    ",146],["T_PUBLIC","public",148],["T_WHITESPACE"," ",148],["T_FUNCTION","function",148],["T_WHITESPACE"," ",148],["T_STRING","getRatio",148],"(",")",["T_WHITESPACE","\n    ",148],"{",["T_WHITESPACE","\n        ",149],["T_RETURN","return",150],["T_WHITESPACE"," ",150],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","_getData",150],"(",["T_CONSTANT_ENCAPSED_STRING","'ratio'",150],")",";",["T_WHITESPACE","\n    ",150],"}",["T_WHITESPACE","\n\n    ",151],["T_PUBLIC","public",153],["T_WHITESPACE"," ",153],["T_FUNCTION","function",153],["T_WHITESPACE"," ",153],["T_STRING","setRatio",153],"(",["T_VARIABLE","$ratio",153],")",["T_WHITESPACE","\n    ",153],"{",["T_WHITESPACE","\n        ",154],["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","setData",155],"(",["T_CONSTANT_ENCAPSED_STRING","'ratio'",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$ratio",155],")",";",["T_WHITESPACE","\n        ",155],["T_RETURN","return",156],["T_WHITESPACE"," ",156],["T_VARIABLE","$this",156],";",["T_WHITESPACE","\n    ",156],"}",["T_WHITESPACE","\n\n    ",157],["T_PUBLIC","public",159],["T_WHITESPACE"," ",159],["T_FUNCTION","function",159],["T_WHITESPACE"," ",159],["T_STRING","loadByName",159],"(",["T_VARIABLE","$name",159],")",["T_WHITESPACE","\n    ",159],"{",["T_WHITESPACE","\n        ",160],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","_getResource",161],"(",")",["T_OBJECT_OPERATOR","->",161],["T_STRING","loadByName",161],"(",["T_VARIABLE","$this",161],",",["T_WHITESPACE"," ",161],["T_VARIABLE","$name",161],")",";",["T_WHITESPACE","\n        ",161],["T_RETURN","return",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],";",["T_WHITESPACE","\n    ",162],"}",["T_WHITESPACE","\n\n    ",163],["T_PUBLIC","public",165],["T_WHITESPACE"," ",165],["T_FUNCTION","function",165],["T_WHITESPACE"," ",165],["T_STRING","aggregate",165],"(",")",["T_WHITESPACE","\n    ",165],"{",["T_WHITESPACE","\n        ",166],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","_getResource",167],"(",")",["T_OBJECT_OPERATOR","->",167],["T_STRING","aggregate",167],"(",["T_VARIABLE","$this",167],")",";",["T_WHITESPACE","\n        ",167],["T_RETURN","return",168],["T_WHITESPACE"," ",168],["T_VARIABLE","$this",168],";",["T_WHITESPACE","\n    ",168],"}",["T_WHITESPACE","\n\n    ",169],["T_PUBLIC","public",171],["T_WHITESPACE"," ",171],["T_FUNCTION","function",171],["T_WHITESPACE"," ",171],["T_STRING","productEventAggregate",171],"(",["T_VARIABLE","$observer",171],")",["T_WHITESPACE","\n    ",171],"{",["T_WHITESPACE","\n        ",172],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","_getProductEventTagsCollection",173],"(",["T_VARIABLE","$observer",173],")",["T_OBJECT_OPERATOR","->",173],["T_STRING","walk",173],"(",["T_CONSTANT_ENCAPSED_STRING","'aggregate'",173],")",";",["T_WHITESPACE","\n        ",173],["T_RETURN","return",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],";",["T_WHITESPACE","\n    ",174],"}",["T_WHITESPACE","\n\n    ",175],["T_DOC_COMMENT","\/**\n     * Product delete event action\n     *\n     * @param  Varien_Event_Observer $observer\n     * @return Mage_Tag_Model_Tag\n     *\/",177],["T_WHITESPACE","\n    ",182],["T_PUBLIC","public",183],["T_WHITESPACE"," ",183],["T_FUNCTION","function",183],["T_WHITESPACE"," ",183],["T_STRING","productDeleteEventAction",183],"(",["T_VARIABLE","$observer",183],")",["T_WHITESPACE","\n    ",183],"{",["T_WHITESPACE","\n        ",184],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","_getResource",185],"(",")",["T_OBJECT_OPERATOR","->",185],["T_STRING","decrementProducts",185],"(",["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","_getProductEventTagsCollection",185],"(",["T_VARIABLE","$observer",185],")",["T_OBJECT_OPERATOR","->",185],["T_STRING","getAllIds",185],"(",")",")",";",["T_WHITESPACE","\n        ",185],["T_RETURN","return",186],["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],";",["T_WHITESPACE","\n    ",186],"}",["T_WHITESPACE","\n\n    ",187],["T_DOC_COMMENT","\/**\n     * Add summary data to current object\n     *\n     * @deprecated after 1.4.0.0\n     * @param int $storeId\n     * @return Mage_Tag_Model_Tag\n     *\/",189],["T_WHITESPACE","\n    ",195],["T_PUBLIC","public",196],["T_WHITESPACE"," ",196],["T_FUNCTION","function",196],["T_WHITESPACE"," ",196],["T_STRING","addSummary",196],"(",["T_VARIABLE","$storeId",196],")",["T_WHITESPACE","\n    ",196],"{",["T_WHITESPACE","\n        ",197],["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","setStoreId",198],"(",["T_VARIABLE","$storeId",198],")",";",["T_WHITESPACE","\n        ",198],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","_getResource",199],"(",")",["T_OBJECT_OPERATOR","->",199],["T_STRING","addSummary",199],"(",["T_VARIABLE","$this",199],")",";",["T_WHITESPACE","\n        ",199],["T_RETURN","return",200],["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],";",["T_WHITESPACE","\n    ",200],"}",["T_WHITESPACE","\n\n    ",201],["T_DOC_COMMENT","\/**\n     * getter for self::STATUS_APPROVED\n     *\/",203],["T_WHITESPACE","\n    ",205],["T_PUBLIC","public",206],["T_WHITESPACE"," ",206],["T_FUNCTION","function",206],["T_WHITESPACE"," ",206],["T_STRING","getApprovedStatus",206],"(",")",["T_WHITESPACE","\n    ",206],"{",["T_WHITESPACE","\n        ",207],["T_RETURN","return",208],["T_WHITESPACE"," ",208],["T_STRING","self",208],["T_DOUBLE_COLON","::",208],["T_STRING","STATUS_APPROVED",208],";",["T_WHITESPACE","\n    ",208],"}",["T_WHITESPACE","\n\n    ",209],["T_DOC_COMMENT","\/**\n     * getter for self::STATUS_PENDING\n     *\/",211],["T_WHITESPACE","\n    ",213],["T_PUBLIC","public",214],["T_WHITESPACE"," ",214],["T_FUNCTION","function",214],["T_WHITESPACE"," ",214],["T_STRING","getPendingStatus",214],"(",")",["T_WHITESPACE","\n    ",214],"{",["T_WHITESPACE","\n        ",215],["T_RETURN","return",216],["T_WHITESPACE"," ",216],["T_STRING","self",216],["T_DOUBLE_COLON","::",216],["T_STRING","STATUS_PENDING",216],";",["T_WHITESPACE","\n    ",216],"}",["T_WHITESPACE","\n\n    ",217],["T_DOC_COMMENT","\/**\n     * getter for self::STATUS_DISABLED\n     *\/",219],["T_WHITESPACE","\n    ",221],["T_PUBLIC","public",222],["T_WHITESPACE"," ",222],["T_FUNCTION","function",222],["T_WHITESPACE"," ",222],["T_STRING","getDisabledStatus",222],"(",")",["T_WHITESPACE","\n    ",222],"{",["T_WHITESPACE","\n        ",223],["T_RETURN","return",224],["T_WHITESPACE"," ",224],["T_STRING","self",224],["T_DOUBLE_COLON","::",224],["T_STRING","STATUS_DISABLED",224],";",["T_WHITESPACE","\n    ",224],"}",["T_WHITESPACE","\n\n    ",225],["T_PUBLIC","public",227],["T_WHITESPACE"," ",227],["T_FUNCTION","function",227],["T_WHITESPACE"," ",227],["T_STRING","getEntityCollection",227],"(",")",["T_WHITESPACE","\n    ",227],"{",["T_WHITESPACE","\n        ",228],["T_RETURN","return",229],["T_WHITESPACE"," ",229],["T_STRING","Mage",229],["T_DOUBLE_COLON","::",229],["T_STRING","getResourceModel",229],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/product_collection'",229],")",";",["T_WHITESPACE","\n    ",229],"}",["T_WHITESPACE","\n\n    ",230],["T_PUBLIC","public",232],["T_WHITESPACE"," ",232],["T_FUNCTION","function",232],["T_WHITESPACE"," ",232],["T_STRING","getCustomerCollection",232],"(",")",["T_WHITESPACE","\n    ",232],"{",["T_WHITESPACE","\n        ",233],["T_RETURN","return",234],["T_WHITESPACE"," ",234],["T_STRING","Mage",234],["T_DOUBLE_COLON","::",234],["T_STRING","getResourceModel",234],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/customer_collection'",234],")",";",["T_WHITESPACE","\n    ",234],"}",["T_WHITESPACE","\n\n    ",235],["T_PUBLIC","public",237],["T_WHITESPACE"," ",237],["T_FUNCTION","function",237],["T_WHITESPACE"," ",237],["T_STRING","getTaggedProductsUrl",237],"(",")",["T_WHITESPACE","\n    ",237],"{",["T_WHITESPACE","\n        ",238],["T_RETURN","return",239],["T_WHITESPACE"," ",239],["T_STRING","Mage",239],["T_DOUBLE_COLON","::",239],["T_STRING","getUrl",239],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/product\/list'",239],",",["T_WHITESPACE"," ",239],["T_ARRAY","array",239],"(",["T_CONSTANT_ENCAPSED_STRING","'tagId'",239],["T_WHITESPACE"," ",239],["T_DOUBLE_ARROW","=>",239],["T_WHITESPACE"," ",239],["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","getTagId",239],"(",")",")",")",";",["T_WHITESPACE","\n    ",239],"}",["T_WHITESPACE","\n\n    ",240],["T_PUBLIC","public",242],["T_WHITESPACE"," ",242],["T_FUNCTION","function",242],["T_WHITESPACE"," ",242],["T_STRING","getViewTagUrl",242],"(",")",["T_WHITESPACE","\n    ",242],"{",["T_WHITESPACE","\n        ",243],["T_RETURN","return",244],["T_WHITESPACE"," ",244],["T_STRING","Mage",244],["T_DOUBLE_COLON","::",244],["T_STRING","getUrl",244],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/customer\/view'",244],",",["T_WHITESPACE"," ",244],["T_ARRAY","array",244],"(",["T_CONSTANT_ENCAPSED_STRING","'tagId'",244],["T_WHITESPACE"," ",244],["T_DOUBLE_ARROW","=>",244],["T_WHITESPACE"," ",244],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","getTagId",244],"(",")",")",")",";",["T_WHITESPACE","\n    ",244],"}",["T_WHITESPACE","\n\n    ",245],["T_PUBLIC","public",247],["T_WHITESPACE"," ",247],["T_FUNCTION","function",247],["T_WHITESPACE"," ",247],["T_STRING","getEditTagUrl",247],"(",")",["T_WHITESPACE","\n    ",247],"{",["T_WHITESPACE","\n        ",248],["T_RETURN","return",249],["T_WHITESPACE"," ",249],["T_STRING","Mage",249],["T_DOUBLE_COLON","::",249],["T_STRING","getUrl",249],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/customer\/edit'",249],",",["T_WHITESPACE"," ",249],["T_ARRAY","array",249],"(",["T_CONSTANT_ENCAPSED_STRING","'tagId'",249],["T_WHITESPACE"," ",249],["T_DOUBLE_ARROW","=>",249],["T_WHITESPACE"," ",249],["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","getTagId",249],"(",")",")",")",";",["T_WHITESPACE","\n    ",249],"}",["T_WHITESPACE","\n\n    ",250],["T_PUBLIC","public",252],["T_WHITESPACE"," ",252],["T_FUNCTION","function",252],["T_WHITESPACE"," ",252],["T_STRING","getRemoveTagUrl",252],"(",")",["T_WHITESPACE","\n    ",252],"{",["T_WHITESPACE","\n        ",253],["T_RETURN","return",254],["T_WHITESPACE"," ",254],["T_STRING","Mage",254],["T_DOUBLE_COLON","::",254],["T_STRING","getUrl",254],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/customer\/remove'",254],",",["T_WHITESPACE"," ",254],["T_ARRAY","array",254],"(",["T_CONSTANT_ENCAPSED_STRING","'tagId'",254],["T_WHITESPACE"," ",254],["T_DOUBLE_ARROW","=>",254],["T_WHITESPACE"," ",254],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","getTagId",254],"(",")",")",")",";",["T_WHITESPACE","\n    ",254],"}",["T_WHITESPACE","\n\n    ",255],["T_PUBLIC","public",257],["T_WHITESPACE"," ",257],["T_FUNCTION","function",257],["T_WHITESPACE"," ",257],["T_STRING","getPopularCollection",257],"(",")",["T_WHITESPACE","\n    ",257],"{",["T_WHITESPACE","\n        ",258],["T_RETURN","return",259],["T_WHITESPACE"," ",259],["T_STRING","Mage",259],["T_DOUBLE_COLON","::",259],["T_STRING","getResourceModel",259],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/popular_collection'",259],")",";",["T_WHITESPACE","\n    ",259],"}",["T_WHITESPACE","\n\n    ",260],["T_DOC_COMMENT","\/**\n     * Retrieves array of related product IDs\n     *\n     * @return array\n     *\/",262],["T_WHITESPACE","\n    ",266],["T_PUBLIC","public",267],["T_WHITESPACE"," ",267],["T_FUNCTION","function",267],["T_WHITESPACE"," ",267],["T_STRING","getRelatedProductIds",267],"(",")",["T_WHITESPACE","\n    ",267],"{",["T_WHITESPACE","\n        ",268],["T_RETURN","return",269],["T_WHITESPACE"," ",269],["T_STRING","Mage",269],["T_DOUBLE_COLON","::",269],["T_STRING","getModel",269],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/tag_relation'",269],")",["T_WHITESPACE","\n            ",269],["T_OBJECT_OPERATOR","->",270],["T_STRING","setTagId",270],"(",["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","getTagId",270],"(",")",")",["T_WHITESPACE","\n            ",270],["T_OBJECT_OPERATOR","->",271],["T_STRING","setStoreId",271],"(",["T_VARIABLE","$this",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","getStoreId",271],"(",")",")",["T_WHITESPACE","\n            ",271],["T_OBJECT_OPERATOR","->",272],["T_STRING","setStatusFilter",272],"(",["T_VARIABLE","$this",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","getStatusFilter",272],"(",")",")",["T_WHITESPACE","\n            ",272],["T_OBJECT_OPERATOR","->",273],["T_STRING","setCustomerId",273],"(",["T_STRING","null",273],")",["T_WHITESPACE","\n            ",273],["T_OBJECT_OPERATOR","->",274],["T_STRING","getProductIds",274],"(",")",";",["T_WHITESPACE","\n    ",274],"}",["T_WHITESPACE","\n\n    ",275],["T_DOC_COMMENT","\/**\n     * Checks is available current tag in specified store\n     *\n     * @param int $storeId\n     * @return bool\n     *\/",277],["T_WHITESPACE","\n    ",282],["T_PUBLIC","public",283],["T_WHITESPACE"," ",283],["T_FUNCTION","function",283],["T_WHITESPACE"," ",283],["T_STRING","isAvailableInStore",283],"(",["T_VARIABLE","$storeId",283],["T_WHITESPACE"," ",283],"=",["T_WHITESPACE"," ",283],["T_STRING","null",283],")",["T_WHITESPACE","\n    ",283],"{",["T_WHITESPACE","\n        ",284],["T_VARIABLE","$storeId",285],["T_WHITESPACE"," ",285],"=",["T_WHITESPACE"," ",285],"(",["T_STRING","is_null",285],"(",["T_VARIABLE","$storeId",285],")",")",["T_WHITESPACE"," ",285],"?",["T_WHITESPACE"," ",285],["T_STRING","Mage",285],["T_DOUBLE_COLON","::",285],["T_STRING","app",285],"(",")",["T_OBJECT_OPERATOR","->",285],["T_STRING","getStore",285],"(",")",["T_OBJECT_OPERATOR","->",285],["T_STRING","getId",285],"(",")",["T_WHITESPACE"," ",285],":",["T_WHITESPACE"," ",285],["T_VARIABLE","$storeId",285],";",["T_WHITESPACE","\n        ",285],["T_RETURN","return",286],["T_WHITESPACE"," ",286],["T_STRING","in_array",286],"(",["T_VARIABLE","$storeId",286],",",["T_WHITESPACE"," ",286],["T_VARIABLE","$this",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","getVisibleInStoreIds",286],"(",")",")",";",["T_WHITESPACE","\n    ",286],"}",["T_WHITESPACE","\n\n    ",287],["T_PROTECTED","protected",289],["T_WHITESPACE"," ",289],["T_FUNCTION","function",289],["T_WHITESPACE"," ",289],["T_STRING","_beforeDelete",289],"(",")",["T_WHITESPACE","\n    ",289],"{",["T_WHITESPACE","\n        ",290],["T_VARIABLE","$this",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","_protectFromNonAdmin",291],"(",")",";",["T_WHITESPACE","\n        ",291],["T_RETURN","return",292],["T_WHITESPACE"," ",292],["T_STRING","parent",292],["T_DOUBLE_COLON","::",292],["T_STRING","_beforeDelete",292],"(",")",";",["T_WHITESPACE","\n    ",292],"}",["T_WHITESPACE","\n\n    ",293],["T_DOC_COMMENT","\/**\n     * Save tag relation with product, customer and store\n     *\n     * @param int $productId\n     * @param int $customerId\n     * @param int $storeId\n     * @return string - relation add status\n     *\/",295],["T_WHITESPACE","\n    ",302],["T_PUBLIC","public",303],["T_WHITESPACE"," ",303],["T_FUNCTION","function",303],["T_WHITESPACE"," ",303],["T_STRING","saveRelation",303],"(",["T_VARIABLE","$productId",303],",",["T_WHITESPACE"," ",303],["T_VARIABLE","$customerId",303],",",["T_WHITESPACE"," ",303],["T_VARIABLE","$storeId",303],")",["T_WHITESPACE","\n    ",303],"{",["T_WHITESPACE","\n        ",304],["T_DOC_COMMENT","\/** @var $relationModel Mage_Tag_Model_Tag_Relation *\/",305],["T_WHITESPACE","\n        ",305],["T_VARIABLE","$relationModel",306],["T_WHITESPACE"," ",306],"=",["T_WHITESPACE"," ",306],["T_STRING","Mage",306],["T_DOUBLE_COLON","::",306],["T_STRING","getModel",306],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/tag_relation'",306],")",";",["T_WHITESPACE","\n        ",306],["T_VARIABLE","$relationModel",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","setTagId",307],"(",["T_VARIABLE","$this",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","getId",307],"(",")",")",["T_WHITESPACE","\n            ",307],["T_OBJECT_OPERATOR","->",308],["T_STRING","setStoreId",308],"(",["T_VARIABLE","$storeId",308],")",["T_WHITESPACE","\n            ",308],["T_OBJECT_OPERATOR","->",309],["T_STRING","setProductId",309],"(",["T_VARIABLE","$productId",309],")",["T_WHITESPACE","\n            ",309],["T_OBJECT_OPERATOR","->",310],["T_STRING","setCustomerId",310],"(",["T_VARIABLE","$customerId",310],")",["T_WHITESPACE","\n            ",310],["T_OBJECT_OPERATOR","->",311],["T_STRING","setActive",311],"(",["T_STRING","Mage_Tag_Model_Tag_Relation",311],["T_DOUBLE_COLON","::",311],["T_STRING","STATUS_ACTIVE",311],")",["T_WHITESPACE","\n            ",311],["T_OBJECT_OPERATOR","->",312],["T_STRING","setCreatedAt",312],"(",["T_VARIABLE","$relationModel",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","getResource",312],"(",")",["T_OBJECT_OPERATOR","->",312],["T_STRING","formatDate",312],"(",["T_STRING","time",312],"(",")",")",")",";",["T_WHITESPACE","\n\n        ",312],["T_VARIABLE","$relationModelSaveNeed",314],["T_WHITESPACE"," ",314],"=",["T_WHITESPACE"," ",314],["T_STRING","false",314],";",["T_WHITESPACE","\n        ",314],["T_SWITCH","switch",315],"(",["T_VARIABLE","$this",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","getStatus",315],"(",")",")",["T_WHITESPACE"," ",315],"{",["T_WHITESPACE","\n            ",315],["T_CASE","case",316],["T_WHITESPACE"," ",316],["T_VARIABLE","$this",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","getApprovedStatus",316],"(",")",":",["T_WHITESPACE","\n                ",316],["T_IF","if",317],"(",["T_VARIABLE","$this",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","_checkLinkBetweenTagProduct",317],"(",["T_VARIABLE","$relationModel",317],")",")",["T_WHITESPACE"," ",317],"{",["T_WHITESPACE","\n                    ",317],["T_VARIABLE","$relation",318],["T_WHITESPACE"," ",318],"=",["T_WHITESPACE"," ",318],["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","_getLinkBetweenTagCustomerProduct",318],"(",["T_VARIABLE","$relationModel",318],")",";",["T_WHITESPACE","\n                    ",318],["T_IF","if",319],["T_WHITESPACE"," ",319],"(",["T_VARIABLE","$relation",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","getId",319],"(",")",")",["T_WHITESPACE"," ",319],"{",["T_WHITESPACE","\n                        ",319],["T_IF","if",320],["T_WHITESPACE"," ",320],"(","!",["T_VARIABLE","$relation",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","getActive",320],"(",")",")",["T_WHITESPACE"," ",320],"{",["T_WHITESPACE","\n                            ",320],["T_COMMENT","\/\/ activate relation if it was inactive\n",321],["T_WHITESPACE","                            ",322],["T_VARIABLE","$relationModel",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","setId",322],"(",["T_VARIABLE","$relation",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","getId",322],"(",")",")",";",["T_WHITESPACE","\n                            ",322],["T_VARIABLE","$relationModelSaveNeed",323],["T_WHITESPACE"," ",323],"=",["T_WHITESPACE"," ",323],["T_STRING","true",323],";",["T_WHITESPACE","\n                        ",323],"}",["T_WHITESPACE","\n                    ",324],"}",["T_WHITESPACE"," ",325],["T_ELSE","else",325],["T_WHITESPACE"," ",325],"{",["T_WHITESPACE","\n                        ",325],["T_VARIABLE","$relationModelSaveNeed",326],["T_WHITESPACE"," ",326],"=",["T_WHITESPACE"," ",326],["T_STRING","true",326],";",["T_WHITESPACE","\n                    ",326],"}",["T_WHITESPACE","\n                    ",327],["T_VARIABLE","$result",328],["T_WHITESPACE"," ",328],"=",["T_WHITESPACE"," ",328],["T_STRING","self",328],["T_DOUBLE_COLON","::",328],["T_STRING","ADD_STATUS_EXIST",328],";",["T_WHITESPACE","\n                ",328],"}",["T_WHITESPACE"," ",329],["T_ELSE","else",329],["T_WHITESPACE"," ",329],"{",["T_WHITESPACE","\n                    ",329],["T_VARIABLE","$relationModelSaveNeed",330],["T_WHITESPACE"," ",330],"=",["T_WHITESPACE"," ",330],["T_STRING","true",330],";",["T_WHITESPACE","\n                    ",330],["T_VARIABLE","$result",331],["T_WHITESPACE"," ",331],"=",["T_WHITESPACE"," ",331],["T_STRING","self",331],["T_DOUBLE_COLON","::",331],["T_STRING","ADD_STATUS_SUCCESS",331],";",["T_WHITESPACE","\n                ",331],"}",["T_WHITESPACE","\n                ",332],["T_BREAK","break",333],";",["T_WHITESPACE","\n            ",333],["T_CASE","case",334],["T_WHITESPACE"," ",334],["T_VARIABLE","$this",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","getPendingStatus",334],"(",")",":",["T_WHITESPACE","\n                ",334],["T_VARIABLE","$relation",335],["T_WHITESPACE"," ",335],"=",["T_WHITESPACE"," ",335],["T_VARIABLE","$this",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","_getLinkBetweenTagCustomerProduct",335],"(",["T_VARIABLE","$relationModel",335],")",";",["T_WHITESPACE","\n                ",335],["T_IF","if",336],["T_WHITESPACE"," ",336],"(",["T_VARIABLE","$relation",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","getId",336],"(",")",")",["T_WHITESPACE"," ",336],"{",["T_WHITESPACE","\n                    ",336],["T_IF","if",337],["T_WHITESPACE"," ",337],"(","!",["T_VARIABLE","$relation",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","getActive",337],"(",")",")",["T_WHITESPACE"," ",337],"{",["T_WHITESPACE","\n                        ",337],["T_VARIABLE","$relationModel",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","setId",338],"(",["T_VARIABLE","$relation",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","getId",338],"(",")",")",";",["T_WHITESPACE","\n                        ",338],["T_VARIABLE","$relationModelSaveNeed",339],["T_WHITESPACE"," ",339],"=",["T_WHITESPACE"," ",339],["T_STRING","true",339],";",["T_WHITESPACE","\n                    ",339],"}",["T_WHITESPACE","\n                ",340],"}",["T_WHITESPACE"," ",341],["T_ELSE","else",341],["T_WHITESPACE"," ",341],"{",["T_WHITESPACE","\n                    ",341],["T_VARIABLE","$relationModelSaveNeed",342],["T_WHITESPACE"," ",342],"=",["T_WHITESPACE"," ",342],["T_STRING","true",342],";",["T_WHITESPACE","\n                ",342],"}",["T_WHITESPACE","\n                ",343],["T_VARIABLE","$result",344],["T_WHITESPACE"," ",344],"=",["T_WHITESPACE"," ",344],["T_STRING","self",344],["T_DOUBLE_COLON","::",344],["T_STRING","ADD_STATUS_NEW",344],";",["T_WHITESPACE","\n                ",344],["T_BREAK","break",345],";",["T_WHITESPACE","\n            ",345],["T_CASE","case",346],["T_WHITESPACE"," ",346],["T_VARIABLE","$this",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","getDisabledStatus",346],"(",")",":",["T_WHITESPACE","\n                ",346],["T_IF","if",347],"(",["T_VARIABLE","$this",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","_checkLinkBetweenTagCustomerProduct",347],"(",["T_VARIABLE","$relationModel",347],")",")",["T_WHITESPACE"," ",347],"{",["T_WHITESPACE","\n                    ",347],["T_VARIABLE","$result",348],["T_WHITESPACE"," ",348],"=",["T_WHITESPACE"," ",348],["T_STRING","self",348],["T_DOUBLE_COLON","::",348],["T_STRING","ADD_STATUS_REJECTED",348],";",["T_WHITESPACE","\n                ",348],"}",["T_WHITESPACE"," ",349],["T_ELSE","else",349],["T_WHITESPACE"," ",349],"{",["T_WHITESPACE","\n                    ",349],["T_VARIABLE","$this",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","setStatus",350],"(",["T_VARIABLE","$this",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","getPendingStatus",350],"(",")",")",["T_OBJECT_OPERATOR","->",350],["T_STRING","save",350],"(",")",";",["T_WHITESPACE","\n                    ",350],["T_VARIABLE","$relationModelSaveNeed",351],["T_WHITESPACE"," ",351],"=",["T_WHITESPACE"," ",351],["T_STRING","true",351],";",["T_WHITESPACE","\n                    ",351],["T_VARIABLE","$result",352],["T_WHITESPACE"," ",352],"=",["T_WHITESPACE"," ",352],["T_STRING","self",352],["T_DOUBLE_COLON","::",352],["T_STRING","ADD_STATUS_NEW",352],";",["T_WHITESPACE","\n                ",352],"}",["T_WHITESPACE","\n                ",353],["T_BREAK","break",354],";",["T_WHITESPACE","\n        ",354],"}",["T_WHITESPACE","\n        ",355],["T_IF","if",356],["T_WHITESPACE"," ",356],"(",["T_VARIABLE","$relationModelSaveNeed",356],")",["T_WHITESPACE"," ",356],"{",["T_WHITESPACE","\n            ",356],["T_VARIABLE","$relationModel",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","save",357],"(",")",";",["T_WHITESPACE","\n        ",357],"}",["T_WHITESPACE","\n\n        ",358],["T_RETURN","return",360],["T_WHITESPACE"," ",360],["T_VARIABLE","$result",360],";",["T_WHITESPACE","\n    ",360],"}",["T_WHITESPACE","\n\n    ",361],["T_DOC_COMMENT","\/**\n     * Check whether product is already marked in store with tag\n     *\n     * @param Mage_Tag_Model_Tag_Relation $relationModel\n     * @return boolean\n     *\/",363],["T_WHITESPACE","\n    ",368],["T_PROTECTED","protected",369],["T_WHITESPACE"," ",369],["T_FUNCTION","function",369],["T_WHITESPACE"," ",369],["T_STRING","_checkLinkBetweenTagProduct",369],"(",["T_VARIABLE","$relationModel",369],")",["T_WHITESPACE","\n    ",369],"{",["T_WHITESPACE","\n        ",370],["T_VARIABLE","$customerId",371],["T_WHITESPACE"," ",371],"=",["T_WHITESPACE"," ",371],["T_VARIABLE","$relationModel",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","getCustomerId",371],"(",")",";",["T_WHITESPACE","\n        ",371],["T_VARIABLE","$relationModel",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","setCustomerId",372],"(",["T_STRING","null",372],")",";",["T_WHITESPACE","\n        ",372],["T_VARIABLE","$result",373],["T_WHITESPACE"," ",373],"=",["T_WHITESPACE"," ",373],["T_STRING","in_array",373],"(",["T_VARIABLE","$relationModel",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","getProductId",373],"(",")",",",["T_WHITESPACE"," ",373],["T_VARIABLE","$relationModel",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","getProductIds",373],"(",")",")",";",["T_WHITESPACE","\n        ",373],["T_VARIABLE","$relationModel",374],["T_OBJECT_OPERATOR","->",374],["T_STRING","setCustomerId",374],"(",["T_VARIABLE","$customerId",374],")",";",["T_WHITESPACE","\n        ",374],["T_RETURN","return",375],["T_WHITESPACE"," ",375],["T_VARIABLE","$result",375],";",["T_WHITESPACE","\n    ",375],"}",["T_WHITESPACE","\n\n    ",376],["T_DOC_COMMENT","\/**\n     * Check whether product is already marked in store with tag by customer\n     *\n     * @param Mage_Tag_Model_Tag_Relation $relationModel\n     * @return bool\n     *\/",378],["T_WHITESPACE","\n    ",383],["T_PROTECTED","protected",384],["T_WHITESPACE"," ",384],["T_FUNCTION","function",384],["T_WHITESPACE"," ",384],["T_STRING","_checkLinkBetweenTagCustomerProduct",384],"(",["T_VARIABLE","$relationModel",384],")",["T_WHITESPACE","\n    ",384],"{",["T_WHITESPACE","\n        ",385],["T_RETURN","return",386],["T_WHITESPACE"," ",386],"(",["T_STRING","count",386],"(",["T_VARIABLE","$this",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","_getLinkBetweenTagCustomerProduct",386],"(",["T_VARIABLE","$relationModel",386],")",["T_OBJECT_OPERATOR","->",386],["T_STRING","getProductIds",386],"(",")",")",["T_WHITESPACE"," ",386],">",["T_WHITESPACE"," ",386],["T_LNUMBER","0",386],")",";",["T_WHITESPACE","\n    ",386],"}",["T_WHITESPACE","\n\n    ",387],["T_DOC_COMMENT","\/**\n     * Get relation model for product marked in store with tag by customer\n     *\n     * @param Mage_Tag_Model_Tag_Relation $relationModel\n     * @return Mage_Tag_Model_Tag_Relation\n     *\/",389],["T_WHITESPACE","\n    ",394],["T_PROTECTED","protected",395],["T_WHITESPACE"," ",395],["T_FUNCTION","function",395],["T_WHITESPACE"," ",395],["T_STRING","_getLinkBetweenTagCustomerProduct",395],"(",["T_VARIABLE","$relationModel",395],")",["T_WHITESPACE","\n    ",395],"{",["T_WHITESPACE","\n        ",396],["T_RETURN","return",397],["T_WHITESPACE"," ",397],["T_STRING","Mage",397],["T_DOUBLE_COLON","::",397],["T_STRING","getModel",397],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/tag_relation'",397],")",["T_OBJECT_OPERATOR","->",397],["T_STRING","loadByTagCustomer",397],"(",["T_WHITESPACE","\n            ",397],["T_VARIABLE","$relationModel",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","getProductId",398],"(",")",",",["T_WHITESPACE","\n            ",398],["T_VARIABLE","$this",399],["T_OBJECT_OPERATOR","->",399],["T_STRING","getId",399],"(",")",",",["T_WHITESPACE","\n            ",399],["T_VARIABLE","$relationModel",400],["T_OBJECT_OPERATOR","->",400],["T_STRING","getCustomerId",400],"(",")",",",["T_WHITESPACE","\n            ",400],["T_VARIABLE","$relationModel",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","getStoreId",401],"(",")",["T_WHITESPACE","\n        ",401],")",";",["T_WHITESPACE","\n    ",402],"}",["T_WHITESPACE","\n\n    ",403],["T_DOC_COMMENT","\/**\n     * Processing object after save data\n     *\n     * @return Mage_Core_Model_Abstract\n     *\/",405],["T_WHITESPACE","\n    ",409],["T_PROTECTED","protected",410],["T_WHITESPACE"," ",410],["T_FUNCTION","function",410],["T_WHITESPACE"," ",410],["T_STRING","_afterSave",410],"(",")",["T_WHITESPACE","\n    ",410],"{",["T_WHITESPACE","\n        ",411],["T_IF","if",412],["T_WHITESPACE"," ",412],"(",["T_VARIABLE","$this",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","hasData",412],"(",["T_CONSTANT_ENCAPSED_STRING","'tag_assigned_products'",412],")",")",["T_WHITESPACE"," ",412],"{",["T_WHITESPACE","\n            ",412],["T_VARIABLE","$tagRelationModel",413],["T_WHITESPACE"," ",413],"=",["T_WHITESPACE"," ",413],["T_STRING","Mage",413],["T_DOUBLE_COLON","::",413],["T_STRING","getModel",413],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/tag_relation'",413],")",";",["T_WHITESPACE","\n            ",413],["T_VARIABLE","$tagRelationModel",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","addRelations",414],"(",["T_VARIABLE","$this",414],",",["T_WHITESPACE"," ",414],["T_VARIABLE","$this",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","getData",414],"(",["T_CONSTANT_ENCAPSED_STRING","'tag_assigned_products'",414],")",")",";",["T_WHITESPACE","\n        ",414],"}",["T_WHITESPACE","\n\n        ",415],["T_RETURN","return",417],["T_WHITESPACE"," ",417],["T_STRING","parent",417],["T_DOUBLE_COLON","::",417],["T_STRING","_afterSave",417],"(",")",";",["T_WHITESPACE","\n    ",417],"}",["T_WHITESPACE","\n\n",418],"}",["T_WHITESPACE","\n",420]]