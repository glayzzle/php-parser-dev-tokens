[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Tag\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Customer tags controller\n *\n * @category   Mage\n * @package    Mage_Tag\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n\n",33],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Tag_CustomerController",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Controller_Front_Action",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_PROTECTED","protected",37],["T_WHITESPACE"," ",37],["T_FUNCTION","function",37],["T_WHITESPACE"," ",37],["T_STRING","_getTagId",37],"(",")",["T_WHITESPACE","\n    ",37],"{",["T_WHITESPACE","\n        ",38],["T_VARIABLE","$tagId",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_INT_CAST","(int)",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","getRequest",39],"(",")",["T_OBJECT_OPERATOR","->",39],["T_STRING","getParam",39],"(",["T_CONSTANT_ENCAPSED_STRING","'tagId'",39],")",";",["T_WHITESPACE","\n        ",39],["T_IF","if",40],["T_WHITESPACE"," ",40],"(",["T_VARIABLE","$tagId",40],")",["T_WHITESPACE"," ",40],"{",["T_WHITESPACE","\n            ",40],["T_VARIABLE","$customerId",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_STRING","Mage",41],["T_DOUBLE_COLON","::",41],["T_STRING","getSingleton",41],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",41],")",["T_OBJECT_OPERATOR","->",41],["T_STRING","getCustomerId",41],"(",")",";",["T_WHITESPACE","\n            ",41],["T_VARIABLE","$model",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_STRING","Mage",42],["T_DOUBLE_COLON","::",42],["T_STRING","getModel",42],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/tag_relation'",42],")",";",["T_WHITESPACE","\n            ",42],["T_VARIABLE","$model",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","loadByTagCustomer",43],"(",["T_STRING","null",43],",",["T_WHITESPACE"," ",43],["T_VARIABLE","$tagId",43],",",["T_WHITESPACE"," ",43],["T_VARIABLE","$customerId",43],")",";",["T_WHITESPACE","\n            ",43],["T_STRING","Mage",44],["T_DOUBLE_COLON","::",44],["T_STRING","register",44],"(",["T_CONSTANT_ENCAPSED_STRING","'tagModel'",44],",",["T_WHITESPACE"," ",44],["T_VARIABLE","$model",44],")",";",["T_WHITESPACE","\n            ",44],["T_RETURN","return",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$model",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","getTagId",45],"(",")",";",["T_WHITESPACE","\n        ",45],"}",["T_WHITESPACE","\n        ",46],["T_RETURN","return",47],["T_WHITESPACE"," ",47],["T_STRING","false",47],";",["T_WHITESPACE","\n    ",47],"}",["T_WHITESPACE","\n\n    ",48],["T_PUBLIC","public",50],["T_WHITESPACE"," ",50],["T_FUNCTION","function",50],["T_WHITESPACE"," ",50],["T_STRING","indexAction",50],"(",")",["T_WHITESPACE","\n    ",50],"{",["T_WHITESPACE","\n        ",51],["T_IF","if",52],"(",["T_WHITESPACE"," ",52],"!",["T_STRING","Mage",52],["T_DOUBLE_COLON","::",52],["T_STRING","getSingleton",52],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",52],")",["T_OBJECT_OPERATOR","->",52],["T_STRING","isLoggedIn",52],"(",")",["T_WHITESPACE"," ",52],")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n            ",52],["T_STRING","Mage",53],["T_DOUBLE_COLON","::",53],["T_STRING","getSingleton",53],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",53],")",["T_OBJECT_OPERATOR","->",53],["T_STRING","authenticate",53],"(",["T_VARIABLE","$this",53],")",";",["T_WHITESPACE","\n            ",53],["T_RETURN","return",54],";",["T_WHITESPACE","\n        ",54],"}",["T_WHITESPACE","\n\n        ",55],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","loadLayout",57],"(",")",";",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","_initLayoutMessages",58],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/session'",58],")",";",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","_initLayoutMessages",59],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/session'",59],")",";",["T_WHITESPACE","\n\n        ",59],["T_VARIABLE","$navigationBlock",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","getLayout",61],"(",")",["T_OBJECT_OPERATOR","->",61],["T_STRING","getBlock",61],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_account_navigation'",61],")",";",["T_WHITESPACE","\n        ",61],["T_IF","if",62],["T_WHITESPACE"," ",62],"(",["T_VARIABLE","$navigationBlock",62],")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n            ",62],["T_VARIABLE","$navigationBlock",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","setActive",63],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/customer'",63],")",";",["T_WHITESPACE","\n        ",63],"}",["T_WHITESPACE","\n\n        ",64],["T_VARIABLE","$block",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getLayout",66],"(",")",["T_OBJECT_OPERATOR","->",66],["T_STRING","getBlock",66],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_tags'",66],")",";",["T_WHITESPACE","\n        ",66],["T_IF","if",67],["T_WHITESPACE"," ",67],"(",["T_VARIABLE","$block",67],")",["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n            ",67],["T_VARIABLE","$block",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","setRefererUrl",68],"(",["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","_getRefererUrl",68],"(",")",")",";",["T_WHITESPACE","\n        ",68],"}",["T_WHITESPACE","\n\n        ",69],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getLayout",71],"(",")",["T_OBJECT_OPERATOR","->",71],["T_STRING","getBlock",71],"(",["T_CONSTANT_ENCAPSED_STRING","'head'",71],")",["T_OBJECT_OPERATOR","->",71],["T_STRING","setTitle",71],"(",["T_STRING","Mage",71],["T_DOUBLE_COLON","::",71],["T_STRING","helper",71],"(",["T_CONSTANT_ENCAPSED_STRING","'tag'",71],")",["T_OBJECT_OPERATOR","->",71],["T_STRING","__",71],"(",["T_CONSTANT_ENCAPSED_STRING","'My Tags'",71],")",")",";",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","renderLayout",72],"(",")",";",["T_WHITESPACE","\n    ",72],"}",["T_WHITESPACE","\n\n    ",73],["T_PUBLIC","public",75],["T_WHITESPACE"," ",75],["T_FUNCTION","function",75],["T_WHITESPACE"," ",75],["T_STRING","viewAction",75],"(",")",["T_WHITESPACE","\n    ",75],"{",["T_WHITESPACE","\n        ",76],["T_IF","if",77],"(",["T_WHITESPACE"," ",77],"!",["T_STRING","Mage",77],["T_DOUBLE_COLON","::",77],["T_STRING","getSingleton",77],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",77],")",["T_OBJECT_OPERATOR","->",77],["T_STRING","isLoggedIn",77],"(",")",["T_WHITESPACE"," ",77],")",["T_WHITESPACE"," ",77],"{",["T_WHITESPACE","\n            ",77],["T_STRING","Mage",78],["T_DOUBLE_COLON","::",78],["T_STRING","getSingleton",78],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",78],")",["T_OBJECT_OPERATOR","->",78],["T_STRING","authenticate",78],"(",["T_VARIABLE","$this",78],")",";",["T_WHITESPACE","\n            ",78],["T_RETURN","return",79],";",["T_WHITESPACE","\n        ",79],"}",["T_WHITESPACE","\n\n        ",80],["T_VARIABLE","$tagId",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","_getTagId",82],"(",")",";",["T_WHITESPACE","\n        ",82],["T_IF","if",83],["T_WHITESPACE"," ",83],"(",["T_VARIABLE","$tagId",83],")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n            ",83],["T_STRING","Mage",84],["T_DOUBLE_COLON","::",84],["T_STRING","register",84],"(",["T_CONSTANT_ENCAPSED_STRING","'tagId'",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$tagId",84],")",";",["T_WHITESPACE","\n            ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","loadLayout",85],"(",")",";",["T_WHITESPACE","\n            ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","_initLayoutMessages",86],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/session'",86],")",";",["T_WHITESPACE","\n\n            ",86],["T_VARIABLE","$navigationBlock",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","getLayout",88],"(",")",["T_OBJECT_OPERATOR","->",88],["T_STRING","getBlock",88],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_account_navigation'",88],")",";",["T_WHITESPACE","\n            ",88],["T_IF","if",89],["T_WHITESPACE"," ",89],"(",["T_VARIABLE","$navigationBlock",89],")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n                ",89],["T_VARIABLE","$navigationBlock",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","setActive",90],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/customer'",90],")",";",["T_WHITESPACE","\n            ",90],"}",["T_WHITESPACE","\n\n            ",91],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","_initLayoutMessages",93],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/session'",93],")",";",["T_WHITESPACE","\n            ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getLayout",94],"(",")",["T_OBJECT_OPERATOR","->",94],["T_STRING","getBlock",94],"(",["T_CONSTANT_ENCAPSED_STRING","'head'",94],")",["T_OBJECT_OPERATOR","->",94],["T_STRING","setTitle",94],"(",["T_STRING","Mage",94],["T_DOUBLE_COLON","::",94],["T_STRING","helper",94],"(",["T_CONSTANT_ENCAPSED_STRING","'tag'",94],")",["T_OBJECT_OPERATOR","->",94],["T_STRING","__",94],"(",["T_CONSTANT_ENCAPSED_STRING","'My Tags'",94],")",")",";",["T_WHITESPACE","\n            ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","renderLayout",95],"(",")",";",["T_WHITESPACE","\n        ",95],"}",["T_WHITESPACE","\n        ",96],["T_ELSE","else",97],["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n            ",97],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","_forward",98],"(",["T_CONSTANT_ENCAPSED_STRING","'noRoute'",98],")",";",["T_WHITESPACE","\n        ",98],"}",["T_WHITESPACE","\n    ",99],"}",["T_WHITESPACE","\n\n    ",100],["T_DOC_COMMENT","\/**\n     * @deprecated after 1.3.2.3\n     * This functionality was removed\n     *\n     *\/",102],["T_WHITESPACE","\n    ",106],["T_PUBLIC","public",107],["T_WHITESPACE"," ",107],["T_FUNCTION","function",107],["T_WHITESPACE"," ",107],["T_STRING","editAction",107],"(",")",["T_WHITESPACE","\n    ",107],"{",["T_WHITESPACE","\n        ",108],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","_forward",109],"(",["T_CONSTANT_ENCAPSED_STRING","'noRoute'",109],")",";",["T_WHITESPACE","\n    ",109],"}",["T_WHITESPACE","\n\n    ",110],["T_PUBLIC","public",112],["T_WHITESPACE"," ",112],["T_FUNCTION","function",112],["T_WHITESPACE"," ",112],["T_STRING","removeAction",112],"(",")",["T_WHITESPACE","\n    ",112],"{",["T_WHITESPACE","\n        ",113],["T_IF","if",114],"(",["T_WHITESPACE"," ",114],"!",["T_STRING","Mage",114],["T_DOUBLE_COLON","::",114],["T_STRING","getSingleton",114],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",114],")",["T_OBJECT_OPERATOR","->",114],["T_STRING","isLoggedIn",114],"(",")",["T_WHITESPACE"," ",114],")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n            ",114],["T_STRING","Mage",115],["T_DOUBLE_COLON","::",115],["T_STRING","getSingleton",115],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",115],")",["T_OBJECT_OPERATOR","->",115],["T_STRING","authenticate",115],"(",["T_VARIABLE","$this",115],")",";",["T_WHITESPACE","\n            ",115],["T_RETURN","return",116],";",["T_WHITESPACE","\n        ",116],"}",["T_WHITESPACE","\n\n        ",117],["T_VARIABLE","$tagId",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_getTagId",119],"(",")",";",["T_WHITESPACE","\n        ",119],["T_IF","if",120],["T_WHITESPACE"," ",120],"(",["T_VARIABLE","$tagId",120],")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n            ",120],["T_TRY","try",121],["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n                ",121],["T_VARIABLE","$model",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_STRING","Mage",122],["T_DOUBLE_COLON","::",122],["T_STRING","registry",122],"(",["T_CONSTANT_ENCAPSED_STRING","'tagModel'",122],")",";",["T_WHITESPACE","\n                ",122],["T_VARIABLE","$model",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","deactivate",123],"(",")",";",["T_WHITESPACE","\n                ",123],["T_VARIABLE","$tag",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_STRING","Mage",124],["T_DOUBLE_COLON","::",124],["T_STRING","getModel",124],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/tag'",124],")",["T_OBJECT_OPERATOR","->",124],["T_STRING","load",124],"(",["T_VARIABLE","$tagId",124],")",["T_OBJECT_OPERATOR","->",124],["T_STRING","aggregate",124],"(",")",";",["T_WHITESPACE","\n                ",124],["T_STRING","Mage",125],["T_DOUBLE_COLON","::",125],["T_STRING","getSingleton",125],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/session'",125],")",["T_OBJECT_OPERATOR","->",125],["T_STRING","addSuccess",125],"(",["T_STRING","Mage",125],["T_DOUBLE_COLON","::",125],["T_STRING","helper",125],"(",["T_CONSTANT_ENCAPSED_STRING","'tag'",125],")",["T_OBJECT_OPERATOR","->",125],["T_STRING","__",125],"(",["T_CONSTANT_ENCAPSED_STRING","'The tag has been deleted.'",125],")",")",";",["T_WHITESPACE","\n                ",125],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getResponse",126],"(",")",["T_OBJECT_OPERATOR","->",126],["T_STRING","setRedirect",126],"(",["T_STRING","Mage",126],["T_DOUBLE_COLON","::",126],["T_STRING","getUrl",126],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/'",126],",",["T_WHITESPACE"," ",126],["T_ARRAY","array",126],"(",["T_WHITESPACE","\n                    ",126],["T_STRING","self",127],["T_DOUBLE_COLON","::",127],["T_STRING","PARAM_NAME_URL_ENCODED",127],["T_WHITESPACE"," ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],["T_STRING","Mage",127],["T_DOUBLE_COLON","::",127],["T_STRING","helper",127],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",127],")",["T_OBJECT_OPERATOR","->",127],["T_STRING","urlEncode",127],"(",["T_STRING","Mage",127],["T_DOUBLE_COLON","::",127],["T_STRING","getUrl",127],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/account\/'",127],")",")",["T_WHITESPACE","\n                ",127],")",")",")",";",["T_WHITESPACE","\n                ",128],["T_RETURN","return",129],";",["T_WHITESPACE","\n            ",129],"}",["T_WHITESPACE"," ",130],["T_CATCH","catch",130],["T_WHITESPACE"," ",130],"(",["T_STRING","Exception",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$e",130],")",["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n                ",130],["T_STRING","Mage",131],["T_DOUBLE_COLON","::",131],["T_STRING","getSingleton",131],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/session'",131],")",["T_OBJECT_OPERATOR","->",131],["T_STRING","addError",131],"(",["T_STRING","Mage",131],["T_DOUBLE_COLON","::",131],["T_STRING","helper",131],"(",["T_CONSTANT_ENCAPSED_STRING","'tag'",131],")",["T_OBJECT_OPERATOR","->",131],["T_STRING","__",131],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to remove tag. Please, try again later.'",131],")",")",";",["T_WHITESPACE","\n            ",131],"}",["T_WHITESPACE","\n        ",132],"}",["T_WHITESPACE","\n        ",133],["T_ELSE","else",134],["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n            ",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","_forward",135],"(",["T_CONSTANT_ENCAPSED_STRING","'noRoute'",135],")",";",["T_WHITESPACE","\n        ",135],"}",["T_WHITESPACE","\n    ",136],"}",["T_WHITESPACE","\n\n    ",137],["T_DOC_COMMENT","\/**\n     * @deprecated after 1.3.2.3\n     * This functionality was removed\n     *\n     *\/",139],["T_WHITESPACE","\n    ",143],["T_PUBLIC","public",144],["T_WHITESPACE"," ",144],["T_FUNCTION","function",144],["T_WHITESPACE"," ",144],["T_STRING","saveAction",144],"(",")",["T_WHITESPACE","\n    ",144],"{",["T_WHITESPACE","\n        ",145],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","_forward",146],"(",["T_CONSTANT_ENCAPSED_STRING","'noRoute'",146],")",";",["T_WHITESPACE","\n    ",146],"}",["T_WHITESPACE","\n",147],"}",["T_WHITESPACE","\n",148]]