[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Tag\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Tag collection model\n *\n * @category    Mage\n * @package     Mage_Tag\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Tag_Model_Resource_Tag_Collection",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Model_Resource_Db_Collection_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Use getFlag('store_filter') & setFlag('store_filter', true) instead.\n     *\n     * @var bool\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_isStoreFilter",42],["T_WHITESPACE","  ",42],"=",["T_WHITESPACE"," ",42],["T_STRING","false",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Joined tables\n     *\n     * @var array\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_joinFlags",49],["T_WHITESPACE","      ",49],"=",["T_WHITESPACE"," ",49],["T_ARRAY","array",49],"(",")",";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Mapping for fields\n     *\n     * @var array\n     *\/",51],["T_WHITESPACE","\n    ",55],["T_PUBLIC","public",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$_map",56],["T_WHITESPACE","               ",56],"=",["T_WHITESPACE"," ",56],["T_ARRAY","array",56],"(",["T_WHITESPACE","\n        ",56],["T_CONSTANT_ENCAPSED_STRING","'fields'",57],["T_WHITESPACE"," ",57],["T_DOUBLE_ARROW","=>",57],["T_WHITESPACE"," ",57],["T_ARRAY","array",57],"(",["T_WHITESPACE","\n            ",57],["T_CONSTANT_ENCAPSED_STRING","'tag_id'",58],["T_WHITESPACE"," ",58],["T_DOUBLE_ARROW","=>",58],["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'main_table.tag_id'",58],["T_WHITESPACE","\n        ",58],")",",",["T_WHITESPACE","\n    ",59],")",";",["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * Define resource model and model\n     *\n     *\/",62],["T_WHITESPACE","\n    ",65],["T_PROTECTED","protected",66],["T_WHITESPACE"," ",66],["T_FUNCTION","function",66],["T_WHITESPACE"," ",66],["T_STRING","_construct",66],"(",")",["T_WHITESPACE","\n    ",66],"{",["T_WHITESPACE","\n        ",67],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","_init",68],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/tag'",68],")",";",["T_WHITESPACE","\n    ",68],"}",["T_WHITESPACE","\n\n    ",69],["T_DOC_COMMENT","\/**\n     * Loads collection\n     *\n     * @param bool $printQuery\n     * @param bool $logQuery\n     * @return Mage_Tag_Model_Resource_Tag_Collection\n     *\/",71],["T_WHITESPACE","\n    ",77],["T_PUBLIC","public",78],["T_WHITESPACE"," ",78],["T_FUNCTION","function",78],["T_WHITESPACE"," ",78],["T_STRING","load",78],"(",["T_VARIABLE","$printQuery",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_STRING","false",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$logQuery",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_STRING","false",78],")",["T_WHITESPACE","\n    ",78],"{",["T_WHITESPACE","\n        ",79],["T_IF","if",80],["T_WHITESPACE"," ",80],"(",["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","isLoaded",80],"(",")",")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n            ",80],["T_RETURN","return",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],";",["T_WHITESPACE","\n        ",81],"}",["T_WHITESPACE","\n        ",82],["T_STRING","parent",83],["T_DOUBLE_COLON","::",83],["T_STRING","load",83],"(",["T_VARIABLE","$printQuery",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$logQuery",83],")",";",["T_WHITESPACE","\n        ",83],["T_IF","if",84],["T_WHITESPACE"," ",84],"(",["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getFlag",84],"(",["T_CONSTANT_ENCAPSED_STRING","'add_stores_after'",84],")",")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n            ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","_addStoresVisibility",85],"(",")",";",["T_WHITESPACE","\n        ",85],"}",["T_WHITESPACE","\n        ",86],["T_RETURN","return",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n\n    ",88],["T_DOC_COMMENT","\/**\n     * Set flag about joined table.\n     * setFlag method must be used in future.\n     *\n     * @deprecated after 1.3.2.3\n     *\n     * @param string $table\n     * @return Mage_Tag_Model_Resource_Tag_Collection\n     *\/",90],["T_WHITESPACE","\n    ",98],["T_PUBLIC","public",99],["T_WHITESPACE"," ",99],["T_FUNCTION","function",99],["T_WHITESPACE"," ",99],["T_STRING","setJoinFlag",99],"(",["T_VARIABLE","$table",99],")",["T_WHITESPACE","\n    ",99],"{",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","setFlag",101],"(",["T_VARIABLE","$table",101],",",["T_WHITESPACE"," ",101],["T_STRING","true",101],")",";",["T_WHITESPACE","\n        ",101],["T_RETURN","return",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],";",["T_WHITESPACE","\n    ",102],"}",["T_WHITESPACE","\n\n    ",103],["T_DOC_COMMENT","\/**\n     * Get flag's status about joined table.\n     * getFlag method must be used in future.\n     *\n     * @deprecated after 1.3.2.3\n     *\n     * @param string $table\n     * @return bool\n     *\/",105],["T_WHITESPACE","\n    ",113],["T_PUBLIC","public",114],["T_WHITESPACE"," ",114],["T_FUNCTION","function",114],["T_WHITESPACE"," ",114],["T_STRING","getJoinFlag",114],"(",["T_VARIABLE","$table",114],")",["T_WHITESPACE","\n    ",114],"{",["T_WHITESPACE","\n        ",115],["T_RETURN","return",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getFlag",116],"(",["T_VARIABLE","$table",116],")",";",["T_WHITESPACE","\n    ",116],"}",["T_WHITESPACE","\n\n    ",117],["T_DOC_COMMENT","\/**\n     * Unset value of join flag.\n     * Set false (bool) value to flag instead in future.\n     *\n     * @deprecated after 1.3.2.3\n     *\n     * @param string $table\n     * @return Mage_Tag_Model_Resource_Tag_Collection\n     *\/",119],["T_WHITESPACE","\n    ",127],["T_PUBLIC","public",128],["T_WHITESPACE"," ",128],["T_FUNCTION","function",128],["T_WHITESPACE"," ",128],["T_STRING","unsetJoinFlag",128],"(",["T_VARIABLE","$table",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_STRING","null",128],")",["T_WHITESPACE","\n    ",128],"{",["T_WHITESPACE","\n        ",129],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","setFlag",130],"(",["T_VARIABLE","$table",130],",",["T_WHITESPACE"," ",130],["T_STRING","false",130],")",";",["T_WHITESPACE","\n        ",130],["T_RETURN","return",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],";",["T_WHITESPACE","\n    ",131],"}",["T_WHITESPACE","\n\n    ",132],["T_DOC_COMMENT","\/**\n     * Sett\n     *\n     * @param int $limit\n     * @return Mage_Tag_Model_Resource_Tag_Collection\n     *\/",134],["T_WHITESPACE","\n    ",139],["T_PUBLIC","public",140],["T_WHITESPACE"," ",140],["T_FUNCTION","function",140],["T_WHITESPACE"," ",140],["T_STRING","limit",140],"(",["T_VARIABLE","$limit",140],")",["T_WHITESPACE","\n    ",140],"{",["T_WHITESPACE","\n        ",141],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","getSelect",142],"(",")",["T_OBJECT_OPERATOR","->",142],["T_STRING","limit",142],"(",["T_VARIABLE","$limit",142],")",";",["T_WHITESPACE","\n        ",142],["T_RETURN","return",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],";",["T_WHITESPACE","\n    ",143],"}",["T_WHITESPACE","\n\n    ",144],["T_DOC_COMMENT","\/**\n     * Replacing popularity by sum of popularity and base_popularity\n     *\n     * @param int $limit\n     * @return Mage_Tag_Model_Resource_Tag_Collection\n     *\/",146],["T_WHITESPACE","\n    ",151],["T_PUBLIC","public",152],["T_WHITESPACE"," ",152],["T_FUNCTION","function",152],["T_WHITESPACE"," ",152],["T_STRING","addPopularity",152],"(",["T_VARIABLE","$limit",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_STRING","null",152],")",["T_WHITESPACE","\n    ",152],"{",["T_WHITESPACE","\n        ",153],["T_IF","if",154],["T_WHITESPACE"," ",154],"(","!",["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","getFlag",154],"(",["T_CONSTANT_ENCAPSED_STRING","'popularity'",154],")",")",["T_WHITESPACE"," ",154],"{",["T_WHITESPACE","\n            ",154],["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","getSelect",155],"(",")",["T_WHITESPACE","\n            ",155],["T_OBJECT_OPERATOR","->",156],["T_STRING","joinLeft",156],"(",["T_WHITESPACE","\n                ",156],["T_ARRAY","array",157],"(",["T_CONSTANT_ENCAPSED_STRING","'relation'",157],["T_WHITESPACE"," ",157],["T_DOUBLE_ARROW","=>",157],["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","getTable",157],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/relation'",157],")",")",",",["T_WHITESPACE","\n                ",157],["T_CONSTANT_ENCAPSED_STRING","'main_table.tag_id = relation.tag_id'",158],",",["T_WHITESPACE","\n                ",158],["T_ARRAY","array",159],"(",")",["T_WHITESPACE","\n            ",159],")",["T_WHITESPACE","\n            ",160],["T_OBJECT_OPERATOR","->",161],["T_STRING","joinLeft",161],"(",["T_WHITESPACE","\n                ",161],["T_ARRAY","array",162],"(",["T_CONSTANT_ENCAPSED_STRING","'summary'",162],["T_WHITESPACE"," ",162],["T_DOUBLE_ARROW","=>",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","getTable",162],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/summary'",162],")",")",",",["T_WHITESPACE","\n                ",162],["T_CONSTANT_ENCAPSED_STRING","'relation.tag_id = summary.tag_id AND relation.store_id = summary.store_id'",163],",",["T_WHITESPACE","\n                ",163],["T_ARRAY","array",164],"(",["T_CONSTANT_ENCAPSED_STRING","'popularity'",164],")",["T_WHITESPACE","\n            ",164],")",["T_WHITESPACE","\n            ",165],["T_OBJECT_OPERATOR","->",166],["T_STRING","group",166],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.tag_id'",166],")",";",["T_WHITESPACE","\n\n            ",166],["T_COMMENT","\/*\n             * Allow analytic function usage\n             *\/",168],["T_WHITESPACE","\n            ",170],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","_useAnalyticFunction",171],["T_WHITESPACE"," ",171],"=",["T_WHITESPACE"," ",171],["T_STRING","true",171],";",["T_WHITESPACE","\n\n            ",171],["T_IF","if",173],["T_WHITESPACE"," ",173],"(","!",["T_STRING","is_null",173],"(",["T_VARIABLE","$limit",173],")",")",["T_WHITESPACE"," ",173],"{",["T_WHITESPACE","\n                ",173],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","getSelect",174],"(",")",["T_OBJECT_OPERATOR","->",174],["T_STRING","limit",174],"(",["T_VARIABLE","$limit",174],")",";",["T_WHITESPACE","\n            ",174],"}",["T_WHITESPACE","\n\n            ",175],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","setFlag",177],"(",["T_CONSTANT_ENCAPSED_STRING","'popularity'",177],")",";",["T_WHITESPACE","\n        ",177],"}",["T_WHITESPACE","\n        ",178],["T_RETURN","return",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],";",["T_WHITESPACE","\n    ",179],"}",["T_WHITESPACE","\n\n    ",180],["T_DOC_COMMENT","\/**\n     * Adds summary\n     *\n     * @param int $storeId\n     * @return Mage_Tag_Model_Resource_Tag_Collection\n     *\/",182],["T_WHITESPACE","\n    ",187],["T_PUBLIC","public",188],["T_WHITESPACE"," ",188],["T_FUNCTION","function",188],["T_WHITESPACE"," ",188],["T_STRING","addSummary",188],"(",["T_VARIABLE","$storeId",188],")",["T_WHITESPACE","\n    ",188],"{",["T_WHITESPACE","\n        ",189],["T_IF","if",190],["T_WHITESPACE"," ",190],"(","!",["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","getFlag",190],"(",["T_CONSTANT_ENCAPSED_STRING","'summary'",190],")",")",["T_WHITESPACE"," ",190],"{",["T_WHITESPACE","\n            ",190],["T_VARIABLE","$tableAlias",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_CONSTANT_ENCAPSED_STRING","'summary'",191],";",["T_WHITESPACE","\n            ",191],["T_VARIABLE","$joinCondition",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","getConnection",192],"(",")",["T_WHITESPACE","\n                    ",192],["T_OBJECT_OPERATOR","->",193],["T_STRING","quoteInto",193],"(",["T_CONSTANT_ENCAPSED_STRING","' AND '",193],["T_WHITESPACE"," ",193],".",["T_WHITESPACE"," ",193],["T_VARIABLE","$tableAlias",193],["T_WHITESPACE"," ",193],".",["T_WHITESPACE"," ",193],["T_CONSTANT_ENCAPSED_STRING","'.store_id IN(?)'",193],",",["T_WHITESPACE"," ",193],["T_VARIABLE","$storeId",193],")",";",["T_WHITESPACE","\n\n            ",193],["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","getSelect",195],"(",")",["T_WHITESPACE","\n                ",195],["T_OBJECT_OPERATOR","->",196],["T_STRING","joinLeft",196],"(",["T_WHITESPACE","\n                    ",196],["T_ARRAY","array",197],"(",["T_VARIABLE","$tableAlias",197],["T_WHITESPACE"," ",197],["T_DOUBLE_ARROW","=>",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","getTable",197],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/summary'",197],")",")",",",["T_WHITESPACE","\n                    ",197],["T_CONSTANT_ENCAPSED_STRING","'main_table.tag_id = '",198],["T_WHITESPACE"," ",198],".",["T_WHITESPACE"," ",198],["T_VARIABLE","$tableAlias",198],["T_WHITESPACE"," ",198],".",["T_WHITESPACE"," ",198],["T_CONSTANT_ENCAPSED_STRING","'.tag_id'",198],["T_WHITESPACE"," ",198],".",["T_WHITESPACE"," ",198],["T_VARIABLE","$joinCondition",198],",",["T_WHITESPACE","\n                    ",198],["T_ARRAY","array",199],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id'",199],",",["T_CONSTANT_ENCAPSED_STRING","'popularity'",199],",",["T_WHITESPACE"," ",199],["T_CONSTANT_ENCAPSED_STRING","'customers'",199],",",["T_WHITESPACE"," ",199],["T_CONSTANT_ENCAPSED_STRING","'products'",199],["T_WHITESPACE","\n                ",199],")",")",";",["T_WHITESPACE","\n\n            ",200],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","addFilterToMap",202],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id'",202],",",["T_WHITESPACE"," ",202],["T_VARIABLE","$tableAlias",202],["T_WHITESPACE"," ",202],".",["T_WHITESPACE"," ",202],["T_CONSTANT_ENCAPSED_STRING","'.store_id'",202],")",";",["T_WHITESPACE","\n            ",202],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","addFilterToMap",203],"(",["T_CONSTANT_ENCAPSED_STRING","'popularity'",203],",",["T_WHITESPACE"," ",203],["T_VARIABLE","$tableAlias",203],["T_WHITESPACE"," ",203],".",["T_WHITESPACE"," ",203],["T_CONSTANT_ENCAPSED_STRING","'.popularity'",203],")",";",["T_WHITESPACE","\n            ",203],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","addFilterToMap",204],"(",["T_CONSTANT_ENCAPSED_STRING","'customers'",204],",",["T_WHITESPACE"," ",204],["T_VARIABLE","$tableAlias",204],["T_WHITESPACE"," ",204],".",["T_WHITESPACE"," ",204],["T_CONSTANT_ENCAPSED_STRING","'.customers'",204],")",";",["T_WHITESPACE","\n            ",204],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","addFilterToMap",205],"(",["T_CONSTANT_ENCAPSED_STRING","'products'",205],",",["T_WHITESPACE"," ",205],["T_VARIABLE","$tableAlias",205],["T_WHITESPACE"," ",205],".",["T_WHITESPACE"," ",205],["T_CONSTANT_ENCAPSED_STRING","'.products'",205],")",";",["T_WHITESPACE","\n\n            ",205],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","setFlag",207],"(",["T_CONSTANT_ENCAPSED_STRING","'summary'",207],",",["T_WHITESPACE"," ",207],["T_STRING","true",207],")",";",["T_WHITESPACE","\n        ",207],"}",["T_WHITESPACE","\n        ",208],["T_RETURN","return",209],["T_WHITESPACE"," ",209],["T_VARIABLE","$this",209],";",["T_WHITESPACE","\n    ",209],"}",["T_WHITESPACE","\n\n    ",210],["T_DOC_COMMENT","\/**\n     * Adds store visibility\n     *\n     * @return Mage_Tag_Model_Resource_Tag_Collection\n     *\/",212],["T_WHITESPACE","\n    ",216],["T_PUBLIC","public",217],["T_WHITESPACE"," ",217],["T_FUNCTION","function",217],["T_WHITESPACE"," ",217],["T_STRING","addStoresVisibility",217],"(",")",["T_WHITESPACE","\n    ",217],"{",["T_WHITESPACE","\n        ",218],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","setFlag",219],"(",["T_CONSTANT_ENCAPSED_STRING","'add_stores_after'",219],",",["T_WHITESPACE"," ",219],["T_STRING","true",219],")",";",["T_WHITESPACE","\n        ",219],["T_RETURN","return",220],["T_WHITESPACE"," ",220],["T_VARIABLE","$this",220],";",["T_WHITESPACE","\n    ",220],"}",["T_WHITESPACE","\n\n    ",221],["T_DOC_COMMENT","\/**\n     * Adds store visibility\n     *\n     * @return Mage_Tag_Model_Resource_Tag_Collection\n     *\/",223],["T_WHITESPACE","\n    ",227],["T_PROTECTED","protected",228],["T_WHITESPACE"," ",228],["T_FUNCTION","function",228],["T_WHITESPACE"," ",228],["T_STRING","_addStoresVisibility",228],"(",")",["T_WHITESPACE","\n    ",228],"{",["T_WHITESPACE","\n        ",229],["T_VARIABLE","$tagIds",230],["T_WHITESPACE"," ",230],"=",["T_WHITESPACE"," ",230],["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","getColumnValues",230],"(",["T_CONSTANT_ENCAPSED_STRING","'tag_id'",230],")",";",["T_WHITESPACE","\n\n        ",230],["T_VARIABLE","$tagsStores",232],["T_WHITESPACE"," ",232],"=",["T_WHITESPACE"," ",232],["T_ARRAY","array",232],"(",")",";",["T_WHITESPACE","\n        ",232],["T_IF","if",233],["T_WHITESPACE"," ",233],"(",["T_STRING","sizeof",233],"(",["T_VARIABLE","$tagIds",233],")",["T_WHITESPACE"," ",233],">",["T_WHITESPACE"," ",233],["T_LNUMBER","0",233],")",["T_WHITESPACE"," ",233],"{",["T_WHITESPACE","\n            ",233],["T_VARIABLE","$select",234],["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","getConnection",234],"(",")",["T_OBJECT_OPERATOR","->",234],["T_STRING","select",234],"(",")",["T_WHITESPACE","\n                ",234],["T_OBJECT_OPERATOR","->",235],["T_STRING","from",235],"(",["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","getTable",235],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/summary'",235],")",",",["T_WHITESPACE"," ",235],["T_ARRAY","array",235],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id'",235],",",["T_WHITESPACE"," ",235],["T_CONSTANT_ENCAPSED_STRING","'tag_id'",235],")",")",["T_WHITESPACE","\n                ",235],["T_OBJECT_OPERATOR","->",236],["T_STRING","where",236],"(",["T_CONSTANT_ENCAPSED_STRING","'tag_id IN(?)'",236],",",["T_WHITESPACE"," ",236],["T_VARIABLE","$tagIds",236],")",";",["T_WHITESPACE","\n            ",236],["T_VARIABLE","$tagsRaw",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","getConnection",237],"(",")",["T_OBJECT_OPERATOR","->",237],["T_STRING","fetchAll",237],"(",["T_VARIABLE","$select",237],")",";",["T_WHITESPACE","\n\n            ",237],["T_FOREACH","foreach",239],["T_WHITESPACE"," ",239],"(",["T_VARIABLE","$tagsRaw",239],["T_WHITESPACE"," ",239],["T_AS","as",239],["T_WHITESPACE"," ",239],["T_VARIABLE","$tag",239],")",["T_WHITESPACE"," ",239],"{",["T_WHITESPACE","\n                ",239],["T_IF","if",240],["T_WHITESPACE"," ",240],"(","!",["T_ISSET","isset",240],"(",["T_VARIABLE","$tagsStores",240],"[",["T_VARIABLE","$tag",240],"[",["T_CONSTANT_ENCAPSED_STRING","'tag_id'",240],"]","]",")",")",["T_WHITESPACE"," ",240],"{",["T_WHITESPACE","\n                    ",240],["T_VARIABLE","$tagsStores",241],"[",["T_VARIABLE","$tag",241],"[",["T_CONSTANT_ENCAPSED_STRING","'tag_id'",241],"]","]",["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_ARRAY","array",241],"(",")",";",["T_WHITESPACE","\n                ",241],"}",["T_WHITESPACE","\n\n                ",242],["T_VARIABLE","$tagsStores",244],"[",["T_VARIABLE","$tag",244],"[",["T_CONSTANT_ENCAPSED_STRING","'tag_id'",244],"]","]","[","]",["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_VARIABLE","$tag",244],"[",["T_CONSTANT_ENCAPSED_STRING","'store_id'",244],"]",";",["T_WHITESPACE","\n            ",244],"}",["T_WHITESPACE","\n        ",245],"}",["T_WHITESPACE","\n\n        ",246],["T_FOREACH","foreach",248],["T_WHITESPACE"," ",248],"(",["T_VARIABLE","$this",248],["T_WHITESPACE"," ",248],["T_AS","as",248],["T_WHITESPACE"," ",248],["T_VARIABLE","$item",248],")",["T_WHITESPACE"," ",248],"{",["T_WHITESPACE","\n            ",248],["T_IF","if",249],["T_WHITESPACE"," ",249],"(",["T_ISSET","isset",249],"(",["T_VARIABLE","$tagsStores",249],"[",["T_VARIABLE","$item",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","getId",249],"(",")","]",")",")",["T_WHITESPACE"," ",249],"{",["T_WHITESPACE","\n                ",249],["T_VARIABLE","$item",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","setStores",250],"(",["T_VARIABLE","$tagsStores",250],"[",["T_VARIABLE","$item",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","getId",250],"(",")","]",")",";",["T_WHITESPACE","\n            ",250],"}",["T_WHITESPACE"," ",251],["T_ELSE","else",251],["T_WHITESPACE"," ",251],"{",["T_WHITESPACE","\n                ",251],["T_VARIABLE","$item",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","setStores",252],"(",["T_ARRAY","array",252],"(",")",")",";",["T_WHITESPACE","\n            ",252],"}",["T_WHITESPACE","\n        ",253],"}",["T_WHITESPACE","\n\n        ",254],["T_RETURN","return",256],["T_WHITESPACE"," ",256],["T_VARIABLE","$this",256],";",["T_WHITESPACE","\n    ",256],"}",["T_WHITESPACE","\n\n    ",257],["T_DOC_COMMENT","\/**\n     * Adds field to filter\n     *\n     * @param string $field\n     * @param array $condition\n     * @return Mage_Tag_Model_Resource_Tag_Collection\n     *\/",259],["T_WHITESPACE","\n    ",265],["T_PUBLIC","public",266],["T_WHITESPACE"," ",266],["T_FUNCTION","function",266],["T_WHITESPACE"," ",266],["T_STRING","addFieldToFilter",266],"(",["T_VARIABLE","$field",266],",",["T_WHITESPACE"," ",266],["T_VARIABLE","$condition",266],["T_WHITESPACE"," ",266],"=",["T_WHITESPACE"," ",266],["T_STRING","null",266],")",["T_WHITESPACE","\n    ",266],"{",["T_WHITESPACE","\n        ",267],["T_IF","if",268],["T_WHITESPACE"," ",268],"(",["T_VARIABLE","$this",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","getFlag",268],"(",["T_CONSTANT_ENCAPSED_STRING","'relation'",268],")",["T_WHITESPACE"," ",268],["T_BOOLEAN_AND","&&",268],["T_WHITESPACE"," ",268],["T_CONSTANT_ENCAPSED_STRING","'popularity'",268],["T_WHITESPACE"," ",268],["T_IS_EQUAL","==",268],["T_WHITESPACE"," ",268],["T_VARIABLE","$field",268],")",["T_WHITESPACE"," ",268],"{",["T_WHITESPACE","\n            ",268],["T_COMMENT","\/\/ TOFIX\n",269],["T_WHITESPACE","            ",270],["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","getSelect",270],"(",")",["T_OBJECT_OPERATOR","->",270],["T_STRING","having",270],"(",["T_WHITESPACE","\n                ",270],["T_VARIABLE","$this",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","_getConditionSql",271],"(",["T_CONSTANT_ENCAPSED_STRING","'COUNT(relation.tag_relation_id)'",271],",",["T_WHITESPACE"," ",271],["T_VARIABLE","$condition",271],")",["T_WHITESPACE","\n            ",271],")",";",["T_WHITESPACE","\n        ",272],"}",["T_WHITESPACE"," ",273],["T_ELSEIF","elseif",273],["T_WHITESPACE"," ",273],"(",["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","getFlag",273],"(",["T_CONSTANT_ENCAPSED_STRING","'summary'",273],")",["T_WHITESPACE"," ",273],["T_BOOLEAN_AND","&&",273],["T_WHITESPACE"," ",273],["T_STRING","in_array",273],"(",["T_WHITESPACE","\n            ",273],["T_VARIABLE","$field",274],",",["T_WHITESPACE"," ",274],["T_ARRAY","array",274],"(",["T_CONSTANT_ENCAPSED_STRING","'customers'",274],",",["T_WHITESPACE"," ",274],["T_CONSTANT_ENCAPSED_STRING","'products'",274],",",["T_WHITESPACE"," ",274],["T_CONSTANT_ENCAPSED_STRING","'uses'",274],",",["T_WHITESPACE"," ",274],["T_CONSTANT_ENCAPSED_STRING","'historical_uses'",274],",",["T_WHITESPACE"," ",274],["T_CONSTANT_ENCAPSED_STRING","'popularity'",274],")",["T_WHITESPACE","\n        ",274],")",")",["T_WHITESPACE"," ",275],"{",["T_WHITESPACE","\n            ",275],["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","getSelect",276],"(",")",["T_OBJECT_OPERATOR","->",276],["T_STRING","where",276],"(",["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","_getConditionSql",276],"(",["T_CONSTANT_ENCAPSED_STRING","'summary.'",276],["T_WHITESPACE"," ",276],".",["T_WHITESPACE"," ",276],["T_VARIABLE","$field",276],",",["T_WHITESPACE"," ",276],["T_VARIABLE","$condition",276],")",")",";",["T_WHITESPACE","\n        ",276],"}",["T_WHITESPACE"," ",277],["T_ELSE","else",277],["T_WHITESPACE"," ",277],"{",["T_WHITESPACE","\n           ",277],["T_STRING","parent",278],["T_DOUBLE_COLON","::",278],["T_STRING","addFieldToFilter",278],"(",["T_VARIABLE","$field",278],",",["T_WHITESPACE"," ",278],["T_VARIABLE","$condition",278],")",";",["T_WHITESPACE","\n        ",278],"}",["T_WHITESPACE","\n        ",279],["T_RETURN","return",280],["T_WHITESPACE"," ",280],["T_VARIABLE","$this",280],";",["T_WHITESPACE","\n    ",280],"}",["T_WHITESPACE","\n\n    ",281],["T_DOC_COMMENT","\/**\n     * Get sql for get record count\n     *\n     * @return string\n     *\/",283],["T_WHITESPACE","\n    ",287],["T_PUBLIC","public",288],["T_WHITESPACE"," ",288],["T_FUNCTION","function",288],["T_WHITESPACE"," ",288],["T_STRING","getSelectCountSql",288],"(",")",["T_WHITESPACE","\n    ",288],"{",["T_WHITESPACE","\n        ",289],["T_VARIABLE","$select",290],["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],["T_STRING","parent",290],["T_DOUBLE_COLON","::",290],["T_STRING","getSelectCountSql",290],"(",")",";",["T_WHITESPACE","\n\n        ",290],["T_VARIABLE","$select",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","reset",292],"(",["T_STRING","Zend_Db_Select",292],["T_DOUBLE_COLON","::",292],["T_STRING","COLUMNS",292],")",";",["T_WHITESPACE","\n        ",292],["T_VARIABLE","$select",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","reset",293],"(",["T_STRING","Zend_Db_Select",293],["T_DOUBLE_COLON","::",293],["T_STRING","GROUP",293],")",";",["T_WHITESPACE","\n        ",293],["T_VARIABLE","$select",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","reset",294],"(",["T_STRING","Zend_Db_Select",294],["T_DOUBLE_COLON","::",294],["T_STRING","HAVING",294],")",";",["T_WHITESPACE","\n        ",294],["T_VARIABLE","$select",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","columns",295],"(",["T_CONSTANT_ENCAPSED_STRING","'COUNT(DISTINCT main_table.tag_id)'",295],")",";",["T_WHITESPACE","\n        ",295],["T_RETURN","return",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$select",296],";",["T_WHITESPACE","\n    ",296],"}",["T_WHITESPACE","\n\n    ",297],["T_DOC_COMMENT","\/**\n     * Add filter by store\n     *\n     * @param array | int $storeId\n     * @param bool $allFilter\n     * @return Mage_Tag_Model_Resource_Tag_Collection\n     *\/",299],["T_WHITESPACE","\n    ",305],["T_PUBLIC","public",306],["T_WHITESPACE"," ",306],["T_FUNCTION","function",306],["T_WHITESPACE"," ",306],["T_STRING","addStoreFilter",306],"(",["T_VARIABLE","$storeId",306],",",["T_WHITESPACE"," ",306],["T_VARIABLE","$allFilter",306],["T_WHITESPACE"," ",306],"=",["T_WHITESPACE"," ",306],["T_STRING","true",306],")",["T_WHITESPACE","\n    ",306],"{",["T_WHITESPACE","\n        ",307],["T_IF","if",308],["T_WHITESPACE"," ",308],"(","!",["T_VARIABLE","$this",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","getFlag",308],"(",["T_CONSTANT_ENCAPSED_STRING","'store_filter'",308],")",")",["T_WHITESPACE"," ",308],"{",["T_WHITESPACE","\n\n            ",308],["T_VARIABLE","$this",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","getSelect",310],"(",")",["T_OBJECT_OPERATOR","->",310],["T_STRING","joinLeft",310],"(",["T_WHITESPACE","\n                ",310],["T_ARRAY","array",311],"(",["T_CONSTANT_ENCAPSED_STRING","'summary_store'",311],["T_WHITESPACE"," ",311],["T_DOUBLE_ARROW","=>",311],["T_WHITESPACE"," ",311],["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","getTable",311],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/summary'",311],")",")",",",["T_WHITESPACE","\n                ",311],["T_CONSTANT_ENCAPSED_STRING","'main_table.tag_id = summary_store.tag_id'",312],["T_WHITESPACE","\n            ",312],")",";",["T_WHITESPACE","\n\n            ",313],["T_VARIABLE","$this",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","getSelect",315],"(",")",["T_OBJECT_OPERATOR","->",315],["T_STRING","where",315],"(",["T_CONSTANT_ENCAPSED_STRING","'summary_store.store_id IN (?)'",315],",",["T_WHITESPACE"," ",315],["T_VARIABLE","$storeId",315],")",";",["T_WHITESPACE","\n\n            ",315],["T_VARIABLE","$this",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","getSelect",317],"(",")",["T_OBJECT_OPERATOR","->",317],["T_STRING","group",317],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.tag_id'",317],")",";",["T_WHITESPACE","\n\n            ",317],["T_IF","if",319],["T_WHITESPACE"," ",319],"(",["T_VARIABLE","$this",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","getFlag",319],"(",["T_CONSTANT_ENCAPSED_STRING","'relation'",319],")",["T_WHITESPACE"," ",319],["T_BOOLEAN_AND","&&",319],["T_WHITESPACE"," ",319],["T_VARIABLE","$allFilter",319],")",["T_WHITESPACE"," ",319],"{",["T_WHITESPACE","\n                ",319],["T_VARIABLE","$this",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","getSelect",320],"(",")",["T_OBJECT_OPERATOR","->",320],["T_STRING","where",320],"(",["T_CONSTANT_ENCAPSED_STRING","'relation.store_id IN (?)'",320],",",["T_WHITESPACE"," ",320],["T_VARIABLE","$storeId",320],")",";",["T_WHITESPACE","\n            ",320],"}",["T_WHITESPACE","\n            ",321],["T_IF","if",322],["T_WHITESPACE"," ",322],"(",["T_VARIABLE","$this",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","getFlag",322],"(",["T_CONSTANT_ENCAPSED_STRING","'prelation'",322],")",["T_WHITESPACE"," ",322],["T_BOOLEAN_AND","&&",322],["T_WHITESPACE"," ",322],["T_VARIABLE","$allFilter",322],")",["T_WHITESPACE"," ",322],"{",["T_WHITESPACE","\n                ",322],["T_VARIABLE","$this",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","getSelect",323],"(",")",["T_OBJECT_OPERATOR","->",323],["T_STRING","where",323],"(",["T_CONSTANT_ENCAPSED_STRING","'prelation.store_id IN (?)'",323],",",["T_WHITESPACE"," ",323],["T_VARIABLE","$storeId",323],")",";",["T_WHITESPACE","\n            ",323],"}",["T_WHITESPACE","\n\n            ",324],["T_COMMENT","\/*\n             * Allow Analytic functions usage\n             *\/",326],["T_WHITESPACE","\n\n            ",328],["T_VARIABLE","$this",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","_useAnalyticFunction",330],["T_WHITESPACE"," ",330],"=",["T_WHITESPACE"," ",330],["T_STRING","true",330],";",["T_WHITESPACE","\n\n            ",330],["T_VARIABLE","$this",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","setFlag",332],"(",["T_CONSTANT_ENCAPSED_STRING","'store_filter'",332],",",["T_WHITESPACE"," ",332],["T_STRING","true",332],")",";",["T_WHITESPACE","\n        ",332],"}",["T_WHITESPACE","\n\n        ",333],["T_RETURN","return",335],["T_WHITESPACE"," ",335],["T_VARIABLE","$this",335],";",["T_WHITESPACE","\n    ",335],"}",["T_WHITESPACE","\n\n    ",336],["T_DOC_COMMENT","\/**\n     * Adds filtering by active\n     *\n     * @return Mage_Tag_Model_Resource_Tag_Collection\n     *\/",338],["T_WHITESPACE","\n    ",342],["T_PUBLIC","public",343],["T_WHITESPACE"," ",343],["T_FUNCTION","function",343],["T_WHITESPACE"," ",343],["T_STRING","setActiveFilter",343],"(",")",["T_WHITESPACE","\n    ",343],"{",["T_WHITESPACE","\n        ",344],["T_VARIABLE","$statusActive",345],["T_WHITESPACE"," ",345],"=",["T_WHITESPACE"," ",345],["T_STRING","Mage_Tag_Model_Tag_Relation",345],["T_DOUBLE_COLON","::",345],["T_STRING","STATUS_ACTIVE",345],";",["T_WHITESPACE","\n        ",345],["T_VARIABLE","$this",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","getSelect",346],"(",")",["T_OBJECT_OPERATOR","->",346],["T_STRING","where",346],"(",["T_CONSTANT_ENCAPSED_STRING","'relation.active = ?'",346],",",["T_WHITESPACE"," ",346],["T_VARIABLE","$statusActive",346],")",";",["T_WHITESPACE","\n        ",346],["T_IF","if",347],["T_WHITESPACE"," ",347],"(",["T_VARIABLE","$this",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","getFlag",347],"(",["T_CONSTANT_ENCAPSED_STRING","'prelation'",347],")",")",["T_WHITESPACE"," ",347],"{",["T_WHITESPACE","\n            ",347],["T_VARIABLE","$this",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","getSelect",348],"(",")",["T_OBJECT_OPERATOR","->",348],["T_STRING","where",348],"(",["T_CONSTANT_ENCAPSED_STRING","'prelation.active = ?'",348],",",["T_WHITESPACE"," ",348],["T_VARIABLE","$statusActive",348],")",";",["T_WHITESPACE","\n        ",348],"}",["T_WHITESPACE","\n        ",349],["T_RETURN","return",350],["T_WHITESPACE"," ",350],["T_VARIABLE","$this",350],";",["T_WHITESPACE","\n    ",350],"}",["T_WHITESPACE","\n\n    ",351],["T_DOC_COMMENT","\/**\n     * Adds filter by status\n     *\n     * @param int $status\n     * @return Mage_Tag_Model_Resource_Tag_Collection\n     *\/",353],["T_WHITESPACE","\n    ",358],["T_PUBLIC","public",359],["T_WHITESPACE"," ",359],["T_FUNCTION","function",359],["T_WHITESPACE"," ",359],["T_STRING","addStatusFilter",359],"(",["T_VARIABLE","$status",359],")",["T_WHITESPACE","\n    ",359],"{",["T_WHITESPACE","\n        ",360],["T_VARIABLE","$this",361],["T_OBJECT_OPERATOR","->",361],["T_STRING","getSelect",361],"(",")",["T_OBJECT_OPERATOR","->",361],["T_STRING","where",361],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.status = ?'",361],",",["T_WHITESPACE"," ",361],["T_VARIABLE","$status",361],")",";",["T_WHITESPACE","\n        ",361],["T_RETURN","return",362],["T_WHITESPACE"," ",362],["T_VARIABLE","$this",362],";",["T_WHITESPACE","\n    ",362],"}",["T_WHITESPACE","\n\n    ",363],["T_DOC_COMMENT","\/**\n     * Adds filter by product id\n     *\n     * @param int $productId\n     * @return Mage_Tag_Model_Resource_Tag_Collection\n     *\/",365],["T_WHITESPACE","\n    ",370],["T_PUBLIC","public",371],["T_WHITESPACE"," ",371],["T_FUNCTION","function",371],["T_WHITESPACE"," ",371],["T_STRING","addProductFilter",371],"(",["T_VARIABLE","$productId",371],")",["T_WHITESPACE","\n    ",371],"{",["T_WHITESPACE","\n        ",372],["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","addFieldToFilter",373],"(",["T_CONSTANT_ENCAPSED_STRING","'relation.product_id'",373],",",["T_WHITESPACE"," ",373],["T_VARIABLE","$productId",373],")",";",["T_WHITESPACE","\n        ",373],["T_IF","if",374],["T_WHITESPACE"," ",374],"(",["T_VARIABLE","$this",374],["T_OBJECT_OPERATOR","->",374],["T_STRING","getFlag",374],"(",["T_CONSTANT_ENCAPSED_STRING","'prelation'",374],")",")",["T_WHITESPACE"," ",374],"{",["T_WHITESPACE","\n            ",374],["T_VARIABLE","$this",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","addFieldToFilter",375],"(",["T_CONSTANT_ENCAPSED_STRING","'prelation.product_id'",375],",",["T_WHITESPACE"," ",375],["T_VARIABLE","$productId",375],")",";",["T_WHITESPACE","\n        ",375],"}",["T_WHITESPACE","\n        ",376],["T_RETURN","return",377],["T_WHITESPACE"," ",377],["T_VARIABLE","$this",377],";",["T_WHITESPACE","\n    ",377],"}",["T_WHITESPACE","\n\n    ",378],["T_DOC_COMMENT","\/**\n     * Adds filter by customer id\n     *\n     * @param int $customerId\n     * @return Mage_Tag_Model_Resource_Tag_Collection\n     *\/",380],["T_WHITESPACE","\n    ",385],["T_PUBLIC","public",386],["T_WHITESPACE"," ",386],["T_FUNCTION","function",386],["T_WHITESPACE"," ",386],["T_STRING","addCustomerFilter",386],"(",["T_VARIABLE","$customerId",386],")",["T_WHITESPACE","\n    ",386],"{",["T_WHITESPACE","\n        ",387],["T_VARIABLE","$this",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","getSelect",388],"(",")",["T_WHITESPACE","\n            ",388],["T_OBJECT_OPERATOR","->",389],["T_STRING","where",389],"(",["T_CONSTANT_ENCAPSED_STRING","'relation.customer_id = ?'",389],",",["T_WHITESPACE"," ",389],["T_VARIABLE","$customerId",389],")",";",["T_WHITESPACE","\n        ",389],["T_IF","if",390],["T_WHITESPACE"," ",390],"(",["T_VARIABLE","$this",390],["T_OBJECT_OPERATOR","->",390],["T_STRING","getFlag",390],"(",["T_CONSTANT_ENCAPSED_STRING","'prelation'",390],")",")",["T_WHITESPACE"," ",390],"{",["T_WHITESPACE","\n            ",390],["T_VARIABLE","$this",391],["T_OBJECT_OPERATOR","->",391],["T_STRING","getSelect",391],"(",")",["T_WHITESPACE","\n                ",391],["T_OBJECT_OPERATOR","->",392],["T_STRING","where",392],"(",["T_CONSTANT_ENCAPSED_STRING","'prelation.customer_id = ?'",392],",",["T_WHITESPACE"," ",392],["T_VARIABLE","$customerId",392],")",";",["T_WHITESPACE","\n        ",392],"}",["T_WHITESPACE","\n        ",393],["T_RETURN","return",394],["T_WHITESPACE"," ",394],["T_VARIABLE","$this",394],";",["T_WHITESPACE","\n    ",394],"}",["T_WHITESPACE","\n\n    ",395],["T_DOC_COMMENT","\/**\n     * Adds grouping by tag id\n     *\n     * @return Mage_Tag_Model_Resource_Tag_Collection\n     *\/",397],["T_WHITESPACE","\n    ",401],["T_PUBLIC","public",402],["T_WHITESPACE"," ",402],["T_FUNCTION","function",402],["T_WHITESPACE"," ",402],["T_STRING","addTagGroup",402],"(",")",["T_WHITESPACE","\n    ",402],"{",["T_WHITESPACE","\n        ",403],["T_VARIABLE","$this",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","getSelect",404],"(",")",["T_OBJECT_OPERATOR","->",404],["T_STRING","group",404],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.tag_id'",404],")",";",["T_WHITESPACE","\n        ",404],["T_VARIABLE","$this",405],["T_OBJECT_OPERATOR","->",405],["T_STRING","_useAnalyticFunction",405],["T_WHITESPACE"," ",405],"=",["T_WHITESPACE"," ",405],["T_STRING","true",405],";",["T_WHITESPACE","\n        ",405],["T_RETURN","return",406],["T_WHITESPACE"," ",406],["T_VARIABLE","$this",406],";",["T_WHITESPACE","\n    ",406],"}",["T_WHITESPACE","\n\n    ",407],["T_DOC_COMMENT","\/**\n     * Joins tag\/relation table\n     *\n     * @return Mage_Tag_Model_Resource_Tag_Collection\n     *\/",409],["T_WHITESPACE","\n    ",413],["T_PUBLIC","public",414],["T_WHITESPACE"," ",414],["T_FUNCTION","function",414],["T_WHITESPACE"," ",414],["T_STRING","joinRel",414],"(",")",["T_WHITESPACE","\n    ",414],"{",["T_WHITESPACE","\n        ",415],["T_VARIABLE","$this",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","setFlag",416],"(",["T_CONSTANT_ENCAPSED_STRING","'relation'",416],",",["T_WHITESPACE"," ",416],["T_STRING","true",416],")",";",["T_WHITESPACE","\n        ",416],["T_VARIABLE","$this",417],["T_OBJECT_OPERATOR","->",417],["T_STRING","getSelect",417],"(",")",["T_OBJECT_OPERATOR","->",417],["T_STRING","joinLeft",417],"(",["T_WHITESPACE","\n            ",417],["T_ARRAY","array",418],"(",["T_CONSTANT_ENCAPSED_STRING","'relation'",418],["T_WHITESPACE"," ",418],["T_DOUBLE_ARROW","=>",418],["T_WHITESPACE"," ",418],["T_VARIABLE","$this",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","getTable",418],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/relation'",418],")",")",",",["T_WHITESPACE","\n            ",418],["T_CONSTANT_ENCAPSED_STRING","'main_table.tag_id=relation.tag_id'",419],["T_WHITESPACE","\n        ",419],")",";",["T_WHITESPACE","\n        ",420],["T_RETURN","return",421],["T_WHITESPACE"," ",421],["T_VARIABLE","$this",421],";",["T_WHITESPACE","\n    ",421],"}",["T_WHITESPACE","\n",422],"}",["T_WHITESPACE","\n",423]]