[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Tag\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Tags customer collection\n *\n * @category    Mage\n * @package     Mage_Tag\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Tag_Model_Resource_Customer_Collection",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Customer_Model_Resource_Customer_Collection",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Allows disabling grouping\n     *\n     * @var bool\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_allowDisableGrouping",42],["T_WHITESPACE","     ",42],"=",["T_WHITESPACE"," ",42],["T_STRING","true",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Count attribute for count sql\n     *\n     * @var string\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_countAttribute",49],["T_WHITESPACE","           ",49],"=",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'tr.tag_id'",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Array with joined tables\n     *\n     * @var array\n     *\/",51],["T_WHITESPACE","\n    ",55],["T_PROTECTED","protected",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$_joinFlags",56],["T_WHITESPACE","                ",56],"=",["T_WHITESPACE"," ",56],["T_ARRAY","array",56],"(",")",";",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * Prepare select\n     *\n     * @return Mage_Tag_Model_Resource_Customer_Collection\n     *\/",58],["T_WHITESPACE","\n    ",62],["T_PUBLIC","public",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","_initSelect",63],"(",")",["T_WHITESPACE","\n    ",63],"{",["T_WHITESPACE","\n        ",64],["T_STRING","parent",65],["T_DOUBLE_COLON","::",65],["T_STRING","_initSelect",65],"(",")",";",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","_joinFields",66],"(",")",";",["T_WHITESPACE","\n        ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","_setIdFieldName",67],"(",["T_CONSTANT_ENCAPSED_STRING","'tag_relation_id'",67],")",";",["T_WHITESPACE","\n        ",67],["T_RETURN","return",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$this",68],";",["T_WHITESPACE","\n    ",68],"}",["T_WHITESPACE","\n\n    ",69],["T_DOC_COMMENT","\/**\n     * Set flag about joined table.\n     * setFlag method must be used in future.\n     *\n     * @deprecated after 1.3.2.3\n     *\n     * @param string $table\n     * @return Mage_Tag_Model_Resource_Customer_Collection\n     *\/",71],["T_WHITESPACE","\n    ",79],["T_PUBLIC","public",80],["T_WHITESPACE"," ",80],["T_FUNCTION","function",80],["T_WHITESPACE"," ",80],["T_STRING","setJoinFlag",80],"(",["T_VARIABLE","$table",80],")",["T_WHITESPACE","\n    ",80],"{",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","setFlag",82],"(",["T_VARIABLE","$table",82],",",["T_WHITESPACE"," ",82],["T_STRING","true",82],")",";",["T_WHITESPACE","\n        ",82],["T_RETURN","return",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],";",["T_WHITESPACE","\n    ",83],"}",["T_WHITESPACE","\n\n    ",84],["T_DOC_COMMENT","\/**\n     * Get flag's status about joined table.\n     * getFlag method must be used in future.\n     *\n     * @deprecated after 1.3.2.3\n     *\n     * @param string $table\n     * @return bool\n     *\/",86],["T_WHITESPACE","\n    ",94],["T_PUBLIC","public",95],["T_WHITESPACE"," ",95],["T_FUNCTION","function",95],["T_WHITESPACE"," ",95],["T_STRING","getJoinFlag",95],"(",["T_VARIABLE","$table",95],")",["T_WHITESPACE","\n    ",95],"{",["T_WHITESPACE","\n        ",96],["T_RETURN","return",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","getFlag",97],"(",["T_VARIABLE","$table",97],")",";",["T_WHITESPACE","\n    ",97],"}",["T_WHITESPACE","\n\n    ",98],["T_DOC_COMMENT","\/**\n     * Unset value of join flag.\n     * Set false (bool) value to flag instead in future.\n     *\n     * @deprecated after 1.3.2.3\n     *\n     * @param string $table\n     * @return Mage_Tag_Model_Resource_Customer_Collection\n     *\/",100],["T_WHITESPACE","\n    ",108],["T_PUBLIC","public",109],["T_WHITESPACE"," ",109],["T_FUNCTION","function",109],["T_WHITESPACE"," ",109],["T_STRING","unsetJoinFlag",109],"(",["T_VARIABLE","$table",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_STRING","null",109],")",["T_WHITESPACE","\n    ",109],"{",["T_WHITESPACE","\n        ",110],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","setFlag",111],"(",["T_VARIABLE","$table",111],",",["T_WHITESPACE"," ",111],["T_STRING","false",111],")",";",["T_WHITESPACE","\n        ",111],["T_RETURN","return",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],";",["T_WHITESPACE","\n    ",112],"}",["T_WHITESPACE","\n\n    ",113],["T_DOC_COMMENT","\/**\n     * Adds filter by tag is\n     *\n     * @param int $tagId\n     * @return Mage_Tag_Model_Resource_Customer_Collection\n     *\/",115],["T_WHITESPACE","\n    ",120],["T_PUBLIC","public",121],["T_WHITESPACE"," ",121],["T_FUNCTION","function",121],["T_WHITESPACE"," ",121],["T_STRING","addTagFilter",121],"(",["T_VARIABLE","$tagId",121],")",["T_WHITESPACE","\n    ",121],"{",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getSelect",123],"(",")",["T_WHITESPACE","\n            ",123],["T_OBJECT_OPERATOR","->",124],["T_STRING","where",124],"(",["T_CONSTANT_ENCAPSED_STRING","'tr.tag_id = ?'",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$tagId",124],")",";",["T_WHITESPACE","\n        ",124],["T_RETURN","return",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$this",125],";",["T_WHITESPACE","\n    ",125],"}",["T_WHITESPACE","\n\n    ",126],["T_DOC_COMMENT","\/**\n     * adds filter by product id\n     *\n     * @param int $productId\n     * @return Mage_Tag_Model_Resource_Customer_Collection\n     *\/",128],["T_WHITESPACE","\n    ",133],["T_PUBLIC","public",134],["T_WHITESPACE"," ",134],["T_FUNCTION","function",134],["T_WHITESPACE"," ",134],["T_STRING","addProductFilter",134],"(",["T_VARIABLE","$productId",134],")",["T_WHITESPACE","\n    ",134],"{",["T_WHITESPACE","\n        ",135],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getSelect",136],"(",")",["T_WHITESPACE","\n            ",136],["T_OBJECT_OPERATOR","->",137],["T_STRING","where",137],"(",["T_CONSTANT_ENCAPSED_STRING","'tr.product_id = ?'",137],",",["T_WHITESPACE"," ",137],["T_VARIABLE","$productId",137],")",";",["T_WHITESPACE","\n        ",137],["T_RETURN","return",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$this",138],";",["T_WHITESPACE","\n    ",138],"}",["T_WHITESPACE","\n\n    ",139],["T_DOC_COMMENT","\/**\n     * Apply filter by store id(s).\n     *\n     * @param int|array $storeId\n     * @return Mage_Tag_Model_Resource_Customer_Collection\n     *\/",141],["T_WHITESPACE","\n    ",146],["T_PUBLIC","public",147],["T_WHITESPACE"," ",147],["T_FUNCTION","function",147],["T_WHITESPACE"," ",147],["T_STRING","addStoreFilter",147],"(",["T_VARIABLE","$storeId",147],")",["T_WHITESPACE","\n    ",147],"{",["T_WHITESPACE","\n        ",148],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","getSelect",149],"(",")",["T_OBJECT_OPERATOR","->",149],["T_STRING","where",149],"(",["T_CONSTANT_ENCAPSED_STRING","'tr.store_id IN (?)'",149],",",["T_WHITESPACE"," ",149],["T_VARIABLE","$storeId",149],")",";",["T_WHITESPACE","\n        ",149],["T_RETURN","return",150],["T_WHITESPACE"," ",150],["T_VARIABLE","$this",150],";",["T_WHITESPACE","\n    ",150],"}",["T_WHITESPACE","\n\n    ",151],["T_DOC_COMMENT","\/**\n     * Adds filter by status\n     *\n     * @param int $status\n     * @return Mage_Tag_Model_Resource_Customer_Collection\n     *\/",153],["T_WHITESPACE","\n    ",158],["T_PUBLIC","public",159],["T_WHITESPACE"," ",159],["T_FUNCTION","function",159],["T_WHITESPACE"," ",159],["T_STRING","addStatusFilter",159],"(",["T_VARIABLE","$status",159],")",["T_WHITESPACE","\n    ",159],"{",["T_WHITESPACE","\n        ",160],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","getSelect",161],"(",")",["T_WHITESPACE","\n            ",161],["T_OBJECT_OPERATOR","->",162],["T_STRING","where",162],"(",["T_CONSTANT_ENCAPSED_STRING","'t.status = ?'",162],",",["T_WHITESPACE"," ",162],["T_VARIABLE","$status",162],")",";",["T_WHITESPACE","\n        ",162],["T_RETURN","return",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$this",163],";",["T_WHITESPACE","\n    ",163],"}",["T_WHITESPACE","\n\n    ",164],["T_DOC_COMMENT","\/**\n     * Adds desc order by tag relation id\n     *\n     * @return Mage_Tag_Model_Resource_Customer_Collection\n     *\/",166],["T_WHITESPACE","\n    ",170],["T_PUBLIC","public",171],["T_WHITESPACE"," ",171],["T_FUNCTION","function",171],["T_WHITESPACE"," ",171],["T_STRING","addDescOrder",171],"(",")",["T_WHITESPACE","\n    ",171],"{",["T_WHITESPACE","\n        ",172],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","getSelect",173],"(",")",["T_WHITESPACE","\n            ",173],["T_OBJECT_OPERATOR","->",174],["T_STRING","order",174],"(",["T_CONSTANT_ENCAPSED_STRING","'tr.tag_relation_id desc'",174],")",";",["T_WHITESPACE","\n        ",174],["T_RETURN","return",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],";",["T_WHITESPACE","\n    ",175],"}",["T_WHITESPACE","\n\n    ",176],["T_DOC_COMMENT","\/**\n     * Adds grouping by tag id\n     *\n     * @return Mage_Tag_Model_Resource_Customer_Collection\n     *\/",178],["T_WHITESPACE","\n    ",182],["T_PUBLIC","public",183],["T_WHITESPACE"," ",183],["T_FUNCTION","function",183],["T_WHITESPACE"," ",183],["T_STRING","addGroupByTag",183],"(",")",["T_WHITESPACE","\n    ",183],"{",["T_WHITESPACE","\n        ",184],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","getSelect",185],"(",")",["T_WHITESPACE","\n            ",185],["T_OBJECT_OPERATOR","->",186],["T_STRING","group",186],"(",["T_CONSTANT_ENCAPSED_STRING","'tr.tag_id'",186],")",";",["T_WHITESPACE","\n\n        ",186],["T_COMMENT","\/*\n         * Allow analytic functions usage\n         *\/",188],["T_WHITESPACE","\n        ",190],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","_useAnalyticFunction",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_STRING","true",191],";",["T_WHITESPACE","\n\n        ",191],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","_allowDisableGrouping",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_STRING","true",193],";",["T_WHITESPACE","\n        ",193],["T_RETURN","return",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$this",194],";",["T_WHITESPACE","\n    ",194],"}",["T_WHITESPACE","\n\n    ",195],["T_DOC_COMMENT","\/**\n     * Adds grouping by customer id\n     *\n     * @return Mage_Tag_Model_Resource_Customer_Collection\n     *\/",197],["T_WHITESPACE","\n    ",201],["T_PUBLIC","public",202],["T_WHITESPACE"," ",202],["T_FUNCTION","function",202],["T_WHITESPACE"," ",202],["T_STRING","addGroupByCustomer",202],"(",")",["T_WHITESPACE","\n    ",202],"{",["T_WHITESPACE","\n        ",203],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","getSelect",204],"(",")",["T_WHITESPACE","\n            ",204],["T_OBJECT_OPERATOR","->",205],["T_STRING","group",205],"(",["T_CONSTANT_ENCAPSED_STRING","'tr.customer_id'",205],")",";",["T_WHITESPACE","\n\n        ",205],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","_allowDisableGrouping",207],["T_WHITESPACE"," ",207],"=",["T_WHITESPACE"," ",207],["T_STRING","false",207],";",["T_WHITESPACE","\n        ",207],["T_RETURN","return",208],["T_WHITESPACE"," ",208],["T_VARIABLE","$this",208],";",["T_WHITESPACE","\n    ",208],"}",["T_WHITESPACE","\n\n    ",209],["T_DOC_COMMENT","\/**\n     * Disables grouping\n     *\n     * @return Mage_Tag_Model_Resource_Customer_Collection\n     *\/",211],["T_WHITESPACE","\n    ",215],["T_PUBLIC","public",216],["T_WHITESPACE"," ",216],["T_FUNCTION","function",216],["T_WHITESPACE"," ",216],["T_STRING","addGroupByCustomerProduct",216],"(",")",["T_WHITESPACE","\n    ",216],"{",["T_WHITESPACE","\n        ",217],["T_COMMENT","\/\/ Nothing need to group\n",218],["T_WHITESPACE","        ",219],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","_allowDisableGrouping",219],["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],["T_STRING","false",219],";",["T_WHITESPACE","\n        ",219],["T_RETURN","return",220],["T_WHITESPACE"," ",220],["T_VARIABLE","$this",220],";",["T_WHITESPACE","\n    ",220],"}",["T_WHITESPACE","\n\n    ",221],["T_DOC_COMMENT","\/**\n     * Adds filter by customer id\n     *\n     * @param int $customerId\n     * @return Mage_Tag_Model_Resource_Customer_Collection\n     *\/",223],["T_WHITESPACE","\n    ",228],["T_PUBLIC","public",229],["T_WHITESPACE"," ",229],["T_FUNCTION","function",229],["T_WHITESPACE"," ",229],["T_STRING","addCustomerFilter",229],"(",["T_VARIABLE","$customerId",229],")",["T_WHITESPACE","\n    ",229],"{",["T_WHITESPACE","\n        ",230],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","getSelect",231],"(",")",["T_OBJECT_OPERATOR","->",231],["T_STRING","where",231],"(",["T_CONSTANT_ENCAPSED_STRING","'tr.customer_id = ?'",231],",",["T_WHITESPACE"," ",231],["T_VARIABLE","$customerId",231],")",";",["T_WHITESPACE","\n        ",231],["T_RETURN","return",232],["T_WHITESPACE"," ",232],["T_VARIABLE","$this",232],";",["T_WHITESPACE","\n    ",232],"}",["T_WHITESPACE","\n\n    ",233],["T_DOC_COMMENT","\/**\n     * Joins tables to select\n     *\n     *\/",235],["T_WHITESPACE","\n    ",238],["T_PROTECTED","protected",239],["T_WHITESPACE"," ",239],["T_FUNCTION","function",239],["T_WHITESPACE"," ",239],["T_STRING","_joinFields",239],"(",")",["T_WHITESPACE","\n    ",239],"{",["T_WHITESPACE","\n        ",240],["T_VARIABLE","$tagRelationTable",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","getTable",241],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/relation'",241],")",";",["T_WHITESPACE","\n        ",241],["T_VARIABLE","$tagTable",242],["T_WHITESPACE"," ",242],"=",["T_WHITESPACE"," ",242],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","getTable",242],"(",["T_CONSTANT_ENCAPSED_STRING","'tag\/tag'",242],")",";",["T_WHITESPACE","\n\n        ",242],["T_COMMENT","\/\/TODO: add full name logic\n",244],["T_WHITESPACE","        ",245],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","addAttributeToSelect",245],"(",["T_CONSTANT_ENCAPSED_STRING","'firstname'",245],")",["T_WHITESPACE","\n            ",245],["T_OBJECT_OPERATOR","->",246],["T_STRING","addAttributeToSelect",246],"(",["T_CONSTANT_ENCAPSED_STRING","'middlename'",246],")",["T_WHITESPACE","\n            ",246],["T_OBJECT_OPERATOR","->",247],["T_STRING","addAttributeToSelect",247],"(",["T_CONSTANT_ENCAPSED_STRING","'lastname'",247],")",["T_WHITESPACE","\n            ",247],["T_OBJECT_OPERATOR","->",248],["T_STRING","addAttributeToSelect",248],"(",["T_CONSTANT_ENCAPSED_STRING","'email'",248],")",";",["T_WHITESPACE","\n\n        ",248],["T_VARIABLE","$this",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","getSelect",250],"(",")",["T_WHITESPACE","\n        ",250],["T_OBJECT_OPERATOR","->",251],["T_STRING","join",251],"(",["T_WHITESPACE","\n            ",251],["T_ARRAY","array",252],"(",["T_CONSTANT_ENCAPSED_STRING","'tr'",252],["T_WHITESPACE"," ",252],["T_DOUBLE_ARROW","=>",252],["T_WHITESPACE"," ",252],["T_VARIABLE","$tagRelationTable",252],")",",",["T_WHITESPACE","\n            ",252],["T_CONSTANT_ENCAPSED_STRING","'tr.customer_id = e.entity_id'",253],",",["T_WHITESPACE","\n            ",253],["T_ARRAY","array",254],"(",["T_CONSTANT_ENCAPSED_STRING","'tag_relation_id'",254],",",["T_WHITESPACE"," ",254],["T_CONSTANT_ENCAPSED_STRING","'product_id'",254],",",["T_WHITESPACE"," ",254],["T_CONSTANT_ENCAPSED_STRING","'active'",254],",",["T_WHITESPACE"," ",254],["T_CONSTANT_ENCAPSED_STRING","'added_in'",254],["T_WHITESPACE"," ",254],["T_DOUBLE_ARROW","=>",254],["T_WHITESPACE"," ",254],["T_CONSTANT_ENCAPSED_STRING","'store_id'",254],")",["T_WHITESPACE","\n        ",254],")",["T_WHITESPACE","\n        ",255],["T_OBJECT_OPERATOR","->",256],["T_STRING","join",256],"(",["T_ARRAY","array",256],"(",["T_CONSTANT_ENCAPSED_STRING","'t'",256],["T_WHITESPACE"," ",256],["T_DOUBLE_ARROW","=>",256],["T_WHITESPACE"," ",256],["T_VARIABLE","$tagTable",256],")",",",["T_WHITESPACE"," ",256],["T_CONSTANT_ENCAPSED_STRING","'t.tag_id = tr.tag_id'",256],",",["T_WHITESPACE"," ",256],["T_ARRAY","array",256],"(",["T_CONSTANT_ENCAPSED_STRING","'*'",256],")",")",";",["T_WHITESPACE","\n    ",256],"}",["T_WHITESPACE","\n\n    ",257],["T_DOC_COMMENT","\/**\n     * Gets number of rows\n     *\n     * @return Varien_Db_Select\n     *\/",259],["T_WHITESPACE","\n    ",263],["T_PUBLIC","public",264],["T_WHITESPACE"," ",264],["T_FUNCTION","function",264],["T_WHITESPACE"," ",264],["T_STRING","getSelectCountSql",264],"(",")",["T_WHITESPACE","\n    ",264],"{",["T_WHITESPACE","\n        ",265],["T_VARIABLE","$countSelect",266],["T_WHITESPACE"," ",266],"=",["T_WHITESPACE"," ",266],["T_STRING","parent",266],["T_DOUBLE_COLON","::",266],["T_STRING","getSelectCountSql",266],"(",")",";",["T_WHITESPACE","\n\n        ",266],["T_IF","if",268],["T_WHITESPACE"," ",268],"(",["T_VARIABLE","$this",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","_allowDisableGrouping",268],")",["T_WHITESPACE"," ",268],"{",["T_WHITESPACE","\n            ",268],["T_VARIABLE","$countSelect",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","reset",269],"(",["T_STRING","Zend_Db_Select",269],["T_DOUBLE_COLON","::",269],["T_STRING","COLUMNS",269],")",";",["T_WHITESPACE","\n            ",269],["T_VARIABLE","$countSelect",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","reset",270],"(",["T_STRING","Zend_Db_Select",270],["T_DOUBLE_COLON","::",270],["T_STRING","GROUP",270],")",";",["T_WHITESPACE","\n            ",270],["T_VARIABLE","$countSelect",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","columns",271],"(",["T_CONSTANT_ENCAPSED_STRING","'COUNT(DISTINCT '",271],["T_WHITESPACE"," ",271],".",["T_WHITESPACE"," ",271],["T_VARIABLE","$this",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","getCountAttribute",271],"(",")",["T_WHITESPACE"," ",271],".",["T_WHITESPACE"," ",271],["T_CONSTANT_ENCAPSED_STRING","')'",271],")",";",["T_WHITESPACE","\n        ",271],"}",["T_WHITESPACE","\n        ",272],["T_RETURN","return",273],["T_WHITESPACE"," ",273],["T_VARIABLE","$countSelect",273],";",["T_WHITESPACE","\n    ",273],"}",["T_WHITESPACE","\n\n    ",274],["T_DOC_COMMENT","\/**\n     * Adds Product names to item\n     *\n     * @return Mage_Tag_Model_Resource_Customer_Collection\n     *\/",276],["T_WHITESPACE","\n    ",280],["T_PUBLIC","public",281],["T_WHITESPACE"," ",281],["T_FUNCTION","function",281],["T_WHITESPACE"," ",281],["T_STRING","addProductName",281],"(",")",["T_WHITESPACE","\n    ",281],"{",["T_WHITESPACE","\n        ",282],["T_VARIABLE","$productsId",283],["T_WHITESPACE","   ",283],"=",["T_WHITESPACE"," ",283],["T_ARRAY","array",283],"(",")",";",["T_WHITESPACE","\n        ",283],["T_VARIABLE","$productsData",284],["T_WHITESPACE"," ",284],"=",["T_WHITESPACE"," ",284],["T_ARRAY","array",284],"(",")",";",["T_WHITESPACE","\n\n        ",284],["T_FOREACH","foreach",286],["T_WHITESPACE"," ",286],"(",["T_VARIABLE","$this",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","getItems",286],"(",")",["T_WHITESPACE"," ",286],["T_AS","as",286],["T_WHITESPACE"," ",286],["T_VARIABLE","$item",286],")",["T_WHITESPACE"," ",286],"{",["T_WHITESPACE","\n            ",286],["T_VARIABLE","$productsId",287],"[","]",["T_WHITESPACE"," ",287],"=",["T_WHITESPACE"," ",287],["T_VARIABLE","$item",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","getProductId",287],"(",")",";",["T_WHITESPACE","\n        ",287],"}",["T_WHITESPACE","\n\n        ",288],["T_VARIABLE","$productsId",290],["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],["T_STRING","array_unique",290],"(",["T_VARIABLE","$productsId",290],")",";",["T_WHITESPACE","\n\n        ",290],["T_COMMENT","\/* small fix *\/",292],["T_WHITESPACE","\n        ",292],["T_IF","if",293],["T_WHITESPACE"," ",293],"(",["T_WHITESPACE"," ",293],["T_STRING","sizeof",293],"(",["T_VARIABLE","$productsId",293],")",["T_WHITESPACE"," ",293],["T_IS_EQUAL","==",293],["T_WHITESPACE"," ",293],["T_LNUMBER","0",293],["T_WHITESPACE"," ",293],")",["T_WHITESPACE"," ",293],"{",["T_WHITESPACE","\n            ",293],["T_RETURN","return",294],";",["T_WHITESPACE","\n        ",294],"}",["T_WHITESPACE","\n\n        ",295],["T_VARIABLE","$collection",297],["T_WHITESPACE"," ",297],"=",["T_WHITESPACE"," ",297],["T_STRING","Mage",297],["T_DOUBLE_COLON","::",297],["T_STRING","getModel",297],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",297],")",["T_OBJECT_OPERATOR","->",297],["T_STRING","getCollection",297],"(",")",["T_WHITESPACE","\n            ",297],["T_OBJECT_OPERATOR","->",298],["T_STRING","addAttributeToSelect",298],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",298],")",["T_WHITESPACE","\n            ",298],["T_OBJECT_OPERATOR","->",299],["T_STRING","addAttributeToSelect",299],"(",["T_CONSTANT_ENCAPSED_STRING","'sku'",299],")",["T_WHITESPACE","\n            ",299],["T_OBJECT_OPERATOR","->",300],["T_STRING","addIdFilter",300],"(",["T_VARIABLE","$productsId",300],")",";",["T_WHITESPACE","\n\n        ",300],["T_VARIABLE","$collection",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","load",302],"(",")",";",["T_WHITESPACE","\n\n        ",302],["T_FOREACH","foreach",304],["T_WHITESPACE"," ",304],"(",["T_VARIABLE","$collection",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","getItems",304],"(",")",["T_WHITESPACE"," ",304],["T_AS","as",304],["T_WHITESPACE"," ",304],["T_VARIABLE","$item",304],")",["T_WHITESPACE"," ",304],"{",["T_WHITESPACE","\n            ",304],["T_VARIABLE","$productsData",305],"[",["T_VARIABLE","$item",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","getId",305],"(",")","]",["T_WHITESPACE"," ",305],"=",["T_WHITESPACE"," ",305],["T_VARIABLE","$item",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","getName",305],"(",")",";",["T_WHITESPACE","\n            ",305],["T_VARIABLE","$productsSku",306],"[",["T_VARIABLE","$item",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","getId",306],"(",")","]",["T_WHITESPACE"," ",306],"=",["T_WHITESPACE"," ",306],["T_VARIABLE","$item",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","getSku",306],"(",")",";",["T_WHITESPACE","\n        ",306],"}",["T_WHITESPACE","\n\n        ",307],["T_FOREACH","foreach",309],["T_WHITESPACE"," ",309],"(",["T_VARIABLE","$this",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","getItems",309],"(",")",["T_WHITESPACE"," ",309],["T_AS","as",309],["T_WHITESPACE"," ",309],["T_VARIABLE","$item",309],")",["T_WHITESPACE"," ",309],"{",["T_WHITESPACE","\n            ",309],["T_VARIABLE","$item",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","setProduct",310],"(",["T_VARIABLE","$productsData",310],"[",["T_VARIABLE","$item",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","getProductId",310],"(",")","]",")",";",["T_WHITESPACE","\n            ",310],["T_VARIABLE","$item",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","setProductSku",311],"(",["T_VARIABLE","$productsSku",311],"[",["T_VARIABLE","$item",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","getProductId",311],"(",")","]",")",";",["T_WHITESPACE","\n        ",311],"}",["T_WHITESPACE","\n        ",312],["T_RETURN","return",313],["T_WHITESPACE"," ",313],["T_VARIABLE","$this",313],";",["T_WHITESPACE","\n    ",313],"}",["T_WHITESPACE","\n\n    ",314],["T_DOC_COMMENT","\/**\n     * Adds Product names to select\n     *\n     * @return Mage_Tag_Model_Resource_Customer_Collection\n     *\/",316],["T_WHITESPACE","\n    ",320],["T_PUBLIC","public",321],["T_WHITESPACE"," ",321],["T_FUNCTION","function",321],["T_WHITESPACE"," ",321],["T_STRING","addProductToSelect",321],"(",")",["T_WHITESPACE","\n    ",321],"{",["T_WHITESPACE","\n        ",322],["T_VARIABLE","$resource",323],["T_WHITESPACE"," ",323],"=",["T_WHITESPACE"," ",323],["T_STRING","Mage",323],["T_DOUBLE_COLON","::",323],["T_STRING","getModel",323],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",323],")",["T_OBJECT_OPERATOR","->",323],["T_STRING","getResource",323],"(",")",";",["T_WHITESPACE","\n\n        ",323],["T_COMMENT","\/\/ add product attributes to select\n",325],["T_WHITESPACE","        ",326],["T_FOREACH","foreach",326],["T_WHITESPACE"," ",326],"(",["T_ARRAY","array",326],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",326],["T_WHITESPACE"," ",326],["T_DOUBLE_ARROW","=>",326],["T_WHITESPACE"," ",326],["T_CONSTANT_ENCAPSED_STRING","'value'",326],")",["T_WHITESPACE"," ",326],["T_AS","as",326],["T_WHITESPACE"," ",326],["T_VARIABLE","$field",326],["T_WHITESPACE"," ",326],["T_DOUBLE_ARROW","=>",326],["T_WHITESPACE"," ",326],["T_VARIABLE","$fieldName",326],")",["T_WHITESPACE"," ",326],"{",["T_WHITESPACE","\n            ",326],["T_VARIABLE","$attr",327],["T_WHITESPACE"," ",327],"=",["T_WHITESPACE"," ",327],["T_VARIABLE","$resource",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","getAttribute",327],"(",["T_VARIABLE","$field",327],")",";",["T_WHITESPACE","\n            ",327],["T_VARIABLE","$this",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","_select",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","joinLeft",328],"(",["T_WHITESPACE","\n                ",328],["T_ARRAY","array",329],"(",["T_VARIABLE","$field",329],["T_WHITESPACE"," ",329],["T_DOUBLE_ARROW","=>",329],["T_WHITESPACE"," ",329],["T_VARIABLE","$attr",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","getBackend",329],"(",")",["T_OBJECT_OPERATOR","->",329],["T_STRING","getTable",329],"(",")",")",",",["T_WHITESPACE","\n                ",329],["T_CONSTANT_ENCAPSED_STRING","'tr.product_id = '",330],["T_WHITESPACE"," ",330],".",["T_WHITESPACE"," ",330],["T_VARIABLE","$field",330],["T_WHITESPACE"," ",330],".",["T_WHITESPACE"," ",330],["T_CONSTANT_ENCAPSED_STRING","'.entity_id AND '",330],["T_WHITESPACE"," ",330],".",["T_WHITESPACE"," ",330],["T_VARIABLE","$field",330],["T_WHITESPACE"," ",330],".",["T_WHITESPACE"," ",330],["T_CONSTANT_ENCAPSED_STRING","'.attribute_id = '",330],["T_WHITESPACE"," ",330],".",["T_WHITESPACE"," ",330],["T_VARIABLE","$attr",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","getId",330],"(",")",",",["T_WHITESPACE","\n                ",330],["T_ARRAY","array",331],"(",["T_CONSTANT_ENCAPSED_STRING","'product_'",331],["T_WHITESPACE"," ",331],".",["T_WHITESPACE"," ",331],["T_VARIABLE","$field",331],["T_WHITESPACE"," ",331],["T_DOUBLE_ARROW","=>",331],["T_WHITESPACE"," ",331],["T_VARIABLE","$fieldName",331],")",["T_WHITESPACE","\n            ",331],")",";",["T_WHITESPACE","\n        ",332],"}",["T_WHITESPACE","\n\n        ",333],["T_COMMENT","\/\/ add product fields\n",335],["T_WHITESPACE","        ",336],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","_select",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","joinLeft",336],"(",["T_WHITESPACE","\n            ",336],["T_ARRAY","array",337],"(",["T_CONSTANT_ENCAPSED_STRING","'p'",337],["T_WHITESPACE"," ",337],["T_DOUBLE_ARROW","=>",337],["T_WHITESPACE"," ",337],["T_VARIABLE","$this",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","getTable",337],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",337],")",")",",",["T_WHITESPACE","\n            ",337],["T_CONSTANT_ENCAPSED_STRING","'tr.product_id = p.entity_id'",338],",",["T_WHITESPACE","\n            ",338],["T_ARRAY","array",339],"(",["T_CONSTANT_ENCAPSED_STRING","'product_sku'",339],["T_WHITESPACE"," ",339],["T_DOUBLE_ARROW","=>",339],["T_WHITESPACE"," ",339],["T_CONSTANT_ENCAPSED_STRING","'sku'",339],")",["T_WHITESPACE","\n        ",339],")",";",["T_WHITESPACE","\n\n        ",340],["T_RETURN","return",342],["T_WHITESPACE"," ",342],["T_VARIABLE","$this",342],";",["T_WHITESPACE","\n    ",342],"}",["T_WHITESPACE","\n\n    ",343],["T_DOC_COMMENT","\/**\n     * Sets attribute for count\n     *\n     * @param string $value\n     * @return Mage_Tag_Model_Resource_Customer_Collection\n     *\/",345],["T_WHITESPACE","\n    ",350],["T_PUBLIC","public",351],["T_WHITESPACE"," ",351],["T_FUNCTION","function",351],["T_WHITESPACE"," ",351],["T_STRING","setCountAttribute",351],"(",["T_VARIABLE","$value",351],")",["T_WHITESPACE","\n    ",351],"{",["T_WHITESPACE","\n        ",352],["T_VARIABLE","$this",353],["T_OBJECT_OPERATOR","->",353],["T_STRING","_countAttribute",353],["T_WHITESPACE"," ",353],"=",["T_WHITESPACE"," ",353],["T_VARIABLE","$value",353],";",["T_WHITESPACE","\n        ",353],["T_RETURN","return",354],["T_WHITESPACE"," ",354],["T_VARIABLE","$this",354],";",["T_WHITESPACE","\n    ",354],"}",["T_WHITESPACE","\n\n    ",355],["T_DOC_COMMENT","\/**\n     * Gets attribure for count\n     *\n     * @return string\n     *\/",357],["T_WHITESPACE","\n    ",361],["T_PUBLIC","public",362],["T_WHITESPACE"," ",362],["T_FUNCTION","function",362],["T_WHITESPACE"," ",362],["T_STRING","getCountAttribute",362],"(",")",["T_WHITESPACE","\n    ",362],"{",["T_WHITESPACE","\n        ",363],["T_RETURN","return",364],["T_WHITESPACE"," ",364],["T_VARIABLE","$this",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","_countAttribute",364],";",["T_WHITESPACE","\n    ",364],"}",["T_WHITESPACE","\n\n    ",365],["T_DOC_COMMENT","\/**\n     * Adds field to filter\n     *\n     * @param string $attribute\n     * @param array $condition\n     * @return Mage_Tag_Model_Resource_Customer_Collection\n     *\/",367],["T_WHITESPACE","\n    ",373],["T_PUBLIC","public",374],["T_WHITESPACE"," ",374],["T_FUNCTION","function",374],["T_WHITESPACE"," ",374],["T_STRING","addFieldToFilter",374],"(",["T_VARIABLE","$attribute",374],",",["T_WHITESPACE"," ",374],["T_VARIABLE","$condition",374],["T_WHITESPACE"," ",374],"=",["T_WHITESPACE"," ",374],["T_STRING","null",374],")",["T_WHITESPACE","\n    ",374],"{",["T_WHITESPACE","\n        ",375],["T_IF","if",376],["T_WHITESPACE"," ",376],"(",["T_VARIABLE","$attribute",376],["T_WHITESPACE"," ",376],["T_IS_EQUAL","==",376],["T_WHITESPACE"," ",376],["T_CONSTANT_ENCAPSED_STRING","'name'",376],")",["T_WHITESPACE"," ",376],"{",["T_WHITESPACE","\n            ",376],["T_VARIABLE","$where",377],["T_WHITESPACE"," ",377],"=",["T_WHITESPACE"," ",377],["T_VARIABLE","$this",377],["T_OBJECT_OPERATOR","->",377],["T_STRING","_getConditionSql",377],"(",["T_CONSTANT_ENCAPSED_STRING","'t.name'",377],",",["T_WHITESPACE"," ",377],["T_VARIABLE","$condition",377],")",";",["T_WHITESPACE","\n            ",377],["T_VARIABLE","$this",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","getSelect",378],"(",")",["T_OBJECT_OPERATOR","->",378],["T_STRING","where",378],"(",["T_VARIABLE","$where",378],",",["T_WHITESPACE"," ",378],["T_STRING","null",378],",",["T_WHITESPACE"," ",378],["T_STRING","Varien_Db_Select",378],["T_DOUBLE_COLON","::",378],["T_STRING","TYPE_CONDITION",378],")",";",["T_WHITESPACE","\n            ",378],["T_RETURN","return",379],["T_WHITESPACE"," ",379],["T_VARIABLE","$this",379],";",["T_WHITESPACE","\n        ",379],"}",["T_WHITESPACE"," ",380],["T_ELSE","else",380],["T_WHITESPACE"," ",380],"{",["T_WHITESPACE","\n            ",380],["T_RETURN","return",381],["T_WHITESPACE"," ",381],["T_STRING","parent",381],["T_DOUBLE_COLON","::",381],["T_STRING","addFieldToFilter",381],"(",["T_VARIABLE","$attribute",381],",",["T_WHITESPACE"," ",381],["T_VARIABLE","$condition",381],")",";",["T_WHITESPACE","\n        ",381],"}",["T_WHITESPACE","\n    ",382],"}",["T_WHITESPACE","\n\n    ",383],["T_DOC_COMMENT","\/**\n     * Treat \"order by\" items as attributes to sort\n     *\n     * @return Mage_Tag_Model_Resource_Customer_Collection\n     *\/",385],["T_WHITESPACE","\n    ",389],["T_PROTECTED","protected",390],["T_WHITESPACE"," ",390],["T_FUNCTION","function",390],["T_WHITESPACE"," ",390],["T_STRING","_renderOrders",390],"(",")",["T_WHITESPACE","\n    ",390],"{",["T_WHITESPACE","\n        ",391],["T_IF","if",392],["T_WHITESPACE"," ",392],"(","!",["T_VARIABLE","$this",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","_isOrdersRendered",392],")",["T_WHITESPACE"," ",392],"{",["T_WHITESPACE","\n            ",392],["T_STRING","parent",393],["T_DOUBLE_COLON","::",393],["T_STRING","_renderOrders",393],"(",")",";",["T_WHITESPACE","\n\n            ",393],["T_VARIABLE","$orders",395],["T_WHITESPACE"," ",395],"=",["T_WHITESPACE"," ",395],["T_VARIABLE","$this",395],["T_OBJECT_OPERATOR","->",395],["T_STRING","getSelect",395],"(",")",["T_WHITESPACE","\n                ",395],["T_OBJECT_OPERATOR","->",396],["T_STRING","getPart",396],"(",["T_STRING","Zend_Db_Select",396],["T_DOUBLE_COLON","::",396],["T_STRING","ORDER",396],")",";",["T_WHITESPACE","\n\n            ",396],["T_VARIABLE","$appliedOrders",398],["T_WHITESPACE"," ",398],"=",["T_WHITESPACE"," ",398],["T_ARRAY","array",398],"(",")",";",["T_WHITESPACE","\n            ",398],["T_FOREACH","foreach",399],["T_WHITESPACE"," ",399],"(",["T_VARIABLE","$orders",399],["T_WHITESPACE"," ",399],["T_AS","as",399],["T_WHITESPACE"," ",399],["T_VARIABLE","$order",399],")",["T_WHITESPACE"," ",399],"{",["T_WHITESPACE","\n                ",399],["T_VARIABLE","$appliedOrders",400],"[",["T_VARIABLE","$order",400],"[",["T_LNUMBER","0",400],"]","]",["T_WHITESPACE"," ",400],"=",["T_WHITESPACE"," ",400],["T_STRING","true",400],";",["T_WHITESPACE","\n            ",400],"}",["T_WHITESPACE","\n\n            ",401],["T_FOREACH","foreach",403],["T_WHITESPACE"," ",403],"(",["T_VARIABLE","$this",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","_orders",403],["T_WHITESPACE"," ",403],["T_AS","as",403],["T_WHITESPACE"," ",403],["T_VARIABLE","$field",403],["T_WHITESPACE"," ",403],["T_DOUBLE_ARROW","=>",403],["T_WHITESPACE"," ",403],["T_VARIABLE","$direction",403],")",["T_WHITESPACE"," ",403],"{",["T_WHITESPACE","\n                ",403],["T_IF","if",404],["T_WHITESPACE"," ",404],"(",["T_EMPTY","empty",404],"(",["T_VARIABLE","$appliedOrders",404],"[",["T_VARIABLE","$field",404],"]",")",")",["T_WHITESPACE"," ",404],"{",["T_WHITESPACE","\n                    ",404],["T_VARIABLE","$this",405],["T_OBJECT_OPERATOR","->",405],["T_STRING","_select",405],["T_OBJECT_OPERATOR","->",405],["T_STRING","order",405],"(",["T_NEW","new",405],["T_WHITESPACE"," ",405],["T_STRING","Zend_Db_Expr",405],"(",["T_VARIABLE","$field",405],["T_WHITESPACE"," ",405],".",["T_WHITESPACE"," ",405],["T_CONSTANT_ENCAPSED_STRING","' '",405],["T_WHITESPACE"," ",405],".",["T_WHITESPACE"," ",405],["T_VARIABLE","$direction",405],")",")",";",["T_WHITESPACE","\n                ",405],"}",["T_WHITESPACE","\n            ",406],"}",["T_WHITESPACE","\n        ",407],"}",["T_WHITESPACE","\n        ",408],["T_RETURN","return",409],["T_WHITESPACE"," ",409],["T_VARIABLE","$this",409],";",["T_WHITESPACE","\n    ",409],"}",["T_WHITESPACE","\n",410],"}",["T_WHITESPACE","\n",411]]