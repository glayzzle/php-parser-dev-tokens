[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Tax\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Tax totals modification block. Can be used just as subblock of Mage_Sales_Block_Order_Totals\n *\/",27],["T_WHITESPACE","\n",29],["T_CLASS","class",30],["T_WHITESPACE"," ",30],["T_STRING","Mage_Tax_Block_Sales_Order_Tax",30],["T_WHITESPACE"," ",30],["T_EXTENDS","extends",30],["T_WHITESPACE"," ",30],["T_STRING","Mage_Core_Block_Template",30],["T_WHITESPACE","\n",30],"{",["T_WHITESPACE","\n    ",31],["T_DOC_COMMENT","\/**\n     * Tax configuration model\n     *\n     * @var Mage_Tax_Model_Config\n     *\/",32],["T_WHITESPACE","\n    ",36],["T_PROTECTED","protected",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$_config",37],";",["T_WHITESPACE","\n    ",37],["T_PROTECTED","protected",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$_order",38],";",["T_WHITESPACE","\n    ",38],["T_PROTECTED","protected",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$_source",39],";",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * Initialize configuration object\n     *\/",41],["T_WHITESPACE","\n    ",43],["T_PROTECTED","protected",44],["T_WHITESPACE"," ",44],["T_FUNCTION","function",44],["T_WHITESPACE"," ",44],["T_STRING","_construct",44],"(",")",["T_WHITESPACE","\n    ",44],"{",["T_WHITESPACE","\n        ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","_config",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_STRING","Mage",46],["T_DOUBLE_COLON","::",46],["T_STRING","getSingleton",46],"(",["T_CONSTANT_ENCAPSED_STRING","'tax\/config'",46],")",";",["T_WHITESPACE","\n    ",46],"}",["T_WHITESPACE","\n\n    ",47],["T_DOC_COMMENT","\/**\n     * Check if we nedd display full tax total info\n     *\n     * @return bool\n     *\/",49],["T_WHITESPACE","\n    ",53],["T_PUBLIC","public",54],["T_WHITESPACE"," ",54],["T_FUNCTION","function",54],["T_WHITESPACE"," ",54],["T_STRING","displayFullSummary",54],"(",")",["T_WHITESPACE","\n    ",54],"{",["T_WHITESPACE","\n        ",55],["T_RETURN","return",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","_config",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","displaySalesFullSummary",56],"(",["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","getOrder",56],"(",")",["T_OBJECT_OPERATOR","->",56],["T_STRING","getStore",56],"(",")",")",";",["T_WHITESPACE","\n    ",56],"}",["T_WHITESPACE","\n\n    ",57],["T_DOC_COMMENT","\/**\n     * Get data (totals) source model\n     *\n     * @return Varien_Object\n     *\/",59],["T_WHITESPACE","\n    ",63],["T_PUBLIC","public",64],["T_WHITESPACE"," ",64],["T_FUNCTION","function",64],["T_WHITESPACE"," ",64],["T_STRING","getSource",64],"(",")",["T_WHITESPACE","\n    ",64],"{",["T_WHITESPACE","\n        ",65],["T_RETURN","return",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","_source",66],";",["T_WHITESPACE","\n    ",66],"}",["T_WHITESPACE","\n\n    ",67],["T_DOC_COMMENT","\/**\n     * Initialize all order totals relates with tax\n     *\n     * @return Mage_Tax_Block_Sales_Order_Tax\n     *\/",69],["T_WHITESPACE","\n    ",73],["T_PUBLIC","public",74],["T_WHITESPACE"," ",74],["T_FUNCTION","function",74],["T_WHITESPACE"," ",74],["T_STRING","initTotals",74],"(",")",["T_WHITESPACE","\n    ",74],"{",["T_WHITESPACE","\n        ",75],["T_DOC_COMMENT","\/** @var $parent Mage_Adminhtml_Block_Sales_Order_Invoice_Totals *\/",76],["T_WHITESPACE","\n        ",76],["T_VARIABLE","$parent",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getParentBlock",77],"(",")",";",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","_order",78],["T_WHITESPACE","   ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$parent",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getOrder",78],"(",")",";",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","_source",79],["T_WHITESPACE","  ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$parent",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","getSource",79],"(",")",";",["T_WHITESPACE","\n\n        ",79],["T_VARIABLE","$store",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getStore",81],"(",")",";",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$allowTax",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],"(",["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","_source",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","getTaxAmount",82],"(",")",["T_WHITESPACE"," ",82],">",["T_WHITESPACE"," ",82],["T_LNUMBER","0",82],")",["T_WHITESPACE"," ",82],["T_BOOLEAN_OR","||",82],["T_WHITESPACE"," ",82],"(",["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","_config",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","displaySalesZeroTax",82],"(",["T_VARIABLE","$store",82],")",")",";",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$grandTotal",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_DOUBLE_CAST","(float)",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","_source",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","getGrandTotal",83],"(",")",";",["T_WHITESPACE","\n        ",83],["T_IF","if",84],["T_WHITESPACE"," ",84],"(","!",["T_VARIABLE","$grandTotal",84],["T_WHITESPACE"," ",84],["T_BOOLEAN_OR","||",84],["T_WHITESPACE"," ",84],"(",["T_VARIABLE","$allowTax",84],["T_WHITESPACE"," ",84],["T_BOOLEAN_AND","&&",84],["T_WHITESPACE"," ",84],"!",["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","_config",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","displaySalesTaxWithGrandTotal",84],"(",["T_VARIABLE","$store",84],")",")",")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n            ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","_addTax",85],"(",")",";",["T_WHITESPACE","\n        ",85],"}",["T_WHITESPACE","\n\n        ",86],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","_initSubtotal",88],"(",")",";",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","_initShipping",89],"(",")",";",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","_initDiscount",90],"(",")",";",["T_WHITESPACE","\n        ",90],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","_initGrandTotal",91],"(",")",";",["T_WHITESPACE","\n        ",91],["T_RETURN","return",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],";",["T_WHITESPACE","\n    ",92],"}",["T_WHITESPACE","\n\n    ",93],["T_DOC_COMMENT","\/**\n     * Add tax total string\n     *\n     * @param string $after\n     * @return Mage_Tax_Block_Sales_Order_Tax\n     *\/",95],["T_WHITESPACE","\n    ",100],["T_PROTECTED","protected",101],["T_WHITESPACE"," ",101],["T_FUNCTION","function",101],["T_WHITESPACE"," ",101],["T_STRING","_addTax",101],"(",["T_VARIABLE","$after",101],"=",["T_CONSTANT_ENCAPSED_STRING","'discount'",101],")",["T_WHITESPACE","\n    ",101],"{",["T_WHITESPACE","\n        ",102],["T_VARIABLE","$taxTotal",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_NEW","new",103],["T_WHITESPACE"," ",103],["T_STRING","Varien_Object",103],"(",["T_ARRAY","array",103],"(",["T_WHITESPACE","\n            ",103],["T_CONSTANT_ENCAPSED_STRING","'code'",104],["T_WHITESPACE","      ",104],["T_DOUBLE_ARROW","=>",104],["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'tax'",104],",",["T_WHITESPACE","\n            ",104],["T_CONSTANT_ENCAPSED_STRING","'block_name'",105],["T_DOUBLE_ARROW","=>",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getNameInLayout",105],"(",")",["T_WHITESPACE","\n        ",105],")",")",";",["T_WHITESPACE","\n        ",106],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","getParentBlock",107],"(",")",["T_OBJECT_OPERATOR","->",107],["T_STRING","addTotal",107],"(",["T_VARIABLE","$taxTotal",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$after",107],")",";",["T_WHITESPACE","\n        ",107],["T_RETURN","return",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$this",108],";",["T_WHITESPACE","\n    ",108],"}",["T_WHITESPACE","\n\n    ",109],["T_DOC_COMMENT","\/**\n     * Get order store object\n     *\n     * @return Mage_Core_Model_Store\n     *\/",111],["T_WHITESPACE","\n    ",115],["T_PUBLIC","public",116],["T_WHITESPACE"," ",116],["T_FUNCTION","function",116],["T_WHITESPACE"," ",116],["T_STRING","getStore",116],"(",")",["T_WHITESPACE","\n    ",116],"{",["T_WHITESPACE","\n        ",117],["T_RETURN","return",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","_order",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","getStore",118],"(",")",";",["T_WHITESPACE","\n    ",118],"}",["T_WHITESPACE","\n\n    ",119],["T_PROTECTED","protected",121],["T_WHITESPACE"," ",121],["T_FUNCTION","function",121],["T_WHITESPACE"," ",121],["T_STRING","_initSubtotal",121],"(",")",["T_WHITESPACE","\n    ",121],"{",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$store",123],["T_WHITESPACE","  ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getStore",123],"(",")",";",["T_WHITESPACE","\n        ",123],["T_VARIABLE","$parent",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","getParentBlock",124],"(",")",";",["T_WHITESPACE","\n        ",124],["T_VARIABLE","$subtotal",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_VARIABLE","$parent",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","getTotal",125],"(",["T_CONSTANT_ENCAPSED_STRING","'subtotal'",125],")",";",["T_WHITESPACE","\n        ",125],["T_IF","if",126],["T_WHITESPACE"," ",126],"(","!",["T_VARIABLE","$subtotal",126],")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n            ",126],["T_RETURN","return",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$this",127],";",["T_WHITESPACE","\n        ",127],"}",["T_WHITESPACE","\n        ",128],["T_IF","if",129],["T_WHITESPACE"," ",129],"(",["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","_config",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","displaySalesSubtotalBoth",129],"(",["T_VARIABLE","$store",129],")",")",["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n            ",129],["T_VARIABLE","$subtotal",130],["T_WHITESPACE","       ",130],"=",["T_WHITESPACE"," ",130],["T_DOUBLE_CAST","(float)",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","_source",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getSubtotal",130],"(",")",";",["T_WHITESPACE","\n            ",130],["T_VARIABLE","$baseSubtotal",131],["T_WHITESPACE","   ",131],"=",["T_WHITESPACE"," ",131],["T_DOUBLE_CAST","(float)",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","_source",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","getBaseSubtotal",131],"(",")",";",["T_WHITESPACE","\n            ",131],["T_VARIABLE","$subtotalIncl",132],["T_WHITESPACE","   ",132],"=",["T_WHITESPACE"," ",132],["T_DOUBLE_CAST","(float)",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","_source",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","getSubtotalInclTax",132],"(",")",";",["T_WHITESPACE","\n            ",132],["T_VARIABLE","$baseSubtotalIncl",133],"=",["T_WHITESPACE"," ",133],["T_DOUBLE_CAST","(float)",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_source",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getBaseSubtotalInclTax",133],"(",")",";",["T_WHITESPACE","\n\n            ",133],["T_IF","if",135],["T_WHITESPACE"," ",135],"(","!",["T_VARIABLE","$subtotalIncl",135],["T_WHITESPACE"," ",135],["T_BOOLEAN_OR","||",135],["T_WHITESPACE"," ",135],"!",["T_VARIABLE","$baseSubtotalIncl",135],")",["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n                ",135],["T_COMMENT","\/\/Calculate the subtotal if not set\n",136],["T_WHITESPACE","                ",137],["T_VARIABLE","$subtotalIncl",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_VARIABLE","$subtotal",137],["T_WHITESPACE"," ",137],"+",["T_WHITESPACE"," ",137],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","_source",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","getTaxAmount",137],"(",")",["T_WHITESPACE","\n                    ",137],"-",["T_WHITESPACE"," ",138],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","_source",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","getShippingTaxAmount",138],"(",")",";",["T_WHITESPACE","\n                ",138],["T_VARIABLE","$baseSubtotalIncl",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$baseSubtotal",139],["T_WHITESPACE"," ",139],"+",["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","_source",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getBaseTaxAmount",139],"(",")",["T_WHITESPACE","\n                    ",139],"-",["T_WHITESPACE"," ",140],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","_source",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","getBaseShippingTaxAmount",140],"(",")",";",["T_WHITESPACE","\n\n                ",140],["T_IF","if",142],["T_WHITESPACE"," ",142],"(",["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","_source",142],["T_WHITESPACE"," ",142],["T_INSTANCEOF","instanceof",142],["T_WHITESPACE"," ",142],["T_STRING","Mage_Sales_Model_Order",142],")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n                    ",142],["T_COMMENT","\/\/Adjust the discount amounts for the base and well as the weee to display the right totals\n",143],["T_WHITESPACE","                    ",144],["T_FOREACH","foreach",144],["T_WHITESPACE"," ",144],"(",["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","_source",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","getAllItems",144],"(",")",["T_WHITESPACE"," ",144],["T_AS","as",144],["T_WHITESPACE"," ",144],["T_VARIABLE","$item",144],")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n                        ",144],["T_VARIABLE","$subtotalIncl",145],["T_WHITESPACE"," ",145],["T_PLUS_EQUAL","+=",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$item",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getHiddenTaxAmount",145],"(",")",["T_WHITESPACE"," ",145],"+",["T_WHITESPACE"," ",145],["T_VARIABLE","$item",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getDiscountAppliedForWeeeTax",145],"(",")",";",["T_WHITESPACE","\n                        ",145],["T_VARIABLE","$baseSubtotalIncl",146],["T_WHITESPACE"," ",146],["T_PLUS_EQUAL","+=",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$item",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","getBaseHiddenTaxAmount",146],"(",")",["T_WHITESPACE"," ",146],"+",["T_WHITESPACE","\n                            ",146],["T_VARIABLE","$item",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","getBaseDiscountAppliedForWeeeTax",147],"(",")",";",["T_WHITESPACE","\n                    ",147],"}",["T_WHITESPACE","\n                ",148],"}",["T_WHITESPACE","\n            ",149],"}",["T_WHITESPACE","\n\n            ",150],["T_VARIABLE","$subtotalIncl",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_STRING","max",152],"(",["T_LNUMBER","0",152],",",["T_WHITESPACE"," ",152],["T_VARIABLE","$subtotalIncl",152],")",";",["T_WHITESPACE","\n            ",152],["T_VARIABLE","$baseSubtotalIncl",153],["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_STRING","max",153],"(",["T_LNUMBER","0",153],",",["T_WHITESPACE"," ",153],["T_VARIABLE","$baseSubtotalIncl",153],")",";",["T_WHITESPACE","\n            ",153],["T_VARIABLE","$totalExcl",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_NEW","new",154],["T_WHITESPACE"," ",154],["T_STRING","Varien_Object",154],"(",["T_ARRAY","array",154],"(",["T_WHITESPACE","\n                ",154],["T_CONSTANT_ENCAPSED_STRING","'code'",155],["T_WHITESPACE","      ",155],["T_DOUBLE_ARROW","=>",155],["T_WHITESPACE"," ",155],["T_CONSTANT_ENCAPSED_STRING","'subtotal_excl'",155],",",["T_WHITESPACE","\n                ",155],["T_CONSTANT_ENCAPSED_STRING","'value'",156],["T_WHITESPACE","     ",156],["T_DOUBLE_ARROW","=>",156],["T_WHITESPACE"," ",156],["T_VARIABLE","$subtotal",156],",",["T_WHITESPACE","\n                ",156],["T_CONSTANT_ENCAPSED_STRING","'base_value'",157],["T_DOUBLE_ARROW","=>",157],["T_WHITESPACE"," ",157],["T_VARIABLE","$baseSubtotal",157],",",["T_WHITESPACE","\n                ",157],["T_CONSTANT_ENCAPSED_STRING","'label'",158],["T_WHITESPACE","     ",158],["T_DOUBLE_ARROW","=>",158],["T_WHITESPACE"," ",158],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","__",158],"(",["T_CONSTANT_ENCAPSED_STRING","'Subtotal (Excl.Tax)'",158],")",["T_WHITESPACE","\n            ",158],")",")",";",["T_WHITESPACE","\n            ",159],["T_VARIABLE","$totalIncl",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_NEW","new",160],["T_WHITESPACE"," ",160],["T_STRING","Varien_Object",160],"(",["T_ARRAY","array",160],"(",["T_WHITESPACE","\n                ",160],["T_CONSTANT_ENCAPSED_STRING","'code'",161],["T_WHITESPACE","      ",161],["T_DOUBLE_ARROW","=>",161],["T_WHITESPACE"," ",161],["T_CONSTANT_ENCAPSED_STRING","'subtotal_incl'",161],",",["T_WHITESPACE","\n                ",161],["T_CONSTANT_ENCAPSED_STRING","'value'",162],["T_WHITESPACE","     ",162],["T_DOUBLE_ARROW","=>",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$subtotalIncl",162],",",["T_WHITESPACE","\n                ",162],["T_CONSTANT_ENCAPSED_STRING","'base_value'",163],["T_DOUBLE_ARROW","=>",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$baseSubtotalIncl",163],",",["T_WHITESPACE","\n                ",163],["T_CONSTANT_ENCAPSED_STRING","'label'",164],["T_WHITESPACE","     ",164],["T_DOUBLE_ARROW","=>",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","__",164],"(",["T_CONSTANT_ENCAPSED_STRING","'Subtotal (Incl.Tax)'",164],")",["T_WHITESPACE","\n            ",164],")",")",";",["T_WHITESPACE","\n            ",165],["T_VARIABLE","$parent",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","addTotal",166],"(",["T_VARIABLE","$totalExcl",166],",",["T_WHITESPACE"," ",166],["T_CONSTANT_ENCAPSED_STRING","'subtotal'",166],")",";",["T_WHITESPACE","\n            ",166],["T_VARIABLE","$parent",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","addTotal",167],"(",["T_VARIABLE","$totalIncl",167],",",["T_WHITESPACE"," ",167],["T_CONSTANT_ENCAPSED_STRING","'subtotal_excl'",167],")",";",["T_WHITESPACE","\n            ",167],["T_VARIABLE","$parent",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","removeTotal",168],"(",["T_CONSTANT_ENCAPSED_STRING","'subtotal'",168],")",";",["T_WHITESPACE","\n        ",168],"}",["T_WHITESPACE"," ",169],["T_ELSEIF","elseif",169],["T_WHITESPACE"," ",169],"(",["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","_config",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","displaySalesSubtotalInclTax",169],"(",["T_VARIABLE","$store",169],")",")",["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n            ",169],["T_VARIABLE","$subtotalIncl",170],["T_WHITESPACE","   ",170],"=",["T_WHITESPACE"," ",170],["T_DOUBLE_CAST","(float)",170],["T_WHITESPACE"," ",170],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","_source",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","getSubtotalInclTax",170],"(",")",";",["T_WHITESPACE","\n            ",170],["T_VARIABLE","$baseSubtotalIncl",171],"=",["T_WHITESPACE"," ",171],["T_DOUBLE_CAST","(float)",171],["T_WHITESPACE"," ",171],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","_source",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","getBaseSubtotalInclTax",171],"(",")",";",["T_WHITESPACE","\n\n            ",171],["T_IF","if",173],["T_WHITESPACE"," ",173],"(","!",["T_VARIABLE","$subtotalIncl",173],")",["T_WHITESPACE"," ",173],"{",["T_WHITESPACE","\n                ",173],["T_VARIABLE","$subtotalIncl",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","_source",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","getSubtotal",174],"(",")",["T_WHITESPACE","\n                    ",174],"+",["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","_source",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","getTaxAmount",175],"(",")",["T_WHITESPACE","\n                    ",175],"-",["T_WHITESPACE"," ",176],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","_source",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","getShippingTaxAmount",176],"(",")",";",["T_WHITESPACE","\n            ",176],"}",["T_WHITESPACE","\n            ",177],["T_IF","if",178],["T_WHITESPACE"," ",178],"(","!",["T_VARIABLE","$baseSubtotalIncl",178],")",["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n                ",178],["T_VARIABLE","$baseSubtotalIncl",179],["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","_source",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","getBaseSubtotal",179],"(",")",["T_WHITESPACE","\n                    ",179],"+",["T_WHITESPACE"," ",180],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","_source",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","getBaseTaxAmount",180],"(",")",["T_WHITESPACE","\n                    ",180],"-",["T_WHITESPACE"," ",181],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","_source",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","getBaseShippingTaxAmount",181],"(",")",";",["T_WHITESPACE","\n            ",181],"}",["T_WHITESPACE","\n\n            ",182],["T_VARIABLE","$total",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_VARIABLE","$parent",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getTotal",184],"(",["T_CONSTANT_ENCAPSED_STRING","'subtotal'",184],")",";",["T_WHITESPACE","\n            ",184],["T_IF","if",185],["T_WHITESPACE"," ",185],"(",["T_VARIABLE","$total",185],")",["T_WHITESPACE"," ",185],"{",["T_WHITESPACE","\n                ",185],["T_VARIABLE","$total",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","setValue",186],"(",["T_STRING","max",186],"(",["T_LNUMBER","0",186],",",["T_WHITESPACE"," ",186],["T_VARIABLE","$subtotalIncl",186],")",")",";",["T_WHITESPACE","\n                ",186],["T_VARIABLE","$total",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","setBaseValue",187],"(",["T_STRING","max",187],"(",["T_LNUMBER","0",187],",",["T_WHITESPACE"," ",187],["T_VARIABLE","$baseSubtotalIncl",187],")",")",";",["T_WHITESPACE","\n            ",187],"}",["T_WHITESPACE","\n        ",188],"}",["T_WHITESPACE","\n        ",189],["T_RETURN","return",190],["T_WHITESPACE"," ",190],["T_VARIABLE","$this",190],";",["T_WHITESPACE","\n    ",190],"}",["T_WHITESPACE","\n\n    ",191],["T_PROTECTED","protected",193],["T_WHITESPACE"," ",193],["T_FUNCTION","function",193],["T_WHITESPACE"," ",193],["T_STRING","_initShipping",193],"(",")",["T_WHITESPACE","\n    ",193],"{",["T_WHITESPACE","\n        ",194],["T_VARIABLE","$store",195],["T_WHITESPACE","  ",195],"=",["T_WHITESPACE"," ",195],["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","getStore",195],"(",")",";",["T_WHITESPACE","\n        ",195],["T_VARIABLE","$parent",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","getParentBlock",196],"(",")",";",["T_WHITESPACE","\n        ",196],["T_VARIABLE","$shipping",197],["T_WHITESPACE"," ",197],"=",["T_WHITESPACE"," ",197],["T_VARIABLE","$parent",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","getTotal",197],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping'",197],")",";",["T_WHITESPACE","\n        ",197],["T_IF","if",198],["T_WHITESPACE"," ",198],"(","!",["T_VARIABLE","$shipping",198],")",["T_WHITESPACE"," ",198],"{",["T_WHITESPACE","\n            ",198],["T_RETURN","return",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$this",199],";",["T_WHITESPACE","\n        ",199],"}",["T_WHITESPACE","\n\n        ",200],["T_IF","if",202],["T_WHITESPACE"," ",202],"(",["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","_config",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","displaySalesShippingBoth",202],"(",["T_VARIABLE","$store",202],")",")",["T_WHITESPACE"," ",202],"{",["T_WHITESPACE","\n            ",202],["T_VARIABLE","$shipping",203],["T_WHITESPACE","           ",203],"=",["T_WHITESPACE"," ",203],["T_DOUBLE_CAST","(float)",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","_source",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","getShippingAmount",203],"(",")",";",["T_WHITESPACE","\n            ",203],["T_VARIABLE","$baseShipping",204],["T_WHITESPACE","       ",204],"=",["T_WHITESPACE"," ",204],["T_DOUBLE_CAST","(float)",204],["T_WHITESPACE"," ",204],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","_source",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","getBaseShippingAmount",204],"(",")",";",["T_WHITESPACE","\n            ",204],["T_VARIABLE","$shippingIncl",205],["T_WHITESPACE","       ",205],"=",["T_WHITESPACE"," ",205],["T_DOUBLE_CAST","(float)",205],["T_WHITESPACE"," ",205],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","_source",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","getShippingInclTax",205],"(",")",";",["T_WHITESPACE","\n            ",205],["T_IF","if",206],["T_WHITESPACE"," ",206],"(","!",["T_VARIABLE","$shippingIncl",206],")",["T_WHITESPACE"," ",206],"{",["T_WHITESPACE","\n                ",206],["T_VARIABLE","$shippingIncl",207],["T_WHITESPACE","   ",207],"=",["T_WHITESPACE"," ",207],["T_VARIABLE","$shipping",207],["T_WHITESPACE"," ",207],"+",["T_WHITESPACE"," ",207],["T_DOUBLE_CAST","(float)",207],["T_WHITESPACE"," ",207],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","_source",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","getShippingTaxAmount",207],"(",")",";",["T_WHITESPACE","\n            ",207],"}",["T_WHITESPACE","\n            ",208],["T_VARIABLE","$baseShippingIncl",209],["T_WHITESPACE","   ",209],"=",["T_WHITESPACE"," ",209],["T_DOUBLE_CAST","(float)",209],["T_WHITESPACE"," ",209],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","_source",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","getBaseShippingInclTax",209],"(",")",";",["T_WHITESPACE","\n            ",209],["T_IF","if",210],["T_WHITESPACE"," ",210],"(","!",["T_VARIABLE","$baseShippingIncl",210],")",["T_WHITESPACE"," ",210],"{",["T_WHITESPACE","\n                ",210],["T_VARIABLE","$baseShippingIncl",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_VARIABLE","$baseShipping",211],["T_WHITESPACE"," ",211],"+",["T_WHITESPACE"," ",211],["T_DOUBLE_CAST","(float)",211],["T_WHITESPACE"," ",211],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","_source",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","getBaseShippingTaxAmount",211],"(",")",";",["T_WHITESPACE","\n            ",211],"}",["T_WHITESPACE","\n\n            ",212],["T_VARIABLE","$totalExcl",214],["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_NEW","new",214],["T_WHITESPACE"," ",214],["T_STRING","Varien_Object",214],"(",["T_ARRAY","array",214],"(",["T_WHITESPACE","\n                ",214],["T_CONSTANT_ENCAPSED_STRING","'code'",215],["T_WHITESPACE","      ",215],["T_DOUBLE_ARROW","=>",215],["T_WHITESPACE"," ",215],["T_CONSTANT_ENCAPSED_STRING","'shipping'",215],",",["T_WHITESPACE","\n                ",215],["T_CONSTANT_ENCAPSED_STRING","'value'",216],["T_WHITESPACE","     ",216],["T_DOUBLE_ARROW","=>",216],["T_WHITESPACE"," ",216],["T_VARIABLE","$shipping",216],",",["T_WHITESPACE","\n                ",216],["T_CONSTANT_ENCAPSED_STRING","'base_value'",217],["T_DOUBLE_ARROW","=>",217],["T_WHITESPACE"," ",217],["T_VARIABLE","$baseShipping",217],",",["T_WHITESPACE","\n                ",217],["T_CONSTANT_ENCAPSED_STRING","'label'",218],["T_WHITESPACE","     ",218],["T_DOUBLE_ARROW","=>",218],["T_WHITESPACE"," ",218],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","__",218],"(",["T_CONSTANT_ENCAPSED_STRING","'Shipping & Handling (Excl.Tax)'",218],")",["T_WHITESPACE","\n            ",218],")",")",";",["T_WHITESPACE","\n            ",219],["T_VARIABLE","$totalIncl",220],["T_WHITESPACE"," ",220],"=",["T_WHITESPACE"," ",220],["T_NEW","new",220],["T_WHITESPACE"," ",220],["T_STRING","Varien_Object",220],"(",["T_ARRAY","array",220],"(",["T_WHITESPACE","\n                ",220],["T_CONSTANT_ENCAPSED_STRING","'code'",221],["T_WHITESPACE","      ",221],["T_DOUBLE_ARROW","=>",221],["T_WHITESPACE"," ",221],["T_CONSTANT_ENCAPSED_STRING","'shipping_incl'",221],",",["T_WHITESPACE","\n                ",221],["T_CONSTANT_ENCAPSED_STRING","'value'",222],["T_WHITESPACE","     ",222],["T_DOUBLE_ARROW","=>",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$shippingIncl",222],",",["T_WHITESPACE","\n                ",222],["T_CONSTANT_ENCAPSED_STRING","'base_value'",223],["T_DOUBLE_ARROW","=>",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$baseShippingIncl",223],",",["T_WHITESPACE","\n                ",223],["T_CONSTANT_ENCAPSED_STRING","'label'",224],["T_WHITESPACE","     ",224],["T_DOUBLE_ARROW","=>",224],["T_WHITESPACE"," ",224],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","__",224],"(",["T_CONSTANT_ENCAPSED_STRING","'Shipping & Handling (Incl.Tax)'",224],")",["T_WHITESPACE","\n            ",224],")",")",";",["T_WHITESPACE","\n            ",225],["T_VARIABLE","$parent",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","addTotal",226],"(",["T_VARIABLE","$totalExcl",226],",",["T_WHITESPACE"," ",226],["T_CONSTANT_ENCAPSED_STRING","'shipping'",226],")",";",["T_WHITESPACE","\n            ",226],["T_VARIABLE","$parent",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","addTotal",227],"(",["T_VARIABLE","$totalIncl",227],",",["T_WHITESPACE"," ",227],["T_CONSTANT_ENCAPSED_STRING","'shipping'",227],")",";",["T_WHITESPACE","\n        ",227],"}",["T_WHITESPACE"," ",228],["T_ELSEIF","elseif",228],["T_WHITESPACE"," ",228],"(",["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","_config",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","displaySalesShippingInclTax",228],"(",["T_VARIABLE","$store",228],")",")",["T_WHITESPACE"," ",228],"{",["T_WHITESPACE","\n            ",228],["T_VARIABLE","$shippingIncl",229],["T_WHITESPACE","       ",229],"=",["T_WHITESPACE"," ",229],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","_source",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","getShippingInclTax",229],"(",")",";",["T_WHITESPACE","\n            ",229],["T_IF","if",230],["T_WHITESPACE"," ",230],"(","!",["T_VARIABLE","$shippingIncl",230],")",["T_WHITESPACE"," ",230],"{",["T_WHITESPACE","\n                ",230],["T_VARIABLE","$shippingIncl",231],["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","_source",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","getShippingAmount",231],"(",")",["T_WHITESPACE","\n                    ",231],"+",["T_WHITESPACE"," ",232],["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","_source",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","getShippingTaxAmount",232],"(",")",";",["T_WHITESPACE","\n            ",232],"}",["T_WHITESPACE","\n            ",233],["T_VARIABLE","$baseShippingIncl",234],["T_WHITESPACE","   ",234],"=",["T_WHITESPACE"," ",234],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","_source",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","getBaseShippingInclTax",234],"(",")",";",["T_WHITESPACE","\n            ",234],["T_IF","if",235],["T_WHITESPACE"," ",235],"(","!",["T_VARIABLE","$baseShippingIncl",235],")",["T_WHITESPACE"," ",235],"{",["T_WHITESPACE","\n                ",235],["T_VARIABLE","$baseShippingIncl",236],["T_WHITESPACE"," ",236],"=",["T_WHITESPACE"," ",236],["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","_source",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","getBaseShippingAmount",236],"(",")",["T_WHITESPACE","\n                    ",236],"+",["T_WHITESPACE"," ",237],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","_source",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","getBaseShippingTaxAmount",237],"(",")",";",["T_WHITESPACE","\n            ",237],"}",["T_WHITESPACE","\n            ",238],["T_VARIABLE","$total",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_VARIABLE","$parent",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","getTotal",239],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping'",239],")",";",["T_WHITESPACE","\n            ",239],["T_IF","if",240],["T_WHITESPACE"," ",240],"(",["T_VARIABLE","$total",240],")",["T_WHITESPACE"," ",240],"{",["T_WHITESPACE","\n                ",240],["T_VARIABLE","$total",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","setValue",241],"(",["T_VARIABLE","$shippingIncl",241],")",";",["T_WHITESPACE","\n                ",241],["T_VARIABLE","$total",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","setBaseValue",242],"(",["T_VARIABLE","$baseShippingIncl",242],")",";",["T_WHITESPACE","\n            ",242],"}",["T_WHITESPACE","\n        ",243],"}",["T_WHITESPACE","\n        ",244],["T_RETURN","return",245],["T_WHITESPACE"," ",245],["T_VARIABLE","$this",245],";",["T_WHITESPACE","\n    ",245],"}",["T_WHITESPACE","\n\n    ",246],["T_PROTECTED","protected",248],["T_WHITESPACE"," ",248],["T_FUNCTION","function",248],["T_WHITESPACE"," ",248],["T_STRING","_initDiscount",248],"(",")",["T_WHITESPACE","\n    ",248],"{",["T_WHITESPACE","\n",249],["T_COMMENT","\/\/        $store  = $this->getStore();\n",250],["T_COMMENT","\/\/        $parent = $this->getParentBlock();\n",251],["T_COMMENT","\/\/        if ($this->_config->displaySales) {\n",252],["T_COMMENT","\/\/\n",253],["T_COMMENT","\/\/        } elseif ($this->_config->displaySales) {\n",254],["T_COMMENT","\/\/\n",255],["T_COMMENT","\/\/        }\n",256],["T_WHITESPACE","    ",257],"}",["T_WHITESPACE","\n\n    ",257],["T_PROTECTED","protected",259],["T_WHITESPACE"," ",259],["T_FUNCTION","function",259],["T_WHITESPACE"," ",259],["T_STRING","_initGrandTotal",259],"(",")",["T_WHITESPACE","\n    ",259],"{",["T_WHITESPACE","\n        ",260],["T_VARIABLE","$store",261],["T_WHITESPACE","  ",261],"=",["T_WHITESPACE"," ",261],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","getStore",261],"(",")",";",["T_WHITESPACE","\n        ",261],["T_VARIABLE","$parent",262],["T_WHITESPACE"," ",262],"=",["T_WHITESPACE"," ",262],["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","getParentBlock",262],"(",")",";",["T_WHITESPACE","\n        ",262],["T_VARIABLE","$grandototal",263],["T_WHITESPACE"," ",263],"=",["T_WHITESPACE"," ",263],["T_VARIABLE","$parent",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","getTotal",263],"(",["T_CONSTANT_ENCAPSED_STRING","'grand_total'",263],")",";",["T_WHITESPACE","\n        ",263],["T_IF","if",264],["T_WHITESPACE"," ",264],"(","!",["T_VARIABLE","$grandototal",264],["T_WHITESPACE"," ",264],["T_BOOLEAN_OR","||",264],["T_WHITESPACE"," ",264],"!",["T_DOUBLE_CAST","(float)",264],["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","_source",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","getGrandTotal",264],"(",")",")",["T_WHITESPACE"," ",264],"{",["T_WHITESPACE","\n            ",264],["T_RETURN","return",265],["T_WHITESPACE"," ",265],["T_VARIABLE","$this",265],";",["T_WHITESPACE","\n        ",265],"}",["T_WHITESPACE","\n\n        ",266],["T_IF","if",268],["T_WHITESPACE"," ",268],"(",["T_VARIABLE","$this",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","_config",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","displaySalesTaxWithGrandTotal",268],"(",["T_VARIABLE","$store",268],")",")",["T_WHITESPACE"," ",268],"{",["T_WHITESPACE","\n            ",268],["T_VARIABLE","$grandtotal",269],["T_WHITESPACE","         ",269],"=",["T_WHITESPACE"," ",269],["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","_source",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","getGrandTotal",269],"(",")",";",["T_WHITESPACE","\n            ",269],["T_VARIABLE","$baseGrandtotal",270],["T_WHITESPACE","     ",270],"=",["T_WHITESPACE"," ",270],["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","_source",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","getBaseGrandTotal",270],"(",")",";",["T_WHITESPACE","\n            ",270],["T_VARIABLE","$grandtotalExcl",271],["T_WHITESPACE","     ",271],"=",["T_WHITESPACE"," ",271],["T_VARIABLE","$grandtotal",271],["T_WHITESPACE"," ",271],"-",["T_WHITESPACE"," ",271],["T_VARIABLE","$this",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","_source",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","getTaxAmount",271],"(",")",";",["T_WHITESPACE","\n            ",271],["T_VARIABLE","$baseGrandtotalExcl",272],["T_WHITESPACE"," ",272],"=",["T_WHITESPACE"," ",272],["T_VARIABLE","$baseGrandtotal",272],["T_WHITESPACE"," ",272],"-",["T_WHITESPACE"," ",272],["T_VARIABLE","$this",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","_source",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","getBaseTaxAmount",272],"(",")",";",["T_WHITESPACE","\n            ",272],["T_VARIABLE","$grandtotalExcl",273],["T_WHITESPACE","     ",273],"=",["T_WHITESPACE"," ",273],["T_STRING","max",273],"(",["T_VARIABLE","$grandtotalExcl",273],",",["T_WHITESPACE"," ",273],["T_LNUMBER","0",273],")",";",["T_WHITESPACE","\n            ",273],["T_VARIABLE","$baseGrandtotalExcl",274],["T_WHITESPACE"," ",274],"=",["T_WHITESPACE"," ",274],["T_STRING","max",274],"(",["T_VARIABLE","$baseGrandtotalExcl",274],",",["T_WHITESPACE"," ",274],["T_LNUMBER","0",274],")",";",["T_WHITESPACE","\n            ",274],["T_VARIABLE","$totalExcl",275],["T_WHITESPACE"," ",275],"=",["T_WHITESPACE"," ",275],["T_NEW","new",275],["T_WHITESPACE"," ",275],["T_STRING","Varien_Object",275],"(",["T_ARRAY","array",275],"(",["T_WHITESPACE","\n                ",275],["T_CONSTANT_ENCAPSED_STRING","'code'",276],["T_WHITESPACE","      ",276],["T_DOUBLE_ARROW","=>",276],["T_WHITESPACE"," ",276],["T_CONSTANT_ENCAPSED_STRING","'grand_total'",276],",",["T_WHITESPACE","\n                ",276],["T_CONSTANT_ENCAPSED_STRING","'strong'",277],["T_WHITESPACE","    ",277],["T_DOUBLE_ARROW","=>",277],["T_WHITESPACE"," ",277],["T_STRING","true",277],",",["T_WHITESPACE","\n                ",277],["T_CONSTANT_ENCAPSED_STRING","'value'",278],["T_WHITESPACE","     ",278],["T_DOUBLE_ARROW","=>",278],["T_WHITESPACE"," ",278],["T_VARIABLE","$grandtotalExcl",278],",",["T_WHITESPACE","\n                ",278],["T_CONSTANT_ENCAPSED_STRING","'base_value'",279],["T_DOUBLE_ARROW","=>",279],["T_WHITESPACE"," ",279],["T_VARIABLE","$baseGrandtotalExcl",279],",",["T_WHITESPACE","\n                ",279],["T_CONSTANT_ENCAPSED_STRING","'label'",280],["T_WHITESPACE","     ",280],["T_DOUBLE_ARROW","=>",280],["T_WHITESPACE"," ",280],["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","__",280],"(",["T_CONSTANT_ENCAPSED_STRING","'Grand Total (Excl.Tax)'",280],")",["T_WHITESPACE","\n            ",280],")",")",";",["T_WHITESPACE","\n            ",281],["T_VARIABLE","$totalIncl",282],["T_WHITESPACE"," ",282],"=",["T_WHITESPACE"," ",282],["T_NEW","new",282],["T_WHITESPACE"," ",282],["T_STRING","Varien_Object",282],"(",["T_ARRAY","array",282],"(",["T_WHITESPACE","\n                ",282],["T_CONSTANT_ENCAPSED_STRING","'code'",283],["T_WHITESPACE","      ",283],["T_DOUBLE_ARROW","=>",283],["T_WHITESPACE"," ",283],["T_CONSTANT_ENCAPSED_STRING","'grand_total_incl'",283],",",["T_WHITESPACE","\n                ",283],["T_CONSTANT_ENCAPSED_STRING","'strong'",284],["T_WHITESPACE","    ",284],["T_DOUBLE_ARROW","=>",284],["T_WHITESPACE"," ",284],["T_STRING","true",284],",",["T_WHITESPACE","\n                ",284],["T_CONSTANT_ENCAPSED_STRING","'value'",285],["T_WHITESPACE","     ",285],["T_DOUBLE_ARROW","=>",285],["T_WHITESPACE"," ",285],["T_VARIABLE","$grandtotal",285],",",["T_WHITESPACE","\n                ",285],["T_CONSTANT_ENCAPSED_STRING","'base_value'",286],["T_DOUBLE_ARROW","=>",286],["T_WHITESPACE"," ",286],["T_VARIABLE","$baseGrandtotal",286],",",["T_WHITESPACE","\n                ",286],["T_CONSTANT_ENCAPSED_STRING","'label'",287],["T_WHITESPACE","     ",287],["T_DOUBLE_ARROW","=>",287],["T_WHITESPACE"," ",287],["T_VARIABLE","$this",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","__",287],"(",["T_CONSTANT_ENCAPSED_STRING","'Grand Total (Incl.Tax)'",287],")",["T_WHITESPACE","\n            ",287],")",")",";",["T_WHITESPACE","\n            ",288],["T_VARIABLE","$parent",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","addTotal",289],"(",["T_VARIABLE","$totalExcl",289],",",["T_WHITESPACE"," ",289],["T_CONSTANT_ENCAPSED_STRING","'grand_total'",289],")",";",["T_WHITESPACE","\n            ",289],["T_VARIABLE","$this",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","_addTax",290],"(",["T_CONSTANT_ENCAPSED_STRING","'grand_total'",290],")",";",["T_WHITESPACE","\n            ",290],["T_VARIABLE","$parent",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","addTotal",291],"(",["T_VARIABLE","$totalIncl",291],",",["T_WHITESPACE"," ",291],["T_CONSTANT_ENCAPSED_STRING","'tax'",291],")",";",["T_WHITESPACE","\n        ",291],"}",["T_WHITESPACE","\n        ",292],["T_RETURN","return",293],["T_WHITESPACE"," ",293],["T_VARIABLE","$this",293],";",["T_WHITESPACE","\n    ",293],"}",["T_WHITESPACE","\n\n    ",294],["T_PUBLIC","public",296],["T_WHITESPACE"," ",296],["T_FUNCTION","function",296],["T_WHITESPACE"," ",296],["T_STRING","getOrder",296],"(",")",["T_WHITESPACE","\n    ",296],"{",["T_WHITESPACE","\n        ",297],["T_RETURN","return",298],["T_WHITESPACE"," ",298],["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","_order",298],";",["T_WHITESPACE","\n    ",298],"}",["T_WHITESPACE","\n\n    ",299],["T_PUBLIC","public",301],["T_WHITESPACE"," ",301],["T_FUNCTION","function",301],["T_WHITESPACE"," ",301],["T_STRING","getLabelProperties",301],"(",")",["T_WHITESPACE","\n    ",301],"{",["T_WHITESPACE","\n        ",302],["T_RETURN","return",303],["T_WHITESPACE"," ",303],["T_VARIABLE","$this",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","getParentBlock",303],"(",")",["T_OBJECT_OPERATOR","->",303],["T_STRING","getLabelProperties",303],"(",")",";",["T_WHITESPACE","\n    ",303],"}",["T_WHITESPACE","\n\n    ",304],["T_PUBLIC","public",306],["T_WHITESPACE"," ",306],["T_FUNCTION","function",306],["T_WHITESPACE"," ",306],["T_STRING","getValueProperties",306],"(",")",["T_WHITESPACE","\n    ",306],"{",["T_WHITESPACE","\n        ",307],["T_RETURN","return",308],["T_WHITESPACE"," ",308],["T_VARIABLE","$this",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","getParentBlock",308],"(",")",["T_OBJECT_OPERATOR","->",308],["T_STRING","getValueProperties",308],"(",")",";",["T_WHITESPACE","\n    ",308],"}",["T_WHITESPACE","\n",309],"}",["T_WHITESPACE","\n",310]]