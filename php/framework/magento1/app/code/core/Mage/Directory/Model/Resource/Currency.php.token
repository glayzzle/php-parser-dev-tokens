[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Directory\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Directory Currency Resource Model\n *\n * @category    Mage\n * @package     Mage_Directory\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Directory_Model_Resource_Currency",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Model_Resource_Db_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Currency rate table\n     *\n     * @var string\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_currencyRateTable",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Currency rate cache array\n     *\n     * @var array\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_STATIC","static",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_rateCache",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Define main and currency rate tables\n     *\n     *\/",51],["T_WHITESPACE","\n    ",54],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_FUNCTION","function",55],["T_WHITESPACE"," ",55],["T_STRING","_construct",55],"(",")",["T_WHITESPACE","\n    ",55],"{",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","_init",57],"(",["T_CONSTANT_ENCAPSED_STRING","'directory\/currency'",57],",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'currency_code'",57],")",";",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","_currencyRateTable",58],["T_WHITESPACE","   ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","getTable",58],"(",["T_CONSTANT_ENCAPSED_STRING","'directory\/currency_rate'",58],")",";",["T_WHITESPACE","\n    ",58],"}",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * Retrieve currency rate (only base=>allowed)\n     *\n     * @param Mage_Directory_Model_Currency|string $currencyFrom\n     * @param Mage_Directory_Model_Currency|string $currencyTo\n     * @return float\n     *\/",61],["T_WHITESPACE","\n    ",67],["T_PUBLIC","public",68],["T_WHITESPACE"," ",68],["T_FUNCTION","function",68],["T_WHITESPACE"," ",68],["T_STRING","getRate",68],"(",["T_VARIABLE","$currencyFrom",68],",",["T_WHITESPACE"," ",68],["T_VARIABLE","$currencyTo",68],")",["T_WHITESPACE","\n    ",68],"{",["T_WHITESPACE","\n        ",69],["T_IF","if",70],["T_WHITESPACE"," ",70],"(",["T_VARIABLE","$currencyFrom",70],["T_WHITESPACE"," ",70],["T_INSTANCEOF","instanceof",70],["T_WHITESPACE"," ",70],["T_STRING","Mage_Directory_Model_Currency",70],")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n            ",70],["T_VARIABLE","$currencyFrom",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$currencyFrom",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getCode",71],"(",")",";",["T_WHITESPACE","\n        ",71],"}",["T_WHITESPACE","\n\n        ",72],["T_IF","if",74],["T_WHITESPACE"," ",74],"(",["T_VARIABLE","$currencyTo",74],["T_WHITESPACE"," ",74],["T_INSTANCEOF","instanceof",74],["T_WHITESPACE"," ",74],["T_STRING","Mage_Directory_Model_Currency",74],")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n            ",74],["T_VARIABLE","$currencyTo",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$currencyTo",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getCode",75],"(",")",";",["T_WHITESPACE","\n        ",75],"}",["T_WHITESPACE","\n\n        ",76],["T_IF","if",78],["T_WHITESPACE"," ",78],"(",["T_VARIABLE","$currencyFrom",78],["T_WHITESPACE"," ",78],["T_IS_EQUAL","==",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$currencyTo",78],")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n            ",78],["T_RETURN","return",79],["T_WHITESPACE"," ",79],["T_LNUMBER","1",79],";",["T_WHITESPACE","\n        ",79],"}",["T_WHITESPACE","\n\n        ",80],["T_IF","if",82],["T_WHITESPACE"," ",82],"(","!",["T_ISSET","isset",82],"(",["T_STRING","self",82],["T_DOUBLE_COLON","::",82],["T_VARIABLE","$_rateCache",82],"[",["T_VARIABLE","$currencyFrom",82],"]","[",["T_VARIABLE","$currencyTo",82],"]",")",")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n            ",82],["T_VARIABLE","$read",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","_getReadAdapter",83],"(",")",";",["T_WHITESPACE","\n            ",83],["T_VARIABLE","$bind",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_ARRAY","array",84],"(",["T_WHITESPACE","\n                ",84],["T_CONSTANT_ENCAPSED_STRING","':currency_from'",85],["T_WHITESPACE"," ",85],["T_DOUBLE_ARROW","=>",85],["T_WHITESPACE"," ",85],["T_STRING","strtoupper",85],"(",["T_VARIABLE","$currencyFrom",85],")",",",["T_WHITESPACE","\n                ",85],["T_CONSTANT_ENCAPSED_STRING","':currency_to'",86],["T_WHITESPACE","   ",86],["T_DOUBLE_ARROW","=>",86],["T_WHITESPACE"," ",86],["T_STRING","strtoupper",86],"(",["T_VARIABLE","$currencyTo",86],")",["T_WHITESPACE","\n            ",86],")",";",["T_WHITESPACE","\n            ",87],["T_VARIABLE","$select",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$read",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","select",88],"(",")",["T_WHITESPACE","\n                ",88],["T_OBJECT_OPERATOR","->",89],["T_STRING","from",89],"(",["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","_currencyRateTable",89],",",["T_WHITESPACE"," ",89],["T_CONSTANT_ENCAPSED_STRING","'rate'",89],")",["T_WHITESPACE","\n                ",89],["T_OBJECT_OPERATOR","->",90],["T_STRING","where",90],"(",["T_CONSTANT_ENCAPSED_STRING","'currency_from = :currency_from'",90],")",["T_WHITESPACE","\n                ",90],["T_OBJECT_OPERATOR","->",91],["T_STRING","where",91],"(",["T_CONSTANT_ENCAPSED_STRING","'currency_to = :currency_to'",91],")",";",["T_WHITESPACE","\n\n            ",91],["T_STRING","self",93],["T_DOUBLE_COLON","::",93],["T_VARIABLE","$_rateCache",93],"[",["T_VARIABLE","$currencyFrom",93],"]","[",["T_VARIABLE","$currencyTo",93],"]",["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$read",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","fetchOne",93],"(",["T_VARIABLE","$select",93],",",["T_WHITESPACE"," ",93],["T_VARIABLE","$bind",93],")",";",["T_WHITESPACE","\n        ",93],"}",["T_WHITESPACE","\n\n        ",94],["T_RETURN","return",96],["T_WHITESPACE"," ",96],["T_STRING","self",96],["T_DOUBLE_COLON","::",96],["T_VARIABLE","$_rateCache",96],"[",["T_VARIABLE","$currencyFrom",96],"]","[",["T_VARIABLE","$currencyTo",96],"]",";",["T_WHITESPACE","\n    ",96],"}",["T_WHITESPACE","\n\n    ",97],["T_DOC_COMMENT","\/**\n     * Retrieve currency rate (base=>allowed or allowed=>base)\n     *\n     * @param Mage_Directory_Model_Currency|string $currencyFrom\n     * @param Mage_Directory_Model_Currency|string $currencyTo\n     * @return float\n     *\/",99],["T_WHITESPACE","\n    ",105],["T_PUBLIC","public",106],["T_WHITESPACE"," ",106],["T_FUNCTION","function",106],["T_WHITESPACE"," ",106],["T_STRING","getAnyRate",106],"(",["T_VARIABLE","$currencyFrom",106],",",["T_WHITESPACE"," ",106],["T_VARIABLE","$currencyTo",106],")",["T_WHITESPACE","\n    ",106],"{",["T_WHITESPACE","\n        ",107],["T_IF","if",108],["T_WHITESPACE"," ",108],"(",["T_VARIABLE","$currencyFrom",108],["T_WHITESPACE"," ",108],["T_INSTANCEOF","instanceof",108],["T_WHITESPACE"," ",108],["T_STRING","Mage_Directory_Model_Currency",108],")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n            ",108],["T_VARIABLE","$currencyFrom",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$currencyFrom",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getCode",109],"(",")",";",["T_WHITESPACE","\n        ",109],"}",["T_WHITESPACE","\n\n        ",110],["T_IF","if",112],["T_WHITESPACE"," ",112],"(",["T_VARIABLE","$currencyTo",112],["T_WHITESPACE"," ",112],["T_INSTANCEOF","instanceof",112],["T_WHITESPACE"," ",112],["T_STRING","Mage_Directory_Model_Currency",112],")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n            ",112],["T_VARIABLE","$currencyTo",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_VARIABLE","$currencyTo",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","getCode",113],"(",")",";",["T_WHITESPACE","\n        ",113],"}",["T_WHITESPACE","\n\n        ",114],["T_IF","if",116],["T_WHITESPACE"," ",116],"(",["T_VARIABLE","$currencyFrom",116],["T_WHITESPACE"," ",116],["T_IS_EQUAL","==",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$currencyTo",116],")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n            ",116],["T_RETURN","return",117],["T_WHITESPACE"," ",117],["T_LNUMBER","1",117],";",["T_WHITESPACE","\n        ",117],"}",["T_WHITESPACE","\n\n        ",118],["T_IF","if",120],["T_WHITESPACE"," ",120],"(","!",["T_ISSET","isset",120],"(",["T_STRING","self",120],["T_DOUBLE_COLON","::",120],["T_VARIABLE","$_rateCache",120],"[",["T_VARIABLE","$currencyFrom",120],"]","[",["T_VARIABLE","$currencyTo",120],"]",")",")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n            ",120],["T_VARIABLE","$adapter",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","_getReadAdapter",121],"(",")",";",["T_WHITESPACE","\n            ",121],["T_VARIABLE","$bind",122],["T_WHITESPACE","    ",122],"=",["T_WHITESPACE"," ",122],["T_ARRAY","array",122],"(",["T_WHITESPACE","\n                ",122],["T_CONSTANT_ENCAPSED_STRING","':currency_from'",123],["T_WHITESPACE"," ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_STRING","strtoupper",123],"(",["T_VARIABLE","$currencyFrom",123],")",",",["T_WHITESPACE","\n                ",123],["T_CONSTANT_ENCAPSED_STRING","':currency_to'",124],["T_WHITESPACE","   ",124],["T_DOUBLE_ARROW","=>",124],["T_WHITESPACE"," ",124],["T_STRING","strtoupper",124],"(",["T_VARIABLE","$currencyTo",124],")",["T_WHITESPACE","\n            ",124],")",";",["T_WHITESPACE","\n            ",125],["T_VARIABLE","$select",126],["T_WHITESPACE","  ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$adapter",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","select",126],"(",")",["T_WHITESPACE","\n                ",126],["T_OBJECT_OPERATOR","->",127],["T_STRING","from",127],"(",["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","_currencyRateTable",127],",",["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","'rate'",127],")",["T_WHITESPACE","\n                ",127],["T_OBJECT_OPERATOR","->",128],["T_STRING","where",128],"(",["T_CONSTANT_ENCAPSED_STRING","'currency_from = :currency_from'",128],")",["T_WHITESPACE","\n                ",128],["T_OBJECT_OPERATOR","->",129],["T_STRING","where",129],"(",["T_CONSTANT_ENCAPSED_STRING","'currency_to = :currency_to'",129],")",";",["T_WHITESPACE","\n\n            ",129],["T_VARIABLE","$rate",131],["T_WHITESPACE","    ",131],"=",["T_WHITESPACE"," ",131],["T_VARIABLE","$adapter",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","fetchOne",131],"(",["T_VARIABLE","$select",131],",",["T_WHITESPACE"," ",131],["T_VARIABLE","$bind",131],")",";",["T_WHITESPACE","\n            ",131],["T_IF","if",132],["T_WHITESPACE"," ",132],"(",["T_VARIABLE","$rate",132],["T_WHITESPACE"," ",132],["T_IS_IDENTICAL","===",132],["T_WHITESPACE"," ",132],["T_STRING","false",132],")",["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n                ",132],["T_VARIABLE","$select",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_VARIABLE","$adapter",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","select",133],"(",")",["T_WHITESPACE","\n                    ",133],["T_OBJECT_OPERATOR","->",134],["T_STRING","from",134],"(",["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","_currencyRateTable",134],",",["T_WHITESPACE"," ",134],["T_NEW","new",134],["T_WHITESPACE"," ",134],["T_STRING","Zend_Db_Expr",134],"(",["T_CONSTANT_ENCAPSED_STRING","'1\/rate'",134],")",")",["T_WHITESPACE","\n                    ",134],["T_OBJECT_OPERATOR","->",135],["T_STRING","where",135],"(",["T_CONSTANT_ENCAPSED_STRING","'currency_to = :currency_from'",135],")",["T_WHITESPACE","\n                    ",135],["T_OBJECT_OPERATOR","->",136],["T_STRING","where",136],"(",["T_CONSTANT_ENCAPSED_STRING","'currency_from = :currency_to'",136],")",";",["T_WHITESPACE","\n                ",136],["T_VARIABLE","$rate",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_VARIABLE","$adapter",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","fetchOne",137],"(",["T_VARIABLE","$select",137],",",["T_WHITESPACE"," ",137],["T_VARIABLE","$bind",137],")",";",["T_WHITESPACE","\n            ",137],"}",["T_WHITESPACE","\n            ",138],["T_STRING","self",139],["T_DOUBLE_COLON","::",139],["T_VARIABLE","$_rateCache",139],"[",["T_VARIABLE","$currencyFrom",139],"]","[",["T_VARIABLE","$currencyTo",139],"]",["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$rate",139],";",["T_WHITESPACE","\n        ",139],"}",["T_WHITESPACE","\n\n        ",140],["T_RETURN","return",142],["T_WHITESPACE"," ",142],["T_STRING","self",142],["T_DOUBLE_COLON","::",142],["T_VARIABLE","$_rateCache",142],"[",["T_VARIABLE","$currencyFrom",142],"]","[",["T_VARIABLE","$currencyTo",142],"]",";",["T_WHITESPACE","\n    ",142],"}",["T_WHITESPACE","\n\n    ",143],["T_DOC_COMMENT","\/**\n     * Saving currency rates\n     *\n     * @param array $rates\n     *\/",145],["T_WHITESPACE","\n    ",149],["T_PUBLIC","public",150],["T_WHITESPACE"," ",150],["T_FUNCTION","function",150],["T_WHITESPACE"," ",150],["T_STRING","saveRates",150],"(",["T_VARIABLE","$rates",150],")",["T_WHITESPACE","\n    ",150],"{",["T_WHITESPACE","\n        ",151],["T_IF","if",152],["T_WHITESPACE"," ",152],"(",["T_STRING","is_array",152],"(",["T_VARIABLE","$rates",152],")",["T_WHITESPACE"," ",152],["T_BOOLEAN_AND","&&",152],["T_WHITESPACE"," ",152],["T_STRING","sizeof",152],"(",["T_VARIABLE","$rates",152],")",["T_WHITESPACE"," ",152],">",["T_WHITESPACE"," ",152],["T_LNUMBER","0",152],")",["T_WHITESPACE"," ",152],"{",["T_WHITESPACE","\n            ",152],["T_VARIABLE","$adapter",153],["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","_getWriteAdapter",153],"(",")",";",["T_WHITESPACE","\n            ",153],["T_VARIABLE","$data",154],["T_WHITESPACE","    ",154],"=",["T_WHITESPACE"," ",154],["T_ARRAY","array",154],"(",")",";",["T_WHITESPACE","\n            ",154],["T_FOREACH","foreach",155],["T_WHITESPACE"," ",155],"(",["T_VARIABLE","$rates",155],["T_WHITESPACE"," ",155],["T_AS","as",155],["T_WHITESPACE"," ",155],["T_VARIABLE","$currencyCode",155],["T_WHITESPACE"," ",155],["T_DOUBLE_ARROW","=>",155],["T_WHITESPACE"," ",155],["T_VARIABLE","$rate",155],")",["T_WHITESPACE"," ",155],"{",["T_WHITESPACE","\n                ",155],["T_FOREACH","foreach",156],["T_WHITESPACE"," ",156],"(",["T_VARIABLE","$rate",156],["T_WHITESPACE"," ",156],["T_AS","as",156],["T_WHITESPACE"," ",156],["T_VARIABLE","$currencyTo",156],["T_WHITESPACE"," ",156],["T_DOUBLE_ARROW","=>",156],["T_WHITESPACE"," ",156],["T_VARIABLE","$value",156],")",["T_WHITESPACE"," ",156],"{",["T_WHITESPACE","\n                    ",156],["T_VARIABLE","$value",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_STRING","abs",157],"(",["T_VARIABLE","$value",157],")",";",["T_WHITESPACE","\n                    ",157],["T_IF","if",158],["T_WHITESPACE"," ",158],"(",["T_VARIABLE","$value",158],["T_WHITESPACE"," ",158],["T_IS_EQUAL","==",158],["T_WHITESPACE"," ",158],["T_LNUMBER","0",158],")",["T_WHITESPACE"," ",158],"{",["T_WHITESPACE","\n                        ",158],["T_CONTINUE","continue",159],";",["T_WHITESPACE","\n                    ",159],"}",["T_WHITESPACE","\n                    ",160],["T_VARIABLE","$data",161],"[","]",["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_ARRAY","array",161],"(",["T_WHITESPACE","\n                        ",161],["T_CONSTANT_ENCAPSED_STRING","'currency_from'",162],["T_WHITESPACE"," ",162],["T_DOUBLE_ARROW","=>",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$currencyCode",162],",",["T_WHITESPACE","\n                        ",162],["T_CONSTANT_ENCAPSED_STRING","'currency_to'",163],["T_WHITESPACE","   ",163],["T_DOUBLE_ARROW","=>",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$currencyTo",163],",",["T_WHITESPACE","\n                        ",163],["T_CONSTANT_ENCAPSED_STRING","'rate'",164],["T_WHITESPACE","          ",164],["T_DOUBLE_ARROW","=>",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$value",164],",",["T_WHITESPACE","\n                    ",164],")",";",["T_WHITESPACE","\n                ",165],"}",["T_WHITESPACE","\n            ",166],"}",["T_WHITESPACE","\n            ",167],["T_IF","if",168],["T_WHITESPACE"," ",168],"(",["T_VARIABLE","$data",168],")",["T_WHITESPACE"," ",168],"{",["T_WHITESPACE","\n                ",168],["T_VARIABLE","$adapter",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","insertOnDuplicate",169],"(",["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","_currencyRateTable",169],",",["T_WHITESPACE"," ",169],["T_VARIABLE","$data",169],",",["T_WHITESPACE"," ",169],["T_ARRAY","array",169],"(",["T_CONSTANT_ENCAPSED_STRING","'rate'",169],")",")",";",["T_WHITESPACE","\n            ",169],"}",["T_WHITESPACE","\n        ",170],"}",["T_WHITESPACE"," ",171],["T_ELSE","else",171],["T_WHITESPACE"," ",171],"{",["T_WHITESPACE","\n            ",171],["T_STRING","Mage",172],["T_DOUBLE_COLON","::",172],["T_STRING","throwException",172],"(",["T_STRING","Mage",172],["T_DOUBLE_COLON","::",172],["T_STRING","helper",172],"(",["T_CONSTANT_ENCAPSED_STRING","'directory'",172],")",["T_OBJECT_OPERATOR","->",172],["T_STRING","__",172],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid rates received'",172],")",")",";",["T_WHITESPACE","\n        ",172],"}",["T_WHITESPACE","\n    ",173],"}",["T_WHITESPACE","\n\n    ",174],["T_DOC_COMMENT","\/**\n     * Retrieve config currency data by config path\n     *\n     * @param Mage_Directory_Model_Currency $model\n     * @param string $path\n     *\n     * @return array\n     *\/",176],["T_WHITESPACE","\n    ",183],["T_PUBLIC","public",184],["T_WHITESPACE"," ",184],["T_FUNCTION","function",184],["T_WHITESPACE"," ",184],["T_STRING","getConfigCurrencies",184],"(",["T_VARIABLE","$model",184],",",["T_WHITESPACE"," ",184],["T_VARIABLE","$path",184],")",["T_WHITESPACE","\n    ",184],"{",["T_WHITESPACE","\n        ",185],["T_VARIABLE","$adapter",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","_getReadAdapter",186],"(",")",";",["T_WHITESPACE","\n        ",186],["T_VARIABLE","$bind",187],["T_WHITESPACE","    ",187],"=",["T_WHITESPACE"," ",187],["T_ARRAY","array",187],"(",["T_CONSTANT_ENCAPSED_STRING","':config_path'",187],["T_WHITESPACE"," ",187],["T_DOUBLE_ARROW","=>",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$path",187],")",";",["T_WHITESPACE","\n        ",187],["T_VARIABLE","$select",188],["T_WHITESPACE","  ",188],"=",["T_WHITESPACE"," ",188],["T_VARIABLE","$adapter",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","select",188],"(",")",["T_WHITESPACE","\n                ",188],["T_OBJECT_OPERATOR","->",189],["T_STRING","from",189],"(",["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getTable",189],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/config_data'",189],")",")",["T_WHITESPACE","\n                ",189],["T_OBJECT_OPERATOR","->",190],["T_STRING","where",190],"(",["T_CONSTANT_ENCAPSED_STRING","'path = :config_path'",190],")",";",["T_WHITESPACE","\n        ",190],["T_VARIABLE","$result",191],["T_WHITESPACE","  ",191],"=",["T_WHITESPACE"," ",191],["T_ARRAY","array",191],"(",")",";",["T_WHITESPACE","\n        ",191],["T_VARIABLE","$rowSet",192],["T_WHITESPACE","  ",192],"=",["T_WHITESPACE"," ",192],["T_VARIABLE","$adapter",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","fetchAll",192],"(",["T_VARIABLE","$select",192],",",["T_WHITESPACE"," ",192],["T_VARIABLE","$bind",192],")",";",["T_WHITESPACE","\n        ",192],["T_FOREACH","foreach",193],["T_WHITESPACE"," ",193],"(",["T_VARIABLE","$rowSet",193],["T_WHITESPACE"," ",193],["T_AS","as",193],["T_WHITESPACE"," ",193],["T_VARIABLE","$row",193],")",["T_WHITESPACE"," ",193],"{",["T_WHITESPACE","\n            ",193],["T_VARIABLE","$result",194],["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],["T_STRING","array_merge",194],"(",["T_VARIABLE","$result",194],",",["T_WHITESPACE"," ",194],["T_STRING","explode",194],"(",["T_CONSTANT_ENCAPSED_STRING","','",194],",",["T_WHITESPACE"," ",194],["T_VARIABLE","$row",194],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",194],"]",")",")",";",["T_WHITESPACE","\n        ",194],"}",["T_WHITESPACE","\n        ",195],["T_STRING","sort",196],"(",["T_VARIABLE","$result",196],")",";",["T_WHITESPACE","\n\n        ",196],["T_RETURN","return",198],["T_WHITESPACE"," ",198],["T_STRING","array_unique",198],"(",["T_VARIABLE","$result",198],")",";",["T_WHITESPACE","\n    ",198],"}",["T_WHITESPACE","\n\n    ",199],["T_DOC_COMMENT","\/**\n     * Return currency rates\n     *\n     * @param string|array $currency\n     * @param array $toCurrencies\n     *\n     * @return array\n     *\/",201],["T_WHITESPACE","\n    ",208],["T_PUBLIC","public",209],["T_WHITESPACE"," ",209],["T_FUNCTION","function",209],["T_WHITESPACE"," ",209],["T_STRING","getCurrencyRates",209],"(",["T_VARIABLE","$currency",209],",",["T_WHITESPACE"," ",209],["T_VARIABLE","$toCurrencies",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_STRING","null",209],")",["T_WHITESPACE","\n    ",209],"{",["T_WHITESPACE","\n        ",210],["T_VARIABLE","$rates",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_ARRAY","array",211],"(",")",";",["T_WHITESPACE","\n        ",211],["T_IF","if",212],["T_WHITESPACE"," ",212],"(",["T_STRING","is_array",212],"(",["T_VARIABLE","$currency",212],")",")",["T_WHITESPACE"," ",212],"{",["T_WHITESPACE","\n            ",212],["T_FOREACH","foreach",213],["T_WHITESPACE"," ",213],"(",["T_VARIABLE","$currency",213],["T_WHITESPACE"," ",213],["T_AS","as",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$code",213],")",["T_WHITESPACE"," ",213],"{",["T_WHITESPACE","\n                ",213],["T_VARIABLE","$rates",214],"[",["T_VARIABLE","$code",214],"]",["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","_getRatesByCode",214],"(",["T_VARIABLE","$code",214],",",["T_WHITESPACE"," ",214],["T_VARIABLE","$toCurrencies",214],")",";",["T_WHITESPACE","\n            ",214],"}",["T_WHITESPACE","\n        ",215],"}",["T_WHITESPACE"," ",216],["T_ELSE","else",216],["T_WHITESPACE"," ",216],"{",["T_WHITESPACE","\n            ",216],["T_VARIABLE","$rates",217],["T_WHITESPACE"," ",217],"=",["T_WHITESPACE"," ",217],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","_getRatesByCode",217],"(",["T_VARIABLE","$currency",217],",",["T_WHITESPACE"," ",217],["T_VARIABLE","$toCurrencies",217],")",";",["T_WHITESPACE","\n        ",217],"}",["T_WHITESPACE","\n\n        ",218],["T_RETURN","return",220],["T_WHITESPACE"," ",220],["T_VARIABLE","$rates",220],";",["T_WHITESPACE","\n    ",220],"}",["T_WHITESPACE","\n\n    ",221],["T_DOC_COMMENT","\/**\n     * Protected method used by getCurrencyRates() method\n     *\n     * @param string $code\n     * @param array $toCurrencies\n     * @return array\n     *\/",223],["T_WHITESPACE","\n    ",229],["T_PROTECTED","protected",230],["T_WHITESPACE"," ",230],["T_FUNCTION","function",230],["T_WHITESPACE"," ",230],["T_STRING","_getRatesByCode",230],"(",["T_VARIABLE","$code",230],",",["T_WHITESPACE"," ",230],["T_VARIABLE","$toCurrencies",230],["T_WHITESPACE"," ",230],"=",["T_WHITESPACE"," ",230],["T_STRING","null",230],")",["T_WHITESPACE","\n    ",230],"{",["T_WHITESPACE","\n        ",231],["T_VARIABLE","$adapter",232],["T_WHITESPACE"," ",232],"=",["T_WHITESPACE"," ",232],["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","_getReadAdapter",232],"(",")",";",["T_WHITESPACE","\n        ",232],["T_VARIABLE","$bind",233],["T_WHITESPACE","    ",233],"=",["T_WHITESPACE"," ",233],["T_ARRAY","array",233],"(",["T_WHITESPACE","\n            ",233],["T_CONSTANT_ENCAPSED_STRING","':currency_from'",234],["T_WHITESPACE"," ",234],["T_DOUBLE_ARROW","=>",234],["T_WHITESPACE"," ",234],["T_VARIABLE","$code",234],["T_WHITESPACE","\n        ",234],")",";",["T_WHITESPACE","\n        ",235],["T_VARIABLE","$select",236],["T_WHITESPACE","  ",236],"=",["T_WHITESPACE"," ",236],["T_VARIABLE","$adapter",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","select",236],"(",")",["T_WHITESPACE","\n            ",236],["T_OBJECT_OPERATOR","->",237],["T_STRING","from",237],"(",["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","getTable",237],"(",["T_CONSTANT_ENCAPSED_STRING","'directory\/currency_rate'",237],")",",",["T_WHITESPACE"," ",237],["T_ARRAY","array",237],"(",["T_CONSTANT_ENCAPSED_STRING","'currency_to'",237],",",["T_WHITESPACE"," ",237],["T_CONSTANT_ENCAPSED_STRING","'rate'",237],")",")",["T_WHITESPACE","\n            ",237],["T_OBJECT_OPERATOR","->",238],["T_STRING","where",238],"(",["T_CONSTANT_ENCAPSED_STRING","'currency_from = :currency_from'",238],")",["T_WHITESPACE","\n            ",238],["T_OBJECT_OPERATOR","->",239],["T_STRING","where",239],"(",["T_CONSTANT_ENCAPSED_STRING","'currency_to IN(?)'",239],",",["T_WHITESPACE"," ",239],["T_VARIABLE","$toCurrencies",239],")",";",["T_WHITESPACE","\n        ",239],["T_VARIABLE","$rowSet",240],["T_WHITESPACE","  ",240],"=",["T_WHITESPACE"," ",240],["T_VARIABLE","$adapter",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","fetchAll",240],"(",["T_VARIABLE","$select",240],",",["T_WHITESPACE"," ",240],["T_VARIABLE","$bind",240],")",";",["T_WHITESPACE","\n        ",240],["T_VARIABLE","$result",241],["T_WHITESPACE","  ",241],"=",["T_WHITESPACE"," ",241],["T_ARRAY","array",241],"(",")",";",["T_WHITESPACE","\n\n        ",241],["T_FOREACH","foreach",243],["T_WHITESPACE"," ",243],"(",["T_VARIABLE","$rowSet",243],["T_WHITESPACE"," ",243],["T_AS","as",243],["T_WHITESPACE"," ",243],["T_VARIABLE","$row",243],")",["T_WHITESPACE"," ",243],"{",["T_WHITESPACE","\n            ",243],["T_VARIABLE","$result",244],"[",["T_VARIABLE","$row",244],"[",["T_CONSTANT_ENCAPSED_STRING","'currency_to'",244],"]","]",["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_VARIABLE","$row",244],"[",["T_CONSTANT_ENCAPSED_STRING","'rate'",244],"]",";",["T_WHITESPACE","\n        ",244],"}",["T_WHITESPACE","\n\n        ",245],["T_RETURN","return",247],["T_WHITESPACE"," ",247],["T_VARIABLE","$result",247],";",["T_WHITESPACE","\n    ",247],"}",["T_WHITESPACE","\n",248],"}",["T_WHITESPACE","\n",249]]