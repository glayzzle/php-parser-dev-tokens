[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_ConfigurableSwatches\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Class implementing the media fallback layer for swatches\n *\/",27],["T_WHITESPACE","\n",29],["T_CLASS","class",30],["T_WHITESPACE"," ",30],["T_STRING","Mage_ConfigurableSwatches_Helper_Mediafallback",30],["T_WHITESPACE"," ",30],["T_EXTENDS","extends",30],["T_WHITESPACE"," ",30],["T_STRING","Mage_Core_Helper_Abstract",30],["T_WHITESPACE","\n",30],"{",["T_WHITESPACE","\n    ",31],["T_CONST","const",32],["T_WHITESPACE"," ",32],["T_STRING","MEDIA_GALLERY_ATTRIBUTE_CODE",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","'media_gallery'",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * Set child_attribute_label_mapping on products with attribute label -> product mapping\n     * Depends on following product data:\n     * - product must have children products attached\n     *\n     * @param array $parentProducts\n     * @deprecated use $this->attachProductChildrenAttributeMapping() instead\n     * @param $storeId\n     * @return void\n     *\/",34],["T_WHITESPACE","\n    ",43],["T_PUBLIC","public",44],["T_WHITESPACE"," ",44],["T_FUNCTION","function",44],["T_WHITESPACE"," ",44],["T_STRING","attachConfigurableProductChildrenAttributeMapping",44],"(",["T_ARRAY","array",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$parentProducts",44],",",["T_WHITESPACE"," ",44],["T_VARIABLE","$storeId",44],")",["T_WHITESPACE","\n    ",44],"{",["T_WHITESPACE","\n        ",45],["T_RETURN","return",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","attachProductChildrenAttributeMapping",46],"(",["T_VARIABLE","$parentProducts",46],",",["T_WHITESPACE"," ",46],["T_VARIABLE","$storeId",46],")",";",["T_WHITESPACE","\n    ",46],"}",["T_WHITESPACE","\n\n    ",47],["T_DOC_COMMENT","\/**\n     * Set child_attribute_label_mapping on products with attribute label -> product mapping\n     * Depends on following product data:\n     * - product must have children products attached\n     *\n     * @param array $parentProducts\n     * @param $storeId\n     * @param bool $onlyListAttributes\n     * @return void\n     *\/",49],["T_WHITESPACE","\n    ",58],["T_PUBLIC","public",59],["T_WHITESPACE"," ",59],["T_FUNCTION","function",59],["T_WHITESPACE"," ",59],["T_STRING","attachProductChildrenAttributeMapping",59],"(",["T_ARRAY","array",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$parentProducts",59],",",["T_WHITESPACE"," ",59],["T_VARIABLE","$storeId",59],",",["T_WHITESPACE"," ",59],["T_VARIABLE","$onlyListAttributes",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_STRING","false",59],")",["T_WHITESPACE","\n    ",59],"{",["T_WHITESPACE","\n        ",60],["T_DOC_COMMENT","\/** @var  $listSwatchAttr Mage_Eav_Model_Attribute *\/",61],["T_WHITESPACE","\n        ",61],["T_VARIABLE","$listSwatchAttr",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_STRING","Mage",62],["T_DOUBLE_COLON","::",62],["T_STRING","helper",62],"(",["T_CONSTANT_ENCAPSED_STRING","'configurableswatches\/productlist'",62],")",["T_OBJECT_OPERATOR","->",62],["T_STRING","getSwatchAttribute",62],"(",")",";",["T_WHITESPACE","\n        ",62],["T_VARIABLE","$swatchAttributeIds",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_ARRAY","array",63],"(",")",";",["T_WHITESPACE","\n        ",63],["T_IF","if",64],["T_WHITESPACE"," ",64],"(","!",["T_VARIABLE","$onlyListAttributes",64],")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n            ",64],["T_VARIABLE","$swatchAttributeIds",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_STRING","Mage",65],["T_DOUBLE_COLON","::",65],["T_STRING","helper",65],"(",["T_CONSTANT_ENCAPSED_STRING","'configurableswatches'",65],")",["T_OBJECT_OPERATOR","->",65],["T_STRING","getSwatchAttributeIds",65],"(",")",";",["T_WHITESPACE","\n        ",65],"}",["T_WHITESPACE","\n        ",66],["T_IF","if",67],["T_WHITESPACE"," ",67],"(",["T_VARIABLE","$listSwatchAttr",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getId",67],"(",")",")",["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n            ",67],["T_VARIABLE","$swatchAttributeIds",68],"[","]",["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$listSwatchAttr",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","getId",68],"(",")",";",["T_WHITESPACE","\n        ",68],"}",["T_WHITESPACE","\n        ",69],["T_IF","if",70],["T_WHITESPACE"," ",70],"(",["T_EMPTY","empty",70],"(",["T_VARIABLE","$swatchAttributeIds",70],")",")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n            ",70],["T_RETURN","return",71],";",["T_WHITESPACE","\n        ",71],"}",["T_WHITESPACE","\n\n        ",72],["T_VARIABLE","$parentProductIds",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_ARRAY","array",74],"(",")",";",["T_WHITESPACE","\n        ",74],["T_COMMENT","\/* @var $parentProduct Mage_Catalog_Model_Product *\/",75],["T_WHITESPACE","\n        ",75],["T_FOREACH","foreach",76],["T_WHITESPACE"," ",76],"(",["T_VARIABLE","$parentProducts",76],["T_WHITESPACE"," ",76],["T_AS","as",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$parentProduct",76],")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n            ",76],["T_VARIABLE","$parentProductIds",77],"[","]",["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$parentProduct",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getId",77],"(",")",";",["T_WHITESPACE","\n        ",77],"}",["T_WHITESPACE","\n\n        ",78],["T_VARIABLE","$configAttributes",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_STRING","Mage",80],["T_DOUBLE_COLON","::",80],["T_STRING","getResourceModel",80],"(",["T_CONSTANT_ENCAPSED_STRING","'configurableswatches\/catalog_product_attribute_super_collection'",80],")",["T_WHITESPACE","\n            ",80],["T_OBJECT_OPERATOR","->",81],["T_STRING","addParentProductsFilter",81],"(",["T_VARIABLE","$parentProductIds",81],")",["T_WHITESPACE","\n            ",81],["T_OBJECT_OPERATOR","->",82],["T_STRING","attachEavAttributes",82],"(",")",["T_WHITESPACE","\n            ",82],["T_OBJECT_OPERATOR","->",83],["T_STRING","addFieldToFilter",83],"(",["T_CONSTANT_ENCAPSED_STRING","'eav_attributes.attribute_id'",83],",",["T_WHITESPACE"," ",83],["T_ARRAY","array",83],"(",["T_CONSTANT_ENCAPSED_STRING","'in'",83],["T_WHITESPACE"," ",83],["T_DOUBLE_ARROW","=>",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$swatchAttributeIds",83],")",")",["T_WHITESPACE","\n            ",83],["T_OBJECT_OPERATOR","->",84],["T_STRING","setStoreId",84],"(",["T_VARIABLE","$storeId",84],")",["T_WHITESPACE","\n        ",84],";",["T_WHITESPACE","\n\n        ",85],["T_VARIABLE","$optionLabels",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_ARRAY","array",87],"(",")",";",["T_WHITESPACE","\n        ",87],["T_FOREACH","foreach",88],["T_WHITESPACE"," ",88],"(",["T_VARIABLE","$configAttributes",88],["T_WHITESPACE"," ",88],["T_AS","as",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$attribute",88],")",["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n            ",88],["T_VARIABLE","$optionLabels",89],["T_WHITESPACE"," ",89],["T_PLUS_EQUAL","+=",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$attribute",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getOptionLabels",89],"(",")",";",["T_WHITESPACE","\n        ",89],"}",["T_WHITESPACE","\n\n        ",90],["T_COMMENT","\/\/ normalize to all lower case before we start using them\n",92],["T_WHITESPACE","        ",93],["T_VARIABLE","$optionLabels",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_STRING","array_map",93],"(",["T_FUNCTION","function",93],["T_WHITESPACE"," ",93],"(",["T_VARIABLE","$value",93],")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n            ",93],["T_RETURN","return",94],["T_WHITESPACE"," ",94],["T_STRING","array_map",94],"(",["T_CONSTANT_ENCAPSED_STRING","'Mage_ConfigurableSwatches_Helper_Data::normalizeKey'",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$value",94],")",";",["T_WHITESPACE","\n        ",94],"}",",",["T_WHITESPACE"," ",95],["T_VARIABLE","$optionLabels",95],")",";",["T_WHITESPACE","\n\n        ",95],["T_FOREACH","foreach",97],["T_WHITESPACE"," ",97],"(",["T_VARIABLE","$parentProducts",97],["T_WHITESPACE"," ",97],["T_AS","as",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$parentProduct",97],")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n            ",97],["T_VARIABLE","$mapping",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_ARRAY","array",98],"(",")",";",["T_WHITESPACE","\n            ",98],["T_VARIABLE","$listSwatchValues",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_ARRAY","array",99],"(",")",";",["T_WHITESPACE","\n            ",99],["T_VARIABLE","$listSwatchStockValues",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_ARRAY","array",100],"(",")",";",["T_WHITESPACE","\n\n            ",100],["T_COMMENT","\/* @var $attribute Mage_Catalog_Model_Product_Type_Configurable_Attribute *\/",102],["T_WHITESPACE","\n            ",102],["T_FOREACH","foreach",103],["T_WHITESPACE"," ",103],"(",["T_VARIABLE","$configAttributes",103],["T_WHITESPACE"," ",103],["T_AS","as",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$attribute",103],")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n                ",103],["T_COMMENT","\/* @var $childProduct Mage_Catalog_Model_Product *\/",104],["T_WHITESPACE","\n                ",104],["T_IF","if",105],["T_WHITESPACE"," ",105],"(","!",["T_STRING","is_array",105],"(",["T_VARIABLE","$parentProduct",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getChildrenProducts",105],"(",")",")",")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n                    ",105],["T_CONTINUE","continue",106],";",["T_WHITESPACE","\n                ",106],"}",["T_WHITESPACE","\n\n                ",107],["T_FOREACH","foreach",109],["T_WHITESPACE"," ",109],"(",["T_VARIABLE","$parentProduct",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getChildrenProducts",109],"(",")",["T_WHITESPACE"," ",109],["T_AS","as",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$childProduct",109],")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n\n                    ",109],["T_COMMENT","\/\/ product has no value for attribute or not available, we can't process it\n",111],["T_WHITESPACE","                    ",112],["T_VARIABLE","$isInStock",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$childProduct",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","getStockItem",112],"(",")",["T_OBJECT_OPERATOR","->",112],["T_STRING","getIsInStock",112],"(",")",";",["T_WHITESPACE","\n                    ",112],["T_IF","if",113],["T_WHITESPACE"," ",113],"(","!",["T_VARIABLE","$childProduct",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","hasData",113],"(",["T_VARIABLE","$attribute",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","getAttributeCode",113],"(",")",")",["T_WHITESPACE","\n                        ",113],["T_BOOLEAN_OR","||",114],["T_WHITESPACE"," ",114],"(","!",["T_VARIABLE","$isInStock",114],["T_WHITESPACE"," ",114],["T_BOOLEAN_AND","&&",114],["T_WHITESPACE"," ",114],"!",["T_STRING","Mage",114],["T_DOUBLE_COLON","::",114],["T_STRING","helper",114],"(",["T_CONSTANT_ENCAPSED_STRING","'cataloginventory'",114],")",["T_OBJECT_OPERATOR","->",114],["T_STRING","isShowOutOfStock",114],"(",")",")",")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n                        ",114],["T_CONTINUE","continue",115],";",["T_WHITESPACE","\n                    ",115],"}",["T_WHITESPACE","\n                    ",116],["T_VARIABLE","$optionId",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_VARIABLE","$childProduct",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getData",117],"(",["T_VARIABLE","$attribute",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getAttributeCode",117],"(",")",")",";",["T_WHITESPACE","\n\n                    ",117],["T_COMMENT","\/\/ if we don't have a default label, skip it\n",119],["T_WHITESPACE","                    ",120],["T_IF","if",120],["T_WHITESPACE"," ",120],"(","!",["T_ISSET","isset",120],"(",["T_VARIABLE","$optionLabels",120],"[",["T_VARIABLE","$optionId",120],"]","[",["T_LNUMBER","0",120],"]",")",")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n                        ",120],["T_CONTINUE","continue",121],";",["T_WHITESPACE","\n                    ",121],"}",["T_WHITESPACE","\n\n                    ",122],["T_COMMENT","\/\/ using default value as key unless store-specific label is present\n",124],["T_WHITESPACE","                    ",125],["T_VARIABLE","$optionLabel",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_VARIABLE","$optionLabels",125],"[",["T_VARIABLE","$optionId",125],"]","[",["T_LNUMBER","0",125],"]",";",["T_WHITESPACE","\n                    ",125],["T_IF","if",126],["T_WHITESPACE"," ",126],"(",["T_ISSET","isset",126],"(",["T_VARIABLE","$optionLabels",126],"[",["T_VARIABLE","$optionId",126],"]","[",["T_VARIABLE","$storeId",126],"]",")",")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n                        ",126],["T_VARIABLE","$optionLabel",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_VARIABLE","$optionLabels",127],"[",["T_VARIABLE","$optionId",127],"]","[",["T_VARIABLE","$storeId",127],"]",";",["T_WHITESPACE","\n                    ",127],"}",["T_WHITESPACE","\n\n                    ",128],["T_COMMENT","\/\/ initialize arrays if not present\n",130],["T_WHITESPACE","                    ",131],["T_IF","if",131],["T_WHITESPACE"," ",131],"(","!",["T_ISSET","isset",131],"(",["T_VARIABLE","$mapping",131],"[",["T_VARIABLE","$optionLabel",131],"]",")",")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n                        ",131],["T_VARIABLE","$mapping",132],"[",["T_VARIABLE","$optionLabel",132],"]",["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_ARRAY","array",132],"(",["T_WHITESPACE","\n                            ",132],["T_CONSTANT_ENCAPSED_STRING","'product_ids'",133],["T_WHITESPACE"," ",133],["T_DOUBLE_ARROW","=>",133],["T_WHITESPACE"," ",133],["T_ARRAY","array",133],"(",")",",",["T_WHITESPACE","\n                        ",133],")",";",["T_WHITESPACE","\n                    ",134],"}",["T_WHITESPACE","\n                    ",135],["T_VARIABLE","$mapping",136],"[",["T_VARIABLE","$optionLabel",136],"]","[",["T_CONSTANT_ENCAPSED_STRING","'product_ids'",136],"]","[","]",["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_VARIABLE","$childProduct",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getId",136],"(",")",";",["T_WHITESPACE","\n                    ",136],["T_VARIABLE","$mapping",137],"[",["T_VARIABLE","$optionLabel",137],"]","[",["T_CONSTANT_ENCAPSED_STRING","'label'",137],"]",["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_VARIABLE","$optionLabel",137],";",["T_WHITESPACE","\n                    ",137],["T_VARIABLE","$mapping",138],"[",["T_VARIABLE","$optionLabel",138],"]","[",["T_CONSTANT_ENCAPSED_STRING","'default_label'",138],"]",["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_VARIABLE","$optionLabels",138],"[",["T_VARIABLE","$optionId",138],"]","[",["T_LNUMBER","0",138],"]",";",["T_WHITESPACE","\n                    ",138],["T_VARIABLE","$mapping",139],"[",["T_VARIABLE","$optionLabel",139],"]","[",["T_CONSTANT_ENCAPSED_STRING","'labels'",139],"]",["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$optionLabels",139],"[",["T_VARIABLE","$optionId",139],"]",";",["T_WHITESPACE","\n\n                    ",139],["T_IF","if",141],["T_WHITESPACE"," ",141],"(",["T_VARIABLE","$attribute",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getAttributeId",141],"(",")",["T_WHITESPACE"," ",141],["T_IS_EQUAL","==",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$listSwatchAttr",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getAttributeId",141],"(",")",["T_WHITESPACE","\n                        ",141],["T_BOOLEAN_AND","&&",142],["T_WHITESPACE"," ",142],"!",["T_STRING","in_array",142],"(",["T_VARIABLE","$mapping",142],"[",["T_VARIABLE","$optionLabel",142],"]","[",["T_CONSTANT_ENCAPSED_STRING","'label'",142],"]",",",["T_WHITESPACE"," ",142],["T_VARIABLE","$listSwatchValues",142],")",["T_WHITESPACE","\n                    ",142],")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n                        ",143],["T_VARIABLE","$listSwatchValues",144],"[",["T_VARIABLE","$optionId",144],"]",["T_WHITESPACE","      ",144],"=",["T_WHITESPACE"," ",144],["T_VARIABLE","$mapping",144],"[",["T_VARIABLE","$optionLabel",144],"]","[",["T_CONSTANT_ENCAPSED_STRING","'label'",144],"]",";",["T_WHITESPACE","\n                        ",144],["T_VARIABLE","$listSwatchStockValues",145],"[",["T_VARIABLE","$optionId",145],"]",["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_VARIABLE","$isInStock",145],";",["T_WHITESPACE","\n                    ",145],"}",["T_WHITESPACE","\n                ",146],"}",["T_WHITESPACE"," ",147],["T_COMMENT","\/\/ end looping child products\n",147],["T_WHITESPACE","            ",148],"}",["T_WHITESPACE"," ",148],["T_COMMENT","\/\/ end looping attributes\n",148],["T_WHITESPACE","\n\n            ",149],["T_FOREACH","foreach",151],["T_WHITESPACE"," ",151],"(",["T_VARIABLE","$mapping",151],["T_WHITESPACE"," ",151],["T_AS","as",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$key",151],["T_WHITESPACE"," ",151],["T_DOUBLE_ARROW","=>",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$value",151],")",["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n                ",151],["T_VARIABLE","$mapping",152],"[",["T_VARIABLE","$key",152],"]","[",["T_CONSTANT_ENCAPSED_STRING","'product_ids'",152],"]",["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_STRING","array_unique",152],"(",["T_VARIABLE","$mapping",152],"[",["T_VARIABLE","$key",152],"]","[",["T_CONSTANT_ENCAPSED_STRING","'product_ids'",152],"]",")",";",["T_WHITESPACE","\n            ",152],"}",["T_WHITESPACE","\n\n            ",153],["T_IF","if",155],["T_WHITESPACE"," ",155],"(",["T_STRING","count",155],"(",["T_VARIABLE","$listSwatchValues",155],")",")",["T_WHITESPACE"," ",155],"{",["T_WHITESPACE","\n                ",155],["T_VARIABLE","$listSwatchValues",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_STRING","array_replace",156],"(",["T_STRING","array_intersect_key",156],"(",["T_VARIABLE","$optionLabels",156],",",["T_WHITESPACE"," ",156],["T_VARIABLE","$listSwatchValues",156],")",",",["T_WHITESPACE","\n                    ",156],["T_VARIABLE","$listSwatchValues",157],")",";",["T_WHITESPACE","\n            ",157],"}",["T_WHITESPACE","\n            ",158],["T_VARIABLE","$parentProduct",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","setChildAttributeLabelMapping",159],"(",["T_VARIABLE","$mapping",159],")",["T_WHITESPACE","\n                ",159],["T_OBJECT_OPERATOR","->",160],["T_STRING","setListSwatchAttrValues",160],"(",["T_VARIABLE","$listSwatchValues",160],")",["T_WHITESPACE","\n                ",160],["T_OBJECT_OPERATOR","->",161],["T_STRING","setListSwatchAttrStockValues",161],"(",["T_VARIABLE","$listSwatchStockValues",161],")",";",["T_WHITESPACE","\n        ",161],"}",["T_WHITESPACE"," ",162],["T_COMMENT","\/\/ end looping parent products\n",162],["T_WHITESPACE","    ",163],"}",["T_WHITESPACE","\n\n    ",163],["T_DOC_COMMENT","\/**\n     * For given product, get configurable images fallback array\n     * Depends on following data available on product:\n     * - product must have child attribute label mapping attached\n     * - product must have media gallery attached which attaches and differentiates local images and child images\n     * - product must have child products attached\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @param array $imageTypes - image types to select for child products\n     * @return array\n     *\/",165],["T_WHITESPACE","\n    ",175],["T_PUBLIC","public",176],["T_WHITESPACE"," ",176],["T_FUNCTION","function",176],["T_WHITESPACE"," ",176],["T_STRING","getConfigurableImagesFallbackArray",176],"(",["T_STRING","Mage_Catalog_Model_Product",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$product",176],",",["T_WHITESPACE"," ",176],["T_ARRAY","array",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$imageTypes",176],",",["T_WHITESPACE","\n        ",176],["T_VARIABLE","$keepFrame",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_STRING","false",177],["T_WHITESPACE","\n    ",177],")",["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n        ",178],["T_IF","if",179],["T_WHITESPACE"," ",179],"(","!",["T_VARIABLE","$product",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","hasConfigurableImagesFallbackArray",179],"(",")",")",["T_WHITESPACE"," ",179],"{",["T_WHITESPACE","\n            ",179],["T_VARIABLE","$mapping",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_VARIABLE","$product",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","getChildAttributeLabelMapping",180],"(",")",";",["T_WHITESPACE","\n\n            ",180],["T_VARIABLE","$mediaGallery",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_VARIABLE","$product",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","getMediaGallery",182],"(",")",";",["T_WHITESPACE","\n\n            ",182],["T_IF","if",184],["T_WHITESPACE"," ",184],"(","!",["T_ISSET","isset",184],"(",["T_VARIABLE","$mediaGallery",184],"[",["T_CONSTANT_ENCAPSED_STRING","'images'",184],"]",")",")",["T_WHITESPACE"," ",184],"{",["T_WHITESPACE","\n                ",184],["T_RETURN","return",185],["T_WHITESPACE"," ",185],["T_ARRAY","array",185],"(",")",";",["T_WHITESPACE"," ",185],["T_COMMENT","\/\/nothing to do here\n",185],["T_WHITESPACE","            ",186],"}",["T_WHITESPACE","\n\n            ",186],["T_COMMENT","\/\/ ensure we only attempt to process valid image types we know about\n",188],["T_WHITESPACE","            ",189],["T_VARIABLE","$imageTypes",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_STRING","array_intersect",189],"(",["T_ARRAY","array",189],"(",["T_CONSTANT_ENCAPSED_STRING","'image'",189],",",["T_WHITESPACE"," ",189],["T_CONSTANT_ENCAPSED_STRING","'small_image'",189],")",",",["T_WHITESPACE"," ",189],["T_VARIABLE","$imageTypes",189],")",";",["T_WHITESPACE","\n\n            ",189],["T_VARIABLE","$imagesByLabel",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_ARRAY","array",191],"(",")",";",["T_WHITESPACE","\n            ",191],["T_VARIABLE","$imageHaystack",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_STRING","array_map",192],"(",["T_FUNCTION","function",192],["T_WHITESPACE"," ",192],"(",["T_VARIABLE","$value",192],")",["T_WHITESPACE"," ",192],"{",["T_WHITESPACE","\n                ",192],["T_RETURN","return",193],["T_WHITESPACE"," ",193],["T_STRING","Mage_ConfigurableSwatches_Helper_Data",193],["T_DOUBLE_COLON","::",193],["T_STRING","normalizeKey",193],"(",["T_VARIABLE","$value",193],"[",["T_CONSTANT_ENCAPSED_STRING","'label'",193],"]",")",";",["T_WHITESPACE","\n            ",193],"}",",",["T_WHITESPACE"," ",194],["T_VARIABLE","$mediaGallery",194],"[",["T_CONSTANT_ENCAPSED_STRING","'images'",194],"]",")",";",["T_WHITESPACE","\n\n            ",194],["T_COMMENT","\/\/ load images from the configurable product for swapping\n",196],["T_WHITESPACE","            ",197],["T_FOREACH","foreach",197],["T_WHITESPACE"," ",197],"(",["T_VARIABLE","$mapping",197],["T_WHITESPACE"," ",197],["T_AS","as",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$map",197],")",["T_WHITESPACE"," ",197],"{",["T_WHITESPACE","\n                ",197],["T_VARIABLE","$imagePath",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_STRING","null",198],";",["T_WHITESPACE","\n\n                ",198],["T_COMMENT","\/\/search by store-specific label and then default label if nothing is found\n",200],["T_WHITESPACE","                ",201],["T_VARIABLE","$imageKey",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_STRING","array_search",201],"(",["T_VARIABLE","$map",201],"[",["T_CONSTANT_ENCAPSED_STRING","'label'",201],"]",",",["T_WHITESPACE"," ",201],["T_VARIABLE","$imageHaystack",201],")",";",["T_WHITESPACE","\n                ",201],["T_IF","if",202],["T_WHITESPACE"," ",202],"(",["T_VARIABLE","$imageKey",202],["T_WHITESPACE"," ",202],["T_IS_IDENTICAL","===",202],["T_WHITESPACE"," ",202],["T_STRING","false",202],")",["T_WHITESPACE"," ",202],"{",["T_WHITESPACE","\n                    ",202],["T_VARIABLE","$imageKey",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_STRING","array_search",203],"(",["T_VARIABLE","$map",203],"[",["T_CONSTANT_ENCAPSED_STRING","'default_label'",203],"]",",",["T_WHITESPACE"," ",203],["T_VARIABLE","$imageHaystack",203],")",";",["T_WHITESPACE","\n                ",203],"}",["T_WHITESPACE","\n\n                ",204],["T_COMMENT","\/\/assign proper image file if found\n",206],["T_WHITESPACE","                ",207],["T_IF","if",207],["T_WHITESPACE"," ",207],"(",["T_VARIABLE","$imageKey",207],["T_WHITESPACE"," ",207],["T_IS_NOT_IDENTICAL","!==",207],["T_WHITESPACE"," ",207],["T_STRING","false",207],")",["T_WHITESPACE"," ",207],"{",["T_WHITESPACE","\n                    ",207],["T_VARIABLE","$imagePath",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_VARIABLE","$mediaGallery",208],"[",["T_CONSTANT_ENCAPSED_STRING","'images'",208],"]","[",["T_VARIABLE","$imageKey",208],"]","[",["T_CONSTANT_ENCAPSED_STRING","'file'",208],"]",";",["T_WHITESPACE","\n                ",208],"}",["T_WHITESPACE","\n\n                ",209],["T_VARIABLE","$imagesByLabel",211],"[",["T_VARIABLE","$map",211],"[",["T_CONSTANT_ENCAPSED_STRING","'label'",211],"]","]",["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_ARRAY","array",211],"(",["T_WHITESPACE","\n                    ",211],["T_CONSTANT_ENCAPSED_STRING","'configurable_product'",212],["T_WHITESPACE"," ",212],["T_DOUBLE_ARROW","=>",212],["T_WHITESPACE"," ",212],["T_ARRAY","array",212],"(",["T_WHITESPACE","\n                        ",212],["T_STRING","Mage_ConfigurableSwatches_Helper_Productimg",213],["T_DOUBLE_COLON","::",213],["T_STRING","MEDIA_IMAGE_TYPE_SMALL",213],["T_WHITESPACE"," ",213],["T_DOUBLE_ARROW","=>",213],["T_WHITESPACE"," ",213],["T_STRING","null",213],",",["T_WHITESPACE","\n                        ",213],["T_STRING","Mage_ConfigurableSwatches_Helper_Productimg",214],["T_DOUBLE_COLON","::",214],["T_STRING","MEDIA_IMAGE_TYPE_BASE",214],["T_WHITESPACE"," ",214],["T_DOUBLE_ARROW","=>",214],["T_WHITESPACE"," ",214],["T_STRING","null",214],",",["T_WHITESPACE","\n                    ",214],")",",",["T_WHITESPACE","\n                    ",215],["T_CONSTANT_ENCAPSED_STRING","'products'",216],["T_WHITESPACE"," ",216],["T_DOUBLE_ARROW","=>",216],["T_WHITESPACE"," ",216],["T_VARIABLE","$map",216],"[",["T_CONSTANT_ENCAPSED_STRING","'product_ids'",216],"]",",",["T_WHITESPACE","\n                ",216],")",";",["T_WHITESPACE","\n\n                ",217],["T_IF","if",219],["T_WHITESPACE"," ",219],"(",["T_VARIABLE","$imagePath",219],")",["T_WHITESPACE"," ",219],"{",["T_WHITESPACE","\n                    ",219],["T_VARIABLE","$imagesByLabel",220],"[",["T_VARIABLE","$map",220],"[",["T_CONSTANT_ENCAPSED_STRING","'label'",220],"]","]","[",["T_CONSTANT_ENCAPSED_STRING","'configurable_product'",220],"]",["T_WHITESPACE","\n                        ",220],"[",["T_STRING","Mage_ConfigurableSwatches_Helper_Productimg",221],["T_DOUBLE_COLON","::",221],["T_STRING","MEDIA_IMAGE_TYPE_SMALL",221],"]",["T_WHITESPACE"," ",221],"=",["T_WHITESPACE","\n                            ",221],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","_resizeProductImage",222],"(",["T_VARIABLE","$product",222],",",["T_WHITESPACE"," ",222],["T_CONSTANT_ENCAPSED_STRING","'small_image'",222],",",["T_WHITESPACE"," ",222],["T_VARIABLE","$keepFrame",222],",",["T_WHITESPACE"," ",222],["T_VARIABLE","$imagePath",222],")",";",["T_WHITESPACE","\n\n                    ",222],["T_VARIABLE","$imagesByLabel",224],"[",["T_VARIABLE","$map",224],"[",["T_CONSTANT_ENCAPSED_STRING","'label'",224],"]","]","[",["T_CONSTANT_ENCAPSED_STRING","'configurable_product'",224],"]",["T_WHITESPACE","\n                        ",224],"[",["T_STRING","Mage_ConfigurableSwatches_Helper_Productimg",225],["T_DOUBLE_COLON","::",225],["T_STRING","MEDIA_IMAGE_TYPE_BASE",225],"]",["T_WHITESPACE"," ",225],"=",["T_WHITESPACE","\n                            ",225],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","_resizeProductImage",226],"(",["T_VARIABLE","$product",226],",",["T_WHITESPACE"," ",226],["T_CONSTANT_ENCAPSED_STRING","'image'",226],",",["T_WHITESPACE"," ",226],["T_VARIABLE","$keepFrame",226],",",["T_WHITESPACE"," ",226],["T_VARIABLE","$imagePath",226],")",";",["T_WHITESPACE","\n                ",226],"}",["T_WHITESPACE","\n            ",227],"}",["T_WHITESPACE","\n\n            ",228],["T_VARIABLE","$imagesByType",230],["T_WHITESPACE"," ",230],"=",["T_WHITESPACE"," ",230],["T_ARRAY","array",230],"(",["T_WHITESPACE","\n                ",230],["T_CONSTANT_ENCAPSED_STRING","'image'",231],["T_WHITESPACE"," ",231],["T_DOUBLE_ARROW","=>",231],["T_WHITESPACE"," ",231],["T_ARRAY","array",231],"(",")",",",["T_WHITESPACE","\n                ",231],["T_CONSTANT_ENCAPSED_STRING","'small_image'",232],["T_WHITESPACE"," ",232],["T_DOUBLE_ARROW","=>",232],["T_WHITESPACE"," ",232],["T_ARRAY","array",232],"(",")",",",["T_WHITESPACE","\n            ",232],")",";",["T_WHITESPACE","\n\n            ",233],["T_COMMENT","\/\/ iterate image types to build image array, normally one type is passed in at a time, but could be two\n",235],["T_WHITESPACE","            ",236],["T_FOREACH","foreach",236],["T_WHITESPACE"," ",236],"(",["T_VARIABLE","$imageTypes",236],["T_WHITESPACE"," ",236],["T_AS","as",236],["T_WHITESPACE"," ",236],["T_VARIABLE","$imageType",236],")",["T_WHITESPACE"," ",236],"{",["T_WHITESPACE","\n                ",236],["T_COMMENT","\/\/ load image from the configurable product's children for swapping\n",237],["T_WHITESPACE","                ",238],["T_COMMENT","\/* @var $childProduct Mage_Catalog_Model_Product *\/",238],["T_WHITESPACE","\n                ",238],["T_IF","if",239],["T_WHITESPACE"," ",239],"(",["T_VARIABLE","$product",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","hasChildrenProducts",239],"(",")",")",["T_WHITESPACE"," ",239],"{",["T_WHITESPACE","\n                    ",239],["T_FOREACH","foreach",240],["T_WHITESPACE"," ",240],"(",["T_VARIABLE","$product",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","getChildrenProducts",240],"(",")",["T_WHITESPACE"," ",240],["T_AS","as",240],["T_WHITESPACE"," ",240],["T_VARIABLE","$childProduct",240],")",["T_WHITESPACE"," ",240],"{",["T_WHITESPACE","\n                        ",240],["T_VARIABLE","$image",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","_resizeProductImage",241],"(",["T_VARIABLE","$childProduct",241],",",["T_WHITESPACE"," ",241],["T_VARIABLE","$imageType",241],",",["T_WHITESPACE"," ",241],["T_VARIABLE","$keepFrame",241],")",";",["T_WHITESPACE","\n                        ",241],["T_IF","if",242],["T_WHITESPACE"," ",242],"(","!",["T_VARIABLE","$image",242],")",["T_WHITESPACE"," ",242],"{",["T_WHITESPACE","\n                            ",242],["T_VARIABLE","$image",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","_resizeProductImage",243],"(",["T_VARIABLE","$childProduct",243],",",["T_WHITESPACE"," ",243],["T_CONSTANT_ENCAPSED_STRING","'image'",243],",",["T_WHITESPACE"," ",243],["T_VARIABLE","$keepFrame",243],")",";",["T_WHITESPACE","\n                        ",243],"}",["T_WHITESPACE","\n\n                        ",244],["T_IF","if",246],["T_WHITESPACE"," ",246],"(",["T_VARIABLE","$image",246],")",["T_WHITESPACE"," ",246],"{",["T_WHITESPACE","\n                            ",246],["T_VARIABLE","$imagesByType",247],"[",["T_VARIABLE","$imageType",247],"]","[",["T_VARIABLE","$childProduct",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","getId",247],"(",")","]",["T_WHITESPACE"," ",247],"=",["T_WHITESPACE"," ",247],["T_VARIABLE","$image",247],";",["T_WHITESPACE","\n                        ",247],"}",["T_WHITESPACE","\n                    ",248],"}",["T_WHITESPACE","\n                ",249],"}",["T_WHITESPACE","\n\n                ",250],["T_COMMENT","\/\/ load image from configurable product for swapping fallback\n",252],["T_WHITESPACE","                ",253],["T_IF","if",253],["T_WHITESPACE"," ",253],"(",["T_VARIABLE","$image",253],["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","_resizeProductImage",253],"(",["T_VARIABLE","$product",253],",",["T_WHITESPACE"," ",253],["T_VARIABLE","$imageType",253],",",["T_WHITESPACE"," ",253],["T_VARIABLE","$keepFrame",253],",",["T_WHITESPACE"," ",253],["T_STRING","null",253],",",["T_WHITESPACE"," ",253],["T_STRING","true",253],")",")",["T_WHITESPACE"," ",253],"{",["T_WHITESPACE","\n                    ",253],["T_VARIABLE","$imagesByType",254],"[",["T_VARIABLE","$imageType",254],"]","[",["T_VARIABLE","$product",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","getId",254],"(",")","]",["T_WHITESPACE"," ",254],"=",["T_WHITESPACE"," ",254],["T_VARIABLE","$image",254],";",["T_WHITESPACE","\n                ",254],"}",["T_WHITESPACE","\n            ",255],"}",["T_WHITESPACE","\n\n            ",256],["T_VARIABLE","$array",258],["T_WHITESPACE"," ",258],"=",["T_WHITESPACE"," ",258],["T_ARRAY","array",258],"(",["T_WHITESPACE","\n                ",258],["T_CONSTANT_ENCAPSED_STRING","'option_labels'",259],["T_WHITESPACE"," ",259],["T_DOUBLE_ARROW","=>",259],["T_WHITESPACE"," ",259],["T_VARIABLE","$imagesByLabel",259],",",["T_WHITESPACE","\n                ",259],["T_STRING","Mage_ConfigurableSwatches_Helper_Productimg",260],["T_DOUBLE_COLON","::",260],["T_STRING","MEDIA_IMAGE_TYPE_SMALL",260],["T_WHITESPACE"," ",260],["T_DOUBLE_ARROW","=>",260],["T_WHITESPACE"," ",260],["T_VARIABLE","$imagesByType",260],"[",["T_CONSTANT_ENCAPSED_STRING","'small_image'",260],"]",",",["T_WHITESPACE","\n                ",260],["T_STRING","Mage_ConfigurableSwatches_Helper_Productimg",261],["T_DOUBLE_COLON","::",261],["T_STRING","MEDIA_IMAGE_TYPE_BASE",261],["T_WHITESPACE"," ",261],["T_DOUBLE_ARROW","=>",261],["T_WHITESPACE"," ",261],["T_VARIABLE","$imagesByType",261],"[",["T_CONSTANT_ENCAPSED_STRING","'image'",261],"]",",",["T_WHITESPACE","\n            ",261],")",";",["T_WHITESPACE","\n\n            ",262],["T_VARIABLE","$product",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","setConfigurableImagesFallbackArray",264],"(",["T_VARIABLE","$array",264],")",";",["T_WHITESPACE","\n        ",264],"}",["T_WHITESPACE","\n\n        ",265],["T_RETURN","return",267],["T_WHITESPACE"," ",267],["T_VARIABLE","$product",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","getConfigurableImagesFallbackArray",267],"(",")",";",["T_WHITESPACE","\n    ",267],"}",["T_WHITESPACE","\n\n    ",268],["T_DOC_COMMENT","\/**\n     * Resize specified type of image on the product for use in the fallback and returns the image URL\n     * or returns the image URL for the specified image path if present\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @param string $type\n     * @param bool $keepFrame\n     * @param string $image\n     * @param bool $placeholder\n     * @return string|bool\n     *\/",270],["T_WHITESPACE","\n    ",280],["T_PROTECTED","protected",281],["T_WHITESPACE"," ",281],["T_FUNCTION","function",281],["T_WHITESPACE"," ",281],["T_STRING","_resizeProductImage",281],"(",["T_VARIABLE","$product",281],",",["T_WHITESPACE"," ",281],["T_VARIABLE","$type",281],",",["T_WHITESPACE"," ",281],["T_VARIABLE","$keepFrame",281],",",["T_WHITESPACE"," ",281],["T_VARIABLE","$image",281],["T_WHITESPACE"," ",281],"=",["T_WHITESPACE"," ",281],["T_STRING","null",281],",",["T_WHITESPACE"," ",281],["T_VARIABLE","$placeholder",281],["T_WHITESPACE"," ",281],"=",["T_WHITESPACE"," ",281],["T_STRING","false",281],")",["T_WHITESPACE","\n    ",281],"{",["T_WHITESPACE","\n        ",282],["T_VARIABLE","$hasTypeData",283],["T_WHITESPACE"," ",283],"=",["T_WHITESPACE"," ",283],["T_VARIABLE","$product",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","hasData",283],"(",["T_VARIABLE","$type",283],")",["T_WHITESPACE"," ",283],["T_BOOLEAN_AND","&&",283],["T_WHITESPACE"," ",283],["T_VARIABLE","$product",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","getData",283],"(",["T_VARIABLE","$type",283],")",["T_WHITESPACE"," ",283],["T_IS_NOT_EQUAL","!=",283],["T_WHITESPACE"," ",283],["T_CONSTANT_ENCAPSED_STRING","'no_selection'",283],";",["T_WHITESPACE","\n        ",283],["T_IF","if",284],["T_WHITESPACE"," ",284],"(",["T_VARIABLE","$image",284],["T_WHITESPACE"," ",284],["T_IS_EQUAL","==",284],["T_WHITESPACE"," ",284],["T_CONSTANT_ENCAPSED_STRING","'no_selection'",284],")",["T_WHITESPACE"," ",284],"{",["T_WHITESPACE","\n            ",284],["T_VARIABLE","$image",285],["T_WHITESPACE"," ",285],"=",["T_WHITESPACE"," ",285],["T_STRING","null",285],";",["T_WHITESPACE","\n        ",285],"}",["T_WHITESPACE","\n        ",286],["T_IF","if",287],["T_WHITESPACE"," ",287],"(",["T_VARIABLE","$hasTypeData",287],["T_WHITESPACE"," ",287],["T_BOOLEAN_OR","||",287],["T_WHITESPACE"," ",287],["T_VARIABLE","$placeholder",287],["T_WHITESPACE"," ",287],["T_BOOLEAN_OR","||",287],["T_WHITESPACE"," ",287],["T_VARIABLE","$image",287],")",["T_WHITESPACE"," ",287],"{",["T_WHITESPACE","\n            ",287],["T_VARIABLE","$helper",288],["T_WHITESPACE"," ",288],"=",["T_WHITESPACE"," ",288],["T_STRING","Mage",288],["T_DOUBLE_COLON","::",288],["T_STRING","helper",288],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/image'",288],")",["T_WHITESPACE","\n                ",288],["T_OBJECT_OPERATOR","->",289],["T_STRING","init",289],"(",["T_VARIABLE","$product",289],",",["T_WHITESPACE"," ",289],["T_VARIABLE","$type",289],",",["T_WHITESPACE"," ",289],["T_VARIABLE","$image",289],")",["T_WHITESPACE","\n                ",289],["T_OBJECT_OPERATOR","->",290],["T_STRING","keepFrame",290],"(","(",["T_VARIABLE","$hasTypeData",290],["T_WHITESPACE"," ",290],["T_BOOLEAN_OR","||",290],["T_WHITESPACE"," ",290],["T_VARIABLE","$image",290],")",["T_WHITESPACE"," ",290],"?",["T_WHITESPACE"," ",290],["T_VARIABLE","$keepFrame",290],["T_WHITESPACE"," ",290],":",["T_WHITESPACE"," ",290],["T_STRING","false",290],")",["T_WHITESPACE","  ",290],["T_COMMENT","\/\/ don't keep frame if placeholder\n",290],["T_WHITESPACE","            ",291],";",["T_WHITESPACE","\n\n            ",291],["T_VARIABLE","$size",293],["T_WHITESPACE"," ",293],"=",["T_WHITESPACE"," ",293],["T_STRING","Mage",293],["T_DOUBLE_COLON","::",293],["T_STRING","getStoreConfig",293],"(",["T_STRING","Mage_Catalog_Helper_Image",293],["T_DOUBLE_COLON","::",293],["T_STRING","XML_NODE_PRODUCT_BASE_IMAGE_WIDTH",293],")",";",["T_WHITESPACE","\n            ",293],["T_IF","if",294],["T_WHITESPACE"," ",294],"(",["T_VARIABLE","$type",294],["T_WHITESPACE"," ",294],["T_IS_EQUAL","==",294],["T_WHITESPACE"," ",294],["T_CONSTANT_ENCAPSED_STRING","'small_image'",294],")",["T_WHITESPACE"," ",294],"{",["T_WHITESPACE","\n                ",294],["T_VARIABLE","$size",295],["T_WHITESPACE"," ",295],"=",["T_WHITESPACE"," ",295],["T_STRING","Mage",295],["T_DOUBLE_COLON","::",295],["T_STRING","getStoreConfig",295],"(",["T_STRING","Mage_Catalog_Helper_Image",295],["T_DOUBLE_COLON","::",295],["T_STRING","XML_NODE_PRODUCT_SMALL_IMAGE_WIDTH",295],")",";",["T_WHITESPACE","\n            ",295],"}",["T_WHITESPACE","\n            ",296],["T_IF","if",297],["T_WHITESPACE"," ",297],"(",["T_STRING","is_numeric",297],"(",["T_VARIABLE","$size",297],")",")",["T_WHITESPACE"," ",297],"{",["T_WHITESPACE","\n                ",297],["T_VARIABLE","$helper",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","constrainOnly",298],"(",["T_STRING","true",298],")",["T_OBJECT_OPERATOR","->",298],["T_STRING","resize",298],"(",["T_VARIABLE","$size",298],")",";",["T_WHITESPACE","\n            ",298],"}",["T_WHITESPACE","\n            ",299],["T_RETURN","return",300],["T_WHITESPACE"," ",300],["T_STRING_CAST","(string)",300],["T_VARIABLE","$helper",300],";",["T_WHITESPACE","\n        ",300],"}",["T_WHITESPACE","\n        ",301],["T_RETURN","return",302],["T_WHITESPACE"," ",302],["T_STRING","false",302],";",["T_WHITESPACE","\n    ",302],"}",["T_WHITESPACE","\n\n    ",303],["T_DOC_COMMENT","\/**\n     * Groups media gallery images by local images and child images\n     *\n     * @param Mage_Catalog_Model_Product $product\n     * @return void\n     *\/",305],["T_WHITESPACE","\n    ",310],["T_PUBLIC","public",311],["T_WHITESPACE"," ",311],["T_FUNCTION","function",311],["T_WHITESPACE"," ",311],["T_STRING","groupMediaGalleryImages",311],"(",["T_STRING","Mage_Catalog_Model_Product",311],["T_WHITESPACE"," ",311],["T_VARIABLE","$product",311],")",["T_WHITESPACE","\n    ",311],"{",["T_WHITESPACE","\n        ",312],["T_VARIABLE","$mediaGallery",313],["T_WHITESPACE"," ",313],"=",["T_WHITESPACE"," ",313],["T_VARIABLE","$product",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","getMediaGallery",313],"(",")",";",["T_WHITESPACE","\n\n        ",313],["T_IF","if",315],["T_WHITESPACE"," ",315],"(",["T_EMPTY","empty",315],"(",["T_VARIABLE","$mediaGallery",315],"[",["T_CONSTANT_ENCAPSED_STRING","'images'",315],"]",")",")",["T_WHITESPACE"," ",315],"{",["T_WHITESPACE","\n            ",315],["T_RETURN","return",316],";",["T_WHITESPACE"," ",316],["T_COMMENT","\/\/nothing to do here\n",316],["T_WHITESPACE","        ",317],"}",["T_WHITESPACE","\n\n        ",317],["T_VARIABLE","$newMediaGalleryImages",319],["T_WHITESPACE"," ",319],"=",["T_WHITESPACE"," ",319],["T_ARRAY","array",319],"(",")",";",["T_WHITESPACE","\n        ",319],["T_VARIABLE","$configurableImages",320],["T_WHITESPACE"," ",320],"=",["T_WHITESPACE"," ",320],["T_ARRAY","array",320],"(",")",";",["T_WHITESPACE","\n\n        ",320],["T_FOREACH","foreach",322],["T_WHITESPACE"," ",322],"(",["T_VARIABLE","$mediaGallery",322],"[",["T_CONSTANT_ENCAPSED_STRING","'images'",322],"]",["T_WHITESPACE"," ",322],["T_AS","as",322],["T_WHITESPACE"," ",322],["T_VARIABLE","$mediaGalleryImage",322],")",["T_WHITESPACE"," ",322],"{",["T_WHITESPACE","\n            ",322],["T_IF","if",323],["T_WHITESPACE"," ",323],"(",["T_VARIABLE","$mediaGalleryImage",323],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",323],"]",["T_WHITESPACE"," ",323],["T_IS_EQUAL","==",323],["T_WHITESPACE"," ",323],["T_VARIABLE","$product",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","getId",323],"(",")",")",["T_WHITESPACE"," ",323],"{",["T_WHITESPACE","\n                ",323],["T_VARIABLE","$newMediaGalleryImages",324],"[","]",["T_WHITESPACE"," ",324],"=",["T_WHITESPACE"," ",324],["T_VARIABLE","$mediaGalleryImage",324],";",["T_WHITESPACE","\n            ",324],"}",["T_WHITESPACE"," ",325],["T_ELSE","else",325],["T_WHITESPACE"," ",325],"{",["T_WHITESPACE","\n                ",325],["T_VARIABLE","$configurableImages",326],"[","]",["T_WHITESPACE"," ",326],"=",["T_WHITESPACE"," ",326],["T_VARIABLE","$mediaGalleryImage",326],";",["T_WHITESPACE","\n            ",326],"}",["T_WHITESPACE","\n        ",327],"}",["T_WHITESPACE","\n\n        ",328],["T_VARIABLE","$mediaGallery",330],"[",["T_CONSTANT_ENCAPSED_STRING","'images'",330],"]",["T_WHITESPACE"," ",330],"=",["T_WHITESPACE"," ",330],["T_VARIABLE","$newMediaGalleryImages",330],";",["T_WHITESPACE","\n        ",330],["T_VARIABLE","$mediaGallery",331],"[",["T_CONSTANT_ENCAPSED_STRING","'configurable_images'",331],"]",["T_WHITESPACE"," ",331],"=",["T_WHITESPACE"," ",331],["T_VARIABLE","$configurableImages",331],";",["T_WHITESPACE","\n\n        ",331],["T_VARIABLE","$product",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","setMediaGallery",333],"(",["T_VARIABLE","$mediaGallery",333],")",";",["T_WHITESPACE"," ",333],["T_COMMENT","\/\/reset product media images based on new grouping\n",333],["T_WHITESPACE","    ",334],"}",["T_WHITESPACE","\n\n    ",334],["T_DOC_COMMENT","\/**\n     * For given product set, attach media_gallery attribute values.\n     *\n     * @param array $products\n     * @param int $storeId\n     * @return void\n     *\/",336],["T_WHITESPACE","\n    ",342],["T_PUBLIC","public",343],["T_WHITESPACE"," ",343],["T_FUNCTION","function",343],["T_WHITESPACE"," ",343],["T_STRING","attachGallerySetToCollection",343],"(",["T_ARRAY","array",343],["T_WHITESPACE"," ",343],["T_VARIABLE","$products",343],",",["T_WHITESPACE"," ",343],["T_VARIABLE","$storeId",343],")",["T_WHITESPACE","\n    ",343],"{",["T_WHITESPACE","\n        ",344],["T_VARIABLE","$productIds",345],["T_WHITESPACE"," ",345],"=",["T_WHITESPACE"," ",345],["T_ARRAY","array",345],"(",")",";",["T_WHITESPACE","\n        ",345],["T_COMMENT","\/* @var $product Mage_Catalog_Model_Product *\/",346],["T_WHITESPACE","\n        ",346],["T_FOREACH","foreach",347],["T_WHITESPACE"," ",347],"(",["T_VARIABLE","$products",347],["T_WHITESPACE"," ",347],["T_AS","as",347],["T_WHITESPACE"," ",347],["T_VARIABLE","$product",347],")",["T_WHITESPACE"," ",347],"{",["T_WHITESPACE","\n            ",347],["T_VARIABLE","$productIds",348],"[","]",["T_WHITESPACE"," ",348],"=",["T_WHITESPACE"," ",348],["T_VARIABLE","$product",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","getId",348],"(",")",";",["T_WHITESPACE","\n            ",348],["T_IF","if",349],["T_WHITESPACE"," ",349],"(","!",["T_STRING","is_array",349],"(",["T_VARIABLE","$product",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","getChildrenProducts",349],"(",")",")",")",["T_WHITESPACE"," ",349],"{",["T_WHITESPACE","\n                ",349],["T_CONTINUE","continue",350],";",["T_WHITESPACE","\n            ",350],"}",["T_WHITESPACE","\n            ",351],["T_COMMENT","\/* @var $childProduct Mage_Catalog_Model_Product *\/",352],["T_WHITESPACE","\n            ",352],["T_FOREACH","foreach",353],["T_WHITESPACE"," ",353],"(",["T_VARIABLE","$product",353],["T_OBJECT_OPERATOR","->",353],["T_STRING","getChildrenProducts",353],"(",")",["T_WHITESPACE"," ",353],["T_AS","as",353],["T_WHITESPACE"," ",353],["T_VARIABLE","$childProduct",353],")",["T_WHITESPACE"," ",353],"{",["T_WHITESPACE","\n                ",353],["T_VARIABLE","$productIds",354],"[","]",["T_WHITESPACE"," ",354],"=",["T_WHITESPACE"," ",354],["T_VARIABLE","$childProduct",354],["T_OBJECT_OPERATOR","->",354],["T_STRING","getId",354],"(",")",";",["T_WHITESPACE","\n            ",354],"}",["T_WHITESPACE","\n        ",355],"}",["T_WHITESPACE","\n\n        ",356],["T_VARIABLE","$attrCode",358],["T_WHITESPACE"," ",358],"=",["T_WHITESPACE"," ",358],["T_STRING","self",358],["T_DOUBLE_COLON","::",358],["T_STRING","MEDIA_GALLERY_ATTRIBUTE_CODE",358],";",["T_WHITESPACE","\n\n        ",358],["T_COMMENT","\/* @var $resourceModel Mage_Catalog_Model_Resource_Product_Attribute_Backend_Media *\/",360],["T_WHITESPACE","\n        ",360],["T_VARIABLE","$resourceModel",361],["T_WHITESPACE"," ",361],"=",["T_WHITESPACE"," ",361],["T_STRING","Mage",361],["T_DOUBLE_COLON","::",361],["T_STRING","getResourceModel",361],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product_attribute_backend_media'",361],")",";",["T_WHITESPACE","\n\n        ",361],["T_VARIABLE","$images",363],["T_WHITESPACE"," ",363],"=",["T_WHITESPACE"," ",363],["T_VARIABLE","$resourceModel",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","loadGallerySet",363],"(",["T_VARIABLE","$productIds",363],",",["T_WHITESPACE"," ",363],["T_VARIABLE","$storeId",363],")",";",["T_WHITESPACE","\n\n        ",363],["T_VARIABLE","$relationship",365],["T_WHITESPACE"," ",365],"=",["T_WHITESPACE"," ",365],["T_ARRAY","array",365],"(",")",";",["T_WHITESPACE","\n        ",365],["T_FOREACH","foreach",366],["T_WHITESPACE"," ",366],"(",["T_VARIABLE","$products",366],["T_WHITESPACE"," ",366],["T_AS","as",366],["T_WHITESPACE"," ",366],["T_VARIABLE","$product",366],")",["T_WHITESPACE"," ",366],"{",["T_WHITESPACE","\n            ",366],["T_VARIABLE","$relationship",367],"[",["T_VARIABLE","$product",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","getId",367],"(",")","]",["T_WHITESPACE"," ",367],"=",["T_WHITESPACE"," ",367],["T_VARIABLE","$product",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","getId",367],"(",")",";",["T_WHITESPACE","\n\n            ",367],["T_IF","if",369],["T_WHITESPACE"," ",369],"(","!",["T_STRING","is_array",369],"(",["T_VARIABLE","$product",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","getChildrenProducts",369],"(",")",")",")",["T_WHITESPACE"," ",369],"{",["T_WHITESPACE","\n                ",369],["T_CONTINUE","continue",370],";",["T_WHITESPACE","\n            ",370],"}",["T_WHITESPACE","\n\n            ",371],["T_COMMENT","\/* @var $childProduct Mage_Catalog_Model_Product *\/",373],["T_WHITESPACE","\n            ",373],["T_FOREACH","foreach",374],["T_WHITESPACE"," ",374],"(",["T_VARIABLE","$product",374],["T_OBJECT_OPERATOR","->",374],["T_STRING","getChildrenProducts",374],"(",")",["T_WHITESPACE"," ",374],["T_AS","as",374],["T_WHITESPACE"," ",374],["T_VARIABLE","$childProduct",374],")",["T_WHITESPACE"," ",374],"{",["T_WHITESPACE","\n                ",374],["T_VARIABLE","$relationship",375],"[",["T_VARIABLE","$childProduct",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","getId",375],"(",")","]",["T_WHITESPACE"," ",375],"=",["T_WHITESPACE"," ",375],["T_VARIABLE","$product",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","getId",375],"(",")",";",["T_WHITESPACE","\n            ",375],"}",["T_WHITESPACE","\n        ",376],"}",["T_WHITESPACE","\n\n        ",377],["T_FOREACH","foreach",379],["T_WHITESPACE"," ",379],"(",["T_VARIABLE","$images",379],["T_WHITESPACE"," ",379],["T_AS","as",379],["T_WHITESPACE"," ",379],["T_VARIABLE","$image",379],")",["T_WHITESPACE"," ",379],"{",["T_WHITESPACE","\n            ",379],["T_VARIABLE","$productId",380],["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],["T_VARIABLE","$image",380],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",380],"]",";",["T_WHITESPACE","\n            ",380],["T_VARIABLE","$realProductId",381],["T_WHITESPACE"," ",381],"=",["T_WHITESPACE"," ",381],["T_VARIABLE","$relationship",381],"[",["T_VARIABLE","$productId",381],"]",";",["T_WHITESPACE","\n            ",381],["T_VARIABLE","$product",382],["T_WHITESPACE"," ",382],"=",["T_WHITESPACE"," ",382],["T_VARIABLE","$products",382],"[",["T_VARIABLE","$realProductId",382],"]",";",["T_WHITESPACE","\n\n            ",382],["T_IF","if",384],["T_WHITESPACE"," ",384],"(",["T_STRING","is_null",384],"(",["T_VARIABLE","$image",384],"[",["T_CONSTANT_ENCAPSED_STRING","'label'",384],"]",")",")",["T_WHITESPACE"," ",384],"{",["T_WHITESPACE","\n                ",384],["T_VARIABLE","$image",385],"[",["T_CONSTANT_ENCAPSED_STRING","'label'",385],"]",["T_WHITESPACE"," ",385],"=",["T_WHITESPACE"," ",385],["T_VARIABLE","$image",385],"[",["T_CONSTANT_ENCAPSED_STRING","'label_default'",385],"]",";",["T_WHITESPACE","\n            ",385],"}",["T_WHITESPACE","\n            ",386],["T_IF","if",387],["T_WHITESPACE"," ",387],"(",["T_STRING","is_null",387],"(",["T_VARIABLE","$image",387],"[",["T_CONSTANT_ENCAPSED_STRING","'position'",387],"]",")",")",["T_WHITESPACE"," ",387],"{",["T_WHITESPACE","\n                ",387],["T_VARIABLE","$image",388],"[",["T_CONSTANT_ENCAPSED_STRING","'position'",388],"]",["T_WHITESPACE"," ",388],"=",["T_WHITESPACE"," ",388],["T_VARIABLE","$image",388],"[",["T_CONSTANT_ENCAPSED_STRING","'position_default'",388],"]",";",["T_WHITESPACE","\n            ",388],"}",["T_WHITESPACE","\n            ",389],["T_IF","if",390],["T_WHITESPACE"," ",390],"(",["T_STRING","is_null",390],"(",["T_VARIABLE","$image",390],"[",["T_CONSTANT_ENCAPSED_STRING","'disabled'",390],"]",")",")",["T_WHITESPACE"," ",390],"{",["T_WHITESPACE","\n                ",390],["T_VARIABLE","$image",391],"[",["T_CONSTANT_ENCAPSED_STRING","'disabled'",391],"]",["T_WHITESPACE"," ",391],"=",["T_WHITESPACE"," ",391],["T_VARIABLE","$image",391],"[",["T_CONSTANT_ENCAPSED_STRING","'disabled_default'",391],"]",";",["T_WHITESPACE","\n            ",391],"}",["T_WHITESPACE","\n\n            ",392],["T_VARIABLE","$value",394],["T_WHITESPACE"," ",394],"=",["T_WHITESPACE"," ",394],["T_VARIABLE","$product",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","getData",394],"(",["T_VARIABLE","$attrCode",394],")",";",["T_WHITESPACE","\n            ",394],["T_IF","if",395],["T_WHITESPACE"," ",395],"(","!",["T_VARIABLE","$value",395],")",["T_WHITESPACE"," ",395],"{",["T_WHITESPACE","\n                ",395],["T_VARIABLE","$value",396],["T_WHITESPACE"," ",396],"=",["T_WHITESPACE"," ",396],["T_ARRAY","array",396],"(",["T_WHITESPACE","\n                    ",396],["T_CONSTANT_ENCAPSED_STRING","'images'",397],["T_WHITESPACE"," ",397],["T_DOUBLE_ARROW","=>",397],["T_WHITESPACE"," ",397],["T_ARRAY","array",397],"(",")",",",["T_WHITESPACE","\n                    ",397],["T_CONSTANT_ENCAPSED_STRING","'value'",398],["T_WHITESPACE"," ",398],["T_DOUBLE_ARROW","=>",398],["T_WHITESPACE"," ",398],["T_ARRAY","array",398],"(",")",["T_WHITESPACE","\n                ",398],")",";",["T_WHITESPACE","\n            ",399],"}",["T_WHITESPACE","\n\n            ",400],["T_VARIABLE","$value",402],"[",["T_CONSTANT_ENCAPSED_STRING","'images'",402],"]","[","]",["T_WHITESPACE"," ",402],"=",["T_WHITESPACE"," ",402],["T_VARIABLE","$image",402],";",["T_WHITESPACE","\n\n            ",402],["T_VARIABLE","$product",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","setData",404],"(",["T_VARIABLE","$attrCode",404],",",["T_WHITESPACE"," ",404],["T_VARIABLE","$value",404],")",";",["T_WHITESPACE","\n        ",404],"}",["T_WHITESPACE","\n    ",405],"}",["T_WHITESPACE","\n\n    ",406],["T_DOC_COMMENT","\/**\n     * Determines which product attributes should be selected\n     * when children products are attached to parent products\n     *\n     * @return array\n     *\/",408],["T_WHITESPACE","\n    ",413],["T_PROTECTED","protected",414],["T_WHITESPACE"," ",414],["T_FUNCTION","function",414],["T_WHITESPACE"," ",414],["T_STRING","_getChildrenProductsAttributes",414],"(",")",["T_WHITESPACE","\n    ",414],"{",["T_WHITESPACE","\n        ",415],["T_RETURN","return",416],["T_WHITESPACE"," ",416],["T_ARRAY","array",416],"(",["T_WHITESPACE","\n            ",416],["T_CONSTANT_ENCAPSED_STRING","'small_image'",417],",",["T_WHITESPACE","\n            ",417],["T_CONSTANT_ENCAPSED_STRING","'image'",418],",",["T_WHITESPACE","\n            ",418],["T_CONSTANT_ENCAPSED_STRING","'image_label'",419],",",["T_WHITESPACE","\n            ",419],["T_CONSTANT_ENCAPSED_STRING","'small_image_label'",420],",",["T_WHITESPACE","\n            ",420],["T_STRING","Mage",421],["T_DOUBLE_COLON","::",421],["T_STRING","helper",421],"(",["T_CONSTANT_ENCAPSED_STRING","'configurableswatches\/productlist'",421],")",["T_OBJECT_OPERATOR","->",421],["T_STRING","getSwatchAttribute",421],"(",")",["T_OBJECT_OPERATOR","->",421],["T_STRING","getAttributeCode",421],"(",")",",",["T_WHITESPACE","\n        ",421],")",";",["T_WHITESPACE","\n    ",422],"}",["T_WHITESPACE","\n\n    ",423],["T_DOC_COMMENT","\/**\n     * Attaches children product to each product via\n     * ->setChildrenProducts()\n     *\n     * @param array $products\n     * @param int $storeId\n     * @return void\n     *\/",425],["T_WHITESPACE","\n    ",432],["T_PUBLIC","public",433],["T_WHITESPACE"," ",433],["T_FUNCTION","function",433],["T_WHITESPACE"," ",433],["T_STRING","attachChildrenProducts",433],"(",["T_ARRAY","array",433],["T_WHITESPACE"," ",433],["T_VARIABLE","$products",433],",",["T_WHITESPACE"," ",433],["T_VARIABLE","$storeId",433],")",["T_WHITESPACE","\n    ",433],"{",["T_WHITESPACE","\n        ",434],["T_VARIABLE","$productIds",435],["T_WHITESPACE"," ",435],"=",["T_WHITESPACE"," ",435],["T_ARRAY","array",435],"(",")",";",["T_WHITESPACE","\n        ",435],["T_COMMENT","\/* @var $product Mage_Catalog_Model_Product *\/",436],["T_WHITESPACE","\n        ",436],["T_FOREACH","foreach",437],["T_WHITESPACE"," ",437],"(",["T_VARIABLE","$products",437],["T_WHITESPACE"," ",437],["T_AS","as",437],["T_WHITESPACE"," ",437],["T_VARIABLE","$product",437],")",["T_WHITESPACE"," ",437],"{",["T_WHITESPACE","\n            ",437],["T_VARIABLE","$productIds",438],"[","]",["T_WHITESPACE"," ",438],"=",["T_WHITESPACE"," ",438],["T_VARIABLE","$product",438],["T_OBJECT_OPERATOR","->",438],["T_STRING","getId",438],"(",")",";",["T_WHITESPACE","\n        ",438],"}",["T_WHITESPACE","\n\n        ",439],["T_VARIABLE","$collection",441],["T_WHITESPACE"," ",441],"=",["T_WHITESPACE"," ",441],["T_STRING","Mage",441],["T_DOUBLE_COLON","::",441],["T_STRING","getResourceModel",441],"(",["T_WHITESPACE","\n            ",441],["T_CONSTANT_ENCAPSED_STRING","'configurableswatches\/catalog_product_type_configurable_product_collection'",442],")",";",["T_WHITESPACE","\n\n        ",442],["T_VARIABLE","$collection",444],["T_OBJECT_OPERATOR","->",444],["T_STRING","setFlag",444],"(",["T_CONSTANT_ENCAPSED_STRING","'product_children'",444],",",["T_WHITESPACE"," ",444],["T_STRING","true",444],")",["T_WHITESPACE","\n            ",444],["T_OBJECT_OPERATOR","->",445],["T_STRING","addStoreFilter",445],"(",["T_VARIABLE","$storeId",445],")",["T_WHITESPACE","\n            ",445],["T_OBJECT_OPERATOR","->",446],["T_STRING","addAttributeToSelect",446],"(",["T_VARIABLE","$this",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","_getChildrenProductsAttributes",446],"(",")",")",";",["T_WHITESPACE","\n        ",446],["T_VARIABLE","$collection",447],["T_OBJECT_OPERATOR","->",447],["T_STRING","addProductSetFilter",447],"(",["T_VARIABLE","$productIds",447],")",";",["T_WHITESPACE","\n\n        ",447],["T_VARIABLE","$collection",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","load",449],"(",")",";",["T_WHITESPACE","\n\n        ",449],["T_VARIABLE","$mapping",451],["T_WHITESPACE"," ",451],"=",["T_WHITESPACE"," ",451],["T_ARRAY","array",451],"(",")",";",["T_WHITESPACE","\n        ",451],["T_COMMENT","\/* @var $childProduct Mage_Catalog_Model_Product *\/",452],["T_WHITESPACE","\n        ",452],["T_FOREACH","foreach",453],["T_WHITESPACE"," ",453],"(",["T_VARIABLE","$collection",453],["T_WHITESPACE"," ",453],["T_AS","as",453],["T_WHITESPACE"," ",453],["T_VARIABLE","$childProduct",453],")",["T_WHITESPACE"," ",453],"{",["T_WHITESPACE","\n            ",453],["T_FOREACH","foreach",454],["T_WHITESPACE"," ",454],"(",["T_VARIABLE","$childProduct",454],["T_OBJECT_OPERATOR","->",454],["T_STRING","getParentIds",454],"(",")",["T_WHITESPACE"," ",454],["T_AS","as",454],["T_WHITESPACE"," ",454],["T_VARIABLE","$parentId",454],")",["T_WHITESPACE"," ",454],"{",["T_WHITESPACE","\n                ",454],["T_IF","if",455],["T_WHITESPACE"," ",455],"(","!",["T_ISSET","isset",455],"(",["T_VARIABLE","$mapping",455],"[",["T_VARIABLE","$parentId",455],"]",")",")",["T_WHITESPACE"," ",455],"{",["T_WHITESPACE","\n                    ",455],["T_VARIABLE","$mapping",456],"[",["T_VARIABLE","$parentId",456],"]",["T_WHITESPACE"," ",456],"=",["T_WHITESPACE"," ",456],["T_ARRAY","array",456],"(",")",";",["T_WHITESPACE","\n                ",456],"}",["T_WHITESPACE","\n                ",457],["T_VARIABLE","$mapping",458],"[",["T_VARIABLE","$parentId",458],"]","[","]",["T_WHITESPACE"," ",458],"=",["T_WHITESPACE"," ",458],["T_VARIABLE","$childProduct",458],";",["T_WHITESPACE","\n            ",458],"}",["T_WHITESPACE","\n        ",459],"}",["T_WHITESPACE","\n\n        ",460],["T_FOREACH","foreach",462],["T_WHITESPACE"," ",462],"(",["T_VARIABLE","$mapping",462],["T_WHITESPACE"," ",462],["T_AS","as",462],["T_WHITESPACE"," ",462],["T_VARIABLE","$parentId",462],["T_WHITESPACE"," ",462],["T_DOUBLE_ARROW","=>",462],["T_WHITESPACE"," ",462],["T_VARIABLE","$childrenProducts",462],")",["T_WHITESPACE"," ",462],"{",["T_WHITESPACE","\n            ",462],["T_VARIABLE","$products",463],"[",["T_VARIABLE","$parentId",463],"]",["T_OBJECT_OPERATOR","->",463],["T_STRING","setChildrenProducts",463],"(",["T_VARIABLE","$childrenProducts",463],")",";",["T_WHITESPACE","\n        ",463],"}",["T_WHITESPACE","\n    ",464],"}",["T_WHITESPACE","\n",465],"}",["T_WHITESPACE","\n",466]]