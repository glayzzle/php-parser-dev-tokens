[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_ConfigurableSwatches\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Class Mage_ConfigurableSwatches_Helper_Productlist\n *\/",27],["T_WHITESPACE","\n",29],["T_CLASS","class",30],["T_WHITESPACE"," ",30],["T_STRING","Mage_ConfigurableSwatches_Helper_Productlist",30],["T_WHITESPACE"," ",30],["T_EXTENDS","extends",30],["T_WHITESPACE"," ",30],["T_STRING","Mage_Core_Helper_Abstract",30],["T_WHITESPACE","\n",30],"{",["T_WHITESPACE","\n    ",31],["T_DOC_COMMENT","\/**\n     * ID of attribute to be used for swatches on product listing\n     *\n     * @var string\n     *\/",32],["T_WHITESPACE","\n    ",36],["T_PROTECTED","protected",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$_swatchAttributeId",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_STRING","null",37],";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * Attribute model to be used for swatches on product listing\n     *\n     * @var Mage_Catalog_Model_Product_Type_Configurable_Attribute\n     *\/",39],["T_WHITESPACE","\n    ",43],["T_PROTECTED","protected",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$_swatchAttribute",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_STRING","null",44],";",["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * The current value for the swatch attribute that the product list is being filtered by.\n     *\n     * @var int\n     *\/",46],["T_WHITESPACE","\n    ",50],["T_PROTECTED","protected",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$_swatchAttributeFilteredValue",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_STRING","null",51],";",["T_WHITESPACE","\n\n    ",51],["T_DOC_COMMENT","\/**\n     * Convert a catalog layer block with the right templates\n     *\n     * @param string $blockName\n     * @return void\n     *\/",53],["T_WHITESPACE","\n    ",58],["T_PUBLIC","public",59],["T_WHITESPACE"," ",59],["T_FUNCTION","function",59],["T_WHITESPACE"," ",59],["T_STRING","convertLayerBlock",59],"(",["T_VARIABLE","$blockName",59],")",["T_WHITESPACE","\n    ",59],"{",["T_WHITESPACE","\n        ",60],["T_IF","if",61],["T_WHITESPACE"," ",61],"(",["T_STRING","Mage",61],["T_DOUBLE_COLON","::",61],["T_STRING","helper",61],"(",["T_CONSTANT_ENCAPSED_STRING","'configurableswatches'",61],")",["T_OBJECT_OPERATOR","->",61],["T_STRING","isEnabled",61],"(",")",["T_WHITESPACE","\n            ",61],["T_BOOLEAN_AND","&&",62],["T_WHITESPACE"," ",62],"(",["T_VARIABLE","$block",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_STRING","Mage",62],["T_DOUBLE_COLON","::",62],["T_STRING","app",62],"(",")",["T_OBJECT_OPERATOR","->",62],["T_STRING","getLayout",62],"(",")",["T_OBJECT_OPERATOR","->",62],["T_STRING","getBlock",62],"(",["T_VARIABLE","$blockName",62],")",")",["T_WHITESPACE","\n            ",62],["T_BOOLEAN_AND","&&",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$block",63],["T_WHITESPACE"," ",63],["T_INSTANCEOF","instanceof",63],["T_WHITESPACE"," ",63],["T_STRING","Mage_Catalog_Block_Layer_View",63],["T_WHITESPACE","\n        ",63],")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n\n            ",64],["T_COMMENT","\/\/ First, set a new template for the attribute that should show as a swatch\n",66],["T_WHITESPACE","            ",67],["T_IF","if",67],["T_WHITESPACE"," ",67],"(",["T_VARIABLE","$layer",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$block",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getLayer",67],"(",")",")",["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n                ",67],["T_FOREACH","foreach",68],["T_WHITESPACE"," ",68],"(",["T_VARIABLE","$layer",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","getFilterableAttributes",68],"(",")",["T_WHITESPACE"," ",68],["T_AS","as",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$attribute",68],")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n                    ",68],["T_IF","if",69],["T_WHITESPACE"," ",69],"(",["T_STRING","Mage",69],["T_DOUBLE_COLON","::",69],["T_STRING","helper",69],"(",["T_CONSTANT_ENCAPSED_STRING","'configurableswatches'",69],")",["T_OBJECT_OPERATOR","->",69],["T_STRING","attrIsSwatchType",69],"(",["T_VARIABLE","$attribute",69],")",")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n                        ",69],["T_VARIABLE","$block",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getChild",70],"(",["T_VARIABLE","$attribute",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getAttributeCode",70],"(",")",["T_WHITESPACE"," ",70],".",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'_filter'",70],")",["T_WHITESPACE","\n                            ",70],["T_OBJECT_OPERATOR","->",71],["T_STRING","setTemplate",71],"(",["T_CONSTANT_ENCAPSED_STRING","'configurableswatches\/catalog\/layer\/filter\/swatches.phtml'",71],")",";",["T_WHITESPACE","\n                    ",71],"}",["T_WHITESPACE","\n                ",72],"}",["T_WHITESPACE","\n            ",73],"}",["T_WHITESPACE","\n\n            ",74],["T_COMMENT","\/\/ Then set a specific renderer block for showing \"currently shopping by\" for the swatch attribute\n",76],["T_WHITESPACE","            ",77],["T_COMMENT","\/\/ (block class takes care of determining which attribute is applicable)\n",77],["T_WHITESPACE","            ",78],["T_IF","if",78],["T_WHITESPACE"," ",78],"(",["T_VARIABLE","$stateRenderersBlock",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$block",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getChild",78],"(",["T_CONSTANT_ENCAPSED_STRING","'state_renderers'",78],")",")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n                ",78],["T_VARIABLE","$swatchRenderer",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_STRING","Mage",79],["T_DOUBLE_COLON","::",79],["T_STRING","app",79],"(",")",["T_OBJECT_OPERATOR","->",79],["T_STRING","getLayout",79],"(",")",["T_WHITESPACE","\n                    ",79],["T_OBJECT_OPERATOR","->",80],["T_STRING","addBlock",80],"(",["T_CONSTANT_ENCAPSED_STRING","'configurableswatches\/catalog_layer_state_swatch'",80],",",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'product_list.swatches'",80],")",";",["T_WHITESPACE","\n                ",80],["T_VARIABLE","$swatchRenderer",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","setTemplate",81],"(",["T_CONSTANT_ENCAPSED_STRING","'configurableswatches\/catalog\/layer\/state\/swatch.phtml'",81],")",";",["T_WHITESPACE","\n                ",81],["T_VARIABLE","$stateRenderersBlock",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","append",82],"(",["T_VARIABLE","$swatchRenderer",82],")",";",["T_WHITESPACE","\n            ",82],"}",["T_WHITESPACE","\n        ",83],"}",["T_WHITESPACE","\n    ",84],"}",["T_WHITESPACE","\n\n    ",85],["T_DOC_COMMENT","\/**\n     * Get ID of the attribute that should be used for swatches on product listing\n     *\n     * @return string\n     *\/",87],["T_WHITESPACE","\n    ",91],["T_PUBLIC","public",92],["T_WHITESPACE"," ",92],["T_FUNCTION","function",92],["T_WHITESPACE"," ",92],["T_STRING","getSwatchAttributeId",92],"(",")",["T_WHITESPACE","\n    ",92],"{",["T_WHITESPACE","\n        ",93],["T_IF","if",94],["T_WHITESPACE"," ",94],"(",["T_STRING","is_null",94],"(",["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","_swatchAttributeId",94],")",")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n            ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","_swatchAttributeId",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE","\n                ",95],["T_STRING","Mage",96],["T_DOUBLE_COLON","::",96],["T_STRING","getStoreConfig",96],"(",["T_STRING","Mage_ConfigurableSwatches_Helper_Data",96],["T_DOUBLE_COLON","::",96],["T_STRING","CONFIG_PATH_LIST_SWATCH_ATTRIBUTE",96],")",";",["T_WHITESPACE","\n        ",96],"}",["T_WHITESPACE","\n        ",97],["T_RETURN","return",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","_swatchAttributeId",98],";",["T_WHITESPACE","\n    ",98],"}",["T_WHITESPACE","\n\n    ",99],["T_DOC_COMMENT","\/**\n     * Get model of attribute that should be used for swatches on product listing\n     *\n     * @return Mage_Eav_Model_Attribute\n     *\/",101],["T_WHITESPACE","\n    ",105],["T_PUBLIC","public",106],["T_WHITESPACE"," ",106],["T_FUNCTION","function",106],["T_WHITESPACE"," ",106],["T_STRING","getSwatchAttribute",106],"(",")",["T_WHITESPACE","\n    ",106],"{",["T_WHITESPACE","\n        ",107],["T_IF","if",108],["T_WHITESPACE"," ",108],"(",["T_STRING","is_null",108],"(",["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","_swatchAttribute",108],")",")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n            ",108],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","_swatchAttribute",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_STRING","Mage",109],["T_DOUBLE_COLON","::",109],["T_STRING","getSingleton",109],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/config'",109],")",["T_WHITESPACE","\n                ",109],["T_OBJECT_OPERATOR","->",110],["T_STRING","getAttribute",110],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product'",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getSwatchAttributeId",110],"(",")",")",";",["T_WHITESPACE","\n        ",110],"}",["T_WHITESPACE","\n        ",111],["T_RETURN","return",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","_swatchAttribute",112],";",["T_WHITESPACE","\n    ",112],"}",["T_WHITESPACE","\n\n    ",113],["T_DOC_COMMENT","\/**\n     * If the product list is currently filtered by the swatch attribute, get the selected value.\n     *\n     * @return int | false\n     *\/",115],["T_WHITESPACE","\n    ",119],["T_PROTECTED","protected",120],["T_WHITESPACE"," ",120],["T_FUNCTION","function",120],["T_WHITESPACE"," ",120],["T_STRING","_getSwatchAttributeFilteredValue",120],"(",")",["T_WHITESPACE","\n    ",120],"{",["T_WHITESPACE","\n        ",121],["T_IF","if",122],["T_WHITESPACE"," ",122],"(",["T_STRING","is_null",122],"(",["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","_swatchAttributeFilteredValue",122],")",")",["T_WHITESPACE"," ",122],"{",["T_WHITESPACE","\n            ",122],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","_swatchAttributeFilteredValue",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_STRING","false",123],";",["T_WHITESPACE","\n            ",123],["T_FOREACH","foreach",124],["T_WHITESPACE"," ",124],"(",["T_STRING","Mage",124],["T_DOUBLE_COLON","::",124],["T_STRING","getSingleton",124],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/layer'",124],")",["T_OBJECT_OPERATOR","->",124],["T_STRING","getState",124],"(",")",["T_OBJECT_OPERATOR","->",124],["T_STRING","getFilters",124],"(",")",["T_WHITESPACE"," ",124],["T_AS","as",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$filter",124],")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n                ",124],["T_IF","if",125],["T_WHITESPACE"," ",125],"(","!",["T_VARIABLE","$filter",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","getFilter",125],"(",")",["T_OBJECT_OPERATOR","->",125],["T_STRING","hasAttributeModel",125],"(",")",")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n                    ",125],["T_CONTINUE","continue",126],";",["T_WHITESPACE","\n                ",126],"}",["T_WHITESPACE","\n\n                ",127],["T_IF","if",129],["T_WHITESPACE"," ",129],"(",["T_VARIABLE","$filter",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getFilter",129],"(",")",["T_OBJECT_OPERATOR","->",129],["T_STRING","getAttributeModel",129],"(",")",["T_OBJECT_OPERATOR","->",129],["T_STRING","getAttributeId",129],"(",")",["T_WHITESPACE"," ",129],["T_IS_EQUAL","==",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getSwatchAttributeId",129],"(",")",")",["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n                    ",129],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","_swatchAttributeFilteredValue",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$filter",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getValue",130],"(",")",";",["T_WHITESPACE","\n                ",130],"}",["T_WHITESPACE","\n            ",131],"}",["T_WHITESPACE","\n        ",132],"}",["T_WHITESPACE","\n        ",133],["T_RETURN","return",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","_swatchAttributeFilteredValue",134],";",["T_WHITESPACE","\n    ",134],"}",["T_WHITESPACE","\n\n    ",135],["T_DOC_COMMENT","\/**\n     * See if the swatch matches a filter currently applied to the product list.\n     *\n     * @param int $optionId\n     * @return boolean\n     *\/",137],["T_WHITESPACE","\n    ",142],["T_PUBLIC","public",143],["T_WHITESPACE"," ",143],["T_FUNCTION","function",143],["T_WHITESPACE"," ",143],["T_STRING","swatchMatchesFilter",143],"(",["T_VARIABLE","$optionId",143],")",["T_WHITESPACE","\n    ",143],"{",["T_WHITESPACE","\n        ",144],["T_RETURN","return",145],["T_WHITESPACE"," ",145],"(",["T_VARIABLE","$optionId",145],["T_WHITESPACE"," ",145],["T_IS_EQUAL","==",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","_getSwatchAttributeFilteredValue",145],"(",")",")",";",["T_WHITESPACE","\n    ",145],"}",["T_WHITESPACE","\n",146],"}",["T_WHITESPACE","\n",147]]