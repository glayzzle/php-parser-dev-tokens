[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Oauth\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * oAuth Server\n *\n * @category    Mage\n * @package     Mage_Oauth\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Oauth_Model_Server",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_COMMENT","\/**#@+\n     * OAuth result statuses\n     *\/",36],["T_WHITESPACE","\n    ",38],["T_CONST","const",39],["T_WHITESPACE"," ",39],["T_STRING","ERR_OK",39],["T_WHITESPACE","                        ",39],"=",["T_WHITESPACE"," ",39],["T_LNUMBER","0",39],";",["T_WHITESPACE","\n    ",39],["T_CONST","const",40],["T_WHITESPACE"," ",40],["T_STRING","ERR_VERSION_REJECTED",40],["T_WHITESPACE","          ",40],"=",["T_WHITESPACE"," ",40],["T_LNUMBER","1",40],";",["T_WHITESPACE","\n    ",40],["T_CONST","const",41],["T_WHITESPACE"," ",41],["T_STRING","ERR_PARAMETER_ABSENT",41],["T_WHITESPACE","          ",41],"=",["T_WHITESPACE"," ",41],["T_LNUMBER","2",41],";",["T_WHITESPACE","\n    ",41],["T_CONST","const",42],["T_WHITESPACE"," ",42],["T_STRING","ERR_PARAMETER_REJECTED",42],["T_WHITESPACE","        ",42],"=",["T_WHITESPACE"," ",42],["T_LNUMBER","3",42],";",["T_WHITESPACE","\n    ",42],["T_CONST","const",43],["T_WHITESPACE"," ",43],["T_STRING","ERR_TIMESTAMP_REFUSED",43],["T_WHITESPACE","         ",43],"=",["T_WHITESPACE"," ",43],["T_LNUMBER","4",43],";",["T_WHITESPACE","\n    ",43],["T_CONST","const",44],["T_WHITESPACE"," ",44],["T_STRING","ERR_NONCE_USED",44],["T_WHITESPACE","                ",44],"=",["T_WHITESPACE"," ",44],["T_LNUMBER","5",44],";",["T_WHITESPACE","\n    ",44],["T_CONST","const",45],["T_WHITESPACE"," ",45],["T_STRING","ERR_SIGNATURE_METHOD_REJECTED",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_LNUMBER","6",45],";",["T_WHITESPACE","\n    ",45],["T_CONST","const",46],["T_WHITESPACE"," ",46],["T_STRING","ERR_SIGNATURE_INVALID",46],["T_WHITESPACE","         ",46],"=",["T_WHITESPACE"," ",46],["T_LNUMBER","7",46],";",["T_WHITESPACE","\n    ",46],["T_CONST","const",47],["T_WHITESPACE"," ",47],["T_STRING","ERR_CONSUMER_KEY_REJECTED",47],["T_WHITESPACE","     ",47],"=",["T_WHITESPACE"," ",47],["T_LNUMBER","8",47],";",["T_WHITESPACE","\n    ",47],["T_CONST","const",48],["T_WHITESPACE"," ",48],["T_STRING","ERR_TOKEN_USED",48],["T_WHITESPACE","                ",48],"=",["T_WHITESPACE"," ",48],["T_LNUMBER","9",48],";",["T_WHITESPACE","\n    ",48],["T_CONST","const",49],["T_WHITESPACE"," ",49],["T_STRING","ERR_TOKEN_EXPIRED",49],["T_WHITESPACE","             ",49],"=",["T_WHITESPACE"," ",49],["T_LNUMBER","10",49],";",["T_WHITESPACE","\n    ",49],["T_CONST","const",50],["T_WHITESPACE"," ",50],["T_STRING","ERR_TOKEN_REVOKED",50],["T_WHITESPACE","             ",50],"=",["T_WHITESPACE"," ",50],["T_LNUMBER","11",50],";",["T_WHITESPACE","\n    ",50],["T_CONST","const",51],["T_WHITESPACE"," ",51],["T_STRING","ERR_TOKEN_REJECTED",51],["T_WHITESPACE","            ",51],"=",["T_WHITESPACE"," ",51],["T_LNUMBER","12",51],";",["T_WHITESPACE","\n    ",51],["T_CONST","const",52],["T_WHITESPACE"," ",52],["T_STRING","ERR_VERIFIER_INVALID",52],["T_WHITESPACE","          ",52],"=",["T_WHITESPACE"," ",52],["T_LNUMBER","13",52],";",["T_WHITESPACE","\n    ",52],["T_CONST","const",53],["T_WHITESPACE"," ",53],["T_STRING","ERR_PERMISSION_UNKNOWN",53],["T_WHITESPACE","        ",53],"=",["T_WHITESPACE"," ",53],["T_LNUMBER","14",53],";",["T_WHITESPACE","\n    ",53],["T_CONST","const",54],["T_WHITESPACE"," ",54],["T_STRING","ERR_PERMISSION_DENIED",54],["T_WHITESPACE","         ",54],"=",["T_WHITESPACE"," ",54],["T_LNUMBER","15",54],";",["T_WHITESPACE","\n    ",54],["T_COMMENT","\/**#@-*\/",55],["T_WHITESPACE","\n\n    ",55],["T_COMMENT","\/**#@+\n     * Signature Methods\n     *\/",57],["T_WHITESPACE","\n    ",59],["T_CONST","const",60],["T_WHITESPACE"," ",60],["T_STRING","SIGNATURE_HMAC",60],["T_WHITESPACE","  ",60],"=",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'HMAC-SHA1'",60],";",["T_WHITESPACE","\n    ",60],["T_CONST","const",61],["T_WHITESPACE"," ",61],["T_STRING","SIGNATURE_RSA",61],["T_WHITESPACE","   ",61],"=",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'RSA-SHA1'",61],";",["T_WHITESPACE","\n    ",61],["T_CONST","const",62],["T_WHITESPACE"," ",62],["T_STRING","SIGNATURE_PLAIN",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'PLAINTEXT'",62],";",["T_WHITESPACE","\n    ",62],["T_COMMENT","\/**#@-*\/",63],["T_WHITESPACE","\n\n    ",63],["T_COMMENT","\/**#@+\n     * Request Types\n     *\/",65],["T_WHITESPACE","\n    ",67],["T_CONST","const",68],["T_WHITESPACE"," ",68],["T_STRING","REQUEST_INITIATE",68],["T_WHITESPACE","  ",68],"=",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'initiate'",68],";",["T_WHITESPACE","  ",68],["T_COMMENT","\/\/ ask for temporary credentials\n",68],["T_WHITESPACE","    ",69],["T_CONST","const",69],["T_WHITESPACE"," ",69],["T_STRING","REQUEST_AUTHORIZE",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'authorize'",69],";",["T_WHITESPACE"," ",69],["T_COMMENT","\/\/ display authorize form\n",69],["T_WHITESPACE","    ",70],["T_CONST","const",70],["T_WHITESPACE"," ",70],["T_STRING","REQUEST_TOKEN",70],["T_WHITESPACE","     ",70],"=",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'token'",70],";",["T_WHITESPACE","     ",70],["T_COMMENT","\/\/ ask for permanent credentials\n",70],["T_WHITESPACE","    ",71],["T_CONST","const",71],["T_WHITESPACE"," ",71],["T_STRING","REQUEST_RESOURCE",71],["T_WHITESPACE","  ",71],"=",["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'resource'",71],";",["T_WHITESPACE","  ",71],["T_COMMENT","\/\/ ask for protected resource using permanent credentials\n",71],["T_WHITESPACE","    ",72],["T_COMMENT","\/**#@-*\/",72],["T_WHITESPACE","\n\n    ",72],["T_COMMENT","\/**#@+\n     * HTTP Response Codes\n     *\/",74],["T_WHITESPACE","\n    ",76],["T_CONST","const",77],["T_WHITESPACE"," ",77],["T_STRING","HTTP_OK",77],["T_WHITESPACE","             ",77],"=",["T_WHITESPACE"," ",77],["T_LNUMBER","200",77],";",["T_WHITESPACE","\n    ",77],["T_CONST","const",78],["T_WHITESPACE"," ",78],["T_STRING","HTTP_BAD_REQUEST",78],["T_WHITESPACE","    ",78],"=",["T_WHITESPACE"," ",78],["T_LNUMBER","400",78],";",["T_WHITESPACE","\n    ",78],["T_CONST","const",79],["T_WHITESPACE"," ",79],["T_STRING","HTTP_UNAUTHORIZED",79],["T_WHITESPACE","   ",79],"=",["T_WHITESPACE"," ",79],["T_LNUMBER","401",79],";",["T_WHITESPACE","\n    ",79],["T_CONST","const",80],["T_WHITESPACE"," ",80],["T_STRING","HTTP_INTERNAL_ERROR",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_LNUMBER","500",80],";",["T_WHITESPACE","\n    ",80],["T_COMMENT","\/**#@-*\/",81],["T_WHITESPACE","\n\n    ",81],["T_DOC_COMMENT","\/**\n     * Possible time deviation for timestamp validation in sec.\n     *\/",83],["T_WHITESPACE","\n    ",85],["T_CONST","const",86],["T_WHITESPACE"," ",86],["T_STRING","TIME_DEVIATION",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_LNUMBER","600",86],";",["T_WHITESPACE","\n\n    ",86],["T_DOC_COMMENT","\/**\n     * Value of callback URL when it is established or if cliaent is unable to receive callbacks\n     *\n     * @link http:\/\/tools.ietf.org\/html\/rfc5849#section-2.1     Requirement in RFC-5849\n     *\/",88],["T_WHITESPACE","\n    ",92],["T_CONST","const",93],["T_WHITESPACE"," ",93],["T_STRING","CALLBACK_ESTABLISHED",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","'oob'",93],";",["T_WHITESPACE","\n\n    ",93],["T_DOC_COMMENT","\/**\n     * Consumer object\n     *\n     * @var Mage_Oauth_Model_Consumer\n     *\/",95],["T_WHITESPACE","\n    ",99],["T_PROTECTED","protected",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$_consumer",100],";",["T_WHITESPACE","\n\n    ",100],["T_DOC_COMMENT","\/**\n     * Error code to error messages pairs\n     *\n     * @var array\n     *\/",102],["T_WHITESPACE","\n    ",106],["T_PROTECTED","protected",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$_errors",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_ARRAY","array",107],"(",["T_WHITESPACE","\n        ",107],["T_STRING","self",108],["T_DOUBLE_COLON","::",108],["T_STRING","ERR_VERSION_REJECTED",108],["T_WHITESPACE","          ",108],["T_DOUBLE_ARROW","=>",108],["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'version_rejected'",108],",",["T_WHITESPACE","\n        ",108],["T_STRING","self",109],["T_DOUBLE_COLON","::",109],["T_STRING","ERR_PARAMETER_ABSENT",109],["T_WHITESPACE","          ",109],["T_DOUBLE_ARROW","=>",109],["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'parameter_absent'",109],",",["T_WHITESPACE","\n        ",109],["T_STRING","self",110],["T_DOUBLE_COLON","::",110],["T_STRING","ERR_PARAMETER_REJECTED",110],["T_WHITESPACE","        ",110],["T_DOUBLE_ARROW","=>",110],["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'parameter_rejected'",110],",",["T_WHITESPACE","\n        ",110],["T_STRING","self",111],["T_DOUBLE_COLON","::",111],["T_STRING","ERR_TIMESTAMP_REFUSED",111],["T_WHITESPACE","         ",111],["T_DOUBLE_ARROW","=>",111],["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","'timestamp_refused'",111],",",["T_WHITESPACE","\n        ",111],["T_STRING","self",112],["T_DOUBLE_COLON","::",112],["T_STRING","ERR_NONCE_USED",112],["T_WHITESPACE","                ",112],["T_DOUBLE_ARROW","=>",112],["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'nonce_used'",112],",",["T_WHITESPACE","\n        ",112],["T_STRING","self",113],["T_DOUBLE_COLON","::",113],["T_STRING","ERR_SIGNATURE_METHOD_REJECTED",113],["T_WHITESPACE"," ",113],["T_DOUBLE_ARROW","=>",113],["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","'signature_method_rejected'",113],",",["T_WHITESPACE","\n        ",113],["T_STRING","self",114],["T_DOUBLE_COLON","::",114],["T_STRING","ERR_SIGNATURE_INVALID",114],["T_WHITESPACE","         ",114],["T_DOUBLE_ARROW","=>",114],["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","'signature_invalid'",114],",",["T_WHITESPACE","\n        ",114],["T_STRING","self",115],["T_DOUBLE_COLON","::",115],["T_STRING","ERR_CONSUMER_KEY_REJECTED",115],["T_WHITESPACE","     ",115],["T_DOUBLE_ARROW","=>",115],["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'consumer_key_rejected'",115],",",["T_WHITESPACE","\n        ",115],["T_STRING","self",116],["T_DOUBLE_COLON","::",116],["T_STRING","ERR_TOKEN_USED",116],["T_WHITESPACE","                ",116],["T_DOUBLE_ARROW","=>",116],["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","'token_used'",116],",",["T_WHITESPACE","\n        ",116],["T_STRING","self",117],["T_DOUBLE_COLON","::",117],["T_STRING","ERR_TOKEN_EXPIRED",117],["T_WHITESPACE","             ",117],["T_DOUBLE_ARROW","=>",117],["T_WHITESPACE"," ",117],["T_CONSTANT_ENCAPSED_STRING","'token_expired'",117],",",["T_WHITESPACE","\n        ",117],["T_STRING","self",118],["T_DOUBLE_COLON","::",118],["T_STRING","ERR_TOKEN_REVOKED",118],["T_WHITESPACE","             ",118],["T_DOUBLE_ARROW","=>",118],["T_WHITESPACE"," ",118],["T_CONSTANT_ENCAPSED_STRING","'token_revoked'",118],",",["T_WHITESPACE","\n        ",118],["T_STRING","self",119],["T_DOUBLE_COLON","::",119],["T_STRING","ERR_TOKEN_REJECTED",119],["T_WHITESPACE","            ",119],["T_DOUBLE_ARROW","=>",119],["T_WHITESPACE"," ",119],["T_CONSTANT_ENCAPSED_STRING","'token_rejected'",119],",",["T_WHITESPACE","\n        ",119],["T_STRING","self",120],["T_DOUBLE_COLON","::",120],["T_STRING","ERR_VERIFIER_INVALID",120],["T_WHITESPACE","          ",120],["T_DOUBLE_ARROW","=>",120],["T_WHITESPACE"," ",120],["T_CONSTANT_ENCAPSED_STRING","'verifier_invalid'",120],",",["T_WHITESPACE","\n        ",120],["T_STRING","self",121],["T_DOUBLE_COLON","::",121],["T_STRING","ERR_PERMISSION_UNKNOWN",121],["T_WHITESPACE","        ",121],["T_DOUBLE_ARROW","=>",121],["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","'permission_unknown'",121],",",["T_WHITESPACE","\n        ",121],["T_STRING","self",122],["T_DOUBLE_COLON","::",122],["T_STRING","ERR_PERMISSION_DENIED",122],["T_WHITESPACE","         ",122],["T_DOUBLE_ARROW","=>",122],["T_WHITESPACE"," ",122],["T_CONSTANT_ENCAPSED_STRING","'permission_denied'",122],["T_WHITESPACE","\n    ",122],")",";",["T_WHITESPACE","\n\n    ",123],["T_DOC_COMMENT","\/**\n     * Error code to HTTP error code\n     *\n     * @var array\n     *\/",125],["T_WHITESPACE","\n    ",129],["T_PROTECTED","protected",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$_errorsToHttpCode",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_ARRAY","array",130],"(",["T_WHITESPACE","\n        ",130],["T_STRING","self",131],["T_DOUBLE_COLON","::",131],["T_STRING","ERR_VERSION_REJECTED",131],["T_WHITESPACE","          ",131],["T_DOUBLE_ARROW","=>",131],["T_WHITESPACE"," ",131],["T_STRING","self",131],["T_DOUBLE_COLON","::",131],["T_STRING","HTTP_BAD_REQUEST",131],",",["T_WHITESPACE","\n        ",131],["T_STRING","self",132],["T_DOUBLE_COLON","::",132],["T_STRING","ERR_PARAMETER_ABSENT",132],["T_WHITESPACE","          ",132],["T_DOUBLE_ARROW","=>",132],["T_WHITESPACE"," ",132],["T_STRING","self",132],["T_DOUBLE_COLON","::",132],["T_STRING","HTTP_BAD_REQUEST",132],",",["T_WHITESPACE","\n        ",132],["T_STRING","self",133],["T_DOUBLE_COLON","::",133],["T_STRING","ERR_PARAMETER_REJECTED",133],["T_WHITESPACE","        ",133],["T_DOUBLE_ARROW","=>",133],["T_WHITESPACE"," ",133],["T_STRING","self",133],["T_DOUBLE_COLON","::",133],["T_STRING","HTTP_BAD_REQUEST",133],",",["T_WHITESPACE","\n        ",133],["T_STRING","self",134],["T_DOUBLE_COLON","::",134],["T_STRING","ERR_TIMESTAMP_REFUSED",134],["T_WHITESPACE","         ",134],["T_DOUBLE_ARROW","=>",134],["T_WHITESPACE"," ",134],["T_STRING","self",134],["T_DOUBLE_COLON","::",134],["T_STRING","HTTP_BAD_REQUEST",134],",",["T_WHITESPACE","\n        ",134],["T_STRING","self",135],["T_DOUBLE_COLON","::",135],["T_STRING","ERR_NONCE_USED",135],["T_WHITESPACE","                ",135],["T_DOUBLE_ARROW","=>",135],["T_WHITESPACE"," ",135],["T_STRING","self",135],["T_DOUBLE_COLON","::",135],["T_STRING","HTTP_UNAUTHORIZED",135],",",["T_WHITESPACE","\n        ",135],["T_STRING","self",136],["T_DOUBLE_COLON","::",136],["T_STRING","ERR_SIGNATURE_METHOD_REJECTED",136],["T_WHITESPACE"," ",136],["T_DOUBLE_ARROW","=>",136],["T_WHITESPACE"," ",136],["T_STRING","self",136],["T_DOUBLE_COLON","::",136],["T_STRING","HTTP_BAD_REQUEST",136],",",["T_WHITESPACE","\n        ",136],["T_STRING","self",137],["T_DOUBLE_COLON","::",137],["T_STRING","ERR_SIGNATURE_INVALID",137],["T_WHITESPACE","         ",137],["T_DOUBLE_ARROW","=>",137],["T_WHITESPACE"," ",137],["T_STRING","self",137],["T_DOUBLE_COLON","::",137],["T_STRING","HTTP_UNAUTHORIZED",137],",",["T_WHITESPACE","\n        ",137],["T_STRING","self",138],["T_DOUBLE_COLON","::",138],["T_STRING","ERR_CONSUMER_KEY_REJECTED",138],["T_WHITESPACE","     ",138],["T_DOUBLE_ARROW","=>",138],["T_WHITESPACE"," ",138],["T_STRING","self",138],["T_DOUBLE_COLON","::",138],["T_STRING","HTTP_UNAUTHORIZED",138],",",["T_WHITESPACE","\n        ",138],["T_STRING","self",139],["T_DOUBLE_COLON","::",139],["T_STRING","ERR_TOKEN_USED",139],["T_WHITESPACE","                ",139],["T_DOUBLE_ARROW","=>",139],["T_WHITESPACE"," ",139],["T_STRING","self",139],["T_DOUBLE_COLON","::",139],["T_STRING","HTTP_UNAUTHORIZED",139],",",["T_WHITESPACE","\n        ",139],["T_STRING","self",140],["T_DOUBLE_COLON","::",140],["T_STRING","ERR_TOKEN_EXPIRED",140],["T_WHITESPACE","             ",140],["T_DOUBLE_ARROW","=>",140],["T_WHITESPACE"," ",140],["T_STRING","self",140],["T_DOUBLE_COLON","::",140],["T_STRING","HTTP_UNAUTHORIZED",140],",",["T_WHITESPACE","\n        ",140],["T_STRING","self",141],["T_DOUBLE_COLON","::",141],["T_STRING","ERR_TOKEN_REVOKED",141],["T_WHITESPACE","             ",141],["T_DOUBLE_ARROW","=>",141],["T_WHITESPACE"," ",141],["T_STRING","self",141],["T_DOUBLE_COLON","::",141],["T_STRING","HTTP_UNAUTHORIZED",141],",",["T_WHITESPACE","\n        ",141],["T_STRING","self",142],["T_DOUBLE_COLON","::",142],["T_STRING","ERR_TOKEN_REJECTED",142],["T_WHITESPACE","            ",142],["T_DOUBLE_ARROW","=>",142],["T_WHITESPACE"," ",142],["T_STRING","self",142],["T_DOUBLE_COLON","::",142],["T_STRING","HTTP_UNAUTHORIZED",142],",",["T_WHITESPACE","\n        ",142],["T_STRING","self",143],["T_DOUBLE_COLON","::",143],["T_STRING","ERR_VERIFIER_INVALID",143],["T_WHITESPACE","          ",143],["T_DOUBLE_ARROW","=>",143],["T_WHITESPACE"," ",143],["T_STRING","self",143],["T_DOUBLE_COLON","::",143],["T_STRING","HTTP_UNAUTHORIZED",143],",",["T_WHITESPACE","\n        ",143],["T_STRING","self",144],["T_DOUBLE_COLON","::",144],["T_STRING","ERR_PERMISSION_UNKNOWN",144],["T_WHITESPACE","        ",144],["T_DOUBLE_ARROW","=>",144],["T_WHITESPACE"," ",144],["T_STRING","self",144],["T_DOUBLE_COLON","::",144],["T_STRING","HTTP_UNAUTHORIZED",144],",",["T_WHITESPACE","\n        ",144],["T_STRING","self",145],["T_DOUBLE_COLON","::",145],["T_STRING","ERR_PERMISSION_DENIED",145],["T_WHITESPACE","         ",145],["T_DOUBLE_ARROW","=>",145],["T_WHITESPACE"," ",145],["T_STRING","self",145],["T_DOUBLE_COLON","::",145],["T_STRING","HTTP_UNAUTHORIZED",145],["T_WHITESPACE","\n    ",145],")",";",["T_WHITESPACE","\n\n    ",146],["T_DOC_COMMENT","\/**\n     * Request parameters\n     *\n     * @var array\n     *\/",148],["T_WHITESPACE","\n    ",152],["T_PROTECTED","protected",153],["T_WHITESPACE"," ",153],["T_VARIABLE","$_params",153],["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_ARRAY","array",153],"(",")",";",["T_WHITESPACE","\n\n    ",153],["T_DOC_COMMENT","\/**\n     * Protocol parameters\n     *\n     * @var array\n     *\/",155],["T_WHITESPACE","\n    ",159],["T_PROTECTED","protected",160],["T_WHITESPACE"," ",160],["T_VARIABLE","$_protocolParams",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_ARRAY","array",160],"(",")",";",["T_WHITESPACE","\n\n    ",160],["T_DOC_COMMENT","\/**\n     * Request object\n     *\n     * @var Mage_Core_Controller_Request_Http\n     *\/",162],["T_WHITESPACE","\n    ",166],["T_PROTECTED","protected",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$_request",167],";",["T_WHITESPACE","\n\n    ",167],["T_DOC_COMMENT","\/**\n     * Request type: initiate, permanent token request or authorized one\n     *\n     * @var string\n     *\/",169],["T_WHITESPACE","\n    ",173],["T_PROTECTED","protected",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$_requestType",174],";",["T_WHITESPACE","\n\n    ",174],["T_DOC_COMMENT","\/**\n     * Response object\n     *\n     * @var Zend_Controller_Response_Http\n     *\/",176],["T_WHITESPACE","\n    ",180],["T_PROTECTED","protected",181],["T_WHITESPACE"," ",181],["T_VARIABLE","$_response",181],["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_STRING","null",181],";",["T_WHITESPACE","\n\n    ",181],["T_DOC_COMMENT","\/**\n     * Token object\n     *\n     * @var Mage_Oauth_Model_Token\n     *\/",183],["T_WHITESPACE","\n    ",187],["T_PROTECTED","protected",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$_token",188],";",["T_WHITESPACE","\n\n    ",188],["T_DOC_COMMENT","\/**\n     * Internal constructor not depended on params\n     *\n     * @param Zend_Controller_Request_Http $request OPTIONAL Request object (If not specified - use singleton)\n     * @throws Exception\n     *\/",190],["T_WHITESPACE","\n    ",195],["T_PUBLIC","public",196],["T_WHITESPACE"," ",196],["T_FUNCTION","function",196],["T_WHITESPACE"," ",196],["T_STRING","__construct",196],"(",["T_VARIABLE","$request",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_STRING","null",196],")",["T_WHITESPACE","\n    ",196],"{",["T_WHITESPACE","\n        ",197],["T_IF","if",198],["T_WHITESPACE"," ",198],"(",["T_STRING","is_object",198],"(",["T_VARIABLE","$request",198],")",")",["T_WHITESPACE"," ",198],"{",["T_WHITESPACE","\n            ",198],["T_IF","if",199],["T_WHITESPACE"," ",199],"(","!",["T_VARIABLE","$request",199],["T_WHITESPACE"," ",199],["T_INSTANCEOF","instanceof",199],["T_WHITESPACE"," ",199],["T_STRING","Zend_Controller_Request_Http",199],")",["T_WHITESPACE"," ",199],"{",["T_WHITESPACE","\n                ",199],["T_THROW","throw",200],["T_WHITESPACE"," ",200],["T_NEW","new",200],["T_WHITESPACE"," ",200],["T_STRING","Exception",200],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid request object passed'",200],")",";",["T_WHITESPACE","\n            ",200],"}",["T_WHITESPACE","\n            ",201],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","_request",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_VARIABLE","$request",202],";",["T_WHITESPACE","\n        ",202],"}",["T_WHITESPACE"," ",203],["T_ELSE","else",203],["T_WHITESPACE"," ",203],"{",["T_WHITESPACE","\n            ",203],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","_request",204],["T_WHITESPACE"," ",204],"=",["T_WHITESPACE"," ",204],["T_STRING","Mage",204],["T_DOUBLE_COLON","::",204],["T_STRING","app",204],"(",")",["T_OBJECT_OPERATOR","->",204],["T_STRING","getRequest",204],"(",")",";",["T_WHITESPACE","\n        ",204],"}",["T_WHITESPACE","\n    ",205],"}",["T_WHITESPACE","\n\n    ",206],["T_DOC_COMMENT","\/**\n     * Retrieve protocol and request parameters from request object\n     *\n     * @link http:\/\/tools.ietf.org\/html\/rfc5849#section-3.5\n     * @return Mage_Oauth_Model_Server\n     *\/",208],["T_WHITESPACE","\n    ",213],["T_PROTECTED","protected",214],["T_WHITESPACE"," ",214],["T_FUNCTION","function",214],["T_WHITESPACE"," ",214],["T_STRING","_fetchParams",214],"(",")",["T_WHITESPACE","\n    ",214],"{",["T_WHITESPACE","\n        ",215],["T_VARIABLE","$authHeaderValue",216],["T_WHITESPACE"," ",216],"=",["T_WHITESPACE"," ",216],["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","_request",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","getHeader",216],"(",["T_CONSTANT_ENCAPSED_STRING","'Authorization'",216],")",";",["T_WHITESPACE","\n\n        ",216],["T_IF","if",218],["T_WHITESPACE"," ",218],"(",["T_VARIABLE","$authHeaderValue",218],["T_WHITESPACE"," ",218],["T_BOOLEAN_AND","&&",218],["T_WHITESPACE"," ",218],["T_CONSTANT_ENCAPSED_STRING","'oauth'",218],["T_WHITESPACE"," ",218],["T_IS_IDENTICAL","===",218],["T_WHITESPACE"," ",218],["T_STRING","strtolower",218],"(",["T_STRING","substr",218],"(",["T_VARIABLE","$authHeaderValue",218],",",["T_WHITESPACE"," ",218],["T_LNUMBER","0",218],",",["T_WHITESPACE"," ",218],["T_LNUMBER","5",218],")",")",")",["T_WHITESPACE"," ",218],"{",["T_WHITESPACE","\n            ",218],["T_VARIABLE","$authHeaderValue",219],["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],["T_STRING","substr",219],"(",["T_VARIABLE","$authHeaderValue",219],",",["T_WHITESPACE"," ",219],["T_LNUMBER","6",219],")",";",["T_WHITESPACE"," ",219],["T_COMMENT","\/\/ ignore 'OAuth ' at the beginning\n",219],["T_WHITESPACE","\n            ",220],["T_FOREACH","foreach",221],["T_WHITESPACE"," ",221],"(",["T_STRING","explode",221],"(",["T_CONSTANT_ENCAPSED_STRING","','",221],",",["T_WHITESPACE"," ",221],["T_VARIABLE","$authHeaderValue",221],")",["T_WHITESPACE"," ",221],["T_AS","as",221],["T_WHITESPACE"," ",221],["T_VARIABLE","$paramStr",221],")",["T_WHITESPACE"," ",221],"{",["T_WHITESPACE","\n                ",221],["T_VARIABLE","$nameAndValue",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_STRING","explode",222],"(",["T_CONSTANT_ENCAPSED_STRING","'='",222],",",["T_WHITESPACE"," ",222],["T_STRING","trim",222],"(",["T_VARIABLE","$paramStr",222],")",",",["T_WHITESPACE"," ",222],["T_LNUMBER","2",222],")",";",["T_WHITESPACE","\n\n                ",222],["T_IF","if",224],["T_WHITESPACE"," ",224],"(",["T_STRING","count",224],"(",["T_VARIABLE","$nameAndValue",224],")",["T_WHITESPACE"," ",224],"<",["T_WHITESPACE"," ",224],["T_LNUMBER","2",224],")",["T_WHITESPACE"," ",224],"{",["T_WHITESPACE","\n                    ",224],["T_CONTINUE","continue",225],";",["T_WHITESPACE","\n                ",225],"}",["T_WHITESPACE","\n                ",226],["T_IF","if",227],["T_WHITESPACE"," ",227],"(",["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","_isProtocolParameter",227],"(",["T_VARIABLE","$nameAndValue",227],"[",["T_LNUMBER","0",227],"]",")",")",["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n                    ",227],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","_protocolParams",228],"[",["T_STRING","rawurldecode",228],"(",["T_VARIABLE","$nameAndValue",228],"[",["T_LNUMBER","0",228],"]",")","]",["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],["T_STRING","rawurldecode",228],"(",["T_STRING","trim",228],"(",["T_VARIABLE","$nameAndValue",228],"[",["T_LNUMBER","1",228],"]",",",["T_WHITESPACE"," ",228],["T_CONSTANT_ENCAPSED_STRING","'\"'",228],")",")",";",["T_WHITESPACE","\n                ",228],"}",["T_WHITESPACE","\n            ",229],"}",["T_WHITESPACE","\n        ",230],"}",["T_WHITESPACE","\n        ",231],["T_VARIABLE","$contentTypeHeader",232],["T_WHITESPACE"," ",232],"=",["T_WHITESPACE"," ",232],["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","_request",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","getHeader",232],"(",["T_STRING","Zend_Http_Client",232],["T_DOUBLE_COLON","::",232],["T_STRING","CONTENT_TYPE",232],")",";",["T_WHITESPACE","\n\n        ",232],["T_IF","if",234],["T_WHITESPACE"," ",234],"(",["T_VARIABLE","$contentTypeHeader",234],["T_WHITESPACE"," ",234],["T_BOOLEAN_AND","&&",234],["T_WHITESPACE"," ",234],["T_LNUMBER","0",234],["T_WHITESPACE"," ",234],["T_IS_IDENTICAL","===",234],["T_WHITESPACE"," ",234],["T_STRING","strpos",234],"(",["T_VARIABLE","$contentTypeHeader",234],",",["T_WHITESPACE"," ",234],["T_STRING","Zend_Http_Client",234],["T_DOUBLE_COLON","::",234],["T_STRING","ENC_URLENCODED",234],")",")",["T_WHITESPACE"," ",234],"{",["T_WHITESPACE","\n            ",234],["T_VARIABLE","$protocolParamsNotSet",235],["T_WHITESPACE"," ",235],"=",["T_WHITESPACE"," ",235],"!",["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","_protocolParams",235],";",["T_WHITESPACE","\n\n            ",235],["T_STRING","parse_str",237],"(",["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","_request",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","getRawBody",237],"(",")",",",["T_WHITESPACE"," ",237],["T_VARIABLE","$bodyParams",237],")",";",["T_WHITESPACE","\n\n            ",237],["T_FOREACH","foreach",239],["T_WHITESPACE"," ",239],"(",["T_VARIABLE","$bodyParams",239],["T_WHITESPACE"," ",239],["T_AS","as",239],["T_WHITESPACE"," ",239],["T_VARIABLE","$bodyParamName",239],["T_WHITESPACE"," ",239],["T_DOUBLE_ARROW","=>",239],["T_WHITESPACE"," ",239],["T_VARIABLE","$bodyParamValue",239],")",["T_WHITESPACE"," ",239],"{",["T_WHITESPACE","\n                ",239],["T_IF","if",240],["T_WHITESPACE"," ",240],"(","!",["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","_isProtocolParameter",240],"(",["T_VARIABLE","$bodyParamName",240],")",")",["T_WHITESPACE"," ",240],"{",["T_WHITESPACE","\n                    ",240],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","_params",241],"[",["T_VARIABLE","$bodyParamName",241],"]",["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_VARIABLE","$bodyParamValue",241],";",["T_WHITESPACE","\n                ",241],"}",["T_WHITESPACE"," ",242],["T_ELSEIF","elseif",242],["T_WHITESPACE"," ",242],"(",["T_VARIABLE","$protocolParamsNotSet",242],")",["T_WHITESPACE"," ",242],"{",["T_WHITESPACE","\n                    ",242],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","_protocolParams",243],"[",["T_VARIABLE","$bodyParamName",243],"]",["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_VARIABLE","$bodyParamValue",243],";",["T_WHITESPACE","\n                ",243],"}",["T_WHITESPACE","\n            ",244],"}",["T_WHITESPACE","\n        ",245],"}",["T_WHITESPACE","\n        ",246],["T_VARIABLE","$protocolParamsNotSet",247],["T_WHITESPACE"," ",247],"=",["T_WHITESPACE"," ",247],"!",["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","_protocolParams",247],";",["T_WHITESPACE","\n\n        ",247],["T_VARIABLE","$url",249],["T_WHITESPACE"," ",249],"=",["T_WHITESPACE"," ",249],["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","_request",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","getScheme",249],"(",")",["T_WHITESPACE"," ",249],".",["T_WHITESPACE"," ",249],["T_CONSTANT_ENCAPSED_STRING","':\/\/'",249],["T_WHITESPACE"," ",249],".",["T_WHITESPACE"," ",249],["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","_request",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","getHttpHost",249],"(",")",["T_WHITESPACE"," ",249],".",["T_WHITESPACE"," ",249],["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","_request",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","getRequestUri",249],"(",")",";",["T_WHITESPACE","\n\n        ",249],["T_IF","if",251],["T_WHITESPACE"," ",251],"(","(",["T_VARIABLE","$queryString",251],["T_WHITESPACE"," ",251],"=",["T_WHITESPACE"," ",251],["T_STRING","Zend_Uri_Http",251],["T_DOUBLE_COLON","::",251],["T_STRING","fromString",251],"(",["T_VARIABLE","$url",251],")",["T_OBJECT_OPERATOR","->",251],["T_STRING","getQuery",251],"(",")",")",")",["T_WHITESPACE"," ",251],"{",["T_WHITESPACE","\n            ",251],["T_FOREACH","foreach",252],["T_WHITESPACE"," ",252],"(",["T_STRING","explode",252],"(",["T_CONSTANT_ENCAPSED_STRING","'&'",252],",",["T_WHITESPACE"," ",252],["T_VARIABLE","$queryString",252],")",["T_WHITESPACE"," ",252],["T_AS","as",252],["T_WHITESPACE"," ",252],["T_VARIABLE","$paramToValue",252],")",["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n                ",252],["T_VARIABLE","$paramData",253],["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],["T_STRING","explode",253],"(",["T_CONSTANT_ENCAPSED_STRING","'='",253],",",["T_WHITESPACE"," ",253],["T_VARIABLE","$paramToValue",253],")",";",["T_WHITESPACE","\n\n                ",253],["T_IF","if",255],["T_WHITESPACE"," ",255],"(",["T_LNUMBER","2",255],["T_WHITESPACE"," ",255],["T_IS_IDENTICAL","===",255],["T_WHITESPACE"," ",255],["T_STRING","count",255],"(",["T_VARIABLE","$paramData",255],")",["T_WHITESPACE"," ",255],["T_BOOLEAN_AND","&&",255],["T_WHITESPACE"," ",255],"!",["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","_isProtocolParameter",255],"(",["T_VARIABLE","$paramData",255],"[",["T_LNUMBER","0",255],"]",")",")",["T_WHITESPACE"," ",255],"{",["T_WHITESPACE","\n                    ",255],["T_VARIABLE","$this",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","_params",256],"[",["T_STRING","rawurldecode",256],"(",["T_VARIABLE","$paramData",256],"[",["T_LNUMBER","0",256],"]",")","]",["T_WHITESPACE"," ",256],"=",["T_WHITESPACE"," ",256],["T_STRING","rawurldecode",256],"(",["T_VARIABLE","$paramData",256],"[",["T_LNUMBER","1",256],"]",")",";",["T_WHITESPACE","\n                ",256],"}",["T_WHITESPACE","\n            ",257],"}",["T_WHITESPACE","\n        ",258],"}",["T_WHITESPACE","\n        ",259],["T_IF","if",260],["T_WHITESPACE"," ",260],"(",["T_VARIABLE","$protocolParamsNotSet",260],")",["T_WHITESPACE"," ",260],"{",["T_WHITESPACE","\n            ",260],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","_fetchProtocolParamsFromQuery",261],"(",")",";",["T_WHITESPACE","\n        ",261],"}",["T_WHITESPACE","\n        ",262],["T_RETURN","return",263],["T_WHITESPACE"," ",263],["T_VARIABLE","$this",263],";",["T_WHITESPACE","\n    ",263],"}",["T_WHITESPACE","\n\n    ",264],["T_DOC_COMMENT","\/**\n     * Retrieve protocol parameters from query string\n     *\n     * @return Mage_Oauth_Model_Server\n     *\/",266],["T_WHITESPACE","\n    ",270],["T_PROTECTED","protected",271],["T_WHITESPACE"," ",271],["T_FUNCTION","function",271],["T_WHITESPACE"," ",271],["T_STRING","_fetchProtocolParamsFromQuery",271],"(",")",["T_WHITESPACE","\n    ",271],"{",["T_WHITESPACE","\n        ",272],["T_FOREACH","foreach",273],["T_WHITESPACE"," ",273],"(",["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","_request",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","getQuery",273],"(",")",["T_WHITESPACE"," ",273],["T_AS","as",273],["T_WHITESPACE"," ",273],["T_VARIABLE","$queryParamName",273],["T_WHITESPACE"," ",273],["T_DOUBLE_ARROW","=>",273],["T_WHITESPACE"," ",273],["T_VARIABLE","$queryParamValue",273],")",["T_WHITESPACE"," ",273],"{",["T_WHITESPACE","\n            ",273],["T_IF","if",274],["T_WHITESPACE"," ",274],"(",["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","_isProtocolParameter",274],"(",["T_VARIABLE","$queryParamName",274],")",")",["T_WHITESPACE"," ",274],"{",["T_WHITESPACE","\n                ",274],["T_VARIABLE","$this",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","_protocolParams",275],"[",["T_VARIABLE","$queryParamName",275],"]",["T_WHITESPACE"," ",275],"=",["T_WHITESPACE"," ",275],["T_VARIABLE","$queryParamValue",275],";",["T_WHITESPACE","\n            ",275],"}",["T_WHITESPACE","\n        ",276],"}",["T_WHITESPACE","\n        ",277],["T_RETURN","return",278],["T_WHITESPACE"," ",278],["T_VARIABLE","$this",278],";",["T_WHITESPACE","\n    ",278],"}",["T_WHITESPACE","\n\n    ",279],["T_DOC_COMMENT","\/**\n     * Retrieve response object\n     *\n     * @return Zend_Controller_Response_Http\n     *\/",281],["T_WHITESPACE","\n    ",285],["T_PROTECTED","protected",286],["T_WHITESPACE"," ",286],["T_FUNCTION","function",286],["T_WHITESPACE"," ",286],["T_STRING","_getResponse",286],"(",")",["T_WHITESPACE","\n    ",286],"{",["T_WHITESPACE","\n        ",287],["T_IF","if",288],["T_WHITESPACE"," ",288],"(",["T_STRING","null",288],["T_WHITESPACE"," ",288],["T_IS_IDENTICAL","===",288],["T_WHITESPACE"," ",288],["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","_response",288],")",["T_WHITESPACE"," ",288],"{",["T_WHITESPACE","\n            ",288],["T_VARIABLE","$this",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","setResponse",289],"(",["T_STRING","Mage",289],["T_DOUBLE_COLON","::",289],["T_STRING","app",289],"(",")",["T_OBJECT_OPERATOR","->",289],["T_STRING","getResponse",289],"(",")",")",";",["T_WHITESPACE","\n        ",289],"}",["T_WHITESPACE","\n        ",290],["T_RETURN","return",291],["T_WHITESPACE"," ",291],["T_VARIABLE","$this",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","_response",291],";",["T_WHITESPACE","\n    ",291],"}",["T_WHITESPACE","\n\n    ",292],["T_DOC_COMMENT","\/**\n     * Initialize consumer\n     *\n     * @throws Mage_Oauth_Exception\n     *\/",294],["T_WHITESPACE","\n    ",298],["T_PROTECTED","protected",299],["T_WHITESPACE"," ",299],["T_FUNCTION","function",299],["T_WHITESPACE"," ",299],["T_STRING","_initConsumer",299],"(",")",["T_WHITESPACE","\n    ",299],"{",["T_WHITESPACE","\n        ",300],["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","_consumer",301],["T_WHITESPACE"," ",301],"=",["T_WHITESPACE"," ",301],["T_STRING","Mage",301],["T_DOUBLE_COLON","::",301],["T_STRING","getModel",301],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth\/consumer'",301],")",";",["T_WHITESPACE","\n\n        ",301],["T_VARIABLE","$this",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","_consumer",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","load",303],"(",["T_VARIABLE","$this",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","_protocolParams",303],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_consumer_key'",303],"]",",",["T_WHITESPACE"," ",303],["T_CONSTANT_ENCAPSED_STRING","'key'",303],")",";",["T_WHITESPACE","\n\n        ",303],["T_IF","if",305],["T_WHITESPACE"," ",305],"(","!",["T_VARIABLE","$this",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","_consumer",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","getId",305],"(",")",")",["T_WHITESPACE"," ",305],"{",["T_WHITESPACE","\n            ",305],["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","_throwException",306],"(",["T_CONSTANT_ENCAPSED_STRING","''",306],",",["T_WHITESPACE"," ",306],["T_STRING","self",306],["T_DOUBLE_COLON","::",306],["T_STRING","ERR_CONSUMER_KEY_REJECTED",306],")",";",["T_WHITESPACE","\n        ",306],"}",["T_WHITESPACE","\n    ",307],"}",["T_WHITESPACE","\n\n    ",308],["T_DOC_COMMENT","\/**\n     * Load token object, validate it depending on request type, set access data and save\n     *\n     * @return Mage_Oauth_Model_Server\n     * @throws Mage_Oauth_Exception\n     *\/",310],["T_WHITESPACE","\n    ",315],["T_PROTECTED","protected",316],["T_WHITESPACE"," ",316],["T_FUNCTION","function",316],["T_WHITESPACE"," ",316],["T_STRING","_initToken",316],"(",")",["T_WHITESPACE","\n    ",316],"{",["T_WHITESPACE","\n        ",317],["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","_token",318],["T_WHITESPACE"," ",318],"=",["T_WHITESPACE"," ",318],["T_STRING","Mage",318],["T_DOUBLE_COLON","::",318],["T_STRING","getModel",318],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth\/token'",318],")",";",["T_WHITESPACE","\n\n        ",318],["T_IF","if",320],["T_WHITESPACE"," ",320],"(",["T_STRING","self",320],["T_DOUBLE_COLON","::",320],["T_STRING","REQUEST_INITIATE",320],["T_WHITESPACE"," ",320],["T_IS_NOT_EQUAL","!=",320],["T_WHITESPACE"," ",320],["T_VARIABLE","$this",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","_requestType",320],")",["T_WHITESPACE"," ",320],"{",["T_WHITESPACE","\n            ",320],["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","_validateTokenParam",321],"(",")",";",["T_WHITESPACE","\n\n            ",321],["T_VARIABLE","$this",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","_token",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","load",323],"(",["T_VARIABLE","$this",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","_protocolParams",323],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_token'",323],"]",",",["T_WHITESPACE"," ",323],["T_CONSTANT_ENCAPSED_STRING","'token'",323],")",";",["T_WHITESPACE","\n\n            ",323],["T_IF","if",325],["T_WHITESPACE"," ",325],"(","!",["T_VARIABLE","$this",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","_token",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","getId",325],"(",")",")",["T_WHITESPACE"," ",325],"{",["T_WHITESPACE","\n                ",325],["T_VARIABLE","$this",326],["T_OBJECT_OPERATOR","->",326],["T_STRING","_throwException",326],"(",["T_CONSTANT_ENCAPSED_STRING","''",326],",",["T_WHITESPACE"," ",326],["T_STRING","self",326],["T_DOUBLE_COLON","::",326],["T_STRING","ERR_TOKEN_REJECTED",326],")",";",["T_WHITESPACE","\n            ",326],"}",["T_WHITESPACE","\n            ",327],["T_IF","if",328],["T_WHITESPACE"," ",328],"(",["T_STRING","self",328],["T_DOUBLE_COLON","::",328],["T_STRING","REQUEST_TOKEN",328],["T_WHITESPACE"," ",328],["T_IS_EQUAL","==",328],["T_WHITESPACE"," ",328],["T_VARIABLE","$this",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","_requestType",328],")",["T_WHITESPACE"," ",328],"{",["T_WHITESPACE","\n                ",328],["T_VARIABLE","$this",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","_validateVerifierParam",329],"(",")",";",["T_WHITESPACE","\n\n                ",329],["T_IF","if",331],["T_WHITESPACE"," ",331],"(","!",["T_STRING","hash_equals",331],"(",["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","_token",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","getVerifier",331],"(",")",",",["T_WHITESPACE"," ",331],["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","_protocolParams",331],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_verifier'",331],"]",")",")",["T_WHITESPACE"," ",331],"{",["T_WHITESPACE","\n                    ",331],["T_VARIABLE","$this",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","_throwException",332],"(",["T_CONSTANT_ENCAPSED_STRING","''",332],",",["T_WHITESPACE"," ",332],["T_STRING","self",332],["T_DOUBLE_COLON","::",332],["T_STRING","ERR_VERIFIER_INVALID",332],")",";",["T_WHITESPACE","\n                ",332],"}",["T_WHITESPACE","\n                ",333],["T_IF","if",334],["T_WHITESPACE"," ",334],"(","!",["T_STRING","hash_equals",334],"(",["T_VARIABLE","$this",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","_token",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","getConsumerId",334],"(",")",",",["T_WHITESPACE"," ",334],["T_VARIABLE","$this",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","_consumer",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","getId",334],"(",")",")",")",["T_WHITESPACE"," ",334],"{",["T_WHITESPACE","\n                    ",334],["T_VARIABLE","$this",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","_throwException",335],"(",["T_CONSTANT_ENCAPSED_STRING","''",335],",",["T_WHITESPACE"," ",335],["T_STRING","self",335],["T_DOUBLE_COLON","::",335],["T_STRING","ERR_TOKEN_REJECTED",335],")",";",["T_WHITESPACE","\n                ",335],"}",["T_WHITESPACE","\n                ",336],["T_IF","if",337],["T_WHITESPACE"," ",337],"(",["T_STRING","Mage_Oauth_Model_Token",337],["T_DOUBLE_COLON","::",337],["T_STRING","TYPE_REQUEST",337],["T_WHITESPACE"," ",337],["T_IS_NOT_EQUAL","!=",337],["T_WHITESPACE"," ",337],["T_VARIABLE","$this",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","_token",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","getType",337],"(",")",")",["T_WHITESPACE"," ",337],"{",["T_WHITESPACE","\n                    ",337],["T_VARIABLE","$this",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","_throwException",338],"(",["T_CONSTANT_ENCAPSED_STRING","''",338],",",["T_WHITESPACE"," ",338],["T_STRING","self",338],["T_DOUBLE_COLON","::",338],["T_STRING","ERR_TOKEN_USED",338],")",";",["T_WHITESPACE","\n                ",338],"}",["T_WHITESPACE","\n            ",339],"}",["T_WHITESPACE"," ",340],["T_ELSEIF","elseif",340],["T_WHITESPACE"," ",340],"(",["T_STRING","self",340],["T_DOUBLE_COLON","::",340],["T_STRING","REQUEST_AUTHORIZE",340],["T_WHITESPACE"," ",340],["T_IS_EQUAL","==",340],["T_WHITESPACE"," ",340],["T_VARIABLE","$this",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","_requestType",340],")",["T_WHITESPACE"," ",340],"{",["T_WHITESPACE","\n                ",340],["T_IF","if",341],["T_WHITESPACE"," ",341],"(",["T_VARIABLE","$this",341],["T_OBJECT_OPERATOR","->",341],["T_STRING","_token",341],["T_OBJECT_OPERATOR","->",341],["T_STRING","getAuthorized",341],"(",")",")",["T_WHITESPACE"," ",341],"{",["T_WHITESPACE","\n                    ",341],["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","_throwException",342],"(",["T_CONSTANT_ENCAPSED_STRING","''",342],",",["T_WHITESPACE"," ",342],["T_STRING","self",342],["T_DOUBLE_COLON","::",342],["T_STRING","ERR_TOKEN_USED",342],")",";",["T_WHITESPACE","\n                ",342],"}",["T_WHITESPACE","\n            ",343],"}",["T_WHITESPACE"," ",344],["T_ELSEIF","elseif",344],["T_WHITESPACE"," ",344],"(",["T_STRING","self",344],["T_DOUBLE_COLON","::",344],["T_STRING","REQUEST_RESOURCE",344],["T_WHITESPACE"," ",344],["T_IS_EQUAL","==",344],["T_WHITESPACE"," ",344],["T_VARIABLE","$this",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","_requestType",344],")",["T_WHITESPACE"," ",344],"{",["T_WHITESPACE","\n                ",344],["T_IF","if",345],["T_WHITESPACE"," ",345],"(",["T_STRING","Mage_Oauth_Model_Token",345],["T_DOUBLE_COLON","::",345],["T_STRING","TYPE_ACCESS",345],["T_WHITESPACE"," ",345],["T_IS_NOT_EQUAL","!=",345],["T_WHITESPACE"," ",345],["T_VARIABLE","$this",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","_token",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","getType",345],"(",")",")",["T_WHITESPACE"," ",345],"{",["T_WHITESPACE","\n                    ",345],["T_VARIABLE","$this",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","_throwException",346],"(",["T_CONSTANT_ENCAPSED_STRING","''",346],",",["T_WHITESPACE"," ",346],["T_STRING","self",346],["T_DOUBLE_COLON","::",346],["T_STRING","ERR_TOKEN_REJECTED",346],")",";",["T_WHITESPACE","\n                ",346],"}",["T_WHITESPACE","\n                ",347],["T_IF","if",348],["T_WHITESPACE"," ",348],"(",["T_VARIABLE","$this",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","_token",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","getRevoked",348],"(",")",")",["T_WHITESPACE"," ",348],"{",["T_WHITESPACE","\n                    ",348],["T_VARIABLE","$this",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","_throwException",349],"(",["T_CONSTANT_ENCAPSED_STRING","''",349],",",["T_WHITESPACE"," ",349],["T_STRING","self",349],["T_DOUBLE_COLON","::",349],["T_STRING","ERR_TOKEN_REVOKED",349],")",";",["T_WHITESPACE","\n                ",349],"}",["T_WHITESPACE","\n                ",350],["T_IF","if",351],["T_WHITESPACE"," ",351],"(",["T_VARIABLE","$this",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","_token",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","getConsumerId",351],"(",")",["T_WHITESPACE"," ",351],["T_IS_NOT_EQUAL","!=",351],["T_WHITESPACE"," ",351],["T_VARIABLE","$this",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","_consumer",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","getId",351],"(",")",")",["T_WHITESPACE"," ",351],"{",["T_WHITESPACE","\n                    ",351],["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","_throwException",352],"(",["T_CONSTANT_ENCAPSED_STRING","''",352],",",["T_WHITESPACE"," ",352],["T_STRING","self",352],["T_DOUBLE_COLON","::",352],["T_STRING","ERR_TOKEN_REJECTED",352],")",";",["T_WHITESPACE","\n                ",352],"}",["T_WHITESPACE","\n                ",353],["T_COMMENT","\/\/TODO: Implement check for expiration (after it implemented in token model)\n",354],["T_WHITESPACE","            ",355],"}",["T_WHITESPACE","\n        ",355],"}",["T_WHITESPACE"," ",356],["T_ELSE","else",356],["T_WHITESPACE"," ",356],"{",["T_WHITESPACE","\n            ",356],["T_VARIABLE","$this",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","_validateCallbackUrlParam",357],"(",")",";",["T_WHITESPACE","\n        ",357],"}",["T_WHITESPACE","\n        ",358],["T_RETURN","return",359],["T_WHITESPACE"," ",359],["T_VARIABLE","$this",359],";",["T_WHITESPACE","\n    ",359],"}",["T_WHITESPACE","\n\n    ",360],["T_DOC_COMMENT","\/**\n     * Is attribute is referred to oAuth protocol?\n     *\n     * @param string $attrName\n     * @return bool\n     *\/",362],["T_WHITESPACE","\n    ",367],["T_PROTECTED","protected",368],["T_WHITESPACE"," ",368],["T_FUNCTION","function",368],["T_WHITESPACE"," ",368],["T_STRING","_isProtocolParameter",368],"(",["T_VARIABLE","$attrName",368],")",["T_WHITESPACE","\n    ",368],"{",["T_WHITESPACE","\n        ",369],["T_RETURN","return",370],["T_WHITESPACE"," ",370],["T_BOOL_CAST","(bool)",370],["T_WHITESPACE"," ",370],["T_STRING","preg_match",370],"(",["T_CONSTANT_ENCAPSED_STRING","'\/oauth_[a-z_-]+\/'",370],",",["T_WHITESPACE"," ",370],["T_VARIABLE","$attrName",370],")",";",["T_WHITESPACE","\n    ",370],"}",["T_WHITESPACE","\n\n    ",371],["T_DOC_COMMENT","\/**\n     * Extract parameters from sources (GET, FormBody, Authorization header), decode them and validate\n     *\n     * @param string $requestType Request type - one of REQUEST_... class constant\n     * @return Mage_Oauth_Model_Server\n     * @throws Mage_Core_Exception\n     *\/",373],["T_WHITESPACE","\n    ",379],["T_PROTECTED","protected",380],["T_WHITESPACE"," ",380],["T_FUNCTION","function",380],["T_WHITESPACE"," ",380],["T_STRING","_processRequest",380],"(",["T_VARIABLE","$requestType",380],")",["T_WHITESPACE","\n    ",380],"{",["T_WHITESPACE","\n        ",381],["T_COMMENT","\/\/ validate request type to process (AUTHORIZE request is not allowed for method)\n",382],["T_WHITESPACE","        ",383],["T_IF","if",383],["T_WHITESPACE"," ",383],"(",["T_STRING","self",383],["T_DOUBLE_COLON","::",383],["T_STRING","REQUEST_INITIATE",383],["T_WHITESPACE"," ",383],["T_IS_NOT_EQUAL","!=",383],["T_WHITESPACE"," ",383],["T_VARIABLE","$requestType",383],["T_WHITESPACE","\n            ",383],["T_BOOLEAN_AND","&&",384],["T_WHITESPACE"," ",384],["T_STRING","self",384],["T_DOUBLE_COLON","::",384],["T_STRING","REQUEST_RESOURCE",384],["T_WHITESPACE"," ",384],["T_IS_NOT_EQUAL","!=",384],["T_WHITESPACE"," ",384],["T_VARIABLE","$requestType",384],["T_WHITESPACE","\n            ",384],["T_BOOLEAN_AND","&&",385],["T_WHITESPACE"," ",385],["T_STRING","self",385],["T_DOUBLE_COLON","::",385],["T_STRING","REQUEST_TOKEN",385],["T_WHITESPACE"," ",385],["T_IS_NOT_EQUAL","!=",385],["T_WHITESPACE"," ",385],["T_VARIABLE","$requestType",385],["T_WHITESPACE","\n        ",385],")",["T_WHITESPACE"," ",386],"{",["T_WHITESPACE","\n            ",386],["T_STRING","Mage",387],["T_DOUBLE_COLON","::",387],["T_STRING","throwException",387],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid request type'",387],")",";",["T_WHITESPACE","\n        ",387],"}",["T_WHITESPACE","\n        ",388],["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","_requestType",389],["T_WHITESPACE"," ",389],"=",["T_WHITESPACE"," ",389],["T_VARIABLE","$requestType",389],";",["T_WHITESPACE","\n\n        ",389],["T_COMMENT","\/\/ get parameters from request\n",391],["T_WHITESPACE","        ",392],["T_VARIABLE","$this",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","_fetchParams",392],"(",")",";",["T_WHITESPACE","\n\n        ",392],["T_COMMENT","\/\/ make generic validation of request parameters\n",394],["T_WHITESPACE","        ",395],["T_VARIABLE","$this",395],["T_OBJECT_OPERATOR","->",395],["T_STRING","_validateProtocolParams",395],"(",")",";",["T_WHITESPACE","\n\n        ",395],["T_COMMENT","\/\/ initialize consumer\n",397],["T_WHITESPACE","        ",398],["T_VARIABLE","$this",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","_initConsumer",398],"(",")",";",["T_WHITESPACE","\n\n        ",398],["T_COMMENT","\/\/ initialize token\n",400],["T_WHITESPACE","        ",401],["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","_initToken",401],"(",")",";",["T_WHITESPACE","\n\n        ",401],["T_COMMENT","\/\/ validate signature\n",403],["T_WHITESPACE","        ",404],["T_VARIABLE","$this",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","_validateSignature",404],"(",")",";",["T_WHITESPACE","\n\n        ",404],["T_COMMENT","\/\/ save token if signature validation succeed\n",406],["T_WHITESPACE","        ",407],["T_VARIABLE","$this",407],["T_OBJECT_OPERATOR","->",407],["T_STRING","_saveToken",407],"(",")",";",["T_WHITESPACE","\n\n        ",407],["T_RETURN","return",409],["T_WHITESPACE"," ",409],["T_VARIABLE","$this",409],";",["T_WHITESPACE","\n    ",409],"}",["T_WHITESPACE","\n\n    ",410],["T_DOC_COMMENT","\/**\n     * Save token\n     *\/",412],["T_WHITESPACE","\n    ",414],["T_PROTECTED","protected",415],["T_WHITESPACE"," ",415],["T_FUNCTION","function",415],["T_WHITESPACE"," ",415],["T_STRING","_saveToken",415],"(",")",["T_WHITESPACE","\n    ",415],"{",["T_WHITESPACE","\n        ",416],["T_IF","if",417],["T_WHITESPACE"," ",417],"(",["T_STRING","self",417],["T_DOUBLE_COLON","::",417],["T_STRING","REQUEST_INITIATE",417],["T_WHITESPACE"," ",417],["T_IS_EQUAL","==",417],["T_WHITESPACE"," ",417],["T_VARIABLE","$this",417],["T_OBJECT_OPERATOR","->",417],["T_STRING","_requestType",417],")",["T_WHITESPACE"," ",417],"{",["T_WHITESPACE","\n            ",417],["T_IF","if",418],["T_WHITESPACE"," ",418],"(",["T_STRING","self",418],["T_DOUBLE_COLON","::",418],["T_STRING","CALLBACK_ESTABLISHED",418],["T_WHITESPACE"," ",418],["T_IS_EQUAL","==",418],["T_WHITESPACE"," ",418],["T_VARIABLE","$this",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","_protocolParams",418],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_callback'",418],"]",["T_WHITESPACE","\n                ",418],["T_BOOLEAN_AND","&&",419],["T_WHITESPACE"," ",419],["T_VARIABLE","$this",419],["T_OBJECT_OPERATOR","->",419],["T_STRING","_consumer",419],["T_OBJECT_OPERATOR","->",419],["T_STRING","getCallBackUrl",419],"(",")",")",["T_WHITESPACE"," ",419],"{",["T_WHITESPACE","\n                ",419],["T_VARIABLE","$callbackUrl",420],["T_WHITESPACE"," ",420],"=",["T_WHITESPACE"," ",420],["T_VARIABLE","$this",420],["T_OBJECT_OPERATOR","->",420],["T_STRING","_consumer",420],["T_OBJECT_OPERATOR","->",420],["T_STRING","getCallBackUrl",420],"(",")",";",["T_WHITESPACE","\n            ",420],"}",["T_WHITESPACE"," ",421],["T_ELSE","else",421],["T_WHITESPACE"," ",421],"{",["T_WHITESPACE","\n                ",421],["T_VARIABLE","$callbackUrl",422],["T_WHITESPACE"," ",422],"=",["T_WHITESPACE"," ",422],["T_VARIABLE","$this",422],["T_OBJECT_OPERATOR","->",422],["T_STRING","_protocolParams",422],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_callback'",422],"]",";",["T_WHITESPACE","\n            ",422],"}",["T_WHITESPACE","\n            ",423],["T_VARIABLE","$this",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","_token",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","createRequestToken",424],"(",["T_VARIABLE","$this",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","_consumer",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","getId",424],"(",")",",",["T_WHITESPACE"," ",424],["T_VARIABLE","$callbackUrl",424],")",";",["T_WHITESPACE","\n        ",424],"}",["T_WHITESPACE"," ",425],["T_ELSEIF","elseif",425],["T_WHITESPACE"," ",425],"(",["T_STRING","self",425],["T_DOUBLE_COLON","::",425],["T_STRING","REQUEST_TOKEN",425],["T_WHITESPACE"," ",425],["T_IS_EQUAL","==",425],["T_WHITESPACE"," ",425],["T_VARIABLE","$this",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","_requestType",425],")",["T_WHITESPACE"," ",425],"{",["T_WHITESPACE","\n            ",425],["T_VARIABLE","$this",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","_token",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","convertToAccess",426],"(",")",";",["T_WHITESPACE","\n        ",426],"}",["T_WHITESPACE","\n    ",427],"}",["T_WHITESPACE","\n\n    ",428],["T_DOC_COMMENT","\/**\n     * Throw OAuth exception\n     *\n     * @param string $message Exception message\n     * @param int $code Exception code\n     * @throws Mage_Oauth_Exception\n     *\/",430],["T_WHITESPACE","\n    ",436],["T_PROTECTED","protected",437],["T_WHITESPACE"," ",437],["T_FUNCTION","function",437],["T_WHITESPACE"," ",437],["T_STRING","_throwException",437],"(",["T_VARIABLE","$message",437],["T_WHITESPACE"," ",437],"=",["T_WHITESPACE"," ",437],["T_CONSTANT_ENCAPSED_STRING","''",437],",",["T_WHITESPACE"," ",437],["T_VARIABLE","$code",437],["T_WHITESPACE"," ",437],"=",["T_WHITESPACE"," ",437],["T_LNUMBER","0",437],")",["T_WHITESPACE","\n    ",437],"{",["T_WHITESPACE","\n        ",438],["T_THROW","throw",439],["T_WHITESPACE"," ",439],["T_STRING","Mage",439],["T_DOUBLE_COLON","::",439],["T_STRING","exception",439],"(",["T_CONSTANT_ENCAPSED_STRING","'Mage_Oauth'",439],",",["T_WHITESPACE"," ",439],["T_VARIABLE","$message",439],",",["T_WHITESPACE"," ",439],["T_VARIABLE","$code",439],")",";",["T_WHITESPACE","\n    ",439],"}",["T_WHITESPACE","\n\n    ",440],["T_DOC_COMMENT","\/**\n     * Check for 'oauth_callback' parameter\n     *\/",442],["T_WHITESPACE","\n    ",444],["T_PROTECTED","protected",445],["T_WHITESPACE"," ",445],["T_FUNCTION","function",445],["T_WHITESPACE"," ",445],["T_STRING","_validateCallbackUrlParam",445],"(",")",["T_WHITESPACE","\n    ",445],"{",["T_WHITESPACE","\n        ",446],["T_IF","if",447],["T_WHITESPACE"," ",447],"(","!",["T_ISSET","isset",447],"(",["T_VARIABLE","$this",447],["T_OBJECT_OPERATOR","->",447],["T_STRING","_protocolParams",447],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_callback'",447],"]",")",")",["T_WHITESPACE"," ",447],"{",["T_WHITESPACE","\n            ",447],["T_VARIABLE","$this",448],["T_OBJECT_OPERATOR","->",448],["T_STRING","_throwException",448],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth_callback'",448],",",["T_WHITESPACE"," ",448],["T_STRING","self",448],["T_DOUBLE_COLON","::",448],["T_STRING","ERR_PARAMETER_ABSENT",448],")",";",["T_WHITESPACE","\n        ",448],"}",["T_WHITESPACE","\n        ",449],["T_IF","if",450],["T_WHITESPACE"," ",450],"(","!",["T_STRING","is_string",450],"(",["T_VARIABLE","$this",450],["T_OBJECT_OPERATOR","->",450],["T_STRING","_protocolParams",450],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_callback'",450],"]",")",")",["T_WHITESPACE"," ",450],"{",["T_WHITESPACE","\n            ",450],["T_VARIABLE","$this",451],["T_OBJECT_OPERATOR","->",451],["T_STRING","_throwException",451],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth_callback'",451],",",["T_WHITESPACE"," ",451],["T_STRING","self",451],["T_DOUBLE_COLON","::",451],["T_STRING","ERR_PARAMETER_REJECTED",451],")",";",["T_WHITESPACE","\n        ",451],"}",["T_WHITESPACE","\n        ",452],["T_IF","if",453],["T_WHITESPACE"," ",453],"(",["T_STRING","self",453],["T_DOUBLE_COLON","::",453],["T_STRING","CALLBACK_ESTABLISHED",453],["T_WHITESPACE"," ",453],["T_IS_NOT_EQUAL","!=",453],["T_WHITESPACE"," ",453],["T_VARIABLE","$this",453],["T_OBJECT_OPERATOR","->",453],["T_STRING","_protocolParams",453],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_callback'",453],"]",["T_WHITESPACE","\n            ",453],["T_BOOLEAN_AND","&&",454],["T_WHITESPACE"," ",454],"!",["T_STRING","Zend_Uri",454],["T_DOUBLE_COLON","::",454],["T_STRING","check",454],"(",["T_VARIABLE","$this",454],["T_OBJECT_OPERATOR","->",454],["T_STRING","_protocolParams",454],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_callback'",454],"]",")",["T_WHITESPACE","\n        ",454],")",["T_WHITESPACE"," ",455],"{",["T_WHITESPACE","\n            ",455],["T_VARIABLE","$this",456],["T_OBJECT_OPERATOR","->",456],["T_STRING","_throwException",456],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth_callback'",456],",",["T_WHITESPACE"," ",456],["T_STRING","self",456],["T_DOUBLE_COLON","::",456],["T_STRING","ERR_PARAMETER_REJECTED",456],")",";",["T_WHITESPACE","\n        ",456],"}",["T_WHITESPACE","\n    ",457],"}",["T_WHITESPACE","\n\n    ",458],["T_DOC_COMMENT","\/**\n     * Validate nonce request data\n     *\n     * @param string $nonce Nonce string\n     * @param string|int $timestamp UNIX Timestamp\n     *\/",460],["T_WHITESPACE","\n    ",465],["T_PROTECTED","protected",466],["T_WHITESPACE"," ",466],["T_FUNCTION","function",466],["T_WHITESPACE"," ",466],["T_STRING","_validateNonce",466],"(",["T_VARIABLE","$nonce",466],",",["T_WHITESPACE"," ",466],["T_VARIABLE","$timestamp",466],")",["T_WHITESPACE","\n    ",466],"{",["T_WHITESPACE","\n        ",467],["T_VARIABLE","$timestamp",468],["T_WHITESPACE"," ",468],"=",["T_WHITESPACE"," ",468],["T_INT_CAST","(int)",468],["T_WHITESPACE"," ",468],["T_VARIABLE","$timestamp",468],";",["T_WHITESPACE","\n\n        ",468],["T_IF","if",470],["T_WHITESPACE"," ",470],"(",["T_VARIABLE","$timestamp",470],["T_WHITESPACE"," ",470],["T_IS_SMALLER_OR_EQUAL","<=",470],["T_WHITESPACE"," ",470],["T_LNUMBER","0",470],["T_WHITESPACE"," ",470],["T_BOOLEAN_OR","||",470],["T_WHITESPACE"," ",470],["T_VARIABLE","$timestamp",470],["T_WHITESPACE"," ",470],">",["T_WHITESPACE"," ",470],"(",["T_STRING","time",470],"(",")",["T_WHITESPACE"," ",470],"+",["T_WHITESPACE"," ",470],["T_STRING","self",470],["T_DOUBLE_COLON","::",470],["T_STRING","TIME_DEVIATION",470],")",")",["T_WHITESPACE"," ",470],"{",["T_WHITESPACE","\n            ",470],["T_VARIABLE","$this",471],["T_OBJECT_OPERATOR","->",471],["T_STRING","_throwException",471],"(",["T_CONSTANT_ENCAPSED_STRING","''",471],",",["T_WHITESPACE"," ",471],["T_STRING","self",471],["T_DOUBLE_COLON","::",471],["T_STRING","ERR_TIMESTAMP_REFUSED",471],")",";",["T_WHITESPACE","\n        ",471],"}",["T_WHITESPACE","\n        ",472],["T_DOC_COMMENT","\/** @var $nonceObj Mage_Oauth_Model_Nonce *\/",473],["T_WHITESPACE","\n        ",473],["T_VARIABLE","$nonceObj",474],["T_WHITESPACE"," ",474],"=",["T_WHITESPACE"," ",474],["T_STRING","Mage",474],["T_DOUBLE_COLON","::",474],["T_STRING","getModel",474],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth\/nonce'",474],")",";",["T_WHITESPACE","\n\n        ",474],["T_VARIABLE","$nonceObj",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","load",476],"(",["T_VARIABLE","$nonce",476],",",["T_WHITESPACE"," ",476],["T_CONSTANT_ENCAPSED_STRING","'nonce'",476],")",";",["T_WHITESPACE","\n\n        ",476],["T_IF","if",478],["T_WHITESPACE"," ",478],"(",["T_VARIABLE","$nonceObj",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","getTimestamp",478],"(",")",["T_WHITESPACE"," ",478],["T_IS_EQUAL","==",478],["T_WHITESPACE"," ",478],["T_VARIABLE","$timestamp",478],")",["T_WHITESPACE"," ",478],"{",["T_WHITESPACE","\n            ",478],["T_VARIABLE","$this",479],["T_OBJECT_OPERATOR","->",479],["T_STRING","_throwException",479],"(",["T_CONSTANT_ENCAPSED_STRING","''",479],",",["T_WHITESPACE"," ",479],["T_STRING","self",479],["T_DOUBLE_COLON","::",479],["T_STRING","ERR_NONCE_USED",479],")",";",["T_WHITESPACE","\n        ",479],"}",["T_WHITESPACE","\n        ",480],["T_VARIABLE","$nonceObj",481],["T_OBJECT_OPERATOR","->",481],["T_STRING","setNonce",481],"(",["T_VARIABLE","$nonce",481],")",["T_WHITESPACE","\n            ",481],["T_OBJECT_OPERATOR","->",482],["T_STRING","setTimestamp",482],"(",["T_VARIABLE","$timestamp",482],")",["T_WHITESPACE","\n            ",482],["T_OBJECT_OPERATOR","->",483],["T_STRING","save",483],"(",")",";",["T_WHITESPACE","\n    ",483],"}",["T_WHITESPACE","\n\n    ",484],["T_DOC_COMMENT","\/**\n     * Validate protocol parameters\n     *\n     * @throws Mage_Oauth_Exception\n     *\/",486],["T_WHITESPACE","\n    ",490],["T_PROTECTED","protected",491],["T_WHITESPACE"," ",491],["T_FUNCTION","function",491],["T_WHITESPACE"," ",491],["T_STRING","_validateProtocolParams",491],"(",")",["T_WHITESPACE","\n    ",491],"{",["T_WHITESPACE","\n        ",492],["T_COMMENT","\/\/ validate version if specified\n",493],["T_WHITESPACE","        ",494],["T_IF","if",494],["T_WHITESPACE"," ",494],"(",["T_ISSET","isset",494],"(",["T_VARIABLE","$this",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","_protocolParams",494],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_version'",494],"]",")",["T_WHITESPACE"," ",494],["T_BOOLEAN_AND","&&",494],["T_WHITESPACE"," ",494],["T_CONSTANT_ENCAPSED_STRING","'1.0'",494],["T_WHITESPACE"," ",494],["T_IS_NOT_EQUAL","!=",494],["T_WHITESPACE"," ",494],["T_VARIABLE","$this",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","_protocolParams",494],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_version'",494],"]",")",["T_WHITESPACE"," ",494],"{",["T_WHITESPACE","\n            ",494],["T_VARIABLE","$this",495],["T_OBJECT_OPERATOR","->",495],["T_STRING","_throwException",495],"(",["T_CONSTANT_ENCAPSED_STRING","''",495],",",["T_WHITESPACE"," ",495],["T_STRING","self",495],["T_DOUBLE_COLON","::",495],["T_STRING","ERR_VERSION_REJECTED",495],")",";",["T_WHITESPACE","\n        ",495],"}",["T_WHITESPACE","\n        ",496],["T_COMMENT","\/\/ required parameters validation\n",497],["T_WHITESPACE","        ",498],["T_FOREACH","foreach",498],["T_WHITESPACE"," ",498],"(",["T_ARRAY","array",498],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth_consumer_key'",498],",",["T_WHITESPACE"," ",498],["T_CONSTANT_ENCAPSED_STRING","'oauth_signature_method'",498],",",["T_WHITESPACE"," ",498],["T_CONSTANT_ENCAPSED_STRING","'oauth_signature'",498],")",["T_WHITESPACE"," ",498],["T_AS","as",498],["T_WHITESPACE"," ",498],["T_VARIABLE","$reqField",498],")",["T_WHITESPACE"," ",498],"{",["T_WHITESPACE","\n            ",498],["T_IF","if",499],["T_WHITESPACE"," ",499],"(",["T_EMPTY","empty",499],"(",["T_VARIABLE","$this",499],["T_OBJECT_OPERATOR","->",499],["T_STRING","_protocolParams",499],"[",["T_VARIABLE","$reqField",499],"]",")",")",["T_WHITESPACE"," ",499],"{",["T_WHITESPACE","\n                ",499],["T_VARIABLE","$this",500],["T_OBJECT_OPERATOR","->",500],["T_STRING","_throwException",500],"(",["T_VARIABLE","$reqField",500],",",["T_WHITESPACE"," ",500],["T_STRING","self",500],["T_DOUBLE_COLON","::",500],["T_STRING","ERR_PARAMETER_ABSENT",500],")",";",["T_WHITESPACE","\n            ",500],"}",["T_WHITESPACE","\n        ",501],"}",["T_WHITESPACE","\n        ",502],["T_COMMENT","\/\/ validate parameters type\n",503],["T_WHITESPACE","        ",504],["T_FOREACH","foreach",504],["T_WHITESPACE"," ",504],"(",["T_VARIABLE","$this",504],["T_OBJECT_OPERATOR","->",504],["T_STRING","_protocolParams",504],["T_WHITESPACE"," ",504],["T_AS","as",504],["T_WHITESPACE"," ",504],["T_VARIABLE","$paramName",504],["T_WHITESPACE"," ",504],["T_DOUBLE_ARROW","=>",504],["T_WHITESPACE"," ",504],["T_VARIABLE","$paramValue",504],")",["T_WHITESPACE"," ",504],"{",["T_WHITESPACE","\n            ",504],["T_IF","if",505],["T_WHITESPACE"," ",505],"(","!",["T_STRING","is_string",505],"(",["T_VARIABLE","$paramValue",505],")",")",["T_WHITESPACE"," ",505],"{",["T_WHITESPACE","\n                ",505],["T_VARIABLE","$this",506],["T_OBJECT_OPERATOR","->",506],["T_STRING","_throwException",506],"(",["T_VARIABLE","$paramName",506],",",["T_WHITESPACE"," ",506],["T_STRING","self",506],["T_DOUBLE_COLON","::",506],["T_STRING","ERR_PARAMETER_REJECTED",506],")",";",["T_WHITESPACE","\n            ",506],"}",["T_WHITESPACE","\n        ",507],"}",["T_WHITESPACE","\n        ",508],["T_COMMENT","\/\/ validate consumer key length\n",509],["T_WHITESPACE","        ",510],["T_IF","if",510],["T_WHITESPACE"," ",510],"(",["T_STRING","strlen",510],"(",["T_VARIABLE","$this",510],["T_OBJECT_OPERATOR","->",510],["T_STRING","_protocolParams",510],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_consumer_key'",510],"]",")",["T_WHITESPACE"," ",510],["T_IS_NOT_EQUAL","!=",510],["T_WHITESPACE"," ",510],["T_STRING","Mage_Oauth_Model_Consumer",510],["T_DOUBLE_COLON","::",510],["T_STRING","KEY_LENGTH",510],")",["T_WHITESPACE"," ",510],"{",["T_WHITESPACE","\n            ",510],["T_VARIABLE","$this",511],["T_OBJECT_OPERATOR","->",511],["T_STRING","_throwException",511],"(",["T_CONSTANT_ENCAPSED_STRING","''",511],",",["T_WHITESPACE"," ",511],["T_STRING","self",511],["T_DOUBLE_COLON","::",511],["T_STRING","ERR_CONSUMER_KEY_REJECTED",511],")",";",["T_WHITESPACE","\n        ",511],"}",["T_WHITESPACE","\n        ",512],["T_COMMENT","\/\/ validate signature method\n",513],["T_WHITESPACE","        ",514],["T_IF","if",514],["T_WHITESPACE"," ",514],"(","!",["T_STRING","in_array",514],"(",["T_VARIABLE","$this",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","_protocolParams",514],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_signature_method'",514],"]",",",["T_WHITESPACE"," ",514],["T_STRING","self",514],["T_DOUBLE_COLON","::",514],["T_STRING","getSupportedSignatureMethods",514],"(",")",")",")",["T_WHITESPACE"," ",514],"{",["T_WHITESPACE","\n            ",514],["T_VARIABLE","$this",515],["T_OBJECT_OPERATOR","->",515],["T_STRING","_throwException",515],"(",["T_CONSTANT_ENCAPSED_STRING","''",515],",",["T_WHITESPACE"," ",515],["T_STRING","self",515],["T_DOUBLE_COLON","::",515],["T_STRING","ERR_SIGNATURE_METHOD_REJECTED",515],")",";",["T_WHITESPACE","\n        ",515],"}",["T_WHITESPACE","\n        ",516],["T_COMMENT","\/\/ validate nonce data if signature method is not PLAINTEXT\n",517],["T_WHITESPACE","        ",518],["T_IF","if",518],["T_WHITESPACE"," ",518],"(",["T_STRING","self",518],["T_DOUBLE_COLON","::",518],["T_STRING","SIGNATURE_PLAIN",518],["T_WHITESPACE"," ",518],["T_IS_NOT_EQUAL","!=",518],["T_WHITESPACE"," ",518],["T_VARIABLE","$this",518],["T_OBJECT_OPERATOR","->",518],["T_STRING","_protocolParams",518],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_signature_method'",518],"]",")",["T_WHITESPACE"," ",518],"{",["T_WHITESPACE","\n            ",518],["T_IF","if",519],["T_WHITESPACE"," ",519],"(",["T_EMPTY","empty",519],"(",["T_VARIABLE","$this",519],["T_OBJECT_OPERATOR","->",519],["T_STRING","_protocolParams",519],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_nonce'",519],"]",")",")",["T_WHITESPACE"," ",519],"{",["T_WHITESPACE","\n                ",519],["T_VARIABLE","$this",520],["T_OBJECT_OPERATOR","->",520],["T_STRING","_throwException",520],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth_nonce'",520],",",["T_WHITESPACE"," ",520],["T_STRING","self",520],["T_DOUBLE_COLON","::",520],["T_STRING","ERR_PARAMETER_ABSENT",520],")",";",["T_WHITESPACE","\n            ",520],"}",["T_WHITESPACE","\n            ",521],["T_IF","if",522],["T_WHITESPACE"," ",522],"(",["T_EMPTY","empty",522],"(",["T_VARIABLE","$this",522],["T_OBJECT_OPERATOR","->",522],["T_STRING","_protocolParams",522],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_timestamp'",522],"]",")",")",["T_WHITESPACE"," ",522],"{",["T_WHITESPACE","\n                ",522],["T_VARIABLE","$this",523],["T_OBJECT_OPERATOR","->",523],["T_STRING","_throwException",523],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth_timestamp'",523],",",["T_WHITESPACE"," ",523],["T_STRING","self",523],["T_DOUBLE_COLON","::",523],["T_STRING","ERR_PARAMETER_ABSENT",523],")",";",["T_WHITESPACE","\n            ",523],"}",["T_WHITESPACE","\n            ",524],["T_VARIABLE","$this",525],["T_OBJECT_OPERATOR","->",525],["T_STRING","_validateNonce",525],"(",["T_VARIABLE","$this",525],["T_OBJECT_OPERATOR","->",525],["T_STRING","_protocolParams",525],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_nonce'",525],"]",",",["T_WHITESPACE"," ",525],["T_VARIABLE","$this",525],["T_OBJECT_OPERATOR","->",525],["T_STRING","_protocolParams",525],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_timestamp'",525],"]",")",";",["T_WHITESPACE","\n        ",525],"}",["T_WHITESPACE","\n    ",526],"}",["T_WHITESPACE","\n\n    ",527],["T_DOC_COMMENT","\/**\n     * Validate signature\n     *\n     * @throws Mage_Oauth_Exception\n     *\/",529],["T_WHITESPACE","\n    ",533],["T_PROTECTED","protected",534],["T_WHITESPACE"," ",534],["T_FUNCTION","function",534],["T_WHITESPACE"," ",534],["T_STRING","_validateSignature",534],"(",")",["T_WHITESPACE","\n    ",534],"{",["T_WHITESPACE","\n        ",535],["T_VARIABLE","$util",536],["T_WHITESPACE"," ",536],"=",["T_WHITESPACE"," ",536],["T_NEW","new",536],["T_WHITESPACE"," ",536],["T_STRING","Zend_Oauth_Http_Utility",536],"(",")",";",["T_WHITESPACE","\n\n        ",536],["T_VARIABLE","$calculatedSign",538],["T_WHITESPACE"," ",538],"=",["T_WHITESPACE"," ",538],["T_VARIABLE","$util",538],["T_OBJECT_OPERATOR","->",538],["T_STRING","sign",538],"(",["T_WHITESPACE","\n            ",538],["T_STRING","array_merge",539],"(",["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","_params",539],",",["T_WHITESPACE"," ",539],["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","_protocolParams",539],")",",",["T_WHITESPACE","\n            ",539],["T_VARIABLE","$this",540],["T_OBJECT_OPERATOR","->",540],["T_STRING","_protocolParams",540],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_signature_method'",540],"]",",",["T_WHITESPACE","\n            ",540],["T_VARIABLE","$this",541],["T_OBJECT_OPERATOR","->",541],["T_STRING","_consumer",541],["T_OBJECT_OPERATOR","->",541],["T_STRING","getSecret",541],"(",")",",",["T_WHITESPACE","\n            ",541],["T_VARIABLE","$this",542],["T_OBJECT_OPERATOR","->",542],["T_STRING","_token",542],["T_OBJECT_OPERATOR","->",542],["T_STRING","getSecret",542],"(",")",",",["T_WHITESPACE","\n            ",542],["T_VARIABLE","$this",543],["T_OBJECT_OPERATOR","->",543],["T_STRING","_request",543],["T_OBJECT_OPERATOR","->",543],["T_STRING","getMethod",543],"(",")",",",["T_WHITESPACE","\n            ",543],["T_VARIABLE","$this",544],["T_OBJECT_OPERATOR","->",544],["T_STRING","_request",544],["T_OBJECT_OPERATOR","->",544],["T_STRING","getScheme",544],"(",")",["T_WHITESPACE"," ",544],".",["T_WHITESPACE"," ",544],["T_CONSTANT_ENCAPSED_STRING","':\/\/'",544],["T_WHITESPACE"," ",544],".",["T_WHITESPACE"," ",544],["T_VARIABLE","$this",544],["T_OBJECT_OPERATOR","->",544],["T_STRING","_request",544],["T_OBJECT_OPERATOR","->",544],["T_STRING","getHttpHost",544],"(",")",["T_WHITESPACE"," ",544],".",["T_WHITESPACE"," ",544],["T_VARIABLE","$this",544],["T_OBJECT_OPERATOR","->",544],["T_STRING","_request",544],["T_OBJECT_OPERATOR","->",544],["T_STRING","getRequestUri",544],"(",")",["T_WHITESPACE","\n        ",544],")",";",["T_WHITESPACE","\n\n        ",545],["T_IF","if",547],["T_WHITESPACE"," ",547],"(","!",["T_STRING","hash_equals",547],"(",["T_VARIABLE","$calculatedSign",547],",",["T_WHITESPACE"," ",547],["T_VARIABLE","$this",547],["T_OBJECT_OPERATOR","->",547],["T_STRING","_protocolParams",547],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_signature'",547],"]",")",")",["T_WHITESPACE"," ",547],"{",["T_WHITESPACE","\n            ",547],["T_VARIABLE","$this",548],["T_OBJECT_OPERATOR","->",548],["T_STRING","_throwException",548],"(",["T_CONSTANT_ENCAPSED_STRING","''",548],",",["T_WHITESPACE"," ",548],["T_STRING","self",548],["T_DOUBLE_COLON","::",548],["T_STRING","ERR_SIGNATURE_INVALID",548],")",";",["T_WHITESPACE","\n        ",548],"}",["T_WHITESPACE","\n    ",549],"}",["T_WHITESPACE","\n\n    ",550],["T_DOC_COMMENT","\/**\n     * Check for 'oauth_token' parameter\n     *\/",552],["T_WHITESPACE","\n    ",554],["T_PROTECTED","protected",555],["T_WHITESPACE"," ",555],["T_FUNCTION","function",555],["T_WHITESPACE"," ",555],["T_STRING","_validateTokenParam",555],"(",")",["T_WHITESPACE","\n    ",555],"{",["T_WHITESPACE","\n        ",556],["T_IF","if",557],["T_WHITESPACE"," ",557],"(",["T_EMPTY","empty",557],"(",["T_VARIABLE","$this",557],["T_OBJECT_OPERATOR","->",557],["T_STRING","_protocolParams",557],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_token'",557],"]",")",")",["T_WHITESPACE"," ",557],"{",["T_WHITESPACE","\n            ",557],["T_VARIABLE","$this",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","_throwException",558],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth_token'",558],",",["T_WHITESPACE"," ",558],["T_STRING","self",558],["T_DOUBLE_COLON","::",558],["T_STRING","ERR_PARAMETER_ABSENT",558],")",";",["T_WHITESPACE","\n        ",558],"}",["T_WHITESPACE","\n        ",559],["T_IF","if",560],["T_WHITESPACE"," ",560],"(","!",["T_STRING","is_string",560],"(",["T_VARIABLE","$this",560],["T_OBJECT_OPERATOR","->",560],["T_STRING","_protocolParams",560],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_token'",560],"]",")",")",["T_WHITESPACE"," ",560],"{",["T_WHITESPACE","\n            ",560],["T_VARIABLE","$this",561],["T_OBJECT_OPERATOR","->",561],["T_STRING","_throwException",561],"(",["T_CONSTANT_ENCAPSED_STRING","''",561],",",["T_WHITESPACE"," ",561],["T_STRING","self",561],["T_DOUBLE_COLON","::",561],["T_STRING","ERR_TOKEN_REJECTED",561],")",";",["T_WHITESPACE","\n        ",561],"}",["T_WHITESPACE","\n        ",562],["T_IF","if",563],["T_WHITESPACE"," ",563],"(",["T_STRING","strlen",563],"(",["T_VARIABLE","$this",563],["T_OBJECT_OPERATOR","->",563],["T_STRING","_protocolParams",563],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_token'",563],"]",")",["T_WHITESPACE"," ",563],["T_IS_NOT_EQUAL","!=",563],["T_WHITESPACE"," ",563],["T_STRING","Mage_Oauth_Model_Token",563],["T_DOUBLE_COLON","::",563],["T_STRING","LENGTH_TOKEN",563],")",["T_WHITESPACE"," ",563],"{",["T_WHITESPACE","\n            ",563],["T_VARIABLE","$this",564],["T_OBJECT_OPERATOR","->",564],["T_STRING","_throwException",564],"(",["T_CONSTANT_ENCAPSED_STRING","''",564],",",["T_WHITESPACE"," ",564],["T_STRING","self",564],["T_DOUBLE_COLON","::",564],["T_STRING","ERR_TOKEN_REJECTED",564],")",";",["T_WHITESPACE","\n        ",564],"}",["T_WHITESPACE","\n    ",565],"}",["T_WHITESPACE","\n\n    ",566],["T_DOC_COMMENT","\/**\n     * Check for 'oauth_verifier' parameter\n     *\/",568],["T_WHITESPACE","\n    ",570],["T_PROTECTED","protected",571],["T_WHITESPACE"," ",571],["T_FUNCTION","function",571],["T_WHITESPACE"," ",571],["T_STRING","_validateVerifierParam",571],"(",")",["T_WHITESPACE","\n    ",571],"{",["T_WHITESPACE","\n        ",572],["T_IF","if",573],["T_WHITESPACE"," ",573],"(",["T_EMPTY","empty",573],"(",["T_VARIABLE","$this",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","_protocolParams",573],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_verifier'",573],"]",")",")",["T_WHITESPACE"," ",573],"{",["T_WHITESPACE","\n            ",573],["T_VARIABLE","$this",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","_throwException",574],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth_verifier'",574],",",["T_WHITESPACE"," ",574],["T_STRING","self",574],["T_DOUBLE_COLON","::",574],["T_STRING","ERR_PARAMETER_ABSENT",574],")",";",["T_WHITESPACE","\n        ",574],"}",["T_WHITESPACE","\n        ",575],["T_IF","if",576],["T_WHITESPACE"," ",576],"(","!",["T_STRING","is_string",576],"(",["T_VARIABLE","$this",576],["T_OBJECT_OPERATOR","->",576],["T_STRING","_protocolParams",576],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_verifier'",576],"]",")",")",["T_WHITESPACE"," ",576],"{",["T_WHITESPACE","\n            ",576],["T_VARIABLE","$this",577],["T_OBJECT_OPERATOR","->",577],["T_STRING","_throwException",577],"(",["T_CONSTANT_ENCAPSED_STRING","''",577],",",["T_WHITESPACE"," ",577],["T_STRING","self",577],["T_DOUBLE_COLON","::",577],["T_STRING","ERR_VERIFIER_INVALID",577],")",";",["T_WHITESPACE","\n        ",577],"}",["T_WHITESPACE","\n        ",578],["T_IF","if",579],["T_WHITESPACE"," ",579],"(",["T_STRING","strlen",579],"(",["T_VARIABLE","$this",579],["T_OBJECT_OPERATOR","->",579],["T_STRING","_protocolParams",579],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_verifier'",579],"]",")",["T_WHITESPACE"," ",579],["T_IS_NOT_EQUAL","!=",579],["T_WHITESPACE"," ",579],["T_STRING","Mage_Oauth_Model_Token",579],["T_DOUBLE_COLON","::",579],["T_STRING","LENGTH_VERIFIER",579],")",["T_WHITESPACE"," ",579],"{",["T_WHITESPACE","\n            ",579],["T_VARIABLE","$this",580],["T_OBJECT_OPERATOR","->",580],["T_STRING","_throwException",580],"(",["T_CONSTANT_ENCAPSED_STRING","''",580],",",["T_WHITESPACE"," ",580],["T_STRING","self",580],["T_DOUBLE_COLON","::",580],["T_STRING","ERR_VERIFIER_INVALID",580],")",";",["T_WHITESPACE","\n        ",580],"}",["T_WHITESPACE","\n    ",581],"}",["T_WHITESPACE","\n\n    ",582],["T_DOC_COMMENT","\/**\n     * Process request for permanent access token\n     *\/",584],["T_WHITESPACE","\n    ",586],["T_PUBLIC","public",587],["T_WHITESPACE"," ",587],["T_FUNCTION","function",587],["T_WHITESPACE"," ",587],["T_STRING","accessToken",587],"(",")",["T_WHITESPACE","\n    ",587],"{",["T_WHITESPACE","\n        ",588],["T_TRY","try",589],["T_WHITESPACE"," ",589],"{",["T_WHITESPACE","\n            ",589],["T_VARIABLE","$this",590],["T_OBJECT_OPERATOR","->",590],["T_STRING","_processRequest",590],"(",["T_STRING","self",590],["T_DOUBLE_COLON","::",590],["T_STRING","REQUEST_TOKEN",590],")",";",["T_WHITESPACE","\n\n            ",590],["T_VARIABLE","$response",592],["T_WHITESPACE"," ",592],"=",["T_WHITESPACE"," ",592],["T_VARIABLE","$this",592],["T_OBJECT_OPERATOR","->",592],["T_STRING","_token",592],["T_OBJECT_OPERATOR","->",592],["T_STRING","toString",592],"(",")",";",["T_WHITESPACE","\n        ",592],"}",["T_WHITESPACE"," ",593],["T_CATCH","catch",593],["T_WHITESPACE"," ",593],"(",["T_STRING","Exception",593],["T_WHITESPACE"," ",593],["T_VARIABLE","$e",593],")",["T_WHITESPACE"," ",593],"{",["T_WHITESPACE","\n            ",593],["T_VARIABLE","$response",594],["T_WHITESPACE"," ",594],"=",["T_WHITESPACE"," ",594],["T_VARIABLE","$this",594],["T_OBJECT_OPERATOR","->",594],["T_STRING","reportProblem",594],"(",["T_VARIABLE","$e",594],")",";",["T_WHITESPACE","\n        ",594],"}",["T_WHITESPACE","\n        ",595],["T_VARIABLE","$this",596],["T_OBJECT_OPERATOR","->",596],["T_STRING","_getResponse",596],"(",")",["T_OBJECT_OPERATOR","->",596],["T_STRING","setBody",596],"(",["T_VARIABLE","$response",596],")",";",["T_WHITESPACE","\n    ",596],"}",["T_WHITESPACE","\n\n    ",597],["T_DOC_COMMENT","\/**\n     * Validate request, authorize token and return it\n     *\n     * @param int $userId Authorization user identifier\n     * @param string $userType Authorization user type\n     * @return Mage_Oauth_Model_Token\n     *\/",599],["T_WHITESPACE","\n    ",605],["T_PUBLIC","public",606],["T_WHITESPACE"," ",606],["T_FUNCTION","function",606],["T_WHITESPACE"," ",606],["T_STRING","authorizeToken",606],"(",["T_VARIABLE","$userId",606],",",["T_WHITESPACE"," ",606],["T_VARIABLE","$userType",606],")",["T_WHITESPACE","\n    ",606],"{",["T_WHITESPACE","\n        ",607],["T_VARIABLE","$token",608],["T_WHITESPACE"," ",608],"=",["T_WHITESPACE"," ",608],["T_VARIABLE","$this",608],["T_OBJECT_OPERATOR","->",608],["T_STRING","checkAuthorizeRequest",608],"(",")",";",["T_WHITESPACE","\n\n        ",608],["T_VARIABLE","$token",610],["T_OBJECT_OPERATOR","->",610],["T_STRING","authorize",610],"(",["T_VARIABLE","$userId",610],",",["T_WHITESPACE"," ",610],["T_VARIABLE","$userType",610],")",";",["T_WHITESPACE","\n\n        ",610],["T_RETURN","return",612],["T_WHITESPACE"," ",612],["T_VARIABLE","$token",612],";",["T_WHITESPACE","\n    ",612],"}",["T_WHITESPACE","\n\n    ",613],["T_DOC_COMMENT","\/**\n     * Validate request with access token for specified URL\n     *\n     * @return Mage_Oauth_Model_Token\n     *\/",615],["T_WHITESPACE","\n    ",619],["T_PUBLIC","public",620],["T_WHITESPACE"," ",620],["T_FUNCTION","function",620],["T_WHITESPACE"," ",620],["T_STRING","checkAccessRequest",620],"(",")",["T_WHITESPACE","\n    ",620],"{",["T_WHITESPACE","\n        ",621],["T_VARIABLE","$this",622],["T_OBJECT_OPERATOR","->",622],["T_STRING","_processRequest",622],"(",["T_STRING","self",622],["T_DOUBLE_COLON","::",622],["T_STRING","REQUEST_RESOURCE",622],")",";",["T_WHITESPACE","\n\n        ",622],["T_RETURN","return",624],["T_WHITESPACE"," ",624],["T_VARIABLE","$this",624],["T_OBJECT_OPERATOR","->",624],["T_STRING","_token",624],";",["T_WHITESPACE","\n    ",624],"}",["T_WHITESPACE","\n\n    ",625],["T_DOC_COMMENT","\/**\n     * Check authorize request for validity and return token\n     *\n     * @return Mage_Oauth_Model_Token\n     *\/",627],["T_WHITESPACE","\n    ",631],["T_PUBLIC","public",632],["T_WHITESPACE"," ",632],["T_FUNCTION","function",632],["T_WHITESPACE"," ",632],["T_STRING","checkAuthorizeRequest",632],"(",")",["T_WHITESPACE","\n    ",632],"{",["T_WHITESPACE","\n        ",633],["T_IF","if",634],["T_WHITESPACE"," ",634],"(","!",["T_VARIABLE","$this",634],["T_OBJECT_OPERATOR","->",634],["T_STRING","_request",634],["T_OBJECT_OPERATOR","->",634],["T_STRING","isGet",634],"(",")",")",["T_WHITESPACE"," ",634],"{",["T_WHITESPACE","\n            ",634],["T_STRING","Mage",635],["T_DOUBLE_COLON","::",635],["T_STRING","throwException",635],"(",["T_CONSTANT_ENCAPSED_STRING","'Request is not GET'",635],")",";",["T_WHITESPACE","\n        ",635],"}",["T_WHITESPACE","\n        ",636],["T_VARIABLE","$this",637],["T_OBJECT_OPERATOR","->",637],["T_STRING","_requestType",637],["T_WHITESPACE"," ",637],"=",["T_WHITESPACE"," ",637],["T_STRING","self",637],["T_DOUBLE_COLON","::",637],["T_STRING","REQUEST_AUTHORIZE",637],";",["T_WHITESPACE","\n\n        ",637],["T_VARIABLE","$this",639],["T_OBJECT_OPERATOR","->",639],["T_STRING","_fetchProtocolParamsFromQuery",639],"(",")",";",["T_WHITESPACE","\n        ",639],["T_VARIABLE","$this",640],["T_OBJECT_OPERATOR","->",640],["T_STRING","_initToken",640],"(",")",";",["T_WHITESPACE","\n\n        ",640],["T_RETURN","return",642],["T_WHITESPACE"," ",642],["T_VARIABLE","$this",642],["T_OBJECT_OPERATOR","->",642],["T_STRING","_token",642],";",["T_WHITESPACE","\n    ",642],"}",["T_WHITESPACE","\n\n    ",643],["T_DOC_COMMENT","\/**\n     * Retrieve array of supported signature methods\n     *\n     * @return array\n     *\/",645],["T_WHITESPACE","\n    ",649],["T_PUBLIC","public",650],["T_WHITESPACE"," ",650],["T_STATIC","static",650],["T_WHITESPACE"," ",650],["T_FUNCTION","function",650],["T_WHITESPACE"," ",650],["T_STRING","getSupportedSignatureMethods",650],"(",")",["T_WHITESPACE","\n    ",650],"{",["T_WHITESPACE","\n        ",651],["T_RETURN","return",652],["T_WHITESPACE"," ",652],["T_ARRAY","array",652],"(",["T_STRING","self",652],["T_DOUBLE_COLON","::",652],["T_STRING","SIGNATURE_RSA",652],",",["T_WHITESPACE"," ",652],["T_STRING","self",652],["T_DOUBLE_COLON","::",652],["T_STRING","SIGNATURE_HMAC",652],",",["T_WHITESPACE"," ",652],["T_STRING","self",652],["T_DOUBLE_COLON","::",652],["T_STRING","SIGNATURE_PLAIN",652],")",";",["T_WHITESPACE","\n    ",652],"}",["T_WHITESPACE","\n\n    ",653],["T_DOC_COMMENT","\/**\n     * Process request for temporary (initiative) token\n     *\/",655],["T_WHITESPACE","\n    ",657],["T_PUBLIC","public",658],["T_WHITESPACE"," ",658],["T_FUNCTION","function",658],["T_WHITESPACE"," ",658],["T_STRING","initiateToken",658],"(",")",["T_WHITESPACE","\n    ",658],"{",["T_WHITESPACE","\n        ",659],["T_TRY","try",660],["T_WHITESPACE"," ",660],"{",["T_WHITESPACE","\n            ",660],["T_VARIABLE","$this",661],["T_OBJECT_OPERATOR","->",661],["T_STRING","_processRequest",661],"(",["T_STRING","self",661],["T_DOUBLE_COLON","::",661],["T_STRING","REQUEST_INITIATE",661],")",";",["T_WHITESPACE","\n\n            ",661],["T_VARIABLE","$response",663],["T_WHITESPACE"," ",663],"=",["T_WHITESPACE"," ",663],["T_VARIABLE","$this",663],["T_OBJECT_OPERATOR","->",663],["T_STRING","_token",663],["T_OBJECT_OPERATOR","->",663],["T_STRING","toString",663],"(",")",["T_WHITESPACE"," ",663],".",["T_WHITESPACE"," ",663],["T_CONSTANT_ENCAPSED_STRING","'&oauth_callback_confirmed=true'",663],";",["T_WHITESPACE","\n        ",663],"}",["T_WHITESPACE"," ",664],["T_CATCH","catch",664],["T_WHITESPACE"," ",664],"(",["T_STRING","Exception",664],["T_WHITESPACE"," ",664],["T_VARIABLE","$e",664],")",["T_WHITESPACE"," ",664],"{",["T_WHITESPACE","\n            ",664],["T_VARIABLE","$response",665],["T_WHITESPACE"," ",665],"=",["T_WHITESPACE"," ",665],["T_VARIABLE","$this",665],["T_OBJECT_OPERATOR","->",665],["T_STRING","reportProblem",665],"(",["T_VARIABLE","$e",665],")",";",["T_WHITESPACE","\n        ",665],"}",["T_WHITESPACE","\n        ",666],["T_VARIABLE","$this",667],["T_OBJECT_OPERATOR","->",667],["T_STRING","_getResponse",667],"(",")",["T_OBJECT_OPERATOR","->",667],["T_STRING","setBody",667],"(",["T_VARIABLE","$response",667],")",";",["T_WHITESPACE","\n    ",667],"}",["T_WHITESPACE","\n\n    ",668],["T_DOC_COMMENT","\/**\n     * Create response string for problem during request and set HTTP error code\n     *\n     * @param Exception $e\n     * @param Zend_Controller_Response_Http $response OPTIONAL If NULL - will use internal getter\n     * @return string\n     *\/",670],["T_WHITESPACE","\n    ",676],["T_PUBLIC","public",677],["T_WHITESPACE"," ",677],["T_FUNCTION","function",677],["T_WHITESPACE"," ",677],["T_STRING","reportProblem",677],"(",["T_STRING","Exception",677],["T_WHITESPACE"," ",677],["T_VARIABLE","$e",677],",",["T_WHITESPACE"," ",677],["T_STRING","Zend_Controller_Response_Http",677],["T_WHITESPACE"," ",677],["T_VARIABLE","$response",677],["T_WHITESPACE"," ",677],"=",["T_WHITESPACE"," ",677],["T_STRING","null",677],")",["T_WHITESPACE","\n    ",677],"{",["T_WHITESPACE","\n        ",678],["T_VARIABLE","$eMsg",679],["T_WHITESPACE"," ",679],"=",["T_WHITESPACE"," ",679],["T_VARIABLE","$e",679],["T_OBJECT_OPERATOR","->",679],["T_STRING","getMessage",679],"(",")",";",["T_WHITESPACE","\n\n        ",679],["T_IF","if",681],["T_WHITESPACE"," ",681],"(",["T_VARIABLE","$e",681],["T_WHITESPACE"," ",681],["T_INSTANCEOF","instanceof",681],["T_WHITESPACE"," ",681],["T_STRING","Mage_Oauth_Exception",681],")",["T_WHITESPACE"," ",681],"{",["T_WHITESPACE","\n            ",681],["T_VARIABLE","$eCode",682],["T_WHITESPACE"," ",682],"=",["T_WHITESPACE"," ",682],["T_VARIABLE","$e",682],["T_OBJECT_OPERATOR","->",682],["T_STRING","getCode",682],"(",")",";",["T_WHITESPACE","\n\n            ",682],["T_IF","if",684],["T_WHITESPACE"," ",684],"(",["T_ISSET","isset",684],"(",["T_VARIABLE","$this",684],["T_OBJECT_OPERATOR","->",684],["T_STRING","_errors",684],"[",["T_VARIABLE","$eCode",684],"]",")",")",["T_WHITESPACE"," ",684],"{",["T_WHITESPACE","\n                ",684],["T_VARIABLE","$errorMsg",685],["T_WHITESPACE"," ",685],"=",["T_WHITESPACE"," ",685],["T_VARIABLE","$this",685],["T_OBJECT_OPERATOR","->",685],["T_STRING","_errors",685],"[",["T_VARIABLE","$eCode",685],"]",";",["T_WHITESPACE","\n                ",685],["T_VARIABLE","$responseCode",686],["T_WHITESPACE"," ",686],"=",["T_WHITESPACE"," ",686],["T_VARIABLE","$this",686],["T_OBJECT_OPERATOR","->",686],["T_STRING","_errorsToHttpCode",686],"[",["T_VARIABLE","$eCode",686],"]",";",["T_WHITESPACE","\n            ",686],"}",["T_WHITESPACE"," ",687],["T_ELSE","else",687],["T_WHITESPACE"," ",687],"{",["T_WHITESPACE","\n                ",687],["T_VARIABLE","$errorMsg",688],["T_WHITESPACE"," ",688],"=",["T_WHITESPACE"," ",688],["T_CONSTANT_ENCAPSED_STRING","'unknown_problem&code='",688],["T_WHITESPACE"," ",688],".",["T_WHITESPACE"," ",688],["T_VARIABLE","$eCode",688],";",["T_WHITESPACE","\n                ",688],["T_VARIABLE","$responseCode",689],["T_WHITESPACE"," ",689],"=",["T_WHITESPACE"," ",689],["T_STRING","self",689],["T_DOUBLE_COLON","::",689],["T_STRING","HTTP_INTERNAL_ERROR",689],";",["T_WHITESPACE","\n            ",689],"}",["T_WHITESPACE","\n            ",690],["T_IF","if",691],["T_WHITESPACE"," ",691],"(",["T_STRING","self",691],["T_DOUBLE_COLON","::",691],["T_STRING","ERR_PARAMETER_ABSENT",691],["T_WHITESPACE"," ",691],["T_IS_EQUAL","==",691],["T_WHITESPACE"," ",691],["T_VARIABLE","$eCode",691],")",["T_WHITESPACE"," ",691],"{",["T_WHITESPACE","\n                ",691],["T_VARIABLE","$errorMsg",692],["T_WHITESPACE"," ",692],["T_CONCAT_EQUAL",".=",692],["T_WHITESPACE"," ",692],["T_CONSTANT_ENCAPSED_STRING","'&oauth_parameters_absent='",692],["T_WHITESPACE"," ",692],".",["T_WHITESPACE"," ",692],["T_VARIABLE","$eMsg",692],";",["T_WHITESPACE","\n            ",692],"}",["T_WHITESPACE"," ",693],["T_ELSEIF","elseif",693],["T_WHITESPACE"," ",693],"(",["T_VARIABLE","$eMsg",693],")",["T_WHITESPACE"," ",693],"{",["T_WHITESPACE","\n                ",693],["T_VARIABLE","$errorMsg",694],["T_WHITESPACE"," ",694],["T_CONCAT_EQUAL",".=",694],["T_WHITESPACE"," ",694],["T_CONSTANT_ENCAPSED_STRING","'&message='",694],["T_WHITESPACE"," ",694],".",["T_WHITESPACE"," ",694],["T_VARIABLE","$eMsg",694],";",["T_WHITESPACE","\n            ",694],"}",["T_WHITESPACE","\n        ",695],"}",["T_WHITESPACE"," ",696],["T_ELSE","else",696],["T_WHITESPACE"," ",696],"{",["T_WHITESPACE","\n            ",696],["T_VARIABLE","$errorMsg",697],["T_WHITESPACE"," ",697],"=",["T_WHITESPACE"," ",697],["T_CONSTANT_ENCAPSED_STRING","'internal_error&message='",697],["T_WHITESPACE"," ",697],".",["T_WHITESPACE"," ",697],"(",["T_VARIABLE","$eMsg",697],["T_WHITESPACE"," ",697],"?",["T_WHITESPACE"," ",697],["T_VARIABLE","$eMsg",697],["T_WHITESPACE"," ",697],":",["T_WHITESPACE"," ",697],["T_CONSTANT_ENCAPSED_STRING","'empty_message'",697],")",";",["T_WHITESPACE","\n            ",697],["T_VARIABLE","$responseCode",698],["T_WHITESPACE"," ",698],"=",["T_WHITESPACE"," ",698],["T_STRING","self",698],["T_DOUBLE_COLON","::",698],["T_STRING","HTTP_INTERNAL_ERROR",698],";",["T_WHITESPACE","\n        ",698],"}",["T_WHITESPACE","\n        ",699],["T_IF","if",700],["T_WHITESPACE"," ",700],"(","!",["T_VARIABLE","$response",700],")",["T_WHITESPACE"," ",700],"{",["T_WHITESPACE","\n            ",700],["T_VARIABLE","$response",701],["T_WHITESPACE"," ",701],"=",["T_WHITESPACE"," ",701],["T_VARIABLE","$this",701],["T_OBJECT_OPERATOR","->",701],["T_STRING","_getResponse",701],"(",")",";",["T_WHITESPACE","\n        ",701],"}",["T_WHITESPACE","\n        ",702],["T_VARIABLE","$response",703],["T_OBJECT_OPERATOR","->",703],["T_STRING","setHttpResponseCode",703],"(",["T_VARIABLE","$responseCode",703],")",";",["T_WHITESPACE","\n\n        ",703],["T_RETURN","return",705],["T_WHITESPACE"," ",705],["T_CONSTANT_ENCAPSED_STRING","'oauth_problem='",705],["T_WHITESPACE"," ",705],".",["T_WHITESPACE"," ",705],["T_VARIABLE","$errorMsg",705],";",["T_WHITESPACE","\n    ",705],"}",["T_WHITESPACE","\n\n    ",706],["T_DOC_COMMENT","\/**\n     * Set response object\n     *\n     * @param Zend_Controller_Response_Http $response\n     * @return Mage_Oauth_Model_Server\n     *\/",708],["T_WHITESPACE","\n    ",713],["T_PUBLIC","public",714],["T_WHITESPACE"," ",714],["T_FUNCTION","function",714],["T_WHITESPACE"," ",714],["T_STRING","setResponse",714],"(",["T_STRING","Zend_Controller_Response_Http",714],["T_WHITESPACE"," ",714],["T_VARIABLE","$response",714],")",["T_WHITESPACE","\n    ",714],"{",["T_WHITESPACE","\n        ",715],["T_VARIABLE","$this",716],["T_OBJECT_OPERATOR","->",716],["T_STRING","_response",716],["T_WHITESPACE"," ",716],"=",["T_WHITESPACE"," ",716],["T_VARIABLE","$response",716],";",["T_WHITESPACE","\n\n        ",716],["T_VARIABLE","$this",718],["T_OBJECT_OPERATOR","->",718],["T_STRING","_response",718],["T_OBJECT_OPERATOR","->",718],["T_STRING","setHeader",718],"(",["T_STRING","Zend_Http_Client",718],["T_DOUBLE_COLON","::",718],["T_STRING","CONTENT_TYPE",718],",",["T_WHITESPACE"," ",718],["T_STRING","Zend_Http_Client",718],["T_DOUBLE_COLON","::",718],["T_STRING","ENC_URLENCODED",718],",",["T_WHITESPACE"," ",718],["T_STRING","true",718],")",";",["T_WHITESPACE","\n        ",718],["T_VARIABLE","$this",719],["T_OBJECT_OPERATOR","->",719],["T_STRING","_response",719],["T_OBJECT_OPERATOR","->",719],["T_STRING","setHttpResponseCode",719],"(",["T_STRING","self",719],["T_DOUBLE_COLON","::",719],["T_STRING","HTTP_OK",719],")",";",["T_WHITESPACE","\n\n        ",719],["T_RETURN","return",721],["T_WHITESPACE"," ",721],["T_VARIABLE","$this",721],";",["T_WHITESPACE","\n    ",721],"}",["T_WHITESPACE","\n",722],"}",["T_WHITESPACE","\n",723]]