[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Oauth\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * oAuth authorize controller\n *\n * @category    Mage\n * @package     Mage_Oauth\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Oauth_Adminhtml_Oauth_AuthorizeController",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Adminhtml_Controller_Action",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Session name\n     *\n     * @var string\n     *\/",36],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$_sessionName",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'admin\/session'",41],";",["T_WHITESPACE","\n\n    ",41],["T_DOC_COMMENT","\/**\n     * Array of actions which can be processed without secret key validation\n     *\n     * @var array\n     *\/",43],["T_WHITESPACE","\n    ",47],["T_PUBLIC","public",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$_publicActions",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_ARRAY","array",48],"(",["T_CONSTANT_ENCAPSED_STRING","'index'",48],",",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'simple'",48],",",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'confirm'",48],",",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'confirmSimple'",48],",",["T_CONSTANT_ENCAPSED_STRING","'reject'",48],",",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'rejectSimple'",48],")",";",["T_WHITESPACE","\n\n    ",48],["T_DOC_COMMENT","\/**\n     * Disable showing of login form\n     *\n     * @see Mage_Admin_Model_Observer::actionPreDispatchAdmin() method for explanation\n     * @return void\n     *\/",50],["T_WHITESPACE","\n    ",55],["T_PUBLIC","public",56],["T_WHITESPACE"," ",56],["T_FUNCTION","function",56],["T_WHITESPACE"," ",56],["T_STRING","preDispatch",56],"(",")",["T_WHITESPACE","\n    ",56],"{",["T_WHITESPACE","\n        ",57],["T_STRING","Mage",58],["T_DOUBLE_COLON","::",58],["T_STRING","app",58],"(",")",["T_OBJECT_OPERATOR","->",58],["T_STRING","getRequest",58],"(",")",["T_OBJECT_OPERATOR","->",58],["T_STRING","setInternallyForwarded",58],"(",")",";",["T_WHITESPACE","\n\n        ",58],["T_COMMENT","\/\/ check login data before it set null in Mage_Admin_Model_Observer::actionPreDispatchAdmin\n",60],["T_WHITESPACE","        ",61],["T_VARIABLE","$loginError",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","_checkLoginIsEmpty",61],"(",")",";",["T_WHITESPACE","\n\n        ",61],["T_STRING","parent",63],["T_DOUBLE_COLON","::",63],["T_STRING","preDispatch",63],"(",")",";",["T_WHITESPACE","\n\n        ",63],["T_COMMENT","\/\/ call after parent::preDispatch(); to get session started\n",65],["T_WHITESPACE","        ",66],["T_IF","if",66],["T_WHITESPACE"," ",66],"(",["T_VARIABLE","$loginError",66],")",["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n            ",66],["T_STRING","Mage",67],["T_DOUBLE_COLON","::",67],["T_STRING","getSingleton",67],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",67],")",["T_WHITESPACE","\n                ",67],["T_OBJECT_OPERATOR","->",68],["T_STRING","addError",68],"(",["T_STRING","Mage",68],["T_DOUBLE_COLON","::",68],["T_STRING","helper",68],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",68],")",["T_OBJECT_OPERATOR","->",68],["T_STRING","__",68],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid User Name or Password.'",68],")",")",";",["T_WHITESPACE","\n            ",68],["T_VARIABLE","$params",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_ARRAY","array",69],"(",["T_CONSTANT_ENCAPSED_STRING","'_query'",69],["T_WHITESPACE"," ",69],["T_DOUBLE_ARROW","=>",69],["T_WHITESPACE"," ",69],["T_ARRAY","array",69],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth_token'",69],["T_WHITESPACE"," ",69],["T_DOUBLE_ARROW","=>",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getRequest",69],"(",")",["T_OBJECT_OPERATOR","->",69],["T_STRING","getParam",69],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth_token'",69],",",["T_WHITESPACE"," ",69],["T_STRING","null",69],")",")",")",";",["T_WHITESPACE","\n            ",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","setFlag",70],"(",["T_CONSTANT_ENCAPSED_STRING","''",70],",",["T_WHITESPACE"," ",70],["T_STRING","self",70],["T_DOUBLE_COLON","::",70],["T_STRING","FLAG_NO_DISPATCH",70],",",["T_WHITESPACE"," ",70],["T_STRING","true",70],")",";",["T_WHITESPACE","\n            ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","setFlag",71],"(",["T_CONSTANT_ENCAPSED_STRING","''",71],",",["T_WHITESPACE"," ",71],["T_STRING","self",71],["T_DOUBLE_COLON","::",71],["T_STRING","FLAG_NO_POST_DISPATCH",71],",",["T_WHITESPACE"," ",71],["T_STRING","true",71],")",";",["T_WHITESPACE","\n            ",71],["T_VARIABLE","$params",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_ARRAY","array",72],"(",["T_CONSTANT_ENCAPSED_STRING","'_query'",72],["T_WHITESPACE"," ",72],["T_DOUBLE_ARROW","=>",72],["T_WHITESPACE"," ",72],["T_ARRAY","array",72],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth_token'",72],["T_WHITESPACE"," ",72],["T_DOUBLE_ARROW","=>",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","getRequest",72],"(",")",["T_OBJECT_OPERATOR","->",72],["T_STRING","getParam",72],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth_token'",72],",",["T_WHITESPACE"," ",72],["T_STRING","null",72],")",")",")",";",["T_WHITESPACE","\n            ",72],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","_redirect",73],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/*'",73],",",["T_WHITESPACE"," ",73],["T_VARIABLE","$params",73],")",";",["T_WHITESPACE","\n        ",73],"}",["T_WHITESPACE","\n    ",74],"}",["T_WHITESPACE","\n\n    ",75],["T_DOC_COMMENT","\/**\n     * Index action.\n     *\n     * @return void\n     *\/",77],["T_WHITESPACE","\n    ",81],["T_PUBLIC","public",82],["T_WHITESPACE"," ",82],["T_FUNCTION","function",82],["T_WHITESPACE"," ",82],["T_STRING","indexAction",82],"(",")",["T_WHITESPACE","\n    ",82],"{",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","_initForm",84],"(",")",";",["T_WHITESPACE","\n\n        ",84],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","_initLayoutMessages",86],"(",["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","_sessionName",86],")",";",["T_WHITESPACE","\n        ",86],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","renderLayout",87],"(",")",";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n\n    ",88],["T_DOC_COMMENT","\/**\n     * Index action with a simple design\n     *\n     * @return void\n     *\/",90],["T_WHITESPACE","\n    ",94],["T_PUBLIC","public",95],["T_WHITESPACE"," ",95],["T_FUNCTION","function",95],["T_WHITESPACE"," ",95],["T_STRING","simpleAction",95],"(",")",["T_WHITESPACE","\n    ",95],"{",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","_initForm",97],"(",["T_STRING","true",97],")",";",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","_initLayoutMessages",98],"(",["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","_sessionName",98],")",";",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","renderLayout",99],"(",")",";",["T_WHITESPACE","\n    ",99],"}",["T_WHITESPACE","\n\n    ",100],["T_DOC_COMMENT","\/**\n     * Init authorize page\n     *\n     * @param bool $simple\n     * @return Mage_Oauth_Adminhtml_Oauth_AuthorizeController\n     *\/",102],["T_WHITESPACE","\n    ",107],["T_PROTECTED","protected",108],["T_WHITESPACE"," ",108],["T_FUNCTION","function",108],["T_WHITESPACE"," ",108],["T_STRING","_initForm",108],"(",["T_VARIABLE","$simple",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_STRING","false",108],")",["T_WHITESPACE","\n    ",108],"{",["T_WHITESPACE","\n        ",109],["T_DOC_COMMENT","\/** @var $server Mage_Oauth_Model_Server *\/",110],["T_WHITESPACE","\n        ",110],["T_VARIABLE","$server",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_STRING","Mage",111],["T_DOUBLE_COLON","::",111],["T_STRING","getModel",111],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth\/server'",111],")",";",["T_WHITESPACE","\n        ",111],["T_DOC_COMMENT","\/** @var $session Mage_Admin_Model_Session *\/",112],["T_WHITESPACE","\n        ",112],["T_VARIABLE","$session",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_STRING","Mage",113],["T_DOUBLE_COLON","::",113],["T_STRING","getSingleton",113],"(",["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","_sessionName",113],")",";",["T_WHITESPACE","\n\n        ",113],["T_VARIABLE","$isException",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_STRING","false",115],";",["T_WHITESPACE","\n        ",115],["T_TRY","try",116],["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n            ",116],["T_VARIABLE","$server",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","checkAuthorizeRequest",117],"(",")",";",["T_WHITESPACE","\n        ",117],"}",["T_WHITESPACE"," ",118],["T_CATCH","catch",118],["T_WHITESPACE"," ",118],"(",["T_STRING","Mage_Core_Exception",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$e",118],")",["T_WHITESPACE"," ",118],"{",["T_WHITESPACE","\n            ",118],["T_VARIABLE","$session",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","addError",119],"(",["T_VARIABLE","$e",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getMessage",119],"(",")",")",";",["T_WHITESPACE","\n        ",119],"}",["T_WHITESPACE"," ",120],["T_CATCH","catch",120],["T_WHITESPACE"," ",120],"(",["T_STRING","Mage_Oauth_Exception",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$e",120],")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n            ",120],["T_VARIABLE","$isException",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_STRING","true",121],";",["T_WHITESPACE","\n            ",121],["T_VARIABLE","$session",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","addException",122],"(",["T_VARIABLE","$e",122],",",["T_WHITESPACE"," ",122],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","__",122],"(",["T_CONSTANT_ENCAPSED_STRING","'An error occurred. Your authorization request is invalid.'",122],")",")",";",["T_WHITESPACE","\n        ",122],"}",["T_WHITESPACE"," ",123],["T_CATCH","catch",123],["T_WHITESPACE"," ",123],"(",["T_STRING","Exception",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$e",123],")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n            ",123],["T_VARIABLE","$isException",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_STRING","true",124],";",["T_WHITESPACE","\n            ",124],["T_VARIABLE","$session",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","addException",125],"(",["T_VARIABLE","$e",125],",",["T_WHITESPACE"," ",125],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","__",125],"(",["T_CONSTANT_ENCAPSED_STRING","'An error occurred.'",125],")",")",";",["T_WHITESPACE","\n        ",125],"}",["T_WHITESPACE","\n\n        ",126],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","loadLayout",128],"(",")",";",["T_WHITESPACE","\n        ",128],["T_VARIABLE","$layout",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getLayout",129],"(",")",";",["T_WHITESPACE","\n        ",129],["T_VARIABLE","$logged",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$session",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","isLoggedIn",130],"(",")",";",["T_WHITESPACE","\n\n        ",130],["T_VARIABLE","$contentBlock",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_VARIABLE","$layout",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","getBlock",132],"(",["T_CONSTANT_ENCAPSED_STRING","'content'",132],")",";",["T_WHITESPACE","\n        ",132],["T_IF","if",133],["T_WHITESPACE"," ",133],"(",["T_VARIABLE","$logged",133],")",["T_WHITESPACE"," ",133],"{",["T_WHITESPACE","\n            ",133],["T_VARIABLE","$contentBlock",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","unsetChild",134],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth.authorize.form'",134],")",";",["T_WHITESPACE","\n            ",134],["T_DOC_COMMENT","\/** @var $block Mage_Oauth_Block_Adminhtml_Oauth_Authorize_Button *\/",135],["T_WHITESPACE","\n            ",135],["T_VARIABLE","$block",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_VARIABLE","$contentBlock",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getChild",136],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth.authorize.button'",136],")",";",["T_WHITESPACE","\n        ",136],"}",["T_WHITESPACE"," ",137],["T_ELSE","else",137],["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n            ",137],["T_VARIABLE","$contentBlock",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","unsetChild",138],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth.authorize.button'",138],")",";",["T_WHITESPACE","\n            ",138],["T_DOC_COMMENT","\/** @var $block Mage_Oauth_Block_Adminhtml_Oauth_Authorize *\/",139],["T_WHITESPACE","\n            ",139],["T_VARIABLE","$block",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_VARIABLE","$contentBlock",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","getChild",140],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth.authorize.form'",140],")",";",["T_WHITESPACE","\n        ",140],"}",["T_WHITESPACE","\n\n        ",141],["T_VARIABLE","$block",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","setIsSimple",143],"(",["T_VARIABLE","$simple",143],")",["T_WHITESPACE","\n            ",143],["T_OBJECT_OPERATOR","->",144],["T_STRING","setToken",144],"(",["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","getRequest",144],"(",")",["T_OBJECT_OPERATOR","->",144],["T_STRING","getQuery",144],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth_token'",144],")",")",["T_WHITESPACE","\n            ",144],["T_OBJECT_OPERATOR","->",145],["T_STRING","setHasException",145],"(",["T_VARIABLE","$isException",145],")",";",["T_WHITESPACE","\n        ",145],["T_RETURN","return",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$this",146],";",["T_WHITESPACE","\n    ",146],"}",["T_WHITESPACE","\n\n    ",147],["T_DOC_COMMENT","\/**\n     * Init confirm page\n     *\n     * @param bool $simple\n     * @return Mage_Oauth_Adminhtml_Oauth_AuthorizeController\n     *\/",149],["T_WHITESPACE","\n    ",154],["T_PROTECTED","protected",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","_initConfirmPage",155],"(",["T_VARIABLE","$simple",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_STRING","false",155],")",["T_WHITESPACE","\n    ",155],"{",["T_WHITESPACE","\n        ",156],["T_DOC_COMMENT","\/** @var $helper Mage_Oauth_Helper_Data *\/",157],["T_WHITESPACE","\n        ",157],["T_VARIABLE","$helper",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_STRING","Mage",158],["T_DOUBLE_COLON","::",158],["T_STRING","helper",158],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth'",158],")",";",["T_WHITESPACE","\n\n        ",158],["T_DOC_COMMENT","\/** @var $session Mage_Admin_Model_Session *\/",160],["T_WHITESPACE","\n        ",160],["T_VARIABLE","$session",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_STRING","Mage",161],["T_DOUBLE_COLON","::",161],["T_STRING","getSingleton",161],"(",["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","_sessionName",161],")",";",["T_WHITESPACE","\n\n        ",161],["T_DOC_COMMENT","\/** @var $user Mage_Admin_Model_User *\/",163],["T_WHITESPACE","\n        ",163],["T_VARIABLE","$user",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_VARIABLE","$session",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","getData",164],"(",["T_CONSTANT_ENCAPSED_STRING","'user'",164],")",";",["T_WHITESPACE","\n        ",164],["T_IF","if",165],["T_WHITESPACE"," ",165],"(","!",["T_VARIABLE","$user",165],")",["T_WHITESPACE"," ",165],"{",["T_WHITESPACE","\n            ",165],["T_VARIABLE","$session",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","addError",166],"(",["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","__",166],"(",["T_CONSTANT_ENCAPSED_STRING","'Please login to proceed authorization.'",166],")",")",";",["T_WHITESPACE","\n            ",166],["T_VARIABLE","$url",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_VARIABLE","$helper",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","getAuthorizeUrl",167],"(",["T_STRING","Mage_Oauth_Model_Token",167],["T_DOUBLE_COLON","::",167],["T_STRING","USER_TYPE_ADMIN",167],")",";",["T_WHITESPACE","\n            ",167],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","_redirectUrl",168],"(",["T_VARIABLE","$url",168],")",";",["T_WHITESPACE","\n            ",168],["T_RETURN","return",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$this",169],";",["T_WHITESPACE","\n        ",169],"}",["T_WHITESPACE","\n\n        ",170],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","loadLayout",172],"(",")",";",["T_WHITESPACE","\n\n        ",172],["T_DOC_COMMENT","\/** @var $block Mage_Oauth_Block_Adminhtml_Oauth_Authorize *\/",174],["T_WHITESPACE","\n        ",174],["T_VARIABLE","$block",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","getLayout",175],"(",")",["T_OBJECT_OPERATOR","->",175],["T_STRING","getBlock",175],"(",["T_CONSTANT_ENCAPSED_STRING","'content'",175],")",["T_OBJECT_OPERATOR","->",175],["T_STRING","getChild",175],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth.authorize.confirm'",175],")",";",["T_WHITESPACE","\n        ",175],["T_VARIABLE","$block",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","setIsSimple",176],"(",["T_VARIABLE","$simple",176],")",";",["T_WHITESPACE","\n\n        ",176],["T_TRY","try",178],["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n            ",178],["T_DOC_COMMENT","\/** @var $server Mage_Oauth_Model_Server *\/",179],["T_WHITESPACE","\n            ",179],["T_VARIABLE","$server",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_STRING","Mage",180],["T_DOUBLE_COLON","::",180],["T_STRING","getModel",180],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth\/server'",180],")",";",["T_WHITESPACE","\n\n            ",180],["T_VARIABLE","$token",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_VARIABLE","$server",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","authorizeToken",182],"(",["T_VARIABLE","$user",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","getId",182],"(",")",",",["T_WHITESPACE"," ",182],["T_STRING","Mage_Oauth_Model_Token",182],["T_DOUBLE_COLON","::",182],["T_STRING","USER_TYPE_ADMIN",182],")",";",["T_WHITESPACE","\n\n            ",182],["T_IF","if",184],["T_WHITESPACE"," ",184],"(","(",["T_VARIABLE","$callback",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_VARIABLE","$helper",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getFullCallbackUrl",184],"(",["T_VARIABLE","$token",184],")",")",")",["T_WHITESPACE"," ",184],"{",["T_WHITESPACE"," ",184],["T_COMMENT","\/\/false in case of OOB\n",184],["T_WHITESPACE","                ",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","getResponse",185],"(",")",["T_OBJECT_OPERATOR","->",185],["T_STRING","setRedirect",185],"(",["T_VARIABLE","$callback",185],["T_WHITESPACE"," ",185],".",["T_WHITESPACE"," ",185],"(",["T_VARIABLE","$simple",185],["T_WHITESPACE"," ",185],"?",["T_WHITESPACE"," ",185],["T_CONSTANT_ENCAPSED_STRING","'&simple=1'",185],["T_WHITESPACE"," ",185],":",["T_WHITESPACE"," ",185],["T_CONSTANT_ENCAPSED_STRING","''",185],")",")",";",["T_WHITESPACE","\n                ",185],["T_RETURN","return",186],["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],";",["T_WHITESPACE","\n            ",186],"}",["T_WHITESPACE"," ",187],["T_ELSE","else",187],["T_WHITESPACE"," ",187],"{",["T_WHITESPACE","\n                ",187],["T_VARIABLE","$block",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","setVerifier",188],"(",["T_VARIABLE","$token",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getVerifier",188],"(",")",")",";",["T_WHITESPACE","\n                ",188],["T_VARIABLE","$session",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","addSuccess",189],"(",["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","__",189],"(",["T_CONSTANT_ENCAPSED_STRING","'Authorization confirmed.'",189],")",")",";",["T_WHITESPACE","\n            ",189],"}",["T_WHITESPACE","\n        ",190],"}",["T_WHITESPACE"," ",191],["T_CATCH","catch",191],["T_WHITESPACE"," ",191],"(",["T_STRING","Mage_Core_Exception",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$e",191],")",["T_WHITESPACE"," ",191],"{",["T_WHITESPACE","\n            ",191],["T_VARIABLE","$block",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","setHasException",192],"(",["T_STRING","true",192],")",";",["T_WHITESPACE","\n            ",192],["T_VARIABLE","$session",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","addError",193],"(",["T_VARIABLE","$e",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","getMessage",193],"(",")",")",";",["T_WHITESPACE","\n        ",193],"}",["T_WHITESPACE"," ",194],["T_CATCH","catch",194],["T_WHITESPACE"," ",194],"(",["T_STRING","Exception",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$e",194],")",["T_WHITESPACE"," ",194],"{",["T_WHITESPACE","\n            ",194],["T_VARIABLE","$block",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","setHasException",195],"(",["T_STRING","true",195],")",";",["T_WHITESPACE","\n            ",195],["T_VARIABLE","$session",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","addException",196],"(",["T_VARIABLE","$e",196],",",["T_WHITESPACE"," ",196],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","__",196],"(",["T_CONSTANT_ENCAPSED_STRING","'An error occurred on confirm authorize.'",196],")",")",";",["T_WHITESPACE","\n        ",196],"}",["T_WHITESPACE","\n\n        ",197],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","_initLayoutMessages",199],"(",["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","_sessionName",199],")",";",["T_WHITESPACE","\n        ",199],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","renderLayout",200],"(",")",";",["T_WHITESPACE","\n\n        ",200],["T_RETURN","return",202],["T_WHITESPACE"," ",202],["T_VARIABLE","$this",202],";",["T_WHITESPACE","\n    ",202],"}",["T_WHITESPACE","\n\n    ",203],["T_DOC_COMMENT","\/**\n     * Init reject page\n     *\n     * @param bool $simple\n     * @return Mage_Oauth_AuthorizeController\n     *\/",205],["T_WHITESPACE","\n    ",210],["T_PROTECTED","protected",211],["T_WHITESPACE"," ",211],["T_FUNCTION","function",211],["T_WHITESPACE"," ",211],["T_STRING","_initRejectPage",211],"(",["T_VARIABLE","$simple",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_STRING","false",211],")",["T_WHITESPACE","\n    ",211],"{",["T_WHITESPACE","\n        ",212],["T_DOC_COMMENT","\/** @var $server Mage_Oauth_Model_Server *\/",213],["T_WHITESPACE","\n        ",213],["T_VARIABLE","$server",214],["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_STRING","Mage",214],["T_DOUBLE_COLON","::",214],["T_STRING","getModel",214],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth\/server'",214],")",";",["T_WHITESPACE","\n\n        ",214],["T_DOC_COMMENT","\/** @var $session Mage_Admin_Model_Session *\/",216],["T_WHITESPACE","\n        ",216],["T_VARIABLE","$session",217],["T_WHITESPACE"," ",217],"=",["T_WHITESPACE"," ",217],["T_STRING","Mage",217],["T_DOUBLE_COLON","::",217],["T_STRING","getSingleton",217],"(",["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","_sessionName",217],")",";",["T_WHITESPACE","\n\n        ",217],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","loadLayout",219],"(",")",";",["T_WHITESPACE","\n\n        ",219],["T_DOC_COMMENT","\/** @var $block Mage_Oauth_Block_Authorize *\/",221],["T_WHITESPACE","\n        ",221],["T_VARIABLE","$block",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","getLayout",222],"(",")",["T_OBJECT_OPERATOR","->",222],["T_STRING","getBlock",222],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth.authorize.reject'",222],")",";",["T_WHITESPACE","\n        ",222],["T_VARIABLE","$block",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","setIsSimple",223],"(",["T_VARIABLE","$simple",223],")",";",["T_WHITESPACE","\n\n        ",223],["T_TRY","try",225],["T_WHITESPACE"," ",225],"{",["T_WHITESPACE","\n            ",225],["T_VARIABLE","$token",226],["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_VARIABLE","$server",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","checkAuthorizeRequest",226],"(",")",";",["T_WHITESPACE","\n            ",226],["T_DOC_COMMENT","\/** @var $helper Mage_Oauth_Helper_Data *\/",227],["T_WHITESPACE","\n            ",227],["T_VARIABLE","$helper",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],["T_STRING","Mage",228],["T_DOUBLE_COLON","::",228],["T_STRING","helper",228],"(",["T_CONSTANT_ENCAPSED_STRING","'oauth'",228],")",";",["T_WHITESPACE","\n\n            ",228],["T_IF","if",230],["T_WHITESPACE"," ",230],"(","(",["T_VARIABLE","$callback",230],["T_WHITESPACE"," ",230],"=",["T_WHITESPACE"," ",230],["T_VARIABLE","$helper",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","getFullCallbackUrl",230],"(",["T_VARIABLE","$token",230],",",["T_WHITESPACE"," ",230],["T_STRING","true",230],")",")",")",["T_WHITESPACE"," ",230],"{",["T_WHITESPACE","\n                ",230],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","_redirectUrl",231],"(",["T_VARIABLE","$callback",231],["T_WHITESPACE"," ",231],".",["T_WHITESPACE"," ",231],"(",["T_VARIABLE","$simple",231],["T_WHITESPACE"," ",231],"?",["T_WHITESPACE"," ",231],["T_CONSTANT_ENCAPSED_STRING","'&simple=1'",231],["T_WHITESPACE"," ",231],":",["T_WHITESPACE"," ",231],["T_CONSTANT_ENCAPSED_STRING","''",231],")",")",";",["T_WHITESPACE","\n                ",231],["T_RETURN","return",232],["T_WHITESPACE"," ",232],["T_VARIABLE","$this",232],";",["T_WHITESPACE","\n            ",232],"}",["T_WHITESPACE"," ",233],["T_ELSE","else",233],["T_WHITESPACE"," ",233],"{",["T_WHITESPACE","\n                ",233],["T_VARIABLE","$session",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","addNotice",234],"(",["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","__",234],"(",["T_CONSTANT_ENCAPSED_STRING","'The application access request is rejected.'",234],")",")",";",["T_WHITESPACE","\n            ",234],"}",["T_WHITESPACE","\n        ",235],"}",["T_WHITESPACE"," ",236],["T_CATCH","catch",236],["T_WHITESPACE"," ",236],"(",["T_STRING","Mage_Core_Exception",236],["T_WHITESPACE"," ",236],["T_VARIABLE","$e",236],")",["T_WHITESPACE"," ",236],"{",["T_WHITESPACE","\n            ",236],["T_VARIABLE","$session",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","addError",237],"(",["T_VARIABLE","$e",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","getMessage",237],"(",")",")",";",["T_WHITESPACE","\n        ",237],"}",["T_WHITESPACE"," ",238],["T_CATCH","catch",238],["T_WHITESPACE"," ",238],"(",["T_STRING","Exception",238],["T_WHITESPACE"," ",238],["T_VARIABLE","$e",238],")",["T_WHITESPACE"," ",238],"{",["T_WHITESPACE","\n            ",238],["T_VARIABLE","$session",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","addException",239],"(",["T_VARIABLE","$e",239],",",["T_WHITESPACE"," ",239],["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","__",239],"(",["T_CONSTANT_ENCAPSED_STRING","'An error occurred on reject authorize.'",239],")",")",";",["T_WHITESPACE","\n        ",239],"}",["T_WHITESPACE","\n\n        ",240],["T_COMMENT","\/\/display exception\n",242],["T_WHITESPACE","        ",243],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","_initLayoutMessages",243],"(",["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","_sessionName",243],")",";",["T_WHITESPACE","\n        ",243],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","renderLayout",244],"(",")",";",["T_WHITESPACE","\n\n        ",244],["T_RETURN","return",246],["T_WHITESPACE"," ",246],["T_VARIABLE","$this",246],";",["T_WHITESPACE","\n    ",246],"}",["T_WHITESPACE","\n\n    ",247],["T_DOC_COMMENT","\/**\n     * Check is login data has empty login or pass\n     * See Mage_Admin_Model_Session: there is no any error message if login or password is empty\n     *\n     * @return boolean\n     *\/",249],["T_WHITESPACE","\n    ",254],["T_PROTECTED","protected",255],["T_WHITESPACE"," ",255],["T_FUNCTION","function",255],["T_WHITESPACE"," ",255],["T_STRING","_checkLoginIsEmpty",255],"(",")",["T_WHITESPACE","\n    ",255],"{",["T_WHITESPACE","\n        ",256],["T_VARIABLE","$error",257],["T_WHITESPACE"," ",257],"=",["T_WHITESPACE"," ",257],["T_STRING","false",257],";",["T_WHITESPACE","\n        ",257],["T_VARIABLE","$action",258],["T_WHITESPACE"," ",258],"=",["T_WHITESPACE"," ",258],["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","getRequest",258],"(",")",["T_OBJECT_OPERATOR","->",258],["T_STRING","getActionName",258],"(",")",";",["T_WHITESPACE","\n        ",258],["T_IF","if",259],["T_WHITESPACE"," ",259],"(","(",["T_VARIABLE","$action",259],["T_WHITESPACE"," ",259],["T_IS_EQUAL","==",259],["T_WHITESPACE"," ",259],["T_CONSTANT_ENCAPSED_STRING","'index'",259],["T_WHITESPACE"," ",259],["T_BOOLEAN_OR","||",259],["T_WHITESPACE"," ",259],["T_VARIABLE","$action",259],["T_WHITESPACE"," ",259],["T_IS_EQUAL","==",259],["T_WHITESPACE"," ",259],["T_CONSTANT_ENCAPSED_STRING","'simple'",259],")",["T_WHITESPACE"," ",259],["T_BOOLEAN_AND","&&",259],["T_WHITESPACE"," ",259],["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","getRequest",259],"(",")",["T_OBJECT_OPERATOR","->",259],["T_STRING","getPost",259],"(",["T_CONSTANT_ENCAPSED_STRING","'login'",259],")",")",["T_WHITESPACE"," ",259],"{",["T_WHITESPACE","\n            ",259],["T_VARIABLE","$postLogin",260],["T_WHITESPACE","  ",260],"=",["T_WHITESPACE"," ",260],["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","getRequest",260],"(",")",["T_OBJECT_OPERATOR","->",260],["T_STRING","getPost",260],"(",["T_CONSTANT_ENCAPSED_STRING","'login'",260],")",";",["T_WHITESPACE","\n            ",260],["T_VARIABLE","$username",261],["T_WHITESPACE","   ",261],"=",["T_WHITESPACE"," ",261],["T_ISSET","isset",261],"(",["T_VARIABLE","$postLogin",261],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",261],"]",")",["T_WHITESPACE"," ",261],"?",["T_WHITESPACE"," ",261],["T_VARIABLE","$postLogin",261],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",261],"]",["T_WHITESPACE"," ",261],":",["T_WHITESPACE"," ",261],["T_CONSTANT_ENCAPSED_STRING","''",261],";",["T_WHITESPACE","\n            ",261],["T_VARIABLE","$password",262],["T_WHITESPACE","   ",262],"=",["T_WHITESPACE"," ",262],["T_ISSET","isset",262],"(",["T_VARIABLE","$postLogin",262],"[",["T_CONSTANT_ENCAPSED_STRING","'password'",262],"]",")",["T_WHITESPACE"," ",262],"?",["T_WHITESPACE"," ",262],["T_VARIABLE","$postLogin",262],"[",["T_CONSTANT_ENCAPSED_STRING","'password'",262],"]",["T_WHITESPACE"," ",262],":",["T_WHITESPACE"," ",262],["T_CONSTANT_ENCAPSED_STRING","''",262],";",["T_WHITESPACE","\n            ",262],["T_IF","if",263],["T_WHITESPACE"," ",263],"(",["T_EMPTY","empty",263],"(",["T_VARIABLE","$username",263],")",["T_WHITESPACE"," ",263],["T_BOOLEAN_OR","||",263],["T_WHITESPACE"," ",263],["T_EMPTY","empty",263],"(",["T_VARIABLE","$password",263],")",")",["T_WHITESPACE"," ",263],"{",["T_WHITESPACE","\n                ",263],["T_VARIABLE","$error",264],["T_WHITESPACE"," ",264],"=",["T_WHITESPACE"," ",264],["T_STRING","true",264],";",["T_WHITESPACE","\n            ",264],"}",["T_WHITESPACE","\n        ",265],"}",["T_WHITESPACE","\n        ",266],["T_RETURN","return",267],["T_WHITESPACE"," ",267],["T_VARIABLE","$error",267],";",["T_WHITESPACE","\n    ",267],"}",["T_WHITESPACE","\n\n    ",268],["T_DOC_COMMENT","\/**\n     * Confirm token authorization action\n     *\/",270],["T_WHITESPACE","\n    ",272],["T_PUBLIC","public",273],["T_WHITESPACE"," ",273],["T_FUNCTION","function",273],["T_WHITESPACE"," ",273],["T_STRING","confirmAction",273],"(",")",["T_WHITESPACE","\n    ",273],"{",["T_WHITESPACE","\n        ",274],["T_VARIABLE","$this",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","_initConfirmPage",275],"(",")",";",["T_WHITESPACE","\n    ",275],"}",["T_WHITESPACE","\n\n    ",276],["T_DOC_COMMENT","\/**\n     * Confirm token authorization simple page\n     *\/",278],["T_WHITESPACE","\n    ",280],["T_PUBLIC","public",281],["T_WHITESPACE"," ",281],["T_FUNCTION","function",281],["T_WHITESPACE"," ",281],["T_STRING","confirmSimpleAction",281],"(",")",["T_WHITESPACE","\n    ",281],"{",["T_WHITESPACE","\n        ",282],["T_VARIABLE","$this",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","_initConfirmPage",283],"(",")",";",["T_WHITESPACE","\n    ",283],"}",["T_WHITESPACE","\n\n    ",284],["T_DOC_COMMENT","\/**\n     * Reject token authorization action\n     *\/",286],["T_WHITESPACE","\n    ",288],["T_PUBLIC","public",289],["T_WHITESPACE"," ",289],["T_FUNCTION","function",289],["T_WHITESPACE"," ",289],["T_STRING","rejectAction",289],"(",")",["T_WHITESPACE","\n    ",289],"{",["T_WHITESPACE","\n        ",290],["T_VARIABLE","$this",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","_initRejectPage",291],"(",")",";",["T_WHITESPACE","\n    ",291],"}",["T_WHITESPACE","\n\n    ",292],["T_DOC_COMMENT","\/**\n     * Reject token authorization simple page\n     *\/",294],["T_WHITESPACE","\n    ",296],["T_PUBLIC","public",297],["T_WHITESPACE"," ",297],["T_FUNCTION","function",297],["T_WHITESPACE"," ",297],["T_STRING","rejectSimpleAction",297],"(",")",["T_WHITESPACE","\n    ",297],"{",["T_WHITESPACE","\n        ",298],["T_VARIABLE","$this",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","_initRejectPage",299],"(",")",";",["T_WHITESPACE","\n    ",299],"}",["T_WHITESPACE","\n\n    ",300],["T_DOC_COMMENT","\/**\n     * Check admin permissions for this controller\n     *\n     * @return boolean\n     *\/",302],["T_WHITESPACE","\n    ",306],["T_PROTECTED","protected",307],["T_WHITESPACE"," ",307],["T_FUNCTION","function",307],["T_WHITESPACE"," ",307],["T_STRING","_isAllowed",307],"(",")",["T_WHITESPACE","\n    ",307],"{",["T_WHITESPACE","\n        ",308],["T_RETURN","return",309],["T_WHITESPACE"," ",309],["T_STRING","true",309],";",["T_WHITESPACE","\n    ",309],"}",["T_WHITESPACE","\n",310],"}",["T_WHITESPACE","\n",311]]