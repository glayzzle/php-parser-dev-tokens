[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Sales\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Sales order view block\n *\n * @method int|null getCustomerId()\n *\n * @category   Mage\n * @package    Mage_Sales\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",35],["T_CLASS","class",36],["T_WHITESPACE"," ",36],["T_STRING","Mage_Sales_Block_Reorder_Sidebar",36],["T_WHITESPACE"," ",36],["T_EXTENDS","extends",36],["T_WHITESPACE"," ",36],["T_STRING","Mage_Core_Block_Template",36],["T_WHITESPACE","\n",36],"{",["T_WHITESPACE","\n    ",37],["T_DOC_COMMENT","\/**\n     * Init orders and templates\n     *\/",38],["T_WHITESPACE","\n    ",40],["T_PUBLIC","public",41],["T_WHITESPACE"," ",41],["T_FUNCTION","function",41],["T_WHITESPACE"," ",41],["T_STRING","__construct",41],"(",")",["T_WHITESPACE","\n    ",41],"{",["T_WHITESPACE","\n        ",42],["T_STRING","parent",43],["T_DOUBLE_COLON","::",43],["T_STRING","__construct",43],"(",")",";",["T_WHITESPACE","\n\n        ",43],["T_IF","if",45],["T_WHITESPACE"," ",45],"(",["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","_getCustomerSession",45],"(",")",["T_OBJECT_OPERATOR","->",45],["T_STRING","isLoggedIn",45],"(",")",")",["T_WHITESPACE"," ",45],"{",["T_WHITESPACE","\n            ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","setTemplate",46],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order\/history.phtml'",46],")",";",["T_WHITESPACE","\n            ",46],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","initOrders",47],"(",")",";",["T_WHITESPACE","\n        ",47],"}",["T_WHITESPACE","\n    ",48],"}",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Init customer order for display on front\n     *\/",51],["T_WHITESPACE","\n    ",53],["T_PUBLIC","public",54],["T_WHITESPACE"," ",54],["T_FUNCTION","function",54],["T_WHITESPACE"," ",54],["T_STRING","initOrders",54],"(",")",["T_WHITESPACE","\n    ",54],"{",["T_WHITESPACE","\n        ",55],["T_VARIABLE","$customerId",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","getCustomerId",56],"(",")",["T_WHITESPACE"," ",56],"?",["T_WHITESPACE"," ",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","getCustomerId",56],"(",")",["T_WHITESPACE","\n            ",56],":",["T_WHITESPACE"," ",57],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","_getCustomerSession",57],"(",")",["T_OBJECT_OPERATOR","->",57],["T_STRING","getCustomer",57],"(",")",["T_OBJECT_OPERATOR","->",57],["T_STRING","getId",57],"(",")",";",["T_WHITESPACE","\n\n        ",57],["T_VARIABLE","$orders",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_STRING","Mage",59],["T_DOUBLE_COLON","::",59],["T_STRING","getResourceModel",59],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order_collection'",59],")",["T_WHITESPACE","\n            ",59],["T_OBJECT_OPERATOR","->",60],["T_STRING","addAttributeToFilter",60],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$customerId",60],")",["T_WHITESPACE","\n            ",60],["T_OBJECT_OPERATOR","->",61],["T_STRING","addAttributeToFilter",61],"(",["T_CONSTANT_ENCAPSED_STRING","'state'",61],",",["T_WHITESPACE","\n                ",61],["T_ARRAY","array",62],"(",["T_CONSTANT_ENCAPSED_STRING","'in'",62],["T_WHITESPACE"," ",62],["T_DOUBLE_ARROW","=>",62],["T_WHITESPACE"," ",62],["T_STRING","Mage",62],["T_DOUBLE_COLON","::",62],["T_STRING","getSingleton",62],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order_config'",62],")",["T_OBJECT_OPERATOR","->",62],["T_STRING","getVisibleOnFrontStates",62],"(",")",")",["T_WHITESPACE","\n            ",62],")",["T_WHITESPACE","\n            ",63],["T_OBJECT_OPERATOR","->",64],["T_STRING","addAttributeToSort",64],"(",["T_CONSTANT_ENCAPSED_STRING","'created_at'",64],",",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'desc'",64],")",["T_WHITESPACE","\n            ",64],["T_OBJECT_OPERATOR","->",65],["T_STRING","setPage",65],"(",["T_LNUMBER","1",65],",",["T_LNUMBER","1",65],")",";",["T_WHITESPACE","\n        ",65],["T_COMMENT","\/\/TODO: add filter by current website\n",66],["T_WHITESPACE","\n        ",67],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","setOrders",68],"(",["T_VARIABLE","$orders",68],")",";",["T_WHITESPACE","\n    ",68],"}",["T_WHITESPACE","\n\n    ",69],["T_DOC_COMMENT","\/**\n     * Get list of last ordered products\n     *\n     * @return array\n     *\/",71],["T_WHITESPACE","\n    ",75],["T_PUBLIC","public",76],["T_WHITESPACE"," ",76],["T_FUNCTION","function",76],["T_WHITESPACE"," ",76],["T_STRING","getItems",76],"(",")",["T_WHITESPACE","\n    ",76],"{",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$items",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_ARRAY","array",78],"(",")",";",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$order",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","getLastOrder",79],"(",")",";",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$limit",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_LNUMBER","5",80],";",["T_WHITESPACE","\n\n        ",80],["T_IF","if",82],["T_WHITESPACE"," ",82],"(",["T_VARIABLE","$order",82],")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n            ",82],["T_VARIABLE","$website",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_STRING","Mage",83],["T_DOUBLE_COLON","::",83],["T_STRING","app",83],"(",")",["T_OBJECT_OPERATOR","->",83],["T_STRING","getStore",83],"(",")",["T_OBJECT_OPERATOR","->",83],["T_STRING","getWebsiteId",83],"(",")",";",["T_WHITESPACE","\n            ",83],["T_FOREACH","foreach",84],["T_WHITESPACE"," ",84],"(",["T_VARIABLE","$order",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getParentItemsRandomCollection",84],"(",["T_VARIABLE","$limit",84],")",["T_WHITESPACE"," ",84],["T_AS","as",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$item",84],")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n                ",84],["T_IF","if",85],["T_WHITESPACE"," ",85],"(",["T_VARIABLE","$item",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","getProduct",85],"(",")",["T_WHITESPACE"," ",85],["T_BOOLEAN_AND","&&",85],["T_WHITESPACE"," ",85],["T_STRING","in_array",85],"(",["T_VARIABLE","$website",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$item",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","getProduct",85],"(",")",["T_OBJECT_OPERATOR","->",85],["T_STRING","getWebsiteIds",85],"(",")",")",")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n                    ",85],["T_VARIABLE","$items",86],"[","]",["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$item",86],";",["T_WHITESPACE","\n                ",86],"}",["T_WHITESPACE","\n            ",87],"}",["T_WHITESPACE","\n        ",88],"}",["T_WHITESPACE","\n\n        ",89],["T_RETURN","return",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$items",91],";",["T_WHITESPACE","\n    ",91],"}",["T_WHITESPACE","\n\n    ",92],["T_DOC_COMMENT","\/**\n     * Check item product availability for reorder\n     *\n     * @param  Mage_Sales_Model_Order_Item $orderItem\n     * @return boolean\n     *\/",94],["T_WHITESPACE","\n    ",99],["T_PUBLIC","public",100],["T_WHITESPACE"," ",100],["T_FUNCTION","function",100],["T_WHITESPACE"," ",100],["T_STRING","isItemAvailableForReorder",100],"(",["T_STRING","Mage_Sales_Model_Order_Item",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$orderItem",100],")",["T_WHITESPACE","\n    ",100],"{",["T_WHITESPACE","\n        ",101],["T_IF","if",102],["T_WHITESPACE"," ",102],"(",["T_VARIABLE","$orderItem",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getProduct",102],"(",")",")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n            ",102],["T_RETURN","return",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$orderItem",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getProduct",103],"(",")",["T_OBJECT_OPERATOR","->",103],["T_STRING","getStockItem",103],"(",")",["T_OBJECT_OPERATOR","->",103],["T_STRING","getIsInStock",103],"(",")",";",["T_WHITESPACE","\n        ",103],"}",["T_WHITESPACE","\n        ",104],["T_RETURN","return",105],["T_WHITESPACE"," ",105],["T_STRING","false",105],";",["T_WHITESPACE","\n    ",105],"}",["T_WHITESPACE","\n\n    ",106],["T_DOC_COMMENT","\/**\n     * Retrieve form action url and set \"secure\" param to avoid confirm\n     * message when we submit form from secure page to unsecure\n     *\n     * @return string\n     *\/",108],["T_WHITESPACE","\n    ",113],["T_PUBLIC","public",114],["T_WHITESPACE"," ",114],["T_FUNCTION","function",114],["T_WHITESPACE"," ",114],["T_STRING","getFormActionUrl",114],"(",")",["T_WHITESPACE","\n    ",114],"{",["T_WHITESPACE","\n        ",115],["T_RETURN","return",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getUrl",116],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout\/cart\/addgroup'",116],",",["T_WHITESPACE"," ",116],["T_ARRAY","array",116],"(",["T_CONSTANT_ENCAPSED_STRING","'_secure'",116],["T_WHITESPACE"," ",116],["T_DOUBLE_ARROW","=>",116],["T_WHITESPACE"," ",116],["T_STRING","true",116],")",")",";",["T_WHITESPACE","\n    ",116],"}",["T_WHITESPACE","\n\n    ",117],["T_DOC_COMMENT","\/**\n     * Last order getter\n     *\n     * @return Mage_Sales_Model_Order|bool\n     *\/",119],["T_WHITESPACE","\n    ",123],["T_PUBLIC","public",124],["T_WHITESPACE"," ",124],["T_FUNCTION","function",124],["T_WHITESPACE"," ",124],["T_STRING","getLastOrder",124],"(",")",["T_WHITESPACE","\n    ",124],"{",["T_WHITESPACE","\n        ",125],["T_IF","if",126],["T_WHITESPACE"," ",126],"(","!",["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getOrders",126],"(",")",")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n            ",126],["T_RETURN","return",127],["T_WHITESPACE"," ",127],["T_STRING","false",127],";",["T_WHITESPACE","\n        ",127],"}",["T_WHITESPACE","\n\n        ",128],["T_FOREACH","foreach",130],["T_WHITESPACE"," ",130],"(",["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getOrders",130],"(",")",["T_WHITESPACE"," ",130],["T_AS","as",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$order",130],")",["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n            ",130],["T_RETURN","return",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$order",131],";",["T_WHITESPACE","\n        ",131],"}",["T_WHITESPACE","\n        ",132],["T_RETURN","return",133],["T_WHITESPACE"," ",133],["T_STRING","false",133],";",["T_WHITESPACE","\n    ",133],"}",["T_WHITESPACE","\n\n    ",134],["T_DOC_COMMENT","\/**\n     * Render \"My Orders\" sidebar block\n     *\n     * @return string\n     *\/",136],["T_WHITESPACE","\n    ",140],["T_PROTECTED","protected",141],["T_WHITESPACE"," ",141],["T_FUNCTION","function",141],["T_WHITESPACE"," ",141],["T_STRING","_toHtml",141],"(",")",["T_WHITESPACE","\n    ",141],"{",["T_WHITESPACE","\n        ",142],["T_RETURN","return",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","_getCustomerSession",143],"(",")",["T_OBJECT_OPERATOR","->",143],["T_STRING","isLoggedIn",143],"(",")",["T_WHITESPACE"," ",143],["T_BOOLEAN_OR","||",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getCustomerId",143],"(",")",["T_WHITESPACE"," ",143],"?",["T_WHITESPACE"," ",143],["T_STRING","parent",143],["T_DOUBLE_COLON","::",143],["T_STRING","_toHtml",143],"(",")",["T_WHITESPACE"," ",143],":",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","''",143],";",["T_WHITESPACE","\n    ",143],"}",["T_WHITESPACE","\n\n    ",144],["T_DOC_COMMENT","\/**\n     * Retrieve customer session instance\n     *\n     * @return Mage_Customer_Model_Session\n     *\/",146],["T_WHITESPACE","\n    ",150],["T_PROTECTED","protected",151],["T_WHITESPACE"," ",151],["T_FUNCTION","function",151],["T_WHITESPACE"," ",151],["T_STRING","_getCustomerSession",151],"(",")",["T_WHITESPACE","\n    ",151],"{",["T_WHITESPACE","\n        ",152],["T_RETURN","return",153],["T_WHITESPACE"," ",153],["T_STRING","Mage",153],["T_DOUBLE_COLON","::",153],["T_STRING","getSingleton",153],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",153],")",";",["T_WHITESPACE","\n    ",153],"}",["T_WHITESPACE","\n\n    ",154],["T_DOC_COMMENT","\/**\n     * Retrieve block cache tags\n     *\n     * @return array\n     *\/",156],["T_WHITESPACE","\n    ",160],["T_PUBLIC","public",161],["T_WHITESPACE"," ",161],["T_FUNCTION","function",161],["T_WHITESPACE"," ",161],["T_STRING","getCacheTags",161],"(",")",["T_WHITESPACE","\n    ",161],"{",["T_WHITESPACE","\n        ",162],["T_RETURN","return",163],["T_WHITESPACE"," ",163],["T_STRING","array_merge",163],"(",["T_WHITESPACE","\n            ",163],["T_STRING","parent",164],["T_DOUBLE_COLON","::",164],["T_STRING","getCacheTags",164],"(",")",",",["T_WHITESPACE","\n            ",164],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","getItemsTags",165],"(",["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","_getItemProducts",165],"(",")",")",["T_WHITESPACE","\n        ",165],")",";",["T_WHITESPACE","\n    ",166],"}",["T_WHITESPACE","\n\n    ",167],["T_DOC_COMMENT","\/**\n     * Retrieve products list from items\n     *\n     * @return array\n     *\/",169],["T_WHITESPACE","\n    ",173],["T_PROTECTED","protected",174],["T_WHITESPACE"," ",174],["T_FUNCTION","function",174],["T_WHITESPACE"," ",174],["T_STRING","_getItemProducts",174],"(",")",["T_WHITESPACE","\n    ",174],"{",["T_WHITESPACE","\n        ",175],["T_VARIABLE","$products",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE","  ",176],["T_ARRAY","array",176],"(",")",";",["T_WHITESPACE","\n        ",176],["T_FOREACH","foreach",177],["T_WHITESPACE"," ",177],"(",["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","getItems",177],"(",")",["T_WHITESPACE"," ",177],["T_AS","as",177],["T_WHITESPACE"," ",177],["T_VARIABLE","$item",177],")",["T_WHITESPACE"," ",177],"{",["T_WHITESPACE","\n            ",177],["T_VARIABLE","$products",178],"[","]",["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_VARIABLE","$item",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","getProduct",178],"(",")",";",["T_WHITESPACE","\n        ",178],"}",["T_WHITESPACE","\n        ",179],["T_RETURN","return",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$products",180],";",["T_WHITESPACE","\n    ",180],"}",["T_WHITESPACE","\n",181],"}",["T_WHITESPACE","\n",182]]