[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Sales\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_CLASS","class",28],["T_WHITESPACE"," ",28],["T_STRING","Mage_Sales_Model_Quote_Address_Total_Tax",28],["T_WHITESPACE"," ",28],["T_EXTENDS","extends",28],["T_WHITESPACE"," ",28],["T_STRING","Mage_Sales_Model_Quote_Address_Total_Abstract",28],["T_WHITESPACE","\n",28],"{",["T_WHITESPACE","\n    ",29],["T_PROTECTED","protected",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$_appliedTaxes",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_ARRAY","array",30],"(",")",";",["T_WHITESPACE","\n\n    ",30],["T_PUBLIC","public",32],["T_WHITESPACE"," ",32],["T_FUNCTION","function",32],["T_WHITESPACE"," ",32],["T_STRING","__construct",32],"(",")","{",["T_WHITESPACE","\n        ",32],["T_VARIABLE","$this",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","setCode",33],"(",["T_CONSTANT_ENCAPSED_STRING","'tax'",33],")",";",["T_WHITESPACE","\n    ",33],"}",["T_WHITESPACE","\n\n    ",34],["T_PUBLIC","public",36],["T_WHITESPACE"," ",36],["T_FUNCTION","function",36],["T_WHITESPACE"," ",36],["T_STRING","collect",36],"(",["T_STRING","Mage_Sales_Model_Quote_Address",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$address",36],")",["T_WHITESPACE","\n    ",36],"{",["T_WHITESPACE","\n        ",37],["T_VARIABLE","$store",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_VARIABLE","$address",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","getQuote",38],"(",")",["T_OBJECT_OPERATOR","->",38],["T_STRING","getStore",38],"(",")",";",["T_WHITESPACE","\n\n        ",38],["T_VARIABLE","$address",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","setTaxAmount",40],"(",["T_LNUMBER","0",40],")",";",["T_WHITESPACE","\n        ",40],["T_VARIABLE","$address",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","setBaseTaxAmount",41],"(",["T_LNUMBER","0",41],")",";",["T_WHITESPACE","\n        ",41],["T_COMMENT","\/\/$address->setShippingTaxAmount(0);\n",42],["T_WHITESPACE","        ",43],["T_COMMENT","\/\/$address->setBaseShippingTaxAmount(0);\n",43],["T_WHITESPACE","        ",44],["T_VARIABLE","$address",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","setAppliedTaxes",44],"(",["T_ARRAY","array",44],"(",")",")",";",["T_WHITESPACE","\n\n        ",44],["T_VARIABLE","$items",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$address",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","getAllItems",46],"(",")",";",["T_WHITESPACE","\n        ",46],["T_IF","if",47],["T_WHITESPACE"," ",47],"(","!",["T_STRING","count",47],"(",["T_VARIABLE","$items",47],")",")",["T_WHITESPACE"," ",47],"{",["T_WHITESPACE","\n            ",47],["T_RETURN","return",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$this",48],";",["T_WHITESPACE","\n        ",48],"}",["T_WHITESPACE","\n        ",49],["T_VARIABLE","$custTaxClassId",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_VARIABLE","$address",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","getQuote",50],"(",")",["T_OBJECT_OPERATOR","->",50],["T_STRING","getCustomerTaxClassId",50],"(",")",";",["T_WHITESPACE","\n\n        ",50],["T_VARIABLE","$taxCalculationModel",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_STRING","Mage",52],["T_DOUBLE_COLON","::",52],["T_STRING","getSingleton",52],"(",["T_CONSTANT_ENCAPSED_STRING","'tax\/calculation'",52],")",";",["T_WHITESPACE","\n        ",52],["T_COMMENT","\/* @var $taxCalculationModel Mage_Tax_Model_Calculation *\/",53],["T_WHITESPACE","\n        ",53],["T_VARIABLE","$request",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$taxCalculationModel",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","getRateRequest",54],"(",["T_WHITESPACE","\n            ",54],["T_VARIABLE","$address",55],",",["T_WHITESPACE","\n            ",55],["T_VARIABLE","$address",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","getQuote",56],"(",")",["T_OBJECT_OPERATOR","->",56],["T_STRING","getBillingAddress",56],"(",")",",",["T_WHITESPACE","\n            ",56],["T_VARIABLE","$custTaxClassId",57],",",["T_WHITESPACE","\n            ",57],["T_VARIABLE","$store",58],["T_WHITESPACE","\n        ",58],")",";",["T_WHITESPACE","\n\n        ",59],["T_FOREACH","foreach",61],["T_WHITESPACE"," ",61],"(",["T_VARIABLE","$items",61],["T_WHITESPACE"," ",61],["T_AS","as",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$item",61],")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n            ",61],["T_DOC_COMMENT","\/**\n             * Child item's tax we calculate for parent\n             *\/",62],["T_WHITESPACE","\n            ",64],["T_IF","if",65],["T_WHITESPACE"," ",65],"(",["T_VARIABLE","$item",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getParentItemId",65],"(",")",")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n                ",65],["T_CONTINUE","continue",66],";",["T_WHITESPACE","\n            ",66],"}",["T_WHITESPACE","\n            ",67],["T_DOC_COMMENT","\/**\n             * We calculate parent tax amount as sum of children's tax amounts\n             *\/",68],["T_WHITESPACE","\n\n            ",70],["T_IF","if",72],["T_WHITESPACE"," ",72],"(",["T_VARIABLE","$item",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","getHasChildren",72],"(",")",["T_WHITESPACE"," ",72],["T_BOOLEAN_AND","&&",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$item",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","isChildrenCalculated",72],"(",")",")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n                ",72],["T_FOREACH","foreach",73],["T_WHITESPACE"," ",73],"(",["T_VARIABLE","$item",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","getChildren",73],"(",")",["T_WHITESPACE"," ",73],["T_AS","as",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$child",73],")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n                    ",73],["T_VARIABLE","$discountBefore",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$item",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","getDiscountAmount",74],"(",")",";",["T_WHITESPACE","\n                    ",74],["T_VARIABLE","$baseDiscountBefore",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$item",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getBaseDiscountAmount",75],"(",")",";",["T_WHITESPACE","\n\n                    ",75],["T_VARIABLE","$rate",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$taxCalculationModel",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getRate",77],"(",["T_WHITESPACE","\n                        ",77],["T_VARIABLE","$request",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","setProductClassId",78],"(",["T_VARIABLE","$child",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getProduct",78],"(",")",["T_OBJECT_OPERATOR","->",78],["T_STRING","getTaxClassId",78],"(",")",")",["T_WHITESPACE","\n                    ",78],")",";",["T_WHITESPACE","\n\n                    ",79],["T_VARIABLE","$child",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","setTaxPercent",81],"(",["T_VARIABLE","$rate",81],")",";",["T_WHITESPACE","\n                    ",81],["T_VARIABLE","$child",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","calcTaxAmount",82],"(",")",";",["T_WHITESPACE","\n\n                    ",82],["T_IF","if",84],["T_WHITESPACE"," ",84],"(",["T_VARIABLE","$discountBefore",84],["T_WHITESPACE"," ",84],["T_IS_NOT_EQUAL","!=",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$item",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getDiscountAmount",84],"(",")",")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n                        ",84],["T_VARIABLE","$address",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","setDiscountAmount",85],"(",["T_WHITESPACE","\n                            ",85],["T_VARIABLE","$address",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getDiscountAmount",86],"(",")",["T_WHITESPACE"," ",86],"+",["T_WHITESPACE"," ",86],"(",["T_VARIABLE","$item",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getDiscountAmount",86],"(",")",["T_WHITESPACE"," ",86],"-",["T_WHITESPACE"," ",86],["T_VARIABLE","$discountBefore",86],")",["T_WHITESPACE","\n                        ",86],")",";",["T_WHITESPACE","\n                        ",87],["T_VARIABLE","$address",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","setBaseDiscountAmount",88],"(",["T_WHITESPACE","\n                            ",88],["T_VARIABLE","$address",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getBaseDiscountAmount",89],"(",")",["T_WHITESPACE"," ",89],"+",["T_WHITESPACE"," ",89],"(",["T_VARIABLE","$item",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getBaseDiscountAmount",89],"(",")",["T_WHITESPACE"," ",89],"-",["T_WHITESPACE"," ",89],["T_VARIABLE","$baseDiscountBefore",89],")",["T_WHITESPACE","\n                        ",89],")",";",["T_WHITESPACE","\n\n                        ",90],["T_VARIABLE","$address",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","setGrandTotal",92],"(",["T_WHITESPACE","\n                            ",92],["T_VARIABLE","$address",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getGrandTotal",93],"(",")",["T_WHITESPACE"," ",93],"-",["T_WHITESPACE"," ",93],"(",["T_VARIABLE","$item",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getDiscountAmount",93],"(",")",["T_WHITESPACE"," ",93],"-",["T_WHITESPACE"," ",93],["T_VARIABLE","$discountBefore",93],")",["T_WHITESPACE","\n                        ",93],")",";",["T_WHITESPACE","\n                        ",94],["T_VARIABLE","$address",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","setBaseGrandTotal",95],"(",["T_WHITESPACE","\n                            ",95],["T_VARIABLE","$address",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getBaseGrandTotal",96],"(",")",["T_WHITESPACE"," ",96],"-",["T_WHITESPACE"," ",96],"(",["T_VARIABLE","$item",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getBaseDiscountAmount",96],"(",")",["T_WHITESPACE"," ",96],"-",["T_WHITESPACE"," ",96],["T_VARIABLE","$baseDiscountBefore",96],")",["T_WHITESPACE","\n                        ",96],")",";",["T_WHITESPACE","\n                    ",97],"}",["T_WHITESPACE","\n\n                    ",98],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","_saveAppliedTaxes",100],"(",["T_WHITESPACE","\n                       ",100],["T_VARIABLE","$address",101],",",["T_WHITESPACE","\n                       ",101],["T_VARIABLE","$taxCalculationModel",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getAppliedRates",102],"(",["T_VARIABLE","$request",102],")",",",["T_WHITESPACE","\n                       ",102],["T_VARIABLE","$child",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getTaxAmount",103],"(",")",",",["T_WHITESPACE","\n                       ",103],["T_VARIABLE","$child",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getBaseTaxAmount",104],"(",")",",",["T_WHITESPACE","\n                       ",104],["T_VARIABLE","$rate",105],["T_WHITESPACE","\n                    ",105],")",";",["T_WHITESPACE","\n                ",106],"}",["T_WHITESPACE","\n                ",107],["T_VARIABLE","$itemTaxAmount",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$item",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getTaxAmount",108],"(",")",["T_WHITESPACE"," ",108],"+",["T_WHITESPACE"," ",108],["T_VARIABLE","$item",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getDiscountTaxCompensation",108],"(",")",";",["T_WHITESPACE","\n                ",108],["T_VARIABLE","$address",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","setTaxAmount",109],"(",["T_VARIABLE","$address",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getTaxAmount",109],"(",")",["T_WHITESPACE"," ",109],"+",["T_WHITESPACE"," ",109],["T_VARIABLE","$itemTaxAmount",109],")",";",["T_WHITESPACE","\n                ",109],["T_VARIABLE","$itemBaseTaxAmount",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$item",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getBaseTaxAmount",110],"(",")",["T_WHITESPACE"," ",110],"+",["T_WHITESPACE"," ",110],["T_VARIABLE","$item",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getBaseDiscountTaxCompensation",110],"(",")",";",["T_WHITESPACE","\n                ",110],["T_VARIABLE","$address",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","setBaseTaxAmount",111],"(",["T_VARIABLE","$address",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","getBaseTaxAmount",111],"(",")",["T_WHITESPACE"," ",111],"+",["T_WHITESPACE"," ",111],["T_VARIABLE","$itemBaseTaxAmount",111],")",";",["T_WHITESPACE","\n            ",111],"}",["T_WHITESPACE","\n            ",112],["T_ELSE","else",113],["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n                ",113],["T_VARIABLE","$discountBefore",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_VARIABLE","$item",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","getDiscountAmount",114],"(",")",";",["T_WHITESPACE","\n                ",114],["T_VARIABLE","$baseDiscountBefore",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$item",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","getBaseDiscountAmount",115],"(",")",";",["T_WHITESPACE","\n\n                ",115],["T_VARIABLE","$rate",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_VARIABLE","$taxCalculationModel",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getRate",117],"(",["T_WHITESPACE","\n                    ",117],["T_VARIABLE","$request",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","setProductClassId",118],"(",["T_VARIABLE","$item",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","getProduct",118],"(",")",["T_OBJECT_OPERATOR","->",118],["T_STRING","getTaxClassId",118],"(",")",")",["T_WHITESPACE","\n                ",118],")",";",["T_WHITESPACE","\n\n                ",119],["T_VARIABLE","$item",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","setTaxPercent",121],"(",["T_VARIABLE","$rate",121],")",";",["T_WHITESPACE","\n                ",121],["T_VARIABLE","$item",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","calcTaxAmount",122],"(",")",";",["T_WHITESPACE","\n\n                ",122],["T_IF","if",124],["T_WHITESPACE"," ",124],"(",["T_VARIABLE","$discountBefore",124],["T_WHITESPACE"," ",124],["T_IS_NOT_EQUAL","!=",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$item",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","getDiscountAmount",124],"(",")",")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n                    ",124],["T_VARIABLE","$address",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","setDiscountAmount",125],"(",["T_WHITESPACE","\n                        ",125],["T_VARIABLE","$address",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getDiscountAmount",126],"(",")",["T_WHITESPACE"," ",126],"+",["T_WHITESPACE"," ",126],"(",["T_VARIABLE","$item",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getDiscountAmount",126],"(",")",["T_WHITESPACE"," ",126],"-",["T_WHITESPACE"," ",126],["T_VARIABLE","$discountBefore",126],")",["T_WHITESPACE","\n                    ",126],")",";",["T_WHITESPACE","\n                    ",127],["T_VARIABLE","$address",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","setBaseDiscountAmount",128],"(",["T_WHITESPACE","\n                        ",128],["T_VARIABLE","$address",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getBaseDiscountAmount",129],"(",")",["T_WHITESPACE"," ",129],"+",["T_WHITESPACE"," ",129],"(",["T_VARIABLE","$item",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getBaseDiscountAmount",129],"(",")",["T_WHITESPACE"," ",129],"-",["T_WHITESPACE"," ",129],["T_VARIABLE","$baseDiscountBefore",129],")",["T_WHITESPACE","\n                    ",129],")",";",["T_WHITESPACE","\n\n                    ",130],["T_VARIABLE","$address",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","setGrandTotal",132],"(",["T_WHITESPACE","\n                        ",132],["T_VARIABLE","$address",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getGrandTotal",133],"(",")",["T_WHITESPACE"," ",133],"-",["T_WHITESPACE"," ",133],"(",["T_VARIABLE","$item",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getDiscountAmount",133],"(",")",["T_WHITESPACE"," ",133],"-",["T_WHITESPACE"," ",133],["T_VARIABLE","$discountBefore",133],")",["T_WHITESPACE","\n                    ",133],")",";",["T_WHITESPACE","\n                    ",134],["T_VARIABLE","$address",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","setBaseGrandTotal",135],"(",["T_WHITESPACE","\n                        ",135],["T_VARIABLE","$address",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getBaseGrandTotal",136],"(",")",["T_WHITESPACE"," ",136],"-",["T_WHITESPACE"," ",136],"(",["T_VARIABLE","$item",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getBaseDiscountAmount",136],"(",")",["T_WHITESPACE"," ",136],"-",["T_WHITESPACE"," ",136],["T_VARIABLE","$baseDiscountBefore",136],")",["T_WHITESPACE","\n                    ",136],")",";",["T_WHITESPACE","\n                ",137],"}",["T_WHITESPACE","\n\n                ",138],["T_VARIABLE","$itemTaxAmount",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_VARIABLE","$item",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","getTaxAmount",140],"(",")",["T_WHITESPACE"," ",140],"+",["T_WHITESPACE"," ",140],["T_VARIABLE","$item",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","getDiscountTaxCompensation",140],"(",")",";",["T_WHITESPACE","\n                ",140],["T_VARIABLE","$address",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","setTaxAmount",141],"(",["T_VARIABLE","$address",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getTaxAmount",141],"(",")",["T_WHITESPACE"," ",141],"+",["T_WHITESPACE"," ",141],["T_VARIABLE","$itemTaxAmount",141],")",";",["T_WHITESPACE","\n                ",141],["T_VARIABLE","$itemBaseTaxAmount",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_VARIABLE","$item",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","getBaseTaxAmount",142],"(",")",["T_WHITESPACE"," ",142],"+",["T_WHITESPACE"," ",142],["T_VARIABLE","$item",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","getBaseDiscountTaxCompensation",142],"(",")",";",["T_WHITESPACE","\n                ",142],["T_VARIABLE","$address",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","setBaseTaxAmount",143],"(",["T_VARIABLE","$address",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getBaseTaxAmount",143],"(",")",["T_WHITESPACE"," ",143],"+",["T_WHITESPACE"," ",143],["T_VARIABLE","$itemBaseTaxAmount",143],")",";",["T_WHITESPACE","\n\n                ",143],["T_VARIABLE","$applied",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_VARIABLE","$taxCalculationModel",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getAppliedRates",145],"(",["T_VARIABLE","$request",145],")",";",["T_WHITESPACE","\n                ",145],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","_saveAppliedTaxes",146],"(",["T_WHITESPACE","\n                   ",146],["T_VARIABLE","$address",147],",",["T_WHITESPACE","\n                   ",147],["T_VARIABLE","$applied",148],",",["T_WHITESPACE","\n                   ",148],["T_VARIABLE","$item",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","getTaxAmount",149],"(",")",",",["T_WHITESPACE","\n                   ",149],["T_VARIABLE","$item",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","getBaseTaxAmount",150],"(",")",",",["T_WHITESPACE","\n                   ",150],["T_VARIABLE","$rate",151],["T_WHITESPACE","\n                ",151],")",";",["T_WHITESPACE","\n            ",152],"}",["T_WHITESPACE","\n        ",153],"}",["T_WHITESPACE","\n\n\n        ",154],["T_VARIABLE","$shippingTaxClass",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_STRING","Mage",157],["T_DOUBLE_COLON","::",157],["T_STRING","getStoreConfig",157],"(",["T_STRING","Mage_Tax_Model_Config",157],["T_DOUBLE_COLON","::",157],["T_STRING","CONFIG_XML_PATH_SHIPPING_TAX_CLASS",157],",",["T_WHITESPACE"," ",157],["T_VARIABLE","$store",157],")",";",["T_WHITESPACE","\n\n        ",157],["T_VARIABLE","$shippingTax",159],["T_WHITESPACE","      ",159],"=",["T_WHITESPACE"," ",159],["T_LNUMBER","0",159],";",["T_WHITESPACE","\n        ",159],["T_VARIABLE","$shippingBaseTax",160],["T_WHITESPACE","  ",160],"=",["T_WHITESPACE"," ",160],["T_LNUMBER","0",160],";",["T_WHITESPACE","\n\n        ",160],["T_IF","if",162],["T_WHITESPACE"," ",162],"(",["T_VARIABLE","$shippingTaxClass",162],")",["T_WHITESPACE"," ",162],"{",["T_WHITESPACE","\n            ",162],["T_IF","if",163],["T_WHITESPACE"," ",163],"(",["T_VARIABLE","$rate",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_VARIABLE","$taxCalculationModel",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","getRate",163],"(",["T_VARIABLE","$request",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","setProductClassId",163],"(",["T_VARIABLE","$shippingTaxClass",163],")",")",")",["T_WHITESPACE"," ",163],"{",["T_WHITESPACE","\n                ",163],["T_IF","if",164],["T_WHITESPACE"," ",164],"(","!",["T_STRING","Mage",164],["T_DOUBLE_COLON","::",164],["T_STRING","helper",164],"(",["T_CONSTANT_ENCAPSED_STRING","'tax'",164],")",["T_OBJECT_OPERATOR","->",164],["T_STRING","shippingPriceIncludesTax",164],"(",")",")",["T_WHITESPACE"," ",164],"{",["T_WHITESPACE","\n                    ",164],["T_VARIABLE","$shippingTax",165],["T_WHITESPACE","    ",165],"=",["T_WHITESPACE"," ",165],["T_VARIABLE","$address",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","getShippingAmount",165],"(",")",["T_WHITESPACE"," ",165],"*",["T_WHITESPACE"," ",165],["T_VARIABLE","$rate",165],"\/",["T_LNUMBER","100",165],";",["T_WHITESPACE","\n                    ",165],["T_VARIABLE","$shippingBaseTax",166],"=",["T_WHITESPACE"," ",166],["T_VARIABLE","$address",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","getBaseShippingAmount",166],"(",")",["T_WHITESPACE"," ",166],"*",["T_WHITESPACE"," ",166],["T_VARIABLE","$rate",166],"\/",["T_LNUMBER","100",166],";",["T_WHITESPACE","\n                ",166],"}",["T_WHITESPACE"," ",167],["T_ELSE","else",167],["T_WHITESPACE"," ",167],"{",["T_WHITESPACE","\n                    ",167],["T_VARIABLE","$shippingTax",168],["T_WHITESPACE","    ",168],"=",["T_WHITESPACE"," ",168],["T_VARIABLE","$address",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","getShippingTaxAmount",168],"(",")",";",["T_WHITESPACE","\n                    ",168],["T_VARIABLE","$shippingBaseTax",169],"=",["T_WHITESPACE"," ",169],["T_VARIABLE","$address",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","getBaseShippingTaxAmount",169],"(",")",";",["T_WHITESPACE","\n                ",169],"}",["T_WHITESPACE","\n\n                ",170],["T_VARIABLE","$shippingTax",172],["T_WHITESPACE","    ",172],"=",["T_WHITESPACE"," ",172],["T_VARIABLE","$store",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","roundPrice",172],"(",["T_VARIABLE","$shippingTax",172],")",";",["T_WHITESPACE","\n                ",172],["T_VARIABLE","$shippingBaseTax",173],"=",["T_WHITESPACE"," ",173],["T_VARIABLE","$store",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","roundPrice",173],"(",["T_VARIABLE","$shippingBaseTax",173],")",";",["T_WHITESPACE","\n\n                ",173],["T_VARIABLE","$address",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","setTaxAmount",175],"(",["T_VARIABLE","$address",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","getTaxAmount",175],"(",")",["T_WHITESPACE"," ",175],"+",["T_WHITESPACE"," ",175],["T_VARIABLE","$shippingTax",175],")",";",["T_WHITESPACE","\n                ",175],["T_VARIABLE","$address",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","setBaseTaxAmount",176],"(",["T_VARIABLE","$address",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","getBaseTaxAmount",176],"(",")",["T_WHITESPACE"," ",176],"+",["T_WHITESPACE"," ",176],["T_VARIABLE","$shippingBaseTax",176],")",";",["T_WHITESPACE","\n\n                ",176],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","_saveAppliedTaxes",178],"(",["T_WHITESPACE","\n                    ",178],["T_VARIABLE","$address",179],",",["T_WHITESPACE","\n                    ",179],["T_VARIABLE","$taxCalculationModel",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","getAppliedRates",180],"(",["T_VARIABLE","$request",180],")",",",["T_WHITESPACE","\n                    ",180],["T_VARIABLE","$shippingTax",181],",",["T_WHITESPACE","\n                    ",181],["T_VARIABLE","$shippingBaseTax",182],",",["T_WHITESPACE","\n                    ",182],["T_VARIABLE","$rate",183],["T_WHITESPACE","\n                ",183],")",";",["T_WHITESPACE","\n            ",184],"}",["T_WHITESPACE","\n        ",185],"}",["T_WHITESPACE","\n\n        ",186],["T_IF","if",188],["T_WHITESPACE"," ",188],"(","!",["T_STRING","Mage",188],["T_DOUBLE_COLON","::",188],["T_STRING","helper",188],"(",["T_CONSTANT_ENCAPSED_STRING","'tax'",188],")",["T_OBJECT_OPERATOR","->",188],["T_STRING","shippingPriceIncludesTax",188],"(",")",")",["T_WHITESPACE"," ",188],"{",["T_WHITESPACE","\n            ",188],["T_VARIABLE","$address",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","setShippingTaxAmount",189],"(",["T_VARIABLE","$shippingTax",189],")",";",["T_WHITESPACE","\n            ",189],["T_VARIABLE","$address",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","setBaseShippingTaxAmount",190],"(",["T_VARIABLE","$shippingBaseTax",190],")",";",["T_WHITESPACE","\n        ",190],"}",["T_WHITESPACE","\n\n        ",191],["T_VARIABLE","$address",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","setGrandTotal",193],"(",["T_VARIABLE","$address",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","getGrandTotal",193],"(",")",["T_WHITESPACE"," ",193],"+",["T_WHITESPACE"," ",193],["T_VARIABLE","$address",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","getTaxAmount",193],"(",")",")",";",["T_WHITESPACE","\n        ",193],["T_VARIABLE","$address",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","setBaseGrandTotal",194],"(",["T_VARIABLE","$address",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","getBaseGrandTotal",194],"(",")",["T_WHITESPACE"," ",194],"+",["T_WHITESPACE"," ",194],["T_VARIABLE","$address",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","getBaseTaxAmount",194],"(",")",")",";",["T_WHITESPACE","\n        ",194],["T_RETURN","return",195],["T_WHITESPACE"," ",195],["T_VARIABLE","$this",195],";",["T_WHITESPACE","\n    ",195],"}",["T_WHITESPACE","\n\n    ",196],["T_PROTECTED","protected",198],["T_WHITESPACE"," ",198],["T_FUNCTION","function",198],["T_WHITESPACE"," ",198],["T_STRING","_saveAppliedTaxes",198],"(",["T_STRING","Mage_Sales_Model_Quote_Address",198],["T_WHITESPACE"," ",198],["T_VARIABLE","$address",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$applied",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$amount",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$baseAmount",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$rate",198],")",["T_WHITESPACE","\n    ",198],"{",["T_WHITESPACE","\n        ",199],["T_VARIABLE","$previouslyAppliedTaxes",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_VARIABLE","$address",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","getAppliedTaxes",200],"(",")",";",["T_WHITESPACE","\n        ",200],["T_VARIABLE","$process",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_STRING","count",201],"(",["T_VARIABLE","$previouslyAppliedTaxes",201],")",";",["T_WHITESPACE","\n\n        ",201],["T_FOREACH","foreach",203],["T_WHITESPACE"," ",203],"(",["T_VARIABLE","$applied",203],["T_WHITESPACE"," ",203],["T_AS","as",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$row",203],")",["T_WHITESPACE"," ",203],"{",["T_WHITESPACE","\n            ",203],["T_IF","if",204],["T_WHITESPACE"," ",204],"(","!",["T_ISSET","isset",204],"(",["T_VARIABLE","$previouslyAppliedTaxes",204],"[",["T_VARIABLE","$row",204],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",204],"]","]",")",")",["T_WHITESPACE"," ",204],"{",["T_WHITESPACE","\n                ",204],["T_VARIABLE","$row",205],"[",["T_CONSTANT_ENCAPSED_STRING","'process'",205],"]",["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_VARIABLE","$process",205],";",["T_WHITESPACE","\n                ",205],["T_VARIABLE","$row",206],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",206],"]",["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],["T_LNUMBER","0",206],";",["T_WHITESPACE","\n                ",206],["T_VARIABLE","$row",207],"[",["T_CONSTANT_ENCAPSED_STRING","'base_amount'",207],"]",["T_WHITESPACE"," ",207],"=",["T_WHITESPACE"," ",207],["T_LNUMBER","0",207],";",["T_WHITESPACE","\n                ",207],["T_VARIABLE","$previouslyAppliedTaxes",208],"[",["T_VARIABLE","$row",208],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",208],"]","]",["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_VARIABLE","$row",208],";",["T_WHITESPACE","\n            ",208],"}",["T_WHITESPACE","\n\n            ",209],["T_IF","if",211],["T_WHITESPACE"," ",211],"(","!",["T_STRING","is_null",211],"(",["T_VARIABLE","$row",211],"[",["T_CONSTANT_ENCAPSED_STRING","'percent'",211],"]",")",")",["T_WHITESPACE"," ",211],"{",["T_WHITESPACE","\n                ",211],["T_VARIABLE","$row",212],"[",["T_CONSTANT_ENCAPSED_STRING","'percent'",212],"]",["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_VARIABLE","$row",212],"[",["T_CONSTANT_ENCAPSED_STRING","'percent'",212],"]",["T_WHITESPACE"," ",212],"?",["T_WHITESPACE"," ",212],["T_VARIABLE","$row",212],"[",["T_CONSTANT_ENCAPSED_STRING","'percent'",212],"]",["T_WHITESPACE"," ",212],":",["T_WHITESPACE"," ",212],["T_LNUMBER","1",212],";",["T_WHITESPACE","\n                ",212],["T_VARIABLE","$rate",213],["T_WHITESPACE"," ",213],"=",["T_WHITESPACE"," ",213],["T_VARIABLE","$rate",213],["T_WHITESPACE"," ",213],"?",["T_WHITESPACE"," ",213],["T_VARIABLE","$rate",213],["T_WHITESPACE"," ",213],":",["T_WHITESPACE"," ",213],["T_LNUMBER","1",213],";",["T_WHITESPACE","\n\n                ",213],["T_VARIABLE","$appliedAmount",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_VARIABLE","$amount",215],"\/",["T_VARIABLE","$rate",215],"*",["T_VARIABLE","$row",215],"[",["T_CONSTANT_ENCAPSED_STRING","'percent'",215],"]",";",["T_WHITESPACE","\n                ",215],["T_VARIABLE","$baseAppliedAmount",216],["T_WHITESPACE"," ",216],"=",["T_WHITESPACE"," ",216],["T_VARIABLE","$baseAmount",216],"\/",["T_VARIABLE","$rate",216],"*",["T_VARIABLE","$row",216],"[",["T_CONSTANT_ENCAPSED_STRING","'percent'",216],"]",";",["T_WHITESPACE","\n            ",216],"}",["T_WHITESPACE"," ",217],["T_ELSE","else",217],["T_WHITESPACE"," ",217],"{",["T_WHITESPACE","\n                ",217],["T_VARIABLE","$appliedAmount",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_LNUMBER","0",218],";",["T_WHITESPACE","\n                ",218],["T_VARIABLE","$baseAppliedAmount",219],["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],["T_LNUMBER","0",219],";",["T_WHITESPACE","\n                ",219],["T_FOREACH","foreach",220],["T_WHITESPACE"," ",220],"(",["T_VARIABLE","$row",220],"[",["T_CONSTANT_ENCAPSED_STRING","'rates'",220],"]",["T_WHITESPACE"," ",220],["T_AS","as",220],["T_WHITESPACE"," ",220],["T_VARIABLE","$rate",220],")",["T_WHITESPACE"," ",220],"{",["T_WHITESPACE","\n                    ",220],["T_VARIABLE","$appliedAmount",221],["T_WHITESPACE"," ",221],["T_PLUS_EQUAL","+=",221],["T_WHITESPACE"," ",221],["T_VARIABLE","$rate",221],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",221],"]",";",["T_WHITESPACE","\n                    ",221],["T_VARIABLE","$baseAppliedAmount",222],["T_WHITESPACE"," ",222],["T_PLUS_EQUAL","+=",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$rate",222],"[",["T_CONSTANT_ENCAPSED_STRING","'base_amount'",222],"]",";",["T_WHITESPACE","\n                ",222],"}",["T_WHITESPACE","\n            ",223],"}",["T_WHITESPACE","\n\n\n            ",224],["T_IF","if",227],["T_WHITESPACE"," ",227],"(",["T_VARIABLE","$appliedAmount",227],["T_WHITESPACE"," ",227],["T_BOOLEAN_OR","||",227],["T_WHITESPACE"," ",227],["T_VARIABLE","$previouslyAppliedTaxes",227],"[",["T_VARIABLE","$row",227],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",227],"]","]","[",["T_CONSTANT_ENCAPSED_STRING","'amount'",227],"]",")",["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n                ",227],["T_VARIABLE","$previouslyAppliedTaxes",228],"[",["T_VARIABLE","$row",228],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",228],"]","]","[",["T_CONSTANT_ENCAPSED_STRING","'amount'",228],"]",["T_WHITESPACE"," ",228],["T_PLUS_EQUAL","+=",228],["T_WHITESPACE"," ",228],["T_VARIABLE","$appliedAmount",228],";",["T_WHITESPACE","\n                ",228],["T_VARIABLE","$previouslyAppliedTaxes",229],"[",["T_VARIABLE","$row",229],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",229],"]","]","[",["T_CONSTANT_ENCAPSED_STRING","'base_amount'",229],"]",["T_WHITESPACE"," ",229],["T_PLUS_EQUAL","+=",229],["T_WHITESPACE"," ",229],["T_VARIABLE","$baseAppliedAmount",229],";",["T_WHITESPACE","\n            ",229],"}",["T_WHITESPACE"," ",230],["T_ELSE","else",230],["T_WHITESPACE"," ",230],"{",["T_WHITESPACE","\n                ",230],["T_UNSET","unset",231],"(",["T_VARIABLE","$previouslyAppliedTaxes",231],"[",["T_VARIABLE","$row",231],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",231],"]","]",")",";",["T_WHITESPACE","\n            ",231],"}",["T_WHITESPACE","\n        ",232],"}",["T_WHITESPACE","\n        ",233],["T_VARIABLE","$address",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","setAppliedTaxes",234],"(",["T_VARIABLE","$previouslyAppliedTaxes",234],")",";",["T_WHITESPACE","\n    ",234],"}",["T_WHITESPACE","\n\n    ",235],["T_PUBLIC","public",237],["T_WHITESPACE"," ",237],["T_FUNCTION","function",237],["T_WHITESPACE"," ",237],["T_STRING","fetch",237],"(",["T_STRING","Mage_Sales_Model_Quote_Address",237],["T_WHITESPACE"," ",237],["T_VARIABLE","$address",237],")",["T_WHITESPACE","\n    ",237],"{",["T_WHITESPACE","\n        ",238],["T_VARIABLE","$applied",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_VARIABLE","$address",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","getAppliedTaxes",239],"(",")",";",["T_WHITESPACE","\n        ",239],["T_VARIABLE","$store",240],["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],["T_VARIABLE","$address",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","getQuote",240],"(",")",["T_OBJECT_OPERATOR","->",240],["T_STRING","getStore",240],"(",")",";",["T_WHITESPACE","\n        ",240],["T_VARIABLE","$amount",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_VARIABLE","$address",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","getTaxAmount",241],"(",")",";",["T_WHITESPACE","\n\n        ",241],["T_IF","if",243],["T_WHITESPACE"," ",243],"(","(",["T_VARIABLE","$amount",243],["T_IS_NOT_EQUAL","!=",243],["T_LNUMBER","0",243],")",["T_WHITESPACE"," ",243],["T_BOOLEAN_OR","||",243],["T_WHITESPACE"," ",243],"(",["T_STRING","Mage",243],["T_DOUBLE_COLON","::",243],["T_STRING","helper",243],"(",["T_CONSTANT_ENCAPSED_STRING","'tax'",243],")",["T_OBJECT_OPERATOR","->",243],["T_STRING","displayZeroTax",243],"(",["T_VARIABLE","$store",243],")",")",")",["T_WHITESPACE"," ",243],"{",["T_WHITESPACE","\n            ",243],["T_VARIABLE","$address",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","addTotal",244],"(",["T_ARRAY","array",244],"(",["T_WHITESPACE","\n                ",244],["T_CONSTANT_ENCAPSED_STRING","'code'",245],["T_DOUBLE_ARROW","=>",245],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","getCode",245],"(",")",",",["T_WHITESPACE","\n                ",245],["T_CONSTANT_ENCAPSED_STRING","'title'",246],["T_DOUBLE_ARROW","=>",246],["T_STRING","Mage",246],["T_DOUBLE_COLON","::",246],["T_STRING","helper",246],"(",["T_CONSTANT_ENCAPSED_STRING","'sales'",246],")",["T_OBJECT_OPERATOR","->",246],["T_STRING","__",246],"(",["T_CONSTANT_ENCAPSED_STRING","'Tax'",246],")",",",["T_WHITESPACE","\n                ",246],["T_CONSTANT_ENCAPSED_STRING","'full_info'",247],["T_DOUBLE_ARROW","=>",247],["T_VARIABLE","$applied",247],["T_WHITESPACE"," ",247],"?",["T_WHITESPACE"," ",247],["T_VARIABLE","$applied",247],["T_WHITESPACE"," ",247],":",["T_WHITESPACE"," ",247],["T_ARRAY","array",247],"(",")",",",["T_WHITESPACE","\n                ",247],["T_CONSTANT_ENCAPSED_STRING","'value'",248],["T_DOUBLE_ARROW","=>",248],["T_VARIABLE","$amount",248],["T_WHITESPACE","\n            ",248],")",")",";",["T_WHITESPACE","\n        ",249],"}",["T_WHITESPACE","\n        ",250],["T_RETURN","return",251],["T_WHITESPACE"," ",251],["T_VARIABLE","$this",251],";",["T_WHITESPACE","\n    ",251],"}",["T_WHITESPACE","\n",252],"}",["T_WHITESPACE","\n",253]]