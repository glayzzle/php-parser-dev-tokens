[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Sales\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Shipping report resource model\n *\n * @category    Mage\n * @package     Mage_Sales\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Sales_Model_Resource_Report_Shipping",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Sales_Model_Resource_Report_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Model initialization\n     *\n     *\/",37],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_FUNCTION","function",41],["T_WHITESPACE"," ",41],["T_STRING","_construct",41],"(",")",["T_WHITESPACE","\n    ",41],"{",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","_setResource",43],"(",["T_CONSTANT_ENCAPSED_STRING","'sales'",43],")",";",["T_WHITESPACE","\n    ",43],"}",["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * Aggregate Shipping data\n     *\n     * @param mixed $from\n     * @param mixed $to\n     * @return Mage_Sales_Model_Resource_Report_Shipping\n     *\/",46],["T_WHITESPACE","\n    ",52],["T_PUBLIC","public",53],["T_WHITESPACE"," ",53],["T_FUNCTION","function",53],["T_WHITESPACE"," ",53],["T_STRING","aggregate",53],"(",["T_VARIABLE","$from",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_STRING","null",53],",",["T_WHITESPACE"," ",53],["T_VARIABLE","$to",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_STRING","null",53],")",["T_WHITESPACE","\n    ",53],"{",["T_WHITESPACE","\n        ",54],["T_COMMENT","\/\/ convert input dates to UTC to be comparable with DATETIME fields in DB\n",55],["T_WHITESPACE","        ",56],["T_VARIABLE","$from",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","_dateToUtc",56],"(",["T_VARIABLE","$from",56],")",";",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$to",57],["T_WHITESPACE","   ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","_dateToUtc",57],"(",["T_VARIABLE","$to",57],")",";",["T_WHITESPACE","\n\n        ",57],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","_checkDates",59],"(",["T_VARIABLE","$from",59],",",["T_WHITESPACE"," ",59],["T_VARIABLE","$to",59],")",";",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","_aggregateByOrderCreatedAt",60],"(",["T_VARIABLE","$from",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$to",60],")",";",["T_WHITESPACE","\n        ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","_aggregateByShippingCreatedAt",61],"(",["T_VARIABLE","$from",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$to",61],")",";",["T_WHITESPACE","\n        ",61],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","_setFlagData",62],"(",["T_STRING","Mage_Reports_Model_Flag",62],["T_DOUBLE_COLON","::",62],["T_STRING","REPORT_SHIPPING_FLAG_CODE",62],")",";",["T_WHITESPACE","\n        ",62],["T_RETURN","return",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$this",63],";",["T_WHITESPACE","\n    ",63],"}",["T_WHITESPACE","\n\n    ",64],["T_DOC_COMMENT","\/**\n     * Aggregate shipping report by order create_at as period\n     *\n     * @param mixed $from\n     * @param mixed $to\n     * @return Mage_Sales_Model_Resource_Report_Shipping\n     *\/",66],["T_WHITESPACE","\n    ",72],["T_PROTECTED","protected",73],["T_WHITESPACE"," ",73],["T_FUNCTION","function",73],["T_WHITESPACE"," ",73],["T_STRING","_aggregateByOrderCreatedAt",73],"(",["T_VARIABLE","$from",73],",",["T_WHITESPACE"," ",73],["T_VARIABLE","$to",73],")",["T_WHITESPACE","\n    ",73],"{",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$table",75],["T_WHITESPACE","       ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getTable",75],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/shipping_aggregated_order'",75],")",";",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$sourceTable",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getTable",76],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order'",76],")",";",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$adapter",77],["T_WHITESPACE","     ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","_getWriteAdapter",77],"(",")",";",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$adapter",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","beginTransaction",78],"(",")",";",["T_WHITESPACE","\n\n        ",78],["T_TRY","try",80],["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n            ",80],["T_IF","if",81],["T_WHITESPACE"," ",81],"(",["T_VARIABLE","$from",81],["T_WHITESPACE"," ",81],["T_IS_NOT_IDENTICAL","!==",81],["T_WHITESPACE"," ",81],["T_STRING","null",81],["T_WHITESPACE"," ",81],["T_BOOLEAN_OR","||",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$to",81],["T_WHITESPACE"," ",81],["T_IS_NOT_IDENTICAL","!==",81],["T_WHITESPACE"," ",81],["T_STRING","null",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n                ",81],["T_VARIABLE","$subSelect",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","_getTableDateRangeSelect",82],"(",["T_VARIABLE","$sourceTable",82],",",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'created_at'",82],",",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'updated_at'",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$from",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$to",82],")",";",["T_WHITESPACE","\n            ",82],"}",["T_WHITESPACE"," ",83],["T_ELSE","else",83],["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n                ",83],["T_VARIABLE","$subSelect",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_STRING","null",84],";",["T_WHITESPACE","\n            ",84],"}",["T_WHITESPACE","\n\n            ",85],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","_clearTableByDateRange",87],"(",["T_VARIABLE","$table",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$from",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$to",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$subSelect",87],")",";",["T_WHITESPACE","\n            ",87],["T_COMMENT","\/\/ convert dates from UTC to current admin timezone\n",88],["T_WHITESPACE","            ",89],["T_VARIABLE","$periodExpr",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$adapter",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getDatePartSql",89],"(",["T_WHITESPACE","\n                ",89],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","getStoreTZOffsetQuery",90],"(",["T_VARIABLE","$sourceTable",90],",",["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'created_at'",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$from",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$to",90],")",["T_WHITESPACE","\n            ",90],")",";",["T_WHITESPACE","\n            ",91],["T_VARIABLE","$ifnullBaseShippingCanceled",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$adapter",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getIfNullSql",92],"(",["T_CONSTANT_ENCAPSED_STRING","'base_shipping_canceled'",92],",",["T_WHITESPACE"," ",92],["T_LNUMBER","0",92],")",";",["T_WHITESPACE","\n            ",92],["T_VARIABLE","$ifnullBaseShippingRefunded",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$adapter",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getIfNullSql",93],"(",["T_CONSTANT_ENCAPSED_STRING","'base_shipping_refunded'",93],",",["T_WHITESPACE"," ",93],["T_LNUMBER","0",93],")",";",["T_WHITESPACE","\n            ",93],["T_VARIABLE","$columns",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_ARRAY","array",94],"(",["T_WHITESPACE","\n                ",94],["T_CONSTANT_ENCAPSED_STRING","'period'",95],["T_WHITESPACE","                ",95],["T_DOUBLE_ARROW","=>",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$periodExpr",95],",",["T_WHITESPACE","\n                ",95],["T_CONSTANT_ENCAPSED_STRING","'store_id'",96],["T_WHITESPACE","              ",96],["T_DOUBLE_ARROW","=>",96],["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","'store_id'",96],",",["T_WHITESPACE","\n                ",96],["T_CONSTANT_ENCAPSED_STRING","'order_status'",97],["T_WHITESPACE","          ",97],["T_DOUBLE_ARROW","=>",97],["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","'status'",97],",",["T_WHITESPACE","\n                ",97],["T_CONSTANT_ENCAPSED_STRING","'shipping_description'",98],["T_WHITESPACE","  ",98],["T_DOUBLE_ARROW","=>",98],["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'shipping_description'",98],",",["T_WHITESPACE","\n                ",98],["T_CONSTANT_ENCAPSED_STRING","'orders_count'",99],["T_WHITESPACE","          ",99],["T_DOUBLE_ARROW","=>",99],["T_WHITESPACE"," ",99],["T_NEW","new",99],["T_WHITESPACE"," ",99],["T_STRING","Zend_Db_Expr",99],"(",["T_CONSTANT_ENCAPSED_STRING","'COUNT(entity_id)'",99],")",",",["T_WHITESPACE","\n                ",99],["T_CONSTANT_ENCAPSED_STRING","'total_shipping'",100],["T_WHITESPACE","        ",100],["T_DOUBLE_ARROW","=>",100],["T_WHITESPACE"," ",100],["T_NEW","new",100],["T_WHITESPACE"," ",100],["T_STRING","Zend_Db_Expr",100],"(",["T_WHITESPACE","\n                    ",100],"\"",["T_ENCAPSED_AND_WHITESPACE","SUM((base_shipping_amount - ",101],["T_CURLY_OPEN","{",101],["T_VARIABLE","$ifnullBaseShippingCanceled",101],"}",["T_ENCAPSED_AND_WHITESPACE",") * base_to_global_rate)",101],"\"",")",",",["T_WHITESPACE","\n                ",101],["T_CONSTANT_ENCAPSED_STRING","'total_shipping_actual'",102],["T_WHITESPACE"," ",102],["T_DOUBLE_ARROW","=>",102],["T_WHITESPACE"," ",102],["T_NEW","new",102],["T_WHITESPACE"," ",102],["T_STRING","Zend_Db_Expr",102],"(",["T_WHITESPACE","\n                    ",102],"\"",["T_ENCAPSED_AND_WHITESPACE","SUM((base_shipping_invoiced - ",103],["T_CURLY_OPEN","{",103],["T_VARIABLE","$ifnullBaseShippingRefunded",103],"}",["T_ENCAPSED_AND_WHITESPACE",") * base_to_global_rate)",103],"\"",")",",",["T_WHITESPACE","\n            ",103],")",";",["T_WHITESPACE","\n\n            ",104],["T_VARIABLE","$select",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_VARIABLE","$adapter",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","select",106],"(",")",";",["T_WHITESPACE","\n            ",106],["T_VARIABLE","$select",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","from",107],"(",["T_VARIABLE","$sourceTable",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$columns",107],")",["T_WHITESPACE","\n                 ",107],["T_OBJECT_OPERATOR","->",108],["T_STRING","where",108],"(",["T_CONSTANT_ENCAPSED_STRING","'state NOT IN (?)'",108],",",["T_WHITESPACE"," ",108],["T_ARRAY","array",108],"(",["T_WHITESPACE","\n                    ",108],["T_STRING","Mage_Sales_Model_Order",109],["T_DOUBLE_COLON","::",109],["T_STRING","STATE_PENDING_PAYMENT",109],",",["T_WHITESPACE","\n                    ",109],["T_STRING","Mage_Sales_Model_Order",110],["T_DOUBLE_COLON","::",110],["T_STRING","STATE_NEW",110],["T_WHITESPACE","\n                ",110],")",")",["T_WHITESPACE","\n                ",111],["T_OBJECT_OPERATOR","->",112],["T_STRING","where",112],"(",["T_CONSTANT_ENCAPSED_STRING","'is_virtual = 0'",112],")",";",["T_WHITESPACE","\n\n            ",112],["T_IF","if",114],["T_WHITESPACE"," ",114],"(",["T_VARIABLE","$subSelect",114],["T_WHITESPACE"," ",114],["T_IS_NOT_IDENTICAL","!==",114],["T_WHITESPACE"," ",114],["T_STRING","null",114],")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n                ",114],["T_VARIABLE","$select",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","having",115],"(",["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","_makeConditionFromDateRangeSelect",115],"(",["T_VARIABLE","$subSelect",115],",",["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'period'",115],")",")",";",["T_WHITESPACE","\n            ",115],"}",["T_WHITESPACE","\n\n            ",116],["T_VARIABLE","$select",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","group",118],"(",["T_ARRAY","array",118],"(",["T_WHITESPACE","\n                ",118],["T_VARIABLE","$periodExpr",119],",",["T_WHITESPACE","\n                ",119],["T_CONSTANT_ENCAPSED_STRING","'store_id'",120],",",["T_WHITESPACE","\n                ",120],["T_CONSTANT_ENCAPSED_STRING","'status'",121],",",["T_WHITESPACE","\n                ",121],["T_CONSTANT_ENCAPSED_STRING","'shipping_description'",122],["T_WHITESPACE","\n            ",122],")",")",";",["T_WHITESPACE","\n\n            ",123],["T_VARIABLE","$select",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","having",125],"(",["T_CONSTANT_ENCAPSED_STRING","'orders_count > 0'",125],")",";",["T_WHITESPACE","\n\n            ",125],["T_VARIABLE","$helper",127],["T_WHITESPACE","        ",127],"=",["T_WHITESPACE"," ",127],["T_STRING","Mage",127],["T_DOUBLE_COLON","::",127],["T_STRING","getResourceHelper",127],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",127],")",";",["T_WHITESPACE","\n            ",127],["T_VARIABLE","$insertQuery",128],["T_WHITESPACE","   ",128],"=",["T_WHITESPACE"," ",128],["T_VARIABLE","$helper",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","getInsertFromSelectUsingAnalytic",128],"(",["T_VARIABLE","$select",128],",",["T_WHITESPACE"," ",128],["T_VARIABLE","$table",128],",",["T_WHITESPACE"," ",128],["T_STRING","array_keys",128],"(",["T_VARIABLE","$columns",128],")",")",";",["T_WHITESPACE","\n            ",128],["T_VARIABLE","$adapter",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","query",129],"(",["T_VARIABLE","$insertQuery",129],")",";",["T_WHITESPACE","\n\n            ",129],["T_VARIABLE","$select",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","reset",131],"(",")",";",["T_WHITESPACE","\n\n            ",131],["T_VARIABLE","$columns",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_ARRAY","array",133],"(",["T_WHITESPACE","\n                ",133],["T_CONSTANT_ENCAPSED_STRING","'period'",134],["T_WHITESPACE","                ",134],["T_DOUBLE_ARROW","=>",134],["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","'period'",134],",",["T_WHITESPACE","\n                ",134],["T_CONSTANT_ENCAPSED_STRING","'store_id'",135],["T_WHITESPACE","              ",135],["T_DOUBLE_ARROW","=>",135],["T_WHITESPACE"," ",135],["T_NEW","new",135],["T_WHITESPACE"," ",135],["T_STRING","Zend_Db_Expr",135],"(",["T_STRING","Mage_Core_Model_App",135],["T_DOUBLE_COLON","::",135],["T_STRING","ADMIN_STORE_ID",135],")",",",["T_WHITESPACE","\n                ",135],["T_CONSTANT_ENCAPSED_STRING","'order_status'",136],["T_WHITESPACE","          ",136],["T_DOUBLE_ARROW","=>",136],["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","'order_status'",136],",",["T_WHITESPACE","\n                ",136],["T_CONSTANT_ENCAPSED_STRING","'shipping_description'",137],["T_WHITESPACE","  ",137],["T_DOUBLE_ARROW","=>",137],["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'shipping_description'",137],",",["T_WHITESPACE","\n                ",137],["T_CONSTANT_ENCAPSED_STRING","'orders_count'",138],["T_WHITESPACE","          ",138],["T_DOUBLE_ARROW","=>",138],["T_WHITESPACE"," ",138],["T_NEW","new",138],["T_WHITESPACE"," ",138],["T_STRING","Zend_Db_Expr",138],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(orders_count)'",138],")",",",["T_WHITESPACE","\n                ",138],["T_CONSTANT_ENCAPSED_STRING","'total_shipping'",139],["T_WHITESPACE","        ",139],["T_DOUBLE_ARROW","=>",139],["T_WHITESPACE"," ",139],["T_NEW","new",139],["T_WHITESPACE"," ",139],["T_STRING","Zend_Db_Expr",139],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(total_shipping)'",139],")",",",["T_WHITESPACE","\n                ",139],["T_CONSTANT_ENCAPSED_STRING","'total_shipping_actual'",140],["T_WHITESPACE"," ",140],["T_DOUBLE_ARROW","=>",140],["T_WHITESPACE"," ",140],["T_NEW","new",140],["T_WHITESPACE"," ",140],["T_STRING","Zend_Db_Expr",140],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(total_shipping_actual)'",140],")",",",["T_WHITESPACE","\n            ",140],")",";",["T_WHITESPACE","\n\n            ",141],["T_VARIABLE","$select",143],["T_WHITESPACE","\n                ",143],["T_OBJECT_OPERATOR","->",144],["T_STRING","from",144],"(",["T_VARIABLE","$table",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$columns",144],")",["T_WHITESPACE","\n                ",144],["T_OBJECT_OPERATOR","->",145],["T_STRING","where",145],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id != ?'",145],",",["T_WHITESPACE"," ",145],["T_LNUMBER","0",145],")",";",["T_WHITESPACE","\n\n            ",145],["T_IF","if",147],["T_WHITESPACE"," ",147],"(",["T_VARIABLE","$subSelect",147],["T_WHITESPACE"," ",147],["T_IS_NOT_IDENTICAL","!==",147],["T_WHITESPACE"," ",147],["T_STRING","null",147],")",["T_WHITESPACE"," ",147],"{",["T_WHITESPACE","\n                ",147],["T_VARIABLE","$select",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","where",148],"(",["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","_makeConditionFromDateRangeSelect",148],"(",["T_VARIABLE","$subSelect",148],",",["T_WHITESPACE"," ",148],["T_CONSTANT_ENCAPSED_STRING","'period'",148],")",")",";",["T_WHITESPACE","\n            ",148],"}",["T_WHITESPACE","\n\n            ",149],["T_VARIABLE","$select",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","group",151],"(",["T_ARRAY","array",151],"(",["T_WHITESPACE","\n                ",151],["T_CONSTANT_ENCAPSED_STRING","'period'",152],",",["T_WHITESPACE","\n                ",152],["T_CONSTANT_ENCAPSED_STRING","'order_status'",153],",",["T_WHITESPACE","\n                ",153],["T_CONSTANT_ENCAPSED_STRING","'shipping_description'",154],["T_WHITESPACE","\n            ",154],")",")",";",["T_WHITESPACE","\n\n            ",155],["T_VARIABLE","$insertQuery",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_VARIABLE","$helper",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","getInsertFromSelectUsingAnalytic",157],"(",["T_VARIABLE","$select",157],",",["T_WHITESPACE"," ",157],["T_VARIABLE","$table",157],",",["T_WHITESPACE"," ",157],["T_STRING","array_keys",157],"(",["T_VARIABLE","$columns",157],")",")",";",["T_WHITESPACE","\n            ",157],["T_VARIABLE","$adapter",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","query",158],"(",["T_VARIABLE","$insertQuery",158],")",";",["T_WHITESPACE","\n        ",158],"}",["T_WHITESPACE"," ",159],["T_CATCH","catch",159],["T_WHITESPACE"," ",159],"(",["T_STRING","Exception",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$e",159],")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n            ",159],["T_VARIABLE","$adapter",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","rollBack",160],"(",")",";",["T_WHITESPACE","\n            ",160],["T_THROW","throw",161],["T_WHITESPACE"," ",161],["T_VARIABLE","$e",161],";",["T_WHITESPACE","\n        ",161],"}",["T_WHITESPACE","\n\n        ",162],["T_VARIABLE","$adapter",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","commit",164],"(",")",";",["T_WHITESPACE","\n        ",164],["T_RETURN","return",165],["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],";",["T_WHITESPACE","\n    ",165],"}",["T_WHITESPACE","\n\n    ",166],["T_DOC_COMMENT","\/**\n     * Aggregate shipping report by shipment create_at as period\n     *\n     * @param mixed $from\n     * @param mixed $to\n     * @return Mage_Sales_Model_Resource_Report_Shipping\n     *\/",168],["T_WHITESPACE","\n    ",174],["T_PROTECTED","protected",175],["T_WHITESPACE"," ",175],["T_FUNCTION","function",175],["T_WHITESPACE"," ",175],["T_STRING","_aggregateByShippingCreatedAt",175],"(",["T_VARIABLE","$from",175],",",["T_WHITESPACE"," ",175],["T_VARIABLE","$to",175],")",["T_WHITESPACE","\n    ",175],"{",["T_WHITESPACE","\n        ",176],["T_VARIABLE","$table",177],["T_WHITESPACE","       ",177],"=",["T_WHITESPACE"," ",177],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","getTable",177],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/shipping_aggregated'",177],")",";",["T_WHITESPACE","\n        ",177],["T_VARIABLE","$sourceTable",178],["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","getTable",178],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/invoice'",178],")",";",["T_WHITESPACE","\n        ",178],["T_VARIABLE","$orderTable",179],["T_WHITESPACE","  ",179],"=",["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","getTable",179],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order'",179],")",";",["T_WHITESPACE","\n        ",179],["T_VARIABLE","$adapter",180],["T_WHITESPACE","     ",180],"=",["T_WHITESPACE"," ",180],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","_getWriteAdapter",180],"(",")",";",["T_WHITESPACE","\n        ",180],["T_VARIABLE","$adapter",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","beginTransaction",181],"(",")",";",["T_WHITESPACE","\n\n        ",181],["T_TRY","try",183],["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n            ",183],["T_IF","if",184],["T_WHITESPACE"," ",184],"(",["T_VARIABLE","$from",184],["T_WHITESPACE"," ",184],["T_IS_NOT_IDENTICAL","!==",184],["T_WHITESPACE"," ",184],["T_STRING","null",184],["T_WHITESPACE"," ",184],["T_BOOLEAN_OR","||",184],["T_WHITESPACE"," ",184],["T_VARIABLE","$to",184],["T_WHITESPACE"," ",184],["T_IS_NOT_IDENTICAL","!==",184],["T_WHITESPACE"," ",184],["T_STRING","null",184],")",["T_WHITESPACE"," ",184],"{",["T_WHITESPACE","\n                ",184],["T_VARIABLE","$subSelect",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","_getTableDateRangeRelatedSelect",185],"(",["T_WHITESPACE","\n                    ",185],["T_VARIABLE","$sourceTable",186],",",["T_WHITESPACE"," ",186],["T_VARIABLE","$orderTable",186],",",["T_WHITESPACE"," ",186],["T_ARRAY","array",186],"(",["T_CONSTANT_ENCAPSED_STRING","'order_id'",186],["T_DOUBLE_ARROW","=>",186],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",186],")",",",["T_WHITESPACE","\n                    ",186],["T_CONSTANT_ENCAPSED_STRING","'created_at'",187],",",["T_WHITESPACE"," ",187],["T_CONSTANT_ENCAPSED_STRING","'updated_at'",187],",",["T_WHITESPACE"," ",187],["T_VARIABLE","$from",187],",",["T_WHITESPACE"," ",187],["T_VARIABLE","$to",187],["T_WHITESPACE","\n                ",187],")",";",["T_WHITESPACE","\n            ",188],"}",["T_WHITESPACE"," ",189],["T_ELSE","else",189],["T_WHITESPACE"," ",189],"{",["T_WHITESPACE","\n                ",189],["T_VARIABLE","$subSelect",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_STRING","null",190],";",["T_WHITESPACE","\n            ",190],"}",["T_WHITESPACE","\n\n            ",191],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","_clearTableByDateRange",193],"(",["T_VARIABLE","$table",193],",",["T_WHITESPACE"," ",193],["T_VARIABLE","$from",193],",",["T_WHITESPACE"," ",193],["T_VARIABLE","$to",193],",",["T_WHITESPACE"," ",193],["T_VARIABLE","$subSelect",193],")",";",["T_WHITESPACE","\n            ",193],["T_COMMENT","\/\/ convert dates from UTC to current admin timezone\n",194],["T_WHITESPACE","            ",195],["T_VARIABLE","$periodExpr",195],["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_VARIABLE","$adapter",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","getDatePartSql",195],"(",["T_WHITESPACE","\n                ",195],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","getStoreTZOffsetQuery",196],"(",["T_WHITESPACE","\n                    ",196],["T_ARRAY","array",197],"(",["T_CONSTANT_ENCAPSED_STRING","'source_table'",197],["T_WHITESPACE"," ",197],["T_DOUBLE_ARROW","=>",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$sourceTable",197],")",",",["T_WHITESPACE","\n                    ",197],["T_CONSTANT_ENCAPSED_STRING","'source_table.created_at'",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$from",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$to",198],["T_WHITESPACE","\n                ",198],")",["T_WHITESPACE","\n            ",199],")",";",["T_WHITESPACE","\n            ",200],["T_VARIABLE","$ifnullBaseShippingCanceled",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_VARIABLE","$adapter",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","getIfNullSql",201],"(",["T_CONSTANT_ENCAPSED_STRING","'order_table.base_shipping_canceled'",201],",",["T_WHITESPACE"," ",201],["T_LNUMBER","0",201],")",";",["T_WHITESPACE","\n            ",201],["T_VARIABLE","$ifnullBaseShippingRefunded",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_VARIABLE","$adapter",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","getIfNullSql",202],"(",["T_CONSTANT_ENCAPSED_STRING","'order_table.base_shipping_refunded'",202],",",["T_WHITESPACE"," ",202],["T_LNUMBER","0",202],")",";",["T_WHITESPACE","\n            ",202],["T_VARIABLE","$columns",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_ARRAY","array",203],"(",["T_WHITESPACE","\n                ",203],["T_CONSTANT_ENCAPSED_STRING","'period'",204],["T_WHITESPACE","                ",204],["T_DOUBLE_ARROW","=>",204],["T_WHITESPACE"," ",204],["T_VARIABLE","$periodExpr",204],",",["T_WHITESPACE","\n                ",204],["T_CONSTANT_ENCAPSED_STRING","'store_id'",205],["T_WHITESPACE","              ",205],["T_DOUBLE_ARROW","=>",205],["T_WHITESPACE"," ",205],["T_CONSTANT_ENCAPSED_STRING","'order_table.store_id'",205],",",["T_WHITESPACE","\n                ",205],["T_CONSTANT_ENCAPSED_STRING","'order_status'",206],["T_WHITESPACE","          ",206],["T_DOUBLE_ARROW","=>",206],["T_WHITESPACE"," ",206],["T_CONSTANT_ENCAPSED_STRING","'order_table.status'",206],",",["T_WHITESPACE","\n                ",206],["T_CONSTANT_ENCAPSED_STRING","'shipping_description'",207],["T_WHITESPACE","  ",207],["T_DOUBLE_ARROW","=>",207],["T_WHITESPACE"," ",207],["T_CONSTANT_ENCAPSED_STRING","'order_table.shipping_description'",207],",",["T_WHITESPACE","\n                ",207],["T_CONSTANT_ENCAPSED_STRING","'orders_count'",208],["T_WHITESPACE","          ",208],["T_DOUBLE_ARROW","=>",208],["T_WHITESPACE"," ",208],["T_NEW","new",208],["T_WHITESPACE"," ",208],["T_STRING","Zend_Db_Expr",208],"(",["T_CONSTANT_ENCAPSED_STRING","'COUNT(order_table.entity_id)'",208],")",",",["T_WHITESPACE","\n                ",208],["T_CONSTANT_ENCAPSED_STRING","'total_shipping'",209],["T_WHITESPACE","        ",209],["T_DOUBLE_ARROW","=>",209],["T_WHITESPACE"," ",209],["T_NEW","new",209],["T_WHITESPACE"," ",209],["T_STRING","Zend_Db_Expr",209],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM((order_table.base_shipping_amount - '",209],["T_WHITESPACE","\n                    ",209],".",["T_WHITESPACE"," ",210],"\"",["T_CURLY_OPEN","{",210],["T_VARIABLE","$ifnullBaseShippingCanceled",210],"}",["T_ENCAPSED_AND_WHITESPACE",") * order_table.base_to_global_rate)",210],"\"",")",",",["T_WHITESPACE","\n                ",210],["T_CONSTANT_ENCAPSED_STRING","'total_shipping_actual'",211],["T_WHITESPACE"," ",211],["T_DOUBLE_ARROW","=>",211],["T_WHITESPACE"," ",211],["T_NEW","new",211],["T_WHITESPACE"," ",211],["T_STRING","Zend_Db_Expr",211],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM((order_table.base_shipping_invoiced - '",211],["T_WHITESPACE","\n                    ",211],".",["T_WHITESPACE"," ",212],"\"",["T_CURLY_OPEN","{",212],["T_VARIABLE","$ifnullBaseShippingRefunded",212],"}",["T_ENCAPSED_AND_WHITESPACE",") * order_table.base_to_global_rate)",212],"\"",")",",",["T_WHITESPACE","\n            ",212],")",";",["T_WHITESPACE","\n\n            ",213],["T_VARIABLE","$select",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_VARIABLE","$adapter",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","select",215],"(",")",";",["T_WHITESPACE","\n            ",215],["T_VARIABLE","$select",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","from",216],"(",["T_ARRAY","array",216],"(",["T_CONSTANT_ENCAPSED_STRING","'source_table'",216],["T_WHITESPACE"," ",216],["T_DOUBLE_ARROW","=>",216],["T_WHITESPACE"," ",216],["T_VARIABLE","$sourceTable",216],")",",",["T_WHITESPACE"," ",216],["T_VARIABLE","$columns",216],")",["T_WHITESPACE","\n                ",216],["T_OBJECT_OPERATOR","->",217],["T_STRING","joinInner",217],"(",["T_WHITESPACE","\n                    ",217],["T_ARRAY","array",218],"(",["T_CONSTANT_ENCAPSED_STRING","'order_table'",218],["T_WHITESPACE"," ",218],["T_DOUBLE_ARROW","=>",218],["T_WHITESPACE"," ",218],["T_VARIABLE","$orderTable",218],")",",",["T_WHITESPACE","\n                    ",218],["T_VARIABLE","$adapter",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","quoteInto",219],"(",["T_WHITESPACE","\n                        ",219],["T_CONSTANT_ENCAPSED_STRING","'source_table.order_id = order_table.entity_id AND order_table.state != ?'",220],",",["T_WHITESPACE","\n                        ",220],["T_STRING","Mage_Sales_Model_Order",221],["T_DOUBLE_COLON","::",221],["T_STRING","STATE_CANCELED",221],")",",",["T_WHITESPACE","\n                    ",221],["T_ARRAY","array",222],"(",")",["T_WHITESPACE","\n                ",222],")",["T_WHITESPACE","\n                ",223],["T_OBJECT_OPERATOR","->",224],["T_STRING","useStraightJoin",224],"(",")",";",["T_WHITESPACE","\n\n            ",224],["T_VARIABLE","$filterSubSelect",226],["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_VARIABLE","$adapter",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","select",226],"(",")",["T_WHITESPACE","\n                ",226],["T_OBJECT_OPERATOR","->",227],["T_STRING","from",227],"(",["T_ARRAY","array",227],"(",["T_CONSTANT_ENCAPSED_STRING","'filter_source_table'",227],["T_WHITESPACE"," ",227],["T_DOUBLE_ARROW","=>",227],["T_WHITESPACE"," ",227],["T_VARIABLE","$sourceTable",227],")",",",["T_WHITESPACE"," ",227],["T_CONSTANT_ENCAPSED_STRING","'MIN(filter_source_table.entity_id)'",227],")",["T_WHITESPACE","\n                ",227],["T_OBJECT_OPERATOR","->",228],["T_STRING","where",228],"(",["T_CONSTANT_ENCAPSED_STRING","'filter_source_table.order_id = source_table.order_id'",228],")",";",["T_WHITESPACE","\n\n            ",228],["T_IF","if",230],["T_WHITESPACE"," ",230],"(",["T_VARIABLE","$subSelect",230],["T_WHITESPACE"," ",230],["T_IS_NOT_IDENTICAL","!==",230],["T_WHITESPACE"," ",230],["T_STRING","null",230],")",["T_WHITESPACE"," ",230],"{",["T_WHITESPACE","\n                ",230],["T_VARIABLE","$select",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","having",231],"(",["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","_makeConditionFromDateRangeSelect",231],"(",["T_VARIABLE","$subSelect",231],",",["T_WHITESPACE"," ",231],["T_CONSTANT_ENCAPSED_STRING","'period'",231],")",")",";",["T_WHITESPACE","\n            ",231],"}",["T_WHITESPACE","\n\n            ",232],["T_VARIABLE","$select",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","where",234],"(",["T_CONSTANT_ENCAPSED_STRING","'source_table.entity_id = (?)'",234],",",["T_WHITESPACE"," ",234],["T_NEW","new",234],["T_WHITESPACE"," ",234],["T_STRING","Zend_Db_Expr",234],"(",["T_VARIABLE","$filterSubSelect",234],")",")",";",["T_WHITESPACE","\n            ",234],["T_UNSET","unset",235],"(",["T_VARIABLE","$filterSubSelect",235],")",";",["T_WHITESPACE","\n\n            ",235],["T_VARIABLE","$select",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","group",237],"(",["T_ARRAY","array",237],"(",["T_WHITESPACE","\n                ",237],["T_VARIABLE","$periodExpr",238],",",["T_WHITESPACE","\n                ",238],["T_CONSTANT_ENCAPSED_STRING","'order_table.store_id'",239],",",["T_WHITESPACE","\n                ",239],["T_CONSTANT_ENCAPSED_STRING","'order_table.status'",240],",",["T_WHITESPACE","\n                ",240],["T_CONSTANT_ENCAPSED_STRING","'order_table.shipping_description'",241],["T_WHITESPACE","\n            ",241],")",")",";",["T_WHITESPACE","\n\n            ",242],["T_VARIABLE","$helper",244],["T_WHITESPACE","        ",244],"=",["T_WHITESPACE"," ",244],["T_STRING","Mage",244],["T_DOUBLE_COLON","::",244],["T_STRING","getResourceHelper",244],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",244],")",";",["T_WHITESPACE","\n            ",244],["T_VARIABLE","$insertQuery",245],["T_WHITESPACE","   ",245],"=",["T_WHITESPACE"," ",245],["T_VARIABLE","$helper",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","getInsertFromSelectUsingAnalytic",245],"(",["T_VARIABLE","$select",245],",",["T_WHITESPACE"," ",245],["T_VARIABLE","$table",245],",",["T_WHITESPACE"," ",245],["T_STRING","array_keys",245],"(",["T_VARIABLE","$columns",245],")",")",";",["T_WHITESPACE","\n            ",245],["T_VARIABLE","$adapter",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","query",246],"(",["T_VARIABLE","$insertQuery",246],")",";",["T_WHITESPACE","\n\n            ",246],["T_VARIABLE","$select",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","reset",248],"(",")",";",["T_WHITESPACE","\n\n            ",248],["T_VARIABLE","$columns",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_ARRAY","array",250],"(",["T_WHITESPACE","\n                ",250],["T_CONSTANT_ENCAPSED_STRING","'period'",251],["T_WHITESPACE","                ",251],["T_DOUBLE_ARROW","=>",251],["T_WHITESPACE"," ",251],["T_CONSTANT_ENCAPSED_STRING","'period'",251],",",["T_WHITESPACE","\n                ",251],["T_CONSTANT_ENCAPSED_STRING","'store_id'",252],["T_WHITESPACE","              ",252],["T_DOUBLE_ARROW","=>",252],["T_WHITESPACE"," ",252],["T_NEW","new",252],["T_WHITESPACE"," ",252],["T_STRING","Zend_Db_Expr",252],"(",["T_STRING","Mage_Core_Model_App",252],["T_DOUBLE_COLON","::",252],["T_STRING","ADMIN_STORE_ID",252],")",",",["T_WHITESPACE","\n                ",252],["T_CONSTANT_ENCAPSED_STRING","'order_status'",253],["T_WHITESPACE","          ",253],["T_DOUBLE_ARROW","=>",253],["T_WHITESPACE"," ",253],["T_CONSTANT_ENCAPSED_STRING","'order_status'",253],",",["T_WHITESPACE","\n                ",253],["T_CONSTANT_ENCAPSED_STRING","'shipping_description'",254],["T_WHITESPACE","  ",254],["T_DOUBLE_ARROW","=>",254],["T_WHITESPACE"," ",254],["T_CONSTANT_ENCAPSED_STRING","'shipping_description'",254],",",["T_WHITESPACE","\n                ",254],["T_CONSTANT_ENCAPSED_STRING","'orders_count'",255],["T_WHITESPACE","          ",255],["T_DOUBLE_ARROW","=>",255],["T_WHITESPACE"," ",255],["T_NEW","new",255],["T_WHITESPACE"," ",255],["T_STRING","Zend_Db_Expr",255],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(orders_count)'",255],")",",",["T_WHITESPACE","\n                ",255],["T_CONSTANT_ENCAPSED_STRING","'total_shipping'",256],["T_WHITESPACE","        ",256],["T_DOUBLE_ARROW","=>",256],["T_WHITESPACE"," ",256],["T_NEW","new",256],["T_WHITESPACE"," ",256],["T_STRING","Zend_Db_Expr",256],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(total_shipping)'",256],")",",",["T_WHITESPACE","\n                ",256],["T_CONSTANT_ENCAPSED_STRING","'total_shipping_actual'",257],["T_WHITESPACE"," ",257],["T_DOUBLE_ARROW","=>",257],["T_WHITESPACE"," ",257],["T_NEW","new",257],["T_WHITESPACE"," ",257],["T_STRING","Zend_Db_Expr",257],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(total_shipping_actual)'",257],")",",",["T_WHITESPACE","\n            ",257],")",";",["T_WHITESPACE","\n\n            ",258],["T_VARIABLE","$select",260],["T_WHITESPACE","\n                ",260],["T_OBJECT_OPERATOR","->",261],["T_STRING","from",261],"(",["T_VARIABLE","$table",261],",",["T_WHITESPACE"," ",261],["T_VARIABLE","$columns",261],")",["T_WHITESPACE","\n                ",261],["T_OBJECT_OPERATOR","->",262],["T_STRING","where",262],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id != ?'",262],",",["T_WHITESPACE"," ",262],["T_LNUMBER","0",262],")",";",["T_WHITESPACE","\n\n            ",262],["T_IF","if",264],["T_WHITESPACE"," ",264],"(",["T_VARIABLE","$subSelect",264],["T_WHITESPACE"," ",264],["T_IS_NOT_IDENTICAL","!==",264],["T_WHITESPACE"," ",264],["T_STRING","null",264],")",["T_WHITESPACE"," ",264],"{",["T_WHITESPACE","\n                ",264],["T_VARIABLE","$select",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","where",265],"(",["T_VARIABLE","$this",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","_makeConditionFromDateRangeSelect",265],"(",["T_VARIABLE","$subSelect",265],",",["T_WHITESPACE"," ",265],["T_CONSTANT_ENCAPSED_STRING","'period'",265],")",")",";",["T_WHITESPACE","\n            ",265],"}",["T_WHITESPACE","\n\n            ",266],["T_VARIABLE","$select",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","group",268],"(",["T_ARRAY","array",268],"(",["T_WHITESPACE","\n                ",268],["T_CONSTANT_ENCAPSED_STRING","'period'",269],",",["T_WHITESPACE","\n                ",269],["T_CONSTANT_ENCAPSED_STRING","'order_status'",270],",",["T_WHITESPACE","\n                ",270],["T_CONSTANT_ENCAPSED_STRING","'shipping_description'",271],["T_WHITESPACE","\n            ",271],")",")",";",["T_WHITESPACE","\n            ",272],["T_VARIABLE","$insertQuery",273],["T_WHITESPACE"," ",273],"=",["T_WHITESPACE"," ",273],["T_VARIABLE","$helper",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","getInsertFromSelectUsingAnalytic",273],"(",["T_VARIABLE","$select",273],",",["T_WHITESPACE"," ",273],["T_VARIABLE","$table",273],",",["T_WHITESPACE"," ",273],["T_STRING","array_keys",273],"(",["T_VARIABLE","$columns",273],")",")",";",["T_WHITESPACE","\n            ",273],["T_VARIABLE","$adapter",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","query",274],"(",["T_VARIABLE","$insertQuery",274],")",";",["T_WHITESPACE","\n        ",274],"}",["T_WHITESPACE"," ",275],["T_CATCH","catch",275],["T_WHITESPACE"," ",275],"(",["T_STRING","Exception",275],["T_WHITESPACE"," ",275],["T_VARIABLE","$e",275],")",["T_WHITESPACE"," ",275],"{",["T_WHITESPACE","\n            ",275],["T_VARIABLE","$adapter",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","rollBack",276],"(",")",";",["T_WHITESPACE","\n            ",276],["T_THROW","throw",277],["T_WHITESPACE"," ",277],["T_VARIABLE","$e",277],";",["T_WHITESPACE","\n        ",277],"}",["T_WHITESPACE","\n\n        ",278],["T_VARIABLE","$adapter",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","commit",280],"(",")",";",["T_WHITESPACE","\n        ",280],["T_RETURN","return",281],["T_WHITESPACE"," ",281],["T_VARIABLE","$this",281],";",["T_WHITESPACE","\n    ",281],"}",["T_WHITESPACE","\n",282],"}",["T_WHITESPACE","\n",283]]