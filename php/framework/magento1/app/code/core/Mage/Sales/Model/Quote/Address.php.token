[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Sales\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Sales Quote address model\n *\n * @method Mage_Sales_Model_Resource_Quote_Address _getResource()\n * @method Mage_Sales_Model_Resource_Quote_Address getResource()\n * @method int getQuoteId()\n * @method Mage_Sales_Model_Quote_Address setQuoteId(int $value)\n * @method string getCreatedAt()\n * @method Mage_Sales_Model_Quote_Address setCreatedAt(string $value)\n * @method string getUpdatedAt()\n * @method Mage_Sales_Model_Quote_Address setUpdatedAt(string $value)\n * @method int getCustomerId()\n * @method Mage_Sales_Model_Quote_Address setCustomerId(int $value)\n * @method int getSaveInAddressBook()\n * @method Mage_Sales_Model_Quote_Address setSaveInAddressBook(int $value)\n * @method int getCustomerAddressId()\n * @method Mage_Sales_Model_Quote_Address setCustomerAddressId(int $value)\n * @method string getAddressType()\n * @method Mage_Sales_Model_Quote_Address setAddressType(string $value)\n * @method string getEmail()\n * @method Mage_Sales_Model_Quote_Address setEmail(string $value)\n * @method string getPrefix()\n * @method Mage_Sales_Model_Quote_Address setPrefix(string $value)\n * @method string getFirstname()\n * @method Mage_Sales_Model_Quote_Address setFirstname(string $value)\n * @method string getMiddlename()\n * @method Mage_Sales_Model_Quote_Address setMiddlename(string $value)\n * @method string getLastname()\n * @method Mage_Sales_Model_Quote_Address setLastname(string $value)\n * @method string getSuffix()\n * @method Mage_Sales_Model_Quote_Address setSuffix(string $value)\n * @method string getCompany()\n * @method Mage_Sales_Model_Quote_Address setCompany(string $value)\n * @method string getCity()\n * @method Mage_Sales_Model_Quote_Address setCity(string $value)\n * @method Mage_Sales_Model_Quote_Address setRegion(string $value)\n * @method Mage_Sales_Model_Quote_Address setRegionId(int $value)\n * @method string getPostcode()\n * @method Mage_Sales_Model_Quote_Address setPostcode(string $value)\n * @method string getCountryId()\n * @method Mage_Sales_Model_Quote_Address setCountryId(string $value)\n * @method string getTelephone()\n * @method Mage_Sales_Model_Quote_Address setTelephone(string $value)\n * @method string getFax()\n * @method Mage_Sales_Model_Quote_Address setFax(string $value)\n * @method int getSameAsBilling()\n * @method Mage_Sales_Model_Quote_Address setSameAsBilling(int $value)\n * @method int getFreeShipping()\n * @method Mage_Sales_Model_Quote_Address setFreeShipping(int $value)\n * @method int getCollectShippingRates()\n * @method Mage_Sales_Model_Quote_Address setCollectShippingRates(int $value)\n * @method string getShippingMethod()\n * @method Mage_Sales_Model_Quote_Address setShippingMethod(string $value)\n * @method string getShippingDescription()\n * @method Mage_Sales_Model_Quote_Address setShippingDescription(string $value)\n * @method float getWeight()\n * @method Mage_Sales_Model_Quote_Address setWeight(float $value)\n * @method float getSubtotal()\n * @method Mage_Sales_Model_Quote_Address setSubtotal(float $value)\n * @method float getBaseSubtotal()\n * @method Mage_Sales_Model_Quote_Address setBaseSubtotal(float $value)\n * @method Mage_Sales_Model_Quote_Address setSubtotalWithDiscount(float $value)\n * @method Mage_Sales_Model_Quote_Address setBaseSubtotalWithDiscount(float $value)\n * @method float getTaxAmount()\n * @method Mage_Sales_Model_Quote_Address setTaxAmount(float $value)\n * @method float getBaseTaxAmount()\n * @method Mage_Sales_Model_Quote_Address setBaseTaxAmount(float $value)\n * @method float getShippingAmount()\n * @method float getBaseShippingAmount()\n * @method float getShippingTaxAmount()\n * @method Mage_Sales_Model_Quote_Address setShippingTaxAmount(float $value)\n * @method float getBaseShippingTaxAmount()\n * @method Mage_Sales_Model_Quote_Address setBaseShippingTaxAmount(float $value)\n * @method float getDiscountAmount()\n * @method Mage_Sales_Model_Quote_Address setDiscountAmount(float $value)\n * @method float getBaseDiscountAmount()\n * @method Mage_Sales_Model_Quote_Address setBaseDiscountAmount(float $value)\n * @method float getGrandTotal()\n * @method Mage_Sales_Model_Quote_Address setGrandTotal(float $value)\n * @method float getBaseGrandTotal()\n * @method Mage_Sales_Model_Quote_Address setBaseGrandTotal(float $value)\n * @method string getCustomerNotes()\n * @method Mage_Sales_Model_Quote_Address setCustomerNotes(string $value)\n * @method string getDiscountDescription()\n * @method Mage_Sales_Model_Quote_Address setDiscountDescription(string $value)\n * @method null|array getDiscountDescriptionArray()\n * @method Mage_Sales_Model_Quote_Address setDiscountDescriptionArray(array $value)\n * @method float getShippingDiscountAmount()\n * @method Mage_Sales_Model_Quote_Address setShippingDiscountAmount(float $value)\n * @method float getBaseShippingDiscountAmount()\n * @method Mage_Sales_Model_Quote_Address setBaseShippingDiscountAmount(float $value)\n * @method float getSubtotalInclTax()\n * @method Mage_Sales_Model_Quote_Address setSubtotalInclTax(float $value)\n * @method float getBaseSubtotalTotalInclTax()\n * @method Mage_Sales_Model_Quote_Address setBaseSubtotalTotalInclTax(float $value)\n * @method int getGiftMessageId()\n * @method Mage_Sales_Model_Quote_Address setGiftMessageId(int $value)\n * @method float getHiddenTaxAmount()\n * @method Mage_Sales_Model_Quote_Address setHiddenTaxAmount(float $value)\n * @method float getBaseHiddenTaxAmount()\n * @method Mage_Sales_Model_Quote_Address setBaseHiddenTaxAmount(float $value)\n * @method float getShippingHiddenTaxAmount()\n * @method Mage_Sales_Model_Quote_Address setShippingHiddenTaxAmount(float $value)\n * @method float getBaseShippingHiddenTaxAmount()\n * @method Mage_Sales_Model_Quote_Address setBaseShippingHiddenTaxAmount(float $value)\n * @method float getShippingInclTax()\n * @method Mage_Sales_Model_Quote_Address setShippingInclTax(float $value)\n * @method float getBaseShippingInclTax()\n * @method Mage_Sales_Model_Quote_Address setBaseShippingInclTax(float $value)\n *\n * @category    Mage\n * @package     Mage_Sales\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",141],["T_CLASS","class",142],["T_WHITESPACE"," ",142],["T_STRING","Mage_Sales_Model_Quote_Address",142],["T_WHITESPACE"," ",142],["T_EXTENDS","extends",142],["T_WHITESPACE"," ",142],["T_STRING","Mage_Customer_Model_Address_Abstract",142],["T_WHITESPACE","\n",142],"{",["T_WHITESPACE","\n    ",143],["T_DOC_COMMENT","\/**\n     * Default value for Destination street\n     *\/",144],["T_WHITESPACE","\n    ",146],["T_CONST","const",147],["T_WHITESPACE"," ",147],["T_STRING","DEFAULT_DEST_STREET",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],"-",["T_LNUMBER","1",147],";",["T_WHITESPACE","\n\n    ",147],["T_DOC_COMMENT","\/**\n     * Prefix of model events\n     *\n     * @var string\n     *\/",149],["T_WHITESPACE","\n    ",153],["T_PROTECTED","protected",154],["T_WHITESPACE"," ",154],["T_VARIABLE","$_eventPrefix",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_CONSTANT_ENCAPSED_STRING","'sales_quote_address'",154],";",["T_WHITESPACE","\n\n    ",154],["T_DOC_COMMENT","\/**\n     * Name of event object\n     *\n     * @var string\n     *\/",156],["T_WHITESPACE","\n    ",160],["T_PROTECTED","protected",161],["T_WHITESPACE"," ",161],["T_VARIABLE","$_eventObject",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_CONSTANT_ENCAPSED_STRING","'quote_address'",161],";",["T_WHITESPACE","\n\n    ",161],["T_DOC_COMMENT","\/**\n     * Quote object\n     *\n     * @var Mage_Sales_Model_Quote\n     *\/",163],["T_WHITESPACE","\n    ",167],["T_PROTECTED","protected",168],["T_WHITESPACE"," ",168],["T_VARIABLE","$_items",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_STRING","null",168],";",["T_WHITESPACE","\n\n    ",168],["T_DOC_COMMENT","\/**\n     * Quote object\n     *\n     * @var Mage_Sales_Model_Quote\n     *\/",170],["T_WHITESPACE","\n    ",174],["T_PROTECTED","protected",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$_quote",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_STRING","null",175],";",["T_WHITESPACE","\n\n    ",175],["T_DOC_COMMENT","\/**\n     * Sales Quote address rates\n     *\n     * @var Mage_Sales_Model_Quote_Address_Rate\n     *\/",177],["T_WHITESPACE","\n    ",181],["T_PROTECTED","protected",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$_rates",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_STRING","null",182],";",["T_WHITESPACE","\n\n    ",182],["T_DOC_COMMENT","\/**\n     * Total models collector\n     *\n     * @var Mage_Sales_Model_Quote_Address_Total_Collector\n     *\/",184],["T_WHITESPACE","\n    ",188],["T_PROTECTED","protected",189],["T_WHITESPACE"," ",189],["T_VARIABLE","$_totalCollector",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_STRING","null",189],";",["T_WHITESPACE","\n\n    ",189],["T_DOC_COMMENT","\/**\n     * Total data as array\n     *\n     * @var array\n     *\/",191],["T_WHITESPACE","\n    ",195],["T_PROTECTED","protected",196],["T_WHITESPACE"," ",196],["T_VARIABLE","$_totals",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_ARRAY","array",196],"(",")",";",["T_WHITESPACE","\n\n    ",196],["T_DOC_COMMENT","\/**\n     * Total amounts\n     *\n     * @var array\n     *\/",198],["T_WHITESPACE","\n    ",202],["T_PROTECTED","protected",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$_totalAmounts",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_ARRAY","array",203],"(",")",";",["T_WHITESPACE","\n\n    ",203],["T_DOC_COMMENT","\/**\n     * Total base amounts\n     *\n     * @var array\n     *\/",205],["T_WHITESPACE","\n    ",209],["T_PROTECTED","protected",210],["T_WHITESPACE"," ",210],["T_VARIABLE","$_baseTotalAmounts",210],["T_WHITESPACE"," ",210],"=",["T_WHITESPACE"," ",210],["T_ARRAY","array",210],"(",")",";",["T_WHITESPACE","\n\n    ",210],["T_DOC_COMMENT","\/**\n     * Whether to segregate by nominal items only\n     *\n     * @var bool\n     *\/",212],["T_WHITESPACE","\n    ",216],["T_PROTECTED","protected",217],["T_WHITESPACE"," ",217],["T_VARIABLE","$_nominalOnly",217],["T_WHITESPACE"," ",217],"=",["T_WHITESPACE"," ",217],["T_STRING","null",217],";",["T_WHITESPACE","\n\n    ",217],["T_DOC_COMMENT","\/**\n     * Initialize resource\n     *\/",219],["T_WHITESPACE","\n    ",221],["T_PROTECTED","protected",222],["T_WHITESPACE"," ",222],["T_FUNCTION","function",222],["T_WHITESPACE"," ",222],["T_STRING","_construct",222],"(",")",["T_WHITESPACE","\n    ",222],"{",["T_WHITESPACE","\n        ",223],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","_init",224],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/quote_address'",224],")",";",["T_WHITESPACE","\n    ",224],"}",["T_WHITESPACE","\n\n    ",225],["T_DOC_COMMENT","\/**\n     * Init mapping array of short fields to its full names\n     *\n     * @return Mage_Sales_Model_Quote_Address\n     *\/",227],["T_WHITESPACE","\n    ",231],["T_PROTECTED","protected",232],["T_WHITESPACE"," ",232],["T_FUNCTION","function",232],["T_WHITESPACE"," ",232],["T_STRING","_initOldFieldsMap",232],"(",")",["T_WHITESPACE","\n    ",232],"{",["T_WHITESPACE","\n        ",233],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","_oldFieldsMap",234],["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_STRING","Mage",234],["T_DOUBLE_COLON","::",234],["T_STRING","helper",234],"(",["T_CONSTANT_ENCAPSED_STRING","'sales'",234],")",["T_OBJECT_OPERATOR","->",234],["T_STRING","getOldFieldMap",234],"(",["T_CONSTANT_ENCAPSED_STRING","'quote_address'",234],")",";",["T_WHITESPACE","\n        ",234],["T_RETURN","return",235],["T_WHITESPACE"," ",235],["T_VARIABLE","$this",235],";",["T_WHITESPACE","\n    ",235],"}",["T_WHITESPACE","\n\n    ",236],["T_DOC_COMMENT","\/**\n     * Initialize Quote identifier before save\n     *\n     * @return Mage_Sales_Model_Quote_Address\n     *\/",238],["T_WHITESPACE","\n    ",242],["T_PROTECTED","protected",243],["T_WHITESPACE"," ",243],["T_FUNCTION","function",243],["T_WHITESPACE"," ",243],["T_STRING","_beforeSave",243],"(",")",["T_WHITESPACE","\n    ",243],"{",["T_WHITESPACE","\n        ",244],["T_STRING","parent",245],["T_DOUBLE_COLON","::",245],["T_STRING","_beforeSave",245],"(",")",";",["T_WHITESPACE","\n        ",245],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","_populateBeforeSaveData",246],"(",")",";",["T_WHITESPACE","\n        ",246],["T_RETURN","return",247],["T_WHITESPACE"," ",247],["T_VARIABLE","$this",247],";",["T_WHITESPACE","\n    ",247],"}",["T_WHITESPACE","\n\n    ",248],["T_DOC_COMMENT","\/**\n     * Set the required fields\n     *\/",250],["T_WHITESPACE","\n    ",252],["T_PROTECTED","protected",253],["T_WHITESPACE"," ",253],["T_FUNCTION","function",253],["T_WHITESPACE"," ",253],["T_STRING","_populateBeforeSaveData",253],"(",")",["T_WHITESPACE","\n    ",253],"{",["T_WHITESPACE","\n        ",254],["T_IF","if",255],["T_WHITESPACE"," ",255],"(",["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","getQuote",255],"(",")",")",["T_WHITESPACE"," ",255],"{",["T_WHITESPACE","\n            ",255],["T_VARIABLE","$this",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","_dataSaveAllowed",256],["T_WHITESPACE"," ",256],"=",["T_WHITESPACE"," ",256],["T_BOOL_CAST","(bool)",256],["T_VARIABLE","$this",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","getQuote",256],"(",")",["T_OBJECT_OPERATOR","->",256],["T_STRING","getId",256],"(",")",";",["T_WHITESPACE","\n\n            ",256],["T_IF","if",258],["T_WHITESPACE"," ",258],"(",["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","getQuote",258],"(",")",["T_OBJECT_OPERATOR","->",258],["T_STRING","getId",258],"(",")",")",["T_WHITESPACE"," ",258],"{",["T_WHITESPACE","\n                ",258],["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","setQuoteId",259],"(",["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","getQuote",259],"(",")",["T_OBJECT_OPERATOR","->",259],["T_STRING","getId",259],"(",")",")",";",["T_WHITESPACE","\n            ",259],"}",["T_WHITESPACE","\n            ",260],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","setCustomerId",261],"(",["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","getQuote",261],"(",")",["T_OBJECT_OPERATOR","->",261],["T_STRING","getCustomerId",261],"(",")",")",";",["T_WHITESPACE","\n\n            ",261],["T_DOC_COMMENT","\/**\n             * Init customer address id if customer address is assigned\n             *\/",263],["T_WHITESPACE","\n            ",265],["T_IF","if",266],["T_WHITESPACE"," ",266],"(",["T_VARIABLE","$this",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","getCustomerAddress",266],"(",")",")",["T_WHITESPACE"," ",266],"{",["T_WHITESPACE","\n                ",266],["T_VARIABLE","$this",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","setCustomerAddressId",267],"(",["T_VARIABLE","$this",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","getCustomerAddress",267],"(",")",["T_OBJECT_OPERATOR","->",267],["T_STRING","getId",267],"(",")",")",";",["T_WHITESPACE","\n            ",267],"}",["T_WHITESPACE","\n\n            ",268],["T_DOC_COMMENT","\/**\n             * Set same_as_billing to \"1\" when default shipping address is set as default\n             * and it is not equal billing address\n             *\/",270],["T_WHITESPACE","\n            ",273],["T_IF","if",274],["T_WHITESPACE"," ",274],"(","!",["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","getId",274],"(",")",")",["T_WHITESPACE"," ",274],"{",["T_WHITESPACE","\n                ",274],["T_VARIABLE","$this",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","setSameAsBilling",275],"(",["T_INT_CAST","(int)",275],["T_VARIABLE","$this",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","_isSameAsBilling",275],"(",")",")",";",["T_WHITESPACE","\n            ",275],"}",["T_WHITESPACE","\n        ",276],"}",["T_WHITESPACE","\n    ",277],"}",["T_WHITESPACE","\n\n    ",278],["T_DOC_COMMENT","\/**\n     * Returns true if the billing address is same as the shipping\n     *\n     * @return bool\n     *\/",280],["T_WHITESPACE","\n    ",284],["T_PROTECTED","protected",285],["T_WHITESPACE"," ",285],["T_FUNCTION","function",285],["T_WHITESPACE"," ",285],["T_STRING","_isSameAsBilling",285],"(",")",["T_WHITESPACE","\n    ",285],"{",["T_WHITESPACE","\n        ",286],["T_RETURN","return",287],["T_WHITESPACE"," ",287],"(",["T_VARIABLE","$this",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","getAddressType",287],"(",")",["T_WHITESPACE"," ",287],["T_IS_EQUAL","==",287],["T_WHITESPACE"," ",287],["T_STRING","Mage_Sales_Model_Quote_Address",287],["T_DOUBLE_COLON","::",287],["T_STRING","TYPE_SHIPPING",287],["T_WHITESPACE","\n            ",287],["T_BOOLEAN_AND","&&",288],["T_WHITESPACE"," ",288],"(",["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","_isNotRegisteredCustomer",288],"(",")",["T_WHITESPACE"," ",288],["T_BOOLEAN_OR","||",288],["T_WHITESPACE"," ",288],["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","_isDefaultShippingNullOrSameAsBillingAddress",288],"(",")",")",")",";",["T_WHITESPACE","\n    ",288],"}",["T_WHITESPACE","\n\n    ",289],["T_DOC_COMMENT","\/**\n     * Checks if the user is a registered customer\n     *\n     * @return bool\n     *\/",291],["T_WHITESPACE","\n    ",295],["T_PROTECTED","protected",296],["T_WHITESPACE"," ",296],["T_FUNCTION","function",296],["T_WHITESPACE"," ",296],["T_STRING","_isNotRegisteredCustomer",296],"(",")",["T_WHITESPACE","\n    ",296],"{",["T_WHITESPACE","\n        ",297],["T_RETURN","return",298],["T_WHITESPACE"," ",298],"!",["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","getQuote",298],"(",")",["T_OBJECT_OPERATOR","->",298],["T_STRING","getCustomerId",298],"(",")",["T_WHITESPACE"," ",298],["T_BOOLEAN_OR","||",298],["T_WHITESPACE"," ",298],["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","getCustomerAddressId",298],"(",")",["T_WHITESPACE"," ",298],["T_IS_IDENTICAL","===",298],["T_WHITESPACE"," ",298],["T_STRING","null",298],";",["T_WHITESPACE","\n    ",298],"}",["T_WHITESPACE","\n\n    ",299],["T_DOC_COMMENT","\/**\n     * Returns true if the def billing address is same as customer address\n     *\n     * @return bool\n     *\/",301],["T_WHITESPACE","\n    ",305],["T_PROTECTED","protected",306],["T_WHITESPACE"," ",306],["T_FUNCTION","function",306],["T_WHITESPACE"," ",306],["T_STRING","_isDefaultShippingNullOrSameAsBillingAddress",306],"(",")",["T_WHITESPACE","\n    ",306],"{",["T_WHITESPACE","\n        ",307],["T_VARIABLE","$customer",308],["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],["T_VARIABLE","$this",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","getQuote",308],"(",")",["T_OBJECT_OPERATOR","->",308],["T_STRING","getCustomer",308],"(",")",";",["T_WHITESPACE","\n        ",308],["T_RETURN","return",309],["T_WHITESPACE"," ",309],"!",["T_VARIABLE","$customer",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","getDefaultShippingAddress",309],"(",")",["T_WHITESPACE","\n            ",309],["T_BOOLEAN_OR","||",310],["T_WHITESPACE"," ",310],["T_VARIABLE","$customer",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","getDefaultBillingAddress",310],"(",")",["T_WHITESPACE"," ",310],["T_BOOLEAN_AND","&&",310],["T_WHITESPACE"," ",310],["T_VARIABLE","$customer",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","getDefaultShippingAddress",310],"(",")",["T_WHITESPACE","\n                ",310],["T_BOOLEAN_AND","&&",311],["T_WHITESPACE"," ",311],["T_VARIABLE","$customer",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","getDefaultBillingAddress",311],"(",")",["T_OBJECT_OPERATOR","->",311],["T_STRING","getId",311],"(",")",["T_WHITESPACE"," ",311],["T_IS_EQUAL","==",311],["T_WHITESPACE"," ",311],["T_VARIABLE","$customer",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","getDefaultShippingAddress",311],"(",")",["T_OBJECT_OPERATOR","->",311],["T_STRING","getId",311],"(",")",";",["T_WHITESPACE","\n    ",311],"}",["T_WHITESPACE","\n\n    ",312],["T_DOC_COMMENT","\/**\n     * Save child collections\n     *\n     * @return Mage_Sales_Model_Quote_Address\n     *\/",314],["T_WHITESPACE","\n    ",318],["T_PROTECTED","protected",319],["T_WHITESPACE"," ",319],["T_FUNCTION","function",319],["T_WHITESPACE"," ",319],["T_STRING","_afterSave",319],"(",")",["T_WHITESPACE","\n    ",319],"{",["T_WHITESPACE","\n        ",320],["T_STRING","parent",321],["T_DOUBLE_COLON","::",321],["T_STRING","_afterSave",321],"(",")",";",["T_WHITESPACE","\n        ",321],["T_IF","if",322],["T_WHITESPACE"," ",322],"(",["T_STRING","null",322],["T_WHITESPACE"," ",322],["T_IS_NOT_IDENTICAL","!==",322],["T_WHITESPACE"," ",322],["T_VARIABLE","$this",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","_items",322],")",["T_WHITESPACE"," ",322],"{",["T_WHITESPACE","\n            ",322],["T_VARIABLE","$this",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","getItemsCollection",323],"(",")",["T_OBJECT_OPERATOR","->",323],["T_STRING","save",323],"(",")",";",["T_WHITESPACE","\n        ",323],"}",["T_WHITESPACE","\n        ",324],["T_IF","if",325],["T_WHITESPACE"," ",325],"(",["T_STRING","null",325],["T_WHITESPACE"," ",325],["T_IS_NOT_IDENTICAL","!==",325],["T_WHITESPACE"," ",325],["T_VARIABLE","$this",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","_rates",325],")",["T_WHITESPACE"," ",325],"{",["T_WHITESPACE","\n            ",325],["T_VARIABLE","$this",326],["T_OBJECT_OPERATOR","->",326],["T_STRING","getShippingRatesCollection",326],"(",")",["T_OBJECT_OPERATOR","->",326],["T_STRING","save",326],"(",")",";",["T_WHITESPACE","\n        ",326],"}",["T_WHITESPACE","\n        ",327],["T_RETURN","return",328],["T_WHITESPACE"," ",328],["T_VARIABLE","$this",328],";",["T_WHITESPACE","\n    ",328],"}",["T_WHITESPACE","\n\n    ",329],["T_DOC_COMMENT","\/**\n     * Declare adress quote model object\n     *\n     * @param   Mage_Sales_Model_Quote $quote\n     * @return  Mage_Sales_Model_Quote_Address\n     *\/",331],["T_WHITESPACE","\n    ",336],["T_PUBLIC","public",337],["T_WHITESPACE"," ",337],["T_FUNCTION","function",337],["T_WHITESPACE"," ",337],["T_STRING","setQuote",337],"(",["T_STRING","Mage_Sales_Model_Quote",337],["T_WHITESPACE"," ",337],["T_VARIABLE","$quote",337],")",["T_WHITESPACE","\n    ",337],"{",["T_WHITESPACE","\n        ",338],["T_VARIABLE","$this",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","_quote",339],["T_WHITESPACE"," ",339],"=",["T_WHITESPACE"," ",339],["T_VARIABLE","$quote",339],";",["T_WHITESPACE","\n        ",339],["T_VARIABLE","$this",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","setQuoteId",340],"(",["T_VARIABLE","$quote",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","getId",340],"(",")",")",";",["T_WHITESPACE","\n        ",340],["T_RETURN","return",341],["T_WHITESPACE"," ",341],["T_VARIABLE","$this",341],";",["T_WHITESPACE","\n    ",341],"}",["T_WHITESPACE","\n\n    ",342],["T_DOC_COMMENT","\/**\n     * Retrieve quote object\n     *\n     * @return Mage_Sales_Model_Quote\n     *\/",344],["T_WHITESPACE","\n    ",348],["T_PUBLIC","public",349],["T_WHITESPACE"," ",349],["T_FUNCTION","function",349],["T_WHITESPACE"," ",349],["T_STRING","getQuote",349],"(",")",["T_WHITESPACE","\n    ",349],"{",["T_WHITESPACE","\n        ",350],["T_RETURN","return",351],["T_WHITESPACE"," ",351],["T_VARIABLE","$this",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","_quote",351],";",["T_WHITESPACE","\n    ",351],"}",["T_WHITESPACE","\n\n    ",352],["T_DOC_COMMENT","\/**\n     * Import quote address data from customer address object\n     *\n     * @param   Mage_Customer_Model_Address $address\n     * @return  Mage_Sales_Model_Quote_Address\n     *\/",354],["T_WHITESPACE","\n    ",359],["T_PUBLIC","public",360],["T_WHITESPACE"," ",360],["T_FUNCTION","function",360],["T_WHITESPACE"," ",360],["T_STRING","importCustomerAddress",360],"(",["T_STRING","Mage_Customer_Model_Address",360],["T_WHITESPACE"," ",360],["T_VARIABLE","$address",360],")",["T_WHITESPACE","\n    ",360],"{",["T_WHITESPACE","\n        ",361],["T_STRING","Mage",362],["T_DOUBLE_COLON","::",362],["T_STRING","helper",362],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",362],")",["T_OBJECT_OPERATOR","->",362],["T_STRING","copyFieldset",362],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_address'",362],",",["T_WHITESPACE"," ",362],["T_CONSTANT_ENCAPSED_STRING","'to_quote_address'",362],",",["T_WHITESPACE"," ",362],["T_VARIABLE","$address",362],",",["T_WHITESPACE"," ",362],["T_VARIABLE","$this",362],")",";",["T_WHITESPACE","\n        ",362],["T_VARIABLE","$email",363],["T_WHITESPACE"," ",363],"=",["T_WHITESPACE"," ",363],["T_STRING","null",363],";",["T_WHITESPACE","\n        ",363],["T_IF","if",364],["T_WHITESPACE"," ",364],"(",["T_VARIABLE","$address",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","hasEmail",364],"(",")",")",["T_WHITESPACE"," ",364],"{",["T_WHITESPACE","\n            ",364],["T_VARIABLE","$email",365],["T_WHITESPACE"," ",365],"=",["T_WHITESPACE"," ",365],["T_VARIABLE","$address",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","getEmail",365],"(",")",";",["T_WHITESPACE","\n        ",365],"}",["T_WHITESPACE"," ",366],["T_ELSEIF","elseif",366],["T_WHITESPACE"," ",366],"(",["T_VARIABLE","$address",366],["T_OBJECT_OPERATOR","->",366],["T_STRING","getCustomer",366],"(",")",")",["T_WHITESPACE"," ",366],"{",["T_WHITESPACE","\n            ",366],["T_VARIABLE","$email",367],["T_WHITESPACE"," ",367],"=",["T_WHITESPACE"," ",367],["T_VARIABLE","$address",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","getCustomer",367],"(",")",["T_OBJECT_OPERATOR","->",367],["T_STRING","getEmail",367],"(",")",";",["T_WHITESPACE","\n        ",367],"}",["T_WHITESPACE","\n        ",368],["T_IF","if",369],["T_WHITESPACE"," ",369],"(",["T_VARIABLE","$email",369],")",["T_WHITESPACE"," ",369],"{",["T_WHITESPACE","\n            ",369],["T_VARIABLE","$this",370],["T_OBJECT_OPERATOR","->",370],["T_STRING","setEmail",370],"(",["T_VARIABLE","$email",370],")",";",["T_WHITESPACE","\n        ",370],"}",["T_WHITESPACE","\n        ",371],["T_RETURN","return",372],["T_WHITESPACE"," ",372],["T_VARIABLE","$this",372],";",["T_WHITESPACE","\n    ",372],"}",["T_WHITESPACE","\n\n    ",373],["T_DOC_COMMENT","\/**\n     * Export data to customer address object\n     *\n     * @return Mage_Customer_Model_Address\n     *\/",375],["T_WHITESPACE","\n    ",379],["T_PUBLIC","public",380],["T_WHITESPACE"," ",380],["T_FUNCTION","function",380],["T_WHITESPACE"," ",380],["T_STRING","exportCustomerAddress",380],"(",")",["T_WHITESPACE","\n    ",380],"{",["T_WHITESPACE","\n        ",381],["T_VARIABLE","$address",382],["T_WHITESPACE"," ",382],"=",["T_WHITESPACE"," ",382],["T_STRING","Mage",382],["T_DOUBLE_COLON","::",382],["T_STRING","getModel",382],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/address'",382],")",";",["T_WHITESPACE","\n        ",382],["T_STRING","Mage",383],["T_DOUBLE_COLON","::",383],["T_STRING","helper",383],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",383],")",["T_OBJECT_OPERATOR","->",383],["T_STRING","copyFieldset",383],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_convert_quote_address'",383],",",["T_WHITESPACE"," ",383],["T_CONSTANT_ENCAPSED_STRING","'to_customer_address'",383],",",["T_WHITESPACE"," ",383],["T_VARIABLE","$this",383],",",["T_WHITESPACE"," ",383],["T_VARIABLE","$address",383],")",";",["T_WHITESPACE","\n        ",383],["T_RETURN","return",384],["T_WHITESPACE"," ",384],["T_VARIABLE","$address",384],";",["T_WHITESPACE","\n    ",384],"}",["T_WHITESPACE","\n\n    ",385],["T_DOC_COMMENT","\/**\n     * Import address data from order address\n     *\n     * @param   Mage_Sales_Model_Order_Address $address\n     * @return  Mage_Sales_Model_Quote_Address\n     *\/",387],["T_WHITESPACE","\n    ",392],["T_PUBLIC","public",393],["T_WHITESPACE"," ",393],["T_FUNCTION","function",393],["T_WHITESPACE"," ",393],["T_STRING","importOrderAddress",393],"(",["T_STRING","Mage_Sales_Model_Order_Address",393],["T_WHITESPACE"," ",393],["T_VARIABLE","$address",393],")",["T_WHITESPACE","\n    ",393],"{",["T_WHITESPACE","\n        ",394],["T_VARIABLE","$this",395],["T_OBJECT_OPERATOR","->",395],["T_STRING","setAddressType",395],"(",["T_VARIABLE","$address",395],["T_OBJECT_OPERATOR","->",395],["T_STRING","getAddressType",395],"(",")",")",["T_WHITESPACE","\n            ",395],["T_OBJECT_OPERATOR","->",396],["T_STRING","setCustomerId",396],"(",["T_VARIABLE","$address",396],["T_OBJECT_OPERATOR","->",396],["T_STRING","getCustomerId",396],"(",")",")",["T_WHITESPACE","\n            ",396],["T_OBJECT_OPERATOR","->",397],["T_STRING","setCustomerAddressId",397],"(",["T_VARIABLE","$address",397],["T_OBJECT_OPERATOR","->",397],["T_STRING","getCustomerAddressId",397],"(",")",")",["T_WHITESPACE","\n            ",397],["T_OBJECT_OPERATOR","->",398],["T_STRING","setEmail",398],"(",["T_VARIABLE","$address",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","getEmail",398],"(",")",")",";",["T_WHITESPACE","\n\n        ",398],["T_STRING","Mage",400],["T_DOUBLE_COLON","::",400],["T_STRING","helper",400],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",400],")",["T_OBJECT_OPERATOR","->",400],["T_STRING","copyFieldset",400],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_convert_order_address'",400],",",["T_WHITESPACE"," ",400],["T_CONSTANT_ENCAPSED_STRING","'to_quote_address'",400],",",["T_WHITESPACE"," ",400],["T_VARIABLE","$address",400],",",["T_WHITESPACE"," ",400],["T_VARIABLE","$this",400],")",";",["T_WHITESPACE","\n\n        ",400],["T_RETURN","return",402],["T_WHITESPACE"," ",402],["T_VARIABLE","$this",402],";",["T_WHITESPACE","\n    ",402],"}",["T_WHITESPACE","\n\n    ",403],["T_DOC_COMMENT","\/**\n     * Convert object to array\n     *\n     * @param   array $arrAttributes\n     * @return  array\n     *\/",405],["T_WHITESPACE","\n    ",410],["T_PUBLIC","public",411],["T_WHITESPACE"," ",411],["T_FUNCTION","function",411],["T_WHITESPACE"," ",411],["T_STRING","toArray",411],"(",["T_ARRAY","array",411],["T_WHITESPACE"," ",411],["T_VARIABLE","$arrAttributes",411],["T_WHITESPACE"," ",411],"=",["T_WHITESPACE"," ",411],["T_ARRAY","array",411],"(",")",")",["T_WHITESPACE","\n    ",411],"{",["T_WHITESPACE","\n        ",412],["T_VARIABLE","$arr",413],["T_WHITESPACE"," ",413],"=",["T_WHITESPACE"," ",413],["T_STRING","parent",413],["T_DOUBLE_COLON","::",413],["T_STRING","toArray",413],"(",["T_VARIABLE","$arrAttributes",413],")",";",["T_WHITESPACE","\n        ",413],["T_VARIABLE","$arr",414],"[",["T_CONSTANT_ENCAPSED_STRING","'rates'",414],"]",["T_WHITESPACE"," ",414],"=",["T_WHITESPACE"," ",414],["T_VARIABLE","$this",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","getShippingRatesCollection",414],"(",")",["T_OBJECT_OPERATOR","->",414],["T_STRING","toArray",414],"(",["T_VARIABLE","$arrAttributes",414],")",";",["T_WHITESPACE","\n        ",414],["T_VARIABLE","$arr",415],"[",["T_CONSTANT_ENCAPSED_STRING","'items'",415],"]",["T_WHITESPACE"," ",415],"=",["T_WHITESPACE"," ",415],["T_VARIABLE","$this",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","getItemsCollection",415],"(",")",["T_OBJECT_OPERATOR","->",415],["T_STRING","toArray",415],"(",["T_VARIABLE","$arrAttributes",415],")",";",["T_WHITESPACE","\n        ",415],["T_FOREACH","foreach",416],["T_WHITESPACE"," ",416],"(",["T_VARIABLE","$this",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","getTotals",416],"(",")",["T_WHITESPACE"," ",416],["T_AS","as",416],["T_WHITESPACE"," ",416],["T_VARIABLE","$k",416],["T_WHITESPACE"," ",416],["T_DOUBLE_ARROW","=>",416],["T_WHITESPACE"," ",416],["T_VARIABLE","$total",416],")",["T_WHITESPACE"," ",416],"{",["T_WHITESPACE","\n            ",416],["T_VARIABLE","$arr",417],"[",["T_CONSTANT_ENCAPSED_STRING","'totals'",417],"]","[",["T_VARIABLE","$k",417],"]",["T_WHITESPACE"," ",417],"=",["T_WHITESPACE"," ",417],["T_VARIABLE","$total",417],["T_OBJECT_OPERATOR","->",417],["T_STRING","toArray",417],"(",")",";",["T_WHITESPACE","\n        ",417],"}",["T_WHITESPACE","\n        ",418],["T_RETURN","return",419],["T_WHITESPACE"," ",419],["T_VARIABLE","$arr",419],";",["T_WHITESPACE","\n    ",419],"}",["T_WHITESPACE","\n\n    ",420],["T_DOC_COMMENT","\/**\n     * Retrieve address items collection\n     *\n     * @return Mage_Eav_Model_Entity_Collection_Abstract\n     *\/",422],["T_WHITESPACE","\n    ",426],["T_PUBLIC","public",427],["T_WHITESPACE"," ",427],["T_FUNCTION","function",427],["T_WHITESPACE"," ",427],["T_STRING","getItemsCollection",427],"(",")",["T_WHITESPACE","\n    ",427],"{",["T_WHITESPACE","\n        ",428],["T_IF","if",429],["T_WHITESPACE"," ",429],"(",["T_STRING","is_null",429],"(",["T_VARIABLE","$this",429],["T_OBJECT_OPERATOR","->",429],["T_STRING","_items",429],")",")",["T_WHITESPACE"," ",429],"{",["T_WHITESPACE","\n            ",429],["T_VARIABLE","$this",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","_items",430],["T_WHITESPACE"," ",430],"=",["T_WHITESPACE"," ",430],["T_STRING","Mage",430],["T_DOUBLE_COLON","::",430],["T_STRING","getModel",430],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/quote_address_item'",430],")",["T_OBJECT_OPERATOR","->",430],["T_STRING","getCollection",430],"(",")",["T_WHITESPACE","\n                ",430],["T_OBJECT_OPERATOR","->",431],["T_STRING","setAddressFilter",431],"(",["T_VARIABLE","$this",431],["T_OBJECT_OPERATOR","->",431],["T_STRING","getId",431],"(",")",")",";",["T_WHITESPACE","\n\n            ",431],["T_IF","if",433],["T_WHITESPACE"," ",433],"(",["T_VARIABLE","$this",433],["T_OBJECT_OPERATOR","->",433],["T_STRING","getId",433],"(",")",")",["T_WHITESPACE"," ",433],"{",["T_WHITESPACE","\n                ",433],["T_FOREACH","foreach",434],["T_WHITESPACE"," ",434],"(",["T_VARIABLE","$this",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","_items",434],["T_WHITESPACE"," ",434],["T_AS","as",434],["T_WHITESPACE"," ",434],["T_VARIABLE","$item",434],")",["T_WHITESPACE"," ",434],"{",["T_WHITESPACE","\n                    ",434],["T_VARIABLE","$item",435],["T_OBJECT_OPERATOR","->",435],["T_STRING","setAddress",435],"(",["T_VARIABLE","$this",435],")",";",["T_WHITESPACE","\n                ",435],"}",["T_WHITESPACE","\n            ",436],"}",["T_WHITESPACE","\n        ",437],"}",["T_WHITESPACE","\n        ",438],["T_RETURN","return",439],["T_WHITESPACE"," ",439],["T_VARIABLE","$this",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","_items",439],";",["T_WHITESPACE","\n    ",439],"}",["T_WHITESPACE","\n\n    ",440],["T_DOC_COMMENT","\/**\n     * Get all available address items\n     *\n     * @return array\n     *\/",442],["T_WHITESPACE","\n    ",446],["T_PUBLIC","public",447],["T_WHITESPACE"," ",447],["T_FUNCTION","function",447],["T_WHITESPACE"," ",447],["T_STRING","getAllItems",447],"(",")",["T_WHITESPACE","\n    ",447],"{",["T_WHITESPACE","\n        ",448],["T_COMMENT","\/\/ We calculate item list once and cache it in three arrays - all items, nominal, non-nominal\n",449],["T_WHITESPACE","        ",450],["T_VARIABLE","$cachedItems",450],["T_WHITESPACE"," ",450],"=",["T_WHITESPACE"," ",450],["T_VARIABLE","$this",450],["T_OBJECT_OPERATOR","->",450],["T_STRING","_nominalOnly",450],["T_WHITESPACE"," ",450],"?",["T_WHITESPACE"," ",450],["T_CONSTANT_ENCAPSED_STRING","'nominal'",450],["T_WHITESPACE"," ",450],":",["T_WHITESPACE"," ",450],"(",["T_VARIABLE","$this",450],["T_OBJECT_OPERATOR","->",450],["T_STRING","_nominalOnly",450],["T_WHITESPACE"," ",450],["T_IS_IDENTICAL","===",450],["T_WHITESPACE"," ",450],["T_STRING","false",450],["T_WHITESPACE"," ",450],"?",["T_WHITESPACE"," ",450],["T_CONSTANT_ENCAPSED_STRING","'nonnominal'",450],["T_WHITESPACE"," ",450],":",["T_WHITESPACE"," ",450],["T_CONSTANT_ENCAPSED_STRING","'all'",450],")",";",["T_WHITESPACE","\n        ",450],["T_VARIABLE","$key",451],["T_WHITESPACE"," ",451],"=",["T_WHITESPACE"," ",451],["T_CONSTANT_ENCAPSED_STRING","'cached_items_'",451],["T_WHITESPACE"," ",451],".",["T_WHITESPACE"," ",451],["T_VARIABLE","$cachedItems",451],";",["T_WHITESPACE","\n        ",451],["T_IF","if",452],["T_WHITESPACE"," ",452],"(","!",["T_VARIABLE","$this",452],["T_OBJECT_OPERATOR","->",452],["T_STRING","hasData",452],"(",["T_VARIABLE","$key",452],")",")",["T_WHITESPACE"," ",452],"{",["T_WHITESPACE","\n            ",452],["T_COMMENT","\/\/ For compatibility  we will use $this->_filterNominal to divide nominal items from non-nominal\n",453],["T_WHITESPACE","            ",454],["T_COMMENT","\/\/ (because it can be overloaded)\n",454],["T_WHITESPACE","            ",455],["T_COMMENT","\/\/ So keep current flag $this->_nominalOnly and restore it after cycle\n",455],["T_WHITESPACE","            ",456],["T_VARIABLE","$wasNominal",456],["T_WHITESPACE"," ",456],"=",["T_WHITESPACE"," ",456],["T_VARIABLE","$this",456],["T_OBJECT_OPERATOR","->",456],["T_STRING","_nominalOnly",456],";",["T_WHITESPACE","\n            ",456],["T_VARIABLE","$this",457],["T_OBJECT_OPERATOR","->",457],["T_STRING","_nominalOnly",457],["T_WHITESPACE"," ",457],"=",["T_WHITESPACE"," ",457],["T_STRING","true",457],";",["T_WHITESPACE"," ",457],["T_COMMENT","\/\/ Now $this->_filterNominal() will return positive values for nominal items\n",457],["T_WHITESPACE","\n            ",458],["T_VARIABLE","$quoteItems",459],["T_WHITESPACE"," ",459],"=",["T_WHITESPACE"," ",459],["T_VARIABLE","$this",459],["T_OBJECT_OPERATOR","->",459],["T_STRING","getQuote",459],"(",")",["T_OBJECT_OPERATOR","->",459],["T_STRING","getItemsCollection",459],"(",")",";",["T_WHITESPACE","\n            ",459],["T_VARIABLE","$addressItems",460],["T_WHITESPACE"," ",460],"=",["T_WHITESPACE"," ",460],["T_VARIABLE","$this",460],["T_OBJECT_OPERATOR","->",460],["T_STRING","getItemsCollection",460],"(",")",";",["T_WHITESPACE","\n\n            ",460],["T_VARIABLE","$items",462],["T_WHITESPACE"," ",462],"=",["T_WHITESPACE"," ",462],["T_ARRAY","array",462],"(",")",";",["T_WHITESPACE","\n            ",462],["T_VARIABLE","$nominalItems",463],["T_WHITESPACE"," ",463],"=",["T_WHITESPACE"," ",463],["T_ARRAY","array",463],"(",")",";",["T_WHITESPACE","\n            ",463],["T_VARIABLE","$nonNominalItems",464],["T_WHITESPACE"," ",464],"=",["T_WHITESPACE"," ",464],["T_ARRAY","array",464],"(",")",";",["T_WHITESPACE","\n            ",464],["T_IF","if",465],["T_WHITESPACE"," ",465],"(",["T_VARIABLE","$this",465],["T_OBJECT_OPERATOR","->",465],["T_STRING","getQuote",465],"(",")",["T_OBJECT_OPERATOR","->",465],["T_STRING","getIsMultiShipping",465],"(",")",["T_WHITESPACE"," ",465],["T_BOOLEAN_AND","&&",465],["T_WHITESPACE"," ",465],["T_VARIABLE","$addressItems",465],["T_OBJECT_OPERATOR","->",465],["T_STRING","count",465],"(",")",["T_WHITESPACE"," ",465],">",["T_WHITESPACE"," ",465],["T_LNUMBER","0",465],")",["T_WHITESPACE"," ",465],"{",["T_WHITESPACE","\n                ",465],["T_FOREACH","foreach",466],["T_WHITESPACE"," ",466],"(",["T_VARIABLE","$addressItems",466],["T_WHITESPACE"," ",466],["T_AS","as",466],["T_WHITESPACE"," ",466],["T_VARIABLE","$aItem",466],")",["T_WHITESPACE"," ",466],"{",["T_WHITESPACE","\n                    ",466],["T_IF","if",467],["T_WHITESPACE"," ",467],"(",["T_VARIABLE","$aItem",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","isDeleted",467],"(",")",")",["T_WHITESPACE"," ",467],"{",["T_WHITESPACE","\n                        ",467],["T_CONTINUE","continue",468],";",["T_WHITESPACE","\n                    ",468],"}",["T_WHITESPACE","\n\n                    ",469],["T_IF","if",471],["T_WHITESPACE"," ",471],"(","!",["T_VARIABLE","$aItem",471],["T_OBJECT_OPERATOR","->",471],["T_STRING","getQuoteItemImported",471],"(",")",")",["T_WHITESPACE"," ",471],"{",["T_WHITESPACE","\n                        ",471],["T_VARIABLE","$qItem",472],["T_WHITESPACE"," ",472],"=",["T_WHITESPACE"," ",472],["T_VARIABLE","$this",472],["T_OBJECT_OPERATOR","->",472],["T_STRING","getQuote",472],"(",")",["T_OBJECT_OPERATOR","->",472],["T_STRING","getItemById",472],"(",["T_VARIABLE","$aItem",472],["T_OBJECT_OPERATOR","->",472],["T_STRING","getQuoteItemId",472],"(",")",")",";",["T_WHITESPACE","\n                        ",472],["T_IF","if",473],["T_WHITESPACE"," ",473],"(",["T_VARIABLE","$qItem",473],")",["T_WHITESPACE"," ",473],"{",["T_WHITESPACE","\n                            ",473],["T_VARIABLE","$aItem",474],["T_OBJECT_OPERATOR","->",474],["T_STRING","importQuoteItem",474],"(",["T_VARIABLE","$qItem",474],")",";",["T_WHITESPACE","\n                        ",474],"}",["T_WHITESPACE","\n                    ",475],"}",["T_WHITESPACE","\n                    ",476],["T_VARIABLE","$items",477],"[","]",["T_WHITESPACE"," ",477],"=",["T_WHITESPACE"," ",477],["T_VARIABLE","$aItem",477],";",["T_WHITESPACE","\n                    ",477],["T_IF","if",478],["T_WHITESPACE"," ",478],"(",["T_VARIABLE","$this",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","_filterNominal",478],"(",["T_VARIABLE","$aItem",478],")",")",["T_WHITESPACE"," ",478],"{",["T_WHITESPACE","\n                        ",478],["T_VARIABLE","$nominalItems",479],"[","]",["T_WHITESPACE"," ",479],"=",["T_WHITESPACE"," ",479],["T_VARIABLE","$aItem",479],";",["T_WHITESPACE","\n                    ",479],"}",["T_WHITESPACE"," ",480],["T_ELSE","else",480],["T_WHITESPACE"," ",480],"{",["T_WHITESPACE","\n                        ",480],["T_VARIABLE","$nonNominalItems",481],"[","]",["T_WHITESPACE"," ",481],"=",["T_WHITESPACE"," ",481],["T_VARIABLE","$aItem",481],";",["T_WHITESPACE","\n                    ",481],"}",["T_WHITESPACE","\n                ",482],"}",["T_WHITESPACE","\n            ",483],"}",["T_WHITESPACE"," ",484],["T_ELSE","else",484],["T_WHITESPACE"," ",484],"{",["T_WHITESPACE","\n                ",484],["T_COMMENT","\/*\n                * For virtual quote we assign items only to billing address, otherwise - only to shipping address\n                *\/",485],["T_WHITESPACE","\n                ",487],["T_VARIABLE","$addressType",488],["T_WHITESPACE"," ",488],"=",["T_WHITESPACE"," ",488],["T_VARIABLE","$this",488],["T_OBJECT_OPERATOR","->",488],["T_STRING","getAddressType",488],"(",")",";",["T_WHITESPACE","\n                ",488],["T_VARIABLE","$canAddItems",489],["T_WHITESPACE"," ",489],"=",["T_WHITESPACE"," ",489],["T_VARIABLE","$this",489],["T_OBJECT_OPERATOR","->",489],["T_STRING","getQuote",489],"(",")",["T_OBJECT_OPERATOR","->",489],["T_STRING","isVirtual",489],"(",")",["T_WHITESPACE","\n                    ",489],"?",["T_WHITESPACE"," ",490],"(",["T_VARIABLE","$addressType",490],["T_WHITESPACE"," ",490],["T_IS_EQUAL","==",490],["T_WHITESPACE"," ",490],["T_STRING","self",490],["T_DOUBLE_COLON","::",490],["T_STRING","TYPE_BILLING",490],")",["T_WHITESPACE","\n                    ",490],":",["T_WHITESPACE"," ",491],"(",["T_VARIABLE","$addressType",491],["T_WHITESPACE"," ",491],["T_IS_EQUAL","==",491],["T_WHITESPACE"," ",491],["T_STRING","self",491],["T_DOUBLE_COLON","::",491],["T_STRING","TYPE_SHIPPING",491],")",";",["T_WHITESPACE","\n\n                ",491],["T_IF","if",493],["T_WHITESPACE"," ",493],"(",["T_VARIABLE","$canAddItems",493],")",["T_WHITESPACE"," ",493],"{",["T_WHITESPACE","\n                    ",493],["T_FOREACH","foreach",494],["T_WHITESPACE"," ",494],"(",["T_VARIABLE","$quoteItems",494],["T_WHITESPACE"," ",494],["T_AS","as",494],["T_WHITESPACE"," ",494],["T_VARIABLE","$qItem",494],")",["T_WHITESPACE"," ",494],"{",["T_WHITESPACE","\n                        ",494],["T_IF","if",495],["T_WHITESPACE"," ",495],"(",["T_VARIABLE","$qItem",495],["T_OBJECT_OPERATOR","->",495],["T_STRING","isDeleted",495],"(",")",")",["T_WHITESPACE"," ",495],"{",["T_WHITESPACE","\n                            ",495],["T_CONTINUE","continue",496],";",["T_WHITESPACE","\n                        ",496],"}",["T_WHITESPACE","\n                        ",497],["T_VARIABLE","$items",498],"[","]",["T_WHITESPACE"," ",498],"=",["T_WHITESPACE"," ",498],["T_VARIABLE","$qItem",498],";",["T_WHITESPACE","\n                        ",498],["T_IF","if",499],["T_WHITESPACE"," ",499],"(",["T_VARIABLE","$this",499],["T_OBJECT_OPERATOR","->",499],["T_STRING","_filterNominal",499],"(",["T_VARIABLE","$qItem",499],")",")",["T_WHITESPACE"," ",499],"{",["T_WHITESPACE","\n                            ",499],["T_VARIABLE","$nominalItems",500],"[","]",["T_WHITESPACE"," ",500],"=",["T_WHITESPACE"," ",500],["T_VARIABLE","$qItem",500],";",["T_WHITESPACE","\n                        ",500],"}",["T_WHITESPACE"," ",501],["T_ELSE","else",501],["T_WHITESPACE"," ",501],"{",["T_WHITESPACE","\n                            ",501],["T_VARIABLE","$nonNominalItems",502],"[","]",["T_WHITESPACE"," ",502],"=",["T_WHITESPACE"," ",502],["T_VARIABLE","$qItem",502],";",["T_WHITESPACE","\n                        ",502],"}",["T_WHITESPACE","\n                    ",503],"}",["T_WHITESPACE","\n                ",504],"}",["T_WHITESPACE","\n            ",505],"}",["T_WHITESPACE","\n\n            ",506],["T_COMMENT","\/\/ Cache calculated lists\n",508],["T_WHITESPACE","            ",509],["T_VARIABLE","$this",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","setData",509],"(",["T_CONSTANT_ENCAPSED_STRING","'cached_items_all'",509],",",["T_WHITESPACE"," ",509],["T_VARIABLE","$items",509],")",";",["T_WHITESPACE","\n            ",509],["T_VARIABLE","$this",510],["T_OBJECT_OPERATOR","->",510],["T_STRING","setData",510],"(",["T_CONSTANT_ENCAPSED_STRING","'cached_items_nominal'",510],",",["T_WHITESPACE"," ",510],["T_VARIABLE","$nominalItems",510],")",";",["T_WHITESPACE","\n            ",510],["T_VARIABLE","$this",511],["T_OBJECT_OPERATOR","->",511],["T_STRING","setData",511],"(",["T_CONSTANT_ENCAPSED_STRING","'cached_items_nonnominal'",511],",",["T_WHITESPACE"," ",511],["T_VARIABLE","$nonNominalItems",511],")",";",["T_WHITESPACE","\n\n            ",511],["T_VARIABLE","$this",513],["T_OBJECT_OPERATOR","->",513],["T_STRING","_nominalOnly",513],["T_WHITESPACE"," ",513],"=",["T_WHITESPACE"," ",513],["T_VARIABLE","$wasNominal",513],";",["T_WHITESPACE"," ",513],["T_COMMENT","\/\/ Restore original value before we changed it\n",513],["T_WHITESPACE","        ",514],"}",["T_WHITESPACE","\n\n        ",514],["T_VARIABLE","$items",516],["T_WHITESPACE"," ",516],"=",["T_WHITESPACE"," ",516],["T_VARIABLE","$this",516],["T_OBJECT_OPERATOR","->",516],["T_STRING","getData",516],"(",["T_VARIABLE","$key",516],")",";",["T_WHITESPACE","\n        ",516],["T_RETURN","return",517],["T_WHITESPACE"," ",517],["T_VARIABLE","$items",517],";",["T_WHITESPACE","\n    ",517],"}",["T_WHITESPACE","\n\n    ",518],["T_DOC_COMMENT","\/**\n     * Getter for all non-nominal items\n     *\n     * @return array\n     *\/",520],["T_WHITESPACE","\n    ",524],["T_PUBLIC","public",525],["T_WHITESPACE"," ",525],["T_FUNCTION","function",525],["T_WHITESPACE"," ",525],["T_STRING","getAllNonNominalItems",525],"(",")",["T_WHITESPACE","\n    ",525],"{",["T_WHITESPACE","\n        ",526],["T_VARIABLE","$this",527],["T_OBJECT_OPERATOR","->",527],["T_STRING","_nominalOnly",527],["T_WHITESPACE"," ",527],"=",["T_WHITESPACE"," ",527],["T_STRING","false",527],";",["T_WHITESPACE","\n        ",527],["T_VARIABLE","$result",528],["T_WHITESPACE"," ",528],"=",["T_WHITESPACE"," ",528],["T_VARIABLE","$this",528],["T_OBJECT_OPERATOR","->",528],["T_STRING","getAllItems",528],"(",")",";",["T_WHITESPACE","\n        ",528],["T_VARIABLE","$this",529],["T_OBJECT_OPERATOR","->",529],["T_STRING","_nominalOnly",529],["T_WHITESPACE"," ",529],"=",["T_WHITESPACE"," ",529],["T_STRING","null",529],";",["T_WHITESPACE","\n        ",529],["T_RETURN","return",530],["T_WHITESPACE"," ",530],["T_VARIABLE","$result",530],";",["T_WHITESPACE","\n    ",530],"}",["T_WHITESPACE","\n\n    ",531],["T_DOC_COMMENT","\/**\n     * Getter for all nominal items\n     *\n     * @return array\n     *\/",533],["T_WHITESPACE","\n    ",537],["T_PUBLIC","public",538],["T_WHITESPACE"," ",538],["T_FUNCTION","function",538],["T_WHITESPACE"," ",538],["T_STRING","getAllNominalItems",538],"(",")",["T_WHITESPACE","\n    ",538],"{",["T_WHITESPACE","\n        ",539],["T_VARIABLE","$this",540],["T_OBJECT_OPERATOR","->",540],["T_STRING","_nominalOnly",540],["T_WHITESPACE"," ",540],"=",["T_WHITESPACE"," ",540],["T_STRING","true",540],";",["T_WHITESPACE","\n        ",540],["T_VARIABLE","$result",541],["T_WHITESPACE"," ",541],"=",["T_WHITESPACE"," ",541],["T_VARIABLE","$this",541],["T_OBJECT_OPERATOR","->",541],["T_STRING","getAllItems",541],"(",")",";",["T_WHITESPACE","\n        ",541],["T_VARIABLE","$this",542],["T_OBJECT_OPERATOR","->",542],["T_STRING","_nominalOnly",542],["T_WHITESPACE"," ",542],"=",["T_WHITESPACE"," ",542],["T_STRING","null",542],";",["T_WHITESPACE","\n        ",542],["T_RETURN","return",543],["T_WHITESPACE"," ",543],["T_VARIABLE","$result",543],";",["T_WHITESPACE","\n    ",543],"}",["T_WHITESPACE","\n\n    ",544],["T_DOC_COMMENT","\/**\n     * Segregate by nominal criteria\n     *\n     * true: get nominals only\n     * false: get non-nominals only\n     * null: get all\n     *\n     * @param Mage_Sales_Model_Quote_Item_Abstract\n     * @return Mage_Sales_Model_Quote_Item_Abstract|false\n     *\/",546],["T_WHITESPACE","\n    ",555],["T_PROTECTED","protected",556],["T_WHITESPACE"," ",556],["T_FUNCTION","function",556],["T_WHITESPACE"," ",556],["T_STRING","_filterNominal",556],"(",["T_VARIABLE","$item",556],")",["T_WHITESPACE","\n    ",556],"{",["T_WHITESPACE","\n        ",557],["T_RETURN","return",558],["T_WHITESPACE"," ",558],"(",["T_STRING","null",558],["T_WHITESPACE"," ",558],["T_IS_IDENTICAL","===",558],["T_WHITESPACE"," ",558],["T_VARIABLE","$this",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","_nominalOnly",558],")",["T_WHITESPACE","\n            ",558],["T_BOOLEAN_OR","||",559],["T_WHITESPACE"," ",559],"(","(",["T_STRING","false",559],["T_WHITESPACE"," ",559],["T_IS_IDENTICAL","===",559],["T_WHITESPACE"," ",559],["T_VARIABLE","$this",559],["T_OBJECT_OPERATOR","->",559],["T_STRING","_nominalOnly",559],")",["T_WHITESPACE"," ",559],["T_BOOLEAN_AND","&&",559],["T_WHITESPACE"," ",559],"!",["T_VARIABLE","$item",559],["T_OBJECT_OPERATOR","->",559],["T_STRING","isNominal",559],"(",")",")",["T_WHITESPACE","\n            ",559],["T_BOOLEAN_OR","||",560],["T_WHITESPACE"," ",560],"(","(",["T_STRING","true",560],["T_WHITESPACE"," ",560],["T_IS_IDENTICAL","===",560],["T_WHITESPACE"," ",560],["T_VARIABLE","$this",560],["T_OBJECT_OPERATOR","->",560],["T_STRING","_nominalOnly",560],")",["T_WHITESPACE"," ",560],["T_BOOLEAN_AND","&&",560],["T_WHITESPACE"," ",560],["T_VARIABLE","$item",560],["T_OBJECT_OPERATOR","->",560],["T_STRING","isNominal",560],"(",")",")",["T_WHITESPACE","\n            ",560],"?",["T_WHITESPACE"," ",561],["T_VARIABLE","$item",561],["T_WHITESPACE"," ",561],":",["T_WHITESPACE"," ",561],["T_STRING","false",561],";",["T_WHITESPACE","\n    ",561],"}",["T_WHITESPACE","\n\n    ",562],["T_DOC_COMMENT","\/**\n     * Retrieve all visible items\n     *\n     * @return array\n     *\/",564],["T_WHITESPACE","\n    ",568],["T_PUBLIC","public",569],["T_WHITESPACE"," ",569],["T_FUNCTION","function",569],["T_WHITESPACE"," ",569],["T_STRING","getAllVisibleItems",569],"(",")",["T_WHITESPACE","\n    ",569],"{",["T_WHITESPACE","\n        ",570],["T_VARIABLE","$items",571],["T_WHITESPACE"," ",571],"=",["T_WHITESPACE"," ",571],["T_ARRAY","array",571],"(",")",";",["T_WHITESPACE","\n        ",571],["T_FOREACH","foreach",572],["T_WHITESPACE"," ",572],"(",["T_VARIABLE","$this",572],["T_OBJECT_OPERATOR","->",572],["T_STRING","getAllItems",572],"(",")",["T_WHITESPACE"," ",572],["T_AS","as",572],["T_WHITESPACE"," ",572],["T_VARIABLE","$item",572],")",["T_WHITESPACE"," ",572],"{",["T_WHITESPACE","\n            ",572],["T_IF","if",573],["T_WHITESPACE"," ",573],"(","!",["T_VARIABLE","$item",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","getParentItemId",573],"(",")",")",["T_WHITESPACE"," ",573],"{",["T_WHITESPACE","\n                ",573],["T_VARIABLE","$items",574],"[","]",["T_WHITESPACE"," ",574],"=",["T_WHITESPACE"," ",574],["T_VARIABLE","$item",574],";",["T_WHITESPACE","\n            ",574],"}",["T_WHITESPACE","\n        ",575],"}",["T_WHITESPACE","\n        ",576],["T_RETURN","return",577],["T_WHITESPACE"," ",577],["T_VARIABLE","$items",577],";",["T_WHITESPACE","\n    ",577],"}",["T_WHITESPACE","\n\n    ",578],["T_DOC_COMMENT","\/**\n     * Retrieve item quantity by id\n     *\n     * @param int $itemId\n     * @return float|int\n     *\/",580],["T_WHITESPACE","\n    ",585],["T_PUBLIC","public",586],["T_WHITESPACE"," ",586],["T_FUNCTION","function",586],["T_WHITESPACE"," ",586],["T_STRING","getItemQty",586],"(",["T_VARIABLE","$itemId",586],["T_WHITESPACE"," ",586],"=",["T_WHITESPACE"," ",586],["T_LNUMBER","0",586],")",["T_WHITESPACE","\n    ",586],"{",["T_WHITESPACE","\n        ",587],["T_IF","if",588],["T_WHITESPACE"," ",588],"(",["T_VARIABLE","$this",588],["T_OBJECT_OPERATOR","->",588],["T_STRING","hasData",588],"(",["T_CONSTANT_ENCAPSED_STRING","'item_qty'",588],")",")",["T_WHITESPACE"," ",588],"{",["T_WHITESPACE","\n            ",588],["T_RETURN","return",589],["T_WHITESPACE"," ",589],["T_VARIABLE","$this",589],["T_OBJECT_OPERATOR","->",589],["T_STRING","getData",589],"(",["T_CONSTANT_ENCAPSED_STRING","'item_qty'",589],")",";",["T_WHITESPACE","\n        ",589],"}",["T_WHITESPACE","\n\n        ",590],["T_VARIABLE","$qty",592],["T_WHITESPACE"," ",592],"=",["T_WHITESPACE"," ",592],["T_LNUMBER","0",592],";",["T_WHITESPACE","\n        ",592],["T_IF","if",593],["T_WHITESPACE"," ",593],"(",["T_VARIABLE","$itemId",593],["T_WHITESPACE"," ",593],["T_IS_EQUAL","==",593],["T_WHITESPACE"," ",593],["T_LNUMBER","0",593],")",["T_WHITESPACE"," ",593],"{",["T_WHITESPACE","\n            ",593],["T_FOREACH","foreach",594],["T_WHITESPACE"," ",594],"(",["T_VARIABLE","$this",594],["T_OBJECT_OPERATOR","->",594],["T_STRING","getAllItems",594],"(",")",["T_WHITESPACE"," ",594],["T_AS","as",594],["T_WHITESPACE"," ",594],["T_VARIABLE","$item",594],")",["T_WHITESPACE"," ",594],"{",["T_WHITESPACE","\n                ",594],["T_VARIABLE","$qty",595],["T_WHITESPACE"," ",595],["T_PLUS_EQUAL","+=",595],["T_WHITESPACE"," ",595],["T_VARIABLE","$item",595],["T_OBJECT_OPERATOR","->",595],["T_STRING","getQty",595],"(",")",";",["T_WHITESPACE","\n            ",595],"}",["T_WHITESPACE","\n        ",596],"}",["T_WHITESPACE"," ",597],["T_ELSE","else",597],["T_WHITESPACE"," ",597],"{",["T_WHITESPACE","\n            ",597],["T_VARIABLE","$item",598],["T_WHITESPACE"," ",598],"=",["T_WHITESPACE"," ",598],["T_VARIABLE","$this",598],["T_OBJECT_OPERATOR","->",598],["T_STRING","getItemById",598],"(",["T_VARIABLE","$itemId",598],")",";",["T_WHITESPACE","\n            ",598],["T_IF","if",599],["T_WHITESPACE"," ",599],"(",["T_VARIABLE","$item",599],")",["T_WHITESPACE"," ",599],"{",["T_WHITESPACE","\n                ",599],["T_VARIABLE","$qty",600],["T_WHITESPACE"," ",600],"=",["T_WHITESPACE"," ",600],["T_VARIABLE","$item",600],["T_OBJECT_OPERATOR","->",600],["T_STRING","getQty",600],"(",")",";",["T_WHITESPACE","\n            ",600],"}",["T_WHITESPACE","\n        ",601],"}",["T_WHITESPACE","\n        ",602],["T_RETURN","return",603],["T_WHITESPACE"," ",603],["T_VARIABLE","$qty",603],";",["T_WHITESPACE","\n    ",603],"}",["T_WHITESPACE","\n\n    ",604],["T_DOC_COMMENT","\/**\n     * Check Quote address has Items\n     *\n     * @return bool\n     *\/",606],["T_WHITESPACE","\n    ",610],["T_PUBLIC","public",611],["T_WHITESPACE"," ",611],["T_FUNCTION","function",611],["T_WHITESPACE"," ",611],["T_STRING","hasItems",611],"(",")",["T_WHITESPACE","\n    ",611],"{",["T_WHITESPACE","\n        ",612],["T_RETURN","return",613],["T_WHITESPACE"," ",613],["T_STRING","sizeof",613],"(",["T_VARIABLE","$this",613],["T_OBJECT_OPERATOR","->",613],["T_STRING","getAllItems",613],"(",")",")",">",["T_LNUMBER","0",613],";",["T_WHITESPACE","\n    ",613],"}",["T_WHITESPACE","\n\n    ",614],["T_DOC_COMMENT","\/**\n     * Get address item object by id without\n     *\n     * @param int $itemId\n     * @return Mage_Sales_Model_Quote_Address_Item\n     *\/",616],["T_WHITESPACE","\n    ",621],["T_PUBLIC","public",622],["T_WHITESPACE"," ",622],["T_FUNCTION","function",622],["T_WHITESPACE"," ",622],["T_STRING","getItemById",622],"(",["T_VARIABLE","$itemId",622],")",["T_WHITESPACE","\n    ",622],"{",["T_WHITESPACE","\n        ",623],["T_FOREACH","foreach",624],["T_WHITESPACE"," ",624],"(",["T_VARIABLE","$this",624],["T_OBJECT_OPERATOR","->",624],["T_STRING","getItemsCollection",624],"(",")",["T_WHITESPACE"," ",624],["T_AS","as",624],["T_WHITESPACE"," ",624],["T_VARIABLE","$item",624],")",["T_WHITESPACE"," ",624],"{",["T_WHITESPACE","\n            ",624],["T_IF","if",625],["T_WHITESPACE"," ",625],"(",["T_VARIABLE","$item",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","getId",625],"(",")",["T_WHITESPACE"," ",625],["T_IS_EQUAL","==",625],["T_WHITESPACE"," ",625],["T_VARIABLE","$itemId",625],")",["T_WHITESPACE"," ",625],"{",["T_WHITESPACE","\n                ",625],["T_RETURN","return",626],["T_WHITESPACE"," ",626],["T_VARIABLE","$item",626],";",["T_WHITESPACE","\n            ",626],"}",["T_WHITESPACE","\n        ",627],"}",["T_WHITESPACE","\n        ",628],["T_RETURN","return",629],["T_WHITESPACE"," ",629],["T_STRING","false",629],";",["T_WHITESPACE","\n    ",629],"}",["T_WHITESPACE","\n\n    ",630],["T_DOC_COMMENT","\/**\n     * Get prepared not deleted item\n     *\n     * @param $itemId\n     * @return Mage_Sales_Model_Quote_Address_Item\n     *\/",632],["T_WHITESPACE","\n    ",637],["T_PUBLIC","public",638],["T_WHITESPACE"," ",638],["T_FUNCTION","function",638],["T_WHITESPACE"," ",638],["T_STRING","getValidItemById",638],"(",["T_VARIABLE","$itemId",638],")",["T_WHITESPACE","\n    ",638],"{",["T_WHITESPACE","\n        ",639],["T_FOREACH","foreach",640],["T_WHITESPACE"," ",640],"(",["T_VARIABLE","$this",640],["T_OBJECT_OPERATOR","->",640],["T_STRING","getAllItems",640],"(",")",["T_WHITESPACE"," ",640],["T_AS","as",640],["T_WHITESPACE"," ",640],["T_VARIABLE","$item",640],")",["T_WHITESPACE"," ",640],"{",["T_WHITESPACE","\n            ",640],["T_IF","if",641],["T_WHITESPACE"," ",641],"(",["T_VARIABLE","$item",641],["T_OBJECT_OPERATOR","->",641],["T_STRING","getId",641],"(",")",["T_WHITESPACE"," ",641],["T_IS_EQUAL","==",641],["T_WHITESPACE"," ",641],["T_VARIABLE","$itemId",641],")",["T_WHITESPACE"," ",641],"{",["T_WHITESPACE","\n                ",641],["T_RETURN","return",642],["T_WHITESPACE"," ",642],["T_VARIABLE","$item",642],";",["T_WHITESPACE","\n            ",642],"}",["T_WHITESPACE","\n        ",643],"}",["T_WHITESPACE","\n        ",644],["T_RETURN","return",645],["T_WHITESPACE"," ",645],["T_STRING","false",645],";",["T_WHITESPACE","\n    ",645],"}",["T_WHITESPACE","\n\n    ",646],["T_DOC_COMMENT","\/**\n     * Retrieve item object by quote item Id\n     *\n     * @param int $itemId\n     * @return Mage_Sales_Model_Quote_Address_Item\n     *\/",648],["T_WHITESPACE","\n    ",653],["T_PUBLIC","public",654],["T_WHITESPACE"," ",654],["T_FUNCTION","function",654],["T_WHITESPACE"," ",654],["T_STRING","getItemByQuoteItemId",654],"(",["T_VARIABLE","$itemId",654],")",["T_WHITESPACE","\n    ",654],"{",["T_WHITESPACE","\n        ",655],["T_FOREACH","foreach",656],["T_WHITESPACE"," ",656],"(",["T_VARIABLE","$this",656],["T_OBJECT_OPERATOR","->",656],["T_STRING","getItemsCollection",656],"(",")",["T_WHITESPACE"," ",656],["T_AS","as",656],["T_WHITESPACE"," ",656],["T_VARIABLE","$item",656],")",["T_WHITESPACE"," ",656],"{",["T_WHITESPACE","\n            ",656],["T_IF","if",657],["T_WHITESPACE"," ",657],"(",["T_VARIABLE","$item",657],["T_OBJECT_OPERATOR","->",657],["T_STRING","getQuoteItemId",657],"(",")",["T_WHITESPACE"," ",657],["T_IS_EQUAL","==",657],["T_WHITESPACE"," ",657],["T_VARIABLE","$itemId",657],")",["T_WHITESPACE"," ",657],"{",["T_WHITESPACE","\n                ",657],["T_RETURN","return",658],["T_WHITESPACE"," ",658],["T_VARIABLE","$item",658],";",["T_WHITESPACE","\n            ",658],"}",["T_WHITESPACE","\n        ",659],"}",["T_WHITESPACE","\n        ",660],["T_RETURN","return",661],["T_WHITESPACE"," ",661],["T_STRING","false",661],";",["T_WHITESPACE","\n    ",661],"}",["T_WHITESPACE","\n\n    ",662],["T_DOC_COMMENT","\/**\n     * Remove item from collection\n     *\n     * @param int $itemId\n     * @return Mage_Sales_Model_Quote_Address\n     *\/",664],["T_WHITESPACE","\n    ",669],["T_PUBLIC","public",670],["T_WHITESPACE"," ",670],["T_FUNCTION","function",670],["T_WHITESPACE"," ",670],["T_STRING","removeItem",670],"(",["T_VARIABLE","$itemId",670],")",["T_WHITESPACE","\n    ",670],"{",["T_WHITESPACE","\n        ",671],["T_VARIABLE","$item",672],["T_WHITESPACE"," ",672],"=",["T_WHITESPACE"," ",672],["T_VARIABLE","$this",672],["T_OBJECT_OPERATOR","->",672],["T_STRING","getItemById",672],"(",["T_VARIABLE","$itemId",672],")",";",["T_WHITESPACE","\n        ",672],["T_IF","if",673],["T_WHITESPACE"," ",673],"(",["T_VARIABLE","$item",673],")",["T_WHITESPACE"," ",673],"{",["T_WHITESPACE","\n            ",673],["T_VARIABLE","$item",674],["T_OBJECT_OPERATOR","->",674],["T_STRING","isDeleted",674],"(",["T_STRING","true",674],")",";",["T_WHITESPACE","\n        ",674],"}",["T_WHITESPACE","\n        ",675],["T_RETURN","return",676],["T_WHITESPACE"," ",676],["T_VARIABLE","$this",676],";",["T_WHITESPACE","\n    ",676],"}",["T_WHITESPACE","\n\n    ",677],["T_DOC_COMMENT","\/**\n     * Add item to address\n     *\n     * @param   Mage_Sales_Model_Quote_Item_Abstract $item\n     * @param   int $qty\n     * @return  Mage_Sales_Model_Quote_Address\n     *\/",679],["T_WHITESPACE","\n    ",685],["T_PUBLIC","public",686],["T_WHITESPACE"," ",686],["T_FUNCTION","function",686],["T_WHITESPACE"," ",686],["T_STRING","addItem",686],"(",["T_STRING","Mage_Sales_Model_Quote_Item_Abstract",686],["T_WHITESPACE"," ",686],["T_VARIABLE","$item",686],",",["T_WHITESPACE"," ",686],["T_VARIABLE","$qty",686],["T_WHITESPACE"," ",686],"=",["T_WHITESPACE"," ",686],["T_STRING","null",686],")",["T_WHITESPACE","\n    ",686],"{",["T_WHITESPACE","\n        ",687],["T_IF","if",688],["T_WHITESPACE"," ",688],"(",["T_VARIABLE","$item",688],["T_WHITESPACE"," ",688],["T_INSTANCEOF","instanceof",688],["T_WHITESPACE"," ",688],["T_STRING","Mage_Sales_Model_Quote_Item",688],")",["T_WHITESPACE"," ",688],"{",["T_WHITESPACE","\n            ",688],["T_IF","if",689],["T_WHITESPACE"," ",689],"(",["T_VARIABLE","$item",689],["T_OBJECT_OPERATOR","->",689],["T_STRING","getParentItemId",689],"(",")",")",["T_WHITESPACE"," ",689],"{",["T_WHITESPACE","\n                ",689],["T_RETURN","return",690],["T_WHITESPACE"," ",690],["T_VARIABLE","$this",690],";",["T_WHITESPACE","\n            ",690],"}",["T_WHITESPACE","\n            ",691],["T_VARIABLE","$addressItem",692],["T_WHITESPACE"," ",692],"=",["T_WHITESPACE"," ",692],["T_STRING","Mage",692],["T_DOUBLE_COLON","::",692],["T_STRING","getModel",692],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/quote_address_item'",692],")",["T_WHITESPACE","\n                ",692],["T_OBJECT_OPERATOR","->",693],["T_STRING","setAddress",693],"(",["T_VARIABLE","$this",693],")",["T_WHITESPACE","\n                ",693],["T_OBJECT_OPERATOR","->",694],["T_STRING","importQuoteItem",694],"(",["T_VARIABLE","$item",694],")",";",["T_WHITESPACE","\n            ",694],["T_VARIABLE","$this",695],["T_OBJECT_OPERATOR","->",695],["T_STRING","getItemsCollection",695],"(",")",["T_OBJECT_OPERATOR","->",695],["T_STRING","addItem",695],"(",["T_VARIABLE","$addressItem",695],")",";",["T_WHITESPACE","\n\n            ",695],["T_IF","if",697],["T_WHITESPACE"," ",697],"(",["T_VARIABLE","$item",697],["T_OBJECT_OPERATOR","->",697],["T_STRING","getHasChildren",697],"(",")",")",["T_WHITESPACE"," ",697],"{",["T_WHITESPACE","\n                ",697],["T_FOREACH","foreach",698],["T_WHITESPACE"," ",698],"(",["T_VARIABLE","$item",698],["T_OBJECT_OPERATOR","->",698],["T_STRING","getChildren",698],"(",")",["T_WHITESPACE"," ",698],["T_AS","as",698],["T_WHITESPACE"," ",698],["T_VARIABLE","$child",698],")",["T_WHITESPACE"," ",698],"{",["T_WHITESPACE","\n                    ",698],["T_VARIABLE","$addressChildItem",699],["T_WHITESPACE"," ",699],"=",["T_WHITESPACE"," ",699],["T_STRING","Mage",699],["T_DOUBLE_COLON","::",699],["T_STRING","getModel",699],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/quote_address_item'",699],")",["T_WHITESPACE","\n                        ",699],["T_OBJECT_OPERATOR","->",700],["T_STRING","setAddress",700],"(",["T_VARIABLE","$this",700],")",["T_WHITESPACE","\n                        ",700],["T_OBJECT_OPERATOR","->",701],["T_STRING","importQuoteItem",701],"(",["T_VARIABLE","$child",701],")",["T_WHITESPACE","\n                        ",701],["T_OBJECT_OPERATOR","->",702],["T_STRING","setParentItem",702],"(",["T_VARIABLE","$addressItem",702],")",";",["T_WHITESPACE","\n                    ",702],["T_VARIABLE","$this",703],["T_OBJECT_OPERATOR","->",703],["T_STRING","getItemsCollection",703],"(",")",["T_OBJECT_OPERATOR","->",703],["T_STRING","addItem",703],"(",["T_VARIABLE","$addressChildItem",703],")",";",["T_WHITESPACE","\n                ",703],"}",["T_WHITESPACE","\n            ",704],"}",["T_WHITESPACE","\n        ",705],"}",["T_WHITESPACE"," ",706],["T_ELSE","else",706],["T_WHITESPACE"," ",706],"{",["T_WHITESPACE","\n            ",706],["T_VARIABLE","$addressItem",707],["T_WHITESPACE"," ",707],"=",["T_WHITESPACE"," ",707],["T_VARIABLE","$item",707],";",["T_WHITESPACE","\n            ",707],["T_VARIABLE","$addressItem",708],["T_OBJECT_OPERATOR","->",708],["T_STRING","setAddress",708],"(",["T_VARIABLE","$this",708],")",";",["T_WHITESPACE","\n            ",708],["T_IF","if",709],["T_WHITESPACE"," ",709],"(","!",["T_VARIABLE","$addressItem",709],["T_OBJECT_OPERATOR","->",709],["T_STRING","getId",709],"(",")",")",["T_WHITESPACE"," ",709],"{",["T_WHITESPACE","\n                ",709],["T_VARIABLE","$this",710],["T_OBJECT_OPERATOR","->",710],["T_STRING","getItemsCollection",710],"(",")",["T_OBJECT_OPERATOR","->",710],["T_STRING","addItem",710],"(",["T_VARIABLE","$addressItem",710],")",";",["T_WHITESPACE","\n            ",710],"}",["T_WHITESPACE","\n        ",711],"}",["T_WHITESPACE","\n\n        ",712],["T_IF","if",714],["T_WHITESPACE"," ",714],"(",["T_VARIABLE","$qty",714],")",["T_WHITESPACE"," ",714],"{",["T_WHITESPACE","\n            ",714],["T_VARIABLE","$addressItem",715],["T_OBJECT_OPERATOR","->",715],["T_STRING","setQty",715],"(",["T_VARIABLE","$qty",715],")",";",["T_WHITESPACE","\n        ",715],"}",["T_WHITESPACE","\n        ",716],["T_RETURN","return",717],["T_WHITESPACE"," ",717],["T_VARIABLE","$this",717],";",["T_WHITESPACE","\n    ",717],"}",["T_WHITESPACE","\n\n    ",718],["T_DOC_COMMENT","\/**\n     * Retrieve collection of quote shipping rates\n     *\n     * @return Mage_Eav_Model_Entity_Collection_Abstract\n     *\/",720],["T_WHITESPACE","\n    ",724],["T_PUBLIC","public",725],["T_WHITESPACE"," ",725],["T_FUNCTION","function",725],["T_WHITESPACE"," ",725],["T_STRING","getShippingRatesCollection",725],"(",")",["T_WHITESPACE","\n    ",725],"{",["T_WHITESPACE","\n        ",726],["T_IF","if",727],["T_WHITESPACE"," ",727],"(",["T_STRING","is_null",727],"(",["T_VARIABLE","$this",727],["T_OBJECT_OPERATOR","->",727],["T_STRING","_rates",727],")",")",["T_WHITESPACE"," ",727],"{",["T_WHITESPACE","\n            ",727],["T_VARIABLE","$this",728],["T_OBJECT_OPERATOR","->",728],["T_STRING","_rates",728],["T_WHITESPACE"," ",728],"=",["T_WHITESPACE"," ",728],["T_STRING","Mage",728],["T_DOUBLE_COLON","::",728],["T_STRING","getModel",728],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/quote_address_rate'",728],")",["T_OBJECT_OPERATOR","->",728],["T_STRING","getCollection",728],"(",")",["T_WHITESPACE","\n                ",728],["T_OBJECT_OPERATOR","->",729],["T_STRING","setAddressFilter",729],"(",["T_VARIABLE","$this",729],["T_OBJECT_OPERATOR","->",729],["T_STRING","getId",729],"(",")",")",";",["T_WHITESPACE","\n            ",729],["T_IF","if",730],["T_WHITESPACE"," ",730],"(",["T_VARIABLE","$this",730],["T_OBJECT_OPERATOR","->",730],["T_STRING","getQuote",730],"(",")",["T_OBJECT_OPERATOR","->",730],["T_STRING","hasNominalItems",730],"(",["T_STRING","false",730],")",")",["T_WHITESPACE"," ",730],"{",["T_WHITESPACE","\n                ",730],["T_VARIABLE","$this",731],["T_OBJECT_OPERATOR","->",731],["T_STRING","_rates",731],["T_OBJECT_OPERATOR","->",731],["T_STRING","setFixedOnlyFilter",731],"(",["T_STRING","true",731],")",";",["T_WHITESPACE","\n            ",731],"}",["T_WHITESPACE","\n            ",732],["T_IF","if",733],["T_WHITESPACE"," ",733],"(",["T_VARIABLE","$this",733],["T_OBJECT_OPERATOR","->",733],["T_STRING","getId",733],"(",")",")",["T_WHITESPACE"," ",733],"{",["T_WHITESPACE","\n                ",733],["T_FOREACH","foreach",734],["T_WHITESPACE"," ",734],"(",["T_VARIABLE","$this",734],["T_OBJECT_OPERATOR","->",734],["T_STRING","_rates",734],["T_WHITESPACE"," ",734],["T_AS","as",734],["T_WHITESPACE"," ",734],["T_VARIABLE","$rate",734],")",["T_WHITESPACE"," ",734],"{",["T_WHITESPACE","\n                    ",734],["T_VARIABLE","$rate",735],["T_OBJECT_OPERATOR","->",735],["T_STRING","setAddress",735],"(",["T_VARIABLE","$this",735],")",";",["T_WHITESPACE","\n                ",735],"}",["T_WHITESPACE","\n            ",736],"}",["T_WHITESPACE","\n        ",737],"}",["T_WHITESPACE","\n        ",738],["T_RETURN","return",739],["T_WHITESPACE"," ",739],["T_VARIABLE","$this",739],["T_OBJECT_OPERATOR","->",739],["T_STRING","_rates",739],";",["T_WHITESPACE","\n    ",739],"}",["T_WHITESPACE","\n\n    ",740],["T_DOC_COMMENT","\/**\n     * Retrieve all address shipping rates\n     *\n     * @return array\n     *\/",742],["T_WHITESPACE","\n    ",746],["T_PUBLIC","public",747],["T_WHITESPACE"," ",747],["T_FUNCTION","function",747],["T_WHITESPACE"," ",747],["T_STRING","getAllShippingRates",747],"(",")",["T_WHITESPACE","\n    ",747],"{",["T_WHITESPACE","\n        ",748],["T_VARIABLE","$rates",749],["T_WHITESPACE"," ",749],"=",["T_WHITESPACE"," ",749],["T_ARRAY","array",749],"(",")",";",["T_WHITESPACE","\n        ",749],["T_FOREACH","foreach",750],["T_WHITESPACE"," ",750],"(",["T_VARIABLE","$this",750],["T_OBJECT_OPERATOR","->",750],["T_STRING","getShippingRatesCollection",750],"(",")",["T_WHITESPACE"," ",750],["T_AS","as",750],["T_WHITESPACE"," ",750],["T_VARIABLE","$rate",750],")",["T_WHITESPACE"," ",750],"{",["T_WHITESPACE","\n            ",750],["T_IF","if",751],["T_WHITESPACE"," ",751],"(","!",["T_VARIABLE","$rate",751],["T_OBJECT_OPERATOR","->",751],["T_STRING","isDeleted",751],"(",")",")",["T_WHITESPACE"," ",751],"{",["T_WHITESPACE","\n                ",751],["T_VARIABLE","$rates",752],"[","]",["T_WHITESPACE"," ",752],"=",["T_WHITESPACE"," ",752],["T_VARIABLE","$rate",752],";",["T_WHITESPACE","\n            ",752],"}",["T_WHITESPACE","\n        ",753],"}",["T_WHITESPACE","\n        ",754],["T_RETURN","return",755],["T_WHITESPACE"," ",755],["T_VARIABLE","$rates",755],";",["T_WHITESPACE","\n    ",755],"}",["T_WHITESPACE","\n\n    ",756],["T_DOC_COMMENT","\/**\n     * Retrieve all grouped shipping rates\n     *\n     * @return array\n     *\/",758],["T_WHITESPACE","\n    ",762],["T_PUBLIC","public",763],["T_WHITESPACE"," ",763],["T_FUNCTION","function",763],["T_WHITESPACE"," ",763],["T_STRING","getGroupedAllShippingRates",763],"(",")",["T_WHITESPACE","\n    ",763],"{",["T_WHITESPACE","\n        ",764],["T_VARIABLE","$rates",765],["T_WHITESPACE"," ",765],"=",["T_WHITESPACE"," ",765],["T_ARRAY","array",765],"(",")",";",["T_WHITESPACE","\n        ",765],["T_FOREACH","foreach",766],["T_WHITESPACE"," ",766],"(",["T_VARIABLE","$this",766],["T_OBJECT_OPERATOR","->",766],["T_STRING","getShippingRatesCollection",766],"(",")",["T_WHITESPACE"," ",766],["T_AS","as",766],["T_WHITESPACE"," ",766],["T_VARIABLE","$rate",766],")",["T_WHITESPACE"," ",766],"{",["T_WHITESPACE","\n            ",766],["T_IF","if",767],["T_WHITESPACE"," ",767],"(","!",["T_VARIABLE","$rate",767],["T_OBJECT_OPERATOR","->",767],["T_STRING","isDeleted",767],"(",")",["T_WHITESPACE"," ",767],["T_BOOLEAN_AND","&&",767],["T_WHITESPACE"," ",767],["T_VARIABLE","$rate",767],["T_OBJECT_OPERATOR","->",767],["T_STRING","getCarrierInstance",767],"(",")",")",["T_WHITESPACE"," ",767],"{",["T_WHITESPACE","\n                ",767],["T_IF","if",768],["T_WHITESPACE"," ",768],"(","!",["T_ISSET","isset",768],"(",["T_VARIABLE","$rates",768],"[",["T_VARIABLE","$rate",768],["T_OBJECT_OPERATOR","->",768],["T_STRING","getCarrier",768],"(",")","]",")",")",["T_WHITESPACE"," ",768],"{",["T_WHITESPACE","\n                    ",768],["T_VARIABLE","$rates",769],"[",["T_VARIABLE","$rate",769],["T_OBJECT_OPERATOR","->",769],["T_STRING","getCarrier",769],"(",")","]",["T_WHITESPACE"," ",769],"=",["T_WHITESPACE"," ",769],["T_ARRAY","array",769],"(",")",";",["T_WHITESPACE","\n                ",769],"}",["T_WHITESPACE","\n\n                ",770],["T_VARIABLE","$rates",772],"[",["T_VARIABLE","$rate",772],["T_OBJECT_OPERATOR","->",772],["T_STRING","getCarrier",772],"(",")","]","[","]",["T_WHITESPACE"," ",772],"=",["T_WHITESPACE"," ",772],["T_VARIABLE","$rate",772],";",["T_WHITESPACE","\n                ",772],["T_VARIABLE","$rates",773],"[",["T_VARIABLE","$rate",773],["T_OBJECT_OPERATOR","->",773],["T_STRING","getCarrier",773],"(",")","]","[",["T_LNUMBER","0",773],"]",["T_OBJECT_OPERATOR","->",773],["T_STRING","carrier_sort_order",773],["T_WHITESPACE"," ",773],"=",["T_WHITESPACE"," ",773],["T_VARIABLE","$rate",773],["T_OBJECT_OPERATOR","->",773],["T_STRING","getCarrierInstance",773],"(",")",["T_OBJECT_OPERATOR","->",773],["T_STRING","getSortOrder",773],"(",")",";",["T_WHITESPACE","\n            ",773],"}",["T_WHITESPACE","\n        ",774],"}",["T_WHITESPACE","\n        ",775],["T_STRING","uasort",776],"(",["T_VARIABLE","$rates",776],",",["T_WHITESPACE"," ",776],["T_ARRAY","array",776],"(",["T_VARIABLE","$this",776],",",["T_WHITESPACE"," ",776],["T_CONSTANT_ENCAPSED_STRING","'_sortRates'",776],")",")",";",["T_WHITESPACE","\n        ",776],["T_RETURN","return",777],["T_WHITESPACE"," ",777],["T_VARIABLE","$rates",777],";",["T_WHITESPACE","\n    ",777],"}",["T_WHITESPACE","\n\n    ",778],["T_DOC_COMMENT","\/**\n     * Sort rates recursive callback\n     *\n     * @param array $a\n     * @param array $b\n     * @return int\n     *\/",780],["T_WHITESPACE","\n    ",786],["T_PROTECTED","protected",787],["T_WHITESPACE"," ",787],["T_FUNCTION","function",787],["T_WHITESPACE"," ",787],["T_STRING","_sortRates",787],"(",["T_VARIABLE","$a",787],",",["T_WHITESPACE"," ",787],["T_VARIABLE","$b",787],")",["T_WHITESPACE","\n    ",787],"{",["T_WHITESPACE","\n        ",788],["T_IF","if",789],["T_WHITESPACE"," ",789],"(",["T_INT_CAST","(int)",789],["T_VARIABLE","$a",789],"[",["T_LNUMBER","0",789],"]",["T_OBJECT_OPERATOR","->",789],["T_STRING","carrier_sort_order",789],["T_WHITESPACE"," ",789],"<",["T_WHITESPACE"," ",789],["T_INT_CAST","(int)",789],["T_VARIABLE","$b",789],"[",["T_LNUMBER","0",789],"]",["T_OBJECT_OPERATOR","->",789],["T_STRING","carrier_sort_order",789],")",["T_WHITESPACE"," ",789],"{",["T_WHITESPACE","\n            ",789],["T_RETURN","return",790],["T_WHITESPACE"," ",790],"-",["T_LNUMBER","1",790],";",["T_WHITESPACE","\n        ",790],"}",["T_WHITESPACE"," ",791],["T_ELSEIF","elseif",791],["T_WHITESPACE"," ",791],"(",["T_INT_CAST","(int)",791],["T_VARIABLE","$a",791],"[",["T_LNUMBER","0",791],"]",["T_OBJECT_OPERATOR","->",791],["T_STRING","carrier_sort_order",791],["T_WHITESPACE"," ",791],">",["T_WHITESPACE"," ",791],["T_INT_CAST","(int)",791],["T_VARIABLE","$b",791],"[",["T_LNUMBER","0",791],"]",["T_OBJECT_OPERATOR","->",791],["T_STRING","carrier_sort_order",791],")",["T_WHITESPACE"," ",791],"{",["T_WHITESPACE","\n            ",791],["T_RETURN","return",792],["T_WHITESPACE"," ",792],["T_LNUMBER","1",792],";",["T_WHITESPACE","\n        ",792],"}",["T_WHITESPACE"," ",793],["T_ELSE","else",793],["T_WHITESPACE"," ",793],"{",["T_WHITESPACE","\n            ",793],["T_RETURN","return",794],["T_WHITESPACE"," ",794],["T_LNUMBER","0",794],";",["T_WHITESPACE","\n        ",794],"}",["T_WHITESPACE","\n    ",795],"}",["T_WHITESPACE","\n\n    ",796],["T_DOC_COMMENT","\/**\n     * Retrieve shipping rate by identifier\n     *\n     * @param   int $rateId\n     * @return  Mage_Sales_Model_Quote_Address_Rate | false\n     *\/",798],["T_WHITESPACE","\n    ",803],["T_PUBLIC","public",804],["T_WHITESPACE"," ",804],["T_FUNCTION","function",804],["T_WHITESPACE"," ",804],["T_STRING","getShippingRateById",804],"(",["T_VARIABLE","$rateId",804],")",["T_WHITESPACE","\n    ",804],"{",["T_WHITESPACE","\n        ",805],["T_FOREACH","foreach",806],["T_WHITESPACE"," ",806],"(",["T_VARIABLE","$this",806],["T_OBJECT_OPERATOR","->",806],["T_STRING","getShippingRatesCollection",806],"(",")",["T_WHITESPACE"," ",806],["T_AS","as",806],["T_WHITESPACE"," ",806],["T_VARIABLE","$rate",806],")",["T_WHITESPACE"," ",806],"{",["T_WHITESPACE","\n            ",806],["T_IF","if",807],["T_WHITESPACE"," ",807],"(",["T_VARIABLE","$rate",807],["T_OBJECT_OPERATOR","->",807],["T_STRING","getId",807],"(",")",["T_WHITESPACE"," ",807],["T_IS_EQUAL","==",807],["T_WHITESPACE"," ",807],["T_VARIABLE","$rateId",807],")",["T_WHITESPACE"," ",807],"{",["T_WHITESPACE","\n                ",807],["T_RETURN","return",808],["T_WHITESPACE"," ",808],["T_VARIABLE","$rate",808],";",["T_WHITESPACE","\n            ",808],"}",["T_WHITESPACE","\n        ",809],"}",["T_WHITESPACE","\n        ",810],["T_RETURN","return",811],["T_WHITESPACE"," ",811],["T_STRING","false",811],";",["T_WHITESPACE","\n    ",811],"}",["T_WHITESPACE","\n\n    ",812],["T_DOC_COMMENT","\/**\n     * Retrieve shipping rate by code\n     *\n     * @param   string $code\n     * @return  Mage_Sales_Model_Quote_Address_Rate\n     *\/",814],["T_WHITESPACE","\n    ",819],["T_PUBLIC","public",820],["T_WHITESPACE"," ",820],["T_FUNCTION","function",820],["T_WHITESPACE"," ",820],["T_STRING","getShippingRateByCode",820],"(",["T_VARIABLE","$code",820],")",["T_WHITESPACE","\n    ",820],"{",["T_WHITESPACE","\n        ",821],["T_FOREACH","foreach",822],["T_WHITESPACE"," ",822],"(",["T_VARIABLE","$this",822],["T_OBJECT_OPERATOR","->",822],["T_STRING","getShippingRatesCollection",822],"(",")",["T_WHITESPACE"," ",822],["T_AS","as",822],["T_WHITESPACE"," ",822],["T_VARIABLE","$rate",822],")",["T_WHITESPACE"," ",822],"{",["T_WHITESPACE","\n            ",822],["T_IF","if",823],["T_WHITESPACE"," ",823],"(",["T_VARIABLE","$rate",823],["T_OBJECT_OPERATOR","->",823],["T_STRING","getCode",823],"(",")",["T_WHITESPACE"," ",823],["T_IS_EQUAL","==",823],["T_WHITESPACE"," ",823],["T_VARIABLE","$code",823],")",["T_WHITESPACE"," ",823],"{",["T_WHITESPACE","\n                ",823],["T_RETURN","return",824],["T_WHITESPACE"," ",824],["T_VARIABLE","$rate",824],";",["T_WHITESPACE","\n            ",824],"}",["T_WHITESPACE","\n        ",825],"}",["T_WHITESPACE","\n        ",826],["T_RETURN","return",827],["T_WHITESPACE"," ",827],["T_STRING","false",827],";",["T_WHITESPACE","\n    ",827],"}",["T_WHITESPACE","\n\n    ",828],["T_DOC_COMMENT","\/**\n     * Mark all shipping rates as deleted\n     *\n     * @return Mage_Sales_Model_Quote_Address\n     *\/",830],["T_WHITESPACE","\n    ",834],["T_PUBLIC","public",835],["T_WHITESPACE"," ",835],["T_FUNCTION","function",835],["T_WHITESPACE"," ",835],["T_STRING","removeAllShippingRates",835],"(",")",["T_WHITESPACE","\n    ",835],"{",["T_WHITESPACE","\n        ",836],["T_FOREACH","foreach",837],["T_WHITESPACE"," ",837],"(",["T_VARIABLE","$this",837],["T_OBJECT_OPERATOR","->",837],["T_STRING","getShippingRatesCollection",837],"(",")",["T_WHITESPACE"," ",837],["T_AS","as",837],["T_WHITESPACE"," ",837],["T_VARIABLE","$rate",837],")",["T_WHITESPACE"," ",837],"{",["T_WHITESPACE","\n            ",837],["T_VARIABLE","$rate",838],["T_OBJECT_OPERATOR","->",838],["T_STRING","isDeleted",838],"(",["T_STRING","true",838],")",";",["T_WHITESPACE","\n        ",838],"}",["T_WHITESPACE","\n        ",839],["T_RETURN","return",840],["T_WHITESPACE"," ",840],["T_VARIABLE","$this",840],";",["T_WHITESPACE","\n    ",840],"}",["T_WHITESPACE","\n\n    ",841],["T_DOC_COMMENT","\/**\n     * Add shipping rate\n     *\n     * @param Mage_Sales_Model_Quote_Address_Rate $rate\n     * @return Mage_Sales_Model_Quote_Address\n     *\/",843],["T_WHITESPACE","\n    ",848],["T_PUBLIC","public",849],["T_WHITESPACE"," ",849],["T_FUNCTION","function",849],["T_WHITESPACE"," ",849],["T_STRING","addShippingRate",849],"(",["T_STRING","Mage_Sales_Model_Quote_Address_Rate",849],["T_WHITESPACE"," ",849],["T_VARIABLE","$rate",849],")",["T_WHITESPACE","\n    ",849],"{",["T_WHITESPACE","\n        ",850],["T_VARIABLE","$rate",851],["T_OBJECT_OPERATOR","->",851],["T_STRING","setAddress",851],"(",["T_VARIABLE","$this",851],")",";",["T_WHITESPACE","\n        ",851],["T_VARIABLE","$this",852],["T_OBJECT_OPERATOR","->",852],["T_STRING","getShippingRatesCollection",852],"(",")",["T_OBJECT_OPERATOR","->",852],["T_STRING","addItem",852],"(",["T_VARIABLE","$rate",852],")",";",["T_WHITESPACE","\n        ",852],["T_RETURN","return",853],["T_WHITESPACE"," ",853],["T_VARIABLE","$this",853],";",["T_WHITESPACE","\n    ",853],"}",["T_WHITESPACE","\n\n    ",854],["T_DOC_COMMENT","\/**\n     * Collecting shipping rates by address\n     *\n     * @return Mage_Sales_Model_Quote_Address\n     *\/",856],["T_WHITESPACE","\n    ",860],["T_PUBLIC","public",861],["T_WHITESPACE"," ",861],["T_FUNCTION","function",861],["T_WHITESPACE"," ",861],["T_STRING","collectShippingRates",861],"(",")",["T_WHITESPACE","\n    ",861],"{",["T_WHITESPACE","\n        ",862],["T_IF","if",863],["T_WHITESPACE"," ",863],"(","!",["T_VARIABLE","$this",863],["T_OBJECT_OPERATOR","->",863],["T_STRING","getCollectShippingRates",863],"(",")",")",["T_WHITESPACE"," ",863],"{",["T_WHITESPACE","\n            ",863],["T_RETURN","return",864],["T_WHITESPACE"," ",864],["T_VARIABLE","$this",864],";",["T_WHITESPACE","\n        ",864],"}",["T_WHITESPACE","\n\n        ",865],["T_VARIABLE","$this",867],["T_OBJECT_OPERATOR","->",867],["T_STRING","setCollectShippingRates",867],"(",["T_STRING","false",867],")",";",["T_WHITESPACE","\n\n        ",867],["T_VARIABLE","$this",869],["T_OBJECT_OPERATOR","->",869],["T_STRING","removeAllShippingRates",869],"(",")",";",["T_WHITESPACE","\n\n        ",869],["T_IF","if",871],["T_WHITESPACE"," ",871],"(","!",["T_VARIABLE","$this",871],["T_OBJECT_OPERATOR","->",871],["T_STRING","getCountryId",871],"(",")",")",["T_WHITESPACE"," ",871],"{",["T_WHITESPACE","\n            ",871],["T_RETURN","return",872],["T_WHITESPACE"," ",872],["T_VARIABLE","$this",872],";",["T_WHITESPACE","\n        ",872],"}",["T_WHITESPACE","\n\n        ",873],["T_VARIABLE","$found",875],["T_WHITESPACE"," ",875],"=",["T_WHITESPACE"," ",875],["T_VARIABLE","$this",875],["T_OBJECT_OPERATOR","->",875],["T_STRING","requestShippingRates",875],"(",")",";",["T_WHITESPACE","\n        ",875],["T_IF","if",876],["T_WHITESPACE"," ",876],"(","!",["T_VARIABLE","$found",876],")",["T_WHITESPACE"," ",876],"{",["T_WHITESPACE","\n            ",876],["T_VARIABLE","$this",877],["T_OBJECT_OPERATOR","->",877],["T_STRING","setShippingAmount",877],"(",["T_LNUMBER","0",877],")",["T_WHITESPACE","\n                ",877],["T_OBJECT_OPERATOR","->",878],["T_STRING","setBaseShippingAmount",878],"(",["T_LNUMBER","0",878],")",["T_WHITESPACE","\n                ",878],["T_OBJECT_OPERATOR","->",879],["T_STRING","setShippingMethod",879],"(",["T_CONSTANT_ENCAPSED_STRING","''",879],")",["T_WHITESPACE","\n                ",879],["T_OBJECT_OPERATOR","->",880],["T_STRING","setShippingDescription",880],"(",["T_CONSTANT_ENCAPSED_STRING","''",880],")",";",["T_WHITESPACE","\n        ",880],"}",["T_WHITESPACE","\n\n        ",881],["T_RETURN","return",883],["T_WHITESPACE"," ",883],["T_VARIABLE","$this",883],";",["T_WHITESPACE","\n    ",883],"}",["T_WHITESPACE","\n\n    ",884],["T_DOC_COMMENT","\/**\n     * Request shipping rates for entire address or specified address item\n     * Returns true if current selected shipping method code corresponds to one of the found rates\n     *\n     * @param Mage_Sales_Model_Quote_Item_Abstract $item\n     * @return bool\n     *\/",886],["T_WHITESPACE","\n    ",892],["T_PUBLIC","public",893],["T_WHITESPACE"," ",893],["T_FUNCTION","function",893],["T_WHITESPACE"," ",893],["T_STRING","requestShippingRates",893],"(",["T_STRING","Mage_Sales_Model_Quote_Item_Abstract",893],["T_WHITESPACE"," ",893],["T_VARIABLE","$item",893],["T_WHITESPACE"," ",893],"=",["T_WHITESPACE"," ",893],["T_STRING","null",893],")",["T_WHITESPACE","\n    ",893],"{",["T_WHITESPACE","\n        ",894],["T_DOC_COMMENT","\/** @var $request Mage_Shipping_Model_Rate_Request *\/",895],["T_WHITESPACE","\n        ",895],["T_VARIABLE","$request",896],["T_WHITESPACE"," ",896],"=",["T_WHITESPACE"," ",896],["T_STRING","Mage",896],["T_DOUBLE_COLON","::",896],["T_STRING","getModel",896],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping\/rate_request'",896],")",";",["T_WHITESPACE","\n        ",896],["T_VARIABLE","$request",897],["T_OBJECT_OPERATOR","->",897],["T_STRING","setAllItems",897],"(",["T_VARIABLE","$item",897],["T_WHITESPACE"," ",897],"?",["T_WHITESPACE"," ",897],["T_ARRAY","array",897],"(",["T_VARIABLE","$item",897],")",["T_WHITESPACE"," ",897],":",["T_WHITESPACE"," ",897],["T_VARIABLE","$this",897],["T_OBJECT_OPERATOR","->",897],["T_STRING","getAllItems",897],"(",")",")",";",["T_WHITESPACE","\n        ",897],["T_VARIABLE","$request",898],["T_OBJECT_OPERATOR","->",898],["T_STRING","setDestCountryId",898],"(",["T_VARIABLE","$this",898],["T_OBJECT_OPERATOR","->",898],["T_STRING","getCountryId",898],"(",")",")",";",["T_WHITESPACE","\n        ",898],["T_VARIABLE","$request",899],["T_OBJECT_OPERATOR","->",899],["T_STRING","setDestRegionId",899],"(",["T_VARIABLE","$this",899],["T_OBJECT_OPERATOR","->",899],["T_STRING","getRegionId",899],"(",")",")",";",["T_WHITESPACE","\n        ",899],["T_VARIABLE","$request",900],["T_OBJECT_OPERATOR","->",900],["T_STRING","setDestRegionCode",900],"(",["T_VARIABLE","$this",900],["T_OBJECT_OPERATOR","->",900],["T_STRING","getRegionCode",900],"(",")",")",";",["T_WHITESPACE","\n        ",900],["T_DOC_COMMENT","\/**\n         * need to call getStreet with -1\n         * to get data in string instead of array\n         *\/",901],["T_WHITESPACE","\n        ",904],["T_VARIABLE","$request",905],["T_OBJECT_OPERATOR","->",905],["T_STRING","setDestStreet",905],"(",["T_VARIABLE","$this",905],["T_OBJECT_OPERATOR","->",905],["T_STRING","getStreet",905],"(",["T_STRING","self",905],["T_DOUBLE_COLON","::",905],["T_STRING","DEFAULT_DEST_STREET",905],")",")",";",["T_WHITESPACE","\n        ",905],["T_VARIABLE","$request",906],["T_OBJECT_OPERATOR","->",906],["T_STRING","setDestCity",906],"(",["T_VARIABLE","$this",906],["T_OBJECT_OPERATOR","->",906],["T_STRING","getCity",906],"(",")",")",";",["T_WHITESPACE","\n        ",906],["T_VARIABLE","$request",907],["T_OBJECT_OPERATOR","->",907],["T_STRING","setDestPostcode",907],"(",["T_VARIABLE","$this",907],["T_OBJECT_OPERATOR","->",907],["T_STRING","getPostcode",907],"(",")",")",";",["T_WHITESPACE","\n        ",907],["T_VARIABLE","$request",908],["T_OBJECT_OPERATOR","->",908],["T_STRING","setPackageValue",908],"(",["T_VARIABLE","$item",908],["T_WHITESPACE"," ",908],"?",["T_WHITESPACE"," ",908],["T_VARIABLE","$item",908],["T_OBJECT_OPERATOR","->",908],["T_STRING","getBaseRowTotal",908],"(",")",["T_WHITESPACE"," ",908],":",["T_WHITESPACE"," ",908],["T_VARIABLE","$this",908],["T_OBJECT_OPERATOR","->",908],["T_STRING","getBaseSubtotal",908],"(",")",")",";",["T_WHITESPACE","\n        ",908],["T_VARIABLE","$packageValueWithDiscount",909],["T_WHITESPACE"," ",909],"=",["T_WHITESPACE"," ",909],["T_VARIABLE","$item",909],["T_WHITESPACE","\n            ",909],"?",["T_WHITESPACE"," ",910],["T_VARIABLE","$item",910],["T_OBJECT_OPERATOR","->",910],["T_STRING","getBaseRowTotal",910],"(",")",["T_WHITESPACE"," ",910],"-",["T_WHITESPACE"," ",910],["T_VARIABLE","$item",910],["T_OBJECT_OPERATOR","->",910],["T_STRING","getBaseDiscountAmount",910],"(",")",["T_WHITESPACE","\n            ",910],":",["T_WHITESPACE"," ",911],["T_VARIABLE","$this",911],["T_OBJECT_OPERATOR","->",911],["T_STRING","getBaseSubtotalWithDiscount",911],"(",")",";",["T_WHITESPACE","\n        ",911],["T_VARIABLE","$request",912],["T_OBJECT_OPERATOR","->",912],["T_STRING","setPackageValueWithDiscount",912],"(",["T_VARIABLE","$packageValueWithDiscount",912],")",";",["T_WHITESPACE","\n        ",912],["T_VARIABLE","$request",913],["T_OBJECT_OPERATOR","->",913],["T_STRING","setPackageWeight",913],"(",["T_VARIABLE","$item",913],["T_WHITESPACE"," ",913],"?",["T_WHITESPACE"," ",913],["T_VARIABLE","$item",913],["T_OBJECT_OPERATOR","->",913],["T_STRING","getRowWeight",913],"(",")",["T_WHITESPACE"," ",913],":",["T_WHITESPACE"," ",913],["T_VARIABLE","$this",913],["T_OBJECT_OPERATOR","->",913],["T_STRING","getWeight",913],"(",")",")",";",["T_WHITESPACE","\n        ",913],["T_VARIABLE","$request",914],["T_OBJECT_OPERATOR","->",914],["T_STRING","setPackageQty",914],"(",["T_VARIABLE","$item",914],["T_WHITESPACE"," ",914],"?",["T_WHITESPACE"," ",914],["T_VARIABLE","$item",914],["T_OBJECT_OPERATOR","->",914],["T_STRING","getQty",914],"(",")",["T_WHITESPACE"," ",914],":",["T_WHITESPACE"," ",914],["T_VARIABLE","$this",914],["T_OBJECT_OPERATOR","->",914],["T_STRING","getItemQty",914],"(",")",")",";",["T_WHITESPACE","\n\n        ",914],["T_DOC_COMMENT","\/**\n         * Need for shipping methods that use insurance based on price of physical products\n         *\/",916],["T_WHITESPACE","\n        ",918],["T_VARIABLE","$packagePhysicalValue",919],["T_WHITESPACE"," ",919],"=",["T_WHITESPACE"," ",919],["T_VARIABLE","$item",919],["T_WHITESPACE","\n            ",919],"?",["T_WHITESPACE"," ",920],["T_VARIABLE","$item",920],["T_OBJECT_OPERATOR","->",920],["T_STRING","getBaseRowTotal",920],"(",")",["T_WHITESPACE","\n            ",920],":",["T_WHITESPACE"," ",921],["T_VARIABLE","$this",921],["T_OBJECT_OPERATOR","->",921],["T_STRING","getBaseSubtotal",921],"(",")",["T_WHITESPACE"," ",921],"-",["T_WHITESPACE"," ",921],["T_VARIABLE","$this",921],["T_OBJECT_OPERATOR","->",921],["T_STRING","getBaseVirtualAmount",921],"(",")",";",["T_WHITESPACE","\n        ",921],["T_VARIABLE","$request",922],["T_OBJECT_OPERATOR","->",922],["T_STRING","setPackagePhysicalValue",922],"(",["T_VARIABLE","$packagePhysicalValue",922],")",";",["T_WHITESPACE","\n\n        ",922],["T_VARIABLE","$request",924],["T_OBJECT_OPERATOR","->",924],["T_STRING","setFreeMethodWeight",924],"(",["T_VARIABLE","$item",924],["T_WHITESPACE"," ",924],"?",["T_WHITESPACE"," ",924],["T_LNUMBER","0",924],["T_WHITESPACE"," ",924],":",["T_WHITESPACE"," ",924],["T_VARIABLE","$this",924],["T_OBJECT_OPERATOR","->",924],["T_STRING","getFreeMethodWeight",924],"(",")",")",";",["T_WHITESPACE","\n\n        ",924],["T_DOC_COMMENT","\/**\n         * Store and website identifiers need specify from quote\n         *\/",926],["T_WHITESPACE","\n        ",928],["T_COMMENT","\/*$request->setStoreId(Mage::app()->getStore()->getId());\n        $request->setWebsiteId(Mage::app()->getStore()->getWebsiteId());*\/",929],["T_WHITESPACE","\n\n        ",930],["T_VARIABLE","$request",932],["T_OBJECT_OPERATOR","->",932],["T_STRING","setStoreId",932],"(",["T_VARIABLE","$this",932],["T_OBJECT_OPERATOR","->",932],["T_STRING","getQuote",932],"(",")",["T_OBJECT_OPERATOR","->",932],["T_STRING","getStore",932],"(",")",["T_OBJECT_OPERATOR","->",932],["T_STRING","getId",932],"(",")",")",";",["T_WHITESPACE","\n        ",932],["T_VARIABLE","$request",933],["T_OBJECT_OPERATOR","->",933],["T_STRING","setWebsiteId",933],"(",["T_VARIABLE","$this",933],["T_OBJECT_OPERATOR","->",933],["T_STRING","getQuote",933],"(",")",["T_OBJECT_OPERATOR","->",933],["T_STRING","getStore",933],"(",")",["T_OBJECT_OPERATOR","->",933],["T_STRING","getWebsiteId",933],"(",")",")",";",["T_WHITESPACE","\n        ",933],["T_VARIABLE","$request",934],["T_OBJECT_OPERATOR","->",934],["T_STRING","setFreeShipping",934],"(",["T_VARIABLE","$this",934],["T_OBJECT_OPERATOR","->",934],["T_STRING","getFreeShipping",934],"(",")",")",";",["T_WHITESPACE","\n        ",934],["T_DOC_COMMENT","\/**\n         * Currencies need to convert in free shipping\n         *\/",935],["T_WHITESPACE","\n        ",937],["T_VARIABLE","$request",938],["T_OBJECT_OPERATOR","->",938],["T_STRING","setBaseCurrency",938],"(",["T_VARIABLE","$this",938],["T_OBJECT_OPERATOR","->",938],["T_STRING","getQuote",938],"(",")",["T_OBJECT_OPERATOR","->",938],["T_STRING","getStore",938],"(",")",["T_OBJECT_OPERATOR","->",938],["T_STRING","getBaseCurrency",938],"(",")",")",";",["T_WHITESPACE","\n        ",938],["T_VARIABLE","$request",939],["T_OBJECT_OPERATOR","->",939],["T_STRING","setPackageCurrency",939],"(",["T_VARIABLE","$this",939],["T_OBJECT_OPERATOR","->",939],["T_STRING","getQuote",939],"(",")",["T_OBJECT_OPERATOR","->",939],["T_STRING","getStore",939],"(",")",["T_OBJECT_OPERATOR","->",939],["T_STRING","getCurrentCurrency",939],"(",")",")",";",["T_WHITESPACE","\n        ",939],["T_VARIABLE","$request",940],["T_OBJECT_OPERATOR","->",940],["T_STRING","setLimitCarrier",940],"(",["T_VARIABLE","$this",940],["T_OBJECT_OPERATOR","->",940],["T_STRING","getLimitCarrier",940],"(",")",")",";",["T_WHITESPACE","\n\n        ",940],["T_VARIABLE","$request",942],["T_OBJECT_OPERATOR","->",942],["T_STRING","setBaseSubtotalInclTax",942],"(",["T_VARIABLE","$this",942],["T_OBJECT_OPERATOR","->",942],["T_STRING","getBaseSubtotalInclTax",942],"(",")",["T_WHITESPACE"," ",942],"+",["T_WHITESPACE"," ",942],["T_VARIABLE","$this",942],["T_OBJECT_OPERATOR","->",942],["T_STRING","getBaseExtraTaxAmount",942],"(",")",")",";",["T_WHITESPACE","\n\n        ",942],["T_VARIABLE","$result",944],["T_WHITESPACE"," ",944],"=",["T_WHITESPACE"," ",944],["T_STRING","Mage",944],["T_DOUBLE_COLON","::",944],["T_STRING","getModel",944],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping\/shipping'",944],")",["T_OBJECT_OPERATOR","->",944],["T_STRING","collectRates",944],"(",["T_VARIABLE","$request",944],")",["T_OBJECT_OPERATOR","->",944],["T_STRING","getResult",944],"(",")",";",["T_WHITESPACE","\n\n        ",944],["T_VARIABLE","$found",946],["T_WHITESPACE"," ",946],"=",["T_WHITESPACE"," ",946],["T_STRING","false",946],";",["T_WHITESPACE","\n        ",946],["T_IF","if",947],["T_WHITESPACE"," ",947],"(",["T_VARIABLE","$result",947],")",["T_WHITESPACE"," ",947],"{",["T_WHITESPACE","\n            ",947],["T_VARIABLE","$shippingRates",948],["T_WHITESPACE"," ",948],"=",["T_WHITESPACE"," ",948],["T_VARIABLE","$result",948],["T_OBJECT_OPERATOR","->",948],["T_STRING","getAllRates",948],"(",")",";",["T_WHITESPACE","\n\n            ",948],["T_FOREACH","foreach",950],["T_WHITESPACE"," ",950],"(",["T_VARIABLE","$shippingRates",950],["T_WHITESPACE"," ",950],["T_AS","as",950],["T_WHITESPACE"," ",950],["T_VARIABLE","$shippingRate",950],")",["T_WHITESPACE"," ",950],"{",["T_WHITESPACE","\n                ",950],["T_VARIABLE","$rate",951],["T_WHITESPACE"," ",951],"=",["T_WHITESPACE"," ",951],["T_STRING","Mage",951],["T_DOUBLE_COLON","::",951],["T_STRING","getModel",951],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/quote_address_rate'",951],")",["T_WHITESPACE","\n                    ",951],["T_OBJECT_OPERATOR","->",952],["T_STRING","importShippingRate",952],"(",["T_VARIABLE","$shippingRate",952],")",";",["T_WHITESPACE","\n                ",952],["T_IF","if",953],["T_WHITESPACE"," ",953],"(","!",["T_VARIABLE","$item",953],")",["T_WHITESPACE"," ",953],"{",["T_WHITESPACE","\n                    ",953],["T_VARIABLE","$this",954],["T_OBJECT_OPERATOR","->",954],["T_STRING","addShippingRate",954],"(",["T_VARIABLE","$rate",954],")",";",["T_WHITESPACE","\n                ",954],"}",["T_WHITESPACE","\n\n                ",955],["T_IF","if",957],["T_WHITESPACE"," ",957],"(",["T_VARIABLE","$this",957],["T_OBJECT_OPERATOR","->",957],["T_STRING","getShippingMethod",957],"(",")",["T_WHITESPACE"," ",957],["T_IS_EQUAL","==",957],["T_WHITESPACE"," ",957],["T_VARIABLE","$rate",957],["T_OBJECT_OPERATOR","->",957],["T_STRING","getCode",957],"(",")",")",["T_WHITESPACE"," ",957],"{",["T_WHITESPACE","\n                    ",957],["T_IF","if",958],["T_WHITESPACE"," ",958],"(",["T_VARIABLE","$item",958],")",["T_WHITESPACE"," ",958],"{",["T_WHITESPACE","\n                        ",958],["T_VARIABLE","$item",959],["T_OBJECT_OPERATOR","->",959],["T_STRING","setBaseShippingAmount",959],"(",["T_VARIABLE","$rate",959],["T_OBJECT_OPERATOR","->",959],["T_STRING","getPrice",959],"(",")",")",";",["T_WHITESPACE","\n                    ",959],"}",["T_WHITESPACE"," ",960],["T_ELSE","else",960],["T_WHITESPACE"," ",960],"{",["T_WHITESPACE","\n                        ",960],["T_DOC_COMMENT","\/**\n                         * possible bug: this should be setBaseShippingAmount(),\n                         * see Mage_Sales_Model_Quote_Address_Total_Shipping::collect()\n                         * where this value is set again from the current specified rate price\n                         * (looks like a workaround for this bug)\n                         *\/",961],["T_WHITESPACE","\n                        ",966],["T_VARIABLE","$this",967],["T_OBJECT_OPERATOR","->",967],["T_STRING","setShippingAmount",967],"(",["T_VARIABLE","$rate",967],["T_OBJECT_OPERATOR","->",967],["T_STRING","getPrice",967],"(",")",")",";",["T_WHITESPACE","\n                    ",967],"}",["T_WHITESPACE","\n\n                    ",968],["T_VARIABLE","$found",970],["T_WHITESPACE"," ",970],"=",["T_WHITESPACE"," ",970],["T_STRING","true",970],";",["T_WHITESPACE","\n                ",970],"}",["T_WHITESPACE","\n            ",971],"}",["T_WHITESPACE","\n        ",972],"}",["T_WHITESPACE","\n        ",973],["T_RETURN","return",974],["T_WHITESPACE"," ",974],["T_VARIABLE","$found",974],";",["T_WHITESPACE","\n    ",974],"}",["T_WHITESPACE","\n\n    ",975],["T_DOC_COMMENT","\/**\n     * Get totals collector model\n     *\n     * @return Mage_Sales_Model_Quote_Address_Total_Collector\n     *\/",977],["T_WHITESPACE","\n    ",981],["T_PUBLIC","public",982],["T_WHITESPACE"," ",982],["T_FUNCTION","function",982],["T_WHITESPACE"," ",982],["T_STRING","getTotalCollector",982],"(",")",["T_WHITESPACE","\n    ",982],"{",["T_WHITESPACE","\n        ",983],["T_IF","if",984],["T_WHITESPACE"," ",984],"(",["T_VARIABLE","$this",984],["T_OBJECT_OPERATOR","->",984],["T_STRING","_totalCollector",984],["T_WHITESPACE"," ",984],["T_IS_IDENTICAL","===",984],["T_WHITESPACE"," ",984],["T_STRING","null",984],")",["T_WHITESPACE"," ",984],"{",["T_WHITESPACE","\n            ",984],["T_VARIABLE","$this",985],["T_OBJECT_OPERATOR","->",985],["T_STRING","_totalCollector",985],["T_WHITESPACE"," ",985],"=",["T_WHITESPACE"," ",985],["T_STRING","Mage",985],["T_DOUBLE_COLON","::",985],["T_STRING","getSingleton",985],"(",["T_WHITESPACE","\n                ",985],["T_CONSTANT_ENCAPSED_STRING","'sales\/quote_address_total_collector'",986],",",["T_WHITESPACE","\n                ",986],["T_ARRAY","array",987],"(",["T_CONSTANT_ENCAPSED_STRING","'store'",987],["T_WHITESPACE"," ",987],["T_DOUBLE_ARROW","=>",987],["T_WHITESPACE"," ",987],["T_VARIABLE","$this",987],["T_OBJECT_OPERATOR","->",987],["T_STRING","getQuote",987],"(",")",["T_OBJECT_OPERATOR","->",987],["T_STRING","getStore",987],"(",")",")",["T_WHITESPACE","\n            ",987],")",";",["T_WHITESPACE","\n        ",988],"}",["T_WHITESPACE","\n        ",989],["T_RETURN","return",990],["T_WHITESPACE"," ",990],["T_VARIABLE","$this",990],["T_OBJECT_OPERATOR","->",990],["T_STRING","_totalCollector",990],";",["T_WHITESPACE","\n    ",990],"}",["T_WHITESPACE","\n\n    ",991],["T_DOC_COMMENT","\/**\n     * Retrieve total models\n     *\n     * @deprecated\n     * @return array\n     *\/",993],["T_WHITESPACE","\n    ",998],["T_PUBLIC","public",999],["T_WHITESPACE"," ",999],["T_FUNCTION","function",999],["T_WHITESPACE"," ",999],["T_STRING","getTotalModels",999],"(",")",["T_WHITESPACE","\n    ",999],"{",["T_WHITESPACE","\n        ",1000],["T_RETURN","return",1001],["T_WHITESPACE"," ",1001],["T_VARIABLE","$this",1001],["T_OBJECT_OPERATOR","->",1001],["T_STRING","getTotalCollector",1001],"(",")",["T_OBJECT_OPERATOR","->",1001],["T_STRING","getRetrievers",1001],"(",")",";",["T_WHITESPACE","\n    ",1001],"}",["T_WHITESPACE","\n\n    ",1002],["T_DOC_COMMENT","\/**\n     * Collect address totals\n     *\n     * @return Mage_Sales_Model_Quote_Address\n     *\/",1004],["T_WHITESPACE","\n    ",1008],["T_PUBLIC","public",1009],["T_WHITESPACE"," ",1009],["T_FUNCTION","function",1009],["T_WHITESPACE"," ",1009],["T_STRING","collectTotals",1009],"(",")",["T_WHITESPACE","\n    ",1009],"{",["T_WHITESPACE","\n        ",1010],["T_STRING","Mage",1011],["T_DOUBLE_COLON","::",1011],["T_STRING","dispatchEvent",1011],"(",["T_VARIABLE","$this",1011],["T_OBJECT_OPERATOR","->",1011],["T_STRING","_eventPrefix",1011],["T_WHITESPACE"," ",1011],".",["T_WHITESPACE"," ",1011],["T_CONSTANT_ENCAPSED_STRING","'_collect_totals_before'",1011],",",["T_WHITESPACE"," ",1011],["T_ARRAY","array",1011],"(",["T_VARIABLE","$this",1011],["T_OBJECT_OPERATOR","->",1011],["T_STRING","_eventObject",1011],["T_WHITESPACE"," ",1011],["T_DOUBLE_ARROW","=>",1011],["T_WHITESPACE"," ",1011],["T_VARIABLE","$this",1011],")",")",";",["T_WHITESPACE","\n        ",1011],["T_FOREACH","foreach",1012],["T_WHITESPACE"," ",1012],"(",["T_VARIABLE","$this",1012],["T_OBJECT_OPERATOR","->",1012],["T_STRING","getTotalCollector",1012],"(",")",["T_OBJECT_OPERATOR","->",1012],["T_STRING","getCollectors",1012],"(",")",["T_WHITESPACE"," ",1012],["T_AS","as",1012],["T_WHITESPACE"," ",1012],["T_VARIABLE","$model",1012],")",["T_WHITESPACE"," ",1012],"{",["T_WHITESPACE","\n            ",1012],["T_VARIABLE","$model",1013],["T_OBJECT_OPERATOR","->",1013],["T_STRING","collect",1013],"(",["T_VARIABLE","$this",1013],")",";",["T_WHITESPACE","\n        ",1013],"}",["T_WHITESPACE","\n        ",1014],["T_STRING","Mage",1015],["T_DOUBLE_COLON","::",1015],["T_STRING","dispatchEvent",1015],"(",["T_VARIABLE","$this",1015],["T_OBJECT_OPERATOR","->",1015],["T_STRING","_eventPrefix",1015],["T_WHITESPACE"," ",1015],".",["T_WHITESPACE"," ",1015],["T_CONSTANT_ENCAPSED_STRING","'_collect_totals_after'",1015],",",["T_WHITESPACE"," ",1015],["T_ARRAY","array",1015],"(",["T_VARIABLE","$this",1015],["T_OBJECT_OPERATOR","->",1015],["T_STRING","_eventObject",1015],["T_WHITESPACE"," ",1015],["T_DOUBLE_ARROW","=>",1015],["T_WHITESPACE"," ",1015],["T_VARIABLE","$this",1015],")",")",";",["T_WHITESPACE","\n        ",1015],["T_RETURN","return",1016],["T_WHITESPACE"," ",1016],["T_VARIABLE","$this",1016],";",["T_WHITESPACE","\n    ",1016],"}",["T_WHITESPACE","\n\n    ",1017],["T_DOC_COMMENT","\/**\n     * Get address totals as array\n     *\n     * @return array\n     *\/",1019],["T_WHITESPACE","\n    ",1023],["T_PUBLIC","public",1024],["T_WHITESPACE"," ",1024],["T_FUNCTION","function",1024],["T_WHITESPACE"," ",1024],["T_STRING","getTotals",1024],"(",")",["T_WHITESPACE","\n    ",1024],"{",["T_WHITESPACE","\n        ",1025],["T_FOREACH","foreach",1026],["T_WHITESPACE"," ",1026],"(",["T_VARIABLE","$this",1026],["T_OBJECT_OPERATOR","->",1026],["T_STRING","getTotalCollector",1026],"(",")",["T_OBJECT_OPERATOR","->",1026],["T_STRING","getRetrievers",1026],"(",")",["T_WHITESPACE"," ",1026],["T_AS","as",1026],["T_WHITESPACE"," ",1026],["T_VARIABLE","$model",1026],")",["T_WHITESPACE"," ",1026],"{",["T_WHITESPACE","\n            ",1026],["T_VARIABLE","$model",1027],["T_OBJECT_OPERATOR","->",1027],["T_STRING","fetch",1027],"(",["T_VARIABLE","$this",1027],")",";",["T_WHITESPACE","\n        ",1027],"}",["T_WHITESPACE","\n        ",1028],["T_RETURN","return",1029],["T_WHITESPACE"," ",1029],["T_VARIABLE","$this",1029],["T_OBJECT_OPERATOR","->",1029],["T_STRING","_totals",1029],";",["T_WHITESPACE","\n    ",1029],"}",["T_WHITESPACE","\n\n    ",1030],["T_DOC_COMMENT","\/**\n     * Add total data or model\n     *\n     * @param Mage_Sales_Model_Quote_Total|array $total\n     * @return Mage_Sales_Model_Quote_Address\n     *\/",1032],["T_WHITESPACE","\n    ",1037],["T_PUBLIC","public",1038],["T_WHITESPACE"," ",1038],["T_FUNCTION","function",1038],["T_WHITESPACE"," ",1038],["T_STRING","addTotal",1038],"(",["T_VARIABLE","$total",1038],")",["T_WHITESPACE","\n    ",1038],"{",["T_WHITESPACE","\n        ",1039],["T_IF","if",1040],["T_WHITESPACE"," ",1040],"(",["T_STRING","is_array",1040],"(",["T_VARIABLE","$total",1040],")",")",["T_WHITESPACE"," ",1040],"{",["T_WHITESPACE","\n            ",1040],["T_VARIABLE","$totalInstance",1041],["T_WHITESPACE"," ",1041],"=",["T_WHITESPACE"," ",1041],["T_STRING","Mage",1041],["T_DOUBLE_COLON","::",1041],["T_STRING","getModel",1041],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/quote_address_total'",1041],")",["T_WHITESPACE","\n                ",1041],["T_OBJECT_OPERATOR","->",1042],["T_STRING","setData",1042],"(",["T_VARIABLE","$total",1042],")",";",["T_WHITESPACE","\n        ",1042],"}",["T_WHITESPACE"," ",1043],["T_ELSEIF","elseif",1043],["T_WHITESPACE"," ",1043],"(",["T_VARIABLE","$total",1043],["T_WHITESPACE"," ",1043],["T_INSTANCEOF","instanceof",1043],["T_WHITESPACE"," ",1043],["T_STRING","Mage_Sales_Model_Quote_Total",1043],")",["T_WHITESPACE"," ",1043],"{",["T_WHITESPACE","\n            ",1043],["T_VARIABLE","$totalInstance",1044],["T_WHITESPACE"," ",1044],"=",["T_WHITESPACE"," ",1044],["T_VARIABLE","$total",1044],";",["T_WHITESPACE","\n        ",1044],"}",["T_WHITESPACE","\n        ",1045],["T_VARIABLE","$totalInstance",1046],["T_OBJECT_OPERATOR","->",1046],["T_STRING","setAddress",1046],"(",["T_VARIABLE","$this",1046],")",";",["T_WHITESPACE","\n        ",1046],["T_VARIABLE","$this",1047],["T_OBJECT_OPERATOR","->",1047],["T_STRING","_totals",1047],"[",["T_VARIABLE","$totalInstance",1047],["T_OBJECT_OPERATOR","->",1047],["T_STRING","getCode",1047],"(",")","]",["T_WHITESPACE"," ",1047],"=",["T_WHITESPACE"," ",1047],["T_VARIABLE","$totalInstance",1047],";",["T_WHITESPACE","\n        ",1047],["T_RETURN","return",1048],["T_WHITESPACE"," ",1048],["T_VARIABLE","$this",1048],";",["T_WHITESPACE","\n    ",1048],"}",["T_WHITESPACE","\n\n    ",1049],["T_DOC_COMMENT","\/**\n     * Rewrite clone method\n     *\n     * @return Mage_Sales_Model_Quote_Address\n     *\/",1051],["T_WHITESPACE","\n    ",1055],["T_PUBLIC","public",1056],["T_WHITESPACE"," ",1056],["T_FUNCTION","function",1056],["T_WHITESPACE"," ",1056],["T_STRING","__clone",1056],"(",")",["T_WHITESPACE","\n    ",1056],"{",["T_WHITESPACE","\n        ",1057],["T_VARIABLE","$this",1058],["T_OBJECT_OPERATOR","->",1058],["T_STRING","setId",1058],"(",["T_STRING","null",1058],")",";",["T_WHITESPACE","\n    ",1058],"}",["T_WHITESPACE","\n\n    ",1059],["T_DOC_COMMENT","\/**\n     * Validate minimum amount\n     *\n     * @return bool\n     *\/",1061],["T_WHITESPACE","\n    ",1065],["T_PUBLIC","public",1066],["T_WHITESPACE"," ",1066],["T_FUNCTION","function",1066],["T_WHITESPACE"," ",1066],["T_STRING","validateMinimumAmount",1066],"(",")",["T_WHITESPACE","\n    ",1066],"{",["T_WHITESPACE","\n        ",1067],["T_VARIABLE","$storeId",1068],["T_WHITESPACE"," ",1068],"=",["T_WHITESPACE"," ",1068],["T_VARIABLE","$this",1068],["T_OBJECT_OPERATOR","->",1068],["T_STRING","getQuote",1068],"(",")",["T_OBJECT_OPERATOR","->",1068],["T_STRING","getStoreId",1068],"(",")",";",["T_WHITESPACE","\n        ",1068],["T_IF","if",1069],["T_WHITESPACE"," ",1069],"(","!",["T_STRING","Mage",1069],["T_DOUBLE_COLON","::",1069],["T_STRING","getStoreConfigFlag",1069],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/minimum_order\/active'",1069],",",["T_WHITESPACE"," ",1069],["T_VARIABLE","$storeId",1069],")",")",["T_WHITESPACE"," ",1069],"{",["T_WHITESPACE","\n            ",1069],["T_RETURN","return",1070],["T_WHITESPACE"," ",1070],["T_STRING","true",1070],";",["T_WHITESPACE","\n        ",1070],"}",["T_WHITESPACE","\n\n        ",1071],["T_IF","if",1073],["T_WHITESPACE"," ",1073],"(",["T_VARIABLE","$this",1073],["T_OBJECT_OPERATOR","->",1073],["T_STRING","getQuote",1073],"(",")",["T_OBJECT_OPERATOR","->",1073],["T_STRING","getIsVirtual",1073],"(",")",["T_WHITESPACE"," ",1073],["T_BOOLEAN_AND","&&",1073],["T_WHITESPACE"," ",1073],["T_VARIABLE","$this",1073],["T_OBJECT_OPERATOR","->",1073],["T_STRING","getAddressType",1073],"(",")",["T_WHITESPACE"," ",1073],["T_IS_EQUAL","==",1073],["T_WHITESPACE"," ",1073],["T_STRING","self",1073],["T_DOUBLE_COLON","::",1073],["T_STRING","TYPE_SHIPPING",1073],")",["T_WHITESPACE"," ",1073],"{",["T_WHITESPACE","\n            ",1073],["T_RETURN","return",1074],["T_WHITESPACE"," ",1074],["T_STRING","true",1074],";",["T_WHITESPACE","\n        ",1074],"}",["T_WHITESPACE"," ",1075],["T_ELSEIF","elseif",1075],["T_WHITESPACE"," ",1075],"(","!",["T_VARIABLE","$this",1075],["T_OBJECT_OPERATOR","->",1075],["T_STRING","getQuote",1075],"(",")",["T_OBJECT_OPERATOR","->",1075],["T_STRING","getIsVirtual",1075],"(",")",["T_WHITESPACE"," ",1075],["T_BOOLEAN_AND","&&",1075],["T_WHITESPACE"," ",1075],["T_VARIABLE","$this",1075],["T_OBJECT_OPERATOR","->",1075],["T_STRING","getAddressType",1075],"(",")",["T_WHITESPACE"," ",1075],["T_IS_NOT_EQUAL","!=",1075],["T_WHITESPACE"," ",1075],["T_STRING","self",1075],["T_DOUBLE_COLON","::",1075],["T_STRING","TYPE_SHIPPING",1075],")",["T_WHITESPACE"," ",1075],"{",["T_WHITESPACE","\n            ",1075],["T_RETURN","return",1076],["T_WHITESPACE"," ",1076],["T_STRING","true",1076],";",["T_WHITESPACE","\n        ",1076],"}",["T_WHITESPACE","\n\n        ",1077],["T_VARIABLE","$amount",1079],["T_WHITESPACE"," ",1079],"=",["T_WHITESPACE"," ",1079],["T_STRING","Mage",1079],["T_DOUBLE_COLON","::",1079],["T_STRING","getStoreConfig",1079],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/minimum_order\/amount'",1079],",",["T_WHITESPACE"," ",1079],["T_VARIABLE","$storeId",1079],")",";",["T_WHITESPACE","\n        ",1079],["T_IF","if",1080],["T_WHITESPACE"," ",1080],"(",["T_VARIABLE","$this",1080],["T_OBJECT_OPERATOR","->",1080],["T_STRING","getBaseSubtotalWithDiscount",1080],"(",")",["T_WHITESPACE"," ",1080],"<",["T_WHITESPACE"," ",1080],["T_VARIABLE","$amount",1080],")",["T_WHITESPACE"," ",1080],"{",["T_WHITESPACE","\n            ",1080],["T_RETURN","return",1081],["T_WHITESPACE"," ",1081],["T_STRING","false",1081],";",["T_WHITESPACE","\n        ",1081],"}",["T_WHITESPACE","\n        ",1082],["T_RETURN","return",1083],["T_WHITESPACE"," ",1083],["T_STRING","true",1083],";",["T_WHITESPACE","\n    ",1083],"}",["T_WHITESPACE","\n\n    ",1084],["T_DOC_COMMENT","\/**\n     * Retrieve applied taxes\n     *\n     * @return array\n     *\/",1086],["T_WHITESPACE","\n    ",1090],["T_PUBLIC","public",1091],["T_WHITESPACE"," ",1091],["T_FUNCTION","function",1091],["T_WHITESPACE"," ",1091],["T_STRING","getAppliedTaxes",1091],"(",")",["T_WHITESPACE","\n    ",1091],"{",["T_WHITESPACE","\n        ",1092],["T_TRY","try",1093],["T_WHITESPACE"," ",1093],"{",["T_WHITESPACE","\n            ",1093],["T_VARIABLE","$return",1094],["T_WHITESPACE"," ",1094],"=",["T_WHITESPACE"," ",1094],["T_STRING","Mage",1094],["T_DOUBLE_COLON","::",1094],["T_STRING","helper",1094],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/unserializeArray'",1094],")",["T_OBJECT_OPERATOR","->",1094],["T_STRING","unserialize",1094],"(",["T_VARIABLE","$this",1094],["T_OBJECT_OPERATOR","->",1094],["T_STRING","getData",1094],"(",["T_CONSTANT_ENCAPSED_STRING","'applied_taxes'",1094],")",")",";",["T_WHITESPACE","\n        ",1094],"}",["T_WHITESPACE"," ",1095],["T_CATCH","catch",1095],["T_WHITESPACE"," ",1095],"(",["T_STRING","Exception",1095],["T_WHITESPACE"," ",1095],["T_VARIABLE","$e",1095],")",["T_WHITESPACE"," ",1095],"{",["T_WHITESPACE","\n            ",1095],["T_VARIABLE","$return",1096],["T_WHITESPACE"," ",1096],"=",["T_WHITESPACE"," ",1096],["T_ARRAY","array",1096],"(",")",";",["T_WHITESPACE","\n        ",1096],"}",["T_WHITESPACE","\n        ",1097],["T_RETURN","return",1098],["T_WHITESPACE"," ",1098],["T_VARIABLE","$return",1098],";",["T_WHITESPACE","\n    ",1098],"}",["T_WHITESPACE","\n\n    ",1099],["T_DOC_COMMENT","\/**\n     * Set applied taxes\n     *\n     * @param array $data\n     * @return Mage_Sales_Model_Quote_Address\n     *\/",1101],["T_WHITESPACE","\n    ",1106],["T_PUBLIC","public",1107],["T_WHITESPACE"," ",1107],["T_FUNCTION","function",1107],["T_WHITESPACE"," ",1107],["T_STRING","setAppliedTaxes",1107],"(",["T_VARIABLE","$data",1107],")",["T_WHITESPACE","\n    ",1107],"{",["T_WHITESPACE","\n        ",1108],["T_RETURN","return",1109],["T_WHITESPACE"," ",1109],["T_VARIABLE","$this",1109],["T_OBJECT_OPERATOR","->",1109],["T_STRING","setData",1109],"(",["T_CONSTANT_ENCAPSED_STRING","'applied_taxes'",1109],",",["T_WHITESPACE"," ",1109],["T_STRING","serialize",1109],"(",["T_VARIABLE","$data",1109],")",")",";",["T_WHITESPACE","\n    ",1109],"}",["T_WHITESPACE","\n\n    ",1110],["T_DOC_COMMENT","\/**\n     * Set shipping amount\n     *\n     * @param float $value\n     * @param bool $alreadyExclTax\n     * @return Mage_Sales_Model_Quote_Address\n     *\/",1112],["T_WHITESPACE","\n    ",1118],["T_PUBLIC","public",1119],["T_WHITESPACE"," ",1119],["T_FUNCTION","function",1119],["T_WHITESPACE"," ",1119],["T_STRING","setShippingAmount",1119],"(",["T_VARIABLE","$value",1119],",",["T_WHITESPACE"," ",1119],["T_VARIABLE","$alreadyExclTax",1119],["T_WHITESPACE"," ",1119],"=",["T_WHITESPACE"," ",1119],["T_STRING","false",1119],")",["T_WHITESPACE","\n    ",1119],"{",["T_WHITESPACE","\n        ",1120],["T_RETURN","return",1121],["T_WHITESPACE"," ",1121],["T_VARIABLE","$this",1121],["T_OBJECT_OPERATOR","->",1121],["T_STRING","setData",1121],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping_amount'",1121],",",["T_WHITESPACE"," ",1121],["T_VARIABLE","$value",1121],")",";",["T_WHITESPACE","\n    ",1121],"}",["T_WHITESPACE","\n\n    ",1122],["T_DOC_COMMENT","\/**\n     * Set base shipping amount\n     *\n     * @param float $value\n     * @param bool $alreadyExclTax\n     * @return Mage_Sales_Model_Quote_Address\n     *\/",1124],["T_WHITESPACE","\n    ",1130],["T_PUBLIC","public",1131],["T_WHITESPACE"," ",1131],["T_FUNCTION","function",1131],["T_WHITESPACE"," ",1131],["T_STRING","setBaseShippingAmount",1131],"(",["T_VARIABLE","$value",1131],",",["T_WHITESPACE"," ",1131],["T_VARIABLE","$alreadyExclTax",1131],["T_WHITESPACE"," ",1131],"=",["T_WHITESPACE"," ",1131],["T_STRING","false",1131],")",["T_WHITESPACE","\n    ",1131],"{",["T_WHITESPACE","\n        ",1132],["T_RETURN","return",1133],["T_WHITESPACE"," ",1133],["T_VARIABLE","$this",1133],["T_OBJECT_OPERATOR","->",1133],["T_STRING","setData",1133],"(",["T_CONSTANT_ENCAPSED_STRING","'base_shipping_amount'",1133],",",["T_WHITESPACE"," ",1133],["T_VARIABLE","$value",1133],")",";",["T_WHITESPACE","\n    ",1133],"}",["T_WHITESPACE","\n\n    ",1134],["T_DOC_COMMENT","\/**\n     * Set total amount value\n     *\n     * @param   string $code\n     * @param   float $amount\n     * @return  Mage_Sales_Model_Quote_Address\n     *\/",1136],["T_WHITESPACE","\n    ",1142],["T_PUBLIC","public",1143],["T_WHITESPACE"," ",1143],["T_FUNCTION","function",1143],["T_WHITESPACE"," ",1143],["T_STRING","setTotalAmount",1143],"(",["T_VARIABLE","$code",1143],",",["T_WHITESPACE"," ",1143],["T_VARIABLE","$amount",1143],")",["T_WHITESPACE","\n    ",1143],"{",["T_WHITESPACE","\n        ",1144],["T_VARIABLE","$this",1145],["T_OBJECT_OPERATOR","->",1145],["T_STRING","_totalAmounts",1145],"[",["T_VARIABLE","$code",1145],"]",["T_WHITESPACE"," ",1145],"=",["T_WHITESPACE"," ",1145],["T_VARIABLE","$amount",1145],";",["T_WHITESPACE","\n        ",1145],["T_IF","if",1146],["T_WHITESPACE"," ",1146],"(",["T_VARIABLE","$code",1146],["T_WHITESPACE"," ",1146],["T_IS_NOT_EQUAL","!=",1146],["T_WHITESPACE"," ",1146],["T_CONSTANT_ENCAPSED_STRING","'subtotal'",1146],")",["T_WHITESPACE"," ",1146],"{",["T_WHITESPACE","\n            ",1146],["T_VARIABLE","$code",1147],["T_WHITESPACE"," ",1147],"=",["T_WHITESPACE"," ",1147],["T_VARIABLE","$code",1147],".",["T_CONSTANT_ENCAPSED_STRING","'_amount'",1147],";",["T_WHITESPACE","\n        ",1147],"}",["T_WHITESPACE","\n        ",1148],["T_VARIABLE","$this",1149],["T_OBJECT_OPERATOR","->",1149],["T_STRING","setData",1149],"(",["T_VARIABLE","$code",1149],",",["T_WHITESPACE"," ",1149],["T_VARIABLE","$amount",1149],")",";",["T_WHITESPACE","\n        ",1149],["T_RETURN","return",1150],["T_WHITESPACE"," ",1150],["T_VARIABLE","$this",1150],";",["T_WHITESPACE","\n    ",1150],"}",["T_WHITESPACE","\n\n    ",1151],["T_DOC_COMMENT","\/**\n     * Set total amount value in base store currency\n     *\n     * @param   string $code\n     * @param   float $amount\n     * @return  Mage_Sales_Model_Quote_Address\n     *\/",1153],["T_WHITESPACE","\n    ",1159],["T_PUBLIC","public",1160],["T_WHITESPACE"," ",1160],["T_FUNCTION","function",1160],["T_WHITESPACE"," ",1160],["T_STRING","setBaseTotalAmount",1160],"(",["T_VARIABLE","$code",1160],",",["T_WHITESPACE"," ",1160],["T_VARIABLE","$amount",1160],")",["T_WHITESPACE","\n    ",1160],"{",["T_WHITESPACE","\n        ",1161],["T_VARIABLE","$this",1162],["T_OBJECT_OPERATOR","->",1162],["T_STRING","_baseTotalAmounts",1162],"[",["T_VARIABLE","$code",1162],"]",["T_WHITESPACE"," ",1162],"=",["T_WHITESPACE"," ",1162],["T_VARIABLE","$amount",1162],";",["T_WHITESPACE","\n        ",1162],["T_IF","if",1163],["T_WHITESPACE"," ",1163],"(",["T_VARIABLE","$code",1163],["T_WHITESPACE"," ",1163],["T_IS_NOT_EQUAL","!=",1163],["T_WHITESPACE"," ",1163],["T_CONSTANT_ENCAPSED_STRING","'subtotal'",1163],")",["T_WHITESPACE"," ",1163],"{",["T_WHITESPACE","\n            ",1163],["T_VARIABLE","$code",1164],["T_WHITESPACE"," ",1164],"=",["T_WHITESPACE"," ",1164],["T_VARIABLE","$code",1164],".",["T_CONSTANT_ENCAPSED_STRING","'_amount'",1164],";",["T_WHITESPACE","\n        ",1164],"}",["T_WHITESPACE","\n        ",1165],["T_VARIABLE","$this",1166],["T_OBJECT_OPERATOR","->",1166],["T_STRING","setData",1166],"(",["T_CONSTANT_ENCAPSED_STRING","'base_'",1166],".",["T_VARIABLE","$code",1166],",",["T_WHITESPACE"," ",1166],["T_VARIABLE","$amount",1166],")",";",["T_WHITESPACE","\n        ",1166],["T_RETURN","return",1167],["T_WHITESPACE"," ",1167],["T_VARIABLE","$this",1167],";",["T_WHITESPACE","\n    ",1167],"}",["T_WHITESPACE","\n\n    ",1168],["T_DOC_COMMENT","\/**\n     * Add amount total amount value\n     *\n     * @param   string $code\n     * @param   float $amount\n     * @return  Mage_Sales_Model_Quote_Address\n     *\/",1170],["T_WHITESPACE","\n    ",1176],["T_PUBLIC","public",1177],["T_WHITESPACE"," ",1177],["T_FUNCTION","function",1177],["T_WHITESPACE"," ",1177],["T_STRING","addTotalAmount",1177],"(",["T_VARIABLE","$code",1177],",",["T_WHITESPACE"," ",1177],["T_VARIABLE","$amount",1177],")",["T_WHITESPACE","\n    ",1177],"{",["T_WHITESPACE","\n        ",1178],["T_VARIABLE","$amount",1179],["T_WHITESPACE"," ",1179],"=",["T_WHITESPACE"," ",1179],["T_VARIABLE","$this",1179],["T_OBJECT_OPERATOR","->",1179],["T_STRING","getTotalAmount",1179],"(",["T_VARIABLE","$code",1179],")","+",["T_VARIABLE","$amount",1179],";",["T_WHITESPACE","\n        ",1179],["T_VARIABLE","$this",1180],["T_OBJECT_OPERATOR","->",1180],["T_STRING","setTotalAmount",1180],"(",["T_VARIABLE","$code",1180],",",["T_WHITESPACE"," ",1180],["T_VARIABLE","$amount",1180],")",";",["T_WHITESPACE","\n        ",1180],["T_RETURN","return",1181],["T_WHITESPACE"," ",1181],["T_VARIABLE","$this",1181],";",["T_WHITESPACE","\n    ",1181],"}",["T_WHITESPACE","\n\n    ",1182],["T_DOC_COMMENT","\/**\n     * Add amount total amount value in base store currency\n     *\n     * @param   string $code\n     * @param   float $amount\n     * @return  Mage_Sales_Model_Quote_Address\n     *\/",1184],["T_WHITESPACE","\n    ",1190],["T_PUBLIC","public",1191],["T_WHITESPACE"," ",1191],["T_FUNCTION","function",1191],["T_WHITESPACE"," ",1191],["T_STRING","addBaseTotalAmount",1191],"(",["T_VARIABLE","$code",1191],",",["T_WHITESPACE"," ",1191],["T_VARIABLE","$amount",1191],")",["T_WHITESPACE","\n    ",1191],"{",["T_WHITESPACE","\n        ",1192],["T_VARIABLE","$amount",1193],["T_WHITESPACE"," ",1193],"=",["T_WHITESPACE"," ",1193],["T_VARIABLE","$this",1193],["T_OBJECT_OPERATOR","->",1193],["T_STRING","getBaseTotalAmount",1193],"(",["T_VARIABLE","$code",1193],")","+",["T_VARIABLE","$amount",1193],";",["T_WHITESPACE","\n        ",1193],["T_VARIABLE","$this",1194],["T_OBJECT_OPERATOR","->",1194],["T_STRING","setBaseTotalAmount",1194],"(",["T_VARIABLE","$code",1194],",",["T_WHITESPACE"," ",1194],["T_VARIABLE","$amount",1194],")",";",["T_WHITESPACE","\n        ",1194],["T_RETURN","return",1195],["T_WHITESPACE"," ",1195],["T_VARIABLE","$this",1195],";",["T_WHITESPACE","\n    ",1195],"}",["T_WHITESPACE","\n\n    ",1196],["T_DOC_COMMENT","\/**\n     * Get total amount value by code\n     *\n     * @param   string $code\n     * @return  float\n     *\/",1198],["T_WHITESPACE","\n    ",1203],["T_PUBLIC","public",1204],["T_WHITESPACE"," ",1204],["T_FUNCTION","function",1204],["T_WHITESPACE"," ",1204],["T_STRING","getTotalAmount",1204],"(",["T_VARIABLE","$code",1204],")",["T_WHITESPACE","\n    ",1204],"{",["T_WHITESPACE","\n        ",1205],["T_IF","if",1206],["T_WHITESPACE"," ",1206],"(",["T_ISSET","isset",1206],"(",["T_VARIABLE","$this",1206],["T_OBJECT_OPERATOR","->",1206],["T_STRING","_totalAmounts",1206],"[",["T_VARIABLE","$code",1206],"]",")",")",["T_WHITESPACE"," ",1206],"{",["T_WHITESPACE","\n            ",1206],["T_RETURN","return",1207],["T_WHITESPACE","  ",1207],["T_VARIABLE","$this",1207],["T_OBJECT_OPERATOR","->",1207],["T_STRING","_totalAmounts",1207],"[",["T_VARIABLE","$code",1207],"]",";",["T_WHITESPACE","\n        ",1207],"}",["T_WHITESPACE","\n        ",1208],["T_RETURN","return",1209],["T_WHITESPACE"," ",1209],["T_LNUMBER","0",1209],";",["T_WHITESPACE","\n    ",1209],"}",["T_WHITESPACE","\n\n    ",1210],["T_DOC_COMMENT","\/**\n     * Get total amount value by code in base store curncy\n     *\n     * @param   string $code\n     * @return  float\n     *\/",1212],["T_WHITESPACE","\n    ",1217],["T_PUBLIC","public",1218],["T_WHITESPACE"," ",1218],["T_FUNCTION","function",1218],["T_WHITESPACE"," ",1218],["T_STRING","getBaseTotalAmount",1218],"(",["T_VARIABLE","$code",1218],")",["T_WHITESPACE","\n    ",1218],"{",["T_WHITESPACE","\n        ",1219],["T_IF","if",1220],["T_WHITESPACE"," ",1220],"(",["T_ISSET","isset",1220],"(",["T_VARIABLE","$this",1220],["T_OBJECT_OPERATOR","->",1220],["T_STRING","_baseTotalAmounts",1220],"[",["T_VARIABLE","$code",1220],"]",")",")",["T_WHITESPACE"," ",1220],"{",["T_WHITESPACE","\n            ",1220],["T_RETURN","return",1221],["T_WHITESPACE","  ",1221],["T_VARIABLE","$this",1221],["T_OBJECT_OPERATOR","->",1221],["T_STRING","_baseTotalAmounts",1221],"[",["T_VARIABLE","$code",1221],"]",";",["T_WHITESPACE","\n        ",1221],"}",["T_WHITESPACE","\n        ",1222],["T_RETURN","return",1223],["T_WHITESPACE"," ",1223],["T_LNUMBER","0",1223],";",["T_WHITESPACE","\n    ",1223],"}",["T_WHITESPACE","\n\n    ",1224],["T_DOC_COMMENT","\/**\n     * Get all total amount values\n     *\n     * @return array\n     *\/",1226],["T_WHITESPACE","\n    ",1230],["T_PUBLIC","public",1231],["T_WHITESPACE"," ",1231],["T_FUNCTION","function",1231],["T_WHITESPACE"," ",1231],["T_STRING","getAllTotalAmounts",1231],"(",")",["T_WHITESPACE","\n    ",1231],"{",["T_WHITESPACE","\n        ",1232],["T_RETURN","return",1233],["T_WHITESPACE"," ",1233],["T_VARIABLE","$this",1233],["T_OBJECT_OPERATOR","->",1233],["T_STRING","_totalAmounts",1233],";",["T_WHITESPACE","\n    ",1233],"}",["T_WHITESPACE","\n\n    ",1234],["T_DOC_COMMENT","\/**\n     * Get all total amount values in base currency\n     *\n     * @return array\n     *\/",1236],["T_WHITESPACE","\n    ",1240],["T_PUBLIC","public",1241],["T_WHITESPACE"," ",1241],["T_FUNCTION","function",1241],["T_WHITESPACE"," ",1241],["T_STRING","getAllBaseTotalAmounts",1241],"(",")",["T_WHITESPACE","\n    ",1241],"{",["T_WHITESPACE","\n        ",1242],["T_RETURN","return",1243],["T_WHITESPACE"," ",1243],["T_VARIABLE","$this",1243],["T_OBJECT_OPERATOR","->",1243],["T_STRING","_baseTotalAmounts",1243],";",["T_WHITESPACE","\n    ",1243],"}",["T_WHITESPACE","\n\n    ",1244],["T_DOC_COMMENT","\/**\n     * Get subtotal amount with applied discount in base currency\n     *\n     * @return float\n     *\/",1246],["T_WHITESPACE","\n    ",1250],["T_PUBLIC","public",1251],["T_WHITESPACE"," ",1251],["T_FUNCTION","function",1251],["T_WHITESPACE"," ",1251],["T_STRING","getBaseSubtotalWithDiscount",1251],"(",")",["T_WHITESPACE","\n    ",1251],"{",["T_WHITESPACE","\n        ",1252],["T_RETURN","return",1253],["T_WHITESPACE"," ",1253],["T_VARIABLE","$this",1253],["T_OBJECT_OPERATOR","->",1253],["T_STRING","getBaseSubtotal",1253],"(",")","+",["T_VARIABLE","$this",1253],["T_OBJECT_OPERATOR","->",1253],["T_STRING","getBaseDiscountAmount",1253],"(",")",";",["T_WHITESPACE","\n    ",1253],"}",["T_WHITESPACE","\n\n    ",1254],["T_DOC_COMMENT","\/**\n     * Get subtotal amount with applied discount\n     *\n     * @return float\n     *\/",1256],["T_WHITESPACE","\n    ",1260],["T_PUBLIC","public",1261],["T_WHITESPACE"," ",1261],["T_FUNCTION","function",1261],["T_WHITESPACE"," ",1261],["T_STRING","getSubtotalWithDiscount",1261],"(",")",["T_WHITESPACE","\n    ",1261],"{",["T_WHITESPACE","\n        ",1262],["T_RETURN","return",1263],["T_WHITESPACE"," ",1263],["T_VARIABLE","$this",1263],["T_OBJECT_OPERATOR","->",1263],["T_STRING","getSubtotal",1263],"(",")","+",["T_VARIABLE","$this",1263],["T_OBJECT_OPERATOR","->",1263],["T_STRING","getDiscountAmount",1263],"(",")",";",["T_WHITESPACE","\n    ",1263],"}",["T_WHITESPACE","\n",1264],"}",["T_WHITESPACE","\n",1265]]