[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Sales\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Quote item resource collection\n *\n * @category    Mage\n * @package     Mage_Sales\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Sales_Model_Resource_Quote_Item_Collection",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Model_Resource_Db_Collection_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Collection quote instance\n     *\n     * @var Mage_Sales_Model_Quote\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_quote",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Product Ids array\n     *\n     * @var array\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_productIds",49],["T_WHITESPACE","   ",49],"=",["T_WHITESPACE"," ",49],["T_ARRAY","array",49],"(",")",";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Initialize resource model\n     *\n     *\/",51],["T_WHITESPACE","\n    ",54],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_FUNCTION","function",55],["T_WHITESPACE"," ",55],["T_STRING","_construct",55],"(",")",["T_WHITESPACE","\n    ",55],"{",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","_init",57],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/quote_item'",57],")",";",["T_WHITESPACE","\n    ",57],"}",["T_WHITESPACE","\n\n    ",58],["T_DOC_COMMENT","\/**\n     * Retrieve store Id (From Quote)\n     *\n     * @return int\n     *\/",60],["T_WHITESPACE","\n    ",64],["T_PUBLIC","public",65],["T_WHITESPACE"," ",65],["T_FUNCTION","function",65],["T_WHITESPACE"," ",65],["T_STRING","getStoreId",65],"(",")",["T_WHITESPACE","\n    ",65],"{",["T_WHITESPACE","\n        ",66],["T_RETURN","return",67],["T_WHITESPACE"," ",67],["T_INT_CAST","(int)",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","_quote",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getStoreId",67],"(",")",";",["T_WHITESPACE","\n    ",67],"}",["T_WHITESPACE","\n\n    ",68],["T_DOC_COMMENT","\/**\n     * Set Quote object to Collection\n     *\n     * @param Mage_Sales_Model_Quote $quote\n     * @return Mage_Sales_Model_Resource_Quote_Item_Collection\n     *\/",70],["T_WHITESPACE","\n    ",75],["T_PUBLIC","public",76],["T_WHITESPACE"," ",76],["T_FUNCTION","function",76],["T_WHITESPACE"," ",76],["T_STRING","setQuote",76],"(",["T_VARIABLE","$quote",76],")",["T_WHITESPACE","\n    ",76],"{",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","_quote",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$quote",78],";",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$quoteId",79],["T_WHITESPACE","      ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$quote",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","getId",79],"(",")",";",["T_WHITESPACE","\n        ",79],["T_IF","if",80],["T_WHITESPACE"," ",80],"(",["T_VARIABLE","$quoteId",80],")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n            ",80],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","addFieldToFilter",81],"(",["T_CONSTANT_ENCAPSED_STRING","'quote_id'",81],",",["T_WHITESPACE"," ",81],["T_VARIABLE","$quote",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getId",81],"(",")",")",";",["T_WHITESPACE","\n        ",81],"}",["T_WHITESPACE"," ",82],["T_ELSE","else",82],["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n            ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","_totalRecords",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_LNUMBER","0",83],";",["T_WHITESPACE","\n            ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","_setIsLoaded",84],"(",["T_STRING","true",84],")",";",["T_WHITESPACE","\n        ",84],"}",["T_WHITESPACE","\n        ",85],["T_RETURN","return",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],";",["T_WHITESPACE","\n    ",86],"}",["T_WHITESPACE","\n\n    ",87],["T_DOC_COMMENT","\/**\n     * Reset the collection and inner join it to quotes table\n     * Optionally can select items with specified product id only\n     *\n     * @param string $quotesTableName\n     * @param int $productId\n     * @return Mage_Sales_Model_Resource_Quote_Item_Collection\n     *\/",89],["T_WHITESPACE","\n    ",96],["T_PUBLIC","public",97],["T_WHITESPACE"," ",97],["T_FUNCTION","function",97],["T_WHITESPACE"," ",97],["T_STRING","resetJoinQuotes",97],"(",["T_VARIABLE","$quotesTableName",97],",",["T_WHITESPACE"," ",97],["T_VARIABLE","$productId",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_STRING","null",97],")",["T_WHITESPACE","\n    ",97],"{",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","getSelect",99],"(",")",["T_OBJECT_OPERATOR","->",99],["T_STRING","reset",99],"(",")",["T_WHITESPACE","\n            ",99],["T_OBJECT_OPERATOR","->",100],["T_STRING","from",100],"(",["T_WHITESPACE","\n                ",100],["T_ARRAY","array",101],"(",["T_CONSTANT_ENCAPSED_STRING","'qi'",101],["T_WHITESPACE"," ",101],["T_DOUBLE_ARROW","=>",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getResource",101],"(",")",["T_OBJECT_OPERATOR","->",101],["T_STRING","getMainTable",101],"(",")",")",",",["T_WHITESPACE","\n                ",101],["T_ARRAY","array",102],"(",["T_CONSTANT_ENCAPSED_STRING","'item_id'",102],",",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'qty'",102],",",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'quote_id'",102],")",")",["T_WHITESPACE","\n            ",102],["T_OBJECT_OPERATOR","->",103],["T_STRING","joinInner",103],"(",["T_WHITESPACE","\n                ",103],["T_ARRAY","array",104],"(",["T_CONSTANT_ENCAPSED_STRING","'q'",104],["T_WHITESPACE"," ",104],["T_DOUBLE_ARROW","=>",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$quotesTableName",104],")",",",["T_WHITESPACE","\n               ",104],["T_CONSTANT_ENCAPSED_STRING","'qi.quote_id = q.entity_id'",105],",",["T_WHITESPACE","\n                ",105],["T_ARRAY","array",106],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id'",106],",",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'items_qty'",106],",",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'items_count'",106],")",["T_WHITESPACE","\n            ",106],")",";",["T_WHITESPACE","\n        ",107],["T_IF","if",108],["T_WHITESPACE"," ",108],"(",["T_VARIABLE","$productId",108],")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n            ",108],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getSelect",109],"(",")",["T_OBJECT_OPERATOR","->",109],["T_STRING","where",109],"(",["T_CONSTANT_ENCAPSED_STRING","'qi.product_id = ?'",109],",",["T_WHITESPACE"," ",109],["T_INT_CAST","(int)",109],["T_VARIABLE","$productId",109],")",";",["T_WHITESPACE","\n        ",109],"}",["T_WHITESPACE","\n        ",110],["T_RETURN","return",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],";",["T_WHITESPACE","\n    ",111],"}",["T_WHITESPACE","\n\n    ",112],["T_DOC_COMMENT","\/**\n     * After load processing\n     *\n     * @return Mage_Sales_Model_Resource_Quote_Item_Collection\n     *\/",114],["T_WHITESPACE","\n    ",118],["T_PROTECTED","protected",119],["T_WHITESPACE"," ",119],["T_FUNCTION","function",119],["T_WHITESPACE"," ",119],["T_STRING","_afterLoad",119],"(",")",["T_WHITESPACE","\n    ",119],"{",["T_WHITESPACE","\n        ",120],["T_STRING","parent",121],["T_DOUBLE_COLON","::",121],["T_STRING","_afterLoad",121],"(",")",";",["T_WHITESPACE","\n\n        ",121],["T_DOC_COMMENT","\/**\n         * Assign parent items\n         *\/",123],["T_WHITESPACE","\n        ",125],["T_FOREACH","foreach",126],["T_WHITESPACE"," ",126],"(",["T_VARIABLE","$this",126],["T_WHITESPACE"," ",126],["T_AS","as",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$item",126],")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n            ",126],["T_IF","if",127],["T_WHITESPACE"," ",127],"(",["T_VARIABLE","$item",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","getParentItemId",127],"(",")",")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n                ",127],["T_VARIABLE","$item",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","setParentItem",128],"(",["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","getItemById",128],"(",["T_VARIABLE","$item",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","getParentItemId",128],"(",")",")",")",";",["T_WHITESPACE","\n            ",128],"}",["T_WHITESPACE","\n            ",129],["T_IF","if",130],["T_WHITESPACE"," ",130],"(",["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","_quote",130],")",["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n                ",130],["T_VARIABLE","$item",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","setQuote",131],"(",["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","_quote",131],")",";",["T_WHITESPACE","\n            ",131],"}",["T_WHITESPACE","\n        ",132],"}",["T_WHITESPACE","\n\n        ",133],["T_DOC_COMMENT","\/**\n         * Assign options and products\n         *\/",135],["T_WHITESPACE","\n        ",137],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","_assignOptions",138],"(",")",";",["T_WHITESPACE","\n        ",138],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","_assignProducts",139],"(",")",";",["T_WHITESPACE","\n        ",139],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","resetItemsDataChanged",140],"(",")",";",["T_WHITESPACE","\n\n        ",140],["T_RETURN","return",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],";",["T_WHITESPACE","\n    ",142],"}",["T_WHITESPACE","\n\n    ",143],["T_DOC_COMMENT","\/**\n     * Add options to items\n     *\n     * @return Mage_Sales_Model_Resource_Quote_Item_Collection\n     *\/",145],["T_WHITESPACE","\n    ",149],["T_PROTECTED","protected",150],["T_WHITESPACE"," ",150],["T_FUNCTION","function",150],["T_WHITESPACE"," ",150],["T_STRING","_assignOptions",150],"(",")",["T_WHITESPACE","\n    ",150],"{",["T_WHITESPACE","\n        ",151],["T_VARIABLE","$itemIds",152],["T_WHITESPACE","          ",152],"=",["T_WHITESPACE"," ",152],["T_STRING","array_keys",152],"(",["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","_items",152],")",";",["T_WHITESPACE","\n        ",152],["T_VARIABLE","$optionCollection",153],["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_STRING","Mage",153],["T_DOUBLE_COLON","::",153],["T_STRING","getModel",153],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/quote_item_option'",153],")",["T_OBJECT_OPERATOR","->",153],["T_STRING","getCollection",153],"(",")",["T_WHITESPACE","\n            ",153],["T_OBJECT_OPERATOR","->",154],["T_STRING","addItemFilter",154],"(",["T_VARIABLE","$itemIds",154],")",";",["T_WHITESPACE","\n        ",154],["T_FOREACH","foreach",155],["T_WHITESPACE"," ",155],"(",["T_VARIABLE","$this",155],["T_WHITESPACE"," ",155],["T_AS","as",155],["T_WHITESPACE"," ",155],["T_VARIABLE","$item",155],")",["T_WHITESPACE"," ",155],"{",["T_WHITESPACE","\n            ",155],["T_VARIABLE","$item",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","setOptions",156],"(",["T_VARIABLE","$optionCollection",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","getOptionsByItem",156],"(",["T_VARIABLE","$item",156],")",")",";",["T_WHITESPACE","\n        ",156],"}",["T_WHITESPACE","\n        ",157],["T_VARIABLE","$productIds",158],["T_WHITESPACE","        ",158],"=",["T_WHITESPACE"," ",158],["T_VARIABLE","$optionCollection",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","getProductIds",158],"(",")",";",["T_WHITESPACE","\n        ",158],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","_productIds",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_STRING","array_merge",159],"(",["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","_productIds",159],",",["T_WHITESPACE"," ",159],["T_VARIABLE","$productIds",159],")",";",["T_WHITESPACE","\n\n        ",159],["T_RETURN","return",161],["T_WHITESPACE"," ",161],["T_VARIABLE","$this",161],";",["T_WHITESPACE","\n    ",161],"}",["T_WHITESPACE","\n\n    ",162],["T_DOC_COMMENT","\/**\n     * Add products to items and item options\n     *\n     * @return Mage_Sales_Model_Resource_Quote_Item_Collection\n     *\/",164],["T_WHITESPACE","\n    ",168],["T_PROTECTED","protected",169],["T_WHITESPACE"," ",169],["T_FUNCTION","function",169],["T_WHITESPACE"," ",169],["T_STRING","_assignProducts",169],"(",")",["T_WHITESPACE","\n    ",169],"{",["T_WHITESPACE","\n        ",170],["T_STRING","Varien_Profiler",171],["T_DOUBLE_COLON","::",171],["T_STRING","start",171],"(",["T_CONSTANT_ENCAPSED_STRING","'QUOTE:'",171],".",["T_METHOD_C","__METHOD__",171],")",";",["T_WHITESPACE","\n        ",171],["T_VARIABLE","$productIds",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_ARRAY","array",172],"(",")",";",["T_WHITESPACE","\n        ",172],["T_FOREACH","foreach",173],["T_WHITESPACE"," ",173],"(",["T_VARIABLE","$this",173],["T_WHITESPACE"," ",173],["T_AS","as",173],["T_WHITESPACE"," ",173],["T_VARIABLE","$item",173],")",["T_WHITESPACE"," ",173],"{",["T_WHITESPACE","\n            ",173],["T_VARIABLE","$productIds",174],"[","]",["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_INT_CAST","(int)",174],["T_VARIABLE","$item",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","getProductId",174],"(",")",";",["T_WHITESPACE","\n        ",174],"}",["T_WHITESPACE","\n        ",175],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","_productIds",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_STRING","array_merge",176],"(",["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","_productIds",176],",",["T_WHITESPACE"," ",176],["T_VARIABLE","$productIds",176],")",";",["T_WHITESPACE","\n\n        ",176],["T_VARIABLE","$productCollection",178],["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_STRING","Mage",178],["T_DOUBLE_COLON","::",178],["T_STRING","getModel",178],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",178],")",["T_OBJECT_OPERATOR","->",178],["T_STRING","getCollection",178],"(",")",["T_WHITESPACE","\n            ",178],["T_OBJECT_OPERATOR","->",179],["T_STRING","setStoreId",179],"(",["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","getStoreId",179],"(",")",")",["T_WHITESPACE","\n            ",179],["T_OBJECT_OPERATOR","->",180],["T_STRING","addIdFilter",180],"(",["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","_productIds",180],")",["T_WHITESPACE","\n            ",180],["T_OBJECT_OPERATOR","->",181],["T_STRING","addAttributeToSelect",181],"(",["T_STRING","Mage",181],["T_DOUBLE_COLON","::",181],["T_STRING","getSingleton",181],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/quote_config'",181],")",["T_OBJECT_OPERATOR","->",181],["T_STRING","getProductAttributes",181],"(",")",")",["T_WHITESPACE","\n            ",181],["T_OBJECT_OPERATOR","->",182],["T_STRING","addOptionsToResult",182],"(",")",["T_WHITESPACE","\n            ",182],["T_OBJECT_OPERATOR","->",183],["T_STRING","addStoreFilter",183],"(",")",["T_WHITESPACE","\n            ",183],["T_OBJECT_OPERATOR","->",184],["T_STRING","addUrlRewrite",184],"(",")",["T_WHITESPACE","\n            ",184],["T_OBJECT_OPERATOR","->",185],["T_STRING","addTierPriceData",185],"(",")",";",["T_WHITESPACE","\n\n        ",185],["T_STRING","Mage",187],["T_DOUBLE_COLON","::",187],["T_STRING","dispatchEvent",187],"(",["T_CONSTANT_ENCAPSED_STRING","'prepare_catalog_product_collection_prices'",187],",",["T_WHITESPACE"," ",187],["T_ARRAY","array",187],"(",["T_WHITESPACE","\n            ",187],["T_CONSTANT_ENCAPSED_STRING","'collection'",188],["T_WHITESPACE","            ",188],["T_DOUBLE_ARROW","=>",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$productCollection",188],",",["T_WHITESPACE","\n            ",188],["T_CONSTANT_ENCAPSED_STRING","'store_id'",189],["T_WHITESPACE","              ",189],["T_DOUBLE_ARROW","=>",189],["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getStoreId",189],"(",")",",",["T_WHITESPACE","\n        ",189],")",")",";",["T_WHITESPACE","\n        ",190],["T_STRING","Mage",191],["T_DOUBLE_COLON","::",191],["T_STRING","dispatchEvent",191],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_quote_item_collection_products_after_load'",191],",",["T_WHITESPACE"," ",191],["T_ARRAY","array",191],"(",["T_WHITESPACE","\n            ",191],["T_CONSTANT_ENCAPSED_STRING","'product_collection'",192],["T_WHITESPACE","    ",192],["T_DOUBLE_ARROW","=>",192],["T_WHITESPACE"," ",192],["T_VARIABLE","$productCollection",192],["T_WHITESPACE","\n        ",192],")",")",";",["T_WHITESPACE","\n\n        ",193],["T_VARIABLE","$recollectQuote",195],["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_STRING","false",195],";",["T_WHITESPACE","\n        ",195],["T_FOREACH","foreach",196],["T_WHITESPACE"," ",196],"(",["T_VARIABLE","$this",196],["T_WHITESPACE"," ",196],["T_AS","as",196],["T_WHITESPACE"," ",196],["T_VARIABLE","$item",196],")",["T_WHITESPACE"," ",196],"{",["T_WHITESPACE","\n            ",196],["T_VARIABLE","$product",197],["T_WHITESPACE"," ",197],"=",["T_WHITESPACE"," ",197],["T_VARIABLE","$productCollection",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","getItemById",197],"(",["T_VARIABLE","$item",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","getProductId",197],"(",")",")",";",["T_WHITESPACE","\n            ",197],["T_IF","if",198],["T_WHITESPACE"," ",198],"(",["T_VARIABLE","$product",198],")",["T_WHITESPACE"," ",198],"{",["T_WHITESPACE","\n                ",198],["T_VARIABLE","$product",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","setCustomOptions",199],"(",["T_ARRAY","array",199],"(",")",")",";",["T_WHITESPACE","\n                ",199],["T_VARIABLE","$qtyOptions",200],["T_WHITESPACE","         ",200],"=",["T_WHITESPACE"," ",200],["T_ARRAY","array",200],"(",")",";",["T_WHITESPACE","\n                ",200],["T_VARIABLE","$optionProductIds",201],["T_WHITESPACE","   ",201],"=",["T_WHITESPACE"," ",201],["T_ARRAY","array",201],"(",")",";",["T_WHITESPACE","\n                ",201],["T_FOREACH","foreach",202],["T_WHITESPACE"," ",202],"(",["T_VARIABLE","$item",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","getOptions",202],"(",")",["T_WHITESPACE"," ",202],["T_AS","as",202],["T_WHITESPACE"," ",202],["T_VARIABLE","$option",202],")",["T_WHITESPACE"," ",202],"{",["T_WHITESPACE","\n                    ",202],["T_DOC_COMMENT","\/**\n                     * Call type-specific logic for product associated with quote item\n                     *\/",203],["T_WHITESPACE","\n                    ",205],["T_VARIABLE","$product",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","getTypeInstance",206],"(",["T_STRING","true",206],")",["T_OBJECT_OPERATOR","->",206],["T_STRING","assignProductToOption",206],"(",["T_WHITESPACE","\n                        ",206],["T_VARIABLE","$productCollection",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","getItemById",207],"(",["T_VARIABLE","$option",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","getProductId",207],"(",")",")",",",["T_WHITESPACE","\n                        ",207],["T_VARIABLE","$option",208],",",["T_WHITESPACE","\n                        ",208],["T_VARIABLE","$product",209],["T_WHITESPACE","\n                    ",209],")",";",["T_WHITESPACE","\n\n                    ",210],["T_IF","if",212],["T_WHITESPACE"," ",212],"(",["T_STRING","is_object",212],"(",["T_VARIABLE","$option",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","getProduct",212],"(",")",")",["T_WHITESPACE"," ",212],["T_BOOLEAN_AND","&&",212],["T_WHITESPACE"," ",212],["T_VARIABLE","$option",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","getProduct",212],"(",")",["T_OBJECT_OPERATOR","->",212],["T_STRING","getId",212],"(",")",["T_WHITESPACE"," ",212],["T_IS_NOT_EQUAL","!=",212],["T_WHITESPACE"," ",212],["T_VARIABLE","$product",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","getId",212],"(",")",")",["T_WHITESPACE"," ",212],"{",["T_WHITESPACE","\n                        ",212],["T_VARIABLE","$optionProductIds",213],"[",["T_VARIABLE","$option",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","getProduct",213],"(",")",["T_OBJECT_OPERATOR","->",213],["T_STRING","getId",213],"(",")","]",["T_WHITESPACE"," ",213],"=",["T_WHITESPACE"," ",213],["T_VARIABLE","$option",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","getProduct",213],"(",")",["T_OBJECT_OPERATOR","->",213],["T_STRING","getId",213],"(",")",";",["T_WHITESPACE","\n                    ",213],"}",["T_WHITESPACE","\n                ",214],"}",["T_WHITESPACE","\n\n                ",215],["T_IF","if",217],["T_WHITESPACE"," ",217],"(",["T_VARIABLE","$optionProductIds",217],")",["T_WHITESPACE"," ",217],"{",["T_WHITESPACE","\n                    ",217],["T_FOREACH","foreach",218],["T_WHITESPACE"," ",218],"(",["T_VARIABLE","$optionProductIds",218],["T_WHITESPACE"," ",218],["T_AS","as",218],["T_WHITESPACE"," ",218],["T_VARIABLE","$optionProductId",218],")",["T_WHITESPACE"," ",218],"{",["T_WHITESPACE","\n                        ",218],["T_VARIABLE","$qtyOption",219],["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],["T_VARIABLE","$item",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","getOptionByCode",219],"(",["T_CONSTANT_ENCAPSED_STRING","'product_qty_'",219],["T_WHITESPACE"," ",219],".",["T_WHITESPACE"," ",219],["T_VARIABLE","$optionProductId",219],")",";",["T_WHITESPACE","\n                        ",219],["T_IF","if",220],["T_WHITESPACE"," ",220],"(",["T_VARIABLE","$qtyOption",220],")",["T_WHITESPACE"," ",220],"{",["T_WHITESPACE","\n                            ",220],["T_VARIABLE","$qtyOptions",221],"[",["T_VARIABLE","$optionProductId",221],"]",["T_WHITESPACE"," ",221],"=",["T_WHITESPACE"," ",221],["T_VARIABLE","$qtyOption",221],";",["T_WHITESPACE","\n                        ",221],"}",["T_WHITESPACE","\n                    ",222],"}",["T_WHITESPACE","\n                ",223],"}",["T_WHITESPACE","\n\n                ",224],["T_VARIABLE","$item",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","setQtyOptions",226],"(",["T_VARIABLE","$qtyOptions",226],")",["T_OBJECT_OPERATOR","->",226],["T_STRING","setProduct",226],"(",["T_VARIABLE","$product",226],")",";",["T_WHITESPACE","\n            ",226],"}",["T_WHITESPACE"," ",227],["T_ELSE","else",227],["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n                ",227],["T_VARIABLE","$item",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","isDeleted",228],"(",["T_STRING","true",228],")",";",["T_WHITESPACE","\n                ",228],["T_VARIABLE","$recollectQuote",229],["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],["T_STRING","true",229],";",["T_WHITESPACE","\n            ",229],"}",["T_WHITESPACE","\n            ",230],["T_VARIABLE","$item",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","checkData",231],"(",")",";",["T_WHITESPACE","\n        ",231],"}",["T_WHITESPACE","\n\n        ",232],["T_IF","if",234],["T_WHITESPACE"," ",234],"(",["T_VARIABLE","$recollectQuote",234],["T_WHITESPACE"," ",234],["T_BOOLEAN_AND","&&",234],["T_WHITESPACE"," ",234],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","_quote",234],")",["T_WHITESPACE"," ",234],"{",["T_WHITESPACE","\n            ",234],["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","_quote",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","collectTotals",235],"(",")",";",["T_WHITESPACE","\n        ",235],"}",["T_WHITESPACE","\n        ",236],["T_STRING","Varien_Profiler",237],["T_DOUBLE_COLON","::",237],["T_STRING","stop",237],"(",["T_CONSTANT_ENCAPSED_STRING","'QUOTE:'",237],".",["T_METHOD_C","__METHOD__",237],")",";",["T_WHITESPACE","\n\n        ",237],["T_RETURN","return",239],["T_WHITESPACE"," ",239],["T_VARIABLE","$this",239],";",["T_WHITESPACE","\n    ",239],"}",["T_WHITESPACE","\n",240],"}",["T_WHITESPACE","\n\n",241]]