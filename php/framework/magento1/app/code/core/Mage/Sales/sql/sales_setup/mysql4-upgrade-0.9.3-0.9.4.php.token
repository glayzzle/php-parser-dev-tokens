[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Sales\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_VARIABLE","$installer",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],["T_VARIABLE","$this",27],";",["T_WHITESPACE","\n",27],["T_COMMENT","\/* @var $installer Mage_Sales_Model_Mysql4_Setup *\/",28],["T_WHITESPACE","\n\n",28],["T_VARIABLE","$installer",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","run",30],"(","\"",["T_ENCAPSED_AND_WHITESPACE","\nCREATE TABLE `",30],["T_CURLY_OPEN","{",31],["T_VARIABLE","$installer",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","getTable",31],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_flat_order_item'",31],")","}",["T_ENCAPSED_AND_WHITESPACE","` (\n    `item_id` int(10) unsigned NOT NULL auto_increment,\n    `order_id` int(10) unsigned NOT NULL default '0',\n    `parent_item_id` int(10) unsigned default NULL,\n    `quote_item_id` int(10) unsigned default NULL,\n    `created_at` datetime NOT NULL default '0000-00-00 00:00:00',\n    `updated_at` datetime NOT NULL default '0000-00-00 00:00:00',\n\n    `product_id` int(10) unsigned default NULL,\n    `product_type` varchar(255) default NULL,\n    `product_options` text default NULL,\n    `weight` decimal(12,4) default '0.0000',\n    `is_virtual` tinyint(1) unsigned default NULL,\n    `sku` varchar(255) NOT NULL default '',\n    `name` varchar(255) default NULL,\n    `description` text,\n    `applied_rule_ids` text,\n    `additional_data` text,\n\n    `free_shipping` tinyint(1) unsigned NOT NULL default '0',\n    `is_qty_decimal` tinyint(1) unsigned default NULL,\n    `no_discount` tinyint(1) unsigned default '0',\n\n    `qty_backordered` decimal(12,4) default '0.0000',\n    `qty_canceled` decimal(12,4) default '0.0000',\n    `qty_invoiced` decimal(12,4) default '0.0000',\n    `qty_ordered` decimal(12,4) default '0.0000',\n    `qty_refunded` decimal(12,4) default '0.0000',\n    `qty_shipped` decimal(12,4) default '0.0000',\n\n    `cost` decimal(12,4) default '0.0000',\n    `price` decimal(12,4) NOT NULL default '0.0000',\n    `base_price` decimal(12,4) NOT NULL default '0.0000',\n    `original_price` decimal(12,4) default NULL,\n    `base_original_price` decimal(12,4) default NULL,\n\n    `tax_percent` decimal(12,4) default '0.0000',\n    `tax_amount` decimal(12,4) default '0.0000',\n    `base_tax_amount` decimal(12,4) default '0.0000',\n    `tax_invoiced` decimal(12,4) default '0.0000',\n    `base_tax_invoiced` decimal(12,4) default '0.0000',\n\n    `discount_percent` decimal(12,4) default '0.0000',\n    `discount_amount` decimal(12,4) default '0.0000',\n    `base_discount_amount` decimal(12,4) default '0.0000',\n    `discount_invoiced` decimal(12,4) default '0.0000',\n    `base_discount_invoiced` decimal(12,4) default '0.0000',\n\n    `amount_refunded` decimal(12,4) default '0.0000',\n    `base_amount_refunded` decimal(12,4) default '0.0000',\n\n    `row_total` decimal(12,4) NOT NULL default '0.0000',\n    `base_row_total` decimal(12,4) NOT NULL default '0.0000',\n    `row_invoiced` decimal(12,4) NOT NULL default '0.0000',\n    `base_row_invoiced` decimal(12,4) NOT NULL default '0.0000',\n\n    `row_weight` decimal(12,4) default '0.0000',\n\n    `gift_message_id` int(10) default NULL,\n    `gift_message_available` int(10) default NULL,\n\n    PRIMARY KEY  (`item_id`),\n    KEY `IDX_ORDER` (`order_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n",31],"\"",")",";",["T_WHITESPACE","\n\n",95],["T_VARIABLE","$itemFields",97],["T_WHITESPACE","     ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$installer",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","getConnection",97],"(",")",["T_OBJECT_OPERATOR","->",97],["T_STRING","describeTable",97],"(",["T_VARIABLE","$installer",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","getTable",97],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_flat_order_item'",97],")",")",";",["T_WHITESPACE","\n",97],["T_VARIABLE","$itemEntityId",98],["T_WHITESPACE","   ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$installer",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getEntityTypeId",98],"(",["T_CONSTANT_ENCAPSED_STRING","'order_item'",98],")",";",["T_WHITESPACE","\n\n",98],["T_VARIABLE","$itemAttributes",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$installer",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getConnection",100],"(",")",["T_OBJECT_OPERATOR","->",100],["T_STRING","fetchPairs",100],"(","\"",["T_ENCAPSED_AND_WHITESPACE","SELECT attribute_id, attribute_code FROM ",100],["T_CURLY_OPEN","{",100],["T_VARIABLE","$installer",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getTable",100],"(",["T_CONSTANT_ENCAPSED_STRING","'eav_attribute'",100],")","}",["T_ENCAPSED_AND_WHITESPACE"," WHERE entity_type_id=",100],["T_CURLY_OPEN","{",100],["T_VARIABLE","$itemEntityId",100],"}","\"",")",";",["T_WHITESPACE","\n\n",100],["T_VARIABLE","$items",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$installer",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getConnection",102],"(",")",["T_OBJECT_OPERATOR","->",102],["T_STRING","fetchAll",102],"(","\"",["T_ENCAPSED_AND_WHITESPACE","SELECT * FROM ",102],["T_CURLY_OPEN","{",102],["T_VARIABLE","$installer",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getTable",102],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_order_entity'",102],")","}",["T_ENCAPSED_AND_WHITESPACE"," WHERE entity_type_id=",102],["T_CURLY_OPEN","{",102],["T_VARIABLE","$itemEntityId",102],"}","\"",")",";",["T_WHITESPACE","\n\n",102],["T_FOREACH","foreach",104],["T_WHITESPACE"," ",104],"(",["T_VARIABLE","$items",104],["T_WHITESPACE"," ",104],["T_AS","as",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$itemData",104],")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n    ",104],["T_VARIABLE","$itemId",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$itemData",105],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",105],"]",";",["T_WHITESPACE","\n    ",105],["T_VARIABLE","$sql",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],"\"",["T_ENCAPSED_AND_WHITESPACE","\n    SELECT\n        attribute_id, value\n    FROM ",106],["T_CURLY_OPEN","{",109],["T_VARIABLE","$installer",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getTable",109],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_order_entity_decimal'",109],")","}",["T_ENCAPSED_AND_WHITESPACE","\n    WHERE\n        entity_id=",109],["T_CURLY_OPEN","{",111],["T_VARIABLE","$itemId",111],"}",["T_ENCAPSED_AND_WHITESPACE","\n        AND entity_type_id=",111],["T_CURLY_OPEN","{",112],["T_VARIABLE","$itemEntityId",112],"}",["T_ENCAPSED_AND_WHITESPACE","\n\n    UNION\n    SELECT\n        attribute_id, value\n    FROM ",112],["T_CURLY_OPEN","{",117],["T_VARIABLE","$installer",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getTable",117],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_order_entity_datetime'",117],")","}",["T_ENCAPSED_AND_WHITESPACE","\n    WHERE\n        entity_id=",117],["T_CURLY_OPEN","{",119],["T_VARIABLE","$itemId",119],"}",["T_ENCAPSED_AND_WHITESPACE","\n        AND entity_type_id=",119],["T_CURLY_OPEN","{",120],["T_VARIABLE","$itemEntityId",120],"}",["T_ENCAPSED_AND_WHITESPACE","\n\n    UNION\n\n    SELECT\n        attribute_id, value\n    FROM ",120],["T_CURLY_OPEN","{",126],["T_VARIABLE","$installer",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getTable",126],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_order_entity_int'",126],")","}",["T_ENCAPSED_AND_WHITESPACE","\n    WHERE\n        entity_id=",126],["T_CURLY_OPEN","{",128],["T_VARIABLE","$itemId",128],"}",["T_ENCAPSED_AND_WHITESPACE","\n        AND entity_type_id=",128],["T_CURLY_OPEN","{",129],["T_VARIABLE","$itemEntityId",129],"}",["T_ENCAPSED_AND_WHITESPACE","\n\n    UNION\n\n    SELECT\n        attribute_id, value\n    FROM ",129],["T_CURLY_OPEN","{",135],["T_VARIABLE","$installer",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getTable",135],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_order_entity_text'",135],")","}",["T_ENCAPSED_AND_WHITESPACE","\n    WHERE\n        entity_id=",135],["T_CURLY_OPEN","{",137],["T_VARIABLE","$itemId",137],"}",["T_ENCAPSED_AND_WHITESPACE","\n        AND entity_type_id=",137],["T_CURLY_OPEN","{",138],["T_VARIABLE","$itemEntityId",138],"}",["T_ENCAPSED_AND_WHITESPACE","\n\n    UNION\n\n    SELECT\n        attribute_id, value\n    FROM ",138],["T_CURLY_OPEN","{",144],["T_VARIABLE","$installer",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","getTable",144],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_order_entity_varchar'",144],")","}",["T_ENCAPSED_AND_WHITESPACE","\n    WHERE\n        entity_id=",144],["T_CURLY_OPEN","{",146],["T_VARIABLE","$itemId",146],"}",["T_ENCAPSED_AND_WHITESPACE","\n        AND entity_type_id=",146],["T_CURLY_OPEN","{",147],["T_VARIABLE","$itemEntityId",147],"}",["T_ENCAPSED_AND_WHITESPACE","\n    ",147],"\"",";",["T_WHITESPACE","\n\n    ",148],["T_VARIABLE","$data",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_VARIABLE","$installer",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","getConnection",150],"(",")",["T_OBJECT_OPERATOR","->",150],["T_STRING","fetchPairs",150],"(",["T_VARIABLE","$sql",150],")",";",["T_WHITESPACE","\n    ",150],["T_FOREACH","foreach",151],["T_WHITESPACE"," ",151],"(",["T_VARIABLE","$data",151],["T_WHITESPACE"," ",151],["T_AS","as",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$attributeId",151],["T_WHITESPACE"," ",151],["T_DOUBLE_ARROW","=>",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$attributeValue",151],")",["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n        ",151],["T_IF","if",152],["T_WHITESPACE"," ",152],"(",["T_ISSET","isset",152],"(",["T_VARIABLE","$itemAttributes",152],"[",["T_VARIABLE","$attributeId",152],"]",")",")",["T_WHITESPACE"," ",152],"{",["T_WHITESPACE","\n            ",152],["T_VARIABLE","$itemData",153],"[",["T_VARIABLE","$itemAttributes",153],"[",["T_VARIABLE","$attributeId",153],"]","]",["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_VARIABLE","$attributeValue",153],";",["T_WHITESPACE","\n        ",153],"}",["T_WHITESPACE","\n    ",154],"}",["T_WHITESPACE","\n\n    ",155],["T_VARIABLE","$newItemData",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_ARRAY","array",157],"(",["T_WHITESPACE","\n        ",157],["T_CONSTANT_ENCAPSED_STRING","'item_id'",158],["T_WHITESPACE","   ",158],["T_DOUBLE_ARROW","=>",158],["T_WHITESPACE"," ",158],["T_VARIABLE","$itemData",158],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",158],"]",",",["T_WHITESPACE","\n        ",158],["T_CONSTANT_ENCAPSED_STRING","'order_id'",159],["T_WHITESPACE","  ",159],["T_DOUBLE_ARROW","=>",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$itemData",159],"[",["T_CONSTANT_ENCAPSED_STRING","'parent_id'",159],"]",",",["T_WHITESPACE","\n    ",159],")",";",["T_WHITESPACE","\n\n    ",160],["T_FOREACH","foreach",162],["T_WHITESPACE"," ",162],"(",["T_VARIABLE","$itemData",162],["T_WHITESPACE"," ",162],["T_AS","as",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$key",162],["T_WHITESPACE"," ",162],["T_DOUBLE_ARROW","=>",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$value",162],")",["T_WHITESPACE"," ",162],"{",["T_WHITESPACE","\n        ",162],["T_IF","if",163],["T_WHITESPACE"," ",163],"(",["T_ISSET","isset",163],"(",["T_VARIABLE","$itemFields",163],"[",["T_VARIABLE","$key",163],"]",")",")",["T_WHITESPACE"," ",163],"{",["T_WHITESPACE","\n            ",163],["T_VARIABLE","$newItemData",164],"[",["T_VARIABLE","$key",164],"]",["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_VARIABLE","$value",164],";",["T_WHITESPACE","\n        ",164],"}",["T_WHITESPACE","\n    ",165],"}",["T_WHITESPACE","\n\n    ",166],["T_VARIABLE","$installer",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","getConnection",168],"(",")",["T_OBJECT_OPERATOR","->",168],["T_STRING","insert",168],"(",["T_VARIABLE","$installer",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","getTable",168],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_flat_order_item'",168],")",",",["T_WHITESPACE"," ",168],["T_VARIABLE","$newItemData",168],")",";",["T_WHITESPACE","\n",168],"}",["T_WHITESPACE","\n",169]]