[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Sales\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Invoice report resource model\n *\n * @category    Mage\n * @package     Mage_Sales\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Sales_Model_Resource_Report_Invoiced",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Sales_Model_Resource_Report_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Model initialization\n     *\n     *\/",37],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_FUNCTION","function",41],["T_WHITESPACE"," ",41],["T_STRING","_construct",41],"(",")",["T_WHITESPACE","\n    ",41],"{",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","_setResource",43],"(",["T_CONSTANT_ENCAPSED_STRING","'sales'",43],")",";",["T_WHITESPACE","\n    ",43],"}",["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * Aggregate Invoiced data\n     *\n     * @param mixed $from\n     * @param mixed $to\n     * @return Mage_Sales_Model_Resource_Report_Invoiced\n     *\/",46],["T_WHITESPACE","\n    ",52],["T_PUBLIC","public",53],["T_WHITESPACE"," ",53],["T_FUNCTION","function",53],["T_WHITESPACE"," ",53],["T_STRING","aggregate",53],"(",["T_VARIABLE","$from",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_STRING","null",53],",",["T_WHITESPACE"," ",53],["T_VARIABLE","$to",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_STRING","null",53],")",["T_WHITESPACE","\n    ",53],"{",["T_WHITESPACE","\n        ",54],["T_COMMENT","\/\/ convert input dates to UTC to be comparable with DATETIME fields in DB\n",55],["T_WHITESPACE","        ",56],["T_VARIABLE","$from",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","_dateToUtc",56],"(",["T_VARIABLE","$from",56],")",";",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$to",57],["T_WHITESPACE","   ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","_dateToUtc",57],"(",["T_VARIABLE","$to",57],")",";",["T_WHITESPACE","\n\n        ",57],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","_checkDates",59],"(",["T_VARIABLE","$from",59],",",["T_WHITESPACE"," ",59],["T_VARIABLE","$to",59],")",";",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","_aggregateByOrderCreatedAt",60],"(",["T_VARIABLE","$from",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$to",60],")",";",["T_WHITESPACE","\n        ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","_aggregateByInvoiceCreatedAt",61],"(",["T_VARIABLE","$from",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$to",61],")",";",["T_WHITESPACE","\n\n        ",61],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","_setFlagData",63],"(",["T_STRING","Mage_Reports_Model_Flag",63],["T_DOUBLE_COLON","::",63],["T_STRING","REPORT_INVOICE_FLAG_CODE",63],")",";",["T_WHITESPACE","\n        ",63],["T_RETURN","return",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$this",64],";",["T_WHITESPACE","\n    ",64],"}",["T_WHITESPACE","\n\n    ",65],["T_DOC_COMMENT","\/**\n     * Aggregate Invoiced data by invoice created_at as period\n     *\n     * @param mixed $from\n     * @param mixed $to\n     * @return Mage_Sales_Model_Resource_Report_Invoiced\n     *\/",67],["T_WHITESPACE","\n    ",73],["T_PROTECTED","protected",74],["T_WHITESPACE"," ",74],["T_FUNCTION","function",74],["T_WHITESPACE"," ",74],["T_STRING","_aggregateByInvoiceCreatedAt",74],"(",["T_VARIABLE","$from",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$to",74],")",["T_WHITESPACE","\n    ",74],"{",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$table",76],["T_WHITESPACE","       ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getTable",76],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/invoiced_aggregated'",76],")",";",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$sourceTable",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getTable",77],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/invoice'",77],")",";",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$orderTable",78],["T_WHITESPACE","  ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getTable",78],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order'",78],")",";",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$helper",79],["T_WHITESPACE","      ",79],"=",["T_WHITESPACE"," ",79],["T_STRING","Mage",79],["T_DOUBLE_COLON","::",79],["T_STRING","getResourceHelper",79],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",79],")",";",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$adapter",80],["T_WHITESPACE","     ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","_getWriteAdapter",80],"(",")",";",["T_WHITESPACE","\n\n        ",80],["T_VARIABLE","$adapter",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","beginTransaction",82],"(",")",";",["T_WHITESPACE","\n\n        ",82],["T_TRY","try",84],["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n            ",84],["T_IF","if",85],["T_WHITESPACE"," ",85],"(",["T_VARIABLE","$from",85],["T_WHITESPACE"," ",85],["T_IS_NOT_IDENTICAL","!==",85],["T_WHITESPACE"," ",85],["T_STRING","null",85],["T_WHITESPACE"," ",85],["T_BOOLEAN_OR","||",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$to",85],["T_WHITESPACE"," ",85],["T_IS_NOT_IDENTICAL","!==",85],["T_WHITESPACE"," ",85],["T_STRING","null",85],")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n                ",85],["T_VARIABLE","$subSelect",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","_getTableDateRangeRelatedSelect",86],"(",["T_WHITESPACE","\n                    ",86],["T_VARIABLE","$sourceTable",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$orderTable",87],",",["T_WHITESPACE"," ",87],["T_ARRAY","array",87],"(",["T_CONSTANT_ENCAPSED_STRING","'order_id'",87],["T_DOUBLE_ARROW","=>",87],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",87],")",",",["T_WHITESPACE","\n                    ",87],["T_CONSTANT_ENCAPSED_STRING","'created_at'",88],",",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'updated_at'",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$from",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$to",88],["T_WHITESPACE","\n                ",88],")",";",["T_WHITESPACE","\n            ",89],"}",["T_WHITESPACE"," ",90],["T_ELSE","else",90],["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n                ",90],["T_VARIABLE","$subSelect",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_STRING","null",91],";",["T_WHITESPACE","\n            ",91],"}",["T_WHITESPACE","\n\n            ",92],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","_clearTableByDateRange",94],"(",["T_VARIABLE","$table",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$from",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$to",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$subSelect",94],")",";",["T_WHITESPACE","\n            ",94],["T_COMMENT","\/\/ convert dates from UTC to current admin timezone\n",95],["T_WHITESPACE","            ",96],["T_VARIABLE","$periodExpr",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$adapter",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getDatePartSql",96],"(",["T_WHITESPACE","\n                ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","getStoreTZOffsetQuery",97],"(",["T_WHITESPACE","\n                    ",97],["T_ARRAY","array",98],"(",["T_CONSTANT_ENCAPSED_STRING","'source_table'",98],["T_WHITESPACE"," ",98],["T_DOUBLE_ARROW","=>",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$sourceTable",98],")",",",["T_WHITESPACE","\n                    ",98],["T_CONSTANT_ENCAPSED_STRING","'source_table.created_at'",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$from",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$to",99],["T_WHITESPACE","\n                ",99],")",["T_WHITESPACE","\n            ",100],")",";",["T_WHITESPACE","\n            ",101],["T_VARIABLE","$columns",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_ARRAY","array",102],"(",["T_WHITESPACE","\n                ",102],["T_COMMENT","\/\/ convert dates from UTC to current admin timezone\n",103],["T_WHITESPACE","                ",104],["T_CONSTANT_ENCAPSED_STRING","'period'",104],["T_WHITESPACE","                ",104],["T_DOUBLE_ARROW","=>",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$periodExpr",104],",",["T_WHITESPACE","\n                ",104],["T_CONSTANT_ENCAPSED_STRING","'store_id'",105],["T_WHITESPACE","              ",105],["T_DOUBLE_ARROW","=>",105],["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'order_table.store_id'",105],",",["T_WHITESPACE","\n                ",105],["T_CONSTANT_ENCAPSED_STRING","'order_status'",106],["T_WHITESPACE","          ",106],["T_DOUBLE_ARROW","=>",106],["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'order_table.status'",106],",",["T_WHITESPACE","\n                ",106],["T_CONSTANT_ENCAPSED_STRING","'orders_count'",107],["T_WHITESPACE","          ",107],["T_DOUBLE_ARROW","=>",107],["T_WHITESPACE"," ",107],["T_NEW","new",107],["T_WHITESPACE"," ",107],["T_STRING","Zend_Db_Expr",107],"(",["T_CONSTANT_ENCAPSED_STRING","'COUNT(order_table.entity_id)'",107],")",",",["T_WHITESPACE","\n                ",107],["T_CONSTANT_ENCAPSED_STRING","'orders_invoiced'",108],["T_WHITESPACE","       ",108],["T_DOUBLE_ARROW","=>",108],["T_WHITESPACE"," ",108],["T_NEW","new",108],["T_WHITESPACE"," ",108],["T_STRING","Zend_Db_Expr",108],"(",["T_CONSTANT_ENCAPSED_STRING","'COUNT(order_table.entity_id)'",108],")",",",["T_WHITESPACE","\n                ",108],["T_CONSTANT_ENCAPSED_STRING","'invoiced'",109],["T_WHITESPACE","              ",109],["T_DOUBLE_ARROW","=>",109],["T_WHITESPACE"," ",109],["T_NEW","new",109],["T_WHITESPACE"," ",109],["T_STRING","Zend_Db_Expr",109],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(order_table.base_total_invoiced'",109],["T_WHITESPACE","\n                    ",109],".",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","' * order_table.base_to_global_rate)'",110],")",",",["T_WHITESPACE","\n                ",110],["T_CONSTANT_ENCAPSED_STRING","'invoiced_captured'",111],["T_WHITESPACE","     ",111],["T_DOUBLE_ARROW","=>",111],["T_WHITESPACE"," ",111],["T_NEW","new",111],["T_WHITESPACE"," ",111],["T_STRING","Zend_Db_Expr",111],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(order_table.base_total_paid'",111],["T_WHITESPACE","\n                    ",111],".",["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","' * order_table.base_to_global_rate)'",112],")",",",["T_WHITESPACE","\n                ",112],["T_CONSTANT_ENCAPSED_STRING","'invoiced_not_captured'",113],["T_WHITESPACE"," ",113],["T_DOUBLE_ARROW","=>",113],["T_WHITESPACE"," ",113],["T_NEW","new",113],["T_WHITESPACE"," ",113],["T_STRING","Zend_Db_Expr",113],"(",["T_WHITESPACE","\n                    ",113],["T_CONSTANT_ENCAPSED_STRING","'SUM((order_table.base_total_invoiced - order_table.base_total_paid)'",114],["T_WHITESPACE","\n                    ",114],".",["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","' * order_table.base_to_global_rate)'",115],")",["T_WHITESPACE","\n            ",115],")",";",["T_WHITESPACE","\n\n            ",116],["T_VARIABLE","$select",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$adapter",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","select",118],"(",")",";",["T_WHITESPACE","\n            ",118],["T_VARIABLE","$select",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","from",119],"(",["T_ARRAY","array",119],"(",["T_CONSTANT_ENCAPSED_STRING","'source_table'",119],["T_WHITESPACE"," ",119],["T_DOUBLE_ARROW","=>",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$sourceTable",119],")",",",["T_WHITESPACE"," ",119],["T_VARIABLE","$columns",119],")",["T_WHITESPACE","\n                ",119],["T_OBJECT_OPERATOR","->",120],["T_STRING","joinInner",120],"(",["T_WHITESPACE","\n                    ",120],["T_ARRAY","array",121],"(",["T_CONSTANT_ENCAPSED_STRING","'order_table'",121],["T_WHITESPACE"," ",121],["T_DOUBLE_ARROW","=>",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$orderTable",121],")",",",["T_WHITESPACE","\n                    ",121],["T_VARIABLE","$adapter",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","quoteInto",122],"(",["T_WHITESPACE","\n                        ",122],["T_CONSTANT_ENCAPSED_STRING","'source_table.order_id = order_table.entity_id AND order_table.state <> ?'",123],",",["T_WHITESPACE","\n                        ",123],["T_STRING","Mage_Sales_Model_Order",124],["T_DOUBLE_COLON","::",124],["T_STRING","STATE_CANCELED",124],")",",",["T_WHITESPACE","\n                    ",124],["T_ARRAY","array",125],"(",")",["T_WHITESPACE","\n                ",125],")",";",["T_WHITESPACE","\n\n            ",126],["T_VARIABLE","$filterSubSelect",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_VARIABLE","$adapter",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","select",128],"(",")",";",["T_WHITESPACE","\n            ",128],["T_VARIABLE","$filterSubSelect",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","from",129],"(",["T_ARRAY","array",129],"(",["T_CONSTANT_ENCAPSED_STRING","'filter_source_table'",129],["T_WHITESPACE"," ",129],["T_DOUBLE_ARROW","=>",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$sourceTable",129],")",",",["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","'MAX(filter_source_table.entity_id)'",129],")",["T_WHITESPACE","\n                ",129],["T_OBJECT_OPERATOR","->",130],["T_STRING","where",130],"(",["T_CONSTANT_ENCAPSED_STRING","'filter_source_table.order_id = source_table.order_id'",130],")",";",["T_WHITESPACE","\n\n            ",130],["T_IF","if",132],["T_WHITESPACE"," ",132],"(",["T_VARIABLE","$subSelect",132],["T_WHITESPACE"," ",132],["T_IS_NOT_IDENTICAL","!==",132],["T_WHITESPACE"," ",132],["T_STRING","null",132],")",["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n                ",132],["T_VARIABLE","$select",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","having",133],"(",["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_makeConditionFromDateRangeSelect",133],"(",["T_VARIABLE","$subSelect",133],",",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'period'",133],")",")",";",["T_WHITESPACE","\n            ",133],"}",["T_WHITESPACE","\n\n            ",134],["T_VARIABLE","$select",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","where",136],"(",["T_CONSTANT_ENCAPSED_STRING","'source_table.entity_id = (?)'",136],",",["T_WHITESPACE"," ",136],["T_NEW","new",136],["T_WHITESPACE"," ",136],["T_STRING","Zend_Db_Expr",136],"(",["T_VARIABLE","$filterSubSelect",136],")",")",";",["T_WHITESPACE","\n            ",136],["T_UNSET","unset",137],"(",["T_VARIABLE","$filterSubSelect",137],")",";",["T_WHITESPACE","\n\n            ",137],["T_VARIABLE","$select",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","group",139],"(",["T_ARRAY","array",139],"(",["T_WHITESPACE","\n                ",139],["T_VARIABLE","$periodExpr",140],",",["T_WHITESPACE","\n                ",140],["T_CONSTANT_ENCAPSED_STRING","'order_table.store_id'",141],",",["T_WHITESPACE","\n                ",141],["T_CONSTANT_ENCAPSED_STRING","'order_table.status'",142],["T_WHITESPACE","\n            ",142],")",")",";",["T_WHITESPACE","\n\n            ",143],["T_VARIABLE","$select",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","having",145],"(",["T_CONSTANT_ENCAPSED_STRING","'orders_count > 0'",145],")",";",["T_WHITESPACE","\n            ",145],["T_VARIABLE","$insertQuery",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_VARIABLE","$helper",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","getInsertFromSelectUsingAnalytic",146],"(",["T_VARIABLE","$select",146],",",["T_WHITESPACE"," ",146],["T_VARIABLE","$table",146],",",["T_WHITESPACE"," ",146],["T_STRING","array_keys",146],"(",["T_VARIABLE","$columns",146],")",")",";",["T_WHITESPACE","\n            ",146],["T_VARIABLE","$adapter",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","query",147],"(",["T_VARIABLE","$insertQuery",147],")",";",["T_WHITESPACE","\n            ",147],["T_VARIABLE","$select",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","reset",148],"(",")",";",["T_WHITESPACE","\n\n            ",148],["T_VARIABLE","$columns",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_ARRAY","array",150],"(",["T_WHITESPACE","\n                ",150],["T_CONSTANT_ENCAPSED_STRING","'period'",151],["T_WHITESPACE","                ",151],["T_DOUBLE_ARROW","=>",151],["T_WHITESPACE"," ",151],["T_CONSTANT_ENCAPSED_STRING","'period'",151],",",["T_WHITESPACE","\n                ",151],["T_CONSTANT_ENCAPSED_STRING","'store_id'",152],["T_WHITESPACE","              ",152],["T_DOUBLE_ARROW","=>",152],["T_WHITESPACE"," ",152],["T_NEW","new",152],["T_WHITESPACE"," ",152],["T_STRING","Zend_Db_Expr",152],"(",["T_STRING","Mage_Core_Model_App",152],["T_DOUBLE_COLON","::",152],["T_STRING","ADMIN_STORE_ID",152],")",",",["T_WHITESPACE","\n                ",152],["T_CONSTANT_ENCAPSED_STRING","'order_status'",153],["T_WHITESPACE","          ",153],["T_DOUBLE_ARROW","=>",153],["T_WHITESPACE"," ",153],["T_CONSTANT_ENCAPSED_STRING","'order_status'",153],",",["T_WHITESPACE","\n                ",153],["T_CONSTANT_ENCAPSED_STRING","'orders_count'",154],["T_WHITESPACE","          ",154],["T_DOUBLE_ARROW","=>",154],["T_WHITESPACE"," ",154],["T_NEW","new",154],["T_WHITESPACE"," ",154],["T_STRING","Zend_Db_Expr",154],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(orders_count)'",154],")",",",["T_WHITESPACE","\n                ",154],["T_CONSTANT_ENCAPSED_STRING","'orders_invoiced'",155],["T_WHITESPACE","       ",155],["T_DOUBLE_ARROW","=>",155],["T_WHITESPACE"," ",155],["T_NEW","new",155],["T_WHITESPACE"," ",155],["T_STRING","Zend_Db_Expr",155],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(orders_invoiced)'",155],")",",",["T_WHITESPACE","\n                ",155],["T_CONSTANT_ENCAPSED_STRING","'invoiced'",156],["T_WHITESPACE","              ",156],["T_DOUBLE_ARROW","=>",156],["T_WHITESPACE"," ",156],["T_NEW","new",156],["T_WHITESPACE"," ",156],["T_STRING","Zend_Db_Expr",156],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(invoiced)'",156],")",",",["T_WHITESPACE","\n                ",156],["T_CONSTANT_ENCAPSED_STRING","'invoiced_captured'",157],["T_WHITESPACE","     ",157],["T_DOUBLE_ARROW","=>",157],["T_WHITESPACE"," ",157],["T_NEW","new",157],["T_WHITESPACE"," ",157],["T_STRING","Zend_Db_Expr",157],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(invoiced_captured)'",157],")",",",["T_WHITESPACE","\n                ",157],["T_CONSTANT_ENCAPSED_STRING","'invoiced_not_captured'",158],["T_WHITESPACE"," ",158],["T_DOUBLE_ARROW","=>",158],["T_WHITESPACE"," ",158],["T_NEW","new",158],["T_WHITESPACE"," ",158],["T_STRING","Zend_Db_Expr",158],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(invoiced_not_captured)'",158],")",["T_WHITESPACE","\n            ",158],")",";",["T_WHITESPACE","\n\n            ",159],["T_VARIABLE","$select",161],["T_WHITESPACE","\n                ",161],["T_OBJECT_OPERATOR","->",162],["T_STRING","from",162],"(",["T_VARIABLE","$table",162],",",["T_WHITESPACE"," ",162],["T_VARIABLE","$columns",162],")",["T_WHITESPACE","\n                ",162],["T_OBJECT_OPERATOR","->",163],["T_STRING","where",163],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id <> ?'",163],",",["T_WHITESPACE"," ",163],["T_LNUMBER","0",163],")",";",["T_WHITESPACE","\n\n            ",163],["T_IF","if",165],["T_WHITESPACE"," ",165],"(",["T_VARIABLE","$subSelect",165],["T_WHITESPACE"," ",165],["T_IS_NOT_IDENTICAL","!==",165],["T_WHITESPACE"," ",165],["T_STRING","null",165],")",["T_WHITESPACE"," ",165],"{",["T_WHITESPACE","\n                ",165],["T_VARIABLE","$select",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","where",166],"(",["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","_makeConditionFromDateRangeSelect",166],"(",["T_VARIABLE","$subSelect",166],",",["T_WHITESPACE"," ",166],["T_CONSTANT_ENCAPSED_STRING","'period'",166],")",")",";",["T_WHITESPACE","\n            ",166],"}",["T_WHITESPACE","\n\n            ",167],["T_VARIABLE","$select",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","group",169],"(",["T_ARRAY","array",169],"(",["T_WHITESPACE","\n                ",169],["T_CONSTANT_ENCAPSED_STRING","'period'",170],",",["T_WHITESPACE","\n                ",170],["T_CONSTANT_ENCAPSED_STRING","'order_status'",171],["T_WHITESPACE","\n            ",171],")",")",";",["T_WHITESPACE","\n\n            ",172],["T_VARIABLE","$insertQuery",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_VARIABLE","$helper",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","getInsertFromSelectUsingAnalytic",174],"(",["T_VARIABLE","$select",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$table",174],",",["T_WHITESPACE"," ",174],["T_STRING","array_keys",174],"(",["T_VARIABLE","$columns",174],")",")",";",["T_WHITESPACE","\n            ",174],["T_VARIABLE","$adapter",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","query",175],"(",["T_VARIABLE","$insertQuery",175],")",";",["T_WHITESPACE","\n            ",175],["T_VARIABLE","$adapter",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","commit",176],"(",")",";",["T_WHITESPACE","\n        ",176],"}",["T_WHITESPACE"," ",177],["T_CATCH","catch",177],["T_WHITESPACE"," ",177],"(",["T_STRING","Exception",177],["T_WHITESPACE"," ",177],["T_VARIABLE","$e",177],")",["T_WHITESPACE"," ",177],"{",["T_WHITESPACE","\n            ",177],["T_VARIABLE","$adapter",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","rollBack",178],"(",")",";",["T_WHITESPACE","\n            ",178],["T_THROW","throw",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$e",179],";",["T_WHITESPACE","\n        ",179],"}",["T_WHITESPACE","\n\n        ",180],["T_RETURN","return",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$this",182],";",["T_WHITESPACE","\n    ",182],"}",["T_WHITESPACE","\n\n    ",183],["T_DOC_COMMENT","\/**\n     * Aggregate Invoiced data by order created_at as period\n     *\n     * @param mixed $from\n     * @param mixed $to\n     * @return Mage_Sales_Model_Resource_Report_Invoiced\n     *\/",185],["T_WHITESPACE","\n    ",191],["T_PROTECTED","protected",192],["T_WHITESPACE"," ",192],["T_FUNCTION","function",192],["T_WHITESPACE"," ",192],["T_STRING","_aggregateByOrderCreatedAt",192],"(",["T_VARIABLE","$from",192],",",["T_WHITESPACE"," ",192],["T_VARIABLE","$to",192],")",["T_WHITESPACE","\n    ",192],"{",["T_WHITESPACE","\n        ",193],["T_VARIABLE","$table",194],["T_WHITESPACE","       ",194],"=",["T_WHITESPACE"," ",194],["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","getTable",194],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/invoiced_aggregated_order'",194],")",";",["T_WHITESPACE","\n        ",194],["T_VARIABLE","$sourceTable",195],["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","getTable",195],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order'",195],")",";",["T_WHITESPACE","\n        ",195],["T_VARIABLE","$adapter",196],["T_WHITESPACE","     ",196],"=",["T_WHITESPACE"," ",196],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","_getWriteAdapter",196],"(",")",";",["T_WHITESPACE","\n\n\n            ",196],["T_IF","if",199],["T_WHITESPACE"," ",199],"(",["T_VARIABLE","$from",199],["T_WHITESPACE"," ",199],["T_IS_NOT_IDENTICAL","!==",199],["T_WHITESPACE"," ",199],["T_STRING","null",199],["T_WHITESPACE"," ",199],["T_BOOLEAN_OR","||",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$to",199],["T_WHITESPACE"," ",199],["T_IS_NOT_IDENTICAL","!==",199],["T_WHITESPACE"," ",199],["T_STRING","null",199],")",["T_WHITESPACE"," ",199],"{",["T_WHITESPACE","\n                ",199],["T_VARIABLE","$subSelect",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","_getTableDateRangeSelect",200],"(",["T_VARIABLE","$sourceTable",200],",",["T_WHITESPACE"," ",200],["T_CONSTANT_ENCAPSED_STRING","'created_at'",200],",",["T_WHITESPACE"," ",200],["T_CONSTANT_ENCAPSED_STRING","'updated_at'",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$from",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$to",200],")",";",["T_WHITESPACE","\n            ",200],"}",["T_WHITESPACE"," ",201],["T_ELSE","else",201],["T_WHITESPACE"," ",201],"{",["T_WHITESPACE","\n                ",201],["T_VARIABLE","$subSelect",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_STRING","null",202],";",["T_WHITESPACE","\n            ",202],"}",["T_WHITESPACE","\n\n            ",203],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","_clearTableByDateRange",205],"(",["T_VARIABLE","$table",205],",",["T_WHITESPACE"," ",205],["T_VARIABLE","$from",205],",",["T_WHITESPACE"," ",205],["T_VARIABLE","$to",205],",",["T_WHITESPACE"," ",205],["T_VARIABLE","$subSelect",205],")",";",["T_WHITESPACE","\n            ",205],["T_COMMENT","\/\/ convert dates from UTC to current admin timezone\n",206],["T_WHITESPACE","            ",207],["T_VARIABLE","$periodExpr",207],["T_WHITESPACE"," ",207],"=",["T_WHITESPACE"," ",207],["T_VARIABLE","$adapter",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","getDatePartSql",207],"(",["T_WHITESPACE","\n                ",207],["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","getStoreTZOffsetQuery",208],"(",["T_WHITESPACE","\n                    ",208],["T_VARIABLE","$sourceTable",209],",",["T_WHITESPACE"," ",209],["T_CONSTANT_ENCAPSED_STRING","'created_at'",209],",",["T_WHITESPACE"," ",209],["T_VARIABLE","$from",209],",",["T_WHITESPACE"," ",209],["T_VARIABLE","$to",209],["T_WHITESPACE","\n                ",209],")",["T_WHITESPACE","\n            ",210],")",";",["T_WHITESPACE","\n\n            ",211],["T_VARIABLE","$columns",213],["T_WHITESPACE"," ",213],"=",["T_WHITESPACE"," ",213],["T_ARRAY","array",213],"(",["T_WHITESPACE","\n                ",213],["T_CONSTANT_ENCAPSED_STRING","'period'",214],["T_WHITESPACE","                ",214],["T_DOUBLE_ARROW","=>",214],["T_WHITESPACE"," ",214],["T_VARIABLE","$periodExpr",214],",",["T_WHITESPACE","\n                ",214],["T_CONSTANT_ENCAPSED_STRING","'store_id'",215],["T_WHITESPACE","              ",215],["T_DOUBLE_ARROW","=>",215],["T_WHITESPACE"," ",215],["T_CONSTANT_ENCAPSED_STRING","'store_id'",215],",",["T_WHITESPACE","\n                ",215],["T_CONSTANT_ENCAPSED_STRING","'order_status'",216],["T_WHITESPACE","          ",216],["T_DOUBLE_ARROW","=>",216],["T_WHITESPACE"," ",216],["T_CONSTANT_ENCAPSED_STRING","'status'",216],",",["T_WHITESPACE","\n                ",216],["T_CONSTANT_ENCAPSED_STRING","'orders_count'",217],["T_WHITESPACE","          ",217],["T_DOUBLE_ARROW","=>",217],["T_WHITESPACE"," ",217],["T_NEW","new",217],["T_WHITESPACE"," ",217],["T_STRING","Zend_Db_Expr",217],"(",["T_CONSTANT_ENCAPSED_STRING","'COUNT(base_total_invoiced)'",217],")",",",["T_WHITESPACE","\n                ",217],["T_CONSTANT_ENCAPSED_STRING","'orders_invoiced'",218],["T_WHITESPACE","       ",218],["T_DOUBLE_ARROW","=>",218],["T_WHITESPACE"," ",218],["T_NEW","new",218],["T_WHITESPACE"," ",218],["T_STRING","Zend_Db_Expr",218],"(",["T_WHITESPACE","\n                    ",218],["T_STRING","sprintf",219],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(%s)'",219],",",["T_WHITESPACE","\n                        ",219],["T_VARIABLE","$adapter",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","getCheckSql",220],"(",["T_CONSTANT_ENCAPSED_STRING","'base_total_invoiced > 0'",220],",",["T_WHITESPACE"," ",220],["T_LNUMBER","1",220],",",["T_WHITESPACE"," ",220],["T_LNUMBER","0",220],")",["T_WHITESPACE","\n                    ",220],")",["T_WHITESPACE","\n                ",221],")",",",["T_WHITESPACE","\n                ",222],["T_CONSTANT_ENCAPSED_STRING","'invoiced'",223],["T_WHITESPACE","              ",223],["T_DOUBLE_ARROW","=>",223],["T_WHITESPACE"," ",223],["T_NEW","new",223],["T_WHITESPACE"," ",223],["T_STRING","Zend_Db_Expr",223],"(",["T_WHITESPACE","\n                    ",223],["T_STRING","sprintf",224],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(%s * %s)'",224],",",["T_WHITESPACE","\n                        ",224],["T_VARIABLE","$adapter",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","getIfNullSql",225],"(",["T_CONSTANT_ENCAPSED_STRING","'base_total_invoiced'",225],",",["T_LNUMBER","0",225],")",",",["T_WHITESPACE","\n                        ",225],["T_VARIABLE","$adapter",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","getIfNullSql",226],"(",["T_CONSTANT_ENCAPSED_STRING","'base_to_global_rate'",226],",",["T_LNUMBER","0",226],")",["T_WHITESPACE","\n                    ",226],")",["T_WHITESPACE","\n                ",227],")",",",["T_WHITESPACE","\n                ",228],["T_CONSTANT_ENCAPSED_STRING","'invoiced_captured'",229],["T_WHITESPACE","     ",229],["T_DOUBLE_ARROW","=>",229],["T_WHITESPACE"," ",229],["T_NEW","new",229],["T_WHITESPACE"," ",229],["T_STRING","Zend_Db_Expr",229],"(",["T_WHITESPACE","\n                    ",229],["T_STRING","sprintf",230],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(%s * %s)'",230],",",["T_WHITESPACE","\n                        ",230],["T_VARIABLE","$adapter",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","getIfNullSql",231],"(",["T_CONSTANT_ENCAPSED_STRING","'base_total_paid'",231],",",["T_LNUMBER","0",231],")",",",["T_WHITESPACE","\n                        ",231],["T_VARIABLE","$adapter",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","getIfNullSql",232],"(",["T_CONSTANT_ENCAPSED_STRING","'base_to_global_rate'",232],",",["T_LNUMBER","0",232],")",["T_WHITESPACE","\n                    ",232],")",["T_WHITESPACE","\n                ",233],")",",",["T_WHITESPACE","\n                ",234],["T_CONSTANT_ENCAPSED_STRING","'invoiced_not_captured'",235],["T_WHITESPACE"," ",235],["T_DOUBLE_ARROW","=>",235],["T_WHITESPACE"," ",235],["T_NEW","new",235],["T_WHITESPACE"," ",235],["T_STRING","Zend_Db_Expr",235],"(",["T_WHITESPACE","\n                    ",235],["T_STRING","sprintf",236],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM((%s - %s) * %s)'",236],",",["T_WHITESPACE","\n                        ",236],["T_VARIABLE","$adapter",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","getIfNullSql",237],"(",["T_CONSTANT_ENCAPSED_STRING","'base_total_invoiced'",237],",",["T_LNUMBER","0",237],")",",",["T_WHITESPACE","\n                        ",237],["T_VARIABLE","$adapter",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","getIfNullSql",238],"(",["T_CONSTANT_ENCAPSED_STRING","'base_total_paid'",238],",",["T_LNUMBER","0",238],")",",",["T_WHITESPACE","\n                        ",238],["T_VARIABLE","$adapter",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","getIfNullSql",239],"(",["T_CONSTANT_ENCAPSED_STRING","'base_to_global_rate'",239],",",["T_LNUMBER","0",239],")",["T_WHITESPACE","\n                    ",239],")",["T_WHITESPACE","\n                ",240],")",["T_WHITESPACE","\n\n            ",241],")",";",["T_WHITESPACE","\n\n            ",243],["T_VARIABLE","$select",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_VARIABLE","$adapter",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","select",245],"(",")",";",["T_WHITESPACE","\n            ",245],["T_VARIABLE","$select",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","from",246],"(",["T_VARIABLE","$sourceTable",246],",",["T_WHITESPACE"," ",246],["T_VARIABLE","$columns",246],")",["T_WHITESPACE","\n                ",246],["T_OBJECT_OPERATOR","->",247],["T_STRING","where",247],"(",["T_CONSTANT_ENCAPSED_STRING","'state <> ?'",247],",",["T_WHITESPACE"," ",247],["T_STRING","Mage_Sales_Model_Order",247],["T_DOUBLE_COLON","::",247],["T_STRING","STATE_CANCELED",247],")",";",["T_WHITESPACE","\n\n            ",247],["T_IF","if",249],["T_WHITESPACE"," ",249],"(",["T_VARIABLE","$subSelect",249],["T_WHITESPACE"," ",249],["T_IS_NOT_IDENTICAL","!==",249],["T_WHITESPACE"," ",249],["T_STRING","null",249],")",["T_WHITESPACE"," ",249],"{",["T_WHITESPACE","\n                ",249],["T_VARIABLE","$select",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","having",250],"(",["T_VARIABLE","$this",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","_makeConditionFromDateRangeSelect",250],"(",["T_VARIABLE","$subSelect",250],",",["T_WHITESPACE"," ",250],["T_CONSTANT_ENCAPSED_STRING","'period'",250],")",")",";",["T_WHITESPACE","\n            ",250],"}",["T_WHITESPACE","\n\n            ",251],["T_VARIABLE","$select",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","group",253],"(",["T_ARRAY","array",253],"(",["T_WHITESPACE","\n                ",253],["T_VARIABLE","$periodExpr",254],",",["T_WHITESPACE","\n                ",254],["T_CONSTANT_ENCAPSED_STRING","'store_id'",255],",",["T_WHITESPACE","\n                ",255],["T_CONSTANT_ENCAPSED_STRING","'status'",256],["T_WHITESPACE","\n            ",256],")",")",";",["T_WHITESPACE","\n\n            ",257],["T_VARIABLE","$select",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","having",259],"(",["T_CONSTANT_ENCAPSED_STRING","'orders_count > 0'",259],")",";",["T_WHITESPACE","\n\n            ",259],["T_VARIABLE","$helper",261],["T_WHITESPACE","      ",261],"=",["T_WHITESPACE"," ",261],["T_STRING","Mage",261],["T_DOUBLE_COLON","::",261],["T_STRING","getResourceHelper",261],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",261],")",";",["T_WHITESPACE","\n            ",261],["T_VARIABLE","$insertQuery",262],["T_WHITESPACE"," ",262],"=",["T_WHITESPACE"," ",262],["T_VARIABLE","$helper",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","getInsertFromSelectUsingAnalytic",262],"(",["T_VARIABLE","$select",262],",",["T_WHITESPACE"," ",262],["T_VARIABLE","$table",262],",",["T_WHITESPACE"," ",262],["T_STRING","array_keys",262],"(",["T_VARIABLE","$columns",262],")",")",";",["T_WHITESPACE","\n            ",262],["T_VARIABLE","$adapter",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","query",263],"(",["T_VARIABLE","$insertQuery",263],")",";",["T_WHITESPACE","\n            ",263],["T_VARIABLE","$select",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","reset",264],"(",")",";",["T_WHITESPACE","\n\n            ",264],["T_VARIABLE","$columns",266],["T_WHITESPACE"," ",266],"=",["T_WHITESPACE"," ",266],["T_ARRAY","array",266],"(",["T_WHITESPACE","\n                ",266],["T_CONSTANT_ENCAPSED_STRING","'period'",267],["T_WHITESPACE","                ",267],["T_DOUBLE_ARROW","=>",267],["T_WHITESPACE"," ",267],["T_CONSTANT_ENCAPSED_STRING","'period'",267],",",["T_WHITESPACE","\n                ",267],["T_CONSTANT_ENCAPSED_STRING","'store_id'",268],["T_WHITESPACE","              ",268],["T_DOUBLE_ARROW","=>",268],["T_WHITESPACE"," ",268],["T_NEW","new",268],["T_WHITESPACE"," ",268],["T_STRING","Zend_Db_Expr",268],"(",["T_STRING","Mage_Core_Model_App",268],["T_DOUBLE_COLON","::",268],["T_STRING","ADMIN_STORE_ID",268],")",",",["T_WHITESPACE","\n                ",268],["T_CONSTANT_ENCAPSED_STRING","'order_status'",269],["T_WHITESPACE","          ",269],["T_DOUBLE_ARROW","=>",269],["T_WHITESPACE"," ",269],["T_CONSTANT_ENCAPSED_STRING","'order_status'",269],",",["T_WHITESPACE","\n                ",269],["T_CONSTANT_ENCAPSED_STRING","'orders_count'",270],["T_WHITESPACE","          ",270],["T_DOUBLE_ARROW","=>",270],["T_WHITESPACE"," ",270],["T_NEW","new",270],["T_WHITESPACE"," ",270],["T_STRING","Zend_Db_Expr",270],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(orders_count)'",270],")",",",["T_WHITESPACE","\n                ",270],["T_CONSTANT_ENCAPSED_STRING","'orders_invoiced'",271],["T_WHITESPACE","       ",271],["T_DOUBLE_ARROW","=>",271],["T_WHITESPACE"," ",271],["T_NEW","new",271],["T_WHITESPACE"," ",271],["T_STRING","Zend_Db_Expr",271],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(orders_invoiced)'",271],")",",",["T_WHITESPACE","\n                ",271],["T_CONSTANT_ENCAPSED_STRING","'invoiced'",272],["T_WHITESPACE","              ",272],["T_DOUBLE_ARROW","=>",272],["T_WHITESPACE"," ",272],["T_NEW","new",272],["T_WHITESPACE"," ",272],["T_STRING","Zend_Db_Expr",272],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(invoiced)'",272],")",",",["T_WHITESPACE","\n                ",272],["T_CONSTANT_ENCAPSED_STRING","'invoiced_captured'",273],["T_WHITESPACE","     ",273],["T_DOUBLE_ARROW","=>",273],["T_WHITESPACE"," ",273],["T_NEW","new",273],["T_WHITESPACE"," ",273],["T_STRING","Zend_Db_Expr",273],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(invoiced_captured)'",273],")",",",["T_WHITESPACE","\n                ",273],["T_CONSTANT_ENCAPSED_STRING","'invoiced_not_captured'",274],["T_WHITESPACE"," ",274],["T_DOUBLE_ARROW","=>",274],["T_WHITESPACE"," ",274],["T_NEW","new",274],["T_WHITESPACE"," ",274],["T_STRING","Zend_Db_Expr",274],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(invoiced_not_captured)'",274],")",["T_WHITESPACE","\n            ",274],")",";",["T_WHITESPACE","\n\n            ",275],["T_VARIABLE","$select",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","from",277],"(",["T_VARIABLE","$table",277],",",["T_WHITESPACE"," ",277],["T_VARIABLE","$columns",277],")",["T_WHITESPACE","\n                ",277],["T_OBJECT_OPERATOR","->",278],["T_STRING","where",278],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id <> ?'",278],",",["T_WHITESPACE"," ",278],["T_LNUMBER","0",278],")",";",["T_WHITESPACE","\n\n            ",278],["T_IF","if",280],["T_WHITESPACE"," ",280],"(",["T_VARIABLE","$subSelect",280],["T_WHITESPACE"," ",280],["T_IS_NOT_IDENTICAL","!==",280],["T_WHITESPACE"," ",280],["T_STRING","null",280],")",["T_WHITESPACE"," ",280],"{",["T_WHITESPACE","\n                ",280],["T_VARIABLE","$select",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","where",281],"(",["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","_makeConditionFromDateRangeSelect",281],"(",["T_VARIABLE","$subSelect",281],",",["T_WHITESPACE"," ",281],["T_CONSTANT_ENCAPSED_STRING","'period'",281],")",")",";",["T_WHITESPACE","\n            ",281],"}",["T_WHITESPACE","\n\n            ",282],["T_VARIABLE","$select",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","group",284],"(",["T_ARRAY","array",284],"(",["T_WHITESPACE","\n                ",284],["T_CONSTANT_ENCAPSED_STRING","'period'",285],",",["T_WHITESPACE","\n                ",285],["T_CONSTANT_ENCAPSED_STRING","'order_status'",286],["T_WHITESPACE","\n            ",286],")",")",";",["T_WHITESPACE","\n\n            ",287],["T_VARIABLE","$helper",289],["T_WHITESPACE","      ",289],"=",["T_WHITESPACE"," ",289],["T_STRING","Mage",289],["T_DOUBLE_COLON","::",289],["T_STRING","getResourceHelper",289],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",289],")",";",["T_WHITESPACE","\n            ",289],["T_VARIABLE","$insertQuery",290],["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],["T_VARIABLE","$helper",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","getInsertFromSelectUsingAnalytic",290],"(",["T_VARIABLE","$select",290],",",["T_WHITESPACE"," ",290],["T_VARIABLE","$table",290],",",["T_WHITESPACE"," ",290],["T_STRING","array_keys",290],"(",["T_VARIABLE","$columns",290],")",")",";",["T_WHITESPACE","\n            ",290],["T_VARIABLE","$adapter",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","query",291],"(",["T_VARIABLE","$insertQuery",291],")",";",["T_WHITESPACE","\n\n\n        ",291],["T_RETURN","return",294],["T_WHITESPACE"," ",294],["T_VARIABLE","$this",294],";",["T_WHITESPACE","\n    ",294],"}",["T_WHITESPACE","\n",295],"}",["T_WHITESPACE","\n",296]]