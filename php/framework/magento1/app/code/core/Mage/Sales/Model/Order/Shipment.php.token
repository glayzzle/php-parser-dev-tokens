[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Sales\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Sales order shipment model\n *\n * @method Mage_Sales_Model_Resource_Order_Shipment _getResource()\n * @method Mage_Sales_Model_Resource_Order_Shipment getResource()\n * @method int getStoreId()\n * @method Mage_Sales_Model_Order_Shipment setStoreId(int $value)\n * @method float getTotalWeight()\n * @method Mage_Sales_Model_Order_Shipment setTotalWeight(float $value)\n * @method float getTotalQty()\n * @method Mage_Sales_Model_Order_Shipment setTotalQty(float $value)\n * @method int getEmailSent()\n * @method Mage_Sales_Model_Order_Shipment setEmailSent(int $value)\n * @method int getOrderId()\n * @method Mage_Sales_Model_Order_Shipment setOrderId(int $value)\n * @method int getCustomerId()\n * @method Mage_Sales_Model_Order_Shipment setCustomerId(int $value)\n * @method int getShippingAddressId()\n * @method Mage_Sales_Model_Order_Shipment setShippingAddressId(int $value)\n * @method int getBillingAddressId()\n * @method Mage_Sales_Model_Order_Shipment setBillingAddressId(int $value)\n * @method int getShipmentStatus()\n * @method Mage_Sales_Model_Order_Shipment setShipmentStatus(int $value)\n * @method string getIncrementId()\n * @method Mage_Sales_Model_Order_Shipment setIncrementId(string $value)\n * @method string getCreatedAt()\n * @method Mage_Sales_Model_Order_Shipment setCreatedAt(string $value)\n * @method string getUpdatedAt()\n * @method Mage_Sales_Model_Order_Shipment setUpdatedAt(string $value)\n *\n * @category    Mage\n * @package     Mage_Sales\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",61],["T_CLASS","class",62],["T_WHITESPACE"," ",62],["T_STRING","Mage_Sales_Model_Order_Shipment",62],["T_WHITESPACE"," ",62],["T_EXTENDS","extends",62],["T_WHITESPACE"," ",62],["T_STRING","Mage_Sales_Model_Abstract",62],["T_WHITESPACE","\n",62],"{",["T_WHITESPACE","\n    ",63],["T_CONST","const",64],["T_WHITESPACE"," ",64],["T_STRING","STATUS_NEW",64],["T_WHITESPACE","    ",64],"=",["T_WHITESPACE"," ",64],["T_LNUMBER","1",64],";",["T_WHITESPACE","\n\n    ",64],["T_CONST","const",66],["T_WHITESPACE"," ",66],["T_STRING","XML_PATH_EMAIL_TEMPLATE",66],["T_WHITESPACE","               ",66],"=",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'sales_email\/shipment\/template'",66],";",["T_WHITESPACE","\n    ",66],["T_CONST","const",67],["T_WHITESPACE"," ",67],["T_STRING","XML_PATH_EMAIL_GUEST_TEMPLATE",67],["T_WHITESPACE","         ",67],"=",["T_WHITESPACE"," ",67],["T_CONSTANT_ENCAPSED_STRING","'sales_email\/shipment\/guest_template'",67],";",["T_WHITESPACE","\n    ",67],["T_CONST","const",68],["T_WHITESPACE"," ",68],["T_STRING","XML_PATH_EMAIL_IDENTITY",68],["T_WHITESPACE","               ",68],"=",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'sales_email\/shipment\/identity'",68],";",["T_WHITESPACE","\n    ",68],["T_CONST","const",69],["T_WHITESPACE"," ",69],["T_STRING","XML_PATH_EMAIL_COPY_TO",69],["T_WHITESPACE","                ",69],"=",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'sales_email\/shipment\/copy_to'",69],";",["T_WHITESPACE","\n    ",69],["T_CONST","const",70],["T_WHITESPACE"," ",70],["T_STRING","XML_PATH_EMAIL_COPY_METHOD",70],["T_WHITESPACE","            ",70],"=",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'sales_email\/shipment\/copy_method'",70],";",["T_WHITESPACE","\n    ",70],["T_CONST","const",71],["T_WHITESPACE"," ",71],["T_STRING","XML_PATH_EMAIL_ENABLED",71],["T_WHITESPACE","                ",71],"=",["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'sales_email\/shipment\/enabled'",71],";",["T_WHITESPACE","\n\n    ",71],["T_CONST","const",73],["T_WHITESPACE"," ",73],["T_STRING","XML_PATH_UPDATE_EMAIL_TEMPLATE",73],["T_WHITESPACE","        ",73],"=",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'sales_email\/shipment_comment\/template'",73],";",["T_WHITESPACE","\n    ",73],["T_CONST","const",74],["T_WHITESPACE"," ",74],["T_STRING","XML_PATH_UPDATE_EMAIL_GUEST_TEMPLATE",74],["T_WHITESPACE","  ",74],"=",["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","'sales_email\/shipment_comment\/guest_template'",74],";",["T_WHITESPACE","\n    ",74],["T_CONST","const",75],["T_WHITESPACE"," ",75],["T_STRING","XML_PATH_UPDATE_EMAIL_IDENTITY",75],["T_WHITESPACE","        ",75],"=",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'sales_email\/shipment_comment\/identity'",75],";",["T_WHITESPACE","\n    ",75],["T_CONST","const",76],["T_WHITESPACE"," ",76],["T_STRING","XML_PATH_UPDATE_EMAIL_COPY_TO",76],["T_WHITESPACE","         ",76],"=",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'sales_email\/shipment_comment\/copy_to'",76],";",["T_WHITESPACE","\n    ",76],["T_CONST","const",77],["T_WHITESPACE"," ",77],["T_STRING","XML_PATH_UPDATE_EMAIL_COPY_METHOD",77],["T_WHITESPACE","     ",77],"=",["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","'sales_email\/shipment_comment\/copy_method'",77],";",["T_WHITESPACE","\n    ",77],["T_CONST","const",78],["T_WHITESPACE"," ",78],["T_STRING","XML_PATH_UPDATE_EMAIL_ENABLED",78],["T_WHITESPACE","         ",78],"=",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'sales_email\/shipment_comment\/enabled'",78],";",["T_WHITESPACE","\n\n    ",78],["T_CONST","const",80],["T_WHITESPACE"," ",80],["T_STRING","REPORT_DATE_TYPE_ORDER_CREATED",80],["T_WHITESPACE","        ",80],"=",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'order_created'",80],";",["T_WHITESPACE","\n    ",80],["T_CONST","const",81],["T_WHITESPACE"," ",81],["T_STRING","REPORT_DATE_TYPE_SHIPMENT_CREATED",81],["T_WHITESPACE","     ",81],"=",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'shipment_created'",81],";",["T_WHITESPACE","\n\n    ",81],["T_COMMENT","\/*\n     * Identifier for order history item\n     *\/",83],["T_WHITESPACE","\n    ",85],["T_CONST","const",86],["T_WHITESPACE"," ",86],["T_STRING","HISTORY_ENTITY_NAME",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","'shipment'",86],";",["T_WHITESPACE","\n\n    ",86],["T_PROTECTED","protected",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$_items",88],";",["T_WHITESPACE","\n    ",88],["T_PROTECTED","protected",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$_tracks",89],";",["T_WHITESPACE","\n    ",89],["T_PROTECTED","protected",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$_order",90],";",["T_WHITESPACE","\n    ",90],["T_PROTECTED","protected",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$_comments",91],";",["T_WHITESPACE","\n\n    ",91],["T_PROTECTED","protected",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$_eventPrefix",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","'sales_order_shipment'",93],";",["T_WHITESPACE","\n    ",93],["T_PROTECTED","protected",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$_eventObject",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'shipment'",94],";",["T_WHITESPACE","\n\n    ",94],["T_DOC_COMMENT","\/**\n     * Initialize shipment resource model\n     *\/",96],["T_WHITESPACE","\n    ",98],["T_PROTECTED","protected",99],["T_WHITESPACE"," ",99],["T_FUNCTION","function",99],["T_WHITESPACE"," ",99],["T_STRING","_construct",99],"(",")",["T_WHITESPACE","\n    ",99],"{",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","_init",101],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order_shipment'",101],")",";",["T_WHITESPACE","\n    ",101],"}",["T_WHITESPACE","\n\n    ",102],["T_DOC_COMMENT","\/**\n     * Init mapping array of short fields to its full names\n     *\n     * @return Mage_Sales_Model_Order_Shipment\n     *\/",104],["T_WHITESPACE","\n    ",108],["T_PROTECTED","protected",109],["T_WHITESPACE"," ",109],["T_FUNCTION","function",109],["T_WHITESPACE"," ",109],["T_STRING","_initOldFieldsMap",109],"(",")",["T_WHITESPACE","\n    ",109],"{",["T_WHITESPACE","\n        ",110],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","_oldFieldsMap",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_STRING","Mage",111],["T_DOUBLE_COLON","::",111],["T_STRING","helper",111],"(",["T_CONSTANT_ENCAPSED_STRING","'sales'",111],")",["T_OBJECT_OPERATOR","->",111],["T_STRING","getOldFieldMap",111],"(",["T_CONSTANT_ENCAPSED_STRING","'order_shipment'",111],")",";",["T_WHITESPACE","\n        ",111],["T_RETURN","return",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],";",["T_WHITESPACE","\n    ",112],"}",["T_WHITESPACE","\n\n    ",113],["T_DOC_COMMENT","\/**\n     * Load shipment by increment id\n     *\n     * @param string $incrementId\n     * @return Mage_Sales_Model_Order_Shipment\n     *\/",115],["T_WHITESPACE","\n    ",120],["T_PUBLIC","public",121],["T_WHITESPACE"," ",121],["T_FUNCTION","function",121],["T_WHITESPACE"," ",121],["T_STRING","loadByIncrementId",121],"(",["T_VARIABLE","$incrementId",121],")",["T_WHITESPACE","\n    ",121],"{",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$ids",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getCollection",123],"(",")",["T_WHITESPACE","\n            ",123],["T_OBJECT_OPERATOR","->",124],["T_STRING","addAttributeToFilter",124],"(",["T_CONSTANT_ENCAPSED_STRING","'increment_id'",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$incrementId",124],")",["T_WHITESPACE","\n            ",124],["T_OBJECT_OPERATOR","->",125],["T_STRING","getAllIds",125],"(",")",";",["T_WHITESPACE","\n\n        ",125],["T_IF","if",127],["T_WHITESPACE"," ",127],"(","!",["T_EMPTY","empty",127],"(",["T_VARIABLE","$ids",127],")",")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n            ",127],["T_STRING","reset",128],"(",["T_VARIABLE","$ids",128],")",";",["T_WHITESPACE","\n            ",128],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","load",129],"(",["T_STRING","current",129],"(",["T_VARIABLE","$ids",129],")",")",";",["T_WHITESPACE","\n        ",129],"}",["T_WHITESPACE","\n        ",130],["T_RETURN","return",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],";",["T_WHITESPACE","\n    ",131],"}",["T_WHITESPACE","\n\n\n    ",132],["T_DOC_COMMENT","\/**\n     * Declare order for shipment\n     *\n     * @param   Mage_Sales_Model_Order $order\n     * @return  Mage_Sales_Model_Order_Shipment\n     *\/",135],["T_WHITESPACE","\n    ",140],["T_PUBLIC","public",141],["T_WHITESPACE"," ",141],["T_FUNCTION","function",141],["T_WHITESPACE"," ",141],["T_STRING","setOrder",141],"(",["T_STRING","Mage_Sales_Model_Order",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$order",141],")",["T_WHITESPACE","\n    ",141],"{",["T_WHITESPACE","\n        ",142],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","_order",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_VARIABLE","$order",143],";",["T_WHITESPACE","\n        ",143],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","setOrderId",144],"(",["T_VARIABLE","$order",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","getId",144],"(",")",")",["T_WHITESPACE","\n            ",144],["T_OBJECT_OPERATOR","->",145],["T_STRING","setStoreId",145],"(",["T_VARIABLE","$order",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getStoreId",145],"(",")",")",";",["T_WHITESPACE","\n        ",145],["T_RETURN","return",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$this",146],";",["T_WHITESPACE","\n    ",146],"}",["T_WHITESPACE","\n\n\n    ",147],["T_DOC_COMMENT","\/**\n     * Retrieve hash code of current order\n     *\n     * @return string\n     *\/",150],["T_WHITESPACE","\n    ",154],["T_PUBLIC","public",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","getProtectCode",155],"(",")",["T_WHITESPACE","\n    ",155],"{",["T_WHITESPACE","\n        ",156],["T_RETURN","return",157],["T_WHITESPACE"," ",157],["T_STRING_CAST","(string)",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","getOrder",157],"(",")",["T_OBJECT_OPERATOR","->",157],["T_STRING","getProtectCode",157],"(",")",";",["T_WHITESPACE","\n    ",157],"}",["T_WHITESPACE","\n\n    ",158],["T_DOC_COMMENT","\/**\n     * Retrieve the order the shipment for created for\n     *\n     * @return Mage_Sales_Model_Order\n     *\/",160],["T_WHITESPACE","\n    ",164],["T_PUBLIC","public",165],["T_WHITESPACE"," ",165],["T_FUNCTION","function",165],["T_WHITESPACE"," ",165],["T_STRING","getOrder",165],"(",")",["T_WHITESPACE","\n    ",165],"{",["T_WHITESPACE","\n        ",166],["T_IF","if",167],["T_WHITESPACE"," ",167],"(","!",["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","_order",167],["T_WHITESPACE"," ",167],["T_INSTANCEOF","instanceof",167],["T_WHITESPACE"," ",167],["T_STRING","Mage_Sales_Model_Order",167],")",["T_WHITESPACE"," ",167],"{",["T_WHITESPACE","\n            ",167],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","_order",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_STRING","Mage",168],["T_DOUBLE_COLON","::",168],["T_STRING","getModel",168],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order'",168],")",["T_OBJECT_OPERATOR","->",168],["T_STRING","load",168],"(",["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","getOrderId",168],"(",")",")",";",["T_WHITESPACE","\n        ",168],"}",["T_WHITESPACE","\n        ",169],["T_RETURN","return",170],["T_WHITESPACE"," ",170],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","_order",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","setHistoryEntityName",170],"(",["T_STRING","self",170],["T_DOUBLE_COLON","::",170],["T_STRING","HISTORY_ENTITY_NAME",170],")",";",["T_WHITESPACE","\n    ",170],"}",["T_WHITESPACE","\n\n    ",171],["T_DOC_COMMENT","\/**\n     * Retrieve billing address\n     *\n     * @return Mage_Sales_Model_Order_Address\n     *\/",173],["T_WHITESPACE","\n    ",177],["T_PUBLIC","public",178],["T_WHITESPACE"," ",178],["T_FUNCTION","function",178],["T_WHITESPACE"," ",178],["T_STRING","getBillingAddress",178],"(",")",["T_WHITESPACE","\n    ",178],"{",["T_WHITESPACE","\n        ",179],["T_RETURN","return",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","getOrder",180],"(",")",["T_OBJECT_OPERATOR","->",180],["T_STRING","getBillingAddress",180],"(",")",";",["T_WHITESPACE","\n    ",180],"}",["T_WHITESPACE","\n\n    ",181],["T_DOC_COMMENT","\/**\n     * Retrieve shipping address\n     *\n     * @return Mage_Sales_Model_Order_Address\n     *\/",183],["T_WHITESPACE","\n    ",187],["T_PUBLIC","public",188],["T_WHITESPACE"," ",188],["T_FUNCTION","function",188],["T_WHITESPACE"," ",188],["T_STRING","getShippingAddress",188],"(",")",["T_WHITESPACE","\n    ",188],"{",["T_WHITESPACE","\n        ",189],["T_RETURN","return",190],["T_WHITESPACE"," ",190],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","getOrder",190],"(",")",["T_OBJECT_OPERATOR","->",190],["T_STRING","getShippingAddress",190],"(",")",";",["T_WHITESPACE","\n    ",190],"}",["T_WHITESPACE","\n\n    ",191],["T_DOC_COMMENT","\/**\n     * Register shipment\n     *\n     * Apply to order, order items etc.\n     *\n     * @return unknown\n     *\/",193],["T_WHITESPACE","\n    ",199],["T_PUBLIC","public",200],["T_WHITESPACE"," ",200],["T_FUNCTION","function",200],["T_WHITESPACE"," ",200],["T_STRING","register",200],"(",")",["T_WHITESPACE","\n    ",200],"{",["T_WHITESPACE","\n        ",201],["T_IF","if",202],["T_WHITESPACE"," ",202],"(",["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","getId",202],"(",")",")",["T_WHITESPACE"," ",202],"{",["T_WHITESPACE","\n            ",202],["T_STRING","Mage",203],["T_DOUBLE_COLON","::",203],["T_STRING","throwException",203],"(",["T_WHITESPACE","\n                ",203],["T_STRING","Mage",204],["T_DOUBLE_COLON","::",204],["T_STRING","helper",204],"(",["T_CONSTANT_ENCAPSED_STRING","'sales'",204],")",["T_OBJECT_OPERATOR","->",204],["T_STRING","__",204],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot register existing shipment'",204],")",["T_WHITESPACE","\n            ",204],")",";",["T_WHITESPACE","\n        ",205],"}",["T_WHITESPACE","\n\n        ",206],["T_VARIABLE","$totalQty",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_LNUMBER","0",208],";",["T_WHITESPACE","\n        ",208],["T_FOREACH","foreach",209],["T_WHITESPACE"," ",209],"(",["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","getAllItems",209],"(",")",["T_WHITESPACE"," ",209],["T_AS","as",209],["T_WHITESPACE"," ",209],["T_VARIABLE","$item",209],")",["T_WHITESPACE"," ",209],"{",["T_WHITESPACE","\n            ",209],["T_IF","if",210],["T_WHITESPACE"," ",210],"(",["T_VARIABLE","$item",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","getQty",210],"(",")",">",["T_LNUMBER","0",210],")",["T_WHITESPACE"," ",210],"{",["T_WHITESPACE","\n                ",210],["T_VARIABLE","$item",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","register",211],"(",")",";",["T_WHITESPACE","\n                ",211],["T_IF","if",212],["T_WHITESPACE"," ",212],"(","!",["T_VARIABLE","$item",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","getOrderItem",212],"(",")",["T_OBJECT_OPERATOR","->",212],["T_STRING","isDummy",212],"(",["T_STRING","true",212],")",")",["T_WHITESPACE"," ",212],"{",["T_WHITESPACE","\n                    ",212],["T_VARIABLE","$totalQty",213],["T_PLUS_EQUAL","+=",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$item",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","getQty",213],"(",")",";",["T_WHITESPACE","\n                ",213],"}",["T_WHITESPACE","\n            ",214],"}",["T_WHITESPACE","\n            ",215],["T_ELSE","else",216],["T_WHITESPACE"," ",216],"{",["T_WHITESPACE","\n                ",216],["T_VARIABLE","$item",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","isDeleted",217],"(",["T_STRING","true",217],")",";",["T_WHITESPACE","\n            ",217],"}",["T_WHITESPACE","\n        ",218],"}",["T_WHITESPACE","\n        ",219],["T_VARIABLE","$this",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","setTotalQty",220],"(",["T_VARIABLE","$totalQty",220],")",";",["T_WHITESPACE","\n\n        ",220],["T_RETURN","return",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],";",["T_WHITESPACE","\n    ",222],"}",["T_WHITESPACE","\n\n    ",223],["T_PUBLIC","public",225],["T_WHITESPACE"," ",225],["T_FUNCTION","function",225],["T_WHITESPACE"," ",225],["T_STRING","getItemsCollection",225],"(",")",["T_WHITESPACE","\n    ",225],"{",["T_WHITESPACE","\n        ",226],["T_IF","if",227],["T_WHITESPACE"," ",227],"(",["T_EMPTY","empty",227],"(",["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","_items",227],")",")",["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n            ",227],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","_items",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],["T_STRING","Mage",228],["T_DOUBLE_COLON","::",228],["T_STRING","getResourceModel",228],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order_shipment_item_collection'",228],")",["T_WHITESPACE","\n                ",228],["T_OBJECT_OPERATOR","->",229],["T_STRING","setShipmentFilter",229],"(",["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","getId",229],"(",")",")",";",["T_WHITESPACE","\n\n            ",229],["T_IF","if",231],["T_WHITESPACE"," ",231],"(",["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","getId",231],"(",")",")",["T_WHITESPACE"," ",231],"{",["T_WHITESPACE","\n                ",231],["T_FOREACH","foreach",232],["T_WHITESPACE"," ",232],"(",["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","_items",232],["T_WHITESPACE"," ",232],["T_AS","as",232],["T_WHITESPACE"," ",232],["T_VARIABLE","$item",232],")",["T_WHITESPACE"," ",232],"{",["T_WHITESPACE","\n                    ",232],["T_VARIABLE","$item",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","setShipment",233],"(",["T_VARIABLE","$this",233],")",";",["T_WHITESPACE","\n                ",233],"}",["T_WHITESPACE","\n            ",234],"}",["T_WHITESPACE","\n        ",235],"}",["T_WHITESPACE","\n        ",236],["T_RETURN","return",237],["T_WHITESPACE"," ",237],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","_items",237],";",["T_WHITESPACE","\n    ",237],"}",["T_WHITESPACE","\n\n    ",238],["T_PUBLIC","public",240],["T_WHITESPACE"," ",240],["T_FUNCTION","function",240],["T_WHITESPACE"," ",240],["T_STRING","getAllItems",240],"(",")",["T_WHITESPACE","\n    ",240],"{",["T_WHITESPACE","\n        ",241],["T_VARIABLE","$items",242],["T_WHITESPACE"," ",242],"=",["T_WHITESPACE"," ",242],["T_ARRAY","array",242],"(",")",";",["T_WHITESPACE","\n        ",242],["T_FOREACH","foreach",243],["T_WHITESPACE"," ",243],"(",["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","getItemsCollection",243],"(",")",["T_WHITESPACE"," ",243],["T_AS","as",243],["T_WHITESPACE"," ",243],["T_VARIABLE","$item",243],")",["T_WHITESPACE"," ",243],"{",["T_WHITESPACE","\n            ",243],["T_IF","if",244],["T_WHITESPACE"," ",244],"(","!",["T_VARIABLE","$item",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","isDeleted",244],"(",")",")",["T_WHITESPACE"," ",244],"{",["T_WHITESPACE","\n                ",244],["T_VARIABLE","$items",245],"[","]",["T_WHITESPACE"," ",245],"=",["T_WHITESPACE","  ",245],["T_VARIABLE","$item",245],";",["T_WHITESPACE","\n            ",245],"}",["T_WHITESPACE","\n        ",246],"}",["T_WHITESPACE","\n        ",247],["T_RETURN","return",248],["T_WHITESPACE"," ",248],["T_VARIABLE","$items",248],";",["T_WHITESPACE","\n    ",248],"}",["T_WHITESPACE","\n\n    ",249],["T_PUBLIC","public",251],["T_WHITESPACE"," ",251],["T_FUNCTION","function",251],["T_WHITESPACE"," ",251],["T_STRING","getItemById",251],"(",["T_VARIABLE","$itemId",251],")",["T_WHITESPACE","\n    ",251],"{",["T_WHITESPACE","\n        ",252],["T_FOREACH","foreach",253],["T_WHITESPACE"," ",253],"(",["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","getItemsCollection",253],"(",")",["T_WHITESPACE"," ",253],["T_AS","as",253],["T_WHITESPACE"," ",253],["T_VARIABLE","$item",253],")",["T_WHITESPACE"," ",253],"{",["T_WHITESPACE","\n            ",253],["T_IF","if",254],["T_WHITESPACE"," ",254],"(",["T_VARIABLE","$item",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","getId",254],"(",")",["T_IS_EQUAL","==",254],["T_VARIABLE","$itemId",254],")",["T_WHITESPACE"," ",254],"{",["T_WHITESPACE","\n                ",254],["T_RETURN","return",255],["T_WHITESPACE"," ",255],["T_VARIABLE","$item",255],";",["T_WHITESPACE","\n            ",255],"}",["T_WHITESPACE","\n        ",256],"}",["T_WHITESPACE","\n        ",257],["T_RETURN","return",258],["T_WHITESPACE"," ",258],["T_STRING","false",258],";",["T_WHITESPACE","\n    ",258],"}",["T_WHITESPACE","\n\n    ",259],["T_PUBLIC","public",261],["T_WHITESPACE"," ",261],["T_FUNCTION","function",261],["T_WHITESPACE"," ",261],["T_STRING","addItem",261],"(",["T_STRING","Mage_Sales_Model_Order_Shipment_Item",261],["T_WHITESPACE"," ",261],["T_VARIABLE","$item",261],")",["T_WHITESPACE","\n    ",261],"{",["T_WHITESPACE","\n        ",262],["T_VARIABLE","$item",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","setShipment",263],"(",["T_VARIABLE","$this",263],")",["T_WHITESPACE","\n            ",263],["T_OBJECT_OPERATOR","->",264],["T_STRING","setParentId",264],"(",["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","getId",264],"(",")",")",["T_WHITESPACE","\n            ",264],["T_OBJECT_OPERATOR","->",265],["T_STRING","setStoreId",265],"(",["T_VARIABLE","$this",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","getStoreId",265],"(",")",")",";",["T_WHITESPACE","\n        ",265],["T_IF","if",266],["T_WHITESPACE"," ",266],"(","!",["T_VARIABLE","$item",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","getId",266],"(",")",")",["T_WHITESPACE"," ",266],"{",["T_WHITESPACE","\n            ",266],["T_VARIABLE","$this",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","getItemsCollection",267],"(",")",["T_OBJECT_OPERATOR","->",267],["T_STRING","addItem",267],"(",["T_VARIABLE","$item",267],")",";",["T_WHITESPACE","\n        ",267],"}",["T_WHITESPACE","\n        ",268],["T_RETURN","return",269],["T_WHITESPACE"," ",269],["T_VARIABLE","$this",269],";",["T_WHITESPACE","\n    ",269],"}",["T_WHITESPACE","\n\n\n    ",270],["T_PUBLIC","public",273],["T_WHITESPACE"," ",273],["T_FUNCTION","function",273],["T_WHITESPACE"," ",273],["T_STRING","getTracksCollection",273],"(",")",["T_WHITESPACE","\n    ",273],"{",["T_WHITESPACE","\n        ",274],["T_IF","if",275],["T_WHITESPACE"," ",275],"(",["T_EMPTY","empty",275],"(",["T_VARIABLE","$this",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","_tracks",275],")",")",["T_WHITESPACE"," ",275],"{",["T_WHITESPACE","\n            ",275],["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","_tracks",276],["T_WHITESPACE"," ",276],"=",["T_WHITESPACE"," ",276],["T_STRING","Mage",276],["T_DOUBLE_COLON","::",276],["T_STRING","getResourceModel",276],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order_shipment_track_collection'",276],")",["T_WHITESPACE","\n                ",276],["T_OBJECT_OPERATOR","->",277],["T_STRING","setShipmentFilter",277],"(",["T_VARIABLE","$this",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","getId",277],"(",")",")",";",["T_WHITESPACE","\n\n            ",277],["T_IF","if",279],["T_WHITESPACE"," ",279],"(",["T_VARIABLE","$this",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","getId",279],"(",")",")",["T_WHITESPACE"," ",279],"{",["T_WHITESPACE","\n                ",279],["T_FOREACH","foreach",280],["T_WHITESPACE"," ",280],"(",["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","_tracks",280],["T_WHITESPACE"," ",280],["T_AS","as",280],["T_WHITESPACE"," ",280],["T_VARIABLE","$track",280],")",["T_WHITESPACE"," ",280],"{",["T_WHITESPACE","\n                    ",280],["T_VARIABLE","$track",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","setShipment",281],"(",["T_VARIABLE","$this",281],")",";",["T_WHITESPACE","\n                ",281],"}",["T_WHITESPACE","\n            ",282],"}",["T_WHITESPACE","\n        ",283],"}",["T_WHITESPACE","\n        ",284],["T_RETURN","return",285],["T_WHITESPACE"," ",285],["T_VARIABLE","$this",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","_tracks",285],";",["T_WHITESPACE","\n    ",285],"}",["T_WHITESPACE","\n\n    ",286],["T_PUBLIC","public",288],["T_WHITESPACE"," ",288],["T_FUNCTION","function",288],["T_WHITESPACE"," ",288],["T_STRING","getAllTracks",288],"(",")",["T_WHITESPACE","\n    ",288],"{",["T_WHITESPACE","\n        ",289],["T_VARIABLE","$tracks",290],["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],["T_ARRAY","array",290],"(",")",";",["T_WHITESPACE","\n        ",290],["T_FOREACH","foreach",291],["T_WHITESPACE"," ",291],"(",["T_VARIABLE","$this",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","getTracksCollection",291],"(",")",["T_WHITESPACE"," ",291],["T_AS","as",291],["T_WHITESPACE"," ",291],["T_VARIABLE","$track",291],")",["T_WHITESPACE"," ",291],"{",["T_WHITESPACE","\n            ",291],["T_IF","if",292],["T_WHITESPACE"," ",292],"(","!",["T_VARIABLE","$track",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","isDeleted",292],"(",")",")",["T_WHITESPACE"," ",292],"{",["T_WHITESPACE","\n                ",292],["T_VARIABLE","$tracks",293],"[","]",["T_WHITESPACE"," ",293],"=",["T_WHITESPACE","  ",293],["T_VARIABLE","$track",293],";",["T_WHITESPACE","\n            ",293],"}",["T_WHITESPACE","\n        ",294],"}",["T_WHITESPACE","\n        ",295],["T_RETURN","return",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$tracks",296],";",["T_WHITESPACE","\n    ",296],"}",["T_WHITESPACE","\n\n    ",297],["T_PUBLIC","public",299],["T_WHITESPACE"," ",299],["T_FUNCTION","function",299],["T_WHITESPACE"," ",299],["T_STRING","getTrackById",299],"(",["T_VARIABLE","$trackId",299],")",["T_WHITESPACE","\n    ",299],"{",["T_WHITESPACE","\n        ",300],["T_FOREACH","foreach",301],["T_WHITESPACE"," ",301],"(",["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","getTracksCollection",301],"(",")",["T_WHITESPACE"," ",301],["T_AS","as",301],["T_WHITESPACE"," ",301],["T_VARIABLE","$track",301],")",["T_WHITESPACE"," ",301],"{",["T_WHITESPACE","\n            ",301],["T_IF","if",302],["T_WHITESPACE"," ",302],"(",["T_VARIABLE","$track",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","getId",302],"(",")",["T_IS_EQUAL","==",302],["T_VARIABLE","$trackId",302],")",["T_WHITESPACE"," ",302],"{",["T_WHITESPACE","\n                ",302],["T_RETURN","return",303],["T_WHITESPACE"," ",303],["T_VARIABLE","$track",303],";",["T_WHITESPACE","\n            ",303],"}",["T_WHITESPACE","\n        ",304],"}",["T_WHITESPACE","\n        ",305],["T_RETURN","return",306],["T_WHITESPACE"," ",306],["T_STRING","false",306],";",["T_WHITESPACE","\n    ",306],"}",["T_WHITESPACE","\n\n    ",307],["T_PUBLIC","public",309],["T_WHITESPACE"," ",309],["T_FUNCTION","function",309],["T_WHITESPACE"," ",309],["T_STRING","addTrack",309],"(",["T_STRING","Mage_Sales_Model_Order_Shipment_Track",309],["T_WHITESPACE"," ",309],["T_VARIABLE","$track",309],")",["T_WHITESPACE","\n    ",309],"{",["T_WHITESPACE","\n        ",310],["T_VARIABLE","$track",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","setShipment",311],"(",["T_VARIABLE","$this",311],")",["T_WHITESPACE","\n            ",311],["T_OBJECT_OPERATOR","->",312],["T_STRING","setParentId",312],"(",["T_VARIABLE","$this",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","getId",312],"(",")",")",["T_WHITESPACE","\n            ",312],["T_OBJECT_OPERATOR","->",313],["T_STRING","setOrderId",313],"(",["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","getOrderId",313],"(",")",")",["T_WHITESPACE","\n            ",313],["T_OBJECT_OPERATOR","->",314],["T_STRING","setStoreId",314],"(",["T_VARIABLE","$this",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","getStoreId",314],"(",")",")",";",["T_WHITESPACE","\n        ",314],["T_IF","if",315],["T_WHITESPACE"," ",315],"(","!",["T_VARIABLE","$track",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","getId",315],"(",")",")",["T_WHITESPACE"," ",315],"{",["T_WHITESPACE","\n            ",315],["T_VARIABLE","$this",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","getTracksCollection",316],"(",")",["T_OBJECT_OPERATOR","->",316],["T_STRING","addItem",316],"(",["T_VARIABLE","$track",316],")",";",["T_WHITESPACE","\n        ",316],"}",["T_WHITESPACE","\n\n        ",317],["T_DOC_COMMENT","\/**\n         * Track saving is implemented in _afterSave()\n         * This enforces Mage_Core_Model_Abstract::save() not to skip _afterSave()\n         *\/",319],["T_WHITESPACE","\n        ",322],["T_VARIABLE","$this",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","_hasDataChanges",323],["T_WHITESPACE"," ",323],"=",["T_WHITESPACE"," ",323],["T_STRING","true",323],";",["T_WHITESPACE","\n\n        ",323],["T_RETURN","return",325],["T_WHITESPACE"," ",325],["T_VARIABLE","$this",325],";",["T_WHITESPACE","\n    ",325],"}",["T_WHITESPACE","\n\n    ",326],["T_DOC_COMMENT","\/**\n     * Adds comment to shipment with additional possibility to send it to customer via email\n     * and show it in customer account\n     *\n     * @param bool $notify\n     * @param bool $visibleOnFront\n     *\n     * @return Mage_Sales_Model_Order_Shipment\n     *\/",328],["T_WHITESPACE","\n    ",336],["T_PUBLIC","public",337],["T_WHITESPACE"," ",337],["T_FUNCTION","function",337],["T_WHITESPACE"," ",337],["T_STRING","addComment",337],"(",["T_VARIABLE","$comment",337],",",["T_WHITESPACE"," ",337],["T_VARIABLE","$notify",337],"=",["T_STRING","false",337],",",["T_WHITESPACE"," ",337],["T_VARIABLE","$visibleOnFront",337],"=",["T_STRING","false",337],")",["T_WHITESPACE","\n    ",337],"{",["T_WHITESPACE","\n        ",338],["T_IF","if",339],["T_WHITESPACE"," ",339],"(","!","(",["T_VARIABLE","$comment",339],["T_WHITESPACE"," ",339],["T_INSTANCEOF","instanceof",339],["T_WHITESPACE"," ",339],["T_STRING","Mage_Sales_Model_Order_Shipment_Comment",339],")",")",["T_WHITESPACE"," ",339],"{",["T_WHITESPACE","\n            ",339],["T_VARIABLE","$comment",340],["T_WHITESPACE"," ",340],"=",["T_WHITESPACE"," ",340],["T_STRING","Mage",340],["T_DOUBLE_COLON","::",340],["T_STRING","getModel",340],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order_shipment_comment'",340],")",["T_WHITESPACE","\n                ",340],["T_OBJECT_OPERATOR","->",341],["T_STRING","setComment",341],"(",["T_VARIABLE","$comment",341],")",["T_WHITESPACE","\n                ",341],["T_OBJECT_OPERATOR","->",342],["T_STRING","setIsCustomerNotified",342],"(",["T_VARIABLE","$notify",342],")",["T_WHITESPACE","\n                ",342],["T_OBJECT_OPERATOR","->",343],["T_STRING","setIsVisibleOnFront",343],"(",["T_VARIABLE","$visibleOnFront",343],")",";",["T_WHITESPACE","\n        ",343],"}",["T_WHITESPACE","\n        ",344],["T_VARIABLE","$comment",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","setShipment",345],"(",["T_VARIABLE","$this",345],")",["T_WHITESPACE","\n            ",345],["T_OBJECT_OPERATOR","->",346],["T_STRING","setParentId",346],"(",["T_VARIABLE","$this",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","getId",346],"(",")",")",["T_WHITESPACE","\n            ",346],["T_OBJECT_OPERATOR","->",347],["T_STRING","setStoreId",347],"(",["T_VARIABLE","$this",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","getStoreId",347],"(",")",")",";",["T_WHITESPACE","\n        ",347],["T_IF","if",348],["T_WHITESPACE"," ",348],"(","!",["T_VARIABLE","$comment",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","getId",348],"(",")",")",["T_WHITESPACE"," ",348],"{",["T_WHITESPACE","\n            ",348],["T_VARIABLE","$this",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","getCommentsCollection",349],"(",")",["T_OBJECT_OPERATOR","->",349],["T_STRING","addItem",349],"(",["T_VARIABLE","$comment",349],")",";",["T_WHITESPACE","\n        ",349],"}",["T_WHITESPACE","\n        ",350],["T_VARIABLE","$this",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","_hasDataChanges",351],["T_WHITESPACE"," ",351],"=",["T_WHITESPACE"," ",351],["T_STRING","true",351],";",["T_WHITESPACE","\n        ",351],["T_RETURN","return",352],["T_WHITESPACE"," ",352],["T_VARIABLE","$this",352],";",["T_WHITESPACE","\n    ",352],"}",["T_WHITESPACE","\n\n    ",353],["T_PUBLIC","public",355],["T_WHITESPACE"," ",355],["T_FUNCTION","function",355],["T_WHITESPACE"," ",355],["T_STRING","getCommentsCollection",355],"(",["T_VARIABLE","$reload",355],"=",["T_STRING","false",355],")",["T_WHITESPACE","\n    ",355],"{",["T_WHITESPACE","\n        ",356],["T_IF","if",357],["T_WHITESPACE"," ",357],"(",["T_STRING","is_null",357],"(",["T_VARIABLE","$this",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","_comments",357],")",["T_WHITESPACE"," ",357],["T_BOOLEAN_OR","||",357],["T_WHITESPACE"," ",357],["T_VARIABLE","$reload",357],")",["T_WHITESPACE"," ",357],"{",["T_WHITESPACE","\n            ",357],["T_VARIABLE","$this",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","_comments",358],["T_WHITESPACE"," ",358],"=",["T_WHITESPACE"," ",358],["T_STRING","Mage",358],["T_DOUBLE_COLON","::",358],["T_STRING","getResourceModel",358],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order_shipment_comment_collection'",358],")",["T_WHITESPACE","\n                ",358],["T_OBJECT_OPERATOR","->",359],["T_STRING","setShipmentFilter",359],"(",["T_VARIABLE","$this",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","getId",359],"(",")",")",["T_WHITESPACE","\n                ",359],["T_OBJECT_OPERATOR","->",360],["T_STRING","setCreatedAtOrder",360],"(",")",";",["T_WHITESPACE","\n\n            ",360],["T_DOC_COMMENT","\/**\n             * When shipment created with adding comment,\n             * comments collection must be loaded before we added this comment.\n             *\/",362],["T_WHITESPACE","\n            ",365],["T_VARIABLE","$this",366],["T_OBJECT_OPERATOR","->",366],["T_STRING","_comments",366],["T_OBJECT_OPERATOR","->",366],["T_STRING","load",366],"(",")",";",["T_WHITESPACE","\n\n            ",366],["T_IF","if",368],["T_WHITESPACE"," ",368],"(",["T_VARIABLE","$this",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","getId",368],"(",")",")",["T_WHITESPACE"," ",368],"{",["T_WHITESPACE","\n                ",368],["T_FOREACH","foreach",369],["T_WHITESPACE"," ",369],"(",["T_VARIABLE","$this",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","_comments",369],["T_WHITESPACE"," ",369],["T_AS","as",369],["T_WHITESPACE"," ",369],["T_VARIABLE","$comment",369],")",["T_WHITESPACE"," ",369],"{",["T_WHITESPACE","\n                    ",369],["T_VARIABLE","$comment",370],["T_OBJECT_OPERATOR","->",370],["T_STRING","setShipment",370],"(",["T_VARIABLE","$this",370],")",";",["T_WHITESPACE","\n                ",370],"}",["T_WHITESPACE","\n            ",371],"}",["T_WHITESPACE","\n        ",372],"}",["T_WHITESPACE","\n        ",373],["T_RETURN","return",374],["T_WHITESPACE"," ",374],["T_VARIABLE","$this",374],["T_OBJECT_OPERATOR","->",374],["T_STRING","_comments",374],";",["T_WHITESPACE","\n    ",374],"}",["T_WHITESPACE","\n\n    ",375],["T_DOC_COMMENT","\/**\n     * Send email with shipment data\n     *\n     * @param boolean $notifyCustomer\n     * @param string $comment\n     * @return Mage_Sales_Model_Order_Shipment\n     *\/",377],["T_WHITESPACE","\n    ",383],["T_PUBLIC","public",384],["T_WHITESPACE"," ",384],["T_FUNCTION","function",384],["T_WHITESPACE"," ",384],["T_STRING","sendEmail",384],"(",["T_VARIABLE","$notifyCustomer",384],["T_WHITESPACE"," ",384],"=",["T_WHITESPACE"," ",384],["T_STRING","true",384],",",["T_WHITESPACE"," ",384],["T_VARIABLE","$comment",384],["T_WHITESPACE"," ",384],"=",["T_WHITESPACE"," ",384],["T_CONSTANT_ENCAPSED_STRING","''",384],")",["T_WHITESPACE","\n    ",384],"{",["T_WHITESPACE","\n        ",385],["T_VARIABLE","$order",386],["T_WHITESPACE"," ",386],"=",["T_WHITESPACE"," ",386],["T_VARIABLE","$this",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","getOrder",386],"(",")",";",["T_WHITESPACE","\n        ",386],["T_VARIABLE","$storeId",387],["T_WHITESPACE"," ",387],"=",["T_WHITESPACE"," ",387],["T_VARIABLE","$order",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","getStore",387],"(",")",["T_OBJECT_OPERATOR","->",387],["T_STRING","getId",387],"(",")",";",["T_WHITESPACE","\n\n        ",387],["T_IF","if",389],["T_WHITESPACE"," ",389],"(","!",["T_STRING","Mage",389],["T_DOUBLE_COLON","::",389],["T_STRING","helper",389],"(",["T_CONSTANT_ENCAPSED_STRING","'sales'",389],")",["T_OBJECT_OPERATOR","->",389],["T_STRING","canSendNewShipmentEmail",389],"(",["T_VARIABLE","$storeId",389],")",")",["T_WHITESPACE"," ",389],"{",["T_WHITESPACE","\n            ",389],["T_RETURN","return",390],["T_WHITESPACE"," ",390],["T_VARIABLE","$this",390],";",["T_WHITESPACE","\n        ",390],"}",["T_WHITESPACE","\n        ",391],["T_COMMENT","\/\/ Get the destination email addresses to send copies to\n",392],["T_WHITESPACE","        ",393],["T_VARIABLE","$copyTo",393],["T_WHITESPACE"," ",393],"=",["T_WHITESPACE"," ",393],["T_VARIABLE","$this",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","_getEmails",393],"(",["T_STRING","self",393],["T_DOUBLE_COLON","::",393],["T_STRING","XML_PATH_EMAIL_COPY_TO",393],")",";",["T_WHITESPACE","\n        ",393],["T_VARIABLE","$copyMethod",394],["T_WHITESPACE"," ",394],"=",["T_WHITESPACE"," ",394],["T_STRING","Mage",394],["T_DOUBLE_COLON","::",394],["T_STRING","getStoreConfig",394],"(",["T_STRING","self",394],["T_DOUBLE_COLON","::",394],["T_STRING","XML_PATH_EMAIL_COPY_METHOD",394],",",["T_WHITESPACE"," ",394],["T_VARIABLE","$storeId",394],")",";",["T_WHITESPACE","\n        ",394],["T_COMMENT","\/\/ Check if at least one recepient is found\n",395],["T_WHITESPACE","        ",396],["T_IF","if",396],["T_WHITESPACE"," ",396],"(","!",["T_VARIABLE","$notifyCustomer",396],["T_WHITESPACE"," ",396],["T_BOOLEAN_AND","&&",396],["T_WHITESPACE"," ",396],"!",["T_VARIABLE","$copyTo",396],")",["T_WHITESPACE"," ",396],"{",["T_WHITESPACE","\n            ",396],["T_RETURN","return",397],["T_WHITESPACE"," ",397],["T_VARIABLE","$this",397],";",["T_WHITESPACE","\n        ",397],"}",["T_WHITESPACE","\n\n        ",398],["T_COMMENT","\/\/ Start store emulation process\n",400],["T_WHITESPACE","        ",401],["T_VARIABLE","$appEmulation",401],["T_WHITESPACE"," ",401],"=",["T_WHITESPACE"," ",401],["T_STRING","Mage",401],["T_DOUBLE_COLON","::",401],["T_STRING","getSingleton",401],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/app_emulation'",401],")",";",["T_WHITESPACE","\n        ",401],["T_VARIABLE","$initialEnvironmentInfo",402],["T_WHITESPACE"," ",402],"=",["T_WHITESPACE"," ",402],["T_VARIABLE","$appEmulation",402],["T_OBJECT_OPERATOR","->",402],["T_STRING","startEnvironmentEmulation",402],"(",["T_VARIABLE","$storeId",402],")",";",["T_WHITESPACE","\n\n        ",402],["T_TRY","try",404],["T_WHITESPACE"," ",404],"{",["T_WHITESPACE","\n            ",404],["T_COMMENT","\/\/ Retrieve specified view block from appropriate design package (depends on emulated store)\n",405],["T_WHITESPACE","            ",406],["T_VARIABLE","$paymentBlock",406],["T_WHITESPACE"," ",406],"=",["T_WHITESPACE"," ",406],["T_STRING","Mage",406],["T_DOUBLE_COLON","::",406],["T_STRING","helper",406],"(",["T_CONSTANT_ENCAPSED_STRING","'payment'",406],")",["T_OBJECT_OPERATOR","->",406],["T_STRING","getInfoBlock",406],"(",["T_VARIABLE","$order",406],["T_OBJECT_OPERATOR","->",406],["T_STRING","getPayment",406],"(",")",")",["T_WHITESPACE","\n                ",406],["T_OBJECT_OPERATOR","->",407],["T_STRING","setIsSecureMode",407],"(",["T_STRING","true",407],")",";",["T_WHITESPACE","\n            ",407],["T_VARIABLE","$paymentBlock",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","getMethod",408],"(",")",["T_OBJECT_OPERATOR","->",408],["T_STRING","setStore",408],"(",["T_VARIABLE","$storeId",408],")",";",["T_WHITESPACE","\n            ",408],["T_VARIABLE","$paymentBlockHtml",409],["T_WHITESPACE"," ",409],"=",["T_WHITESPACE"," ",409],["T_VARIABLE","$paymentBlock",409],["T_OBJECT_OPERATOR","->",409],["T_STRING","toHtml",409],"(",")",";",["T_WHITESPACE","\n        ",409],"}",["T_WHITESPACE"," ",410],["T_CATCH","catch",410],["T_WHITESPACE"," ",410],"(",["T_STRING","Exception",410],["T_WHITESPACE"," ",410],["T_VARIABLE","$exception",410],")",["T_WHITESPACE"," ",410],"{",["T_WHITESPACE","\n            ",410],["T_COMMENT","\/\/ Stop store emulation process\n",411],["T_WHITESPACE","            ",412],["T_VARIABLE","$appEmulation",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","stopEnvironmentEmulation",412],"(",["T_VARIABLE","$initialEnvironmentInfo",412],")",";",["T_WHITESPACE","\n            ",412],["T_THROW","throw",413],["T_WHITESPACE"," ",413],["T_VARIABLE","$exception",413],";",["T_WHITESPACE","\n        ",413],"}",["T_WHITESPACE","\n\n        ",414],["T_COMMENT","\/\/ Stop store emulation process\n",416],["T_WHITESPACE","        ",417],["T_VARIABLE","$appEmulation",417],["T_OBJECT_OPERATOR","->",417],["T_STRING","stopEnvironmentEmulation",417],"(",["T_VARIABLE","$initialEnvironmentInfo",417],")",";",["T_WHITESPACE","\n\n        ",417],["T_COMMENT","\/\/ Retrieve corresponding email template id and customer name\n",419],["T_WHITESPACE","        ",420],["T_IF","if",420],["T_WHITESPACE"," ",420],"(",["T_VARIABLE","$order",420],["T_OBJECT_OPERATOR","->",420],["T_STRING","getCustomerIsGuest",420],"(",")",")",["T_WHITESPACE"," ",420],"{",["T_WHITESPACE","\n            ",420],["T_VARIABLE","$templateId",421],["T_WHITESPACE"," ",421],"=",["T_WHITESPACE"," ",421],["T_STRING","Mage",421],["T_DOUBLE_COLON","::",421],["T_STRING","getStoreConfig",421],"(",["T_STRING","self",421],["T_DOUBLE_COLON","::",421],["T_STRING","XML_PATH_EMAIL_GUEST_TEMPLATE",421],",",["T_WHITESPACE"," ",421],["T_VARIABLE","$storeId",421],")",";",["T_WHITESPACE","\n            ",421],["T_VARIABLE","$customerName",422],["T_WHITESPACE"," ",422],"=",["T_WHITESPACE"," ",422],["T_VARIABLE","$order",422],["T_OBJECT_OPERATOR","->",422],["T_STRING","getBillingAddress",422],"(",")",["T_OBJECT_OPERATOR","->",422],["T_STRING","getName",422],"(",")",";",["T_WHITESPACE","\n        ",422],"}",["T_WHITESPACE"," ",423],["T_ELSE","else",423],["T_WHITESPACE"," ",423],"{",["T_WHITESPACE","\n            ",423],["T_VARIABLE","$templateId",424],["T_WHITESPACE"," ",424],"=",["T_WHITESPACE"," ",424],["T_STRING","Mage",424],["T_DOUBLE_COLON","::",424],["T_STRING","getStoreConfig",424],"(",["T_STRING","self",424],["T_DOUBLE_COLON","::",424],["T_STRING","XML_PATH_EMAIL_TEMPLATE",424],",",["T_WHITESPACE"," ",424],["T_VARIABLE","$storeId",424],")",";",["T_WHITESPACE","\n            ",424],["T_VARIABLE","$customerName",425],["T_WHITESPACE"," ",425],"=",["T_WHITESPACE"," ",425],["T_VARIABLE","$order",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","getCustomerName",425],"(",")",";",["T_WHITESPACE","\n        ",425],"}",["T_WHITESPACE","\n\n        ",426],["T_VARIABLE","$mailer",428],["T_WHITESPACE"," ",428],"=",["T_WHITESPACE"," ",428],["T_STRING","Mage",428],["T_DOUBLE_COLON","::",428],["T_STRING","getModel",428],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/email_template_mailer'",428],")",";",["T_WHITESPACE","\n        ",428],["T_IF","if",429],["T_WHITESPACE"," ",429],"(",["T_VARIABLE","$notifyCustomer",429],")",["T_WHITESPACE"," ",429],"{",["T_WHITESPACE","\n            ",429],["T_VARIABLE","$emailInfo",430],["T_WHITESPACE"," ",430],"=",["T_WHITESPACE"," ",430],["T_STRING","Mage",430],["T_DOUBLE_COLON","::",430],["T_STRING","getModel",430],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/email_info'",430],")",";",["T_WHITESPACE","\n            ",430],["T_VARIABLE","$emailInfo",431],["T_OBJECT_OPERATOR","->",431],["T_STRING","addTo",431],"(",["T_VARIABLE","$order",431],["T_OBJECT_OPERATOR","->",431],["T_STRING","getCustomerEmail",431],"(",")",",",["T_WHITESPACE"," ",431],["T_VARIABLE","$customerName",431],")",";",["T_WHITESPACE","\n            ",431],["T_IF","if",432],["T_WHITESPACE"," ",432],"(",["T_VARIABLE","$copyTo",432],["T_WHITESPACE"," ",432],["T_BOOLEAN_AND","&&",432],["T_WHITESPACE"," ",432],["T_VARIABLE","$copyMethod",432],["T_WHITESPACE"," ",432],["T_IS_EQUAL","==",432],["T_WHITESPACE"," ",432],["T_CONSTANT_ENCAPSED_STRING","'bcc'",432],")",["T_WHITESPACE"," ",432],"{",["T_WHITESPACE","\n                ",432],["T_COMMENT","\/\/ Add bcc to customer email\n",433],["T_WHITESPACE","                ",434],["T_FOREACH","foreach",434],["T_WHITESPACE"," ",434],"(",["T_VARIABLE","$copyTo",434],["T_WHITESPACE"," ",434],["T_AS","as",434],["T_WHITESPACE"," ",434],["T_VARIABLE","$email",434],")",["T_WHITESPACE"," ",434],"{",["T_WHITESPACE","\n                    ",434],["T_VARIABLE","$emailInfo",435],["T_OBJECT_OPERATOR","->",435],["T_STRING","addBcc",435],"(",["T_VARIABLE","$email",435],")",";",["T_WHITESPACE","\n                ",435],"}",["T_WHITESPACE","\n            ",436],"}",["T_WHITESPACE","\n            ",437],["T_VARIABLE","$mailer",438],["T_OBJECT_OPERATOR","->",438],["T_STRING","addEmailInfo",438],"(",["T_VARIABLE","$emailInfo",438],")",";",["T_WHITESPACE","\n        ",438],"}",["T_WHITESPACE","\n\n        ",439],["T_COMMENT","\/\/ Email copies are sent as separated emails if their copy method is 'copy' or a customer should not be notified\n",441],["T_WHITESPACE","        ",442],["T_IF","if",442],["T_WHITESPACE"," ",442],"(",["T_VARIABLE","$copyTo",442],["T_WHITESPACE"," ",442],["T_BOOLEAN_AND","&&",442],["T_WHITESPACE"," ",442],"(",["T_VARIABLE","$copyMethod",442],["T_WHITESPACE"," ",442],["T_IS_EQUAL","==",442],["T_WHITESPACE"," ",442],["T_CONSTANT_ENCAPSED_STRING","'copy'",442],["T_WHITESPACE"," ",442],["T_BOOLEAN_OR","||",442],["T_WHITESPACE"," ",442],"!",["T_VARIABLE","$notifyCustomer",442],")",")",["T_WHITESPACE"," ",442],"{",["T_WHITESPACE","\n            ",442],["T_FOREACH","foreach",443],["T_WHITESPACE"," ",443],"(",["T_VARIABLE","$copyTo",443],["T_WHITESPACE"," ",443],["T_AS","as",443],["T_WHITESPACE"," ",443],["T_VARIABLE","$email",443],")",["T_WHITESPACE"," ",443],"{",["T_WHITESPACE","\n                ",443],["T_VARIABLE","$emailInfo",444],["T_WHITESPACE"," ",444],"=",["T_WHITESPACE"," ",444],["T_STRING","Mage",444],["T_DOUBLE_COLON","::",444],["T_STRING","getModel",444],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/email_info'",444],")",";",["T_WHITESPACE","\n                ",444],["T_VARIABLE","$emailInfo",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","addTo",445],"(",["T_VARIABLE","$email",445],")",";",["T_WHITESPACE","\n                ",445],["T_VARIABLE","$mailer",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","addEmailInfo",446],"(",["T_VARIABLE","$emailInfo",446],")",";",["T_WHITESPACE","\n            ",446],"}",["T_WHITESPACE","\n        ",447],"}",["T_WHITESPACE","\n\n        ",448],["T_COMMENT","\/\/ Set all required params and send emails\n",450],["T_WHITESPACE","        ",451],["T_VARIABLE","$mailer",451],["T_OBJECT_OPERATOR","->",451],["T_STRING","setSender",451],"(",["T_STRING","Mage",451],["T_DOUBLE_COLON","::",451],["T_STRING","getStoreConfig",451],"(",["T_STRING","self",451],["T_DOUBLE_COLON","::",451],["T_STRING","XML_PATH_EMAIL_IDENTITY",451],",",["T_WHITESPACE"," ",451],["T_VARIABLE","$storeId",451],")",")",";",["T_WHITESPACE","\n        ",451],["T_VARIABLE","$mailer",452],["T_OBJECT_OPERATOR","->",452],["T_STRING","setStoreId",452],"(",["T_VARIABLE","$storeId",452],")",";",["T_WHITESPACE","\n        ",452],["T_VARIABLE","$mailer",453],["T_OBJECT_OPERATOR","->",453],["T_STRING","setTemplateId",453],"(",["T_VARIABLE","$templateId",453],")",";",["T_WHITESPACE","\n        ",453],["T_VARIABLE","$mailer",454],["T_OBJECT_OPERATOR","->",454],["T_STRING","setTemplateParams",454],"(",["T_ARRAY","array",454],"(",["T_WHITESPACE","\n                ",454],["T_CONSTANT_ENCAPSED_STRING","'order'",455],["T_WHITESPACE","        ",455],["T_DOUBLE_ARROW","=>",455],["T_WHITESPACE"," ",455],["T_VARIABLE","$order",455],",",["T_WHITESPACE","\n                ",455],["T_CONSTANT_ENCAPSED_STRING","'shipment'",456],["T_WHITESPACE","     ",456],["T_DOUBLE_ARROW","=>",456],["T_WHITESPACE"," ",456],["T_VARIABLE","$this",456],",",["T_WHITESPACE","\n                ",456],["T_CONSTANT_ENCAPSED_STRING","'comment'",457],["T_WHITESPACE","      ",457],["T_DOUBLE_ARROW","=>",457],["T_WHITESPACE"," ",457],["T_VARIABLE","$comment",457],",",["T_WHITESPACE","\n                ",457],["T_CONSTANT_ENCAPSED_STRING","'billing'",458],["T_WHITESPACE","      ",458],["T_DOUBLE_ARROW","=>",458],["T_WHITESPACE"," ",458],["T_VARIABLE","$order",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","getBillingAddress",458],"(",")",",",["T_WHITESPACE","\n                ",458],["T_CONSTANT_ENCAPSED_STRING","'payment_html'",459],["T_WHITESPACE"," ",459],["T_DOUBLE_ARROW","=>",459],["T_WHITESPACE"," ",459],["T_VARIABLE","$paymentBlockHtml",459],["T_WHITESPACE","\n            ",459],")",["T_WHITESPACE","\n        ",460],")",";",["T_WHITESPACE","\n        ",461],["T_VARIABLE","$mailer",462],["T_OBJECT_OPERATOR","->",462],["T_STRING","send",462],"(",")",";",["T_WHITESPACE","\n\n        ",462],["T_RETURN","return",464],["T_WHITESPACE"," ",464],["T_VARIABLE","$this",464],";",["T_WHITESPACE","\n    ",464],"}",["T_WHITESPACE","\n\n    ",465],["T_DOC_COMMENT","\/**\n     * Send email with shipment update information\n     *\n     * @param boolean $notifyCustomer\n     * @param string $comment\n     * @return Mage_Sales_Model_Order_Shipment\n     *\/",467],["T_WHITESPACE","\n    ",473],["T_PUBLIC","public",474],["T_WHITESPACE"," ",474],["T_FUNCTION","function",474],["T_WHITESPACE"," ",474],["T_STRING","sendUpdateEmail",474],"(",["T_VARIABLE","$notifyCustomer",474],["T_WHITESPACE"," ",474],"=",["T_WHITESPACE"," ",474],["T_STRING","true",474],",",["T_WHITESPACE"," ",474],["T_VARIABLE","$comment",474],["T_WHITESPACE"," ",474],"=",["T_WHITESPACE"," ",474],["T_CONSTANT_ENCAPSED_STRING","''",474],")",["T_WHITESPACE","\n    ",474],"{",["T_WHITESPACE","\n        ",475],["T_VARIABLE","$order",476],["T_WHITESPACE"," ",476],"=",["T_WHITESPACE"," ",476],["T_VARIABLE","$this",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","getOrder",476],"(",")",";",["T_WHITESPACE","\n        ",476],["T_VARIABLE","$storeId",477],["T_WHITESPACE"," ",477],"=",["T_WHITESPACE"," ",477],["T_VARIABLE","$order",477],["T_OBJECT_OPERATOR","->",477],["T_STRING","getStore",477],"(",")",["T_OBJECT_OPERATOR","->",477],["T_STRING","getId",477],"(",")",";",["T_WHITESPACE","\n\n        ",477],["T_IF","if",479],["T_WHITESPACE"," ",479],"(","!",["T_STRING","Mage",479],["T_DOUBLE_COLON","::",479],["T_STRING","helper",479],"(",["T_CONSTANT_ENCAPSED_STRING","'sales'",479],")",["T_OBJECT_OPERATOR","->",479],["T_STRING","canSendShipmentCommentEmail",479],"(",["T_VARIABLE","$storeId",479],")",")",["T_WHITESPACE"," ",479],"{",["T_WHITESPACE","\n            ",479],["T_RETURN","return",480],["T_WHITESPACE"," ",480],["T_VARIABLE","$this",480],";",["T_WHITESPACE","\n        ",480],"}",["T_WHITESPACE","\n        ",481],["T_COMMENT","\/\/ Get the destination email addresses to send copies to\n",482],["T_WHITESPACE","        ",483],["T_VARIABLE","$copyTo",483],["T_WHITESPACE"," ",483],"=",["T_WHITESPACE"," ",483],["T_VARIABLE","$this",483],["T_OBJECT_OPERATOR","->",483],["T_STRING","_getEmails",483],"(",["T_STRING","self",483],["T_DOUBLE_COLON","::",483],["T_STRING","XML_PATH_UPDATE_EMAIL_COPY_TO",483],")",";",["T_WHITESPACE","\n        ",483],["T_VARIABLE","$copyMethod",484],["T_WHITESPACE"," ",484],"=",["T_WHITESPACE"," ",484],["T_STRING","Mage",484],["T_DOUBLE_COLON","::",484],["T_STRING","getStoreConfig",484],"(",["T_STRING","self",484],["T_DOUBLE_COLON","::",484],["T_STRING","XML_PATH_UPDATE_EMAIL_COPY_METHOD",484],",",["T_WHITESPACE"," ",484],["T_VARIABLE","$storeId",484],")",";",["T_WHITESPACE","\n        ",484],["T_COMMENT","\/\/ Check if at least one recepient is found\n",485],["T_WHITESPACE","        ",486],["T_IF","if",486],["T_WHITESPACE"," ",486],"(","!",["T_VARIABLE","$notifyCustomer",486],["T_WHITESPACE"," ",486],["T_BOOLEAN_AND","&&",486],["T_WHITESPACE"," ",486],"!",["T_VARIABLE","$copyTo",486],")",["T_WHITESPACE"," ",486],"{",["T_WHITESPACE","\n            ",486],["T_RETURN","return",487],["T_WHITESPACE"," ",487],["T_VARIABLE","$this",487],";",["T_WHITESPACE","\n        ",487],"}",["T_WHITESPACE","\n\n        ",488],["T_COMMENT","\/\/ Retrieve corresponding email template id and customer name\n",490],["T_WHITESPACE","        ",491],["T_IF","if",491],["T_WHITESPACE"," ",491],"(",["T_VARIABLE","$order",491],["T_OBJECT_OPERATOR","->",491],["T_STRING","getCustomerIsGuest",491],"(",")",")",["T_WHITESPACE"," ",491],"{",["T_WHITESPACE","\n            ",491],["T_VARIABLE","$templateId",492],["T_WHITESPACE"," ",492],"=",["T_WHITESPACE"," ",492],["T_STRING","Mage",492],["T_DOUBLE_COLON","::",492],["T_STRING","getStoreConfig",492],"(",["T_STRING","self",492],["T_DOUBLE_COLON","::",492],["T_STRING","XML_PATH_UPDATE_EMAIL_GUEST_TEMPLATE",492],",",["T_WHITESPACE"," ",492],["T_VARIABLE","$storeId",492],")",";",["T_WHITESPACE","\n            ",492],["T_VARIABLE","$customerName",493],["T_WHITESPACE"," ",493],"=",["T_WHITESPACE"," ",493],["T_VARIABLE","$order",493],["T_OBJECT_OPERATOR","->",493],["T_STRING","getBillingAddress",493],"(",")",["T_OBJECT_OPERATOR","->",493],["T_STRING","getName",493],"(",")",";",["T_WHITESPACE","\n        ",493],"}",["T_WHITESPACE"," ",494],["T_ELSE","else",494],["T_WHITESPACE"," ",494],"{",["T_WHITESPACE","\n            ",494],["T_VARIABLE","$templateId",495],["T_WHITESPACE"," ",495],"=",["T_WHITESPACE"," ",495],["T_STRING","Mage",495],["T_DOUBLE_COLON","::",495],["T_STRING","getStoreConfig",495],"(",["T_STRING","self",495],["T_DOUBLE_COLON","::",495],["T_STRING","XML_PATH_UPDATE_EMAIL_TEMPLATE",495],",",["T_WHITESPACE"," ",495],["T_VARIABLE","$storeId",495],")",";",["T_WHITESPACE","\n            ",495],["T_VARIABLE","$customerName",496],["T_WHITESPACE"," ",496],"=",["T_WHITESPACE"," ",496],["T_VARIABLE","$order",496],["T_OBJECT_OPERATOR","->",496],["T_STRING","getCustomerName",496],"(",")",";",["T_WHITESPACE","\n        ",496],"}",["T_WHITESPACE","\n\n        ",497],["T_VARIABLE","$mailer",499],["T_WHITESPACE"," ",499],"=",["T_WHITESPACE"," ",499],["T_STRING","Mage",499],["T_DOUBLE_COLON","::",499],["T_STRING","getModel",499],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/email_template_mailer'",499],")",";",["T_WHITESPACE","\n        ",499],["T_IF","if",500],["T_WHITESPACE"," ",500],"(",["T_VARIABLE","$notifyCustomer",500],")",["T_WHITESPACE"," ",500],"{",["T_WHITESPACE","\n            ",500],["T_VARIABLE","$emailInfo",501],["T_WHITESPACE"," ",501],"=",["T_WHITESPACE"," ",501],["T_STRING","Mage",501],["T_DOUBLE_COLON","::",501],["T_STRING","getModel",501],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/email_info'",501],")",";",["T_WHITESPACE","\n            ",501],["T_VARIABLE","$emailInfo",502],["T_OBJECT_OPERATOR","->",502],["T_STRING","addTo",502],"(",["T_VARIABLE","$order",502],["T_OBJECT_OPERATOR","->",502],["T_STRING","getCustomerEmail",502],"(",")",",",["T_WHITESPACE"," ",502],["T_VARIABLE","$customerName",502],")",";",["T_WHITESPACE","\n            ",502],["T_IF","if",503],["T_WHITESPACE"," ",503],"(",["T_VARIABLE","$copyTo",503],["T_WHITESPACE"," ",503],["T_BOOLEAN_AND","&&",503],["T_WHITESPACE"," ",503],["T_VARIABLE","$copyMethod",503],["T_WHITESPACE"," ",503],["T_IS_EQUAL","==",503],["T_WHITESPACE"," ",503],["T_CONSTANT_ENCAPSED_STRING","'bcc'",503],")",["T_WHITESPACE"," ",503],"{",["T_WHITESPACE","\n                ",503],["T_COMMENT","\/\/ Add bcc to customer email\n",504],["T_WHITESPACE","                ",505],["T_FOREACH","foreach",505],["T_WHITESPACE"," ",505],"(",["T_VARIABLE","$copyTo",505],["T_WHITESPACE"," ",505],["T_AS","as",505],["T_WHITESPACE"," ",505],["T_VARIABLE","$email",505],")",["T_WHITESPACE"," ",505],"{",["T_WHITESPACE","\n                    ",505],["T_VARIABLE","$emailInfo",506],["T_OBJECT_OPERATOR","->",506],["T_STRING","addBcc",506],"(",["T_VARIABLE","$email",506],")",";",["T_WHITESPACE","\n                ",506],"}",["T_WHITESPACE","\n            ",507],"}",["T_WHITESPACE","\n            ",508],["T_VARIABLE","$mailer",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","addEmailInfo",509],"(",["T_VARIABLE","$emailInfo",509],")",";",["T_WHITESPACE","\n        ",509],"}",["T_WHITESPACE","\n\n        ",510],["T_COMMENT","\/\/ Email copies are sent as separated emails if their copy method is 'copy' or a customer should not be notified\n",512],["T_WHITESPACE","        ",513],["T_IF","if",513],["T_WHITESPACE"," ",513],"(",["T_VARIABLE","$copyTo",513],["T_WHITESPACE"," ",513],["T_BOOLEAN_AND","&&",513],["T_WHITESPACE"," ",513],"(",["T_VARIABLE","$copyMethod",513],["T_WHITESPACE"," ",513],["T_IS_EQUAL","==",513],["T_WHITESPACE"," ",513],["T_CONSTANT_ENCAPSED_STRING","'copy'",513],["T_WHITESPACE"," ",513],["T_BOOLEAN_OR","||",513],["T_WHITESPACE"," ",513],"!",["T_VARIABLE","$notifyCustomer",513],")",")",["T_WHITESPACE"," ",513],"{",["T_WHITESPACE","\n            ",513],["T_FOREACH","foreach",514],["T_WHITESPACE"," ",514],"(",["T_VARIABLE","$copyTo",514],["T_WHITESPACE"," ",514],["T_AS","as",514],["T_WHITESPACE"," ",514],["T_VARIABLE","$email",514],")",["T_WHITESPACE"," ",514],"{",["T_WHITESPACE","\n                ",514],["T_VARIABLE","$emailInfo",515],["T_WHITESPACE"," ",515],"=",["T_WHITESPACE"," ",515],["T_STRING","Mage",515],["T_DOUBLE_COLON","::",515],["T_STRING","getModel",515],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/email_info'",515],")",";",["T_WHITESPACE","\n                ",515],["T_VARIABLE","$emailInfo",516],["T_OBJECT_OPERATOR","->",516],["T_STRING","addTo",516],"(",["T_VARIABLE","$email",516],")",";",["T_WHITESPACE","\n                ",516],["T_VARIABLE","$mailer",517],["T_OBJECT_OPERATOR","->",517],["T_STRING","addEmailInfo",517],"(",["T_VARIABLE","$emailInfo",517],")",";",["T_WHITESPACE","\n            ",517],"}",["T_WHITESPACE","\n        ",518],"}",["T_WHITESPACE","\n\n        ",519],["T_COMMENT","\/\/ Set all required params and send emails\n",521],["T_WHITESPACE","        ",522],["T_VARIABLE","$mailer",522],["T_OBJECT_OPERATOR","->",522],["T_STRING","setSender",522],"(",["T_STRING","Mage",522],["T_DOUBLE_COLON","::",522],["T_STRING","getStoreConfig",522],"(",["T_STRING","self",522],["T_DOUBLE_COLON","::",522],["T_STRING","XML_PATH_UPDATE_EMAIL_IDENTITY",522],",",["T_WHITESPACE"," ",522],["T_VARIABLE","$storeId",522],")",")",";",["T_WHITESPACE","\n        ",522],["T_VARIABLE","$mailer",523],["T_OBJECT_OPERATOR","->",523],["T_STRING","setStoreId",523],"(",["T_VARIABLE","$storeId",523],")",";",["T_WHITESPACE","\n        ",523],["T_VARIABLE","$mailer",524],["T_OBJECT_OPERATOR","->",524],["T_STRING","setTemplateId",524],"(",["T_VARIABLE","$templateId",524],")",";",["T_WHITESPACE","\n        ",524],["T_VARIABLE","$mailer",525],["T_OBJECT_OPERATOR","->",525],["T_STRING","setTemplateParams",525],"(",["T_ARRAY","array",525],"(",["T_WHITESPACE","\n                ",525],["T_CONSTANT_ENCAPSED_STRING","'order'",526],["T_WHITESPACE","    ",526],["T_DOUBLE_ARROW","=>",526],["T_WHITESPACE"," ",526],["T_VARIABLE","$order",526],",",["T_WHITESPACE","\n                ",526],["T_CONSTANT_ENCAPSED_STRING","'shipment'",527],["T_WHITESPACE"," ",527],["T_DOUBLE_ARROW","=>",527],["T_WHITESPACE"," ",527],["T_VARIABLE","$this",527],",",["T_WHITESPACE","\n                ",527],["T_CONSTANT_ENCAPSED_STRING","'comment'",528],["T_WHITESPACE","  ",528],["T_DOUBLE_ARROW","=>",528],["T_WHITESPACE"," ",528],["T_VARIABLE","$comment",528],",",["T_WHITESPACE","\n                ",528],["T_CONSTANT_ENCAPSED_STRING","'billing'",529],["T_WHITESPACE","  ",529],["T_DOUBLE_ARROW","=>",529],["T_WHITESPACE"," ",529],["T_VARIABLE","$order",529],["T_OBJECT_OPERATOR","->",529],["T_STRING","getBillingAddress",529],"(",")",["T_WHITESPACE","\n            ",529],")",["T_WHITESPACE","\n        ",530],")",";",["T_WHITESPACE","\n        ",531],["T_VARIABLE","$mailer",532],["T_OBJECT_OPERATOR","->",532],["T_STRING","send",532],"(",")",";",["T_WHITESPACE","\n\n        ",532],["T_RETURN","return",534],["T_WHITESPACE"," ",534],["T_VARIABLE","$this",534],";",["T_WHITESPACE","\n    ",534],"}",["T_WHITESPACE","\n\n    ",535],["T_PROTECTED","protected",537],["T_WHITESPACE"," ",537],["T_FUNCTION","function",537],["T_WHITESPACE"," ",537],["T_STRING","_getEmails",537],"(",["T_VARIABLE","$configPath",537],")",["T_WHITESPACE","\n    ",537],"{",["T_WHITESPACE","\n        ",538],["T_VARIABLE","$data",539],["T_WHITESPACE"," ",539],"=",["T_WHITESPACE"," ",539],["T_STRING","Mage",539],["T_DOUBLE_COLON","::",539],["T_STRING","getStoreConfig",539],"(",["T_VARIABLE","$configPath",539],",",["T_WHITESPACE"," ",539],["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","getStoreId",539],"(",")",")",";",["T_WHITESPACE","\n        ",539],["T_IF","if",540],["T_WHITESPACE"," ",540],"(","!",["T_EMPTY","empty",540],"(",["T_VARIABLE","$data",540],")",")",["T_WHITESPACE"," ",540],"{",["T_WHITESPACE","\n            ",540],["T_RETURN","return",541],["T_WHITESPACE"," ",541],["T_STRING","explode",541],"(",["T_CONSTANT_ENCAPSED_STRING","','",541],",",["T_WHITESPACE"," ",541],["T_VARIABLE","$data",541],")",";",["T_WHITESPACE","\n        ",541],"}",["T_WHITESPACE","\n        ",542],["T_RETURN","return",543],["T_WHITESPACE"," ",543],["T_STRING","false",543],";",["T_WHITESPACE","\n    ",543],"}",["T_WHITESPACE","\n\n    ",544],["T_DOC_COMMENT","\/**\n     * Before object save\n     *\n     * @return Mage_Sales_Model_Order_Shipment\n     *\/",546],["T_WHITESPACE","\n    ",550],["T_PROTECTED","protected",551],["T_WHITESPACE"," ",551],["T_FUNCTION","function",551],["T_WHITESPACE"," ",551],["T_STRING","_beforeSave",551],"(",")",["T_WHITESPACE","\n    ",551],"{",["T_WHITESPACE","\n        ",552],["T_IF","if",553],["T_WHITESPACE"," ",553],"(","(","!",["T_VARIABLE","$this",553],["T_OBJECT_OPERATOR","->",553],["T_STRING","getId",553],"(",")",["T_WHITESPACE"," ",553],["T_BOOLEAN_OR","||",553],["T_WHITESPACE"," ",553],["T_STRING","null",553],["T_WHITESPACE"," ",553],["T_IS_NOT_IDENTICAL","!==",553],["T_WHITESPACE"," ",553],["T_VARIABLE","$this",553],["T_OBJECT_OPERATOR","->",553],["T_STRING","_items",553],")",["T_WHITESPACE"," ",553],["T_BOOLEAN_AND","&&",553],["T_WHITESPACE"," ",553],"!",["T_STRING","count",553],"(",["T_VARIABLE","$this",553],["T_OBJECT_OPERATOR","->",553],["T_STRING","getAllItems",553],"(",")",")",")",["T_WHITESPACE"," ",553],"{",["T_WHITESPACE","\n            ",553],["T_STRING","Mage",554],["T_DOUBLE_COLON","::",554],["T_STRING","throwException",554],"(",["T_WHITESPACE","\n                ",554],["T_STRING","Mage",555],["T_DOUBLE_COLON","::",555],["T_STRING","helper",555],"(",["T_CONSTANT_ENCAPSED_STRING","'sales'",555],")",["T_OBJECT_OPERATOR","->",555],["T_STRING","__",555],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot create an empty shipment.'",555],")",["T_WHITESPACE","\n            ",555],")",";",["T_WHITESPACE","\n        ",556],"}",["T_WHITESPACE","\n\n        ",557],["T_IF","if",559],["T_WHITESPACE"," ",559],"(","!",["T_VARIABLE","$this",559],["T_OBJECT_OPERATOR","->",559],["T_STRING","getOrderId",559],"(",")",["T_WHITESPACE"," ",559],["T_BOOLEAN_AND","&&",559],["T_WHITESPACE"," ",559],["T_VARIABLE","$this",559],["T_OBJECT_OPERATOR","->",559],["T_STRING","getOrder",559],"(",")",")",["T_WHITESPACE"," ",559],"{",["T_WHITESPACE","\n            ",559],["T_VARIABLE","$this",560],["T_OBJECT_OPERATOR","->",560],["T_STRING","setOrderId",560],"(",["T_VARIABLE","$this",560],["T_OBJECT_OPERATOR","->",560],["T_STRING","getOrder",560],"(",")",["T_OBJECT_OPERATOR","->",560],["T_STRING","getId",560],"(",")",")",";",["T_WHITESPACE","\n            ",560],["T_VARIABLE","$this",561],["T_OBJECT_OPERATOR","->",561],["T_STRING","setShippingAddressId",561],"(",["T_VARIABLE","$this",561],["T_OBJECT_OPERATOR","->",561],["T_STRING","getOrder",561],"(",")",["T_OBJECT_OPERATOR","->",561],["T_STRING","getShippingAddress",561],"(",")",["T_OBJECT_OPERATOR","->",561],["T_STRING","getId",561],"(",")",")",";",["T_WHITESPACE","\n        ",561],"}",["T_WHITESPACE","\n\n        ",562],["T_IF","if",564],["T_WHITESPACE"," ",564],"(",["T_VARIABLE","$this",564],["T_OBJECT_OPERATOR","->",564],["T_STRING","getPackages",564],"(",")",["T_WHITESPACE"," ",564],["T_BOOLEAN_AND","&&",564],["T_WHITESPACE"," ",564],"!",["T_STRING","is_scalar",564],"(",["T_VARIABLE","$this",564],["T_OBJECT_OPERATOR","->",564],["T_STRING","getPackages",564],"(",")",")",")",["T_WHITESPACE"," ",564],"{",["T_WHITESPACE","\n            ",564],["T_VARIABLE","$this",565],["T_OBJECT_OPERATOR","->",565],["T_STRING","setPackages",565],"(",["T_STRING","serialize",565],"(",["T_VARIABLE","$this",565],["T_OBJECT_OPERATOR","->",565],["T_STRING","getPackages",565],"(",")",")",")",";",["T_WHITESPACE","\n        ",565],"}",["T_WHITESPACE","\n\n        ",566],["T_RETURN","return",568],["T_WHITESPACE"," ",568],["T_STRING","parent",568],["T_DOUBLE_COLON","::",568],["T_STRING","_beforeSave",568],"(",")",";",["T_WHITESPACE","\n    ",568],"}",["T_WHITESPACE","\n\n    ",569],["T_PROTECTED","protected",571],["T_WHITESPACE"," ",571],["T_FUNCTION","function",571],["T_WHITESPACE"," ",571],["T_STRING","_beforeDelete",571],"(",")",["T_WHITESPACE","\n    ",571],"{",["T_WHITESPACE","\n        ",572],["T_VARIABLE","$this",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","_protectFromNonAdmin",573],"(",")",";",["T_WHITESPACE","\n        ",573],["T_RETURN","return",574],["T_WHITESPACE"," ",574],["T_STRING","parent",574],["T_DOUBLE_COLON","::",574],["T_STRING","_beforeDelete",574],"(",")",";",["T_WHITESPACE","\n    ",574],"}",["T_WHITESPACE","\n\n    ",575],["T_DOC_COMMENT","\/**\n     * After object save manipulations\n     *\n     * @return Mage_Sales_Model_Order_Shipment\n     *\/",577],["T_WHITESPACE","\n    ",581],["T_PROTECTED","protected",582],["T_WHITESPACE"," ",582],["T_FUNCTION","function",582],["T_WHITESPACE"," ",582],["T_STRING","_afterSave",582],"(",")",["T_WHITESPACE","\n    ",582],"{",["T_WHITESPACE","\n        ",583],["T_IF","if",584],["T_WHITESPACE"," ",584],"(",["T_STRING","null",584],["T_WHITESPACE"," ",584],["T_IS_NOT_IDENTICAL","!==",584],["T_WHITESPACE"," ",584],["T_VARIABLE","$this",584],["T_OBJECT_OPERATOR","->",584],["T_STRING","_items",584],")",["T_WHITESPACE"," ",584],"{",["T_WHITESPACE","\n            ",584],["T_FOREACH","foreach",585],["T_WHITESPACE"," ",585],"(",["T_VARIABLE","$this",585],["T_OBJECT_OPERATOR","->",585],["T_STRING","_items",585],["T_WHITESPACE"," ",585],["T_AS","as",585],["T_WHITESPACE"," ",585],["T_VARIABLE","$item",585],")",["T_WHITESPACE"," ",585],"{",["T_WHITESPACE","\n                ",585],["T_VARIABLE","$item",586],["T_OBJECT_OPERATOR","->",586],["T_STRING","save",586],"(",")",";",["T_WHITESPACE","\n            ",586],"}",["T_WHITESPACE","\n        ",587],"}",["T_WHITESPACE","\n\n        ",588],["T_IF","if",590],["T_WHITESPACE"," ",590],"(",["T_STRING","null",590],["T_WHITESPACE"," ",590],["T_IS_NOT_IDENTICAL","!==",590],["T_WHITESPACE"," ",590],["T_VARIABLE","$this",590],["T_OBJECT_OPERATOR","->",590],["T_STRING","_tracks",590],")",["T_WHITESPACE"," ",590],"{",["T_WHITESPACE","\n            ",590],["T_FOREACH","foreach",591],"(",["T_VARIABLE","$this",591],["T_OBJECT_OPERATOR","->",591],["T_STRING","_tracks",591],["T_WHITESPACE"," ",591],["T_AS","as",591],["T_WHITESPACE"," ",591],["T_VARIABLE","$track",591],")",["T_WHITESPACE"," ",591],"{",["T_WHITESPACE","\n                ",591],["T_VARIABLE","$track",592],["T_OBJECT_OPERATOR","->",592],["T_STRING","save",592],"(",")",";",["T_WHITESPACE","\n            ",592],"}",["T_WHITESPACE","\n        ",593],"}",["T_WHITESPACE","\n\n        ",594],["T_IF","if",596],["T_WHITESPACE"," ",596],"(",["T_STRING","null",596],["T_WHITESPACE"," ",596],["T_IS_NOT_IDENTICAL","!==",596],["T_WHITESPACE"," ",596],["T_VARIABLE","$this",596],["T_OBJECT_OPERATOR","->",596],["T_STRING","_comments",596],")",["T_WHITESPACE"," ",596],"{",["T_WHITESPACE","\n            ",596],["T_FOREACH","foreach",597],"(",["T_VARIABLE","$this",597],["T_OBJECT_OPERATOR","->",597],["T_STRING","_comments",597],["T_WHITESPACE"," ",597],["T_AS","as",597],["T_WHITESPACE"," ",597],["T_VARIABLE","$comment",597],")",["T_WHITESPACE"," ",597],"{",["T_WHITESPACE","\n                ",597],["T_VARIABLE","$comment",598],["T_OBJECT_OPERATOR","->",598],["T_STRING","save",598],"(",")",";",["T_WHITESPACE","\n            ",598],"}",["T_WHITESPACE","\n        ",599],"}",["T_WHITESPACE","\n\n        ",600],["T_RETURN","return",602],["T_WHITESPACE"," ",602],["T_STRING","parent",602],["T_DOUBLE_COLON","::",602],["T_STRING","_afterSave",602],"(",")",";",["T_WHITESPACE","\n    ",602],"}",["T_WHITESPACE","\n\n    ",603],["T_DOC_COMMENT","\/**\n     * Retrieve store model instance\n     *\n     * @return Mage_Core_Model_Store\n     *\/",605],["T_WHITESPACE","\n    ",609],["T_PUBLIC","public",610],["T_WHITESPACE"," ",610],["T_FUNCTION","function",610],["T_WHITESPACE"," ",610],["T_STRING","getStore",610],"(",")",["T_WHITESPACE","\n    ",610],"{",["T_WHITESPACE","\n        ",611],["T_RETURN","return",612],["T_WHITESPACE"," ",612],["T_VARIABLE","$this",612],["T_OBJECT_OPERATOR","->",612],["T_STRING","getOrder",612],"(",")",["T_OBJECT_OPERATOR","->",612],["T_STRING","getStore",612],"(",")",";",["T_WHITESPACE","\n    ",612],"}",["T_WHITESPACE","\n\n    ",613],["T_DOC_COMMENT","\/**\n     * Set shipping label\n     *\n     * @param string $label   label representation (image or pdf file)\n     * @return Mage_Sales_Model_Order_Shipment\n     *\/",615],["T_WHITESPACE","\n    ",620],["T_PUBLIC","public",621],["T_WHITESPACE"," ",621],["T_FUNCTION","function",621],["T_WHITESPACE"," ",621],["T_STRING","setShippingLabel",621],"(",["T_VARIABLE","$label",621],")",["T_WHITESPACE","\n    ",621],"{",["T_WHITESPACE","\n        ",622],["T_VARIABLE","$this",623],["T_OBJECT_OPERATOR","->",623],["T_STRING","setData",623],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping_label'",623],",",["T_WHITESPACE"," ",623],["T_VARIABLE","$label",623],")",";",["T_WHITESPACE","\n        ",623],["T_RETURN","return",624],["T_WHITESPACE"," ",624],["T_VARIABLE","$this",624],";",["T_WHITESPACE","\n    ",624],"}",["T_WHITESPACE","\n\n    ",625],["T_DOC_COMMENT","\/**\n     * Get shipping label and decode by db adapter\n     *\n     * @return void\n     *\/",627],["T_WHITESPACE","\n    ",631],["T_PUBLIC","public",632],["T_WHITESPACE"," ",632],["T_FUNCTION","function",632],["T_WHITESPACE"," ",632],["T_STRING","getShippingLabel",632],"(",")",["T_WHITESPACE","\n    ",632],"{",["T_WHITESPACE","\n        ",633],["T_VARIABLE","$label",634],["T_WHITESPACE"," ",634],"=",["T_WHITESPACE"," ",634],["T_VARIABLE","$this",634],["T_OBJECT_OPERATOR","->",634],["T_STRING","getData",634],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping_label'",634],")",";",["T_WHITESPACE","\n        ",634],["T_IF","if",635],["T_WHITESPACE"," ",635],"(",["T_VARIABLE","$label",635],")",["T_WHITESPACE"," ",635],"{",["T_WHITESPACE","\n            ",635],["T_RETURN","return",636],["T_WHITESPACE"," ",636],["T_VARIABLE","$this",636],["T_OBJECT_OPERATOR","->",636],["T_STRING","getResource",636],"(",")",["T_OBJECT_OPERATOR","->",636],["T_STRING","getReadConnection",636],"(",")",["T_OBJECT_OPERATOR","->",636],["T_STRING","decodeVarbinary",636],"(",["T_VARIABLE","$label",636],")",";",["T_WHITESPACE","\n        ",636],"}",["T_WHITESPACE","\n        ",637],["T_RETURN","return",638],["T_WHITESPACE"," ",638],["T_VARIABLE","$label",638],";",["T_WHITESPACE","\n    ",638],"}",["T_WHITESPACE","\n",639],"}",["T_WHITESPACE","\n",640]]