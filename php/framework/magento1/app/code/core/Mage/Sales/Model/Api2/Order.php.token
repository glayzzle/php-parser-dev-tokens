[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Sales\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * API2 class for orders\n *\n * @category   Mage\n * @package    Mage_Sales\n * @author     Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Sales_Model_Api2_Order",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Api2_Model_Resource",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_COMMENT","\/**#@+\n     * Parameters' names in config with special ACL meaning\n     *\/",36],["T_WHITESPACE","\n    ",38],["T_CONST","const",39],["T_WHITESPACE"," ",39],["T_STRING","PARAM_GIFT_MESSAGE",39],["T_WHITESPACE","   ",39],"=",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'_gift_message'",39],";",["T_WHITESPACE","\n    ",39],["T_CONST","const",40],["T_WHITESPACE"," ",40],["T_STRING","PARAM_ORDER_COMMENTS",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'_order_comments'",40],";",["T_WHITESPACE","\n    ",40],["T_CONST","const",41],["T_WHITESPACE"," ",41],["T_STRING","PARAM_PAYMENT_METHOD",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'_payment_method'",41],";",["T_WHITESPACE","\n    ",41],["T_CONST","const",42],["T_WHITESPACE"," ",42],["T_STRING","PARAM_TAX_NAME",42],["T_WHITESPACE","       ",42],"=",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'_tax_name'",42],";",["T_WHITESPACE","\n    ",42],["T_CONST","const",43],["T_WHITESPACE"," ",43],["T_STRING","PARAM_TAX_RATE",43],["T_WHITESPACE","       ",43],"=",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'_tax_rate'",43],";",["T_WHITESPACE","\n    ",43],["T_COMMENT","\/**#@-*\/",44],["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * Add gift message info to select\n     *\n     * @param Mage_Sales_Model_Resource_Order_Collection $collection\n     * @return Mage_Sales_Model_Api2_Order\n     *\/",46],["T_WHITESPACE","\n    ",51],["T_PROTECTED","protected",52],["T_WHITESPACE"," ",52],["T_FUNCTION","function",52],["T_WHITESPACE"," ",52],["T_STRING","_addGiftMessageInfo",52],"(",["T_STRING","Mage_Sales_Model_Resource_Order_Collection",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$collection",52],")",["T_WHITESPACE","\n    ",52],"{",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$collection",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","getSelect",54],"(",")",["T_OBJECT_OPERATOR","->",54],["T_STRING","joinLeft",54],"(",["T_WHITESPACE","\n            ",54],["T_ARRAY","array",55],"(",["T_CONSTANT_ENCAPSED_STRING","'gift_message'",55],["T_WHITESPACE"," ",55],["T_DOUBLE_ARROW","=>",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$collection",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","getTable",55],"(",["T_CONSTANT_ENCAPSED_STRING","'giftmessage\/message'",55],")",")",",",["T_WHITESPACE","\n            ",55],["T_CONSTANT_ENCAPSED_STRING","'main_table.gift_message_id = gift_message.gift_message_id'",56],",",["T_WHITESPACE","\n            ",56],["T_ARRAY","array",57],"(",["T_WHITESPACE","\n                ",57],["T_CONSTANT_ENCAPSED_STRING","'gift_message_from'",58],["T_WHITESPACE"," ",58],["T_DOUBLE_ARROW","=>",58],["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'gift_message.sender'",58],",",["T_WHITESPACE","\n                ",58],["T_CONSTANT_ENCAPSED_STRING","'gift_message_to'",59],["T_WHITESPACE","   ",59],["T_DOUBLE_ARROW","=>",59],["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'gift_message.recipient'",59],",",["T_WHITESPACE","\n                ",59],["T_CONSTANT_ENCAPSED_STRING","'gift_message_body'",60],["T_WHITESPACE"," ",60],["T_DOUBLE_ARROW","=>",60],["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'gift_message.message'",60],["T_WHITESPACE","\n            ",60],")",["T_WHITESPACE","\n        ",61],")",";",["T_WHITESPACE","\n\n        ",62],["T_RETURN","return",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$this",64],";",["T_WHITESPACE","\n    ",64],"}",["T_WHITESPACE","\n\n    ",65],["T_DOC_COMMENT","\/**\n     * Add order payment method field to select\n     *\n     * @param Mage_Sales_Model_Resource_Order_Collection $collection\n     * @return Mage_Sales_Model_Api2_Order\n     *\/",67],["T_WHITESPACE","\n    ",72],["T_PROTECTED","protected",73],["T_WHITESPACE"," ",73],["T_FUNCTION","function",73],["T_WHITESPACE"," ",73],["T_STRING","_addPaymentMethodInfo",73],"(",["T_STRING","Mage_Sales_Model_Resource_Order_Collection",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$collection",73],")",["T_WHITESPACE","\n    ",73],"{",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$collection",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getSelect",75],"(",")",["T_OBJECT_OPERATOR","->",75],["T_STRING","joinLeft",75],"(",["T_WHITESPACE","\n            ",75],["T_ARRAY","array",76],"(",["T_CONSTANT_ENCAPSED_STRING","'payment_method'",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$collection",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getTable",76],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order_payment'",76],")",")",",",["T_WHITESPACE","\n            ",76],["T_CONSTANT_ENCAPSED_STRING","'main_table.entity_id = payment_method.parent_id'",77],",",["T_WHITESPACE","\n            ",77],["T_ARRAY","array",78],"(",["T_CONSTANT_ENCAPSED_STRING","'payment_method'",78],["T_WHITESPACE"," ",78],["T_DOUBLE_ARROW","=>",78],["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'payment_method.method'",78],")",["T_WHITESPACE","\n        ",78],")",";",["T_WHITESPACE","\n\n        ",79],["T_RETURN","return",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],";",["T_WHITESPACE","\n    ",81],"}",["T_WHITESPACE","\n\n    ",82],["T_DOC_COMMENT","\/**\n     * Add order tax information to select\n     *\n     * @param Mage_Sales_Model_Resource_Order_Collection $collection\n     * @return Mage_Sales_Model_Api2_Order\n     *\/",84],["T_WHITESPACE","\n    ",89],["T_PROTECTED","protected",90],["T_WHITESPACE"," ",90],["T_FUNCTION","function",90],["T_WHITESPACE"," ",90],["T_STRING","_addTaxInfo",90],"(",["T_STRING","Mage_Sales_Model_Resource_Order_Collection",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$collection",90],")",["T_WHITESPACE","\n    ",90],"{",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$taxInfoFields",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_ARRAY","array",92],"(",")",";",["T_WHITESPACE","\n\n        ",92],["T_IF","if",94],["T_WHITESPACE"," ",94],"(",["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","_isTaxNameAllowed",94],"(",")",")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n            ",94],["T_VARIABLE","$taxInfoFields",95],"[",["T_CONSTANT_ENCAPSED_STRING","'tax_name'",95],"]",["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","'order_tax.title'",95],";",["T_WHITESPACE","\n        ",95],"}",["T_WHITESPACE","\n        ",96],["T_IF","if",97],["T_WHITESPACE"," ",97],"(",["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","_isTaxRateAllowed",97],"(",")",")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n            ",97],["T_VARIABLE","$taxInfoFields",98],"[",["T_CONSTANT_ENCAPSED_STRING","'tax_rate'",98],"]",["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'order_tax.percent'",98],";",["T_WHITESPACE","\n        ",98],"}",["T_WHITESPACE","\n        ",99],["T_IF","if",100],["T_WHITESPACE"," ",100],"(",["T_VARIABLE","$taxInfoFields",100],")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n            ",100],["T_VARIABLE","$collection",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getSelect",101],"(",")",["T_OBJECT_OPERATOR","->",101],["T_STRING","joinLeft",101],"(",["T_WHITESPACE","\n                ",101],["T_ARRAY","array",102],"(",["T_CONSTANT_ENCAPSED_STRING","'order_tax'",102],["T_WHITESPACE"," ",102],["T_DOUBLE_ARROW","=>",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$collection",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getTable",102],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order_tax'",102],")",")",",",["T_WHITESPACE","\n                ",102],["T_CONSTANT_ENCAPSED_STRING","'main_table.entity_id = order_tax.order_id'",103],",",["T_WHITESPACE","\n                ",103],["T_VARIABLE","$taxInfoFields",104],["T_WHITESPACE","\n            ",104],")",";",["T_WHITESPACE","\n            ",105],["T_VARIABLE","$collection",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","getSelect",106],"(",")",["T_OBJECT_OPERATOR","->",106],["T_STRING","group",106],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.entity_id'",106],")",";",["T_WHITESPACE","\n        ",106],"}",["T_WHITESPACE","\n        ",107],["T_RETURN","return",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$this",108],";",["T_WHITESPACE","\n    ",108],"}",["T_WHITESPACE","\n\n    ",109],["T_DOC_COMMENT","\/**\n     * Retrieve a list or orders' addresses in a form of [order ID => array of addresses, ...]\n     *\n     * @param array $orderIds Orders identifiers\n     * @return array\n     *\/",111],["T_WHITESPACE","\n    ",116],["T_PROTECTED","protected",117],["T_WHITESPACE"," ",117],["T_FUNCTION","function",117],["T_WHITESPACE"," ",117],["T_STRING","_getAddresses",117],"(",["T_ARRAY","array",117],["T_WHITESPACE"," ",117],["T_VARIABLE","$orderIds",117],")",["T_WHITESPACE","\n    ",117],"{",["T_WHITESPACE","\n        ",118],["T_VARIABLE","$addresses",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_ARRAY","array",119],"(",")",";",["T_WHITESPACE","\n\n        ",119],["T_IF","if",121],["T_WHITESPACE"," ",121],"(",["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","_isSubCallAllowed",121],"(",["T_CONSTANT_ENCAPSED_STRING","'order_address'",121],")",")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n            ",121],["T_DOC_COMMENT","\/** @var $addressesFilter Mage_Api2_Model_Acl_Filter *\/",122],["T_WHITESPACE","\n            ",122],["T_VARIABLE","$addressesFilter",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","_getSubModel",123],"(",["T_CONSTANT_ENCAPSED_STRING","'order_address'",123],",",["T_WHITESPACE"," ",123],["T_ARRAY","array",123],"(",")",")",["T_OBJECT_OPERATOR","->",123],["T_STRING","getFilter",123],"(",")",";",["T_WHITESPACE","\n            ",123],["T_COMMENT","\/\/ do addresses request if at least one attribute allowed\n",124],["T_WHITESPACE","            ",125],["T_IF","if",125],["T_WHITESPACE"," ",125],"(",["T_VARIABLE","$addressesFilter",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","getAllowedAttributes",125],"(",")",")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n                ",125],["T_COMMENT","\/* @var $collection Mage_Sales_Model_Resource_Order_Address_Collection *\/",126],["T_WHITESPACE","\n                ",126],["T_VARIABLE","$collection",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_STRING","Mage",127],["T_DOUBLE_COLON","::",127],["T_STRING","getResourceModel",127],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order_address_collection'",127],")",";",["T_WHITESPACE","\n\n                ",127],["T_VARIABLE","$collection",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","addAttributeToFilter",129],"(",["T_CONSTANT_ENCAPSED_STRING","'parent_id'",129],",",["T_WHITESPACE"," ",129],["T_VARIABLE","$orderIds",129],")",";",["T_WHITESPACE","\n\n                ",129],["T_FOREACH","foreach",131],["T_WHITESPACE"," ",131],"(",["T_VARIABLE","$collection",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","getItems",131],"(",")",["T_WHITESPACE"," ",131],["T_AS","as",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$item",131],")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n                    ",131],["T_VARIABLE","$addresses",132],"[",["T_VARIABLE","$item",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","getParentId",132],"(",")","]","[","]",["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_VARIABLE","$addressesFilter",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","out",132],"(",["T_VARIABLE","$item",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","toArray",132],"(",")",")",";",["T_WHITESPACE","\n                ",132],"}",["T_WHITESPACE","\n            ",133],"}",["T_WHITESPACE","\n        ",134],"}",["T_WHITESPACE","\n        ",135],["T_RETURN","return",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$addresses",136],";",["T_WHITESPACE","\n    ",136],"}",["T_WHITESPACE","\n\n    ",137],["T_DOC_COMMENT","\/**\n     * Retrieve collection instance for orders list\n     *\n     * @return Mage_Sales_Model_Resource_Order_Collection\n     *\/",139],["T_WHITESPACE","\n    ",143],["T_PROTECTED","protected",144],["T_WHITESPACE"," ",144],["T_FUNCTION","function",144],["T_WHITESPACE"," ",144],["T_STRING","_getCollectionForRetrieve",144],"(",")",["T_WHITESPACE","\n    ",144],"{",["T_WHITESPACE","\n        ",145],["T_DOC_COMMENT","\/** @var $collection Mage_Sales_Model_Resource_Order_Collection *\/",146],["T_WHITESPACE","\n        ",146],["T_VARIABLE","$collection",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_STRING","Mage",147],["T_DOUBLE_COLON","::",147],["T_STRING","getResourceModel",147],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order_collection'",147],")",";",["T_WHITESPACE","\n\n        ",147],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","_applyCollectionModifiers",149],"(",["T_VARIABLE","$collection",149],")",";",["T_WHITESPACE","\n\n        ",149],["T_RETURN","return",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$collection",151],";",["T_WHITESPACE","\n    ",151],"}",["T_WHITESPACE","\n\n    ",152],["T_DOC_COMMENT","\/**\n     * Retrieve collection instance for single order\n     *\n     * @param int $orderId Order identifier\n     * @return Mage_Sales_Model_Resource_Order_Collection\n     *\/",154],["T_WHITESPACE","\n    ",159],["T_PROTECTED","protected",160],["T_WHITESPACE"," ",160],["T_FUNCTION","function",160],["T_WHITESPACE"," ",160],["T_STRING","_getCollectionForSingleRetrieve",160],"(",["T_VARIABLE","$orderId",160],")",["T_WHITESPACE","\n    ",160],"{",["T_WHITESPACE","\n        ",161],["T_DOC_COMMENT","\/** @var $collection Mage_Sales_Model_Resource_Order_Collection *\/",162],["T_WHITESPACE","\n        ",162],["T_VARIABLE","$collection",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_STRING","Mage",163],["T_DOUBLE_COLON","::",163],["T_STRING","getResourceModel",163],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order_collection'",163],")",";",["T_WHITESPACE","\n\n        ",163],["T_RETURN","return",165],["T_WHITESPACE"," ",165],["T_VARIABLE","$collection",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","addFieldToFilter",165],"(",["T_VARIABLE","$collection",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","getResource",165],"(",")",["T_OBJECT_OPERATOR","->",165],["T_STRING","getIdFieldName",165],"(",")",",",["T_WHITESPACE"," ",165],["T_VARIABLE","$orderId",165],")",";",["T_WHITESPACE","\n    ",165],"}",["T_WHITESPACE","\n\n    ",166],["T_DOC_COMMENT","\/**\n     * Retrieve a list or orders' comments in a form of [order ID => array of comments, ...]\n     *\n     * @param array $orderIds Orders' identifiers\n     * @return array\n     *\/",168],["T_WHITESPACE","\n    ",173],["T_PROTECTED","protected",174],["T_WHITESPACE"," ",174],["T_FUNCTION","function",174],["T_WHITESPACE"," ",174],["T_STRING","_getComments",174],"(",["T_ARRAY","array",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$orderIds",174],")",["T_WHITESPACE","\n    ",174],"{",["T_WHITESPACE","\n        ",175],["T_VARIABLE","$comments",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_ARRAY","array",176],"(",")",";",["T_WHITESPACE","\n\n        ",176],["T_IF","if",178],["T_WHITESPACE"," ",178],"(",["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","_isOrderCommentsAllowed",178],"(",")",["T_WHITESPACE"," ",178],["T_BOOLEAN_AND","&&",178],["T_WHITESPACE"," ",178],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","_isSubCallAllowed",178],"(",["T_CONSTANT_ENCAPSED_STRING","'order_comment'",178],")",")",["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n            ",178],["T_DOC_COMMENT","\/** @var $commentsFilter Mage_Api2_Model_Acl_Filter *\/",179],["T_WHITESPACE","\n            ",179],["T_VARIABLE","$commentsFilter",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","_getSubModel",180],"(",["T_CONSTANT_ENCAPSED_STRING","'order_comment'",180],",",["T_WHITESPACE"," ",180],["T_ARRAY","array",180],"(",")",")",["T_OBJECT_OPERATOR","->",180],["T_STRING","getFilter",180],"(",")",";",["T_WHITESPACE","\n            ",180],["T_COMMENT","\/\/ do comments request if at least one attribute allowed\n",181],["T_WHITESPACE","            ",182],["T_IF","if",182],["T_WHITESPACE"," ",182],"(",["T_VARIABLE","$commentsFilter",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","getAllowedAttributes",182],"(",")",")",["T_WHITESPACE"," ",182],"{",["T_WHITESPACE","\n                ",182],["T_FOREACH","foreach",183],["T_WHITESPACE"," ",183],"(",["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","_getCommentsCollection",183],"(",["T_VARIABLE","$orderIds",183],")",["T_OBJECT_OPERATOR","->",183],["T_STRING","getItems",183],"(",")",["T_WHITESPACE"," ",183],["T_AS","as",183],["T_WHITESPACE"," ",183],["T_VARIABLE","$item",183],")",["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n                    ",183],["T_VARIABLE","$comments",184],"[",["T_VARIABLE","$item",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getParentId",184],"(",")","]","[","]",["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_VARIABLE","$commentsFilter",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","out",184],"(",["T_VARIABLE","$item",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","toArray",184],"(",")",")",";",["T_WHITESPACE","\n                ",184],"}",["T_WHITESPACE","\n            ",185],"}",["T_WHITESPACE","\n        ",186],"}",["T_WHITESPACE","\n        ",187],["T_RETURN","return",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$comments",188],";",["T_WHITESPACE","\n    ",188],"}",["T_WHITESPACE","\n\n    ",189],["T_DOC_COMMENT","\/**\n     * Prepare and return order comments collection\n     *\n     * @param array $orderIds Orders' identifiers\n     * @return Mage_Sales_Model_Resource_Order_Status_History_Collection|Object\n     *\/",191],["T_WHITESPACE","\n    ",196],["T_PROTECTED","protected",197],["T_WHITESPACE"," ",197],["T_FUNCTION","function",197],["T_WHITESPACE"," ",197],["T_STRING","_getCommentsCollection",197],"(",["T_ARRAY","array",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$orderIds",197],")",["T_WHITESPACE","\n    ",197],"{",["T_WHITESPACE","\n        ",198],["T_COMMENT","\/* @var $collection Mage_Sales_Model_Resource_Order_Status_History_Collection *\/",199],["T_WHITESPACE","\n        ",199],["T_VARIABLE","$collection",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_STRING","Mage",200],["T_DOUBLE_COLON","::",200],["T_STRING","getResourceModel",200],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order_status_history_collection'",200],")",";",["T_WHITESPACE","\n        ",200],["T_VARIABLE","$collection",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","setOrderFilter",201],"(",["T_VARIABLE","$orderIds",201],")",";",["T_WHITESPACE","\n\n        ",201],["T_RETURN","return",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$collection",203],";",["T_WHITESPACE","\n    ",203],"}",["T_WHITESPACE","\n\n    ",204],["T_DOC_COMMENT","\/**\n     * Retrieve a list or orders' items in a form of [order ID => array of items, ...]\n     *\n     * @param array $orderIds Orders identifiers\n     * @return array\n     *\/",206],["T_WHITESPACE","\n    ",211],["T_PROTECTED","protected",212],["T_WHITESPACE"," ",212],["T_FUNCTION","function",212],["T_WHITESPACE"," ",212],["T_STRING","_getItems",212],"(",["T_ARRAY","array",212],["T_WHITESPACE"," ",212],["T_VARIABLE","$orderIds",212],")",["T_WHITESPACE","\n    ",212],"{",["T_WHITESPACE","\n        ",213],["T_VARIABLE","$items",214],["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_ARRAY","array",214],"(",")",";",["T_WHITESPACE","\n\n        ",214],["T_IF","if",216],["T_WHITESPACE"," ",216],"(",["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","_isSubCallAllowed",216],"(",["T_CONSTANT_ENCAPSED_STRING","'order_item'",216],")",")",["T_WHITESPACE"," ",216],"{",["T_WHITESPACE","\n            ",216],["T_DOC_COMMENT","\/** @var $itemsFilter Mage_Api2_Model_Acl_Filter *\/",217],["T_WHITESPACE","\n            ",217],["T_VARIABLE","$itemsFilter",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","_getSubModel",218],"(",["T_CONSTANT_ENCAPSED_STRING","'order_item'",218],",",["T_WHITESPACE"," ",218],["T_ARRAY","array",218],"(",")",")",["T_OBJECT_OPERATOR","->",218],["T_STRING","getFilter",218],"(",")",";",["T_WHITESPACE","\n            ",218],["T_COMMENT","\/\/ do items request if at least one attribute allowed\n",219],["T_WHITESPACE","            ",220],["T_IF","if",220],["T_WHITESPACE"," ",220],"(",["T_VARIABLE","$itemsFilter",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","getAllowedAttributes",220],"(",")",")",["T_WHITESPACE"," ",220],"{",["T_WHITESPACE","\n                ",220],["T_COMMENT","\/* @var $collection Mage_Sales_Model_Resource_Order_Item_Collection *\/",221],["T_WHITESPACE","\n                ",221],["T_VARIABLE","$collection",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_STRING","Mage",222],["T_DOUBLE_COLON","::",222],["T_STRING","getResourceModel",222],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order_item_collection'",222],")",";",["T_WHITESPACE","\n\n                ",222],["T_VARIABLE","$collection",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","addAttributeToFilter",224],"(",["T_CONSTANT_ENCAPSED_STRING","'order_id'",224],",",["T_WHITESPACE"," ",224],["T_VARIABLE","$orderIds",224],")",";",["T_WHITESPACE","\n\n                ",224],["T_FOREACH","foreach",226],["T_WHITESPACE"," ",226],"(",["T_VARIABLE","$collection",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","getItems",226],"(",")",["T_WHITESPACE"," ",226],["T_AS","as",226],["T_WHITESPACE"," ",226],["T_VARIABLE","$item",226],")",["T_WHITESPACE"," ",226],"{",["T_WHITESPACE","\n                    ",226],["T_VARIABLE","$items",227],"[",["T_VARIABLE","$item",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","getOrderId",227],"(",")","]","[","]",["T_WHITESPACE"," ",227],"=",["T_WHITESPACE"," ",227],["T_VARIABLE","$itemsFilter",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","out",227],"(",["T_VARIABLE","$item",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","toArray",227],"(",")",")",";",["T_WHITESPACE","\n                ",227],"}",["T_WHITESPACE","\n            ",228],"}",["T_WHITESPACE","\n        ",229],"}",["T_WHITESPACE","\n        ",230],["T_RETURN","return",231],["T_WHITESPACE"," ",231],["T_VARIABLE","$items",231],";",["T_WHITESPACE","\n    ",231],"}",["T_WHITESPACE","\n\n    ",232],["T_DOC_COMMENT","\/**\n     * Check gift messages information is allowed\n     *\n     * @return bool\n     *\/",234],["T_WHITESPACE","\n    ",238],["T_PUBLIC","public",239],["T_WHITESPACE"," ",239],["T_FUNCTION","function",239],["T_WHITESPACE"," ",239],["T_STRING","_isGiftMessageAllowed",239],"(",")",["T_WHITESPACE","\n    ",239],"{",["T_WHITESPACE","\n        ",240],["T_RETURN","return",241],["T_WHITESPACE"," ",241],["T_STRING","in_array",241],"(",["T_STRING","self",241],["T_DOUBLE_COLON","::",241],["T_STRING","PARAM_GIFT_MESSAGE",241],",",["T_WHITESPACE"," ",241],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","getFilter",241],"(",")",["T_OBJECT_OPERATOR","->",241],["T_STRING","getAllowedAttributes",241],"(",")",")",";",["T_WHITESPACE","\n    ",241],"}",["T_WHITESPACE","\n\n    ",242],["T_DOC_COMMENT","\/**\n     * Check order comments information is allowed\n     *\n     * @return bool\n     *\/",244],["T_WHITESPACE","\n    ",248],["T_PUBLIC","public",249],["T_WHITESPACE"," ",249],["T_FUNCTION","function",249],["T_WHITESPACE"," ",249],["T_STRING","_isOrderCommentsAllowed",249],"(",")",["T_WHITESPACE","\n    ",249],"{",["T_WHITESPACE","\n        ",250],["T_RETURN","return",251],["T_WHITESPACE"," ",251],["T_STRING","in_array",251],"(",["T_STRING","self",251],["T_DOUBLE_COLON","::",251],["T_STRING","PARAM_ORDER_COMMENTS",251],",",["T_WHITESPACE"," ",251],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","getFilter",251],"(",")",["T_OBJECT_OPERATOR","->",251],["T_STRING","getAllowedAttributes",251],"(",")",")",";",["T_WHITESPACE","\n    ",251],"}",["T_WHITESPACE","\n\n    ",252],["T_DOC_COMMENT","\/**\n     * Check payment method information is allowed\n     *\n     * @return bool\n     *\/",254],["T_WHITESPACE","\n    ",258],["T_PUBLIC","public",259],["T_WHITESPACE"," ",259],["T_FUNCTION","function",259],["T_WHITESPACE"," ",259],["T_STRING","_isPaymentMethodAllowed",259],"(",")",["T_WHITESPACE","\n    ",259],"{",["T_WHITESPACE","\n        ",260],["T_RETURN","return",261],["T_WHITESPACE"," ",261],["T_STRING","in_array",261],"(",["T_STRING","self",261],["T_DOUBLE_COLON","::",261],["T_STRING","PARAM_PAYMENT_METHOD",261],",",["T_WHITESPACE"," ",261],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","getFilter",261],"(",")",["T_OBJECT_OPERATOR","->",261],["T_STRING","getAllowedAttributes",261],"(",")",")",";",["T_WHITESPACE","\n    ",261],"}",["T_WHITESPACE","\n\n    ",262],["T_DOC_COMMENT","\/**\n     * Check tax name information is allowed\n     *\n     * @return bool\n     *\/",264],["T_WHITESPACE","\n    ",268],["T_PUBLIC","public",269],["T_WHITESPACE"," ",269],["T_FUNCTION","function",269],["T_WHITESPACE"," ",269],["T_STRING","_isTaxNameAllowed",269],"(",")",["T_WHITESPACE","\n    ",269],"{",["T_WHITESPACE","\n        ",270],["T_RETURN","return",271],["T_WHITESPACE"," ",271],["T_STRING","in_array",271],"(",["T_STRING","self",271],["T_DOUBLE_COLON","::",271],["T_STRING","PARAM_TAX_NAME",271],",",["T_WHITESPACE"," ",271],["T_VARIABLE","$this",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","getFilter",271],"(",")",["T_OBJECT_OPERATOR","->",271],["T_STRING","getAllowedAttributes",271],"(",")",")",";",["T_WHITESPACE","\n    ",271],"}",["T_WHITESPACE","\n\n    ",272],["T_DOC_COMMENT","\/**\n     * Check tax rate information is allowed\n     *\n     * @return bool\n     *\/",274],["T_WHITESPACE","\n    ",278],["T_PUBLIC","public",279],["T_WHITESPACE"," ",279],["T_FUNCTION","function",279],["T_WHITESPACE"," ",279],["T_STRING","_isTaxRateAllowed",279],"(",")",["T_WHITESPACE","\n    ",279],"{",["T_WHITESPACE","\n        ",280],["T_RETURN","return",281],["T_WHITESPACE"," ",281],["T_STRING","in_array",281],"(",["T_STRING","self",281],["T_DOUBLE_COLON","::",281],["T_STRING","PARAM_TAX_RATE",281],",",["T_WHITESPACE"," ",281],["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","getFilter",281],"(",")",["T_OBJECT_OPERATOR","->",281],["T_STRING","getAllowedAttributes",281],"(",")",")",";",["T_WHITESPACE","\n    ",281],"}",["T_WHITESPACE","\n\n    ",282],["T_DOC_COMMENT","\/**\n     * Get orders list\n     *\n     * @return array\n     *\/",284],["T_WHITESPACE","\n    ",288],["T_PROTECTED","protected",289],["T_WHITESPACE"," ",289],["T_FUNCTION","function",289],["T_WHITESPACE"," ",289],["T_STRING","_retrieveCollection",289],"(",")",["T_WHITESPACE","\n    ",289],"{",["T_WHITESPACE","\n        ",290],["T_VARIABLE","$collection",291],["T_WHITESPACE"," ",291],"=",["T_WHITESPACE"," ",291],["T_VARIABLE","$this",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","_getCollectionForRetrieve",291],"(",")",";",["T_WHITESPACE","\n\n        ",291],["T_IF","if",293],["T_WHITESPACE"," ",293],"(",["T_VARIABLE","$this",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","_isPaymentMethodAllowed",293],"(",")",")",["T_WHITESPACE"," ",293],"{",["T_WHITESPACE","\n            ",293],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","_addPaymentMethodInfo",294],"(",["T_VARIABLE","$collection",294],")",";",["T_WHITESPACE","\n        ",294],"}",["T_WHITESPACE","\n        ",295],["T_IF","if",296],["T_WHITESPACE"," ",296],"(",["T_VARIABLE","$this",296],["T_OBJECT_OPERATOR","->",296],["T_STRING","_isGiftMessageAllowed",296],"(",")",")",["T_WHITESPACE"," ",296],"{",["T_WHITESPACE","\n            ",296],["T_VARIABLE","$this",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","_addGiftMessageInfo",297],"(",["T_VARIABLE","$collection",297],")",";",["T_WHITESPACE","\n        ",297],"}",["T_WHITESPACE","\n        ",298],["T_VARIABLE","$this",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","_addTaxInfo",299],"(",["T_VARIABLE","$collection",299],")",";",["T_WHITESPACE","\n\n        ",299],["T_VARIABLE","$ordersData",301],["T_WHITESPACE"," ",301],"=",["T_WHITESPACE"," ",301],["T_ARRAY","array",301],"(",")",";",["T_WHITESPACE","\n\n        ",301],["T_FOREACH","foreach",303],["T_WHITESPACE"," ",303],"(",["T_VARIABLE","$collection",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","getItems",303],"(",")",["T_WHITESPACE"," ",303],["T_AS","as",303],["T_WHITESPACE"," ",303],["T_VARIABLE","$order",303],")",["T_WHITESPACE"," ",303],"{",["T_WHITESPACE","\n            ",303],["T_VARIABLE","$ordersData",304],"[",["T_VARIABLE","$order",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","getId",304],"(",")","]",["T_WHITESPACE"," ",304],"=",["T_WHITESPACE"," ",304],["T_VARIABLE","$order",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","toArray",304],"(",")",";",["T_WHITESPACE","\n        ",304],"}",["T_WHITESPACE","\n        ",305],["T_IF","if",306],["T_WHITESPACE"," ",306],"(",["T_VARIABLE","$ordersData",306],")",["T_WHITESPACE"," ",306],"{",["T_WHITESPACE","\n            ",306],["T_FOREACH","foreach",307],["T_WHITESPACE"," ",307],"(",["T_VARIABLE","$this",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","_getAddresses",307],"(",["T_STRING","array_keys",307],"(",["T_VARIABLE","$ordersData",307],")",")",["T_WHITESPACE"," ",307],["T_AS","as",307],["T_WHITESPACE"," ",307],["T_VARIABLE","$orderId",307],["T_WHITESPACE"," ",307],["T_DOUBLE_ARROW","=>",307],["T_WHITESPACE"," ",307],["T_VARIABLE","$addresses",307],")",["T_WHITESPACE"," ",307],"{",["T_WHITESPACE","\n                ",307],["T_VARIABLE","$ordersData",308],"[",["T_VARIABLE","$orderId",308],"]","[",["T_CONSTANT_ENCAPSED_STRING","'addresses'",308],"]",["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],["T_VARIABLE","$addresses",308],";",["T_WHITESPACE","\n            ",308],"}",["T_WHITESPACE","\n            ",309],["T_FOREACH","foreach",310],["T_WHITESPACE"," ",310],"(",["T_VARIABLE","$this",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","_getItems",310],"(",["T_STRING","array_keys",310],"(",["T_VARIABLE","$ordersData",310],")",")",["T_WHITESPACE"," ",310],["T_AS","as",310],["T_WHITESPACE"," ",310],["T_VARIABLE","$orderId",310],["T_WHITESPACE"," ",310],["T_DOUBLE_ARROW","=>",310],["T_WHITESPACE"," ",310],["T_VARIABLE","$items",310],")",["T_WHITESPACE"," ",310],"{",["T_WHITESPACE","\n                ",310],["T_VARIABLE","$ordersData",311],"[",["T_VARIABLE","$orderId",311],"]","[",["T_CONSTANT_ENCAPSED_STRING","'order_items'",311],"]",["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],["T_VARIABLE","$items",311],";",["T_WHITESPACE","\n            ",311],"}",["T_WHITESPACE","\n            ",312],["T_FOREACH","foreach",313],["T_WHITESPACE"," ",313],"(",["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","_getComments",313],"(",["T_STRING","array_keys",313],"(",["T_VARIABLE","$ordersData",313],")",")",["T_WHITESPACE"," ",313],["T_AS","as",313],["T_WHITESPACE"," ",313],["T_VARIABLE","$orderId",313],["T_WHITESPACE"," ",313],["T_DOUBLE_ARROW","=>",313],["T_WHITESPACE"," ",313],["T_VARIABLE","$comments",313],")",["T_WHITESPACE"," ",313],"{",["T_WHITESPACE","\n                ",313],["T_VARIABLE","$ordersData",314],"[",["T_VARIABLE","$orderId",314],"]","[",["T_CONSTANT_ENCAPSED_STRING","'order_comments'",314],"]",["T_WHITESPACE"," ",314],"=",["T_WHITESPACE"," ",314],["T_VARIABLE","$comments",314],";",["T_WHITESPACE","\n            ",314],"}",["T_WHITESPACE","\n        ",315],"}",["T_WHITESPACE","\n        ",316],["T_RETURN","return",317],["T_WHITESPACE"," ",317],["T_VARIABLE","$ordersData",317],";",["T_WHITESPACE","\n    ",317],"}",["T_WHITESPACE","\n",318],"}",["T_WHITESPACE","\n",319]]