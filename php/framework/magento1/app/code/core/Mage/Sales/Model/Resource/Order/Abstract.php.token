[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Sales\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Flat sales resource abstract\n *\n * @category    Mage\n * @package     Mage_Sales\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_ABSTRACT","abstract",35],["T_WHITESPACE"," ",35],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Sales_Model_Resource_Order_Abstract",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Sales_Model_Resource_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * Is grid available\n     *\n     * @var boolean\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_grid",42],["T_WHITESPACE","                         ",42],"=",["T_WHITESPACE"," ",42],["T_STRING","false",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Use additional is object new check for this resource\n     *\n     * @var boolean\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_useIsObjectNew",49],["T_WHITESPACE","               ",49],"=",["T_WHITESPACE"," ",49],["T_STRING","true",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Flag for using of increment id\n     *\n     * @var boolean\n     *\/",51],["T_WHITESPACE","\n    ",55],["T_PROTECTED","protected",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$_useIncrementId",56],["T_WHITESPACE","               ",56],"=",["T_WHITESPACE"," ",56],["T_STRING","false",56],";",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * Entity code for increment id (Eav entity code)\n     *\n     * @var string\n     *\/",58],["T_WHITESPACE","\n    ",62],["T_PROTECTED","protected",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$_entityTypeForIncrementId",63],["T_WHITESPACE","     ",63],"=",["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","''",63],";",["T_WHITESPACE","\n\n    ",63],["T_DOC_COMMENT","\/**\n     * Grid virtual columns\n     *\n     * @var array|null\n     *\/",65],["T_WHITESPACE","\n    ",69],["T_PROTECTED","protected",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$_virtualGridColumns",70],["T_WHITESPACE","           ",70],"=",["T_WHITESPACE"," ",70],["T_STRING","null",70],";",["T_WHITESPACE","\n\n    ",70],["T_DOC_COMMENT","\/**\n     * Grid columns\n     *\n     * @var array|null\n     *\/",72],["T_WHITESPACE","\n    ",76],["T_PROTECTED","protected",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$_gridColumns",77],["T_WHITESPACE","                  ",77],"=",["T_WHITESPACE"," ",77],["T_STRING","null",77],";",["T_WHITESPACE","\n\n    ",77],["T_DOC_COMMENT","\/**\n     * Event prefix\n     *\n     * @var string\n     *\/",79],["T_WHITESPACE","\n    ",83],["T_PROTECTED","protected",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$_eventPrefix",84],["T_WHITESPACE","                  ",84],"=",["T_WHITESPACE"," ",84],["T_CONSTANT_ENCAPSED_STRING","'sales_resource'",84],";",["T_WHITESPACE","\n\n    ",84],["T_DOC_COMMENT","\/**\n     * Event object\n     *\n     * @var string\n     *\/",86],["T_WHITESPACE","\n    ",90],["T_PROTECTED","protected",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$_eventObject",91],["T_WHITESPACE","                  ",91],"=",["T_WHITESPACE"," ",91],["T_CONSTANT_ENCAPSED_STRING","'resource'",91],";",["T_WHITESPACE","\n\n    ",91],["T_DOC_COMMENT","\/**\n     * Add new virtual grid column\n     *\n     * @param string $alias\n     * @param string $table\n     * @param array $joinCondition\n     * @param string $column\n     * @return Mage_Sales_Model_Resource_Order_Abstract\n     *\/",93],["T_WHITESPACE","\n    ",101],["T_PUBLIC","public",102],["T_WHITESPACE"," ",102],["T_FUNCTION","function",102],["T_WHITESPACE"," ",102],["T_STRING","addVirtualGridColumn",102],"(",["T_VARIABLE","$alias",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$table",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$joinCondition",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$column",102],")",["T_WHITESPACE","\n    ",102],"{",["T_WHITESPACE","\n        ",103],["T_VARIABLE","$table",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getTable",104],"(",["T_VARIABLE","$table",104],")",";",["T_WHITESPACE","\n\n        ",104],["T_IF","if",106],["T_WHITESPACE"," ",106],"(","!",["T_STRING","in_array",106],"(",["T_VARIABLE","$alias",106],",",["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","getGridColumns",106],"(",")",")",")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n            ",106],["T_STRING","Mage",107],["T_DOUBLE_COLON","::",107],["T_STRING","throwException",107],"(",["T_WHITESPACE","\n                ",107],["T_STRING","Mage",108],["T_DOUBLE_COLON","::",108],["T_STRING","helper",108],"(",["T_CONSTANT_ENCAPSED_STRING","'sales'",108],")",["T_OBJECT_OPERATOR","->",108],["T_STRING","__",108],"(",["T_CONSTANT_ENCAPSED_STRING","'Please specify a valid grid column alias name that exists in grid table.'",108],")",["T_WHITESPACE","\n            ",108],")",";",["T_WHITESPACE","\n        ",109],"}",["T_WHITESPACE","\n\n        ",110],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","_virtualGridColumns",112],"[",["T_VARIABLE","$alias",112],"]",["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_ARRAY","array",112],"(",["T_WHITESPACE","\n            ",112],["T_VARIABLE","$table",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$joinCondition",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$column",113],["T_WHITESPACE","\n        ",113],")",";",["T_WHITESPACE","\n\n        ",114],["T_RETURN","return",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],";",["T_WHITESPACE","\n    ",116],"}",["T_WHITESPACE","\n\n    ",117],["T_DOC_COMMENT","\/**\n     * Retrieve virtual grid columns\n     *\n     * @return array\n     *\/",119],["T_WHITESPACE","\n    ",123],["T_PUBLIC","public",124],["T_WHITESPACE"," ",124],["T_FUNCTION","function",124],["T_WHITESPACE"," ",124],["T_STRING","getVirtualGridColumns",124],"(",")",["T_WHITESPACE","\n    ",124],"{",["T_WHITESPACE","\n        ",125],["T_IF","if",126],["T_WHITESPACE"," ",126],"(",["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","_virtualGridColumns",126],["T_WHITESPACE"," ",126],["T_IS_IDENTICAL","===",126],["T_WHITESPACE"," ",126],["T_STRING","null",126],")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n            ",126],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","_initVirtualGridColumns",127],"(",")",";",["T_WHITESPACE","\n        ",127],"}",["T_WHITESPACE","\n\n        ",128],["T_RETURN","return",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","_virtualGridColumns",130],";",["T_WHITESPACE","\n    ",130],"}",["T_WHITESPACE","\n\n    ",131],["T_DOC_COMMENT","\/**\n     * Init virtual grid records for entity\n     *\n     * @return Mage_Sales_Model_Resource_Order_Abstract\n     *\/",133],["T_WHITESPACE","\n    ",137],["T_PROTECTED","protected",138],["T_WHITESPACE"," ",138],["T_FUNCTION","function",138],["T_WHITESPACE"," ",138],["T_STRING","_initVirtualGridColumns",138],"(",")",["T_WHITESPACE","\n    ",138],"{",["T_WHITESPACE","\n        ",139],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","_virtualGridColumns",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_ARRAY","array",140],"(",")",";",["T_WHITESPACE","\n        ",140],["T_IF","if",141],["T_WHITESPACE"," ",141],"(",["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","_eventPrefix",141],["T_WHITESPACE"," ",141],["T_BOOLEAN_AND","&&",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","_eventObject",141],")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n            ",141],["T_STRING","Mage",142],["T_DOUBLE_COLON","::",142],["T_STRING","dispatchEvent",142],"(",["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","_eventPrefix",142],["T_WHITESPACE"," ",142],".",["T_WHITESPACE"," ",142],["T_CONSTANT_ENCAPSED_STRING","'_init_virtual_grid_columns'",142],",",["T_WHITESPACE"," ",142],["T_ARRAY","array",142],"(",["T_WHITESPACE","\n                ",142],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","_eventObject",143],["T_WHITESPACE"," ",143],["T_DOUBLE_ARROW","=>",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_WHITESPACE","\n            ",143],")",")",";",["T_WHITESPACE","\n        ",144],"}",["T_WHITESPACE","\n        ",145],["T_RETURN","return",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$this",146],";",["T_WHITESPACE","\n    ",146],"}",["T_WHITESPACE","\n\n    ",147],["T_DOC_COMMENT","\/**\n     * Update records in grid table\n     *\n     * @param array|int $ids\n     * @return Mage_Sales_Model_Resource_Order_Abstract\n     *\/",149],["T_WHITESPACE","\n    ",154],["T_PUBLIC","public",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","updateGridRecords",155],"(",["T_VARIABLE","$ids",155],")",["T_WHITESPACE","\n    ",155],"{",["T_WHITESPACE","\n        ",156],["T_IF","if",157],["T_WHITESPACE"," ",157],"(",["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","_grid",157],")",["T_WHITESPACE"," ",157],"{",["T_WHITESPACE","\n            ",157],["T_IF","if",158],["T_WHITESPACE"," ",158],"(","!",["T_STRING","is_array",158],"(",["T_VARIABLE","$ids",158],")",")",["T_WHITESPACE"," ",158],"{",["T_WHITESPACE","\n                ",158],["T_VARIABLE","$ids",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_ARRAY","array",159],"(",["T_VARIABLE","$ids",159],")",";",["T_WHITESPACE","\n            ",159],"}",["T_WHITESPACE","\n\n            ",160],["T_IF","if",162],["T_WHITESPACE"," ",162],"(",["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","_eventPrefix",162],["T_WHITESPACE"," ",162],["T_BOOLEAN_AND","&&",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","_eventObject",162],")",["T_WHITESPACE"," ",162],"{",["T_WHITESPACE","\n                ",162],["T_VARIABLE","$proxy",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_NEW","new",163],["T_WHITESPACE"," ",163],["T_STRING","Varien_Object",163],"(",")",";",["T_WHITESPACE","\n                ",163],["T_VARIABLE","$proxy",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","setIds",164],"(",["T_VARIABLE","$ids",164],")",["T_WHITESPACE","\n                    ",164],["T_OBJECT_OPERATOR","->",165],["T_STRING","setData",165],"(",["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","_eventObject",165],",",["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],")",";",["T_WHITESPACE","\n\n                ",165],["T_STRING","Mage",167],["T_DOUBLE_COLON","::",167],["T_STRING","dispatchEvent",167],"(",["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","_eventPrefix",167],["T_WHITESPACE"," ",167],".",["T_WHITESPACE"," ",167],["T_CONSTANT_ENCAPSED_STRING","'_update_grid_records'",167],",",["T_WHITESPACE"," ",167],["T_ARRAY","array",167],"(",["T_CONSTANT_ENCAPSED_STRING","'proxy'",167],["T_WHITESPACE"," ",167],["T_DOUBLE_ARROW","=>",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$proxy",167],")",")",";",["T_WHITESPACE","\n                ",167],["T_VARIABLE","$ids",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_VARIABLE","$proxy",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","getIds",168],"(",")",";",["T_WHITESPACE","\n            ",168],"}",["T_WHITESPACE","\n\n            ",169],["T_IF","if",171],["T_WHITESPACE"," ",171],"(",["T_EMPTY","empty",171],"(",["T_VARIABLE","$ids",171],")",")",["T_WHITESPACE"," ",171],"{",["T_WHITESPACE"," ",171],["T_COMMENT","\/\/ If nothing to update\n",171],["T_WHITESPACE","                ",172],["T_RETURN","return",172],["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],";",["T_WHITESPACE","\n            ",172],"}",["T_WHITESPACE","\n            ",173],["T_VARIABLE","$columnsToSelect",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_ARRAY","array",174],"(",")",";",["T_WHITESPACE","\n            ",174],["T_VARIABLE","$table",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","getGridTable",175],"(",")",";",["T_WHITESPACE","\n            ",175],["T_VARIABLE","$select",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","getUpdateGridRecordsSelect",176],"(",["T_VARIABLE","$ids",176],",",["T_WHITESPACE"," ",176],["T_VARIABLE","$columnsToSelect",176],")",";",["T_WHITESPACE","\n            ",176],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","_getWriteAdapter",177],"(",")",["T_OBJECT_OPERATOR","->",177],["T_STRING","query",177],"(",["T_VARIABLE","$select",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","insertFromSelect",177],"(",["T_VARIABLE","$table",177],",",["T_WHITESPACE"," ",177],["T_VARIABLE","$columnsToSelect",177],",",["T_WHITESPACE"," ",177],["T_STRING","true",177],")",")",";",["T_WHITESPACE","\n        ",177],"}",["T_WHITESPACE","\n\n        ",178],["T_RETURN","return",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$this",180],";",["T_WHITESPACE","\n    ",180],"}",["T_WHITESPACE","\n\n    ",181],["T_DOC_COMMENT","\/**\n     * Retrieve update grid records select\n     *\n     * @param array $ids\n     * @param array $flatColumnsToSelect\n     * @param array|null $gridColumns\n     * @return Varien_Db_Select\n     *\/",183],["T_WHITESPACE","\n    ",190],["T_PUBLIC","public",191],["T_WHITESPACE"," ",191],["T_FUNCTION","function",191],["T_WHITESPACE"," ",191],["T_STRING","getUpdateGridRecordsSelect",191],"(",["T_VARIABLE","$ids",191],",",["T_WHITESPACE"," ",191],"&",["T_VARIABLE","$flatColumnsToSelect",191],",",["T_WHITESPACE"," ",191],["T_VARIABLE","$gridColumns",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_STRING","null",191],")",["T_WHITESPACE","\n    ",191],"{",["T_WHITESPACE","\n        ",192],["T_VARIABLE","$flatColumns",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_STRING","array_keys",193],"(",["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","_getReadAdapter",193],"(",")",["T_WHITESPACE","\n            ",193],["T_OBJECT_OPERATOR","->",194],["T_STRING","describeTable",194],"(",["T_WHITESPACE","\n                ",194],["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","getMainTable",195],"(",")",["T_WHITESPACE","\n            ",195],")",["T_WHITESPACE","\n        ",196],")",";",["T_WHITESPACE","\n\n        ",197],["T_IF","if",199],["T_WHITESPACE"," ",199],"(",["T_VARIABLE","$gridColumns",199],["T_WHITESPACE"," ",199],["T_IS_IDENTICAL","===",199],["T_WHITESPACE"," ",199],["T_STRING","null",199],")",["T_WHITESPACE"," ",199],"{",["T_WHITESPACE","\n            ",199],["T_VARIABLE","$gridColumns",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","getGridColumns",200],"(",")",";",["T_WHITESPACE","\n        ",200],"}",["T_WHITESPACE","\n\n        ",201],["T_VARIABLE","$flatColumnsToSelect",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_STRING","array_intersect",203],"(",["T_VARIABLE","$flatColumns",203],",",["T_WHITESPACE"," ",203],["T_VARIABLE","$gridColumns",203],")",";",["T_WHITESPACE","\n\n        ",203],["T_VARIABLE","$select",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","_getWriteAdapter",205],"(",")",["T_OBJECT_OPERATOR","->",205],["T_STRING","select",205],"(",")",["T_WHITESPACE","\n                ",205],["T_OBJECT_OPERATOR","->",206],["T_STRING","from",206],"(",["T_ARRAY","array",206],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table'",206],["T_WHITESPACE"," ",206],["T_DOUBLE_ARROW","=>",206],["T_WHITESPACE"," ",206],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","getMainTable",206],"(",")",")",",",["T_WHITESPACE"," ",206],["T_VARIABLE","$flatColumnsToSelect",206],")",["T_WHITESPACE","\n                ",206],["T_OBJECT_OPERATOR","->",207],["T_STRING","where",207],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.'",207],["T_WHITESPACE"," ",207],".",["T_WHITESPACE"," ",207],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","getIdFieldName",207],"(",")",["T_WHITESPACE"," ",207],".",["T_WHITESPACE"," ",207],["T_CONSTANT_ENCAPSED_STRING","' IN(?)'",207],",",["T_WHITESPACE"," ",207],["T_VARIABLE","$ids",207],")",";",["T_WHITESPACE","\n\n        ",207],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","joinVirtualGridColumnsToSelect",209],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table'",209],",",["T_WHITESPACE"," ",209],["T_VARIABLE","$select",209],",",["T_WHITESPACE"," ",209],["T_VARIABLE","$flatColumnsToSelect",209],")",";",["T_WHITESPACE","\n\n        ",209],["T_RETURN","return",211],["T_WHITESPACE"," ",211],["T_VARIABLE","$select",211],";",["T_WHITESPACE","\n    ",211],"}",["T_WHITESPACE","\n\n    ",212],["T_DOC_COMMENT","\/**\n     * Join virtual grid columns to select\n     *\n     * @param string $mainTableAlias\n     * @param Zend_Db_Select $select\n     * @param array $columnsToSelect\n     * @return Mage_Sales_Model_Resource_Order_Abstract\n     *\/",214],["T_WHITESPACE","\n    ",221],["T_PUBLIC","public",222],["T_WHITESPACE"," ",222],["T_FUNCTION","function",222],["T_WHITESPACE"," ",222],["T_STRING","joinVirtualGridColumnsToSelect",222],"(",["T_VARIABLE","$mainTableAlias",222],",",["T_WHITESPACE"," ",222],["T_STRING","Zend_Db_Select",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$select",222],",",["T_WHITESPACE"," ",222],"&",["T_VARIABLE","$columnsToSelect",222],")",["T_WHITESPACE","\n    ",222],"{",["T_WHITESPACE","\n        ",223],["T_VARIABLE","$adapter",224],["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","_getWriteAdapter",224],"(",")",";",["T_WHITESPACE","\n        ",224],["T_FOREACH","foreach",225],["T_WHITESPACE"," ",225],"(",["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","getVirtualGridColumns",225],"(",")",["T_WHITESPACE"," ",225],["T_AS","as",225],["T_WHITESPACE"," ",225],["T_VARIABLE","$alias",225],["T_WHITESPACE"," ",225],["T_DOUBLE_ARROW","=>",225],["T_WHITESPACE"," ",225],["T_VARIABLE","$expression",225],")",["T_WHITESPACE"," ",225],"{",["T_WHITESPACE","\n            ",225],["T_LIST","list",226],"(",["T_VARIABLE","$table",226],",",["T_WHITESPACE"," ",226],["T_VARIABLE","$joinCondition",226],",",["T_WHITESPACE"," ",226],["T_VARIABLE","$column",226],")",["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_VARIABLE","$expression",226],";",["T_WHITESPACE","\n            ",226],["T_VARIABLE","$tableAlias",227],["T_WHITESPACE"," ",227],"=",["T_WHITESPACE"," ",227],["T_CONSTANT_ENCAPSED_STRING","'table_'",227],["T_WHITESPACE"," ",227],".",["T_WHITESPACE"," ",227],["T_VARIABLE","$alias",227],";",["T_WHITESPACE","\n\n            ",227],["T_VARIABLE","$joinConditionExpr",229],["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],["T_ARRAY","array",229],"(",")",";",["T_WHITESPACE","\n            ",229],["T_FOREACH","foreach",230],["T_WHITESPACE"," ",230],"(",["T_VARIABLE","$joinCondition",230],["T_WHITESPACE"," ",230],["T_AS","as",230],["T_WHITESPACE"," ",230],["T_VARIABLE","$fkField",230],["T_DOUBLE_ARROW","=>",230],["T_VARIABLE","$pkField",230],")",["T_WHITESPACE"," ",230],"{",["T_WHITESPACE","\n                ",230],["T_VARIABLE","$pkField",231],["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],["T_VARIABLE","$adapter",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","quoteIdentifier",231],"(",["T_WHITESPACE","\n                    ",231],["T_VARIABLE","$tableAlias",232],["T_WHITESPACE"," ",232],".",["T_WHITESPACE"," ",232],["T_CONSTANT_ENCAPSED_STRING","'.'",232],["T_WHITESPACE"," ",232],".",["T_WHITESPACE"," ",232],["T_VARIABLE","$pkField",232],["T_WHITESPACE","\n                ",232],")",";",["T_WHITESPACE","\n                ",233],["T_VARIABLE","$fkField",234],["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_VARIABLE","$adapter",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","quoteIdentifier",234],"(",["T_WHITESPACE","\n                    ",234],["T_VARIABLE","$mainTableAlias",235],["T_WHITESPACE"," ",235],".",["T_WHITESPACE"," ",235],["T_CONSTANT_ENCAPSED_STRING","'.'",235],["T_WHITESPACE"," ",235],".",["T_WHITESPACE"," ",235],["T_VARIABLE","$fkField",235],["T_WHITESPACE","\n                ",235],")",";",["T_WHITESPACE","\n                ",236],["T_VARIABLE","$joinConditionExpr",237],"[","]",["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_VARIABLE","$fkField",237],["T_WHITESPACE"," ",237],".",["T_WHITESPACE"," ",237],["T_CONSTANT_ENCAPSED_STRING","'='",237],["T_WHITESPACE"," ",237],".",["T_WHITESPACE"," ",237],["T_VARIABLE","$pkField",237],";",["T_WHITESPACE","\n            ",237],"}",["T_WHITESPACE","\n\n            ",238],["T_VARIABLE","$select",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","joinLeft",240],"(",["T_WHITESPACE","\n                ",240],["T_ARRAY","array",241],"(",["T_VARIABLE","$tableAlias",241],["T_DOUBLE_ARROW","=>",241],["T_WHITESPACE"," ",241],["T_VARIABLE","$table",241],")",",",["T_WHITESPACE","\n                ",241],["T_STRING","implode",242],"(",["T_CONSTANT_ENCAPSED_STRING","' AND '",242],",",["T_WHITESPACE"," ",242],["T_VARIABLE","$joinConditionExpr",242],")",",",["T_WHITESPACE","\n                ",242],["T_ARRAY","array",243],"(",["T_VARIABLE","$alias",243],["T_WHITESPACE"," ",243],["T_DOUBLE_ARROW","=>",243],["T_WHITESPACE"," ",243],["T_STRING","str_replace",243],"(",["T_CONSTANT_ENCAPSED_STRING","'{{table}}'",243],",",["T_WHITESPACE"," ",243],["T_VARIABLE","$tableAlias",243],",",["T_WHITESPACE"," ",243],["T_VARIABLE","$column",243],")",")",["T_WHITESPACE","\n            ",243],")",";",["T_WHITESPACE","\n\n            ",244],["T_VARIABLE","$columnsToSelect",246],"[","]",["T_WHITESPACE"," ",246],"=",["T_WHITESPACE"," ",246],["T_VARIABLE","$alias",246],";",["T_WHITESPACE","\n        ",246],"}",["T_WHITESPACE","\n\n        ",247],["T_RETURN","return",249],["T_WHITESPACE"," ",249],["T_VARIABLE","$this",249],";",["T_WHITESPACE","\n    ",249],"}",["T_WHITESPACE","\n\n    ",250],["T_DOC_COMMENT","\/**\n     * Retrieve list of grid columns\n     *\n     * @return array\n     *\/",252],["T_WHITESPACE","\n    ",256],["T_PUBLIC","public",257],["T_WHITESPACE"," ",257],["T_FUNCTION","function",257],["T_WHITESPACE"," ",257],["T_STRING","getGridColumns",257],"(",")",["T_WHITESPACE","\n    ",257],"{",["T_WHITESPACE","\n        ",258],["T_IF","if",259],["T_WHITESPACE"," ",259],"(",["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","_gridColumns",259],["T_WHITESPACE"," ",259],["T_IS_IDENTICAL","===",259],["T_WHITESPACE"," ",259],["T_STRING","null",259],")",["T_WHITESPACE"," ",259],"{",["T_WHITESPACE","\n            ",259],["T_IF","if",260],["T_WHITESPACE"," ",260],"(",["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","_grid",260],")",["T_WHITESPACE"," ",260],"{",["T_WHITESPACE","\n                ",260],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","_gridColumns",261],["T_WHITESPACE"," ",261],"=",["T_WHITESPACE"," ",261],["T_STRING","array_keys",261],"(",["T_WHITESPACE","\n                    ",261],["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","_getReadAdapter",262],"(",")",["T_OBJECT_OPERATOR","->",262],["T_STRING","describeTable",262],"(",["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","getGridTable",262],"(",")",")",["T_WHITESPACE","\n                ",262],")",";",["T_WHITESPACE","\n            ",263],"}",["T_WHITESPACE"," ",264],["T_ELSE","else",264],["T_WHITESPACE"," ",264],"{",["T_WHITESPACE","\n                ",264],["T_VARIABLE","$this",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","_gridColumns",265],["T_WHITESPACE"," ",265],"=",["T_WHITESPACE"," ",265],["T_ARRAY","array",265],"(",")",";",["T_WHITESPACE","\n            ",265],"}",["T_WHITESPACE","\n        ",266],"}",["T_WHITESPACE","\n\n        ",267],["T_RETURN","return",269],["T_WHITESPACE"," ",269],["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","_gridColumns",269],";",["T_WHITESPACE","\n    ",269],"}",["T_WHITESPACE","\n\n    ",270],["T_DOC_COMMENT","\/**\n     * Retrieve grid table\n     *\n     * @return string\n     *\/",272],["T_WHITESPACE","\n    ",276],["T_PUBLIC","public",277],["T_WHITESPACE"," ",277],["T_FUNCTION","function",277],["T_WHITESPACE"," ",277],["T_STRING","getGridTable",277],"(",")",["T_WHITESPACE","\n    ",277],"{",["T_WHITESPACE","\n        ",278],["T_IF","if",279],["T_WHITESPACE"," ",279],"(",["T_VARIABLE","$this",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","_grid",279],")",["T_WHITESPACE"," ",279],"{",["T_WHITESPACE","\n            ",279],["T_RETURN","return",280],["T_WHITESPACE"," ",280],["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","getTable",280],"(",["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","_mainTable",280],["T_WHITESPACE"," ",280],".",["T_WHITESPACE"," ",280],["T_CONSTANT_ENCAPSED_STRING","'_grid'",280],")",";",["T_WHITESPACE","\n        ",280],"}",["T_WHITESPACE","\n        ",281],["T_RETURN","return",282],["T_WHITESPACE"," ",282],["T_STRING","false",282],";",["T_WHITESPACE","\n    ",282],"}",["T_WHITESPACE","\n\n    ",283],["T_DOC_COMMENT","\/**\n     * Before save object attribute\n     *\n     * @param Mage_Core_Model_Abstract $object\n     * @param string $attribute\n     * @return Mage_Sales_Model_Resource_Order_Abstract\n     *\/",285],["T_WHITESPACE","\n    ",291],["T_PROTECTED","protected",292],["T_WHITESPACE"," ",292],["T_FUNCTION","function",292],["T_WHITESPACE"," ",292],["T_STRING","_beforeSaveAttribute",292],"(",["T_STRING","Mage_Core_Model_Abstract",292],["T_WHITESPACE"," ",292],["T_VARIABLE","$object",292],",",["T_WHITESPACE"," ",292],["T_VARIABLE","$attribute",292],")",["T_WHITESPACE","\n    ",292],"{",["T_WHITESPACE","\n        ",293],["T_IF","if",294],["T_WHITESPACE"," ",294],"(",["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","_eventObject",294],["T_WHITESPACE"," ",294],["T_BOOLEAN_AND","&&",294],["T_WHITESPACE"," ",294],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","_eventPrefix",294],")",["T_WHITESPACE"," ",294],"{",["T_WHITESPACE","\n            ",294],["T_STRING","Mage",295],["T_DOUBLE_COLON","::",295],["T_STRING","dispatchEvent",295],"(",["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","_eventPrefix",295],["T_WHITESPACE"," ",295],".",["T_WHITESPACE"," ",295],["T_CONSTANT_ENCAPSED_STRING","'_save_attribute_before'",295],",",["T_WHITESPACE"," ",295],["T_ARRAY","array",295],"(",["T_WHITESPACE","\n                ",295],["T_VARIABLE","$this",296],["T_OBJECT_OPERATOR","->",296],["T_STRING","_eventObject",296],["T_WHITESPACE"," ",296],["T_DOUBLE_ARROW","=>",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$this",296],",",["T_WHITESPACE","\n                ",296],["T_CONSTANT_ENCAPSED_STRING","'object'",297],["T_WHITESPACE"," ",297],["T_DOUBLE_ARROW","=>",297],["T_WHITESPACE"," ",297],["T_VARIABLE","$object",297],",",["T_WHITESPACE","\n                ",297],["T_CONSTANT_ENCAPSED_STRING","'attribute'",298],["T_WHITESPACE"," ",298],["T_DOUBLE_ARROW","=>",298],["T_WHITESPACE"," ",298],["T_VARIABLE","$attribute",298],["T_WHITESPACE","\n            ",298],")",")",";",["T_WHITESPACE","\n        ",299],"}",["T_WHITESPACE","\n        ",300],["T_RETURN","return",301],["T_WHITESPACE"," ",301],["T_VARIABLE","$this",301],";",["T_WHITESPACE","\n    ",301],"}",["T_WHITESPACE","\n\n    ",302],["T_DOC_COMMENT","\/**\n     * After save object attribute\n     *\n     * @param Mage_Core_Model_Abstract $object\n     * @param string $attribute\n     * @return Mage_Sales_Model_Resource_Order_Abstract\n     *\/",304],["T_WHITESPACE","\n    ",310],["T_PROTECTED","protected",311],["T_WHITESPACE"," ",311],["T_FUNCTION","function",311],["T_WHITESPACE"," ",311],["T_STRING","_afterSaveAttribute",311],"(",["T_STRING","Mage_Core_Model_Abstract",311],["T_WHITESPACE"," ",311],["T_VARIABLE","$object",311],",",["T_WHITESPACE"," ",311],["T_VARIABLE","$attribute",311],")",["T_WHITESPACE","\n    ",311],"{",["T_WHITESPACE","\n        ",312],["T_IF","if",313],["T_WHITESPACE"," ",313],"(",["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","_eventObject",313],["T_WHITESPACE"," ",313],["T_BOOLEAN_AND","&&",313],["T_WHITESPACE"," ",313],["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","_eventPrefix",313],")",["T_WHITESPACE"," ",313],"{",["T_WHITESPACE","\n            ",313],["T_STRING","Mage",314],["T_DOUBLE_COLON","::",314],["T_STRING","dispatchEvent",314],"(",["T_VARIABLE","$this",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","_eventPrefix",314],["T_WHITESPACE"," ",314],".",["T_WHITESPACE"," ",314],["T_CONSTANT_ENCAPSED_STRING","'_save_attribute_after'",314],",",["T_WHITESPACE"," ",314],["T_ARRAY","array",314],"(",["T_WHITESPACE","\n                ",314],["T_VARIABLE","$this",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","_eventObject",315],["T_WHITESPACE"," ",315],["T_DOUBLE_ARROW","=>",315],["T_WHITESPACE"," ",315],["T_VARIABLE","$this",315],",",["T_WHITESPACE","\n                ",315],["T_CONSTANT_ENCAPSED_STRING","'object'",316],["T_WHITESPACE"," ",316],["T_DOUBLE_ARROW","=>",316],["T_WHITESPACE"," ",316],["T_VARIABLE","$object",316],",",["T_WHITESPACE","\n                ",316],["T_CONSTANT_ENCAPSED_STRING","'attribute'",317],["T_WHITESPACE"," ",317],["T_DOUBLE_ARROW","=>",317],["T_WHITESPACE"," ",317],["T_VARIABLE","$attribute",317],["T_WHITESPACE","\n            ",317],")",")",";",["T_WHITESPACE","\n        ",318],"}",["T_WHITESPACE","\n        ",319],["T_RETURN","return",320],["T_WHITESPACE"," ",320],["T_VARIABLE","$this",320],";",["T_WHITESPACE","\n    ",320],"}",["T_WHITESPACE","\n\n    ",321],["T_DOC_COMMENT","\/**\n     * Perform actions after object save\n     *\n     * @param Mage_Core_Model_Abstract $object\n     * @param string $attribute\n     * @return Mage_Sales_Model_Resource_Order_Abstract\n     *\/",323],["T_WHITESPACE","\n    ",329],["T_PUBLIC","public",330],["T_WHITESPACE"," ",330],["T_FUNCTION","function",330],["T_WHITESPACE"," ",330],["T_STRING","saveAttribute",330],"(",["T_STRING","Mage_Core_Model_Abstract",330],["T_WHITESPACE"," ",330],["T_VARIABLE","$object",330],",",["T_WHITESPACE"," ",330],["T_VARIABLE","$attribute",330],")",["T_WHITESPACE","\n    ",330],"{",["T_WHITESPACE","\n        ",331],["T_IF","if",332],["T_WHITESPACE"," ",332],"(",["T_VARIABLE","$attribute",332],["T_WHITESPACE"," ",332],["T_INSTANCEOF","instanceof",332],["T_WHITESPACE"," ",332],["T_STRING","Mage_Eav_Model_Entity_Attribute_Abstract",332],")",["T_WHITESPACE"," ",332],"{",["T_WHITESPACE","\n            ",332],["T_VARIABLE","$attribute",333],["T_WHITESPACE"," ",333],"=",["T_WHITESPACE"," ",333],["T_VARIABLE","$attribute",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","getAttributeCode",333],"(",")",";",["T_WHITESPACE","\n        ",333],"}",["T_WHITESPACE","\n\n        ",334],["T_IF","if",336],["T_WHITESPACE"," ",336],"(",["T_STRING","is_string",336],"(",["T_VARIABLE","$attribute",336],")",")",["T_WHITESPACE"," ",336],"{",["T_WHITESPACE","\n            ",336],["T_VARIABLE","$attribute",337],["T_WHITESPACE"," ",337],"=",["T_WHITESPACE"," ",337],["T_ARRAY","array",337],"(",["T_VARIABLE","$attribute",337],")",";",["T_WHITESPACE","\n        ",337],"}",["T_WHITESPACE","\n\n        ",338],["T_IF","if",340],["T_WHITESPACE"," ",340],"(",["T_STRING","is_array",340],"(",["T_VARIABLE","$attribute",340],")",["T_WHITESPACE"," ",340],["T_BOOLEAN_AND","&&",340],["T_WHITESPACE"," ",340],"!",["T_EMPTY","empty",340],"(",["T_VARIABLE","$attribute",340],")",")",["T_WHITESPACE"," ",340],"{",["T_WHITESPACE","\n            ",340],["T_VARIABLE","$this",341],["T_OBJECT_OPERATOR","->",341],["T_STRING","beginTransaction",341],"(",")",";",["T_WHITESPACE","\n            ",341],["T_TRY","try",342],["T_WHITESPACE"," ",342],"{",["T_WHITESPACE","\n                ",342],["T_VARIABLE","$this",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","_beforeSaveAttribute",343],"(",["T_VARIABLE","$object",343],",",["T_WHITESPACE"," ",343],["T_VARIABLE","$attribute",343],")",";",["T_WHITESPACE","\n                ",343],["T_VARIABLE","$data",344],["T_WHITESPACE"," ",344],"=",["T_WHITESPACE"," ",344],["T_NEW","new",344],["T_WHITESPACE"," ",344],["T_STRING","Varien_Object",344],"(",")",";",["T_WHITESPACE","\n                ",344],["T_FOREACH","foreach",345],["T_WHITESPACE"," ",345],"(",["T_VARIABLE","$attribute",345],["T_WHITESPACE"," ",345],["T_AS","as",345],["T_WHITESPACE"," ",345],["T_VARIABLE","$code",345],")",["T_WHITESPACE"," ",345],"{",["T_WHITESPACE","\n                    ",345],["T_VARIABLE","$data",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","setData",346],"(",["T_VARIABLE","$code",346],",",["T_WHITESPACE"," ",346],["T_VARIABLE","$object",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","getData",346],"(",["T_VARIABLE","$code",346],")",")",";",["T_WHITESPACE","\n                ",346],"}",["T_WHITESPACE","\n\n                ",347],["T_VARIABLE","$updateArray",349],["T_WHITESPACE"," ",349],"=",["T_WHITESPACE"," ",349],["T_VARIABLE","$this",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","_prepareDataForTable",349],"(",["T_VARIABLE","$data",349],",",["T_WHITESPACE"," ",349],["T_VARIABLE","$this",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","getMainTable",349],"(",")",")",";",["T_WHITESPACE","\n                ",349],["T_VARIABLE","$this",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","_postSaveFieldsUpdate",350],"(",["T_VARIABLE","$object",350],",",["T_WHITESPACE"," ",350],["T_VARIABLE","$updateArray",350],")",";",["T_WHITESPACE","\n                ",350],["T_IF","if",351],["T_WHITESPACE"," ",351],"(","!",["T_VARIABLE","$object",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","getForceUpdateGridRecords",351],"(",")",["T_WHITESPACE"," ",351],["T_BOOLEAN_AND","&&",351],["T_WHITESPACE","\n                    ",351],["T_STRING","count",352],"(",["T_STRING","array_intersect",352],"(",["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","getGridColumns",352],"(",")",",",["T_WHITESPACE"," ",352],["T_VARIABLE","$attribute",352],")",")",["T_WHITESPACE"," ",352],">",["T_WHITESPACE"," ",352],["T_LNUMBER","0",352],["T_WHITESPACE","\n                ",352],")",["T_WHITESPACE"," ",353],"{",["T_WHITESPACE","\n                    ",353],["T_VARIABLE","$this",354],["T_OBJECT_OPERATOR","->",354],["T_STRING","updateGridRecords",354],"(",["T_VARIABLE","$object",354],["T_OBJECT_OPERATOR","->",354],["T_STRING","getId",354],"(",")",")",";",["T_WHITESPACE","\n                ",354],"}",["T_WHITESPACE","\n                ",355],["T_VARIABLE","$this",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","_afterSaveAttribute",356],"(",["T_VARIABLE","$object",356],",",["T_WHITESPACE"," ",356],["T_VARIABLE","$attribute",356],")",";",["T_WHITESPACE","\n                ",356],["T_VARIABLE","$this",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","commit",357],"(",")",";",["T_WHITESPACE","\n            ",357],"}",["T_WHITESPACE"," ",358],["T_CATCH","catch",358],["T_WHITESPACE"," ",358],"(",["T_STRING","Exception",358],["T_WHITESPACE"," ",358],["T_VARIABLE","$e",358],")",["T_WHITESPACE"," ",358],"{",["T_WHITESPACE","\n                ",358],["T_VARIABLE","$this",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","rollBack",359],"(",")",";",["T_WHITESPACE","\n                ",359],["T_THROW","throw",360],["T_WHITESPACE"," ",360],["T_VARIABLE","$e",360],";",["T_WHITESPACE","\n            ",360],"}",["T_WHITESPACE","\n        ",361],"}",["T_WHITESPACE","\n\n        ",362],["T_RETURN","return",364],["T_WHITESPACE"," ",364],["T_VARIABLE","$this",364],";",["T_WHITESPACE","\n    ",364],"}",["T_WHITESPACE","\n\n    ",365],["T_DOC_COMMENT","\/**\n     * Perform actions before object save\n     *\n     * @param Varien_Object $object\n     * @return Mage_Sales_Model_Resource_Order_Abstract\n     *\/",367],["T_WHITESPACE","\n    ",372],["T_PROTECTED","protected",373],["T_WHITESPACE"," ",373],["T_FUNCTION","function",373],["T_WHITESPACE"," ",373],["T_STRING","_beforeSave",373],"(",["T_STRING","Mage_Core_Model_Abstract",373],["T_WHITESPACE"," ",373],["T_VARIABLE","$object",373],")",["T_WHITESPACE","\n    ",373],"{",["T_WHITESPACE","\n        ",374],["T_IF","if",375],["T_WHITESPACE"," ",375],"(",["T_VARIABLE","$this",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","_useIncrementId",375],["T_WHITESPACE"," ",375],["T_BOOLEAN_AND","&&",375],["T_WHITESPACE"," ",375],"!",["T_VARIABLE","$object",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","getIncrementId",375],"(",")",")",["T_WHITESPACE"," ",375],"{",["T_WHITESPACE","\n            ",375],["T_COMMENT","\/* @var $entityType Mage_Eav_Model_Entity_Type *\/",376],["T_WHITESPACE","\n            ",376],["T_VARIABLE","$entityType",377],["T_WHITESPACE"," ",377],"=",["T_WHITESPACE"," ",377],["T_STRING","Mage",377],["T_DOUBLE_COLON","::",377],["T_STRING","getModel",377],"(",["T_CONSTANT_ENCAPSED_STRING","'eav\/entity_type'",377],")",["T_OBJECT_OPERATOR","->",377],["T_STRING","loadByCode",377],"(",["T_VARIABLE","$this",377],["T_OBJECT_OPERATOR","->",377],["T_STRING","_entityTypeForIncrementId",377],")",";",["T_WHITESPACE","\n            ",377],["T_VARIABLE","$object",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","setIncrementId",378],"(",["T_VARIABLE","$entityType",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","fetchNewIncrementId",378],"(",["T_VARIABLE","$object",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","getStoreId",378],"(",")",")",")",";",["T_WHITESPACE","\n        ",378],"}",["T_WHITESPACE","\n        ",379],["T_STRING","parent",380],["T_DOUBLE_COLON","::",380],["T_STRING","_beforeSave",380],"(",["T_VARIABLE","$object",380],")",";",["T_WHITESPACE","\n        ",380],["T_RETURN","return",381],["T_WHITESPACE"," ",381],["T_VARIABLE","$this",381],";",["T_WHITESPACE","\n    ",381],"}",["T_WHITESPACE","\n\n    ",382],["T_DOC_COMMENT","\/**\n     * Update field in table if model have been already saved\n     *\n     * @param Mage_Core_Model_Abstract $object\n     * @param array $data\n     * @return Mage_Sales_Model_Resource_Order_Abstract\n     *\/",384],["T_WHITESPACE","\n    ",390],["T_PROTECTED","protected",391],["T_WHITESPACE"," ",391],["T_FUNCTION","function",391],["T_WHITESPACE"," ",391],["T_STRING","_postSaveFieldsUpdate",391],"(",["T_VARIABLE","$object",391],",",["T_WHITESPACE"," ",391],["T_VARIABLE","$data",391],")",["T_WHITESPACE","\n    ",391],"{",["T_WHITESPACE","\n        ",392],["T_IF","if",393],["T_WHITESPACE"," ",393],"(",["T_VARIABLE","$object",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","getId",393],"(",")",["T_WHITESPACE"," ",393],["T_BOOLEAN_AND","&&",393],["T_WHITESPACE"," ",393],"!",["T_EMPTY","empty",393],"(",["T_VARIABLE","$data",393],")",")",["T_WHITESPACE"," ",393],"{",["T_WHITESPACE","\n            ",393],["T_VARIABLE","$table",394],["T_WHITESPACE"," ",394],"=",["T_WHITESPACE"," ",394],["T_VARIABLE","$this",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","getMainTable",394],"(",")",";",["T_WHITESPACE","\n            ",394],["T_VARIABLE","$this",395],["T_OBJECT_OPERATOR","->",395],["T_STRING","_getWriteAdapter",395],"(",")",["T_OBJECT_OPERATOR","->",395],["T_STRING","update",395],"(",["T_VARIABLE","$table",395],",",["T_WHITESPACE"," ",395],["T_VARIABLE","$data",395],",",["T_WHITESPACE","\n                ",395],["T_ARRAY","array",396],"(",["T_VARIABLE","$this",396],["T_OBJECT_OPERATOR","->",396],["T_STRING","getIdFieldName",396],"(",")",["T_WHITESPACE"," ",396],".",["T_WHITESPACE"," ",396],["T_CONSTANT_ENCAPSED_STRING","'=?'",396],["T_WHITESPACE"," ",396],["T_DOUBLE_ARROW","=>",396],["T_WHITESPACE"," ",396],["T_INT_CAST","(int)",396],["T_WHITESPACE"," ",396],["T_VARIABLE","$object",396],["T_OBJECT_OPERATOR","->",396],["T_STRING","getId",396],"(",")",")",["T_WHITESPACE","\n            ",396],")",";",["T_WHITESPACE","\n            ",397],["T_VARIABLE","$object",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","addData",398],"(",["T_VARIABLE","$data",398],")",";",["T_WHITESPACE","\n        ",398],"}",["T_WHITESPACE","\n\n        ",399],["T_RETURN","return",401],["T_WHITESPACE"," ",401],["T_VARIABLE","$this",401],";",["T_WHITESPACE","\n    ",401],"}",["T_WHITESPACE","\n\n    ",402],["T_DOC_COMMENT","\/**\n     * Set main resource table\n     *\n     * @param string $table\n     * @return Mage_Sales_Model_Resource_Order_Abstract\n     *\/",404],["T_WHITESPACE","\n    ",409],["T_PUBLIC","public",410],["T_WHITESPACE"," ",410],["T_FUNCTION","function",410],["T_WHITESPACE"," ",410],["T_STRING","setMainTable",410],"(",["T_VARIABLE","$table",410],")",["T_WHITESPACE","\n    ",410],"{",["T_WHITESPACE","\n        ",411],["T_VARIABLE","$this",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","_mainTable",412],["T_WHITESPACE"," ",412],"=",["T_WHITESPACE"," ",412],["T_VARIABLE","$table",412],";",["T_WHITESPACE","\n        ",412],["T_RETURN","return",413],["T_WHITESPACE"," ",413],["T_VARIABLE","$this",413],";",["T_WHITESPACE","\n    ",413],"}",["T_WHITESPACE","\n\n    ",414],["T_DOC_COMMENT","\/**\n     * Save object data\n     *\n     * @param Mage_Core_Model_Abstract $object\n     * @return Mage_Sales_Model_Resource_Order_Abstract\n     *\/",416],["T_WHITESPACE","\n    ",421],["T_PUBLIC","public",422],["T_WHITESPACE"," ",422],["T_FUNCTION","function",422],["T_WHITESPACE"," ",422],["T_STRING","save",422],"(",["T_STRING","Mage_Core_Model_Abstract",422],["T_WHITESPACE"," ",422],["T_VARIABLE","$object",422],")",["T_WHITESPACE","\n    ",422],"{",["T_WHITESPACE","\n        ",423],["T_IF","if",424],["T_WHITESPACE"," ",424],"(","!",["T_VARIABLE","$object",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","getForceObjectSave",424],"(",")",")",["T_WHITESPACE"," ",424],"{",["T_WHITESPACE","\n            ",424],["T_STRING","parent",425],["T_DOUBLE_COLON","::",425],["T_STRING","save",425],"(",["T_VARIABLE","$object",425],")",";",["T_WHITESPACE","\n        ",425],"}",["T_WHITESPACE","\n\n        ",426],["T_RETURN","return",428],["T_WHITESPACE"," ",428],["T_VARIABLE","$this",428],";",["T_WHITESPACE","\n    ",428],"}",["T_WHITESPACE","\n\n    ",429],["T_DOC_COMMENT","\/**\n     * Update grid table on entity update\n     *\n     * @param string $field\n     * @param int $entityId\n     * @return Mage_Sales_Model_Resource_Order_Abstract\n     *\/",431],["T_WHITESPACE","\n    ",437],["T_PUBLIC","public",438],["T_WHITESPACE"," ",438],["T_FUNCTION","function",438],["T_WHITESPACE"," ",438],["T_STRING","updateOnRelatedRecordChanged",438],"(",["T_VARIABLE","$field",438],",",["T_WHITESPACE"," ",438],["T_VARIABLE","$entityId",438],")",["T_WHITESPACE","\n    ",438],"{",["T_WHITESPACE","\n        ",439],["T_VARIABLE","$adapter",440],["T_WHITESPACE"," ",440],"=",["T_WHITESPACE"," ",440],["T_VARIABLE","$this",440],["T_OBJECT_OPERATOR","->",440],["T_STRING","_getWriteAdapter",440],"(",")",";",["T_WHITESPACE","\n        ",440],["T_VARIABLE","$column",441],["T_WHITESPACE"," ",441],"=",["T_WHITESPACE"," ",441],["T_ARRAY","array",441],"(",")",";",["T_WHITESPACE","\n        ",441],["T_VARIABLE","$select",442],["T_WHITESPACE"," ",442],"=",["T_WHITESPACE"," ",442],["T_VARIABLE","$adapter",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","select",442],"(",")",["T_WHITESPACE","\n            ",442],["T_OBJECT_OPERATOR","->",443],["T_STRING","from",443],"(",["T_ARRAY","array",443],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table'",443],["T_WHITESPACE"," ",443],["T_DOUBLE_ARROW","=>",443],["T_WHITESPACE"," ",443],["T_VARIABLE","$this",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","getMainTable",443],"(",")",")",",",["T_WHITESPACE"," ",443],["T_VARIABLE","$column",443],")",["T_WHITESPACE","\n            ",443],["T_OBJECT_OPERATOR","->",444],["T_STRING","where",444],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.'",444],["T_WHITESPACE"," ",444],".",["T_WHITESPACE"," ",444],["T_VARIABLE","$field",444],["T_WHITESPACE"," ",444],".",["T_CONSTANT_ENCAPSED_STRING","' = ?'",444],",",["T_WHITESPACE"," ",444],["T_VARIABLE","$entityId",444],")",";",["T_WHITESPACE","\n        ",444],["T_VARIABLE","$this",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","joinVirtualGridColumnsToSelect",445],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table'",445],",",["T_WHITESPACE"," ",445],["T_VARIABLE","$select",445],",",["T_WHITESPACE"," ",445],["T_VARIABLE","$column",445],")",";",["T_WHITESPACE","\n        ",445],["T_VARIABLE","$fieldsToUpdate",446],["T_WHITESPACE"," ",446],"=",["T_WHITESPACE"," ",446],["T_VARIABLE","$adapter",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","fetchRow",446],"(",["T_VARIABLE","$select",446],")",";",["T_WHITESPACE","\n        ",446],["T_IF","if",447],["T_WHITESPACE"," ",447],"(",["T_VARIABLE","$fieldsToUpdate",447],")",["T_WHITESPACE"," ",447],"{",["T_WHITESPACE","\n            ",447],["T_VARIABLE","$adapter",448],["T_OBJECT_OPERATOR","->",448],["T_STRING","update",448],"(",["T_WHITESPACE","\n                ",448],["T_VARIABLE","$this",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","getGridTable",449],"(",")",",",["T_WHITESPACE","\n                ",449],["T_VARIABLE","$fieldsToUpdate",450],",",["T_WHITESPACE","\n                ",450],["T_VARIABLE","$adapter",451],["T_OBJECT_OPERATOR","->",451],["T_STRING","quoteInto",451],"(",["T_VARIABLE","$this",451],["T_OBJECT_OPERATOR","->",451],["T_STRING","getGridTable",451],"(",")",["T_WHITESPACE"," ",451],".",["T_WHITESPACE"," ",451],["T_CONSTANT_ENCAPSED_STRING","'.'",451],["T_WHITESPACE"," ",451],".",["T_WHITESPACE"," ",451],["T_VARIABLE","$field",451],["T_WHITESPACE"," ",451],".",["T_WHITESPACE"," ",451],["T_CONSTANT_ENCAPSED_STRING","' = ?'",451],",",["T_WHITESPACE"," ",451],["T_VARIABLE","$entityId",451],")",["T_WHITESPACE","\n            ",451],")",";",["T_WHITESPACE","\n        ",452],"}",["T_WHITESPACE","\n        ",453],["T_RETURN","return",454],["T_WHITESPACE"," ",454],["T_VARIABLE","$this",454],";",["T_WHITESPACE","\n    ",454],"}",["T_WHITESPACE","\n",455],"}",["T_WHITESPACE","\n\n",456]]