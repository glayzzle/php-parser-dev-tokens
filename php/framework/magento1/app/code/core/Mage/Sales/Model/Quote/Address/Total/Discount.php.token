[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Sales\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_CLASS","class",28],["T_WHITESPACE"," ",28],["T_STRING","Mage_Sales_Model_Quote_Address_Total_Discount",28],["T_WHITESPACE"," ",28],["T_EXTENDS","extends",28],["T_WHITESPACE"," ",28],["T_STRING","Mage_Sales_Model_Quote_Address_Total_Abstract",28],["T_WHITESPACE","\n",28],"{",["T_WHITESPACE","\n    ",29],["T_PUBLIC","public",30],["T_WHITESPACE"," ",30],["T_FUNCTION","function",30],["T_WHITESPACE"," ",30],["T_STRING","collect",30],"(",["T_STRING","Mage_Sales_Model_Quote_Address",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$address",30],")",["T_WHITESPACE","\n    ",30],"{",["T_WHITESPACE","\n        ",31],["T_VARIABLE","$quote",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_VARIABLE","$address",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","getQuote",32],"(",")",";",["T_WHITESPACE","\n        ",32],["T_VARIABLE","$eventArgs",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_ARRAY","array",33],"(",["T_WHITESPACE","\n            ",33],["T_CONSTANT_ENCAPSED_STRING","'website_id'",34],["T_DOUBLE_ARROW","=>",34],["T_STRING","Mage",34],["T_DOUBLE_COLON","::",34],["T_STRING","app",34],"(",")",["T_OBJECT_OPERATOR","->",34],["T_STRING","getStore",34],"(",["T_VARIABLE","$quote",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","getStoreId",34],"(",")",")",["T_OBJECT_OPERATOR","->",34],["T_STRING","getWebsiteId",34],"(",")",",",["T_WHITESPACE","\n            ",34],["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",35],["T_DOUBLE_ARROW","=>",35],["T_VARIABLE","$quote",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","getCustomerGroupId",35],"(",")",",",["T_WHITESPACE","\n            ",35],["T_CONSTANT_ENCAPSED_STRING","'coupon_code'",36],["T_DOUBLE_ARROW","=>",36],["T_VARIABLE","$quote",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","getCouponCode",36],"(",")",",",["T_WHITESPACE","\n        ",36],")",";",["T_WHITESPACE","\n\n        ",37],["T_VARIABLE","$address",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","setFreeShipping",39],"(",["T_LNUMBER","0",39],")",";",["T_WHITESPACE","\n        ",39],["T_VARIABLE","$totalDiscountAmount",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_LNUMBER","0",40],";",["T_WHITESPACE","\n        ",40],["T_VARIABLE","$subtotalWithDiscount",41],"=",["T_WHITESPACE"," ",41],["T_LNUMBER","0",41],";",["T_WHITESPACE","\n        ",41],["T_VARIABLE","$baseTotalDiscountAmount",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_LNUMBER","0",42],";",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$baseSubtotalWithDiscount",43],"=",["T_WHITESPACE"," ",43],["T_LNUMBER","0",43],";",["T_WHITESPACE","\n\n        ",43],["T_VARIABLE","$items",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_VARIABLE","$address",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","getAllItems",45],"(",")",";",["T_WHITESPACE","\n        ",45],["T_IF","if",46],["T_WHITESPACE"," ",46],"(","!",["T_STRING","count",46],"(",["T_VARIABLE","$items",46],")",")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n            ",46],["T_VARIABLE","$address",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","setDiscountAmount",47],"(",["T_VARIABLE","$totalDiscountAmount",47],")",";",["T_WHITESPACE","\n            ",47],["T_VARIABLE","$address",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","setSubtotalWithDiscount",48],"(",["T_VARIABLE","$subtotalWithDiscount",48],")",";",["T_WHITESPACE","\n            ",48],["T_VARIABLE","$address",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","setBaseDiscountAmount",49],"(",["T_VARIABLE","$baseTotalDiscountAmount",49],")",";",["T_WHITESPACE","\n            ",49],["T_VARIABLE","$address",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","setBaseSubtotalWithDiscount",50],"(",["T_VARIABLE","$baseSubtotalWithDiscount",50],")",";",["T_WHITESPACE","\n            ",50],["T_RETURN","return",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$this",51],";",["T_WHITESPACE","\n        ",51],"}",["T_WHITESPACE","\n\n        ",52],["T_VARIABLE","$hasDiscount",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_STRING","false",54],";",["T_WHITESPACE","\n        ",54],["T_FOREACH","foreach",55],["T_WHITESPACE"," ",55],"(",["T_VARIABLE","$items",55],["T_WHITESPACE"," ",55],["T_AS","as",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$item",55],")",["T_WHITESPACE"," ",55],"{",["T_WHITESPACE","\n            ",55],["T_IF","if",56],["T_WHITESPACE"," ",56],"(",["T_VARIABLE","$item",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","getNoDiscount",56],"(",")",")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n                ",56],["T_VARIABLE","$item",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","setDiscountAmount",57],"(",["T_LNUMBER","0",57],")",";",["T_WHITESPACE","\n                ",57],["T_VARIABLE","$item",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","setBaseDiscountAmount",58],"(",["T_LNUMBER","0",58],")",";",["T_WHITESPACE","\n                ",58],["T_VARIABLE","$item",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","setRowTotalWithDiscount",59],"(",["T_VARIABLE","$item",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","getRowTotal",59],"(",")",")",";",["T_WHITESPACE","\n                ",59],["T_VARIABLE","$item",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","setBaseRowTotalWithDiscount",60],"(",["T_VARIABLE","$item",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","getRowTotal",60],"(",")",")",";",["T_WHITESPACE","\n\n                ",60],["T_VARIABLE","$subtotalWithDiscount",62],["T_PLUS_EQUAL","+=",62],["T_VARIABLE","$item",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","getRowTotal",62],"(",")",";",["T_WHITESPACE","\n                ",62],["T_VARIABLE","$baseSubtotalWithDiscount",63],["T_PLUS_EQUAL","+=",63],["T_VARIABLE","$item",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","getBaseRowTotal",63],"(",")",";",["T_WHITESPACE","\n            ",63],"}",["T_WHITESPACE","\n            ",64],["T_ELSE","else",65],["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n                ",65],["T_DOC_COMMENT","\/**\n                 * Child item discount we calculate for parent\n                 *\/",66],["T_WHITESPACE","\n                ",68],["T_IF","if",69],["T_WHITESPACE"," ",69],"(",["T_VARIABLE","$item",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getParentItemId",69],"(",")",")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n                    ",69],["T_CONTINUE","continue",70],";",["T_WHITESPACE","\n                ",70],"}",["T_WHITESPACE","\n\n                ",71],["T_DOC_COMMENT","\/**\n                 * Composite item discount calculation\n                 *\/",73],["T_WHITESPACE","\n\n                ",75],["T_IF","if",77],["T_WHITESPACE"," ",77],"(",["T_VARIABLE","$item",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getHasChildren",77],"(",")",["T_WHITESPACE"," ",77],["T_BOOLEAN_AND","&&",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$item",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","isChildrenCalculated",77],"(",")",")",["T_WHITESPACE"," ",77],"{",["T_WHITESPACE","\n                    ",77],["T_FOREACH","foreach",78],["T_WHITESPACE"," ",78],"(",["T_VARIABLE","$item",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getChildren",78],"(",")",["T_WHITESPACE"," ",78],["T_AS","as",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$child",78],")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n                        ",78],["T_VARIABLE","$eventArgs",79],"[",["T_CONSTANT_ENCAPSED_STRING","'item'",79],"]",["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$child",79],";",["T_WHITESPACE","\n                        ",79],["T_STRING","Mage",80],["T_DOUBLE_COLON","::",80],["T_STRING","dispatchEvent",80],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_quote_address_discount_item'",80],",",["T_WHITESPACE"," ",80],["T_VARIABLE","$eventArgs",80],")",";",["T_WHITESPACE","\n\n                        ",80],["T_IF","if",82],["T_WHITESPACE"," ",82],"(",["T_VARIABLE","$child",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","getDiscountAmount",82],"(",")",["T_WHITESPACE"," ",82],["T_BOOLEAN_OR","||",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$child",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","getFreeShipping",82],"(",")",")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n                            ",82],["T_VARIABLE","$hasDiscount",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_STRING","true",83],";",["T_WHITESPACE","\n                        ",83],"}",["T_WHITESPACE","\n\n                        ",84],["T_DOC_COMMENT","\/**\n                         * Parent free shipping we apply to all children\n                         *\/",86],["T_WHITESPACE","\n                        ",88],["T_IF","if",89],["T_WHITESPACE"," ",89],"(",["T_VARIABLE","$item",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getFreeShipping",89],"(",")",")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n                            ",89],["T_VARIABLE","$child",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","setFreeShipping",90],"(",["T_VARIABLE","$item",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","getFreeShipping",90],"(",")",")",";",["T_WHITESPACE","\n                        ",90],"}",["T_WHITESPACE","\n\n                        ",91],["T_DOC_COMMENT","\/**\n                         * @todo Parent discount we apply for all children without discount\n                         *\/",93],["T_WHITESPACE","\n                        ",95],["T_IF","if",96],["T_WHITESPACE"," ",96],"(","!",["T_VARIABLE","$child",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getDiscountAmount",96],"(",")",["T_WHITESPACE"," ",96],["T_BOOLEAN_AND","&&",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$item",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getDiscountPercent",96],"(",")",")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n\n                        ",96],"}",["T_WHITESPACE","\n                        ",98],["T_VARIABLE","$totalDiscountAmount",99],["T_WHITESPACE"," ",99],["T_PLUS_EQUAL","+=",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$child",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","getDiscountAmount",99],"(",")",";",["T_COMMENT","\/\/*$item->getQty();\n",99],["T_WHITESPACE","                        ",100],["T_VARIABLE","$baseTotalDiscountAmount",100],["T_WHITESPACE"," ",100],["T_PLUS_EQUAL","+=",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$child",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getBaseDiscountAmount",100],"(",")",";",["T_COMMENT","\/\/*$item->getQty();\n",100],["T_WHITESPACE","\n                        ",101],["T_VARIABLE","$child",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","setRowTotalWithDiscount",102],"(",["T_VARIABLE","$child",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getRowTotal",102],"(",")","-",["T_VARIABLE","$child",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getDiscountAmount",102],"(",")",")",";",["T_WHITESPACE","\n                        ",102],["T_VARIABLE","$child",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","setBaseRowTotalWithDiscount",103],"(",["T_VARIABLE","$child",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getBaseRowTotal",103],"(",")","-",["T_VARIABLE","$child",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getBaseDiscountAmount",103],"(",")",")",";",["T_WHITESPACE","\n\n                        ",103],["T_VARIABLE","$subtotalWithDiscount",105],["T_PLUS_EQUAL","+=",105],["T_VARIABLE","$child",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getRowTotalWithDiscount",105],"(",")",";",["T_WHITESPACE","\n                        ",105],["T_VARIABLE","$baseSubtotalWithDiscount",106],["T_PLUS_EQUAL","+=",106],["T_VARIABLE","$child",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","getBaseRowTotalWithDiscount",106],"(",")",";",["T_WHITESPACE","\n                    ",106],"}",["T_WHITESPACE","\n                ",107],"}",["T_WHITESPACE","\n                ",108],["T_ELSE","else",109],["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n                    ",109],["T_VARIABLE","$eventArgs",110],"[",["T_CONSTANT_ENCAPSED_STRING","'item'",110],"]",["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$item",110],";",["T_WHITESPACE","\n                    ",110],["T_STRING","Mage",111],["T_DOUBLE_COLON","::",111],["T_STRING","dispatchEvent",111],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_quote_address_discount_item'",111],",",["T_WHITESPACE"," ",111],["T_VARIABLE","$eventArgs",111],")",";",["T_WHITESPACE","\n\n                    ",111],["T_IF","if",113],["T_WHITESPACE"," ",113],"(",["T_VARIABLE","$item",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","getDiscountAmount",113],"(",")",["T_WHITESPACE"," ",113],["T_BOOLEAN_OR","||",113],["T_WHITESPACE"," ",113],["T_VARIABLE","$item",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","getFreeShipping",113],"(",")",")",["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n                        ",113],["T_VARIABLE","$hasDiscount",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_STRING","true",114],";",["T_WHITESPACE","\n                    ",114],"}",["T_WHITESPACE","\n                    ",115],["T_VARIABLE","$totalDiscountAmount",116],["T_WHITESPACE"," ",116],["T_PLUS_EQUAL","+=",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$item",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getDiscountAmount",116],"(",")",";",["T_WHITESPACE","\n                    ",116],["T_VARIABLE","$baseTotalDiscountAmount",117],["T_WHITESPACE"," ",117],["T_PLUS_EQUAL","+=",117],["T_WHITESPACE"," ",117],["T_VARIABLE","$item",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getBaseDiscountAmount",117],"(",")",";",["T_WHITESPACE","\n\n                    ",117],["T_VARIABLE","$item",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","setRowTotalWithDiscount",119],"(",["T_VARIABLE","$item",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getRowTotal",119],"(",")","-",["T_VARIABLE","$item",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getDiscountAmount",119],"(",")",")",";",["T_WHITESPACE","\n                    ",119],["T_VARIABLE","$item",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","setBaseRowTotalWithDiscount",120],"(",["T_VARIABLE","$item",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","getBaseRowTotal",120],"(",")","-",["T_VARIABLE","$item",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","getBaseDiscountAmount",120],"(",")",")",";",["T_WHITESPACE","\n\n                    ",120],["T_VARIABLE","$subtotalWithDiscount",122],["T_PLUS_EQUAL","+=",122],["T_VARIABLE","$item",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","getRowTotalWithDiscount",122],"(",")",";",["T_WHITESPACE","\n                    ",122],["T_VARIABLE","$baseSubtotalWithDiscount",123],["T_PLUS_EQUAL","+=",123],["T_VARIABLE","$item",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getBaseRowTotalWithDiscount",123],"(",")",";",["T_WHITESPACE","\n                ",123],"}",["T_WHITESPACE","\n            ",124],"}",["T_WHITESPACE","\n        ",125],"}",["T_WHITESPACE","\n        ",126],["T_VARIABLE","$address",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","setDiscountAmount",127],"(",["T_VARIABLE","$totalDiscountAmount",127],")",";",["T_WHITESPACE","\n        ",127],["T_VARIABLE","$address",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","setSubtotalWithDiscount",128],"(",["T_VARIABLE","$subtotalWithDiscount",128],")",";",["T_WHITESPACE","\n        ",128],["T_VARIABLE","$address",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","setBaseDiscountAmount",129],"(",["T_VARIABLE","$baseTotalDiscountAmount",129],")",";",["T_WHITESPACE","\n        ",129],["T_VARIABLE","$address",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","setBaseSubtotalWithDiscount",130],"(",["T_VARIABLE","$baseSubtotalWithDiscount",130],")",";",["T_WHITESPACE","\n\n        ",130],["T_VARIABLE","$address",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","setGrandTotal",132],"(",["T_VARIABLE","$address",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","getGrandTotal",132],"(",")",["T_WHITESPACE"," ",132],"-",["T_WHITESPACE"," ",132],["T_VARIABLE","$address",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","getDiscountAmount",132],"(",")",")",";",["T_WHITESPACE","\n        ",132],["T_VARIABLE","$address",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","setBaseGrandTotal",133],"(",["T_VARIABLE","$address",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getBaseGrandTotal",133],"(",")","-",["T_VARIABLE","$address",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getBaseDiscountAmount",133],"(",")",")",";",["T_WHITESPACE","\n        ",133],["T_RETURN","return",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$this",134],";",["T_WHITESPACE","\n    ",134],"}",["T_WHITESPACE","\n\n    ",135],["T_PUBLIC","public",137],["T_WHITESPACE"," ",137],["T_FUNCTION","function",137],["T_WHITESPACE"," ",137],["T_STRING","fetch",137],"(",["T_STRING","Mage_Sales_Model_Quote_Address",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$address",137],")",["T_WHITESPACE","\n    ",137],"{",["T_WHITESPACE","\n        ",138],["T_VARIABLE","$amount",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$address",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getDiscountAmount",139],"(",")",";",["T_WHITESPACE","\n        ",139],["T_IF","if",140],["T_WHITESPACE"," ",140],"(",["T_VARIABLE","$amount",140],["T_IS_NOT_EQUAL","!=",140],["T_LNUMBER","0",140],")",["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n            ",140],["T_VARIABLE","$title",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_STRING","Mage",141],["T_DOUBLE_COLON","::",141],["T_STRING","helper",141],"(",["T_CONSTANT_ENCAPSED_STRING","'sales'",141],")",["T_OBJECT_OPERATOR","->",141],["T_STRING","__",141],"(",["T_CONSTANT_ENCAPSED_STRING","'Discount'",141],")",";",["T_WHITESPACE","\n            ",141],["T_VARIABLE","$code",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_VARIABLE","$address",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","getCouponCode",142],"(",")",";",["T_WHITESPACE","\n            ",142],["T_IF","if",143],["T_WHITESPACE"," ",143],"(",["T_STRING","strlen",143],"(",["T_VARIABLE","$code",143],")",")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n                ",143],["T_VARIABLE","$title",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_STRING","Mage",144],["T_DOUBLE_COLON","::",144],["T_STRING","helper",144],"(",["T_CONSTANT_ENCAPSED_STRING","'sales'",144],")",["T_OBJECT_OPERATOR","->",144],["T_STRING","__",144],"(",["T_CONSTANT_ENCAPSED_STRING","'Discount (%s)'",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$code",144],")",";",["T_WHITESPACE","\n            ",144],"}",["T_WHITESPACE","\n            ",145],["T_VARIABLE","$address",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","addTotal",146],"(",["T_ARRAY","array",146],"(",["T_WHITESPACE","\n                ",146],["T_CONSTANT_ENCAPSED_STRING","'code'",147],["T_DOUBLE_ARROW","=>",147],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","getCode",147],"(",")",",",["T_WHITESPACE","\n                ",147],["T_CONSTANT_ENCAPSED_STRING","'title'",148],["T_DOUBLE_ARROW","=>",148],["T_VARIABLE","$title",148],",",["T_WHITESPACE","\n                ",148],["T_CONSTANT_ENCAPSED_STRING","'value'",149],["T_DOUBLE_ARROW","=>",149],"-",["T_VARIABLE","$amount",149],["T_WHITESPACE","\n            ",149],")",")",";",["T_WHITESPACE","\n        ",150],"}",["T_WHITESPACE","\n        ",151],["T_RETURN","return",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],";",["T_WHITESPACE","\n    ",152],"}",["T_WHITESPACE","\n\n",153],"}",["T_WHITESPACE","\n",155]]