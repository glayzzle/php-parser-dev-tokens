[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Shipping\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_COMMENT","\/*\n * Class Mage_Shipping_Model_Carrier_Tablerate\n *\/",27],["T_WHITESPACE","\n",29],["T_CLASS","class",30],["T_WHITESPACE"," ",30],["T_STRING","Mage_Shipping_Model_Carrier_Tablerate",30],["T_WHITESPACE","\n    ",30],["T_EXTENDS","extends",31],["T_WHITESPACE"," ",31],["T_STRING","Mage_Shipping_Model_Carrier_Abstract",31],["T_WHITESPACE","\n    ",31],["T_IMPLEMENTS","implements",32],["T_WHITESPACE"," ",32],["T_STRING","Mage_Shipping_Model_Carrier_Interface",32],["T_WHITESPACE","\n",32],"{",["T_WHITESPACE","\n\n    ",33],["T_DOC_COMMENT","\/**\n     * code name\n     *\n     * @var string\n     *\/",35],["T_WHITESPACE","\n    ",39],["T_PROTECTED","protected",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$_code",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'tablerate'",40],";",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/**\n     * boolean isFixed\n     *\n     * @var boolean\n     *\/",42],["T_WHITESPACE","\n    ",46],["T_PROTECTED","protected",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$_isFixed",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_STRING","true",47],";",["T_WHITESPACE","\n\n    ",47],["T_DOC_COMMENT","\/**\n     * Default condition name\n     *\n     * @var string\n     *\/",49],["T_WHITESPACE","\n    ",53],["T_PROTECTED","protected",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$_default_condition_name",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'package_weight'",54],";",["T_WHITESPACE","\n\n    ",54],["T_DOC_COMMENT","\/**\n     * Condition names\n     *\n     * @var array\n     *\/",56],["T_WHITESPACE","\n    ",60],["T_PROTECTED","protected",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$_conditionNames",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_ARRAY","array",61],"(",")",";",["T_WHITESPACE","\n\n    ",61],["T_COMMENT","\/*\n     * Constructor\n     *\/",63],["T_WHITESPACE","\n    ",65],["T_PUBLIC","public",66],["T_WHITESPACE"," ",66],["T_FUNCTION","function",66],["T_WHITESPACE"," ",66],["T_STRING","__construct",66],"(",")",["T_WHITESPACE","\n    ",66],"{",["T_WHITESPACE","\n        ",67],["T_STRING","parent",68],["T_DOUBLE_COLON","::",68],["T_STRING","__construct",68],"(",")",";",["T_WHITESPACE","\n        ",68],["T_FOREACH","foreach",69],["T_WHITESPACE"," ",69],"(",["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getCode",69],"(",["T_CONSTANT_ENCAPSED_STRING","'condition_name'",69],")",["T_WHITESPACE"," ",69],["T_AS","as",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$k",69],["T_WHITESPACE"," ",69],["T_DOUBLE_ARROW","=>",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$v",69],")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n            ",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","_conditionNames",70],"[","]",["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$k",70],";",["T_WHITESPACE","\n        ",70],"}",["T_WHITESPACE","\n    ",71],"}",["T_WHITESPACE","\n\n    ",72],["T_DOC_COMMENT","\/**\n     * Collect and get rates\n     *\n     * @param Mage_Shipping_Model_Rate_Request $request\n     * @return Mage_Shipping_Model_Rate_Result\n     *\/",74],["T_WHITESPACE","\n    ",79],["T_PUBLIC","public",80],["T_WHITESPACE"," ",80],["T_FUNCTION","function",80],["T_WHITESPACE"," ",80],["T_STRING","collectRates",80],"(",["T_STRING","Mage_Shipping_Model_Rate_Request",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$request",80],")",["T_WHITESPACE","\n    ",80],"{",["T_WHITESPACE","\n        ",81],["T_IF","if",82],["T_WHITESPACE"," ",82],"(","!",["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","getConfigFlag",82],"(",["T_CONSTANT_ENCAPSED_STRING","'active'",82],")",")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n            ",82],["T_RETURN","return",83],["T_WHITESPACE"," ",83],["T_STRING","false",83],";",["T_WHITESPACE","\n        ",83],"}",["T_WHITESPACE","\n\n        ",84],["T_COMMENT","\/\/ exclude Virtual products price from Package value if pre-configured\n",86],["T_WHITESPACE","        ",87],["T_IF","if",87],["T_WHITESPACE"," ",87],"(","!",["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getConfigFlag",87],"(",["T_CONSTANT_ENCAPSED_STRING","'include_virtual_price'",87],")",["T_WHITESPACE"," ",87],["T_BOOLEAN_AND","&&",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$request",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getAllItems",87],"(",")",")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n            ",87],["T_FOREACH","foreach",88],["T_WHITESPACE"," ",88],"(",["T_VARIABLE","$request",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","getAllItems",88],"(",")",["T_WHITESPACE"," ",88],["T_AS","as",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$item",88],")",["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n                ",88],["T_IF","if",89],["T_WHITESPACE"," ",89],"(",["T_VARIABLE","$item",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getParentItem",89],"(",")",")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n                    ",89],["T_CONTINUE","continue",90],";",["T_WHITESPACE","\n                ",90],"}",["T_WHITESPACE","\n                ",91],["T_IF","if",92],["T_WHITESPACE"," ",92],"(",["T_VARIABLE","$item",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getHasChildren",92],"(",")",["T_WHITESPACE"," ",92],["T_BOOLEAN_AND","&&",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$item",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","isShipSeparately",92],"(",")",")",["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n                    ",92],["T_FOREACH","foreach",93],["T_WHITESPACE"," ",93],"(",["T_VARIABLE","$item",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getChildren",93],"(",")",["T_WHITESPACE"," ",93],["T_AS","as",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$child",93],")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n                        ",93],["T_IF","if",94],["T_WHITESPACE"," ",94],"(",["T_VARIABLE","$child",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getProduct",94],"(",")",["T_OBJECT_OPERATOR","->",94],["T_STRING","isVirtual",94],"(",")",")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n                            ",94],["T_VARIABLE","$request",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","setPackageValue",95],"(",["T_VARIABLE","$request",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getPackageValue",95],"(",")",["T_WHITESPACE"," ",95],"-",["T_WHITESPACE"," ",95],["T_VARIABLE","$child",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getBaseRowTotal",95],"(",")",")",";",["T_WHITESPACE","\n                        ",95],"}",["T_WHITESPACE","\n                    ",96],"}",["T_WHITESPACE","\n                ",97],"}",["T_WHITESPACE"," ",98],["T_ELSEIF","elseif",98],["T_WHITESPACE"," ",98],"(",["T_VARIABLE","$item",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getProduct",98],"(",")",["T_OBJECT_OPERATOR","->",98],["T_STRING","isVirtual",98],"(",")",")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n                    ",98],["T_VARIABLE","$request",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","setPackageValue",99],"(",["T_VARIABLE","$request",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","getPackageValue",99],"(",")",["T_WHITESPACE"," ",99],"-",["T_WHITESPACE"," ",99],["T_VARIABLE","$item",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","getBaseRowTotal",99],"(",")",")",";",["T_WHITESPACE","\n                ",99],"}",["T_WHITESPACE","\n            ",100],"}",["T_WHITESPACE","\n        ",101],"}",["T_WHITESPACE","\n\n        ",102],["T_COMMENT","\/\/ Free shipping by qty\n",104],["T_WHITESPACE","        ",105],["T_VARIABLE","$freeQty",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_LNUMBER","0",105],";",["T_WHITESPACE","\n        ",105],["T_IF","if",106],["T_WHITESPACE"," ",106],"(",["T_VARIABLE","$request",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","getAllItems",106],"(",")",")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n            ",106],["T_VARIABLE","$freePackageValue",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_LNUMBER","0",107],";",["T_WHITESPACE","\n            ",107],["T_FOREACH","foreach",108],["T_WHITESPACE"," ",108],"(",["T_VARIABLE","$request",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getAllItems",108],"(",")",["T_WHITESPACE"," ",108],["T_AS","as",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$item",108],")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n                ",108],["T_IF","if",109],["T_WHITESPACE"," ",109],"(",["T_VARIABLE","$item",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getProduct",109],"(",")",["T_OBJECT_OPERATOR","->",109],["T_STRING","isVirtual",109],"(",")",["T_WHITESPACE"," ",109],["T_BOOLEAN_OR","||",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$item",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getParentItem",109],"(",")",")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n                    ",109],["T_CONTINUE","continue",110],";",["T_WHITESPACE","\n                ",110],"}",["T_WHITESPACE","\n\n                ",111],["T_IF","if",113],["T_WHITESPACE"," ",113],"(",["T_VARIABLE","$item",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","getHasChildren",113],"(",")",["T_WHITESPACE"," ",113],["T_BOOLEAN_AND","&&",113],["T_WHITESPACE"," ",113],["T_VARIABLE","$item",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","isShipSeparately",113],"(",")",")",["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n                    ",113],["T_FOREACH","foreach",114],["T_WHITESPACE"," ",114],"(",["T_VARIABLE","$item",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","getChildren",114],"(",")",["T_WHITESPACE"," ",114],["T_AS","as",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$child",114],")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n                        ",114],["T_IF","if",115],["T_WHITESPACE"," ",115],"(",["T_VARIABLE","$child",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","getFreeShipping",115],"(",")",["T_WHITESPACE"," ",115],["T_BOOLEAN_AND","&&",115],["T_WHITESPACE"," ",115],"!",["T_VARIABLE","$child",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","getProduct",115],"(",")",["T_OBJECT_OPERATOR","->",115],["T_STRING","isVirtual",115],"(",")",")",["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n                            ",115],["T_VARIABLE","$freeShipping",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_STRING","is_numeric",116],"(",["T_VARIABLE","$child",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getFreeShipping",116],"(",")",")",["T_WHITESPACE"," ",116],"?",["T_WHITESPACE"," ",116],["T_VARIABLE","$child",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getFreeShipping",116],"(",")",["T_WHITESPACE"," ",116],":",["T_WHITESPACE"," ",116],["T_LNUMBER","0",116],";",["T_WHITESPACE","\n                            ",116],["T_VARIABLE","$freeQty",117],["T_WHITESPACE"," ",117],["T_PLUS_EQUAL","+=",117],["T_WHITESPACE"," ",117],["T_VARIABLE","$item",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getQty",117],"(",")",["T_WHITESPACE"," ",117],"*",["T_WHITESPACE"," ",117],"(",["T_VARIABLE","$child",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getQty",117],"(",")",["T_WHITESPACE"," ",117],"-",["T_WHITESPACE"," ",117],["T_VARIABLE","$freeShipping",117],")",";",["T_WHITESPACE","\n                        ",117],"}",["T_WHITESPACE","\n                    ",118],"}",["T_WHITESPACE","\n                ",119],"}",["T_WHITESPACE"," ",120],["T_ELSEIF","elseif",120],["T_WHITESPACE"," ",120],"(",["T_VARIABLE","$item",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","getFreeShipping",120],"(",")",")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n                    ",120],["T_VARIABLE","$freeShipping",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_STRING","is_numeric",121],"(",["T_VARIABLE","$item",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","getFreeShipping",121],"(",")",")",["T_WHITESPACE"," ",121],"?",["T_WHITESPACE"," ",121],["T_VARIABLE","$item",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","getFreeShipping",121],"(",")",["T_WHITESPACE"," ",121],":",["T_WHITESPACE"," ",121],["T_LNUMBER","0",121],";",["T_WHITESPACE","\n                    ",121],["T_VARIABLE","$freeQty",122],["T_WHITESPACE"," ",122],["T_PLUS_EQUAL","+=",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$item",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","getQty",122],"(",")",["T_WHITESPACE"," ",122],"-",["T_WHITESPACE"," ",122],["T_VARIABLE","$freeShipping",122],";",["T_WHITESPACE","\n                    ",122],["T_VARIABLE","$freePackageValue",123],["T_WHITESPACE"," ",123],["T_PLUS_EQUAL","+=",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$item",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getBaseRowTotal",123],"(",")",";",["T_WHITESPACE","\n                ",123],"}",["T_WHITESPACE","\n            ",124],"}",["T_WHITESPACE","\n            ",125],["T_VARIABLE","$oldValue",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$request",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getPackageValue",126],"(",")",";",["T_WHITESPACE","\n            ",126],["T_VARIABLE","$request",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","setPackageValue",127],"(",["T_VARIABLE","$oldValue",127],["T_WHITESPACE"," ",127],"-",["T_WHITESPACE"," ",127],["T_VARIABLE","$freePackageValue",127],")",";",["T_WHITESPACE","\n        ",127],"}",["T_WHITESPACE","\n\n        ",128],["T_IF","if",130],["T_WHITESPACE"," ",130],"(",["T_VARIABLE","$freePackageValue",130],")",["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n            ",130],["T_VARIABLE","$request",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","setPackageValue",131],"(",["T_VARIABLE","$request",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","getPackageValue",131],"(",")",["T_WHITESPACE"," ",131],"-",["T_WHITESPACE"," ",131],["T_VARIABLE","$freePackageValue",131],")",";",["T_WHITESPACE","\n        ",131],"}",["T_WHITESPACE","\n        ",132],["T_IF","if",133],["T_WHITESPACE"," ",133],"(","!",["T_VARIABLE","$request",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getConditionName",133],"(",")",")",["T_WHITESPACE"," ",133],"{",["T_WHITESPACE","\n            ",133],["T_VARIABLE","$conditionName",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","getConfigData",134],"(",["T_CONSTANT_ENCAPSED_STRING","'condition_name'",134],")",";",["T_WHITESPACE","\n            ",134],["T_VARIABLE","$request",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","setConditionName",135],"(",["T_VARIABLE","$conditionName",135],["T_WHITESPACE"," ",135],"?",["T_WHITESPACE"," ",135],["T_VARIABLE","$conditionName",135],["T_WHITESPACE"," ",135],":",["T_WHITESPACE"," ",135],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","_default_condition_name",135],")",";",["T_WHITESPACE","\n        ",135],"}",["T_WHITESPACE","\n\n        ",136],["T_COMMENT","\/\/ Package weight and qty free shipping\n",138],["T_WHITESPACE","        ",139],["T_VARIABLE","$oldWeight",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$request",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getPackageWeight",139],"(",")",";",["T_WHITESPACE","\n        ",139],["T_VARIABLE","$oldQty",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_VARIABLE","$request",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","getPackageQty",140],"(",")",";",["T_WHITESPACE","\n\n        ",140],["T_VARIABLE","$request",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","setPackageWeight",142],"(",["T_VARIABLE","$request",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","getFreeMethodWeight",142],"(",")",")",";",["T_WHITESPACE","\n        ",142],["T_VARIABLE","$request",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","setPackageQty",143],"(",["T_VARIABLE","$oldQty",143],["T_WHITESPACE"," ",143],"-",["T_WHITESPACE"," ",143],["T_VARIABLE","$freeQty",143],")",";",["T_WHITESPACE","\n\n        ",143],["T_VARIABLE","$result",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","_getModel",145],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping\/rate_result'",145],")",";",["T_WHITESPACE","\n        ",145],["T_VARIABLE","$rate",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","getRate",146],"(",["T_VARIABLE","$request",146],")",";",["T_WHITESPACE","\n\n        ",146],["T_VARIABLE","$request",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","setPackageWeight",148],"(",["T_VARIABLE","$oldWeight",148],")",";",["T_WHITESPACE","\n        ",148],["T_VARIABLE","$request",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","setPackageQty",149],"(",["T_VARIABLE","$oldQty",149],")",";",["T_WHITESPACE","\n\n        ",149],["T_IF","if",151],["T_WHITESPACE"," ",151],"(","!",["T_EMPTY","empty",151],"(",["T_VARIABLE","$rate",151],")",["T_WHITESPACE"," ",151],["T_BOOLEAN_AND","&&",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$rate",151],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",151],"]",["T_WHITESPACE"," ",151],["T_IS_GREATER_OR_EQUAL",">=",151],["T_WHITESPACE"," ",151],["T_LNUMBER","0",151],")",["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n            ",151],["T_VARIABLE","$method",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","_getModel",152],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping\/rate_result_method'",152],")",";",["T_WHITESPACE","\n\n            ",152],["T_VARIABLE","$method",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","setCarrier",154],"(",["T_CONSTANT_ENCAPSED_STRING","'tablerate'",154],")",";",["T_WHITESPACE","\n            ",154],["T_VARIABLE","$method",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","setCarrierTitle",155],"(",["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","getConfigData",155],"(",["T_CONSTANT_ENCAPSED_STRING","'title'",155],")",")",";",["T_WHITESPACE","\n\n            ",155],["T_VARIABLE","$method",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","setMethod",157],"(",["T_CONSTANT_ENCAPSED_STRING","'bestway'",157],")",";",["T_WHITESPACE","\n            ",157],["T_VARIABLE","$method",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","setMethodTitle",158],"(",["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","getConfigData",158],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",158],")",")",";",["T_WHITESPACE","\n\n            ",158],["T_IF","if",160],["T_WHITESPACE"," ",160],"(",["T_VARIABLE","$request",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","getFreeShipping",160],"(",")",["T_WHITESPACE"," ",160],["T_IS_IDENTICAL","===",160],["T_WHITESPACE"," ",160],["T_STRING","true",160],["T_WHITESPACE"," ",160],["T_BOOLEAN_OR","||",160],["T_WHITESPACE"," ",160],"(",["T_VARIABLE","$request",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","getPackageQty",160],"(",")",["T_WHITESPACE"," ",160],["T_IS_EQUAL","==",160],["T_WHITESPACE"," ",160],["T_VARIABLE","$freeQty",160],")",")",["T_WHITESPACE"," ",160],"{",["T_WHITESPACE","\n                ",160],["T_VARIABLE","$shippingPrice",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_LNUMBER","0",161],";",["T_WHITESPACE","\n            ",161],"}",["T_WHITESPACE"," ",162],["T_ELSE","else",162],["T_WHITESPACE"," ",162],"{",["T_WHITESPACE","\n                ",162],["T_VARIABLE","$shippingPrice",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","getFinalPriceWithHandlingFee",163],"(",["T_VARIABLE","$rate",163],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",163],"]",")",";",["T_WHITESPACE","\n            ",163],"}",["T_WHITESPACE","\n\n            ",164],["T_VARIABLE","$method",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","setPrice",166],"(",["T_VARIABLE","$shippingPrice",166],")",";",["T_WHITESPACE","\n            ",166],["T_VARIABLE","$method",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","setCost",167],"(",["T_VARIABLE","$rate",167],"[",["T_CONSTANT_ENCAPSED_STRING","'cost'",167],"]",")",";",["T_WHITESPACE","\n\n            ",167],["T_VARIABLE","$result",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","append",169],"(",["T_VARIABLE","$method",169],")",";",["T_WHITESPACE","\n        ",169],"}",["T_WHITESPACE"," ",170],["T_ELSEIF","elseif",170],["T_WHITESPACE"," ",170],"(",["T_EMPTY","empty",170],"(",["T_VARIABLE","$rate",170],")",["T_WHITESPACE"," ",170],["T_BOOLEAN_AND","&&",170],["T_WHITESPACE"," ",170],["T_VARIABLE","$request",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","getFreeShipping",170],"(",")",["T_WHITESPACE"," ",170],["T_IS_IDENTICAL","===",170],["T_WHITESPACE"," ",170],["T_STRING","true",170],")",["T_WHITESPACE"," ",170],"{",["T_WHITESPACE","\n            ",170],["T_DOC_COMMENT","\/**\n             * was applied promotion rule for whole cart\n             * other shipping methods could be switched off at all\n             * we must show table rate method with 0$ price, if grand_total more, than min table condition_value\n             * free setPackageWeight() has already was taken into account\n             *\/",171],["T_WHITESPACE","\n            ",176],["T_VARIABLE","$request",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","setPackageValue",177],"(",["T_VARIABLE","$freePackageValue",177],")",";",["T_WHITESPACE","\n            ",177],["T_VARIABLE","$request",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","setPackageQty",178],"(",["T_VARIABLE","$freeQty",178],")",";",["T_WHITESPACE","\n            ",178],["T_VARIABLE","$rate",179],["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","getRate",179],"(",["T_VARIABLE","$request",179],")",";",["T_WHITESPACE","\n            ",179],["T_IF","if",180],["T_WHITESPACE"," ",180],"(","!",["T_EMPTY","empty",180],"(",["T_VARIABLE","$rate",180],")",["T_WHITESPACE"," ",180],["T_BOOLEAN_AND","&&",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$rate",180],"[",["T_CONSTANT_ENCAPSED_STRING","'price'",180],"]",["T_WHITESPACE"," ",180],["T_IS_GREATER_OR_EQUAL",">=",180],["T_WHITESPACE"," ",180],["T_LNUMBER","0",180],")",["T_WHITESPACE"," ",180],"{",["T_WHITESPACE","\n                ",180],["T_VARIABLE","$method",181],["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","_getModel",181],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping\/rate_result_method'",181],")",";",["T_WHITESPACE","\n\n                ",181],["T_VARIABLE","$method",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","setCarrier",183],"(",["T_CONSTANT_ENCAPSED_STRING","'tablerate'",183],")",";",["T_WHITESPACE","\n                ",183],["T_VARIABLE","$method",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","setCarrierTitle",184],"(",["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getConfigData",184],"(",["T_CONSTANT_ENCAPSED_STRING","'title'",184],")",")",";",["T_WHITESPACE","\n\n                ",184],["T_VARIABLE","$method",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","setMethod",186],"(",["T_CONSTANT_ENCAPSED_STRING","'bestway'",186],")",";",["T_WHITESPACE","\n                ",186],["T_VARIABLE","$method",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","setMethodTitle",187],"(",["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","getConfigData",187],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",187],")",")",";",["T_WHITESPACE","\n\n                ",187],["T_VARIABLE","$method",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","setPrice",189],"(",["T_LNUMBER","0",189],")",";",["T_WHITESPACE","\n                ",189],["T_VARIABLE","$method",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","setCost",190],"(",["T_LNUMBER","0",190],")",";",["T_WHITESPACE","\n\n                ",190],["T_VARIABLE","$result",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","append",192],"(",["T_VARIABLE","$method",192],")",";",["T_WHITESPACE","\n            ",192],"}",["T_WHITESPACE","\n        ",193],"}",["T_WHITESPACE"," ",194],["T_ELSE","else",194],["T_WHITESPACE"," ",194],"{",["T_WHITESPACE","\n            ",194],["T_VARIABLE","$error",195],["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","_getModel",195],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping\/rate_result_error'",195],")",";",["T_WHITESPACE","\n            ",195],["T_VARIABLE","$error",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","setCarrier",196],"(",["T_CONSTANT_ENCAPSED_STRING","'tablerate'",196],")",";",["T_WHITESPACE","\n            ",196],["T_VARIABLE","$error",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","setCarrierTitle",197],"(",["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","getConfigData",197],"(",["T_CONSTANT_ENCAPSED_STRING","'title'",197],")",")",";",["T_WHITESPACE","\n            ",197],["T_VARIABLE","$error",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","setErrorMessage",198],"(",["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","getConfigData",198],"(",["T_CONSTANT_ENCAPSED_STRING","'specificerrmsg'",198],")",")",";",["T_WHITESPACE","\n            ",198],["T_VARIABLE","$result",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","append",199],"(",["T_VARIABLE","$error",199],")",";",["T_WHITESPACE","\n        ",199],"}",["T_WHITESPACE","\n\n        ",200],["T_RETURN","return",202],["T_WHITESPACE"," ",202],["T_VARIABLE","$result",202],";",["T_WHITESPACE","\n    ",202],"}",["T_WHITESPACE","\n\n    ",203],["T_DOC_COMMENT","\/**\n     * Get Model\n     *\n     * @param string $modelName\n     *\n     * @return Mage_Core_Model_Abstract\n     *\/",205],["T_WHITESPACE","\n    ",211],["T_PROTECTED","protected",212],["T_WHITESPACE"," ",212],["T_FUNCTION","function",212],["T_WHITESPACE"," ",212],["T_STRING","_getModel",212],"(",["T_VARIABLE","$modelName",212],")",["T_WHITESPACE","\n    ",212],"{",["T_WHITESPACE","\n        ",213],["T_RETURN","return",214],["T_WHITESPACE"," ",214],["T_STRING","Mage",214],["T_DOUBLE_COLON","::",214],["T_STRING","getModel",214],"(",["T_VARIABLE","$modelName",214],")",";",["T_WHITESPACE","\n    ",214],"}",["T_WHITESPACE","\n\n    ",215],["T_DOC_COMMENT","\/**\n     * Get Rate\n     *\n     * @param Mage_Shipping_Model_Rate_Request $request\n     *\n     * @return Mage_Core_Model_Abstract\n     *\/",217],["T_WHITESPACE","\n    ",223],["T_PUBLIC","public",224],["T_WHITESPACE"," ",224],["T_FUNCTION","function",224],["T_WHITESPACE"," ",224],["T_STRING","getRate",224],"(",["T_STRING","Mage_Shipping_Model_Rate_Request",224],["T_WHITESPACE"," ",224],["T_VARIABLE","$request",224],")",["T_WHITESPACE","\n    ",224],"{",["T_WHITESPACE","\n        ",225],["T_RETURN","return",226],["T_WHITESPACE"," ",226],["T_STRING","Mage",226],["T_DOUBLE_COLON","::",226],["T_STRING","getResourceModel",226],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping\/carrier_tablerate'",226],")",["T_OBJECT_OPERATOR","->",226],["T_STRING","getRate",226],"(",["T_VARIABLE","$request",226],")",";",["T_WHITESPACE","\n    ",226],"}",["T_WHITESPACE","\n\n    ",227],["T_DOC_COMMENT","\/**\n     * Get code\n     *\n     * @param string $type\n     * @param string $code\n     *\n     * @return array\n     *\/",229],["T_WHITESPACE","\n    ",236],["T_PUBLIC","public",237],["T_WHITESPACE"," ",237],["T_FUNCTION","function",237],["T_WHITESPACE"," ",237],["T_STRING","getCode",237],"(",["T_VARIABLE","$type",237],",",["T_WHITESPACE"," ",237],["T_VARIABLE","$code",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_CONSTANT_ENCAPSED_STRING","''",237],")",["T_WHITESPACE","\n    ",237],"{",["T_WHITESPACE","\n        ",238],["T_VARIABLE","$codes",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_ARRAY","array",239],"(",["T_WHITESPACE","\n\n            ",239],["T_CONSTANT_ENCAPSED_STRING","'condition_name'",241],["T_WHITESPACE"," ",241],["T_DOUBLE_ARROW","=>",241],["T_WHITESPACE"," ",241],["T_ARRAY","array",241],"(",["T_WHITESPACE","\n                ",241],["T_CONSTANT_ENCAPSED_STRING","'package_weight'",242],["T_WHITESPACE"," ",242],["T_DOUBLE_ARROW","=>",242],["T_WHITESPACE"," ",242],["T_STRING","Mage",242],["T_DOUBLE_COLON","::",242],["T_STRING","helper",242],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping'",242],")",["T_OBJECT_OPERATOR","->",242],["T_STRING","__",242],"(",["T_CONSTANT_ENCAPSED_STRING","'Weight vs. Destination'",242],")",",",["T_WHITESPACE","\n                ",242],["T_CONSTANT_ENCAPSED_STRING","'package_value'",243],["T_WHITESPACE"," ",243],["T_DOUBLE_ARROW","=>",243],["T_WHITESPACE"," ",243],["T_STRING","Mage",243],["T_DOUBLE_COLON","::",243],["T_STRING","helper",243],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping'",243],")",["T_OBJECT_OPERATOR","->",243],["T_STRING","__",243],"(",["T_CONSTANT_ENCAPSED_STRING","'Price vs. Destination'",243],")",",",["T_WHITESPACE","\n                ",243],["T_CONSTANT_ENCAPSED_STRING","'package_qty'",244],["T_WHITESPACE"," ",244],["T_DOUBLE_ARROW","=>",244],["T_WHITESPACE"," ",244],["T_STRING","Mage",244],["T_DOUBLE_COLON","::",244],["T_STRING","helper",244],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping'",244],")",["T_OBJECT_OPERATOR","->",244],["T_STRING","__",244],"(",["T_CONSTANT_ENCAPSED_STRING","'# of Items vs. Destination'",244],")",",",["T_WHITESPACE","\n            ",244],")",",",["T_WHITESPACE","\n\n            ",245],["T_CONSTANT_ENCAPSED_STRING","'condition_name_short'",247],["T_WHITESPACE"," ",247],["T_DOUBLE_ARROW","=>",247],["T_WHITESPACE"," ",247],["T_ARRAY","array",247],"(",["T_WHITESPACE","\n                ",247],["T_CONSTANT_ENCAPSED_STRING","'package_weight'",248],["T_WHITESPACE"," ",248],["T_DOUBLE_ARROW","=>",248],["T_WHITESPACE"," ",248],["T_STRING","Mage",248],["T_DOUBLE_COLON","::",248],["T_STRING","helper",248],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping'",248],")",["T_OBJECT_OPERATOR","->",248],["T_STRING","__",248],"(",["T_CONSTANT_ENCAPSED_STRING","'Weight (and above)'",248],")",",",["T_WHITESPACE","\n                ",248],["T_CONSTANT_ENCAPSED_STRING","'package_value'",249],["T_WHITESPACE"," ",249],["T_DOUBLE_ARROW","=>",249],["T_WHITESPACE"," ",249],["T_STRING","Mage",249],["T_DOUBLE_COLON","::",249],["T_STRING","helper",249],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping'",249],")",["T_OBJECT_OPERATOR","->",249],["T_STRING","__",249],"(",["T_CONSTANT_ENCAPSED_STRING","'Order Subtotal (and above)'",249],")",",",["T_WHITESPACE","\n                ",249],["T_CONSTANT_ENCAPSED_STRING","'package_qty'",250],["T_WHITESPACE"," ",250],["T_DOUBLE_ARROW","=>",250],["T_WHITESPACE"," ",250],["T_STRING","Mage",250],["T_DOUBLE_COLON","::",250],["T_STRING","helper",250],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping'",250],")",["T_OBJECT_OPERATOR","->",250],["T_STRING","__",250],"(",["T_CONSTANT_ENCAPSED_STRING","'# of Items (and above)'",250],")",",",["T_WHITESPACE","\n            ",250],")",",",["T_WHITESPACE","\n\n        ",251],")",";",["T_WHITESPACE","\n\n        ",253],["T_IF","if",255],["T_WHITESPACE"," ",255],"(","!",["T_ISSET","isset",255],"(",["T_VARIABLE","$codes",255],"[",["T_VARIABLE","$type",255],"]",")",")",["T_WHITESPACE"," ",255],"{",["T_WHITESPACE","\n            ",255],["T_THROW","throw",256],["T_WHITESPACE"," ",256],["T_STRING","Mage",256],["T_DOUBLE_COLON","::",256],["T_STRING","exception",256],"(",["T_CONSTANT_ENCAPSED_STRING","'Mage_Shipping'",256],",",["T_WHITESPACE"," ",256],["T_STRING","Mage",256],["T_DOUBLE_COLON","::",256],["T_STRING","helper",256],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping'",256],")",["T_OBJECT_OPERATOR","->",256],["T_STRING","__",256],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid Table Rate code type: %s'",256],",",["T_WHITESPACE"," ",256],["T_VARIABLE","$type",256],")",")",";",["T_WHITESPACE","\n        ",256],"}",["T_WHITESPACE","\n\n        ",257],["T_IF","if",259],["T_WHITESPACE"," ",259],"(",["T_CONSTANT_ENCAPSED_STRING","''",259],["T_WHITESPACE"," ",259],["T_IS_IDENTICAL","===",259],["T_WHITESPACE"," ",259],["T_VARIABLE","$code",259],")",["T_WHITESPACE"," ",259],"{",["T_WHITESPACE","\n            ",259],["T_RETURN","return",260],["T_WHITESPACE"," ",260],["T_VARIABLE","$codes",260],"[",["T_VARIABLE","$type",260],"]",";",["T_WHITESPACE","\n        ",260],"}",["T_WHITESPACE","\n\n        ",261],["T_IF","if",263],["T_WHITESPACE"," ",263],"(","!",["T_ISSET","isset",263],"(",["T_VARIABLE","$codes",263],"[",["T_VARIABLE","$type",263],"]","[",["T_VARIABLE","$code",263],"]",")",")",["T_WHITESPACE"," ",263],"{",["T_WHITESPACE","\n            ",263],["T_THROW","throw",264],["T_WHITESPACE"," ",264],["T_STRING","Mage",264],["T_DOUBLE_COLON","::",264],["T_STRING","exception",264],"(",["T_CONSTANT_ENCAPSED_STRING","'Mage_Shipping'",264],",",["T_WHITESPACE"," ",264],["T_STRING","Mage",264],["T_DOUBLE_COLON","::",264],["T_STRING","helper",264],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping'",264],")",["T_OBJECT_OPERATOR","->",264],["T_STRING","__",264],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid Table Rate code for type %s: %s'",264],",",["T_WHITESPACE"," ",264],["T_VARIABLE","$type",264],",",["T_WHITESPACE"," ",264],["T_VARIABLE","$code",264],")",")",";",["T_WHITESPACE","\n        ",264],"}",["T_WHITESPACE","\n\n        ",265],["T_RETURN","return",267],["T_WHITESPACE"," ",267],["T_VARIABLE","$codes",267],"[",["T_VARIABLE","$type",267],"]","[",["T_VARIABLE","$code",267],"]",";",["T_WHITESPACE","\n    ",267],"}",["T_WHITESPACE","\n\n    ",268],["T_DOC_COMMENT","\/**\n     * Get allowed shipping methods\n     *\n     * @return array\n     *\/",270],["T_WHITESPACE","\n    ",274],["T_PUBLIC","public",275],["T_WHITESPACE"," ",275],["T_FUNCTION","function",275],["T_WHITESPACE"," ",275],["T_STRING","getAllowedMethods",275],"(",")",["T_WHITESPACE","\n    ",275],"{",["T_WHITESPACE","\n        ",276],["T_RETURN","return",277],["T_WHITESPACE"," ",277],["T_ARRAY","array",277],"(",["T_CONSTANT_ENCAPSED_STRING","'bestway'",277],["T_WHITESPACE"," ",277],["T_DOUBLE_ARROW","=>",277],["T_WHITESPACE"," ",277],["T_VARIABLE","$this",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","getConfigData",277],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",277],")",")",";",["T_WHITESPACE","\n    ",277],"}",["T_WHITESPACE","\n\n",278],"}",["T_WHITESPACE","\n",280]]