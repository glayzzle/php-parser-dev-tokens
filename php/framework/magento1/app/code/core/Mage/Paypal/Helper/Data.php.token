[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Paypal\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Paypal Data helper\n *\/",27],["T_WHITESPACE","\n",29],["T_CLASS","class",30],["T_WHITESPACE"," ",30],["T_STRING","Mage_Paypal_Helper_Data",30],["T_WHITESPACE"," ",30],["T_EXTENDS","extends",30],["T_WHITESPACE"," ",30],["T_STRING","Mage_Core_Helper_Abstract",30],["T_WHITESPACE","\n",30],"{",["T_WHITESPACE","\n    ",31],["T_DOC_COMMENT","\/**\n     * US country code\n     *\/",32],["T_WHITESPACE","\n    ",34],["T_CONST","const",35],["T_WHITESPACE"," ",35],["T_STRING","US_COUNTRY",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_CONSTANT_ENCAPSED_STRING","'US'",35],";",["T_WHITESPACE","\n\n    ",35],["T_DOC_COMMENT","\/**\n     * Config path for merchant country\n     *\/",37],["T_WHITESPACE","\n    ",39],["T_CONST","const",40],["T_WHITESPACE"," ",40],["T_STRING","MERCHANT_COUNTRY_CONFIG_PATH",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'paypal\/general\/merchant_country'",40],";",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/**\n     * Cache for shouldAskToCreateBillingAgreement()\n     *\n     * @var bool\n     *\/",42],["T_WHITESPACE","\n    ",46],["T_PROTECTED","protected",47],["T_WHITESPACE"," ",47],["T_STATIC","static",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$_shouldAskToCreateBillingAgreement",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_STRING","null",47],";",["T_WHITESPACE","\n\n    ",47],["T_DOC_COMMENT","\/**\n     * Check whether customer should be asked confirmation whether to sign a billing agreement\n     *\n     * @param Mage_Paypal_Model_Config $config\n     * @param int $customerId\n     * @return bool\n     *\/",49],["T_WHITESPACE","\n    ",55],["T_PUBLIC","public",56],["T_WHITESPACE"," ",56],["T_FUNCTION","function",56],["T_WHITESPACE"," ",56],["T_STRING","shouldAskToCreateBillingAgreement",56],"(",["T_STRING","Mage_Paypal_Model_Config",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$config",56],",",["T_WHITESPACE"," ",56],["T_VARIABLE","$customerId",56],")",["T_WHITESPACE","\n    ",56],"{",["T_WHITESPACE","\n        ",57],["T_IF","if",58],["T_WHITESPACE"," ",58],"(",["T_STRING","null",58],["T_WHITESPACE"," ",58],["T_IS_IDENTICAL","===",58],["T_WHITESPACE"," ",58],["T_STRING","self",58],["T_DOUBLE_COLON","::",58],["T_VARIABLE","$_shouldAskToCreateBillingAgreement",58],")",["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n            ",58],["T_STRING","self",59],["T_DOUBLE_COLON","::",59],["T_VARIABLE","$_shouldAskToCreateBillingAgreement",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_STRING","false",59],";",["T_WHITESPACE","\n            ",59],["T_IF","if",60],["T_WHITESPACE"," ",60],"(",["T_VARIABLE","$customerId",60],["T_WHITESPACE"," ",60],["T_BOOLEAN_AND","&&",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$config",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","shouldAskToCreateBillingAgreement",60],"(",")",")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n                ",60],["T_IF","if",61],["T_WHITESPACE"," ",61],"(",["T_STRING","Mage",61],["T_DOUBLE_COLON","::",61],["T_STRING","getModel",61],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/billing_agreement'",61],")",["T_OBJECT_OPERATOR","->",61],["T_STRING","needToCreateForCustomer",61],"(",["T_VARIABLE","$customerId",61],")",")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n                    ",61],["T_STRING","self",62],["T_DOUBLE_COLON","::",62],["T_VARIABLE","$_shouldAskToCreateBillingAgreement",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_STRING","true",62],";",["T_WHITESPACE","\n                ",62],"}",["T_WHITESPACE","\n            ",63],"}",["T_WHITESPACE","\n        ",64],"}",["T_WHITESPACE","\n        ",65],["T_RETURN","return",66],["T_WHITESPACE"," ",66],["T_STRING","self",66],["T_DOUBLE_COLON","::",66],["T_VARIABLE","$_shouldAskToCreateBillingAgreement",66],";",["T_WHITESPACE","\n    ",66],"}",["T_WHITESPACE","\n\n    ",67],["T_DOC_COMMENT","\/**\n     * Return backend config for element like JSON\n     *\n     * @param Varien_Data_Form_Element_Abstract $element\n     * @return string\n     *\/",69],["T_WHITESPACE","\n    ",74],["T_PUBLIC","public",75],["T_WHITESPACE"," ",75],["T_FUNCTION","function",75],["T_WHITESPACE"," ",75],["T_STRING","getElementBackendConfig",75],"(",["T_STRING","Varien_Data_Form_Element_Abstract",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$element",75],")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$config",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$element",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getFieldConfig",76],"(",")",["T_OBJECT_OPERATOR","->",76],["T_STRING","backend_congif",76],";",["T_WHITESPACE","\n        ",76],["T_IF","if",77],["T_WHITESPACE"," ",77],"(","!",["T_VARIABLE","$config",77],")",["T_WHITESPACE"," ",77],"{",["T_WHITESPACE","\n            ",77],["T_RETURN","return",78],["T_WHITESPACE"," ",78],["T_STRING","false",78],";",["T_WHITESPACE","\n        ",78],"}",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$config",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$config",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","asCanonicalArray",80],"(",")",";",["T_WHITESPACE","\n        ",80],["T_IF","if",81],["T_WHITESPACE"," ",81],"(",["T_ISSET","isset",81],"(",["T_VARIABLE","$config",81],"[",["T_CONSTANT_ENCAPSED_STRING","'enable_for_countries'",81],"]",")",")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n            ",81],["T_VARIABLE","$config",82],"[",["T_CONSTANT_ENCAPSED_STRING","'enable_for_countries'",82],"]",["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_STRING","explode",82],"(",["T_CONSTANT_ENCAPSED_STRING","','",82],",",["T_WHITESPACE"," ",82],["T_STRING","str_replace",82],"(",["T_CONSTANT_ENCAPSED_STRING","' '",82],",",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","''",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$config",82],"[",["T_CONSTANT_ENCAPSED_STRING","'enable_for_countries'",82],"]",")",")",";",["T_WHITESPACE","\n        ",82],"}",["T_WHITESPACE","\n        ",83],["T_IF","if",84],["T_WHITESPACE"," ",84],"(",["T_ISSET","isset",84],"(",["T_VARIABLE","$config",84],"[",["T_CONSTANT_ENCAPSED_STRING","'disable_for_countries'",84],"]",")",")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n            ",84],["T_VARIABLE","$config",85],"[",["T_CONSTANT_ENCAPSED_STRING","'disable_for_countries'",85],"]",["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_STRING","explode",85],"(",["T_CONSTANT_ENCAPSED_STRING","','",85],",",["T_WHITESPACE"," ",85],["T_STRING","str_replace",85],"(",["T_CONSTANT_ENCAPSED_STRING","' '",85],",",["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","''",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$config",85],"[",["T_CONSTANT_ENCAPSED_STRING","'disable_for_countries'",85],"]",")",")",";",["T_WHITESPACE","\n        ",85],"}",["T_WHITESPACE","\n        ",86],["T_RETURN","return",87],["T_WHITESPACE"," ",87],["T_STRING","Mage",87],["T_DOUBLE_COLON","::",87],["T_STRING","helper",87],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",87],")",["T_OBJECT_OPERATOR","->",87],["T_STRING","jsonEncode",87],"(",["T_VARIABLE","$config",87],")",";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n\n    ",88],["T_DOC_COMMENT","\/**\n     * Get selected merchant country code in system configuration\n     *\n     * @return string\n     *\/",90],["T_WHITESPACE","\n    ",94],["T_PUBLIC","public",95],["T_WHITESPACE"," ",95],["T_FUNCTION","function",95],["T_WHITESPACE"," ",95],["T_STRING","getConfigurationCountryCode",95],"(",")",["T_WHITESPACE","\n    ",95],"{",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$requestParam",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_STRING","Mage_Paypal_Block_Adminhtml_System_Config_Field_Country",97],["T_DOUBLE_COLON","::",97],["T_STRING","REQUEST_PARAM_COUNTRY",97],";",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$countryCode",98],["T_WHITESPACE","  ",98],"=",["T_WHITESPACE"," ",98],["T_STRING","Mage",98],["T_DOUBLE_COLON","::",98],["T_STRING","app",98],"(",")",["T_OBJECT_OPERATOR","->",98],["T_STRING","getRequest",98],"(",")",["T_OBJECT_OPERATOR","->",98],["T_STRING","getParam",98],"(",["T_VARIABLE","$requestParam",98],")",";",["T_WHITESPACE","\n        ",98],["T_IF","if",99],["T_WHITESPACE"," ",99],"(",["T_STRING","is_null",99],"(",["T_VARIABLE","$countryCode",99],")",["T_WHITESPACE"," ",99],["T_BOOLEAN_OR","||",99],["T_WHITESPACE"," ",99],["T_STRING","preg_match",99],"(",["T_CONSTANT_ENCAPSED_STRING","'\/^[a-zA-Z]{2}$\/'",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$countryCode",99],")",["T_WHITESPACE"," ",99],["T_IS_EQUAL","==",99],["T_WHITESPACE"," ",99],["T_LNUMBER","0",99],")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n            ",99],["T_VARIABLE","$countryCode",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_STRING_CAST","(string)",100],["T_STRING","Mage",100],["T_DOUBLE_COLON","::",100],["T_STRING","getSingleton",100],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/config_data'",100],")",["T_WHITESPACE","\n                ",100],["T_OBJECT_OPERATOR","->",101],["T_STRING","getConfigDataValue",101],"(",["T_STRING","self",101],["T_DOUBLE_COLON","::",101],["T_STRING","MERCHANT_COUNTRY_CONFIG_PATH",101],")",";",["T_WHITESPACE","\n        ",101],"}",["T_WHITESPACE","\n        ",102],["T_IF","if",103],["T_WHITESPACE"," ",103],"(",["T_EMPTY","empty",103],"(",["T_VARIABLE","$countryCode",103],")",")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n            ",103],["T_VARIABLE","$countryCode",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_STRING","Mage",104],["T_DOUBLE_COLON","::",104],["T_STRING","helper",104],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",104],")",["T_OBJECT_OPERATOR","->",104],["T_STRING","getDefaultCountry",104],"(",")",";",["T_WHITESPACE","\n        ",104],"}",["T_WHITESPACE","\n        ",105],["T_RETURN","return",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$countryCode",106],";",["T_WHITESPACE","\n    ",106],"}",["T_WHITESPACE","\n\n    ",107],["T_DOC_COMMENT","\/**\n     * Get HTML representation of transaction id\n     *\n     * @param string $methodCode\n     * @param string $txnId\n     * @return string\n     *\/",109],["T_WHITESPACE","\n    ",115],["T_PUBLIC","public",116],["T_WHITESPACE"," ",116],["T_FUNCTION","function",116],["T_WHITESPACE"," ",116],["T_STRING","getHtmlTransactionId",116],"(",["T_VARIABLE","$methodCode",116],",",["T_WHITESPACE"," ",116],["T_VARIABLE","$txnId",116],")",["T_WHITESPACE","\n    ",116],"{",["T_WHITESPACE","\n        ",117],["T_IF","if",118],["T_WHITESPACE"," ",118],"(",["T_STRING","in_array",118],"(",["T_VARIABLE","$methodCode",118],",",["T_WHITESPACE"," ",118],["T_ARRAY","array",118],"(",["T_WHITESPACE","\n            ",118],["T_STRING","Mage_Paypal_Model_Config",119],["T_DOUBLE_COLON","::",119],["T_STRING","METHOD_WPP_DIRECT",119],",",["T_WHITESPACE","\n            ",119],["T_STRING","Mage_Paypal_Model_Config",120],["T_DOUBLE_COLON","::",120],["T_STRING","METHOD_WPP_EXPRESS",120],",",["T_WHITESPACE","\n            ",120],["T_STRING","Mage_Paypal_Model_Config",121],["T_DOUBLE_COLON","::",121],["T_STRING","METHOD_HOSTEDPRO",121],",",["T_WHITESPACE","\n            ",121],["T_STRING","Mage_Paypal_Model_Config",122],["T_DOUBLE_COLON","::",122],["T_STRING","METHOD_WPS",122],",",["T_WHITESPACE","\n        ",122],")",")",")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n            ",123],["T_DOC_COMMENT","\/** @var Mage_Paypal_Model_Config $config *\/",124],["T_WHITESPACE","\n            ",124],["T_VARIABLE","$config",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_STRING","Mage",125],["T_DOUBLE_COLON","::",125],["T_STRING","getModel",125],"(",["T_CONSTANT_ENCAPSED_STRING","'paypal\/config'",125],")",["T_OBJECT_OPERATOR","->",125],["T_STRING","setMethod",125],"(",["T_VARIABLE","$methodCode",125],")",";",["T_WHITESPACE","\n            ",125],["T_VARIABLE","$url",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'https:\/\/www.'",126],["T_WHITESPACE"," ",126],".",["T_WHITESPACE"," ",126],"(",["T_VARIABLE","$config",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","sandboxFlag",126],["T_WHITESPACE"," ",126],"?",["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'sandbox.'",126],["T_WHITESPACE"," ",126],":",["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","''",126],")",["T_WHITESPACE","\n                ",126],".",["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","'paypal.com\/cgi-bin\/webscr?cmd=_view-a-trans&id='",127],["T_WHITESPACE"," ",127],".",["T_WHITESPACE"," ",127],["T_VARIABLE","$txnId",127],";",["T_WHITESPACE","\n            ",127],["T_RETURN","return",128],["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'<a target=\"_blank\" href=\"'",128],["T_WHITESPACE"," ",128],".",["T_WHITESPACE"," ",128],["T_VARIABLE","$url",128],["T_WHITESPACE"," ",128],".",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'\">'",128],["T_WHITESPACE"," ",128],".",["T_WHITESPACE"," ",128],["T_VARIABLE","$txnId",128],["T_WHITESPACE"," ",128],".",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'<\/a>'",128],";",["T_WHITESPACE","\n        ",128],"}",["T_WHITESPACE","\n        ",129],["T_RETURN","return",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$txnId",130],";",["T_WHITESPACE","\n    ",130],"}",["T_WHITESPACE","\n",131],"}",["T_WHITESPACE","\n",132]]