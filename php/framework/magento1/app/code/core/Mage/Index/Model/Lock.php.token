[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Index\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Lock model\n *\n * @category Mage\n * @package Mage_Core\n * @author Magento Core Team core@magentocommerce.com\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Index_Model_Lock",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Lock storage config path\n     *\/",36],["T_WHITESPACE","\n    ",38],["T_CONST","const",39],["T_WHITESPACE"," ",39],["T_STRING","STORAGE_CONFIG_PATH",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'global\/index\/lock\/storage'",39],";",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * Storage instance\n     *\n     * @var Mage_Index_Model_Lock_Storage_Interface\n     *\/",41],["T_WHITESPACE","\n    ",45],["T_PROTECTED","protected",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$_storage",46],";",["T_WHITESPACE","\n\n    ",46],["T_DOC_COMMENT","\/**\n     * Singleton instance\n     *\n     * @var Mage_Index_Model_Lock\n     *\/",48],["T_WHITESPACE","\n    ",52],["T_PROTECTED","protected",53],["T_WHITESPACE"," ",53],["T_STATIC","static",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$_instance",53],";",["T_WHITESPACE","\n\n    ",53],["T_DOC_COMMENT","\/**\n     * Array of registered DB locks\n     *\n     * @var array\n     *\/",55],["T_WHITESPACE","\n    ",59],["T_PROTECTED","protected",60],["T_WHITESPACE"," ",60],["T_STATIC","static",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$_lockDb",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_ARRAY","array",60],"(",")",";",["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * Array of registered file locks\n     *\n     * @var array\n     *\/",62],["T_WHITESPACE","\n    ",66],["T_PROTECTED","protected",67],["T_WHITESPACE"," ",67],["T_STATIC","static",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$_lockFile",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_ARRAY","array",67],"(",")",";",["T_WHITESPACE","\n\n    ",67],["T_DOC_COMMENT","\/**\n     * Array of registered file lock resources\n     *\n     * @var array\n     *\/",69],["T_WHITESPACE","\n    ",73],["T_PROTECTED","protected",74],["T_WHITESPACE"," ",74],["T_STATIC","static",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$_lockFileResource",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_ARRAY","array",74],"(",")",";",["T_WHITESPACE","\n\n    ",74],["T_DOC_COMMENT","\/**\n     * Constructor\n     *\/",76],["T_WHITESPACE","\n    ",78],["T_PROTECTED","protected",79],["T_WHITESPACE"," ",79],["T_FUNCTION","function",79],["T_WHITESPACE"," ",79],["T_STRING","__construct",79],"(",")",["T_WHITESPACE","\n    ",79],"{",["T_WHITESPACE","\n        ",80],["T_STRING","register_shutdown_function",81],"(",["T_ARRAY","array",81],"(",["T_VARIABLE","$this",81],",",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'shutdownReleaseLocks'",81],")",")",";",["T_WHITESPACE","\n    ",81],"}",["T_WHITESPACE","\n\n    ",82],["T_DOC_COMMENT","\/**\n     * Get lock singleton instance\n     *\n     * @return Mage_Index_Model_Lock\n     *\/",84],["T_WHITESPACE","\n    ",88],["T_PUBLIC","public",89],["T_WHITESPACE"," ",89],["T_STATIC","static",89],["T_WHITESPACE"," ",89],["T_FUNCTION","function",89],["T_WHITESPACE"," ",89],["T_STRING","getInstance",89],"(",")",["T_WHITESPACE","\n    ",89],"{",["T_WHITESPACE","\n        ",90],["T_IF","if",91],["T_WHITESPACE"," ",91],"(","!",["T_STRING","self",91],["T_DOUBLE_COLON","::",91],["T_VARIABLE","$_instance",91],["T_WHITESPACE"," ",91],["T_INSTANCEOF","instanceof",91],["T_WHITESPACE"," ",91],["T_STRING","self",91],")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n            ",91],["T_STRING","self",92],["T_DOUBLE_COLON","::",92],["T_VARIABLE","$_instance",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_NEW","new",92],["T_WHITESPACE"," ",92],["T_STRING","self",92],"(",")",";",["T_WHITESPACE","\n        ",92],"}",["T_WHITESPACE","\n        ",93],["T_RETURN","return",94],["T_WHITESPACE"," ",94],["T_STRING","self",94],["T_DOUBLE_COLON","::",94],["T_VARIABLE","$_instance",94],";",["T_WHITESPACE","\n    ",94],"}",["T_WHITESPACE","\n\n    ",95],["T_DOC_COMMENT","\/**\n     * Release all locks on application shutdown\n     *\/",97],["T_WHITESPACE","\n    ",99],["T_PUBLIC","public",100],["T_WHITESPACE"," ",100],["T_FUNCTION","function",100],["T_WHITESPACE"," ",100],["T_STRING","shutdownReleaseLocks",100],"(",")",["T_WHITESPACE","\n    ",100],"{",["T_WHITESPACE","\n        ",101],["T_FOREACH","foreach",102],["T_WHITESPACE"," ",102],"(",["T_STRING","self",102],["T_DOUBLE_COLON","::",102],["T_VARIABLE","$_lockDb",102],["T_WHITESPACE"," ",102],["T_AS","as",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$lockDb",102],")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n            ",102],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","_releaseLockDb",103],"(",["T_VARIABLE","$lockDb",103],")",";",["T_WHITESPACE","\n        ",103],"}",["T_WHITESPACE","\n        ",104],["T_FOREACH","foreach",105],["T_WHITESPACE"," ",105],"(",["T_STRING","self",105],["T_DOUBLE_COLON","::",105],["T_VARIABLE","$_lockFile",105],["T_WHITESPACE"," ",105],["T_AS","as",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$lockFile",105],")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n            ",105],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","_releaseLockFile",106],"(",["T_VARIABLE","$lockFile",106],")",";",["T_WHITESPACE","\n        ",106],"}",["T_WHITESPACE","\n        ",107],["T_FOREACH","foreach",108],["T_WHITESPACE"," ",108],"(",["T_STRING","self",108],["T_DOUBLE_COLON","::",108],["T_VARIABLE","$_lockFileResource",108],["T_WHITESPACE"," ",108],["T_AS","as",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$lockFileResource",108],")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n            ",108],["T_IF","if",109],["T_WHITESPACE"," ",109],"(",["T_VARIABLE","$lockFileResource",109],")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n                ",109],["T_STRING","fclose",110],"(",["T_VARIABLE","$lockFileResource",110],")",";",["T_WHITESPACE","\n            ",110],"}",["T_WHITESPACE","\n        ",111],"}",["T_WHITESPACE","\n    ",112],"}",["T_WHITESPACE","\n\n    ",113],["T_DOC_COMMENT","\/**\n     * Set named lock\n     *\n     * @param string $lockName\n     * @param bool $file\n     * @param bool $block\n     * @return bool\n     *\/",115],["T_WHITESPACE","\n    ",122],["T_PUBLIC","public",123],["T_WHITESPACE"," ",123],["T_FUNCTION","function",123],["T_WHITESPACE"," ",123],["T_STRING","setLock",123],"(",["T_VARIABLE","$lockName",123],",",["T_WHITESPACE"," ",123],["T_VARIABLE","$file",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_STRING","false",123],",",["T_WHITESPACE"," ",123],["T_VARIABLE","$block",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_STRING","false",123],")",["T_WHITESPACE","\n    ",123],"{",["T_WHITESPACE","\n        ",124],["T_IF","if",125],["T_WHITESPACE"," ",125],"(",["T_VARIABLE","$file",125],")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n            ",125],["T_RETURN","return",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","_setLockFile",126],"(",["T_VARIABLE","$lockName",126],",",["T_WHITESPACE"," ",126],["T_VARIABLE","$block",126],")",";",["T_WHITESPACE","\n        ",126],"}",["T_WHITESPACE"," ",127],["T_ELSE","else",127],["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n            ",127],["T_RETURN","return",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","_setLockDb",128],"(",["T_VARIABLE","$lockName",128],",",["T_WHITESPACE"," ",128],["T_VARIABLE","$block",128],")",";",["T_WHITESPACE","\n        ",128],"}",["T_WHITESPACE","\n    ",129],"}",["T_WHITESPACE","\n\n    ",130],["T_DOC_COMMENT","\/**\n     * Set named file lock\n     *\n     * @param string $lockName\n     * @param bool $block\n     * @return bool\n     *\/",132],["T_WHITESPACE","\n    ",138],["T_PROTECTED","protected",139],["T_WHITESPACE"," ",139],["T_FUNCTION","function",139],["T_WHITESPACE"," ",139],["T_STRING","_setLockFile",139],"(",["T_VARIABLE","$lockName",139],",",["T_WHITESPACE"," ",139],["T_VARIABLE","$block",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_STRING","false",139],")",["T_WHITESPACE","\n    ",139],"{",["T_WHITESPACE","\n        ",140],["T_IF","if",141],["T_WHITESPACE"," ",141],"(",["T_VARIABLE","$block",141],")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n            ",141],["T_VARIABLE","$result",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_STRING","flock",142],"(",["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","_getLockFile",142],"(",["T_VARIABLE","$lockName",142],")",",",["T_WHITESPACE"," ",142],["T_STRING","LOCK_EX",142],")",";",["T_WHITESPACE","\n        ",142],"}",["T_WHITESPACE"," ",143],["T_ELSE","else",143],["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n            ",143],["T_VARIABLE","$result",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_STRING","flock",144],"(",["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","_getLockFile",144],"(",["T_VARIABLE","$lockName",144],")",",",["T_WHITESPACE"," ",144],["T_STRING","LOCK_EX",144],["T_WHITESPACE"," ",144],"|",["T_WHITESPACE"," ",144],["T_STRING","LOCK_NB",144],")",";",["T_WHITESPACE","\n        ",144],"}",["T_WHITESPACE","\n        ",145],["T_IF","if",146],["T_WHITESPACE"," ",146],"(",["T_VARIABLE","$result",146],")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n            ",146],["T_STRING","self",147],["T_DOUBLE_COLON","::",147],["T_VARIABLE","$_lockFile",147],"[",["T_VARIABLE","$lockName",147],"]",["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_VARIABLE","$lockName",147],";",["T_WHITESPACE","\n            ",147],["T_RETURN","return",148],["T_WHITESPACE"," ",148],["T_STRING","true",148],";",["T_WHITESPACE","\n        ",148],"}",["T_WHITESPACE","\n        ",149],["T_RETURN","return",150],["T_WHITESPACE"," ",150],["T_STRING","false",150],";",["T_WHITESPACE","\n    ",150],"}",["T_WHITESPACE","\n\n    ",151],["T_DOC_COMMENT","\/**\n     * Set named DB lock\n     *\n     * @param string $lockName\n     * @param bool $block\n     * @return bool\n     *\/",153],["T_WHITESPACE","\n    ",159],["T_PROTECTED","protected",160],["T_WHITESPACE"," ",160],["T_FUNCTION","function",160],["T_WHITESPACE"," ",160],["T_STRING","_setLockDb",160],"(",["T_VARIABLE","$lockName",160],",",["T_WHITESPACE"," ",160],["T_VARIABLE","$block",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_STRING","false",160],")",["T_WHITESPACE","\n    ",160],"{",["T_WHITESPACE","\n        ",161],["T_IF","if",162],["T_WHITESPACE"," ",162],"(",["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","_getLockStorage",162],"(",")",["T_OBJECT_OPERATOR","->",162],["T_STRING","setLock",162],"(",["T_VARIABLE","$lockName",162],")",")",["T_WHITESPACE"," ",162],"{",["T_WHITESPACE","\n            ",162],["T_STRING","self",163],["T_DOUBLE_COLON","::",163],["T_VARIABLE","$_lockDb",163],"[",["T_VARIABLE","$lockName",163],"]",["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_VARIABLE","$lockName",163],";",["T_WHITESPACE","\n            ",163],["T_RETURN","return",164],["T_WHITESPACE"," ",164],["T_STRING","true",164],";",["T_WHITESPACE","\n        ",164],"}",["T_WHITESPACE","\n        ",165],["T_RETURN","return",166],["T_WHITESPACE"," ",166],["T_STRING","false",166],";",["T_WHITESPACE","\n    ",166],"}",["T_WHITESPACE","\n\n    ",167],["T_DOC_COMMENT","\/**\n     * Release named lock by name\n     *\n     * @param string $lockName\n     * @param bool $file\n     * @return bool\n     *\/",169],["T_WHITESPACE","\n    ",175],["T_PUBLIC","public",176],["T_WHITESPACE"," ",176],["T_FUNCTION","function",176],["T_WHITESPACE"," ",176],["T_STRING","releaseLock",176],"(",["T_VARIABLE","$lockName",176],",",["T_WHITESPACE"," ",176],["T_VARIABLE","$file",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_STRING","false",176],")",["T_WHITESPACE","\n    ",176],"{",["T_WHITESPACE","\n        ",177],["T_IF","if",178],["T_WHITESPACE"," ",178],"(",["T_VARIABLE","$file",178],")",["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n            ",178],["T_RETURN","return",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","_releaseLockFile",179],"(",["T_VARIABLE","$lockName",179],")",";",["T_WHITESPACE","\n        ",179],"}",["T_WHITESPACE"," ",180],["T_ELSE","else",180],["T_WHITESPACE"," ",180],"{",["T_WHITESPACE","\n            ",180],["T_RETURN","return",181],["T_WHITESPACE"," ",181],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","_releaseLockDb",181],"(",["T_VARIABLE","$lockName",181],")",";",["T_WHITESPACE","\n        ",181],"}",["T_WHITESPACE","\n    ",182],"}",["T_WHITESPACE","\n\n    ",183],["T_DOC_COMMENT","\/**\n     * Release named file lock by name\n     *\n     * @param string $lockName\n     * @return bool\n     *\/",185],["T_WHITESPACE","\n    ",190],["T_PROTECTED","protected",191],["T_WHITESPACE"," ",191],["T_FUNCTION","function",191],["T_WHITESPACE"," ",191],["T_STRING","_releaseLockFile",191],"(",["T_VARIABLE","$lockName",191],")",["T_WHITESPACE","\n    ",191],"{",["T_WHITESPACE","\n        ",192],["T_IF","if",193],["T_WHITESPACE"," ",193],"(",["T_STRING","flock",193],"(",["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","_getLockFile",193],"(",["T_VARIABLE","$lockName",193],")",",",["T_WHITESPACE"," ",193],["T_STRING","LOCK_UN",193],")",")",["T_WHITESPACE"," ",193],"{",["T_WHITESPACE","\n            ",193],["T_UNSET","unset",194],"(",["T_STRING","self",194],["T_DOUBLE_COLON","::",194],["T_VARIABLE","$_lockFile",194],"[",["T_VARIABLE","$lockName",194],"]",")",";",["T_WHITESPACE","\n            ",194],["T_RETURN","return",195],["T_WHITESPACE"," ",195],["T_STRING","true",195],";",["T_WHITESPACE","\n        ",195],"}",["T_WHITESPACE","\n        ",196],["T_RETURN","return",197],["T_WHITESPACE"," ",197],["T_STRING","false",197],";",["T_WHITESPACE","\n    ",197],"}",["T_WHITESPACE","\n\n    ",198],["T_DOC_COMMENT","\/**\n     * Release named DB lock by name\n     *\n     * @param string $lockName\n     * @return bool\n     *\/",200],["T_WHITESPACE","\n    ",205],["T_PROTECTED","protected",206],["T_WHITESPACE"," ",206],["T_FUNCTION","function",206],["T_WHITESPACE"," ",206],["T_STRING","_releaseLockDb",206],"(",["T_VARIABLE","$lockName",206],")",["T_WHITESPACE","\n    ",206],"{",["T_WHITESPACE","\n        ",207],["T_IF","if",208],["T_WHITESPACE"," ",208],"(",["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","_getLockStorage",208],"(",")",["T_OBJECT_OPERATOR","->",208],["T_STRING","releaseLock",208],"(",["T_VARIABLE","$lockName",208],")",")",["T_WHITESPACE"," ",208],"{",["T_WHITESPACE","\n            ",208],["T_UNSET","unset",209],"(",["T_STRING","self",209],["T_DOUBLE_COLON","::",209],["T_VARIABLE","$_lockDb",209],"[",["T_VARIABLE","$lockName",209],"]",")",";",["T_WHITESPACE","\n            ",209],["T_RETURN","return",210],["T_WHITESPACE"," ",210],["T_STRING","true",210],";",["T_WHITESPACE","\n        ",210],"}",["T_WHITESPACE","\n        ",211],["T_RETURN","return",212],["T_WHITESPACE"," ",212],["T_STRING","false",212],";",["T_WHITESPACE","\n    ",212],"}",["T_WHITESPACE","\n\n    ",213],["T_DOC_COMMENT","\/**\n     * Check whether the named lock exists\n     *\n     * @param string $lockName\n     * @param bool $file\n     * @return bool\n     *\/",215],["T_WHITESPACE","\n    ",221],["T_PUBLIC","public",222],["T_WHITESPACE"," ",222],["T_FUNCTION","function",222],["T_WHITESPACE"," ",222],["T_STRING","isLockExists",222],"(",["T_VARIABLE","$lockName",222],",",["T_WHITESPACE"," ",222],["T_VARIABLE","$file",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_STRING","false",222],")",["T_WHITESPACE","\n    ",222],"{",["T_WHITESPACE","\n        ",223],["T_IF","if",224],["T_WHITESPACE"," ",224],"(",["T_VARIABLE","$file",224],")",["T_WHITESPACE"," ",224],"{",["T_WHITESPACE","\n            ",224],["T_RETURN","return",225],["T_WHITESPACE"," ",225],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","_isLockExistsFile",225],"(",["T_VARIABLE","$lockName",225],")",";",["T_WHITESPACE","\n        ",225],"}",["T_WHITESPACE"," ",226],["T_ELSE","else",226],["T_WHITESPACE"," ",226],"{",["T_WHITESPACE","\n            ",226],["T_RETURN","return",227],["T_WHITESPACE"," ",227],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","_isLockExistsDb",227],"(",["T_VARIABLE","$lockName",227],")",";",["T_WHITESPACE","\n        ",227],"}",["T_WHITESPACE","\n    ",228],"}",["T_WHITESPACE","\n\n    ",229],["T_DOC_COMMENT","\/**\n     * Check whether the named file lock exists\n     *\n     * @param string $lockName\n     * @return bool\n     *\/",231],["T_WHITESPACE","\n    ",236],["T_PROTECTED","protected",237],["T_WHITESPACE"," ",237],["T_FUNCTION","function",237],["T_WHITESPACE"," ",237],["T_STRING","_isLockExistsFile",237],"(",["T_VARIABLE","$lockName",237],")",["T_WHITESPACE","\n    ",237],"{",["T_WHITESPACE","\n        ",238],["T_VARIABLE","$result",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_STRING","true",239],";",["T_WHITESPACE","\n        ",239],["T_VARIABLE","$fp",240],["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","_getLockFile",240],"(",["T_VARIABLE","$lockName",240],")",";",["T_WHITESPACE","\n        ",240],["T_IF","if",241],["T_WHITESPACE"," ",241],"(",["T_STRING","flock",241],"(",["T_VARIABLE","$fp",241],",",["T_WHITESPACE"," ",241],["T_STRING","LOCK_EX",241],["T_WHITESPACE"," ",241],"|",["T_WHITESPACE"," ",241],["T_STRING","LOCK_NB",241],")",")",["T_WHITESPACE"," ",241],"{",["T_WHITESPACE","\n            ",241],["T_STRING","flock",242],"(",["T_VARIABLE","$fp",242],",",["T_WHITESPACE"," ",242],["T_STRING","LOCK_UN",242],")",";",["T_WHITESPACE","\n            ",242],["T_VARIABLE","$result",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_STRING","false",243],";",["T_WHITESPACE","\n        ",243],"}",["T_WHITESPACE","\n        ",244],["T_RETURN","return",245],["T_WHITESPACE"," ",245],["T_VARIABLE","$result",245],";",["T_WHITESPACE","\n    ",245],"}",["T_WHITESPACE","\n\n\n    ",246],["T_DOC_COMMENT","\/**\n     * Check whether the named DB lock exists\n     *\n     * @param string $lockName\n     * @return bool\n     *\/",249],["T_WHITESPACE","\n    ",254],["T_PROTECTED","protected",255],["T_WHITESPACE"," ",255],["T_FUNCTION","function",255],["T_WHITESPACE"," ",255],["T_STRING","_isLockExistsDb",255],"(",["T_VARIABLE","$lockName",255],")",["T_WHITESPACE","\n    ",255],"{",["T_WHITESPACE","\n        ",256],["T_RETURN","return",257],["T_WHITESPACE"," ",257],["T_BOOL_CAST","(bool)",257],["T_WHITESPACE"," ",257],["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","_getLockStorage",257],"(",")",["T_OBJECT_OPERATOR","->",257],["T_STRING","isLockExists",257],"(",["T_VARIABLE","$lockName",257],")",";",["T_WHITESPACE","\n    ",257],"}",["T_WHITESPACE","\n\n    ",258],["T_DOC_COMMENT","\/**\n     * Get lock storage model\n     *\n     * @return Mage_Index_Model_Lock_Storage_Interface\n     *\/",260],["T_WHITESPACE","\n    ",264],["T_PROTECTED","protected",265],["T_WHITESPACE"," ",265],["T_FUNCTION","function",265],["T_WHITESPACE"," ",265],["T_STRING","_getLockStorage",265],"(",")",["T_WHITESPACE","\n    ",265],"{",["T_WHITESPACE","\n        ",266],["T_IF","if",267],["T_WHITESPACE"," ",267],"(","!",["T_VARIABLE","$this",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","_storage",267],["T_WHITESPACE"," ",267],["T_INSTANCEOF","instanceof",267],["T_WHITESPACE"," ",267],["T_STRING","Mage_Index_Model_Lock_Storage_Interface",267],")",["T_WHITESPACE"," ",267],"{",["T_WHITESPACE","\n            ",267],["T_VARIABLE","$config",268],["T_WHITESPACE"," ",268],"=",["T_WHITESPACE"," ",268],["T_STRING","Mage",268],["T_DOUBLE_COLON","::",268],["T_STRING","getConfig",268],"(",")",["T_OBJECT_OPERATOR","->",268],["T_STRING","getNode",268],"(",["T_STRING","self",268],["T_DOUBLE_COLON","::",268],["T_STRING","STORAGE_CONFIG_PATH",268],")",";",["T_WHITESPACE","\n            ",268],["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","_storage",269],["T_WHITESPACE"," ",269],"=",["T_WHITESPACE"," ",269],["T_STRING","Mage",269],["T_DOUBLE_COLON","::",269],["T_STRING","getModel",269],"(",["T_VARIABLE","$config",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","model",269],")",";",["T_WHITESPACE","\n        ",269],"}",["T_WHITESPACE","\n        ",270],["T_RETURN","return",271],["T_WHITESPACE"," ",271],["T_VARIABLE","$this",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","_storage",271],";",["T_WHITESPACE","\n    ",271],"}",["T_WHITESPACE","\n\n    ",272],["T_DOC_COMMENT","\/**\n     * Get lock file resource\n     *\n     * @param string $lockName\n     * @return resource\n     *\/",274],["T_WHITESPACE","\n    ",279],["T_PROTECTED","protected",280],["T_WHITESPACE"," ",280],["T_FUNCTION","function",280],["T_WHITESPACE"," ",280],["T_STRING","_getLockFile",280],"(",["T_VARIABLE","$lockName",280],")",["T_WHITESPACE","\n    ",280],"{",["T_WHITESPACE","\n        ",281],["T_IF","if",282],["T_WHITESPACE"," ",282],"(","!",["T_ISSET","isset",282],"(",["T_STRING","self",282],["T_DOUBLE_COLON","::",282],["T_VARIABLE","$_lockFileResource",282],"[",["T_VARIABLE","$lockName",282],"]",")",["T_WHITESPACE"," ",282],["T_BOOLEAN_OR","||",282],["T_WHITESPACE"," ",282],["T_STRING","self",282],["T_DOUBLE_COLON","::",282],["T_VARIABLE","$_lockFileResource",282],"[",["T_VARIABLE","$lockName",282],"]",["T_WHITESPACE"," ",282],["T_IS_IDENTICAL","===",282],["T_WHITESPACE"," ",282],["T_STRING","null",282],")",["T_WHITESPACE"," ",282],"{",["T_WHITESPACE","\n            ",282],["T_VARIABLE","$varDir",283],["T_WHITESPACE"," ",283],"=",["T_WHITESPACE"," ",283],["T_STRING","Mage",283],["T_DOUBLE_COLON","::",283],["T_STRING","getConfig",283],"(",")",["T_OBJECT_OPERATOR","->",283],["T_STRING","getVarDir",283],"(",["T_CONSTANT_ENCAPSED_STRING","'locks'",283],")",";",["T_WHITESPACE","\n            ",283],["T_VARIABLE","$file",284],["T_WHITESPACE"," ",284],"=",["T_WHITESPACE"," ",284],["T_VARIABLE","$varDir",284],["T_WHITESPACE"," ",284],".",["T_WHITESPACE"," ",284],["T_STRING","DS",284],["T_WHITESPACE"," ",284],".",["T_WHITESPACE"," ",284],["T_VARIABLE","$lockName",284],["T_WHITESPACE"," ",284],".",["T_WHITESPACE"," ",284],["T_CONSTANT_ENCAPSED_STRING","'.lock'",284],";",["T_WHITESPACE","\n            ",284],["T_IF","if",285],["T_WHITESPACE"," ",285],"(",["T_STRING","is_file",285],"(",["T_VARIABLE","$file",285],")",")",["T_WHITESPACE"," ",285],"{",["T_WHITESPACE","\n                ",285],["T_STRING","self",286],["T_DOUBLE_COLON","::",286],["T_VARIABLE","$_lockFileResource",286],"[",["T_VARIABLE","$lockName",286],"]",["T_WHITESPACE"," ",286],"=",["T_WHITESPACE"," ",286],["T_STRING","fopen",286],"(",["T_VARIABLE","$file",286],",",["T_WHITESPACE"," ",286],["T_CONSTANT_ENCAPSED_STRING","'w'",286],")",";",["T_WHITESPACE","\n            ",286],"}",["T_WHITESPACE"," ",287],["T_ELSE","else",287],["T_WHITESPACE"," ",287],"{",["T_WHITESPACE","\n                ",287],["T_STRING","self",288],["T_DOUBLE_COLON","::",288],["T_VARIABLE","$_lockFileResource",288],"[",["T_VARIABLE","$lockName",288],"]",["T_WHITESPACE"," ",288],"=",["T_WHITESPACE"," ",288],["T_STRING","fopen",288],"(",["T_VARIABLE","$file",288],",",["T_WHITESPACE"," ",288],["T_CONSTANT_ENCAPSED_STRING","'x'",288],")",";",["T_WHITESPACE","\n            ",288],"}",["T_WHITESPACE","\n            ",289],["T_STRING","fwrite",290],"(",["T_STRING","self",290],["T_DOUBLE_COLON","::",290],["T_VARIABLE","$_lockFileResource",290],"[",["T_VARIABLE","$lockName",290],"]",",",["T_WHITESPACE"," ",290],["T_STRING","date",290],"(",["T_CONSTANT_ENCAPSED_STRING","'r'",290],")",")",";",["T_WHITESPACE","\n        ",290],"}",["T_WHITESPACE","\n        ",291],["T_RETURN","return",292],["T_WHITESPACE"," ",292],["T_STRING","self",292],["T_DOUBLE_COLON","::",292],["T_VARIABLE","$_lockFileResource",292],"[",["T_VARIABLE","$lockName",292],"]",";",["T_WHITESPACE","\n    ",292],"}",["T_WHITESPACE","\n",293],"}",["T_WHITESPACE","\n",294]]