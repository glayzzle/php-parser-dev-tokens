[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Index\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Enter description here ...\n *\n * @method Mage_Index_Model_Resource_Process _getResource()\n * @method Mage_Index_Model_Resource_Process getResource()\n * @method string getIndexerCode()\n * @method Mage_Index_Model_Process setIndexerCode(string $value)\n * @method string getStatus()\n * @method Mage_Index_Model_Process setStatus(string $value)\n * @method string getStartedAt()\n * @method Mage_Index_Model_Process setStartedAt(string $value)\n * @method string getEndedAt()\n * @method Mage_Index_Model_Process setEndedAt(string $value)\n * @method string getMode()\n * @method Mage_Index_Model_Process setMode(string $value)\n *\n * @category    Mage\n * @package     Mage_Index\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",46],["T_CLASS","class",47],["T_WHITESPACE"," ",47],["T_STRING","Mage_Index_Model_Process",47],["T_WHITESPACE"," ",47],["T_EXTENDS","extends",47],["T_WHITESPACE"," ",47],["T_STRING","Mage_Core_Model_Abstract",47],["T_WHITESPACE","\n",47],"{",["T_WHITESPACE","\n    ",48],["T_CONST","const",49],["T_WHITESPACE"," ",49],["T_STRING","XML_PATH_INDEXER_DATA",49],["T_WHITESPACE","     ",49],"=",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'global\/index\/indexer'",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Process statuses\n     *\/",51],["T_WHITESPACE","\n    ",53],["T_CONST","const",54],["T_WHITESPACE"," ",54],["T_STRING","STATUS_RUNNING",54],["T_WHITESPACE","            ",54],"=",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'working'",54],";",["T_WHITESPACE","\n    ",54],["T_CONST","const",55],["T_WHITESPACE"," ",55],["T_STRING","STATUS_PENDING",55],["T_WHITESPACE","            ",55],"=",["T_WHITESPACE"," ",55],["T_CONSTANT_ENCAPSED_STRING","'pending'",55],";",["T_WHITESPACE","\n    ",55],["T_CONST","const",56],["T_WHITESPACE"," ",56],["T_STRING","STATUS_REQUIRE_REINDEX",56],["T_WHITESPACE","    ",56],"=",["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'require_reindex'",56],";",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * Process event statuses\n     *\/",58],["T_WHITESPACE","\n    ",60],["T_CONST","const",61],["T_WHITESPACE"," ",61],["T_STRING","EVENT_STATUS_NEW",61],["T_WHITESPACE","          ",61],"=",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'new'",61],";",["T_WHITESPACE","\n    ",61],["T_CONST","const",62],["T_WHITESPACE"," ",62],["T_STRING","EVENT_STATUS_DONE",62],["T_WHITESPACE","         ",62],"=",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'done'",62],";",["T_WHITESPACE","\n    ",62],["T_CONST","const",63],["T_WHITESPACE"," ",63],["T_STRING","EVENT_STATUS_ERROR",63],["T_WHITESPACE","        ",63],"=",["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","'error'",63],";",["T_WHITESPACE","\n    ",63],["T_CONST","const",64],["T_WHITESPACE"," ",64],["T_STRING","EVENT_STATUS_WORKING",64],["T_WHITESPACE","      ",64],"=",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'working'",64],";",["T_WHITESPACE","\n\n    ",64],["T_DOC_COMMENT","\/**\n     * Process modes\n     * Process mode allow disable automatic process events processing\n     *\/",66],["T_WHITESPACE","\n    ",69],["T_CONST","const",70],["T_WHITESPACE"," ",70],["T_STRING","MODE_MANUAL",70],["T_WHITESPACE","              ",70],"=",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'manual'",70],";",["T_WHITESPACE","\n    ",70],["T_CONST","const",71],["T_WHITESPACE"," ",71],["T_STRING","MODE_REAL_TIME",71],["T_WHITESPACE","           ",71],"=",["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'real_time'",71],";",["T_WHITESPACE","\n    ",71],["T_CONST","const",72],["T_WHITESPACE"," ",72],["T_STRING","MODE_SCHEDULE",72],["T_WHITESPACE","            ",72],"=",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'schedule'",72],";",["T_WHITESPACE","\n\n    ",72],["T_DOC_COMMENT","\/**\n     * Indexer stategy object\n     *\n     * @var Mage_Index_Model_Indexer_Abstract\n     *\/",74],["T_WHITESPACE","\n    ",78],["T_PROTECTED","protected",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$_indexer",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_STRING","null",79],";",["T_WHITESPACE","\n\n    ",79],["T_DOC_COMMENT","\/**\n     * Locker Object\n     *\n     * @var Mage_Index_Model_Lock\n     *\/",81],["T_WHITESPACE","\n    ",85],["T_PROTECTED","protected",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$_lockInstance",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_STRING","null",86],";",["T_WHITESPACE","\n\n    ",86],["T_DOC_COMMENT","\/**\n     * Whether table changes are allowed\n     *\n     * @deprecated after 1.6.1.0\n     * @var bool\n     *\/",88],["T_WHITESPACE","\n    ",93],["T_PROTECTED","protected",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$_allowTableChanges",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_STRING","true",94],";",["T_WHITESPACE","\n\n    ",94],["T_DOC_COMMENT","\/**\n     * Initialize resource\n     *\/",96],["T_WHITESPACE","\n    ",98],["T_PROTECTED","protected",99],["T_WHITESPACE"," ",99],["T_FUNCTION","function",99],["T_WHITESPACE"," ",99],["T_STRING","_construct",99],"(",")",["T_WHITESPACE","\n    ",99],"{",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","_init",101],"(",["T_CONSTANT_ENCAPSED_STRING","'index\/process'",101],")",";",["T_WHITESPACE","\n    ",101],"}",["T_WHITESPACE","\n\n    ",102],["T_DOC_COMMENT","\/**\n     * Set indexer class name as data namespace for event object\n     *\n     * @param   Mage_Index_Model_Event $event\n     * @return  Mage_Index_Model_Process\n     *\/",104],["T_WHITESPACE","\n    ",109],["T_PROTECTED","protected",110],["T_WHITESPACE"," ",110],["T_FUNCTION","function",110],["T_WHITESPACE"," ",110],["T_STRING","_setEventNamespace",110],"(",["T_STRING","Mage_Index_Model_Event",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$event",110],")",["T_WHITESPACE","\n    ",110],"{",["T_WHITESPACE","\n        ",111],["T_VARIABLE","$namespace",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_STRING","get_class",112],"(",["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","getIndexer",112],"(",")",")",";",["T_WHITESPACE","\n        ",112],["T_VARIABLE","$event",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","setDataNamespace",113],"(",["T_VARIABLE","$namespace",113],")",";",["T_WHITESPACE","\n        ",113],["T_VARIABLE","$event",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","setProcess",114],"(",["T_VARIABLE","$this",114],")",";",["T_WHITESPACE","\n        ",114],["T_RETURN","return",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$this",115],";",["T_WHITESPACE","\n    ",115],"}",["T_WHITESPACE","\n\n    ",116],["T_DOC_COMMENT","\/**\n     * Remove indexer namespace from event\n     *\n     * @param Mage_Index_Model_Event $event\n     * @return Mage_Index_Model_Process\n     *\/",118],["T_WHITESPACE","\n    ",123],["T_PROTECTED","protected",124],["T_WHITESPACE"," ",124],["T_FUNCTION","function",124],["T_WHITESPACE"," ",124],["T_STRING","_resetEventNamespace",124],"(",["T_VARIABLE","$event",124],")",["T_WHITESPACE","\n    ",124],"{",["T_WHITESPACE","\n        ",125],["T_VARIABLE","$event",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","setDataNamespace",126],"(",["T_STRING","null",126],")",";",["T_WHITESPACE","\n        ",126],["T_VARIABLE","$event",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","setProcess",127],"(",["T_STRING","null",127],")",";",["T_WHITESPACE","\n        ",127],["T_RETURN","return",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$this",128],";",["T_WHITESPACE","\n    ",128],"}",["T_WHITESPACE","\n\n    ",129],["T_DOC_COMMENT","\/**\n     * Register data required by process in event object\n     *\n     * @param Mage_Index_Model_Event $event\n     * @return Mage_Index_Model_Process\n     *\/",131],["T_WHITESPACE","\n    ",136],["T_PUBLIC","public",137],["T_WHITESPACE"," ",137],["T_FUNCTION","function",137],["T_WHITESPACE"," ",137],["T_STRING","register",137],"(",["T_STRING","Mage_Index_Model_Event",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$event",137],")",["T_WHITESPACE","\n    ",137],"{",["T_WHITESPACE","\n        ",138],["T_IF","if",139],["T_WHITESPACE"," ",139],"(",["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","matchEvent",139],"(",["T_VARIABLE","$event",139],")",")",["T_WHITESPACE"," ",139],"{",["T_WHITESPACE","\n            ",139],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","_setEventNamespace",140],"(",["T_VARIABLE","$event",140],")",";",["T_WHITESPACE","\n            ",140],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getIndexer",141],"(",")",["T_OBJECT_OPERATOR","->",141],["T_STRING","register",141],"(",["T_VARIABLE","$event",141],")",";",["T_WHITESPACE","\n            ",141],["T_VARIABLE","$event",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","addProcessId",142],"(",["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","getId",142],"(",")",")",";",["T_WHITESPACE","\n            ",142],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","_resetEventNamespace",143],"(",["T_VARIABLE","$event",143],")",";",["T_WHITESPACE","\n            ",143],["T_IF","if",144],["T_WHITESPACE"," ",144],"(",["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","getMode",144],"(",")",["T_WHITESPACE"," ",144],["T_IS_EQUAL","==",144],["T_WHITESPACE"," ",144],["T_STRING","self",144],["T_DOUBLE_COLON","::",144],["T_STRING","MODE_MANUAL",144],")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n                ",144],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","_getResource",145],"(",")",["T_OBJECT_OPERATOR","->",145],["T_STRING","updateStatus",145],"(",["T_VARIABLE","$this",145],",",["T_WHITESPACE"," ",145],["T_STRING","self",145],["T_DOUBLE_COLON","::",145],["T_STRING","STATUS_REQUIRE_REINDEX",145],")",";",["T_WHITESPACE","\n            ",145],"}",["T_WHITESPACE","\n        ",146],"}",["T_WHITESPACE","\n        ",147],["T_RETURN","return",148],["T_WHITESPACE"," ",148],["T_VARIABLE","$this",148],";",["T_WHITESPACE","\n\n    ",148],"}",["T_WHITESPACE","\n\n    ",150],["T_DOC_COMMENT","\/**\n     * Check if event can be matched by process\n     *\n     * @param Mage_Index_Model_Event $event\n     * @return bool\n     *\/",152],["T_WHITESPACE","\n    ",157],["T_PUBLIC","public",158],["T_WHITESPACE"," ",158],["T_FUNCTION","function",158],["T_WHITESPACE"," ",158],["T_STRING","matchEvent",158],"(",["T_STRING","Mage_Index_Model_Event",158],["T_WHITESPACE"," ",158],["T_VARIABLE","$event",158],")",["T_WHITESPACE","\n    ",158],"{",["T_WHITESPACE","\n        ",159],["T_RETURN","return",160],["T_WHITESPACE"," ",160],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","getIndexer",160],"(",")",["T_OBJECT_OPERATOR","->",160],["T_STRING","matchEvent",160],"(",["T_VARIABLE","$event",160],")",";",["T_WHITESPACE","\n    ",160],"}",["T_WHITESPACE","\n\n    ",161],["T_DOC_COMMENT","\/**\n     * Check if specific entity and action type is matched\n     *\n     * @param   string $entity\n     * @param   string $type\n     * @return  bool\n     *\/",163],["T_WHITESPACE","\n    ",169],["T_PUBLIC","public",170],["T_WHITESPACE"," ",170],["T_FUNCTION","function",170],["T_WHITESPACE"," ",170],["T_STRING","matchEntityAndType",170],"(",["T_VARIABLE","$entity",170],",",["T_WHITESPACE"," ",170],["T_VARIABLE","$type",170],")",["T_WHITESPACE","\n    ",170],"{",["T_WHITESPACE","\n        ",171],["T_IF","if",172],["T_WHITESPACE"," ",172],"(",["T_VARIABLE","$entity",172],["T_WHITESPACE"," ",172],["T_IS_NOT_IDENTICAL","!==",172],["T_WHITESPACE"," ",172],["T_STRING","null",172],["T_WHITESPACE"," ",172],["T_BOOLEAN_AND","&&",172],["T_WHITESPACE"," ",172],["T_VARIABLE","$type",172],["T_WHITESPACE"," ",172],["T_IS_NOT_IDENTICAL","!==",172],["T_WHITESPACE"," ",172],["T_STRING","null",172],")",["T_WHITESPACE"," ",172],"{",["T_WHITESPACE","\n            ",172],["T_RETURN","return",173],["T_WHITESPACE"," ",173],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","getIndexer",173],"(",")",["T_OBJECT_OPERATOR","->",173],["T_STRING","matchEntityAndType",173],"(",["T_VARIABLE","$entity",173],",",["T_WHITESPACE"," ",173],["T_VARIABLE","$type",173],")",";",["T_WHITESPACE","\n        ",173],"}",["T_WHITESPACE","\n        ",174],["T_RETURN","return",175],["T_WHITESPACE"," ",175],["T_STRING","true",175],";",["T_WHITESPACE","\n    ",175],"}",["T_WHITESPACE","\n\n    ",176],["T_DOC_COMMENT","\/**\n     * Reindex all data what this process responsible is\n     *\n     *\/",178],["T_WHITESPACE","\n    ",181],["T_PUBLIC","public",182],["T_WHITESPACE"," ",182],["T_FUNCTION","function",182],["T_WHITESPACE"," ",182],["T_STRING","reindexAll",182],"(",")",["T_WHITESPACE","\n    ",182],"{",["T_WHITESPACE","\n        ",183],["T_IF","if",184],["T_WHITESPACE"," ",184],"(",["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","isLocked",184],"(",")",")",["T_WHITESPACE"," ",184],"{",["T_WHITESPACE","\n            ",184],["T_STRING","Mage",185],["T_DOUBLE_COLON","::",185],["T_STRING","throwException",185],"(",["T_STRING","Mage",185],["T_DOUBLE_COLON","::",185],["T_STRING","helper",185],"(",["T_CONSTANT_ENCAPSED_STRING","'index'",185],")",["T_OBJECT_OPERATOR","->",185],["T_STRING","__",185],"(",["T_CONSTANT_ENCAPSED_STRING","'%s Index process is working now. Please try run this process later.'",185],",",["T_WHITESPACE"," ",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","getIndexer",185],"(",")",["T_OBJECT_OPERATOR","->",185],["T_STRING","getName",185],"(",")",")",")",";",["T_WHITESPACE","\n        ",185],"}",["T_WHITESPACE","\n\n        ",186],["T_VARIABLE","$processStatus",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getStatus",188],"(",")",";",["T_WHITESPACE","\n\n        ",188],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","_getResource",190],"(",")",["T_OBJECT_OPERATOR","->",190],["T_STRING","startProcess",190],"(",["T_VARIABLE","$this",190],")",";",["T_WHITESPACE","\n        ",190],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","lock",191],"(",")",";",["T_WHITESPACE","\n        ",191],["T_TRY","try",192],["T_WHITESPACE"," ",192],"{",["T_WHITESPACE","\n            ",192],["T_VARIABLE","$eventsCollection",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","getUnprocessedEventsCollection",193],"(",")",";",["T_WHITESPACE","\n\n            ",193],["T_DOC_COMMENT","\/** @var $eventResource Mage_Index_Model_Resource_Event *\/",195],["T_WHITESPACE","\n            ",195],["T_VARIABLE","$eventResource",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_STRING","Mage",196],["T_DOUBLE_COLON","::",196],["T_STRING","getResourceSingleton",196],"(",["T_CONSTANT_ENCAPSED_STRING","'index\/event'",196],")",";",["T_WHITESPACE","\n\n            ",196],["T_IF","if",198],["T_WHITESPACE"," ",198],"(",["T_VARIABLE","$eventsCollection",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","count",198],"(",")",["T_WHITESPACE"," ",198],">",["T_WHITESPACE"," ",198],["T_LNUMBER","0",198],["T_WHITESPACE"," ",198],["T_BOOLEAN_AND","&&",198],["T_WHITESPACE"," ",198],["T_VARIABLE","$processStatus",198],["T_WHITESPACE"," ",198],["T_IS_EQUAL","==",198],["T_WHITESPACE"," ",198],["T_STRING","self",198],["T_DOUBLE_COLON","::",198],["T_STRING","STATUS_PENDING",198],["T_WHITESPACE","\n                ",198],["T_BOOLEAN_OR","||",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","getForcePartialReindex",199],"(",")",["T_WHITESPACE","\n            ",199],")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n                ",200],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","_getResource",201],"(",")",["T_OBJECT_OPERATOR","->",201],["T_STRING","beginTransaction",201],"(",")",";",["T_WHITESPACE","\n                ",201],["T_TRY","try",202],["T_WHITESPACE"," ",202],"{",["T_WHITESPACE","\n                    ",202],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","_processEventsCollection",203],"(",["T_VARIABLE","$eventsCollection",203],",",["T_WHITESPACE"," ",203],["T_STRING","false",203],")",";",["T_WHITESPACE","\n                    ",203],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","_getResource",204],"(",")",["T_OBJECT_OPERATOR","->",204],["T_STRING","commit",204],"(",")",";",["T_WHITESPACE","\n                ",204],"}",["T_WHITESPACE"," ",205],["T_CATCH","catch",205],["T_WHITESPACE"," ",205],"(",["T_STRING","Exception",205],["T_WHITESPACE"," ",205],["T_VARIABLE","$e",205],")",["T_WHITESPACE"," ",205],"{",["T_WHITESPACE","\n                    ",205],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","_getResource",206],"(",")",["T_OBJECT_OPERATOR","->",206],["T_STRING","rollBack",206],"(",")",";",["T_WHITESPACE","\n                    ",206],["T_THROW","throw",207],["T_WHITESPACE"," ",207],["T_VARIABLE","$e",207],";",["T_WHITESPACE","\n                ",207],"}",["T_WHITESPACE","\n            ",208],"}",["T_WHITESPACE"," ",209],["T_ELSE","else",209],["T_WHITESPACE"," ",209],"{",["T_WHITESPACE","\n                ",209],["T_COMMENT","\/\/Update existing events since we'll do reindexAll\n",210],["T_WHITESPACE","                ",211],["T_VARIABLE","$eventResource",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","updateProcessEvents",211],"(",["T_VARIABLE","$this",211],")",";",["T_WHITESPACE","\n                ",211],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","getIndexer",212],"(",")",["T_OBJECT_OPERATOR","->",212],["T_STRING","reindexAll",212],"(",")",";",["T_WHITESPACE","\n            ",212],"}",["T_WHITESPACE","\n            ",213],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","unlock",214],"(",")",";",["T_WHITESPACE","\n\n            ",214],["T_VARIABLE","$unprocessedEvents",216],["T_WHITESPACE"," ",216],"=",["T_WHITESPACE"," ",216],["T_VARIABLE","$eventResource",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","getUnprocessedEvents",216],"(",["T_VARIABLE","$this",216],")",";",["T_WHITESPACE","\n            ",216],["T_IF","if",217],["T_WHITESPACE"," ",217],"(",["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","getMode",217],"(",")",["T_WHITESPACE"," ",217],["T_IS_EQUAL","==",217],["T_WHITESPACE"," ",217],["T_STRING","self",217],["T_DOUBLE_COLON","::",217],["T_STRING","MODE_MANUAL",217],["T_WHITESPACE"," ",217],["T_BOOLEAN_AND","&&",217],["T_WHITESPACE"," ",217],"(",["T_STRING","count",217],"(",["T_VARIABLE","$unprocessedEvents",217],")",["T_WHITESPACE"," ",217],">",["T_WHITESPACE"," ",217],["T_LNUMBER","0",217],")",")",["T_WHITESPACE"," ",217],"{",["T_WHITESPACE","\n                ",217],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","_getResource",218],"(",")",["T_OBJECT_OPERATOR","->",218],["T_STRING","updateStatus",218],"(",["T_VARIABLE","$this",218],",",["T_WHITESPACE"," ",218],["T_STRING","self",218],["T_DOUBLE_COLON","::",218],["T_STRING","STATUS_REQUIRE_REINDEX",218],")",";",["T_WHITESPACE","\n            ",218],"}",["T_WHITESPACE"," ",219],["T_ELSE","else",219],["T_WHITESPACE"," ",219],"{",["T_WHITESPACE","\n                ",219],["T_VARIABLE","$this",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","_getResource",220],"(",")",["T_OBJECT_OPERATOR","->",220],["T_STRING","endProcess",220],"(",["T_VARIABLE","$this",220],")",";",["T_WHITESPACE","\n            ",220],"}",["T_WHITESPACE","\n        ",221],"}",["T_WHITESPACE"," ",222],["T_CATCH","catch",222],["T_WHITESPACE"," ",222],"(",["T_STRING","Exception",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$e",222],")",["T_WHITESPACE"," ",222],"{",["T_WHITESPACE","\n            ",222],["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","unlock",223],"(",")",";",["T_WHITESPACE","\n            ",223],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","_getResource",224],"(",")",["T_OBJECT_OPERATOR","->",224],["T_STRING","failProcess",224],"(",["T_VARIABLE","$this",224],")",";",["T_WHITESPACE","\n            ",224],["T_THROW","throw",225],["T_WHITESPACE"," ",225],["T_VARIABLE","$e",225],";",["T_WHITESPACE","\n        ",225],"}",["T_WHITESPACE","\n        ",226],["T_STRING","Mage",227],["T_DOUBLE_COLON","::",227],["T_STRING","dispatchEvent",227],"(",["T_CONSTANT_ENCAPSED_STRING","'after_reindex_process_'",227],["T_WHITESPACE"," ",227],".",["T_WHITESPACE"," ",227],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","getIndexerCode",227],"(",")",")",";",["T_WHITESPACE","\n        ",227],["T_RETURN","return",228],["T_WHITESPACE"," ",228],["T_VARIABLE","$this",228],";",["T_WHITESPACE","\n    ",228],"}",["T_WHITESPACE","\n\n    ",229],["T_DOC_COMMENT","\/**\n     * Reindex all data what this process responsible is\n     * Check and using depends processes\n     *\n     * @return Mage_Index_Model_Process\n     *\/",231],["T_WHITESPACE","\n    ",236],["T_PUBLIC","public",237],["T_WHITESPACE"," ",237],["T_FUNCTION","function",237],["T_WHITESPACE"," ",237],["T_STRING","reindexEverything",237],"(",")",["T_WHITESPACE","\n    ",237],"{",["T_WHITESPACE","\n        ",238],["T_IF","if",239],["T_WHITESPACE"," ",239],"(",["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","getData",239],"(",["T_CONSTANT_ENCAPSED_STRING","'runed_reindexall'",239],")",")",["T_WHITESPACE"," ",239],"{",["T_WHITESPACE","\n            ",239],["T_RETURN","return",240],["T_WHITESPACE"," ",240],["T_VARIABLE","$this",240],";",["T_WHITESPACE","\n        ",240],"}",["T_WHITESPACE","\n\n        ",241],["T_DOC_COMMENT","\/** @var $eventResource Mage_Index_Model_Resource_Event *\/",243],["T_WHITESPACE","\n        ",243],["T_VARIABLE","$eventResource",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_STRING","Mage",244],["T_DOUBLE_COLON","::",244],["T_STRING","getResourceSingleton",244],"(",["T_CONSTANT_ENCAPSED_STRING","'index\/event'",244],")",";",["T_WHITESPACE","\n        ",244],["T_VARIABLE","$unprocessedEvents",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_VARIABLE","$eventResource",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","getUnprocessedEvents",245],"(",["T_VARIABLE","$this",245],")",";",["T_WHITESPACE","\n        ",245],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","setForcePartialReindex",246],"(",["T_STRING","count",246],"(",["T_VARIABLE","$unprocessedEvents",246],")",["T_WHITESPACE"," ",246],">",["T_WHITESPACE"," ",246],["T_LNUMBER","0",246],["T_WHITESPACE"," ",246],["T_BOOLEAN_AND","&&",246],["T_WHITESPACE"," ",246],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","getStatus",246],"(",")",["T_WHITESPACE"," ",246],["T_IS_EQUAL","==",246],["T_WHITESPACE"," ",246],["T_STRING","self",246],["T_DOUBLE_COLON","::",246],["T_STRING","STATUS_PENDING",246],")",";",["T_WHITESPACE","\n\n        ",246],["T_IF","if",248],["T_WHITESPACE"," ",248],"(",["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","getDepends",248],"(",")",")",["T_WHITESPACE"," ",248],"{",["T_WHITESPACE","\n            ",248],["T_DOC_COMMENT","\/** @var $indexer Mage_Index_Model_Indexer *\/",249],["T_WHITESPACE","\n            ",249],["T_VARIABLE","$indexer",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_STRING","Mage",250],["T_DOUBLE_COLON","::",250],["T_STRING","getSingleton",250],"(",["T_CONSTANT_ENCAPSED_STRING","'index\/indexer'",250],")",";",["T_WHITESPACE","\n            ",250],["T_FOREACH","foreach",251],["T_WHITESPACE"," ",251],"(",["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","getDepends",251],"(",")",["T_WHITESPACE"," ",251],["T_AS","as",251],["T_WHITESPACE"," ",251],["T_VARIABLE","$code",251],")",["T_WHITESPACE"," ",251],"{",["T_WHITESPACE","\n                ",251],["T_VARIABLE","$process",252],["T_WHITESPACE"," ",252],"=",["T_WHITESPACE"," ",252],["T_VARIABLE","$indexer",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","getProcessByCode",252],"(",["T_VARIABLE","$code",252],")",";",["T_WHITESPACE","\n                ",252],["T_IF","if",253],["T_WHITESPACE"," ",253],"(",["T_VARIABLE","$process",253],")",["T_WHITESPACE"," ",253],"{",["T_WHITESPACE","\n                    ",253],["T_VARIABLE","$process",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","reindexEverything",254],"(",")",";",["T_WHITESPACE","\n                ",254],"}",["T_WHITESPACE","\n            ",255],"}",["T_WHITESPACE","\n        ",256],"}",["T_WHITESPACE","\n\n        ",257],["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","setData",259],"(",["T_CONSTANT_ENCAPSED_STRING","'runed_reindexall'",259],",",["T_WHITESPACE"," ",259],["T_STRING","true",259],")",";",["T_WHITESPACE","\n        ",259],["T_RETURN","return",260],["T_WHITESPACE"," ",260],["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","reindexAll",260],"(",")",";",["T_WHITESPACE","\n    ",260],"}",["T_WHITESPACE","\n\n    ",261],["T_DOC_COMMENT","\/**\n     * Process event with assigned indexer object\n     *\n     * @param Mage_Index_Model_Event $event\n     * @return Mage_Index_Model_Process\n     *\/",263],["T_WHITESPACE","\n    ",268],["T_PUBLIC","public",269],["T_WHITESPACE"," ",269],["T_FUNCTION","function",269],["T_WHITESPACE"," ",269],["T_STRING","processEvent",269],"(",["T_STRING","Mage_Index_Model_Event",269],["T_WHITESPACE"," ",269],["T_VARIABLE","$event",269],")",["T_WHITESPACE","\n    ",269],"{",["T_WHITESPACE","\n        ",270],["T_IF","if",271],["T_WHITESPACE"," ",271],"(","!",["T_VARIABLE","$this",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","matchEvent",271],"(",["T_VARIABLE","$event",271],")",")",["T_WHITESPACE"," ",271],"{",["T_WHITESPACE","\n            ",271],["T_RETURN","return",272],["T_WHITESPACE"," ",272],["T_VARIABLE","$this",272],";",["T_WHITESPACE","\n        ",272],"}",["T_WHITESPACE","\n        ",273],["T_IF","if",274],["T_WHITESPACE"," ",274],"(",["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","getMode",274],"(",")",["T_WHITESPACE"," ",274],["T_IS_EQUAL","==",274],["T_WHITESPACE"," ",274],["T_STRING","self",274],["T_DOUBLE_COLON","::",274],["T_STRING","MODE_MANUAL",274],")",["T_WHITESPACE"," ",274],"{",["T_WHITESPACE","\n            ",274],["T_VARIABLE","$this",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","changeStatus",275],"(",["T_STRING","self",275],["T_DOUBLE_COLON","::",275],["T_STRING","STATUS_REQUIRE_REINDEX",275],")",";",["T_WHITESPACE","\n            ",275],["T_RETURN","return",276],["T_WHITESPACE"," ",276],["T_VARIABLE","$this",276],";",["T_WHITESPACE","\n        ",276],"}",["T_WHITESPACE","\n\n        ",277],["T_VARIABLE","$this",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","_getResource",279],"(",")",["T_OBJECT_OPERATOR","->",279],["T_STRING","updateProcessStartDate",279],"(",["T_VARIABLE","$this",279],")",";",["T_WHITESPACE","\n        ",279],["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","_setEventNamespace",280],"(",["T_VARIABLE","$event",280],")",";",["T_WHITESPACE","\n        ",280],["T_VARIABLE","$isError",281],["T_WHITESPACE"," ",281],"=",["T_WHITESPACE"," ",281],["T_STRING","false",281],";",["T_WHITESPACE","\n\n        ",281],["T_TRY","try",283],["T_WHITESPACE"," ",283],"{",["T_WHITESPACE","\n            ",283],["T_VARIABLE","$this",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","getIndexer",284],"(",")",["T_OBJECT_OPERATOR","->",284],["T_STRING","processEvent",284],"(",["T_VARIABLE","$event",284],")",";",["T_WHITESPACE","\n        ",284],"}",["T_WHITESPACE"," ",285],["T_CATCH","catch",285],["T_WHITESPACE"," ",285],"(",["T_STRING","Exception",285],["T_WHITESPACE"," ",285],["T_VARIABLE","$e",285],")",["T_WHITESPACE"," ",285],"{",["T_WHITESPACE","\n            ",285],["T_VARIABLE","$isError",286],["T_WHITESPACE"," ",286],"=",["T_WHITESPACE"," ",286],["T_STRING","true",286],";",["T_WHITESPACE","\n        ",286],"}",["T_WHITESPACE","\n        ",287],["T_VARIABLE","$event",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","resetData",288],"(",")",";",["T_WHITESPACE","\n        ",288],["T_VARIABLE","$this",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","_resetEventNamespace",289],"(",["T_VARIABLE","$event",289],")",";",["T_WHITESPACE","\n        ",289],["T_VARIABLE","$this",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","_getResource",290],"(",")",["T_OBJECT_OPERATOR","->",290],["T_STRING","updateProcessEndDate",290],"(",["T_VARIABLE","$this",290],")",";",["T_WHITESPACE","\n        ",290],["T_VARIABLE","$event",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","addProcessId",291],"(",["T_VARIABLE","$this",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","getId",291],"(",")",",",["T_WHITESPACE"," ",291],["T_VARIABLE","$isError",291],["T_WHITESPACE"," ",291],"?",["T_WHITESPACE"," ",291],["T_STRING","self",291],["T_DOUBLE_COLON","::",291],["T_STRING","EVENT_STATUS_ERROR",291],["T_WHITESPACE"," ",291],":",["T_WHITESPACE"," ",291],["T_STRING","self",291],["T_DOUBLE_COLON","::",291],["T_STRING","EVENT_STATUS_DONE",291],")",";",["T_WHITESPACE","\n\n        ",291],["T_RETURN","return",293],["T_WHITESPACE"," ",293],["T_VARIABLE","$this",293],";",["T_WHITESPACE","\n    ",293],"}",["T_WHITESPACE","\n\n    ",294],["T_DOC_COMMENT","\/**\n     * Get Indexer strategy object\n     *\n     * @return Mage_Index_Model_Indexer_Abstract\n     *\/",296],["T_WHITESPACE","\n    ",300],["T_PUBLIC","public",301],["T_WHITESPACE"," ",301],["T_FUNCTION","function",301],["T_WHITESPACE"," ",301],["T_STRING","getIndexer",301],"(",")",["T_WHITESPACE","\n    ",301],"{",["T_WHITESPACE","\n        ",302],["T_IF","if",303],["T_WHITESPACE"," ",303],"(",["T_VARIABLE","$this",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","_indexer",303],["T_WHITESPACE"," ",303],["T_IS_IDENTICAL","===",303],["T_WHITESPACE"," ",303],["T_STRING","null",303],")",["T_WHITESPACE"," ",303],"{",["T_WHITESPACE","\n            ",303],["T_VARIABLE","$code",304],["T_WHITESPACE"," ",304],"=",["T_WHITESPACE"," ",304],["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","_getData",304],"(",["T_CONSTANT_ENCAPSED_STRING","'indexer_code'",304],")",";",["T_WHITESPACE","\n            ",304],["T_IF","if",305],["T_WHITESPACE"," ",305],"(","!",["T_VARIABLE","$code",305],")",["T_WHITESPACE"," ",305],"{",["T_WHITESPACE","\n                ",305],["T_STRING","Mage",306],["T_DOUBLE_COLON","::",306],["T_STRING","throwException",306],"(",["T_STRING","Mage",306],["T_DOUBLE_COLON","::",306],["T_STRING","helper",306],"(",["T_CONSTANT_ENCAPSED_STRING","'index'",306],")",["T_OBJECT_OPERATOR","->",306],["T_STRING","__",306],"(",["T_CONSTANT_ENCAPSED_STRING","'Indexer code is not defined.'",306],")",")",";",["T_WHITESPACE","\n            ",306],"}",["T_WHITESPACE","\n            ",307],["T_VARIABLE","$xmlPath",308],["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],["T_STRING","self",308],["T_DOUBLE_COLON","::",308],["T_STRING","XML_PATH_INDEXER_DATA",308],["T_WHITESPACE"," ",308],".",["T_WHITESPACE"," ",308],["T_CONSTANT_ENCAPSED_STRING","'\/'",308],["T_WHITESPACE"," ",308],".",["T_WHITESPACE"," ",308],["T_VARIABLE","$code",308],";",["T_WHITESPACE","\n            ",308],["T_VARIABLE","$config",309],["T_WHITESPACE"," ",309],"=",["T_WHITESPACE"," ",309],["T_STRING","Mage",309],["T_DOUBLE_COLON","::",309],["T_STRING","getConfig",309],"(",")",["T_OBJECT_OPERATOR","->",309],["T_STRING","getNode",309],"(",["T_VARIABLE","$xmlPath",309],")",";",["T_WHITESPACE","\n            ",309],["T_IF","if",310],["T_WHITESPACE"," ",310],"(","!",["T_VARIABLE","$config",310],["T_WHITESPACE"," ",310],["T_BOOLEAN_OR","||",310],["T_WHITESPACE"," ",310],["T_EMPTY","empty",310],"(",["T_VARIABLE","$config",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","model",310],")",")",["T_WHITESPACE"," ",310],"{",["T_WHITESPACE","\n                ",310],["T_STRING","Mage",311],["T_DOUBLE_COLON","::",311],["T_STRING","throwException",311],"(",["T_STRING","Mage",311],["T_DOUBLE_COLON","::",311],["T_STRING","helper",311],"(",["T_CONSTANT_ENCAPSED_STRING","'index'",311],")",["T_OBJECT_OPERATOR","->",311],["T_STRING","__",311],"(",["T_CONSTANT_ENCAPSED_STRING","'Indexer model is not defined.'",311],")",")",";",["T_WHITESPACE","\n            ",311],"}",["T_WHITESPACE","\n            ",312],["T_VARIABLE","$model",313],["T_WHITESPACE"," ",313],"=",["T_WHITESPACE"," ",313],["T_STRING","Mage",313],["T_DOUBLE_COLON","::",313],["T_STRING","getModel",313],"(",["T_STRING_CAST","(string)",313],["T_VARIABLE","$config",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","model",313],")",";",["T_WHITESPACE","\n            ",313],["T_IF","if",314],["T_WHITESPACE"," ",314],"(",["T_VARIABLE","$model",314],["T_WHITESPACE"," ",314],["T_INSTANCEOF","instanceof",314],["T_WHITESPACE"," ",314],["T_STRING","Mage_Index_Model_Indexer_Abstract",314],")",["T_WHITESPACE"," ",314],"{",["T_WHITESPACE","\n                ",314],["T_VARIABLE","$this",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","_indexer",315],["T_WHITESPACE"," ",315],"=",["T_WHITESPACE"," ",315],["T_VARIABLE","$model",315],";",["T_WHITESPACE","\n            ",315],"}",["T_WHITESPACE"," ",316],["T_ELSE","else",316],["T_WHITESPACE"," ",316],"{",["T_WHITESPACE","\n                ",316],["T_STRING","Mage",317],["T_DOUBLE_COLON","::",317],["T_STRING","throwException",317],"(",["T_STRING","Mage",317],["T_DOUBLE_COLON","::",317],["T_STRING","helper",317],"(",["T_CONSTANT_ENCAPSED_STRING","'index'",317],")",["T_OBJECT_OPERATOR","->",317],["T_STRING","__",317],"(",["T_CONSTANT_ENCAPSED_STRING","'Indexer model should extend Mage_Index_Model_Indexer_Abstract.'",317],")",")",";",["T_WHITESPACE","\n            ",317],"}",["T_WHITESPACE","\n        ",318],"}",["T_WHITESPACE","\n        ",319],["T_RETURN","return",320],["T_WHITESPACE"," ",320],["T_VARIABLE","$this",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","_indexer",320],";",["T_WHITESPACE","\n    ",320],"}",["T_WHITESPACE","\n\n    ",321],["T_DOC_COMMENT","\/**\n     * Index pending events addressed to the process\n     *\n     * @param   null|string $entity\n     * @param   null|string $type\n     * @return  Mage_Index_Model_Process\n     *\/",323],["T_WHITESPACE","\n    ",329],["T_PUBLIC","public",330],["T_WHITESPACE"," ",330],["T_FUNCTION","function",330],["T_WHITESPACE"," ",330],["T_STRING","indexEvents",330],"(",["T_VARIABLE","$entity",330],"=",["T_STRING","null",330],",",["T_WHITESPACE"," ",330],["T_VARIABLE","$type",330],"=",["T_STRING","null",330],")",["T_WHITESPACE","\n    ",330],"{",["T_WHITESPACE","\n        ",331],["T_DOC_COMMENT","\/**\n         * Check if process indexer can match entity code and action type\n         *\/",332],["T_WHITESPACE","\n        ",334],["T_IF","if",335],["T_WHITESPACE"," ",335],"(",["T_VARIABLE","$entity",335],["T_WHITESPACE"," ",335],["T_IS_NOT_IDENTICAL","!==",335],["T_WHITESPACE"," ",335],["T_STRING","null",335],["T_WHITESPACE"," ",335],["T_BOOLEAN_AND","&&",335],["T_WHITESPACE"," ",335],["T_VARIABLE","$type",335],["T_WHITESPACE"," ",335],["T_IS_NOT_IDENTICAL","!==",335],["T_WHITESPACE"," ",335],["T_STRING","null",335],")",["T_WHITESPACE"," ",335],"{",["T_WHITESPACE","\n            ",335],["T_IF","if",336],["T_WHITESPACE"," ",336],"(","!",["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","getIndexer",336],"(",")",["T_OBJECT_OPERATOR","->",336],["T_STRING","matchEntityAndType",336],"(",["T_VARIABLE","$entity",336],",",["T_WHITESPACE"," ",336],["T_VARIABLE","$type",336],")",")",["T_WHITESPACE"," ",336],"{",["T_WHITESPACE","\n                ",336],["T_RETURN","return",337],["T_WHITESPACE"," ",337],["T_VARIABLE","$this",337],";",["T_WHITESPACE","\n            ",337],"}",["T_WHITESPACE","\n        ",338],"}",["T_WHITESPACE","\n\n        ",339],["T_IF","if",341],["T_WHITESPACE"," ",341],"(",["T_VARIABLE","$this",341],["T_OBJECT_OPERATOR","->",341],["T_STRING","getMode",341],"(",")",["T_WHITESPACE"," ",341],["T_IS_EQUAL","==",341],["T_WHITESPACE"," ",341],["T_STRING","self",341],["T_DOUBLE_COLON","::",341],["T_STRING","MODE_MANUAL",341],")",["T_WHITESPACE"," ",341],"{",["T_WHITESPACE","\n            ",341],["T_RETURN","return",342],["T_WHITESPACE"," ",342],["T_VARIABLE","$this",342],";",["T_WHITESPACE","\n        ",342],"}",["T_WHITESPACE","\n\n        ",343],["T_IF","if",345],["T_WHITESPACE"," ",345],"(",["T_VARIABLE","$this",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","isLocked",345],"(",")",")",["T_WHITESPACE"," ",345],"{",["T_WHITESPACE","\n            ",345],["T_RETURN","return",346],["T_WHITESPACE"," ",346],["T_VARIABLE","$this",346],";",["T_WHITESPACE","\n        ",346],"}",["T_WHITESPACE","\n\n        ",347],["T_VARIABLE","$this",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","lock",349],"(",")",";",["T_WHITESPACE","\n        ",349],["T_TRY","try",350],["T_WHITESPACE"," ",350],"{",["T_WHITESPACE","\n            ",350],["T_DOC_COMMENT","\/**\n             * Prepare events collection\n             *\/",351],["T_WHITESPACE","\n            ",353],["T_VARIABLE","$eventsCollection",354],["T_WHITESPACE"," ",354],"=",["T_WHITESPACE"," ",354],["T_VARIABLE","$this",354],["T_OBJECT_OPERATOR","->",354],["T_STRING","getUnprocessedEventsCollection",354],"(",")",";",["T_WHITESPACE","\n            ",354],["T_IF","if",355],["T_WHITESPACE"," ",355],"(",["T_VARIABLE","$entity",355],["T_WHITESPACE"," ",355],["T_IS_NOT_IDENTICAL","!==",355],["T_WHITESPACE"," ",355],["T_STRING","null",355],")",["T_WHITESPACE"," ",355],"{",["T_WHITESPACE","\n                ",355],["T_VARIABLE","$eventsCollection",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","addEntityFilter",356],"(",["T_VARIABLE","$entity",356],")",";",["T_WHITESPACE","\n            ",356],"}",["T_WHITESPACE","\n            ",357],["T_IF","if",358],["T_WHITESPACE"," ",358],"(",["T_VARIABLE","$type",358],["T_WHITESPACE"," ",358],["T_IS_NOT_IDENTICAL","!==",358],["T_WHITESPACE"," ",358],["T_STRING","null",358],")",["T_WHITESPACE"," ",358],"{",["T_WHITESPACE","\n                ",358],["T_VARIABLE","$eventsCollection",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","addTypeFilter",359],"(",["T_VARIABLE","$type",359],")",";",["T_WHITESPACE","\n            ",359],"}",["T_WHITESPACE","\n\n            ",360],["T_VARIABLE","$this",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","_processEventsCollection",362],"(",["T_VARIABLE","$eventsCollection",362],")",";",["T_WHITESPACE","\n            ",362],["T_VARIABLE","$this",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","unlock",363],"(",")",";",["T_WHITESPACE","\n        ",363],"}",["T_WHITESPACE"," ",364],["T_CATCH","catch",364],["T_WHITESPACE"," ",364],"(",["T_STRING","Exception",364],["T_WHITESPACE"," ",364],["T_VARIABLE","$e",364],")",["T_WHITESPACE"," ",364],"{",["T_WHITESPACE","\n            ",364],["T_VARIABLE","$this",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","unlock",365],"(",")",";",["T_WHITESPACE","\n            ",365],["T_THROW","throw",366],["T_WHITESPACE"," ",366],["T_VARIABLE","$e",366],";",["T_WHITESPACE","\n        ",366],"}",["T_WHITESPACE","\n        ",367],["T_RETURN","return",368],["T_WHITESPACE"," ",368],["T_VARIABLE","$this",368],";",["T_WHITESPACE","\n    ",368],"}",["T_WHITESPACE","\n\n    ",369],["T_DOC_COMMENT","\/**\n     * Process all events of the collection\n     *\n     * @param Mage_Index_Model_Resource_Event_Collection $eventsCollection\n     * @param bool $skipUnmatched\n     * @return Mage_Index_Model_Process\n     *\/",371],["T_WHITESPACE","\n    ",377],["T_PROTECTED","protected",378],["T_WHITESPACE"," ",378],["T_FUNCTION","function",378],["T_WHITESPACE"," ",378],["T_STRING","_processEventsCollection",378],"(",["T_WHITESPACE","\n        ",378],["T_STRING","Mage_Index_Model_Resource_Event_Collection",379],["T_WHITESPACE"," ",379],["T_VARIABLE","$eventsCollection",379],",",["T_WHITESPACE","\n        ",379],["T_VARIABLE","$skipUnmatched",380],["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],["T_STRING","true",380],["T_WHITESPACE","\n    ",380],")",["T_WHITESPACE"," ",381],"{",["T_WHITESPACE","\n        ",381],["T_COMMENT","\/\/ We can't reload the collection because of transaction\n",382],["T_WHITESPACE","        ",383],["T_DOC_COMMENT","\/** @var $event Mage_Index_Model_Event *\/",383],["T_WHITESPACE","\n        ",383],["T_WHILE","while",384],["T_WHITESPACE"," ",384],"(",["T_VARIABLE","$event",384],["T_WHITESPACE"," ",384],"=",["T_WHITESPACE"," ",384],["T_VARIABLE","$eventsCollection",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","fetchItem",384],"(",")",")",["T_WHITESPACE"," ",384],"{",["T_WHITESPACE","\n            ",384],["T_TRY","try",385],["T_WHITESPACE"," ",385],"{",["T_WHITESPACE","\n                ",385],["T_VARIABLE","$this",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","processEvent",386],"(",["T_VARIABLE","$event",386],")",";",["T_WHITESPACE","\n                ",386],["T_IF","if",387],["T_WHITESPACE"," ",387],"(","!",["T_VARIABLE","$skipUnmatched",387],")",["T_WHITESPACE"," ",387],"{",["T_WHITESPACE","\n                    ",387],["T_VARIABLE","$eventProcessIds",388],["T_WHITESPACE"," ",388],"=",["T_WHITESPACE"," ",388],["T_VARIABLE","$event",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","getProcessIds",388],"(",")",";",["T_WHITESPACE","\n                    ",388],["T_IF","if",389],["T_WHITESPACE"," ",389],"(","!",["T_ISSET","isset",389],"(",["T_VARIABLE","$eventProcessIds",389],"[",["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","getId",389],"(",")","]",")",")",["T_WHITESPACE"," ",389],"{",["T_WHITESPACE","\n                        ",389],["T_VARIABLE","$event",390],["T_OBJECT_OPERATOR","->",390],["T_STRING","addProcessId",390],"(",["T_VARIABLE","$this",390],["T_OBJECT_OPERATOR","->",390],["T_STRING","getId",390],"(",")",",",["T_WHITESPACE"," ",390],["T_STRING","null",390],")",";",["T_WHITESPACE","\n                    ",390],"}",["T_WHITESPACE","\n                ",391],"}",["T_WHITESPACE","\n            ",392],"}",["T_WHITESPACE"," ",393],["T_CATCH","catch",393],["T_WHITESPACE"," ",393],"(",["T_STRING","Exception",393],["T_WHITESPACE"," ",393],["T_VARIABLE","$e",393],")",["T_WHITESPACE"," ",393],"{",["T_WHITESPACE","\n                ",393],["T_VARIABLE","$event",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","addProcessId",394],"(",["T_VARIABLE","$this",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","getId",394],"(",")",",",["T_WHITESPACE"," ",394],["T_STRING","self",394],["T_DOUBLE_COLON","::",394],["T_STRING","EVENT_STATUS_ERROR",394],")",";",["T_WHITESPACE","\n            ",394],"}",["T_WHITESPACE","\n            ",395],["T_VARIABLE","$event",396],["T_OBJECT_OPERATOR","->",396],["T_STRING","save",396],"(",")",";",["T_WHITESPACE","\n        ",396],"}",["T_WHITESPACE","\n        ",397],["T_RETURN","return",398],["T_WHITESPACE"," ",398],["T_VARIABLE","$this",398],";",["T_WHITESPACE","\n    ",398],"}",["T_WHITESPACE","\n\n    ",399],["T_DOC_COMMENT","\/**\n     * Update status process\/event association\n     *\n     * @param   Mage_Index_Model_Event $event\n     * @param   string $status\n     * @return  Mage_Index_Model_Process\n     *\/",401],["T_WHITESPACE","\n    ",407],["T_PUBLIC","public",408],["T_WHITESPACE"," ",408],["T_FUNCTION","function",408],["T_WHITESPACE"," ",408],["T_STRING","updateEventStatus",408],"(",["T_STRING","Mage_Index_Model_Event",408],["T_WHITESPACE"," ",408],["T_VARIABLE","$event",408],",",["T_WHITESPACE"," ",408],["T_VARIABLE","$status",408],")",["T_WHITESPACE","\n    ",408],"{",["T_WHITESPACE","\n        ",409],["T_VARIABLE","$this",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","_getResource",410],"(",")",["T_OBJECT_OPERATOR","->",410],["T_STRING","updateEventStatus",410],"(",["T_VARIABLE","$this",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","getId",410],"(",")",",",["T_WHITESPACE"," ",410],["T_VARIABLE","$event",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","getId",410],"(",")",",",["T_WHITESPACE"," ",410],["T_VARIABLE","$status",410],")",";",["T_WHITESPACE","\n        ",410],["T_RETURN","return",411],["T_WHITESPACE"," ",411],["T_VARIABLE","$this",411],";",["T_WHITESPACE","\n    ",411],"}",["T_WHITESPACE","\n\n    ",412],["T_DOC_COMMENT","\/**\n     * Returns Process lock name\n     *\n     * @return string\n     *\/",414],["T_WHITESPACE","\n    ",418],["T_PUBLIC","public",419],["T_WHITESPACE"," ",419],["T_FUNCTION","function",419],["T_WHITESPACE"," ",419],["T_STRING","getProcessLockName",419],"(",")",["T_WHITESPACE","\n    ",419],"{",["T_WHITESPACE","\n        ",420],["T_RETURN","return",421],["T_WHITESPACE"," ",421],["T_CONSTANT_ENCAPSED_STRING","'index_process_'",421],["T_WHITESPACE"," ",421],".",["T_WHITESPACE"," ",421],["T_VARIABLE","$this",421],["T_OBJECT_OPERATOR","->",421],["T_STRING","getId",421],"(",")",";",["T_WHITESPACE","\n    ",421],"}",["T_WHITESPACE","\n\n    ",422],["T_DOC_COMMENT","\/**\n     * Returns Lock object.\n     *\n     * @return Mage_Index_Model_Lock|null\n     *\/",424],["T_WHITESPACE","\n    ",428],["T_PROTECTED","protected",429],["T_WHITESPACE"," ",429],["T_FUNCTION","function",429],["T_WHITESPACE"," ",429],["T_STRING","_getLockInstance",429],"(",")",["T_WHITESPACE","\n    ",429],"{",["T_WHITESPACE","\n        ",430],["T_IF","if",431],["T_WHITESPACE"," ",431],"(",["T_STRING","is_null",431],"(",["T_VARIABLE","$this",431],["T_OBJECT_OPERATOR","->",431],["T_STRING","_lockInstance",431],")",")",["T_WHITESPACE"," ",431],"{",["T_WHITESPACE","\n            ",431],["T_VARIABLE","$this",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","_lockInstance",432],["T_WHITESPACE"," ",432],"=",["T_WHITESPACE"," ",432],["T_STRING","Mage_Index_Model_Lock",432],["T_DOUBLE_COLON","::",432],["T_STRING","getInstance",432],"(",")",";",["T_WHITESPACE","\n        ",432],"}",["T_WHITESPACE","\n        ",433],["T_RETURN","return",434],["T_WHITESPACE"," ",434],["T_VARIABLE","$this",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","_lockInstance",434],";",["T_WHITESPACE","\n    ",434],"}",["T_WHITESPACE","\n\n    ",435],["T_DOC_COMMENT","\/**\n     * Lock process without blocking.\n     * This method allow protect multiple process runing and fast lock validation.\n     *\n     * @return Mage_Index_Model_Process\n     *\/",437],["T_WHITESPACE","\n    ",442],["T_PUBLIC","public",443],["T_WHITESPACE"," ",443],["T_FUNCTION","function",443],["T_WHITESPACE"," ",443],["T_STRING","lock",443],"(",")",["T_WHITESPACE","\n    ",443],"{",["T_WHITESPACE","\n        ",444],["T_VARIABLE","$this",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","_getLockInstance",445],"(",")",["T_OBJECT_OPERATOR","->",445],["T_STRING","setLock",445],"(",["T_VARIABLE","$this",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","getProcessLockName",445],"(",")",",",["T_WHITESPACE"," ",445],["T_VARIABLE","$this",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","getData",445],"(",["T_CONSTANT_ENCAPSED_STRING","'use_file_lock'",445],")",")",";",["T_WHITESPACE","\n        ",445],["T_RETURN","return",446],["T_WHITESPACE"," ",446],["T_VARIABLE","$this",446],";",["T_WHITESPACE","\n    ",446],"}",["T_WHITESPACE","\n\n    ",447],["T_DOC_COMMENT","\/**\n     * Lock and block process.\n     * If new instance of the process will try validate locking state\n     * script will wait until process will be unlocked\n     *\n     * @return Mage_Index_Model_Process\n     *\/",449],["T_WHITESPACE","\n    ",455],["T_PUBLIC","public",456],["T_WHITESPACE"," ",456],["T_FUNCTION","function",456],["T_WHITESPACE"," ",456],["T_STRING","lockAndBlock",456],"(",")",["T_WHITESPACE","\n    ",456],"{",["T_WHITESPACE","\n        ",457],["T_VARIABLE","$this",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","_getLockInstance",458],"(",")",["T_OBJECT_OPERATOR","->",458],["T_STRING","setLock",458],"(",["T_VARIABLE","$this",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","getProcessLockName",458],"(",")",",",["T_WHITESPACE"," ",458],["T_VARIABLE","$this",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","getData",458],"(",["T_CONSTANT_ENCAPSED_STRING","'use_file_lock'",458],")",",",["T_WHITESPACE"," ",458],["T_STRING","true",458],")",";",["T_WHITESPACE","\n        ",458],["T_RETURN","return",459],["T_WHITESPACE"," ",459],["T_VARIABLE","$this",459],";",["T_WHITESPACE","\n    ",459],"}",["T_WHITESPACE","\n\n    ",460],["T_DOC_COMMENT","\/**\n     * Unlock process\n     *\n     * @return Mage_Index_Model_Process\n     *\/",462],["T_WHITESPACE","\n    ",466],["T_PUBLIC","public",467],["T_WHITESPACE"," ",467],["T_FUNCTION","function",467],["T_WHITESPACE"," ",467],["T_STRING","unlock",467],"(",")",["T_WHITESPACE","\n    ",467],"{",["T_WHITESPACE","\n        ",468],["T_VARIABLE","$this",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","_getLockInstance",469],"(",")",["T_OBJECT_OPERATOR","->",469],["T_STRING","releaseLock",469],"(",["T_VARIABLE","$this",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","getProcessLockName",469],"(",")",",",["T_WHITESPACE"," ",469],["T_VARIABLE","$this",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","getData",469],"(",["T_CONSTANT_ENCAPSED_STRING","'use_file_lock'",469],")",")",";",["T_WHITESPACE","\n        ",469],["T_RETURN","return",470],["T_WHITESPACE"," ",470],["T_VARIABLE","$this",470],";",["T_WHITESPACE","\n    ",470],"}",["T_WHITESPACE","\n\n    ",471],["T_DOC_COMMENT","\/**\n     * Check if process is locked\n     *\n     * @return bool\n     *\/",473],["T_WHITESPACE","\n    ",477],["T_PUBLIC","public",478],["T_WHITESPACE"," ",478],["T_FUNCTION","function",478],["T_WHITESPACE"," ",478],["T_STRING","isLocked",478],"(",")",["T_WHITESPACE","\n    ",478],"{",["T_WHITESPACE","\n        ",479],["T_RETURN","return",480],["T_WHITESPACE"," ",480],["T_VARIABLE","$this",480],["T_OBJECT_OPERATOR","->",480],["T_STRING","_getLockInstance",480],"(",")",["T_OBJECT_OPERATOR","->",480],["T_STRING","isLockExists",480],"(",["T_VARIABLE","$this",480],["T_OBJECT_OPERATOR","->",480],["T_STRING","getProcessLockName",480],"(",")",",",["T_WHITESPACE"," ",480],["T_VARIABLE","$this",480],["T_OBJECT_OPERATOR","->",480],["T_STRING","getData",480],"(",["T_CONSTANT_ENCAPSED_STRING","'use_file_lock'",480],")",")",";",["T_WHITESPACE","\n    ",480],"}",["T_WHITESPACE","\n\n    ",481],["T_DOC_COMMENT","\/**\n     * Change process status\n     *\n     * @param string $status\n     * @return Mage_Index_Model_Process\n     *\/",483],["T_WHITESPACE","\n    ",488],["T_PUBLIC","public",489],["T_WHITESPACE"," ",489],["T_FUNCTION","function",489],["T_WHITESPACE"," ",489],["T_STRING","changeStatus",489],"(",["T_VARIABLE","$status",489],")",["T_WHITESPACE","\n    ",489],"{",["T_WHITESPACE","\n        ",490],["T_STRING","Mage",491],["T_DOUBLE_COLON","::",491],["T_STRING","dispatchEvent",491],"(",["T_CONSTANT_ENCAPSED_STRING","'index_process_change_status'",491],",",["T_WHITESPACE"," ",491],["T_ARRAY","array",491],"(",["T_WHITESPACE","\n            ",491],["T_CONSTANT_ENCAPSED_STRING","'process'",492],["T_WHITESPACE"," ",492],["T_DOUBLE_ARROW","=>",492],["T_WHITESPACE"," ",492],["T_VARIABLE","$this",492],",",["T_WHITESPACE","\n            ",492],["T_CONSTANT_ENCAPSED_STRING","'status'",493],["T_WHITESPACE"," ",493],["T_DOUBLE_ARROW","=>",493],["T_WHITESPACE"," ",493],["T_VARIABLE","$status",493],["T_WHITESPACE","\n        ",493],")",")",";",["T_WHITESPACE","\n        ",494],["T_VARIABLE","$this",495],["T_OBJECT_OPERATOR","->",495],["T_STRING","_getResource",495],"(",")",["T_OBJECT_OPERATOR","->",495],["T_STRING","updateStatus",495],"(",["T_VARIABLE","$this",495],",",["T_WHITESPACE"," ",495],["T_VARIABLE","$status",495],")",";",["T_WHITESPACE","\n        ",495],["T_RETURN","return",496],["T_WHITESPACE"," ",496],["T_VARIABLE","$this",496],";",["T_WHITESPACE","\n    ",496],"}",["T_WHITESPACE","\n\n    ",497],["T_DOC_COMMENT","\/**\n     * Get list of process mode options\n     *\n     * @return array\n     *\/",499],["T_WHITESPACE","\n    ",503],["T_PUBLIC","public",504],["T_WHITESPACE"," ",504],["T_FUNCTION","function",504],["T_WHITESPACE"," ",504],["T_STRING","getModesOptions",504],"(",")",["T_WHITESPACE","\n    ",504],"{",["T_WHITESPACE","\n        ",505],["T_RETURN","return",506],["T_WHITESPACE"," ",506],["T_ARRAY","array",506],"(",["T_WHITESPACE","\n            ",506],["T_STRING","self",507],["T_DOUBLE_COLON","::",507],["T_STRING","MODE_REAL_TIME",507],["T_WHITESPACE"," ",507],["T_DOUBLE_ARROW","=>",507],["T_WHITESPACE"," ",507],["T_STRING","Mage",507],["T_DOUBLE_COLON","::",507],["T_STRING","helper",507],"(",["T_CONSTANT_ENCAPSED_STRING","'index'",507],")",["T_OBJECT_OPERATOR","->",507],["T_STRING","__",507],"(",["T_CONSTANT_ENCAPSED_STRING","'Update on Save'",507],")",",",["T_WHITESPACE","\n            ",507],["T_STRING","self",508],["T_DOUBLE_COLON","::",508],["T_STRING","MODE_MANUAL",508],["T_WHITESPACE"," ",508],["T_DOUBLE_ARROW","=>",508],["T_WHITESPACE"," ",508],["T_STRING","Mage",508],["T_DOUBLE_COLON","::",508],["T_STRING","helper",508],"(",["T_CONSTANT_ENCAPSED_STRING","'index'",508],")",["T_OBJECT_OPERATOR","->",508],["T_STRING","__",508],"(",["T_CONSTANT_ENCAPSED_STRING","'Manual Update'",508],")",["T_WHITESPACE","\n        ",508],")",";",["T_WHITESPACE","\n    ",509],"}",["T_WHITESPACE","\n\n    ",510],["T_DOC_COMMENT","\/**\n     * Get list of process status options\n     *\n     * @return array\n     *\/",512],["T_WHITESPACE","\n    ",516],["T_PUBLIC","public",517],["T_WHITESPACE"," ",517],["T_FUNCTION","function",517],["T_WHITESPACE"," ",517],["T_STRING","getStatusesOptions",517],"(",")",["T_WHITESPACE","\n    ",517],"{",["T_WHITESPACE","\n        ",518],["T_RETURN","return",519],["T_WHITESPACE"," ",519],["T_ARRAY","array",519],"(",["T_WHITESPACE","\n            ",519],["T_STRING","self",520],["T_DOUBLE_COLON","::",520],["T_STRING","STATUS_PENDING",520],["T_WHITESPACE","            ",520],["T_DOUBLE_ARROW","=>",520],["T_WHITESPACE"," ",520],["T_STRING","Mage",520],["T_DOUBLE_COLON","::",520],["T_STRING","helper",520],"(",["T_CONSTANT_ENCAPSED_STRING","'index'",520],")",["T_OBJECT_OPERATOR","->",520],["T_STRING","__",520],"(",["T_CONSTANT_ENCAPSED_STRING","'Ready'",520],")",",",["T_WHITESPACE","\n            ",520],["T_STRING","self",521],["T_DOUBLE_COLON","::",521],["T_STRING","STATUS_RUNNING",521],["T_WHITESPACE","            ",521],["T_DOUBLE_ARROW","=>",521],["T_WHITESPACE"," ",521],["T_STRING","Mage",521],["T_DOUBLE_COLON","::",521],["T_STRING","helper",521],"(",["T_CONSTANT_ENCAPSED_STRING","'index'",521],")",["T_OBJECT_OPERATOR","->",521],["T_STRING","__",521],"(",["T_CONSTANT_ENCAPSED_STRING","'Processing'",521],")",",",["T_WHITESPACE","\n            ",521],["T_STRING","self",522],["T_DOUBLE_COLON","::",522],["T_STRING","STATUS_REQUIRE_REINDEX",522],["T_WHITESPACE","    ",522],["T_DOUBLE_ARROW","=>",522],["T_WHITESPACE"," ",522],["T_STRING","Mage",522],["T_DOUBLE_COLON","::",522],["T_STRING","helper",522],"(",["T_CONSTANT_ENCAPSED_STRING","'index'",522],")",["T_OBJECT_OPERATOR","->",522],["T_STRING","__",522],"(",["T_CONSTANT_ENCAPSED_STRING","'Reindex Required'",522],")",",",["T_WHITESPACE","\n        ",522],")",";",["T_WHITESPACE","\n    ",523],"}",["T_WHITESPACE","\n\n    ",524],["T_DOC_COMMENT","\/**\n     * Get list of \"Update Required\" options\n     *\n     * @return array\n     *\/",526],["T_WHITESPACE","\n    ",530],["T_PUBLIC","public",531],["T_WHITESPACE"," ",531],["T_FUNCTION","function",531],["T_WHITESPACE"," ",531],["T_STRING","getUpdateRequiredOptions",531],"(",")",["T_WHITESPACE","\n    ",531],"{",["T_WHITESPACE","\n        ",532],["T_RETURN","return",533],["T_WHITESPACE"," ",533],["T_ARRAY","array",533],"(",["T_WHITESPACE","\n            ",533],["T_LNUMBER","0",534],["T_WHITESPACE"," ",534],["T_DOUBLE_ARROW","=>",534],["T_WHITESPACE"," ",534],["T_STRING","Mage",534],["T_DOUBLE_COLON","::",534],["T_STRING","helper",534],"(",["T_CONSTANT_ENCAPSED_STRING","'index'",534],")",["T_OBJECT_OPERATOR","->",534],["T_STRING","__",534],"(",["T_CONSTANT_ENCAPSED_STRING","'No'",534],")",",",["T_WHITESPACE","\n            ",534],["T_LNUMBER","1",535],["T_WHITESPACE"," ",535],["T_DOUBLE_ARROW","=>",535],["T_WHITESPACE"," ",535],["T_STRING","Mage",535],["T_DOUBLE_COLON","::",535],["T_STRING","helper",535],"(",["T_CONSTANT_ENCAPSED_STRING","'index'",535],")",["T_OBJECT_OPERATOR","->",535],["T_STRING","__",535],"(",["T_CONSTANT_ENCAPSED_STRING","'Yes'",535],")",",",["T_WHITESPACE","\n        ",535],")",";",["T_WHITESPACE","\n    ",536],"}",["T_WHITESPACE","\n\n    ",537],["T_DOC_COMMENT","\/**\n     * Retrieve depend indexer codes\n     *\n     * @return array\n     *\/",539],["T_WHITESPACE","\n    ",543],["T_PUBLIC","public",544],["T_WHITESPACE"," ",544],["T_FUNCTION","function",544],["T_WHITESPACE"," ",544],["T_STRING","getDepends",544],"(",")",["T_WHITESPACE","\n    ",544],"{",["T_WHITESPACE","\n        ",545],["T_VARIABLE","$depends",546],["T_WHITESPACE"," ",546],"=",["T_WHITESPACE"," ",546],["T_VARIABLE","$this",546],["T_OBJECT_OPERATOR","->",546],["T_STRING","getData",546],"(",["T_CONSTANT_ENCAPSED_STRING","'depends'",546],")",";",["T_WHITESPACE","\n        ",546],["T_IF","if",547],["T_WHITESPACE"," ",547],"(",["T_STRING","is_null",547],"(",["T_VARIABLE","$depends",547],")",")",["T_WHITESPACE"," ",547],"{",["T_WHITESPACE","\n            ",547],["T_VARIABLE","$depends",548],["T_WHITESPACE"," ",548],"=",["T_WHITESPACE"," ",548],["T_ARRAY","array",548],"(",")",";",["T_WHITESPACE","\n            ",548],["T_VARIABLE","$path",549],["T_WHITESPACE"," ",549],"=",["T_WHITESPACE"," ",549],["T_STRING","self",549],["T_DOUBLE_COLON","::",549],["T_STRING","XML_PATH_INDEXER_DATA",549],["T_WHITESPACE"," ",549],".",["T_WHITESPACE"," ",549],["T_CONSTANT_ENCAPSED_STRING","'\/'",549],["T_WHITESPACE"," ",549],".",["T_WHITESPACE"," ",549],["T_VARIABLE","$this",549],["T_OBJECT_OPERATOR","->",549],["T_STRING","getIndexerCode",549],"(",")",";",["T_WHITESPACE","\n            ",549],["T_VARIABLE","$node",550],["T_WHITESPACE"," ",550],"=",["T_WHITESPACE"," ",550],["T_STRING","Mage",550],["T_DOUBLE_COLON","::",550],["T_STRING","getConfig",550],"(",")",["T_OBJECT_OPERATOR","->",550],["T_STRING","getNode",550],"(",["T_VARIABLE","$path",550],")",";",["T_WHITESPACE","\n            ",550],["T_IF","if",551],["T_WHITESPACE"," ",551],"(",["T_VARIABLE","$node",551],")",["T_WHITESPACE"," ",551],"{",["T_WHITESPACE","\n                ",551],["T_VARIABLE","$data",552],["T_WHITESPACE"," ",552],"=",["T_WHITESPACE"," ",552],["T_VARIABLE","$node",552],["T_OBJECT_OPERATOR","->",552],["T_STRING","asArray",552],"(",")",";",["T_WHITESPACE","\n                ",552],["T_IF","if",553],["T_WHITESPACE"," ",553],"(",["T_ISSET","isset",553],"(",["T_VARIABLE","$data",553],"[",["T_CONSTANT_ENCAPSED_STRING","'depends'",553],"]",")",["T_WHITESPACE"," ",553],["T_BOOLEAN_AND","&&",553],["T_WHITESPACE"," ",553],["T_STRING","is_array",553],"(",["T_VARIABLE","$data",553],"[",["T_CONSTANT_ENCAPSED_STRING","'depends'",553],"]",")",")",["T_WHITESPACE"," ",553],"{",["T_WHITESPACE","\n                    ",553],["T_VARIABLE","$depends",554],["T_WHITESPACE"," ",554],"=",["T_WHITESPACE"," ",554],["T_STRING","array_keys",554],"(",["T_VARIABLE","$data",554],"[",["T_CONSTANT_ENCAPSED_STRING","'depends'",554],"]",")",";",["T_WHITESPACE","\n                ",554],"}",["T_WHITESPACE","\n            ",555],"}",["T_WHITESPACE","\n\n            ",556],["T_VARIABLE","$this",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","setData",558],"(",["T_CONSTANT_ENCAPSED_STRING","'depends'",558],",",["T_WHITESPACE"," ",558],["T_VARIABLE","$depends",558],")",";",["T_WHITESPACE","\n        ",558],"}",["T_WHITESPACE","\n\n        ",559],["T_RETURN","return",561],["T_WHITESPACE"," ",561],["T_VARIABLE","$depends",561],";",["T_WHITESPACE","\n    ",561],"}",["T_WHITESPACE","\n\n    ",562],["T_DOC_COMMENT","\/**\n     * Set whether table changes are allowed\n     *\n     * @deprecated after 1.6.1.0\n     * @param bool $value\n     * @return Mage_Index_Model_Process\n     *\/",564],["T_WHITESPACE","\n    ",570],["T_PUBLIC","public",571],["T_WHITESPACE"," ",571],["T_FUNCTION","function",571],["T_WHITESPACE"," ",571],["T_STRING","setAllowTableChanges",571],"(",["T_VARIABLE","$value",571],["T_WHITESPACE"," ",571],"=",["T_WHITESPACE"," ",571],["T_STRING","true",571],")",["T_WHITESPACE","\n    ",571],"{",["T_WHITESPACE","\n        ",572],["T_VARIABLE","$this",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","_allowTableChanges",573],["T_WHITESPACE"," ",573],"=",["T_WHITESPACE"," ",573],["T_VARIABLE","$value",573],";",["T_WHITESPACE","\n        ",573],["T_RETURN","return",574],["T_WHITESPACE"," ",574],["T_VARIABLE","$this",574],";",["T_WHITESPACE","\n    ",574],"}",["T_WHITESPACE","\n\n    ",575],["T_DOC_COMMENT","\/**\n     * Disable keys in index table\n     *\n     * @return Mage_Index_Model_Process\n     *\/",577],["T_WHITESPACE","\n    ",581],["T_PUBLIC","public",582],["T_WHITESPACE"," ",582],["T_FUNCTION","function",582],["T_WHITESPACE"," ",582],["T_STRING","disableIndexerKeys",582],"(",")",["T_WHITESPACE","\n    ",582],"{",["T_WHITESPACE","\n        ",583],["T_VARIABLE","$indexer",584],["T_WHITESPACE"," ",584],"=",["T_WHITESPACE"," ",584],["T_VARIABLE","$this",584],["T_OBJECT_OPERATOR","->",584],["T_STRING","getIndexer",584],"(",")",";",["T_WHITESPACE","\n        ",584],["T_IF","if",585],["T_WHITESPACE"," ",585],"(",["T_VARIABLE","$indexer",585],")",["T_WHITESPACE"," ",585],"{",["T_WHITESPACE","\n            ",585],["T_VARIABLE","$indexer",586],["T_OBJECT_OPERATOR","->",586],["T_STRING","disableKeys",586],"(",")",";",["T_WHITESPACE","\n        ",586],"}",["T_WHITESPACE","\n        ",587],["T_RETURN","return",588],["T_WHITESPACE"," ",588],["T_VARIABLE","$this",588],";",["T_WHITESPACE","\n    ",588],"}",["T_WHITESPACE","\n\n    ",589],["T_DOC_COMMENT","\/**\n     * Enable keys in index table\n     *\n     * @return Mage_Index_Model_Process\n     *\/",591],["T_WHITESPACE","\n    ",595],["T_PUBLIC","public",596],["T_WHITESPACE"," ",596],["T_FUNCTION","function",596],["T_WHITESPACE"," ",596],["T_STRING","enableIndexerKeys",596],"(",")",["T_WHITESPACE","\n    ",596],"{",["T_WHITESPACE","\n        ",597],["T_VARIABLE","$indexer",598],["T_WHITESPACE"," ",598],"=",["T_WHITESPACE"," ",598],["T_VARIABLE","$this",598],["T_OBJECT_OPERATOR","->",598],["T_STRING","getIndexer",598],"(",")",";",["T_WHITESPACE","\n        ",598],["T_IF","if",599],["T_WHITESPACE"," ",599],"(",["T_VARIABLE","$indexer",599],")",["T_WHITESPACE"," ",599],"{",["T_WHITESPACE","\n            ",599],["T_VARIABLE","$indexer",600],["T_OBJECT_OPERATOR","->",600],["T_STRING","enableKeys",600],"(",")",";",["T_WHITESPACE","\n        ",600],"}",["T_WHITESPACE","\n        ",601],["T_RETURN","return",602],["T_WHITESPACE"," ",602],["T_VARIABLE","$this",602],";",["T_WHITESPACE","\n    ",602],"}",["T_WHITESPACE","\n\n    ",603],["T_DOC_COMMENT","\/**\n     * Process event with locks checking\n     *\n     * @param Mage_Index_Model_Event $event\n     * @return Mage_Index_Model_Process\n     *\/",605],["T_WHITESPACE","\n    ",610],["T_PUBLIC","public",611],["T_WHITESPACE"," ",611],["T_FUNCTION","function",611],["T_WHITESPACE"," ",611],["T_STRING","safeProcessEvent",611],"(",["T_STRING","Mage_Index_Model_Event",611],["T_WHITESPACE"," ",611],["T_VARIABLE","$event",611],")",["T_WHITESPACE","\n    ",611],"{",["T_WHITESPACE","\n        ",612],["T_IF","if",613],["T_WHITESPACE"," ",613],"(",["T_VARIABLE","$this",613],["T_OBJECT_OPERATOR","->",613],["T_STRING","isLocked",613],"(",")",")",["T_WHITESPACE"," ",613],"{",["T_WHITESPACE","\n            ",613],["T_RETURN","return",614],["T_WHITESPACE"," ",614],["T_VARIABLE","$this",614],";",["T_WHITESPACE","\n        ",614],"}",["T_WHITESPACE","\n        ",615],["T_IF","if",616],["T_WHITESPACE"," ",616],"(","!",["T_VARIABLE","$this",616],["T_OBJECT_OPERATOR","->",616],["T_STRING","matchEvent",616],"(",["T_VARIABLE","$event",616],")",")",["T_WHITESPACE"," ",616],"{",["T_WHITESPACE","\n            ",616],["T_RETURN","return",617],["T_WHITESPACE"," ",617],["T_VARIABLE","$this",617],";",["T_WHITESPACE","\n        ",617],"}",["T_WHITESPACE","\n        ",618],["T_VARIABLE","$this",619],["T_OBJECT_OPERATOR","->",619],["T_STRING","lock",619],"(",")",";",["T_WHITESPACE","\n        ",619],["T_TRY","try",620],["T_WHITESPACE"," ",620],"{",["T_WHITESPACE","\n            ",620],["T_VARIABLE","$this",621],["T_OBJECT_OPERATOR","->",621],["T_STRING","processEvent",621],"(",["T_VARIABLE","$event",621],")",";",["T_WHITESPACE","\n            ",621],["T_VARIABLE","$this",622],["T_OBJECT_OPERATOR","->",622],["T_STRING","unlock",622],"(",")",";",["T_WHITESPACE","\n        ",622],"}",["T_WHITESPACE"," ",623],["T_CATCH","catch",623],["T_WHITESPACE"," ",623],"(",["T_STRING","Exception",623],["T_WHITESPACE"," ",623],["T_VARIABLE","$e",623],")",["T_WHITESPACE"," ",623],"{",["T_WHITESPACE","\n            ",623],["T_VARIABLE","$this",624],["T_OBJECT_OPERATOR","->",624],["T_STRING","unlock",624],"(",")",";",["T_WHITESPACE","\n            ",624],["T_THROW","throw",625],["T_WHITESPACE"," ",625],["T_VARIABLE","$e",625],";",["T_WHITESPACE","\n        ",625],"}",["T_WHITESPACE","\n        ",626],["T_RETURN","return",627],["T_WHITESPACE"," ",627],["T_VARIABLE","$this",627],";",["T_WHITESPACE","\n    ",627],"}",["T_WHITESPACE","\n\n    ",628],["T_DOC_COMMENT","\/**\n     * Get unprocessed events collection\n     *\n     * @return Mage_Index_Model_Resource_Event_Collection\n     *\/",630],["T_WHITESPACE","\n    ",634],["T_PUBLIC","public",635],["T_WHITESPACE"," ",635],["T_FUNCTION","function",635],["T_WHITESPACE"," ",635],["T_STRING","getUnprocessedEventsCollection",635],"(",")",["T_WHITESPACE","\n    ",635],"{",["T_WHITESPACE","\n        ",636],["T_DOC_COMMENT","\/** @var $eventsCollection Mage_Index_Model_Resource_Event_Collection *\/",637],["T_WHITESPACE","\n        ",637],["T_VARIABLE","$eventsCollection",638],["T_WHITESPACE"," ",638],"=",["T_WHITESPACE"," ",638],["T_STRING","Mage",638],["T_DOUBLE_COLON","::",638],["T_STRING","getResourceModel",638],"(",["T_CONSTANT_ENCAPSED_STRING","'index\/event_collection'",638],")",";",["T_WHITESPACE","\n        ",638],["T_VARIABLE","$eventsCollection",639],["T_OBJECT_OPERATOR","->",639],["T_STRING","addProcessFilter",639],"(",["T_VARIABLE","$this",639],",",["T_WHITESPACE"," ",639],["T_STRING","self",639],["T_DOUBLE_COLON","::",639],["T_STRING","EVENT_STATUS_NEW",639],")",";",["T_WHITESPACE","\n        ",639],["T_RETURN","return",640],["T_WHITESPACE"," ",640],["T_VARIABLE","$eventsCollection",640],";",["T_WHITESPACE","\n    ",640],"}",["T_WHITESPACE","\n",641],"}",["T_WHITESPACE","\n",642]]