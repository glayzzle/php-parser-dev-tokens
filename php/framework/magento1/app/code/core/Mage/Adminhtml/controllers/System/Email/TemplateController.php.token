[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Adminhtml\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * System Template admin controller\n *\n * @category   Mage\n * @package    Mage_Adminhtml\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Adminhtml_System_Email_TemplateController",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Adminhtml_Controller_Action",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Index action\n     *\/",36],["T_WHITESPACE","\n    ",38],["T_PUBLIC","public",39],["T_WHITESPACE"," ",39],["T_FUNCTION","function",39],["T_WHITESPACE"," ",39],["T_STRING","indexAction",39],"(",")",["T_WHITESPACE","\n    ",39],"{",["T_WHITESPACE","\n        ",40],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","_title",41],"(",["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","__",41],"(",["T_CONSTANT_ENCAPSED_STRING","'System'",41],")",")",["T_OBJECT_OPERATOR","->",41],["T_STRING","_title",41],"(",["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","__",41],"(",["T_CONSTANT_ENCAPSED_STRING","'Transactional Emails'",41],")",")",";",["T_WHITESPACE","\n\n        ",41],["T_IF","if",43],["T_WHITESPACE"," ",43],"(",["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","getRequest",43],"(",")",["T_OBJECT_OPERATOR","->",43],["T_STRING","getQuery",43],"(",["T_CONSTANT_ENCAPSED_STRING","'ajax'",43],")",")",["T_WHITESPACE"," ",43],"{",["T_WHITESPACE","\n            ",43],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","_forward",44],"(",["T_CONSTANT_ENCAPSED_STRING","'grid'",44],")",";",["T_WHITESPACE","\n            ",44],["T_RETURN","return",45],";",["T_WHITESPACE","\n        ",45],"}",["T_WHITESPACE","\n\n        ",46],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","loadLayout",48],"(",")",";",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","_setActiveMenu",49],"(",["T_CONSTANT_ENCAPSED_STRING","'system\/email_template'",49],")",";",["T_WHITESPACE","\n        ",49],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","_addBreadcrumb",50],"(",["T_WHITESPACE","\n            ",50],["T_STRING","Mage",51],["T_DOUBLE_COLON","::",51],["T_STRING","helper",51],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",51],")",["T_OBJECT_OPERATOR","->",51],["T_STRING","__",51],"(",["T_CONSTANT_ENCAPSED_STRING","'Transactional Emails'",51],")",",",["T_WHITESPACE","\n            ",51],["T_STRING","Mage",52],["T_DOUBLE_COLON","::",52],["T_STRING","helper",52],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",52],")",["T_OBJECT_OPERATOR","->",52],["T_STRING","__",52],"(",["T_CONSTANT_ENCAPSED_STRING","'Transactional Emails'",52],")",["T_WHITESPACE","\n        ",52],")",";",["T_WHITESPACE","\n\n        ",53],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","_addContent",55],"(",["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","getLayout",55],"(",")",["T_OBJECT_OPERATOR","->",55],["T_STRING","createBlock",55],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/system_email_template'",55],",",["T_WHITESPACE"," ",55],["T_CONSTANT_ENCAPSED_STRING","'template'",55],")",")",";",["T_WHITESPACE","\n        ",55],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","renderLayout",56],"(",")",";",["T_WHITESPACE","\n    ",56],"}",["T_WHITESPACE","\n\n    ",57],["T_DOC_COMMENT","\/**\n     * Grid action\n     *\/",59],["T_WHITESPACE","\n    ",61],["T_PUBLIC","public",62],["T_WHITESPACE"," ",62],["T_FUNCTION","function",62],["T_WHITESPACE"," ",62],["T_STRING","gridAction",62],"(",")",["T_WHITESPACE","\n    ",62],"{",["T_WHITESPACE","\n        ",63],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","getResponse",64],"(",")",["T_OBJECT_OPERATOR","->",64],["T_STRING","setBody",64],"(",["T_WHITESPACE","\n            ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getLayout",65],"(",")",["T_OBJECT_OPERATOR","->",65],["T_STRING","createBlock",65],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/system_email_template_grid'",65],")",["T_OBJECT_OPERATOR","->",65],["T_STRING","toHtml",65],"(",")",["T_WHITESPACE","\n        ",65],")",";",["T_WHITESPACE","\n    ",66],"}",["T_WHITESPACE","\n\n    ",67],["T_DOC_COMMENT","\/**\n     * New transactional email action\n     *\/",69],["T_WHITESPACE","\n    ",71],["T_PUBLIC","public",72],["T_WHITESPACE"," ",72],["T_FUNCTION","function",72],["T_WHITESPACE"," ",72],["T_STRING","newAction",72],"(",")",["T_WHITESPACE","\n    ",72],"{",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","_forward",74],"(",["T_CONSTANT_ENCAPSED_STRING","'edit'",74],")",";",["T_WHITESPACE","\n    ",74],"}",["T_WHITESPACE","\n\n    ",75],["T_DOC_COMMENT","\/**\n     * Edit transactional email action\n     *\/",77],["T_WHITESPACE","\n    ",79],["T_PUBLIC","public",80],["T_WHITESPACE"," ",80],["T_FUNCTION","function",80],["T_WHITESPACE"," ",80],["T_STRING","editAction",80],"(",")",["T_WHITESPACE","\n    ",80],"{",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","loadLayout",82],"(",")",";",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$template",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","_initTemplate",83],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",83],")",";",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","_setActiveMenu",84],"(",["T_CONSTANT_ENCAPSED_STRING","'system\/email_template'",84],")",";",["T_WHITESPACE","\n        ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","_addBreadcrumb",85],"(",["T_WHITESPACE","\n            ",85],["T_STRING","Mage",86],["T_DOUBLE_COLON","::",86],["T_STRING","helper",86],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",86],")",["T_OBJECT_OPERATOR","->",86],["T_STRING","__",86],"(",["T_CONSTANT_ENCAPSED_STRING","'Transactional Emails'",86],")",",",["T_WHITESPACE","\n            ",86],["T_STRING","Mage",87],["T_DOUBLE_COLON","::",87],["T_STRING","helper",87],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",87],")",["T_OBJECT_OPERATOR","->",87],["T_STRING","__",87],"(",["T_CONSTANT_ENCAPSED_STRING","'Transactional Emails'",87],")",",",["T_WHITESPACE","\n            ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","getUrl",88],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*'",88],")",["T_WHITESPACE","\n        ",88],")",";",["T_WHITESPACE","\n\n        ",89],["T_IF","if",91],["T_WHITESPACE"," ",91],"(",["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getRequest",91],"(",")",["T_OBJECT_OPERATOR","->",91],["T_STRING","getParam",91],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",91],")",")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n            ",91],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","_addBreadcrumb",92],"(",["T_WHITESPACE","\n                ",92],["T_STRING","Mage",93],["T_DOUBLE_COLON","::",93],["T_STRING","helper",93],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",93],")",["T_OBJECT_OPERATOR","->",93],["T_STRING","__",93],"(",["T_CONSTANT_ENCAPSED_STRING","'Edit Template'",93],")",",",["T_WHITESPACE","\n                ",93],["T_STRING","Mage",94],["T_DOUBLE_COLON","::",94],["T_STRING","helper",94],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",94],")",["T_OBJECT_OPERATOR","->",94],["T_STRING","__",94],"(",["T_CONSTANT_ENCAPSED_STRING","'Edit System Template'",94],")",["T_WHITESPACE","\n            ",94],")",";",["T_WHITESPACE","\n        ",95],"}",["T_WHITESPACE"," ",96],["T_ELSE","else",96],["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n            ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","_addBreadcrumb",97],"(",["T_WHITESPACE","\n                ",97],["T_STRING","Mage",98],["T_DOUBLE_COLON","::",98],["T_STRING","helper",98],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",98],")",["T_OBJECT_OPERATOR","->",98],["T_STRING","__",98],"(",["T_CONSTANT_ENCAPSED_STRING","'New Template'",98],")",",",["T_WHITESPACE","\n                ",98],["T_STRING","Mage",99],["T_DOUBLE_COLON","::",99],["T_STRING","helper",99],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",99],")",["T_OBJECT_OPERATOR","->",99],["T_STRING","__",99],"(",["T_CONSTANT_ENCAPSED_STRING","'New System Template'",99],")",["T_WHITESPACE","\n            ",99],")",";",["T_WHITESPACE","\n        ",100],"}",["T_WHITESPACE","\n\n        ",101],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","_title",103],"(",["T_VARIABLE","$template",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getId",103],"(",")",["T_WHITESPACE"," ",103],"?",["T_WHITESPACE"," ",103],["T_VARIABLE","$template",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getTemplateCode",103],"(",")",["T_WHITESPACE"," ",103],":",["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","__",103],"(",["T_CONSTANT_ENCAPSED_STRING","'New Template'",103],")",")",";",["T_WHITESPACE","\n        ",103],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","_addContent",104],"(",["T_WHITESPACE","\n            ",104],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getLayout",105],"(",")",["T_OBJECT_OPERATOR","->",105],["T_STRING","createBlock",105],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/system_email_template_edit'",105],",",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'template_edit'",105],")",["T_OBJECT_OPERATOR","->",105],["T_STRING","setEditMode",105],"(",["T_WHITESPACE","\n                ",105],["T_BOOL_CAST","(bool)",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","getRequest",106],"(",")",["T_OBJECT_OPERATOR","->",106],["T_STRING","getParam",106],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",106],")",["T_WHITESPACE","\n            ",106],")",["T_WHITESPACE","\n        ",107],")",";",["T_WHITESPACE","\n        ",108],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","renderLayout",109],"(",")",";",["T_WHITESPACE","\n    ",109],"}",["T_WHITESPACE","\n\n    ",110],["T_DOC_COMMENT","\/**\n     * Save action\n     *\/",112],["T_WHITESPACE","\n    ",114],["T_PUBLIC","public",115],["T_WHITESPACE"," ",115],["T_FUNCTION","function",115],["T_WHITESPACE"," ",115],["T_STRING","saveAction",115],"(",")",["T_WHITESPACE","\n    ",115],"{",["T_WHITESPACE","\n        ",116],["T_VARIABLE","$request",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getRequest",117],"(",")",";",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$id",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","getRequest",118],"(",")",["T_OBJECT_OPERATOR","->",118],["T_STRING","getParam",118],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",118],")",";",["T_WHITESPACE","\n\n        ",118],["T_VARIABLE","$template",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","_initTemplate",120],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",120],")",";",["T_WHITESPACE","\n        ",120],["T_IF","if",121],["T_WHITESPACE"," ",121],"(","!",["T_VARIABLE","$template",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","getId",121],"(",")",["T_WHITESPACE"," ",121],["T_BOOLEAN_AND","&&",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$id",121],")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n            ",121],["T_STRING","Mage",122],["T_DOUBLE_COLON","::",122],["T_STRING","getSingleton",122],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",122],")",["T_OBJECT_OPERATOR","->",122],["T_STRING","addError",122],"(",["T_WHITESPACE","\n                ",122],["T_STRING","Mage",123],["T_DOUBLE_COLON","::",123],["T_STRING","helper",123],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",123],")",["T_OBJECT_OPERATOR","->",123],["T_STRING","__",123],"(",["T_CONSTANT_ENCAPSED_STRING","'This Email template no longer exists.'",123],")",["T_WHITESPACE","\n            ",123],")",";",["T_WHITESPACE","\n            ",124],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","_redirect",125],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/'",125],")",";",["T_WHITESPACE","\n            ",125],["T_RETURN","return",126],";",["T_WHITESPACE","\n        ",126],"}",["T_WHITESPACE","\n\n        ",127],["T_TRY","try",129],["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n            ",129],["T_VARIABLE","$template",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","setTemplateSubject",130],"(",["T_VARIABLE","$request",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getParam",130],"(",["T_CONSTANT_ENCAPSED_STRING","'template_subject'",130],")",")",["T_WHITESPACE","\n                ",130],["T_OBJECT_OPERATOR","->",131],["T_STRING","setTemplateCode",131],"(",["T_VARIABLE","$request",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","getParam",131],"(",["T_CONSTANT_ENCAPSED_STRING","'template_code'",131],")",")",["T_WHITESPACE","\n                ",131],["T_OBJECT_OPERATOR","->",132],["T_STRING","setTemplateText",132],"(",["T_VARIABLE","$request",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","getParam",132],"(",["T_CONSTANT_ENCAPSED_STRING","'template_text'",132],")",")",["T_WHITESPACE","\n                ",132],["T_OBJECT_OPERATOR","->",133],["T_STRING","setTemplateStyles",133],"(",["T_VARIABLE","$request",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getParam",133],"(",["T_CONSTANT_ENCAPSED_STRING","'template_styles'",133],")",")",["T_WHITESPACE","\n                ",133],["T_OBJECT_OPERATOR","->",134],["T_STRING","setModifiedAt",134],"(",["T_STRING","Mage",134],["T_DOUBLE_COLON","::",134],["T_STRING","getSingleton",134],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/date'",134],")",["T_OBJECT_OPERATOR","->",134],["T_STRING","gmtDate",134],"(",")",")",["T_WHITESPACE","\n                ",134],["T_OBJECT_OPERATOR","->",135],["T_STRING","setOrigTemplateCode",135],"(",["T_VARIABLE","$request",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getParam",135],"(",["T_CONSTANT_ENCAPSED_STRING","'orig_template_code'",135],")",")",["T_WHITESPACE","\n                ",135],["T_OBJECT_OPERATOR","->",136],["T_STRING","setOrigTemplateVariables",136],"(",["T_VARIABLE","$request",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getParam",136],"(",["T_CONSTANT_ENCAPSED_STRING","'orig_template_variables'",136],")",")",";",["T_WHITESPACE","\n\n            ",136],["T_IF","if",138],["T_WHITESPACE"," ",138],"(","!",["T_VARIABLE","$template",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","getId",138],"(",")",")",["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n                ",138],["T_VARIABLE","$template",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","setAddedAt",139],"(",["T_STRING","Mage",139],["T_DOUBLE_COLON","::",139],["T_STRING","getSingleton",139],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/date'",139],")",["T_OBJECT_OPERATOR","->",139],["T_STRING","gmtDate",139],"(",")",")",";",["T_WHITESPACE","\n                ",139],["T_VARIABLE","$template",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","setTemplateType",140],"(",["T_STRING","Mage_Core_Model_Email_Template",140],["T_DOUBLE_COLON","::",140],["T_STRING","TYPE_HTML",140],")",";",["T_WHITESPACE","\n            ",140],"}",["T_WHITESPACE","\n\n            ",141],["T_IF","if",143],["T_WHITESPACE"," ",143],"(",["T_VARIABLE","$request",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getParam",143],"(",["T_CONSTANT_ENCAPSED_STRING","'_change_type_flag'",143],")",")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n                ",143],["T_VARIABLE","$template",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","setTemplateType",144],"(",["T_STRING","Mage_Core_Model_Email_Template",144],["T_DOUBLE_COLON","::",144],["T_STRING","TYPE_TEXT",144],")",";",["T_WHITESPACE","\n                ",144],["T_VARIABLE","$template",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","setTemplateStyles",145],"(",["T_CONSTANT_ENCAPSED_STRING","''",145],")",";",["T_WHITESPACE","\n            ",145],"}",["T_WHITESPACE","\n\n            ",146],["T_VARIABLE","$template",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","save",148],"(",")",";",["T_WHITESPACE","\n            ",148],["T_STRING","Mage",149],["T_DOUBLE_COLON","::",149],["T_STRING","getSingleton",149],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",149],")",["T_OBJECT_OPERATOR","->",149],["T_STRING","setFormData",149],"(",["T_STRING","false",149],")",";",["T_WHITESPACE","\n            ",149],["T_STRING","Mage",150],["T_DOUBLE_COLON","::",150],["T_STRING","getSingleton",150],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",150],")",["T_OBJECT_OPERATOR","->",150],["T_STRING","addSuccess",150],"(",["T_WHITESPACE","\n                ",150],["T_STRING","Mage",151],["T_DOUBLE_COLON","::",151],["T_STRING","helper",151],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",151],")",["T_OBJECT_OPERATOR","->",151],["T_STRING","__",151],"(",["T_CONSTANT_ENCAPSED_STRING","'The email template has been saved.'",151],")",["T_WHITESPACE","\n            ",151],")",";",["T_WHITESPACE","\n            ",152],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","_redirect",153],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*'",153],")",";",["T_WHITESPACE","\n        ",153],"}",["T_WHITESPACE","\n        ",154],["T_CATCH","catch",155],["T_WHITESPACE"," ",155],"(",["T_STRING","Exception",155],["T_WHITESPACE"," ",155],["T_VARIABLE","$e",155],")",["T_WHITESPACE"," ",155],"{",["T_WHITESPACE","\n            ",155],["T_STRING","Mage",156],["T_DOUBLE_COLON","::",156],["T_STRING","getSingleton",156],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",156],")",["T_OBJECT_OPERATOR","->",156],["T_STRING","setData",156],"(",["T_WHITESPACE","\n                ",156],["T_CONSTANT_ENCAPSED_STRING","'email_template_form_data'",157],",",["T_WHITESPACE","\n                ",157],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","getRequest",158],"(",")",["T_OBJECT_OPERATOR","->",158],["T_STRING","getParams",158],"(",")",["T_WHITESPACE","\n            ",158],")",";",["T_WHITESPACE","\n            ",159],["T_STRING","Mage",160],["T_DOUBLE_COLON","::",160],["T_STRING","getSingleton",160],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",160],")",["T_OBJECT_OPERATOR","->",160],["T_STRING","addError",160],"(",["T_VARIABLE","$e",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","getMessage",160],"(",")",")",";",["T_WHITESPACE","\n            ",160],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","_forward",161],"(",["T_CONSTANT_ENCAPSED_STRING","'new'",161],")",";",["T_WHITESPACE","\n        ",161],"}",["T_WHITESPACE","\n    ",162],"}",["T_WHITESPACE","\n\n    ",163],["T_DOC_COMMENT","\/**\n     * Delete action\n     *\/",165],["T_WHITESPACE","\n    ",167],["T_PUBLIC","public",168],["T_WHITESPACE"," ",168],["T_FUNCTION","function",168],["T_WHITESPACE"," ",168],["T_STRING","deleteAction",168],"(",")",["T_WHITESPACE","\n    ",168],"{",["T_WHITESPACE","\n        ",169],["T_VARIABLE","$template",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","_initTemplate",170],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",170],")",";",["T_WHITESPACE","\n        ",170],["T_IF","if",171],["T_WHITESPACE"," ",171],"(",["T_VARIABLE","$template",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","getId",171],"(",")",")",["T_WHITESPACE"," ",171],"{",["T_WHITESPACE","\n            ",171],["T_TRY","try",172],["T_WHITESPACE"," ",172],"{",["T_WHITESPACE","\n                ",172],["T_VARIABLE","$template",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","delete",173],"(",")",";",["T_WHITESPACE","\n                ",173],["T_STRING","Mage",174],["T_DOUBLE_COLON","::",174],["T_STRING","getSingleton",174],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",174],")",["T_OBJECT_OPERATOR","->",174],["T_STRING","addSuccess",174],"(",["T_WHITESPACE","\n                    ",174],["T_STRING","Mage",175],["T_DOUBLE_COLON","::",175],["T_STRING","helper",175],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",175],")",["T_OBJECT_OPERATOR","->",175],["T_STRING","__",175],"(",["T_CONSTANT_ENCAPSED_STRING","'The email template has been deleted.'",175],")",["T_WHITESPACE","\n                ",175],")",";",["T_WHITESPACE","\n                ",176],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","_redirect",177],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/'",177],")",";",["T_WHITESPACE","\n                ",177],["T_RETURN","return",178],";",["T_WHITESPACE","\n            ",178],"}",["T_WHITESPACE","\n            ",179],["T_CATCH","catch",180],["T_WHITESPACE"," ",180],"(",["T_STRING","Mage_Core_Exception",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$e",180],")",["T_WHITESPACE"," ",180],"{",["T_WHITESPACE","\n                ",180],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","_getSession",181],"(",")",["T_OBJECT_OPERATOR","->",181],["T_STRING","addError",181],"(",["T_VARIABLE","$e",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","getMessage",181],"(",")",")",";",["T_WHITESPACE","\n            ",181],"}",["T_WHITESPACE","\n            ",182],["T_CATCH","catch",183],["T_WHITESPACE"," ",183],"(",["T_STRING","Exception",183],["T_WHITESPACE"," ",183],["T_VARIABLE","$e",183],")",["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n                ",183],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","_getSession",184],"(",")",["T_OBJECT_OPERATOR","->",184],["T_STRING","addError",184],"(",["T_WHITESPACE","\n                    ",184],["T_STRING","Mage",185],["T_DOUBLE_COLON","::",185],["T_STRING","helper",185],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",185],")",["T_OBJECT_OPERATOR","->",185],["T_STRING","__",185],"(",["T_CONSTANT_ENCAPSED_STRING","'An error occurred while deleting email template data. Please review log and try again.'",185],")",["T_WHITESPACE","\n                ",185],")",";",["T_WHITESPACE","\n                ",186],["T_STRING","Mage",187],["T_DOUBLE_COLON","::",187],["T_STRING","logException",187],"(",["T_VARIABLE","$e",187],")",";",["T_WHITESPACE","\n                ",187],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","_redirect",188],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/edit'",188],",",["T_WHITESPACE"," ",188],["T_ARRAY","array",188],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",188],["T_WHITESPACE"," ",188],["T_DOUBLE_ARROW","=>",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$template",188],")",")",";",["T_WHITESPACE","\n                ",188],["T_RETURN","return",189],";",["T_WHITESPACE","\n            ",189],"}",["T_WHITESPACE","\n        ",190],"}",["T_WHITESPACE","\n        ",191],["T_STRING","Mage",192],["T_DOUBLE_COLON","::",192],["T_STRING","getSingleton",192],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",192],")",["T_OBJECT_OPERATOR","->",192],["T_STRING","addError",192],"(",["T_WHITESPACE","\n            ",192],["T_STRING","Mage",193],["T_DOUBLE_COLON","::",193],["T_STRING","helper",193],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",193],")",["T_OBJECT_OPERATOR","->",193],["T_STRING","__",193],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to find a Email Template to delete.'",193],")",["T_WHITESPACE","\n        ",193],")",";",["T_WHITESPACE","\n        ",194],["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","_redirect",195],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/'",195],")",";",["T_WHITESPACE","\n    ",195],"}",["T_WHITESPACE","\n\n    ",196],["T_DOC_COMMENT","\/**\n     * Preview action\n     *\/",198],["T_WHITESPACE","\n    ",200],["T_PUBLIC","public",201],["T_WHITESPACE"," ",201],["T_FUNCTION","function",201],["T_WHITESPACE"," ",201],["T_STRING","previewAction",201],"(",")",["T_WHITESPACE","\n    ",201],"{",["T_WHITESPACE","\n        ",202],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","loadLayout",203],"(",["T_CONSTANT_ENCAPSED_STRING","'systemPreview'",203],")",";",["T_WHITESPACE","\n        ",203],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","renderLayout",204],"(",")",";",["T_WHITESPACE","\n    ",204],"}",["T_WHITESPACE","\n\n    ",205],["T_DOC_COMMENT","\/**\n     * Set template data to retrieve it in template info form\n     *\/",207],["T_WHITESPACE","\n    ",209],["T_PUBLIC","public",210],["T_WHITESPACE"," ",210],["T_FUNCTION","function",210],["T_WHITESPACE"," ",210],["T_STRING","defaultTemplateAction",210],"(",")",["T_WHITESPACE","\n    ",210],"{",["T_WHITESPACE","\n        ",211],["T_VARIABLE","$template",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","_initTemplate",212],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",212],")",";",["T_WHITESPACE","\n        ",212],["T_VARIABLE","$templateCode",213],["T_WHITESPACE"," ",213],"=",["T_WHITESPACE"," ",213],["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","getRequest",213],"(",")",["T_OBJECT_OPERATOR","->",213],["T_STRING","getParam",213],"(",["T_CONSTANT_ENCAPSED_STRING","'code'",213],")",";",["T_WHITESPACE","\n\n        ",213],["T_VARIABLE","$template",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","loadDefault",215],"(",["T_VARIABLE","$templateCode",215],",",["T_WHITESPACE"," ",215],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","getRequest",215],"(",")",["T_OBJECT_OPERATOR","->",215],["T_STRING","getParam",215],"(",["T_CONSTANT_ENCAPSED_STRING","'locale'",215],")",")",";",["T_WHITESPACE","\n        ",215],["T_VARIABLE","$template",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","setData",216],"(",["T_CONSTANT_ENCAPSED_STRING","'orig_template_code'",216],",",["T_WHITESPACE"," ",216],["T_VARIABLE","$templateCode",216],")",";",["T_WHITESPACE","\n        ",216],["T_VARIABLE","$template",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","setData",217],"(",["T_CONSTANT_ENCAPSED_STRING","'template_variables'",217],",",["T_WHITESPACE"," ",217],["T_STRING","Zend_Json",217],["T_DOUBLE_COLON","::",217],["T_STRING","encode",217],"(",["T_VARIABLE","$template",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","getVariablesOptionArray",217],"(",["T_STRING","true",217],")",")",")",";",["T_WHITESPACE","\n\n        ",217],["T_VARIABLE","$templateBlock",219],["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","getLayout",219],"(",")",["T_OBJECT_OPERATOR","->",219],["T_STRING","createBlock",219],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/system_email_template_edit'",219],")",";",["T_WHITESPACE","\n        ",219],["T_VARIABLE","$template",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","setData",220],"(",["T_CONSTANT_ENCAPSED_STRING","'orig_template_used_default_for'",220],",",["T_WHITESPACE"," ",220],["T_VARIABLE","$templateBlock",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","getUsedDefaultForPaths",220],"(",["T_STRING","false",220],")",")",";",["T_WHITESPACE","\n\n        ",220],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","getResponse",222],"(",")",["T_OBJECT_OPERATOR","->",222],["T_STRING","setBody",222],"(",["T_STRING","Mage",222],["T_DOUBLE_COLON","::",222],["T_STRING","helper",222],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",222],")",["T_OBJECT_OPERATOR","->",222],["T_STRING","jsonEncode",222],"(",["T_VARIABLE","$template",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","getData",222],"(",")",")",")",";",["T_WHITESPACE","\n    ",222],"}",["T_WHITESPACE","\n\n    ",223],["T_DOC_COMMENT","\/**\n     * Load email template from request\n     *\n     * @param string $idFieldName\n     * @return Mage_Adminhtml_Model_Email_Template\n     *\/",225],["T_WHITESPACE","\n    ",230],["T_PROTECTED","protected",231],["T_WHITESPACE"," ",231],["T_FUNCTION","function",231],["T_WHITESPACE"," ",231],["T_STRING","_initTemplate",231],"(",["T_VARIABLE","$idFieldName",231],["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],["T_CONSTANT_ENCAPSED_STRING","'template_id'",231],")",["T_WHITESPACE","\n    ",231],"{",["T_WHITESPACE","\n        ",232],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","_title",233],"(",["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","__",233],"(",["T_CONSTANT_ENCAPSED_STRING","'System'",233],")",")",["T_OBJECT_OPERATOR","->",233],["T_STRING","_title",233],"(",["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","__",233],"(",["T_CONSTANT_ENCAPSED_STRING","'Transactional Emails'",233],")",")",";",["T_WHITESPACE","\n\n        ",233],["T_VARIABLE","$id",235],["T_WHITESPACE"," ",235],"=",["T_WHITESPACE"," ",235],["T_INT_CAST","(int)",235],["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","getRequest",235],"(",")",["T_OBJECT_OPERATOR","->",235],["T_STRING","getParam",235],"(",["T_VARIABLE","$idFieldName",235],")",";",["T_WHITESPACE","\n        ",235],["T_VARIABLE","$model",236],["T_WHITESPACE"," ",236],"=",["T_WHITESPACE"," ",236],["T_STRING","Mage",236],["T_DOUBLE_COLON","::",236],["T_STRING","getModel",236],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/email_template'",236],")",";",["T_WHITESPACE","\n        ",236],["T_IF","if",237],["T_WHITESPACE"," ",237],"(",["T_VARIABLE","$id",237],")",["T_WHITESPACE"," ",237],"{",["T_WHITESPACE","\n            ",237],["T_VARIABLE","$model",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","load",238],"(",["T_VARIABLE","$id",238],")",";",["T_WHITESPACE","\n        ",238],"}",["T_WHITESPACE","\n        ",239],["T_IF","if",240],["T_WHITESPACE"," ",240],"(","!",["T_STRING","Mage",240],["T_DOUBLE_COLON","::",240],["T_STRING","registry",240],"(",["T_CONSTANT_ENCAPSED_STRING","'email_template'",240],")",")",["T_WHITESPACE"," ",240],"{",["T_WHITESPACE","\n            ",240],["T_STRING","Mage",241],["T_DOUBLE_COLON","::",241],["T_STRING","register",241],"(",["T_CONSTANT_ENCAPSED_STRING","'email_template'",241],",",["T_WHITESPACE"," ",241],["T_VARIABLE","$model",241],")",";",["T_WHITESPACE","\n        ",241],"}",["T_WHITESPACE","\n        ",242],["T_IF","if",243],["T_WHITESPACE"," ",243],"(","!",["T_STRING","Mage",243],["T_DOUBLE_COLON","::",243],["T_STRING","registry",243],"(",["T_CONSTANT_ENCAPSED_STRING","'current_email_template'",243],")",")",["T_WHITESPACE"," ",243],"{",["T_WHITESPACE","\n            ",243],["T_STRING","Mage",244],["T_DOUBLE_COLON","::",244],["T_STRING","register",244],"(",["T_CONSTANT_ENCAPSED_STRING","'current_email_template'",244],",",["T_WHITESPACE"," ",244],["T_VARIABLE","$model",244],")",";",["T_WHITESPACE","\n        ",244],"}",["T_WHITESPACE","\n        ",245],["T_RETURN","return",246],["T_WHITESPACE"," ",246],["T_VARIABLE","$model",246],";",["T_WHITESPACE","\n    ",246],"}",["T_WHITESPACE","\n\n    ",247],["T_DOC_COMMENT","\/**\n     * Check permissions\n     *\n     * @return bool\n     *\/",249],["T_WHITESPACE","\n    ",253],["T_PROTECTED","protected",254],["T_WHITESPACE"," ",254],["T_FUNCTION","function",254],["T_WHITESPACE"," ",254],["T_STRING","_isAllowed",254],"(",")",["T_WHITESPACE","\n    ",254],"{",["T_WHITESPACE","\n        ",255],["T_RETURN","return",256],["T_WHITESPACE"," ",256],["T_STRING","Mage",256],["T_DOUBLE_COLON","::",256],["T_STRING","getSingleton",256],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/session'",256],")",["T_OBJECT_OPERATOR","->",256],["T_STRING","isAllowed",256],"(",["T_CONSTANT_ENCAPSED_STRING","'system\/email_template'",256],")",";",["T_WHITESPACE","\n    ",256],"}",["T_WHITESPACE","\n",257],"}",["T_WHITESPACE","\n",258]]