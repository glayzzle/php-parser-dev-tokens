[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Adminhtml\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n",25],["T_CLASS","class",26],["T_WHITESPACE"," ",26],["T_STRING","Mage_Adminhtml_Permissions_UserController",26],["T_WHITESPACE"," ",26],["T_EXTENDS","extends",26],["T_WHITESPACE"," ",26],["T_STRING","Mage_Adminhtml_Controller_Action",26],["T_WHITESPACE","\n",26],"{",["T_WHITESPACE","\n\n    ",27],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_FUNCTION","function",29],["T_WHITESPACE"," ",29],["T_STRING","_initAction",29],"(",")",["T_WHITESPACE","\n    ",29],"{",["T_WHITESPACE","\n        ",30],["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","loadLayout",31],"(",")",["T_WHITESPACE","\n            ",31],["T_OBJECT_OPERATOR","->",32],["T_STRING","_setActiveMenu",32],"(",["T_CONSTANT_ENCAPSED_STRING","'system\/acl'",32],")",["T_WHITESPACE","\n            ",32],["T_OBJECT_OPERATOR","->",33],["T_STRING","_addBreadcrumb",33],"(",["T_VARIABLE","$this",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","__",33],"(",["T_CONSTANT_ENCAPSED_STRING","'System'",33],")",",",["T_WHITESPACE"," ",33],["T_VARIABLE","$this",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","__",33],"(",["T_CONSTANT_ENCAPSED_STRING","'System'",33],")",")",["T_WHITESPACE","\n            ",33],["T_OBJECT_OPERATOR","->",34],["T_STRING","_addBreadcrumb",34],"(",["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","__",34],"(",["T_CONSTANT_ENCAPSED_STRING","'Permissions'",34],")",",",["T_WHITESPACE"," ",34],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","__",34],"(",["T_CONSTANT_ENCAPSED_STRING","'Permissions'",34],")",")",["T_WHITESPACE","\n            ",34],["T_OBJECT_OPERATOR","->",35],["T_STRING","_addBreadcrumb",35],"(",["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","__",35],"(",["T_CONSTANT_ENCAPSED_STRING","'Users'",35],")",",",["T_WHITESPACE"," ",35],["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","__",35],"(",["T_CONSTANT_ENCAPSED_STRING","'Users'",35],")",")",["T_WHITESPACE","\n        ",35],";",["T_WHITESPACE","\n        ",36],["T_RETURN","return",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$this",37],";",["T_WHITESPACE","\n    ",37],"}",["T_WHITESPACE","\n\n    ",38],["T_PUBLIC","public",40],["T_WHITESPACE"," ",40],["T_FUNCTION","function",40],["T_WHITESPACE"," ",40],["T_STRING","indexAction",40],"(",")",["T_WHITESPACE","\n    ",40],"{",["T_WHITESPACE","\n        ",41],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","_title",42],"(",["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","__",42],"(",["T_CONSTANT_ENCAPSED_STRING","'System'",42],")",")",["T_WHITESPACE","\n             ",42],["T_OBJECT_OPERATOR","->",43],["T_STRING","_title",43],"(",["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","__",43],"(",["T_CONSTANT_ENCAPSED_STRING","'Permissions'",43],")",")",["T_WHITESPACE","\n             ",43],["T_OBJECT_OPERATOR","->",44],["T_STRING","_title",44],"(",["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","__",44],"(",["T_CONSTANT_ENCAPSED_STRING","'Users'",44],")",")",";",["T_WHITESPACE","\n\n        ",44],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","_initAction",46],"(",")",["T_WHITESPACE","\n            ",46],["T_OBJECT_OPERATOR","->",47],["T_STRING","_addContent",47],"(",["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","getLayout",47],"(",")",["T_OBJECT_OPERATOR","->",47],["T_STRING","createBlock",47],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/permissions_user'",47],")",")",["T_WHITESPACE","\n            ",47],["T_OBJECT_OPERATOR","->",48],["T_STRING","renderLayout",48],"(",")",";",["T_WHITESPACE","\n    ",48],"}",["T_WHITESPACE","\n\n    ",49],["T_PUBLIC","public",51],["T_WHITESPACE"," ",51],["T_FUNCTION","function",51],["T_WHITESPACE"," ",51],["T_STRING","newAction",51],"(",")",["T_WHITESPACE","\n    ",51],"{",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","_forward",53],"(",["T_CONSTANT_ENCAPSED_STRING","'edit'",53],")",";",["T_WHITESPACE","\n    ",53],"}",["T_WHITESPACE","\n\n    ",54],["T_PUBLIC","public",56],["T_WHITESPACE"," ",56],["T_FUNCTION","function",56],["T_WHITESPACE"," ",56],["T_STRING","editAction",56],"(",")",["T_WHITESPACE","\n    ",56],"{",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","_title",58],"(",["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","__",58],"(",["T_CONSTANT_ENCAPSED_STRING","'System'",58],")",")",["T_WHITESPACE","\n             ",58],["T_OBJECT_OPERATOR","->",59],["T_STRING","_title",59],"(",["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","__",59],"(",["T_CONSTANT_ENCAPSED_STRING","'Permissions'",59],")",")",["T_WHITESPACE","\n             ",59],["T_OBJECT_OPERATOR","->",60],["T_STRING","_title",60],"(",["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","__",60],"(",["T_CONSTANT_ENCAPSED_STRING","'Users'",60],")",")",";",["T_WHITESPACE","\n\n        ",60],["T_VARIABLE","$id",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","getRequest",62],"(",")",["T_OBJECT_OPERATOR","->",62],["T_STRING","getParam",62],"(",["T_CONSTANT_ENCAPSED_STRING","'user_id'",62],")",";",["T_WHITESPACE","\n        ",62],["T_VARIABLE","$model",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_STRING","Mage",63],["T_DOUBLE_COLON","::",63],["T_STRING","getModel",63],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/user'",63],")",";",["T_WHITESPACE","\n\n        ",63],["T_IF","if",65],["T_WHITESPACE"," ",65],"(",["T_VARIABLE","$id",65],")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n            ",65],["T_VARIABLE","$model",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","load",66],"(",["T_VARIABLE","$id",66],")",";",["T_WHITESPACE","\n            ",66],["T_IF","if",67],["T_WHITESPACE"," ",67],"(","!",["T_WHITESPACE"," ",67],["T_VARIABLE","$model",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getId",67],"(",")",")",["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n                ",67],["T_STRING","Mage",68],["T_DOUBLE_COLON","::",68],["T_STRING","getSingleton",68],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",68],")",["T_OBJECT_OPERATOR","->",68],["T_STRING","addError",68],"(",["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","__",68],"(",["T_CONSTANT_ENCAPSED_STRING","'This user no longer exists.'",68],")",")",";",["T_WHITESPACE","\n                ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","_redirect",69],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/'",69],")",";",["T_WHITESPACE","\n                ",69],["T_RETURN","return",70],";",["T_WHITESPACE","\n            ",70],"}",["T_WHITESPACE","\n        ",71],"}",["T_WHITESPACE","\n\n        ",72],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","_title",74],"(",["T_VARIABLE","$model",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","getId",74],"(",")",["T_WHITESPACE"," ",74],"?",["T_WHITESPACE"," ",74],["T_VARIABLE","$model",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","getName",74],"(",")",["T_WHITESPACE"," ",74],":",["T_WHITESPACE"," ",74],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","__",74],"(",["T_CONSTANT_ENCAPSED_STRING","'New User'",74],")",")",";",["T_WHITESPACE","\n\n        ",74],["T_COMMENT","\/\/ Restore previously entered form data from session\n",76],["T_WHITESPACE","        ",77],["T_VARIABLE","$data",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_STRING","Mage",77],["T_DOUBLE_COLON","::",77],["T_STRING","getSingleton",77],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",77],")",["T_OBJECT_OPERATOR","->",77],["T_STRING","getUserData",77],"(",["T_STRING","true",77],")",";",["T_WHITESPACE","\n        ",77],["T_IF","if",78],["T_WHITESPACE"," ",78],"(","!",["T_EMPTY","empty",78],"(",["T_VARIABLE","$data",78],")",")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n            ",78],["T_VARIABLE","$model",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","setData",79],"(",["T_VARIABLE","$data",79],")",";",["T_WHITESPACE","\n        ",79],"}",["T_WHITESPACE","\n\n        ",80],["T_STRING","Mage",82],["T_DOUBLE_COLON","::",82],["T_STRING","register",82],"(",["T_CONSTANT_ENCAPSED_STRING","'permissions_user'",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$model",82],")",";",["T_WHITESPACE","\n\n        ",82],["T_IF","if",84],["T_WHITESPACE"," ",84],"(",["T_ISSET","isset",84],"(",["T_VARIABLE","$id",84],")",")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n            ",84],["T_VARIABLE","$breadcrumb",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","__",85],"(",["T_CONSTANT_ENCAPSED_STRING","'Edit User'",85],")",";",["T_WHITESPACE","\n        ",85],"}",["T_WHITESPACE"," ",86],["T_ELSE","else",86],["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n            ",86],["T_VARIABLE","$breadcrumb",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","__",87],"(",["T_CONSTANT_ENCAPSED_STRING","'New User'",87],")",";",["T_WHITESPACE","\n        ",87],"}",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","_initAction",89],"(",")",["T_WHITESPACE","\n            ",89],["T_OBJECT_OPERATOR","->",90],["T_STRING","_addBreadcrumb",90],"(",["T_VARIABLE","$breadcrumb",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$breadcrumb",90],")",";",["T_WHITESPACE","\n\n        ",90],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getLayout",92],"(",")",["T_OBJECT_OPERATOR","->",92],["T_STRING","getBlock",92],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml.permissions.user.edit'",92],")",["T_WHITESPACE","\n            ",92],["T_OBJECT_OPERATOR","->",93],["T_STRING","setData",93],"(",["T_CONSTANT_ENCAPSED_STRING","'action'",93],",",["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getUrl",93],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/permissions_user\/save'",93],")",")",";",["T_WHITESPACE","\n\n        ",93],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","renderLayout",95],"(",")",";",["T_WHITESPACE","\n    ",95],"}",["T_WHITESPACE","\n\n    ",96],["T_PUBLIC","public",98],["T_WHITESPACE"," ",98],["T_FUNCTION","function",98],["T_WHITESPACE"," ",98],["T_STRING","saveAction",98],"(",")",["T_WHITESPACE","\n    ",98],"{",["T_WHITESPACE","\n        ",99],["T_IF","if",100],["T_WHITESPACE"," ",100],"(",["T_VARIABLE","$data",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getRequest",100],"(",")",["T_OBJECT_OPERATOR","->",100],["T_STRING","getPost",100],"(",")",")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n\n            ",100],["T_VARIABLE","$id",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getRequest",102],"(",")",["T_OBJECT_OPERATOR","->",102],["T_STRING","getParam",102],"(",["T_CONSTANT_ENCAPSED_STRING","'user_id'",102],")",";",["T_WHITESPACE","\n            ",102],["T_VARIABLE","$model",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_STRING","Mage",103],["T_DOUBLE_COLON","::",103],["T_STRING","getModel",103],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/user'",103],")",["T_OBJECT_OPERATOR","->",103],["T_STRING","load",103],"(",["T_VARIABLE","$id",103],")",";",["T_WHITESPACE","\n            ",103],["T_IF","if",104],["T_WHITESPACE"," ",104],"(","!",["T_VARIABLE","$model",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getId",104],"(",")",["T_WHITESPACE"," ",104],["T_BOOLEAN_AND","&&",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$id",104],")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n                ",104],["T_STRING","Mage",105],["T_DOUBLE_COLON","::",105],["T_STRING","getSingleton",105],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",105],")",["T_OBJECT_OPERATOR","->",105],["T_STRING","addError",105],"(",["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","__",105],"(",["T_CONSTANT_ENCAPSED_STRING","'This user no longer exists.'",105],")",")",";",["T_WHITESPACE","\n                ",105],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","_redirect",106],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/'",106],")",";",["T_WHITESPACE","\n                ",106],["T_RETURN","return",107],";",["T_WHITESPACE","\n            ",107],"}",["T_WHITESPACE","\n\n            ",108],["T_COMMENT","\/\/Validate current admin password\n",110],["T_WHITESPACE","            ",111],["T_VARIABLE","$currentPassword",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","getRequest",111],"(",")",["T_OBJECT_OPERATOR","->",111],["T_STRING","getParam",111],"(",["T_CONSTANT_ENCAPSED_STRING","'current_password'",111],",",["T_WHITESPACE"," ",111],["T_STRING","null",111],")",";",["T_WHITESPACE","\n            ",111],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","getRequest",112],"(",")",["T_OBJECT_OPERATOR","->",112],["T_STRING","setParam",112],"(",["T_CONSTANT_ENCAPSED_STRING","'current_password'",112],",",["T_WHITESPACE"," ",112],["T_STRING","null",112],")",";",["T_WHITESPACE","\n            ",112],["T_UNSET","unset",113],"(",["T_VARIABLE","$data",113],"[",["T_CONSTANT_ENCAPSED_STRING","'current_password'",113],"]",")",";",["T_WHITESPACE","\n            ",113],["T_VARIABLE","$result",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","_validateCurrentPassword",114],"(",["T_VARIABLE","$currentPassword",114],")",";",["T_WHITESPACE","\n\n            ",114],["T_VARIABLE","$model",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","setData",116],"(",["T_VARIABLE","$data",116],")",";",["T_WHITESPACE","\n\n            ",116],["T_COMMENT","\/*\n             * Unsetting new password and password confirmation if they are blank\n             *\/",118],["T_WHITESPACE","\n            ",120],["T_IF","if",121],["T_WHITESPACE"," ",121],"(",["T_VARIABLE","$model",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","hasNewPassword",121],"(",")",["T_WHITESPACE"," ",121],["T_BOOLEAN_AND","&&",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$model",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","getNewPassword",121],"(",")",["T_WHITESPACE"," ",121],["T_IS_IDENTICAL","===",121],["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","''",121],")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n                ",121],["T_VARIABLE","$model",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","unsNewPassword",122],"(",")",";",["T_WHITESPACE","\n            ",122],"}",["T_WHITESPACE","\n            ",123],["T_IF","if",124],["T_WHITESPACE"," ",124],"(",["T_VARIABLE","$model",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","hasPasswordConfirmation",124],"(",")",["T_WHITESPACE"," ",124],["T_BOOLEAN_AND","&&",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$model",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","getPasswordConfirmation",124],"(",")",["T_WHITESPACE"," ",124],["T_IS_IDENTICAL","===",124],["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","''",124],")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n                ",124],["T_VARIABLE","$model",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","unsPasswordConfirmation",125],"(",")",";",["T_WHITESPACE","\n            ",125],"}",["T_WHITESPACE","\n\n            ",126],["T_IF","if",128],["T_WHITESPACE"," ",128],"(","!",["T_STRING","is_array",128],"(",["T_VARIABLE","$result",128],")",")",["T_WHITESPACE"," ",128],"{",["T_WHITESPACE","\n                ",128],["T_VARIABLE","$result",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_VARIABLE","$model",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","validate",129],"(",")",";",["T_WHITESPACE","\n            ",129],"}",["T_WHITESPACE","\n            ",130],["T_IF","if",131],["T_WHITESPACE"," ",131],"(",["T_STRING","is_array",131],"(",["T_VARIABLE","$result",131],")",")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n                ",131],["T_STRING","Mage",132],["T_DOUBLE_COLON","::",132],["T_STRING","getSingleton",132],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",132],")",["T_OBJECT_OPERATOR","->",132],["T_STRING","setUserData",132],"(",["T_VARIABLE","$data",132],")",";",["T_WHITESPACE","\n                ",132],["T_FOREACH","foreach",133],["T_WHITESPACE"," ",133],"(",["T_VARIABLE","$result",133],["T_WHITESPACE"," ",133],["T_AS","as",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$message",133],")",["T_WHITESPACE"," ",133],"{",["T_WHITESPACE","\n                    ",133],["T_STRING","Mage",134],["T_DOUBLE_COLON","::",134],["T_STRING","getSingleton",134],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",134],")",["T_OBJECT_OPERATOR","->",134],["T_STRING","addError",134],"(",["T_VARIABLE","$message",134],")",";",["T_WHITESPACE","\n                ",134],"}",["T_WHITESPACE","\n                ",135],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","_redirect",136],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/edit'",136],",",["T_WHITESPACE"," ",136],["T_ARRAY","array",136],"(",["T_CONSTANT_ENCAPSED_STRING","'_current'",136],["T_WHITESPACE"," ",136],["T_DOUBLE_ARROW","=>",136],["T_WHITESPACE"," ",136],["T_STRING","true",136],")",")",";",["T_WHITESPACE","\n                ",136],["T_RETURN","return",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$this",137],";",["T_WHITESPACE","\n            ",137],"}",["T_WHITESPACE","\n\n            ",138],["T_TRY","try",140],["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n                ",140],["T_VARIABLE","$model",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","save",141],"(",")",";",["T_WHITESPACE","\n                ",141],["T_IF","if",142],["T_WHITESPACE"," ",142],"(",["T_WHITESPACE"," ",142],["T_VARIABLE","$uRoles",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","getRequest",142],"(",")",["T_OBJECT_OPERATOR","->",142],["T_STRING","getParam",142],"(",["T_CONSTANT_ENCAPSED_STRING","'roles'",142],",",["T_WHITESPACE"," ",142],["T_STRING","false",142],")",["T_WHITESPACE"," ",142],")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n                    ",142],["T_COMMENT","\/*parse_str($uRoles, $uRoles);\n                    $uRoles = array_keys($uRoles);*\/",143],["T_WHITESPACE","\n                    ",144],["T_IF","if",145],["T_WHITESPACE"," ",145],"(",["T_WHITESPACE"," ",145],["T_LNUMBER","1",145],["T_WHITESPACE"," ",145],["T_IS_EQUAL","==",145],["T_WHITESPACE"," ",145],["T_STRING","sizeof",145],"(",["T_VARIABLE","$uRoles",145],")",["T_WHITESPACE"," ",145],")",["T_WHITESPACE"," ",145],"{",["T_WHITESPACE","\n                        ",145],["T_VARIABLE","$model",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","setRoleIds",146],"(",["T_VARIABLE","$uRoles",146],")",["T_WHITESPACE","\n                            ",146],["T_OBJECT_OPERATOR","->",147],["T_STRING","setRoleUserId",147],"(",["T_VARIABLE","$model",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","getUserId",147],"(",")",")",["T_WHITESPACE","\n                            ",147],["T_OBJECT_OPERATOR","->",148],["T_STRING","saveRelations",148],"(",")",";",["T_WHITESPACE","\n                    ",148],"}",["T_WHITESPACE"," ",149],["T_ELSE","else",149],["T_WHITESPACE"," ",149],["T_IF","if",149],["T_WHITESPACE"," ",149],"(",["T_WHITESPACE"," ",149],["T_STRING","sizeof",149],"(",["T_VARIABLE","$uRoles",149],")",["T_WHITESPACE"," ",149],">",["T_WHITESPACE"," ",149],["T_LNUMBER","1",149],["T_WHITESPACE"," ",149],")",["T_WHITESPACE"," ",149],"{",["T_WHITESPACE","\n                        ",149],["T_COMMENT","\/\/@FIXME: stupid fix of previous multi-roles logic.\n",150],["T_WHITESPACE","                        ",151],["T_COMMENT","\/\/@TODO:  make proper DB upgrade in the future revisions.\n",151],["T_WHITESPACE","                        ",152],["T_VARIABLE","$rs",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_ARRAY","array",152],"(",")",";",["T_WHITESPACE","\n                        ",152],["T_VARIABLE","$rs",153],"[",["T_LNUMBER","0",153],"]",["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_VARIABLE","$uRoles",153],"[",["T_LNUMBER","0",153],"]",";",["T_WHITESPACE","\n                        ",153],["T_VARIABLE","$model",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","setRoleIds",154],"(",["T_WHITESPACE"," ",154],["T_VARIABLE","$rs",154],["T_WHITESPACE"," ",154],")",["T_OBJECT_OPERATOR","->",154],["T_STRING","setRoleUserId",154],"(",["T_WHITESPACE"," ",154],["T_VARIABLE","$model",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","getUserId",154],"(",")",["T_WHITESPACE"," ",154],")",["T_OBJECT_OPERATOR","->",154],["T_STRING","saveRelations",154],"(",")",";",["T_WHITESPACE","\n                    ",154],"}",["T_WHITESPACE","\n                ",155],"}",["T_WHITESPACE","\n                ",156],["T_STRING","Mage",157],["T_DOUBLE_COLON","::",157],["T_STRING","getSingleton",157],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",157],")",["T_OBJECT_OPERATOR","->",157],["T_STRING","addSuccess",157],"(",["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","__",157],"(",["T_CONSTANT_ENCAPSED_STRING","'The user has been saved.'",157],")",")",";",["T_WHITESPACE","\n                ",157],["T_STRING","Mage",158],["T_DOUBLE_COLON","::",158],["T_STRING","getSingleton",158],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",158],")",["T_OBJECT_OPERATOR","->",158],["T_STRING","setUserData",158],"(",["T_STRING","false",158],")",";",["T_WHITESPACE","\n                ",158],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","_redirect",159],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/'",159],")",";",["T_WHITESPACE","\n                ",159],["T_RETURN","return",160],";",["T_WHITESPACE","\n            ",160],"}",["T_WHITESPACE"," ",161],["T_CATCH","catch",161],["T_WHITESPACE"," ",161],"(",["T_STRING","Mage_Core_Exception",161],["T_WHITESPACE"," ",161],["T_VARIABLE","$e",161],")",["T_WHITESPACE"," ",161],"{",["T_WHITESPACE","\n                ",161],["T_STRING","Mage",162],["T_DOUBLE_COLON","::",162],["T_STRING","getSingleton",162],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",162],")",["T_OBJECT_OPERATOR","->",162],["T_STRING","addError",162],"(",["T_VARIABLE","$e",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","getMessage",162],"(",")",")",";",["T_WHITESPACE","\n                ",162],["T_STRING","Mage",163],["T_DOUBLE_COLON","::",163],["T_STRING","getSingleton",163],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",163],")",["T_OBJECT_OPERATOR","->",163],["T_STRING","setUserData",163],"(",["T_VARIABLE","$data",163],")",";",["T_WHITESPACE","\n                ",163],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","_redirect",164],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/edit'",164],",",["T_WHITESPACE"," ",164],["T_ARRAY","array",164],"(",["T_CONSTANT_ENCAPSED_STRING","'user_id'",164],["T_WHITESPACE"," ",164],["T_DOUBLE_ARROW","=>",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$model",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","getUserId",164],"(",")",")",")",";",["T_WHITESPACE","\n                ",164],["T_RETURN","return",165],";",["T_WHITESPACE","\n            ",165],"}",["T_WHITESPACE","\n        ",166],"}",["T_WHITESPACE","\n        ",167],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","_redirect",168],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/'",168],")",";",["T_WHITESPACE","\n    ",168],"}",["T_WHITESPACE","\n\n    ",169],["T_PUBLIC","public",171],["T_WHITESPACE"," ",171],["T_FUNCTION","function",171],["T_WHITESPACE"," ",171],["T_STRING","deleteAction",171],"(",")",["T_WHITESPACE","\n    ",171],"{",["T_WHITESPACE","\n        ",172],["T_VARIABLE","$currentUser",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_STRING","Mage",173],["T_DOUBLE_COLON","::",173],["T_STRING","getSingleton",173],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/session'",173],")",["T_OBJECT_OPERATOR","->",173],["T_STRING","getUser",173],"(",")",";",["T_WHITESPACE","\n\n        ",173],["T_IF","if",175],["T_WHITESPACE"," ",175],"(",["T_VARIABLE","$id",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","getRequest",175],"(",")",["T_OBJECT_OPERATOR","->",175],["T_STRING","getParam",175],"(",["T_CONSTANT_ENCAPSED_STRING","'user_id'",175],")",")",["T_WHITESPACE"," ",175],"{",["T_WHITESPACE","\n            ",175],["T_IF","if",176],["T_WHITESPACE"," ",176],"(",["T_WHITESPACE"," ",176],["T_VARIABLE","$currentUser",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","getId",176],"(",")",["T_WHITESPACE"," ",176],["T_IS_EQUAL","==",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$id",176],["T_WHITESPACE"," ",176],")",["T_WHITESPACE"," ",176],"{",["T_WHITESPACE","\n                ",176],["T_STRING","Mage",177],["T_DOUBLE_COLON","::",177],["T_STRING","getSingleton",177],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",177],")",["T_OBJECT_OPERATOR","->",177],["T_STRING","addError",177],"(",["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","__",177],"(",["T_CONSTANT_ENCAPSED_STRING","'You cannot delete your own account.'",177],")",")",";",["T_WHITESPACE","\n                ",177],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","_redirect",178],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/edit'",178],",",["T_WHITESPACE"," ",178],["T_ARRAY","array",178],"(",["T_CONSTANT_ENCAPSED_STRING","'user_id'",178],["T_WHITESPACE"," ",178],["T_DOUBLE_ARROW","=>",178],["T_WHITESPACE"," ",178],["T_VARIABLE","$id",178],")",")",";",["T_WHITESPACE","\n                ",178],["T_RETURN","return",179],";",["T_WHITESPACE","\n            ",179],"}",["T_WHITESPACE","\n            ",180],["T_TRY","try",181],["T_WHITESPACE"," ",181],"{",["T_WHITESPACE","\n                ",181],["T_VARIABLE","$model",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_STRING","Mage",182],["T_DOUBLE_COLON","::",182],["T_STRING","getModel",182],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/user'",182],")",";",["T_WHITESPACE","\n                ",182],["T_VARIABLE","$model",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","setId",183],"(",["T_VARIABLE","$id",183],")",";",["T_WHITESPACE","\n                ",183],["T_VARIABLE","$model",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","delete",184],"(",")",";",["T_WHITESPACE","\n                ",184],["T_STRING","Mage",185],["T_DOUBLE_COLON","::",185],["T_STRING","getSingleton",185],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",185],")",["T_OBJECT_OPERATOR","->",185],["T_STRING","addSuccess",185],"(",["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","__",185],"(",["T_CONSTANT_ENCAPSED_STRING","'The user has been deleted.'",185],")",")",";",["T_WHITESPACE","\n                ",185],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","_redirect",186],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/'",186],")",";",["T_WHITESPACE","\n                ",186],["T_RETURN","return",187],";",["T_WHITESPACE","\n            ",187],"}",["T_WHITESPACE","\n            ",188],["T_CATCH","catch",189],["T_WHITESPACE"," ",189],"(",["T_STRING","Exception",189],["T_WHITESPACE"," ",189],["T_VARIABLE","$e",189],")",["T_WHITESPACE"," ",189],"{",["T_WHITESPACE","\n                ",189],["T_STRING","Mage",190],["T_DOUBLE_COLON","::",190],["T_STRING","getSingleton",190],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",190],")",["T_OBJECT_OPERATOR","->",190],["T_STRING","addError",190],"(",["T_VARIABLE","$e",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","getMessage",190],"(",")",")",";",["T_WHITESPACE","\n                ",190],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","_redirect",191],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/edit'",191],",",["T_WHITESPACE"," ",191],["T_ARRAY","array",191],"(",["T_CONSTANT_ENCAPSED_STRING","'user_id'",191],["T_WHITESPACE"," ",191],["T_DOUBLE_ARROW","=>",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","getRequest",191],"(",")",["T_OBJECT_OPERATOR","->",191],["T_STRING","getParam",191],"(",["T_CONSTANT_ENCAPSED_STRING","'user_id'",191],")",")",")",";",["T_WHITESPACE","\n                ",191],["T_RETURN","return",192],";",["T_WHITESPACE","\n            ",192],"}",["T_WHITESPACE","\n        ",193],"}",["T_WHITESPACE","\n        ",194],["T_STRING","Mage",195],["T_DOUBLE_COLON","::",195],["T_STRING","getSingleton",195],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",195],")",["T_OBJECT_OPERATOR","->",195],["T_STRING","addError",195],"(",["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","__",195],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to find a user to delete.'",195],")",")",";",["T_WHITESPACE","\n        ",195],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","_redirect",196],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/'",196],")",";",["T_WHITESPACE","\n    ",196],"}",["T_WHITESPACE","\n\n    ",197],["T_PUBLIC","public",199],["T_WHITESPACE"," ",199],["T_FUNCTION","function",199],["T_WHITESPACE"," ",199],["T_STRING","rolesGridAction",199],"(",")",["T_WHITESPACE","\n    ",199],"{",["T_WHITESPACE","\n        ",200],["T_VARIABLE","$id",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","getRequest",201],"(",")",["T_OBJECT_OPERATOR","->",201],["T_STRING","getParam",201],"(",["T_CONSTANT_ENCAPSED_STRING","'user_id'",201],")",";",["T_WHITESPACE","\n        ",201],["T_VARIABLE","$model",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_STRING","Mage",202],["T_DOUBLE_COLON","::",202],["T_STRING","getModel",202],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/user'",202],")",";",["T_WHITESPACE","\n\n        ",202],["T_IF","if",204],["T_WHITESPACE"," ",204],"(",["T_VARIABLE","$id",204],")",["T_WHITESPACE"," ",204],"{",["T_WHITESPACE","\n            ",204],["T_VARIABLE","$model",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","load",205],"(",["T_VARIABLE","$id",205],")",";",["T_WHITESPACE","\n        ",205],"}",["T_WHITESPACE","\n\n        ",206],["T_STRING","Mage",208],["T_DOUBLE_COLON","::",208],["T_STRING","register",208],"(",["T_CONSTANT_ENCAPSED_STRING","'permissions_user'",208],",",["T_WHITESPACE"," ",208],["T_VARIABLE","$model",208],")",";",["T_WHITESPACE","\n        ",208],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","getResponse",209],"(",")",["T_OBJECT_OPERATOR","->",209],["T_STRING","setBody",209],"(",["T_WHITESPACE","\n            ",209],["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","getLayout",210],"(",")",["T_WHITESPACE","\n                ",210],["T_OBJECT_OPERATOR","->",211],["T_STRING","createBlock",211],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/permissions_user_edit_tab_roles'",211],")",["T_WHITESPACE","\n                ",211],["T_OBJECT_OPERATOR","->",212],["T_STRING","toHtml",212],"(",")",["T_WHITESPACE","\n        ",212],")",";",["T_WHITESPACE","\n    ",213],"}",["T_WHITESPACE","\n\n    ",214],["T_PUBLIC","public",216],["T_WHITESPACE"," ",216],["T_FUNCTION","function",216],["T_WHITESPACE"," ",216],["T_STRING","roleGridAction",216],"(",")",["T_WHITESPACE","\n    ",216],"{",["T_WHITESPACE","\n        ",217],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","getResponse",218],"(",")",["T_WHITESPACE","\n            ",218],["T_OBJECT_OPERATOR","->",219],["T_STRING","setBody",219],"(",["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","getLayout",219],"(",")",["T_WHITESPACE","\n            ",219],["T_OBJECT_OPERATOR","->",220],["T_STRING","createBlock",220],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/permissions_user_grid'",220],")",["T_WHITESPACE","\n            ",220],["T_OBJECT_OPERATOR","->",221],["T_STRING","toHtml",221],"(",")",["T_WHITESPACE","\n        ",221],")",";",["T_WHITESPACE","\n    ",222],"}",["T_WHITESPACE","\n\n    ",223],["T_PROTECTED","protected",225],["T_WHITESPACE"," ",225],["T_FUNCTION","function",225],["T_WHITESPACE"," ",225],["T_STRING","_isAllowed",225],"(",")",["T_WHITESPACE","\n    ",225],"{",["T_WHITESPACE","\n        ",226],["T_RETURN","return",227],["T_WHITESPACE"," ",227],["T_STRING","Mage",227],["T_DOUBLE_COLON","::",227],["T_STRING","getSingleton",227],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/session'",227],")",["T_OBJECT_OPERATOR","->",227],["T_STRING","isAllowed",227],"(",["T_CONSTANT_ENCAPSED_STRING","'system\/acl\/users'",227],")",";",["T_WHITESPACE","\n    ",227],"}",["T_WHITESPACE","\n\n",228],"}",["T_WHITESPACE","\n",230]]