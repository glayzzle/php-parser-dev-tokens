[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Adminhtml\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Catalog composite product configuration controller\n *\n * @category    Mage\n * @package     Mage_Adminhtml\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Adminhtml_Customer_Cart_Product_Composite_CartController",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Adminhtml_Controller_Action",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Customer we're working with\n     *\n     * @var Mage_Customer_Model_Customer\n     *\/",36],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$_customer",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_STRING","null",41],";",["T_WHITESPACE","\n\n    ",41],["T_DOC_COMMENT","\/**\n     * Quote we're working with\n     *\n     * @var Mage_Sales_Model_Quote\n     *\/",43],["T_WHITESPACE","\n    ",47],["T_PROTECTED","protected",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$_quote",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_STRING","null",48],";",["T_WHITESPACE","\n\n    ",48],["T_DOC_COMMENT","\/**\n     * Quote item we're working with\n     *\n     * @var Mage_Sales_Model_Quote_Item\n     *\/",50],["T_WHITESPACE","\n    ",54],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$_quoteItem",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","null",55],";",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * Loads customer, quote and quote item by request params\n     *\n     * @return Mage_Adminhtml_Customer_Cart_Product_Composite_CartController\n     *\/",57],["T_WHITESPACE","\n    ",61],["T_PROTECTED","protected",62],["T_WHITESPACE"," ",62],["T_FUNCTION","function",62],["T_WHITESPACE"," ",62],["T_STRING","_initData",62],"(",")",["T_WHITESPACE","\n    ",62],"{",["T_WHITESPACE","\n        ",63],["T_VARIABLE","$customerId",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_INT_CAST","(int)",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","getRequest",64],"(",")",["T_OBJECT_OPERATOR","->",64],["T_STRING","getParam",64],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",64],")",";",["T_WHITESPACE","\n        ",64],["T_IF","if",65],["T_WHITESPACE"," ",65],"(","!",["T_VARIABLE","$customerId",65],")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n            ",65],["T_STRING","Mage",66],["T_DOUBLE_COLON","::",66],["T_STRING","throwException",66],"(",["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","__",66],"(",["T_CONSTANT_ENCAPSED_STRING","'No customer id defined.'",66],")",")",";",["T_WHITESPACE","\n        ",66],"}",["T_WHITESPACE","\n\n        ",67],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","_customer",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_STRING","Mage",69],["T_DOUBLE_COLON","::",69],["T_STRING","getModel",69],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/customer'",69],")",["T_WHITESPACE","\n            ",69],["T_OBJECT_OPERATOR","->",70],["T_STRING","load",70],"(",["T_VARIABLE","$customerId",70],")",";",["T_WHITESPACE","\n\n        ",70],["T_VARIABLE","$quoteItemId",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_INT_CAST","(int)",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","getRequest",72],"(",")",["T_OBJECT_OPERATOR","->",72],["T_STRING","getParam",72],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",72],")",";",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$websiteId",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_INT_CAST","(int)",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","getRequest",73],"(",")",["T_OBJECT_OPERATOR","->",73],["T_STRING","getParam",73],"(",["T_CONSTANT_ENCAPSED_STRING","'website_id'",73],")",";",["T_WHITESPACE","\n\n        ",73],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","_quote",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_STRING","Mage",75],["T_DOUBLE_COLON","::",75],["T_STRING","getModel",75],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/quote'",75],")",["T_WHITESPACE","\n            ",75],["T_OBJECT_OPERATOR","->",76],["T_STRING","setWebsite",76],"(",["T_STRING","Mage",76],["T_DOUBLE_COLON","::",76],["T_STRING","app",76],"(",")",["T_OBJECT_OPERATOR","->",76],["T_STRING","getWebsite",76],"(",["T_VARIABLE","$websiteId",76],")",")",["T_WHITESPACE","\n            ",76],["T_OBJECT_OPERATOR","->",77],["T_STRING","loadByCustomer",77],"(",["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","_customer",77],")",";",["T_WHITESPACE","\n\n        ",77],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","_quoteItem",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","_quote",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","getItemById",79],"(",["T_VARIABLE","$quoteItemId",79],")",";",["T_WHITESPACE","\n        ",79],["T_IF","if",80],["T_WHITESPACE"," ",80],"(","!",["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","_quoteItem",80],")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n            ",80],["T_STRING","Mage",81],["T_DOUBLE_COLON","::",81],["T_STRING","throwException",81],"(",["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","__",81],"(",["T_CONSTANT_ENCAPSED_STRING","'Wrong quote item.'",81],")",")",";",["T_WHITESPACE","\n        ",81],"}",["T_WHITESPACE","\n\n        ",82],["T_RETURN","return",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],";",["T_WHITESPACE","\n    ",84],"}",["T_WHITESPACE","\n\n    ",85],["T_DOC_COMMENT","\/**\n     * Ajax handler to response configuration fieldset of composite product in customer's cart\n     *\n     * @return Mage_Adminhtml_Customer_Cart_Product_Composite_CartController\n     *\/",87],["T_WHITESPACE","\n    ",91],["T_PUBLIC","public",92],["T_WHITESPACE"," ",92],["T_FUNCTION","function",92],["T_WHITESPACE"," ",92],["T_STRING","configureAction",92],"(",")",["T_WHITESPACE","\n    ",92],"{",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$configureResult",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_NEW","new",94],["T_WHITESPACE"," ",94],["T_STRING","Varien_Object",94],"(",")",";",["T_WHITESPACE","\n        ",94],["T_TRY","try",95],["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n            ",95],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","_initData",96],"(",")",";",["T_WHITESPACE","\n\n            ",96],["T_VARIABLE","$quoteItem",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","_quoteItem",98],";",["T_WHITESPACE","\n\n            ",98],["T_VARIABLE","$optionCollection",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_STRING","Mage",100],["T_DOUBLE_COLON","::",100],["T_STRING","getModel",100],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/quote_item_option'",100],")",["T_WHITESPACE","\n                ",100],["T_OBJECT_OPERATOR","->",101],["T_STRING","getCollection",101],"(",")",["T_WHITESPACE","\n                ",101],["T_OBJECT_OPERATOR","->",102],["T_STRING","addItemFilter",102],"(",["T_VARIABLE","$quoteItem",102],")",";",["T_WHITESPACE","\n            ",102],["T_VARIABLE","$quoteItem",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","setOptions",103],"(",["T_VARIABLE","$optionCollection",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getOptionsByItem",103],"(",["T_VARIABLE","$quoteItem",103],")",")",";",["T_WHITESPACE","\n\n            ",103],["T_VARIABLE","$configureResult",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","setOk",105],"(",["T_STRING","true",105],")",";",["T_WHITESPACE","\n            ",105],["T_VARIABLE","$configureResult",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","setProductId",106],"(",["T_VARIABLE","$quoteItem",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","getProductId",106],"(",")",")",";",["T_WHITESPACE","\n            ",106],["T_VARIABLE","$configureResult",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","setBuyRequest",107],"(",["T_VARIABLE","$quoteItem",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","getBuyRequest",107],"(",")",")",";",["T_WHITESPACE","\n            ",107],["T_VARIABLE","$configureResult",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","setCurrentStoreId",108],"(",["T_VARIABLE","$quoteItem",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getStoreId",108],"(",")",")",";",["T_WHITESPACE","\n            ",108],["T_VARIABLE","$configureResult",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","setCurrentCustomer",109],"(",["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","_customer",109],")",";",["T_WHITESPACE","\n        ",109],"}",["T_WHITESPACE"," ",110],["T_CATCH","catch",110],["T_WHITESPACE"," ",110],"(",["T_STRING","Exception",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$e",110],")",["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n            ",110],["T_VARIABLE","$configureResult",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","setError",111],"(",["T_STRING","true",111],")",";",["T_WHITESPACE","\n            ",111],["T_VARIABLE","$configureResult",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","setMessage",112],"(",["T_VARIABLE","$e",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","getMessage",112],"(",")",")",";",["T_WHITESPACE","\n        ",112],"}",["T_WHITESPACE","\n\n        ",113],["T_COMMENT","\/* @var $helper Mage_Adminhtml_Helper_Catalog_Product_Composite *\/",115],["T_WHITESPACE","\n        ",115],["T_VARIABLE","$helper",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_STRING","Mage",116],["T_DOUBLE_COLON","::",116],["T_STRING","helper",116],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/catalog_product_composite'",116],")",";",["T_WHITESPACE","\n        ",116],["T_COMMENT","\/\/ During order creation in the backend admin has ability to add any products to order\n",117],["T_WHITESPACE","        ",118],["T_STRING","Mage",118],["T_DOUBLE_COLON","::",118],["T_STRING","helper",118],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",118],")",["T_OBJECT_OPERATOR","->",118],["T_STRING","setSkipSaleableCheck",118],"(",["T_STRING","true",118],")",";",["T_WHITESPACE","\n        ",118],["T_VARIABLE","$helper",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","renderConfigureResult",119],"(",["T_VARIABLE","$this",119],",",["T_WHITESPACE"," ",119],["T_VARIABLE","$configureResult",119],")",";",["T_WHITESPACE","\n\n        ",119],["T_RETURN","return",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$this",121],";",["T_WHITESPACE","\n    ",121],"}",["T_WHITESPACE","\n\n    ",122],["T_DOC_COMMENT","\/**\n     * IFrame handler for submitted configuration for quote item\n     *\n     * @return Mage_Adminhtml_Customer_Cart_Product_Composite_CartController\n     *\/",124],["T_WHITESPACE","\n    ",128],["T_PUBLIC","public",129],["T_WHITESPACE"," ",129],["T_FUNCTION","function",129],["T_WHITESPACE"," ",129],["T_STRING","updateAction",129],"(",")",["T_WHITESPACE","\n    ",129],"{",["T_WHITESPACE","\n        ",130],["T_VARIABLE","$updateResult",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_NEW","new",131],["T_WHITESPACE"," ",131],["T_STRING","Varien_Object",131],"(",")",";",["T_WHITESPACE","\n        ",131],["T_TRY","try",132],["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n            ",132],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_initData",133],"(",")",";",["T_WHITESPACE","\n\n            ",133],["T_VARIABLE","$buyRequest",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_NEW","new",135],["T_WHITESPACE"," ",135],["T_STRING","Varien_Object",135],"(",["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getRequest",135],"(",")",["T_OBJECT_OPERATOR","->",135],["T_STRING","getParams",135],"(",")",")",";",["T_WHITESPACE","\n            ",135],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","_quote",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","updateItem",136],"(",["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","_quoteItem",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getId",136],"(",")",",",["T_WHITESPACE"," ",136],["T_VARIABLE","$buyRequest",136],")",";",["T_WHITESPACE","\n            ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","_quote",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","collectTotals",137],"(",")",["T_WHITESPACE","\n                ",137],["T_OBJECT_OPERATOR","->",138],["T_STRING","save",138],"(",")",";",["T_WHITESPACE","\n\n            ",138],["T_VARIABLE","$updateResult",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","setOk",140],"(",["T_STRING","true",140],")",";",["T_WHITESPACE","\n        ",140],"}",["T_WHITESPACE"," ",141],["T_CATCH","catch",141],["T_WHITESPACE"," ",141],"(",["T_STRING","Exception",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$e",141],")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n            ",141],["T_VARIABLE","$updateResult",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","setError",142],"(",["T_STRING","true",142],")",";",["T_WHITESPACE","\n            ",142],["T_VARIABLE","$updateResult",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","setMessage",143],"(",["T_VARIABLE","$e",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getMessage",143],"(",")",")",";",["T_WHITESPACE","\n        ",143],"}",["T_WHITESPACE","\n\n        ",144],["T_VARIABLE","$updateResult",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","setJsVarName",146],"(",["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","getRequest",146],"(",")",["T_OBJECT_OPERATOR","->",146],["T_STRING","getParam",146],"(",["T_CONSTANT_ENCAPSED_STRING","'as_js_varname'",146],")",")",";",["T_WHITESPACE","\n        ",146],["T_STRING","Mage",147],["T_DOUBLE_COLON","::",147],["T_STRING","getSingleton",147],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",147],")",["T_OBJECT_OPERATOR","->",147],["T_STRING","setCompositeProductResult",147],"(",["T_VARIABLE","$updateResult",147],")",";",["T_WHITESPACE","\n        ",147],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","_redirect",148],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/catalog_product\/showUpdateResult'",148],")",";",["T_WHITESPACE","\n\n        ",148],["T_RETURN","return",150],["T_WHITESPACE"," ",150],["T_VARIABLE","$this",150],";",["T_WHITESPACE","\n    ",150],"}",["T_WHITESPACE","\n\n    ",151],["T_DOC_COMMENT","\/**\n     * Check the permission to Manage Customers\n     *\n     * @return bool\n     *\/",153],["T_WHITESPACE","\n    ",157],["T_PROTECTED","protected",158],["T_WHITESPACE"," ",158],["T_FUNCTION","function",158],["T_WHITESPACE"," ",158],["T_STRING","_isAllowed",158],"(",")",["T_WHITESPACE","\n    ",158],"{",["T_WHITESPACE","\n        ",159],["T_RETURN","return",160],["T_WHITESPACE"," ",160],["T_STRING","Mage",160],["T_DOUBLE_COLON","::",160],["T_STRING","getSingleton",160],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/session'",160],")",["T_OBJECT_OPERATOR","->",160],["T_STRING","isAllowed",160],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/manage'",160],")",";",["T_WHITESPACE","\n    ",160],"}",["T_WHITESPACE","\n",161],"}",["T_WHITESPACE","\n",162]]