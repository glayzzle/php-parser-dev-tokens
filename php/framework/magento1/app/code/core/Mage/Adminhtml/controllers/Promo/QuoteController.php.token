[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Adminhtml\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_CLASS","class",28],["T_WHITESPACE"," ",28],["T_STRING","Mage_Adminhtml_Promo_QuoteController",28],["T_WHITESPACE"," ",28],["T_EXTENDS","extends",28],["T_WHITESPACE"," ",28],["T_STRING","Mage_Adminhtml_Controller_Action",28],["T_WHITESPACE","\n",28],"{",["T_WHITESPACE","\n    ",29],["T_PROTECTED","protected",30],["T_WHITESPACE"," ",30],["T_FUNCTION","function",30],["T_WHITESPACE"," ",30],["T_STRING","_initRule",30],"(",")",["T_WHITESPACE","\n    ",30],"{",["T_WHITESPACE","\n        ",31],["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","_title",32],"(",["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","__",32],"(",["T_CONSTANT_ENCAPSED_STRING","'Promotions'",32],")",")",["T_OBJECT_OPERATOR","->",32],["T_STRING","_title",32],"(",["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","__",32],"(",["T_CONSTANT_ENCAPSED_STRING","'Shopping Cart Price Rules'",32],")",")",";",["T_WHITESPACE","\n\n        ",32],["T_STRING","Mage",34],["T_DOUBLE_COLON","::",34],["T_STRING","register",34],"(",["T_CONSTANT_ENCAPSED_STRING","'current_promo_quote_rule'",34],",",["T_WHITESPACE"," ",34],["T_STRING","Mage",34],["T_DOUBLE_COLON","::",34],["T_STRING","getModel",34],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/rule'",34],")",")",";",["T_WHITESPACE","\n        ",34],["T_VARIABLE","$id",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_INT_CAST","(int)",35],["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","getRequest",35],"(",")",["T_OBJECT_OPERATOR","->",35],["T_STRING","getParam",35],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",35],")",";",["T_WHITESPACE","\n\n        ",35],["T_IF","if",37],["T_WHITESPACE"," ",37],"(","!",["T_VARIABLE","$id",37],["T_WHITESPACE"," ",37],["T_BOOLEAN_AND","&&",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","getRequest",37],"(",")",["T_OBJECT_OPERATOR","->",37],["T_STRING","getParam",37],"(",["T_CONSTANT_ENCAPSED_STRING","'rule_id'",37],")",")",["T_WHITESPACE"," ",37],"{",["T_WHITESPACE","\n            ",37],["T_VARIABLE","$id",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_INT_CAST","(int)",38],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","getRequest",38],"(",")",["T_OBJECT_OPERATOR","->",38],["T_STRING","getParam",38],"(",["T_CONSTANT_ENCAPSED_STRING","'rule_id'",38],")",";",["T_WHITESPACE","\n        ",38],"}",["T_WHITESPACE","\n\n        ",39],["T_IF","if",41],["T_WHITESPACE"," ",41],"(",["T_VARIABLE","$id",41],")",["T_WHITESPACE"," ",41],"{",["T_WHITESPACE","\n            ",41],["T_STRING","Mage",42],["T_DOUBLE_COLON","::",42],["T_STRING","registry",42],"(",["T_CONSTANT_ENCAPSED_STRING","'current_promo_quote_rule'",42],")",["T_OBJECT_OPERATOR","->",42],["T_STRING","load",42],"(",["T_VARIABLE","$id",42],")",";",["T_WHITESPACE","\n        ",42],"}",["T_WHITESPACE","\n    ",43],"}",["T_WHITESPACE","\n\n    ",44],["T_PROTECTED","protected",46],["T_WHITESPACE"," ",46],["T_FUNCTION","function",46],["T_WHITESPACE"," ",46],["T_STRING","_initAction",46],"(",")",["T_WHITESPACE","\n    ",46],"{",["T_WHITESPACE","\n        ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","loadLayout",48],"(",")",["T_WHITESPACE","\n            ",48],["T_OBJECT_OPERATOR","->",49],["T_STRING","_setActiveMenu",49],"(",["T_CONSTANT_ENCAPSED_STRING","'promo\/quote'",49],")",["T_WHITESPACE","\n            ",49],["T_OBJECT_OPERATOR","->",50],["T_STRING","_addBreadcrumb",50],"(",["T_STRING","Mage",50],["T_DOUBLE_COLON","::",50],["T_STRING","helper",50],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule'",50],")",["T_OBJECT_OPERATOR","->",50],["T_STRING","__",50],"(",["T_CONSTANT_ENCAPSED_STRING","'Promotions'",50],")",",",["T_WHITESPACE"," ",50],["T_STRING","Mage",50],["T_DOUBLE_COLON","::",50],["T_STRING","helper",50],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule'",50],")",["T_OBJECT_OPERATOR","->",50],["T_STRING","__",50],"(",["T_CONSTANT_ENCAPSED_STRING","'Promotions'",50],")",")",["T_WHITESPACE","\n        ",50],";",["T_WHITESPACE","\n        ",51],["T_RETURN","return",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$this",52],";",["T_WHITESPACE","\n    ",52],"}",["T_WHITESPACE","\n\n    ",53],["T_PUBLIC","public",55],["T_WHITESPACE"," ",55],["T_FUNCTION","function",55],["T_WHITESPACE"," ",55],["T_STRING","indexAction",55],"(",")",["T_WHITESPACE","\n    ",55],"{",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","_title",57],"(",["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","__",57],"(",["T_CONSTANT_ENCAPSED_STRING","'Promotions'",57],")",")",["T_OBJECT_OPERATOR","->",57],["T_STRING","_title",57],"(",["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","__",57],"(",["T_CONSTANT_ENCAPSED_STRING","'Shopping Cart Price Rules'",57],")",")",";",["T_WHITESPACE","\n\n        ",57],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","_initAction",59],"(",")",["T_WHITESPACE","\n            ",59],["T_OBJECT_OPERATOR","->",60],["T_STRING","_addBreadcrumb",60],"(",["T_STRING","Mage",60],["T_DOUBLE_COLON","::",60],["T_STRING","helper",60],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule'",60],")",["T_OBJECT_OPERATOR","->",60],["T_STRING","__",60],"(",["T_CONSTANT_ENCAPSED_STRING","'Catalog'",60],")",",",["T_WHITESPACE"," ",60],["T_STRING","Mage",60],["T_DOUBLE_COLON","::",60],["T_STRING","helper",60],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule'",60],")",["T_OBJECT_OPERATOR","->",60],["T_STRING","__",60],"(",["T_CONSTANT_ENCAPSED_STRING","'Catalog'",60],")",")",["T_WHITESPACE","\n            ",60],["T_OBJECT_OPERATOR","->",61],["T_STRING","renderLayout",61],"(",")",";",["T_WHITESPACE","\n    ",61],"}",["T_WHITESPACE","\n\n    ",62],["T_PUBLIC","public",64],["T_WHITESPACE"," ",64],["T_FUNCTION","function",64],["T_WHITESPACE"," ",64],["T_STRING","newAction",64],"(",")",["T_WHITESPACE","\n    ",64],"{",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","_forward",66],"(",["T_CONSTANT_ENCAPSED_STRING","'edit'",66],")",";",["T_WHITESPACE","\n    ",66],"}",["T_WHITESPACE","\n\n    ",67],["T_PUBLIC","public",69],["T_WHITESPACE"," ",69],["T_FUNCTION","function",69],["T_WHITESPACE"," ",69],["T_STRING","editAction",69],"(",")",["T_WHITESPACE","\n    ",69],"{",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$id",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getRequest",71],"(",")",["T_OBJECT_OPERATOR","->",71],["T_STRING","getParam",71],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",71],")",";",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$model",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_STRING","Mage",72],["T_DOUBLE_COLON","::",72],["T_STRING","getModel",72],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/rule'",72],")",";",["T_WHITESPACE","\n\n        ",72],["T_IF","if",74],["T_WHITESPACE"," ",74],"(",["T_VARIABLE","$id",74],")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n            ",74],["T_VARIABLE","$model",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","load",75],"(",["T_VARIABLE","$id",75],")",";",["T_WHITESPACE","\n            ",75],["T_IF","if",76],["T_WHITESPACE"," ",76],"(","!",["T_WHITESPACE"," ",76],["T_VARIABLE","$model",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getRuleId",76],"(",")",")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n                ",76],["T_STRING","Mage",77],["T_DOUBLE_COLON","::",77],["T_STRING","getSingleton",77],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",77],")",["T_OBJECT_OPERATOR","->",77],["T_STRING","addError",77],"(",["T_WHITESPACE","\n                    ",77],["T_STRING","Mage",78],["T_DOUBLE_COLON","::",78],["T_STRING","helper",78],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule'",78],")",["T_OBJECT_OPERATOR","->",78],["T_STRING","__",78],"(",["T_CONSTANT_ENCAPSED_STRING","'This rule no longer exists.'",78],")",")",";",["T_WHITESPACE","\n                ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","_redirect",79],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*'",79],")",";",["T_WHITESPACE","\n                ",79],["T_RETURN","return",80],";",["T_WHITESPACE","\n            ",80],"}",["T_WHITESPACE","\n        ",81],"}",["T_WHITESPACE","\n\n        ",82],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","_title",84],"(",["T_VARIABLE","$model",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getRuleId",84],"(",")",["T_WHITESPACE"," ",84],"?",["T_WHITESPACE"," ",84],["T_VARIABLE","$model",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getName",84],"(",")",["T_WHITESPACE"," ",84],":",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","__",84],"(",["T_CONSTANT_ENCAPSED_STRING","'New Rule'",84],")",")",";",["T_WHITESPACE","\n\n        ",84],["T_COMMENT","\/\/ set entered data if was error when we do save\n",86],["T_WHITESPACE","        ",87],["T_VARIABLE","$data",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_STRING","Mage",87],["T_DOUBLE_COLON","::",87],["T_STRING","getSingleton",87],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",87],")",["T_OBJECT_OPERATOR","->",87],["T_STRING","getPageData",87],"(",["T_STRING","true",87],")",";",["T_WHITESPACE","\n        ",87],["T_IF","if",88],["T_WHITESPACE"," ",88],"(","!",["T_EMPTY","empty",88],"(",["T_VARIABLE","$data",88],")",")",["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n            ",88],["T_VARIABLE","$model",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","addData",89],"(",["T_VARIABLE","$data",89],")",";",["T_WHITESPACE","\n        ",89],"}",["T_WHITESPACE","\n\n        ",90],["T_VARIABLE","$model",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getConditions",92],"(",")",["T_OBJECT_OPERATOR","->",92],["T_STRING","setJsFormObject",92],"(",["T_CONSTANT_ENCAPSED_STRING","'rule_conditions_fieldset'",92],")",";",["T_WHITESPACE","\n        ",92],["T_VARIABLE","$model",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getActions",93],"(",")",["T_OBJECT_OPERATOR","->",93],["T_STRING","setJsFormObject",93],"(",["T_CONSTANT_ENCAPSED_STRING","'rule_actions_fieldset'",93],")",";",["T_WHITESPACE","\n\n        ",93],["T_STRING","Mage",95],["T_DOUBLE_COLON","::",95],["T_STRING","register",95],"(",["T_CONSTANT_ENCAPSED_STRING","'current_promo_quote_rule'",95],",",["T_WHITESPACE"," ",95],["T_VARIABLE","$model",95],")",";",["T_WHITESPACE","\n\n        ",95],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","_initAction",97],"(",")",["T_OBJECT_OPERATOR","->",97],["T_STRING","getLayout",97],"(",")",["T_OBJECT_OPERATOR","->",97],["T_STRING","getBlock",97],"(",["T_CONSTANT_ENCAPSED_STRING","'promo_quote_edit'",97],")",["T_WHITESPACE","\n             ",97],["T_OBJECT_OPERATOR","->",98],["T_STRING","setData",98],"(",["T_CONSTANT_ENCAPSED_STRING","'action'",98],",",["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getUrl",98],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/save'",98],")",")",";",["T_WHITESPACE","\n\n        ",98],["T_VARIABLE","$this",100],["T_WHITESPACE","\n            ",100],["T_OBJECT_OPERATOR","->",101],["T_STRING","_addBreadcrumb",101],"(",["T_WHITESPACE","\n                ",101],["T_VARIABLE","$id",102],["T_WHITESPACE"," ",102],"?",["T_WHITESPACE"," ",102],["T_STRING","Mage",102],["T_DOUBLE_COLON","::",102],["T_STRING","helper",102],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule'",102],")",["T_OBJECT_OPERATOR","->",102],["T_STRING","__",102],"(",["T_CONSTANT_ENCAPSED_STRING","'Edit Rule'",102],")",["T_WHITESPACE","\n                    ",102],":",["T_WHITESPACE"," ",103],["T_STRING","Mage",103],["T_DOUBLE_COLON","::",103],["T_STRING","helper",103],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule'",103],")",["T_OBJECT_OPERATOR","->",103],["T_STRING","__",103],"(",["T_CONSTANT_ENCAPSED_STRING","'New Rule'",103],")",",",["T_WHITESPACE","\n                ",103],["T_VARIABLE","$id",104],["T_WHITESPACE"," ",104],"?",["T_WHITESPACE"," ",104],["T_STRING","Mage",104],["T_DOUBLE_COLON","::",104],["T_STRING","helper",104],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule'",104],")",["T_OBJECT_OPERATOR","->",104],["T_STRING","__",104],"(",["T_CONSTANT_ENCAPSED_STRING","'Edit Rule'",104],")",["T_WHITESPACE","\n                    ",104],":",["T_WHITESPACE"," ",105],["T_STRING","Mage",105],["T_DOUBLE_COLON","::",105],["T_STRING","helper",105],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule'",105],")",["T_OBJECT_OPERATOR","->",105],["T_STRING","__",105],"(",["T_CONSTANT_ENCAPSED_STRING","'New Rule'",105],")",")",["T_WHITESPACE","\n            ",105],["T_OBJECT_OPERATOR","->",106],["T_STRING","renderLayout",106],"(",")",";",["T_WHITESPACE","\n\n    ",106],"}",["T_WHITESPACE","\n\n    ",108],["T_DOC_COMMENT","\/**\n     * Promo quote save action\n     *\n     *\/",110],["T_WHITESPACE","\n    ",113],["T_PUBLIC","public",114],["T_WHITESPACE"," ",114],["T_FUNCTION","function",114],["T_WHITESPACE"," ",114],["T_STRING","saveAction",114],"(",")",["T_WHITESPACE","\n    ",114],"{",["T_WHITESPACE","\n        ",115],["T_IF","if",116],["T_WHITESPACE"," ",116],"(",["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getRequest",116],"(",")",["T_OBJECT_OPERATOR","->",116],["T_STRING","getPost",116],"(",")",")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n            ",116],["T_TRY","try",117],["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n                ",117],["T_DOC_COMMENT","\/** @var $model Mage_SalesRule_Model_Rule *\/",118],["T_WHITESPACE","\n                ",118],["T_VARIABLE","$model",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_STRING","Mage",119],["T_DOUBLE_COLON","::",119],["T_STRING","getModel",119],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/rule'",119],")",";",["T_WHITESPACE","\n                ",119],["T_STRING","Mage",120],["T_DOUBLE_COLON","::",120],["T_STRING","dispatchEvent",120],"(",["T_WHITESPACE","\n                    ",120],["T_CONSTANT_ENCAPSED_STRING","'adminhtml_controller_salesrule_prepare_save'",121],",",["T_WHITESPACE","\n                    ",121],["T_ARRAY","array",122],"(",["T_CONSTANT_ENCAPSED_STRING","'request'",122],["T_WHITESPACE"," ",122],["T_DOUBLE_ARROW","=>",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","getRequest",122],"(",")",")",")",";",["T_WHITESPACE","\n                ",122],["T_VARIABLE","$data",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getRequest",123],"(",")",["T_OBJECT_OPERATOR","->",123],["T_STRING","getPost",123],"(",")",";",["T_WHITESPACE","\n                ",123],["T_VARIABLE","$data",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","_filterDates",124],"(",["T_VARIABLE","$data",124],",",["T_WHITESPACE"," ",124],["T_ARRAY","array",124],"(",["T_CONSTANT_ENCAPSED_STRING","'from_date'",124],",",["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","'to_date'",124],")",")",";",["T_WHITESPACE","\n                ",124],["T_VARIABLE","$id",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","getRequest",125],"(",")",["T_OBJECT_OPERATOR","->",125],["T_STRING","getParam",125],"(",["T_CONSTANT_ENCAPSED_STRING","'rule_id'",125],")",";",["T_WHITESPACE","\n                ",125],["T_IF","if",126],["T_WHITESPACE"," ",126],"(",["T_VARIABLE","$id",126],")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n                    ",126],["T_VARIABLE","$model",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","load",127],"(",["T_VARIABLE","$id",127],")",";",["T_WHITESPACE","\n                    ",127],["T_IF","if",128],["T_WHITESPACE"," ",128],"(",["T_VARIABLE","$id",128],["T_WHITESPACE"," ",128],["T_IS_NOT_EQUAL","!=",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$model",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","getId",128],"(",")",")",["T_WHITESPACE"," ",128],"{",["T_WHITESPACE","\n                        ",128],["T_STRING","Mage",129],["T_DOUBLE_COLON","::",129],["T_STRING","throwException",129],"(",["T_STRING","Mage",129],["T_DOUBLE_COLON","::",129],["T_STRING","helper",129],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule'",129],")",["T_OBJECT_OPERATOR","->",129],["T_STRING","__",129],"(",["T_CONSTANT_ENCAPSED_STRING","'Wrong rule specified.'",129],")",")",";",["T_WHITESPACE","\n                    ",129],"}",["T_WHITESPACE","\n                ",130],"}",["T_WHITESPACE","\n\n                ",131],["T_VARIABLE","$session",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_STRING","Mage",133],["T_DOUBLE_COLON","::",133],["T_STRING","getSingleton",133],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",133],")",";",["T_WHITESPACE","\n\n                ",133],["T_VARIABLE","$validateResult",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_VARIABLE","$model",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","validateData",135],"(",["T_NEW","new",135],["T_WHITESPACE"," ",135],["T_STRING","Varien_Object",135],"(",["T_VARIABLE","$data",135],")",")",";",["T_WHITESPACE","\n                ",135],["T_IF","if",136],["T_WHITESPACE"," ",136],"(",["T_VARIABLE","$validateResult",136],["T_WHITESPACE"," ",136],["T_IS_NOT_IDENTICAL","!==",136],["T_WHITESPACE"," ",136],["T_STRING","true",136],")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n                    ",136],["T_FOREACH","foreach",137],"(",["T_VARIABLE","$validateResult",137],["T_WHITESPACE"," ",137],["T_AS","as",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$errorMessage",137],")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n                        ",137],["T_VARIABLE","$session",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","addError",138],"(",["T_VARIABLE","$errorMessage",138],")",";",["T_WHITESPACE","\n                    ",138],"}",["T_WHITESPACE","\n                    ",139],["T_VARIABLE","$session",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","setPageData",140],"(",["T_VARIABLE","$data",140],")",";",["T_WHITESPACE","\n                    ",140],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","_redirect",141],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/edit'",141],",",["T_WHITESPACE"," ",141],["T_ARRAY","array",141],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",141],["T_DOUBLE_ARROW","=>",141],["T_VARIABLE","$model",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getId",141],"(",")",")",")",";",["T_WHITESPACE","\n                    ",141],["T_RETURN","return",142],";",["T_WHITESPACE","\n                ",142],"}",["T_WHITESPACE","\n\n                ",143],["T_IF","if",145],["T_WHITESPACE"," ",145],"(",["T_ISSET","isset",145],"(",["T_VARIABLE","$data",145],"[",["T_CONSTANT_ENCAPSED_STRING","'simple_action'",145],"]",")",["T_WHITESPACE"," ",145],["T_BOOLEAN_AND","&&",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$data",145],"[",["T_CONSTANT_ENCAPSED_STRING","'simple_action'",145],"]",["T_WHITESPACE"," ",145],["T_IS_EQUAL","==",145],["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","'by_percent'",145],["T_WHITESPACE","\n                ",145],["T_BOOLEAN_AND","&&",146],["T_WHITESPACE"," ",146],["T_ISSET","isset",146],"(",["T_VARIABLE","$data",146],"[",["T_CONSTANT_ENCAPSED_STRING","'discount_amount'",146],"]",")",")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n                    ",146],["T_VARIABLE","$data",147],"[",["T_CONSTANT_ENCAPSED_STRING","'discount_amount'",147],"]",["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_STRING","min",147],"(",["T_LNUMBER","100",147],",",["T_VARIABLE","$data",147],"[",["T_CONSTANT_ENCAPSED_STRING","'discount_amount'",147],"]",")",";",["T_WHITESPACE","\n                ",147],"}",["T_WHITESPACE","\n                ",148],["T_IF","if",149],["T_WHITESPACE"," ",149],"(",["T_ISSET","isset",149],"(",["T_VARIABLE","$data",149],"[",["T_CONSTANT_ENCAPSED_STRING","'rule'",149],"]","[",["T_CONSTANT_ENCAPSED_STRING","'conditions'",149],"]",")",")",["T_WHITESPACE"," ",149],"{",["T_WHITESPACE","\n                    ",149],["T_VARIABLE","$data",150],"[",["T_CONSTANT_ENCAPSED_STRING","'conditions'",150],"]",["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_VARIABLE","$data",150],"[",["T_CONSTANT_ENCAPSED_STRING","'rule'",150],"]","[",["T_CONSTANT_ENCAPSED_STRING","'conditions'",150],"]",";",["T_WHITESPACE","\n                ",150],"}",["T_WHITESPACE","\n                ",151],["T_IF","if",152],["T_WHITESPACE"," ",152],"(",["T_ISSET","isset",152],"(",["T_VARIABLE","$data",152],"[",["T_CONSTANT_ENCAPSED_STRING","'rule'",152],"]","[",["T_CONSTANT_ENCAPSED_STRING","'actions'",152],"]",")",")",["T_WHITESPACE"," ",152],"{",["T_WHITESPACE","\n                    ",152],["T_VARIABLE","$data",153],"[",["T_CONSTANT_ENCAPSED_STRING","'actions'",153],"]",["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_VARIABLE","$data",153],"[",["T_CONSTANT_ENCAPSED_STRING","'rule'",153],"]","[",["T_CONSTANT_ENCAPSED_STRING","'actions'",153],"]",";",["T_WHITESPACE","\n                ",153],"}",["T_WHITESPACE","\n                ",154],["T_UNSET","unset",155],"(",["T_VARIABLE","$data",155],"[",["T_CONSTANT_ENCAPSED_STRING","'rule'",155],"]",")",";",["T_WHITESPACE","\n                ",155],["T_VARIABLE","$model",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","loadPost",156],"(",["T_VARIABLE","$data",156],")",";",["T_WHITESPACE","\n\n                ",156],["T_VARIABLE","$useAutoGeneration",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_INT_CAST","(int)",158],"!",["T_EMPTY","empty",158],"(",["T_VARIABLE","$data",158],"[",["T_CONSTANT_ENCAPSED_STRING","'use_auto_generation'",158],"]",")",";",["T_WHITESPACE","\n                ",158],["T_VARIABLE","$model",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","setUseAutoGeneration",159],"(",["T_VARIABLE","$useAutoGeneration",159],")",";",["T_WHITESPACE","\n\n                ",159],["T_VARIABLE","$session",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","setPageData",161],"(",["T_VARIABLE","$model",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","getData",161],"(",")",")",";",["T_WHITESPACE","\n\n                ",161],["T_VARIABLE","$model",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","save",163],"(",")",";",["T_WHITESPACE","\n                ",163],["T_VARIABLE","$session",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","addSuccess",164],"(",["T_STRING","Mage",164],["T_DOUBLE_COLON","::",164],["T_STRING","helper",164],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule'",164],")",["T_OBJECT_OPERATOR","->",164],["T_STRING","__",164],"(",["T_CONSTANT_ENCAPSED_STRING","'The rule has been saved.'",164],")",")",";",["T_WHITESPACE","\n                ",164],["T_VARIABLE","$session",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","setPageData",165],"(",["T_STRING","false",165],")",";",["T_WHITESPACE","\n                ",165],["T_IF","if",166],["T_WHITESPACE"," ",166],"(",["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","getRequest",166],"(",")",["T_OBJECT_OPERATOR","->",166],["T_STRING","getParam",166],"(",["T_CONSTANT_ENCAPSED_STRING","'back'",166],")",")",["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n                    ",166],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","_redirect",167],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/edit'",167],",",["T_WHITESPACE"," ",167],["T_ARRAY","array",167],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",167],["T_WHITESPACE"," ",167],["T_DOUBLE_ARROW","=>",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$model",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","getId",167],"(",")",")",")",";",["T_WHITESPACE","\n                    ",167],["T_RETURN","return",168],";",["T_WHITESPACE","\n                ",168],"}",["T_WHITESPACE","\n                ",169],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","_redirect",170],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/'",170],")",";",["T_WHITESPACE","\n                ",170],["T_RETURN","return",171],";",["T_WHITESPACE","\n            ",171],"}",["T_WHITESPACE"," ",172],["T_CATCH","catch",172],["T_WHITESPACE"," ",172],"(",["T_STRING","Mage_Core_Exception",172],["T_WHITESPACE"," ",172],["T_VARIABLE","$e",172],")",["T_WHITESPACE"," ",172],"{",["T_WHITESPACE","\n                ",172],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","_getSession",173],"(",")",["T_OBJECT_OPERATOR","->",173],["T_STRING","addError",173],"(",["T_VARIABLE","$e",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","getMessage",173],"(",")",")",";",["T_WHITESPACE","\n                ",173],["T_VARIABLE","$id",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_INT_CAST","(int)",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","getRequest",174],"(",")",["T_OBJECT_OPERATOR","->",174],["T_STRING","getParam",174],"(",["T_CONSTANT_ENCAPSED_STRING","'rule_id'",174],")",";",["T_WHITESPACE","\n                ",174],["T_IF","if",175],["T_WHITESPACE"," ",175],"(","!",["T_EMPTY","empty",175],"(",["T_VARIABLE","$id",175],")",")",["T_WHITESPACE"," ",175],"{",["T_WHITESPACE","\n                    ",175],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","_redirect",176],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/edit'",176],",",["T_WHITESPACE"," ",176],["T_ARRAY","array",176],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",176],["T_WHITESPACE"," ",176],["T_DOUBLE_ARROW","=>",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$id",176],")",")",";",["T_WHITESPACE","\n                ",176],"}",["T_WHITESPACE"," ",177],["T_ELSE","else",177],["T_WHITESPACE"," ",177],"{",["T_WHITESPACE","\n                    ",177],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","_redirect",178],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/new'",178],")",";",["T_WHITESPACE","\n                ",178],"}",["T_WHITESPACE","\n                ",179],["T_RETURN","return",180],";",["T_WHITESPACE","\n\n            ",180],"}",["T_WHITESPACE"," ",182],["T_CATCH","catch",182],["T_WHITESPACE"," ",182],"(",["T_STRING","Exception",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$e",182],")",["T_WHITESPACE"," ",182],"{",["T_WHITESPACE","\n                ",182],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","_getSession",183],"(",")",["T_OBJECT_OPERATOR","->",183],["T_STRING","addError",183],"(",["T_WHITESPACE","\n                    ",183],["T_STRING","Mage",184],["T_DOUBLE_COLON","::",184],["T_STRING","helper",184],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogrule'",184],")",["T_OBJECT_OPERATOR","->",184],["T_STRING","__",184],"(",["T_CONSTANT_ENCAPSED_STRING","'An error occurred while saving the rule data. Please review the log and try again.'",184],")",")",";",["T_WHITESPACE","\n                ",184],["T_STRING","Mage",185],["T_DOUBLE_COLON","::",185],["T_STRING","logException",185],"(",["T_VARIABLE","$e",185],")",";",["T_WHITESPACE","\n                ",185],["T_STRING","Mage",186],["T_DOUBLE_COLON","::",186],["T_STRING","getSingleton",186],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",186],")",["T_OBJECT_OPERATOR","->",186],["T_STRING","setPageData",186],"(",["T_VARIABLE","$data",186],")",";",["T_WHITESPACE","\n                ",186],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","_redirect",187],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/edit'",187],",",["T_WHITESPACE"," ",187],["T_ARRAY","array",187],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",187],["T_WHITESPACE"," ",187],["T_DOUBLE_ARROW","=>",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","getRequest",187],"(",")",["T_OBJECT_OPERATOR","->",187],["T_STRING","getParam",187],"(",["T_CONSTANT_ENCAPSED_STRING","'rule_id'",187],")",")",")",";",["T_WHITESPACE","\n                ",187],["T_RETURN","return",188],";",["T_WHITESPACE","\n            ",188],"}",["T_WHITESPACE","\n        ",189],"}",["T_WHITESPACE","\n        ",190],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","_redirect",191],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/'",191],")",";",["T_WHITESPACE","\n    ",191],"}",["T_WHITESPACE","\n\n    ",192],["T_PUBLIC","public",194],["T_WHITESPACE"," ",194],["T_FUNCTION","function",194],["T_WHITESPACE"," ",194],["T_STRING","deleteAction",194],"(",")",["T_WHITESPACE","\n    ",194],"{",["T_WHITESPACE","\n        ",195],["T_IF","if",196],["T_WHITESPACE"," ",196],"(",["T_VARIABLE","$id",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","getRequest",196],"(",")",["T_OBJECT_OPERATOR","->",196],["T_STRING","getParam",196],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",196],")",")",["T_WHITESPACE"," ",196],"{",["T_WHITESPACE","\n            ",196],["T_TRY","try",197],["T_WHITESPACE"," ",197],"{",["T_WHITESPACE","\n                ",197],["T_VARIABLE","$model",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_STRING","Mage",198],["T_DOUBLE_COLON","::",198],["T_STRING","getModel",198],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/rule'",198],")",";",["T_WHITESPACE","\n                ",198],["T_VARIABLE","$model",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","load",199],"(",["T_VARIABLE","$id",199],")",";",["T_WHITESPACE","\n                ",199],["T_VARIABLE","$model",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","delete",200],"(",")",";",["T_WHITESPACE","\n                ",200],["T_STRING","Mage",201],["T_DOUBLE_COLON","::",201],["T_STRING","getSingleton",201],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",201],")",["T_OBJECT_OPERATOR","->",201],["T_STRING","addSuccess",201],"(",["T_WHITESPACE","\n                    ",201],["T_STRING","Mage",202],["T_DOUBLE_COLON","::",202],["T_STRING","helper",202],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule'",202],")",["T_OBJECT_OPERATOR","->",202],["T_STRING","__",202],"(",["T_CONSTANT_ENCAPSED_STRING","'The rule has been deleted.'",202],")",")",";",["T_WHITESPACE","\n                ",202],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","_redirect",203],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/'",203],")",";",["T_WHITESPACE","\n                ",203],["T_RETURN","return",204],";",["T_WHITESPACE","\n            ",204],"}",["T_WHITESPACE"," ",205],["T_CATCH","catch",205],["T_WHITESPACE"," ",205],"(",["T_STRING","Mage_Core_Exception",205],["T_WHITESPACE"," ",205],["T_VARIABLE","$e",205],")",["T_WHITESPACE"," ",205],"{",["T_WHITESPACE","\n                ",205],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","_getSession",206],"(",")",["T_OBJECT_OPERATOR","->",206],["T_STRING","addError",206],"(",["T_VARIABLE","$e",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","getMessage",206],"(",")",")",";",["T_WHITESPACE","\n            ",206],"}",["T_WHITESPACE"," ",207],["T_CATCH","catch",207],["T_WHITESPACE"," ",207],"(",["T_STRING","Exception",207],["T_WHITESPACE"," ",207],["T_VARIABLE","$e",207],")",["T_WHITESPACE"," ",207],"{",["T_WHITESPACE","\n                ",207],["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","_getSession",208],"(",")",["T_OBJECT_OPERATOR","->",208],["T_STRING","addError",208],"(",["T_WHITESPACE","\n                    ",208],["T_STRING","Mage",209],["T_DOUBLE_COLON","::",209],["T_STRING","helper",209],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogrule'",209],")",["T_OBJECT_OPERATOR","->",209],["T_STRING","__",209],"(",["T_CONSTANT_ENCAPSED_STRING","'An error occurred while deleting the rule. Please review the log and try again.'",209],")",")",";",["T_WHITESPACE","\n                ",209],["T_STRING","Mage",210],["T_DOUBLE_COLON","::",210],["T_STRING","logException",210],"(",["T_VARIABLE","$e",210],")",";",["T_WHITESPACE","\n                ",210],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","_redirect",211],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/edit'",211],",",["T_WHITESPACE"," ",211],["T_ARRAY","array",211],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",211],["T_WHITESPACE"," ",211],["T_DOUBLE_ARROW","=>",211],["T_WHITESPACE"," ",211],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","getRequest",211],"(",")",["T_OBJECT_OPERATOR","->",211],["T_STRING","getParam",211],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",211],")",")",")",";",["T_WHITESPACE","\n                ",211],["T_RETURN","return",212],";",["T_WHITESPACE","\n            ",212],"}",["T_WHITESPACE","\n        ",213],"}",["T_WHITESPACE","\n        ",214],["T_STRING","Mage",215],["T_DOUBLE_COLON","::",215],["T_STRING","getSingleton",215],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",215],")",["T_OBJECT_OPERATOR","->",215],["T_STRING","addError",215],"(",["T_WHITESPACE","\n            ",215],["T_STRING","Mage",216],["T_DOUBLE_COLON","::",216],["T_STRING","helper",216],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule'",216],")",["T_OBJECT_OPERATOR","->",216],["T_STRING","__",216],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to find a rule to delete.'",216],")",")",";",["T_WHITESPACE","\n        ",216],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","_redirect",217],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/'",217],")",";",["T_WHITESPACE","\n    ",217],"}",["T_WHITESPACE","\n\n    ",218],["T_PUBLIC","public",220],["T_WHITESPACE"," ",220],["T_FUNCTION","function",220],["T_WHITESPACE"," ",220],["T_STRING","newConditionHtmlAction",220],"(",")",["T_WHITESPACE","\n    ",220],"{",["T_WHITESPACE","\n        ",221],["T_VARIABLE","$id",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","getRequest",222],"(",")",["T_OBJECT_OPERATOR","->",222],["T_STRING","getParam",222],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",222],")",";",["T_WHITESPACE","\n        ",222],["T_VARIABLE","$typeArr",223],["T_WHITESPACE"," ",223],"=",["T_WHITESPACE"," ",223],["T_STRING","explode",223],"(",["T_CONSTANT_ENCAPSED_STRING","'|'",223],",",["T_WHITESPACE"," ",223],["T_STRING","str_replace",223],"(",["T_CONSTANT_ENCAPSED_STRING","'-'",223],",",["T_WHITESPACE"," ",223],["T_CONSTANT_ENCAPSED_STRING","'\/'",223],",",["T_WHITESPACE"," ",223],["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","getRequest",223],"(",")",["T_OBJECT_OPERATOR","->",223],["T_STRING","getParam",223],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",223],")",")",")",";",["T_WHITESPACE","\n        ",223],["T_VARIABLE","$type",224],["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],["T_VARIABLE","$typeArr",224],"[",["T_LNUMBER","0",224],"]",";",["T_WHITESPACE","\n\n        ",224],["T_VARIABLE","$model",226],["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_STRING","Mage",226],["T_DOUBLE_COLON","::",226],["T_STRING","getModel",226],"(",["T_VARIABLE","$type",226],")",["T_WHITESPACE","\n            ",226],["T_OBJECT_OPERATOR","->",227],["T_STRING","setId",227],"(",["T_VARIABLE","$id",227],")",["T_WHITESPACE","\n            ",227],["T_OBJECT_OPERATOR","->",228],["T_STRING","setType",228],"(",["T_VARIABLE","$type",228],")",["T_WHITESPACE","\n            ",228],["T_OBJECT_OPERATOR","->",229],["T_STRING","setRule",229],"(",["T_STRING","Mage",229],["T_DOUBLE_COLON","::",229],["T_STRING","getModel",229],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/rule'",229],")",")",["T_WHITESPACE","\n            ",229],["T_OBJECT_OPERATOR","->",230],["T_STRING","setPrefix",230],"(",["T_CONSTANT_ENCAPSED_STRING","'conditions'",230],")",";",["T_WHITESPACE","\n        ",230],["T_IF","if",231],["T_WHITESPACE"," ",231],"(","!",["T_EMPTY","empty",231],"(",["T_VARIABLE","$typeArr",231],"[",["T_LNUMBER","1",231],"]",")",")",["T_WHITESPACE"," ",231],"{",["T_WHITESPACE","\n            ",231],["T_VARIABLE","$model",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","setAttribute",232],"(",["T_VARIABLE","$typeArr",232],"[",["T_LNUMBER","1",232],"]",")",";",["T_WHITESPACE","\n        ",232],"}",["T_WHITESPACE","\n\n        ",233],["T_IF","if",235],["T_WHITESPACE"," ",235],"(",["T_VARIABLE","$model",235],["T_WHITESPACE"," ",235],["T_INSTANCEOF","instanceof",235],["T_WHITESPACE"," ",235],["T_STRING","Mage_Rule_Model_Condition_Abstract",235],")",["T_WHITESPACE"," ",235],"{",["T_WHITESPACE","\n            ",235],["T_VARIABLE","$model",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","setJsFormObject",236],"(",["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","getRequest",236],"(",")",["T_OBJECT_OPERATOR","->",236],["T_STRING","getParam",236],"(",["T_CONSTANT_ENCAPSED_STRING","'form'",236],")",")",";",["T_WHITESPACE","\n            ",236],["T_VARIABLE","$html",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_VARIABLE","$model",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","asHtmlRecursive",237],"(",")",";",["T_WHITESPACE","\n        ",237],"}",["T_WHITESPACE"," ",238],["T_ELSE","else",238],["T_WHITESPACE"," ",238],"{",["T_WHITESPACE","\n            ",238],["T_VARIABLE","$html",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_CONSTANT_ENCAPSED_STRING","''",239],";",["T_WHITESPACE","\n        ",239],"}",["T_WHITESPACE","\n        ",240],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","getResponse",241],"(",")",["T_OBJECT_OPERATOR","->",241],["T_STRING","setBody",241],"(",["T_VARIABLE","$html",241],")",";",["T_WHITESPACE","\n    ",241],"}",["T_WHITESPACE","\n\n    ",242],["T_PUBLIC","public",244],["T_WHITESPACE"," ",244],["T_FUNCTION","function",244],["T_WHITESPACE"," ",244],["T_STRING","newActionHtmlAction",244],"(",")",["T_WHITESPACE","\n    ",244],"{",["T_WHITESPACE","\n        ",245],["T_VARIABLE","$id",246],["T_WHITESPACE"," ",246],"=",["T_WHITESPACE"," ",246],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","getRequest",246],"(",")",["T_OBJECT_OPERATOR","->",246],["T_STRING","getParam",246],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",246],")",";",["T_WHITESPACE","\n        ",246],["T_VARIABLE","$typeArr",247],["T_WHITESPACE"," ",247],"=",["T_WHITESPACE"," ",247],["T_STRING","explode",247],"(",["T_CONSTANT_ENCAPSED_STRING","'|'",247],",",["T_WHITESPACE"," ",247],["T_STRING","str_replace",247],"(",["T_CONSTANT_ENCAPSED_STRING","'-'",247],",",["T_WHITESPACE"," ",247],["T_CONSTANT_ENCAPSED_STRING","'\/'",247],",",["T_WHITESPACE"," ",247],["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","getRequest",247],"(",")",["T_OBJECT_OPERATOR","->",247],["T_STRING","getParam",247],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",247],")",")",")",";",["T_WHITESPACE","\n        ",247],["T_VARIABLE","$type",248],["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_VARIABLE","$typeArr",248],"[",["T_LNUMBER","0",248],"]",";",["T_WHITESPACE","\n\n        ",248],["T_VARIABLE","$model",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_STRING","Mage",250],["T_DOUBLE_COLON","::",250],["T_STRING","getModel",250],"(",["T_VARIABLE","$type",250],")",["T_WHITESPACE","\n            ",250],["T_OBJECT_OPERATOR","->",251],["T_STRING","setId",251],"(",["T_VARIABLE","$id",251],")",["T_WHITESPACE","\n            ",251],["T_OBJECT_OPERATOR","->",252],["T_STRING","setType",252],"(",["T_VARIABLE","$type",252],")",["T_WHITESPACE","\n            ",252],["T_OBJECT_OPERATOR","->",253],["T_STRING","setRule",253],"(",["T_STRING","Mage",253],["T_DOUBLE_COLON","::",253],["T_STRING","getModel",253],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/rule'",253],")",")",["T_WHITESPACE","\n            ",253],["T_OBJECT_OPERATOR","->",254],["T_STRING","setPrefix",254],"(",["T_CONSTANT_ENCAPSED_STRING","'actions'",254],")",";",["T_WHITESPACE","\n        ",254],["T_IF","if",255],["T_WHITESPACE"," ",255],"(","!",["T_EMPTY","empty",255],"(",["T_VARIABLE","$typeArr",255],"[",["T_LNUMBER","1",255],"]",")",")",["T_WHITESPACE"," ",255],"{",["T_WHITESPACE","\n            ",255],["T_VARIABLE","$model",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","setAttribute",256],"(",["T_VARIABLE","$typeArr",256],"[",["T_LNUMBER","1",256],"]",")",";",["T_WHITESPACE","\n        ",256],"}",["T_WHITESPACE","\n\n        ",257],["T_IF","if",259],["T_WHITESPACE"," ",259],"(",["T_VARIABLE","$model",259],["T_WHITESPACE"," ",259],["T_INSTANCEOF","instanceof",259],["T_WHITESPACE"," ",259],["T_STRING","Mage_Rule_Model_Condition_Abstract",259],")",["T_WHITESPACE"," ",259],"{",["T_WHITESPACE","\n            ",259],["T_VARIABLE","$model",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","setJsFormObject",260],"(",["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","getRequest",260],"(",")",["T_OBJECT_OPERATOR","->",260],["T_STRING","getParam",260],"(",["T_CONSTANT_ENCAPSED_STRING","'form'",260],")",")",";",["T_WHITESPACE","\n            ",260],["T_VARIABLE","$html",261],["T_WHITESPACE"," ",261],"=",["T_WHITESPACE"," ",261],["T_VARIABLE","$model",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","asHtmlRecursive",261],"(",")",";",["T_WHITESPACE","\n        ",261],"}",["T_WHITESPACE"," ",262],["T_ELSE","else",262],["T_WHITESPACE"," ",262],"{",["T_WHITESPACE","\n            ",262],["T_VARIABLE","$html",263],["T_WHITESPACE"," ",263],"=",["T_WHITESPACE"," ",263],["T_CONSTANT_ENCAPSED_STRING","''",263],";",["T_WHITESPACE","\n        ",263],"}",["T_WHITESPACE","\n        ",264],["T_VARIABLE","$this",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","getResponse",265],"(",")",["T_OBJECT_OPERATOR","->",265],["T_STRING","setBody",265],"(",["T_VARIABLE","$html",265],")",";",["T_WHITESPACE","\n    ",265],"}",["T_WHITESPACE","\n\n    ",266],["T_PUBLIC","public",268],["T_WHITESPACE"," ",268],["T_FUNCTION","function",268],["T_WHITESPACE"," ",268],["T_STRING","applyRulesAction",268],"(",")",["T_WHITESPACE","\n    ",268],"{",["T_WHITESPACE","\n        ",269],["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","_initAction",270],"(",")",";",["T_WHITESPACE","\n        ",270],["T_VARIABLE","$this",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","renderLayout",271],"(",")",";",["T_WHITESPACE","\n    ",271],"}",["T_WHITESPACE","\n\n    ",272],["T_PUBLIC","public",274],["T_WHITESPACE"," ",274],["T_FUNCTION","function",274],["T_WHITESPACE"," ",274],["T_STRING","gridAction",274],"(",")",["T_WHITESPACE","\n    ",274],"{",["T_WHITESPACE","\n        ",275],["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","_initRule",276],"(",")",["T_OBJECT_OPERATOR","->",276],["T_STRING","loadLayout",276],"(",")",["T_OBJECT_OPERATOR","->",276],["T_STRING","renderLayout",276],"(",")",";",["T_WHITESPACE","\n    ",276],"}",["T_WHITESPACE","\n\n    ",277],["T_DOC_COMMENT","\/**\n     * Coupon codes grid\n     *\/",279],["T_WHITESPACE","\n    ",281],["T_PUBLIC","public",282],["T_WHITESPACE"," ",282],["T_FUNCTION","function",282],["T_WHITESPACE"," ",282],["T_STRING","couponsGridAction",282],"(",")",["T_WHITESPACE","\n    ",282],"{",["T_WHITESPACE","\n        ",283],["T_VARIABLE","$this",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","_initRule",284],"(",")",";",["T_WHITESPACE","\n        ",284],["T_VARIABLE","$this",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","loadLayout",285],"(",")",["T_OBJECT_OPERATOR","->",285],["T_STRING","renderLayout",285],"(",")",";",["T_WHITESPACE","\n    ",285],"}",["T_WHITESPACE","\n\n    ",286],["T_DOC_COMMENT","\/**\n     * Export coupon codes as excel xml file\n     *\n     * @return void\n     *\/",288],["T_WHITESPACE","\n    ",292],["T_PUBLIC","public",293],["T_WHITESPACE"," ",293],["T_FUNCTION","function",293],["T_WHITESPACE"," ",293],["T_STRING","exportCouponsXmlAction",293],"(",")",["T_WHITESPACE","\n    ",293],"{",["T_WHITESPACE","\n        ",294],["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","_initRule",295],"(",")",";",["T_WHITESPACE","\n        ",295],["T_VARIABLE","$rule",296],["T_WHITESPACE"," ",296],"=",["T_WHITESPACE"," ",296],["T_STRING","Mage",296],["T_DOUBLE_COLON","::",296],["T_STRING","registry",296],"(",["T_CONSTANT_ENCAPSED_STRING","'current_promo_quote_rule'",296],")",";",["T_WHITESPACE","\n        ",296],["T_IF","if",297],["T_WHITESPACE"," ",297],"(",["T_VARIABLE","$rule",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","getId",297],"(",")",")",["T_WHITESPACE"," ",297],"{",["T_WHITESPACE","\n            ",297],["T_VARIABLE","$fileName",298],["T_WHITESPACE"," ",298],"=",["T_WHITESPACE"," ",298],["T_CONSTANT_ENCAPSED_STRING","'coupon_codes.xml'",298],";",["T_WHITESPACE","\n            ",298],["T_VARIABLE","$content",299],["T_WHITESPACE"," ",299],"=",["T_WHITESPACE"," ",299],["T_VARIABLE","$this",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","getLayout",299],"(",")",["T_WHITESPACE","\n                ",299],["T_OBJECT_OPERATOR","->",300],["T_STRING","createBlock",300],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/promo_quote_edit_tab_coupons_grid'",300],")",["T_WHITESPACE","\n                ",300],["T_OBJECT_OPERATOR","->",301],["T_STRING","getExcelFile",301],"(",["T_VARIABLE","$fileName",301],")",";",["T_WHITESPACE","\n            ",301],["T_VARIABLE","$this",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","_prepareDownloadResponse",302],"(",["T_VARIABLE","$fileName",302],",",["T_WHITESPACE"," ",302],["T_VARIABLE","$content",302],")",";",["T_WHITESPACE","\n        ",302],"}",["T_WHITESPACE"," ",303],["T_ELSE","else",303],["T_WHITESPACE"," ",303],"{",["T_WHITESPACE","\n            ",303],["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","_redirect",304],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/detail'",304],",",["T_WHITESPACE"," ",304],["T_ARRAY","array",304],"(",["T_CONSTANT_ENCAPSED_STRING","'_current'",304],["T_WHITESPACE"," ",304],["T_DOUBLE_ARROW","=>",304],["T_WHITESPACE"," ",304],["T_STRING","true",304],")",")",";",["T_WHITESPACE","\n            ",304],["T_RETURN","return",305],";",["T_WHITESPACE","\n        ",305],"}",["T_WHITESPACE","\n    ",306],"}",["T_WHITESPACE","\n\n    ",307],["T_DOC_COMMENT","\/**\n     * Export coupon codes as CSV file\n     *\n     * @return void\n     *\/",309],["T_WHITESPACE","\n    ",313],["T_PUBLIC","public",314],["T_WHITESPACE"," ",314],["T_FUNCTION","function",314],["T_WHITESPACE"," ",314],["T_STRING","exportCouponsCsvAction",314],"(",")",["T_WHITESPACE","\n    ",314],"{",["T_WHITESPACE","\n        ",315],["T_VARIABLE","$this",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","_initRule",316],"(",")",";",["T_WHITESPACE","\n        ",316],["T_VARIABLE","$rule",317],["T_WHITESPACE"," ",317],"=",["T_WHITESPACE"," ",317],["T_STRING","Mage",317],["T_DOUBLE_COLON","::",317],["T_STRING","registry",317],"(",["T_CONSTANT_ENCAPSED_STRING","'current_promo_quote_rule'",317],")",";",["T_WHITESPACE","\n        ",317],["T_IF","if",318],["T_WHITESPACE"," ",318],"(",["T_VARIABLE","$rule",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","getId",318],"(",")",")",["T_WHITESPACE"," ",318],"{",["T_WHITESPACE","\n            ",318],["T_VARIABLE","$fileName",319],["T_WHITESPACE"," ",319],"=",["T_WHITESPACE"," ",319],["T_CONSTANT_ENCAPSED_STRING","'coupon_codes.csv'",319],";",["T_WHITESPACE","\n            ",319],["T_VARIABLE","$content",320],["T_WHITESPACE"," ",320],"=",["T_WHITESPACE"," ",320],["T_VARIABLE","$this",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","getLayout",320],"(",")",["T_WHITESPACE","\n                ",320],["T_OBJECT_OPERATOR","->",321],["T_STRING","createBlock",321],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/promo_quote_edit_tab_coupons_grid'",321],")",["T_WHITESPACE","\n                ",321],["T_OBJECT_OPERATOR","->",322],["T_STRING","getCsvFile",322],"(",")",";",["T_WHITESPACE","\n            ",322],["T_VARIABLE","$this",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","_prepareDownloadResponse",323],"(",["T_VARIABLE","$fileName",323],",",["T_WHITESPACE"," ",323],["T_VARIABLE","$content",323],")",";",["T_WHITESPACE","\n        ",323],"}",["T_WHITESPACE"," ",324],["T_ELSE","else",324],["T_WHITESPACE"," ",324],"{",["T_WHITESPACE","\n            ",324],["T_VARIABLE","$this",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","_redirect",325],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/detail'",325],",",["T_WHITESPACE"," ",325],["T_ARRAY","array",325],"(",["T_CONSTANT_ENCAPSED_STRING","'_current'",325],["T_WHITESPACE"," ",325],["T_DOUBLE_ARROW","=>",325],["T_WHITESPACE"," ",325],["T_STRING","true",325],")",")",";",["T_WHITESPACE","\n            ",325],["T_RETURN","return",326],";",["T_WHITESPACE","\n        ",326],"}",["T_WHITESPACE","\n    ",327],"}",["T_WHITESPACE","\n\n    ",328],["T_DOC_COMMENT","\/**\n     * Coupons mass delete action\n     *\/",330],["T_WHITESPACE","\n    ",332],["T_PUBLIC","public",333],["T_WHITESPACE"," ",333],["T_FUNCTION","function",333],["T_WHITESPACE"," ",333],["T_STRING","couponsMassDeleteAction",333],"(",")",["T_WHITESPACE","\n    ",333],"{",["T_WHITESPACE","\n        ",334],["T_VARIABLE","$this",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","_initRule",335],"(",")",";",["T_WHITESPACE","\n        ",335],["T_VARIABLE","$rule",336],["T_WHITESPACE"," ",336],"=",["T_WHITESPACE"," ",336],["T_STRING","Mage",336],["T_DOUBLE_COLON","::",336],["T_STRING","registry",336],"(",["T_CONSTANT_ENCAPSED_STRING","'current_promo_quote_rule'",336],")",";",["T_WHITESPACE","\n\n        ",336],["T_IF","if",338],["T_WHITESPACE"," ",338],"(","!",["T_VARIABLE","$rule",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","getId",338],"(",")",")",["T_WHITESPACE"," ",338],"{",["T_WHITESPACE","\n            ",338],["T_VARIABLE","$this",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","_forward",339],"(",["T_CONSTANT_ENCAPSED_STRING","'noRoute'",339],")",";",["T_WHITESPACE","\n        ",339],"}",["T_WHITESPACE","\n\n        ",340],["T_VARIABLE","$codesIds",342],["T_WHITESPACE"," ",342],"=",["T_WHITESPACE"," ",342],["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","getRequest",342],"(",")",["T_OBJECT_OPERATOR","->",342],["T_STRING","getParam",342],"(",["T_CONSTANT_ENCAPSED_STRING","'ids'",342],")",";",["T_WHITESPACE","\n\n        ",342],["T_IF","if",344],["T_WHITESPACE"," ",344],"(",["T_STRING","is_array",344],"(",["T_VARIABLE","$codesIds",344],")",")",["T_WHITESPACE"," ",344],"{",["T_WHITESPACE","\n\n            ",344],["T_VARIABLE","$couponsCollection",346],["T_WHITESPACE"," ",346],"=",["T_WHITESPACE"," ",346],["T_STRING","Mage",346],["T_DOUBLE_COLON","::",346],["T_STRING","getResourceModel",346],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule\/coupon_collection'",346],")",["T_WHITESPACE","\n                ",346],["T_OBJECT_OPERATOR","->",347],["T_STRING","addFieldToFilter",347],"(",["T_CONSTANT_ENCAPSED_STRING","'coupon_id'",347],",",["T_WHITESPACE"," ",347],["T_ARRAY","array",347],"(",["T_CONSTANT_ENCAPSED_STRING","'in'",347],["T_WHITESPACE"," ",347],["T_DOUBLE_ARROW","=>",347],["T_WHITESPACE"," ",347],["T_VARIABLE","$codesIds",347],")",")",";",["T_WHITESPACE","\n\n            ",347],["T_FOREACH","foreach",349],["T_WHITESPACE"," ",349],"(",["T_VARIABLE","$couponsCollection",349],["T_WHITESPACE"," ",349],["T_AS","as",349],["T_WHITESPACE"," ",349],["T_VARIABLE","$coupon",349],")",["T_WHITESPACE"," ",349],"{",["T_WHITESPACE","\n                ",349],["T_VARIABLE","$coupon",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","delete",350],"(",")",";",["T_WHITESPACE","\n            ",350],"}",["T_WHITESPACE","\n        ",351],"}",["T_WHITESPACE","\n    ",352],"}",["T_WHITESPACE","\n\n    ",353],["T_DOC_COMMENT","\/**\n     * Generate Coupons action\n     *\/",355],["T_WHITESPACE","\n    ",357],["T_PUBLIC","public",358],["T_WHITESPACE"," ",358],["T_FUNCTION","function",358],["T_WHITESPACE"," ",358],["T_STRING","generateAction",358],"(",")",["T_WHITESPACE","\n    ",358],"{",["T_WHITESPACE","\n        ",359],["T_IF","if",360],["T_WHITESPACE"," ",360],"(","!",["T_VARIABLE","$this",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","getRequest",360],"(",")",["T_OBJECT_OPERATOR","->",360],["T_STRING","isAjax",360],"(",")",")",["T_WHITESPACE"," ",360],"{",["T_WHITESPACE","\n            ",360],["T_VARIABLE","$this",361],["T_OBJECT_OPERATOR","->",361],["T_STRING","_forward",361],"(",["T_CONSTANT_ENCAPSED_STRING","'noRoute'",361],")",";",["T_WHITESPACE","\n            ",361],["T_RETURN","return",362],";",["T_WHITESPACE","\n        ",362],"}",["T_WHITESPACE","\n        ",363],["T_VARIABLE","$result",364],["T_WHITESPACE"," ",364],"=",["T_WHITESPACE"," ",364],["T_ARRAY","array",364],"(",")",";",["T_WHITESPACE","\n        ",364],["T_VARIABLE","$this",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","_initRule",365],"(",")",";",["T_WHITESPACE","\n\n        ",365],["T_DOC_COMMENT","\/** @var $rule Mage_SalesRule_Model_Rule *\/",367],["T_WHITESPACE","\n        ",367],["T_VARIABLE","$rule",368],["T_WHITESPACE"," ",368],"=",["T_WHITESPACE"," ",368],["T_STRING","Mage",368],["T_DOUBLE_COLON","::",368],["T_STRING","registry",368],"(",["T_CONSTANT_ENCAPSED_STRING","'current_promo_quote_rule'",368],")",";",["T_WHITESPACE","\n\n        ",368],["T_IF","if",370],["T_WHITESPACE"," ",370],"(","!",["T_VARIABLE","$rule",370],["T_OBJECT_OPERATOR","->",370],["T_STRING","getId",370],"(",")",")",["T_WHITESPACE"," ",370],"{",["T_WHITESPACE","\n            ",370],["T_VARIABLE","$result",371],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",371],"]",["T_WHITESPACE"," ",371],"=",["T_WHITESPACE"," ",371],["T_STRING","Mage",371],["T_DOUBLE_COLON","::",371],["T_STRING","helper",371],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule'",371],")",["T_OBJECT_OPERATOR","->",371],["T_STRING","__",371],"(",["T_CONSTANT_ENCAPSED_STRING","'Rule is not defined'",371],")",";",["T_WHITESPACE","\n        ",371],"}",["T_WHITESPACE"," ",372],["T_ELSE","else",372],["T_WHITESPACE"," ",372],"{",["T_WHITESPACE","\n            ",372],["T_TRY","try",373],["T_WHITESPACE"," ",373],"{",["T_WHITESPACE","\n                ",373],["T_VARIABLE","$data",374],["T_WHITESPACE"," ",374],"=",["T_WHITESPACE"," ",374],["T_VARIABLE","$this",374],["T_OBJECT_OPERATOR","->",374],["T_STRING","getRequest",374],"(",")",["T_OBJECT_OPERATOR","->",374],["T_STRING","getParams",374],"(",")",";",["T_WHITESPACE","\n                ",374],["T_IF","if",375],["T_WHITESPACE"," ",375],"(","!",["T_EMPTY","empty",375],"(",["T_VARIABLE","$data",375],"[",["T_CONSTANT_ENCAPSED_STRING","'to_date'",375],"]",")",")",["T_WHITESPACE"," ",375],"{",["T_WHITESPACE","\n                    ",375],["T_VARIABLE","$data",376],["T_WHITESPACE"," ",376],"=",["T_WHITESPACE"," ",376],["T_STRING","array_merge",376],"(",["T_VARIABLE","$data",376],",",["T_WHITESPACE"," ",376],["T_VARIABLE","$this",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","_filterDates",376],"(",["T_VARIABLE","$data",376],",",["T_WHITESPACE"," ",376],["T_ARRAY","array",376],"(",["T_CONSTANT_ENCAPSED_STRING","'to_date'",376],")",")",")",";",["T_WHITESPACE","\n                ",376],"}",["T_WHITESPACE","\n\n                ",377],["T_DOC_COMMENT","\/** @var $generator Mage_SalesRule_Model_Coupon_Massgenerator *\/",379],["T_WHITESPACE","\n                ",379],["T_VARIABLE","$generator",380],["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],["T_VARIABLE","$rule",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","getCouponMassGenerator",380],"(",")",";",["T_WHITESPACE","\n                ",380],["T_IF","if",381],["T_WHITESPACE"," ",381],"(","!",["T_VARIABLE","$generator",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","validateData",381],"(",["T_VARIABLE","$data",381],")",")",["T_WHITESPACE"," ",381],"{",["T_WHITESPACE","\n                    ",381],["T_VARIABLE","$result",382],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",382],"]",["T_WHITESPACE"," ",382],"=",["T_WHITESPACE"," ",382],["T_STRING","Mage",382],["T_DOUBLE_COLON","::",382],["T_STRING","helper",382],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule'",382],")",["T_OBJECT_OPERATOR","->",382],["T_STRING","__",382],"(",["T_CONSTANT_ENCAPSED_STRING","'Not valid data provided'",382],")",";",["T_WHITESPACE","\n                ",382],"}",["T_WHITESPACE"," ",383],["T_ELSE","else",383],["T_WHITESPACE"," ",383],"{",["T_WHITESPACE","\n                    ",383],["T_VARIABLE","$generator",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","setData",384],"(",["T_VARIABLE","$data",384],")",";",["T_WHITESPACE","\n                    ",384],["T_VARIABLE","$generator",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","generatePool",385],"(",")",";",["T_WHITESPACE","\n                    ",385],["T_VARIABLE","$generated",386],["T_WHITESPACE"," ",386],"=",["T_WHITESPACE"," ",386],["T_VARIABLE","$generator",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","getGeneratedCount",386],"(",")",";",["T_WHITESPACE","\n                    ",386],["T_VARIABLE","$this",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","_getSession",387],"(",")",["T_OBJECT_OPERATOR","->",387],["T_STRING","addSuccess",387],"(",["T_STRING","Mage",387],["T_DOUBLE_COLON","::",387],["T_STRING","helper",387],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule'",387],")",["T_OBJECT_OPERATOR","->",387],["T_STRING","__",387],"(",["T_CONSTANT_ENCAPSED_STRING","'%s Coupon(s) have been generated'",387],",",["T_WHITESPACE"," ",387],["T_VARIABLE","$generated",387],")",")",";",["T_WHITESPACE","\n                    ",387],["T_VARIABLE","$this",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","_initLayoutMessages",388],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",388],")",";",["T_WHITESPACE","\n                    ",388],["T_VARIABLE","$result",389],"[",["T_CONSTANT_ENCAPSED_STRING","'messages'",389],"]",["T_WHITESPACE","  ",389],"=",["T_WHITESPACE"," ",389],["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","getLayout",389],"(",")",["T_OBJECT_OPERATOR","->",389],["T_STRING","getMessagesBlock",389],"(",")",["T_OBJECT_OPERATOR","->",389],["T_STRING","getGroupedHtml",389],"(",")",";",["T_WHITESPACE","\n                ",389],"}",["T_WHITESPACE","\n            ",390],"}",["T_WHITESPACE"," ",391],["T_CATCH","catch",391],["T_WHITESPACE"," ",391],"(",["T_STRING","Mage_Core_Exception",391],["T_WHITESPACE"," ",391],["T_VARIABLE","$e",391],")",["T_WHITESPACE"," ",391],"{",["T_WHITESPACE","\n                ",391],["T_VARIABLE","$result",392],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",392],"]",["T_WHITESPACE"," ",392],"=",["T_WHITESPACE"," ",392],["T_VARIABLE","$e",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","getMessage",392],"(",")",";",["T_WHITESPACE","\n            ",392],"}",["T_WHITESPACE"," ",393],["T_CATCH","catch",393],["T_WHITESPACE"," ",393],"(",["T_STRING","Exception",393],["T_WHITESPACE"," ",393],["T_VARIABLE","$e",393],")",["T_WHITESPACE"," ",393],"{",["T_WHITESPACE","\n                ",393],["T_VARIABLE","$result",394],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",394],"]",["T_WHITESPACE"," ",394],"=",["T_WHITESPACE"," ",394],["T_STRING","Mage",394],["T_DOUBLE_COLON","::",394],["T_STRING","helper",394],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule'",394],")",["T_OBJECT_OPERATOR","->",394],["T_STRING","__",394],"(",["T_CONSTANT_ENCAPSED_STRING","'An error occurred while generating coupons. Please review the log and try again.'",394],")",";",["T_WHITESPACE","\n                ",394],["T_STRING","Mage",395],["T_DOUBLE_COLON","::",395],["T_STRING","logException",395],"(",["T_VARIABLE","$e",395],")",";",["T_WHITESPACE","\n            ",395],"}",["T_WHITESPACE","\n        ",396],"}",["T_WHITESPACE","\n        ",397],["T_VARIABLE","$this",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","getResponse",398],"(",")",["T_OBJECT_OPERATOR","->",398],["T_STRING","setBody",398],"(",["T_STRING","Mage",398],["T_DOUBLE_COLON","::",398],["T_STRING","helper",398],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",398],")",["T_OBJECT_OPERATOR","->",398],["T_STRING","jsonEncode",398],"(",["T_VARIABLE","$result",398],")",")",";",["T_WHITESPACE","\n    ",398],"}",["T_WHITESPACE","\n\n    ",399],["T_DOC_COMMENT","\/**\n     * Chooser source action\n     *\/",401],["T_WHITESPACE","\n    ",403],["T_PUBLIC","public",404],["T_WHITESPACE"," ",404],["T_FUNCTION","function",404],["T_WHITESPACE"," ",404],["T_STRING","chooserAction",404],"(",")",["T_WHITESPACE","\n    ",404],"{",["T_WHITESPACE","\n        ",405],["T_VARIABLE","$uniqId",406],["T_WHITESPACE"," ",406],"=",["T_WHITESPACE"," ",406],["T_VARIABLE","$this",406],["T_OBJECT_OPERATOR","->",406],["T_STRING","getRequest",406],"(",")",["T_OBJECT_OPERATOR","->",406],["T_STRING","getParam",406],"(",["T_CONSTANT_ENCAPSED_STRING","'uniq_id'",406],")",";",["T_WHITESPACE","\n        ",406],["T_VARIABLE","$chooserBlock",407],["T_WHITESPACE"," ",407],"=",["T_WHITESPACE"," ",407],["T_VARIABLE","$this",407],["T_OBJECT_OPERATOR","->",407],["T_STRING","getLayout",407],"(",")",["T_OBJECT_OPERATOR","->",407],["T_STRING","createBlock",407],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/promo_widget_chooser'",407],",",["T_WHITESPACE"," ",407],["T_CONSTANT_ENCAPSED_STRING","''",407],",",["T_WHITESPACE"," ",407],["T_ARRAY","array",407],"(",["T_WHITESPACE","\n            ",407],["T_CONSTANT_ENCAPSED_STRING","'id'",408],["T_WHITESPACE"," ",408],["T_DOUBLE_ARROW","=>",408],["T_WHITESPACE"," ",408],["T_VARIABLE","$uniqId",408],["T_WHITESPACE","\n        ",408],")",")",";",["T_WHITESPACE","\n        ",409],["T_VARIABLE","$this",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","getResponse",410],"(",")",["T_OBJECT_OPERATOR","->",410],["T_STRING","setBody",410],"(",["T_VARIABLE","$chooserBlock",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","toHtml",410],"(",")",")",";",["T_WHITESPACE","\n    ",410],"}",["T_WHITESPACE","\n\n    ",411],["T_DOC_COMMENT","\/**\n     * Returns result of current user permission check on resource and privilege\n     * @return boolean\n     *\/",413],["T_WHITESPACE","\n    ",416],["T_PROTECTED","protected",417],["T_WHITESPACE"," ",417],["T_FUNCTION","function",417],["T_WHITESPACE"," ",417],["T_STRING","_isAllowed",417],"(",")",["T_WHITESPACE","\n    ",417],"{",["T_WHITESPACE","\n        ",418],["T_RETURN","return",419],["T_WHITESPACE"," ",419],["T_STRING","Mage",419],["T_DOUBLE_COLON","::",419],["T_STRING","getSingleton",419],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/session'",419],")",["T_OBJECT_OPERATOR","->",419],["T_STRING","isAllowed",419],"(",["T_CONSTANT_ENCAPSED_STRING","'promo\/quote'",419],")",";",["T_WHITESPACE","\n    ",419],"}",["T_WHITESPACE","\n",420],"}",["T_WHITESPACE","\n",421]]