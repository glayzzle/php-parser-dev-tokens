[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Adminhtml\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Adminhtml account controller\n *\n * @category   Mage\n * @package    Mage_Adminhtml\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n\n",33],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Adminhtml_System_AccountController",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Adminhtml_Controller_Action",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_PUBLIC","public",37],["T_WHITESPACE"," ",37],["T_FUNCTION","function",37],["T_WHITESPACE"," ",37],["T_STRING","indexAction",37],"(",")",["T_WHITESPACE","\n    ",37],"{",["T_WHITESPACE","\n        ",38],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","_title",39],"(",["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","__",39],"(",["T_CONSTANT_ENCAPSED_STRING","'System'",39],")",")",["T_OBJECT_OPERATOR","->",39],["T_STRING","_title",39],"(",["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","__",39],"(",["T_CONSTANT_ENCAPSED_STRING","'My Account'",39],")",")",";",["T_WHITESPACE","\n\n        ",39],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","loadLayout",41],"(",")",";",["T_WHITESPACE","\n        ",41],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","_setActiveMenu",42],"(",["T_CONSTANT_ENCAPSED_STRING","'system\/account'",42],")",";",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","_addContent",43],"(",["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","getLayout",43],"(",")",["T_OBJECT_OPERATOR","->",43],["T_STRING","createBlock",43],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/system_account_edit'",43],")",")",";",["T_WHITESPACE","\n        ",43],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","renderLayout",44],"(",")",";",["T_WHITESPACE","\n    ",44],"}",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * Saving edited user information\n     *\/",47],["T_WHITESPACE","\n    ",49],["T_PUBLIC","public",50],["T_WHITESPACE"," ",50],["T_FUNCTION","function",50],["T_WHITESPACE"," ",50],["T_STRING","saveAction",50],"(",")",["T_WHITESPACE","\n    ",50],"{",["T_WHITESPACE","\n        ",51],["T_VARIABLE","$userId",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_STRING","Mage",52],["T_DOUBLE_COLON","::",52],["T_STRING","getSingleton",52],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/session'",52],")",["T_OBJECT_OPERATOR","->",52],["T_STRING","getUser",52],"(",")",["T_OBJECT_OPERATOR","->",52],["T_STRING","getId",52],"(",")",";",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$pwd",53],["T_WHITESPACE","    ",53],"=",["T_WHITESPACE"," ",53],["T_STRING","null",53],";",["T_WHITESPACE","\n\n        ",53],["T_VARIABLE","$user",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","Mage",55],["T_DOUBLE_COLON","::",55],["T_STRING","getModel",55],"(",["T_CONSTANT_ENCAPSED_STRING","\"admin\/user\"",55],")",["T_OBJECT_OPERATOR","->",55],["T_STRING","load",55],"(",["T_VARIABLE","$userId",55],")",";",["T_WHITESPACE","\n\n        ",55],["T_VARIABLE","$user",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","setId",57],"(",["T_VARIABLE","$userId",57],")",["T_WHITESPACE","\n            ",57],["T_OBJECT_OPERATOR","->",58],["T_STRING","setUsername",58],"(",["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","getRequest",58],"(",")",["T_OBJECT_OPERATOR","->",58],["T_STRING","getParam",58],"(",["T_CONSTANT_ENCAPSED_STRING","'username'",58],",",["T_WHITESPACE"," ",58],["T_STRING","false",58],")",")",["T_WHITESPACE","\n            ",58],["T_OBJECT_OPERATOR","->",59],["T_STRING","setFirstname",59],"(",["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","getRequest",59],"(",")",["T_OBJECT_OPERATOR","->",59],["T_STRING","getParam",59],"(",["T_CONSTANT_ENCAPSED_STRING","'firstname'",59],",",["T_WHITESPACE"," ",59],["T_STRING","false",59],")",")",["T_WHITESPACE","\n            ",59],["T_OBJECT_OPERATOR","->",60],["T_STRING","setLastname",60],"(",["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","getRequest",60],"(",")",["T_OBJECT_OPERATOR","->",60],["T_STRING","getParam",60],"(",["T_CONSTANT_ENCAPSED_STRING","'lastname'",60],",",["T_WHITESPACE"," ",60],["T_STRING","false",60],")",")",["T_WHITESPACE","\n            ",60],["T_OBJECT_OPERATOR","->",61],["T_STRING","setEmail",61],"(",["T_STRING","strtolower",61],"(",["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","getRequest",61],"(",")",["T_OBJECT_OPERATOR","->",61],["T_STRING","getParam",61],"(",["T_CONSTANT_ENCAPSED_STRING","'email'",61],",",["T_WHITESPACE"," ",61],["T_STRING","false",61],")",")",")",";",["T_WHITESPACE","\n        ",61],["T_IF","if",62],["T_WHITESPACE"," ",62],"(",["T_WHITESPACE"," ",62],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","getRequest",62],"(",")",["T_OBJECT_OPERATOR","->",62],["T_STRING","getParam",62],"(",["T_CONSTANT_ENCAPSED_STRING","'new_password'",62],",",["T_WHITESPACE"," ",62],["T_STRING","false",62],")",["T_WHITESPACE"," ",62],")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n            ",62],["T_VARIABLE","$user",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","setNewPassword",63],"(",["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","getRequest",63],"(",")",["T_OBJECT_OPERATOR","->",63],["T_STRING","getParam",63],"(",["T_CONSTANT_ENCAPSED_STRING","'new_password'",63],",",["T_WHITESPACE"," ",63],["T_STRING","false",63],")",")",";",["T_WHITESPACE","\n        ",63],"}",["T_WHITESPACE","\n\n        ",64],["T_IF","if",66],["T_WHITESPACE"," ",66],"(",["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getRequest",66],"(",")",["T_OBJECT_OPERATOR","->",66],["T_STRING","getParam",66],"(",["T_CONSTANT_ENCAPSED_STRING","'password_confirmation'",66],",",["T_WHITESPACE"," ",66],["T_STRING","false",66],")",")",["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n            ",66],["T_VARIABLE","$user",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","setPasswordConfirmation",67],"(",["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getRequest",67],"(",")",["T_OBJECT_OPERATOR","->",67],["T_STRING","getParam",67],"(",["T_CONSTANT_ENCAPSED_STRING","'password_confirmation'",67],",",["T_WHITESPACE"," ",67],["T_STRING","false",67],")",")",";",["T_WHITESPACE","\n        ",67],"}",["T_WHITESPACE","\n\n        ",68],["T_COMMENT","\/\/Validate current admin password\n",70],["T_WHITESPACE","        ",71],["T_VARIABLE","$currentPassword",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getRequest",71],"(",")",["T_OBJECT_OPERATOR","->",71],["T_STRING","getParam",71],"(",["T_CONSTANT_ENCAPSED_STRING","'current_password'",71],",",["T_WHITESPACE"," ",71],["T_STRING","null",71],")",";",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","getRequest",72],"(",")",["T_OBJECT_OPERATOR","->",72],["T_STRING","setParam",72],"(",["T_CONSTANT_ENCAPSED_STRING","'current_password'",72],",",["T_WHITESPACE"," ",72],["T_STRING","null",72],")",";",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$result",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","_validateCurrentPassword",73],"(",["T_VARIABLE","$currentPassword",73],")",";",["T_WHITESPACE","\n\n        ",73],["T_IF","if",75],"(","!",["T_STRING","is_array",75],"(",["T_VARIABLE","$result",75],")",")","{",["T_WHITESPACE","\n            ",75],["T_VARIABLE","$result",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$user",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","validate",76],"(",")",";",["T_WHITESPACE","\n        ",76],"}",["T_WHITESPACE","\n        ",77],["T_IF","if",78],["T_WHITESPACE"," ",78],"(",["T_STRING","is_array",78],"(",["T_VARIABLE","$result",78],")",")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n            ",78],["T_FOREACH","foreach",79],"(",["T_VARIABLE","$result",79],["T_WHITESPACE"," ",79],["T_AS","as",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$error",79],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n                ",79],["T_STRING","Mage",80],["T_DOUBLE_COLON","::",80],["T_STRING","getSingleton",80],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",80],")",["T_OBJECT_OPERATOR","->",80],["T_STRING","addError",80],"(",["T_VARIABLE","$error",80],")",";",["T_WHITESPACE","\n            ",80],"}",["T_WHITESPACE","\n            ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","getResponse",82],"(",")",["T_OBJECT_OPERATOR","->",82],["T_STRING","setRedirect",82],"(",["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","getUrl",82],"(",["T_CONSTANT_ENCAPSED_STRING","\"*\/*\/\"",82],")",")",";",["T_WHITESPACE","\n            ",82],["T_RETURN","return",83],";",["T_WHITESPACE","\n        ",83],"}",["T_WHITESPACE","\n\n        ",84],["T_TRY","try",86],["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n            ",86],["T_VARIABLE","$user",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","save",87],"(",")",";",["T_WHITESPACE","\n            ",87],["T_STRING","Mage",88],["T_DOUBLE_COLON","::",88],["T_STRING","getSingleton",88],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",88],")",["T_OBJECT_OPERATOR","->",88],["T_STRING","addSuccess",88],"(",["T_STRING","Mage",88],["T_DOUBLE_COLON","::",88],["T_STRING","helper",88],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",88],")",["T_OBJECT_OPERATOR","->",88],["T_STRING","__",88],"(",["T_CONSTANT_ENCAPSED_STRING","'The account has been saved.'",88],")",")",";",["T_WHITESPACE","\n        ",88],"}",["T_WHITESPACE","\n        ",89],["T_CATCH","catch",90],["T_WHITESPACE"," ",90],"(",["T_STRING","Mage_Core_Exception",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$e",90],")",["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n            ",90],["T_STRING","Mage",91],["T_DOUBLE_COLON","::",91],["T_STRING","getSingleton",91],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",91],")",["T_OBJECT_OPERATOR","->",91],["T_STRING","addError",91],"(",["T_VARIABLE","$e",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getMessage",91],"(",")",")",";",["T_WHITESPACE","\n        ",91],"}",["T_WHITESPACE","\n        ",92],["T_CATCH","catch",93],["T_WHITESPACE"," ",93],"(",["T_STRING","Exception",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$e",93],")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n            ",93],["T_STRING","Mage",94],["T_DOUBLE_COLON","::",94],["T_STRING","getSingleton",94],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",94],")",["T_OBJECT_OPERATOR","->",94],["T_STRING","addError",94],"(",["T_STRING","Mage",94],["T_DOUBLE_COLON","::",94],["T_STRING","helper",94],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml'",94],")",["T_OBJECT_OPERATOR","->",94],["T_STRING","__",94],"(",["T_CONSTANT_ENCAPSED_STRING","'An error occurred while saving account.'",94],")",")",";",["T_WHITESPACE","\n        ",94],"}",["T_WHITESPACE","\n        ",95],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getResponse",96],"(",")",["T_OBJECT_OPERATOR","->",96],["T_STRING","setRedirect",96],"(",["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getUrl",96],"(",["T_CONSTANT_ENCAPSED_STRING","\"*\/*\/\"",96],")",")",";",["T_WHITESPACE","\n    ",96],"}",["T_WHITESPACE","\n\n    ",97],["T_PROTECTED","protected",99],["T_WHITESPACE"," ",99],["T_FUNCTION","function",99],["T_WHITESPACE"," ",99],["T_STRING","_isAllowed",99],"(",")",["T_WHITESPACE","\n    ",99],"{",["T_WHITESPACE","\n        ",100],["T_RETURN","return",101],["T_WHITESPACE"," ",101],["T_STRING","Mage",101],["T_DOUBLE_COLON","::",101],["T_STRING","getSingleton",101],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/session'",101],")",["T_OBJECT_OPERATOR","->",101],["T_STRING","isAllowed",101],"(",["T_CONSTANT_ENCAPSED_STRING","'system\/myaccount'",101],")",";",["T_WHITESPACE","\n    ",101],"}",["T_WHITESPACE","\n",102],"}",["T_WHITESPACE","\n",103]]