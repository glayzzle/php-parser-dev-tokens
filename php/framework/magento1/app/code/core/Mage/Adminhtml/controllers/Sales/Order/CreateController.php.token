[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Adminhtml\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Adminhtml sales orders creation process controller\n *\n * @category   Mage\n * @package    Mage_Adminhtml\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Adminhtml_Sales_Order_CreateController",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Adminhtml_Controller_Action",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_DOC_COMMENT","\/**\n     * Additional initialization\n     *\n     *\/",36],["T_WHITESPACE","\n    ",39],["T_PROTECTED","protected",40],["T_WHITESPACE"," ",40],["T_FUNCTION","function",40],["T_WHITESPACE"," ",40],["T_STRING","_construct",40],"(",")",["T_WHITESPACE","\n    ",40],"{",["T_WHITESPACE","\n        ",41],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","setUsedModuleName",42],"(",["T_CONSTANT_ENCAPSED_STRING","'Mage_Sales'",42],")",";",["T_WHITESPACE","\n\n        ",42],["T_COMMENT","\/\/ During order creation in the backend admin has ability to add any products to order\n",44],["T_WHITESPACE","        ",45],["T_STRING","Mage",45],["T_DOUBLE_COLON","::",45],["T_STRING","helper",45],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",45],")",["T_OBJECT_OPERATOR","->",45],["T_STRING","setSkipSaleableCheck",45],"(",["T_STRING","true",45],")",";",["T_WHITESPACE","\n    ",45],"}",["T_WHITESPACE","\n\n    ",46],["T_DOC_COMMENT","\/**\n     * Retrieve session object\n     *\n     * @return Mage_Adminhtml_Model_Session_Quote\n     *\/",48],["T_WHITESPACE","\n    ",52],["T_PROTECTED","protected",53],["T_WHITESPACE"," ",53],["T_FUNCTION","function",53],["T_WHITESPACE"," ",53],["T_STRING","_getSession",53],"(",")",["T_WHITESPACE","\n    ",53],"{",["T_WHITESPACE","\n        ",54],["T_RETURN","return",55],["T_WHITESPACE"," ",55],["T_STRING","Mage",55],["T_DOUBLE_COLON","::",55],["T_STRING","getSingleton",55],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session_quote'",55],")",";",["T_WHITESPACE","\n    ",55],"}",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * Retrieve quote object\n     *\n     * @return Mage_Sales_Model_Quote\n     *\/",58],["T_WHITESPACE","\n    ",62],["T_PROTECTED","protected",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","_getQuote",63],"(",")",["T_WHITESPACE","\n    ",63],"{",["T_WHITESPACE","\n        ",64],["T_RETURN","return",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","_getSession",65],"(",")",["T_OBJECT_OPERATOR","->",65],["T_STRING","getQuote",65],"(",")",";",["T_WHITESPACE","\n    ",65],"}",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * Retrieve order create model\n     *\n     * @return Mage_Adminhtml_Model_Sales_Order_Create\n     *\/",68],["T_WHITESPACE","\n    ",72],["T_PROTECTED","protected",73],["T_WHITESPACE"," ",73],["T_FUNCTION","function",73],["T_WHITESPACE"," ",73],["T_STRING","_getOrderCreateModel",73],"(",")",["T_WHITESPACE","\n    ",73],"{",["T_WHITESPACE","\n        ",74],["T_RETURN","return",75],["T_WHITESPACE"," ",75],["T_STRING","Mage",75],["T_DOUBLE_COLON","::",75],["T_STRING","getSingleton",75],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/sales_order_create'",75],")",";",["T_WHITESPACE","\n    ",75],"}",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * Retrieve gift message save model\n     *\n     * @return Mage_Adminhtml_Model_Giftmessage_Save\n     *\/",78],["T_WHITESPACE","\n    ",82],["T_PROTECTED","protected",83],["T_WHITESPACE"," ",83],["T_FUNCTION","function",83],["T_WHITESPACE"," ",83],["T_STRING","_getGiftmessageSaveModel",83],"(",")",["T_WHITESPACE","\n    ",83],"{",["T_WHITESPACE","\n        ",84],["T_RETURN","return",85],["T_WHITESPACE"," ",85],["T_STRING","Mage",85],["T_DOUBLE_COLON","::",85],["T_STRING","getSingleton",85],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/giftmessage_save'",85],")",";",["T_WHITESPACE","\n    ",85],"}",["T_WHITESPACE","\n\n    ",86],["T_DOC_COMMENT","\/**\n     * Initialize order creation session data\n     *\n     * @return Mage_Adminhtml_Sales_Order_CreateController\n     *\/",88],["T_WHITESPACE","\n    ",92],["T_PROTECTED","protected",93],["T_WHITESPACE"," ",93],["T_FUNCTION","function",93],["T_WHITESPACE"," ",93],["T_STRING","_initSession",93],"(",")",["T_WHITESPACE","\n    ",93],"{",["T_WHITESPACE","\n        ",94],["T_DOC_COMMENT","\/**\n         * Identify customer\n         *\/",95],["T_WHITESPACE","\n        ",97],["T_IF","if",98],["T_WHITESPACE"," ",98],"(",["T_VARIABLE","$customerId",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getRequest",98],"(",")",["T_OBJECT_OPERATOR","->",98],["T_STRING","getParam",98],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",98],")",")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n            ",98],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","_getSession",99],"(",")",["T_OBJECT_OPERATOR","->",99],["T_STRING","setCustomerId",99],"(",["T_INT_CAST","(int)",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$customerId",99],")",";",["T_WHITESPACE","\n        ",99],"}",["T_WHITESPACE","\n\n        ",100],["T_DOC_COMMENT","\/**\n         * Identify store\n         *\/",102],["T_WHITESPACE","\n        ",104],["T_IF","if",105],["T_WHITESPACE"," ",105],"(",["T_VARIABLE","$storeId",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getRequest",105],"(",")",["T_OBJECT_OPERATOR","->",105],["T_STRING","getParam",105],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id'",105],")",")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n            ",105],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","_getSession",106],"(",")",["T_OBJECT_OPERATOR","->",106],["T_STRING","setStoreId",106],"(",["T_INT_CAST","(int)",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$storeId",106],")",";",["T_WHITESPACE","\n        ",106],"}",["T_WHITESPACE","\n\n        ",107],["T_DOC_COMMENT","\/**\n         * Identify currency\n         *\/",109],["T_WHITESPACE","\n        ",111],["T_IF","if",112],["T_WHITESPACE"," ",112],"(",["T_VARIABLE","$currencyId",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","getRequest",112],"(",")",["T_OBJECT_OPERATOR","->",112],["T_STRING","getParam",112],"(",["T_CONSTANT_ENCAPSED_STRING","'currency_id'",112],")",")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n            ",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","_getSession",113],"(",")",["T_OBJECT_OPERATOR","->",113],["T_STRING","setCurrencyId",113],"(",["T_STRING_CAST","(string)",113],["T_WHITESPACE"," ",113],["T_VARIABLE","$currencyId",113],")",";",["T_WHITESPACE","\n            ",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","_getOrderCreateModel",114],"(",")",["T_OBJECT_OPERATOR","->",114],["T_STRING","setRecollect",114],"(",["T_STRING","true",114],")",";",["T_WHITESPACE","\n        ",114],"}",["T_WHITESPACE","\n\n        ",115],["T_COMMENT","\/\/Notify other modules about the session quote\n",117],["T_WHITESPACE","        ",118],["T_STRING","Mage",118],["T_DOUBLE_COLON","::",118],["T_STRING","dispatchEvent",118],"(",["T_CONSTANT_ENCAPSED_STRING","'create_order_session_quote_initialized'",118],",",["T_WHITESPACE","\n                ",118],["T_ARRAY","array",119],"(",["T_CONSTANT_ENCAPSED_STRING","'session_quote'",119],["T_WHITESPACE"," ",119],["T_DOUBLE_ARROW","=>",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_getSession",119],"(",")",")",")",";",["T_WHITESPACE","\n\n        ",119],["T_RETURN","return",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$this",121],";",["T_WHITESPACE","\n    ",121],"}",["T_WHITESPACE","\n\n    ",122],["T_DOC_COMMENT","\/**\n     * Processing request data\n     *\n     * @return Mage_Adminhtml_Sales_Order_CreateController\n     *\/",124],["T_WHITESPACE","\n    ",128],["T_PROTECTED","protected",129],["T_WHITESPACE"," ",129],["T_FUNCTION","function",129],["T_WHITESPACE"," ",129],["T_STRING","_processData",129],"(",")",["T_WHITESPACE","\n    ",129],"{",["T_WHITESPACE","\n        ",130],["T_RETURN","return",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","_processActionData",131],"(",")",";",["T_WHITESPACE","\n    ",131],"}",["T_WHITESPACE","\n\n    ",132],["T_DOC_COMMENT","\/**\n     * Process request data with additional logic for saving quote and creating order\n     *\n     * @param string $action\n     * @return Mage_Adminhtml_Sales_Order_CreateController\n     *\/",134],["T_WHITESPACE","\n    ",139],["T_PROTECTED","protected",140],["T_WHITESPACE"," ",140],["T_FUNCTION","function",140],["T_WHITESPACE"," ",140],["T_STRING","_processActionData",140],"(",["T_VARIABLE","$action",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_STRING","null",140],")",["T_WHITESPACE","\n    ",140],"{",["T_WHITESPACE","\n        ",141],["T_VARIABLE","$eventData",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_ARRAY","array",142],"(",["T_WHITESPACE","\n            ",142],["T_CONSTANT_ENCAPSED_STRING","'order_create_model'",143],["T_WHITESPACE"," ",143],["T_DOUBLE_ARROW","=>",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","_getOrderCreateModel",143],"(",")",",",["T_WHITESPACE","\n            ",143],["T_CONSTANT_ENCAPSED_STRING","'request_model'",144],["T_WHITESPACE","      ",144],["T_DOUBLE_ARROW","=>",144],["T_WHITESPACE"," ",144],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","getRequest",144],"(",")",",",["T_WHITESPACE","\n            ",144],["T_CONSTANT_ENCAPSED_STRING","'session'",145],["T_WHITESPACE","            ",145],["T_DOUBLE_ARROW","=>",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","_getSession",145],"(",")",",",["T_WHITESPACE","\n        ",145],")",";",["T_WHITESPACE","\n\n        ",146],["T_STRING","Mage",148],["T_DOUBLE_COLON","::",148],["T_STRING","dispatchEvent",148],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml_sales_order_create_process_data_before'",148],",",["T_WHITESPACE"," ",148],["T_VARIABLE","$eventData",148],")",";",["T_WHITESPACE","\n\n        ",148],["T_DOC_COMMENT","\/**\n         * Saving order data\n         *\/",150],["T_WHITESPACE","\n        ",152],["T_IF","if",153],["T_WHITESPACE"," ",153],"(",["T_VARIABLE","$data",153],["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","getRequest",153],"(",")",["T_OBJECT_OPERATOR","->",153],["T_STRING","getPost",153],"(",["T_CONSTANT_ENCAPSED_STRING","'order'",153],")",")",["T_WHITESPACE"," ",153],"{",["T_WHITESPACE","\n            ",153],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","_getOrderCreateModel",154],"(",")",["T_OBJECT_OPERATOR","->",154],["T_STRING","importPostData",154],"(",["T_VARIABLE","$data",154],")",";",["T_WHITESPACE","\n        ",154],"}",["T_WHITESPACE","\n\n        ",155],["T_DOC_COMMENT","\/**\n         * Initialize catalog rule data\n         *\/",157],["T_WHITESPACE","\n        ",159],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","_getOrderCreateModel",160],"(",")",["T_OBJECT_OPERATOR","->",160],["T_STRING","initRuleData",160],"(",")",";",["T_WHITESPACE","\n\n        ",160],["T_DOC_COMMENT","\/**\n         * init first billing address, need for virtual products\n         *\/",162],["T_WHITESPACE","\n        ",164],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","_getOrderCreateModel",165],"(",")",["T_OBJECT_OPERATOR","->",165],["T_STRING","getBillingAddress",165],"(",")",";",["T_WHITESPACE","\n\n        ",165],["T_DOC_COMMENT","\/**\n         * Flag for using billing address for shipping\n         *\/",167],["T_WHITESPACE","\n        ",169],["T_IF","if",170],["T_WHITESPACE"," ",170],"(","!",["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","_getOrderCreateModel",170],"(",")",["T_OBJECT_OPERATOR","->",170],["T_STRING","getQuote",170],"(",")",["T_OBJECT_OPERATOR","->",170],["T_STRING","isVirtual",170],"(",")",")",["T_WHITESPACE"," ",170],"{",["T_WHITESPACE","\n            ",170],["T_VARIABLE","$syncFlag",171],["T_WHITESPACE"," ",171],"=",["T_WHITESPACE"," ",171],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","getRequest",171],"(",")",["T_OBJECT_OPERATOR","->",171],["T_STRING","getPost",171],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping_as_billing'",171],")",";",["T_WHITESPACE","\n            ",171],["T_VARIABLE","$shippingMethod",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","_getOrderCreateModel",172],"(",")",["T_OBJECT_OPERATOR","->",172],["T_STRING","getShippingAddress",172],"(",")",["T_OBJECT_OPERATOR","->",172],["T_STRING","getShippingMethod",172],"(",")",";",["T_WHITESPACE","\n            ",172],["T_IF","if",173],["T_WHITESPACE"," ",173],"(",["T_STRING","is_null",173],"(",["T_VARIABLE","$syncFlag",173],")",["T_WHITESPACE","\n                ",173],["T_BOOLEAN_AND","&&",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","_getOrderCreateModel",174],"(",")",["T_OBJECT_OPERATOR","->",174],["T_STRING","getShippingAddress",174],"(",")",["T_OBJECT_OPERATOR","->",174],["T_STRING","getSameAsBilling",174],"(",")",["T_WHITESPACE","\n                ",174],["T_BOOLEAN_AND","&&",175],["T_WHITESPACE"," ",175],["T_EMPTY","empty",175],"(",["T_VARIABLE","$shippingMethod",175],")",["T_WHITESPACE","\n            ",175],")",["T_WHITESPACE"," ",176],"{",["T_WHITESPACE","\n                ",176],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","_getOrderCreateModel",177],"(",")",["T_OBJECT_OPERATOR","->",177],["T_STRING","setShippingAsBilling",177],"(",["T_LNUMBER","1",177],")",";",["T_WHITESPACE","\n            ",177],"}",["T_WHITESPACE"," ",178],["T_ELSE","else",178],["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n                ",178],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","_getOrderCreateModel",179],"(",")",["T_OBJECT_OPERATOR","->",179],["T_STRING","setShippingAsBilling",179],"(",["T_INT_CAST","(int)",179],["T_VARIABLE","$syncFlag",179],")",";",["T_WHITESPACE","\n            ",179],"}",["T_WHITESPACE","\n        ",180],"}",["T_WHITESPACE","\n\n        ",181],["T_DOC_COMMENT","\/**\n         * Change shipping address flag\n         *\/",183],["T_WHITESPACE","\n        ",185],["T_IF","if",186],["T_WHITESPACE"," ",186],"(","!",["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","_getOrderCreateModel",186],"(",")",["T_OBJECT_OPERATOR","->",186],["T_STRING","getQuote",186],"(",")",["T_OBJECT_OPERATOR","->",186],["T_STRING","isVirtual",186],"(",")",["T_WHITESPACE"," ",186],["T_BOOLEAN_AND","&&",186],["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","getRequest",186],"(",")",["T_OBJECT_OPERATOR","->",186],["T_STRING","getPost",186],"(",["T_CONSTANT_ENCAPSED_STRING","'reset_shipping'",186],")",")",["T_WHITESPACE"," ",186],"{",["T_WHITESPACE","\n            ",186],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","_getOrderCreateModel",187],"(",")",["T_OBJECT_OPERATOR","->",187],["T_STRING","resetShippingMethod",187],"(",["T_STRING","true",187],")",";",["T_WHITESPACE","\n        ",187],"}",["T_WHITESPACE","\n\n        ",188],["T_DOC_COMMENT","\/**\n         * Collecting shipping rates\n         *\/",190],["T_WHITESPACE","\n        ",192],["T_IF","if",193],["T_WHITESPACE"," ",193],"(","!",["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","_getOrderCreateModel",193],"(",")",["T_OBJECT_OPERATOR","->",193],["T_STRING","getQuote",193],"(",")",["T_OBJECT_OPERATOR","->",193],["T_STRING","isVirtual",193],"(",")",["T_WHITESPACE"," ",193],["T_BOOLEAN_AND","&&",193],["T_WHITESPACE","\n            ",193],["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","getRequest",194],"(",")",["T_OBJECT_OPERATOR","->",194],["T_STRING","getPost",194],"(",["T_CONSTANT_ENCAPSED_STRING","'collect_shipping_rates'",194],")",["T_WHITESPACE","\n        ",194],")",["T_WHITESPACE"," ",195],"{",["T_WHITESPACE","\n            ",195],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","_getOrderCreateModel",196],"(",")",["T_OBJECT_OPERATOR","->",196],["T_STRING","collectShippingRates",196],"(",")",";",["T_WHITESPACE","\n        ",196],"}",["T_WHITESPACE","\n\n\n        ",197],["T_DOC_COMMENT","\/**\n         * Apply mass changes from sidebar\n         *\/",200],["T_WHITESPACE","\n        ",202],["T_IF","if",203],["T_WHITESPACE"," ",203],"(",["T_VARIABLE","$data",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","getRequest",203],"(",")",["T_OBJECT_OPERATOR","->",203],["T_STRING","getPost",203],"(",["T_CONSTANT_ENCAPSED_STRING","'sidebar'",203],")",")",["T_WHITESPACE"," ",203],"{",["T_WHITESPACE","\n            ",203],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","_getOrderCreateModel",204],"(",")",["T_OBJECT_OPERATOR","->",204],["T_STRING","applySidebarData",204],"(",["T_VARIABLE","$data",204],")",";",["T_WHITESPACE","\n        ",204],"}",["T_WHITESPACE","\n\n        ",205],["T_DOC_COMMENT","\/**\n         * Adding product to quote from shopping cart, wishlist etc.\n         *\/",207],["T_WHITESPACE","\n        ",209],["T_IF","if",210],["T_WHITESPACE"," ",210],"(",["T_VARIABLE","$productId",210],["T_WHITESPACE"," ",210],"=",["T_WHITESPACE"," ",210],["T_INT_CAST","(int)",210],["T_WHITESPACE"," ",210],["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","getRequest",210],"(",")",["T_OBJECT_OPERATOR","->",210],["T_STRING","getPost",210],"(",["T_CONSTANT_ENCAPSED_STRING","'add_product'",210],")",")",["T_WHITESPACE"," ",210],"{",["T_WHITESPACE","\n            ",210],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","_getOrderCreateModel",211],"(",")",["T_OBJECT_OPERATOR","->",211],["T_STRING","addProduct",211],"(",["T_VARIABLE","$productId",211],",",["T_WHITESPACE"," ",211],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","getRequest",211],"(",")",["T_OBJECT_OPERATOR","->",211],["T_STRING","getPost",211],"(",")",")",";",["T_WHITESPACE","\n        ",211],"}",["T_WHITESPACE","\n\n        ",212],["T_DOC_COMMENT","\/**\n         * Adding products to quote from special grid\n         *\/",214],["T_WHITESPACE","\n        ",216],["T_IF","if",217],["T_WHITESPACE"," ",217],"(",["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","getRequest",217],"(",")",["T_OBJECT_OPERATOR","->",217],["T_STRING","has",217],"(",["T_CONSTANT_ENCAPSED_STRING","'item'",217],")",["T_WHITESPACE"," ",217],["T_BOOLEAN_AND","&&",217],["T_WHITESPACE"," ",217],"!",["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","getRequest",217],"(",")",["T_OBJECT_OPERATOR","->",217],["T_STRING","getPost",217],"(",["T_CONSTANT_ENCAPSED_STRING","'update_items'",217],")",["T_WHITESPACE"," ",217],["T_BOOLEAN_AND","&&",217],["T_WHITESPACE"," ",217],"!","(",["T_VARIABLE","$action",217],["T_WHITESPACE"," ",217],["T_IS_EQUAL","==",217],["T_WHITESPACE"," ",217],["T_CONSTANT_ENCAPSED_STRING","'save'",217],")",")",["T_WHITESPACE"," ",217],"{",["T_WHITESPACE","\n            ",217],["T_VARIABLE","$items",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","getRequest",218],"(",")",["T_OBJECT_OPERATOR","->",218],["T_STRING","getPost",218],"(",["T_CONSTANT_ENCAPSED_STRING","'item'",218],")",";",["T_WHITESPACE","\n            ",218],["T_VARIABLE","$items",219],["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","_processFiles",219],"(",["T_VARIABLE","$items",219],")",";",["T_WHITESPACE","\n            ",219],["T_VARIABLE","$this",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","_getOrderCreateModel",220],"(",")",["T_OBJECT_OPERATOR","->",220],["T_STRING","addProducts",220],"(",["T_VARIABLE","$items",220],")",";",["T_WHITESPACE","\n        ",220],"}",["T_WHITESPACE","\n\n        ",221],["T_DOC_COMMENT","\/**\n         * Update quote items\n         *\/",223],["T_WHITESPACE","\n        ",225],["T_IF","if",226],["T_WHITESPACE"," ",226],"(",["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","getRequest",226],"(",")",["T_OBJECT_OPERATOR","->",226],["T_STRING","getPost",226],"(",["T_CONSTANT_ENCAPSED_STRING","'update_items'",226],")",")",["T_WHITESPACE"," ",226],"{",["T_WHITESPACE","\n            ",226],["T_VARIABLE","$items",227],["T_WHITESPACE"," ",227],"=",["T_WHITESPACE"," ",227],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","getRequest",227],"(",")",["T_OBJECT_OPERATOR","->",227],["T_STRING","getPost",227],"(",["T_CONSTANT_ENCAPSED_STRING","'item'",227],",",["T_WHITESPACE"," ",227],["T_ARRAY","array",227],"(",")",")",";",["T_WHITESPACE","\n            ",227],["T_VARIABLE","$items",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","_processFiles",228],"(",["T_VARIABLE","$items",228],")",";",["T_WHITESPACE","\n            ",228],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","_getOrderCreateModel",229],"(",")",["T_OBJECT_OPERATOR","->",229],["T_STRING","updateQuoteItems",229],"(",["T_VARIABLE","$items",229],")",";",["T_WHITESPACE","\n        ",229],"}",["T_WHITESPACE","\n\n        ",230],["T_DOC_COMMENT","\/**\n         * Remove quote item\n         *\/",232],["T_WHITESPACE","\n        ",234],["T_VARIABLE","$removeItemId",235],["T_WHITESPACE"," ",235],"=",["T_WHITESPACE"," ",235],["T_INT_CAST","(int)",235],["T_WHITESPACE"," ",235],["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","getRequest",235],"(",")",["T_OBJECT_OPERATOR","->",235],["T_STRING","getPost",235],"(",["T_CONSTANT_ENCAPSED_STRING","'remove_item'",235],")",";",["T_WHITESPACE","\n        ",235],["T_VARIABLE","$removeFrom",236],["T_WHITESPACE"," ",236],"=",["T_WHITESPACE"," ",236],["T_STRING_CAST","(string)",236],["T_WHITESPACE"," ",236],["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","getRequest",236],"(",")",["T_OBJECT_OPERATOR","->",236],["T_STRING","getPost",236],"(",["T_CONSTANT_ENCAPSED_STRING","'from'",236],")",";",["T_WHITESPACE","\n        ",236],["T_IF","if",237],["T_WHITESPACE"," ",237],"(",["T_VARIABLE","$removeItemId",237],["T_WHITESPACE"," ",237],["T_BOOLEAN_AND","&&",237],["T_WHITESPACE"," ",237],["T_VARIABLE","$removeFrom",237],")",["T_WHITESPACE"," ",237],"{",["T_WHITESPACE","\n            ",237],["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","_getOrderCreateModel",238],"(",")",["T_OBJECT_OPERATOR","->",238],["T_STRING","removeItem",238],"(",["T_VARIABLE","$removeItemId",238],",",["T_WHITESPACE"," ",238],["T_VARIABLE","$removeFrom",238],")",";",["T_WHITESPACE","\n        ",238],"}",["T_WHITESPACE","\n\n        ",239],["T_DOC_COMMENT","\/**\n         * Move quote item\n         *\/",241],["T_WHITESPACE","\n        ",243],["T_VARIABLE","$moveItemId",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_INT_CAST","(int)",244],["T_WHITESPACE"," ",244],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","getRequest",244],"(",")",["T_OBJECT_OPERATOR","->",244],["T_STRING","getPost",244],"(",["T_CONSTANT_ENCAPSED_STRING","'move_item'",244],")",";",["T_WHITESPACE","\n        ",244],["T_VARIABLE","$moveTo",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_STRING_CAST","(string)",245],["T_WHITESPACE"," ",245],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","getRequest",245],"(",")",["T_OBJECT_OPERATOR","->",245],["T_STRING","getPost",245],"(",["T_CONSTANT_ENCAPSED_STRING","'to'",245],")",";",["T_WHITESPACE","\n        ",245],["T_IF","if",246],["T_WHITESPACE"," ",246],"(",["T_VARIABLE","$moveItemId",246],["T_WHITESPACE"," ",246],["T_BOOLEAN_AND","&&",246],["T_WHITESPACE"," ",246],["T_VARIABLE","$moveTo",246],")",["T_WHITESPACE"," ",246],"{",["T_WHITESPACE","\n            ",246],["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","_getOrderCreateModel",247],"(",")",["T_OBJECT_OPERATOR","->",247],["T_STRING","moveQuoteItem",247],"(",["T_VARIABLE","$moveItemId",247],",",["T_WHITESPACE"," ",247],["T_VARIABLE","$moveTo",247],")",";",["T_WHITESPACE","\n        ",247],"}",["T_WHITESPACE","\n\n        ",248],["T_IF","if",250],["T_WHITESPACE"," ",250],"(",["T_VARIABLE","$paymentData",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_VARIABLE","$this",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","getRequest",250],"(",")",["T_OBJECT_OPERATOR","->",250],["T_STRING","getPost",250],"(",["T_CONSTANT_ENCAPSED_STRING","'payment'",250],")",")",["T_WHITESPACE"," ",250],"{",["T_WHITESPACE","\n            ",250],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","_getOrderCreateModel",251],"(",")",["T_OBJECT_OPERATOR","->",251],["T_STRING","getQuote",251],"(",")",["T_OBJECT_OPERATOR","->",251],["T_STRING","getPayment",251],"(",")",["T_OBJECT_OPERATOR","->",251],["T_STRING","addData",251],"(",["T_VARIABLE","$paymentData",251],")",";",["T_WHITESPACE","\n        ",251],"}",["T_WHITESPACE","\n\n        ",252],["T_VARIABLE","$eventData",254],["T_WHITESPACE"," ",254],"=",["T_WHITESPACE"," ",254],["T_ARRAY","array",254],"(",["T_WHITESPACE","\n            ",254],["T_CONSTANT_ENCAPSED_STRING","'order_create_model'",255],["T_WHITESPACE"," ",255],["T_DOUBLE_ARROW","=>",255],["T_WHITESPACE"," ",255],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","_getOrderCreateModel",255],"(",")",",",["T_WHITESPACE","\n            ",255],["T_CONSTANT_ENCAPSED_STRING","'request'",256],["T_WHITESPACE","            ",256],["T_DOUBLE_ARROW","=>",256],["T_WHITESPACE"," ",256],["T_VARIABLE","$this",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","getRequest",256],"(",")",["T_OBJECT_OPERATOR","->",256],["T_STRING","getPost",256],"(",")",",",["T_WHITESPACE","\n        ",256],")",";",["T_WHITESPACE","\n\n        ",257],["T_STRING","Mage",259],["T_DOUBLE_COLON","::",259],["T_STRING","dispatchEvent",259],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml_sales_order_create_process_data'",259],",",["T_WHITESPACE"," ",259],["T_VARIABLE","$eventData",259],")",";",["T_WHITESPACE","\n\n        ",259],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","_getOrderCreateModel",261],"(",")",["T_WHITESPACE","\n            ",261],["T_OBJECT_OPERATOR","->",262],["T_STRING","saveQuote",262],"(",")",";",["T_WHITESPACE","\n\n        ",262],["T_IF","if",264],["T_WHITESPACE"," ",264],"(",["T_VARIABLE","$paymentData",264],["T_WHITESPACE"," ",264],"=",["T_WHITESPACE"," ",264],["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","getRequest",264],"(",")",["T_OBJECT_OPERATOR","->",264],["T_STRING","getPost",264],"(",["T_CONSTANT_ENCAPSED_STRING","'payment'",264],")",")",["T_WHITESPACE"," ",264],"{",["T_WHITESPACE","\n            ",264],["T_VARIABLE","$this",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","_getOrderCreateModel",265],"(",")",["T_OBJECT_OPERATOR","->",265],["T_STRING","getQuote",265],"(",")",["T_OBJECT_OPERATOR","->",265],["T_STRING","getPayment",265],"(",")",["T_OBJECT_OPERATOR","->",265],["T_STRING","addData",265],"(",["T_VARIABLE","$paymentData",265],")",";",["T_WHITESPACE","\n        ",265],"}",["T_WHITESPACE","\n\n        ",266],["T_DOC_COMMENT","\/**\n         * Saving of giftmessages\n         *\/",268],["T_WHITESPACE","\n        ",270],["T_VARIABLE","$giftmessages",271],["T_WHITESPACE"," ",271],"=",["T_WHITESPACE"," ",271],["T_VARIABLE","$this",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","getRequest",271],"(",")",["T_OBJECT_OPERATOR","->",271],["T_STRING","getPost",271],"(",["T_CONSTANT_ENCAPSED_STRING","'giftmessage'",271],")",";",["T_WHITESPACE","\n        ",271],["T_IF","if",272],["T_WHITESPACE"," ",272],"(",["T_VARIABLE","$giftmessages",272],")",["T_WHITESPACE"," ",272],"{",["T_WHITESPACE","\n            ",272],["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","_getGiftmessageSaveModel",273],"(",")",["T_OBJECT_OPERATOR","->",273],["T_STRING","setGiftmessages",273],"(",["T_VARIABLE","$giftmessages",273],")",["T_WHITESPACE","\n                ",273],["T_OBJECT_OPERATOR","->",274],["T_STRING","saveAllInQuote",274],"(",")",";",["T_WHITESPACE","\n        ",274],"}",["T_WHITESPACE","\n\n        ",275],["T_DOC_COMMENT","\/**\n         * Importing gift message allow items from specific product grid\n         *\/",277],["T_WHITESPACE","\n        ",279],["T_IF","if",280],["T_WHITESPACE"," ",280],"(",["T_VARIABLE","$data",280],["T_WHITESPACE"," ",280],"=",["T_WHITESPACE"," ",280],["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","getRequest",280],"(",")",["T_OBJECT_OPERATOR","->",280],["T_STRING","getPost",280],"(",["T_CONSTANT_ENCAPSED_STRING","'add_products'",280],")",")",["T_WHITESPACE"," ",280],"{",["T_WHITESPACE","\n            ",280],["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","_getGiftmessageSaveModel",281],"(",")",["T_WHITESPACE","\n                ",281],["T_OBJECT_OPERATOR","->",282],["T_STRING","importAllowQuoteItemsFromProducts",282],"(",["T_STRING","Mage",282],["T_DOUBLE_COLON","::",282],["T_STRING","helper",282],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",282],")",["T_OBJECT_OPERATOR","->",282],["T_STRING","jsonDecode",282],"(",["T_VARIABLE","$data",282],")",")",";",["T_WHITESPACE","\n        ",282],"}",["T_WHITESPACE","\n\n        ",283],["T_DOC_COMMENT","\/**\n         * Importing gift message allow items on update quote items\n         *\/",285],["T_WHITESPACE","\n        ",287],["T_IF","if",288],["T_WHITESPACE"," ",288],"(",["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","getRequest",288],"(",")",["T_OBJECT_OPERATOR","->",288],["T_STRING","getPost",288],"(",["T_CONSTANT_ENCAPSED_STRING","'update_items'",288],")",")",["T_WHITESPACE"," ",288],"{",["T_WHITESPACE","\n            ",288],["T_VARIABLE","$items",289],["T_WHITESPACE"," ",289],"=",["T_WHITESPACE"," ",289],["T_VARIABLE","$this",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","getRequest",289],"(",")",["T_OBJECT_OPERATOR","->",289],["T_STRING","getPost",289],"(",["T_CONSTANT_ENCAPSED_STRING","'item'",289],",",["T_WHITESPACE"," ",289],["T_ARRAY","array",289],"(",")",")",";",["T_WHITESPACE","\n            ",289],["T_VARIABLE","$this",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","_getGiftmessageSaveModel",290],"(",")",["T_OBJECT_OPERATOR","->",290],["T_STRING","importAllowQuoteItemsFromItems",290],"(",["T_VARIABLE","$items",290],")",";",["T_WHITESPACE","\n        ",290],"}",["T_WHITESPACE","\n\n        ",291],["T_VARIABLE","$data",293],["T_WHITESPACE"," ",293],"=",["T_WHITESPACE"," ",293],["T_VARIABLE","$this",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","getRequest",293],"(",")",["T_OBJECT_OPERATOR","->",293],["T_STRING","getPost",293],"(",["T_CONSTANT_ENCAPSED_STRING","'order'",293],")",";",["T_WHITESPACE","\n        ",293],["T_VARIABLE","$couponCode",294],["T_WHITESPACE"," ",294],"=",["T_WHITESPACE"," ",294],["T_CONSTANT_ENCAPSED_STRING","''",294],";",["T_WHITESPACE","\n        ",294],["T_IF","if",295],["T_WHITESPACE"," ",295],"(",["T_ISSET","isset",295],"(",["T_VARIABLE","$data",295],")",["T_WHITESPACE"," ",295],["T_BOOLEAN_AND","&&",295],["T_WHITESPACE"," ",295],["T_ISSET","isset",295],"(",["T_VARIABLE","$data",295],"[",["T_CONSTANT_ENCAPSED_STRING","'coupon'",295],"]","[",["T_CONSTANT_ENCAPSED_STRING","'code'",295],"]",")",")",["T_WHITESPACE"," ",295],"{",["T_WHITESPACE","\n            ",295],["T_VARIABLE","$couponCode",296],["T_WHITESPACE"," ",296],"=",["T_WHITESPACE"," ",296],["T_STRING","trim",296],"(",["T_VARIABLE","$data",296],"[",["T_CONSTANT_ENCAPSED_STRING","'coupon'",296],"]","[",["T_CONSTANT_ENCAPSED_STRING","'code'",296],"]",")",";",["T_WHITESPACE","\n        ",296],"}",["T_WHITESPACE","\n        ",297],["T_IF","if",298],["T_WHITESPACE"," ",298],"(","!",["T_EMPTY","empty",298],"(",["T_VARIABLE","$couponCode",298],")",")",["T_WHITESPACE"," ",298],"{",["T_WHITESPACE","\n            ",298],["T_IF","if",299],["T_WHITESPACE"," ",299],"(",["T_VARIABLE","$this",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","_getQuote",299],"(",")",["T_OBJECT_OPERATOR","->",299],["T_STRING","getCouponCode",299],"(",")",["T_WHITESPACE"," ",299],["T_IS_NOT_IDENTICAL","!==",299],["T_WHITESPACE"," ",299],["T_VARIABLE","$couponCode",299],")",["T_WHITESPACE"," ",299],"{",["T_WHITESPACE","\n                ",299],["T_VARIABLE","$this",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","_getSession",300],"(",")",["T_OBJECT_OPERATOR","->",300],["T_STRING","addError",300],"(",["T_WHITESPACE","\n                    ",300],["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","__",301],"(",["T_CONSTANT_ENCAPSED_STRING","'\"%s\" coupon code is not valid.'",301],",",["T_WHITESPACE"," ",301],["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","_getHelper",301],"(",")",["T_OBJECT_OPERATOR","->",301],["T_STRING","escapeHtml",301],"(",["T_VARIABLE","$couponCode",301],")",")",")",";",["T_WHITESPACE","\n            ",301],"}",["T_WHITESPACE"," ",302],["T_ELSE","else",302],["T_WHITESPACE"," ",302],"{",["T_WHITESPACE","\n                ",302],["T_VARIABLE","$this",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","_getSession",303],"(",")",["T_OBJECT_OPERATOR","->",303],["T_STRING","addSuccess",303],"(",["T_VARIABLE","$this",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","__",303],"(",["T_CONSTANT_ENCAPSED_STRING","'The coupon code has been accepted.'",303],")",")",";",["T_WHITESPACE","\n            ",303],"}",["T_WHITESPACE","\n        ",304],"}",["T_WHITESPACE","\n\n        ",305],["T_RETURN","return",307],["T_WHITESPACE"," ",307],["T_VARIABLE","$this",307],";",["T_WHITESPACE","\n    ",307],"}",["T_WHITESPACE","\n\n    ",308],["T_DOC_COMMENT","\/**\n     * Process buyRequest file options of items\n     *\n     * @param array $items\n     * @return array\n     *\/",310],["T_WHITESPACE","\n    ",315],["T_PROTECTED","protected",316],["T_WHITESPACE"," ",316],["T_FUNCTION","function",316],["T_WHITESPACE"," ",316],["T_STRING","_processFiles",316],"(",["T_VARIABLE","$items",316],")",["T_WHITESPACE","\n    ",316],"{",["T_WHITESPACE","\n        ",317],["T_COMMENT","\/* @var $productHelper Mage_Catalog_Helper_Product *\/",318],["T_WHITESPACE","\n        ",318],["T_VARIABLE","$productHelper",319],["T_WHITESPACE"," ",319],"=",["T_WHITESPACE"," ",319],["T_STRING","Mage",319],["T_DOUBLE_COLON","::",319],["T_STRING","helper",319],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product'",319],")",";",["T_WHITESPACE","\n        ",319],["T_FOREACH","foreach",320],["T_WHITESPACE"," ",320],"(",["T_VARIABLE","$items",320],["T_WHITESPACE"," ",320],["T_AS","as",320],["T_WHITESPACE"," ",320],["T_VARIABLE","$id",320],["T_WHITESPACE"," ",320],["T_DOUBLE_ARROW","=>",320],["T_WHITESPACE"," ",320],["T_VARIABLE","$item",320],")",["T_WHITESPACE"," ",320],"{",["T_WHITESPACE","\n            ",320],["T_VARIABLE","$buyRequest",321],["T_WHITESPACE"," ",321],"=",["T_WHITESPACE"," ",321],["T_NEW","new",321],["T_WHITESPACE"," ",321],["T_STRING","Varien_Object",321],"(",["T_VARIABLE","$item",321],")",";",["T_WHITESPACE","\n            ",321],["T_VARIABLE","$params",322],["T_WHITESPACE"," ",322],"=",["T_WHITESPACE"," ",322],["T_ARRAY","array",322],"(",["T_CONSTANT_ENCAPSED_STRING","'files_prefix'",322],["T_WHITESPACE"," ",322],["T_DOUBLE_ARROW","=>",322],["T_WHITESPACE"," ",322],["T_CONSTANT_ENCAPSED_STRING","'item_'",322],["T_WHITESPACE"," ",322],".",["T_WHITESPACE"," ",322],["T_VARIABLE","$id",322],["T_WHITESPACE"," ",322],".",["T_WHITESPACE"," ",322],["T_CONSTANT_ENCAPSED_STRING","'_'",322],")",";",["T_WHITESPACE","\n            ",322],["T_VARIABLE","$buyRequest",323],["T_WHITESPACE"," ",323],"=",["T_WHITESPACE"," ",323],["T_VARIABLE","$productHelper",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","addParamsToBuyRequest",323],"(",["T_VARIABLE","$buyRequest",323],",",["T_WHITESPACE"," ",323],["T_VARIABLE","$params",323],")",";",["T_WHITESPACE","\n            ",323],["T_IF","if",324],["T_WHITESPACE"," ",324],"(",["T_VARIABLE","$buyRequest",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","hasData",324],"(",")",")",["T_WHITESPACE"," ",324],"{",["T_WHITESPACE","\n                ",324],["T_VARIABLE","$items",325],"[",["T_VARIABLE","$id",325],"]",["T_WHITESPACE"," ",325],"=",["T_WHITESPACE"," ",325],["T_VARIABLE","$buyRequest",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","toArray",325],"(",")",";",["T_WHITESPACE","\n            ",325],"}",["T_WHITESPACE","\n        ",326],"}",["T_WHITESPACE","\n        ",327],["T_RETURN","return",328],["T_WHITESPACE"," ",328],["T_VARIABLE","$items",328],";",["T_WHITESPACE","\n    ",328],"}",["T_WHITESPACE","\n\n    ",329],["T_DOC_COMMENT","\/**\n     * Index page\n     *\/",331],["T_WHITESPACE","\n    ",333],["T_PUBLIC","public",334],["T_WHITESPACE"," ",334],["T_FUNCTION","function",334],["T_WHITESPACE"," ",334],["T_STRING","indexAction",334],"(",")",["T_WHITESPACE","\n    ",334],"{",["T_WHITESPACE","\n        ",335],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","_title",336],"(",["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","__",336],"(",["T_CONSTANT_ENCAPSED_STRING","'Sales'",336],")",")",["T_OBJECT_OPERATOR","->",336],["T_STRING","_title",336],"(",["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","__",336],"(",["T_CONSTANT_ENCAPSED_STRING","'Orders'",336],")",")",["T_OBJECT_OPERATOR","->",336],["T_STRING","_title",336],"(",["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","__",336],"(",["T_CONSTANT_ENCAPSED_STRING","'New Order'",336],")",")",";",["T_WHITESPACE","\n        ",336],["T_VARIABLE","$this",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","_initSession",337],"(",")",";",["T_WHITESPACE","\n        ",337],["T_VARIABLE","$this",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","loadLayout",338],"(",")",";",["T_WHITESPACE","\n\n        ",338],["T_VARIABLE","$this",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","_setActiveMenu",340],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order'",340],")",["T_WHITESPACE","\n            ",340],["T_OBJECT_OPERATOR","->",341],["T_STRING","renderLayout",341],"(",")",";",["T_WHITESPACE","\n    ",341],"}",["T_WHITESPACE","\n\n\n    ",342],["T_PUBLIC","public",345],["T_WHITESPACE"," ",345],["T_FUNCTION","function",345],["T_WHITESPACE"," ",345],["T_STRING","reorderAction",345],"(",")",["T_WHITESPACE","\n    ",345],"{",["T_WHITESPACE","\n        ",346],["T_VARIABLE","$this",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","_getSession",347],"(",")",["T_OBJECT_OPERATOR","->",347],["T_STRING","clear",347],"(",")",";",["T_WHITESPACE","\n        ",347],["T_VARIABLE","$orderId",348],["T_WHITESPACE"," ",348],"=",["T_WHITESPACE"," ",348],["T_VARIABLE","$this",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","getRequest",348],"(",")",["T_OBJECT_OPERATOR","->",348],["T_STRING","getParam",348],"(",["T_CONSTANT_ENCAPSED_STRING","'order_id'",348],")",";",["T_WHITESPACE","\n        ",348],["T_VARIABLE","$order",349],["T_WHITESPACE"," ",349],"=",["T_WHITESPACE"," ",349],["T_STRING","Mage",349],["T_DOUBLE_COLON","::",349],["T_STRING","getModel",349],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order'",349],")",["T_OBJECT_OPERATOR","->",349],["T_STRING","load",349],"(",["T_VARIABLE","$orderId",349],")",";",["T_WHITESPACE","\n        ",349],["T_IF","if",350],["T_WHITESPACE"," ",350],"(","!",["T_STRING","Mage",350],["T_DOUBLE_COLON","::",350],["T_STRING","helper",350],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/reorder'",350],")",["T_OBJECT_OPERATOR","->",350],["T_STRING","canReorder",350],"(",["T_VARIABLE","$order",350],")",")",["T_WHITESPACE"," ",350],"{",["T_WHITESPACE","\n            ",350],["T_RETURN","return",351],["T_WHITESPACE"," ",351],["T_VARIABLE","$this",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","_forward",351],"(",["T_CONSTANT_ENCAPSED_STRING","'noRoute'",351],")",";",["T_WHITESPACE","\n        ",351],"}",["T_WHITESPACE","\n\n        ",352],["T_IF","if",354],["T_WHITESPACE"," ",354],"(",["T_VARIABLE","$order",354],["T_OBJECT_OPERATOR","->",354],["T_STRING","getId",354],"(",")",")",["T_WHITESPACE"," ",354],"{",["T_WHITESPACE","\n            ",354],["T_VARIABLE","$order",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","setReordered",355],"(",["T_STRING","true",355],")",";",["T_WHITESPACE","\n            ",355],["T_VARIABLE","$this",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","_getSession",356],"(",")",["T_OBJECT_OPERATOR","->",356],["T_STRING","setUseOldShippingMethod",356],"(",["T_STRING","true",356],")",";",["T_WHITESPACE","\n            ",356],["T_VARIABLE","$this",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","_getOrderCreateModel",357],"(",")",["T_OBJECT_OPERATOR","->",357],["T_STRING","initFromOrder",357],"(",["T_VARIABLE","$order",357],")",";",["T_WHITESPACE","\n\n            ",357],["T_VARIABLE","$this",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","_redirect",359],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*'",359],")",";",["T_WHITESPACE","\n        ",359],"}",["T_WHITESPACE","\n        ",360],["T_ELSE","else",361],["T_WHITESPACE"," ",361],"{",["T_WHITESPACE","\n            ",361],["T_VARIABLE","$this",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","_redirect",362],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/sales_order\/'",362],")",";",["T_WHITESPACE","\n        ",362],"}",["T_WHITESPACE","\n    ",363],"}",["T_WHITESPACE","\n\n    ",364],["T_PROTECTED","protected",366],["T_WHITESPACE"," ",366],["T_FUNCTION","function",366],["T_WHITESPACE"," ",366],["T_STRING","_reloadQuote",366],"(",")",["T_WHITESPACE","\n    ",366],"{",["T_WHITESPACE","\n        ",367],["T_VARIABLE","$id",368],["T_WHITESPACE"," ",368],"=",["T_WHITESPACE"," ",368],["T_VARIABLE","$this",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","_getQuote",368],"(",")",["T_OBJECT_OPERATOR","->",368],["T_STRING","getId",368],"(",")",";",["T_WHITESPACE","\n        ",368],["T_VARIABLE","$this",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","_getQuote",369],"(",")",["T_OBJECT_OPERATOR","->",369],["T_STRING","load",369],"(",["T_VARIABLE","$id",369],")",";",["T_WHITESPACE","\n        ",369],["T_RETURN","return",370],["T_WHITESPACE"," ",370],["T_VARIABLE","$this",370],";",["T_WHITESPACE","\n    ",370],"}",["T_WHITESPACE","\n\n    ",371],["T_DOC_COMMENT","\/**\n     * Loading page block\n     *\/",373],["T_WHITESPACE","\n    ",375],["T_PUBLIC","public",376],["T_WHITESPACE"," ",376],["T_FUNCTION","function",376],["T_WHITESPACE"," ",376],["T_STRING","loadBlockAction",376],"(",")",["T_WHITESPACE","\n    ",376],"{",["T_WHITESPACE","\n        ",377],["T_VARIABLE","$request",378],["T_WHITESPACE"," ",378],"=",["T_WHITESPACE"," ",378],["T_VARIABLE","$this",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","getRequest",378],"(",")",";",["T_WHITESPACE","\n        ",378],["T_TRY","try",379],["T_WHITESPACE"," ",379],"{",["T_WHITESPACE","\n            ",379],["T_VARIABLE","$this",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","_initSession",380],"(",")",["T_WHITESPACE","\n                ",380],["T_OBJECT_OPERATOR","->",381],["T_STRING","_processData",381],"(",")",";",["T_WHITESPACE","\n        ",381],"}",["T_WHITESPACE","\n        ",382],["T_CATCH","catch",383],["T_WHITESPACE"," ",383],"(",["T_STRING","Mage_Core_Exception",383],["T_WHITESPACE"," ",383],["T_VARIABLE","$e",383],")","{",["T_WHITESPACE","\n            ",383],["T_VARIABLE","$this",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","_reloadQuote",384],"(",")",";",["T_WHITESPACE","\n            ",384],["T_VARIABLE","$this",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","_getSession",385],"(",")",["T_OBJECT_OPERATOR","->",385],["T_STRING","addError",385],"(",["T_VARIABLE","$e",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","getMessage",385],"(",")",")",";",["T_WHITESPACE","\n        ",385],"}",["T_WHITESPACE","\n        ",386],["T_CATCH","catch",387],["T_WHITESPACE"," ",387],"(",["T_STRING","Exception",387],["T_WHITESPACE"," ",387],["T_VARIABLE","$e",387],")","{",["T_WHITESPACE","\n            ",387],["T_VARIABLE","$this",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","_reloadQuote",388],"(",")",";",["T_WHITESPACE","\n            ",388],["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","_getSession",389],"(",")",["T_OBJECT_OPERATOR","->",389],["T_STRING","addException",389],"(",["T_VARIABLE","$e",389],",",["T_WHITESPACE"," ",389],["T_VARIABLE","$e",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","getMessage",389],"(",")",")",";",["T_WHITESPACE","\n        ",389],"}",["T_WHITESPACE","\n\n\n        ",390],["T_VARIABLE","$asJson",393],"=",["T_WHITESPACE"," ",393],["T_VARIABLE","$request",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","getParam",393],"(",["T_CONSTANT_ENCAPSED_STRING","'json'",393],")",";",["T_WHITESPACE","\n        ",393],["T_VARIABLE","$block",394],["T_WHITESPACE"," ",394],"=",["T_WHITESPACE"," ",394],["T_VARIABLE","$request",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","getParam",394],"(",["T_CONSTANT_ENCAPSED_STRING","'block'",394],")",";",["T_WHITESPACE","\n\n        ",394],["T_VARIABLE","$update",396],["T_WHITESPACE"," ",396],"=",["T_WHITESPACE"," ",396],["T_VARIABLE","$this",396],["T_OBJECT_OPERATOR","->",396],["T_STRING","getLayout",396],"(",")",["T_OBJECT_OPERATOR","->",396],["T_STRING","getUpdate",396],"(",")",";",["T_WHITESPACE","\n        ",396],["T_IF","if",397],["T_WHITESPACE"," ",397],"(",["T_VARIABLE","$asJson",397],")",["T_WHITESPACE"," ",397],"{",["T_WHITESPACE","\n            ",397],["T_VARIABLE","$update",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","addHandle",398],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml_sales_order_create_load_block_json'",398],")",";",["T_WHITESPACE","\n        ",398],"}",["T_WHITESPACE"," ",399],["T_ELSE","else",399],["T_WHITESPACE"," ",399],"{",["T_WHITESPACE","\n            ",399],["T_VARIABLE","$update",400],["T_OBJECT_OPERATOR","->",400],["T_STRING","addHandle",400],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml_sales_order_create_load_block_plain'",400],")",";",["T_WHITESPACE","\n        ",400],"}",["T_WHITESPACE","\n\n        ",401],["T_IF","if",403],["T_WHITESPACE"," ",403],"(",["T_VARIABLE","$block",403],")",["T_WHITESPACE"," ",403],"{",["T_WHITESPACE","\n            ",403],["T_VARIABLE","$blocks",404],["T_WHITESPACE"," ",404],"=",["T_WHITESPACE"," ",404],["T_STRING","explode",404],"(",["T_CONSTANT_ENCAPSED_STRING","','",404],",",["T_WHITESPACE"," ",404],["T_VARIABLE","$block",404],")",";",["T_WHITESPACE","\n            ",404],["T_IF","if",405],["T_WHITESPACE"," ",405],"(",["T_VARIABLE","$asJson",405],["T_WHITESPACE"," ",405],["T_BOOLEAN_AND","&&",405],["T_WHITESPACE"," ",405],"!",["T_STRING","in_array",405],"(",["T_CONSTANT_ENCAPSED_STRING","'message'",405],",",["T_WHITESPACE"," ",405],["T_VARIABLE","$blocks",405],")",")",["T_WHITESPACE"," ",405],"{",["T_WHITESPACE","\n                ",405],["T_VARIABLE","$blocks",406],"[","]",["T_WHITESPACE"," ",406],"=",["T_WHITESPACE"," ",406],["T_CONSTANT_ENCAPSED_STRING","'message'",406],";",["T_WHITESPACE","\n            ",406],"}",["T_WHITESPACE","\n\n            ",407],["T_FOREACH","foreach",409],["T_WHITESPACE"," ",409],"(",["T_VARIABLE","$blocks",409],["T_WHITESPACE"," ",409],["T_AS","as",409],["T_WHITESPACE"," ",409],["T_VARIABLE","$block",409],")",["T_WHITESPACE"," ",409],"{",["T_WHITESPACE","\n                ",409],["T_VARIABLE","$update",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","addHandle",410],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml_sales_order_create_load_block_'",410],["T_WHITESPACE"," ",410],".",["T_WHITESPACE"," ",410],["T_VARIABLE","$block",410],")",";",["T_WHITESPACE","\n            ",410],"}",["T_WHITESPACE","\n        ",411],"}",["T_WHITESPACE","\n        ",412],["T_VARIABLE","$this",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","loadLayoutUpdates",413],"(",")",["T_OBJECT_OPERATOR","->",413],["T_STRING","generateLayoutXml",413],"(",")",["T_OBJECT_OPERATOR","->",413],["T_STRING","generateLayoutBlocks",413],"(",")",";",["T_WHITESPACE","\n        ",413],["T_VARIABLE","$result",414],["T_WHITESPACE"," ",414],"=",["T_WHITESPACE"," ",414],["T_VARIABLE","$this",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","getLayout",414],"(",")",["T_OBJECT_OPERATOR","->",414],["T_STRING","getBlock",414],"(",["T_CONSTANT_ENCAPSED_STRING","'content'",414],")",["T_OBJECT_OPERATOR","->",414],["T_STRING","toHtml",414],"(",")",";",["T_WHITESPACE","\n        ",414],["T_IF","if",415],["T_WHITESPACE"," ",415],"(",["T_VARIABLE","$request",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","getParam",415],"(",["T_CONSTANT_ENCAPSED_STRING","'as_js_varname'",415],")",")",["T_WHITESPACE"," ",415],"{",["T_WHITESPACE","\n            ",415],["T_STRING","Mage",416],["T_DOUBLE_COLON","::",416],["T_STRING","getSingleton",416],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",416],")",["T_OBJECT_OPERATOR","->",416],["T_STRING","setUpdateResult",416],"(",["T_VARIABLE","$result",416],")",";",["T_WHITESPACE","\n            ",416],["T_VARIABLE","$this",417],["T_OBJECT_OPERATOR","->",417],["T_STRING","_redirect",417],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/showUpdateResult'",417],")",";",["T_WHITESPACE","\n        ",417],"}",["T_WHITESPACE"," ",418],["T_ELSE","else",418],["T_WHITESPACE"," ",418],"{",["T_WHITESPACE","\n            ",418],["T_VARIABLE","$this",419],["T_OBJECT_OPERATOR","->",419],["T_STRING","getResponse",419],"(",")",["T_OBJECT_OPERATOR","->",419],["T_STRING","setBody",419],"(",["T_VARIABLE","$result",419],")",";",["T_WHITESPACE","\n        ",419],"}",["T_WHITESPACE","\n    ",420],"}",["T_WHITESPACE","\n\n    ",421],["T_DOC_COMMENT","\/**\n     * Adds configured product to quote\n     *\/",423],["T_WHITESPACE","\n    ",425],["T_PUBLIC","public",426],["T_WHITESPACE"," ",426],["T_FUNCTION","function",426],["T_WHITESPACE"," ",426],["T_STRING","addConfiguredAction",426],"(",")",["T_WHITESPACE","\n    ",426],"{",["T_WHITESPACE","\n        ",427],["T_VARIABLE","$errorMessage",428],["T_WHITESPACE"," ",428],"=",["T_WHITESPACE"," ",428],["T_STRING","null",428],";",["T_WHITESPACE","\n        ",428],["T_TRY","try",429],["T_WHITESPACE"," ",429],"{",["T_WHITESPACE","\n            ",429],["T_VARIABLE","$this",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","_initSession",430],"(",")",["T_WHITESPACE","\n                ",430],["T_OBJECT_OPERATOR","->",431],["T_STRING","_processData",431],"(",")",";",["T_WHITESPACE","\n        ",431],"}",["T_WHITESPACE","\n        ",432],["T_CATCH","catch",433],["T_WHITESPACE"," ",433],"(",["T_STRING","Exception",433],["T_WHITESPACE"," ",433],["T_VARIABLE","$e",433],")","{",["T_WHITESPACE","\n            ",433],["T_VARIABLE","$this",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","_reloadQuote",434],"(",")",";",["T_WHITESPACE","\n            ",434],["T_VARIABLE","$errorMessage",435],["T_WHITESPACE"," ",435],"=",["T_WHITESPACE"," ",435],["T_VARIABLE","$e",435],["T_OBJECT_OPERATOR","->",435],["T_STRING","getMessage",435],"(",")",";",["T_WHITESPACE","\n        ",435],"}",["T_WHITESPACE","\n\n        ",436],["T_COMMENT","\/\/ Form result for client javascript\n",438],["T_WHITESPACE","        ",439],["T_VARIABLE","$updateResult",439],["T_WHITESPACE"," ",439],"=",["T_WHITESPACE"," ",439],["T_NEW","new",439],["T_WHITESPACE"," ",439],["T_STRING","Varien_Object",439],"(",")",";",["T_WHITESPACE","\n        ",439],["T_IF","if",440],["T_WHITESPACE"," ",440],"(",["T_VARIABLE","$errorMessage",440],")",["T_WHITESPACE"," ",440],"{",["T_WHITESPACE","\n            ",440],["T_VARIABLE","$updateResult",441],["T_OBJECT_OPERATOR","->",441],["T_STRING","setError",441],"(",["T_STRING","true",441],")",";",["T_WHITESPACE","\n            ",441],["T_VARIABLE","$updateResult",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","setMessage",442],"(",["T_VARIABLE","$errorMessage",442],")",";",["T_WHITESPACE","\n        ",442],"}",["T_WHITESPACE"," ",443],["T_ELSE","else",443],["T_WHITESPACE"," ",443],"{",["T_WHITESPACE","\n            ",443],["T_VARIABLE","$updateResult",444],["T_OBJECT_OPERATOR","->",444],["T_STRING","setOk",444],"(",["T_STRING","true",444],")",";",["T_WHITESPACE","\n        ",444],"}",["T_WHITESPACE","\n\n        ",445],["T_VARIABLE","$updateResult",447],["T_OBJECT_OPERATOR","->",447],["T_STRING","setJsVarName",447],"(",["T_VARIABLE","$this",447],["T_OBJECT_OPERATOR","->",447],["T_STRING","getRequest",447],"(",")",["T_OBJECT_OPERATOR","->",447],["T_STRING","getParam",447],"(",["T_CONSTANT_ENCAPSED_STRING","'as_js_varname'",447],")",")",";",["T_WHITESPACE","\n        ",447],["T_STRING","Mage",448],["T_DOUBLE_COLON","::",448],["T_STRING","getSingleton",448],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",448],")",["T_OBJECT_OPERATOR","->",448],["T_STRING","setCompositeProductResult",448],"(",["T_VARIABLE","$updateResult",448],")",";",["T_WHITESPACE","\n        ",448],["T_VARIABLE","$this",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","_redirect",449],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/catalog_product\/showUpdateResult'",449],")",";",["T_WHITESPACE","\n    ",449],"}",["T_WHITESPACE","\n\n    ",450],["T_DOC_COMMENT","\/**\n     * Start order create action\n     *\/",452],["T_WHITESPACE","\n    ",454],["T_PUBLIC","public",455],["T_WHITESPACE"," ",455],["T_FUNCTION","function",455],["T_WHITESPACE"," ",455],["T_STRING","startAction",455],"(",")",["T_WHITESPACE","\n    ",455],"{",["T_WHITESPACE","\n        ",456],["T_VARIABLE","$this",457],["T_OBJECT_OPERATOR","->",457],["T_STRING","_getSession",457],"(",")",["T_OBJECT_OPERATOR","->",457],["T_STRING","clear",457],"(",")",";",["T_WHITESPACE","\n        ",457],["T_VARIABLE","$this",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","_redirect",458],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*'",458],",",["T_WHITESPACE"," ",458],["T_ARRAY","array",458],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",458],["T_WHITESPACE"," ",458],["T_DOUBLE_ARROW","=>",458],["T_WHITESPACE"," ",458],["T_VARIABLE","$this",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","getRequest",458],"(",")",["T_OBJECT_OPERATOR","->",458],["T_STRING","getParam",458],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",458],")",")",")",";",["T_WHITESPACE","\n    ",458],"}",["T_WHITESPACE","\n\n    ",459],["T_DOC_COMMENT","\/**\n     * Cancel order create\n     *\/",461],["T_WHITESPACE","\n    ",463],["T_PUBLIC","public",464],["T_WHITESPACE"," ",464],["T_FUNCTION","function",464],["T_WHITESPACE"," ",464],["T_STRING","cancelAction",464],"(",")",["T_WHITESPACE","\n    ",464],"{",["T_WHITESPACE","\n        ",465],["T_IF","if",466],["T_WHITESPACE"," ",466],"(",["T_VARIABLE","$orderId",466],["T_WHITESPACE"," ",466],"=",["T_WHITESPACE"," ",466],["T_VARIABLE","$this",466],["T_OBJECT_OPERATOR","->",466],["T_STRING","_getSession",466],"(",")",["T_OBJECT_OPERATOR","->",466],["T_STRING","getReordered",466],"(",")",")",["T_WHITESPACE"," ",466],"{",["T_WHITESPACE","\n            ",466],["T_VARIABLE","$this",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","_getSession",467],"(",")",["T_OBJECT_OPERATOR","->",467],["T_STRING","clear",467],"(",")",";",["T_WHITESPACE","\n            ",467],["T_VARIABLE","$this",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","_redirect",468],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/sales_order\/view'",468],",",["T_WHITESPACE"," ",468],["T_ARRAY","array",468],"(",["T_WHITESPACE","\n                ",468],["T_CONSTANT_ENCAPSED_STRING","'order_id'",469],["T_DOUBLE_ARROW","=>",469],["T_VARIABLE","$orderId",469],["T_WHITESPACE","\n            ",469],")",")",";",["T_WHITESPACE","\n        ",470],"}",["T_WHITESPACE"," ",471],["T_ELSE","else",471],["T_WHITESPACE"," ",471],"{",["T_WHITESPACE","\n            ",471],["T_VARIABLE","$this",472],["T_OBJECT_OPERATOR","->",472],["T_STRING","_getSession",472],"(",")",["T_OBJECT_OPERATOR","->",472],["T_STRING","clear",472],"(",")",";",["T_WHITESPACE","\n            ",472],["T_VARIABLE","$this",473],["T_OBJECT_OPERATOR","->",473],["T_STRING","_redirect",473],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*'",473],")",";",["T_WHITESPACE","\n        ",473],"}",["T_WHITESPACE","\n\n    ",474],"}",["T_WHITESPACE","\n\n    ",476],["T_DOC_COMMENT","\/**\n     * Saving quote and create order\n     *\/",478],["T_WHITESPACE","\n    ",480],["T_PUBLIC","public",481],["T_WHITESPACE"," ",481],["T_FUNCTION","function",481],["T_WHITESPACE"," ",481],["T_STRING","saveAction",481],"(",")",["T_WHITESPACE","\n    ",481],"{",["T_WHITESPACE","\n        ",482],["T_TRY","try",483],["T_WHITESPACE"," ",483],"{",["T_WHITESPACE","\n            ",483],["T_VARIABLE","$this",484],["T_OBJECT_OPERATOR","->",484],["T_STRING","_processActionData",484],"(",["T_CONSTANT_ENCAPSED_STRING","'save'",484],")",";",["T_WHITESPACE","\n            ",484],["T_VARIABLE","$paymentData",485],["T_WHITESPACE"," ",485],"=",["T_WHITESPACE"," ",485],["T_VARIABLE","$this",485],["T_OBJECT_OPERATOR","->",485],["T_STRING","getRequest",485],"(",")",["T_OBJECT_OPERATOR","->",485],["T_STRING","getPost",485],"(",["T_CONSTANT_ENCAPSED_STRING","'payment'",485],")",";",["T_WHITESPACE","\n            ",485],["T_IF","if",486],["T_WHITESPACE"," ",486],"(",["T_VARIABLE","$paymentData",486],")",["T_WHITESPACE"," ",486],"{",["T_WHITESPACE","\n                ",486],["T_VARIABLE","$paymentData",487],"[",["T_CONSTANT_ENCAPSED_STRING","'checks'",487],"]",["T_WHITESPACE"," ",487],"=",["T_WHITESPACE"," ",487],["T_STRING","Mage_Payment_Model_Method_Abstract",487],["T_DOUBLE_COLON","::",487],["T_STRING","CHECK_USE_INTERNAL",487],["T_WHITESPACE","\n                    ",487],"|",["T_WHITESPACE"," ",488],["T_STRING","Mage_Payment_Model_Method_Abstract",488],["T_DOUBLE_COLON","::",488],["T_STRING","CHECK_USE_FOR_COUNTRY",488],["T_WHITESPACE","\n                    ",488],"|",["T_WHITESPACE"," ",489],["T_STRING","Mage_Payment_Model_Method_Abstract",489],["T_DOUBLE_COLON","::",489],["T_STRING","CHECK_USE_FOR_CURRENCY",489],["T_WHITESPACE","\n                    ",489],"|",["T_WHITESPACE"," ",490],["T_STRING","Mage_Payment_Model_Method_Abstract",490],["T_DOUBLE_COLON","::",490],["T_STRING","CHECK_ORDER_TOTAL_MIN_MAX",490],["T_WHITESPACE","\n                    ",490],"|",["T_WHITESPACE"," ",491],["T_STRING","Mage_Payment_Model_Method_Abstract",491],["T_DOUBLE_COLON","::",491],["T_STRING","CHECK_ZERO_TOTAL",491],";",["T_WHITESPACE","\n                ",491],["T_VARIABLE","$this",492],["T_OBJECT_OPERATOR","->",492],["T_STRING","_getOrderCreateModel",492],"(",")",["T_OBJECT_OPERATOR","->",492],["T_STRING","setPaymentData",492],"(",["T_VARIABLE","$paymentData",492],")",";",["T_WHITESPACE","\n                ",492],["T_VARIABLE","$this",493],["T_OBJECT_OPERATOR","->",493],["T_STRING","_getOrderCreateModel",493],"(",")",["T_OBJECT_OPERATOR","->",493],["T_STRING","getQuote",493],"(",")",["T_OBJECT_OPERATOR","->",493],["T_STRING","getPayment",493],"(",")",["T_OBJECT_OPERATOR","->",493],["T_STRING","addData",493],"(",["T_VARIABLE","$paymentData",493],")",";",["T_WHITESPACE","\n            ",493],"}",["T_WHITESPACE","\n\n            ",494],["T_VARIABLE","$order",496],["T_WHITESPACE"," ",496],"=",["T_WHITESPACE"," ",496],["T_VARIABLE","$this",496],["T_OBJECT_OPERATOR","->",496],["T_STRING","_getOrderCreateModel",496],"(",")",["T_WHITESPACE","\n                ",496],["T_OBJECT_OPERATOR","->",497],["T_STRING","setIsValidate",497],"(",["T_STRING","true",497],")",["T_WHITESPACE","\n                ",497],["T_OBJECT_OPERATOR","->",498],["T_STRING","importPostData",498],"(",["T_VARIABLE","$this",498],["T_OBJECT_OPERATOR","->",498],["T_STRING","getRequest",498],"(",")",["T_OBJECT_OPERATOR","->",498],["T_STRING","getPost",498],"(",["T_CONSTANT_ENCAPSED_STRING","'order'",498],")",")",["T_WHITESPACE","\n                ",498],["T_OBJECT_OPERATOR","->",499],["T_STRING","createOrder",499],"(",")",";",["T_WHITESPACE","\n\n            ",499],["T_VARIABLE","$this",501],["T_OBJECT_OPERATOR","->",501],["T_STRING","_getSession",501],"(",")",["T_OBJECT_OPERATOR","->",501],["T_STRING","clear",501],"(",")",";",["T_WHITESPACE","\n            ",501],["T_STRING","Mage",502],["T_DOUBLE_COLON","::",502],["T_STRING","getSingleton",502],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",502],")",["T_OBJECT_OPERATOR","->",502],["T_STRING","addSuccess",502],"(",["T_VARIABLE","$this",502],["T_OBJECT_OPERATOR","->",502],["T_STRING","__",502],"(",["T_CONSTANT_ENCAPSED_STRING","'The order has been created.'",502],")",")",";",["T_WHITESPACE","\n            ",502],["T_IF","if",503],["T_WHITESPACE"," ",503],"(",["T_STRING","Mage",503],["T_DOUBLE_COLON","::",503],["T_STRING","getSingleton",503],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/session'",503],")",["T_OBJECT_OPERATOR","->",503],["T_STRING","isAllowed",503],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order\/actions\/view'",503],")",")",["T_WHITESPACE"," ",503],"{",["T_WHITESPACE","\n                ",503],["T_VARIABLE","$this",504],["T_OBJECT_OPERATOR","->",504],["T_STRING","_redirect",504],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/sales_order\/view'",504],",",["T_WHITESPACE"," ",504],["T_ARRAY","array",504],"(",["T_CONSTANT_ENCAPSED_STRING","'order_id'",504],["T_WHITESPACE"," ",504],["T_DOUBLE_ARROW","=>",504],["T_WHITESPACE"," ",504],["T_VARIABLE","$order",504],["T_OBJECT_OPERATOR","->",504],["T_STRING","getId",504],"(",")",")",")",";",["T_WHITESPACE","\n            ",504],"}",["T_WHITESPACE"," ",505],["T_ELSE","else",505],["T_WHITESPACE"," ",505],"{",["T_WHITESPACE","\n                ",505],["T_VARIABLE","$this",506],["T_OBJECT_OPERATOR","->",506],["T_STRING","_redirect",506],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/sales_order\/index'",506],")",";",["T_WHITESPACE","\n            ",506],"}",["T_WHITESPACE","\n        ",507],"}",["T_WHITESPACE"," ",508],["T_CATCH","catch",508],["T_WHITESPACE"," ",508],"(",["T_STRING","Mage_Payment_Model_Info_Exception",508],["T_WHITESPACE"," ",508],["T_VARIABLE","$e",508],")",["T_WHITESPACE"," ",508],"{",["T_WHITESPACE","\n            ",508],["T_VARIABLE","$this",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","_getOrderCreateModel",509],"(",")",["T_OBJECT_OPERATOR","->",509],["T_STRING","saveQuote",509],"(",")",";",["T_WHITESPACE","\n            ",509],["T_VARIABLE","$message",510],["T_WHITESPACE"," ",510],"=",["T_WHITESPACE"," ",510],["T_VARIABLE","$e",510],["T_OBJECT_OPERATOR","->",510],["T_STRING","getMessage",510],"(",")",";",["T_WHITESPACE","\n            ",510],["T_IF","if",511],"(",["T_WHITESPACE"," ",511],"!",["T_EMPTY","empty",511],"(",["T_VARIABLE","$message",511],")",["T_WHITESPACE"," ",511],")",["T_WHITESPACE"," ",511],"{",["T_WHITESPACE","\n                ",511],["T_VARIABLE","$this",512],["T_OBJECT_OPERATOR","->",512],["T_STRING","_getSession",512],"(",")",["T_OBJECT_OPERATOR","->",512],["T_STRING","addError",512],"(",["T_VARIABLE","$message",512],")",";",["T_WHITESPACE","\n            ",512],"}",["T_WHITESPACE","\n            ",513],["T_VARIABLE","$this",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","_redirect",514],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/'",514],")",";",["T_WHITESPACE","\n        ",514],"}",["T_WHITESPACE"," ",515],["T_CATCH","catch",515],["T_WHITESPACE"," ",515],"(",["T_STRING","Mage_Core_Exception",515],["T_WHITESPACE"," ",515],["T_VARIABLE","$e",515],")","{",["T_WHITESPACE","\n            ",515],["T_VARIABLE","$message",516],["T_WHITESPACE"," ",516],"=",["T_WHITESPACE"," ",516],["T_VARIABLE","$e",516],["T_OBJECT_OPERATOR","->",516],["T_STRING","getMessage",516],"(",")",";",["T_WHITESPACE","\n            ",516],["T_IF","if",517],"(",["T_WHITESPACE"," ",517],"!",["T_EMPTY","empty",517],"(",["T_VARIABLE","$message",517],")",["T_WHITESPACE"," ",517],")",["T_WHITESPACE"," ",517],"{",["T_WHITESPACE","\n                ",517],["T_VARIABLE","$this",518],["T_OBJECT_OPERATOR","->",518],["T_STRING","_getSession",518],"(",")",["T_OBJECT_OPERATOR","->",518],["T_STRING","addError",518],"(",["T_VARIABLE","$message",518],")",";",["T_WHITESPACE","\n            ",518],"}",["T_WHITESPACE","\n            ",519],["T_VARIABLE","$this",520],["T_OBJECT_OPERATOR","->",520],["T_STRING","_redirect",520],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/'",520],")",";",["T_WHITESPACE","\n        ",520],"}",["T_WHITESPACE","\n        ",521],["T_CATCH","catch",522],["T_WHITESPACE"," ",522],"(",["T_STRING","Exception",522],["T_WHITESPACE"," ",522],["T_VARIABLE","$e",522],")","{",["T_WHITESPACE","\n            ",522],["T_VARIABLE","$this",523],["T_OBJECT_OPERATOR","->",523],["T_STRING","_getSession",523],"(",")",["T_OBJECT_OPERATOR","->",523],["T_STRING","addException",523],"(",["T_VARIABLE","$e",523],",",["T_WHITESPACE"," ",523],["T_VARIABLE","$this",523],["T_OBJECT_OPERATOR","->",523],["T_STRING","__",523],"(",["T_CONSTANT_ENCAPSED_STRING","'Order saving error: %s'",523],",",["T_WHITESPACE"," ",523],["T_VARIABLE","$e",523],["T_OBJECT_OPERATOR","->",523],["T_STRING","getMessage",523],"(",")",")",")",";",["T_WHITESPACE","\n            ",523],["T_VARIABLE","$this",524],["T_OBJECT_OPERATOR","->",524],["T_STRING","_redirect",524],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/'",524],")",";",["T_WHITESPACE","\n        ",524],"}",["T_WHITESPACE","\n    ",525],"}",["T_WHITESPACE","\n\n    ",526],["T_DOC_COMMENT","\/**\n     * Acl check for admin\n     *\n     * @return bool\n     *\/",528],["T_WHITESPACE","\n    ",532],["T_PROTECTED","protected",533],["T_WHITESPACE"," ",533],["T_FUNCTION","function",533],["T_WHITESPACE"," ",533],["T_STRING","_isAllowed",533],"(",")",["T_WHITESPACE","\n    ",533],"{",["T_WHITESPACE","\n        ",534],["T_RETURN","return",535],["T_WHITESPACE"," ",535],["T_STRING","Mage",535],["T_DOUBLE_COLON","::",535],["T_STRING","getSingleton",535],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/session'",535],")",["T_OBJECT_OPERATOR","->",535],["T_STRING","isAllowed",535],"(",["T_VARIABLE","$this",535],["T_OBJECT_OPERATOR","->",535],["T_STRING","_getAclResourse",535],"(",")",")",";",["T_WHITESPACE","\n    ",535],"}",["T_WHITESPACE","\n\n    ",536],["T_DOC_COMMENT","\/**\n     * Get acl resource\n     *\n     * @return string\n     *\/",538],["T_WHITESPACE","\n    ",542],["T_PROTECTED","protected",543],["T_WHITESPACE"," ",543],["T_FUNCTION","function",543],["T_WHITESPACE"," ",543],["T_STRING","_getAclResourse",543],"(",")",["T_WHITESPACE","\n    ",543],"{",["T_WHITESPACE","\n        ",544],["T_VARIABLE","$action",545],["T_WHITESPACE"," ",545],"=",["T_WHITESPACE"," ",545],["T_STRING","strtolower",545],"(",["T_VARIABLE","$this",545],["T_OBJECT_OPERATOR","->",545],["T_STRING","getRequest",545],"(",")",["T_OBJECT_OPERATOR","->",545],["T_STRING","getActionName",545],"(",")",")",";",["T_WHITESPACE","\n        ",545],["T_IF","if",546],["T_WHITESPACE"," ",546],"(",["T_STRING","in_array",546],"(",["T_VARIABLE","$action",546],",",["T_WHITESPACE"," ",546],["T_ARRAY","array",546],"(",["T_CONSTANT_ENCAPSED_STRING","'index'",546],",",["T_WHITESPACE"," ",546],["T_CONSTANT_ENCAPSED_STRING","'save'",546],")",")",["T_WHITESPACE"," ",546],["T_BOOLEAN_AND","&&",546],["T_WHITESPACE"," ",546],["T_VARIABLE","$this",546],["T_OBJECT_OPERATOR","->",546],["T_STRING","_getSession",546],"(",")",["T_OBJECT_OPERATOR","->",546],["T_STRING","getReordered",546],"(",")",")",["T_WHITESPACE"," ",546],"{",["T_WHITESPACE","\n            ",546],["T_VARIABLE","$action",547],["T_WHITESPACE"," ",547],"=",["T_WHITESPACE"," ",547],["T_CONSTANT_ENCAPSED_STRING","'reorder'",547],";",["T_WHITESPACE","\n        ",547],"}",["T_WHITESPACE","\n        ",548],["T_SWITCH","switch",549],["T_WHITESPACE"," ",549],"(",["T_VARIABLE","$action",549],")",["T_WHITESPACE"," ",549],"{",["T_WHITESPACE","\n            ",549],["T_CASE","case",550],["T_WHITESPACE"," ",550],["T_CONSTANT_ENCAPSED_STRING","'index'",550],":",["T_WHITESPACE","\n            ",550],["T_CASE","case",551],["T_WHITESPACE"," ",551],["T_CONSTANT_ENCAPSED_STRING","'save'",551],":",["T_WHITESPACE","\n                ",551],["T_VARIABLE","$aclResource",552],["T_WHITESPACE"," ",552],"=",["T_WHITESPACE"," ",552],["T_CONSTANT_ENCAPSED_STRING","'sales\/order\/actions\/create'",552],";",["T_WHITESPACE","\n                ",552],["T_BREAK","break",553],";",["T_WHITESPACE","\n            ",553],["T_CASE","case",554],["T_WHITESPACE"," ",554],["T_CONSTANT_ENCAPSED_STRING","'reorder'",554],":",["T_WHITESPACE","\n                ",554],["T_VARIABLE","$aclResource",555],["T_WHITESPACE"," ",555],"=",["T_WHITESPACE"," ",555],["T_CONSTANT_ENCAPSED_STRING","'sales\/order\/actions\/reorder'",555],";",["T_WHITESPACE","\n                ",555],["T_BREAK","break",556],";",["T_WHITESPACE","\n            ",556],["T_CASE","case",557],["T_WHITESPACE"," ",557],["T_CONSTANT_ENCAPSED_STRING","'cancel'",557],":",["T_WHITESPACE","\n                ",557],["T_VARIABLE","$aclResource",558],["T_WHITESPACE"," ",558],"=",["T_WHITESPACE"," ",558],["T_CONSTANT_ENCAPSED_STRING","'sales\/order\/actions\/cancel'",558],";",["T_WHITESPACE","\n                ",558],["T_BREAK","break",559],";",["T_WHITESPACE","\n            ",559],["T_DEFAULT","default",560],":",["T_WHITESPACE","\n                ",560],["T_VARIABLE","$aclResource",561],["T_WHITESPACE"," ",561],"=",["T_WHITESPACE"," ",561],["T_CONSTANT_ENCAPSED_STRING","'sales\/order\/actions'",561],";",["T_WHITESPACE","\n                ",561],["T_BREAK","break",562],";",["T_WHITESPACE","\n        ",562],"}",["T_WHITESPACE","\n        ",563],["T_RETURN","return",564],["T_WHITESPACE"," ",564],["T_VARIABLE","$aclResource",564],";",["T_WHITESPACE","\n    ",564],"}",["T_WHITESPACE","\n\n    ",565],["T_COMMENT","\/*\n     * Ajax handler to response configuration fieldset of composite product in order\n     *\n     * @return Mage_Adminhtml_Sales_Order_CreateController\n     *\/",567],["T_WHITESPACE","\n    ",571],["T_PUBLIC","public",572],["T_WHITESPACE"," ",572],["T_FUNCTION","function",572],["T_WHITESPACE"," ",572],["T_STRING","configureProductToAddAction",572],"(",")",["T_WHITESPACE","\n    ",572],"{",["T_WHITESPACE","\n        ",573],["T_COMMENT","\/\/ Prepare data\n",574],["T_WHITESPACE","        ",575],["T_VARIABLE","$productId",575],["T_WHITESPACE","  ",575],"=",["T_WHITESPACE"," ",575],["T_INT_CAST","(int)",575],["T_WHITESPACE"," ",575],["T_VARIABLE","$this",575],["T_OBJECT_OPERATOR","->",575],["T_STRING","getRequest",575],"(",")",["T_OBJECT_OPERATOR","->",575],["T_STRING","getParam",575],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",575],")",";",["T_WHITESPACE","\n\n        ",575],["T_VARIABLE","$configureResult",577],["T_WHITESPACE"," ",577],"=",["T_WHITESPACE"," ",577],["T_NEW","new",577],["T_WHITESPACE"," ",577],["T_STRING","Varien_Object",577],"(",")",";",["T_WHITESPACE","\n        ",577],["T_VARIABLE","$configureResult",578],["T_OBJECT_OPERATOR","->",578],["T_STRING","setOk",578],"(",["T_STRING","true",578],")",";",["T_WHITESPACE","\n        ",578],["T_VARIABLE","$configureResult",579],["T_OBJECT_OPERATOR","->",579],["T_STRING","setProductId",579],"(",["T_VARIABLE","$productId",579],")",";",["T_WHITESPACE","\n        ",579],["T_VARIABLE","$sessionQuote",580],["T_WHITESPACE"," ",580],"=",["T_WHITESPACE"," ",580],["T_STRING","Mage",580],["T_DOUBLE_COLON","::",580],["T_STRING","getSingleton",580],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session_quote'",580],")",";",["T_WHITESPACE","\n        ",580],["T_VARIABLE","$configureResult",581],["T_OBJECT_OPERATOR","->",581],["T_STRING","setCurrentStoreId",581],"(",["T_VARIABLE","$sessionQuote",581],["T_OBJECT_OPERATOR","->",581],["T_STRING","getStore",581],"(",")",["T_OBJECT_OPERATOR","->",581],["T_STRING","getId",581],"(",")",")",";",["T_WHITESPACE","\n        ",581],["T_VARIABLE","$configureResult",582],["T_OBJECT_OPERATOR","->",582],["T_STRING","setCurrentCustomerId",582],"(",["T_VARIABLE","$sessionQuote",582],["T_OBJECT_OPERATOR","->",582],["T_STRING","getCustomerId",582],"(",")",")",";",["T_WHITESPACE","\n\n        ",582],["T_COMMENT","\/\/ Render page\n",584],["T_WHITESPACE","        ",585],["T_COMMENT","\/* @var $helper Mage_Adminhtml_Helper_Catalog_Product_Composite *\/",585],["T_WHITESPACE","\n        ",585],["T_VARIABLE","$helper",586],["T_WHITESPACE"," ",586],"=",["T_WHITESPACE"," ",586],["T_STRING","Mage",586],["T_DOUBLE_COLON","::",586],["T_STRING","helper",586],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/catalog_product_composite'",586],")",";",["T_WHITESPACE","\n        ",586],["T_VARIABLE","$helper",587],["T_OBJECT_OPERATOR","->",587],["T_STRING","renderConfigureResult",587],"(",["T_VARIABLE","$this",587],",",["T_WHITESPACE"," ",587],["T_VARIABLE","$configureResult",587],")",";",["T_WHITESPACE","\n\n        ",587],["T_RETURN","return",589],["T_WHITESPACE"," ",589],["T_VARIABLE","$this",589],";",["T_WHITESPACE","\n    ",589],"}",["T_WHITESPACE","\n\n    ",590],["T_COMMENT","\/*\n     * Ajax handler to response configuration fieldset of composite product in quote items\n     *\n     * @return Mage_Adminhtml_Sales_Order_CreateController\n     *\/",592],["T_WHITESPACE","\n    ",596],["T_PUBLIC","public",597],["T_WHITESPACE"," ",597],["T_FUNCTION","function",597],["T_WHITESPACE"," ",597],["T_STRING","configureQuoteItemsAction",597],"(",")",["T_WHITESPACE","\n    ",597],"{",["T_WHITESPACE","\n        ",598],["T_COMMENT","\/\/ Prepare data\n",599],["T_WHITESPACE","        ",600],["T_VARIABLE","$configureResult",600],["T_WHITESPACE"," ",600],"=",["T_WHITESPACE"," ",600],["T_NEW","new",600],["T_WHITESPACE"," ",600],["T_STRING","Varien_Object",600],"(",")",";",["T_WHITESPACE","\n        ",600],["T_TRY","try",601],["T_WHITESPACE"," ",601],"{",["T_WHITESPACE","\n            ",601],["T_VARIABLE","$quoteItemId",602],["T_WHITESPACE"," ",602],"=",["T_WHITESPACE"," ",602],["T_INT_CAST","(int)",602],["T_WHITESPACE"," ",602],["T_VARIABLE","$this",602],["T_OBJECT_OPERATOR","->",602],["T_STRING","getRequest",602],"(",")",["T_OBJECT_OPERATOR","->",602],["T_STRING","getParam",602],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",602],")",";",["T_WHITESPACE","\n            ",602],["T_IF","if",603],["T_WHITESPACE"," ",603],"(","!",["T_VARIABLE","$quoteItemId",603],")",["T_WHITESPACE"," ",603],"{",["T_WHITESPACE","\n                ",603],["T_STRING","Mage",604],["T_DOUBLE_COLON","::",604],["T_STRING","throwException",604],"(",["T_VARIABLE","$this",604],["T_OBJECT_OPERATOR","->",604],["T_STRING","__",604],"(",["T_CONSTANT_ENCAPSED_STRING","'Quote item id is not received.'",604],")",")",";",["T_WHITESPACE","\n            ",604],"}",["T_WHITESPACE","\n\n            ",605],["T_VARIABLE","$quoteItem",607],["T_WHITESPACE"," ",607],"=",["T_WHITESPACE"," ",607],["T_STRING","Mage",607],["T_DOUBLE_COLON","::",607],["T_STRING","getModel",607],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/quote_item'",607],")",["T_OBJECT_OPERATOR","->",607],["T_STRING","load",607],"(",["T_VARIABLE","$quoteItemId",607],")",";",["T_WHITESPACE","\n            ",607],["T_IF","if",608],["T_WHITESPACE"," ",608],"(","!",["T_VARIABLE","$quoteItem",608],["T_OBJECT_OPERATOR","->",608],["T_STRING","getId",608],"(",")",")",["T_WHITESPACE"," ",608],"{",["T_WHITESPACE","\n                ",608],["T_STRING","Mage",609],["T_DOUBLE_COLON","::",609],["T_STRING","throwException",609],"(",["T_VARIABLE","$this",609],["T_OBJECT_OPERATOR","->",609],["T_STRING","__",609],"(",["T_CONSTANT_ENCAPSED_STRING","'Quote item is not loaded.'",609],")",")",";",["T_WHITESPACE","\n            ",609],"}",["T_WHITESPACE","\n\n            ",610],["T_VARIABLE","$configureResult",612],["T_OBJECT_OPERATOR","->",612],["T_STRING","setOk",612],"(",["T_STRING","true",612],")",";",["T_WHITESPACE","\n            ",612],["T_VARIABLE","$optionCollection",613],["T_WHITESPACE"," ",613],"=",["T_WHITESPACE"," ",613],["T_STRING","Mage",613],["T_DOUBLE_COLON","::",613],["T_STRING","getModel",613],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/quote_item_option'",613],")",["T_OBJECT_OPERATOR","->",613],["T_STRING","getCollection",613],"(",")",["T_WHITESPACE","\n                    ",613],["T_OBJECT_OPERATOR","->",614],["T_STRING","addItemFilter",614],"(",["T_ARRAY","array",614],"(",["T_VARIABLE","$quoteItemId",614],")",")",";",["T_WHITESPACE","\n            ",614],["T_VARIABLE","$quoteItem",615],["T_OBJECT_OPERATOR","->",615],["T_STRING","setOptions",615],"(",["T_VARIABLE","$optionCollection",615],["T_OBJECT_OPERATOR","->",615],["T_STRING","getOptionsByItem",615],"(",["T_VARIABLE","$quoteItem",615],")",")",";",["T_WHITESPACE","\n\n            ",615],["T_VARIABLE","$configureResult",617],["T_OBJECT_OPERATOR","->",617],["T_STRING","setBuyRequest",617],"(",["T_VARIABLE","$quoteItem",617],["T_OBJECT_OPERATOR","->",617],["T_STRING","getBuyRequest",617],"(",")",")",";",["T_WHITESPACE","\n            ",617],["T_VARIABLE","$configureResult",618],["T_OBJECT_OPERATOR","->",618],["T_STRING","setCurrentStoreId",618],"(",["T_VARIABLE","$quoteItem",618],["T_OBJECT_OPERATOR","->",618],["T_STRING","getStoreId",618],"(",")",")",";",["T_WHITESPACE","\n            ",618],["T_VARIABLE","$configureResult",619],["T_OBJECT_OPERATOR","->",619],["T_STRING","setProductId",619],"(",["T_VARIABLE","$quoteItem",619],["T_OBJECT_OPERATOR","->",619],["T_STRING","getProductId",619],"(",")",")",";",["T_WHITESPACE","\n            ",619],["T_VARIABLE","$sessionQuote",620],["T_WHITESPACE"," ",620],"=",["T_WHITESPACE"," ",620],["T_STRING","Mage",620],["T_DOUBLE_COLON","::",620],["T_STRING","getSingleton",620],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session_quote'",620],")",";",["T_WHITESPACE","\n            ",620],["T_VARIABLE","$configureResult",621],["T_OBJECT_OPERATOR","->",621],["T_STRING","setCurrentCustomerId",621],"(",["T_VARIABLE","$sessionQuote",621],["T_OBJECT_OPERATOR","->",621],["T_STRING","getCustomerId",621],"(",")",")",";",["T_WHITESPACE","\n\n        ",621],"}",["T_WHITESPACE"," ",623],["T_CATCH","catch",623],["T_WHITESPACE"," ",623],"(",["T_STRING","Exception",623],["T_WHITESPACE"," ",623],["T_VARIABLE","$e",623],")",["T_WHITESPACE"," ",623],"{",["T_WHITESPACE","\n            ",623],["T_VARIABLE","$configureResult",624],["T_OBJECT_OPERATOR","->",624],["T_STRING","setError",624],"(",["T_STRING","true",624],")",";",["T_WHITESPACE","\n            ",624],["T_VARIABLE","$configureResult",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","setMessage",625],"(",["T_VARIABLE","$e",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","getMessage",625],"(",")",")",";",["T_WHITESPACE","\n        ",625],"}",["T_WHITESPACE","\n\n        ",626],["T_COMMENT","\/\/ Render page\n",628],["T_WHITESPACE","        ",629],["T_COMMENT","\/* @var $helper Mage_Adminhtml_Helper_Catalog_Product_Composite *\/",629],["T_WHITESPACE","\n        ",629],["T_VARIABLE","$helper",630],["T_WHITESPACE"," ",630],"=",["T_WHITESPACE"," ",630],["T_STRING","Mage",630],["T_DOUBLE_COLON","::",630],["T_STRING","helper",630],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/catalog_product_composite'",630],")",";",["T_WHITESPACE","\n        ",630],["T_VARIABLE","$helper",631],["T_OBJECT_OPERATOR","->",631],["T_STRING","renderConfigureResult",631],"(",["T_VARIABLE","$this",631],",",["T_WHITESPACE"," ",631],["T_VARIABLE","$configureResult",631],")",";",["T_WHITESPACE","\n\n        ",631],["T_RETURN","return",633],["T_WHITESPACE"," ",633],["T_VARIABLE","$this",633],";",["T_WHITESPACE","\n    ",633],"}",["T_WHITESPACE","\n\n\n    ",634],["T_DOC_COMMENT","\/**\n     * Show item update result from loadBlockAction\n     * to prevent popup alert with resend data question\n     *\n     *\/",637],["T_WHITESPACE","\n    ",641],["T_PUBLIC","public",642],["T_WHITESPACE"," ",642],["T_FUNCTION","function",642],["T_WHITESPACE"," ",642],["T_STRING","showUpdateResultAction",642],"(",")",["T_WHITESPACE","\n    ",642],"{",["T_WHITESPACE","\n        ",643],["T_VARIABLE","$session",644],["T_WHITESPACE"," ",644],"=",["T_WHITESPACE"," ",644],["T_STRING","Mage",644],["T_DOUBLE_COLON","::",644],["T_STRING","getSingleton",644],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",644],")",";",["T_WHITESPACE","\n        ",644],["T_IF","if",645],["T_WHITESPACE"," ",645],"(",["T_VARIABLE","$session",645],["T_OBJECT_OPERATOR","->",645],["T_STRING","hasUpdateResult",645],"(",")",["T_WHITESPACE"," ",645],["T_BOOLEAN_AND","&&",645],["T_WHITESPACE"," ",645],["T_STRING","is_scalar",645],"(",["T_VARIABLE","$session",645],["T_OBJECT_OPERATOR","->",645],["T_STRING","getUpdateResult",645],"(",")",")",")","{",["T_WHITESPACE","\n            ",645],["T_VARIABLE","$this",646],["T_OBJECT_OPERATOR","->",646],["T_STRING","getResponse",646],"(",")",["T_OBJECT_OPERATOR","->",646],["T_STRING","setBody",646],"(",["T_VARIABLE","$session",646],["T_OBJECT_OPERATOR","->",646],["T_STRING","getUpdateResult",646],"(",")",")",";",["T_WHITESPACE","\n            ",646],["T_VARIABLE","$session",647],["T_OBJECT_OPERATOR","->",647],["T_STRING","unsUpdateResult",647],"(",")",";",["T_WHITESPACE","\n        ",647],"}",["T_WHITESPACE"," ",648],["T_ELSE","else",648],["T_WHITESPACE"," ",648],"{",["T_WHITESPACE","\n            ",648],["T_VARIABLE","$session",649],["T_OBJECT_OPERATOR","->",649],["T_STRING","unsUpdateResult",649],"(",")",";",["T_WHITESPACE","\n            ",649],["T_RETURN","return",650],["T_WHITESPACE"," ",650],["T_STRING","false",650],";",["T_WHITESPACE","\n        ",650],"}",["T_WHITESPACE","\n    ",651],"}",["T_WHITESPACE","\n\n    ",652],["T_DOC_COMMENT","\/**\n     * Process data and display index page\n     *\/",654],["T_WHITESPACE","\n    ",656],["T_PUBLIC","public",657],["T_WHITESPACE"," ",657],["T_FUNCTION","function",657],["T_WHITESPACE"," ",657],["T_STRING","processDataAction",657],"(",")",["T_WHITESPACE","\n    ",657],"{",["T_WHITESPACE","\n        ",658],["T_VARIABLE","$this",659],["T_OBJECT_OPERATOR","->",659],["T_STRING","_initSession",659],"(",")",";",["T_WHITESPACE","\n        ",659],["T_VARIABLE","$this",660],["T_OBJECT_OPERATOR","->",660],["T_STRING","_processData",660],"(",")",";",["T_WHITESPACE","\n        ",660],["T_VARIABLE","$this",661],["T_OBJECT_OPERATOR","->",661],["T_STRING","_forward",661],"(",["T_CONSTANT_ENCAPSED_STRING","'index'",661],")",";",["T_WHITESPACE","\n    ",661],"}",["T_WHITESPACE","\n",662],"}",["T_WHITESPACE","\n",663]]