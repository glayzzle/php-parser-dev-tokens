[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Adminhtml\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Product categories tab\n *\n * @category   Mage\n * @package    Mage_Adminhtml\n * @author     Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Adminhtml_Block_Catalog_Product_Edit_Tab_Categories",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Adminhtml_Block_Catalog_Category_Tree",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n    ",35],["T_PROTECTED","protected",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$_categoryIds",36],";",["T_WHITESPACE","\n    ",36],["T_PROTECTED","protected",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$_selectedNodes",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_STRING","null",37],";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * Specify template to use\n     *\/",39],["T_WHITESPACE","\n    ",41],["T_PUBLIC","public",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","__construct",42],"(",")",["T_WHITESPACE","\n    ",42],"{",["T_WHITESPACE","\n        ",43],["T_STRING","parent",44],["T_DOUBLE_COLON","::",44],["T_STRING","__construct",44],"(",")",";",["T_WHITESPACE","\n        ",44],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","setTemplate",45],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/product\/edit\/categories.phtml'",45],")",";",["T_WHITESPACE","\n    ",45],"}",["T_WHITESPACE","\n\n    ",46],["T_DOC_COMMENT","\/**\n     * Retrieve currently edited product\n     *\n     * @return Mage_Catalog_Model_Product\n     *\/",48],["T_WHITESPACE","\n    ",52],["T_PUBLIC","public",53],["T_WHITESPACE"," ",53],["T_FUNCTION","function",53],["T_WHITESPACE"," ",53],["T_STRING","getProduct",53],"(",")",["T_WHITESPACE","\n    ",53],"{",["T_WHITESPACE","\n        ",54],["T_RETURN","return",55],["T_WHITESPACE"," ",55],["T_STRING","Mage",55],["T_DOUBLE_COLON","::",55],["T_STRING","registry",55],"(",["T_CONSTANT_ENCAPSED_STRING","'current_product'",55],")",";",["T_WHITESPACE","\n    ",55],"}",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * Checks when this block is readonly\n     *\n     * @return boolean\n     *\/",58],["T_WHITESPACE","\n    ",62],["T_PUBLIC","public",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","isReadonly",63],"(",")",["T_WHITESPACE","\n    ",63],"{",["T_WHITESPACE","\n        ",64],["T_RETURN","return",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getProduct",65],"(",")",["T_OBJECT_OPERATOR","->",65],["T_STRING","getCategoriesReadonly",65],"(",")",";",["T_WHITESPACE","\n    ",65],"}",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * Return array with category IDs which the product is assigned to\n     *\n     * @return array\n     *\/",68],["T_WHITESPACE","\n    ",72],["T_PROTECTED","protected",73],["T_WHITESPACE"," ",73],["T_FUNCTION","function",73],["T_WHITESPACE"," ",73],["T_STRING","getCategoryIds",73],"(",")",["T_WHITESPACE","\n    ",73],"{",["T_WHITESPACE","\n        ",74],["T_RETURN","return",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getProduct",75],"(",")",["T_OBJECT_OPERATOR","->",75],["T_STRING","getCategoryIds",75],"(",")",";",["T_WHITESPACE","\n    ",75],"}",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * Forms string out of getCategoryIds()\n     *\n     * @return string\n     *\/",78],["T_WHITESPACE","\n    ",82],["T_PUBLIC","public",83],["T_WHITESPACE"," ",83],["T_FUNCTION","function",83],["T_WHITESPACE"," ",83],["T_STRING","getIdsString",83],"(",")",["T_WHITESPACE","\n    ",83],"{",["T_WHITESPACE","\n        ",84],["T_RETURN","return",85],["T_WHITESPACE"," ",85],["T_STRING","implode",85],"(",["T_CONSTANT_ENCAPSED_STRING","','",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","getCategoryIds",85],"(",")",")",";",["T_WHITESPACE","\n    ",85],"}",["T_WHITESPACE","\n\n    ",86],["T_DOC_COMMENT","\/**\n     * Returns root node and sets 'checked' flag (if necessary)\n     *\n     * @return Varien_Data_Tree_Node\n     *\/",88],["T_WHITESPACE","\n    ",92],["T_PUBLIC","public",93],["T_WHITESPACE"," ",93],["T_FUNCTION","function",93],["T_WHITESPACE"," ",93],["T_STRING","getRootNode",93],"(",")",["T_WHITESPACE","\n    ",93],"{",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$root",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getRoot",95],"(",")",";",["T_WHITESPACE","\n        ",95],["T_IF","if",96],["T_WHITESPACE"," ",96],"(",["T_VARIABLE","$root",96],["T_WHITESPACE"," ",96],["T_BOOLEAN_AND","&&",96],["T_WHITESPACE"," ",96],["T_STRING","in_array",96],"(",["T_VARIABLE","$root",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getId",96],"(",")",",",["T_WHITESPACE"," ",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getCategoryIds",96],"(",")",")",")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n            ",96],["T_VARIABLE","$root",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","setChecked",97],"(",["T_STRING","true",97],")",";",["T_WHITESPACE","\n        ",97],"}",["T_WHITESPACE","\n        ",98],["T_RETURN","return",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$root",99],";",["T_WHITESPACE","\n    ",99],"}",["T_WHITESPACE","\n\n    ",100],["T_DOC_COMMENT","\/**\n     * Returns root node\n     *\n     * @param Mage_Catalog_Model_Category|null $parentNodeCategory\n     * @param int                              $recursionLevel\n     * @return Varien_Data_Tree_Node\n     *\/",102],["T_WHITESPACE","\n    ",108],["T_PUBLIC","public",109],["T_WHITESPACE"," ",109],["T_FUNCTION","function",109],["T_WHITESPACE"," ",109],["T_STRING","getRoot",109],"(",["T_VARIABLE","$parentNodeCategory",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_STRING","null",109],",",["T_WHITESPACE"," ",109],["T_VARIABLE","$recursionLevel",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_LNUMBER","3",109],")",["T_WHITESPACE","\n    ",109],"{",["T_WHITESPACE","\n        ",110],["T_IF","if",111],["T_WHITESPACE"," ",111],"(","!",["T_STRING","is_null",111],"(",["T_VARIABLE","$parentNodeCategory",111],")",["T_WHITESPACE"," ",111],["T_BOOLEAN_AND","&&",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$parentNodeCategory",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","getId",111],"(",")",")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n            ",111],["T_RETURN","return",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","getNode",112],"(",["T_VARIABLE","$parentNodeCategory",112],",",["T_WHITESPACE"," ",112],["T_VARIABLE","$recursionLevel",112],")",";",["T_WHITESPACE","\n        ",112],"}",["T_WHITESPACE","\n        ",113],["T_VARIABLE","$root",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_STRING","Mage",114],["T_DOUBLE_COLON","::",114],["T_STRING","registry",114],"(",["T_CONSTANT_ENCAPSED_STRING","'root'",114],")",";",["T_WHITESPACE","\n        ",114],["T_IF","if",115],["T_WHITESPACE"," ",115],"(",["T_STRING","is_null",115],"(",["T_VARIABLE","$root",115],")",")",["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n            ",115],["T_VARIABLE","$storeId",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_INT_CAST","(int)",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getRequest",116],"(",")",["T_OBJECT_OPERATOR","->",116],["T_STRING","getParam",116],"(",["T_CONSTANT_ENCAPSED_STRING","'store'",116],")",";",["T_WHITESPACE","\n\n            ",116],["T_IF","if",118],["T_WHITESPACE"," ",118],"(",["T_VARIABLE","$storeId",118],")",["T_WHITESPACE"," ",118],"{",["T_WHITESPACE","\n                ",118],["T_VARIABLE","$store",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_STRING","Mage",119],["T_DOUBLE_COLON","::",119],["T_STRING","app",119],"(",")",["T_OBJECT_OPERATOR","->",119],["T_STRING","getStore",119],"(",["T_VARIABLE","$storeId",119],")",";",["T_WHITESPACE","\n                ",119],["T_VARIABLE","$rootId",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_VARIABLE","$store",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","getRootCategoryId",120],"(",")",";",["T_WHITESPACE","\n            ",120],"}",["T_WHITESPACE","\n            ",121],["T_ELSE","else",122],["T_WHITESPACE"," ",122],"{",["T_WHITESPACE","\n                ",122],["T_VARIABLE","$rootId",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_STRING","Mage_Catalog_Model_Category",123],["T_DOUBLE_COLON","::",123],["T_STRING","TREE_ROOT_ID",123],";",["T_WHITESPACE","\n            ",123],"}",["T_WHITESPACE","\n\n            ",124],["T_VARIABLE","$ids",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getSelectedCategoriesPathIds",126],"(",["T_VARIABLE","$rootId",126],")",";",["T_WHITESPACE","\n            ",126],["T_VARIABLE","$tree",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_STRING","Mage",127],["T_DOUBLE_COLON","::",127],["T_STRING","getResourceSingleton",127],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category_tree'",127],")",["T_WHITESPACE","\n                ",127],["T_OBJECT_OPERATOR","->",128],["T_STRING","loadByIds",128],"(",["T_VARIABLE","$ids",128],",",["T_WHITESPACE"," ",128],["T_STRING","false",128],",",["T_WHITESPACE"," ",128],["T_STRING","false",128],")",";",["T_WHITESPACE","\n\n            ",128],["T_IF","if",130],["T_WHITESPACE"," ",130],"(",["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getCategory",130],"(",")",")",["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n                ",130],["T_VARIABLE","$tree",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","loadEnsuredNodes",131],"(",["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","getCategory",131],"(",")",",",["T_WHITESPACE"," ",131],["T_VARIABLE","$tree",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","getNodeById",131],"(",["T_VARIABLE","$rootId",131],")",")",";",["T_WHITESPACE","\n            ",131],"}",["T_WHITESPACE","\n\n            ",132],["T_VARIABLE","$tree",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","addCollectionData",134],"(",["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","getCategoryCollection",134],"(",")",")",";",["T_WHITESPACE","\n\n            ",134],["T_VARIABLE","$root",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_VARIABLE","$tree",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getNodeById",136],"(",["T_VARIABLE","$rootId",136],")",";",["T_WHITESPACE","\n\n            ",136],["T_IF","if",138],["T_WHITESPACE"," ",138],"(",["T_VARIABLE","$root",138],["T_WHITESPACE"," ",138],["T_BOOLEAN_AND","&&",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$rootId",138],["T_WHITESPACE"," ",138],["T_IS_NOT_EQUAL","!=",138],["T_WHITESPACE"," ",138],["T_STRING","Mage_Catalog_Model_Category",138],["T_DOUBLE_COLON","::",138],["T_STRING","TREE_ROOT_ID",138],")",["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n                ",138],["T_VARIABLE","$root",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","setIsVisible",139],"(",["T_STRING","true",139],")",";",["T_WHITESPACE","\n                ",139],["T_IF","if",140],["T_WHITESPACE"," ",140],"(",["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","isReadonly",140],"(",")",")",["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n                    ",140],["T_VARIABLE","$root",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","setDisabled",141],"(",["T_STRING","true",141],")",";",["T_WHITESPACE","\n                ",141],"}",["T_WHITESPACE","\n            ",142],"}",["T_WHITESPACE","\n            ",143],["T_ELSEIF","elseif",144],"(",["T_VARIABLE","$root",144],["T_WHITESPACE"," ",144],["T_BOOLEAN_AND","&&",144],["T_WHITESPACE"," ",144],["T_VARIABLE","$root",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","getId",144],"(",")",["T_WHITESPACE"," ",144],["T_IS_EQUAL","==",144],["T_WHITESPACE"," ",144],["T_STRING","Mage_Catalog_Model_Category",144],["T_DOUBLE_COLON","::",144],["T_STRING","TREE_ROOT_ID",144],")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n                ",144],["T_VARIABLE","$root",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","setName",145],"(",["T_STRING","Mage",145],["T_DOUBLE_COLON","::",145],["T_STRING","helper",145],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",145],")",["T_OBJECT_OPERATOR","->",145],["T_STRING","__",145],"(",["T_CONSTANT_ENCAPSED_STRING","'Root'",145],")",")",";",["T_WHITESPACE","\n            ",145],"}",["T_WHITESPACE","\n\n            ",146],["T_STRING","Mage",148],["T_DOUBLE_COLON","::",148],["T_STRING","register",148],"(",["T_CONSTANT_ENCAPSED_STRING","'root'",148],",",["T_WHITESPACE"," ",148],["T_VARIABLE","$root",148],")",";",["T_WHITESPACE","\n        ",148],"}",["T_WHITESPACE","\n\n        ",149],["T_RETURN","return",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$root",151],";",["T_WHITESPACE","\n    ",151],"}",["T_WHITESPACE","\n\n    ",152],["T_DOC_COMMENT","\/**\n     * Returns array with configuration of current node\n     *\n     * @param Varien_Data_Tree_Node $node\n     * @param int                   $level How deep is the node in the tree\n     * @return array\n     *\/",154],["T_WHITESPACE","\n    ",160],["T_PROTECTED","protected",161],["T_WHITESPACE"," ",161],["T_FUNCTION","function",161],["T_WHITESPACE"," ",161],["T_STRING","_getNodeJson",161],"(",["T_VARIABLE","$node",161],",",["T_WHITESPACE"," ",161],["T_VARIABLE","$level",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_LNUMBER","1",161],")",["T_WHITESPACE","\n    ",161],"{",["T_WHITESPACE","\n        ",162],["T_VARIABLE","$item",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_STRING","parent",163],["T_DOUBLE_COLON","::",163],["T_STRING","_getNodeJson",163],"(",["T_VARIABLE","$node",163],",",["T_WHITESPACE"," ",163],["T_VARIABLE","$level",163],")",";",["T_WHITESPACE","\n\n        ",163],["T_IF","if",165],["T_WHITESPACE"," ",165],"(",["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","_isParentSelectedCategory",165],"(",["T_VARIABLE","$node",165],")",")",["T_WHITESPACE"," ",165],"{",["T_WHITESPACE","\n            ",165],["T_VARIABLE","$item",166],"[",["T_CONSTANT_ENCAPSED_STRING","'expanded'",166],"]",["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_STRING","true",166],";",["T_WHITESPACE","\n        ",166],"}",["T_WHITESPACE","\n\n        ",167],["T_IF","if",169],["T_WHITESPACE"," ",169],"(",["T_STRING","in_array",169],"(",["T_VARIABLE","$node",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","getId",169],"(",")",",",["T_WHITESPACE"," ",169],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","getCategoryIds",169],"(",")",")",")",["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n            ",169],["T_VARIABLE","$item",170],"[",["T_CONSTANT_ENCAPSED_STRING","'checked'",170],"]",["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_STRING","true",170],";",["T_WHITESPACE","\n        ",170],"}",["T_WHITESPACE","\n\n        ",171],["T_IF","if",173],["T_WHITESPACE"," ",173],"(",["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","isReadonly",173],"(",")",")",["T_WHITESPACE"," ",173],"{",["T_WHITESPACE","\n            ",173],["T_VARIABLE","$item",174],"[",["T_CONSTANT_ENCAPSED_STRING","'disabled'",174],"]",["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_STRING","true",174],";",["T_WHITESPACE","\n        ",174],"}",["T_WHITESPACE","\n\n        ",175],["T_RETURN","return",177],["T_WHITESPACE"," ",177],["T_VARIABLE","$item",177],";",["T_WHITESPACE","\n    ",177],"}",["T_WHITESPACE","\n\n    ",178],["T_DOC_COMMENT","\/**\n     * Returns whether $node is a parent (not exactly direct) of a selected node\n     *\n     * @param Varien_Data_Tree_Node $node\n     * @return bool\n     *\/",180],["T_WHITESPACE","\n    ",185],["T_PROTECTED","protected",186],["T_WHITESPACE"," ",186],["T_FUNCTION","function",186],["T_WHITESPACE"," ",186],["T_STRING","_isParentSelectedCategory",186],"(",["T_VARIABLE","$node",186],")",["T_WHITESPACE","\n    ",186],"{",["T_WHITESPACE","\n        ",187],["T_FOREACH","foreach",188],["T_WHITESPACE"," ",188],"(",["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","_getSelectedNodes",188],"(",")",["T_WHITESPACE"," ",188],["T_AS","as",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$selected",188],")",["T_WHITESPACE"," ",188],"{",["T_WHITESPACE","\n            ",188],["T_IF","if",189],["T_WHITESPACE"," ",189],"(",["T_VARIABLE","$selected",189],")",["T_WHITESPACE"," ",189],"{",["T_WHITESPACE","\n                ",189],["T_VARIABLE","$pathIds",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_STRING","explode",190],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",190],",",["T_WHITESPACE"," ",190],["T_VARIABLE","$selected",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","getPathId",190],"(",")",")",";",["T_WHITESPACE","\n                ",190],["T_IF","if",191],["T_WHITESPACE"," ",191],"(",["T_STRING","in_array",191],"(",["T_VARIABLE","$node",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","getId",191],"(",")",",",["T_WHITESPACE"," ",191],["T_VARIABLE","$pathIds",191],")",")",["T_WHITESPACE"," ",191],"{",["T_WHITESPACE","\n                    ",191],["T_RETURN","return",192],["T_WHITESPACE"," ",192],["T_STRING","true",192],";",["T_WHITESPACE","\n                ",192],"}",["T_WHITESPACE","\n            ",193],"}",["T_WHITESPACE","\n        ",194],"}",["T_WHITESPACE","\n\n        ",195],["T_RETURN","return",197],["T_WHITESPACE"," ",197],["T_STRING","false",197],";",["T_WHITESPACE","\n    ",197],"}",["T_WHITESPACE","\n\n    ",198],["T_DOC_COMMENT","\/**\n     * Returns array with nodes those are selected (contain current product)\n     *\n     * @return array\n     *\/",200],["T_WHITESPACE","\n    ",204],["T_PROTECTED","protected",205],["T_WHITESPACE"," ",205],["T_FUNCTION","function",205],["T_WHITESPACE"," ",205],["T_STRING","_getSelectedNodes",205],"(",")",["T_WHITESPACE","\n    ",205],"{",["T_WHITESPACE","\n        ",206],["T_IF","if",207],["T_WHITESPACE"," ",207],"(",["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","_selectedNodes",207],["T_WHITESPACE"," ",207],["T_IS_IDENTICAL","===",207],["T_WHITESPACE"," ",207],["T_STRING","null",207],")",["T_WHITESPACE"," ",207],"{",["T_WHITESPACE","\n            ",207],["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","_selectedNodes",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_ARRAY","array",208],"(",")",";",["T_WHITESPACE","\n            ",208],["T_VARIABLE","$root",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","getRoot",209],"(",")",";",["T_WHITESPACE","\n            ",209],["T_FOREACH","foreach",210],["T_WHITESPACE"," ",210],"(",["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","getCategoryIds",210],"(",")",["T_WHITESPACE"," ",210],["T_AS","as",210],["T_WHITESPACE"," ",210],["T_VARIABLE","$categoryId",210],")",["T_WHITESPACE"," ",210],"{",["T_WHITESPACE","\n                ",210],["T_IF","if",211],["T_WHITESPACE"," ",211],"(",["T_VARIABLE","$root",211],")",["T_WHITESPACE"," ",211],"{",["T_WHITESPACE","\n                    ",211],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","_selectedNodes",212],"[","]",["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_VARIABLE","$root",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","getTree",212],"(",")",["T_OBJECT_OPERATOR","->",212],["T_STRING","getNodeById",212],"(",["T_VARIABLE","$categoryId",212],")",";",["T_WHITESPACE","\n                ",212],"}",["T_WHITESPACE","\n            ",213],"}",["T_WHITESPACE","\n        ",214],"}",["T_WHITESPACE","\n\n        ",215],["T_RETURN","return",217],["T_WHITESPACE"," ",217],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","_selectedNodes",217],";",["T_WHITESPACE","\n    ",217],"}",["T_WHITESPACE","\n\n    ",218],["T_DOC_COMMENT","\/**\n     * Returns JSON-encoded array of category children\n     *\n     * @param int $categoryId\n     * @return string\n     *\/",220],["T_WHITESPACE","\n    ",225],["T_PUBLIC","public",226],["T_WHITESPACE"," ",226],["T_FUNCTION","function",226],["T_WHITESPACE"," ",226],["T_STRING","getCategoryChildrenJson",226],"(",["T_VARIABLE","$categoryId",226],")",["T_WHITESPACE","\n    ",226],"{",["T_WHITESPACE","\n        ",227],["T_VARIABLE","$category",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],["T_STRING","Mage",228],["T_DOUBLE_COLON","::",228],["T_STRING","getModel",228],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category'",228],")",["T_OBJECT_OPERATOR","->",228],["T_STRING","load",228],"(",["T_VARIABLE","$categoryId",228],")",";",["T_WHITESPACE","\n        ",228],["T_VARIABLE","$node",229],["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","getRoot",229],"(",["T_VARIABLE","$category",229],",",["T_WHITESPACE"," ",229],["T_LNUMBER","1",229],")",["T_OBJECT_OPERATOR","->",229],["T_STRING","getTree",229],"(",")",["T_OBJECT_OPERATOR","->",229],["T_STRING","getNodeById",229],"(",["T_VARIABLE","$categoryId",229],")",";",["T_WHITESPACE","\n\n        ",229],["T_IF","if",231],["T_WHITESPACE"," ",231],"(","!",["T_VARIABLE","$node",231],["T_WHITESPACE"," ",231],["T_BOOLEAN_OR","||",231],["T_WHITESPACE"," ",231],"!",["T_VARIABLE","$node",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","hasChildren",231],"(",")",")",["T_WHITESPACE"," ",231],"{",["T_WHITESPACE","\n            ",231],["T_RETURN","return",232],["T_WHITESPACE"," ",232],["T_CONSTANT_ENCAPSED_STRING","'[]'",232],";",["T_WHITESPACE","\n        ",232],"}",["T_WHITESPACE","\n\n        ",233],["T_VARIABLE","$children",235],["T_WHITESPACE"," ",235],"=",["T_WHITESPACE"," ",235],["T_ARRAY","array",235],"(",")",";",["T_WHITESPACE","\n        ",235],["T_FOREACH","foreach",236],["T_WHITESPACE"," ",236],"(",["T_VARIABLE","$node",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","getChildren",236],"(",")",["T_WHITESPACE"," ",236],["T_AS","as",236],["T_WHITESPACE"," ",236],["T_VARIABLE","$child",236],")",["T_WHITESPACE"," ",236],"{",["T_WHITESPACE","\n            ",236],["T_VARIABLE","$children",237],"[","]",["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","_getNodeJson",237],"(",["T_VARIABLE","$child",237],")",";",["T_WHITESPACE","\n        ",237],"}",["T_WHITESPACE","\n\n        ",238],["T_RETURN","return",240],["T_WHITESPACE"," ",240],["T_STRING","Mage",240],["T_DOUBLE_COLON","::",240],["T_STRING","helper",240],"(",["T_CONSTANT_ENCAPSED_STRING","'core'",240],")",["T_OBJECT_OPERATOR","->",240],["T_STRING","jsonEncode",240],"(",["T_VARIABLE","$children",240],")",";",["T_WHITESPACE","\n    ",240],"}",["T_WHITESPACE","\n\n    ",241],["T_DOC_COMMENT","\/**\n     * Returns URL for loading tree\n     *\n     * @param null $expanded\n     * @return string\n     *\/",243],["T_WHITESPACE","\n    ",248],["T_PUBLIC","public",249],["T_WHITESPACE"," ",249],["T_FUNCTION","function",249],["T_WHITESPACE"," ",249],["T_STRING","getLoadTreeUrl",249],"(",["T_VARIABLE","$expanded",249],["T_WHITESPACE"," ",249],"=",["T_WHITESPACE"," ",249],["T_STRING","null",249],")",["T_WHITESPACE","\n    ",249],"{",["T_WHITESPACE","\n        ",250],["T_RETURN","return",251],["T_WHITESPACE"," ",251],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","getUrl",251],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/categoriesJson'",251],",",["T_WHITESPACE"," ",251],["T_ARRAY","array",251],"(",["T_CONSTANT_ENCAPSED_STRING","'_current'",251],["T_WHITESPACE"," ",251],["T_DOUBLE_ARROW","=>",251],["T_WHITESPACE"," ",251],["T_STRING","true",251],")",")",";",["T_WHITESPACE","\n    ",251],"}",["T_WHITESPACE","\n\n    ",252],["T_DOC_COMMENT","\/**\n     * Return distinct path ids of selected categories\n     *\n     * @param mixed $rootId Root category Id for context\n     * @return array\n     *\/",254],["T_WHITESPACE","\n    ",259],["T_PUBLIC","public",260],["T_WHITESPACE"," ",260],["T_FUNCTION","function",260],["T_WHITESPACE"," ",260],["T_STRING","getSelectedCategoriesPathIds",260],"(",["T_VARIABLE","$rootId",260],["T_WHITESPACE"," ",260],"=",["T_WHITESPACE"," ",260],["T_STRING","false",260],")",["T_WHITESPACE","\n    ",260],"{",["T_WHITESPACE","\n        ",261],["T_VARIABLE","$ids",262],["T_WHITESPACE"," ",262],"=",["T_WHITESPACE"," ",262],["T_ARRAY","array",262],"(",")",";",["T_WHITESPACE","\n        ",262],["T_VARIABLE","$categoryIds",263],["T_WHITESPACE"," ",263],"=",["T_WHITESPACE"," ",263],["T_VARIABLE","$this",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","getCategoryIds",263],"(",")",";",["T_WHITESPACE","\n        ",263],["T_IF","if",264],["T_WHITESPACE"," ",264],"(",["T_EMPTY","empty",264],"(",["T_VARIABLE","$categoryIds",264],")",")",["T_WHITESPACE"," ",264],"{",["T_WHITESPACE","\n            ",264],["T_RETURN","return",265],["T_WHITESPACE"," ",265],["T_ARRAY","array",265],"(",")",";",["T_WHITESPACE","\n        ",265],"}",["T_WHITESPACE","\n        ",266],["T_VARIABLE","$collection",267],["T_WHITESPACE"," ",267],"=",["T_WHITESPACE"," ",267],["T_STRING","Mage",267],["T_DOUBLE_COLON","::",267],["T_STRING","getResourceModel",267],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog\/category_collection'",267],")",";",["T_WHITESPACE","\n\n        ",267],["T_IF","if",269],["T_WHITESPACE"," ",269],"(",["T_VARIABLE","$rootId",269],")",["T_WHITESPACE"," ",269],"{",["T_WHITESPACE","\n            ",269],["T_VARIABLE","$collection",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","addFieldToFilter",270],"(",["T_ARRAY","array",270],"(",["T_WHITESPACE","\n                ",270],["T_ARRAY","array",271],"(",["T_CONSTANT_ENCAPSED_STRING","'attribute'",271],["T_WHITESPACE"," ",271],["T_DOUBLE_ARROW","=>",271],["T_WHITESPACE"," ",271],["T_CONSTANT_ENCAPSED_STRING","'parent_id'",271],",",["T_WHITESPACE"," ",271],["T_CONSTANT_ENCAPSED_STRING","'eq'",271],["T_WHITESPACE"," ",271],["T_DOUBLE_ARROW","=>",271],["T_WHITESPACE"," ",271],["T_VARIABLE","$rootId",271],")",",",["T_WHITESPACE","\n                ",271],["T_ARRAY","array",272],"(",["T_CONSTANT_ENCAPSED_STRING","'attribute'",272],["T_WHITESPACE"," ",272],["T_DOUBLE_ARROW","=>",272],["T_WHITESPACE"," ",272],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",272],",",["T_WHITESPACE"," ",272],["T_CONSTANT_ENCAPSED_STRING","'in'",272],["T_WHITESPACE"," ",272],["T_DOUBLE_ARROW","=>",272],["T_WHITESPACE"," ",272],["T_VARIABLE","$categoryIds",272],")",["T_WHITESPACE","\n            ",272],")",")",";",["T_WHITESPACE","\n        ",273],"}",["T_WHITESPACE"," ",274],["T_ELSE","else",274],["T_WHITESPACE"," ",274],"{",["T_WHITESPACE","\n            ",274],["T_VARIABLE","$collection",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","addFieldToFilter",275],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",275],",",["T_WHITESPACE"," ",275],["T_ARRAY","array",275],"(",["T_CONSTANT_ENCAPSED_STRING","'in'",275],["T_WHITESPACE"," ",275],["T_DOUBLE_ARROW","=>",275],["T_WHITESPACE"," ",275],["T_VARIABLE","$categoryIds",275],")",")",";",["T_WHITESPACE","\n        ",275],"}",["T_WHITESPACE","\n\n        ",276],["T_FOREACH","foreach",278],["T_WHITESPACE"," ",278],"(",["T_VARIABLE","$collection",278],["T_WHITESPACE"," ",278],["T_AS","as",278],["T_WHITESPACE"," ",278],["T_VARIABLE","$item",278],")",["T_WHITESPACE"," ",278],"{",["T_WHITESPACE","\n            ",278],["T_IF","if",279],["T_WHITESPACE"," ",279],"(",["T_VARIABLE","$rootId",279],["T_WHITESPACE"," ",279],["T_BOOLEAN_AND","&&",279],["T_WHITESPACE"," ",279],"!",["T_STRING","in_array",279],"(",["T_VARIABLE","$rootId",279],",",["T_WHITESPACE"," ",279],["T_VARIABLE","$item",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","getPathIds",279],"(",")",")",")",["T_WHITESPACE"," ",279],"{",["T_WHITESPACE","\n                ",279],["T_CONTINUE","continue",280],";",["T_WHITESPACE","\n            ",280],"}",["T_WHITESPACE","\n            ",281],["T_FOREACH","foreach",282],["T_WHITESPACE"," ",282],"(",["T_VARIABLE","$item",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","getPathIds",282],"(",")",["T_WHITESPACE"," ",282],["T_AS","as",282],["T_WHITESPACE"," ",282],["T_VARIABLE","$id",282],")",["T_WHITESPACE"," ",282],"{",["T_WHITESPACE","\n                ",282],["T_IF","if",283],["T_WHITESPACE"," ",283],"(","!",["T_STRING","in_array",283],"(",["T_VARIABLE","$id",283],",",["T_WHITESPACE"," ",283],["T_VARIABLE","$ids",283],")",")",["T_WHITESPACE"," ",283],"{",["T_WHITESPACE","\n                    ",283],["T_VARIABLE","$ids",284],"[","]",["T_WHITESPACE"," ",284],"=",["T_WHITESPACE"," ",284],["T_VARIABLE","$id",284],";",["T_WHITESPACE","\n                ",284],"}",["T_WHITESPACE","\n            ",285],"}",["T_WHITESPACE","\n        ",286],"}",["T_WHITESPACE","\n        ",287],["T_RETURN","return",288],["T_WHITESPACE"," ",288],["T_VARIABLE","$ids",288],";",["T_WHITESPACE","\n    ",288],"}",["T_WHITESPACE","\n",289],"}",["T_WHITESPACE","\n",290]]