[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Adminhtml\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Adminhtml roles controller\n *\n * @category   Mage\n * @package    Mage_Adminhtml\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",33],["T_CLASS","class",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Adminhtml_Permissions_RoleController",34],["T_WHITESPACE"," ",34],["T_EXTENDS","extends",34],["T_WHITESPACE"," ",34],["T_STRING","Mage_Adminhtml_Controller_Action",34],["T_WHITESPACE","\n",34],"{",["T_WHITESPACE","\n\n    ",35],["T_DOC_COMMENT","\/**\n     * Preparing layout for output\n     *\n     * @return Mage_Adminhtml_Permissions_RoleController\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","_initAction",42],"(",")",["T_WHITESPACE","\n    ",42],"{",["T_WHITESPACE","\n        ",43],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","loadLayout",44],"(",")",";",["T_WHITESPACE","\n        ",44],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","_setActiveMenu",45],"(",["T_CONSTANT_ENCAPSED_STRING","'system\/acl'",45],")",";",["T_WHITESPACE","\n        ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","_addBreadcrumb",46],"(",["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","__",46],"(",["T_CONSTANT_ENCAPSED_STRING","'System'",46],")",",",["T_WHITESPACE"," ",46],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","__",46],"(",["T_CONSTANT_ENCAPSED_STRING","'System'",46],")",")",";",["T_WHITESPACE","\n        ",46],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","_addBreadcrumb",47],"(",["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","__",47],"(",["T_CONSTANT_ENCAPSED_STRING","'Permissions'",47],")",",",["T_WHITESPACE"," ",47],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","__",47],"(",["T_CONSTANT_ENCAPSED_STRING","'Permissions'",47],")",")",";",["T_WHITESPACE","\n        ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","_addBreadcrumb",48],"(",["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","__",48],"(",["T_CONSTANT_ENCAPSED_STRING","'Roles'",48],")",",",["T_WHITESPACE"," ",48],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","__",48],"(",["T_CONSTANT_ENCAPSED_STRING","'Roles'",48],")",")",";",["T_WHITESPACE","\n        ",48],["T_RETURN","return",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$this",49],";",["T_WHITESPACE","\n    ",49],"}",["T_WHITESPACE","\n\n    ",50],["T_DOC_COMMENT","\/**\n     * Initialize role model by passed parameter in request\n     *\n     * @return Mage_Admin_Model_Roles\n     *\/",52],["T_WHITESPACE","\n    ",56],["T_PROTECTED","protected",57],["T_WHITESPACE"," ",57],["T_FUNCTION","function",57],["T_WHITESPACE"," ",57],["T_STRING","_initRole",57],"(",["T_VARIABLE","$requestVariable",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'rid'",57],")",["T_WHITESPACE","\n    ",57],"{",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","_title",59],"(",["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","__",59],"(",["T_CONSTANT_ENCAPSED_STRING","'System'",59],")",")",["T_WHITESPACE","\n             ",59],["T_OBJECT_OPERATOR","->",60],["T_STRING","_title",60],"(",["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","__",60],"(",["T_CONSTANT_ENCAPSED_STRING","'Permissions'",60],")",")",["T_WHITESPACE","\n             ",60],["T_OBJECT_OPERATOR","->",61],["T_STRING","_title",61],"(",["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","__",61],"(",["T_CONSTANT_ENCAPSED_STRING","'Roles'",61],")",")",";",["T_WHITESPACE","\n\n        ",61],["T_VARIABLE","$role",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_STRING","Mage",63],["T_DOUBLE_COLON","::",63],["T_STRING","getModel",63],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/roles'",63],")",["T_OBJECT_OPERATOR","->",63],["T_STRING","load",63],"(",["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","getRequest",63],"(",")",["T_OBJECT_OPERATOR","->",63],["T_STRING","getParam",63],"(",["T_VARIABLE","$requestVariable",63],")",")",";",["T_WHITESPACE","\n        ",63],["T_COMMENT","\/\/ preventing edit of relation role\n",64],["T_WHITESPACE","        ",65],["T_IF","if",65],["T_WHITESPACE"," ",65],"(",["T_VARIABLE","$role",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getId",65],"(",")",["T_WHITESPACE"," ",65],["T_BOOLEAN_AND","&&",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$role",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getRoleType",65],"(",")",["T_WHITESPACE"," ",65],["T_IS_NOT_EQUAL","!=",65],["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'G'",65],")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n            ",65],["T_VARIABLE","$role",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","unsetData",66],"(",["T_VARIABLE","$role",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getIdFieldName",66],"(",")",")",";",["T_WHITESPACE","\n        ",66],"}",["T_WHITESPACE","\n\n        ",67],["T_STRING","Mage",69],["T_DOUBLE_COLON","::",69],["T_STRING","register",69],"(",["T_CONSTANT_ENCAPSED_STRING","'current_role'",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$role",69],")",";",["T_WHITESPACE","\n        ",69],["T_RETURN","return",70],["T_WHITESPACE"," ",70],["T_STRING","Mage",70],["T_DOUBLE_COLON","::",70],["T_STRING","registry",70],"(",["T_CONSTANT_ENCAPSED_STRING","'current_role'",70],")",";",["T_WHITESPACE","\n    ",70],"}",["T_WHITESPACE","\n\n    ",71],["T_DOC_COMMENT","\/**\n     * Show grid with roles existing in systems\n     *\n     *\/",73],["T_WHITESPACE","\n    ",76],["T_PUBLIC","public",77],["T_WHITESPACE"," ",77],["T_FUNCTION","function",77],["T_WHITESPACE"," ",77],["T_STRING","indexAction",77],"(",")",["T_WHITESPACE","\n    ",77],"{",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","_title",79],"(",["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","__",79],"(",["T_CONSTANT_ENCAPSED_STRING","'System'",79],")",")",["T_WHITESPACE","\n             ",79],["T_OBJECT_OPERATOR","->",80],["T_STRING","_title",80],"(",["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","__",80],"(",["T_CONSTANT_ENCAPSED_STRING","'Permissions'",80],")",")",["T_WHITESPACE","\n             ",80],["T_OBJECT_OPERATOR","->",81],["T_STRING","_title",81],"(",["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","__",81],"(",["T_CONSTANT_ENCAPSED_STRING","'Roles'",81],")",")",";",["T_WHITESPACE","\n\n        ",81],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","_initAction",83],"(",")",";",["T_WHITESPACE","\n\n        ",83],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","renderLayout",85],"(",")",";",["T_WHITESPACE","\n    ",85],"}",["T_WHITESPACE","\n\n    ",86],["T_DOC_COMMENT","\/**\n     * Action for ajax request from grid\n     *\n     *\/",88],["T_WHITESPACE","\n    ",91],["T_PUBLIC","public",92],["T_WHITESPACE"," ",92],["T_FUNCTION","function",92],["T_WHITESPACE"," ",92],["T_STRING","roleGridAction",92],"(",")",["T_WHITESPACE","\n    ",92],"{",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","loadLayout",94],"(",")",";",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getResponse",95],"(",")",["T_OBJECT_OPERATOR","->",95],["T_STRING","setBody",95],"(",["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getLayout",95],"(",")",["T_OBJECT_OPERATOR","->",95],["T_STRING","getBlock",95],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml.permission.role.grid'",95],")",["T_OBJECT_OPERATOR","->",95],["T_STRING","toHtml",95],"(",")",")",";",["T_WHITESPACE","\n    ",95],"}",["T_WHITESPACE","\n\n    ",96],["T_DOC_COMMENT","\/**\n     * Edit role action\n     *\n     *\/",98],["T_WHITESPACE","\n    ",101],["T_PUBLIC","public",102],["T_WHITESPACE"," ",102],["T_FUNCTION","function",102],["T_WHITESPACE"," ",102],["T_STRING","editRoleAction",102],"(",")",["T_WHITESPACE","\n    ",102],"{",["T_WHITESPACE","\n        ",103],["T_VARIABLE","$role",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","_initRole",104],"(",")",";",["T_WHITESPACE","\n        ",104],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","_initAction",105],"(",")",";",["T_WHITESPACE","\n\n        ",105],["T_IF","if",107],["T_WHITESPACE"," ",107],"(",["T_VARIABLE","$role",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","getId",107],"(",")",")",["T_WHITESPACE"," ",107],"{",["T_WHITESPACE","\n            ",107],["T_VARIABLE","$breadCrumb",108],["T_WHITESPACE","      ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","__",108],"(",["T_CONSTANT_ENCAPSED_STRING","'Edit Role'",108],")",";",["T_WHITESPACE","\n            ",108],["T_VARIABLE","$breadCrumbTitle",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","__",109],"(",["T_CONSTANT_ENCAPSED_STRING","'Edit Role'",109],")",";",["T_WHITESPACE","\n        ",109],"}",["T_WHITESPACE"," ",110],["T_ELSE","else",110],["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n            ",110],["T_VARIABLE","$breadCrumb",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","__",111],"(",["T_CONSTANT_ENCAPSED_STRING","'Add New Role'",111],")",";",["T_WHITESPACE","\n            ",111],["T_VARIABLE","$breadCrumbTitle",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","__",112],"(",["T_CONSTANT_ENCAPSED_STRING","'Add New Role'",112],")",";",["T_WHITESPACE","\n        ",112],"}",["T_WHITESPACE","\n\n        ",113],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","_title",115],"(",["T_VARIABLE","$role",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","getId",115],"(",")",["T_WHITESPACE"," ",115],"?",["T_WHITESPACE"," ",115],["T_VARIABLE","$role",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","getRoleName",115],"(",")",["T_WHITESPACE"," ",115],":",["T_WHITESPACE"," ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","__",115],"(",["T_CONSTANT_ENCAPSED_STRING","'New Role'",115],")",")",";",["T_WHITESPACE","\n\n        ",115],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","_addBreadcrumb",117],"(",["T_VARIABLE","$breadCrumb",117],",",["T_WHITESPACE"," ",117],["T_VARIABLE","$breadCrumbTitle",117],")",";",["T_WHITESPACE","\n\n        ",117],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getLayout",119],"(",")",["T_OBJECT_OPERATOR","->",119],["T_STRING","getBlock",119],"(",["T_CONSTANT_ENCAPSED_STRING","'head'",119],")",["T_OBJECT_OPERATOR","->",119],["T_STRING","setCanLoadExtJs",119],"(",["T_STRING","true",119],")",";",["T_WHITESPACE","\n\n        ",119],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","_addContent",121],"(",["T_WHITESPACE","\n            ",121],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","getLayout",122],"(",")",["T_OBJECT_OPERATOR","->",122],["T_STRING","createBlock",122],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/permissions_buttons'",122],")",["T_WHITESPACE","\n                ",122],["T_OBJECT_OPERATOR","->",123],["T_STRING","setRoleId",123],"(",["T_VARIABLE","$role",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getId",123],"(",")",")",["T_WHITESPACE","\n                ",123],["T_OBJECT_OPERATOR","->",124],["T_STRING","setRoleInfo",124],"(",["T_VARIABLE","$role",124],")",["T_WHITESPACE","\n                ",124],["T_OBJECT_OPERATOR","->",125],["T_STRING","setTemplate",125],"(",["T_CONSTANT_ENCAPSED_STRING","'permissions\/roleinfo.phtml'",125],")",["T_WHITESPACE","\n        ",125],")",";",["T_WHITESPACE","\n        ",126],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","_addJs",127],"(",["T_WHITESPACE","\n            ",127],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","getLayout",128],"(",")",["T_OBJECT_OPERATOR","->",128],["T_STRING","createBlock",128],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/template'",128],")",["T_OBJECT_OPERATOR","->",128],["T_STRING","setTemplate",128],"(",["T_CONSTANT_ENCAPSED_STRING","'permissions\/role_users_grid_js.phtml'",128],")",["T_WHITESPACE","\n        ",128],")",";",["T_WHITESPACE","\n        ",129],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","renderLayout",130],"(",")",";",["T_WHITESPACE","\n    ",130],"}",["T_WHITESPACE","\n\n    ",131],["T_DOC_COMMENT","\/**\n     * Remove role action\n     *\n     *\/",133],["T_WHITESPACE","\n    ",136],["T_PUBLIC","public",137],["T_WHITESPACE"," ",137],["T_FUNCTION","function",137],["T_WHITESPACE"," ",137],["T_STRING","deleteAction",137],"(",")",["T_WHITESPACE","\n    ",137],"{",["T_WHITESPACE","\n        ",138],["T_VARIABLE","$rid",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getRequest",139],"(",")",["T_OBJECT_OPERATOR","->",139],["T_STRING","getParam",139],"(",["T_CONSTANT_ENCAPSED_STRING","'rid'",139],",",["T_WHITESPACE"," ",139],["T_STRING","false",139],")",";",["T_WHITESPACE","\n\n        ",139],["T_VARIABLE","$currentUser",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_STRING","Mage",141],["T_DOUBLE_COLON","::",141],["T_STRING","getModel",141],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/user'",141],")",["T_OBJECT_OPERATOR","->",141],["T_STRING","setId",141],"(",["T_STRING","Mage",141],["T_DOUBLE_COLON","::",141],["T_STRING","getSingleton",141],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/session'",141],")",["T_OBJECT_OPERATOR","->",141],["T_STRING","getUser",141],"(",")",["T_OBJECT_OPERATOR","->",141],["T_STRING","getId",141],"(",")",")",";",["T_WHITESPACE","\n\n        ",141],["T_IF","if",143],["T_WHITESPACE"," ",143],"(",["T_STRING","in_array",143],"(",["T_VARIABLE","$rid",143],",",["T_WHITESPACE"," ",143],["T_VARIABLE","$currentUser",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getRoles",143],"(",")",")",["T_WHITESPACE"," ",143],")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n            ",143],["T_STRING","Mage",144],["T_DOUBLE_COLON","::",144],["T_STRING","getSingleton",144],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",144],")",["T_OBJECT_OPERATOR","->",144],["T_STRING","addError",144],"(",["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","__",144],"(",["T_CONSTANT_ENCAPSED_STRING","'Self-assigned roles cannot be deleted.'",144],")",")",";",["T_WHITESPACE","\n            ",144],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","_redirect",145],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/editrole'",145],",",["T_WHITESPACE"," ",145],["T_ARRAY","array",145],"(",["T_CONSTANT_ENCAPSED_STRING","'rid'",145],["T_WHITESPACE"," ",145],["T_DOUBLE_ARROW","=>",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$rid",145],")",")",";",["T_WHITESPACE","\n            ",145],["T_RETURN","return",146],";",["T_WHITESPACE","\n        ",146],"}",["T_WHITESPACE","\n\n        ",147],["T_TRY","try",149],["T_WHITESPACE"," ",149],"{",["T_WHITESPACE","\n            ",149],["T_VARIABLE","$role",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","_initRole",150],"(",")",["T_OBJECT_OPERATOR","->",150],["T_STRING","delete",150],"(",")",";",["T_WHITESPACE","\n\n            ",150],["T_STRING","Mage",152],["T_DOUBLE_COLON","::",152],["T_STRING","getSingleton",152],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",152],")",["T_OBJECT_OPERATOR","->",152],["T_STRING","addSuccess",152],"(",["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","__",152],"(",["T_CONSTANT_ENCAPSED_STRING","'The role has been deleted.'",152],")",")",";",["T_WHITESPACE","\n        ",152],"}",["T_WHITESPACE"," ",153],["T_CATCH","catch",153],["T_WHITESPACE"," ",153],"(",["T_STRING","Exception",153],["T_WHITESPACE"," ",153],["T_VARIABLE","$e",153],")",["T_WHITESPACE"," ",153],"{",["T_WHITESPACE","\n            ",153],["T_STRING","Mage",154],["T_DOUBLE_COLON","::",154],["T_STRING","getSingleton",154],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",154],")",["T_OBJECT_OPERATOR","->",154],["T_STRING","addError",154],"(",["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","__",154],"(",["T_CONSTANT_ENCAPSED_STRING","'An error occurred while deleting this role.'",154],")",")",";",["T_WHITESPACE","\n        ",154],"}",["T_WHITESPACE","\n\n        ",155],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","_redirect",157],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/'",157],")",";",["T_WHITESPACE","\n    ",157],"}",["T_WHITESPACE","\n\n    ",158],["T_DOC_COMMENT","\/**\n     * Role form submit action to save or create new role\n     *\n     *\/",160],["T_WHITESPACE","\n    ",163],["T_PUBLIC","public",164],["T_WHITESPACE"," ",164],["T_FUNCTION","function",164],["T_WHITESPACE"," ",164],["T_STRING","saveRoleAction",164],"(",")",["T_WHITESPACE","\n    ",164],"{",["T_WHITESPACE","\n        ",165],["T_VARIABLE","$rid",166],["T_WHITESPACE","        ",166],"=",["T_WHITESPACE"," ",166],["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","getRequest",166],"(",")",["T_OBJECT_OPERATOR","->",166],["T_STRING","getParam",166],"(",["T_CONSTANT_ENCAPSED_STRING","'role_id'",166],",",["T_WHITESPACE"," ",166],["T_STRING","false",166],")",";",["T_WHITESPACE","\n        ",166],["T_VARIABLE","$resource",167],["T_WHITESPACE","   ",167],"=",["T_WHITESPACE"," ",167],["T_STRING","explode",167],"(",["T_CONSTANT_ENCAPSED_STRING","','",167],",",["T_WHITESPACE"," ",167],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","getRequest",167],"(",")",["T_OBJECT_OPERATOR","->",167],["T_STRING","getParam",167],"(",["T_CONSTANT_ENCAPSED_STRING","'resource'",167],",",["T_WHITESPACE"," ",167],["T_STRING","false",167],")",")",";",["T_WHITESPACE","\n        ",167],["T_VARIABLE","$roleUsers",168],["T_WHITESPACE","  ",168],"=",["T_WHITESPACE"," ",168],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","getRequest",168],"(",")",["T_OBJECT_OPERATOR","->",168],["T_STRING","getParam",168],"(",["T_CONSTANT_ENCAPSED_STRING","'in_role_user'",168],",",["T_WHITESPACE"," ",168],["T_STRING","null",168],")",";",["T_WHITESPACE","\n        ",168],["T_STRING","parse_str",169],"(",["T_VARIABLE","$roleUsers",169],",",["T_WHITESPACE"," ",169],["T_VARIABLE","$roleUsers",169],")",";",["T_WHITESPACE","\n        ",169],["T_VARIABLE","$roleUsers",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_STRING","array_keys",170],"(",["T_VARIABLE","$roleUsers",170],")",";",["T_WHITESPACE","\n\n        ",170],["T_VARIABLE","$oldRoleUsers",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","getRequest",172],"(",")",["T_OBJECT_OPERATOR","->",172],["T_STRING","getParam",172],"(",["T_CONSTANT_ENCAPSED_STRING","'in_role_user_old'",172],")",";",["T_WHITESPACE","\n        ",172],["T_STRING","parse_str",173],"(",["T_VARIABLE","$oldRoleUsers",173],",",["T_WHITESPACE"," ",173],["T_VARIABLE","$oldRoleUsers",173],")",";",["T_WHITESPACE","\n        ",173],["T_VARIABLE","$oldRoleUsers",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_STRING","array_keys",174],"(",["T_VARIABLE","$oldRoleUsers",174],")",";",["T_WHITESPACE","\n\n        ",174],["T_VARIABLE","$isAll",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","getRequest",176],"(",")",["T_OBJECT_OPERATOR","->",176],["T_STRING","getParam",176],"(",["T_CONSTANT_ENCAPSED_STRING","'all'",176],")",";",["T_WHITESPACE","\n        ",176],["T_IF","if",177],["T_WHITESPACE"," ",177],"(",["T_VARIABLE","$isAll",177],")",["T_WHITESPACE","\n            ",177],["T_VARIABLE","$resource",178],["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_ARRAY","array",178],"(",["T_CONSTANT_ENCAPSED_STRING","'all'",178],")",";",["T_WHITESPACE","\n\n        ",178],["T_VARIABLE","$role",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","_initRole",180],"(",["T_CONSTANT_ENCAPSED_STRING","'role_id'",180],")",";",["T_WHITESPACE","\n        ",180],["T_IF","if",181],["T_WHITESPACE"," ",181],"(","!",["T_VARIABLE","$role",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","getId",181],"(",")",["T_WHITESPACE"," ",181],["T_BOOLEAN_AND","&&",181],["T_WHITESPACE"," ",181],["T_VARIABLE","$rid",181],")",["T_WHITESPACE"," ",181],"{",["T_WHITESPACE","\n            ",181],["T_STRING","Mage",182],["T_DOUBLE_COLON","::",182],["T_STRING","getSingleton",182],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",182],")",["T_OBJECT_OPERATOR","->",182],["T_STRING","addError",182],"(",["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","__",182],"(",["T_CONSTANT_ENCAPSED_STRING","'This Role no longer exists.'",182],")",")",";",["T_WHITESPACE","\n            ",182],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","_redirect",183],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/'",183],")",";",["T_WHITESPACE","\n            ",183],["T_RETURN","return",184],";",["T_WHITESPACE","\n        ",184],"}",["T_WHITESPACE","\n\n        ",185],["T_COMMENT","\/\/Validate current admin password\n",187],["T_WHITESPACE","        ",188],["T_VARIABLE","$currentPassword",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getRequest",188],"(",")",["T_OBJECT_OPERATOR","->",188],["T_STRING","getParam",188],"(",["T_CONSTANT_ENCAPSED_STRING","'current_password'",188],",",["T_WHITESPACE"," ",188],["T_STRING","null",188],")",";",["T_WHITESPACE","\n        ",188],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getRequest",189],"(",")",["T_OBJECT_OPERATOR","->",189],["T_STRING","setParam",189],"(",["T_CONSTANT_ENCAPSED_STRING","'current_password'",189],",",["T_WHITESPACE"," ",189],["T_STRING","null",189],")",";",["T_WHITESPACE","\n        ",189],["T_VARIABLE","$result",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","_validateCurrentPassword",190],"(",["T_VARIABLE","$currentPassword",190],")",";",["T_WHITESPACE","\n\n        ",190],["T_IF","if",192],["T_WHITESPACE"," ",192],"(",["T_STRING","is_array",192],"(",["T_VARIABLE","$result",192],")",")",["T_WHITESPACE"," ",192],"{",["T_WHITESPACE","\n            ",192],["T_FOREACH","foreach",193],["T_WHITESPACE"," ",193],"(",["T_VARIABLE","$result",193],["T_WHITESPACE"," ",193],["T_AS","as",193],["T_WHITESPACE"," ",193],["T_VARIABLE","$error",193],")",["T_WHITESPACE"," ",193],"{",["T_WHITESPACE","\n                ",193],["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","_getSession",194],"(",")",["T_OBJECT_OPERATOR","->",194],["T_STRING","addError",194],"(",["T_VARIABLE","$error",194],")",";",["T_WHITESPACE","\n            ",194],"}",["T_WHITESPACE","\n            ",195],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","_redirect",196],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/editrole'",196],",",["T_WHITESPACE"," ",196],["T_ARRAY","array",196],"(",["T_CONSTANT_ENCAPSED_STRING","'rid'",196],["T_WHITESPACE"," ",196],["T_DOUBLE_ARROW","=>",196],["T_WHITESPACE"," ",196],["T_VARIABLE","$rid",196],")",")",";",["T_WHITESPACE","\n            ",196],["T_RETURN","return",197],";",["T_WHITESPACE","\n        ",197],"}",["T_WHITESPACE","\n\n        ",198],["T_TRY","try",200],["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n            ",200],["T_VARIABLE","$roleName",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","getRequest",201],"(",")",["T_OBJECT_OPERATOR","->",201],["T_STRING","getParam",201],"(",["T_CONSTANT_ENCAPSED_STRING","'rolename'",201],",",["T_WHITESPACE"," ",201],["T_STRING","false",201],")",";",["T_WHITESPACE","\n\n            ",201],["T_VARIABLE","$role",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","setName",203],"(",["T_VARIABLE","$roleName",203],")",["T_WHITESPACE","\n                 ",203],["T_OBJECT_OPERATOR","->",204],["T_STRING","setPid",204],"(",["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","getRequest",204],"(",")",["T_OBJECT_OPERATOR","->",204],["T_STRING","getParam",204],"(",["T_CONSTANT_ENCAPSED_STRING","'parent_id'",204],",",["T_WHITESPACE"," ",204],["T_STRING","false",204],")",")",["T_WHITESPACE","\n                 ",204],["T_OBJECT_OPERATOR","->",205],["T_STRING","setRoleType",205],"(",["T_CONSTANT_ENCAPSED_STRING","'G'",205],")",";",["T_WHITESPACE","\n            ",205],["T_STRING","Mage",206],["T_DOUBLE_COLON","::",206],["T_STRING","dispatchEvent",206],"(",["T_WHITESPACE","\n                ",206],["T_CONSTANT_ENCAPSED_STRING","'admin_permissions_role_prepare_save'",207],",",["T_WHITESPACE","\n                ",207],["T_ARRAY","array",208],"(",["T_CONSTANT_ENCAPSED_STRING","'object'",208],["T_WHITESPACE"," ",208],["T_DOUBLE_ARROW","=>",208],["T_WHITESPACE"," ",208],["T_VARIABLE","$role",208],",",["T_WHITESPACE"," ",208],["T_CONSTANT_ENCAPSED_STRING","'request'",208],["T_WHITESPACE"," ",208],["T_DOUBLE_ARROW","=>",208],["T_WHITESPACE"," ",208],["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","getRequest",208],"(",")",")",["T_WHITESPACE","\n            ",208],")",";",["T_WHITESPACE","\n            ",209],["T_VARIABLE","$role",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","save",210],"(",")",";",["T_WHITESPACE","\n\n            ",210],["T_STRING","Mage",212],["T_DOUBLE_COLON","::",212],["T_STRING","getModel",212],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/rules'",212],")",["T_WHITESPACE","\n                ",212],["T_OBJECT_OPERATOR","->",213],["T_STRING","setRoleId",213],"(",["T_VARIABLE","$role",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","getId",213],"(",")",")",["T_WHITESPACE","\n                ",213],["T_OBJECT_OPERATOR","->",214],["T_STRING","setResources",214],"(",["T_VARIABLE","$resource",214],")",["T_WHITESPACE","\n                ",214],["T_OBJECT_OPERATOR","->",215],["T_STRING","saveRel",215],"(",")",";",["T_WHITESPACE","\n\n            ",215],["T_FOREACH","foreach",217],"(",["T_VARIABLE","$oldRoleUsers",217],["T_WHITESPACE"," ",217],["T_AS","as",217],["T_WHITESPACE"," ",217],["T_VARIABLE","$oUid",217],")",["T_WHITESPACE"," ",217],"{",["T_WHITESPACE","\n                ",217],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","_deleteUserFromRole",218],"(",["T_VARIABLE","$oUid",218],",",["T_WHITESPACE"," ",218],["T_VARIABLE","$role",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","getId",218],"(",")",")",";",["T_WHITESPACE","\n            ",218],"}",["T_WHITESPACE","\n\n            ",219],["T_FOREACH","foreach",221],["T_WHITESPACE"," ",221],"(",["T_VARIABLE","$roleUsers",221],["T_WHITESPACE"," ",221],["T_AS","as",221],["T_WHITESPACE"," ",221],["T_VARIABLE","$nRuid",221],")",["T_WHITESPACE"," ",221],"{",["T_WHITESPACE","\n                ",221],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","_addUserToRole",222],"(",["T_VARIABLE","$nRuid",222],",",["T_WHITESPACE"," ",222],["T_VARIABLE","$role",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","getId",222],"(",")",")",";",["T_WHITESPACE","\n            ",222],"}",["T_WHITESPACE","\n\n            ",223],["T_VARIABLE","$rid",225],["T_WHITESPACE"," ",225],"=",["T_WHITESPACE"," ",225],["T_VARIABLE","$role",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","getId",225],"(",")",";",["T_WHITESPACE","\n            ",225],["T_STRING","Mage",226],["T_DOUBLE_COLON","::",226],["T_STRING","getSingleton",226],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",226],")",["T_OBJECT_OPERATOR","->",226],["T_STRING","addSuccess",226],"(",["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","__",226],"(",["T_CONSTANT_ENCAPSED_STRING","'The role has been successfully saved.'",226],")",")",";",["T_WHITESPACE","\n        ",226],"}",["T_WHITESPACE"," ",227],["T_CATCH","catch",227],["T_WHITESPACE"," ",227],"(",["T_STRING","Mage_Core_Exception",227],["T_WHITESPACE"," ",227],["T_VARIABLE","$e",227],")",["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n            ",227],["T_STRING","Mage",228],["T_DOUBLE_COLON","::",228],["T_STRING","getSingleton",228],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",228],")",["T_OBJECT_OPERATOR","->",228],["T_STRING","addError",228],"(",["T_VARIABLE","$e",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getMessage",228],"(",")",")",";",["T_WHITESPACE","\n        ",228],"}",["T_WHITESPACE"," ",229],["T_CATCH","catch",229],["T_WHITESPACE"," ",229],"(",["T_STRING","Exception",229],["T_WHITESPACE"," ",229],["T_VARIABLE","$e",229],")",["T_WHITESPACE"," ",229],"{",["T_WHITESPACE","\n            ",229],["T_STRING","Mage",230],["T_DOUBLE_COLON","::",230],["T_STRING","getSingleton",230],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",230],")",["T_OBJECT_OPERATOR","->",230],["T_STRING","addError",230],"(",["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","__",230],"(",["T_CONSTANT_ENCAPSED_STRING","'An error occurred while saving this role.'",230],")",")",";",["T_WHITESPACE","\n        ",230],"}",["T_WHITESPACE","\n\n        ",231],["T_COMMENT","\/\/$this->getResponse()->setRedirect($this->getUrl(\"*\/*\/editrole\/rid\/$rid\"));\n",233],["T_WHITESPACE","        ",234],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","_redirect",234],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/'",234],")",";",["T_WHITESPACE","\n        ",234],["T_RETURN","return",235],";",["T_WHITESPACE","\n    ",235],"}",["T_WHITESPACE","\n\n    ",236],["T_DOC_COMMENT","\/**\n     * Action for ajax request from assigned users grid\n     *\n     *\/",238],["T_WHITESPACE","\n    ",241],["T_PUBLIC","public",242],["T_WHITESPACE"," ",242],["T_FUNCTION","function",242],["T_WHITESPACE"," ",242],["T_STRING","editrolegridAction",242],"(",")",["T_WHITESPACE","\n    ",242],"{",["T_WHITESPACE","\n        ",243],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","getResponse",244],"(",")",["T_OBJECT_OPERATOR","->",244],["T_STRING","setBody",244],"(",["T_WHITESPACE","\n            ",244],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","getLayout",245],"(",")",["T_OBJECT_OPERATOR","->",245],["T_STRING","createBlock",245],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/permissions_role_grid_user'",245],")",["T_OBJECT_OPERATOR","->",245],["T_STRING","toHtml",245],"(",")",["T_WHITESPACE","\n        ",245],")",";",["T_WHITESPACE","\n    ",246],"}",["T_WHITESPACE","\n\n    ",247],["T_DOC_COMMENT","\/**\n     * Remove user from role\n     *\n     * @param int $userId\n     * @param int $roleId\n     * @return bool\n     *\/",249],["T_WHITESPACE","\n    ",255],["T_PROTECTED","protected",256],["T_WHITESPACE"," ",256],["T_FUNCTION","function",256],["T_WHITESPACE"," ",256],["T_STRING","_deleteUserFromRole",256],"(",["T_VARIABLE","$userId",256],",",["T_WHITESPACE"," ",256],["T_VARIABLE","$roleId",256],")",["T_WHITESPACE","\n    ",256],"{",["T_WHITESPACE","\n        ",257],["T_TRY","try",258],["T_WHITESPACE"," ",258],"{",["T_WHITESPACE","\n            ",258],["T_STRING","Mage",259],["T_DOUBLE_COLON","::",259],["T_STRING","getModel",259],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/user'",259],")",["T_WHITESPACE","\n                ",259],["T_OBJECT_OPERATOR","->",260],["T_STRING","setRoleId",260],"(",["T_VARIABLE","$roleId",260],")",["T_WHITESPACE","\n                ",260],["T_OBJECT_OPERATOR","->",261],["T_STRING","setUserId",261],"(",["T_VARIABLE","$userId",261],")",["T_WHITESPACE","\n                ",261],["T_OBJECT_OPERATOR","->",262],["T_STRING","deleteFromRole",262],"(",")",";",["T_WHITESPACE","\n        ",262],"}",["T_WHITESPACE"," ",263],["T_CATCH","catch",263],["T_WHITESPACE"," ",263],"(",["T_STRING","Exception",263],["T_WHITESPACE"," ",263],["T_VARIABLE","$e",263],")",["T_WHITESPACE"," ",263],"{",["T_WHITESPACE","\n            ",263],["T_THROW","throw",264],["T_WHITESPACE"," ",264],["T_VARIABLE","$e",264],";",["T_WHITESPACE","\n            ",264],["T_RETURN","return",265],["T_WHITESPACE"," ",265],["T_STRING","false",265],";",["T_WHITESPACE","\n        ",265],"}",["T_WHITESPACE","\n        ",266],["T_RETURN","return",267],["T_WHITESPACE"," ",267],["T_STRING","true",267],";",["T_WHITESPACE","\n    ",267],"}",["T_WHITESPACE","\n\n    ",268],["T_DOC_COMMENT","\/**\n     * Assign user to role\n     *\n     * @param int $userId\n     * @param int $roleId\n     * @return bool\n     *\/",270],["T_WHITESPACE","\n    ",276],["T_PROTECTED","protected",277],["T_WHITESPACE"," ",277],["T_FUNCTION","function",277],["T_WHITESPACE"," ",277],["T_STRING","_addUserToRole",277],"(",["T_VARIABLE","$userId",277],",",["T_WHITESPACE"," ",277],["T_VARIABLE","$roleId",277],")",["T_WHITESPACE","\n    ",277],"{",["T_WHITESPACE","\n        ",278],["T_VARIABLE","$user",279],["T_WHITESPACE"," ",279],"=",["T_WHITESPACE"," ",279],["T_STRING","Mage",279],["T_DOUBLE_COLON","::",279],["T_STRING","getModel",279],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/user'",279],")",["T_OBJECT_OPERATOR","->",279],["T_STRING","load",279],"(",["T_VARIABLE","$userId",279],")",";",["T_WHITESPACE","\n        ",279],["T_VARIABLE","$user",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","setRoleId",280],"(",["T_VARIABLE","$roleId",280],")",["T_OBJECT_OPERATOR","->",280],["T_STRING","setUserId",280],"(",["T_VARIABLE","$userId",280],")",";",["T_WHITESPACE","\n\n        ",280],["T_IF","if",282],"(",["T_WHITESPACE"," ",282],["T_VARIABLE","$user",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","roleUserExists",282],"(",")",["T_WHITESPACE"," ",282],["T_IS_IDENTICAL","===",282],["T_WHITESPACE"," ",282],["T_STRING","true",282],["T_WHITESPACE"," ",282],")",["T_WHITESPACE"," ",282],"{",["T_WHITESPACE","\n            ",282],["T_RETURN","return",283],["T_WHITESPACE"," ",283],["T_STRING","false",283],";",["T_WHITESPACE","\n        ",283],"}",["T_WHITESPACE"," ",284],["T_ELSE","else",284],["T_WHITESPACE"," ",284],"{",["T_WHITESPACE","\n            ",284],["T_VARIABLE","$user",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","add",285],"(",")",";",["T_WHITESPACE","\n            ",285],["T_RETURN","return",286],["T_WHITESPACE"," ",286],["T_STRING","true",286],";",["T_WHITESPACE","\n        ",286],"}",["T_WHITESPACE","\n    ",287],"}",["T_WHITESPACE","\n\n    ",288],["T_DOC_COMMENT","\/**\n     * Acl checking\n     *\n     * @return bool\n     *\/",290],["T_WHITESPACE","\n    ",294],["T_PROTECTED","protected",295],["T_WHITESPACE"," ",295],["T_FUNCTION","function",295],["T_WHITESPACE"," ",295],["T_STRING","_isAllowed",295],"(",")",["T_WHITESPACE","\n    ",295],"{",["T_WHITESPACE","\n        ",296],["T_RETURN","return",297],["T_WHITESPACE"," ",297],["T_STRING","Mage",297],["T_DOUBLE_COLON","::",297],["T_STRING","getSingleton",297],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/session'",297],")",["T_OBJECT_OPERATOR","->",297],["T_STRING","isAllowed",297],"(",["T_CONSTANT_ENCAPSED_STRING","'system\/acl\/roles'",297],")",";",["T_WHITESPACE","\n    ",297],"}",["T_WHITESPACE","\n\n    ",298],["T_DOC_COMMENT","\/**\n     * Action to refresh role-rule relations.\n     * This method will make sure the rendered ACL resource tree checkboxes match the actual ACL permissions.\n     * To be used after adding a new ACL resource via config\n     *\/",300],["T_WHITESPACE","\n    ",304],["T_PUBLIC","public",305],["T_WHITESPACE"," ",305],["T_FUNCTION","function",305],["T_WHITESPACE"," ",305],["T_STRING","refreshRolesAction",305],"(",")",["T_WHITESPACE","\n    ",305],"{",["T_WHITESPACE","\n        ",306],["T_VARIABLE","$resourceAcl",307],["T_WHITESPACE"," ",307],"=",["T_WHITESPACE"," ",307],["T_STRING","Mage",307],["T_DOUBLE_COLON","::",307],["T_STRING","getResourceModel",307],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/acl'",307],")",["T_OBJECT_OPERATOR","->",307],["T_STRING","loadAcl",307],"(",")",";",["T_WHITESPACE","\n        ",307],["T_VARIABLE","$roles",308],["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],["T_STRING","Mage",308],["T_DOUBLE_COLON","::",308],["T_STRING","getResourceModel",308],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/role_collection'",308],")",["T_OBJECT_OPERATOR","->",308],["T_STRING","setRolesFilter",308],"(",")",["T_OBJECT_OPERATOR","->",308],["T_STRING","getItems",308],"(",")",";",["T_WHITESPACE","\n        ",308],["T_TRY","try",309],["T_WHITESPACE"," ",309],"{",["T_WHITESPACE","\n            ",309],["T_FOREACH","foreach",310],["T_WHITESPACE"," ",310],"(",["T_VARIABLE","$roles",310],["T_WHITESPACE"," ",310],["T_AS","as",310],["T_WHITESPACE"," ",310],["T_VARIABLE","$role",310],")",["T_WHITESPACE"," ",310],"{",["T_WHITESPACE","\n                ",310],["T_VARIABLE","$roleTypeId",311],["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],["T_VARIABLE","$role",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","getRoleType",311],"(",")",["T_WHITESPACE"," ",311],".",["T_WHITESPACE"," ",311],["T_VARIABLE","$role",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","getRoleId",311],"(",")",";",["T_WHITESPACE","\n                ",311],["T_VARIABLE","$selectedResourceIds",312],["T_WHITESPACE"," ",312],"=",["T_WHITESPACE"," ",312],["T_ARRAY","array",312],"(",")",";",["T_WHITESPACE","\n                ",312],["T_IF","if",313],["T_WHITESPACE"," ",313],"(",["T_VARIABLE","$resourceAcl",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","isAllowed",313],"(",["T_VARIABLE","$roleTypeId",313],",",["T_WHITESPACE"," ",313],["T_CONSTANT_ENCAPSED_STRING","'all'",313],")",")",["T_WHITESPACE"," ",313],"{",["T_WHITESPACE","\n                    ",313],["T_VARIABLE","$selectedResourceIds",314],["T_WHITESPACE"," ",314],"=",["T_WHITESPACE"," ",314],["T_ARRAY","array",314],"(",["T_CONSTANT_ENCAPSED_STRING","'all'",314],")",";",["T_WHITESPACE","\n                ",314],"}",["T_WHITESPACE"," ",315],["T_ELSE","else",315],["T_WHITESPACE"," ",315],"{",["T_WHITESPACE","\n                    ",315],["T_FOREACH","foreach",316],["T_WHITESPACE"," ",316],"(",["T_VARIABLE","$resourceAcl",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","getResources",316],"(",")",["T_WHITESPACE"," ",316],["T_AS","as",316],["T_WHITESPACE"," ",316],["T_VARIABLE","$resource",316],")",["T_WHITESPACE"," ",316],"{",["T_WHITESPACE","\n                        ",316],["T_IF","if",317],["T_WHITESPACE"," ",317],"(",["T_VARIABLE","$resourceAcl",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","isAllowed",317],"(",["T_VARIABLE","$roleTypeId",317],",",["T_WHITESPACE"," ",317],["T_VARIABLE","$resource",317],")",")",["T_WHITESPACE"," ",317],"{",["T_WHITESPACE","\n                            ",317],["T_STRING","array_push",318],"(",["T_VARIABLE","$selectedResourceIds",318],",",["T_WHITESPACE"," ",318],["T_VARIABLE","$resource",318],")",";",["T_WHITESPACE","\n                        ",318],"}",["T_WHITESPACE","\n                    ",319],"}",["T_WHITESPACE","\n                ",320],"}",["T_WHITESPACE","\n\n                ",321],["T_STRING","Mage",323],["T_DOUBLE_COLON","::",323],["T_STRING","getModel",323],"(",["T_CONSTANT_ENCAPSED_STRING","'admin\/rules'",323],")",["T_WHITESPACE","\n                    ",323],["T_OBJECT_OPERATOR","->",324],["T_STRING","setRoleId",324],"(",["T_VARIABLE","$role",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","getId",324],"(",")",")",["T_WHITESPACE","\n                    ",324],["T_OBJECT_OPERATOR","->",325],["T_STRING","setResources",325],"(",["T_VARIABLE","$selectedResourceIds",325],")",["T_WHITESPACE","\n                    ",325],["T_OBJECT_OPERATOR","->",326],["T_STRING","saveRel",326],"(",")",";",["T_WHITESPACE","\n            ",326],"}",["T_WHITESPACE","\n\n            ",327],["T_STRING","Mage",329],["T_DOUBLE_COLON","::",329],["T_STRING","getSingleton",329],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",329],")",["T_OBJECT_OPERATOR","->",329],["T_STRING","addSuccess",329],"(",["T_VARIABLE","$this",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","__",329],"(",["T_CONSTANT_ENCAPSED_STRING","'The roles have been refreshed.'",329],")",")",";",["T_WHITESPACE","\n        ",329],"}",["T_WHITESPACE"," ",330],["T_CATCH","catch",330],["T_WHITESPACE"," ",330],"(",["T_STRING","Mage_Core_Exception",330],["T_WHITESPACE"," ",330],["T_VARIABLE","$e",330],")",["T_WHITESPACE"," ",330],"{",["T_WHITESPACE","\n            ",330],["T_STRING","Mage",331],["T_DOUBLE_COLON","::",331],["T_STRING","getSingleton",331],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",331],")",["T_OBJECT_OPERATOR","->",331],["T_STRING","addError",331],"(",["T_VARIABLE","$e",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","getMessage",331],"(",")",")",";",["T_WHITESPACE","\n        ",331],"}",["T_WHITESPACE"," ",332],["T_CATCH","catch",332],["T_WHITESPACE"," ",332],"(",["T_STRING","Exception",332],["T_WHITESPACE"," ",332],["T_VARIABLE","$e",332],")",["T_WHITESPACE"," ",332],"{",["T_WHITESPACE","\n            ",332],["T_STRING","Mage",333],["T_DOUBLE_COLON","::",333],["T_STRING","logException",333],"(",["T_VARIABLE","$e",333],")",";",["T_WHITESPACE","\n            ",333],["T_STRING","Mage",334],["T_DOUBLE_COLON","::",334],["T_STRING","getSingleton",334],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/session'",334],")",["T_OBJECT_OPERATOR","->",334],["T_STRING","addError",334],"(",["T_VARIABLE","$this",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","__",334],"(",["T_CONSTANT_ENCAPSED_STRING","'An error occurred while refreshing roles.'",334],")",")",";",["T_WHITESPACE","\n        ",334],"}",["T_WHITESPACE","\n\n        ",335],["T_VARIABLE","$this",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","_redirect",337],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/'",337],")",";",["T_WHITESPACE","\n        ",337],["T_RETURN","return",338],";",["T_WHITESPACE","\n    ",338],"}",["T_WHITESPACE","\n",339],"}",["T_WHITESPACE","\n",340]]