[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Newsletter\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Subscriber model\n *\n * @method Mage_Newsletter_Model_Resource_Subscriber _getResource()\n * @method Mage_Newsletter_Model_Resource_Subscriber getResource()\n * @method int getStoreId()\n * @method Mage_Newsletter_Model_Subscriber setStoreId(int $value)\n * @method string getChangeStatusAt()\n * @method Mage_Newsletter_Model_Subscriber setChangeStatusAt(string $value)\n * @method int getCustomerId()\n * @method Mage_Newsletter_Model_Subscriber setCustomerId(int $value)\n * @method string getSubscriberEmail()\n * @method Mage_Newsletter_Model_Subscriber setSubscriberEmail(string $value)\n * @method int getSubscriberStatus()\n * @method Mage_Newsletter_Model_Subscriber setSubscriberStatus(int $value)\n * @method string getSubscriberConfirmCode()\n * @method Mage_Newsletter_Model_Subscriber setSubscriberConfirmCode(string $value)\n *\n * @category    Mage\n * @package     Mage_Newsletter\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",48],["T_CLASS","class",49],["T_WHITESPACE"," ",49],["T_STRING","Mage_Newsletter_Model_Subscriber",49],["T_WHITESPACE"," ",49],["T_EXTENDS","extends",49],["T_WHITESPACE"," ",49],["T_STRING","Mage_Core_Model_Abstract",49],["T_WHITESPACE","\n",49],"{",["T_WHITESPACE","\n    ",50],["T_CONST","const",51],["T_WHITESPACE"," ",51],["T_STRING","STATUS_SUBSCRIBED",51],["T_WHITESPACE","     ",51],"=",["T_WHITESPACE"," ",51],["T_LNUMBER","1",51],";",["T_WHITESPACE","\n    ",51],["T_CONST","const",52],["T_WHITESPACE"," ",52],["T_STRING","STATUS_NOT_ACTIVE",52],["T_WHITESPACE","     ",52],"=",["T_WHITESPACE"," ",52],["T_LNUMBER","2",52],";",["T_WHITESPACE","\n    ",52],["T_CONST","const",53],["T_WHITESPACE"," ",53],["T_STRING","STATUS_UNSUBSCRIBED",53],["T_WHITESPACE","   ",53],"=",["T_WHITESPACE"," ",53],["T_LNUMBER","3",53],";",["T_WHITESPACE","\n    ",53],["T_CONST","const",54],["T_WHITESPACE"," ",54],["T_STRING","STATUS_UNCONFIRMED",54],["T_WHITESPACE","    ",54],"=",["T_WHITESPACE"," ",54],["T_LNUMBER","4",54],";",["T_WHITESPACE","\n\n    ",54],["T_CONST","const",56],["T_WHITESPACE"," ",56],["T_STRING","XML_PATH_CONFIRM_EMAIL_TEMPLATE",56],["T_WHITESPACE","       ",56],"=",["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'newsletter\/subscription\/confirm_email_template'",56],";",["T_WHITESPACE","\n    ",56],["T_CONST","const",57],["T_WHITESPACE"," ",57],["T_STRING","XML_PATH_CONFIRM_EMAIL_IDENTITY",57],["T_WHITESPACE","       ",57],"=",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'newsletter\/subscription\/confirm_email_identity'",57],";",["T_WHITESPACE","\n    ",57],["T_CONST","const",58],["T_WHITESPACE"," ",58],["T_STRING","XML_PATH_SUCCESS_EMAIL_TEMPLATE",58],["T_WHITESPACE","       ",58],"=",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'newsletter\/subscription\/success_email_template'",58],";",["T_WHITESPACE","\n    ",58],["T_CONST","const",59],["T_WHITESPACE"," ",59],["T_STRING","XML_PATH_SUCCESS_EMAIL_IDENTITY",59],["T_WHITESPACE","       ",59],"=",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'newsletter\/subscription\/success_email_identity'",59],";",["T_WHITESPACE","\n    ",59],["T_CONST","const",60],["T_WHITESPACE"," ",60],["T_STRING","XML_PATH_UNSUBSCRIBE_EMAIL_TEMPLATE",60],["T_WHITESPACE","   ",60],"=",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'newsletter\/subscription\/un_email_template'",60],";",["T_WHITESPACE","\n    ",60],["T_CONST","const",61],["T_WHITESPACE"," ",61],["T_STRING","XML_PATH_UNSUBSCRIBE_EMAIL_IDENTITY",61],["T_WHITESPACE","   ",61],"=",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'newsletter\/subscription\/un_email_identity'",61],";",["T_WHITESPACE","\n    ",61],["T_CONST","const",62],["T_WHITESPACE"," ",62],["T_STRING","XML_PATH_CONFIRMATION_FLAG",62],["T_WHITESPACE","            ",62],"=",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'newsletter\/subscription\/confirm'",62],";",["T_WHITESPACE","\n    ",62],["T_CONST","const",63],["T_WHITESPACE"," ",63],["T_STRING","XML_PATH_ALLOW_GUEST_SUBSCRIBE_FLAG",63],["T_WHITESPACE","   ",63],"=",["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","'newsletter\/subscription\/allow_guest_subscribe'",63],";",["T_WHITESPACE","\n\n    ",63],["T_DOC_COMMENT","\/**\n     * @deprecated since 1.4.0.1\n     *\/",65],["T_WHITESPACE","\n    ",67],["T_CONST","const",68],["T_WHITESPACE"," ",68],["T_STRING","XML_PATH_SENDING_SET_RETURN_PATH",68],["T_WHITESPACE","      ",68],"=",["T_WHITESPACE"," ",68],["T_STRING","Mage_Core_Model_Email_Template",68],["T_DOUBLE_COLON","::",68],["T_STRING","XML_PATH_SENDING_SET_RETURN_PATH",68],";",["T_WHITESPACE","\n\n    ",68],["T_DOC_COMMENT","\/**\n     * Prefix of model events names\n     *\n     * @var string\n     *\/",70],["T_WHITESPACE","\n    ",74],["T_PROTECTED","protected",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$_eventPrefix",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'newsletter_subscriber'",75],";",["T_WHITESPACE","\n\n    ",75],["T_DOC_COMMENT","\/**\n     * Parameter name in event\n     *\n     * In observe method you can use $observer->getEvent()->getObject() in this case\n     *\n     * @var string\n     *\/",77],["T_WHITESPACE","\n    ",83],["T_PROTECTED","protected",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$_eventObject",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_CONSTANT_ENCAPSED_STRING","'subscriber'",84],";",["T_WHITESPACE","\n\n    ",84],["T_DOC_COMMENT","\/**\n     * True if data changed\n     *\n     * @var bool\n     *\/",86],["T_WHITESPACE","\n    ",90],["T_PROTECTED","protected",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$_isStatusChanged",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_STRING","false",91],";",["T_WHITESPACE","\n\n    ",91],["T_DOC_COMMENT","\/**\n     * Initialize resource model\n     *\/",93],["T_WHITESPACE","\n    ",95],["T_PROTECTED","protected",96],["T_WHITESPACE"," ",96],["T_FUNCTION","function",96],["T_WHITESPACE"," ",96],["T_STRING","_construct",96],"(",")",["T_WHITESPACE","\n    ",96],"{",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","_init",98],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter\/subscriber'",98],")",";",["T_WHITESPACE","\n    ",98],"}",["T_WHITESPACE","\n\n    ",99],["T_DOC_COMMENT","\/**\n     * Alias for getSubscriberId()\n     *\n     * @return int\n     *\/",101],["T_WHITESPACE","\n    ",105],["T_PUBLIC","public",106],["T_WHITESPACE"," ",106],["T_FUNCTION","function",106],["T_WHITESPACE"," ",106],["T_STRING","getId",106],"(",")",["T_WHITESPACE","\n    ",106],"{",["T_WHITESPACE","\n        ",107],["T_RETURN","return",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getSubscriberId",108],"(",")",";",["T_WHITESPACE","\n    ",108],"}",["T_WHITESPACE","\n\n    ",109],["T_DOC_COMMENT","\/**\n     * Alias for setSubscriberId()\n     *\n     * @param int $value\n     *\/",111],["T_WHITESPACE","\n    ",115],["T_PUBLIC","public",116],["T_WHITESPACE"," ",116],["T_FUNCTION","function",116],["T_WHITESPACE"," ",116],["T_STRING","setId",116],"(",["T_VARIABLE","$value",116],")",["T_WHITESPACE","\n    ",116],"{",["T_WHITESPACE","\n        ",117],["T_RETURN","return",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","setSubscriberId",118],"(",["T_VARIABLE","$value",118],")",";",["T_WHITESPACE","\n    ",118],"}",["T_WHITESPACE","\n\n    ",119],["T_DOC_COMMENT","\/**\n     * Alias for getSubscriberConfirmCode()\n     *\n     * @return string\n     *\/",121],["T_WHITESPACE","\n    ",125],["T_PUBLIC","public",126],["T_WHITESPACE"," ",126],["T_FUNCTION","function",126],["T_WHITESPACE"," ",126],["T_STRING","getCode",126],"(",")",["T_WHITESPACE","\n    ",126],"{",["T_WHITESPACE","\n        ",127],["T_RETURN","return",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","getSubscriberConfirmCode",128],"(",")",";",["T_WHITESPACE","\n    ",128],"}",["T_WHITESPACE","\n\n    ",129],["T_DOC_COMMENT","\/**\n     * Return link for confirmation of subscription\n     *\n     * @return string\n     *\/",131],["T_WHITESPACE","\n    ",135],["T_PUBLIC","public",136],["T_WHITESPACE"," ",136],["T_FUNCTION","function",136],["T_WHITESPACE"," ",136],["T_STRING","getConfirmationLink",136],"(",")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n        ",136],["T_RETURN","return",137],["T_WHITESPACE"," ",137],["T_STRING","Mage",137],["T_DOUBLE_COLON","::",137],["T_STRING","helper",137],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter'",137],")",["T_OBJECT_OPERATOR","->",137],["T_STRING","getConfirmationUrl",137],"(",["T_VARIABLE","$this",137],")",";",["T_WHITESPACE","\n    ",137],"}",["T_WHITESPACE","\n\n    ",138],["T_DOC_COMMENT","\/**\n     * Returns Insubscribe url\n     *\n     * @return string\n     *\/",140],["T_WHITESPACE","\n    ",144],["T_PUBLIC","public",145],["T_WHITESPACE"," ",145],["T_FUNCTION","function",145],["T_WHITESPACE"," ",145],["T_STRING","getUnsubscriptionLink",145],"(",")",["T_WHITESPACE"," ",145],"{",["T_WHITESPACE","\n        ",145],["T_RETURN","return",146],["T_WHITESPACE"," ",146],["T_STRING","Mage",146],["T_DOUBLE_COLON","::",146],["T_STRING","helper",146],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter'",146],")",["T_OBJECT_OPERATOR","->",146],["T_STRING","getUnsubscribeUrl",146],"(",["T_VARIABLE","$this",146],")",";",["T_WHITESPACE","\n    ",146],"}",["T_WHITESPACE","\n\n    ",147],["T_DOC_COMMENT","\/**\n     * Alias for setSubscriberConfirmCode()\n     *\n     * @param string $value\n     *\/",149],["T_WHITESPACE","\n    ",153],["T_PUBLIC","public",154],["T_WHITESPACE"," ",154],["T_FUNCTION","function",154],["T_WHITESPACE"," ",154],["T_STRING","setCode",154],"(",["T_VARIABLE","$value",154],")",["T_WHITESPACE","\n    ",154],"{",["T_WHITESPACE","\n        ",155],["T_RETURN","return",156],["T_WHITESPACE"," ",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","setSubscriberConfirmCode",156],"(",["T_VARIABLE","$value",156],")",";",["T_WHITESPACE","\n    ",156],"}",["T_WHITESPACE","\n\n    ",157],["T_DOC_COMMENT","\/**\n     * Alias for getSubscriberStatus()\n     *\n     * @return int\n     *\/",159],["T_WHITESPACE","\n    ",163],["T_PUBLIC","public",164],["T_WHITESPACE"," ",164],["T_FUNCTION","function",164],["T_WHITESPACE"," ",164],["T_STRING","getStatus",164],"(",")",["T_WHITESPACE","\n    ",164],"{",["T_WHITESPACE","\n        ",165],["T_RETURN","return",166],["T_WHITESPACE"," ",166],["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","getSubscriberStatus",166],"(",")",";",["T_WHITESPACE","\n    ",166],"}",["T_WHITESPACE","\n\n    ",167],["T_DOC_COMMENT","\/**\n     * Alias for setSubscriberStatus()\n     *\n     * @param int\n     *\/",169],["T_WHITESPACE","\n    ",173],["T_PUBLIC","public",174],["T_WHITESPACE"," ",174],["T_FUNCTION","function",174],["T_WHITESPACE"," ",174],["T_STRING","setStatus",174],"(",["T_VARIABLE","$value",174],")",["T_WHITESPACE","\n    ",174],"{",["T_WHITESPACE","\n        ",175],["T_RETURN","return",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","setSubscriberStatus",176],"(",["T_VARIABLE","$value",176],")",";",["T_WHITESPACE","\n    ",176],"}",["T_WHITESPACE","\n\n    ",177],["T_DOC_COMMENT","\/**\n     * Set the error messages scope for subscription\n     *\n     * @param boolean $scope\n     * @return Mage_Newsletter_Model_Subscriber\n     *\/",179],["T_WHITESPACE","\n\n    ",184],["T_PUBLIC","public",186],["T_WHITESPACE"," ",186],["T_FUNCTION","function",186],["T_WHITESPACE"," ",186],["T_STRING","setMessagesScope",186],"(",["T_VARIABLE","$scope",186],")",["T_WHITESPACE","\n    ",186],"{",["T_WHITESPACE","\n        ",187],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getResource",188],"(",")",["T_OBJECT_OPERATOR","->",188],["T_STRING","setMessagesScope",188],"(",["T_VARIABLE","$scope",188],")",";",["T_WHITESPACE","\n        ",188],["T_RETURN","return",189],["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],";",["T_WHITESPACE","\n    ",189],"}",["T_WHITESPACE","\n\n    ",190],["T_DOC_COMMENT","\/**\n     * Alias for getSubscriberEmail()\n     *\n     * @return string\n     *\/",192],["T_WHITESPACE","\n    ",196],["T_PUBLIC","public",197],["T_WHITESPACE"," ",197],["T_FUNCTION","function",197],["T_WHITESPACE"," ",197],["T_STRING","getEmail",197],"(",")",["T_WHITESPACE","\n    ",197],"{",["T_WHITESPACE","\n        ",198],["T_RETURN","return",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","getSubscriberEmail",199],"(",")",";",["T_WHITESPACE","\n    ",199],"}",["T_WHITESPACE","\n\n    ",200],["T_DOC_COMMENT","\/**\n     * Alias for setSubscriberEmail()\n     *\n     * @param string $value\n     *\/",202],["T_WHITESPACE","\n    ",206],["T_PUBLIC","public",207],["T_WHITESPACE"," ",207],["T_FUNCTION","function",207],["T_WHITESPACE"," ",207],["T_STRING","setEmail",207],"(",["T_VARIABLE","$value",207],")",["T_WHITESPACE","\n    ",207],"{",["T_WHITESPACE","\n        ",208],["T_RETURN","return",209],["T_WHITESPACE"," ",209],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","setSubscriberEmail",209],"(",["T_VARIABLE","$value",209],")",";",["T_WHITESPACE","\n    ",209],"}",["T_WHITESPACE","\n\n    ",210],["T_DOC_COMMENT","\/**\n     * Set for status change flag\n     *\n     * @param boolean $value\n     *\/",212],["T_WHITESPACE","\n    ",216],["T_PUBLIC","public",217],["T_WHITESPACE"," ",217],["T_FUNCTION","function",217],["T_WHITESPACE"," ",217],["T_STRING","setIsStatusChanged",217],"(",["T_VARIABLE","$value",217],")",["T_WHITESPACE","\n    ",217],"{",["T_WHITESPACE","\n        ",218],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","_isStatusChanged",219],["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],["T_BOOL_CAST","(boolean)",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$value",219],";",["T_WHITESPACE","\n           ",219],["T_RETURN","return",220],["T_WHITESPACE"," ",220],["T_VARIABLE","$this",220],";",["T_WHITESPACE","\n    ",220],"}",["T_WHITESPACE","\n\n    ",221],["T_DOC_COMMENT","\/**\n     * Return status change flag value\n     *\n     * @return boolean\n     *\/",223],["T_WHITESPACE","\n    ",227],["T_PUBLIC","public",228],["T_WHITESPACE"," ",228],["T_FUNCTION","function",228],["T_WHITESPACE"," ",228],["T_STRING","getIsStatusChanged",228],"(",")",["T_WHITESPACE","\n    ",228],"{",["T_WHITESPACE","\n        ",229],["T_RETURN","return",230],["T_WHITESPACE"," ",230],["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","_isStatusChanged",230],";",["T_WHITESPACE","\n    ",230],"}",["T_WHITESPACE","\n\n    ",231],["T_DOC_COMMENT","\/**\n     * Return customer subscription status\n     *\n     * @return bool\n     *\/",233],["T_WHITESPACE","\n    ",237],["T_PUBLIC","public",238],["T_WHITESPACE"," ",238],["T_FUNCTION","function",238],["T_WHITESPACE"," ",238],["T_STRING","isSubscribed",238],"(",")",["T_WHITESPACE","\n    ",238],"{",["T_WHITESPACE","\n        ",239],["T_IF","if",240],"(",["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","getId",240],"(",")",["T_WHITESPACE"," ",240],["T_BOOLEAN_AND","&&",240],["T_WHITESPACE"," ",240],["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","getStatus",240],"(",")",["T_IS_EQUAL","==",240],["T_STRING","self",240],["T_DOUBLE_COLON","::",240],["T_STRING","STATUS_SUBSCRIBED",240],")",["T_WHITESPACE"," ",240],"{",["T_WHITESPACE","\n            ",240],["T_RETURN","return",241],["T_WHITESPACE"," ",241],["T_STRING","true",241],";",["T_WHITESPACE","\n        ",241],"}",["T_WHITESPACE","\n\n        ",242],["T_RETURN","return",244],["T_WHITESPACE"," ",244],["T_STRING","false",244],";",["T_WHITESPACE","\n    ",244],"}",["T_WHITESPACE","\n\n\n     ",245],["T_DOC_COMMENT","\/**\n     * Load subscriber data from resource model by email\n     *\n     * @param int $subscriberId\n     *\/",248],["T_WHITESPACE","\n    ",252],["T_PUBLIC","public",253],["T_WHITESPACE"," ",253],["T_FUNCTION","function",253],["T_WHITESPACE"," ",253],["T_STRING","loadByEmail",253],"(",["T_VARIABLE","$subscriberEmail",253],")",["T_WHITESPACE","\n    ",253],"{",["T_WHITESPACE","\n        ",254],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","addData",255],"(",["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","getResource",255],"(",")",["T_OBJECT_OPERATOR","->",255],["T_STRING","loadByEmail",255],"(",["T_VARIABLE","$subscriberEmail",255],")",")",";",["T_WHITESPACE","\n        ",255],["T_RETURN","return",256],["T_WHITESPACE"," ",256],["T_VARIABLE","$this",256],";",["T_WHITESPACE","\n    ",256],"}",["T_WHITESPACE","\n\n    ",257],["T_DOC_COMMENT","\/**\n     * Load subscriber info by customer\n     *\n     * @param Mage_Customer_Model_Customer $customer\n     * @return Mage_Newsletter_Model_Subscriber\n     *\/",259],["T_WHITESPACE","\n    ",264],["T_PUBLIC","public",265],["T_WHITESPACE"," ",265],["T_FUNCTION","function",265],["T_WHITESPACE"," ",265],["T_STRING","loadByCustomer",265],"(",["T_STRING","Mage_Customer_Model_Customer",265],["T_WHITESPACE"," ",265],["T_VARIABLE","$customer",265],")",["T_WHITESPACE","\n    ",265],"{",["T_WHITESPACE","\n        ",266],["T_VARIABLE","$data",267],["T_WHITESPACE"," ",267],"=",["T_WHITESPACE"," ",267],["T_VARIABLE","$this",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","getResource",267],"(",")",["T_OBJECT_OPERATOR","->",267],["T_STRING","loadByCustomer",267],"(",["T_VARIABLE","$customer",267],")",";",["T_WHITESPACE","\n        ",267],["T_VARIABLE","$this",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","addData",268],"(",["T_VARIABLE","$data",268],")",";",["T_WHITESPACE","\n        ",268],["T_IF","if",269],["T_WHITESPACE"," ",269],"(","!",["T_EMPTY","empty",269],"(",["T_VARIABLE","$data",269],")",["T_WHITESPACE"," ",269],["T_BOOLEAN_AND","&&",269],["T_WHITESPACE"," ",269],["T_VARIABLE","$customer",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","getId",269],"(",")",["T_WHITESPACE"," ",269],["T_BOOLEAN_AND","&&",269],["T_WHITESPACE"," ",269],"!",["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","getCustomerId",269],"(",")",")",["T_WHITESPACE"," ",269],"{",["T_WHITESPACE","\n            ",269],["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","setCustomerId",270],"(",["T_VARIABLE","$customer",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","getId",270],"(",")",")",";",["T_WHITESPACE","\n            ",270],["T_VARIABLE","$this",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","setSubscriberConfirmCode",271],"(",["T_VARIABLE","$this",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","randomSequence",271],"(",")",")",";",["T_WHITESPACE","\n            ",271],["T_IF","if",272],["T_WHITESPACE"," ",272],"(",["T_VARIABLE","$this",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","getStatus",272],"(",")",["T_IS_EQUAL","==",272],["T_STRING","self",272],["T_DOUBLE_COLON","::",272],["T_STRING","STATUS_NOT_ACTIVE",272],")",["T_WHITESPACE"," ",272],"{",["T_WHITESPACE","\n                ",272],["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","setStatus",273],"(",["T_VARIABLE","$customer",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","getIsSubscribed",273],"(",")",["T_WHITESPACE"," ",273],"?",["T_WHITESPACE"," ",273],["T_STRING","self",273],["T_DOUBLE_COLON","::",273],["T_STRING","STATUS_SUBSCRIBED",273],["T_WHITESPACE"," ",273],":",["T_WHITESPACE"," ",273],["T_STRING","self",273],["T_DOUBLE_COLON","::",273],["T_STRING","STATUS_UNSUBSCRIBED",273],")",";",["T_WHITESPACE","\n            ",273],"}",["T_WHITESPACE","\n            ",274],["T_VARIABLE","$this",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","save",275],"(",")",";",["T_WHITESPACE","\n        ",275],"}",["T_WHITESPACE","\n        ",276],["T_RETURN","return",277],["T_WHITESPACE"," ",277],["T_VARIABLE","$this",277],";",["T_WHITESPACE","\n    ",277],"}",["T_WHITESPACE","\n\n    ",278],["T_DOC_COMMENT","\/**\n     * Returns sting of random chars\n     *\n     * @param int $length\n     * @return string\n     *\/",280],["T_WHITESPACE","\n    ",285],["T_PUBLIC","public",286],["T_WHITESPACE"," ",286],["T_FUNCTION","function",286],["T_WHITESPACE"," ",286],["T_STRING","randomSequence",286],"(",["T_VARIABLE","$length",286],"=",["T_LNUMBER","32",286],")",["T_WHITESPACE","\n    ",286],"{",["T_WHITESPACE","\n        ",287],["T_VARIABLE","$id",288],["T_WHITESPACE"," ",288],"=",["T_WHITESPACE"," ",288],["T_CONSTANT_ENCAPSED_STRING","''",288],";",["T_WHITESPACE","\n        ",288],["T_VARIABLE","$par",289],["T_WHITESPACE"," ",289],"=",["T_WHITESPACE"," ",289],["T_ARRAY","array",289],"(",")",";",["T_WHITESPACE","\n        ",289],["T_VARIABLE","$char",290],["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],["T_STRING","array_merge",290],"(",["T_STRING","range",290],"(",["T_CONSTANT_ENCAPSED_STRING","'a'",290],",",["T_CONSTANT_ENCAPSED_STRING","'z'",290],")",",",["T_STRING","range",290],"(",["T_LNUMBER","0",290],",",["T_LNUMBER","9",290],")",")",";",["T_WHITESPACE","\n        ",290],["T_VARIABLE","$charLen",291],["T_WHITESPACE"," ",291],"=",["T_WHITESPACE"," ",291],["T_STRING","count",291],"(",["T_VARIABLE","$char",291],")","-",["T_LNUMBER","1",291],";",["T_WHITESPACE","\n        ",291],["T_FOR","for",292],["T_WHITESPACE"," ",292],"(",["T_VARIABLE","$i",292],"=",["T_LNUMBER","0",292],";",["T_VARIABLE","$i",292],"<",["T_VARIABLE","$length",292],";",["T_VARIABLE","$i",292],["T_INC","++",292],")","{",["T_WHITESPACE","\n            ",292],["T_VARIABLE","$disc",293],["T_WHITESPACE"," ",293],"=",["T_WHITESPACE"," ",293],["T_STRING","mt_rand",293],"(",["T_LNUMBER","0",293],",",["T_WHITESPACE"," ",293],["T_VARIABLE","$charLen",293],")",";",["T_WHITESPACE","\n            ",293],["T_VARIABLE","$par",294],"[",["T_VARIABLE","$i",294],"]",["T_WHITESPACE"," ",294],"=",["T_WHITESPACE"," ",294],["T_VARIABLE","$char",294],"[",["T_VARIABLE","$disc",294],"]",";",["T_WHITESPACE","\n            ",294],["T_VARIABLE","$id",295],["T_WHITESPACE"," ",295],"=",["T_WHITESPACE"," ",295],["T_VARIABLE","$id",295],".",["T_VARIABLE","$char",295],"[",["T_VARIABLE","$disc",295],"]",";",["T_WHITESPACE","\n        ",295],"}",["T_WHITESPACE","\n        ",296],["T_RETURN","return",297],["T_WHITESPACE"," ",297],["T_VARIABLE","$id",297],";",["T_WHITESPACE","\n    ",297],"}",["T_WHITESPACE","\n\n    ",298],["T_DOC_COMMENT","\/**\n     * Subscribes by email\n     *\n     * @param string $email\n     * @throws Exception\n     * @return int\n     *\/",300],["T_WHITESPACE","\n    ",306],["T_PUBLIC","public",307],["T_WHITESPACE"," ",307],["T_FUNCTION","function",307],["T_WHITESPACE"," ",307],["T_STRING","subscribe",307],"(",["T_VARIABLE","$email",307],")",["T_WHITESPACE","\n    ",307],"{",["T_WHITESPACE","\n        ",308],["T_VARIABLE","$this",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","loadByEmail",309],"(",["T_VARIABLE","$email",309],")",";",["T_WHITESPACE","\n        ",309],["T_VARIABLE","$customerSession",310],["T_WHITESPACE"," ",310],"=",["T_WHITESPACE"," ",310],["T_STRING","Mage",310],["T_DOUBLE_COLON","::",310],["T_STRING","getSingleton",310],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/session'",310],")",";",["T_WHITESPACE","\n\n        ",310],["T_IF","if",312],"(","!",["T_VARIABLE","$this",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","getId",312],"(",")",")",["T_WHITESPACE"," ",312],"{",["T_WHITESPACE","\n            ",312],["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","setSubscriberConfirmCode",313],"(",["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","randomSequence",313],"(",")",")",";",["T_WHITESPACE","\n        ",313],"}",["T_WHITESPACE","\n\n        ",314],["T_VARIABLE","$isConfirmNeed",316],["T_WHITESPACE","   ",316],"=",["T_WHITESPACE"," ",316],"(",["T_STRING","Mage",316],["T_DOUBLE_COLON","::",316],["T_STRING","getStoreConfig",316],"(",["T_STRING","self",316],["T_DOUBLE_COLON","::",316],["T_STRING","XML_PATH_CONFIRMATION_FLAG",316],")",["T_WHITESPACE"," ",316],["T_IS_EQUAL","==",316],["T_WHITESPACE"," ",316],["T_LNUMBER","1",316],")",["T_WHITESPACE"," ",316],"?",["T_WHITESPACE"," ",316],["T_STRING","true",316],["T_WHITESPACE"," ",316],":",["T_WHITESPACE"," ",316],["T_STRING","false",316],";",["T_WHITESPACE","\n        ",316],["T_VARIABLE","$isOwnSubscribes",317],["T_WHITESPACE"," ",317],"=",["T_WHITESPACE"," ",317],["T_STRING","false",317],";",["T_WHITESPACE","\n        ",317],["T_VARIABLE","$ownerId",318],["T_WHITESPACE"," ",318],"=",["T_WHITESPACE"," ",318],["T_STRING","Mage",318],["T_DOUBLE_COLON","::",318],["T_STRING","getModel",318],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/customer'",318],")",["T_WHITESPACE","\n            ",318],["T_OBJECT_OPERATOR","->",319],["T_STRING","setWebsiteId",319],"(",["T_STRING","Mage",319],["T_DOUBLE_COLON","::",319],["T_STRING","app",319],"(",")",["T_OBJECT_OPERATOR","->",319],["T_STRING","getStore",319],"(",")",["T_OBJECT_OPERATOR","->",319],["T_STRING","getWebsiteId",319],"(",")",")",["T_WHITESPACE","\n            ",319],["T_OBJECT_OPERATOR","->",320],["T_STRING","loadByEmail",320],"(",["T_VARIABLE","$email",320],")",["T_WHITESPACE","\n            ",320],["T_OBJECT_OPERATOR","->",321],["T_STRING","getId",321],"(",")",";",["T_WHITESPACE","\n        ",321],["T_VARIABLE","$isSubscribeOwnEmail",322],["T_WHITESPACE"," ",322],"=",["T_WHITESPACE"," ",322],["T_VARIABLE","$customerSession",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","isLoggedIn",322],"(",")",["T_WHITESPACE"," ",322],["T_BOOLEAN_AND","&&",322],["T_WHITESPACE"," ",322],["T_VARIABLE","$ownerId",322],["T_WHITESPACE"," ",322],["T_IS_EQUAL","==",322],["T_WHITESPACE"," ",322],["T_VARIABLE","$customerSession",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","getId",322],"(",")",";",["T_WHITESPACE","\n\n        ",322],["T_IF","if",324],["T_WHITESPACE"," ",324],"(","!",["T_VARIABLE","$this",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","getId",324],"(",")",["T_WHITESPACE"," ",324],["T_BOOLEAN_OR","||",324],["T_WHITESPACE"," ",324],["T_VARIABLE","$this",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","getStatus",324],"(",")",["T_WHITESPACE"," ",324],["T_IS_EQUAL","==",324],["T_WHITESPACE"," ",324],["T_STRING","self",324],["T_DOUBLE_COLON","::",324],["T_STRING","STATUS_UNSUBSCRIBED",324],["T_WHITESPACE","\n            ",324],["T_BOOLEAN_OR","||",325],["T_WHITESPACE"," ",325],["T_VARIABLE","$this",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","getStatus",325],"(",")",["T_WHITESPACE"," ",325],["T_IS_EQUAL","==",325],["T_WHITESPACE"," ",325],["T_STRING","self",325],["T_DOUBLE_COLON","::",325],["T_STRING","STATUS_NOT_ACTIVE",325],["T_WHITESPACE","\n        ",325],")",["T_WHITESPACE"," ",326],"{",["T_WHITESPACE","\n            ",326],["T_IF","if",327],["T_WHITESPACE"," ",327],"(",["T_VARIABLE","$isConfirmNeed",327],["T_WHITESPACE"," ",327],["T_IS_IDENTICAL","===",327],["T_WHITESPACE"," ",327],["T_STRING","true",327],")",["T_WHITESPACE"," ",327],"{",["T_WHITESPACE","\n                ",327],["T_COMMENT","\/\/ if user subscribes own login email - confirmation is not needed\n",328],["T_WHITESPACE","                ",329],["T_VARIABLE","$isOwnSubscribes",329],["T_WHITESPACE"," ",329],"=",["T_WHITESPACE"," ",329],["T_VARIABLE","$isSubscribeOwnEmail",329],";",["T_WHITESPACE","\n                ",329],["T_IF","if",330],["T_WHITESPACE"," ",330],"(",["T_VARIABLE","$isOwnSubscribes",330],["T_WHITESPACE"," ",330],["T_IS_EQUAL","==",330],["T_WHITESPACE"," ",330],["T_STRING","true",330],")","{",["T_WHITESPACE","\n                    ",330],["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","setStatus",331],"(",["T_STRING","self",331],["T_DOUBLE_COLON","::",331],["T_STRING","STATUS_SUBSCRIBED",331],")",";",["T_WHITESPACE","\n                ",331],"}",["T_WHITESPACE"," ",332],["T_ELSE","else",332],["T_WHITESPACE"," ",332],"{",["T_WHITESPACE","\n                    ",332],["T_VARIABLE","$this",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","setStatus",333],"(",["T_STRING","self",333],["T_DOUBLE_COLON","::",333],["T_STRING","STATUS_NOT_ACTIVE",333],")",";",["T_WHITESPACE","\n                ",333],"}",["T_WHITESPACE","\n            ",334],"}",["T_WHITESPACE"," ",335],["T_ELSE","else",335],["T_WHITESPACE"," ",335],"{",["T_WHITESPACE","\n                ",335],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","setStatus",336],"(",["T_STRING","self",336],["T_DOUBLE_COLON","::",336],["T_STRING","STATUS_SUBSCRIBED",336],")",";",["T_WHITESPACE","\n            ",336],"}",["T_WHITESPACE","\n            ",337],["T_VARIABLE","$this",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","setSubscriberEmail",338],"(",["T_VARIABLE","$email",338],")",";",["T_WHITESPACE","\n        ",338],"}",["T_WHITESPACE","\n\n        ",339],["T_IF","if",341],["T_WHITESPACE"," ",341],"(",["T_VARIABLE","$isSubscribeOwnEmail",341],")",["T_WHITESPACE"," ",341],"{",["T_WHITESPACE","\n            ",341],["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","setStoreId",342],"(",["T_VARIABLE","$customerSession",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","getCustomer",342],"(",")",["T_OBJECT_OPERATOR","->",342],["T_STRING","getStoreId",342],"(",")",")",";",["T_WHITESPACE","\n            ",342],["T_VARIABLE","$this",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","setCustomerId",343],"(",["T_VARIABLE","$customerSession",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","getCustomerId",343],"(",")",")",";",["T_WHITESPACE","\n        ",343],"}",["T_WHITESPACE"," ",344],["T_ELSE","else",344],["T_WHITESPACE"," ",344],"{",["T_WHITESPACE","\n            ",344],["T_VARIABLE","$this",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","setStoreId",345],"(",["T_STRING","Mage",345],["T_DOUBLE_COLON","::",345],["T_STRING","app",345],"(",")",["T_OBJECT_OPERATOR","->",345],["T_STRING","getStore",345],"(",")",["T_OBJECT_OPERATOR","->",345],["T_STRING","getId",345],"(",")",")",";",["T_WHITESPACE","\n            ",345],["T_VARIABLE","$this",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","setCustomerId",346],"(",["T_LNUMBER","0",346],")",";",["T_WHITESPACE","\n        ",346],"}",["T_WHITESPACE","\n\n        ",347],["T_VARIABLE","$this",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","setIsStatusChanged",349],"(",["T_STRING","true",349],")",";",["T_WHITESPACE","\n\n        ",349],["T_TRY","try",351],["T_WHITESPACE"," ",351],"{",["T_WHITESPACE","\n            ",351],["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","save",352],"(",")",";",["T_WHITESPACE","\n            ",352],["T_IF","if",353],["T_WHITESPACE"," ",353],"(",["T_VARIABLE","$isConfirmNeed",353],["T_WHITESPACE"," ",353],["T_IS_IDENTICAL","===",353],["T_WHITESPACE"," ",353],["T_STRING","true",353],["T_WHITESPACE","\n                ",353],["T_BOOLEAN_AND","&&",354],["T_WHITESPACE"," ",354],["T_VARIABLE","$isOwnSubscribes",354],["T_WHITESPACE"," ",354],["T_IS_IDENTICAL","===",354],["T_WHITESPACE"," ",354],["T_STRING","false",354],["T_WHITESPACE","\n            ",354],")",["T_WHITESPACE"," ",355],"{",["T_WHITESPACE","\n                ",355],["T_VARIABLE","$this",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","sendConfirmationRequestEmail",356],"(",")",";",["T_WHITESPACE","\n            ",356],"}",["T_WHITESPACE"," ",357],["T_ELSE","else",357],["T_WHITESPACE"," ",357],"{",["T_WHITESPACE","\n                ",357],["T_VARIABLE","$this",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","sendConfirmationSuccessEmail",358],"(",")",";",["T_WHITESPACE","\n            ",358],"}",["T_WHITESPACE","\n\n            ",359],["T_RETURN","return",361],["T_WHITESPACE"," ",361],["T_VARIABLE","$this",361],["T_OBJECT_OPERATOR","->",361],["T_STRING","getStatus",361],"(",")",";",["T_WHITESPACE","\n        ",361],"}",["T_WHITESPACE"," ",362],["T_CATCH","catch",362],["T_WHITESPACE"," ",362],"(",["T_STRING","Exception",362],["T_WHITESPACE"," ",362],["T_VARIABLE","$e",362],")",["T_WHITESPACE"," ",362],"{",["T_WHITESPACE","\n            ",362],["T_THROW","throw",363],["T_WHITESPACE"," ",363],["T_NEW","new",363],["T_WHITESPACE"," ",363],["T_STRING","Exception",363],"(",["T_VARIABLE","$e",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","getMessage",363],"(",")",")",";",["T_WHITESPACE","\n        ",363],"}",["T_WHITESPACE","\n    ",364],"}",["T_WHITESPACE","\n\n    ",365],["T_DOC_COMMENT","\/**\n     * Unsubscribes loaded subscription\n     *\n     *\/",367],["T_WHITESPACE","\n    ",370],["T_PUBLIC","public",371],["T_WHITESPACE"," ",371],["T_FUNCTION","function",371],["T_WHITESPACE"," ",371],["T_STRING","unsubscribe",371],"(",")",["T_WHITESPACE","\n    ",371],"{",["T_WHITESPACE","\n        ",372],["T_IF","if",373],["T_WHITESPACE"," ",373],"(",["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","hasCheckCode",373],"(",")",["T_WHITESPACE"," ",373],["T_BOOLEAN_AND","&&",373],["T_WHITESPACE"," ",373],["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","getCode",373],"(",")",["T_WHITESPACE"," ",373],["T_IS_NOT_EQUAL","!=",373],["T_WHITESPACE"," ",373],["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","getCheckCode",373],"(",")",")",["T_WHITESPACE"," ",373],"{",["T_WHITESPACE","\n            ",373],["T_STRING","Mage",374],["T_DOUBLE_COLON","::",374],["T_STRING","throwException",374],"(",["T_STRING","Mage",374],["T_DOUBLE_COLON","::",374],["T_STRING","helper",374],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter'",374],")",["T_OBJECT_OPERATOR","->",374],["T_STRING","__",374],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid subscription confirmation code.'",374],")",")",";",["T_WHITESPACE","\n        ",374],"}",["T_WHITESPACE","\n\n        ",375],["T_VARIABLE","$this",377],["T_OBJECT_OPERATOR","->",377],["T_STRING","setSubscriberStatus",377],"(",["T_STRING","self",377],["T_DOUBLE_COLON","::",377],["T_STRING","STATUS_UNSUBSCRIBED",377],")",["T_WHITESPACE","\n            ",377],["T_OBJECT_OPERATOR","->",378],["T_STRING","save",378],"(",")",";",["T_WHITESPACE","\n        ",378],["T_VARIABLE","$this",379],["T_OBJECT_OPERATOR","->",379],["T_STRING","sendUnsubscriptionEmail",379],"(",")",";",["T_WHITESPACE","\n        ",379],["T_RETURN","return",380],["T_WHITESPACE"," ",380],["T_VARIABLE","$this",380],";",["T_WHITESPACE","\n    ",380],"}",["T_WHITESPACE","\n\n    ",381],["T_DOC_COMMENT","\/**\n     * Saving customer subscription status\n     *\n     * @param   Mage_Customer_Model_Customer $customer\n     * @return  Mage_Newsletter_Model_Subscriber\n     *\/",383],["T_WHITESPACE","\n    ",388],["T_PUBLIC","public",389],["T_WHITESPACE"," ",389],["T_FUNCTION","function",389],["T_WHITESPACE"," ",389],["T_STRING","subscribeCustomer",389],"(",["T_VARIABLE","$customer",389],")",["T_WHITESPACE","\n    ",389],"{",["T_WHITESPACE","\n        ",390],["T_VARIABLE","$this",391],["T_OBJECT_OPERATOR","->",391],["T_STRING","loadByCustomer",391],"(",["T_VARIABLE","$customer",391],")",";",["T_WHITESPACE","\n\n        ",391],["T_IF","if",393],["T_WHITESPACE"," ",393],"(",["T_VARIABLE","$customer",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","getImportMode",393],"(",")",")",["T_WHITESPACE"," ",393],"{",["T_WHITESPACE","\n            ",393],["T_VARIABLE","$this",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","setImportMode",394],"(",["T_STRING","true",394],")",";",["T_WHITESPACE","\n        ",394],"}",["T_WHITESPACE","\n\n        ",395],["T_IF","if",397],["T_WHITESPACE"," ",397],"(","!",["T_VARIABLE","$customer",397],["T_OBJECT_OPERATOR","->",397],["T_STRING","getIsSubscribed",397],"(",")",["T_WHITESPACE"," ",397],["T_BOOLEAN_AND","&&",397],["T_WHITESPACE"," ",397],"!",["T_VARIABLE","$this",397],["T_OBJECT_OPERATOR","->",397],["T_STRING","getId",397],"(",")",")",["T_WHITESPACE"," ",397],"{",["T_WHITESPACE","\n            ",397],["T_COMMENT","\/\/ If subscription flag not set or customer is not a subscriber\n",398],["T_WHITESPACE","            ",399],["T_COMMENT","\/\/ and no subscribe below\n",399],["T_WHITESPACE","            ",400],["T_RETURN","return",400],["T_WHITESPACE"," ",400],["T_VARIABLE","$this",400],";",["T_WHITESPACE","\n        ",400],"}",["T_WHITESPACE","\n\n        ",401],["T_IF","if",403],"(","!",["T_VARIABLE","$this",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","getId",403],"(",")",")",["T_WHITESPACE"," ",403],"{",["T_WHITESPACE","\n            ",403],["T_VARIABLE","$this",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","setSubscriberConfirmCode",404],"(",["T_VARIABLE","$this",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","randomSequence",404],"(",")",")",";",["T_WHITESPACE","\n        ",404],"}",["T_WHITESPACE","\n\n       ",405],["T_COMMENT","\/*\n        * Logical mismatch between customer registration confirmation code and customer password confirmation\n        *\/",407],["T_WHITESPACE","\n       ",409],["T_VARIABLE","$confirmation",410],["T_WHITESPACE"," ",410],"=",["T_WHITESPACE"," ",410],["T_STRING","null",410],";",["T_WHITESPACE","\n       ",410],["T_IF","if",411],["T_WHITESPACE"," ",411],"(",["T_VARIABLE","$customer",411],["T_OBJECT_OPERATOR","->",411],["T_STRING","isConfirmationRequired",411],"(",")",["T_WHITESPACE"," ",411],["T_BOOLEAN_AND","&&",411],["T_WHITESPACE"," ",411],"(",["T_VARIABLE","$customer",411],["T_OBJECT_OPERATOR","->",411],["T_STRING","getConfirmation",411],"(",")",["T_WHITESPACE"," ",411],["T_IS_NOT_EQUAL","!=",411],["T_WHITESPACE"," ",411],["T_VARIABLE","$customer",411],["T_OBJECT_OPERATOR","->",411],["T_STRING","getPassword",411],"(",")",")",")",["T_WHITESPACE"," ",411],"{",["T_WHITESPACE","\n           ",411],["T_VARIABLE","$confirmation",412],["T_WHITESPACE"," ",412],"=",["T_WHITESPACE"," ",412],["T_VARIABLE","$customer",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","getConfirmation",412],"(",")",";",["T_WHITESPACE","\n       ",412],"}",["T_WHITESPACE","\n\n        ",413],["T_VARIABLE","$sendInformationEmail",415],["T_WHITESPACE"," ",415],"=",["T_WHITESPACE"," ",415],["T_STRING","false",415],";",["T_WHITESPACE","\n        ",415],["T_IF","if",416],["T_WHITESPACE"," ",416],"(",["T_VARIABLE","$customer",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","hasIsSubscribed",416],"(",")",")",["T_WHITESPACE"," ",416],"{",["T_WHITESPACE","\n            ",416],["T_VARIABLE","$status",417],["T_WHITESPACE"," ",417],"=",["T_WHITESPACE"," ",417],["T_VARIABLE","$customer",417],["T_OBJECT_OPERATOR","->",417],["T_STRING","getIsSubscribed",417],"(",")",["T_WHITESPACE","\n                ",417],"?",["T_WHITESPACE"," ",418],"(","!",["T_STRING","is_null",418],"(",["T_VARIABLE","$confirmation",418],")",["T_WHITESPACE"," ",418],"?",["T_WHITESPACE"," ",418],["T_STRING","self",418],["T_DOUBLE_COLON","::",418],["T_STRING","STATUS_UNCONFIRMED",418],["T_WHITESPACE"," ",418],":",["T_WHITESPACE"," ",418],["T_STRING","self",418],["T_DOUBLE_COLON","::",418],["T_STRING","STATUS_SUBSCRIBED",418],")",["T_WHITESPACE","\n                ",418],":",["T_WHITESPACE"," ",419],["T_STRING","self",419],["T_DOUBLE_COLON","::",419],["T_STRING","STATUS_UNSUBSCRIBED",419],";",["T_WHITESPACE","\n            ",419],["T_DOC_COMMENT","\/**\n             * If subscription status has been changed then send email to the customer\n             *\/",420],["T_WHITESPACE","\n            ",422],["T_IF","if",423],["T_WHITESPACE"," ",423],"(",["T_VARIABLE","$status",423],["T_WHITESPACE"," ",423],["T_IS_NOT_EQUAL","!=",423],["T_WHITESPACE"," ",423],["T_STRING","self",423],["T_DOUBLE_COLON","::",423],["T_STRING","STATUS_UNCONFIRMED",423],["T_WHITESPACE"," ",423],["T_BOOLEAN_AND","&&",423],["T_WHITESPACE"," ",423],["T_VARIABLE","$status",423],["T_WHITESPACE"," ",423],["T_IS_NOT_EQUAL","!=",423],["T_WHITESPACE"," ",423],["T_VARIABLE","$this",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","getStatus",423],"(",")",")",["T_WHITESPACE"," ",423],"{",["T_WHITESPACE","\n                ",423],["T_VARIABLE","$sendInformationEmail",424],["T_WHITESPACE"," ",424],"=",["T_WHITESPACE"," ",424],["T_STRING","true",424],";",["T_WHITESPACE","\n            ",424],"}",["T_WHITESPACE","\n        ",425],"}",["T_WHITESPACE"," ",426],["T_ELSEIF","elseif",426],["T_WHITESPACE"," ",426],"(","(",["T_VARIABLE","$this",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","getStatus",426],"(",")",["T_WHITESPACE"," ",426],["T_IS_EQUAL","==",426],["T_WHITESPACE"," ",426],["T_STRING","self",426],["T_DOUBLE_COLON","::",426],["T_STRING","STATUS_UNCONFIRMED",426],")",["T_WHITESPACE"," ",426],["T_BOOLEAN_AND","&&",426],["T_WHITESPACE"," ",426],"(",["T_STRING","is_null",426],"(",["T_VARIABLE","$confirmation",426],")",")",")",["T_WHITESPACE"," ",426],"{",["T_WHITESPACE","\n            ",426],["T_VARIABLE","$status",427],["T_WHITESPACE"," ",427],"=",["T_WHITESPACE"," ",427],["T_STRING","self",427],["T_DOUBLE_COLON","::",427],["T_STRING","STATUS_SUBSCRIBED",427],";",["T_WHITESPACE","\n            ",427],["T_VARIABLE","$sendInformationEmail",428],["T_WHITESPACE"," ",428],"=",["T_WHITESPACE"," ",428],["T_STRING","true",428],";",["T_WHITESPACE","\n        ",428],"}",["T_WHITESPACE"," ",429],["T_ELSE","else",429],["T_WHITESPACE"," ",429],"{",["T_WHITESPACE","\n            ",429],["T_VARIABLE","$status",430],["T_WHITESPACE"," ",430],"=",["T_WHITESPACE"," ",430],"(",["T_VARIABLE","$this",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","getStatus",430],"(",")",["T_WHITESPACE"," ",430],["T_IS_EQUAL","==",430],["T_WHITESPACE"," ",430],["T_STRING","self",430],["T_DOUBLE_COLON","::",430],["T_STRING","STATUS_NOT_ACTIVE",430],["T_WHITESPACE"," ",430],"?",["T_WHITESPACE"," ",430],["T_STRING","self",430],["T_DOUBLE_COLON","::",430],["T_STRING","STATUS_UNSUBSCRIBED",430],["T_WHITESPACE"," ",430],":",["T_WHITESPACE"," ",430],["T_VARIABLE","$this",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","getStatus",430],"(",")",")",";",["T_WHITESPACE","\n        ",430],"}",["T_WHITESPACE","\n\n        ",431],["T_IF","if",433],"(",["T_VARIABLE","$status",433],["T_WHITESPACE"," ",433],["T_IS_NOT_EQUAL","!=",433],["T_WHITESPACE"," ",433],["T_VARIABLE","$this",433],["T_OBJECT_OPERATOR","->",433],["T_STRING","getStatus",433],"(",")",")",["T_WHITESPACE"," ",433],"{",["T_WHITESPACE","\n            ",433],["T_VARIABLE","$this",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","setIsStatusChanged",434],"(",["T_STRING","true",434],")",";",["T_WHITESPACE","\n        ",434],"}",["T_WHITESPACE","\n\n        ",435],["T_VARIABLE","$this",437],["T_OBJECT_OPERATOR","->",437],["T_STRING","setStatus",437],"(",["T_VARIABLE","$status",437],")",";",["T_WHITESPACE","\n\n        ",437],["T_IF","if",439],"(","!",["T_VARIABLE","$this",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","getId",439],"(",")",")",["T_WHITESPACE"," ",439],"{",["T_WHITESPACE","\n            ",439],["T_VARIABLE","$storeId",440],["T_WHITESPACE"," ",440],"=",["T_WHITESPACE"," ",440],["T_VARIABLE","$customer",440],["T_OBJECT_OPERATOR","->",440],["T_STRING","getStoreId",440],"(",")",";",["T_WHITESPACE","\n            ",440],["T_IF","if",441],["T_WHITESPACE"," ",441],"(",["T_VARIABLE","$customer",441],["T_OBJECT_OPERATOR","->",441],["T_STRING","getStoreId",441],"(",")",["T_WHITESPACE"," ",441],["T_IS_EQUAL","==",441],["T_WHITESPACE"," ",441],["T_LNUMBER","0",441],")",["T_WHITESPACE"," ",441],"{",["T_WHITESPACE","\n                ",441],["T_VARIABLE","$storeId",442],["T_WHITESPACE"," ",442],"=",["T_WHITESPACE"," ",442],["T_STRING","Mage",442],["T_DOUBLE_COLON","::",442],["T_STRING","app",442],"(",")",["T_OBJECT_OPERATOR","->",442],["T_STRING","getWebsite",442],"(",["T_VARIABLE","$customer",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","getWebsiteId",442],"(",")",")",["T_OBJECT_OPERATOR","->",442],["T_STRING","getDefaultStore",442],"(",")",["T_OBJECT_OPERATOR","->",442],["T_STRING","getId",442],"(",")",";",["T_WHITESPACE","\n            ",442],"}",["T_WHITESPACE","\n            ",443],["T_VARIABLE","$this",444],["T_OBJECT_OPERATOR","->",444],["T_STRING","setStoreId",444],"(",["T_VARIABLE","$storeId",444],")",["T_WHITESPACE","\n                ",444],["T_OBJECT_OPERATOR","->",445],["T_STRING","setCustomerId",445],"(",["T_VARIABLE","$customer",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","getId",445],"(",")",")",["T_WHITESPACE","\n                ",445],["T_OBJECT_OPERATOR","->",446],["T_STRING","setEmail",446],"(",["T_VARIABLE","$customer",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","getEmail",446],"(",")",")",";",["T_WHITESPACE","\n        ",446],"}",["T_WHITESPACE"," ",447],["T_ELSE","else",447],["T_WHITESPACE"," ",447],"{",["T_WHITESPACE","\n            ",447],["T_VARIABLE","$this",448],["T_OBJECT_OPERATOR","->",448],["T_STRING","setStoreId",448],"(",["T_VARIABLE","$customer",448],["T_OBJECT_OPERATOR","->",448],["T_STRING","getStoreId",448],"(",")",")",["T_WHITESPACE","\n                ",448],["T_OBJECT_OPERATOR","->",449],["T_STRING","setEmail",449],"(",["T_VARIABLE","$customer",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","getEmail",449],"(",")",")",";",["T_WHITESPACE","\n        ",449],"}",["T_WHITESPACE","\n\n        ",450],["T_VARIABLE","$this",452],["T_OBJECT_OPERATOR","->",452],["T_STRING","save",452],"(",")",";",["T_WHITESPACE","\n        ",452],["T_VARIABLE","$sendSubscription",453],["T_WHITESPACE"," ",453],"=",["T_WHITESPACE"," ",453],["T_VARIABLE","$customer",453],["T_OBJECT_OPERATOR","->",453],["T_STRING","getData",453],"(",["T_CONSTANT_ENCAPSED_STRING","'sendSubscription'",453],")",["T_WHITESPACE"," ",453],["T_BOOLEAN_OR","||",453],["T_WHITESPACE"," ",453],["T_VARIABLE","$sendInformationEmail",453],";",["T_WHITESPACE","\n        ",453],["T_IF","if",454],["T_WHITESPACE"," ",454],"(",["T_STRING","is_null",454],"(",["T_VARIABLE","$sendSubscription",454],")",["T_WHITESPACE"," ",454],["T_LOGICAL_XOR","xor",454],["T_WHITESPACE"," ",454],["T_VARIABLE","$sendSubscription",454],")",["T_WHITESPACE"," ",454],"{",["T_WHITESPACE","\n            ",454],["T_IF","if",455],["T_WHITESPACE"," ",455],"(",["T_VARIABLE","$this",455],["T_OBJECT_OPERATOR","->",455],["T_STRING","getIsStatusChanged",455],"(",")",["T_WHITESPACE"," ",455],["T_BOOLEAN_AND","&&",455],["T_WHITESPACE"," ",455],["T_VARIABLE","$status",455],["T_WHITESPACE"," ",455],["T_IS_EQUAL","==",455],["T_WHITESPACE"," ",455],["T_STRING","self",455],["T_DOUBLE_COLON","::",455],["T_STRING","STATUS_UNSUBSCRIBED",455],")",["T_WHITESPACE"," ",455],"{",["T_WHITESPACE","\n                ",455],["T_VARIABLE","$this",456],["T_OBJECT_OPERATOR","->",456],["T_STRING","sendUnsubscriptionEmail",456],"(",")",";",["T_WHITESPACE","\n            ",456],"}",["T_WHITESPACE"," ",457],["T_ELSEIF","elseif",457],["T_WHITESPACE"," ",457],"(",["T_VARIABLE","$this",457],["T_OBJECT_OPERATOR","->",457],["T_STRING","getIsStatusChanged",457],"(",")",["T_WHITESPACE"," ",457],["T_BOOLEAN_AND","&&",457],["T_WHITESPACE"," ",457],["T_VARIABLE","$status",457],["T_WHITESPACE"," ",457],["T_IS_EQUAL","==",457],["T_WHITESPACE"," ",457],["T_STRING","self",457],["T_DOUBLE_COLON","::",457],["T_STRING","STATUS_SUBSCRIBED",457],")",["T_WHITESPACE"," ",457],"{",["T_WHITESPACE","\n                ",457],["T_VARIABLE","$this",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","sendConfirmationSuccessEmail",458],"(",")",";",["T_WHITESPACE","\n            ",458],"}",["T_WHITESPACE","\n        ",459],"}",["T_WHITESPACE","\n        ",460],["T_RETURN","return",461],["T_WHITESPACE"," ",461],["T_VARIABLE","$this",461],";",["T_WHITESPACE","\n    ",461],"}",["T_WHITESPACE","\n\n    ",462],["T_DOC_COMMENT","\/**\n     * Confirms subscriber newsletter\n     *\n     * @param string $code\n     * @return boolean\n     *\/",464],["T_WHITESPACE","\n    ",469],["T_PUBLIC","public",470],["T_WHITESPACE"," ",470],["T_FUNCTION","function",470],["T_WHITESPACE"," ",470],["T_STRING","confirm",470],"(",["T_VARIABLE","$code",470],")",["T_WHITESPACE","\n    ",470],"{",["T_WHITESPACE","\n        ",471],["T_IF","if",472],"(",["T_VARIABLE","$this",472],["T_OBJECT_OPERATOR","->",472],["T_STRING","getCode",472],"(",")",["T_IS_EQUAL","==",472],["T_VARIABLE","$code",472],")",["T_WHITESPACE"," ",472],"{",["T_WHITESPACE","\n            ",472],["T_VARIABLE","$this",473],["T_OBJECT_OPERATOR","->",473],["T_STRING","setStatus",473],"(",["T_STRING","self",473],["T_DOUBLE_COLON","::",473],["T_STRING","STATUS_SUBSCRIBED",473],")",["T_WHITESPACE","\n                ",473],["T_OBJECT_OPERATOR","->",474],["T_STRING","setIsStatusChanged",474],"(",["T_STRING","true",474],")",["T_WHITESPACE","\n                ",474],["T_OBJECT_OPERATOR","->",475],["T_STRING","save",475],"(",")",";",["T_WHITESPACE","\n            ",475],["T_RETURN","return",476],["T_WHITESPACE"," ",476],["T_STRING","true",476],";",["T_WHITESPACE","\n        ",476],"}",["T_WHITESPACE","\n\n        ",477],["T_RETURN","return",479],["T_WHITESPACE"," ",479],["T_STRING","false",479],";",["T_WHITESPACE","\n    ",479],"}",["T_WHITESPACE","\n\n    ",480],["T_DOC_COMMENT","\/**\n     * Mark receiving subscriber of queue newsletter\n     *\n     * @param  Mage_Newsletter_Model_Queue $queue\n     * @return boolean\n     *\/",482],["T_WHITESPACE","\n    ",487],["T_PUBLIC","public",488],["T_WHITESPACE"," ",488],["T_FUNCTION","function",488],["T_WHITESPACE"," ",488],["T_STRING","received",488],"(",["T_STRING","Mage_Newsletter_Model_Queue",488],["T_WHITESPACE"," ",488],["T_VARIABLE","$queue",488],")",["T_WHITESPACE","\n    ",488],"{",["T_WHITESPACE","\n        ",489],["T_VARIABLE","$this",490],["T_OBJECT_OPERATOR","->",490],["T_STRING","getResource",490],"(",")",["T_OBJECT_OPERATOR","->",490],["T_STRING","received",490],"(",["T_VARIABLE","$this",490],",",["T_VARIABLE","$queue",490],")",";",["T_WHITESPACE","\n        ",490],["T_RETURN","return",491],["T_WHITESPACE"," ",491],["T_VARIABLE","$this",491],";",["T_WHITESPACE","\n    ",491],"}",["T_WHITESPACE","\n\n    ",492],["T_DOC_COMMENT","\/**\n     * Sends out confirmation email\n     *\n     * @return Mage_Newsletter_Model_Subscriber\n     *\/",494],["T_WHITESPACE","\n    ",498],["T_PUBLIC","public",499],["T_WHITESPACE"," ",499],["T_FUNCTION","function",499],["T_WHITESPACE"," ",499],["T_STRING","sendConfirmationRequestEmail",499],"(",")",["T_WHITESPACE","\n    ",499],"{",["T_WHITESPACE","\n        ",500],["T_IF","if",501],["T_WHITESPACE"," ",501],"(",["T_VARIABLE","$this",501],["T_OBJECT_OPERATOR","->",501],["T_STRING","getImportMode",501],"(",")",")",["T_WHITESPACE"," ",501],"{",["T_WHITESPACE","\n            ",501],["T_RETURN","return",502],["T_WHITESPACE"," ",502],["T_VARIABLE","$this",502],";",["T_WHITESPACE","\n        ",502],"}",["T_WHITESPACE","\n\n        ",503],["T_IF","if",505],"(","!",["T_STRING","Mage",505],["T_DOUBLE_COLON","::",505],["T_STRING","getStoreConfig",505],"(",["T_STRING","self",505],["T_DOUBLE_COLON","::",505],["T_STRING","XML_PATH_CONFIRM_EMAIL_TEMPLATE",505],")",["T_WHITESPACE","\n           ",505],["T_BOOLEAN_OR","||",506],["T_WHITESPACE"," ",506],"!",["T_STRING","Mage",506],["T_DOUBLE_COLON","::",506],["T_STRING","getStoreConfig",506],"(",["T_STRING","self",506],["T_DOUBLE_COLON","::",506],["T_STRING","XML_PATH_CONFIRM_EMAIL_IDENTITY",506],")",["T_WHITESPACE","\n        ",506],")",["T_WHITESPACE","  ",507],"{",["T_WHITESPACE","\n            ",507],["T_RETURN","return",508],["T_WHITESPACE"," ",508],["T_VARIABLE","$this",508],";",["T_WHITESPACE","\n        ",508],"}",["T_WHITESPACE","\n\n        ",509],["T_VARIABLE","$translate",511],["T_WHITESPACE"," ",511],"=",["T_WHITESPACE"," ",511],["T_STRING","Mage",511],["T_DOUBLE_COLON","::",511],["T_STRING","getSingleton",511],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/translate'",511],")",";",["T_WHITESPACE","\n        ",511],["T_COMMENT","\/* @var $translate Mage_Core_Model_Translate *\/",512],["T_WHITESPACE","\n        ",512],["T_VARIABLE","$translate",513],["T_OBJECT_OPERATOR","->",513],["T_STRING","setTranslateInline",513],"(",["T_STRING","false",513],")",";",["T_WHITESPACE","\n\n        ",513],["T_VARIABLE","$email",515],["T_WHITESPACE"," ",515],"=",["T_WHITESPACE"," ",515],["T_STRING","Mage",515],["T_DOUBLE_COLON","::",515],["T_STRING","getModel",515],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/email_template'",515],")",";",["T_WHITESPACE","\n\n        ",515],["T_VARIABLE","$email",517],["T_OBJECT_OPERATOR","->",517],["T_STRING","sendTransactional",517],"(",["T_WHITESPACE","\n            ",517],["T_STRING","Mage",518],["T_DOUBLE_COLON","::",518],["T_STRING","getStoreConfig",518],"(",["T_STRING","self",518],["T_DOUBLE_COLON","::",518],["T_STRING","XML_PATH_CONFIRM_EMAIL_TEMPLATE",518],")",",",["T_WHITESPACE","\n            ",518],["T_STRING","Mage",519],["T_DOUBLE_COLON","::",519],["T_STRING","getStoreConfig",519],"(",["T_STRING","self",519],["T_DOUBLE_COLON","::",519],["T_STRING","XML_PATH_CONFIRM_EMAIL_IDENTITY",519],")",",",["T_WHITESPACE","\n            ",519],["T_VARIABLE","$this",520],["T_OBJECT_OPERATOR","->",520],["T_STRING","getEmail",520],"(",")",",",["T_WHITESPACE","\n            ",520],["T_VARIABLE","$this",521],["T_OBJECT_OPERATOR","->",521],["T_STRING","getName",521],"(",")",",",["T_WHITESPACE","\n            ",521],["T_ARRAY","array",522],"(",["T_CONSTANT_ENCAPSED_STRING","'subscriber'",522],["T_DOUBLE_ARROW","=>",522],["T_VARIABLE","$this",522],")",["T_WHITESPACE","\n        ",522],")",";",["T_WHITESPACE","\n\n        ",523],["T_VARIABLE","$translate",525],["T_OBJECT_OPERATOR","->",525],["T_STRING","setTranslateInline",525],"(",["T_STRING","true",525],")",";",["T_WHITESPACE","\n\n        ",525],["T_RETURN","return",527],["T_WHITESPACE"," ",527],["T_VARIABLE","$this",527],";",["T_WHITESPACE","\n    ",527],"}",["T_WHITESPACE","\n\n    ",528],["T_DOC_COMMENT","\/**\n     * Sends out confirmation success email\n     *\n     * @return Mage_Newsletter_Model_Subscriber\n     *\/",530],["T_WHITESPACE","\n    ",534],["T_PUBLIC","public",535],["T_WHITESPACE"," ",535],["T_FUNCTION","function",535],["T_WHITESPACE"," ",535],["T_STRING","sendConfirmationSuccessEmail",535],"(",")",["T_WHITESPACE","\n    ",535],"{",["T_WHITESPACE","\n        ",536],["T_IF","if",537],["T_WHITESPACE"," ",537],"(",["T_VARIABLE","$this",537],["T_OBJECT_OPERATOR","->",537],["T_STRING","getImportMode",537],"(",")",")",["T_WHITESPACE"," ",537],"{",["T_WHITESPACE","\n            ",537],["T_RETURN","return",538],["T_WHITESPACE"," ",538],["T_VARIABLE","$this",538],";",["T_WHITESPACE","\n        ",538],"}",["T_WHITESPACE","\n\n        ",539],["T_IF","if",541],"(","!",["T_STRING","Mage",541],["T_DOUBLE_COLON","::",541],["T_STRING","getStoreConfig",541],"(",["T_STRING","self",541],["T_DOUBLE_COLON","::",541],["T_STRING","XML_PATH_SUCCESS_EMAIL_TEMPLATE",541],")",["T_WHITESPACE","\n           ",541],["T_BOOLEAN_OR","||",542],["T_WHITESPACE"," ",542],"!",["T_STRING","Mage",542],["T_DOUBLE_COLON","::",542],["T_STRING","getStoreConfig",542],"(",["T_STRING","self",542],["T_DOUBLE_COLON","::",542],["T_STRING","XML_PATH_SUCCESS_EMAIL_IDENTITY",542],")",["T_WHITESPACE","\n        ",542],")",["T_WHITESPACE"," ",543],"{",["T_WHITESPACE","\n            ",543],["T_RETURN","return",544],["T_WHITESPACE"," ",544],["T_VARIABLE","$this",544],";",["T_WHITESPACE","\n        ",544],"}",["T_WHITESPACE","\n\n        ",545],["T_VARIABLE","$translate",547],["T_WHITESPACE"," ",547],"=",["T_WHITESPACE"," ",547],["T_STRING","Mage",547],["T_DOUBLE_COLON","::",547],["T_STRING","getSingleton",547],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/translate'",547],")",";",["T_WHITESPACE","\n        ",547],["T_COMMENT","\/* @var $translate Mage_Core_Model_Translate *\/",548],["T_WHITESPACE","\n        ",548],["T_VARIABLE","$translate",549],["T_OBJECT_OPERATOR","->",549],["T_STRING","setTranslateInline",549],"(",["T_STRING","false",549],")",";",["T_WHITESPACE","\n\n        ",549],["T_VARIABLE","$email",551],["T_WHITESPACE"," ",551],"=",["T_WHITESPACE"," ",551],["T_STRING","Mage",551],["T_DOUBLE_COLON","::",551],["T_STRING","getModel",551],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/email_template'",551],")",";",["T_WHITESPACE","\n\n        ",551],["T_VARIABLE","$email",553],["T_OBJECT_OPERATOR","->",553],["T_STRING","sendTransactional",553],"(",["T_WHITESPACE","\n            ",553],["T_STRING","Mage",554],["T_DOUBLE_COLON","::",554],["T_STRING","getStoreConfig",554],"(",["T_STRING","self",554],["T_DOUBLE_COLON","::",554],["T_STRING","XML_PATH_SUCCESS_EMAIL_TEMPLATE",554],")",",",["T_WHITESPACE","\n            ",554],["T_STRING","Mage",555],["T_DOUBLE_COLON","::",555],["T_STRING","getStoreConfig",555],"(",["T_STRING","self",555],["T_DOUBLE_COLON","::",555],["T_STRING","XML_PATH_SUCCESS_EMAIL_IDENTITY",555],")",",",["T_WHITESPACE","\n            ",555],["T_VARIABLE","$this",556],["T_OBJECT_OPERATOR","->",556],["T_STRING","getEmail",556],"(",")",",",["T_WHITESPACE","\n            ",556],["T_VARIABLE","$this",557],["T_OBJECT_OPERATOR","->",557],["T_STRING","getName",557],"(",")",",",["T_WHITESPACE","\n            ",557],["T_ARRAY","array",558],"(",["T_CONSTANT_ENCAPSED_STRING","'subscriber'",558],["T_DOUBLE_ARROW","=>",558],["T_VARIABLE","$this",558],")",["T_WHITESPACE","\n        ",558],")",";",["T_WHITESPACE","\n\n        ",559],["T_VARIABLE","$translate",561],["T_OBJECT_OPERATOR","->",561],["T_STRING","setTranslateInline",561],"(",["T_STRING","true",561],")",";",["T_WHITESPACE","\n\n        ",561],["T_RETURN","return",563],["T_WHITESPACE"," ",563],["T_VARIABLE","$this",563],";",["T_WHITESPACE","\n    ",563],"}",["T_WHITESPACE","\n\n    ",564],["T_DOC_COMMENT","\/**\n     * Sends out unsubsciption email\n     *\n     * @return Mage_Newsletter_Model_Subscriber\n     *\/",566],["T_WHITESPACE","\n    ",570],["T_PUBLIC","public",571],["T_WHITESPACE"," ",571],["T_FUNCTION","function",571],["T_WHITESPACE"," ",571],["T_STRING","sendUnsubscriptionEmail",571],"(",")",["T_WHITESPACE","\n    ",571],"{",["T_WHITESPACE","\n        ",572],["T_IF","if",573],["T_WHITESPACE"," ",573],"(",["T_VARIABLE","$this",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","getImportMode",573],"(",")",")",["T_WHITESPACE"," ",573],"{",["T_WHITESPACE","\n            ",573],["T_RETURN","return",574],["T_WHITESPACE"," ",574],["T_VARIABLE","$this",574],";",["T_WHITESPACE","\n        ",574],"}",["T_WHITESPACE","\n        ",575],["T_IF","if",576],"(","!",["T_STRING","Mage",576],["T_DOUBLE_COLON","::",576],["T_STRING","getStoreConfig",576],"(",["T_STRING","self",576],["T_DOUBLE_COLON","::",576],["T_STRING","XML_PATH_UNSUBSCRIBE_EMAIL_TEMPLATE",576],")",["T_WHITESPACE","\n           ",576],["T_BOOLEAN_OR","||",577],["T_WHITESPACE"," ",577],"!",["T_STRING","Mage",577],["T_DOUBLE_COLON","::",577],["T_STRING","getStoreConfig",577],"(",["T_STRING","self",577],["T_DOUBLE_COLON","::",577],["T_STRING","XML_PATH_UNSUBSCRIBE_EMAIL_IDENTITY",577],")",["T_WHITESPACE","\n        ",577],")",["T_WHITESPACE"," ",578],"{",["T_WHITESPACE","\n            ",578],["T_RETURN","return",579],["T_WHITESPACE"," ",579],["T_VARIABLE","$this",579],";",["T_WHITESPACE","\n        ",579],"}",["T_WHITESPACE","\n\n        ",580],["T_VARIABLE","$translate",582],["T_WHITESPACE"," ",582],"=",["T_WHITESPACE"," ",582],["T_STRING","Mage",582],["T_DOUBLE_COLON","::",582],["T_STRING","getSingleton",582],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/translate'",582],")",";",["T_WHITESPACE","\n        ",582],["T_COMMENT","\/* @var $translate Mage_Core_Model_Translate *\/",583],["T_WHITESPACE","\n        ",583],["T_VARIABLE","$translate",584],["T_OBJECT_OPERATOR","->",584],["T_STRING","setTranslateInline",584],"(",["T_STRING","false",584],")",";",["T_WHITESPACE","\n\n        ",584],["T_VARIABLE","$email",586],["T_WHITESPACE"," ",586],"=",["T_WHITESPACE"," ",586],["T_STRING","Mage",586],["T_DOUBLE_COLON","::",586],["T_STRING","getModel",586],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/email_template'",586],")",";",["T_WHITESPACE","\n\n        ",586],["T_VARIABLE","$email",588],["T_OBJECT_OPERATOR","->",588],["T_STRING","sendTransactional",588],"(",["T_WHITESPACE","\n            ",588],["T_STRING","Mage",589],["T_DOUBLE_COLON","::",589],["T_STRING","getStoreConfig",589],"(",["T_STRING","self",589],["T_DOUBLE_COLON","::",589],["T_STRING","XML_PATH_UNSUBSCRIBE_EMAIL_TEMPLATE",589],")",",",["T_WHITESPACE","\n            ",589],["T_STRING","Mage",590],["T_DOUBLE_COLON","::",590],["T_STRING","getStoreConfig",590],"(",["T_STRING","self",590],["T_DOUBLE_COLON","::",590],["T_STRING","XML_PATH_UNSUBSCRIBE_EMAIL_IDENTITY",590],")",",",["T_WHITESPACE","\n            ",590],["T_VARIABLE","$this",591],["T_OBJECT_OPERATOR","->",591],["T_STRING","getEmail",591],"(",")",",",["T_WHITESPACE","\n            ",591],["T_VARIABLE","$this",592],["T_OBJECT_OPERATOR","->",592],["T_STRING","getName",592],"(",")",",",["T_WHITESPACE","\n            ",592],["T_ARRAY","array",593],"(",["T_CONSTANT_ENCAPSED_STRING","'subscriber'",593],["T_DOUBLE_ARROW","=>",593],["T_VARIABLE","$this",593],")",["T_WHITESPACE","\n        ",593],")",";",["T_WHITESPACE","\n\n        ",594],["T_VARIABLE","$translate",596],["T_OBJECT_OPERATOR","->",596],["T_STRING","setTranslateInline",596],"(",["T_STRING","true",596],")",";",["T_WHITESPACE","\n\n        ",596],["T_RETURN","return",598],["T_WHITESPACE"," ",598],["T_VARIABLE","$this",598],";",["T_WHITESPACE","\n    ",598],"}",["T_WHITESPACE","\n\n    ",599],["T_DOC_COMMENT","\/**\n     * Retrieve Subscribers Full Name if it was set\n     *\n     * @return string|null\n     *\/",601],["T_WHITESPACE","\n    ",605],["T_PUBLIC","public",606],["T_WHITESPACE"," ",606],["T_FUNCTION","function",606],["T_WHITESPACE"," ",606],["T_STRING","getSubscriberFullName",606],"(",")",["T_WHITESPACE","\n    ",606],"{",["T_WHITESPACE","\n        ",607],["T_VARIABLE","$name",608],["T_WHITESPACE"," ",608],"=",["T_WHITESPACE"," ",608],["T_STRING","null",608],";",["T_WHITESPACE","\n        ",608],["T_IF","if",609],["T_WHITESPACE"," ",609],"(",["T_VARIABLE","$this",609],["T_OBJECT_OPERATOR","->",609],["T_STRING","hasCustomerFirstname",609],"(",")",["T_WHITESPACE"," ",609],["T_BOOLEAN_OR","||",609],["T_WHITESPACE"," ",609],["T_VARIABLE","$this",609],["T_OBJECT_OPERATOR","->",609],["T_STRING","hasCustomerLastname",609],"(",")",")",["T_WHITESPACE"," ",609],"{",["T_WHITESPACE","\n            ",609],["T_VARIABLE","$name",610],["T_WHITESPACE"," ",610],"=",["T_WHITESPACE"," ",610],["T_STRING","Mage",610],["T_DOUBLE_COLON","::",610],["T_STRING","helper",610],"(",["T_CONSTANT_ENCAPSED_STRING","'customer'",610],")",["T_OBJECT_OPERATOR","->",610],["T_STRING","getFullCustomerName",610],"(",["T_VARIABLE","$this",610],")",";",["T_WHITESPACE","\n        ",610],"}",["T_WHITESPACE","\n        ",611],["T_RETURN","return",612],["T_WHITESPACE"," ",612],["T_VARIABLE","$name",612],";",["T_WHITESPACE","\n    ",612],"}",["T_WHITESPACE","\n",613],"}",["T_WHITESPACE","\n",614]]