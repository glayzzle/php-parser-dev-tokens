[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Newsletter\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Template model\n *\n * @method Mage_Newsletter_Model_Resource_Template _getResource()\n * @method Mage_Newsletter_Model_Resource_Template getResource()\n * @method string getTemplateCode()\n * @method Mage_Newsletter_Model_Template setTemplateCode(string $value)\n * @method Mage_Newsletter_Model_Template setTemplateText(string $value)\n * @method Mage_Newsletter_Model_Template setTemplateTextPreprocessed(string $value)\n * @method string getTemplateStyles()\n * @method Mage_Newsletter_Model_Template setTemplateStyles(string $value)\n * @method int getTemplateType()\n * @method Mage_Newsletter_Model_Template setTemplateType(int $value)\n * @method string getTemplateSubject()\n * @method Mage_Newsletter_Model_Template setTemplateSubject(string $value)\n * @method string getTemplateSenderName()\n * @method Mage_Newsletter_Model_Template setTemplateSenderName(string $value)\n * @method string getTemplateSenderEmail()\n * @method Mage_Newsletter_Model_Template setTemplateSenderEmail(string $value)\n * @method int getTemplateActual()\n * @method Mage_Newsletter_Model_Template setTemplateActual(int $value)\n * @method string getAddedAt()\n * @method Mage_Newsletter_Model_Template setAddedAt(string $value)\n * @method string getModifiedAt()\n * @method Mage_Newsletter_Model_Template setModifiedAt(string $value)\n *\n * @category    Mage\n * @package     Mage_Newsletter\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",56],["T_CLASS","class",57],["T_WHITESPACE"," ",57],["T_STRING","Mage_Newsletter_Model_Template",57],["T_WHITESPACE"," ",57],["T_EXTENDS","extends",57],["T_WHITESPACE"," ",57],["T_STRING","Mage_Core_Model_Email_Template_Abstract",57],["T_WHITESPACE","\n",57],"{",["T_WHITESPACE","\n    ",58],["T_DOC_COMMENT","\/**\n     * Template Text Preprocessed flag\n     *\n     * @var bool\n     *\/",59],["T_WHITESPACE","\n    ",63],["T_PROTECTED","protected",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$_preprocessFlag",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_STRING","false",64],";",["T_WHITESPACE","\n\n    ",64],["T_DOC_COMMENT","\/**\n     * Mail object\n     *\n     * @var Zend_Mail\n     *\/",66],["T_WHITESPACE","\n    ",70],["T_PROTECTED","protected",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$_mail",71],";",["T_WHITESPACE","\n\n    ",71],["T_DOC_COMMENT","\/**\n     * Initialize resource model\n     *\n     *\/",73],["T_WHITESPACE","\n    ",76],["T_PROTECTED","protected",77],["T_WHITESPACE"," ",77],["T_FUNCTION","function",77],["T_WHITESPACE"," ",77],["T_STRING","_construct",77],"(",")",["T_WHITESPACE","\n    ",77],"{",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","_init",79],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter\/template'",79],")",";",["T_WHITESPACE","\n    ",79],"}",["T_WHITESPACE","\n\n    ",80],["T_DOC_COMMENT","\/**\n     * Validate Newsletter template\n     *\n     * @throws Mage_Core_Exception\n     * @return bool\n     *\/",82],["T_WHITESPACE","\n    ",87],["T_PUBLIC","public",88],["T_WHITESPACE"," ",88],["T_FUNCTION","function",88],["T_WHITESPACE"," ",88],["T_STRING","validate",88],"(",")",["T_WHITESPACE","\n    ",88],"{",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$validators",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_ARRAY","array",90],"(",["T_WHITESPACE","\n            ",90],["T_CONSTANT_ENCAPSED_STRING","'template_code'",91],["T_WHITESPACE","         ",91],["T_DOUBLE_ARROW","=>",91],["T_WHITESPACE"," ",91],["T_ARRAY","array",91],"(",["T_STRING","Zend_Filter_Input",91],["T_DOUBLE_COLON","::",91],["T_STRING","ALLOW_EMPTY",91],["T_WHITESPACE"," ",91],["T_DOUBLE_ARROW","=>",91],["T_WHITESPACE"," ",91],["T_STRING","false",91],")",",",["T_WHITESPACE","\n            ",91],["T_CONSTANT_ENCAPSED_STRING","'template_type'",92],["T_WHITESPACE","         ",92],["T_DOUBLE_ARROW","=>",92],["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'Int'",92],",",["T_WHITESPACE","\n            ",92],["T_CONSTANT_ENCAPSED_STRING","'template_sender_email'",93],["T_WHITESPACE"," ",93],["T_DOUBLE_ARROW","=>",93],["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","'EmailAddress'",93],",",["T_WHITESPACE","\n            ",93],["T_CONSTANT_ENCAPSED_STRING","'template_sender_name'",94],["T_WHITESPACE","  ",94],["T_DOUBLE_ARROW","=>",94],["T_WHITESPACE"," ",94],["T_ARRAY","array",94],"(",["T_STRING","Zend_Filter_Input",94],["T_DOUBLE_COLON","::",94],["T_STRING","ALLOW_EMPTY",94],["T_WHITESPACE"," ",94],["T_DOUBLE_ARROW","=>",94],["T_WHITESPACE"," ",94],["T_STRING","false",94],")",["T_WHITESPACE","\n        ",94],")",";",["T_WHITESPACE","\n        ",95],["T_VARIABLE","$data",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_ARRAY","array",96],"(",")",";",["T_WHITESPACE","\n        ",96],["T_FOREACH","foreach",97],["T_WHITESPACE"," ",97],"(",["T_STRING","array_keys",97],"(",["T_VARIABLE","$validators",97],")",["T_WHITESPACE"," ",97],["T_AS","as",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$validateField",97],")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n            ",97],["T_VARIABLE","$data",98],"[",["T_VARIABLE","$validateField",98],"]",["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getDataUsingMethod",98],"(",["T_VARIABLE","$validateField",98],")",";",["T_WHITESPACE","\n        ",98],"}",["T_WHITESPACE","\n\n        ",99],["T_VARIABLE","$validateInput",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_NEW","new",101],["T_WHITESPACE"," ",101],["T_STRING","Zend_Filter_Input",101],"(",["T_ARRAY","array",101],"(",")",",",["T_WHITESPACE"," ",101],["T_VARIABLE","$validators",101],",",["T_WHITESPACE"," ",101],["T_VARIABLE","$data",101],")",";",["T_WHITESPACE","\n        ",101],["T_IF","if",102],["T_WHITESPACE"," ",102],"(","!",["T_VARIABLE","$validateInput",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","isValid",102],"(",")",")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n            ",102],["T_VARIABLE","$errorMessages",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_ARRAY","array",103],"(",")",";",["T_WHITESPACE","\n            ",103],["T_FOREACH","foreach",104],["T_WHITESPACE"," ",104],"(",["T_VARIABLE","$validateInput",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getMessages",104],"(",")",["T_WHITESPACE"," ",104],["T_AS","as",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$messages",104],")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n                ",104],["T_IF","if",105],["T_WHITESPACE"," ",105],"(",["T_STRING","is_array",105],"(",["T_VARIABLE","$messages",105],")",")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n                    ",105],["T_FOREACH","foreach",106],["T_WHITESPACE"," ",106],"(",["T_VARIABLE","$messages",106],["T_WHITESPACE"," ",106],["T_AS","as",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$message",106],")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n                        ",106],["T_VARIABLE","$errorMessages",107],"[","]",["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_VARIABLE","$message",107],";",["T_WHITESPACE","\n                    ",107],"}",["T_WHITESPACE","\n                ",108],"}",["T_WHITESPACE","\n                ",109],["T_ELSE","else",110],["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n                    ",110],["T_VARIABLE","$errorMessages",111],"[","]",["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_VARIABLE","$messages",111],";",["T_WHITESPACE","\n                ",111],"}",["T_WHITESPACE","\n            ",112],"}",["T_WHITESPACE","\n\n            ",113],["T_STRING","Mage",115],["T_DOUBLE_COLON","::",115],["T_STRING","throwException",115],"(",["T_STRING","join",115],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",115],",",["T_WHITESPACE"," ",115],["T_VARIABLE","$errorMessages",115],")",")",";",["T_WHITESPACE","\n        ",115],"}",["T_WHITESPACE","\n    ",116],"}",["T_WHITESPACE","\n\n    ",117],["T_DOC_COMMENT","\/**\n     * Processing object before save data\n     *\n     * @return Mage_Newsletter_Model_Template\n     *\/",119],["T_WHITESPACE","\n    ",123],["T_PROTECTED","protected",124],["T_WHITESPACE"," ",124],["T_FUNCTION","function",124],["T_WHITESPACE"," ",124],["T_STRING","_beforeSave",124],"(",")",["T_WHITESPACE","\n    ",124],"{",["T_WHITESPACE","\n        ",125],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","validate",126],"(",")",";",["T_WHITESPACE","\n        ",126],["T_RETURN","return",127],["T_WHITESPACE"," ",127],["T_STRING","parent",127],["T_DOUBLE_COLON","::",127],["T_STRING","_beforeSave",127],"(",")",";",["T_WHITESPACE","\n    ",127],"}",["T_WHITESPACE","\n\n    ",128],["T_DOC_COMMENT","\/**\n     * Load template by code\n     *\n     * @param string $templateCode\n     * @return Mage_Newsletter_Model_Template\n     *\/",130],["T_WHITESPACE","\n    ",135],["T_PUBLIC","public",136],["T_WHITESPACE"," ",136],["T_FUNCTION","function",136],["T_WHITESPACE"," ",136],["T_STRING","loadByCode",136],"(",["T_VARIABLE","$templateCode",136],")",["T_WHITESPACE","\n    ",136],"{",["T_WHITESPACE","\n        ",137],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","_getResource",138],"(",")",["T_OBJECT_OPERATOR","->",138],["T_STRING","loadByCode",138],"(",["T_VARIABLE","$this",138],",",["T_WHITESPACE"," ",138],["T_VARIABLE","$templateCode",138],")",";",["T_WHITESPACE","\n        ",138],["T_RETURN","return",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],";",["T_WHITESPACE","\n    ",139],"}",["T_WHITESPACE","\n\n    ",140],["T_DOC_COMMENT","\/**\n     * Return true if this template can be used for sending queue as main template\n     *\n     * @return boolean\n     * @deprecated since 1.4.0.1\n     *\/",142],["T_WHITESPACE","\n    ",147],["T_PUBLIC","public",148],["T_WHITESPACE"," ",148],["T_FUNCTION","function",148],["T_WHITESPACE"," ",148],["T_STRING","isValidForSend",148],"(",")",["T_WHITESPACE","\n    ",148],"{",["T_WHITESPACE","\n        ",149],["T_RETURN","return",150],["T_WHITESPACE"," ",150],"!",["T_STRING","Mage",150],["T_DOUBLE_COLON","::",150],["T_STRING","getStoreConfigFlag",150],"(",["T_CONSTANT_ENCAPSED_STRING","'system\/smtp\/disable'",150],")",["T_WHITESPACE","\n            ",150],["T_BOOLEAN_AND","&&",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","getTemplateSenderName",151],"(",")",["T_WHITESPACE","\n            ",151],["T_BOOLEAN_AND","&&",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","getTemplateSenderEmail",152],"(",")",["T_WHITESPACE","\n            ",152],["T_BOOLEAN_AND","&&",153],["T_WHITESPACE"," ",153],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","getTemplateSubject",153],"(",")",";",["T_WHITESPACE","\n    ",153],"}",["T_WHITESPACE","\n\n    ",154],["T_DOC_COMMENT","\/**\n     * Getter for template type\n     *\n     * @return int|string\n     *\/",156],["T_WHITESPACE","\n    ",160],["T_PUBLIC","public",161],["T_WHITESPACE"," ",161],["T_FUNCTION","function",161],["T_WHITESPACE"," ",161],["T_STRING","getType",161],"(",")","{",["T_WHITESPACE","\n        ",161],["T_RETURN","return",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","getTemplateType",162],"(",")",";",["T_WHITESPACE","\n    ",162],"}",["T_WHITESPACE","\n\n    ",163],["T_DOC_COMMENT","\/**\n     * Check is Preprocessed\n     *\n     * @return bool\n     *\/",165],["T_WHITESPACE","\n    ",169],["T_PUBLIC","public",170],["T_WHITESPACE"," ",170],["T_FUNCTION","function",170],["T_WHITESPACE"," ",170],["T_STRING","isPreprocessed",170],"(",")",["T_WHITESPACE","\n    ",170],"{",["T_WHITESPACE","\n        ",171],["T_RETURN","return",172],["T_WHITESPACE"," ",172],["T_STRING","strlen",172],"(",["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","getTemplateTextPreprocessed",172],"(",")",")",["T_WHITESPACE"," ",172],">",["T_WHITESPACE"," ",172],["T_LNUMBER","0",172],";",["T_WHITESPACE","\n    ",172],"}",["T_WHITESPACE","\n\n    ",173],["T_DOC_COMMENT","\/**\n     * Check Template Text Preprocessed\n     *\n     * @return bool\n     *\/",175],["T_WHITESPACE","\n    ",179],["T_PUBLIC","public",180],["T_WHITESPACE"," ",180],["T_FUNCTION","function",180],["T_WHITESPACE"," ",180],["T_STRING","getTemplateTextPreprocessed",180],"(",")",["T_WHITESPACE","\n    ",180],"{",["T_WHITESPACE","\n        ",181],["T_IF","if",182],["T_WHITESPACE"," ",182],"(",["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","_preprocessFlag",182],")",["T_WHITESPACE"," ",182],"{",["T_WHITESPACE","\n            ",182],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","setTemplateTextPreprocessed",183],"(",["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","getProcessedTemplate",183],"(",")",")",";",["T_WHITESPACE","\n        ",183],"}",["T_WHITESPACE","\n\n        ",184],["T_RETURN","return",186],["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","getData",186],"(",["T_CONSTANT_ENCAPSED_STRING","'template_text_preprocessed'",186],")",";",["T_WHITESPACE","\n    ",186],"}",["T_WHITESPACE","\n\n    ",187],["T_DOC_COMMENT","\/**\n     * Retrieve processed template\n     *\n     * @param array $variables\n     * @param bool $usePreprocess\n     * @return string\n     *\/",189],["T_WHITESPACE","\n    ",195],["T_PUBLIC","public",196],["T_WHITESPACE"," ",196],["T_FUNCTION","function",196],["T_WHITESPACE"," ",196],["T_STRING","getProcessedTemplate",196],"(",["T_ARRAY","array",196],["T_WHITESPACE"," ",196],["T_VARIABLE","$variables",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_ARRAY","array",196],"(",")",",",["T_WHITESPACE"," ",196],["T_VARIABLE","$usePreprocess",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_STRING","false",196],")",["T_WHITESPACE","\n    ",196],"{",["T_WHITESPACE","\n        ",197],["T_COMMENT","\/* @var $processor Mage_Newsletter_Model_Template_Filter *\/",198],["T_WHITESPACE","\n        ",198],["T_VARIABLE","$processor",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_STRING","Mage",199],["T_DOUBLE_COLON","::",199],["T_STRING","helper",199],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter'",199],")",["T_OBJECT_OPERATOR","->",199],["T_STRING","getTemplateProcessor",199],"(",")",";",["T_WHITESPACE","\n\n        ",199],["T_IF","if",201],["T_WHITESPACE"," ",201],"(","!",["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","_preprocessFlag",201],")",["T_WHITESPACE"," ",201],"{",["T_WHITESPACE","\n            ",201],["T_VARIABLE","$variables",202],"[",["T_CONSTANT_ENCAPSED_STRING","'this'",202],"]",["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_VARIABLE","$this",202],";",["T_WHITESPACE","\n        ",202],"}",["T_WHITESPACE","\n\n        ",203],["T_IF","if",205],["T_WHITESPACE"," ",205],"(",["T_STRING","Mage",205],["T_DOUBLE_COLON","::",205],["T_STRING","app",205],"(",")",["T_OBJECT_OPERATOR","->",205],["T_STRING","isSingleStoreMode",205],"(",")",")",["T_WHITESPACE"," ",205],"{",["T_WHITESPACE","\n            ",205],["T_VARIABLE","$processor",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","setStoreId",206],"(",["T_STRING","Mage",206],["T_DOUBLE_COLON","::",206],["T_STRING","app",206],"(",")",["T_OBJECT_OPERATOR","->",206],["T_STRING","getStore",206],"(",")",")",";",["T_WHITESPACE","\n        ",206],"}",["T_WHITESPACE"," ",207],["T_ELSE","else",207],["T_WHITESPACE"," ",207],"{",["T_WHITESPACE","\n            ",207],["T_VARIABLE","$processor",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","setStoreId",208],"(",["T_STRING","Mage",208],["T_DOUBLE_COLON","::",208],["T_STRING","app",208],"(",")",["T_OBJECT_OPERATOR","->",208],["T_STRING","getRequest",208],"(",")",["T_OBJECT_OPERATOR","->",208],["T_STRING","getParam",208],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id'",208],")",")",";",["T_WHITESPACE","\n        ",208],"}",["T_WHITESPACE","\n\n        ",209],["T_COMMENT","\/\/ Populate the variables array with store, store info, logo, etc. variables\n",211],["T_WHITESPACE","        ",212],["T_VARIABLE","$variables",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","_addEmailVariables",212],"(",["T_VARIABLE","$variables",212],",",["T_WHITESPACE"," ",212],["T_VARIABLE","$processor",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","getStoreId",212],"(",")",")",";",["T_WHITESPACE","\n\n        ",212],["T_VARIABLE","$processor",214],["T_WHITESPACE","\n            ",214],["T_OBJECT_OPERATOR","->",215],["T_STRING","setTemplateProcessor",215],"(",["T_ARRAY","array",215],"(",["T_VARIABLE","$this",215],",",["T_WHITESPACE"," ",215],["T_CONSTANT_ENCAPSED_STRING","'getTemplateByConfigPath'",215],")",")",["T_WHITESPACE","\n            ",215],["T_OBJECT_OPERATOR","->",216],["T_STRING","setIncludeProcessor",216],"(",["T_ARRAY","array",216],"(",["T_VARIABLE","$this",216],",",["T_WHITESPACE"," ",216],["T_CONSTANT_ENCAPSED_STRING","'getInclude'",216],")",")",["T_WHITESPACE","\n            ",216],["T_OBJECT_OPERATOR","->",217],["T_STRING","setVariables",217],"(",["T_VARIABLE","$variables",217],")",";",["T_WHITESPACE","\n\n        ",217],["T_COMMENT","\/\/ Filter the template text so that all HTML content will be present\n",219],["T_WHITESPACE","        ",220],["T_VARIABLE","$result",220],["T_WHITESPACE"," ",220],"=",["T_WHITESPACE"," ",220],["T_VARIABLE","$processor",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","filter",220],"(",["T_VARIABLE","$this",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","getTemplateText",220],"(",")",")",";",["T_WHITESPACE","\n        ",220],["T_COMMENT","\/\/ If the {{inlinecss file=\"\"}} directive was included in the template, grab filename to use for inlining\n",221],["T_WHITESPACE","        ",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","setInlineCssFile",222],"(",["T_VARIABLE","$processor",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","getInlineCssFile",222],"(",")",")",";",["T_WHITESPACE","\n\n        ",222],["T_COMMENT","\/\/ Now that all HTML has been assembled, run email through CSS inlining process\n",224],["T_WHITESPACE","        ",225],["T_IF","if",225],["T_WHITESPACE"," ",225],"(",["T_VARIABLE","$usePreprocess",225],["T_WHITESPACE"," ",225],["T_BOOLEAN_AND","&&",225],["T_WHITESPACE"," ",225],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","isPreprocessed",225],"(",")",")",["T_WHITESPACE"," ",225],"{",["T_WHITESPACE","\n            ",225],["T_VARIABLE","$processedResult",226],["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","getPreparedTemplateText",226],"(",["T_STRING","true",226],",",["T_WHITESPACE"," ",226],["T_VARIABLE","$result",226],")",";",["T_WHITESPACE","\n        ",226],"}",["T_WHITESPACE"," ",227],["T_ELSE","else",227],["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n            ",227],["T_VARIABLE","$processedResult",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getPreparedTemplateText",228],"(",["T_STRING","false",228],",",["T_WHITESPACE"," ",228],["T_VARIABLE","$result",228],")",";",["T_WHITESPACE","\n        ",228],"}",["T_WHITESPACE","\n\n        ",229],["T_RETURN","return",231],["T_WHITESPACE"," ",231],["T_VARIABLE","$processedResult",231],";",["T_WHITESPACE","\n    ",231],"}",["T_WHITESPACE","\n\n    ",232],["T_DOC_COMMENT","\/**\n     * Makes additional text preparations for HTML templates\n     *\n     * @param bool $usePreprocess Use Preprocessed text or original text\n     * @return string\n     *\/",234],["T_WHITESPACE","\n    ",239],["T_PUBLIC","public",240],["T_WHITESPACE"," ",240],["T_FUNCTION","function",240],["T_WHITESPACE"," ",240],["T_STRING","getPreparedTemplateText",240],"(",["T_VARIABLE","$usePreprocess",240],["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],["T_STRING","false",240],",",["T_WHITESPACE"," ",240],["T_VARIABLE","$html",240],["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],["T_STRING","null",240],")",["T_WHITESPACE","\n    ",240],"{",["T_WHITESPACE","\n        ",241],["T_IF","if",242],["T_WHITESPACE"," ",242],"(",["T_VARIABLE","$usePreprocess",242],")",["T_WHITESPACE"," ",242],"{",["T_WHITESPACE","\n            ",242],["T_VARIABLE","$text",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","getTemplateTextPreprocessed",243],"(",")",";",["T_WHITESPACE","\n        ",243],"}",["T_WHITESPACE"," ",244],["T_ELSEIF","elseif",244],["T_WHITESPACE"," ",244],"(",["T_VARIABLE","$html",244],")",["T_WHITESPACE"," ",244],"{",["T_WHITESPACE","\n            ",244],["T_VARIABLE","$text",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_VARIABLE","$html",245],";",["T_WHITESPACE","\n        ",245],"}",["T_WHITESPACE"," ",246],["T_ELSE","else",246],["T_WHITESPACE"," ",246],"{",["T_WHITESPACE","\n            ",246],["T_VARIABLE","$text",247],["T_WHITESPACE"," ",247],"=",["T_WHITESPACE"," ",247],["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","getTemplateText",247],"(",")",";",["T_WHITESPACE","\n        ",247],"}",["T_WHITESPACE","\n\n        ",248],["T_IF","if",250],["T_WHITESPACE"," ",250],"(",["T_VARIABLE","$this",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","_preprocessFlag",250],["T_WHITESPACE"," ",250],["T_BOOLEAN_OR","||",250],["T_WHITESPACE"," ",250],["T_VARIABLE","$this",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","isPlain",250],"(",")",")",["T_WHITESPACE"," ",250],"{",["T_WHITESPACE","\n            ",250],["T_RETURN","return",251],["T_WHITESPACE"," ",251],["T_VARIABLE","$text",251],";",["T_WHITESPACE","\n        ",251],"}",["T_WHITESPACE","\n\n        ",252],["T_RETURN","return",254],["T_WHITESPACE"," ",254],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","_applyInlineCss",254],"(",["T_VARIABLE","$text",254],")",";",["T_WHITESPACE","\n    ",254],"}",["T_WHITESPACE","\n\n    ",255],["T_DOC_COMMENT","\/**\n     * Retrieve included template\n     *\n     * @param string $templateCode\n     * @param array $variables\n     * @return string\n     *\/",257],["T_WHITESPACE","\n    ",263],["T_PUBLIC","public",264],["T_WHITESPACE"," ",264],["T_FUNCTION","function",264],["T_WHITESPACE"," ",264],["T_STRING","getInclude",264],"(",["T_VARIABLE","$templateCode",264],",",["T_WHITESPACE"," ",264],["T_ARRAY","array",264],["T_WHITESPACE"," ",264],["T_VARIABLE","$variables",264],")",["T_WHITESPACE","\n    ",264],"{",["T_WHITESPACE","\n        ",265],["T_RETURN","return",266],["T_WHITESPACE"," ",266],["T_STRING","Mage",266],["T_DOUBLE_COLON","::",266],["T_STRING","getModel",266],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter\/template'",266],")",["T_WHITESPACE","\n            ",266],["T_OBJECT_OPERATOR","->",267],["T_STRING","loadByCode",267],"(",["T_VARIABLE","$templateCode",267],")",["T_WHITESPACE","\n            ",267],["T_OBJECT_OPERATOR","->",268],["T_STRING","getProcessedTemplate",268],"(",["T_VARIABLE","$variables",268],")",";",["T_WHITESPACE","\n    ",268],"}",["T_WHITESPACE","\n\n    ",269],["T_DOC_COMMENT","\/**\n     * Retrieve mail object instance\n     *\n     * @return Zend_Mail\n     * @deprecated since 1.4.0.1\n     *\/",271],["T_WHITESPACE","\n    ",276],["T_PUBLIC","public",277],["T_WHITESPACE"," ",277],["T_FUNCTION","function",277],["T_WHITESPACE"," ",277],["T_STRING","getMail",277],"(",")",["T_WHITESPACE","\n    ",277],"{",["T_WHITESPACE","\n        ",278],["T_IF","if",279],["T_WHITESPACE"," ",279],"(",["T_STRING","is_null",279],"(",["T_VARIABLE","$this",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","_mail",279],")",")",["T_WHITESPACE"," ",279],"{",["T_WHITESPACE","\n            ",279],["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","_mail",280],["T_WHITESPACE"," ",280],"=",["T_WHITESPACE"," ",280],["T_NEW","new",280],["T_WHITESPACE"," ",280],["T_STRING","Zend_Mail",280],"(",["T_CONSTANT_ENCAPSED_STRING","'utf-8'",280],")",";",["T_WHITESPACE","\n        ",280],"}",["T_WHITESPACE","\n        ",281],["T_RETURN","return",282],["T_WHITESPACE"," ",282],["T_VARIABLE","$this",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","_mail",282],";",["T_WHITESPACE","\n    ",282],"}",["T_WHITESPACE","\n\n\n    ",283],["T_DOC_COMMENT","\/**\n     * Send mail to subscriber\n     *\n     * @param   Mage_Newsletter_Model_Subscriber|string   $subscriber   subscriber Model or E-mail\n     * @param   array                                     $variables    template variables\n     * @param   string|null                               $name         receiver name (if subscriber model not specified)\n     * @param   Mage_Newsletter_Model_Queue|null          $queue        queue model, used for problems reporting.\n     * @return boolean\n     * @deprecated since 1.4.0.1\n     **\/",286],["T_WHITESPACE","\n    ",295],["T_PUBLIC","public",296],["T_WHITESPACE"," ",296],["T_FUNCTION","function",296],["T_WHITESPACE"," ",296],["T_STRING","send",296],"(",["T_VARIABLE","$subscriber",296],",",["T_WHITESPACE"," ",296],["T_ARRAY","array",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$variables",296],["T_WHITESPACE"," ",296],"=",["T_WHITESPACE"," ",296],["T_ARRAY","array",296],"(",")",",",["T_WHITESPACE"," ",296],["T_VARIABLE","$name",296],"=",["T_STRING","null",296],",",["T_WHITESPACE"," ",296],["T_STRING","Mage_Newsletter_Model_Queue",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$queue",296],"=",["T_STRING","null",296],")",["T_WHITESPACE","\n    ",296],"{",["T_WHITESPACE","\n        ",297],["T_IF","if",298],["T_WHITESPACE"," ",298],"(","!",["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","isValidForSend",298],"(",")",")",["T_WHITESPACE"," ",298],"{",["T_WHITESPACE","\n            ",298],["T_RETURN","return",299],["T_WHITESPACE"," ",299],["T_STRING","false",299],";",["T_WHITESPACE","\n        ",299],"}",["T_WHITESPACE","\n\n        ",300],["T_VARIABLE","$email",302],["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],["T_CONSTANT_ENCAPSED_STRING","''",302],";",["T_WHITESPACE","\n        ",302],["T_IF","if",303],["T_WHITESPACE"," ",303],"(",["T_VARIABLE","$subscriber",303],["T_WHITESPACE"," ",303],["T_INSTANCEOF","instanceof",303],["T_WHITESPACE"," ",303],["T_STRING","Mage_Newsletter_Model_Subscriber",303],")",["T_WHITESPACE"," ",303],"{",["T_WHITESPACE","\n            ",303],["T_VARIABLE","$email",304],["T_WHITESPACE"," ",304],"=",["T_WHITESPACE"," ",304],["T_VARIABLE","$subscriber",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","getSubscriberEmail",304],"(",")",";",["T_WHITESPACE","\n            ",304],["T_IF","if",305],["T_WHITESPACE"," ",305],"(",["T_STRING","is_null",305],"(",["T_VARIABLE","$name",305],")",")",["T_WHITESPACE"," ",305],"{",["T_WHITESPACE","\n                ",305],["T_VARIABLE","$name",306],["T_WHITESPACE"," ",306],"=",["T_WHITESPACE"," ",306],["T_VARIABLE","$subscriber",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","getSubscriberFullName",306],"(",")",";",["T_WHITESPACE","\n            ",306],"}",["T_WHITESPACE","\n        ",307],"}",["T_WHITESPACE","\n        ",308],["T_ELSE","else",309],["T_WHITESPACE"," ",309],"{",["T_WHITESPACE","\n            ",309],["T_VARIABLE","$email",310],["T_WHITESPACE"," ",310],"=",["T_WHITESPACE"," ",310],["T_STRING_CAST","(string)",310],["T_WHITESPACE"," ",310],["T_VARIABLE","$subscriber",310],";",["T_WHITESPACE","\n        ",310],"}",["T_WHITESPACE","\n\n        ",311],["T_IF","if",313],["T_WHITESPACE"," ",313],"(",["T_STRING","Mage",313],["T_DOUBLE_COLON","::",313],["T_STRING","getStoreConfigFlag",313],"(",["T_STRING","Mage_Core_Model_Email_Template",313],["T_DOUBLE_COLON","::",313],["T_STRING","XML_PATH_SENDING_SET_RETURN_PATH",313],")",")",["T_WHITESPACE"," ",313],"{",["T_WHITESPACE","\n            ",313],["T_VARIABLE","$this",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","getMail",314],"(",")",["T_OBJECT_OPERATOR","->",314],["T_STRING","setReturnPath",314],"(",["T_VARIABLE","$this",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","getTemplateSenderEmail",314],"(",")",")",";",["T_WHITESPACE","\n        ",314],"}",["T_WHITESPACE","\n\n        ",315],["T_STRING","ini_set",317],"(",["T_CONSTANT_ENCAPSED_STRING","'SMTP'",317],",",["T_WHITESPACE"," ",317],["T_STRING","Mage",317],["T_DOUBLE_COLON","::",317],["T_STRING","getStoreConfig",317],"(",["T_CONSTANT_ENCAPSED_STRING","'system\/smtp\/host'",317],")",")",";",["T_WHITESPACE","\n        ",317],["T_STRING","ini_set",318],"(",["T_CONSTANT_ENCAPSED_STRING","'smtp_port'",318],",",["T_WHITESPACE"," ",318],["T_STRING","Mage",318],["T_DOUBLE_COLON","::",318],["T_STRING","getStoreConfig",318],"(",["T_CONSTANT_ENCAPSED_STRING","'system\/smtp\/port'",318],")",")",";",["T_WHITESPACE","\n\n        ",318],["T_VARIABLE","$mail",320],["T_WHITESPACE"," ",320],"=",["T_WHITESPACE"," ",320],["T_VARIABLE","$this",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","getMail",320],"(",")",";",["T_WHITESPACE","\n        ",320],["T_VARIABLE","$mail",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","addTo",321],"(",["T_VARIABLE","$email",321],",",["T_WHITESPACE"," ",321],["T_VARIABLE","$name",321],")",";",["T_WHITESPACE","\n        ",321],["T_VARIABLE","$text",322],["T_WHITESPACE"," ",322],"=",["T_WHITESPACE"," ",322],["T_VARIABLE","$this",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","getProcessedTemplate",322],"(",["T_VARIABLE","$variables",322],",",["T_WHITESPACE"," ",322],["T_STRING","true",322],")",";",["T_WHITESPACE","\n\n        ",322],["T_IF","if",324],["T_WHITESPACE"," ",324],"(",["T_VARIABLE","$this",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","isPlain",324],"(",")",")",["T_WHITESPACE"," ",324],"{",["T_WHITESPACE","\n            ",324],["T_VARIABLE","$mail",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","setBodyText",325],"(",["T_VARIABLE","$text",325],")",";",["T_WHITESPACE","\n        ",325],"}",["T_WHITESPACE","\n        ",326],["T_ELSE","else",327],["T_WHITESPACE"," ",327],"{",["T_WHITESPACE","\n            ",327],["T_VARIABLE","$mail",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","setBodyHTML",328],"(",["T_VARIABLE","$text",328],")",";",["T_WHITESPACE","\n        ",328],"}",["T_WHITESPACE","\n\n        ",329],["T_VARIABLE","$mail",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","setSubject",331],"(",["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","getProcessedTemplateSubject",331],"(",["T_VARIABLE","$variables",331],")",")",";",["T_WHITESPACE","\n        ",331],["T_VARIABLE","$mail",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","setFrom",332],"(",["T_VARIABLE","$this",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","getTemplateSenderEmail",332],"(",")",",",["T_WHITESPACE"," ",332],["T_VARIABLE","$this",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","getTemplateSenderName",332],"(",")",")",";",["T_WHITESPACE","\n\n        ",332],["T_TRY","try",334],["T_WHITESPACE"," ",334],"{",["T_WHITESPACE","\n            ",334],["T_VARIABLE","$mail",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","send",335],"(",")",";",["T_WHITESPACE","\n            ",335],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","_mail",336],["T_WHITESPACE"," ",336],"=",["T_WHITESPACE"," ",336],["T_STRING","null",336],";",["T_WHITESPACE","\n            ",336],["T_IF","if",337],["T_WHITESPACE"," ",337],"(","!",["T_STRING","is_null",337],"(",["T_VARIABLE","$queue",337],")",")",["T_WHITESPACE"," ",337],"{",["T_WHITESPACE","\n                ",337],["T_VARIABLE","$subscriber",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","received",338],"(",["T_VARIABLE","$queue",338],")",";",["T_WHITESPACE","\n            ",338],"}",["T_WHITESPACE","\n        ",339],"}",["T_WHITESPACE","\n        ",340],["T_CATCH","catch",341],["T_WHITESPACE"," ",341],"(",["T_STRING","Exception",341],["T_WHITESPACE"," ",341],["T_VARIABLE","$e",341],")",["T_WHITESPACE"," ",341],"{",["T_WHITESPACE","\n            ",341],["T_IF","if",342],["T_WHITESPACE"," ",342],"(",["T_VARIABLE","$subscriber",342],["T_WHITESPACE"," ",342],["T_INSTANCEOF","instanceof",342],["T_WHITESPACE"," ",342],["T_STRING","Mage_Newsletter_Model_Subscriber",342],")",["T_WHITESPACE"," ",342],"{",["T_WHITESPACE","\n                ",342],["T_COMMENT","\/\/ If letter sent for subscriber, we create a problem report entry\n",343],["T_WHITESPACE","                ",344],["T_VARIABLE","$problem",344],["T_WHITESPACE"," ",344],"=",["T_WHITESPACE"," ",344],["T_STRING","Mage",344],["T_DOUBLE_COLON","::",344],["T_STRING","getModel",344],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter\/problem'",344],")",";",["T_WHITESPACE","\n                ",344],["T_VARIABLE","$problem",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","addSubscriberData",345],"(",["T_VARIABLE","$subscriber",345],")",";",["T_WHITESPACE","\n                ",345],["T_IF","if",346],["T_WHITESPACE"," ",346],"(","!",["T_STRING","is_null",346],"(",["T_VARIABLE","$queue",346],")",")",["T_WHITESPACE"," ",346],"{",["T_WHITESPACE","\n                    ",346],["T_VARIABLE","$problem",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","addQueueData",347],"(",["T_VARIABLE","$queue",347],")",";",["T_WHITESPACE","\n                ",347],"}",["T_WHITESPACE","\n                ",348],["T_VARIABLE","$problem",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","addErrorData",349],"(",["T_VARIABLE","$e",349],")",";",["T_WHITESPACE","\n                ",349],["T_VARIABLE","$problem",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","save",350],"(",")",";",["T_WHITESPACE","\n\n                ",350],["T_IF","if",352],["T_WHITESPACE"," ",352],"(","!",["T_STRING","is_null",352],"(",["T_VARIABLE","$queue",352],")",")",["T_WHITESPACE"," ",352],"{",["T_WHITESPACE","\n                    ",352],["T_VARIABLE","$subscriber",353],["T_OBJECT_OPERATOR","->",353],["T_STRING","received",353],"(",["T_VARIABLE","$queue",353],")",";",["T_WHITESPACE","\n                ",353],"}",["T_WHITESPACE","\n            ",354],"}",["T_WHITESPACE"," ",355],["T_ELSE","else",355],["T_WHITESPACE"," ",355],"{",["T_WHITESPACE","\n                ",355],["T_COMMENT","\/\/ Otherwise throw error to upper level\n",356],["T_WHITESPACE","                ",357],["T_THROW","throw",357],["T_WHITESPACE"," ",357],["T_VARIABLE","$e",357],";",["T_WHITESPACE","\n            ",357],"}",["T_WHITESPACE","\n            ",358],["T_RETURN","return",359],["T_WHITESPACE"," ",359],["T_STRING","false",359],";",["T_WHITESPACE","\n        ",359],"}",["T_WHITESPACE","\n\n        ",360],["T_RETURN","return",362],["T_WHITESPACE"," ",362],["T_STRING","true",362],";",["T_WHITESPACE","\n    ",362],"}",["T_WHITESPACE","\n\n    ",363],["T_DOC_COMMENT","\/**\n     * Prepare Process (with save)\n     *\n     * @return Mage_Newsletter_Model_Template\n     * @deprecated since 1.4.0.1\n     *\/",365],["T_WHITESPACE","\n    ",370],["T_PUBLIC","public",371],["T_WHITESPACE"," ",371],["T_FUNCTION","function",371],["T_WHITESPACE"," ",371],["T_STRING","preprocess",371],"(",")",["T_WHITESPACE","\n    ",371],"{",["T_WHITESPACE","\n        ",372],["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","_preprocessFlag",373],["T_WHITESPACE"," ",373],"=",["T_WHITESPACE"," ",373],["T_STRING","true",373],";",["T_WHITESPACE","\n        ",373],["T_VARIABLE","$this",374],["T_OBJECT_OPERATOR","->",374],["T_STRING","save",374],"(",")",";",["T_WHITESPACE","\n        ",374],["T_VARIABLE","$this",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","_preprocessFlag",375],["T_WHITESPACE"," ",375],"=",["T_WHITESPACE"," ",375],["T_STRING","false",375],";",["T_WHITESPACE","\n        ",375],["T_RETURN","return",376],["T_WHITESPACE"," ",376],["T_VARIABLE","$this",376],";",["T_WHITESPACE","\n    ",376],"}",["T_WHITESPACE","\n\n    ",377],["T_DOC_COMMENT","\/**\n     * Retrieve processed template subject\n     *\n     * @param array $variables\n     * @return string\n     *\/",379],["T_WHITESPACE","\n    ",384],["T_PUBLIC","public",385],["T_WHITESPACE"," ",385],["T_FUNCTION","function",385],["T_WHITESPACE"," ",385],["T_STRING","getProcessedTemplateSubject",385],"(",["T_ARRAY","array",385],["T_WHITESPACE"," ",385],["T_VARIABLE","$variables",385],")",["T_WHITESPACE","\n    ",385],"{",["T_WHITESPACE","\n        ",386],["T_VARIABLE","$processor",387],["T_WHITESPACE"," ",387],"=",["T_WHITESPACE"," ",387],["T_NEW","new",387],["T_WHITESPACE"," ",387],["T_STRING","Varien_Filter_Template",387],"(",")",";",["T_WHITESPACE","\n\n        ",387],["T_IF","if",389],["T_WHITESPACE"," ",389],"(","!",["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","_preprocessFlag",389],")",["T_WHITESPACE"," ",389],"{",["T_WHITESPACE","\n            ",389],["T_VARIABLE","$variables",390],"[",["T_CONSTANT_ENCAPSED_STRING","'this'",390],"]",["T_WHITESPACE"," ",390],"=",["T_WHITESPACE"," ",390],["T_VARIABLE","$this",390],";",["T_WHITESPACE","\n        ",390],"}",["T_WHITESPACE","\n\n        ",391],["T_VARIABLE","$processor",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","setVariables",393],"(",["T_VARIABLE","$variables",393],")",";",["T_WHITESPACE","\n        ",393],["T_RETURN","return",394],["T_WHITESPACE"," ",394],["T_VARIABLE","$processor",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","filter",394],"(",["T_VARIABLE","$this",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","getTemplateSubject",394],"(",")",")",";",["T_WHITESPACE","\n    ",394],"}",["T_WHITESPACE","\n\n    ",395],["T_DOC_COMMENT","\/**\n     * Retrieve template text wrapper\n     *\n     * @return string\n     *\/",397],["T_WHITESPACE","\n    ",401],["T_PUBLIC","public",402],["T_WHITESPACE"," ",402],["T_FUNCTION","function",402],["T_WHITESPACE"," ",402],["T_STRING","getTemplateText",402],"(",")",["T_WHITESPACE","\n    ",402],"{",["T_WHITESPACE","\n        ",403],["T_IF","if",404],["T_WHITESPACE"," ",404],"(","!",["T_VARIABLE","$this",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","getData",404],"(",["T_CONSTANT_ENCAPSED_STRING","'template_text'",404],")",["T_WHITESPACE"," ",404],["T_BOOLEAN_AND","&&",404],["T_WHITESPACE"," ",404],"!",["T_VARIABLE","$this",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","getId",404],"(",")",")",["T_WHITESPACE"," ",404],"{",["T_WHITESPACE","\n            ",404],["T_VARIABLE","$this",405],["T_OBJECT_OPERATOR","->",405],["T_STRING","setData",405],"(",["T_CONSTANT_ENCAPSED_STRING","'template_text'",405],",",["T_WHITESPACE","\n                ",405],["T_STRING","Mage",406],["T_DOUBLE_COLON","::",406],["T_STRING","helper",406],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter'",406],")",["T_OBJECT_OPERATOR","->",406],["T_STRING","__",406],"(",["T_CONSTANT_ENCAPSED_STRING","'Follow this link to unsubscribe <!-- This tag is for unsubscribe link  --><a href=\"{{var subscriber.getUnsubscriptionLink()}}\">{{var subscriber.getUnsubscriptionLink()}}<\/a>'",406],")",["T_WHITESPACE","\n            ",406],")",";",["T_WHITESPACE","\n        ",407],"}",["T_WHITESPACE","\n\n        ",408],["T_RETURN","return",410],["T_WHITESPACE"," ",410],["T_VARIABLE","$this",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","getData",410],"(",["T_CONSTANT_ENCAPSED_STRING","'template_text'",410],")",";",["T_WHITESPACE","\n    ",410],"}",["T_WHITESPACE","\n",411],"}",["T_WHITESPACE","\n",412]]