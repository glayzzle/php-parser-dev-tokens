[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Newsletter\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n\n",25],["T_DOC_COMMENT","\/**\n * Newsletter queue collection.\n *\n * @category    Mage\n * @package     Mage_Newsletter\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",28],["T_WHITESPACE","\n",34],["T_CLASS","class",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Newsletter_Model_Resource_Queue_Collection",35],["T_WHITESPACE"," ",35],["T_EXTENDS","extends",35],["T_WHITESPACE"," ",35],["T_STRING","Mage_Core_Model_Resource_Db_Collection_Abstract",35],["T_WHITESPACE","\n",35],"{",["T_WHITESPACE","\n    ",36],["T_DOC_COMMENT","\/**\n     * True when subscribers info joined\n     *\n     * @var bool\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_addSubscribersFlag",42],["T_WHITESPACE","   ",42],"=",["T_WHITESPACE"," ",42],["T_STRING","false",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * True when filtered by store\n     *\n     * @var bool\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_isStoreFilter",49],["T_WHITESPACE","        ",49],"=",["T_WHITESPACE"," ",49],["T_STRING","false",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Initializes collection\n     *\n     *\/",51],["T_WHITESPACE","\n    ",54],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_FUNCTION","function",55],["T_WHITESPACE"," ",55],["T_STRING","_construct",55],"(",")",["T_WHITESPACE","\n    ",55],"{",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","_map",57],"[",["T_CONSTANT_ENCAPSED_STRING","'fields'",57],"]","[",["T_CONSTANT_ENCAPSED_STRING","'queue_id'",57],"]",["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'main_table.queue_id'",57],";",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","_init",58],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter\/queue'",58],")",";",["T_WHITESPACE","\n    ",58],"}",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * Joines templates information\n     *\n     * @deprecated since 1.4.0.1\n     *\n     * @return Mage_Newsletter_Model_Resource_Queue_Collection\n     *\/",61],["T_WHITESPACE","\n    ",67],["T_PUBLIC","public",68],["T_WHITESPACE"," ",68],["T_FUNCTION","function",68],["T_WHITESPACE"," ",68],["T_STRING","addTemplateInfo",68],"(",")",["T_WHITESPACE","\n    ",68],"{",["T_WHITESPACE","\n        ",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getSelect",70],"(",")",["T_OBJECT_OPERATOR","->",70],["T_STRING","joinLeft",70],"(",["T_ARRAY","array",70],"(",["T_CONSTANT_ENCAPSED_STRING","'template'",70],["T_DOUBLE_ARROW","=>",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getTable",70],"(",["T_CONSTANT_ENCAPSED_STRING","'template'",70],")",")",",",["T_WHITESPACE","\n            ",70],["T_CONSTANT_ENCAPSED_STRING","'template.template_id=main_table.template_id'",71],",",["T_WHITESPACE","\n            ",71],["T_ARRAY","array",72],"(",["T_CONSTANT_ENCAPSED_STRING","'template_subject'",72],",",["T_CONSTANT_ENCAPSED_STRING","'template_sender_name'",72],",",["T_CONSTANT_ENCAPSED_STRING","'template_sender_email'",72],")",["T_WHITESPACE","\n        ",72],")",";",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","_joinedTables",74],"[",["T_CONSTANT_ENCAPSED_STRING","'template'",74],"]",["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_STRING","true",74],";",["T_WHITESPACE","\n        ",74],["T_RETURN","return",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],";",["T_WHITESPACE","\n    ",75],"}",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * Adds subscribers info to selelect\n     *\n     * @return Mage_Newsletter_Model_Resource_Queue_Collection\n     *\/",78],["T_WHITESPACE","\n    ",82],["T_PROTECTED","protected",83],["T_WHITESPACE"," ",83],["T_FUNCTION","function",83],["T_WHITESPACE"," ",83],["T_STRING","_addSubscriberInfoToSelect",83],"(",")",["T_WHITESPACE","\n    ",83],"{",["T_WHITESPACE","\n        ",84],["T_DOC_COMMENT","\/** @var $select Varien_Db_Select *\/",85],["T_WHITESPACE","\n        ",85],["T_VARIABLE","$select",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getConnection",86],"(",")",["T_OBJECT_OPERATOR","->",86],["T_STRING","select",86],"(",")",["T_WHITESPACE","\n            ",86],["T_OBJECT_OPERATOR","->",87],["T_STRING","from",87],"(",["T_ARRAY","array",87],"(",["T_CONSTANT_ENCAPSED_STRING","'qlt'",87],["T_WHITESPACE"," ",87],["T_DOUBLE_ARROW","=>",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getTable",87],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter\/queue_link'",87],")",")",",",["T_WHITESPACE"," ",87],["T_CONSTANT_ENCAPSED_STRING","'COUNT(qlt.queue_link_id)'",87],")",["T_WHITESPACE","\n            ",87],["T_OBJECT_OPERATOR","->",88],["T_STRING","where",88],"(",["T_CONSTANT_ENCAPSED_STRING","'qlt.queue_id = main_table.queue_id'",88],")",";",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$totalExpr",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_NEW","new",89],["T_WHITESPACE"," ",89],["T_STRING","Zend_Db_Expr",89],"(",["T_STRING","sprintf",89],"(",["T_CONSTANT_ENCAPSED_STRING","'(%s)'",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$select",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","assemble",89],"(",")",")",")",";",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$select",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","getConnection",90],"(",")",["T_OBJECT_OPERATOR","->",90],["T_STRING","select",90],"(",")",["T_WHITESPACE","\n            ",90],["T_OBJECT_OPERATOR","->",91],["T_STRING","from",91],"(",["T_ARRAY","array",91],"(",["T_CONSTANT_ENCAPSED_STRING","'qls'",91],["T_WHITESPACE"," ",91],["T_DOUBLE_ARROW","=>",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getTable",91],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter\/queue_link'",91],")",")",",",["T_WHITESPACE"," ",91],["T_CONSTANT_ENCAPSED_STRING","'COUNT(qls.queue_link_id)'",91],")",["T_WHITESPACE","\n            ",91],["T_OBJECT_OPERATOR","->",92],["T_STRING","where",92],"(",["T_CONSTANT_ENCAPSED_STRING","'qls.queue_id = main_table.queue_id'",92],")",["T_WHITESPACE","\n            ",92],["T_OBJECT_OPERATOR","->",93],["T_STRING","where",93],"(",["T_CONSTANT_ENCAPSED_STRING","'qls.letter_sent_at IS NOT NULL'",93],")",";",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$sentExpr",94],["T_WHITESPACE","  ",94],"=",["T_WHITESPACE"," ",94],["T_NEW","new",94],["T_WHITESPACE"," ",94],["T_STRING","Zend_Db_Expr",94],"(",["T_STRING","sprintf",94],"(",["T_CONSTANT_ENCAPSED_STRING","'(%s)'",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$select",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","assemble",94],"(",")",")",")",";",["T_WHITESPACE","\n\n        ",94],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getSelect",96],"(",")",["T_OBJECT_OPERATOR","->",96],["T_STRING","columns",96],"(",["T_ARRAY","array",96],"(",["T_WHITESPACE","\n            ",96],["T_CONSTANT_ENCAPSED_STRING","'subscribers_sent'",97],["T_WHITESPACE","  ",97],["T_DOUBLE_ARROW","=>",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$sentExpr",97],",",["T_WHITESPACE","\n            ",97],["T_CONSTANT_ENCAPSED_STRING","'subscribers_total'",98],["T_WHITESPACE"," ",98],["T_DOUBLE_ARROW","=>",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$totalExpr",98],["T_WHITESPACE","\n        ",98],")",")",";",["T_WHITESPACE","\n        ",99],["T_RETURN","return",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],";",["T_WHITESPACE","\n    ",100],"}",["T_WHITESPACE","\n\n    ",101],["T_DOC_COMMENT","\/**\n     * Adds subscribers info to select and loads collection\n     *\n     * @param bool $printQuery\n     * @param bool $logQuery\n     * @return Mage_Newsletter_Model_Resource_Queue_Collection\n     *\/",103],["T_WHITESPACE","\n    ",109],["T_PUBLIC","public",110],["T_WHITESPACE"," ",110],["T_FUNCTION","function",110],["T_WHITESPACE"," ",110],["T_STRING","load",110],"(",["T_VARIABLE","$printQuery",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_STRING","false",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$logQuery",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_STRING","false",110],")",["T_WHITESPACE","\n    ",110],"{",["T_WHITESPACE","\n        ",111],["T_IF","if",112],["T_WHITESPACE"," ",112],"(",["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","_addSubscribersFlag",112],["T_WHITESPACE"," ",112],["T_BOOLEAN_AND","&&",112],["T_WHITESPACE"," ",112],"!",["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","isLoaded",112],"(",")",")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n            ",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","_addSubscriberInfoToSelect",113],"(",")",";",["T_WHITESPACE","\n        ",113],"}",["T_WHITESPACE","\n        ",114],["T_RETURN","return",115],["T_WHITESPACE"," ",115],["T_STRING","parent",115],["T_DOUBLE_COLON","::",115],["T_STRING","load",115],"(",["T_VARIABLE","$printQuery",115],",",["T_WHITESPACE"," ",115],["T_VARIABLE","$logQuery",115],")",";",["T_WHITESPACE","\n    ",115],"}",["T_WHITESPACE","\n\n    ",116],["T_DOC_COMMENT","\/**\n     * Joines subscribers information\n     *\n     * @return Mage_Newsletter_Model_Resource_Queue_Collection\n     *\/",118],["T_WHITESPACE","\n    ",122],["T_PUBLIC","public",123],["T_WHITESPACE"," ",123],["T_FUNCTION","function",123],["T_WHITESPACE"," ",123],["T_STRING","addSubscribersInfo",123],"(",")",["T_WHITESPACE","\n    ",123],"{",["T_WHITESPACE","\n        ",124],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","_addSubscribersFlag",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_STRING","true",125],";",["T_WHITESPACE","\n        ",125],["T_RETURN","return",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],";",["T_WHITESPACE","\n    ",126],"}",["T_WHITESPACE","\n\n    ",127],["T_DOC_COMMENT","\/**\n     * Checks if field is 'subscribers_total', 'subscribers_sent'\n     * to add specific filter or adds reguler filter\n     *\n     * @param string $field\n     * @param mixed $condition\n     * @return Mage_Newsletter_Model_Resource_Queue_Collection\n     *\/",129],["T_WHITESPACE","\n    ",136],["T_PUBLIC","public",137],["T_WHITESPACE"," ",137],["T_FUNCTION","function",137],["T_WHITESPACE"," ",137],["T_STRING","addFieldToFilter",137],"(",["T_VARIABLE","$field",137],",",["T_WHITESPACE"," ",137],["T_VARIABLE","$condition",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_STRING","null",137],")",["T_WHITESPACE","\n    ",137],"{",["T_WHITESPACE","\n        ",138],["T_IF","if",139],["T_WHITESPACE"," ",139],"(",["T_STRING","in_array",139],"(",["T_VARIABLE","$field",139],",",["T_WHITESPACE"," ",139],["T_ARRAY","array",139],"(",["T_CONSTANT_ENCAPSED_STRING","'subscribers_total'",139],",",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'subscribers_sent'",139],")",")",")",["T_WHITESPACE"," ",139],"{",["T_WHITESPACE","\n            ",139],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","addFieldToFilter",140],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.queue_id'",140],",",["T_WHITESPACE"," ",140],["T_ARRAY","array",140],"(",["T_CONSTANT_ENCAPSED_STRING","'in'",140],["T_DOUBLE_ARROW","=>",140],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","_getIdsFromLink",140],"(",["T_VARIABLE","$field",140],",",["T_WHITESPACE"," ",140],["T_VARIABLE","$condition",140],")",")",")",";",["T_WHITESPACE","\n            ",140],["T_RETURN","return",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$this",141],";",["T_WHITESPACE","\n        ",141],"}",["T_WHITESPACE"," ",142],["T_ELSE","else",142],["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n            ",142],["T_RETURN","return",143],["T_WHITESPACE"," ",143],["T_STRING","parent",143],["T_DOUBLE_COLON","::",143],["T_STRING","addFieldToFilter",143],"(",["T_VARIABLE","$field",143],",",["T_WHITESPACE"," ",143],["T_VARIABLE","$condition",143],")",";",["T_WHITESPACE","\n        ",143],"}",["T_WHITESPACE","\n    ",144],"}",["T_WHITESPACE","\n\n    ",145],["T_DOC_COMMENT","\/**\n     * Returns ids from queue_link table\n     *\n     * @param string $field\n     * @param mixed $condition\n     * @return array\n     *\/",147],["T_WHITESPACE","\n    ",153],["T_PROTECTED","protected",154],["T_WHITESPACE"," ",154],["T_FUNCTION","function",154],["T_WHITESPACE"," ",154],["T_STRING","_getIdsFromLink",154],"(",["T_VARIABLE","$field",154],",",["T_WHITESPACE"," ",154],["T_VARIABLE","$condition",154],")",["T_WHITESPACE","\n    ",154],"{",["T_WHITESPACE","\n        ",155],["T_VARIABLE","$select",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","getConnection",156],"(",")",["T_OBJECT_OPERATOR","->",156],["T_STRING","select",156],"(",")",["T_WHITESPACE","\n            ",156],["T_OBJECT_OPERATOR","->",157],["T_STRING","from",157],"(",["T_WHITESPACE","\n                ",157],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","getTable",158],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter\/queue_link'",158],")",",",["T_WHITESPACE","\n                ",158],["T_ARRAY","array",159],"(",["T_CONSTANT_ENCAPSED_STRING","'queue_id'",159],",",["T_WHITESPACE"," ",159],["T_CONSTANT_ENCAPSED_STRING","'total'",159],["T_WHITESPACE"," ",159],["T_DOUBLE_ARROW","=>",159],["T_WHITESPACE"," ",159],["T_NEW","new",159],["T_WHITESPACE"," ",159],["T_STRING","Zend_Db_Expr",159],"(",["T_CONSTANT_ENCAPSED_STRING","'COUNT(queue_link_id)'",159],")",")",["T_WHITESPACE","\n            ",159],")",["T_WHITESPACE","\n            ",160],["T_OBJECT_OPERATOR","->",161],["T_STRING","group",161],"(",["T_CONSTANT_ENCAPSED_STRING","'queue_id'",161],")",["T_WHITESPACE","\n            ",161],["T_OBJECT_OPERATOR","->",162],["T_STRING","having",162],"(",["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","_getConditionSql",162],"(",["T_CONSTANT_ENCAPSED_STRING","'total'",162],",",["T_WHITESPACE"," ",162],["T_VARIABLE","$condition",162],")",")",";",["T_WHITESPACE","\n\n        ",162],["T_IF","if",164],["T_WHITESPACE"," ",164],"(",["T_VARIABLE","$field",164],["T_WHITESPACE"," ",164],["T_IS_EQUAL","==",164],["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","'subscribers_sent'",164],")",["T_WHITESPACE"," ",164],"{",["T_WHITESPACE","\n            ",164],["T_VARIABLE","$select",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","where",165],"(",["T_CONSTANT_ENCAPSED_STRING","'letter_sent_at IS NOT NULL'",165],")",";",["T_WHITESPACE","\n        ",165],"}",["T_WHITESPACE","\n\n        ",166],["T_VARIABLE","$idList",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","getConnection",168],"(",")",["T_OBJECT_OPERATOR","->",168],["T_STRING","fetchCol",168],"(",["T_VARIABLE","$select",168],")",";",["T_WHITESPACE","\n\n        ",168],["T_IF","if",170],["T_WHITESPACE"," ",170],"(",["T_STRING","count",170],"(",["T_VARIABLE","$idList",170],")",")",["T_WHITESPACE"," ",170],"{",["T_WHITESPACE","\n            ",170],["T_RETURN","return",171],["T_WHITESPACE"," ",171],["T_VARIABLE","$idList",171],";",["T_WHITESPACE","\n        ",171],"}",["T_WHITESPACE","\n\n        ",172],["T_RETURN","return",174],["T_WHITESPACE"," ",174],["T_ARRAY","array",174],"(",["T_LNUMBER","0",174],")",";",["T_WHITESPACE","\n    ",174],"}",["T_WHITESPACE","\n\n    ",175],["T_DOC_COMMENT","\/**\n     * Set filter for queue by subscriber.\n     *\n     * @param int $subscriberId\n     * @return Mage_Newsletter_Model_Resource_Queue_Collection\n     *\/",177],["T_WHITESPACE","\n    ",182],["T_PUBLIC","public",183],["T_WHITESPACE"," ",183],["T_FUNCTION","function",183],["T_WHITESPACE"," ",183],["T_STRING","addSubscriberFilter",183],"(",["T_VARIABLE","$subscriberId",183],")",["T_WHITESPACE","\n    ",183],"{",["T_WHITESPACE","\n        ",184],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","getSelect",185],"(",")",["T_OBJECT_OPERATOR","->",185],["T_STRING","join",185],"(",["T_ARRAY","array",185],"(",["T_CONSTANT_ENCAPSED_STRING","'link'",185],["T_DOUBLE_ARROW","=>",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","getTable",185],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter\/queue_link'",185],")",")",",",["T_WHITESPACE","\n            ",185],["T_CONSTANT_ENCAPSED_STRING","'main_table.queue_id=link.queue_id'",186],",",["T_WHITESPACE","\n            ",186],["T_ARRAY","array",187],"(",["T_CONSTANT_ENCAPSED_STRING","'letter_sent_at'",187],")",["T_WHITESPACE","\n        ",187],")",["T_WHITESPACE","\n        ",188],["T_OBJECT_OPERATOR","->",189],["T_STRING","where",189],"(",["T_CONSTANT_ENCAPSED_STRING","'link.subscriber_id = ?'",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$subscriberId",189],")",";",["T_WHITESPACE","\n\n        ",189],["T_RETURN","return",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$this",191],";",["T_WHITESPACE","\n    ",191],"}",["T_WHITESPACE","\n\n    ",192],["T_DOC_COMMENT","\/**\n     * Add filter by only ready fot sending item\n     *\n     * @return Mage_Newsletter_Model_Resource_Queue_Collection\n     *\/",194],["T_WHITESPACE","\n    ",198],["T_PUBLIC","public",199],["T_WHITESPACE"," ",199],["T_FUNCTION","function",199],["T_WHITESPACE"," ",199],["T_STRING","addOnlyForSendingFilter",199],"(",")",["T_WHITESPACE","\n    ",199],"{",["T_WHITESPACE","\n        ",200],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","getSelect",201],"(",")",["T_WHITESPACE","\n            ",201],["T_OBJECT_OPERATOR","->",202],["T_STRING","where",202],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.queue_status in (?)'",202],",",["T_WHITESPACE"," ",202],["T_ARRAY","array",202],"(",["T_STRING","Mage_Newsletter_Model_Queue",202],["T_DOUBLE_COLON","::",202],["T_STRING","STATUS_SENDING",202],",",["T_WHITESPACE","\n                                                            ",202],["T_STRING","Mage_Newsletter_Model_Queue",203],["T_DOUBLE_COLON","::",203],["T_STRING","STATUS_NEVER",203],")",")",["T_WHITESPACE","\n            ",203],["T_OBJECT_OPERATOR","->",204],["T_STRING","where",204],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.queue_start_at < ?'",204],",",["T_WHITESPACE"," ",204],["T_STRING","Mage",204],["T_DOUBLE_COLON","::",204],["T_STRING","getSingleton",204],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/date'",204],")",["T_OBJECT_OPERATOR","->",204],["T_STRING","gmtdate",204],"(",")",")",["T_WHITESPACE","\n            ",204],["T_OBJECT_OPERATOR","->",205],["T_STRING","where",205],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.queue_start_at IS NOT NULL'",205],")",";",["T_WHITESPACE","\n\n        ",205],["T_RETURN","return",207],["T_WHITESPACE"," ",207],["T_VARIABLE","$this",207],";",["T_WHITESPACE","\n    ",207],"}",["T_WHITESPACE","\n\n    ",208],["T_DOC_COMMENT","\/**\n     * Add filter by only not sent items\n     *\n     * @return Mage_Newsletter_Model_Resource_Queue_Collection\n     *\/",210],["T_WHITESPACE","\n    ",214],["T_PUBLIC","public",215],["T_WHITESPACE"," ",215],["T_FUNCTION","function",215],["T_WHITESPACE"," ",215],["T_STRING","addOnlyUnsentFilter",215],"(",")",["T_WHITESPACE","\n    ",215],"{",["T_WHITESPACE","\n        ",216],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","addFieldToFilter",217],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.queue_status'",217],",",["T_WHITESPACE"," ",217],["T_STRING","Mage_Newsletter_Model_Queue",217],["T_DOUBLE_COLON","::",217],["T_STRING","STATUS_NEVER",217],")",";",["T_WHITESPACE","\n\n           ",217],["T_RETURN","return",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$this",219],";",["T_WHITESPACE","\n    ",219],"}",["T_WHITESPACE","\n\n    ",220],["T_DOC_COMMENT","\/**\n     * Returns options array\n     *\n     * @return array\n     *\/",222],["T_WHITESPACE","\n    ",226],["T_PUBLIC","public",227],["T_WHITESPACE"," ",227],["T_FUNCTION","function",227],["T_WHITESPACE"," ",227],["T_STRING","toOptionArray",227],"(",")",["T_WHITESPACE","\n    ",227],"{",["T_WHITESPACE","\n        ",228],["T_RETURN","return",229],["T_WHITESPACE"," ",229],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","_toOptionArray",229],"(",["T_CONSTANT_ENCAPSED_STRING","'queue_id'",229],",",["T_WHITESPACE"," ",229],["T_CONSTANT_ENCAPSED_STRING","'template_subject'",229],")",";",["T_WHITESPACE","\n    ",229],"}",["T_WHITESPACE","\n\n    ",230],["T_DOC_COMMENT","\/**\n     * Filter collection by specified store ids\n     *\n     * @param array|int $storeIds\n     * @return Mage_Newsletter_Model_Resource_Queue_Collection\n     *\/",232],["T_WHITESPACE","\n    ",237],["T_PUBLIC","public",238],["T_WHITESPACE"," ",238],["T_FUNCTION","function",238],["T_WHITESPACE"," ",238],["T_STRING","addStoreFilter",238],"(",["T_VARIABLE","$storeIds",238],")",["T_WHITESPACE","\n    ",238],"{",["T_WHITESPACE","\n        ",239],["T_IF","if",240],["T_WHITESPACE"," ",240],"(","!",["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","_isStoreFilter",240],")",["T_WHITESPACE"," ",240],"{",["T_WHITESPACE","\n            ",240],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","getSelect",241],"(",")",["T_OBJECT_OPERATOR","->",241],["T_STRING","joinInner",241],"(",["T_ARRAY","array",241],"(",["T_CONSTANT_ENCAPSED_STRING","'store_link'",241],["T_WHITESPACE"," ",241],["T_DOUBLE_ARROW","=>",241],["T_WHITESPACE"," ",241],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","getTable",241],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter\/queue_store_link'",241],")",")",",",["T_WHITESPACE","\n                ",241],["T_CONSTANT_ENCAPSED_STRING","'main_table.queue_id = store_link.queue_id'",242],",",["T_WHITESPACE"," ",242],["T_ARRAY","array",242],"(",")",["T_WHITESPACE","\n            ",242],")",["T_WHITESPACE","\n            ",243],["T_OBJECT_OPERATOR","->",244],["T_STRING","where",244],"(",["T_CONSTANT_ENCAPSED_STRING","'store_link.store_id IN (?)'",244],",",["T_WHITESPACE"," ",244],["T_VARIABLE","$storeIds",244],")",["T_WHITESPACE","\n            ",244],["T_OBJECT_OPERATOR","->",245],["T_STRING","group",245],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.queue_id'",245],")",";",["T_WHITESPACE","\n            ",245],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","_isStoreFilter",246],["T_WHITESPACE"," ",246],"=",["T_WHITESPACE"," ",246],["T_STRING","true",246],";",["T_WHITESPACE","\n        ",246],"}",["T_WHITESPACE","\n        ",247],["T_RETURN","return",248],["T_WHITESPACE"," ",248],["T_VARIABLE","$this",248],";",["T_WHITESPACE","\n    ",248],"}",["T_WHITESPACE","\n",249],"}",["T_WHITESPACE","\n",250]]