[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Magento\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http:\/\/opensource.org\/licenses\/osl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@magento.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade Magento to newer\n * versions in the future. If you wish to customize Magento for your\n * needs please refer to http:\/\/www.magento.com for more information.\n *\n * @category    Mage\n * @package     Mage_Newsletter\n * @copyright  Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http:\/\/www.magento.com)\n * @license    http:\/\/opensource.org\/licenses\/osl-3.0.php  Open Software License (OSL 3.0)\n *\/",2],["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * Newsletter queue model.\n *\n * @method Mage_Newsletter_Model_Resource_Queue _getResource()\n * @method Mage_Newsletter_Model_Resource_Queue getResource()\n * @method int getTemplateId()\n * @method Mage_Newsletter_Model_Queue setTemplateId(int $value)\n * @method int getNewsletterType()\n * @method Mage_Newsletter_Model_Queue setNewsletterType(int $value)\n * @method string getNewsletterText()\n * @method Mage_Newsletter_Model_Queue setNewsletterText(string $value)\n * @method string getNewsletterStyles()\n * @method Mage_Newsletter_Model_Queue setNewsletterStyles(string $value)\n * @method string getNewsletterSubject()\n * @method Mage_Newsletter_Model_Queue setNewsletterSubject(string $value)\n * @method string getNewsletterSenderName()\n * @method Mage_Newsletter_Model_Queue setNewsletterSenderName(string $value)\n * @method string getNewsletterSenderEmail()\n * @method Mage_Newsletter_Model_Queue setNewsletterSenderEmail(string $value)\n * @method int getQueueStatus()\n * @method Mage_Newsletter_Model_Queue setQueueStatus(int $value)\n * @method string getQueueStartAt()\n * @method Mage_Newsletter_Model_Queue setQueueStartAt(string $value)\n * @method string getQueueFinishAt()\n * @method Mage_Newsletter_Model_Queue setQueueFinishAt(string $value)\n *\n * @category    Mage\n * @package     Mage_Newsletter\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",27],["T_WHITESPACE","\n",56],["T_CLASS","class",57],["T_WHITESPACE"," ",57],["T_STRING","Mage_Newsletter_Model_Queue",57],["T_WHITESPACE"," ",57],["T_EXTENDS","extends",57],["T_WHITESPACE"," ",57],["T_STRING","Mage_Core_Model_Template",57],["T_WHITESPACE","\n",57],"{",["T_WHITESPACE","\n    ",58],["T_DOC_COMMENT","\/**\n     * Newsletter Template object\n     *\n     * @var Mage_Newsletter_Model_Template\n     *\/",59],["T_WHITESPACE","\n    ",63],["T_PROTECTED","protected",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$_template",64],";",["T_WHITESPACE","\n\n    ",64],["T_DOC_COMMENT","\/**\n     * Subscribers collection\n     * @var Varien_Data_Collection_Db\n     *\/",66],["T_WHITESPACE","\n    ",69],["T_PROTECTED","protected",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$_subscribersCollection",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_STRING","null",70],";",["T_WHITESPACE","\n\n    ",70],["T_DOC_COMMENT","\/**\n     * save template flag\n     *\n     * @var boolean\n     * @deprecated since 1.4.0.1\n     *\/",72],["T_WHITESPACE","\n    ",77],["T_PROTECTED","protected",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$_saveTemplateFlag",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_STRING","false",78],";",["T_WHITESPACE","\n\n    ",78],["T_DOC_COMMENT","\/**\n     * Save stores flag.\n     *\n     * @var boolean\n     *\/",80],["T_WHITESPACE","\n    ",84],["T_PROTECTED","protected",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$_saveStoresFlag",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_STRING","false",85],";",["T_WHITESPACE","\n\n    ",85],["T_DOC_COMMENT","\/**\n     * Stores assigned to queue.\n     *\n     * @var array\n     *\/",87],["T_WHITESPACE","\n    ",91],["T_PROTECTED","protected",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$_stores",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_ARRAY","array",92],"(",")",";",["T_WHITESPACE","\n\n    ",92],["T_CONST","const",94],["T_WHITESPACE"," ",94],["T_STRING","STATUS_NEVER",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_LNUMBER","0",94],";",["T_WHITESPACE","\n    ",94],["T_CONST","const",95],["T_WHITESPACE"," ",95],["T_STRING","STATUS_SENDING",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_LNUMBER","1",95],";",["T_WHITESPACE","\n    ",95],["T_CONST","const",96],["T_WHITESPACE"," ",96],["T_STRING","STATUS_CANCEL",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_LNUMBER","2",96],";",["T_WHITESPACE","\n    ",96],["T_CONST","const",97],["T_WHITESPACE"," ",97],["T_STRING","STATUS_SENT",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_LNUMBER","3",97],";",["T_WHITESPACE","\n    ",97],["T_CONST","const",98],["T_WHITESPACE"," ",98],["T_STRING","STATUS_PAUSE",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_LNUMBER","4",98],";",["T_WHITESPACE","\n\n    ",98],["T_DOC_COMMENT","\/**\n     * Initialize resource model\n     *\/",100],["T_WHITESPACE","\n    ",102],["T_PROTECTED","protected",103],["T_WHITESPACE"," ",103],["T_FUNCTION","function",103],["T_WHITESPACE"," ",103],["T_STRING","_construct",103],"(",")",["T_WHITESPACE","\n    ",103],"{",["T_WHITESPACE","\n        ",104],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","_init",105],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter\/queue'",105],")",";",["T_WHITESPACE","\n    ",105],"}",["T_WHITESPACE","\n\n    ",106],["T_DOC_COMMENT","\/**\n     * Return: is this queue newly created or not.\n     *\n     * @return boolean\n     *\/",108],["T_WHITESPACE","\n    ",112],["T_PUBLIC","public",113],["T_WHITESPACE"," ",113],["T_FUNCTION","function",113],["T_WHITESPACE"," ",113],["T_STRING","isNew",113],"(",")",["T_WHITESPACE","\n    ",113],"{",["T_WHITESPACE","\n        ",114],["T_RETURN","return",115],["T_WHITESPACE"," ",115],"(",["T_STRING","is_null",115],"(",["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","getQueueStatus",115],"(",")",")",")",";",["T_WHITESPACE","\n    ",115],"}",["T_WHITESPACE","\n\n    ",116],["T_DOC_COMMENT","\/**\n     * Returns subscribers collection for this queue\n     *\n     * @return Varien_Data_Collection_Db\n     *\/",118],["T_WHITESPACE","\n    ",122],["T_PUBLIC","public",123],["T_WHITESPACE"," ",123],["T_FUNCTION","function",123],["T_WHITESPACE"," ",123],["T_STRING","getSubscribersCollection",123],"(",")",["T_WHITESPACE","\n    ",123],"{",["T_WHITESPACE","\n        ",124],["T_IF","if",125],["T_WHITESPACE"," ",125],"(",["T_STRING","is_null",125],"(",["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","_subscribersCollection",125],")",")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n            ",125],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","_subscribersCollection",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_STRING","Mage",126],["T_DOUBLE_COLON","::",126],["T_STRING","getResourceModel",126],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter\/subscriber_collection'",126],")",["T_WHITESPACE","\n                ",126],["T_OBJECT_OPERATOR","->",127],["T_STRING","useQueue",127],"(",["T_VARIABLE","$this",127],")",";",["T_WHITESPACE","\n        ",127],"}",["T_WHITESPACE","\n\n        ",128],["T_RETURN","return",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","_subscribersCollection",130],";",["T_WHITESPACE","\n    ",130],"}",["T_WHITESPACE","\n\n    ",131],["T_DOC_COMMENT","\/**\n     * Add template data to queue.\n     *\n     * @param Varien_Object $data\n     * @return Mage_Newsletter_Model_Queue\n     * @deprecated since 1.4.0.1\n     *\/",133],["T_WHITESPACE","\n    ",139],["T_PUBLIC","public",140],["T_WHITESPACE"," ",140],["T_FUNCTION","function",140],["T_WHITESPACE"," ",140],["T_STRING","addTemplateData",140],"(",["T_VARIABLE","$data",140],")",["T_WHITESPACE","\n    ",140],"{",["T_WHITESPACE","\n        ",141],["T_VARIABLE","$template",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","getTemplate",142],"(",")",";",["T_WHITESPACE","\n        ",142],["T_IF","if",143],["T_WHITESPACE"," ",143],"(",["T_VARIABLE","$data",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getTemplateId",143],"(",")",["T_WHITESPACE"," ",143],["T_BOOLEAN_AND","&&",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$data",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getTemplateId",143],"(",")",["T_WHITESPACE"," ",143],["T_IS_NOT_EQUAL","!=",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$template",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getId",143],"(",")",")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n            ",143],["T_VARIABLE","$template",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","load",144],"(",["T_VARIABLE","$data",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","getTemplateId",144],"(",")",")",";",["T_WHITESPACE","\n        ",144],"}",["T_WHITESPACE","\n\n        ",145],["T_RETURN","return",147],["T_WHITESPACE"," ",147],["T_VARIABLE","$this",147],";",["T_WHITESPACE","\n    ",147],"}",["T_WHITESPACE","\n\n    ",148],["T_DOC_COMMENT","\/**\n     * Set $_data['queue_start'] based on string from backend, which based on locale.\n     *\n     * @param string|null $startAt start date of the mailing queue\n     * @return Mage_Newsletter_Model_Queue\n     *\/",150],["T_WHITESPACE","\n    ",155],["T_PUBLIC","public",156],["T_WHITESPACE"," ",156],["T_FUNCTION","function",156],["T_WHITESPACE"," ",156],["T_STRING","setQueueStartAtByString",156],"(",["T_VARIABLE","$startAt",156],")",["T_WHITESPACE","\n    ",156],"{",["T_WHITESPACE","\n        ",157],["T_IF","if",158],"(",["T_STRING","is_null",158],"(",["T_VARIABLE","$startAt",158],")",["T_WHITESPACE"," ",158],["T_BOOLEAN_OR","||",158],["T_WHITESPACE"," ",158],["T_VARIABLE","$startAt",158],["T_WHITESPACE"," ",158],["T_IS_EQUAL","==",158],["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","''",158],")",["T_WHITESPACE"," ",158],"{",["T_WHITESPACE","\n            ",158],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","setQueueStartAt",159],"(",["T_STRING","null",159],")",";",["T_WHITESPACE","\n        ",159],"}",["T_WHITESPACE"," ",160],["T_ELSE","else",160],["T_WHITESPACE"," ",160],"{",["T_WHITESPACE","\n            ",160],["T_VARIABLE","$locale",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_STRING","Mage",161],["T_DOUBLE_COLON","::",161],["T_STRING","app",161],"(",")",["T_OBJECT_OPERATOR","->",161],["T_STRING","getLocale",161],"(",")",";",["T_WHITESPACE","\n            ",161],["T_VARIABLE","$format",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_VARIABLE","$locale",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","getDateTimeFormat",162],"(",["T_STRING","Mage_Core_Model_Locale",162],["T_DOUBLE_COLON","::",162],["T_STRING","FORMAT_TYPE_MEDIUM",162],")",";",["T_WHITESPACE","\n            ",162],["T_VARIABLE","$time",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_VARIABLE","$locale",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","date",163],"(",["T_VARIABLE","$startAt",163],",",["T_WHITESPACE"," ",163],["T_VARIABLE","$format",163],")",["T_OBJECT_OPERATOR","->",163],["T_STRING","getTimestamp",163],"(",")",";",["T_WHITESPACE","\n            ",163],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","setQueueStartAt",164],"(",["T_STRING","Mage",164],["T_DOUBLE_COLON","::",164],["T_STRING","getModel",164],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/date'",164],")",["T_OBJECT_OPERATOR","->",164],["T_STRING","gmtDate",164],"(",["T_STRING","null",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$time",164],")",")",";",["T_WHITESPACE","\n        ",164],"}",["T_WHITESPACE","\n        ",165],["T_RETURN","return",166],["T_WHITESPACE"," ",166],["T_VARIABLE","$this",166],";",["T_WHITESPACE","\n     ",166],"}",["T_WHITESPACE","\n\n    ",167],["T_DOC_COMMENT","\/**\n     * Send messages to subscribers for this queue\n     *\n     * @param   int     $count\n     * @param   array   $additionalVariables\n     * @return Mage_Newsletter_Model_Queue\n     *\/",169],["T_WHITESPACE","\n    ",175],["T_PUBLIC","public",176],["T_WHITESPACE"," ",176],["T_FUNCTION","function",176],["T_WHITESPACE"," ",176],["T_STRING","sendPerSubscriber",176],"(",["T_VARIABLE","$count",176],"=",["T_LNUMBER","20",176],",",["T_WHITESPACE"," ",176],["T_ARRAY","array",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$additionalVariables",176],"=",["T_ARRAY","array",176],"(",")",")",["T_WHITESPACE","\n    ",176],"{",["T_WHITESPACE","\n        ",177],["T_IF","if",178],"(",["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","getQueueStatus",178],"(",")",["T_IS_NOT_EQUAL","!=",178],["T_STRING","self",178],["T_DOUBLE_COLON","::",178],["T_STRING","STATUS_SENDING",178],["T_WHITESPACE","\n           ",178],["T_BOOLEAN_AND","&&",179],["T_WHITESPACE"," ",179],"(",["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","getQueueStatus",179],"(",")",["T_IS_NOT_EQUAL","!=",179],["T_STRING","self",179],["T_DOUBLE_COLON","::",179],["T_STRING","STATUS_NEVER",179],["T_WHITESPACE"," ",179],["T_BOOLEAN_AND","&&",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","getQueueStartAt",179],"(",")",")",["T_WHITESPACE","\n        ",179],")",["T_WHITESPACE"," ",180],"{",["T_WHITESPACE","\n            ",180],["T_RETURN","return",181],["T_WHITESPACE"," ",181],["T_VARIABLE","$this",181],";",["T_WHITESPACE","\n        ",181],"}",["T_WHITESPACE","\n\n        ",182],["T_IF","if",184],["T_WHITESPACE"," ",184],"(",["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getSubscribersCollection",184],"(",")",["T_OBJECT_OPERATOR","->",184],["T_STRING","getSize",184],"(",")",["T_WHITESPACE"," ",184],["T_IS_EQUAL","==",184],["T_WHITESPACE"," ",184],["T_LNUMBER","0",184],")",["T_WHITESPACE"," ",184],"{",["T_WHITESPACE","\n            ",184],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","_finishQueue",185],"(",")",";",["T_WHITESPACE","\n            ",185],["T_RETURN","return",186],["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],";",["T_WHITESPACE","\n        ",186],"}",["T_WHITESPACE","\n\n        ",187],["T_DOC_COMMENT","\/** @var Mage_Newsletter_Model_Resource_Subscriber_Collection $collection *\/",189],["T_WHITESPACE","\n        ",189],["T_VARIABLE","$collection",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","getSubscribersCollection",190],"(",")",["T_WHITESPACE","\n            ",190],["T_OBJECT_OPERATOR","->",191],["T_STRING","useOnlyUnsent",191],"(",")",["T_WHITESPACE","\n            ",191],["T_OBJECT_OPERATOR","->",192],["T_STRING","showCustomerInfo",192],"(",")",["T_WHITESPACE","\n            ",192],["T_OBJECT_OPERATOR","->",193],["T_STRING","setPageSize",193],"(",["T_VARIABLE","$count",193],")",["T_WHITESPACE","\n            ",193],["T_OBJECT_OPERATOR","->",194],["T_STRING","setCurPage",194],"(",["T_LNUMBER","1",194],")",["T_WHITESPACE","\n            ",194],["T_OBJECT_OPERATOR","->",195],["T_STRING","load",195],"(",")",";",["T_WHITESPACE","\n\n        ",195],["T_DOC_COMMENT","\/** @var Mage_Core_Model_Email_Template $sender *\/",197],["T_WHITESPACE","\n        ",197],["T_VARIABLE","$sender",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_STRING","Mage",198],["T_DOUBLE_COLON","::",198],["T_STRING","getModel",198],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/email_template'",198],")",";",["T_WHITESPACE","\n        ",198],["T_VARIABLE","$sender",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","setSenderName",199],"(",["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","getNewsletterSenderName",199],"(",")",")",["T_WHITESPACE","\n            ",199],["T_OBJECT_OPERATOR","->",200],["T_STRING","setSenderEmail",200],"(",["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","getNewsletterSenderEmail",200],"(",")",")",["T_WHITESPACE","\n            ",200],["T_OBJECT_OPERATOR","->",201],["T_STRING","setTemplateType",201],"(",["T_STRING","self",201],["T_DOUBLE_COLON","::",201],["T_STRING","TYPE_HTML",201],")",["T_WHITESPACE","\n            ",201],["T_OBJECT_OPERATOR","->",202],["T_STRING","setTemplateSubject",202],"(",["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","getNewsletterSubject",202],"(",")",")",["T_WHITESPACE","\n            ",202],["T_OBJECT_OPERATOR","->",203],["T_STRING","setTemplateText",203],"(",["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","getNewsletterText",203],"(",")",")",["T_WHITESPACE","\n            ",203],["T_OBJECT_OPERATOR","->",204],["T_STRING","setTemplateStyles",204],"(",["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","getNewsletterStyles",204],"(",")",")",["T_WHITESPACE","\n            ",204],["T_OBJECT_OPERATOR","->",205],["T_STRING","setTemplateFilter",205],"(",["T_STRING","Mage",205],["T_DOUBLE_COLON","::",205],["T_STRING","helper",205],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter'",205],")",["T_OBJECT_OPERATOR","->",205],["T_STRING","getTemplateProcessor",205],"(",")",")",";",["T_WHITESPACE","\n\n        ",205],["T_FOREACH","foreach",207],"(",["T_VARIABLE","$collection",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","getItems",207],"(",")",["T_WHITESPACE"," ",207],["T_AS","as",207],["T_WHITESPACE"," ",207],["T_VARIABLE","$item",207],")",["T_WHITESPACE"," ",207],"{",["T_WHITESPACE","\n            ",207],["T_VARIABLE","$email",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_VARIABLE","$item",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","getSubscriberEmail",208],"(",")",";",["T_WHITESPACE","\n            ",208],["T_VARIABLE","$name",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_VARIABLE","$item",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","getSubscriberFullName",209],"(",")",";",["T_WHITESPACE","\n\n            ",209],["T_VARIABLE","$sender",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","emulateDesign",211],"(",["T_VARIABLE","$item",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","getStoreId",211],"(",")",")",";",["T_WHITESPACE","\n            ",211],["T_VARIABLE","$successSend",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_VARIABLE","$sender",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","send",212],"(",["T_VARIABLE","$email",212],",",["T_WHITESPACE"," ",212],["T_VARIABLE","$name",212],",",["T_WHITESPACE"," ",212],["T_ARRAY","array",212],"(",["T_CONSTANT_ENCAPSED_STRING","'subscriber'",212],["T_WHITESPACE"," ",212],["T_DOUBLE_ARROW","=>",212],["T_WHITESPACE"," ",212],["T_VARIABLE","$item",212],")",")",";",["T_WHITESPACE","\n            ",212],["T_VARIABLE","$sender",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","revertDesign",213],"(",")",";",["T_WHITESPACE","\n\n            ",213],["T_IF","if",215],"(",["T_VARIABLE","$successSend",215],")",["T_WHITESPACE"," ",215],"{",["T_WHITESPACE","\n                ",215],["T_VARIABLE","$item",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","received",216],"(",["T_VARIABLE","$this",216],")",";",["T_WHITESPACE","\n            ",216],"}",["T_WHITESPACE"," ",217],["T_ELSE","else",217],["T_WHITESPACE"," ",217],"{",["T_WHITESPACE","\n                ",217],["T_VARIABLE","$problem",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_STRING","Mage",218],["T_DOUBLE_COLON","::",218],["T_STRING","getModel",218],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter\/problem'",218],")",";",["T_WHITESPACE","\n                ",218],["T_VARIABLE","$notification",219],["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],["T_STRING","Mage",219],["T_DOUBLE_COLON","::",219],["T_STRING","helper",219],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter'",219],")",["T_OBJECT_OPERATOR","->",219],["T_STRING","__",219],"(",["T_CONSTANT_ENCAPSED_STRING","'Please refer to exeption.log'",219],")",";",["T_WHITESPACE","\n                ",219],["T_VARIABLE","$problem",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","addSubscriberData",220],"(",["T_VARIABLE","$item",220],")",["T_WHITESPACE","\n                    ",220],["T_OBJECT_OPERATOR","->",221],["T_STRING","addQueueData",221],"(",["T_VARIABLE","$this",221],")",["T_WHITESPACE","\n                    ",221],["T_OBJECT_OPERATOR","->",222],["T_STRING","addErrorData",222],"(",["T_NEW","new",222],["T_WHITESPACE"," ",222],["T_STRING","Exception",222],"(",["T_VARIABLE","$notification",222],")",")",["T_WHITESPACE","\n                    ",222],["T_OBJECT_OPERATOR","->",223],["T_STRING","save",223],"(",")",";",["T_WHITESPACE","\n                ",223],["T_VARIABLE","$item",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","received",224],"(",["T_VARIABLE","$this",224],")",";",["T_WHITESPACE","\n            ",224],"}",["T_WHITESPACE","\n        ",225],"}",["T_WHITESPACE","\n\n        ",226],["T_IF","if",228],"(",["T_STRING","count",228],"(",["T_VARIABLE","$collection",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getItems",228],"(",")",")",["T_WHITESPACE"," ",228],"<",["T_WHITESPACE"," ",228],["T_VARIABLE","$count",228],"-",["T_LNUMBER","1",228],["T_WHITESPACE"," ",228],["T_BOOLEAN_OR","||",228],["T_WHITESPACE"," ",228],["T_STRING","count",228],"(",["T_VARIABLE","$collection",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getItems",228],"(",")",")",["T_WHITESPACE"," ",228],["T_IS_EQUAL","==",228],["T_WHITESPACE"," ",228],["T_LNUMBER","0",228],")",["T_WHITESPACE"," ",228],"{",["T_WHITESPACE","\n            ",228],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","_finishQueue",229],"(",")",";",["T_WHITESPACE","\n        ",229],"}",["T_WHITESPACE","\n        ",230],["T_RETURN","return",231],["T_WHITESPACE"," ",231],["T_VARIABLE","$this",231],";",["T_WHITESPACE","\n    ",231],"}",["T_WHITESPACE","\n\n    ",232],["T_DOC_COMMENT","\/**\n     * Finish queue: set status SENT and update finish date\n     *\n     * @return Mage_Newsletter_Model_Queue\n     *\/",234],["T_WHITESPACE","\n    ",238],["T_PROTECTED","protected",239],["T_WHITESPACE"," ",239],["T_FUNCTION","function",239],["T_WHITESPACE"," ",239],["T_STRING","_finishQueue",239],"(",")",["T_WHITESPACE","\n    ",239],"{",["T_WHITESPACE","\n        ",240],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","setQueueFinishAt",241],"(",["T_STRING","Mage",241],["T_DOUBLE_COLON","::",241],["T_STRING","getSingleton",241],"(",["T_CONSTANT_ENCAPSED_STRING","'core\/date'",241],")",["T_OBJECT_OPERATOR","->",241],["T_STRING","gmtDate",241],"(",")",")",";",["T_WHITESPACE","\n        ",241],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","setQueueStatus",242],"(",["T_STRING","self",242],["T_DOUBLE_COLON","::",242],["T_STRING","STATUS_SENT",242],")",";",["T_WHITESPACE","\n        ",242],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","save",243],"(",")",";",["T_WHITESPACE","\n\n        ",243],["T_RETURN","return",245],["T_WHITESPACE"," ",245],["T_VARIABLE","$this",245],";",["T_WHITESPACE","\n    ",245],"}",["T_WHITESPACE","\n\n    ",246],["T_DOC_COMMENT","\/**\n     * Getter data for saving\n     *\n     * @return array\n     *\/",248],["T_WHITESPACE","\n    ",252],["T_PUBLIC","public",253],["T_WHITESPACE"," ",253],["T_FUNCTION","function",253],["T_WHITESPACE"," ",253],["T_STRING","getDataForSave",253],"(",")",["T_WHITESPACE","\n    ",253],"{",["T_WHITESPACE","\n        ",254],["T_VARIABLE","$data",255],["T_WHITESPACE"," ",255],"=",["T_WHITESPACE"," ",255],["T_ARRAY","array",255],"(",")",";",["T_WHITESPACE","\n        ",255],["T_VARIABLE","$data",256],"[",["T_CONSTANT_ENCAPSED_STRING","'template_id'",256],"]",["T_WHITESPACE"," ",256],"=",["T_WHITESPACE"," ",256],["T_VARIABLE","$this",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","getTemplateId",256],"(",")",";",["T_WHITESPACE","\n        ",256],["T_VARIABLE","$data",257],"[",["T_CONSTANT_ENCAPSED_STRING","'queue_status'",257],"]",["T_WHITESPACE"," ",257],"=",["T_WHITESPACE"," ",257],["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","getQueueStatus",257],"(",")",";",["T_WHITESPACE","\n        ",257],["T_VARIABLE","$data",258],"[",["T_CONSTANT_ENCAPSED_STRING","'queue_start_at'",258],"]",["T_WHITESPACE"," ",258],"=",["T_WHITESPACE"," ",258],["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","getQueueStartAt",258],"(",")",";",["T_WHITESPACE","\n        ",258],["T_VARIABLE","$data",259],"[",["T_CONSTANT_ENCAPSED_STRING","'queue_finish_at'",259],"]",["T_WHITESPACE"," ",259],"=",["T_WHITESPACE"," ",259],["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","getQueueFinishAt",259],"(",")",";",["T_WHITESPACE","\n        ",259],["T_RETURN","return",260],["T_WHITESPACE"," ",260],["T_VARIABLE","$data",260],";",["T_WHITESPACE","\n    ",260],"}",["T_WHITESPACE","\n\n    ",261],["T_DOC_COMMENT","\/**\n     * Add subscribers to queue.\n     *\n     * @param array $subscriberIds\n     * @return Mage_Newsletter_Model_Queue\n     *\/",263],["T_WHITESPACE","\n    ",268],["T_PUBLIC","public",269],["T_WHITESPACE"," ",269],["T_FUNCTION","function",269],["T_WHITESPACE"," ",269],["T_STRING","addSubscribersToQueue",269],"(",["T_ARRAY","array",269],["T_WHITESPACE"," ",269],["T_VARIABLE","$subscriberIds",269],")",["T_WHITESPACE","\n    ",269],"{",["T_WHITESPACE","\n        ",270],["T_VARIABLE","$this",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","_getResource",271],"(",")",["T_OBJECT_OPERATOR","->",271],["T_STRING","addSubscribersToQueue",271],"(",["T_VARIABLE","$this",271],",",["T_WHITESPACE"," ",271],["T_VARIABLE","$subscriberIds",271],")",";",["T_WHITESPACE","\n        ",271],["T_RETURN","return",272],["T_WHITESPACE"," ",272],["T_VARIABLE","$this",272],";",["T_WHITESPACE","\n    ",272],"}",["T_WHITESPACE","\n\n    ",273],["T_DOC_COMMENT","\/**\n     * Setter for save template flag.\n     *\n     * @param boolean|integer|string $value\n     * @return Mage_Newsletter_Model_Queue\n     * @deprecated since 1.4.0.1\n     *\/",275],["T_WHITESPACE","\n    ",281],["T_PUBLIC","public",282],["T_WHITESPACE"," ",282],["T_FUNCTION","function",282],["T_WHITESPACE"," ",282],["T_STRING","setSaveTemplateFlag",282],"(",["T_VARIABLE","$value",282],")",["T_WHITESPACE","\n    ",282],"{",["T_WHITESPACE","\n        ",283],["T_VARIABLE","$this",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","_saveTemplateFlag",284],["T_WHITESPACE"," ",284],"=",["T_WHITESPACE"," ",284],["T_BOOL_CAST","(boolean)",284],["T_VARIABLE","$value",284],";",["T_WHITESPACE","\n        ",284],["T_RETURN","return",285],["T_WHITESPACE"," ",285],["T_VARIABLE","$this",285],";",["T_WHITESPACE","\n    ",285],"}",["T_WHITESPACE","\n\n    ",286],["T_DOC_COMMENT","\/**\n     * Getter for save template flag.\n     *\n     * @param void\n     * @return boolean\n     * @deprecated since 1.4.0.1\n     *\/",288],["T_WHITESPACE","\n    ",294],["T_PUBLIC","public",295],["T_WHITESPACE"," ",295],["T_FUNCTION","function",295],["T_WHITESPACE"," ",295],["T_STRING","getSaveTemplateFlag",295],"(",")",["T_WHITESPACE","\n    ",295],"{",["T_WHITESPACE","\n        ",296],["T_RETURN","return",297],["T_WHITESPACE"," ",297],["T_VARIABLE","$this",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","_saveTemplateFlag",297],";",["T_WHITESPACE","\n    ",297],"}",["T_WHITESPACE","\n\n    ",298],["T_DOC_COMMENT","\/**\n     * Setter for save stores flag.\n     *\n     * @param boolean|integer|string $value\n     * @return Mage_Newsletter_Model_Queue\n     *\/",300],["T_WHITESPACE","\n    ",305],["T_PUBLIC","public",306],["T_WHITESPACE"," ",306],["T_FUNCTION","function",306],["T_WHITESPACE"," ",306],["T_STRING","setSaveStoresFlag",306],"(",["T_VARIABLE","$value",306],")",["T_WHITESPACE","\n    ",306],"{",["T_WHITESPACE","\n        ",307],["T_VARIABLE","$this",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","_saveStoresFlag",308],["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],["T_BOOL_CAST","(boolean)",308],["T_VARIABLE","$value",308],";",["T_WHITESPACE","\n        ",308],["T_RETURN","return",309],["T_WHITESPACE"," ",309],["T_VARIABLE","$this",309],";",["T_WHITESPACE","\n    ",309],"}",["T_WHITESPACE","\n\n    ",310],["T_DOC_COMMENT","\/**\n     * Getter for save stores flag.\n     *\n     * @param void\n     * @return boolean\n     *\/",312],["T_WHITESPACE","\n    ",317],["T_PUBLIC","public",318],["T_WHITESPACE"," ",318],["T_FUNCTION","function",318],["T_WHITESPACE"," ",318],["T_STRING","getSaveStoresFlag",318],"(",")",["T_WHITESPACE","\n    ",318],"{",["T_WHITESPACE","\n        ",319],["T_RETURN","return",320],["T_WHITESPACE"," ",320],["T_VARIABLE","$this",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","_saveStoresFlag",320],";",["T_WHITESPACE","\n    ",320],"}",["T_WHITESPACE","\n\n    ",321],["T_DOC_COMMENT","\/**\n     * Setter for stores of queue.\n     *\n     * @param array\n     * @return Mage_Newsletter_Model_Queue\n     *\/",323],["T_WHITESPACE","\n    ",328],["T_PUBLIC","public",329],["T_WHITESPACE"," ",329],["T_FUNCTION","function",329],["T_WHITESPACE"," ",329],["T_STRING","setStores",329],"(",["T_ARRAY","array",329],["T_WHITESPACE"," ",329],["T_VARIABLE","$storesIds",329],")",["T_WHITESPACE","\n    ",329],"{",["T_WHITESPACE","\n        ",330],["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","setSaveStoresFlag",331],"(",["T_STRING","true",331],")",";",["T_WHITESPACE","\n        ",331],["T_VARIABLE","$this",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","_stores",332],["T_WHITESPACE"," ",332],"=",["T_WHITESPACE"," ",332],["T_VARIABLE","$storesIds",332],";",["T_WHITESPACE","\n        ",332],["T_RETURN","return",333],["T_WHITESPACE"," ",333],["T_VARIABLE","$this",333],";",["T_WHITESPACE","\n    ",333],"}",["T_WHITESPACE","\n\n    ",334],["T_DOC_COMMENT","\/**\n     * Getter for stores of queue.\n     *\n     * @return array\n     *\/",336],["T_WHITESPACE","\n    ",340],["T_PUBLIC","public",341],["T_WHITESPACE"," ",341],["T_FUNCTION","function",341],["T_WHITESPACE"," ",341],["T_STRING","getStores",341],"(",")",["T_WHITESPACE","\n    ",341],"{",["T_WHITESPACE","\n        ",342],["T_IF","if",343],"(","!",["T_VARIABLE","$this",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","_stores",343],")",["T_WHITESPACE"," ",343],"{",["T_WHITESPACE","\n            ",343],["T_VARIABLE","$this",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","_stores",344],["T_WHITESPACE"," ",344],"=",["T_WHITESPACE"," ",344],["T_VARIABLE","$this",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","_getResource",344],"(",")",["T_OBJECT_OPERATOR","->",344],["T_STRING","getStores",344],"(",["T_VARIABLE","$this",344],")",";",["T_WHITESPACE","\n        ",344],"}",["T_WHITESPACE","\n\n        ",345],["T_RETURN","return",347],["T_WHITESPACE"," ",347],["T_VARIABLE","$this",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","_stores",347],";",["T_WHITESPACE","\n    ",347],"}",["T_WHITESPACE","\n\n    ",348],["T_DOC_COMMENT","\/**\n     * Retrieve Newsletter Template object\n     *\n     * @return Mage_Newsletter_Model_Template\n     *\/",350],["T_WHITESPACE","\n    ",354],["T_PUBLIC","public",355],["T_WHITESPACE"," ",355],["T_FUNCTION","function",355],["T_WHITESPACE"," ",355],["T_STRING","getTemplate",355],"(",")",["T_WHITESPACE","\n    ",355],"{",["T_WHITESPACE","\n        ",356],["T_IF","if",357],["T_WHITESPACE"," ",357],"(",["T_STRING","is_null",357],"(",["T_VARIABLE","$this",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","_template",357],")",")",["T_WHITESPACE"," ",357],"{",["T_WHITESPACE","\n            ",357],["T_VARIABLE","$this",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","_template",358],["T_WHITESPACE"," ",358],"=",["T_WHITESPACE"," ",358],["T_STRING","Mage",358],["T_DOUBLE_COLON","::",358],["T_STRING","getModel",358],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter\/template'",358],")",["T_WHITESPACE","\n                ",358],["T_OBJECT_OPERATOR","->",359],["T_STRING","load",359],"(",["T_VARIABLE","$this",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","getTemplateId",359],"(",")",")",";",["T_WHITESPACE","\n        ",359],"}",["T_WHITESPACE","\n        ",360],["T_RETURN","return",361],["T_WHITESPACE"," ",361],["T_VARIABLE","$this",361],["T_OBJECT_OPERATOR","->",361],["T_STRING","_template",361],";",["T_WHITESPACE","\n    ",361],"}",["T_WHITESPACE","\n\n    ",362],["T_DOC_COMMENT","\/**\n     * Getter for template type\n     *\n     * @return int|string\n     *\/",364],["T_WHITESPACE","\n    ",368],["T_PUBLIC","public",369],["T_WHITESPACE"," ",369],["T_FUNCTION","function",369],["T_WHITESPACE"," ",369],["T_STRING","getType",369],"(",")","{",["T_WHITESPACE","\n        ",369],["T_RETURN","return",370],["T_WHITESPACE"," ",370],["T_VARIABLE","$this",370],["T_OBJECT_OPERATOR","->",370],["T_STRING","getNewsletterType",370],"(",")",";",["T_WHITESPACE","\n    ",370],"}",["T_WHITESPACE","\n\n",371],"}",["T_WHITESPACE","\n",373]]