[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Security",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Core",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Authentication",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Provider",12],";",["T_WHITESPACE","\n\n",12],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Symfony",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Component",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Security",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Core",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Authentication",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Token",14],["T_NS_SEPARATOR","\\",14],["T_STRING","UsernamePasswordToken",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Symfony",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Component",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Security",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Core",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Exception",15],["T_NS_SEPARATOR","\\",15],["T_STRING","BadCredentialsException",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Symfony",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Component",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Security",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Core",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Exception",16],["T_NS_SEPARATOR","\\",16],["T_STRING","UsernameNotFoundException",16],";",["T_WHITESPACE","\n",16],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Symfony",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Component",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Security",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Core",17],["T_NS_SEPARATOR","\\",17],["T_STRING","User",17],["T_NS_SEPARATOR","\\",17],["T_STRING","UserCheckerInterface",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Symfony",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Component",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Security",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Core",18],["T_NS_SEPARATOR","\\",18],["T_STRING","User",18],["T_NS_SEPARATOR","\\",18],["T_STRING","UserInterface",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Symfony",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Component",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Security",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Core",19],["T_NS_SEPARATOR","\\",19],["T_STRING","User",19],["T_NS_SEPARATOR","\\",19],["T_STRING","UserProviderInterface",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Symfony",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Component",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Ldap",20],["T_NS_SEPARATOR","\\",20],["T_STRING","LdapInterface",20],";",["T_WHITESPACE","\n",20],["T_USE","use",21],["T_WHITESPACE"," ",21],["T_STRING","Symfony",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Component",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Ldap",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Exception",21],["T_NS_SEPARATOR","\\",21],["T_STRING","ConnectionException",21],";",["T_WHITESPACE","\n\n",21],["T_DOC_COMMENT","\/**\n * LdapBindAuthenticationProvider authenticates a user against an LDAP server.\n *\n * The only way to check user credentials is to try to connect the user with its\n * credentials to the ldap.\n *\n * @author Charles Sarrazin <charles@sarraz.in>\n *\/",23],["T_WHITESPACE","\n",30],["T_CLASS","class",31],["T_WHITESPACE"," ",31],["T_STRING","LdapBindAuthenticationProvider",31],["T_WHITESPACE"," ",31],["T_EXTENDS","extends",31],["T_WHITESPACE"," ",31],["T_STRING","UserAuthenticationProvider",31],["T_WHITESPACE","\n",31],"{",["T_WHITESPACE","\n    ",32],["T_PRIVATE","private",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$userProvider",33],";",["T_WHITESPACE","\n    ",33],["T_PRIVATE","private",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$ldap",34],";",["T_WHITESPACE","\n    ",34],["T_PRIVATE","private",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$dnString",35],";",["T_WHITESPACE","\n    ",35],["T_PRIVATE","private",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$queryString",36],";",["T_WHITESPACE","\n\n    ",36],["T_DOC_COMMENT","\/**\n     * Constructor.\n     *\n     * @param UserProviderInterface $userProvider               A UserProvider\n     * @param UserCheckerInterface  $userChecker                A UserChecker\n     * @param string                $providerKey                The provider key\n     * @param LdapInterface         $ldap                       A Ldap client\n     * @param string                $dnString                   A string used to create the bind DN\n     * @param bool                  $hideUserNotFoundExceptions Whether to hide user not found exception or not\n     *\/",38],["T_WHITESPACE","\n    ",47],["T_PUBLIC","public",48],["T_WHITESPACE"," ",48],["T_FUNCTION","function",48],["T_WHITESPACE"," ",48],["T_STRING","__construct",48],"(",["T_STRING","UserProviderInterface",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$userProvider",48],",",["T_WHITESPACE"," ",48],["T_STRING","UserCheckerInterface",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$userChecker",48],",",["T_WHITESPACE"," ",48],["T_VARIABLE","$providerKey",48],",",["T_WHITESPACE"," ",48],["T_STRING","LdapInterface",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$ldap",48],",",["T_WHITESPACE"," ",48],["T_VARIABLE","$dnString",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'{username}'",48],",",["T_WHITESPACE"," ",48],["T_VARIABLE","$hideUserNotFoundExceptions",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_STRING","true",48],")",["T_WHITESPACE","\n    ",48],"{",["T_WHITESPACE","\n        ",49],["T_STRING","parent",50],["T_DOUBLE_COLON","::",50],["T_STRING","__construct",50],"(",["T_VARIABLE","$userChecker",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$providerKey",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$hideUserNotFoundExceptions",50],")",";",["T_WHITESPACE","\n\n        ",50],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","userProvider",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$userProvider",52],";",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","ldap",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$ldap",53],";",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","dnString",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$dnString",54],";",["T_WHITESPACE","\n    ",54],"}",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * Set a query string to use in order to find a DN for the username.\n     *\n     * @param string $queryString\n     *\/",57],["T_WHITESPACE","\n    ",61],["T_PUBLIC","public",62],["T_WHITESPACE"," ",62],["T_FUNCTION","function",62],["T_WHITESPACE"," ",62],["T_STRING","setQueryString",62],"(",["T_VARIABLE","$queryString",62],")",["T_WHITESPACE","\n    ",62],"{",["T_WHITESPACE","\n        ",63],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","queryString",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$queryString",64],";",["T_WHITESPACE","\n    ",64],"}",["T_WHITESPACE","\n\n    ",65],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",67],["T_WHITESPACE","\n    ",69],["T_PROTECTED","protected",70],["T_WHITESPACE"," ",70],["T_FUNCTION","function",70],["T_WHITESPACE"," ",70],["T_STRING","retrieveUser",70],"(",["T_VARIABLE","$username",70],",",["T_WHITESPACE"," ",70],["T_STRING","UsernamePasswordToken",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$token",70],")",["T_WHITESPACE","\n    ",70],"{",["T_WHITESPACE","\n        ",71],["T_IF","if",72],["T_WHITESPACE"," ",72],"(",["T_STRING","AuthenticationProviderInterface",72],["T_DOUBLE_COLON","::",72],["T_STRING","USERNAME_NONE_PROVIDED",72],["T_WHITESPACE"," ",72],["T_IS_IDENTICAL","===",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$username",72],")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n            ",72],["T_THROW","throw",73],["T_WHITESPACE"," ",73],["T_NEW","new",73],["T_WHITESPACE"," ",73],["T_STRING","UsernameNotFoundException",73],"(",["T_CONSTANT_ENCAPSED_STRING","'Username can not be null'",73],")",";",["T_WHITESPACE","\n        ",73],"}",["T_WHITESPACE","\n\n        ",74],["T_RETURN","return",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","userProvider",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","loadUserByUsername",76],"(",["T_VARIABLE","$username",76],")",";",["T_WHITESPACE","\n    ",76],"}",["T_WHITESPACE","\n\n    ",77],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",79],["T_WHITESPACE","\n    ",81],["T_PROTECTED","protected",82],["T_WHITESPACE"," ",82],["T_FUNCTION","function",82],["T_WHITESPACE"," ",82],["T_STRING","checkAuthentication",82],"(",["T_STRING","UserInterface",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$user",82],",",["T_WHITESPACE"," ",82],["T_STRING","UsernamePasswordToken",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$token",82],")",["T_WHITESPACE","\n    ",82],"{",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$username",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$token",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getUsername",84],"(",")",";",["T_WHITESPACE","\n        ",84],["T_VARIABLE","$password",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_VARIABLE","$token",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","getCredentials",85],"(",")",";",["T_WHITESPACE","\n\n        ",85],["T_IF","if",87],["T_WHITESPACE"," ",87],"(",["T_CONSTANT_ENCAPSED_STRING","''",87],["T_WHITESPACE"," ",87],["T_IS_IDENTICAL","===",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$password",87],")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n            ",87],["T_THROW","throw",88],["T_WHITESPACE"," ",88],["T_NEW","new",88],["T_WHITESPACE"," ",88],["T_STRING","BadCredentialsException",88],"(",["T_CONSTANT_ENCAPSED_STRING","'The presented password must not be empty.'",88],")",";",["T_WHITESPACE","\n        ",88],"}",["T_WHITESPACE","\n\n        ",89],["T_TRY","try",91],["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n            ",91],["T_VARIABLE","$username",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","ldap",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","escape",92],"(",["T_VARIABLE","$username",92],",",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","''",92],",",["T_WHITESPACE"," ",92],["T_STRING","LdapInterface",92],["T_DOUBLE_COLON","::",92],["T_STRING","ESCAPE_DN",92],")",";",["T_WHITESPACE","\n\n            ",92],["T_IF","if",94],["T_WHITESPACE"," ",94],"(",["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","queryString",94],")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n                ",94],["T_VARIABLE","$query",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_STRING","str_replace",95],"(",["T_CONSTANT_ENCAPSED_STRING","'{username}'",95],",",["T_WHITESPACE"," ",95],["T_VARIABLE","$username",95],",",["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","queryString",95],")",";",["T_WHITESPACE","\n                ",95],["T_VARIABLE","$result",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","ldap",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","query",96],"(",["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","dnString",96],",",["T_WHITESPACE"," ",96],["T_VARIABLE","$query",96],")",["T_OBJECT_OPERATOR","->",96],["T_STRING","execute",96],"(",")",";",["T_WHITESPACE","\n                ",96],["T_IF","if",97],["T_WHITESPACE"," ",97],"(",["T_LNUMBER","1",97],["T_WHITESPACE"," ",97],["T_IS_NOT_IDENTICAL","!==",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$result",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","count",97],"(",")",")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n                    ",97],["T_THROW","throw",98],["T_WHITESPACE"," ",98],["T_NEW","new",98],["T_WHITESPACE"," ",98],["T_STRING","BadCredentialsException",98],"(",["T_CONSTANT_ENCAPSED_STRING","'The presented username is invalid.'",98],")",";",["T_WHITESPACE","\n                ",98],"}",["T_WHITESPACE","\n\n                ",99],["T_VARIABLE","$dn",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$result",101],"[",["T_LNUMBER","0",101],"]",["T_OBJECT_OPERATOR","->",101],["T_STRING","getDn",101],"(",")",";",["T_WHITESPACE","\n            ",101],"}",["T_WHITESPACE"," ",102],["T_ELSE","else",102],["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n                ",102],["T_VARIABLE","$dn",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_STRING","str_replace",103],"(",["T_CONSTANT_ENCAPSED_STRING","'{username}'",103],",",["T_WHITESPACE"," ",103],["T_VARIABLE","$username",103],",",["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","dnString",103],")",";",["T_WHITESPACE","\n            ",103],"}",["T_WHITESPACE","\n\n            ",104],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","ldap",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","bind",106],"(",["T_VARIABLE","$dn",106],",",["T_WHITESPACE"," ",106],["T_VARIABLE","$password",106],")",";",["T_WHITESPACE","\n        ",106],"}",["T_WHITESPACE"," ",107],["T_CATCH","catch",107],["T_WHITESPACE"," ",107],"(",["T_STRING","ConnectionException",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$e",107],")",["T_WHITESPACE"," ",107],"{",["T_WHITESPACE","\n            ",107],["T_THROW","throw",108],["T_WHITESPACE"," ",108],["T_NEW","new",108],["T_WHITESPACE"," ",108],["T_STRING","BadCredentialsException",108],"(",["T_CONSTANT_ENCAPSED_STRING","'The presented password is invalid.'",108],")",";",["T_WHITESPACE","\n        ",108],"}",["T_WHITESPACE","\n    ",109],"}",["T_WHITESPACE","\n",110],"}",["T_WHITESPACE","\n",111]]