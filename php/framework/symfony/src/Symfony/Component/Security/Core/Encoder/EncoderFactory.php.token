[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Security",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Core",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Encoder",12],";",["T_WHITESPACE","\n\n",12],["T_DOC_COMMENT","\/**\n * A generic encoder factory implementation.\n *\n * @author Johannes M. Schmitt <schmittjoh@gmail.com>\n *\/",14],["T_WHITESPACE","\n",18],["T_CLASS","class",19],["T_WHITESPACE"," ",19],["T_STRING","EncoderFactory",19],["T_WHITESPACE"," ",19],["T_IMPLEMENTS","implements",19],["T_WHITESPACE"," ",19],["T_STRING","EncoderFactoryInterface",19],["T_WHITESPACE","\n",19],"{",["T_WHITESPACE","\n    ",20],["T_PRIVATE","private",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$encoders",21],";",["T_WHITESPACE","\n\n    ",21],["T_PUBLIC","public",23],["T_WHITESPACE"," ",23],["T_FUNCTION","function",23],["T_WHITESPACE"," ",23],["T_STRING","__construct",23],"(",["T_ARRAY","array",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$encoders",23],")",["T_WHITESPACE","\n    ",23],"{",["T_WHITESPACE","\n        ",24],["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","encoders",25],["T_WHITESPACE"," ",25],"=",["T_WHITESPACE"," ",25],["T_VARIABLE","$encoders",25],";",["T_WHITESPACE","\n    ",25],"}",["T_WHITESPACE","\n\n    ",26],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",28],["T_WHITESPACE","\n    ",30],["T_PUBLIC","public",31],["T_WHITESPACE"," ",31],["T_FUNCTION","function",31],["T_WHITESPACE"," ",31],["T_STRING","getEncoder",31],"(",["T_VARIABLE","$user",31],")",["T_WHITESPACE","\n    ",31],"{",["T_WHITESPACE","\n        ",32],["T_VARIABLE","$encoderKey",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_STRING","null",33],";",["T_WHITESPACE","\n\n        ",33],["T_IF","if",35],["T_WHITESPACE"," ",35],"(",["T_VARIABLE","$user",35],["T_WHITESPACE"," ",35],["T_INSTANCEOF","instanceof",35],["T_WHITESPACE"," ",35],["T_STRING","EncoderAwareInterface",35],["T_WHITESPACE"," ",35],["T_BOOLEAN_AND","&&",35],["T_WHITESPACE"," ",35],"(",["T_STRING","null",35],["T_WHITESPACE"," ",35],["T_IS_NOT_IDENTICAL","!==",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$encoderName",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_VARIABLE","$user",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","getEncoderName",35],"(",")",")",")",["T_WHITESPACE"," ",35],"{",["T_WHITESPACE","\n            ",35],["T_IF","if",36],["T_WHITESPACE"," ",36],"(","!",["T_STRING","array_key_exists",36],"(",["T_VARIABLE","$encoderName",36],",",["T_WHITESPACE"," ",36],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","encoders",36],")",")",["T_WHITESPACE"," ",36],"{",["T_WHITESPACE","\n                ",36],["T_THROW","throw",37],["T_WHITESPACE"," ",37],["T_NEW","new",37],["T_WHITESPACE"," ",37],["T_NS_SEPARATOR","\\",37],["T_STRING","RuntimeException",37],"(",["T_STRING","sprintf",37],"(",["T_CONSTANT_ENCAPSED_STRING","'The encoder \"%s\" was not configured.'",37],",",["T_WHITESPACE"," ",37],["T_VARIABLE","$encoderName",37],")",")",";",["T_WHITESPACE","\n            ",37],"}",["T_WHITESPACE","\n\n            ",38],["T_VARIABLE","$encoderKey",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$encoderName",40],";",["T_WHITESPACE","\n        ",40],"}",["T_WHITESPACE"," ",41],["T_ELSE","else",41],["T_WHITESPACE"," ",41],"{",["T_WHITESPACE","\n            ",41],["T_FOREACH","foreach",42],["T_WHITESPACE"," ",42],"(",["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","encoders",42],["T_WHITESPACE"," ",42],["T_AS","as",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$class",42],["T_WHITESPACE"," ",42],["T_DOUBLE_ARROW","=>",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$encoder",42],")",["T_WHITESPACE"," ",42],"{",["T_WHITESPACE","\n                ",42],["T_IF","if",43],["T_WHITESPACE"," ",43],"(","(",["T_STRING","is_object",43],"(",["T_VARIABLE","$user",43],")",["T_WHITESPACE"," ",43],["T_BOOLEAN_AND","&&",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$user",43],["T_WHITESPACE"," ",43],["T_INSTANCEOF","instanceof",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$class",43],")",["T_WHITESPACE"," ",43],["T_BOOLEAN_OR","||",43],["T_WHITESPACE"," ",43],"(","!",["T_STRING","is_object",43],"(",["T_VARIABLE","$user",43],")",["T_WHITESPACE"," ",43],["T_BOOLEAN_AND","&&",43],["T_WHITESPACE"," ",43],"(",["T_STRING","is_subclass_of",43],"(",["T_VARIABLE","$user",43],",",["T_WHITESPACE"," ",43],["T_VARIABLE","$class",43],")",["T_WHITESPACE"," ",43],["T_BOOLEAN_OR","||",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$user",43],["T_WHITESPACE"," ",43],["T_IS_EQUAL","==",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$class",43],")",")",")",["T_WHITESPACE"," ",43],"{",["T_WHITESPACE","\n                    ",43],["T_VARIABLE","$encoderKey",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_VARIABLE","$class",44],";",["T_WHITESPACE","\n                    ",44],["T_BREAK","break",45],";",["T_WHITESPACE","\n                ",45],"}",["T_WHITESPACE","\n            ",46],"}",["T_WHITESPACE","\n        ",47],"}",["T_WHITESPACE","\n\n        ",48],["T_IF","if",50],["T_WHITESPACE"," ",50],"(",["T_STRING","null",50],["T_WHITESPACE"," ",50],["T_IS_IDENTICAL","===",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$encoderKey",50],")",["T_WHITESPACE"," ",50],"{",["T_WHITESPACE","\n            ",50],["T_THROW","throw",51],["T_WHITESPACE"," ",51],["T_NEW","new",51],["T_WHITESPACE"," ",51],["T_NS_SEPARATOR","\\",51],["T_STRING","RuntimeException",51],"(",["T_STRING","sprintf",51],"(",["T_CONSTANT_ENCAPSED_STRING","'No encoder has been configured for account \"%s\".'",51],",",["T_WHITESPACE"," ",51],["T_STRING","is_object",51],"(",["T_VARIABLE","$user",51],")",["T_WHITESPACE"," ",51],"?",["T_WHITESPACE"," ",51],["T_STRING","get_class",51],"(",["T_VARIABLE","$user",51],")",["T_WHITESPACE"," ",51],":",["T_WHITESPACE"," ",51],["T_VARIABLE","$user",51],")",")",";",["T_WHITESPACE","\n        ",51],"}",["T_WHITESPACE","\n\n        ",52],["T_IF","if",54],["T_WHITESPACE"," ",54],"(","!",["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","encoders",54],"[",["T_VARIABLE","$encoderKey",54],"]",["T_WHITESPACE"," ",54],["T_INSTANCEOF","instanceof",54],["T_WHITESPACE"," ",54],["T_STRING","PasswordEncoderInterface",54],")",["T_WHITESPACE"," ",54],"{",["T_WHITESPACE","\n            ",54],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","encoders",55],"[",["T_VARIABLE","$encoderKey",55],"]",["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","createEncoder",55],"(",["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","encoders",55],"[",["T_VARIABLE","$encoderKey",55],"]",")",";",["T_WHITESPACE","\n        ",55],"}",["T_WHITESPACE","\n\n        ",56],["T_RETURN","return",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","encoders",58],"[",["T_VARIABLE","$encoderKey",58],"]",";",["T_WHITESPACE","\n    ",58],"}",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * Creates the actual encoder instance.\n     *\n     * @param array $config\n     *\n     * @return PasswordEncoderInterface\n     *\n     * @throws \\InvalidArgumentException\n     *\/",61],["T_WHITESPACE","\n    ",69],["T_PRIVATE","private",70],["T_WHITESPACE"," ",70],["T_FUNCTION","function",70],["T_WHITESPACE"," ",70],["T_STRING","createEncoder",70],"(",["T_ARRAY","array",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$config",70],")",["T_WHITESPACE","\n    ",70],"{",["T_WHITESPACE","\n        ",71],["T_IF","if",72],["T_WHITESPACE"," ",72],"(",["T_ISSET","isset",72],"(",["T_VARIABLE","$config",72],"[",["T_CONSTANT_ENCAPSED_STRING","'algorithm'",72],"]",")",")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n            ",72],["T_VARIABLE","$config",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","getEncoderConfigFromAlgorithm",73],"(",["T_VARIABLE","$config",73],")",";",["T_WHITESPACE","\n        ",73],"}",["T_WHITESPACE","\n        ",74],["T_IF","if",75],["T_WHITESPACE"," ",75],"(","!",["T_ISSET","isset",75],"(",["T_VARIABLE","$config",75],"[",["T_CONSTANT_ENCAPSED_STRING","'class'",75],"]",")",")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n            ",75],["T_THROW","throw",76],["T_WHITESPACE"," ",76],["T_NEW","new",76],["T_WHITESPACE"," ",76],["T_NS_SEPARATOR","\\",76],["T_STRING","InvalidArgumentException",76],"(",["T_STRING","sprintf",76],"(",["T_CONSTANT_ENCAPSED_STRING","'\"class\" must be set in %s.'",76],",",["T_WHITESPACE"," ",76],["T_STRING","json_encode",76],"(",["T_VARIABLE","$config",76],")",")",")",";",["T_WHITESPACE","\n        ",76],"}",["T_WHITESPACE","\n        ",77],["T_IF","if",78],["T_WHITESPACE"," ",78],"(","!",["T_ISSET","isset",78],"(",["T_VARIABLE","$config",78],"[",["T_CONSTANT_ENCAPSED_STRING","'arguments'",78],"]",")",")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n            ",78],["T_THROW","throw",79],["T_WHITESPACE"," ",79],["T_NEW","new",79],["T_WHITESPACE"," ",79],["T_NS_SEPARATOR","\\",79],["T_STRING","InvalidArgumentException",79],"(",["T_STRING","sprintf",79],"(",["T_CONSTANT_ENCAPSED_STRING","'\"arguments\" must be set in %s.'",79],",",["T_WHITESPACE"," ",79],["T_STRING","json_encode",79],"(",["T_VARIABLE","$config",79],")",")",")",";",["T_WHITESPACE","\n        ",79],"}",["T_WHITESPACE","\n\n        ",80],["T_VARIABLE","$reflection",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_NEW","new",82],["T_WHITESPACE"," ",82],["T_NS_SEPARATOR","\\",82],["T_STRING","ReflectionClass",82],"(",["T_VARIABLE","$config",82],"[",["T_CONSTANT_ENCAPSED_STRING","'class'",82],"]",")",";",["T_WHITESPACE","\n\n        ",82],["T_RETURN","return",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$reflection",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","newInstanceArgs",84],"(",["T_VARIABLE","$config",84],"[",["T_CONSTANT_ENCAPSED_STRING","'arguments'",84],"]",")",";",["T_WHITESPACE","\n    ",84],"}",["T_WHITESPACE","\n\n    ",85],["T_PRIVATE","private",87],["T_WHITESPACE"," ",87],["T_FUNCTION","function",87],["T_WHITESPACE"," ",87],["T_STRING","getEncoderConfigFromAlgorithm",87],"(",["T_VARIABLE","$config",87],")",["T_WHITESPACE","\n    ",87],"{",["T_WHITESPACE","\n        ",88],["T_SWITCH","switch",89],["T_WHITESPACE"," ",89],"(",["T_VARIABLE","$config",89],"[",["T_CONSTANT_ENCAPSED_STRING","'algorithm'",89],"]",")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n            ",89],["T_CASE","case",90],["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'plaintext'",90],":",["T_WHITESPACE","\n                ",90],["T_RETURN","return",91],["T_WHITESPACE"," ",91],["T_ARRAY","array",91],"(",["T_WHITESPACE","\n                    ",91],["T_CONSTANT_ENCAPSED_STRING","'class'",92],["T_WHITESPACE"," ",92],["T_DOUBLE_ARROW","=>",92],["T_WHITESPACE"," ",92],["T_STRING","PlaintextPasswordEncoder",92],["T_DOUBLE_COLON","::",92],["T_CLASS","class",92],",",["T_WHITESPACE","\n                    ",92],["T_CONSTANT_ENCAPSED_STRING","'arguments'",93],["T_WHITESPACE"," ",93],["T_DOUBLE_ARROW","=>",93],["T_WHITESPACE"," ",93],["T_ARRAY","array",93],"(",["T_VARIABLE","$config",93],"[",["T_CONSTANT_ENCAPSED_STRING","'ignore_case'",93],"]",")",",",["T_WHITESPACE","\n                ",93],")",";",["T_WHITESPACE","\n\n            ",94],["T_CASE","case",96],["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","'pbkdf2'",96],":",["T_WHITESPACE","\n                ",96],["T_RETURN","return",97],["T_WHITESPACE"," ",97],["T_ARRAY","array",97],"(",["T_WHITESPACE","\n                    ",97],["T_CONSTANT_ENCAPSED_STRING","'class'",98],["T_WHITESPACE"," ",98],["T_DOUBLE_ARROW","=>",98],["T_WHITESPACE"," ",98],["T_STRING","Pbkdf2PasswordEncoder",98],["T_DOUBLE_COLON","::",98],["T_CLASS","class",98],",",["T_WHITESPACE","\n                    ",98],["T_CONSTANT_ENCAPSED_STRING","'arguments'",99],["T_WHITESPACE"," ",99],["T_DOUBLE_ARROW","=>",99],["T_WHITESPACE"," ",99],["T_ARRAY","array",99],"(",["T_WHITESPACE","\n                        ",99],["T_VARIABLE","$config",100],"[",["T_CONSTANT_ENCAPSED_STRING","'hash_algorithm'",100],"]",",",["T_WHITESPACE","\n                        ",100],["T_VARIABLE","$config",101],"[",["T_CONSTANT_ENCAPSED_STRING","'encode_as_base64'",101],"]",",",["T_WHITESPACE","\n                        ",101],["T_VARIABLE","$config",102],"[",["T_CONSTANT_ENCAPSED_STRING","'iterations'",102],"]",",",["T_WHITESPACE","\n                        ",102],["T_VARIABLE","$config",103],"[",["T_CONSTANT_ENCAPSED_STRING","'key_length'",103],"]",",",["T_WHITESPACE","\n                    ",103],")",",",["T_WHITESPACE","\n                ",104],")",";",["T_WHITESPACE","\n\n            ",105],["T_CASE","case",107],["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'bcrypt'",107],":",["T_WHITESPACE","\n                ",107],["T_RETURN","return",108],["T_WHITESPACE"," ",108],["T_ARRAY","array",108],"(",["T_WHITESPACE","\n                    ",108],["T_CONSTANT_ENCAPSED_STRING","'class'",109],["T_WHITESPACE"," ",109],["T_DOUBLE_ARROW","=>",109],["T_WHITESPACE"," ",109],["T_STRING","BCryptPasswordEncoder",109],["T_DOUBLE_COLON","::",109],["T_CLASS","class",109],",",["T_WHITESPACE","\n                    ",109],["T_CONSTANT_ENCAPSED_STRING","'arguments'",110],["T_WHITESPACE"," ",110],["T_DOUBLE_ARROW","=>",110],["T_WHITESPACE"," ",110],["T_ARRAY","array",110],"(",["T_VARIABLE","$config",110],"[",["T_CONSTANT_ENCAPSED_STRING","'cost'",110],"]",")",",",["T_WHITESPACE","\n                ",110],")",";",["T_WHITESPACE","\n        ",111],"}",["T_WHITESPACE","\n\n        ",112],["T_RETURN","return",114],["T_WHITESPACE"," ",114],["T_ARRAY","array",114],"(",["T_WHITESPACE","\n            ",114],["T_CONSTANT_ENCAPSED_STRING","'class'",115],["T_WHITESPACE"," ",115],["T_DOUBLE_ARROW","=>",115],["T_WHITESPACE"," ",115],["T_STRING","MessageDigestPasswordEncoder",115],["T_DOUBLE_COLON","::",115],["T_CLASS","class",115],",",["T_WHITESPACE","\n            ",115],["T_CONSTANT_ENCAPSED_STRING","'arguments'",116],["T_WHITESPACE"," ",116],["T_DOUBLE_ARROW","=>",116],["T_WHITESPACE"," ",116],["T_ARRAY","array",116],"(",["T_WHITESPACE","\n                ",116],["T_VARIABLE","$config",117],"[",["T_CONSTANT_ENCAPSED_STRING","'algorithm'",117],"]",",",["T_WHITESPACE","\n                ",117],["T_VARIABLE","$config",118],"[",["T_CONSTANT_ENCAPSED_STRING","'encode_as_base64'",118],"]",",",["T_WHITESPACE","\n                ",118],["T_VARIABLE","$config",119],"[",["T_CONSTANT_ENCAPSED_STRING","'iterations'",119],"]",",",["T_WHITESPACE","\n            ",119],")",",",["T_WHITESPACE","\n        ",120],")",";",["T_WHITESPACE","\n    ",121],"}",["T_WHITESPACE","\n",122],"}",["T_WHITESPACE","\n",123]]