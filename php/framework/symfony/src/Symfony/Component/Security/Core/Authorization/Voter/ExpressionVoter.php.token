[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Security",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Core",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Authorization",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Voter",12],";",["T_WHITESPACE","\n\n",12],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Symfony",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Component",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Security",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Core",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Authentication",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Token",14],["T_NS_SEPARATOR","\\",14],["T_STRING","TokenInterface",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Symfony",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Component",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Security",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Core",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Authentication",15],["T_NS_SEPARATOR","\\",15],["T_STRING","AuthenticationTrustResolverInterface",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Symfony",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Component",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Security",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Core",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Authorization",16],["T_NS_SEPARATOR","\\",16],["T_STRING","ExpressionLanguage",16],";",["T_WHITESPACE","\n",16],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Symfony",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Component",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Security",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Core",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Role",17],["T_NS_SEPARATOR","\\",17],["T_STRING","RoleHierarchyInterface",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Symfony",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Component",18],["T_NS_SEPARATOR","\\",18],["T_STRING","ExpressionLanguage",18],["T_NS_SEPARATOR","\\",18],["T_STRING","ExpressionFunctionProviderInterface",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Symfony",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Component",19],["T_NS_SEPARATOR","\\",19],["T_STRING","ExpressionLanguage",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Expression",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Symfony",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Component",20],["T_NS_SEPARATOR","\\",20],["T_STRING","HttpFoundation",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Request",20],";",["T_WHITESPACE","\n\n",20],["T_DOC_COMMENT","\/**\n * ExpressionVoter votes based on the evaluation of an expression.\n *\n * @author Fabien Potencier <fabien@symfony.com>\n *\/",22],["T_WHITESPACE","\n",26],["T_CLASS","class",27],["T_WHITESPACE"," ",27],["T_STRING","ExpressionVoter",27],["T_WHITESPACE"," ",27],["T_IMPLEMENTS","implements",27],["T_WHITESPACE"," ",27],["T_STRING","VoterInterface",27],["T_WHITESPACE","\n",27],"{",["T_WHITESPACE","\n    ",28],["T_PRIVATE","private",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$expressionLanguage",29],";",["T_WHITESPACE","\n    ",29],["T_PRIVATE","private",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$trustResolver",30],";",["T_WHITESPACE","\n    ",30],["T_PRIVATE","private",31],["T_WHITESPACE"," ",31],["T_VARIABLE","$roleHierarchy",31],";",["T_WHITESPACE","\n\n    ",31],["T_DOC_COMMENT","\/**\n     * Constructor.\n     *\n     * @param ExpressionLanguage                   $expressionLanguage\n     * @param AuthenticationTrustResolverInterface $trustResolver\n     * @param RoleHierarchyInterface|null          $roleHierarchy\n     *\/",33],["T_WHITESPACE","\n    ",39],["T_PUBLIC","public",40],["T_WHITESPACE"," ",40],["T_FUNCTION","function",40],["T_WHITESPACE"," ",40],["T_STRING","__construct",40],"(",["T_STRING","ExpressionLanguage",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$expressionLanguage",40],",",["T_WHITESPACE"," ",40],["T_STRING","AuthenticationTrustResolverInterface",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$trustResolver",40],",",["T_WHITESPACE"," ",40],["T_STRING","RoleHierarchyInterface",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$roleHierarchy",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_STRING","null",40],")",["T_WHITESPACE","\n    ",40],"{",["T_WHITESPACE","\n        ",41],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","expressionLanguage",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_VARIABLE","$expressionLanguage",42],";",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","trustResolver",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_VARIABLE","$trustResolver",43],";",["T_WHITESPACE","\n        ",43],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","roleHierarchy",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_VARIABLE","$roleHierarchy",44],";",["T_WHITESPACE","\n    ",44],"}",["T_WHITESPACE","\n\n    ",45],["T_PUBLIC","public",47],["T_WHITESPACE"," ",47],["T_FUNCTION","function",47],["T_WHITESPACE"," ",47],["T_STRING","addExpressionLanguageProvider",47],"(",["T_STRING","ExpressionFunctionProviderInterface",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$provider",47],")",["T_WHITESPACE","\n    ",47],"{",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","expressionLanguage",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","registerProvider",49],"(",["T_VARIABLE","$provider",49],")",";",["T_WHITESPACE","\n    ",49],"}",["T_WHITESPACE","\n\n    ",50],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",52],["T_WHITESPACE","\n    ",54],["T_PUBLIC","public",55],["T_WHITESPACE"," ",55],["T_FUNCTION","function",55],["T_WHITESPACE"," ",55],["T_STRING","vote",55],"(",["T_STRING","TokenInterface",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$token",55],",",["T_WHITESPACE"," ",55],["T_VARIABLE","$subject",55],",",["T_WHITESPACE"," ",55],["T_ARRAY","array",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$attributes",55],")",["T_WHITESPACE","\n    ",55],"{",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$result",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_STRING","VoterInterface",57],["T_DOUBLE_COLON","::",57],["T_STRING","ACCESS_ABSTAIN",57],";",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$variables",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_STRING","null",58],";",["T_WHITESPACE","\n        ",58],["T_FOREACH","foreach",59],["T_WHITESPACE"," ",59],"(",["T_VARIABLE","$attributes",59],["T_WHITESPACE"," ",59],["T_AS","as",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$attribute",59],")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n            ",59],["T_IF","if",60],["T_WHITESPACE"," ",60],"(","!",["T_VARIABLE","$attribute",60],["T_WHITESPACE"," ",60],["T_INSTANCEOF","instanceof",60],["T_WHITESPACE"," ",60],["T_STRING","Expression",60],")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n                ",60],["T_CONTINUE","continue",61],";",["T_WHITESPACE","\n            ",61],"}",["T_WHITESPACE","\n\n            ",62],["T_IF","if",64],["T_WHITESPACE"," ",64],"(",["T_STRING","null",64],["T_WHITESPACE"," ",64],["T_IS_IDENTICAL","===",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$variables",64],")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n                ",64],["T_VARIABLE","$variables",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getVariables",65],"(",["T_VARIABLE","$token",65],",",["T_WHITESPACE"," ",65],["T_VARIABLE","$subject",65],")",";",["T_WHITESPACE","\n            ",65],"}",["T_WHITESPACE","\n\n            ",66],["T_VARIABLE","$result",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_STRING","VoterInterface",68],["T_DOUBLE_COLON","::",68],["T_STRING","ACCESS_DENIED",68],";",["T_WHITESPACE","\n            ",68],["T_IF","if",69],["T_WHITESPACE"," ",69],"(",["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","expressionLanguage",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","evaluate",69],"(",["T_VARIABLE","$attribute",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$variables",69],")",")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n                ",69],["T_RETURN","return",70],["T_WHITESPACE"," ",70],["T_STRING","VoterInterface",70],["T_DOUBLE_COLON","::",70],["T_STRING","ACCESS_GRANTED",70],";",["T_WHITESPACE","\n            ",70],"}",["T_WHITESPACE","\n        ",71],"}",["T_WHITESPACE","\n\n        ",72],["T_RETURN","return",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$result",74],";",["T_WHITESPACE","\n    ",74],"}",["T_WHITESPACE","\n\n    ",75],["T_PRIVATE","private",77],["T_WHITESPACE"," ",77],["T_FUNCTION","function",77],["T_WHITESPACE"," ",77],["T_STRING","getVariables",77],"(",["T_STRING","TokenInterface",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$token",77],",",["T_WHITESPACE"," ",77],["T_VARIABLE","$subject",77],")",["T_WHITESPACE","\n    ",77],"{",["T_WHITESPACE","\n        ",78],["T_IF","if",79],["T_WHITESPACE"," ",79],"(",["T_STRING","null",79],["T_WHITESPACE"," ",79],["T_IS_NOT_IDENTICAL","!==",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","roleHierarchy",79],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n            ",79],["T_VARIABLE","$roles",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","roleHierarchy",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getReachableRoles",80],"(",["T_VARIABLE","$token",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getRoles",80],"(",")",")",";",["T_WHITESPACE","\n        ",80],"}",["T_WHITESPACE"," ",81],["T_ELSE","else",81],["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n            ",81],["T_VARIABLE","$roles",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$token",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","getRoles",82],"(",")",";",["T_WHITESPACE","\n        ",82],"}",["T_WHITESPACE","\n\n        ",83],["T_VARIABLE","$variables",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_ARRAY","array",85],"(",["T_WHITESPACE","\n            ",85],["T_CONSTANT_ENCAPSED_STRING","'token'",86],["T_WHITESPACE"," ",86],["T_DOUBLE_ARROW","=>",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$token",86],",",["T_WHITESPACE","\n            ",86],["T_CONSTANT_ENCAPSED_STRING","'user'",87],["T_WHITESPACE"," ",87],["T_DOUBLE_ARROW","=>",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$token",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getUser",87],"(",")",",",["T_WHITESPACE","\n            ",87],["T_CONSTANT_ENCAPSED_STRING","'object'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$subject",88],",",["T_WHITESPACE","\n            ",88],["T_CONSTANT_ENCAPSED_STRING","'subject'",89],["T_WHITESPACE"," ",89],["T_DOUBLE_ARROW","=>",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$subject",89],",",["T_WHITESPACE","\n            ",89],["T_CONSTANT_ENCAPSED_STRING","'roles'",90],["T_WHITESPACE"," ",90],["T_DOUBLE_ARROW","=>",90],["T_WHITESPACE"," ",90],["T_STRING","array_map",90],"(",["T_FUNCTION","function",90],["T_WHITESPACE"," ",90],"(",["T_VARIABLE","$role",90],")",["T_WHITESPACE"," ",90],"{",["T_WHITESPACE"," ",90],["T_RETURN","return",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$role",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","getRole",90],"(",")",";",["T_WHITESPACE"," ",90],"}",",",["T_WHITESPACE"," ",90],["T_VARIABLE","$roles",90],")",",",["T_WHITESPACE","\n            ",90],["T_CONSTANT_ENCAPSED_STRING","'trust_resolver'",91],["T_WHITESPACE"," ",91],["T_DOUBLE_ARROW","=>",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","trustResolver",91],",",["T_WHITESPACE","\n        ",91],")",";",["T_WHITESPACE","\n\n        ",92],["T_COMMENT","\/\/ this is mainly to propose a better experience when the expression is used\n",94],["T_WHITESPACE","        ",95],["T_COMMENT","\/\/ in an access control rule, as the developer does not know that it's going\n",95],["T_WHITESPACE","        ",96],["T_COMMENT","\/\/ to be handled by this voter\n",96],["T_WHITESPACE","        ",97],["T_IF","if",97],["T_WHITESPACE"," ",97],"(",["T_VARIABLE","$subject",97],["T_WHITESPACE"," ",97],["T_INSTANCEOF","instanceof",97],["T_WHITESPACE"," ",97],["T_STRING","Request",97],")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n            ",97],["T_VARIABLE","$variables",98],"[",["T_CONSTANT_ENCAPSED_STRING","'request'",98],"]",["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$subject",98],";",["T_WHITESPACE","\n        ",98],"}",["T_WHITESPACE","\n\n        ",99],["T_RETURN","return",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$variables",101],";",["T_WHITESPACE","\n    ",101],"}",["T_WHITESPACE","\n",102],"}",["T_WHITESPACE","\n",103]]