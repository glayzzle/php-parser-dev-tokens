[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Security",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Core",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Encoder",12],";",["T_WHITESPACE","\n\n",12],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Symfony",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Component",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Security",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Core",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Exception",14],["T_NS_SEPARATOR","\\",14],["T_STRING","BadCredentialsException",14],";",["T_WHITESPACE","\n\n",14],["T_DOC_COMMENT","\/**\n * MessageDigestPasswordEncoder uses a message digest algorithm.\n *\n * @author Fabien Potencier <fabien@symfony.com>\n *\/",16],["T_WHITESPACE","\n",20],["T_CLASS","class",21],["T_WHITESPACE"," ",21],["T_STRING","MessageDigestPasswordEncoder",21],["T_WHITESPACE"," ",21],["T_EXTENDS","extends",21],["T_WHITESPACE"," ",21],["T_STRING","BasePasswordEncoder",21],["T_WHITESPACE","\n",21],"{",["T_WHITESPACE","\n    ",22],["T_PRIVATE","private",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$algorithm",23],";",["T_WHITESPACE","\n    ",23],["T_PRIVATE","private",24],["T_WHITESPACE"," ",24],["T_VARIABLE","$encodeHashAsBase64",24],";",["T_WHITESPACE","\n    ",24],["T_PRIVATE","private",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$iterations",25],";",["T_WHITESPACE","\n\n    ",25],["T_DOC_COMMENT","\/**\n     * Constructor.\n     *\n     * @param string $algorithm          The digest algorithm to use\n     * @param bool   $encodeHashAsBase64 Whether to base64 encode the password hash\n     * @param int    $iterations         The number of iterations to use to stretch the password hash\n     *\/",27],["T_WHITESPACE","\n    ",33],["T_PUBLIC","public",34],["T_WHITESPACE"," ",34],["T_FUNCTION","function",34],["T_WHITESPACE"," ",34],["T_STRING","__construct",34],"(",["T_VARIABLE","$algorithm",34],["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","'sha512'",34],",",["T_WHITESPACE"," ",34],["T_VARIABLE","$encodeHashAsBase64",34],["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_STRING","true",34],",",["T_WHITESPACE"," ",34],["T_VARIABLE","$iterations",34],["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_LNUMBER","5000",34],")",["T_WHITESPACE","\n    ",34],"{",["T_WHITESPACE","\n        ",35],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","algorithm",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$algorithm",36],";",["T_WHITESPACE","\n        ",36],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","encodeHashAsBase64",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_VARIABLE","$encodeHashAsBase64",37],";",["T_WHITESPACE","\n        ",37],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","iterations",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_VARIABLE","$iterations",38],";",["T_WHITESPACE","\n    ",38],"}",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",41],["T_WHITESPACE","\n    ",43],["T_PUBLIC","public",44],["T_WHITESPACE"," ",44],["T_FUNCTION","function",44],["T_WHITESPACE"," ",44],["T_STRING","encodePassword",44],"(",["T_VARIABLE","$raw",44],",",["T_WHITESPACE"," ",44],["T_VARIABLE","$salt",44],")",["T_WHITESPACE","\n    ",44],"{",["T_WHITESPACE","\n        ",45],["T_IF","if",46],["T_WHITESPACE"," ",46],"(",["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","isPasswordTooLong",46],"(",["T_VARIABLE","$raw",46],")",")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n            ",46],["T_THROW","throw",47],["T_WHITESPACE"," ",47],["T_NEW","new",47],["T_WHITESPACE"," ",47],["T_STRING","BadCredentialsException",47],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid password.'",47],")",";",["T_WHITESPACE","\n        ",47],"}",["T_WHITESPACE","\n\n        ",48],["T_IF","if",50],["T_WHITESPACE"," ",50],"(","!",["T_STRING","in_array",50],"(",["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","algorithm",50],",",["T_WHITESPACE"," ",50],["T_STRING","hash_algos",50],"(",")",",",["T_WHITESPACE"," ",50],["T_STRING","true",50],")",")",["T_WHITESPACE"," ",50],"{",["T_WHITESPACE","\n            ",50],["T_THROW","throw",51],["T_WHITESPACE"," ",51],["T_NEW","new",51],["T_WHITESPACE"," ",51],["T_NS_SEPARATOR","\\",51],["T_STRING","LogicException",51],"(",["T_STRING","sprintf",51],"(",["T_CONSTANT_ENCAPSED_STRING","'The algorithm \"%s\" is not supported.'",51],",",["T_WHITESPACE"," ",51],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","algorithm",51],")",")",";",["T_WHITESPACE","\n        ",51],"}",["T_WHITESPACE","\n\n        ",52],["T_VARIABLE","$salted",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","mergePasswordAndSalt",54],"(",["T_VARIABLE","$raw",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$salt",54],")",";",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$digest",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","hash",55],"(",["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","algorithm",55],",",["T_WHITESPACE"," ",55],["T_VARIABLE","$salted",55],",",["T_WHITESPACE"," ",55],["T_STRING","true",55],")",";",["T_WHITESPACE","\n\n        ",55],["T_COMMENT","\/\/ \"stretch\" hash\n",57],["T_WHITESPACE","        ",58],["T_FOR","for",58],["T_WHITESPACE"," ",58],"(",["T_VARIABLE","$i",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_LNUMBER","1",58],";",["T_WHITESPACE"," ",58],["T_VARIABLE","$i",58],["T_WHITESPACE"," ",58],"<",["T_WHITESPACE"," ",58],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","iterations",58],";",["T_WHITESPACE"," ",58],["T_INC","++",58],["T_VARIABLE","$i",58],")",["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n            ",58],["T_VARIABLE","$digest",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_STRING","hash",59],"(",["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","algorithm",59],",",["T_WHITESPACE"," ",59],["T_VARIABLE","$digest",59],".",["T_VARIABLE","$salted",59],",",["T_WHITESPACE"," ",59],["T_STRING","true",59],")",";",["T_WHITESPACE","\n        ",59],"}",["T_WHITESPACE","\n\n        ",60],["T_RETURN","return",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","encodeHashAsBase64",62],["T_WHITESPACE"," ",62],"?",["T_WHITESPACE"," ",62],["T_STRING","base64_encode",62],"(",["T_VARIABLE","$digest",62],")",["T_WHITESPACE"," ",62],":",["T_WHITESPACE"," ",62],["T_STRING","bin2hex",62],"(",["T_VARIABLE","$digest",62],")",";",["T_WHITESPACE","\n    ",62],"}",["T_WHITESPACE","\n\n    ",63],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",65],["T_WHITESPACE","\n    ",67],["T_PUBLIC","public",68],["T_WHITESPACE"," ",68],["T_FUNCTION","function",68],["T_WHITESPACE"," ",68],["T_STRING","isPasswordValid",68],"(",["T_VARIABLE","$encoded",68],",",["T_WHITESPACE"," ",68],["T_VARIABLE","$raw",68],",",["T_WHITESPACE"," ",68],["T_VARIABLE","$salt",68],")",["T_WHITESPACE","\n    ",68],"{",["T_WHITESPACE","\n        ",69],["T_RETURN","return",70],["T_WHITESPACE"," ",70],"!",["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","isPasswordTooLong",70],"(",["T_VARIABLE","$raw",70],")",["T_WHITESPACE"," ",70],["T_BOOLEAN_AND","&&",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","comparePasswords",70],"(",["T_VARIABLE","$encoded",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","encodePassword",70],"(",["T_VARIABLE","$raw",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$salt",70],")",")",";",["T_WHITESPACE","\n    ",70],"}",["T_WHITESPACE","\n",71],"}",["T_WHITESPACE","\n",72]]