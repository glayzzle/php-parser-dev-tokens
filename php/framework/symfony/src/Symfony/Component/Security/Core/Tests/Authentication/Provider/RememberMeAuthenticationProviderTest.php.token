[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Security",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Core",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Tests",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Authentication",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Provider",12],";",["T_WHITESPACE","\n\n",12],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Symfony",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Component",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Security",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Core",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Authentication",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Provider",14],["T_NS_SEPARATOR","\\",14],["T_STRING","RememberMeAuthenticationProvider",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Symfony",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Component",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Security",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Core",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Exception",15],["T_NS_SEPARATOR","\\",15],["T_STRING","DisabledException",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Symfony",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Component",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Security",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Core",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Role",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Role",16],";",["T_WHITESPACE","\n\n",16],["T_CLASS","class",18],["T_WHITESPACE"," ",18],["T_STRING","RememberMeAuthenticationProviderTest",18],["T_WHITESPACE"," ",18],["T_EXTENDS","extends",18],["T_WHITESPACE"," ",18],["T_NS_SEPARATOR","\\",18],["T_STRING","PHPUnit_Framework_TestCase",18],["T_WHITESPACE","\n",18],"{",["T_WHITESPACE","\n    ",19],["T_PUBLIC","public",20],["T_WHITESPACE"," ",20],["T_FUNCTION","function",20],["T_WHITESPACE"," ",20],["T_STRING","testSupports",20],"(",")",["T_WHITESPACE","\n    ",20],"{",["T_WHITESPACE","\n        ",21],["T_VARIABLE","$provider",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_VARIABLE","$this",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","getProvider",22],"(",")",";",["T_WHITESPACE","\n\n        ",22],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","assertTrue",24],"(",["T_VARIABLE","$provider",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","supports",24],"(",["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","getSupportedToken",24],"(",")",")",")",";",["T_WHITESPACE","\n        ",24],["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","assertFalse",25],"(",["T_VARIABLE","$provider",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","supports",25],"(",["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","getMockBuilder",25],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Core\\Authentication\\Token\\TokenInterface'",25],")",["T_OBJECT_OPERATOR","->",25],["T_STRING","getMock",25],"(",")",")",")",";",["T_WHITESPACE","\n    ",25],"}",["T_WHITESPACE","\n\n    ",26],["T_PUBLIC","public",28],["T_WHITESPACE"," ",28],["T_FUNCTION","function",28],["T_WHITESPACE"," ",28],["T_STRING","testAuthenticateWhenTokenIsNotSupported",28],"(",")",["T_WHITESPACE","\n    ",28],"{",["T_WHITESPACE","\n        ",29],["T_VARIABLE","$provider",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","getProvider",30],"(",")",";",["T_WHITESPACE","\n\n        ",30],["T_VARIABLE","$token",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","getMockBuilder",32],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Core\\Authentication\\Token\\TokenInterface'",32],")",["T_OBJECT_OPERATOR","->",32],["T_STRING","getMock",32],"(",")",";",["T_WHITESPACE","\n        ",32],["T_VARIABLE","$this",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","assertNull",33],"(",["T_VARIABLE","$provider",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","authenticate",33],"(",["T_VARIABLE","$token",33],")",")",";",["T_WHITESPACE","\n    ",33],"}",["T_WHITESPACE","\n\n    ",34],["T_DOC_COMMENT","\/**\n     * @expectedException \\Symfony\\Component\\Security\\Core\\Exception\\BadCredentialsException\n     *\/",36],["T_WHITESPACE","\n    ",38],["T_PUBLIC","public",39],["T_WHITESPACE"," ",39],["T_FUNCTION","function",39],["T_WHITESPACE"," ",39],["T_STRING","testAuthenticateWhenSecretsDoNotMatch",39],"(",")",["T_WHITESPACE","\n    ",39],"{",["T_WHITESPACE","\n        ",40],["T_VARIABLE","$provider",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","getProvider",41],"(",["T_STRING","null",41],",",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'secret1'",41],")",";",["T_WHITESPACE","\n        ",41],["T_VARIABLE","$token",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","getSupportedToken",42],"(",["T_STRING","null",42],",",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'secret2'",42],")",";",["T_WHITESPACE","\n\n        ",42],["T_VARIABLE","$provider",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","authenticate",44],"(",["T_VARIABLE","$token",44],")",";",["T_WHITESPACE","\n    ",44],"}",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * @expectedException \\Symfony\\Component\\Security\\Core\\Exception\\DisabledException\n     *\/",47],["T_WHITESPACE","\n    ",49],["T_PUBLIC","public",50],["T_WHITESPACE"," ",50],["T_FUNCTION","function",50],["T_WHITESPACE"," ",50],["T_STRING","testAuthenticateWhenPreChecksFails",50],"(",")",["T_WHITESPACE","\n    ",50],"{",["T_WHITESPACE","\n        ",51],["T_VARIABLE","$userChecker",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","getMockBuilder",52],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Core\\User\\UserCheckerInterface'",52],")",["T_OBJECT_OPERATOR","->",52],["T_STRING","getMock",52],"(",")",";",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$userChecker",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","expects",53],"(",["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","once",53],"(",")",")",["T_WHITESPACE","\n            ",53],["T_OBJECT_OPERATOR","->",54],["T_STRING","method",54],"(",["T_CONSTANT_ENCAPSED_STRING","'checkPreAuth'",54],")",["T_WHITESPACE","\n            ",54],["T_OBJECT_OPERATOR","->",55],["T_STRING","will",55],"(",["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","throwException",55],"(",["T_NEW","new",55],["T_WHITESPACE"," ",55],["T_STRING","DisabledException",55],"(",")",")",")",";",["T_WHITESPACE","\n\n        ",55],["T_VARIABLE","$provider",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","getProvider",57],"(",["T_VARIABLE","$userChecker",57],")",";",["T_WHITESPACE","\n\n        ",57],["T_VARIABLE","$provider",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","authenticate",59],"(",["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","getSupportedToken",59],"(",")",")",";",["T_WHITESPACE","\n    ",59],"}",["T_WHITESPACE","\n\n    ",60],["T_PUBLIC","public",62],["T_WHITESPACE"," ",62],["T_FUNCTION","function",62],["T_WHITESPACE"," ",62],["T_STRING","testAuthenticate",62],"(",")",["T_WHITESPACE","\n    ",62],"{",["T_WHITESPACE","\n        ",63],["T_VARIABLE","$user",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","getMockBuilder",64],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Core\\User\\UserInterface'",64],")",["T_OBJECT_OPERATOR","->",64],["T_STRING","getMock",64],"(",")",";",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$user",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","expects",65],"(",["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","exactly",65],"(",["T_LNUMBER","2",65],")",")",["T_WHITESPACE","\n             ",65],["T_OBJECT_OPERATOR","->",66],["T_STRING","method",66],"(",["T_CONSTANT_ENCAPSED_STRING","'getRoles'",66],")",["T_WHITESPACE","\n             ",66],["T_OBJECT_OPERATOR","->",67],["T_STRING","will",67],"(",["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","returnValue",67],"(",["T_ARRAY","array",67],"(",["T_CONSTANT_ENCAPSED_STRING","'ROLE_FOO'",67],")",")",")",";",["T_WHITESPACE","\n\n        ",67],["T_VARIABLE","$provider",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getProvider",69],"(",")",";",["T_WHITESPACE","\n\n        ",69],["T_VARIABLE","$token",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getSupportedToken",71],"(",["T_VARIABLE","$user",71],")",";",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$authToken",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_VARIABLE","$provider",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","authenticate",72],"(",["T_VARIABLE","$token",72],")",";",["T_WHITESPACE","\n\n        ",72],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","assertInstanceOf",74],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Core\\Authentication\\Token\\RememberMeToken'",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$authToken",74],")",";",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","assertSame",75],"(",["T_VARIABLE","$user",75],",",["T_WHITESPACE"," ",75],["T_VARIABLE","$authToken",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getUser",75],"(",")",")",";",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","assertEquals",76],"(",["T_ARRAY","array",76],"(",["T_NEW","new",76],["T_WHITESPACE"," ",76],["T_STRING","Role",76],"(",["T_CONSTANT_ENCAPSED_STRING","'ROLE_FOO'",76],")",")",",",["T_WHITESPACE"," ",76],["T_VARIABLE","$authToken",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getRoles",76],"(",")",")",";",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","assertEquals",77],"(",["T_CONSTANT_ENCAPSED_STRING","''",77],",",["T_WHITESPACE"," ",77],["T_VARIABLE","$authToken",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getCredentials",77],"(",")",")",";",["T_WHITESPACE","\n    ",77],"}",["T_WHITESPACE","\n\n    ",78],["T_PROTECTED","protected",80],["T_WHITESPACE"," ",80],["T_FUNCTION","function",80],["T_WHITESPACE"," ",80],["T_STRING","getSupportedToken",80],"(",["T_VARIABLE","$user",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_STRING","null",80],",",["T_WHITESPACE"," ",80],["T_VARIABLE","$secret",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'test'",80],")",["T_WHITESPACE","\n    ",80],"{",["T_WHITESPACE","\n        ",81],["T_IF","if",82],["T_WHITESPACE"," ",82],"(",["T_STRING","null",82],["T_WHITESPACE"," ",82],["T_IS_IDENTICAL","===",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$user",82],")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n            ",82],["T_VARIABLE","$user",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","getMockBuilder",83],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Core\\User\\UserInterface'",83],")",["T_OBJECT_OPERATOR","->",83],["T_STRING","getMock",83],"(",")",";",["T_WHITESPACE","\n            ",83],["T_VARIABLE","$user",84],["T_WHITESPACE","\n                ",84],["T_OBJECT_OPERATOR","->",85],["T_STRING","expects",85],"(",["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","any",85],"(",")",")",["T_WHITESPACE","\n                ",85],["T_OBJECT_OPERATOR","->",86],["T_STRING","method",86],"(",["T_CONSTANT_ENCAPSED_STRING","'getRoles'",86],")",["T_WHITESPACE","\n                ",86],["T_OBJECT_OPERATOR","->",87],["T_STRING","will",87],"(",["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","returnValue",87],"(",["T_ARRAY","array",87],"(",")",")",")",";",["T_WHITESPACE","\n        ",87],"}",["T_WHITESPACE","\n\n        ",88],["T_VARIABLE","$token",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","getMockBuilder",90],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Core\\Authentication\\Token\\RememberMeToken'",90],")",["T_OBJECT_OPERATOR","->",90],["T_STRING","setMethods",90],"(",["T_ARRAY","array",90],"(",["T_CONSTANT_ENCAPSED_STRING","'getProviderKey'",90],")",")",["T_OBJECT_OPERATOR","->",90],["T_STRING","setConstructorArgs",90],"(",["T_ARRAY","array",90],"(",["T_VARIABLE","$user",90],",",["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'foo'",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$secret",90],")",")",["T_OBJECT_OPERATOR","->",90],["T_STRING","getMock",90],"(",")",";",["T_WHITESPACE","\n        ",90],["T_VARIABLE","$token",91],["T_WHITESPACE","\n            ",91],["T_OBJECT_OPERATOR","->",92],["T_STRING","expects",92],"(",["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","once",92],"(",")",")",["T_WHITESPACE","\n            ",92],["T_OBJECT_OPERATOR","->",93],["T_STRING","method",93],"(",["T_CONSTANT_ENCAPSED_STRING","'getProviderKey'",93],")",["T_WHITESPACE","\n            ",93],["T_OBJECT_OPERATOR","->",94],["T_STRING","will",94],"(",["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","returnValue",94],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",94],")",")",";",["T_WHITESPACE","\n\n        ",94],["T_RETURN","return",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$token",96],";",["T_WHITESPACE","\n    ",96],"}",["T_WHITESPACE","\n\n    ",97],["T_PROTECTED","protected",99],["T_WHITESPACE"," ",99],["T_FUNCTION","function",99],["T_WHITESPACE"," ",99],["T_STRING","getProvider",99],"(",["T_VARIABLE","$userChecker",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_STRING","null",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$key",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","'test'",99],")",["T_WHITESPACE","\n    ",99],"{",["T_WHITESPACE","\n        ",100],["T_IF","if",101],["T_WHITESPACE"," ",101],"(",["T_STRING","null",101],["T_WHITESPACE"," ",101],["T_IS_IDENTICAL","===",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$userChecker",101],")",["T_WHITESPACE"," ",101],"{",["T_WHITESPACE","\n            ",101],["T_VARIABLE","$userChecker",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getMockBuilder",102],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Core\\User\\UserCheckerInterface'",102],")",["T_OBJECT_OPERATOR","->",102],["T_STRING","getMock",102],"(",")",";",["T_WHITESPACE","\n        ",102],"}",["T_WHITESPACE","\n\n        ",103],["T_RETURN","return",105],["T_WHITESPACE"," ",105],["T_NEW","new",105],["T_WHITESPACE"," ",105],["T_STRING","RememberMeAuthenticationProvider",105],"(",["T_VARIABLE","$userChecker",105],",",["T_WHITESPACE"," ",105],["T_VARIABLE","$key",105],",",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'foo'",105],")",";",["T_WHITESPACE","\n    ",105],"}",["T_WHITESPACE","\n",106],"}",["T_WHITESPACE","\n",107]]