[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Security",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Http",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Firewall",12],";",["T_WHITESPACE","\n\n",12],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Psr",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Log",14],["T_NS_SEPARATOR","\\",14],["T_STRING","LoggerInterface",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Symfony",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Component",15],["T_NS_SEPARATOR","\\",15],["T_STRING","EventDispatcher",15],["T_NS_SEPARATOR","\\",15],["T_STRING","EventDispatcherInterface",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Symfony",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Component",16],["T_NS_SEPARATOR","\\",16],["T_STRING","HttpFoundation",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Request",16],";",["T_WHITESPACE","\n",16],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Symfony",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Component",17],["T_NS_SEPARATOR","\\",17],["T_STRING","HttpFoundation",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Response",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Symfony",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Component",18],["T_NS_SEPARATOR","\\",18],["T_STRING","HttpKernel",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Event",18],["T_NS_SEPARATOR","\\",18],["T_STRING","GetResponseEvent",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Symfony",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Component",19],["T_NS_SEPARATOR","\\",19],["T_STRING","PropertyAccess",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Exception",19],["T_NS_SEPARATOR","\\",19],["T_STRING","AccessException",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Symfony",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Component",20],["T_NS_SEPARATOR","\\",20],["T_STRING","PropertyAccess",20],["T_NS_SEPARATOR","\\",20],["T_STRING","PropertyAccess",20],";",["T_WHITESPACE","\n",20],["T_USE","use",21],["T_WHITESPACE"," ",21],["T_STRING","Symfony",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Component",21],["T_NS_SEPARATOR","\\",21],["T_STRING","PropertyAccess",21],["T_NS_SEPARATOR","\\",21],["T_STRING","PropertyAccessorInterface",21],";",["T_WHITESPACE","\n",21],["T_USE","use",22],["T_WHITESPACE"," ",22],["T_STRING","Symfony",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Component",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Security",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Core",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Authentication",22],["T_NS_SEPARATOR","\\",22],["T_STRING","AuthenticationManagerInterface",22],";",["T_WHITESPACE","\n",22],["T_USE","use",23],["T_WHITESPACE"," ",23],["T_STRING","Symfony",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Component",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Security",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Core",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Authentication",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Token",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Storage",23],["T_NS_SEPARATOR","\\",23],["T_STRING","TokenStorageInterface",23],";",["T_WHITESPACE","\n",23],["T_USE","use",24],["T_WHITESPACE"," ",24],["T_STRING","Symfony",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Component",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Security",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Core",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Authentication",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Token",24],["T_NS_SEPARATOR","\\",24],["T_STRING","TokenInterface",24],";",["T_WHITESPACE","\n",24],["T_USE","use",25],["T_WHITESPACE"," ",25],["T_STRING","Symfony",25],["T_NS_SEPARATOR","\\",25],["T_STRING","Component",25],["T_NS_SEPARATOR","\\",25],["T_STRING","Security",25],["T_NS_SEPARATOR","\\",25],["T_STRING","Core",25],["T_NS_SEPARATOR","\\",25],["T_STRING","Authentication",25],["T_NS_SEPARATOR","\\",25],["T_STRING","Token",25],["T_NS_SEPARATOR","\\",25],["T_STRING","UsernamePasswordToken",25],";",["T_WHITESPACE","\n",25],["T_USE","use",26],["T_WHITESPACE"," ",26],["T_STRING","Symfony",26],["T_NS_SEPARATOR","\\",26],["T_STRING","Component",26],["T_NS_SEPARATOR","\\",26],["T_STRING","Security",26],["T_NS_SEPARATOR","\\",26],["T_STRING","Core",26],["T_NS_SEPARATOR","\\",26],["T_STRING","Exception",26],["T_NS_SEPARATOR","\\",26],["T_STRING","AuthenticationException",26],";",["T_WHITESPACE","\n",26],["T_USE","use",27],["T_WHITESPACE"," ",27],["T_STRING","Symfony",27],["T_NS_SEPARATOR","\\",27],["T_STRING","Component",27],["T_NS_SEPARATOR","\\",27],["T_STRING","Security",27],["T_NS_SEPARATOR","\\",27],["T_STRING","Core",27],["T_NS_SEPARATOR","\\",27],["T_STRING","Exception",27],["T_NS_SEPARATOR","\\",27],["T_STRING","BadCredentialsException",27],";",["T_WHITESPACE","\n",27],["T_USE","use",28],["T_WHITESPACE"," ",28],["T_STRING","Symfony",28],["T_NS_SEPARATOR","\\",28],["T_STRING","Component",28],["T_NS_SEPARATOR","\\",28],["T_STRING","Security",28],["T_NS_SEPARATOR","\\",28],["T_STRING","Core",28],["T_NS_SEPARATOR","\\",28],["T_STRING","Security",28],";",["T_WHITESPACE","\n",28],["T_USE","use",29],["T_WHITESPACE"," ",29],["T_STRING","Symfony",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Component",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Security",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Http",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Authentication",29],["T_NS_SEPARATOR","\\",29],["T_STRING","AuthenticationFailureHandlerInterface",29],";",["T_WHITESPACE","\n",29],["T_USE","use",30],["T_WHITESPACE"," ",30],["T_STRING","Symfony",30],["T_NS_SEPARATOR","\\",30],["T_STRING","Component",30],["T_NS_SEPARATOR","\\",30],["T_STRING","Security",30],["T_NS_SEPARATOR","\\",30],["T_STRING","Http",30],["T_NS_SEPARATOR","\\",30],["T_STRING","Authentication",30],["T_NS_SEPARATOR","\\",30],["T_STRING","AuthenticationSuccessHandlerInterface",30],";",["T_WHITESPACE","\n",30],["T_USE","use",31],["T_WHITESPACE"," ",31],["T_STRING","Symfony",31],["T_NS_SEPARATOR","\\",31],["T_STRING","Component",31],["T_NS_SEPARATOR","\\",31],["T_STRING","Security",31],["T_NS_SEPARATOR","\\",31],["T_STRING","Http",31],["T_NS_SEPARATOR","\\",31],["T_STRING","Event",31],["T_NS_SEPARATOR","\\",31],["T_STRING","InteractiveLoginEvent",31],";",["T_WHITESPACE","\n",31],["T_USE","use",32],["T_WHITESPACE"," ",32],["T_STRING","Symfony",32],["T_NS_SEPARATOR","\\",32],["T_STRING","Component",32],["T_NS_SEPARATOR","\\",32],["T_STRING","Security",32],["T_NS_SEPARATOR","\\",32],["T_STRING","Http",32],["T_NS_SEPARATOR","\\",32],["T_STRING","SecurityEvents",32],";",["T_WHITESPACE","\n\n",32],["T_DOC_COMMENT","\/**\n * UsernamePasswordJsonAuthenticationListener is a stateless implementation of\n * an authentication via a JSON document composed of a username and a password.\n *\n * @author K\u00c3\u00a9vin Dunglas <dunglas@gmail.com>\n *\/",34],["T_WHITESPACE","\n",39],["T_CLASS","class",40],["T_WHITESPACE"," ",40],["T_STRING","UsernamePasswordJsonAuthenticationListener",40],["T_WHITESPACE"," ",40],["T_IMPLEMENTS","implements",40],["T_WHITESPACE"," ",40],["T_STRING","ListenerInterface",40],["T_WHITESPACE","\n",40],"{",["T_WHITESPACE","\n    ",41],["T_PRIVATE","private",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$tokenStorage",42],";",["T_WHITESPACE","\n    ",42],["T_PRIVATE","private",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$authenticationManager",43],";",["T_WHITESPACE","\n    ",43],["T_PRIVATE","private",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$providerKey",44],";",["T_WHITESPACE","\n    ",44],["T_PRIVATE","private",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$successHandler",45],";",["T_WHITESPACE","\n    ",45],["T_PRIVATE","private",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$failureHandler",46],";",["T_WHITESPACE","\n    ",46],["T_PRIVATE","private",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$options",47],";",["T_WHITESPACE","\n    ",47],["T_PRIVATE","private",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$logger",48],";",["T_WHITESPACE","\n    ",48],["T_PRIVATE","private",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$eventDispatcher",49],";",["T_WHITESPACE","\n    ",49],["T_PRIVATE","private",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$propertyAccessor",50],";",["T_WHITESPACE","\n\n    ",50],["T_PUBLIC","public",52],["T_WHITESPACE"," ",52],["T_FUNCTION","function",52],["T_WHITESPACE"," ",52],["T_STRING","__construct",52],"(",["T_STRING","TokenStorageInterface",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$tokenStorage",52],",",["T_WHITESPACE"," ",52],["T_STRING","AuthenticationManagerInterface",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$authenticationManager",52],",",["T_WHITESPACE"," ",52],["T_VARIABLE","$providerKey",52],",",["T_WHITESPACE"," ",52],["T_STRING","AuthenticationSuccessHandlerInterface",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$successHandler",52],",",["T_WHITESPACE"," ",52],["T_STRING","AuthenticationFailureHandlerInterface",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$failureHandler",52],",",["T_WHITESPACE"," ",52],["T_ARRAY","array",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$options",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_ARRAY","array",52],"(",")",",",["T_WHITESPACE"," ",52],["T_STRING","LoggerInterface",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$logger",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_STRING","null",52],",",["T_WHITESPACE"," ",52],["T_STRING","EventDispatcherInterface",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$eventDispatcher",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_STRING","null",52],",",["T_WHITESPACE"," ",52],["T_STRING","PropertyAccessorInterface",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$propertyAccessor",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_STRING","null",52],")",["T_WHITESPACE","\n    ",52],"{",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","tokenStorage",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$tokenStorage",54],";",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","authenticationManager",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_VARIABLE","$authenticationManager",55],";",["T_WHITESPACE","\n        ",55],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","providerKey",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$providerKey",56],";",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","successHandler",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$successHandler",57],";",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","failureHandler",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$failureHandler",58],";",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","logger",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$logger",59],";",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","eventDispatcher",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$eventDispatcher",60],";",["T_WHITESPACE","\n        ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","options",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_STRING","array_merge",61],"(",["T_ARRAY","array",61],"(",["T_CONSTANT_ENCAPSED_STRING","'username_path'",61],["T_WHITESPACE"," ",61],["T_DOUBLE_ARROW","=>",61],["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'username'",61],",",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'password_path'",61],["T_WHITESPACE"," ",61],["T_DOUBLE_ARROW","=>",61],["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'password'",61],")",",",["T_WHITESPACE"," ",61],["T_VARIABLE","$options",61],")",";",["T_WHITESPACE","\n        ",61],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","propertyAccessor",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_VARIABLE","$propertyAccessor",62],["T_WHITESPACE"," ",62],"?",":",["T_WHITESPACE"," ",62],["T_STRING","PropertyAccess",62],["T_DOUBLE_COLON","::",62],["T_STRING","createPropertyAccessor",62],"(",")",";",["T_WHITESPACE","\n    ",62],"}",["T_WHITESPACE","\n\n    ",63],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",65],["T_WHITESPACE","\n    ",67],["T_PUBLIC","public",68],["T_WHITESPACE"," ",68],["T_FUNCTION","function",68],["T_WHITESPACE"," ",68],["T_STRING","handle",68],"(",["T_STRING","GetResponseEvent",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$event",68],")",["T_WHITESPACE","\n    ",68],"{",["T_WHITESPACE","\n        ",69],["T_VARIABLE","$request",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$event",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getRequest",70],"(",")",";",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$data",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_STRING","json_decode",71],"(",["T_VARIABLE","$request",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getContent",71],"(",")",")",";",["T_WHITESPACE","\n\n        ",71],["T_IF","if",73],["T_WHITESPACE"," ",73],"(","!",["T_VARIABLE","$data",73],["T_WHITESPACE"," ",73],["T_INSTANCEOF","instanceof",73],["T_WHITESPACE"," ",73],["T_NS_SEPARATOR","\\",73],["T_STRING","stdClass",73],")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n            ",73],["T_THROW","throw",74],["T_WHITESPACE"," ",74],["T_NEW","new",74],["T_WHITESPACE"," ",74],["T_STRING","BadCredentialsException",74],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid JSON.'",74],")",";",["T_WHITESPACE","\n        ",74],"}",["T_WHITESPACE","\n\n        ",75],["T_TRY","try",77],["T_WHITESPACE"," ",77],"{",["T_WHITESPACE","\n            ",77],["T_VARIABLE","$username",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","propertyAccessor",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getValue",78],"(",["T_VARIABLE","$data",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","options",78],"[",["T_CONSTANT_ENCAPSED_STRING","'username_path'",78],"]",")",";",["T_WHITESPACE","\n        ",78],"}",["T_WHITESPACE"," ",79],["T_CATCH","catch",79],["T_WHITESPACE"," ",79],"(",["T_STRING","AccessException",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$e",79],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n            ",79],["T_THROW","throw",80],["T_WHITESPACE"," ",80],["T_NEW","new",80],["T_WHITESPACE"," ",80],["T_STRING","BadCredentialsException",80],"(",["T_STRING","sprintf",80],"(",["T_CONSTANT_ENCAPSED_STRING","'The key \"%s\" must be provided.'",80],",",["T_WHITESPACE"," ",80],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","options",80],"[",["T_CONSTANT_ENCAPSED_STRING","'username_path'",80],"]",")",")",";",["T_WHITESPACE","\n        ",80],"}",["T_WHITESPACE","\n\n        ",81],["T_TRY","try",83],["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n            ",83],["T_VARIABLE","$password",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","propertyAccessor",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getValue",84],"(",["T_VARIABLE","$data",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","options",84],"[",["T_CONSTANT_ENCAPSED_STRING","'password_path'",84],"]",")",";",["T_WHITESPACE","\n        ",84],"}",["T_WHITESPACE"," ",85],["T_CATCH","catch",85],["T_WHITESPACE"," ",85],"(",["T_STRING","AccessException",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$e",85],")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n            ",85],["T_THROW","throw",86],["T_WHITESPACE"," ",86],["T_NEW","new",86],["T_WHITESPACE"," ",86],["T_STRING","BadCredentialsException",86],"(",["T_STRING","sprintf",86],"(",["T_CONSTANT_ENCAPSED_STRING","'The key \"%s\" must be provided.'",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","options",86],"[",["T_CONSTANT_ENCAPSED_STRING","'password_path'",86],"]",")",")",";",["T_WHITESPACE","\n        ",86],"}",["T_WHITESPACE","\n\n        ",87],["T_IF","if",89],["T_WHITESPACE"," ",89],"(","!",["T_STRING","is_string",89],"(",["T_VARIABLE","$username",89],")",")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n            ",89],["T_THROW","throw",90],["T_WHITESPACE"," ",90],["T_NEW","new",90],["T_WHITESPACE"," ",90],["T_STRING","BadCredentialsException",90],"(",["T_STRING","sprintf",90],"(",["T_CONSTANT_ENCAPSED_STRING","'The key \"%s\" must be a string.'",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","options",90],"[",["T_CONSTANT_ENCAPSED_STRING","'username_path'",90],"]",")",")",";",["T_WHITESPACE","\n        ",90],"}",["T_WHITESPACE","\n\n        ",91],["T_IF","if",93],["T_WHITESPACE"," ",93],"(",["T_STRING","strlen",93],"(",["T_VARIABLE","$username",93],")",["T_WHITESPACE"," ",93],">",["T_WHITESPACE"," ",93],["T_STRING","Security",93],["T_DOUBLE_COLON","::",93],["T_STRING","MAX_USERNAME_LENGTH",93],")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n            ",93],["T_THROW","throw",94],["T_WHITESPACE"," ",94],["T_NEW","new",94],["T_WHITESPACE"," ",94],["T_STRING","BadCredentialsException",94],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid username.'",94],")",";",["T_WHITESPACE","\n        ",94],"}",["T_WHITESPACE","\n\n        ",95],["T_IF","if",97],["T_WHITESPACE"," ",97],"(","!",["T_STRING","is_string",97],"(",["T_VARIABLE","$password",97],")",")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n            ",97],["T_THROW","throw",98],["T_WHITESPACE"," ",98],["T_NEW","new",98],["T_WHITESPACE"," ",98],["T_STRING","BadCredentialsException",98],"(",["T_STRING","sprintf",98],"(",["T_CONSTANT_ENCAPSED_STRING","'The key \"%s\" must be a string.'",98],",",["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","options",98],"[",["T_CONSTANT_ENCAPSED_STRING","'password_path'",98],"]",")",")",";",["T_WHITESPACE","\n        ",98],"}",["T_WHITESPACE","\n\n        ",99],["T_TRY","try",101],["T_WHITESPACE"," ",101],"{",["T_WHITESPACE","\n            ",101],["T_VARIABLE","$token",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_NEW","new",102],["T_WHITESPACE"," ",102],["T_STRING","UsernamePasswordToken",102],"(",["T_VARIABLE","$username",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$password",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","providerKey",102],")",";",["T_WHITESPACE","\n\n            ",102],["T_VARIABLE","$authenticatedToken",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","authenticationManager",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","authenticate",104],"(",["T_VARIABLE","$token",104],")",";",["T_WHITESPACE","\n            ",104],["T_VARIABLE","$response",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","onSuccess",105],"(",["T_VARIABLE","$request",105],",",["T_WHITESPACE"," ",105],["T_VARIABLE","$authenticatedToken",105],")",";",["T_WHITESPACE","\n        ",105],"}",["T_WHITESPACE"," ",106],["T_CATCH","catch",106],["T_WHITESPACE"," ",106],"(",["T_STRING","AuthenticationException",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$e",106],")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n            ",106],["T_VARIABLE","$response",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","onFailure",107],"(",["T_VARIABLE","$request",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$e",107],")",";",["T_WHITESPACE","\n        ",107],"}",["T_WHITESPACE","\n\n        ",108],["T_VARIABLE","$event",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","setResponse",110],"(",["T_VARIABLE","$response",110],")",";",["T_WHITESPACE","\n    ",110],"}",["T_WHITESPACE","\n\n    ",111],["T_PRIVATE","private",113],["T_WHITESPACE"," ",113],["T_FUNCTION","function",113],["T_WHITESPACE"," ",113],["T_STRING","onSuccess",113],"(",["T_STRING","Request",113],["T_WHITESPACE"," ",113],["T_VARIABLE","$request",113],",",["T_WHITESPACE"," ",113],["T_STRING","TokenInterface",113],["T_WHITESPACE"," ",113],["T_VARIABLE","$token",113],")",["T_WHITESPACE","\n    ",113],"{",["T_WHITESPACE","\n        ",114],["T_IF","if",115],["T_WHITESPACE"," ",115],"(",["T_STRING","null",115],["T_WHITESPACE"," ",115],["T_IS_NOT_IDENTICAL","!==",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","logger",115],")",["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n            ",115],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","logger",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","info",116],"(",["T_CONSTANT_ENCAPSED_STRING","'User has been authenticated successfully.'",116],",",["T_WHITESPACE"," ",116],["T_ARRAY","array",116],"(",["T_CONSTANT_ENCAPSED_STRING","'username'",116],["T_WHITESPACE"," ",116],["T_DOUBLE_ARROW","=>",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$token",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getUsername",116],"(",")",")",")",";",["T_WHITESPACE","\n        ",116],"}",["T_WHITESPACE","\n\n        ",117],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","tokenStorage",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","setToken",119],"(",["T_VARIABLE","$token",119],")",";",["T_WHITESPACE","\n\n        ",119],["T_IF","if",121],["T_WHITESPACE"," ",121],"(",["T_STRING","null",121],["T_WHITESPACE"," ",121],["T_IS_NOT_IDENTICAL","!==",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","eventDispatcher",121],")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n            ",121],["T_VARIABLE","$loginEvent",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_NEW","new",122],["T_WHITESPACE"," ",122],["T_STRING","InteractiveLoginEvent",122],"(",["T_VARIABLE","$request",122],",",["T_WHITESPACE"," ",122],["T_VARIABLE","$token",122],")",";",["T_WHITESPACE","\n            ",122],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","eventDispatcher",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","dispatch",123],"(",["T_STRING","SecurityEvents",123],["T_DOUBLE_COLON","::",123],["T_STRING","INTERACTIVE_LOGIN",123],",",["T_WHITESPACE"," ",123],["T_VARIABLE","$loginEvent",123],")",";",["T_WHITESPACE","\n        ",123],"}",["T_WHITESPACE","\n\n        ",124],["T_VARIABLE","$response",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","successHandler",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","onAuthenticationSuccess",126],"(",["T_VARIABLE","$request",126],",",["T_WHITESPACE"," ",126],["T_VARIABLE","$token",126],")",";",["T_WHITESPACE","\n\n        ",126],["T_IF","if",128],["T_WHITESPACE"," ",128],"(","!",["T_VARIABLE","$response",128],["T_WHITESPACE"," ",128],["T_INSTANCEOF","instanceof",128],["T_WHITESPACE"," ",128],["T_STRING","Response",128],")",["T_WHITESPACE"," ",128],"{",["T_WHITESPACE","\n            ",128],["T_THROW","throw",129],["T_WHITESPACE"," ",129],["T_NEW","new",129],["T_WHITESPACE"," ",129],["T_NS_SEPARATOR","\\",129],["T_STRING","RuntimeException",129],"(",["T_CONSTANT_ENCAPSED_STRING","'Authentication Success Handler did not return a Response.'",129],")",";",["T_WHITESPACE","\n        ",129],"}",["T_WHITESPACE","\n\n        ",130],["T_RETURN","return",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$response",132],";",["T_WHITESPACE","\n    ",132],"}",["T_WHITESPACE","\n\n    ",133],["T_PRIVATE","private",135],["T_WHITESPACE"," ",135],["T_FUNCTION","function",135],["T_WHITESPACE"," ",135],["T_STRING","onFailure",135],"(",["T_STRING","Request",135],["T_WHITESPACE"," ",135],["T_VARIABLE","$request",135],",",["T_WHITESPACE"," ",135],["T_STRING","AuthenticationException",135],["T_WHITESPACE"," ",135],["T_VARIABLE","$failed",135],")",["T_WHITESPACE","\n    ",135],"{",["T_WHITESPACE","\n        ",136],["T_IF","if",137],["T_WHITESPACE"," ",137],"(",["T_STRING","null",137],["T_WHITESPACE"," ",137],["T_IS_NOT_IDENTICAL","!==",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","logger",137],")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n            ",137],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","logger",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","info",138],"(",["T_CONSTANT_ENCAPSED_STRING","'Authentication request failed.'",138],",",["T_WHITESPACE"," ",138],["T_ARRAY","array",138],"(",["T_CONSTANT_ENCAPSED_STRING","'exception'",138],["T_WHITESPACE"," ",138],["T_DOUBLE_ARROW","=>",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$failed",138],")",")",";",["T_WHITESPACE","\n        ",138],"}",["T_WHITESPACE","\n\n        ",139],["T_VARIABLE","$token",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","tokenStorage",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getToken",141],"(",")",";",["T_WHITESPACE","\n        ",141],["T_IF","if",142],["T_WHITESPACE"," ",142],"(",["T_VARIABLE","$token",142],["T_WHITESPACE"," ",142],["T_INSTANCEOF","instanceof",142],["T_WHITESPACE"," ",142],["T_STRING","UsernamePasswordToken",142],["T_WHITESPACE"," ",142],["T_BOOLEAN_AND","&&",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","providerKey",142],["T_WHITESPACE"," ",142],["T_IS_IDENTICAL","===",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$token",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","getProviderKey",142],"(",")",")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n            ",142],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","tokenStorage",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","setToken",143],"(",["T_STRING","null",143],")",";",["T_WHITESPACE","\n        ",143],"}",["T_WHITESPACE","\n\n        ",144],["T_VARIABLE","$response",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","failureHandler",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","onAuthenticationFailure",146],"(",["T_VARIABLE","$request",146],",",["T_WHITESPACE"," ",146],["T_VARIABLE","$failed",146],")",";",["T_WHITESPACE","\n\n        ",146],["T_IF","if",148],["T_WHITESPACE"," ",148],"(","!",["T_VARIABLE","$response",148],["T_WHITESPACE"," ",148],["T_INSTANCEOF","instanceof",148],["T_WHITESPACE"," ",148],["T_STRING","Response",148],")",["T_WHITESPACE"," ",148],"{",["T_WHITESPACE","\n            ",148],["T_THROW","throw",149],["T_WHITESPACE"," ",149],["T_NEW","new",149],["T_WHITESPACE"," ",149],["T_NS_SEPARATOR","\\",149],["T_STRING","RuntimeException",149],"(",["T_CONSTANT_ENCAPSED_STRING","'Authentication Failure Handler did not return a Response.'",149],")",";",["T_WHITESPACE","\n        ",149],"}",["T_WHITESPACE","\n\n        ",150],["T_RETURN","return",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$response",152],";",["T_WHITESPACE","\n    ",152],"}",["T_WHITESPACE","\n",153],"}",["T_WHITESPACE","\n",154]]