[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Security",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Http",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Tests",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Firewall",12],";",["T_WHITESPACE","\n\n",12],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Symfony",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Component",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Security",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Http",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Firewall",14],["T_NS_SEPARATOR","\\",14],["T_STRING","DigestData",14],";",["T_WHITESPACE","\n\n",14],["T_CLASS","class",16],["T_WHITESPACE"," ",16],["T_STRING","DigestDataTest",16],["T_WHITESPACE"," ",16],["T_EXTENDS","extends",16],["T_WHITESPACE"," ",16],["T_NS_SEPARATOR","\\",16],["T_STRING","PHPUnit_Framework_TestCase",16],["T_WHITESPACE","\n",16],"{",["T_WHITESPACE","\n    ",17],["T_PUBLIC","public",18],["T_WHITESPACE"," ",18],["T_FUNCTION","function",18],["T_WHITESPACE"," ",18],["T_STRING","testGetResponse",18],"(",")",["T_WHITESPACE","\n    ",18],"{",["T_WHITESPACE","\n        ",19],["T_VARIABLE","$digestAuth",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_NEW","new",20],["T_WHITESPACE"," ",20],["T_STRING","DigestData",20],"(",["T_WHITESPACE","\n            ",20],["T_CONSTANT_ENCAPSED_STRING","'username=\"user\", realm=\"Welcome, robot!\", '",21],".",["T_WHITESPACE","\n            ",21],["T_CONSTANT_ENCAPSED_STRING","'nonce=\"MTM0NzMyMTgyMy42NzkzOmRlZjM4NmIzOGNjMjE0OWJiNDU0MDAxNzJmYmM1MmZl\", '",22],".",["T_WHITESPACE","\n            ",22],["T_CONSTANT_ENCAPSED_STRING","'uri=\"\/path\/info?p1=5&p2=5\", cnonce=\"MDIwODkz\", nc=00000001, qop=\"auth\", '",23],".",["T_WHITESPACE","\n            ",23],["T_CONSTANT_ENCAPSED_STRING","'response=\"b52938fc9e6d7c01be7702ece9031b42\"'",24],["T_WHITESPACE","\n        ",24],")",";",["T_WHITESPACE","\n\n        ",25],["T_VARIABLE","$this",27],["T_OBJECT_OPERATOR","->",27],["T_STRING","assertEquals",27],"(",["T_CONSTANT_ENCAPSED_STRING","'b52938fc9e6d7c01be7702ece9031b42'",27],",",["T_WHITESPACE"," ",27],["T_VARIABLE","$digestAuth",27],["T_OBJECT_OPERATOR","->",27],["T_STRING","getResponse",27],"(",")",")",";",["T_WHITESPACE","\n    ",27],"}",["T_WHITESPACE","\n\n    ",28],["T_PUBLIC","public",30],["T_WHITESPACE"," ",30],["T_FUNCTION","function",30],["T_WHITESPACE"," ",30],["T_STRING","testGetUsername",30],"(",")",["T_WHITESPACE","\n    ",30],"{",["T_WHITESPACE","\n        ",31],["T_VARIABLE","$digestAuth",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_NEW","new",32],["T_WHITESPACE"," ",32],["T_STRING","DigestData",32],"(",["T_WHITESPACE","\n            ",32],["T_CONSTANT_ENCAPSED_STRING","'username=\"user\", realm=\"Welcome, robot!\", '",33],".",["T_WHITESPACE","\n            ",33],["T_CONSTANT_ENCAPSED_STRING","'nonce=\"MTM0NzMyMTgyMy42NzkzOmRlZjM4NmIzOGNjMjE0OWJiNDU0MDAxNzJmYmM1MmZl\", '",34],".",["T_WHITESPACE","\n            ",34],["T_CONSTANT_ENCAPSED_STRING","'uri=\"\/path\/info?p1=5&p2=5\", cnonce=\"MDIwODkz\", nc=00000001, qop=\"auth\", '",35],".",["T_WHITESPACE","\n            ",35],["T_CONSTANT_ENCAPSED_STRING","'response=\"b52938fc9e6d7c01be7702ece9031b42\"'",36],["T_WHITESPACE","\n        ",36],")",";",["T_WHITESPACE","\n\n        ",37],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","assertEquals",39],"(",["T_CONSTANT_ENCAPSED_STRING","'user'",39],",",["T_WHITESPACE"," ",39],["T_VARIABLE","$digestAuth",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","getUsername",39],"(",")",")",";",["T_WHITESPACE","\n    ",39],"}",["T_WHITESPACE","\n\n    ",40],["T_PUBLIC","public",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","testGetUsernameWithQuote",42],"(",")",["T_WHITESPACE","\n    ",42],"{",["T_WHITESPACE","\n        ",43],["T_VARIABLE","$digestAuth",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_NEW","new",44],["T_WHITESPACE"," ",44],["T_STRING","DigestData",44],"(",["T_WHITESPACE","\n            ",44],["T_CONSTANT_ENCAPSED_STRING","'username=\"\\\"user\\\"\", realm=\"Welcome, robot!\", '",45],".",["T_WHITESPACE","\n            ",45],["T_CONSTANT_ENCAPSED_STRING","'nonce=\"MTM0NzMyMTgyMy42NzkzOmRlZjM4NmIzOGNjMjE0OWJiNDU0MDAxNzJmYmM1MmZl\", '",46],".",["T_WHITESPACE","\n            ",46],["T_CONSTANT_ENCAPSED_STRING","'uri=\"\/path\/info?p1=5&p2=5\", cnonce=\"MDIwODkz\", nc=00000001, qop=\"auth\", '",47],".",["T_WHITESPACE","\n            ",47],["T_CONSTANT_ENCAPSED_STRING","'response=\"b52938fc9e6d7c01be7702ece9031b42\"'",48],["T_WHITESPACE","\n        ",48],")",";",["T_WHITESPACE","\n\n        ",49],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","assertEquals",51],"(",["T_CONSTANT_ENCAPSED_STRING","'\"user\"'",51],",",["T_WHITESPACE"," ",51],["T_VARIABLE","$digestAuth",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","getUsername",51],"(",")",")",";",["T_WHITESPACE","\n    ",51],"}",["T_WHITESPACE","\n\n    ",52],["T_PUBLIC","public",54],["T_WHITESPACE"," ",54],["T_FUNCTION","function",54],["T_WHITESPACE"," ",54],["T_STRING","testGetUsernameWithQuoteAndEscape",54],"(",")",["T_WHITESPACE","\n    ",54],"{",["T_WHITESPACE","\n        ",55],["T_VARIABLE","$digestAuth",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_NEW","new",56],["T_WHITESPACE"," ",56],["T_STRING","DigestData",56],"(",["T_WHITESPACE","\n            ",56],["T_CONSTANT_ENCAPSED_STRING","'username=\"\\\"u\\\\\\\\\\\"ser\\\"\", realm=\"Welcome, robot!\", '",57],".",["T_WHITESPACE","\n            ",57],["T_CONSTANT_ENCAPSED_STRING","'nonce=\"MTM0NzMyMTgyMy42NzkzOmRlZjM4NmIzOGNjMjE0OWJiNDU0MDAxNzJmYmM1MmZl\", '",58],".",["T_WHITESPACE","\n            ",58],["T_CONSTANT_ENCAPSED_STRING","'uri=\"\/path\/info?p1=5&p2=5\", cnonce=\"MDIwODkz\", nc=00000001, qop=\"auth\", '",59],".",["T_WHITESPACE","\n            ",59],["T_CONSTANT_ENCAPSED_STRING","'response=\"b52938fc9e6d7c01be7702ece9031b42\"'",60],["T_WHITESPACE","\n        ",60],")",";",["T_WHITESPACE","\n\n        ",61],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","assertEquals",63],"(",["T_CONSTANT_ENCAPSED_STRING","'\"u\\\\\"ser\"'",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$digestAuth",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","getUsername",63],"(",")",")",";",["T_WHITESPACE","\n    ",63],"}",["T_WHITESPACE","\n\n    ",64],["T_PUBLIC","public",66],["T_WHITESPACE"," ",66],["T_FUNCTION","function",66],["T_WHITESPACE"," ",66],["T_STRING","testGetUsernameWithSingleQuote",66],"(",")",["T_WHITESPACE","\n    ",66],"{",["T_WHITESPACE","\n        ",67],["T_VARIABLE","$digestAuth",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_NEW","new",68],["T_WHITESPACE"," ",68],["T_STRING","DigestData",68],"(",["T_WHITESPACE","\n            ",68],["T_CONSTANT_ENCAPSED_STRING","'username=\"\\\"u\\'ser\\\"\", realm=\"Welcome, robot!\", '",69],".",["T_WHITESPACE","\n            ",69],["T_CONSTANT_ENCAPSED_STRING","'nonce=\"MTM0NzMyMTgyMy42NzkzOmRlZjM4NmIzOGNjMjE0OWJiNDU0MDAxNzJmYmM1MmZl\", '",70],".",["T_WHITESPACE","\n            ",70],["T_CONSTANT_ENCAPSED_STRING","'uri=\"\/path\/info?p1=5&p2=5\", cnonce=\"MDIwODkz\", nc=00000001, qop=\"auth\", '",71],".",["T_WHITESPACE","\n            ",71],["T_CONSTANT_ENCAPSED_STRING","'response=\"b52938fc9e6d7c01be7702ece9031b42\"'",72],["T_WHITESPACE","\n        ",72],")",";",["T_WHITESPACE","\n\n        ",73],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","assertEquals",75],"(",["T_CONSTANT_ENCAPSED_STRING","'\"u\\'ser\"'",75],",",["T_WHITESPACE"," ",75],["T_VARIABLE","$digestAuth",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getUsername",75],"(",")",")",";",["T_WHITESPACE","\n    ",75],"}",["T_WHITESPACE","\n\n    ",76],["T_PUBLIC","public",78],["T_WHITESPACE"," ",78],["T_FUNCTION","function",78],["T_WHITESPACE"," ",78],["T_STRING","testGetUsernameWithSingleQuoteAndEscape",78],"(",")",["T_WHITESPACE","\n    ",78],"{",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$digestAuth",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_NEW","new",80],["T_WHITESPACE"," ",80],["T_STRING","DigestData",80],"(",["T_WHITESPACE","\n            ",80],["T_CONSTANT_ENCAPSED_STRING","'username=\"\\\"u\\\\\\'ser\\\"\", realm=\"Welcome, robot!\", '",81],".",["T_WHITESPACE","\n            ",81],["T_CONSTANT_ENCAPSED_STRING","'nonce=\"MTM0NzMyMTgyMy42NzkzOmRlZjM4NmIzOGNjMjE0OWJiNDU0MDAxNzJmYmM1MmZl\", '",82],".",["T_WHITESPACE","\n            ",82],["T_CONSTANT_ENCAPSED_STRING","'uri=\"\/path\/info?p1=5&p2=5\", cnonce=\"MDIwODkz\", nc=00000001, qop=\"auth\", '",83],".",["T_WHITESPACE","\n            ",83],["T_CONSTANT_ENCAPSED_STRING","'response=\"b52938fc9e6d7c01be7702ece9031b42\"'",84],["T_WHITESPACE","\n        ",84],")",";",["T_WHITESPACE","\n\n        ",85],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","assertEquals",87],"(",["T_CONSTANT_ENCAPSED_STRING","'\"u\\\\\\'ser\"'",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$digestAuth",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getUsername",87],"(",")",")",";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n\n    ",88],["T_PUBLIC","public",90],["T_WHITESPACE"," ",90],["T_FUNCTION","function",90],["T_WHITESPACE"," ",90],["T_STRING","testGetUsernameWithEscape",90],"(",")",["T_WHITESPACE","\n    ",90],"{",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$digestAuth",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_NEW","new",92],["T_WHITESPACE"," ",92],["T_STRING","DigestData",92],"(",["T_WHITESPACE","\n            ",92],["T_CONSTANT_ENCAPSED_STRING","'username=\"\\\"u\\\\ser\\\"\", realm=\"Welcome, robot!\", '",93],".",["T_WHITESPACE","\n            ",93],["T_CONSTANT_ENCAPSED_STRING","'nonce=\"MTM0NzMyMTgyMy42NzkzOmRlZjM4NmIzOGNjMjE0OWJiNDU0MDAxNzJmYmM1MmZl\", '",94],".",["T_WHITESPACE","\n            ",94],["T_CONSTANT_ENCAPSED_STRING","'uri=\"\/path\/info?p1=5&p2=5\", cnonce=\"MDIwODkz\", nc=00000001, qop=\"auth\", '",95],".",["T_WHITESPACE","\n            ",95],["T_CONSTANT_ENCAPSED_STRING","'response=\"b52938fc9e6d7c01be7702ece9031b42\"'",96],["T_WHITESPACE","\n        ",96],")",";",["T_WHITESPACE","\n\n        ",97],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","assertEquals",99],"(",["T_CONSTANT_ENCAPSED_STRING","'\"u\\\\ser\"'",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$digestAuth",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","getUsername",99],"(",")",")",";",["T_WHITESPACE","\n    ",99],"}",["T_WHITESPACE","\n\n    ",100],["T_PUBLIC","public",102],["T_WHITESPACE"," ",102],["T_FUNCTION","function",102],["T_WHITESPACE"," ",102],["T_STRING","testValidateAndDecode",102],"(",")",["T_WHITESPACE","\n    ",102],"{",["T_WHITESPACE","\n        ",103],["T_VARIABLE","$time",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_STRING","microtime",104],"(",["T_STRING","true",104],")",";",["T_WHITESPACE","\n        ",104],["T_VARIABLE","$key",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'ThisIsAKey'",105],";",["T_WHITESPACE","\n        ",105],["T_VARIABLE","$nonce",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_STRING","base64_encode",106],"(",["T_VARIABLE","$time",106],".",["T_CONSTANT_ENCAPSED_STRING","':'",106],".",["T_STRING","md5",106],"(",["T_VARIABLE","$time",106],".",["T_CONSTANT_ENCAPSED_STRING","':'",106],".",["T_VARIABLE","$key",106],")",")",";",["T_WHITESPACE","\n\n        ",106],["T_VARIABLE","$digestAuth",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_NEW","new",108],["T_WHITESPACE"," ",108],["T_STRING","DigestData",108],"(",["T_WHITESPACE","\n            ",108],["T_CONSTANT_ENCAPSED_STRING","'username=\"user\", realm=\"Welcome, robot!\", nonce=\"'",109],".",["T_VARIABLE","$nonce",109],".",["T_CONSTANT_ENCAPSED_STRING","'\", '",109],".",["T_WHITESPACE","\n            ",109],["T_CONSTANT_ENCAPSED_STRING","'uri=\"\/path\/info?p1=5&p2=5\", cnonce=\"MDIwODkz\", nc=00000001, qop=\"auth\", '",110],".",["T_WHITESPACE","\n            ",110],["T_CONSTANT_ENCAPSED_STRING","'response=\"b52938fc9e6d7c01be7702ece9031b42\"'",111],["T_WHITESPACE","\n        ",111],")",";",["T_WHITESPACE","\n\n        ",112],["T_TRY","try",114],["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n            ",114],["T_VARIABLE","$digestAuth",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","validateAndDecode",115],"(",["T_VARIABLE","$key",115],",",["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'Welcome, robot!'",115],")",";",["T_WHITESPACE","\n        ",115],"}",["T_WHITESPACE"," ",116],["T_CATCH","catch",116],["T_WHITESPACE"," ",116],"(",["T_NS_SEPARATOR","\\",116],["T_STRING","Exception",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$e",116],")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n            ",116],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","fail",117],"(",["T_STRING","sprintf",117],"(",["T_CONSTANT_ENCAPSED_STRING","'testValidateAndDecode fail with message: %s'",117],",",["T_WHITESPACE"," ",117],["T_VARIABLE","$e",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getMessage",117],"(",")",")",")",";",["T_WHITESPACE","\n        ",117],"}",["T_WHITESPACE","\n    ",118],"}",["T_WHITESPACE","\n\n    ",119],["T_PUBLIC","public",121],["T_WHITESPACE"," ",121],["T_FUNCTION","function",121],["T_WHITESPACE"," ",121],["T_STRING","testCalculateServerDigest",121],"(",")",["T_WHITESPACE","\n    ",121],"{",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","calculateServerDigest",123],"(",["T_CONSTANT_ENCAPSED_STRING","'user'",123],",",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'Welcome, robot!'",123],",",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'pass,word=password'",123],",",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'ThisIsAKey'",123],",",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'00000001'",123],",",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'MDIwODkz'",123],",",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'auth'",123],",",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'GET'",123],",",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'\/path\/info?p1=5&p2=5'",123],")",";",["T_WHITESPACE","\n    ",123],"}",["T_WHITESPACE","\n\n    ",124],["T_PUBLIC","public",126],["T_WHITESPACE"," ",126],["T_FUNCTION","function",126],["T_WHITESPACE"," ",126],["T_STRING","testCalculateServerDigestWithQuote",126],"(",")",["T_WHITESPACE","\n    ",126],"{",["T_WHITESPACE","\n        ",127],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","calculateServerDigest",128],"(",["T_CONSTANT_ENCAPSED_STRING","'\\\"user\\\"'",128],",",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'Welcome, \\\"robot\\\"!'",128],",",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'pass,word=password'",128],",",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'ThisIsAKey'",128],",",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'00000001'",128],",",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'MDIwODkz'",128],",",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'auth'",128],",",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'GET'",128],",",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'\/path\/info?p1=5&p2=5'",128],")",";",["T_WHITESPACE","\n    ",128],"}",["T_WHITESPACE","\n\n    ",129],["T_PUBLIC","public",131],["T_WHITESPACE"," ",131],["T_FUNCTION","function",131],["T_WHITESPACE"," ",131],["T_STRING","testCalculateServerDigestWithQuoteAndEscape",131],"(",")",["T_WHITESPACE","\n    ",131],"{",["T_WHITESPACE","\n        ",132],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","calculateServerDigest",133],"(",["T_CONSTANT_ENCAPSED_STRING","'\\\"u\\\\\\\\\\\"ser\\\"'",133],",",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'Welcome, \\\"robot\\\"!'",133],",",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'pass,word=password'",133],",",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'ThisIsAKey'",133],",",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'00000001'",133],",",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'MDIwODkz'",133],",",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'auth'",133],",",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'GET'",133],",",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'\/path\/info?p1=5&p2=5'",133],")",";",["T_WHITESPACE","\n    ",133],"}",["T_WHITESPACE","\n\n    ",134],["T_PUBLIC","public",136],["T_WHITESPACE"," ",136],["T_FUNCTION","function",136],["T_WHITESPACE"," ",136],["T_STRING","testCalculateServerDigestEscape",136],"(",")",["T_WHITESPACE","\n    ",136],"{",["T_WHITESPACE","\n        ",137],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","calculateServerDigest",138],"(",["T_CONSTANT_ENCAPSED_STRING","'\\\"u\\\\ser\\\"'",138],",",["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","'Welcome, \\\"robot\\\"!'",138],",",["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","'pass,word=password'",138],",",["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","'ThisIsAKey'",138],",",["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","'00000001'",138],",",["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","'MDIwODkz'",138],",",["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","'auth'",138],",",["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","'GET'",138],",",["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","'\/path\/info?p1=5&p2=5'",138],")",";",["T_WHITESPACE","\n        ",138],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","calculateServerDigest",139],"(",["T_CONSTANT_ENCAPSED_STRING","'\\\"u\\\\ser\\\\\\\\\\\"'",139],",",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'Welcome, \\\"robot\\\"!'",139],",",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'pass,word=password'",139],",",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'ThisIsAKey'",139],",",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'00000001'",139],",",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'MDIwODkz'",139],",",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'auth'",139],",",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'GET'",139],",",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'\/path\/info?p1=5&p2=5'",139],")",";",["T_WHITESPACE","\n    ",139],"}",["T_WHITESPACE","\n\n    ",140],["T_PUBLIC","public",142],["T_WHITESPACE"," ",142],["T_FUNCTION","function",142],["T_WHITESPACE"," ",142],["T_STRING","testIsNonceExpired",142],"(",")",["T_WHITESPACE","\n    ",142],"{",["T_WHITESPACE","\n        ",143],["T_VARIABLE","$time",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_STRING","microtime",144],"(",["T_STRING","true",144],")",["T_WHITESPACE"," ",144],"+",["T_WHITESPACE"," ",144],["T_LNUMBER","10",144],";",["T_WHITESPACE","\n        ",144],["T_VARIABLE","$key",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","'ThisIsAKey'",145],";",["T_WHITESPACE","\n        ",145],["T_VARIABLE","$nonce",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_STRING","base64_encode",146],"(",["T_VARIABLE","$time",146],".",["T_CONSTANT_ENCAPSED_STRING","':'",146],".",["T_STRING","md5",146],"(",["T_VARIABLE","$time",146],".",["T_CONSTANT_ENCAPSED_STRING","':'",146],".",["T_VARIABLE","$key",146],")",")",";",["T_WHITESPACE","\n\n        ",146],["T_VARIABLE","$digestAuth",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_NEW","new",148],["T_WHITESPACE"," ",148],["T_STRING","DigestData",148],"(",["T_WHITESPACE","\n            ",148],["T_CONSTANT_ENCAPSED_STRING","'username=\"user\", realm=\"Welcome, robot!\", nonce=\"'",149],".",["T_VARIABLE","$nonce",149],".",["T_CONSTANT_ENCAPSED_STRING","'\", '",149],".",["T_WHITESPACE","\n            ",149],["T_CONSTANT_ENCAPSED_STRING","'uri=\"\/path\/info?p1=5&p2=5\", cnonce=\"MDIwODkz\", nc=00000001, qop=\"auth\", '",150],".",["T_WHITESPACE","\n            ",150],["T_CONSTANT_ENCAPSED_STRING","'response=\"b52938fc9e6d7c01be7702ece9031b42\"'",151],["T_WHITESPACE","\n        ",151],")",";",["T_WHITESPACE","\n\n        ",152],["T_VARIABLE","$digestAuth",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","validateAndDecode",154],"(",["T_VARIABLE","$key",154],",",["T_WHITESPACE"," ",154],["T_CONSTANT_ENCAPSED_STRING","'Welcome, robot!'",154],")",";",["T_WHITESPACE","\n\n        ",154],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","assertFalse",156],"(",["T_VARIABLE","$digestAuth",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","isNonceExpired",156],"(",")",")",";",["T_WHITESPACE","\n    ",156],"}",["T_WHITESPACE","\n\n    ",157],["T_PROTECTED","protected",159],["T_WHITESPACE"," ",159],["T_FUNCTION","function",159],["T_WHITESPACE"," ",159],["T_STRING","setUp",159],"(",")",["T_WHITESPACE","\n    ",159],"{",["T_WHITESPACE","\n        ",160],["T_STRING","class_exists",161],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Http\\Firewall\\DigestAuthenticationListener'",161],",",["T_WHITESPACE"," ",161],["T_STRING","true",161],")",";",["T_WHITESPACE","\n    ",161],"}",["T_WHITESPACE","\n\n    ",162],["T_PRIVATE","private",164],["T_WHITESPACE"," ",164],["T_FUNCTION","function",164],["T_WHITESPACE"," ",164],["T_STRING","calculateServerDigest",164],"(",["T_VARIABLE","$username",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$realm",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$password",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$key",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$nc",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$cnonce",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$qop",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$method",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$uri",164],")",["T_WHITESPACE","\n    ",164],"{",["T_WHITESPACE","\n        ",165],["T_VARIABLE","$time",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_STRING","microtime",166],"(",["T_STRING","true",166],")",";",["T_WHITESPACE","\n        ",166],["T_VARIABLE","$nonce",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_STRING","base64_encode",167],"(",["T_VARIABLE","$time",167],".",["T_CONSTANT_ENCAPSED_STRING","':'",167],".",["T_STRING","md5",167],"(",["T_VARIABLE","$time",167],".",["T_CONSTANT_ENCAPSED_STRING","':'",167],".",["T_VARIABLE","$key",167],")",")",";",["T_WHITESPACE","\n\n        ",167],["T_VARIABLE","$response",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_STRING","md5",169],"(",["T_WHITESPACE","\n            ",169],["T_STRING","md5",170],"(",["T_VARIABLE","$username",170],".",["T_CONSTANT_ENCAPSED_STRING","':'",170],".",["T_VARIABLE","$realm",170],".",["T_CONSTANT_ENCAPSED_STRING","':'",170],".",["T_VARIABLE","$password",170],")",".",["T_CONSTANT_ENCAPSED_STRING","':'",170],".",["T_VARIABLE","$nonce",170],".",["T_CONSTANT_ENCAPSED_STRING","':'",170],".",["T_VARIABLE","$nc",170],".",["T_CONSTANT_ENCAPSED_STRING","':'",170],".",["T_VARIABLE","$cnonce",170],".",["T_CONSTANT_ENCAPSED_STRING","':'",170],".",["T_VARIABLE","$qop",170],".",["T_CONSTANT_ENCAPSED_STRING","':'",170],".",["T_STRING","md5",170],"(",["T_VARIABLE","$method",170],".",["T_CONSTANT_ENCAPSED_STRING","':'",170],".",["T_VARIABLE","$uri",170],")",["T_WHITESPACE","\n        ",170],")",";",["T_WHITESPACE","\n\n        ",171],["T_VARIABLE","$digest",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_STRING","sprintf",173],"(",["T_CONSTANT_ENCAPSED_STRING","'username=\"%s\", realm=\"%s\", nonce=\"%s\", uri=\"%s\", cnonce=\"%s\", nc=%s, qop=\"%s\", response=\"%s\"'",173],",",["T_WHITESPACE","\n            ",173],["T_VARIABLE","$username",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$realm",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$nonce",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$uri",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$cnonce",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$nc",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$qop",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$response",174],["T_WHITESPACE","\n        ",174],")",";",["T_WHITESPACE","\n\n        ",175],["T_VARIABLE","$digestAuth",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_NEW","new",177],["T_WHITESPACE"," ",177],["T_STRING","DigestData",177],"(",["T_VARIABLE","$digest",177],")",";",["T_WHITESPACE","\n\n        ",177],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","assertEquals",179],"(",["T_VARIABLE","$digestAuth",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","getResponse",179],"(",")",",",["T_WHITESPACE"," ",179],["T_VARIABLE","$digestAuth",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","calculateServerDigest",179],"(",["T_VARIABLE","$password",179],",",["T_WHITESPACE"," ",179],["T_VARIABLE","$method",179],")",")",";",["T_WHITESPACE","\n    ",179],"}",["T_WHITESPACE","\n",180],"}",["T_WHITESPACE","\n",181]]