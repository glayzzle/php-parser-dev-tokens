[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","Symfony",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Component",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Security",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Http",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Tests",3],["T_NS_SEPARATOR","\\",3],["T_STRING","Firewall",3],";",["T_WHITESPACE","\n\n",3],["T_USE","use",5],["T_WHITESPACE"," ",5],["T_STRING","Symfony",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Component",5],["T_NS_SEPARATOR","\\",5],["T_STRING","HttpFoundation",5],["T_NS_SEPARATOR","\\",5],["T_STRING","Request",5],";",["T_WHITESPACE","\n",5],["T_USE","use",6],["T_WHITESPACE"," ",6],["T_STRING","Symfony",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Component",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Security",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Core",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Authentication",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Token",6],["T_NS_SEPARATOR","\\",6],["T_STRING","UsernamePasswordToken",6],";",["T_WHITESPACE","\n",6],["T_USE","use",7],["T_WHITESPACE"," ",7],["T_STRING","Symfony",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Component",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Security",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Http",7],["T_NS_SEPARATOR","\\",7],["T_STRING","EntryPoint",7],["T_NS_SEPARATOR","\\",7],["T_STRING","DigestAuthenticationEntryPoint",7],";",["T_WHITESPACE","\n",7],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Symfony",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Component",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Security",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Http",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Firewall",8],["T_NS_SEPARATOR","\\",8],["T_STRING","DigestAuthenticationListener",8],";",["T_WHITESPACE","\n\n",8],["T_CLASS","class",10],["T_WHITESPACE"," ",10],["T_STRING","DigestAuthenticationListenerTest",10],["T_WHITESPACE"," ",10],["T_EXTENDS","extends",10],["T_WHITESPACE"," ",10],["T_NS_SEPARATOR","\\",10],["T_STRING","PHPUnit_Framework_TestCase",10],["T_WHITESPACE","\n",10],"{",["T_WHITESPACE","\n    ",11],["T_PUBLIC","public",12],["T_WHITESPACE"," ",12],["T_FUNCTION","function",12],["T_WHITESPACE"," ",12],["T_STRING","testHandleWithValidDigest",12],"(",")",["T_WHITESPACE","\n    ",12],"{",["T_WHITESPACE","\n        ",13],["T_VARIABLE","$time",14],["T_WHITESPACE"," ",14],"=",["T_WHITESPACE"," ",14],["T_STRING","microtime",14],"(",["T_STRING","true",14],")",["T_WHITESPACE"," ",14],"+",["T_WHITESPACE"," ",14],["T_LNUMBER","1000",14],";",["T_WHITESPACE","\n        ",14],["T_VARIABLE","$secret",15],["T_WHITESPACE"," ",15],"=",["T_WHITESPACE"," ",15],["T_CONSTANT_ENCAPSED_STRING","'ThisIsASecret'",15],";",["T_WHITESPACE","\n        ",15],["T_VARIABLE","$nonce",16],["T_WHITESPACE"," ",16],"=",["T_WHITESPACE"," ",16],["T_STRING","base64_encode",16],"(",["T_VARIABLE","$time",16],".",["T_CONSTANT_ENCAPSED_STRING","':'",16],".",["T_STRING","md5",16],"(",["T_VARIABLE","$time",16],".",["T_CONSTANT_ENCAPSED_STRING","':'",16],".",["T_VARIABLE","$secret",16],")",")",";",["T_WHITESPACE","\n        ",16],["T_VARIABLE","$username",17],["T_WHITESPACE"," ",17],"=",["T_WHITESPACE"," ",17],["T_CONSTANT_ENCAPSED_STRING","'user'",17],";",["T_WHITESPACE","\n        ",17],["T_VARIABLE","$password",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],["T_CONSTANT_ENCAPSED_STRING","'password'",18],";",["T_WHITESPACE","\n        ",18],["T_VARIABLE","$realm",19],["T_WHITESPACE"," ",19],"=",["T_WHITESPACE"," ",19],["T_CONSTANT_ENCAPSED_STRING","'Welcome, robot!'",19],";",["T_WHITESPACE","\n        ",19],["T_VARIABLE","$cnonce",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_CONSTANT_ENCAPSED_STRING","'MDIwODkz'",20],";",["T_WHITESPACE","\n        ",20],["T_VARIABLE","$nc",21],["T_WHITESPACE"," ",21],"=",["T_WHITESPACE"," ",21],["T_CONSTANT_ENCAPSED_STRING","'00000001'",21],";",["T_WHITESPACE","\n        ",21],["T_VARIABLE","$qop",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'auth'",22],";",["T_WHITESPACE","\n        ",22],["T_VARIABLE","$uri",23],["T_WHITESPACE"," ",23],"=",["T_WHITESPACE"," ",23],["T_CONSTANT_ENCAPSED_STRING","'\/path\/info?p1=5&p2=5'",23],";",["T_WHITESPACE","\n\n        ",23],["T_VARIABLE","$serverDigest",25],["T_WHITESPACE"," ",25],"=",["T_WHITESPACE"," ",25],["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","calculateServerDigest",25],"(",["T_VARIABLE","$username",25],",",["T_WHITESPACE"," ",25],["T_VARIABLE","$realm",25],",",["T_WHITESPACE"," ",25],["T_VARIABLE","$password",25],",",["T_WHITESPACE"," ",25],["T_VARIABLE","$nc",25],",",["T_WHITESPACE"," ",25],["T_VARIABLE","$nonce",25],",",["T_WHITESPACE"," ",25],["T_VARIABLE","$cnonce",25],",",["T_WHITESPACE"," ",25],["T_VARIABLE","$qop",25],",",["T_WHITESPACE"," ",25],["T_CONSTANT_ENCAPSED_STRING","'GET'",25],",",["T_WHITESPACE"," ",25],["T_VARIABLE","$uri",25],")",";",["T_WHITESPACE","\n\n        ",25],["T_VARIABLE","$digestData",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE","\n            ",27],["T_CONSTANT_ENCAPSED_STRING","'username=\"'",28],".",["T_VARIABLE","$username",28],".",["T_CONSTANT_ENCAPSED_STRING","'\", realm=\"'",28],".",["T_VARIABLE","$realm",28],".",["T_CONSTANT_ENCAPSED_STRING","'\", nonce=\"'",28],".",["T_VARIABLE","$nonce",28],".",["T_CONSTANT_ENCAPSED_STRING","'\", '",28],".",["T_WHITESPACE","\n            ",28],["T_CONSTANT_ENCAPSED_STRING","'uri=\"'",29],".",["T_VARIABLE","$uri",29],".",["T_CONSTANT_ENCAPSED_STRING","'\", cnonce=\"'",29],".",["T_VARIABLE","$cnonce",29],".",["T_CONSTANT_ENCAPSED_STRING","'\", nc='",29],".",["T_VARIABLE","$nc",29],".",["T_CONSTANT_ENCAPSED_STRING","', qop=\"'",29],".",["T_VARIABLE","$qop",29],".",["T_CONSTANT_ENCAPSED_STRING","'\", '",29],".",["T_WHITESPACE","\n            ",29],["T_CONSTANT_ENCAPSED_STRING","'response=\"'",30],".",["T_VARIABLE","$serverDigest",30],".",["T_CONSTANT_ENCAPSED_STRING","'\"'",30],["T_WHITESPACE","\n        ",30],";",["T_WHITESPACE","\n\n        ",31],["T_VARIABLE","$request",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_NEW","new",33],["T_WHITESPACE"," ",33],["T_STRING","Request",33],"(",["T_ARRAY","array",33],"(",")",",",["T_WHITESPACE"," ",33],["T_ARRAY","array",33],"(",")",",",["T_WHITESPACE"," ",33],["T_ARRAY","array",33],"(",")",",",["T_WHITESPACE"," ",33],["T_ARRAY","array",33],"(",")",",",["T_WHITESPACE"," ",33],["T_ARRAY","array",33],"(",")",",",["T_WHITESPACE"," ",33],["T_ARRAY","array",33],"(",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_DIGEST'",33],["T_WHITESPACE"," ",33],["T_DOUBLE_ARROW","=>",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$digestData",33],")",")",";",["T_WHITESPACE","\n\n        ",33],["T_VARIABLE","$entryPoint",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_NEW","new",35],["T_WHITESPACE"," ",35],["T_STRING","DigestAuthenticationEntryPoint",35],"(",["T_VARIABLE","$realm",35],",",["T_WHITESPACE"," ",35],["T_VARIABLE","$secret",35],")",";",["T_WHITESPACE","\n\n        ",35],["T_VARIABLE","$user",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","getMockBuilder",37],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Core\\User\\UserInterface'",37],")",["T_OBJECT_OPERATOR","->",37],["T_STRING","getMock",37],"(",")",";",["T_WHITESPACE","\n        ",37],["T_VARIABLE","$user",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","method",38],"(",["T_CONSTANT_ENCAPSED_STRING","'getPassword'",38],")",["T_OBJECT_OPERATOR","->",38],["T_STRING","willReturn",38],"(",["T_VARIABLE","$password",38],")",";",["T_WHITESPACE","\n\n        ",38],["T_VARIABLE","$providerKey",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'TheProviderKey'",40],";",["T_WHITESPACE","\n\n        ",40],["T_VARIABLE","$tokenStorage",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","getMockBuilder",42],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Core\\Authentication\\Token\\Storage\\TokenStorageInterface'",42],")",["T_OBJECT_OPERATOR","->",42],["T_STRING","getMock",42],"(",")",";",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$tokenStorage",43],["T_WHITESPACE","\n            ",43],["T_OBJECT_OPERATOR","->",44],["T_STRING","expects",44],"(",["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","once",44],"(",")",")",["T_WHITESPACE","\n            ",44],["T_OBJECT_OPERATOR","->",45],["T_STRING","method",45],"(",["T_CONSTANT_ENCAPSED_STRING","'getToken'",45],")",["T_WHITESPACE","\n            ",45],["T_OBJECT_OPERATOR","->",46],["T_STRING","will",46],"(",["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","returnValue",46],"(",["T_STRING","null",46],")",")",["T_WHITESPACE","\n        ",46],";",["T_WHITESPACE","\n        ",47],["T_VARIABLE","$tokenStorage",48],["T_WHITESPACE","\n            ",48],["T_OBJECT_OPERATOR","->",49],["T_STRING","expects",49],"(",["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","once",49],"(",")",")",["T_WHITESPACE","\n            ",49],["T_OBJECT_OPERATOR","->",50],["T_STRING","method",50],"(",["T_CONSTANT_ENCAPSED_STRING","'setToken'",50],")",["T_WHITESPACE","\n            ",50],["T_OBJECT_OPERATOR","->",51],["T_STRING","with",51],"(",["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","equalTo",51],"(",["T_NEW","new",51],["T_WHITESPACE"," ",51],["T_STRING","UsernamePasswordToken",51],"(",["T_VARIABLE","$user",51],",",["T_WHITESPACE"," ",51],["T_VARIABLE","$password",51],",",["T_WHITESPACE"," ",51],["T_VARIABLE","$providerKey",51],")",")",")",["T_WHITESPACE","\n        ",51],";",["T_WHITESPACE","\n\n        ",52],["T_VARIABLE","$userProvider",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","getMockBuilder",54],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Core\\User\\UserProviderInterface'",54],")",["T_OBJECT_OPERATOR","->",54],["T_STRING","getMock",54],"(",")",";",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$userProvider",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","method",55],"(",["T_CONSTANT_ENCAPSED_STRING","'loadUserByUsername'",55],")",["T_OBJECT_OPERATOR","->",55],["T_STRING","willReturn",55],"(",["T_VARIABLE","$user",55],")",";",["T_WHITESPACE","\n\n        ",55],["T_VARIABLE","$listener",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_NEW","new",57],["T_WHITESPACE"," ",57],["T_STRING","DigestAuthenticationListener",57],"(",["T_VARIABLE","$tokenStorage",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$userProvider",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$providerKey",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$entryPoint",57],")",";",["T_WHITESPACE","\n\n        ",57],["T_VARIABLE","$event",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","getMockBuilder",59],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\HttpKernel\\Event\\GetResponseEvent'",59],")",["T_OBJECT_OPERATOR","->",59],["T_STRING","disableOriginalConstructor",59],"(",")",["T_OBJECT_OPERATOR","->",59],["T_STRING","getMock",59],"(",")",";",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$event",60],["T_WHITESPACE","\n            ",60],["T_OBJECT_OPERATOR","->",61],["T_STRING","expects",61],"(",["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","any",61],"(",")",")",["T_WHITESPACE","\n            ",61],["T_OBJECT_OPERATOR","->",62],["T_STRING","method",62],"(",["T_CONSTANT_ENCAPSED_STRING","'getRequest'",62],")",["T_WHITESPACE","\n            ",62],["T_OBJECT_OPERATOR","->",63],["T_STRING","will",63],"(",["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","returnValue",63],"(",["T_VARIABLE","$request",63],")",")",["T_WHITESPACE","\n        ",63],";",["T_WHITESPACE","\n\n        ",64],["T_VARIABLE","$listener",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","handle",66],"(",["T_VARIABLE","$event",66],")",";",["T_WHITESPACE","\n    ",66],"}",["T_WHITESPACE","\n\n    ",67],["T_PRIVATE","private",69],["T_WHITESPACE"," ",69],["T_FUNCTION","function",69],["T_WHITESPACE"," ",69],["T_STRING","calculateServerDigest",69],"(",["T_VARIABLE","$username",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$realm",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$password",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$nc",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$nonce",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$cnonce",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$qop",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$method",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$uri",69],")",["T_WHITESPACE","\n    ",69],"{",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$response",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_STRING","md5",71],"(",["T_WHITESPACE","\n            ",71],["T_STRING","md5",72],"(",["T_VARIABLE","$username",72],".",["T_CONSTANT_ENCAPSED_STRING","':'",72],".",["T_VARIABLE","$realm",72],".",["T_CONSTANT_ENCAPSED_STRING","':'",72],".",["T_VARIABLE","$password",72],")",".",["T_CONSTANT_ENCAPSED_STRING","':'",72],".",["T_VARIABLE","$nonce",72],".",["T_CONSTANT_ENCAPSED_STRING","':'",72],".",["T_VARIABLE","$nc",72],".",["T_CONSTANT_ENCAPSED_STRING","':'",72],".",["T_VARIABLE","$cnonce",72],".",["T_CONSTANT_ENCAPSED_STRING","':'",72],".",["T_VARIABLE","$qop",72],".",["T_CONSTANT_ENCAPSED_STRING","':'",72],".",["T_STRING","md5",72],"(",["T_VARIABLE","$method",72],".",["T_CONSTANT_ENCAPSED_STRING","':'",72],".",["T_VARIABLE","$uri",72],")",["T_WHITESPACE","\n        ",72],")",";",["T_WHITESPACE","\n\n        ",73],["T_RETURN","return",75],["T_WHITESPACE"," ",75],["T_STRING","sprintf",75],"(",["T_CONSTANT_ENCAPSED_STRING","'username=\"%s\", realm=\"%s\", nonce=\"%s\", uri=\"%s\", cnonce=\"%s\", nc=%s, qop=\"%s\", response=\"%s\"'",75],",",["T_WHITESPACE","\n            ",75],["T_VARIABLE","$username",76],",",["T_WHITESPACE"," ",76],["T_VARIABLE","$realm",76],",",["T_WHITESPACE"," ",76],["T_VARIABLE","$nonce",76],",",["T_WHITESPACE"," ",76],["T_VARIABLE","$uri",76],",",["T_WHITESPACE"," ",76],["T_VARIABLE","$cnonce",76],",",["T_WHITESPACE"," ",76],["T_VARIABLE","$nc",76],",",["T_WHITESPACE"," ",76],["T_VARIABLE","$qop",76],",",["T_WHITESPACE"," ",76],["T_VARIABLE","$response",76],["T_WHITESPACE","\n        ",76],")",";",["T_WHITESPACE","\n    ",77],"}",["T_WHITESPACE","\n",78],"}",["T_WHITESPACE","\n",79]]