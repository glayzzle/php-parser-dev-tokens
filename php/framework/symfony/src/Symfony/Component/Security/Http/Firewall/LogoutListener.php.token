[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Security",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Http",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Firewall",12],";",["T_WHITESPACE","\n\n",12],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Symfony",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Component",14],["T_NS_SEPARATOR","\\",14],["T_STRING","HttpFoundation",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Request",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Symfony",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Component",15],["T_NS_SEPARATOR","\\",15],["T_STRING","HttpFoundation",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Response",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Symfony",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Component",16],["T_NS_SEPARATOR","\\",16],["T_STRING","HttpKernel",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Event",16],["T_NS_SEPARATOR","\\",16],["T_STRING","GetResponseEvent",16],";",["T_WHITESPACE","\n",16],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Symfony",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Component",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Security",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Core",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Authentication",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Token",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Storage",17],["T_NS_SEPARATOR","\\",17],["T_STRING","TokenStorageInterface",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Symfony",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Component",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Security",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Core",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Exception",18],["T_NS_SEPARATOR","\\",18],["T_STRING","LogoutException",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Symfony",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Component",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Security",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Csrf",19],["T_NS_SEPARATOR","\\",19],["T_STRING","CsrfToken",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Symfony",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Component",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Security",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Csrf",20],["T_NS_SEPARATOR","\\",20],["T_STRING","CsrfTokenManagerInterface",20],";",["T_WHITESPACE","\n",20],["T_USE","use",21],["T_WHITESPACE"," ",21],["T_STRING","Symfony",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Component",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Security",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Http",21],["T_NS_SEPARATOR","\\",21],["T_STRING","HttpUtils",21],";",["T_WHITESPACE","\n",21],["T_USE","use",22],["T_WHITESPACE"," ",22],["T_STRING","Symfony",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Component",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Security",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Http",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Logout",22],["T_NS_SEPARATOR","\\",22],["T_STRING","LogoutHandlerInterface",22],";",["T_WHITESPACE","\n",22],["T_USE","use",23],["T_WHITESPACE"," ",23],["T_STRING","Symfony",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Component",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Security",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Http",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Logout",23],["T_NS_SEPARATOR","\\",23],["T_STRING","LogoutSuccessHandlerInterface",23],";",["T_WHITESPACE","\n",23],["T_USE","use",24],["T_WHITESPACE"," ",24],["T_STRING","Symfony",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Component",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Security",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Http",24],["T_NS_SEPARATOR","\\",24],["T_STRING","ParameterBagUtils",24],";",["T_WHITESPACE","\n\n",24],["T_DOC_COMMENT","\/**\n * LogoutListener logout users.\n *\n * @author Fabien Potencier <fabien@symfony.com>\n *\/",26],["T_WHITESPACE","\n",30],["T_CLASS","class",31],["T_WHITESPACE"," ",31],["T_STRING","LogoutListener",31],["T_WHITESPACE"," ",31],["T_IMPLEMENTS","implements",31],["T_WHITESPACE"," ",31],["T_STRING","ListenerInterface",31],["T_WHITESPACE","\n",31],"{",["T_WHITESPACE","\n    ",32],["T_PRIVATE","private",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$tokenStorage",33],";",["T_WHITESPACE","\n    ",33],["T_PRIVATE","private",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$options",34],";",["T_WHITESPACE","\n    ",34],["T_PRIVATE","private",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$handlers",35],";",["T_WHITESPACE","\n    ",35],["T_PRIVATE","private",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$successHandler",36],";",["T_WHITESPACE","\n    ",36],["T_PRIVATE","private",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$httpUtils",37],";",["T_WHITESPACE","\n    ",37],["T_PRIVATE","private",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$csrfTokenManager",38],";",["T_WHITESPACE","\n\n    ",38],["T_DOC_COMMENT","\/**\n     * Constructor.\n     *\n     * @param TokenStorageInterface         $tokenStorage\n     * @param HttpUtils                     $httpUtils        An HttpUtilsInterface instance\n     * @param LogoutSuccessHandlerInterface $successHandler   A LogoutSuccessHandlerInterface instance\n     * @param array                         $options          An array of options to process a logout attempt\n     * @param CsrfTokenManagerInterface     $csrfTokenManager A CsrfTokenManagerInterface instance\n     *\/",40],["T_WHITESPACE","\n    ",48],["T_PUBLIC","public",49],["T_WHITESPACE"," ",49],["T_FUNCTION","function",49],["T_WHITESPACE"," ",49],["T_STRING","__construct",49],"(",["T_STRING","TokenStorageInterface",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$tokenStorage",49],",",["T_WHITESPACE"," ",49],["T_STRING","HttpUtils",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$httpUtils",49],",",["T_WHITESPACE"," ",49],["T_STRING","LogoutSuccessHandlerInterface",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$successHandler",49],",",["T_WHITESPACE"," ",49],["T_ARRAY","array",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$options",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_ARRAY","array",49],"(",")",",",["T_WHITESPACE"," ",49],["T_STRING","CsrfTokenManagerInterface",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$csrfTokenManager",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_STRING","null",49],")",["T_WHITESPACE","\n    ",49],"{",["T_WHITESPACE","\n        ",50],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","tokenStorage",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$tokenStorage",51],";",["T_WHITESPACE","\n        ",51],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","httpUtils",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$httpUtils",52],";",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","options",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_STRING","array_merge",53],"(",["T_ARRAY","array",53],"(",["T_WHITESPACE","\n            ",53],["T_CONSTANT_ENCAPSED_STRING","'csrf_parameter'",54],["T_WHITESPACE"," ",54],["T_DOUBLE_ARROW","=>",54],["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'_csrf_token'",54],",",["T_WHITESPACE","\n            ",54],["T_CONSTANT_ENCAPSED_STRING","'csrf_token_id'",55],["T_WHITESPACE"," ",55],["T_DOUBLE_ARROW","=>",55],["T_WHITESPACE"," ",55],["T_CONSTANT_ENCAPSED_STRING","'logout'",55],",",["T_WHITESPACE","\n            ",55],["T_CONSTANT_ENCAPSED_STRING","'logout_path'",56],["T_WHITESPACE"," ",56],["T_DOUBLE_ARROW","=>",56],["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'\/logout'",56],",",["T_WHITESPACE","\n        ",56],")",",",["T_WHITESPACE"," ",57],["T_VARIABLE","$options",57],")",";",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","successHandler",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$successHandler",58],";",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","csrfTokenManager",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$csrfTokenManager",59],";",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","handlers",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_ARRAY","array",60],"(",")",";",["T_WHITESPACE","\n    ",60],"}",["T_WHITESPACE","\n\n    ",61],["T_DOC_COMMENT","\/**\n     * Adds a logout handler.\n     *\n     * @param LogoutHandlerInterface $handler\n     *\/",63],["T_WHITESPACE","\n    ",67],["T_PUBLIC","public",68],["T_WHITESPACE"," ",68],["T_FUNCTION","function",68],["T_WHITESPACE"," ",68],["T_STRING","addHandler",68],"(",["T_STRING","LogoutHandlerInterface",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$handler",68],")",["T_WHITESPACE","\n    ",68],"{",["T_WHITESPACE","\n        ",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","handlers",70],"[","]",["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$handler",70],";",["T_WHITESPACE","\n    ",70],"}",["T_WHITESPACE","\n\n    ",71],["T_DOC_COMMENT","\/**\n     * Performs the logout if requested.\n     *\n     * If a CsrfTokenManagerInterface instance is available, it will be used to\n     * validate the request.\n     *\n     * @param GetResponseEvent $event A GetResponseEvent instance\n     *\n     * @throws LogoutException   if the CSRF token is invalid\n     * @throws \\RuntimeException if the LogoutSuccessHandlerInterface instance does not return a response\n     *\/",73],["T_WHITESPACE","\n    ",83],["T_PUBLIC","public",84],["T_WHITESPACE"," ",84],["T_FUNCTION","function",84],["T_WHITESPACE"," ",84],["T_STRING","handle",84],"(",["T_STRING","GetResponseEvent",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$event",84],")",["T_WHITESPACE","\n    ",84],"{",["T_WHITESPACE","\n        ",85],["T_VARIABLE","$request",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$event",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getRequest",86],"(",")",";",["T_WHITESPACE","\n\n        ",86],["T_IF","if",88],["T_WHITESPACE"," ",88],"(","!",["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","requiresLogout",88],"(",["T_VARIABLE","$request",88],")",")",["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n            ",88],["T_RETURN","return",89],";",["T_WHITESPACE","\n        ",89],"}",["T_WHITESPACE","\n\n        ",90],["T_IF","if",92],["T_WHITESPACE"," ",92],"(",["T_STRING","null",92],["T_WHITESPACE"," ",92],["T_IS_NOT_IDENTICAL","!==",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","csrfTokenManager",92],")",["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n            ",92],["T_VARIABLE","$csrfToken",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_STRING","ParameterBagUtils",93],["T_DOUBLE_COLON","::",93],["T_STRING","getRequestParameterValue",93],"(",["T_VARIABLE","$request",93],",",["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","options",93],"[",["T_CONSTANT_ENCAPSED_STRING","'csrf_parameter'",93],"]",")",";",["T_WHITESPACE","\n\n            ",93],["T_IF","if",95],["T_WHITESPACE"," ",95],"(",["T_STRING","false",95],["T_WHITESPACE"," ",95],["T_IS_IDENTICAL","===",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","csrfTokenManager",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","isTokenValid",95],"(",["T_NEW","new",95],["T_WHITESPACE"," ",95],["T_STRING","CsrfToken",95],"(",["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","options",95],"[",["T_CONSTANT_ENCAPSED_STRING","'csrf_token_id'",95],"]",",",["T_WHITESPACE"," ",95],["T_VARIABLE","$csrfToken",95],")",")",")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n                ",95],["T_THROW","throw",96],["T_WHITESPACE"," ",96],["T_NEW","new",96],["T_WHITESPACE"," ",96],["T_STRING","LogoutException",96],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid CSRF token.'",96],")",";",["T_WHITESPACE","\n            ",96],"}",["T_WHITESPACE","\n        ",97],"}",["T_WHITESPACE","\n\n        ",98],["T_VARIABLE","$response",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","successHandler",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","onLogoutSuccess",100],"(",["T_VARIABLE","$request",100],")",";",["T_WHITESPACE","\n        ",100],["T_IF","if",101],["T_WHITESPACE"," ",101],"(","!",["T_VARIABLE","$response",101],["T_WHITESPACE"," ",101],["T_INSTANCEOF","instanceof",101],["T_WHITESPACE"," ",101],["T_STRING","Response",101],")",["T_WHITESPACE"," ",101],"{",["T_WHITESPACE","\n            ",101],["T_THROW","throw",102],["T_WHITESPACE"," ",102],["T_NEW","new",102],["T_WHITESPACE"," ",102],["T_NS_SEPARATOR","\\",102],["T_STRING","RuntimeException",102],"(",["T_CONSTANT_ENCAPSED_STRING","'Logout Success Handler did not return a Response.'",102],")",";",["T_WHITESPACE","\n        ",102],"}",["T_WHITESPACE","\n\n        ",103],["T_COMMENT","\/\/ handle multiple logout attempts gracefully\n",105],["T_WHITESPACE","        ",106],["T_IF","if",106],["T_WHITESPACE"," ",106],"(",["T_VARIABLE","$token",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","tokenStorage",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","getToken",106],"(",")",")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n            ",106],["T_FOREACH","foreach",107],["T_WHITESPACE"," ",107],"(",["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","handlers",107],["T_WHITESPACE"," ",107],["T_AS","as",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$handler",107],")",["T_WHITESPACE"," ",107],"{",["T_WHITESPACE","\n                ",107],["T_VARIABLE","$handler",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","logout",108],"(",["T_VARIABLE","$request",108],",",["T_WHITESPACE"," ",108],["T_VARIABLE","$response",108],",",["T_WHITESPACE"," ",108],["T_VARIABLE","$token",108],")",";",["T_WHITESPACE","\n            ",108],"}",["T_WHITESPACE","\n        ",109],"}",["T_WHITESPACE","\n\n        ",110],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","tokenStorage",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","setToken",112],"(",["T_STRING","null",112],")",";",["T_WHITESPACE","\n\n        ",112],["T_VARIABLE","$event",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","setResponse",114],"(",["T_VARIABLE","$response",114],")",";",["T_WHITESPACE","\n    ",114],"}",["T_WHITESPACE","\n\n    ",115],["T_DOC_COMMENT","\/**\n     * Whether this request is asking for logout.\n     *\n     * The default implementation only processed requests to a specific path,\n     * but a subclass could change this to logout requests where\n     * certain parameters is present.\n     *\n     * @param Request $request\n     *\n     * @return bool\n     *\/",117],["T_WHITESPACE","\n    ",127],["T_PROTECTED","protected",128],["T_WHITESPACE"," ",128],["T_FUNCTION","function",128],["T_WHITESPACE"," ",128],["T_STRING","requiresLogout",128],"(",["T_STRING","Request",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$request",128],")",["T_WHITESPACE","\n    ",128],"{",["T_WHITESPACE","\n        ",129],["T_RETURN","return",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","httpUtils",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","checkRequestPath",130],"(",["T_VARIABLE","$request",130],",",["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","options",130],"[",["T_CONSTANT_ENCAPSED_STRING","'logout_path'",130],"]",")",";",["T_WHITESPACE","\n    ",130],"}",["T_WHITESPACE","\n",131],"}",["T_WHITESPACE","\n",132]]