[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Security",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Http",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Tests",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Authentication",12],";",["T_WHITESPACE","\n\n",12],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Symfony",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Component",14],["T_NS_SEPARATOR","\\",14],["T_STRING","HttpFoundation",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Response",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Symfony",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Component",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Security",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Http",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Authentication",15],["T_NS_SEPARATOR","\\",15],["T_STRING","DefaultAuthenticationSuccessHandler",15],";",["T_WHITESPACE","\n\n",15],["T_CLASS","class",17],["T_WHITESPACE"," ",17],["T_STRING","DefaultAuthenticationSuccessHandlerTest",17],["T_WHITESPACE"," ",17],["T_EXTENDS","extends",17],["T_WHITESPACE"," ",17],["T_NS_SEPARATOR","\\",17],["T_STRING","PHPUnit_Framework_TestCase",17],["T_WHITESPACE","\n",17],"{",["T_WHITESPACE","\n    ",18],["T_PRIVATE","private",19],["T_WHITESPACE"," ",19],["T_VARIABLE","$httpUtils",19],["T_WHITESPACE"," ",19],"=",["T_WHITESPACE"," ",19],["T_STRING","null",19],";",["T_WHITESPACE","\n\n    ",19],["T_PRIVATE","private",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$request",21],["T_WHITESPACE"," ",21],"=",["T_WHITESPACE"," ",21],["T_STRING","null",21],";",["T_WHITESPACE","\n\n    ",21],["T_PRIVATE","private",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$token",23],["T_WHITESPACE"," ",23],"=",["T_WHITESPACE"," ",23],["T_STRING","null",23],";",["T_WHITESPACE","\n\n    ",23],["T_PROTECTED","protected",25],["T_WHITESPACE"," ",25],["T_FUNCTION","function",25],["T_WHITESPACE"," ",25],["T_STRING","setUp",25],"(",")",["T_WHITESPACE","\n    ",25],"{",["T_WHITESPACE","\n        ",26],["T_VARIABLE","$this",27],["T_OBJECT_OPERATOR","->",27],["T_STRING","httpUtils",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],["T_VARIABLE","$this",27],["T_OBJECT_OPERATOR","->",27],["T_STRING","getMockBuilder",27],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Http\\HttpUtils'",27],")",["T_OBJECT_OPERATOR","->",27],["T_STRING","getMock",27],"(",")",";",["T_WHITESPACE","\n        ",27],["T_VARIABLE","$this",28],["T_OBJECT_OPERATOR","->",28],["T_STRING","request",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_VARIABLE","$this",28],["T_OBJECT_OPERATOR","->",28],["T_STRING","getMockBuilder",28],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\HttpFoundation\\Request'",28],")",["T_OBJECT_OPERATOR","->",28],["T_STRING","getMock",28],"(",")",";",["T_WHITESPACE","\n        ",28],["T_VARIABLE","$this",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","request",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","headers",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_VARIABLE","$this",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","getMockBuilder",29],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\HttpFoundation\\HeaderBag'",29],")",["T_OBJECT_OPERATOR","->",29],["T_STRING","getMock",29],"(",")",";",["T_WHITESPACE","\n        ",29],["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","token",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","getMockBuilder",30],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Core\\Authentication\\Token\\TokenInterface'",30],")",["T_OBJECT_OPERATOR","->",30],["T_STRING","getMock",30],"(",")",";",["T_WHITESPACE","\n    ",30],"}",["T_WHITESPACE","\n\n    ",31],["T_PUBLIC","public",33],["T_WHITESPACE"," ",33],["T_FUNCTION","function",33],["T_WHITESPACE"," ",33],["T_STRING","testRequestIsRedirected",33],"(",")",["T_WHITESPACE","\n    ",33],"{",["T_WHITESPACE","\n        ",34],["T_VARIABLE","$response",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","expectRedirectResponse",35],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",35],")",";",["T_WHITESPACE","\n\n        ",35],["T_VARIABLE","$handler",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_NEW","new",37],["T_WHITESPACE"," ",37],["T_STRING","DefaultAuthenticationSuccessHandler",37],"(",["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","httpUtils",37],",",["T_WHITESPACE"," ",37],["T_ARRAY","array",37],"(",")",")",";",["T_WHITESPACE","\n        ",37],["T_VARIABLE","$result",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_VARIABLE","$handler",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","onAuthenticationSuccess",38],"(",["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","request",38],",",["T_WHITESPACE"," ",38],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","token",38],")",";",["T_WHITESPACE","\n\n        ",38],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","assertSame",40],"(",["T_VARIABLE","$response",40],",",["T_WHITESPACE"," ",40],["T_VARIABLE","$result",40],")",";",["T_WHITESPACE","\n    ",40],"}",["T_WHITESPACE","\n\n    ",41],["T_PUBLIC","public",43],["T_WHITESPACE"," ",43],["T_FUNCTION","function",43],["T_WHITESPACE"," ",43],["T_STRING","testDefaultTargetPathCanBeForced",43],"(",")",["T_WHITESPACE","\n    ",43],"{",["T_WHITESPACE","\n        ",44],["T_VARIABLE","$options",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_ARRAY","array",45],"(",["T_WHITESPACE","\n            ",45],["T_CONSTANT_ENCAPSED_STRING","'always_use_default_target_path'",46],["T_WHITESPACE"," ",46],["T_DOUBLE_ARROW","=>",46],["T_WHITESPACE"," ",46],["T_STRING","true",46],",",["T_WHITESPACE","\n            ",46],["T_CONSTANT_ENCAPSED_STRING","'default_target_path'",47],["T_WHITESPACE"," ",47],["T_DOUBLE_ARROW","=>",47],["T_WHITESPACE"," ",47],["T_CONSTANT_ENCAPSED_STRING","'\/dashboard'",47],",",["T_WHITESPACE","\n        ",47],")",";",["T_WHITESPACE","\n\n        ",48],["T_VARIABLE","$response",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","expectRedirectResponse",50],"(",["T_CONSTANT_ENCAPSED_STRING","'\/dashboard'",50],")",";",["T_WHITESPACE","\n\n        ",50],["T_VARIABLE","$handler",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_NEW","new",52],["T_WHITESPACE"," ",52],["T_STRING","DefaultAuthenticationSuccessHandler",52],"(",["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","httpUtils",52],",",["T_WHITESPACE"," ",52],["T_VARIABLE","$options",52],")",";",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$result",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$handler",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","onAuthenticationSuccess",53],"(",["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","request",53],",",["T_WHITESPACE"," ",53],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","token",53],")",";",["T_WHITESPACE","\n\n        ",53],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","assertSame",55],"(",["T_VARIABLE","$response",55],",",["T_WHITESPACE"," ",55],["T_VARIABLE","$result",55],")",";",["T_WHITESPACE","\n    ",55],"}",["T_WHITESPACE","\n\n    ",56],["T_PUBLIC","public",58],["T_WHITESPACE"," ",58],["T_FUNCTION","function",58],["T_WHITESPACE"," ",58],["T_STRING","testTargetPathIsPassedWithRequest",58],"(",")",["T_WHITESPACE","\n    ",58],"{",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","request",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","expects",60],"(",["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","once",60],"(",")",")",["T_WHITESPACE","\n            ",60],["T_OBJECT_OPERATOR","->",61],["T_STRING","method",61],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",61],")",["T_OBJECT_OPERATOR","->",61],["T_STRING","with",61],"(",["T_CONSTANT_ENCAPSED_STRING","'_target_path'",61],")",["T_WHITESPACE","\n            ",61],["T_OBJECT_OPERATOR","->",62],["T_STRING","will",62],"(",["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","returnValue",62],"(",["T_CONSTANT_ENCAPSED_STRING","'\/dashboard'",62],")",")",";",["T_WHITESPACE","\n\n        ",62],["T_VARIABLE","$response",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","expectRedirectResponse",64],"(",["T_CONSTANT_ENCAPSED_STRING","'\/dashboard'",64],")",";",["T_WHITESPACE","\n\n        ",64],["T_VARIABLE","$handler",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_NEW","new",66],["T_WHITESPACE"," ",66],["T_STRING","DefaultAuthenticationSuccessHandler",66],"(",["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","httpUtils",66],",",["T_WHITESPACE"," ",66],["T_ARRAY","array",66],"(",")",")",";",["T_WHITESPACE","\n        ",66],["T_VARIABLE","$result",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$handler",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","onAuthenticationSuccess",67],"(",["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","request",67],",",["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","token",67],")",";",["T_WHITESPACE","\n\n        ",67],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","assertSame",69],"(",["T_VARIABLE","$response",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$result",69],")",";",["T_WHITESPACE","\n    ",69],"}",["T_WHITESPACE","\n\n    ",70],["T_PUBLIC","public",72],["T_WHITESPACE"," ",72],["T_FUNCTION","function",72],["T_WHITESPACE"," ",72],["T_STRING","testTargetPathIsPassedAsNestedParameterWithRequest",72],"(",")",["T_WHITESPACE","\n    ",72],"{",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","request",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","expects",74],"(",["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","once",74],"(",")",")",["T_WHITESPACE","\n            ",74],["T_OBJECT_OPERATOR","->",75],["T_STRING","method",75],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",75],")",["T_OBJECT_OPERATOR","->",75],["T_STRING","with",75],"(",["T_CONSTANT_ENCAPSED_STRING","'_target_path'",75],")",["T_WHITESPACE","\n            ",75],["T_OBJECT_OPERATOR","->",76],["T_STRING","will",76],"(",["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","returnValue",76],"(",["T_ARRAY","array",76],"(",["T_CONSTANT_ENCAPSED_STRING","'value'",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'\/dashboard'",76],")",")",")",";",["T_WHITESPACE","\n\n        ",76],["T_VARIABLE","$response",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","expectRedirectResponse",78],"(",["T_CONSTANT_ENCAPSED_STRING","'\/dashboard'",78],")",";",["T_WHITESPACE","\n\n        ",78],["T_VARIABLE","$handler",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_NEW","new",80],["T_WHITESPACE"," ",80],["T_STRING","DefaultAuthenticationSuccessHandler",80],"(",["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","httpUtils",80],",",["T_WHITESPACE"," ",80],["T_ARRAY","array",80],"(",["T_CONSTANT_ENCAPSED_STRING","'target_path_parameter'",80],["T_WHITESPACE"," ",80],["T_DOUBLE_ARROW","=>",80],["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'_target_path[value]'",80],")",")",";",["T_WHITESPACE","\n        ",80],["T_VARIABLE","$result",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$handler",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","onAuthenticationSuccess",81],"(",["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","request",81],",",["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","token",81],")",";",["T_WHITESPACE","\n\n        ",81],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","assertSame",83],"(",["T_VARIABLE","$response",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$result",83],")",";",["T_WHITESPACE","\n    ",83],"}",["T_WHITESPACE","\n\n    ",84],["T_PUBLIC","public",86],["T_WHITESPACE"," ",86],["T_FUNCTION","function",86],["T_WHITESPACE"," ",86],["T_STRING","testTargetPathParameterIsCustomised",86],"(",")",["T_WHITESPACE","\n    ",86],"{",["T_WHITESPACE","\n        ",87],["T_VARIABLE","$options",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_ARRAY","array",88],"(",["T_CONSTANT_ENCAPSED_STRING","'target_path_parameter'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'_my_target_path'",88],")",";",["T_WHITESPACE","\n\n        ",88],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","request",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","expects",90],"(",["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","once",90],"(",")",")",["T_WHITESPACE","\n            ",90],["T_OBJECT_OPERATOR","->",91],["T_STRING","method",91],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",91],")",["T_OBJECT_OPERATOR","->",91],["T_STRING","with",91],"(",["T_CONSTANT_ENCAPSED_STRING","'_my_target_path'",91],")",["T_WHITESPACE","\n            ",91],["T_OBJECT_OPERATOR","->",92],["T_STRING","will",92],"(",["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","returnValue",92],"(",["T_CONSTANT_ENCAPSED_STRING","'\/dashboard'",92],")",")",";",["T_WHITESPACE","\n\n        ",92],["T_VARIABLE","$response",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","expectRedirectResponse",94],"(",["T_CONSTANT_ENCAPSED_STRING","'\/dashboard'",94],")",";",["T_WHITESPACE","\n\n        ",94],["T_VARIABLE","$handler",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_NEW","new",96],["T_WHITESPACE"," ",96],["T_STRING","DefaultAuthenticationSuccessHandler",96],"(",["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","httpUtils",96],",",["T_WHITESPACE"," ",96],["T_VARIABLE","$options",96],")",";",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$result",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$handler",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","onAuthenticationSuccess",97],"(",["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","request",97],",",["T_WHITESPACE"," ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","token",97],")",";",["T_WHITESPACE","\n\n        ",97],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","assertSame",99],"(",["T_VARIABLE","$response",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$result",99],")",";",["T_WHITESPACE","\n    ",99],"}",["T_WHITESPACE","\n\n    ",100],["T_PUBLIC","public",102],["T_WHITESPACE"," ",102],["T_FUNCTION","function",102],["T_WHITESPACE"," ",102],["T_STRING","testTargetPathIsTakenFromTheSession",102],"(",")",["T_WHITESPACE","\n    ",102],"{",["T_WHITESPACE","\n        ",103],["T_VARIABLE","$session",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getMockBuilder",104],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\HttpFoundation\\Session\\SessionInterface'",104],")",["T_OBJECT_OPERATOR","->",104],["T_STRING","getMock",104],"(",")",";",["T_WHITESPACE","\n        ",104],["T_VARIABLE","$session",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","expects",105],"(",["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","once",105],"(",")",")",["T_WHITESPACE","\n            ",105],["T_OBJECT_OPERATOR","->",106],["T_STRING","method",106],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",106],")",["T_OBJECT_OPERATOR","->",106],["T_STRING","with",106],"(",["T_CONSTANT_ENCAPSED_STRING","'_security.admin.target_path'",106],")",["T_WHITESPACE","\n            ",106],["T_OBJECT_OPERATOR","->",107],["T_STRING","will",107],"(",["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","returnValue",107],"(",["T_CONSTANT_ENCAPSED_STRING","'\/admin\/dashboard'",107],")",")",";",["T_WHITESPACE","\n        ",107],["T_VARIABLE","$session",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","expects",108],"(",["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","once",108],"(",")",")",["T_WHITESPACE","\n            ",108],["T_OBJECT_OPERATOR","->",109],["T_STRING","method",109],"(",["T_CONSTANT_ENCAPSED_STRING","'remove'",109],")",["T_OBJECT_OPERATOR","->",109],["T_STRING","with",109],"(",["T_CONSTANT_ENCAPSED_STRING","'_security.admin.target_path'",109],")",";",["T_WHITESPACE","\n\n        ",109],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","request",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","expects",111],"(",["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","any",111],"(",")",")",["T_WHITESPACE","\n            ",111],["T_OBJECT_OPERATOR","->",112],["T_STRING","method",112],"(",["T_CONSTANT_ENCAPSED_STRING","'getSession'",112],")",["T_WHITESPACE","\n            ",112],["T_OBJECT_OPERATOR","->",113],["T_STRING","will",113],"(",["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","returnValue",113],"(",["T_VARIABLE","$session",113],")",")",";",["T_WHITESPACE","\n\n        ",113],["T_VARIABLE","$response",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","expectRedirectResponse",115],"(",["T_CONSTANT_ENCAPSED_STRING","'\/admin\/dashboard'",115],")",";",["T_WHITESPACE","\n\n        ",115],["T_VARIABLE","$handler",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_NEW","new",117],["T_WHITESPACE"," ",117],["T_STRING","DefaultAuthenticationSuccessHandler",117],"(",["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","httpUtils",117],",",["T_WHITESPACE"," ",117],["T_ARRAY","array",117],"(",")",")",";",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$handler",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","setProviderKey",118],"(",["T_CONSTANT_ENCAPSED_STRING","'admin'",118],")",";",["T_WHITESPACE","\n\n        ",118],["T_VARIABLE","$result",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_VARIABLE","$handler",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","onAuthenticationSuccess",120],"(",["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","request",120],",",["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","token",120],")",";",["T_WHITESPACE","\n\n        ",120],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","assertSame",122],"(",["T_VARIABLE","$response",122],",",["T_WHITESPACE"," ",122],["T_VARIABLE","$result",122],")",";",["T_WHITESPACE","\n    ",122],"}",["T_WHITESPACE","\n\n    ",123],["T_PUBLIC","public",125],["T_WHITESPACE"," ",125],["T_FUNCTION","function",125],["T_WHITESPACE"," ",125],["T_STRING","testTargetPathIsPassedAsReferer",125],"(",")",["T_WHITESPACE","\n    ",125],"{",["T_WHITESPACE","\n        ",126],["T_VARIABLE","$options",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_ARRAY","array",127],"(",["T_CONSTANT_ENCAPSED_STRING","'use_referer'",127],["T_WHITESPACE"," ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],["T_STRING","true",127],")",";",["T_WHITESPACE","\n\n        ",127],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","request",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","headers",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","expects",129],"(",["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","once",129],"(",")",")",["T_WHITESPACE","\n            ",129],["T_OBJECT_OPERATOR","->",130],["T_STRING","method",130],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",130],")",["T_OBJECT_OPERATOR","->",130],["T_STRING","with",130],"(",["T_CONSTANT_ENCAPSED_STRING","'Referer'",130],")",["T_WHITESPACE","\n            ",130],["T_OBJECT_OPERATOR","->",131],["T_STRING","will",131],"(",["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","returnValue",131],"(",["T_CONSTANT_ENCAPSED_STRING","'\/dashboard'",131],")",")",";",["T_WHITESPACE","\n\n        ",131],["T_VARIABLE","$response",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","expectRedirectResponse",133],"(",["T_CONSTANT_ENCAPSED_STRING","'\/dashboard'",133],")",";",["T_WHITESPACE","\n\n        ",133],["T_VARIABLE","$handler",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_NEW","new",135],["T_WHITESPACE"," ",135],["T_STRING","DefaultAuthenticationSuccessHandler",135],"(",["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","httpUtils",135],",",["T_WHITESPACE"," ",135],["T_VARIABLE","$options",135],")",";",["T_WHITESPACE","\n        ",135],["T_VARIABLE","$result",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_VARIABLE","$handler",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","onAuthenticationSuccess",136],"(",["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","request",136],",",["T_WHITESPACE"," ",136],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","token",136],")",";",["T_WHITESPACE","\n\n        ",136],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","assertSame",138],"(",["T_VARIABLE","$response",138],",",["T_WHITESPACE"," ",138],["T_VARIABLE","$result",138],")",";",["T_WHITESPACE","\n    ",138],"}",["T_WHITESPACE","\n\n    ",139],["T_PUBLIC","public",141],["T_WHITESPACE"," ",141],["T_FUNCTION","function",141],["T_WHITESPACE"," ",141],["T_STRING","testRefererHasToBeDifferentThatLoginUrl",141],"(",")",["T_WHITESPACE","\n    ",141],"{",["T_WHITESPACE","\n        ",142],["T_VARIABLE","$options",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_ARRAY","array",143],"(",["T_CONSTANT_ENCAPSED_STRING","'use_referer'",143],["T_WHITESPACE"," ",143],["T_DOUBLE_ARROW","=>",143],["T_WHITESPACE"," ",143],["T_STRING","true",143],")",";",["T_WHITESPACE","\n\n        ",143],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","request",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","headers",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","expects",145],"(",["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","any",145],"(",")",")",["T_WHITESPACE","\n            ",145],["T_OBJECT_OPERATOR","->",146],["T_STRING","method",146],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",146],")",["T_OBJECT_OPERATOR","->",146],["T_STRING","with",146],"(",["T_CONSTANT_ENCAPSED_STRING","'Referer'",146],")",["T_WHITESPACE","\n            ",146],["T_OBJECT_OPERATOR","->",147],["T_STRING","will",147],"(",["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","returnValue",147],"(",["T_CONSTANT_ENCAPSED_STRING","'\/login'",147],")",")",";",["T_WHITESPACE","\n\n        ",147],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","httpUtils",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","expects",149],"(",["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","once",149],"(",")",")",["T_WHITESPACE","\n            ",149],["T_OBJECT_OPERATOR","->",150],["T_STRING","method",150],"(",["T_CONSTANT_ENCAPSED_STRING","'generateUri'",150],")",["T_OBJECT_OPERATOR","->",150],["T_STRING","with",150],"(",["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","request",150],",",["T_WHITESPACE"," ",150],["T_CONSTANT_ENCAPSED_STRING","'\/login'",150],")",["T_WHITESPACE","\n            ",150],["T_OBJECT_OPERATOR","->",151],["T_STRING","will",151],"(",["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","returnValue",151],"(",["T_CONSTANT_ENCAPSED_STRING","'\/login'",151],")",")",";",["T_WHITESPACE","\n\n        ",151],["T_VARIABLE","$response",153],["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","expectRedirectResponse",153],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",153],")",";",["T_WHITESPACE","\n\n        ",153],["T_VARIABLE","$handler",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_NEW","new",155],["T_WHITESPACE"," ",155],["T_STRING","DefaultAuthenticationSuccessHandler",155],"(",["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","httpUtils",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$options",155],")",";",["T_WHITESPACE","\n        ",155],["T_VARIABLE","$result",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_VARIABLE","$handler",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","onAuthenticationSuccess",156],"(",["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","request",156],",",["T_WHITESPACE"," ",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","token",156],")",";",["T_WHITESPACE","\n\n        ",156],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","assertSame",158],"(",["T_VARIABLE","$response",158],",",["T_WHITESPACE"," ",158],["T_VARIABLE","$result",158],")",";",["T_WHITESPACE","\n    ",158],"}",["T_WHITESPACE","\n\n    ",159],["T_PUBLIC","public",161],["T_WHITESPACE"," ",161],["T_FUNCTION","function",161],["T_WHITESPACE"," ",161],["T_STRING","testRefererTargetPathIsIgnoredByDefault",161],"(",")",["T_WHITESPACE","\n    ",161],"{",["T_WHITESPACE","\n        ",162],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","request",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","headers",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","expects",163],"(",["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","never",163],"(",")",")",["T_OBJECT_OPERATOR","->",163],["T_STRING","method",163],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",163],")",";",["T_WHITESPACE","\n\n        ",163],["T_VARIABLE","$response",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","expectRedirectResponse",165],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",165],")",";",["T_WHITESPACE","\n\n        ",165],["T_VARIABLE","$handler",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_NEW","new",167],["T_WHITESPACE"," ",167],["T_STRING","DefaultAuthenticationSuccessHandler",167],"(",["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","httpUtils",167],",",["T_WHITESPACE"," ",167],["T_ARRAY","array",167],"(",")",")",";",["T_WHITESPACE","\n        ",167],["T_VARIABLE","$result",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_VARIABLE","$handler",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","onAuthenticationSuccess",168],"(",["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","request",168],",",["T_WHITESPACE"," ",168],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","token",168],")",";",["T_WHITESPACE","\n\n        ",168],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","assertSame",170],"(",["T_VARIABLE","$response",170],",",["T_WHITESPACE"," ",170],["T_VARIABLE","$result",170],")",";",["T_WHITESPACE","\n    ",170],"}",["T_WHITESPACE","\n\n    ",171],["T_PRIVATE","private",173],["T_WHITESPACE"," ",173],["T_FUNCTION","function",173],["T_WHITESPACE"," ",173],["T_STRING","expectRedirectResponse",173],"(",["T_VARIABLE","$path",173],")",["T_WHITESPACE","\n    ",173],"{",["T_WHITESPACE","\n        ",174],["T_VARIABLE","$response",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_NEW","new",175],["T_WHITESPACE"," ",175],["T_STRING","Response",175],"(",")",";",["T_WHITESPACE","\n        ",175],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","httpUtils",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","expects",176],"(",["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","once",176],"(",")",")",["T_WHITESPACE","\n            ",176],["T_OBJECT_OPERATOR","->",177],["T_STRING","method",177],"(",["T_CONSTANT_ENCAPSED_STRING","'createRedirectResponse'",177],")",["T_WHITESPACE","\n            ",177],["T_OBJECT_OPERATOR","->",178],["T_STRING","with",178],"(",["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","request",178],",",["T_WHITESPACE"," ",178],["T_VARIABLE","$path",178],")",["T_WHITESPACE","\n            ",178],["T_OBJECT_OPERATOR","->",179],["T_STRING","will",179],"(",["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","returnValue",179],"(",["T_VARIABLE","$response",179],")",")",";",["T_WHITESPACE","\n\n        ",179],["T_RETURN","return",181],["T_WHITESPACE"," ",181],["T_VARIABLE","$response",181],";",["T_WHITESPACE","\n    ",181],"}",["T_WHITESPACE","\n",182],"}",["T_WHITESPACE","\n",183]]