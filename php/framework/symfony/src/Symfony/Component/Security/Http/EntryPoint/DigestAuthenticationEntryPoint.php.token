[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Security",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Http",12],["T_NS_SEPARATOR","\\",12],["T_STRING","EntryPoint",12],";",["T_WHITESPACE","\n\n",12],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Symfony",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Component",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Security",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Core",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Exception",14],["T_NS_SEPARATOR","\\",14],["T_STRING","AuthenticationException",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Symfony",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Component",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Security",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Core",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Exception",15],["T_NS_SEPARATOR","\\",15],["T_STRING","NonceExpiredException",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Symfony",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Component",16],["T_NS_SEPARATOR","\\",16],["T_STRING","HttpFoundation",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Response",16],";",["T_WHITESPACE","\n",16],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Symfony",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Component",17],["T_NS_SEPARATOR","\\",17],["T_STRING","HttpFoundation",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Request",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Psr",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Log",18],["T_NS_SEPARATOR","\\",18],["T_STRING","LoggerInterface",18],";",["T_WHITESPACE","\n\n",18],["T_DOC_COMMENT","\/**\n * DigestAuthenticationEntryPoint starts an HTTP Digest authentication.\n *\n * @author Fabien Potencier <fabien@symfony.com>\n *\/",20],["T_WHITESPACE","\n",24],["T_CLASS","class",25],["T_WHITESPACE"," ",25],["T_STRING","DigestAuthenticationEntryPoint",25],["T_WHITESPACE"," ",25],["T_IMPLEMENTS","implements",25],["T_WHITESPACE"," ",25],["T_STRING","AuthenticationEntryPointInterface",25],["T_WHITESPACE","\n",25],"{",["T_WHITESPACE","\n    ",26],["T_PRIVATE","private",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$secret",27],";",["T_WHITESPACE","\n    ",27],["T_PRIVATE","private",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$realmName",28],";",["T_WHITESPACE","\n    ",28],["T_PRIVATE","private",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$nonceValiditySeconds",29],";",["T_WHITESPACE","\n    ",29],["T_PRIVATE","private",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$logger",30],";",["T_WHITESPACE","\n\n    ",30],["T_PUBLIC","public",32],["T_WHITESPACE"," ",32],["T_FUNCTION","function",32],["T_WHITESPACE"," ",32],["T_STRING","__construct",32],"(",["T_VARIABLE","$realmName",32],",",["T_WHITESPACE"," ",32],["T_VARIABLE","$secret",32],",",["T_WHITESPACE"," ",32],["T_VARIABLE","$nonceValiditySeconds",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_LNUMBER","300",32],",",["T_WHITESPACE"," ",32],["T_STRING","LoggerInterface",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$logger",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_STRING","null",32],")",["T_WHITESPACE","\n    ",32],"{",["T_WHITESPACE","\n        ",33],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","realmName",34],["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_VARIABLE","$realmName",34],";",["T_WHITESPACE","\n        ",34],["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","secret",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_VARIABLE","$secret",35],";",["T_WHITESPACE","\n        ",35],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","nonceValiditySeconds",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$nonceValiditySeconds",36],";",["T_WHITESPACE","\n        ",36],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","logger",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_VARIABLE","$logger",37],";",["T_WHITESPACE","\n    ",37],"}",["T_WHITESPACE","\n\n    ",38],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",40],["T_WHITESPACE","\n    ",42],["T_PUBLIC","public",43],["T_WHITESPACE"," ",43],["T_FUNCTION","function",43],["T_WHITESPACE"," ",43],["T_STRING","start",43],"(",["T_STRING","Request",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$request",43],",",["T_WHITESPACE"," ",43],["T_STRING","AuthenticationException",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$authException",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_STRING","null",43],")",["T_WHITESPACE","\n    ",43],"{",["T_WHITESPACE","\n        ",44],["T_VARIABLE","$expiryTime",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_STRING","microtime",45],"(",["T_STRING","true",45],")",["T_WHITESPACE"," ",45],"+",["T_WHITESPACE"," ",45],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","nonceValiditySeconds",45],["T_WHITESPACE"," ",45],"*",["T_WHITESPACE"," ",45],["T_LNUMBER","1000",45],";",["T_WHITESPACE","\n        ",45],["T_VARIABLE","$signatureValue",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_STRING","md5",46],"(",["T_VARIABLE","$expiryTime",46],".",["T_CONSTANT_ENCAPSED_STRING","':'",46],".",["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","secret",46],")",";",["T_WHITESPACE","\n        ",46],["T_VARIABLE","$nonceValue",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$expiryTime",47],".",["T_CONSTANT_ENCAPSED_STRING","':'",47],".",["T_VARIABLE","$signatureValue",47],";",["T_WHITESPACE","\n        ",47],["T_VARIABLE","$nonceValueBase64",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_STRING","base64_encode",48],"(",["T_VARIABLE","$nonceValue",48],")",";",["T_WHITESPACE","\n\n        ",48],["T_VARIABLE","$authenticateHeader",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_STRING","sprintf",50],"(",["T_CONSTANT_ENCAPSED_STRING","'Digest realm=\"%s\", qop=\"auth\", nonce=\"%s\"'",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","realmName",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$nonceValueBase64",50],")",";",["T_WHITESPACE","\n\n        ",50],["T_IF","if",52],["T_WHITESPACE"," ",52],"(",["T_VARIABLE","$authException",52],["T_WHITESPACE"," ",52],["T_INSTANCEOF","instanceof",52],["T_WHITESPACE"," ",52],["T_STRING","NonceExpiredException",52],")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n            ",52],["T_VARIABLE","$authenticateHeader",53],["T_WHITESPACE"," ",53],["T_CONCAT_EQUAL",".=",53],["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","', stale=\"true\"'",53],";",["T_WHITESPACE","\n        ",53],"}",["T_WHITESPACE","\n\n        ",54],["T_IF","if",56],["T_WHITESPACE"," ",56],"(",["T_STRING","null",56],["T_WHITESPACE"," ",56],["T_IS_NOT_IDENTICAL","!==",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","logger",56],")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n            ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","logger",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","debug",57],"(",["T_CONSTANT_ENCAPSED_STRING","'WWW-Authenticate header sent.'",57],",",["T_WHITESPACE"," ",57],["T_ARRAY","array",57],"(",["T_CONSTANT_ENCAPSED_STRING","'header'",57],["T_WHITESPACE"," ",57],["T_DOUBLE_ARROW","=>",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$authenticateHeader",57],")",")",";",["T_WHITESPACE","\n        ",57],"}",["T_WHITESPACE","\n\n        ",58],["T_VARIABLE","$response",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_NEW","new",60],["T_WHITESPACE"," ",60],["T_STRING","Response",60],"(",")",";",["T_WHITESPACE","\n        ",60],["T_VARIABLE","$response",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","headers",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","set",61],"(",["T_CONSTANT_ENCAPSED_STRING","'WWW-Authenticate'",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$authenticateHeader",61],")",";",["T_WHITESPACE","\n        ",61],["T_VARIABLE","$response",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","setStatusCode",62],"(",["T_LNUMBER","401",62],")",";",["T_WHITESPACE","\n\n        ",62],["T_RETURN","return",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$response",64],";",["T_WHITESPACE","\n    ",64],"}",["T_WHITESPACE","\n\n    ",65],["T_DOC_COMMENT","\/**\n     * @return string\n     *\/",67],["T_WHITESPACE","\n    ",69],["T_PUBLIC","public",70],["T_WHITESPACE"," ",70],["T_FUNCTION","function",70],["T_WHITESPACE"," ",70],["T_STRING","getSecret",70],"(",")",["T_WHITESPACE","\n    ",70],"{",["T_WHITESPACE","\n        ",71],["T_RETURN","return",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","secret",72],";",["T_WHITESPACE","\n    ",72],"}",["T_WHITESPACE","\n\n    ",73],["T_DOC_COMMENT","\/**\n     * @return string\n     *\/",75],["T_WHITESPACE","\n    ",77],["T_PUBLIC","public",78],["T_WHITESPACE"," ",78],["T_FUNCTION","function",78],["T_WHITESPACE"," ",78],["T_STRING","getRealmName",78],"(",")",["T_WHITESPACE","\n    ",78],"{",["T_WHITESPACE","\n        ",79],["T_RETURN","return",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","realmName",80],";",["T_WHITESPACE","\n    ",80],"}",["T_WHITESPACE","\n",81],"}",["T_WHITESPACE","\n",82]]