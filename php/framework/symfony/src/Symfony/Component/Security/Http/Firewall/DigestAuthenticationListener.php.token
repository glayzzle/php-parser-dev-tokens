[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Security",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Http",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Firewall",12],";",["T_WHITESPACE","\n\n",12],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Symfony",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Component",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Security",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Core",14],["T_NS_SEPARATOR","\\",14],["T_STRING","User",14],["T_NS_SEPARATOR","\\",14],["T_STRING","UserProviderInterface",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Symfony",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Component",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Security",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Http",15],["T_NS_SEPARATOR","\\",15],["T_STRING","EntryPoint",15],["T_NS_SEPARATOR","\\",15],["T_STRING","DigestAuthenticationEntryPoint",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Psr",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Log",16],["T_NS_SEPARATOR","\\",16],["T_STRING","LoggerInterface",16],";",["T_WHITESPACE","\n",16],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Symfony",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Component",17],["T_NS_SEPARATOR","\\",17],["T_STRING","HttpKernel",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Event",17],["T_NS_SEPARATOR","\\",17],["T_STRING","GetResponseEvent",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Symfony",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Component",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Security",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Core",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Authentication",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Token",18],["T_NS_SEPARATOR","\\",18],["T_STRING","UsernamePasswordToken",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Symfony",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Component",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Security",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Core",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Authentication",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Token",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Storage",19],["T_NS_SEPARATOR","\\",19],["T_STRING","TokenStorageInterface",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Symfony",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Component",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Security",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Core",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Exception",20],["T_NS_SEPARATOR","\\",20],["T_STRING","BadCredentialsException",20],";",["T_WHITESPACE","\n",20],["T_USE","use",21],["T_WHITESPACE"," ",21],["T_STRING","Symfony",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Component",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Security",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Core",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Exception",21],["T_NS_SEPARATOR","\\",21],["T_STRING","AuthenticationServiceException",21],";",["T_WHITESPACE","\n",21],["T_USE","use",22],["T_WHITESPACE"," ",22],["T_STRING","Symfony",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Component",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Security",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Core",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Exception",22],["T_NS_SEPARATOR","\\",22],["T_STRING","UsernameNotFoundException",22],";",["T_WHITESPACE","\n",22],["T_USE","use",23],["T_WHITESPACE"," ",23],["T_STRING","Symfony",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Component",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Security",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Core",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Exception",23],["T_NS_SEPARATOR","\\",23],["T_STRING","NonceExpiredException",23],";",["T_WHITESPACE","\n",23],["T_USE","use",24],["T_WHITESPACE"," ",24],["T_STRING","Symfony",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Component",24],["T_NS_SEPARATOR","\\",24],["T_STRING","HttpFoundation",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Request",24],";",["T_WHITESPACE","\n",24],["T_USE","use",25],["T_WHITESPACE"," ",25],["T_STRING","Symfony",25],["T_NS_SEPARATOR","\\",25],["T_STRING","Component",25],["T_NS_SEPARATOR","\\",25],["T_STRING","Security",25],["T_NS_SEPARATOR","\\",25],["T_STRING","Core",25],["T_NS_SEPARATOR","\\",25],["T_STRING","Exception",25],["T_NS_SEPARATOR","\\",25],["T_STRING","AuthenticationException",25],";",["T_WHITESPACE","\n\n",25],["T_DOC_COMMENT","\/**\n * DigestAuthenticationListener implements Digest HTTP authentication.\n *\n * @author Fabien Potencier <fabien@symfony.com>\n *\/",27],["T_WHITESPACE","\n",31],["T_CLASS","class",32],["T_WHITESPACE"," ",32],["T_STRING","DigestAuthenticationListener",32],["T_WHITESPACE"," ",32],["T_IMPLEMENTS","implements",32],["T_WHITESPACE"," ",32],["T_STRING","ListenerInterface",32],["T_WHITESPACE","\n",32],"{",["T_WHITESPACE","\n    ",33],["T_PRIVATE","private",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$tokenStorage",34],";",["T_WHITESPACE","\n    ",34],["T_PRIVATE","private",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$provider",35],";",["T_WHITESPACE","\n    ",35],["T_PRIVATE","private",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$providerKey",36],";",["T_WHITESPACE","\n    ",36],["T_PRIVATE","private",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$authenticationEntryPoint",37],";",["T_WHITESPACE","\n    ",37],["T_PRIVATE","private",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$logger",38],";",["T_WHITESPACE","\n\n    ",38],["T_PUBLIC","public",40],["T_WHITESPACE"," ",40],["T_FUNCTION","function",40],["T_WHITESPACE"," ",40],["T_STRING","__construct",40],"(",["T_STRING","TokenStorageInterface",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$tokenStorage",40],",",["T_WHITESPACE"," ",40],["T_STRING","UserProviderInterface",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$provider",40],",",["T_WHITESPACE"," ",40],["T_VARIABLE","$providerKey",40],",",["T_WHITESPACE"," ",40],["T_STRING","DigestAuthenticationEntryPoint",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$authenticationEntryPoint",40],",",["T_WHITESPACE"," ",40],["T_STRING","LoggerInterface",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$logger",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_STRING","null",40],")",["T_WHITESPACE","\n    ",40],"{",["T_WHITESPACE","\n        ",41],["T_IF","if",42],["T_WHITESPACE"," ",42],"(",["T_EMPTY","empty",42],"(",["T_VARIABLE","$providerKey",42],")",")",["T_WHITESPACE"," ",42],"{",["T_WHITESPACE","\n            ",42],["T_THROW","throw",43],["T_WHITESPACE"," ",43],["T_NEW","new",43],["T_WHITESPACE"," ",43],["T_NS_SEPARATOR","\\",43],["T_STRING","InvalidArgumentException",43],"(",["T_CONSTANT_ENCAPSED_STRING","'$providerKey must not be empty.'",43],")",";",["T_WHITESPACE","\n        ",43],"}",["T_WHITESPACE","\n\n        ",44],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","tokenStorage",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$tokenStorage",46],";",["T_WHITESPACE","\n        ",46],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","provider",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$provider",47],";",["T_WHITESPACE","\n        ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","providerKey",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$providerKey",48],";",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","authenticationEntryPoint",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$authenticationEntryPoint",49],";",["T_WHITESPACE","\n        ",49],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","logger",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_VARIABLE","$logger",50],";",["T_WHITESPACE","\n    ",50],"}",["T_WHITESPACE","\n\n    ",51],["T_DOC_COMMENT","\/**\n     * Handles digest authentication.\n     *\n     * @param GetResponseEvent $event A GetResponseEvent instance\n     *\n     * @throws AuthenticationServiceException\n     *\/",53],["T_WHITESPACE","\n    ",59],["T_PUBLIC","public",60],["T_WHITESPACE"," ",60],["T_FUNCTION","function",60],["T_WHITESPACE"," ",60],["T_STRING","handle",60],"(",["T_STRING","GetResponseEvent",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$event",60],")",["T_WHITESPACE","\n    ",60],"{",["T_WHITESPACE","\n        ",61],["T_VARIABLE","$request",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_VARIABLE","$event",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","getRequest",62],"(",")",";",["T_WHITESPACE","\n\n        ",62],["T_IF","if",64],["T_WHITESPACE"," ",64],"(","!",["T_VARIABLE","$header",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$request",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","server",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","get",64],"(",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_DIGEST'",64],")",")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n            ",64],["T_RETURN","return",65],";",["T_WHITESPACE","\n        ",65],"}",["T_WHITESPACE","\n\n        ",66],["T_VARIABLE","$digestAuth",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_NEW","new",68],["T_WHITESPACE"," ",68],["T_STRING","DigestData",68],"(",["T_VARIABLE","$header",68],")",";",["T_WHITESPACE","\n\n        ",68],["T_IF","if",70],["T_WHITESPACE"," ",70],"(",["T_STRING","null",70],["T_WHITESPACE"," ",70],["T_IS_NOT_IDENTICAL","!==",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$token",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","tokenStorage",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getToken",70],"(",")",")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n            ",70],["T_IF","if",71],["T_WHITESPACE"," ",71],"(",["T_VARIABLE","$token",71],["T_WHITESPACE"," ",71],["T_INSTANCEOF","instanceof",71],["T_WHITESPACE"," ",71],["T_STRING","UsernamePasswordToken",71],["T_WHITESPACE"," ",71],["T_BOOLEAN_AND","&&",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$token",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","isAuthenticated",71],"(",")",["T_WHITESPACE"," ",71],["T_BOOLEAN_AND","&&",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$token",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getUsername",71],"(",")",["T_WHITESPACE"," ",71],["T_IS_IDENTICAL","===",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$digestAuth",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getUsername",71],"(",")",")",["T_WHITESPACE"," ",71],"{",["T_WHITESPACE","\n                ",71],["T_RETURN","return",72],";",["T_WHITESPACE","\n            ",72],"}",["T_WHITESPACE","\n        ",73],"}",["T_WHITESPACE","\n\n        ",74],["T_IF","if",76],["T_WHITESPACE"," ",76],"(",["T_STRING","null",76],["T_WHITESPACE"," ",76],["T_IS_NOT_IDENTICAL","!==",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","logger",76],")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n            ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","logger",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","debug",77],"(",["T_CONSTANT_ENCAPSED_STRING","'Digest Authorization header received from user agent.'",77],",",["T_WHITESPACE"," ",77],["T_ARRAY","array",77],"(",["T_CONSTANT_ENCAPSED_STRING","'header'",77],["T_WHITESPACE"," ",77],["T_DOUBLE_ARROW","=>",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$header",77],")",")",";",["T_WHITESPACE","\n        ",77],"}",["T_WHITESPACE","\n\n        ",78],["T_TRY","try",80],["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n            ",80],["T_VARIABLE","$digestAuth",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","validateAndDecode",81],"(",["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","authenticationEntryPoint",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getSecret",81],"(",")",",",["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","authenticationEntryPoint",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getRealmName",81],"(",")",")",";",["T_WHITESPACE","\n        ",81],"}",["T_WHITESPACE"," ",82],["T_CATCH","catch",82],["T_WHITESPACE"," ",82],"(",["T_STRING","BadCredentialsException",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$e",82],")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n            ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","fail",83],"(",["T_VARIABLE","$event",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$request",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$e",83],")",";",["T_WHITESPACE","\n\n            ",83],["T_RETURN","return",85],";",["T_WHITESPACE","\n        ",85],"}",["T_WHITESPACE","\n\n        ",86],["T_TRY","try",88],["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n            ",88],["T_VARIABLE","$user",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","provider",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","loadUserByUsername",89],"(",["T_VARIABLE","$digestAuth",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getUsername",89],"(",")",")",";",["T_WHITESPACE","\n\n            ",89],["T_IF","if",91],["T_WHITESPACE"," ",91],"(",["T_STRING","null",91],["T_WHITESPACE"," ",91],["T_IS_IDENTICAL","===",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$user",91],")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n                ",91],["T_THROW","throw",92],["T_WHITESPACE"," ",92],["T_NEW","new",92],["T_WHITESPACE"," ",92],["T_STRING","AuthenticationServiceException",92],"(",["T_CONSTANT_ENCAPSED_STRING","'Digest User provider returned null, which is an interface contract violation'",92],")",";",["T_WHITESPACE","\n            ",92],"}",["T_WHITESPACE","\n\n            ",93],["T_VARIABLE","$serverDigestMd5",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$digestAuth",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","calculateServerDigest",95],"(",["T_VARIABLE","$user",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getPassword",95],"(",")",",",["T_WHITESPACE"," ",95],["T_VARIABLE","$request",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getMethod",95],"(",")",")",";",["T_WHITESPACE","\n        ",95],"}",["T_WHITESPACE"," ",96],["T_CATCH","catch",96],["T_WHITESPACE"," ",96],"(",["T_STRING","UsernameNotFoundException",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$e",96],")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n            ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","fail",97],"(",["T_VARIABLE","$event",97],",",["T_WHITESPACE"," ",97],["T_VARIABLE","$request",97],",",["T_WHITESPACE"," ",97],["T_NEW","new",97],["T_WHITESPACE"," ",97],["T_STRING","BadCredentialsException",97],"(",["T_STRING","sprintf",97],"(",["T_CONSTANT_ENCAPSED_STRING","'Username %s not found.'",97],",",["T_WHITESPACE"," ",97],["T_VARIABLE","$digestAuth",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","getUsername",97],"(",")",")",")",")",";",["T_WHITESPACE","\n\n            ",97],["T_RETURN","return",99],";",["T_WHITESPACE","\n        ",99],"}",["T_WHITESPACE","\n\n        ",100],["T_IF","if",102],["T_WHITESPACE"," ",102],"(","!",["T_STRING","hash_equals",102],"(",["T_VARIABLE","$serverDigestMd5",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$digestAuth",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getResponse",102],"(",")",")",")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n            ",102],["T_IF","if",103],["T_WHITESPACE"," ",103],"(",["T_STRING","null",103],["T_WHITESPACE"," ",103],["T_IS_NOT_IDENTICAL","!==",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","logger",103],")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n                ",103],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","logger",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","debug",104],"(",["T_CONSTANT_ENCAPSED_STRING","'Unexpected response from the DigestAuth received; is the header returning a clear text passwords?'",104],",",["T_WHITESPACE"," ",104],["T_ARRAY","array",104],"(",["T_CONSTANT_ENCAPSED_STRING","'expected'",104],["T_WHITESPACE"," ",104],["T_DOUBLE_ARROW","=>",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$serverDigestMd5",104],",",["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'received'",104],["T_WHITESPACE"," ",104],["T_DOUBLE_ARROW","=>",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$digestAuth",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getResponse",104],"(",")",")",")",";",["T_WHITESPACE","\n            ",104],"}",["T_WHITESPACE","\n\n            ",105],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","fail",107],"(",["T_VARIABLE","$event",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$request",107],",",["T_WHITESPACE"," ",107],["T_NEW","new",107],["T_WHITESPACE"," ",107],["T_STRING","BadCredentialsException",107],"(",["T_CONSTANT_ENCAPSED_STRING","'Incorrect response'",107],")",")",";",["T_WHITESPACE","\n\n            ",107],["T_RETURN","return",109],";",["T_WHITESPACE","\n        ",109],"}",["T_WHITESPACE","\n\n        ",110],["T_IF","if",112],["T_WHITESPACE"," ",112],"(",["T_VARIABLE","$digestAuth",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","isNonceExpired",112],"(",")",")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n            ",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","fail",113],"(",["T_VARIABLE","$event",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$request",113],",",["T_WHITESPACE"," ",113],["T_NEW","new",113],["T_WHITESPACE"," ",113],["T_STRING","NonceExpiredException",113],"(",["T_CONSTANT_ENCAPSED_STRING","'Nonce has expired\/timed out.'",113],")",")",";",["T_WHITESPACE","\n\n            ",113],["T_RETURN","return",115],";",["T_WHITESPACE","\n        ",115],"}",["T_WHITESPACE","\n\n        ",116],["T_IF","if",118],["T_WHITESPACE"," ",118],"(",["T_STRING","null",118],["T_WHITESPACE"," ",118],["T_IS_NOT_IDENTICAL","!==",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","logger",118],")",["T_WHITESPACE"," ",118],"{",["T_WHITESPACE","\n            ",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","logger",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","info",119],"(",["T_CONSTANT_ENCAPSED_STRING","'Digest authentication successful.'",119],",",["T_WHITESPACE"," ",119],["T_ARRAY","array",119],"(",["T_CONSTANT_ENCAPSED_STRING","'username'",119],["T_WHITESPACE"," ",119],["T_DOUBLE_ARROW","=>",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$digestAuth",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getUsername",119],"(",")",",",["T_WHITESPACE"," ",119],["T_CONSTANT_ENCAPSED_STRING","'received'",119],["T_WHITESPACE"," ",119],["T_DOUBLE_ARROW","=>",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$digestAuth",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getResponse",119],"(",")",")",")",";",["T_WHITESPACE","\n        ",119],"}",["T_WHITESPACE","\n\n        ",120],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","tokenStorage",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","setToken",122],"(",["T_NEW","new",122],["T_WHITESPACE"," ",122],["T_STRING","UsernamePasswordToken",122],"(",["T_VARIABLE","$user",122],",",["T_WHITESPACE"," ",122],["T_VARIABLE","$user",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","getPassword",122],"(",")",",",["T_WHITESPACE"," ",122],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","providerKey",122],")",")",";",["T_WHITESPACE","\n    ",122],"}",["T_WHITESPACE","\n\n    ",123],["T_PRIVATE","private",125],["T_WHITESPACE"," ",125],["T_FUNCTION","function",125],["T_WHITESPACE"," ",125],["T_STRING","fail",125],"(",["T_STRING","GetResponseEvent",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$event",125],",",["T_WHITESPACE"," ",125],["T_STRING","Request",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$request",125],",",["T_WHITESPACE"," ",125],["T_STRING","AuthenticationException",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$authException",125],")",["T_WHITESPACE","\n    ",125],"{",["T_WHITESPACE","\n        ",126],["T_VARIABLE","$token",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","tokenStorage",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","getToken",127],"(",")",";",["T_WHITESPACE","\n        ",127],["T_IF","if",128],["T_WHITESPACE"," ",128],"(",["T_VARIABLE","$token",128],["T_WHITESPACE"," ",128],["T_INSTANCEOF","instanceof",128],["T_WHITESPACE"," ",128],["T_STRING","UsernamePasswordToken",128],["T_WHITESPACE"," ",128],["T_BOOLEAN_AND","&&",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","providerKey",128],["T_WHITESPACE"," ",128],["T_IS_IDENTICAL","===",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$token",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","getProviderKey",128],"(",")",")",["T_WHITESPACE"," ",128],"{",["T_WHITESPACE","\n            ",128],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","tokenStorage",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","setToken",129],"(",["T_STRING","null",129],")",";",["T_WHITESPACE","\n        ",129],"}",["T_WHITESPACE","\n\n        ",130],["T_IF","if",132],["T_WHITESPACE"," ",132],"(",["T_STRING","null",132],["T_WHITESPACE"," ",132],["T_IS_NOT_IDENTICAL","!==",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","logger",132],")",["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n            ",132],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","logger",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","info",133],"(",["T_CONSTANT_ENCAPSED_STRING","'Digest authentication failed.'",133],",",["T_WHITESPACE"," ",133],["T_ARRAY","array",133],"(",["T_CONSTANT_ENCAPSED_STRING","'exception'",133],["T_WHITESPACE"," ",133],["T_DOUBLE_ARROW","=>",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$authException",133],")",")",";",["T_WHITESPACE","\n        ",133],"}",["T_WHITESPACE","\n\n        ",134],["T_VARIABLE","$event",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","setResponse",136],"(",["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","authenticationEntryPoint",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","start",136],"(",["T_VARIABLE","$request",136],",",["T_WHITESPACE"," ",136],["T_VARIABLE","$authException",136],")",")",";",["T_WHITESPACE","\n    ",136],"}",["T_WHITESPACE","\n",137],"}",["T_WHITESPACE","\n\n",138],["T_CLASS","class",140],["T_WHITESPACE"," ",140],["T_STRING","DigestData",140],["T_WHITESPACE","\n",140],"{",["T_WHITESPACE","\n    ",141],["T_PRIVATE","private",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$elements",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_ARRAY","array",142],"(",")",";",["T_WHITESPACE","\n    ",142],["T_PRIVATE","private",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$header",143],";",["T_WHITESPACE","\n    ",143],["T_PRIVATE","private",144],["T_WHITESPACE"," ",144],["T_VARIABLE","$nonceExpiryTime",144],";",["T_WHITESPACE","\n\n    ",144],["T_PUBLIC","public",146],["T_WHITESPACE"," ",146],["T_FUNCTION","function",146],["T_WHITESPACE"," ",146],["T_STRING","__construct",146],"(",["T_VARIABLE","$header",146],")",["T_WHITESPACE","\n    ",146],"{",["T_WHITESPACE","\n        ",147],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","header",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_VARIABLE","$header",148],";",["T_WHITESPACE","\n        ",148],["T_STRING","preg_match_all",149],"(",["T_CONSTANT_ENCAPSED_STRING","'\/(\\w+)=(\"((?:[^\"\\\\\\\\]|\\\\\\\\.)+)\"|([^\\s,$]+))\/'",149],",",["T_WHITESPACE"," ",149],["T_VARIABLE","$header",149],",",["T_WHITESPACE"," ",149],["T_VARIABLE","$matches",149],",",["T_WHITESPACE"," ",149],["T_STRING","PREG_SET_ORDER",149],")",";",["T_WHITESPACE","\n        ",149],["T_FOREACH","foreach",150],["T_WHITESPACE"," ",150],"(",["T_VARIABLE","$matches",150],["T_WHITESPACE"," ",150],["T_AS","as",150],["T_WHITESPACE"," ",150],["T_VARIABLE","$match",150],")",["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n            ",150],["T_IF","if",151],["T_WHITESPACE"," ",151],"(",["T_ISSET","isset",151],"(",["T_VARIABLE","$match",151],"[",["T_LNUMBER","1",151],"]",")",["T_WHITESPACE"," ",151],["T_BOOLEAN_AND","&&",151],["T_WHITESPACE"," ",151],["T_ISSET","isset",151],"(",["T_VARIABLE","$match",151],"[",["T_LNUMBER","3",151],"]",")",")",["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n                ",151],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","elements",152],"[",["T_VARIABLE","$match",152],"[",["T_LNUMBER","1",152],"]","]",["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_ISSET","isset",152],"(",["T_VARIABLE","$match",152],"[",["T_LNUMBER","4",152],"]",")",["T_WHITESPACE"," ",152],"?",["T_WHITESPACE"," ",152],["T_VARIABLE","$match",152],"[",["T_LNUMBER","4",152],"]",["T_WHITESPACE"," ",152],":",["T_WHITESPACE"," ",152],["T_VARIABLE","$match",152],"[",["T_LNUMBER","3",152],"]",";",["T_WHITESPACE","\n            ",152],"}",["T_WHITESPACE","\n        ",153],"}",["T_WHITESPACE","\n    ",154],"}",["T_WHITESPACE","\n\n    ",155],["T_PUBLIC","public",157],["T_WHITESPACE"," ",157],["T_FUNCTION","function",157],["T_WHITESPACE"," ",157],["T_STRING","getResponse",157],"(",")",["T_WHITESPACE","\n    ",157],"{",["T_WHITESPACE","\n        ",158],["T_RETURN","return",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","elements",159],"[",["T_CONSTANT_ENCAPSED_STRING","'response'",159],"]",";",["T_WHITESPACE","\n    ",159],"}",["T_WHITESPACE","\n\n    ",160],["T_PUBLIC","public",162],["T_WHITESPACE"," ",162],["T_FUNCTION","function",162],["T_WHITESPACE"," ",162],["T_STRING","getUsername",162],"(",")",["T_WHITESPACE","\n    ",162],"{",["T_WHITESPACE","\n        ",163],["T_RETURN","return",164],["T_WHITESPACE"," ",164],["T_STRING","strtr",164],"(",["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","elements",164],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",164],"]",",",["T_WHITESPACE"," ",164],["T_ARRAY","array",164],"(",["T_CONSTANT_ENCAPSED_STRING","'\\\\\"'",164],["T_WHITESPACE"," ",164],["T_DOUBLE_ARROW","=>",164],["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","'\"'",164],",",["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","'\\\\\\\\'",164],["T_WHITESPACE"," ",164],["T_DOUBLE_ARROW","=>",164],["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","'\\\\'",164],")",")",";",["T_WHITESPACE","\n    ",164],"}",["T_WHITESPACE","\n\n    ",165],["T_PUBLIC","public",167],["T_WHITESPACE"," ",167],["T_FUNCTION","function",167],["T_WHITESPACE"," ",167],["T_STRING","validateAndDecode",167],"(",["T_VARIABLE","$entryPointKey",167],",",["T_WHITESPACE"," ",167],["T_VARIABLE","$expectedRealm",167],")",["T_WHITESPACE","\n    ",167],"{",["T_WHITESPACE","\n        ",168],["T_IF","if",169],["T_WHITESPACE"," ",169],"(",["T_VARIABLE","$keys",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_STRING","array_diff",169],"(",["T_ARRAY","array",169],"(",["T_CONSTANT_ENCAPSED_STRING","'username'",169],",",["T_WHITESPACE"," ",169],["T_CONSTANT_ENCAPSED_STRING","'realm'",169],",",["T_WHITESPACE"," ",169],["T_CONSTANT_ENCAPSED_STRING","'nonce'",169],",",["T_WHITESPACE"," ",169],["T_CONSTANT_ENCAPSED_STRING","'uri'",169],",",["T_WHITESPACE"," ",169],["T_CONSTANT_ENCAPSED_STRING","'response'",169],")",",",["T_WHITESPACE"," ",169],["T_STRING","array_keys",169],"(",["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","elements",169],")",")",")",["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n            ",169],["T_THROW","throw",170],["T_WHITESPACE"," ",170],["T_NEW","new",170],["T_WHITESPACE"," ",170],["T_STRING","BadCredentialsException",170],"(",["T_STRING","sprintf",170],"(",["T_CONSTANT_ENCAPSED_STRING","'Missing mandatory digest value; received header \"%s\" (%s)'",170],",",["T_WHITESPACE"," ",170],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","header",170],",",["T_WHITESPACE"," ",170],["T_STRING","implode",170],"(",["T_CONSTANT_ENCAPSED_STRING","', '",170],",",["T_WHITESPACE"," ",170],["T_VARIABLE","$keys",170],")",")",")",";",["T_WHITESPACE","\n        ",170],"}",["T_WHITESPACE","\n\n        ",171],["T_IF","if",173],["T_WHITESPACE"," ",173],"(",["T_CONSTANT_ENCAPSED_STRING","'auth'",173],["T_WHITESPACE"," ",173],["T_IS_IDENTICAL","===",173],["T_WHITESPACE"," ",173],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","elements",173],"[",["T_CONSTANT_ENCAPSED_STRING","'qop'",173],"]",["T_WHITESPACE"," ",173],["T_BOOLEAN_AND","&&",173],["T_WHITESPACE"," ",173],"!",["T_ISSET","isset",173],"(",["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","elements",173],"[",["T_CONSTANT_ENCAPSED_STRING","'nc'",173],"]",",",["T_WHITESPACE"," ",173],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","elements",173],"[",["T_CONSTANT_ENCAPSED_STRING","'cnonce'",173],"]",")",")",["T_WHITESPACE"," ",173],"{",["T_WHITESPACE","\n            ",173],["T_THROW","throw",174],["T_WHITESPACE"," ",174],["T_NEW","new",174],["T_WHITESPACE"," ",174],["T_STRING","BadCredentialsException",174],"(",["T_STRING","sprintf",174],"(",["T_CONSTANT_ENCAPSED_STRING","'Missing mandatory digest value; received header \"%s\"'",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","header",174],")",")",";",["T_WHITESPACE","\n        ",174],"}",["T_WHITESPACE","\n\n        ",175],["T_IF","if",177],["T_WHITESPACE"," ",177],"(",["T_VARIABLE","$expectedRealm",177],["T_WHITESPACE"," ",177],["T_IS_NOT_IDENTICAL","!==",177],["T_WHITESPACE"," ",177],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","elements",177],"[",["T_CONSTANT_ENCAPSED_STRING","'realm'",177],"]",")",["T_WHITESPACE"," ",177],"{",["T_WHITESPACE","\n            ",177],["T_THROW","throw",178],["T_WHITESPACE"," ",178],["T_NEW","new",178],["T_WHITESPACE"," ",178],["T_STRING","BadCredentialsException",178],"(",["T_STRING","sprintf",178],"(",["T_CONSTANT_ENCAPSED_STRING","'Response realm name \"%s\" does not match system realm name of \"%s\".'",178],",",["T_WHITESPACE"," ",178],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","elements",178],"[",["T_CONSTANT_ENCAPSED_STRING","'realm'",178],"]",",",["T_WHITESPACE"," ",178],["T_VARIABLE","$expectedRealm",178],")",")",";",["T_WHITESPACE","\n        ",178],"}",["T_WHITESPACE","\n\n        ",179],["T_IF","if",181],["T_WHITESPACE"," ",181],"(",["T_STRING","false",181],["T_WHITESPACE"," ",181],["T_IS_IDENTICAL","===",181],["T_WHITESPACE"," ",181],["T_VARIABLE","$nonceAsPlainText",181],["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_STRING","base64_decode",181],"(",["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","elements",181],"[",["T_CONSTANT_ENCAPSED_STRING","'nonce'",181],"]",")",")",["T_WHITESPACE"," ",181],"{",["T_WHITESPACE","\n            ",181],["T_THROW","throw",182],["T_WHITESPACE"," ",182],["T_NEW","new",182],["T_WHITESPACE"," ",182],["T_STRING","BadCredentialsException",182],"(",["T_STRING","sprintf",182],"(",["T_CONSTANT_ENCAPSED_STRING","'Nonce is not encoded in Base64; received nonce \"%s\".'",182],",",["T_WHITESPACE"," ",182],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","elements",182],"[",["T_CONSTANT_ENCAPSED_STRING","'nonce'",182],"]",")",")",";",["T_WHITESPACE","\n        ",182],"}",["T_WHITESPACE","\n\n        ",183],["T_VARIABLE","$nonceTokens",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_STRING","explode",185],"(",["T_CONSTANT_ENCAPSED_STRING","':'",185],",",["T_WHITESPACE"," ",185],["T_VARIABLE","$nonceAsPlainText",185],")",";",["T_WHITESPACE","\n\n        ",185],["T_IF","if",187],["T_WHITESPACE"," ",187],"(",["T_LNUMBER","2",187],["T_WHITESPACE"," ",187],["T_IS_NOT_IDENTICAL","!==",187],["T_WHITESPACE"," ",187],["T_STRING","count",187],"(",["T_VARIABLE","$nonceTokens",187],")",")",["T_WHITESPACE"," ",187],"{",["T_WHITESPACE","\n            ",187],["T_THROW","throw",188],["T_WHITESPACE"," ",188],["T_NEW","new",188],["T_WHITESPACE"," ",188],["T_STRING","BadCredentialsException",188],"(",["T_STRING","sprintf",188],"(",["T_CONSTANT_ENCAPSED_STRING","'Nonce should have yielded two tokens but was \"%s\".'",188],",",["T_WHITESPACE"," ",188],["T_VARIABLE","$nonceAsPlainText",188],")",")",";",["T_WHITESPACE","\n        ",188],"}",["T_WHITESPACE","\n\n        ",189],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","nonceExpiryTime",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_VARIABLE","$nonceTokens",191],"[",["T_LNUMBER","0",191],"]",";",["T_WHITESPACE","\n\n        ",191],["T_IF","if",193],["T_WHITESPACE"," ",193],"(",["T_STRING","md5",193],"(",["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","nonceExpiryTime",193],".",["T_CONSTANT_ENCAPSED_STRING","':'",193],".",["T_VARIABLE","$entryPointKey",193],")",["T_WHITESPACE"," ",193],["T_IS_NOT_IDENTICAL","!==",193],["T_WHITESPACE"," ",193],["T_VARIABLE","$nonceTokens",193],"[",["T_LNUMBER","1",193],"]",")",["T_WHITESPACE"," ",193],"{",["T_WHITESPACE","\n            ",193],["T_THROW","throw",194],["T_WHITESPACE"," ",194],["T_NEW","new",194],["T_WHITESPACE"," ",194],["T_STRING","BadCredentialsException",194],"(",["T_STRING","sprintf",194],"(",["T_CONSTANT_ENCAPSED_STRING","'Nonce token compromised \"%s\".'",194],",",["T_WHITESPACE"," ",194],["T_VARIABLE","$nonceAsPlainText",194],")",")",";",["T_WHITESPACE","\n        ",194],"}",["T_WHITESPACE","\n    ",195],"}",["T_WHITESPACE","\n\n    ",196],["T_PUBLIC","public",198],["T_WHITESPACE"," ",198],["T_FUNCTION","function",198],["T_WHITESPACE"," ",198],["T_STRING","calculateServerDigest",198],"(",["T_VARIABLE","$password",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$httpMethod",198],")",["T_WHITESPACE","\n    ",198],"{",["T_WHITESPACE","\n        ",199],["T_VARIABLE","$a2Md5",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_STRING","md5",200],"(",["T_STRING","strtoupper",200],"(",["T_VARIABLE","$httpMethod",200],")",".",["T_CONSTANT_ENCAPSED_STRING","':'",200],".",["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","elements",200],"[",["T_CONSTANT_ENCAPSED_STRING","'uri'",200],"]",")",";",["T_WHITESPACE","\n        ",200],["T_VARIABLE","$a1Md5",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_STRING","md5",201],"(",["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","elements",201],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",201],"]",".",["T_CONSTANT_ENCAPSED_STRING","':'",201],".",["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","elements",201],"[",["T_CONSTANT_ENCAPSED_STRING","'realm'",201],"]",".",["T_CONSTANT_ENCAPSED_STRING","':'",201],".",["T_VARIABLE","$password",201],")",";",["T_WHITESPACE","\n\n        ",201],["T_VARIABLE","$digest",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_VARIABLE","$a1Md5",203],".",["T_CONSTANT_ENCAPSED_STRING","':'",203],".",["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","elements",203],"[",["T_CONSTANT_ENCAPSED_STRING","'nonce'",203],"]",";",["T_WHITESPACE","\n        ",203],["T_IF","if",204],["T_WHITESPACE"," ",204],"(","!",["T_ISSET","isset",204],"(",["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","elements",204],"[",["T_CONSTANT_ENCAPSED_STRING","'qop'",204],"]",")",")",["T_WHITESPACE"," ",204],"{",["T_WHITESPACE","\n        ",204],"}",["T_WHITESPACE"," ",205],["T_ELSEIF","elseif",205],["T_WHITESPACE"," ",205],"(",["T_CONSTANT_ENCAPSED_STRING","'auth'",205],["T_WHITESPACE"," ",205],["T_IS_IDENTICAL","===",205],["T_WHITESPACE"," ",205],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","elements",205],"[",["T_CONSTANT_ENCAPSED_STRING","'qop'",205],"]",")",["T_WHITESPACE"," ",205],"{",["T_WHITESPACE","\n            ",205],["T_VARIABLE","$digest",206],["T_WHITESPACE"," ",206],["T_CONCAT_EQUAL",".=",206],["T_WHITESPACE"," ",206],["T_CONSTANT_ENCAPSED_STRING","':'",206],".",["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","elements",206],"[",["T_CONSTANT_ENCAPSED_STRING","'nc'",206],"]",".",["T_CONSTANT_ENCAPSED_STRING","':'",206],".",["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","elements",206],"[",["T_CONSTANT_ENCAPSED_STRING","'cnonce'",206],"]",".",["T_CONSTANT_ENCAPSED_STRING","':'",206],".",["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","elements",206],"[",["T_CONSTANT_ENCAPSED_STRING","'qop'",206],"]",";",["T_WHITESPACE","\n        ",206],"}",["T_WHITESPACE"," ",207],["T_ELSE","else",207],["T_WHITESPACE"," ",207],"{",["T_WHITESPACE","\n            ",207],["T_THROW","throw",208],["T_WHITESPACE"," ",208],["T_NEW","new",208],["T_WHITESPACE"," ",208],["T_NS_SEPARATOR","\\",208],["T_STRING","InvalidArgumentException",208],"(",["T_CONSTANT_ENCAPSED_STRING","'This method does not support a qop: \"%s\".'",208],",",["T_WHITESPACE"," ",208],["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","elements",208],"[",["T_CONSTANT_ENCAPSED_STRING","'qop'",208],"]",")",";",["T_WHITESPACE","\n        ",208],"}",["T_WHITESPACE","\n        ",209],["T_VARIABLE","$digest",210],["T_WHITESPACE"," ",210],["T_CONCAT_EQUAL",".=",210],["T_WHITESPACE"," ",210],["T_CONSTANT_ENCAPSED_STRING","':'",210],".",["T_VARIABLE","$a2Md5",210],";",["T_WHITESPACE","\n\n        ",210],["T_RETURN","return",212],["T_WHITESPACE"," ",212],["T_STRING","md5",212],"(",["T_VARIABLE","$digest",212],")",";",["T_WHITESPACE","\n    ",212],"}",["T_WHITESPACE","\n\n    ",213],["T_PUBLIC","public",215],["T_WHITESPACE"," ",215],["T_FUNCTION","function",215],["T_WHITESPACE"," ",215],["T_STRING","isNonceExpired",215],"(",")",["T_WHITESPACE","\n    ",215],"{",["T_WHITESPACE","\n        ",216],["T_RETURN","return",217],["T_WHITESPACE"," ",217],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","nonceExpiryTime",217],["T_WHITESPACE"," ",217],"<",["T_WHITESPACE"," ",217],["T_STRING","microtime",217],"(",["T_STRING","true",217],")",";",["T_WHITESPACE","\n    ",217],"}",["T_WHITESPACE","\n",218],"}",["T_WHITESPACE","\n",219]]