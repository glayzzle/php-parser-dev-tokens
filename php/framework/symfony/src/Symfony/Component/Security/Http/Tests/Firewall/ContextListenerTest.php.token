[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Security",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Http",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Tests",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Firewall",12],";",["T_WHITESPACE","\n\n",12],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Symfony",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Component",14],["T_NS_SEPARATOR","\\",14],["T_STRING","HttpFoundation",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Request",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Symfony",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Component",15],["T_NS_SEPARATOR","\\",15],["T_STRING","HttpFoundation",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Response",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Symfony",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Component",16],["T_NS_SEPARATOR","\\",16],["T_STRING","HttpFoundation",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Session",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Session",16],";",["T_WHITESPACE","\n",16],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Symfony",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Component",17],["T_NS_SEPARATOR","\\",17],["T_STRING","HttpFoundation",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Session",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Storage",17],["T_NS_SEPARATOR","\\",17],["T_STRING","MockArraySessionStorage",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Symfony",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Component",18],["T_NS_SEPARATOR","\\",18],["T_STRING","HttpKernel",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Event",18],["T_NS_SEPARATOR","\\",18],["T_STRING","FilterResponseEvent",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Symfony",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Component",19],["T_NS_SEPARATOR","\\",19],["T_STRING","HttpKernel",19],["T_NS_SEPARATOR","\\",19],["T_STRING","HttpKernelInterface",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Symfony",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Component",20],["T_NS_SEPARATOR","\\",20],["T_STRING","HttpKernel",20],["T_NS_SEPARATOR","\\",20],["T_STRING","KernelEvents",20],";",["T_WHITESPACE","\n",20],["T_USE","use",21],["T_WHITESPACE"," ",21],["T_STRING","Symfony",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Component",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Security",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Core",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Authentication",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Token",21],["T_NS_SEPARATOR","\\",21],["T_STRING","AnonymousToken",21],";",["T_WHITESPACE","\n",21],["T_USE","use",22],["T_WHITESPACE"," ",22],["T_STRING","Symfony",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Component",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Security",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Core",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Authentication",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Token",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Storage",22],["T_NS_SEPARATOR","\\",22],["T_STRING","TokenStorage",22],";",["T_WHITESPACE","\n",22],["T_USE","use",23],["T_WHITESPACE"," ",23],["T_STRING","Symfony",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Component",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Security",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Core",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Authentication",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Token",23],["T_NS_SEPARATOR","\\",23],["T_STRING","UsernamePasswordToken",23],";",["T_WHITESPACE","\n",23],["T_USE","use",24],["T_WHITESPACE"," ",24],["T_STRING","Symfony",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Component",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Security",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Http",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Firewall",24],["T_NS_SEPARATOR","\\",24],["T_STRING","ContextListener",24],";",["T_WHITESPACE","\n",24],["T_USE","use",25],["T_WHITESPACE"," ",25],["T_STRING","Symfony",25],["T_NS_SEPARATOR","\\",25],["T_STRING","Component",25],["T_NS_SEPARATOR","\\",25],["T_STRING","EventDispatcher",25],["T_NS_SEPARATOR","\\",25],["T_STRING","EventDispatcher",25],";",["T_WHITESPACE","\n\n",25],["T_CLASS","class",27],["T_WHITESPACE"," ",27],["T_STRING","ContextListenerTest",27],["T_WHITESPACE"," ",27],["T_EXTENDS","extends",27],["T_WHITESPACE"," ",27],["T_NS_SEPARATOR","\\",27],["T_STRING","PHPUnit_Framework_TestCase",27],["T_WHITESPACE","\n",27],"{",["T_WHITESPACE","\n    ",28],["T_DOC_COMMENT","\/**\n     * @expectedException \\InvalidArgumentException\n     * @expectedExceptionMessage $contextKey must not be empty\n     *\/",29],["T_WHITESPACE","\n    ",32],["T_PUBLIC","public",33],["T_WHITESPACE"," ",33],["T_FUNCTION","function",33],["T_WHITESPACE"," ",33],["T_STRING","testItRequiresContextKey",33],"(",")",["T_WHITESPACE","\n    ",33],"{",["T_WHITESPACE","\n        ",34],["T_NEW","new",35],["T_WHITESPACE"," ",35],["T_STRING","ContextListener",35],"(",["T_WHITESPACE","\n            ",35],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","getMockBuilder",36],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Core\\Authentication\\Token\\Storage\\TokenStorageInterface'",36],")",["T_OBJECT_OPERATOR","->",36],["T_STRING","getMock",36],"(",")",",",["T_WHITESPACE","\n            ",36],["T_ARRAY","array",37],"(",")",",",["T_WHITESPACE","\n            ",37],["T_CONSTANT_ENCAPSED_STRING","''",38],["T_WHITESPACE","\n        ",38],")",";",["T_WHITESPACE","\n    ",39],"}",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/**\n     * @expectedException \\InvalidArgumentException\n     * @expectedExceptionMessage User provider \"stdClass\" must implement \"Symfony\\Component\\Security\\Core\\User\\UserProviderInterface\n     *\/",42],["T_WHITESPACE","\n    ",45],["T_PUBLIC","public",46],["T_WHITESPACE"," ",46],["T_FUNCTION","function",46],["T_WHITESPACE"," ",46],["T_STRING","testUserProvidersNeedToImplementAnInterface",46],"(",")",["T_WHITESPACE","\n    ",46],"{",["T_WHITESPACE","\n        ",47],["T_NEW","new",48],["T_WHITESPACE"," ",48],["T_STRING","ContextListener",48],"(",["T_WHITESPACE","\n            ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","getMockBuilder",49],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Core\\Authentication\\Token\\Storage\\TokenStorageInterface'",49],")",["T_OBJECT_OPERATOR","->",49],["T_STRING","getMock",49],"(",")",",",["T_WHITESPACE","\n            ",49],["T_ARRAY","array",50],"(",["T_NEW","new",50],["T_WHITESPACE"," ",50],["T_NS_SEPARATOR","\\",50],["T_STRING","stdClass",50],"(",")",")",",",["T_WHITESPACE","\n            ",50],["T_CONSTANT_ENCAPSED_STRING","'key123'",51],["T_WHITESPACE","\n        ",51],")",";",["T_WHITESPACE","\n    ",52],"}",["T_WHITESPACE","\n\n    ",53],["T_PUBLIC","public",55],["T_WHITESPACE"," ",55],["T_FUNCTION","function",55],["T_WHITESPACE"," ",55],["T_STRING","testOnKernelResponseWillAddSession",55],"(",")",["T_WHITESPACE","\n    ",55],"{",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$session",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","runSessionOnKernelResponse",57],"(",["T_WHITESPACE","\n            ",57],["T_NEW","new",58],["T_WHITESPACE"," ",58],["T_STRING","UsernamePasswordToken",58],"(",["T_CONSTANT_ENCAPSED_STRING","'test1'",58],",",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'pass1'",58],",",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'phpunit'",58],")",",",["T_WHITESPACE","\n            ",58],["T_STRING","null",59],["T_WHITESPACE","\n        ",59],")",";",["T_WHITESPACE","\n\n        ",60],["T_VARIABLE","$token",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_STRING","unserialize",62],"(",["T_VARIABLE","$session",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","get",62],"(",["T_CONSTANT_ENCAPSED_STRING","'_security_session'",62],")",")",";",["T_WHITESPACE","\n        ",62],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","assertInstanceOf",63],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Core\\Authentication\\Token\\UsernamePasswordToken'",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$token",63],")",";",["T_WHITESPACE","\n        ",63],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","assertEquals",64],"(",["T_CONSTANT_ENCAPSED_STRING","'test1'",64],",",["T_WHITESPACE"," ",64],["T_VARIABLE","$token",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","getUsername",64],"(",")",")",";",["T_WHITESPACE","\n    ",64],"}",["T_WHITESPACE","\n\n    ",65],["T_PUBLIC","public",67],["T_WHITESPACE"," ",67],["T_FUNCTION","function",67],["T_WHITESPACE"," ",67],["T_STRING","testOnKernelResponseWillReplaceSession",67],"(",")",["T_WHITESPACE","\n    ",67],"{",["T_WHITESPACE","\n        ",68],["T_VARIABLE","$session",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","runSessionOnKernelResponse",69],"(",["T_WHITESPACE","\n            ",69],["T_NEW","new",70],["T_WHITESPACE"," ",70],["T_STRING","UsernamePasswordToken",70],"(",["T_CONSTANT_ENCAPSED_STRING","'test1'",70],",",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'pass1'",70],",",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'phpunit'",70],")",",",["T_WHITESPACE","\n            ",70],["T_CONSTANT_ENCAPSED_STRING","'C:10:\"serialized\"'",71],["T_WHITESPACE","\n        ",71],")",";",["T_WHITESPACE","\n\n        ",72],["T_VARIABLE","$token",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_STRING","unserialize",74],"(",["T_VARIABLE","$session",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","get",74],"(",["T_CONSTANT_ENCAPSED_STRING","'_security_session'",74],")",")",";",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","assertInstanceOf",75],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Core\\Authentication\\Token\\UsernamePasswordToken'",75],",",["T_WHITESPACE"," ",75],["T_VARIABLE","$token",75],")",";",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","assertEquals",76],"(",["T_CONSTANT_ENCAPSED_STRING","'test1'",76],",",["T_WHITESPACE"," ",76],["T_VARIABLE","$token",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getUsername",76],"(",")",")",";",["T_WHITESPACE","\n    ",76],"}",["T_WHITESPACE","\n\n    ",77],["T_PUBLIC","public",79],["T_WHITESPACE"," ",79],["T_FUNCTION","function",79],["T_WHITESPACE"," ",79],["T_STRING","testOnKernelResponseWillRemoveSession",79],"(",")",["T_WHITESPACE","\n    ",79],"{",["T_WHITESPACE","\n        ",80],["T_VARIABLE","$session",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","runSessionOnKernelResponse",81],"(",["T_WHITESPACE","\n            ",81],["T_STRING","null",82],",",["T_WHITESPACE","\n            ",82],["T_CONSTANT_ENCAPSED_STRING","'C:10:\"serialized\"'",83],["T_WHITESPACE","\n        ",83],")",";",["T_WHITESPACE","\n\n        ",84],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","assertFalse",86],"(",["T_VARIABLE","$session",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","has",86],"(",["T_CONSTANT_ENCAPSED_STRING","'_security_session'",86],")",")",";",["T_WHITESPACE","\n    ",86],"}",["T_WHITESPACE","\n\n    ",87],["T_PUBLIC","public",89],["T_WHITESPACE"," ",89],["T_FUNCTION","function",89],["T_WHITESPACE"," ",89],["T_STRING","testOnKernelResponseWillRemoveSessionOnAnonymousToken",89],"(",")",["T_WHITESPACE","\n    ",89],"{",["T_WHITESPACE","\n        ",90],["T_VARIABLE","$session",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","runSessionOnKernelResponse",91],"(",["T_NEW","new",91],["T_WHITESPACE"," ",91],["T_STRING","AnonymousToken",91],"(",["T_CONSTANT_ENCAPSED_STRING","'secret'",91],",",["T_WHITESPACE"," ",91],["T_CONSTANT_ENCAPSED_STRING","'anon.'",91],")",",",["T_WHITESPACE"," ",91],["T_CONSTANT_ENCAPSED_STRING","'C:10:\"serialized\"'",91],")",";",["T_WHITESPACE","\n\n        ",91],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","assertFalse",93],"(",["T_VARIABLE","$session",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","has",93],"(",["T_CONSTANT_ENCAPSED_STRING","'_security_session'",93],")",")",";",["T_WHITESPACE","\n    ",93],"}",["T_WHITESPACE","\n\n    ",94],["T_PUBLIC","public",96],["T_WHITESPACE"," ",96],["T_FUNCTION","function",96],["T_WHITESPACE"," ",96],["T_STRING","testOnKernelResponseWithoutSession",96],"(",")",["T_WHITESPACE","\n    ",96],"{",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$tokenStorage",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_NEW","new",98],["T_WHITESPACE"," ",98],["T_STRING","TokenStorage",98],"(",")",";",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$tokenStorage",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","setToken",99],"(",["T_NEW","new",99],["T_WHITESPACE"," ",99],["T_STRING","UsernamePasswordToken",99],"(",["T_CONSTANT_ENCAPSED_STRING","'test1'",99],",",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","'pass1'",99],",",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","'phpunit'",99],")",")",";",["T_WHITESPACE","\n        ",99],["T_VARIABLE","$request",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_NEW","new",100],["T_WHITESPACE"," ",100],["T_STRING","Request",100],"(",")",";",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$session",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_NEW","new",101],["T_WHITESPACE"," ",101],["T_STRING","Session",101],"(",["T_NEW","new",101],["T_WHITESPACE"," ",101],["T_STRING","MockArraySessionStorage",101],"(",")",")",";",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$request",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","setSession",102],"(",["T_VARIABLE","$session",102],")",";",["T_WHITESPACE","\n\n        ",102],["T_VARIABLE","$event",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_NEW","new",104],["T_WHITESPACE"," ",104],["T_STRING","FilterResponseEvent",104],"(",["T_WHITESPACE","\n            ",104],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getMockBuilder",105],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\HttpKernel\\HttpKernelInterface'",105],")",["T_OBJECT_OPERATOR","->",105],["T_STRING","getMock",105],"(",")",",",["T_WHITESPACE","\n            ",105],["T_VARIABLE","$request",106],",",["T_WHITESPACE","\n            ",106],["T_STRING","HttpKernelInterface",107],["T_DOUBLE_COLON","::",107],["T_STRING","MASTER_REQUEST",107],",",["T_WHITESPACE","\n            ",107],["T_NEW","new",108],["T_WHITESPACE"," ",108],["T_STRING","Response",108],"(",")",["T_WHITESPACE","\n        ",108],")",";",["T_WHITESPACE","\n\n        ",109],["T_VARIABLE","$listener",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_NEW","new",111],["T_WHITESPACE"," ",111],["T_STRING","ContextListener",111],"(",["T_VARIABLE","$tokenStorage",111],",",["T_WHITESPACE"," ",111],["T_ARRAY","array",111],"(",")",",",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","'session'",111],",",["T_WHITESPACE"," ",111],["T_STRING","null",111],",",["T_WHITESPACE"," ",111],["T_NEW","new",111],["T_WHITESPACE"," ",111],["T_STRING","EventDispatcher",111],"(",")",")",";",["T_WHITESPACE","\n        ",111],["T_VARIABLE","$listener",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","onKernelResponse",112],"(",["T_VARIABLE","$event",112],")",";",["T_WHITESPACE","\n\n        ",112],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","assertTrue",114],"(",["T_VARIABLE","$session",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","isStarted",114],"(",")",")",";",["T_WHITESPACE","\n    ",114],"}",["T_WHITESPACE","\n\n    ",115],["T_PUBLIC","public",117],["T_WHITESPACE"," ",117],["T_FUNCTION","function",117],["T_WHITESPACE"," ",117],["T_STRING","testOnKernelResponseWithoutSessionNorToken",117],"(",")",["T_WHITESPACE","\n    ",117],"{",["T_WHITESPACE","\n        ",118],["T_VARIABLE","$request",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_NEW","new",119],["T_WHITESPACE"," ",119],["T_STRING","Request",119],"(",")",";",["T_WHITESPACE","\n        ",119],["T_VARIABLE","$session",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_NEW","new",120],["T_WHITESPACE"," ",120],["T_STRING","Session",120],"(",["T_NEW","new",120],["T_WHITESPACE"," ",120],["T_STRING","MockArraySessionStorage",120],"(",")",")",";",["T_WHITESPACE","\n        ",120],["T_VARIABLE","$request",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","setSession",121],"(",["T_VARIABLE","$session",121],")",";",["T_WHITESPACE","\n\n        ",121],["T_VARIABLE","$event",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_NEW","new",123],["T_WHITESPACE"," ",123],["T_STRING","FilterResponseEvent",123],"(",["T_WHITESPACE","\n            ",123],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","getMockBuilder",124],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\HttpKernel\\HttpKernelInterface'",124],")",["T_OBJECT_OPERATOR","->",124],["T_STRING","getMock",124],"(",")",",",["T_WHITESPACE","\n            ",124],["T_VARIABLE","$request",125],",",["T_WHITESPACE","\n            ",125],["T_STRING","HttpKernelInterface",126],["T_DOUBLE_COLON","::",126],["T_STRING","MASTER_REQUEST",126],",",["T_WHITESPACE","\n            ",126],["T_NEW","new",127],["T_WHITESPACE"," ",127],["T_STRING","Response",127],"(",")",["T_WHITESPACE","\n        ",127],")",";",["T_WHITESPACE","\n\n        ",128],["T_VARIABLE","$listener",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_NEW","new",130],["T_WHITESPACE"," ",130],["T_STRING","ContextListener",130],"(",["T_NEW","new",130],["T_WHITESPACE"," ",130],["T_STRING","TokenStorage",130],"(",")",",",["T_WHITESPACE"," ",130],["T_ARRAY","array",130],"(",")",",",["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","'session'",130],",",["T_WHITESPACE"," ",130],["T_STRING","null",130],",",["T_WHITESPACE"," ",130],["T_NEW","new",130],["T_WHITESPACE"," ",130],["T_STRING","EventDispatcher",130],"(",")",")",";",["T_WHITESPACE","\n        ",130],["T_VARIABLE","$listener",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","onKernelResponse",131],"(",["T_VARIABLE","$event",131],")",";",["T_WHITESPACE","\n\n        ",131],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","assertFalse",133],"(",["T_VARIABLE","$session",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","isStarted",133],"(",")",")",";",["T_WHITESPACE","\n    ",133],"}",["T_WHITESPACE","\n\n    ",134],["T_DOC_COMMENT","\/**\n     * @dataProvider provideInvalidToken\n     *\/",136],["T_WHITESPACE","\n    ",138],["T_PUBLIC","public",139],["T_WHITESPACE"," ",139],["T_FUNCTION","function",139],["T_WHITESPACE"," ",139],["T_STRING","testInvalidTokenInSession",139],"(",["T_VARIABLE","$token",139],")",["T_WHITESPACE","\n    ",139],"{",["T_WHITESPACE","\n        ",140],["T_VARIABLE","$tokenStorage",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getMockBuilder",141],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Core\\Authentication\\Token\\Storage\\TokenStorageInterface'",141],")",["T_OBJECT_OPERATOR","->",141],["T_STRING","getMock",141],"(",")",";",["T_WHITESPACE","\n        ",141],["T_VARIABLE","$event",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","getMockBuilder",142],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\HttpKernel\\Event\\GetResponseEvent'",142],")",["T_WHITESPACE","\n            ",142],["T_OBJECT_OPERATOR","->",143],["T_STRING","disableOriginalConstructor",143],"(",")",["T_WHITESPACE","\n            ",143],["T_OBJECT_OPERATOR","->",144],["T_STRING","getMock",144],"(",")",";",["T_WHITESPACE","\n        ",144],["T_VARIABLE","$request",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getMockBuilder",145],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\HttpFoundation\\Request'",145],")",["T_OBJECT_OPERATOR","->",145],["T_STRING","getMock",145],"(",")",";",["T_WHITESPACE","\n        ",145],["T_VARIABLE","$session",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","getMockBuilder",146],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\HttpFoundation\\Session\\SessionInterface'",146],")",["T_OBJECT_OPERATOR","->",146],["T_STRING","getMock",146],"(",")",";",["T_WHITESPACE","\n\n        ",146],["T_VARIABLE","$event",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","expects",148],"(",["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","any",148],"(",")",")",["T_WHITESPACE","\n            ",148],["T_OBJECT_OPERATOR","->",149],["T_STRING","method",149],"(",["T_CONSTANT_ENCAPSED_STRING","'getRequest'",149],")",["T_WHITESPACE","\n            ",149],["T_OBJECT_OPERATOR","->",150],["T_STRING","will",150],"(",["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","returnValue",150],"(",["T_VARIABLE","$request",150],")",")",";",["T_WHITESPACE","\n        ",150],["T_VARIABLE","$request",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","expects",151],"(",["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","any",151],"(",")",")",["T_WHITESPACE","\n            ",151],["T_OBJECT_OPERATOR","->",152],["T_STRING","method",152],"(",["T_CONSTANT_ENCAPSED_STRING","'hasPreviousSession'",152],")",["T_WHITESPACE","\n            ",152],["T_OBJECT_OPERATOR","->",153],["T_STRING","will",153],"(",["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","returnValue",153],"(",["T_STRING","true",153],")",")",";",["T_WHITESPACE","\n        ",153],["T_VARIABLE","$request",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","expects",154],"(",["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","any",154],"(",")",")",["T_WHITESPACE","\n            ",154],["T_OBJECT_OPERATOR","->",155],["T_STRING","method",155],"(",["T_CONSTANT_ENCAPSED_STRING","'getSession'",155],")",["T_WHITESPACE","\n            ",155],["T_OBJECT_OPERATOR","->",156],["T_STRING","will",156],"(",["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","returnValue",156],"(",["T_VARIABLE","$session",156],")",")",";",["T_WHITESPACE","\n        ",156],["T_VARIABLE","$session",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","expects",157],"(",["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","any",157],"(",")",")",["T_WHITESPACE","\n            ",157],["T_OBJECT_OPERATOR","->",158],["T_STRING","method",158],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",158],")",["T_WHITESPACE","\n            ",158],["T_OBJECT_OPERATOR","->",159],["T_STRING","with",159],"(",["T_CONSTANT_ENCAPSED_STRING","'_security_key123'",159],")",["T_WHITESPACE","\n            ",159],["T_OBJECT_OPERATOR","->",160],["T_STRING","will",160],"(",["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","returnValue",160],"(",["T_VARIABLE","$token",160],")",")",";",["T_WHITESPACE","\n        ",160],["T_VARIABLE","$tokenStorage",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","expects",161],"(",["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","once",161],"(",")",")",["T_WHITESPACE","\n            ",161],["T_OBJECT_OPERATOR","->",162],["T_STRING","method",162],"(",["T_CONSTANT_ENCAPSED_STRING","'setToken'",162],")",["T_WHITESPACE","\n            ",162],["T_OBJECT_OPERATOR","->",163],["T_STRING","with",163],"(",["T_STRING","null",163],")",";",["T_WHITESPACE","\n\n        ",163],["T_VARIABLE","$listener",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_NEW","new",165],["T_WHITESPACE"," ",165],["T_STRING","ContextListener",165],"(",["T_VARIABLE","$tokenStorage",165],",",["T_WHITESPACE"," ",165],["T_ARRAY","array",165],"(",")",",",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","'key123'",165],")",";",["T_WHITESPACE","\n        ",165],["T_VARIABLE","$listener",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","handle",166],"(",["T_VARIABLE","$event",166],")",";",["T_WHITESPACE","\n    ",166],"}",["T_WHITESPACE","\n\n    ",167],["T_PUBLIC","public",169],["T_WHITESPACE"," ",169],["T_FUNCTION","function",169],["T_WHITESPACE"," ",169],["T_STRING","provideInvalidToken",169],"(",")",["T_WHITESPACE","\n    ",169],"{",["T_WHITESPACE","\n        ",170],["T_RETURN","return",171],["T_WHITESPACE"," ",171],["T_ARRAY","array",171],"(",["T_WHITESPACE","\n            ",171],["T_ARRAY","array",172],"(",["T_STRING","serialize",172],"(",["T_NEW","new",172],["T_WHITESPACE"," ",172],["T_NS_SEPARATOR","\\",172],["T_STRING","__PHP_Incomplete_Class",172],"(",")",")",")",",",["T_WHITESPACE","\n            ",172],["T_ARRAY","array",173],"(",["T_STRING","serialize",173],"(",["T_STRING","null",173],")",")",",",["T_WHITESPACE","\n            ",173],["T_ARRAY","array",174],"(",["T_STRING","null",174],")",",",["T_WHITESPACE","\n        ",174],")",";",["T_WHITESPACE","\n    ",175],"}",["T_WHITESPACE","\n\n    ",176],["T_PUBLIC","public",178],["T_WHITESPACE"," ",178],["T_FUNCTION","function",178],["T_WHITESPACE"," ",178],["T_STRING","testHandleAddsKernelResponseListener",178],"(",")",["T_WHITESPACE","\n    ",178],"{",["T_WHITESPACE","\n        ",179],["T_VARIABLE","$tokenStorage",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","getMockBuilder",180],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Core\\Authentication\\Token\\Storage\\TokenStorageInterface'",180],")",["T_OBJECT_OPERATOR","->",180],["T_STRING","getMock",180],"(",")",";",["T_WHITESPACE","\n        ",180],["T_VARIABLE","$dispatcher",181],["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","getMockBuilder",181],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\EventDispatcher\\EventDispatcherInterface'",181],")",["T_OBJECT_OPERATOR","->",181],["T_STRING","getMock",181],"(",")",";",["T_WHITESPACE","\n        ",181],["T_VARIABLE","$event",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","getMockBuilder",182],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\HttpKernel\\Event\\GetResponseEvent'",182],")",["T_WHITESPACE","\n            ",182],["T_OBJECT_OPERATOR","->",183],["T_STRING","disableOriginalConstructor",183],"(",")",["T_WHITESPACE","\n            ",183],["T_OBJECT_OPERATOR","->",184],["T_STRING","getMock",184],"(",")",";",["T_WHITESPACE","\n\n        ",184],["T_VARIABLE","$listener",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_NEW","new",186],["T_WHITESPACE"," ",186],["T_STRING","ContextListener",186],"(",["T_VARIABLE","$tokenStorage",186],",",["T_WHITESPACE"," ",186],["T_ARRAY","array",186],"(",")",",",["T_WHITESPACE"," ",186],["T_CONSTANT_ENCAPSED_STRING","'key123'",186],",",["T_WHITESPACE"," ",186],["T_STRING","null",186],",",["T_WHITESPACE"," ",186],["T_VARIABLE","$dispatcher",186],")",";",["T_WHITESPACE","\n\n        ",186],["T_VARIABLE","$event",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","expects",188],"(",["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","any",188],"(",")",")",["T_WHITESPACE","\n            ",188],["T_OBJECT_OPERATOR","->",189],["T_STRING","method",189],"(",["T_CONSTANT_ENCAPSED_STRING","'isMasterRequest'",189],")",["T_WHITESPACE","\n            ",189],["T_OBJECT_OPERATOR","->",190],["T_STRING","will",190],"(",["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","returnValue",190],"(",["T_STRING","true",190],")",")",";",["T_WHITESPACE","\n        ",190],["T_VARIABLE","$event",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","expects",191],"(",["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","any",191],"(",")",")",["T_WHITESPACE","\n            ",191],["T_OBJECT_OPERATOR","->",192],["T_STRING","method",192],"(",["T_CONSTANT_ENCAPSED_STRING","'getRequest'",192],")",["T_WHITESPACE","\n            ",192],["T_OBJECT_OPERATOR","->",193],["T_STRING","will",193],"(",["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","returnValue",193],"(",["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","getMockBuilder",193],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\HttpFoundation\\Request'",193],")",["T_OBJECT_OPERATOR","->",193],["T_STRING","getMock",193],"(",")",")",")",";",["T_WHITESPACE","\n\n        ",193],["T_VARIABLE","$dispatcher",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","expects",195],"(",["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","once",195],"(",")",")",["T_WHITESPACE","\n            ",195],["T_OBJECT_OPERATOR","->",196],["T_STRING","method",196],"(",["T_CONSTANT_ENCAPSED_STRING","'addListener'",196],")",["T_WHITESPACE","\n            ",196],["T_OBJECT_OPERATOR","->",197],["T_STRING","with",197],"(",["T_STRING","KernelEvents",197],["T_DOUBLE_COLON","::",197],["T_STRING","RESPONSE",197],",",["T_WHITESPACE"," ",197],["T_ARRAY","array",197],"(",["T_VARIABLE","$listener",197],",",["T_WHITESPACE"," ",197],["T_CONSTANT_ENCAPSED_STRING","'onKernelResponse'",197],")",")",";",["T_WHITESPACE","\n\n        ",197],["T_VARIABLE","$listener",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","handle",199],"(",["T_VARIABLE","$event",199],")",";",["T_WHITESPACE","\n    ",199],"}",["T_WHITESPACE","\n\n    ",200],["T_PUBLIC","public",202],["T_WHITESPACE"," ",202],["T_FUNCTION","function",202],["T_WHITESPACE"," ",202],["T_STRING","testOnKernelResponseListenerRemovesItself",202],"(",")",["T_WHITESPACE","\n    ",202],"{",["T_WHITESPACE","\n        ",203],["T_VARIABLE","$tokenStorage",204],["T_WHITESPACE"," ",204],"=",["T_WHITESPACE"," ",204],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","getMockBuilder",204],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Core\\Authentication\\Token\\Storage\\TokenStorageInterface'",204],")",["T_OBJECT_OPERATOR","->",204],["T_STRING","getMock",204],"(",")",";",["T_WHITESPACE","\n        ",204],["T_VARIABLE","$dispatcher",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","getMockBuilder",205],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\EventDispatcher\\EventDispatcherInterface'",205],")",["T_OBJECT_OPERATOR","->",205],["T_STRING","getMock",205],"(",")",";",["T_WHITESPACE","\n        ",205],["T_VARIABLE","$event",206],["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","getMockBuilder",206],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\HttpKernel\\Event\\FilterResponseEvent'",206],")",["T_WHITESPACE","\n            ",206],["T_OBJECT_OPERATOR","->",207],["T_STRING","disableOriginalConstructor",207],"(",")",["T_WHITESPACE","\n            ",207],["T_OBJECT_OPERATOR","->",208],["T_STRING","getMock",208],"(",")",";",["T_WHITESPACE","\n\n        ",208],["T_VARIABLE","$listener",210],["T_WHITESPACE"," ",210],"=",["T_WHITESPACE"," ",210],["T_NEW","new",210],["T_WHITESPACE"," ",210],["T_STRING","ContextListener",210],"(",["T_VARIABLE","$tokenStorage",210],",",["T_WHITESPACE"," ",210],["T_ARRAY","array",210],"(",")",",",["T_WHITESPACE"," ",210],["T_CONSTANT_ENCAPSED_STRING","'key123'",210],",",["T_WHITESPACE"," ",210],["T_STRING","null",210],",",["T_WHITESPACE"," ",210],["T_VARIABLE","$dispatcher",210],")",";",["T_WHITESPACE","\n\n        ",210],["T_VARIABLE","$request",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","getMockBuilder",212],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\HttpFoundation\\Request'",212],")",["T_OBJECT_OPERATOR","->",212],["T_STRING","getMock",212],"(",")",";",["T_WHITESPACE","\n        ",212],["T_VARIABLE","$request",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","expects",213],"(",["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","any",213],"(",")",")",["T_WHITESPACE","\n            ",213],["T_OBJECT_OPERATOR","->",214],["T_STRING","method",214],"(",["T_CONSTANT_ENCAPSED_STRING","'hasSession'",214],")",["T_WHITESPACE","\n            ",214],["T_OBJECT_OPERATOR","->",215],["T_STRING","will",215],"(",["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","returnValue",215],"(",["T_STRING","true",215],")",")",";",["T_WHITESPACE","\n\n        ",215],["T_VARIABLE","$event",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","expects",217],"(",["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","any",217],"(",")",")",["T_WHITESPACE","\n            ",217],["T_OBJECT_OPERATOR","->",218],["T_STRING","method",218],"(",["T_CONSTANT_ENCAPSED_STRING","'isMasterRequest'",218],")",["T_WHITESPACE","\n            ",218],["T_OBJECT_OPERATOR","->",219],["T_STRING","will",219],"(",["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","returnValue",219],"(",["T_STRING","true",219],")",")",";",["T_WHITESPACE","\n        ",219],["T_VARIABLE","$event",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","expects",220],"(",["T_VARIABLE","$this",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","any",220],"(",")",")",["T_WHITESPACE","\n            ",220],["T_OBJECT_OPERATOR","->",221],["T_STRING","method",221],"(",["T_CONSTANT_ENCAPSED_STRING","'getRequest'",221],")",["T_WHITESPACE","\n            ",221],["T_OBJECT_OPERATOR","->",222],["T_STRING","will",222],"(",["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","returnValue",222],"(",["T_VARIABLE","$request",222],")",")",";",["T_WHITESPACE","\n\n        ",222],["T_VARIABLE","$dispatcher",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","expects",224],"(",["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","once",224],"(",")",")",["T_WHITESPACE","\n            ",224],["T_OBJECT_OPERATOR","->",225],["T_STRING","method",225],"(",["T_CONSTANT_ENCAPSED_STRING","'removeListener'",225],")",["T_WHITESPACE","\n            ",225],["T_OBJECT_OPERATOR","->",226],["T_STRING","with",226],"(",["T_STRING","KernelEvents",226],["T_DOUBLE_COLON","::",226],["T_STRING","RESPONSE",226],",",["T_WHITESPACE"," ",226],["T_ARRAY","array",226],"(",["T_VARIABLE","$listener",226],",",["T_WHITESPACE"," ",226],["T_CONSTANT_ENCAPSED_STRING","'onKernelResponse'",226],")",")",";",["T_WHITESPACE","\n\n        ",226],["T_VARIABLE","$listener",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","onKernelResponse",228],"(",["T_VARIABLE","$event",228],")",";",["T_WHITESPACE","\n    ",228],"}",["T_WHITESPACE","\n\n    ",229],["T_PUBLIC","public",231],["T_WHITESPACE"," ",231],["T_FUNCTION","function",231],["T_WHITESPACE"," ",231],["T_STRING","testHandleRemovesTokenIfNoPreviousSessionWasFound",231],"(",")",["T_WHITESPACE","\n    ",231],"{",["T_WHITESPACE","\n        ",232],["T_VARIABLE","$request",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","getMockBuilder",233],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\HttpFoundation\\Request'",233],")",["T_OBJECT_OPERATOR","->",233],["T_STRING","getMock",233],"(",")",";",["T_WHITESPACE","\n        ",233],["T_VARIABLE","$request",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","expects",234],"(",["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","any",234],"(",")",")",["T_OBJECT_OPERATOR","->",234],["T_STRING","method",234],"(",["T_CONSTANT_ENCAPSED_STRING","'hasPreviousSession'",234],")",["T_OBJECT_OPERATOR","->",234],["T_STRING","will",234],"(",["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","returnValue",234],"(",["T_STRING","false",234],")",")",";",["T_WHITESPACE","\n\n        ",234],["T_VARIABLE","$event",236],["T_WHITESPACE"," ",236],"=",["T_WHITESPACE"," ",236],["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","getMockBuilder",236],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\HttpKernel\\Event\\GetResponseEvent'",236],")",["T_WHITESPACE","\n            ",236],["T_OBJECT_OPERATOR","->",237],["T_STRING","disableOriginalConstructor",237],"(",")",["T_WHITESPACE","\n            ",237],["T_OBJECT_OPERATOR","->",238],["T_STRING","getMock",238],"(",")",";",["T_WHITESPACE","\n        ",238],["T_VARIABLE","$event",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","expects",239],"(",["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","any",239],"(",")",")",["T_OBJECT_OPERATOR","->",239],["T_STRING","method",239],"(",["T_CONSTANT_ENCAPSED_STRING","'getRequest'",239],")",["T_OBJECT_OPERATOR","->",239],["T_STRING","will",239],"(",["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","returnValue",239],"(",["T_VARIABLE","$request",239],")",")",";",["T_WHITESPACE","\n\n        ",239],["T_VARIABLE","$tokenStorage",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","getMockBuilder",241],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Core\\Authentication\\Token\\Storage\\TokenStorageInterface'",241],")",["T_OBJECT_OPERATOR","->",241],["T_STRING","getMock",241],"(",")",";",["T_WHITESPACE","\n        ",241],["T_VARIABLE","$tokenStorage",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","expects",242],"(",["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","once",242],"(",")",")",["T_OBJECT_OPERATOR","->",242],["T_STRING","method",242],"(",["T_CONSTANT_ENCAPSED_STRING","'setToken'",242],")",["T_OBJECT_OPERATOR","->",242],["T_STRING","with",242],"(",["T_STRING","null",242],")",";",["T_WHITESPACE","\n\n        ",242],["T_VARIABLE","$listener",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_NEW","new",244],["T_WHITESPACE"," ",244],["T_STRING","ContextListener",244],"(",["T_VARIABLE","$tokenStorage",244],",",["T_WHITESPACE"," ",244],["T_ARRAY","array",244],"(",")",",",["T_WHITESPACE"," ",244],["T_CONSTANT_ENCAPSED_STRING","'key123'",244],")",";",["T_WHITESPACE","\n        ",244],["T_VARIABLE","$listener",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","handle",245],"(",["T_VARIABLE","$event",245],")",";",["T_WHITESPACE","\n    ",245],"}",["T_WHITESPACE","\n\n    ",246],["T_PROTECTED","protected",248],["T_WHITESPACE"," ",248],["T_FUNCTION","function",248],["T_WHITESPACE"," ",248],["T_STRING","runSessionOnKernelResponse",248],"(",["T_VARIABLE","$newToken",248],",",["T_WHITESPACE"," ",248],["T_VARIABLE","$original",248],["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_STRING","null",248],")",["T_WHITESPACE","\n    ",248],"{",["T_WHITESPACE","\n        ",249],["T_VARIABLE","$session",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_NEW","new",250],["T_WHITESPACE"," ",250],["T_STRING","Session",250],"(",["T_NEW","new",250],["T_WHITESPACE"," ",250],["T_STRING","MockArraySessionStorage",250],"(",")",")",";",["T_WHITESPACE","\n\n        ",250],["T_IF","if",252],["T_WHITESPACE"," ",252],"(",["T_VARIABLE","$original",252],["T_WHITESPACE"," ",252],["T_IS_NOT_IDENTICAL","!==",252],["T_WHITESPACE"," ",252],["T_STRING","null",252],")",["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n            ",252],["T_VARIABLE","$session",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","set",253],"(",["T_CONSTANT_ENCAPSED_STRING","'_security_session'",253],",",["T_WHITESPACE"," ",253],["T_VARIABLE","$original",253],")",";",["T_WHITESPACE","\n        ",253],"}",["T_WHITESPACE","\n\n        ",254],["T_VARIABLE","$tokenStorage",256],["T_WHITESPACE"," ",256],"=",["T_WHITESPACE"," ",256],["T_NEW","new",256],["T_WHITESPACE"," ",256],["T_STRING","TokenStorage",256],"(",")",";",["T_WHITESPACE","\n        ",256],["T_VARIABLE","$tokenStorage",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","setToken",257],"(",["T_VARIABLE","$newToken",257],")",";",["T_WHITESPACE","\n\n        ",257],["T_VARIABLE","$request",259],["T_WHITESPACE"," ",259],"=",["T_WHITESPACE"," ",259],["T_NEW","new",259],["T_WHITESPACE"," ",259],["T_STRING","Request",259],"(",")",";",["T_WHITESPACE","\n        ",259],["T_VARIABLE","$request",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","setSession",260],"(",["T_VARIABLE","$session",260],")",";",["T_WHITESPACE","\n        ",260],["T_VARIABLE","$request",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","cookies",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","set",261],"(",["T_CONSTANT_ENCAPSED_STRING","'MOCKSESSID'",261],",",["T_WHITESPACE"," ",261],["T_STRING","true",261],")",";",["T_WHITESPACE","\n\n        ",261],["T_VARIABLE","$event",263],["T_WHITESPACE"," ",263],"=",["T_WHITESPACE"," ",263],["T_NEW","new",263],["T_WHITESPACE"," ",263],["T_STRING","FilterResponseEvent",263],"(",["T_WHITESPACE","\n            ",263],["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","getMockBuilder",264],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\HttpKernel\\HttpKernelInterface'",264],")",["T_OBJECT_OPERATOR","->",264],["T_STRING","getMock",264],"(",")",",",["T_WHITESPACE","\n            ",264],["T_VARIABLE","$request",265],",",["T_WHITESPACE","\n            ",265],["T_STRING","HttpKernelInterface",266],["T_DOUBLE_COLON","::",266],["T_STRING","MASTER_REQUEST",266],",",["T_WHITESPACE","\n            ",266],["T_NEW","new",267],["T_WHITESPACE"," ",267],["T_STRING","Response",267],"(",")",["T_WHITESPACE","\n        ",267],")",";",["T_WHITESPACE","\n\n        ",268],["T_VARIABLE","$listener",270],["T_WHITESPACE"," ",270],"=",["T_WHITESPACE"," ",270],["T_NEW","new",270],["T_WHITESPACE"," ",270],["T_STRING","ContextListener",270],"(",["T_VARIABLE","$tokenStorage",270],",",["T_WHITESPACE"," ",270],["T_ARRAY","array",270],"(",")",",",["T_WHITESPACE"," ",270],["T_CONSTANT_ENCAPSED_STRING","'session'",270],",",["T_WHITESPACE"," ",270],["T_STRING","null",270],",",["T_WHITESPACE"," ",270],["T_NEW","new",270],["T_WHITESPACE"," ",270],["T_STRING","EventDispatcher",270],"(",")",")",";",["T_WHITESPACE","\n        ",270],["T_VARIABLE","$listener",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","onKernelResponse",271],"(",["T_VARIABLE","$event",271],")",";",["T_WHITESPACE","\n\n        ",271],["T_RETURN","return",273],["T_WHITESPACE"," ",273],["T_VARIABLE","$session",273],";",["T_WHITESPACE","\n    ",273],"}",["T_WHITESPACE","\n",274],"}",["T_WHITESPACE","\n",275]]