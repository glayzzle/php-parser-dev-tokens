[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Security",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Http",12],["T_NS_SEPARATOR","\\",12],["T_STRING","RememberMe",12],";",["T_WHITESPACE","\n\n",12],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Symfony",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Component",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Security",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Core",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Authentication",14],["T_NS_SEPARATOR","\\",14],["T_STRING","RememberMe",14],["T_NS_SEPARATOR","\\",14],["T_STRING","TokenProviderInterface",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Symfony",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Component",15],["T_NS_SEPARATOR","\\",15],["T_STRING","HttpFoundation",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Cookie",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Symfony",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Component",16],["T_NS_SEPARATOR","\\",16],["T_STRING","HttpFoundation",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Response",16],";",["T_WHITESPACE","\n",16],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Symfony",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Component",17],["T_NS_SEPARATOR","\\",17],["T_STRING","HttpFoundation",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Request",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Symfony",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Component",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Security",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Core",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Exception",18],["T_NS_SEPARATOR","\\",18],["T_STRING","AuthenticationException",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Symfony",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Component",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Security",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Core",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Exception",19],["T_NS_SEPARATOR","\\",19],["T_STRING","CookieTheftException",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Symfony",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Component",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Security",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Core",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Authentication",20],["T_NS_SEPARATOR","\\",20],["T_STRING","RememberMe",20],["T_NS_SEPARATOR","\\",20],["T_STRING","PersistentToken",20],";",["T_WHITESPACE","\n",20],["T_USE","use",21],["T_WHITESPACE"," ",21],["T_STRING","Symfony",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Component",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Security",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Core",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Authentication",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Token",21],["T_NS_SEPARATOR","\\",21],["T_STRING","TokenInterface",21],";",["T_WHITESPACE","\n\n",21],["T_DOC_COMMENT","\/**\n * Concrete implementation of the RememberMeServicesInterface which needs\n * an implementation of TokenProviderInterface for providing remember-me\n * capabilities.\n *\n * @author Johannes M. Schmitt <schmittjoh@gmail.com>\n *\/",23],["T_WHITESPACE","\n",29],["T_CLASS","class",30],["T_WHITESPACE"," ",30],["T_STRING","PersistentTokenBasedRememberMeServices",30],["T_WHITESPACE"," ",30],["T_EXTENDS","extends",30],["T_WHITESPACE"," ",30],["T_STRING","AbstractRememberMeServices",30],["T_WHITESPACE","\n",30],"{",["T_WHITESPACE","\n    ",31],["T_PRIVATE","private",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$tokenProvider",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * Sets the token provider.\n     *\n     * @param TokenProviderInterface $tokenProvider\n     *\/",34],["T_WHITESPACE","\n    ",38],["T_PUBLIC","public",39],["T_WHITESPACE"," ",39],["T_FUNCTION","function",39],["T_WHITESPACE"," ",39],["T_STRING","setTokenProvider",39],"(",["T_STRING","TokenProviderInterface",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$tokenProvider",39],")",["T_WHITESPACE","\n    ",39],"{",["T_WHITESPACE","\n        ",40],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","tokenProvider",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$tokenProvider",41],";",["T_WHITESPACE","\n    ",41],"}",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",44],["T_WHITESPACE","\n    ",46],["T_PROTECTED","protected",47],["T_WHITESPACE"," ",47],["T_FUNCTION","function",47],["T_WHITESPACE"," ",47],["T_STRING","cancelCookie",47],"(",["T_STRING","Request",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$request",47],")",["T_WHITESPACE","\n    ",47],"{",["T_WHITESPACE","\n        ",48],["T_COMMENT","\/\/ Delete cookie on the client\n",49],["T_WHITESPACE","        ",50],["T_STRING","parent",50],["T_DOUBLE_COLON","::",50],["T_STRING","cancelCookie",50],"(",["T_VARIABLE","$request",50],")",";",["T_WHITESPACE","\n\n        ",50],["T_COMMENT","\/\/ Delete cookie from the tokenProvider\n",52],["T_WHITESPACE","        ",53],["T_IF","if",53],["T_WHITESPACE"," ",53],"(",["T_STRING","null",53],["T_WHITESPACE"," ",53],["T_IS_NOT_IDENTICAL","!==",53],["T_WHITESPACE"," ",53],"(",["T_VARIABLE","$cookie",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$request",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","cookies",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","get",53],"(",["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","options",53],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",53],"]",")",")",["T_WHITESPACE","\n            ",53],["T_BOOLEAN_AND","&&",54],["T_WHITESPACE"," ",54],["T_STRING","count",54],"(",["T_VARIABLE","$parts",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","decodeCookie",54],"(",["T_VARIABLE","$cookie",54],")",")",["T_WHITESPACE"," ",54],["T_IS_IDENTICAL","===",54],["T_WHITESPACE"," ",54],["T_LNUMBER","2",54],["T_WHITESPACE","\n        ",54],")",["T_WHITESPACE"," ",55],"{",["T_WHITESPACE","\n            ",55],["T_LIST","list",56],"(",["T_VARIABLE","$series",56],")",["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$parts",56],";",["T_WHITESPACE","\n            ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","tokenProvider",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","deleteTokenBySeries",57],"(",["T_VARIABLE","$series",57],")",";",["T_WHITESPACE","\n        ",57],"}",["T_WHITESPACE","\n    ",58],"}",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",61],["T_WHITESPACE","\n    ",63],["T_PROTECTED","protected",64],["T_WHITESPACE"," ",64],["T_FUNCTION","function",64],["T_WHITESPACE"," ",64],["T_STRING","processAutoLoginCookie",64],"(",["T_ARRAY","array",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$cookieParts",64],",",["T_WHITESPACE"," ",64],["T_STRING","Request",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$request",64],")",["T_WHITESPACE","\n    ",64],"{",["T_WHITESPACE","\n        ",65],["T_IF","if",66],["T_WHITESPACE"," ",66],"(",["T_STRING","count",66],"(",["T_VARIABLE","$cookieParts",66],")",["T_WHITESPACE"," ",66],["T_IS_NOT_IDENTICAL","!==",66],["T_WHITESPACE"," ",66],["T_LNUMBER","2",66],")",["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n            ",66],["T_THROW","throw",67],["T_WHITESPACE"," ",67],["T_NEW","new",67],["T_WHITESPACE"," ",67],["T_STRING","AuthenticationException",67],"(",["T_CONSTANT_ENCAPSED_STRING","'The cookie is invalid.'",67],")",";",["T_WHITESPACE","\n        ",67],"}",["T_WHITESPACE","\n\n        ",68],["T_LIST","list",70],"(",["T_VARIABLE","$series",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$tokenValue",70],")",["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$cookieParts",70],";",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$persistentToken",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","tokenProvider",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","loadTokenBySeries",71],"(",["T_VARIABLE","$series",71],")",";",["T_WHITESPACE","\n\n        ",71],["T_IF","if",73],["T_WHITESPACE"," ",73],"(","!",["T_STRING","hash_equals",73],"(",["T_VARIABLE","$persistentToken",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","getTokenValue",73],"(",")",",",["T_WHITESPACE"," ",73],["T_VARIABLE","$tokenValue",73],")",")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n            ",73],["T_THROW","throw",74],["T_WHITESPACE"," ",74],["T_NEW","new",74],["T_WHITESPACE"," ",74],["T_STRING","CookieTheftException",74],"(",["T_CONSTANT_ENCAPSED_STRING","'This token was already used. The account is possibly compromised.'",74],")",";",["T_WHITESPACE","\n        ",74],"}",["T_WHITESPACE","\n\n        ",75],["T_IF","if",77],["T_WHITESPACE"," ",77],"(",["T_VARIABLE","$persistentToken",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getLastUsed",77],"(",")",["T_OBJECT_OPERATOR","->",77],["T_STRING","getTimestamp",77],"(",")",["T_WHITESPACE"," ",77],"+",["T_WHITESPACE"," ",77],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","options",77],"[",["T_CONSTANT_ENCAPSED_STRING","'lifetime'",77],"]",["T_WHITESPACE"," ",77],"<",["T_WHITESPACE"," ",77],["T_STRING","time",77],"(",")",")",["T_WHITESPACE"," ",77],"{",["T_WHITESPACE","\n            ",77],["T_THROW","throw",78],["T_WHITESPACE"," ",78],["T_NEW","new",78],["T_WHITESPACE"," ",78],["T_STRING","AuthenticationException",78],"(",["T_CONSTANT_ENCAPSED_STRING","'The cookie has expired.'",78],")",";",["T_WHITESPACE","\n        ",78],"}",["T_WHITESPACE","\n\n        ",79],["T_VARIABLE","$tokenValue",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_STRING","base64_encode",81],"(",["T_STRING","random_bytes",81],"(",["T_LNUMBER","64",81],")",")",";",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","tokenProvider",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","updateToken",82],"(",["T_VARIABLE","$series",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$tokenValue",82],",",["T_WHITESPACE"," ",82],["T_NEW","new",82],["T_WHITESPACE"," ",82],["T_NS_SEPARATOR","\\",82],["T_STRING","DateTime",82],"(",")",")",";",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$request",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","attributes",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","set",83],"(",["T_STRING","self",83],["T_DOUBLE_COLON","::",83],["T_STRING","COOKIE_ATTR_NAME",83],",",["T_WHITESPACE","\n            ",83],["T_NEW","new",84],["T_WHITESPACE"," ",84],["T_STRING","Cookie",84],"(",["T_WHITESPACE","\n                ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","options",85],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",85],"]",",",["T_WHITESPACE","\n                ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","encodeCookie",86],"(",["T_ARRAY","array",86],"(",["T_VARIABLE","$series",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$tokenValue",86],")",")",",",["T_WHITESPACE","\n                ",86],["T_STRING","time",87],"(",")",["T_WHITESPACE"," ",87],"+",["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","options",87],"[",["T_CONSTANT_ENCAPSED_STRING","'lifetime'",87],"]",",",["T_WHITESPACE","\n                ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","options",88],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",88],"]",",",["T_WHITESPACE","\n                ",88],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","options",89],"[",["T_CONSTANT_ENCAPSED_STRING","'domain'",89],"]",",",["T_WHITESPACE","\n                ",89],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","options",90],"[",["T_CONSTANT_ENCAPSED_STRING","'secure'",90],"]",",",["T_WHITESPACE","\n                ",90],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","options",91],"[",["T_CONSTANT_ENCAPSED_STRING","'httponly'",91],"]",["T_WHITESPACE","\n            ",91],")",["T_WHITESPACE","\n        ",92],")",";",["T_WHITESPACE","\n\n        ",93],["T_RETURN","return",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getUserProvider",95],"(",["T_VARIABLE","$persistentToken",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getClass",95],"(",")",")",["T_OBJECT_OPERATOR","->",95],["T_STRING","loadUserByUsername",95],"(",["T_VARIABLE","$persistentToken",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getUsername",95],"(",")",")",";",["T_WHITESPACE","\n    ",95],"}",["T_WHITESPACE","\n\n    ",96],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",98],["T_WHITESPACE","\n    ",100],["T_PROTECTED","protected",101],["T_WHITESPACE"," ",101],["T_FUNCTION","function",101],["T_WHITESPACE"," ",101],["T_STRING","onLoginSuccess",101],"(",["T_STRING","Request",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$request",101],",",["T_WHITESPACE"," ",101],["T_STRING","Response",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$response",101],",",["T_WHITESPACE"," ",101],["T_STRING","TokenInterface",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$token",101],")",["T_WHITESPACE","\n    ",101],"{",["T_WHITESPACE","\n        ",102],["T_VARIABLE","$series",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_STRING","base64_encode",103],"(",["T_STRING","random_bytes",103],"(",["T_LNUMBER","64",103],")",")",";",["T_WHITESPACE","\n        ",103],["T_VARIABLE","$tokenValue",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_STRING","base64_encode",104],"(",["T_STRING","random_bytes",104],"(",["T_LNUMBER","64",104],")",")",";",["T_WHITESPACE","\n\n        ",104],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","tokenProvider",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","createNewToken",106],"(",["T_WHITESPACE","\n            ",106],["T_NEW","new",107],["T_WHITESPACE"," ",107],["T_STRING","PersistentToken",107],"(",["T_WHITESPACE","\n                ",107],["T_STRING","get_class",108],"(",["T_VARIABLE","$user",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$token",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getUser",108],"(",")",")",",",["T_WHITESPACE","\n                ",108],["T_VARIABLE","$user",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getUsername",109],"(",")",",",["T_WHITESPACE","\n                ",109],["T_VARIABLE","$series",110],",",["T_WHITESPACE","\n                ",110],["T_VARIABLE","$tokenValue",111],",",["T_WHITESPACE","\n                ",111],["T_NEW","new",112],["T_WHITESPACE"," ",112],["T_NS_SEPARATOR","\\",112],["T_STRING","DateTime",112],"(",")",["T_WHITESPACE","\n            ",112],")",["T_WHITESPACE","\n        ",113],")",";",["T_WHITESPACE","\n\n        ",114],["T_VARIABLE","$response",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","headers",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","setCookie",116],"(",["T_WHITESPACE","\n            ",116],["T_NEW","new",117],["T_WHITESPACE"," ",117],["T_STRING","Cookie",117],"(",["T_WHITESPACE","\n                ",117],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","options",118],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",118],"]",",",["T_WHITESPACE","\n                ",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","encodeCookie",119],"(",["T_ARRAY","array",119],"(",["T_VARIABLE","$series",119],",",["T_WHITESPACE"," ",119],["T_VARIABLE","$tokenValue",119],")",")",",",["T_WHITESPACE","\n                ",119],["T_STRING","time",120],"(",")",["T_WHITESPACE"," ",120],"+",["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","options",120],"[",["T_CONSTANT_ENCAPSED_STRING","'lifetime'",120],"]",",",["T_WHITESPACE","\n                ",120],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","options",121],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",121],"]",",",["T_WHITESPACE","\n                ",121],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","options",122],"[",["T_CONSTANT_ENCAPSED_STRING","'domain'",122],"]",",",["T_WHITESPACE","\n                ",122],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","options",123],"[",["T_CONSTANT_ENCAPSED_STRING","'secure'",123],"]",",",["T_WHITESPACE","\n                ",123],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","options",124],"[",["T_CONSTANT_ENCAPSED_STRING","'httponly'",124],"]",["T_WHITESPACE","\n            ",124],")",["T_WHITESPACE","\n        ",125],")",";",["T_WHITESPACE","\n    ",126],"}",["T_WHITESPACE","\n",127],"}",["T_WHITESPACE","\n",128]]