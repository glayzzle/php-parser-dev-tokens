[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Security",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Http",12],["T_NS_SEPARATOR","\\",12],["T_STRING","RememberMe",12],";",["T_WHITESPACE","\n\n",12],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Symfony",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Component",14],["T_NS_SEPARATOR","\\",14],["T_STRING","HttpFoundation",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Cookie",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Symfony",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Component",15],["T_NS_SEPARATOR","\\",15],["T_STRING","HttpFoundation",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Request",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Symfony",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Component",16],["T_NS_SEPARATOR","\\",16],["T_STRING","HttpFoundation",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Response",16],";",["T_WHITESPACE","\n",16],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Symfony",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Component",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Security",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Core",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Authentication",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Token",17],["T_NS_SEPARATOR","\\",17],["T_STRING","TokenInterface",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Symfony",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Component",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Security",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Core",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Exception",18],["T_NS_SEPARATOR","\\",18],["T_STRING","AuthenticationException",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Symfony",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Component",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Security",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Core",19],["T_NS_SEPARATOR","\\",19],["T_STRING","User",19],["T_NS_SEPARATOR","\\",19],["T_STRING","UserInterface",19],";",["T_WHITESPACE","\n\n",19],["T_DOC_COMMENT","\/**\n * Concrete implementation of the RememberMeServicesInterface providing\n * remember-me capabilities without requiring a TokenProvider.\n *\n * @author Johannes M. Schmitt <schmittjoh@gmail.com>\n *\/",21],["T_WHITESPACE","\n",26],["T_CLASS","class",27],["T_WHITESPACE"," ",27],["T_STRING","TokenBasedRememberMeServices",27],["T_WHITESPACE"," ",27],["T_EXTENDS","extends",27],["T_WHITESPACE"," ",27],["T_STRING","AbstractRememberMeServices",27],["T_WHITESPACE","\n",27],"{",["T_WHITESPACE","\n    ",28],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",29],["T_WHITESPACE","\n    ",31],["T_PROTECTED","protected",32],["T_WHITESPACE"," ",32],["T_FUNCTION","function",32],["T_WHITESPACE"," ",32],["T_STRING","processAutoLoginCookie",32],"(",["T_ARRAY","array",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$cookieParts",32],",",["T_WHITESPACE"," ",32],["T_STRING","Request",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$request",32],")",["T_WHITESPACE","\n    ",32],"{",["T_WHITESPACE","\n        ",33],["T_IF","if",34],["T_WHITESPACE"," ",34],"(",["T_STRING","count",34],"(",["T_VARIABLE","$cookieParts",34],")",["T_WHITESPACE"," ",34],["T_IS_NOT_IDENTICAL","!==",34],["T_WHITESPACE"," ",34],["T_LNUMBER","4",34],")",["T_WHITESPACE"," ",34],"{",["T_WHITESPACE","\n            ",34],["T_THROW","throw",35],["T_WHITESPACE"," ",35],["T_NEW","new",35],["T_WHITESPACE"," ",35],["T_STRING","AuthenticationException",35],"(",["T_CONSTANT_ENCAPSED_STRING","'The cookie is invalid.'",35],")",";",["T_WHITESPACE","\n        ",35],"}",["T_WHITESPACE","\n\n        ",36],["T_LIST","list",38],"(",["T_VARIABLE","$class",38],",",["T_WHITESPACE"," ",38],["T_VARIABLE","$username",38],",",["T_WHITESPACE"," ",38],["T_VARIABLE","$expires",38],",",["T_WHITESPACE"," ",38],["T_VARIABLE","$hash",38],")",["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_VARIABLE","$cookieParts",38],";",["T_WHITESPACE","\n        ",38],["T_IF","if",39],["T_WHITESPACE"," ",39],"(",["T_STRING","false",39],["T_WHITESPACE"," ",39],["T_IS_IDENTICAL","===",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$username",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_STRING","base64_decode",39],"(",["T_VARIABLE","$username",39],",",["T_WHITESPACE"," ",39],["T_STRING","true",39],")",")",["T_WHITESPACE"," ",39],"{",["T_WHITESPACE","\n            ",39],["T_THROW","throw",40],["T_WHITESPACE"," ",40],["T_NEW","new",40],["T_WHITESPACE"," ",40],["T_STRING","AuthenticationException",40],"(",["T_CONSTANT_ENCAPSED_STRING","'$username contains a character from outside the base64 alphabet.'",40],")",";",["T_WHITESPACE","\n        ",40],"}",["T_WHITESPACE","\n        ",41],["T_TRY","try",42],["T_WHITESPACE"," ",42],"{",["T_WHITESPACE","\n            ",42],["T_VARIABLE","$user",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","getUserProvider",43],"(",["T_VARIABLE","$class",43],")",["T_OBJECT_OPERATOR","->",43],["T_STRING","loadUserByUsername",43],"(",["T_VARIABLE","$username",43],")",";",["T_WHITESPACE","\n        ",43],"}",["T_WHITESPACE"," ",44],["T_CATCH","catch",44],["T_WHITESPACE"," ",44],"(",["T_NS_SEPARATOR","\\",44],["T_STRING","Exception",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$e",44],")",["T_WHITESPACE"," ",44],"{",["T_WHITESPACE","\n            ",44],["T_IF","if",45],["T_WHITESPACE"," ",45],"(","!",["T_VARIABLE","$e",45],["T_WHITESPACE"," ",45],["T_INSTANCEOF","instanceof",45],["T_WHITESPACE"," ",45],["T_STRING","AuthenticationException",45],")",["T_WHITESPACE"," ",45],"{",["T_WHITESPACE","\n                ",45],["T_VARIABLE","$e",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_NEW","new",46],["T_WHITESPACE"," ",46],["T_STRING","AuthenticationException",46],"(",["T_VARIABLE","$e",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","getMessage",46],"(",")",",",["T_WHITESPACE"," ",46],["T_VARIABLE","$e",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","getCode",46],"(",")",",",["T_WHITESPACE"," ",46],["T_VARIABLE","$e",46],")",";",["T_WHITESPACE","\n            ",46],"}",["T_WHITESPACE","\n\n            ",47],["T_THROW","throw",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$e",49],";",["T_WHITESPACE","\n        ",49],"}",["T_WHITESPACE","\n\n        ",50],["T_IF","if",52],["T_WHITESPACE"," ",52],"(","!",["T_VARIABLE","$user",52],["T_WHITESPACE"," ",52],["T_INSTANCEOF","instanceof",52],["T_WHITESPACE"," ",52],["T_STRING","UserInterface",52],")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n            ",52],["T_THROW","throw",53],["T_WHITESPACE"," ",53],["T_NEW","new",53],["T_WHITESPACE"," ",53],["T_NS_SEPARATOR","\\",53],["T_STRING","RuntimeException",53],"(",["T_STRING","sprintf",53],"(",["T_CONSTANT_ENCAPSED_STRING","'The UserProviderInterface implementation must return an instance of UserInterface, but returned \"%s\".'",53],",",["T_WHITESPACE"," ",53],["T_STRING","get_class",53],"(",["T_VARIABLE","$user",53],")",")",")",";",["T_WHITESPACE","\n        ",53],"}",["T_WHITESPACE","\n\n        ",54],["T_IF","if",56],["T_WHITESPACE"," ",56],"(",["T_STRING","true",56],["T_WHITESPACE"," ",56],["T_IS_NOT_IDENTICAL","!==",56],["T_WHITESPACE"," ",56],["T_STRING","hash_equals",56],"(",["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","generateCookieHash",56],"(",["T_VARIABLE","$class",56],",",["T_WHITESPACE"," ",56],["T_VARIABLE","$username",56],",",["T_WHITESPACE"," ",56],["T_VARIABLE","$expires",56],",",["T_WHITESPACE"," ",56],["T_VARIABLE","$user",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","getPassword",56],"(",")",")",",",["T_WHITESPACE"," ",56],["T_VARIABLE","$hash",56],")",")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n            ",56],["T_THROW","throw",57],["T_WHITESPACE"," ",57],["T_NEW","new",57],["T_WHITESPACE"," ",57],["T_STRING","AuthenticationException",57],"(",["T_CONSTANT_ENCAPSED_STRING","'The cookie\\'s hash is invalid.'",57],")",";",["T_WHITESPACE","\n        ",57],"}",["T_WHITESPACE","\n\n        ",58],["T_IF","if",60],["T_WHITESPACE"," ",60],"(",["T_VARIABLE","$expires",60],["T_WHITESPACE"," ",60],"<",["T_WHITESPACE"," ",60],["T_STRING","time",60],"(",")",")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n            ",60],["T_THROW","throw",61],["T_WHITESPACE"," ",61],["T_NEW","new",61],["T_WHITESPACE"," ",61],["T_STRING","AuthenticationException",61],"(",["T_CONSTANT_ENCAPSED_STRING","'The cookie has expired.'",61],")",";",["T_WHITESPACE","\n        ",61],"}",["T_WHITESPACE","\n\n        ",62],["T_RETURN","return",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$user",64],";",["T_WHITESPACE","\n    ",64],"}",["T_WHITESPACE","\n\n    ",65],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",67],["T_WHITESPACE","\n    ",69],["T_PROTECTED","protected",70],["T_WHITESPACE"," ",70],["T_FUNCTION","function",70],["T_WHITESPACE"," ",70],["T_STRING","onLoginSuccess",70],"(",["T_STRING","Request",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$request",70],",",["T_WHITESPACE"," ",70],["T_STRING","Response",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$response",70],",",["T_WHITESPACE"," ",70],["T_STRING","TokenInterface",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$token",70],")",["T_WHITESPACE","\n    ",70],"{",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$user",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_VARIABLE","$token",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","getUser",72],"(",")",";",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$expires",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_STRING","time",73],"(",")",["T_WHITESPACE"," ",73],"+",["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","options",73],"[",["T_CONSTANT_ENCAPSED_STRING","'lifetime'",73],"]",";",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$value",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","generateCookieValue",74],"(",["T_STRING","get_class",74],"(",["T_VARIABLE","$user",74],")",",",["T_WHITESPACE"," ",74],["T_VARIABLE","$user",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","getUsername",74],"(",")",",",["T_WHITESPACE"," ",74],["T_VARIABLE","$expires",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$user",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","getPassword",74],"(",")",")",";",["T_WHITESPACE","\n\n        ",74],["T_VARIABLE","$response",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","headers",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","setCookie",76],"(",["T_WHITESPACE","\n            ",76],["T_NEW","new",77],["T_WHITESPACE"," ",77],["T_STRING","Cookie",77],"(",["T_WHITESPACE","\n                ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","options",78],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",78],"]",",",["T_WHITESPACE","\n                ",78],["T_VARIABLE","$value",79],",",["T_WHITESPACE","\n                ",79],["T_VARIABLE","$expires",80],",",["T_WHITESPACE","\n                ",80],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","options",81],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",81],"]",",",["T_WHITESPACE","\n                ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","options",82],"[",["T_CONSTANT_ENCAPSED_STRING","'domain'",82],"]",",",["T_WHITESPACE","\n                ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","options",83],"[",["T_CONSTANT_ENCAPSED_STRING","'secure'",83],"]",",",["T_WHITESPACE","\n                ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","options",84],"[",["T_CONSTANT_ENCAPSED_STRING","'httponly'",84],"]",["T_WHITESPACE","\n            ",84],")",["T_WHITESPACE","\n        ",85],")",";",["T_WHITESPACE","\n    ",86],"}",["T_WHITESPACE","\n\n    ",87],["T_DOC_COMMENT","\/**\n     * Generates the cookie value.\n     *\n     * @param string $class\n     * @param string $username The username\n     * @param int    $expires  The Unix timestamp when the cookie expires\n     * @param string $password The encoded password\n     *\n     * @return string\n     *\/",89],["T_WHITESPACE","\n    ",98],["T_PROTECTED","protected",99],["T_WHITESPACE"," ",99],["T_FUNCTION","function",99],["T_WHITESPACE"," ",99],["T_STRING","generateCookieValue",99],"(",["T_VARIABLE","$class",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$username",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$expires",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$password",99],")",["T_WHITESPACE","\n    ",99],"{",["T_WHITESPACE","\n        ",100],["T_COMMENT","\/\/ $username is encoded because it might contain COOKIE_DELIMITER,\n",101],["T_WHITESPACE","        ",102],["T_COMMENT","\/\/ we assume other values don't\n",102],["T_WHITESPACE","        ",103],["T_RETURN","return",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","encodeCookie",103],"(",["T_ARRAY","array",103],"(",["T_WHITESPACE","\n            ",103],["T_VARIABLE","$class",104],",",["T_WHITESPACE","\n            ",104],["T_STRING","base64_encode",105],"(",["T_VARIABLE","$username",105],")",",",["T_WHITESPACE","\n            ",105],["T_VARIABLE","$expires",106],",",["T_WHITESPACE","\n            ",106],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","generateCookieHash",107],"(",["T_VARIABLE","$class",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$username",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$expires",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$password",107],")",",",["T_WHITESPACE","\n        ",107],")",")",";",["T_WHITESPACE","\n    ",108],"}",["T_WHITESPACE","\n\n    ",109],["T_DOC_COMMENT","\/**\n     * Generates a hash for the cookie to ensure it is not being tempered with.\n     *\n     * @param string $class\n     * @param string $username The username\n     * @param int    $expires  The Unix timestamp when the cookie expires\n     * @param string $password The encoded password\n     *\n     * @return string\n     *\/",111],["T_WHITESPACE","\n    ",120],["T_PROTECTED","protected",121],["T_WHITESPACE"," ",121],["T_FUNCTION","function",121],["T_WHITESPACE"," ",121],["T_STRING","generateCookieHash",121],"(",["T_VARIABLE","$class",121],",",["T_WHITESPACE"," ",121],["T_VARIABLE","$username",121],",",["T_WHITESPACE"," ",121],["T_VARIABLE","$expires",121],",",["T_WHITESPACE"," ",121],["T_VARIABLE","$password",121],")",["T_WHITESPACE","\n    ",121],"{",["T_WHITESPACE","\n        ",122],["T_RETURN","return",123],["T_WHITESPACE"," ",123],["T_STRING","hash_hmac",123],"(",["T_CONSTANT_ENCAPSED_STRING","'sha256'",123],",",["T_WHITESPACE"," ",123],["T_VARIABLE","$class",123],".",["T_VARIABLE","$username",123],".",["T_VARIABLE","$expires",123],".",["T_VARIABLE","$password",123],",",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getSecret",123],"(",")",")",";",["T_WHITESPACE","\n    ",123],"}",["T_WHITESPACE","\n",124],"}",["T_WHITESPACE","\n",125]]