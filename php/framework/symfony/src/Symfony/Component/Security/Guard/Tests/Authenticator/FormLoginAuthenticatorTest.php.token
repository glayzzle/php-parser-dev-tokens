[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Security",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Guard",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Tests",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Authenticator",12],";",["T_WHITESPACE","\n\n",12],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Symfony",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Component",14],["T_NS_SEPARATOR","\\",14],["T_STRING","HttpFoundation",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Request",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Symfony",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Component",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Security",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Core",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Exception",15],["T_NS_SEPARATOR","\\",15],["T_STRING","AuthenticationException",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Symfony",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Component",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Security",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Core",16],["T_NS_SEPARATOR","\\",16],["T_STRING","User",16],["T_NS_SEPARATOR","\\",16],["T_STRING","UserInterface",16],";",["T_WHITESPACE","\n",16],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Symfony",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Component",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Security",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Core",17],["T_NS_SEPARATOR","\\",17],["T_STRING","User",17],["T_NS_SEPARATOR","\\",17],["T_STRING","UserProviderInterface",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Symfony",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Component",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Security",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Guard",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Authenticator",18],["T_NS_SEPARATOR","\\",18],["T_STRING","AbstractFormLoginAuthenticator",18],";",["T_WHITESPACE","\n\n",18],["T_DOC_COMMENT","\/**\n * @author Jean Pasdeloup <jpasdeloup@sedona.fr>\n *\/",20],["T_WHITESPACE","\n",22],["T_CLASS","class",23],["T_WHITESPACE"," ",23],["T_STRING","FormLoginAuthenticatorTest",23],["T_WHITESPACE"," ",23],["T_EXTENDS","extends",23],["T_WHITESPACE"," ",23],["T_NS_SEPARATOR","\\",23],["T_STRING","PHPUnit_Framework_TestCase",23],["T_WHITESPACE","\n",23],"{",["T_WHITESPACE","\n    ",24],["T_PRIVATE","private",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$requestWithoutSession",25],";",["T_WHITESPACE","\n    ",25],["T_PRIVATE","private",26],["T_WHITESPACE"," ",26],["T_VARIABLE","$requestWithSession",26],";",["T_WHITESPACE","\n    ",26],["T_PRIVATE","private",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$authenticator",27],";",["T_WHITESPACE","\n\n    ",27],["T_CONST","const",29],["T_WHITESPACE"," ",29],["T_STRING","LOGIN_URL",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/login'",29],";",["T_WHITESPACE","\n    ",29],["T_CONST","const",30],["T_WHITESPACE"," ",30],["T_STRING","DEFAULT_SUCCESS_URL",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/defaultsuccess'",30],";",["T_WHITESPACE","\n    ",30],["T_CONST","const",31],["T_WHITESPACE"," ",31],["T_STRING","CUSTOM_SUCCESS_URL",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/customsuccess'",31],";",["T_WHITESPACE","\n\n    ",31],["T_PUBLIC","public",33],["T_WHITESPACE"," ",33],["T_FUNCTION","function",33],["T_WHITESPACE"," ",33],["T_STRING","testAuthenticationFailureWithoutSession",33],"(",")",["T_WHITESPACE","\n    ",33],"{",["T_WHITESPACE","\n        ",34],["T_VARIABLE","$failureResponse",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","authenticator",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","onAuthenticationFailure",35],"(",["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","requestWithoutSession",35],",",["T_WHITESPACE"," ",35],["T_NEW","new",35],["T_WHITESPACE"," ",35],["T_STRING","AuthenticationException",35],"(",")",")",";",["T_WHITESPACE","\n\n        ",35],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","assertInstanceOf",37],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\\\Component\\\\HttpFoundation\\\\RedirectResponse'",37],",",["T_WHITESPACE"," ",37],["T_VARIABLE","$failureResponse",37],")",";",["T_WHITESPACE","\n        ",37],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","assertEquals",38],"(",["T_STRING","self",38],["T_DOUBLE_COLON","::",38],["T_STRING","LOGIN_URL",38],",",["T_WHITESPACE"," ",38],["T_VARIABLE","$failureResponse",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","getTargetUrl",38],"(",")",")",";",["T_WHITESPACE","\n    ",38],"}",["T_WHITESPACE","\n\n    ",39],["T_PUBLIC","public",41],["T_WHITESPACE"," ",41],["T_FUNCTION","function",41],["T_WHITESPACE"," ",41],["T_STRING","testAuthenticationFailureWithSession",41],"(",")",["T_WHITESPACE","\n    ",41],"{",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","requestWithSession",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","getSession",43],"(",")",["T_WHITESPACE","\n            ",43],["T_OBJECT_OPERATOR","->",44],["T_STRING","expects",44],"(",["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","once",44],"(",")",")",["T_WHITESPACE","\n            ",44],["T_OBJECT_OPERATOR","->",45],["T_STRING","method",45],"(",["T_CONSTANT_ENCAPSED_STRING","'set'",45],")",";",["T_WHITESPACE","\n\n        ",45],["T_VARIABLE","$failureResponse",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","authenticator",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","onAuthenticationFailure",47],"(",["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","requestWithSession",47],",",["T_WHITESPACE"," ",47],["T_NEW","new",47],["T_WHITESPACE"," ",47],["T_STRING","AuthenticationException",47],"(",")",")",";",["T_WHITESPACE","\n\n        ",47],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","assertInstanceOf",49],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\\\Component\\\\HttpFoundation\\\\RedirectResponse'",49],",",["T_WHITESPACE"," ",49],["T_VARIABLE","$failureResponse",49],")",";",["T_WHITESPACE","\n        ",49],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","assertEquals",50],"(",["T_STRING","self",50],["T_DOUBLE_COLON","::",50],["T_STRING","LOGIN_URL",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$failureResponse",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","getTargetUrl",50],"(",")",")",";",["T_WHITESPACE","\n    ",50],"}",["T_WHITESPACE","\n\n    ",51],["T_DOC_COMMENT","\/**\n     * @group legacy\n     *\/",53],["T_WHITESPACE","\n    ",55],["T_PUBLIC","public",56],["T_WHITESPACE"," ",56],["T_FUNCTION","function",56],["T_WHITESPACE"," ",56],["T_STRING","testAuthenticationSuccessWithoutSession",56],"(",")",["T_WHITESPACE","\n    ",56],"{",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$token",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","getMockBuilder",58],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\\\Component\\\\Security\\\\Core\\\\Authentication\\\\Token\\\\TokenInterface'",58],")",["T_WHITESPACE","\n            ",58],["T_OBJECT_OPERATOR","->",59],["T_STRING","disableOriginalConstructor",59],"(",")",["T_WHITESPACE","\n            ",59],["T_OBJECT_OPERATOR","->",60],["T_STRING","getMock",60],"(",")",";",["T_WHITESPACE","\n\n        ",60],["T_VARIABLE","$redirectResponse",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","authenticator",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","onAuthenticationSuccess",62],"(",["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","requestWithoutSession",62],",",["T_WHITESPACE"," ",62],["T_VARIABLE","$token",62],",",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'providerkey'",62],")",";",["T_WHITESPACE","\n\n        ",62],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","assertInstanceOf",64],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\\\Component\\\\HttpFoundation\\\\RedirectResponse'",64],",",["T_WHITESPACE"," ",64],["T_VARIABLE","$redirectResponse",64],")",";",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","assertEquals",65],"(",["T_STRING","self",65],["T_DOUBLE_COLON","::",65],["T_STRING","DEFAULT_SUCCESS_URL",65],",",["T_WHITESPACE"," ",65],["T_VARIABLE","$redirectResponse",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getTargetUrl",65],"(",")",")",";",["T_WHITESPACE","\n    ",65],"}",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * @group legacy\n     *\/",68],["T_WHITESPACE","\n    ",70],["T_PUBLIC","public",71],["T_WHITESPACE"," ",71],["T_FUNCTION","function",71],["T_WHITESPACE"," ",71],["T_STRING","testAuthenticationSuccessWithSessionButEmpty",71],"(",")",["T_WHITESPACE","\n    ",71],"{",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$token",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","getMockBuilder",73],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\\\Component\\\\Security\\\\Core\\\\Authentication\\\\Token\\\\TokenInterface'",73],")",["T_WHITESPACE","\n            ",73],["T_OBJECT_OPERATOR","->",74],["T_STRING","disableOriginalConstructor",74],"(",")",["T_WHITESPACE","\n            ",74],["T_OBJECT_OPERATOR","->",75],["T_STRING","getMock",75],"(",")",";",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","requestWithSession",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getSession",76],"(",")",["T_WHITESPACE","\n            ",76],["T_OBJECT_OPERATOR","->",77],["T_STRING","expects",77],"(",["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","once",77],"(",")",")",["T_WHITESPACE","\n            ",77],["T_OBJECT_OPERATOR","->",78],["T_STRING","method",78],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",78],")",["T_WHITESPACE","\n            ",78],["T_OBJECT_OPERATOR","->",79],["T_STRING","will",79],"(",["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","returnValue",79],"(",["T_STRING","null",79],")",")",";",["T_WHITESPACE","\n\n        ",79],["T_VARIABLE","$redirectResponse",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","authenticator",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","onAuthenticationSuccess",81],"(",["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","requestWithSession",81],",",["T_WHITESPACE"," ",81],["T_VARIABLE","$token",81],",",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'providerkey'",81],")",";",["T_WHITESPACE","\n\n        ",81],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","assertInstanceOf",83],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\\\Component\\\\HttpFoundation\\\\RedirectResponse'",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$redirectResponse",83],")",";",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","assertEquals",84],"(",["T_STRING","self",84],["T_DOUBLE_COLON","::",84],["T_STRING","DEFAULT_SUCCESS_URL",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$redirectResponse",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getTargetUrl",84],"(",")",")",";",["T_WHITESPACE","\n    ",84],"}",["T_WHITESPACE","\n\n    ",85],["T_DOC_COMMENT","\/**\n     * @group legacy\n     *\/",87],["T_WHITESPACE","\n    ",89],["T_PUBLIC","public",90],["T_WHITESPACE"," ",90],["T_FUNCTION","function",90],["T_WHITESPACE"," ",90],["T_STRING","testAuthenticationSuccessWithSessionAndTarget",90],"(",")",["T_WHITESPACE","\n    ",90],"{",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$token",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getMockBuilder",92],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\\\Component\\\\Security\\\\Core\\\\Authentication\\\\Token\\\\TokenInterface'",92],")",["T_WHITESPACE","\n            ",92],["T_OBJECT_OPERATOR","->",93],["T_STRING","disableOriginalConstructor",93],"(",")",["T_WHITESPACE","\n            ",93],["T_OBJECT_OPERATOR","->",94],["T_STRING","getMock",94],"(",")",";",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","requestWithSession",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getSession",95],"(",")",["T_WHITESPACE","\n            ",95],["T_OBJECT_OPERATOR","->",96],["T_STRING","expects",96],"(",["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","once",96],"(",")",")",["T_WHITESPACE","\n            ",96],["T_OBJECT_OPERATOR","->",97],["T_STRING","method",97],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",97],")",["T_WHITESPACE","\n            ",97],["T_OBJECT_OPERATOR","->",98],["T_STRING","will",98],"(",["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","returnValue",98],"(",["T_STRING","self",98],["T_DOUBLE_COLON","::",98],["T_STRING","CUSTOM_SUCCESS_URL",98],")",")",";",["T_WHITESPACE","\n\n        ",98],["T_VARIABLE","$redirectResponse",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","authenticator",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","onAuthenticationSuccess",100],"(",["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","requestWithSession",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$token",100],",",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","'providerkey'",100],")",";",["T_WHITESPACE","\n\n        ",100],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","assertInstanceOf",102],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\\\Component\\\\HttpFoundation\\\\RedirectResponse'",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$redirectResponse",102],")",";",["T_WHITESPACE","\n        ",102],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","assertEquals",103],"(",["T_STRING","self",103],["T_DOUBLE_COLON","::",103],["T_STRING","CUSTOM_SUCCESS_URL",103],",",["T_WHITESPACE"," ",103],["T_VARIABLE","$redirectResponse",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getTargetUrl",103],"(",")",")",";",["T_WHITESPACE","\n    ",103],"}",["T_WHITESPACE","\n\n    ",104],["T_PUBLIC","public",106],["T_WHITESPACE"," ",106],["T_FUNCTION","function",106],["T_WHITESPACE"," ",106],["T_STRING","testRememberMe",106],"(",")",["T_WHITESPACE","\n    ",106],"{",["T_WHITESPACE","\n        ",107],["T_VARIABLE","$doSupport",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","authenticator",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","supportsRememberMe",108],"(",")",";",["T_WHITESPACE","\n\n        ",108],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","assertTrue",110],"(",["T_VARIABLE","$doSupport",110],")",";",["T_WHITESPACE","\n    ",110],"}",["T_WHITESPACE","\n\n    ",111],["T_PUBLIC","public",113],["T_WHITESPACE"," ",113],["T_FUNCTION","function",113],["T_WHITESPACE"," ",113],["T_STRING","testStartWithoutSession",113],"(",")",["T_WHITESPACE","\n    ",113],"{",["T_WHITESPACE","\n        ",114],["T_VARIABLE","$failureResponse",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","authenticator",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","start",115],"(",["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","requestWithoutSession",115],",",["T_WHITESPACE"," ",115],["T_NEW","new",115],["T_WHITESPACE"," ",115],["T_STRING","AuthenticationException",115],"(",")",")",";",["T_WHITESPACE","\n\n        ",115],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","assertInstanceOf",117],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\\\Component\\\\HttpFoundation\\\\RedirectResponse'",117],",",["T_WHITESPACE"," ",117],["T_VARIABLE","$failureResponse",117],")",";",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","assertEquals",118],"(",["T_STRING","self",118],["T_DOUBLE_COLON","::",118],["T_STRING","LOGIN_URL",118],",",["T_WHITESPACE"," ",118],["T_VARIABLE","$failureResponse",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","getTargetUrl",118],"(",")",")",";",["T_WHITESPACE","\n    ",118],"}",["T_WHITESPACE","\n\n    ",119],["T_PUBLIC","public",121],["T_WHITESPACE"," ",121],["T_FUNCTION","function",121],["T_WHITESPACE"," ",121],["T_STRING","testStartWithSession",121],"(",")",["T_WHITESPACE","\n    ",121],"{",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$failureResponse",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","authenticator",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","start",123],"(",["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","requestWithSession",123],",",["T_WHITESPACE"," ",123],["T_NEW","new",123],["T_WHITESPACE"," ",123],["T_STRING","AuthenticationException",123],"(",")",")",";",["T_WHITESPACE","\n\n        ",123],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","assertInstanceOf",125],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\\\Component\\\\HttpFoundation\\\\RedirectResponse'",125],",",["T_WHITESPACE"," ",125],["T_VARIABLE","$failureResponse",125],")",";",["T_WHITESPACE","\n        ",125],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","assertEquals",126],"(",["T_STRING","self",126],["T_DOUBLE_COLON","::",126],["T_STRING","LOGIN_URL",126],",",["T_WHITESPACE"," ",126],["T_VARIABLE","$failureResponse",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getTargetUrl",126],"(",")",")",";",["T_WHITESPACE","\n    ",126],"}",["T_WHITESPACE","\n\n    ",127],["T_PROTECTED","protected",129],["T_WHITESPACE"," ",129],["T_FUNCTION","function",129],["T_WHITESPACE"," ",129],["T_STRING","setUp",129],"(",")",["T_WHITESPACE","\n    ",129],"{",["T_WHITESPACE","\n        ",130],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","requestWithoutSession",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_NEW","new",131],["T_WHITESPACE"," ",131],["T_STRING","Request",131],"(",["T_ARRAY","array",131],"(",")",",",["T_WHITESPACE"," ",131],["T_ARRAY","array",131],"(",")",",",["T_WHITESPACE"," ",131],["T_ARRAY","array",131],"(",")",",",["T_WHITESPACE"," ",131],["T_ARRAY","array",131],"(",")",",",["T_WHITESPACE"," ",131],["T_ARRAY","array",131],"(",")",",",["T_WHITESPACE"," ",131],["T_ARRAY","array",131],"(",")",")",";",["T_WHITESPACE","\n        ",131],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","requestWithSession",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_NEW","new",132],["T_WHITESPACE"," ",132],["T_STRING","Request",132],"(",["T_ARRAY","array",132],"(",")",",",["T_WHITESPACE"," ",132],["T_ARRAY","array",132],"(",")",",",["T_WHITESPACE"," ",132],["T_ARRAY","array",132],"(",")",",",["T_WHITESPACE"," ",132],["T_ARRAY","array",132],"(",")",",",["T_WHITESPACE"," ",132],["T_ARRAY","array",132],"(",")",",",["T_WHITESPACE"," ",132],["T_ARRAY","array",132],"(",")",")",";",["T_WHITESPACE","\n\n        ",132],["T_VARIABLE","$session",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","getMockBuilder",134],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\\\Component\\\\HttpFoundation\\\\Session\\\\SessionInterface'",134],")",["T_WHITESPACE","\n            ",134],["T_OBJECT_OPERATOR","->",135],["T_STRING","disableOriginalConstructor",135],"(",")",["T_WHITESPACE","\n            ",135],["T_OBJECT_OPERATOR","->",136],["T_STRING","getMock",136],"(",")",";",["T_WHITESPACE","\n        ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","requestWithSession",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","setSession",137],"(",["T_VARIABLE","$session",137],")",";",["T_WHITESPACE","\n\n        ",137],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","authenticator",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_NEW","new",139],["T_WHITESPACE"," ",139],["T_STRING","TestFormLoginAuthenticator",139],"(",")",";",["T_WHITESPACE","\n        ",139],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","authenticator",140],["T_WHITESPACE","\n            ",140],["T_OBJECT_OPERATOR","->",141],["T_STRING","setLoginUrl",141],"(",["T_STRING","self",141],["T_DOUBLE_COLON","::",141],["T_STRING","LOGIN_URL",141],")",["T_WHITESPACE","\n            ",141],["T_OBJECT_OPERATOR","->",142],["T_STRING","setDefaultSuccessRedirectUrl",142],"(",["T_STRING","self",142],["T_DOUBLE_COLON","::",142],["T_STRING","DEFAULT_SUCCESS_URL",142],")",["T_WHITESPACE","\n        ",142],";",["T_WHITESPACE","\n    ",143],"}",["T_WHITESPACE","\n\n    ",144],["T_PROTECTED","protected",146],["T_WHITESPACE"," ",146],["T_FUNCTION","function",146],["T_WHITESPACE"," ",146],["T_STRING","tearDown",146],"(",")",["T_WHITESPACE","\n    ",146],"{",["T_WHITESPACE","\n        ",147],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","request",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_STRING","null",148],";",["T_WHITESPACE","\n        ",148],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","requestWithSession",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_STRING","null",149],";",["T_WHITESPACE","\n    ",149],"}",["T_WHITESPACE","\n",150],"}",["T_WHITESPACE","\n\n",151],["T_CLASS","class",153],["T_WHITESPACE"," ",153],["T_STRING","TestFormLoginAuthenticator",153],["T_WHITESPACE"," ",153],["T_EXTENDS","extends",153],["T_WHITESPACE"," ",153],["T_STRING","AbstractFormLoginAuthenticator",153],["T_WHITESPACE","\n",153],"{",["T_WHITESPACE","\n    ",154],["T_PRIVATE","private",155],["T_WHITESPACE"," ",155],["T_VARIABLE","$loginUrl",155],";",["T_WHITESPACE","\n    ",155],["T_PRIVATE","private",156],["T_WHITESPACE"," ",156],["T_VARIABLE","$defaultSuccessRedirectUrl",156],";",["T_WHITESPACE","\n\n    ",156],["T_DOC_COMMENT","\/**\n     * @param mixed $defaultSuccessRedirectUrl\n     *\n     * @return TestFormLoginAuthenticator\n     *\/",158],["T_WHITESPACE","\n    ",162],["T_PUBLIC","public",163],["T_WHITESPACE"," ",163],["T_FUNCTION","function",163],["T_WHITESPACE"," ",163],["T_STRING","setDefaultSuccessRedirectUrl",163],"(",["T_VARIABLE","$defaultSuccessRedirectUrl",163],")",["T_WHITESPACE","\n    ",163],"{",["T_WHITESPACE","\n        ",164],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","defaultSuccessRedirectUrl",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_VARIABLE","$defaultSuccessRedirectUrl",165],";",["T_WHITESPACE","\n\n        ",165],["T_RETURN","return",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$this",167],";",["T_WHITESPACE","\n    ",167],"}",["T_WHITESPACE","\n\n    ",168],["T_DOC_COMMENT","\/**\n     * @param mixed $loginUrl\n     *\n     * @return TestFormLoginAuthenticator\n     *\/",170],["T_WHITESPACE","\n    ",174],["T_PUBLIC","public",175],["T_WHITESPACE"," ",175],["T_FUNCTION","function",175],["T_WHITESPACE"," ",175],["T_STRING","setLoginUrl",175],"(",["T_VARIABLE","$loginUrl",175],")",["T_WHITESPACE","\n    ",175],"{",["T_WHITESPACE","\n        ",176],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","loginUrl",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_VARIABLE","$loginUrl",177],";",["T_WHITESPACE","\n\n        ",177],["T_RETURN","return",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],";",["T_WHITESPACE","\n    ",179],"}",["T_WHITESPACE","\n\n    ",180],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",182],["T_WHITESPACE","\n    ",184],["T_PROTECTED","protected",185],["T_WHITESPACE"," ",185],["T_FUNCTION","function",185],["T_WHITESPACE"," ",185],["T_STRING","getLoginUrl",185],"(",")",["T_WHITESPACE","\n    ",185],"{",["T_WHITESPACE","\n        ",186],["T_RETURN","return",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","loginUrl",187],";",["T_WHITESPACE","\n    ",187],"}",["T_WHITESPACE","\n\n    ",188],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",190],["T_WHITESPACE","\n    ",192],["T_PROTECTED","protected",193],["T_WHITESPACE"," ",193],["T_FUNCTION","function",193],["T_WHITESPACE"," ",193],["T_STRING","getDefaultSuccessRedirectUrl",193],"(",")",["T_WHITESPACE","\n    ",193],"{",["T_WHITESPACE","\n        ",194],["T_RETURN","return",195],["T_WHITESPACE"," ",195],["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","defaultSuccessRedirectUrl",195],";",["T_WHITESPACE","\n    ",195],"}",["T_WHITESPACE","\n\n    ",196],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",198],["T_WHITESPACE","\n    ",200],["T_PUBLIC","public",201],["T_WHITESPACE"," ",201],["T_FUNCTION","function",201],["T_WHITESPACE"," ",201],["T_STRING","getCredentials",201],"(",["T_STRING","Request",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$request",201],")",["T_WHITESPACE","\n    ",201],"{",["T_WHITESPACE","\n        ",202],["T_RETURN","return",203],["T_WHITESPACE"," ",203],["T_CONSTANT_ENCAPSED_STRING","'credentials'",203],";",["T_WHITESPACE","\n    ",203],"}",["T_WHITESPACE","\n\n    ",204],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",206],["T_WHITESPACE","\n    ",208],["T_PUBLIC","public",209],["T_WHITESPACE"," ",209],["T_FUNCTION","function",209],["T_WHITESPACE"," ",209],["T_STRING","getUser",209],"(",["T_VARIABLE","$credentials",209],",",["T_WHITESPACE"," ",209],["T_STRING","UserProviderInterface",209],["T_WHITESPACE"," ",209],["T_VARIABLE","$userProvider",209],")",["T_WHITESPACE","\n    ",209],"{",["T_WHITESPACE","\n        ",210],["T_RETURN","return",211],["T_WHITESPACE"," ",211],["T_VARIABLE","$userProvider",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","loadUserByUsername",211],"(",["T_VARIABLE","$credentials",211],")",";",["T_WHITESPACE","\n    ",211],"}",["T_WHITESPACE","\n\n    ",212],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",214],["T_WHITESPACE","\n    ",216],["T_PUBLIC","public",217],["T_WHITESPACE"," ",217],["T_FUNCTION","function",217],["T_WHITESPACE"," ",217],["T_STRING","checkCredentials",217],"(",["T_VARIABLE","$credentials",217],",",["T_WHITESPACE"," ",217],["T_STRING","UserInterface",217],["T_WHITESPACE"," ",217],["T_VARIABLE","$user",217],")",["T_WHITESPACE","\n    ",217],"{",["T_WHITESPACE","\n        ",218],["T_RETURN","return",219],["T_WHITESPACE"," ",219],["T_STRING","true",219],";",["T_WHITESPACE","\n    ",219],"}",["T_WHITESPACE","\n",220],"}",["T_WHITESPACE","\n",221]]