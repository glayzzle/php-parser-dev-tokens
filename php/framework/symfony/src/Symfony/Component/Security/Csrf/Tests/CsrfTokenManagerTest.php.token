[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Security",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Csrf",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Tests",12],";",["T_WHITESPACE","\n\n",12],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Symfony",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Component",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Security",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Csrf",14],["T_NS_SEPARATOR","\\",14],["T_STRING","CsrfToken",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Symfony",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Component",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Security",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Csrf",15],["T_NS_SEPARATOR","\\",15],["T_STRING","CsrfTokenManager",15],";",["T_WHITESPACE","\n\n",15],["T_DOC_COMMENT","\/**\n * @author Bernhard Schussek <bschussek@gmail.com>\n *\/",17],["T_WHITESPACE","\n",19],["T_CLASS","class",20],["T_WHITESPACE"," ",20],["T_STRING","CsrfTokenManagerTest",20],["T_WHITESPACE"," ",20],["T_EXTENDS","extends",20],["T_WHITESPACE"," ",20],["T_NS_SEPARATOR","\\",20],["T_STRING","PHPUnit_Framework_TestCase",20],["T_WHITESPACE","\n",20],"{",["T_WHITESPACE","\n    ",21],["T_DOC_COMMENT","\/**\n     * @var \\PHPUnit_Framework_MockObject_MockObject\n     *\/",22],["T_WHITESPACE","\n    ",24],["T_PRIVATE","private",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$generator",25],";",["T_WHITESPACE","\n\n    ",25],["T_DOC_COMMENT","\/**\n     * @var \\PHPUnit_Framework_MockObject_MockObject\n     *\/",27],["T_WHITESPACE","\n    ",29],["T_PRIVATE","private",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$storage",30],";",["T_WHITESPACE","\n\n    ",30],["T_DOC_COMMENT","\/**\n     * @var CsrfTokenManager\n     *\/",32],["T_WHITESPACE","\n    ",34],["T_PRIVATE","private",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$manager",35],";",["T_WHITESPACE","\n\n    ",35],["T_PROTECTED","protected",37],["T_WHITESPACE"," ",37],["T_FUNCTION","function",37],["T_WHITESPACE"," ",37],["T_STRING","setUp",37],"(",")",["T_WHITESPACE","\n    ",37],"{",["T_WHITESPACE","\n        ",38],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","generator",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","getMockBuilder",39],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Csrf\\TokenGenerator\\TokenGeneratorInterface'",39],")",["T_OBJECT_OPERATOR","->",39],["T_STRING","getMock",39],"(",")",";",["T_WHITESPACE","\n        ",39],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","storage",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","getMockBuilder",40],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Csrf\\TokenStorage\\TokenStorageInterface'",40],")",["T_OBJECT_OPERATOR","->",40],["T_STRING","getMock",40],"(",")",";",["T_WHITESPACE","\n        ",40],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","manager",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_NEW","new",41],["T_WHITESPACE"," ",41],["T_STRING","CsrfTokenManager",41],"(",["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","generator",41],",",["T_WHITESPACE"," ",41],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","storage",41],")",";",["T_WHITESPACE","\n    ",41],"}",["T_WHITESPACE","\n\n    ",42],["T_PROTECTED","protected",44],["T_WHITESPACE"," ",44],["T_FUNCTION","function",44],["T_WHITESPACE"," ",44],["T_STRING","tearDown",44],"(",")",["T_WHITESPACE","\n    ",44],"{",["T_WHITESPACE","\n        ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","generator",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_STRING","null",46],";",["T_WHITESPACE","\n        ",46],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","storage",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_STRING","null",47],";",["T_WHITESPACE","\n        ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","manager",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_STRING","null",48],";",["T_WHITESPACE","\n    ",48],"}",["T_WHITESPACE","\n\n    ",49],["T_PUBLIC","public",51],["T_WHITESPACE"," ",51],["T_FUNCTION","function",51],["T_WHITESPACE"," ",51],["T_STRING","testGetNonExistingToken",51],"(",")",["T_WHITESPACE","\n    ",51],"{",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","storage",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","expects",53],"(",["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","once",53],"(",")",")",["T_WHITESPACE","\n            ",53],["T_OBJECT_OPERATOR","->",54],["T_STRING","method",54],"(",["T_CONSTANT_ENCAPSED_STRING","'hasToken'",54],")",["T_WHITESPACE","\n            ",54],["T_OBJECT_OPERATOR","->",55],["T_STRING","with",55],"(",["T_CONSTANT_ENCAPSED_STRING","'token_id'",55],")",["T_WHITESPACE","\n            ",55],["T_OBJECT_OPERATOR","->",56],["T_STRING","will",56],"(",["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","returnValue",56],"(",["T_STRING","false",56],")",")",";",["T_WHITESPACE","\n\n        ",56],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","generator",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","expects",58],"(",["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","once",58],"(",")",")",["T_WHITESPACE","\n            ",58],["T_OBJECT_OPERATOR","->",59],["T_STRING","method",59],"(",["T_CONSTANT_ENCAPSED_STRING","'generateToken'",59],")",["T_WHITESPACE","\n            ",59],["T_OBJECT_OPERATOR","->",60],["T_STRING","will",60],"(",["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","returnValue",60],"(",["T_CONSTANT_ENCAPSED_STRING","'TOKEN'",60],")",")",";",["T_WHITESPACE","\n\n        ",60],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","storage",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","expects",62],"(",["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","once",62],"(",")",")",["T_WHITESPACE","\n            ",62],["T_OBJECT_OPERATOR","->",63],["T_STRING","method",63],"(",["T_CONSTANT_ENCAPSED_STRING","'setToken'",63],")",["T_WHITESPACE","\n            ",63],["T_OBJECT_OPERATOR","->",64],["T_STRING","with",64],"(",["T_CONSTANT_ENCAPSED_STRING","'token_id'",64],",",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'TOKEN'",64],")",";",["T_WHITESPACE","\n\n        ",64],["T_VARIABLE","$token",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","manager",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getToken",66],"(",["T_CONSTANT_ENCAPSED_STRING","'token_id'",66],")",";",["T_WHITESPACE","\n\n        ",66],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","assertInstanceOf",68],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Csrf\\CsrfToken'",68],",",["T_WHITESPACE"," ",68],["T_VARIABLE","$token",68],")",";",["T_WHITESPACE","\n        ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","assertSame",69],"(",["T_CONSTANT_ENCAPSED_STRING","'token_id'",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$token",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getId",69],"(",")",")",";",["T_WHITESPACE","\n        ",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","assertSame",70],"(",["T_CONSTANT_ENCAPSED_STRING","'TOKEN'",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$token",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getValue",70],"(",")",")",";",["T_WHITESPACE","\n    ",70],"}",["T_WHITESPACE","\n\n    ",71],["T_PUBLIC","public",73],["T_WHITESPACE"," ",73],["T_FUNCTION","function",73],["T_WHITESPACE"," ",73],["T_STRING","testUseExistingTokenIfAvailable",73],"(",")",["T_WHITESPACE","\n    ",73],"{",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","storage",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","expects",75],"(",["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","once",75],"(",")",")",["T_WHITESPACE","\n            ",75],["T_OBJECT_OPERATOR","->",76],["T_STRING","method",76],"(",["T_CONSTANT_ENCAPSED_STRING","'hasToken'",76],")",["T_WHITESPACE","\n            ",76],["T_OBJECT_OPERATOR","->",77],["T_STRING","with",77],"(",["T_CONSTANT_ENCAPSED_STRING","'token_id'",77],")",["T_WHITESPACE","\n            ",77],["T_OBJECT_OPERATOR","->",78],["T_STRING","will",78],"(",["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","returnValue",78],"(",["T_STRING","true",78],")",")",";",["T_WHITESPACE","\n\n        ",78],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","storage",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","expects",80],"(",["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","once",80],"(",")",")",["T_WHITESPACE","\n            ",80],["T_OBJECT_OPERATOR","->",81],["T_STRING","method",81],"(",["T_CONSTANT_ENCAPSED_STRING","'getToken'",81],")",["T_WHITESPACE","\n            ",81],["T_OBJECT_OPERATOR","->",82],["T_STRING","with",82],"(",["T_CONSTANT_ENCAPSED_STRING","'token_id'",82],")",["T_WHITESPACE","\n            ",82],["T_OBJECT_OPERATOR","->",83],["T_STRING","will",83],"(",["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","returnValue",83],"(",["T_CONSTANT_ENCAPSED_STRING","'TOKEN'",83],")",")",";",["T_WHITESPACE","\n\n        ",83],["T_VARIABLE","$token",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","manager",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","getToken",85],"(",["T_CONSTANT_ENCAPSED_STRING","'token_id'",85],")",";",["T_WHITESPACE","\n\n        ",85],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","assertInstanceOf",87],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Csrf\\CsrfToken'",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$token",87],")",";",["T_WHITESPACE","\n        ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","assertSame",88],"(",["T_CONSTANT_ENCAPSED_STRING","'token_id'",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$token",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","getId",88],"(",")",")",";",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","assertSame",89],"(",["T_CONSTANT_ENCAPSED_STRING","'TOKEN'",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$token",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getValue",89],"(",")",")",";",["T_WHITESPACE","\n    ",89],"}",["T_WHITESPACE","\n\n    ",90],["T_PUBLIC","public",92],["T_WHITESPACE"," ",92],["T_FUNCTION","function",92],["T_WHITESPACE"," ",92],["T_STRING","testRefreshTokenAlwaysReturnsNewToken",92],"(",")",["T_WHITESPACE","\n    ",92],"{",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","storage",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","expects",94],"(",["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","never",94],"(",")",")",["T_WHITESPACE","\n            ",94],["T_OBJECT_OPERATOR","->",95],["T_STRING","method",95],"(",["T_CONSTANT_ENCAPSED_STRING","'hasToken'",95],")",";",["T_WHITESPACE","\n\n        ",95],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","generator",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","expects",97],"(",["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","once",97],"(",")",")",["T_WHITESPACE","\n            ",97],["T_OBJECT_OPERATOR","->",98],["T_STRING","method",98],"(",["T_CONSTANT_ENCAPSED_STRING","'generateToken'",98],")",["T_WHITESPACE","\n            ",98],["T_OBJECT_OPERATOR","->",99],["T_STRING","will",99],"(",["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","returnValue",99],"(",["T_CONSTANT_ENCAPSED_STRING","'TOKEN'",99],")",")",";",["T_WHITESPACE","\n\n        ",99],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","storage",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","expects",101],"(",["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","once",101],"(",")",")",["T_WHITESPACE","\n            ",101],["T_OBJECT_OPERATOR","->",102],["T_STRING","method",102],"(",["T_CONSTANT_ENCAPSED_STRING","'setToken'",102],")",["T_WHITESPACE","\n            ",102],["T_OBJECT_OPERATOR","->",103],["T_STRING","with",103],"(",["T_CONSTANT_ENCAPSED_STRING","'token_id'",103],",",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'TOKEN'",103],")",";",["T_WHITESPACE","\n\n        ",103],["T_VARIABLE","$token",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","manager",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","refreshToken",105],"(",["T_CONSTANT_ENCAPSED_STRING","'token_id'",105],")",";",["T_WHITESPACE","\n\n        ",105],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","assertInstanceOf",107],"(",["T_CONSTANT_ENCAPSED_STRING","'Symfony\\Component\\Security\\Csrf\\CsrfToken'",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$token",107],")",";",["T_WHITESPACE","\n        ",107],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","assertSame",108],"(",["T_CONSTANT_ENCAPSED_STRING","'token_id'",108],",",["T_WHITESPACE"," ",108],["T_VARIABLE","$token",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getId",108],"(",")",")",";",["T_WHITESPACE","\n        ",108],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","assertSame",109],"(",["T_CONSTANT_ENCAPSED_STRING","'TOKEN'",109],",",["T_WHITESPACE"," ",109],["T_VARIABLE","$token",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getValue",109],"(",")",")",";",["T_WHITESPACE","\n    ",109],"}",["T_WHITESPACE","\n\n    ",110],["T_PUBLIC","public",112],["T_WHITESPACE"," ",112],["T_FUNCTION","function",112],["T_WHITESPACE"," ",112],["T_STRING","testMatchingTokenIsValid",112],"(",")",["T_WHITESPACE","\n    ",112],"{",["T_WHITESPACE","\n        ",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","storage",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","expects",114],"(",["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","once",114],"(",")",")",["T_WHITESPACE","\n            ",114],["T_OBJECT_OPERATOR","->",115],["T_STRING","method",115],"(",["T_CONSTANT_ENCAPSED_STRING","'hasToken'",115],")",["T_WHITESPACE","\n            ",115],["T_OBJECT_OPERATOR","->",116],["T_STRING","with",116],"(",["T_CONSTANT_ENCAPSED_STRING","'token_id'",116],")",["T_WHITESPACE","\n            ",116],["T_OBJECT_OPERATOR","->",117],["T_STRING","will",117],"(",["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","returnValue",117],"(",["T_STRING","true",117],")",")",";",["T_WHITESPACE","\n\n        ",117],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","storage",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","expects",119],"(",["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","once",119],"(",")",")",["T_WHITESPACE","\n            ",119],["T_OBJECT_OPERATOR","->",120],["T_STRING","method",120],"(",["T_CONSTANT_ENCAPSED_STRING","'getToken'",120],")",["T_WHITESPACE","\n            ",120],["T_OBJECT_OPERATOR","->",121],["T_STRING","with",121],"(",["T_CONSTANT_ENCAPSED_STRING","'token_id'",121],")",["T_WHITESPACE","\n            ",121],["T_OBJECT_OPERATOR","->",122],["T_STRING","will",122],"(",["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","returnValue",122],"(",["T_CONSTANT_ENCAPSED_STRING","'TOKEN'",122],")",")",";",["T_WHITESPACE","\n\n        ",122],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","assertTrue",124],"(",["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","manager",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","isTokenValid",124],"(",["T_NEW","new",124],["T_WHITESPACE"," ",124],["T_STRING","CsrfToken",124],"(",["T_CONSTANT_ENCAPSED_STRING","'token_id'",124],",",["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","'TOKEN'",124],")",")",")",";",["T_WHITESPACE","\n    ",124],"}",["T_WHITESPACE","\n\n    ",125],["T_PUBLIC","public",127],["T_WHITESPACE"," ",127],["T_FUNCTION","function",127],["T_WHITESPACE"," ",127],["T_STRING","testNonMatchingTokenIsNotValid",127],"(",")",["T_WHITESPACE","\n    ",127],"{",["T_WHITESPACE","\n        ",128],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","storage",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","expects",129],"(",["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","once",129],"(",")",")",["T_WHITESPACE","\n            ",129],["T_OBJECT_OPERATOR","->",130],["T_STRING","method",130],"(",["T_CONSTANT_ENCAPSED_STRING","'hasToken'",130],")",["T_WHITESPACE","\n            ",130],["T_OBJECT_OPERATOR","->",131],["T_STRING","with",131],"(",["T_CONSTANT_ENCAPSED_STRING","'token_id'",131],")",["T_WHITESPACE","\n            ",131],["T_OBJECT_OPERATOR","->",132],["T_STRING","will",132],"(",["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","returnValue",132],"(",["T_STRING","true",132],")",")",";",["T_WHITESPACE","\n\n        ",132],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","storage",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","expects",134],"(",["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","once",134],"(",")",")",["T_WHITESPACE","\n            ",134],["T_OBJECT_OPERATOR","->",135],["T_STRING","method",135],"(",["T_CONSTANT_ENCAPSED_STRING","'getToken'",135],")",["T_WHITESPACE","\n            ",135],["T_OBJECT_OPERATOR","->",136],["T_STRING","with",136],"(",["T_CONSTANT_ENCAPSED_STRING","'token_id'",136],")",["T_WHITESPACE","\n            ",136],["T_OBJECT_OPERATOR","->",137],["T_STRING","will",137],"(",["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","returnValue",137],"(",["T_CONSTANT_ENCAPSED_STRING","'TOKEN'",137],")",")",";",["T_WHITESPACE","\n\n        ",137],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","assertFalse",139],"(",["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","manager",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","isTokenValid",139],"(",["T_NEW","new",139],["T_WHITESPACE"," ",139],["T_STRING","CsrfToken",139],"(",["T_CONSTANT_ENCAPSED_STRING","'token_id'",139],",",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'FOOBAR'",139],")",")",")",";",["T_WHITESPACE","\n    ",139],"}",["T_WHITESPACE","\n\n    ",140],["T_PUBLIC","public",142],["T_WHITESPACE"," ",142],["T_FUNCTION","function",142],["T_WHITESPACE"," ",142],["T_STRING","testNonExistingTokenIsNotValid",142],"(",")",["T_WHITESPACE","\n    ",142],"{",["T_WHITESPACE","\n        ",143],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","storage",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","expects",144],"(",["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","once",144],"(",")",")",["T_WHITESPACE","\n            ",144],["T_OBJECT_OPERATOR","->",145],["T_STRING","method",145],"(",["T_CONSTANT_ENCAPSED_STRING","'hasToken'",145],")",["T_WHITESPACE","\n            ",145],["T_OBJECT_OPERATOR","->",146],["T_STRING","with",146],"(",["T_CONSTANT_ENCAPSED_STRING","'token_id'",146],")",["T_WHITESPACE","\n            ",146],["T_OBJECT_OPERATOR","->",147],["T_STRING","will",147],"(",["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","returnValue",147],"(",["T_STRING","false",147],")",")",";",["T_WHITESPACE","\n\n        ",147],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","storage",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","expects",149],"(",["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","never",149],"(",")",")",["T_WHITESPACE","\n            ",149],["T_OBJECT_OPERATOR","->",150],["T_STRING","method",150],"(",["T_CONSTANT_ENCAPSED_STRING","'getToken'",150],")",";",["T_WHITESPACE","\n\n        ",150],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","assertFalse",152],"(",["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","manager",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","isTokenValid",152],"(",["T_NEW","new",152],["T_WHITESPACE"," ",152],["T_STRING","CsrfToken",152],"(",["T_CONSTANT_ENCAPSED_STRING","'token_id'",152],",",["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","'FOOBAR'",152],")",")",")",";",["T_WHITESPACE","\n    ",152],"}",["T_WHITESPACE","\n\n    ",153],["T_PUBLIC","public",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","testRemoveToken",155],"(",")",["T_WHITESPACE","\n    ",155],"{",["T_WHITESPACE","\n        ",156],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","storage",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","expects",157],"(",["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","once",157],"(",")",")",["T_WHITESPACE","\n            ",157],["T_OBJECT_OPERATOR","->",158],["T_STRING","method",158],"(",["T_CONSTANT_ENCAPSED_STRING","'removeToken'",158],")",["T_WHITESPACE","\n            ",158],["T_OBJECT_OPERATOR","->",159],["T_STRING","with",159],"(",["T_CONSTANT_ENCAPSED_STRING","'token_id'",159],")",["T_WHITESPACE","\n            ",159],["T_OBJECT_OPERATOR","->",160],["T_STRING","will",160],"(",["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","returnValue",160],"(",["T_CONSTANT_ENCAPSED_STRING","'REMOVED_TOKEN'",160],")",")",";",["T_WHITESPACE","\n\n        ",160],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","assertSame",162],"(",["T_CONSTANT_ENCAPSED_STRING","'REMOVED_TOKEN'",162],",",["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","manager",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","removeToken",162],"(",["T_CONSTANT_ENCAPSED_STRING","'token_id'",162],")",")",";",["T_WHITESPACE","\n    ",162],"}",["T_WHITESPACE","\n",163],"}",["T_WHITESPACE","\n",164]]