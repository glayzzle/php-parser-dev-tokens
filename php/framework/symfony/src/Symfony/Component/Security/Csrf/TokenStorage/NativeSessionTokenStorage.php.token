[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Security",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Csrf",12],["T_NS_SEPARATOR","\\",12],["T_STRING","TokenStorage",12],";",["T_WHITESPACE","\n\n",12],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Symfony",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Component",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Security",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Csrf",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Exception",14],["T_NS_SEPARATOR","\\",14],["T_STRING","TokenNotFoundException",14],";",["T_WHITESPACE","\n\n",14],["T_DOC_COMMENT","\/**\n * Token storage that uses PHP's native session handling.\n *\n * @author Bernhard Schussek <bschussek@gmail.com>\n *\/",16],["T_WHITESPACE","\n",20],["T_CLASS","class",21],["T_WHITESPACE"," ",21],["T_STRING","NativeSessionTokenStorage",21],["T_WHITESPACE"," ",21],["T_IMPLEMENTS","implements",21],["T_WHITESPACE"," ",21],["T_STRING","TokenStorageInterface",21],["T_WHITESPACE","\n",21],"{",["T_WHITESPACE","\n    ",22],["T_DOC_COMMENT","\/**\n     * The namespace used to store values in the session.\n     *\n     * @var string\n     *\/",23],["T_WHITESPACE","\n    ",27],["T_CONST","const",28],["T_WHITESPACE"," ",28],["T_STRING","SESSION_NAMESPACE",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_CONSTANT_ENCAPSED_STRING","'_csrf'",28],";",["T_WHITESPACE","\n\n    ",28],["T_DOC_COMMENT","\/**\n     * @var bool\n     *\/",30],["T_WHITESPACE","\n    ",32],["T_PRIVATE","private",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$sessionStarted",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_STRING","false",33],";",["T_WHITESPACE","\n\n    ",33],["T_DOC_COMMENT","\/**\n     * @var string\n     *\/",35],["T_WHITESPACE","\n    ",37],["T_PRIVATE","private",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$namespace",38],";",["T_WHITESPACE","\n\n    ",38],["T_DOC_COMMENT","\/**\n     * Initializes the storage with a session namespace.\n     *\n     * @param string $namespace The namespace under which the token is stored\n     *                          in the session\n     *\/",40],["T_WHITESPACE","\n    ",45],["T_PUBLIC","public",46],["T_WHITESPACE"," ",46],["T_FUNCTION","function",46],["T_WHITESPACE"," ",46],["T_STRING","__construct",46],"(",["T_VARIABLE","$namespace",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_STRING","self",46],["T_DOUBLE_COLON","::",46],["T_STRING","SESSION_NAMESPACE",46],")",["T_WHITESPACE","\n    ",46],"{",["T_WHITESPACE","\n        ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","namespace",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$namespace",48],";",["T_WHITESPACE","\n    ",48],"}",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",51],["T_WHITESPACE","\n    ",53],["T_PUBLIC","public",54],["T_WHITESPACE"," ",54],["T_FUNCTION","function",54],["T_WHITESPACE"," ",54],["T_STRING","getToken",54],"(",["T_VARIABLE","$tokenId",54],")",["T_WHITESPACE","\n    ",54],"{",["T_WHITESPACE","\n        ",55],["T_IF","if",56],["T_WHITESPACE"," ",56],"(","!",["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","sessionStarted",56],")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n            ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","startSession",57],"(",")",";",["T_WHITESPACE","\n        ",57],"}",["T_WHITESPACE","\n\n        ",58],["T_IF","if",60],["T_WHITESPACE"," ",60],"(","!",["T_ISSET","isset",60],"(",["T_VARIABLE","$_SESSION",60],"[",["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","namespace",60],"]","[",["T_VARIABLE","$tokenId",60],"]",")",")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n            ",60],["T_THROW","throw",61],["T_WHITESPACE"," ",61],["T_NEW","new",61],["T_WHITESPACE"," ",61],["T_STRING","TokenNotFoundException",61],"(",["T_CONSTANT_ENCAPSED_STRING","'The CSRF token with ID '",61],".",["T_VARIABLE","$tokenId",61],".",["T_CONSTANT_ENCAPSED_STRING","' does not exist.'",61],")",";",["T_WHITESPACE","\n        ",61],"}",["T_WHITESPACE","\n\n        ",62],["T_RETURN","return",64],["T_WHITESPACE"," ",64],["T_STRING_CAST","(string)",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$_SESSION",64],"[",["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","namespace",64],"]","[",["T_VARIABLE","$tokenId",64],"]",";",["T_WHITESPACE","\n    ",64],"}",["T_WHITESPACE","\n\n    ",65],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",67],["T_WHITESPACE","\n    ",69],["T_PUBLIC","public",70],["T_WHITESPACE"," ",70],["T_FUNCTION","function",70],["T_WHITESPACE"," ",70],["T_STRING","setToken",70],"(",["T_VARIABLE","$tokenId",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$token",70],")",["T_WHITESPACE","\n    ",70],"{",["T_WHITESPACE","\n        ",71],["T_IF","if",72],["T_WHITESPACE"," ",72],"(","!",["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","sessionStarted",72],")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n            ",72],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","startSession",73],"(",")",";",["T_WHITESPACE","\n        ",73],"}",["T_WHITESPACE","\n\n        ",74],["T_VARIABLE","$_SESSION",76],"[",["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","namespace",76],"]","[",["T_VARIABLE","$tokenId",76],"]",["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_STRING_CAST","(string)",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$token",76],";",["T_WHITESPACE","\n    ",76],"}",["T_WHITESPACE","\n\n    ",77],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",79],["T_WHITESPACE","\n    ",81],["T_PUBLIC","public",82],["T_WHITESPACE"," ",82],["T_FUNCTION","function",82],["T_WHITESPACE"," ",82],["T_STRING","hasToken",82],"(",["T_VARIABLE","$tokenId",82],")",["T_WHITESPACE","\n    ",82],"{",["T_WHITESPACE","\n        ",83],["T_IF","if",84],["T_WHITESPACE"," ",84],"(","!",["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","sessionStarted",84],")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n            ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","startSession",85],"(",")",";",["T_WHITESPACE","\n        ",85],"}",["T_WHITESPACE","\n\n        ",86],["T_RETURN","return",88],["T_WHITESPACE"," ",88],["T_ISSET","isset",88],"(",["T_VARIABLE","$_SESSION",88],"[",["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","namespace",88],"]","[",["T_VARIABLE","$tokenId",88],"]",")",";",["T_WHITESPACE","\n    ",88],"}",["T_WHITESPACE","\n\n    ",89],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",91],["T_WHITESPACE","\n    ",93],["T_PUBLIC","public",94],["T_WHITESPACE"," ",94],["T_FUNCTION","function",94],["T_WHITESPACE"," ",94],["T_STRING","removeToken",94],"(",["T_VARIABLE","$tokenId",94],")",["T_WHITESPACE","\n    ",94],"{",["T_WHITESPACE","\n        ",95],["T_IF","if",96],["T_WHITESPACE"," ",96],"(","!",["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","sessionStarted",96],")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n            ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","startSession",97],"(",")",";",["T_WHITESPACE","\n        ",97],"}",["T_WHITESPACE","\n\n        ",98],["T_VARIABLE","$token",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_ISSET","isset",100],"(",["T_VARIABLE","$_SESSION",100],"[",["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","namespace",100],"]","[",["T_VARIABLE","$tokenId",100],"]",")",["T_WHITESPACE","\n            ",100],"?",["T_WHITESPACE"," ",101],["T_STRING_CAST","(string)",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$_SESSION",101],"[",["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","namespace",101],"]","[",["T_VARIABLE","$tokenId",101],"]",["T_WHITESPACE","\n            ",101],":",["T_WHITESPACE"," ",102],["T_STRING","null",102],";",["T_WHITESPACE","\n\n        ",102],["T_UNSET","unset",104],"(",["T_VARIABLE","$_SESSION",104],"[",["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","namespace",104],"]","[",["T_VARIABLE","$tokenId",104],"]",")",";",["T_WHITESPACE","\n\n        ",104],["T_RETURN","return",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$token",106],";",["T_WHITESPACE","\n    ",106],"}",["T_WHITESPACE","\n\n    ",107],["T_PRIVATE","private",109],["T_WHITESPACE"," ",109],["T_FUNCTION","function",109],["T_WHITESPACE"," ",109],["T_STRING","startSession",109],"(",")",["T_WHITESPACE","\n    ",109],"{",["T_WHITESPACE","\n        ",110],["T_IF","if",111],["T_WHITESPACE"," ",111],"(",["T_STRING","PHP_SESSION_NONE",111],["T_WHITESPACE"," ",111],["T_IS_IDENTICAL","===",111],["T_WHITESPACE"," ",111],["T_STRING","session_status",111],"(",")",")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n            ",111],["T_STRING","session_start",112],"(",")",";",["T_WHITESPACE","\n        ",112],"}",["T_WHITESPACE","\n\n        ",113],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","sessionStarted",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_STRING","true",115],";",["T_WHITESPACE","\n    ",115],"}",["T_WHITESPACE","\n",116],"}",["T_WHITESPACE","\n",117]]