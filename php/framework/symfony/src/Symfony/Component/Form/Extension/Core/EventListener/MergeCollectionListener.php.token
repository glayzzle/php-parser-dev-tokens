[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Form",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Extension",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Core",12],["T_NS_SEPARATOR","\\",12],["T_STRING","EventListener",12],";",["T_WHITESPACE","\n\n",12],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Symfony",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Component",14],["T_NS_SEPARATOR","\\",14],["T_STRING","EventDispatcher",14],["T_NS_SEPARATOR","\\",14],["T_STRING","EventSubscriberInterface",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Symfony",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Component",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Form",15],["T_NS_SEPARATOR","\\",15],["T_STRING","FormEvents",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Symfony",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Component",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Form",16],["T_NS_SEPARATOR","\\",16],["T_STRING","FormEvent",16],";",["T_WHITESPACE","\n",16],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Symfony",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Component",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Form",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Exception",17],["T_NS_SEPARATOR","\\",17],["T_STRING","UnexpectedTypeException",17],";",["T_WHITESPACE","\n\n",17],["T_DOC_COMMENT","\/**\n * @author Bernhard Schussek <bschussek@gmail.com>\n *\/",19],["T_WHITESPACE","\n",21],["T_CLASS","class",22],["T_WHITESPACE"," ",22],["T_STRING","MergeCollectionListener",22],["T_WHITESPACE"," ",22],["T_IMPLEMENTS","implements",22],["T_WHITESPACE"," ",22],["T_STRING","EventSubscriberInterface",22],["T_WHITESPACE","\n",22],"{",["T_WHITESPACE","\n    ",23],["T_DOC_COMMENT","\/**\n     * Whether elements may be added to the collection.\n     *\n     * @var bool\n     *\/",24],["T_WHITESPACE","\n    ",28],["T_PRIVATE","private",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$allowAdd",29],";",["T_WHITESPACE","\n\n    ",29],["T_DOC_COMMENT","\/**\n     * Whether elements may be removed from the collection.\n     *\n     * @var bool\n     *\/",31],["T_WHITESPACE","\n    ",35],["T_PRIVATE","private",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$allowDelete",36],";",["T_WHITESPACE","\n\n    ",36],["T_DOC_COMMENT","\/**\n     * Creates a new listener.\n     *\n     * @param bool $allowAdd    Whether values might be added to the\n     *                          collection.\n     * @param bool $allowDelete Whether values might be removed from the\n     *                          collection.\n     *\/",38],["T_WHITESPACE","\n    ",45],["T_PUBLIC","public",46],["T_WHITESPACE"," ",46],["T_FUNCTION","function",46],["T_WHITESPACE"," ",46],["T_STRING","__construct",46],"(",["T_VARIABLE","$allowAdd",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_STRING","false",46],",",["T_WHITESPACE"," ",46],["T_VARIABLE","$allowDelete",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_STRING","false",46],")",["T_WHITESPACE","\n    ",46],"{",["T_WHITESPACE","\n        ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","allowAdd",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$allowAdd",48],";",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","allowDelete",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$allowDelete",49],";",["T_WHITESPACE","\n    ",49],"}",["T_WHITESPACE","\n\n    ",50],["T_PUBLIC","public",52],["T_WHITESPACE"," ",52],["T_STATIC","static",52],["T_WHITESPACE"," ",52],["T_FUNCTION","function",52],["T_WHITESPACE"," ",52],["T_STRING","getSubscribedEvents",52],"(",")",["T_WHITESPACE","\n    ",52],"{",["T_WHITESPACE","\n        ",53],["T_RETURN","return",54],["T_WHITESPACE"," ",54],["T_ARRAY","array",54],"(",["T_WHITESPACE","\n            ",54],["T_STRING","FormEvents",55],["T_DOUBLE_COLON","::",55],["T_STRING","SUBMIT",55],["T_WHITESPACE"," ",55],["T_DOUBLE_ARROW","=>",55],["T_WHITESPACE"," ",55],["T_CONSTANT_ENCAPSED_STRING","'onSubmit'",55],",",["T_WHITESPACE","\n        ",55],")",";",["T_WHITESPACE","\n    ",56],"}",["T_WHITESPACE","\n\n    ",57],["T_PUBLIC","public",59],["T_WHITESPACE"," ",59],["T_FUNCTION","function",59],["T_WHITESPACE"," ",59],["T_STRING","onSubmit",59],"(",["T_STRING","FormEvent",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$event",59],")",["T_WHITESPACE","\n    ",59],"{",["T_WHITESPACE","\n        ",60],["T_VARIABLE","$dataToMergeInto",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_VARIABLE","$event",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","getForm",61],"(",")",["T_OBJECT_OPERATOR","->",61],["T_STRING","getNormData",61],"(",")",";",["T_WHITESPACE","\n        ",61],["T_VARIABLE","$data",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_VARIABLE","$event",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","getData",62],"(",")",";",["T_WHITESPACE","\n\n        ",62],["T_IF","if",64],["T_WHITESPACE"," ",64],"(",["T_STRING","null",64],["T_WHITESPACE"," ",64],["T_IS_IDENTICAL","===",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$data",64],")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n            ",64],["T_VARIABLE","$data",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_ARRAY","array",65],"(",")",";",["T_WHITESPACE","\n        ",65],"}",["T_WHITESPACE","\n\n        ",66],["T_IF","if",68],["T_WHITESPACE"," ",68],"(","!",["T_STRING","is_array",68],"(",["T_VARIABLE","$data",68],")",["T_WHITESPACE"," ",68],["T_BOOLEAN_AND","&&",68],["T_WHITESPACE"," ",68],"!","(",["T_VARIABLE","$data",68],["T_WHITESPACE"," ",68],["T_INSTANCEOF","instanceof",68],["T_WHITESPACE"," ",68],["T_NS_SEPARATOR","\\",68],["T_STRING","Traversable",68],["T_WHITESPACE"," ",68],["T_BOOLEAN_AND","&&",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$data",68],["T_WHITESPACE"," ",68],["T_INSTANCEOF","instanceof",68],["T_WHITESPACE"," ",68],["T_NS_SEPARATOR","\\",68],["T_STRING","ArrayAccess",68],")",")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n            ",68],["T_THROW","throw",69],["T_WHITESPACE"," ",69],["T_NEW","new",69],["T_WHITESPACE"," ",69],["T_STRING","UnexpectedTypeException",69],"(",["T_VARIABLE","$data",69],",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'array or (\\Traversable and \\ArrayAccess)'",69],")",";",["T_WHITESPACE","\n        ",69],"}",["T_WHITESPACE","\n\n        ",70],["T_IF","if",72],["T_WHITESPACE"," ",72],"(",["T_STRING","null",72],["T_WHITESPACE"," ",72],["T_IS_NOT_IDENTICAL","!==",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$dataToMergeInto",72],["T_WHITESPACE"," ",72],["T_BOOLEAN_AND","&&",72],["T_WHITESPACE"," ",72],"!",["T_STRING","is_array",72],"(",["T_VARIABLE","$dataToMergeInto",72],")",["T_WHITESPACE"," ",72],["T_BOOLEAN_AND","&&",72],["T_WHITESPACE"," ",72],"!","(",["T_VARIABLE","$dataToMergeInto",72],["T_WHITESPACE"," ",72],["T_INSTANCEOF","instanceof",72],["T_WHITESPACE"," ",72],["T_NS_SEPARATOR","\\",72],["T_STRING","Traversable",72],["T_WHITESPACE"," ",72],["T_BOOLEAN_AND","&&",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$dataToMergeInto",72],["T_WHITESPACE"," ",72],["T_INSTANCEOF","instanceof",72],["T_WHITESPACE"," ",72],["T_NS_SEPARATOR","\\",72],["T_STRING","ArrayAccess",72],")",")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n            ",72],["T_THROW","throw",73],["T_WHITESPACE"," ",73],["T_NEW","new",73],["T_WHITESPACE"," ",73],["T_STRING","UnexpectedTypeException",73],"(",["T_VARIABLE","$dataToMergeInto",73],",",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'array or (\\Traversable and \\ArrayAccess)'",73],")",";",["T_WHITESPACE","\n        ",73],"}",["T_WHITESPACE","\n\n        ",74],["T_COMMENT","\/\/ If we are not allowed to change anything, return immediately\n",76],["T_WHITESPACE","        ",77],["T_IF","if",77],["T_WHITESPACE"," ",77],"(",["T_VARIABLE","$data",77],["T_WHITESPACE"," ",77],["T_IS_IDENTICAL","===",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$dataToMergeInto",77],["T_WHITESPACE"," ",77],["T_BOOLEAN_OR","||",77],["T_WHITESPACE"," ",77],"(","!",["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","allowAdd",77],["T_WHITESPACE"," ",77],["T_BOOLEAN_AND","&&",77],["T_WHITESPACE"," ",77],"!",["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","allowDelete",77],")",")",["T_WHITESPACE"," ",77],"{",["T_WHITESPACE","\n            ",77],["T_VARIABLE","$event",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","setData",78],"(",["T_VARIABLE","$dataToMergeInto",78],")",";",["T_WHITESPACE","\n\n            ",78],["T_RETURN","return",80],";",["T_WHITESPACE","\n        ",80],"}",["T_WHITESPACE","\n\n        ",81],["T_IF","if",83],["T_WHITESPACE"," ",83],"(","!",["T_VARIABLE","$dataToMergeInto",83],")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n            ",83],["T_COMMENT","\/\/ No original data was set. Set it if allowed\n",84],["T_WHITESPACE","            ",85],["T_IF","if",85],["T_WHITESPACE"," ",85],"(",["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","allowAdd",85],")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n                ",85],["T_VARIABLE","$dataToMergeInto",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$data",86],";",["T_WHITESPACE","\n            ",86],"}",["T_WHITESPACE","\n        ",87],"}",["T_WHITESPACE"," ",88],["T_ELSE","else",88],["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n            ",88],["T_COMMENT","\/\/ Calculate delta\n",89],["T_WHITESPACE","            ",90],["T_VARIABLE","$itemsToAdd",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_STRING","is_object",90],"(",["T_VARIABLE","$data",90],")",["T_WHITESPACE"," ",90],"?",["T_WHITESPACE"," ",90],["T_CLONE","clone",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$data",90],["T_WHITESPACE"," ",90],":",["T_WHITESPACE"," ",90],["T_VARIABLE","$data",90],";",["T_WHITESPACE","\n            ",90],["T_VARIABLE","$itemsToDelete",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_ARRAY","array",91],"(",")",";",["T_WHITESPACE","\n\n            ",91],["T_FOREACH","foreach",93],["T_WHITESPACE"," ",93],"(",["T_VARIABLE","$dataToMergeInto",93],["T_WHITESPACE"," ",93],["T_AS","as",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$beforeKey",93],["T_WHITESPACE"," ",93],["T_DOUBLE_ARROW","=>",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$beforeItem",93],")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n                ",93],["T_FOREACH","foreach",94],["T_WHITESPACE"," ",94],"(",["T_VARIABLE","$data",94],["T_WHITESPACE"," ",94],["T_AS","as",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$afterKey",94],["T_WHITESPACE"," ",94],["T_DOUBLE_ARROW","=>",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$afterItem",94],")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n                    ",94],["T_IF","if",95],["T_WHITESPACE"," ",95],"(",["T_VARIABLE","$afterItem",95],["T_WHITESPACE"," ",95],["T_IS_IDENTICAL","===",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$beforeItem",95],")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n                        ",95],["T_COMMENT","\/\/ Item found, next original item\n",96],["T_WHITESPACE","                        ",97],["T_UNSET","unset",97],"(",["T_VARIABLE","$itemsToAdd",97],"[",["T_VARIABLE","$afterKey",97],"]",")",";",["T_WHITESPACE","\n                        ",97],["T_CONTINUE","continue",98],["T_WHITESPACE"," ",98],["T_LNUMBER","2",98],";",["T_WHITESPACE","\n                    ",98],"}",["T_WHITESPACE","\n                ",99],"}",["T_WHITESPACE","\n\n                ",100],["T_COMMENT","\/\/ Item not found, remember for deletion\n",102],["T_WHITESPACE","                ",103],["T_VARIABLE","$itemsToDelete",103],"[","]",["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$beforeKey",103],";",["T_WHITESPACE","\n            ",103],"}",["T_WHITESPACE","\n\n            ",104],["T_COMMENT","\/\/ Remove deleted items before adding to free keys that are to be\n",106],["T_WHITESPACE","            ",107],["T_COMMENT","\/\/ replaced\n",107],["T_WHITESPACE","            ",108],["T_IF","if",108],["T_WHITESPACE"," ",108],"(",["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","allowDelete",108],")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n                ",108],["T_FOREACH","foreach",109],["T_WHITESPACE"," ",109],"(",["T_VARIABLE","$itemsToDelete",109],["T_WHITESPACE"," ",109],["T_AS","as",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$key",109],")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n                    ",109],["T_UNSET","unset",110],"(",["T_VARIABLE","$dataToMergeInto",110],"[",["T_VARIABLE","$key",110],"]",")",";",["T_WHITESPACE","\n                ",110],"}",["T_WHITESPACE","\n            ",111],"}",["T_WHITESPACE","\n\n            ",112],["T_COMMENT","\/\/ Add remaining items\n",114],["T_WHITESPACE","            ",115],["T_IF","if",115],["T_WHITESPACE"," ",115],"(",["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","allowAdd",115],")",["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n                ",115],["T_FOREACH","foreach",116],["T_WHITESPACE"," ",116],"(",["T_VARIABLE","$itemsToAdd",116],["T_WHITESPACE"," ",116],["T_AS","as",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$key",116],["T_WHITESPACE"," ",116],["T_DOUBLE_ARROW","=>",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$item",116],")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n                    ",116],["T_IF","if",117],["T_WHITESPACE"," ",117],"(","!",["T_ISSET","isset",117],"(",["T_VARIABLE","$dataToMergeInto",117],"[",["T_VARIABLE","$key",117],"]",")",")",["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n                        ",117],["T_VARIABLE","$dataToMergeInto",118],"[",["T_VARIABLE","$key",118],"]",["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$item",118],";",["T_WHITESPACE","\n                    ",118],"}",["T_WHITESPACE"," ",119],["T_ELSE","else",119],["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n                        ",119],["T_VARIABLE","$dataToMergeInto",120],"[","]",["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_VARIABLE","$item",120],";",["T_WHITESPACE","\n                    ",120],"}",["T_WHITESPACE","\n                ",121],"}",["T_WHITESPACE","\n            ",122],"}",["T_WHITESPACE","\n        ",123],"}",["T_WHITESPACE","\n\n        ",124],["T_VARIABLE","$event",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","setData",126],"(",["T_VARIABLE","$dataToMergeInto",126],")",";",["T_WHITESPACE","\n    ",126],"}",["T_WHITESPACE","\n",127],"}",["T_WHITESPACE","\n",128]]