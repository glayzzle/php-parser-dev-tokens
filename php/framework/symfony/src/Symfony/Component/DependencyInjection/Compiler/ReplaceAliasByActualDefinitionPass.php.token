[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","DependencyInjection",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Compiler",12],";",["T_WHITESPACE","\n\n",12],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Symfony",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Component",14],["T_NS_SEPARATOR","\\",14],["T_STRING","DependencyInjection",14],["T_NS_SEPARATOR","\\",14],["T_STRING","ContainerBuilder",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Symfony",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Component",15],["T_NS_SEPARATOR","\\",15],["T_STRING","DependencyInjection",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Exception",15],["T_NS_SEPARATOR","\\",15],["T_STRING","InvalidArgumentException",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Symfony",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Component",16],["T_NS_SEPARATOR","\\",16],["T_STRING","DependencyInjection",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Reference",16],";",["T_WHITESPACE","\n\n",16],["T_DOC_COMMENT","\/**\n * Replaces aliases with actual service definitions, effectively removing these\n * aliases.\n *\n * @author Johannes M. Schmitt <schmittjoh@gmail.com>\n *\/",18],["T_WHITESPACE","\n",23],["T_CLASS","class",24],["T_WHITESPACE"," ",24],["T_STRING","ReplaceAliasByActualDefinitionPass",24],["T_WHITESPACE"," ",24],["T_EXTENDS","extends",24],["T_WHITESPACE"," ",24],["T_STRING","AbstractRecursivePass",24],["T_WHITESPACE"," ",24],["T_IMPLEMENTS","implements",24],["T_WHITESPACE"," ",24],["T_STRING","CompilerPassInterface",24],["T_WHITESPACE","\n",24],"{",["T_WHITESPACE","\n    ",25],["T_PRIVATE","private",26],["T_WHITESPACE"," ",26],["T_VARIABLE","$replacements",26],";",["T_WHITESPACE","\n\n    ",26],["T_DOC_COMMENT","\/**\n     * Process the Container to replace aliases with service definitions.\n     *\n     * @param ContainerBuilder $container\n     *\n     * @throws InvalidArgumentException if the service definition does not exist\n     *\/",28],["T_WHITESPACE","\n    ",34],["T_PUBLIC","public",35],["T_WHITESPACE"," ",35],["T_FUNCTION","function",35],["T_WHITESPACE"," ",35],["T_STRING","process",35],"(",["T_STRING","ContainerBuilder",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$container",35],")",["T_WHITESPACE","\n    ",35],"{",["T_WHITESPACE","\n        ",36],["T_COMMENT","\/\/ First collect all alias targets that need to be replaced\n",37],["T_WHITESPACE","        ",38],["T_VARIABLE","$seenAliasTargets",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_ARRAY","array",38],"(",")",";",["T_WHITESPACE","\n        ",38],["T_VARIABLE","$replacements",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_ARRAY","array",39],"(",")",";",["T_WHITESPACE","\n        ",39],["T_FOREACH","foreach",40],["T_WHITESPACE"," ",40],"(",["T_VARIABLE","$container",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","getAliases",40],"(",")",["T_WHITESPACE"," ",40],["T_AS","as",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$definitionId",40],["T_WHITESPACE"," ",40],["T_DOUBLE_ARROW","=>",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$target",40],")",["T_WHITESPACE"," ",40],"{",["T_WHITESPACE","\n            ",40],["T_VARIABLE","$targetId",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_STRING_CAST","(string)",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$target",41],";",["T_WHITESPACE","\n            ",41],["T_COMMENT","\/\/ Special case: leave this target alone\n",42],["T_WHITESPACE","            ",43],["T_IF","if",43],["T_WHITESPACE"," ",43],"(",["T_CONSTANT_ENCAPSED_STRING","'service_container'",43],["T_WHITESPACE"," ",43],["T_IS_IDENTICAL","===",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$targetId",43],")",["T_WHITESPACE"," ",43],"{",["T_WHITESPACE","\n                ",43],["T_CONTINUE","continue",44],";",["T_WHITESPACE","\n            ",44],"}",["T_WHITESPACE","\n            ",45],["T_COMMENT","\/\/ Check if target needs to be replaces\n",46],["T_WHITESPACE","            ",47],["T_IF","if",47],["T_WHITESPACE"," ",47],"(",["T_ISSET","isset",47],"(",["T_VARIABLE","$replacements",47],"[",["T_VARIABLE","$targetId",47],"]",")",")",["T_WHITESPACE"," ",47],"{",["T_WHITESPACE","\n                ",47],["T_VARIABLE","$container",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","setAlias",48],"(",["T_VARIABLE","$definitionId",48],",",["T_WHITESPACE"," ",48],["T_VARIABLE","$replacements",48],"[",["T_VARIABLE","$targetId",48],"]",")",";",["T_WHITESPACE","\n            ",48],"}",["T_WHITESPACE","\n            ",49],["T_COMMENT","\/\/ No neeed to process the same target twice\n",50],["T_WHITESPACE","            ",51],["T_IF","if",51],["T_WHITESPACE"," ",51],"(",["T_ISSET","isset",51],"(",["T_VARIABLE","$seenAliasTargets",51],"[",["T_VARIABLE","$targetId",51],"]",")",")",["T_WHITESPACE"," ",51],"{",["T_WHITESPACE","\n                ",51],["T_CONTINUE","continue",52],";",["T_WHITESPACE","\n            ",52],"}",["T_WHITESPACE","\n            ",53],["T_COMMENT","\/\/ Process new target\n",54],["T_WHITESPACE","            ",55],["T_VARIABLE","$seenAliasTargets",55],"[",["T_VARIABLE","$targetId",55],"]",["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","true",55],";",["T_WHITESPACE","\n            ",55],["T_TRY","try",56],["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n                ",56],["T_VARIABLE","$definition",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$container",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","getDefinition",57],"(",["T_VARIABLE","$targetId",57],")",";",["T_WHITESPACE","\n            ",57],"}",["T_WHITESPACE"," ",58],["T_CATCH","catch",58],["T_WHITESPACE"," ",58],"(",["T_STRING","InvalidArgumentException",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$e",58],")",["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n                ",58],["T_THROW","throw",59],["T_WHITESPACE"," ",59],["T_NEW","new",59],["T_WHITESPACE"," ",59],["T_STRING","InvalidArgumentException",59],"(",["T_STRING","sprintf",59],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to replace alias \"%s\" with actual definition \"%s\".'",59],",",["T_WHITESPACE"," ",59],["T_VARIABLE","$definitionId",59],",",["T_WHITESPACE"," ",59],["T_VARIABLE","$targetId",59],")",",",["T_WHITESPACE"," ",59],["T_STRING","null",59],",",["T_WHITESPACE"," ",59],["T_VARIABLE","$e",59],")",";",["T_WHITESPACE","\n            ",59],"}",["T_WHITESPACE","\n            ",60],["T_IF","if",61],["T_WHITESPACE"," ",61],"(",["T_VARIABLE","$definition",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","isPublic",61],"(",")",")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n                ",61],["T_CONTINUE","continue",62],";",["T_WHITESPACE","\n            ",62],"}",["T_WHITESPACE","\n            ",63],["T_COMMENT","\/\/ Remove private definition and schedule for replacement\n",64],["T_WHITESPACE","            ",65],["T_VARIABLE","$definition",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","setPublic",65],"(",["T_STRING","true",65],")",";",["T_WHITESPACE","\n            ",65],["T_VARIABLE","$container",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","setDefinition",66],"(",["T_VARIABLE","$definitionId",66],",",["T_WHITESPACE"," ",66],["T_VARIABLE","$definition",66],")",";",["T_WHITESPACE","\n            ",66],["T_VARIABLE","$container",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","removeDefinition",67],"(",["T_VARIABLE","$targetId",67],")",";",["T_WHITESPACE","\n            ",67],["T_VARIABLE","$replacements",68],"[",["T_VARIABLE","$targetId",68],"]",["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$definitionId",68],";",["T_WHITESPACE","\n        ",68],"}",["T_WHITESPACE","\n        ",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","replacements",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$replacements",70],";",["T_WHITESPACE","\n\n        ",70],["T_STRING","parent",72],["T_DOUBLE_COLON","::",72],["T_STRING","process",72],"(",["T_VARIABLE","$container",72],")",";",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","replacements",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_ARRAY","array",73],"(",")",";",["T_WHITESPACE","\n    ",73],"}",["T_WHITESPACE","\n\n    ",74],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",76],["T_WHITESPACE","\n    ",78],["T_PROTECTED","protected",79],["T_WHITESPACE"," ",79],["T_FUNCTION","function",79],["T_WHITESPACE"," ",79],["T_STRING","processValue",79],"(",["T_VARIABLE","$value",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$isRoot",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_STRING","false",79],")",["T_WHITESPACE","\n    ",79],"{",["T_WHITESPACE","\n        ",80],["T_IF","if",81],["T_WHITESPACE"," ",81],"(",["T_VARIABLE","$value",81],["T_WHITESPACE"," ",81],["T_INSTANCEOF","instanceof",81],["T_WHITESPACE"," ",81],["T_STRING","Reference",81],["T_WHITESPACE"," ",81],["T_BOOLEAN_AND","&&",81],["T_WHITESPACE"," ",81],["T_ISSET","isset",81],"(",["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","replacements",81],"[",["T_VARIABLE","$referenceId",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_STRING_CAST","(string)",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$value",81],"]",")",")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n            ",81],["T_COMMENT","\/\/ Perform the replacement\n",82],["T_WHITESPACE","            ",83],["T_VARIABLE","$newId",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","replacements",83],"[",["T_VARIABLE","$referenceId",83],"]",";",["T_WHITESPACE","\n            ",83],["T_VARIABLE","$value",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_NEW","new",84],["T_WHITESPACE"," ",84],["T_STRING","Reference",84],"(",["T_VARIABLE","$newId",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$value",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getInvalidBehavior",84],"(",")",")",";",["T_WHITESPACE","\n            ",84],["T_VARIABLE","$compiler",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","container",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","getCompiler",85],"(",")",";",["T_WHITESPACE","\n            ",85],["T_VARIABLE","$compiler",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","addLogMessage",86],"(",["T_VARIABLE","$compiler",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getLoggingFormatter",86],"(",")",["T_OBJECT_OPERATOR","->",86],["T_STRING","formatUpdateReference",86],"(",["T_VARIABLE","$this",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","currentId",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$referenceId",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$newId",86],")",")",";",["T_WHITESPACE","\n        ",86],"}",["T_WHITESPACE","\n\n        ",87],["T_RETURN","return",89],["T_WHITESPACE"," ",89],["T_STRING","parent",89],["T_DOUBLE_COLON","::",89],["T_STRING","processValue",89],"(",["T_VARIABLE","$value",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$isRoot",89],")",";",["T_WHITESPACE","\n    ",89],"}",["T_WHITESPACE","\n",90],"}",["T_WHITESPACE","\n",91]]