[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * This code is partially based on the Rack-Cache library by Ryan Tomayko,\n * which is released under the MIT license.\n * (based on commit 02d2b48d75bcb63cf1c0c7149c077ad256542801)\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",14],["T_NAMESPACE","namespace",16],["T_WHITESPACE"," ",16],["T_STRING","Symfony",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Component",16],["T_NS_SEPARATOR","\\",16],["T_STRING","HttpKernel",16],["T_NS_SEPARATOR","\\",16],["T_STRING","HttpCache",16],";",["T_WHITESPACE","\n\n",16],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Symfony",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Component",18],["T_NS_SEPARATOR","\\",18],["T_STRING","HttpFoundation",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Response",18],";",["T_WHITESPACE","\n\n",18],["T_DOC_COMMENT","\/**\n * ResponseCacheStrategy knows how to compute the Response cache HTTP header\n * based on the different response cache headers.\n *\n * This implementation changes the master response TTL to the smallest TTL received\n * or force validation if one of the surrogates has validation cache strategy.\n *\n * @author Fabien Potencier <fabien@symfony.com>\n *\/",20],["T_WHITESPACE","\n",28],["T_CLASS","class",29],["T_WHITESPACE"," ",29],["T_STRING","ResponseCacheStrategy",29],["T_WHITESPACE"," ",29],["T_IMPLEMENTS","implements",29],["T_WHITESPACE"," ",29],["T_STRING","ResponseCacheStrategyInterface",29],["T_WHITESPACE","\n",29],"{",["T_WHITESPACE","\n    ",30],["T_PRIVATE","private",31],["T_WHITESPACE"," ",31],["T_VARIABLE","$cacheable",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_STRING","true",31],";",["T_WHITESPACE","\n    ",31],["T_PRIVATE","private",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$embeddedResponses",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_LNUMBER","0",32],";",["T_WHITESPACE","\n    ",32],["T_PRIVATE","private",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$ttls",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_ARRAY","array",33],"(",")",";",["T_WHITESPACE","\n    ",33],["T_PRIVATE","private",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$maxAges",34],["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_ARRAY","array",34],"(",")",";",["T_WHITESPACE","\n    ",34],["T_PRIVATE","private",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$isNotCacheableResponseEmbedded",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_STRING","false",35],";",["T_WHITESPACE","\n\n    ",35],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",37],["T_WHITESPACE","\n    ",39],["T_PUBLIC","public",40],["T_WHITESPACE"," ",40],["T_FUNCTION","function",40],["T_WHITESPACE"," ",40],["T_STRING","add",40],"(",["T_STRING","Response",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$response",40],")",["T_WHITESPACE","\n    ",40],"{",["T_WHITESPACE","\n        ",41],["T_IF","if",42],["T_WHITESPACE"," ",42],"(",["T_VARIABLE","$response",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","isValidateable",42],"(",")",")",["T_WHITESPACE"," ",42],"{",["T_WHITESPACE","\n            ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","cacheable",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_STRING","false",43],";",["T_WHITESPACE","\n        ",43],"}",["T_WHITESPACE"," ",44],["T_ELSE","else",44],["T_WHITESPACE"," ",44],"{",["T_WHITESPACE","\n            ",44],["T_VARIABLE","$maxAge",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_VARIABLE","$response",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","getMaxAge",45],"(",")",";",["T_WHITESPACE","\n            ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","ttls",46],"[","]",["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$response",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","getTtl",46],"(",")",";",["T_WHITESPACE","\n            ",46],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","maxAges",47],"[","]",["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$maxAge",47],";",["T_WHITESPACE","\n\n            ",47],["T_IF","if",49],["T_WHITESPACE"," ",49],"(",["T_STRING","null",49],["T_WHITESPACE"," ",49],["T_IS_IDENTICAL","===",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$maxAge",49],")",["T_WHITESPACE"," ",49],"{",["T_WHITESPACE","\n                ",49],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","isNotCacheableResponseEmbedded",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_STRING","true",50],";",["T_WHITESPACE","\n            ",50],"}",["T_WHITESPACE","\n        ",51],"}",["T_WHITESPACE","\n\n        ",52],["T_INC","++",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","embeddedResponses",54],";",["T_WHITESPACE","\n    ",54],"}",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",57],["T_WHITESPACE","\n    ",59],["T_PUBLIC","public",60],["T_WHITESPACE"," ",60],["T_FUNCTION","function",60],["T_WHITESPACE"," ",60],["T_STRING","update",60],"(",["T_STRING","Response",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$response",60],")",["T_WHITESPACE","\n    ",60],"{",["T_WHITESPACE","\n        ",61],["T_COMMENT","\/\/ if we have no embedded Response, do nothing\n",62],["T_WHITESPACE","        ",63],["T_IF","if",63],["T_WHITESPACE"," ",63],"(",["T_LNUMBER","0",63],["T_WHITESPACE"," ",63],["T_IS_IDENTICAL","===",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","embeddedResponses",63],")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n            ",63],["T_RETURN","return",64],";",["T_WHITESPACE","\n        ",64],"}",["T_WHITESPACE","\n\n        ",65],["T_COMMENT","\/\/ Remove validation related headers in order to avoid browsers using\n",67],["T_WHITESPACE","        ",68],["T_COMMENT","\/\/ their own cache, because some of the response content comes from\n",68],["T_WHITESPACE","        ",69],["T_COMMENT","\/\/ at least one embedded response (which likely has a different caching strategy).\n",69],["T_WHITESPACE","        ",70],["T_IF","if",70],["T_WHITESPACE"," ",70],"(",["T_VARIABLE","$response",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","isValidateable",70],"(",")",")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n            ",70],["T_VARIABLE","$response",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","setEtag",71],"(",["T_STRING","null",71],")",";",["T_WHITESPACE","\n            ",71],["T_VARIABLE","$response",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","setLastModified",72],"(",["T_STRING","null",72],")",";",["T_WHITESPACE","\n            ",72],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","cacheable",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_STRING","false",73],";",["T_WHITESPACE","\n        ",73],"}",["T_WHITESPACE","\n\n        ",74],["T_IF","if",76],["T_WHITESPACE"," ",76],"(","!",["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","cacheable",76],")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n            ",76],["T_VARIABLE","$response",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","headers",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","set",77],"(",["T_CONSTANT_ENCAPSED_STRING","'Cache-Control'",77],",",["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","'no-cache, must-revalidate'",77],")",";",["T_WHITESPACE","\n\n            ",77],["T_RETURN","return",79],";",["T_WHITESPACE","\n        ",79],"}",["T_WHITESPACE","\n\n        ",80],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","ttls",82],"[","]",["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$response",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","getTtl",82],"(",")",";",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","maxAges",83],"[","]",["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$response",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","getMaxAge",83],"(",")",";",["T_WHITESPACE","\n\n        ",83],["T_IF","if",85],["T_WHITESPACE"," ",85],"(",["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","isNotCacheableResponseEmbedded",85],")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n            ",85],["T_VARIABLE","$response",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","headers",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","removeCacheControlDirective",86],"(",["T_CONSTANT_ENCAPSED_STRING","'s-maxage'",86],")",";",["T_WHITESPACE","\n        ",86],"}",["T_WHITESPACE"," ",87],["T_ELSEIF","elseif",87],["T_WHITESPACE"," ",87],"(",["T_STRING","null",87],["T_WHITESPACE"," ",87],["T_IS_NOT_IDENTICAL","!==",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$maxAge",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_STRING","min",87],"(",["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","maxAges",87],")",")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n            ",87],["T_VARIABLE","$response",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","setSharedMaxAge",88],"(",["T_VARIABLE","$maxAge",88],")",";",["T_WHITESPACE","\n            ",88],["T_VARIABLE","$response",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","headers",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","set",89],"(",["T_CONSTANT_ENCAPSED_STRING","'Age'",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$maxAge",89],["T_WHITESPACE"," ",89],"-",["T_WHITESPACE"," ",89],["T_STRING","min",89],"(",["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","ttls",89],")",")",";",["T_WHITESPACE","\n        ",89],"}",["T_WHITESPACE","\n        ",90],["T_VARIABLE","$response",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","setMaxAge",91],"(",["T_LNUMBER","0",91],")",";",["T_WHITESPACE","\n    ",91],"}",["T_WHITESPACE","\n",92],"}",["T_WHITESPACE","\n",93]]