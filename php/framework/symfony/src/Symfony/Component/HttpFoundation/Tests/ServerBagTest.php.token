[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","HttpFoundation",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Tests",12],";",["T_WHITESPACE","\n\n",12],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Symfony",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Component",14],["T_NS_SEPARATOR","\\",14],["T_STRING","HttpFoundation",14],["T_NS_SEPARATOR","\\",14],["T_STRING","ServerBag",14],";",["T_WHITESPACE","\n\n",14],["T_DOC_COMMENT","\/**\n * ServerBagTest.\n *\n * @author Bulat Shakirzyanov <mallluhuct@gmail.com>\n *\/",16],["T_WHITESPACE","\n",20],["T_CLASS","class",21],["T_WHITESPACE"," ",21],["T_STRING","ServerBagTest",21],["T_WHITESPACE"," ",21],["T_EXTENDS","extends",21],["T_WHITESPACE"," ",21],["T_NS_SEPARATOR","\\",21],["T_STRING","PHPUnit_Framework_TestCase",21],["T_WHITESPACE","\n",21],"{",["T_WHITESPACE","\n    ",22],["T_PUBLIC","public",23],["T_WHITESPACE"," ",23],["T_FUNCTION","function",23],["T_WHITESPACE"," ",23],["T_STRING","testShouldExtractHeadersFromServerArray",23],"(",")",["T_WHITESPACE","\n    ",23],"{",["T_WHITESPACE","\n        ",24],["T_VARIABLE","$server",25],["T_WHITESPACE"," ",25],"=",["T_WHITESPACE"," ",25],["T_ARRAY","array",25],"(",["T_WHITESPACE","\n            ",25],["T_CONSTANT_ENCAPSED_STRING","'SOME_SERVER_VARIABLE'",26],["T_WHITESPACE"," ",26],["T_DOUBLE_ARROW","=>",26],["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","'value'",26],",",["T_WHITESPACE","\n            ",26],["T_CONSTANT_ENCAPSED_STRING","'SOME_SERVER_VARIABLE2'",27],["T_WHITESPACE"," ",27],["T_DOUBLE_ARROW","=>",27],["T_WHITESPACE"," ",27],["T_CONSTANT_ENCAPSED_STRING","'value'",27],",",["T_WHITESPACE","\n            ",27],["T_CONSTANT_ENCAPSED_STRING","'ROOT'",28],["T_WHITESPACE"," ",28],["T_DOUBLE_ARROW","=>",28],["T_WHITESPACE"," ",28],["T_CONSTANT_ENCAPSED_STRING","'value'",28],",",["T_WHITESPACE","\n            ",28],["T_CONSTANT_ENCAPSED_STRING","'HTTP_CONTENT_TYPE'",29],["T_WHITESPACE"," ",29],["T_DOUBLE_ARROW","=>",29],["T_WHITESPACE"," ",29],["T_CONSTANT_ENCAPSED_STRING","'text\/html'",29],",",["T_WHITESPACE","\n            ",29],["T_CONSTANT_ENCAPSED_STRING","'HTTP_CONTENT_LENGTH'",30],["T_WHITESPACE"," ",30],["T_DOUBLE_ARROW","=>",30],["T_WHITESPACE"," ",30],["T_CONSTANT_ENCAPSED_STRING","'0'",30],",",["T_WHITESPACE","\n            ",30],["T_CONSTANT_ENCAPSED_STRING","'HTTP_ETAG'",31],["T_WHITESPACE"," ",31],["T_DOUBLE_ARROW","=>",31],["T_WHITESPACE"," ",31],["T_CONSTANT_ENCAPSED_STRING","'asdf'",31],",",["T_WHITESPACE","\n            ",31],["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_USER'",32],["T_WHITESPACE"," ",32],["T_DOUBLE_ARROW","=>",32],["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","'foo'",32],",",["T_WHITESPACE","\n            ",32],["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_PW'",33],["T_WHITESPACE"," ",33],["T_DOUBLE_ARROW","=>",33],["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'bar'",33],",",["T_WHITESPACE","\n        ",33],")",";",["T_WHITESPACE","\n\n        ",34],["T_VARIABLE","$bag",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_NEW","new",36],["T_WHITESPACE"," ",36],["T_STRING","ServerBag",36],"(",["T_VARIABLE","$server",36],")",";",["T_WHITESPACE","\n\n        ",36],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","assertEquals",38],"(",["T_ARRAY","array",38],"(",["T_WHITESPACE","\n            ",38],["T_CONSTANT_ENCAPSED_STRING","'CONTENT_TYPE'",39],["T_WHITESPACE"," ",39],["T_DOUBLE_ARROW","=>",39],["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'text\/html'",39],",",["T_WHITESPACE","\n            ",39],["T_CONSTANT_ENCAPSED_STRING","'CONTENT_LENGTH'",40],["T_WHITESPACE"," ",40],["T_DOUBLE_ARROW","=>",40],["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'0'",40],",",["T_WHITESPACE","\n            ",40],["T_CONSTANT_ENCAPSED_STRING","'ETAG'",41],["T_WHITESPACE"," ",41],["T_DOUBLE_ARROW","=>",41],["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'asdf'",41],",",["T_WHITESPACE","\n            ",41],["T_CONSTANT_ENCAPSED_STRING","'AUTHORIZATION'",42],["T_WHITESPACE"," ",42],["T_DOUBLE_ARROW","=>",42],["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'Basic '",42],".",["T_STRING","base64_encode",42],"(",["T_CONSTANT_ENCAPSED_STRING","'foo:bar'",42],")",",",["T_WHITESPACE","\n            ",42],["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_USER'",43],["T_WHITESPACE"," ",43],["T_DOUBLE_ARROW","=>",43],["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'foo'",43],",",["T_WHITESPACE","\n            ",43],["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_PW'",44],["T_WHITESPACE"," ",44],["T_DOUBLE_ARROW","=>",44],["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'bar'",44],",",["T_WHITESPACE","\n        ",44],")",",",["T_WHITESPACE"," ",45],["T_VARIABLE","$bag",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","getHeaders",45],"(",")",")",";",["T_WHITESPACE","\n    ",45],"}",["T_WHITESPACE","\n\n    ",46],["T_PUBLIC","public",48],["T_WHITESPACE"," ",48],["T_FUNCTION","function",48],["T_WHITESPACE"," ",48],["T_STRING","testHttpPasswordIsOptional",48],"(",")",["T_WHITESPACE","\n    ",48],"{",["T_WHITESPACE","\n        ",49],["T_VARIABLE","$bag",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_NEW","new",50],["T_WHITESPACE"," ",50],["T_STRING","ServerBag",50],"(",["T_ARRAY","array",50],"(",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_USER'",50],["T_WHITESPACE"," ",50],["T_DOUBLE_ARROW","=>",50],["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","'foo'",50],")",")",";",["T_WHITESPACE","\n\n        ",50],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","assertEquals",52],"(",["T_ARRAY","array",52],"(",["T_WHITESPACE","\n            ",52],["T_CONSTANT_ENCAPSED_STRING","'AUTHORIZATION'",53],["T_WHITESPACE"," ",53],["T_DOUBLE_ARROW","=>",53],["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","'Basic '",53],".",["T_STRING","base64_encode",53],"(",["T_CONSTANT_ENCAPSED_STRING","'foo:'",53],")",",",["T_WHITESPACE","\n            ",53],["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_USER'",54],["T_WHITESPACE"," ",54],["T_DOUBLE_ARROW","=>",54],["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'foo'",54],",",["T_WHITESPACE","\n            ",54],["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_PW'",55],["T_WHITESPACE"," ",55],["T_DOUBLE_ARROW","=>",55],["T_WHITESPACE"," ",55],["T_CONSTANT_ENCAPSED_STRING","''",55],",",["T_WHITESPACE","\n        ",55],")",",",["T_WHITESPACE"," ",56],["T_VARIABLE","$bag",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","getHeaders",56],"(",")",")",";",["T_WHITESPACE","\n    ",56],"}",["T_WHITESPACE","\n\n    ",57],["T_PUBLIC","public",59],["T_WHITESPACE"," ",59],["T_FUNCTION","function",59],["T_WHITESPACE"," ",59],["T_STRING","testHttpBasicAuthWithPhpCgi",59],"(",")",["T_WHITESPACE","\n    ",59],"{",["T_WHITESPACE","\n        ",60],["T_VARIABLE","$bag",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_NEW","new",61],["T_WHITESPACE"," ",61],["T_STRING","ServerBag",61],"(",["T_ARRAY","array",61],"(",["T_CONSTANT_ENCAPSED_STRING","'HTTP_AUTHORIZATION'",61],["T_WHITESPACE"," ",61],["T_DOUBLE_ARROW","=>",61],["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'Basic '",61],".",["T_STRING","base64_encode",61],"(",["T_CONSTANT_ENCAPSED_STRING","'foo:bar'",61],")",")",")",";",["T_WHITESPACE","\n\n        ",61],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","assertEquals",63],"(",["T_ARRAY","array",63],"(",["T_WHITESPACE","\n            ",63],["T_CONSTANT_ENCAPSED_STRING","'AUTHORIZATION'",64],["T_WHITESPACE"," ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'Basic '",64],".",["T_STRING","base64_encode",64],"(",["T_CONSTANT_ENCAPSED_STRING","'foo:bar'",64],")",",",["T_WHITESPACE","\n            ",64],["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_USER'",65],["T_WHITESPACE"," ",65],["T_DOUBLE_ARROW","=>",65],["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'foo'",65],",",["T_WHITESPACE","\n            ",65],["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_PW'",66],["T_WHITESPACE"," ",66],["T_DOUBLE_ARROW","=>",66],["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'bar'",66],",",["T_WHITESPACE","\n        ",66],")",",",["T_WHITESPACE"," ",67],["T_VARIABLE","$bag",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getHeaders",67],"(",")",")",";",["T_WHITESPACE","\n    ",67],"}",["T_WHITESPACE","\n\n    ",68],["T_PUBLIC","public",70],["T_WHITESPACE"," ",70],["T_FUNCTION","function",70],["T_WHITESPACE"," ",70],["T_STRING","testHttpBasicAuthWithPhpCgiBogus",70],"(",")",["T_WHITESPACE","\n    ",70],"{",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$bag",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_NEW","new",72],["T_WHITESPACE"," ",72],["T_STRING","ServerBag",72],"(",["T_ARRAY","array",72],"(",["T_CONSTANT_ENCAPSED_STRING","'HTTP_AUTHORIZATION'",72],["T_WHITESPACE"," ",72],["T_DOUBLE_ARROW","=>",72],["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'Basic_'",72],".",["T_STRING","base64_encode",72],"(",["T_CONSTANT_ENCAPSED_STRING","'foo:bar'",72],")",")",")",";",["T_WHITESPACE","\n\n        ",72],["T_COMMENT","\/\/ Username and passwords should not be set as the header is bogus\n",74],["T_WHITESPACE","        ",75],["T_VARIABLE","$headers",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$bag",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getHeaders",75],"(",")",";",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","assertFalse",76],"(",["T_ISSET","isset",76],"(",["T_VARIABLE","$headers",76],"[",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_USER'",76],"]",")",")",";",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","assertFalse",77],"(",["T_ISSET","isset",77],"(",["T_VARIABLE","$headers",77],"[",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_PW'",77],"]",")",")",";",["T_WHITESPACE","\n    ",77],"}",["T_WHITESPACE","\n\n    ",78],["T_PUBLIC","public",80],["T_WHITESPACE"," ",80],["T_FUNCTION","function",80],["T_WHITESPACE"," ",80],["T_STRING","testHttpBasicAuthWithPhpCgiRedirect",80],"(",")",["T_WHITESPACE","\n    ",80],"{",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$bag",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_NEW","new",82],["T_WHITESPACE"," ",82],["T_STRING","ServerBag",82],"(",["T_ARRAY","array",82],"(",["T_CONSTANT_ENCAPSED_STRING","'REDIRECT_HTTP_AUTHORIZATION'",82],["T_WHITESPACE"," ",82],["T_DOUBLE_ARROW","=>",82],["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'Basic '",82],".",["T_STRING","base64_encode",82],"(",["T_CONSTANT_ENCAPSED_STRING","'username:pass:word'",82],")",")",")",";",["T_WHITESPACE","\n\n        ",82],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","assertEquals",84],"(",["T_ARRAY","array",84],"(",["T_WHITESPACE","\n            ",84],["T_CONSTANT_ENCAPSED_STRING","'AUTHORIZATION'",85],["T_WHITESPACE"," ",85],["T_DOUBLE_ARROW","=>",85],["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","'Basic '",85],".",["T_STRING","base64_encode",85],"(",["T_CONSTANT_ENCAPSED_STRING","'username:pass:word'",85],")",",",["T_WHITESPACE","\n            ",85],["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_USER'",86],["T_WHITESPACE"," ",86],["T_DOUBLE_ARROW","=>",86],["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","'username'",86],",",["T_WHITESPACE","\n            ",86],["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_PW'",87],["T_WHITESPACE"," ",87],["T_DOUBLE_ARROW","=>",87],["T_WHITESPACE"," ",87],["T_CONSTANT_ENCAPSED_STRING","'pass:word'",87],",",["T_WHITESPACE","\n        ",87],")",",",["T_WHITESPACE"," ",88],["T_VARIABLE","$bag",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","getHeaders",88],"(",")",")",";",["T_WHITESPACE","\n    ",88],"}",["T_WHITESPACE","\n\n    ",89],["T_PUBLIC","public",91],["T_WHITESPACE"," ",91],["T_FUNCTION","function",91],["T_WHITESPACE"," ",91],["T_STRING","testHttpBasicAuthWithPhpCgiEmptyPassword",91],"(",")",["T_WHITESPACE","\n    ",91],"{",["T_WHITESPACE","\n        ",92],["T_VARIABLE","$bag",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_NEW","new",93],["T_WHITESPACE"," ",93],["T_STRING","ServerBag",93],"(",["T_ARRAY","array",93],"(",["T_CONSTANT_ENCAPSED_STRING","'HTTP_AUTHORIZATION'",93],["T_WHITESPACE"," ",93],["T_DOUBLE_ARROW","=>",93],["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","'Basic '",93],".",["T_STRING","base64_encode",93],"(",["T_CONSTANT_ENCAPSED_STRING","'foo:'",93],")",")",")",";",["T_WHITESPACE","\n\n        ",93],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","assertEquals",95],"(",["T_ARRAY","array",95],"(",["T_WHITESPACE","\n            ",95],["T_CONSTANT_ENCAPSED_STRING","'AUTHORIZATION'",96],["T_WHITESPACE"," ",96],["T_DOUBLE_ARROW","=>",96],["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","'Basic '",96],".",["T_STRING","base64_encode",96],"(",["T_CONSTANT_ENCAPSED_STRING","'foo:'",96],")",",",["T_WHITESPACE","\n            ",96],["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_USER'",97],["T_WHITESPACE"," ",97],["T_DOUBLE_ARROW","=>",97],["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","'foo'",97],",",["T_WHITESPACE","\n            ",97],["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_PW'",98],["T_WHITESPACE"," ",98],["T_DOUBLE_ARROW","=>",98],["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","''",98],",",["T_WHITESPACE","\n        ",98],")",",",["T_WHITESPACE"," ",99],["T_VARIABLE","$bag",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","getHeaders",99],"(",")",")",";",["T_WHITESPACE","\n    ",99],"}",["T_WHITESPACE","\n\n    ",100],["T_PUBLIC","public",102],["T_WHITESPACE"," ",102],["T_FUNCTION","function",102],["T_WHITESPACE"," ",102],["T_STRING","testHttpDigestAuthWithPhpCgi",102],"(",")",["T_WHITESPACE","\n    ",102],"{",["T_WHITESPACE","\n        ",103],["T_VARIABLE","$digest",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'Digest username=\"foo\", realm=\"acme\", nonce=\"'",104],".",["T_STRING","md5",104],"(",["T_CONSTANT_ENCAPSED_STRING","'secret'",104],")",".",["T_CONSTANT_ENCAPSED_STRING","'\", uri=\"\/protected, qop=\"auth\"'",104],";",["T_WHITESPACE","\n        ",104],["T_VARIABLE","$bag",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_NEW","new",105],["T_WHITESPACE"," ",105],["T_STRING","ServerBag",105],"(",["T_ARRAY","array",105],"(",["T_CONSTANT_ENCAPSED_STRING","'HTTP_AUTHORIZATION'",105],["T_WHITESPACE"," ",105],["T_DOUBLE_ARROW","=>",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$digest",105],")",")",";",["T_WHITESPACE","\n\n        ",105],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","assertEquals",107],"(",["T_ARRAY","array",107],"(",["T_WHITESPACE","\n            ",107],["T_CONSTANT_ENCAPSED_STRING","'AUTHORIZATION'",108],["T_WHITESPACE"," ",108],["T_DOUBLE_ARROW","=>",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$digest",108],",",["T_WHITESPACE","\n            ",108],["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_DIGEST'",109],["T_WHITESPACE"," ",109],["T_DOUBLE_ARROW","=>",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$digest",109],",",["T_WHITESPACE","\n        ",109],")",",",["T_WHITESPACE"," ",110],["T_VARIABLE","$bag",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getHeaders",110],"(",")",")",";",["T_WHITESPACE","\n    ",110],"}",["T_WHITESPACE","\n\n    ",111],["T_PUBLIC","public",113],["T_WHITESPACE"," ",113],["T_FUNCTION","function",113],["T_WHITESPACE"," ",113],["T_STRING","testHttpDigestAuthWithPhpCgiBogus",113],"(",")",["T_WHITESPACE","\n    ",113],"{",["T_WHITESPACE","\n        ",114],["T_VARIABLE","$digest",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'Digest_username=\"foo\", realm=\"acme\", nonce=\"'",115],".",["T_STRING","md5",115],"(",["T_CONSTANT_ENCAPSED_STRING","'secret'",115],")",".",["T_CONSTANT_ENCAPSED_STRING","'\", uri=\"\/protected, qop=\"auth\"'",115],";",["T_WHITESPACE","\n        ",115],["T_VARIABLE","$bag",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_NEW","new",116],["T_WHITESPACE"," ",116],["T_STRING","ServerBag",116],"(",["T_ARRAY","array",116],"(",["T_CONSTANT_ENCAPSED_STRING","'HTTP_AUTHORIZATION'",116],["T_WHITESPACE"," ",116],["T_DOUBLE_ARROW","=>",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$digest",116],")",")",";",["T_WHITESPACE","\n\n        ",116],["T_COMMENT","\/\/ Username and passwords should not be set as the header is bogus\n",118],["T_WHITESPACE","        ",119],["T_VARIABLE","$headers",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$bag",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getHeaders",119],"(",")",";",["T_WHITESPACE","\n        ",119],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","assertFalse",120],"(",["T_ISSET","isset",120],"(",["T_VARIABLE","$headers",120],"[",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_USER'",120],"]",")",")",";",["T_WHITESPACE","\n        ",120],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","assertFalse",121],"(",["T_ISSET","isset",121],"(",["T_VARIABLE","$headers",121],"[",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_PW'",121],"]",")",")",";",["T_WHITESPACE","\n    ",121],"}",["T_WHITESPACE","\n\n    ",122],["T_PUBLIC","public",124],["T_WHITESPACE"," ",124],["T_FUNCTION","function",124],["T_WHITESPACE"," ",124],["T_STRING","testHttpDigestAuthWithPhpCgiRedirect",124],"(",")",["T_WHITESPACE","\n    ",124],"{",["T_WHITESPACE","\n        ",125],["T_VARIABLE","$digest",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'Digest username=\"foo\", realm=\"acme\", nonce=\"'",126],".",["T_STRING","md5",126],"(",["T_CONSTANT_ENCAPSED_STRING","'secret'",126],")",".",["T_CONSTANT_ENCAPSED_STRING","'\", uri=\"\/protected, qop=\"auth\"'",126],";",["T_WHITESPACE","\n        ",126],["T_VARIABLE","$bag",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_NEW","new",127],["T_WHITESPACE"," ",127],["T_STRING","ServerBag",127],"(",["T_ARRAY","array",127],"(",["T_CONSTANT_ENCAPSED_STRING","'REDIRECT_HTTP_AUTHORIZATION'",127],["T_WHITESPACE"," ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$digest",127],")",")",";",["T_WHITESPACE","\n\n        ",127],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","assertEquals",129],"(",["T_ARRAY","array",129],"(",["T_WHITESPACE","\n            ",129],["T_CONSTANT_ENCAPSED_STRING","'AUTHORIZATION'",130],["T_WHITESPACE"," ",130],["T_DOUBLE_ARROW","=>",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$digest",130],",",["T_WHITESPACE","\n            ",130],["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_DIGEST'",131],["T_WHITESPACE"," ",131],["T_DOUBLE_ARROW","=>",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$digest",131],",",["T_WHITESPACE","\n        ",131],")",",",["T_WHITESPACE"," ",132],["T_VARIABLE","$bag",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","getHeaders",132],"(",")",")",";",["T_WHITESPACE","\n    ",132],"}",["T_WHITESPACE","\n\n    ",133],["T_PUBLIC","public",135],["T_WHITESPACE"," ",135],["T_FUNCTION","function",135],["T_WHITESPACE"," ",135],["T_STRING","testOAuthBearerAuth",135],"(",")",["T_WHITESPACE","\n    ",135],"{",["T_WHITESPACE","\n        ",136],["T_VARIABLE","$headerContent",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'Bearer L-yLEOr9zhmUYRkzN1jwwxwQ-PBNiKDc8dgfB4hTfvo'",137],";",["T_WHITESPACE","\n        ",137],["T_VARIABLE","$bag",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_NEW","new",138],["T_WHITESPACE"," ",138],["T_STRING","ServerBag",138],"(",["T_ARRAY","array",138],"(",["T_CONSTANT_ENCAPSED_STRING","'HTTP_AUTHORIZATION'",138],["T_WHITESPACE"," ",138],["T_DOUBLE_ARROW","=>",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$headerContent",138],")",")",";",["T_WHITESPACE","\n\n        ",138],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","assertEquals",140],"(",["T_ARRAY","array",140],"(",["T_WHITESPACE","\n            ",140],["T_CONSTANT_ENCAPSED_STRING","'AUTHORIZATION'",141],["T_WHITESPACE"," ",141],["T_DOUBLE_ARROW","=>",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$headerContent",141],",",["T_WHITESPACE","\n        ",141],")",",",["T_WHITESPACE"," ",142],["T_VARIABLE","$bag",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","getHeaders",142],"(",")",")",";",["T_WHITESPACE","\n    ",142],"}",["T_WHITESPACE","\n\n    ",143],["T_PUBLIC","public",145],["T_WHITESPACE"," ",145],["T_FUNCTION","function",145],["T_WHITESPACE"," ",145],["T_STRING","testOAuthBearerAuthWithRedirect",145],"(",")",["T_WHITESPACE","\n    ",145],"{",["T_WHITESPACE","\n        ",146],["T_VARIABLE","$headerContent",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_CONSTANT_ENCAPSED_STRING","'Bearer L-yLEOr9zhmUYRkzN1jwwxwQ-PBNiKDc8dgfB4hTfvo'",147],";",["T_WHITESPACE","\n        ",147],["T_VARIABLE","$bag",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_NEW","new",148],["T_WHITESPACE"," ",148],["T_STRING","ServerBag",148],"(",["T_ARRAY","array",148],"(",["T_CONSTANT_ENCAPSED_STRING","'REDIRECT_HTTP_AUTHORIZATION'",148],["T_WHITESPACE"," ",148],["T_DOUBLE_ARROW","=>",148],["T_WHITESPACE"," ",148],["T_VARIABLE","$headerContent",148],")",")",";",["T_WHITESPACE","\n\n        ",148],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","assertEquals",150],"(",["T_ARRAY","array",150],"(",["T_WHITESPACE","\n            ",150],["T_CONSTANT_ENCAPSED_STRING","'AUTHORIZATION'",151],["T_WHITESPACE"," ",151],["T_DOUBLE_ARROW","=>",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$headerContent",151],",",["T_WHITESPACE","\n        ",151],")",",",["T_WHITESPACE"," ",152],["T_VARIABLE","$bag",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","getHeaders",152],"(",")",")",";",["T_WHITESPACE","\n    ",152],"}",["T_WHITESPACE","\n\n    ",153],["T_DOC_COMMENT","\/**\n     * @see https:\/\/github.com\/symfony\/symfony\/issues\/17345\n     *\/",155],["T_WHITESPACE","\n    ",157],["T_PUBLIC","public",158],["T_WHITESPACE"," ",158],["T_FUNCTION","function",158],["T_WHITESPACE"," ",158],["T_STRING","testItDoesNotOverwriteTheAuthorizationHeaderIfItIsAlreadySet",158],"(",")",["T_WHITESPACE","\n    ",158],"{",["T_WHITESPACE","\n        ",159],["T_VARIABLE","$headerContent",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","'Bearer L-yLEOr9zhmUYRkzN1jwwxwQ-PBNiKDc8dgfB4hTfvo'",160],";",["T_WHITESPACE","\n        ",160],["T_VARIABLE","$bag",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_NEW","new",161],["T_WHITESPACE"," ",161],["T_STRING","ServerBag",161],"(",["T_ARRAY","array",161],"(",["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_USER'",161],["T_WHITESPACE"," ",161],["T_DOUBLE_ARROW","=>",161],["T_WHITESPACE"," ",161],["T_CONSTANT_ENCAPSED_STRING","'foo'",161],",",["T_WHITESPACE"," ",161],["T_CONSTANT_ENCAPSED_STRING","'HTTP_AUTHORIZATION'",161],["T_WHITESPACE"," ",161],["T_DOUBLE_ARROW","=>",161],["T_WHITESPACE"," ",161],["T_VARIABLE","$headerContent",161],")",")",";",["T_WHITESPACE","\n\n        ",161],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","assertEquals",163],"(",["T_ARRAY","array",163],"(",["T_WHITESPACE","\n            ",163],["T_CONSTANT_ENCAPSED_STRING","'AUTHORIZATION'",164],["T_WHITESPACE"," ",164],["T_DOUBLE_ARROW","=>",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$headerContent",164],",",["T_WHITESPACE","\n            ",164],["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_USER'",165],["T_WHITESPACE"," ",165],["T_DOUBLE_ARROW","=>",165],["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","'foo'",165],",",["T_WHITESPACE","\n            ",165],["T_CONSTANT_ENCAPSED_STRING","'PHP_AUTH_PW'",166],["T_WHITESPACE"," ",166],["T_DOUBLE_ARROW","=>",166],["T_WHITESPACE"," ",166],["T_CONSTANT_ENCAPSED_STRING","''",166],",",["T_WHITESPACE","\n        ",166],")",",",["T_WHITESPACE"," ",167],["T_VARIABLE","$bag",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","getHeaders",167],"(",")",")",";",["T_WHITESPACE","\n    ",167],"}",["T_WHITESPACE","\n",168],"}",["T_WHITESPACE","\n",169]]