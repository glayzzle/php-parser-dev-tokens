[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","HttpFoundation",12],";",["T_WHITESPACE","\n\n",12],["T_DOC_COMMENT","\/**\n * Http utility functions.\n *\n * @author Fabien Potencier <fabien@symfony.com>\n *\/",14],["T_WHITESPACE","\n",18],["T_CLASS","class",19],["T_WHITESPACE"," ",19],["T_STRING","IpUtils",19],["T_WHITESPACE","\n",19],"{",["T_WHITESPACE","\n    ",20],["T_DOC_COMMENT","\/**\n     * This class should not be instantiated.\n     *\/",21],["T_WHITESPACE","\n    ",23],["T_PRIVATE","private",24],["T_WHITESPACE"," ",24],["T_FUNCTION","function",24],["T_WHITESPACE"," ",24],["T_STRING","__construct",24],"(",")",["T_WHITESPACE","\n    ",24],"{",["T_WHITESPACE","\n    ",25],"}",["T_WHITESPACE","\n\n    ",26],["T_DOC_COMMENT","\/**\n     * Checks if an IPv4 or IPv6 address is contained in the list of given IPs or subnets.\n     *\n     * @param string       $requestIp IP to check\n     * @param string|array $ips       List of IPs or subnets (can be a string if only a single one)\n     *\n     * @return bool Whether the IP is valid\n     *\/",28],["T_WHITESPACE","\n    ",35],["T_PUBLIC","public",36],["T_WHITESPACE"," ",36],["T_STATIC","static",36],["T_WHITESPACE"," ",36],["T_FUNCTION","function",36],["T_WHITESPACE"," ",36],["T_STRING","checkIp",36],"(",["T_VARIABLE","$requestIp",36],",",["T_WHITESPACE"," ",36],["T_VARIABLE","$ips",36],")",["T_WHITESPACE","\n    ",36],"{",["T_WHITESPACE","\n        ",37],["T_IF","if",38],["T_WHITESPACE"," ",38],"(","!",["T_STRING","is_array",38],"(",["T_VARIABLE","$ips",38],")",")",["T_WHITESPACE"," ",38],"{",["T_WHITESPACE","\n            ",38],["T_VARIABLE","$ips",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_ARRAY","array",39],"(",["T_VARIABLE","$ips",39],")",";",["T_WHITESPACE","\n        ",39],"}",["T_WHITESPACE","\n\n        ",40],["T_VARIABLE","$method",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_STRING","substr_count",42],"(",["T_VARIABLE","$requestIp",42],",",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","':'",42],")",["T_WHITESPACE"," ",42],">",["T_WHITESPACE"," ",42],["T_LNUMBER","1",42],["T_WHITESPACE"," ",42],"?",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'checkIp6'",42],["T_WHITESPACE"," ",42],":",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'checkIp4'",42],";",["T_WHITESPACE","\n\n        ",42],["T_FOREACH","foreach",44],["T_WHITESPACE"," ",44],"(",["T_VARIABLE","$ips",44],["T_WHITESPACE"," ",44],["T_AS","as",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$ip",44],")",["T_WHITESPACE"," ",44],"{",["T_WHITESPACE","\n            ",44],["T_IF","if",45],["T_WHITESPACE"," ",45],"(",["T_STRING","self",45],["T_DOUBLE_COLON","::",45],["T_VARIABLE","$method",45],"(",["T_VARIABLE","$requestIp",45],",",["T_WHITESPACE"," ",45],["T_VARIABLE","$ip",45],")",")",["T_WHITESPACE"," ",45],"{",["T_WHITESPACE","\n                ",45],["T_RETURN","return",46],["T_WHITESPACE"," ",46],["T_STRING","true",46],";",["T_WHITESPACE","\n            ",46],"}",["T_WHITESPACE","\n        ",47],"}",["T_WHITESPACE","\n\n        ",48],["T_RETURN","return",50],["T_WHITESPACE"," ",50],["T_STRING","false",50],";",["T_WHITESPACE","\n    ",50],"}",["T_WHITESPACE","\n\n    ",51],["T_DOC_COMMENT","\/**\n     * Compares two IPv4 addresses.\n     * In case a subnet is given, it checks if it contains the request IP.\n     *\n     * @param string $requestIp IPv4 address to check\n     * @param string $ip        IPv4 address or subnet in CIDR notation\n     *\n     * @return bool Whether the request IP matches the IP, or whether the request IP is within the CIDR subnet\n     *\/",53],["T_WHITESPACE","\n    ",61],["T_PUBLIC","public",62],["T_WHITESPACE"," ",62],["T_STATIC","static",62],["T_WHITESPACE"," ",62],["T_FUNCTION","function",62],["T_WHITESPACE"," ",62],["T_STRING","checkIp4",62],"(",["T_VARIABLE","$requestIp",62],",",["T_WHITESPACE"," ",62],["T_VARIABLE","$ip",62],")",["T_WHITESPACE","\n    ",62],"{",["T_WHITESPACE","\n        ",63],["T_IF","if",64],["T_WHITESPACE"," ",64],"(","!",["T_STRING","filter_var",64],"(",["T_VARIABLE","$requestIp",64],",",["T_WHITESPACE"," ",64],["T_STRING","FILTER_VALIDATE_IP",64],",",["T_WHITESPACE"," ",64],["T_STRING","FILTER_FLAG_IPV4",64],")",")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n            ",64],["T_RETURN","return",65],["T_WHITESPACE"," ",65],["T_STRING","false",65],";",["T_WHITESPACE","\n        ",65],"}",["T_WHITESPACE","\n\n        ",66],["T_IF","if",68],["T_WHITESPACE"," ",68],"(",["T_STRING","false",68],["T_WHITESPACE"," ",68],["T_IS_NOT_IDENTICAL","!==",68],["T_WHITESPACE"," ",68],["T_STRING","strpos",68],"(",["T_VARIABLE","$ip",68],",",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'\/'",68],")",")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n            ",68],["T_LIST","list",69],"(",["T_VARIABLE","$address",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$netmask",69],")",["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_STRING","explode",69],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$ip",69],",",["T_WHITESPACE"," ",69],["T_LNUMBER","2",69],")",";",["T_WHITESPACE","\n\n            ",69],["T_IF","if",71],["T_WHITESPACE"," ",71],"(",["T_VARIABLE","$netmask",71],["T_WHITESPACE"," ",71],["T_IS_IDENTICAL","===",71],["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'0'",71],")",["T_WHITESPACE"," ",71],"{",["T_WHITESPACE","\n                ",71],["T_RETURN","return",72],["T_WHITESPACE"," ",72],["T_STRING","filter_var",72],"(",["T_VARIABLE","$address",72],",",["T_WHITESPACE"," ",72],["T_STRING","FILTER_VALIDATE_IP",72],",",["T_WHITESPACE"," ",72],["T_STRING","FILTER_FLAG_IPV4",72],")",";",["T_WHITESPACE","\n            ",72],"}",["T_WHITESPACE","\n\n            ",73],["T_IF","if",75],["T_WHITESPACE"," ",75],"(",["T_VARIABLE","$netmask",75],["T_WHITESPACE"," ",75],"<",["T_WHITESPACE"," ",75],["T_LNUMBER","0",75],["T_WHITESPACE"," ",75],["T_BOOLEAN_OR","||",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$netmask",75],["T_WHITESPACE"," ",75],">",["T_WHITESPACE"," ",75],["T_LNUMBER","32",75],")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n                ",75],["T_RETURN","return",76],["T_WHITESPACE"," ",76],["T_STRING","false",76],";",["T_WHITESPACE","\n            ",76],"}",["T_WHITESPACE","\n        ",77],"}",["T_WHITESPACE"," ",78],["T_ELSE","else",78],["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n            ",78],["T_VARIABLE","$address",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$ip",79],";",["T_WHITESPACE","\n            ",79],["T_VARIABLE","$netmask",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_LNUMBER","32",80],";",["T_WHITESPACE","\n        ",80],"}",["T_WHITESPACE","\n\n        ",81],["T_RETURN","return",83],["T_WHITESPACE"," ",83],["T_LNUMBER","0",83],["T_WHITESPACE"," ",83],["T_IS_IDENTICAL","===",83],["T_WHITESPACE"," ",83],["T_STRING","substr_compare",83],"(",["T_STRING","sprintf",83],"(",["T_CONSTANT_ENCAPSED_STRING","'%032b'",83],",",["T_WHITESPACE"," ",83],["T_STRING","ip2long",83],"(",["T_VARIABLE","$requestIp",83],")",")",",",["T_WHITESPACE"," ",83],["T_STRING","sprintf",83],"(",["T_CONSTANT_ENCAPSED_STRING","'%032b'",83],",",["T_WHITESPACE"," ",83],["T_STRING","ip2long",83],"(",["T_VARIABLE","$address",83],")",")",",",["T_WHITESPACE"," ",83],["T_LNUMBER","0",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$netmask",83],")",";",["T_WHITESPACE","\n    ",83],"}",["T_WHITESPACE","\n\n    ",84],["T_DOC_COMMENT","\/**\n     * Compares two IPv6 addresses.\n     * In case a subnet is given, it checks if it contains the request IP.\n     *\n     * @author David Soria Parra <dsp at php dot net>\n     *\n     * @see https:\/\/github.com\/dsp\/v6tools\n     *\n     * @param string $requestIp IPv6 address to check\n     * @param string $ip        IPv6 address or subnet in CIDR notation\n     *\n     * @return bool Whether the IP is valid\n     *\n     * @throws \\RuntimeException When IPV6 support is not enabled\n     *\/",86],["T_WHITESPACE","\n    ",100],["T_PUBLIC","public",101],["T_WHITESPACE"," ",101],["T_STATIC","static",101],["T_WHITESPACE"," ",101],["T_FUNCTION","function",101],["T_WHITESPACE"," ",101],["T_STRING","checkIp6",101],"(",["T_VARIABLE","$requestIp",101],",",["T_WHITESPACE"," ",101],["T_VARIABLE","$ip",101],")",["T_WHITESPACE","\n    ",101],"{",["T_WHITESPACE","\n        ",102],["T_IF","if",103],["T_WHITESPACE"," ",103],"(","!","(","(",["T_STRING","extension_loaded",103],"(",["T_CONSTANT_ENCAPSED_STRING","'sockets'",103],")",["T_WHITESPACE"," ",103],["T_BOOLEAN_AND","&&",103],["T_WHITESPACE"," ",103],["T_STRING","defined",103],"(",["T_CONSTANT_ENCAPSED_STRING","'AF_INET6'",103],")",")",["T_WHITESPACE"," ",103],["T_BOOLEAN_OR","||",103],["T_WHITESPACE"," ",103],"@",["T_STRING","inet_pton",103],"(",["T_CONSTANT_ENCAPSED_STRING","'::1'",103],")",")",")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n            ",103],["T_THROW","throw",104],["T_WHITESPACE"," ",104],["T_NEW","new",104],["T_WHITESPACE"," ",104],["T_NS_SEPARATOR","\\",104],["T_STRING","RuntimeException",104],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to check Ipv6. Check that PHP was not compiled with option \"disable-ipv6\".'",104],")",";",["T_WHITESPACE","\n        ",104],"}",["T_WHITESPACE","\n\n        ",105],["T_IF","if",107],["T_WHITESPACE"," ",107],"(",["T_STRING","false",107],["T_WHITESPACE"," ",107],["T_IS_NOT_IDENTICAL","!==",107],["T_WHITESPACE"," ",107],["T_STRING","strpos",107],"(",["T_VARIABLE","$ip",107],",",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'\/'",107],")",")",["T_WHITESPACE"," ",107],"{",["T_WHITESPACE","\n            ",107],["T_LIST","list",108],"(",["T_VARIABLE","$address",108],",",["T_WHITESPACE"," ",108],["T_VARIABLE","$netmask",108],")",["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_STRING","explode",108],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",108],",",["T_WHITESPACE"," ",108],["T_VARIABLE","$ip",108],",",["T_WHITESPACE"," ",108],["T_LNUMBER","2",108],")",";",["T_WHITESPACE","\n\n            ",108],["T_IF","if",110],["T_WHITESPACE"," ",110],"(",["T_VARIABLE","$netmask",110],["T_WHITESPACE"," ",110],"<",["T_WHITESPACE"," ",110],["T_LNUMBER","1",110],["T_WHITESPACE"," ",110],["T_BOOLEAN_OR","||",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$netmask",110],["T_WHITESPACE"," ",110],">",["T_WHITESPACE"," ",110],["T_LNUMBER","128",110],")",["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n                ",110],["T_RETURN","return",111],["T_WHITESPACE"," ",111],["T_STRING","false",111],";",["T_WHITESPACE","\n            ",111],"}",["T_WHITESPACE","\n        ",112],"}",["T_WHITESPACE"," ",113],["T_ELSE","else",113],["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n            ",113],["T_VARIABLE","$address",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_VARIABLE","$ip",114],";",["T_WHITESPACE","\n            ",114],["T_VARIABLE","$netmask",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_LNUMBER","128",115],";",["T_WHITESPACE","\n        ",115],"}",["T_WHITESPACE","\n\n        ",116],["T_VARIABLE","$bytesAddr",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_STRING","unpack",118],"(",["T_CONSTANT_ENCAPSED_STRING","'n*'",118],",",["T_WHITESPACE"," ",118],"@",["T_STRING","inet_pton",118],"(",["T_VARIABLE","$address",118],")",")",";",["T_WHITESPACE","\n        ",118],["T_VARIABLE","$bytesTest",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_STRING","unpack",119],"(",["T_CONSTANT_ENCAPSED_STRING","'n*'",119],",",["T_WHITESPACE"," ",119],"@",["T_STRING","inet_pton",119],"(",["T_VARIABLE","$requestIp",119],")",")",";",["T_WHITESPACE","\n\n        ",119],["T_IF","if",121],["T_WHITESPACE"," ",121],"(","!",["T_VARIABLE","$bytesAddr",121],["T_WHITESPACE"," ",121],["T_BOOLEAN_OR","||",121],["T_WHITESPACE"," ",121],"!",["T_VARIABLE","$bytesTest",121],")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n            ",121],["T_RETURN","return",122],["T_WHITESPACE"," ",122],["T_STRING","false",122],";",["T_WHITESPACE","\n        ",122],"}",["T_WHITESPACE","\n\n        ",123],["T_FOR","for",125],["T_WHITESPACE"," ",125],"(",["T_VARIABLE","$i",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_LNUMBER","1",125],",",["T_WHITESPACE"," ",125],["T_VARIABLE","$ceil",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_STRING","ceil",125],"(",["T_VARIABLE","$netmask",125],["T_WHITESPACE"," ",125],"\/",["T_WHITESPACE"," ",125],["T_LNUMBER","16",125],")",";",["T_WHITESPACE"," ",125],["T_VARIABLE","$i",125],["T_WHITESPACE"," ",125],["T_IS_SMALLER_OR_EQUAL","<=",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$ceil",125],";",["T_WHITESPACE"," ",125],["T_INC","++",125],["T_VARIABLE","$i",125],")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n            ",125],["T_VARIABLE","$left",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$netmask",126],["T_WHITESPACE"," ",126],"-",["T_WHITESPACE"," ",126],["T_LNUMBER","16",126],["T_WHITESPACE"," ",126],"*",["T_WHITESPACE"," ",126],"(",["T_VARIABLE","$i",126],["T_WHITESPACE"," ",126],"-",["T_WHITESPACE"," ",126],["T_LNUMBER","1",126],")",";",["T_WHITESPACE","\n            ",126],["T_VARIABLE","$left",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],"(",["T_VARIABLE","$left",127],["T_WHITESPACE"," ",127],["T_IS_SMALLER_OR_EQUAL","<=",127],["T_WHITESPACE"," ",127],["T_LNUMBER","16",127],")",["T_WHITESPACE"," ",127],"?",["T_WHITESPACE"," ",127],["T_VARIABLE","$left",127],["T_WHITESPACE"," ",127],":",["T_WHITESPACE"," ",127],["T_LNUMBER","16",127],";",["T_WHITESPACE","\n            ",127],["T_VARIABLE","$mask",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],"~","(",["T_LNUMBER","0xffff",128],["T_WHITESPACE"," ",128],["T_SR",">>",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$left",128],")",["T_WHITESPACE"," ",128],"&",["T_WHITESPACE"," ",128],["T_LNUMBER","0xffff",128],";",["T_WHITESPACE","\n            ",128],["T_IF","if",129],["T_WHITESPACE"," ",129],"(","(",["T_VARIABLE","$bytesAddr",129],"[",["T_VARIABLE","$i",129],"]",["T_WHITESPACE"," ",129],"&",["T_WHITESPACE"," ",129],["T_VARIABLE","$mask",129],")",["T_WHITESPACE"," ",129],["T_IS_NOT_EQUAL","!=",129],["T_WHITESPACE"," ",129],"(",["T_VARIABLE","$bytesTest",129],"[",["T_VARIABLE","$i",129],"]",["T_WHITESPACE"," ",129],"&",["T_WHITESPACE"," ",129],["T_VARIABLE","$mask",129],")",")",["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n                ",129],["T_RETURN","return",130],["T_WHITESPACE"," ",130],["T_STRING","false",130],";",["T_WHITESPACE","\n            ",130],"}",["T_WHITESPACE","\n        ",131],"}",["T_WHITESPACE","\n\n        ",132],["T_RETURN","return",134],["T_WHITESPACE"," ",134],["T_STRING","true",134],";",["T_WHITESPACE","\n    ",134],"}",["T_WHITESPACE","\n",135],"}",["T_WHITESPACE","\n",136]]