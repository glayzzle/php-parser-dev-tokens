[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Component",12],["T_NS_SEPARATOR","\\",12],["T_STRING","HttpFoundation",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Session",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Storage",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Handler",12],";",["T_WHITESPACE","\n\n",12],["T_DOC_COMMENT","\/**\n * Session handler using a PDO connection to read and write data.\n *\n * It works with MySQL, PostgreSQL, Oracle, SQL Server and SQLite and implements\n * different locking strategies to handle concurrent access to the same session.\n * Locking is necessary to prevent loss of data due to race conditions and to keep\n * the session data consistent between read() and write(). With locking, requests\n * for the same session will wait until the other one finished writing. For this\n * reason it's best practice to close a session as early as possible to improve\n * concurrency. PHPs internal files session handler also implements locking.\n *\n * Attention: Since SQLite does not support row level locks but locks the whole database,\n * it means only one session can be accessed at a time. Even different sessions would wait\n * for another to finish. So saving session in SQLite should only be considered for\n * development or prototypes.\n *\n * Session data is a binary string that can contain non-printable characters like the null byte.\n * For this reason it must be saved in a binary column in the database like BLOB in MySQL.\n * Saving it in a character column could corrupt the data. You can use createTable()\n * to initialize a correctly defined table.\n *\n * @see http:\/\/php.net\/sessionhandlerinterface\n *\n * @author Fabien Potencier <fabien@symfony.com>\n * @author Michael Williams <michael.williams@funsational.com>\n * @author Tobias Schultze <http:\/\/tobion.de>\n *\/",14],["T_WHITESPACE","\n",40],["T_CLASS","class",41],["T_WHITESPACE"," ",41],["T_STRING","PdoSessionHandler",41],["T_WHITESPACE"," ",41],["T_IMPLEMENTS","implements",41],["T_WHITESPACE"," ",41],["T_NS_SEPARATOR","\\",41],["T_STRING","SessionHandlerInterface",41],["T_WHITESPACE","\n",41],"{",["T_WHITESPACE","\n    ",42],["T_DOC_COMMENT","\/**\n     * No locking is done. This means sessions are prone to loss of data due to\n     * race conditions of concurrent requests to the same session. The last session\n     * write will win in this case. It might be useful when you implement your own\n     * logic to deal with this like an optimistic approach.\n     *\/",43],["T_WHITESPACE","\n    ",48],["T_CONST","const",49],["T_WHITESPACE"," ",49],["T_STRING","LOCK_NONE",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_LNUMBER","0",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Creates an application-level lock on a session. The disadvantage is that the\n     * lock is not enforced by the database and thus other, unaware parts of the\n     * application could still concurrently modify the session. The advantage is it\n     * does not require a transaction.\n     * This mode is not available for SQLite and not yet implemented for oci and sqlsrv.\n     *\/",51],["T_WHITESPACE","\n    ",57],["T_CONST","const",58],["T_WHITESPACE"," ",58],["T_STRING","LOCK_ADVISORY",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_LNUMBER","1",58],";",["T_WHITESPACE","\n\n    ",58],["T_DOC_COMMENT","\/**\n     * Issues a real row lock. Since it uses a transaction between opening and\n     * closing a session, you have to be careful when you use same database connection\n     * that you also use for your application logic. This mode is the default because\n     * it's the only reliable solution across DBMSs.\n     *\/",60],["T_WHITESPACE","\n    ",65],["T_CONST","const",66],["T_WHITESPACE"," ",66],["T_STRING","LOCK_TRANSACTIONAL",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_LNUMBER","2",66],";",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * @var \\PDO|null PDO instance or null when not connected yet\n     *\/",68],["T_WHITESPACE","\n    ",70],["T_PRIVATE","private",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$pdo",71],";",["T_WHITESPACE","\n\n    ",71],["T_DOC_COMMENT","\/**\n     * @var string|null|false DSN string or null for session.save_path or false when lazy connection disabled\n     *\/",73],["T_WHITESPACE","\n    ",75],["T_PRIVATE","private",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$dsn",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_STRING","false",76],";",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * @var string Database driver\n     *\/",78],["T_WHITESPACE","\n    ",80],["T_PRIVATE","private",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$driver",81],";",["T_WHITESPACE","\n\n    ",81],["T_DOC_COMMENT","\/**\n     * @var string Table name\n     *\/",83],["T_WHITESPACE","\n    ",85],["T_PRIVATE","private",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$table",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","'sessions'",86],";",["T_WHITESPACE","\n\n    ",86],["T_DOC_COMMENT","\/**\n     * @var string Column for session id\n     *\/",88],["T_WHITESPACE","\n    ",90],["T_PRIVATE","private",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$idCol",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_CONSTANT_ENCAPSED_STRING","'sess_id'",91],";",["T_WHITESPACE","\n\n    ",91],["T_DOC_COMMENT","\/**\n     * @var string Column for session data\n     *\/",93],["T_WHITESPACE","\n    ",95],["T_PRIVATE","private",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$dataCol",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","'sess_data'",96],";",["T_WHITESPACE","\n\n    ",96],["T_DOC_COMMENT","\/**\n     * @var string Column for lifetime\n     *\/",98],["T_WHITESPACE","\n    ",100],["T_PRIVATE","private",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$lifetimeCol",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","'sess_lifetime'",101],";",["T_WHITESPACE","\n\n    ",101],["T_DOC_COMMENT","\/**\n     * @var string Column for timestamp\n     *\/",103],["T_WHITESPACE","\n    ",105],["T_PRIVATE","private",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$timeCol",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'sess_time'",106],";",["T_WHITESPACE","\n\n    ",106],["T_DOC_COMMENT","\/**\n     * @var string Username when lazy-connect\n     *\/",108],["T_WHITESPACE","\n    ",110],["T_PRIVATE","private",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$username",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","''",111],";",["T_WHITESPACE","\n\n    ",111],["T_DOC_COMMENT","\/**\n     * @var string Password when lazy-connect\n     *\/",113],["T_WHITESPACE","\n    ",115],["T_PRIVATE","private",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$password",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","''",116],";",["T_WHITESPACE","\n\n    ",116],["T_DOC_COMMENT","\/**\n     * @var array Connection options when lazy-connect\n     *\/",118],["T_WHITESPACE","\n    ",120],["T_PRIVATE","private",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$connectionOptions",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_ARRAY","array",121],"(",")",";",["T_WHITESPACE","\n\n    ",121],["T_DOC_COMMENT","\/**\n     * @var int The strategy for locking, see constants\n     *\/",123],["T_WHITESPACE","\n    ",125],["T_PRIVATE","private",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$lockMode",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_STRING","self",126],["T_DOUBLE_COLON","::",126],["T_STRING","LOCK_TRANSACTIONAL",126],";",["T_WHITESPACE","\n\n    ",126],["T_DOC_COMMENT","\/**\n     * It's an array to support multiple reads before closing which is manual, non-standard usage.\n     *\n     * @var \\PDOStatement[] An array of statements to release advisory locks\n     *\/",128],["T_WHITESPACE","\n    ",132],["T_PRIVATE","private",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$unlockStatements",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_ARRAY","array",133],"(",")",";",["T_WHITESPACE","\n\n    ",133],["T_DOC_COMMENT","\/**\n     * @var bool True when the current session exists but expired according to session.gc_maxlifetime\n     *\/",135],["T_WHITESPACE","\n    ",137],["T_PRIVATE","private",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$sessionExpired",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_STRING","false",138],";",["T_WHITESPACE","\n\n    ",138],["T_DOC_COMMENT","\/**\n     * @var bool Whether a transaction is active\n     *\/",140],["T_WHITESPACE","\n    ",142],["T_PRIVATE","private",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$inTransaction",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_STRING","false",143],";",["T_WHITESPACE","\n\n    ",143],["T_DOC_COMMENT","\/**\n     * @var bool Whether gc() has been called\n     *\/",145],["T_WHITESPACE","\n    ",147],["T_PRIVATE","private",148],["T_WHITESPACE"," ",148],["T_VARIABLE","$gcCalled",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_STRING","false",148],";",["T_WHITESPACE","\n\n    ",148],["T_DOC_COMMENT","\/**\n     * Constructor.\n     *\n     * You can either pass an existing database connection as PDO instance or\n     * pass a DSN string that will be used to lazy-connect to the database\n     * when the session is actually used. Furthermore it's possible to pass null\n     * which will then use the session.save_path ini setting as PDO DSN parameter.\n     *\n     * List of available options:\n     *  * db_table: The name of the table [default: sessions]\n     *  * db_id_col: The column where to store the session id [default: sess_id]\n     *  * db_data_col: The column where to store the session data [default: sess_data]\n     *  * db_lifetime_col: The column where to store the lifetime [default: sess_lifetime]\n     *  * db_time_col: The column where to store the timestamp [default: sess_time]\n     *  * db_username: The username when lazy-connect [default: '']\n     *  * db_password: The password when lazy-connect [default: '']\n     *  * db_connection_options: An array of driver-specific connection options [default: array()]\n     *  * lock_mode: The strategy for locking, see constants [default: LOCK_TRANSACTIONAL]\n     *\n     * @param \\PDO|string|null $pdoOrDsn A \\PDO instance or DSN string or null\n     * @param array            $options  An associative array of options\n     *\n     * @throws \\InvalidArgumentException When PDO error mode is not PDO::ERRMODE_EXCEPTION\n     *\/",150],["T_WHITESPACE","\n    ",173],["T_PUBLIC","public",174],["T_WHITESPACE"," ",174],["T_FUNCTION","function",174],["T_WHITESPACE"," ",174],["T_STRING","__construct",174],"(",["T_VARIABLE","$pdoOrDsn",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_STRING","null",174],",",["T_WHITESPACE"," ",174],["T_ARRAY","array",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$options",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_ARRAY","array",174],"(",")",")",["T_WHITESPACE","\n    ",174],"{",["T_WHITESPACE","\n        ",175],["T_IF","if",176],["T_WHITESPACE"," ",176],"(",["T_VARIABLE","$pdoOrDsn",176],["T_WHITESPACE"," ",176],["T_INSTANCEOF","instanceof",176],["T_WHITESPACE"," ",176],["T_NS_SEPARATOR","\\",176],["T_STRING","PDO",176],")",["T_WHITESPACE"," ",176],"{",["T_WHITESPACE","\n            ",176],["T_IF","if",177],["T_WHITESPACE"," ",177],"(",["T_NS_SEPARATOR","\\",177],["T_STRING","PDO",177],["T_DOUBLE_COLON","::",177],["T_STRING","ERRMODE_EXCEPTION",177],["T_WHITESPACE"," ",177],["T_IS_NOT_IDENTICAL","!==",177],["T_WHITESPACE"," ",177],["T_VARIABLE","$pdoOrDsn",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","getAttribute",177],"(",["T_NS_SEPARATOR","\\",177],["T_STRING","PDO",177],["T_DOUBLE_COLON","::",177],["T_STRING","ATTR_ERRMODE",177],")",")",["T_WHITESPACE"," ",177],"{",["T_WHITESPACE","\n                ",177],["T_THROW","throw",178],["T_WHITESPACE"," ",178],["T_NEW","new",178],["T_WHITESPACE"," ",178],["T_NS_SEPARATOR","\\",178],["T_STRING","InvalidArgumentException",178],"(",["T_STRING","sprintf",178],"(",["T_CONSTANT_ENCAPSED_STRING","'\"%s\" requires PDO error mode attribute be set to throw Exceptions (i.e. $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION))'",178],",",["T_WHITESPACE"," ",178],["T_CLASS_C","__CLASS__",178],")",")",";",["T_WHITESPACE","\n            ",178],"}",["T_WHITESPACE","\n\n            ",179],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","pdo",181],["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_VARIABLE","$pdoOrDsn",181],";",["T_WHITESPACE","\n            ",181],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","driver",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","pdo",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","getAttribute",182],"(",["T_NS_SEPARATOR","\\",182],["T_STRING","PDO",182],["T_DOUBLE_COLON","::",182],["T_STRING","ATTR_DRIVER_NAME",182],")",";",["T_WHITESPACE","\n        ",182],"}",["T_WHITESPACE"," ",183],["T_ELSE","else",183],["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n            ",183],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","dsn",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_VARIABLE","$pdoOrDsn",184],";",["T_WHITESPACE","\n        ",184],"}",["T_WHITESPACE","\n\n        ",185],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","table",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_ISSET","isset",187],"(",["T_VARIABLE","$options",187],"[",["T_CONSTANT_ENCAPSED_STRING","'db_table'",187],"]",")",["T_WHITESPACE"," ",187],"?",["T_WHITESPACE"," ",187],["T_VARIABLE","$options",187],"[",["T_CONSTANT_ENCAPSED_STRING","'db_table'",187],"]",["T_WHITESPACE"," ",187],":",["T_WHITESPACE"," ",187],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","table",187],";",["T_WHITESPACE","\n        ",187],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","idCol",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_ISSET","isset",188],"(",["T_VARIABLE","$options",188],"[",["T_CONSTANT_ENCAPSED_STRING","'db_id_col'",188],"]",")",["T_WHITESPACE"," ",188],"?",["T_WHITESPACE"," ",188],["T_VARIABLE","$options",188],"[",["T_CONSTANT_ENCAPSED_STRING","'db_id_col'",188],"]",["T_WHITESPACE"," ",188],":",["T_WHITESPACE"," ",188],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","idCol",188],";",["T_WHITESPACE","\n        ",188],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","dataCol",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_ISSET","isset",189],"(",["T_VARIABLE","$options",189],"[",["T_CONSTANT_ENCAPSED_STRING","'db_data_col'",189],"]",")",["T_WHITESPACE"," ",189],"?",["T_WHITESPACE"," ",189],["T_VARIABLE","$options",189],"[",["T_CONSTANT_ENCAPSED_STRING","'db_data_col'",189],"]",["T_WHITESPACE"," ",189],":",["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","dataCol",189],";",["T_WHITESPACE","\n        ",189],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","lifetimeCol",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_ISSET","isset",190],"(",["T_VARIABLE","$options",190],"[",["T_CONSTANT_ENCAPSED_STRING","'db_lifetime_col'",190],"]",")",["T_WHITESPACE"," ",190],"?",["T_WHITESPACE"," ",190],["T_VARIABLE","$options",190],"[",["T_CONSTANT_ENCAPSED_STRING","'db_lifetime_col'",190],"]",["T_WHITESPACE"," ",190],":",["T_WHITESPACE"," ",190],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","lifetimeCol",190],";",["T_WHITESPACE","\n        ",190],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","timeCol",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_ISSET","isset",191],"(",["T_VARIABLE","$options",191],"[",["T_CONSTANT_ENCAPSED_STRING","'db_time_col'",191],"]",")",["T_WHITESPACE"," ",191],"?",["T_WHITESPACE"," ",191],["T_VARIABLE","$options",191],"[",["T_CONSTANT_ENCAPSED_STRING","'db_time_col'",191],"]",["T_WHITESPACE"," ",191],":",["T_WHITESPACE"," ",191],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","timeCol",191],";",["T_WHITESPACE","\n        ",191],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","username",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_ISSET","isset",192],"(",["T_VARIABLE","$options",192],"[",["T_CONSTANT_ENCAPSED_STRING","'db_username'",192],"]",")",["T_WHITESPACE"," ",192],"?",["T_WHITESPACE"," ",192],["T_VARIABLE","$options",192],"[",["T_CONSTANT_ENCAPSED_STRING","'db_username'",192],"]",["T_WHITESPACE"," ",192],":",["T_WHITESPACE"," ",192],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","username",192],";",["T_WHITESPACE","\n        ",192],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","password",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_ISSET","isset",193],"(",["T_VARIABLE","$options",193],"[",["T_CONSTANT_ENCAPSED_STRING","'db_password'",193],"]",")",["T_WHITESPACE"," ",193],"?",["T_WHITESPACE"," ",193],["T_VARIABLE","$options",193],"[",["T_CONSTANT_ENCAPSED_STRING","'db_password'",193],"]",["T_WHITESPACE"," ",193],":",["T_WHITESPACE"," ",193],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","password",193],";",["T_WHITESPACE","\n        ",193],["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","connectionOptions",194],["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],["T_ISSET","isset",194],"(",["T_VARIABLE","$options",194],"[",["T_CONSTANT_ENCAPSED_STRING","'db_connection_options'",194],"]",")",["T_WHITESPACE"," ",194],"?",["T_WHITESPACE"," ",194],["T_VARIABLE","$options",194],"[",["T_CONSTANT_ENCAPSED_STRING","'db_connection_options'",194],"]",["T_WHITESPACE"," ",194],":",["T_WHITESPACE"," ",194],["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","connectionOptions",194],";",["T_WHITESPACE","\n        ",194],["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","lockMode",195],["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_ISSET","isset",195],"(",["T_VARIABLE","$options",195],"[",["T_CONSTANT_ENCAPSED_STRING","'lock_mode'",195],"]",")",["T_WHITESPACE"," ",195],"?",["T_WHITESPACE"," ",195],["T_VARIABLE","$options",195],"[",["T_CONSTANT_ENCAPSED_STRING","'lock_mode'",195],"]",["T_WHITESPACE"," ",195],":",["T_WHITESPACE"," ",195],["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","lockMode",195],";",["T_WHITESPACE","\n    ",195],"}",["T_WHITESPACE","\n\n    ",196],["T_DOC_COMMENT","\/**\n     * Creates the table to store sessions which can be called once for setup.\n     *\n     * Session ID is saved in a column of maximum length 128 because that is enough even\n     * for a 512 bit configured session.hash_function like Whirlpool. Session data is\n     * saved in a BLOB. One could also use a shorter inlined varbinary column\n     * if one was sure the data fits into it.\n     *\n     * @throws \\PDOException    When the table already exists\n     * @throws \\DomainException When an unsupported PDO driver is used\n     *\/",198],["T_WHITESPACE","\n    ",208],["T_PUBLIC","public",209],["T_WHITESPACE"," ",209],["T_FUNCTION","function",209],["T_WHITESPACE"," ",209],["T_STRING","createTable",209],"(",")",["T_WHITESPACE","\n    ",209],"{",["T_WHITESPACE","\n        ",210],["T_COMMENT","\/\/ connect if we are not yet\n",211],["T_WHITESPACE","        ",212],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","getConnection",212],"(",")",";",["T_WHITESPACE","\n\n        ",212],["T_SWITCH","switch",214],["T_WHITESPACE"," ",214],"(",["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","driver",214],")",["T_WHITESPACE"," ",214],"{",["T_WHITESPACE","\n            ",214],["T_CASE","case",215],["T_WHITESPACE"," ",215],["T_CONSTANT_ENCAPSED_STRING","'mysql'",215],":",["T_WHITESPACE","\n                ",215],["T_COMMENT","\/\/ We use varbinary for the ID column because it prevents unwanted conversions:\n",216],["T_WHITESPACE","                ",217],["T_COMMENT","\/\/ - character set conversions between server and client\n",217],["T_WHITESPACE","                ",218],["T_COMMENT","\/\/ - trailing space removal\n",218],["T_WHITESPACE","                ",219],["T_COMMENT","\/\/ - case-insensitivity\n",219],["T_WHITESPACE","                ",220],["T_COMMENT","\/\/ - language processing like \u00c3\u00a9 == e\n",220],["T_WHITESPACE","                ",221],["T_VARIABLE","$sql",221],["T_WHITESPACE"," ",221],"=",["T_WHITESPACE"," ",221],"\"",["T_ENCAPSED_AND_WHITESPACE","CREATE TABLE ",221],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","table",221],["T_ENCAPSED_AND_WHITESPACE"," (",221],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","idCol",221],["T_ENCAPSED_AND_WHITESPACE"," VARBINARY(128) NOT NULL PRIMARY KEY, ",221],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","dataCol",221],["T_ENCAPSED_AND_WHITESPACE"," BLOB NOT NULL, ",221],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","lifetimeCol",221],["T_ENCAPSED_AND_WHITESPACE"," MEDIUMINT NOT NULL, ",221],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","timeCol",221],["T_ENCAPSED_AND_WHITESPACE"," INTEGER UNSIGNED NOT NULL) COLLATE utf8_bin, ENGINE = InnoDB",221],"\"",";",["T_WHITESPACE","\n                ",221],["T_BREAK","break",222],";",["T_WHITESPACE","\n            ",222],["T_CASE","case",223],["T_WHITESPACE"," ",223],["T_CONSTANT_ENCAPSED_STRING","'sqlite'",223],":",["T_WHITESPACE","\n                ",223],["T_VARIABLE","$sql",224],["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],"\"",["T_ENCAPSED_AND_WHITESPACE","CREATE TABLE ",224],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","table",224],["T_ENCAPSED_AND_WHITESPACE"," (",224],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","idCol",224],["T_ENCAPSED_AND_WHITESPACE"," TEXT NOT NULL PRIMARY KEY, ",224],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","dataCol",224],["T_ENCAPSED_AND_WHITESPACE"," BLOB NOT NULL, ",224],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","lifetimeCol",224],["T_ENCAPSED_AND_WHITESPACE"," INTEGER NOT NULL, ",224],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","timeCol",224],["T_ENCAPSED_AND_WHITESPACE"," INTEGER NOT NULL)",224],"\"",";",["T_WHITESPACE","\n                ",224],["T_BREAK","break",225],";",["T_WHITESPACE","\n            ",225],["T_CASE","case",226],["T_WHITESPACE"," ",226],["T_CONSTANT_ENCAPSED_STRING","'pgsql'",226],":",["T_WHITESPACE","\n                ",226],["T_VARIABLE","$sql",227],["T_WHITESPACE"," ",227],"=",["T_WHITESPACE"," ",227],"\"",["T_ENCAPSED_AND_WHITESPACE","CREATE TABLE ",227],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","table",227],["T_ENCAPSED_AND_WHITESPACE"," (",227],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","idCol",227],["T_ENCAPSED_AND_WHITESPACE"," VARCHAR(128) NOT NULL PRIMARY KEY, ",227],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","dataCol",227],["T_ENCAPSED_AND_WHITESPACE"," BYTEA NOT NULL, ",227],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","lifetimeCol",227],["T_ENCAPSED_AND_WHITESPACE"," INTEGER NOT NULL, ",227],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","timeCol",227],["T_ENCAPSED_AND_WHITESPACE"," INTEGER NOT NULL)",227],"\"",";",["T_WHITESPACE","\n                ",227],["T_BREAK","break",228],";",["T_WHITESPACE","\n            ",228],["T_CASE","case",229],["T_WHITESPACE"," ",229],["T_CONSTANT_ENCAPSED_STRING","'oci'",229],":",["T_WHITESPACE","\n                ",229],["T_VARIABLE","$sql",230],["T_WHITESPACE"," ",230],"=",["T_WHITESPACE"," ",230],"\"",["T_ENCAPSED_AND_WHITESPACE","CREATE TABLE ",230],["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","table",230],["T_ENCAPSED_AND_WHITESPACE"," (",230],["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","idCol",230],["T_ENCAPSED_AND_WHITESPACE"," VARCHAR2(128) NOT NULL PRIMARY KEY, ",230],["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","dataCol",230],["T_ENCAPSED_AND_WHITESPACE"," BLOB NOT NULL, ",230],["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","lifetimeCol",230],["T_ENCAPSED_AND_WHITESPACE"," INTEGER NOT NULL, ",230],["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","timeCol",230],["T_ENCAPSED_AND_WHITESPACE"," INTEGER NOT NULL)",230],"\"",";",["T_WHITESPACE","\n                ",230],["T_BREAK","break",231],";",["T_WHITESPACE","\n            ",231],["T_CASE","case",232],["T_WHITESPACE"," ",232],["T_CONSTANT_ENCAPSED_STRING","'sqlsrv'",232],":",["T_WHITESPACE","\n                ",232],["T_VARIABLE","$sql",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],"\"",["T_ENCAPSED_AND_WHITESPACE","CREATE TABLE ",233],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","table",233],["T_ENCAPSED_AND_WHITESPACE"," (",233],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","idCol",233],["T_ENCAPSED_AND_WHITESPACE"," VARCHAR(128) NOT NULL PRIMARY KEY, ",233],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","dataCol",233],["T_ENCAPSED_AND_WHITESPACE"," VARBINARY(MAX) NOT NULL, ",233],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","lifetimeCol",233],["T_ENCAPSED_AND_WHITESPACE"," INTEGER NOT NULL, ",233],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","timeCol",233],["T_ENCAPSED_AND_WHITESPACE"," INTEGER NOT NULL)",233],"\"",";",["T_WHITESPACE","\n                ",233],["T_BREAK","break",234],";",["T_WHITESPACE","\n            ",234],["T_DEFAULT","default",235],":",["T_WHITESPACE","\n                ",235],["T_THROW","throw",236],["T_WHITESPACE"," ",236],["T_NEW","new",236],["T_WHITESPACE"," ",236],["T_NS_SEPARATOR","\\",236],["T_STRING","DomainException",236],"(",["T_STRING","sprintf",236],"(",["T_CONSTANT_ENCAPSED_STRING","'Creating the session table is currently not implemented for PDO driver \"%s\".'",236],",",["T_WHITESPACE"," ",236],["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","driver",236],")",")",";",["T_WHITESPACE","\n        ",236],"}",["T_WHITESPACE","\n\n        ",237],["T_TRY","try",239],["T_WHITESPACE"," ",239],"{",["T_WHITESPACE","\n            ",239],["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","pdo",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","exec",240],"(",["T_VARIABLE","$sql",240],")",";",["T_WHITESPACE","\n        ",240],"}",["T_WHITESPACE"," ",241],["T_CATCH","catch",241],["T_WHITESPACE"," ",241],"(",["T_NS_SEPARATOR","\\",241],["T_STRING","PDOException",241],["T_WHITESPACE"," ",241],["T_VARIABLE","$e",241],")",["T_WHITESPACE"," ",241],"{",["T_WHITESPACE","\n            ",241],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","rollback",242],"(",")",";",["T_WHITESPACE","\n\n            ",242],["T_THROW","throw",244],["T_WHITESPACE"," ",244],["T_VARIABLE","$e",244],";",["T_WHITESPACE","\n        ",244],"}",["T_WHITESPACE","\n    ",245],"}",["T_WHITESPACE","\n\n    ",246],["T_DOC_COMMENT","\/**\n     * Returns true when the current session exists but expired according to session.gc_maxlifetime.\n     *\n     * Can be used to distinguish between a new session and one that expired due to inactivity.\n     *\n     * @return bool Whether current session expired\n     *\/",248],["T_WHITESPACE","\n    ",254],["T_PUBLIC","public",255],["T_WHITESPACE"," ",255],["T_FUNCTION","function",255],["T_WHITESPACE"," ",255],["T_STRING","isSessionExpired",255],"(",")",["T_WHITESPACE","\n    ",255],"{",["T_WHITESPACE","\n        ",256],["T_RETURN","return",257],["T_WHITESPACE"," ",257],["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","sessionExpired",257],";",["T_WHITESPACE","\n    ",257],"}",["T_WHITESPACE","\n\n    ",258],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",260],["T_WHITESPACE","\n    ",262],["T_PUBLIC","public",263],["T_WHITESPACE"," ",263],["T_FUNCTION","function",263],["T_WHITESPACE"," ",263],["T_STRING","open",263],"(",["T_VARIABLE","$savePath",263],",",["T_WHITESPACE"," ",263],["T_VARIABLE","$sessionName",263],")",["T_WHITESPACE","\n    ",263],"{",["T_WHITESPACE","\n        ",264],["T_IF","if",265],["T_WHITESPACE"," ",265],"(",["T_STRING","null",265],["T_WHITESPACE"," ",265],["T_IS_IDENTICAL","===",265],["T_WHITESPACE"," ",265],["T_VARIABLE","$this",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","pdo",265],")",["T_WHITESPACE"," ",265],"{",["T_WHITESPACE","\n            ",265],["T_VARIABLE","$this",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","connect",266],"(",["T_VARIABLE","$this",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","dsn",266],["T_WHITESPACE"," ",266],"?",":",["T_WHITESPACE"," ",266],["T_VARIABLE","$savePath",266],")",";",["T_WHITESPACE","\n        ",266],"}",["T_WHITESPACE","\n\n        ",267],["T_RETURN","return",269],["T_WHITESPACE"," ",269],["T_STRING","true",269],";",["T_WHITESPACE","\n    ",269],"}",["T_WHITESPACE","\n\n    ",270],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",272],["T_WHITESPACE","\n    ",274],["T_PUBLIC","public",275],["T_WHITESPACE"," ",275],["T_FUNCTION","function",275],["T_WHITESPACE"," ",275],["T_STRING","read",275],"(",["T_VARIABLE","$sessionId",275],")",["T_WHITESPACE","\n    ",275],"{",["T_WHITESPACE","\n        ",276],["T_TRY","try",277],["T_WHITESPACE"," ",277],"{",["T_WHITESPACE","\n            ",277],["T_RETURN","return",278],["T_WHITESPACE"," ",278],["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","doRead",278],"(",["T_VARIABLE","$sessionId",278],")",";",["T_WHITESPACE","\n        ",278],"}",["T_WHITESPACE"," ",279],["T_CATCH","catch",279],["T_WHITESPACE"," ",279],"(",["T_NS_SEPARATOR","\\",279],["T_STRING","PDOException",279],["T_WHITESPACE"," ",279],["T_VARIABLE","$e",279],")",["T_WHITESPACE"," ",279],"{",["T_WHITESPACE","\n            ",279],["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","rollback",280],"(",")",";",["T_WHITESPACE","\n\n            ",280],["T_THROW","throw",282],["T_WHITESPACE"," ",282],["T_VARIABLE","$e",282],";",["T_WHITESPACE","\n        ",282],"}",["T_WHITESPACE","\n    ",283],"}",["T_WHITESPACE","\n\n    ",284],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",286],["T_WHITESPACE","\n    ",288],["T_PUBLIC","public",289],["T_WHITESPACE"," ",289],["T_FUNCTION","function",289],["T_WHITESPACE"," ",289],["T_STRING","gc",289],"(",["T_VARIABLE","$maxlifetime",289],")",["T_WHITESPACE","\n    ",289],"{",["T_WHITESPACE","\n        ",290],["T_COMMENT","\/\/ We delay gc() to close() so that it is executed outside the transactional and blocking read-write process.\n",291],["T_WHITESPACE","        ",292],["T_COMMENT","\/\/ This way, pruning expired sessions does not block them from being started while the current session is used.\n",292],["T_WHITESPACE","        ",293],["T_VARIABLE","$this",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","gcCalled",293],["T_WHITESPACE"," ",293],"=",["T_WHITESPACE"," ",293],["T_STRING","true",293],";",["T_WHITESPACE","\n\n        ",293],["T_RETURN","return",295],["T_WHITESPACE"," ",295],["T_STRING","true",295],";",["T_WHITESPACE","\n    ",295],"}",["T_WHITESPACE","\n\n    ",296],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",298],["T_WHITESPACE","\n    ",300],["T_PUBLIC","public",301],["T_WHITESPACE"," ",301],["T_FUNCTION","function",301],["T_WHITESPACE"," ",301],["T_STRING","destroy",301],"(",["T_VARIABLE","$sessionId",301],")",["T_WHITESPACE","\n    ",301],"{",["T_WHITESPACE","\n        ",302],["T_COMMENT","\/\/ delete the record associated with this id\n",303],["T_WHITESPACE","        ",304],["T_VARIABLE","$sql",304],["T_WHITESPACE"," ",304],"=",["T_WHITESPACE"," ",304],"\"",["T_ENCAPSED_AND_WHITESPACE","DELETE FROM ",304],["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","table",304],["T_ENCAPSED_AND_WHITESPACE"," WHERE ",304],["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","idCol",304],["T_ENCAPSED_AND_WHITESPACE"," = :id",304],"\"",";",["T_WHITESPACE","\n\n        ",304],["T_TRY","try",306],["T_WHITESPACE"," ",306],"{",["T_WHITESPACE","\n            ",306],["T_VARIABLE","$stmt",307],["T_WHITESPACE"," ",307],"=",["T_WHITESPACE"," ",307],["T_VARIABLE","$this",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","pdo",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","prepare",307],"(",["T_VARIABLE","$sql",307],")",";",["T_WHITESPACE","\n            ",307],["T_VARIABLE","$stmt",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","bindParam",308],"(",["T_CONSTANT_ENCAPSED_STRING","':id'",308],",",["T_WHITESPACE"," ",308],["T_VARIABLE","$sessionId",308],",",["T_WHITESPACE"," ",308],["T_NS_SEPARATOR","\\",308],["T_STRING","PDO",308],["T_DOUBLE_COLON","::",308],["T_STRING","PARAM_STR",308],")",";",["T_WHITESPACE","\n            ",308],["T_VARIABLE","$stmt",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","execute",309],"(",")",";",["T_WHITESPACE","\n        ",309],"}",["T_WHITESPACE"," ",310],["T_CATCH","catch",310],["T_WHITESPACE"," ",310],"(",["T_NS_SEPARATOR","\\",310],["T_STRING","PDOException",310],["T_WHITESPACE"," ",310],["T_VARIABLE","$e",310],")",["T_WHITESPACE"," ",310],"{",["T_WHITESPACE","\n            ",310],["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","rollback",311],"(",")",";",["T_WHITESPACE","\n\n            ",311],["T_THROW","throw",313],["T_WHITESPACE"," ",313],["T_VARIABLE","$e",313],";",["T_WHITESPACE","\n        ",313],"}",["T_WHITESPACE","\n\n        ",314],["T_RETURN","return",316],["T_WHITESPACE"," ",316],["T_STRING","true",316],";",["T_WHITESPACE","\n    ",316],"}",["T_WHITESPACE","\n\n    ",317],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",319],["T_WHITESPACE","\n    ",321],["T_PUBLIC","public",322],["T_WHITESPACE"," ",322],["T_FUNCTION","function",322],["T_WHITESPACE"," ",322],["T_STRING","write",322],"(",["T_VARIABLE","$sessionId",322],",",["T_WHITESPACE"," ",322],["T_VARIABLE","$data",322],")",["T_WHITESPACE","\n    ",322],"{",["T_WHITESPACE","\n        ",323],["T_VARIABLE","$maxlifetime",324],["T_WHITESPACE"," ",324],"=",["T_WHITESPACE"," ",324],["T_INT_CAST","(int)",324],["T_WHITESPACE"," ",324],["T_STRING","ini_get",324],"(",["T_CONSTANT_ENCAPSED_STRING","'session.gc_maxlifetime'",324],")",";",["T_WHITESPACE","\n\n        ",324],["T_TRY","try",326],["T_WHITESPACE"," ",326],"{",["T_WHITESPACE","\n            ",326],["T_COMMENT","\/\/ We use a single MERGE SQL query when supported by the database.\n",327],["T_WHITESPACE","            ",328],["T_VARIABLE","$mergeStmt",328],["T_WHITESPACE"," ",328],"=",["T_WHITESPACE"," ",328],["T_VARIABLE","$this",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","getMergeStatement",328],"(",["T_VARIABLE","$sessionId",328],",",["T_WHITESPACE"," ",328],["T_VARIABLE","$data",328],",",["T_WHITESPACE"," ",328],["T_VARIABLE","$maxlifetime",328],")",";",["T_WHITESPACE","\n            ",328],["T_IF","if",329],["T_WHITESPACE"," ",329],"(",["T_STRING","null",329],["T_WHITESPACE"," ",329],["T_IS_NOT_IDENTICAL","!==",329],["T_WHITESPACE"," ",329],["T_VARIABLE","$mergeStmt",329],")",["T_WHITESPACE"," ",329],"{",["T_WHITESPACE","\n                ",329],["T_VARIABLE","$mergeStmt",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","execute",330],"(",")",";",["T_WHITESPACE","\n\n                ",330],["T_RETURN","return",332],["T_WHITESPACE"," ",332],["T_STRING","true",332],";",["T_WHITESPACE","\n            ",332],"}",["T_WHITESPACE","\n\n            ",333],["T_VARIABLE","$updateStmt",335],["T_WHITESPACE"," ",335],"=",["T_WHITESPACE"," ",335],["T_VARIABLE","$this",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","pdo",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","prepare",335],"(",["T_WHITESPACE","\n                ",335],"\"",["T_ENCAPSED_AND_WHITESPACE","UPDATE ",336],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","table",336],["T_ENCAPSED_AND_WHITESPACE"," SET ",336],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","dataCol",336],["T_ENCAPSED_AND_WHITESPACE"," = :data, ",336],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","lifetimeCol",336],["T_ENCAPSED_AND_WHITESPACE"," = :lifetime, ",336],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","timeCol",336],["T_ENCAPSED_AND_WHITESPACE"," = :time WHERE ",336],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","idCol",336],["T_ENCAPSED_AND_WHITESPACE"," = :id",336],"\"",["T_WHITESPACE","\n            ",336],")",";",["T_WHITESPACE","\n            ",337],["T_VARIABLE","$updateStmt",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","bindParam",338],"(",["T_CONSTANT_ENCAPSED_STRING","':id'",338],",",["T_WHITESPACE"," ",338],["T_VARIABLE","$sessionId",338],",",["T_WHITESPACE"," ",338],["T_NS_SEPARATOR","\\",338],["T_STRING","PDO",338],["T_DOUBLE_COLON","::",338],["T_STRING","PARAM_STR",338],")",";",["T_WHITESPACE","\n            ",338],["T_VARIABLE","$updateStmt",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","bindParam",339],"(",["T_CONSTANT_ENCAPSED_STRING","':data'",339],",",["T_WHITESPACE"," ",339],["T_VARIABLE","$data",339],",",["T_WHITESPACE"," ",339],["T_NS_SEPARATOR","\\",339],["T_STRING","PDO",339],["T_DOUBLE_COLON","::",339],["T_STRING","PARAM_LOB",339],")",";",["T_WHITESPACE","\n            ",339],["T_VARIABLE","$updateStmt",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","bindParam",340],"(",["T_CONSTANT_ENCAPSED_STRING","':lifetime'",340],",",["T_WHITESPACE"," ",340],["T_VARIABLE","$maxlifetime",340],",",["T_WHITESPACE"," ",340],["T_NS_SEPARATOR","\\",340],["T_STRING","PDO",340],["T_DOUBLE_COLON","::",340],["T_STRING","PARAM_INT",340],")",";",["T_WHITESPACE","\n            ",340],["T_VARIABLE","$updateStmt",341],["T_OBJECT_OPERATOR","->",341],["T_STRING","bindValue",341],"(",["T_CONSTANT_ENCAPSED_STRING","':time'",341],",",["T_WHITESPACE"," ",341],["T_STRING","time",341],"(",")",",",["T_WHITESPACE"," ",341],["T_NS_SEPARATOR","\\",341],["T_STRING","PDO",341],["T_DOUBLE_COLON","::",341],["T_STRING","PARAM_INT",341],")",";",["T_WHITESPACE","\n            ",341],["T_VARIABLE","$updateStmt",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","execute",342],"(",")",";",["T_WHITESPACE","\n\n            ",342],["T_COMMENT","\/\/ When MERGE is not supported, like in Postgres < 9.5, we have to use this approach that can result in\n",344],["T_WHITESPACE","            ",345],["T_COMMENT","\/\/ duplicate key errors when the same session is written simultaneously (given the LOCK_NONE behavior).\n",345],["T_WHITESPACE","            ",346],["T_COMMENT","\/\/ We can just catch such an error and re-execute the update. This is similar to a serializable\n",346],["T_WHITESPACE","            ",347],["T_COMMENT","\/\/ transaction with retry logic on serialization failures but without the overhead and without possible\n",347],["T_WHITESPACE","            ",348],["T_COMMENT","\/\/ false positives due to longer gap locking.\n",348],["T_WHITESPACE","            ",349],["T_IF","if",349],["T_WHITESPACE"," ",349],"(","!",["T_VARIABLE","$updateStmt",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","rowCount",349],"(",")",")",["T_WHITESPACE"," ",349],"{",["T_WHITESPACE","\n                ",349],["T_TRY","try",350],["T_WHITESPACE"," ",350],"{",["T_WHITESPACE","\n                    ",350],["T_VARIABLE","$insertStmt",351],["T_WHITESPACE"," ",351],"=",["T_WHITESPACE"," ",351],["T_VARIABLE","$this",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","pdo",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","prepare",351],"(",["T_WHITESPACE","\n                        ",351],"\"",["T_ENCAPSED_AND_WHITESPACE","INSERT INTO ",352],["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","table",352],["T_ENCAPSED_AND_WHITESPACE"," (",352],["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","idCol",352],["T_ENCAPSED_AND_WHITESPACE",", ",352],["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","dataCol",352],["T_ENCAPSED_AND_WHITESPACE",", ",352],["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","lifetimeCol",352],["T_ENCAPSED_AND_WHITESPACE",", ",352],["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","timeCol",352],["T_ENCAPSED_AND_WHITESPACE",") VALUES (:id, :data, :lifetime, :time)",352],"\"",["T_WHITESPACE","\n                    ",352],")",";",["T_WHITESPACE","\n                    ",353],["T_VARIABLE","$insertStmt",354],["T_OBJECT_OPERATOR","->",354],["T_STRING","bindParam",354],"(",["T_CONSTANT_ENCAPSED_STRING","':id'",354],",",["T_WHITESPACE"," ",354],["T_VARIABLE","$sessionId",354],",",["T_WHITESPACE"," ",354],["T_NS_SEPARATOR","\\",354],["T_STRING","PDO",354],["T_DOUBLE_COLON","::",354],["T_STRING","PARAM_STR",354],")",";",["T_WHITESPACE","\n                    ",354],["T_VARIABLE","$insertStmt",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","bindParam",355],"(",["T_CONSTANT_ENCAPSED_STRING","':data'",355],",",["T_WHITESPACE"," ",355],["T_VARIABLE","$data",355],",",["T_WHITESPACE"," ",355],["T_NS_SEPARATOR","\\",355],["T_STRING","PDO",355],["T_DOUBLE_COLON","::",355],["T_STRING","PARAM_LOB",355],")",";",["T_WHITESPACE","\n                    ",355],["T_VARIABLE","$insertStmt",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","bindParam",356],"(",["T_CONSTANT_ENCAPSED_STRING","':lifetime'",356],",",["T_WHITESPACE"," ",356],["T_VARIABLE","$maxlifetime",356],",",["T_WHITESPACE"," ",356],["T_NS_SEPARATOR","\\",356],["T_STRING","PDO",356],["T_DOUBLE_COLON","::",356],["T_STRING","PARAM_INT",356],")",";",["T_WHITESPACE","\n                    ",356],["T_VARIABLE","$insertStmt",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","bindValue",357],"(",["T_CONSTANT_ENCAPSED_STRING","':time'",357],",",["T_WHITESPACE"," ",357],["T_STRING","time",357],"(",")",",",["T_WHITESPACE"," ",357],["T_NS_SEPARATOR","\\",357],["T_STRING","PDO",357],["T_DOUBLE_COLON","::",357],["T_STRING","PARAM_INT",357],")",";",["T_WHITESPACE","\n                    ",357],["T_VARIABLE","$insertStmt",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","execute",358],"(",")",";",["T_WHITESPACE","\n                ",358],"}",["T_WHITESPACE"," ",359],["T_CATCH","catch",359],["T_WHITESPACE"," ",359],"(",["T_NS_SEPARATOR","\\",359],["T_STRING","PDOException",359],["T_WHITESPACE"," ",359],["T_VARIABLE","$e",359],")",["T_WHITESPACE"," ",359],"{",["T_WHITESPACE","\n                    ",359],["T_COMMENT","\/\/ Handle integrity violation SQLSTATE 23000 (or a subclass like 23505 in Postgres) for duplicate keys\n",360],["T_WHITESPACE","                    ",361],["T_IF","if",361],["T_WHITESPACE"," ",361],"(",["T_LNUMBER","0",361],["T_WHITESPACE"," ",361],["T_IS_IDENTICAL","===",361],["T_WHITESPACE"," ",361],["T_STRING","strpos",361],"(",["T_VARIABLE","$e",361],["T_OBJECT_OPERATOR","->",361],["T_STRING","getCode",361],"(",")",",",["T_WHITESPACE"," ",361],["T_CONSTANT_ENCAPSED_STRING","'23'",361],")",")",["T_WHITESPACE"," ",361],"{",["T_WHITESPACE","\n                        ",361],["T_VARIABLE","$updateStmt",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","execute",362],"(",")",";",["T_WHITESPACE","\n                    ",362],"}",["T_WHITESPACE"," ",363],["T_ELSE","else",363],["T_WHITESPACE"," ",363],"{",["T_WHITESPACE","\n                        ",363],["T_THROW","throw",364],["T_WHITESPACE"," ",364],["T_VARIABLE","$e",364],";",["T_WHITESPACE","\n                    ",364],"}",["T_WHITESPACE","\n                ",365],"}",["T_WHITESPACE","\n            ",366],"}",["T_WHITESPACE","\n        ",367],"}",["T_WHITESPACE"," ",368],["T_CATCH","catch",368],["T_WHITESPACE"," ",368],"(",["T_NS_SEPARATOR","\\",368],["T_STRING","PDOException",368],["T_WHITESPACE"," ",368],["T_VARIABLE","$e",368],")",["T_WHITESPACE"," ",368],"{",["T_WHITESPACE","\n            ",368],["T_VARIABLE","$this",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","rollback",369],"(",")",";",["T_WHITESPACE","\n\n            ",369],["T_THROW","throw",371],["T_WHITESPACE"," ",371],["T_VARIABLE","$e",371],";",["T_WHITESPACE","\n        ",371],"}",["T_WHITESPACE","\n\n        ",372],["T_RETURN","return",374],["T_WHITESPACE"," ",374],["T_STRING","true",374],";",["T_WHITESPACE","\n    ",374],"}",["T_WHITESPACE","\n\n    ",375],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",377],["T_WHITESPACE","\n    ",379],["T_PUBLIC","public",380],["T_WHITESPACE"," ",380],["T_FUNCTION","function",380],["T_WHITESPACE"," ",380],["T_STRING","close",380],"(",")",["T_WHITESPACE","\n    ",380],"{",["T_WHITESPACE","\n        ",381],["T_VARIABLE","$this",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","commit",382],"(",")",";",["T_WHITESPACE","\n\n        ",382],["T_WHILE","while",384],["T_WHITESPACE"," ",384],"(",["T_VARIABLE","$unlockStmt",384],["T_WHITESPACE"," ",384],"=",["T_WHITESPACE"," ",384],["T_STRING","array_shift",384],"(",["T_VARIABLE","$this",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","unlockStatements",384],")",")",["T_WHITESPACE"," ",384],"{",["T_WHITESPACE","\n            ",384],["T_VARIABLE","$unlockStmt",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","execute",385],"(",")",";",["T_WHITESPACE","\n        ",385],"}",["T_WHITESPACE","\n\n        ",386],["T_IF","if",388],["T_WHITESPACE"," ",388],"(",["T_VARIABLE","$this",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","gcCalled",388],")",["T_WHITESPACE"," ",388],"{",["T_WHITESPACE","\n            ",388],["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","gcCalled",389],["T_WHITESPACE"," ",389],"=",["T_WHITESPACE"," ",389],["T_STRING","false",389],";",["T_WHITESPACE","\n\n            ",389],["T_COMMENT","\/\/ delete the session records that have expired\n",391],["T_WHITESPACE","            ",392],["T_VARIABLE","$sql",392],["T_WHITESPACE"," ",392],"=",["T_WHITESPACE"," ",392],"\"",["T_ENCAPSED_AND_WHITESPACE","DELETE FROM ",392],["T_VARIABLE","$this",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","table",392],["T_ENCAPSED_AND_WHITESPACE"," WHERE ",392],["T_VARIABLE","$this",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","lifetimeCol",392],["T_ENCAPSED_AND_WHITESPACE"," + ",392],["T_VARIABLE","$this",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","timeCol",392],["T_ENCAPSED_AND_WHITESPACE"," < :time",392],"\"",";",["T_WHITESPACE","\n\n            ",392],["T_VARIABLE","$stmt",394],["T_WHITESPACE"," ",394],"=",["T_WHITESPACE"," ",394],["T_VARIABLE","$this",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","pdo",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","prepare",394],"(",["T_VARIABLE","$sql",394],")",";",["T_WHITESPACE","\n            ",394],["T_VARIABLE","$stmt",395],["T_OBJECT_OPERATOR","->",395],["T_STRING","bindValue",395],"(",["T_CONSTANT_ENCAPSED_STRING","':time'",395],",",["T_WHITESPACE"," ",395],["T_STRING","time",395],"(",")",",",["T_WHITESPACE"," ",395],["T_NS_SEPARATOR","\\",395],["T_STRING","PDO",395],["T_DOUBLE_COLON","::",395],["T_STRING","PARAM_INT",395],")",";",["T_WHITESPACE","\n            ",395],["T_VARIABLE","$stmt",396],["T_OBJECT_OPERATOR","->",396],["T_STRING","execute",396],"(",")",";",["T_WHITESPACE","\n        ",396],"}",["T_WHITESPACE","\n\n        ",397],["T_IF","if",399],["T_WHITESPACE"," ",399],"(",["T_STRING","false",399],["T_WHITESPACE"," ",399],["T_IS_NOT_IDENTICAL","!==",399],["T_WHITESPACE"," ",399],["T_VARIABLE","$this",399],["T_OBJECT_OPERATOR","->",399],["T_STRING","dsn",399],")",["T_WHITESPACE"," ",399],"{",["T_WHITESPACE","\n            ",399],["T_VARIABLE","$this",400],["T_OBJECT_OPERATOR","->",400],["T_STRING","pdo",400],["T_WHITESPACE"," ",400],"=",["T_WHITESPACE"," ",400],["T_STRING","null",400],";",["T_WHITESPACE"," ",400],["T_COMMENT","\/\/ only close lazy-connection\n",400],["T_WHITESPACE","        ",401],"}",["T_WHITESPACE","\n\n        ",401],["T_RETURN","return",403],["T_WHITESPACE"," ",403],["T_STRING","true",403],";",["T_WHITESPACE","\n    ",403],"}",["T_WHITESPACE","\n\n    ",404],["T_DOC_COMMENT","\/**\n     * Lazy-connects to the database.\n     *\n     * @param string $dsn DSN string\n     *\/",406],["T_WHITESPACE","\n    ",410],["T_PRIVATE","private",411],["T_WHITESPACE"," ",411],["T_FUNCTION","function",411],["T_WHITESPACE"," ",411],["T_STRING","connect",411],"(",["T_VARIABLE","$dsn",411],")",["T_WHITESPACE","\n    ",411],"{",["T_WHITESPACE","\n        ",412],["T_VARIABLE","$this",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","pdo",413],["T_WHITESPACE"," ",413],"=",["T_WHITESPACE"," ",413],["T_NEW","new",413],["T_WHITESPACE"," ",413],["T_NS_SEPARATOR","\\",413],["T_STRING","PDO",413],"(",["T_VARIABLE","$dsn",413],",",["T_WHITESPACE"," ",413],["T_VARIABLE","$this",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","username",413],",",["T_WHITESPACE"," ",413],["T_VARIABLE","$this",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","password",413],",",["T_WHITESPACE"," ",413],["T_VARIABLE","$this",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","connectionOptions",413],")",";",["T_WHITESPACE","\n        ",413],["T_VARIABLE","$this",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","pdo",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","setAttribute",414],"(",["T_NS_SEPARATOR","\\",414],["T_STRING","PDO",414],["T_DOUBLE_COLON","::",414],["T_STRING","ATTR_ERRMODE",414],",",["T_WHITESPACE"," ",414],["T_NS_SEPARATOR","\\",414],["T_STRING","PDO",414],["T_DOUBLE_COLON","::",414],["T_STRING","ERRMODE_EXCEPTION",414],")",";",["T_WHITESPACE","\n        ",414],["T_VARIABLE","$this",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","driver",415],["T_WHITESPACE"," ",415],"=",["T_WHITESPACE"," ",415],["T_VARIABLE","$this",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","pdo",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","getAttribute",415],"(",["T_NS_SEPARATOR","\\",415],["T_STRING","PDO",415],["T_DOUBLE_COLON","::",415],["T_STRING","ATTR_DRIVER_NAME",415],")",";",["T_WHITESPACE","\n    ",415],"}",["T_WHITESPACE","\n\n    ",416],["T_DOC_COMMENT","\/**\n     * Helper method to begin a transaction.\n     *\n     * Since SQLite does not support row level locks, we have to acquire a reserved lock\n     * on the database immediately. Because of https:\/\/bugs.php.net\/42766 we have to create\n     * such a transaction manually which also means we cannot use PDO::commit or\n     * PDO::rollback or PDO::inTransaction for SQLite.\n     *\n     * Also MySQLs default isolation, REPEATABLE READ, causes deadlock for different sessions\n     * due to http:\/\/www.mysqlperformanceblog.com\/2013\/12\/12\/one-more-innodb-gap-lock-to-avoid\/ .\n     * So we change it to READ COMMITTED.\n     *\/",418],["T_WHITESPACE","\n    ",429],["T_PRIVATE","private",430],["T_WHITESPACE"," ",430],["T_FUNCTION","function",430],["T_WHITESPACE"," ",430],["T_STRING","beginTransaction",430],"(",")",["T_WHITESPACE","\n    ",430],"{",["T_WHITESPACE","\n        ",431],["T_IF","if",432],["T_WHITESPACE"," ",432],"(","!",["T_VARIABLE","$this",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","inTransaction",432],")",["T_WHITESPACE"," ",432],"{",["T_WHITESPACE","\n            ",432],["T_IF","if",433],["T_WHITESPACE"," ",433],"(",["T_CONSTANT_ENCAPSED_STRING","'sqlite'",433],["T_WHITESPACE"," ",433],["T_IS_IDENTICAL","===",433],["T_WHITESPACE"," ",433],["T_VARIABLE","$this",433],["T_OBJECT_OPERATOR","->",433],["T_STRING","driver",433],")",["T_WHITESPACE"," ",433],"{",["T_WHITESPACE","\n                ",433],["T_VARIABLE","$this",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","pdo",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","exec",434],"(",["T_CONSTANT_ENCAPSED_STRING","'BEGIN IMMEDIATE TRANSACTION'",434],")",";",["T_WHITESPACE","\n            ",434],"}",["T_WHITESPACE"," ",435],["T_ELSE","else",435],["T_WHITESPACE"," ",435],"{",["T_WHITESPACE","\n                ",435],["T_IF","if",436],["T_WHITESPACE"," ",436],"(",["T_CONSTANT_ENCAPSED_STRING","'mysql'",436],["T_WHITESPACE"," ",436],["T_IS_IDENTICAL","===",436],["T_WHITESPACE"," ",436],["T_VARIABLE","$this",436],["T_OBJECT_OPERATOR","->",436],["T_STRING","driver",436],")",["T_WHITESPACE"," ",436],"{",["T_WHITESPACE","\n                    ",436],["T_VARIABLE","$this",437],["T_OBJECT_OPERATOR","->",437],["T_STRING","pdo",437],["T_OBJECT_OPERATOR","->",437],["T_STRING","exec",437],"(",["T_CONSTANT_ENCAPSED_STRING","'SET TRANSACTION ISOLATION LEVEL READ COMMITTED'",437],")",";",["T_WHITESPACE","\n                ",437],"}",["T_WHITESPACE","\n                ",438],["T_VARIABLE","$this",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","pdo",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","beginTransaction",439],"(",")",";",["T_WHITESPACE","\n            ",439],"}",["T_WHITESPACE","\n            ",440],["T_VARIABLE","$this",441],["T_OBJECT_OPERATOR","->",441],["T_STRING","inTransaction",441],["T_WHITESPACE"," ",441],"=",["T_WHITESPACE"," ",441],["T_STRING","true",441],";",["T_WHITESPACE","\n        ",441],"}",["T_WHITESPACE","\n    ",442],"}",["T_WHITESPACE","\n\n    ",443],["T_DOC_COMMENT","\/**\n     * Helper method to commit a transaction.\n     *\/",445],["T_WHITESPACE","\n    ",447],["T_PRIVATE","private",448],["T_WHITESPACE"," ",448],["T_FUNCTION","function",448],["T_WHITESPACE"," ",448],["T_STRING","commit",448],"(",")",["T_WHITESPACE","\n    ",448],"{",["T_WHITESPACE","\n        ",449],["T_IF","if",450],["T_WHITESPACE"," ",450],"(",["T_VARIABLE","$this",450],["T_OBJECT_OPERATOR","->",450],["T_STRING","inTransaction",450],")",["T_WHITESPACE"," ",450],"{",["T_WHITESPACE","\n            ",450],["T_TRY","try",451],["T_WHITESPACE"," ",451],"{",["T_WHITESPACE","\n                ",451],["T_COMMENT","\/\/ commit read-write transaction which also releases the lock\n",452],["T_WHITESPACE","                ",453],["T_IF","if",453],["T_WHITESPACE"," ",453],"(",["T_CONSTANT_ENCAPSED_STRING","'sqlite'",453],["T_WHITESPACE"," ",453],["T_IS_IDENTICAL","===",453],["T_WHITESPACE"," ",453],["T_VARIABLE","$this",453],["T_OBJECT_OPERATOR","->",453],["T_STRING","driver",453],")",["T_WHITESPACE"," ",453],"{",["T_WHITESPACE","\n                    ",453],["T_VARIABLE","$this",454],["T_OBJECT_OPERATOR","->",454],["T_STRING","pdo",454],["T_OBJECT_OPERATOR","->",454],["T_STRING","exec",454],"(",["T_CONSTANT_ENCAPSED_STRING","'COMMIT'",454],")",";",["T_WHITESPACE","\n                ",454],"}",["T_WHITESPACE"," ",455],["T_ELSE","else",455],["T_WHITESPACE"," ",455],"{",["T_WHITESPACE","\n                    ",455],["T_VARIABLE","$this",456],["T_OBJECT_OPERATOR","->",456],["T_STRING","pdo",456],["T_OBJECT_OPERATOR","->",456],["T_STRING","commit",456],"(",")",";",["T_WHITESPACE","\n                ",456],"}",["T_WHITESPACE","\n                ",457],["T_VARIABLE","$this",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","inTransaction",458],["T_WHITESPACE"," ",458],"=",["T_WHITESPACE"," ",458],["T_STRING","false",458],";",["T_WHITESPACE","\n            ",458],"}",["T_WHITESPACE"," ",459],["T_CATCH","catch",459],["T_WHITESPACE"," ",459],"(",["T_NS_SEPARATOR","\\",459],["T_STRING","PDOException",459],["T_WHITESPACE"," ",459],["T_VARIABLE","$e",459],")",["T_WHITESPACE"," ",459],"{",["T_WHITESPACE","\n                ",459],["T_VARIABLE","$this",460],["T_OBJECT_OPERATOR","->",460],["T_STRING","rollback",460],"(",")",";",["T_WHITESPACE","\n\n                ",460],["T_THROW","throw",462],["T_WHITESPACE"," ",462],["T_VARIABLE","$e",462],";",["T_WHITESPACE","\n            ",462],"}",["T_WHITESPACE","\n        ",463],"}",["T_WHITESPACE","\n    ",464],"}",["T_WHITESPACE","\n\n    ",465],["T_DOC_COMMENT","\/**\n     * Helper method to rollback a transaction.\n     *\/",467],["T_WHITESPACE","\n    ",469],["T_PRIVATE","private",470],["T_WHITESPACE"," ",470],["T_FUNCTION","function",470],["T_WHITESPACE"," ",470],["T_STRING","rollback",470],"(",")",["T_WHITESPACE","\n    ",470],"{",["T_WHITESPACE","\n        ",471],["T_COMMENT","\/\/ We only need to rollback if we are in a transaction. Otherwise the resulting\n",472],["T_WHITESPACE","        ",473],["T_COMMENT","\/\/ error would hide the real problem why rollback was called. We might not be\n",473],["T_WHITESPACE","        ",474],["T_COMMENT","\/\/ in a transaction when not using the transactional locking behavior or when\n",474],["T_WHITESPACE","        ",475],["T_COMMENT","\/\/ two callbacks (e.g. destroy and write) are invoked that both fail.\n",475],["T_WHITESPACE","        ",476],["T_IF","if",476],["T_WHITESPACE"," ",476],"(",["T_VARIABLE","$this",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","inTransaction",476],")",["T_WHITESPACE"," ",476],"{",["T_WHITESPACE","\n            ",476],["T_IF","if",477],["T_WHITESPACE"," ",477],"(",["T_CONSTANT_ENCAPSED_STRING","'sqlite'",477],["T_WHITESPACE"," ",477],["T_IS_IDENTICAL","===",477],["T_WHITESPACE"," ",477],["T_VARIABLE","$this",477],["T_OBJECT_OPERATOR","->",477],["T_STRING","driver",477],")",["T_WHITESPACE"," ",477],"{",["T_WHITESPACE","\n                ",477],["T_VARIABLE","$this",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","pdo",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","exec",478],"(",["T_CONSTANT_ENCAPSED_STRING","'ROLLBACK'",478],")",";",["T_WHITESPACE","\n            ",478],"}",["T_WHITESPACE"," ",479],["T_ELSE","else",479],["T_WHITESPACE"," ",479],"{",["T_WHITESPACE","\n                ",479],["T_VARIABLE","$this",480],["T_OBJECT_OPERATOR","->",480],["T_STRING","pdo",480],["T_OBJECT_OPERATOR","->",480],["T_STRING","rollBack",480],"(",")",";",["T_WHITESPACE","\n            ",480],"}",["T_WHITESPACE","\n            ",481],["T_VARIABLE","$this",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","inTransaction",482],["T_WHITESPACE"," ",482],"=",["T_WHITESPACE"," ",482],["T_STRING","false",482],";",["T_WHITESPACE","\n        ",482],"}",["T_WHITESPACE","\n    ",483],"}",["T_WHITESPACE","\n\n    ",484],["T_DOC_COMMENT","\/**\n     * Reads the session data in respect to the different locking strategies.\n     *\n     * We need to make sure we do not return session data that is already considered garbage according\n     * to the session.gc_maxlifetime setting because gc() is called after read() and only sometimes.\n     *\n     * @param string $sessionId Session ID\n     *\n     * @return string The session data\n     *\/",486],["T_WHITESPACE","\n    ",495],["T_PRIVATE","private",496],["T_WHITESPACE"," ",496],["T_FUNCTION","function",496],["T_WHITESPACE"," ",496],["T_STRING","doRead",496],"(",["T_VARIABLE","$sessionId",496],")",["T_WHITESPACE","\n    ",496],"{",["T_WHITESPACE","\n        ",497],["T_VARIABLE","$this",498],["T_OBJECT_OPERATOR","->",498],["T_STRING","sessionExpired",498],["T_WHITESPACE"," ",498],"=",["T_WHITESPACE"," ",498],["T_STRING","false",498],";",["T_WHITESPACE","\n\n        ",498],["T_IF","if",500],["T_WHITESPACE"," ",500],"(",["T_STRING","self",500],["T_DOUBLE_COLON","::",500],["T_STRING","LOCK_ADVISORY",500],["T_WHITESPACE"," ",500],["T_IS_IDENTICAL","===",500],["T_WHITESPACE"," ",500],["T_VARIABLE","$this",500],["T_OBJECT_OPERATOR","->",500],["T_STRING","lockMode",500],")",["T_WHITESPACE"," ",500],"{",["T_WHITESPACE","\n            ",500],["T_VARIABLE","$this",501],["T_OBJECT_OPERATOR","->",501],["T_STRING","unlockStatements",501],"[","]",["T_WHITESPACE"," ",501],"=",["T_WHITESPACE"," ",501],["T_VARIABLE","$this",501],["T_OBJECT_OPERATOR","->",501],["T_STRING","doAdvisoryLock",501],"(",["T_VARIABLE","$sessionId",501],")",";",["T_WHITESPACE","\n        ",501],"}",["T_WHITESPACE","\n\n        ",502],["T_VARIABLE","$selectSql",504],["T_WHITESPACE"," ",504],"=",["T_WHITESPACE"," ",504],["T_VARIABLE","$this",504],["T_OBJECT_OPERATOR","->",504],["T_STRING","getSelectSql",504],"(",")",";",["T_WHITESPACE","\n        ",504],["T_VARIABLE","$selectStmt",505],["T_WHITESPACE"," ",505],"=",["T_WHITESPACE"," ",505],["T_VARIABLE","$this",505],["T_OBJECT_OPERATOR","->",505],["T_STRING","pdo",505],["T_OBJECT_OPERATOR","->",505],["T_STRING","prepare",505],"(",["T_VARIABLE","$selectSql",505],")",";",["T_WHITESPACE","\n        ",505],["T_VARIABLE","$selectStmt",506],["T_OBJECT_OPERATOR","->",506],["T_STRING","bindParam",506],"(",["T_CONSTANT_ENCAPSED_STRING","':id'",506],",",["T_WHITESPACE"," ",506],["T_VARIABLE","$sessionId",506],",",["T_WHITESPACE"," ",506],["T_NS_SEPARATOR","\\",506],["T_STRING","PDO",506],["T_DOUBLE_COLON","::",506],["T_STRING","PARAM_STR",506],")",";",["T_WHITESPACE","\n\n        ",506],["T_DO","do",508],["T_WHITESPACE"," ",508],"{",["T_WHITESPACE","\n            ",508],["T_VARIABLE","$selectStmt",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","execute",509],"(",")",";",["T_WHITESPACE","\n            ",509],["T_VARIABLE","$sessionRows",510],["T_WHITESPACE"," ",510],"=",["T_WHITESPACE"," ",510],["T_VARIABLE","$selectStmt",510],["T_OBJECT_OPERATOR","->",510],["T_STRING","fetchAll",510],"(",["T_NS_SEPARATOR","\\",510],["T_STRING","PDO",510],["T_DOUBLE_COLON","::",510],["T_STRING","FETCH_NUM",510],")",";",["T_WHITESPACE","\n\n            ",510],["T_IF","if",512],["T_WHITESPACE"," ",512],"(",["T_VARIABLE","$sessionRows",512],")",["T_WHITESPACE"," ",512],"{",["T_WHITESPACE","\n                ",512],["T_IF","if",513],["T_WHITESPACE"," ",513],"(",["T_VARIABLE","$sessionRows",513],"[",["T_LNUMBER","0",513],"]","[",["T_LNUMBER","1",513],"]",["T_WHITESPACE"," ",513],"+",["T_WHITESPACE"," ",513],["T_VARIABLE","$sessionRows",513],"[",["T_LNUMBER","0",513],"]","[",["T_LNUMBER","2",513],"]",["T_WHITESPACE"," ",513],"<",["T_WHITESPACE"," ",513],["T_STRING","time",513],"(",")",")",["T_WHITESPACE"," ",513],"{",["T_WHITESPACE","\n                    ",513],["T_VARIABLE","$this",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","sessionExpired",514],["T_WHITESPACE"," ",514],"=",["T_WHITESPACE"," ",514],["T_STRING","true",514],";",["T_WHITESPACE","\n\n                    ",514],["T_RETURN","return",516],["T_WHITESPACE"," ",516],["T_CONSTANT_ENCAPSED_STRING","''",516],";",["T_WHITESPACE","\n                ",516],"}",["T_WHITESPACE","\n\n                ",517],["T_RETURN","return",519],["T_WHITESPACE"," ",519],["T_STRING","is_resource",519],"(",["T_VARIABLE","$sessionRows",519],"[",["T_LNUMBER","0",519],"]","[",["T_LNUMBER","0",519],"]",")",["T_WHITESPACE"," ",519],"?",["T_WHITESPACE"," ",519],["T_STRING","stream_get_contents",519],"(",["T_VARIABLE","$sessionRows",519],"[",["T_LNUMBER","0",519],"]","[",["T_LNUMBER","0",519],"]",")",["T_WHITESPACE"," ",519],":",["T_WHITESPACE"," ",519],["T_VARIABLE","$sessionRows",519],"[",["T_LNUMBER","0",519],"]","[",["T_LNUMBER","0",519],"]",";",["T_WHITESPACE","\n            ",519],"}",["T_WHITESPACE","\n\n            ",520],["T_IF","if",522],["T_WHITESPACE"," ",522],"(",["T_STRING","self",522],["T_DOUBLE_COLON","::",522],["T_STRING","LOCK_TRANSACTIONAL",522],["T_WHITESPACE"," ",522],["T_IS_IDENTICAL","===",522],["T_WHITESPACE"," ",522],["T_VARIABLE","$this",522],["T_OBJECT_OPERATOR","->",522],["T_STRING","lockMode",522],["T_WHITESPACE"," ",522],["T_BOOLEAN_AND","&&",522],["T_WHITESPACE"," ",522],["T_CONSTANT_ENCAPSED_STRING","'sqlite'",522],["T_WHITESPACE"," ",522],["T_IS_NOT_IDENTICAL","!==",522],["T_WHITESPACE"," ",522],["T_VARIABLE","$this",522],["T_OBJECT_OPERATOR","->",522],["T_STRING","driver",522],")",["T_WHITESPACE"," ",522],"{",["T_WHITESPACE","\n                ",522],["T_COMMENT","\/\/ Exclusive-reading of non-existent rows does not block, so we need to do an insert to block\n",523],["T_WHITESPACE","                ",524],["T_COMMENT","\/\/ until other connections to the session are committed.\n",524],["T_WHITESPACE","                ",525],["T_TRY","try",525],["T_WHITESPACE"," ",525],"{",["T_WHITESPACE","\n                    ",525],["T_VARIABLE","$insertStmt",526],["T_WHITESPACE"," ",526],"=",["T_WHITESPACE"," ",526],["T_VARIABLE","$this",526],["T_OBJECT_OPERATOR","->",526],["T_STRING","pdo",526],["T_OBJECT_OPERATOR","->",526],["T_STRING","prepare",526],"(",["T_WHITESPACE","\n                        ",526],"\"",["T_ENCAPSED_AND_WHITESPACE","INSERT INTO ",527],["T_VARIABLE","$this",527],["T_OBJECT_OPERATOR","->",527],["T_STRING","table",527],["T_ENCAPSED_AND_WHITESPACE"," (",527],["T_VARIABLE","$this",527],["T_OBJECT_OPERATOR","->",527],["T_STRING","idCol",527],["T_ENCAPSED_AND_WHITESPACE",", ",527],["T_VARIABLE","$this",527],["T_OBJECT_OPERATOR","->",527],["T_STRING","dataCol",527],["T_ENCAPSED_AND_WHITESPACE",", ",527],["T_VARIABLE","$this",527],["T_OBJECT_OPERATOR","->",527],["T_STRING","lifetimeCol",527],["T_ENCAPSED_AND_WHITESPACE",", ",527],["T_VARIABLE","$this",527],["T_OBJECT_OPERATOR","->",527],["T_STRING","timeCol",527],["T_ENCAPSED_AND_WHITESPACE",") VALUES (:id, :data, :lifetime, :time)",527],"\"",["T_WHITESPACE","\n                    ",527],")",";",["T_WHITESPACE","\n                    ",528],["T_VARIABLE","$insertStmt",529],["T_OBJECT_OPERATOR","->",529],["T_STRING","bindParam",529],"(",["T_CONSTANT_ENCAPSED_STRING","':id'",529],",",["T_WHITESPACE"," ",529],["T_VARIABLE","$sessionId",529],",",["T_WHITESPACE"," ",529],["T_NS_SEPARATOR","\\",529],["T_STRING","PDO",529],["T_DOUBLE_COLON","::",529],["T_STRING","PARAM_STR",529],")",";",["T_WHITESPACE","\n                    ",529],["T_VARIABLE","$insertStmt",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","bindValue",530],"(",["T_CONSTANT_ENCAPSED_STRING","':data'",530],",",["T_WHITESPACE"," ",530],["T_CONSTANT_ENCAPSED_STRING","''",530],",",["T_WHITESPACE"," ",530],["T_NS_SEPARATOR","\\",530],["T_STRING","PDO",530],["T_DOUBLE_COLON","::",530],["T_STRING","PARAM_LOB",530],")",";",["T_WHITESPACE","\n                    ",530],["T_VARIABLE","$insertStmt",531],["T_OBJECT_OPERATOR","->",531],["T_STRING","bindValue",531],"(",["T_CONSTANT_ENCAPSED_STRING","':lifetime'",531],",",["T_WHITESPACE"," ",531],["T_LNUMBER","0",531],",",["T_WHITESPACE"," ",531],["T_NS_SEPARATOR","\\",531],["T_STRING","PDO",531],["T_DOUBLE_COLON","::",531],["T_STRING","PARAM_INT",531],")",";",["T_WHITESPACE","\n                    ",531],["T_VARIABLE","$insertStmt",532],["T_OBJECT_OPERATOR","->",532],["T_STRING","bindValue",532],"(",["T_CONSTANT_ENCAPSED_STRING","':time'",532],",",["T_WHITESPACE"," ",532],["T_STRING","time",532],"(",")",",",["T_WHITESPACE"," ",532],["T_NS_SEPARATOR","\\",532],["T_STRING","PDO",532],["T_DOUBLE_COLON","::",532],["T_STRING","PARAM_INT",532],")",";",["T_WHITESPACE","\n                    ",532],["T_VARIABLE","$insertStmt",533],["T_OBJECT_OPERATOR","->",533],["T_STRING","execute",533],"(",")",";",["T_WHITESPACE","\n                ",533],"}",["T_WHITESPACE"," ",534],["T_CATCH","catch",534],["T_WHITESPACE"," ",534],"(",["T_NS_SEPARATOR","\\",534],["T_STRING","PDOException",534],["T_WHITESPACE"," ",534],["T_VARIABLE","$e",534],")",["T_WHITESPACE"," ",534],"{",["T_WHITESPACE","\n                    ",534],["T_COMMENT","\/\/ Catch duplicate key error because other connection created the session already.\n",535],["T_WHITESPACE","                    ",536],["T_COMMENT","\/\/ It would only not be the case when the other connection destroyed the session.\n",536],["T_WHITESPACE","                    ",537],["T_IF","if",537],["T_WHITESPACE"," ",537],"(",["T_LNUMBER","0",537],["T_WHITESPACE"," ",537],["T_IS_IDENTICAL","===",537],["T_WHITESPACE"," ",537],["T_STRING","strpos",537],"(",["T_VARIABLE","$e",537],["T_OBJECT_OPERATOR","->",537],["T_STRING","getCode",537],"(",")",",",["T_WHITESPACE"," ",537],["T_CONSTANT_ENCAPSED_STRING","'23'",537],")",")",["T_WHITESPACE"," ",537],"{",["T_WHITESPACE","\n                        ",537],["T_COMMENT","\/\/ Retrieve finished session data written by concurrent connection by restarting the loop.\n",538],["T_WHITESPACE","                        ",539],["T_COMMENT","\/\/ We have to start a new transaction as a failed query will mark the current transaction as\n",539],["T_WHITESPACE","                        ",540],["T_COMMENT","\/\/ aborted in PostgreSQL and disallow further queries within it.\n",540],["T_WHITESPACE","                        ",541],["T_VARIABLE","$this",541],["T_OBJECT_OPERATOR","->",541],["T_STRING","rollback",541],"(",")",";",["T_WHITESPACE","\n                        ",541],["T_VARIABLE","$this",542],["T_OBJECT_OPERATOR","->",542],["T_STRING","beginTransaction",542],"(",")",";",["T_WHITESPACE","\n                        ",542],["T_CONTINUE","continue",543],";",["T_WHITESPACE","\n                    ",543],"}",["T_WHITESPACE","\n\n                    ",544],["T_THROW","throw",546],["T_WHITESPACE"," ",546],["T_VARIABLE","$e",546],";",["T_WHITESPACE","\n                ",546],"}",["T_WHITESPACE","\n            ",547],"}",["T_WHITESPACE","\n\n            ",548],["T_RETURN","return",550],["T_WHITESPACE"," ",550],["T_CONSTANT_ENCAPSED_STRING","''",550],";",["T_WHITESPACE","\n        ",550],"}",["T_WHITESPACE"," ",551],["T_WHILE","while",551],["T_WHITESPACE"," ",551],"(",["T_STRING","true",551],")",";",["T_WHITESPACE","\n    ",551],"}",["T_WHITESPACE","\n\n    ",552],["T_DOC_COMMENT","\/**\n     * Executes an application-level lock on the database.\n     *\n     * @param string $sessionId Session ID\n     *\n     * @return \\PDOStatement The statement that needs to be executed later to release the lock\n     *\n     * @throws \\DomainException When an unsupported PDO driver is used\n     *\n     * @todo implement missing advisory locks\n     *       - for oci using DBMS_LOCK.REQUEST\n     *       - for sqlsrv using sp_getapplock with LockOwner = Session\n     *\/",554],["T_WHITESPACE","\n    ",566],["T_PRIVATE","private",567],["T_WHITESPACE"," ",567],["T_FUNCTION","function",567],["T_WHITESPACE"," ",567],["T_STRING","doAdvisoryLock",567],"(",["T_VARIABLE","$sessionId",567],")",["T_WHITESPACE","\n    ",567],"{",["T_WHITESPACE","\n        ",568],["T_SWITCH","switch",569],["T_WHITESPACE"," ",569],"(",["T_VARIABLE","$this",569],["T_OBJECT_OPERATOR","->",569],["T_STRING","driver",569],")",["T_WHITESPACE"," ",569],"{",["T_WHITESPACE","\n            ",569],["T_CASE","case",570],["T_WHITESPACE"," ",570],["T_CONSTANT_ENCAPSED_STRING","'mysql'",570],":",["T_WHITESPACE","\n                ",570],["T_COMMENT","\/\/ should we handle the return value? 0 on timeout, null on error\n",571],["T_WHITESPACE","                ",572],["T_COMMENT","\/\/ we use a timeout of 50 seconds which is also the default for innodb_lock_wait_timeout\n",572],["T_WHITESPACE","                ",573],["T_VARIABLE","$stmt",573],["T_WHITESPACE"," ",573],"=",["T_WHITESPACE"," ",573],["T_VARIABLE","$this",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","pdo",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","prepare",573],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT GET_LOCK(:key, 50)'",573],")",";",["T_WHITESPACE","\n                ",573],["T_VARIABLE","$stmt",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","bindValue",574],"(",["T_CONSTANT_ENCAPSED_STRING","':key'",574],",",["T_WHITESPACE"," ",574],["T_VARIABLE","$sessionId",574],",",["T_WHITESPACE"," ",574],["T_NS_SEPARATOR","\\",574],["T_STRING","PDO",574],["T_DOUBLE_COLON","::",574],["T_STRING","PARAM_STR",574],")",";",["T_WHITESPACE","\n                ",574],["T_VARIABLE","$stmt",575],["T_OBJECT_OPERATOR","->",575],["T_STRING","execute",575],"(",")",";",["T_WHITESPACE","\n\n                ",575],["T_VARIABLE","$releaseStmt",577],["T_WHITESPACE"," ",577],"=",["T_WHITESPACE"," ",577],["T_VARIABLE","$this",577],["T_OBJECT_OPERATOR","->",577],["T_STRING","pdo",577],["T_OBJECT_OPERATOR","->",577],["T_STRING","prepare",577],"(",["T_CONSTANT_ENCAPSED_STRING","'DO RELEASE_LOCK(:key)'",577],")",";",["T_WHITESPACE","\n                ",577],["T_VARIABLE","$releaseStmt",578],["T_OBJECT_OPERATOR","->",578],["T_STRING","bindValue",578],"(",["T_CONSTANT_ENCAPSED_STRING","':key'",578],",",["T_WHITESPACE"," ",578],["T_VARIABLE","$sessionId",578],",",["T_WHITESPACE"," ",578],["T_NS_SEPARATOR","\\",578],["T_STRING","PDO",578],["T_DOUBLE_COLON","::",578],["T_STRING","PARAM_STR",578],")",";",["T_WHITESPACE","\n\n                ",578],["T_RETURN","return",580],["T_WHITESPACE"," ",580],["T_VARIABLE","$releaseStmt",580],";",["T_WHITESPACE","\n            ",580],["T_CASE","case",581],["T_WHITESPACE"," ",581],["T_CONSTANT_ENCAPSED_STRING","'pgsql'",581],":",["T_WHITESPACE","\n                ",581],["T_COMMENT","\/\/ Obtaining an exclusive session level advisory lock requires an integer key.\n",582],["T_WHITESPACE","                ",583],["T_COMMENT","\/\/ So we convert the HEX representation of the session id to an integer.\n",583],["T_WHITESPACE","                ",584],["T_COMMENT","\/\/ Since integers are signed, we have to skip one hex char to fit in the range.\n",584],["T_WHITESPACE","                ",585],["T_IF","if",585],["T_WHITESPACE"," ",585],"(",["T_LNUMBER","4",585],["T_WHITESPACE"," ",585],["T_IS_IDENTICAL","===",585],["T_WHITESPACE"," ",585],["T_STRING","PHP_INT_SIZE",585],")",["T_WHITESPACE"," ",585],"{",["T_WHITESPACE","\n                    ",585],["T_VARIABLE","$sessionInt1",586],["T_WHITESPACE"," ",586],"=",["T_WHITESPACE"," ",586],["T_STRING","hexdec",586],"(",["T_STRING","substr",586],"(",["T_VARIABLE","$sessionId",586],",",["T_WHITESPACE"," ",586],["T_LNUMBER","0",586],",",["T_WHITESPACE"," ",586],["T_LNUMBER","7",586],")",")",";",["T_WHITESPACE","\n                    ",586],["T_VARIABLE","$sessionInt2",587],["T_WHITESPACE"," ",587],"=",["T_WHITESPACE"," ",587],["T_STRING","hexdec",587],"(",["T_STRING","substr",587],"(",["T_VARIABLE","$sessionId",587],",",["T_WHITESPACE"," ",587],["T_LNUMBER","7",587],",",["T_WHITESPACE"," ",587],["T_LNUMBER","7",587],")",")",";",["T_WHITESPACE","\n\n                    ",587],["T_VARIABLE","$stmt",589],["T_WHITESPACE"," ",589],"=",["T_WHITESPACE"," ",589],["T_VARIABLE","$this",589],["T_OBJECT_OPERATOR","->",589],["T_STRING","pdo",589],["T_OBJECT_OPERATOR","->",589],["T_STRING","prepare",589],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT pg_advisory_lock(:key1, :key2)'",589],")",";",["T_WHITESPACE","\n                    ",589],["T_VARIABLE","$stmt",590],["T_OBJECT_OPERATOR","->",590],["T_STRING","bindValue",590],"(",["T_CONSTANT_ENCAPSED_STRING","':key1'",590],",",["T_WHITESPACE"," ",590],["T_VARIABLE","$sessionInt1",590],",",["T_WHITESPACE"," ",590],["T_NS_SEPARATOR","\\",590],["T_STRING","PDO",590],["T_DOUBLE_COLON","::",590],["T_STRING","PARAM_INT",590],")",";",["T_WHITESPACE","\n                    ",590],["T_VARIABLE","$stmt",591],["T_OBJECT_OPERATOR","->",591],["T_STRING","bindValue",591],"(",["T_CONSTANT_ENCAPSED_STRING","':key2'",591],",",["T_WHITESPACE"," ",591],["T_VARIABLE","$sessionInt2",591],",",["T_WHITESPACE"," ",591],["T_NS_SEPARATOR","\\",591],["T_STRING","PDO",591],["T_DOUBLE_COLON","::",591],["T_STRING","PARAM_INT",591],")",";",["T_WHITESPACE","\n                    ",591],["T_VARIABLE","$stmt",592],["T_OBJECT_OPERATOR","->",592],["T_STRING","execute",592],"(",")",";",["T_WHITESPACE","\n\n                    ",592],["T_VARIABLE","$releaseStmt",594],["T_WHITESPACE"," ",594],"=",["T_WHITESPACE"," ",594],["T_VARIABLE","$this",594],["T_OBJECT_OPERATOR","->",594],["T_STRING","pdo",594],["T_OBJECT_OPERATOR","->",594],["T_STRING","prepare",594],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT pg_advisory_unlock(:key1, :key2)'",594],")",";",["T_WHITESPACE","\n                    ",594],["T_VARIABLE","$releaseStmt",595],["T_OBJECT_OPERATOR","->",595],["T_STRING","bindValue",595],"(",["T_CONSTANT_ENCAPSED_STRING","':key1'",595],",",["T_WHITESPACE"," ",595],["T_VARIABLE","$sessionInt1",595],",",["T_WHITESPACE"," ",595],["T_NS_SEPARATOR","\\",595],["T_STRING","PDO",595],["T_DOUBLE_COLON","::",595],["T_STRING","PARAM_INT",595],")",";",["T_WHITESPACE","\n                    ",595],["T_VARIABLE","$releaseStmt",596],["T_OBJECT_OPERATOR","->",596],["T_STRING","bindValue",596],"(",["T_CONSTANT_ENCAPSED_STRING","':key2'",596],",",["T_WHITESPACE"," ",596],["T_VARIABLE","$sessionInt2",596],",",["T_WHITESPACE"," ",596],["T_NS_SEPARATOR","\\",596],["T_STRING","PDO",596],["T_DOUBLE_COLON","::",596],["T_STRING","PARAM_INT",596],")",";",["T_WHITESPACE","\n                ",596],"}",["T_WHITESPACE"," ",597],["T_ELSE","else",597],["T_WHITESPACE"," ",597],"{",["T_WHITESPACE","\n                    ",597],["T_VARIABLE","$sessionBigInt",598],["T_WHITESPACE"," ",598],"=",["T_WHITESPACE"," ",598],["T_STRING","hexdec",598],"(",["T_STRING","substr",598],"(",["T_VARIABLE","$sessionId",598],",",["T_WHITESPACE"," ",598],["T_LNUMBER","0",598],",",["T_WHITESPACE"," ",598],["T_LNUMBER","15",598],")",")",";",["T_WHITESPACE","\n\n                    ",598],["T_VARIABLE","$stmt",600],["T_WHITESPACE"," ",600],"=",["T_WHITESPACE"," ",600],["T_VARIABLE","$this",600],["T_OBJECT_OPERATOR","->",600],["T_STRING","pdo",600],["T_OBJECT_OPERATOR","->",600],["T_STRING","prepare",600],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT pg_advisory_lock(:key)'",600],")",";",["T_WHITESPACE","\n                    ",600],["T_VARIABLE","$stmt",601],["T_OBJECT_OPERATOR","->",601],["T_STRING","bindValue",601],"(",["T_CONSTANT_ENCAPSED_STRING","':key'",601],",",["T_WHITESPACE"," ",601],["T_VARIABLE","$sessionBigInt",601],",",["T_WHITESPACE"," ",601],["T_NS_SEPARATOR","\\",601],["T_STRING","PDO",601],["T_DOUBLE_COLON","::",601],["T_STRING","PARAM_INT",601],")",";",["T_WHITESPACE","\n                    ",601],["T_VARIABLE","$stmt",602],["T_OBJECT_OPERATOR","->",602],["T_STRING","execute",602],"(",")",";",["T_WHITESPACE","\n\n                    ",602],["T_VARIABLE","$releaseStmt",604],["T_WHITESPACE"," ",604],"=",["T_WHITESPACE"," ",604],["T_VARIABLE","$this",604],["T_OBJECT_OPERATOR","->",604],["T_STRING","pdo",604],["T_OBJECT_OPERATOR","->",604],["T_STRING","prepare",604],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT pg_advisory_unlock(:key)'",604],")",";",["T_WHITESPACE","\n                    ",604],["T_VARIABLE","$releaseStmt",605],["T_OBJECT_OPERATOR","->",605],["T_STRING","bindValue",605],"(",["T_CONSTANT_ENCAPSED_STRING","':key'",605],",",["T_WHITESPACE"," ",605],["T_VARIABLE","$sessionBigInt",605],",",["T_WHITESPACE"," ",605],["T_NS_SEPARATOR","\\",605],["T_STRING","PDO",605],["T_DOUBLE_COLON","::",605],["T_STRING","PARAM_INT",605],")",";",["T_WHITESPACE","\n                ",605],"}",["T_WHITESPACE","\n\n                ",606],["T_RETURN","return",608],["T_WHITESPACE"," ",608],["T_VARIABLE","$releaseStmt",608],";",["T_WHITESPACE","\n            ",608],["T_CASE","case",609],["T_WHITESPACE"," ",609],["T_CONSTANT_ENCAPSED_STRING","'sqlite'",609],":",["T_WHITESPACE","\n                ",609],["T_THROW","throw",610],["T_WHITESPACE"," ",610],["T_NEW","new",610],["T_WHITESPACE"," ",610],["T_NS_SEPARATOR","\\",610],["T_STRING","DomainException",610],"(",["T_CONSTANT_ENCAPSED_STRING","'SQLite does not support advisory locks.'",610],")",";",["T_WHITESPACE","\n            ",610],["T_DEFAULT","default",611],":",["T_WHITESPACE","\n                ",611],["T_THROW","throw",612],["T_WHITESPACE"," ",612],["T_NEW","new",612],["T_WHITESPACE"," ",612],["T_NS_SEPARATOR","\\",612],["T_STRING","DomainException",612],"(",["T_STRING","sprintf",612],"(",["T_CONSTANT_ENCAPSED_STRING","'Advisory locks are currently not implemented for PDO driver \"%s\".'",612],",",["T_WHITESPACE"," ",612],["T_VARIABLE","$this",612],["T_OBJECT_OPERATOR","->",612],["T_STRING","driver",612],")",")",";",["T_WHITESPACE","\n        ",612],"}",["T_WHITESPACE","\n    ",613],"}",["T_WHITESPACE","\n\n    ",614],["T_DOC_COMMENT","\/**\n     * Return a locking or nonlocking SQL query to read session information.\n     *\n     * @return string The SQL string\n     *\n     * @throws \\DomainException When an unsupported PDO driver is used\n     *\/",616],["T_WHITESPACE","\n    ",622],["T_PRIVATE","private",623],["T_WHITESPACE"," ",623],["T_FUNCTION","function",623],["T_WHITESPACE"," ",623],["T_STRING","getSelectSql",623],"(",")",["T_WHITESPACE","\n    ",623],"{",["T_WHITESPACE","\n        ",624],["T_IF","if",625],["T_WHITESPACE"," ",625],"(",["T_STRING","self",625],["T_DOUBLE_COLON","::",625],["T_STRING","LOCK_TRANSACTIONAL",625],["T_WHITESPACE"," ",625],["T_IS_IDENTICAL","===",625],["T_WHITESPACE"," ",625],["T_VARIABLE","$this",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","lockMode",625],")",["T_WHITESPACE"," ",625],"{",["T_WHITESPACE","\n            ",625],["T_VARIABLE","$this",626],["T_OBJECT_OPERATOR","->",626],["T_STRING","beginTransaction",626],"(",")",";",["T_WHITESPACE","\n\n            ",626],["T_SWITCH","switch",628],["T_WHITESPACE"," ",628],"(",["T_VARIABLE","$this",628],["T_OBJECT_OPERATOR","->",628],["T_STRING","driver",628],")",["T_WHITESPACE"," ",628],"{",["T_WHITESPACE","\n                ",628],["T_CASE","case",629],["T_WHITESPACE"," ",629],["T_CONSTANT_ENCAPSED_STRING","'mysql'",629],":",["T_WHITESPACE","\n                ",629],["T_CASE","case",630],["T_WHITESPACE"," ",630],["T_CONSTANT_ENCAPSED_STRING","'oci'",630],":",["T_WHITESPACE","\n                ",630],["T_CASE","case",631],["T_WHITESPACE"," ",631],["T_CONSTANT_ENCAPSED_STRING","'pgsql'",631],":",["T_WHITESPACE","\n                    ",631],["T_RETURN","return",632],["T_WHITESPACE"," ",632],"\"",["T_ENCAPSED_AND_WHITESPACE","SELECT ",632],["T_VARIABLE","$this",632],["T_OBJECT_OPERATOR","->",632],["T_STRING","dataCol",632],["T_ENCAPSED_AND_WHITESPACE",", ",632],["T_VARIABLE","$this",632],["T_OBJECT_OPERATOR","->",632],["T_STRING","lifetimeCol",632],["T_ENCAPSED_AND_WHITESPACE",", ",632],["T_VARIABLE","$this",632],["T_OBJECT_OPERATOR","->",632],["T_STRING","timeCol",632],["T_ENCAPSED_AND_WHITESPACE"," FROM ",632],["T_VARIABLE","$this",632],["T_OBJECT_OPERATOR","->",632],["T_STRING","table",632],["T_ENCAPSED_AND_WHITESPACE"," WHERE ",632],["T_VARIABLE","$this",632],["T_OBJECT_OPERATOR","->",632],["T_STRING","idCol",632],["T_ENCAPSED_AND_WHITESPACE"," = :id FOR UPDATE",632],"\"",";",["T_WHITESPACE","\n                ",632],["T_CASE","case",633],["T_WHITESPACE"," ",633],["T_CONSTANT_ENCAPSED_STRING","'sqlsrv'",633],":",["T_WHITESPACE","\n                    ",633],["T_RETURN","return",634],["T_WHITESPACE"," ",634],"\"",["T_ENCAPSED_AND_WHITESPACE","SELECT ",634],["T_VARIABLE","$this",634],["T_OBJECT_OPERATOR","->",634],["T_STRING","dataCol",634],["T_ENCAPSED_AND_WHITESPACE",", ",634],["T_VARIABLE","$this",634],["T_OBJECT_OPERATOR","->",634],["T_STRING","lifetimeCol",634],["T_ENCAPSED_AND_WHITESPACE",", ",634],["T_VARIABLE","$this",634],["T_OBJECT_OPERATOR","->",634],["T_STRING","timeCol",634],["T_ENCAPSED_AND_WHITESPACE"," FROM ",634],["T_VARIABLE","$this",634],["T_OBJECT_OPERATOR","->",634],["T_STRING","table",634],["T_ENCAPSED_AND_WHITESPACE"," WITH (UPDLOCK, ROWLOCK) WHERE ",634],["T_VARIABLE","$this",634],["T_OBJECT_OPERATOR","->",634],["T_STRING","idCol",634],["T_ENCAPSED_AND_WHITESPACE"," = :id",634],"\"",";",["T_WHITESPACE","\n                ",634],["T_CASE","case",635],["T_WHITESPACE"," ",635],["T_CONSTANT_ENCAPSED_STRING","'sqlite'",635],":",["T_WHITESPACE","\n                    ",635],["T_COMMENT","\/\/ we already locked when starting transaction\n",636],["T_WHITESPACE","                    ",637],["T_BREAK","break",637],";",["T_WHITESPACE","\n                ",637],["T_DEFAULT","default",638],":",["T_WHITESPACE","\n                    ",638],["T_THROW","throw",639],["T_WHITESPACE"," ",639],["T_NEW","new",639],["T_WHITESPACE"," ",639],["T_NS_SEPARATOR","\\",639],["T_STRING","DomainException",639],"(",["T_STRING","sprintf",639],"(",["T_CONSTANT_ENCAPSED_STRING","'Transactional locks are currently not implemented for PDO driver \"%s\".'",639],",",["T_WHITESPACE"," ",639],["T_VARIABLE","$this",639],["T_OBJECT_OPERATOR","->",639],["T_STRING","driver",639],")",")",";",["T_WHITESPACE","\n            ",639],"}",["T_WHITESPACE","\n        ",640],"}",["T_WHITESPACE","\n\n        ",641],["T_RETURN","return",643],["T_WHITESPACE"," ",643],"\"",["T_ENCAPSED_AND_WHITESPACE","SELECT ",643],["T_VARIABLE","$this",643],["T_OBJECT_OPERATOR","->",643],["T_STRING","dataCol",643],["T_ENCAPSED_AND_WHITESPACE",", ",643],["T_VARIABLE","$this",643],["T_OBJECT_OPERATOR","->",643],["T_STRING","lifetimeCol",643],["T_ENCAPSED_AND_WHITESPACE",", ",643],["T_VARIABLE","$this",643],["T_OBJECT_OPERATOR","->",643],["T_STRING","timeCol",643],["T_ENCAPSED_AND_WHITESPACE"," FROM ",643],["T_VARIABLE","$this",643],["T_OBJECT_OPERATOR","->",643],["T_STRING","table",643],["T_ENCAPSED_AND_WHITESPACE"," WHERE ",643],["T_VARIABLE","$this",643],["T_OBJECT_OPERATOR","->",643],["T_STRING","idCol",643],["T_ENCAPSED_AND_WHITESPACE"," = :id",643],"\"",";",["T_WHITESPACE","\n    ",643],"}",["T_WHITESPACE","\n\n    ",644],["T_DOC_COMMENT","\/**\n     * Returns a merge\/upsert (i.e. insert or update) statement when supported by the database for writing session data.\n     *\n     * @param string $sessionId   Session ID\n     * @param string $data        Encoded session data\n     * @param int    $maxlifetime session.gc_maxlifetime\n     *\n     * @return \\PDOStatement|null The merge statement or null when not supported\n     *\/",646],["T_WHITESPACE","\n    ",654],["T_PRIVATE","private",655],["T_WHITESPACE"," ",655],["T_FUNCTION","function",655],["T_WHITESPACE"," ",655],["T_STRING","getMergeStatement",655],"(",["T_VARIABLE","$sessionId",655],",",["T_WHITESPACE"," ",655],["T_VARIABLE","$data",655],",",["T_WHITESPACE"," ",655],["T_VARIABLE","$maxlifetime",655],")",["T_WHITESPACE","\n    ",655],"{",["T_WHITESPACE","\n        ",656],["T_VARIABLE","$mergeSql",657],["T_WHITESPACE"," ",657],"=",["T_WHITESPACE"," ",657],["T_STRING","null",657],";",["T_WHITESPACE","\n        ",657],["T_SWITCH","switch",658],["T_WHITESPACE"," ",658],"(",["T_STRING","true",658],")",["T_WHITESPACE"," ",658],"{",["T_WHITESPACE","\n            ",658],["T_CASE","case",659],["T_WHITESPACE"," ",659],["T_CONSTANT_ENCAPSED_STRING","'mysql'",659],["T_WHITESPACE"," ",659],["T_IS_IDENTICAL","===",659],["T_WHITESPACE"," ",659],["T_VARIABLE","$this",659],["T_OBJECT_OPERATOR","->",659],["T_STRING","driver",659],":",["T_WHITESPACE","\n                ",659],["T_VARIABLE","$mergeSql",660],["T_WHITESPACE"," ",660],"=",["T_WHITESPACE"," ",660],"\"",["T_ENCAPSED_AND_WHITESPACE","INSERT INTO ",660],["T_VARIABLE","$this",660],["T_OBJECT_OPERATOR","->",660],["T_STRING","table",660],["T_ENCAPSED_AND_WHITESPACE"," (",660],["T_VARIABLE","$this",660],["T_OBJECT_OPERATOR","->",660],["T_STRING","idCol",660],["T_ENCAPSED_AND_WHITESPACE",", ",660],["T_VARIABLE","$this",660],["T_OBJECT_OPERATOR","->",660],["T_STRING","dataCol",660],["T_ENCAPSED_AND_WHITESPACE",", ",660],["T_VARIABLE","$this",660],["T_OBJECT_OPERATOR","->",660],["T_STRING","lifetimeCol",660],["T_ENCAPSED_AND_WHITESPACE",", ",660],["T_VARIABLE","$this",660],["T_OBJECT_OPERATOR","->",660],["T_STRING","timeCol",660],["T_ENCAPSED_AND_WHITESPACE",") VALUES (:id, :data, :lifetime, :time) ",660],"\"",".",["T_WHITESPACE","\n                    ",660],"\"",["T_ENCAPSED_AND_WHITESPACE","ON DUPLICATE KEY UPDATE ",661],["T_VARIABLE","$this",661],["T_OBJECT_OPERATOR","->",661],["T_STRING","dataCol",661],["T_ENCAPSED_AND_WHITESPACE"," = VALUES(",661],["T_VARIABLE","$this",661],["T_OBJECT_OPERATOR","->",661],["T_STRING","dataCol",661],["T_ENCAPSED_AND_WHITESPACE","), ",661],["T_VARIABLE","$this",661],["T_OBJECT_OPERATOR","->",661],["T_STRING","lifetimeCol",661],["T_ENCAPSED_AND_WHITESPACE"," = VALUES(",661],["T_VARIABLE","$this",661],["T_OBJECT_OPERATOR","->",661],["T_STRING","lifetimeCol",661],["T_ENCAPSED_AND_WHITESPACE","), ",661],["T_VARIABLE","$this",661],["T_OBJECT_OPERATOR","->",661],["T_STRING","timeCol",661],["T_ENCAPSED_AND_WHITESPACE"," = VALUES(",661],["T_VARIABLE","$this",661],["T_OBJECT_OPERATOR","->",661],["T_STRING","timeCol",661],["T_ENCAPSED_AND_WHITESPACE",")",661],"\"",";",["T_WHITESPACE","\n                ",661],["T_BREAK","break",662],";",["T_WHITESPACE","\n            ",662],["T_CASE","case",663],["T_WHITESPACE"," ",663],["T_CONSTANT_ENCAPSED_STRING","'oci'",663],["T_WHITESPACE"," ",663],["T_IS_IDENTICAL","===",663],["T_WHITESPACE"," ",663],["T_VARIABLE","$this",663],["T_OBJECT_OPERATOR","->",663],["T_STRING","driver",663],":",["T_WHITESPACE","\n                ",663],["T_COMMENT","\/\/ DUAL is Oracle specific dummy table\n",664],["T_WHITESPACE","                ",665],["T_VARIABLE","$mergeSql",665],["T_WHITESPACE"," ",665],"=",["T_WHITESPACE"," ",665],"\"",["T_ENCAPSED_AND_WHITESPACE","MERGE INTO ",665],["T_VARIABLE","$this",665],["T_OBJECT_OPERATOR","->",665],["T_STRING","table",665],["T_ENCAPSED_AND_WHITESPACE"," USING DUAL ON (",665],["T_VARIABLE","$this",665],["T_OBJECT_OPERATOR","->",665],["T_STRING","idCol",665],["T_ENCAPSED_AND_WHITESPACE"," = ?) ",665],"\"",".",["T_WHITESPACE","\n                    ",665],"\"",["T_ENCAPSED_AND_WHITESPACE","WHEN NOT MATCHED THEN INSERT (",666],["T_VARIABLE","$this",666],["T_OBJECT_OPERATOR","->",666],["T_STRING","idCol",666],["T_ENCAPSED_AND_WHITESPACE",", ",666],["T_VARIABLE","$this",666],["T_OBJECT_OPERATOR","->",666],["T_STRING","dataCol",666],["T_ENCAPSED_AND_WHITESPACE",", ",666],["T_VARIABLE","$this",666],["T_OBJECT_OPERATOR","->",666],["T_STRING","lifetimeCol",666],["T_ENCAPSED_AND_WHITESPACE",", ",666],["T_VARIABLE","$this",666],["T_OBJECT_OPERATOR","->",666],["T_STRING","timeCol",666],["T_ENCAPSED_AND_WHITESPACE",") VALUES (?, ?, ?, ?) ",666],"\"",".",["T_WHITESPACE","\n                    ",666],"\"",["T_ENCAPSED_AND_WHITESPACE","WHEN MATCHED THEN UPDATE SET ",667],["T_VARIABLE","$this",667],["T_OBJECT_OPERATOR","->",667],["T_STRING","dataCol",667],["T_ENCAPSED_AND_WHITESPACE"," = ?, ",667],["T_VARIABLE","$this",667],["T_OBJECT_OPERATOR","->",667],["T_STRING","lifetimeCol",667],["T_ENCAPSED_AND_WHITESPACE"," = ?, ",667],["T_VARIABLE","$this",667],["T_OBJECT_OPERATOR","->",667],["T_STRING","timeCol",667],["T_ENCAPSED_AND_WHITESPACE"," = ?",667],"\"",";",["T_WHITESPACE","\n                ",667],["T_BREAK","break",668],";",["T_WHITESPACE","\n            ",668],["T_CASE","case",669],["T_WHITESPACE"," ",669],["T_CONSTANT_ENCAPSED_STRING","'sqlsrv'",669],["T_WHITESPACE"," ",669],["T_IS_IDENTICAL","===",669],["T_WHITESPACE"," ",669],["T_VARIABLE","$this",669],["T_OBJECT_OPERATOR","->",669],["T_STRING","driver",669],["T_WHITESPACE"," ",669],["T_BOOLEAN_AND","&&",669],["T_WHITESPACE"," ",669],["T_STRING","version_compare",669],"(",["T_VARIABLE","$this",669],["T_OBJECT_OPERATOR","->",669],["T_STRING","pdo",669],["T_OBJECT_OPERATOR","->",669],["T_STRING","getAttribute",669],"(",["T_NS_SEPARATOR","\\",669],["T_STRING","PDO",669],["T_DOUBLE_COLON","::",669],["T_STRING","ATTR_SERVER_VERSION",669],")",",",["T_WHITESPACE"," ",669],["T_CONSTANT_ENCAPSED_STRING","'10'",669],",",["T_WHITESPACE"," ",669],["T_CONSTANT_ENCAPSED_STRING","'>='",669],")",":",["T_WHITESPACE","\n                ",669],["T_COMMENT","\/\/ MERGE is only available since SQL Server 2008 and must be terminated by semicolon\n",670],["T_WHITESPACE","                ",671],["T_COMMENT","\/\/ It also requires HOLDLOCK according to http:\/\/weblogs.sqlteam.com\/dang\/archive\/2009\/01\/31\/UPSERT-Race-Condition-With-MERGE.aspx\n",671],["T_WHITESPACE","                ",672],["T_VARIABLE","$mergeSql",672],["T_WHITESPACE"," ",672],"=",["T_WHITESPACE"," ",672],"\"",["T_ENCAPSED_AND_WHITESPACE","MERGE INTO ",672],["T_VARIABLE","$this",672],["T_OBJECT_OPERATOR","->",672],["T_STRING","table",672],["T_ENCAPSED_AND_WHITESPACE"," WITH (HOLDLOCK) USING (SELECT 1 AS dummy) AS src ON (",672],["T_VARIABLE","$this",672],["T_OBJECT_OPERATOR","->",672],["T_STRING","idCol",672],["T_ENCAPSED_AND_WHITESPACE"," = ?) ",672],"\"",".",["T_WHITESPACE","\n                    ",672],"\"",["T_ENCAPSED_AND_WHITESPACE","WHEN NOT MATCHED THEN INSERT (",673],["T_VARIABLE","$this",673],["T_OBJECT_OPERATOR","->",673],["T_STRING","idCol",673],["T_ENCAPSED_AND_WHITESPACE",", ",673],["T_VARIABLE","$this",673],["T_OBJECT_OPERATOR","->",673],["T_STRING","dataCol",673],["T_ENCAPSED_AND_WHITESPACE",", ",673],["T_VARIABLE","$this",673],["T_OBJECT_OPERATOR","->",673],["T_STRING","lifetimeCol",673],["T_ENCAPSED_AND_WHITESPACE",", ",673],["T_VARIABLE","$this",673],["T_OBJECT_OPERATOR","->",673],["T_STRING","timeCol",673],["T_ENCAPSED_AND_WHITESPACE",") VALUES (?, ?, ?, ?) ",673],"\"",".",["T_WHITESPACE","\n                    ",673],"\"",["T_ENCAPSED_AND_WHITESPACE","WHEN MATCHED THEN UPDATE SET ",674],["T_VARIABLE","$this",674],["T_OBJECT_OPERATOR","->",674],["T_STRING","dataCol",674],["T_ENCAPSED_AND_WHITESPACE"," = ?, ",674],["T_VARIABLE","$this",674],["T_OBJECT_OPERATOR","->",674],["T_STRING","lifetimeCol",674],["T_ENCAPSED_AND_WHITESPACE"," = ?, ",674],["T_VARIABLE","$this",674],["T_OBJECT_OPERATOR","->",674],["T_STRING","timeCol",674],["T_ENCAPSED_AND_WHITESPACE"," = ?;",674],"\"",";",["T_WHITESPACE","\n                ",674],["T_BREAK","break",675],";",["T_WHITESPACE","\n            ",675],["T_CASE","case",676],["T_WHITESPACE"," ",676],["T_CONSTANT_ENCAPSED_STRING","'sqlite'",676],["T_WHITESPACE"," ",676],["T_IS_IDENTICAL","===",676],["T_WHITESPACE"," ",676],["T_VARIABLE","$this",676],["T_OBJECT_OPERATOR","->",676],["T_STRING","driver",676],":",["T_WHITESPACE","\n                ",676],["T_VARIABLE","$mergeSql",677],["T_WHITESPACE"," ",677],"=",["T_WHITESPACE"," ",677],"\"",["T_ENCAPSED_AND_WHITESPACE","INSERT OR REPLACE INTO ",677],["T_VARIABLE","$this",677],["T_OBJECT_OPERATOR","->",677],["T_STRING","table",677],["T_ENCAPSED_AND_WHITESPACE"," (",677],["T_VARIABLE","$this",677],["T_OBJECT_OPERATOR","->",677],["T_STRING","idCol",677],["T_ENCAPSED_AND_WHITESPACE",", ",677],["T_VARIABLE","$this",677],["T_OBJECT_OPERATOR","->",677],["T_STRING","dataCol",677],["T_ENCAPSED_AND_WHITESPACE",", ",677],["T_VARIABLE","$this",677],["T_OBJECT_OPERATOR","->",677],["T_STRING","lifetimeCol",677],["T_ENCAPSED_AND_WHITESPACE",", ",677],["T_VARIABLE","$this",677],["T_OBJECT_OPERATOR","->",677],["T_STRING","timeCol",677],["T_ENCAPSED_AND_WHITESPACE",") VALUES (:id, :data, :lifetime, :time)",677],"\"",";",["T_WHITESPACE","\n                ",677],["T_BREAK","break",678],";",["T_WHITESPACE","\n            ",678],["T_CASE","case",679],["T_WHITESPACE"," ",679],["T_CONSTANT_ENCAPSED_STRING","'pgsql'",679],["T_WHITESPACE"," ",679],["T_IS_IDENTICAL","===",679],["T_WHITESPACE"," ",679],["T_VARIABLE","$this",679],["T_OBJECT_OPERATOR","->",679],["T_STRING","driver",679],["T_WHITESPACE"," ",679],["T_BOOLEAN_AND","&&",679],["T_WHITESPACE"," ",679],["T_STRING","version_compare",679],"(",["T_VARIABLE","$this",679],["T_OBJECT_OPERATOR","->",679],["T_STRING","pdo",679],["T_OBJECT_OPERATOR","->",679],["T_STRING","getAttribute",679],"(",["T_NS_SEPARATOR","\\",679],["T_STRING","PDO",679],["T_DOUBLE_COLON","::",679],["T_STRING","ATTR_SERVER_VERSION",679],")",",",["T_WHITESPACE"," ",679],["T_CONSTANT_ENCAPSED_STRING","'9.5'",679],",",["T_WHITESPACE"," ",679],["T_CONSTANT_ENCAPSED_STRING","'>='",679],")",":",["T_WHITESPACE","\n                ",679],["T_VARIABLE","$mergeSql",680],["T_WHITESPACE"," ",680],"=",["T_WHITESPACE"," ",680],"\"",["T_ENCAPSED_AND_WHITESPACE","INSERT INTO ",680],["T_VARIABLE","$this",680],["T_OBJECT_OPERATOR","->",680],["T_STRING","table",680],["T_ENCAPSED_AND_WHITESPACE"," (",680],["T_VARIABLE","$this",680],["T_OBJECT_OPERATOR","->",680],["T_STRING","idCol",680],["T_ENCAPSED_AND_WHITESPACE",", ",680],["T_VARIABLE","$this",680],["T_OBJECT_OPERATOR","->",680],["T_STRING","dataCol",680],["T_ENCAPSED_AND_WHITESPACE",", ",680],["T_VARIABLE","$this",680],["T_OBJECT_OPERATOR","->",680],["T_STRING","lifetimeCol",680],["T_ENCAPSED_AND_WHITESPACE",", ",680],["T_VARIABLE","$this",680],["T_OBJECT_OPERATOR","->",680],["T_STRING","timeCol",680],["T_ENCAPSED_AND_WHITESPACE",") VALUES (:id, :data, :lifetime, :time) ",680],"\"",".",["T_WHITESPACE","\n                    ",680],"\"",["T_ENCAPSED_AND_WHITESPACE","ON CONFLICT (",681],["T_VARIABLE","$this",681],["T_OBJECT_OPERATOR","->",681],["T_STRING","idCol",681],["T_ENCAPSED_AND_WHITESPACE",") DO UPDATE SET (",681],["T_VARIABLE","$this",681],["T_OBJECT_OPERATOR","->",681],["T_STRING","dataCol",681],["T_ENCAPSED_AND_WHITESPACE",", ",681],["T_VARIABLE","$this",681],["T_OBJECT_OPERATOR","->",681],["T_STRING","lifetimeCol",681],["T_ENCAPSED_AND_WHITESPACE",", ",681],["T_VARIABLE","$this",681],["T_OBJECT_OPERATOR","->",681],["T_STRING","timeCol",681],["T_ENCAPSED_AND_WHITESPACE",") = (EXCLUDED.",681],["T_VARIABLE","$this",681],["T_OBJECT_OPERATOR","->",681],["T_STRING","dataCol",681],["T_ENCAPSED_AND_WHITESPACE",", EXCLUDED.",681],["T_VARIABLE","$this",681],["T_OBJECT_OPERATOR","->",681],["T_STRING","lifetimeCol",681],["T_ENCAPSED_AND_WHITESPACE",", EXCLUDED.",681],["T_VARIABLE","$this",681],["T_OBJECT_OPERATOR","->",681],["T_STRING","timeCol",681],["T_ENCAPSED_AND_WHITESPACE",")",681],"\"",";",["T_WHITESPACE","\n                ",681],["T_BREAK","break",682],";",["T_WHITESPACE","\n        ",682],"}",["T_WHITESPACE","\n\n        ",683],["T_IF","if",685],["T_WHITESPACE"," ",685],"(",["T_STRING","null",685],["T_WHITESPACE"," ",685],["T_IS_NOT_IDENTICAL","!==",685],["T_WHITESPACE"," ",685],["T_VARIABLE","$mergeSql",685],")",["T_WHITESPACE"," ",685],"{",["T_WHITESPACE","\n            ",685],["T_VARIABLE","$mergeStmt",686],["T_WHITESPACE"," ",686],"=",["T_WHITESPACE"," ",686],["T_VARIABLE","$this",686],["T_OBJECT_OPERATOR","->",686],["T_STRING","pdo",686],["T_OBJECT_OPERATOR","->",686],["T_STRING","prepare",686],"(",["T_VARIABLE","$mergeSql",686],")",";",["T_WHITESPACE","\n\n            ",686],["T_IF","if",688],["T_WHITESPACE"," ",688],"(",["T_CONSTANT_ENCAPSED_STRING","'sqlsrv'",688],["T_WHITESPACE"," ",688],["T_IS_IDENTICAL","===",688],["T_WHITESPACE"," ",688],["T_VARIABLE","$this",688],["T_OBJECT_OPERATOR","->",688],["T_STRING","driver",688],["T_WHITESPACE"," ",688],["T_BOOLEAN_OR","||",688],["T_WHITESPACE"," ",688],["T_CONSTANT_ENCAPSED_STRING","'oci'",688],["T_WHITESPACE"," ",688],["T_IS_IDENTICAL","===",688],["T_WHITESPACE"," ",688],["T_VARIABLE","$this",688],["T_OBJECT_OPERATOR","->",688],["T_STRING","driver",688],")",["T_WHITESPACE"," ",688],"{",["T_WHITESPACE","\n                ",688],["T_VARIABLE","$mergeStmt",689],["T_OBJECT_OPERATOR","->",689],["T_STRING","bindParam",689],"(",["T_LNUMBER","1",689],",",["T_WHITESPACE"," ",689],["T_VARIABLE","$sessionId",689],",",["T_WHITESPACE"," ",689],["T_NS_SEPARATOR","\\",689],["T_STRING","PDO",689],["T_DOUBLE_COLON","::",689],["T_STRING","PARAM_STR",689],")",";",["T_WHITESPACE","\n                ",689],["T_VARIABLE","$mergeStmt",690],["T_OBJECT_OPERATOR","->",690],["T_STRING","bindParam",690],"(",["T_LNUMBER","2",690],",",["T_WHITESPACE"," ",690],["T_VARIABLE","$sessionId",690],",",["T_WHITESPACE"," ",690],["T_NS_SEPARATOR","\\",690],["T_STRING","PDO",690],["T_DOUBLE_COLON","::",690],["T_STRING","PARAM_STR",690],")",";",["T_WHITESPACE","\n                ",690],["T_VARIABLE","$mergeStmt",691],["T_OBJECT_OPERATOR","->",691],["T_STRING","bindParam",691],"(",["T_LNUMBER","3",691],",",["T_WHITESPACE"," ",691],["T_VARIABLE","$data",691],",",["T_WHITESPACE"," ",691],["T_NS_SEPARATOR","\\",691],["T_STRING","PDO",691],["T_DOUBLE_COLON","::",691],["T_STRING","PARAM_LOB",691],")",";",["T_WHITESPACE","\n                ",691],["T_VARIABLE","$mergeStmt",692],["T_OBJECT_OPERATOR","->",692],["T_STRING","bindParam",692],"(",["T_LNUMBER","4",692],",",["T_WHITESPACE"," ",692],["T_VARIABLE","$maxlifetime",692],",",["T_WHITESPACE"," ",692],["T_NS_SEPARATOR","\\",692],["T_STRING","PDO",692],["T_DOUBLE_COLON","::",692],["T_STRING","PARAM_INT",692],")",";",["T_WHITESPACE","\n                ",692],["T_VARIABLE","$mergeStmt",693],["T_OBJECT_OPERATOR","->",693],["T_STRING","bindValue",693],"(",["T_LNUMBER","5",693],",",["T_WHITESPACE"," ",693],["T_STRING","time",693],"(",")",",",["T_WHITESPACE"," ",693],["T_NS_SEPARATOR","\\",693],["T_STRING","PDO",693],["T_DOUBLE_COLON","::",693],["T_STRING","PARAM_INT",693],")",";",["T_WHITESPACE","\n                ",693],["T_VARIABLE","$mergeStmt",694],["T_OBJECT_OPERATOR","->",694],["T_STRING","bindParam",694],"(",["T_LNUMBER","6",694],",",["T_WHITESPACE"," ",694],["T_VARIABLE","$data",694],",",["T_WHITESPACE"," ",694],["T_NS_SEPARATOR","\\",694],["T_STRING","PDO",694],["T_DOUBLE_COLON","::",694],["T_STRING","PARAM_LOB",694],")",";",["T_WHITESPACE","\n                ",694],["T_VARIABLE","$mergeStmt",695],["T_OBJECT_OPERATOR","->",695],["T_STRING","bindParam",695],"(",["T_LNUMBER","7",695],",",["T_WHITESPACE"," ",695],["T_VARIABLE","$maxlifetime",695],",",["T_WHITESPACE"," ",695],["T_NS_SEPARATOR","\\",695],["T_STRING","PDO",695],["T_DOUBLE_COLON","::",695],["T_STRING","PARAM_INT",695],")",";",["T_WHITESPACE","\n                ",695],["T_VARIABLE","$mergeStmt",696],["T_OBJECT_OPERATOR","->",696],["T_STRING","bindValue",696],"(",["T_LNUMBER","8",696],",",["T_WHITESPACE"," ",696],["T_STRING","time",696],"(",")",",",["T_WHITESPACE"," ",696],["T_NS_SEPARATOR","\\",696],["T_STRING","PDO",696],["T_DOUBLE_COLON","::",696],["T_STRING","PARAM_INT",696],")",";",["T_WHITESPACE","\n            ",696],"}",["T_WHITESPACE"," ",697],["T_ELSE","else",697],["T_WHITESPACE"," ",697],"{",["T_WHITESPACE","\n                ",697],["T_VARIABLE","$mergeStmt",698],["T_OBJECT_OPERATOR","->",698],["T_STRING","bindParam",698],"(",["T_CONSTANT_ENCAPSED_STRING","':id'",698],",",["T_WHITESPACE"," ",698],["T_VARIABLE","$sessionId",698],",",["T_WHITESPACE"," ",698],["T_NS_SEPARATOR","\\",698],["T_STRING","PDO",698],["T_DOUBLE_COLON","::",698],["T_STRING","PARAM_STR",698],")",";",["T_WHITESPACE","\n                ",698],["T_VARIABLE","$mergeStmt",699],["T_OBJECT_OPERATOR","->",699],["T_STRING","bindParam",699],"(",["T_CONSTANT_ENCAPSED_STRING","':data'",699],",",["T_WHITESPACE"," ",699],["T_VARIABLE","$data",699],",",["T_WHITESPACE"," ",699],["T_NS_SEPARATOR","\\",699],["T_STRING","PDO",699],["T_DOUBLE_COLON","::",699],["T_STRING","PARAM_LOB",699],")",";",["T_WHITESPACE","\n                ",699],["T_VARIABLE","$mergeStmt",700],["T_OBJECT_OPERATOR","->",700],["T_STRING","bindParam",700],"(",["T_CONSTANT_ENCAPSED_STRING","':lifetime'",700],",",["T_WHITESPACE"," ",700],["T_VARIABLE","$maxlifetime",700],",",["T_WHITESPACE"," ",700],["T_NS_SEPARATOR","\\",700],["T_STRING","PDO",700],["T_DOUBLE_COLON","::",700],["T_STRING","PARAM_INT",700],")",";",["T_WHITESPACE","\n                ",700],["T_VARIABLE","$mergeStmt",701],["T_OBJECT_OPERATOR","->",701],["T_STRING","bindValue",701],"(",["T_CONSTANT_ENCAPSED_STRING","':time'",701],",",["T_WHITESPACE"," ",701],["T_STRING","time",701],"(",")",",",["T_WHITESPACE"," ",701],["T_NS_SEPARATOR","\\",701],["T_STRING","PDO",701],["T_DOUBLE_COLON","::",701],["T_STRING","PARAM_INT",701],")",";",["T_WHITESPACE","\n            ",701],"}",["T_WHITESPACE","\n\n            ",702],["T_RETURN","return",704],["T_WHITESPACE"," ",704],["T_VARIABLE","$mergeStmt",704],";",["T_WHITESPACE","\n        ",704],"}",["T_WHITESPACE","\n    ",705],"}",["T_WHITESPACE","\n\n    ",706],["T_DOC_COMMENT","\/**\n     * Return a PDO instance.\n     *\n     * @return \\PDO\n     *\/",708],["T_WHITESPACE","\n    ",712],["T_PROTECTED","protected",713],["T_WHITESPACE"," ",713],["T_FUNCTION","function",713],["T_WHITESPACE"," ",713],["T_STRING","getConnection",713],"(",")",["T_WHITESPACE","\n    ",713],"{",["T_WHITESPACE","\n        ",714],["T_IF","if",715],["T_WHITESPACE"," ",715],"(",["T_STRING","null",715],["T_WHITESPACE"," ",715],["T_IS_IDENTICAL","===",715],["T_WHITESPACE"," ",715],["T_VARIABLE","$this",715],["T_OBJECT_OPERATOR","->",715],["T_STRING","pdo",715],")",["T_WHITESPACE"," ",715],"{",["T_WHITESPACE","\n            ",715],["T_VARIABLE","$this",716],["T_OBJECT_OPERATOR","->",716],["T_STRING","connect",716],"(",["T_VARIABLE","$this",716],["T_OBJECT_OPERATOR","->",716],["T_STRING","dsn",716],["T_WHITESPACE"," ",716],"?",":",["T_WHITESPACE"," ",716],["T_STRING","ini_get",716],"(",["T_CONSTANT_ENCAPSED_STRING","'session.save_path'",716],")",")",";",["T_WHITESPACE","\n        ",716],"}",["T_WHITESPACE","\n\n        ",717],["T_RETURN","return",719],["T_WHITESPACE"," ",719],["T_VARIABLE","$this",719],["T_OBJECT_OPERATOR","->",719],["T_STRING","pdo",719],";",["T_WHITESPACE","\n    ",719],"}",["T_WHITESPACE","\n",720],"}",["T_WHITESPACE","\n",721]]