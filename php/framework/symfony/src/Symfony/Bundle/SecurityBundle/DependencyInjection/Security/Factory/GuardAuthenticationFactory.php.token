[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Bundle",12],["T_NS_SEPARATOR","\\",12],["T_STRING","SecurityBundle",12],["T_NS_SEPARATOR","\\",12],["T_STRING","DependencyInjection",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Security",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Factory",12],";",["T_WHITESPACE","\n\n",12],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Symfony",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Component",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Config",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Definition",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Builder",14],["T_NS_SEPARATOR","\\",14],["T_STRING","NodeDefinition",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Symfony",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Component",15],["T_NS_SEPARATOR","\\",15],["T_STRING","DependencyInjection",15],["T_NS_SEPARATOR","\\",15],["T_STRING","ChildDefinition",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Symfony",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Component",16],["T_NS_SEPARATOR","\\",16],["T_STRING","DependencyInjection",16],["T_NS_SEPARATOR","\\",16],["T_STRING","ContainerBuilder",16],";",["T_WHITESPACE","\n",16],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Symfony",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Component",17],["T_NS_SEPARATOR","\\",17],["T_STRING","DependencyInjection",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Reference",17],";",["T_WHITESPACE","\n\n",17],["T_DOC_COMMENT","\/**\n * Configures the \"guard\" authentication provider key under a firewall.\n *\n * @author Ryan Weaver <ryan@knpuniversity.com>\n *\/",19],["T_WHITESPACE","\n",23],["T_CLASS","class",24],["T_WHITESPACE"," ",24],["T_STRING","GuardAuthenticationFactory",24],["T_WHITESPACE"," ",24],["T_IMPLEMENTS","implements",24],["T_WHITESPACE"," ",24],["T_STRING","SecurityFactoryInterface",24],["T_WHITESPACE","\n",24],"{",["T_WHITESPACE","\n    ",25],["T_PUBLIC","public",26],["T_WHITESPACE"," ",26],["T_FUNCTION","function",26],["T_WHITESPACE"," ",26],["T_STRING","getPosition",26],"(",")",["T_WHITESPACE","\n    ",26],"{",["T_WHITESPACE","\n        ",27],["T_RETURN","return",28],["T_WHITESPACE"," ",28],["T_CONSTANT_ENCAPSED_STRING","'pre_auth'",28],";",["T_WHITESPACE","\n    ",28],"}",["T_WHITESPACE","\n\n    ",29],["T_PUBLIC","public",31],["T_WHITESPACE"," ",31],["T_FUNCTION","function",31],["T_WHITESPACE"," ",31],["T_STRING","getKey",31],"(",")",["T_WHITESPACE","\n    ",31],"{",["T_WHITESPACE","\n        ",32],["T_RETURN","return",33],["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'guard'",33],";",["T_WHITESPACE","\n    ",33],"}",["T_WHITESPACE","\n\n    ",34],["T_PUBLIC","public",36],["T_WHITESPACE"," ",36],["T_FUNCTION","function",36],["T_WHITESPACE"," ",36],["T_STRING","addConfiguration",36],"(",["T_STRING","NodeDefinition",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$node",36],")",["T_WHITESPACE","\n    ",36],"{",["T_WHITESPACE","\n        ",37],["T_VARIABLE","$node",38],["T_WHITESPACE","\n            ",38],["T_OBJECT_OPERATOR","->",39],["T_STRING","fixXmlConfig",39],"(",["T_CONSTANT_ENCAPSED_STRING","'authenticator'",39],")",["T_WHITESPACE","\n            ",39],["T_OBJECT_OPERATOR","->",40],["T_STRING","children",40],"(",")",["T_WHITESPACE","\n                ",40],["T_OBJECT_OPERATOR","->",41],["T_STRING","scalarNode",41],"(",["T_CONSTANT_ENCAPSED_STRING","'provider'",41],")",["T_WHITESPACE","\n                    ",41],["T_OBJECT_OPERATOR","->",42],["T_STRING","info",42],"(",["T_CONSTANT_ENCAPSED_STRING","'A key from the \"providers\" section of your security config, in case your user provider is different than the firewall'",42],")",["T_WHITESPACE","\n                ",42],["T_OBJECT_OPERATOR","->",43],["T_STRING","end",43],"(",")",["T_WHITESPACE","\n                ",43],["T_OBJECT_OPERATOR","->",44],["T_STRING","scalarNode",44],"(",["T_CONSTANT_ENCAPSED_STRING","'entry_point'",44],")",["T_WHITESPACE","\n                    ",44],["T_OBJECT_OPERATOR","->",45],["T_STRING","info",45],"(",["T_CONSTANT_ENCAPSED_STRING","'A service id (of one of your authenticators) whose start() method should be called when an anonymous user hits a page that requires authentication'",45],")",["T_WHITESPACE","\n                    ",45],["T_OBJECT_OPERATOR","->",46],["T_STRING","defaultValue",46],"(",["T_STRING","null",46],")",["T_WHITESPACE","\n                ",46],["T_OBJECT_OPERATOR","->",47],["T_STRING","end",47],"(",")",["T_WHITESPACE","\n                ",47],["T_OBJECT_OPERATOR","->",48],["T_STRING","arrayNode",48],"(",["T_CONSTANT_ENCAPSED_STRING","'authenticators'",48],")",["T_WHITESPACE","\n                    ",48],["T_OBJECT_OPERATOR","->",49],["T_STRING","info",49],"(",["T_CONSTANT_ENCAPSED_STRING","'An array of service ids for all of your \"authenticators\"'",49],")",["T_WHITESPACE","\n                    ",49],["T_OBJECT_OPERATOR","->",50],["T_STRING","requiresAtLeastOneElement",50],"(",")",["T_WHITESPACE","\n                    ",50],["T_OBJECT_OPERATOR","->",51],["T_STRING","prototype",51],"(",["T_CONSTANT_ENCAPSED_STRING","'scalar'",51],")",["T_OBJECT_OPERATOR","->",51],["T_STRING","end",51],"(",")",["T_WHITESPACE","\n                ",51],["T_OBJECT_OPERATOR","->",52],["T_STRING","end",52],"(",")",["T_WHITESPACE","\n            ",52],["T_OBJECT_OPERATOR","->",53],["T_STRING","end",53],"(",")",["T_WHITESPACE","\n        ",53],";",["T_WHITESPACE","\n    ",54],"}",["T_WHITESPACE","\n\n    ",55],["T_PUBLIC","public",57],["T_WHITESPACE"," ",57],["T_FUNCTION","function",57],["T_WHITESPACE"," ",57],["T_STRING","create",57],"(",["T_STRING","ContainerBuilder",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$container",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$id",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$config",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$userProvider",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$defaultEntryPoint",57],")",["T_WHITESPACE","\n    ",57],"{",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$authenticatorIds",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$config",59],"[",["T_CONSTANT_ENCAPSED_STRING","'authenticators'",59],"]",";",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$authenticatorReferences",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_ARRAY","array",60],"(",")",";",["T_WHITESPACE","\n        ",60],["T_FOREACH","foreach",61],["T_WHITESPACE"," ",61],"(",["T_VARIABLE","$authenticatorIds",61],["T_WHITESPACE"," ",61],["T_AS","as",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$authenticatorId",61],")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n            ",61],["T_VARIABLE","$authenticatorReferences",62],"[","]",["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_NEW","new",62],["T_WHITESPACE"," ",62],["T_STRING","Reference",62],"(",["T_VARIABLE","$authenticatorId",62],")",";",["T_WHITESPACE","\n        ",62],"}",["T_WHITESPACE","\n\n        ",63],["T_COMMENT","\/\/ configure the GuardAuthenticationFactory to have the dynamic constructor arguments\n",65],["T_WHITESPACE","        ",66],["T_VARIABLE","$providerId",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'security.authentication.provider.guard.'",66],".",["T_VARIABLE","$id",66],";",["T_WHITESPACE","\n        ",66],["T_VARIABLE","$container",67],["T_WHITESPACE","\n            ",67],["T_OBJECT_OPERATOR","->",68],["T_STRING","setDefinition",68],"(",["T_VARIABLE","$providerId",68],",",["T_WHITESPACE"," ",68],["T_NEW","new",68],["T_WHITESPACE"," ",68],["T_STRING","ChildDefinition",68],"(",["T_CONSTANT_ENCAPSED_STRING","'security.authentication.provider.guard'",68],")",")",["T_WHITESPACE","\n            ",68],["T_OBJECT_OPERATOR","->",69],["T_STRING","replaceArgument",69],"(",["T_LNUMBER","0",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$authenticatorReferences",69],")",["T_WHITESPACE","\n            ",69],["T_OBJECT_OPERATOR","->",70],["T_STRING","replaceArgument",70],"(",["T_LNUMBER","1",70],",",["T_WHITESPACE"," ",70],["T_NEW","new",70],["T_WHITESPACE"," ",70],["T_STRING","Reference",70],"(",["T_VARIABLE","$userProvider",70],")",")",["T_WHITESPACE","\n            ",70],["T_OBJECT_OPERATOR","->",71],["T_STRING","replaceArgument",71],"(",["T_LNUMBER","2",71],",",["T_WHITESPACE"," ",71],["T_VARIABLE","$id",71],")",["T_WHITESPACE","\n            ",71],["T_OBJECT_OPERATOR","->",72],["T_STRING","replaceArgument",72],"(",["T_LNUMBER","3",72],",",["T_WHITESPACE"," ",72],["T_NEW","new",72],["T_WHITESPACE"," ",72],["T_STRING","Reference",72],"(",["T_CONSTANT_ENCAPSED_STRING","'security.user_checker.'",72],".",["T_VARIABLE","$id",72],")",")",["T_WHITESPACE","\n        ",72],";",["T_WHITESPACE","\n\n        ",73],["T_COMMENT","\/\/ listener\n",75],["T_WHITESPACE","        ",76],["T_VARIABLE","$listenerId",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'security.authentication.listener.guard.'",76],".",["T_VARIABLE","$id",76],";",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$listener",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$container",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","setDefinition",77],"(",["T_VARIABLE","$listenerId",77],",",["T_WHITESPACE"," ",77],["T_NEW","new",77],["T_WHITESPACE"," ",77],["T_STRING","ChildDefinition",77],"(",["T_CONSTANT_ENCAPSED_STRING","'security.authentication.listener.guard'",77],")",")",";",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$listener",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","replaceArgument",78],"(",["T_LNUMBER","2",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$id",78],")",";",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$listener",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","replaceArgument",79],"(",["T_LNUMBER","3",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$authenticatorReferences",79],")",";",["T_WHITESPACE","\n\n        ",79],["T_COMMENT","\/\/ determine the entryPointId to use\n",81],["T_WHITESPACE","        ",82],["T_VARIABLE","$entryPointId",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","determineEntryPoint",82],"(",["T_VARIABLE","$defaultEntryPoint",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$config",82],")",";",["T_WHITESPACE","\n\n        ",82],["T_COMMENT","\/\/ this is always injected - then the listener decides if it should be used\n",84],["T_WHITESPACE","        ",85],["T_VARIABLE","$container",85],["T_WHITESPACE","\n            ",85],["T_OBJECT_OPERATOR","->",86],["T_STRING","getDefinition",86],"(",["T_VARIABLE","$listenerId",86],")",["T_WHITESPACE","\n            ",86],["T_OBJECT_OPERATOR","->",87],["T_STRING","addTag",87],"(",["T_CONSTANT_ENCAPSED_STRING","'security.remember_me_aware'",87],",",["T_WHITESPACE"," ",87],["T_ARRAY","array",87],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",87],["T_WHITESPACE"," ",87],["T_DOUBLE_ARROW","=>",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$id",87],",",["T_WHITESPACE"," ",87],["T_CONSTANT_ENCAPSED_STRING","'provider'",87],["T_WHITESPACE"," ",87],["T_DOUBLE_ARROW","=>",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$userProvider",87],")",")",";",["T_WHITESPACE","\n\n        ",87],["T_RETURN","return",89],["T_WHITESPACE"," ",89],["T_ARRAY","array",89],"(",["T_VARIABLE","$providerId",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$listenerId",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$entryPointId",89],")",";",["T_WHITESPACE","\n    ",89],"}",["T_WHITESPACE","\n\n    ",90],["T_PRIVATE","private",92],["T_WHITESPACE"," ",92],["T_FUNCTION","function",92],["T_WHITESPACE"," ",92],["T_STRING","determineEntryPoint",92],"(",["T_VARIABLE","$defaultEntryPointId",92],",",["T_WHITESPACE"," ",92],["T_ARRAY","array",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$config",92],")",["T_WHITESPACE","\n    ",92],"{",["T_WHITESPACE","\n        ",93],["T_IF","if",94],["T_WHITESPACE"," ",94],"(",["T_VARIABLE","$defaultEntryPointId",94],")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n            ",94],["T_COMMENT","\/\/ explode if they've configured the entry_point, but there is already one\n",95],["T_WHITESPACE","            ",96],["T_IF","if",96],["T_WHITESPACE"," ",96],"(",["T_VARIABLE","$config",96],"[",["T_CONSTANT_ENCAPSED_STRING","'entry_point'",96],"]",")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n                ",96],["T_THROW","throw",97],["T_WHITESPACE"," ",97],["T_NEW","new",97],["T_WHITESPACE"," ",97],["T_NS_SEPARATOR","\\",97],["T_STRING","LogicException",97],"(",["T_STRING","sprintf",97],"(",["T_WHITESPACE","\n                    ",97],["T_CONSTANT_ENCAPSED_STRING","'The guard authentication provider cannot use the \"%s\" entry_point because another entry point is already configured by another provider! Either remove the other provider or move the entry_point configuration as a root key under your firewall (i.e. at the same level as \"guard\").'",98],",",["T_WHITESPACE","\n                    ",98],["T_VARIABLE","$config",99],"[",["T_CONSTANT_ENCAPSED_STRING","'entry_point'",99],"]",["T_WHITESPACE","\n                ",99],")",")",";",["T_WHITESPACE","\n            ",100],"}",["T_WHITESPACE","\n\n            ",101],["T_RETURN","return",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$defaultEntryPointId",103],";",["T_WHITESPACE","\n        ",103],"}",["T_WHITESPACE","\n\n        ",104],["T_IF","if",106],["T_WHITESPACE"," ",106],"(",["T_VARIABLE","$config",106],"[",["T_CONSTANT_ENCAPSED_STRING","'entry_point'",106],"]",")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n            ",106],["T_COMMENT","\/\/ if it's configured explicitly, use it!\n",107],["T_WHITESPACE","            ",108],["T_RETURN","return",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$config",108],"[",["T_CONSTANT_ENCAPSED_STRING","'entry_point'",108],"]",";",["T_WHITESPACE","\n        ",108],"}",["T_WHITESPACE","\n\n        ",109],["T_VARIABLE","$authenticatorIds",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_VARIABLE","$config",111],"[",["T_CONSTANT_ENCAPSED_STRING","'authenticators'",111],"]",";",["T_WHITESPACE","\n        ",111],["T_IF","if",112],["T_WHITESPACE"," ",112],"(",["T_STRING","count",112],"(",["T_VARIABLE","$authenticatorIds",112],")",["T_WHITESPACE"," ",112],["T_IS_EQUAL","==",112],["T_WHITESPACE"," ",112],["T_LNUMBER","1",112],")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n            ",112],["T_COMMENT","\/\/ if there is only one authenticator, use that as the entry point\n",113],["T_WHITESPACE","            ",114],["T_RETURN","return",114],["T_WHITESPACE"," ",114],["T_STRING","array_shift",114],"(",["T_VARIABLE","$authenticatorIds",114],")",";",["T_WHITESPACE","\n        ",114],"}",["T_WHITESPACE","\n\n        ",115],["T_COMMENT","\/\/ we have multiple entry points - we must ask them to configure one\n",117],["T_WHITESPACE","        ",118],["T_THROW","throw",118],["T_WHITESPACE"," ",118],["T_NEW","new",118],["T_WHITESPACE"," ",118],["T_NS_SEPARATOR","\\",118],["T_STRING","LogicException",118],"(",["T_STRING","sprintf",118],"(",["T_WHITESPACE","\n            ",118],["T_CONSTANT_ENCAPSED_STRING","'Because you have multiple guard configurators, you need to set the \"guard.entry_point\" key to one of you configurators (%s)'",119],",",["T_WHITESPACE","\n            ",119],["T_STRING","implode",120],"(",["T_CONSTANT_ENCAPSED_STRING","', '",120],",",["T_WHITESPACE"," ",120],["T_VARIABLE","$authenticatorIds",120],")",["T_WHITESPACE","\n        ",120],")",")",";",["T_WHITESPACE","\n    ",121],"}",["T_WHITESPACE","\n",122],"}",["T_WHITESPACE","\n",123]]