[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_COMMENT","\/*\n * This file is part of the Symfony package.\n *\n * (c) Fabien Potencier <fabien@symfony.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n *\/",3],["T_WHITESPACE","\n\n",10],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Symfony",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Bridge",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Doctrine",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Validator",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Constraints",12],";",["T_WHITESPACE","\n\n",12],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Doctrine",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Common",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Persistence",14],["T_NS_SEPARATOR","\\",14],["T_STRING","ManagerRegistry",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Doctrine",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Common",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Persistence",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Mapping",15],["T_NS_SEPARATOR","\\",15],["T_STRING","ClassMetadata",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Doctrine",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Common",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Persistence",16],["T_NS_SEPARATOR","\\",16],["T_STRING","ObjectManager",16],";",["T_WHITESPACE","\n",16],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Symfony",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Component",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Validator",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Constraint",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Symfony",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Component",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Validator",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Exception",18],["T_NS_SEPARATOR","\\",18],["T_STRING","UnexpectedTypeException",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Symfony",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Component",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Validator",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Exception",19],["T_NS_SEPARATOR","\\",19],["T_STRING","ConstraintDefinitionException",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Symfony",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Component",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Validator",20],["T_NS_SEPARATOR","\\",20],["T_STRING","ConstraintValidator",20],";",["T_WHITESPACE","\n\n",20],["T_DOC_COMMENT","\/**\n * Unique Entity Validator checks if one or a set of fields contain unique values.\n *\n * @author Benjamin Eberlei <kontakt@beberlei.de>\n *\/",22],["T_WHITESPACE","\n",26],["T_CLASS","class",27],["T_WHITESPACE"," ",27],["T_STRING","UniqueEntityValidator",27],["T_WHITESPACE"," ",27],["T_EXTENDS","extends",27],["T_WHITESPACE"," ",27],["T_STRING","ConstraintValidator",27],["T_WHITESPACE","\n",27],"{",["T_WHITESPACE","\n    ",28],["T_DOC_COMMENT","\/**\n     * @var ManagerRegistry\n     *\/",29],["T_WHITESPACE","\n    ",31],["T_PRIVATE","private",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$registry",32],";",["T_WHITESPACE","\n\n    ",32],["T_PUBLIC","public",34],["T_WHITESPACE"," ",34],["T_FUNCTION","function",34],["T_WHITESPACE"," ",34],["T_STRING","__construct",34],"(",["T_STRING","ManagerRegistry",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$registry",34],")",["T_WHITESPACE","\n    ",34],"{",["T_WHITESPACE","\n        ",35],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","registry",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$registry",36],";",["T_WHITESPACE","\n    ",36],"}",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * @param object     $entity\n     * @param Constraint $constraint\n     *\n     * @throws UnexpectedTypeException\n     * @throws ConstraintDefinitionException\n     *\/",39],["T_WHITESPACE","\n    ",45],["T_PUBLIC","public",46],["T_WHITESPACE"," ",46],["T_FUNCTION","function",46],["T_WHITESPACE"," ",46],["T_STRING","validate",46],"(",["T_VARIABLE","$entity",46],",",["T_WHITESPACE"," ",46],["T_STRING","Constraint",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$constraint",46],")",["T_WHITESPACE","\n    ",46],"{",["T_WHITESPACE","\n        ",47],["T_IF","if",48],["T_WHITESPACE"," ",48],"(","!",["T_VARIABLE","$constraint",48],["T_WHITESPACE"," ",48],["T_INSTANCEOF","instanceof",48],["T_WHITESPACE"," ",48],["T_STRING","UniqueEntity",48],")",["T_WHITESPACE"," ",48],"{",["T_WHITESPACE","\n            ",48],["T_THROW","throw",49],["T_WHITESPACE"," ",49],["T_NEW","new",49],["T_WHITESPACE"," ",49],["T_STRING","UnexpectedTypeException",49],"(",["T_VARIABLE","$constraint",49],",",["T_WHITESPACE"," ",49],["T_NS_C","__NAMESPACE__",49],".",["T_CONSTANT_ENCAPSED_STRING","'\\UniqueEntity'",49],")",";",["T_WHITESPACE","\n        ",49],"}",["T_WHITESPACE","\n\n        ",50],["T_IF","if",52],["T_WHITESPACE"," ",52],"(","!",["T_STRING","is_array",52],"(",["T_VARIABLE","$constraint",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","fields",52],")",["T_WHITESPACE"," ",52],["T_BOOLEAN_AND","&&",52],["T_WHITESPACE"," ",52],"!",["T_STRING","is_string",52],"(",["T_VARIABLE","$constraint",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","fields",52],")",")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n            ",52],["T_THROW","throw",53],["T_WHITESPACE"," ",53],["T_NEW","new",53],["T_WHITESPACE"," ",53],["T_STRING","UnexpectedTypeException",53],"(",["T_VARIABLE","$constraint",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","fields",53],",",["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","'array'",53],")",";",["T_WHITESPACE","\n        ",53],"}",["T_WHITESPACE","\n\n        ",54],["T_IF","if",56],["T_WHITESPACE"," ",56],"(",["T_STRING","null",56],["T_WHITESPACE"," ",56],["T_IS_NOT_IDENTICAL","!==",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$constraint",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","errorPath",56],["T_WHITESPACE"," ",56],["T_BOOLEAN_AND","&&",56],["T_WHITESPACE"," ",56],"!",["T_STRING","is_string",56],"(",["T_VARIABLE","$constraint",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","errorPath",56],")",")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n            ",56],["T_THROW","throw",57],["T_WHITESPACE"," ",57],["T_NEW","new",57],["T_WHITESPACE"," ",57],["T_STRING","UnexpectedTypeException",57],"(",["T_VARIABLE","$constraint",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","errorPath",57],",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'string or null'",57],")",";",["T_WHITESPACE","\n        ",57],"}",["T_WHITESPACE","\n\n        ",58],["T_VARIABLE","$fields",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_ARRAY_CAST","(array)",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$constraint",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","fields",60],";",["T_WHITESPACE","\n\n        ",60],["T_IF","if",62],["T_WHITESPACE"," ",62],"(",["T_LNUMBER","0",62],["T_WHITESPACE"," ",62],["T_IS_IDENTICAL","===",62],["T_WHITESPACE"," ",62],["T_STRING","count",62],"(",["T_VARIABLE","$fields",62],")",")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n            ",62],["T_THROW","throw",63],["T_WHITESPACE"," ",63],["T_NEW","new",63],["T_WHITESPACE"," ",63],["T_STRING","ConstraintDefinitionException",63],"(",["T_CONSTANT_ENCAPSED_STRING","'At least one field has to be specified.'",63],")",";",["T_WHITESPACE","\n        ",63],"}",["T_WHITESPACE","\n\n        ",64],["T_IF","if",66],["T_WHITESPACE"," ",66],"(",["T_VARIABLE","$constraint",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","em",66],")",["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n            ",66],["T_VARIABLE","$em",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","registry",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getManager",67],"(",["T_VARIABLE","$constraint",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","em",67],")",";",["T_WHITESPACE","\n\n            ",67],["T_IF","if",69],["T_WHITESPACE"," ",69],"(","!",["T_VARIABLE","$em",69],")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n                ",69],["T_THROW","throw",70],["T_WHITESPACE"," ",70],["T_NEW","new",70],["T_WHITESPACE"," ",70],["T_STRING","ConstraintDefinitionException",70],"(",["T_STRING","sprintf",70],"(",["T_CONSTANT_ENCAPSED_STRING","'Object manager \"%s\" does not exist.'",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$constraint",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","em",70],")",")",";",["T_WHITESPACE","\n            ",70],"}",["T_WHITESPACE","\n        ",71],"}",["T_WHITESPACE"," ",72],["T_ELSE","else",72],["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n            ",72],["T_VARIABLE","$em",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","registry",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","getManagerForClass",73],"(",["T_STRING","get_class",73],"(",["T_VARIABLE","$entity",73],")",")",";",["T_WHITESPACE","\n\n            ",73],["T_IF","if",75],["T_WHITESPACE"," ",75],"(","!",["T_VARIABLE","$em",75],")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n                ",75],["T_THROW","throw",76],["T_WHITESPACE"," ",76],["T_NEW","new",76],["T_WHITESPACE"," ",76],["T_STRING","ConstraintDefinitionException",76],"(",["T_STRING","sprintf",76],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to find the object manager associated with an entity of class \"%s\".'",76],",",["T_WHITESPACE"," ",76],["T_STRING","get_class",76],"(",["T_VARIABLE","$entity",76],")",")",")",";",["T_WHITESPACE","\n            ",76],"}",["T_WHITESPACE","\n        ",77],"}",["T_WHITESPACE","\n\n        ",78],["T_VARIABLE","$class",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$em",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getClassMetadata",80],"(",["T_STRING","get_class",80],"(",["T_VARIABLE","$entity",80],")",")",";",["T_WHITESPACE","\n        ",80],["T_COMMENT","\/* @var $class \\Doctrine\\Common\\Persistence\\Mapping\\ClassMetadata *\/",81],["T_WHITESPACE","\n\n        ",81],["T_VARIABLE","$criteria",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_ARRAY","array",83],"(",")",";",["T_WHITESPACE","\n        ",83],["T_FOREACH","foreach",84],["T_WHITESPACE"," ",84],"(",["T_VARIABLE","$fields",84],["T_WHITESPACE"," ",84],["T_AS","as",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$fieldName",84],")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n            ",84],["T_IF","if",85],["T_WHITESPACE"," ",85],"(","!",["T_VARIABLE","$class",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","hasField",85],"(",["T_VARIABLE","$fieldName",85],")",["T_WHITESPACE"," ",85],["T_BOOLEAN_AND","&&",85],["T_WHITESPACE"," ",85],"!",["T_VARIABLE","$class",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","hasAssociation",85],"(",["T_VARIABLE","$fieldName",85],")",")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n                ",85],["T_THROW","throw",86],["T_WHITESPACE"," ",86],["T_NEW","new",86],["T_WHITESPACE"," ",86],["T_STRING","ConstraintDefinitionException",86],"(",["T_STRING","sprintf",86],"(",["T_CONSTANT_ENCAPSED_STRING","'The field \"%s\" is not mapped by Doctrine, so it cannot be validated for uniqueness.'",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$fieldName",86],")",")",";",["T_WHITESPACE","\n            ",86],"}",["T_WHITESPACE","\n\n            ",87],["T_VARIABLE","$fieldValue",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$class",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","reflFields",89],"[",["T_VARIABLE","$fieldName",89],"]",["T_OBJECT_OPERATOR","->",89],["T_STRING","getValue",89],"(",["T_VARIABLE","$entity",89],")",";",["T_WHITESPACE","\n\n            ",89],["T_IF","if",91],["T_WHITESPACE"," ",91],"(",["T_VARIABLE","$constraint",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","ignoreNull",91],["T_WHITESPACE"," ",91],["T_BOOLEAN_AND","&&",91],["T_WHITESPACE"," ",91],["T_STRING","null",91],["T_WHITESPACE"," ",91],["T_IS_IDENTICAL","===",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$fieldValue",91],")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n                ",91],["T_CONTINUE","continue",92],";",["T_WHITESPACE","\n            ",92],"}",["T_WHITESPACE","\n\n            ",93],["T_VARIABLE","$criteria",95],"[",["T_VARIABLE","$fieldName",95],"]",["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$fieldValue",95],";",["T_WHITESPACE","\n\n            ",95],["T_IF","if",97],["T_WHITESPACE"," ",97],"(",["T_STRING","null",97],["T_WHITESPACE"," ",97],["T_IS_NOT_IDENTICAL","!==",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$criteria",97],"[",["T_VARIABLE","$fieldName",97],"]",["T_WHITESPACE"," ",97],["T_BOOLEAN_AND","&&",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$class",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","hasAssociation",97],"(",["T_VARIABLE","$fieldName",97],")",")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n                ",97],["T_COMMENT","\/* Ensure the Proxy is initialized before using reflection to\n                 * read its identifiers. This is necessary because the wrapped\n                 * getter methods in the Proxy are being bypassed.\n                 *\/",98],["T_WHITESPACE","\n                ",101],["T_VARIABLE","$em",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","initializeObject",102],"(",["T_VARIABLE","$criteria",102],"[",["T_VARIABLE","$fieldName",102],"]",")",";",["T_WHITESPACE","\n            ",102],"}",["T_WHITESPACE","\n        ",103],"}",["T_WHITESPACE","\n\n        ",104],["T_COMMENT","\/\/ skip validation if there are no criteria (this can happen when the\n",106],["T_WHITESPACE","        ",107],["T_COMMENT","\/\/ \"ignoreNull\" option is enabled and fields to be checked are null\n",107],["T_WHITESPACE","        ",108],["T_IF","if",108],["T_WHITESPACE"," ",108],"(",["T_EMPTY","empty",108],"(",["T_VARIABLE","$criteria",108],")",")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n            ",108],["T_RETURN","return",109],";",["T_WHITESPACE","\n        ",109],"}",["T_WHITESPACE","\n\n        ",110],["T_IF","if",112],["T_WHITESPACE"," ",112],"(",["T_STRING","null",112],["T_WHITESPACE"," ",112],["T_IS_NOT_IDENTICAL","!==",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$constraint",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","entityClass",112],")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n            ",112],["T_COMMENT","\/* Retrieve repository from given entity name.\n             * We ensure the retrieved repository can handle the entity\n             * by checking the entity is the same, or subclass of the supported entity.\n             *\/",113],["T_WHITESPACE","\n            ",116],["T_VARIABLE","$repository",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_VARIABLE","$em",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getRepository",117],"(",["T_VARIABLE","$constraint",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","entityClass",117],")",";",["T_WHITESPACE","\n            ",117],["T_VARIABLE","$supportedClass",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$repository",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","getClassName",118],"(",")",";",["T_WHITESPACE","\n\n            ",118],["T_IF","if",120],["T_WHITESPACE"," ",120],"(","!",["T_VARIABLE","$entity",120],["T_WHITESPACE"," ",120],["T_INSTANCEOF","instanceof",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$supportedClass",120],")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n                ",120],["T_THROW","throw",121],["T_WHITESPACE"," ",121],["T_NEW","new",121],["T_WHITESPACE"," ",121],["T_STRING","ConstraintDefinitionException",121],"(",["T_STRING","sprintf",121],"(",["T_CONSTANT_ENCAPSED_STRING","'The \"%s\" entity repository does not support the \"%s\" entity. The entity should be an instance of or extend \"%s\".'",121],",",["T_WHITESPACE"," ",121],["T_VARIABLE","$constraint",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","entityClass",121],",",["T_WHITESPACE"," ",121],["T_VARIABLE","$class",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","getName",121],"(",")",",",["T_WHITESPACE"," ",121],["T_VARIABLE","$supportedClass",121],")",")",";",["T_WHITESPACE","\n            ",121],"}",["T_WHITESPACE","\n        ",122],"}",["T_WHITESPACE"," ",123],["T_ELSE","else",123],["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n            ",123],["T_VARIABLE","$repository",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$em",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","getRepository",124],"(",["T_STRING","get_class",124],"(",["T_VARIABLE","$entity",124],")",")",";",["T_WHITESPACE","\n        ",124],"}",["T_WHITESPACE","\n\n        ",125],["T_VARIABLE","$result",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_VARIABLE","$repository",127],["T_OBJECT_OPERATOR","->",127],"{",["T_VARIABLE","$constraint",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","repositoryMethod",127],"}","(",["T_VARIABLE","$criteria",127],")",";",["T_WHITESPACE","\n\n        ",127],["T_IF","if",129],["T_WHITESPACE"," ",129],"(",["T_VARIABLE","$result",129],["T_WHITESPACE"," ",129],["T_INSTANCEOF","instanceof",129],["T_WHITESPACE"," ",129],["T_NS_SEPARATOR","\\",129],["T_STRING","IteratorAggregate",129],")",["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n            ",129],["T_VARIABLE","$result",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$result",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getIterator",130],"(",")",";",["T_WHITESPACE","\n        ",130],"}",["T_WHITESPACE","\n\n        ",131],["T_COMMENT","\/* If the result is a MongoCursor, it must be advanced to the first\n         * element. Rewinding should have no ill effect if $result is another\n         * iterator implementation.\n         *\/",133],["T_WHITESPACE","\n        ",136],["T_IF","if",137],["T_WHITESPACE"," ",137],"(",["T_VARIABLE","$result",137],["T_WHITESPACE"," ",137],["T_INSTANCEOF","instanceof",137],["T_WHITESPACE"," ",137],["T_NS_SEPARATOR","\\",137],["T_STRING","Iterator",137],")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n            ",137],["T_VARIABLE","$result",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","rewind",138],"(",")",";",["T_WHITESPACE","\n        ",138],"}",["T_WHITESPACE"," ",139],["T_ELSEIF","elseif",139],["T_WHITESPACE"," ",139],"(",["T_STRING","is_array",139],"(",["T_VARIABLE","$result",139],")",")",["T_WHITESPACE"," ",139],"{",["T_WHITESPACE","\n            ",139],["T_STRING","reset",140],"(",["T_VARIABLE","$result",140],")",";",["T_WHITESPACE","\n        ",140],"}",["T_WHITESPACE","\n\n        ",141],["T_COMMENT","\/* If no entity matched the query criteria or a single entity matched,\n         * which is the same as the entity being validated, the criteria is\n         * unique.\n         *\/",143],["T_WHITESPACE","\n        ",146],["T_IF","if",147],["T_WHITESPACE"," ",147],"(",["T_LNUMBER","0",147],["T_WHITESPACE"," ",147],["T_IS_IDENTICAL","===",147],["T_WHITESPACE"," ",147],["T_STRING","count",147],"(",["T_VARIABLE","$result",147],")",["T_WHITESPACE"," ",147],["T_BOOLEAN_OR","||",147],["T_WHITESPACE"," ",147],"(",["T_LNUMBER","1",147],["T_WHITESPACE"," ",147],["T_IS_IDENTICAL","===",147],["T_WHITESPACE"," ",147],["T_STRING","count",147],"(",["T_VARIABLE","$result",147],")",["T_WHITESPACE"," ",147],["T_BOOLEAN_AND","&&",147],["T_WHITESPACE"," ",147],["T_VARIABLE","$entity",147],["T_WHITESPACE"," ",147],["T_IS_IDENTICAL","===",147],["T_WHITESPACE"," ",147],"(",["T_VARIABLE","$result",147],["T_WHITESPACE"," ",147],["T_INSTANCEOF","instanceof",147],["T_WHITESPACE"," ",147],["T_NS_SEPARATOR","\\",147],["T_STRING","Iterator",147],["T_WHITESPACE"," ",147],"?",["T_WHITESPACE"," ",147],["T_VARIABLE","$result",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","current",147],"(",")",["T_WHITESPACE"," ",147],":",["T_WHITESPACE"," ",147],["T_STRING","current",147],"(",["T_VARIABLE","$result",147],")",")",")",")",["T_WHITESPACE"," ",147],"{",["T_WHITESPACE","\n            ",147],["T_RETURN","return",148],";",["T_WHITESPACE","\n        ",148],"}",["T_WHITESPACE","\n\n        ",149],["T_VARIABLE","$errorPath",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_STRING","null",151],["T_WHITESPACE"," ",151],["T_IS_NOT_IDENTICAL","!==",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$constraint",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","errorPath",151],["T_WHITESPACE"," ",151],"?",["T_WHITESPACE"," ",151],["T_VARIABLE","$constraint",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","errorPath",151],["T_WHITESPACE"," ",151],":",["T_WHITESPACE"," ",151],["T_VARIABLE","$fields",151],"[",["T_LNUMBER","0",151],"]",";",["T_WHITESPACE","\n        ",151],["T_VARIABLE","$invalidValue",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_ISSET","isset",152],"(",["T_VARIABLE","$criteria",152],"[",["T_VARIABLE","$errorPath",152],"]",")",["T_WHITESPACE"," ",152],"?",["T_WHITESPACE"," ",152],["T_VARIABLE","$criteria",152],"[",["T_VARIABLE","$errorPath",152],"]",["T_WHITESPACE"," ",152],":",["T_WHITESPACE"," ",152],["T_VARIABLE","$criteria",152],"[",["T_VARIABLE","$fields",152],"[",["T_LNUMBER","0",152],"]","]",";",["T_WHITESPACE","\n\n        ",152],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","context",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","buildViolation",154],"(",["T_VARIABLE","$constraint",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","message",154],")",["T_WHITESPACE","\n            ",154],["T_OBJECT_OPERATOR","->",155],["T_STRING","atPath",155],"(",["T_VARIABLE","$errorPath",155],")",["T_WHITESPACE","\n            ",155],["T_OBJECT_OPERATOR","->",156],["T_STRING","setParameter",156],"(",["T_CONSTANT_ENCAPSED_STRING","'{{ value }}'",156],",",["T_WHITESPACE"," ",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","formatWithIdentifiers",156],"(",["T_VARIABLE","$em",156],",",["T_WHITESPACE"," ",156],["T_VARIABLE","$class",156],",",["T_WHITESPACE"," ",156],["T_VARIABLE","$invalidValue",156],")",")",["T_WHITESPACE","\n            ",156],["T_OBJECT_OPERATOR","->",157],["T_STRING","setInvalidValue",157],"(",["T_VARIABLE","$invalidValue",157],")",["T_WHITESPACE","\n            ",157],["T_OBJECT_OPERATOR","->",158],["T_STRING","setCode",158],"(",["T_STRING","UniqueEntity",158],["T_DOUBLE_COLON","::",158],["T_STRING","NOT_UNIQUE_ERROR",158],")",["T_WHITESPACE","\n            ",158],["T_OBJECT_OPERATOR","->",159],["T_STRING","addViolation",159],"(",")",";",["T_WHITESPACE","\n    ",159],"}",["T_WHITESPACE","\n\n    ",160],["T_PRIVATE","private",162],["T_WHITESPACE"," ",162],["T_FUNCTION","function",162],["T_WHITESPACE"," ",162],["T_STRING","formatWithIdentifiers",162],"(",["T_STRING","ObjectManager",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$em",162],",",["T_WHITESPACE"," ",162],["T_STRING","ClassMetadata",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$class",162],",",["T_WHITESPACE"," ",162],["T_VARIABLE","$value",162],")",["T_WHITESPACE","\n    ",162],"{",["T_WHITESPACE","\n        ",163],["T_IF","if",164],["T_WHITESPACE"," ",164],"(","!",["T_STRING","is_object",164],"(",["T_VARIABLE","$value",164],")",["T_WHITESPACE"," ",164],["T_BOOLEAN_OR","||",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$value",164],["T_WHITESPACE"," ",164],["T_INSTANCEOF","instanceof",164],["T_WHITESPACE"," ",164],["T_NS_SEPARATOR","\\",164],["T_STRING","DateTimeInterface",164],")",["T_WHITESPACE"," ",164],"{",["T_WHITESPACE","\n            ",164],["T_RETURN","return",165],["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","formatValue",165],"(",["T_VARIABLE","$value",165],",",["T_WHITESPACE"," ",165],["T_STRING","self",165],["T_DOUBLE_COLON","::",165],["T_STRING","PRETTY_DATE",165],")",";",["T_WHITESPACE","\n        ",165],"}",["T_WHITESPACE","\n\n        ",166],["T_COMMENT","\/\/ non unique value is a composite PK\n",168],["T_WHITESPACE","        ",169],["T_IF","if",169],["T_WHITESPACE"," ",169],"(",["T_VARIABLE","$class",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","getName",169],"(",")",["T_WHITESPACE"," ",169],["T_IS_NOT_IDENTICAL","!==",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$idClass",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_STRING","get_class",169],"(",["T_VARIABLE","$value",169],")",")",["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n            ",169],["T_VARIABLE","$identifiers",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_VARIABLE","$em",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","getClassMetadata",170],"(",["T_VARIABLE","$idClass",170],")",["T_OBJECT_OPERATOR","->",170],["T_STRING","getIdentifierValues",170],"(",["T_VARIABLE","$value",170],")",";",["T_WHITESPACE","\n        ",170],"}",["T_WHITESPACE"," ",171],["T_ELSE","else",171],["T_WHITESPACE"," ",171],"{",["T_WHITESPACE","\n            ",171],["T_VARIABLE","$identifiers",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_VARIABLE","$class",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","getIdentifierValues",172],"(",["T_VARIABLE","$value",172],")",";",["T_WHITESPACE","\n        ",172],"}",["T_WHITESPACE","\n\n        ",173],["T_IF","if",175],["T_WHITESPACE"," ",175],"(","!",["T_VARIABLE","$identifiers",175],")",["T_WHITESPACE"," ",175],"{",["T_WHITESPACE","\n            ",175],["T_RETURN","return",176],["T_WHITESPACE"," ",176],["T_STRING","sprintf",176],"(",["T_CONSTANT_ENCAPSED_STRING","'object(\"%s\")'",176],",",["T_WHITESPACE"," ",176],["T_VARIABLE","$idClass",176],")",";",["T_WHITESPACE","\n        ",176],"}",["T_WHITESPACE","\n\n        ",177],["T_STRING","array_walk",179],"(",["T_VARIABLE","$identifiers",179],",",["T_WHITESPACE"," ",179],["T_FUNCTION","function",179],["T_WHITESPACE"," ",179],"(","&",["T_VARIABLE","$id",179],",",["T_WHITESPACE"," ",179],["T_VARIABLE","$field",179],")",["T_WHITESPACE"," ",179],"{",["T_WHITESPACE","\n            ",179],["T_IF","if",180],["T_WHITESPACE"," ",180],"(","!",["T_STRING","is_object",180],"(",["T_VARIABLE","$id",180],")",["T_WHITESPACE"," ",180],["T_BOOLEAN_OR","||",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$id",180],["T_WHITESPACE"," ",180],["T_INSTANCEOF","instanceof",180],["T_WHITESPACE"," ",180],["T_NS_SEPARATOR","\\",180],["T_STRING","DateTimeInterface",180],")",["T_WHITESPACE"," ",180],"{",["T_WHITESPACE","\n                ",180],["T_VARIABLE","$idAsString",181],["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","formatValue",181],"(",["T_VARIABLE","$id",181],",",["T_WHITESPACE"," ",181],["T_STRING","self",181],["T_DOUBLE_COLON","::",181],["T_STRING","PRETTY_DATE",181],")",";",["T_WHITESPACE","\n            ",181],"}",["T_WHITESPACE"," ",182],["T_ELSE","else",182],["T_WHITESPACE"," ",182],"{",["T_WHITESPACE","\n                ",182],["T_VARIABLE","$idAsString",183],["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_STRING","sprintf",183],"(",["T_CONSTANT_ENCAPSED_STRING","'object(\"%s\")'",183],",",["T_WHITESPACE"," ",183],["T_STRING","get_class",183],"(",["T_VARIABLE","$id",183],")",")",";",["T_WHITESPACE","\n            ",183],"}",["T_WHITESPACE","\n\n            ",184],["T_VARIABLE","$id",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_STRING","sprintf",186],"(",["T_CONSTANT_ENCAPSED_STRING","'%s => %s'",186],",",["T_WHITESPACE"," ",186],["T_VARIABLE","$field",186],",",["T_WHITESPACE"," ",186],["T_VARIABLE","$idAsString",186],")",";",["T_WHITESPACE","\n        ",186],"}",")",";",["T_WHITESPACE","\n\n        ",187],["T_RETURN","return",189],["T_WHITESPACE"," ",189],["T_STRING","sprintf",189],"(",["T_CONSTANT_ENCAPSED_STRING","'object(\"%s\") identified by (%s)'",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$idClass",189],",",["T_WHITESPACE"," ",189],["T_STRING","implode",189],"(",["T_CONSTANT_ENCAPSED_STRING","', '",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$identifiers",189],")",")",";",["T_WHITESPACE","\n    ",189],"}",["T_WHITESPACE","\n",190],"}",["T_WHITESPACE","\n",191]]