[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_NAMESPACE","namespace",3],["T_WHITESPACE"," ",3],["T_STRING","beaba",3],["T_NS_SEPARATOR","\\",3],["T_STRING","core",3],";",["T_WHITESPACE","\n\n",3],["T_DOC_COMMENT","\/**\n * This file is distributed under the MIT Open Source\n * License. See README.MD for details.\n * @author Ioan CHIRIAC\n *\/",5],["T_WHITESPACE","\n",9],["T_CLASS","class",10],["T_WHITESPACE"," ",10],["T_STRING","WebApp",10],["T_WHITESPACE"," ",10],["T_EXTENDS","extends",10],["T_WHITESPACE"," ",10],["T_STRING","Application",10],["T_WHITESPACE","\n",10],"{",["T_WHITESPACE","\n    ",11],["T_DOC_COMMENT","\/**\n     * Prepare the view for rendering the specified error\n     * @return IView\n     *\/",12],["T_WHITESPACE","\n    ",15],["T_PUBLIC","public",16],["T_WHITESPACE"," ",16],["T_FUNCTION","function",16],["T_WHITESPACE"," ",16],["T_STRING","renderError",16],"(",["T_WHITESPACE"," ",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Exception",16],["T_WHITESPACE"," ",16],["T_VARIABLE","$error",16],["T_WHITESPACE"," ",16],")","{",["T_WHITESPACE","\n        ",16],["T_IF","if",17],["T_WHITESPACE"," ",17],"(",["T_VARIABLE","$error",17],["T_WHITESPACE"," ",17],["T_INSTANCEOF","instanceof",17],["T_WHITESPACE"," ",17],["T_STRING","Exception",17],")",["T_WHITESPACE"," ",17],"{",["T_WHITESPACE","\n            ",17],["T_VARIABLE","$code",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],["T_VARIABLE","$error",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","getCode",18],"(",")",";",["T_WHITESPACE","\n            ",18],["T_VARIABLE","$title",19],["T_WHITESPACE"," ",19],"=",["T_WHITESPACE"," ",19],["T_VARIABLE","$error",19],["T_OBJECT_OPERATOR","->",19],["T_STRING","getHttpMessage",19],"(",")",";",["T_WHITESPACE","\n        ",19],"}",["T_WHITESPACE"," ",20],["T_ELSE","else",20],["T_WHITESPACE"," ",20],"{",["T_WHITESPACE","\n            ",20],["T_VARIABLE","$code",21],["T_WHITESPACE"," ",21],"=",["T_WHITESPACE"," ",21],["T_LNUMBER","500",21],";",["T_WHITESPACE","\n            ",21],["T_VARIABLE","$title",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'Internal Error'",22],";",["T_WHITESPACE","\n        ",22],"}",["T_WHITESPACE","\n        ",23],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","getResponse",24],"(",")",["T_OBJECT_OPERATOR","->",24],["T_STRING","setCode",24],"(",["T_WHITESPACE","\n            ",24],["T_VARIABLE","$code",25],",",["T_WHITESPACE"," ",25],["T_VARIABLE","$title",25],["T_WHITESPACE","\n        ",25],")",";",["T_WHITESPACE","\n        ",26],["T_SWITCH","switch",27],"(",["T_VARIABLE","$code",27],")",["T_WHITESPACE"," ",27],"{",["T_WHITESPACE","\n            ",27],["T_CASE","case",28],["T_WHITESPACE"," ",28],["T_LNUMBER","401",28],":",["T_WHITESPACE"," ",28],["T_VARIABLE","$target",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_CONSTANT_ENCAPSED_STRING","'errors\/unauth'",28],";",["T_WHITESPACE"," ",28],["T_BREAK","break",28],";",["T_WHITESPACE","\n            ",28],["T_CASE","case",29],["T_WHITESPACE"," ",29],["T_LNUMBER","404",29],":",["T_WHITESPACE"," ",29],["T_VARIABLE","$target",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_CONSTANT_ENCAPSED_STRING","'errors\/not-found'",29],";",["T_WHITESPACE"," ",29],["T_BREAK","break",29],";",["T_WHITESPACE","\n            ",29],["T_DEFAULT","default",30],":",["T_WHITESPACE"," ",30],["T_VARIABLE","$target",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_CONSTANT_ENCAPSED_STRING","'errors\/internal'",30],";",["T_WHITESPACE"," ",30],["T_BREAK","break",30],";",["T_WHITESPACE","\n        ",30],"}",["T_WHITESPACE","\n        ",31],["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","instances",32],"[",["T_CONSTANT_ENCAPSED_STRING","'view'",32],"]",["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_STRING","null",32],";",["T_WHITESPACE","\n        ",32],["T_RETURN","return",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$this",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","getView",33],"(",")",["T_WHITESPACE","\n            ",33],["T_OBJECT_OPERATOR","->",34],["T_STRING","setTitle",34],"(",["T_VARIABLE","$code",34],["T_WHITESPACE"," ",34],".",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","' - '",34],["T_WHITESPACE"," ",34],".",["T_WHITESPACE"," ",34],["T_VARIABLE","$title",34],")",["T_WHITESPACE","\n            ",34],["T_OBJECT_OPERATOR","->",35],["T_STRING","setLayout",35],"(",["T_CONSTANT_ENCAPSED_STRING","'layouts\/center'",35],")",["T_WHITESPACE","\n            ",35],["T_OBJECT_OPERATOR","->",36],["T_STRING","push",36],"(",["T_WHITESPACE","\n                ",36],["T_CONSTANT_ENCAPSED_STRING","'content'",37],",",["T_WHITESPACE","\n                ",37],["T_VARIABLE","$target",38],",",["T_WHITESPACE","\n                ",38],["T_VARIABLE","$error",39],["T_WHITESPACE","\n            ",39],")",["T_WHITESPACE","\n        ",40],";",["T_WHITESPACE","\n    ",41],"}",["T_WHITESPACE","\n    ",42],["T_DOC_COMMENT","\/**\n     * Renders the HTML response\n     * @param mixed $response\n     * @return string\n     *\/",43],["T_WHITESPACE","\n    ",47],["T_PUBLIC","public",48],["T_WHITESPACE"," ",48],["T_FUNCTION","function",48],["T_WHITESPACE"," ",48],["T_STRING","renderHtml",48],"(",["T_VARIABLE","$response",48],")",["T_WHITESPACE","\n    ",48],"{",["T_WHITESPACE","\n        ",49],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","getResponse",50],"(",")",["T_OBJECT_OPERATOR","->",50],["T_STRING","setHeader",50],"(",["T_WHITESPACE","\n            ",50],["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",51],",",["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","'text\/html'",51],["T_WHITESPACE","\n        ",51],")",";",["T_WHITESPACE","\n        ",52],["T_IF","if",53],["T_WHITESPACE"," ",53],"(",["T_STRING","is_null",53],"(",["T_VARIABLE","$response",53],")",")",["T_WHITESPACE","\n            ",53],["T_VARIABLE","$response",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","getView",54],"(",")",";",["T_WHITESPACE","\n        ",54],["T_IF","if",55],["T_WHITESPACE"," ",55],"(",["T_VARIABLE","$response",55],["T_WHITESPACE"," ",55],["T_INSTANCEOF","instanceof",55],["T_WHITESPACE"," ",55],["T_STRING","IView",55],")",["T_WHITESPACE"," ",55],"{",["T_WHITESPACE","\n            ",55],["T_RETURN","return",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$response",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","renderTemplate",56],"(",")",";",["T_WHITESPACE","\n        ",56],"}",["T_WHITESPACE"," ",57],["T_ELSEIF","elseif",57],["T_WHITESPACE"," ",57],"(",["T_STRING","is_string",57],"(",["T_VARIABLE","$response",57],")",")",["T_WHITESPACE"," ",57],"{",["T_WHITESPACE","\n            ",57],["T_RETURN","return",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$response",58],";",["T_WHITESPACE","\n        ",58],"}",["T_WHITESPACE"," ",59],["T_ELSEIF","elseif",59],["T_WHITESPACE"," ",59],"(",["T_WHITESPACE","\n            ",59],["T_ISSET","isset",60],"(",["T_VARIABLE","$response",60],"[",["T_CONSTANT_ENCAPSED_STRING","'view'",60],"]",")",["T_WHITESPACE","\n        ",60],")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n            ",61],["T_IF","if",62],["T_WHITESPACE"," ",62],"(",["T_ISSET","isset",62],"(",["T_VARIABLE","$response",62],"[",["T_CONSTANT_ENCAPSED_STRING","'template'",62],"]",")",")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n                ",62],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","getView",63],"(",")",["T_OBJECT_OPERATOR","->",63],["T_STRING","setTemplate",63],"(",["T_VARIABLE","$response",63],"[",["T_CONSTANT_ENCAPSED_STRING","'template'",63],"]",")",";",["T_WHITESPACE","\n            ",63],"}",["T_WHITESPACE","\n            ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getView",65],"(",")",["T_OBJECT_OPERATOR","->",65],["T_STRING","setLayout",65],"(",["T_VARIABLE","$response",65],"[",["T_CONSTANT_ENCAPSED_STRING","'view'",65],"]",")",";",["T_WHITESPACE","\n            ",65],["T_IF","if",66],["T_WHITESPACE"," ",66],"(",["T_ISSET","isset",66],"(",["T_VARIABLE","$response",66],"[",["T_CONSTANT_ENCAPSED_STRING","'placeholders'",66],"]",")",")",["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n                ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getView",67],"(",")",["T_OBJECT_OPERATOR","->",67],["T_STRING","initLayout",67],"(",")",";",["T_WHITESPACE","\n                ",67],["T_FOREACH","foreach",68],["T_WHITESPACE"," ",68],"(",["T_VARIABLE","$response",68],"[",["T_CONSTANT_ENCAPSED_STRING","'placeholders'",68],"]",["T_WHITESPACE"," ",68],["T_AS","as",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$target",68],["T_WHITESPACE"," ",68],["T_DOUBLE_ARROW","=>",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$widgets",68],")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n                    ",68],["T_FOREACH","foreach",69],["T_WHITESPACE"," ",69],"(",["T_VARIABLE","$widgets",69],["T_WHITESPACE"," ",69],["T_AS","as",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$id",69],["T_WHITESPACE"," ",69],["T_DOUBLE_ARROW","=>",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$widget",69],")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n                        ",69],["T_IF","if",70],["T_WHITESPACE"," ",70],"(",["T_STRING","is_numeric",70],"(",["T_VARIABLE","$id",70],")",")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n                            ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getView",71],"(",")",["T_OBJECT_OPERATOR","->",71],["T_STRING","push",71],"(",["T_WHITESPACE","\n                                ",71],["T_VARIABLE","$target",72],",",["T_WHITESPACE"," ",72],["T_EMPTY","empty",72],"(",["T_VARIABLE","$widget",72],"[",["T_CONSTANT_ENCAPSED_STRING","'render'",72],"]",")",["T_WHITESPACE"," ",72],"?",["T_WHITESPACE","\n                                    ",72],["T_STRING","null",73],["T_WHITESPACE"," ",73],":",["T_WHITESPACE"," ",73],["T_VARIABLE","$widget",73],"[",["T_CONSTANT_ENCAPSED_STRING","'render'",73],"]",",",["T_WHITESPACE"," ",73],["T_ISSET","isset",73],"(",["T_VARIABLE","$widget",73],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",73],"]",")",["T_WHITESPACE"," ",73],"?",["T_WHITESPACE","\n                                    ",73],["T_VARIABLE","$widget",74],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",74],"]",["T_WHITESPACE"," ",74],":",["T_WHITESPACE"," ",74],["T_STRING","null",74],["T_WHITESPACE","\n                            ",74],")",";",["T_WHITESPACE","\n                        ",75],"}",["T_WHITESPACE"," ",76],["T_ELSE","else",76],["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n                            ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getView",77],"(",")",["T_OBJECT_OPERATOR","->",77],["T_STRING","attach",77],"(",["T_WHITESPACE","\n                                ",77],["T_VARIABLE","$target",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$id",78],",",["T_WHITESPACE"," ",78],["T_EMPTY","empty",78],"(",["T_VARIABLE","$widget",78],"[",["T_CONSTANT_ENCAPSED_STRING","'render'",78],"]",")",["T_WHITESPACE"," ",78],"?",["T_WHITESPACE","\n                                    ",78],["T_STRING","null",79],["T_WHITESPACE"," ",79],":",["T_WHITESPACE"," ",79],["T_VARIABLE","$widget",79],"[",["T_CONSTANT_ENCAPSED_STRING","'render'",79],"]",",",["T_WHITESPACE"," ",79],["T_ISSET","isset",79],"(",["T_VARIABLE","$widget",79],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",79],"]",")",["T_WHITESPACE"," ",79],"?",["T_WHITESPACE","\n                                    ",79],["T_VARIABLE","$widget",80],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",80],"]",["T_WHITESPACE"," ",80],":",["T_WHITESPACE"," ",80],["T_STRING","null",80],["T_WHITESPACE","\n                            ",80],")",";",["T_WHITESPACE","\n                        ",81],"}",["T_WHITESPACE","\n                    ",82],"}",["T_WHITESPACE","\n                ",83],"}",["T_WHITESPACE","\n            ",84],"}",["T_WHITESPACE","\n            ",85],["T_RETURN","return",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getView",86],"(",")",["T_OBJECT_OPERATOR","->",86],["T_STRING","renderTemplate",86],"(",")",";",["T_WHITESPACE","\n        ",86],"}",["T_WHITESPACE"," ",87],["T_ELSE","else",87],["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n            ",87],["T_THROW","throw",88],["T_WHITESPACE"," ",88],["T_NEW","new",88],["T_WHITESPACE"," ",88],["T_NS_SEPARATOR","\\",88],["T_STRING","Exception",88],"(",["T_WHITESPACE","\n                ",88],["T_CONSTANT_ENCAPSED_STRING","'Unsupported response type'",89],",",["T_WHITESPACE"," ",89],["T_LNUMBER","400",89],["T_WHITESPACE","\n            ",89],")",";",["T_WHITESPACE","\n        ",90],"}",["T_WHITESPACE","\n    ",91],"}",["T_WHITESPACE","\n\n    ",92],["T_DOC_COMMENT","\/**\n     * Serialize the result as a json\n     * @param mixed $response\n     * @return string\n     *\/",94],["T_WHITESPACE","\n    ",98],["T_PUBLIC","public",99],["T_WHITESPACE"," ",99],["T_FUNCTION","function",99],["T_WHITESPACE"," ",99],["T_STRING","renderJson",99],"(",["T_VARIABLE","$response",99],")",["T_WHITESPACE","\n    ",99],"{",["T_WHITESPACE","\n        ",100],["T_STRING","define",101],"(",["T_CONSTANT_ENCAPSED_STRING","'PROFILE_DISABLED'",101],",",["T_WHITESPACE"," ",101],["T_STRING","true",101],")",";",["T_WHITESPACE","\n        ",101],["T_IF","if",102],["T_WHITESPACE"," ",102],"(",["T_WHITESPACE"," ",102],"!",["T_EMPTY","empty",102],"(",["T_VARIABLE","$_SERVER",102],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_ORIGIN'",102],"]",")",["T_WHITESPACE"," ",102],")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n            ",102],["T_COMMENT","\/\/ ALLOW CROSS DOMAIN JSON REQUESTS\n",103],["T_WHITESPACE","            ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getResponse",104],"(",")",["T_OBJECT_OPERATOR","->",104],["T_STRING","setHeader",104],"(",["T_ARRAY","array",104],"(",["T_WHITESPACE","\n                ",104],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Allow-Origin'",105],["T_WHITESPACE","   ",105],["T_DOUBLE_ARROW","=>",105],["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'*'",105],",",["T_WHITESPACE","\n                ",105],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Allow-Methods'",106],["T_WHITESPACE","  ",106],["T_DOUBLE_ARROW","=>",106],["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'POST, GET, OPTIONS'",106],",",["T_WHITESPACE","\n                ",106],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Allow-Headers'",107],["T_WHITESPACE","  ",107],["T_DOUBLE_ARROW","=>",107],["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'*'",107],",",["T_WHITESPACE","\n                ",107],["T_CONSTANT_ENCAPSED_STRING","'Access-Control-Max-Age'",108],["T_WHITESPACE","        ",108],["T_DOUBLE_ARROW","=>",108],["T_WHITESPACE"," ",108],["T_LNUMBER","1000",108],["T_WHITESPACE","\n            ",108],")",")",";",["T_WHITESPACE","\n        ",109],"}",["T_WHITESPACE","\n        ",110],["T_IF","if",111],["T_WHITESPACE"," ",111],"(",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","getRequest",111],"(",")",["T_OBJECT_OPERATOR","->",111],["T_STRING","hasParameter",111],"(",["T_CONSTANT_ENCAPSED_STRING","'callback'",111],")",["T_WHITESPACE"," ",111],")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n            ",111],["T_COMMENT","\/\/ RESPOND IN JSONP\n",112],["T_WHITESPACE","            ",113],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","getResponse",113],"(",")",["T_OBJECT_OPERATOR","->",113],["T_STRING","setHeader",113],"(",["T_ARRAY","array",113],"(",["T_WHITESPACE","\n                ",113],["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",114],["T_WHITESPACE","  ",114],["T_DOUBLE_ARROW","=>",114],["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","'application\/script'",114],",",["T_WHITESPACE","\n                ",114],["T_CONSTANT_ENCAPSED_STRING","'Pragma'",115],["T_WHITESPACE","        ",115],["T_DOUBLE_ARROW","=>",115],["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'no-cache'",115],",",["T_WHITESPACE","\n                ",115],["T_CONSTANT_ENCAPSED_STRING","'Cache-Control'",116],["T_WHITESPACE"," ",116],["T_DOUBLE_ARROW","=>",116],["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","'no-cache, must-revalidate'",116],["T_WHITESPACE","\n            ",116],")",")",";",["T_WHITESPACE","\n            ",117],["T_RETURN","return",118],["T_WHITESPACE","\n                 ",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getRequest",119],"(",")",["T_OBJECT_OPERATOR","->",119],["T_STRING","getParameter",119],"(",["T_CONSTANT_ENCAPSED_STRING","'callback'",119],")",["T_WHITESPACE","\n                 ",119],".",["T_WHITESPACE"," ",120],["T_CONSTANT_ENCAPSED_STRING","'('",120],["T_WHITESPACE","\n                 ",120],".",["T_WHITESPACE"," ",121],["T_STRING","json_encode",121],"(",["T_VARIABLE","$response",121],")",["T_WHITESPACE","\n                 ",121],".",["T_WHITESPACE"," ",122],["T_CONSTANT_ENCAPSED_STRING","');'",122],["T_WHITESPACE","\n            ",122],";",["T_WHITESPACE","\n        ",123],"}",["T_WHITESPACE"," ",124],["T_ELSE","else",124],["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n            ",124],["T_COMMENT","\/\/ CLASSIC RESPONSE\n",125],["T_WHITESPACE","            ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getResponse",126],"(",")",["T_OBJECT_OPERATOR","->",126],["T_STRING","setHeader",126],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",126],",",["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'application\/json'",126],")",";",["T_WHITESPACE","\n            ",126],["T_RETURN","return",127],["T_WHITESPACE"," ",127],["T_STRING","json_encode",127],"(",["T_VARIABLE","$response",127],")",";",["T_WHITESPACE","\n        ",127],"}",["T_WHITESPACE","\n    ",128],"}",["T_WHITESPACE","\n\n    ",129],["T_DOC_COMMENT","\/**\n     * Serialize the result as a xml\n     * @param mixed $response\n     * @return string\n     *\/",131],["T_WHITESPACE","\n    ",135],["T_PUBLIC","public",136],["T_WHITESPACE"," ",136],["T_FUNCTION","function",136],["T_WHITESPACE"," ",136],["T_STRING","renderXml",136],"(",["T_VARIABLE","$response",136],")",["T_WHITESPACE","\n    ",136],"{",["T_WHITESPACE","\n        ",137],["T_STRING","define",138],"(",["T_CONSTANT_ENCAPSED_STRING","'PROFILE_DISABLED'",138],",",["T_WHITESPACE"," ",138],["T_STRING","true",138],")",";",["T_WHITESPACE","\n        ",138],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getResponse",139],"(",")",["T_OBJECT_OPERATOR","->",139],["T_STRING","setHeader",139],"(",["T_WHITESPACE","\n            ",139],["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",140],",",["T_WHITESPACE"," ",140],["T_CONSTANT_ENCAPSED_STRING","'text\/xml'",140],["T_WHITESPACE","\n        ",140],")",";",["T_WHITESPACE","\n        ",141],["T_IF","if",142],["T_WHITESPACE"," ",142],"(",["T_STRING","is_string",142],"(",["T_VARIABLE","$response",142],")",")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n            ",142],["T_RETURN","return",143],["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","'<response><![CDATA['",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_VARIABLE","$response",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","']]><\/response>'",143],";",["T_WHITESPACE","\n        ",143],"}",["T_WHITESPACE"," ",144],["T_ELSEIF","elseif",144],["T_WHITESPACE"," ",144],"(",["T_STRING","is_array",144],"(",["T_VARIABLE","$response",144],")",")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n            ",144],["T_VARIABLE","$return",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","'<response>'",145],";",["T_WHITESPACE","\n            ",145],["T_FOREACH","foreach",146],["T_WHITESPACE"," ",146],"(",["T_VARIABLE","$response",146],["T_WHITESPACE"," ",146],["T_AS","as",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$key",146],["T_WHITESPACE"," ",146],["T_DOUBLE_ARROW","=>",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$value",146],")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n                ",146],["T_VARIABLE","$return",147],["T_WHITESPACE"," ",147],["T_CONCAT_EQUAL",".=",147],["T_WHITESPACE"," ",147],["T_CONSTANT_ENCAPSED_STRING","'<'",147],["T_WHITESPACE"," ",147],".",["T_WHITESPACE"," ",147],["T_VARIABLE","$key",147],["T_WHITESPACE"," ",147],".",["T_WHITESPACE"," ",147],["T_CONSTANT_ENCAPSED_STRING","'>'",147],["T_WHITESPACE"," ",147],".",["T_WHITESPACE"," ",147],["T_VARIABLE","$value",147],["T_WHITESPACE"," ",147],".",["T_WHITESPACE"," ",147],["T_CONSTANT_ENCAPSED_STRING","'<\/'",147],["T_WHITESPACE"," ",147],".",["T_WHITESPACE"," ",147],["T_VARIABLE","$key",147],["T_WHITESPACE"," ",147],".",["T_WHITESPACE"," ",147],["T_CONSTANT_ENCAPSED_STRING","'>'",147],";",["T_WHITESPACE","\n            ",147],"}",["T_WHITESPACE","\n            ",148],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_VARIABLE","$return",149],["T_WHITESPACE"," ",149],".",["T_WHITESPACE"," ",149],["T_CONSTANT_ENCAPSED_STRING","'<\/response>'",149],";",["T_WHITESPACE","\n        ",149],"}",["T_WHITESPACE"," ",150],["T_ELSE","else",150],["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n            ",150],["T_RETURN","return",151],["T_WHITESPACE"," ",151],["T_CONSTANT_ENCAPSED_STRING","'<response \/>'",151],";",["T_WHITESPACE","\n        ",151],"}",["T_WHITESPACE","\n    ",152],"}",["T_WHITESPACE","\n\n    ",153],["T_DOC_COMMENT","\/**\n     * Executes the response callbacks and returns it's result\n     * @param string $response\n     * @param string $method\n     * @param string $format\n     * @param array $args\n     * @return mixed\n     *\/",155],["T_WHITESPACE","\n    ",162],["T_PUBLIC","public",163],["T_WHITESPACE"," ",163],["T_FUNCTION","function",163],["T_WHITESPACE"," ",163],["T_STRING","processResponse",163],"(",["T_VARIABLE","$response",163],",",["T_WHITESPACE"," ",163],["T_VARIABLE","$method",163],",",["T_WHITESPACE"," ",163],"&",["T_VARIABLE","$format",163],",",["T_WHITESPACE"," ",163],["T_ARRAY","array",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$args",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_STRING","null",163],")",["T_WHITESPACE","\n    ",163],"{",["T_WHITESPACE","\n        ",164],["T_COMMENT","\/\/ EXECUTING THE RESPONSE\n",165],["T_WHITESPACE","        ",166],["T_IF","if",166],["T_WHITESPACE"," ",166],"(","!",["T_STRING","is_string",166],"(",["T_VARIABLE","$response",166],")",")",["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n            ",166],["T_IF","if",167],["T_WHITESPACE"," ",167],"(",["T_STRING","is_array",167],"(",["T_VARIABLE","$response",167],")",")",["T_WHITESPACE"," ",167],"{",["T_WHITESPACE","\n                ",167],["T_COMMENT","\/\/ execute the rest method\n",168],["T_WHITESPACE","                ",169],["T_IF","if",169],["T_WHITESPACE"," ",169],"(",["T_ISSET","isset",169],"(",["T_VARIABLE","$response",169],"[",["T_VARIABLE","$method",169],"]",")",")",["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n                    ",169],["T_VARIABLE","$out",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_VARIABLE","$response",170],"[",["T_VARIABLE","$method",170],"]",";",["T_WHITESPACE","\n                ",170],"}",["T_WHITESPACE"," ",171],["T_ELSEIF","elseif",171],["T_WHITESPACE"," ",171],"(",["T_ISSET","isset",171],"(",["T_VARIABLE","$response",171],"[",["T_CONSTANT_ENCAPSED_STRING","'*'",171],"]",")",")",["T_WHITESPACE"," ",171],"{",["T_WHITESPACE","\n                    ",171],["T_VARIABLE","$out",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_VARIABLE","$response",172],"[",["T_CONSTANT_ENCAPSED_STRING","'*'",172],"]",";",["T_WHITESPACE","\n                ",172],"}",["T_WHITESPACE"," ",173],["T_ELSE","else",173],["T_WHITESPACE"," ",173],"{",["T_WHITESPACE","\n                    ",173],["T_VARIABLE","$format",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_STRING","array_shift",174],"(",["T_VARIABLE","$format",174],")",";",["T_WHITESPACE","\n                    ",174],["T_THROW","throw",175],["T_WHITESPACE"," ",175],["T_NEW","new",175],["T_WHITESPACE"," ",175],["T_STRING","http",175],["T_NS_SEPARATOR","\\",175],["T_STRING","BadMethod",175],"(",["T_WHITESPACE","\n                        ",175],["T_VARIABLE","$this",176],",",["T_WHITESPACE"," ",176],["T_STRING","array_keys",176],"(",["T_VARIABLE","$response",176],")",["T_WHITESPACE","\n                    ",176],")",";",["T_WHITESPACE","\n                ",177],"}",["T_WHITESPACE","\n                ",178],["T_COMMENT","\/\/ handle a callback\n",179],["T_WHITESPACE","                ",180],["T_IF","if",180],["T_WHITESPACE"," ",180],"(",["T_STRING","is_callable",180],"(",["T_VARIABLE","$out",180],")",")",["T_WHITESPACE"," ",180],"{",["T_WHITESPACE","\n                    ",180],["T_VARIABLE","$out",181],["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_VARIABLE","$out",181],"(",["T_VARIABLE","$this",181],",",["T_WHITESPACE"," ",181],["T_VARIABLE","$args",181],")",";",["T_WHITESPACE","\n                ",181],"}",["T_WHITESPACE","\n                ",182],["T_IF","if",183],["T_WHITESPACE"," ",183],"(",["T_STRING","is_array",183],"(",["T_VARIABLE","$out",183],")",["T_WHITESPACE"," ",183],["T_BOOLEAN_AND","&&",183],["T_WHITESPACE"," ",183],"!",["T_ISSET","isset",183],"(",["T_VARIABLE","$out",183],"[",["T_CONSTANT_ENCAPSED_STRING","'view'",183],"]",")",")",["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n                    ",183],["T_IF","if",184],["T_WHITESPACE"," ",184],"(",["T_WHITESPACE"," ",184],"!",["T_STRING","is_array",184],"(",["T_VARIABLE","$format",184],")",["T_WHITESPACE"," ",184],")",["T_WHITESPACE"," ",184],["T_VARIABLE","$format",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_ARRAY","array",184],"(",["T_VARIABLE","$format",184],")",";",["T_WHITESPACE","\n                    ",184],["T_VARIABLE","$outFormats",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_STRING","array_keys",185],"(",["T_VARIABLE","$out",185],")",";",["T_WHITESPACE","\n                    ",185],["T_COMMENT","\/\/ handle the response type\n",186],["T_WHITESPACE","                    ",187],["T_FOREACH","foreach",187],"(",["T_WHITESPACE"," ",187],["T_VARIABLE","$format",187],["T_WHITESPACE"," ",187],["T_AS","as",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$type",187],["T_WHITESPACE"," ",187],")",["T_WHITESPACE"," ",187],"{",["T_WHITESPACE","\n                        ",187],["T_IF","if",188],["T_WHITESPACE"," ",188],"(",["T_WHITESPACE"," ",188],["T_VARIABLE","$type",188],["T_WHITESPACE"," ",188],["T_IS_IDENTICAL","===",188],["T_WHITESPACE"," ",188],["T_CONSTANT_ENCAPSED_STRING","'*'",188],["T_WHITESPACE"," ",188],")",["T_WHITESPACE"," ",188],"{",["T_WHITESPACE","\n                            ",188],["T_VARIABLE","$format",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_VARIABLE","$outFormats",189],"[",["T_LNUMBER","0",189],"]",";",["T_WHITESPACE","\n                            ",189],["T_VARIABLE","$out",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_VARIABLE","$out",190],"[",["T_VARIABLE","$format",190],"]",";",["T_WHITESPACE","\n                            ",190],["T_BREAK","break",191],";",["T_WHITESPACE","\n                        ",191],"}",["T_WHITESPACE"," ",192],["T_ELSEIF","elseif",192],"(",["T_ISSET","isset",192],"(",["T_VARIABLE","$out",192],"[",["T_VARIABLE","$type",192],"]",")",["T_WHITESPACE"," ",192],")",["T_WHITESPACE"," ",192],"{",["T_WHITESPACE","\n                            ",192],["T_VARIABLE","$format",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_VARIABLE","$type",193],";",["T_WHITESPACE","\n                            ",193],["T_VARIABLE","$out",194],["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],["T_VARIABLE","$out",194],"[",["T_VARIABLE","$format",194],"]",";",["T_WHITESPACE","\n                            ",194],["T_BREAK","break",195],";",["T_WHITESPACE","\n                        ",195],"}",["T_WHITESPACE","\n                    ",196],"}",["T_WHITESPACE","\n                    ",197],["T_COMMENT","\/\/ matching not found\n",198],["T_WHITESPACE","                    ",199],["T_IF","if",199],["T_WHITESPACE"," ",199],"(",["T_WHITESPACE"," ",199],["T_STRING","is_array",199],"(",["T_VARIABLE","$format",199],")",")",["T_WHITESPACE"," ",199],"{",["T_WHITESPACE","\n                        ",199],["T_VARIABLE","$format",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_STRING","array_shift",200],"(",["T_VARIABLE","$format",200],")",";",["T_WHITESPACE","\n                        ",200],["T_THROW","throw",201],["T_WHITESPACE"," ",201],["T_NEW","new",201],["T_WHITESPACE"," ",201],["T_STRING","http",201],["T_NS_SEPARATOR","\\",201],["T_STRING","BadFormat",201],"(",["T_WHITESPACE","\n                            ",201],["T_VARIABLE","$this",202],",",["T_WHITESPACE"," ",202],["T_VARIABLE","$outFormats",202],["T_WHITESPACE","\n                        ",202],")",";",["T_WHITESPACE","\n                    ",203],"}",["T_WHITESPACE","\n                ",204],"}",["T_WHITESPACE"," ",205],["T_ELSE","else",205],["T_WHITESPACE"," ",205],"{",["T_WHITESPACE","\n                    ",205],["T_VARIABLE","$format",206],["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],["T_STRING","array_shift",206],"(",["T_VARIABLE","$format",206],")",";",["T_WHITESPACE","\n                ",206],"}",["T_WHITESPACE","\n                ",207],["T_IF","if",208],["T_WHITESPACE"," ",208],"(",["T_STRING","is_callable",208],"(",["T_VARIABLE","$out",208],")",")",["T_WHITESPACE"," ",208],"{",["T_WHITESPACE","\n                    ",208],["T_VARIABLE","$response",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_VARIABLE","$out",209],"(",["T_VARIABLE","$this",209],",",["T_WHITESPACE"," ",209],["T_VARIABLE","$args",209],")",";",["T_WHITESPACE","\n                ",209],"}",["T_WHITESPACE"," ",210],["T_ELSE","else",210],["T_WHITESPACE"," ",210],"{",["T_WHITESPACE","\n                    ",210],["T_VARIABLE","$response",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_VARIABLE","$out",211],";",["T_WHITESPACE","\n                ",211],"}",["T_WHITESPACE","\n            ",212],"}",["T_WHITESPACE"," ",213],["T_ELSE","else",213],["T_WHITESPACE"," ",213],"{",["T_WHITESPACE","\n                ",213],["T_VARIABLE","$format",214],["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_STRING","array_shift",214],"(",["T_VARIABLE","$format",214],")",";",["T_WHITESPACE","\n            ",214],"}",["T_WHITESPACE","\n        ",215],"}",["T_WHITESPACE"," ",216],["T_ELSE","else",216],["T_WHITESPACE"," ",216],"{",["T_WHITESPACE","\n            ",216],["T_VARIABLE","$format",217],["T_WHITESPACE"," ",217],"=",["T_WHITESPACE"," ",217],["T_STRING","array_shift",217],"(",["T_VARIABLE","$format",217],")",";",["T_WHITESPACE","\n        ",217],"}",["T_WHITESPACE","\n        ",218],["T_RETURN","return",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$response",219],";",["T_WHITESPACE","\n    ",219],"}",["T_WHITESPACE","\n\n    ",220],["T_DOC_COMMENT","\/**\n     * Comparing format types\n     *\/",222],["T_WHITESPACE","\n    ",224],["T_PUBLIC","public",225],["T_WHITESPACE"," ",225],["T_FUNCTION","function",225],["T_WHITESPACE"," ",225],["T_STRING","isFormat",225],"(",["T_WHITESPACE"," ",225],["T_VARIABLE","$format",225],",",["T_WHITESPACE"," ",225],["T_VARIABLE","$compare",225],["T_WHITESPACE"," ",225],")",["T_WHITESPACE"," ",225],"{",["T_WHITESPACE","\n        ",225],["T_VARIABLE","$compare",226],["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_STRING","strtolower",226],"(",["T_VARIABLE","$compare",226],")",";",["T_WHITESPACE","\n        ",226],["T_VARIABLE","$format",227],["T_WHITESPACE"," ",227],"=",["T_WHITESPACE"," ",227],["T_STRING","strtolower",227],"(",["T_VARIABLE","$format",227],")",";",["T_WHITESPACE","\n        ",227],["T_IF","if",228],["T_WHITESPACE"," ",228],"(",["T_WHITESPACE"," ",228],["T_VARIABLE","$format",228],["T_WHITESPACE"," ",228],["T_IS_IDENTICAL","===",228],["T_WHITESPACE"," ",228],["T_VARIABLE","$compare",228],["T_WHITESPACE"," ",228],")",["T_WHITESPACE"," ",228],["T_RETURN","return",228],["T_WHITESPACE"," ",228],["T_STRING","true",228],";",["T_WHITESPACE","\n        ",228],["T_IF","if",229],["T_WHITESPACE"," ",229],"(",["T_WHITESPACE"," ",229],["T_STRING","substr",229],"(",["T_VARIABLE","$format",229],",",["T_WHITESPACE"," ",229],"-",["T_STRING","strlen",229],"(",["T_VARIABLE","$compare",229],")",")",["T_WHITESPACE"," ",229],["T_IS_IDENTICAL","===",229],["T_WHITESPACE"," ",229],["T_VARIABLE","$compare",229],")",["T_WHITESPACE"," ",229],["T_RETURN","return",229],["T_WHITESPACE"," ",229],["T_STRING","true",229],";",["T_WHITESPACE","\n        ",229],["T_IF","if",230],["T_WHITESPACE"," ",230],"(",["T_WHITESPACE"," ",230],["T_VARIABLE","$compare",230],["T_WHITESPACE"," ",230],["T_IS_IDENTICAL","===",230],["T_WHITESPACE"," ",230],["T_CONSTANT_ENCAPSED_STRING","'rss'",230],["T_WHITESPACE"," ",230],")",["T_WHITESPACE"," ",230],"{",["T_WHITESPACE","\n            ",230],["T_RETURN","return",231],["T_WHITESPACE"," ",231],"(",["T_WHITESPACE","\n                ",231],["T_VARIABLE","$format",232],["T_WHITESPACE"," ",232],["T_IS_IDENTICAL","===",232],["T_WHITESPACE"," ",232],["T_CONSTANT_ENCAPSED_STRING","'application\/rss+xml'",232],["T_WHITESPACE","\n                ",232],["T_BOOLEAN_OR","||",233],["T_WHITESPACE"," ",233],["T_VARIABLE","$format",233],["T_WHITESPACE"," ",233],["T_IS_IDENTICAL","===",233],["T_WHITESPACE"," ",233],["T_CONSTANT_ENCAPSED_STRING","'application\/rdf+xml'",233],["T_WHITESPACE","\n                ",233],["T_BOOLEAN_OR","||",234],["T_WHITESPACE"," ",234],["T_VARIABLE","$format",234],["T_WHITESPACE"," ",234],["T_IS_IDENTICAL","===",234],["T_WHITESPACE"," ",234],["T_CONSTANT_ENCAPSED_STRING","'application\/atom+xml'",234],["T_WHITESPACE","\n            ",234],")",";",["T_WHITESPACE","\n        ",235],"}",["T_WHITESPACE","\n        ",236],["T_RETURN","return",237],["T_WHITESPACE"," ",237],["T_STRING","false",237],";",["T_WHITESPACE","\n    ",237],"}",["T_WHITESPACE","\n    ",238],["T_DOC_COMMENT","\/**\n     * Renders the response to the specified format\n     * @param mixed $response\n     * @param string $format\n     * @return string\n     *\/",239],["T_WHITESPACE","\n    ",244],["T_PUBLIC","public",245],["T_WHITESPACE"," ",245],["T_FUNCTION","function",245],["T_WHITESPACE"," ",245],["T_STRING","renderResponse",245],"(",["T_VARIABLE","$response",245],",",["T_WHITESPACE"," ",245],["T_VARIABLE","$format",245],")",["T_WHITESPACE","\n    ",245],"{",["T_WHITESPACE","\n        ",246],["T_COMMENT","\/\/ renders the template\n",247],["T_WHITESPACE","        ",248],["T_SWITCH","switch",248],["T_WHITESPACE"," ",248],"(",["T_VARIABLE","$format",248],")",["T_WHITESPACE"," ",248],"{",["T_WHITESPACE","\n            ",248],["T_CASE","case",249],["T_WHITESPACE"," ",249],["T_CONSTANT_ENCAPSED_STRING","'html'",249],":",["T_WHITESPACE","\n            ",249],["T_CASE","case",250],["T_WHITESPACE"," ",250],["T_CONSTANT_ENCAPSED_STRING","'text\/html'",250],":",["T_WHITESPACE","\n                ",250],["T_STRING","defined",251],"(",["T_CONSTANT_ENCAPSED_STRING","'PROFILE_ENABLED'",251],")",["T_WHITESPACE"," ",251],["T_LOGICAL_OR","or",251],["T_WHITESPACE"," ",251],["T_STRING","define",251],"(",["T_CONSTANT_ENCAPSED_STRING","'PROFILE_ENABLED'",251],",",["T_WHITESPACE"," ",251],["T_STRING","true",251],")",";",["T_WHITESPACE","\n                ",251],["T_RETURN","return",252],["T_WHITESPACE"," ",252],["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","renderHtml",252],"(",["T_VARIABLE","$response",252],")",";",["T_WHITESPACE","\n            ",252],["T_CASE","case",253],["T_WHITESPACE"," ",253],["T_CONSTANT_ENCAPSED_STRING","'json'",253],":",["T_WHITESPACE","\n            ",253],["T_CASE","case",254],["T_WHITESPACE"," ",254],["T_CONSTANT_ENCAPSED_STRING","'application\/json'",254],":",["T_WHITESPACE","\n                ",254],["T_RETURN","return",255],["T_WHITESPACE"," ",255],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","renderJson",255],"(",["T_VARIABLE","$response",255],")",";",["T_WHITESPACE","\n            ",255],["T_CASE","case",256],["T_WHITESPACE"," ",256],["T_CONSTANT_ENCAPSED_STRING","'xml'",256],":",["T_WHITESPACE","\n            ",256],["T_CASE","case",257],["T_WHITESPACE"," ",257],["T_CONSTANT_ENCAPSED_STRING","'text\/xml'",257],":",["T_WHITESPACE","\n            ",257],["T_CASE","case",258],["T_WHITESPACE"," ",258],["T_CONSTANT_ENCAPSED_STRING","'application\/xml'",258],":",["T_WHITESPACE","\n                ",258],["T_RETURN","return",259],["T_WHITESPACE"," ",259],["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","renderXml",259],"(",["T_VARIABLE","$response",259],")",";",["T_WHITESPACE","\n            ",259],["T_CASE","case",260],["T_WHITESPACE"," ",260],["T_CONSTANT_ENCAPSED_STRING","'rss'",260],":",["T_WHITESPACE","\n            ",260],["T_CASE","case",261],["T_WHITESPACE"," ",261],["T_CONSTANT_ENCAPSED_STRING","'application\/rss'",261],":",["T_WHITESPACE","\n            ",261],["T_CASE","case",262],["T_WHITESPACE"," ",262],["T_CONSTANT_ENCAPSED_STRING","'application\/rss+xml'",262],":",["T_WHITESPACE","\n            ",262],["T_CASE","case",263],["T_WHITESPACE"," ",263],["T_CONSTANT_ENCAPSED_STRING","'application\/rdf+xml'",263],":",["T_WHITESPACE","\n            ",263],["T_CASE","case",264],["T_WHITESPACE"," ",264],["T_CONSTANT_ENCAPSED_STRING","'application\/atom+xml'",264],":",["T_WHITESPACE","\n                ",264],["T_RETURN","return",265],["T_WHITESPACE"," ",265],["T_VARIABLE","$this",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","renderRss",265],"(",["T_VARIABLE","$response",265],")",";",["T_WHITESPACE","\n            ",265],["T_DEFAULT","default",266],":",["T_WHITESPACE","\n                ",266],["T_IF","if",267],["T_WHITESPACE"," ",267],"(",["T_WHITESPACE"," ",267],["T_STRING","strpos",267],"(",["T_WHITESPACE"," ",267],["T_VARIABLE","$format",267],",",["T_WHITESPACE"," ",267],["T_CONSTANT_ENCAPSED_STRING","'\/'",267],["T_WHITESPACE"," ",267],")",["T_WHITESPACE"," ",267],["T_IS_IDENTICAL","===",267],["T_WHITESPACE"," ",267],["T_STRING","false",267],["T_WHITESPACE"," ",267],")",["T_WHITESPACE"," ",267],"{",["T_WHITESPACE","\n                    ",267],["T_VARIABLE","$formats",268],["T_WHITESPACE"," ",268],"=",["T_WHITESPACE"," ",268],["T_VARIABLE","$this",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","getRequest",268],"(",")",["T_OBJECT_OPERATOR","->",268],["T_STRING","getResponseType",268],"(",")",";",["T_WHITESPACE","\n                    ",268],["T_IF","if",269],["T_WHITESPACE"," ",269],"(",["T_WHITESPACE"," ",269],["T_VARIABLE","$offset",269],["T_WHITESPACE"," ",269],"=",["T_WHITESPACE"," ",269],["T_STRING","array_search",269],"(",["T_VARIABLE","$format",269],",",["T_WHITESPACE"," ",269],["T_VARIABLE","$formats",269],")",["T_WHITESPACE"," ",269],")",["T_WHITESPACE"," ",269],"{",["T_WHITESPACE","\n                        ",269],["T_VARIABLE","$format",270],["T_WHITESPACE"," ",270],"=",["T_WHITESPACE"," ",270],["T_VARIABLE","$formats",270],"[",["T_WHITESPACE"," ",270],["T_VARIABLE","$offset",270],["T_WHITESPACE"," ",270],"-",["T_WHITESPACE"," ",270],["T_LNUMBER","1",270],"]",";",["T_WHITESPACE","\n                    ",270],"}",["T_WHITESPACE","\n                ",271],"}",["T_WHITESPACE","\n                ",272],["T_IF","if",273],["T_WHITESPACE"," ",273],"(",["T_WHITESPACE"," ",273],["T_STRING","strpos",273],"(",["T_WHITESPACE"," ",273],["T_VARIABLE","$format",273],",",["T_WHITESPACE"," ",273],["T_CONSTANT_ENCAPSED_STRING","'\/'",273],["T_WHITESPACE"," ",273],")",["T_WHITESPACE"," ",273],["T_IS_NOT_IDENTICAL","!==",273],["T_WHITESPACE"," ",273],["T_STRING","false",273],["T_WHITESPACE"," ",273],")",["T_WHITESPACE"," ",273],"{",["T_WHITESPACE","\n                    ",273],["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","getResponse",274],"(",")",["T_OBJECT_OPERATOR","->",274],["T_STRING","setHeader",274],"(",["T_WHITESPACE","\n                        ",274],["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",275],",",["T_WHITESPACE"," ",275],["T_VARIABLE","$format",275],["T_WHITESPACE","\n                    ",275],")",";",["T_WHITESPACE","\n                    ",276],["T_RETURN","return",277],["T_WHITESPACE"," ",277],["T_VARIABLE","$response",277],";",["T_WHITESPACE","\n                ",277],"}",["T_WHITESPACE","\n                ",278],["T_THROW","throw",279],["T_WHITESPACE"," ",279],["T_NEW","new",279],["T_WHITESPACE"," ",279],["T_STRING","http",279],["T_NS_SEPARATOR","\\",279],["T_STRING","BadFormat",279],"(",["T_WHITESPACE","\n                    ",279],["T_VARIABLE","$this",280],",",["T_WHITESPACE"," ",280],["T_ARRAY","array",280],"(",["T_CONSTANT_ENCAPSED_STRING","'html'",280],",",["T_WHITESPACE"," ",280],["T_CONSTANT_ENCAPSED_STRING","'json'",280],",",["T_WHITESPACE"," ",280],["T_CONSTANT_ENCAPSED_STRING","'xml'",280],",",["T_WHITESPACE"," ",280],["T_CONSTANT_ENCAPSED_STRING","'rss'",280],")",["T_WHITESPACE","\n                ",280],")",";",["T_WHITESPACE","\n        ",281],"}",["T_WHITESPACE","\n    ",282],"}",["T_WHITESPACE","\n\n    ",283],["T_DOC_COMMENT","\/**\n     * Dispatching the specified request\n     * @param string $url\n     * @param array $params\n     *\/",285],["T_WHITESPACE","\n    ",289],["T_PUBLIC","public",290],["T_WHITESPACE"," ",290],["T_FUNCTION","function",290],["T_WHITESPACE"," ",290],["T_STRING","dispatch",290],"(",["T_WHITESPACE","\n        ",290],["T_VARIABLE","$method",291],["T_WHITESPACE"," ",291],"=",["T_WHITESPACE"," ",291],["T_STRING","null",291],",",["T_WHITESPACE"," ",291],["T_VARIABLE","$url",291],["T_WHITESPACE"," ",291],"=",["T_WHITESPACE"," ",291],["T_STRING","null",291],",",["T_WHITESPACE","\n        ",291],["T_ARRAY","array",292],["T_WHITESPACE"," ",292],["T_VARIABLE","$params",292],["T_WHITESPACE"," ",292],"=",["T_WHITESPACE"," ",292],["T_STRING","null",292],",",["T_WHITESPACE"," ",292],["T_VARIABLE","$format",292],["T_WHITESPACE"," ",292],"=",["T_WHITESPACE"," ",292],["T_STRING","null",292],["T_WHITESPACE","\n    ",292],")",["T_WHITESPACE","\n    ",293],"{",["T_WHITESPACE","\n        ",294],["T_VARIABLE","$params",295],["T_WHITESPACE"," ",295],"=",["T_WHITESPACE"," ",295],["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","_loadParameters",295],"(",["T_VARIABLE","$params",295],")",";",["T_WHITESPACE","\n        ",295],["T_IF","if",296],["T_WHITESPACE"," ",296],"(",["T_STRING","is_null",296],"(",["T_VARIABLE","$method",296],")",")",["T_WHITESPACE","\n            ",296],["T_VARIABLE","$method",297],["T_WHITESPACE"," ",297],"=",["T_WHITESPACE"," ",297],["T_VARIABLE","$this",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","getRequest",297],"(",")",["T_OBJECT_OPERATOR","->",297],["T_STRING","getMethod",297],"(",")",";",["T_WHITESPACE","\n        ",297],["T_IF","if",298],["T_WHITESPACE"," ",298],"(",["T_STRING","is_null",298],"(",["T_VARIABLE","$format",298],")",")",["T_WHITESPACE","\n            ",298],["T_VARIABLE","$format",299],["T_WHITESPACE"," ",299],"=",["T_WHITESPACE"," ",299],["T_VARIABLE","$this",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","getRequest",299],"(",")",["T_OBJECT_OPERATOR","->",299],["T_STRING","getResponseType",299],"(",")",";",["T_WHITESPACE","\n        ",299],["T_TRY","try",300],["T_WHITESPACE"," ",300],"{",["T_WHITESPACE","\n            ",300],["T_VARIABLE","$response",301],["T_WHITESPACE"," ",301],"=",["T_WHITESPACE"," ",301],["T_STRING","parent",301],["T_DOUBLE_COLON","::",301],["T_STRING","dispatch",301],"(",["T_VARIABLE","$method",301],",",["T_WHITESPACE"," ",301],["T_VARIABLE","$url",301],",",["T_WHITESPACE"," ",301],["T_VARIABLE","$params",301],")",";",["T_WHITESPACE","\n            ",301],["T_VARIABLE","$response",302],["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],["T_VARIABLE","$this",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","renderResponse",302],"(",["T_WHITESPACE","\n                ",302],["T_VARIABLE","$this",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","processResponse",303],"(",["T_VARIABLE","$response",303],",",["T_WHITESPACE"," ",303],["T_VARIABLE","$method",303],",",["T_WHITESPACE"," ",303],["T_VARIABLE","$format",303],",",["T_WHITESPACE"," ",303],["T_VARIABLE","$params",303],")",["T_WHITESPACE","\n                ",303],",",["T_WHITESPACE"," ",304],["T_VARIABLE","$format",304],["T_WHITESPACE","\n            ",304],")",";",["T_WHITESPACE","\n        ",305],"}",["T_WHITESPACE"," ",306],["T_CATCH","catch",306],["T_WHITESPACE"," ",306],"(",["T_NS_SEPARATOR","\\",306],["T_STRING","Exception",306],["T_WHITESPACE"," ",306],["T_VARIABLE","$ex",306],")",["T_WHITESPACE"," ",306],"{",["T_WHITESPACE","\n            ",306],["T_IF","if",307],["T_WHITESPACE"," ",307],"(",["T_WHITESPACE"," ",307],["T_STRING","is_array",307],"(",["T_VARIABLE","$format",307],")",["T_WHITESPACE"," ",307],")",["T_WHITESPACE"," ",307],"{",["T_WHITESPACE","\n                ",307],["T_VARIABLE","$format",308],["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],["T_STRING","array_shift",308],"(",["T_VARIABLE","$format",308],")",";",["T_WHITESPACE","\n            ",308],"}",["T_WHITESPACE","\n            ",309],["T_VARIABLE","$this",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","getResponse",310],"(",")",["T_OBJECT_OPERATOR","->",310],["T_STRING","setHeader",310],"(",["T_WHITESPACE","\n                ",310],["T_CONSTANT_ENCAPSED_STRING","'X-Format'",311],",",["T_WHITESPACE"," ",311],["T_VARIABLE","$format",311],["T_WHITESPACE","\n            ",311],")",";",["T_WHITESPACE","\n            ",312],["T_COMMENT","\/\/ general exception catch\n",313],["T_WHITESPACE","            ",314],["T_IF","if",314],["T_WHITESPACE"," ",314],"(",["T_VARIABLE","$ex",314],["T_WHITESPACE"," ",314],["T_INSTANCEOF","instanceof",314],["T_WHITESPACE"," ",314],["T_STRING","Exception",314],["T_WHITESPACE"," ",314],["T_BOOLEAN_AND","&&",314],["T_WHITESPACE"," ",314],"!",["T_VARIABLE","$ex",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","isHttpError",314],"(",")",")",["T_WHITESPACE"," ",314],"{",["T_WHITESPACE","\n                ",314],["T_COMMENT","\/\/ @todo decide what to show ?\n",315],["T_WHITESPACE","                ",316],["T_VARIABLE","$response",316],["T_WHITESPACE"," ",316],"=",["T_WHITESPACE"," ",316],["T_STRING","null",316],";",["T_WHITESPACE","\n                ",316],["T_VARIABLE","$this",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","getResponse",317],"(",")",["T_OBJECT_OPERATOR","->",317],["T_STRING","setCode",317],"(",["T_WHITESPACE","\n                    ",317],["T_VARIABLE","$ex",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","getCode",318],"(",")",",",["T_WHITESPACE"," ",318],["T_VARIABLE","$ex",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","getHttpMessage",318],"(",")",["T_WHITESPACE","\n                ",318],")",";",["T_WHITESPACE","\n                ",319],["T_IF","if",320],["T_WHITESPACE"," ",320],"(",["T_VARIABLE","$ex",320],["T_WHITESPACE"," ",320],["T_INSTANCEOF","instanceof",320],["T_WHITESPACE"," ",320],["T_STRING","http",320],["T_NS_SEPARATOR","\\",320],["T_STRING","Redirect",320],")",["T_WHITESPACE"," ",320],"{",["T_WHITESPACE","\n                    ",320],["T_IF","if",321],["T_WHITESPACE"," ",321],"(",["T_WHITESPACE"," ",321],["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","isFormat",321],"(",["T_VARIABLE","$format",321],",",["T_WHITESPACE"," ",321],["T_CONSTANT_ENCAPSED_STRING","'json'",321],")",["T_WHITESPACE"," ",321],")",["T_WHITESPACE"," ",321],"{",["T_WHITESPACE","\n                        ",321],["T_VARIABLE","$this",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","getResponse",322],"(",")",["T_OBJECT_OPERATOR","->",322],["T_STRING","setCode",322],"(",["T_WHITESPACE","\n                            ",322],["T_LNUMBER","200",323],",",["T_WHITESPACE"," ",323],["T_CONSTANT_ENCAPSED_STRING","'OK'",323],["T_WHITESPACE","\n                        ",323],")",";",["T_WHITESPACE","\n                        ",324],["T_VARIABLE","$response",325],["T_WHITESPACE"," ",325],"=",["T_WHITESPACE"," ",325],["T_VARIABLE","$this",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","renderResponse",325],"(",["T_WHITESPACE","\n                            ",325],["T_ARRAY","array",326],"(",["T_WHITESPACE","\n                            ",326],["T_CONSTANT_ENCAPSED_STRING","'redirect'",327],["T_WHITESPACE"," ",327],["T_DOUBLE_ARROW","=>",327],["T_WHITESPACE"," ",327],["T_VARIABLE","$ex",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","getUrl",327],"(",")",["T_WHITESPACE","\n                            ",327],")",",",["T_WHITESPACE"," ",328],["T_VARIABLE","$format",328],["T_WHITESPACE","\n                        ",328],")",";",["T_WHITESPACE","\n                    ",329],"}",["T_WHITESPACE"," ",330],["T_ELSE","else",330],["T_WHITESPACE"," ",330],"{",["T_WHITESPACE","\n                        ",330],["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","getResponse",331],"(",")",["T_OBJECT_OPERATOR","->",331],["T_STRING","setHeader",331],"(",["T_WHITESPACE","\n                            ",331],["T_CONSTANT_ENCAPSED_STRING","'Location'",332],",",["T_WHITESPACE"," ",332],["T_VARIABLE","$ex",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","getUrl",332],"(",")",["T_WHITESPACE","\n                        ",332],")",";",["T_WHITESPACE","\n                    ",333],"}",["T_WHITESPACE","\n                ",334],"}",["T_WHITESPACE","\n            ",335],"}",["T_WHITESPACE"," ",336],["T_ELSE","else",336],["T_WHITESPACE"," ",336],"{",["T_WHITESPACE","\n                ",336],["T_VARIABLE","$msg",337],["T_WHITESPACE"," ",337],"=",["T_WHITESPACE"," ",337],["T_STRING","explode",337],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",337],",",["T_WHITESPACE"," ",337],["T_STRING","trim",337],"(",["T_VARIABLE","$ex",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","getMessage",337],"(",")",["T_WHITESPACE"," ",337],")",")",";",["T_WHITESPACE","\n                ",337],["T_STRING","trigger_error",338],"(",["T_WHITESPACE","\n                    ",338],["T_VARIABLE","$this",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","getRequest",339],"(",")",["T_OBJECT_OPERATOR","->",339],["T_STRING","getLocation",339],"(",")",["T_WHITESPACE","\n                    ",339],".",["T_WHITESPACE"," ",340],["T_CONSTANT_ENCAPSED_STRING","' -> '",340],["T_WHITESPACE","\n                    ",340],".",["T_WHITESPACE"," ",341],["T_VARIABLE","$ex",341],["T_OBJECT_OPERATOR","->",341],["T_STRING","getMessage",341],"(",")",["T_WHITESPACE"," ",341],".",["T_WHITESPACE"," ",341],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",341],["T_WHITESPACE","\n                    ",341],".",["T_WHITESPACE"," ",342],["T_VARIABLE","$ex",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","getFile",342],"(",")",["T_WHITESPACE"," ",342],".",["T_WHITESPACE"," ",342],["T_CONSTANT_ENCAPSED_STRING","':'",342],["T_WHITESPACE","\n                    ",342],".",["T_WHITESPACE"," ",343],["T_VARIABLE","$ex",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","getLine",343],"(",")",",",["T_WHITESPACE","\n                    ",343],["T_STRING","E_USER_WARNING",344],["T_WHITESPACE","\n                ",344],")",";",["T_WHITESPACE","\n                ",345],["T_STRING","header",346],"(",["T_CONSTANT_ENCAPSED_STRING","'X-Reason: '",346],["T_WHITESPACE"," ",346],".",["T_WHITESPACE"," ",346],["T_VARIABLE","$msg",346],"[",["T_LNUMBER","0",346],"]",["T_WHITESPACE"," ",346],")",";",["T_WHITESPACE","\n                ",346],["T_VARIABLE","$response",347],["T_WHITESPACE"," ",347],"=",["T_WHITESPACE"," ",347],["T_VARIABLE","$this",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","renderResponse",347],"(",["T_WHITESPACE","\n                    ",347],["T_VARIABLE","$this",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","renderError",348],"(",["T_VARIABLE","$ex",348],")",",",["T_WHITESPACE"," ",348],["T_VARIABLE","$format",348],["T_WHITESPACE","\n                ",348],")",";",["T_WHITESPACE","\n            ",349],"}",["T_WHITESPACE","\n        ",350],"}",["T_WHITESPACE","\n        ",351],["T_COMMENT","\/\/ flush the view instance\n",352],["T_WHITESPACE","        ",353],["T_RETURN","return",353],["T_WHITESPACE"," ",353],["T_VARIABLE","$response",353],";",["T_WHITESPACE","\n    ",353],"}",["T_WHITESPACE","\n\n",354],"}",["T_WHITESPACE","\n",356]]