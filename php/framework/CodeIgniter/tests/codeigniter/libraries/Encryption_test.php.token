[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_CLASS","class",3],["T_WHITESPACE"," ",3],["T_STRING","Encryption_test",3],["T_WHITESPACE"," ",3],["T_EXTENDS","extends",3],["T_WHITESPACE"," ",3],["T_STRING","CI_TestCase",3],["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\n\t",3],["T_PUBLIC","public",5],["T_WHITESPACE"," ",5],["T_FUNCTION","function",5],["T_WHITESPACE"," ",5],["T_STRING","set_up",5],"(",")",["T_WHITESPACE","\n\t",5],"{",["T_WHITESPACE","\n\t\t",6],["T_VARIABLE","$this",7],["T_OBJECT_OPERATOR","->",7],["T_STRING","encryption",7],["T_WHITESPACE"," ",7],"=",["T_WHITESPACE"," ",7],["T_NEW","new",7],["T_WHITESPACE"," ",7],["T_STRING","Mock_Libraries_Encryption",7],"(",")",";",["T_WHITESPACE","\n\t",7],"}",["T_WHITESPACE","\n\n\t",8],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",10],["T_WHITESPACE","\n\t",11],["T_DOC_COMMENT","\/**\n\t * __construct test\n\t *\n\t * Covers behavior with $config['encryption_key'] set or not\n\t *\/",12],["T_WHITESPACE","\n\t",16],["T_PUBLIC","public",17],["T_WHITESPACE"," ",17],["T_FUNCTION","function",17],["T_WHITESPACE"," ",17],["T_STRING","test___construct",17],"(",")",["T_WHITESPACE","\n\t",17],"{",["T_WHITESPACE","\n\t\t",18],["T_COMMENT","\/\/ Assume no configuration from set_up()\n",19],["T_WHITESPACE","\t\t",20],["T_VARIABLE","$this",20],["T_OBJECT_OPERATOR","->",20],["T_STRING","assertNull",20],"(",["T_VARIABLE","$this",20],["T_OBJECT_OPERATOR","->",20],["T_STRING","encryption",20],["T_OBJECT_OPERATOR","->",20],["T_STRING","get_key",20],"(",")",")",";",["T_WHITESPACE","\n\n\t\t",20],["T_COMMENT","\/\/ Try with an empty value\n",22],["T_WHITESPACE","\t\t",23],["T_VARIABLE","$this",23],["T_OBJECT_OPERATOR","->",23],["T_STRING","ci_set_config",23],"(",["T_CONSTANT_ENCAPSED_STRING","'encryption_key'",23],")",";",["T_WHITESPACE","\n\t\t",23],["T_VARIABLE","$this",24],["T_OBJECT_OPERATOR","->",24],["T_STRING","encrypt",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_NEW","new",24],["T_WHITESPACE"," ",24],["T_STRING","Mock_Libraries_Encryption",24],"(",")",";",["T_WHITESPACE","\n\t\t",24],["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","assertNull",25],"(",["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","encrypt",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","get_key",25],"(",")",")",";",["T_WHITESPACE","\n\n\t\t",25],["T_VARIABLE","$this",27],["T_OBJECT_OPERATOR","->",27],["T_STRING","ci_set_config",27],"(",["T_CONSTANT_ENCAPSED_STRING","'encryption_key'",27],",",["T_WHITESPACE"," ",27],["T_STRING","str_repeat",27],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\x0\"",27],",",["T_WHITESPACE"," ",27],["T_LNUMBER","16",27],")",")",";",["T_WHITESPACE","\n\t\t",27],["T_VARIABLE","$this",28],["T_OBJECT_OPERATOR","->",28],["T_STRING","encrypt",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_NEW","new",28],["T_WHITESPACE"," ",28],["T_STRING","Mock_Libraries_Encryption",28],"(",")",";",["T_WHITESPACE","\n\t\t",28],["T_VARIABLE","$this",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","assertEquals",29],"(",["T_STRING","str_repeat",29],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\x0\"",29],",",["T_WHITESPACE"," ",29],["T_LNUMBER","16",29],")",",",["T_WHITESPACE"," ",29],["T_VARIABLE","$this",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","encrypt",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","get_key",29],"(",")",")",";",["T_WHITESPACE","\n\t",29],"}",["T_WHITESPACE","\n\n\t",30],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",32],["T_WHITESPACE","\n\t",33],["T_DOC_COMMENT","\/**\n\t * hkdf() test\n\t *\n\t * Applies test vectors described in Appendix A(1-3) RFC5869.\n\t * Described vectors 4-7 SHA-1, which we don't support and are\n\t * therefore excluded.\n\t *\n\t * Because our implementation is a single method instead of being\n\t * split into hkdf_extract() and hkdf_expand(), we cannot test for\n\t * the PRK value. As long as the OKM is correct though, it's fine.\n\t *\n\t * @link\thttps:\/\/tools.ietf.org\/rfc\/rfc5869.txt\n\t *\/",34],["T_WHITESPACE","\n\t",46],["T_PUBLIC","public",47],["T_WHITESPACE"," ",47],["T_FUNCTION","function",47],["T_WHITESPACE"," ",47],["T_STRING","test_hkdf",47],"(",")",["T_WHITESPACE","\n\t",47],"{",["T_WHITESPACE","\n\t\t",48],["T_VARIABLE","$vectors",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_ARRAY","array",49],"(",["T_WHITESPACE","\n\t\t\t",49],["T_COMMENT","\/\/ A.1: Basic test case with SHA-256\n",50],["T_WHITESPACE","\t\t\t",51],["T_ARRAY","array",51],"(",["T_WHITESPACE","\n\t\t\t\t",51],["T_CONSTANT_ENCAPSED_STRING","'digest'",52],["T_WHITESPACE"," ",52],["T_DOUBLE_ARROW","=>",52],["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'sha256'",52],",",["T_WHITESPACE","\n\t\t\t\t",52],["T_CONSTANT_ENCAPSED_STRING","'ikm'",53],["T_WHITESPACE"," ",53],["T_DOUBLE_ARROW","=>",53],["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","\"\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\"",53],",",["T_WHITESPACE","\n\t\t\t\t",53],["T_CONSTANT_ENCAPSED_STRING","'salt'",54],["T_WHITESPACE"," ",54],["T_DOUBLE_ARROW","=>",54],["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","\"\\x00\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\"",54],",",["T_WHITESPACE","\n\t\t\t\t",54],["T_CONSTANT_ENCAPSED_STRING","'length'",55],["T_WHITESPACE"," ",55],["T_DOUBLE_ARROW","=>",55],["T_WHITESPACE"," ",55],["T_LNUMBER","42",55],",",["T_WHITESPACE","\n\t\t\t\t",55],["T_CONSTANT_ENCAPSED_STRING","'info'",56],["T_WHITESPACE"," ",56],["T_DOUBLE_ARROW","=>",56],["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","\"\\xf0\\xf1\\xf2\\xf3\\xf4\\xf5\\xf6\\xf7\\xf8\\xf9\"",56],",",["T_WHITESPACE","\n\t\t\t",56],["T_COMMENT","\/\/\t'prk' => \"\\x07\\x77\\x09\\x36\\x2c\\x2e\\x32\\xdf\\x0d\\xdc\\x3f\\x0d\\xc4\\x7b\\xba\\x63\\x90\\xb6\\xc7\\x3b\\xb5\\x0f\\x9c\\x31\\x22\\xec\\x84\\x4a\\xd7\\xc2\\xb3\\xe5\",\n",57],["T_WHITESPACE","\t\t\t\t",58],["T_CONSTANT_ENCAPSED_STRING","'okm'",58],["T_WHITESPACE"," ",58],["T_DOUBLE_ARROW","=>",58],["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","\"\\x3c\\xb2\\x5f\\x25\\xfa\\xac\\xd5\\x7a\\x90\\x43\\x4f\\x64\\xd0\\x36\\x2f\\x2a\\x2d\\x2d\\x0a\\x90\\xcf\\x1a\\x5a\\x4c\\x5d\\xb0\\x2d\\x56\\xec\\xc4\\xc5\\xbf\\x34\\x00\\x72\\x08\\xd5\\xb8\\x87\\x18\\x58\\x65\"",58],["T_WHITESPACE","\n\t\t\t",58],")",",",["T_WHITESPACE","\n\t\t\t",59],["T_COMMENT","\/\/ A.2: Test with SHA-256 and longer inputs\/outputs\n",60],["T_WHITESPACE","\t\t\t",61],["T_ARRAY","array",61],"(",["T_WHITESPACE","\n\t\t\t\t",61],["T_CONSTANT_ENCAPSED_STRING","'digest'",62],["T_WHITESPACE"," ",62],["T_DOUBLE_ARROW","=>",62],["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'sha256'",62],",",["T_WHITESPACE","\n\t\t\t\t",62],["T_CONSTANT_ENCAPSED_STRING","'ikm'",63],["T_WHITESPACE"," ",63],["T_DOUBLE_ARROW","=>",63],["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","\"\\x00\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\\x1a\\x1b\\x1c\\x1d\\x1e\\x1f\\x20\\x21\\x22\\x23\\x24\\x25\\x26\\x27\\x28\\x29\\x2a\\x2b\\x2c\\x2d\\x2e\\x2f\\x30\\x31\\x32\\x33\\x34\\x35\\x36\\x37\\x38\\x39\\x3a\\x3b\\x3c\\x3d\\x3e\\x3f\\x40\\x41\\x42\\x43\\x44\\x45\\x46\\x47\\x48\\x49\\x4a\\x4b\\x4c\\x4d\\x4e\\x4f\"",63],",",["T_WHITESPACE","\n\t\t\t\t",63],["T_CONSTANT_ENCAPSED_STRING","'salt'",64],["T_WHITESPACE"," ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","\"\\x60\\x61\\x62\\x63\\x64\\x65\\x66\\x67\\x68\\x69\\x6a\\x6b\\x6c\\x6d\\x6e\\x6f\\x70\\x71\\x72\\x73\\x74\\x75\\x76\\x77\\x78\\x79\\x7a\\x7b\\x7c\\x7d\\x7e\\x7f\\x80\\x81\\x82\\x83\\x84\\x85\\x86\\x87\\x88\\x89\\x8a\\x8b\\x8c\\x8d\\x8e\\x8f\\x90\\x91\\x92\\x93\\x94\\x95\\x96\\x97\\x98\\x99\\x9a\\x9b\\x9c\\x9d\\x9e\\x9f\\xa0\\xa1\\xa2\\xa3\\xa4\\xa5\\xa6\\xa7\\xa8\\xa9\\xaa\\xab\\xac\\xad\\xae\\xaf\"",64],",",["T_WHITESPACE","\n\t\t\t\t",64],["T_CONSTANT_ENCAPSED_STRING","'length'",65],["T_WHITESPACE"," ",65],["T_DOUBLE_ARROW","=>",65],["T_WHITESPACE"," ",65],["T_LNUMBER","82",65],",",["T_WHITESPACE","\n\t\t\t\t",65],["T_CONSTANT_ENCAPSED_STRING","'info'",66],["T_WHITESPACE"," ",66],["T_DOUBLE_ARROW","=>",66],["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","\"\\xb0\\xb1\\xb2\\xb3\\xb4\\xb5\\xb6\\xb7\\xb8\\xb9\\xba\\xbb\\xbc\\xbd\\xbe\\xbf\\xc0\\xc1\\xc2\\xc3\\xc4\\xc5\\xc6\\xc7\\xc8\\xc9\\xca\\xcb\\xcc\\xcd\\xce\\xcf\\xd0\\xd1\\xd2\\xd3\\xd4\\xd5\\xd6\\xd7\\xd8\\xd9\\xda\\xdb\\xdc\\xdd\\xde\\xdf\\xe0\\xe1\\xe2\\xe3\\xe4\\xe5\\xe6\\xe7\\xe8\\xe9\\xea\\xeb\\xec\\xed\\xee\\xef\\xf0\\xf1\\xf2\\xf3\\xf4\\xf5\\xf6\\xf7\\xf8\\xf9\\xfa\\xfb\\xfc\\xfd\\xfe\\xff\"",66],",",["T_WHITESPACE","\n\t\t\t",66],["T_COMMENT","\/\/\t'prk' => \"\\x06\\xa6\\xb8\\x8c\\x58\\x53\\x36\\x1a\\x06\\x10\\x4c\\x9c\\xeb\\x35\\xb4\\x5c\\xef\\x76\\x00\\x14\\x90\\x46\\x71\\x01\\x4a\\x19\\x3f\\x40\\xc1\\x5f\\xc2\\x44\",\n",67],["T_WHITESPACE","\t\t\t\t",68],["T_CONSTANT_ENCAPSED_STRING","'okm'",68],["T_WHITESPACE"," ",68],["T_DOUBLE_ARROW","=>",68],["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","\"\\xb1\\x1e\\x39\\x8d\\xc8\\x03\\x27\\xa1\\xc8\\xe7\\xf7\\x8c\\x59\\x6a\\x49\\x34\\x4f\\x01\\x2e\\xda\\x2d\\x4e\\xfa\\xd8\\xa0\\x50\\xcc\\x4c\\x19\\xaf\\xa9\\x7c\\x59\\x04\\x5a\\x99\\xca\\xc7\\x82\\x72\\x71\\xcb\\x41\\xc6\\x5e\\x59\\x0e\\x09\\xda\\x32\\x75\\x60\\x0c\\x2f\\x09\\xb8\\x36\\x77\\x93\\xa9\\xac\\xa3\\xdb\\x71\\xcc\\x30\\xc5\\x81\\x79\\xec\\x3e\\x87\\xc1\\x4c\\x01\\xd5\\xc1\\xf3\\x43\\x4f\\x1d\\x87\"",68],",",["T_WHITESPACE","\n\t\t\t",68],")",",",["T_WHITESPACE","\n\t\t\t",69],["T_COMMENT","\/\/ A.3: Test with SHA-256 and zero-length salt\/info\n",70],["T_WHITESPACE","\t\t\t",71],["T_ARRAY","array",71],"(",["T_WHITESPACE","\n\t\t\t\t",71],["T_CONSTANT_ENCAPSED_STRING","'digest'",72],["T_WHITESPACE"," ",72],["T_DOUBLE_ARROW","=>",72],["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'sha256'",72],",",["T_WHITESPACE","\n\t\t\t\t",72],["T_CONSTANT_ENCAPSED_STRING","'ikm'",73],["T_WHITESPACE"," ",73],["T_DOUBLE_ARROW","=>",73],["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","\"\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\"",73],",",["T_WHITESPACE","\n\t\t\t\t",73],["T_CONSTANT_ENCAPSED_STRING","'salt'",74],["T_WHITESPACE"," ",74],["T_DOUBLE_ARROW","=>",74],["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","''",74],",",["T_WHITESPACE","\n\t\t\t\t",74],["T_CONSTANT_ENCAPSED_STRING","'length'",75],["T_WHITESPACE"," ",75],["T_DOUBLE_ARROW","=>",75],["T_WHITESPACE"," ",75],["T_LNUMBER","42",75],",",["T_WHITESPACE","\n\t\t\t\t",75],["T_CONSTANT_ENCAPSED_STRING","'info'",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","''",76],",",["T_WHITESPACE","\n\t\t\t",76],["T_COMMENT","\/\/\t'prk' => \"\\x19\\xef\\x24\\xa3\\x2c\\x71\\x7b\\x16\\x7f\\x33\\xa9\\x1d\\x6f\\x64\\x8b\\xdf\\x96\\x59\\x67\\x76\\xaf\\xdb\\x63\\x77\\xac\\x43\\x4c\\x1c\\x29\\x3c\\xcb\\x04\",\n",77],["T_WHITESPACE","\t\t\t\t",78],["T_CONSTANT_ENCAPSED_STRING","'okm'",78],["T_WHITESPACE"," ",78],["T_DOUBLE_ARROW","=>",78],["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","\"\\x8d\\xa4\\xe7\\x75\\xa5\\x63\\xc1\\x8f\\x71\\x5f\\x80\\x2a\\x06\\x3c\\x5a\\x31\\xb8\\xa1\\x1f\\x5c\\x5e\\xe1\\x87\\x9e\\xc3\\x45\\x4e\\x5f\\x3c\\x73\\x8d\\x2d\\x9d\\x20\\x13\\x95\\xfa\\xa4\\xb6\\x1a\\x96\\xc8\"",78],",",["T_WHITESPACE","\n\t\t\t",78],")",["T_WHITESPACE","\n\t\t",79],")",";",["T_WHITESPACE","\n\n\t\t",80],["T_FOREACH","foreach",82],["T_WHITESPACE"," ",82],"(",["T_VARIABLE","$vectors",82],["T_WHITESPACE"," ",82],["T_AS","as",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$test",82],")",["T_WHITESPACE","\n\t\t",82],"{",["T_WHITESPACE","\n\t\t\t",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","assertEquals",84],"(",["T_WHITESPACE","\n\t\t\t\t",84],["T_VARIABLE","$test",85],"[",["T_CONSTANT_ENCAPSED_STRING","'okm'",85],"]",",",["T_WHITESPACE","\n\t\t\t\t",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","encryption",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","hkdf",86],"(",["T_WHITESPACE","\n\t\t\t\t\t",86],["T_VARIABLE","$test",87],"[",["T_CONSTANT_ENCAPSED_STRING","'ikm'",87],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",87],["T_VARIABLE","$test",88],"[",["T_CONSTANT_ENCAPSED_STRING","'digest'",88],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",88],["T_VARIABLE","$test",89],"[",["T_CONSTANT_ENCAPSED_STRING","'salt'",89],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",89],["T_VARIABLE","$test",90],"[",["T_CONSTANT_ENCAPSED_STRING","'length'",90],"]",",",["T_WHITESPACE","\n\t\t\t\t\t",90],["T_VARIABLE","$test",91],"[",["T_CONSTANT_ENCAPSED_STRING","'info'",91],"]",["T_WHITESPACE","\n\t\t\t\t",91],")",["T_WHITESPACE","\n\t\t\t",92],")",";",["T_WHITESPACE","\n\t\t",93],"}",["T_WHITESPACE","\n\n\t\t",94],["T_COMMENT","\/\/ Test default length, it must match the digest size\n",96],["T_WHITESPACE","\t\t",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","assertEquals",97],"(",["T_LNUMBER","64",97],",",["T_WHITESPACE"," ",97],["T_STRING","strlen",97],"(",["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","encryption",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","hkdf",97],"(",["T_CONSTANT_ENCAPSED_STRING","'foobar'",97],",",["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","'sha512'",97],")",")",")",";",["T_WHITESPACE","\n\n\t\t",97],["T_COMMENT","\/\/ Test maximum length (RFC5869 says that it must be up to 255 times the digest size)\n",99],["T_WHITESPACE","\t\t",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","assertEquals",100],"(",["T_LNUMBER","12240",100],",",["T_WHITESPACE"," ",100],["T_STRING","strlen",100],"(",["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","encryption",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","hkdf",100],"(",["T_CONSTANT_ENCAPSED_STRING","'foobar'",100],",",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","'sha384'",100],",",["T_WHITESPACE"," ",100],["T_STRING","NULL",100],",",["T_WHITESPACE"," ",100],["T_LNUMBER","48",100],["T_WHITESPACE"," ",100],"*",["T_WHITESPACE"," ",100],["T_LNUMBER","255",100],")",")",")",";",["T_WHITESPACE","\n\t\t",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","assertFalse",101],"(",["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","encryption",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","hkdf",101],"(",["T_CONSTANT_ENCAPSED_STRING","'foobar'",101],",",["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","'sha224'",101],",",["T_WHITESPACE"," ",101],["T_STRING","NULL",101],",",["T_WHITESPACE"," ",101],["T_LNUMBER","28",101],["T_WHITESPACE"," ",101],"*",["T_WHITESPACE"," ",101],["T_LNUMBER","255",101],["T_WHITESPACE"," ",101],"+",["T_WHITESPACE"," ",101],["T_LNUMBER","1",101],")",")",";",["T_WHITESPACE","\n\n\t\t",101],["T_COMMENT","\/\/ CI-specific test for an invalid digest\n",103],["T_WHITESPACE","\t\t",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","assertFalse",104],"(",["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","encryption",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","hkdf",104],"(",["T_CONSTANT_ENCAPSED_STRING","'fobar'",104],",",["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'sha1'",104],")",")",";",["T_WHITESPACE","\n\t",104],"}",["T_WHITESPACE","\n\n\t",105],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",107],["T_WHITESPACE","\n\t",108],["T_DOC_COMMENT","\/**\n\t * _get_params() test\n\t *\/",109],["T_WHITESPACE","\n\t",111],["T_PUBLIC","public",112],["T_WHITESPACE"," ",112],["T_FUNCTION","function",112],["T_WHITESPACE"," ",112],["T_STRING","test__get_params",112],"(",")",["T_WHITESPACE","\n\t",112],"{",["T_WHITESPACE","\n\t\t",113],["T_VARIABLE","$key",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_STRING","str_repeat",114],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\x0\"",114],",",["T_WHITESPACE"," ",114],["T_LNUMBER","16",114],")",";",["T_WHITESPACE","\n\n\t\t",114],["T_COMMENT","\/\/ Invalid custom parameters\n",116],["T_WHITESPACE","\t\t",117],["T_VARIABLE","$params",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_ARRAY","array",117],"(",["T_WHITESPACE","\n\t\t\t",117],["T_COMMENT","\/\/ No cipher, mode or key\n",118],["T_WHITESPACE","\t\t\t",119],["T_ARRAY","array",119],"(",["T_CONSTANT_ENCAPSED_STRING","'cipher'",119],["T_WHITESPACE"," ",119],["T_DOUBLE_ARROW","=>",119],["T_WHITESPACE"," ",119],["T_CONSTANT_ENCAPSED_STRING","'aes-128'",119],",",["T_WHITESPACE"," ",119],["T_CONSTANT_ENCAPSED_STRING","'mode'",119],["T_WHITESPACE"," ",119],["T_DOUBLE_ARROW","=>",119],["T_WHITESPACE"," ",119],["T_CONSTANT_ENCAPSED_STRING","'cbc'",119],")",",",["T_WHITESPACE","\n\t\t\t",119],["T_ARRAY","array",120],"(",["T_CONSTANT_ENCAPSED_STRING","'cipher'",120],["T_WHITESPACE"," ",120],["T_DOUBLE_ARROW","=>",120],["T_WHITESPACE"," ",120],["T_CONSTANT_ENCAPSED_STRING","'aes-128'",120],",",["T_WHITESPACE"," ",120],["T_CONSTANT_ENCAPSED_STRING","'key'",120],["T_WHITESPACE"," ",120],["T_DOUBLE_ARROW","=>",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$key",120],")",",",["T_WHITESPACE","\n\t\t\t",120],["T_ARRAY","array",121],"(",["T_CONSTANT_ENCAPSED_STRING","'mode'",121],["T_WHITESPACE"," ",121],["T_DOUBLE_ARROW","=>",121],["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","'cbc'",121],",",["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","'key'",121],["T_WHITESPACE"," ",121],["T_DOUBLE_ARROW","=>",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$key",121],")",",",["T_WHITESPACE","\n\t\t\t",121],["T_COMMENT","\/\/ No HMAC key or not a valid digest\n",122],["T_WHITESPACE","\t\t\t",123],["T_ARRAY","array",123],"(",["T_CONSTANT_ENCAPSED_STRING","'cipher'",123],["T_WHITESPACE"," ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'aes-128'",123],",",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'mode'",123],["T_WHITESPACE"," ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'cbc'",123],",",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'key'",123],["T_WHITESPACE"," ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$key",123],")",",",["T_WHITESPACE","\n\t\t\t",123],["T_ARRAY","array",124],"(",["T_CONSTANT_ENCAPSED_STRING","'cipher'",124],["T_WHITESPACE"," ",124],["T_DOUBLE_ARROW","=>",124],["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","'aes-128'",124],",",["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","'mode'",124],["T_WHITESPACE"," ",124],["T_DOUBLE_ARROW","=>",124],["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","'cbc'",124],",",["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","'key'",124],["T_WHITESPACE"," ",124],["T_DOUBLE_ARROW","=>",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$key",124],",",["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","'hmac_digest'",124],["T_WHITESPACE"," ",124],["T_DOUBLE_ARROW","=>",124],["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","'sha1'",124],",",["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","'hmac_key'",124],["T_WHITESPACE"," ",124],["T_DOUBLE_ARROW","=>",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$key",124],")",",",["T_WHITESPACE","\n\t\t\t",124],["T_COMMENT","\/\/ Invalid mode\n",125],["T_WHITESPACE","\t\t\t",126],["T_ARRAY","array",126],"(",["T_CONSTANT_ENCAPSED_STRING","'cipher'",126],["T_WHITESPACE"," ",126],["T_DOUBLE_ARROW","=>",126],["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'aes-128'",126],",",["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'mode'",126],["T_WHITESPACE"," ",126],["T_DOUBLE_ARROW","=>",126],["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'foo'",126],",",["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'key'",126],["T_WHITESPACE"," ",126],["T_DOUBLE_ARROW","=>",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$key",126],",",["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'hmac_digest'",126],["T_WHITESPACE"," ",126],["T_DOUBLE_ARROW","=>",126],["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'sha256'",126],",",["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'hmac_key'",126],["T_WHITESPACE"," ",126],["T_DOUBLE_ARROW","=>",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$key",126],")",["T_WHITESPACE","\n\t\t",126],")",";",["T_WHITESPACE","\n\n\t\t",127],["T_FOR","for",129],["T_WHITESPACE"," ",129],"(",["T_VARIABLE","$i",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_LNUMBER","0",129],",",["T_WHITESPACE"," ",129],["T_VARIABLE","$c",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_STRING","count",129],"(",["T_VARIABLE","$params",129],")",";",["T_WHITESPACE"," ",129],["T_VARIABLE","$i",129],["T_WHITESPACE"," ",129],"<",["T_WHITESPACE"," ",129],["T_VARIABLE","$c",129],";",["T_WHITESPACE"," ",129],["T_VARIABLE","$i",129],["T_INC","++",129],")",["T_WHITESPACE","\n\t\t",129],"{",["T_WHITESPACE","\n\t\t\t",130],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","assertFalse",131],"(",["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","encryption",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","__get_params",131],"(",["T_VARIABLE","$params",131],"[",["T_VARIABLE","$i",131],"]",")",")",";",["T_WHITESPACE","\n\t\t",131],"}",["T_WHITESPACE","\n\n\t\t",132],["T_COMMENT","\/\/ Valid parameters\n",134],["T_WHITESPACE","\t\t",135],["T_VARIABLE","$params",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_ARRAY","array",135],"(",["T_WHITESPACE","\n\t\t\t",135],["T_CONSTANT_ENCAPSED_STRING","'cipher'",136],["T_WHITESPACE"," ",136],["T_DOUBLE_ARROW","=>",136],["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","'aes-128'",136],",",["T_WHITESPACE","\n\t\t\t",136],["T_CONSTANT_ENCAPSED_STRING","'mode'",137],["T_WHITESPACE"," ",137],["T_DOUBLE_ARROW","=>",137],["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'cbc'",137],",",["T_WHITESPACE","\n\t\t\t",137],["T_CONSTANT_ENCAPSED_STRING","'key'",138],["T_WHITESPACE"," ",138],["T_DOUBLE_ARROW","=>",138],["T_WHITESPACE"," ",138],["T_STRING","str_repeat",138],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\x0\"",138],",",["T_WHITESPACE"," ",138],["T_LNUMBER","16",138],")",",",["T_WHITESPACE","\n\t\t\t",138],["T_CONSTANT_ENCAPSED_STRING","'hmac_key'",139],["T_WHITESPACE"," ",139],["T_DOUBLE_ARROW","=>",139],["T_WHITESPACE"," ",139],["T_STRING","str_repeat",139],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\x0\"",139],",",["T_WHITESPACE"," ",139],["T_LNUMBER","16",139],")",["T_WHITESPACE","\n\t\t",139],")",";",["T_WHITESPACE","\n\n\t\t",140],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","assertTrue",142],"(",["T_STRING","is_array",142],"(",["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","encryption",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","__get_params",142],"(",["T_VARIABLE","$params",142],")",")",")",";",["T_WHITESPACE","\n\n\t\t",142],["T_VARIABLE","$params",144],"[",["T_CONSTANT_ENCAPSED_STRING","'base64'",144],"]",["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_STRING","TRUE",144],";",["T_WHITESPACE","\n\t\t",144],["T_VARIABLE","$params",145],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_digest'",145],"]",["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","'sha512'",145],";",["T_WHITESPACE","\n\n\t\t",145],["T_COMMENT","\/\/ Including all parameters\n",147],["T_WHITESPACE","\t\t",148],["T_VARIABLE","$params",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_ARRAY","array",148],"(",["T_WHITESPACE","\n\t\t\t",148],["T_CONSTANT_ENCAPSED_STRING","'cipher'",149],["T_WHITESPACE"," ",149],["T_DOUBLE_ARROW","=>",149],["T_WHITESPACE"," ",149],["T_CONSTANT_ENCAPSED_STRING","'aes-128'",149],",",["T_WHITESPACE","\n\t\t\t",149],["T_CONSTANT_ENCAPSED_STRING","'mode'",150],["T_WHITESPACE"," ",150],["T_DOUBLE_ARROW","=>",150],["T_WHITESPACE"," ",150],["T_CONSTANT_ENCAPSED_STRING","'cbc'",150],",",["T_WHITESPACE","\n\t\t\t",150],["T_CONSTANT_ENCAPSED_STRING","'key'",151],["T_WHITESPACE"," ",151],["T_DOUBLE_ARROW","=>",151],["T_WHITESPACE"," ",151],["T_STRING","str_repeat",151],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\x0\"",151],",",["T_WHITESPACE"," ",151],["T_LNUMBER","16",151],")",",",["T_WHITESPACE","\n\t\t\t",151],["T_CONSTANT_ENCAPSED_STRING","'raw_data'",152],["T_WHITESPACE"," ",152],["T_DOUBLE_ARROW","=>",152],["T_WHITESPACE"," ",152],["T_STRING","TRUE",152],",",["T_WHITESPACE","\n\t\t\t",152],["T_CONSTANT_ENCAPSED_STRING","'hmac_key'",153],["T_WHITESPACE"," ",153],["T_DOUBLE_ARROW","=>",153],["T_WHITESPACE"," ",153],["T_STRING","str_repeat",153],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\x0\"",153],",",["T_WHITESPACE"," ",153],["T_LNUMBER","16",153],")",",",["T_WHITESPACE","\n\t\t\t",153],["T_CONSTANT_ENCAPSED_STRING","'hmac_digest'",154],["T_WHITESPACE"," ",154],["T_DOUBLE_ARROW","=>",154],["T_WHITESPACE"," ",154],["T_CONSTANT_ENCAPSED_STRING","'sha256'",154],["T_WHITESPACE","\n\t\t",154],")",";",["T_WHITESPACE","\n\n\t\t",155],["T_VARIABLE","$output",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","encryption",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","__get_params",157],"(",["T_VARIABLE","$params",157],")",";",["T_WHITESPACE","\n\t\t",157],["T_UNSET","unset",158],"(",["T_VARIABLE","$output",158],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",158],"]",",",["T_WHITESPACE"," ",158],["T_VARIABLE","$output",158],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",158],"]",",",["T_WHITESPACE"," ",158],["T_VARIABLE","$params",158],"[",["T_CONSTANT_ENCAPSED_STRING","'raw_data'",158],"]",",",["T_WHITESPACE"," ",158],["T_VARIABLE","$params",158],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",158],"]",")",";",["T_WHITESPACE","\n\t\t",158],["T_VARIABLE","$params",159],"[",["T_CONSTANT_ENCAPSED_STRING","'base64'",159],"]",["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_STRING","FALSE",159],";",["T_WHITESPACE","\n\t\t",159],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","assertEquals",160],"(",["T_VARIABLE","$params",160],",",["T_WHITESPACE"," ",160],["T_VARIABLE","$output",160],")",";",["T_WHITESPACE","\n\n\t\t",160],["T_COMMENT","\/\/ HMAC disabled\n",162],["T_WHITESPACE","\t\t",163],["T_UNSET","unset",163],"(",["T_VARIABLE","$params",163],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_key'",163],"]",",",["T_WHITESPACE"," ",163],["T_VARIABLE","$params",163],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_digest'",163],"]",")",";",["T_WHITESPACE","\n\t\t",163],["T_VARIABLE","$params",164],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac'",164],"]",["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_VARIABLE","$params",164],"[",["T_CONSTANT_ENCAPSED_STRING","'raw_data'",164],"]",["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_STRING","FALSE",164],";",["T_WHITESPACE","\n\t\t",164],["T_VARIABLE","$params",165],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",165],"]",["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","'aes-128'",165],";",["T_WHITESPACE","\n\t\t",165],["T_VARIABLE","$output",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","encryption",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","__get_params",166],"(",["T_VARIABLE","$params",166],")",";",["T_WHITESPACE","\n\t\t",166],["T_UNSET","unset",167],"(",["T_VARIABLE","$output",167],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",167],"]",",",["T_WHITESPACE"," ",167],["T_VARIABLE","$output",167],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",167],"]",",",["T_WHITESPACE"," ",167],["T_VARIABLE","$params",167],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac'",167],"]",",",["T_WHITESPACE"," ",167],["T_VARIABLE","$params",167],"[",["T_CONSTANT_ENCAPSED_STRING","'raw_data'",167],"]",",",["T_WHITESPACE"," ",167],["T_VARIABLE","$params",167],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",167],"]",")",";",["T_WHITESPACE","\n\t\t",167],["T_VARIABLE","$params",168],"[",["T_CONSTANT_ENCAPSED_STRING","'base64'",168],"]",["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_STRING","TRUE",168],";",["T_WHITESPACE","\n\t\t",168],["T_VARIABLE","$params",169],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_digest'",169],"]",["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_VARIABLE","$params",169],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_key'",169],"]",["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_STRING","NULL",169],";",["T_WHITESPACE","\n\t\t",169],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","assertEquals",170],"(",["T_VARIABLE","$params",170],",",["T_WHITESPACE"," ",170],["T_VARIABLE","$output",170],")",";",["T_WHITESPACE","\n\t",170],"}",["T_WHITESPACE","\n\n\t",171],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",173],["T_WHITESPACE","\n\t",174],["T_DOC_COMMENT","\/**\n\t * initialize(), encrypt(), decrypt() test\n\t *\n\t * Testing the three methods separately is not realistic as they are\n\t * designed to work together. A more thorough test for initialize()\n\t * though is the OpenSSL\/MCrypt compatibility test.\n\t *\n\t * @depends\ttest_hkdf\n\t * @depends\ttest__get_params\n\t *\/",175],["T_WHITESPACE","\n\t",184],["T_PUBLIC","public",185],["T_WHITESPACE"," ",185],["T_FUNCTION","function",185],["T_WHITESPACE"," ",185],["T_STRING","test_initialize_encrypt_decrypt",185],"(",")",["T_WHITESPACE","\n\t",185],"{",["T_WHITESPACE","\n\t\t",186],["T_VARIABLE","$message",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_CONSTANT_ENCAPSED_STRING","'This is a plain-text message.'",187],";",["T_WHITESPACE","\n\t\t",187],["T_VARIABLE","$key",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_CONSTANT_ENCAPSED_STRING","\"\\xd0\\xc9\\x08\\xc4\\xde\\x52\\x12\\x6e\\xf8\\xcc\\xdb\\x03\\xea\\xa0\\x3a\\x5c\"",188],";",["T_WHITESPACE","\n\n\t\t",188],["T_COMMENT","\/\/ Default state (AES-128\/Rijndael-128 in CBC mode)\n",190],["T_WHITESPACE","\t\t",191],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","encryption",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","initialize",191],"(",["T_ARRAY","array",191],"(",["T_CONSTANT_ENCAPSED_STRING","'key'",191],["T_WHITESPACE"," ",191],["T_DOUBLE_ARROW","=>",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$key",191],")",")",";",["T_WHITESPACE","\n\n\t\t",191],["T_COMMENT","\/\/ Was the key properly set?\n",193],["T_WHITESPACE","\t\t",194],["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","assertEquals",194],"(",["T_VARIABLE","$key",194],",",["T_WHITESPACE"," ",194],["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","encryption",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","get_key",194],"(",")",")",";",["T_WHITESPACE","\n\n\t\t",194],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","assertEquals",196],"(",["T_VARIABLE","$message",196],",",["T_WHITESPACE"," ",196],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","encryption",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","decrypt",196],"(",["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","encryption",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","encrypt",196],"(",["T_VARIABLE","$message",196],")",")",")",";",["T_WHITESPACE","\n\n\t\t",196],["T_COMMENT","\/\/ Try DES in ECB mode, just for the sake of changing stuff\n",198],["T_WHITESPACE","\t\t",199],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","encryption",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","initialize",199],"(",["T_ARRAY","array",199],"(",["T_CONSTANT_ENCAPSED_STRING","'cipher'",199],["T_WHITESPACE"," ",199],["T_DOUBLE_ARROW","=>",199],["T_WHITESPACE"," ",199],["T_CONSTANT_ENCAPSED_STRING","'des'",199],",",["T_WHITESPACE"," ",199],["T_CONSTANT_ENCAPSED_STRING","'mode'",199],["T_WHITESPACE"," ",199],["T_DOUBLE_ARROW","=>",199],["T_WHITESPACE"," ",199],["T_CONSTANT_ENCAPSED_STRING","'ecb'",199],",",["T_WHITESPACE"," ",199],["T_CONSTANT_ENCAPSED_STRING","'key'",199],["T_WHITESPACE"," ",199],["T_DOUBLE_ARROW","=>",199],["T_WHITESPACE"," ",199],["T_STRING","substr",199],"(",["T_VARIABLE","$key",199],",",["T_WHITESPACE"," ",199],["T_LNUMBER","0",199],",",["T_WHITESPACE"," ",199],["T_LNUMBER","8",199],")",")",")",";",["T_WHITESPACE","\n\t\t",199],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","assertEquals",200],"(",["T_VARIABLE","$message",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","encryption",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","decrypt",200],"(",["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","encryption",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","encrypt",200],"(",["T_VARIABLE","$message",200],")",")",")",";",["T_WHITESPACE","\n\t",200],"}",["T_WHITESPACE","\n\n\t",201],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",203],["T_WHITESPACE","\n\t",204],["T_DOC_COMMENT","\/**\n\t * encrypt(), decrypt test with custom parameters\n\t *\n\t * @depends\ttest___get_params\n\t *\/",205],["T_WHITESPACE","\n\t",209],["T_PUBLIC","public",210],["T_WHITESPACE"," ",210],["T_FUNCTION","function",210],["T_WHITESPACE"," ",210],["T_STRING","test_encrypt_decrypt_custom",210],"(",")",["T_WHITESPACE","\n\t",210],"{",["T_WHITESPACE","\n\t\t",211],["T_VARIABLE","$message",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_CONSTANT_ENCAPSED_STRING","'Another plain-text message.'",212],";",["T_WHITESPACE","\n\n\t\t",212],["T_COMMENT","\/\/ A random invalid parameter\n",214],["T_WHITESPACE","\t\t",215],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","assertFalse",215],"(",["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","encryption",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","encrypt",215],"(",["T_VARIABLE","$message",215],",",["T_WHITESPACE"," ",215],["T_ARRAY","array",215],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",215],")",")",")",";",["T_WHITESPACE","\n\t\t",215],["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","assertFalse",216],"(",["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","encryption",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","decrypt",216],"(",["T_VARIABLE","$message",216],",",["T_WHITESPACE"," ",216],["T_ARRAY","array",216],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",216],")",")",")",";",["T_WHITESPACE","\n\n\t\t",216],["T_COMMENT","\/\/ No HMAC, binary output\n",218],["T_WHITESPACE","\t\t",219],["T_VARIABLE","$params",219],["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],["T_ARRAY","array",219],"(",["T_WHITESPACE","\n\t\t\t",219],["T_CONSTANT_ENCAPSED_STRING","'cipher'",220],["T_WHITESPACE"," ",220],["T_DOUBLE_ARROW","=>",220],["T_WHITESPACE"," ",220],["T_CONSTANT_ENCAPSED_STRING","'tripledes'",220],",",["T_WHITESPACE","\n\t\t\t",220],["T_CONSTANT_ENCAPSED_STRING","'mode'",221],["T_WHITESPACE"," ",221],["T_DOUBLE_ARROW","=>",221],["T_WHITESPACE"," ",221],["T_CONSTANT_ENCAPSED_STRING","'cfb'",221],",",["T_WHITESPACE","\n\t\t\t",221],["T_CONSTANT_ENCAPSED_STRING","'key'",222],["T_WHITESPACE"," ",222],["T_DOUBLE_ARROW","=>",222],["T_WHITESPACE"," ",222],["T_STRING","str_repeat",222],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\x1\"",222],",",["T_WHITESPACE"," ",222],["T_LNUMBER","16",222],")",",",["T_WHITESPACE","\n\t\t\t",222],["T_CONSTANT_ENCAPSED_STRING","'base64'",223],["T_WHITESPACE"," ",223],["T_DOUBLE_ARROW","=>",223],["T_WHITESPACE"," ",223],["T_STRING","FALSE",223],",",["T_WHITESPACE","\n\t\t\t",223],["T_CONSTANT_ENCAPSED_STRING","'hmac'",224],["T_WHITESPACE"," ",224],["T_DOUBLE_ARROW","=>",224],["T_WHITESPACE"," ",224],["T_STRING","FALSE",224],["T_WHITESPACE","\n\t\t",224],")",";",["T_WHITESPACE","\n\n\t\t",225],["T_VARIABLE","$ciphertext",227],["T_WHITESPACE"," ",227],"=",["T_WHITESPACE"," ",227],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","encryption",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","encrypt",227],"(",["T_VARIABLE","$message",227],",",["T_WHITESPACE"," ",227],["T_VARIABLE","$params",227],")",";",["T_WHITESPACE","\n\n\t\t",227],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","assertEquals",229],"(",["T_VARIABLE","$message",229],",",["T_WHITESPACE"," ",229],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","encryption",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","decrypt",229],"(",["T_VARIABLE","$ciphertext",229],",",["T_WHITESPACE"," ",229],["T_VARIABLE","$params",229],")",")",";",["T_WHITESPACE","\n\t",229],"}",["T_WHITESPACE","\n\n\t",230],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",232],["T_WHITESPACE","\n\t",233],["T_DOC_COMMENT","\/**\n\t * _mcrypt_get_handle() test\n\t *\/",234],["T_WHITESPACE","\n\t",236],["T_PUBLIC","public",237],["T_WHITESPACE"," ",237],["T_FUNCTION","function",237],["T_WHITESPACE"," ",237],["T_STRING","test__mcrypt_get_handle",237],"(",")",["T_WHITESPACE","\n\t",237],"{",["T_WHITESPACE","\n\t\t",238],["T_IF","if",239],["T_WHITESPACE"," ",239],"(",["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","encryption",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","drivers",239],"[",["T_CONSTANT_ENCAPSED_STRING","'mcrypt'",239],"]",["T_WHITESPACE"," ",239],["T_IS_IDENTICAL","===",239],["T_WHITESPACE"," ",239],["T_STRING","FALSE",239],")",["T_WHITESPACE","\n\t\t",239],"{",["T_WHITESPACE","\n\t\t\t",240],["T_RETURN","return",241],["T_WHITESPACE"," ",241],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","markTestSkipped",241],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot test MCrypt because it is not available.'",241],")",";",["T_WHITESPACE","\n\t\t",241],"}",["T_WHITESPACE","\n\t\t",242],["T_ELSEIF","elseif",243],["T_WHITESPACE"," ",243],"(",["T_STRING","version_compare",243],"(",["T_STRING","PHP_VERSION",243],",",["T_WHITESPACE"," ",243],["T_CONSTANT_ENCAPSED_STRING","'7.1.0-alpha'",243],",",["T_WHITESPACE"," ",243],["T_CONSTANT_ENCAPSED_STRING","'>='",243],")",")",["T_WHITESPACE","\n\t\t",243],"{",["T_WHITESPACE","\n\t\t\t",244],["T_RETURN","return",245],["T_WHITESPACE"," ",245],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","markTestSkipped",245],"(",["T_CONSTANT_ENCAPSED_STRING","'ext\/mcrypt is deprecated since PHP 7.1 and will generate notices here.'",245],")",";",["T_WHITESPACE","\n\t\t",245],"}",["T_WHITESPACE","\n\n\t\t",246],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","assertTrue",248],"(",["T_STRING","is_resource",248],"(",["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","encryption",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","__driver_get_handle",248],"(",["T_CONSTANT_ENCAPSED_STRING","'mcrypt'",248],",",["T_WHITESPACE"," ",248],["T_CONSTANT_ENCAPSED_STRING","'rijndael-128'",248],",",["T_WHITESPACE"," ",248],["T_CONSTANT_ENCAPSED_STRING","'cbc'",248],")",")",")",";",["T_WHITESPACE","\n\t",248],"}",["T_WHITESPACE","\n\n\t",249],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",251],["T_WHITESPACE","\n\t",252],["T_DOC_COMMENT","\/**\n\t * _openssl_get_handle() test\n\t *\/",253],["T_WHITESPACE","\n\t",255],["T_PUBLIC","public",256],["T_WHITESPACE"," ",256],["T_FUNCTION","function",256],["T_WHITESPACE"," ",256],["T_STRING","test__openssl_mcrypt_get_handle",256],"(",")",["T_WHITESPACE","\n\t",256],"{",["T_WHITESPACE","\n\t\t",257],["T_IF","if",258],["T_WHITESPACE"," ",258],"(",["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","encryption",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","drivers",258],"[",["T_CONSTANT_ENCAPSED_STRING","'openssl'",258],"]",["T_WHITESPACE"," ",258],["T_IS_IDENTICAL","===",258],["T_WHITESPACE"," ",258],["T_STRING","FALSE",258],")",["T_WHITESPACE","\n\t\t",258],"{",["T_WHITESPACE","\n\t\t\t",259],["T_RETURN","return",260],["T_WHITESPACE"," ",260],["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","markTestSkipped",260],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot test OpenSSL because it is not available.'",260],")",";",["T_WHITESPACE","\n\t\t",260],"}",["T_WHITESPACE","\n\n\t\t",261],["T_VARIABLE","$this",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","assertEquals",263],"(",["T_CONSTANT_ENCAPSED_STRING","'aes-128-cbc'",263],",",["T_WHITESPACE"," ",263],["T_VARIABLE","$this",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","encryption",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","__driver_get_handle",263],"(",["T_CONSTANT_ENCAPSED_STRING","'openssl'",263],",",["T_WHITESPACE"," ",263],["T_CONSTANT_ENCAPSED_STRING","'aes-128'",263],",",["T_WHITESPACE"," ",263],["T_CONSTANT_ENCAPSED_STRING","'cbc'",263],")",")",";",["T_WHITESPACE","\n\t\t",263],["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","assertEquals",264],"(",["T_CONSTANT_ENCAPSED_STRING","'rc4-40'",264],",",["T_WHITESPACE"," ",264],["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","encryption",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","__driver_get_handle",264],"(",["T_CONSTANT_ENCAPSED_STRING","'openssl'",264],",",["T_WHITESPACE"," ",264],["T_CONSTANT_ENCAPSED_STRING","'rc4-40'",264],",",["T_WHITESPACE"," ",264],["T_CONSTANT_ENCAPSED_STRING","'stream'",264],")",")",";",["T_WHITESPACE","\n\t",264],"}",["T_WHITESPACE","\n\n\t",265],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",267],["T_WHITESPACE","\n\t",268],["T_DOC_COMMENT","\/**\n\t * OpenSSL\/MCrypt portability test\n\t *\n\t * Amongst the obvious stuff, _cipher_alias() is also tested here.\n\t *\/",269],["T_WHITESPACE","\n\t",273],["T_PUBLIC","public",274],["T_WHITESPACE"," ",274],["T_FUNCTION","function",274],["T_WHITESPACE"," ",274],["T_STRING","test_portability",274],"(",")",["T_WHITESPACE","\n\t",274],"{",["T_WHITESPACE","\n\t\t",275],["T_IF","if",276],["T_WHITESPACE"," ",276],"(",["T_WHITESPACE"," ",276],"!",["T_WHITESPACE"," ",276],["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","encryption",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","drivers",276],"[",["T_CONSTANT_ENCAPSED_STRING","'mcrypt'",276],"]",["T_WHITESPACE"," ",276],["T_LOGICAL_OR","OR",276],["T_WHITESPACE"," ",276],"!",["T_WHITESPACE"," ",276],["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","encryption",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","drivers",276],"[",["T_CONSTANT_ENCAPSED_STRING","'openssl'",276],"]",")",["T_WHITESPACE","\n\t\t",276],"{",["T_WHITESPACE","\n\t\t\t",277],["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","markTestSkipped",278],"(",["T_CONSTANT_ENCAPSED_STRING","'Both MCrypt and OpenSSL support are required for portability tests.'",278],")",";",["T_WHITESPACE","\n\t\t\t",278],["T_RETURN","return",279],";",["T_WHITESPACE","\n\t\t",279],"}",["T_WHITESPACE","\n\t\t",280],["T_ELSEIF","elseif",281],["T_WHITESPACE"," ",281],"(",["T_STRING","version_compare",281],"(",["T_STRING","PHP_VERSION",281],",",["T_WHITESPACE"," ",281],["T_CONSTANT_ENCAPSED_STRING","'7.1.0-alpha'",281],",",["T_WHITESPACE"," ",281],["T_CONSTANT_ENCAPSED_STRING","'>='",281],")",")",["T_WHITESPACE","\n\t\t",281],"{",["T_WHITESPACE","\n\t\t\t",282],["T_RETURN","return",283],["T_WHITESPACE"," ",283],["T_VARIABLE","$this",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","markTestSkipped",283],"(",["T_CONSTANT_ENCAPSED_STRING","'ext\/mcrypt is deprecated since PHP 7.1 and will generate notices here.'",283],")",";",["T_WHITESPACE","\n\t\t",283],"}",["T_WHITESPACE","\n\n\t\t",284],["T_VARIABLE","$message",286],["T_WHITESPACE"," ",286],"=",["T_WHITESPACE"," ",286],["T_CONSTANT_ENCAPSED_STRING","'This is a message encrypted via MCrypt and decrypted via OpenSSL, or vice-versa.'",286],";",["T_WHITESPACE","\n\n\t\t",286],["T_COMMENT","\/\/ Format is: <Cipher name>, <Cipher mode>, <Key size>\n",288],["T_WHITESPACE","\t\t",289],["T_VARIABLE","$portable",289],["T_WHITESPACE"," ",289],"=",["T_WHITESPACE"," ",289],["T_ARRAY","array",289],"(",["T_WHITESPACE","\n\t\t\t",289],["T_ARRAY","array",290],"(",["T_CONSTANT_ENCAPSED_STRING","'aes-128'",290],",",["T_WHITESPACE"," ",290],["T_CONSTANT_ENCAPSED_STRING","'cbc'",290],",",["T_WHITESPACE"," ",290],["T_LNUMBER","16",290],")",",",["T_WHITESPACE","\n\t\t\t",290],["T_ARRAY","array",291],"(",["T_CONSTANT_ENCAPSED_STRING","'aes-128'",291],",",["T_WHITESPACE"," ",291],["T_CONSTANT_ENCAPSED_STRING","'cfb'",291],",",["T_WHITESPACE"," ",291],["T_LNUMBER","16",291],")",",",["T_WHITESPACE","\n\t\t\t",291],["T_ARRAY","array",292],"(",["T_CONSTANT_ENCAPSED_STRING","'aes-128'",292],",",["T_WHITESPACE"," ",292],["T_CONSTANT_ENCAPSED_STRING","'cfb8'",292],",",["T_WHITESPACE"," ",292],["T_LNUMBER","16",292],")",",",["T_WHITESPACE","\n\t\t\t",292],["T_ARRAY","array",293],"(",["T_CONSTANT_ENCAPSED_STRING","'aes-128'",293],",",["T_WHITESPACE"," ",293],["T_CONSTANT_ENCAPSED_STRING","'ofb'",293],",",["T_WHITESPACE"," ",293],["T_LNUMBER","16",293],")",",",["T_WHITESPACE","\n\t\t\t",293],["T_ARRAY","array",294],"(",["T_CONSTANT_ENCAPSED_STRING","'aes-128'",294],",",["T_WHITESPACE"," ",294],["T_CONSTANT_ENCAPSED_STRING","'ecb'",294],",",["T_WHITESPACE"," ",294],["T_LNUMBER","16",294],")",",",["T_WHITESPACE","\n\t\t\t",294],["T_ARRAY","array",295],"(",["T_CONSTANT_ENCAPSED_STRING","'aes-128'",295],",",["T_WHITESPACE"," ",295],["T_CONSTANT_ENCAPSED_STRING","'ctr'",295],",",["T_WHITESPACE"," ",295],["T_LNUMBER","16",295],")",",",["T_WHITESPACE","\n\t\t\t",295],["T_ARRAY","array",296],"(",["T_CONSTANT_ENCAPSED_STRING","'aes-192'",296],",",["T_WHITESPACE"," ",296],["T_CONSTANT_ENCAPSED_STRING","'cbc'",296],",",["T_WHITESPACE"," ",296],["T_LNUMBER","24",296],")",",",["T_WHITESPACE","\n\t\t\t",296],["T_ARRAY","array",297],"(",["T_CONSTANT_ENCAPSED_STRING","'aes-192'",297],",",["T_WHITESPACE"," ",297],["T_CONSTANT_ENCAPSED_STRING","'cfb'",297],",",["T_WHITESPACE"," ",297],["T_LNUMBER","24",297],")",",",["T_WHITESPACE","\n\t\t\t",297],["T_ARRAY","array",298],"(",["T_CONSTANT_ENCAPSED_STRING","'aes-192'",298],",",["T_WHITESPACE"," ",298],["T_CONSTANT_ENCAPSED_STRING","'cfb8'",298],",",["T_WHITESPACE"," ",298],["T_LNUMBER","24",298],")",",",["T_WHITESPACE","\n\t\t\t",298],["T_ARRAY","array",299],"(",["T_CONSTANT_ENCAPSED_STRING","'aes-192'",299],",",["T_WHITESPACE"," ",299],["T_CONSTANT_ENCAPSED_STRING","'ofb'",299],",",["T_WHITESPACE"," ",299],["T_LNUMBER","24",299],")",",",["T_WHITESPACE","\n\t\t\t",299],["T_ARRAY","array",300],"(",["T_CONSTANT_ENCAPSED_STRING","'aes-192'",300],",",["T_WHITESPACE"," ",300],["T_CONSTANT_ENCAPSED_STRING","'ecb'",300],",",["T_WHITESPACE"," ",300],["T_LNUMBER","24",300],")",",",["T_WHITESPACE","\n\t\t\t",300],["T_ARRAY","array",301],"(",["T_CONSTANT_ENCAPSED_STRING","'aes-192'",301],",",["T_WHITESPACE"," ",301],["T_CONSTANT_ENCAPSED_STRING","'ctr'",301],",",["T_WHITESPACE"," ",301],["T_LNUMBER","24",301],")",",",["T_WHITESPACE","\n\t\t\t",301],["T_ARRAY","array",302],"(",["T_CONSTANT_ENCAPSED_STRING","'aes-256'",302],",",["T_WHITESPACE"," ",302],["T_CONSTANT_ENCAPSED_STRING","'cbc'",302],",",["T_WHITESPACE"," ",302],["T_LNUMBER","32",302],")",",",["T_WHITESPACE","\n\t\t\t",302],["T_ARRAY","array",303],"(",["T_CONSTANT_ENCAPSED_STRING","'aes-256'",303],",",["T_WHITESPACE"," ",303],["T_CONSTANT_ENCAPSED_STRING","'cfb'",303],",",["T_WHITESPACE"," ",303],["T_LNUMBER","32",303],")",",",["T_WHITESPACE","\n\t\t\t",303],["T_ARRAY","array",304],"(",["T_CONSTANT_ENCAPSED_STRING","'aes-256'",304],",",["T_WHITESPACE"," ",304],["T_CONSTANT_ENCAPSED_STRING","'cfb8'",304],",",["T_WHITESPACE"," ",304],["T_LNUMBER","32",304],")",",",["T_WHITESPACE","\n\t\t\t",304],["T_ARRAY","array",305],"(",["T_CONSTANT_ENCAPSED_STRING","'aes-256'",305],",",["T_WHITESPACE"," ",305],["T_CONSTANT_ENCAPSED_STRING","'ofb'",305],",",["T_WHITESPACE"," ",305],["T_LNUMBER","32",305],")",",",["T_WHITESPACE","\n\t\t\t",305],["T_ARRAY","array",306],"(",["T_CONSTANT_ENCAPSED_STRING","'aes-256'",306],",",["T_WHITESPACE"," ",306],["T_CONSTANT_ENCAPSED_STRING","'ecb'",306],",",["T_WHITESPACE"," ",306],["T_LNUMBER","32",306],")",",",["T_WHITESPACE","\n\t\t\t",306],["T_ARRAY","array",307],"(",["T_CONSTANT_ENCAPSED_STRING","'aes-256'",307],",",["T_WHITESPACE"," ",307],["T_CONSTANT_ENCAPSED_STRING","'ctr'",307],",",["T_WHITESPACE"," ",307],["T_LNUMBER","32",307],")",",",["T_WHITESPACE","\n\t\t\t",307],["T_ARRAY","array",308],"(",["T_CONSTANT_ENCAPSED_STRING","'des'",308],",",["T_WHITESPACE"," ",308],["T_CONSTANT_ENCAPSED_STRING","'cbc'",308],",",["T_WHITESPACE"," ",308],["T_LNUMBER","7",308],")",",",["T_WHITESPACE","\n\t\t\t",308],["T_ARRAY","array",309],"(",["T_CONSTANT_ENCAPSED_STRING","'des'",309],",",["T_WHITESPACE"," ",309],["T_CONSTANT_ENCAPSED_STRING","'cfb'",309],",",["T_WHITESPACE"," ",309],["T_LNUMBER","7",309],")",",",["T_WHITESPACE","\n\t\t\t",309],["T_ARRAY","array",310],"(",["T_CONSTANT_ENCAPSED_STRING","'des'",310],",",["T_WHITESPACE"," ",310],["T_CONSTANT_ENCAPSED_STRING","'cfb8'",310],",",["T_WHITESPACE"," ",310],["T_LNUMBER","7",310],")",",",["T_WHITESPACE","\n\t\t\t",310],["T_ARRAY","array",311],"(",["T_CONSTANT_ENCAPSED_STRING","'des'",311],",",["T_WHITESPACE"," ",311],["T_CONSTANT_ENCAPSED_STRING","'ofb'",311],",",["T_WHITESPACE"," ",311],["T_LNUMBER","7",311],")",",",["T_WHITESPACE","\n\t\t\t",311],["T_ARRAY","array",312],"(",["T_CONSTANT_ENCAPSED_STRING","'des'",312],",",["T_WHITESPACE"," ",312],["T_CONSTANT_ENCAPSED_STRING","'ecb'",312],",",["T_WHITESPACE"," ",312],["T_LNUMBER","7",312],")",",",["T_WHITESPACE","\n\t\t\t",312],["T_ARRAY","array",313],"(",["T_CONSTANT_ENCAPSED_STRING","'tripledes'",313],",",["T_WHITESPACE"," ",313],["T_CONSTANT_ENCAPSED_STRING","'cbc'",313],",",["T_WHITESPACE"," ",313],["T_LNUMBER","7",313],")",",",["T_WHITESPACE","\n\t\t\t",313],["T_ARRAY","array",314],"(",["T_CONSTANT_ENCAPSED_STRING","'tripledes'",314],",",["T_WHITESPACE"," ",314],["T_CONSTANT_ENCAPSED_STRING","'cfb'",314],",",["T_WHITESPACE"," ",314],["T_LNUMBER","7",314],")",",",["T_WHITESPACE","\n\t\t\t",314],["T_ARRAY","array",315],"(",["T_CONSTANT_ENCAPSED_STRING","'tripledes'",315],",",["T_WHITESPACE"," ",315],["T_CONSTANT_ENCAPSED_STRING","'cfb8'",315],",",["T_WHITESPACE"," ",315],["T_LNUMBER","7",315],")",",",["T_WHITESPACE","\n\t\t\t",315],["T_ARRAY","array",316],"(",["T_CONSTANT_ENCAPSED_STRING","'tripledes'",316],",",["T_WHITESPACE"," ",316],["T_CONSTANT_ENCAPSED_STRING","'ofb'",316],",",["T_WHITESPACE"," ",316],["T_LNUMBER","7",316],")",",",["T_WHITESPACE","\n\t\t\t",316],["T_ARRAY","array",317],"(",["T_CONSTANT_ENCAPSED_STRING","'tripledes'",317],",",["T_WHITESPACE"," ",317],["T_CONSTANT_ENCAPSED_STRING","'cbc'",317],",",["T_WHITESPACE"," ",317],["T_LNUMBER","14",317],")",",",["T_WHITESPACE","\n\t\t\t",317],["T_ARRAY","array",318],"(",["T_CONSTANT_ENCAPSED_STRING","'tripledes'",318],",",["T_WHITESPACE"," ",318],["T_CONSTANT_ENCAPSED_STRING","'cfb'",318],",",["T_WHITESPACE"," ",318],["T_LNUMBER","14",318],")",",",["T_WHITESPACE","\n\t\t\t",318],["T_ARRAY","array",319],"(",["T_CONSTANT_ENCAPSED_STRING","'tripledes'",319],",",["T_WHITESPACE"," ",319],["T_CONSTANT_ENCAPSED_STRING","'cfb8'",319],",",["T_WHITESPACE"," ",319],["T_LNUMBER","14",319],")",",",["T_WHITESPACE","\n\t\t\t",319],["T_ARRAY","array",320],"(",["T_CONSTANT_ENCAPSED_STRING","'tripledes'",320],",",["T_WHITESPACE"," ",320],["T_CONSTANT_ENCAPSED_STRING","'ofb'",320],",",["T_WHITESPACE"," ",320],["T_LNUMBER","14",320],")",",",["T_WHITESPACE","\n\t\t\t",320],["T_ARRAY","array",321],"(",["T_CONSTANT_ENCAPSED_STRING","'tripledes'",321],",",["T_WHITESPACE"," ",321],["T_CONSTANT_ENCAPSED_STRING","'cbc'",321],",",["T_WHITESPACE"," ",321],["T_LNUMBER","21",321],")",",",["T_WHITESPACE","\n\t\t\t",321],["T_ARRAY","array",322],"(",["T_CONSTANT_ENCAPSED_STRING","'tripledes'",322],",",["T_WHITESPACE"," ",322],["T_CONSTANT_ENCAPSED_STRING","'cfb'",322],",",["T_WHITESPACE"," ",322],["T_LNUMBER","21",322],")",",",["T_WHITESPACE","\n\t\t\t",322],["T_ARRAY","array",323],"(",["T_CONSTANT_ENCAPSED_STRING","'tripledes'",323],",",["T_WHITESPACE"," ",323],["T_CONSTANT_ENCAPSED_STRING","'cfb8'",323],",",["T_WHITESPACE"," ",323],["T_LNUMBER","21",323],")",",",["T_WHITESPACE","\n\t\t\t",323],["T_ARRAY","array",324],"(",["T_CONSTANT_ENCAPSED_STRING","'tripledes'",324],",",["T_WHITESPACE"," ",324],["T_CONSTANT_ENCAPSED_STRING","'ofb'",324],",",["T_WHITESPACE"," ",324],["T_LNUMBER","21",324],")",",",["T_WHITESPACE","\n\t\t\t",324],["T_ARRAY","array",325],"(",["T_CONSTANT_ENCAPSED_STRING","'blowfish'",325],",",["T_WHITESPACE"," ",325],["T_CONSTANT_ENCAPSED_STRING","'cbc'",325],",",["T_WHITESPACE"," ",325],["T_LNUMBER","16",325],")",",",["T_WHITESPACE","\n\t\t\t",325],["T_ARRAY","array",326],"(",["T_CONSTANT_ENCAPSED_STRING","'blowfish'",326],",",["T_WHITESPACE"," ",326],["T_CONSTANT_ENCAPSED_STRING","'cfb'",326],",",["T_WHITESPACE"," ",326],["T_LNUMBER","16",326],")",",",["T_WHITESPACE","\n\t\t\t",326],["T_ARRAY","array",327],"(",["T_CONSTANT_ENCAPSED_STRING","'blowfish'",327],",",["T_WHITESPACE"," ",327],["T_CONSTANT_ENCAPSED_STRING","'ofb'",327],",",["T_WHITESPACE"," ",327],["T_LNUMBER","16",327],")",",",["T_WHITESPACE","\n\t\t\t",327],["T_ARRAY","array",328],"(",["T_CONSTANT_ENCAPSED_STRING","'blowfish'",328],",",["T_WHITESPACE"," ",328],["T_CONSTANT_ENCAPSED_STRING","'ecb'",328],",",["T_WHITESPACE"," ",328],["T_LNUMBER","16",328],")",",",["T_WHITESPACE","\n\t\t\t",328],["T_ARRAY","array",329],"(",["T_CONSTANT_ENCAPSED_STRING","'blowfish'",329],",",["T_WHITESPACE"," ",329],["T_CONSTANT_ENCAPSED_STRING","'cbc'",329],",",["T_WHITESPACE"," ",329],["T_LNUMBER","56",329],")",",",["T_WHITESPACE","\n\t\t\t",329],["T_ARRAY","array",330],"(",["T_CONSTANT_ENCAPSED_STRING","'blowfish'",330],",",["T_WHITESPACE"," ",330],["T_CONSTANT_ENCAPSED_STRING","'cfb'",330],",",["T_WHITESPACE"," ",330],["T_LNUMBER","56",330],")",",",["T_WHITESPACE","\n\t\t\t",330],["T_ARRAY","array",331],"(",["T_CONSTANT_ENCAPSED_STRING","'blowfish'",331],",",["T_WHITESPACE"," ",331],["T_CONSTANT_ENCAPSED_STRING","'ofb'",331],",",["T_WHITESPACE"," ",331],["T_LNUMBER","56",331],")",",",["T_WHITESPACE","\n\t\t\t",331],["T_ARRAY","array",332],"(",["T_CONSTANT_ENCAPSED_STRING","'blowfish'",332],",",["T_WHITESPACE"," ",332],["T_CONSTANT_ENCAPSED_STRING","'ecb'",332],",",["T_WHITESPACE"," ",332],["T_LNUMBER","56",332],")",",",["T_WHITESPACE","\n\t\t\t",332],["T_ARRAY","array",333],"(",["T_CONSTANT_ENCAPSED_STRING","'cast5'",333],",",["T_WHITESPACE"," ",333],["T_CONSTANT_ENCAPSED_STRING","'cbc'",333],",",["T_WHITESPACE"," ",333],["T_LNUMBER","11",333],")",",",["T_WHITESPACE","\n\t\t\t",333],["T_ARRAY","array",334],"(",["T_CONSTANT_ENCAPSED_STRING","'cast5'",334],",",["T_WHITESPACE"," ",334],["T_CONSTANT_ENCAPSED_STRING","'cfb'",334],",",["T_WHITESPACE"," ",334],["T_LNUMBER","11",334],")",",",["T_WHITESPACE","\n\t\t\t",334],["T_ARRAY","array",335],"(",["T_CONSTANT_ENCAPSED_STRING","'cast5'",335],",",["T_WHITESPACE"," ",335],["T_CONSTANT_ENCAPSED_STRING","'ofb'",335],",",["T_WHITESPACE"," ",335],["T_LNUMBER","11",335],")",",",["T_WHITESPACE","\n\t\t\t",335],["T_ARRAY","array",336],"(",["T_CONSTANT_ENCAPSED_STRING","'cast5'",336],",",["T_WHITESPACE"," ",336],["T_CONSTANT_ENCAPSED_STRING","'ecb'",336],",",["T_WHITESPACE"," ",336],["T_LNUMBER","11",336],")",",",["T_WHITESPACE","\n\t\t\t",336],["T_ARRAY","array",337],"(",["T_CONSTANT_ENCAPSED_STRING","'cast5'",337],",",["T_WHITESPACE"," ",337],["T_CONSTANT_ENCAPSED_STRING","'cbc'",337],",",["T_WHITESPACE"," ",337],["T_LNUMBER","16",337],")",",",["T_WHITESPACE","\n\t\t\t",337],["T_ARRAY","array",338],"(",["T_CONSTANT_ENCAPSED_STRING","'cast5'",338],",",["T_WHITESPACE"," ",338],["T_CONSTANT_ENCAPSED_STRING","'cfb'",338],",",["T_WHITESPACE"," ",338],["T_LNUMBER","16",338],")",",",["T_WHITESPACE","\n\t\t\t",338],["T_ARRAY","array",339],"(",["T_CONSTANT_ENCAPSED_STRING","'cast5'",339],",",["T_WHITESPACE"," ",339],["T_CONSTANT_ENCAPSED_STRING","'ofb'",339],",",["T_WHITESPACE"," ",339],["T_LNUMBER","16",339],")",",",["T_WHITESPACE","\n\t\t\t",339],["T_ARRAY","array",340],"(",["T_CONSTANT_ENCAPSED_STRING","'cast5'",340],",",["T_WHITESPACE"," ",340],["T_CONSTANT_ENCAPSED_STRING","'ecb'",340],",",["T_WHITESPACE"," ",340],["T_LNUMBER","16",340],")",",",["T_WHITESPACE","\n\t\t\t",340],["T_ARRAY","array",341],"(",["T_CONSTANT_ENCAPSED_STRING","'rc4'",341],",",["T_WHITESPACE"," ",341],["T_CONSTANT_ENCAPSED_STRING","'stream'",341],",",["T_WHITESPACE"," ",341],["T_LNUMBER","5",341],")",",",["T_WHITESPACE","\n\t\t\t",341],["T_ARRAY","array",342],"(",["T_CONSTANT_ENCAPSED_STRING","'rc4'",342],",",["T_WHITESPACE"," ",342],["T_CONSTANT_ENCAPSED_STRING","'stream'",342],",",["T_WHITESPACE"," ",342],["T_LNUMBER","8",342],")",",",["T_WHITESPACE","\n\t\t\t",342],["T_ARRAY","array",343],"(",["T_CONSTANT_ENCAPSED_STRING","'rc4'",343],",",["T_WHITESPACE"," ",343],["T_CONSTANT_ENCAPSED_STRING","'stream'",343],",",["T_WHITESPACE"," ",343],["T_LNUMBER","16",343],")",",",["T_WHITESPACE","\n\t\t\t",343],["T_ARRAY","array",344],"(",["T_CONSTANT_ENCAPSED_STRING","'rc4'",344],",",["T_WHITESPACE"," ",344],["T_CONSTANT_ENCAPSED_STRING","'stream'",344],",",["T_WHITESPACE"," ",344],["T_LNUMBER","32",344],")",",",["T_WHITESPACE","\n\t\t\t",344],["T_ARRAY","array",345],"(",["T_CONSTANT_ENCAPSED_STRING","'rc4'",345],",",["T_WHITESPACE"," ",345],["T_CONSTANT_ENCAPSED_STRING","'stream'",345],",",["T_WHITESPACE"," ",345],["T_LNUMBER","64",345],")",",",["T_WHITESPACE","\n\t\t\t",345],["T_ARRAY","array",346],"(",["T_CONSTANT_ENCAPSED_STRING","'rc4'",346],",",["T_WHITESPACE"," ",346],["T_CONSTANT_ENCAPSED_STRING","'stream'",346],",",["T_WHITESPACE"," ",346],["T_LNUMBER","128",346],")",",",["T_WHITESPACE","\n\t\t\t",346],["T_ARRAY","array",347],"(",["T_CONSTANT_ENCAPSED_STRING","'rc4'",347],",",["T_WHITESPACE"," ",347],["T_CONSTANT_ENCAPSED_STRING","'stream'",347],",",["T_WHITESPACE"," ",347],["T_LNUMBER","256",347],")",["T_WHITESPACE","\n\t\t",347],")",";",["T_WHITESPACE","\n\t\t",348],["T_VARIABLE","$driver_index",349],["T_WHITESPACE"," ",349],"=",["T_WHITESPACE"," ",349],["T_ARRAY","array",349],"(",["T_CONSTANT_ENCAPSED_STRING","'mcrypt'",349],",",["T_WHITESPACE"," ",349],["T_CONSTANT_ENCAPSED_STRING","'openssl'",349],")",";",["T_WHITESPACE","\n\n\t\t",349],["T_FOREACH","foreach",351],["T_WHITESPACE"," ",351],"(",["T_VARIABLE","$portable",351],["T_WHITESPACE"," ",351],["T_AS","as",351],["T_WHITESPACE"," ",351],"&",["T_VARIABLE","$test",351],")",["T_WHITESPACE","\n\t\t",351],"{",["T_WHITESPACE","\n\t\t\t",352],["T_COMMENT","\/\/ Add some randomness to the selected driver\n",353],["T_WHITESPACE","\t\t\t",354],["T_VARIABLE","$driver",354],["T_WHITESPACE"," ",354],"=",["T_WHITESPACE"," ",354],["T_STRING","mt_rand",354],"(",["T_LNUMBER","0",354],",",["T_LNUMBER","1",354],")",";",["T_WHITESPACE","\n\t\t\t",354],["T_VARIABLE","$params",355],["T_WHITESPACE"," ",355],"=",["T_WHITESPACE"," ",355],["T_ARRAY","array",355],"(",["T_WHITESPACE","\n\t\t\t\t",355],["T_CONSTANT_ENCAPSED_STRING","'driver'",356],["T_WHITESPACE"," ",356],["T_DOUBLE_ARROW","=>",356],["T_WHITESPACE"," ",356],["T_VARIABLE","$driver_index",356],"[",["T_VARIABLE","$driver",356],"]",",",["T_WHITESPACE","\n\t\t\t\t",356],["T_CONSTANT_ENCAPSED_STRING","'cipher'",357],["T_WHITESPACE"," ",357],["T_DOUBLE_ARROW","=>",357],["T_WHITESPACE"," ",357],["T_VARIABLE","$test",357],"[",["T_LNUMBER","0",357],"]",",",["T_WHITESPACE","\n\t\t\t\t",357],["T_CONSTANT_ENCAPSED_STRING","'mode'",358],["T_WHITESPACE"," ",358],["T_DOUBLE_ARROW","=>",358],["T_WHITESPACE"," ",358],["T_VARIABLE","$test",358],"[",["T_LNUMBER","1",358],"]",",",["T_WHITESPACE","\n\t\t\t\t",358],["T_CONSTANT_ENCAPSED_STRING","'key'",359],["T_WHITESPACE"," ",359],["T_DOUBLE_ARROW","=>",359],["T_WHITESPACE"," ",359],["T_STRING","openssl_random_pseudo_bytes",359],"(",["T_VARIABLE","$test",359],"[",["T_LNUMBER","2",359],"]",")",["T_WHITESPACE","\n\t\t\t",359],")",";",["T_WHITESPACE","\n\n\t\t\t",360],["T_VARIABLE","$this",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","encryption",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","initialize",362],"(",["T_VARIABLE","$params",362],")",";",["T_WHITESPACE","\n\t\t\t",362],["T_VARIABLE","$ciphertext",363],["T_WHITESPACE"," ",363],"=",["T_WHITESPACE"," ",363],["T_VARIABLE","$this",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","encryption",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","encrypt",363],"(",["T_VARIABLE","$message",363],")",";",["T_WHITESPACE","\n\n\t\t\t",363],["T_VARIABLE","$driver",365],["T_WHITESPACE"," ",365],"=",["T_WHITESPACE"," ",365],["T_INT_CAST","(int)",365],["T_WHITESPACE"," ",365],"!",["T_WHITESPACE"," ",365],["T_VARIABLE","$driver",365],";",["T_WHITESPACE","\n\t\t\t",365],["T_VARIABLE","$params",366],"[",["T_CONSTANT_ENCAPSED_STRING","'driver'",366],"]",["T_WHITESPACE"," ",366],"=",["T_WHITESPACE"," ",366],["T_VARIABLE","$driver_index",366],"[",["T_VARIABLE","$driver",366],"]",";",["T_WHITESPACE","\n\n\t\t\t",366],["T_VARIABLE","$this",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","encryption",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","initialize",368],"(",["T_VARIABLE","$params",368],")",";",["T_WHITESPACE","\n\t\t\t",368],["T_VARIABLE","$this",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","assertEquals",369],"(",["T_VARIABLE","$message",369],",",["T_WHITESPACE"," ",369],["T_VARIABLE","$this",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","encryption",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","decrypt",369],"(",["T_VARIABLE","$ciphertext",369],")",")",";",["T_WHITESPACE","\n\t\t",369],"}",["T_WHITESPACE","\n\t",370],"}",["T_WHITESPACE","\n\n\t",371],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",373],["T_WHITESPACE","\n\t",374],["T_DOC_COMMENT","\/**\n\t * __get() test\n\t *\/",375],["T_WHITESPACE","\n\t",377],["T_PUBLIC","public",378],["T_WHITESPACE"," ",378],["T_FUNCTION","function",378],["T_WHITESPACE"," ",378],["T_STRING","test_magic_get",378],"(",")",["T_WHITESPACE","\n\t",378],"{",["T_WHITESPACE","\n\t\t",379],["T_VARIABLE","$this",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","assertNull",380],"(",["T_VARIABLE","$this",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","encryption",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","foo",380],")",";",["T_WHITESPACE","\n\t\t",380],["T_VARIABLE","$this",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","assertEquals",381],"(",["T_ARRAY","array",381],"(",["T_CONSTANT_ENCAPSED_STRING","'mcrypt'",381],",",["T_WHITESPACE"," ",381],["T_CONSTANT_ENCAPSED_STRING","'openssl'",381],")",",",["T_WHITESPACE"," ",381],["T_STRING","array_keys",381],"(",["T_VARIABLE","$this",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","encryption",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","drivers",381],")",")",";",["T_WHITESPACE","\n\n\t\t",381],["T_COMMENT","\/\/ 'stream' mode is translated into an empty string for OpenSSL\n",383],["T_WHITESPACE","\t\t",384],["T_VARIABLE","$this",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","encryption",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","initialize",384],"(",["T_ARRAY","array",384],"(",["T_CONSTANT_ENCAPSED_STRING","'cipher'",384],["T_WHITESPACE"," ",384],["T_DOUBLE_ARROW","=>",384],["T_WHITESPACE"," ",384],["T_CONSTANT_ENCAPSED_STRING","'rc4'",384],",",["T_WHITESPACE"," ",384],["T_CONSTANT_ENCAPSED_STRING","'mode'",384],["T_WHITESPACE"," ",384],["T_DOUBLE_ARROW","=>",384],["T_WHITESPACE"," ",384],["T_CONSTANT_ENCAPSED_STRING","'stream'",384],")",")",";",["T_WHITESPACE","\n\t\t",384],["T_VARIABLE","$this",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","assertEquals",385],"(",["T_CONSTANT_ENCAPSED_STRING","'stream'",385],",",["T_WHITESPACE"," ",385],["T_VARIABLE","$this",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","encryption",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","mode",385],")",";",["T_WHITESPACE","\n\t",385],"}",["T_WHITESPACE","\n\n",386],"}",["T_WHITESPACE","\n",388]]