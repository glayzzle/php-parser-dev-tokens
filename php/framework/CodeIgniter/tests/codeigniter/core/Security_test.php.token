[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_CLASS","class",3],["T_WHITESPACE"," ",3],["T_STRING","Security_test",3],["T_WHITESPACE"," ",3],["T_EXTENDS","extends",3],["T_WHITESPACE"," ",3],["T_STRING","CI_TestCase",3],["T_WHITESPACE"," ",3],"{",["T_WHITESPACE","\n\n\t",3],["T_PUBLIC","public",5],["T_WHITESPACE"," ",5],["T_FUNCTION","function",5],["T_WHITESPACE"," ",5],["T_STRING","set_up",5],"(",")",["T_WHITESPACE","\n\t",5],"{",["T_WHITESPACE","\n\t\t",6],["T_COMMENT","\/\/ Set cookie for security test\n",7],["T_WHITESPACE","\t\t",8],["T_VARIABLE","$_COOKIE",8],"[",["T_CONSTANT_ENCAPSED_STRING","'ci_csrf_cookie'",8],"]",["T_WHITESPACE"," ",8],"=",["T_WHITESPACE"," ",8],["T_STRING","md5",8],"(",["T_STRING","uniqid",8],"(",["T_STRING","mt_rand",8],"(",")",",",["T_WHITESPACE"," ",8],["T_STRING","TRUE",8],")",")",";",["T_WHITESPACE","\n\n\t\t",8],["T_COMMENT","\/\/ Set config for Security class\n",10],["T_WHITESPACE","\t\t",11],["T_VARIABLE","$this",11],["T_OBJECT_OPERATOR","->",11],["T_STRING","ci_set_config",11],"(",["T_CONSTANT_ENCAPSED_STRING","'csrf_protection'",11],",",["T_WHITESPACE"," ",11],["T_STRING","TRUE",11],")",";",["T_WHITESPACE","\n\t\t",11],["T_VARIABLE","$this",12],["T_OBJECT_OPERATOR","->",12],["T_STRING","ci_set_config",12],"(",["T_CONSTANT_ENCAPSED_STRING","'csrf_token_name'",12],",",["T_WHITESPACE"," ",12],["T_CONSTANT_ENCAPSED_STRING","'ci_csrf_token'",12],")",";",["T_WHITESPACE","\n\t\t",12],["T_VARIABLE","$this",13],["T_OBJECT_OPERATOR","->",13],["T_STRING","ci_set_config",13],"(",["T_CONSTANT_ENCAPSED_STRING","'csrf_cookie_name'",13],",",["T_WHITESPACE"," ",13],["T_CONSTANT_ENCAPSED_STRING","'ci_csrf_cookie'",13],")",";",["T_WHITESPACE","\n\n\t\t",13],["T_VARIABLE","$_SERVER",15],"[",["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",15],"]",["T_WHITESPACE"," ",15],"=",["T_WHITESPACE"," ",15],["T_CONSTANT_ENCAPSED_STRING","'GET'",15],";",["T_WHITESPACE","\n\t\t",15],["T_VARIABLE","$this",16],["T_OBJECT_OPERATOR","->",16],["T_STRING","security",16],["T_WHITESPACE"," ",16],"=",["T_WHITESPACE"," ",16],["T_NEW","new",16],["T_WHITESPACE"," ",16],["T_STRING","Mock_Core_Security",16],"(",["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",16],")",";",["T_WHITESPACE","\n\t",16],"}",["T_WHITESPACE","\n\n\t",17],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",19],["T_WHITESPACE","\n\t",20],["T_PUBLIC","public",21],["T_WHITESPACE"," ",21],["T_FUNCTION","function",21],["T_WHITESPACE"," ",21],["T_STRING","test_csrf_verify",21],"(",")",["T_WHITESPACE","\n\t",21],"{",["T_WHITESPACE","\n\t\t",22],["T_VARIABLE","$_SERVER",23],"[",["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",23],"]",["T_WHITESPACE"," ",23],"=",["T_WHITESPACE"," ",23],["T_CONSTANT_ENCAPSED_STRING","'GET'",23],";",["T_WHITESPACE","\n\n\t\t",23],["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","assertInstanceOf",25],"(",["T_CONSTANT_ENCAPSED_STRING","'CI_Security'",25],",",["T_WHITESPACE"," ",25],["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","security",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","csrf_verify",25],"(",")",")",";",["T_WHITESPACE","\n\t",25],"}",["T_WHITESPACE","\n\n\t",26],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",28],["T_WHITESPACE","\n\t",29],["T_PUBLIC","public",30],["T_WHITESPACE"," ",30],["T_FUNCTION","function",30],["T_WHITESPACE"," ",30],["T_STRING","test_csrf_verify_invalid",30],"(",")",["T_WHITESPACE","\n\t",30],"{",["T_WHITESPACE","\n\t\t",31],["T_COMMENT","\/\/ Without issuing $_POST[csrf_token_name], this request will triggering CSRF error\n",32],["T_WHITESPACE","\t\t",33],["T_VARIABLE","$_SERVER",33],"[",["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",33],"]",["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'POST'",33],";",["T_WHITESPACE","\n\n\t\t",33],["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","setExpectedException",35],"(",["T_CONSTANT_ENCAPSED_STRING","'RuntimeException'",35],",",["T_WHITESPACE"," ",35],["T_CONSTANT_ENCAPSED_STRING","'CI Error: The action you have requested is not allowed'",35],")",";",["T_WHITESPACE","\n\n\t\t",35],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","security",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","csrf_verify",37],"(",")",";",["T_WHITESPACE","\n\t",37],"}",["T_WHITESPACE","\n\n\t",38],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",40],["T_WHITESPACE","\n\t",41],["T_PUBLIC","public",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","test_csrf_verify_valid",42],"(",")",["T_WHITESPACE","\n\t",42],"{",["T_WHITESPACE","\n\t\t",43],["T_VARIABLE","$_SERVER",44],"[",["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",44],"]",["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'POST'",44],";",["T_WHITESPACE","\n\t\t",44],["T_VARIABLE","$_POST",45],"[",["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","security",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","csrf_token_name",45],"]",["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","security",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","csrf_hash",45],";",["T_WHITESPACE","\n\n\t\t",45],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","assertInstanceOf",47],"(",["T_CONSTANT_ENCAPSED_STRING","'CI_Security'",47],",",["T_WHITESPACE"," ",47],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","security",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","csrf_verify",47],"(",")",")",";",["T_WHITESPACE","\n\t",47],"}",["T_WHITESPACE","\n\n\t",48],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",50],["T_WHITESPACE","\n\t",51],["T_PUBLIC","public",52],["T_WHITESPACE"," ",52],["T_FUNCTION","function",52],["T_WHITESPACE"," ",52],["T_STRING","test_get_csrf_hash",52],"(",")",["T_WHITESPACE","\n\t",52],"{",["T_WHITESPACE","\n\t\t",53],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","assertEquals",54],"(",["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","security",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","csrf_hash",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","security",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","get_csrf_hash",54],"(",")",")",";",["T_WHITESPACE","\n\t",54],"}",["T_WHITESPACE","\n\n\t",55],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",57],["T_WHITESPACE","\n\t",58],["T_PUBLIC","public",59],["T_WHITESPACE"," ",59],["T_FUNCTION","function",59],["T_WHITESPACE"," ",59],["T_STRING","test_get_csrf_token_name",59],"(",")",["T_WHITESPACE","\n\t",59],"{",["T_WHITESPACE","\n\t\t",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","assertEquals",61],"(",["T_CONSTANT_ENCAPSED_STRING","'ci_csrf_token'",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","security",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","get_csrf_token_name",61],"(",")",")",";",["T_WHITESPACE","\n\t",61],"}",["T_WHITESPACE","\n\n\t",62],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",64],["T_WHITESPACE","\n\t",65],["T_PUBLIC","public",66],["T_WHITESPACE"," ",66],["T_FUNCTION","function",66],["T_WHITESPACE"," ",66],["T_STRING","test_xss_clean",66],"(",")",["T_WHITESPACE","\n\t",66],"{",["T_WHITESPACE","\n\t\t",67],["T_VARIABLE","$harm_string",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","\"Hello, i try to <script>alert('Hack');<\/script> your site\"",68],";",["T_WHITESPACE","\n\n\t\t",68],["T_VARIABLE","$harmless_string",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","security",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","xss_clean",70],"(",["T_VARIABLE","$harm_string",70],")",";",["T_WHITESPACE","\n\n\t\t",70],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","assertEquals",72],"(",["T_CONSTANT_ENCAPSED_STRING","\"Hello, i try to [removed]alert&#40;'Hack'&#41;;[removed] your site\"",72],",",["T_WHITESPACE"," ",72],["T_VARIABLE","$harmless_string",72],")",";",["T_WHITESPACE","\n\t",72],"}",["T_WHITESPACE","\n\n\t",73],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",75],["T_WHITESPACE","\n\t",76],["T_PUBLIC","public",77],["T_WHITESPACE"," ",77],["T_FUNCTION","function",77],["T_WHITESPACE"," ",77],["T_STRING","test_xss_clean_string_array",77],"(",")",["T_WHITESPACE","\n\t",77],"{",["T_WHITESPACE","\n\t\t",78],["T_VARIABLE","$harm_strings",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_ARRAY","array",79],"(",["T_WHITESPACE","\n\t\t\t",79],["T_CONSTANT_ENCAPSED_STRING","\"Hello, i try to <script>alert('Hack');<\/script> your site\"",80],",",["T_WHITESPACE","\n\t\t\t",80],["T_CONSTANT_ENCAPSED_STRING","\"Simple clean string\"",81],",",["T_WHITESPACE","\n\t\t\t",81],["T_CONSTANT_ENCAPSED_STRING","\"Hello, i try to <script>alert('Hack');<\/script> your site\"",82],["T_WHITESPACE","\n\t\t",82],")",";",["T_WHITESPACE","\n\n\t\t",83],["T_VARIABLE","$harmless_strings",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","security",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","xss_clean",85],"(",["T_VARIABLE","$harm_strings",85],")",";",["T_WHITESPACE","\n\n\t\t",85],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","assertEquals",87],"(",["T_CONSTANT_ENCAPSED_STRING","\"Hello, i try to [removed]alert&#40;'Hack'&#41;;[removed] your site\"",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$harmless_strings",87],"[",["T_LNUMBER","0",87],"]",")",";",["T_WHITESPACE","\n\t\t",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","assertEquals",88],"(",["T_CONSTANT_ENCAPSED_STRING","\"Simple clean string\"",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$harmless_strings",88],"[",["T_LNUMBER","1",88],"]",")",";",["T_WHITESPACE","\n\t\t",88],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","assertEquals",89],"(",["T_CONSTANT_ENCAPSED_STRING","\"Hello, i try to [removed]alert&#40;'Hack'&#41;;[removed] your site\"",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$harmless_strings",89],"[",["T_LNUMBER","2",89],"]",")",";",["T_WHITESPACE","\n\t",89],"}",["T_WHITESPACE","\n\n\t",90],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",92],["T_WHITESPACE","\n\t",93],["T_PUBLIC","public",94],["T_WHITESPACE"," ",94],["T_FUNCTION","function",94],["T_WHITESPACE"," ",94],["T_STRING","test_xss_clean_image_valid",94],"(",")",["T_WHITESPACE","\n\t",94],"{",["T_WHITESPACE","\n\t\t",95],["T_VARIABLE","$harm_string",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","'<img src=\"test.png\">'",96],";",["T_WHITESPACE","\n\n\t\t",96],["T_VARIABLE","$xss_clean_return",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","security",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","xss_clean",98],"(",["T_VARIABLE","$harm_string",98],",",["T_WHITESPACE"," ",98],["T_STRING","TRUE",98],")",";",["T_WHITESPACE","\n\n",98],["T_COMMENT","\/\/\t\t$this->assertTrue($xss_clean_return);\n",100],["T_WHITESPACE","\t",101],"}",["T_WHITESPACE","\n\n\t",101],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",103],["T_WHITESPACE","\n\t",104],["T_PUBLIC","public",105],["T_WHITESPACE"," ",105],["T_FUNCTION","function",105],["T_WHITESPACE"," ",105],["T_STRING","test_xss_clean_image_invalid",105],"(",")",["T_WHITESPACE","\n\t",105],"{",["T_WHITESPACE","\n\t\t",106],["T_VARIABLE","$harm_string",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'<img src=javascript:alert(String.fromCharCode(88,83,83))>'",107],";",["T_WHITESPACE","\n\n\t\t",107],["T_VARIABLE","$xss_clean_return",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","security",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","xss_clean",109],"(",["T_VARIABLE","$harm_string",109],",",["T_WHITESPACE"," ",109],["T_STRING","TRUE",109],")",";",["T_WHITESPACE","\n\n\t\t",109],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","assertFalse",111],"(",["T_VARIABLE","$xss_clean_return",111],")",";",["T_WHITESPACE","\n\t",111],"}",["T_WHITESPACE","\n\n\t",112],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",114],["T_WHITESPACE","\n\t",115],["T_PUBLIC","public",116],["T_WHITESPACE"," ",116],["T_FUNCTION","function",116],["T_WHITESPACE"," ",116],["T_STRING","test_xss_clean_entity_double_encoded",116],"(",")",["T_WHITESPACE","\n\t",116],"{",["T_WHITESPACE","\n\t\t",117],["T_VARIABLE","$input",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_CONSTANT_ENCAPSED_STRING","'<a href=\"&#38&#35&#49&#48&#54&#38&#35&#57&#55&#38&#35&#49&#49&#56&#38&#35&#57&#55&#38&#35&#49&#49&#53&#38&#35&#57&#57&#38&#35&#49&#49&#52&#38&#35&#49&#48&#53&#38&#35&#49&#49&#50&#38&#35&#49&#49&#54&#38&#35&#53&#56&#38&#35&#57&#57&#38&#35&#49&#49&#49&#38&#35&#49&#49&#48&#38&#35&#49&#48&#50&#38&#35&#49&#48&#53&#38&#35&#49&#49&#52&#38&#35&#49&#48&#57&#38&#35&#52&#48&#38&#35&#52&#57&#38&#35&#52&#49\">Clickhere<\/a>'",118],";",["T_WHITESPACE","\n\t\t",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","assertEquals",119],"(",["T_CONSTANT_ENCAPSED_STRING","'<a>Clickhere<\/a>'",119],",",["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","security",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","xss_clean",119],"(",["T_VARIABLE","$input",119],")",")",";",["T_WHITESPACE","\n\t",119],"}",["T_WHITESPACE","\n\n\t",120],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",122],["T_WHITESPACE","\n\t",123],["T_PUBLIC","public",124],["T_WHITESPACE"," ",124],["T_FUNCTION","function",124],["T_WHITESPACE"," ",124],["T_STRING","text_xss_clean_js_link_removal",124],"(",")",["T_WHITESPACE","\n\t",124],"{",["T_WHITESPACE","\n\t\t",125],["T_COMMENT","\/\/ This one is to prevent a false positive\n",126],["T_WHITESPACE","\t\t",127],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","assertEquals",127],"(",["T_WHITESPACE","\n\t\t\t",127],["T_CONSTANT_ENCAPSED_STRING","\"<a href=\\\"javascrip\\n<t\\n:alert\\n&#40;1&#41;\\\"\\n>\"",128],",",["T_WHITESPACE","\n\t\t\t",128],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","security",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","xss_clean",129],"(",["T_CONSTANT_ENCAPSED_STRING","\"<a href=\\\"javascrip\\n<t\\n:alert\\n(1)\\\"\\n>\"",129],")",["T_WHITESPACE","\n\t\t",129],")",";",["T_WHITESPACE","\n\t",130],"}",["T_WHITESPACE","\n\n\t",131],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",133],["T_WHITESPACE","\n\t",134],["T_PUBLIC","public",135],["T_WHITESPACE"," ",135],["T_FUNCTION","function",135],["T_WHITESPACE"," ",135],["T_STRING","test_xss_clean_js_img_removal",135],"(",")",["T_WHITESPACE","\n\t",135],"{",["T_WHITESPACE","\n\t\t",136],["T_VARIABLE","$input",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'<img src=\"&#38&#35&#49&#48&#54&#38&#35&#57&#55&#38&#35&#49&#49&#56&#38&#35&#57&#55&#38&#35&#49&#49&#53&#38&#35&#57&#57&#38&#35&#49&#49&#52&#38&#35&#49&#48&#53&#38&#35&#49&#49&#50&#38&#35&#49&#49&#54&#38&#35&#53&#56&#38&#35&#57&#57&#38&#35&#49&#49&#49&#38&#35&#49&#49&#48&#38&#35&#49&#48&#50&#38&#35&#49&#48&#53&#38&#35&#49&#49&#52&#38&#35&#49&#48&#57&#38&#35&#52&#48&#38&#35&#52&#57&#38&#35&#52&#49\">Clickhere'",137],";",["T_WHITESPACE","\n\t\t",137],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","assertEquals",138],"(",["T_CONSTANT_ENCAPSED_STRING","'<img>'",138],",",["T_WHITESPACE"," ",138],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","security",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","xss_clean",138],"(",["T_VARIABLE","$input",138],")",")",";",["T_WHITESPACE","\n\t",138],"}",["T_WHITESPACE","\n\n\t",139],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",141],["T_WHITESPACE","\n\t",142],["T_PUBLIC","public",143],["T_WHITESPACE"," ",143],["T_FUNCTION","function",143],["T_WHITESPACE"," ",143],["T_STRING","test_xss_clean_sanitize_naughty_html_tags",143],"(",")",["T_WHITESPACE","\n\t",143],"{",["T_WHITESPACE","\n\t\t",144],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","assertEquals",145],"(",["T_CONSTANT_ENCAPSED_STRING","'&lt;unclosedTag'",145],",",["T_WHITESPACE"," ",145],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","security",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","xss_clean",145],"(",["T_CONSTANT_ENCAPSED_STRING","'<unclosedTag'",145],")",")",";",["T_WHITESPACE","\n\t\t",145],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","assertEquals",146],"(",["T_CONSTANT_ENCAPSED_STRING","'&lt;blink&gt;'",146],",",["T_WHITESPACE"," ",146],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","security",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","xss_clean",146],"(",["T_CONSTANT_ENCAPSED_STRING","'<blink>'",146],")",")",";",["T_WHITESPACE","\n\t\t",146],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","assertEquals",147],"(",["T_CONSTANT_ENCAPSED_STRING","'<fubar>'",147],",",["T_WHITESPACE"," ",147],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","security",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","xss_clean",147],"(",["T_CONSTANT_ENCAPSED_STRING","'<fubar>'",147],")",")",";",["T_WHITESPACE","\n\n\t\t",147],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","assertEquals",149],"(",["T_WHITESPACE","\n\t\t\t",149],["T_CONSTANT_ENCAPSED_STRING","'<img svg=\"\"> src=\"x\">'",150],",",["T_WHITESPACE","\n\t\t\t",150],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","security",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","xss_clean",151],"(",["T_CONSTANT_ENCAPSED_STRING","'<img <svg=\"\"> src=\"x\">'",151],")",["T_WHITESPACE","\n\t\t",151],")",";",["T_WHITESPACE","\n\n\t\t",152],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","assertEquals",154],"(",["T_WHITESPACE","\n\t\t\t",154],["T_CONSTANT_ENCAPSED_STRING","'<img src=\"b on=\">on=\">\"x onerror=\"alert&#40;1&#41;\">'",155],",",["T_WHITESPACE","\n\t\t\t",155],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","security",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","xss_clean",156],"(",["T_CONSTANT_ENCAPSED_STRING","'<img src=\"b on=\"<x\">on=\">\"x onerror=\"alert(1)\">'",156],")",["T_WHITESPACE","\n\t\t",156],")",";",["T_WHITESPACE","\n\n\t\t",157],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","assertEquals",159],"(",["T_WHITESPACE","\n\t\t\t",159],["T_CONSTANT_ENCAPSED_STRING","\"\\n>&lt;!-\\n<b d=\\\"'e><iframe onload=alert&#40;1&#41; src=x>\\n<a HREF=\\\">\\n\"",160],",",["T_WHITESPACE","\n\t\t\t",160],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","security",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","xss_clean",161],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\n><!-\\n<b\\n<c d=\\\"'e><iframe onload=alert(1) src=x>\\n<a HREF=\\\"\\\">\\n\"",161],")",["T_WHITESPACE","\n\t\t",161],")",";",["T_WHITESPACE","\n\t",162],"}",["T_WHITESPACE","\n\n\t",163],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",165],["T_WHITESPACE","\n\t",166],["T_PUBLIC","public",167],["T_WHITESPACE"," ",167],["T_FUNCTION","function",167],["T_WHITESPACE"," ",167],["T_STRING","test_xss_clean_sanitize_naughty_html_attributes",167],"(",")",["T_WHITESPACE","\n\t",167],"{",["T_WHITESPACE","\n\t\t",168],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","assertEquals",169],"(",["T_CONSTANT_ENCAPSED_STRING","'<foo xss=removed>'",169],",",["T_WHITESPACE"," ",169],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","security",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","xss_clean",169],"(",["T_CONSTANT_ENCAPSED_STRING","'<foo onAttribute=\"bar\">'",169],")",")",";",["T_WHITESPACE","\n\t\t",169],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","assertEquals",170],"(",["T_CONSTANT_ENCAPSED_STRING","'<foo xss=removed>'",170],",",["T_WHITESPACE"," ",170],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","security",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","xss_clean",170],"(",["T_CONSTANT_ENCAPSED_STRING","'<foo onAttributeNoQuotes=bar>'",170],")",")",";",["T_WHITESPACE","\n\t\t",170],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","assertEquals",171],"(",["T_CONSTANT_ENCAPSED_STRING","'<foo xss=removed>'",171],",",["T_WHITESPACE"," ",171],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","security",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","xss_clean",171],"(",["T_CONSTANT_ENCAPSED_STRING","'<foo onAttributeWithSpaces = bar>'",171],")",")",";",["T_WHITESPACE","\n\t\t",171],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","assertEquals",172],"(",["T_CONSTANT_ENCAPSED_STRING","'<foo prefixOnAttribute=\"bar\">'",172],",",["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","security",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","xss_clean",172],"(",["T_CONSTANT_ENCAPSED_STRING","'<foo prefixOnAttribute=\"bar\">'",172],")",")",";",["T_WHITESPACE","\n\t\t",172],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","assertEquals",173],"(",["T_CONSTANT_ENCAPSED_STRING","'<foo>onOutsideOfTag=test<\/foo>'",173],",",["T_WHITESPACE"," ",173],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","security",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","xss_clean",173],"(",["T_CONSTANT_ENCAPSED_STRING","'<foo>onOutsideOfTag=test<\/foo>'",173],")",")",";",["T_WHITESPACE","\n\t\t",173],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","assertEquals",174],"(",["T_CONSTANT_ENCAPSED_STRING","'onNoTagAtAll = true'",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","security",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","xss_clean",174],"(",["T_CONSTANT_ENCAPSED_STRING","'onNoTagAtAll = true'",174],")",")",";",["T_WHITESPACE","\n\t\t",174],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","assertEquals",175],"(",["T_CONSTANT_ENCAPSED_STRING","'<foo xss=removed>'",175],",",["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","security",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","xss_clean",175],"(",["T_CONSTANT_ENCAPSED_STRING","'<foo fscommand=case-insensitive>'",175],")",")",";",["T_WHITESPACE","\n\t\t",175],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","assertEquals",176],"(",["T_CONSTANT_ENCAPSED_STRING","'<foo xss=removed>'",176],",",["T_WHITESPACE"," ",176],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","security",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","xss_clean",176],"(",["T_CONSTANT_ENCAPSED_STRING","'<foo seekSegmentTime=whatever>'",176],")",")",";",["T_WHITESPACE","\n\n\t\t",176],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","assertEquals",178],"(",["T_WHITESPACE","\n\t\t\t",178],["T_CONSTANT_ENCAPSED_STRING","'<foo bar=\">\" baz=\\'>\\' xss=removed>'",179],",",["T_WHITESPACE","\n\t\t\t",179],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","security",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","xss_clean",180],"(",["T_CONSTANT_ENCAPSED_STRING","'<foo bar=\">\" baz=\\'>\\' onAfterGreaterThan=\"quotes\">'",180],")",["T_WHITESPACE","\n\t\t",180],")",";",["T_WHITESPACE","\n\t\t",181],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","assertEquals",182],"(",["T_WHITESPACE","\n\t\t\t",182],["T_CONSTANT_ENCAPSED_STRING","'<foo bar=\">\" baz=\\'>\\' xss=removed>'",183],",",["T_WHITESPACE","\n\t\t\t",183],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","security",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","xss_clean",184],"(",["T_CONSTANT_ENCAPSED_STRING","'<foo bar=\">\" baz=\\'>\\' onAfterGreaterThan=noQuotes>'",184],")",["T_WHITESPACE","\n\t\t",184],")",";",["T_WHITESPACE","\n\n\t\t",185],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","assertEquals",187],"(",["T_WHITESPACE","\n\t\t\t",187],["T_CONSTANT_ENCAPSED_STRING","'<img src=\"x\" on=\"\"> on=&lt;svg&gt; onerror=alert&#40;1&#41;>'",188],",",["T_WHITESPACE","\n\t\t\t",188],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","security",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","xss_clean",189],"(",["T_CONSTANT_ENCAPSED_STRING","'<img src=\"x\" on=\"\"> on=<svg> onerror=alert(1)>'",189],")",["T_WHITESPACE","\n\t\t",189],")",";",["T_WHITESPACE","\n\n\t\t",190],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","assertEquals",192],"(",["T_WHITESPACE","\n\t\t\t",192],["T_CONSTANT_ENCAPSED_STRING","'<img src=\"on=\\'\">\"&lt;svg&gt; onerror=alert&#40;1&#41; onmouseover=alert&#40;1&#41;>'",193],",",["T_WHITESPACE","\n\t\t\t",193],["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","security",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","xss_clean",194],"(",["T_CONSTANT_ENCAPSED_STRING","'<img src=\"on=\\'\">\"<svg> onerror=alert(1) onmouseover=alert(1)>'",194],")",["T_WHITESPACE","\n\t\t",194],")",";",["T_WHITESPACE","\n\n\t\t",195],["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","assertEquals",197],"(",["T_WHITESPACE","\n\t\t\t",197],["T_CONSTANT_ENCAPSED_STRING","'<img src=\"x\"> on=\\'x\\' onerror=``,alert&#40;1&#41;>'",198],",",["T_WHITESPACE","\n\t\t\t",198],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","security",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","xss_clean",199],"(",["T_CONSTANT_ENCAPSED_STRING","'<img src=\"x\"> on=\\'x\\' onerror=``,alert(1)>'",199],")",["T_WHITESPACE","\n\t\t",199],")",";",["T_WHITESPACE","\n\n\t\t",200],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","assertEquals",202],"(",["T_WHITESPACE","\n\t\t\t",202],["T_CONSTANT_ENCAPSED_STRING","'<a xss=removed>'",203],",",["T_WHITESPACE","\n\t\t\t",203],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","security",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","xss_clean",204],"(",["T_CONSTANT_ENCAPSED_STRING","'<a< onmouseover=\"alert(1)\">'",204],")",["T_WHITESPACE","\n\t\t",204],")",";",["T_WHITESPACE","\n\n\t\t",205],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","assertEquals",207],"(",["T_WHITESPACE","\n\t\t\t",207],["T_CONSTANT_ENCAPSED_STRING","'<img src=\"x\"> on=\\'x\\' onerror=,xssm()>'",208],",",["T_WHITESPACE","\n\t\t\t",208],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","security",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","xss_clean",209],"(",["T_CONSTANT_ENCAPSED_STRING","'<img src=\"x\"> on=\\'x\\' onerror=,xssm()>'",209],")",["T_WHITESPACE","\n\t\t",209],")",";",["T_WHITESPACE","\n\n\t\t",210],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","assertEquals",212],"(",["T_WHITESPACE","\n\t\t\t",212],["T_CONSTANT_ENCAPSED_STRING","'<image src=\"<>\" xss=removed>'",213],",",["T_WHITESPACE","\n\t\t\t",213],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","security",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","xss_clean",214],"(",["T_CONSTANT_ENCAPSED_STRING","'<image src=\"<>\" onerror=\\'alert(1)\\'>'",214],")",["T_WHITESPACE","\n\t\t",214],")",";",["T_WHITESPACE","\n\n\t\t",215],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","assertEquals",217],"(",["T_WHITESPACE","\n\t\t\t",217],["T_CONSTANT_ENCAPSED_STRING","'<b xss=removed>'",218],",",["T_WHITESPACE","\n\t\t\t",218],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","security",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","xss_clean",219],"(",["T_CONSTANT_ENCAPSED_STRING","'<b \"=<= onmouseover=alert(1)>'",219],")",["T_WHITESPACE","\n\t\t",219],")",";",["T_WHITESPACE","\n\n\t\t",220],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","assertEquals",222],"(",["T_WHITESPACE","\n\t\t\t",222],["T_CONSTANT_ENCAPSED_STRING","'<b xss=removed xss=removed>1\">'",223],",",["T_WHITESPACE","\n\t\t\t",223],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","security",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","xss_clean",224],"(",["T_CONSTANT_ENCAPSED_STRING","'<b a=<=\" onmouseover=\"alert(1),1>1\">'",224],")",["T_WHITESPACE","\n\t\t",224],")",";",["T_WHITESPACE","\n\n\t\t",225],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","assertEquals",227],"(",["T_WHITESPACE","\n\t\t\t",227],["T_CONSTANT_ENCAPSED_STRING","'<b x=\" onmouseover=alert&#40;1&#41;\/\/\">'",228],",",["T_WHITESPACE","\n\t\t\t",228],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","security",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","xss_clean",229],"(",["T_CONSTANT_ENCAPSED_STRING","'<b \"=\"< x=\" onmouseover=alert(1)\/\/\">'",229],")",["T_WHITESPACE","\n\t\t",229],")",";",["T_WHITESPACE","\n\t",230],"}",["T_WHITESPACE","\n\n\t",231],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",233],["T_WHITESPACE","\n\t",234],["T_DOC_COMMENT","\/**\n\t * @depends test_xss_clean_sanitize_naughty_html_tags\n\t * @depends test_xss_clean_sanitize_naughty_html_attributes\n\t *\/",235],["T_WHITESPACE","\n\t",238],["T_PUBLIC","public",239],["T_WHITESPACE"," ",239],["T_FUNCTION","function",239],["T_WHITESPACE"," ",239],["T_STRING","test_naughty_html_plus_evil_attributes",239],"(",")",["T_WHITESPACE","\n\t",239],"{",["T_WHITESPACE","\n\t\t",240],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","assertEquals",241],"(",["T_WHITESPACE","\n\t\t\t",241],["T_CONSTANT_ENCAPSED_STRING","'&lt;svg<img src=\"x\" xss=removed>'",242],",",["T_WHITESPACE","\n\t\t\t",242],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","security",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","xss_clean",243],"(",["T_CONSTANT_ENCAPSED_STRING","'<svg<img > src=\"x\" onerror=\"location=\/javascript\/.source+\/:alert\/.source+\/(1)\/.source\">'",243],")",["T_WHITESPACE","\n\t\t",243],")",";",["T_WHITESPACE","\n\t",244],"}",["T_WHITESPACE","\n\n\t",245],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",247],["T_WHITESPACE","\n\t",248],["T_PUBLIC","public",249],["T_WHITESPACE"," ",249],["T_FUNCTION","function",249],["T_WHITESPACE"," ",249],["T_STRING","test_xss_hash",249],"(",")",["T_WHITESPACE","\n\t",249],"{",["T_WHITESPACE","\n\t\t",250],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","assertEmpty",251],"(",["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","security",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","xss_hash",251],")",";",["T_WHITESPACE","\n\n\t\t",251],["T_COMMENT","\/\/ Perform hash\n",253],["T_WHITESPACE","\t\t",254],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","security",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","xss_hash",254],"(",")",";",["T_WHITESPACE","\n\n\t\t",254],["T_VARIABLE","$this",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","assertTrue",256],"(",["T_STRING","preg_match",256],"(",["T_CONSTANT_ENCAPSED_STRING","'#^[0-9a-f]{32}$#iS'",256],",",["T_WHITESPACE"," ",256],["T_VARIABLE","$this",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","security",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","xss_hash",256],")",["T_WHITESPACE"," ",256],["T_IS_IDENTICAL","===",256],["T_WHITESPACE"," ",256],["T_LNUMBER","1",256],")",";",["T_WHITESPACE","\n\t",256],"}",["T_WHITESPACE","\n\n\t",257],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",259],["T_WHITESPACE","\n\t",260],["T_PUBLIC","public",261],["T_WHITESPACE"," ",261],["T_FUNCTION","function",261],["T_WHITESPACE"," ",261],["T_STRING","test_get_random_bytes",261],"(",")",["T_WHITESPACE","\n\t",261],"{",["T_WHITESPACE","\n\t\t",262],["T_VARIABLE","$length",263],["T_WHITESPACE"," ",263],"=",["T_WHITESPACE"," ",263],["T_CONSTANT_ENCAPSED_STRING","\"invalid\"",263],";",["T_WHITESPACE","\n\t\t",263],["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","assertFalse",264],"(",["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","security",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","get_random_bytes",264],"(",["T_VARIABLE","$length",264],")",")",";",["T_WHITESPACE","\n\n\t\t",264],["T_VARIABLE","$length",266],["T_WHITESPACE"," ",266],"=",["T_WHITESPACE"," ",266],["T_LNUMBER","10",266],";",["T_WHITESPACE","\n\t\t",266],["T_VARIABLE","$this",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","assertNotEmpty",267],"(",["T_VARIABLE","$this",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","security",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","get_random_bytes",267],"(",["T_VARIABLE","$length",267],")",")",";",["T_WHITESPACE","\n\t",267],"}",["T_WHITESPACE","\n\n\t",268],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",270],["T_WHITESPACE","\n\t",271],["T_PUBLIC","public",272],["T_WHITESPACE"," ",272],["T_FUNCTION","function",272],["T_WHITESPACE"," ",272],["T_STRING","test_entity_decode",272],"(",")",["T_WHITESPACE","\n\t",272],"{",["T_WHITESPACE","\n\t\t",273],["T_VARIABLE","$encoded",274],["T_WHITESPACE"," ",274],"=",["T_WHITESPACE"," ",274],["T_CONSTANT_ENCAPSED_STRING","'&lt;div&gt;Hello &lt;b&gt;Booya&lt;\/b&gt;&lt;\/div&gt;'",274],";",["T_WHITESPACE","\n\t\t",274],["T_VARIABLE","$decoded",275],["T_WHITESPACE"," ",275],"=",["T_WHITESPACE"," ",275],["T_VARIABLE","$this",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","security",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","entity_decode",275],"(",["T_VARIABLE","$encoded",275],")",";",["T_WHITESPACE","\n\n\t\t",275],["T_VARIABLE","$this",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","assertEquals",277],"(",["T_CONSTANT_ENCAPSED_STRING","'<div>Hello <b>Booya<\/b><\/div>'",277],",",["T_WHITESPACE"," ",277],["T_VARIABLE","$decoded",277],")",";",["T_WHITESPACE","\n\n\t\t",277],["T_VARIABLE","$this",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","assertEquals",279],"(",["T_CONSTANT_ENCAPSED_STRING","'colon:'",279],",",["T_WHITESPACE","    ",279],["T_VARIABLE","$this",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","security",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","entity_decode",279],"(",["T_CONSTANT_ENCAPSED_STRING","'colon&colon;'",279],")",")",";",["T_WHITESPACE","\n\t\t",279],["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","assertEquals",280],"(",["T_CONSTANT_ENCAPSED_STRING","\"NewLine\\n\"",280],",",["T_WHITESPACE"," ",280],["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","security",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","entity_decode",280],"(",["T_CONSTANT_ENCAPSED_STRING","'NewLine&NewLine;'",280],")",")",";",["T_WHITESPACE","\n\t\t",280],["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","assertEquals",281],"(",["T_CONSTANT_ENCAPSED_STRING","\"Tab\\t\"",281],",",["T_WHITESPACE","     ",281],["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","security",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","entity_decode",281],"(",["T_CONSTANT_ENCAPSED_STRING","'Tab&Tab;'",281],")",")",";",["T_WHITESPACE","\n\t\t",281],["T_VARIABLE","$this",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","assertEquals",282],"(",["T_CONSTANT_ENCAPSED_STRING","\"lpar(\"",282],",",["T_WHITESPACE","     ",282],["T_VARIABLE","$this",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","security",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","entity_decode",282],"(",["T_CONSTANT_ENCAPSED_STRING","'lpar&lpar;'",282],")",")",";",["T_WHITESPACE","\n\t\t",282],["T_VARIABLE","$this",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","assertEquals",283],"(",["T_CONSTANT_ENCAPSED_STRING","\"rpar)\"",283],",",["T_WHITESPACE","     ",283],["T_VARIABLE","$this",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","security",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","entity_decode",283],"(",["T_CONSTANT_ENCAPSED_STRING","'rpar&rpar;'",283],")",")",";",["T_WHITESPACE","\n\n\t\t",283],["T_COMMENT","\/\/ Issue #3057 (https:\/\/github.com\/bcit-ci\/CodeIgniter\/issues\/3057)\n",285],["T_WHITESPACE","\t\t",286],["T_VARIABLE","$this",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","assertEquals",286],"(",["T_WHITESPACE","\n\t\t\t",286],["T_CONSTANT_ENCAPSED_STRING","'&foo should not include a semicolon'",287],",",["T_WHITESPACE","\n\t\t\t",287],["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","security",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","entity_decode",288],"(",["T_CONSTANT_ENCAPSED_STRING","'&foo should not include a semicolon'",288],")",["T_WHITESPACE","\n\t\t",288],")",";",["T_WHITESPACE","\n\t",289],"}",["T_WHITESPACE","\n\n\t",290],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",292],["T_WHITESPACE","\n\t",293],["T_PUBLIC","public",294],["T_WHITESPACE"," ",294],["T_FUNCTION","function",294],["T_WHITESPACE"," ",294],["T_STRING","test_sanitize_filename",294],"(",")",["T_WHITESPACE","\n\t",294],"{",["T_WHITESPACE","\n\t\t",295],["T_VARIABLE","$filename",296],["T_WHITESPACE"," ",296],"=",["T_WHITESPACE"," ",296],["T_CONSTANT_ENCAPSED_STRING","'.\/<!--foo-->'",296],";",["T_WHITESPACE","\n\t\t",296],["T_VARIABLE","$safe_filename",297],["T_WHITESPACE"," ",297],"=",["T_WHITESPACE"," ",297],["T_VARIABLE","$this",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","security",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","sanitize_filename",297],"(",["T_VARIABLE","$filename",297],")",";",["T_WHITESPACE","\n\n\t\t",297],["T_VARIABLE","$this",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","assertEquals",299],"(",["T_CONSTANT_ENCAPSED_STRING","'foo'",299],",",["T_WHITESPACE"," ",299],["T_VARIABLE","$safe_filename",299],")",";",["T_WHITESPACE","\n\t",299],"}",["T_WHITESPACE","\n\n\t",300],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",302],["T_WHITESPACE","\n\t",303],["T_PUBLIC","public",304],["T_WHITESPACE"," ",304],["T_FUNCTION","function",304],["T_WHITESPACE"," ",304],["T_STRING","test_strip_image_tags",304],"(",")",["T_WHITESPACE","\n\t",304],"{",["T_WHITESPACE","\n\t\t",305],["T_VARIABLE","$imgtags",306],["T_WHITESPACE"," ",306],"=",["T_WHITESPACE"," ",306],["T_ARRAY","array",306],"(",["T_WHITESPACE","\n\t\t\t",306],["T_CONSTANT_ENCAPSED_STRING","'<img src=\"smiley.gif\" alt=\"Smiley face\" height=\"42\" width=\"42\">'",307],",",["T_WHITESPACE","\n\t\t\t",307],["T_CONSTANT_ENCAPSED_STRING","'<img alt=\"Smiley face\" height=\"42\" width=\"42\" src=\"smiley.gif\">'",308],",",["T_WHITESPACE","\n\t\t\t",308],["T_CONSTANT_ENCAPSED_STRING","'<img src=\"http:\/\/www.w3schools.com\/images\/w3schools_green.jpg\">'",309],",",["T_WHITESPACE","\n\t\t\t",309],["T_CONSTANT_ENCAPSED_STRING","'<img src=\"\/img\/sunset.gif\" height=\"100%\" width=\"100%\">'",310],",",["T_WHITESPACE","\n\t\t\t",310],["T_CONSTANT_ENCAPSED_STRING","'<img src=\"mdn-logo-sm.png\" alt=\"MD Logo\" srcset=\"mdn-logo-HD.png 2x, mdn-logo-small.png 15w, mdn-banner-HD.png 100w 2x\" \/>'",311],",",["T_WHITESPACE","\n\t\t\t",311],["T_CONSTANT_ENCAPSED_STRING","'<img sqrc=\"\/img\/sunset.gif\" height=\"100%\" width=\"100%\">'",312],",",["T_WHITESPACE","\n\t\t\t",312],["T_CONSTANT_ENCAPSED_STRING","'<img srqc=\"\/img\/sunset.gif\" height=\"100%\" width=\"100%\">'",313],",",["T_WHITESPACE","\n\t\t\t",313],["T_CONSTANT_ENCAPSED_STRING","'<img srcq=\"\/img\/sunset.gif\" height=\"100%\" width=\"100%\">'",314],",",["T_WHITESPACE","\n\t\t\t",314],["T_CONSTANT_ENCAPSED_STRING","'<img src=non-quoted.attribute foo=\"bar\">'",315],["T_WHITESPACE","\n\t\t",315],")",";",["T_WHITESPACE","\n\n\t\t",316],["T_VARIABLE","$urls",318],["T_WHITESPACE"," ",318],"=",["T_WHITESPACE"," ",318],["T_ARRAY","array",318],"(",["T_WHITESPACE","\n\t\t\t",318],["T_CONSTANT_ENCAPSED_STRING","'smiley.gif'",319],",",["T_WHITESPACE","\n\t\t\t",319],["T_CONSTANT_ENCAPSED_STRING","'smiley.gif'",320],",",["T_WHITESPACE","\n\t\t\t",320],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/www.w3schools.com\/images\/w3schools_green.jpg'",321],",",["T_WHITESPACE","\n\t\t\t",321],["T_CONSTANT_ENCAPSED_STRING","'\/img\/sunset.gif'",322],",",["T_WHITESPACE","\n\t\t\t",322],["T_CONSTANT_ENCAPSED_STRING","'mdn-logo-sm.png'",323],",",["T_WHITESPACE","\n\t\t\t",323],["T_CONSTANT_ENCAPSED_STRING","'<img sqrc=\"\/img\/sunset.gif\" height=\"100%\" width=\"100%\">'",324],",",["T_WHITESPACE","\n\t\t\t",324],["T_CONSTANT_ENCAPSED_STRING","'<img srqc=\"\/img\/sunset.gif\" height=\"100%\" width=\"100%\">'",325],",",["T_WHITESPACE","\n\t\t\t",325],["T_CONSTANT_ENCAPSED_STRING","'<img srcq=\"\/img\/sunset.gif\" height=\"100%\" width=\"100%\">'",326],",",["T_WHITESPACE","\n\t\t\t",326],["T_CONSTANT_ENCAPSED_STRING","'non-quoted.attribute'",327],["T_WHITESPACE","\n\t\t",327],")",";",["T_WHITESPACE","\n\n\t\t",328],["T_FOR","for",330],["T_WHITESPACE"," ",330],"(",["T_VARIABLE","$i",330],["T_WHITESPACE"," ",330],"=",["T_WHITESPACE"," ",330],["T_LNUMBER","0",330],";",["T_WHITESPACE"," ",330],["T_VARIABLE","$i",330],["T_WHITESPACE"," ",330],"<",["T_WHITESPACE"," ",330],["T_STRING","count",330],"(",["T_VARIABLE","$imgtags",330],")",";",["T_WHITESPACE"," ",330],["T_VARIABLE","$i",330],["T_INC","++",330],")",["T_WHITESPACE","\n\t\t",330],"{",["T_WHITESPACE","\n\t\t\t",331],["T_VARIABLE","$this",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","assertEquals",332],"(",["T_VARIABLE","$urls",332],"[",["T_VARIABLE","$i",332],"]",",",["T_WHITESPACE"," ",332],["T_VARIABLE","$this",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","security",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","strip_image_tags",332],"(",["T_VARIABLE","$imgtags",332],"[",["T_VARIABLE","$i",332],"]",")",")",";",["T_WHITESPACE","\n\t\t",332],"}",["T_WHITESPACE","\n\t",333],"}",["T_WHITESPACE","\n\n\t",334],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",336],["T_WHITESPACE","\n\t",337],["T_PUBLIC","public",338],["T_WHITESPACE"," ",338],["T_FUNCTION","function",338],["T_WHITESPACE"," ",338],["T_STRING","test_csrf_set_hash",338],"(",")",["T_WHITESPACE","\n\t",338],"{",["T_WHITESPACE","\n\t\t",339],["T_COMMENT","\/\/ Set cookie for security test\n",340],["T_WHITESPACE","\t\t",341],["T_VARIABLE","$_COOKIE",341],"[",["T_CONSTANT_ENCAPSED_STRING","'ci_csrf_cookie'",341],"]",["T_WHITESPACE"," ",341],"=",["T_WHITESPACE"," ",341],["T_STRING","md5",341],"(",["T_STRING","uniqid",341],"(",["T_STRING","mt_rand",341],"(",")",",",["T_WHITESPACE"," ",341],["T_STRING","TRUE",341],")",")",";",["T_WHITESPACE","\n\n\t\t",341],["T_COMMENT","\/\/ Set config for Security class\n",343],["T_WHITESPACE","\t\t",344],["T_VARIABLE","$this",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","ci_set_config",344],"(",["T_CONSTANT_ENCAPSED_STRING","'csrf_protection'",344],",",["T_WHITESPACE"," ",344],["T_STRING","TRUE",344],")",";",["T_WHITESPACE","\n\t\t",344],["T_VARIABLE","$this",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","ci_set_config",345],"(",["T_CONSTANT_ENCAPSED_STRING","'csrf_token_name'",345],",",["T_WHITESPACE"," ",345],["T_CONSTANT_ENCAPSED_STRING","'ci_csrf_token'",345],")",";",["T_WHITESPACE","\n\n\t\t",345],["T_COMMENT","\/\/ leave csrf_cookie_name as blank to test _csrf_set_hash function\n",347],["T_WHITESPACE","\t\t",348],["T_VARIABLE","$this",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","ci_set_config",348],"(",["T_CONSTANT_ENCAPSED_STRING","'csrf_cookie_name'",348],",",["T_WHITESPACE"," ",348],["T_CONSTANT_ENCAPSED_STRING","''",348],")",";",["T_WHITESPACE","\n\n\t\t",348],["T_VARIABLE","$this",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","security",350],["T_WHITESPACE"," ",350],"=",["T_WHITESPACE"," ",350],["T_NEW","new",350],["T_WHITESPACE"," ",350],["T_STRING","Mock_Core_Security",350],"(",["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",350],")",";",["T_WHITESPACE","\n\n\t\t",350],["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","assertNotEmpty",352],"(",["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","security",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","get_csrf_hash",352],"(",")",")",";",["T_WHITESPACE","\n\t",352],"}",["T_WHITESPACE","\n",353],"}",["T_WHITESPACE","\n",354]]