[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CodeIgniter\n *\n * An open source application development framework for PHP\n *\n * This content is released under the MIT License (MIT)\n *\n * Copyright (c) 2014 - 2017, British Columbia Institute of Technology\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and\/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n *\n * @package\tCodeIgniter\n * @author\tEllisLab Dev Team\n * @copyright\tCopyright (c) 2008 - 2014, EllisLab, Inc. (https:\/\/ellislab.com\/)\n * @copyright\tCopyright (c) 2014 - 2017, British Columbia Institute of Technology (http:\/\/bcit.ca\/)\n * @license\thttp:\/\/opensource.org\/licenses\/MIT\tMIT License\n * @link\thttps:\/\/codeigniter.com\n * @since\tVersion 1.0.0\n * @filesource\n *\/",2],["T_WHITESPACE","\n",37],["T_STRING","defined",38],"(",["T_CONSTANT_ENCAPSED_STRING","'BASEPATH'",38],")",["T_WHITESPACE"," ",38],["T_LOGICAL_OR","OR",38],["T_WHITESPACE"," ",38],["T_EXIT","exit",38],"(",["T_CONSTANT_ENCAPSED_STRING","'No direct script access allowed'",38],")",";",["T_WHITESPACE","\n\n",38],["T_DOC_COMMENT","\/**\n * Security Class\n *\n * @package\t\tCodeIgniter\n * @subpackage\tLibraries\n * @category\tSecurity\n * @author\t\tEllisLab Dev Team\n * @link\t\thttps:\/\/codeigniter.com\/user_guide\/libraries\/security.html\n *\/",40],["T_WHITESPACE","\n",48],["T_CLASS","class",49],["T_WHITESPACE"," ",49],["T_STRING","CI_Security",49],["T_WHITESPACE"," ",49],"{",["T_WHITESPACE","\n\n\t",49],["T_DOC_COMMENT","\/**\n\t * List of sanitize filename strings\n\t *\n\t * @var\tarray\n\t *\/",51],["T_WHITESPACE","\n\t",55],["T_PUBLIC","public",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$filename_bad_chars",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE","\t",56],["T_ARRAY","array",56],"(",["T_WHITESPACE","\n\t\t",56],["T_CONSTANT_ENCAPSED_STRING","'..\/'",57],",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'<!--'",57],",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'-->'",57],",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'<'",57],",",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'>'",57],",",["T_WHITESPACE","\n\t\t",57],["T_CONSTANT_ENCAPSED_STRING","\"'\"",58],",",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'\"'",58],",",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'&'",58],",",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'$'",58],",",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'#'",58],",",["T_WHITESPACE","\n\t\t",58],["T_CONSTANT_ENCAPSED_STRING","'{'",59],",",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'}'",59],",",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'['",59],",",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","']'",59],",",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'='",59],",",["T_WHITESPACE","\n\t\t",59],["T_CONSTANT_ENCAPSED_STRING","';'",60],",",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'?'",60],",",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'%20'",60],",",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'%22'",60],",",["T_WHITESPACE","\n\t\t",60],["T_CONSTANT_ENCAPSED_STRING","'%3c'",61],",",["T_WHITESPACE","\t\t",61],["T_COMMENT","\/\/ <\n",61],["T_WHITESPACE","\t\t",62],["T_CONSTANT_ENCAPSED_STRING","'%253c'",62],",",["T_WHITESPACE","\t",62],["T_COMMENT","\/\/ <\n",62],["T_WHITESPACE","\t\t",63],["T_CONSTANT_ENCAPSED_STRING","'%3e'",63],",",["T_WHITESPACE","\t\t",63],["T_COMMENT","\/\/ >\n",63],["T_WHITESPACE","\t\t",64],["T_CONSTANT_ENCAPSED_STRING","'%0e'",64],",",["T_WHITESPACE","\t\t",64],["T_COMMENT","\/\/ >\n",64],["T_WHITESPACE","\t\t",65],["T_CONSTANT_ENCAPSED_STRING","'%28'",65],",",["T_WHITESPACE","\t\t",65],["T_COMMENT","\/\/ (\n",65],["T_WHITESPACE","\t\t",66],["T_CONSTANT_ENCAPSED_STRING","'%29'",66],",",["T_WHITESPACE","\t\t",66],["T_COMMENT","\/\/ )\n",66],["T_WHITESPACE","\t\t",67],["T_CONSTANT_ENCAPSED_STRING","'%2528'",67],",",["T_WHITESPACE","\t",67],["T_COMMENT","\/\/ (\n",67],["T_WHITESPACE","\t\t",68],["T_CONSTANT_ENCAPSED_STRING","'%26'",68],",",["T_WHITESPACE","\t\t",68],["T_COMMENT","\/\/ &\n",68],["T_WHITESPACE","\t\t",69],["T_CONSTANT_ENCAPSED_STRING","'%24'",69],",",["T_WHITESPACE","\t\t",69],["T_COMMENT","\/\/ $\n",69],["T_WHITESPACE","\t\t",70],["T_CONSTANT_ENCAPSED_STRING","'%3f'",70],",",["T_WHITESPACE","\t\t",70],["T_COMMENT","\/\/ ?\n",70],["T_WHITESPACE","\t\t",71],["T_CONSTANT_ENCAPSED_STRING","'%3b'",71],",",["T_WHITESPACE","\t\t",71],["T_COMMENT","\/\/ ;\n",71],["T_WHITESPACE","\t\t",72],["T_CONSTANT_ENCAPSED_STRING","'%3d'",72],["T_WHITESPACE","\t\t",72],["T_COMMENT","\/\/ =\n",72],["T_WHITESPACE","\t",73],")",";",["T_WHITESPACE","\n\n\t",73],["T_DOC_COMMENT","\/**\n\t * Character set\n\t *\n\t * Will be overridden by the constructor.\n\t *\n\t * @var\tstring\n\t *\/",75],["T_WHITESPACE","\n\t",81],["T_PUBLIC","public",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$charset",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",82],";",["T_WHITESPACE","\n\n\t",82],["T_DOC_COMMENT","\/**\n\t * XSS Hash\n\t *\n\t * Random Hash for protecting URLs.\n\t *\n\t * @var\tstring\n\t *\/",84],["T_WHITESPACE","\n\t",90],["T_PROTECTED","protected",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$_xss_hash",91],";",["T_WHITESPACE","\n\n\t",91],["T_DOC_COMMENT","\/**\n\t * CSRF Hash\n\t *\n\t * Random hash for Cross Site Request Forgery protection cookie\n\t *\n\t * @var\tstring\n\t *\/",93],["T_WHITESPACE","\n\t",99],["T_PROTECTED","protected",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$_csrf_hash",100],";",["T_WHITESPACE","\n\n\t",100],["T_DOC_COMMENT","\/**\n\t * CSRF Expire time\n\t *\n\t * Expiration time for Cross Site Request Forgery protection cookie.\n\t * Defaults to two hours (in seconds).\n\t *\n\t * @var\tint\n\t *\/",102],["T_WHITESPACE","\n\t",109],["T_PROTECTED","protected",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$_csrf_expire",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE","\t",110],["T_LNUMBER","7200",110],";",["T_WHITESPACE","\n\n\t",110],["T_DOC_COMMENT","\/**\n\t * CSRF Token name\n\t *\n\t * Token name for Cross Site Request Forgery protection cookie.\n\t *\n\t * @var\tstring\n\t *\/",112],["T_WHITESPACE","\n\t",118],["T_PROTECTED","protected",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$_csrf_token_name",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE","\t",119],["T_CONSTANT_ENCAPSED_STRING","'ci_csrf_token'",119],";",["T_WHITESPACE","\n\n\t",119],["T_DOC_COMMENT","\/**\n\t * CSRF Cookie name\n\t *\n\t * Cookie name for Cross Site Request Forgery protection cookie.\n\t *\n\t * @var\tstring\n\t *\/",121],["T_WHITESPACE","\n\t",127],["T_PROTECTED","protected",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$_csrf_cookie_name",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE","\t",128],["T_CONSTANT_ENCAPSED_STRING","'ci_csrf_token'",128],";",["T_WHITESPACE","\n\n\t",128],["T_DOC_COMMENT","\/**\n\t * List of never allowed strings\n\t *\n\t * @var\tarray\n\t *\/",130],["T_WHITESPACE","\n\t",134],["T_PROTECTED","protected",135],["T_WHITESPACE"," ",135],["T_VARIABLE","$_never_allowed_str",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE","\t",135],["T_ARRAY","array",135],"(",["T_WHITESPACE","\n\t\t",135],["T_CONSTANT_ENCAPSED_STRING","'document.cookie'",136],["T_WHITESPACE"," ",136],["T_DOUBLE_ARROW","=>",136],["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","'[removed]'",136],",",["T_WHITESPACE","\n\t\t",136],["T_CONSTANT_ENCAPSED_STRING","'document.write'",137],["T_WHITESPACE","  ",137],["T_DOUBLE_ARROW","=>",137],["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'[removed]'",137],",",["T_WHITESPACE","\n\t\t",137],["T_CONSTANT_ENCAPSED_STRING","'.parentNode'",138],["T_WHITESPACE","     ",138],["T_DOUBLE_ARROW","=>",138],["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","'[removed]'",138],",",["T_WHITESPACE","\n\t\t",138],["T_CONSTANT_ENCAPSED_STRING","'.innerHTML'",139],["T_WHITESPACE","      ",139],["T_DOUBLE_ARROW","=>",139],["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'[removed]'",139],",",["T_WHITESPACE","\n\t\t",139],["T_CONSTANT_ENCAPSED_STRING","'-moz-binding'",140],["T_WHITESPACE","    ",140],["T_DOUBLE_ARROW","=>",140],["T_WHITESPACE"," ",140],["T_CONSTANT_ENCAPSED_STRING","'[removed]'",140],",",["T_WHITESPACE","\n\t\t",140],["T_CONSTANT_ENCAPSED_STRING","'<!--'",141],["T_WHITESPACE","            ",141],["T_DOUBLE_ARROW","=>",141],["T_WHITESPACE"," ",141],["T_CONSTANT_ENCAPSED_STRING","'&lt;!--'",141],",",["T_WHITESPACE","\n\t\t",141],["T_CONSTANT_ENCAPSED_STRING","'-->'",142],["T_WHITESPACE","             ",142],["T_DOUBLE_ARROW","=>",142],["T_WHITESPACE"," ",142],["T_CONSTANT_ENCAPSED_STRING","'--&gt;'",142],",",["T_WHITESPACE","\n\t\t",142],["T_CONSTANT_ENCAPSED_STRING","'<![CDATA['",143],["T_WHITESPACE","       ",143],["T_DOUBLE_ARROW","=>",143],["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","'&lt;![CDATA['",143],",",["T_WHITESPACE","\n\t\t",143],["T_CONSTANT_ENCAPSED_STRING","'<comment>'",144],["T_WHITESPACE","\t  ",144],["T_DOUBLE_ARROW","=>",144],["T_WHITESPACE"," ",144],["T_CONSTANT_ENCAPSED_STRING","'&lt;comment&gt;'",144],",",["T_WHITESPACE","\n\t\t",144],["T_CONSTANT_ENCAPSED_STRING","'<%'",145],["T_WHITESPACE","              ",145],["T_DOUBLE_ARROW","=>",145],["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","'&lt;&#37;'",145],["T_WHITESPACE","\n\t",145],")",";",["T_WHITESPACE","\n\n\t",146],["T_DOC_COMMENT","\/**\n\t * List of never allowed regex replacements\n\t *\n\t * @var\tarray\n\t *\/",148],["T_WHITESPACE","\n\t",152],["T_PROTECTED","protected",153],["T_WHITESPACE"," ",153],["T_VARIABLE","$_never_allowed_regex",153],["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_ARRAY","array",153],"(",["T_WHITESPACE","\n\t\t",153],["T_CONSTANT_ENCAPSED_STRING","'javascript\\s*:'",154],",",["T_WHITESPACE","\n\t\t",154],["T_CONSTANT_ENCAPSED_STRING","'(document|(document\\.)?window)\\.(location|on\\w*)'",155],",",["T_WHITESPACE","\n\t\t",155],["T_CONSTANT_ENCAPSED_STRING","'expression\\s*(\\(|&\\#40;)'",156],",",["T_WHITESPACE"," ",156],["T_COMMENT","\/\/ CSS and IE\n",156],["T_WHITESPACE","\t\t",157],["T_CONSTANT_ENCAPSED_STRING","'vbscript\\s*:'",157],",",["T_WHITESPACE"," ",157],["T_COMMENT","\/\/ IE, surprise!\n",157],["T_WHITESPACE","\t\t",158],["T_CONSTANT_ENCAPSED_STRING","'wscript\\s*:'",158],",",["T_WHITESPACE"," ",158],["T_COMMENT","\/\/ IE\n",158],["T_WHITESPACE","\t\t",159],["T_CONSTANT_ENCAPSED_STRING","'jscript\\s*:'",159],",",["T_WHITESPACE"," ",159],["T_COMMENT","\/\/ IE\n",159],["T_WHITESPACE","\t\t",160],["T_CONSTANT_ENCAPSED_STRING","'vbs\\s*:'",160],",",["T_WHITESPACE"," ",160],["T_COMMENT","\/\/ IE\n",160],["T_WHITESPACE","\t\t",161],["T_CONSTANT_ENCAPSED_STRING","'Redirect\\s+30\\d'",161],",",["T_WHITESPACE","\n\t\t",161],["T_CONSTANT_ENCAPSED_STRING","\"([\\\"'])?data\\s*:[^\\\\1]*?base64[^\\\\1]*?,[^\\\\1]*?\\\\1?\"",162],["T_WHITESPACE","\n\t",162],")",";",["T_WHITESPACE","\n\n\t",163],["T_DOC_COMMENT","\/**\n\t * Class constructor\n\t *\n\t * @return\tvoid\n\t *\/",165],["T_WHITESPACE","\n\t",169],["T_PUBLIC","public",170],["T_WHITESPACE"," ",170],["T_FUNCTION","function",170],["T_WHITESPACE"," ",170],["T_STRING","__construct",170],"(",["T_VARIABLE","$charset",170],")",["T_WHITESPACE","\n\t",170],"{",["T_WHITESPACE","\n\t\t",171],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","charset",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_VARIABLE","$charset",172],";",["T_WHITESPACE","\n\n\t\t",172],["T_COMMENT","\/\/ Is CSRF protection enabled?\n",174],["T_WHITESPACE","\t\t",175],["T_IF","if",175],["T_WHITESPACE"," ",175],"(",["T_STRING","config_item",175],"(",["T_CONSTANT_ENCAPSED_STRING","'csrf_protection'",175],")",["T_WHITESPACE"," ",175],["T_BOOLEAN_AND","&&",175],["T_WHITESPACE"," ",175],"!",["T_WHITESPACE"," ",175],["T_STRING","is_cli",175],"(",")",")",["T_WHITESPACE","\n\t\t",175],"{",["T_WHITESPACE","\n\t\t\t",176],["T_COMMENT","\/\/ CSRF config\n",177],["T_WHITESPACE","\t\t\t",178],["T_FOREACH","foreach",178],["T_WHITESPACE"," ",178],"(",["T_ARRAY","array",178],"(",["T_CONSTANT_ENCAPSED_STRING","'csrf_expire'",178],",",["T_WHITESPACE"," ",178],["T_CONSTANT_ENCAPSED_STRING","'csrf_token_name'",178],",",["T_WHITESPACE"," ",178],["T_CONSTANT_ENCAPSED_STRING","'csrf_cookie_name'",178],")",["T_WHITESPACE"," ",178],["T_AS","as",178],["T_WHITESPACE"," ",178],["T_VARIABLE","$key",178],")",["T_WHITESPACE","\n\t\t\t",178],"{",["T_WHITESPACE","\n\t\t\t\t",179],["T_IF","if",180],["T_WHITESPACE"," ",180],"(",["T_STRING","NULL",180],["T_WHITESPACE"," ",180],["T_IS_NOT_IDENTICAL","!==",180],["T_WHITESPACE"," ",180],"(",["T_VARIABLE","$val",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_STRING","config_item",180],"(",["T_VARIABLE","$key",180],")",")",")",["T_WHITESPACE","\n\t\t\t\t",180],"{",["T_WHITESPACE","\n\t\t\t\t\t",181],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],"{",["T_CONSTANT_ENCAPSED_STRING","'_'",182],".",["T_VARIABLE","$key",182],"}",["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_VARIABLE","$val",182],";",["T_WHITESPACE","\n\t\t\t\t",182],"}",["T_WHITESPACE","\n\t\t\t",183],"}",["T_WHITESPACE","\n\n\t\t\t",184],["T_COMMENT","\/\/ Append application specific cookie prefix\n",186],["T_WHITESPACE","\t\t\t",187],["T_IF","if",187],["T_WHITESPACE"," ",187],"(",["T_VARIABLE","$cookie_prefix",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_STRING","config_item",187],"(",["T_CONSTANT_ENCAPSED_STRING","'cookie_prefix'",187],")",")",["T_WHITESPACE","\n\t\t\t",187],"{",["T_WHITESPACE","\n\t\t\t\t",188],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","_csrf_cookie_name",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_VARIABLE","$cookie_prefix",189],".",["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","_csrf_cookie_name",189],";",["T_WHITESPACE","\n\t\t\t",189],"}",["T_WHITESPACE","\n\n\t\t\t",190],["T_COMMENT","\/\/ Set the CSRF hash\n",192],["T_WHITESPACE","\t\t\t",193],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","_csrf_set_hash",193],"(",")",";",["T_WHITESPACE","\n\t\t\t",193],["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","csrf_verify",194],"(",")",";",["T_WHITESPACE","\n\t\t",194],"}",["T_WHITESPACE","\n\n\t\t",195],["T_STRING","log_message",197],"(",["T_CONSTANT_ENCAPSED_STRING","'info'",197],",",["T_WHITESPACE"," ",197],["T_CONSTANT_ENCAPSED_STRING","'Security Class Initialized'",197],")",";",["T_WHITESPACE","\n\t",197],"}",["T_WHITESPACE","\n\n\t",198],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",200],["T_WHITESPACE","\n\t",201],["T_DOC_COMMENT","\/**\n\t * CSRF Verify\n\t *\n\t * @return\tCI_Security\n\t *\/",202],["T_WHITESPACE","\n\t",206],["T_PUBLIC","public",207],["T_WHITESPACE"," ",207],["T_FUNCTION","function",207],["T_WHITESPACE"," ",207],["T_STRING","csrf_verify",207],"(",")",["T_WHITESPACE","\n\t",207],"{",["T_WHITESPACE","\n\t\t",208],["T_COMMENT","\/\/ If it's not a POST request we will set the CSRF cookie\n",209],["T_WHITESPACE","\t\t",210],["T_IF","if",210],["T_WHITESPACE"," ",210],"(",["T_STRING","strtoupper",210],"(",["T_VARIABLE","$_SERVER",210],"[",["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",210],"]",")",["T_WHITESPACE"," ",210],["T_IS_NOT_IDENTICAL","!==",210],["T_WHITESPACE"," ",210],["T_CONSTANT_ENCAPSED_STRING","'POST'",210],")",["T_WHITESPACE","\n\t\t",210],"{",["T_WHITESPACE","\n\t\t\t",211],["T_RETURN","return",212],["T_WHITESPACE"," ",212],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","csrf_set_cookie",212],"(",")",";",["T_WHITESPACE","\n\t\t",212],"}",["T_WHITESPACE","\n\n\t\t",213],["T_COMMENT","\/\/ Check if URI has been whitelisted from CSRF checks\n",215],["T_WHITESPACE","\t\t",216],["T_IF","if",216],["T_WHITESPACE"," ",216],"(",["T_VARIABLE","$exclude_uris",216],["T_WHITESPACE"," ",216],"=",["T_WHITESPACE"," ",216],["T_STRING","config_item",216],"(",["T_CONSTANT_ENCAPSED_STRING","'csrf_exclude_uris'",216],")",")",["T_WHITESPACE","\n\t\t",216],"{",["T_WHITESPACE","\n\t\t\t",217],["T_VARIABLE","$uri",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_STRING","load_class",218],"(",["T_CONSTANT_ENCAPSED_STRING","'URI'",218],",",["T_WHITESPACE"," ",218],["T_CONSTANT_ENCAPSED_STRING","'core'",218],")",";",["T_WHITESPACE","\n\t\t\t",218],["T_FOREACH","foreach",219],["T_WHITESPACE"," ",219],"(",["T_VARIABLE","$exclude_uris",219],["T_WHITESPACE"," ",219],["T_AS","as",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$excluded",219],")",["T_WHITESPACE","\n\t\t\t",219],"{",["T_WHITESPACE","\n\t\t\t\t",220],["T_IF","if",221],["T_WHITESPACE"," ",221],"(",["T_STRING","preg_match",221],"(",["T_CONSTANT_ENCAPSED_STRING","'#^'",221],".",["T_VARIABLE","$excluded",221],".",["T_CONSTANT_ENCAPSED_STRING","'$#i'",221],".","(",["T_STRING","UTF8_ENABLED",221],["T_WHITESPACE"," ",221],"?",["T_WHITESPACE"," ",221],["T_CONSTANT_ENCAPSED_STRING","'u'",221],["T_WHITESPACE"," ",221],":",["T_WHITESPACE"," ",221],["T_CONSTANT_ENCAPSED_STRING","''",221],")",",",["T_WHITESPACE"," ",221],["T_VARIABLE","$uri",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","uri_string",221],"(",")",")",")",["T_WHITESPACE","\n\t\t\t\t",221],"{",["T_WHITESPACE","\n\t\t\t\t\t",222],["T_RETURN","return",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$this",223],";",["T_WHITESPACE","\n\t\t\t\t",223],"}",["T_WHITESPACE","\n\t\t\t",224],"}",["T_WHITESPACE","\n\t\t",225],"}",["T_WHITESPACE","\n\n\t\t",226],["T_COMMENT","\/\/ Check CSRF token validity, but don't error on mismatch just yet - we'll want to regenerate\n",228],["T_WHITESPACE","\t\t",229],["T_VARIABLE","$valid",229],["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],["T_ISSET","isset",229],"(",["T_VARIABLE","$_POST",229],"[",["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","_csrf_token_name",229],"]",",",["T_WHITESPACE"," ",229],["T_VARIABLE","$_COOKIE",229],"[",["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","_csrf_cookie_name",229],"]",")",["T_WHITESPACE","\n\t\t\t",229],["T_BOOLEAN_AND","&&",230],["T_WHITESPACE"," ",230],["T_STRING","hash_equals",230],"(",["T_VARIABLE","$_POST",230],"[",["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","_csrf_token_name",230],"]",",",["T_WHITESPACE"," ",230],["T_VARIABLE","$_COOKIE",230],"[",["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","_csrf_cookie_name",230],"]",")",";",["T_WHITESPACE","\n\n\t\t",230],["T_COMMENT","\/\/ We kill this since we're done and we don't want to pollute the _POST array\n",232],["T_WHITESPACE","\t\t",233],["T_UNSET","unset",233],"(",["T_VARIABLE","$_POST",233],"[",["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","_csrf_token_name",233],"]",")",";",["T_WHITESPACE","\n\n\t\t",233],["T_COMMENT","\/\/ Regenerate on every submission?\n",235],["T_WHITESPACE","\t\t",236],["T_IF","if",236],["T_WHITESPACE"," ",236],"(",["T_STRING","config_item",236],"(",["T_CONSTANT_ENCAPSED_STRING","'csrf_regenerate'",236],")",")",["T_WHITESPACE","\n\t\t",236],"{",["T_WHITESPACE","\n\t\t\t",237],["T_COMMENT","\/\/ Nothing should last forever\n",238],["T_WHITESPACE","\t\t\t",239],["T_UNSET","unset",239],"(",["T_VARIABLE","$_COOKIE",239],"[",["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","_csrf_cookie_name",239],"]",")",";",["T_WHITESPACE","\n\t\t\t",239],["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","_csrf_hash",240],["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],["T_STRING","NULL",240],";",["T_WHITESPACE","\n\t\t",240],"}",["T_WHITESPACE","\n\n\t\t",241],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","_csrf_set_hash",243],"(",")",";",["T_WHITESPACE","\n\t\t",243],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","csrf_set_cookie",244],"(",")",";",["T_WHITESPACE","\n\n\t\t",244],["T_IF","if",246],["T_WHITESPACE"," ",246],"(",["T_VARIABLE","$valid",246],["T_WHITESPACE"," ",246],["T_IS_NOT_IDENTICAL","!==",246],["T_WHITESPACE"," ",246],["T_STRING","TRUE",246],")",["T_WHITESPACE","\n\t\t",246],"{",["T_WHITESPACE","\n\t\t\t",247],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","csrf_show_error",248],"(",")",";",["T_WHITESPACE","\n\t\t",248],"}",["T_WHITESPACE","\n\n\t\t",249],["T_STRING","log_message",251],"(",["T_CONSTANT_ENCAPSED_STRING","'info'",251],",",["T_WHITESPACE"," ",251],["T_CONSTANT_ENCAPSED_STRING","'CSRF token verified'",251],")",";",["T_WHITESPACE","\n\t\t",251],["T_RETURN","return",252],["T_WHITESPACE"," ",252],["T_VARIABLE","$this",252],";",["T_WHITESPACE","\n\t",252],"}",["T_WHITESPACE","\n\n\t",253],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",255],["T_WHITESPACE","\n\t",256],["T_DOC_COMMENT","\/**\n\t * CSRF Set Cookie\n\t *\n\t * @codeCoverageIgnore\n\t * @return\tCI_Security\n\t *\/",257],["T_WHITESPACE","\n\t",262],["T_PUBLIC","public",263],["T_WHITESPACE"," ",263],["T_FUNCTION","function",263],["T_WHITESPACE"," ",263],["T_STRING","csrf_set_cookie",263],"(",")",["T_WHITESPACE","\n\t",263],"{",["T_WHITESPACE","\n\t\t",264],["T_VARIABLE","$expire",265],["T_WHITESPACE"," ",265],"=",["T_WHITESPACE"," ",265],["T_STRING","time",265],"(",")",["T_WHITESPACE"," ",265],"+",["T_WHITESPACE"," ",265],["T_VARIABLE","$this",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","_csrf_expire",265],";",["T_WHITESPACE","\n\t\t",265],["T_VARIABLE","$secure_cookie",266],["T_WHITESPACE"," ",266],"=",["T_WHITESPACE"," ",266],["T_BOOL_CAST","(bool)",266],["T_WHITESPACE"," ",266],["T_STRING","config_item",266],"(",["T_CONSTANT_ENCAPSED_STRING","'cookie_secure'",266],")",";",["T_WHITESPACE","\n\n\t\t",266],["T_IF","if",268],["T_WHITESPACE"," ",268],"(",["T_VARIABLE","$secure_cookie",268],["T_WHITESPACE"," ",268],["T_BOOLEAN_AND","&&",268],["T_WHITESPACE"," ",268],"!",["T_WHITESPACE"," ",268],["T_STRING","is_https",268],"(",")",")",["T_WHITESPACE","\n\t\t",268],"{",["T_WHITESPACE","\n\t\t\t",269],["T_RETURN","return",270],["T_WHITESPACE"," ",270],["T_STRING","FALSE",270],";",["T_WHITESPACE","\n\t\t",270],"}",["T_WHITESPACE","\n\n\t\t",271],["T_STRING","setcookie",273],"(",["T_WHITESPACE","\n\t\t\t",273],["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","_csrf_cookie_name",274],",",["T_WHITESPACE","\n\t\t\t",274],["T_VARIABLE","$this",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","_csrf_hash",275],",",["T_WHITESPACE","\n\t\t\t",275],["T_VARIABLE","$expire",276],",",["T_WHITESPACE","\n\t\t\t",276],["T_STRING","config_item",277],"(",["T_CONSTANT_ENCAPSED_STRING","'cookie_path'",277],")",",",["T_WHITESPACE","\n\t\t\t",277],["T_STRING","config_item",278],"(",["T_CONSTANT_ENCAPSED_STRING","'cookie_domain'",278],")",",",["T_WHITESPACE","\n\t\t\t",278],["T_VARIABLE","$secure_cookie",279],",",["T_WHITESPACE","\n\t\t\t",279],["T_STRING","config_item",280],"(",["T_CONSTANT_ENCAPSED_STRING","'cookie_httponly'",280],")",["T_WHITESPACE","\n\t\t",280],")",";",["T_WHITESPACE","\n\t\t",281],["T_STRING","log_message",282],"(",["T_CONSTANT_ENCAPSED_STRING","'info'",282],",",["T_WHITESPACE"," ",282],["T_CONSTANT_ENCAPSED_STRING","'CSRF cookie sent'",282],")",";",["T_WHITESPACE","\n\n\t\t",282],["T_RETURN","return",284],["T_WHITESPACE"," ",284],["T_VARIABLE","$this",284],";",["T_WHITESPACE","\n\t",284],"}",["T_WHITESPACE","\n\n\t",285],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",287],["T_WHITESPACE","\n\t",288],["T_DOC_COMMENT","\/**\n\t * Show CSRF Error\n\t *\n\t * @return\tvoid\n\t *\/",289],["T_WHITESPACE","\n\t",293],["T_PUBLIC","public",294],["T_WHITESPACE"," ",294],["T_FUNCTION","function",294],["T_WHITESPACE"," ",294],["T_STRING","csrf_show_error",294],"(",")",["T_WHITESPACE","\n\t",294],"{",["T_WHITESPACE","\n\t\t",295],["T_STRING","show_error",296],"(",["T_CONSTANT_ENCAPSED_STRING","'The action you have requested is not allowed.'",296],",",["T_WHITESPACE"," ",296],["T_LNUMBER","403",296],")",";",["T_WHITESPACE","\n\t",296],"}",["T_WHITESPACE","\n\n\t",297],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",299],["T_WHITESPACE","\n\t",300],["T_DOC_COMMENT","\/**\n\t * Get CSRF Hash\n\t *\n\t * @see\t\tCI_Security::$_csrf_hash\n\t * @return \tstring\tCSRF hash\n\t *\/",301],["T_WHITESPACE","\n\t",306],["T_PUBLIC","public",307],["T_WHITESPACE"," ",307],["T_FUNCTION","function",307],["T_WHITESPACE"," ",307],["T_STRING","get_csrf_hash",307],"(",")",["T_WHITESPACE","\n\t",307],"{",["T_WHITESPACE","\n\t\t",308],["T_RETURN","return",309],["T_WHITESPACE"," ",309],["T_VARIABLE","$this",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","_csrf_hash",309],";",["T_WHITESPACE","\n\t",309],"}",["T_WHITESPACE","\n\n\t",310],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",312],["T_WHITESPACE","\n\t",313],["T_DOC_COMMENT","\/**\n\t * Get CSRF Token Name\n\t *\n\t * @see\t\tCI_Security::$_csrf_token_name\n\t * @return\tstring\tCSRF token name\n\t *\/",314],["T_WHITESPACE","\n\t",319],["T_PUBLIC","public",320],["T_WHITESPACE"," ",320],["T_FUNCTION","function",320],["T_WHITESPACE"," ",320],["T_STRING","get_csrf_token_name",320],"(",")",["T_WHITESPACE","\n\t",320],"{",["T_WHITESPACE","\n\t\t",321],["T_RETURN","return",322],["T_WHITESPACE"," ",322],["T_VARIABLE","$this",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","_csrf_token_name",322],";",["T_WHITESPACE","\n\t",322],"}",["T_WHITESPACE","\n\n\t",323],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",325],["T_WHITESPACE","\n\t",326],["T_DOC_COMMENT","\/**\n\t * XSS Clean\n\t *\n\t * Sanitizes data so that Cross Site Scripting Hacks can be\n\t * prevented.  This method does a fair amount of work but\n\t * it is extremely thorough, designed to prevent even the\n\t * most obscure XSS attempts.  Nothing is ever 100% foolproof,\n\t * of course, but I haven't been able to get anything passed\n\t * the filter.\n\t *\n\t * Note: Should only be used to deal with data upon submission.\n\t *\t It's not something that should be used for general\n\t *\t runtime processing.\n\t *\n\t * @link\thttp:\/\/channel.bitflux.ch\/wiki\/XSS_Prevention\n\t * \t\tBased in part on some code and ideas from Bitflux.\n\t *\n\t * @link\thttp:\/\/ha.ckers.org\/xss.html\n\t * \t\tTo help develop this script I used this great list of\n\t *\t\tvulnerabilities along with a few other hacks I've\n\t *\t\tharvested from examining vulnerabilities in other programs.\n\t *\n\t * @param\tstring|string[]\t$str\t\tInput data\n\t * @param \tbool\t\t$is_image\tWhether the input is an image\n\t * @return\tstring\n\t *\/",327],["T_WHITESPACE","\n\t",352],["T_PUBLIC","public",353],["T_WHITESPACE"," ",353],["T_FUNCTION","function",353],["T_WHITESPACE"," ",353],["T_STRING","xss_clean",353],"(",["T_VARIABLE","$str",353],",",["T_WHITESPACE"," ",353],["T_VARIABLE","$is_image",353],["T_WHITESPACE"," ",353],"=",["T_WHITESPACE"," ",353],["T_STRING","FALSE",353],")",["T_WHITESPACE","\n\t",353],"{",["T_WHITESPACE","\n\t\t",354],["T_COMMENT","\/\/ Is the string an array?\n",355],["T_WHITESPACE","\t\t",356],["T_IF","if",356],["T_WHITESPACE"," ",356],"(",["T_STRING","is_array",356],"(",["T_VARIABLE","$str",356],")",")",["T_WHITESPACE","\n\t\t",356],"{",["T_WHITESPACE","\n\t\t\t",357],["T_WHILE","while",358],["T_WHITESPACE"," ",358],"(",["T_LIST","list",358],"(",["T_VARIABLE","$key",358],")",["T_WHITESPACE"," ",358],"=",["T_WHITESPACE"," ",358],["T_STRING","each",358],"(",["T_VARIABLE","$str",358],")",")",["T_WHITESPACE","\n\t\t\t",358],"{",["T_WHITESPACE","\n\t\t\t\t",359],["T_VARIABLE","$str",360],"[",["T_VARIABLE","$key",360],"]",["T_WHITESPACE"," ",360],"=",["T_WHITESPACE"," ",360],["T_VARIABLE","$this",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","xss_clean",360],"(",["T_VARIABLE","$str",360],"[",["T_VARIABLE","$key",360],"]",")",";",["T_WHITESPACE","\n\t\t\t",360],"}",["T_WHITESPACE","\n\n\t\t\t",361],["T_RETURN","return",363],["T_WHITESPACE"," ",363],["T_VARIABLE","$str",363],";",["T_WHITESPACE","\n\t\t",363],"}",["T_WHITESPACE","\n\n\t\t",364],["T_COMMENT","\/\/ Remove Invisible Characters\n",366],["T_WHITESPACE","\t\t",367],["T_VARIABLE","$str",367],["T_WHITESPACE"," ",367],"=",["T_WHITESPACE"," ",367],["T_STRING","remove_invisible_characters",367],"(",["T_VARIABLE","$str",367],")",";",["T_WHITESPACE","\n\n\t\t",367],["T_COMMENT","\/*\n\t\t * URL Decode\n\t\t *\n\t\t * Just in case stuff like this is submitted:\n\t\t *\n\t\t * <a href=\"http:\/\/%77%77%77%2E%67%6F%6F%67%6C%65%2E%63%6F%6D\">Google<\/a>\n\t\t *\n\t\t * Note: Use rawurldecode() so it does not remove plus signs\n\t\t *\/",369],["T_WHITESPACE","\n\t\t",377],["T_IF","if",378],["T_WHITESPACE"," ",378],"(",["T_STRING","stripos",378],"(",["T_VARIABLE","$str",378],",",["T_WHITESPACE"," ",378],["T_CONSTANT_ENCAPSED_STRING","'%'",378],")",["T_WHITESPACE"," ",378],["T_IS_NOT_IDENTICAL","!==",378],["T_WHITESPACE"," ",378],["T_STRING","false",378],")",["T_WHITESPACE","\n\t\t",378],"{",["T_WHITESPACE","\n\t\t\t",379],["T_DO","do",380],["T_WHITESPACE","\n\t\t\t",380],"{",["T_WHITESPACE","\n\t\t\t\t",381],["T_VARIABLE","$oldstr",382],["T_WHITESPACE"," ",382],"=",["T_WHITESPACE"," ",382],["T_VARIABLE","$str",382],";",["T_WHITESPACE","\n\t\t\t\t",382],["T_VARIABLE","$str",383],["T_WHITESPACE"," ",383],"=",["T_WHITESPACE"," ",383],["T_STRING","rawurldecode",383],"(",["T_VARIABLE","$str",383],")",";",["T_WHITESPACE","\n\t\t\t\t",383],["T_VARIABLE","$str",384],["T_WHITESPACE"," ",384],"=",["T_WHITESPACE"," ",384],["T_STRING","preg_replace_callback",384],"(",["T_CONSTANT_ENCAPSED_STRING","'#%(?:\\s*[0-9a-f]){2,}#i'",384],",",["T_WHITESPACE"," ",384],["T_ARRAY","array",384],"(",["T_VARIABLE","$this",384],",",["T_WHITESPACE"," ",384],["T_CONSTANT_ENCAPSED_STRING","'_urldecodespaces'",384],")",",",["T_WHITESPACE"," ",384],["T_VARIABLE","$str",384],")",";",["T_WHITESPACE","\n\t\t\t",384],"}",["T_WHITESPACE","\n\t\t\t",385],["T_WHILE","while",386],["T_WHITESPACE"," ",386],"(",["T_VARIABLE","$oldstr",386],["T_WHITESPACE"," ",386],["T_IS_NOT_IDENTICAL","!==",386],["T_WHITESPACE"," ",386],["T_VARIABLE","$str",386],")",";",["T_WHITESPACE","\n\t\t\t",386],["T_UNSET","unset",387],"(",["T_VARIABLE","$oldstr",387],")",";",["T_WHITESPACE","\n\t\t",387],"}",["T_WHITESPACE","\n\n\t\t",388],["T_COMMENT","\/*\n\t\t * Convert character entities to ASCII\n\t\t *\n\t\t * This permits our tests below to work reliably.\n\t\t * We only convert entities that are within tags since\n\t\t * these are the ones that will pose security problems.\n\t\t *\/",390],["T_WHITESPACE","\n\t\t",396],["T_VARIABLE","$str",397],["T_WHITESPACE"," ",397],"=",["T_WHITESPACE"," ",397],["T_STRING","preg_replace_callback",397],"(",["T_CONSTANT_ENCAPSED_STRING","\"\/[^a-z0-9>]+[a-z0-9]+=([\\'\\\"]).*?\\\\1\/si\"",397],",",["T_WHITESPACE"," ",397],["T_ARRAY","array",397],"(",["T_VARIABLE","$this",397],",",["T_WHITESPACE"," ",397],["T_CONSTANT_ENCAPSED_STRING","'_convert_attribute'",397],")",",",["T_WHITESPACE"," ",397],["T_VARIABLE","$str",397],")",";",["T_WHITESPACE","\n\t\t",397],["T_VARIABLE","$str",398],["T_WHITESPACE"," ",398],"=",["T_WHITESPACE"," ",398],["T_STRING","preg_replace_callback",398],"(",["T_CONSTANT_ENCAPSED_STRING","'\/<\\w+.*\/si'",398],",",["T_WHITESPACE"," ",398],["T_ARRAY","array",398],"(",["T_VARIABLE","$this",398],",",["T_WHITESPACE"," ",398],["T_CONSTANT_ENCAPSED_STRING","'_decode_entity'",398],")",",",["T_WHITESPACE"," ",398],["T_VARIABLE","$str",398],")",";",["T_WHITESPACE","\n\n\t\t",398],["T_COMMENT","\/\/ Remove Invisible Characters Again!\n",400],["T_WHITESPACE","\t\t",401],["T_VARIABLE","$str",401],["T_WHITESPACE"," ",401],"=",["T_WHITESPACE"," ",401],["T_STRING","remove_invisible_characters",401],"(",["T_VARIABLE","$str",401],")",";",["T_WHITESPACE","\n\n\t\t",401],["T_COMMENT","\/*\n\t\t * Convert all tabs to spaces\n\t\t *\n\t\t * This prevents strings like this: ja\tvascript\n\t\t * NOTE: we deal with spaces between characters later.\n\t\t * NOTE: preg_replace was found to be amazingly slow here on\n\t\t * large blocks of data, so we use str_replace.\n\t\t *\/",403],["T_WHITESPACE","\n\t\t",410],["T_VARIABLE","$str",411],["T_WHITESPACE"," ",411],"=",["T_WHITESPACE"," ",411],["T_STRING","str_replace",411],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\t\"",411],",",["T_WHITESPACE"," ",411],["T_CONSTANT_ENCAPSED_STRING","' '",411],",",["T_WHITESPACE"," ",411],["T_VARIABLE","$str",411],")",";",["T_WHITESPACE","\n\n\t\t",411],["T_COMMENT","\/\/ Capture converted string for later comparison\n",413],["T_WHITESPACE","\t\t",414],["T_VARIABLE","$converted_string",414],["T_WHITESPACE"," ",414],"=",["T_WHITESPACE"," ",414],["T_VARIABLE","$str",414],";",["T_WHITESPACE","\n\n\t\t",414],["T_COMMENT","\/\/ Remove Strings that are never allowed\n",416],["T_WHITESPACE","\t\t",417],["T_VARIABLE","$str",417],["T_WHITESPACE"," ",417],"=",["T_WHITESPACE"," ",417],["T_VARIABLE","$this",417],["T_OBJECT_OPERATOR","->",417],["T_STRING","_do_never_allowed",417],"(",["T_VARIABLE","$str",417],")",";",["T_WHITESPACE","\n\n\t\t",417],["T_COMMENT","\/*\n\t\t * Makes PHP tags safe\n\t\t *\n\t\t * Note: XML tags are inadvertently replaced too:\n\t\t *\n\t\t * <?xml\n\t\t *\n\t\t * But it doesn't seem to pose a problem.\n\t\t *\/",419],["T_WHITESPACE","\n\t\t",427],["T_IF","if",428],["T_WHITESPACE"," ",428],"(",["T_VARIABLE","$is_image",428],["T_WHITESPACE"," ",428],["T_IS_IDENTICAL","===",428],["T_WHITESPACE"," ",428],["T_STRING","TRUE",428],")",["T_WHITESPACE","\n\t\t",428],"{",["T_WHITESPACE","\n\t\t\t",429],["T_COMMENT","\/\/ Images have a tendency to have the PHP short opening and\n",430],["T_WHITESPACE","\t\t\t",431],["T_COMMENT","\/\/ closing tags every so often so we skip those and only\n",431],["T_WHITESPACE","\t\t\t",432],["T_COMMENT","\/\/ do the long opening tags.\n",432],["T_WHITESPACE","\t\t\t",433],["T_VARIABLE","$str",433],["T_WHITESPACE"," ",433],"=",["T_WHITESPACE"," ",433],["T_STRING","preg_replace",433],"(",["T_CONSTANT_ENCAPSED_STRING","'\/<\\?(php)\/i'",433],",",["T_WHITESPACE"," ",433],["T_CONSTANT_ENCAPSED_STRING","'&lt;?\\\\1'",433],",",["T_WHITESPACE"," ",433],["T_VARIABLE","$str",433],")",";",["T_WHITESPACE","\n\t\t",433],"}",["T_WHITESPACE","\n\t\t",434],["T_ELSE","else",435],["T_WHITESPACE","\n\t\t",435],"{",["T_WHITESPACE","\n\t\t\t",436],["T_VARIABLE","$str",437],["T_WHITESPACE"," ",437],"=",["T_WHITESPACE"," ",437],["T_STRING","str_replace",437],"(",["T_ARRAY","array",437],"(",["T_CONSTANT_ENCAPSED_STRING","'<?'",437],",",["T_WHITESPACE"," ",437],["T_CONSTANT_ENCAPSED_STRING","'?'",437],".",["T_CONSTANT_ENCAPSED_STRING","'>'",437],")",",",["T_WHITESPACE"," ",437],["T_ARRAY","array",437],"(",["T_CONSTANT_ENCAPSED_STRING","'&lt;?'",437],",",["T_WHITESPACE"," ",437],["T_CONSTANT_ENCAPSED_STRING","'?&gt;'",437],")",",",["T_WHITESPACE"," ",437],["T_VARIABLE","$str",437],")",";",["T_WHITESPACE","\n\t\t",437],"}",["T_WHITESPACE","\n\n\t\t",438],["T_COMMENT","\/*\n\t\t * Compact any exploded words\n\t\t *\n\t\t * This corrects words like:  j a v a s c r i p t\n\t\t * These words are compacted back to their correct state.\n\t\t *\/",440],["T_WHITESPACE","\n\t\t",445],["T_VARIABLE","$words",446],["T_WHITESPACE"," ",446],"=",["T_WHITESPACE"," ",446],["T_ARRAY","array",446],"(",["T_WHITESPACE","\n\t\t\t",446],["T_CONSTANT_ENCAPSED_STRING","'javascript'",447],",",["T_WHITESPACE"," ",447],["T_CONSTANT_ENCAPSED_STRING","'expression'",447],",",["T_WHITESPACE"," ",447],["T_CONSTANT_ENCAPSED_STRING","'vbscript'",447],",",["T_WHITESPACE"," ",447],["T_CONSTANT_ENCAPSED_STRING","'jscript'",447],",",["T_WHITESPACE"," ",447],["T_CONSTANT_ENCAPSED_STRING","'wscript'",447],",",["T_WHITESPACE","\n\t\t\t",447],["T_CONSTANT_ENCAPSED_STRING","'vbs'",448],",",["T_WHITESPACE"," ",448],["T_CONSTANT_ENCAPSED_STRING","'script'",448],",",["T_WHITESPACE"," ",448],["T_CONSTANT_ENCAPSED_STRING","'base64'",448],",",["T_WHITESPACE"," ",448],["T_CONSTANT_ENCAPSED_STRING","'applet'",448],",",["T_WHITESPACE"," ",448],["T_CONSTANT_ENCAPSED_STRING","'alert'",448],",",["T_WHITESPACE"," ",448],["T_CONSTANT_ENCAPSED_STRING","'document'",448],",",["T_WHITESPACE","\n\t\t\t",448],["T_CONSTANT_ENCAPSED_STRING","'write'",449],",",["T_WHITESPACE"," ",449],["T_CONSTANT_ENCAPSED_STRING","'cookie'",449],",",["T_WHITESPACE"," ",449],["T_CONSTANT_ENCAPSED_STRING","'window'",449],",",["T_WHITESPACE"," ",449],["T_CONSTANT_ENCAPSED_STRING","'confirm'",449],",",["T_WHITESPACE"," ",449],["T_CONSTANT_ENCAPSED_STRING","'prompt'",449],",",["T_WHITESPACE"," ",449],["T_CONSTANT_ENCAPSED_STRING","'eval'",449],["T_WHITESPACE","\n\t\t",449],")",";",["T_WHITESPACE","\n\n\t\t",450],["T_FOREACH","foreach",452],["T_WHITESPACE"," ",452],"(",["T_VARIABLE","$words",452],["T_WHITESPACE"," ",452],["T_AS","as",452],["T_WHITESPACE"," ",452],["T_VARIABLE","$word",452],")",["T_WHITESPACE","\n\t\t",452],"{",["T_WHITESPACE","\n\t\t\t",453],["T_VARIABLE","$word",454],["T_WHITESPACE"," ",454],"=",["T_WHITESPACE"," ",454],["T_STRING","implode",454],"(",["T_CONSTANT_ENCAPSED_STRING","'\\s*'",454],",",["T_WHITESPACE"," ",454],["T_STRING","str_split",454],"(",["T_VARIABLE","$word",454],")",")",".",["T_CONSTANT_ENCAPSED_STRING","'\\s*'",454],";",["T_WHITESPACE","\n\n\t\t\t",454],["T_COMMENT","\/\/ We only want to do this when it is followed by a non-word character\n",456],["T_WHITESPACE","\t\t\t",457],["T_COMMENT","\/\/ That way valid stuff like \"dealer to\" does not become \"dealerto\"\n",457],["T_WHITESPACE","\t\t\t",458],["T_VARIABLE","$str",458],["T_WHITESPACE"," ",458],"=",["T_WHITESPACE"," ",458],["T_STRING","preg_replace_callback",458],"(",["T_CONSTANT_ENCAPSED_STRING","'#('",458],".",["T_STRING","substr",458],"(",["T_VARIABLE","$word",458],",",["T_WHITESPACE"," ",458],["T_LNUMBER","0",458],",",["T_WHITESPACE"," ",458],"-",["T_LNUMBER","3",458],")",".",["T_CONSTANT_ENCAPSED_STRING","')(\\W)#is'",458],",",["T_WHITESPACE"," ",458],["T_ARRAY","array",458],"(",["T_VARIABLE","$this",458],",",["T_WHITESPACE"," ",458],["T_CONSTANT_ENCAPSED_STRING","'_compact_exploded_words'",458],")",",",["T_WHITESPACE"," ",458],["T_VARIABLE","$str",458],")",";",["T_WHITESPACE","\n\t\t",458],"}",["T_WHITESPACE","\n\n\t\t",459],["T_COMMENT","\/*\n\t\t * Remove disallowed Javascript in links or img tags\n\t\t * We used to do some version comparisons and use of stripos(),\n\t\t * but it is dog slow compared to these simplified non-capturing\n\t\t * preg_match(), especially if the pattern exists in the string\n\t\t *\n\t\t * Note: It was reported that not only space characters, but all in\n\t\t * the following pattern can be parsed as separators between a tag name\n\t\t * and its attributes: [\\d\\s\"\\'`;,\\\/\\=\\(\\x00\\x0B\\x09\\x0C]\n\t\t * ... however, remove_invisible_characters() above already strips the\n\t\t * hex-encoded ones, so we'll skip them below.\n\t\t *\/",461],["T_WHITESPACE","\n\t\t",472],["T_DO","do",473],["T_WHITESPACE","\n\t\t",473],"{",["T_WHITESPACE","\n\t\t\t",474],["T_VARIABLE","$original",475],["T_WHITESPACE"," ",475],"=",["T_WHITESPACE"," ",475],["T_VARIABLE","$str",475],";",["T_WHITESPACE","\n\n\t\t\t",475],["T_IF","if",477],["T_WHITESPACE"," ",477],"(",["T_STRING","preg_match",477],"(",["T_CONSTANT_ENCAPSED_STRING","'\/<a\/i'",477],",",["T_WHITESPACE"," ",477],["T_VARIABLE","$str",477],")",")",["T_WHITESPACE","\n\t\t\t",477],"{",["T_WHITESPACE","\n\t\t\t\t",478],["T_VARIABLE","$str",479],["T_WHITESPACE"," ",479],"=",["T_WHITESPACE"," ",479],["T_STRING","preg_replace_callback",479],"(",["T_CONSTANT_ENCAPSED_STRING","'#<a(?:rea)?[^a-z0-9>]+([^>]*?)(?:>|$)#si'",479],",",["T_WHITESPACE"," ",479],["T_ARRAY","array",479],"(",["T_VARIABLE","$this",479],",",["T_WHITESPACE"," ",479],["T_CONSTANT_ENCAPSED_STRING","'_js_link_removal'",479],")",",",["T_WHITESPACE"," ",479],["T_VARIABLE","$str",479],")",";",["T_WHITESPACE","\n\t\t\t",479],"}",["T_WHITESPACE","\n\n\t\t\t",480],["T_IF","if",482],["T_WHITESPACE"," ",482],"(",["T_STRING","preg_match",482],"(",["T_CONSTANT_ENCAPSED_STRING","'\/<img\/i'",482],",",["T_WHITESPACE"," ",482],["T_VARIABLE","$str",482],")",")",["T_WHITESPACE","\n\t\t\t",482],"{",["T_WHITESPACE","\n\t\t\t\t",483],["T_VARIABLE","$str",484],["T_WHITESPACE"," ",484],"=",["T_WHITESPACE"," ",484],["T_STRING","preg_replace_callback",484],"(",["T_CONSTANT_ENCAPSED_STRING","'#<img[^a-z0-9]+([^>]*?)(?:\\s?\/?>|$)#si'",484],",",["T_WHITESPACE"," ",484],["T_ARRAY","array",484],"(",["T_VARIABLE","$this",484],",",["T_WHITESPACE"," ",484],["T_CONSTANT_ENCAPSED_STRING","'_js_img_removal'",484],")",",",["T_WHITESPACE"," ",484],["T_VARIABLE","$str",484],")",";",["T_WHITESPACE","\n\t\t\t",484],"}",["T_WHITESPACE","\n\n\t\t\t",485],["T_IF","if",487],["T_WHITESPACE"," ",487],"(",["T_STRING","preg_match",487],"(",["T_CONSTANT_ENCAPSED_STRING","'\/script|xss\/i'",487],",",["T_WHITESPACE"," ",487],["T_VARIABLE","$str",487],")",")",["T_WHITESPACE","\n\t\t\t",487],"{",["T_WHITESPACE","\n\t\t\t\t",488],["T_VARIABLE","$str",489],["T_WHITESPACE"," ",489],"=",["T_WHITESPACE"," ",489],["T_STRING","preg_replace",489],"(",["T_CONSTANT_ENCAPSED_STRING","'#<\/*(?:script|xss).*?>#si'",489],",",["T_WHITESPACE"," ",489],["T_CONSTANT_ENCAPSED_STRING","'[removed]'",489],",",["T_WHITESPACE"," ",489],["T_VARIABLE","$str",489],")",";",["T_WHITESPACE","\n\t\t\t",489],"}",["T_WHITESPACE","\n\t\t",490],"}",["T_WHITESPACE","\n\t\t",491],["T_WHILE","while",492],["T_WHITESPACE"," ",492],"(",["T_VARIABLE","$original",492],["T_WHITESPACE"," ",492],["T_IS_NOT_IDENTICAL","!==",492],["T_WHITESPACE"," ",492],["T_VARIABLE","$str",492],")",";",["T_WHITESPACE","\n\t\t",492],["T_UNSET","unset",493],"(",["T_VARIABLE","$original",493],")",";",["T_WHITESPACE","\n\n\t\t",493],["T_COMMENT","\/*\n\t\t * Sanitize naughty HTML elements\n\t\t *\n\t\t * If a tag containing any of the words in the list\n\t\t * below is found, the tag gets converted to entities.\n\t\t *\n\t\t * So this: <blink>\n\t\t * Becomes: &lt;blink&gt;\n\t\t *\/",495],["T_WHITESPACE","\n\t\t",503],["T_VARIABLE","$pattern",504],["T_WHITESPACE"," ",504],"=",["T_WHITESPACE"," ",504],["T_CONSTANT_ENCAPSED_STRING","'#'",504],["T_WHITESPACE","\n\t\t\t",504],".",["T_CONSTANT_ENCAPSED_STRING","'<((?<slash>\/*\\s*)((?<tagName>[a-z0-9]+)(?=[^a-z0-9]|$)|.+)'",505],["T_WHITESPACE"," ",505],["T_COMMENT","\/\/ tag start and name, followed by a non-tag character\n",505],["T_WHITESPACE","\t\t\t",506],".",["T_CONSTANT_ENCAPSED_STRING","'[^\\s\\042\\047a-z0-9>\/=]*'",506],["T_WHITESPACE"," ",506],["T_COMMENT","\/\/ a valid attribute character immediately after the tag would count as a separator\n",506],["T_WHITESPACE","\t\t\t",507],["T_COMMENT","\/\/ optional attributes\n",507],["T_WHITESPACE","\t\t\t",508],".",["T_CONSTANT_ENCAPSED_STRING","'(?<attributes>(?:[\\s\\042\\047\/=]*'",508],["T_WHITESPACE"," ",508],["T_COMMENT","\/\/ non-attribute characters, excluding > (tag close) for obvious reasons\n",508],["T_WHITESPACE","\t\t\t",509],".",["T_CONSTANT_ENCAPSED_STRING","'[^\\s\\042\\047>\/=]+'",509],["T_WHITESPACE"," ",509],["T_COMMENT","\/\/ attribute characters\n",509],["T_WHITESPACE","\t\t\t",510],["T_COMMENT","\/\/ optional attribute-value\n",510],["T_WHITESPACE","\t\t\t\t",511],".",["T_CONSTANT_ENCAPSED_STRING","'(?:\\s*='",511],["T_WHITESPACE"," ",511],["T_COMMENT","\/\/ attribute-value separator\n",511],["T_WHITESPACE","\t\t\t\t\t",512],".",["T_CONSTANT_ENCAPSED_STRING","'(?:[^\\s\\042\\047=><`]+|\\s*\\042[^\\042]*\\042|\\s*\\047[^\\047]*\\047|\\s*(?U:[^\\s\\042\\047=><`]*))'",512],["T_WHITESPACE"," ",512],["T_COMMENT","\/\/ single, double or non-quoted value\n",512],["T_WHITESPACE","\t\t\t\t",513],".",["T_CONSTANT_ENCAPSED_STRING","')?'",513],["T_WHITESPACE"," ",513],["T_COMMENT","\/\/ end optional attribute-value group\n",513],["T_WHITESPACE","\t\t\t",514],".",["T_CONSTANT_ENCAPSED_STRING","')*)'",514],["T_WHITESPACE"," ",514],["T_COMMENT","\/\/ end optional attributes group\n",514],["T_WHITESPACE","\t\t\t",515],".",["T_CONSTANT_ENCAPSED_STRING","'[^>]*)(?<closeTag>\\>)?#isS'",515],";",["T_WHITESPACE","\n\n\t\t",515],["T_COMMENT","\/\/ Note: It would be nice to optimize this for speed, BUT\n",517],["T_WHITESPACE","\t\t",518],["T_COMMENT","\/\/       only matching the naughty elements here results in\n",518],["T_WHITESPACE","\t\t",519],["T_COMMENT","\/\/       false positives and in turn - vulnerabilities!\n",519],["T_WHITESPACE","\t\t",520],["T_DO","do",520],["T_WHITESPACE","\n\t\t",520],"{",["T_WHITESPACE","\n\t\t\t",521],["T_VARIABLE","$old_str",522],["T_WHITESPACE"," ",522],"=",["T_WHITESPACE"," ",522],["T_VARIABLE","$str",522],";",["T_WHITESPACE","\n\t\t\t",522],["T_VARIABLE","$str",523],["T_WHITESPACE"," ",523],"=",["T_WHITESPACE"," ",523],["T_STRING","preg_replace_callback",523],"(",["T_VARIABLE","$pattern",523],",",["T_WHITESPACE"," ",523],["T_ARRAY","array",523],"(",["T_VARIABLE","$this",523],",",["T_WHITESPACE"," ",523],["T_CONSTANT_ENCAPSED_STRING","'_sanitize_naughty_html'",523],")",",",["T_WHITESPACE"," ",523],["T_VARIABLE","$str",523],")",";",["T_WHITESPACE","\n\t\t",523],"}",["T_WHITESPACE","\n\t\t",524],["T_WHILE","while",525],["T_WHITESPACE"," ",525],"(",["T_VARIABLE","$old_str",525],["T_WHITESPACE"," ",525],["T_IS_NOT_IDENTICAL","!==",525],["T_WHITESPACE"," ",525],["T_VARIABLE","$str",525],")",";",["T_WHITESPACE","\n\t\t",525],["T_UNSET","unset",526],"(",["T_VARIABLE","$old_str",526],")",";",["T_WHITESPACE","\n\n\t\t",526],["T_COMMENT","\/*\n\t\t * Sanitize naughty scripting elements\n\t\t *\n\t\t * Similar to above, only instead of looking for\n\t\t * tags it looks for PHP and JavaScript commands\n\t\t * that are disallowed. Rather than removing the\n\t\t * code, it simply converts the parenthesis to entities\n\t\t * rendering the code un-executable.\n\t\t *\n\t\t * For example:\teval('some code')\n\t\t * Becomes:\teval&#40;'some code'&#41;\n\t\t *\/",528],["T_WHITESPACE","\n\t\t",539],["T_VARIABLE","$str",540],["T_WHITESPACE"," ",540],"=",["T_WHITESPACE"," ",540],["T_STRING","preg_replace",540],"(",["T_WHITESPACE","\n\t\t\t",540],["T_CONSTANT_ENCAPSED_STRING","'#(alert|prompt|confirm|cmd|passthru|eval|exec|expression|system|fopen|fsockopen|file|file_get_contents|readfile|unlink)(\\s*)\\((.*?)\\)#si'",541],",",["T_WHITESPACE","\n\t\t\t",541],["T_CONSTANT_ENCAPSED_STRING","'\\\\1\\\\2&#40;\\\\3&#41;'",542],",",["T_WHITESPACE","\n\t\t\t",542],["T_VARIABLE","$str",543],["T_WHITESPACE","\n\t\t",543],")",";",["T_WHITESPACE","\n\n\t\t",544],["T_COMMENT","\/\/ Final clean up\n",546],["T_WHITESPACE","\t\t",547],["T_COMMENT","\/\/ This adds a bit of extra precaution in case\n",547],["T_WHITESPACE","\t\t",548],["T_COMMENT","\/\/ something got through the above filters\n",548],["T_WHITESPACE","\t\t",549],["T_VARIABLE","$str",549],["T_WHITESPACE"," ",549],"=",["T_WHITESPACE"," ",549],["T_VARIABLE","$this",549],["T_OBJECT_OPERATOR","->",549],["T_STRING","_do_never_allowed",549],"(",["T_VARIABLE","$str",549],")",";",["T_WHITESPACE","\n\n\t\t",549],["T_COMMENT","\/*\n\t\t * Images are Handled in a Special Way\n\t\t * - Essentially, we want to know that after all of the character\n\t\t * conversion is done whether any unwanted, likely XSS, code was found.\n\t\t * If not, we return TRUE, as the image is clean.\n\t\t * However, if the string post-conversion does not matched the\n\t\t * string post-removal of XSS, then it fails, as there was unwanted XSS\n\t\t * code found and removed\/changed during processing.\n\t\t *\/",551],["T_WHITESPACE","\n\t\t",559],["T_IF","if",560],["T_WHITESPACE"," ",560],"(",["T_VARIABLE","$is_image",560],["T_WHITESPACE"," ",560],["T_IS_IDENTICAL","===",560],["T_WHITESPACE"," ",560],["T_STRING","TRUE",560],")",["T_WHITESPACE","\n\t\t",560],"{",["T_WHITESPACE","\n\t\t\t",561],["T_RETURN","return",562],["T_WHITESPACE"," ",562],"(",["T_VARIABLE","$str",562],["T_WHITESPACE"," ",562],["T_IS_IDENTICAL","===",562],["T_WHITESPACE"," ",562],["T_VARIABLE","$converted_string",562],")",";",["T_WHITESPACE","\n\t\t",562],"}",["T_WHITESPACE","\n\n\t\t",563],["T_RETURN","return",565],["T_WHITESPACE"," ",565],["T_VARIABLE","$str",565],";",["T_WHITESPACE","\n\t",565],"}",["T_WHITESPACE","\n\n\t",566],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",568],["T_WHITESPACE","\n\t",569],["T_DOC_COMMENT","\/**\n\t * XSS Hash\n\t *\n\t * Generates the XSS hash if needed and returns it.\n\t *\n\t * @see\t\tCI_Security::$_xss_hash\n\t * @return\tstring\tXSS hash\n\t *\/",570],["T_WHITESPACE","\n\t",577],["T_PUBLIC","public",578],["T_WHITESPACE"," ",578],["T_FUNCTION","function",578],["T_WHITESPACE"," ",578],["T_STRING","xss_hash",578],"(",")",["T_WHITESPACE","\n\t",578],"{",["T_WHITESPACE","\n\t\t",579],["T_IF","if",580],["T_WHITESPACE"," ",580],"(",["T_VARIABLE","$this",580],["T_OBJECT_OPERATOR","->",580],["T_STRING","_xss_hash",580],["T_WHITESPACE"," ",580],["T_IS_IDENTICAL","===",580],["T_WHITESPACE"," ",580],["T_STRING","NULL",580],")",["T_WHITESPACE","\n\t\t",580],"{",["T_WHITESPACE","\n\t\t\t",581],["T_VARIABLE","$rand",582],["T_WHITESPACE"," ",582],"=",["T_WHITESPACE"," ",582],["T_VARIABLE","$this",582],["T_OBJECT_OPERATOR","->",582],["T_STRING","get_random_bytes",582],"(",["T_LNUMBER","16",582],")",";",["T_WHITESPACE","\n\t\t\t",582],["T_VARIABLE","$this",583],["T_OBJECT_OPERATOR","->",583],["T_STRING","_xss_hash",583],["T_WHITESPACE"," ",583],"=",["T_WHITESPACE"," ",583],"(",["T_VARIABLE","$rand",583],["T_WHITESPACE"," ",583],["T_IS_IDENTICAL","===",583],["T_WHITESPACE"," ",583],["T_STRING","FALSE",583],")",["T_WHITESPACE","\n\t\t\t\t",583],"?",["T_WHITESPACE"," ",584],["T_STRING","md5",584],"(",["T_STRING","uniqid",584],"(",["T_STRING","mt_rand",584],"(",")",",",["T_WHITESPACE"," ",584],["T_STRING","TRUE",584],")",")",["T_WHITESPACE","\n\t\t\t\t",584],":",["T_WHITESPACE"," ",585],["T_STRING","bin2hex",585],"(",["T_VARIABLE","$rand",585],")",";",["T_WHITESPACE","\n\t\t",585],"}",["T_WHITESPACE","\n\n\t\t",586],["T_RETURN","return",588],["T_WHITESPACE"," ",588],["T_VARIABLE","$this",588],["T_OBJECT_OPERATOR","->",588],["T_STRING","_xss_hash",588],";",["T_WHITESPACE","\n\t",588],"}",["T_WHITESPACE","\n\n\t",589],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",591],["T_WHITESPACE","\n\t",592],["T_DOC_COMMENT","\/**\n\t * Get random bytes\n\t *\n\t * @param\tint\t$length\tOutput length\n\t * @return\tstring\n\t *\/",593],["T_WHITESPACE","\n\t",598],["T_PUBLIC","public",599],["T_WHITESPACE"," ",599],["T_FUNCTION","function",599],["T_WHITESPACE"," ",599],["T_STRING","get_random_bytes",599],"(",["T_VARIABLE","$length",599],")",["T_WHITESPACE","\n\t",599],"{",["T_WHITESPACE","\n\t\t",600],["T_IF","if",601],["T_WHITESPACE"," ",601],"(",["T_EMPTY","empty",601],"(",["T_VARIABLE","$length",601],")",["T_WHITESPACE"," ",601],["T_LOGICAL_OR","OR",601],["T_WHITESPACE"," ",601],"!",["T_WHITESPACE"," ",601],["T_STRING","ctype_digit",601],"(",["T_STRING_CAST","(string)",601],["T_WHITESPACE"," ",601],["T_VARIABLE","$length",601],")",")",["T_WHITESPACE","\n\t\t",601],"{",["T_WHITESPACE","\n\t\t\t",602],["T_RETURN","return",603],["T_WHITESPACE"," ",603],["T_STRING","FALSE",603],";",["T_WHITESPACE","\n\t\t",603],"}",["T_WHITESPACE","\n\n\t\t",604],["T_IF","if",606],["T_WHITESPACE"," ",606],"(",["T_STRING","function_exists",606],"(",["T_CONSTANT_ENCAPSED_STRING","'random_bytes'",606],")",")",["T_WHITESPACE","\n\t\t",606],"{",["T_WHITESPACE","\n\t\t\t",607],["T_TRY","try",608],["T_WHITESPACE","\n\t\t\t",608],"{",["T_WHITESPACE","\n\t\t\t\t",609],["T_COMMENT","\/\/ The cast is required to avoid TypeError\n",610],["T_WHITESPACE","\t\t\t\t",611],["T_RETURN","return",611],["T_WHITESPACE"," ",611],["T_STRING","random_bytes",611],"(",["T_INT_CAST","(int)",611],["T_WHITESPACE"," ",611],["T_VARIABLE","$length",611],")",";",["T_WHITESPACE","\n\t\t\t",611],"}",["T_WHITESPACE","\n\t\t\t",612],["T_CATCH","catch",613],["T_WHITESPACE"," ",613],"(",["T_STRING","Exception",613],["T_WHITESPACE"," ",613],["T_VARIABLE","$e",613],")",["T_WHITESPACE","\n\t\t\t",613],"{",["T_WHITESPACE","\n\t\t\t\t",614],["T_COMMENT","\/\/ If random_bytes() can't do the job, we can't either ...\n",615],["T_WHITESPACE","\t\t\t\t",616],["T_COMMENT","\/\/ There's no point in using fallbacks.\n",616],["T_WHITESPACE","\t\t\t\t",617],["T_STRING","log_message",617],"(",["T_CONSTANT_ENCAPSED_STRING","'error'",617],",",["T_WHITESPACE"," ",617],["T_VARIABLE","$e",617],["T_OBJECT_OPERATOR","->",617],["T_STRING","getMessage",617],"(",")",")",";",["T_WHITESPACE","\n\t\t\t\t",617],["T_RETURN","return",618],["T_WHITESPACE"," ",618],["T_STRING","FALSE",618],";",["T_WHITESPACE","\n\t\t\t",618],"}",["T_WHITESPACE","\n\t\t",619],"}",["T_WHITESPACE","\n\n\t\t",620],["T_COMMENT","\/\/ Unfortunately, none of the following PRNGs is guaranteed to exist ...\n",622],["T_WHITESPACE","\t\t",623],["T_IF","if",623],["T_WHITESPACE"," ",623],"(",["T_STRING","defined",623],"(",["T_CONSTANT_ENCAPSED_STRING","'MCRYPT_DEV_URANDOM'",623],")",["T_WHITESPACE"," ",623],["T_BOOLEAN_AND","&&",623],["T_WHITESPACE"," ",623],"(",["T_VARIABLE","$output",623],["T_WHITESPACE"," ",623],"=",["T_WHITESPACE"," ",623],["T_STRING","mcrypt_create_iv",623],"(",["T_VARIABLE","$length",623],",",["T_WHITESPACE"," ",623],["T_STRING","MCRYPT_DEV_URANDOM",623],")",")",["T_WHITESPACE"," ",623],["T_IS_NOT_IDENTICAL","!==",623],["T_WHITESPACE"," ",623],["T_STRING","FALSE",623],")",["T_WHITESPACE","\n\t\t",623],"{",["T_WHITESPACE","\n\t\t\t",624],["T_RETURN","return",625],["T_WHITESPACE"," ",625],["T_VARIABLE","$output",625],";",["T_WHITESPACE","\n\t\t",625],"}",["T_WHITESPACE","\n\n\n\t\t",626],["T_IF","if",629],["T_WHITESPACE"," ",629],"(",["T_STRING","is_readable",629],"(",["T_CONSTANT_ENCAPSED_STRING","'\/dev\/urandom'",629],")",["T_WHITESPACE"," ",629],["T_BOOLEAN_AND","&&",629],["T_WHITESPACE"," ",629],"(",["T_VARIABLE","$fp",629],["T_WHITESPACE"," ",629],"=",["T_WHITESPACE"," ",629],["T_STRING","fopen",629],"(",["T_CONSTANT_ENCAPSED_STRING","'\/dev\/urandom'",629],",",["T_WHITESPACE"," ",629],["T_CONSTANT_ENCAPSED_STRING","'rb'",629],")",")",["T_WHITESPACE"," ",629],["T_IS_NOT_IDENTICAL","!==",629],["T_WHITESPACE"," ",629],["T_STRING","FALSE",629],")",["T_WHITESPACE","\n\t\t",629],"{",["T_WHITESPACE","\n\t\t\t",630],["T_COMMENT","\/\/ Try not to waste entropy ...\n",631],["T_WHITESPACE","\t\t\t",632],["T_STRING","stream_set_chunk_size",632],"(",["T_VARIABLE","$fp",632],",",["T_WHITESPACE"," ",632],["T_VARIABLE","$length",632],")",";",["T_WHITESPACE","\n\t\t\t",632],["T_VARIABLE","$output",633],["T_WHITESPACE"," ",633],"=",["T_WHITESPACE"," ",633],["T_STRING","fread",633],"(",["T_VARIABLE","$fp",633],",",["T_WHITESPACE"," ",633],["T_VARIABLE","$length",633],")",";",["T_WHITESPACE","\n\t\t\t",633],["T_STRING","fclose",634],"(",["T_VARIABLE","$fp",634],")",";",["T_WHITESPACE","\n\t\t\t",634],["T_IF","if",635],["T_WHITESPACE"," ",635],"(",["T_VARIABLE","$output",635],["T_WHITESPACE"," ",635],["T_IS_NOT_IDENTICAL","!==",635],["T_WHITESPACE"," ",635],["T_STRING","FALSE",635],")",["T_WHITESPACE","\n\t\t\t",635],"{",["T_WHITESPACE","\n\t\t\t\t",636],["T_RETURN","return",637],["T_WHITESPACE"," ",637],["T_VARIABLE","$output",637],";",["T_WHITESPACE","\n\t\t\t",637],"}",["T_WHITESPACE","\n\t\t",638],"}",["T_WHITESPACE","\n\n\t\t",639],["T_IF","if",641],["T_WHITESPACE"," ",641],"(",["T_STRING","function_exists",641],"(",["T_CONSTANT_ENCAPSED_STRING","'openssl_random_pseudo_bytes'",641],")",")",["T_WHITESPACE","\n\t\t",641],"{",["T_WHITESPACE","\n\t\t\t",642],["T_RETURN","return",643],["T_WHITESPACE"," ",643],["T_STRING","openssl_random_pseudo_bytes",643],"(",["T_VARIABLE","$length",643],")",";",["T_WHITESPACE","\n\t\t",643],"}",["T_WHITESPACE","\n\n\t\t",644],["T_RETURN","return",646],["T_WHITESPACE"," ",646],["T_STRING","FALSE",646],";",["T_WHITESPACE","\n\t",646],"}",["T_WHITESPACE","\n\n\t",647],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",649],["T_WHITESPACE","\n\t",650],["T_DOC_COMMENT","\/**\n\t * HTML Entities Decode\n\t *\n\t * A replacement for html_entity_decode()\n\t *\n\t * The reason we are not using html_entity_decode() by itself is because\n\t * while it is not technically correct to leave out the semicolon\n\t * at the end of an entity most browsers will still interpret the entity\n\t * correctly. html_entity_decode() does not convert entities without\n\t * semicolons, so we are left with our own little solution here. Bummer.\n\t *\n\t * @link\thttp:\/\/php.net\/html-entity-decode\n\t *\n\t * @param\tstring\t$str\t\tInput\n\t * @param\tstring\t$charset\tCharacter set\n\t * @return\tstring\n\t *\/",651],["T_WHITESPACE","\n\t",667],["T_PUBLIC","public",668],["T_WHITESPACE"," ",668],["T_FUNCTION","function",668],["T_WHITESPACE"," ",668],["T_STRING","entity_decode",668],"(",["T_VARIABLE","$str",668],",",["T_WHITESPACE"," ",668],["T_VARIABLE","$charset",668],["T_WHITESPACE"," ",668],"=",["T_WHITESPACE"," ",668],["T_STRING","NULL",668],")",["T_WHITESPACE","\n\t",668],"{",["T_WHITESPACE","\n\t\t",669],["T_IF","if",670],["T_WHITESPACE"," ",670],"(",["T_STRING","strpos",670],"(",["T_VARIABLE","$str",670],",",["T_WHITESPACE"," ",670],["T_CONSTANT_ENCAPSED_STRING","'&'",670],")",["T_WHITESPACE"," ",670],["T_IS_IDENTICAL","===",670],["T_WHITESPACE"," ",670],["T_STRING","FALSE",670],")",["T_WHITESPACE","\n\t\t",670],"{",["T_WHITESPACE","\n\t\t\t",671],["T_RETURN","return",672],["T_WHITESPACE"," ",672],["T_VARIABLE","$str",672],";",["T_WHITESPACE","\n\t\t",672],"}",["T_WHITESPACE","\n\n\t\t",673],["T_STATIC","static",675],["T_WHITESPACE"," ",675],["T_VARIABLE","$_entities",675],";",["T_WHITESPACE","\n\n\t\t",675],["T_ISSET","isset",677],"(",["T_VARIABLE","$charset",677],")",["T_WHITESPACE","   ",677],["T_LOGICAL_OR","OR",677],["T_WHITESPACE"," ",677],["T_VARIABLE","$charset",677],["T_WHITESPACE"," ",677],"=",["T_WHITESPACE"," ",677],["T_VARIABLE","$this",677],["T_OBJECT_OPERATOR","->",677],["T_STRING","charset",677],";",["T_WHITESPACE","\n\t\t",677],["T_ISSET","isset",678],"(",["T_VARIABLE","$_entities",678],")",["T_WHITESPACE"," ",678],["T_LOGICAL_OR","OR",678],["T_WHITESPACE"," ",678],["T_VARIABLE","$_entities",678],["T_WHITESPACE"," ",678],"=",["T_WHITESPACE"," ",678],["T_STRING","array_map",678],"(",["T_CONSTANT_ENCAPSED_STRING","'strtolower'",678],",",["T_WHITESPACE"," ",678],["T_STRING","get_html_translation_table",678],"(",["T_STRING","HTML_ENTITIES",678],",",["T_WHITESPACE"," ",678],["T_STRING","ENT_COMPAT",678],["T_WHITESPACE"," ",678],"|",["T_WHITESPACE"," ",678],["T_STRING","ENT_HTML5",678],",",["T_WHITESPACE"," ",678],["T_VARIABLE","$charset",678],")",")",";",["T_WHITESPACE","\n\n\t\t",678],["T_DO","do",680],["T_WHITESPACE","\n\t\t",680],"{",["T_WHITESPACE","\n\t\t\t",681],["T_VARIABLE","$str_compare",682],["T_WHITESPACE"," ",682],"=",["T_WHITESPACE"," ",682],["T_VARIABLE","$str",682],";",["T_WHITESPACE","\n\n\t\t\t",682],["T_COMMENT","\/\/ Decode standard entities, avoiding false positives\n",684],["T_WHITESPACE","\t\t\t",685],["T_IF","if",685],["T_WHITESPACE"," ",685],"(",["T_STRING","preg_match_all",685],"(",["T_CONSTANT_ENCAPSED_STRING","'\/&[a-z]{2,}(?![a-z;])\/i'",685],",",["T_WHITESPACE"," ",685],["T_VARIABLE","$str",685],",",["T_WHITESPACE"," ",685],["T_VARIABLE","$matches",685],")",")",["T_WHITESPACE","\n\t\t\t",685],"{",["T_WHITESPACE","\n\t\t\t\t",686],["T_VARIABLE","$replace",687],["T_WHITESPACE"," ",687],"=",["T_WHITESPACE"," ",687],["T_ARRAY","array",687],"(",")",";",["T_WHITESPACE","\n\t\t\t\t",687],["T_VARIABLE","$matches",688],["T_WHITESPACE"," ",688],"=",["T_WHITESPACE"," ",688],["T_STRING","array_unique",688],"(",["T_STRING","array_map",688],"(",["T_CONSTANT_ENCAPSED_STRING","'strtolower'",688],",",["T_WHITESPACE"," ",688],["T_VARIABLE","$matches",688],"[",["T_LNUMBER","0",688],"]",")",")",";",["T_WHITESPACE","\n\t\t\t\t",688],["T_FOREACH","foreach",689],["T_WHITESPACE"," ",689],"(",["T_VARIABLE","$matches",689],["T_WHITESPACE"," ",689],["T_AS","as",689],["T_WHITESPACE"," ",689],"&",["T_VARIABLE","$match",689],")",["T_WHITESPACE","\n\t\t\t\t",689],"{",["T_WHITESPACE","\n\t\t\t\t\t",690],["T_IF","if",691],["T_WHITESPACE"," ",691],"(","(",["T_VARIABLE","$char",691],["T_WHITESPACE"," ",691],"=",["T_WHITESPACE"," ",691],["T_STRING","array_search",691],"(",["T_VARIABLE","$match",691],".",["T_CONSTANT_ENCAPSED_STRING","';'",691],",",["T_WHITESPACE"," ",691],["T_VARIABLE","$_entities",691],",",["T_WHITESPACE"," ",691],["T_STRING","TRUE",691],")",")",["T_WHITESPACE"," ",691],["T_IS_NOT_IDENTICAL","!==",691],["T_WHITESPACE"," ",691],["T_STRING","FALSE",691],")",["T_WHITESPACE","\n\t\t\t\t\t",691],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",692],["T_VARIABLE","$replace",693],"[",["T_VARIABLE","$match",693],"]",["T_WHITESPACE"," ",693],"=",["T_WHITESPACE"," ",693],["T_VARIABLE","$char",693],";",["T_WHITESPACE","\n\t\t\t\t\t",693],"}",["T_WHITESPACE","\n\t\t\t\t",694],"}",["T_WHITESPACE","\n\n\t\t\t\t",695],["T_VARIABLE","$str",697],["T_WHITESPACE"," ",697],"=",["T_WHITESPACE"," ",697],["T_STRING","str_replace",697],"(",["T_STRING","array_keys",697],"(",["T_VARIABLE","$replace",697],")",",",["T_WHITESPACE"," ",697],["T_STRING","array_values",697],"(",["T_VARIABLE","$replace",697],")",",",["T_WHITESPACE"," ",697],["T_VARIABLE","$str",697],")",";",["T_WHITESPACE","\n\t\t\t",697],"}",["T_WHITESPACE","\n\n\t\t\t",698],["T_COMMENT","\/\/ Decode numeric & UTF16 two byte entities\n",700],["T_WHITESPACE","\t\t\t",701],["T_VARIABLE","$str",701],["T_WHITESPACE"," ",701],"=",["T_WHITESPACE"," ",701],["T_STRING","html_entity_decode",701],"(",["T_WHITESPACE","\n\t\t\t\t",701],["T_STRING","preg_replace",702],"(",["T_CONSTANT_ENCAPSED_STRING","'\/(&#(?:x0*[0-9a-f]{2,5}(?![0-9a-f;])|(?:0*\\d{2,4}(?![0-9;]))))\/iS'",702],",",["T_WHITESPACE"," ",702],["T_CONSTANT_ENCAPSED_STRING","'$1;'",702],",",["T_WHITESPACE"," ",702],["T_VARIABLE","$str",702],")",",",["T_WHITESPACE","\n\t\t\t\t",702],["T_STRING","ENT_COMPAT",703],["T_WHITESPACE"," ",703],"|",["T_WHITESPACE"," ",703],["T_STRING","ENT_HTML5",703],",",["T_WHITESPACE","\n\t\t\t\t",703],["T_VARIABLE","$charset",704],["T_WHITESPACE","\n\t\t\t",704],")",";",["T_WHITESPACE","\n\t\t",705],"}",["T_WHITESPACE","\n\t\t",706],["T_WHILE","while",707],["T_WHITESPACE"," ",707],"(",["T_VARIABLE","$str_compare",707],["T_WHITESPACE"," ",707],["T_IS_NOT_IDENTICAL","!==",707],["T_WHITESPACE"," ",707],["T_VARIABLE","$str",707],")",";",["T_WHITESPACE","\n\t\t",707],["T_RETURN","return",708],["T_WHITESPACE"," ",708],["T_VARIABLE","$str",708],";",["T_WHITESPACE","\n\t",708],"}",["T_WHITESPACE","\n\n\t",709],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",711],["T_WHITESPACE","\n\t",712],["T_DOC_COMMENT","\/**\n\t * Sanitize Filename\n\t *\n\t * @param\tstring\t$str\t\tInput file name\n\t * @param \tbool\t$relative_path\tWhether to preserve paths\n\t * @return\tstring\n\t *\/",713],["T_WHITESPACE","\n\t",719],["T_PUBLIC","public",720],["T_WHITESPACE"," ",720],["T_FUNCTION","function",720],["T_WHITESPACE"," ",720],["T_STRING","sanitize_filename",720],"(",["T_VARIABLE","$str",720],",",["T_WHITESPACE"," ",720],["T_VARIABLE","$relative_path",720],["T_WHITESPACE"," ",720],"=",["T_WHITESPACE"," ",720],["T_STRING","FALSE",720],")",["T_WHITESPACE","\n\t",720],"{",["T_WHITESPACE","\n\t\t",721],["T_VARIABLE","$bad",722],["T_WHITESPACE"," ",722],"=",["T_WHITESPACE"," ",722],["T_VARIABLE","$this",722],["T_OBJECT_OPERATOR","->",722],["T_STRING","filename_bad_chars",722],";",["T_WHITESPACE","\n\n\t\t",722],["T_IF","if",724],["T_WHITESPACE"," ",724],"(",["T_WHITESPACE"," ",724],"!",["T_WHITESPACE"," ",724],["T_VARIABLE","$relative_path",724],")",["T_WHITESPACE","\n\t\t",724],"{",["T_WHITESPACE","\n\t\t\t",725],["T_VARIABLE","$bad",726],"[","]",["T_WHITESPACE"," ",726],"=",["T_WHITESPACE"," ",726],["T_CONSTANT_ENCAPSED_STRING","'.\/'",726],";",["T_WHITESPACE","\n\t\t\t",726],["T_VARIABLE","$bad",727],"[","]",["T_WHITESPACE"," ",727],"=",["T_WHITESPACE"," ",727],["T_CONSTANT_ENCAPSED_STRING","'\/'",727],";",["T_WHITESPACE","\n\t\t",727],"}",["T_WHITESPACE","\n\n\t\t",728],["T_VARIABLE","$str",730],["T_WHITESPACE"," ",730],"=",["T_WHITESPACE"," ",730],["T_STRING","remove_invisible_characters",730],"(",["T_VARIABLE","$str",730],",",["T_WHITESPACE"," ",730],["T_STRING","FALSE",730],")",";",["T_WHITESPACE","\n\n\t\t",730],["T_DO","do",732],["T_WHITESPACE","\n\t\t",732],"{",["T_WHITESPACE","\n\t\t\t",733],["T_VARIABLE","$old",734],["T_WHITESPACE"," ",734],"=",["T_WHITESPACE"," ",734],["T_VARIABLE","$str",734],";",["T_WHITESPACE","\n\t\t\t",734],["T_VARIABLE","$str",735],["T_WHITESPACE"," ",735],"=",["T_WHITESPACE"," ",735],["T_STRING","str_replace",735],"(",["T_VARIABLE","$bad",735],",",["T_WHITESPACE"," ",735],["T_CONSTANT_ENCAPSED_STRING","''",735],",",["T_WHITESPACE"," ",735],["T_VARIABLE","$str",735],")",";",["T_WHITESPACE","\n\t\t",735],"}",["T_WHITESPACE","\n\t\t",736],["T_WHILE","while",737],["T_WHITESPACE"," ",737],"(",["T_VARIABLE","$old",737],["T_WHITESPACE"," ",737],["T_IS_NOT_IDENTICAL","!==",737],["T_WHITESPACE"," ",737],["T_VARIABLE","$str",737],")",";",["T_WHITESPACE","\n\n\t\t",737],["T_RETURN","return",739],["T_WHITESPACE"," ",739],["T_STRING","stripslashes",739],"(",["T_VARIABLE","$str",739],")",";",["T_WHITESPACE","\n\t",739],"}",["T_WHITESPACE","\n\n\t",740],["T_COMMENT","\/\/ ----------------------------------------------------------------\n",742],["T_WHITESPACE","\n\t",743],["T_DOC_COMMENT","\/**\n\t * Strip Image Tags\n\t *\n\t * @param\tstring\t$str\n\t * @return\tstring\n\t *\/",744],["T_WHITESPACE","\n\t",749],["T_PUBLIC","public",750],["T_WHITESPACE"," ",750],["T_FUNCTION","function",750],["T_WHITESPACE"," ",750],["T_STRING","strip_image_tags",750],"(",["T_VARIABLE","$str",750],")",["T_WHITESPACE","\n\t",750],"{",["T_WHITESPACE","\n\t\t",751],["T_RETURN","return",752],["T_WHITESPACE"," ",752],["T_STRING","preg_replace",752],"(",["T_WHITESPACE","\n\t\t\t",752],["T_ARRAY","array",753],"(",["T_WHITESPACE","\n\t\t\t\t",753],["T_CONSTANT_ENCAPSED_STRING","'#<img[\\s\/]+.*?src\\s*=\\s*([\"\\'])([^\\\\1]+?)\\\\1.*?\\>#i'",754],",",["T_WHITESPACE","\n\t\t\t\t",754],["T_CONSTANT_ENCAPSED_STRING","'#<img[\\s\/]+.*?src\\s*=\\s*?(([^\\s\"\\'=<>`]+)).*?\\>#i'",755],["T_WHITESPACE","\n\t\t\t",755],")",",",["T_WHITESPACE","\n\t\t\t",756],["T_CONSTANT_ENCAPSED_STRING","'\\\\2'",757],",",["T_WHITESPACE","\n\t\t\t",757],["T_VARIABLE","$str",758],["T_WHITESPACE","\n\t\t",758],")",";",["T_WHITESPACE","\n\t",759],"}",["T_WHITESPACE","\n\n\t",760],["T_COMMENT","\/\/ ----------------------------------------------------------------\n",762],["T_WHITESPACE","\n\t",763],["T_DOC_COMMENT","\/**\n\t * URL-decode taking spaces into account\n\t *\n\t * @see\t\thttps:\/\/github.com\/bcit-ci\/CodeIgniter\/issues\/4877\n\t * @param\tarray\t$matches\n\t * @return\tstring\n\t *\/",764],["T_WHITESPACE","\n\t",770],["T_PROTECTED","protected",771],["T_WHITESPACE"," ",771],["T_FUNCTION","function",771],["T_WHITESPACE"," ",771],["T_STRING","_urldecodespaces",771],"(",["T_VARIABLE","$matches",771],")",["T_WHITESPACE","\n\t",771],"{",["T_WHITESPACE","\n\t\t",772],["T_VARIABLE","$input",773],["T_WHITESPACE","    ",773],"=",["T_WHITESPACE"," ",773],["T_VARIABLE","$matches",773],"[",["T_LNUMBER","0",773],"]",";",["T_WHITESPACE","\n\t\t",773],["T_VARIABLE","$nospaces",774],["T_WHITESPACE"," ",774],"=",["T_WHITESPACE"," ",774],["T_STRING","preg_replace",774],"(",["T_CONSTANT_ENCAPSED_STRING","'#\\s+#'",774],",",["T_WHITESPACE"," ",774],["T_CONSTANT_ENCAPSED_STRING","''",774],",",["T_WHITESPACE"," ",774],["T_VARIABLE","$input",774],")",";",["T_WHITESPACE","\n\t\t",774],["T_RETURN","return",775],["T_WHITESPACE"," ",775],"(",["T_VARIABLE","$nospaces",775],["T_WHITESPACE"," ",775],["T_IS_IDENTICAL","===",775],["T_WHITESPACE"," ",775],["T_VARIABLE","$input",775],")",["T_WHITESPACE","\n\t\t\t",775],"?",["T_WHITESPACE"," ",776],["T_VARIABLE","$input",776],["T_WHITESPACE","\n\t\t\t",776],":",["T_WHITESPACE"," ",777],["T_STRING","rawurldecode",777],"(",["T_VARIABLE","$nospaces",777],")",";",["T_WHITESPACE","\n\t",777],"}",["T_WHITESPACE","\n\n\t",778],["T_COMMENT","\/\/ ----------------------------------------------------------------\n",780],["T_WHITESPACE","\n\t",781],["T_DOC_COMMENT","\/**\n\t * Compact Exploded Words\n\t *\n\t * Callback method for xss_clean() to remove whitespace from\n\t * things like 'j a v a s c r i p t'.\n\t *\n\t * @used-by\tCI_Security::xss_clean()\n\t * @param\tarray\t$matches\n\t * @return\tstring\n\t *\/",782],["T_WHITESPACE","\n\t",791],["T_PROTECTED","protected",792],["T_WHITESPACE"," ",792],["T_FUNCTION","function",792],["T_WHITESPACE"," ",792],["T_STRING","_compact_exploded_words",792],"(",["T_VARIABLE","$matches",792],")",["T_WHITESPACE","\n\t",792],"{",["T_WHITESPACE","\n\t\t",793],["T_RETURN","return",794],["T_WHITESPACE"," ",794],["T_STRING","preg_replace",794],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\\s+\/s'",794],",",["T_WHITESPACE"," ",794],["T_CONSTANT_ENCAPSED_STRING","''",794],",",["T_WHITESPACE"," ",794],["T_VARIABLE","$matches",794],"[",["T_LNUMBER","1",794],"]",")",".",["T_VARIABLE","$matches",794],"[",["T_LNUMBER","2",794],"]",";",["T_WHITESPACE","\n\t",794],"}",["T_WHITESPACE","\n\n\t",795],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",797],["T_WHITESPACE","\n\t",798],["T_DOC_COMMENT","\/**\n\t * Sanitize Naughty HTML\n\t *\n\t * Callback method for xss_clean() to remove naughty HTML elements.\n\t *\n\t * @used-by\tCI_Security::xss_clean()\n\t * @param\tarray\t$matches\n\t * @return\tstring\n\t *\/",799],["T_WHITESPACE","\n\t",807],["T_PROTECTED","protected",808],["T_WHITESPACE"," ",808],["T_FUNCTION","function",808],["T_WHITESPACE"," ",808],["T_STRING","_sanitize_naughty_html",808],"(",["T_VARIABLE","$matches",808],")",["T_WHITESPACE","\n\t",808],"{",["T_WHITESPACE","\n\t\t",809],["T_STATIC","static",810],["T_WHITESPACE"," ",810],["T_VARIABLE","$naughty_tags",810],["T_WHITESPACE","    ",810],"=",["T_WHITESPACE"," ",810],["T_ARRAY","array",810],"(",["T_WHITESPACE","\n\t\t\t",810],["T_CONSTANT_ENCAPSED_STRING","'alert'",811],",",["T_WHITESPACE"," ",811],["T_CONSTANT_ENCAPSED_STRING","'area'",811],",",["T_WHITESPACE"," ",811],["T_CONSTANT_ENCAPSED_STRING","'prompt'",811],",",["T_WHITESPACE"," ",811],["T_CONSTANT_ENCAPSED_STRING","'confirm'",811],",",["T_WHITESPACE"," ",811],["T_CONSTANT_ENCAPSED_STRING","'applet'",811],",",["T_WHITESPACE"," ",811],["T_CONSTANT_ENCAPSED_STRING","'audio'",811],",",["T_WHITESPACE"," ",811],["T_CONSTANT_ENCAPSED_STRING","'basefont'",811],",",["T_WHITESPACE"," ",811],["T_CONSTANT_ENCAPSED_STRING","'base'",811],",",["T_WHITESPACE"," ",811],["T_CONSTANT_ENCAPSED_STRING","'behavior'",811],",",["T_WHITESPACE"," ",811],["T_CONSTANT_ENCAPSED_STRING","'bgsound'",811],",",["T_WHITESPACE","\n\t\t\t",811],["T_CONSTANT_ENCAPSED_STRING","'blink'",812],",",["T_WHITESPACE"," ",812],["T_CONSTANT_ENCAPSED_STRING","'body'",812],",",["T_WHITESPACE"," ",812],["T_CONSTANT_ENCAPSED_STRING","'embed'",812],",",["T_WHITESPACE"," ",812],["T_CONSTANT_ENCAPSED_STRING","'expression'",812],",",["T_WHITESPACE"," ",812],["T_CONSTANT_ENCAPSED_STRING","'form'",812],",",["T_WHITESPACE"," ",812],["T_CONSTANT_ENCAPSED_STRING","'frameset'",812],",",["T_WHITESPACE"," ",812],["T_CONSTANT_ENCAPSED_STRING","'frame'",812],",",["T_WHITESPACE"," ",812],["T_CONSTANT_ENCAPSED_STRING","'head'",812],",",["T_WHITESPACE"," ",812],["T_CONSTANT_ENCAPSED_STRING","'html'",812],",",["T_WHITESPACE"," ",812],["T_CONSTANT_ENCAPSED_STRING","'ilayer'",812],",",["T_WHITESPACE","\n\t\t\t",812],["T_CONSTANT_ENCAPSED_STRING","'iframe'",813],",",["T_WHITESPACE"," ",813],["T_CONSTANT_ENCAPSED_STRING","'input'",813],",",["T_WHITESPACE"," ",813],["T_CONSTANT_ENCAPSED_STRING","'button'",813],",",["T_WHITESPACE"," ",813],["T_CONSTANT_ENCAPSED_STRING","'select'",813],",",["T_WHITESPACE"," ",813],["T_CONSTANT_ENCAPSED_STRING","'isindex'",813],",",["T_WHITESPACE"," ",813],["T_CONSTANT_ENCAPSED_STRING","'layer'",813],",",["T_WHITESPACE"," ",813],["T_CONSTANT_ENCAPSED_STRING","'link'",813],",",["T_WHITESPACE"," ",813],["T_CONSTANT_ENCAPSED_STRING","'meta'",813],",",["T_WHITESPACE"," ",813],["T_CONSTANT_ENCAPSED_STRING","'keygen'",813],",",["T_WHITESPACE"," ",813],["T_CONSTANT_ENCAPSED_STRING","'object'",813],",",["T_WHITESPACE","\n\t\t\t",813],["T_CONSTANT_ENCAPSED_STRING","'plaintext'",814],",",["T_WHITESPACE"," ",814],["T_CONSTANT_ENCAPSED_STRING","'style'",814],",",["T_WHITESPACE"," ",814],["T_CONSTANT_ENCAPSED_STRING","'script'",814],",",["T_WHITESPACE"," ",814],["T_CONSTANT_ENCAPSED_STRING","'textarea'",814],",",["T_WHITESPACE"," ",814],["T_CONSTANT_ENCAPSED_STRING","'title'",814],",",["T_WHITESPACE"," ",814],["T_CONSTANT_ENCAPSED_STRING","'math'",814],",",["T_WHITESPACE"," ",814],["T_CONSTANT_ENCAPSED_STRING","'video'",814],",",["T_WHITESPACE"," ",814],["T_CONSTANT_ENCAPSED_STRING","'svg'",814],",",["T_WHITESPACE"," ",814],["T_CONSTANT_ENCAPSED_STRING","'xml'",814],",",["T_WHITESPACE"," ",814],["T_CONSTANT_ENCAPSED_STRING","'xss'",814],["T_WHITESPACE","\n\t\t",814],")",";",["T_WHITESPACE","\n\n\t\t",815],["T_STATIC","static",817],["T_WHITESPACE"," ",817],["T_VARIABLE","$evil_attributes",817],["T_WHITESPACE"," ",817],"=",["T_WHITESPACE"," ",817],["T_ARRAY","array",817],"(",["T_WHITESPACE","\n\t\t\t",817],["T_CONSTANT_ENCAPSED_STRING","'on\\w+'",818],",",["T_WHITESPACE"," ",818],["T_CONSTANT_ENCAPSED_STRING","'style'",818],",",["T_WHITESPACE"," ",818],["T_CONSTANT_ENCAPSED_STRING","'xmlns'",818],",",["T_WHITESPACE"," ",818],["T_CONSTANT_ENCAPSED_STRING","'formaction'",818],",",["T_WHITESPACE"," ",818],["T_CONSTANT_ENCAPSED_STRING","'form'",818],",",["T_WHITESPACE"," ",818],["T_CONSTANT_ENCAPSED_STRING","'xlink:href'",818],",",["T_WHITESPACE"," ",818],["T_CONSTANT_ENCAPSED_STRING","'FSCommand'",818],",",["T_WHITESPACE"," ",818],["T_CONSTANT_ENCAPSED_STRING","'seekSegmentTime'",818],["T_WHITESPACE","\n\t\t",818],")",";",["T_WHITESPACE","\n\n\t\t",819],["T_COMMENT","\/\/ First, escape unclosed tags\n",821],["T_WHITESPACE","\t\t",822],["T_IF","if",822],["T_WHITESPACE"," ",822],"(",["T_EMPTY","empty",822],"(",["T_VARIABLE","$matches",822],"[",["T_CONSTANT_ENCAPSED_STRING","'closeTag'",822],"]",")",")",["T_WHITESPACE","\n\t\t",822],"{",["T_WHITESPACE","\n\t\t\t",823],["T_RETURN","return",824],["T_WHITESPACE"," ",824],["T_CONSTANT_ENCAPSED_STRING","'&lt;'",824],".",["T_VARIABLE","$matches",824],"[",["T_LNUMBER","1",824],"]",";",["T_WHITESPACE","\n\t\t",824],"}",["T_WHITESPACE","\n\t\t",825],["T_COMMENT","\/\/ Is the element that we caught naughty? If so, escape it\n",826],["T_WHITESPACE","\t\t",827],["T_ELSEIF","elseif",827],["T_WHITESPACE"," ",827],"(",["T_STRING","in_array",827],"(",["T_STRING","strtolower",827],"(",["T_VARIABLE","$matches",827],"[",["T_CONSTANT_ENCAPSED_STRING","'tagName'",827],"]",")",",",["T_WHITESPACE"," ",827],["T_VARIABLE","$naughty_tags",827],",",["T_WHITESPACE"," ",827],["T_STRING","TRUE",827],")",")",["T_WHITESPACE","\n\t\t",827],"{",["T_WHITESPACE","\n\t\t\t",828],["T_RETURN","return",829],["T_WHITESPACE"," ",829],["T_CONSTANT_ENCAPSED_STRING","'&lt;'",829],".",["T_VARIABLE","$matches",829],"[",["T_LNUMBER","1",829],"]",".",["T_CONSTANT_ENCAPSED_STRING","'&gt;'",829],";",["T_WHITESPACE","\n\t\t",829],"}",["T_WHITESPACE","\n\t\t",830],["T_COMMENT","\/\/ For other tags, see if their attributes are \"evil\" and strip those\n",831],["T_WHITESPACE","\t\t",832],["T_ELSEIF","elseif",832],["T_WHITESPACE"," ",832],"(",["T_ISSET","isset",832],"(",["T_VARIABLE","$matches",832],"[",["T_CONSTANT_ENCAPSED_STRING","'attributes'",832],"]",")",")",["T_WHITESPACE","\n\t\t",832],"{",["T_WHITESPACE","\n\t\t\t",833],["T_COMMENT","\/\/ We'll store the already fitlered attributes here\n",834],["T_WHITESPACE","\t\t\t",835],["T_VARIABLE","$attributes",835],["T_WHITESPACE"," ",835],"=",["T_WHITESPACE"," ",835],["T_ARRAY","array",835],"(",")",";",["T_WHITESPACE","\n\n\t\t\t",835],["T_COMMENT","\/\/ Attribute-catching pattern\n",837],["T_WHITESPACE","\t\t\t",838],["T_VARIABLE","$attributes_pattern",838],["T_WHITESPACE"," ",838],"=",["T_WHITESPACE"," ",838],["T_CONSTANT_ENCAPSED_STRING","'#'",838],["T_WHITESPACE","\n\t\t\t\t",838],".",["T_CONSTANT_ENCAPSED_STRING","'(?<name>[^\\s\\042\\047>\/=]+)'",839],["T_WHITESPACE"," ",839],["T_COMMENT","\/\/ attribute characters\n",839],["T_WHITESPACE","\t\t\t\t",840],["T_COMMENT","\/\/ optional attribute-value\n",840],["T_WHITESPACE","\t\t\t\t",841],".",["T_CONSTANT_ENCAPSED_STRING","'(?:\\s*=(?<value>[^\\s\\042\\047=><`]+|\\s*\\042[^\\042]*\\042|\\s*\\047[^\\047]*\\047|\\s*(?U:[^\\s\\042\\047=><`]*)))'",841],["T_WHITESPACE"," ",841],["T_COMMENT","\/\/ attribute-value separator\n",841],["T_WHITESPACE","\t\t\t\t",842],".",["T_CONSTANT_ENCAPSED_STRING","'#i'",842],";",["T_WHITESPACE","\n\n\t\t\t",842],["T_COMMENT","\/\/ Blacklist pattern for evil attribute names\n",844],["T_WHITESPACE","\t\t\t",845],["T_VARIABLE","$is_evil_pattern",845],["T_WHITESPACE"," ",845],"=",["T_WHITESPACE"," ",845],["T_CONSTANT_ENCAPSED_STRING","'#^('",845],".",["T_STRING","implode",845],"(",["T_CONSTANT_ENCAPSED_STRING","'|'",845],",",["T_WHITESPACE"," ",845],["T_VARIABLE","$evil_attributes",845],")",".",["T_CONSTANT_ENCAPSED_STRING","')$#i'",845],";",["T_WHITESPACE","\n\n\t\t\t",845],["T_COMMENT","\/\/ Each iteration filters a single attribute\n",847],["T_WHITESPACE","\t\t\t",848],["T_DO","do",848],["T_WHITESPACE","\n\t\t\t",848],"{",["T_WHITESPACE","\n\t\t\t\t",849],["T_COMMENT","\/\/ Strip any non-alpha characters that may precede an attribute.\n",850],["T_WHITESPACE","\t\t\t\t",851],["T_COMMENT","\/\/ Browsers often parse these incorrectly and that has been a\n",851],["T_WHITESPACE","\t\t\t\t",852],["T_COMMENT","\/\/ of numerous XSS issues we've had.\n",852],["T_WHITESPACE","\t\t\t\t",853],["T_VARIABLE","$matches",853],"[",["T_CONSTANT_ENCAPSED_STRING","'attributes'",853],"]",["T_WHITESPACE"," ",853],"=",["T_WHITESPACE"," ",853],["T_STRING","preg_replace",853],"(",["T_CONSTANT_ENCAPSED_STRING","'#^[^a-z]+#i'",853],",",["T_WHITESPACE"," ",853],["T_CONSTANT_ENCAPSED_STRING","''",853],",",["T_WHITESPACE"," ",853],["T_VARIABLE","$matches",853],"[",["T_CONSTANT_ENCAPSED_STRING","'attributes'",853],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t",853],["T_IF","if",855],["T_WHITESPACE"," ",855],"(",["T_WHITESPACE"," ",855],"!",["T_WHITESPACE"," ",855],["T_STRING","preg_match",855],"(",["T_VARIABLE","$attributes_pattern",855],",",["T_WHITESPACE"," ",855],["T_VARIABLE","$matches",855],"[",["T_CONSTANT_ENCAPSED_STRING","'attributes'",855],"]",",",["T_WHITESPACE"," ",855],["T_VARIABLE","$attribute",855],",",["T_WHITESPACE"," ",855],["T_STRING","PREG_OFFSET_CAPTURE",855],")",")",["T_WHITESPACE","\n\t\t\t\t",855],"{",["T_WHITESPACE","\n\t\t\t\t\t",856],["T_COMMENT","\/\/ No (valid) attribute found? Discard everything else inside the tag\n",857],["T_WHITESPACE","\t\t\t\t\t",858],["T_BREAK","break",858],";",["T_WHITESPACE","\n\t\t\t\t",858],"}",["T_WHITESPACE","\n\n\t\t\t\t",859],["T_IF","if",861],["T_WHITESPACE"," ",861],"(",["T_WHITESPACE","\n\t\t\t\t\t",861],["T_COMMENT","\/\/ Is it indeed an \"evil\" attribute?\n",862],["T_WHITESPACE","\t\t\t\t\t",863],["T_STRING","preg_match",863],"(",["T_VARIABLE","$is_evil_pattern",863],",",["T_WHITESPACE"," ",863],["T_VARIABLE","$attribute",863],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",863],"]","[",["T_LNUMBER","0",863],"]",")",["T_WHITESPACE","\n\t\t\t\t\t",863],["T_COMMENT","\/\/ Or does it have an equals sign, but no value and not quoted? Strip that too!\n",864],["T_WHITESPACE","\t\t\t\t\t",865],["T_LOGICAL_OR","OR",865],["T_WHITESPACE"," ",865],"(",["T_STRING","trim",865],"(",["T_VARIABLE","$attribute",865],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",865],"]","[",["T_LNUMBER","0",865],"]",")",["T_WHITESPACE"," ",865],["T_IS_IDENTICAL","===",865],["T_WHITESPACE"," ",865],["T_CONSTANT_ENCAPSED_STRING","''",865],")",["T_WHITESPACE","\n\t\t\t\t",865],")",["T_WHITESPACE","\n\t\t\t\t",866],"{",["T_WHITESPACE","\n\t\t\t\t\t",867],["T_VARIABLE","$attributes",868],"[","]",["T_WHITESPACE"," ",868],"=",["T_WHITESPACE"," ",868],["T_CONSTANT_ENCAPSED_STRING","'xss=removed'",868],";",["T_WHITESPACE","\n\t\t\t\t",868],"}",["T_WHITESPACE","\n\t\t\t\t",869],["T_ELSE","else",870],["T_WHITESPACE","\n\t\t\t\t",870],"{",["T_WHITESPACE","\n\t\t\t\t\t",871],["T_VARIABLE","$attributes",872],"[","]",["T_WHITESPACE"," ",872],"=",["T_WHITESPACE"," ",872],["T_VARIABLE","$attribute",872],"[",["T_LNUMBER","0",872],"]","[",["T_LNUMBER","0",872],"]",";",["T_WHITESPACE","\n\t\t\t\t",872],"}",["T_WHITESPACE","\n\n\t\t\t\t",873],["T_VARIABLE","$matches",875],"[",["T_CONSTANT_ENCAPSED_STRING","'attributes'",875],"]",["T_WHITESPACE"," ",875],"=",["T_WHITESPACE"," ",875],["T_STRING","substr",875],"(",["T_VARIABLE","$matches",875],"[",["T_CONSTANT_ENCAPSED_STRING","'attributes'",875],"]",",",["T_WHITESPACE"," ",875],["T_VARIABLE","$attribute",875],"[",["T_LNUMBER","0",875],"]","[",["T_LNUMBER","1",875],"]",["T_WHITESPACE"," ",875],"+",["T_WHITESPACE"," ",875],["T_STRING","strlen",875],"(",["T_VARIABLE","$attribute",875],"[",["T_LNUMBER","0",875],"]","[",["T_LNUMBER","0",875],"]",")",")",";",["T_WHITESPACE","\n\t\t\t",875],"}",["T_WHITESPACE","\n\t\t\t",876],["T_WHILE","while",877],["T_WHITESPACE"," ",877],"(",["T_VARIABLE","$matches",877],"[",["T_CONSTANT_ENCAPSED_STRING","'attributes'",877],"]",["T_WHITESPACE"," ",877],["T_IS_NOT_IDENTICAL","!==",877],["T_WHITESPACE"," ",877],["T_CONSTANT_ENCAPSED_STRING","''",877],")",";",["T_WHITESPACE","\n\n\t\t\t",877],["T_VARIABLE","$attributes",879],["T_WHITESPACE"," ",879],"=",["T_WHITESPACE"," ",879],["T_EMPTY","empty",879],"(",["T_VARIABLE","$attributes",879],")",["T_WHITESPACE","\n\t\t\t\t",879],"?",["T_WHITESPACE"," ",880],["T_CONSTANT_ENCAPSED_STRING","''",880],["T_WHITESPACE","\n\t\t\t\t",880],":",["T_WHITESPACE"," ",881],["T_CONSTANT_ENCAPSED_STRING","' '",881],".",["T_STRING","implode",881],"(",["T_CONSTANT_ENCAPSED_STRING","' '",881],",",["T_WHITESPACE"," ",881],["T_VARIABLE","$attributes",881],")",";",["T_WHITESPACE","\n\t\t\t",881],["T_RETURN","return",882],["T_WHITESPACE"," ",882],["T_CONSTANT_ENCAPSED_STRING","'<'",882],".",["T_VARIABLE","$matches",882],"[",["T_CONSTANT_ENCAPSED_STRING","'slash'",882],"]",".",["T_VARIABLE","$matches",882],"[",["T_CONSTANT_ENCAPSED_STRING","'tagName'",882],"]",".",["T_VARIABLE","$attributes",882],".",["T_CONSTANT_ENCAPSED_STRING","'>'",882],";",["T_WHITESPACE","\n\t\t",882],"}",["T_WHITESPACE","\n\n\t\t",883],["T_RETURN","return",885],["T_WHITESPACE"," ",885],["T_VARIABLE","$matches",885],"[",["T_LNUMBER","0",885],"]",";",["T_WHITESPACE","\n\t",885],"}",["T_WHITESPACE","\n\n\t",886],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",888],["T_WHITESPACE","\n\t",889],["T_DOC_COMMENT","\/**\n\t * JS Link Removal\n\t *\n\t * Callback method for xss_clean() to sanitize links.\n\t *\n\t * This limits the PCRE backtracks, making it more performance friendly\n\t * and prevents PREG_BACKTRACK_LIMIT_ERROR from being triggered in\n\t * PHP 5.2+ on link-heavy strings.\n\t *\n\t * @used-by\tCI_Security::xss_clean()\n\t * @param\tarray\t$match\n\t * @return\tstring\n\t *\/",890],["T_WHITESPACE","\n\t",902],["T_PROTECTED","protected",903],["T_WHITESPACE"," ",903],["T_FUNCTION","function",903],["T_WHITESPACE"," ",903],["T_STRING","_js_link_removal",903],"(",["T_VARIABLE","$match",903],")",["T_WHITESPACE","\n\t",903],"{",["T_WHITESPACE","\n\t\t",904],["T_RETURN","return",905],["T_WHITESPACE"," ",905],["T_STRING","str_replace",905],"(",["T_WHITESPACE","\n\t\t\t",905],["T_VARIABLE","$match",906],"[",["T_LNUMBER","1",906],"]",",",["T_WHITESPACE","\n\t\t\t",906],["T_STRING","preg_replace",907],"(",["T_WHITESPACE","\n\t\t\t\t",907],["T_CONSTANT_ENCAPSED_STRING","'#href=.*?(?:(?:alert|prompt|confirm)(?:\\(|&\\#40;)|javascript:|livescript:|mocha:|charset=|window\\.|document\\.|\\.cookie|<script|<xss|d\\s*a\\s*t\\s*a\\s*:)#si'",908],",",["T_WHITESPACE","\n\t\t\t\t",908],["T_CONSTANT_ENCAPSED_STRING","''",909],",",["T_WHITESPACE","\n\t\t\t\t",909],["T_VARIABLE","$this",910],["T_OBJECT_OPERATOR","->",910],["T_STRING","_filter_attributes",910],"(",["T_VARIABLE","$match",910],"[",["T_LNUMBER","1",910],"]",")",["T_WHITESPACE","\n\t\t\t",910],")",",",["T_WHITESPACE","\n\t\t\t",911],["T_VARIABLE","$match",912],"[",["T_LNUMBER","0",912],"]",["T_WHITESPACE","\n\t\t",912],")",";",["T_WHITESPACE","\n\t",913],"}",["T_WHITESPACE","\n\n\t",914],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",916],["T_WHITESPACE","\n\t",917],["T_DOC_COMMENT","\/**\n\t * JS Image Removal\n\t *\n\t * Callback method for xss_clean() to sanitize image tags.\n\t *\n\t * This limits the PCRE backtracks, making it more performance friendly\n\t * and prevents PREG_BACKTRACK_LIMIT_ERROR from being triggered in\n\t * PHP 5.2+ on image tag heavy strings.\n\t *\n\t * @used-by\tCI_Security::xss_clean()\n\t * @param\tarray\t$match\n\t * @return\tstring\n\t *\/",918],["T_WHITESPACE","\n\t",930],["T_PROTECTED","protected",931],["T_WHITESPACE"," ",931],["T_FUNCTION","function",931],["T_WHITESPACE"," ",931],["T_STRING","_js_img_removal",931],"(",["T_VARIABLE","$match",931],")",["T_WHITESPACE","\n\t",931],"{",["T_WHITESPACE","\n\t\t",932],["T_RETURN","return",933],["T_WHITESPACE"," ",933],["T_STRING","str_replace",933],"(",["T_WHITESPACE","\n\t\t\t",933],["T_VARIABLE","$match",934],"[",["T_LNUMBER","1",934],"]",",",["T_WHITESPACE","\n\t\t\t",934],["T_STRING","preg_replace",935],"(",["T_WHITESPACE","\n\t\t\t\t",935],["T_CONSTANT_ENCAPSED_STRING","'#src=.*?(?:(?:alert|prompt|confirm|eval)(?:\\(|&\\#40;)|javascript:|livescript:|mocha:|charset=|window\\.|document\\.|\\.cookie|<script|<xss|base64\\s*,)#si'",936],",",["T_WHITESPACE","\n\t\t\t\t",936],["T_CONSTANT_ENCAPSED_STRING","''",937],",",["T_WHITESPACE","\n\t\t\t\t",937],["T_VARIABLE","$this",938],["T_OBJECT_OPERATOR","->",938],["T_STRING","_filter_attributes",938],"(",["T_VARIABLE","$match",938],"[",["T_LNUMBER","1",938],"]",")",["T_WHITESPACE","\n\t\t\t",938],")",",",["T_WHITESPACE","\n\t\t\t",939],["T_VARIABLE","$match",940],"[",["T_LNUMBER","0",940],"]",["T_WHITESPACE","\n\t\t",940],")",";",["T_WHITESPACE","\n\t",941],"}",["T_WHITESPACE","\n\n\t",942],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",944],["T_WHITESPACE","\n\t",945],["T_DOC_COMMENT","\/**\n\t * Attribute Conversion\n\t *\n\t * @used-by\tCI_Security::xss_clean()\n\t * @param\tarray\t$match\n\t * @return\tstring\n\t *\/",946],["T_WHITESPACE","\n\t",952],["T_PROTECTED","protected",953],["T_WHITESPACE"," ",953],["T_FUNCTION","function",953],["T_WHITESPACE"," ",953],["T_STRING","_convert_attribute",953],"(",["T_VARIABLE","$match",953],")",["T_WHITESPACE","\n\t",953],"{",["T_WHITESPACE","\n\t\t",954],["T_RETURN","return",955],["T_WHITESPACE"," ",955],["T_STRING","str_replace",955],"(",["T_ARRAY","array",955],"(",["T_CONSTANT_ENCAPSED_STRING","'>'",955],",",["T_WHITESPACE"," ",955],["T_CONSTANT_ENCAPSED_STRING","'<'",955],",",["T_WHITESPACE"," ",955],["T_CONSTANT_ENCAPSED_STRING","'\\\\'",955],")",",",["T_WHITESPACE"," ",955],["T_ARRAY","array",955],"(",["T_CONSTANT_ENCAPSED_STRING","'&gt;'",955],",",["T_WHITESPACE"," ",955],["T_CONSTANT_ENCAPSED_STRING","'&lt;'",955],",",["T_WHITESPACE"," ",955],["T_CONSTANT_ENCAPSED_STRING","'\\\\\\\\'",955],")",",",["T_WHITESPACE"," ",955],["T_VARIABLE","$match",955],"[",["T_LNUMBER","0",955],"]",")",";",["T_WHITESPACE","\n\t",955],"}",["T_WHITESPACE","\n\n\t",956],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",958],["T_WHITESPACE","\n\t",959],["T_DOC_COMMENT","\/**\n\t * Filter Attributes\n\t *\n\t * Filters tag attributes for consistency and safety.\n\t *\n\t * @used-by\tCI_Security::_js_img_removal()\n\t * @used-by\tCI_Security::_js_link_removal()\n\t * @param\tstring\t$str\n\t * @return\tstring\n\t *\/",960],["T_WHITESPACE","\n\t",969],["T_PROTECTED","protected",970],["T_WHITESPACE"," ",970],["T_FUNCTION","function",970],["T_WHITESPACE"," ",970],["T_STRING","_filter_attributes",970],"(",["T_VARIABLE","$str",970],")",["T_WHITESPACE","\n\t",970],"{",["T_WHITESPACE","\n\t\t",971],["T_VARIABLE","$out",972],["T_WHITESPACE"," ",972],"=",["T_WHITESPACE"," ",972],["T_CONSTANT_ENCAPSED_STRING","''",972],";",["T_WHITESPACE","\n\t\t",972],["T_IF","if",973],["T_WHITESPACE"," ",973],"(",["T_STRING","preg_match_all",973],"(",["T_CONSTANT_ENCAPSED_STRING","'#\\s*[a-z\\-]+\\s*=\\s*(\\042|\\047)([^\\\\1]*?)\\\\1#is'",973],",",["T_WHITESPACE"," ",973],["T_VARIABLE","$str",973],",",["T_WHITESPACE"," ",973],["T_VARIABLE","$matches",973],")",")",["T_WHITESPACE","\n\t\t",973],"{",["T_WHITESPACE","\n\t\t\t",974],["T_FOREACH","foreach",975],["T_WHITESPACE"," ",975],"(",["T_VARIABLE","$matches",975],"[",["T_LNUMBER","0",975],"]",["T_WHITESPACE"," ",975],["T_AS","as",975],["T_WHITESPACE"," ",975],["T_VARIABLE","$match",975],")",["T_WHITESPACE","\n\t\t\t",975],"{",["T_WHITESPACE","\n\t\t\t\t",976],["T_VARIABLE","$out",977],["T_WHITESPACE"," ",977],["T_CONCAT_EQUAL",".=",977],["T_WHITESPACE"," ",977],["T_STRING","preg_replace",977],"(",["T_CONSTANT_ENCAPSED_STRING","'#\/\\*.*?\\*\/#s'",977],",",["T_WHITESPACE"," ",977],["T_CONSTANT_ENCAPSED_STRING","''",977],",",["T_WHITESPACE"," ",977],["T_VARIABLE","$match",977],")",";",["T_WHITESPACE","\n\t\t\t",977],"}",["T_WHITESPACE","\n\t\t",978],"}",["T_WHITESPACE","\n\n\t\t",979],["T_RETURN","return",981],["T_WHITESPACE"," ",981],["T_VARIABLE","$out",981],";",["T_WHITESPACE","\n\t",981],"}",["T_WHITESPACE","\n\n\t",982],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",984],["T_WHITESPACE","\n\t",985],["T_DOC_COMMENT","\/**\n\t * HTML Entity Decode Callback\n\t *\n\t * @used-by\tCI_Security::xss_clean()\n\t * @param\tarray\t$match\n\t * @return\tstring\n\t *\/",986],["T_WHITESPACE","\n\t",992],["T_PROTECTED","protected",993],["T_WHITESPACE"," ",993],["T_FUNCTION","function",993],["T_WHITESPACE"," ",993],["T_STRING","_decode_entity",993],"(",["T_VARIABLE","$match",993],")",["T_WHITESPACE","\n\t",993],"{",["T_WHITESPACE","\n\t\t",994],["T_COMMENT","\/\/ Protect GET variables in URLs\n",995],["T_WHITESPACE","\t\t",996],["T_COMMENT","\/\/ 901119URL5918AMP18930PROTECT8198\n",996],["T_WHITESPACE","\t\t",997],["T_VARIABLE","$match",997],["T_WHITESPACE"," ",997],"=",["T_WHITESPACE"," ",997],["T_STRING","preg_replace",997],"(",["T_CONSTANT_ENCAPSED_STRING","'|\\&([a-z\\_0-9\\-]+)\\=([a-z\\_0-9\\-\/]+)|i'",997],",",["T_WHITESPACE"," ",997],["T_VARIABLE","$this",997],["T_OBJECT_OPERATOR","->",997],["T_STRING","xss_hash",997],"(",")",".",["T_CONSTANT_ENCAPSED_STRING","'\\\\1=\\\\2'",997],",",["T_WHITESPACE"," ",997],["T_VARIABLE","$match",997],"[",["T_LNUMBER","0",997],"]",")",";",["T_WHITESPACE","\n\n\t\t",997],["T_COMMENT","\/\/ Decode, then un-protect URL GET vars\n",999],["T_WHITESPACE","\t\t",1000],["T_RETURN","return",1000],["T_WHITESPACE"," ",1000],["T_STRING","str_replace",1000],"(",["T_WHITESPACE","\n\t\t\t",1000],["T_VARIABLE","$this",1001],["T_OBJECT_OPERATOR","->",1001],["T_STRING","xss_hash",1001],"(",")",",",["T_WHITESPACE","\n\t\t\t",1001],["T_CONSTANT_ENCAPSED_STRING","'&'",1002],",",["T_WHITESPACE","\n\t\t\t",1002],["T_VARIABLE","$this",1003],["T_OBJECT_OPERATOR","->",1003],["T_STRING","entity_decode",1003],"(",["T_VARIABLE","$match",1003],",",["T_WHITESPACE"," ",1003],["T_VARIABLE","$this",1003],["T_OBJECT_OPERATOR","->",1003],["T_STRING","charset",1003],")",["T_WHITESPACE","\n\t\t",1003],")",";",["T_WHITESPACE","\n\t",1004],"}",["T_WHITESPACE","\n\n\t",1005],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",1007],["T_WHITESPACE","\n\t",1008],["T_DOC_COMMENT","\/**\n\t * Do Never Allowed\n\t *\n\t * @used-by\tCI_Security::xss_clean()\n\t * @param \tstring\n\t * @return \tstring\n\t *\/",1009],["T_WHITESPACE","\n\t",1015],["T_PROTECTED","protected",1016],["T_WHITESPACE"," ",1016],["T_FUNCTION","function",1016],["T_WHITESPACE"," ",1016],["T_STRING","_do_never_allowed",1016],"(",["T_VARIABLE","$str",1016],")",["T_WHITESPACE","\n\t",1016],"{",["T_WHITESPACE","\n\t\t",1017],["T_VARIABLE","$str",1018],["T_WHITESPACE"," ",1018],"=",["T_WHITESPACE"," ",1018],["T_STRING","str_replace",1018],"(",["T_STRING","array_keys",1018],"(",["T_VARIABLE","$this",1018],["T_OBJECT_OPERATOR","->",1018],["T_STRING","_never_allowed_str",1018],")",",",["T_WHITESPACE"," ",1018],["T_VARIABLE","$this",1018],["T_OBJECT_OPERATOR","->",1018],["T_STRING","_never_allowed_str",1018],",",["T_WHITESPACE"," ",1018],["T_VARIABLE","$str",1018],")",";",["T_WHITESPACE","\n\n\t\t",1018],["T_FOREACH","foreach",1020],["T_WHITESPACE"," ",1020],"(",["T_VARIABLE","$this",1020],["T_OBJECT_OPERATOR","->",1020],["T_STRING","_never_allowed_regex",1020],["T_WHITESPACE"," ",1020],["T_AS","as",1020],["T_WHITESPACE"," ",1020],["T_VARIABLE","$regex",1020],")",["T_WHITESPACE","\n\t\t",1020],"{",["T_WHITESPACE","\n\t\t\t",1021],["T_VARIABLE","$str",1022],["T_WHITESPACE"," ",1022],"=",["T_WHITESPACE"," ",1022],["T_STRING","preg_replace",1022],"(",["T_CONSTANT_ENCAPSED_STRING","'#'",1022],".",["T_VARIABLE","$regex",1022],".",["T_CONSTANT_ENCAPSED_STRING","'#is'",1022],",",["T_WHITESPACE"," ",1022],["T_CONSTANT_ENCAPSED_STRING","'[removed]'",1022],",",["T_WHITESPACE"," ",1022],["T_VARIABLE","$str",1022],")",";",["T_WHITESPACE","\n\t\t",1022],"}",["T_WHITESPACE","\n\n\t\t",1023],["T_RETURN","return",1025],["T_WHITESPACE"," ",1025],["T_VARIABLE","$str",1025],";",["T_WHITESPACE","\n\t",1025],"}",["T_WHITESPACE","\n\n\t",1026],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",1028],["T_WHITESPACE","\n\t",1029],["T_DOC_COMMENT","\/**\n\t * Set CSRF Hash and Cookie\n\t *\n\t * @return\tstring\n\t *\/",1030],["T_WHITESPACE","\n\t",1034],["T_PROTECTED","protected",1035],["T_WHITESPACE"," ",1035],["T_FUNCTION","function",1035],["T_WHITESPACE"," ",1035],["T_STRING","_csrf_set_hash",1035],"(",")",["T_WHITESPACE","\n\t",1035],"{",["T_WHITESPACE","\n\t\t",1036],["T_IF","if",1037],["T_WHITESPACE"," ",1037],"(",["T_VARIABLE","$this",1037],["T_OBJECT_OPERATOR","->",1037],["T_STRING","_csrf_hash",1037],["T_WHITESPACE"," ",1037],["T_IS_IDENTICAL","===",1037],["T_WHITESPACE"," ",1037],["T_STRING","NULL",1037],")",["T_WHITESPACE","\n\t\t",1037],"{",["T_WHITESPACE","\n\t\t\t",1038],["T_COMMENT","\/\/ If the cookie exists we will use its value.\n",1039],["T_WHITESPACE","\t\t\t",1040],["T_COMMENT","\/\/ We don't necessarily want to regenerate it with\n",1040],["T_WHITESPACE","\t\t\t",1041],["T_COMMENT","\/\/ each page load since a page could contain embedded\n",1041],["T_WHITESPACE","\t\t\t",1042],["T_COMMENT","\/\/ sub-pages causing this feature to fail\n",1042],["T_WHITESPACE","\t\t\t",1043],["T_IF","if",1043],["T_WHITESPACE"," ",1043],"(",["T_ISSET","isset",1043],"(",["T_VARIABLE","$_COOKIE",1043],"[",["T_VARIABLE","$this",1043],["T_OBJECT_OPERATOR","->",1043],["T_STRING","_csrf_cookie_name",1043],"]",")",["T_WHITESPACE"," ",1043],["T_BOOLEAN_AND","&&",1043],["T_WHITESPACE"," ",1043],["T_STRING","is_string",1043],"(",["T_VARIABLE","$_COOKIE",1043],"[",["T_VARIABLE","$this",1043],["T_OBJECT_OPERATOR","->",1043],["T_STRING","_csrf_cookie_name",1043],"]",")",["T_WHITESPACE","\n\t\t\t\t",1043],["T_BOOLEAN_AND","&&",1044],["T_WHITESPACE"," ",1044],["T_STRING","preg_match",1044],"(",["T_CONSTANT_ENCAPSED_STRING","'#^[0-9a-f]{32}$#iS'",1044],",",["T_WHITESPACE"," ",1044],["T_VARIABLE","$_COOKIE",1044],"[",["T_VARIABLE","$this",1044],["T_OBJECT_OPERATOR","->",1044],["T_STRING","_csrf_cookie_name",1044],"]",")",["T_WHITESPACE"," ",1044],["T_IS_IDENTICAL","===",1044],["T_WHITESPACE"," ",1044],["T_LNUMBER","1",1044],")",["T_WHITESPACE","\n\t\t\t",1044],"{",["T_WHITESPACE","\n\t\t\t\t",1045],["T_RETURN","return",1046],["T_WHITESPACE"," ",1046],["T_VARIABLE","$this",1046],["T_OBJECT_OPERATOR","->",1046],["T_STRING","_csrf_hash",1046],["T_WHITESPACE"," ",1046],"=",["T_WHITESPACE"," ",1046],["T_VARIABLE","$_COOKIE",1046],"[",["T_VARIABLE","$this",1046],["T_OBJECT_OPERATOR","->",1046],["T_STRING","_csrf_cookie_name",1046],"]",";",["T_WHITESPACE","\n\t\t\t",1046],"}",["T_WHITESPACE","\n\n\t\t\t",1047],["T_VARIABLE","$rand",1049],["T_WHITESPACE"," ",1049],"=",["T_WHITESPACE"," ",1049],["T_VARIABLE","$this",1049],["T_OBJECT_OPERATOR","->",1049],["T_STRING","get_random_bytes",1049],"(",["T_LNUMBER","16",1049],")",";",["T_WHITESPACE","\n\t\t\t",1049],["T_VARIABLE","$this",1050],["T_OBJECT_OPERATOR","->",1050],["T_STRING","_csrf_hash",1050],["T_WHITESPACE"," ",1050],"=",["T_WHITESPACE"," ",1050],"(",["T_VARIABLE","$rand",1050],["T_WHITESPACE"," ",1050],["T_IS_IDENTICAL","===",1050],["T_WHITESPACE"," ",1050],["T_STRING","FALSE",1050],")",["T_WHITESPACE","\n\t\t\t\t",1050],"?",["T_WHITESPACE"," ",1051],["T_STRING","md5",1051],"(",["T_STRING","uniqid",1051],"(",["T_STRING","mt_rand",1051],"(",")",",",["T_WHITESPACE"," ",1051],["T_STRING","TRUE",1051],")",")",["T_WHITESPACE","\n\t\t\t\t",1051],":",["T_WHITESPACE"," ",1052],["T_STRING","bin2hex",1052],"(",["T_VARIABLE","$rand",1052],")",";",["T_WHITESPACE","\n\t\t",1052],"}",["T_WHITESPACE","\n\n\t\t",1053],["T_RETURN","return",1055],["T_WHITESPACE"," ",1055],["T_VARIABLE","$this",1055],["T_OBJECT_OPERATOR","->",1055],["T_STRING","_csrf_hash",1055],";",["T_WHITESPACE","\n\t",1055],"}",["T_WHITESPACE","\n",1056],"}",["T_WHITESPACE","\n",1057]]