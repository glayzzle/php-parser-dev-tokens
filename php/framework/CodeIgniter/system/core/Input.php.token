[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CodeIgniter\n *\n * An open source application development framework for PHP\n *\n * This content is released under the MIT License (MIT)\n *\n * Copyright (c) 2014 - 2017, British Columbia Institute of Technology\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and\/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n *\n * @package\tCodeIgniter\n * @author\tEllisLab Dev Team\n * @copyright\tCopyright (c) 2008 - 2014, EllisLab, Inc. (https:\/\/ellislab.com\/)\n * @copyright\tCopyright (c) 2014 - 2017, British Columbia Institute of Technology (http:\/\/bcit.ca\/)\n * @license\thttp:\/\/opensource.org\/licenses\/MIT\tMIT License\n * @link\thttps:\/\/codeigniter.com\n * @since\tVersion 1.0.0\n * @filesource\n *\/",2],["T_WHITESPACE","\n",37],["T_STRING","defined",38],"(",["T_CONSTANT_ENCAPSED_STRING","'BASEPATH'",38],")",["T_WHITESPACE"," ",38],["T_LOGICAL_OR","OR",38],["T_WHITESPACE"," ",38],["T_EXIT","exit",38],"(",["T_CONSTANT_ENCAPSED_STRING","'No direct script access allowed'",38],")",";",["T_WHITESPACE","\n\n",38],["T_DOC_COMMENT","\/**\n * Input Class\n *\n * Pre-processes global input data for security\n *\n * @package\t\tCodeIgniter\n * @subpackage\tLibraries\n * @category\tInput\n * @author\t\tEllisLab Dev Team\n * @link\t\thttps:\/\/codeigniter.com\/user_guide\/libraries\/input.html\n *\/",40],["T_WHITESPACE","\n",50],["T_CLASS","class",51],["T_WHITESPACE"," ",51],["T_STRING","CI_Input",51],["T_WHITESPACE"," ",51],"{",["T_WHITESPACE","\n\n\t",51],["T_DOC_COMMENT","\/**\n\t * IP address of the current user\n\t *\n\t * @var\tstring\n\t *\/",53],["T_WHITESPACE","\n\t",57],["T_PROTECTED","protected",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$ip_address",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_STRING","FALSE",58],";",["T_WHITESPACE","\n\n\t",58],["T_DOC_COMMENT","\/**\n\t * List of all HTTP request headers\n\t *\n\t * @var array\n\t *\/",60],["T_WHITESPACE","\n\t",64],["T_PROTECTED","protected",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$headers",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_ARRAY","array",65],"(",")",";",["T_WHITESPACE","\n\n\t",65],["T_DOC_COMMENT","\/**\n\t * Raw input stream data\n\t *\n\t * Holds a cache of php:\/\/input contents\n\t *\n\t * @var\tstring\n\t *\/",67],["T_WHITESPACE","\n\t",73],["T_PROTECTED","protected",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$_raw_input_stream",74],";",["T_WHITESPACE","\n\n\t",74],["T_DOC_COMMENT","\/**\n\t * Parsed input stream data\n\t *\n\t * Parsed from php:\/\/input at runtime\n\t *\n\t * @see\tCI_Input::input_stream()\n\t * @var\tarray\n\t *\/",76],["T_WHITESPACE","\n\t",83],["T_PROTECTED","protected",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$_input_stream",84],";",["T_WHITESPACE","\n\n\t",84],["T_DOC_COMMENT","\/**\n\t * CI_Security instance\n\t *\n\t * Used for the optional $xss_filter parameter that most\n\t * getter methods have here.\n\t *\n\t * @var\tCI_Security\n\t *\/",86],["T_WHITESPACE","\n\t",93],["T_PROTECTED","protected",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$security",94],";",["T_WHITESPACE","\n\n\t",94],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",96],["T_WHITESPACE","\n\t",97],["T_DOC_COMMENT","\/**\n\t * Class constructor\n\t *\n\t * Determines whether to globally enable the XSS processing\n\t * and whether to allow the $_GET array.\n\t *\n\t * @return\tvoid\n\t *\/",98],["T_WHITESPACE","\n\t",105],["T_PUBLIC","public",106],["T_WHITESPACE"," ",106],["T_FUNCTION","function",106],["T_WHITESPACE"," ",106],["T_STRING","__construct",106],"(",["T_STRING","CI_Security",106],["T_WHITESPACE"," ",106],"&",["T_VARIABLE","$security",106],")",["T_WHITESPACE","\n\t",106],"{",["T_WHITESPACE","\n\t\t",107],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","security",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$security",108],";",["T_WHITESPACE","\n\t\t",108],["T_STRING","log_message",109],"(",["T_CONSTANT_ENCAPSED_STRING","'info'",109],",",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'Input Class Initialized'",109],")",";",["T_WHITESPACE","\n\t",109],"}",["T_WHITESPACE","\n\n\t",110],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",112],["T_WHITESPACE","\n\t",113],["T_DOC_COMMENT","\/**\n\t * Fetch from array\n\t *\n\t * Internal method used to retrieve values from global arrays.\n\t *\n\t * @param\tarray\t&$array\t\t$_GET, $_POST, $_COOKIE, $_SERVER, etc.\n\t * @param\tmixed\t$index\t\tIndex for item to be fetched from $array\n\t * @param\tbool\t$xss_clean\tWhether to apply XSS filtering\n\t * @return\tmixed\n\t *\/",114],["T_WHITESPACE","\n\t",123],["T_PROTECTED","protected",124],["T_WHITESPACE"," ",124],["T_FUNCTION","function",124],["T_WHITESPACE"," ",124],["T_STRING","_fetch_from_array",124],"(","&",["T_VARIABLE","$array",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$index",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_STRING","NULL",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$xss_clean",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_STRING","FALSE",124],")",["T_WHITESPACE","\n\t",124],"{",["T_WHITESPACE","\n\t\t",125],["T_COMMENT","\/\/ If $index is NULL, it means that the whole $array is requested\n",126],["T_WHITESPACE","\t\t",127],["T_ISSET","isset",127],"(",["T_VARIABLE","$index",127],")",["T_WHITESPACE"," ",127],["T_LOGICAL_OR","OR",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$index",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_STRING","array_keys",127],"(",["T_VARIABLE","$array",127],")",";",["T_WHITESPACE","\n\n\t\t",127],["T_COMMENT","\/\/ allow fetching multiple keys at once\n",129],["T_WHITESPACE","\t\t",130],["T_IF","if",130],["T_WHITESPACE"," ",130],"(",["T_STRING","is_array",130],"(",["T_VARIABLE","$index",130],")",")",["T_WHITESPACE","\n\t\t",130],"{",["T_WHITESPACE","\n\t\t\t",131],["T_VARIABLE","$output",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_ARRAY","array",132],"(",")",";",["T_WHITESPACE","\n\t\t\t",132],["T_FOREACH","foreach",133],["T_WHITESPACE"," ",133],"(",["T_VARIABLE","$index",133],["T_WHITESPACE"," ",133],["T_AS","as",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$key",133],")",["T_WHITESPACE","\n\t\t\t",133],"{",["T_WHITESPACE","\n\t\t\t\t",134],["T_VARIABLE","$output",135],"[",["T_VARIABLE","$key",135],"]",["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","_fetch_from_array",135],"(",["T_VARIABLE","$array",135],",",["T_WHITESPACE"," ",135],["T_VARIABLE","$key",135],",",["T_WHITESPACE"," ",135],["T_VARIABLE","$xss_clean",135],")",";",["T_WHITESPACE","\n\t\t\t",135],"}",["T_WHITESPACE","\n\n\t\t\t",136],["T_RETURN","return",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$output",138],";",["T_WHITESPACE","\n\t\t",138],"}",["T_WHITESPACE","\n\n\t\t",139],["T_IF","if",141],["T_WHITESPACE"," ",141],"(",["T_ISSET","isset",141],"(",["T_VARIABLE","$array",141],"[",["T_VARIABLE","$index",141],"]",")",")",["T_WHITESPACE","\n\t\t",141],"{",["T_WHITESPACE","\n\t\t\t",142],["T_VARIABLE","$value",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_VARIABLE","$array",143],"[",["T_VARIABLE","$index",143],"]",";",["T_WHITESPACE","\n\t\t",143],"}",["T_WHITESPACE","\n\t\t",144],["T_ELSEIF","elseif",145],["T_WHITESPACE"," ",145],"(","(",["T_VARIABLE","$count",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_STRING","preg_match_all",145],"(",["T_CONSTANT_ENCAPSED_STRING","'\/(?:^[^\\[]+)|\\[[^]]*\\]\/'",145],",",["T_WHITESPACE"," ",145],["T_VARIABLE","$index",145],",",["T_WHITESPACE"," ",145],["T_VARIABLE","$matches",145],")",")",["T_WHITESPACE"," ",145],">",["T_WHITESPACE"," ",145],["T_LNUMBER","1",145],")",["T_WHITESPACE"," ",145],["T_COMMENT","\/\/ Does the index contain array notation\n",145],["T_WHITESPACE","\t\t",146],"{",["T_WHITESPACE","\n\t\t\t",146],["T_VARIABLE","$value",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_VARIABLE","$array",147],";",["T_WHITESPACE","\n\t\t\t",147],["T_FOR","for",148],["T_WHITESPACE"," ",148],"(",["T_VARIABLE","$i",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_LNUMBER","0",148],";",["T_WHITESPACE"," ",148],["T_VARIABLE","$i",148],["T_WHITESPACE"," ",148],"<",["T_WHITESPACE"," ",148],["T_VARIABLE","$count",148],";",["T_WHITESPACE"," ",148],["T_VARIABLE","$i",148],["T_INC","++",148],")",["T_WHITESPACE","\n\t\t\t",148],"{",["T_WHITESPACE","\n\t\t\t\t",149],["T_VARIABLE","$key",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_STRING","trim",150],"(",["T_VARIABLE","$matches",150],"[",["T_LNUMBER","0",150],"]","[",["T_VARIABLE","$i",150],"]",",",["T_WHITESPACE"," ",150],["T_CONSTANT_ENCAPSED_STRING","'[]'",150],")",";",["T_WHITESPACE","\n\t\t\t\t",150],["T_IF","if",151],["T_WHITESPACE"," ",151],"(",["T_VARIABLE","$key",151],["T_WHITESPACE"," ",151],["T_IS_IDENTICAL","===",151],["T_WHITESPACE"," ",151],["T_CONSTANT_ENCAPSED_STRING","''",151],")",["T_WHITESPACE"," ",151],["T_COMMENT","\/\/ Empty notation will return the value as array\n",151],["T_WHITESPACE","\t\t\t\t",152],"{",["T_WHITESPACE","\n\t\t\t\t\t",152],["T_BREAK","break",153],";",["T_WHITESPACE","\n\t\t\t\t",153],"}",["T_WHITESPACE","\n\n\t\t\t\t",154],["T_IF","if",156],["T_WHITESPACE"," ",156],"(",["T_ISSET","isset",156],"(",["T_VARIABLE","$value",156],"[",["T_VARIABLE","$key",156],"]",")",")",["T_WHITESPACE","\n\t\t\t\t",156],"{",["T_WHITESPACE","\n\t\t\t\t\t",157],["T_VARIABLE","$value",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_VARIABLE","$value",158],"[",["T_VARIABLE","$key",158],"]",";",["T_WHITESPACE","\n\t\t\t\t",158],"}",["T_WHITESPACE","\n\t\t\t\t",159],["T_ELSE","else",160],["T_WHITESPACE","\n\t\t\t\t",160],"{",["T_WHITESPACE","\n\t\t\t\t\t",161],["T_RETURN","return",162],["T_WHITESPACE"," ",162],["T_STRING","NULL",162],";",["T_WHITESPACE","\n\t\t\t\t",162],"}",["T_WHITESPACE","\n\t\t\t",163],"}",["T_WHITESPACE","\n\t\t",164],"}",["T_WHITESPACE","\n\t\t",165],["T_ELSE","else",166],["T_WHITESPACE","\n\t\t",166],"{",["T_WHITESPACE","\n\t\t\t",167],["T_RETURN","return",168],["T_WHITESPACE"," ",168],["T_STRING","NULL",168],";",["T_WHITESPACE","\n\t\t",168],"}",["T_WHITESPACE","\n\n\t\t",169],["T_RETURN","return",171],["T_WHITESPACE"," ",171],"(",["T_VARIABLE","$xss_clean",171],["T_WHITESPACE"," ",171],["T_IS_IDENTICAL","===",171],["T_WHITESPACE"," ",171],["T_STRING","TRUE",171],")",["T_WHITESPACE","\n\t\t\t",171],"?",["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","security",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","xss_clean",172],"(",["T_VARIABLE","$value",172],")",["T_WHITESPACE","\n\t\t\t",172],":",["T_WHITESPACE"," ",173],["T_VARIABLE","$value",173],";",["T_WHITESPACE","\n\t",173],"}",["T_WHITESPACE","\n\n\t",174],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",176],["T_WHITESPACE","\n\t",177],["T_DOC_COMMENT","\/**\n\t * Fetch an item from the GET array\n\t *\n\t * @param\tmixed\t$index\t\tIndex for item to be fetched from $_GET\n\t * @param\tbool\t$xss_clean\tWhether to apply XSS filtering\n\t * @return\tmixed\n\t *\/",178],["T_WHITESPACE","\n\t",184],["T_PUBLIC","public",185],["T_WHITESPACE"," ",185],["T_FUNCTION","function",185],["T_WHITESPACE"," ",185],["T_STRING","get",185],"(",["T_VARIABLE","$index",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_STRING","NULL",185],",",["T_WHITESPACE"," ",185],["T_VARIABLE","$xss_clean",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_STRING","FALSE",185],")",["T_WHITESPACE","\n\t",185],"{",["T_WHITESPACE","\n\t\t",186],["T_RETURN","return",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","_fetch_from_array",187],"(",["T_VARIABLE","$_GET",187],",",["T_WHITESPACE"," ",187],["T_VARIABLE","$index",187],",",["T_WHITESPACE"," ",187],["T_VARIABLE","$xss_clean",187],")",";",["T_WHITESPACE","\n\t",187],"}",["T_WHITESPACE","\n\n\t",188],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",190],["T_WHITESPACE","\n\t",191],["T_DOC_COMMENT","\/**\n\t * Fetch an item from the POST array\n\t *\n\t * @param\tmixed\t$index\t\tIndex for item to be fetched from $_POST\n\t * @param\tbool\t$xss_clean\tWhether to apply XSS filtering\n\t * @return\tmixed\n\t *\/",192],["T_WHITESPACE","\n\t",198],["T_PUBLIC","public",199],["T_WHITESPACE"," ",199],["T_FUNCTION","function",199],["T_WHITESPACE"," ",199],["T_STRING","post",199],"(",["T_VARIABLE","$index",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_STRING","NULL",199],",",["T_WHITESPACE"," ",199],["T_VARIABLE","$xss_clean",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_STRING","FALSE",199],")",["T_WHITESPACE","\n\t",199],"{",["T_WHITESPACE","\n\t\t",200],["T_RETURN","return",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","_fetch_from_array",201],"(",["T_VARIABLE","$_POST",201],",",["T_WHITESPACE"," ",201],["T_VARIABLE","$index",201],",",["T_WHITESPACE"," ",201],["T_VARIABLE","$xss_clean",201],")",";",["T_WHITESPACE","\n\t",201],"}",["T_WHITESPACE","\n\n\t",202],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",204],["T_WHITESPACE","\n\t",205],["T_DOC_COMMENT","\/**\n\t * Fetch an item from POST data with fallback to GET\n\t *\n\t * @param\tstring\t$index\t\tIndex for item to be fetched from $_POST or $_GET\n\t * @param\tbool\t$xss_clean\tWhether to apply XSS filtering\n\t * @return\tmixed\n\t *\/",206],["T_WHITESPACE","\n\t",212],["T_PUBLIC","public",213],["T_WHITESPACE"," ",213],["T_FUNCTION","function",213],["T_WHITESPACE"," ",213],["T_STRING","post_get",213],"(",["T_VARIABLE","$index",213],",",["T_WHITESPACE"," ",213],["T_VARIABLE","$xss_clean",213],["T_WHITESPACE"," ",213],"=",["T_WHITESPACE"," ",213],["T_STRING","FALSE",213],")",["T_WHITESPACE","\n\t",213],"{",["T_WHITESPACE","\n\t\t",214],["T_RETURN","return",215],["T_WHITESPACE"," ",215],["T_ISSET","isset",215],"(",["T_VARIABLE","$_POST",215],"[",["T_VARIABLE","$index",215],"]",")",["T_WHITESPACE","\n\t\t\t",215],"?",["T_WHITESPACE"," ",216],["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","post",216],"(",["T_VARIABLE","$index",216],",",["T_WHITESPACE"," ",216],["T_VARIABLE","$xss_clean",216],")",["T_WHITESPACE","\n\t\t\t",216],":",["T_WHITESPACE"," ",217],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","get",217],"(",["T_VARIABLE","$index",217],",",["T_WHITESPACE"," ",217],["T_VARIABLE","$xss_clean",217],")",";",["T_WHITESPACE","\n\t",217],"}",["T_WHITESPACE","\n\n\t",218],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",220],["T_WHITESPACE","\n\t",221],["T_DOC_COMMENT","\/**\n\t * Fetch an item from GET data with fallback to POST\n\t *\n\t * @param\tstring\t$index\t\tIndex for item to be fetched from $_GET or $_POST\n\t * @param\tbool\t$xss_clean\tWhether to apply XSS filtering\n\t * @return\tmixed\n\t *\/",222],["T_WHITESPACE","\n\t",228],["T_PUBLIC","public",229],["T_WHITESPACE"," ",229],["T_FUNCTION","function",229],["T_WHITESPACE"," ",229],["T_STRING","get_post",229],"(",["T_VARIABLE","$index",229],",",["T_WHITESPACE"," ",229],["T_VARIABLE","$xss_clean",229],["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],["T_STRING","FALSE",229],")",["T_WHITESPACE","\n\t",229],"{",["T_WHITESPACE","\n\t\t",230],["T_RETURN","return",231],["T_WHITESPACE"," ",231],["T_ISSET","isset",231],"(",["T_VARIABLE","$_GET",231],"[",["T_VARIABLE","$index",231],"]",")",["T_WHITESPACE","\n\t\t\t",231],"?",["T_WHITESPACE"," ",232],["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","get",232],"(",["T_VARIABLE","$index",232],",",["T_WHITESPACE"," ",232],["T_VARIABLE","$xss_clean",232],")",["T_WHITESPACE","\n\t\t\t",232],":",["T_WHITESPACE"," ",233],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","post",233],"(",["T_VARIABLE","$index",233],",",["T_WHITESPACE"," ",233],["T_VARIABLE","$xss_clean",233],")",";",["T_WHITESPACE","\n\t",233],"}",["T_WHITESPACE","\n\n\t",234],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",236],["T_WHITESPACE","\n\t",237],["T_DOC_COMMENT","\/**\n\t * Fetch an item from the COOKIE array\n\t *\n\t * @param\tmixed\t$index\t\tIndex for item to be fetched from $_COOKIE\n\t * @param\tbool\t$xss_clean\tWhether to apply XSS filtering\n\t * @return\tmixed\n\t *\/",238],["T_WHITESPACE","\n\t",244],["T_PUBLIC","public",245],["T_WHITESPACE"," ",245],["T_FUNCTION","function",245],["T_WHITESPACE"," ",245],["T_STRING","cookie",245],"(",["T_VARIABLE","$index",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_STRING","NULL",245],",",["T_WHITESPACE"," ",245],["T_VARIABLE","$xss_clean",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_STRING","FALSE",245],")",["T_WHITESPACE","\n\t",245],"{",["T_WHITESPACE","\n\t\t",246],["T_RETURN","return",247],["T_WHITESPACE"," ",247],["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","_fetch_from_array",247],"(",["T_VARIABLE","$_COOKIE",247],",",["T_WHITESPACE"," ",247],["T_VARIABLE","$index",247],",",["T_WHITESPACE"," ",247],["T_VARIABLE","$xss_clean",247],")",";",["T_WHITESPACE","\n\t",247],"}",["T_WHITESPACE","\n\n\t",248],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",250],["T_WHITESPACE","\n\t",251],["T_DOC_COMMENT","\/**\n\t * Fetch an item from the SERVER array\n\t *\n\t * @param\tmixed\t$index\t\tIndex for item to be fetched from $_SERVER\n\t * @param\tbool\t$xss_clean\tWhether to apply XSS filtering\n\t * @return\tmixed\n\t *\/",252],["T_WHITESPACE","\n\t",258],["T_PUBLIC","public",259],["T_WHITESPACE"," ",259],["T_FUNCTION","function",259],["T_WHITESPACE"," ",259],["T_STRING","server",259],"(",["T_VARIABLE","$index",259],",",["T_WHITESPACE"," ",259],["T_VARIABLE","$xss_clean",259],["T_WHITESPACE"," ",259],"=",["T_WHITESPACE"," ",259],["T_STRING","FALSE",259],")",["T_WHITESPACE","\n\t",259],"{",["T_WHITESPACE","\n\t\t",260],["T_RETURN","return",261],["T_WHITESPACE"," ",261],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","_fetch_from_array",261],"(",["T_VARIABLE","$_SERVER",261],",",["T_WHITESPACE"," ",261],["T_VARIABLE","$index",261],",",["T_WHITESPACE"," ",261],["T_VARIABLE","$xss_clean",261],")",";",["T_WHITESPACE","\n\t",261],"}",["T_WHITESPACE","\n\n\t",262],["T_COMMENT","\/\/ ------------------------------------------------------------------------\n",264],["T_WHITESPACE","\n\t",265],["T_DOC_COMMENT","\/**\n\t * Fetch an item from the php:\/\/input stream\n\t *\n\t * Useful when you need to access PUT, DELETE or PATCH request data.\n\t *\n\t * @param\tstring\t$index\t\tIndex for item to be fetched\n\t * @param\tbool\t$xss_clean\tWhether to apply XSS filtering\n\t * @return\tmixed\n\t *\/",266],["T_WHITESPACE","\n\t",274],["T_PUBLIC","public",275],["T_WHITESPACE"," ",275],["T_FUNCTION","function",275],["T_WHITESPACE"," ",275],["T_STRING","input_stream",275],"(",["T_VARIABLE","$index",275],["T_WHITESPACE"," ",275],"=",["T_WHITESPACE"," ",275],["T_STRING","NULL",275],",",["T_WHITESPACE"," ",275],["T_VARIABLE","$xss_clean",275],["T_WHITESPACE"," ",275],"=",["T_WHITESPACE"," ",275],["T_STRING","FALSE",275],")",["T_WHITESPACE","\n\t",275],"{",["T_WHITESPACE","\n\t\t",276],["T_COMMENT","\/\/ Prior to PHP 5.6, the input stream can only be read once,\n",277],["T_WHITESPACE","\t\t",278],["T_COMMENT","\/\/ so we'll need to check if we have already done that first.\n",278],["T_WHITESPACE","\t\t",279],["T_IF","if",279],["T_WHITESPACE"," ",279],"(",["T_WHITESPACE"," ",279],"!",["T_WHITESPACE"," ",279],["T_STRING","is_array",279],"(",["T_VARIABLE","$this",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","_input_stream",279],")",")",["T_WHITESPACE","\n\t\t",279],"{",["T_WHITESPACE","\n\t\t\t",280],["T_COMMENT","\/\/ $this->raw_input_stream will trigger __get().\n",281],["T_WHITESPACE","\t\t\t",282],["T_STRING","parse_str",282],"(",["T_VARIABLE","$this",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","raw_input_stream",282],",",["T_WHITESPACE"," ",282],["T_VARIABLE","$this",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","_input_stream",282],")",";",["T_WHITESPACE","\n\t\t\t",282],["T_STRING","is_array",283],"(",["T_VARIABLE","$this",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","_input_stream",283],")",["T_WHITESPACE"," ",283],["T_LOGICAL_OR","OR",283],["T_WHITESPACE"," ",283],["T_VARIABLE","$this",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","_input_stream",283],["T_WHITESPACE"," ",283],"=",["T_WHITESPACE"," ",283],["T_ARRAY","array",283],"(",")",";",["T_WHITESPACE","\n\t\t",283],"}",["T_WHITESPACE","\n\n\t\t",284],["T_RETURN","return",286],["T_WHITESPACE"," ",286],["T_VARIABLE","$this",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","_fetch_from_array",286],"(",["T_VARIABLE","$this",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","_input_stream",286],",",["T_WHITESPACE"," ",286],["T_VARIABLE","$index",286],",",["T_WHITESPACE"," ",286],["T_VARIABLE","$xss_clean",286],")",";",["T_WHITESPACE","\n\t",286],"}",["T_WHITESPACE","\n\n\t",287],["T_COMMENT","\/\/ ------------------------------------------------------------------------\n",289],["T_WHITESPACE","\n\t",290],["T_DOC_COMMENT","\/**\n\t * Set cookie\n\t *\n\t * Accepts an arbitrary number of parameters (up to 7) or an associative\n\t * array in the first parameter containing all the values.\n\t *\n\t * @param\tstring|mixed[]\t$name\t\tCookie name or an array containing parameters\n\t * @param\tstring\t\t$value\t\tCookie value\n\t * @param\tint\t\t$expire\t\tCookie expiration time in seconds\n\t * @param\tstring\t\t$domain\t\tCookie domain (e.g.: '.yourdomain.com')\n\t * @param\tstring\t\t$path\t\tCookie path (default: '\/')\n\t * @param\tstring\t\t$prefix\t\tCookie name prefix\n\t * @param\tbool\t\t$secure\t\tWhether to only transfer cookies via SSL\n\t * @param\tbool\t\t$httponly\tWhether to only makes the cookie accessible via HTTP (no javascript)\n\t * @return\tvoid\n\t *\/",291],["T_WHITESPACE","\n\t",306],["T_PUBLIC","public",307],["T_WHITESPACE"," ",307],["T_FUNCTION","function",307],["T_WHITESPACE"," ",307],["T_STRING","set_cookie",307],"(",["T_VARIABLE","$name",307],",",["T_WHITESPACE"," ",307],["T_VARIABLE","$value",307],["T_WHITESPACE"," ",307],"=",["T_WHITESPACE"," ",307],["T_CONSTANT_ENCAPSED_STRING","''",307],",",["T_WHITESPACE"," ",307],["T_VARIABLE","$expire",307],["T_WHITESPACE"," ",307],"=",["T_WHITESPACE"," ",307],["T_LNUMBER","0",307],",",["T_WHITESPACE"," ",307],["T_VARIABLE","$domain",307],["T_WHITESPACE"," ",307],"=",["T_WHITESPACE"," ",307],["T_CONSTANT_ENCAPSED_STRING","''",307],",",["T_WHITESPACE"," ",307],["T_VARIABLE","$path",307],["T_WHITESPACE"," ",307],"=",["T_WHITESPACE"," ",307],["T_CONSTANT_ENCAPSED_STRING","'\/'",307],",",["T_WHITESPACE"," ",307],["T_VARIABLE","$prefix",307],["T_WHITESPACE"," ",307],"=",["T_WHITESPACE"," ",307],["T_CONSTANT_ENCAPSED_STRING","''",307],",",["T_WHITESPACE"," ",307],["T_VARIABLE","$secure",307],["T_WHITESPACE"," ",307],"=",["T_WHITESPACE"," ",307],["T_STRING","FALSE",307],",",["T_WHITESPACE"," ",307],["T_VARIABLE","$httponly",307],["T_WHITESPACE"," ",307],"=",["T_WHITESPACE"," ",307],["T_STRING","FALSE",307],")",["T_WHITESPACE","\n\t",307],"{",["T_WHITESPACE","\n\t\t",308],["T_IF","if",309],["T_WHITESPACE"," ",309],"(",["T_STRING","is_array",309],"(",["T_VARIABLE","$name",309],")",")",["T_WHITESPACE","\n\t\t",309],"{",["T_WHITESPACE","\n\t\t\t",310],["T_COMMENT","\/\/ always leave 'name' in last place, as the loop will break otherwise, due to $$item\n",311],["T_WHITESPACE","\t\t\t",312],["T_FOREACH","foreach",312],["T_WHITESPACE"," ",312],"(",["T_ARRAY","array",312],"(",["T_CONSTANT_ENCAPSED_STRING","'value'",312],",",["T_WHITESPACE"," ",312],["T_CONSTANT_ENCAPSED_STRING","'expire'",312],",",["T_WHITESPACE"," ",312],["T_CONSTANT_ENCAPSED_STRING","'domain'",312],",",["T_WHITESPACE"," ",312],["T_CONSTANT_ENCAPSED_STRING","'path'",312],",",["T_WHITESPACE"," ",312],["T_CONSTANT_ENCAPSED_STRING","'prefix'",312],",",["T_WHITESPACE"," ",312],["T_CONSTANT_ENCAPSED_STRING","'secure'",312],",",["T_WHITESPACE"," ",312],["T_CONSTANT_ENCAPSED_STRING","'httponly'",312],",",["T_WHITESPACE"," ",312],["T_CONSTANT_ENCAPSED_STRING","'name'",312],")",["T_WHITESPACE"," ",312],["T_AS","as",312],["T_WHITESPACE"," ",312],["T_VARIABLE","$item",312],")",["T_WHITESPACE","\n\t\t\t",312],"{",["T_WHITESPACE","\n\t\t\t\t",313],["T_IF","if",314],["T_WHITESPACE"," ",314],"(",["T_ISSET","isset",314],"(",["T_VARIABLE","$name",314],"[",["T_VARIABLE","$item",314],"]",")",")",["T_WHITESPACE","\n\t\t\t\t",314],"{",["T_WHITESPACE","\n\t\t\t\t\t",315],"$",["T_VARIABLE","$item",316],["T_WHITESPACE"," ",316],"=",["T_WHITESPACE"," ",316],["T_VARIABLE","$name",316],"[",["T_VARIABLE","$item",316],"]",";",["T_WHITESPACE","\n\t\t\t\t",316],"}",["T_WHITESPACE","\n\t\t\t",317],"}",["T_WHITESPACE","\n\t\t",318],"}",["T_WHITESPACE","\n\n\t\t",319],["T_IF","if",321],["T_WHITESPACE"," ",321],"(",["T_VARIABLE","$prefix",321],["T_WHITESPACE"," ",321],["T_IS_IDENTICAL","===",321],["T_WHITESPACE"," ",321],["T_CONSTANT_ENCAPSED_STRING","''",321],["T_WHITESPACE"," ",321],["T_BOOLEAN_AND","&&",321],["T_WHITESPACE"," ",321],["T_STRING","config_item",321],"(",["T_CONSTANT_ENCAPSED_STRING","'cookie_prefix'",321],")",["T_WHITESPACE"," ",321],["T_IS_NOT_IDENTICAL","!==",321],["T_WHITESPACE"," ",321],["T_CONSTANT_ENCAPSED_STRING","''",321],")",["T_WHITESPACE","\n\t\t",321],"{",["T_WHITESPACE","\n\t\t\t",322],["T_VARIABLE","$prefix",323],["T_WHITESPACE"," ",323],"=",["T_WHITESPACE"," ",323],["T_STRING","config_item",323],"(",["T_CONSTANT_ENCAPSED_STRING","'cookie_prefix'",323],")",";",["T_WHITESPACE","\n\t\t",323],"}",["T_WHITESPACE","\n\n\t\t",324],["T_IF","if",326],["T_WHITESPACE"," ",326],"(",["T_VARIABLE","$domain",326],["T_WHITESPACE"," ",326],["T_IS_EQUAL","==",326],["T_WHITESPACE"," ",326],["T_CONSTANT_ENCAPSED_STRING","''",326],["T_WHITESPACE"," ",326],["T_BOOLEAN_AND","&&",326],["T_WHITESPACE"," ",326],["T_STRING","config_item",326],"(",["T_CONSTANT_ENCAPSED_STRING","'cookie_domain'",326],")",["T_WHITESPACE"," ",326],["T_IS_NOT_EQUAL","!=",326],["T_WHITESPACE"," ",326],["T_CONSTANT_ENCAPSED_STRING","''",326],")",["T_WHITESPACE","\n\t\t",326],"{",["T_WHITESPACE","\n\t\t\t",327],["T_VARIABLE","$domain",328],["T_WHITESPACE"," ",328],"=",["T_WHITESPACE"," ",328],["T_STRING","config_item",328],"(",["T_CONSTANT_ENCAPSED_STRING","'cookie_domain'",328],")",";",["T_WHITESPACE","\n\t\t",328],"}",["T_WHITESPACE","\n\n\t\t",329],["T_IF","if",331],["T_WHITESPACE"," ",331],"(",["T_VARIABLE","$path",331],["T_WHITESPACE"," ",331],["T_IS_IDENTICAL","===",331],["T_WHITESPACE"," ",331],["T_CONSTANT_ENCAPSED_STRING","'\/'",331],["T_WHITESPACE"," ",331],["T_BOOLEAN_AND","&&",331],["T_WHITESPACE"," ",331],["T_STRING","config_item",331],"(",["T_CONSTANT_ENCAPSED_STRING","'cookie_path'",331],")",["T_WHITESPACE"," ",331],["T_IS_NOT_IDENTICAL","!==",331],["T_WHITESPACE"," ",331],["T_CONSTANT_ENCAPSED_STRING","'\/'",331],")",["T_WHITESPACE","\n\t\t",331],"{",["T_WHITESPACE","\n\t\t\t",332],["T_VARIABLE","$path",333],["T_WHITESPACE"," ",333],"=",["T_WHITESPACE"," ",333],["T_STRING","config_item",333],"(",["T_CONSTANT_ENCAPSED_STRING","'cookie_path'",333],")",";",["T_WHITESPACE","\n\t\t",333],"}",["T_WHITESPACE","\n\n\t\t",334],["T_IF","if",336],["T_WHITESPACE"," ",336],"(",["T_VARIABLE","$secure",336],["T_WHITESPACE"," ",336],["T_IS_IDENTICAL","===",336],["T_WHITESPACE"," ",336],["T_STRING","FALSE",336],["T_WHITESPACE"," ",336],["T_BOOLEAN_AND","&&",336],["T_WHITESPACE"," ",336],["T_STRING","config_item",336],"(",["T_CONSTANT_ENCAPSED_STRING","'cookie_secure'",336],")",["T_WHITESPACE"," ",336],["T_IS_IDENTICAL","===",336],["T_WHITESPACE"," ",336],["T_STRING","TRUE",336],")",["T_WHITESPACE","\n\t\t",336],"{",["T_WHITESPACE","\n\t\t\t",337],["T_VARIABLE","$secure",338],["T_WHITESPACE"," ",338],"=",["T_WHITESPACE"," ",338],["T_STRING","config_item",338],"(",["T_CONSTANT_ENCAPSED_STRING","'cookie_secure'",338],")",";",["T_WHITESPACE","\n\t\t",338],"}",["T_WHITESPACE","\n\n\t\t",339],["T_IF","if",341],["T_WHITESPACE"," ",341],"(",["T_VARIABLE","$httponly",341],["T_WHITESPACE"," ",341],["T_IS_IDENTICAL","===",341],["T_WHITESPACE"," ",341],["T_STRING","FALSE",341],["T_WHITESPACE"," ",341],["T_BOOLEAN_AND","&&",341],["T_WHITESPACE"," ",341],["T_STRING","config_item",341],"(",["T_CONSTANT_ENCAPSED_STRING","'cookie_httponly'",341],")",["T_WHITESPACE"," ",341],["T_IS_NOT_IDENTICAL","!==",341],["T_WHITESPACE"," ",341],["T_STRING","FALSE",341],")",["T_WHITESPACE","\n\t\t",341],"{",["T_WHITESPACE","\n\t\t\t",342],["T_VARIABLE","$httponly",343],["T_WHITESPACE"," ",343],"=",["T_WHITESPACE"," ",343],["T_STRING","config_item",343],"(",["T_CONSTANT_ENCAPSED_STRING","'cookie_httponly'",343],")",";",["T_WHITESPACE","\n\t\t",343],"}",["T_WHITESPACE","\n\n\t\t",344],["T_IF","if",346],["T_WHITESPACE"," ",346],"(",["T_WHITESPACE"," ",346],"!",["T_WHITESPACE"," ",346],["T_STRING","is_numeric",346],"(",["T_VARIABLE","$expire",346],")",["T_WHITESPACE"," ",346],["T_LOGICAL_OR","OR",346],["T_WHITESPACE"," ",346],["T_VARIABLE","$expire",346],["T_WHITESPACE"," ",346],"<",["T_WHITESPACE"," ",346],["T_LNUMBER","0",346],")",["T_WHITESPACE","\n\t\t",346],"{",["T_WHITESPACE","\n\t\t\t",347],["T_VARIABLE","$expire",348],["T_WHITESPACE"," ",348],"=",["T_WHITESPACE"," ",348],["T_LNUMBER","1",348],";",["T_WHITESPACE","\n\t\t",348],"}",["T_WHITESPACE","\n\t\t",349],["T_ELSE","else",350],["T_WHITESPACE","\n\t\t",350],"{",["T_WHITESPACE","\n\t\t\t",351],["T_VARIABLE","$expire",352],["T_WHITESPACE"," ",352],"=",["T_WHITESPACE"," ",352],"(",["T_VARIABLE","$expire",352],["T_WHITESPACE"," ",352],">",["T_WHITESPACE"," ",352],["T_LNUMBER","0",352],")",["T_WHITESPACE"," ",352],"?",["T_WHITESPACE"," ",352],["T_STRING","time",352],"(",")",["T_WHITESPACE"," ",352],"+",["T_WHITESPACE"," ",352],["T_VARIABLE","$expire",352],["T_WHITESPACE"," ",352],":",["T_WHITESPACE"," ",352],["T_LNUMBER","0",352],";",["T_WHITESPACE","\n\t\t",352],"}",["T_WHITESPACE","\n\n\t\t",353],["T_STRING","setcookie",355],"(",["T_VARIABLE","$prefix",355],".",["T_VARIABLE","$name",355],",",["T_WHITESPACE"," ",355],["T_VARIABLE","$value",355],",",["T_WHITESPACE"," ",355],["T_VARIABLE","$expire",355],",",["T_WHITESPACE"," ",355],["T_VARIABLE","$path",355],",",["T_WHITESPACE"," ",355],["T_VARIABLE","$domain",355],",",["T_WHITESPACE"," ",355],["T_VARIABLE","$secure",355],",",["T_WHITESPACE"," ",355],["T_VARIABLE","$httponly",355],")",";",["T_WHITESPACE","\n\t",355],"}",["T_WHITESPACE","\n\n\t",356],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",358],["T_WHITESPACE","\n\t",359],["T_DOC_COMMENT","\/**\n\t * Fetch the IP Address\n\t *\n\t * Determines and validates the visitor's IP address.\n\t *\n\t * @return\tstring\tIP address\n\t *\/",360],["T_WHITESPACE","\n\t",366],["T_PUBLIC","public",367],["T_WHITESPACE"," ",367],["T_FUNCTION","function",367],["T_WHITESPACE"," ",367],["T_STRING","ip_address",367],"(",")",["T_WHITESPACE","\n\t",367],"{",["T_WHITESPACE","\n\t\t",368],["T_IF","if",369],["T_WHITESPACE"," ",369],"(",["T_VARIABLE","$this",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","ip_address",369],["T_WHITESPACE"," ",369],["T_IS_NOT_IDENTICAL","!==",369],["T_WHITESPACE"," ",369],["T_STRING","FALSE",369],")",["T_WHITESPACE","\n\t\t",369],"{",["T_WHITESPACE","\n\t\t\t",370],["T_RETURN","return",371],["T_WHITESPACE"," ",371],["T_VARIABLE","$this",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","ip_address",371],";",["T_WHITESPACE","\n\t\t",371],"}",["T_WHITESPACE","\n\n\t\t",372],["T_VARIABLE","$proxy_ips",374],["T_WHITESPACE"," ",374],"=",["T_WHITESPACE"," ",374],["T_STRING","config_item",374],"(",["T_CONSTANT_ENCAPSED_STRING","'proxy_ips'",374],")",";",["T_WHITESPACE","\n\t\t",374],["T_IF","if",375],["T_WHITESPACE"," ",375],"(",["T_WHITESPACE"," ",375],"!",["T_WHITESPACE"," ",375],["T_EMPTY","empty",375],"(",["T_VARIABLE","$proxy_ips",375],")",["T_WHITESPACE"," ",375],["T_BOOLEAN_AND","&&",375],["T_WHITESPACE"," ",375],"!",["T_WHITESPACE"," ",375],["T_STRING","is_array",375],"(",["T_VARIABLE","$proxy_ips",375],")",")",["T_WHITESPACE","\n\t\t",375],"{",["T_WHITESPACE","\n\t\t\t",376],["T_VARIABLE","$proxy_ips",377],["T_WHITESPACE"," ",377],"=",["T_WHITESPACE"," ",377],["T_STRING","explode",377],"(",["T_CONSTANT_ENCAPSED_STRING","','",377],",",["T_WHITESPACE"," ",377],["T_STRING","str_replace",377],"(",["T_CONSTANT_ENCAPSED_STRING","' '",377],",",["T_WHITESPACE"," ",377],["T_CONSTANT_ENCAPSED_STRING","''",377],",",["T_WHITESPACE"," ",377],["T_VARIABLE","$proxy_ips",377],")",")",";",["T_WHITESPACE","\n\t\t",377],"}",["T_WHITESPACE","\n\n\t\t",378],["T_VARIABLE","$this",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","ip_address",380],["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],["T_VARIABLE","$this",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","server",380],"(",["T_CONSTANT_ENCAPSED_STRING","'REMOTE_ADDR'",380],")",";",["T_WHITESPACE","\n\n\t\t",380],["T_IF","if",382],["T_WHITESPACE"," ",382],"(",["T_VARIABLE","$proxy_ips",382],")",["T_WHITESPACE","\n\t\t",382],"{",["T_WHITESPACE","\n\t\t\t",383],["T_FOREACH","foreach",384],["T_WHITESPACE"," ",384],"(",["T_ARRAY","array",384],"(",["T_CONSTANT_ENCAPSED_STRING","'HTTP_X_FORWARDED_FOR'",384],",",["T_WHITESPACE"," ",384],["T_CONSTANT_ENCAPSED_STRING","'HTTP_CLIENT_IP'",384],",",["T_WHITESPACE"," ",384],["T_CONSTANT_ENCAPSED_STRING","'HTTP_X_CLIENT_IP'",384],",",["T_WHITESPACE"," ",384],["T_CONSTANT_ENCAPSED_STRING","'HTTP_X_CLUSTER_CLIENT_IP'",384],")",["T_WHITESPACE"," ",384],["T_AS","as",384],["T_WHITESPACE"," ",384],["T_VARIABLE","$header",384],")",["T_WHITESPACE","\n\t\t\t",384],"{",["T_WHITESPACE","\n\t\t\t\t",385],["T_IF","if",386],["T_WHITESPACE"," ",386],"(","(",["T_VARIABLE","$spoof",386],["T_WHITESPACE"," ",386],"=",["T_WHITESPACE"," ",386],["T_VARIABLE","$this",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","server",386],"(",["T_VARIABLE","$header",386],")",")",["T_WHITESPACE"," ",386],["T_IS_NOT_IDENTICAL","!==",386],["T_WHITESPACE"," ",386],["T_STRING","NULL",386],")",["T_WHITESPACE","\n\t\t\t\t",386],"{",["T_WHITESPACE","\n\t\t\t\t\t",387],["T_COMMENT","\/\/ Some proxies typically list the whole chain of IP\n",388],["T_WHITESPACE","\t\t\t\t\t",389],["T_COMMENT","\/\/ addresses through which the client has reached us.\n",389],["T_WHITESPACE","\t\t\t\t\t",390],["T_COMMENT","\/\/ e.g. client_ip, proxy_ip1, proxy_ip2, etc.\n",390],["T_WHITESPACE","\t\t\t\t\t",391],["T_STRING","sscanf",391],"(",["T_VARIABLE","$spoof",391],",",["T_WHITESPACE"," ",391],["T_CONSTANT_ENCAPSED_STRING","'%[^,]'",391],",",["T_WHITESPACE"," ",391],["T_VARIABLE","$spoof",391],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",391],["T_IF","if",393],["T_WHITESPACE"," ",393],"(",["T_WHITESPACE"," ",393],"!",["T_WHITESPACE"," ",393],["T_VARIABLE","$this",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","valid_ip",393],"(",["T_VARIABLE","$spoof",393],")",")",["T_WHITESPACE","\n\t\t\t\t\t",393],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",394],["T_VARIABLE","$spoof",395],["T_WHITESPACE"," ",395],"=",["T_WHITESPACE"," ",395],["T_STRING","NULL",395],";",["T_WHITESPACE","\n\t\t\t\t\t",395],"}",["T_WHITESPACE","\n\t\t\t\t\t",396],["T_ELSE","else",397],["T_WHITESPACE","\n\t\t\t\t\t",397],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",398],["T_BREAK","break",399],";",["T_WHITESPACE","\n\t\t\t\t\t",399],"}",["T_WHITESPACE","\n\t\t\t\t",400],"}",["T_WHITESPACE","\n\t\t\t",401],"}",["T_WHITESPACE","\n\n\t\t\t",402],["T_IF","if",404],["T_WHITESPACE"," ",404],"(",["T_VARIABLE","$spoof",404],")",["T_WHITESPACE","\n\t\t\t",404],"{",["T_WHITESPACE","\n\t\t\t\t",405],["T_FOR","for",406],["T_WHITESPACE"," ",406],"(",["T_VARIABLE","$i",406],["T_WHITESPACE"," ",406],"=",["T_WHITESPACE"," ",406],["T_LNUMBER","0",406],",",["T_WHITESPACE"," ",406],["T_VARIABLE","$c",406],["T_WHITESPACE"," ",406],"=",["T_WHITESPACE"," ",406],["T_STRING","count",406],"(",["T_VARIABLE","$proxy_ips",406],")",";",["T_WHITESPACE"," ",406],["T_VARIABLE","$i",406],["T_WHITESPACE"," ",406],"<",["T_WHITESPACE"," ",406],["T_VARIABLE","$c",406],";",["T_WHITESPACE"," ",406],["T_VARIABLE","$i",406],["T_INC","++",406],")",["T_WHITESPACE","\n\t\t\t\t",406],"{",["T_WHITESPACE","\n\t\t\t\t\t",407],["T_COMMENT","\/\/ Check if we have an IP address or a subnet\n",408],["T_WHITESPACE","\t\t\t\t\t",409],["T_IF","if",409],["T_WHITESPACE"," ",409],"(",["T_STRING","strpos",409],"(",["T_VARIABLE","$proxy_ips",409],"[",["T_VARIABLE","$i",409],"]",",",["T_WHITESPACE"," ",409],["T_CONSTANT_ENCAPSED_STRING","'\/'",409],")",["T_WHITESPACE"," ",409],["T_IS_IDENTICAL","===",409],["T_WHITESPACE"," ",409],["T_STRING","FALSE",409],")",["T_WHITESPACE","\n\t\t\t\t\t",409],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",410],["T_COMMENT","\/\/ An IP address (and not a subnet) is specified.\n",411],["T_WHITESPACE","\t\t\t\t\t\t",412],["T_COMMENT","\/\/ We can compare right away.\n",412],["T_WHITESPACE","\t\t\t\t\t\t",413],["T_IF","if",413],["T_WHITESPACE"," ",413],"(",["T_VARIABLE","$proxy_ips",413],"[",["T_VARIABLE","$i",413],"]",["T_WHITESPACE"," ",413],["T_IS_IDENTICAL","===",413],["T_WHITESPACE"," ",413],["T_VARIABLE","$this",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","ip_address",413],")",["T_WHITESPACE","\n\t\t\t\t\t\t",413],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",414],["T_VARIABLE","$this",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","ip_address",415],["T_WHITESPACE"," ",415],"=",["T_WHITESPACE"," ",415],["T_VARIABLE","$spoof",415],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",415],["T_BREAK","break",416],";",["T_WHITESPACE","\n\t\t\t\t\t\t",416],"}",["T_WHITESPACE","\n\n\t\t\t\t\t\t",417],["T_CONTINUE","continue",419],";",["T_WHITESPACE","\n\t\t\t\t\t",419],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",420],["T_COMMENT","\/\/ We have a subnet ... now the heavy lifting begins\n",422],["T_WHITESPACE","\t\t\t\t\t",423],["T_ISSET","isset",423],"(",["T_VARIABLE","$separator",423],")",["T_WHITESPACE"," ",423],["T_LOGICAL_OR","OR",423],["T_WHITESPACE"," ",423],["T_VARIABLE","$separator",423],["T_WHITESPACE"," ",423],"=",["T_WHITESPACE"," ",423],["T_VARIABLE","$this",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","valid_ip",423],"(",["T_VARIABLE","$this",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","ip_address",423],",",["T_WHITESPACE"," ",423],["T_CONSTANT_ENCAPSED_STRING","'ipv6'",423],")",["T_WHITESPACE"," ",423],"?",["T_WHITESPACE"," ",423],["T_CONSTANT_ENCAPSED_STRING","':'",423],["T_WHITESPACE"," ",423],":",["T_WHITESPACE"," ",423],["T_CONSTANT_ENCAPSED_STRING","'.'",423],";",["T_WHITESPACE","\n\n\t\t\t\t\t",423],["T_COMMENT","\/\/ If the proxy entry doesn't match the IP protocol - skip it\n",425],["T_WHITESPACE","\t\t\t\t\t",426],["T_IF","if",426],["T_WHITESPACE"," ",426],"(",["T_STRING","strpos",426],"(",["T_VARIABLE","$proxy_ips",426],"[",["T_VARIABLE","$i",426],"]",",",["T_WHITESPACE"," ",426],["T_VARIABLE","$separator",426],")",["T_WHITESPACE"," ",426],["T_IS_IDENTICAL","===",426],["T_WHITESPACE"," ",426],["T_STRING","FALSE",426],")",["T_WHITESPACE","\n\t\t\t\t\t",426],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",427],["T_CONTINUE","continue",428],";",["T_WHITESPACE","\n\t\t\t\t\t",428],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",429],["T_COMMENT","\/\/ Convert the REMOTE_ADDR IP address to binary, if needed\n",431],["T_WHITESPACE","\t\t\t\t\t",432],["T_IF","if",432],["T_WHITESPACE"," ",432],"(",["T_WHITESPACE"," ",432],"!",["T_WHITESPACE"," ",432],["T_ISSET","isset",432],"(",["T_VARIABLE","$ip",432],",",["T_WHITESPACE"," ",432],["T_VARIABLE","$sprintf",432],")",")",["T_WHITESPACE","\n\t\t\t\t\t",432],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",433],["T_IF","if",434],["T_WHITESPACE"," ",434],"(",["T_VARIABLE","$separator",434],["T_WHITESPACE"," ",434],["T_IS_IDENTICAL","===",434],["T_WHITESPACE"," ",434],["T_CONSTANT_ENCAPSED_STRING","':'",434],")",["T_WHITESPACE","\n\t\t\t\t\t\t",434],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",435],["T_COMMENT","\/\/ Make sure we're have the \"full\" IPv6 format\n",436],["T_WHITESPACE","\t\t\t\t\t\t\t",437],["T_VARIABLE","$ip",437],["T_WHITESPACE"," ",437],"=",["T_WHITESPACE"," ",437],["T_STRING","explode",437],"(",["T_CONSTANT_ENCAPSED_STRING","':'",437],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",437],["T_STRING","str_replace",438],"(",["T_CONSTANT_ENCAPSED_STRING","'::'",438],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",438],["T_STRING","str_repeat",439],"(",["T_CONSTANT_ENCAPSED_STRING","':'",439],",",["T_WHITESPACE"," ",439],["T_LNUMBER","9",439],["T_WHITESPACE"," ",439],"-",["T_WHITESPACE"," ",439],["T_STRING","substr_count",439],"(",["T_VARIABLE","$this",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","ip_address",439],",",["T_WHITESPACE"," ",439],["T_CONSTANT_ENCAPSED_STRING","':'",439],")",")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",439],["T_VARIABLE","$this",440],["T_OBJECT_OPERATOR","->",440],["T_STRING","ip_address",440],["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",440],")",["T_WHITESPACE","\n\t\t\t\t\t\t\t",441],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t",442],["T_FOR","for",444],["T_WHITESPACE"," ",444],"(",["T_VARIABLE","$j",444],["T_WHITESPACE"," ",444],"=",["T_WHITESPACE"," ",444],["T_LNUMBER","0",444],";",["T_WHITESPACE"," ",444],["T_VARIABLE","$j",444],["T_WHITESPACE"," ",444],"<",["T_WHITESPACE"," ",444],["T_LNUMBER","8",444],";",["T_WHITESPACE"," ",444],["T_VARIABLE","$j",444],["T_INC","++",444],")",["T_WHITESPACE","\n\t\t\t\t\t\t\t",444],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",445],["T_VARIABLE","$ip",446],"[",["T_VARIABLE","$j",446],"]",["T_WHITESPACE"," ",446],"=",["T_WHITESPACE"," ",446],["T_STRING","intval",446],"(",["T_VARIABLE","$ip",446],"[",["T_VARIABLE","$j",446],"]",",",["T_WHITESPACE"," ",446],["T_LNUMBER","16",446],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",446],"}",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t",447],["T_VARIABLE","$sprintf",449],["T_WHITESPACE"," ",449],"=",["T_WHITESPACE"," ",449],["T_CONSTANT_ENCAPSED_STRING","'%016b%016b%016b%016b%016b%016b%016b%016b'",449],";",["T_WHITESPACE","\n\t\t\t\t\t\t",449],"}",["T_WHITESPACE","\n\t\t\t\t\t\t",450],["T_ELSE","else",451],["T_WHITESPACE","\n\t\t\t\t\t\t",451],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",452],["T_VARIABLE","$ip",453],["T_WHITESPACE"," ",453],"=",["T_WHITESPACE"," ",453],["T_STRING","explode",453],"(",["T_CONSTANT_ENCAPSED_STRING","'.'",453],",",["T_WHITESPACE"," ",453],["T_VARIABLE","$this",453],["T_OBJECT_OPERATOR","->",453],["T_STRING","ip_address",453],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",453],["T_VARIABLE","$sprintf",454],["T_WHITESPACE"," ",454],"=",["T_WHITESPACE"," ",454],["T_CONSTANT_ENCAPSED_STRING","'%08b%08b%08b%08b'",454],";",["T_WHITESPACE","\n\t\t\t\t\t\t",454],"}",["T_WHITESPACE","\n\n\t\t\t\t\t\t",455],["T_VARIABLE","$ip",457],["T_WHITESPACE"," ",457],"=",["T_WHITESPACE"," ",457],["T_STRING","vsprintf",457],"(",["T_VARIABLE","$sprintf",457],",",["T_WHITESPACE"," ",457],["T_VARIABLE","$ip",457],")",";",["T_WHITESPACE","\n\t\t\t\t\t",457],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",458],["T_COMMENT","\/\/ Split the netmask length off the network address\n",460],["T_WHITESPACE","\t\t\t\t\t",461],["T_STRING","sscanf",461],"(",["T_VARIABLE","$proxy_ips",461],"[",["T_VARIABLE","$i",461],"]",",",["T_WHITESPACE"," ",461],["T_CONSTANT_ENCAPSED_STRING","'%[^\/]\/%d'",461],",",["T_WHITESPACE"," ",461],["T_VARIABLE","$netaddr",461],",",["T_WHITESPACE"," ",461],["T_VARIABLE","$masklen",461],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",461],["T_COMMENT","\/\/ Again, an IPv6 address is most likely in a compressed form\n",463],["T_WHITESPACE","\t\t\t\t\t",464],["T_IF","if",464],["T_WHITESPACE"," ",464],"(",["T_VARIABLE","$separator",464],["T_WHITESPACE"," ",464],["T_IS_IDENTICAL","===",464],["T_WHITESPACE"," ",464],["T_CONSTANT_ENCAPSED_STRING","':'",464],")",["T_WHITESPACE","\n\t\t\t\t\t",464],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",465],["T_VARIABLE","$netaddr",466],["T_WHITESPACE"," ",466],"=",["T_WHITESPACE"," ",466],["T_STRING","explode",466],"(",["T_CONSTANT_ENCAPSED_STRING","':'",466],",",["T_WHITESPACE"," ",466],["T_STRING","str_replace",466],"(",["T_CONSTANT_ENCAPSED_STRING","'::'",466],",",["T_WHITESPACE"," ",466],["T_STRING","str_repeat",466],"(",["T_CONSTANT_ENCAPSED_STRING","':'",466],",",["T_WHITESPACE"," ",466],["T_LNUMBER","9",466],["T_WHITESPACE"," ",466],"-",["T_WHITESPACE"," ",466],["T_STRING","substr_count",466],"(",["T_VARIABLE","$netaddr",466],",",["T_WHITESPACE"," ",466],["T_CONSTANT_ENCAPSED_STRING","':'",466],")",")",",",["T_WHITESPACE"," ",466],["T_VARIABLE","$netaddr",466],")",")",";",["T_WHITESPACE","\n\t\t\t\t\t\t",466],["T_FOR","for",467],["T_WHITESPACE"," ",467],"(",["T_VARIABLE","$j",467],["T_WHITESPACE"," ",467],"=",["T_WHITESPACE"," ",467],["T_LNUMBER","0",467],";",["T_WHITESPACE"," ",467],["T_VARIABLE","$j",467],["T_WHITESPACE"," ",467],"<",["T_WHITESPACE"," ",467],["T_LNUMBER","8",467],";",["T_WHITESPACE"," ",467],["T_VARIABLE","$j",467],["T_INC","++",467],")",["T_WHITESPACE","\n\t\t\t\t\t\t",467],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",468],["T_VARIABLE","$netaddr",469],"[",["T_VARIABLE","$j",469],"]",["T_WHITESPACE"," ",469],"=",["T_WHITESPACE"," ",469],["T_STRING","intval",469],"(",["T_VARIABLE","$netaddr",469],"[",["T_VARIABLE","$j",469],"]",",",["T_WHITESPACE"," ",469],["T_LNUMBER","16",469],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t",469],"}",["T_WHITESPACE","\n\t\t\t\t\t",470],"}",["T_WHITESPACE","\n\t\t\t\t\t",471],["T_ELSE","else",472],["T_WHITESPACE","\n\t\t\t\t\t",472],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",473],["T_VARIABLE","$netaddr",474],["T_WHITESPACE"," ",474],"=",["T_WHITESPACE"," ",474],["T_STRING","explode",474],"(",["T_CONSTANT_ENCAPSED_STRING","'.'",474],",",["T_WHITESPACE"," ",474],["T_VARIABLE","$netaddr",474],")",";",["T_WHITESPACE","\n\t\t\t\t\t",474],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",475],["T_COMMENT","\/\/ Convert to binary and finally compare\n",477],["T_WHITESPACE","\t\t\t\t\t",478],["T_IF","if",478],["T_WHITESPACE"," ",478],"(",["T_STRING","strncmp",478],"(",["T_VARIABLE","$ip",478],",",["T_WHITESPACE"," ",478],["T_STRING","vsprintf",478],"(",["T_VARIABLE","$sprintf",478],",",["T_WHITESPACE"," ",478],["T_VARIABLE","$netaddr",478],")",",",["T_WHITESPACE"," ",478],["T_VARIABLE","$masklen",478],")",["T_WHITESPACE"," ",478],["T_IS_IDENTICAL","===",478],["T_WHITESPACE"," ",478],["T_LNUMBER","0",478],")",["T_WHITESPACE","\n\t\t\t\t\t",478],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",479],["T_VARIABLE","$this",480],["T_OBJECT_OPERATOR","->",480],["T_STRING","ip_address",480],["T_WHITESPACE"," ",480],"=",["T_WHITESPACE"," ",480],["T_VARIABLE","$spoof",480],";",["T_WHITESPACE","\n\t\t\t\t\t\t",480],["T_BREAK","break",481],";",["T_WHITESPACE","\n\t\t\t\t\t",481],"}",["T_WHITESPACE","\n\t\t\t\t",482],"}",["T_WHITESPACE","\n\t\t\t",483],"}",["T_WHITESPACE","\n\t\t",484],"}",["T_WHITESPACE","\n\n\t\t",485],["T_IF","if",487],["T_WHITESPACE"," ",487],"(",["T_WHITESPACE"," ",487],"!",["T_WHITESPACE"," ",487],["T_VARIABLE","$this",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","valid_ip",487],"(",["T_VARIABLE","$this",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","ip_address",487],")",")",["T_WHITESPACE","\n\t\t",487],"{",["T_WHITESPACE","\n\t\t\t",488],["T_RETURN","return",489],["T_WHITESPACE"," ",489],["T_VARIABLE","$this",489],["T_OBJECT_OPERATOR","->",489],["T_STRING","ip_address",489],["T_WHITESPACE"," ",489],"=",["T_WHITESPACE"," ",489],["T_CONSTANT_ENCAPSED_STRING","'0.0.0.0'",489],";",["T_WHITESPACE","\n\t\t",489],"}",["T_WHITESPACE","\n\n\t\t",490],["T_RETURN","return",492],["T_WHITESPACE"," ",492],["T_VARIABLE","$this",492],["T_OBJECT_OPERATOR","->",492],["T_STRING","ip_address",492],";",["T_WHITESPACE","\n\t",492],"}",["T_WHITESPACE","\n\n\t",493],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",495],["T_WHITESPACE","\n\t",496],["T_DOC_COMMENT","\/**\n\t * Validate IP Address\n\t *\n\t * @param\tstring\t$ip\tIP address\n\t * @param\tstring\t$which\tIP protocol: 'ipv4' or 'ipv6'\n\t * @return\tbool\n\t *\/",497],["T_WHITESPACE","\n\t",503],["T_PUBLIC","public",504],["T_WHITESPACE"," ",504],["T_FUNCTION","function",504],["T_WHITESPACE"," ",504],["T_STRING","valid_ip",504],"(",["T_VARIABLE","$ip",504],",",["T_WHITESPACE"," ",504],["T_VARIABLE","$which",504],["T_WHITESPACE"," ",504],"=",["T_WHITESPACE"," ",504],["T_CONSTANT_ENCAPSED_STRING","''",504],")",["T_WHITESPACE","\n\t",504],"{",["T_WHITESPACE","\n\t\t",505],["T_SWITCH","switch",506],["T_WHITESPACE"," ",506],"(",["T_STRING","strtolower",506],"(",["T_VARIABLE","$which",506],")",")",["T_WHITESPACE","\n\t\t",506],"{",["T_WHITESPACE","\n\t\t\t",507],["T_CASE","case",508],["T_WHITESPACE"," ",508],["T_CONSTANT_ENCAPSED_STRING","'ipv4'",508],":",["T_WHITESPACE","\n\t\t\t\t",508],["T_VARIABLE","$which",509],["T_WHITESPACE"," ",509],"=",["T_WHITESPACE"," ",509],["T_STRING","FILTER_FLAG_IPV4",509],";",["T_WHITESPACE","\n\t\t\t\t",509],["T_BREAK","break",510],";",["T_WHITESPACE","\n\t\t\t",510],["T_CASE","case",511],["T_WHITESPACE"," ",511],["T_CONSTANT_ENCAPSED_STRING","'ipv6'",511],":",["T_WHITESPACE","\n\t\t\t\t",511],["T_VARIABLE","$which",512],["T_WHITESPACE"," ",512],"=",["T_WHITESPACE"," ",512],["T_STRING","FILTER_FLAG_IPV6",512],";",["T_WHITESPACE","\n\t\t\t\t",512],["T_BREAK","break",513],";",["T_WHITESPACE","\n\t\t\t",513],["T_DEFAULT","default",514],":",["T_WHITESPACE","\n\t\t\t\t",514],["T_VARIABLE","$which",515],["T_WHITESPACE"," ",515],"=",["T_WHITESPACE"," ",515],["T_STRING","NULL",515],";",["T_WHITESPACE","\n\t\t\t\t",515],["T_BREAK","break",516],";",["T_WHITESPACE","\n\t\t",516],"}",["T_WHITESPACE","\n\n\t\t",517],["T_RETURN","return",519],["T_WHITESPACE"," ",519],["T_BOOL_CAST","(bool)",519],["T_WHITESPACE"," ",519],["T_STRING","filter_var",519],"(",["T_VARIABLE","$ip",519],",",["T_WHITESPACE"," ",519],["T_STRING","FILTER_VALIDATE_IP",519],",",["T_WHITESPACE"," ",519],["T_VARIABLE","$which",519],")",";",["T_WHITESPACE","\n\t",519],"}",["T_WHITESPACE","\n\n\t",520],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",522],["T_WHITESPACE","\n\t",523],["T_DOC_COMMENT","\/**\n\t * Fetch User Agent string\n\t *\n\t * @return\tstring|null\tUser Agent string or NULL if it doesn't exist\n\t *\/",524],["T_WHITESPACE","\n\t",528],["T_PUBLIC","public",529],["T_WHITESPACE"," ",529],["T_FUNCTION","function",529],["T_WHITESPACE"," ",529],["T_STRING","user_agent",529],"(",["T_VARIABLE","$xss_clean",529],["T_WHITESPACE"," ",529],"=",["T_WHITESPACE"," ",529],["T_STRING","FALSE",529],")",["T_WHITESPACE","\n\t",529],"{",["T_WHITESPACE","\n\t\t",530],["T_RETURN","return",531],["T_WHITESPACE"," ",531],["T_VARIABLE","$this",531],["T_OBJECT_OPERATOR","->",531],["T_STRING","_fetch_from_array",531],"(",["T_VARIABLE","$_SERVER",531],",",["T_WHITESPACE"," ",531],["T_CONSTANT_ENCAPSED_STRING","'HTTP_USER_AGENT'",531],",",["T_WHITESPACE"," ",531],["T_VARIABLE","$xss_clean",531],")",";",["T_WHITESPACE","\n\t",531],"}",["T_WHITESPACE","\n\n\t",532],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",534],["T_WHITESPACE","\n\t",535],["T_DOC_COMMENT","\/**\n\t * Request Headers\n\t *\n\t * @param\tbool\t$xss_clean\tWhether to apply XSS filtering\n\t * @return\tarray\n\t *\/",536],["T_WHITESPACE","\n\t",541],["T_PUBLIC","public",542],["T_WHITESPACE"," ",542],["T_FUNCTION","function",542],["T_WHITESPACE"," ",542],["T_STRING","request_headers",542],"(",["T_VARIABLE","$xss_clean",542],["T_WHITESPACE"," ",542],"=",["T_WHITESPACE"," ",542],["T_STRING","FALSE",542],")",["T_WHITESPACE","\n\t",542],"{",["T_WHITESPACE","\n\t\t",543],["T_COMMENT","\/\/ If header is already defined, return it immediately\n",544],["T_WHITESPACE","\t\t",545],["T_IF","if",545],["T_WHITESPACE"," ",545],"(",["T_WHITESPACE"," ",545],"!",["T_WHITESPACE"," ",545],["T_EMPTY","empty",545],"(",["T_VARIABLE","$this",545],["T_OBJECT_OPERATOR","->",545],["T_STRING","headers",545],")",")",["T_WHITESPACE","\n\t\t",545],"{",["T_WHITESPACE","\n\t\t\t",546],["T_RETURN","return",547],["T_WHITESPACE"," ",547],["T_VARIABLE","$this",547],["T_OBJECT_OPERATOR","->",547],["T_STRING","_fetch_from_array",547],"(",["T_VARIABLE","$this",547],["T_OBJECT_OPERATOR","->",547],["T_STRING","headers",547],",",["T_WHITESPACE"," ",547],["T_STRING","NULL",547],",",["T_WHITESPACE"," ",547],["T_VARIABLE","$xss_clean",547],")",";",["T_WHITESPACE","\n\t\t",547],"}",["T_WHITESPACE","\n\n\t\t",548],["T_COMMENT","\/\/ In Apache, you can simply call apache_request_headers()\n",550],["T_WHITESPACE","\t\t",551],["T_IF","if",551],["T_WHITESPACE"," ",551],"(",["T_STRING","function_exists",551],"(",["T_CONSTANT_ENCAPSED_STRING","'apache_request_headers'",551],")",")",["T_WHITESPACE","\n\t\t",551],"{",["T_WHITESPACE","\n\t\t\t",552],["T_VARIABLE","$this",553],["T_OBJECT_OPERATOR","->",553],["T_STRING","headers",553],["T_WHITESPACE"," ",553],"=",["T_WHITESPACE"," ",553],["T_STRING","apache_request_headers",553],"(",")",";",["T_WHITESPACE","\n\t\t",553],"}",["T_WHITESPACE","\n\t\t",554],["T_ELSE","else",555],["T_WHITESPACE","\n\t\t",555],"{",["T_WHITESPACE","\n\t\t\t",556],["T_ISSET","isset",557],"(",["T_VARIABLE","$_SERVER",557],"[",["T_CONSTANT_ENCAPSED_STRING","'CONTENT_TYPE'",557],"]",")",["T_WHITESPACE"," ",557],["T_BOOLEAN_AND","&&",557],["T_WHITESPACE"," ",557],["T_VARIABLE","$this",557],["T_OBJECT_OPERATOR","->",557],["T_STRING","headers",557],"[",["T_CONSTANT_ENCAPSED_STRING","'Content-Type'",557],"]",["T_WHITESPACE"," ",557],"=",["T_WHITESPACE"," ",557],["T_VARIABLE","$_SERVER",557],"[",["T_CONSTANT_ENCAPSED_STRING","'CONTENT_TYPE'",557],"]",";",["T_WHITESPACE","\n\n\t\t\t",557],["T_FOREACH","foreach",559],["T_WHITESPACE"," ",559],"(",["T_VARIABLE","$_SERVER",559],["T_WHITESPACE"," ",559],["T_AS","as",559],["T_WHITESPACE"," ",559],["T_VARIABLE","$key",559],["T_WHITESPACE"," ",559],["T_DOUBLE_ARROW","=>",559],["T_WHITESPACE"," ",559],["T_VARIABLE","$val",559],")",["T_WHITESPACE","\n\t\t\t",559],"{",["T_WHITESPACE","\n\t\t\t\t",560],["T_IF","if",561],["T_WHITESPACE"," ",561],"(",["T_STRING","sscanf",561],"(",["T_VARIABLE","$key",561],",",["T_WHITESPACE"," ",561],["T_CONSTANT_ENCAPSED_STRING","'HTTP_%s'",561],",",["T_WHITESPACE"," ",561],["T_VARIABLE","$header",561],")",["T_WHITESPACE"," ",561],["T_IS_IDENTICAL","===",561],["T_WHITESPACE"," ",561],["T_LNUMBER","1",561],")",["T_WHITESPACE","\n\t\t\t\t",561],"{",["T_WHITESPACE","\n\t\t\t\t\t",562],["T_COMMENT","\/\/ take SOME_HEADER and turn it into Some-Header\n",563],["T_WHITESPACE","\t\t\t\t\t",564],["T_VARIABLE","$header",564],["T_WHITESPACE"," ",564],"=",["T_WHITESPACE"," ",564],["T_STRING","str_replace",564],"(",["T_CONSTANT_ENCAPSED_STRING","'_'",564],",",["T_WHITESPACE"," ",564],["T_CONSTANT_ENCAPSED_STRING","' '",564],",",["T_WHITESPACE"," ",564],["T_STRING","strtolower",564],"(",["T_VARIABLE","$header",564],")",")",";",["T_WHITESPACE","\n\t\t\t\t\t",564],["T_VARIABLE","$header",565],["T_WHITESPACE"," ",565],"=",["T_WHITESPACE"," ",565],["T_STRING","str_replace",565],"(",["T_CONSTANT_ENCAPSED_STRING","' '",565],",",["T_WHITESPACE"," ",565],["T_CONSTANT_ENCAPSED_STRING","'-'",565],",",["T_WHITESPACE"," ",565],["T_STRING","ucwords",565],"(",["T_VARIABLE","$header",565],")",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",565],["T_VARIABLE","$this",567],["T_OBJECT_OPERATOR","->",567],["T_STRING","headers",567],"[",["T_VARIABLE","$header",567],"]",["T_WHITESPACE"," ",567],"=",["T_WHITESPACE"," ",567],["T_VARIABLE","$_SERVER",567],"[",["T_VARIABLE","$key",567],"]",";",["T_WHITESPACE","\n\t\t\t\t",567],"}",["T_WHITESPACE","\n\t\t\t",568],"}",["T_WHITESPACE","\n\t\t",569],"}",["T_WHITESPACE","\n\n\t\t",570],["T_RETURN","return",572],["T_WHITESPACE"," ",572],["T_VARIABLE","$this",572],["T_OBJECT_OPERATOR","->",572],["T_STRING","_fetch_from_array",572],"(",["T_VARIABLE","$this",572],["T_OBJECT_OPERATOR","->",572],["T_STRING","headers",572],",",["T_WHITESPACE"," ",572],["T_STRING","NULL",572],",",["T_WHITESPACE"," ",572],["T_VARIABLE","$xss_clean",572],")",";",["T_WHITESPACE","\n\t",572],"}",["T_WHITESPACE","\n\n\t",573],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",575],["T_WHITESPACE","\n\t",576],["T_DOC_COMMENT","\/**\n\t * Get Request Header\n\t *\n\t * Returns the value of a single member of the headers class member\n\t *\n\t * @param\tstring\t\t$index\t\tHeader name\n\t * @param\tbool\t\t$xss_clean\tWhether to apply XSS filtering\n\t * @return\tstring|null\tThe requested header on success or NULL on failure\n\t *\/",577],["T_WHITESPACE","\n\t",585],["T_PUBLIC","public",586],["T_WHITESPACE"," ",586],["T_FUNCTION","function",586],["T_WHITESPACE"," ",586],["T_STRING","get_request_header",586],"(",["T_VARIABLE","$index",586],",",["T_WHITESPACE"," ",586],["T_VARIABLE","$xss_clean",586],["T_WHITESPACE"," ",586],"=",["T_WHITESPACE"," ",586],["T_STRING","FALSE",586],")",["T_WHITESPACE","\n\t",586],"{",["T_WHITESPACE","\n\t\t",587],["T_STATIC","static",588],["T_WHITESPACE"," ",588],["T_VARIABLE","$headers",588],";",["T_WHITESPACE","\n\n\t\t",588],["T_IF","if",590],["T_WHITESPACE"," ",590],"(",["T_WHITESPACE"," ",590],"!",["T_WHITESPACE"," ",590],["T_ISSET","isset",590],"(",["T_VARIABLE","$headers",590],")",")",["T_WHITESPACE","\n\t\t",590],"{",["T_WHITESPACE","\n\t\t\t",591],["T_EMPTY","empty",592],"(",["T_VARIABLE","$this",592],["T_OBJECT_OPERATOR","->",592],["T_STRING","headers",592],")",["T_WHITESPACE"," ",592],["T_BOOLEAN_AND","&&",592],["T_WHITESPACE"," ",592],["T_VARIABLE","$this",592],["T_OBJECT_OPERATOR","->",592],["T_STRING","request_headers",592],"(",")",";",["T_WHITESPACE","\n\t\t\t",592],["T_FOREACH","foreach",593],["T_WHITESPACE"," ",593],"(",["T_VARIABLE","$this",593],["T_OBJECT_OPERATOR","->",593],["T_STRING","headers",593],["T_WHITESPACE"," ",593],["T_AS","as",593],["T_WHITESPACE"," ",593],["T_VARIABLE","$key",593],["T_WHITESPACE"," ",593],["T_DOUBLE_ARROW","=>",593],["T_WHITESPACE"," ",593],["T_VARIABLE","$value",593],")",["T_WHITESPACE","\n\t\t\t",593],"{",["T_WHITESPACE","\n\t\t\t\t",594],["T_VARIABLE","$headers",595],"[",["T_STRING","strtolower",595],"(",["T_VARIABLE","$key",595],")","]",["T_WHITESPACE"," ",595],"=",["T_WHITESPACE"," ",595],["T_VARIABLE","$value",595],";",["T_WHITESPACE","\n\t\t\t",595],"}",["T_WHITESPACE","\n\t\t",596],"}",["T_WHITESPACE","\n\n\t\t",597],["T_VARIABLE","$index",599],["T_WHITESPACE"," ",599],"=",["T_WHITESPACE"," ",599],["T_STRING","strtolower",599],"(",["T_VARIABLE","$index",599],")",";",["T_WHITESPACE","\n\n\t\t",599],["T_IF","if",601],["T_WHITESPACE"," ",601],"(",["T_WHITESPACE"," ",601],"!",["T_WHITESPACE"," ",601],["T_ISSET","isset",601],"(",["T_VARIABLE","$headers",601],"[",["T_VARIABLE","$index",601],"]",")",")",["T_WHITESPACE","\n\t\t",601],"{",["T_WHITESPACE","\n\t\t\t",602],["T_RETURN","return",603],["T_WHITESPACE"," ",603],["T_STRING","NULL",603],";",["T_WHITESPACE","\n\t\t",603],"}",["T_WHITESPACE","\n\n\t\t",604],["T_RETURN","return",606],["T_WHITESPACE"," ",606],"(",["T_VARIABLE","$xss_clean",606],["T_WHITESPACE"," ",606],["T_IS_IDENTICAL","===",606],["T_WHITESPACE"," ",606],["T_STRING","TRUE",606],")",["T_WHITESPACE","\n\t\t\t",606],"?",["T_WHITESPACE"," ",607],["T_VARIABLE","$this",607],["T_OBJECT_OPERATOR","->",607],["T_STRING","security",607],["T_OBJECT_OPERATOR","->",607],["T_STRING","xss_clean",607],"(",["T_VARIABLE","$headers",607],"[",["T_VARIABLE","$index",607],"]",")",["T_WHITESPACE","\n\t\t\t",607],":",["T_WHITESPACE"," ",608],["T_VARIABLE","$headers",608],"[",["T_VARIABLE","$index",608],"]",";",["T_WHITESPACE","\n\t",608],"}",["T_WHITESPACE","\n\n\t",609],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",611],["T_WHITESPACE","\n\t",612],["T_DOC_COMMENT","\/**\n\t * Is AJAX request?\n\t *\n\t * Test to see if a request contains the HTTP_X_REQUESTED_WITH header.\n\t *\n\t * @return \tbool\n\t *\/",613],["T_WHITESPACE","\n\t",619],["T_PUBLIC","public",620],["T_WHITESPACE"," ",620],["T_FUNCTION","function",620],["T_WHITESPACE"," ",620],["T_STRING","is_ajax_request",620],"(",")",["T_WHITESPACE","\n\t",620],"{",["T_WHITESPACE","\n\t\t",621],["T_RETURN","return",622],["T_WHITESPACE"," ",622],"(",["T_WHITESPACE"," ",622],"!",["T_WHITESPACE"," ",622],["T_EMPTY","empty",622],"(",["T_VARIABLE","$_SERVER",622],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_X_REQUESTED_WITH'",622],"]",")",["T_WHITESPACE"," ",622],["T_BOOLEAN_AND","&&",622],["T_WHITESPACE"," ",622],["T_STRING","strtolower",622],"(",["T_VARIABLE","$_SERVER",622],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_X_REQUESTED_WITH'",622],"]",")",["T_WHITESPACE"," ",622],["T_IS_IDENTICAL","===",622],["T_WHITESPACE"," ",622],["T_CONSTANT_ENCAPSED_STRING","'xmlhttprequest'",622],")",";",["T_WHITESPACE","\n\t",622],"}",["T_WHITESPACE","\n\n\t",623],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",625],["T_WHITESPACE","\n\t",626],["T_DOC_COMMENT","\/**\n\t * Get Request Method\n\t *\n\t * Return the request method\n\t *\n\t * @param\tbool\t$upper\tWhether to return in upper or lower case\n\t *\t\t\t\t(default: FALSE)\n\t * @return \tstring\n\t *\/",627],["T_WHITESPACE","\n\t",635],["T_PUBLIC","public",636],["T_WHITESPACE"," ",636],["T_FUNCTION","function",636],["T_WHITESPACE"," ",636],["T_STRING","method",636],"(",["T_VARIABLE","$upper",636],["T_WHITESPACE"," ",636],"=",["T_WHITESPACE"," ",636],["T_STRING","FALSE",636],")",["T_WHITESPACE","\n\t",636],"{",["T_WHITESPACE","\n\t\t",637],["T_RETURN","return",638],["T_WHITESPACE"," ",638],"(",["T_VARIABLE","$upper",638],")",["T_WHITESPACE","\n\t\t\t",638],"?",["T_WHITESPACE"," ",639],["T_STRING","strtoupper",639],"(",["T_VARIABLE","$this",639],["T_OBJECT_OPERATOR","->",639],["T_STRING","server",639],"(",["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",639],")",")",["T_WHITESPACE","\n\t\t\t",639],":",["T_WHITESPACE"," ",640],["T_STRING","strtolower",640],"(",["T_VARIABLE","$this",640],["T_OBJECT_OPERATOR","->",640],["T_STRING","server",640],"(",["T_CONSTANT_ENCAPSED_STRING","'REQUEST_METHOD'",640],")",")",";",["T_WHITESPACE","\n\t",640],"}",["T_WHITESPACE","\n\n\t",641],["T_COMMENT","\/\/ ------------------------------------------------------------------------\n",643],["T_WHITESPACE","\n\t",644],["T_DOC_COMMENT","\/**\n\t * Magic __get()\n\t *\n\t * Allows read access to protected properties\n\t *\n\t * @param\tstring\t$name\n\t * @return\tmixed\n\t *\/",645],["T_WHITESPACE","\n\t",652],["T_PUBLIC","public",653],["T_WHITESPACE"," ",653],["T_FUNCTION","function",653],["T_WHITESPACE"," ",653],["T_STRING","__get",653],"(",["T_VARIABLE","$name",653],")",["T_WHITESPACE","\n\t",653],"{",["T_WHITESPACE","\n\t\t",654],["T_IF","if",655],["T_WHITESPACE"," ",655],"(",["T_VARIABLE","$name",655],["T_WHITESPACE"," ",655],["T_IS_IDENTICAL","===",655],["T_WHITESPACE"," ",655],["T_CONSTANT_ENCAPSED_STRING","'raw_input_stream'",655],")",["T_WHITESPACE","\n\t\t",655],"{",["T_WHITESPACE","\n\t\t\t",656],["T_ISSET","isset",657],"(",["T_VARIABLE","$this",657],["T_OBJECT_OPERATOR","->",657],["T_STRING","_raw_input_stream",657],")",["T_WHITESPACE"," ",657],["T_LOGICAL_OR","OR",657],["T_WHITESPACE"," ",657],["T_VARIABLE","$this",657],["T_OBJECT_OPERATOR","->",657],["T_STRING","_raw_input_stream",657],["T_WHITESPACE"," ",657],"=",["T_WHITESPACE"," ",657],["T_STRING","file_get_contents",657],"(",["T_CONSTANT_ENCAPSED_STRING","'php:\/\/input'",657],")",";",["T_WHITESPACE","\n\t\t\t",657],["T_RETURN","return",658],["T_WHITESPACE"," ",658],["T_VARIABLE","$this",658],["T_OBJECT_OPERATOR","->",658],["T_STRING","_raw_input_stream",658],";",["T_WHITESPACE","\n\t\t",658],"}",["T_WHITESPACE","\n\t\t",659],["T_ELSEIF","elseif",660],["T_WHITESPACE"," ",660],"(",["T_VARIABLE","$name",660],["T_WHITESPACE"," ",660],["T_IS_IDENTICAL","===",660],["T_WHITESPACE"," ",660],["T_CONSTANT_ENCAPSED_STRING","'ip_address'",660],")",["T_WHITESPACE","\n\t\t",660],"{",["T_WHITESPACE","\n\t\t\t",661],["T_RETURN","return",662],["T_WHITESPACE"," ",662],["T_VARIABLE","$this",662],["T_OBJECT_OPERATOR","->",662],["T_STRING","ip_address",662],";",["T_WHITESPACE","\n\t\t",662],"}",["T_WHITESPACE","\n\t",663],"}",["T_WHITESPACE","\n\n",664],"}",["T_WHITESPACE","\n",666]]