[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CodeIgniter\n *\n * An open source application development framework for PHP\n *\n * This content is released under the MIT License (MIT)\n *\n * Copyright (c) 2014 - 2017, British Columbia Institute of Technology\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and\/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n *\n * @package\tCodeIgniter\n * @author\tEllisLab Dev Team\n * @copyright\tCopyright (c) 2008 - 2014, EllisLab, Inc. (https:\/\/ellislab.com\/)\n * @copyright\tCopyright (c) 2014 - 2017, British Columbia Institute of Technology (http:\/\/bcit.ca\/)\n * @license\thttp:\/\/opensource.org\/licenses\/MIT\tMIT License\n * @link\thttps:\/\/codeigniter.com\n * @since\tVersion 3.0.0\n * @filesource\n *\/",2],["T_WHITESPACE","\n",37],["T_STRING","defined",38],"(",["T_CONSTANT_ENCAPSED_STRING","'BASEPATH'",38],")",["T_WHITESPACE"," ",38],["T_LOGICAL_OR","OR",38],["T_WHITESPACE"," ",38],["T_EXIT","exit",38],"(",["T_CONSTANT_ENCAPSED_STRING","'No direct script access allowed'",38],")",";",["T_WHITESPACE","\n\n",38],["T_DOC_COMMENT","\/**\n * CodeIgniter Encryption Class\n *\n * Provides two-way keyed encryption via PHP's MCrypt and\/or OpenSSL extensions.\n *\n * @package\t\tCodeIgniter\n * @subpackage\tLibraries\n * @category\tLibraries\n * @author\t\tAndrey Andreev\n * @link\t\thttps:\/\/codeigniter.com\/user_guide\/libraries\/encryption.html\n *\/",40],["T_WHITESPACE","\n",50],["T_CLASS","class",51],["T_WHITESPACE"," ",51],["T_STRING","CI_Encryption",51],["T_WHITESPACE"," ",51],"{",["T_WHITESPACE","\n\n\t",51],["T_DOC_COMMENT","\/**\n\t * Encryption cipher\n\t *\n\t * @var\tstring\n\t *\/",53],["T_WHITESPACE","\n\t",57],["T_PROTECTED","protected",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$_cipher",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'aes-128'",58],";",["T_WHITESPACE","\n\n\t",58],["T_DOC_COMMENT","\/**\n\t * Cipher mode\n\t *\n\t * @var\tstring\n\t *\/",60],["T_WHITESPACE","\n\t",64],["T_PROTECTED","protected",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$_mode",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'cbc'",65],";",["T_WHITESPACE","\n\n\t",65],["T_DOC_COMMENT","\/**\n\t * Cipher handle\n\t *\n\t * @var\tmixed\n\t *\/",67],["T_WHITESPACE","\n\t",71],["T_PROTECTED","protected",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$_handle",72],";",["T_WHITESPACE","\n\n\t",72],["T_DOC_COMMENT","\/**\n\t * Encryption key\n\t *\n\t * @var\tstring\n\t *\/",74],["T_WHITESPACE","\n\t",78],["T_PROTECTED","protected",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$_key",79],";",["T_WHITESPACE","\n\n\t",79],["T_DOC_COMMENT","\/**\n\t * PHP extension to be used\n\t *\n\t * @var\tstring\n\t *\/",81],["T_WHITESPACE","\n\t",85],["T_PROTECTED","protected",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$_driver",86],";",["T_WHITESPACE","\n\n\t",86],["T_DOC_COMMENT","\/**\n\t * List of usable drivers (PHP extensions)\n\t *\n\t * @var\tarray\n\t *\/",88],["T_WHITESPACE","\n\t",92],["T_PROTECTED","protected",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$_drivers",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_ARRAY","array",93],"(",")",";",["T_WHITESPACE","\n\n\t",93],["T_DOC_COMMENT","\/**\n\t * List of available modes\n\t *\n\t * @var\tarray\n\t *\/",95],["T_WHITESPACE","\n\t",99],["T_PROTECTED","protected",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$_modes",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_ARRAY","array",100],"(",["T_WHITESPACE","\n\t\t",100],["T_CONSTANT_ENCAPSED_STRING","'mcrypt'",101],["T_WHITESPACE"," ",101],["T_DOUBLE_ARROW","=>",101],["T_WHITESPACE"," ",101],["T_ARRAY","array",101],"(",["T_WHITESPACE","\n\t\t\t",101],["T_CONSTANT_ENCAPSED_STRING","'cbc'",102],["T_WHITESPACE"," ",102],["T_DOUBLE_ARROW","=>",102],["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'cbc'",102],",",["T_WHITESPACE","\n\t\t\t",102],["T_CONSTANT_ENCAPSED_STRING","'ecb'",103],["T_WHITESPACE"," ",103],["T_DOUBLE_ARROW","=>",103],["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'ecb'",103],",",["T_WHITESPACE","\n\t\t\t",103],["T_CONSTANT_ENCAPSED_STRING","'ofb'",104],["T_WHITESPACE"," ",104],["T_DOUBLE_ARROW","=>",104],["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'nofb'",104],",",["T_WHITESPACE","\n\t\t\t",104],["T_CONSTANT_ENCAPSED_STRING","'ofb8'",105],["T_WHITESPACE"," ",105],["T_DOUBLE_ARROW","=>",105],["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'ofb'",105],",",["T_WHITESPACE","\n\t\t\t",105],["T_CONSTANT_ENCAPSED_STRING","'cfb'",106],["T_WHITESPACE"," ",106],["T_DOUBLE_ARROW","=>",106],["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'ncfb'",106],",",["T_WHITESPACE","\n\t\t\t",106],["T_CONSTANT_ENCAPSED_STRING","'cfb8'",107],["T_WHITESPACE"," ",107],["T_DOUBLE_ARROW","=>",107],["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'cfb'",107],",",["T_WHITESPACE","\n\t\t\t",107],["T_CONSTANT_ENCAPSED_STRING","'ctr'",108],["T_WHITESPACE"," ",108],["T_DOUBLE_ARROW","=>",108],["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'ctr'",108],",",["T_WHITESPACE","\n\t\t\t",108],["T_CONSTANT_ENCAPSED_STRING","'stream'",109],["T_WHITESPACE"," ",109],["T_DOUBLE_ARROW","=>",109],["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'stream'",109],["T_WHITESPACE","\n\t\t",109],")",",",["T_WHITESPACE","\n\t\t",110],["T_CONSTANT_ENCAPSED_STRING","'openssl'",111],["T_WHITESPACE"," ",111],["T_DOUBLE_ARROW","=>",111],["T_WHITESPACE"," ",111],["T_ARRAY","array",111],"(",["T_WHITESPACE","\n\t\t\t",111],["T_CONSTANT_ENCAPSED_STRING","'cbc'",112],["T_WHITESPACE"," ",112],["T_DOUBLE_ARROW","=>",112],["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'cbc'",112],",",["T_WHITESPACE","\n\t\t\t",112],["T_CONSTANT_ENCAPSED_STRING","'ecb'",113],["T_WHITESPACE"," ",113],["T_DOUBLE_ARROW","=>",113],["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","'ecb'",113],",",["T_WHITESPACE","\n\t\t\t",113],["T_CONSTANT_ENCAPSED_STRING","'ofb'",114],["T_WHITESPACE"," ",114],["T_DOUBLE_ARROW","=>",114],["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","'ofb'",114],",",["T_WHITESPACE","\n\t\t\t",114],["T_CONSTANT_ENCAPSED_STRING","'cfb'",115],["T_WHITESPACE"," ",115],["T_DOUBLE_ARROW","=>",115],["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'cfb'",115],",",["T_WHITESPACE","\n\t\t\t",115],["T_CONSTANT_ENCAPSED_STRING","'cfb8'",116],["T_WHITESPACE"," ",116],["T_DOUBLE_ARROW","=>",116],["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","'cfb8'",116],",",["T_WHITESPACE","\n\t\t\t",116],["T_CONSTANT_ENCAPSED_STRING","'ctr'",117],["T_WHITESPACE"," ",117],["T_DOUBLE_ARROW","=>",117],["T_WHITESPACE"," ",117],["T_CONSTANT_ENCAPSED_STRING","'ctr'",117],",",["T_WHITESPACE","\n\t\t\t",117],["T_CONSTANT_ENCAPSED_STRING","'stream'",118],["T_WHITESPACE"," ",118],["T_DOUBLE_ARROW","=>",118],["T_WHITESPACE"," ",118],["T_CONSTANT_ENCAPSED_STRING","''",118],",",["T_WHITESPACE","\n\t\t\t",118],["T_CONSTANT_ENCAPSED_STRING","'xts'",119],["T_WHITESPACE"," ",119],["T_DOUBLE_ARROW","=>",119],["T_WHITESPACE"," ",119],["T_CONSTANT_ENCAPSED_STRING","'xts'",119],["T_WHITESPACE","\n\t\t",119],")",["T_WHITESPACE","\n\t",120],")",";",["T_WHITESPACE","\n\n\t",121],["T_DOC_COMMENT","\/**\n\t * List of supported HMAC algorithms\n\t *\n\t * name => digest size pairs\n\t *\n\t * @var\tarray\n\t *\/",123],["T_WHITESPACE","\n\t",129],["T_PROTECTED","protected",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$_digests",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_ARRAY","array",130],"(",["T_WHITESPACE","\n\t\t",130],["T_CONSTANT_ENCAPSED_STRING","'sha224'",131],["T_WHITESPACE"," ",131],["T_DOUBLE_ARROW","=>",131],["T_WHITESPACE"," ",131],["T_LNUMBER","28",131],",",["T_WHITESPACE","\n\t\t",131],["T_CONSTANT_ENCAPSED_STRING","'sha256'",132],["T_WHITESPACE"," ",132],["T_DOUBLE_ARROW","=>",132],["T_WHITESPACE"," ",132],["T_LNUMBER","32",132],",",["T_WHITESPACE","\n\t\t",132],["T_CONSTANT_ENCAPSED_STRING","'sha384'",133],["T_WHITESPACE"," ",133],["T_DOUBLE_ARROW","=>",133],["T_WHITESPACE"," ",133],["T_LNUMBER","48",133],",",["T_WHITESPACE","\n\t\t",133],["T_CONSTANT_ENCAPSED_STRING","'sha512'",134],["T_WHITESPACE"," ",134],["T_DOUBLE_ARROW","=>",134],["T_WHITESPACE"," ",134],["T_LNUMBER","64",134],["T_WHITESPACE","\n\t",134],")",";",["T_WHITESPACE","\n\n\t",135],["T_DOC_COMMENT","\/**\n\t * mbstring.func_override flag\n\t *\n\t * @var\tbool\n\t *\/",137],["T_WHITESPACE","\n\t",141],["T_PROTECTED","protected",142],["T_WHITESPACE"," ",142],["T_STATIC","static",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$func_override",142],";",["T_WHITESPACE","\n\n\t",142],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",144],["T_WHITESPACE","\n\t",145],["T_DOC_COMMENT","\/**\n\t * Class constructor\n\t *\n\t * @param\tarray\t$params\tConfiguration parameters\n\t * @return\tvoid\n\t *\/",146],["T_WHITESPACE","\n\t",151],["T_PUBLIC","public",152],["T_WHITESPACE"," ",152],["T_FUNCTION","function",152],["T_WHITESPACE"," ",152],["T_STRING","__construct",152],"(",["T_ARRAY","array",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$params",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_ARRAY","array",152],"(",")",")",["T_WHITESPACE","\n\t",152],"{",["T_WHITESPACE","\n\t\t",153],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","_drivers",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_ARRAY","array",154],"(",["T_WHITESPACE","\n\t\t\t",154],["T_CONSTANT_ENCAPSED_STRING","'mcrypt'",155],["T_WHITESPACE","  ",155],["T_DOUBLE_ARROW","=>",155],["T_WHITESPACE"," ",155],["T_STRING","defined",155],"(",["T_CONSTANT_ENCAPSED_STRING","'MCRYPT_DEV_URANDOM'",155],")",",",["T_WHITESPACE","\n\t\t\t",155],["T_CONSTANT_ENCAPSED_STRING","'openssl'",156],["T_WHITESPACE"," ",156],["T_DOUBLE_ARROW","=>",156],["T_WHITESPACE"," ",156],["T_STRING","extension_loaded",156],"(",["T_CONSTANT_ENCAPSED_STRING","'openssl'",156],")",["T_WHITESPACE","\n\t\t",156],")",";",["T_WHITESPACE","\n\n\t\t",157],["T_IF","if",159],["T_WHITESPACE"," ",159],"(",["T_WHITESPACE"," ",159],"!",["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","_drivers",159],"[",["T_CONSTANT_ENCAPSED_STRING","'mcrypt'",159],"]",["T_WHITESPACE"," ",159],["T_BOOLEAN_AND","&&",159],["T_WHITESPACE"," ",159],"!",["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","_drivers",159],"[",["T_CONSTANT_ENCAPSED_STRING","'openssl'",159],"]",")",["T_WHITESPACE","\n\t\t",159],"{",["T_WHITESPACE","\n\t\t\t",160],["T_STRING","show_error",161],"(",["T_CONSTANT_ENCAPSED_STRING","'Encryption: Unable to find an available encryption driver.'",161],")",";",["T_WHITESPACE","\n\t\t",161],"}",["T_WHITESPACE","\n\n\t\t",162],["T_ISSET","isset",164],"(",["T_STRING","self",164],["T_DOUBLE_COLON","::",164],["T_VARIABLE","$func_override",164],")",["T_WHITESPACE"," ",164],["T_LOGICAL_OR","OR",164],["T_WHITESPACE"," ",164],["T_STRING","self",164],["T_DOUBLE_COLON","::",164],["T_VARIABLE","$func_override",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],"(",["T_STRING","extension_loaded",164],"(",["T_CONSTANT_ENCAPSED_STRING","'mbstring'",164],")",["T_WHITESPACE"," ",164],["T_BOOLEAN_AND","&&",164],["T_WHITESPACE"," ",164],["T_STRING","ini_get",164],"(",["T_CONSTANT_ENCAPSED_STRING","'mbstring.func_override'",164],")",")",";",["T_WHITESPACE","\n\t\t",164],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","initialize",165],"(",["T_VARIABLE","$params",165],")",";",["T_WHITESPACE","\n\n\t\t",165],["T_IF","if",167],["T_WHITESPACE"," ",167],"(",["T_WHITESPACE"," ",167],"!",["T_WHITESPACE"," ",167],["T_ISSET","isset",167],"(",["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","_key",167],")",["T_WHITESPACE"," ",167],["T_BOOLEAN_AND","&&",167],["T_WHITESPACE"," ",167],["T_STRING","self",167],["T_DOUBLE_COLON","::",167],["T_STRING","strlen",167],"(",["T_VARIABLE","$key",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_STRING","config_item",167],"(",["T_CONSTANT_ENCAPSED_STRING","'encryption_key'",167],")",")",["T_WHITESPACE"," ",167],">",["T_WHITESPACE"," ",167],["T_LNUMBER","0",167],")",["T_WHITESPACE","\n\t\t",167],"{",["T_WHITESPACE","\n\t\t\t",168],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","_key",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_VARIABLE","$key",169],";",["T_WHITESPACE","\n\t\t",169],"}",["T_WHITESPACE","\n\n\t\t",170],["T_STRING","log_message",172],"(",["T_CONSTANT_ENCAPSED_STRING","'info'",172],",",["T_WHITESPACE"," ",172],["T_CONSTANT_ENCAPSED_STRING","'Encryption Class Initialized'",172],")",";",["T_WHITESPACE","\n\t",172],"}",["T_WHITESPACE","\n\n\t",173],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",175],["T_WHITESPACE","\n\t",176],["T_DOC_COMMENT","\/**\n\t * Initialize\n\t *\n\t * @param\tarray\t$params\tConfiguration parameters\n\t * @return\tCI_Encryption\n\t *\/",177],["T_WHITESPACE","\n\t",182],["T_PUBLIC","public",183],["T_WHITESPACE"," ",183],["T_FUNCTION","function",183],["T_WHITESPACE"," ",183],["T_STRING","initialize",183],"(",["T_ARRAY","array",183],["T_WHITESPACE"," ",183],["T_VARIABLE","$params",183],")",["T_WHITESPACE","\n\t",183],"{",["T_WHITESPACE","\n\t\t",184],["T_IF","if",185],["T_WHITESPACE"," ",185],"(",["T_WHITESPACE"," ",185],"!",["T_WHITESPACE"," ",185],["T_EMPTY","empty",185],"(",["T_VARIABLE","$params",185],"[",["T_CONSTANT_ENCAPSED_STRING","'driver'",185],"]",")",")",["T_WHITESPACE","\n\t\t",185],"{",["T_WHITESPACE","\n\t\t\t",186],["T_IF","if",187],["T_WHITESPACE"," ",187],"(",["T_ISSET","isset",187],"(",["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","_drivers",187],"[",["T_VARIABLE","$params",187],"[",["T_CONSTANT_ENCAPSED_STRING","'driver'",187],"]","]",")",")",["T_WHITESPACE","\n\t\t\t",187],"{",["T_WHITESPACE","\n\t\t\t\t",188],["T_IF","if",189],["T_WHITESPACE"," ",189],"(",["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","_drivers",189],"[",["T_VARIABLE","$params",189],"[",["T_CONSTANT_ENCAPSED_STRING","'driver'",189],"]","]",")",["T_WHITESPACE","\n\t\t\t\t",189],"{",["T_WHITESPACE","\n\t\t\t\t\t",190],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","_driver",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_VARIABLE","$params",191],"[",["T_CONSTANT_ENCAPSED_STRING","'driver'",191],"]",";",["T_WHITESPACE","\n\t\t\t\t",191],"}",["T_WHITESPACE","\n\t\t\t\t",192],["T_ELSE","else",193],["T_WHITESPACE","\n\t\t\t\t",193],"{",["T_WHITESPACE","\n\t\t\t\t\t",194],["T_STRING","log_message",195],"(",["T_CONSTANT_ENCAPSED_STRING","'error'",195],",",["T_WHITESPACE"," ",195],["T_CONSTANT_ENCAPSED_STRING","\"Encryption: Driver '\"",195],".",["T_VARIABLE","$params",195],"[",["T_CONSTANT_ENCAPSED_STRING","'driver'",195],"]",".",["T_CONSTANT_ENCAPSED_STRING","\"' is not available.\"",195],")",";",["T_WHITESPACE","\n\t\t\t\t",195],"}",["T_WHITESPACE","\n\t\t\t",196],"}",["T_WHITESPACE","\n\t\t\t",197],["T_ELSE","else",198],["T_WHITESPACE","\n\t\t\t",198],"{",["T_WHITESPACE","\n\t\t\t\t",199],["T_STRING","log_message",200],"(",["T_CONSTANT_ENCAPSED_STRING","'error'",200],",",["T_WHITESPACE"," ",200],["T_CONSTANT_ENCAPSED_STRING","\"Encryption: Unknown driver '\"",200],".",["T_VARIABLE","$params",200],"[",["T_CONSTANT_ENCAPSED_STRING","'driver'",200],"]",".",["T_CONSTANT_ENCAPSED_STRING","\"' cannot be configured.\"",200],")",";",["T_WHITESPACE","\n\t\t\t",200],"}",["T_WHITESPACE","\n\t\t",201],"}",["T_WHITESPACE","\n\n\t\t",202],["T_IF","if",204],["T_WHITESPACE"," ",204],"(",["T_EMPTY","empty",204],"(",["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","_driver",204],")",")",["T_WHITESPACE","\n\t\t",204],"{",["T_WHITESPACE","\n\t\t\t",205],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","_driver",206],["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],"(",["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","_drivers",206],"[",["T_CONSTANT_ENCAPSED_STRING","'openssl'",206],"]",["T_WHITESPACE"," ",206],["T_IS_IDENTICAL","===",206],["T_WHITESPACE"," ",206],["T_STRING","TRUE",206],")",["T_WHITESPACE","\n\t\t\t\t",206],"?",["T_WHITESPACE"," ",207],["T_CONSTANT_ENCAPSED_STRING","'openssl'",207],["T_WHITESPACE","\n\t\t\t\t",207],":",["T_WHITESPACE"," ",208],["T_CONSTANT_ENCAPSED_STRING","'mcrypt'",208],";",["T_WHITESPACE","\n\n\t\t\t",208],["T_STRING","log_message",210],"(",["T_CONSTANT_ENCAPSED_STRING","'debug'",210],",",["T_WHITESPACE"," ",210],["T_CONSTANT_ENCAPSED_STRING","\"Encryption: Auto-configured driver '\"",210],".",["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","_driver",210],".",["T_CONSTANT_ENCAPSED_STRING","\"'.\"",210],")",";",["T_WHITESPACE","\n\t\t",210],"}",["T_WHITESPACE","\n\n\t\t",211],["T_EMPTY","empty",213],"(",["T_VARIABLE","$params",213],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",213],"]",")",["T_WHITESPACE"," ",213],["T_BOOLEAN_AND","&&",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$params",213],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",213],"]",["T_WHITESPACE"," ",213],"=",["T_WHITESPACE"," ",213],["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","_cipher",213],";",["T_WHITESPACE","\n\t\t",213],["T_EMPTY","empty",214],"(",["T_VARIABLE","$params",214],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",214],"]",")",["T_WHITESPACE"," ",214],["T_LOGICAL_OR","OR",214],["T_WHITESPACE"," ",214],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","_key",214],["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_VARIABLE","$params",214],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",214],"]",";",["T_WHITESPACE","\n\t\t",214],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],"{",["T_CONSTANT_ENCAPSED_STRING","'_'",215],".",["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","_driver",215],".",["T_CONSTANT_ENCAPSED_STRING","'_initialize'",215],"}","(",["T_VARIABLE","$params",215],")",";",["T_WHITESPACE","\n\t\t",215],["T_RETURN","return",216],["T_WHITESPACE"," ",216],["T_VARIABLE","$this",216],";",["T_WHITESPACE","\n\t",216],"}",["T_WHITESPACE","\n\n\t",217],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",219],["T_WHITESPACE","\n\t",220],["T_DOC_COMMENT","\/**\n\t * Initialize MCrypt\n\t *\n\t * @param\tarray\t$params\tConfiguration parameters\n\t * @return\tvoid\n\t *\/",221],["T_WHITESPACE","\n\t",226],["T_PROTECTED","protected",227],["T_WHITESPACE"," ",227],["T_FUNCTION","function",227],["T_WHITESPACE"," ",227],["T_STRING","_mcrypt_initialize",227],"(",["T_VARIABLE","$params",227],")",["T_WHITESPACE","\n\t",227],"{",["T_WHITESPACE","\n\t\t",228],["T_IF","if",229],["T_WHITESPACE"," ",229],"(",["T_WHITESPACE"," ",229],"!",["T_WHITESPACE"," ",229],["T_EMPTY","empty",229],"(",["T_VARIABLE","$params",229],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",229],"]",")",")",["T_WHITESPACE","\n\t\t",229],"{",["T_WHITESPACE","\n\t\t\t",230],["T_VARIABLE","$params",231],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",231],"]",["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],["T_STRING","strtolower",231],"(",["T_VARIABLE","$params",231],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",231],"]",")",";",["T_WHITESPACE","\n\t\t\t",231],["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","_cipher_alias",232],"(",["T_VARIABLE","$params",232],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",232],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",232],["T_IF","if",234],["T_WHITESPACE"," ",234],"(",["T_WHITESPACE"," ",234],"!",["T_WHITESPACE"," ",234],["T_STRING","in_array",234],"(",["T_VARIABLE","$params",234],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",234],"]",",",["T_WHITESPACE"," ",234],["T_STRING","mcrypt_list_algorithms",234],"(",")",",",["T_WHITESPACE"," ",234],["T_STRING","TRUE",234],")",")",["T_WHITESPACE","\n\t\t\t",234],"{",["T_WHITESPACE","\n\t\t\t\t",235],["T_STRING","log_message",236],"(",["T_CONSTANT_ENCAPSED_STRING","'error'",236],",",["T_WHITESPACE"," ",236],["T_CONSTANT_ENCAPSED_STRING","'Encryption: MCrypt cipher '",236],".",["T_STRING","strtoupper",236],"(",["T_VARIABLE","$params",236],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",236],"]",")",".",["T_CONSTANT_ENCAPSED_STRING","' is not available.'",236],")",";",["T_WHITESPACE","\n\t\t\t",236],"}",["T_WHITESPACE","\n\t\t\t",237],["T_ELSE","else",238],["T_WHITESPACE","\n\t\t\t",238],"{",["T_WHITESPACE","\n\t\t\t\t",239],["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","_cipher",240],["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],["T_VARIABLE","$params",240],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",240],"]",";",["T_WHITESPACE","\n\t\t\t",240],"}",["T_WHITESPACE","\n\t\t",241],"}",["T_WHITESPACE","\n\n\t\t",242],["T_IF","if",244],["T_WHITESPACE"," ",244],"(",["T_WHITESPACE"," ",244],"!",["T_WHITESPACE"," ",244],["T_EMPTY","empty",244],"(",["T_VARIABLE","$params",244],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",244],"]",")",")",["T_WHITESPACE","\n\t\t",244],"{",["T_WHITESPACE","\n\t\t\t",245],["T_VARIABLE","$params",246],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",246],"]",["T_WHITESPACE"," ",246],"=",["T_WHITESPACE"," ",246],["T_STRING","strtolower",246],"(",["T_VARIABLE","$params",246],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",246],"]",")",";",["T_WHITESPACE","\n\t\t\t",246],["T_IF","if",247],["T_WHITESPACE"," ",247],"(",["T_WHITESPACE"," ",247],"!",["T_WHITESPACE"," ",247],["T_ISSET","isset",247],"(",["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","_modes",247],"[",["T_CONSTANT_ENCAPSED_STRING","'mcrypt'",247],"]","[",["T_VARIABLE","$params",247],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",247],"]","]",")",")",["T_WHITESPACE","\n\t\t\t",247],"{",["T_WHITESPACE","\n\t\t\t\t",248],["T_STRING","log_message",249],"(",["T_CONSTANT_ENCAPSED_STRING","'error'",249],",",["T_WHITESPACE"," ",249],["T_CONSTANT_ENCAPSED_STRING","'Encryption: MCrypt mode '",249],".",["T_STRING","strtoupper",249],"(",["T_VARIABLE","$params",249],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",249],"]",")",".",["T_CONSTANT_ENCAPSED_STRING","' is not available.'",249],")",";",["T_WHITESPACE","\n\t\t\t",249],"}",["T_WHITESPACE","\n\t\t\t",250],["T_ELSE","else",251],["T_WHITESPACE","\n\t\t\t",251],"{",["T_WHITESPACE","\n\t\t\t\t",252],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","_mode",253],["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","_modes",253],"[",["T_CONSTANT_ENCAPSED_STRING","'mcrypt'",253],"]","[",["T_VARIABLE","$params",253],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",253],"]","]",";",["T_WHITESPACE","\n\t\t\t",253],"}",["T_WHITESPACE","\n\t\t",254],"}",["T_WHITESPACE","\n\n\t\t",255],["T_IF","if",257],["T_WHITESPACE"," ",257],"(",["T_ISSET","isset",257],"(",["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","_cipher",257],",",["T_WHITESPACE"," ",257],["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","_mode",257],")",")",["T_WHITESPACE","\n\t\t",257],"{",["T_WHITESPACE","\n\t\t\t",258],["T_IF","if",259],["T_WHITESPACE"," ",259],"(",["T_STRING","is_resource",259],"(",["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","_handle",259],")",["T_WHITESPACE","\n\t\t\t\t",259],["T_BOOLEAN_AND","&&",260],["T_WHITESPACE"," ",260],"(",["T_STRING","strtolower",260],"(",["T_STRING","mcrypt_enc_get_algorithms_name",260],"(",["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","_handle",260],")",")",["T_WHITESPACE"," ",260],["T_IS_NOT_IDENTICAL","!==",260],["T_WHITESPACE"," ",260],["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","_cipher",260],["T_WHITESPACE","\n\t\t\t\t\t",260],["T_LOGICAL_OR","OR",261],["T_WHITESPACE"," ",261],["T_STRING","strtolower",261],"(",["T_STRING","mcrypt_enc_get_modes_name",261],"(",["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","_handle",261],")",")",["T_WHITESPACE"," ",261],["T_IS_NOT_IDENTICAL","!==",261],["T_WHITESPACE"," ",261],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","_mode",261],")",["T_WHITESPACE","\n\t\t\t",261],")",["T_WHITESPACE","\n\t\t\t",262],"{",["T_WHITESPACE","\n\t\t\t\t",263],["T_STRING","mcrypt_module_close",264],"(",["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","_handle",264],")",";",["T_WHITESPACE","\n\t\t\t",264],"}",["T_WHITESPACE","\n\n\t\t\t",265],["T_IF","if",267],["T_WHITESPACE"," ",267],"(",["T_VARIABLE","$this",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","_handle",267],["T_WHITESPACE"," ",267],"=",["T_WHITESPACE"," ",267],["T_STRING","mcrypt_module_open",267],"(",["T_VARIABLE","$this",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","_cipher",267],",",["T_WHITESPACE"," ",267],["T_CONSTANT_ENCAPSED_STRING","''",267],",",["T_WHITESPACE"," ",267],["T_VARIABLE","$this",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","_mode",267],",",["T_WHITESPACE"," ",267],["T_CONSTANT_ENCAPSED_STRING","''",267],")",")",["T_WHITESPACE","\n\t\t\t",267],"{",["T_WHITESPACE","\n\t\t\t\t",268],["T_STRING","log_message",269],"(",["T_CONSTANT_ENCAPSED_STRING","'info'",269],",",["T_WHITESPACE"," ",269],["T_CONSTANT_ENCAPSED_STRING","'Encryption: MCrypt cipher '",269],".",["T_STRING","strtoupper",269],"(",["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","_cipher",269],")",".",["T_CONSTANT_ENCAPSED_STRING","' initialized in '",269],".",["T_STRING","strtoupper",269],"(",["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","_mode",269],")",".",["T_CONSTANT_ENCAPSED_STRING","' mode.'",269],")",";",["T_WHITESPACE","\n\t\t\t",269],"}",["T_WHITESPACE","\n\t\t\t",270],["T_ELSE","else",271],["T_WHITESPACE","\n\t\t\t",271],"{",["T_WHITESPACE","\n\t\t\t\t",272],["T_STRING","log_message",273],"(",["T_CONSTANT_ENCAPSED_STRING","'error'",273],",",["T_WHITESPACE"," ",273],["T_CONSTANT_ENCAPSED_STRING","'Encryption: Unable to initialize MCrypt with cipher '",273],".",["T_STRING","strtoupper",273],"(",["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","_cipher",273],")",".",["T_CONSTANT_ENCAPSED_STRING","' in '",273],".",["T_STRING","strtoupper",273],"(",["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","_mode",273],")",".",["T_CONSTANT_ENCAPSED_STRING","' mode.'",273],")",";",["T_WHITESPACE","\n\t\t\t",273],"}",["T_WHITESPACE","\n\t\t",274],"}",["T_WHITESPACE","\n\t",275],"}",["T_WHITESPACE","\n\n\t",276],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",278],["T_WHITESPACE","\n\t",279],["T_DOC_COMMENT","\/**\n\t * Initialize OpenSSL\n\t *\n\t * @param\tarray\t$params\tConfiguration parameters\n\t * @return\tvoid\n\t *\/",280],["T_WHITESPACE","\n\t",285],["T_PROTECTED","protected",286],["T_WHITESPACE"," ",286],["T_FUNCTION","function",286],["T_WHITESPACE"," ",286],["T_STRING","_openssl_initialize",286],"(",["T_VARIABLE","$params",286],")",["T_WHITESPACE","\n\t",286],"{",["T_WHITESPACE","\n\t\t",287],["T_IF","if",288],["T_WHITESPACE"," ",288],"(",["T_WHITESPACE"," ",288],"!",["T_WHITESPACE"," ",288],["T_EMPTY","empty",288],"(",["T_VARIABLE","$params",288],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",288],"]",")",")",["T_WHITESPACE","\n\t\t",288],"{",["T_WHITESPACE","\n\t\t\t",289],["T_VARIABLE","$params",290],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",290],"]",["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],["T_STRING","strtolower",290],"(",["T_VARIABLE","$params",290],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",290],"]",")",";",["T_WHITESPACE","\n\t\t\t",290],["T_VARIABLE","$this",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","_cipher_alias",291],"(",["T_VARIABLE","$params",291],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",291],"]",")",";",["T_WHITESPACE","\n\t\t\t",291],["T_VARIABLE","$this",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","_cipher",292],["T_WHITESPACE"," ",292],"=",["T_WHITESPACE"," ",292],["T_VARIABLE","$params",292],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",292],"]",";",["T_WHITESPACE","\n\t\t",292],"}",["T_WHITESPACE","\n\n\t\t",293],["T_IF","if",295],["T_WHITESPACE"," ",295],"(",["T_WHITESPACE"," ",295],"!",["T_WHITESPACE"," ",295],["T_EMPTY","empty",295],"(",["T_VARIABLE","$params",295],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",295],"]",")",")",["T_WHITESPACE","\n\t\t",295],"{",["T_WHITESPACE","\n\t\t\t",296],["T_VARIABLE","$params",297],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",297],"]",["T_WHITESPACE"," ",297],"=",["T_WHITESPACE"," ",297],["T_STRING","strtolower",297],"(",["T_VARIABLE","$params",297],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",297],"]",")",";",["T_WHITESPACE","\n\t\t\t",297],["T_IF","if",298],["T_WHITESPACE"," ",298],"(",["T_WHITESPACE"," ",298],"!",["T_WHITESPACE"," ",298],["T_ISSET","isset",298],"(",["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","_modes",298],"[",["T_CONSTANT_ENCAPSED_STRING","'openssl'",298],"]","[",["T_VARIABLE","$params",298],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",298],"]","]",")",")",["T_WHITESPACE","\n\t\t\t",298],"{",["T_WHITESPACE","\n\t\t\t\t",299],["T_STRING","log_message",300],"(",["T_CONSTANT_ENCAPSED_STRING","'error'",300],",",["T_WHITESPACE"," ",300],["T_CONSTANT_ENCAPSED_STRING","'Encryption: OpenSSL mode '",300],".",["T_STRING","strtoupper",300],"(",["T_VARIABLE","$params",300],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",300],"]",")",".",["T_CONSTANT_ENCAPSED_STRING","' is not available.'",300],")",";",["T_WHITESPACE","\n\t\t\t",300],"}",["T_WHITESPACE","\n\t\t\t",301],["T_ELSE","else",302],["T_WHITESPACE","\n\t\t\t",302],"{",["T_WHITESPACE","\n\t\t\t\t",303],["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","_mode",304],["T_WHITESPACE"," ",304],"=",["T_WHITESPACE"," ",304],["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","_modes",304],"[",["T_CONSTANT_ENCAPSED_STRING","'openssl'",304],"]","[",["T_VARIABLE","$params",304],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",304],"]","]",";",["T_WHITESPACE","\n\t\t\t",304],"}",["T_WHITESPACE","\n\t\t",305],"}",["T_WHITESPACE","\n\n\t\t",306],["T_IF","if",308],["T_WHITESPACE"," ",308],"(",["T_ISSET","isset",308],"(",["T_VARIABLE","$this",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","_cipher",308],",",["T_WHITESPACE"," ",308],["T_VARIABLE","$this",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","_mode",308],")",")",["T_WHITESPACE","\n\t\t",308],"{",["T_WHITESPACE","\n\t\t\t",309],["T_COMMENT","\/\/ This is mostly for the stream mode, which doesn't get suffixed in OpenSSL\n",310],["T_WHITESPACE","\t\t\t",311],["T_VARIABLE","$handle",311],["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],["T_EMPTY","empty",311],"(",["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","_mode",311],")",["T_WHITESPACE","\n\t\t\t\t",311],"?",["T_WHITESPACE"," ",312],["T_VARIABLE","$this",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","_cipher",312],["T_WHITESPACE","\n\t\t\t\t",312],":",["T_WHITESPACE"," ",313],["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","_cipher",313],".",["T_CONSTANT_ENCAPSED_STRING","'-'",313],".",["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","_mode",313],";",["T_WHITESPACE","\n\n\t\t\t",313],["T_IF","if",315],["T_WHITESPACE"," ",315],"(",["T_WHITESPACE"," ",315],"!",["T_WHITESPACE"," ",315],["T_STRING","in_array",315],"(",["T_VARIABLE","$handle",315],",",["T_WHITESPACE"," ",315],["T_STRING","openssl_get_cipher_methods",315],"(",")",",",["T_WHITESPACE"," ",315],["T_STRING","TRUE",315],")",")",["T_WHITESPACE","\n\t\t\t",315],"{",["T_WHITESPACE","\n\t\t\t\t",316],["T_VARIABLE","$this",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","_handle",317],["T_WHITESPACE"," ",317],"=",["T_WHITESPACE"," ",317],["T_STRING","NULL",317],";",["T_WHITESPACE","\n\t\t\t\t",317],["T_STRING","log_message",318],"(",["T_CONSTANT_ENCAPSED_STRING","'error'",318],",",["T_WHITESPACE"," ",318],["T_CONSTANT_ENCAPSED_STRING","'Encryption: Unable to initialize OpenSSL with method '",318],".",["T_STRING","strtoupper",318],"(",["T_VARIABLE","$handle",318],")",".",["T_CONSTANT_ENCAPSED_STRING","'.'",318],")",";",["T_WHITESPACE","\n\t\t\t",318],"}",["T_WHITESPACE","\n\t\t\t",319],["T_ELSE","else",320],["T_WHITESPACE","\n\t\t\t",320],"{",["T_WHITESPACE","\n\t\t\t\t",321],["T_VARIABLE","$this",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","_handle",322],["T_WHITESPACE"," ",322],"=",["T_WHITESPACE"," ",322],["T_VARIABLE","$handle",322],";",["T_WHITESPACE","\n\t\t\t\t",322],["T_STRING","log_message",323],"(",["T_CONSTANT_ENCAPSED_STRING","'info'",323],",",["T_WHITESPACE"," ",323],["T_CONSTANT_ENCAPSED_STRING","'Encryption: OpenSSL initialized with method '",323],".",["T_STRING","strtoupper",323],"(",["T_VARIABLE","$handle",323],")",".",["T_CONSTANT_ENCAPSED_STRING","'.'",323],")",";",["T_WHITESPACE","\n\t\t\t",323],"}",["T_WHITESPACE","\n\t\t",324],"}",["T_WHITESPACE","\n\t",325],"}",["T_WHITESPACE","\n\n\t",326],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",328],["T_WHITESPACE","\n\t",329],["T_DOC_COMMENT","\/**\n\t * Create a random key\n\t *\n\t * @param\tint\t$length\tOutput length\n\t * @return\tstring\n\t *\/",330],["T_WHITESPACE","\n\t",335],["T_PUBLIC","public",336],["T_WHITESPACE"," ",336],["T_FUNCTION","function",336],["T_WHITESPACE"," ",336],["T_STRING","create_key",336],"(",["T_VARIABLE","$length",336],")",["T_WHITESPACE","\n\t",336],"{",["T_WHITESPACE","\n\t\t",337],["T_IF","if",338],["T_WHITESPACE"," ",338],"(",["T_STRING","function_exists",338],"(",["T_CONSTANT_ENCAPSED_STRING","'random_bytes'",338],")",")",["T_WHITESPACE","\n\t\t",338],"{",["T_WHITESPACE","\n\t\t\t",339],["T_TRY","try",340],["T_WHITESPACE","\n\t\t\t",340],"{",["T_WHITESPACE","\n\t\t\t\t",341],["T_RETURN","return",342],["T_WHITESPACE"," ",342],["T_STRING","random_bytes",342],"(",["T_INT_CAST","(int)",342],["T_WHITESPACE"," ",342],["T_VARIABLE","$length",342],")",";",["T_WHITESPACE","\n\t\t\t",342],"}",["T_WHITESPACE","\n\t\t\t",343],["T_CATCH","catch",344],["T_WHITESPACE"," ",344],"(",["T_STRING","Exception",344],["T_WHITESPACE"," ",344],["T_VARIABLE","$e",344],")",["T_WHITESPACE","\n\t\t\t",344],"{",["T_WHITESPACE","\n\t\t\t\t",345],["T_STRING","log_message",346],"(",["T_CONSTANT_ENCAPSED_STRING","'error'",346],",",["T_WHITESPACE"," ",346],["T_VARIABLE","$e",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","getMessage",346],"(",")",")",";",["T_WHITESPACE","\n\t\t\t\t",346],["T_RETURN","return",347],["T_WHITESPACE"," ",347],["T_STRING","FALSE",347],";",["T_WHITESPACE","\n\t\t\t",347],"}",["T_WHITESPACE","\n\t\t",348],"}",["T_WHITESPACE","\n\t\t",349],["T_ELSEIF","elseif",350],["T_WHITESPACE"," ",350],"(",["T_STRING","defined",350],"(",["T_CONSTANT_ENCAPSED_STRING","'MCRYPT_DEV_URANDOM'",350],")",")",["T_WHITESPACE","\n\t\t",350],"{",["T_WHITESPACE","\n\t\t\t",351],["T_RETURN","return",352],["T_WHITESPACE"," ",352],["T_STRING","mcrypt_create_iv",352],"(",["T_VARIABLE","$length",352],",",["T_WHITESPACE"," ",352],["T_STRING","MCRYPT_DEV_URANDOM",352],")",";",["T_WHITESPACE","\n\t\t",352],"}",["T_WHITESPACE","\n\n\t\t",353],["T_VARIABLE","$is_secure",355],["T_WHITESPACE"," ",355],"=",["T_WHITESPACE"," ",355],["T_STRING","NULL",355],";",["T_WHITESPACE","\n\t\t",355],["T_VARIABLE","$key",356],["T_WHITESPACE"," ",356],"=",["T_WHITESPACE"," ",356],["T_STRING","openssl_random_pseudo_bytes",356],"(",["T_VARIABLE","$length",356],",",["T_WHITESPACE"," ",356],["T_VARIABLE","$is_secure",356],")",";",["T_WHITESPACE","\n\t\t",356],["T_RETURN","return",357],["T_WHITESPACE"," ",357],"(",["T_VARIABLE","$is_secure",357],["T_WHITESPACE"," ",357],["T_IS_IDENTICAL","===",357],["T_WHITESPACE"," ",357],["T_STRING","TRUE",357],")",["T_WHITESPACE","\n\t\t\t",357],"?",["T_WHITESPACE"," ",358],["T_VARIABLE","$key",358],["T_WHITESPACE","\n\t\t\t",358],":",["T_WHITESPACE"," ",359],["T_STRING","FALSE",359],";",["T_WHITESPACE","\n\t",359],"}",["T_WHITESPACE","\n\n\t",360],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",362],["T_WHITESPACE","\n\t",363],["T_DOC_COMMENT","\/**\n\t * Encrypt\n\t *\n\t * @param\tstring\t$data\tInput data\n\t * @param\tarray\t$params\tInput parameters\n\t * @return\tstring\n\t *\/",364],["T_WHITESPACE","\n\t",370],["T_PUBLIC","public",371],["T_WHITESPACE"," ",371],["T_FUNCTION","function",371],["T_WHITESPACE"," ",371],["T_STRING","encrypt",371],"(",["T_VARIABLE","$data",371],",",["T_WHITESPACE"," ",371],["T_ARRAY","array",371],["T_WHITESPACE"," ",371],["T_VARIABLE","$params",371],["T_WHITESPACE"," ",371],"=",["T_WHITESPACE"," ",371],["T_STRING","NULL",371],")",["T_WHITESPACE","\n\t",371],"{",["T_WHITESPACE","\n\t\t",372],["T_IF","if",373],["T_WHITESPACE"," ",373],"(","(",["T_VARIABLE","$params",373],["T_WHITESPACE"," ",373],"=",["T_WHITESPACE"," ",373],["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","_get_params",373],"(",["T_VARIABLE","$params",373],")",")",["T_WHITESPACE"," ",373],["T_IS_IDENTICAL","===",373],["T_WHITESPACE"," ",373],["T_STRING","FALSE",373],")",["T_WHITESPACE","\n\t\t",373],"{",["T_WHITESPACE","\n\t\t\t",374],["T_RETURN","return",375],["T_WHITESPACE"," ",375],["T_STRING","FALSE",375],";",["T_WHITESPACE","\n\t\t",375],"}",["T_WHITESPACE","\n\n\t\t",376],["T_ISSET","isset",378],"(",["T_VARIABLE","$params",378],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",378],"]",")",["T_WHITESPACE"," ",378],["T_LOGICAL_OR","OR",378],["T_WHITESPACE"," ",378],["T_VARIABLE","$params",378],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",378],"]",["T_WHITESPACE"," ",378],"=",["T_WHITESPACE"," ",378],["T_VARIABLE","$this",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","hkdf",378],"(",["T_VARIABLE","$this",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","_key",378],",",["T_WHITESPACE"," ",378],["T_CONSTANT_ENCAPSED_STRING","'sha512'",378],",",["T_WHITESPACE"," ",378],["T_STRING","NULL",378],",",["T_WHITESPACE"," ",378],["T_STRING","self",378],["T_DOUBLE_COLON","::",378],["T_STRING","strlen",378],"(",["T_VARIABLE","$this",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","_key",378],")",",",["T_WHITESPACE"," ",378],["T_CONSTANT_ENCAPSED_STRING","'encryption'",378],")",";",["T_WHITESPACE","\n\n\t\t",378],["T_IF","if",380],["T_WHITESPACE"," ",380],"(","(",["T_VARIABLE","$data",380],["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],["T_VARIABLE","$this",380],["T_OBJECT_OPERATOR","->",380],"{",["T_CONSTANT_ENCAPSED_STRING","'_'",380],".",["T_VARIABLE","$this",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","_driver",380],".",["T_CONSTANT_ENCAPSED_STRING","'_encrypt'",380],"}","(",["T_VARIABLE","$data",380],",",["T_WHITESPACE"," ",380],["T_VARIABLE","$params",380],")",")",["T_WHITESPACE"," ",380],["T_IS_IDENTICAL","===",380],["T_WHITESPACE"," ",380],["T_STRING","FALSE",380],")",["T_WHITESPACE","\n\t\t",380],"{",["T_WHITESPACE","\n\t\t\t",381],["T_RETURN","return",382],["T_WHITESPACE"," ",382],["T_STRING","FALSE",382],";",["T_WHITESPACE","\n\t\t",382],"}",["T_WHITESPACE","\n\n\t\t",383],["T_VARIABLE","$params",385],"[",["T_CONSTANT_ENCAPSED_STRING","'base64'",385],"]",["T_WHITESPACE"," ",385],["T_BOOLEAN_AND","&&",385],["T_WHITESPACE"," ",385],["T_VARIABLE","$data",385],["T_WHITESPACE"," ",385],"=",["T_WHITESPACE"," ",385],["T_STRING","base64_encode",385],"(",["T_VARIABLE","$data",385],")",";",["T_WHITESPACE","\n\n\t\t",385],["T_IF","if",387],["T_WHITESPACE"," ",387],"(",["T_ISSET","isset",387],"(",["T_VARIABLE","$params",387],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_digest'",387],"]",")",")",["T_WHITESPACE","\n\t\t",387],"{",["T_WHITESPACE","\n\t\t\t",388],["T_ISSET","isset",389],"(",["T_VARIABLE","$params",389],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_key'",389],"]",")",["T_WHITESPACE"," ",389],["T_LOGICAL_OR","OR",389],["T_WHITESPACE"," ",389],["T_VARIABLE","$params",389],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_key'",389],"]",["T_WHITESPACE"," ",389],"=",["T_WHITESPACE"," ",389],["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","hkdf",389],"(",["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","_key",389],",",["T_WHITESPACE"," ",389],["T_CONSTANT_ENCAPSED_STRING","'sha512'",389],",",["T_WHITESPACE"," ",389],["T_STRING","NULL",389],",",["T_WHITESPACE"," ",389],["T_STRING","NULL",389],",",["T_WHITESPACE"," ",389],["T_CONSTANT_ENCAPSED_STRING","'authentication'",389],")",";",["T_WHITESPACE","\n\t\t\t",389],["T_RETURN","return",390],["T_WHITESPACE"," ",390],["T_STRING","hash_hmac",390],"(",["T_VARIABLE","$params",390],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_digest'",390],"]",",",["T_WHITESPACE"," ",390],["T_VARIABLE","$data",390],",",["T_WHITESPACE"," ",390],["T_VARIABLE","$params",390],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_key'",390],"]",",",["T_WHITESPACE"," ",390],"!",["T_WHITESPACE"," ",390],["T_VARIABLE","$params",390],"[",["T_CONSTANT_ENCAPSED_STRING","'base64'",390],"]",")",".",["T_VARIABLE","$data",390],";",["T_WHITESPACE","\n\t\t",390],"}",["T_WHITESPACE","\n\n\t\t",391],["T_RETURN","return",393],["T_WHITESPACE"," ",393],["T_VARIABLE","$data",393],";",["T_WHITESPACE","\n\t",393],"}",["T_WHITESPACE","\n\n\t",394],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",396],["T_WHITESPACE","\n\t",397],["T_DOC_COMMENT","\/**\n\t * Encrypt via MCrypt\n\t *\n\t * @param\tstring\t$data\tInput data\n\t * @param\tarray\t$params\tInput parameters\n\t * @return\tstring\n\t *\/",398],["T_WHITESPACE","\n\t",404],["T_PROTECTED","protected",405],["T_WHITESPACE"," ",405],["T_FUNCTION","function",405],["T_WHITESPACE"," ",405],["T_STRING","_mcrypt_encrypt",405],"(",["T_VARIABLE","$data",405],",",["T_WHITESPACE"," ",405],["T_VARIABLE","$params",405],")",["T_WHITESPACE","\n\t",405],"{",["T_WHITESPACE","\n\t\t",406],["T_IF","if",407],["T_WHITESPACE"," ",407],"(",["T_WHITESPACE"," ",407],"!",["T_WHITESPACE"," ",407],["T_STRING","is_resource",407],"(",["T_VARIABLE","$params",407],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",407],"]",")",")",["T_WHITESPACE","\n\t\t",407],"{",["T_WHITESPACE","\n\t\t\t",408],["T_RETURN","return",409],["T_WHITESPACE"," ",409],["T_STRING","FALSE",409],";",["T_WHITESPACE","\n\t\t",409],"}",["T_WHITESPACE","\n\n\t\t",410],["T_COMMENT","\/\/ The greater-than-1 comparison is mostly a work-around for a bug,\n",412],["T_WHITESPACE","\t\t",413],["T_COMMENT","\/\/ where 1 is returned for ARCFour instead of 0.\n",413],["T_WHITESPACE","\t\t",414],["T_VARIABLE","$iv",414],["T_WHITESPACE"," ",414],"=",["T_WHITESPACE"," ",414],"(","(",["T_VARIABLE","$iv_size",414],["T_WHITESPACE"," ",414],"=",["T_WHITESPACE"," ",414],["T_STRING","mcrypt_enc_get_iv_size",414],"(",["T_VARIABLE","$params",414],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",414],"]",")",")",["T_WHITESPACE"," ",414],">",["T_WHITESPACE"," ",414],["T_LNUMBER","1",414],")",["T_WHITESPACE","\n\t\t\t",414],"?",["T_WHITESPACE"," ",415],["T_VARIABLE","$this",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","create_key",415],"(",["T_VARIABLE","$iv_size",415],")",["T_WHITESPACE","\n\t\t\t",415],":",["T_WHITESPACE"," ",416],["T_STRING","NULL",416],";",["T_WHITESPACE","\n\n\t\t",416],["T_IF","if",418],["T_WHITESPACE"," ",418],"(",["T_STRING","mcrypt_generic_init",418],"(",["T_VARIABLE","$params",418],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",418],"]",",",["T_WHITESPACE"," ",418],["T_VARIABLE","$params",418],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",418],"]",",",["T_WHITESPACE"," ",418],["T_VARIABLE","$iv",418],")",["T_WHITESPACE"," ",418],"<",["T_WHITESPACE"," ",418],["T_LNUMBER","0",418],")",["T_WHITESPACE","\n\t\t",418],"{",["T_WHITESPACE","\n\t\t\t",419],["T_IF","if",420],["T_WHITESPACE"," ",420],"(",["T_VARIABLE","$params",420],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",420],"]",["T_WHITESPACE"," ",420],["T_IS_NOT_IDENTICAL","!==",420],["T_WHITESPACE"," ",420],["T_VARIABLE","$this",420],["T_OBJECT_OPERATOR","->",420],["T_STRING","_handle",420],")",["T_WHITESPACE","\n\t\t\t",420],"{",["T_WHITESPACE","\n\t\t\t\t",421],["T_STRING","mcrypt_module_close",422],"(",["T_VARIABLE","$params",422],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",422],"]",")",";",["T_WHITESPACE","\n\t\t\t",422],"}",["T_WHITESPACE","\n\n\t\t\t",423],["T_RETURN","return",425],["T_WHITESPACE"," ",425],["T_STRING","FALSE",425],";",["T_WHITESPACE","\n\t\t",425],"}",["T_WHITESPACE","\n\n\t\t",426],["T_COMMENT","\/\/ Use PKCS#7 padding in order to ensure compatibility with OpenSSL\n",428],["T_WHITESPACE","\t\t",429],["T_COMMENT","\/\/ and other implementations outside of PHP.\n",429],["T_WHITESPACE","\t\t",430],["T_IF","if",430],["T_WHITESPACE"," ",430],"(",["T_STRING","in_array",430],"(",["T_STRING","strtolower",430],"(",["T_STRING","mcrypt_enc_get_modes_name",430],"(",["T_VARIABLE","$params",430],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",430],"]",")",")",",",["T_WHITESPACE"," ",430],["T_ARRAY","array",430],"(",["T_CONSTANT_ENCAPSED_STRING","'cbc'",430],",",["T_WHITESPACE"," ",430],["T_CONSTANT_ENCAPSED_STRING","'ecb'",430],")",",",["T_WHITESPACE"," ",430],["T_STRING","TRUE",430],")",")",["T_WHITESPACE","\n\t\t",430],"{",["T_WHITESPACE","\n\t\t\t",431],["T_VARIABLE","$block_size",432],["T_WHITESPACE"," ",432],"=",["T_WHITESPACE"," ",432],["T_STRING","mcrypt_enc_get_block_size",432],"(",["T_VARIABLE","$params",432],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",432],"]",")",";",["T_WHITESPACE","\n\t\t\t",432],["T_VARIABLE","$pad",433],["T_WHITESPACE"," ",433],"=",["T_WHITESPACE"," ",433],["T_VARIABLE","$block_size",433],["T_WHITESPACE"," ",433],"-",["T_WHITESPACE"," ",433],"(",["T_STRING","self",433],["T_DOUBLE_COLON","::",433],["T_STRING","strlen",433],"(",["T_VARIABLE","$data",433],")",["T_WHITESPACE"," ",433],"%",["T_WHITESPACE"," ",433],["T_VARIABLE","$block_size",433],")",";",["T_WHITESPACE","\n\t\t\t",433],["T_VARIABLE","$data",434],["T_WHITESPACE"," ",434],["T_CONCAT_EQUAL",".=",434],["T_WHITESPACE"," ",434],["T_STRING","str_repeat",434],"(",["T_STRING","chr",434],"(",["T_VARIABLE","$pad",434],")",",",["T_WHITESPACE"," ",434],["T_VARIABLE","$pad",434],")",";",["T_WHITESPACE","\n\t\t",434],"}",["T_WHITESPACE","\n\n\t\t",435],["T_COMMENT","\/\/ Work-around for yet another strange behavior in MCrypt.\n",437],["T_WHITESPACE","\t\t",438],["T_COMMENT","\/\/\n",438],["T_WHITESPACE","\t\t",439],["T_COMMENT","\/\/ When encrypting in ECB mode, the IV is ignored. Yet\n",439],["T_WHITESPACE","\t\t",440],["T_COMMENT","\/\/ mcrypt_enc_get_iv_size() returns a value larger than 0\n",440],["T_WHITESPACE","\t\t",441],["T_COMMENT","\/\/ even if ECB is used AND mcrypt_generic_init() complains\n",441],["T_WHITESPACE","\t\t",442],["T_COMMENT","\/\/ if you don't pass an IV with length equal to the said\n",442],["T_WHITESPACE","\t\t",443],["T_COMMENT","\/\/ return value.\n",443],["T_WHITESPACE","\t\t",444],["T_COMMENT","\/\/\n",444],["T_WHITESPACE","\t\t",445],["T_COMMENT","\/\/ This probably would've been fine (even though still wasteful),\n",445],["T_WHITESPACE","\t\t",446],["T_COMMENT","\/\/ but OpenSSL isn't that dumb and we need to make the process\n",446],["T_WHITESPACE","\t\t",447],["T_COMMENT","\/\/ portable, so ...\n",447],["T_WHITESPACE","\t\t",448],["T_VARIABLE","$data",448],["T_WHITESPACE"," ",448],"=",["T_WHITESPACE"," ",448],"(",["T_STRING","mcrypt_enc_get_modes_name",448],"(",["T_VARIABLE","$params",448],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",448],"]",")",["T_WHITESPACE"," ",448],["T_IS_NOT_IDENTICAL","!==",448],["T_WHITESPACE"," ",448],["T_CONSTANT_ENCAPSED_STRING","'ECB'",448],")",["T_WHITESPACE","\n\t\t\t",448],"?",["T_WHITESPACE"," ",449],["T_VARIABLE","$iv",449],".",["T_STRING","mcrypt_generic",449],"(",["T_VARIABLE","$params",449],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",449],"]",",",["T_WHITESPACE"," ",449],["T_VARIABLE","$data",449],")",["T_WHITESPACE","\n\t\t\t",449],":",["T_WHITESPACE"," ",450],["T_STRING","mcrypt_generic",450],"(",["T_VARIABLE","$params",450],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",450],"]",",",["T_WHITESPACE"," ",450],["T_VARIABLE","$data",450],")",";",["T_WHITESPACE","\n\n\t\t",450],["T_STRING","mcrypt_generic_deinit",452],"(",["T_VARIABLE","$params",452],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",452],"]",")",";",["T_WHITESPACE","\n\t\t",452],["T_IF","if",453],["T_WHITESPACE"," ",453],"(",["T_VARIABLE","$params",453],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",453],"]",["T_WHITESPACE"," ",453],["T_IS_NOT_IDENTICAL","!==",453],["T_WHITESPACE"," ",453],["T_VARIABLE","$this",453],["T_OBJECT_OPERATOR","->",453],["T_STRING","_handle",453],")",["T_WHITESPACE","\n\t\t",453],"{",["T_WHITESPACE","\n\t\t\t",454],["T_STRING","mcrypt_module_close",455],"(",["T_VARIABLE","$params",455],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",455],"]",")",";",["T_WHITESPACE","\n\t\t",455],"}",["T_WHITESPACE","\n\n\t\t",456],["T_RETURN","return",458],["T_WHITESPACE"," ",458],["T_VARIABLE","$data",458],";",["T_WHITESPACE","\n\t",458],"}",["T_WHITESPACE","\n\n\t",459],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",461],["T_WHITESPACE","\n\t",462],["T_DOC_COMMENT","\/**\n\t * Encrypt via OpenSSL\n\t *\n\t * @param\tstring\t$data\tInput data\n\t * @param\tarray\t$params\tInput parameters\n\t * @return\tstring\n\t *\/",463],["T_WHITESPACE","\n\t",469],["T_PROTECTED","protected",470],["T_WHITESPACE"," ",470],["T_FUNCTION","function",470],["T_WHITESPACE"," ",470],["T_STRING","_openssl_encrypt",470],"(",["T_VARIABLE","$data",470],",",["T_WHITESPACE"," ",470],["T_VARIABLE","$params",470],")",["T_WHITESPACE","\n\t",470],"{",["T_WHITESPACE","\n\t\t",471],["T_IF","if",472],["T_WHITESPACE"," ",472],"(",["T_EMPTY","empty",472],"(",["T_VARIABLE","$params",472],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",472],"]",")",")",["T_WHITESPACE","\n\t\t",472],"{",["T_WHITESPACE","\n\t\t\t",473],["T_RETURN","return",474],["T_WHITESPACE"," ",474],["T_STRING","FALSE",474],";",["T_WHITESPACE","\n\t\t",474],"}",["T_WHITESPACE","\n\n\t\t",475],["T_VARIABLE","$iv",477],["T_WHITESPACE"," ",477],"=",["T_WHITESPACE"," ",477],"(",["T_VARIABLE","$iv_size",477],["T_WHITESPACE"," ",477],"=",["T_WHITESPACE"," ",477],["T_STRING","openssl_cipher_iv_length",477],"(",["T_VARIABLE","$params",477],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",477],"]",")",")",["T_WHITESPACE","\n\t\t\t",477],"?",["T_WHITESPACE"," ",478],["T_VARIABLE","$this",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","create_key",478],"(",["T_VARIABLE","$iv_size",478],")",["T_WHITESPACE","\n\t\t\t",478],":",["T_WHITESPACE"," ",479],["T_STRING","NULL",479],";",["T_WHITESPACE","\n\n\t\t",479],["T_VARIABLE","$data",481],["T_WHITESPACE"," ",481],"=",["T_WHITESPACE"," ",481],["T_STRING","openssl_encrypt",481],"(",["T_WHITESPACE","\n\t\t\t",481],["T_VARIABLE","$data",482],",",["T_WHITESPACE","\n\t\t\t",482],["T_VARIABLE","$params",483],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",483],"]",",",["T_WHITESPACE","\n\t\t\t",483],["T_VARIABLE","$params",484],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",484],"]",",",["T_WHITESPACE","\n\t\t\t",484],["T_STRING","OPENSSL_RAW_DATA",485],",",["T_WHITESPACE","\n\t\t\t",485],["T_VARIABLE","$iv",486],["T_WHITESPACE","\n\t\t",486],")",";",["T_WHITESPACE","\n\n\t\t",487],["T_IF","if",489],["T_WHITESPACE"," ",489],"(",["T_VARIABLE","$data",489],["T_WHITESPACE"," ",489],["T_IS_IDENTICAL","===",489],["T_WHITESPACE"," ",489],["T_STRING","FALSE",489],")",["T_WHITESPACE","\n\t\t",489],"{",["T_WHITESPACE","\n\t\t\t",490],["T_RETURN","return",491],["T_WHITESPACE"," ",491],["T_STRING","FALSE",491],";",["T_WHITESPACE","\n\t\t",491],"}",["T_WHITESPACE","\n\n\t\t",492],["T_RETURN","return",494],["T_WHITESPACE"," ",494],["T_VARIABLE","$iv",494],".",["T_VARIABLE","$data",494],";",["T_WHITESPACE","\n\t",494],"}",["T_WHITESPACE","\n\n\t",495],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",497],["T_WHITESPACE","\n\t",498],["T_DOC_COMMENT","\/**\n\t * Decrypt\n\t *\n\t * @param\tstring\t$data\tEncrypted data\n\t * @param\tarray\t$params\tInput parameters\n\t * @return\tstring\n\t *\/",499],["T_WHITESPACE","\n\t",505],["T_PUBLIC","public",506],["T_WHITESPACE"," ",506],["T_FUNCTION","function",506],["T_WHITESPACE"," ",506],["T_STRING","decrypt",506],"(",["T_VARIABLE","$data",506],",",["T_WHITESPACE"," ",506],["T_ARRAY","array",506],["T_WHITESPACE"," ",506],["T_VARIABLE","$params",506],["T_WHITESPACE"," ",506],"=",["T_WHITESPACE"," ",506],["T_STRING","NULL",506],")",["T_WHITESPACE","\n\t",506],"{",["T_WHITESPACE","\n\t\t",507],["T_IF","if",508],["T_WHITESPACE"," ",508],"(","(",["T_VARIABLE","$params",508],["T_WHITESPACE"," ",508],"=",["T_WHITESPACE"," ",508],["T_VARIABLE","$this",508],["T_OBJECT_OPERATOR","->",508],["T_STRING","_get_params",508],"(",["T_VARIABLE","$params",508],")",")",["T_WHITESPACE"," ",508],["T_IS_IDENTICAL","===",508],["T_WHITESPACE"," ",508],["T_STRING","FALSE",508],")",["T_WHITESPACE","\n\t\t",508],"{",["T_WHITESPACE","\n\t\t\t",509],["T_RETURN","return",510],["T_WHITESPACE"," ",510],["T_STRING","FALSE",510],";",["T_WHITESPACE","\n\t\t",510],"}",["T_WHITESPACE","\n\n\t\t",511],["T_IF","if",513],["T_WHITESPACE"," ",513],"(",["T_ISSET","isset",513],"(",["T_VARIABLE","$params",513],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_digest'",513],"]",")",")",["T_WHITESPACE","\n\t\t",513],"{",["T_WHITESPACE","\n\t\t\t",514],["T_COMMENT","\/\/ This might look illogical, but it is done during encryption as well ...\n",515],["T_WHITESPACE","\t\t\t",516],["T_COMMENT","\/\/ The 'base64' value is effectively an inverted \"raw data\" parameter\n",516],["T_WHITESPACE","\t\t\t",517],["T_VARIABLE","$digest_size",517],["T_WHITESPACE"," ",517],"=",["T_WHITESPACE"," ",517],"(",["T_VARIABLE","$params",517],"[",["T_CONSTANT_ENCAPSED_STRING","'base64'",517],"]",")",["T_WHITESPACE","\n\t\t\t\t",517],"?",["T_WHITESPACE"," ",518],["T_VARIABLE","$this",518],["T_OBJECT_OPERATOR","->",518],["T_STRING","_digests",518],"[",["T_VARIABLE","$params",518],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_digest'",518],"]","]",["T_WHITESPACE"," ",518],"*",["T_WHITESPACE"," ",518],["T_LNUMBER","2",518],["T_WHITESPACE","\n\t\t\t\t",518],":",["T_WHITESPACE"," ",519],["T_VARIABLE","$this",519],["T_OBJECT_OPERATOR","->",519],["T_STRING","_digests",519],"[",["T_VARIABLE","$params",519],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_digest'",519],"]","]",";",["T_WHITESPACE","\n\n\t\t\t",519],["T_IF","if",521],["T_WHITESPACE"," ",521],"(",["T_STRING","self",521],["T_DOUBLE_COLON","::",521],["T_STRING","strlen",521],"(",["T_VARIABLE","$data",521],")",["T_WHITESPACE"," ",521],["T_IS_SMALLER_OR_EQUAL","<=",521],["T_WHITESPACE"," ",521],["T_VARIABLE","$digest_size",521],")",["T_WHITESPACE","\n\t\t\t",521],"{",["T_WHITESPACE","\n\t\t\t\t",522],["T_RETURN","return",523],["T_WHITESPACE"," ",523],["T_STRING","FALSE",523],";",["T_WHITESPACE","\n\t\t\t",523],"}",["T_WHITESPACE","\n\n\t\t\t",524],["T_VARIABLE","$hmac_input",526],["T_WHITESPACE"," ",526],"=",["T_WHITESPACE"," ",526],["T_STRING","self",526],["T_DOUBLE_COLON","::",526],["T_STRING","substr",526],"(",["T_VARIABLE","$data",526],",",["T_WHITESPACE"," ",526],["T_LNUMBER","0",526],",",["T_WHITESPACE"," ",526],["T_VARIABLE","$digest_size",526],")",";",["T_WHITESPACE","\n\t\t\t",526],["T_VARIABLE","$data",527],["T_WHITESPACE"," ",527],"=",["T_WHITESPACE"," ",527],["T_STRING","self",527],["T_DOUBLE_COLON","::",527],["T_STRING","substr",527],"(",["T_VARIABLE","$data",527],",",["T_WHITESPACE"," ",527],["T_VARIABLE","$digest_size",527],")",";",["T_WHITESPACE","\n\n\t\t\t",527],["T_ISSET","isset",529],"(",["T_VARIABLE","$params",529],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_key'",529],"]",")",["T_WHITESPACE"," ",529],["T_LOGICAL_OR","OR",529],["T_WHITESPACE"," ",529],["T_VARIABLE","$params",529],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_key'",529],"]",["T_WHITESPACE"," ",529],"=",["T_WHITESPACE"," ",529],["T_VARIABLE","$this",529],["T_OBJECT_OPERATOR","->",529],["T_STRING","hkdf",529],"(",["T_VARIABLE","$this",529],["T_OBJECT_OPERATOR","->",529],["T_STRING","_key",529],",",["T_WHITESPACE"," ",529],["T_CONSTANT_ENCAPSED_STRING","'sha512'",529],",",["T_WHITESPACE"," ",529],["T_STRING","NULL",529],",",["T_WHITESPACE"," ",529],["T_STRING","NULL",529],",",["T_WHITESPACE"," ",529],["T_CONSTANT_ENCAPSED_STRING","'authentication'",529],")",";",["T_WHITESPACE","\n\t\t\t",529],["T_VARIABLE","$hmac_check",530],["T_WHITESPACE"," ",530],"=",["T_WHITESPACE"," ",530],["T_STRING","hash_hmac",530],"(",["T_VARIABLE","$params",530],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_digest'",530],"]",",",["T_WHITESPACE"," ",530],["T_VARIABLE","$data",530],",",["T_WHITESPACE"," ",530],["T_VARIABLE","$params",530],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_key'",530],"]",",",["T_WHITESPACE"," ",530],"!",["T_WHITESPACE"," ",530],["T_VARIABLE","$params",530],"[",["T_CONSTANT_ENCAPSED_STRING","'base64'",530],"]",")",";",["T_WHITESPACE","\n\n\t\t\t",530],["T_COMMENT","\/\/ Time-attack-safe comparison\n",532],["T_WHITESPACE","\t\t\t",533],["T_VARIABLE","$diff",533],["T_WHITESPACE"," ",533],"=",["T_WHITESPACE"," ",533],["T_LNUMBER","0",533],";",["T_WHITESPACE","\n\t\t\t",533],["T_FOR","for",534],["T_WHITESPACE"," ",534],"(",["T_VARIABLE","$i",534],["T_WHITESPACE"," ",534],"=",["T_WHITESPACE"," ",534],["T_LNUMBER","0",534],";",["T_WHITESPACE"," ",534],["T_VARIABLE","$i",534],["T_WHITESPACE"," ",534],"<",["T_WHITESPACE"," ",534],["T_VARIABLE","$digest_size",534],";",["T_WHITESPACE"," ",534],["T_VARIABLE","$i",534],["T_INC","++",534],")",["T_WHITESPACE","\n\t\t\t",534],"{",["T_WHITESPACE","\n\t\t\t\t",535],["T_VARIABLE","$diff",536],["T_WHITESPACE"," ",536],["T_OR_EQUAL","|=",536],["T_WHITESPACE"," ",536],["T_STRING","ord",536],"(",["T_VARIABLE","$hmac_input",536],"[",["T_VARIABLE","$i",536],"]",")",["T_WHITESPACE"," ",536],"^",["T_WHITESPACE"," ",536],["T_STRING","ord",536],"(",["T_VARIABLE","$hmac_check",536],"[",["T_VARIABLE","$i",536],"]",")",";",["T_WHITESPACE","\n\t\t\t",536],"}",["T_WHITESPACE","\n\n\t\t\t",537],["T_IF","if",539],["T_WHITESPACE"," ",539],"(",["T_VARIABLE","$diff",539],["T_WHITESPACE"," ",539],["T_IS_NOT_IDENTICAL","!==",539],["T_WHITESPACE"," ",539],["T_LNUMBER","0",539],")",["T_WHITESPACE","\n\t\t\t",539],"{",["T_WHITESPACE","\n\t\t\t\t",540],["T_RETURN","return",541],["T_WHITESPACE"," ",541],["T_STRING","FALSE",541],";",["T_WHITESPACE","\n\t\t\t",541],"}",["T_WHITESPACE","\n\t\t",542],"}",["T_WHITESPACE","\n\n\t\t",543],["T_IF","if",545],["T_WHITESPACE"," ",545],"(",["T_VARIABLE","$params",545],"[",["T_CONSTANT_ENCAPSED_STRING","'base64'",545],"]",")",["T_WHITESPACE","\n\t\t",545],"{",["T_WHITESPACE","\n\t\t\t",546],["T_VARIABLE","$data",547],["T_WHITESPACE"," ",547],"=",["T_WHITESPACE"," ",547],["T_STRING","base64_decode",547],"(",["T_VARIABLE","$data",547],")",";",["T_WHITESPACE","\n\t\t",547],"}",["T_WHITESPACE","\n\n\t\t",548],["T_ISSET","isset",550],"(",["T_VARIABLE","$params",550],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",550],"]",")",["T_WHITESPACE"," ",550],["T_LOGICAL_OR","OR",550],["T_WHITESPACE"," ",550],["T_VARIABLE","$params",550],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",550],"]",["T_WHITESPACE"," ",550],"=",["T_WHITESPACE"," ",550],["T_VARIABLE","$this",550],["T_OBJECT_OPERATOR","->",550],["T_STRING","hkdf",550],"(",["T_VARIABLE","$this",550],["T_OBJECT_OPERATOR","->",550],["T_STRING","_key",550],",",["T_WHITESPACE"," ",550],["T_CONSTANT_ENCAPSED_STRING","'sha512'",550],",",["T_WHITESPACE"," ",550],["T_STRING","NULL",550],",",["T_WHITESPACE"," ",550],["T_STRING","self",550],["T_DOUBLE_COLON","::",550],["T_STRING","strlen",550],"(",["T_VARIABLE","$this",550],["T_OBJECT_OPERATOR","->",550],["T_STRING","_key",550],")",",",["T_WHITESPACE"," ",550],["T_CONSTANT_ENCAPSED_STRING","'encryption'",550],")",";",["T_WHITESPACE","\n\n\t\t",550],["T_RETURN","return",552],["T_WHITESPACE"," ",552],["T_VARIABLE","$this",552],["T_OBJECT_OPERATOR","->",552],"{",["T_CONSTANT_ENCAPSED_STRING","'_'",552],".",["T_VARIABLE","$this",552],["T_OBJECT_OPERATOR","->",552],["T_STRING","_driver",552],".",["T_CONSTANT_ENCAPSED_STRING","'_decrypt'",552],"}","(",["T_VARIABLE","$data",552],",",["T_WHITESPACE"," ",552],["T_VARIABLE","$params",552],")",";",["T_WHITESPACE","\n\t",552],"}",["T_WHITESPACE","\n\n\t",553],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",555],["T_WHITESPACE","\n\t",556],["T_DOC_COMMENT","\/**\n\t * Decrypt via MCrypt\n\t *\n\t * @param\tstring\t$data\tEncrypted data\n\t * @param\tarray\t$params\tInput parameters\n\t * @return\tstring\n\t *\/",557],["T_WHITESPACE","\n\t",563],["T_PROTECTED","protected",564],["T_WHITESPACE"," ",564],["T_FUNCTION","function",564],["T_WHITESPACE"," ",564],["T_STRING","_mcrypt_decrypt",564],"(",["T_VARIABLE","$data",564],",",["T_WHITESPACE"," ",564],["T_VARIABLE","$params",564],")",["T_WHITESPACE","\n\t",564],"{",["T_WHITESPACE","\n\t\t",565],["T_IF","if",566],["T_WHITESPACE"," ",566],"(",["T_WHITESPACE"," ",566],"!",["T_WHITESPACE"," ",566],["T_STRING","is_resource",566],"(",["T_VARIABLE","$params",566],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",566],"]",")",")",["T_WHITESPACE","\n\t\t",566],"{",["T_WHITESPACE","\n\t\t\t",567],["T_RETURN","return",568],["T_WHITESPACE"," ",568],["T_STRING","FALSE",568],";",["T_WHITESPACE","\n\t\t",568],"}",["T_WHITESPACE","\n\n\t\t",569],["T_COMMENT","\/\/ The greater-than-1 comparison is mostly a work-around for a bug,\n",571],["T_WHITESPACE","\t\t",572],["T_COMMENT","\/\/ where 1 is returned for ARCFour instead of 0.\n",572],["T_WHITESPACE","\t\t",573],["T_IF","if",573],["T_WHITESPACE"," ",573],"(","(",["T_VARIABLE","$iv_size",573],["T_WHITESPACE"," ",573],"=",["T_WHITESPACE"," ",573],["T_STRING","mcrypt_enc_get_iv_size",573],"(",["T_VARIABLE","$params",573],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",573],"]",")",")",["T_WHITESPACE"," ",573],">",["T_WHITESPACE"," ",573],["T_LNUMBER","1",573],")",["T_WHITESPACE","\n\t\t",573],"{",["T_WHITESPACE","\n\t\t\t",574],["T_IF","if",575],["T_WHITESPACE"," ",575],"(",["T_STRING","mcrypt_enc_get_modes_name",575],"(",["T_VARIABLE","$params",575],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",575],"]",")",["T_WHITESPACE"," ",575],["T_IS_NOT_IDENTICAL","!==",575],["T_WHITESPACE"," ",575],["T_CONSTANT_ENCAPSED_STRING","'ECB'",575],")",["T_WHITESPACE","\n\t\t\t",575],"{",["T_WHITESPACE","\n\t\t\t\t",576],["T_VARIABLE","$iv",577],["T_WHITESPACE"," ",577],"=",["T_WHITESPACE"," ",577],["T_STRING","self",577],["T_DOUBLE_COLON","::",577],["T_STRING","substr",577],"(",["T_VARIABLE","$data",577],",",["T_WHITESPACE"," ",577],["T_LNUMBER","0",577],",",["T_WHITESPACE"," ",577],["T_VARIABLE","$iv_size",577],")",";",["T_WHITESPACE","\n\t\t\t\t",577],["T_VARIABLE","$data",578],["T_WHITESPACE"," ",578],"=",["T_WHITESPACE"," ",578],["T_STRING","self",578],["T_DOUBLE_COLON","::",578],["T_STRING","substr",578],"(",["T_VARIABLE","$data",578],",",["T_WHITESPACE"," ",578],["T_VARIABLE","$iv_size",578],")",";",["T_WHITESPACE","\n\t\t\t",578],"}",["T_WHITESPACE","\n\t\t\t",579],["T_ELSE","else",580],["T_WHITESPACE","\n\t\t\t",580],"{",["T_WHITESPACE","\n\t\t\t\t",581],["T_COMMENT","\/\/ MCrypt is dumb and this is ignored, only size matters\n",582],["T_WHITESPACE","\t\t\t\t",583],["T_VARIABLE","$iv",583],["T_WHITESPACE"," ",583],"=",["T_WHITESPACE"," ",583],["T_STRING","str_repeat",583],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\x0\"",583],",",["T_WHITESPACE"," ",583],["T_VARIABLE","$iv_size",583],")",";",["T_WHITESPACE","\n\t\t\t",583],"}",["T_WHITESPACE","\n\t\t",584],"}",["T_WHITESPACE","\n\t\t",585],["T_ELSE","else",586],["T_WHITESPACE","\n\t\t",586],"{",["T_WHITESPACE","\n\t\t\t",587],["T_VARIABLE","$iv",588],["T_WHITESPACE"," ",588],"=",["T_WHITESPACE"," ",588],["T_STRING","NULL",588],";",["T_WHITESPACE","\n\t\t",588],"}",["T_WHITESPACE","\n\n\t\t",589],["T_IF","if",591],["T_WHITESPACE"," ",591],"(",["T_STRING","mcrypt_generic_init",591],"(",["T_VARIABLE","$params",591],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",591],"]",",",["T_WHITESPACE"," ",591],["T_VARIABLE","$params",591],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",591],"]",",",["T_WHITESPACE"," ",591],["T_VARIABLE","$iv",591],")",["T_WHITESPACE"," ",591],"<",["T_WHITESPACE"," ",591],["T_LNUMBER","0",591],")",["T_WHITESPACE","\n\t\t",591],"{",["T_WHITESPACE","\n\t\t\t",592],["T_IF","if",593],["T_WHITESPACE"," ",593],"(",["T_VARIABLE","$params",593],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",593],"]",["T_WHITESPACE"," ",593],["T_IS_NOT_IDENTICAL","!==",593],["T_WHITESPACE"," ",593],["T_VARIABLE","$this",593],["T_OBJECT_OPERATOR","->",593],["T_STRING","_handle",593],")",["T_WHITESPACE","\n\t\t\t",593],"{",["T_WHITESPACE","\n\t\t\t\t",594],["T_STRING","mcrypt_module_close",595],"(",["T_VARIABLE","$params",595],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",595],"]",")",";",["T_WHITESPACE","\n\t\t\t",595],"}",["T_WHITESPACE","\n\n\t\t\t",596],["T_RETURN","return",598],["T_WHITESPACE"," ",598],["T_STRING","FALSE",598],";",["T_WHITESPACE","\n\t\t",598],"}",["T_WHITESPACE","\n\n\t\t",599],["T_VARIABLE","$data",601],["T_WHITESPACE"," ",601],"=",["T_WHITESPACE"," ",601],["T_STRING","mdecrypt_generic",601],"(",["T_VARIABLE","$params",601],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",601],"]",",",["T_WHITESPACE"," ",601],["T_VARIABLE","$data",601],")",";",["T_WHITESPACE","\n\t\t",601],["T_COMMENT","\/\/ Remove PKCS#7 padding, if necessary\n",602],["T_WHITESPACE","\t\t",603],["T_IF","if",603],["T_WHITESPACE"," ",603],"(",["T_STRING","in_array",603],"(",["T_STRING","strtolower",603],"(",["T_STRING","mcrypt_enc_get_modes_name",603],"(",["T_VARIABLE","$params",603],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",603],"]",")",")",",",["T_WHITESPACE"," ",603],["T_ARRAY","array",603],"(",["T_CONSTANT_ENCAPSED_STRING","'cbc'",603],",",["T_WHITESPACE"," ",603],["T_CONSTANT_ENCAPSED_STRING","'ecb'",603],")",",",["T_WHITESPACE"," ",603],["T_STRING","TRUE",603],")",")",["T_WHITESPACE","\n\t\t",603],"{",["T_WHITESPACE","\n\t\t\t",604],["T_VARIABLE","$data",605],["T_WHITESPACE"," ",605],"=",["T_WHITESPACE"," ",605],["T_STRING","self",605],["T_DOUBLE_COLON","::",605],["T_STRING","substr",605],"(",["T_VARIABLE","$data",605],",",["T_WHITESPACE"," ",605],["T_LNUMBER","0",605],",",["T_WHITESPACE"," ",605],"-",["T_STRING","ord",605],"(",["T_VARIABLE","$data",605],"[",["T_STRING","self",605],["T_DOUBLE_COLON","::",605],["T_STRING","strlen",605],"(",["T_VARIABLE","$data",605],")","-",["T_LNUMBER","1",605],"]",")",")",";",["T_WHITESPACE","\n\t\t",605],"}",["T_WHITESPACE","\n\n\t\t",606],["T_STRING","mcrypt_generic_deinit",608],"(",["T_VARIABLE","$params",608],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",608],"]",")",";",["T_WHITESPACE","\n\t\t",608],["T_IF","if",609],["T_WHITESPACE"," ",609],"(",["T_VARIABLE","$params",609],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",609],"]",["T_WHITESPACE"," ",609],["T_IS_NOT_IDENTICAL","!==",609],["T_WHITESPACE"," ",609],["T_VARIABLE","$this",609],["T_OBJECT_OPERATOR","->",609],["T_STRING","_handle",609],")",["T_WHITESPACE","\n\t\t",609],"{",["T_WHITESPACE","\n\t\t\t",610],["T_STRING","mcrypt_module_close",611],"(",["T_VARIABLE","$params",611],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",611],"]",")",";",["T_WHITESPACE","\n\t\t",611],"}",["T_WHITESPACE","\n\n\t\t",612],["T_RETURN","return",614],["T_WHITESPACE"," ",614],["T_VARIABLE","$data",614],";",["T_WHITESPACE","\n\t",614],"}",["T_WHITESPACE","\n\n\t",615],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",617],["T_WHITESPACE","\n\t",618],["T_DOC_COMMENT","\/**\n\t * Decrypt via OpenSSL\n\t *\n\t * @param\tstring\t$data\tEncrypted data\n\t * @param\tarray\t$params\tInput parameters\n\t * @return\tstring\n\t *\/",619],["T_WHITESPACE","\n\t",625],["T_PROTECTED","protected",626],["T_WHITESPACE"," ",626],["T_FUNCTION","function",626],["T_WHITESPACE"," ",626],["T_STRING","_openssl_decrypt",626],"(",["T_VARIABLE","$data",626],",",["T_WHITESPACE"," ",626],["T_VARIABLE","$params",626],")",["T_WHITESPACE","\n\t",626],"{",["T_WHITESPACE","\n\t\t",627],["T_IF","if",628],["T_WHITESPACE"," ",628],"(",["T_VARIABLE","$iv_size",628],["T_WHITESPACE"," ",628],"=",["T_WHITESPACE"," ",628],["T_STRING","openssl_cipher_iv_length",628],"(",["T_VARIABLE","$params",628],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",628],"]",")",")",["T_WHITESPACE","\n\t\t",628],"{",["T_WHITESPACE","\n\t\t\t",629],["T_VARIABLE","$iv",630],["T_WHITESPACE"," ",630],"=",["T_WHITESPACE"," ",630],["T_STRING","self",630],["T_DOUBLE_COLON","::",630],["T_STRING","substr",630],"(",["T_VARIABLE","$data",630],",",["T_WHITESPACE"," ",630],["T_LNUMBER","0",630],",",["T_WHITESPACE"," ",630],["T_VARIABLE","$iv_size",630],")",";",["T_WHITESPACE","\n\t\t\t",630],["T_VARIABLE","$data",631],["T_WHITESPACE"," ",631],"=",["T_WHITESPACE"," ",631],["T_STRING","self",631],["T_DOUBLE_COLON","::",631],["T_STRING","substr",631],"(",["T_VARIABLE","$data",631],",",["T_WHITESPACE"," ",631],["T_VARIABLE","$iv_size",631],")",";",["T_WHITESPACE","\n\t\t",631],"}",["T_WHITESPACE","\n\t\t",632],["T_ELSE","else",633],["T_WHITESPACE","\n\t\t",633],"{",["T_WHITESPACE","\n\t\t\t",634],["T_VARIABLE","$iv",635],["T_WHITESPACE"," ",635],"=",["T_WHITESPACE"," ",635],["T_STRING","NULL",635],";",["T_WHITESPACE","\n\t\t",635],"}",["T_WHITESPACE","\n\n\t\t",636],["T_RETURN","return",638],["T_WHITESPACE"," ",638],["T_EMPTY","empty",638],"(",["T_VARIABLE","$params",638],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",638],"]",")",["T_WHITESPACE","\n\t\t\t",638],"?",["T_WHITESPACE"," ",639],["T_STRING","FALSE",639],["T_WHITESPACE","\n\t\t\t",639],":",["T_WHITESPACE"," ",640],["T_STRING","openssl_decrypt",640],"(",["T_WHITESPACE","\n\t\t\t\t",640],["T_VARIABLE","$data",641],",",["T_WHITESPACE","\n\t\t\t\t",641],["T_VARIABLE","$params",642],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",642],"]",",",["T_WHITESPACE","\n\t\t\t\t",642],["T_VARIABLE","$params",643],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",643],"]",",",["T_WHITESPACE","\n\t\t\t\t",643],["T_STRING","OPENSSL_RAW_DATA",644],",",["T_WHITESPACE","\n\t\t\t\t",644],["T_VARIABLE","$iv",645],["T_WHITESPACE","\n\t\t\t",645],")",";",["T_WHITESPACE","\n\t",646],"}",["T_WHITESPACE","\n\n\t",647],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",649],["T_WHITESPACE","\n\t",650],["T_DOC_COMMENT","\/**\n\t * Get params\n\t *\n\t * @param\tarray\t$params\tInput parameters\n\t * @return\tarray\n\t *\/",651],["T_WHITESPACE","\n\t",656],["T_PROTECTED","protected",657],["T_WHITESPACE"," ",657],["T_FUNCTION","function",657],["T_WHITESPACE"," ",657],["T_STRING","_get_params",657],"(",["T_VARIABLE","$params",657],")",["T_WHITESPACE","\n\t",657],"{",["T_WHITESPACE","\n\t\t",658],["T_IF","if",659],["T_WHITESPACE"," ",659],"(",["T_EMPTY","empty",659],"(",["T_VARIABLE","$params",659],")",")",["T_WHITESPACE","\n\t\t",659],"{",["T_WHITESPACE","\n\t\t\t",660],["T_RETURN","return",661],["T_WHITESPACE"," ",661],["T_ISSET","isset",661],"(",["T_VARIABLE","$this",661],["T_OBJECT_OPERATOR","->",661],["T_STRING","_cipher",661],",",["T_WHITESPACE"," ",661],["T_VARIABLE","$this",661],["T_OBJECT_OPERATOR","->",661],["T_STRING","_mode",661],",",["T_WHITESPACE"," ",661],["T_VARIABLE","$this",661],["T_OBJECT_OPERATOR","->",661],["T_STRING","_key",661],",",["T_WHITESPACE"," ",661],["T_VARIABLE","$this",661],["T_OBJECT_OPERATOR","->",661],["T_STRING","_handle",661],")",["T_WHITESPACE","\n\t\t\t\t",661],"?",["T_WHITESPACE"," ",662],["T_ARRAY","array",662],"(",["T_WHITESPACE","\n\t\t\t\t\t",662],["T_CONSTANT_ENCAPSED_STRING","'handle'",663],["T_WHITESPACE"," ",663],["T_DOUBLE_ARROW","=>",663],["T_WHITESPACE"," ",663],["T_VARIABLE","$this",663],["T_OBJECT_OPERATOR","->",663],["T_STRING","_handle",663],",",["T_WHITESPACE","\n\t\t\t\t\t",663],["T_CONSTANT_ENCAPSED_STRING","'cipher'",664],["T_WHITESPACE"," ",664],["T_DOUBLE_ARROW","=>",664],["T_WHITESPACE"," ",664],["T_VARIABLE","$this",664],["T_OBJECT_OPERATOR","->",664],["T_STRING","_cipher",664],",",["T_WHITESPACE","\n\t\t\t\t\t",664],["T_CONSTANT_ENCAPSED_STRING","'mode'",665],["T_WHITESPACE"," ",665],["T_DOUBLE_ARROW","=>",665],["T_WHITESPACE"," ",665],["T_VARIABLE","$this",665],["T_OBJECT_OPERATOR","->",665],["T_STRING","_mode",665],",",["T_WHITESPACE","\n\t\t\t\t\t",665],["T_CONSTANT_ENCAPSED_STRING","'key'",666],["T_WHITESPACE"," ",666],["T_DOUBLE_ARROW","=>",666],["T_WHITESPACE"," ",666],["T_STRING","NULL",666],",",["T_WHITESPACE","\n\t\t\t\t\t",666],["T_CONSTANT_ENCAPSED_STRING","'base64'",667],["T_WHITESPACE"," ",667],["T_DOUBLE_ARROW","=>",667],["T_WHITESPACE"," ",667],["T_STRING","TRUE",667],",",["T_WHITESPACE","\n\t\t\t\t\t",667],["T_CONSTANT_ENCAPSED_STRING","'hmac_digest'",668],["T_WHITESPACE"," ",668],["T_DOUBLE_ARROW","=>",668],["T_WHITESPACE"," ",668],["T_CONSTANT_ENCAPSED_STRING","'sha512'",668],",",["T_WHITESPACE","\n\t\t\t\t\t",668],["T_CONSTANT_ENCAPSED_STRING","'hmac_key'",669],["T_WHITESPACE"," ",669],["T_DOUBLE_ARROW","=>",669],["T_WHITESPACE"," ",669],["T_STRING","NULL",669],["T_WHITESPACE","\n\t\t\t\t",669],")",["T_WHITESPACE","\n\t\t\t\t",670],":",["T_WHITESPACE"," ",671],["T_STRING","FALSE",671],";",["T_WHITESPACE","\n\t\t",671],"}",["T_WHITESPACE","\n\t\t",672],["T_ELSEIF","elseif",673],["T_WHITESPACE"," ",673],"(",["T_WHITESPACE"," ",673],"!",["T_WHITESPACE"," ",673],["T_ISSET","isset",673],"(",["T_VARIABLE","$params",673],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",673],"]",",",["T_WHITESPACE"," ",673],["T_VARIABLE","$params",673],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",673],"]",",",["T_WHITESPACE"," ",673],["T_VARIABLE","$params",673],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",673],"]",")",")",["T_WHITESPACE","\n\t\t",673],"{",["T_WHITESPACE","\n\t\t\t",674],["T_RETURN","return",675],["T_WHITESPACE"," ",675],["T_STRING","FALSE",675],";",["T_WHITESPACE","\n\t\t",675],"}",["T_WHITESPACE","\n\n\t\t",676],["T_IF","if",678],["T_WHITESPACE"," ",678],"(",["T_ISSET","isset",678],"(",["T_VARIABLE","$params",678],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",678],"]",")",")",["T_WHITESPACE","\n\t\t",678],"{",["T_WHITESPACE","\n\t\t\t",679],["T_VARIABLE","$params",680],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",680],"]",["T_WHITESPACE"," ",680],"=",["T_WHITESPACE"," ",680],["T_STRING","strtolower",680],"(",["T_VARIABLE","$params",680],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",680],"]",")",";",["T_WHITESPACE","\n\t\t\t",680],["T_IF","if",681],["T_WHITESPACE"," ",681],"(",["T_WHITESPACE"," ",681],"!",["T_WHITESPACE"," ",681],["T_ISSET","isset",681],"(",["T_VARIABLE","$this",681],["T_OBJECT_OPERATOR","->",681],["T_STRING","_modes",681],"[",["T_VARIABLE","$this",681],["T_OBJECT_OPERATOR","->",681],["T_STRING","_driver",681],"]","[",["T_VARIABLE","$params",681],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",681],"]","]",")",")",["T_WHITESPACE","\n\t\t\t",681],"{",["T_WHITESPACE","\n\t\t\t\t",682],["T_RETURN","return",683],["T_WHITESPACE"," ",683],["T_STRING","FALSE",683],";",["T_WHITESPACE","\n\t\t\t",683],"}",["T_WHITESPACE","\n\t\t\t",684],["T_ELSE","else",685],["T_WHITESPACE","\n\t\t\t",685],"{",["T_WHITESPACE","\n\t\t\t\t",686],["T_VARIABLE","$params",687],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",687],"]",["T_WHITESPACE"," ",687],"=",["T_WHITESPACE"," ",687],["T_VARIABLE","$this",687],["T_OBJECT_OPERATOR","->",687],["T_STRING","_modes",687],"[",["T_VARIABLE","$this",687],["T_OBJECT_OPERATOR","->",687],["T_STRING","_driver",687],"]","[",["T_VARIABLE","$params",687],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",687],"]","]",";",["T_WHITESPACE","\n\t\t\t",687],"}",["T_WHITESPACE","\n\t\t",688],"}",["T_WHITESPACE","\n\n\t\t",689],["T_IF","if",691],["T_WHITESPACE"," ",691],"(",["T_ISSET","isset",691],"(",["T_VARIABLE","$params",691],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac'",691],"]",")",["T_WHITESPACE"," ",691],["T_BOOLEAN_AND","&&",691],["T_WHITESPACE"," ",691],["T_VARIABLE","$params",691],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac'",691],"]",["T_WHITESPACE"," ",691],["T_IS_IDENTICAL","===",691],["T_WHITESPACE"," ",691],["T_STRING","FALSE",691],")",["T_WHITESPACE","\n\t\t",691],"{",["T_WHITESPACE","\n\t\t\t",692],["T_VARIABLE","$params",693],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_digest'",693],"]",["T_WHITESPACE"," ",693],"=",["T_WHITESPACE"," ",693],["T_VARIABLE","$params",693],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_key'",693],"]",["T_WHITESPACE"," ",693],"=",["T_WHITESPACE"," ",693],["T_STRING","NULL",693],";",["T_WHITESPACE","\n\t\t",693],"}",["T_WHITESPACE","\n\t\t",694],["T_ELSE","else",695],["T_WHITESPACE","\n\t\t",695],"{",["T_WHITESPACE","\n\t\t\t",696],["T_IF","if",697],["T_WHITESPACE"," ",697],"(",["T_WHITESPACE"," ",697],"!",["T_WHITESPACE"," ",697],["T_ISSET","isset",697],"(",["T_VARIABLE","$params",697],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_key'",697],"]",")",")",["T_WHITESPACE","\n\t\t\t",697],"{",["T_WHITESPACE","\n\t\t\t\t",698],["T_RETURN","return",699],["T_WHITESPACE"," ",699],["T_STRING","FALSE",699],";",["T_WHITESPACE","\n\t\t\t",699],"}",["T_WHITESPACE","\n\t\t\t",700],["T_ELSEIF","elseif",701],["T_WHITESPACE"," ",701],"(",["T_ISSET","isset",701],"(",["T_VARIABLE","$params",701],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_digest'",701],"]",")",")",["T_WHITESPACE","\n\t\t\t",701],"{",["T_WHITESPACE","\n\t\t\t\t",702],["T_VARIABLE","$params",703],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_digest'",703],"]",["T_WHITESPACE"," ",703],"=",["T_WHITESPACE"," ",703],["T_STRING","strtolower",703],"(",["T_VARIABLE","$params",703],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_digest'",703],"]",")",";",["T_WHITESPACE","\n\t\t\t\t",703],["T_IF","if",704],["T_WHITESPACE"," ",704],"(",["T_WHITESPACE"," ",704],"!",["T_WHITESPACE"," ",704],["T_ISSET","isset",704],"(",["T_VARIABLE","$this",704],["T_OBJECT_OPERATOR","->",704],["T_STRING","_digests",704],"[",["T_VARIABLE","$params",704],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_digest'",704],"]","]",")",")",["T_WHITESPACE","\n\t\t\t\t",704],"{",["T_WHITESPACE","\n\t\t\t\t\t",705],["T_RETURN","return",706],["T_WHITESPACE"," ",706],["T_STRING","FALSE",706],";",["T_WHITESPACE","\n\t\t\t\t",706],"}",["T_WHITESPACE","\n\t\t\t",707],"}",["T_WHITESPACE","\n\t\t\t",708],["T_ELSE","else",709],["T_WHITESPACE","\n\t\t\t",709],"{",["T_WHITESPACE","\n\t\t\t\t",710],["T_VARIABLE","$params",711],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_digest'",711],"]",["T_WHITESPACE"," ",711],"=",["T_WHITESPACE"," ",711],["T_CONSTANT_ENCAPSED_STRING","'sha512'",711],";",["T_WHITESPACE","\n\t\t\t",711],"}",["T_WHITESPACE","\n\t\t",712],"}",["T_WHITESPACE","\n\n\t\t",713],["T_VARIABLE","$params",715],["T_WHITESPACE"," ",715],"=",["T_WHITESPACE"," ",715],["T_ARRAY","array",715],"(",["T_WHITESPACE","\n\t\t\t",715],["T_CONSTANT_ENCAPSED_STRING","'handle'",716],["T_WHITESPACE"," ",716],["T_DOUBLE_ARROW","=>",716],["T_WHITESPACE"," ",716],["T_STRING","NULL",716],",",["T_WHITESPACE","\n\t\t\t",716],["T_CONSTANT_ENCAPSED_STRING","'cipher'",717],["T_WHITESPACE"," ",717],["T_DOUBLE_ARROW","=>",717],["T_WHITESPACE"," ",717],["T_VARIABLE","$params",717],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",717],"]",",",["T_WHITESPACE","\n\t\t\t",717],["T_CONSTANT_ENCAPSED_STRING","'mode'",718],["T_WHITESPACE"," ",718],["T_DOUBLE_ARROW","=>",718],["T_WHITESPACE"," ",718],["T_VARIABLE","$params",718],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",718],"]",",",["T_WHITESPACE","\n\t\t\t",718],["T_CONSTANT_ENCAPSED_STRING","'key'",719],["T_WHITESPACE"," ",719],["T_DOUBLE_ARROW","=>",719],["T_WHITESPACE"," ",719],["T_VARIABLE","$params",719],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",719],"]",",",["T_WHITESPACE","\n\t\t\t",719],["T_CONSTANT_ENCAPSED_STRING","'base64'",720],["T_WHITESPACE"," ",720],["T_DOUBLE_ARROW","=>",720],["T_WHITESPACE"," ",720],["T_ISSET","isset",720],"(",["T_VARIABLE","$params",720],"[",["T_CONSTANT_ENCAPSED_STRING","'raw_data'",720],"]",")",["T_WHITESPACE"," ",720],"?",["T_WHITESPACE"," ",720],"!",["T_WHITESPACE"," ",720],["T_VARIABLE","$params",720],"[",["T_CONSTANT_ENCAPSED_STRING","'raw_data'",720],"]",["T_WHITESPACE"," ",720],":",["T_WHITESPACE"," ",720],["T_STRING","FALSE",720],",",["T_WHITESPACE","\n\t\t\t",720],["T_CONSTANT_ENCAPSED_STRING","'hmac_digest'",721],["T_WHITESPACE"," ",721],["T_DOUBLE_ARROW","=>",721],["T_WHITESPACE"," ",721],["T_VARIABLE","$params",721],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_digest'",721],"]",",",["T_WHITESPACE","\n\t\t\t",721],["T_CONSTANT_ENCAPSED_STRING","'hmac_key'",722],["T_WHITESPACE"," ",722],["T_DOUBLE_ARROW","=>",722],["T_WHITESPACE"," ",722],["T_VARIABLE","$params",722],"[",["T_CONSTANT_ENCAPSED_STRING","'hmac_key'",722],"]",["T_WHITESPACE","\n\t\t",722],")",";",["T_WHITESPACE","\n\n\t\t",723],["T_VARIABLE","$this",725],["T_OBJECT_OPERATOR","->",725],["T_STRING","_cipher_alias",725],"(",["T_VARIABLE","$params",725],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",725],"]",")",";",["T_WHITESPACE","\n\t\t",725],["T_VARIABLE","$params",726],"[",["T_CONSTANT_ENCAPSED_STRING","'handle'",726],"]",["T_WHITESPACE"," ",726],"=",["T_WHITESPACE"," ",726],"(",["T_VARIABLE","$params",726],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",726],"]",["T_WHITESPACE"," ",726],["T_IS_NOT_IDENTICAL","!==",726],["T_WHITESPACE"," ",726],["T_VARIABLE","$this",726],["T_OBJECT_OPERATOR","->",726],["T_STRING","_cipher",726],["T_WHITESPACE"," ",726],["T_LOGICAL_OR","OR",726],["T_WHITESPACE"," ",726],["T_VARIABLE","$params",726],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",726],"]",["T_WHITESPACE"," ",726],["T_IS_NOT_IDENTICAL","!==",726],["T_WHITESPACE"," ",726],["T_VARIABLE","$this",726],["T_OBJECT_OPERATOR","->",726],["T_STRING","_mode",726],")",["T_WHITESPACE","\n\t\t\t",726],"?",["T_WHITESPACE"," ",727],["T_VARIABLE","$this",727],["T_OBJECT_OPERATOR","->",727],"{",["T_CONSTANT_ENCAPSED_STRING","'_'",727],".",["T_VARIABLE","$this",727],["T_OBJECT_OPERATOR","->",727],["T_STRING","_driver",727],".",["T_CONSTANT_ENCAPSED_STRING","'_get_handle'",727],"}","(",["T_VARIABLE","$params",727],"[",["T_CONSTANT_ENCAPSED_STRING","'cipher'",727],"]",",",["T_WHITESPACE"," ",727],["T_VARIABLE","$params",727],"[",["T_CONSTANT_ENCAPSED_STRING","'mode'",727],"]",")",["T_WHITESPACE","\n\t\t\t",727],":",["T_WHITESPACE"," ",728],["T_VARIABLE","$this",728],["T_OBJECT_OPERATOR","->",728],["T_STRING","_handle",728],";",["T_WHITESPACE","\n\n\t\t",728],["T_RETURN","return",730],["T_WHITESPACE"," ",730],["T_VARIABLE","$params",730],";",["T_WHITESPACE","\n\t",730],"}",["T_WHITESPACE","\n\n\t",731],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",733],["T_WHITESPACE","\n\t",734],["T_DOC_COMMENT","\/**\n\t * Get MCrypt handle\n\t *\n\t * @param\tstring\t$cipher\tCipher name\n\t * @param\tstring\t$mode\tEncryption mode\n\t * @return\tresource\n\t *\/",735],["T_WHITESPACE","\n\t",741],["T_PROTECTED","protected",742],["T_WHITESPACE"," ",742],["T_FUNCTION","function",742],["T_WHITESPACE"," ",742],["T_STRING","_mcrypt_get_handle",742],"(",["T_VARIABLE","$cipher",742],",",["T_WHITESPACE"," ",742],["T_VARIABLE","$mode",742],")",["T_WHITESPACE","\n\t",742],"{",["T_WHITESPACE","\n\t\t",743],["T_RETURN","return",744],["T_WHITESPACE"," ",744],["T_STRING","mcrypt_module_open",744],"(",["T_VARIABLE","$cipher",744],",",["T_WHITESPACE"," ",744],["T_CONSTANT_ENCAPSED_STRING","''",744],",",["T_WHITESPACE"," ",744],["T_VARIABLE","$mode",744],",",["T_WHITESPACE"," ",744],["T_CONSTANT_ENCAPSED_STRING","''",744],")",";",["T_WHITESPACE","\n\t",744],"}",["T_WHITESPACE","\n\n\t",745],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",747],["T_WHITESPACE","\n\t",748],["T_DOC_COMMENT","\/**\n\t * Get OpenSSL handle\n\t *\n\t * @param\tstring\t$cipher\tCipher name\n\t * @param\tstring\t$mode\tEncryption mode\n\t * @return\tstring\n\t *\/",749],["T_WHITESPACE","\n\t",755],["T_PROTECTED","protected",756],["T_WHITESPACE"," ",756],["T_FUNCTION","function",756],["T_WHITESPACE"," ",756],["T_STRING","_openssl_get_handle",756],"(",["T_VARIABLE","$cipher",756],",",["T_WHITESPACE"," ",756],["T_VARIABLE","$mode",756],")",["T_WHITESPACE","\n\t",756],"{",["T_WHITESPACE","\n\t\t",757],["T_COMMENT","\/\/ OpenSSL methods aren't suffixed with '-stream' for this mode\n",758],["T_WHITESPACE","\t\t",759],["T_RETURN","return",759],["T_WHITESPACE"," ",759],"(",["T_VARIABLE","$mode",759],["T_WHITESPACE"," ",759],["T_IS_IDENTICAL","===",759],["T_WHITESPACE"," ",759],["T_CONSTANT_ENCAPSED_STRING","'stream'",759],")",["T_WHITESPACE","\n\t\t\t",759],"?",["T_WHITESPACE"," ",760],["T_VARIABLE","$cipher",760],["T_WHITESPACE","\n\t\t\t",760],":",["T_WHITESPACE"," ",761],["T_VARIABLE","$cipher",761],".",["T_CONSTANT_ENCAPSED_STRING","'-'",761],".",["T_VARIABLE","$mode",761],";",["T_WHITESPACE","\n\t",761],"}",["T_WHITESPACE","\n\n\t",762],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",764],["T_WHITESPACE","\n\t",765],["T_DOC_COMMENT","\/**\n\t * Cipher alias\n\t *\n\t * Tries to translate cipher names between MCrypt and OpenSSL's \"dialects\".\n\t *\n\t * @param\tstring\t$cipher\tCipher name\n\t * @return\tvoid\n\t *\/",766],["T_WHITESPACE","\n\t",773],["T_PROTECTED","protected",774],["T_WHITESPACE"," ",774],["T_FUNCTION","function",774],["T_WHITESPACE"," ",774],["T_STRING","_cipher_alias",774],"(","&",["T_VARIABLE","$cipher",774],")",["T_WHITESPACE","\n\t",774],"{",["T_WHITESPACE","\n\t\t",775],["T_STATIC","static",776],["T_WHITESPACE"," ",776],["T_VARIABLE","$dictionary",776],";",["T_WHITESPACE","\n\n\t\t",776],["T_IF","if",778],["T_WHITESPACE"," ",778],"(",["T_EMPTY","empty",778],"(",["T_VARIABLE","$dictionary",778],")",")",["T_WHITESPACE","\n\t\t",778],"{",["T_WHITESPACE","\n\t\t\t",779],["T_VARIABLE","$dictionary",780],["T_WHITESPACE"," ",780],"=",["T_WHITESPACE"," ",780],["T_ARRAY","array",780],"(",["T_WHITESPACE","\n\t\t\t\t",780],["T_CONSTANT_ENCAPSED_STRING","'mcrypt'",781],["T_WHITESPACE"," ",781],["T_DOUBLE_ARROW","=>",781],["T_WHITESPACE"," ",781],["T_ARRAY","array",781],"(",["T_WHITESPACE","\n\t\t\t\t\t",781],["T_CONSTANT_ENCAPSED_STRING","'aes-128'",782],["T_WHITESPACE"," ",782],["T_DOUBLE_ARROW","=>",782],["T_WHITESPACE"," ",782],["T_CONSTANT_ENCAPSED_STRING","'rijndael-128'",782],",",["T_WHITESPACE","\n\t\t\t\t\t",782],["T_CONSTANT_ENCAPSED_STRING","'aes-192'",783],["T_WHITESPACE"," ",783],["T_DOUBLE_ARROW","=>",783],["T_WHITESPACE"," ",783],["T_CONSTANT_ENCAPSED_STRING","'rijndael-128'",783],",",["T_WHITESPACE","\n\t\t\t\t\t",783],["T_CONSTANT_ENCAPSED_STRING","'aes-256'",784],["T_WHITESPACE"," ",784],["T_DOUBLE_ARROW","=>",784],["T_WHITESPACE"," ",784],["T_CONSTANT_ENCAPSED_STRING","'rijndael-128'",784],",",["T_WHITESPACE","\n\t\t\t\t\t",784],["T_CONSTANT_ENCAPSED_STRING","'des3-ede3'",785],["T_WHITESPACE"," ",785],["T_DOUBLE_ARROW","=>",785],["T_WHITESPACE"," ",785],["T_CONSTANT_ENCAPSED_STRING","'tripledes'",785],",",["T_WHITESPACE","\n\t\t\t\t\t",785],["T_CONSTANT_ENCAPSED_STRING","'bf'",786],["T_WHITESPACE"," ",786],["T_DOUBLE_ARROW","=>",786],["T_WHITESPACE"," ",786],["T_CONSTANT_ENCAPSED_STRING","'blowfish'",786],",",["T_WHITESPACE","\n\t\t\t\t\t",786],["T_CONSTANT_ENCAPSED_STRING","'cast5'",787],["T_WHITESPACE"," ",787],["T_DOUBLE_ARROW","=>",787],["T_WHITESPACE"," ",787],["T_CONSTANT_ENCAPSED_STRING","'cast-128'",787],",",["T_WHITESPACE","\n\t\t\t\t\t",787],["T_CONSTANT_ENCAPSED_STRING","'rc4'",788],["T_WHITESPACE"," ",788],["T_DOUBLE_ARROW","=>",788],["T_WHITESPACE"," ",788],["T_CONSTANT_ENCAPSED_STRING","'arcfour'",788],",",["T_WHITESPACE","\n\t\t\t\t\t",788],["T_CONSTANT_ENCAPSED_STRING","'rc4-40'",789],["T_WHITESPACE"," ",789],["T_DOUBLE_ARROW","=>",789],["T_WHITESPACE"," ",789],["T_CONSTANT_ENCAPSED_STRING","'arcfour'",789],["T_WHITESPACE","\n\t\t\t\t",789],")",",",["T_WHITESPACE","\n\t\t\t\t",790],["T_CONSTANT_ENCAPSED_STRING","'openssl'",791],["T_WHITESPACE"," ",791],["T_DOUBLE_ARROW","=>",791],["T_WHITESPACE"," ",791],["T_ARRAY","array",791],"(",["T_WHITESPACE","\n\t\t\t\t\t",791],["T_CONSTANT_ENCAPSED_STRING","'rijndael-128'",792],["T_WHITESPACE"," ",792],["T_DOUBLE_ARROW","=>",792],["T_WHITESPACE"," ",792],["T_CONSTANT_ENCAPSED_STRING","'aes-128'",792],",",["T_WHITESPACE","\n\t\t\t\t\t",792],["T_CONSTANT_ENCAPSED_STRING","'tripledes'",793],["T_WHITESPACE"," ",793],["T_DOUBLE_ARROW","=>",793],["T_WHITESPACE"," ",793],["T_CONSTANT_ENCAPSED_STRING","'des-ede3'",793],",",["T_WHITESPACE","\n\t\t\t\t\t",793],["T_CONSTANT_ENCAPSED_STRING","'blowfish'",794],["T_WHITESPACE"," ",794],["T_DOUBLE_ARROW","=>",794],["T_WHITESPACE"," ",794],["T_CONSTANT_ENCAPSED_STRING","'bf'",794],",",["T_WHITESPACE","\n\t\t\t\t\t",794],["T_CONSTANT_ENCAPSED_STRING","'cast-128'",795],["T_WHITESPACE"," ",795],["T_DOUBLE_ARROW","=>",795],["T_WHITESPACE"," ",795],["T_CONSTANT_ENCAPSED_STRING","'cast5'",795],",",["T_WHITESPACE","\n\t\t\t\t\t",795],["T_CONSTANT_ENCAPSED_STRING","'arcfour'",796],["T_WHITESPACE"," ",796],["T_DOUBLE_ARROW","=>",796],["T_WHITESPACE"," ",796],["T_CONSTANT_ENCAPSED_STRING","'rc4-40'",796],",",["T_WHITESPACE","\n\t\t\t\t\t",796],["T_CONSTANT_ENCAPSED_STRING","'rc4'",797],["T_WHITESPACE"," ",797],["T_DOUBLE_ARROW","=>",797],["T_WHITESPACE"," ",797],["T_CONSTANT_ENCAPSED_STRING","'rc4-40'",797],["T_WHITESPACE","\n\t\t\t\t",797],")",["T_WHITESPACE","\n\t\t\t",798],")",";",["T_WHITESPACE","\n\n\t\t\t",799],["T_COMMENT","\/\/ Notes:\n",801],["T_WHITESPACE","\t\t\t",802],["T_COMMENT","\/\/\n",802],["T_WHITESPACE","\t\t\t",803],["T_COMMENT","\/\/ - Rijndael-128 is, at the same time all three of AES-128,\n",803],["T_WHITESPACE","\t\t\t",804],["T_COMMENT","\/\/   AES-192 and AES-256. The only difference between them is\n",804],["T_WHITESPACE","\t\t\t",805],["T_COMMENT","\/\/   the key size. Rijndael-192, Rijndael-256 on the other hand\n",805],["T_WHITESPACE","\t\t\t",806],["T_COMMENT","\/\/   also have different block sizes and are NOT AES-compatible.\n",806],["T_WHITESPACE","\t\t\t",807],["T_COMMENT","\/\/\n",807],["T_WHITESPACE","\t\t\t",808],["T_COMMENT","\/\/ - Blowfish is said to be supporting key sizes between\n",808],["T_WHITESPACE","\t\t\t",809],["T_COMMENT","\/\/   4 and 56 bytes, but it appears that between MCrypt and\n",809],["T_WHITESPACE","\t\t\t",810],["T_COMMENT","\/\/   OpenSSL, only those of 16 and more bytes are compatible.\n",810],["T_WHITESPACE","\t\t\t",811],["T_COMMENT","\/\/   Also, don't know what MCrypt's 'blowfish-compat' is.\n",811],["T_WHITESPACE","\t\t\t",812],["T_COMMENT","\/\/\n",812],["T_WHITESPACE","\t\t\t",813],["T_COMMENT","\/\/ - CAST-128\/CAST5 produces a longer cipher when encrypted via\n",813],["T_WHITESPACE","\t\t\t",814],["T_COMMENT","\/\/   OpenSSL, but (strangely enough) can be decrypted by either\n",814],["T_WHITESPACE","\t\t\t",815],["T_COMMENT","\/\/   extension anyway.\n",815],["T_WHITESPACE","\t\t\t",816],["T_COMMENT","\/\/   Also, it appears that OpenSSL uses 16 rounds regardless of\n",816],["T_WHITESPACE","\t\t\t",817],["T_COMMENT","\/\/   the key size, while RFC2144 says that for key sizes lower\n",817],["T_WHITESPACE","\t\t\t",818],["T_COMMENT","\/\/   than 11 bytes, only 12 rounds should be used. This makes\n",818],["T_WHITESPACE","\t\t\t",819],["T_COMMENT","\/\/   it portable only with keys of between 11 and 16 bytes.\n",819],["T_WHITESPACE","\t\t\t",820],["T_COMMENT","\/\/\n",820],["T_WHITESPACE","\t\t\t",821],["T_COMMENT","\/\/ - RC4 (ARCFour) has a strange implementation under OpenSSL.\n",821],["T_WHITESPACE","\t\t\t",822],["T_COMMENT","\/\/   Its 'rc4-40' cipher method seems to work flawlessly, yet\n",822],["T_WHITESPACE","\t\t\t",823],["T_COMMENT","\/\/   there's another one, 'rc4' that only works with a 16-byte key.\n",823],["T_WHITESPACE","\t\t\t",824],["T_COMMENT","\/\/\n",824],["T_WHITESPACE","\t\t\t",825],["T_COMMENT","\/\/ - DES is compatible, but doesn't need an alias.\n",825],["T_WHITESPACE","\t\t\t",826],["T_COMMENT","\/\/\n",826],["T_WHITESPACE","\t\t\t",827],["T_COMMENT","\/\/ Other seemingly matching ciphers between MCrypt, OpenSSL:\n",827],["T_WHITESPACE","\t\t\t",828],["T_COMMENT","\/\/\n",828],["T_WHITESPACE","\t\t\t",829],["T_COMMENT","\/\/ - RC2 is NOT compatible and only an obscure forum post\n",829],["T_WHITESPACE","\t\t\t",830],["T_COMMENT","\/\/   confirms that it is MCrypt's fault.\n",830],["T_WHITESPACE","\t\t",831],"}",["T_WHITESPACE","\n\n\t\t",831],["T_IF","if",833],["T_WHITESPACE"," ",833],"(",["T_ISSET","isset",833],"(",["T_VARIABLE","$dictionary",833],"[",["T_VARIABLE","$this",833],["T_OBJECT_OPERATOR","->",833],["T_STRING","_driver",833],"]","[",["T_VARIABLE","$cipher",833],"]",")",")",["T_WHITESPACE","\n\t\t",833],"{",["T_WHITESPACE","\n\t\t\t",834],["T_VARIABLE","$cipher",835],["T_WHITESPACE"," ",835],"=",["T_WHITESPACE"," ",835],["T_VARIABLE","$dictionary",835],"[",["T_VARIABLE","$this",835],["T_OBJECT_OPERATOR","->",835],["T_STRING","_driver",835],"]","[",["T_VARIABLE","$cipher",835],"]",";",["T_WHITESPACE","\n\t\t",835],"}",["T_WHITESPACE","\n\t",836],"}",["T_WHITESPACE","\n\n\t",837],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",839],["T_WHITESPACE","\n\t",840],["T_DOC_COMMENT","\/**\n\t * HKDF\n\t *\n\t * @link\thttps:\/\/tools.ietf.org\/rfc\/rfc5869.txt\n\t * @param\t$key\tInput key\n\t * @param\t$digest\tA SHA-2 hashing algorithm\n\t * @param\t$salt\tOptional salt\n\t * @param\t$length\tOutput length (defaults to the selected digest size)\n\t * @param\t$info\tOptional context\/application-specific info\n\t * @return\tstring\tA pseudo-random key\n\t *\/",841],["T_WHITESPACE","\n\t",851],["T_PUBLIC","public",852],["T_WHITESPACE"," ",852],["T_FUNCTION","function",852],["T_WHITESPACE"," ",852],["T_STRING","hkdf",852],"(",["T_VARIABLE","$key",852],",",["T_WHITESPACE"," ",852],["T_VARIABLE","$digest",852],["T_WHITESPACE"," ",852],"=",["T_WHITESPACE"," ",852],["T_CONSTANT_ENCAPSED_STRING","'sha512'",852],",",["T_WHITESPACE"," ",852],["T_VARIABLE","$salt",852],["T_WHITESPACE"," ",852],"=",["T_WHITESPACE"," ",852],["T_STRING","NULL",852],",",["T_WHITESPACE"," ",852],["T_VARIABLE","$length",852],["T_WHITESPACE"," ",852],"=",["T_WHITESPACE"," ",852],["T_STRING","NULL",852],",",["T_WHITESPACE"," ",852],["T_VARIABLE","$info",852],["T_WHITESPACE"," ",852],"=",["T_WHITESPACE"," ",852],["T_CONSTANT_ENCAPSED_STRING","''",852],")",["T_WHITESPACE","\n\t",852],"{",["T_WHITESPACE","\n\t\t",853],["T_IF","if",854],["T_WHITESPACE"," ",854],"(",["T_WHITESPACE"," ",854],"!",["T_WHITESPACE"," ",854],["T_ISSET","isset",854],"(",["T_VARIABLE","$this",854],["T_OBJECT_OPERATOR","->",854],["T_STRING","_digests",854],"[",["T_VARIABLE","$digest",854],"]",")",")",["T_WHITESPACE","\n\t\t",854],"{",["T_WHITESPACE","\n\t\t\t",855],["T_RETURN","return",856],["T_WHITESPACE"," ",856],["T_STRING","FALSE",856],";",["T_WHITESPACE","\n\t\t",856],"}",["T_WHITESPACE","\n\n\t\t",857],["T_IF","if",859],["T_WHITESPACE"," ",859],"(",["T_EMPTY","empty",859],"(",["T_VARIABLE","$length",859],")",["T_WHITESPACE"," ",859],["T_LOGICAL_OR","OR",859],["T_WHITESPACE"," ",859],"!",["T_WHITESPACE"," ",859],["T_STRING","is_int",859],"(",["T_VARIABLE","$length",859],")",")",["T_WHITESPACE","\n\t\t",859],"{",["T_WHITESPACE","\n\t\t\t",860],["T_VARIABLE","$length",861],["T_WHITESPACE"," ",861],"=",["T_WHITESPACE"," ",861],["T_VARIABLE","$this",861],["T_OBJECT_OPERATOR","->",861],["T_STRING","_digests",861],"[",["T_VARIABLE","$digest",861],"]",";",["T_WHITESPACE","\n\t\t",861],"}",["T_WHITESPACE","\n\t\t",862],["T_ELSEIF","elseif",863],["T_WHITESPACE"," ",863],"(",["T_VARIABLE","$length",863],["T_WHITESPACE"," ",863],">",["T_WHITESPACE"," ",863],"(",["T_LNUMBER","255",863],["T_WHITESPACE"," ",863],"*",["T_WHITESPACE"," ",863],["T_VARIABLE","$this",863],["T_OBJECT_OPERATOR","->",863],["T_STRING","_digests",863],"[",["T_VARIABLE","$digest",863],"]",")",")",["T_WHITESPACE","\n\t\t",863],"{",["T_WHITESPACE","\n\t\t\t",864],["T_RETURN","return",865],["T_WHITESPACE"," ",865],["T_STRING","FALSE",865],";",["T_WHITESPACE","\n\t\t",865],"}",["T_WHITESPACE","\n\n\t\t",866],["T_STRING","self",868],["T_DOUBLE_COLON","::",868],["T_STRING","strlen",868],"(",["T_VARIABLE","$salt",868],")",["T_WHITESPACE"," ",868],["T_LOGICAL_OR","OR",868],["T_WHITESPACE"," ",868],["T_VARIABLE","$salt",868],["T_WHITESPACE"," ",868],"=",["T_WHITESPACE"," ",868],["T_STRING","str_repeat",868],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\0\"",868],",",["T_WHITESPACE"," ",868],["T_VARIABLE","$this",868],["T_OBJECT_OPERATOR","->",868],["T_STRING","_digests",868],"[",["T_VARIABLE","$digest",868],"]",")",";",["T_WHITESPACE","\n\n\t\t",868],["T_VARIABLE","$prk",870],["T_WHITESPACE"," ",870],"=",["T_WHITESPACE"," ",870],["T_STRING","hash_hmac",870],"(",["T_VARIABLE","$digest",870],",",["T_WHITESPACE"," ",870],["T_VARIABLE","$key",870],",",["T_WHITESPACE"," ",870],["T_VARIABLE","$salt",870],",",["T_WHITESPACE"," ",870],["T_STRING","TRUE",870],")",";",["T_WHITESPACE","\n\t\t",870],["T_VARIABLE","$key",871],["T_WHITESPACE"," ",871],"=",["T_WHITESPACE"," ",871],["T_CONSTANT_ENCAPSED_STRING","''",871],";",["T_WHITESPACE","\n\t\t",871],["T_FOR","for",872],["T_WHITESPACE"," ",872],"(",["T_VARIABLE","$key_block",872],["T_WHITESPACE"," ",872],"=",["T_WHITESPACE"," ",872],["T_CONSTANT_ENCAPSED_STRING","''",872],",",["T_WHITESPACE"," ",872],["T_VARIABLE","$block_index",872],["T_WHITESPACE"," ",872],"=",["T_WHITESPACE"," ",872],["T_LNUMBER","1",872],";",["T_WHITESPACE"," ",872],["T_STRING","self",872],["T_DOUBLE_COLON","::",872],["T_STRING","strlen",872],"(",["T_VARIABLE","$key",872],")",["T_WHITESPACE"," ",872],"<",["T_WHITESPACE"," ",872],["T_VARIABLE","$length",872],";",["T_WHITESPACE"," ",872],["T_VARIABLE","$block_index",872],["T_INC","++",872],")",["T_WHITESPACE","\n\t\t",872],"{",["T_WHITESPACE","\n\t\t\t",873],["T_VARIABLE","$key_block",874],["T_WHITESPACE"," ",874],"=",["T_WHITESPACE"," ",874],["T_STRING","hash_hmac",874],"(",["T_VARIABLE","$digest",874],",",["T_WHITESPACE"," ",874],["T_VARIABLE","$key_block",874],".",["T_VARIABLE","$info",874],".",["T_STRING","chr",874],"(",["T_VARIABLE","$block_index",874],")",",",["T_WHITESPACE"," ",874],["T_VARIABLE","$prk",874],",",["T_WHITESPACE"," ",874],["T_STRING","TRUE",874],")",";",["T_WHITESPACE","\n\t\t\t",874],["T_VARIABLE","$key",875],["T_WHITESPACE"," ",875],["T_CONCAT_EQUAL",".=",875],["T_WHITESPACE"," ",875],["T_VARIABLE","$key_block",875],";",["T_WHITESPACE","\n\t\t",875],"}",["T_WHITESPACE","\n\n\t\t",876],["T_RETURN","return",878],["T_WHITESPACE"," ",878],["T_STRING","self",878],["T_DOUBLE_COLON","::",878],["T_STRING","substr",878],"(",["T_VARIABLE","$key",878],",",["T_WHITESPACE"," ",878],["T_LNUMBER","0",878],",",["T_WHITESPACE"," ",878],["T_VARIABLE","$length",878],")",";",["T_WHITESPACE","\n\t",878],"}",["T_WHITESPACE","\n\n\t",879],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",881],["T_WHITESPACE","\n\t",882],["T_DOC_COMMENT","\/**\n\t * __get() magic\n\t *\n\t * @param\tstring\t$key\tProperty name\n\t * @return\tmixed\n\t *\/",883],["T_WHITESPACE","\n\t",888],["T_PUBLIC","public",889],["T_WHITESPACE"," ",889],["T_FUNCTION","function",889],["T_WHITESPACE"," ",889],["T_STRING","__get",889],"(",["T_VARIABLE","$key",889],")",["T_WHITESPACE","\n\t",889],"{",["T_WHITESPACE","\n\t\t",890],["T_COMMENT","\/\/ Because aliases\n",891],["T_WHITESPACE","\t\t",892],["T_IF","if",892],["T_WHITESPACE"," ",892],"(",["T_VARIABLE","$key",892],["T_WHITESPACE"," ",892],["T_IS_IDENTICAL","===",892],["T_WHITESPACE"," ",892],["T_CONSTANT_ENCAPSED_STRING","'mode'",892],")",["T_WHITESPACE","\n\t\t",892],"{",["T_WHITESPACE","\n\t\t\t",893],["T_RETURN","return",894],["T_WHITESPACE"," ",894],["T_STRING","array_search",894],"(",["T_VARIABLE","$this",894],["T_OBJECT_OPERATOR","->",894],["T_STRING","_mode",894],",",["T_WHITESPACE"," ",894],["T_VARIABLE","$this",894],["T_OBJECT_OPERATOR","->",894],["T_STRING","_modes",894],"[",["T_VARIABLE","$this",894],["T_OBJECT_OPERATOR","->",894],["T_STRING","_driver",894],"]",",",["T_WHITESPACE"," ",894],["T_STRING","TRUE",894],")",";",["T_WHITESPACE","\n\t\t",894],"}",["T_WHITESPACE","\n\t\t",895],["T_ELSEIF","elseif",896],["T_WHITESPACE"," ",896],"(",["T_STRING","in_array",896],"(",["T_VARIABLE","$key",896],",",["T_WHITESPACE"," ",896],["T_ARRAY","array",896],"(",["T_CONSTANT_ENCAPSED_STRING","'cipher'",896],",",["T_WHITESPACE"," ",896],["T_CONSTANT_ENCAPSED_STRING","'driver'",896],",",["T_WHITESPACE"," ",896],["T_CONSTANT_ENCAPSED_STRING","'drivers'",896],",",["T_WHITESPACE"," ",896],["T_CONSTANT_ENCAPSED_STRING","'digests'",896],")",",",["T_WHITESPACE"," ",896],["T_STRING","TRUE",896],")",")",["T_WHITESPACE","\n\t\t",896],"{",["T_WHITESPACE","\n\t\t\t",897],["T_RETURN","return",898],["T_WHITESPACE"," ",898],["T_VARIABLE","$this",898],["T_OBJECT_OPERATOR","->",898],"{",["T_CONSTANT_ENCAPSED_STRING","'_'",898],".",["T_VARIABLE","$key",898],"}",";",["T_WHITESPACE","\n\t\t",898],"}",["T_WHITESPACE","\n\n\t\t",899],["T_RETURN","return",901],["T_WHITESPACE"," ",901],["T_STRING","NULL",901],";",["T_WHITESPACE","\n\t",901],"}",["T_WHITESPACE","\n\n\t",902],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",904],["T_WHITESPACE","\n\t",905],["T_DOC_COMMENT","\/**\n\t * Byte-safe strlen()\n\t *\n\t * @param\tstring\t$str\n\t * @return\tint\n\t *\/",906],["T_WHITESPACE","\n\t",911],["T_PROTECTED","protected",912],["T_WHITESPACE"," ",912],["T_STATIC","static",912],["T_WHITESPACE"," ",912],["T_FUNCTION","function",912],["T_WHITESPACE"," ",912],["T_STRING","strlen",912],"(",["T_VARIABLE","$str",912],")",["T_WHITESPACE","\n\t",912],"{",["T_WHITESPACE","\n\t\t",913],["T_RETURN","return",914],["T_WHITESPACE"," ",914],"(",["T_STRING","self",914],["T_DOUBLE_COLON","::",914],["T_VARIABLE","$func_override",914],")",["T_WHITESPACE","\n\t\t\t",914],"?",["T_WHITESPACE"," ",915],["T_STRING","mb_strlen",915],"(",["T_VARIABLE","$str",915],",",["T_WHITESPACE"," ",915],["T_CONSTANT_ENCAPSED_STRING","'8bit'",915],")",["T_WHITESPACE","\n\t\t\t",915],":",["T_WHITESPACE"," ",916],["T_STRING","strlen",916],"(",["T_VARIABLE","$str",916],")",";",["T_WHITESPACE","\n\t",916],"}",["T_WHITESPACE","\n\n\t",917],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",919],["T_WHITESPACE","\n\t",920],["T_DOC_COMMENT","\/**\n\t * Byte-safe substr()\n\t *\n\t * @param\tstring\t$str\n\t * @param\tint\t$start\n\t * @param\tint\t$length\n\t * @return\tstring\n\t *\/",921],["T_WHITESPACE","\n\t",928],["T_PROTECTED","protected",929],["T_WHITESPACE"," ",929],["T_STATIC","static",929],["T_WHITESPACE"," ",929],["T_FUNCTION","function",929],["T_WHITESPACE"," ",929],["T_STRING","substr",929],"(",["T_VARIABLE","$str",929],",",["T_WHITESPACE"," ",929],["T_VARIABLE","$start",929],",",["T_WHITESPACE"," ",929],["T_VARIABLE","$length",929],["T_WHITESPACE"," ",929],"=",["T_WHITESPACE"," ",929],["T_STRING","NULL",929],")",["T_WHITESPACE","\n\t",929],"{",["T_WHITESPACE","\n\t\t",930],["T_IF","if",931],["T_WHITESPACE"," ",931],"(",["T_STRING","self",931],["T_DOUBLE_COLON","::",931],["T_VARIABLE","$func_override",931],")",["T_WHITESPACE","\n\t\t",931],"{",["T_WHITESPACE","\n\t\t\t",932],["T_RETURN","return",933],["T_WHITESPACE"," ",933],["T_STRING","mb_substr",933],"(",["T_VARIABLE","$str",933],",",["T_WHITESPACE"," ",933],["T_VARIABLE","$start",933],",",["T_WHITESPACE"," ",933],["T_VARIABLE","$length",933],",",["T_WHITESPACE"," ",933],["T_CONSTANT_ENCAPSED_STRING","'8bit'",933],")",";",["T_WHITESPACE","\n\t\t",933],"}",["T_WHITESPACE","\n\n\t\t",934],["T_RETURN","return",936],["T_WHITESPACE"," ",936],["T_ISSET","isset",936],"(",["T_VARIABLE","$length",936],")",["T_WHITESPACE","\n\t\t\t",936],"?",["T_WHITESPACE"," ",937],["T_STRING","substr",937],"(",["T_VARIABLE","$str",937],",",["T_WHITESPACE"," ",937],["T_VARIABLE","$start",937],",",["T_WHITESPACE"," ",937],["T_VARIABLE","$length",937],")",["T_WHITESPACE","\n\t\t\t",937],":",["T_WHITESPACE"," ",938],["T_STRING","substr",938],"(",["T_VARIABLE","$str",938],",",["T_WHITESPACE"," ",938],["T_VARIABLE","$start",938],")",";",["T_WHITESPACE","\n\t",938],"}",["T_WHITESPACE","\n",939],"}",["T_WHITESPACE","\n",940]]