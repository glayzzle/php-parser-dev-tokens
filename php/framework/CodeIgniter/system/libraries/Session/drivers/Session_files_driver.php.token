[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CodeIgniter\n *\n * An open source application development framework for PHP\n *\n * This content is released under the MIT License (MIT)\n *\n * Copyright (c) 2014 - 2017, British Columbia Institute of Technology\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and\/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n *\n * @package\tCodeIgniter\n * @author\tEllisLab Dev Team\n * @copyright\tCopyright (c) 2008 - 2014, EllisLab, Inc. (https:\/\/ellislab.com\/)\n * @copyright\tCopyright (c) 2014 - 2017, British Columbia Institute of Technology (http:\/\/bcit.ca\/)\n * @license\thttp:\/\/opensource.org\/licenses\/MIT\tMIT License\n * @link\thttps:\/\/codeigniter.com\n * @since\tVersion 3.0.0\n * @filesource\n*\/",2],["T_WHITESPACE","\n",37],["T_STRING","defined",38],"(",["T_CONSTANT_ENCAPSED_STRING","'BASEPATH'",38],")",["T_WHITESPACE"," ",38],["T_LOGICAL_OR","OR",38],["T_WHITESPACE"," ",38],["T_EXIT","exit",38],"(",["T_CONSTANT_ENCAPSED_STRING","'No direct script access allowed'",38],")",";",["T_WHITESPACE","\n\n",38],["T_DOC_COMMENT","\/**\n * CodeIgniter Session Files Driver\n *\n * @package\tCodeIgniter\n * @subpackage\tLibraries\n * @category\tSessions\n * @author\tAndrey Andreev\n * @link\thttps:\/\/codeigniter.com\/user_guide\/libraries\/sessions.html\n *\/",40],["T_WHITESPACE","\n",48],["T_CLASS","class",49],["T_WHITESPACE"," ",49],["T_STRING","CI_Session_files_driver",49],["T_WHITESPACE"," ",49],["T_EXTENDS","extends",49],["T_WHITESPACE"," ",49],["T_STRING","CI_Session_driver",49],["T_WHITESPACE"," ",49],["T_IMPLEMENTS","implements",49],["T_WHITESPACE"," ",49],["T_STRING","SessionHandlerInterface",49],["T_WHITESPACE"," ",49],"{",["T_WHITESPACE","\n\n\t",49],["T_DOC_COMMENT","\/**\n\t * Save path\n\t *\n\t * @var\tstring\n\t *\/",51],["T_WHITESPACE","\n\t",55],["T_PROTECTED","protected",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$_save_path",56],";",["T_WHITESPACE","\n\n\t",56],["T_DOC_COMMENT","\/**\n\t * File handle\n\t *\n\t * @var\tresource\n\t *\/",58],["T_WHITESPACE","\n\t",62],["T_PROTECTED","protected",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$_file_handle",63],";",["T_WHITESPACE","\n\n\t",63],["T_DOC_COMMENT","\/**\n\t * File name\n\t *\n\t * @var\tresource\n\t *\/",65],["T_WHITESPACE","\n\t",69],["T_PROTECTED","protected",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$_file_path",70],";",["T_WHITESPACE","\n\n\t",70],["T_DOC_COMMENT","\/**\n\t * File new flag\n\t *\n\t * @var\tbool\n\t *\/",72],["T_WHITESPACE","\n\t",76],["T_PROTECTED","protected",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$_file_new",77],";",["T_WHITESPACE","\n\n\t",77],["T_DOC_COMMENT","\/**\n\t * Validate SID regular expression\n\t *\n\t * @var\tstring\n\t *\/",79],["T_WHITESPACE","\n\t",83],["T_PROTECTED","protected",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$_sid_regexp",84],";",["T_WHITESPACE","\n\n\t",84],["T_DOC_COMMENT","\/**\n\t * mbstring.func_override flag\n\t *\n\t * @var\tbool\n\t *\/",86],["T_WHITESPACE","\n\t",90],["T_PROTECTED","protected",91],["T_WHITESPACE"," ",91],["T_STATIC","static",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$func_override",91],";",["T_WHITESPACE","\n\n\t",91],["T_COMMENT","\/\/ ------------------------------------------------------------------------\n",93],["T_WHITESPACE","\n\t",94],["T_DOC_COMMENT","\/**\n\t * Class constructor\n\t *\n\t * @param\tarray\t$params\tConfiguration parameters\n\t * @return\tvoid\n\t *\/",95],["T_WHITESPACE","\n\t",100],["T_PUBLIC","public",101],["T_WHITESPACE"," ",101],["T_FUNCTION","function",101],["T_WHITESPACE"," ",101],["T_STRING","__construct",101],"(","&",["T_VARIABLE","$params",101],")",["T_WHITESPACE","\n\t",101],"{",["T_WHITESPACE","\n\t\t",102],["T_STRING","parent",103],["T_DOUBLE_COLON","::",103],["T_STRING","__construct",103],"(",["T_VARIABLE","$params",103],")",";",["T_WHITESPACE","\n\n\t\t",103],["T_IF","if",105],["T_WHITESPACE"," ",105],"(",["T_ISSET","isset",105],"(",["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","_config",105],"[",["T_CONSTANT_ENCAPSED_STRING","'save_path'",105],"]",")",")",["T_WHITESPACE","\n\t\t",105],"{",["T_WHITESPACE","\n\t\t\t",106],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","_config",107],"[",["T_CONSTANT_ENCAPSED_STRING","'save_path'",107],"]",["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_STRING","rtrim",107],"(",["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","_config",107],"[",["T_CONSTANT_ENCAPSED_STRING","'save_path'",107],"]",",",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'\/\\\\'",107],")",";",["T_WHITESPACE","\n\t\t\t",107],["T_STRING","ini_set",108],"(",["T_CONSTANT_ENCAPSED_STRING","'session.save_path'",108],",",["T_WHITESPACE"," ",108],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","_config",108],"[",["T_CONSTANT_ENCAPSED_STRING","'save_path'",108],"]",")",";",["T_WHITESPACE","\n\t\t",108],"}",["T_WHITESPACE","\n\t\t",109],["T_ELSE","else",110],["T_WHITESPACE","\n\t\t",110],"{",["T_WHITESPACE","\n\t\t\t",111],["T_STRING","log_message",112],"(",["T_CONSTANT_ENCAPSED_STRING","'debug'",112],",",["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'Session: \"sess_save_path\" is empty; using \"session.save_path\" value from php.ini.'",112],")",";",["T_WHITESPACE","\n\t\t\t",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","_config",113],"[",["T_CONSTANT_ENCAPSED_STRING","'save_path'",113],"]",["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_STRING","rtrim",113],"(",["T_STRING","ini_get",113],"(",["T_CONSTANT_ENCAPSED_STRING","'session.save_path'",113],")",",",["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","'\/\\\\'",113],")",";",["T_WHITESPACE","\n\t\t",113],"}",["T_WHITESPACE","\n\n\t\t",114],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","_sid_regexp",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","_config",116],"[",["T_CONSTANT_ENCAPSED_STRING","'_sid_regexp'",116],"]",";",["T_WHITESPACE","\n\n\t\t",116],["T_ISSET","isset",118],"(",["T_STRING","self",118],["T_DOUBLE_COLON","::",118],["T_VARIABLE","$func_override",118],")",["T_WHITESPACE"," ",118],["T_LOGICAL_OR","OR",118],["T_WHITESPACE"," ",118],["T_STRING","self",118],["T_DOUBLE_COLON","::",118],["T_VARIABLE","$func_override",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],"(",["T_STRING","extension_loaded",118],"(",["T_CONSTANT_ENCAPSED_STRING","'mbstring'",118],")",["T_WHITESPACE"," ",118],["T_BOOLEAN_AND","&&",118],["T_WHITESPACE"," ",118],["T_STRING","ini_get",118],"(",["T_CONSTANT_ENCAPSED_STRING","'mbstring.func_override'",118],")",")",";",["T_WHITESPACE","\n\t",118],"}",["T_WHITESPACE","\n\n\t",119],["T_COMMENT","\/\/ ------------------------------------------------------------------------\n",121],["T_WHITESPACE","\n\t",122],["T_DOC_COMMENT","\/**\n\t * Open\n\t *\n\t * Sanitizes the save_path directory.\n\t *\n\t * @param\tstring\t$save_path\tPath to session files' directory\n\t * @param\tstring\t$name\t\tSession cookie name\n\t * @return\tbool\n\t *\/",123],["T_WHITESPACE","\n\t",131],["T_PUBLIC","public",132],["T_WHITESPACE"," ",132],["T_FUNCTION","function",132],["T_WHITESPACE"," ",132],["T_STRING","open",132],"(",["T_VARIABLE","$save_path",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$name",132],")",["T_WHITESPACE","\n\t",132],"{",["T_WHITESPACE","\n\t\t",133],["T_IF","if",134],["T_WHITESPACE"," ",134],"(",["T_WHITESPACE"," ",134],"!",["T_WHITESPACE"," ",134],["T_STRING","is_dir",134],"(",["T_VARIABLE","$save_path",134],")",")",["T_WHITESPACE","\n\t\t",134],"{",["T_WHITESPACE","\n\t\t\t",135],["T_IF","if",136],["T_WHITESPACE"," ",136],"(",["T_WHITESPACE"," ",136],"!",["T_WHITESPACE"," ",136],["T_STRING","mkdir",136],"(",["T_VARIABLE","$save_path",136],",",["T_WHITESPACE"," ",136],["T_LNUMBER","0700",136],",",["T_WHITESPACE"," ",136],["T_STRING","TRUE",136],")",")",["T_WHITESPACE","\n\t\t\t",136],"{",["T_WHITESPACE","\n\t\t\t\t",137],["T_THROW","throw",138],["T_WHITESPACE"," ",138],["T_NEW","new",138],["T_WHITESPACE"," ",138],["T_STRING","Exception",138],"(",["T_CONSTANT_ENCAPSED_STRING","\"Session: Configured save path '\"",138],".",["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","_config",138],"[",["T_CONSTANT_ENCAPSED_STRING","'save_path'",138],"]",".",["T_CONSTANT_ENCAPSED_STRING","\"' is not a directory, doesn't exist or cannot be created.\"",138],")",";",["T_WHITESPACE","\n\t\t\t",138],"}",["T_WHITESPACE","\n\t\t",139],"}",["T_WHITESPACE","\n\t\t",140],["T_ELSEIF","elseif",141],["T_WHITESPACE"," ",141],"(",["T_WHITESPACE"," ",141],"!",["T_WHITESPACE"," ",141],["T_STRING","is_writable",141],"(",["T_VARIABLE","$save_path",141],")",")",["T_WHITESPACE","\n\t\t",141],"{",["T_WHITESPACE","\n\t\t\t",142],["T_THROW","throw",143],["T_WHITESPACE"," ",143],["T_NEW","new",143],["T_WHITESPACE"," ",143],["T_STRING","Exception",143],"(",["T_CONSTANT_ENCAPSED_STRING","\"Session: Configured save path '\"",143],".",["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","_config",143],"[",["T_CONSTANT_ENCAPSED_STRING","'save_path'",143],"]",".",["T_CONSTANT_ENCAPSED_STRING","\"' is not writable by the PHP process.\"",143],")",";",["T_WHITESPACE","\n\t\t",143],"}",["T_WHITESPACE","\n\n\t\t",144],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","_config",146],"[",["T_CONSTANT_ENCAPSED_STRING","'save_path'",146],"]",["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_VARIABLE","$save_path",146],";",["T_WHITESPACE","\n\t\t",146],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","_file_path",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","_config",147],"[",["T_CONSTANT_ENCAPSED_STRING","'save_path'",147],"]",".",["T_STRING","DIRECTORY_SEPARATOR",147],["T_WHITESPACE","\n\t\t\t",147],".",["T_VARIABLE","$name",148],["T_WHITESPACE"," ",148],["T_COMMENT","\/\/ we'll use the session cookie name as a prefix to avoid collisions\n",148],["T_WHITESPACE","\t\t\t",149],".","(",["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","_config",149],"[",["T_CONSTANT_ENCAPSED_STRING","'match_ip'",149],"]",["T_WHITESPACE"," ",149],"?",["T_WHITESPACE"," ",149],["T_STRING","md5",149],"(",["T_VARIABLE","$_SERVER",149],"[",["T_CONSTANT_ENCAPSED_STRING","'REMOTE_ADDR'",149],"]",")",["T_WHITESPACE"," ",149],":",["T_WHITESPACE"," ",149],["T_CONSTANT_ENCAPSED_STRING","''",149],")",";",["T_WHITESPACE","\n\n\t\t",149],["T_RETURN","return",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","_success",151],";",["T_WHITESPACE","\n\t",151],"}",["T_WHITESPACE","\n\n\t",152],["T_COMMENT","\/\/ ------------------------------------------------------------------------\n",154],["T_WHITESPACE","\n\t",155],["T_DOC_COMMENT","\/**\n\t * Read\n\t *\n\t * Reads session data and acquires a lock\n\t *\n\t * @param\tstring\t$session_id\tSession ID\n\t * @return\tstring\tSerialized session data\n\t *\/",156],["T_WHITESPACE","\n\t",163],["T_PUBLIC","public",164],["T_WHITESPACE"," ",164],["T_FUNCTION","function",164],["T_WHITESPACE"," ",164],["T_STRING","read",164],"(",["T_VARIABLE","$session_id",164],")",["T_WHITESPACE","\n\t",164],"{",["T_WHITESPACE","\n\t\t",165],["T_COMMENT","\/\/ This might seem weird, but PHP 5.6 introduces session_reset(),\n",166],["T_WHITESPACE","\t\t",167],["T_COMMENT","\/\/ which re-reads session data\n",167],["T_WHITESPACE","\t\t",168],["T_IF","if",168],["T_WHITESPACE"," ",168],"(",["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","_file_handle",168],["T_WHITESPACE"," ",168],["T_IS_IDENTICAL","===",168],["T_WHITESPACE"," ",168],["T_STRING","NULL",168],")",["T_WHITESPACE","\n\t\t",168],"{",["T_WHITESPACE","\n\t\t\t",169],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","_file_new",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],"!",["T_WHITESPACE"," ",170],["T_STRING","file_exists",170],"(",["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","_file_path",170],".",["T_VARIABLE","$session_id",170],")",";",["T_WHITESPACE","\n\n\t\t\t",170],["T_IF","if",172],["T_WHITESPACE"," ",172],"(","(",["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","_file_handle",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_STRING","fopen",172],"(",["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","_file_path",172],".",["T_VARIABLE","$session_id",172],",",["T_WHITESPACE"," ",172],["T_CONSTANT_ENCAPSED_STRING","'c+b'",172],")",")",["T_WHITESPACE"," ",172],["T_IS_IDENTICAL","===",172],["T_WHITESPACE"," ",172],["T_STRING","FALSE",172],")",["T_WHITESPACE","\n\t\t\t",172],"{",["T_WHITESPACE","\n\t\t\t\t",173],["T_STRING","log_message",174],"(",["T_CONSTANT_ENCAPSED_STRING","'error'",174],",",["T_WHITESPACE"," ",174],["T_CONSTANT_ENCAPSED_STRING","\"Session: Unable to open file '\"",174],".",["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","_file_path",174],".",["T_VARIABLE","$session_id",174],".",["T_CONSTANT_ENCAPSED_STRING","\"'.\"",174],")",";",["T_WHITESPACE","\n\t\t\t\t",174],["T_RETURN","return",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","_failure",175],";",["T_WHITESPACE","\n\t\t\t",175],"}",["T_WHITESPACE","\n\n\t\t\t",176],["T_IF","if",178],["T_WHITESPACE"," ",178],"(",["T_STRING","flock",178],"(",["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","_file_handle",178],",",["T_WHITESPACE"," ",178],["T_STRING","LOCK_EX",178],")",["T_WHITESPACE"," ",178],["T_IS_IDENTICAL","===",178],["T_WHITESPACE"," ",178],["T_STRING","FALSE",178],")",["T_WHITESPACE","\n\t\t\t",178],"{",["T_WHITESPACE","\n\t\t\t\t",179],["T_STRING","log_message",180],"(",["T_CONSTANT_ENCAPSED_STRING","'error'",180],",",["T_WHITESPACE"," ",180],["T_CONSTANT_ENCAPSED_STRING","\"Session: Unable to obtain lock for file '\"",180],".",["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","_file_path",180],".",["T_VARIABLE","$session_id",180],".",["T_CONSTANT_ENCAPSED_STRING","\"'.\"",180],")",";",["T_WHITESPACE","\n\t\t\t\t",180],["T_STRING","fclose",181],"(",["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","_file_handle",181],")",";",["T_WHITESPACE","\n\t\t\t\t",181],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","_file_handle",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_STRING","NULL",182],";",["T_WHITESPACE","\n\t\t\t\t",182],["T_RETURN","return",183],["T_WHITESPACE"," ",183],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","_failure",183],";",["T_WHITESPACE","\n\t\t\t",183],"}",["T_WHITESPACE","\n\n\t\t\t",184],["T_COMMENT","\/\/ Needed by write() to detect session_regenerate_id() calls\n",186],["T_WHITESPACE","\t\t\t",187],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","_session_id",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_VARIABLE","$session_id",187],";",["T_WHITESPACE","\n\n\t\t\t",187],["T_IF","if",189],["T_WHITESPACE"," ",189],"(",["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","_file_new",189],")",["T_WHITESPACE","\n\t\t\t",189],"{",["T_WHITESPACE","\n\t\t\t\t",190],["T_STRING","chmod",191],"(",["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","_file_path",191],".",["T_VARIABLE","$session_id",191],",",["T_WHITESPACE"," ",191],["T_LNUMBER","0600",191],")",";",["T_WHITESPACE","\n\t\t\t\t",191],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","_fingerprint",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_STRING","md5",192],"(",["T_CONSTANT_ENCAPSED_STRING","''",192],")",";",["T_WHITESPACE","\n\t\t\t\t",192],["T_RETURN","return",193],["T_WHITESPACE"," ",193],["T_CONSTANT_ENCAPSED_STRING","''",193],";",["T_WHITESPACE","\n\t\t\t",193],"}",["T_WHITESPACE","\n\t\t",194],"}",["T_WHITESPACE","\n\t\t",195],["T_COMMENT","\/\/ We shouldn't need this, but apparently we do ...\n",196],["T_WHITESPACE","\t\t",197],["T_COMMENT","\/\/ See https:\/\/github.com\/bcit-ci\/CodeIgniter\/issues\/4039\n",197],["T_WHITESPACE","\t\t",198],["T_ELSEIF","elseif",198],["T_WHITESPACE"," ",198],"(",["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","_file_handle",198],["T_WHITESPACE"," ",198],["T_IS_IDENTICAL","===",198],["T_WHITESPACE"," ",198],["T_STRING","FALSE",198],")",["T_WHITESPACE","\n\t\t",198],"{",["T_WHITESPACE","\n\t\t\t",199],["T_RETURN","return",200],["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","_failure",200],";",["T_WHITESPACE","\n\t\t",200],"}",["T_WHITESPACE","\n\t\t",201],["T_ELSE","else",202],["T_WHITESPACE","\n\t\t",202],"{",["T_WHITESPACE","\n\t\t\t",203],["T_STRING","rewind",204],"(",["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","_file_handle",204],")",";",["T_WHITESPACE","\n\t\t",204],"}",["T_WHITESPACE","\n\n\t\t",205],["T_VARIABLE","$session_data",207],["T_WHITESPACE"," ",207],"=",["T_WHITESPACE"," ",207],["T_CONSTANT_ENCAPSED_STRING","''",207],";",["T_WHITESPACE","\n\t\t",207],["T_FOR","for",208],["T_WHITESPACE"," ",208],"(",["T_VARIABLE","$read",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_LNUMBER","0",208],",",["T_WHITESPACE"," ",208],["T_VARIABLE","$length",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_STRING","filesize",208],"(",["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","_file_path",208],".",["T_VARIABLE","$session_id",208],")",";",["T_WHITESPACE"," ",208],["T_VARIABLE","$read",208],["T_WHITESPACE"," ",208],"<",["T_WHITESPACE"," ",208],["T_VARIABLE","$length",208],";",["T_WHITESPACE"," ",208],["T_VARIABLE","$read",208],["T_WHITESPACE"," ",208],["T_PLUS_EQUAL","+=",208],["T_WHITESPACE"," ",208],["T_STRING","self",208],["T_DOUBLE_COLON","::",208],["T_STRING","strlen",208],"(",["T_VARIABLE","$buffer",208],")",")",["T_WHITESPACE","\n\t\t",208],"{",["T_WHITESPACE","\n\t\t\t",209],["T_IF","if",210],["T_WHITESPACE"," ",210],"(","(",["T_VARIABLE","$buffer",210],["T_WHITESPACE"," ",210],"=",["T_WHITESPACE"," ",210],["T_STRING","fread",210],"(",["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","_file_handle",210],",",["T_WHITESPACE"," ",210],["T_VARIABLE","$length",210],["T_WHITESPACE"," ",210],"-",["T_WHITESPACE"," ",210],["T_VARIABLE","$read",210],")",")",["T_WHITESPACE"," ",210],["T_IS_IDENTICAL","===",210],["T_WHITESPACE"," ",210],["T_STRING","FALSE",210],")",["T_WHITESPACE","\n\t\t\t",210],"{",["T_WHITESPACE","\n\t\t\t\t",211],["T_BREAK","break",212],";",["T_WHITESPACE","\n\t\t\t",212],"}",["T_WHITESPACE","\n\n\t\t\t",213],["T_VARIABLE","$session_data",215],["T_WHITESPACE"," ",215],["T_CONCAT_EQUAL",".=",215],["T_WHITESPACE"," ",215],["T_VARIABLE","$buffer",215],";",["T_WHITESPACE","\n\t\t",215],"}",["T_WHITESPACE","\n\n\t\t",216],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","_fingerprint",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_STRING","md5",218],"(",["T_VARIABLE","$session_data",218],")",";",["T_WHITESPACE","\n\t\t",218],["T_RETURN","return",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$session_data",219],";",["T_WHITESPACE","\n\t",219],"}",["T_WHITESPACE","\n\n\t",220],["T_COMMENT","\/\/ ------------------------------------------------------------------------\n",222],["T_WHITESPACE","\n\t",223],["T_DOC_COMMENT","\/**\n\t * Write\n\t *\n\t * Writes (create \/ update) session data\n\t *\n\t * @param\tstring\t$session_id\tSession ID\n\t * @param\tstring\t$session_data\tSerialized session data\n\t * @return\tbool\n\t *\/",224],["T_WHITESPACE","\n\t",232],["T_PUBLIC","public",233],["T_WHITESPACE"," ",233],["T_FUNCTION","function",233],["T_WHITESPACE"," ",233],["T_STRING","write",233],"(",["T_VARIABLE","$session_id",233],",",["T_WHITESPACE"," ",233],["T_VARIABLE","$session_data",233],")",["T_WHITESPACE","\n\t",233],"{",["T_WHITESPACE","\n\t\t",234],["T_COMMENT","\/\/ If the two IDs don't match, we have a session_regenerate_id() call\n",235],["T_WHITESPACE","\t\t",236],["T_COMMENT","\/\/ and we need to close the old handle and open a new one\n",236],["T_WHITESPACE","\t\t",237],["T_IF","if",237],["T_WHITESPACE"," ",237],"(",["T_VARIABLE","$session_id",237],["T_WHITESPACE"," ",237],["T_IS_NOT_IDENTICAL","!==",237],["T_WHITESPACE"," ",237],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","_session_id",237],["T_WHITESPACE"," ",237],["T_BOOLEAN_AND","&&",237],["T_WHITESPACE"," ",237],"(",["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","close",237],"(",")",["T_WHITESPACE"," ",237],["T_IS_IDENTICAL","===",237],["T_WHITESPACE"," ",237],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","_failure",237],["T_WHITESPACE"," ",237],["T_LOGICAL_OR","OR",237],["T_WHITESPACE"," ",237],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","read",237],"(",["T_VARIABLE","$session_id",237],")",["T_WHITESPACE"," ",237],["T_IS_IDENTICAL","===",237],["T_WHITESPACE"," ",237],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","_failure",237],")",")",["T_WHITESPACE","\n\t\t",237],"{",["T_WHITESPACE","\n\t\t\t",238],["T_RETURN","return",239],["T_WHITESPACE"," ",239],["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","_failure",239],";",["T_WHITESPACE","\n\t\t",239],"}",["T_WHITESPACE","\n\n\t\t",240],["T_IF","if",242],["T_WHITESPACE"," ",242],"(",["T_WHITESPACE"," ",242],"!",["T_WHITESPACE"," ",242],["T_STRING","is_resource",242],"(",["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","_file_handle",242],")",")",["T_WHITESPACE","\n\t\t",242],"{",["T_WHITESPACE","\n\t\t\t",243],["T_RETURN","return",244],["T_WHITESPACE"," ",244],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","_failure",244],";",["T_WHITESPACE","\n\t\t",244],"}",["T_WHITESPACE","\n\t\t",245],["T_ELSEIF","elseif",246],["T_WHITESPACE"," ",246],"(",["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","_fingerprint",246],["T_WHITESPACE"," ",246],["T_IS_IDENTICAL","===",246],["T_WHITESPACE"," ",246],["T_STRING","md5",246],"(",["T_VARIABLE","$session_data",246],")",")",["T_WHITESPACE","\n\t\t",246],"{",["T_WHITESPACE","\n\t\t\t",247],["T_RETURN","return",248],["T_WHITESPACE"," ",248],"(",["T_WHITESPACE"," ",248],"!",["T_WHITESPACE"," ",248],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","_file_new",248],["T_WHITESPACE"," ",248],["T_BOOLEAN_AND","&&",248],["T_WHITESPACE"," ",248],"!",["T_WHITESPACE"," ",248],["T_STRING","touch",248],"(",["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","_file_path",248],".",["T_VARIABLE","$session_id",248],")",")",["T_WHITESPACE","\n\t\t\t\t",248],"?",["T_WHITESPACE"," ",249],["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","_failure",249],["T_WHITESPACE","\n\t\t\t\t",249],":",["T_WHITESPACE"," ",250],["T_VARIABLE","$this",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","_success",250],";",["T_WHITESPACE","\n\t\t",250],"}",["T_WHITESPACE","\n\n\t\t",251],["T_IF","if",253],["T_WHITESPACE"," ",253],"(",["T_WHITESPACE"," ",253],"!",["T_WHITESPACE"," ",253],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","_file_new",253],")",["T_WHITESPACE","\n\t\t",253],"{",["T_WHITESPACE","\n\t\t\t",254],["T_STRING","ftruncate",255],"(",["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","_file_handle",255],",",["T_WHITESPACE"," ",255],["T_LNUMBER","0",255],")",";",["T_WHITESPACE","\n\t\t\t",255],["T_STRING","rewind",256],"(",["T_VARIABLE","$this",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","_file_handle",256],")",";",["T_WHITESPACE","\n\t\t",256],"}",["T_WHITESPACE","\n\n\t\t",257],["T_IF","if",259],["T_WHITESPACE"," ",259],"(","(",["T_VARIABLE","$length",259],["T_WHITESPACE"," ",259],"=",["T_WHITESPACE"," ",259],["T_STRING","strlen",259],"(",["T_VARIABLE","$session_data",259],")",")",["T_WHITESPACE"," ",259],">",["T_WHITESPACE"," ",259],["T_LNUMBER","0",259],")",["T_WHITESPACE","\n\t\t",259],"{",["T_WHITESPACE","\n\t\t\t",260],["T_FOR","for",261],["T_WHITESPACE"," ",261],"(",["T_VARIABLE","$written",261],["T_WHITESPACE"," ",261],"=",["T_WHITESPACE"," ",261],["T_LNUMBER","0",261],";",["T_WHITESPACE"," ",261],["T_VARIABLE","$written",261],["T_WHITESPACE"," ",261],"<",["T_WHITESPACE"," ",261],["T_VARIABLE","$length",261],";",["T_WHITESPACE"," ",261],["T_VARIABLE","$written",261],["T_WHITESPACE"," ",261],["T_PLUS_EQUAL","+=",261],["T_WHITESPACE"," ",261],["T_VARIABLE","$result",261],")",["T_WHITESPACE","\n\t\t\t",261],"{",["T_WHITESPACE","\n\t\t\t\t",262],["T_IF","if",263],["T_WHITESPACE"," ",263],"(","(",["T_VARIABLE","$result",263],["T_WHITESPACE"," ",263],"=",["T_WHITESPACE"," ",263],["T_STRING","fwrite",263],"(",["T_VARIABLE","$this",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","_file_handle",263],",",["T_WHITESPACE"," ",263],["T_STRING","substr",263],"(",["T_VARIABLE","$session_data",263],",",["T_WHITESPACE"," ",263],["T_VARIABLE","$written",263],")",")",")",["T_WHITESPACE"," ",263],["T_IS_IDENTICAL","===",263],["T_WHITESPACE"," ",263],["T_STRING","FALSE",263],")",["T_WHITESPACE","\n\t\t\t\t",263],"{",["T_WHITESPACE","\n\t\t\t\t\t",264],["T_BREAK","break",265],";",["T_WHITESPACE","\n\t\t\t\t",265],"}",["T_WHITESPACE","\n\t\t\t",266],"}",["T_WHITESPACE","\n\n\t\t\t",267],["T_IF","if",269],["T_WHITESPACE"," ",269],"(",["T_WHITESPACE"," ",269],"!",["T_WHITESPACE"," ",269],["T_STRING","is_int",269],"(",["T_VARIABLE","$result",269],")",")",["T_WHITESPACE","\n\t\t\t",269],"{",["T_WHITESPACE","\n\t\t\t\t",270],["T_VARIABLE","$this",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","_fingerprint",271],["T_WHITESPACE"," ",271],"=",["T_WHITESPACE"," ",271],["T_STRING","md5",271],"(",["T_STRING","substr",271],"(",["T_VARIABLE","$session_data",271],",",["T_WHITESPACE"," ",271],["T_LNUMBER","0",271],",",["T_WHITESPACE"," ",271],["T_VARIABLE","$written",271],")",")",";",["T_WHITESPACE","\n\t\t\t\t",271],["T_STRING","log_message",272],"(",["T_CONSTANT_ENCAPSED_STRING","'error'",272],",",["T_WHITESPACE"," ",272],["T_CONSTANT_ENCAPSED_STRING","'Session: Unable to write data.'",272],")",";",["T_WHITESPACE","\n\t\t\t\t",272],["T_RETURN","return",273],["T_WHITESPACE"," ",273],["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","_failure",273],";",["T_WHITESPACE","\n\t\t\t",273],"}",["T_WHITESPACE","\n\t\t",274],"}",["T_WHITESPACE","\n\n\t\t",275],["T_VARIABLE","$this",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","_fingerprint",277],["T_WHITESPACE"," ",277],"=",["T_WHITESPACE"," ",277],["T_STRING","md5",277],"(",["T_VARIABLE","$session_data",277],")",";",["T_WHITESPACE","\n\t\t",277],["T_RETURN","return",278],["T_WHITESPACE"," ",278],["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","_success",278],";",["T_WHITESPACE","\n\t",278],"}",["T_WHITESPACE","\n\n\t",279],["T_COMMENT","\/\/ ------------------------------------------------------------------------\n",281],["T_WHITESPACE","\n\t",282],["T_DOC_COMMENT","\/**\n\t * Close\n\t *\n\t * Releases locks and closes file descriptor.\n\t *\n\t * @return\tbool\n\t *\/",283],["T_WHITESPACE","\n\t",289],["T_PUBLIC","public",290],["T_WHITESPACE"," ",290],["T_FUNCTION","function",290],["T_WHITESPACE"," ",290],["T_STRING","close",290],"(",")",["T_WHITESPACE","\n\t",290],"{",["T_WHITESPACE","\n\t\t",291],["T_IF","if",292],["T_WHITESPACE"," ",292],"(",["T_STRING","is_resource",292],"(",["T_VARIABLE","$this",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","_file_handle",292],")",")",["T_WHITESPACE","\n\t\t",292],"{",["T_WHITESPACE","\n\t\t\t",293],["T_STRING","flock",294],"(",["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","_file_handle",294],",",["T_WHITESPACE"," ",294],["T_STRING","LOCK_UN",294],")",";",["T_WHITESPACE","\n\t\t\t",294],["T_STRING","fclose",295],"(",["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","_file_handle",295],")",";",["T_WHITESPACE","\n\n\t\t\t",295],["T_VARIABLE","$this",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","_file_handle",297],["T_WHITESPACE"," ",297],"=",["T_WHITESPACE"," ",297],["T_VARIABLE","$this",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","_file_new",297],["T_WHITESPACE"," ",297],"=",["T_WHITESPACE"," ",297],["T_VARIABLE","$this",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","_session_id",297],["T_WHITESPACE"," ",297],"=",["T_WHITESPACE"," ",297],["T_STRING","NULL",297],";",["T_WHITESPACE","\n\t\t",297],"}",["T_WHITESPACE","\n\n\t\t",298],["T_RETURN","return",300],["T_WHITESPACE"," ",300],["T_VARIABLE","$this",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","_success",300],";",["T_WHITESPACE","\n\t",300],"}",["T_WHITESPACE","\n\n\t",301],["T_COMMENT","\/\/ ------------------------------------------------------------------------\n",303],["T_WHITESPACE","\n\t",304],["T_DOC_COMMENT","\/**\n\t * Destroy\n\t *\n\t * Destroys the current session.\n\t *\n\t * @param\tstring\t$session_id\tSession ID\n\t * @return\tbool\n\t *\/",305],["T_WHITESPACE","\n\t",312],["T_PUBLIC","public",313],["T_WHITESPACE"," ",313],["T_FUNCTION","function",313],["T_WHITESPACE"," ",313],["T_STRING","destroy",313],"(",["T_VARIABLE","$session_id",313],")",["T_WHITESPACE","\n\t",313],"{",["T_WHITESPACE","\n\t\t",314],["T_IF","if",315],["T_WHITESPACE"," ",315],"(",["T_VARIABLE","$this",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","close",315],"(",")",["T_WHITESPACE"," ",315],["T_IS_IDENTICAL","===",315],["T_WHITESPACE"," ",315],["T_VARIABLE","$this",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","_success",315],")",["T_WHITESPACE","\n\t\t",315],"{",["T_WHITESPACE","\n\t\t\t",316],["T_IF","if",317],["T_WHITESPACE"," ",317],"(",["T_STRING","file_exists",317],"(",["T_VARIABLE","$this",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","_file_path",317],".",["T_VARIABLE","$session_id",317],")",")",["T_WHITESPACE","\n\t\t\t",317],"{",["T_WHITESPACE","\n\t\t\t\t",318],["T_VARIABLE","$this",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","_cookie_destroy",319],"(",")",";",["T_WHITESPACE","\n\t\t\t\t",319],["T_RETURN","return",320],["T_WHITESPACE"," ",320],["T_STRING","unlink",320],"(",["T_VARIABLE","$this",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","_file_path",320],".",["T_VARIABLE","$session_id",320],")",["T_WHITESPACE","\n\t\t\t\t\t",320],"?",["T_WHITESPACE"," ",321],["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","_success",321],["T_WHITESPACE","\n\t\t\t\t\t",321],":",["T_WHITESPACE"," ",322],["T_VARIABLE","$this",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","_failure",322],";",["T_WHITESPACE","\n\t\t\t",322],"}",["T_WHITESPACE","\n\n\t\t\t",323],["T_RETURN","return",325],["T_WHITESPACE"," ",325],["T_VARIABLE","$this",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","_success",325],";",["T_WHITESPACE","\n\t\t",325],"}",["T_WHITESPACE","\n\t\t",326],["T_ELSEIF","elseif",327],["T_WHITESPACE"," ",327],"(",["T_VARIABLE","$this",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","_file_path",327],["T_WHITESPACE"," ",327],["T_IS_NOT_IDENTICAL","!==",327],["T_WHITESPACE"," ",327],["T_STRING","NULL",327],")",["T_WHITESPACE","\n\t\t",327],"{",["T_WHITESPACE","\n\t\t\t",328],["T_STRING","clearstatcache",329],"(",")",";",["T_WHITESPACE","\n\t\t\t",329],["T_IF","if",330],["T_WHITESPACE"," ",330],"(",["T_STRING","file_exists",330],"(",["T_VARIABLE","$this",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","_file_path",330],".",["T_VARIABLE","$session_id",330],")",")",["T_WHITESPACE","\n\t\t\t",330],"{",["T_WHITESPACE","\n\t\t\t\t",331],["T_VARIABLE","$this",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","_cookie_destroy",332],"(",")",";",["T_WHITESPACE","\n\t\t\t\t",332],["T_RETURN","return",333],["T_WHITESPACE"," ",333],["T_STRING","unlink",333],"(",["T_VARIABLE","$this",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","_file_path",333],".",["T_VARIABLE","$session_id",333],")",["T_WHITESPACE","\n\t\t\t\t\t",333],"?",["T_WHITESPACE"," ",334],["T_VARIABLE","$this",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","_success",334],["T_WHITESPACE","\n\t\t\t\t\t",334],":",["T_WHITESPACE"," ",335],["T_VARIABLE","$this",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","_failure",335],";",["T_WHITESPACE","\n\t\t\t",335],"}",["T_WHITESPACE","\n\n\t\t\t",336],["T_RETURN","return",338],["T_WHITESPACE"," ",338],["T_VARIABLE","$this",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","_success",338],";",["T_WHITESPACE","\n\t\t",338],"}",["T_WHITESPACE","\n\n\t\t",339],["T_RETURN","return",341],["T_WHITESPACE"," ",341],["T_VARIABLE","$this",341],["T_OBJECT_OPERATOR","->",341],["T_STRING","_failure",341],";",["T_WHITESPACE","\n\t",341],"}",["T_WHITESPACE","\n\n\t",342],["T_COMMENT","\/\/ ------------------------------------------------------------------------\n",344],["T_WHITESPACE","\n\t",345],["T_DOC_COMMENT","\/**\n\t * Garbage Collector\n\t *\n\t * Deletes expired sessions\n\t *\n\t * @param\tint \t$maxlifetime\tMaximum lifetime of sessions\n\t * @return\tbool\n\t *\/",346],["T_WHITESPACE","\n\t",353],["T_PUBLIC","public",354],["T_WHITESPACE"," ",354],["T_FUNCTION","function",354],["T_WHITESPACE"," ",354],["T_STRING","gc",354],"(",["T_VARIABLE","$maxlifetime",354],")",["T_WHITESPACE","\n\t",354],"{",["T_WHITESPACE","\n\t\t",355],["T_IF","if",356],["T_WHITESPACE"," ",356],"(",["T_WHITESPACE"," ",356],"!",["T_WHITESPACE"," ",356],["T_STRING","is_dir",356],"(",["T_VARIABLE","$this",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","_config",356],"[",["T_CONSTANT_ENCAPSED_STRING","'save_path'",356],"]",")",["T_WHITESPACE"," ",356],["T_LOGICAL_OR","OR",356],["T_WHITESPACE"," ",356],"(",["T_VARIABLE","$directory",356],["T_WHITESPACE"," ",356],"=",["T_WHITESPACE"," ",356],["T_STRING","opendir",356],"(",["T_VARIABLE","$this",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","_config",356],"[",["T_CONSTANT_ENCAPSED_STRING","'save_path'",356],"]",")",")",["T_WHITESPACE"," ",356],["T_IS_IDENTICAL","===",356],["T_WHITESPACE"," ",356],["T_STRING","FALSE",356],")",["T_WHITESPACE","\n\t\t",356],"{",["T_WHITESPACE","\n\t\t\t",357],["T_STRING","log_message",358],"(",["T_CONSTANT_ENCAPSED_STRING","'debug'",358],",",["T_WHITESPACE"," ",358],["T_CONSTANT_ENCAPSED_STRING","\"Session: Garbage collector couldn't list files under directory '\"",358],".",["T_VARIABLE","$this",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","_config",358],"[",["T_CONSTANT_ENCAPSED_STRING","'save_path'",358],"]",".",["T_CONSTANT_ENCAPSED_STRING","\"'.\"",358],")",";",["T_WHITESPACE","\n\t\t\t",358],["T_RETURN","return",359],["T_WHITESPACE"," ",359],["T_VARIABLE","$this",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","_failure",359],";",["T_WHITESPACE","\n\t\t",359],"}",["T_WHITESPACE","\n\n\t\t",360],["T_VARIABLE","$ts",362],["T_WHITESPACE"," ",362],"=",["T_WHITESPACE"," ",362],["T_STRING","time",362],"(",")",["T_WHITESPACE"," ",362],"-",["T_WHITESPACE"," ",362],["T_VARIABLE","$maxlifetime",362],";",["T_WHITESPACE","\n\n\t\t",362],["T_VARIABLE","$pattern",364],["T_WHITESPACE"," ",364],"=",["T_WHITESPACE"," ",364],"(",["T_VARIABLE","$this",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","_config",364],"[",["T_CONSTANT_ENCAPSED_STRING","'match_ip'",364],"]",["T_WHITESPACE"," ",364],["T_IS_IDENTICAL","===",364],["T_WHITESPACE"," ",364],["T_STRING","TRUE",364],")",["T_WHITESPACE","\n\t\t\t",364],"?",["T_WHITESPACE"," ",365],["T_CONSTANT_ENCAPSED_STRING","'[0-9a-f]{32}'",365],["T_WHITESPACE","\n\t\t\t",365],":",["T_WHITESPACE"," ",366],["T_CONSTANT_ENCAPSED_STRING","''",366],";",["T_WHITESPACE","\n\n\t\t",366],["T_VARIABLE","$pattern",368],["T_WHITESPACE"," ",368],"=",["T_WHITESPACE"," ",368],["T_STRING","sprintf",368],"(",["T_WHITESPACE","\n\t\t\t",368],["T_CONSTANT_ENCAPSED_STRING","'#\\A%s'",369],".",["T_VARIABLE","$pattern",369],".",["T_VARIABLE","$this",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","_sid_regexp",369],".",["T_CONSTANT_ENCAPSED_STRING","'\\z#'",369],",",["T_WHITESPACE","\n\t\t\t",369],["T_STRING","preg_quote",370],"(",["T_VARIABLE","$this",370],["T_OBJECT_OPERATOR","->",370],["T_STRING","_config",370],"[",["T_CONSTANT_ENCAPSED_STRING","'cookie_name'",370],"]",")",["T_WHITESPACE","\n\t\t",370],")",";",["T_WHITESPACE","\n\n\t\t",371],["T_WHILE","while",373],["T_WHITESPACE"," ",373],"(","(",["T_VARIABLE","$file",373],["T_WHITESPACE"," ",373],"=",["T_WHITESPACE"," ",373],["T_STRING","readdir",373],"(",["T_VARIABLE","$directory",373],")",")",["T_WHITESPACE"," ",373],["T_IS_NOT_IDENTICAL","!==",373],["T_WHITESPACE"," ",373],["T_STRING","FALSE",373],")",["T_WHITESPACE","\n\t\t",373],"{",["T_WHITESPACE","\n\t\t\t",374],["T_COMMENT","\/\/ If the filename doesn't match this pattern, it's either not a session file or is not ours\n",375],["T_WHITESPACE","\t\t\t",376],["T_IF","if",376],["T_WHITESPACE"," ",376],"(",["T_WHITESPACE"," ",376],"!",["T_WHITESPACE"," ",376],["T_STRING","preg_match",376],"(",["T_VARIABLE","$pattern",376],",",["T_WHITESPACE"," ",376],["T_VARIABLE","$file",376],")",["T_WHITESPACE","\n\t\t\t\t",376],["T_LOGICAL_OR","OR",377],["T_WHITESPACE"," ",377],"!",["T_WHITESPACE"," ",377],["T_STRING","is_file",377],"(",["T_VARIABLE","$this",377],["T_OBJECT_OPERATOR","->",377],["T_STRING","_config",377],"[",["T_CONSTANT_ENCAPSED_STRING","'save_path'",377],"]",".",["T_STRING","DIRECTORY_SEPARATOR",377],".",["T_VARIABLE","$file",377],")",["T_WHITESPACE","\n\t\t\t\t",377],["T_LOGICAL_OR","OR",378],["T_WHITESPACE"," ",378],"(",["T_VARIABLE","$mtime",378],["T_WHITESPACE"," ",378],"=",["T_WHITESPACE"," ",378],["T_STRING","filemtime",378],"(",["T_VARIABLE","$this",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","_config",378],"[",["T_CONSTANT_ENCAPSED_STRING","'save_path'",378],"]",".",["T_STRING","DIRECTORY_SEPARATOR",378],".",["T_VARIABLE","$file",378],")",")",["T_WHITESPACE"," ",378],["T_IS_IDENTICAL","===",378],["T_WHITESPACE"," ",378],["T_STRING","FALSE",378],["T_WHITESPACE","\n\t\t\t\t",378],["T_LOGICAL_OR","OR",379],["T_WHITESPACE"," ",379],["T_VARIABLE","$mtime",379],["T_WHITESPACE"," ",379],">",["T_WHITESPACE"," ",379],["T_VARIABLE","$ts",379],")",["T_WHITESPACE","\n\t\t\t",379],"{",["T_WHITESPACE","\n\t\t\t\t",380],["T_CONTINUE","continue",381],";",["T_WHITESPACE","\n\t\t\t",381],"}",["T_WHITESPACE","\n\n\t\t\t",382],["T_STRING","unlink",384],"(",["T_VARIABLE","$this",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","_config",384],"[",["T_CONSTANT_ENCAPSED_STRING","'save_path'",384],"]",".",["T_STRING","DIRECTORY_SEPARATOR",384],".",["T_VARIABLE","$file",384],")",";",["T_WHITESPACE","\n\t\t",384],"}",["T_WHITESPACE","\n\n\t\t",385],["T_STRING","closedir",387],"(",["T_VARIABLE","$directory",387],")",";",["T_WHITESPACE","\n\n\t\t",387],["T_RETURN","return",389],["T_WHITESPACE"," ",389],["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","_success",389],";",["T_WHITESPACE","\n\t",389],"}",["T_WHITESPACE","\n\n\t",390],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",392],["T_WHITESPACE","\n\t",393],["T_DOC_COMMENT","\/**\n\t * Byte-safe strlen()\n\t *\n\t * @param\tstring\t$str\n\t * @return\tint\n\t *\/",394],["T_WHITESPACE","\n\t",399],["T_PROTECTED","protected",400],["T_WHITESPACE"," ",400],["T_STATIC","static",400],["T_WHITESPACE"," ",400],["T_FUNCTION","function",400],["T_WHITESPACE"," ",400],["T_STRING","strlen",400],"(",["T_VARIABLE","$str",400],")",["T_WHITESPACE","\n\t",400],"{",["T_WHITESPACE","\n\t\t",401],["T_RETURN","return",402],["T_WHITESPACE"," ",402],"(",["T_STRING","self",402],["T_DOUBLE_COLON","::",402],["T_VARIABLE","$func_override",402],")",["T_WHITESPACE","\n\t\t\t",402],"?",["T_WHITESPACE"," ",403],["T_STRING","mb_strlen",403],"(",["T_VARIABLE","$str",403],",",["T_WHITESPACE"," ",403],["T_CONSTANT_ENCAPSED_STRING","'8bit'",403],")",["T_WHITESPACE","\n\t\t\t",403],":",["T_WHITESPACE"," ",404],["T_STRING","strlen",404],"(",["T_VARIABLE","$str",404],")",";",["T_WHITESPACE","\n\t",404],"}",["T_WHITESPACE","\n",405],"}",["T_WHITESPACE","\n",406]]