[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CodeIgniter\n *\n * An open source application development framework for PHP\n *\n * This content is released under the MIT License (MIT)\n *\n * Copyright (c) 2014 - 2017, British Columbia Institute of Technology\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and\/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n *\n * @package\tCodeIgniter\n * @author\tEllisLab Dev Team\n * @copyright\tCopyright (c) 2008 - 2014, EllisLab, Inc. (https:\/\/ellislab.com\/)\n * @copyright\tCopyright (c) 2014 - 2017, British Columbia Institute of Technology (http:\/\/bcit.ca\/)\n * @license\thttp:\/\/opensource.org\/licenses\/MIT\tMIT License\n * @link\thttps:\/\/codeigniter.com\n * @since\tVersion 1.0.0\n * @filesource\n *\/",2],["T_WHITESPACE","\n",37],["T_STRING","defined",38],"(",["T_CONSTANT_ENCAPSED_STRING","'BASEPATH'",38],")",["T_WHITESPACE"," ",38],["T_LOGICAL_OR","OR",38],["T_WHITESPACE"," ",38],["T_EXIT","exit",38],"(",["T_CONSTANT_ENCAPSED_STRING","'No direct script access allowed'",38],")",";",["T_WHITESPACE","\n\n",38],["T_DOC_COMMENT","\/**\n * Image Manipulation class\n *\n * @package\t\tCodeIgniter\n * @subpackage\tLibraries\n * @category\tImage_lib\n * @author\t\tEllisLab Dev Team\n * @link\t\thttps:\/\/codeigniter.com\/user_guide\/libraries\/image_lib.html\n *\/",40],["T_WHITESPACE","\n",48],["T_CLASS","class",49],["T_WHITESPACE"," ",49],["T_STRING","CI_Image_lib",49],["T_WHITESPACE"," ",49],"{",["T_WHITESPACE","\n\n\t",49],["T_DOC_COMMENT","\/**\n\t * PHP extension\/library to use for image manipulation\n\t * Can be: imagemagick, netpbm, gd, gd2\n\t *\n\t * @var string\n\t *\/",51],["T_WHITESPACE","\n\t",56],["T_PUBLIC","public",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$image_library",57],["T_WHITESPACE","\t\t",57],"=",["T_WHITESPACE"," ",57],["T_CONSTANT_ENCAPSED_STRING","'gd2'",57],";",["T_WHITESPACE","\n\n\t",57],["T_DOC_COMMENT","\/**\n\t * Path to the graphic library (if applicable)\n\t *\n\t * @var string\n\t *\/",59],["T_WHITESPACE","\n\t",63],["T_PUBLIC","public",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$library_path",64],["T_WHITESPACE","\t\t",64],"=",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","''",64],";",["T_WHITESPACE","\n\n\t",64],["T_DOC_COMMENT","\/**\n\t * Whether to send to browser or write to disk\n\t *\n\t * @var bool\n\t *\/",66],["T_WHITESPACE","\n\t",70],["T_PUBLIC","public",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$dynamic_output",71],["T_WHITESPACE","\t\t",71],"=",["T_WHITESPACE"," ",71],["T_STRING","FALSE",71],";",["T_WHITESPACE","\n\n\t",71],["T_DOC_COMMENT","\/**\n\t * Path to original image\n\t *\n\t * @var string\n\t *\/",73],["T_WHITESPACE","\n\t",77],["T_PUBLIC","public",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$source_image",78],["T_WHITESPACE","\t\t",78],"=",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","''",78],";",["T_WHITESPACE","\n\n\t",78],["T_DOC_COMMENT","\/**\n\t * Path to the modified image\n\t *\n\t * @var string\n\t *\/",80],["T_WHITESPACE","\n\t",84],["T_PUBLIC","public",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$new_image",85],["T_WHITESPACE","\t\t",85],"=",["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","''",85],";",["T_WHITESPACE","\n\n\t",85],["T_DOC_COMMENT","\/**\n\t * Image width\n\t *\n\t * @var int\n\t *\/",87],["T_WHITESPACE","\n\t",91],["T_PUBLIC","public",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$width",92],["T_WHITESPACE","\t\t\t",92],"=",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","''",92],";",["T_WHITESPACE","\n\n\t",92],["T_DOC_COMMENT","\/**\n\t * Image height\n\t *\n\t * @var int\n\t *\/",94],["T_WHITESPACE","\n\t",98],["T_PUBLIC","public",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$height",99],["T_WHITESPACE","\t\t\t",99],"=",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","''",99],";",["T_WHITESPACE","\n\n\t",99],["T_DOC_COMMENT","\/**\n\t * Quality percentage of new image\n\t *\n\t * @var int\n\t *\/",101],["T_WHITESPACE","\n\t",105],["T_PUBLIC","public",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$quality",106],["T_WHITESPACE","\t\t\t",106],"=",["T_WHITESPACE"," ",106],["T_LNUMBER","90",106],";",["T_WHITESPACE","\n\n\t",106],["T_DOC_COMMENT","\/**\n\t * Whether to create a thumbnail\n\t *\n\t * @var bool\n\t *\/",108],["T_WHITESPACE","\n\t",112],["T_PUBLIC","public",113],["T_WHITESPACE"," ",113],["T_VARIABLE","$create_thumb",113],["T_WHITESPACE","\t\t",113],"=",["T_WHITESPACE"," ",113],["T_STRING","FALSE",113],";",["T_WHITESPACE","\n\n\t",113],["T_DOC_COMMENT","\/**\n\t * String to add to thumbnail version of image\n\t *\n\t * @var string\n\t *\/",115],["T_WHITESPACE","\n\t",119],["T_PUBLIC","public",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$thumb_marker",120],["T_WHITESPACE","\t\t",120],"=",["T_WHITESPACE"," ",120],["T_CONSTANT_ENCAPSED_STRING","'_thumb'",120],";",["T_WHITESPACE","\n\n\t",120],["T_DOC_COMMENT","\/**\n\t * Whether to maintain aspect ratio when resizing or use hard values\n\t *\n\t * @var bool\n\t *\/",122],["T_WHITESPACE","\n\t",126],["T_PUBLIC","public",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$maintain_ratio",127],["T_WHITESPACE","\t\t",127],"=",["T_WHITESPACE"," ",127],["T_STRING","TRUE",127],";",["T_WHITESPACE","\n\n\t",127],["T_DOC_COMMENT","\/**\n\t * auto, height, or width.  Determines what to use as the master dimension\n\t *\n\t * @var string\n\t *\/",129],["T_WHITESPACE","\n\t",133],["T_PUBLIC","public",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$master_dim",134],["T_WHITESPACE","\t\t",134],"=",["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","'auto'",134],";",["T_WHITESPACE","\n\n\t",134],["T_DOC_COMMENT","\/**\n\t * Angle at to rotate image\n\t *\n\t * @var string\n\t *\/",136],["T_WHITESPACE","\n\t",140],["T_PUBLIC","public",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$rotation_angle",141],["T_WHITESPACE","\t\t",141],"=",["T_WHITESPACE"," ",141],["T_CONSTANT_ENCAPSED_STRING","''",141],";",["T_WHITESPACE","\n\n\t",141],["T_DOC_COMMENT","\/**\n\t * X Coordinate for manipulation of the current image\n\t *\n\t * @var int\n\t *\/",143],["T_WHITESPACE","\n\t",147],["T_PUBLIC","public",148],["T_WHITESPACE"," ",148],["T_VARIABLE","$x_axis",148],["T_WHITESPACE","\t\t\t",148],"=",["T_WHITESPACE"," ",148],["T_CONSTANT_ENCAPSED_STRING","''",148],";",["T_WHITESPACE","\n\n\t",148],["T_DOC_COMMENT","\/**\n\t * Y Coordinate for manipulation of the current image\n\t *\n\t * @var int\n\t *\/",150],["T_WHITESPACE","\n\t",154],["T_PUBLIC","public",155],["T_WHITESPACE"," ",155],["T_VARIABLE","$y_axis",155],["T_WHITESPACE","\t\t\t",155],"=",["T_WHITESPACE"," ",155],["T_CONSTANT_ENCAPSED_STRING","''",155],";",["T_WHITESPACE","\n\n\t",155],["T_COMMENT","\/\/ --------------------------------------------------------------------------\n",157],["T_WHITESPACE","\t",158],["T_COMMENT","\/\/ Watermark Vars\n",158],["T_WHITESPACE","\t",159],["T_COMMENT","\/\/ --------------------------------------------------------------------------\n",159],["T_WHITESPACE","\n\t",160],["T_DOC_COMMENT","\/**\n\t * Watermark text if graphic is not used\n\t *\n\t * @var string\n\t *\/",161],["T_WHITESPACE","\n\t",165],["T_PUBLIC","public",166],["T_WHITESPACE"," ",166],["T_VARIABLE","$wm_text",166],["T_WHITESPACE","\t\t\t",166],"=",["T_WHITESPACE"," ",166],["T_CONSTANT_ENCAPSED_STRING","''",166],";",["T_WHITESPACE","\n\n\t",166],["T_DOC_COMMENT","\/**\n\t * Type of watermarking.  Options:  text\/overlay\n\t *\n\t * @var string\n\t *\/",168],["T_WHITESPACE","\n\t",172],["T_PUBLIC","public",173],["T_WHITESPACE"," ",173],["T_VARIABLE","$wm_type",173],["T_WHITESPACE","\t\t\t",173],"=",["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","'text'",173],";",["T_WHITESPACE","\n\n\t",173],["T_DOC_COMMENT","\/**\n\t * Default transparency for watermark\n\t *\n\t * @var int\n\t *\/",175],["T_WHITESPACE","\n\t",179],["T_PUBLIC","public",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$wm_x_transp",180],["T_WHITESPACE","\t\t",180],"=",["T_WHITESPACE"," ",180],["T_LNUMBER","4",180],";",["T_WHITESPACE","\n\n\t",180],["T_DOC_COMMENT","\/**\n\t * Default transparency for watermark\n\t *\n\t * @var int\n\t *\/",182],["T_WHITESPACE","\n\t",186],["T_PUBLIC","public",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$wm_y_transp",187],["T_WHITESPACE","\t\t",187],"=",["T_WHITESPACE"," ",187],["T_LNUMBER","4",187],";",["T_WHITESPACE","\n\n\t",187],["T_DOC_COMMENT","\/**\n\t * Watermark image path\n\t *\n\t * @var string\n\t *\/",189],["T_WHITESPACE","\n\t",193],["T_PUBLIC","public",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$wm_overlay_path",194],["T_WHITESPACE","\t\t",194],"=",["T_WHITESPACE"," ",194],["T_CONSTANT_ENCAPSED_STRING","''",194],";",["T_WHITESPACE","\n\n\t",194],["T_DOC_COMMENT","\/**\n\t * TT font\n\t *\n\t * @var string\n\t *\/",196],["T_WHITESPACE","\n\t",200],["T_PUBLIC","public",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$wm_font_path",201],["T_WHITESPACE","\t\t",201],"=",["T_WHITESPACE"," ",201],["T_CONSTANT_ENCAPSED_STRING","''",201],";",["T_WHITESPACE","\n\n\t",201],["T_DOC_COMMENT","\/**\n\t * Font size (different versions of GD will either use points or pixels)\n\t *\n\t * @var int\n\t *\/",203],["T_WHITESPACE","\n\t",207],["T_PUBLIC","public",208],["T_WHITESPACE"," ",208],["T_VARIABLE","$wm_font_size",208],["T_WHITESPACE","\t\t",208],"=",["T_WHITESPACE"," ",208],["T_LNUMBER","17",208],";",["T_WHITESPACE","\n\n\t",208],["T_DOC_COMMENT","\/**\n\t * Vertical alignment:   T M B\n\t *\n\t * @var string\n\t *\/",210],["T_WHITESPACE","\n\t",214],["T_PUBLIC","public",215],["T_WHITESPACE"," ",215],["T_VARIABLE","$wm_vrt_alignment",215],["T_WHITESPACE","\t",215],"=",["T_WHITESPACE"," ",215],["T_CONSTANT_ENCAPSED_STRING","'B'",215],";",["T_WHITESPACE","\n\n\t",215],["T_DOC_COMMENT","\/**\n\t * Horizontal alignment: L R C\n\t *\n\t * @var string\n\t *\/",217],["T_WHITESPACE","\n\t",221],["T_PUBLIC","public",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$wm_hor_alignment",222],["T_WHITESPACE","\t",222],"=",["T_WHITESPACE"," ",222],["T_CONSTANT_ENCAPSED_STRING","'C'",222],";",["T_WHITESPACE","\n\n\t",222],["T_DOC_COMMENT","\/**\n\t * Padding around text\n\t *\n\t * @var int\n\t *\/",224],["T_WHITESPACE","\n\t",228],["T_PUBLIC","public",229],["T_WHITESPACE"," ",229],["T_VARIABLE","$wm_padding",229],["T_WHITESPACE","\t\t\t",229],"=",["T_WHITESPACE"," ",229],["T_LNUMBER","0",229],";",["T_WHITESPACE","\n\n\t",229],["T_DOC_COMMENT","\/**\n\t * Lets you push text to the right\n\t *\n\t * @var int\n\t *\/",231],["T_WHITESPACE","\n\t",235],["T_PUBLIC","public",236],["T_WHITESPACE"," ",236],["T_VARIABLE","$wm_hor_offset",236],["T_WHITESPACE","\t\t",236],"=",["T_WHITESPACE"," ",236],["T_LNUMBER","0",236],";",["T_WHITESPACE","\n\n\t",236],["T_DOC_COMMENT","\/**\n\t * Lets you push text down\n\t *\n\t * @var int\n\t *\/",238],["T_WHITESPACE","\n\t",242],["T_PUBLIC","public",243],["T_WHITESPACE"," ",243],["T_VARIABLE","$wm_vrt_offset",243],["T_WHITESPACE","\t\t",243],"=",["T_WHITESPACE"," ",243],["T_LNUMBER","0",243],";",["T_WHITESPACE","\n\n\t",243],["T_DOC_COMMENT","\/**\n\t * Text color\n\t *\n\t * @var string\n\t *\/",245],["T_WHITESPACE","\n\t",249],["T_PROTECTED","protected",250],["T_WHITESPACE"," ",250],["T_VARIABLE","$wm_font_color",250],["T_WHITESPACE","\t",250],"=",["T_WHITESPACE"," ",250],["T_CONSTANT_ENCAPSED_STRING","'#ffffff'",250],";",["T_WHITESPACE","\n\n\t",250],["T_DOC_COMMENT","\/**\n\t * Dropshadow color\n\t *\n\t * @var string\n\t *\/",252],["T_WHITESPACE","\n\t",256],["T_PROTECTED","protected",257],["T_WHITESPACE"," ",257],["T_VARIABLE","$wm_shadow_color",257],["T_WHITESPACE","\t",257],"=",["T_WHITESPACE"," ",257],["T_CONSTANT_ENCAPSED_STRING","''",257],";",["T_WHITESPACE","\n\n\t",257],["T_DOC_COMMENT","\/**\n\t * Dropshadow distance\n\t *\n\t * @var int\n\t *\/",259],["T_WHITESPACE","\n\t",263],["T_PUBLIC","public",264],["T_WHITESPACE"," ",264],["T_VARIABLE","$wm_shadow_distance",264],["T_WHITESPACE","\t",264],"=",["T_WHITESPACE"," ",264],["T_LNUMBER","2",264],";",["T_WHITESPACE","\n\n\t",264],["T_DOC_COMMENT","\/**\n\t * Image opacity: 1 - 100  Only works with image\n\t *\n\t * @var int\n\t *\/",266],["T_WHITESPACE","\n\t",270],["T_PUBLIC","public",271],["T_WHITESPACE"," ",271],["T_VARIABLE","$wm_opacity",271],["T_WHITESPACE","\t\t",271],"=",["T_WHITESPACE"," ",271],["T_LNUMBER","50",271],";",["T_WHITESPACE","\n\n\t",271],["T_COMMENT","\/\/ --------------------------------------------------------------------------\n",273],["T_WHITESPACE","\t",274],["T_COMMENT","\/\/ Private Vars\n",274],["T_WHITESPACE","\t",275],["T_COMMENT","\/\/ --------------------------------------------------------------------------\n",275],["T_WHITESPACE","\n\t",276],["T_DOC_COMMENT","\/**\n\t * Source image folder\n\t *\n\t * @var string\n\t *\/",277],["T_WHITESPACE","\n\t",281],["T_PUBLIC","public",282],["T_WHITESPACE"," ",282],["T_VARIABLE","$source_folder",282],["T_WHITESPACE","\t\t",282],"=",["T_WHITESPACE"," ",282],["T_CONSTANT_ENCAPSED_STRING","''",282],";",["T_WHITESPACE","\n\n\t",282],["T_DOC_COMMENT","\/**\n\t * Destination image folder\n\t *\n\t * @var string\n\t *\/",284],["T_WHITESPACE","\n\t",288],["T_PUBLIC","public",289],["T_WHITESPACE"," ",289],["T_VARIABLE","$dest_folder",289],["T_WHITESPACE","\t\t",289],"=",["T_WHITESPACE"," ",289],["T_CONSTANT_ENCAPSED_STRING","''",289],";",["T_WHITESPACE","\n\n\t",289],["T_DOC_COMMENT","\/**\n\t * Image mime-type\n\t *\n\t * @var string\n\t *\/",291],["T_WHITESPACE","\n\t",295],["T_PUBLIC","public",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$mime_type",296],["T_WHITESPACE","\t\t",296],"=",["T_WHITESPACE"," ",296],["T_CONSTANT_ENCAPSED_STRING","''",296],";",["T_WHITESPACE","\n\n\t",296],["T_DOC_COMMENT","\/**\n\t * Original image width\n\t *\n\t * @var int\n\t *\/",298],["T_WHITESPACE","\n\t",302],["T_PUBLIC","public",303],["T_WHITESPACE"," ",303],["T_VARIABLE","$orig_width",303],["T_WHITESPACE","\t\t",303],"=",["T_WHITESPACE"," ",303],["T_CONSTANT_ENCAPSED_STRING","''",303],";",["T_WHITESPACE","\n\n\t",303],["T_DOC_COMMENT","\/**\n\t * Original image height\n\t *\n\t * @var int\n\t *\/",305],["T_WHITESPACE","\n\t",309],["T_PUBLIC","public",310],["T_WHITESPACE"," ",310],["T_VARIABLE","$orig_height",310],["T_WHITESPACE","\t\t",310],"=",["T_WHITESPACE"," ",310],["T_CONSTANT_ENCAPSED_STRING","''",310],";",["T_WHITESPACE","\n\n\t",310],["T_DOC_COMMENT","\/**\n\t * Image format\n\t *\n\t * @var string\n\t *\/",312],["T_WHITESPACE","\n\t",316],["T_PUBLIC","public",317],["T_WHITESPACE"," ",317],["T_VARIABLE","$image_type",317],["T_WHITESPACE","\t\t",317],"=",["T_WHITESPACE"," ",317],["T_CONSTANT_ENCAPSED_STRING","''",317],";",["T_WHITESPACE","\n\n\t",317],["T_DOC_COMMENT","\/**\n\t * Size of current image\n\t *\n\t * @var string\n\t *\/",319],["T_WHITESPACE","\n\t",323],["T_PUBLIC","public",324],["T_WHITESPACE"," ",324],["T_VARIABLE","$size_str",324],["T_WHITESPACE","\t\t",324],"=",["T_WHITESPACE"," ",324],["T_CONSTANT_ENCAPSED_STRING","''",324],";",["T_WHITESPACE","\n\n\t",324],["T_DOC_COMMENT","\/**\n\t * Full path to source image\n\t *\n\t * @var string\n\t *\/",326],["T_WHITESPACE","\n\t",330],["T_PUBLIC","public",331],["T_WHITESPACE"," ",331],["T_VARIABLE","$full_src_path",331],["T_WHITESPACE","\t\t",331],"=",["T_WHITESPACE"," ",331],["T_CONSTANT_ENCAPSED_STRING","''",331],";",["T_WHITESPACE","\n\n\t",331],["T_DOC_COMMENT","\/**\n\t * Full path to destination image\n\t *\n\t * @var string\n\t *\/",333],["T_WHITESPACE","\n\t",337],["T_PUBLIC","public",338],["T_WHITESPACE"," ",338],["T_VARIABLE","$full_dst_path",338],["T_WHITESPACE","\t\t",338],"=",["T_WHITESPACE"," ",338],["T_CONSTANT_ENCAPSED_STRING","''",338],";",["T_WHITESPACE","\n\n\t",338],["T_DOC_COMMENT","\/**\n\t * File permissions\n\t *\n\t * @var\tint\n\t *\/",340],["T_WHITESPACE","\n\t",344],["T_PUBLIC","public",345],["T_WHITESPACE"," ",345],["T_VARIABLE","$file_permissions",345],["T_WHITESPACE"," ",345],"=",["T_WHITESPACE"," ",345],["T_LNUMBER","0644",345],";",["T_WHITESPACE","\n\n\t",345],["T_DOC_COMMENT","\/**\n\t * Name of function to create image\n\t *\n\t * @var string\n\t *\/",347],["T_WHITESPACE","\n\t",351],["T_PUBLIC","public",352],["T_WHITESPACE"," ",352],["T_VARIABLE","$create_fnc",352],["T_WHITESPACE","\t\t",352],"=",["T_WHITESPACE"," ",352],["T_CONSTANT_ENCAPSED_STRING","'imagecreatetruecolor'",352],";",["T_WHITESPACE","\n\n\t",352],["T_DOC_COMMENT","\/**\n\t * Name of function to copy image\n\t *\n\t * @var string\n\t *\/",354],["T_WHITESPACE","\n\t",358],["T_PUBLIC","public",359],["T_WHITESPACE"," ",359],["T_VARIABLE","$copy_fnc",359],["T_WHITESPACE","\t\t",359],"=",["T_WHITESPACE"," ",359],["T_CONSTANT_ENCAPSED_STRING","'imagecopyresampled'",359],";",["T_WHITESPACE","\n\n\t",359],["T_DOC_COMMENT","\/**\n\t * Error messages\n\t *\n\t * @var array\n\t *\/",361],["T_WHITESPACE","\n\t",365],["T_PUBLIC","public",366],["T_WHITESPACE"," ",366],["T_VARIABLE","$error_msg",366],["T_WHITESPACE","\t\t",366],"=",["T_WHITESPACE"," ",366],["T_ARRAY","array",366],"(",")",";",["T_WHITESPACE","\n\n\t",366],["T_DOC_COMMENT","\/**\n\t * Whether to have a drop shadow on watermark\n\t *\n\t * @var bool\n\t *\/",368],["T_WHITESPACE","\n\t",372],["T_PROTECTED","protected",373],["T_WHITESPACE"," ",373],["T_VARIABLE","$wm_use_drop_shadow",373],["T_WHITESPACE","\t",373],"=",["T_WHITESPACE"," ",373],["T_STRING","FALSE",373],";",["T_WHITESPACE","\n\n\t",373],["T_DOC_COMMENT","\/**\n\t * Whether to use truetype fonts\n\t *\n\t * @var bool\n\t *\/",375],["T_WHITESPACE","\n\t",379],["T_PUBLIC","public",380],["T_WHITESPACE"," ",380],["T_VARIABLE","$wm_use_truetype",380],["T_WHITESPACE","\t",380],"=",["T_WHITESPACE"," ",380],["T_STRING","FALSE",380],";",["T_WHITESPACE","\n\n\t",380],["T_DOC_COMMENT","\/**\n\t * Initialize Image Library\n\t *\n\t * @param\tarray\t$props\n\t * @return\tvoid\n\t *\/",382],["T_WHITESPACE","\n\t",387],["T_PUBLIC","public",388],["T_WHITESPACE"," ",388],["T_FUNCTION","function",388],["T_WHITESPACE"," ",388],["T_STRING","__construct",388],"(",["T_VARIABLE","$props",388],["T_WHITESPACE"," ",388],"=",["T_WHITESPACE"," ",388],["T_ARRAY","array",388],"(",")",")",["T_WHITESPACE","\n\t",388],"{",["T_WHITESPACE","\n\t\t",389],["T_IF","if",390],["T_WHITESPACE"," ",390],"(",["T_STRING","count",390],"(",["T_VARIABLE","$props",390],")",["T_WHITESPACE"," ",390],">",["T_WHITESPACE"," ",390],["T_LNUMBER","0",390],")",["T_WHITESPACE","\n\t\t",390],"{",["T_WHITESPACE","\n\t\t\t",391],["T_VARIABLE","$this",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","initialize",392],"(",["T_VARIABLE","$props",392],")",";",["T_WHITESPACE","\n\t\t",392],"}",["T_WHITESPACE","\n\n\t\t",393],["T_DOC_COMMENT","\/**\n\t\t * A work-around for some improperly formatted, but\n\t\t * usable JPEGs; known to be produced by Samsung\n\t\t * smartphones' front-facing cameras.\n\t\t *\n\t\t * @see\thttps:\/\/github.com\/bcit-ci\/CodeIgniter\/issues\/4967\n\t\t * @see\thttps:\/\/bugs.php.net\/bug.php?id=72404\n\t\t *\/",395],["T_WHITESPACE","\n\t\t",402],["T_STRING","ini_set",403],"(",["T_CONSTANT_ENCAPSED_STRING","'gd.jpeg_ignore_warning'",403],",",["T_WHITESPACE"," ",403],["T_LNUMBER","1",403],")",";",["T_WHITESPACE","\n\n\t\t",403],["T_STRING","log_message",405],"(",["T_CONSTANT_ENCAPSED_STRING","'info'",405],",",["T_WHITESPACE"," ",405],["T_CONSTANT_ENCAPSED_STRING","'Image Lib Class Initialized'",405],")",";",["T_WHITESPACE","\n\t",405],"}",["T_WHITESPACE","\n\n\t",406],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",408],["T_WHITESPACE","\n\t",409],["T_DOC_COMMENT","\/**\n\t * Initialize image properties\n\t *\n\t * Resets values in case this class is used in a loop\n\t *\n\t * @return\tvoid\n\t *\/",410],["T_WHITESPACE","\n\t",416],["T_PUBLIC","public",417],["T_WHITESPACE"," ",417],["T_FUNCTION","function",417],["T_WHITESPACE"," ",417],["T_STRING","clear",417],"(",")",["T_WHITESPACE","\n\t",417],"{",["T_WHITESPACE","\n\t\t",418],["T_VARIABLE","$props",419],["T_WHITESPACE"," ",419],"=",["T_WHITESPACE"," ",419],["T_ARRAY","array",419],"(",["T_CONSTANT_ENCAPSED_STRING","'thumb_marker'",419],",",["T_WHITESPACE"," ",419],["T_CONSTANT_ENCAPSED_STRING","'library_path'",419],",",["T_WHITESPACE"," ",419],["T_CONSTANT_ENCAPSED_STRING","'source_image'",419],",",["T_WHITESPACE"," ",419],["T_CONSTANT_ENCAPSED_STRING","'new_image'",419],",",["T_WHITESPACE"," ",419],["T_CONSTANT_ENCAPSED_STRING","'width'",419],",",["T_WHITESPACE"," ",419],["T_CONSTANT_ENCAPSED_STRING","'height'",419],",",["T_WHITESPACE"," ",419],["T_CONSTANT_ENCAPSED_STRING","'rotation_angle'",419],",",["T_WHITESPACE"," ",419],["T_CONSTANT_ENCAPSED_STRING","'x_axis'",419],",",["T_WHITESPACE"," ",419],["T_CONSTANT_ENCAPSED_STRING","'y_axis'",419],",",["T_WHITESPACE"," ",419],["T_CONSTANT_ENCAPSED_STRING","'wm_text'",419],",",["T_WHITESPACE"," ",419],["T_CONSTANT_ENCAPSED_STRING","'wm_overlay_path'",419],",",["T_WHITESPACE"," ",419],["T_CONSTANT_ENCAPSED_STRING","'wm_font_path'",419],",",["T_WHITESPACE"," ",419],["T_CONSTANT_ENCAPSED_STRING","'wm_shadow_color'",419],",",["T_WHITESPACE"," ",419],["T_CONSTANT_ENCAPSED_STRING","'source_folder'",419],",",["T_WHITESPACE"," ",419],["T_CONSTANT_ENCAPSED_STRING","'dest_folder'",419],",",["T_WHITESPACE"," ",419],["T_CONSTANT_ENCAPSED_STRING","'mime_type'",419],",",["T_WHITESPACE"," ",419],["T_CONSTANT_ENCAPSED_STRING","'orig_width'",419],",",["T_WHITESPACE"," ",419],["T_CONSTANT_ENCAPSED_STRING","'orig_height'",419],",",["T_WHITESPACE"," ",419],["T_CONSTANT_ENCAPSED_STRING","'image_type'",419],",",["T_WHITESPACE"," ",419],["T_CONSTANT_ENCAPSED_STRING","'size_str'",419],",",["T_WHITESPACE"," ",419],["T_CONSTANT_ENCAPSED_STRING","'full_src_path'",419],",",["T_WHITESPACE"," ",419],["T_CONSTANT_ENCAPSED_STRING","'full_dst_path'",419],")",";",["T_WHITESPACE","\n\n\t\t",419],["T_FOREACH","foreach",421],["T_WHITESPACE"," ",421],"(",["T_VARIABLE","$props",421],["T_WHITESPACE"," ",421],["T_AS","as",421],["T_WHITESPACE"," ",421],["T_VARIABLE","$val",421],")",["T_WHITESPACE","\n\t\t",421],"{",["T_WHITESPACE","\n\t\t\t",422],["T_VARIABLE","$this",423],["T_OBJECT_OPERATOR","->",423],["T_VARIABLE","$val",423],["T_WHITESPACE"," ",423],"=",["T_WHITESPACE"," ",423],["T_CONSTANT_ENCAPSED_STRING","''",423],";",["T_WHITESPACE","\n\t\t",423],"}",["T_WHITESPACE","\n\n\t\t",424],["T_VARIABLE","$this",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","image_library",426],["T_WHITESPACE"," \t\t",426],"=",["T_WHITESPACE"," ",426],["T_CONSTANT_ENCAPSED_STRING","'gd2'",426],";",["T_WHITESPACE","\n\t\t",426],["T_VARIABLE","$this",427],["T_OBJECT_OPERATOR","->",427],["T_STRING","dynamic_output",427],["T_WHITESPACE"," \t\t",427],"=",["T_WHITESPACE"," ",427],["T_STRING","FALSE",427],";",["T_WHITESPACE","\n\t\t",427],["T_VARIABLE","$this",428],["T_OBJECT_OPERATOR","->",428],["T_STRING","quality",428],["T_WHITESPACE"," \t\t\t\t",428],"=",["T_WHITESPACE"," ",428],["T_LNUMBER","90",428],";",["T_WHITESPACE","\n\t\t",428],["T_VARIABLE","$this",429],["T_OBJECT_OPERATOR","->",429],["T_STRING","create_thumb",429],["T_WHITESPACE"," \t\t",429],"=",["T_WHITESPACE"," ",429],["T_STRING","FALSE",429],";",["T_WHITESPACE","\n\t\t",429],["T_VARIABLE","$this",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","thumb_marker",430],["T_WHITESPACE"," \t\t",430],"=",["T_WHITESPACE"," ",430],["T_CONSTANT_ENCAPSED_STRING","'_thumb'",430],";",["T_WHITESPACE","\n\t\t",430],["T_VARIABLE","$this",431],["T_OBJECT_OPERATOR","->",431],["T_STRING","maintain_ratio",431],["T_WHITESPACE"," \t\t",431],"=",["T_WHITESPACE"," ",431],["T_STRING","TRUE",431],";",["T_WHITESPACE","\n\t\t",431],["T_VARIABLE","$this",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","master_dim",432],["T_WHITESPACE"," \t\t\t",432],"=",["T_WHITESPACE"," ",432],["T_CONSTANT_ENCAPSED_STRING","'auto'",432],";",["T_WHITESPACE","\n\t\t",432],["T_VARIABLE","$this",433],["T_OBJECT_OPERATOR","->",433],["T_STRING","wm_type",433],["T_WHITESPACE"," \t\t\t\t",433],"=",["T_WHITESPACE"," ",433],["T_CONSTANT_ENCAPSED_STRING","'text'",433],";",["T_WHITESPACE","\n\t\t",433],["T_VARIABLE","$this",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","wm_x_transp",434],["T_WHITESPACE"," \t\t\t",434],"=",["T_WHITESPACE"," ",434],["T_LNUMBER","4",434],";",["T_WHITESPACE","\n\t\t",434],["T_VARIABLE","$this",435],["T_OBJECT_OPERATOR","->",435],["T_STRING","wm_y_transp",435],["T_WHITESPACE"," \t\t\t",435],"=",["T_WHITESPACE"," ",435],["T_LNUMBER","4",435],";",["T_WHITESPACE","\n\t\t",435],["T_VARIABLE","$this",436],["T_OBJECT_OPERATOR","->",436],["T_STRING","wm_font_size",436],["T_WHITESPACE"," \t\t",436],"=",["T_WHITESPACE"," ",436],["T_LNUMBER","17",436],";",["T_WHITESPACE","\n\t\t",436],["T_VARIABLE","$this",437],["T_OBJECT_OPERATOR","->",437],["T_STRING","wm_vrt_alignment",437],["T_WHITESPACE"," \t",437],"=",["T_WHITESPACE"," ",437],["T_CONSTANT_ENCAPSED_STRING","'B'",437],";",["T_WHITESPACE","\n\t\t",437],["T_VARIABLE","$this",438],["T_OBJECT_OPERATOR","->",438],["T_STRING","wm_hor_alignment",438],["T_WHITESPACE"," \t",438],"=",["T_WHITESPACE"," ",438],["T_CONSTANT_ENCAPSED_STRING","'C'",438],";",["T_WHITESPACE","\n\t\t",438],["T_VARIABLE","$this",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","wm_padding",439],["T_WHITESPACE"," \t\t\t",439],"=",["T_WHITESPACE"," ",439],["T_LNUMBER","0",439],";",["T_WHITESPACE","\n\t\t",439],["T_VARIABLE","$this",440],["T_OBJECT_OPERATOR","->",440],["T_STRING","wm_hor_offset",440],["T_WHITESPACE"," \t\t",440],"=",["T_WHITESPACE"," ",440],["T_LNUMBER","0",440],";",["T_WHITESPACE","\n\t\t",440],["T_VARIABLE","$this",441],["T_OBJECT_OPERATOR","->",441],["T_STRING","wm_vrt_offset",441],["T_WHITESPACE"," \t\t",441],"=",["T_WHITESPACE"," ",441],["T_LNUMBER","0",441],";",["T_WHITESPACE","\n\t\t",441],["T_VARIABLE","$this",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","wm_font_color",442],["T_WHITESPACE","\t\t",442],"=",["T_WHITESPACE"," ",442],["T_CONSTANT_ENCAPSED_STRING","'#ffffff'",442],";",["T_WHITESPACE","\n\t\t",442],["T_VARIABLE","$this",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","wm_shadow_distance",443],["T_WHITESPACE"," \t",443],"=",["T_WHITESPACE"," ",443],["T_LNUMBER","2",443],";",["T_WHITESPACE","\n\t\t",443],["T_VARIABLE","$this",444],["T_OBJECT_OPERATOR","->",444],["T_STRING","wm_opacity",444],["T_WHITESPACE"," \t\t\t",444],"=",["T_WHITESPACE"," ",444],["T_LNUMBER","50",444],";",["T_WHITESPACE","\n\t\t",444],["T_VARIABLE","$this",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","create_fnc",445],["T_WHITESPACE"," \t\t\t",445],"=",["T_WHITESPACE"," ",445],["T_CONSTANT_ENCAPSED_STRING","'imagecreatetruecolor'",445],";",["T_WHITESPACE","\n\t\t",445],["T_VARIABLE","$this",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","copy_fnc",446],["T_WHITESPACE"," \t\t\t",446],"=",["T_WHITESPACE"," ",446],["T_CONSTANT_ENCAPSED_STRING","'imagecopyresampled'",446],";",["T_WHITESPACE","\n\t\t",446],["T_VARIABLE","$this",447],["T_OBJECT_OPERATOR","->",447],["T_STRING","error_msg",447],["T_WHITESPACE"," \t\t\t",447],"=",["T_WHITESPACE"," ",447],["T_ARRAY","array",447],"(",")",";",["T_WHITESPACE","\n\t\t",447],["T_VARIABLE","$this",448],["T_OBJECT_OPERATOR","->",448],["T_STRING","wm_use_drop_shadow",448],["T_WHITESPACE"," \t",448],"=",["T_WHITESPACE"," ",448],["T_STRING","FALSE",448],";",["T_WHITESPACE","\n\t\t",448],["T_VARIABLE","$this",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","wm_use_truetype",449],["T_WHITESPACE"," \t\t",449],"=",["T_WHITESPACE"," ",449],["T_STRING","FALSE",449],";",["T_WHITESPACE","\n\t",449],"}",["T_WHITESPACE","\n\n\t",450],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",452],["T_WHITESPACE","\n\t",453],["T_DOC_COMMENT","\/**\n\t * initialize image preferences\n\t *\n\t * @param\tarray\n\t * @return\tbool\n\t *\/",454],["T_WHITESPACE","\n\t",459],["T_PUBLIC","public",460],["T_WHITESPACE"," ",460],["T_FUNCTION","function",460],["T_WHITESPACE"," ",460],["T_STRING","initialize",460],"(",["T_VARIABLE","$props",460],["T_WHITESPACE"," ",460],"=",["T_WHITESPACE"," ",460],["T_ARRAY","array",460],"(",")",")",["T_WHITESPACE","\n\t",460],"{",["T_WHITESPACE","\n\t\t",461],["T_COMMENT","\/\/ Convert array elements into class variables\n",462],["T_WHITESPACE","\t\t",463],["T_IF","if",463],["T_WHITESPACE"," ",463],"(",["T_STRING","count",463],"(",["T_VARIABLE","$props",463],")",["T_WHITESPACE"," ",463],">",["T_WHITESPACE"," ",463],["T_LNUMBER","0",463],")",["T_WHITESPACE","\n\t\t",463],"{",["T_WHITESPACE","\n\t\t\t",464],["T_FOREACH","foreach",465],["T_WHITESPACE"," ",465],"(",["T_VARIABLE","$props",465],["T_WHITESPACE"," ",465],["T_AS","as",465],["T_WHITESPACE"," ",465],["T_VARIABLE","$key",465],["T_WHITESPACE"," ",465],["T_DOUBLE_ARROW","=>",465],["T_WHITESPACE"," ",465],["T_VARIABLE","$val",465],")",["T_WHITESPACE","\n\t\t\t",465],"{",["T_WHITESPACE","\n\t\t\t\t",466],["T_IF","if",467],["T_WHITESPACE"," ",467],"(",["T_STRING","property_exists",467],"(",["T_VARIABLE","$this",467],",",["T_WHITESPACE"," ",467],["T_VARIABLE","$key",467],")",")",["T_WHITESPACE","\n\t\t\t\t",467],"{",["T_WHITESPACE","\n\t\t\t\t\t",468],["T_IF","if",469],["T_WHITESPACE"," ",469],"(",["T_STRING","in_array",469],"(",["T_VARIABLE","$key",469],",",["T_WHITESPACE"," ",469],["T_ARRAY","array",469],"(",["T_CONSTANT_ENCAPSED_STRING","'wm_font_color'",469],",",["T_WHITESPACE"," ",469],["T_CONSTANT_ENCAPSED_STRING","'wm_shadow_color'",469],")",",",["T_WHITESPACE"," ",469],["T_STRING","TRUE",469],")",")",["T_WHITESPACE","\n\t\t\t\t\t",469],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",470],["T_IF","if",471],["T_WHITESPACE"," ",471],"(",["T_STRING","preg_match",471],"(",["T_CONSTANT_ENCAPSED_STRING","'\/^#?([0-9a-f]{3}|[0-9a-f]{6})$\/i'",471],",",["T_WHITESPACE"," ",471],["T_VARIABLE","$val",471],",",["T_WHITESPACE"," ",471],["T_VARIABLE","$matches",471],")",")",["T_WHITESPACE","\n\t\t\t\t\t\t",471],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",472],["T_COMMENT","\/* $matches[1] contains our hex color value, but it might be\n\t\t\t\t\t\t\t * both in the full 6-length format or the shortened 3-length\n\t\t\t\t\t\t\t * value.\n\t\t\t\t\t\t\t * We'll later need the full version, so we keep it if it's\n\t\t\t\t\t\t\t * already there and if not - we'll convert to it. We can\n\t\t\t\t\t\t\t * access string characters by their index as in an array,\n\t\t\t\t\t\t\t * so we'll do that and use concatenation to form the final\n\t\t\t\t\t\t\t * value:\n\t\t\t\t\t\t\t *\/",473],["T_WHITESPACE","\n\t\t\t\t\t\t\t",481],["T_VARIABLE","$val",482],["T_WHITESPACE"," ",482],"=",["T_WHITESPACE"," ",482],"(",["T_STRING","strlen",482],"(",["T_VARIABLE","$matches",482],"[",["T_LNUMBER","1",482],"]",")",["T_WHITESPACE"," ",482],["T_IS_IDENTICAL","===",482],["T_WHITESPACE"," ",482],["T_LNUMBER","6",482],")",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",482],"?",["T_WHITESPACE"," ",483],["T_CONSTANT_ENCAPSED_STRING","'#'",483],".",["T_VARIABLE","$matches",483],"[",["T_LNUMBER","1",483],"]",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",483],":",["T_WHITESPACE"," ",484],["T_CONSTANT_ENCAPSED_STRING","'#'",484],".",["T_VARIABLE","$matches",484],"[",["T_LNUMBER","1",484],"]","[",["T_LNUMBER","0",484],"]",".",["T_VARIABLE","$matches",484],"[",["T_LNUMBER","1",484],"]","[",["T_LNUMBER","0",484],"]",".",["T_VARIABLE","$matches",484],"[",["T_LNUMBER","1",484],"]","[",["T_LNUMBER","1",484],"]",".",["T_VARIABLE","$matches",484],"[",["T_LNUMBER","1",484],"]","[",["T_LNUMBER","1",484],"]",".",["T_VARIABLE","$matches",484],"[",["T_LNUMBER","1",484],"]","[",["T_LNUMBER","2",484],"]",".",["T_VARIABLE","$matches",484],"[",["T_LNUMBER","1",484],"]","[",["T_LNUMBER","2",484],"]",";",["T_WHITESPACE","\n\t\t\t\t\t\t",484],"}",["T_WHITESPACE","\n\t\t\t\t\t\t",485],["T_ELSE","else",486],["T_WHITESPACE","\n\t\t\t\t\t\t",486],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",487],["T_CONTINUE","continue",488],";",["T_WHITESPACE","\n\t\t\t\t\t\t",488],"}",["T_WHITESPACE","\n\t\t\t\t\t",489],"}",["T_WHITESPACE","\n\t\t\t\t\t",490],["T_ELSEIF","elseif",491],["T_WHITESPACE"," ",491],"(",["T_STRING","in_array",491],"(",["T_VARIABLE","$key",491],",",["T_WHITESPACE"," ",491],["T_ARRAY","array",491],"(",["T_CONSTANT_ENCAPSED_STRING","'width'",491],",",["T_WHITESPACE"," ",491],["T_CONSTANT_ENCAPSED_STRING","'height'",491],")",",",["T_WHITESPACE"," ",491],["T_STRING","TRUE",491],")",["T_WHITESPACE"," ",491],["T_BOOLEAN_AND","&&",491],["T_WHITESPACE"," ",491],"!",["T_WHITESPACE"," ",491],["T_STRING","ctype_digit",491],"(",["T_STRING_CAST","(string)",491],["T_WHITESPACE"," ",491],["T_VARIABLE","$val",491],")",")",["T_WHITESPACE","\n\t\t\t\t\t",491],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",492],["T_CONTINUE","continue",493],";",["T_WHITESPACE","\n\t\t\t\t\t",493],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",494],["T_VARIABLE","$this",496],["T_OBJECT_OPERATOR","->",496],["T_VARIABLE","$key",496],["T_WHITESPACE"," ",496],"=",["T_WHITESPACE"," ",496],["T_VARIABLE","$val",496],";",["T_WHITESPACE","\n\t\t\t\t",496],"}",["T_WHITESPACE","\n\t\t\t",497],"}",["T_WHITESPACE","\n\t\t",498],"}",["T_WHITESPACE","\n\n\t\t",499],["T_COMMENT","\/\/ Is there a source image? If not, there's no reason to continue\n",501],["T_WHITESPACE","\t\t",502],["T_IF","if",502],["T_WHITESPACE"," ",502],"(",["T_VARIABLE","$this",502],["T_OBJECT_OPERATOR","->",502],["T_STRING","source_image",502],["T_WHITESPACE"," ",502],["T_IS_IDENTICAL","===",502],["T_WHITESPACE"," ",502],["T_CONSTANT_ENCAPSED_STRING","''",502],")",["T_WHITESPACE","\n\t\t",502],"{",["T_WHITESPACE","\n\t\t\t",503],["T_VARIABLE","$this",504],["T_OBJECT_OPERATOR","->",504],["T_STRING","set_error",504],"(",["T_CONSTANT_ENCAPSED_STRING","'imglib_source_image_required'",504],")",";",["T_WHITESPACE","\n\t\t\t",504],["T_RETURN","return",505],["T_WHITESPACE"," ",505],["T_STRING","FALSE",505],";",["T_WHITESPACE","\n\t\t",505],"}",["T_WHITESPACE","\n\n\t\t",506],["T_COMMENT","\/* Is getimagesize() available?\n\t\t *\n\t\t * We use it to determine the image properties (width\/height).\n\t\t * Note: We need to figure out how to determine image\n\t\t * properties using ImageMagick and NetPBM\n\t\t *\/",508],["T_WHITESPACE","\n\t\t",513],["T_IF","if",514],["T_WHITESPACE"," ",514],"(",["T_WHITESPACE"," ",514],"!",["T_WHITESPACE"," ",514],["T_STRING","function_exists",514],"(",["T_CONSTANT_ENCAPSED_STRING","'getimagesize'",514],")",")",["T_WHITESPACE","\n\t\t",514],"{",["T_WHITESPACE","\n\t\t\t",515],["T_VARIABLE","$this",516],["T_OBJECT_OPERATOR","->",516],["T_STRING","set_error",516],"(",["T_CONSTANT_ENCAPSED_STRING","'imglib_gd_required_for_props'",516],")",";",["T_WHITESPACE","\n\t\t\t",516],["T_RETURN","return",517],["T_WHITESPACE"," ",517],["T_STRING","FALSE",517],";",["T_WHITESPACE","\n\t\t",517],"}",["T_WHITESPACE","\n\n\t\t",518],["T_VARIABLE","$this",520],["T_OBJECT_OPERATOR","->",520],["T_STRING","image_library",520],["T_WHITESPACE"," ",520],"=",["T_WHITESPACE"," ",520],["T_STRING","strtolower",520],"(",["T_VARIABLE","$this",520],["T_OBJECT_OPERATOR","->",520],["T_STRING","image_library",520],")",";",["T_WHITESPACE","\n\n\t\t",520],["T_COMMENT","\/* Set the full server path\n\t\t *\n\t\t * The source image may or may not contain a path.\n\t\t * Either way, we'll try use realpath to generate the\n\t\t * full server path in order to more reliably read it.\n\t\t *\/",522],["T_WHITESPACE","\n\t\t",527],["T_IF","if",528],["T_WHITESPACE"," ",528],"(","(",["T_VARIABLE","$full_source_path",528],["T_WHITESPACE"," ",528],"=",["T_WHITESPACE"," ",528],["T_STRING","realpath",528],"(",["T_VARIABLE","$this",528],["T_OBJECT_OPERATOR","->",528],["T_STRING","source_image",528],")",")",["T_WHITESPACE"," ",528],["T_IS_NOT_IDENTICAL","!==",528],["T_WHITESPACE"," ",528],["T_STRING","FALSE",528],")",["T_WHITESPACE","\n\t\t",528],"{",["T_WHITESPACE","\n\t\t\t",529],["T_VARIABLE","$full_source_path",530],["T_WHITESPACE"," ",530],"=",["T_WHITESPACE"," ",530],["T_STRING","str_replace",530],"(",["T_CONSTANT_ENCAPSED_STRING","'\\\\'",530],",",["T_WHITESPACE"," ",530],["T_CONSTANT_ENCAPSED_STRING","'\/'",530],",",["T_WHITESPACE"," ",530],["T_VARIABLE","$full_source_path",530],")",";",["T_WHITESPACE","\n\t\t",530],"}",["T_WHITESPACE","\n\t\t",531],["T_ELSE","else",532],["T_WHITESPACE","\n\t\t",532],"{",["T_WHITESPACE","\n\t\t\t",533],["T_VARIABLE","$full_source_path",534],["T_WHITESPACE"," ",534],"=",["T_WHITESPACE"," ",534],["T_VARIABLE","$this",534],["T_OBJECT_OPERATOR","->",534],["T_STRING","source_image",534],";",["T_WHITESPACE","\n\t\t",534],"}",["T_WHITESPACE","\n\n\t\t",535],["T_VARIABLE","$x",537],["T_WHITESPACE"," ",537],"=",["T_WHITESPACE"," ",537],["T_STRING","explode",537],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",537],",",["T_WHITESPACE"," ",537],["T_VARIABLE","$full_source_path",537],")",";",["T_WHITESPACE","\n\t\t",537],["T_VARIABLE","$this",538],["T_OBJECT_OPERATOR","->",538],["T_STRING","source_image",538],["T_WHITESPACE"," ",538],"=",["T_WHITESPACE"," ",538],["T_STRING","end",538],"(",["T_VARIABLE","$x",538],")",";",["T_WHITESPACE","\n\t\t",538],["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","source_folder",539],["T_WHITESPACE"," ",539],"=",["T_WHITESPACE"," ",539],["T_STRING","str_replace",539],"(",["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","source_image",539],",",["T_WHITESPACE"," ",539],["T_CONSTANT_ENCAPSED_STRING","''",539],",",["T_WHITESPACE"," ",539],["T_VARIABLE","$full_source_path",539],")",";",["T_WHITESPACE","\n\n\t\t",539],["T_COMMENT","\/\/ Set the Image Properties\n",541],["T_WHITESPACE","\t\t",542],["T_IF","if",542],["T_WHITESPACE"," ",542],"(",["T_WHITESPACE"," ",542],"!",["T_WHITESPACE"," ",542],["T_VARIABLE","$this",542],["T_OBJECT_OPERATOR","->",542],["T_STRING","get_image_properties",542],"(",["T_VARIABLE","$this",542],["T_OBJECT_OPERATOR","->",542],["T_STRING","source_folder",542],".",["T_VARIABLE","$this",542],["T_OBJECT_OPERATOR","->",542],["T_STRING","source_image",542],")",")",["T_WHITESPACE","\n\t\t",542],"{",["T_WHITESPACE","\n\t\t\t",543],["T_RETURN","return",544],["T_WHITESPACE"," ",544],["T_STRING","FALSE",544],";",["T_WHITESPACE","\n\t\t",544],"}",["T_WHITESPACE","\n\n\t\t",545],["T_COMMENT","\/*\n\t\t * Assign the \"new\" image name\/path\n\t\t *\n\t\t * If the user has set a \"new_image\" name it means\n\t\t * we are making a copy of the source image. If not\n\t\t * it means we are altering the original. We'll\n\t\t * set the destination filename and path accordingly.\n\t\t *\/",547],["T_WHITESPACE","\n\t\t",554],["T_IF","if",555],["T_WHITESPACE"," ",555],"(",["T_VARIABLE","$this",555],["T_OBJECT_OPERATOR","->",555],["T_STRING","new_image",555],["T_WHITESPACE"," ",555],["T_IS_IDENTICAL","===",555],["T_WHITESPACE"," ",555],["T_CONSTANT_ENCAPSED_STRING","''",555],")",["T_WHITESPACE","\n\t\t",555],"{",["T_WHITESPACE","\n\t\t\t",556],["T_VARIABLE","$this",557],["T_OBJECT_OPERATOR","->",557],["T_STRING","dest_image",557],["T_WHITESPACE","  ",557],"=",["T_WHITESPACE"," ",557],["T_VARIABLE","$this",557],["T_OBJECT_OPERATOR","->",557],["T_STRING","source_image",557],";",["T_WHITESPACE","\n\t\t\t",557],["T_VARIABLE","$this",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","dest_folder",558],["T_WHITESPACE"," ",558],"=",["T_WHITESPACE"," ",558],["T_VARIABLE","$this",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","source_folder",558],";",["T_WHITESPACE","\n\t\t",558],"}",["T_WHITESPACE","\n\t\t",559],["T_ELSEIF","elseif",560],["T_WHITESPACE"," ",560],"(",["T_STRING","strpos",560],"(",["T_VARIABLE","$this",560],["T_OBJECT_OPERATOR","->",560],["T_STRING","new_image",560],",",["T_WHITESPACE"," ",560],["T_CONSTANT_ENCAPSED_STRING","'\/'",560],")",["T_WHITESPACE"," ",560],["T_IS_IDENTICAL","===",560],["T_WHITESPACE"," ",560],["T_STRING","FALSE",560],["T_WHITESPACE"," ",560],["T_BOOLEAN_AND","&&",560],["T_WHITESPACE"," ",560],["T_STRING","strpos",560],"(",["T_VARIABLE","$this",560],["T_OBJECT_OPERATOR","->",560],["T_STRING","new_image",560],",",["T_WHITESPACE"," ",560],["T_CONSTANT_ENCAPSED_STRING","'\\\\'",560],")",["T_WHITESPACE"," ",560],["T_IS_IDENTICAL","===",560],["T_WHITESPACE"," ",560],["T_STRING","FALSE",560],")",["T_WHITESPACE","\n\t\t",560],"{",["T_WHITESPACE","\n\t\t\t",561],["T_VARIABLE","$this",562],["T_OBJECT_OPERATOR","->",562],["T_STRING","dest_image",562],["T_WHITESPACE","  ",562],"=",["T_WHITESPACE"," ",562],["T_VARIABLE","$this",562],["T_OBJECT_OPERATOR","->",562],["T_STRING","new_image",562],";",["T_WHITESPACE","\n\t\t\t",562],["T_VARIABLE","$this",563],["T_OBJECT_OPERATOR","->",563],["T_STRING","dest_folder",563],["T_WHITESPACE"," ",563],"=",["T_WHITESPACE"," ",563],["T_VARIABLE","$this",563],["T_OBJECT_OPERATOR","->",563],["T_STRING","source_folder",563],";",["T_WHITESPACE","\n\t\t",563],"}",["T_WHITESPACE","\n\t\t",564],["T_ELSE","else",565],["T_WHITESPACE","\n\t\t",565],"{",["T_WHITESPACE","\n\t\t\t",566],["T_COMMENT","\/\/ Is there a file name?\n",567],["T_WHITESPACE","\t\t\t",568],["T_IF","if",568],["T_WHITESPACE"," ",568],"(",["T_WHITESPACE"," ",568],"!",["T_WHITESPACE"," ",568],["T_STRING","preg_match",568],"(",["T_CONSTANT_ENCAPSED_STRING","'#\\.(jpg|jpeg|gif|png)$#i'",568],",",["T_WHITESPACE"," ",568],["T_VARIABLE","$this",568],["T_OBJECT_OPERATOR","->",568],["T_STRING","new_image",568],")",")",["T_WHITESPACE","\n\t\t\t",568],"{",["T_WHITESPACE","\n\t\t\t\t",569],["T_VARIABLE","$this",570],["T_OBJECT_OPERATOR","->",570],["T_STRING","dest_image",570],["T_WHITESPACE","  ",570],"=",["T_WHITESPACE"," ",570],["T_VARIABLE","$this",570],["T_OBJECT_OPERATOR","->",570],["T_STRING","source_image",570],";",["T_WHITESPACE","\n\t\t\t\t",570],["T_VARIABLE","$this",571],["T_OBJECT_OPERATOR","->",571],["T_STRING","dest_folder",571],["T_WHITESPACE"," ",571],"=",["T_WHITESPACE"," ",571],["T_VARIABLE","$this",571],["T_OBJECT_OPERATOR","->",571],["T_STRING","new_image",571],";",["T_WHITESPACE","\n\t\t\t",571],"}",["T_WHITESPACE","\n\t\t\t",572],["T_ELSE","else",573],["T_WHITESPACE","\n\t\t\t",573],"{",["T_WHITESPACE","\n\t\t\t\t",574],["T_VARIABLE","$x",575],["T_WHITESPACE"," ",575],"=",["T_WHITESPACE"," ",575],["T_STRING","explode",575],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",575],",",["T_WHITESPACE"," ",575],["T_STRING","str_replace",575],"(",["T_CONSTANT_ENCAPSED_STRING","'\\\\'",575],",",["T_WHITESPACE"," ",575],["T_CONSTANT_ENCAPSED_STRING","'\/'",575],",",["T_WHITESPACE"," ",575],["T_VARIABLE","$this",575],["T_OBJECT_OPERATOR","->",575],["T_STRING","new_image",575],")",")",";",["T_WHITESPACE","\n\t\t\t\t",575],["T_VARIABLE","$this",576],["T_OBJECT_OPERATOR","->",576],["T_STRING","dest_image",576],["T_WHITESPACE","  ",576],"=",["T_WHITESPACE"," ",576],["T_STRING","end",576],"(",["T_VARIABLE","$x",576],")",";",["T_WHITESPACE","\n\t\t\t\t",576],["T_VARIABLE","$this",577],["T_OBJECT_OPERATOR","->",577],["T_STRING","dest_folder",577],["T_WHITESPACE"," ",577],"=",["T_WHITESPACE"," ",577],["T_STRING","str_replace",577],"(",["T_VARIABLE","$this",577],["T_OBJECT_OPERATOR","->",577],["T_STRING","dest_image",577],",",["T_WHITESPACE"," ",577],["T_CONSTANT_ENCAPSED_STRING","''",577],",",["T_WHITESPACE"," ",577],["T_VARIABLE","$this",577],["T_OBJECT_OPERATOR","->",577],["T_STRING","new_image",577],")",";",["T_WHITESPACE","\n\t\t\t",577],"}",["T_WHITESPACE","\n\n\t\t\t",578],["T_VARIABLE","$this",580],["T_OBJECT_OPERATOR","->",580],["T_STRING","dest_folder",580],["T_WHITESPACE"," ",580],"=",["T_WHITESPACE"," ",580],["T_STRING","realpath",580],"(",["T_VARIABLE","$this",580],["T_OBJECT_OPERATOR","->",580],["T_STRING","dest_folder",580],")",".",["T_CONSTANT_ENCAPSED_STRING","'\/'",580],";",["T_WHITESPACE","\n\t\t",580],"}",["T_WHITESPACE","\n\n\t\t",581],["T_COMMENT","\/* Compile the finalized filenames\/paths\n\t\t *\n\t\t * We'll create two master strings containing the\n\t\t * full server path to the source image and the\n\t\t * full server path to the destination image.\n\t\t * We'll also split the destination image name\n\t\t * so we can insert the thumbnail marker if needed.\n\t\t *\/",583],["T_WHITESPACE","\n\t\t",590],["T_IF","if",591],["T_WHITESPACE"," ",591],"(",["T_VARIABLE","$this",591],["T_OBJECT_OPERATOR","->",591],["T_STRING","create_thumb",591],["T_WHITESPACE"," ",591],["T_IS_IDENTICAL","===",591],["T_WHITESPACE"," ",591],["T_STRING","FALSE",591],["T_WHITESPACE"," ",591],["T_LOGICAL_OR","OR",591],["T_WHITESPACE"," ",591],["T_VARIABLE","$this",591],["T_OBJECT_OPERATOR","->",591],["T_STRING","thumb_marker",591],["T_WHITESPACE"," ",591],["T_IS_IDENTICAL","===",591],["T_WHITESPACE"," ",591],["T_CONSTANT_ENCAPSED_STRING","''",591],")",["T_WHITESPACE","\n\t\t",591],"{",["T_WHITESPACE","\n\t\t\t",592],["T_VARIABLE","$this",593],["T_OBJECT_OPERATOR","->",593],["T_STRING","thumb_marker",593],["T_WHITESPACE"," ",593],"=",["T_WHITESPACE"," ",593],["T_CONSTANT_ENCAPSED_STRING","''",593],";",["T_WHITESPACE","\n\t\t",593],"}",["T_WHITESPACE","\n\n\t\t",594],["T_VARIABLE","$xp",596],["T_WHITESPACE"," ",596],"=",["T_WHITESPACE"," ",596],["T_VARIABLE","$this",596],["T_OBJECT_OPERATOR","->",596],["T_STRING","explode_name",596],"(",["T_VARIABLE","$this",596],["T_OBJECT_OPERATOR","->",596],["T_STRING","dest_image",596],")",";",["T_WHITESPACE","\n\n\t\t",596],["T_VARIABLE","$filename",598],["T_WHITESPACE"," ",598],"=",["T_WHITESPACE"," ",598],["T_VARIABLE","$xp",598],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",598],"]",";",["T_WHITESPACE","\n\t\t",598],["T_VARIABLE","$file_ext",599],["T_WHITESPACE"," ",599],"=",["T_WHITESPACE"," ",599],["T_VARIABLE","$xp",599],"[",["T_CONSTANT_ENCAPSED_STRING","'ext'",599],"]",";",["T_WHITESPACE","\n\n\t\t",599],["T_VARIABLE","$this",601],["T_OBJECT_OPERATOR","->",601],["T_STRING","full_src_path",601],["T_WHITESPACE"," ",601],"=",["T_WHITESPACE"," ",601],["T_VARIABLE","$this",601],["T_OBJECT_OPERATOR","->",601],["T_STRING","source_folder",601],".",["T_VARIABLE","$this",601],["T_OBJECT_OPERATOR","->",601],["T_STRING","source_image",601],";",["T_WHITESPACE","\n\t\t",601],["T_VARIABLE","$this",602],["T_OBJECT_OPERATOR","->",602],["T_STRING","full_dst_path",602],["T_WHITESPACE"," ",602],"=",["T_WHITESPACE"," ",602],["T_VARIABLE","$this",602],["T_OBJECT_OPERATOR","->",602],["T_STRING","dest_folder",602],".",["T_VARIABLE","$filename",602],".",["T_VARIABLE","$this",602],["T_OBJECT_OPERATOR","->",602],["T_STRING","thumb_marker",602],".",["T_VARIABLE","$file_ext",602],";",["T_WHITESPACE","\n\n\t\t",602],["T_COMMENT","\/* Should we maintain image proportions?\n\t\t *\n\t\t * When creating thumbs or copies, the target width\/height\n\t\t * might not be in correct proportion with the source\n\t\t * image's width\/height. We'll recalculate it here.\n\t\t *\/",604],["T_WHITESPACE","\n\t\t",609],["T_IF","if",610],["T_WHITESPACE"," ",610],"(",["T_VARIABLE","$this",610],["T_OBJECT_OPERATOR","->",610],["T_STRING","maintain_ratio",610],["T_WHITESPACE"," ",610],["T_IS_IDENTICAL","===",610],["T_WHITESPACE"," ",610],["T_STRING","TRUE",610],["T_WHITESPACE"," ",610],["T_BOOLEAN_AND","&&",610],["T_WHITESPACE"," ",610],"(",["T_VARIABLE","$this",610],["T_OBJECT_OPERATOR","->",610],["T_STRING","width",610],["T_WHITESPACE"," ",610],["T_IS_NOT_IDENTICAL","!==",610],["T_WHITESPACE"," ",610],["T_LNUMBER","0",610],["T_WHITESPACE"," ",610],["T_LOGICAL_OR","OR",610],["T_WHITESPACE"," ",610],["T_VARIABLE","$this",610],["T_OBJECT_OPERATOR","->",610],["T_STRING","height",610],["T_WHITESPACE"," ",610],["T_IS_NOT_IDENTICAL","!==",610],["T_WHITESPACE"," ",610],["T_LNUMBER","0",610],")",")",["T_WHITESPACE","\n\t\t",610],"{",["T_WHITESPACE","\n\t\t\t",611],["T_VARIABLE","$this",612],["T_OBJECT_OPERATOR","->",612],["T_STRING","image_reproportion",612],"(",")",";",["T_WHITESPACE","\n\t\t",612],"}",["T_WHITESPACE","\n\n\t\t",613],["T_COMMENT","\/* Was a width and height specified?\n\t\t *\n\t\t * If the destination width\/height was not submitted we\n\t\t * will use the values from the actual file\n\t\t *\/",615],["T_WHITESPACE","\n\t\t",619],["T_IF","if",620],["T_WHITESPACE"," ",620],"(",["T_VARIABLE","$this",620],["T_OBJECT_OPERATOR","->",620],["T_STRING","width",620],["T_WHITESPACE"," ",620],["T_IS_IDENTICAL","===",620],["T_WHITESPACE"," ",620],["T_CONSTANT_ENCAPSED_STRING","''",620],")",["T_WHITESPACE","\n\t\t",620],"{",["T_WHITESPACE","\n\t\t\t",621],["T_VARIABLE","$this",622],["T_OBJECT_OPERATOR","->",622],["T_STRING","width",622],["T_WHITESPACE"," ",622],"=",["T_WHITESPACE"," ",622],["T_VARIABLE","$this",622],["T_OBJECT_OPERATOR","->",622],["T_STRING","orig_width",622],";",["T_WHITESPACE","\n\t\t",622],"}",["T_WHITESPACE","\n\n\t\t",623],["T_IF","if",625],["T_WHITESPACE"," ",625],"(",["T_VARIABLE","$this",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","height",625],["T_WHITESPACE"," ",625],["T_IS_IDENTICAL","===",625],["T_WHITESPACE"," ",625],["T_CONSTANT_ENCAPSED_STRING","''",625],")",["T_WHITESPACE","\n\t\t",625],"{",["T_WHITESPACE","\n\t\t\t",626],["T_VARIABLE","$this",627],["T_OBJECT_OPERATOR","->",627],["T_STRING","height",627],["T_WHITESPACE"," ",627],"=",["T_WHITESPACE"," ",627],["T_VARIABLE","$this",627],["T_OBJECT_OPERATOR","->",627],["T_STRING","orig_height",627],";",["T_WHITESPACE","\n\t\t",627],"}",["T_WHITESPACE","\n\n\t\t",628],["T_COMMENT","\/\/ Set the quality\n",630],["T_WHITESPACE","\t\t",631],["T_VARIABLE","$this",631],["T_OBJECT_OPERATOR","->",631],["T_STRING","quality",631],["T_WHITESPACE"," ",631],"=",["T_WHITESPACE"," ",631],["T_STRING","trim",631],"(",["T_STRING","str_replace",631],"(",["T_CONSTANT_ENCAPSED_STRING","'%'",631],",",["T_WHITESPACE"," ",631],["T_CONSTANT_ENCAPSED_STRING","''",631],",",["T_WHITESPACE"," ",631],["T_VARIABLE","$this",631],["T_OBJECT_OPERATOR","->",631],["T_STRING","quality",631],")",")",";",["T_WHITESPACE","\n\n\t\t",631],["T_IF","if",633],["T_WHITESPACE"," ",633],"(",["T_VARIABLE","$this",633],["T_OBJECT_OPERATOR","->",633],["T_STRING","quality",633],["T_WHITESPACE"," ",633],["T_IS_IDENTICAL","===",633],["T_WHITESPACE"," ",633],["T_CONSTANT_ENCAPSED_STRING","''",633],["T_WHITESPACE"," ",633],["T_LOGICAL_OR","OR",633],["T_WHITESPACE"," ",633],["T_VARIABLE","$this",633],["T_OBJECT_OPERATOR","->",633],["T_STRING","quality",633],["T_WHITESPACE"," ",633],["T_IS_IDENTICAL","===",633],["T_WHITESPACE"," ",633],["T_LNUMBER","0",633],["T_WHITESPACE"," ",633],["T_LOGICAL_OR","OR",633],["T_WHITESPACE"," ",633],"!",["T_WHITESPACE"," ",633],["T_STRING","ctype_digit",633],"(",["T_VARIABLE","$this",633],["T_OBJECT_OPERATOR","->",633],["T_STRING","quality",633],")",")",["T_WHITESPACE","\n\t\t",633],"{",["T_WHITESPACE","\n\t\t\t",634],["T_VARIABLE","$this",635],["T_OBJECT_OPERATOR","->",635],["T_STRING","quality",635],["T_WHITESPACE"," ",635],"=",["T_WHITESPACE"," ",635],["T_LNUMBER","90",635],";",["T_WHITESPACE","\n\t\t",635],"}",["T_WHITESPACE","\n\n\t\t",636],["T_COMMENT","\/\/ Set the x\/y coordinates\n",638],["T_WHITESPACE","\t\t",639],["T_STRING","is_numeric",639],"(",["T_VARIABLE","$this",639],["T_OBJECT_OPERATOR","->",639],["T_STRING","x_axis",639],")",["T_WHITESPACE"," ",639],["T_LOGICAL_OR","OR",639],["T_WHITESPACE"," ",639],["T_VARIABLE","$this",639],["T_OBJECT_OPERATOR","->",639],["T_STRING","x_axis",639],["T_WHITESPACE"," ",639],"=",["T_WHITESPACE"," ",639],["T_LNUMBER","0",639],";",["T_WHITESPACE","\n\t\t",639],["T_STRING","is_numeric",640],"(",["T_VARIABLE","$this",640],["T_OBJECT_OPERATOR","->",640],["T_STRING","y_axis",640],")",["T_WHITESPACE"," ",640],["T_LOGICAL_OR","OR",640],["T_WHITESPACE"," ",640],["T_VARIABLE","$this",640],["T_OBJECT_OPERATOR","->",640],["T_STRING","y_axis",640],["T_WHITESPACE"," ",640],"=",["T_WHITESPACE"," ",640],["T_LNUMBER","0",640],";",["T_WHITESPACE","\n\n\t\t",640],["T_COMMENT","\/\/ Watermark-related Stuff...\n",642],["T_WHITESPACE","\t\t",643],["T_IF","if",643],["T_WHITESPACE"," ",643],"(",["T_VARIABLE","$this",643],["T_OBJECT_OPERATOR","->",643],["T_STRING","wm_overlay_path",643],["T_WHITESPACE"," ",643],["T_IS_NOT_IDENTICAL","!==",643],["T_WHITESPACE"," ",643],["T_CONSTANT_ENCAPSED_STRING","''",643],")",["T_WHITESPACE","\n\t\t",643],"{",["T_WHITESPACE","\n\t\t\t",644],["T_VARIABLE","$this",645],["T_OBJECT_OPERATOR","->",645],["T_STRING","wm_overlay_path",645],["T_WHITESPACE"," ",645],"=",["T_WHITESPACE"," ",645],["T_STRING","str_replace",645],"(",["T_CONSTANT_ENCAPSED_STRING","'\\\\'",645],",",["T_WHITESPACE"," ",645],["T_CONSTANT_ENCAPSED_STRING","'\/'",645],",",["T_WHITESPACE"," ",645],["T_STRING","realpath",645],"(",["T_VARIABLE","$this",645],["T_OBJECT_OPERATOR","->",645],["T_STRING","wm_overlay_path",645],")",")",";",["T_WHITESPACE","\n\t\t",645],"}",["T_WHITESPACE","\n\n\t\t",646],["T_IF","if",648],["T_WHITESPACE"," ",648],"(",["T_VARIABLE","$this",648],["T_OBJECT_OPERATOR","->",648],["T_STRING","wm_shadow_color",648],["T_WHITESPACE"," ",648],["T_IS_NOT_IDENTICAL","!==",648],["T_WHITESPACE"," ",648],["T_CONSTANT_ENCAPSED_STRING","''",648],")",["T_WHITESPACE","\n\t\t",648],"{",["T_WHITESPACE","\n\t\t\t",649],["T_VARIABLE","$this",650],["T_OBJECT_OPERATOR","->",650],["T_STRING","wm_use_drop_shadow",650],["T_WHITESPACE"," ",650],"=",["T_WHITESPACE"," ",650],["T_STRING","TRUE",650],";",["T_WHITESPACE","\n\t\t",650],"}",["T_WHITESPACE","\n\t\t",651],["T_ELSEIF","elseif",652],["T_WHITESPACE"," ",652],"(",["T_VARIABLE","$this",652],["T_OBJECT_OPERATOR","->",652],["T_STRING","wm_use_drop_shadow",652],["T_WHITESPACE"," ",652],["T_IS_IDENTICAL","===",652],["T_WHITESPACE"," ",652],["T_STRING","TRUE",652],["T_WHITESPACE"," ",652],["T_BOOLEAN_AND","&&",652],["T_WHITESPACE"," ",652],["T_VARIABLE","$this",652],["T_OBJECT_OPERATOR","->",652],["T_STRING","wm_shadow_color",652],["T_WHITESPACE"," ",652],["T_IS_IDENTICAL","===",652],["T_WHITESPACE"," ",652],["T_CONSTANT_ENCAPSED_STRING","''",652],")",["T_WHITESPACE","\n\t\t",652],"{",["T_WHITESPACE","\n\t\t\t",653],["T_VARIABLE","$this",654],["T_OBJECT_OPERATOR","->",654],["T_STRING","wm_use_drop_shadow",654],["T_WHITESPACE"," ",654],"=",["T_WHITESPACE"," ",654],["T_STRING","FALSE",654],";",["T_WHITESPACE","\n\t\t",654],"}",["T_WHITESPACE","\n\n\t\t",655],["T_IF","if",657],["T_WHITESPACE"," ",657],"(",["T_VARIABLE","$this",657],["T_OBJECT_OPERATOR","->",657],["T_STRING","wm_font_path",657],["T_WHITESPACE"," ",657],["T_IS_NOT_IDENTICAL","!==",657],["T_WHITESPACE"," ",657],["T_CONSTANT_ENCAPSED_STRING","''",657],")",["T_WHITESPACE","\n\t\t",657],"{",["T_WHITESPACE","\n\t\t\t",658],["T_VARIABLE","$this",659],["T_OBJECT_OPERATOR","->",659],["T_STRING","wm_use_truetype",659],["T_WHITESPACE"," ",659],"=",["T_WHITESPACE"," ",659],["T_STRING","TRUE",659],";",["T_WHITESPACE","\n\t\t",659],"}",["T_WHITESPACE","\n\n\t\t",660],["T_RETURN","return",662],["T_WHITESPACE"," ",662],["T_STRING","TRUE",662],";",["T_WHITESPACE","\n\t",662],"}",["T_WHITESPACE","\n\n\t",663],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",665],["T_WHITESPACE","\n\t",666],["T_DOC_COMMENT","\/**\n\t * Image Resize\n\t *\n\t * This is a wrapper function that chooses the proper\n\t * resize function based on the protocol specified\n\t *\n\t * @return\tbool\n\t *\/",667],["T_WHITESPACE","\n\t",674],["T_PUBLIC","public",675],["T_WHITESPACE"," ",675],["T_FUNCTION","function",675],["T_WHITESPACE"," ",675],["T_STRING","resize",675],"(",")",["T_WHITESPACE","\n\t",675],"{",["T_WHITESPACE","\n\t\t",676],["T_VARIABLE","$protocol",677],["T_WHITESPACE"," ",677],"=",["T_WHITESPACE"," ",677],"(",["T_VARIABLE","$this",677],["T_OBJECT_OPERATOR","->",677],["T_STRING","image_library",677],["T_WHITESPACE"," ",677],["T_IS_IDENTICAL","===",677],["T_WHITESPACE"," ",677],["T_CONSTANT_ENCAPSED_STRING","'gd2'",677],")",["T_WHITESPACE"," ",677],"?",["T_WHITESPACE"," ",677],["T_CONSTANT_ENCAPSED_STRING","'image_process_gd'",677],["T_WHITESPACE"," ",677],":",["T_WHITESPACE"," ",677],["T_CONSTANT_ENCAPSED_STRING","'image_process_'",677],".",["T_VARIABLE","$this",677],["T_OBJECT_OPERATOR","->",677],["T_STRING","image_library",677],";",["T_WHITESPACE","\n\t\t",677],["T_RETURN","return",678],["T_WHITESPACE"," ",678],["T_VARIABLE","$this",678],["T_OBJECT_OPERATOR","->",678],["T_VARIABLE","$protocol",678],"(",["T_CONSTANT_ENCAPSED_STRING","'resize'",678],")",";",["T_WHITESPACE","\n\t",678],"}",["T_WHITESPACE","\n\n\t",679],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",681],["T_WHITESPACE","\n\t",682],["T_DOC_COMMENT","\/**\n\t * Image Crop\n\t *\n\t * This is a wrapper function that chooses the proper\n\t * cropping function based on the protocol specified\n\t *\n\t * @return\tbool\n\t *\/",683],["T_WHITESPACE","\n\t",690],["T_PUBLIC","public",691],["T_WHITESPACE"," ",691],["T_FUNCTION","function",691],["T_WHITESPACE"," ",691],["T_STRING","crop",691],"(",")",["T_WHITESPACE","\n\t",691],"{",["T_WHITESPACE","\n\t\t",692],["T_VARIABLE","$protocol",693],["T_WHITESPACE"," ",693],"=",["T_WHITESPACE"," ",693],"(",["T_VARIABLE","$this",693],["T_OBJECT_OPERATOR","->",693],["T_STRING","image_library",693],["T_WHITESPACE"," ",693],["T_IS_IDENTICAL","===",693],["T_WHITESPACE"," ",693],["T_CONSTANT_ENCAPSED_STRING","'gd2'",693],")",["T_WHITESPACE"," ",693],"?",["T_WHITESPACE"," ",693],["T_CONSTANT_ENCAPSED_STRING","'image_process_gd'",693],["T_WHITESPACE"," ",693],":",["T_WHITESPACE"," ",693],["T_CONSTANT_ENCAPSED_STRING","'image_process_'",693],".",["T_VARIABLE","$this",693],["T_OBJECT_OPERATOR","->",693],["T_STRING","image_library",693],";",["T_WHITESPACE","\n\t\t",693],["T_RETURN","return",694],["T_WHITESPACE"," ",694],["T_VARIABLE","$this",694],["T_OBJECT_OPERATOR","->",694],["T_VARIABLE","$protocol",694],"(",["T_CONSTANT_ENCAPSED_STRING","'crop'",694],")",";",["T_WHITESPACE","\n\t",694],"}",["T_WHITESPACE","\n\n\t",695],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",697],["T_WHITESPACE","\n\t",698],["T_DOC_COMMENT","\/**\n\t * Image Rotate\n\t *\n\t * This is a wrapper function that chooses the proper\n\t * rotation function based on the protocol specified\n\t *\n\t * @return\tbool\n\t *\/",699],["T_WHITESPACE","\n\t",706],["T_PUBLIC","public",707],["T_WHITESPACE"," ",707],["T_FUNCTION","function",707],["T_WHITESPACE"," ",707],["T_STRING","rotate",707],"(",")",["T_WHITESPACE","\n\t",707],"{",["T_WHITESPACE","\n\t\t",708],["T_COMMENT","\/\/ Allowed rotation values\n",709],["T_WHITESPACE","\t\t",710],["T_VARIABLE","$degs",710],["T_WHITESPACE"," ",710],"=",["T_WHITESPACE"," ",710],["T_ARRAY","array",710],"(",["T_LNUMBER","90",710],",",["T_WHITESPACE"," ",710],["T_LNUMBER","180",710],",",["T_WHITESPACE"," ",710],["T_LNUMBER","270",710],",",["T_WHITESPACE"," ",710],["T_CONSTANT_ENCAPSED_STRING","'vrt'",710],",",["T_WHITESPACE"," ",710],["T_CONSTANT_ENCAPSED_STRING","'hor'",710],")",";",["T_WHITESPACE","\n\n\t\t",710],["T_IF","if",712],["T_WHITESPACE"," ",712],"(",["T_VARIABLE","$this",712],["T_OBJECT_OPERATOR","->",712],["T_STRING","rotation_angle",712],["T_WHITESPACE"," ",712],["T_IS_IDENTICAL","===",712],["T_WHITESPACE"," ",712],["T_CONSTANT_ENCAPSED_STRING","''",712],["T_WHITESPACE"," ",712],["T_LOGICAL_OR","OR",712],["T_WHITESPACE"," ",712],"!",["T_WHITESPACE"," ",712],["T_STRING","in_array",712],"(",["T_VARIABLE","$this",712],["T_OBJECT_OPERATOR","->",712],["T_STRING","rotation_angle",712],",",["T_WHITESPACE"," ",712],["T_VARIABLE","$degs",712],")",")",["T_WHITESPACE","\n\t\t",712],"{",["T_WHITESPACE","\n\t\t\t",713],["T_VARIABLE","$this",714],["T_OBJECT_OPERATOR","->",714],["T_STRING","set_error",714],"(",["T_CONSTANT_ENCAPSED_STRING","'imglib_rotation_angle_required'",714],")",";",["T_WHITESPACE","\n\t\t\t",714],["T_RETURN","return",715],["T_WHITESPACE"," ",715],["T_STRING","FALSE",715],";",["T_WHITESPACE","\n\t\t",715],"}",["T_WHITESPACE","\n\n\t\t",716],["T_COMMENT","\/\/ Reassign the width and height\n",718],["T_WHITESPACE","\t\t",719],["T_IF","if",719],["T_WHITESPACE"," ",719],"(",["T_VARIABLE","$this",719],["T_OBJECT_OPERATOR","->",719],["T_STRING","rotation_angle",719],["T_WHITESPACE"," ",719],["T_IS_IDENTICAL","===",719],["T_WHITESPACE"," ",719],["T_LNUMBER","90",719],["T_WHITESPACE"," ",719],["T_LOGICAL_OR","OR",719],["T_WHITESPACE"," ",719],["T_VARIABLE","$this",719],["T_OBJECT_OPERATOR","->",719],["T_STRING","rotation_angle",719],["T_WHITESPACE"," ",719],["T_IS_IDENTICAL","===",719],["T_WHITESPACE"," ",719],["T_LNUMBER","270",719],")",["T_WHITESPACE","\n\t\t",719],"{",["T_WHITESPACE","\n\t\t\t",720],["T_VARIABLE","$this",721],["T_OBJECT_OPERATOR","->",721],["T_STRING","width",721],["T_WHITESPACE","\t",721],"=",["T_WHITESPACE"," ",721],["T_VARIABLE","$this",721],["T_OBJECT_OPERATOR","->",721],["T_STRING","orig_height",721],";",["T_WHITESPACE","\n\t\t\t",721],["T_VARIABLE","$this",722],["T_OBJECT_OPERATOR","->",722],["T_STRING","height",722],["T_WHITESPACE","\t",722],"=",["T_WHITESPACE"," ",722],["T_VARIABLE","$this",722],["T_OBJECT_OPERATOR","->",722],["T_STRING","orig_width",722],";",["T_WHITESPACE","\n\t\t",722],"}",["T_WHITESPACE","\n\t\t",723],["T_ELSE","else",724],["T_WHITESPACE","\n\t\t",724],"{",["T_WHITESPACE","\n\t\t\t",725],["T_VARIABLE","$this",726],["T_OBJECT_OPERATOR","->",726],["T_STRING","width",726],["T_WHITESPACE","\t",726],"=",["T_WHITESPACE"," ",726],["T_VARIABLE","$this",726],["T_OBJECT_OPERATOR","->",726],["T_STRING","orig_width",726],";",["T_WHITESPACE","\n\t\t\t",726],["T_VARIABLE","$this",727],["T_OBJECT_OPERATOR","->",727],["T_STRING","height",727],["T_WHITESPACE","\t",727],"=",["T_WHITESPACE"," ",727],["T_VARIABLE","$this",727],["T_OBJECT_OPERATOR","->",727],["T_STRING","orig_height",727],";",["T_WHITESPACE","\n\t\t",727],"}",["T_WHITESPACE","\n\n\t\t",728],["T_COMMENT","\/\/ Choose resizing function\n",730],["T_WHITESPACE","\t\t",731],["T_IF","if",731],["T_WHITESPACE"," ",731],"(",["T_VARIABLE","$this",731],["T_OBJECT_OPERATOR","->",731],["T_STRING","image_library",731],["T_WHITESPACE"," ",731],["T_IS_IDENTICAL","===",731],["T_WHITESPACE"," ",731],["T_CONSTANT_ENCAPSED_STRING","'imagemagick'",731],["T_WHITESPACE"," ",731],["T_LOGICAL_OR","OR",731],["T_WHITESPACE"," ",731],["T_VARIABLE","$this",731],["T_OBJECT_OPERATOR","->",731],["T_STRING","image_library",731],["T_WHITESPACE"," ",731],["T_IS_IDENTICAL","===",731],["T_WHITESPACE"," ",731],["T_CONSTANT_ENCAPSED_STRING","'netpbm'",731],")",["T_WHITESPACE","\n\t\t",731],"{",["T_WHITESPACE","\n\t\t\t",732],["T_VARIABLE","$protocol",733],["T_WHITESPACE"," ",733],"=",["T_WHITESPACE"," ",733],["T_CONSTANT_ENCAPSED_STRING","'image_process_'",733],".",["T_VARIABLE","$this",733],["T_OBJECT_OPERATOR","->",733],["T_STRING","image_library",733],";",["T_WHITESPACE","\n\t\t\t",733],["T_RETURN","return",734],["T_WHITESPACE"," ",734],["T_VARIABLE","$this",734],["T_OBJECT_OPERATOR","->",734],["T_VARIABLE","$protocol",734],"(",["T_CONSTANT_ENCAPSED_STRING","'rotate'",734],")",";",["T_WHITESPACE","\n\t\t",734],"}",["T_WHITESPACE","\n\n\t\t",735],["T_RETURN","return",737],["T_WHITESPACE"," ",737],"(",["T_VARIABLE","$this",737],["T_OBJECT_OPERATOR","->",737],["T_STRING","rotation_angle",737],["T_WHITESPACE"," ",737],["T_IS_IDENTICAL","===",737],["T_WHITESPACE"," ",737],["T_CONSTANT_ENCAPSED_STRING","'hor'",737],["T_WHITESPACE"," ",737],["T_LOGICAL_OR","OR",737],["T_WHITESPACE"," ",737],["T_VARIABLE","$this",737],["T_OBJECT_OPERATOR","->",737],["T_STRING","rotation_angle",737],["T_WHITESPACE"," ",737],["T_IS_IDENTICAL","===",737],["T_WHITESPACE"," ",737],["T_CONSTANT_ENCAPSED_STRING","'vrt'",737],")",["T_WHITESPACE","\n\t\t\t",737],"?",["T_WHITESPACE"," ",738],["T_VARIABLE","$this",738],["T_OBJECT_OPERATOR","->",738],["T_STRING","image_mirror_gd",738],"(",")",["T_WHITESPACE","\n\t\t\t",738],":",["T_WHITESPACE"," ",739],["T_VARIABLE","$this",739],["T_OBJECT_OPERATOR","->",739],["T_STRING","image_rotate_gd",739],"(",")",";",["T_WHITESPACE","\n\t",739],"}",["T_WHITESPACE","\n\n\t",740],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",742],["T_WHITESPACE","\n\t",743],["T_DOC_COMMENT","\/**\n\t * Image Process Using GD\/GD2\n\t *\n\t * This function will resize or crop\n\t *\n\t * @param\tstring\n\t * @return\tbool\n\t *\/",744],["T_WHITESPACE","\n\t",751],["T_PUBLIC","public",752],["T_WHITESPACE"," ",752],["T_FUNCTION","function",752],["T_WHITESPACE"," ",752],["T_STRING","image_process_gd",752],"(",["T_VARIABLE","$action",752],["T_WHITESPACE"," ",752],"=",["T_WHITESPACE"," ",752],["T_CONSTANT_ENCAPSED_STRING","'resize'",752],")",["T_WHITESPACE","\n\t",752],"{",["T_WHITESPACE","\n\t\t",753],["T_VARIABLE","$v2_override",754],["T_WHITESPACE"," ",754],"=",["T_WHITESPACE"," ",754],["T_STRING","FALSE",754],";",["T_WHITESPACE","\n\n\t\t",754],["T_COMMENT","\/\/ If the target width\/height match the source, AND if the new file name is not equal to the old file name\n",756],["T_WHITESPACE","\t\t",757],["T_COMMENT","\/\/ we'll simply make a copy of the original with the new name... assuming dynamic rendering is off.\n",757],["T_WHITESPACE","\t\t",758],["T_IF","if",758],["T_WHITESPACE"," ",758],"(",["T_VARIABLE","$this",758],["T_OBJECT_OPERATOR","->",758],["T_STRING","dynamic_output",758],["T_WHITESPACE"," ",758],["T_IS_IDENTICAL","===",758],["T_WHITESPACE"," ",758],["T_STRING","FALSE",758],["T_WHITESPACE"," ",758],["T_BOOLEAN_AND","&&",758],["T_WHITESPACE"," ",758],["T_VARIABLE","$this",758],["T_OBJECT_OPERATOR","->",758],["T_STRING","orig_width",758],["T_WHITESPACE"," ",758],["T_IS_IDENTICAL","===",758],["T_WHITESPACE"," ",758],["T_VARIABLE","$this",758],["T_OBJECT_OPERATOR","->",758],["T_STRING","width",758],["T_WHITESPACE"," ",758],["T_BOOLEAN_AND","&&",758],["T_WHITESPACE"," ",758],["T_VARIABLE","$this",758],["T_OBJECT_OPERATOR","->",758],["T_STRING","orig_height",758],["T_WHITESPACE"," ",758],["T_IS_IDENTICAL","===",758],["T_WHITESPACE"," ",758],["T_VARIABLE","$this",758],["T_OBJECT_OPERATOR","->",758],["T_STRING","height",758],")",["T_WHITESPACE","\n\t\t",758],"{",["T_WHITESPACE","\n\t\t\t",759],["T_IF","if",760],["T_WHITESPACE"," ",760],"(",["T_VARIABLE","$this",760],["T_OBJECT_OPERATOR","->",760],["T_STRING","source_image",760],["T_WHITESPACE"," ",760],["T_IS_NOT_IDENTICAL","!==",760],["T_WHITESPACE"," ",760],["T_VARIABLE","$this",760],["T_OBJECT_OPERATOR","->",760],["T_STRING","new_image",760],["T_WHITESPACE"," ",760],["T_BOOLEAN_AND","&&",760],["T_WHITESPACE"," ",760],"@",["T_STRING","copy",760],"(",["T_VARIABLE","$this",760],["T_OBJECT_OPERATOR","->",760],["T_STRING","full_src_path",760],",",["T_WHITESPACE"," ",760],["T_VARIABLE","$this",760],["T_OBJECT_OPERATOR","->",760],["T_STRING","full_dst_path",760],")",")",["T_WHITESPACE","\n\t\t\t",760],"{",["T_WHITESPACE","\n\t\t\t\t",761],["T_STRING","chmod",762],"(",["T_VARIABLE","$this",762],["T_OBJECT_OPERATOR","->",762],["T_STRING","full_dst_path",762],",",["T_WHITESPACE"," ",762],["T_VARIABLE","$this",762],["T_OBJECT_OPERATOR","->",762],["T_STRING","file_permissions",762],")",";",["T_WHITESPACE","\n\t\t\t",762],"}",["T_WHITESPACE","\n\n\t\t\t",763],["T_RETURN","return",765],["T_WHITESPACE"," ",765],["T_STRING","TRUE",765],";",["T_WHITESPACE","\n\t\t",765],"}",["T_WHITESPACE","\n\n\t\t",766],["T_COMMENT","\/\/ Let's set up our values based on the action\n",768],["T_WHITESPACE","\t\t",769],["T_IF","if",769],["T_WHITESPACE"," ",769],"(",["T_VARIABLE","$action",769],["T_WHITESPACE"," ",769],["T_IS_IDENTICAL","===",769],["T_WHITESPACE"," ",769],["T_CONSTANT_ENCAPSED_STRING","'crop'",769],")",["T_WHITESPACE","\n\t\t",769],"{",["T_WHITESPACE","\n\t\t\t",770],["T_COMMENT","\/\/ Reassign the source width\/height if cropping\n",771],["T_WHITESPACE","\t\t\t",772],["T_VARIABLE","$this",772],["T_OBJECT_OPERATOR","->",772],["T_STRING","orig_width",772],["T_WHITESPACE","  ",772],"=",["T_WHITESPACE"," ",772],["T_VARIABLE","$this",772],["T_OBJECT_OPERATOR","->",772],["T_STRING","width",772],";",["T_WHITESPACE","\n\t\t\t",772],["T_VARIABLE","$this",773],["T_OBJECT_OPERATOR","->",773],["T_STRING","orig_height",773],["T_WHITESPACE"," ",773],"=",["T_WHITESPACE"," ",773],["T_VARIABLE","$this",773],["T_OBJECT_OPERATOR","->",773],["T_STRING","height",773],";",["T_WHITESPACE","\n\n\t\t\t",773],["T_COMMENT","\/\/ GD 2.0 has a cropping bug so we'll test for it\n",775],["T_WHITESPACE","\t\t\t",776],["T_IF","if",776],["T_WHITESPACE"," ",776],"(",["T_VARIABLE","$this",776],["T_OBJECT_OPERATOR","->",776],["T_STRING","gd_version",776],"(",")",["T_WHITESPACE"," ",776],["T_IS_NOT_IDENTICAL","!==",776],["T_WHITESPACE"," ",776],["T_STRING","FALSE",776],")",["T_WHITESPACE","\n\t\t\t",776],"{",["T_WHITESPACE","\n\t\t\t\t",777],["T_VARIABLE","$gd_version",778],["T_WHITESPACE"," ",778],"=",["T_WHITESPACE"," ",778],["T_STRING","str_replace",778],"(",["T_CONSTANT_ENCAPSED_STRING","'0'",778],",",["T_WHITESPACE"," ",778],["T_CONSTANT_ENCAPSED_STRING","''",778],",",["T_WHITESPACE"," ",778],["T_VARIABLE","$this",778],["T_OBJECT_OPERATOR","->",778],["T_STRING","gd_version",778],"(",")",")",";",["T_WHITESPACE","\n\t\t\t\t",778],["T_VARIABLE","$v2_override",779],["T_WHITESPACE"," ",779],"=",["T_WHITESPACE"," ",779],"(",["T_VARIABLE","$gd_version",779],["T_WHITESPACE"," ",779],["T_IS_EQUAL","==",779],["T_WHITESPACE"," ",779],["T_LNUMBER","2",779],")",";",["T_WHITESPACE","\n\t\t\t",779],"}",["T_WHITESPACE","\n\t\t",780],"}",["T_WHITESPACE","\n\t\t",781],["T_ELSE","else",782],["T_WHITESPACE","\n\t\t",782],"{",["T_WHITESPACE","\n\t\t\t",783],["T_COMMENT","\/\/ If resizing the x\/y axis must be zero\n",784],["T_WHITESPACE","\t\t\t",785],["T_VARIABLE","$this",785],["T_OBJECT_OPERATOR","->",785],["T_STRING","x_axis",785],["T_WHITESPACE"," ",785],"=",["T_WHITESPACE"," ",785],["T_LNUMBER","0",785],";",["T_WHITESPACE","\n\t\t\t",785],["T_VARIABLE","$this",786],["T_OBJECT_OPERATOR","->",786],["T_STRING","y_axis",786],["T_WHITESPACE"," ",786],"=",["T_WHITESPACE"," ",786],["T_LNUMBER","0",786],";",["T_WHITESPACE","\n\t\t",786],"}",["T_WHITESPACE","\n\n\t\t",787],["T_COMMENT","\/\/ Create the image handle\n",789],["T_WHITESPACE","\t\t",790],["T_IF","if",790],["T_WHITESPACE"," ",790],"(",["T_WHITESPACE"," ",790],"!",["T_WHITESPACE"," ",790],"(",["T_VARIABLE","$src_img",790],["T_WHITESPACE"," ",790],"=",["T_WHITESPACE"," ",790],["T_VARIABLE","$this",790],["T_OBJECT_OPERATOR","->",790],["T_STRING","image_create_gd",790],"(",")",")",")",["T_WHITESPACE","\n\t\t",790],"{",["T_WHITESPACE","\n\t\t\t",791],["T_RETURN","return",792],["T_WHITESPACE"," ",792],["T_STRING","FALSE",792],";",["T_WHITESPACE","\n\t\t",792],"}",["T_WHITESPACE","\n\n\t\t",793],["T_COMMENT","\/* Create the image\n\t\t *\n\t\t * Old conditional which users report cause problems with shared GD libs who report themselves as \"2.0 or greater\"\n\t\t * it appears that this is no longer the issue that it was in 2004, so we've removed it, retaining it in the comment\n\t\t * below should that ever prove inaccurate.\n\t\t *\n\t\t * if ($this->image_library === 'gd2' && function_exists('imagecreatetruecolor') && $v2_override === FALSE)\n\t\t *\/",795],["T_WHITESPACE","\n\t\t",802],["T_IF","if",803],["T_WHITESPACE"," ",803],"(",["T_VARIABLE","$this",803],["T_OBJECT_OPERATOR","->",803],["T_STRING","image_library",803],["T_WHITESPACE"," ",803],["T_IS_IDENTICAL","===",803],["T_WHITESPACE"," ",803],["T_CONSTANT_ENCAPSED_STRING","'gd2'",803],["T_WHITESPACE"," ",803],["T_BOOLEAN_AND","&&",803],["T_WHITESPACE"," ",803],["T_STRING","function_exists",803],"(",["T_CONSTANT_ENCAPSED_STRING","'imagecreatetruecolor'",803],")",")",["T_WHITESPACE","\n\t\t",803],"{",["T_WHITESPACE","\n\t\t\t",804],["T_VARIABLE","$create",805],["T_WHITESPACE","\t",805],"=",["T_WHITESPACE"," ",805],["T_CONSTANT_ENCAPSED_STRING","'imagecreatetruecolor'",805],";",["T_WHITESPACE","\n\t\t\t",805],["T_VARIABLE","$copy",806],["T_WHITESPACE","\t",806],"=",["T_WHITESPACE"," ",806],["T_CONSTANT_ENCAPSED_STRING","'imagecopyresampled'",806],";",["T_WHITESPACE","\n\t\t",806],"}",["T_WHITESPACE","\n\t\t",807],["T_ELSE","else",808],["T_WHITESPACE","\n\t\t",808],"{",["T_WHITESPACE","\n\t\t\t",809],["T_VARIABLE","$create",810],["T_WHITESPACE","\t",810],"=",["T_WHITESPACE"," ",810],["T_CONSTANT_ENCAPSED_STRING","'imagecreate'",810],";",["T_WHITESPACE","\n\t\t\t",810],["T_VARIABLE","$copy",811],["T_WHITESPACE","\t",811],"=",["T_WHITESPACE"," ",811],["T_CONSTANT_ENCAPSED_STRING","'imagecopyresized'",811],";",["T_WHITESPACE","\n\t\t",811],"}",["T_WHITESPACE","\n\n\t\t",812],["T_VARIABLE","$dst_img",814],["T_WHITESPACE"," ",814],"=",["T_WHITESPACE"," ",814],["T_VARIABLE","$create",814],"(",["T_VARIABLE","$this",814],["T_OBJECT_OPERATOR","->",814],["T_STRING","width",814],",",["T_WHITESPACE"," ",814],["T_VARIABLE","$this",814],["T_OBJECT_OPERATOR","->",814],["T_STRING","height",814],")",";",["T_WHITESPACE","\n\n\t\t",814],["T_IF","if",816],["T_WHITESPACE"," ",816],"(",["T_VARIABLE","$this",816],["T_OBJECT_OPERATOR","->",816],["T_STRING","image_type",816],["T_WHITESPACE"," ",816],["T_IS_IDENTICAL","===",816],["T_WHITESPACE"," ",816],["T_LNUMBER","3",816],")",["T_WHITESPACE"," ",816],["T_COMMENT","\/\/ png we can actually preserve transparency\n",816],["T_WHITESPACE","\t\t",817],"{",["T_WHITESPACE","\n\t\t\t",817],["T_STRING","imagealphablending",818],"(",["T_VARIABLE","$dst_img",818],",",["T_WHITESPACE"," ",818],["T_STRING","FALSE",818],")",";",["T_WHITESPACE","\n\t\t\t",818],["T_STRING","imagesavealpha",819],"(",["T_VARIABLE","$dst_img",819],",",["T_WHITESPACE"," ",819],["T_STRING","TRUE",819],")",";",["T_WHITESPACE","\n\t\t",819],"}",["T_WHITESPACE","\n\n\t\t",820],["T_VARIABLE","$copy",822],"(",["T_VARIABLE","$dst_img",822],",",["T_WHITESPACE"," ",822],["T_VARIABLE","$src_img",822],",",["T_WHITESPACE"," ",822],["T_LNUMBER","0",822],",",["T_WHITESPACE"," ",822],["T_LNUMBER","0",822],",",["T_WHITESPACE"," ",822],["T_VARIABLE","$this",822],["T_OBJECT_OPERATOR","->",822],["T_STRING","x_axis",822],",",["T_WHITESPACE"," ",822],["T_VARIABLE","$this",822],["T_OBJECT_OPERATOR","->",822],["T_STRING","y_axis",822],",",["T_WHITESPACE"," ",822],["T_VARIABLE","$this",822],["T_OBJECT_OPERATOR","->",822],["T_STRING","width",822],",",["T_WHITESPACE"," ",822],["T_VARIABLE","$this",822],["T_OBJECT_OPERATOR","->",822],["T_STRING","height",822],",",["T_WHITESPACE"," ",822],["T_VARIABLE","$this",822],["T_OBJECT_OPERATOR","->",822],["T_STRING","orig_width",822],",",["T_WHITESPACE"," ",822],["T_VARIABLE","$this",822],["T_OBJECT_OPERATOR","->",822],["T_STRING","orig_height",822],")",";",["T_WHITESPACE","\n\n\t\t",822],["T_COMMENT","\/\/ Show the image\n",824],["T_WHITESPACE","\t\t",825],["T_IF","if",825],["T_WHITESPACE"," ",825],"(",["T_VARIABLE","$this",825],["T_OBJECT_OPERATOR","->",825],["T_STRING","dynamic_output",825],["T_WHITESPACE"," ",825],["T_IS_IDENTICAL","===",825],["T_WHITESPACE"," ",825],["T_STRING","TRUE",825],")",["T_WHITESPACE","\n\t\t",825],"{",["T_WHITESPACE","\n\t\t\t",826],["T_VARIABLE","$this",827],["T_OBJECT_OPERATOR","->",827],["T_STRING","image_display_gd",827],"(",["T_VARIABLE","$dst_img",827],")",";",["T_WHITESPACE","\n\t\t",827],"}",["T_WHITESPACE","\n\t\t",828],["T_ELSEIF","elseif",829],["T_WHITESPACE"," ",829],"(",["T_WHITESPACE"," ",829],"!",["T_WHITESPACE"," ",829],["T_VARIABLE","$this",829],["T_OBJECT_OPERATOR","->",829],["T_STRING","image_save_gd",829],"(",["T_VARIABLE","$dst_img",829],")",")",["T_WHITESPACE"," ",829],["T_COMMENT","\/\/ Or save it\n",829],["T_WHITESPACE","\t\t",830],"{",["T_WHITESPACE","\n\t\t\t",830],["T_RETURN","return",831],["T_WHITESPACE"," ",831],["T_STRING","FALSE",831],";",["T_WHITESPACE","\n\t\t",831],"}",["T_WHITESPACE","\n\n\t\t",832],["T_COMMENT","\/\/ Kill the file handles\n",834],["T_WHITESPACE","\t\t",835],["T_STRING","imagedestroy",835],"(",["T_VARIABLE","$dst_img",835],")",";",["T_WHITESPACE","\n\t\t",835],["T_STRING","imagedestroy",836],"(",["T_VARIABLE","$src_img",836],")",";",["T_WHITESPACE","\n\n\t\t",836],["T_STRING","chmod",838],"(",["T_VARIABLE","$this",838],["T_OBJECT_OPERATOR","->",838],["T_STRING","full_dst_path",838],",",["T_WHITESPACE"," ",838],["T_VARIABLE","$this",838],["T_OBJECT_OPERATOR","->",838],["T_STRING","file_permissions",838],")",";",["T_WHITESPACE","\n\n\t\t",838],["T_RETURN","return",840],["T_WHITESPACE"," ",840],["T_STRING","TRUE",840],";",["T_WHITESPACE","\n\t",840],"}",["T_WHITESPACE","\n\n\t",841],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",843],["T_WHITESPACE","\n\t",844],["T_DOC_COMMENT","\/**\n\t * Image Process Using ImageMagick\n\t *\n\t * This function will resize, crop or rotate\n\t *\n\t * @param\tstring\n\t * @return\tbool\n\t *\/",845],["T_WHITESPACE","\n\t",852],["T_PUBLIC","public",853],["T_WHITESPACE"," ",853],["T_FUNCTION","function",853],["T_WHITESPACE"," ",853],["T_STRING","image_process_imagemagick",853],"(",["T_VARIABLE","$action",853],["T_WHITESPACE"," ",853],"=",["T_WHITESPACE"," ",853],["T_CONSTANT_ENCAPSED_STRING","'resize'",853],")",["T_WHITESPACE","\n\t",853],"{",["T_WHITESPACE","\n\t\t",854],["T_COMMENT","\/\/ Do we have a vaild library path?\n",855],["T_WHITESPACE","\t\t",856],["T_IF","if",856],["T_WHITESPACE"," ",856],"(",["T_VARIABLE","$this",856],["T_OBJECT_OPERATOR","->",856],["T_STRING","library_path",856],["T_WHITESPACE"," ",856],["T_IS_IDENTICAL","===",856],["T_WHITESPACE"," ",856],["T_CONSTANT_ENCAPSED_STRING","''",856],")",["T_WHITESPACE","\n\t\t",856],"{",["T_WHITESPACE","\n\t\t\t",857],["T_VARIABLE","$this",858],["T_OBJECT_OPERATOR","->",858],["T_STRING","set_error",858],"(",["T_CONSTANT_ENCAPSED_STRING","'imglib_libpath_invalid'",858],")",";",["T_WHITESPACE","\n\t\t\t",858],["T_RETURN","return",859],["T_WHITESPACE"," ",859],["T_STRING","FALSE",859],";",["T_WHITESPACE","\n\t\t",859],"}",["T_WHITESPACE","\n\n\t\t",860],["T_IF","if",862],["T_WHITESPACE"," ",862],"(",["T_WHITESPACE"," ",862],"!",["T_WHITESPACE"," ",862],["T_STRING","preg_match",862],"(",["T_CONSTANT_ENCAPSED_STRING","'\/convert$\/i'",862],",",["T_WHITESPACE"," ",862],["T_VARIABLE","$this",862],["T_OBJECT_OPERATOR","->",862],["T_STRING","library_path",862],")",")",["T_WHITESPACE","\n\t\t",862],"{",["T_WHITESPACE","\n\t\t\t",863],["T_VARIABLE","$this",864],["T_OBJECT_OPERATOR","->",864],["T_STRING","library_path",864],["T_WHITESPACE"," ",864],"=",["T_WHITESPACE"," ",864],["T_STRING","rtrim",864],"(",["T_VARIABLE","$this",864],["T_OBJECT_OPERATOR","->",864],["T_STRING","library_path",864],",",["T_WHITESPACE"," ",864],["T_CONSTANT_ENCAPSED_STRING","'\/'",864],")",".",["T_CONSTANT_ENCAPSED_STRING","'\/convert'",864],";",["T_WHITESPACE","\n\t\t",864],"}",["T_WHITESPACE","\n\n\t\t",865],["T_COMMENT","\/\/ Execute the command\n",867],["T_WHITESPACE","\t\t",868],["T_VARIABLE","$cmd",868],["T_WHITESPACE"," ",868],"=",["T_WHITESPACE"," ",868],["T_VARIABLE","$this",868],["T_OBJECT_OPERATOR","->",868],["T_STRING","library_path",868],".",["T_CONSTANT_ENCAPSED_STRING","' -quality '",868],".",["T_VARIABLE","$this",868],["T_OBJECT_OPERATOR","->",868],["T_STRING","quality",868],";",["T_WHITESPACE","\n\n\t\t",868],["T_IF","if",870],["T_WHITESPACE"," ",870],"(",["T_VARIABLE","$action",870],["T_WHITESPACE"," ",870],["T_IS_IDENTICAL","===",870],["T_WHITESPACE"," ",870],["T_CONSTANT_ENCAPSED_STRING","'crop'",870],")",["T_WHITESPACE","\n\t\t",870],"{",["T_WHITESPACE","\n\t\t\t",871],["T_VARIABLE","$cmd",872],["T_WHITESPACE"," ",872],["T_CONCAT_EQUAL",".=",872],["T_WHITESPACE"," ",872],["T_CONSTANT_ENCAPSED_STRING","' -crop '",872],".",["T_VARIABLE","$this",872],["T_OBJECT_OPERATOR","->",872],["T_STRING","width",872],".",["T_CONSTANT_ENCAPSED_STRING","'x'",872],".",["T_VARIABLE","$this",872],["T_OBJECT_OPERATOR","->",872],["T_STRING","height",872],".",["T_CONSTANT_ENCAPSED_STRING","'+'",872],".",["T_VARIABLE","$this",872],["T_OBJECT_OPERATOR","->",872],["T_STRING","x_axis",872],".",["T_CONSTANT_ENCAPSED_STRING","'+'",872],".",["T_VARIABLE","$this",872],["T_OBJECT_OPERATOR","->",872],["T_STRING","y_axis",872],";",["T_WHITESPACE","\n\t\t",872],"}",["T_WHITESPACE","\n\t\t",873],["T_ELSEIF","elseif",874],["T_WHITESPACE"," ",874],"(",["T_VARIABLE","$action",874],["T_WHITESPACE"," ",874],["T_IS_IDENTICAL","===",874],["T_WHITESPACE"," ",874],["T_CONSTANT_ENCAPSED_STRING","'rotate'",874],")",["T_WHITESPACE","\n\t\t",874],"{",["T_WHITESPACE","\n\t\t\t",875],["T_VARIABLE","$cmd",876],["T_WHITESPACE"," ",876],["T_CONCAT_EQUAL",".=",876],["T_WHITESPACE"," ",876],"(",["T_VARIABLE","$this",876],["T_OBJECT_OPERATOR","->",876],["T_STRING","rotation_angle",876],["T_WHITESPACE"," ",876],["T_IS_IDENTICAL","===",876],["T_WHITESPACE"," ",876],["T_CONSTANT_ENCAPSED_STRING","'hor'",876],["T_WHITESPACE"," ",876],["T_LOGICAL_OR","OR",876],["T_WHITESPACE"," ",876],["T_VARIABLE","$this",876],["T_OBJECT_OPERATOR","->",876],["T_STRING","rotation_angle",876],["T_WHITESPACE"," ",876],["T_IS_IDENTICAL","===",876],["T_WHITESPACE"," ",876],["T_CONSTANT_ENCAPSED_STRING","'vrt'",876],")",["T_WHITESPACE","\n\t\t\t\t\t",876],"?",["T_WHITESPACE"," ",877],["T_CONSTANT_ENCAPSED_STRING","' -flop'",877],["T_WHITESPACE","\n\t\t\t\t\t",877],":",["T_WHITESPACE"," ",878],["T_CONSTANT_ENCAPSED_STRING","' -rotate '",878],".",["T_VARIABLE","$this",878],["T_OBJECT_OPERATOR","->",878],["T_STRING","rotation_angle",878],";",["T_WHITESPACE","\n\t\t",878],"}",["T_WHITESPACE","\n\t\t",879],["T_ELSE","else",880],["T_WHITESPACE"," ",880],["T_COMMENT","\/\/ Resize\n",880],["T_WHITESPACE","\t\t",881],"{",["T_WHITESPACE","\n\t\t\t",881],["T_IF","if",882],"(",["T_VARIABLE","$this",882],["T_OBJECT_OPERATOR","->",882],["T_STRING","maintain_ratio",882],["T_WHITESPACE"," ",882],["T_IS_IDENTICAL","===",882],["T_WHITESPACE"," ",882],["T_STRING","TRUE",882],")",["T_WHITESPACE","\n\t\t\t",882],"{",["T_WHITESPACE","\n\t\t\t\t",883],["T_VARIABLE","$cmd",884],["T_WHITESPACE"," ",884],["T_CONCAT_EQUAL",".=",884],["T_WHITESPACE"," ",884],["T_CONSTANT_ENCAPSED_STRING","' -resize '",884],".",["T_VARIABLE","$this",884],["T_OBJECT_OPERATOR","->",884],["T_STRING","width",884],".",["T_CONSTANT_ENCAPSED_STRING","'x'",884],".",["T_VARIABLE","$this",884],["T_OBJECT_OPERATOR","->",884],["T_STRING","height",884],";",["T_WHITESPACE","\n\t\t\t",884],"}",["T_WHITESPACE","\n\t\t\t",885],["T_ELSE","else",886],["T_WHITESPACE","\n\t\t\t",886],"{",["T_WHITESPACE","\n\t\t\t\t",887],["T_VARIABLE","$cmd",888],["T_WHITESPACE"," ",888],["T_CONCAT_EQUAL",".=",888],["T_WHITESPACE"," ",888],["T_CONSTANT_ENCAPSED_STRING","' -resize '",888],".",["T_VARIABLE","$this",888],["T_OBJECT_OPERATOR","->",888],["T_STRING","width",888],".",["T_CONSTANT_ENCAPSED_STRING","'x'",888],".",["T_VARIABLE","$this",888],["T_OBJECT_OPERATOR","->",888],["T_STRING","height",888],".",["T_CONSTANT_ENCAPSED_STRING","'\\!'",888],";",["T_WHITESPACE","\n\t\t\t",888],"}",["T_WHITESPACE","\n\t\t",889],"}",["T_WHITESPACE","\n\n\t\t",890],["T_VARIABLE","$cmd",892],["T_WHITESPACE"," ",892],["T_CONCAT_EQUAL",".=",892],["T_WHITESPACE"," ",892],["T_CONSTANT_ENCAPSED_STRING","' '",892],".",["T_STRING","escapeshellarg",892],"(",["T_VARIABLE","$this",892],["T_OBJECT_OPERATOR","->",892],["T_STRING","full_src_path",892],")",".",["T_CONSTANT_ENCAPSED_STRING","' '",892],".",["T_STRING","escapeshellarg",892],"(",["T_VARIABLE","$this",892],["T_OBJECT_OPERATOR","->",892],["T_STRING","full_dst_path",892],")",".",["T_CONSTANT_ENCAPSED_STRING","' 2>&1'",892],";",["T_WHITESPACE","\n\n\t\t",892],["T_VARIABLE","$retval",894],["T_WHITESPACE"," ",894],"=",["T_WHITESPACE"," ",894],["T_LNUMBER","1",894],";",["T_WHITESPACE","\n\t\t",894],["T_COMMENT","\/\/ exec() might be disabled\n",895],["T_WHITESPACE","\t\t",896],["T_IF","if",896],["T_WHITESPACE"," ",896],"(",["T_STRING","function_usable",896],"(",["T_CONSTANT_ENCAPSED_STRING","'exec'",896],")",")",["T_WHITESPACE","\n\t\t",896],"{",["T_WHITESPACE","\n\t\t\t",897],"@",["T_STRING","exec",898],"(",["T_VARIABLE","$cmd",898],",",["T_WHITESPACE"," ",898],["T_VARIABLE","$output",898],",",["T_WHITESPACE"," ",898],["T_VARIABLE","$retval",898],")",";",["T_WHITESPACE","\n\t\t",898],"}",["T_WHITESPACE","\n\n\t\t",899],["T_COMMENT","\/\/ Did it work?\n",901],["T_WHITESPACE","\t\t",902],["T_IF","if",902],["T_WHITESPACE"," ",902],"(",["T_VARIABLE","$retval",902],["T_WHITESPACE"," ",902],">",["T_WHITESPACE"," ",902],["T_LNUMBER","0",902],")",["T_WHITESPACE","\n\t\t",902],"{",["T_WHITESPACE","\n\t\t\t",903],["T_VARIABLE","$this",904],["T_OBJECT_OPERATOR","->",904],["T_STRING","set_error",904],"(",["T_CONSTANT_ENCAPSED_STRING","'imglib_image_process_failed'",904],")",";",["T_WHITESPACE","\n\t\t\t",904],["T_RETURN","return",905],["T_WHITESPACE"," ",905],["T_STRING","FALSE",905],";",["T_WHITESPACE","\n\t\t",905],"}",["T_WHITESPACE","\n\n\t\t",906],["T_STRING","chmod",908],"(",["T_VARIABLE","$this",908],["T_OBJECT_OPERATOR","->",908],["T_STRING","full_dst_path",908],",",["T_WHITESPACE"," ",908],["T_VARIABLE","$this",908],["T_OBJECT_OPERATOR","->",908],["T_STRING","file_permissions",908],")",";",["T_WHITESPACE","\n\n\t\t",908],["T_RETURN","return",910],["T_WHITESPACE"," ",910],["T_STRING","TRUE",910],";",["T_WHITESPACE","\n\t",910],"}",["T_WHITESPACE","\n\n\t",911],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",913],["T_WHITESPACE","\n\t",914],["T_DOC_COMMENT","\/**\n\t * Image Process Using NetPBM\n\t *\n\t * This function will resize, crop or rotate\n\t *\n\t * @param\tstring\n\t * @return\tbool\n\t *\/",915],["T_WHITESPACE","\n\t",922],["T_PUBLIC","public",923],["T_WHITESPACE"," ",923],["T_FUNCTION","function",923],["T_WHITESPACE"," ",923],["T_STRING","image_process_netpbm",923],"(",["T_VARIABLE","$action",923],["T_WHITESPACE"," ",923],"=",["T_WHITESPACE"," ",923],["T_CONSTANT_ENCAPSED_STRING","'resize'",923],")",["T_WHITESPACE","\n\t",923],"{",["T_WHITESPACE","\n\t\t",924],["T_IF","if",925],["T_WHITESPACE"," ",925],"(",["T_VARIABLE","$this",925],["T_OBJECT_OPERATOR","->",925],["T_STRING","library_path",925],["T_WHITESPACE"," ",925],["T_IS_IDENTICAL","===",925],["T_WHITESPACE"," ",925],["T_CONSTANT_ENCAPSED_STRING","''",925],")",["T_WHITESPACE","\n\t\t",925],"{",["T_WHITESPACE","\n\t\t\t",926],["T_VARIABLE","$this",927],["T_OBJECT_OPERATOR","->",927],["T_STRING","set_error",927],"(",["T_CONSTANT_ENCAPSED_STRING","'imglib_libpath_invalid'",927],")",";",["T_WHITESPACE","\n\t\t\t",927],["T_RETURN","return",928],["T_WHITESPACE"," ",928],["T_STRING","FALSE",928],";",["T_WHITESPACE","\n\t\t",928],"}",["T_WHITESPACE","\n\n\t\t",929],["T_COMMENT","\/\/ Build the resizing command\n",931],["T_WHITESPACE","\t\t",932],["T_SWITCH","switch",932],["T_WHITESPACE"," ",932],"(",["T_VARIABLE","$this",932],["T_OBJECT_OPERATOR","->",932],["T_STRING","image_type",932],")",["T_WHITESPACE","\n\t\t",932],"{",["T_WHITESPACE","\n\t\t\t",933],["T_CASE","case",934],["T_WHITESPACE"," ",934],["T_LNUMBER","1",934],["T_WHITESPACE"," ",934],":",["T_WHITESPACE","\n\t\t\t\t",934],["T_VARIABLE","$cmd_in",935],["T_WHITESPACE","\t\t",935],"=",["T_WHITESPACE"," ",935],["T_CONSTANT_ENCAPSED_STRING","'giftopnm'",935],";",["T_WHITESPACE","\n\t\t\t\t",935],["T_VARIABLE","$cmd_out",936],["T_WHITESPACE","\t",936],"=",["T_WHITESPACE"," ",936],["T_CONSTANT_ENCAPSED_STRING","'ppmtogif'",936],";",["T_WHITESPACE","\n\t\t\t\t",936],["T_BREAK","break",937],";",["T_WHITESPACE","\n\t\t\t",937],["T_CASE","case",938],["T_WHITESPACE"," ",938],["T_LNUMBER","2",938],["T_WHITESPACE"," ",938],":",["T_WHITESPACE","\n\t\t\t\t",938],["T_VARIABLE","$cmd_in",939],["T_WHITESPACE","\t\t",939],"=",["T_WHITESPACE"," ",939],["T_CONSTANT_ENCAPSED_STRING","'jpegtopnm'",939],";",["T_WHITESPACE","\n\t\t\t\t",939],["T_VARIABLE","$cmd_out",940],["T_WHITESPACE","\t",940],"=",["T_WHITESPACE"," ",940],["T_CONSTANT_ENCAPSED_STRING","'ppmtojpeg'",940],";",["T_WHITESPACE","\n\t\t\t\t",940],["T_BREAK","break",941],";",["T_WHITESPACE","\n\t\t\t",941],["T_CASE","case",942],["T_WHITESPACE"," ",942],["T_LNUMBER","3",942],["T_WHITESPACE"," ",942],":",["T_WHITESPACE","\n\t\t\t\t",942],["T_VARIABLE","$cmd_in",943],["T_WHITESPACE","\t\t",943],"=",["T_WHITESPACE"," ",943],["T_CONSTANT_ENCAPSED_STRING","'pngtopnm'",943],";",["T_WHITESPACE","\n\t\t\t\t",943],["T_VARIABLE","$cmd_out",944],["T_WHITESPACE","\t",944],"=",["T_WHITESPACE"," ",944],["T_CONSTANT_ENCAPSED_STRING","'ppmtopng'",944],";",["T_WHITESPACE","\n\t\t\t\t",944],["T_BREAK","break",945],";",["T_WHITESPACE","\n\t\t",945],"}",["T_WHITESPACE","\n\n\t\t",946],["T_IF","if",948],["T_WHITESPACE"," ",948],"(",["T_VARIABLE","$action",948],["T_WHITESPACE"," ",948],["T_IS_IDENTICAL","===",948],["T_WHITESPACE"," ",948],["T_CONSTANT_ENCAPSED_STRING","'crop'",948],")",["T_WHITESPACE","\n\t\t",948],"{",["T_WHITESPACE","\n\t\t\t",949],["T_VARIABLE","$cmd_inner",950],["T_WHITESPACE"," ",950],"=",["T_WHITESPACE"," ",950],["T_CONSTANT_ENCAPSED_STRING","'pnmcut -left '",950],".",["T_VARIABLE","$this",950],["T_OBJECT_OPERATOR","->",950],["T_STRING","x_axis",950],".",["T_CONSTANT_ENCAPSED_STRING","' -top '",950],".",["T_VARIABLE","$this",950],["T_OBJECT_OPERATOR","->",950],["T_STRING","y_axis",950],".",["T_CONSTANT_ENCAPSED_STRING","' -width '",950],".",["T_VARIABLE","$this",950],["T_OBJECT_OPERATOR","->",950],["T_STRING","width",950],".",["T_CONSTANT_ENCAPSED_STRING","' -height '",950],".",["T_VARIABLE","$this",950],["T_OBJECT_OPERATOR","->",950],["T_STRING","height",950],";",["T_WHITESPACE","\n\t\t",950],"}",["T_WHITESPACE","\n\t\t",951],["T_ELSEIF","elseif",952],["T_WHITESPACE"," ",952],"(",["T_VARIABLE","$action",952],["T_WHITESPACE"," ",952],["T_IS_IDENTICAL","===",952],["T_WHITESPACE"," ",952],["T_CONSTANT_ENCAPSED_STRING","'rotate'",952],")",["T_WHITESPACE","\n\t\t",952],"{",["T_WHITESPACE","\n\t\t\t",953],["T_SWITCH","switch",954],["T_WHITESPACE"," ",954],"(",["T_VARIABLE","$this",954],["T_OBJECT_OPERATOR","->",954],["T_STRING","rotation_angle",954],")",["T_WHITESPACE","\n\t\t\t",954],"{",["T_WHITESPACE","\n\t\t\t\t",955],["T_CASE","case",956],["T_WHITESPACE"," ",956],["T_LNUMBER","90",956],":",["T_WHITESPACE","\t",956],["T_VARIABLE","$angle",956],["T_WHITESPACE"," ",956],"=",["T_WHITESPACE"," ",956],["T_CONSTANT_ENCAPSED_STRING","'r270'",956],";",["T_WHITESPACE","\n\t\t\t\t\t",956],["T_BREAK","break",957],";",["T_WHITESPACE","\n\t\t\t\t",957],["T_CASE","case",958],["T_WHITESPACE"," ",958],["T_LNUMBER","180",958],":",["T_WHITESPACE","\t",958],["T_VARIABLE","$angle",958],["T_WHITESPACE"," ",958],"=",["T_WHITESPACE"," ",958],["T_CONSTANT_ENCAPSED_STRING","'r180'",958],";",["T_WHITESPACE","\n\t\t\t\t\t",958],["T_BREAK","break",959],";",["T_WHITESPACE","\n\t\t\t\t",959],["T_CASE","case",960],["T_WHITESPACE"," ",960],["T_LNUMBER","270",960],":",["T_WHITESPACE","\t",960],["T_VARIABLE","$angle",960],["T_WHITESPACE"," ",960],"=",["T_WHITESPACE"," ",960],["T_CONSTANT_ENCAPSED_STRING","'r90'",960],";",["T_WHITESPACE","\n\t\t\t\t\t",960],["T_BREAK","break",961],";",["T_WHITESPACE","\n\t\t\t\t",961],["T_CASE","case",962],["T_WHITESPACE"," ",962],["T_CONSTANT_ENCAPSED_STRING","'vrt'",962],":",["T_WHITESPACE","\t",962],["T_VARIABLE","$angle",962],["T_WHITESPACE"," ",962],"=",["T_WHITESPACE"," ",962],["T_CONSTANT_ENCAPSED_STRING","'tb'",962],";",["T_WHITESPACE","\n\t\t\t\t\t",962],["T_BREAK","break",963],";",["T_WHITESPACE","\n\t\t\t\t",963],["T_CASE","case",964],["T_WHITESPACE"," ",964],["T_CONSTANT_ENCAPSED_STRING","'hor'",964],":",["T_WHITESPACE","\t",964],["T_VARIABLE","$angle",964],["T_WHITESPACE"," ",964],"=",["T_WHITESPACE"," ",964],["T_CONSTANT_ENCAPSED_STRING","'lr'",964],";",["T_WHITESPACE","\n\t\t\t\t\t",964],["T_BREAK","break",965],";",["T_WHITESPACE","\n\t\t\t",965],"}",["T_WHITESPACE","\n\n\t\t\t",966],["T_VARIABLE","$cmd_inner",968],["T_WHITESPACE"," ",968],"=",["T_WHITESPACE"," ",968],["T_CONSTANT_ENCAPSED_STRING","'pnmflip -'",968],".",["T_VARIABLE","$angle",968],".",["T_CONSTANT_ENCAPSED_STRING","' '",968],";",["T_WHITESPACE","\n\t\t",968],"}",["T_WHITESPACE","\n\t\t",969],["T_ELSE","else",970],["T_WHITESPACE"," ",970],["T_COMMENT","\/\/ Resize\n",970],["T_WHITESPACE","\t\t",971],"{",["T_WHITESPACE","\n\t\t\t",971],["T_VARIABLE","$cmd_inner",972],["T_WHITESPACE"," ",972],"=",["T_WHITESPACE"," ",972],["T_CONSTANT_ENCAPSED_STRING","'pnmscale -xysize '",972],".",["T_VARIABLE","$this",972],["T_OBJECT_OPERATOR","->",972],["T_STRING","width",972],".",["T_CONSTANT_ENCAPSED_STRING","' '",972],".",["T_VARIABLE","$this",972],["T_OBJECT_OPERATOR","->",972],["T_STRING","height",972],";",["T_WHITESPACE","\n\t\t",972],"}",["T_WHITESPACE","\n\n\t\t",973],["T_VARIABLE","$cmd",975],["T_WHITESPACE"," ",975],"=",["T_WHITESPACE"," ",975],["T_VARIABLE","$this",975],["T_OBJECT_OPERATOR","->",975],["T_STRING","library_path",975],".",["T_VARIABLE","$cmd_in",975],".",["T_CONSTANT_ENCAPSED_STRING","' '",975],".",["T_VARIABLE","$this",975],["T_OBJECT_OPERATOR","->",975],["T_STRING","full_src_path",975],".",["T_CONSTANT_ENCAPSED_STRING","' | '",975],".",["T_VARIABLE","$cmd_inner",975],".",["T_CONSTANT_ENCAPSED_STRING","' | '",975],".",["T_VARIABLE","$cmd_out",975],".",["T_CONSTANT_ENCAPSED_STRING","' > '",975],".",["T_VARIABLE","$this",975],["T_OBJECT_OPERATOR","->",975],["T_STRING","dest_folder",975],".",["T_CONSTANT_ENCAPSED_STRING","'netpbm.tmp'",975],";",["T_WHITESPACE","\n\n\t\t",975],["T_VARIABLE","$retval",977],["T_WHITESPACE"," ",977],"=",["T_WHITESPACE"," ",977],["T_LNUMBER","1",977],";",["T_WHITESPACE","\n\t\t",977],["T_COMMENT","\/\/ exec() might be disabled\n",978],["T_WHITESPACE","\t\t",979],["T_IF","if",979],["T_WHITESPACE"," ",979],"(",["T_STRING","function_usable",979],"(",["T_CONSTANT_ENCAPSED_STRING","'exec'",979],")",")",["T_WHITESPACE","\n\t\t",979],"{",["T_WHITESPACE","\n\t\t\t",980],"@",["T_STRING","exec",981],"(",["T_VARIABLE","$cmd",981],",",["T_WHITESPACE"," ",981],["T_VARIABLE","$output",981],",",["T_WHITESPACE"," ",981],["T_VARIABLE","$retval",981],")",";",["T_WHITESPACE","\n\t\t",981],"}",["T_WHITESPACE","\n\n\t\t",982],["T_COMMENT","\/\/ Did it work?\n",984],["T_WHITESPACE","\t\t",985],["T_IF","if",985],["T_WHITESPACE"," ",985],"(",["T_VARIABLE","$retval",985],["T_WHITESPACE"," ",985],">",["T_WHITESPACE"," ",985],["T_LNUMBER","0",985],")",["T_WHITESPACE","\n\t\t",985],"{",["T_WHITESPACE","\n\t\t\t",986],["T_VARIABLE","$this",987],["T_OBJECT_OPERATOR","->",987],["T_STRING","set_error",987],"(",["T_CONSTANT_ENCAPSED_STRING","'imglib_image_process_failed'",987],")",";",["T_WHITESPACE","\n\t\t\t",987],["T_RETURN","return",988],["T_WHITESPACE"," ",988],["T_STRING","FALSE",988],";",["T_WHITESPACE","\n\t\t",988],"}",["T_WHITESPACE","\n\n\t\t",989],["T_COMMENT","\/\/ With NetPBM we have to create a temporary image.\n",991],["T_WHITESPACE","\t\t",992],["T_COMMENT","\/\/ If you try manipulating the original it fails so\n",992],["T_WHITESPACE","\t\t",993],["T_COMMENT","\/\/ we have to rename the temp file.\n",993],["T_WHITESPACE","\t\t",994],["T_STRING","copy",994],"(",["T_VARIABLE","$this",994],["T_OBJECT_OPERATOR","->",994],["T_STRING","dest_folder",994],".",["T_CONSTANT_ENCAPSED_STRING","'netpbm.tmp'",994],",",["T_WHITESPACE"," ",994],["T_VARIABLE","$this",994],["T_OBJECT_OPERATOR","->",994],["T_STRING","full_dst_path",994],")",";",["T_WHITESPACE","\n\t\t",994],["T_STRING","unlink",995],"(",["T_VARIABLE","$this",995],["T_OBJECT_OPERATOR","->",995],["T_STRING","dest_folder",995],".",["T_CONSTANT_ENCAPSED_STRING","'netpbm.tmp'",995],")",";",["T_WHITESPACE","\n\t\t",995],["T_STRING","chmod",996],"(",["T_VARIABLE","$this",996],["T_OBJECT_OPERATOR","->",996],["T_STRING","full_dst_path",996],",",["T_WHITESPACE"," ",996],["T_VARIABLE","$this",996],["T_OBJECT_OPERATOR","->",996],["T_STRING","file_permissions",996],")",";",["T_WHITESPACE","\n\n\t\t",996],["T_RETURN","return",998],["T_WHITESPACE"," ",998],["T_STRING","TRUE",998],";",["T_WHITESPACE","\n\t",998],"}",["T_WHITESPACE","\n\n\t",999],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",1001],["T_WHITESPACE","\n\t",1002],["T_DOC_COMMENT","\/**\n\t * Image Rotate Using GD\n\t *\n\t * @return\tbool\n\t *\/",1003],["T_WHITESPACE","\n\t",1007],["T_PUBLIC","public",1008],["T_WHITESPACE"," ",1008],["T_FUNCTION","function",1008],["T_WHITESPACE"," ",1008],["T_STRING","image_rotate_gd",1008],"(",")",["T_WHITESPACE","\n\t",1008],"{",["T_WHITESPACE","\n\t\t",1009],["T_COMMENT","\/\/ Create the image handle\n",1010],["T_WHITESPACE","\t\t",1011],["T_IF","if",1011],["T_WHITESPACE"," ",1011],"(",["T_WHITESPACE"," ",1011],"!",["T_WHITESPACE"," ",1011],"(",["T_VARIABLE","$src_img",1011],["T_WHITESPACE"," ",1011],"=",["T_WHITESPACE"," ",1011],["T_VARIABLE","$this",1011],["T_OBJECT_OPERATOR","->",1011],["T_STRING","image_create_gd",1011],"(",")",")",")",["T_WHITESPACE","\n\t\t",1011],"{",["T_WHITESPACE","\n\t\t\t",1012],["T_RETURN","return",1013],["T_WHITESPACE"," ",1013],["T_STRING","FALSE",1013],";",["T_WHITESPACE","\n\t\t",1013],"}",["T_WHITESPACE","\n\n\t\t",1014],["T_COMMENT","\/\/ Set the background color\n",1016],["T_WHITESPACE","\t\t",1017],["T_COMMENT","\/\/ This won't work with transparent PNG files so we are\n",1017],["T_WHITESPACE","\t\t",1018],["T_COMMENT","\/\/ going to have to figure out how to determine the color\n",1018],["T_WHITESPACE","\t\t",1019],["T_COMMENT","\/\/ of the alpha channel in a future release.\n",1019],["T_WHITESPACE","\n\t\t",1020],["T_VARIABLE","$white",1021],["T_WHITESPACE"," ",1021],"=",["T_WHITESPACE"," ",1021],["T_STRING","imagecolorallocate",1021],"(",["T_VARIABLE","$src_img",1021],",",["T_WHITESPACE"," ",1021],["T_LNUMBER","255",1021],",",["T_WHITESPACE"," ",1021],["T_LNUMBER","255",1021],",",["T_WHITESPACE"," ",1021],["T_LNUMBER","255",1021],")",";",["T_WHITESPACE","\n\n\t\t",1021],["T_COMMENT","\/\/ Rotate it!\n",1023],["T_WHITESPACE","\t\t",1024],["T_VARIABLE","$dst_img",1024],["T_WHITESPACE"," ",1024],"=",["T_WHITESPACE"," ",1024],["T_STRING","imagerotate",1024],"(",["T_VARIABLE","$src_img",1024],",",["T_WHITESPACE"," ",1024],["T_VARIABLE","$this",1024],["T_OBJECT_OPERATOR","->",1024],["T_STRING","rotation_angle",1024],",",["T_WHITESPACE"," ",1024],["T_VARIABLE","$white",1024],")",";",["T_WHITESPACE","\n\n\t\t",1024],["T_COMMENT","\/\/ Show the image\n",1026],["T_WHITESPACE","\t\t",1027],["T_IF","if",1027],["T_WHITESPACE"," ",1027],"(",["T_VARIABLE","$this",1027],["T_OBJECT_OPERATOR","->",1027],["T_STRING","dynamic_output",1027],["T_WHITESPACE"," ",1027],["T_IS_IDENTICAL","===",1027],["T_WHITESPACE"," ",1027],["T_STRING","TRUE",1027],")",["T_WHITESPACE","\n\t\t",1027],"{",["T_WHITESPACE","\n\t\t\t",1028],["T_VARIABLE","$this",1029],["T_OBJECT_OPERATOR","->",1029],["T_STRING","image_display_gd",1029],"(",["T_VARIABLE","$dst_img",1029],")",";",["T_WHITESPACE","\n\t\t",1029],"}",["T_WHITESPACE","\n\t\t",1030],["T_ELSEIF","elseif",1031],["T_WHITESPACE"," ",1031],"(",["T_WHITESPACE"," ",1031],"!",["T_WHITESPACE"," ",1031],["T_VARIABLE","$this",1031],["T_OBJECT_OPERATOR","->",1031],["T_STRING","image_save_gd",1031],"(",["T_VARIABLE","$dst_img",1031],")",")",["T_WHITESPACE"," ",1031],["T_COMMENT","\/\/ ... or save it\n",1031],["T_WHITESPACE","\t\t",1032],"{",["T_WHITESPACE","\n\t\t\t",1032],["T_RETURN","return",1033],["T_WHITESPACE"," ",1033],["T_STRING","FALSE",1033],";",["T_WHITESPACE","\n\t\t",1033],"}",["T_WHITESPACE","\n\n\t\t",1034],["T_COMMENT","\/\/ Kill the file handles\n",1036],["T_WHITESPACE","\t\t",1037],["T_STRING","imagedestroy",1037],"(",["T_VARIABLE","$dst_img",1037],")",";",["T_WHITESPACE","\n\t\t",1037],["T_STRING","imagedestroy",1038],"(",["T_VARIABLE","$src_img",1038],")",";",["T_WHITESPACE","\n\n\t\t",1038],["T_STRING","chmod",1040],"(",["T_VARIABLE","$this",1040],["T_OBJECT_OPERATOR","->",1040],["T_STRING","full_dst_path",1040],",",["T_WHITESPACE"," ",1040],["T_VARIABLE","$this",1040],["T_OBJECT_OPERATOR","->",1040],["T_STRING","file_permissions",1040],")",";",["T_WHITESPACE","\n\n\t\t",1040],["T_RETURN","return",1042],["T_WHITESPACE"," ",1042],["T_STRING","TRUE",1042],";",["T_WHITESPACE","\n\t",1042],"}",["T_WHITESPACE","\n\n\t",1043],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",1045],["T_WHITESPACE","\n\t",1046],["T_DOC_COMMENT","\/**\n\t * Create Mirror Image using GD\n\t *\n\t * This function will flip horizontal or vertical\n\t *\n\t * @return\tbool\n\t *\/",1047],["T_WHITESPACE","\n\t",1053],["T_PUBLIC","public",1054],["T_WHITESPACE"," ",1054],["T_FUNCTION","function",1054],["T_WHITESPACE"," ",1054],["T_STRING","image_mirror_gd",1054],"(",")",["T_WHITESPACE","\n\t",1054],"{",["T_WHITESPACE","\n\t\t",1055],["T_IF","if",1056],["T_WHITESPACE"," ",1056],"(",["T_WHITESPACE"," ",1056],"!",["T_WHITESPACE"," ",1056],["T_VARIABLE","$src_img",1056],["T_WHITESPACE"," ",1056],"=",["T_WHITESPACE"," ",1056],["T_VARIABLE","$this",1056],["T_OBJECT_OPERATOR","->",1056],["T_STRING","image_create_gd",1056],"(",")",")",["T_WHITESPACE","\n\t\t",1056],"{",["T_WHITESPACE","\n\t\t\t",1057],["T_RETURN","return",1058],["T_WHITESPACE"," ",1058],["T_STRING","FALSE",1058],";",["T_WHITESPACE","\n\t\t",1058],"}",["T_WHITESPACE","\n\n\t\t",1059],["T_VARIABLE","$width",1061],["T_WHITESPACE","  ",1061],"=",["T_WHITESPACE"," ",1061],["T_VARIABLE","$this",1061],["T_OBJECT_OPERATOR","->",1061],["T_STRING","orig_width",1061],";",["T_WHITESPACE","\n\t\t",1061],["T_VARIABLE","$height",1062],["T_WHITESPACE"," ",1062],"=",["T_WHITESPACE"," ",1062],["T_VARIABLE","$this",1062],["T_OBJECT_OPERATOR","->",1062],["T_STRING","orig_height",1062],";",["T_WHITESPACE","\n\n\t\t",1062],["T_IF","if",1064],["T_WHITESPACE"," ",1064],"(",["T_VARIABLE","$this",1064],["T_OBJECT_OPERATOR","->",1064],["T_STRING","rotation_angle",1064],["T_WHITESPACE"," ",1064],["T_IS_IDENTICAL","===",1064],["T_WHITESPACE"," ",1064],["T_CONSTANT_ENCAPSED_STRING","'hor'",1064],")",["T_WHITESPACE","\n\t\t",1064],"{",["T_WHITESPACE","\n\t\t\t",1065],["T_FOR","for",1066],["T_WHITESPACE"," ",1066],"(",["T_VARIABLE","$i",1066],["T_WHITESPACE"," ",1066],"=",["T_WHITESPACE"," ",1066],["T_LNUMBER","0",1066],";",["T_WHITESPACE"," ",1066],["T_VARIABLE","$i",1066],["T_WHITESPACE"," ",1066],"<",["T_WHITESPACE"," ",1066],["T_VARIABLE","$height",1066],";",["T_WHITESPACE"," ",1066],["T_VARIABLE","$i",1066],["T_INC","++",1066],")",["T_WHITESPACE","\n\t\t\t",1066],"{",["T_WHITESPACE","\n\t\t\t\t",1067],["T_VARIABLE","$left",1068],["T_WHITESPACE"," ",1068],"=",["T_WHITESPACE"," ",1068],["T_LNUMBER","0",1068],";",["T_WHITESPACE","\n\t\t\t\t",1068],["T_VARIABLE","$right",1069],["T_WHITESPACE"," ",1069],"=",["T_WHITESPACE"," ",1069],["T_VARIABLE","$width",1069],["T_WHITESPACE"," ",1069],"-",["T_WHITESPACE"," ",1069],["T_LNUMBER","1",1069],";",["T_WHITESPACE","\n\n\t\t\t\t",1069],["T_WHILE","while",1071],["T_WHITESPACE"," ",1071],"(",["T_VARIABLE","$left",1071],["T_WHITESPACE"," ",1071],"<",["T_WHITESPACE"," ",1071],["T_VARIABLE","$right",1071],")",["T_WHITESPACE","\n\t\t\t\t",1071],"{",["T_WHITESPACE","\n\t\t\t\t\t",1072],["T_VARIABLE","$cl",1073],["T_WHITESPACE"," ",1073],"=",["T_WHITESPACE"," ",1073],["T_STRING","imagecolorat",1073],"(",["T_VARIABLE","$src_img",1073],",",["T_WHITESPACE"," ",1073],["T_VARIABLE","$left",1073],",",["T_WHITESPACE"," ",1073],["T_VARIABLE","$i",1073],")",";",["T_WHITESPACE","\n\t\t\t\t\t",1073],["T_VARIABLE","$cr",1074],["T_WHITESPACE"," ",1074],"=",["T_WHITESPACE"," ",1074],["T_STRING","imagecolorat",1074],"(",["T_VARIABLE","$src_img",1074],",",["T_WHITESPACE"," ",1074],["T_VARIABLE","$right",1074],",",["T_WHITESPACE"," ",1074],["T_VARIABLE","$i",1074],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",1074],["T_STRING","imagesetpixel",1076],"(",["T_VARIABLE","$src_img",1076],",",["T_WHITESPACE"," ",1076],["T_VARIABLE","$left",1076],",",["T_WHITESPACE"," ",1076],["T_VARIABLE","$i",1076],",",["T_WHITESPACE"," ",1076],["T_VARIABLE","$cr",1076],")",";",["T_WHITESPACE","\n\t\t\t\t\t",1076],["T_STRING","imagesetpixel",1077],"(",["T_VARIABLE","$src_img",1077],",",["T_WHITESPACE"," ",1077],["T_VARIABLE","$right",1077],",",["T_WHITESPACE"," ",1077],["T_VARIABLE","$i",1077],",",["T_WHITESPACE"," ",1077],["T_VARIABLE","$cl",1077],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",1077],["T_VARIABLE","$left",1079],["T_INC","++",1079],";",["T_WHITESPACE","\n\t\t\t\t\t",1079],["T_VARIABLE","$right",1080],["T_DEC","--",1080],";",["T_WHITESPACE","\n\t\t\t\t",1080],"}",["T_WHITESPACE","\n\t\t\t",1081],"}",["T_WHITESPACE","\n\t\t",1082],"}",["T_WHITESPACE","\n\t\t",1083],["T_ELSE","else",1084],["T_WHITESPACE","\n\t\t",1084],"{",["T_WHITESPACE","\n\t\t\t",1085],["T_FOR","for",1086],["T_WHITESPACE"," ",1086],"(",["T_VARIABLE","$i",1086],["T_WHITESPACE"," ",1086],"=",["T_WHITESPACE"," ",1086],["T_LNUMBER","0",1086],";",["T_WHITESPACE"," ",1086],["T_VARIABLE","$i",1086],["T_WHITESPACE"," ",1086],"<",["T_WHITESPACE"," ",1086],["T_VARIABLE","$width",1086],";",["T_WHITESPACE"," ",1086],["T_VARIABLE","$i",1086],["T_INC","++",1086],")",["T_WHITESPACE","\n\t\t\t",1086],"{",["T_WHITESPACE","\n\t\t\t\t",1087],["T_VARIABLE","$top",1088],["T_WHITESPACE"," ",1088],"=",["T_WHITESPACE"," ",1088],["T_LNUMBER","0",1088],";",["T_WHITESPACE","\n\t\t\t\t",1088],["T_VARIABLE","$bottom",1089],["T_WHITESPACE"," ",1089],"=",["T_WHITESPACE"," ",1089],["T_VARIABLE","$height",1089],["T_WHITESPACE"," ",1089],"-",["T_WHITESPACE"," ",1089],["T_LNUMBER","1",1089],";",["T_WHITESPACE","\n\n\t\t\t\t",1089],["T_WHILE","while",1091],["T_WHITESPACE"," ",1091],"(",["T_VARIABLE","$top",1091],["T_WHITESPACE"," ",1091],"<",["T_WHITESPACE"," ",1091],["T_VARIABLE","$bottom",1091],")",["T_WHITESPACE","\n\t\t\t\t",1091],"{",["T_WHITESPACE","\n\t\t\t\t\t",1092],["T_VARIABLE","$ct",1093],["T_WHITESPACE"," ",1093],"=",["T_WHITESPACE"," ",1093],["T_STRING","imagecolorat",1093],"(",["T_VARIABLE","$src_img",1093],",",["T_WHITESPACE"," ",1093],["T_VARIABLE","$i",1093],",",["T_WHITESPACE"," ",1093],["T_VARIABLE","$top",1093],")",";",["T_WHITESPACE","\n\t\t\t\t\t",1093],["T_VARIABLE","$cb",1094],["T_WHITESPACE"," ",1094],"=",["T_WHITESPACE"," ",1094],["T_STRING","imagecolorat",1094],"(",["T_VARIABLE","$src_img",1094],",",["T_WHITESPACE"," ",1094],["T_VARIABLE","$i",1094],",",["T_WHITESPACE"," ",1094],["T_VARIABLE","$bottom",1094],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",1094],["T_STRING","imagesetpixel",1096],"(",["T_VARIABLE","$src_img",1096],",",["T_WHITESPACE"," ",1096],["T_VARIABLE","$i",1096],",",["T_WHITESPACE"," ",1096],["T_VARIABLE","$top",1096],",",["T_WHITESPACE"," ",1096],["T_VARIABLE","$cb",1096],")",";",["T_WHITESPACE","\n\t\t\t\t\t",1096],["T_STRING","imagesetpixel",1097],"(",["T_VARIABLE","$src_img",1097],",",["T_WHITESPACE"," ",1097],["T_VARIABLE","$i",1097],",",["T_WHITESPACE"," ",1097],["T_VARIABLE","$bottom",1097],",",["T_WHITESPACE"," ",1097],["T_VARIABLE","$ct",1097],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",1097],["T_VARIABLE","$top",1099],["T_INC","++",1099],";",["T_WHITESPACE","\n\t\t\t\t\t",1099],["T_VARIABLE","$bottom",1100],["T_DEC","--",1100],";",["T_WHITESPACE","\n\t\t\t\t",1100],"}",["T_WHITESPACE","\n\t\t\t",1101],"}",["T_WHITESPACE","\n\t\t",1102],"}",["T_WHITESPACE","\n\n\t\t",1103],["T_COMMENT","\/\/ Show the image\n",1105],["T_WHITESPACE","\t\t",1106],["T_IF","if",1106],["T_WHITESPACE"," ",1106],"(",["T_VARIABLE","$this",1106],["T_OBJECT_OPERATOR","->",1106],["T_STRING","dynamic_output",1106],["T_WHITESPACE"," ",1106],["T_IS_IDENTICAL","===",1106],["T_WHITESPACE"," ",1106],["T_STRING","TRUE",1106],")",["T_WHITESPACE","\n\t\t",1106],"{",["T_WHITESPACE","\n\t\t\t",1107],["T_VARIABLE","$this",1108],["T_OBJECT_OPERATOR","->",1108],["T_STRING","image_display_gd",1108],"(",["T_VARIABLE","$src_img",1108],")",";",["T_WHITESPACE","\n\t\t",1108],"}",["T_WHITESPACE","\n\t\t",1109],["T_ELSEIF","elseif",1110],["T_WHITESPACE"," ",1110],"(",["T_WHITESPACE"," ",1110],"!",["T_WHITESPACE"," ",1110],["T_VARIABLE","$this",1110],["T_OBJECT_OPERATOR","->",1110],["T_STRING","image_save_gd",1110],"(",["T_VARIABLE","$src_img",1110],")",")",["T_WHITESPACE"," ",1110],["T_COMMENT","\/\/ ... or save it\n",1110],["T_WHITESPACE","\t\t",1111],"{",["T_WHITESPACE","\n\t\t\t",1111],["T_RETURN","return",1112],["T_WHITESPACE"," ",1112],["T_STRING","FALSE",1112],";",["T_WHITESPACE","\n\t\t",1112],"}",["T_WHITESPACE","\n\n\t\t",1113],["T_COMMENT","\/\/ Kill the file handles\n",1115],["T_WHITESPACE","\t\t",1116],["T_STRING","imagedestroy",1116],"(",["T_VARIABLE","$src_img",1116],")",";",["T_WHITESPACE","\n\n\t\t",1116],["T_STRING","chmod",1118],"(",["T_VARIABLE","$this",1118],["T_OBJECT_OPERATOR","->",1118],["T_STRING","full_dst_path",1118],",",["T_WHITESPACE"," ",1118],["T_VARIABLE","$this",1118],["T_OBJECT_OPERATOR","->",1118],["T_STRING","file_permissions",1118],")",";",["T_WHITESPACE","\n\n\t\t",1118],["T_RETURN","return",1120],["T_WHITESPACE"," ",1120],["T_STRING","TRUE",1120],";",["T_WHITESPACE","\n\t",1120],"}",["T_WHITESPACE","\n\n\t",1121],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",1123],["T_WHITESPACE","\n\t",1124],["T_DOC_COMMENT","\/**\n\t * Image Watermark\n\t *\n\t * This is a wrapper function that chooses the type\n\t * of watermarking based on the specified preference.\n\t *\n\t * @return\tbool\n\t *\/",1125],["T_WHITESPACE","\n\t",1132],["T_PUBLIC","public",1133],["T_WHITESPACE"," ",1133],["T_FUNCTION","function",1133],["T_WHITESPACE"," ",1133],["T_STRING","watermark",1133],"(",")",["T_WHITESPACE","\n\t",1133],"{",["T_WHITESPACE","\n\t\t",1134],["T_RETURN","return",1135],["T_WHITESPACE"," ",1135],"(",["T_VARIABLE","$this",1135],["T_OBJECT_OPERATOR","->",1135],["T_STRING","wm_type",1135],["T_WHITESPACE"," ",1135],["T_IS_IDENTICAL","===",1135],["T_WHITESPACE"," ",1135],["T_CONSTANT_ENCAPSED_STRING","'overlay'",1135],")",["T_WHITESPACE"," ",1135],"?",["T_WHITESPACE"," ",1135],["T_VARIABLE","$this",1135],["T_OBJECT_OPERATOR","->",1135],["T_STRING","overlay_watermark",1135],"(",")",["T_WHITESPACE"," ",1135],":",["T_WHITESPACE"," ",1135],["T_VARIABLE","$this",1135],["T_OBJECT_OPERATOR","->",1135],["T_STRING","text_watermark",1135],"(",")",";",["T_WHITESPACE","\n\t",1135],"}",["T_WHITESPACE","\n\n\t",1136],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",1138],["T_WHITESPACE","\n\t",1139],["T_DOC_COMMENT","\/**\n\t * Watermark - Graphic Version\n\t *\n\t * @return\tbool\n\t *\/",1140],["T_WHITESPACE","\n\t",1144],["T_PUBLIC","public",1145],["T_WHITESPACE"," ",1145],["T_FUNCTION","function",1145],["T_WHITESPACE"," ",1145],["T_STRING","overlay_watermark",1145],"(",")",["T_WHITESPACE","\n\t",1145],"{",["T_WHITESPACE","\n\t\t",1146],["T_IF","if",1147],["T_WHITESPACE"," ",1147],"(",["T_WHITESPACE"," ",1147],"!",["T_WHITESPACE"," ",1147],["T_STRING","function_exists",1147],"(",["T_CONSTANT_ENCAPSED_STRING","'imagecolortransparent'",1147],")",")",["T_WHITESPACE","\n\t\t",1147],"{",["T_WHITESPACE","\n\t\t\t",1148],["T_VARIABLE","$this",1149],["T_OBJECT_OPERATOR","->",1149],["T_STRING","set_error",1149],"(",["T_CONSTANT_ENCAPSED_STRING","'imglib_gd_required'",1149],")",";",["T_WHITESPACE","\n\t\t\t",1149],["T_RETURN","return",1150],["T_WHITESPACE"," ",1150],["T_STRING","FALSE",1150],";",["T_WHITESPACE","\n\t\t",1150],"}",["T_WHITESPACE","\n\n\t\t",1151],["T_COMMENT","\/\/ Fetch source image properties\n",1153],["T_WHITESPACE","\t\t",1154],["T_VARIABLE","$this",1154],["T_OBJECT_OPERATOR","->",1154],["T_STRING","get_image_properties",1154],"(",")",";",["T_WHITESPACE","\n\n\t\t",1154],["T_COMMENT","\/\/ Fetch watermark image properties\n",1156],["T_WHITESPACE","\t\t",1157],["T_VARIABLE","$props",1157],["T_WHITESPACE","\t\t",1157],"=",["T_WHITESPACE"," ",1157],["T_VARIABLE","$this",1157],["T_OBJECT_OPERATOR","->",1157],["T_STRING","get_image_properties",1157],"(",["T_VARIABLE","$this",1157],["T_OBJECT_OPERATOR","->",1157],["T_STRING","wm_overlay_path",1157],",",["T_WHITESPACE"," ",1157],["T_STRING","TRUE",1157],")",";",["T_WHITESPACE","\n\t\t",1157],["T_VARIABLE","$wm_img_type",1158],["T_WHITESPACE","\t",1158],"=",["T_WHITESPACE"," ",1158],["T_VARIABLE","$props",1158],"[",["T_CONSTANT_ENCAPSED_STRING","'image_type'",1158],"]",";",["T_WHITESPACE","\n\t\t",1158],["T_VARIABLE","$wm_width",1159],["T_WHITESPACE","\t",1159],"=",["T_WHITESPACE"," ",1159],["T_VARIABLE","$props",1159],"[",["T_CONSTANT_ENCAPSED_STRING","'width'",1159],"]",";",["T_WHITESPACE","\n\t\t",1159],["T_VARIABLE","$wm_height",1160],["T_WHITESPACE","\t",1160],"=",["T_WHITESPACE"," ",1160],["T_VARIABLE","$props",1160],"[",["T_CONSTANT_ENCAPSED_STRING","'height'",1160],"]",";",["T_WHITESPACE","\n\n\t\t",1160],["T_COMMENT","\/\/ Create two image resources\n",1162],["T_WHITESPACE","\t\t",1163],["T_VARIABLE","$wm_img",1163],["T_WHITESPACE","  ",1163],"=",["T_WHITESPACE"," ",1163],["T_VARIABLE","$this",1163],["T_OBJECT_OPERATOR","->",1163],["T_STRING","image_create_gd",1163],"(",["T_VARIABLE","$this",1163],["T_OBJECT_OPERATOR","->",1163],["T_STRING","wm_overlay_path",1163],",",["T_WHITESPACE"," ",1163],["T_VARIABLE","$wm_img_type",1163],")",";",["T_WHITESPACE","\n\t\t",1163],["T_VARIABLE","$src_img",1164],["T_WHITESPACE"," ",1164],"=",["T_WHITESPACE"," ",1164],["T_VARIABLE","$this",1164],["T_OBJECT_OPERATOR","->",1164],["T_STRING","image_create_gd",1164],"(",["T_VARIABLE","$this",1164],["T_OBJECT_OPERATOR","->",1164],["T_STRING","full_src_path",1164],")",";",["T_WHITESPACE","\n\n\t\t",1164],["T_COMMENT","\/\/ Reverse the offset if necessary\n",1166],["T_WHITESPACE","\t\t",1167],["T_COMMENT","\/\/ When the image is positioned at the bottom\n",1167],["T_WHITESPACE","\t\t",1168],["T_COMMENT","\/\/ we don't want the vertical offset to push it\n",1168],["T_WHITESPACE","\t\t",1169],["T_COMMENT","\/\/ further down. We want the reverse, so we'll\n",1169],["T_WHITESPACE","\t\t",1170],["T_COMMENT","\/\/ invert the offset. Same with the horizontal\n",1170],["T_WHITESPACE","\t\t",1171],["T_COMMENT","\/\/ offset when the image is at the right\n",1171],["T_WHITESPACE","\n\t\t",1172],["T_VARIABLE","$this",1173],["T_OBJECT_OPERATOR","->",1173],["T_STRING","wm_vrt_alignment",1173],["T_WHITESPACE"," ",1173],"=",["T_WHITESPACE"," ",1173],["T_STRING","strtoupper",1173],"(",["T_VARIABLE","$this",1173],["T_OBJECT_OPERATOR","->",1173],["T_STRING","wm_vrt_alignment",1173],"[",["T_LNUMBER","0",1173],"]",")",";",["T_WHITESPACE","\n\t\t",1173],["T_VARIABLE","$this",1174],["T_OBJECT_OPERATOR","->",1174],["T_STRING","wm_hor_alignment",1174],["T_WHITESPACE"," ",1174],"=",["T_WHITESPACE"," ",1174],["T_STRING","strtoupper",1174],"(",["T_VARIABLE","$this",1174],["T_OBJECT_OPERATOR","->",1174],["T_STRING","wm_hor_alignment",1174],"[",["T_LNUMBER","0",1174],"]",")",";",["T_WHITESPACE","\n\n\t\t",1174],["T_IF","if",1176],["T_WHITESPACE"," ",1176],"(",["T_VARIABLE","$this",1176],["T_OBJECT_OPERATOR","->",1176],["T_STRING","wm_vrt_alignment",1176],["T_WHITESPACE"," ",1176],["T_IS_IDENTICAL","===",1176],["T_WHITESPACE"," ",1176],["T_CONSTANT_ENCAPSED_STRING","'B'",1176],")",["T_WHITESPACE","\n\t\t\t",1176],["T_VARIABLE","$this",1177],["T_OBJECT_OPERATOR","->",1177],["T_STRING","wm_vrt_offset",1177],["T_WHITESPACE"," ",1177],"=",["T_WHITESPACE"," ",1177],["T_VARIABLE","$this",1177],["T_OBJECT_OPERATOR","->",1177],["T_STRING","wm_vrt_offset",1177],["T_WHITESPACE"," ",1177],"*",["T_WHITESPACE"," ",1177],"-",["T_LNUMBER","1",1177],";",["T_WHITESPACE","\n\n\t\t",1177],["T_IF","if",1179],["T_WHITESPACE"," ",1179],"(",["T_VARIABLE","$this",1179],["T_OBJECT_OPERATOR","->",1179],["T_STRING","wm_hor_alignment",1179],["T_WHITESPACE"," ",1179],["T_IS_IDENTICAL","===",1179],["T_WHITESPACE"," ",1179],["T_CONSTANT_ENCAPSED_STRING","'R'",1179],")",["T_WHITESPACE","\n\t\t\t",1179],["T_VARIABLE","$this",1180],["T_OBJECT_OPERATOR","->",1180],["T_STRING","wm_hor_offset",1180],["T_WHITESPACE"," ",1180],"=",["T_WHITESPACE"," ",1180],["T_VARIABLE","$this",1180],["T_OBJECT_OPERATOR","->",1180],["T_STRING","wm_hor_offset",1180],["T_WHITESPACE"," ",1180],"*",["T_WHITESPACE"," ",1180],"-",["T_LNUMBER","1",1180],";",["T_WHITESPACE","\n\n\t\t",1180],["T_COMMENT","\/\/ Set the base x and y axis values\n",1182],["T_WHITESPACE","\t\t",1183],["T_VARIABLE","$x_axis",1183],["T_WHITESPACE"," ",1183],"=",["T_WHITESPACE"," ",1183],["T_VARIABLE","$this",1183],["T_OBJECT_OPERATOR","->",1183],["T_STRING","wm_hor_offset",1183],["T_WHITESPACE"," ",1183],"+",["T_WHITESPACE"," ",1183],["T_VARIABLE","$this",1183],["T_OBJECT_OPERATOR","->",1183],["T_STRING","wm_padding",1183],";",["T_WHITESPACE","\n\t\t",1183],["T_VARIABLE","$y_axis",1184],["T_WHITESPACE"," ",1184],"=",["T_WHITESPACE"," ",1184],["T_VARIABLE","$this",1184],["T_OBJECT_OPERATOR","->",1184],["T_STRING","wm_vrt_offset",1184],["T_WHITESPACE"," ",1184],"+",["T_WHITESPACE"," ",1184],["T_VARIABLE","$this",1184],["T_OBJECT_OPERATOR","->",1184],["T_STRING","wm_padding",1184],";",["T_WHITESPACE","\n\n\t\t",1184],["T_COMMENT","\/\/ Set the vertical position\n",1186],["T_WHITESPACE","\t\t",1187],["T_IF","if",1187],["T_WHITESPACE"," ",1187],"(",["T_VARIABLE","$this",1187],["T_OBJECT_OPERATOR","->",1187],["T_STRING","wm_vrt_alignment",1187],["T_WHITESPACE"," ",1187],["T_IS_IDENTICAL","===",1187],["T_WHITESPACE"," ",1187],["T_CONSTANT_ENCAPSED_STRING","'M'",1187],")",["T_WHITESPACE","\n\t\t",1187],"{",["T_WHITESPACE","\n\t\t\t",1188],["T_VARIABLE","$y_axis",1189],["T_WHITESPACE"," ",1189],["T_PLUS_EQUAL","+=",1189],["T_WHITESPACE"," ",1189],"(",["T_VARIABLE","$this",1189],["T_OBJECT_OPERATOR","->",1189],["T_STRING","orig_height",1189],["T_WHITESPACE"," ",1189],"\/",["T_WHITESPACE"," ",1189],["T_LNUMBER","2",1189],")",["T_WHITESPACE"," ",1189],"-",["T_WHITESPACE"," ",1189],"(",["T_VARIABLE","$wm_height",1189],["T_WHITESPACE"," ",1189],"\/",["T_WHITESPACE"," ",1189],["T_LNUMBER","2",1189],")",";",["T_WHITESPACE","\n\t\t",1189],"}",["T_WHITESPACE","\n\t\t",1190],["T_ELSEIF","elseif",1191],["T_WHITESPACE"," ",1191],"(",["T_VARIABLE","$this",1191],["T_OBJECT_OPERATOR","->",1191],["T_STRING","wm_vrt_alignment",1191],["T_WHITESPACE"," ",1191],["T_IS_IDENTICAL","===",1191],["T_WHITESPACE"," ",1191],["T_CONSTANT_ENCAPSED_STRING","'B'",1191],")",["T_WHITESPACE","\n\t\t",1191],"{",["T_WHITESPACE","\n\t\t\t",1192],["T_VARIABLE","$y_axis",1193],["T_WHITESPACE"," ",1193],["T_PLUS_EQUAL","+=",1193],["T_WHITESPACE"," ",1193],["T_VARIABLE","$this",1193],["T_OBJECT_OPERATOR","->",1193],["T_STRING","orig_height",1193],["T_WHITESPACE"," ",1193],"-",["T_WHITESPACE"," ",1193],["T_VARIABLE","$wm_height",1193],";",["T_WHITESPACE","\n\t\t",1193],"}",["T_WHITESPACE","\n\n\t\t",1194],["T_COMMENT","\/\/ Set the horizontal position\n",1196],["T_WHITESPACE","\t\t",1197],["T_IF","if",1197],["T_WHITESPACE"," ",1197],"(",["T_VARIABLE","$this",1197],["T_OBJECT_OPERATOR","->",1197],["T_STRING","wm_hor_alignment",1197],["T_WHITESPACE"," ",1197],["T_IS_IDENTICAL","===",1197],["T_WHITESPACE"," ",1197],["T_CONSTANT_ENCAPSED_STRING","'C'",1197],")",["T_WHITESPACE","\n\t\t",1197],"{",["T_WHITESPACE","\n\t\t\t",1198],["T_VARIABLE","$x_axis",1199],["T_WHITESPACE"," ",1199],["T_PLUS_EQUAL","+=",1199],["T_WHITESPACE"," ",1199],"(",["T_VARIABLE","$this",1199],["T_OBJECT_OPERATOR","->",1199],["T_STRING","orig_width",1199],["T_WHITESPACE"," ",1199],"\/",["T_WHITESPACE"," ",1199],["T_LNUMBER","2",1199],")",["T_WHITESPACE"," ",1199],"-",["T_WHITESPACE"," ",1199],"(",["T_VARIABLE","$wm_width",1199],["T_WHITESPACE"," ",1199],"\/",["T_WHITESPACE"," ",1199],["T_LNUMBER","2",1199],")",";",["T_WHITESPACE","\n\t\t",1199],"}",["T_WHITESPACE","\n\t\t",1200],["T_ELSEIF","elseif",1201],["T_WHITESPACE"," ",1201],"(",["T_VARIABLE","$this",1201],["T_OBJECT_OPERATOR","->",1201],["T_STRING","wm_hor_alignment",1201],["T_WHITESPACE"," ",1201],["T_IS_IDENTICAL","===",1201],["T_WHITESPACE"," ",1201],["T_CONSTANT_ENCAPSED_STRING","'R'",1201],")",["T_WHITESPACE","\n\t\t",1201],"{",["T_WHITESPACE","\n\t\t\t",1202],["T_VARIABLE","$x_axis",1203],["T_WHITESPACE"," ",1203],["T_PLUS_EQUAL","+=",1203],["T_WHITESPACE"," ",1203],["T_VARIABLE","$this",1203],["T_OBJECT_OPERATOR","->",1203],["T_STRING","orig_width",1203],["T_WHITESPACE"," ",1203],"-",["T_WHITESPACE"," ",1203],["T_VARIABLE","$wm_width",1203],";",["T_WHITESPACE","\n\t\t",1203],"}",["T_WHITESPACE","\n\n\t\t",1204],["T_COMMENT","\/\/ Build the finalized image\n",1206],["T_WHITESPACE","\t\t",1207],["T_IF","if",1207],["T_WHITESPACE"," ",1207],"(",["T_VARIABLE","$wm_img_type",1207],["T_WHITESPACE"," ",1207],["T_IS_IDENTICAL","===",1207],["T_WHITESPACE"," ",1207],["T_LNUMBER","3",1207],")",["T_WHITESPACE","\n\t\t",1207],"{",["T_WHITESPACE","\n\t\t\t",1208],"@",["T_STRING","imagealphablending",1209],"(",["T_VARIABLE","$src_img",1209],",",["T_WHITESPACE"," ",1209],["T_STRING","TRUE",1209],")",";",["T_WHITESPACE","\n\t\t",1209],"}",["T_WHITESPACE","\n\n\t\t",1210],["T_COMMENT","\/\/ Set RGB values for text and shadow\n",1212],["T_WHITESPACE","\t\t",1213],["T_VARIABLE","$rgba",1213],["T_WHITESPACE"," ",1213],"=",["T_WHITESPACE"," ",1213],["T_STRING","imagecolorat",1213],"(",["T_VARIABLE","$wm_img",1213],",",["T_WHITESPACE"," ",1213],["T_VARIABLE","$this",1213],["T_OBJECT_OPERATOR","->",1213],["T_STRING","wm_x_transp",1213],",",["T_WHITESPACE"," ",1213],["T_VARIABLE","$this",1213],["T_OBJECT_OPERATOR","->",1213],["T_STRING","wm_y_transp",1213],")",";",["T_WHITESPACE","\n\t\t",1213],["T_VARIABLE","$alpha",1214],["T_WHITESPACE"," ",1214],"=",["T_WHITESPACE"," ",1214],"(",["T_VARIABLE","$rgba",1214],["T_WHITESPACE"," ",1214],"&",["T_WHITESPACE"," ",1214],["T_LNUMBER","0x7F000000",1214],")",["T_WHITESPACE"," ",1214],["T_SR",">>",1214],["T_WHITESPACE"," ",1214],["T_LNUMBER","24",1214],";",["T_WHITESPACE","\n\n\t\t",1214],["T_COMMENT","\/\/ make a best guess as to whether we're dealing with an image with alpha transparency or no\/binary transparency\n",1216],["T_WHITESPACE","\t\t",1217],["T_IF","if",1217],["T_WHITESPACE"," ",1217],"(",["T_VARIABLE","$alpha",1217],["T_WHITESPACE"," ",1217],">",["T_WHITESPACE"," ",1217],["T_LNUMBER","0",1217],")",["T_WHITESPACE","\n\t\t",1217],"{",["T_WHITESPACE","\n\t\t\t",1218],["T_COMMENT","\/\/ copy the image directly, the image's alpha transparency being the sole determinant of blending\n",1219],["T_WHITESPACE","\t\t\t",1220],["T_STRING","imagecopy",1220],"(",["T_VARIABLE","$src_img",1220],",",["T_WHITESPACE"," ",1220],["T_VARIABLE","$wm_img",1220],",",["T_WHITESPACE"," ",1220],["T_VARIABLE","$x_axis",1220],",",["T_WHITESPACE"," ",1220],["T_VARIABLE","$y_axis",1220],",",["T_WHITESPACE"," ",1220],["T_LNUMBER","0",1220],",",["T_WHITESPACE"," ",1220],["T_LNUMBER","0",1220],",",["T_WHITESPACE"," ",1220],["T_VARIABLE","$wm_width",1220],",",["T_WHITESPACE"," ",1220],["T_VARIABLE","$wm_height",1220],")",";",["T_WHITESPACE","\n\t\t",1220],"}",["T_WHITESPACE","\n\t\t",1221],["T_ELSE","else",1222],["T_WHITESPACE","\n\t\t",1222],"{",["T_WHITESPACE","\n\t\t\t",1223],["T_COMMENT","\/\/ set our RGB value from above to be transparent and merge the images with the specified opacity\n",1224],["T_WHITESPACE","\t\t\t",1225],["T_STRING","imagecolortransparent",1225],"(",["T_VARIABLE","$wm_img",1225],",",["T_WHITESPACE"," ",1225],["T_STRING","imagecolorat",1225],"(",["T_VARIABLE","$wm_img",1225],",",["T_WHITESPACE"," ",1225],["T_VARIABLE","$this",1225],["T_OBJECT_OPERATOR","->",1225],["T_STRING","wm_x_transp",1225],",",["T_WHITESPACE"," ",1225],["T_VARIABLE","$this",1225],["T_OBJECT_OPERATOR","->",1225],["T_STRING","wm_y_transp",1225],")",")",";",["T_WHITESPACE","\n\t\t\t",1225],["T_STRING","imagecopymerge",1226],"(",["T_VARIABLE","$src_img",1226],",",["T_WHITESPACE"," ",1226],["T_VARIABLE","$wm_img",1226],",",["T_WHITESPACE"," ",1226],["T_VARIABLE","$x_axis",1226],",",["T_WHITESPACE"," ",1226],["T_VARIABLE","$y_axis",1226],",",["T_WHITESPACE"," ",1226],["T_LNUMBER","0",1226],",",["T_WHITESPACE"," ",1226],["T_LNUMBER","0",1226],",",["T_WHITESPACE"," ",1226],["T_VARIABLE","$wm_width",1226],",",["T_WHITESPACE"," ",1226],["T_VARIABLE","$wm_height",1226],",",["T_WHITESPACE"," ",1226],["T_VARIABLE","$this",1226],["T_OBJECT_OPERATOR","->",1226],["T_STRING","wm_opacity",1226],")",";",["T_WHITESPACE","\n\t\t",1226],"}",["T_WHITESPACE","\n\n\t\t",1227],["T_COMMENT","\/\/ We can preserve transparency for PNG images\n",1229],["T_WHITESPACE","\t\t",1230],["T_IF","if",1230],["T_WHITESPACE"," ",1230],"(",["T_VARIABLE","$this",1230],["T_OBJECT_OPERATOR","->",1230],["T_STRING","image_type",1230],["T_WHITESPACE"," ",1230],["T_IS_IDENTICAL","===",1230],["T_WHITESPACE"," ",1230],["T_LNUMBER","3",1230],")",["T_WHITESPACE","\n\t\t",1230],"{",["T_WHITESPACE","\n\t\t\t",1231],["T_STRING","imagealphablending",1232],"(",["T_VARIABLE","$src_img",1232],",",["T_WHITESPACE"," ",1232],["T_STRING","FALSE",1232],")",";",["T_WHITESPACE","\n\t\t\t",1232],["T_STRING","imagesavealpha",1233],"(",["T_VARIABLE","$src_img",1233],",",["T_WHITESPACE"," ",1233],["T_STRING","TRUE",1233],")",";",["T_WHITESPACE","\n\t\t",1233],"}",["T_WHITESPACE","\n\n\t\t",1234],["T_COMMENT","\/\/ Output the image\n",1236],["T_WHITESPACE","\t\t",1237],["T_IF","if",1237],["T_WHITESPACE"," ",1237],"(",["T_VARIABLE","$this",1237],["T_OBJECT_OPERATOR","->",1237],["T_STRING","dynamic_output",1237],["T_WHITESPACE"," ",1237],["T_IS_IDENTICAL","===",1237],["T_WHITESPACE"," ",1237],["T_STRING","TRUE",1237],")",["T_WHITESPACE","\n\t\t",1237],"{",["T_WHITESPACE","\n\t\t\t",1238],["T_VARIABLE","$this",1239],["T_OBJECT_OPERATOR","->",1239],["T_STRING","image_display_gd",1239],"(",["T_VARIABLE","$src_img",1239],")",";",["T_WHITESPACE","\n\t\t",1239],"}",["T_WHITESPACE","\n\t\t",1240],["T_ELSEIF","elseif",1241],["T_WHITESPACE"," ",1241],"(",["T_WHITESPACE"," ",1241],"!",["T_WHITESPACE"," ",1241],["T_VARIABLE","$this",1241],["T_OBJECT_OPERATOR","->",1241],["T_STRING","image_save_gd",1241],"(",["T_VARIABLE","$src_img",1241],")",")",["T_WHITESPACE"," ",1241],["T_COMMENT","\/\/ ... or save it\n",1241],["T_WHITESPACE","\t\t",1242],"{",["T_WHITESPACE","\n\t\t\t",1242],["T_RETURN","return",1243],["T_WHITESPACE"," ",1243],["T_STRING","FALSE",1243],";",["T_WHITESPACE","\n\t\t",1243],"}",["T_WHITESPACE","\n\n\t\t",1244],["T_STRING","imagedestroy",1246],"(",["T_VARIABLE","$src_img",1246],")",";",["T_WHITESPACE","\n\t\t",1246],["T_STRING","imagedestroy",1247],"(",["T_VARIABLE","$wm_img",1247],")",";",["T_WHITESPACE","\n\n\t\t",1247],["T_RETURN","return",1249],["T_WHITESPACE"," ",1249],["T_STRING","TRUE",1249],";",["T_WHITESPACE","\n\t",1249],"}",["T_WHITESPACE","\n\n\t",1250],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",1252],["T_WHITESPACE","\n\t",1253],["T_DOC_COMMENT","\/**\n\t * Watermark - Text Version\n\t *\n\t * @return\tbool\n\t *\/",1254],["T_WHITESPACE","\n\t",1258],["T_PUBLIC","public",1259],["T_WHITESPACE"," ",1259],["T_FUNCTION","function",1259],["T_WHITESPACE"," ",1259],["T_STRING","text_watermark",1259],"(",")",["T_WHITESPACE","\n\t",1259],"{",["T_WHITESPACE","\n\t\t",1260],["T_IF","if",1261],["T_WHITESPACE"," ",1261],"(",["T_WHITESPACE"," ",1261],"!",["T_WHITESPACE"," ",1261],"(",["T_VARIABLE","$src_img",1261],["T_WHITESPACE"," ",1261],"=",["T_WHITESPACE"," ",1261],["T_VARIABLE","$this",1261],["T_OBJECT_OPERATOR","->",1261],["T_STRING","image_create_gd",1261],"(",")",")",")",["T_WHITESPACE","\n\t\t",1261],"{",["T_WHITESPACE","\n\t\t\t",1262],["T_RETURN","return",1263],["T_WHITESPACE"," ",1263],["T_STRING","FALSE",1263],";",["T_WHITESPACE","\n\t\t",1263],"}",["T_WHITESPACE","\n\n\t\t",1264],["T_IF","if",1266],["T_WHITESPACE"," ",1266],"(",["T_VARIABLE","$this",1266],["T_OBJECT_OPERATOR","->",1266],["T_STRING","wm_use_truetype",1266],["T_WHITESPACE"," ",1266],["T_IS_IDENTICAL","===",1266],["T_WHITESPACE"," ",1266],["T_STRING","TRUE",1266],["T_WHITESPACE"," ",1266],["T_BOOLEAN_AND","&&",1266],["T_WHITESPACE"," ",1266],"!",["T_WHITESPACE"," ",1266],["T_STRING","file_exists",1266],"(",["T_VARIABLE","$this",1266],["T_OBJECT_OPERATOR","->",1266],["T_STRING","wm_font_path",1266],")",")",["T_WHITESPACE","\n\t\t",1266],"{",["T_WHITESPACE","\n\t\t\t",1267],["T_VARIABLE","$this",1268],["T_OBJECT_OPERATOR","->",1268],["T_STRING","set_error",1268],"(",["T_CONSTANT_ENCAPSED_STRING","'imglib_missing_font'",1268],")",";",["T_WHITESPACE","\n\t\t\t",1268],["T_RETURN","return",1269],["T_WHITESPACE"," ",1269],["T_STRING","FALSE",1269],";",["T_WHITESPACE","\n\t\t",1269],"}",["T_WHITESPACE","\n\n\t\t",1270],["T_COMMENT","\/\/ Fetch source image properties\n",1272],["T_WHITESPACE","\t\t",1273],["T_VARIABLE","$this",1273],["T_OBJECT_OPERATOR","->",1273],["T_STRING","get_image_properties",1273],"(",")",";",["T_WHITESPACE","\n\n\t\t",1273],["T_COMMENT","\/\/ Reverse the vertical offset\n",1275],["T_WHITESPACE","\t\t",1276],["T_COMMENT","\/\/ When the image is positioned at the bottom\n",1276],["T_WHITESPACE","\t\t",1277],["T_COMMENT","\/\/ we don't want the vertical offset to push it\n",1277],["T_WHITESPACE","\t\t",1278],["T_COMMENT","\/\/ further down. We want the reverse, so we'll\n",1278],["T_WHITESPACE","\t\t",1279],["T_COMMENT","\/\/ invert the offset. Note: The horizontal\n",1279],["T_WHITESPACE","\t\t",1280],["T_COMMENT","\/\/ offset flips itself automatically\n",1280],["T_WHITESPACE","\n\t\t",1281],["T_IF","if",1282],["T_WHITESPACE"," ",1282],"(",["T_VARIABLE","$this",1282],["T_OBJECT_OPERATOR","->",1282],["T_STRING","wm_vrt_alignment",1282],["T_WHITESPACE"," ",1282],["T_IS_IDENTICAL","===",1282],["T_WHITESPACE"," ",1282],["T_CONSTANT_ENCAPSED_STRING","'B'",1282],")",["T_WHITESPACE","\n\t\t",1282],"{",["T_WHITESPACE","\n\t\t\t",1283],["T_VARIABLE","$this",1284],["T_OBJECT_OPERATOR","->",1284],["T_STRING","wm_vrt_offset",1284],["T_WHITESPACE"," ",1284],"=",["T_WHITESPACE"," ",1284],["T_VARIABLE","$this",1284],["T_OBJECT_OPERATOR","->",1284],["T_STRING","wm_vrt_offset",1284],["T_WHITESPACE"," ",1284],"*",["T_WHITESPACE"," ",1284],"-",["T_LNUMBER","1",1284],";",["T_WHITESPACE","\n\t\t",1284],"}",["T_WHITESPACE","\n\n\t\t",1285],["T_IF","if",1287],["T_WHITESPACE"," ",1287],"(",["T_VARIABLE","$this",1287],["T_OBJECT_OPERATOR","->",1287],["T_STRING","wm_hor_alignment",1287],["T_WHITESPACE"," ",1287],["T_IS_IDENTICAL","===",1287],["T_WHITESPACE"," ",1287],["T_CONSTANT_ENCAPSED_STRING","'R'",1287],")",["T_WHITESPACE","\n\t\t",1287],"{",["T_WHITESPACE","\n\t\t\t",1288],["T_VARIABLE","$this",1289],["T_OBJECT_OPERATOR","->",1289],["T_STRING","wm_hor_offset",1289],["T_WHITESPACE"," ",1289],"=",["T_WHITESPACE"," ",1289],["T_VARIABLE","$this",1289],["T_OBJECT_OPERATOR","->",1289],["T_STRING","wm_hor_offset",1289],["T_WHITESPACE"," ",1289],"*",["T_WHITESPACE"," ",1289],"-",["T_LNUMBER","1",1289],";",["T_WHITESPACE","\n\t\t",1289],"}",["T_WHITESPACE","\n\n\t\t",1290],["T_COMMENT","\/\/ Set font width and height\n",1292],["T_WHITESPACE","\t\t",1293],["T_COMMENT","\/\/ These are calculated differently depending on\n",1293],["T_WHITESPACE","\t\t",1294],["T_COMMENT","\/\/ whether we are using the true type font or not\n",1294],["T_WHITESPACE","\t\t",1295],["T_IF","if",1295],["T_WHITESPACE"," ",1295],"(",["T_VARIABLE","$this",1295],["T_OBJECT_OPERATOR","->",1295],["T_STRING","wm_use_truetype",1295],["T_WHITESPACE"," ",1295],["T_IS_IDENTICAL","===",1295],["T_WHITESPACE"," ",1295],["T_STRING","TRUE",1295],")",["T_WHITESPACE","\n\t\t",1295],"{",["T_WHITESPACE","\n\t\t\t",1296],["T_IF","if",1297],["T_WHITESPACE"," ",1297],"(",["T_EMPTY","empty",1297],"(",["T_VARIABLE","$this",1297],["T_OBJECT_OPERATOR","->",1297],["T_STRING","wm_font_size",1297],")",")",["T_WHITESPACE","\n\t\t\t",1297],"{",["T_WHITESPACE","\n\t\t\t\t",1298],["T_VARIABLE","$this",1299],["T_OBJECT_OPERATOR","->",1299],["T_STRING","wm_font_size",1299],["T_WHITESPACE"," ",1299],"=",["T_WHITESPACE"," ",1299],["T_LNUMBER","17",1299],";",["T_WHITESPACE","\n\t\t\t",1299],"}",["T_WHITESPACE","\n\n\t\t\t",1300],["T_IF","if",1302],["T_WHITESPACE"," ",1302],"(",["T_STRING","function_exists",1302],"(",["T_CONSTANT_ENCAPSED_STRING","'imagettfbbox'",1302],")",")",["T_WHITESPACE","\n\t\t\t",1302],"{",["T_WHITESPACE","\n\t\t\t\t",1303],["T_VARIABLE","$temp",1304],["T_WHITESPACE"," ",1304],"=",["T_WHITESPACE"," ",1304],["T_STRING","imagettfbbox",1304],"(",["T_VARIABLE","$this",1304],["T_OBJECT_OPERATOR","->",1304],["T_STRING","wm_font_size",1304],",",["T_WHITESPACE"," ",1304],["T_LNUMBER","0",1304],",",["T_WHITESPACE"," ",1304],["T_VARIABLE","$this",1304],["T_OBJECT_OPERATOR","->",1304],["T_STRING","wm_font_path",1304],",",["T_WHITESPACE"," ",1304],["T_VARIABLE","$this",1304],["T_OBJECT_OPERATOR","->",1304],["T_STRING","wm_text",1304],")",";",["T_WHITESPACE","\n\t\t\t\t",1304],["T_VARIABLE","$temp",1305],["T_WHITESPACE"," ",1305],"=",["T_WHITESPACE"," ",1305],["T_VARIABLE","$temp",1305],"[",["T_LNUMBER","2",1305],"]",["T_WHITESPACE"," ",1305],"-",["T_WHITESPACE"," ",1305],["T_VARIABLE","$temp",1305],"[",["T_LNUMBER","0",1305],"]",";",["T_WHITESPACE","\n\n\t\t\t\t",1305],["T_VARIABLE","$fontwidth",1307],["T_WHITESPACE"," ",1307],"=",["T_WHITESPACE"," ",1307],["T_VARIABLE","$temp",1307],["T_WHITESPACE"," ",1307],"\/",["T_WHITESPACE"," ",1307],["T_STRING","strlen",1307],"(",["T_VARIABLE","$this",1307],["T_OBJECT_OPERATOR","->",1307],["T_STRING","wm_text",1307],")",";",["T_WHITESPACE","\n\t\t\t",1307],"}",["T_WHITESPACE","\n\t\t\t",1308],["T_ELSE","else",1309],["T_WHITESPACE","\n\t\t\t",1309],"{",["T_WHITESPACE","\n\t\t\t\t",1310],["T_VARIABLE","$fontwidth",1311],["T_WHITESPACE"," ",1311],"=",["T_WHITESPACE"," ",1311],["T_VARIABLE","$this",1311],["T_OBJECT_OPERATOR","->",1311],["T_STRING","wm_font_size",1311],["T_WHITESPACE"," ",1311],"-",["T_WHITESPACE"," ",1311],"(",["T_VARIABLE","$this",1311],["T_OBJECT_OPERATOR","->",1311],["T_STRING","wm_font_size",1311],["T_WHITESPACE"," ",1311],"\/",["T_WHITESPACE"," ",1311],["T_LNUMBER","4",1311],")",";",["T_WHITESPACE","\n\t\t\t",1311],"}",["T_WHITESPACE","\n\n\t\t\t",1312],["T_VARIABLE","$fontheight",1314],["T_WHITESPACE"," ",1314],"=",["T_WHITESPACE"," ",1314],["T_VARIABLE","$this",1314],["T_OBJECT_OPERATOR","->",1314],["T_STRING","wm_font_size",1314],";",["T_WHITESPACE","\n\t\t\t",1314],["T_VARIABLE","$this",1315],["T_OBJECT_OPERATOR","->",1315],["T_STRING","wm_vrt_offset",1315],["T_WHITESPACE"," ",1315],["T_PLUS_EQUAL","+=",1315],["T_WHITESPACE"," ",1315],["T_VARIABLE","$this",1315],["T_OBJECT_OPERATOR","->",1315],["T_STRING","wm_font_size",1315],";",["T_WHITESPACE","\n\t\t",1315],"}",["T_WHITESPACE","\n\t\t",1316],["T_ELSE","else",1317],["T_WHITESPACE","\n\t\t",1317],"{",["T_WHITESPACE","\n\t\t\t",1318],["T_VARIABLE","$fontwidth",1319],["T_WHITESPACE","  ",1319],"=",["T_WHITESPACE"," ",1319],["T_STRING","imagefontwidth",1319],"(",["T_VARIABLE","$this",1319],["T_OBJECT_OPERATOR","->",1319],["T_STRING","wm_font_size",1319],")",";",["T_WHITESPACE","\n\t\t\t",1319],["T_VARIABLE","$fontheight",1320],["T_WHITESPACE"," ",1320],"=",["T_WHITESPACE"," ",1320],["T_STRING","imagefontheight",1320],"(",["T_VARIABLE","$this",1320],["T_OBJECT_OPERATOR","->",1320],["T_STRING","wm_font_size",1320],")",";",["T_WHITESPACE","\n\t\t",1320],"}",["T_WHITESPACE","\n\n\t\t",1321],["T_COMMENT","\/\/ Set base X and Y axis values\n",1323],["T_WHITESPACE","\t\t",1324],["T_VARIABLE","$x_axis",1324],["T_WHITESPACE"," ",1324],"=",["T_WHITESPACE"," ",1324],["T_VARIABLE","$this",1324],["T_OBJECT_OPERATOR","->",1324],["T_STRING","wm_hor_offset",1324],["T_WHITESPACE"," ",1324],"+",["T_WHITESPACE"," ",1324],["T_VARIABLE","$this",1324],["T_OBJECT_OPERATOR","->",1324],["T_STRING","wm_padding",1324],";",["T_WHITESPACE","\n\t\t",1324],["T_VARIABLE","$y_axis",1325],["T_WHITESPACE"," ",1325],"=",["T_WHITESPACE"," ",1325],["T_VARIABLE","$this",1325],["T_OBJECT_OPERATOR","->",1325],["T_STRING","wm_vrt_offset",1325],["T_WHITESPACE"," ",1325],"+",["T_WHITESPACE"," ",1325],["T_VARIABLE","$this",1325],["T_OBJECT_OPERATOR","->",1325],["T_STRING","wm_padding",1325],";",["T_WHITESPACE","\n\n\t\t",1325],["T_IF","if",1327],["T_WHITESPACE"," ",1327],"(",["T_VARIABLE","$this",1327],["T_OBJECT_OPERATOR","->",1327],["T_STRING","wm_use_drop_shadow",1327],["T_WHITESPACE"," ",1327],["T_IS_IDENTICAL","===",1327],["T_WHITESPACE"," ",1327],["T_STRING","FALSE",1327],")",["T_WHITESPACE","\n\t\t",1327],"{",["T_WHITESPACE","\n\t\t\t",1328],["T_VARIABLE","$this",1329],["T_OBJECT_OPERATOR","->",1329],["T_STRING","wm_shadow_distance",1329],["T_WHITESPACE"," ",1329],"=",["T_WHITESPACE"," ",1329],["T_LNUMBER","0",1329],";",["T_WHITESPACE","\n\t\t",1329],"}",["T_WHITESPACE","\n\n\t\t",1330],["T_VARIABLE","$this",1332],["T_OBJECT_OPERATOR","->",1332],["T_STRING","wm_vrt_alignment",1332],["T_WHITESPACE"," ",1332],"=",["T_WHITESPACE"," ",1332],["T_STRING","strtoupper",1332],"(",["T_VARIABLE","$this",1332],["T_OBJECT_OPERATOR","->",1332],["T_STRING","wm_vrt_alignment",1332],"[",["T_LNUMBER","0",1332],"]",")",";",["T_WHITESPACE","\n\t\t",1332],["T_VARIABLE","$this",1333],["T_OBJECT_OPERATOR","->",1333],["T_STRING","wm_hor_alignment",1333],["T_WHITESPACE"," ",1333],"=",["T_WHITESPACE"," ",1333],["T_STRING","strtoupper",1333],"(",["T_VARIABLE","$this",1333],["T_OBJECT_OPERATOR","->",1333],["T_STRING","wm_hor_alignment",1333],"[",["T_LNUMBER","0",1333],"]",")",";",["T_WHITESPACE","\n\n\t\t",1333],["T_COMMENT","\/\/ Set vertical alignment\n",1335],["T_WHITESPACE","\t\t",1336],["T_IF","if",1336],["T_WHITESPACE"," ",1336],"(",["T_VARIABLE","$this",1336],["T_OBJECT_OPERATOR","->",1336],["T_STRING","wm_vrt_alignment",1336],["T_WHITESPACE"," ",1336],["T_IS_IDENTICAL","===",1336],["T_WHITESPACE"," ",1336],["T_CONSTANT_ENCAPSED_STRING","'M'",1336],")",["T_WHITESPACE","\n\t\t",1336],"{",["T_WHITESPACE","\n\t\t\t",1337],["T_VARIABLE","$y_axis",1338],["T_WHITESPACE"," ",1338],["T_PLUS_EQUAL","+=",1338],["T_WHITESPACE"," ",1338],"(",["T_VARIABLE","$this",1338],["T_OBJECT_OPERATOR","->",1338],["T_STRING","orig_height",1338],["T_WHITESPACE"," ",1338],"\/",["T_WHITESPACE"," ",1338],["T_LNUMBER","2",1338],")",["T_WHITESPACE"," ",1338],"+",["T_WHITESPACE"," ",1338],"(",["T_VARIABLE","$fontheight",1338],["T_WHITESPACE"," ",1338],"\/",["T_WHITESPACE"," ",1338],["T_LNUMBER","2",1338],")",";",["T_WHITESPACE","\n\t\t",1338],"}",["T_WHITESPACE","\n\t\t",1339],["T_ELSEIF","elseif",1340],["T_WHITESPACE"," ",1340],"(",["T_VARIABLE","$this",1340],["T_OBJECT_OPERATOR","->",1340],["T_STRING","wm_vrt_alignment",1340],["T_WHITESPACE"," ",1340],["T_IS_IDENTICAL","===",1340],["T_WHITESPACE"," ",1340],["T_CONSTANT_ENCAPSED_STRING","'B'",1340],")",["T_WHITESPACE","\n\t\t",1340],"{",["T_WHITESPACE","\n\t\t\t",1341],["T_VARIABLE","$y_axis",1342],["T_WHITESPACE"," ",1342],["T_PLUS_EQUAL","+=",1342],["T_WHITESPACE"," ",1342],["T_VARIABLE","$this",1342],["T_OBJECT_OPERATOR","->",1342],["T_STRING","orig_height",1342],["T_WHITESPACE"," ",1342],"-",["T_WHITESPACE"," ",1342],["T_VARIABLE","$fontheight",1342],["T_WHITESPACE"," ",1342],"-",["T_WHITESPACE"," ",1342],["T_VARIABLE","$this",1342],["T_OBJECT_OPERATOR","->",1342],["T_STRING","wm_shadow_distance",1342],["T_WHITESPACE"," ",1342],"-",["T_WHITESPACE"," ",1342],"(",["T_VARIABLE","$fontheight",1342],["T_WHITESPACE"," ",1342],"\/",["T_WHITESPACE"," ",1342],["T_LNUMBER","2",1342],")",";",["T_WHITESPACE","\n\t\t",1342],"}",["T_WHITESPACE","\n\n\t\t",1343],["T_COMMENT","\/\/ Set horizontal alignment\n",1345],["T_WHITESPACE","\t\t",1346],["T_IF","if",1346],["T_WHITESPACE"," ",1346],"(",["T_VARIABLE","$this",1346],["T_OBJECT_OPERATOR","->",1346],["T_STRING","wm_hor_alignment",1346],["T_WHITESPACE"," ",1346],["T_IS_IDENTICAL","===",1346],["T_WHITESPACE"," ",1346],["T_CONSTANT_ENCAPSED_STRING","'R'",1346],")",["T_WHITESPACE","\n\t\t",1346],"{",["T_WHITESPACE","\n\t\t\t",1347],["T_VARIABLE","$x_axis",1348],["T_WHITESPACE"," ",1348],["T_PLUS_EQUAL","+=",1348],["T_WHITESPACE"," ",1348],["T_VARIABLE","$this",1348],["T_OBJECT_OPERATOR","->",1348],["T_STRING","orig_width",1348],["T_WHITESPACE"," ",1348],"-",["T_WHITESPACE"," ",1348],"(",["T_VARIABLE","$fontwidth",1348],["T_WHITESPACE"," ",1348],"*",["T_WHITESPACE"," ",1348],["T_STRING","strlen",1348],"(",["T_VARIABLE","$this",1348],["T_OBJECT_OPERATOR","->",1348],["T_STRING","wm_text",1348],")",")",["T_WHITESPACE"," ",1348],"-",["T_WHITESPACE"," ",1348],["T_VARIABLE","$this",1348],["T_OBJECT_OPERATOR","->",1348],["T_STRING","wm_shadow_distance",1348],";",["T_WHITESPACE","\n\t\t",1348],"}",["T_WHITESPACE","\n\t\t",1349],["T_ELSEIF","elseif",1350],["T_WHITESPACE"," ",1350],"(",["T_VARIABLE","$this",1350],["T_OBJECT_OPERATOR","->",1350],["T_STRING","wm_hor_alignment",1350],["T_WHITESPACE"," ",1350],["T_IS_IDENTICAL","===",1350],["T_WHITESPACE"," ",1350],["T_CONSTANT_ENCAPSED_STRING","'C'",1350],")",["T_WHITESPACE","\n\t\t",1350],"{",["T_WHITESPACE","\n\t\t\t",1351],["T_VARIABLE","$x_axis",1352],["T_WHITESPACE"," ",1352],["T_PLUS_EQUAL","+=",1352],["T_WHITESPACE"," ",1352],["T_STRING","floor",1352],"(","(",["T_VARIABLE","$this",1352],["T_OBJECT_OPERATOR","->",1352],["T_STRING","orig_width",1352],["T_WHITESPACE"," ",1352],"-",["T_WHITESPACE"," ",1352],"(",["T_VARIABLE","$fontwidth",1352],["T_WHITESPACE"," ",1352],"*",["T_WHITESPACE"," ",1352],["T_STRING","strlen",1352],"(",["T_VARIABLE","$this",1352],["T_OBJECT_OPERATOR","->",1352],["T_STRING","wm_text",1352],")",")",")",["T_WHITESPACE"," ",1352],"\/",["T_WHITESPACE"," ",1352],["T_LNUMBER","2",1352],")",";",["T_WHITESPACE","\n\t\t",1352],"}",["T_WHITESPACE","\n\n\t\t",1353],["T_IF","if",1355],["T_WHITESPACE"," ",1355],"(",["T_VARIABLE","$this",1355],["T_OBJECT_OPERATOR","->",1355],["T_STRING","wm_use_drop_shadow",1355],")",["T_WHITESPACE","\n\t\t",1355],"{",["T_WHITESPACE","\n\t\t\t",1356],["T_COMMENT","\/\/ Offset from text\n",1357],["T_WHITESPACE","\t\t\t",1358],["T_VARIABLE","$x_shad",1358],["T_WHITESPACE"," ",1358],"=",["T_WHITESPACE"," ",1358],["T_VARIABLE","$x_axis",1358],["T_WHITESPACE"," ",1358],"+",["T_WHITESPACE"," ",1358],["T_VARIABLE","$this",1358],["T_OBJECT_OPERATOR","->",1358],["T_STRING","wm_shadow_distance",1358],";",["T_WHITESPACE","\n\t\t\t",1358],["T_VARIABLE","$y_shad",1359],["T_WHITESPACE"," ",1359],"=",["T_WHITESPACE"," ",1359],["T_VARIABLE","$y_axis",1359],["T_WHITESPACE"," ",1359],"+",["T_WHITESPACE"," ",1359],["T_VARIABLE","$this",1359],["T_OBJECT_OPERATOR","->",1359],["T_STRING","wm_shadow_distance",1359],";",["T_WHITESPACE","\n\n\t\t\t",1359],["T_COMMENT","\/* Set RGB values for shadow\n\t\t\t *\n\t\t\t * First character is #, so we don't really need it.\n\t\t\t * Get the rest of the string and split it into 2-length\n\t\t\t * hex values:\n\t\t\t *\/",1361],["T_WHITESPACE","\n\t\t\t",1366],["T_VARIABLE","$drp_color",1367],["T_WHITESPACE"," ",1367],"=",["T_WHITESPACE"," ",1367],["T_STRING","str_split",1367],"(",["T_STRING","substr",1367],"(",["T_VARIABLE","$this",1367],["T_OBJECT_OPERATOR","->",1367],["T_STRING","wm_shadow_color",1367],",",["T_WHITESPACE"," ",1367],["T_LNUMBER","1",1367],",",["T_WHITESPACE"," ",1367],["T_LNUMBER","6",1367],")",",",["T_WHITESPACE"," ",1367],["T_LNUMBER","2",1367],")",";",["T_WHITESPACE","\n\t\t\t",1367],["T_VARIABLE","$drp_color",1368],["T_WHITESPACE"," ",1368],"=",["T_WHITESPACE"," ",1368],["T_STRING","imagecolorclosest",1368],"(",["T_VARIABLE","$src_img",1368],",",["T_WHITESPACE"," ",1368],["T_STRING","hexdec",1368],"(",["T_VARIABLE","$drp_color",1368],"[",["T_LNUMBER","0",1368],"]",")",",",["T_WHITESPACE"," ",1368],["T_STRING","hexdec",1368],"(",["T_VARIABLE","$drp_color",1368],"[",["T_LNUMBER","1",1368],"]",")",",",["T_WHITESPACE"," ",1368],["T_STRING","hexdec",1368],"(",["T_VARIABLE","$drp_color",1368],"[",["T_LNUMBER","2",1368],"]",")",")",";",["T_WHITESPACE","\n\n\t\t\t",1368],["T_COMMENT","\/\/ Add the shadow to the source image\n",1370],["T_WHITESPACE","\t\t\t",1371],["T_IF","if",1371],["T_WHITESPACE"," ",1371],"(",["T_VARIABLE","$this",1371],["T_OBJECT_OPERATOR","->",1371],["T_STRING","wm_use_truetype",1371],")",["T_WHITESPACE","\n\t\t\t",1371],"{",["T_WHITESPACE","\n\t\t\t\t",1372],["T_STRING","imagettftext",1373],"(",["T_VARIABLE","$src_img",1373],",",["T_WHITESPACE"," ",1373],["T_VARIABLE","$this",1373],["T_OBJECT_OPERATOR","->",1373],["T_STRING","wm_font_size",1373],",",["T_WHITESPACE"," ",1373],["T_LNUMBER","0",1373],",",["T_WHITESPACE"," ",1373],["T_VARIABLE","$x_shad",1373],",",["T_WHITESPACE"," ",1373],["T_VARIABLE","$y_shad",1373],",",["T_WHITESPACE"," ",1373],["T_VARIABLE","$drp_color",1373],",",["T_WHITESPACE"," ",1373],["T_VARIABLE","$this",1373],["T_OBJECT_OPERATOR","->",1373],["T_STRING","wm_font_path",1373],",",["T_WHITESPACE"," ",1373],["T_VARIABLE","$this",1373],["T_OBJECT_OPERATOR","->",1373],["T_STRING","wm_text",1373],")",";",["T_WHITESPACE","\n\t\t\t",1373],"}",["T_WHITESPACE","\n\t\t\t",1374],["T_ELSE","else",1375],["T_WHITESPACE","\n\t\t\t",1375],"{",["T_WHITESPACE","\n\t\t\t\t",1376],["T_STRING","imagestring",1377],"(",["T_VARIABLE","$src_img",1377],",",["T_WHITESPACE"," ",1377],["T_VARIABLE","$this",1377],["T_OBJECT_OPERATOR","->",1377],["T_STRING","wm_font_size",1377],",",["T_WHITESPACE"," ",1377],["T_VARIABLE","$x_shad",1377],",",["T_WHITESPACE"," ",1377],["T_VARIABLE","$y_shad",1377],",",["T_WHITESPACE"," ",1377],["T_VARIABLE","$this",1377],["T_OBJECT_OPERATOR","->",1377],["T_STRING","wm_text",1377],",",["T_WHITESPACE"," ",1377],["T_VARIABLE","$drp_color",1377],")",";",["T_WHITESPACE","\n\t\t\t",1377],"}",["T_WHITESPACE","\n\t\t",1378],"}",["T_WHITESPACE","\n\n\t\t",1379],["T_COMMENT","\/* Set RGB values for text\n\t\t *\n\t\t * First character is #, so we don't really need it.\n\t\t * Get the rest of the string and split it into 2-length\n\t\t * hex values:\n\t\t *\/",1381],["T_WHITESPACE","\n\t\t",1386],["T_VARIABLE","$txt_color",1387],["T_WHITESPACE"," ",1387],"=",["T_WHITESPACE"," ",1387],["T_STRING","str_split",1387],"(",["T_STRING","substr",1387],"(",["T_VARIABLE","$this",1387],["T_OBJECT_OPERATOR","->",1387],["T_STRING","wm_font_color",1387],",",["T_WHITESPACE"," ",1387],["T_LNUMBER","1",1387],",",["T_WHITESPACE"," ",1387],["T_LNUMBER","6",1387],")",",",["T_WHITESPACE"," ",1387],["T_LNUMBER","2",1387],")",";",["T_WHITESPACE","\n\t\t",1387],["T_VARIABLE","$txt_color",1388],["T_WHITESPACE"," ",1388],"=",["T_WHITESPACE"," ",1388],["T_STRING","imagecolorclosest",1388],"(",["T_VARIABLE","$src_img",1388],",",["T_WHITESPACE"," ",1388],["T_STRING","hexdec",1388],"(",["T_VARIABLE","$txt_color",1388],"[",["T_LNUMBER","0",1388],"]",")",",",["T_WHITESPACE"," ",1388],["T_STRING","hexdec",1388],"(",["T_VARIABLE","$txt_color",1388],"[",["T_LNUMBER","1",1388],"]",")",",",["T_WHITESPACE"," ",1388],["T_STRING","hexdec",1388],"(",["T_VARIABLE","$txt_color",1388],"[",["T_LNUMBER","2",1388],"]",")",")",";",["T_WHITESPACE","\n\n\t\t",1388],["T_COMMENT","\/\/ Add the text to the source image\n",1390],["T_WHITESPACE","\t\t",1391],["T_IF","if",1391],["T_WHITESPACE"," ",1391],"(",["T_VARIABLE","$this",1391],["T_OBJECT_OPERATOR","->",1391],["T_STRING","wm_use_truetype",1391],")",["T_WHITESPACE","\n\t\t",1391],"{",["T_WHITESPACE","\n\t\t\t",1392],["T_STRING","imagettftext",1393],"(",["T_VARIABLE","$src_img",1393],",",["T_WHITESPACE"," ",1393],["T_VARIABLE","$this",1393],["T_OBJECT_OPERATOR","->",1393],["T_STRING","wm_font_size",1393],",",["T_WHITESPACE"," ",1393],["T_LNUMBER","0",1393],",",["T_WHITESPACE"," ",1393],["T_VARIABLE","$x_axis",1393],",",["T_WHITESPACE"," ",1393],["T_VARIABLE","$y_axis",1393],",",["T_WHITESPACE"," ",1393],["T_VARIABLE","$txt_color",1393],",",["T_WHITESPACE"," ",1393],["T_VARIABLE","$this",1393],["T_OBJECT_OPERATOR","->",1393],["T_STRING","wm_font_path",1393],",",["T_WHITESPACE"," ",1393],["T_VARIABLE","$this",1393],["T_OBJECT_OPERATOR","->",1393],["T_STRING","wm_text",1393],")",";",["T_WHITESPACE","\n\t\t",1393],"}",["T_WHITESPACE","\n\t\t",1394],["T_ELSE","else",1395],["T_WHITESPACE","\n\t\t",1395],"{",["T_WHITESPACE","\n\t\t\t",1396],["T_STRING","imagestring",1397],"(",["T_VARIABLE","$src_img",1397],",",["T_WHITESPACE"," ",1397],["T_VARIABLE","$this",1397],["T_OBJECT_OPERATOR","->",1397],["T_STRING","wm_font_size",1397],",",["T_WHITESPACE"," ",1397],["T_VARIABLE","$x_axis",1397],",",["T_WHITESPACE"," ",1397],["T_VARIABLE","$y_axis",1397],",",["T_WHITESPACE"," ",1397],["T_VARIABLE","$this",1397],["T_OBJECT_OPERATOR","->",1397],["T_STRING","wm_text",1397],",",["T_WHITESPACE"," ",1397],["T_VARIABLE","$txt_color",1397],")",";",["T_WHITESPACE","\n\t\t",1397],"}",["T_WHITESPACE","\n\n\t\t",1398],["T_COMMENT","\/\/ We can preserve transparency for PNG images\n",1400],["T_WHITESPACE","\t\t",1401],["T_IF","if",1401],["T_WHITESPACE"," ",1401],"(",["T_VARIABLE","$this",1401],["T_OBJECT_OPERATOR","->",1401],["T_STRING","image_type",1401],["T_WHITESPACE"," ",1401],["T_IS_IDENTICAL","===",1401],["T_WHITESPACE"," ",1401],["T_LNUMBER","3",1401],")",["T_WHITESPACE","\n\t\t",1401],"{",["T_WHITESPACE","\n\t\t\t",1402],["T_STRING","imagealphablending",1403],"(",["T_VARIABLE","$src_img",1403],",",["T_WHITESPACE"," ",1403],["T_STRING","FALSE",1403],")",";",["T_WHITESPACE","\n\t\t\t",1403],["T_STRING","imagesavealpha",1404],"(",["T_VARIABLE","$src_img",1404],",",["T_WHITESPACE"," ",1404],["T_STRING","TRUE",1404],")",";",["T_WHITESPACE","\n\t\t",1404],"}",["T_WHITESPACE","\n\n\t\t",1405],["T_COMMENT","\/\/ Output the final image\n",1407],["T_WHITESPACE","\t\t",1408],["T_IF","if",1408],["T_WHITESPACE"," ",1408],"(",["T_VARIABLE","$this",1408],["T_OBJECT_OPERATOR","->",1408],["T_STRING","dynamic_output",1408],["T_WHITESPACE"," ",1408],["T_IS_IDENTICAL","===",1408],["T_WHITESPACE"," ",1408],["T_STRING","TRUE",1408],")",["T_WHITESPACE","\n\t\t",1408],"{",["T_WHITESPACE","\n\t\t\t",1409],["T_VARIABLE","$this",1410],["T_OBJECT_OPERATOR","->",1410],["T_STRING","image_display_gd",1410],"(",["T_VARIABLE","$src_img",1410],")",";",["T_WHITESPACE","\n\t\t",1410],"}",["T_WHITESPACE","\n\t\t",1411],["T_ELSE","else",1412],["T_WHITESPACE","\n\t\t",1412],"{",["T_WHITESPACE","\n\t\t\t",1413],["T_VARIABLE","$this",1414],["T_OBJECT_OPERATOR","->",1414],["T_STRING","image_save_gd",1414],"(",["T_VARIABLE","$src_img",1414],")",";",["T_WHITESPACE","\n\t\t",1414],"}",["T_WHITESPACE","\n\n\t\t",1415],["T_STRING","imagedestroy",1417],"(",["T_VARIABLE","$src_img",1417],")",";",["T_WHITESPACE","\n\n\t\t",1417],["T_RETURN","return",1419],["T_WHITESPACE"," ",1419],["T_STRING","TRUE",1419],";",["T_WHITESPACE","\n\t",1419],"}",["T_WHITESPACE","\n\n\t",1420],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",1422],["T_WHITESPACE","\n\t",1423],["T_DOC_COMMENT","\/**\n\t * Create Image - GD\n\t *\n\t * This simply creates an image resource handle\n\t * based on the type of image being processed\n\t *\n\t * @param\tstring\n\t * @param\tstring\n\t * @return\tresource\n\t *\/",1424],["T_WHITESPACE","\n\t",1433],["T_PUBLIC","public",1434],["T_WHITESPACE"," ",1434],["T_FUNCTION","function",1434],["T_WHITESPACE"," ",1434],["T_STRING","image_create_gd",1434],"(",["T_VARIABLE","$path",1434],["T_WHITESPACE"," ",1434],"=",["T_WHITESPACE"," ",1434],["T_CONSTANT_ENCAPSED_STRING","''",1434],",",["T_WHITESPACE"," ",1434],["T_VARIABLE","$image_type",1434],["T_WHITESPACE"," ",1434],"=",["T_WHITESPACE"," ",1434],["T_CONSTANT_ENCAPSED_STRING","''",1434],")",["T_WHITESPACE","\n\t",1434],"{",["T_WHITESPACE","\n\t\t",1435],["T_IF","if",1436],["T_WHITESPACE"," ",1436],"(",["T_VARIABLE","$path",1436],["T_WHITESPACE"," ",1436],["T_IS_IDENTICAL","===",1436],["T_WHITESPACE"," ",1436],["T_CONSTANT_ENCAPSED_STRING","''",1436],")",["T_WHITESPACE","\n\t\t",1436],"{",["T_WHITESPACE","\n\t\t\t",1437],["T_VARIABLE","$path",1438],["T_WHITESPACE"," ",1438],"=",["T_WHITESPACE"," ",1438],["T_VARIABLE","$this",1438],["T_OBJECT_OPERATOR","->",1438],["T_STRING","full_src_path",1438],";",["T_WHITESPACE","\n\t\t",1438],"}",["T_WHITESPACE","\n\n\t\t",1439],["T_IF","if",1441],["T_WHITESPACE"," ",1441],"(",["T_VARIABLE","$image_type",1441],["T_WHITESPACE"," ",1441],["T_IS_IDENTICAL","===",1441],["T_WHITESPACE"," ",1441],["T_CONSTANT_ENCAPSED_STRING","''",1441],")",["T_WHITESPACE","\n\t\t",1441],"{",["T_WHITESPACE","\n\t\t\t",1442],["T_VARIABLE","$image_type",1443],["T_WHITESPACE"," ",1443],"=",["T_WHITESPACE"," ",1443],["T_VARIABLE","$this",1443],["T_OBJECT_OPERATOR","->",1443],["T_STRING","image_type",1443],";",["T_WHITESPACE","\n\t\t",1443],"}",["T_WHITESPACE","\n\n\t\t",1444],["T_SWITCH","switch",1446],["T_WHITESPACE"," ",1446],"(",["T_VARIABLE","$image_type",1446],")",["T_WHITESPACE","\n\t\t",1446],"{",["T_WHITESPACE","\n\t\t\t",1447],["T_CASE","case",1448],["T_WHITESPACE"," ",1448],["T_LNUMBER","1",1448],":",["T_WHITESPACE","\n\t\t\t\t",1448],["T_IF","if",1449],["T_WHITESPACE"," ",1449],"(",["T_WHITESPACE"," ",1449],"!",["T_WHITESPACE"," ",1449],["T_STRING","function_exists",1449],"(",["T_CONSTANT_ENCAPSED_STRING","'imagecreatefromgif'",1449],")",")",["T_WHITESPACE","\n\t\t\t\t",1449],"{",["T_WHITESPACE","\n\t\t\t\t\t",1450],["T_VARIABLE","$this",1451],["T_OBJECT_OPERATOR","->",1451],["T_STRING","set_error",1451],"(",["T_ARRAY","array",1451],"(",["T_CONSTANT_ENCAPSED_STRING","'imglib_unsupported_imagecreate'",1451],",",["T_WHITESPACE"," ",1451],["T_CONSTANT_ENCAPSED_STRING","'imglib_gif_not_supported'",1451],")",")",";",["T_WHITESPACE","\n\t\t\t\t\t",1451],["T_RETURN","return",1452],["T_WHITESPACE"," ",1452],["T_STRING","FALSE",1452],";",["T_WHITESPACE","\n\t\t\t\t",1452],"}",["T_WHITESPACE","\n\n\t\t\t\t",1453],["T_RETURN","return",1455],["T_WHITESPACE"," ",1455],["T_STRING","imagecreatefromgif",1455],"(",["T_VARIABLE","$path",1455],")",";",["T_WHITESPACE","\n\t\t\t",1455],["T_CASE","case",1456],["T_WHITESPACE"," ",1456],["T_LNUMBER","2",1456],":",["T_WHITESPACE","\n\t\t\t\t",1456],["T_IF","if",1457],["T_WHITESPACE"," ",1457],"(",["T_WHITESPACE"," ",1457],"!",["T_WHITESPACE"," ",1457],["T_STRING","function_exists",1457],"(",["T_CONSTANT_ENCAPSED_STRING","'imagecreatefromjpeg'",1457],")",")",["T_WHITESPACE","\n\t\t\t\t",1457],"{",["T_WHITESPACE","\n\t\t\t\t\t",1458],["T_VARIABLE","$this",1459],["T_OBJECT_OPERATOR","->",1459],["T_STRING","set_error",1459],"(",["T_ARRAY","array",1459],"(",["T_CONSTANT_ENCAPSED_STRING","'imglib_unsupported_imagecreate'",1459],",",["T_WHITESPACE"," ",1459],["T_CONSTANT_ENCAPSED_STRING","'imglib_jpg_not_supported'",1459],")",")",";",["T_WHITESPACE","\n\t\t\t\t\t",1459],["T_RETURN","return",1460],["T_WHITESPACE"," ",1460],["T_STRING","FALSE",1460],";",["T_WHITESPACE","\n\t\t\t\t",1460],"}",["T_WHITESPACE","\n\n\t\t\t\t",1461],["T_RETURN","return",1463],["T_WHITESPACE"," ",1463],["T_STRING","imagecreatefromjpeg",1463],"(",["T_VARIABLE","$path",1463],")",";",["T_WHITESPACE","\n\t\t\t",1463],["T_CASE","case",1464],["T_WHITESPACE"," ",1464],["T_LNUMBER","3",1464],":",["T_WHITESPACE","\n\t\t\t\t",1464],["T_IF","if",1465],["T_WHITESPACE"," ",1465],"(",["T_WHITESPACE"," ",1465],"!",["T_WHITESPACE"," ",1465],["T_STRING","function_exists",1465],"(",["T_CONSTANT_ENCAPSED_STRING","'imagecreatefrompng'",1465],")",")",["T_WHITESPACE","\n\t\t\t\t",1465],"{",["T_WHITESPACE","\n\t\t\t\t\t",1466],["T_VARIABLE","$this",1467],["T_OBJECT_OPERATOR","->",1467],["T_STRING","set_error",1467],"(",["T_ARRAY","array",1467],"(",["T_CONSTANT_ENCAPSED_STRING","'imglib_unsupported_imagecreate'",1467],",",["T_WHITESPACE"," ",1467],["T_CONSTANT_ENCAPSED_STRING","'imglib_png_not_supported'",1467],")",")",";",["T_WHITESPACE","\n\t\t\t\t\t",1467],["T_RETURN","return",1468],["T_WHITESPACE"," ",1468],["T_STRING","FALSE",1468],";",["T_WHITESPACE","\n\t\t\t\t",1468],"}",["T_WHITESPACE","\n\n\t\t\t\t",1469],["T_RETURN","return",1471],["T_WHITESPACE"," ",1471],["T_STRING","imagecreatefrompng",1471],"(",["T_VARIABLE","$path",1471],")",";",["T_WHITESPACE","\n\t\t\t",1471],["T_DEFAULT","default",1472],":",["T_WHITESPACE","\n\t\t\t\t",1472],["T_VARIABLE","$this",1473],["T_OBJECT_OPERATOR","->",1473],["T_STRING","set_error",1473],"(",["T_ARRAY","array",1473],"(",["T_CONSTANT_ENCAPSED_STRING","'imglib_unsupported_imagecreate'",1473],")",")",";",["T_WHITESPACE","\n\t\t\t\t",1473],["T_RETURN","return",1474],["T_WHITESPACE"," ",1474],["T_STRING","FALSE",1474],";",["T_WHITESPACE","\n\t\t",1474],"}",["T_WHITESPACE","\n\t",1475],"}",["T_WHITESPACE","\n\n\t",1476],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",1478],["T_WHITESPACE","\n\t",1479],["T_DOC_COMMENT","\/**\n\t * Write image file to disk - GD\n\t *\n\t * Takes an image resource as input and writes the file\n\t * to the specified destination\n\t *\n\t * @param\tresource\n\t * @return\tbool\n\t *\/",1480],["T_WHITESPACE","\n\t",1488],["T_PUBLIC","public",1489],["T_WHITESPACE"," ",1489],["T_FUNCTION","function",1489],["T_WHITESPACE"," ",1489],["T_STRING","image_save_gd",1489],"(",["T_VARIABLE","$resource",1489],")",["T_WHITESPACE","\n\t",1489],"{",["T_WHITESPACE","\n\t\t",1490],["T_SWITCH","switch",1491],["T_WHITESPACE"," ",1491],"(",["T_VARIABLE","$this",1491],["T_OBJECT_OPERATOR","->",1491],["T_STRING","image_type",1491],")",["T_WHITESPACE","\n\t\t",1491],"{",["T_WHITESPACE","\n\t\t\t",1492],["T_CASE","case",1493],["T_WHITESPACE"," ",1493],["T_LNUMBER","1",1493],":",["T_WHITESPACE","\n\t\t\t\t",1493],["T_IF","if",1494],["T_WHITESPACE"," ",1494],"(",["T_WHITESPACE"," ",1494],"!",["T_WHITESPACE"," ",1494],["T_STRING","function_exists",1494],"(",["T_CONSTANT_ENCAPSED_STRING","'imagegif'",1494],")",")",["T_WHITESPACE","\n\t\t\t\t",1494],"{",["T_WHITESPACE","\n\t\t\t\t\t",1495],["T_VARIABLE","$this",1496],["T_OBJECT_OPERATOR","->",1496],["T_STRING","set_error",1496],"(",["T_ARRAY","array",1496],"(",["T_CONSTANT_ENCAPSED_STRING","'imglib_unsupported_imagecreate'",1496],",",["T_WHITESPACE"," ",1496],["T_CONSTANT_ENCAPSED_STRING","'imglib_gif_not_supported'",1496],")",")",";",["T_WHITESPACE","\n\t\t\t\t\t",1496],["T_RETURN","return",1497],["T_WHITESPACE"," ",1497],["T_STRING","FALSE",1497],";",["T_WHITESPACE","\n\t\t\t\t",1497],"}",["T_WHITESPACE","\n\n\t\t\t\t",1498],["T_IF","if",1500],["T_WHITESPACE"," ",1500],"(",["T_WHITESPACE"," ",1500],"!",["T_WHITESPACE"," ",1500],"@",["T_STRING","imagegif",1500],"(",["T_VARIABLE","$resource",1500],",",["T_WHITESPACE"," ",1500],["T_VARIABLE","$this",1500],["T_OBJECT_OPERATOR","->",1500],["T_STRING","full_dst_path",1500],")",")",["T_WHITESPACE","\n\t\t\t\t",1500],"{",["T_WHITESPACE","\n\t\t\t\t\t",1501],["T_VARIABLE","$this",1502],["T_OBJECT_OPERATOR","->",1502],["T_STRING","set_error",1502],"(",["T_CONSTANT_ENCAPSED_STRING","'imglib_save_failed'",1502],")",";",["T_WHITESPACE","\n\t\t\t\t\t",1502],["T_RETURN","return",1503],["T_WHITESPACE"," ",1503],["T_STRING","FALSE",1503],";",["T_WHITESPACE","\n\t\t\t\t",1503],"}",["T_WHITESPACE","\n\t\t\t",1504],["T_BREAK","break",1505],";",["T_WHITESPACE","\n\t\t\t",1505],["T_CASE","case",1506],["T_WHITESPACE"," ",1506],["T_LNUMBER","2",1506],":",["T_WHITESPACE","\n\t\t\t\t",1506],["T_IF","if",1507],["T_WHITESPACE"," ",1507],"(",["T_WHITESPACE"," ",1507],"!",["T_WHITESPACE"," ",1507],["T_STRING","function_exists",1507],"(",["T_CONSTANT_ENCAPSED_STRING","'imagejpeg'",1507],")",")",["T_WHITESPACE","\n\t\t\t\t",1507],"{",["T_WHITESPACE","\n\t\t\t\t\t",1508],["T_VARIABLE","$this",1509],["T_OBJECT_OPERATOR","->",1509],["T_STRING","set_error",1509],"(",["T_ARRAY","array",1509],"(",["T_CONSTANT_ENCAPSED_STRING","'imglib_unsupported_imagecreate'",1509],",",["T_WHITESPACE"," ",1509],["T_CONSTANT_ENCAPSED_STRING","'imglib_jpg_not_supported'",1509],")",")",";",["T_WHITESPACE","\n\t\t\t\t\t",1509],["T_RETURN","return",1510],["T_WHITESPACE"," ",1510],["T_STRING","FALSE",1510],";",["T_WHITESPACE","\n\t\t\t\t",1510],"}",["T_WHITESPACE","\n\n\t\t\t\t",1511],["T_IF","if",1513],["T_WHITESPACE"," ",1513],"(",["T_WHITESPACE"," ",1513],"!",["T_WHITESPACE"," ",1513],"@",["T_STRING","imagejpeg",1513],"(",["T_VARIABLE","$resource",1513],",",["T_WHITESPACE"," ",1513],["T_VARIABLE","$this",1513],["T_OBJECT_OPERATOR","->",1513],["T_STRING","full_dst_path",1513],",",["T_WHITESPACE"," ",1513],["T_VARIABLE","$this",1513],["T_OBJECT_OPERATOR","->",1513],["T_STRING","quality",1513],")",")",["T_WHITESPACE","\n\t\t\t\t",1513],"{",["T_WHITESPACE","\n\t\t\t\t\t",1514],["T_VARIABLE","$this",1515],["T_OBJECT_OPERATOR","->",1515],["T_STRING","set_error",1515],"(",["T_CONSTANT_ENCAPSED_STRING","'imglib_save_failed'",1515],")",";",["T_WHITESPACE","\n\t\t\t\t\t",1515],["T_RETURN","return",1516],["T_WHITESPACE"," ",1516],["T_STRING","FALSE",1516],";",["T_WHITESPACE","\n\t\t\t\t",1516],"}",["T_WHITESPACE","\n\t\t\t",1517],["T_BREAK","break",1518],";",["T_WHITESPACE","\n\t\t\t",1518],["T_CASE","case",1519],["T_WHITESPACE"," ",1519],["T_LNUMBER","3",1519],":",["T_WHITESPACE","\n\t\t\t\t",1519],["T_IF","if",1520],["T_WHITESPACE"," ",1520],"(",["T_WHITESPACE"," ",1520],"!",["T_WHITESPACE"," ",1520],["T_STRING","function_exists",1520],"(",["T_CONSTANT_ENCAPSED_STRING","'imagepng'",1520],")",")",["T_WHITESPACE","\n\t\t\t\t",1520],"{",["T_WHITESPACE","\n\t\t\t\t\t",1521],["T_VARIABLE","$this",1522],["T_OBJECT_OPERATOR","->",1522],["T_STRING","set_error",1522],"(",["T_ARRAY","array",1522],"(",["T_CONSTANT_ENCAPSED_STRING","'imglib_unsupported_imagecreate'",1522],",",["T_WHITESPACE"," ",1522],["T_CONSTANT_ENCAPSED_STRING","'imglib_png_not_supported'",1522],")",")",";",["T_WHITESPACE","\n\t\t\t\t\t",1522],["T_RETURN","return",1523],["T_WHITESPACE"," ",1523],["T_STRING","FALSE",1523],";",["T_WHITESPACE","\n\t\t\t\t",1523],"}",["T_WHITESPACE","\n\n\t\t\t\t",1524],["T_IF","if",1526],["T_WHITESPACE"," ",1526],"(",["T_WHITESPACE"," ",1526],"!",["T_WHITESPACE"," ",1526],"@",["T_STRING","imagepng",1526],"(",["T_VARIABLE","$resource",1526],",",["T_WHITESPACE"," ",1526],["T_VARIABLE","$this",1526],["T_OBJECT_OPERATOR","->",1526],["T_STRING","full_dst_path",1526],")",")",["T_WHITESPACE","\n\t\t\t\t",1526],"{",["T_WHITESPACE","\n\t\t\t\t\t",1527],["T_VARIABLE","$this",1528],["T_OBJECT_OPERATOR","->",1528],["T_STRING","set_error",1528],"(",["T_CONSTANT_ENCAPSED_STRING","'imglib_save_failed'",1528],")",";",["T_WHITESPACE","\n\t\t\t\t\t",1528],["T_RETURN","return",1529],["T_WHITESPACE"," ",1529],["T_STRING","FALSE",1529],";",["T_WHITESPACE","\n\t\t\t\t",1529],"}",["T_WHITESPACE","\n\t\t\t",1530],["T_BREAK","break",1531],";",["T_WHITESPACE","\n\t\t\t",1531],["T_DEFAULT","default",1532],":",["T_WHITESPACE","\n\t\t\t\t",1532],["T_VARIABLE","$this",1533],["T_OBJECT_OPERATOR","->",1533],["T_STRING","set_error",1533],"(",["T_ARRAY","array",1533],"(",["T_CONSTANT_ENCAPSED_STRING","'imglib_unsupported_imagecreate'",1533],")",")",";",["T_WHITESPACE","\n\t\t\t\t",1533],["T_RETURN","return",1534],["T_WHITESPACE"," ",1534],["T_STRING","FALSE",1534],";",["T_WHITESPACE","\n\t\t\t",1534],["T_BREAK","break",1535],";",["T_WHITESPACE","\n\t\t",1535],"}",["T_WHITESPACE","\n\n\t\t",1536],["T_RETURN","return",1538],["T_WHITESPACE"," ",1538],["T_STRING","TRUE",1538],";",["T_WHITESPACE","\n\t",1538],"}",["T_WHITESPACE","\n\n\t",1539],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",1541],["T_WHITESPACE","\n\t",1542],["T_DOC_COMMENT","\/**\n\t * Dynamically outputs an image\n\t *\n\t * @param\tresource\n\t * @return\tvoid\n\t *\/",1543],["T_WHITESPACE","\n\t",1548],["T_PUBLIC","public",1549],["T_WHITESPACE"," ",1549],["T_FUNCTION","function",1549],["T_WHITESPACE"," ",1549],["T_STRING","image_display_gd",1549],"(",["T_VARIABLE","$resource",1549],")",["T_WHITESPACE","\n\t",1549],"{",["T_WHITESPACE","\n\t\t",1550],["T_STRING","header",1551],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Disposition: filename='",1551],".",["T_VARIABLE","$this",1551],["T_OBJECT_OPERATOR","->",1551],["T_STRING","source_image",1551],".",["T_CONSTANT_ENCAPSED_STRING","';'",1551],")",";",["T_WHITESPACE","\n\t\t",1551],["T_STRING","header",1552],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Type: '",1552],".",["T_VARIABLE","$this",1552],["T_OBJECT_OPERATOR","->",1552],["T_STRING","mime_type",1552],")",";",["T_WHITESPACE","\n\t\t",1552],["T_STRING","header",1553],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Transfer-Encoding: binary'",1553],")",";",["T_WHITESPACE","\n\t\t",1553],["T_STRING","header",1554],"(",["T_CONSTANT_ENCAPSED_STRING","'Last-Modified: '",1554],".",["T_STRING","gmdate",1554],"(",["T_CONSTANT_ENCAPSED_STRING","'D, d M Y H:i:s'",1554],",",["T_WHITESPACE"," ",1554],["T_STRING","time",1554],"(",")",")",".",["T_CONSTANT_ENCAPSED_STRING","' GMT'",1554],")",";",["T_WHITESPACE","\n\n\t\t",1554],["T_SWITCH","switch",1556],["T_WHITESPACE"," ",1556],"(",["T_VARIABLE","$this",1556],["T_OBJECT_OPERATOR","->",1556],["T_STRING","image_type",1556],")",["T_WHITESPACE","\n\t\t",1556],"{",["T_WHITESPACE","\n\t\t\t",1557],["T_CASE","case",1558],["T_WHITESPACE"," ",1558],["T_LNUMBER","1",1558],["T_WHITESPACE","\t",1558],":",["T_WHITESPACE","\t",1558],["T_STRING","imagegif",1558],"(",["T_VARIABLE","$resource",1558],")",";",["T_WHITESPACE","\n\t\t\t\t",1558],["T_BREAK","break",1559],";",["T_WHITESPACE","\n\t\t\t",1559],["T_CASE","case",1560],["T_WHITESPACE"," ",1560],["T_LNUMBER","2",1560],["T_WHITESPACE","\t",1560],":",["T_WHITESPACE","\t",1560],["T_STRING","imagejpeg",1560],"(",["T_VARIABLE","$resource",1560],",",["T_WHITESPACE"," ",1560],["T_STRING","NULL",1560],",",["T_WHITESPACE"," ",1560],["T_VARIABLE","$this",1560],["T_OBJECT_OPERATOR","->",1560],["T_STRING","quality",1560],")",";",["T_WHITESPACE","\n\t\t\t\t",1560],["T_BREAK","break",1561],";",["T_WHITESPACE","\n\t\t\t",1561],["T_CASE","case",1562],["T_WHITESPACE"," ",1562],["T_LNUMBER","3",1562],["T_WHITESPACE","\t",1562],":",["T_WHITESPACE","\t",1562],["T_STRING","imagepng",1562],"(",["T_VARIABLE","$resource",1562],")",";",["T_WHITESPACE","\n\t\t\t\t",1562],["T_BREAK","break",1563],";",["T_WHITESPACE","\n\t\t\t",1563],["T_DEFAULT","default",1564],":",["T_WHITESPACE","\t",1564],["T_ECHO","echo",1564],["T_WHITESPACE"," ",1564],["T_CONSTANT_ENCAPSED_STRING","'Unable to display the image'",1564],";",["T_WHITESPACE","\n\t\t\t\t",1564],["T_BREAK","break",1565],";",["T_WHITESPACE","\n\t\t",1565],"}",["T_WHITESPACE","\n\t",1566],"}",["T_WHITESPACE","\n\n\t",1567],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",1569],["T_WHITESPACE","\n\t",1570],["T_DOC_COMMENT","\/**\n\t * Re-proportion Image Width\/Height\n\t *\n\t * When creating thumbs, the desired width\/height\n\t * can end up warping the image due to an incorrect\n\t * ratio between the full-sized image and the thumb.\n\t *\n\t * This function lets us re-proportion the width\/height\n\t * if users choose to maintain the aspect ratio when resizing.\n\t *\n\t * @return\tvoid\n\t *\/",1571],["T_WHITESPACE","\n\t",1582],["T_PUBLIC","public",1583],["T_WHITESPACE"," ",1583],["T_FUNCTION","function",1583],["T_WHITESPACE"," ",1583],["T_STRING","image_reproportion",1583],"(",")",["T_WHITESPACE","\n\t",1583],"{",["T_WHITESPACE","\n\t\t",1584],["T_IF","if",1585],["T_WHITESPACE"," ",1585],"(","(",["T_VARIABLE","$this",1585],["T_OBJECT_OPERATOR","->",1585],["T_STRING","width",1585],["T_WHITESPACE"," ",1585],["T_IS_IDENTICAL","===",1585],["T_WHITESPACE"," ",1585],["T_LNUMBER","0",1585],["T_WHITESPACE"," ",1585],["T_BOOLEAN_AND","&&",1585],["T_WHITESPACE"," ",1585],["T_VARIABLE","$this",1585],["T_OBJECT_OPERATOR","->",1585],["T_STRING","height",1585],["T_WHITESPACE"," ",1585],["T_IS_IDENTICAL","===",1585],["T_WHITESPACE"," ",1585],["T_LNUMBER","0",1585],")",["T_WHITESPACE"," ",1585],["T_LOGICAL_OR","OR",1585],["T_WHITESPACE"," ",1585],["T_VARIABLE","$this",1585],["T_OBJECT_OPERATOR","->",1585],["T_STRING","orig_width",1585],["T_WHITESPACE"," ",1585],["T_IS_IDENTICAL","===",1585],["T_WHITESPACE"," ",1585],["T_LNUMBER","0",1585],["T_WHITESPACE"," ",1585],["T_LOGICAL_OR","OR",1585],["T_WHITESPACE"," ",1585],["T_VARIABLE","$this",1585],["T_OBJECT_OPERATOR","->",1585],["T_STRING","orig_height",1585],["T_WHITESPACE"," ",1585],["T_IS_IDENTICAL","===",1585],["T_WHITESPACE"," ",1585],["T_LNUMBER","0",1585],["T_WHITESPACE","\n\t\t\t",1585],["T_LOGICAL_OR","OR",1586],["T_WHITESPACE"," ",1586],"(",["T_WHITESPACE"," ",1586],"!",["T_WHITESPACE"," ",1586],["T_STRING","ctype_digit",1586],"(",["T_STRING_CAST","(string)",1586],["T_WHITESPACE"," ",1586],["T_VARIABLE","$this",1586],["T_OBJECT_OPERATOR","->",1586],["T_STRING","width",1586],")",["T_WHITESPACE"," ",1586],["T_BOOLEAN_AND","&&",1586],["T_WHITESPACE"," ",1586],"!",["T_WHITESPACE"," ",1586],["T_STRING","ctype_digit",1586],"(",["T_STRING_CAST","(string)",1586],["T_WHITESPACE"," ",1586],["T_VARIABLE","$this",1586],["T_OBJECT_OPERATOR","->",1586],["T_STRING","height",1586],")",")",["T_WHITESPACE","\n\t\t\t",1586],["T_LOGICAL_OR","OR",1587],["T_WHITESPACE"," ",1587],"!",["T_WHITESPACE"," ",1587],["T_STRING","ctype_digit",1587],"(",["T_STRING_CAST","(string)",1587],["T_WHITESPACE"," ",1587],["T_VARIABLE","$this",1587],["T_OBJECT_OPERATOR","->",1587],["T_STRING","orig_width",1587],")",["T_WHITESPACE"," ",1587],["T_LOGICAL_OR","OR",1587],["T_WHITESPACE"," ",1587],"!",["T_WHITESPACE"," ",1587],["T_STRING","ctype_digit",1587],"(",["T_STRING_CAST","(string)",1587],["T_WHITESPACE"," ",1587],["T_VARIABLE","$this",1587],["T_OBJECT_OPERATOR","->",1587],["T_STRING","orig_height",1587],")",")",["T_WHITESPACE","\n\t\t",1587],"{",["T_WHITESPACE","\n\t\t\t",1588],["T_RETURN","return",1589],";",["T_WHITESPACE","\n\t\t",1589],"}",["T_WHITESPACE","\n\n\t\t",1590],["T_COMMENT","\/\/ Sanitize\n",1592],["T_WHITESPACE","\t\t",1593],["T_VARIABLE","$this",1593],["T_OBJECT_OPERATOR","->",1593],["T_STRING","width",1593],["T_WHITESPACE"," ",1593],"=",["T_WHITESPACE"," ",1593],["T_INT_CAST","(int)",1593],["T_WHITESPACE"," ",1593],["T_VARIABLE","$this",1593],["T_OBJECT_OPERATOR","->",1593],["T_STRING","width",1593],";",["T_WHITESPACE","\n\t\t",1593],["T_VARIABLE","$this",1594],["T_OBJECT_OPERATOR","->",1594],["T_STRING","height",1594],["T_WHITESPACE"," ",1594],"=",["T_WHITESPACE"," ",1594],["T_INT_CAST","(int)",1594],["T_WHITESPACE"," ",1594],["T_VARIABLE","$this",1594],["T_OBJECT_OPERATOR","->",1594],["T_STRING","height",1594],";",["T_WHITESPACE","\n\n\t\t",1594],["T_IF","if",1596],["T_WHITESPACE"," ",1596],"(",["T_VARIABLE","$this",1596],["T_OBJECT_OPERATOR","->",1596],["T_STRING","master_dim",1596],["T_WHITESPACE"," ",1596],["T_IS_NOT_IDENTICAL","!==",1596],["T_WHITESPACE"," ",1596],["T_CONSTANT_ENCAPSED_STRING","'width'",1596],["T_WHITESPACE"," ",1596],["T_BOOLEAN_AND","&&",1596],["T_WHITESPACE"," ",1596],["T_VARIABLE","$this",1596],["T_OBJECT_OPERATOR","->",1596],["T_STRING","master_dim",1596],["T_WHITESPACE"," ",1596],["T_IS_NOT_IDENTICAL","!==",1596],["T_WHITESPACE"," ",1596],["T_CONSTANT_ENCAPSED_STRING","'height'",1596],")",["T_WHITESPACE","\n\t\t",1596],"{",["T_WHITESPACE","\n\t\t\t",1597],["T_IF","if",1598],["T_WHITESPACE"," ",1598],"(",["T_VARIABLE","$this",1598],["T_OBJECT_OPERATOR","->",1598],["T_STRING","width",1598],["T_WHITESPACE"," ",1598],">",["T_WHITESPACE"," ",1598],["T_LNUMBER","0",1598],["T_WHITESPACE"," ",1598],["T_BOOLEAN_AND","&&",1598],["T_WHITESPACE"," ",1598],["T_VARIABLE","$this",1598],["T_OBJECT_OPERATOR","->",1598],["T_STRING","height",1598],["T_WHITESPACE"," ",1598],">",["T_WHITESPACE"," ",1598],["T_LNUMBER","0",1598],")",["T_WHITESPACE","\n\t\t\t",1598],"{",["T_WHITESPACE","\n\t\t\t\t",1599],["T_VARIABLE","$this",1600],["T_OBJECT_OPERATOR","->",1600],["T_STRING","master_dim",1600],["T_WHITESPACE"," ",1600],"=",["T_WHITESPACE"," ",1600],"(","(","(",["T_VARIABLE","$this",1600],["T_OBJECT_OPERATOR","->",1600],["T_STRING","orig_height",1600],"\/",["T_VARIABLE","$this",1600],["T_OBJECT_OPERATOR","->",1600],["T_STRING","orig_width",1600],")",["T_WHITESPACE"," ",1600],"-",["T_WHITESPACE"," ",1600],"(",["T_VARIABLE","$this",1600],["T_OBJECT_OPERATOR","->",1600],["T_STRING","height",1600],"\/",["T_VARIABLE","$this",1600],["T_OBJECT_OPERATOR","->",1600],["T_STRING","width",1600],")",")",["T_WHITESPACE"," ",1600],"<",["T_WHITESPACE"," ",1600],["T_LNUMBER","0",1600],")",["T_WHITESPACE","\n\t\t\t\t\t\t\t",1600],"?",["T_WHITESPACE"," ",1601],["T_CONSTANT_ENCAPSED_STRING","'width'",1601],["T_WHITESPACE"," ",1601],":",["T_WHITESPACE"," ",1601],["T_CONSTANT_ENCAPSED_STRING","'height'",1601],";",["T_WHITESPACE","\n\t\t\t",1601],"}",["T_WHITESPACE","\n\t\t\t",1602],["T_ELSE","else",1603],["T_WHITESPACE","\n\t\t\t",1603],"{",["T_WHITESPACE","\n\t\t\t\t",1604],["T_VARIABLE","$this",1605],["T_OBJECT_OPERATOR","->",1605],["T_STRING","master_dim",1605],["T_WHITESPACE"," ",1605],"=",["T_WHITESPACE"," ",1605],"(",["T_VARIABLE","$this",1605],["T_OBJECT_OPERATOR","->",1605],["T_STRING","height",1605],["T_WHITESPACE"," ",1605],["T_IS_IDENTICAL","===",1605],["T_WHITESPACE"," ",1605],["T_LNUMBER","0",1605],")",["T_WHITESPACE"," ",1605],"?",["T_WHITESPACE"," ",1605],["T_CONSTANT_ENCAPSED_STRING","'width'",1605],["T_WHITESPACE"," ",1605],":",["T_WHITESPACE"," ",1605],["T_CONSTANT_ENCAPSED_STRING","'height'",1605],";",["T_WHITESPACE","\n\t\t\t",1605],"}",["T_WHITESPACE","\n\t\t",1606],"}",["T_WHITESPACE","\n\t\t",1607],["T_ELSEIF","elseif",1608],["T_WHITESPACE"," ",1608],"(","(",["T_VARIABLE","$this",1608],["T_OBJECT_OPERATOR","->",1608],["T_STRING","master_dim",1608],["T_WHITESPACE"," ",1608],["T_IS_IDENTICAL","===",1608],["T_WHITESPACE"," ",1608],["T_CONSTANT_ENCAPSED_STRING","'width'",1608],["T_WHITESPACE"," ",1608],["T_BOOLEAN_AND","&&",1608],["T_WHITESPACE"," ",1608],["T_VARIABLE","$this",1608],["T_OBJECT_OPERATOR","->",1608],["T_STRING","width",1608],["T_WHITESPACE"," ",1608],["T_IS_IDENTICAL","===",1608],["T_WHITESPACE"," ",1608],["T_LNUMBER","0",1608],")",["T_WHITESPACE","\n\t\t\t",1608],["T_LOGICAL_OR","OR",1609],["T_WHITESPACE"," ",1609],"(",["T_VARIABLE","$this",1609],["T_OBJECT_OPERATOR","->",1609],["T_STRING","master_dim",1609],["T_WHITESPACE"," ",1609],["T_IS_IDENTICAL","===",1609],["T_WHITESPACE"," ",1609],["T_CONSTANT_ENCAPSED_STRING","'height'",1609],["T_WHITESPACE"," ",1609],["T_BOOLEAN_AND","&&",1609],["T_WHITESPACE"," ",1609],["T_VARIABLE","$this",1609],["T_OBJECT_OPERATOR","->",1609],["T_STRING","height",1609],["T_WHITESPACE"," ",1609],["T_IS_IDENTICAL","===",1609],["T_WHITESPACE"," ",1609],["T_LNUMBER","0",1609],")",")",["T_WHITESPACE","\n\t\t",1609],"{",["T_WHITESPACE","\n\t\t\t",1610],["T_RETURN","return",1611],";",["T_WHITESPACE","\n\t\t",1611],"}",["T_WHITESPACE","\n\n\t\t",1612],["T_IF","if",1614],["T_WHITESPACE"," ",1614],"(",["T_VARIABLE","$this",1614],["T_OBJECT_OPERATOR","->",1614],["T_STRING","master_dim",1614],["T_WHITESPACE"," ",1614],["T_IS_IDENTICAL","===",1614],["T_WHITESPACE"," ",1614],["T_CONSTANT_ENCAPSED_STRING","'width'",1614],")",["T_WHITESPACE","\n\t\t",1614],"{",["T_WHITESPACE","\n\t\t\t",1615],["T_VARIABLE","$this",1616],["T_OBJECT_OPERATOR","->",1616],["T_STRING","height",1616],["T_WHITESPACE"," ",1616],"=",["T_WHITESPACE"," ",1616],["T_INT_CAST","(int)",1616],["T_WHITESPACE"," ",1616],["T_STRING","ceil",1616],"(",["T_VARIABLE","$this",1616],["T_OBJECT_OPERATOR","->",1616],["T_STRING","width",1616],"*",["T_VARIABLE","$this",1616],["T_OBJECT_OPERATOR","->",1616],["T_STRING","orig_height",1616],"\/",["T_VARIABLE","$this",1616],["T_OBJECT_OPERATOR","->",1616],["T_STRING","orig_width",1616],")",";",["T_WHITESPACE","\n\t\t",1616],"}",["T_WHITESPACE","\n\t\t",1617],["T_ELSE","else",1618],["T_WHITESPACE","\n\t\t",1618],"{",["T_WHITESPACE","\n\t\t\t",1619],["T_VARIABLE","$this",1620],["T_OBJECT_OPERATOR","->",1620],["T_STRING","width",1620],["T_WHITESPACE"," ",1620],"=",["T_WHITESPACE"," ",1620],["T_INT_CAST","(int)",1620],["T_WHITESPACE"," ",1620],["T_STRING","ceil",1620],"(",["T_VARIABLE","$this",1620],["T_OBJECT_OPERATOR","->",1620],["T_STRING","orig_width",1620],"*",["T_VARIABLE","$this",1620],["T_OBJECT_OPERATOR","->",1620],["T_STRING","height",1620],"\/",["T_VARIABLE","$this",1620],["T_OBJECT_OPERATOR","->",1620],["T_STRING","orig_height",1620],")",";",["T_WHITESPACE","\n\t\t",1620],"}",["T_WHITESPACE","\n\t",1621],"}",["T_WHITESPACE","\n\n\t",1622],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",1624],["T_WHITESPACE","\n\t",1625],["T_DOC_COMMENT","\/**\n\t * Get image properties\n\t *\n\t * A helper function that gets info about the file\n\t *\n\t * @param\tstring\n\t * @param\tbool\n\t * @return\tmixed\n\t *\/",1626],["T_WHITESPACE","\n\t",1634],["T_PUBLIC","public",1635],["T_WHITESPACE"," ",1635],["T_FUNCTION","function",1635],["T_WHITESPACE"," ",1635],["T_STRING","get_image_properties",1635],"(",["T_VARIABLE","$path",1635],["T_WHITESPACE"," ",1635],"=",["T_WHITESPACE"," ",1635],["T_CONSTANT_ENCAPSED_STRING","''",1635],",",["T_WHITESPACE"," ",1635],["T_VARIABLE","$return",1635],["T_WHITESPACE"," ",1635],"=",["T_WHITESPACE"," ",1635],["T_STRING","FALSE",1635],")",["T_WHITESPACE","\n\t",1635],"{",["T_WHITESPACE","\n\t\t",1636],["T_COMMENT","\/\/ For now we require GD but we should\n",1637],["T_WHITESPACE","\t\t",1638],["T_COMMENT","\/\/ find a way to determine this using IM or NetPBM\n",1638],["T_WHITESPACE","\n\t\t",1639],["T_IF","if",1640],["T_WHITESPACE"," ",1640],"(",["T_VARIABLE","$path",1640],["T_WHITESPACE"," ",1640],["T_IS_IDENTICAL","===",1640],["T_WHITESPACE"," ",1640],["T_CONSTANT_ENCAPSED_STRING","''",1640],")",["T_WHITESPACE","\n\t\t",1640],"{",["T_WHITESPACE","\n\t\t\t",1641],["T_VARIABLE","$path",1642],["T_WHITESPACE"," ",1642],"=",["T_WHITESPACE"," ",1642],["T_VARIABLE","$this",1642],["T_OBJECT_OPERATOR","->",1642],["T_STRING","full_src_path",1642],";",["T_WHITESPACE","\n\t\t",1642],"}",["T_WHITESPACE","\n\n\t\t",1643],["T_IF","if",1645],["T_WHITESPACE"," ",1645],"(",["T_WHITESPACE"," ",1645],"!",["T_WHITESPACE"," ",1645],["T_STRING","file_exists",1645],"(",["T_VARIABLE","$path",1645],")",")",["T_WHITESPACE","\n\t\t",1645],"{",["T_WHITESPACE","\n\t\t\t",1646],["T_VARIABLE","$this",1647],["T_OBJECT_OPERATOR","->",1647],["T_STRING","set_error",1647],"(",["T_CONSTANT_ENCAPSED_STRING","'imglib_invalid_path'",1647],")",";",["T_WHITESPACE","\n\t\t\t",1647],["T_RETURN","return",1648],["T_WHITESPACE"," ",1648],["T_STRING","FALSE",1648],";",["T_WHITESPACE","\n\t\t",1648],"}",["T_WHITESPACE","\n\n\t\t",1649],["T_VARIABLE","$vals",1651],["T_WHITESPACE"," ",1651],"=",["T_WHITESPACE"," ",1651],["T_STRING","getimagesize",1651],"(",["T_VARIABLE","$path",1651],")",";",["T_WHITESPACE","\n\t\t",1651],["T_IF","if",1652],["T_WHITESPACE"," ",1652],"(",["T_VARIABLE","$vals",1652],["T_WHITESPACE"," ",1652],["T_IS_IDENTICAL","===",1652],["T_WHITESPACE"," ",1652],["T_STRING","FALSE",1652],")",["T_WHITESPACE","\n\t\t",1652],"{",["T_WHITESPACE","\n\t\t\t",1653],["T_VARIABLE","$this",1654],["T_OBJECT_OPERATOR","->",1654],["T_STRING","set_error",1654],"(",["T_CONSTANT_ENCAPSED_STRING","'imglib_invalid_image'",1654],")",";",["T_WHITESPACE","\n\t\t\t",1654],["T_RETURN","return",1655],["T_WHITESPACE"," ",1655],["T_STRING","FALSE",1655],";",["T_WHITESPACE","\n\t\t",1655],"}",["T_WHITESPACE","\n\n\t\t",1656],["T_VARIABLE","$types",1658],["T_WHITESPACE"," ",1658],"=",["T_WHITESPACE"," ",1658],["T_ARRAY","array",1658],"(",["T_LNUMBER","1",1658],["T_WHITESPACE"," ",1658],["T_DOUBLE_ARROW","=>",1658],["T_WHITESPACE"," ",1658],["T_CONSTANT_ENCAPSED_STRING","'gif'",1658],",",["T_WHITESPACE"," ",1658],["T_LNUMBER","2",1658],["T_WHITESPACE"," ",1658],["T_DOUBLE_ARROW","=>",1658],["T_WHITESPACE"," ",1658],["T_CONSTANT_ENCAPSED_STRING","'jpeg'",1658],",",["T_WHITESPACE"," ",1658],["T_LNUMBER","3",1658],["T_WHITESPACE"," ",1658],["T_DOUBLE_ARROW","=>",1658],["T_WHITESPACE"," ",1658],["T_CONSTANT_ENCAPSED_STRING","'png'",1658],")",";",["T_WHITESPACE","\n\t\t",1658],["T_VARIABLE","$mime",1659],["T_WHITESPACE"," ",1659],"=",["T_WHITESPACE"," ",1659],["T_ISSET","isset",1659],"(",["T_VARIABLE","$types",1659],"[",["T_VARIABLE","$vals",1659],"[",["T_LNUMBER","2",1659],"]","]",")",["T_WHITESPACE"," ",1659],"?",["T_WHITESPACE"," ",1659],["T_CONSTANT_ENCAPSED_STRING","'image\/'",1659],".",["T_VARIABLE","$types",1659],"[",["T_VARIABLE","$vals",1659],"[",["T_LNUMBER","2",1659],"]","]",["T_WHITESPACE"," ",1659],":",["T_WHITESPACE"," ",1659],["T_CONSTANT_ENCAPSED_STRING","'image\/jpg'",1659],";",["T_WHITESPACE","\n\n\t\t",1659],["T_IF","if",1661],["T_WHITESPACE"," ",1661],"(",["T_VARIABLE","$return",1661],["T_WHITESPACE"," ",1661],["T_IS_IDENTICAL","===",1661],["T_WHITESPACE"," ",1661],["T_STRING","TRUE",1661],")",["T_WHITESPACE","\n\t\t",1661],"{",["T_WHITESPACE","\n\t\t\t",1662],["T_RETURN","return",1663],["T_WHITESPACE"," ",1663],["T_ARRAY","array",1663],"(",["T_WHITESPACE","\n\t\t\t\t",1663],["T_CONSTANT_ENCAPSED_STRING","'width'",1664],["T_WHITESPACE","      ",1664],["T_DOUBLE_ARROW","=>",1664],["T_WHITESPACE"," ",1664],["T_VARIABLE","$vals",1664],"[",["T_LNUMBER","0",1664],"]",",",["T_WHITESPACE","\n\t\t\t\t",1664],["T_CONSTANT_ENCAPSED_STRING","'height'",1665],["T_WHITESPACE","     ",1665],["T_DOUBLE_ARROW","=>",1665],["T_WHITESPACE"," ",1665],["T_VARIABLE","$vals",1665],"[",["T_LNUMBER","1",1665],"]",",",["T_WHITESPACE","\n\t\t\t\t",1665],["T_CONSTANT_ENCAPSED_STRING","'image_type'",1666],["T_WHITESPACE"," ",1666],["T_DOUBLE_ARROW","=>",1666],["T_WHITESPACE"," ",1666],["T_VARIABLE","$vals",1666],"[",["T_LNUMBER","2",1666],"]",",",["T_WHITESPACE","\n\t\t\t\t",1666],["T_CONSTANT_ENCAPSED_STRING","'size_str'",1667],["T_WHITESPACE","   ",1667],["T_DOUBLE_ARROW","=>",1667],["T_WHITESPACE"," ",1667],["T_VARIABLE","$vals",1667],"[",["T_LNUMBER","3",1667],"]",",",["T_WHITESPACE","\n\t\t\t\t",1667],["T_CONSTANT_ENCAPSED_STRING","'mime_type'",1668],["T_WHITESPACE","  ",1668],["T_DOUBLE_ARROW","=>",1668],["T_WHITESPACE"," ",1668],["T_VARIABLE","$mime",1668],["T_WHITESPACE","\n\t\t\t",1668],")",";",["T_WHITESPACE","\n\t\t",1669],"}",["T_WHITESPACE","\n\n\t\t",1670],["T_VARIABLE","$this",1672],["T_OBJECT_OPERATOR","->",1672],["T_STRING","orig_width",1672],["T_WHITESPACE","  ",1672],"=",["T_WHITESPACE"," ",1672],["T_VARIABLE","$vals",1672],"[",["T_LNUMBER","0",1672],"]",";",["T_WHITESPACE","\n\t\t",1672],["T_VARIABLE","$this",1673],["T_OBJECT_OPERATOR","->",1673],["T_STRING","orig_height",1673],["T_WHITESPACE"," ",1673],"=",["T_WHITESPACE"," ",1673],["T_VARIABLE","$vals",1673],"[",["T_LNUMBER","1",1673],"]",";",["T_WHITESPACE","\n\t\t",1673],["T_VARIABLE","$this",1674],["T_OBJECT_OPERATOR","->",1674],["T_STRING","image_type",1674],["T_WHITESPACE","  ",1674],"=",["T_WHITESPACE"," ",1674],["T_VARIABLE","$vals",1674],"[",["T_LNUMBER","2",1674],"]",";",["T_WHITESPACE","\n\t\t",1674],["T_VARIABLE","$this",1675],["T_OBJECT_OPERATOR","->",1675],["T_STRING","size_str",1675],["T_WHITESPACE","    ",1675],"=",["T_WHITESPACE"," ",1675],["T_VARIABLE","$vals",1675],"[",["T_LNUMBER","3",1675],"]",";",["T_WHITESPACE","\n\t\t",1675],["T_VARIABLE","$this",1676],["T_OBJECT_OPERATOR","->",1676],["T_STRING","mime_type",1676],["T_WHITESPACE","   ",1676],"=",["T_WHITESPACE"," ",1676],["T_VARIABLE","$mime",1676],";",["T_WHITESPACE","\n\n\t\t",1676],["T_RETURN","return",1678],["T_WHITESPACE"," ",1678],["T_STRING","TRUE",1678],";",["T_WHITESPACE","\n\t",1678],"}",["T_WHITESPACE","\n\n\t",1679],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",1681],["T_WHITESPACE","\n\t",1682],["T_DOC_COMMENT","\/**\n\t * Size calculator\n\t *\n\t * This function takes a known width x height and\n\t * recalculates it to a new size. Only one\n\t * new variable needs to be known\n\t *\n\t *\t$props = array(\n\t *\t\t\t'width'\t\t=> $width,\n\t *\t\t\t'height'\t=> $height,\n\t *\t\t\t'new_width'\t=> 40,\n\t *\t\t\t'new_height'\t=> ''\n\t *\t\t);\n\t *\n\t * @param\tarray\n\t * @return\tarray\n\t *\/",1683],["T_WHITESPACE","\n\t",1699],["T_PUBLIC","public",1700],["T_WHITESPACE"," ",1700],["T_FUNCTION","function",1700],["T_WHITESPACE"," ",1700],["T_STRING","size_calculator",1700],"(",["T_VARIABLE","$vals",1700],")",["T_WHITESPACE","\n\t",1700],"{",["T_WHITESPACE","\n\t\t",1701],["T_IF","if",1702],["T_WHITESPACE"," ",1702],"(",["T_WHITESPACE"," ",1702],"!",["T_WHITESPACE"," ",1702],["T_STRING","is_array",1702],"(",["T_VARIABLE","$vals",1702],")",")",["T_WHITESPACE","\n\t\t",1702],"{",["T_WHITESPACE","\n\t\t\t",1703],["T_RETURN","return",1704],";",["T_WHITESPACE","\n\t\t",1704],"}",["T_WHITESPACE","\n\n\t\t",1705],["T_VARIABLE","$allowed",1707],["T_WHITESPACE"," ",1707],"=",["T_WHITESPACE"," ",1707],["T_ARRAY","array",1707],"(",["T_CONSTANT_ENCAPSED_STRING","'new_width'",1707],",",["T_WHITESPACE"," ",1707],["T_CONSTANT_ENCAPSED_STRING","'new_height'",1707],",",["T_WHITESPACE"," ",1707],["T_CONSTANT_ENCAPSED_STRING","'width'",1707],",",["T_WHITESPACE"," ",1707],["T_CONSTANT_ENCAPSED_STRING","'height'",1707],")",";",["T_WHITESPACE","\n\n\t\t",1707],["T_FOREACH","foreach",1709],["T_WHITESPACE"," ",1709],"(",["T_VARIABLE","$allowed",1709],["T_WHITESPACE"," ",1709],["T_AS","as",1709],["T_WHITESPACE"," ",1709],["T_VARIABLE","$item",1709],")",["T_WHITESPACE","\n\t\t",1709],"{",["T_WHITESPACE","\n\t\t\t",1710],["T_IF","if",1711],["T_WHITESPACE"," ",1711],"(",["T_EMPTY","empty",1711],"(",["T_VARIABLE","$vals",1711],"[",["T_VARIABLE","$item",1711],"]",")",")",["T_WHITESPACE","\n\t\t\t",1711],"{",["T_WHITESPACE","\n\t\t\t\t",1712],["T_VARIABLE","$vals",1713],"[",["T_VARIABLE","$item",1713],"]",["T_WHITESPACE"," ",1713],"=",["T_WHITESPACE"," ",1713],["T_LNUMBER","0",1713],";",["T_WHITESPACE","\n\t\t\t",1713],"}",["T_WHITESPACE","\n\t\t",1714],"}",["T_WHITESPACE","\n\n\t\t",1715],["T_IF","if",1717],["T_WHITESPACE"," ",1717],"(",["T_VARIABLE","$vals",1717],"[",["T_CONSTANT_ENCAPSED_STRING","'width'",1717],"]",["T_WHITESPACE"," ",1717],["T_IS_IDENTICAL","===",1717],["T_WHITESPACE"," ",1717],["T_LNUMBER","0",1717],["T_WHITESPACE"," ",1717],["T_LOGICAL_OR","OR",1717],["T_WHITESPACE"," ",1717],["T_VARIABLE","$vals",1717],"[",["T_CONSTANT_ENCAPSED_STRING","'height'",1717],"]",["T_WHITESPACE"," ",1717],["T_IS_IDENTICAL","===",1717],["T_WHITESPACE"," ",1717],["T_LNUMBER","0",1717],")",["T_WHITESPACE","\n\t\t",1717],"{",["T_WHITESPACE","\n\t\t\t",1718],["T_RETURN","return",1719],["T_WHITESPACE"," ",1719],["T_VARIABLE","$vals",1719],";",["T_WHITESPACE","\n\t\t",1719],"}",["T_WHITESPACE","\n\n\t\t",1720],["T_IF","if",1722],["T_WHITESPACE"," ",1722],"(",["T_VARIABLE","$vals",1722],"[",["T_CONSTANT_ENCAPSED_STRING","'new_width'",1722],"]",["T_WHITESPACE"," ",1722],["T_IS_IDENTICAL","===",1722],["T_WHITESPACE"," ",1722],["T_LNUMBER","0",1722],")",["T_WHITESPACE","\n\t\t",1722],"{",["T_WHITESPACE","\n\t\t\t",1723],["T_VARIABLE","$vals",1724],"[",["T_CONSTANT_ENCAPSED_STRING","'new_width'",1724],"]",["T_WHITESPACE"," ",1724],"=",["T_WHITESPACE"," ",1724],["T_STRING","ceil",1724],"(",["T_VARIABLE","$vals",1724],"[",["T_CONSTANT_ENCAPSED_STRING","'width'",1724],"]","*",["T_VARIABLE","$vals",1724],"[",["T_CONSTANT_ENCAPSED_STRING","'new_height'",1724],"]","\/",["T_VARIABLE","$vals",1724],"[",["T_CONSTANT_ENCAPSED_STRING","'height'",1724],"]",")",";",["T_WHITESPACE","\n\t\t",1724],"}",["T_WHITESPACE","\n\t\t",1725],["T_ELSEIF","elseif",1726],["T_WHITESPACE"," ",1726],"(",["T_VARIABLE","$vals",1726],"[",["T_CONSTANT_ENCAPSED_STRING","'new_height'",1726],"]",["T_WHITESPACE"," ",1726],["T_IS_IDENTICAL","===",1726],["T_WHITESPACE"," ",1726],["T_LNUMBER","0",1726],")",["T_WHITESPACE","\n\t\t",1726],"{",["T_WHITESPACE","\n\t\t\t",1727],["T_VARIABLE","$vals",1728],"[",["T_CONSTANT_ENCAPSED_STRING","'new_height'",1728],"]",["T_WHITESPACE"," ",1728],"=",["T_WHITESPACE"," ",1728],["T_STRING","ceil",1728],"(",["T_VARIABLE","$vals",1728],"[",["T_CONSTANT_ENCAPSED_STRING","'new_width'",1728],"]","*",["T_VARIABLE","$vals",1728],"[",["T_CONSTANT_ENCAPSED_STRING","'height'",1728],"]","\/",["T_VARIABLE","$vals",1728],"[",["T_CONSTANT_ENCAPSED_STRING","'width'",1728],"]",")",";",["T_WHITESPACE","\n\t\t",1728],"}",["T_WHITESPACE","\n\n\t\t",1729],["T_RETURN","return",1731],["T_WHITESPACE"," ",1731],["T_VARIABLE","$vals",1731],";",["T_WHITESPACE","\n\t",1731],"}",["T_WHITESPACE","\n\n\t",1732],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",1734],["T_WHITESPACE","\n\t",1735],["T_DOC_COMMENT","\/**\n\t * Explode source_image\n\t *\n\t * This is a helper function that extracts the extension\n\t * from the source_image.  This function lets us deal with\n\t * source_images with multiple periods, like: my.cool.jpg\n\t * It returns an associative array with two elements:\n\t * $array['ext']  = '.jpg';\n\t * $array['name'] = 'my.cool';\n\t *\n\t * @param\tarray\n\t * @return\tarray\n\t *\/",1736],["T_WHITESPACE","\n\t",1748],["T_PUBLIC","public",1749],["T_WHITESPACE"," ",1749],["T_FUNCTION","function",1749],["T_WHITESPACE"," ",1749],["T_STRING","explode_name",1749],"(",["T_VARIABLE","$source_image",1749],")",["T_WHITESPACE","\n\t",1749],"{",["T_WHITESPACE","\n\t\t",1750],["T_VARIABLE","$ext",1751],["T_WHITESPACE"," ",1751],"=",["T_WHITESPACE"," ",1751],["T_STRING","strrchr",1751],"(",["T_VARIABLE","$source_image",1751],",",["T_WHITESPACE"," ",1751],["T_CONSTANT_ENCAPSED_STRING","'.'",1751],")",";",["T_WHITESPACE","\n\t\t",1751],["T_VARIABLE","$name",1752],["T_WHITESPACE"," ",1752],"=",["T_WHITESPACE"," ",1752],"(",["T_VARIABLE","$ext",1752],["T_WHITESPACE"," ",1752],["T_IS_IDENTICAL","===",1752],["T_WHITESPACE"," ",1752],["T_STRING","FALSE",1752],")",["T_WHITESPACE"," ",1752],"?",["T_WHITESPACE"," ",1752],["T_VARIABLE","$source_image",1752],["T_WHITESPACE"," ",1752],":",["T_WHITESPACE"," ",1752],["T_STRING","substr",1752],"(",["T_VARIABLE","$source_image",1752],",",["T_WHITESPACE"," ",1752],["T_LNUMBER","0",1752],",",["T_WHITESPACE"," ",1752],"-",["T_STRING","strlen",1752],"(",["T_VARIABLE","$ext",1752],")",")",";",["T_WHITESPACE","\n\n\t\t",1752],["T_RETURN","return",1754],["T_WHITESPACE"," ",1754],["T_ARRAY","array",1754],"(",["T_CONSTANT_ENCAPSED_STRING","'ext'",1754],["T_WHITESPACE"," ",1754],["T_DOUBLE_ARROW","=>",1754],["T_WHITESPACE"," ",1754],["T_VARIABLE","$ext",1754],",",["T_WHITESPACE"," ",1754],["T_CONSTANT_ENCAPSED_STRING","'name'",1754],["T_WHITESPACE"," ",1754],["T_DOUBLE_ARROW","=>",1754],["T_WHITESPACE"," ",1754],["T_VARIABLE","$name",1754],")",";",["T_WHITESPACE","\n\t",1754],"}",["T_WHITESPACE","\n\n\t",1755],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",1757],["T_WHITESPACE","\n\t",1758],["T_DOC_COMMENT","\/**\n\t * Is GD Installed?\n\t *\n\t * @return\tbool\n\t *\/",1759],["T_WHITESPACE","\n\t",1763],["T_PUBLIC","public",1764],["T_WHITESPACE"," ",1764],["T_FUNCTION","function",1764],["T_WHITESPACE"," ",1764],["T_STRING","gd_loaded",1764],"(",")",["T_WHITESPACE","\n\t",1764],"{",["T_WHITESPACE","\n\t\t",1765],["T_IF","if",1766],["T_WHITESPACE"," ",1766],"(",["T_WHITESPACE"," ",1766],"!",["T_WHITESPACE"," ",1766],["T_STRING","extension_loaded",1766],"(",["T_CONSTANT_ENCAPSED_STRING","'gd'",1766],")",")",["T_WHITESPACE","\n\t\t",1766],"{",["T_WHITESPACE","\n\t\t\t",1767],["T_COMMENT","\/* As it is stated in the PHP manual, dl() is not always available\n\t\t\t * and even if so - it could generate an E_WARNING message on failure\n\t\t\t *\/",1768],["T_WHITESPACE","\n\t\t\t",1770],["T_RETURN","return",1771],["T_WHITESPACE"," ",1771],"(",["T_STRING","function_exists",1771],"(",["T_CONSTANT_ENCAPSED_STRING","'dl'",1771],")",["T_WHITESPACE"," ",1771],["T_BOOLEAN_AND","&&",1771],["T_WHITESPACE"," ",1771],"@",["T_STRING","dl",1771],"(",["T_CONSTANT_ENCAPSED_STRING","'gd.so'",1771],")",")",";",["T_WHITESPACE","\n\t\t",1771],"}",["T_WHITESPACE","\n\n\t\t",1772],["T_RETURN","return",1774],["T_WHITESPACE"," ",1774],["T_STRING","TRUE",1774],";",["T_WHITESPACE","\n\t",1774],"}",["T_WHITESPACE","\n\n\t",1775],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",1777],["T_WHITESPACE","\n\t",1778],["T_DOC_COMMENT","\/**\n\t * Get GD version\n\t *\n\t * @return\tmixed\n\t *\/",1779],["T_WHITESPACE","\n\t",1783],["T_PUBLIC","public",1784],["T_WHITESPACE"," ",1784],["T_FUNCTION","function",1784],["T_WHITESPACE"," ",1784],["T_STRING","gd_version",1784],"(",")",["T_WHITESPACE","\n\t",1784],"{",["T_WHITESPACE","\n\t\t",1785],["T_IF","if",1786],["T_WHITESPACE"," ",1786],"(",["T_STRING","function_exists",1786],"(",["T_CONSTANT_ENCAPSED_STRING","'gd_info'",1786],")",")",["T_WHITESPACE","\n\t\t",1786],"{",["T_WHITESPACE","\n\t\t\t",1787],["T_VARIABLE","$gd_version",1788],["T_WHITESPACE"," ",1788],"=",["T_WHITESPACE"," ",1788],"@",["T_STRING","gd_info",1788],"(",")",";",["T_WHITESPACE","\n\t\t\t",1788],["T_RETURN","return",1789],["T_WHITESPACE"," ",1789],["T_STRING","preg_replace",1789],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\\D\/'",1789],",",["T_WHITESPACE"," ",1789],["T_CONSTANT_ENCAPSED_STRING","''",1789],",",["T_WHITESPACE"," ",1789],["T_VARIABLE","$gd_version",1789],"[",["T_CONSTANT_ENCAPSED_STRING","'GD Version'",1789],"]",")",";",["T_WHITESPACE","\n\t\t",1789],"}",["T_WHITESPACE","\n\n\t\t",1790],["T_RETURN","return",1792],["T_WHITESPACE"," ",1792],["T_STRING","FALSE",1792],";",["T_WHITESPACE","\n\t",1792],"}",["T_WHITESPACE","\n\n\t",1793],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",1795],["T_WHITESPACE","\n\t",1796],["T_DOC_COMMENT","\/**\n\t * Set error message\n\t *\n\t * @param\tstring\n\t * @return\tvoid\n\t *\/",1797],["T_WHITESPACE","\n\t",1802],["T_PUBLIC","public",1803],["T_WHITESPACE"," ",1803],["T_FUNCTION","function",1803],["T_WHITESPACE"," ",1803],["T_STRING","set_error",1803],"(",["T_VARIABLE","$msg",1803],")",["T_WHITESPACE","\n\t",1803],"{",["T_WHITESPACE","\n\t\t",1804],["T_VARIABLE","$CI",1805],["T_WHITESPACE"," ",1805],"=","&",["T_WHITESPACE"," ",1805],["T_STRING","get_instance",1805],"(",")",";",["T_WHITESPACE","\n\t\t",1805],["T_VARIABLE","$CI",1806],["T_OBJECT_OPERATOR","->",1806],["T_STRING","lang",1806],["T_OBJECT_OPERATOR","->",1806],["T_STRING","load",1806],"(",["T_CONSTANT_ENCAPSED_STRING","'imglib'",1806],")",";",["T_WHITESPACE","\n\n\t\t",1806],["T_IF","if",1808],["T_WHITESPACE"," ",1808],"(",["T_STRING","is_array",1808],"(",["T_VARIABLE","$msg",1808],")",")",["T_WHITESPACE","\n\t\t",1808],"{",["T_WHITESPACE","\n\t\t\t",1809],["T_FOREACH","foreach",1810],["T_WHITESPACE"," ",1810],"(",["T_VARIABLE","$msg",1810],["T_WHITESPACE"," ",1810],["T_AS","as",1810],["T_WHITESPACE"," ",1810],["T_VARIABLE","$val",1810],")",["T_WHITESPACE","\n\t\t\t",1810],"{",["T_WHITESPACE","\n\t\t\t\t",1811],["T_VARIABLE","$msg",1812],["T_WHITESPACE"," ",1812],"=",["T_WHITESPACE"," ",1812],"(",["T_VARIABLE","$CI",1812],["T_OBJECT_OPERATOR","->",1812],["T_STRING","lang",1812],["T_OBJECT_OPERATOR","->",1812],["T_STRING","line",1812],"(",["T_VARIABLE","$val",1812],")",["T_WHITESPACE"," ",1812],["T_IS_IDENTICAL","===",1812],["T_WHITESPACE"," ",1812],["T_STRING","FALSE",1812],")",["T_WHITESPACE"," ",1812],"?",["T_WHITESPACE"," ",1812],["T_VARIABLE","$val",1812],["T_WHITESPACE"," ",1812],":",["T_WHITESPACE"," ",1812],["T_VARIABLE","$CI",1812],["T_OBJECT_OPERATOR","->",1812],["T_STRING","lang",1812],["T_OBJECT_OPERATOR","->",1812],["T_STRING","line",1812],"(",["T_VARIABLE","$val",1812],")",";",["T_WHITESPACE","\n\t\t\t\t",1812],["T_VARIABLE","$this",1813],["T_OBJECT_OPERATOR","->",1813],["T_STRING","error_msg",1813],"[","]",["T_WHITESPACE"," ",1813],"=",["T_WHITESPACE"," ",1813],["T_VARIABLE","$msg",1813],";",["T_WHITESPACE","\n\t\t\t\t",1813],["T_STRING","log_message",1814],"(",["T_CONSTANT_ENCAPSED_STRING","'error'",1814],",",["T_WHITESPACE"," ",1814],["T_VARIABLE","$msg",1814],")",";",["T_WHITESPACE","\n\t\t\t",1814],"}",["T_WHITESPACE","\n\t\t",1815],"}",["T_WHITESPACE","\n\t\t",1816],["T_ELSE","else",1817],["T_WHITESPACE","\n\t\t",1817],"{",["T_WHITESPACE","\n\t\t\t",1818],["T_VARIABLE","$msg",1819],["T_WHITESPACE"," ",1819],"=",["T_WHITESPACE"," ",1819],"(",["T_VARIABLE","$CI",1819],["T_OBJECT_OPERATOR","->",1819],["T_STRING","lang",1819],["T_OBJECT_OPERATOR","->",1819],["T_STRING","line",1819],"(",["T_VARIABLE","$msg",1819],")",["T_WHITESPACE"," ",1819],["T_IS_IDENTICAL","===",1819],["T_WHITESPACE"," ",1819],["T_STRING","FALSE",1819],")",["T_WHITESPACE"," ",1819],"?",["T_WHITESPACE"," ",1819],["T_VARIABLE","$msg",1819],["T_WHITESPACE"," ",1819],":",["T_WHITESPACE"," ",1819],["T_VARIABLE","$CI",1819],["T_OBJECT_OPERATOR","->",1819],["T_STRING","lang",1819],["T_OBJECT_OPERATOR","->",1819],["T_STRING","line",1819],"(",["T_VARIABLE","$msg",1819],")",";",["T_WHITESPACE","\n\t\t\t",1819],["T_VARIABLE","$this",1820],["T_OBJECT_OPERATOR","->",1820],["T_STRING","error_msg",1820],"[","]",["T_WHITESPACE"," ",1820],"=",["T_WHITESPACE"," ",1820],["T_VARIABLE","$msg",1820],";",["T_WHITESPACE","\n\t\t\t",1820],["T_STRING","log_message",1821],"(",["T_CONSTANT_ENCAPSED_STRING","'error'",1821],",",["T_WHITESPACE"," ",1821],["T_VARIABLE","$msg",1821],")",";",["T_WHITESPACE","\n\t\t",1821],"}",["T_WHITESPACE","\n\t",1822],"}",["T_WHITESPACE","\n\n\t",1823],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",1825],["T_WHITESPACE","\n\t",1826],["T_DOC_COMMENT","\/**\n\t * Show error messages\n\t *\n\t * @param\tstring\n\t * @param\tstring\n\t * @return\tstring\n\t *\/",1827],["T_WHITESPACE","\n\t",1833],["T_PUBLIC","public",1834],["T_WHITESPACE"," ",1834],["T_FUNCTION","function",1834],["T_WHITESPACE"," ",1834],["T_STRING","display_errors",1834],"(",["T_VARIABLE","$open",1834],["T_WHITESPACE"," ",1834],"=",["T_WHITESPACE"," ",1834],["T_CONSTANT_ENCAPSED_STRING","'<p>'",1834],",",["T_WHITESPACE"," ",1834],["T_VARIABLE","$close",1834],["T_WHITESPACE"," ",1834],"=",["T_WHITESPACE"," ",1834],["T_CONSTANT_ENCAPSED_STRING","'<\/p>'",1834],")",["T_WHITESPACE","\n\t",1834],"{",["T_WHITESPACE","\n\t\t",1835],["T_RETURN","return",1836],["T_WHITESPACE"," ",1836],"(",["T_STRING","count",1836],"(",["T_VARIABLE","$this",1836],["T_OBJECT_OPERATOR","->",1836],["T_STRING","error_msg",1836],")",["T_WHITESPACE"," ",1836],">",["T_WHITESPACE"," ",1836],["T_LNUMBER","0",1836],")",["T_WHITESPACE"," ",1836],"?",["T_WHITESPACE"," ",1836],["T_VARIABLE","$open",1836],".",["T_STRING","implode",1836],"(",["T_VARIABLE","$close",1836],".",["T_VARIABLE","$open",1836],",",["T_WHITESPACE"," ",1836],["T_VARIABLE","$this",1836],["T_OBJECT_OPERATOR","->",1836],["T_STRING","error_msg",1836],")",".",["T_VARIABLE","$close",1836],["T_WHITESPACE"," ",1836],":",["T_WHITESPACE"," ",1836],["T_CONSTANT_ENCAPSED_STRING","''",1836],";",["T_WHITESPACE","\n\t",1836],"}",["T_WHITESPACE","\n\n",1837],"}",["T_WHITESPACE","\n",1839]]