[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * CodeIgniter\n *\n * An open source application development framework for PHP\n *\n * This content is released under the MIT License (MIT)\n *\n * Copyright (c) 2014 - 2017, British Columbia Institute of Technology\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and\/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n *\n * @package\tCodeIgniter\n * @author\tEllisLab Dev Team\n * @copyright\tCopyright (c) 2008 - 2014, EllisLab, Inc. (https:\/\/ellislab.com\/)\n * @copyright\tCopyright (c) 2014 - 2017, British Columbia Institute of Technology (http:\/\/bcit.ca\/)\n * @license\thttp:\/\/opensource.org\/licenses\/MIT\tMIT License\n * @link\thttps:\/\/codeigniter.com\n * @since\tVersion 1.3.0\n * @filesource\n *\/",2],["T_WHITESPACE","\n",37],["T_STRING","defined",38],"(",["T_CONSTANT_ENCAPSED_STRING","'BASEPATH'",38],")",["T_WHITESPACE"," ",38],["T_LOGICAL_OR","OR",38],["T_WHITESPACE"," ",38],["T_EXIT","exit",38],"(",["T_CONSTANT_ENCAPSED_STRING","'No direct script access allowed'",38],")",";",["T_WHITESPACE","\n\n",38],["T_DOC_COMMENT","\/**\n * MS SQL Database Adapter Class\n *\n * Note: _DB is an extender class that the app controller\n * creates dynamically based on whether the query builder\n * class is being used or not.\n *\n * @package\t\tCodeIgniter\n * @subpackage\tDrivers\n * @category\tDatabase\n * @author\t\tEllisLab Dev Team\n * @link\t\thttps:\/\/codeigniter.com\/user_guide\/database\/\n *\/",40],["T_WHITESPACE","\n",52],["T_CLASS","class",53],["T_WHITESPACE"," ",53],["T_STRING","CI_DB_mssql_driver",53],["T_WHITESPACE"," ",53],["T_EXTENDS","extends",53],["T_WHITESPACE"," ",53],["T_STRING","CI_DB",53],["T_WHITESPACE"," ",53],"{",["T_WHITESPACE","\n\n\t",53],["T_DOC_COMMENT","\/**\n\t * Database driver\n\t *\n\t * @var\tstring\n\t *\/",55],["T_WHITESPACE","\n\t",59],["T_PUBLIC","public",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$dbdriver",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'mssql'",60],";",["T_WHITESPACE","\n\n\t",60],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",62],["T_WHITESPACE","\n\t",63],["T_DOC_COMMENT","\/**\n\t * ORDER BY random keyword\n\t *\n\t * @var\tarray\n\t *\/",64],["T_WHITESPACE","\n\t",68],["T_PROTECTED","protected",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$_random_keyword",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_ARRAY","array",69],"(",["T_CONSTANT_ENCAPSED_STRING","'NEWID()'",69],",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'RAND(%d)'",69],")",";",["T_WHITESPACE","\n\n\t",69],["T_DOC_COMMENT","\/**\n\t * Quoted identifier flag\n\t *\n\t * Whether to use SQL-92 standard quoted identifier\n\t * (double quotes) or brackets for identifier escaping.\n\t *\n\t * @var\tbool\n\t *\/",71],["T_WHITESPACE","\n\t",78],["T_PROTECTED","protected",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$_quoted_identifier",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_STRING","TRUE",79],";",["T_WHITESPACE","\n\n\t",79],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",81],["T_WHITESPACE","\n\t",82],["T_DOC_COMMENT","\/**\n\t * Class constructor\n\t *\n\t * Appends the port number to the hostname, if needed.\n\t *\n\t * @param\tarray\t$params\n\t * @return\tvoid\n\t *\/",83],["T_WHITESPACE","\n\t",90],["T_PUBLIC","public",91],["T_WHITESPACE"," ",91],["T_FUNCTION","function",91],["T_WHITESPACE"," ",91],["T_STRING","__construct",91],"(",["T_VARIABLE","$params",91],")",["T_WHITESPACE","\n\t",91],"{",["T_WHITESPACE","\n\t\t",92],["T_STRING","parent",93],["T_DOUBLE_COLON","::",93],["T_STRING","__construct",93],"(",["T_VARIABLE","$params",93],")",";",["T_WHITESPACE","\n\n\t\t",93],["T_IF","if",95],["T_WHITESPACE"," ",95],"(",["T_WHITESPACE"," ",95],"!",["T_WHITESPACE"," ",95],["T_EMPTY","empty",95],"(",["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","port",95],")",")",["T_WHITESPACE","\n\t\t",95],"{",["T_WHITESPACE","\n\t\t\t",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","hostname",97],["T_WHITESPACE"," ",97],["T_CONCAT_EQUAL",".=",97],["T_WHITESPACE"," ",97],"(",["T_STRING","DIRECTORY_SEPARATOR",97],["T_WHITESPACE"," ",97],["T_IS_IDENTICAL","===",97],["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","'\\\\'",97],["T_WHITESPACE"," ",97],"?",["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","','",97],["T_WHITESPACE"," ",97],":",["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","':'",97],")",".",["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","port",97],";",["T_WHITESPACE","\n\t\t",97],"}",["T_WHITESPACE","\n\t",98],"}",["T_WHITESPACE","\n\n\t",99],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",101],["T_WHITESPACE","\n\t",102],["T_DOC_COMMENT","\/**\n\t * Non-persistent database connection\n\t *\n\t * @param\tbool\t$persistent\n\t * @return\tresource\n\t *\/",103],["T_WHITESPACE","\n\t",108],["T_PUBLIC","public",109],["T_WHITESPACE"," ",109],["T_FUNCTION","function",109],["T_WHITESPACE"," ",109],["T_STRING","db_connect",109],"(",["T_VARIABLE","$persistent",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_STRING","FALSE",109],")",["T_WHITESPACE","\n\t",109],"{",["T_WHITESPACE","\n\t\t",110],["T_STRING","ini_set",111],"(",["T_CONSTANT_ENCAPSED_STRING","'mssql.charset'",111],",",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","char_set",111],")",";",["T_WHITESPACE","\n\t\t",111],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","conn_id",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],"(",["T_VARIABLE","$persistent",112],")",["T_WHITESPACE","\n\t\t\t\t",112],"?",["T_WHITESPACE"," ",113],["T_STRING","mssql_pconnect",113],"(",["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","hostname",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","username",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","password",113],")",["T_WHITESPACE","\n\t\t\t\t",113],":",["T_WHITESPACE"," ",114],["T_STRING","mssql_connect",114],"(",["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","hostname",114],",",["T_WHITESPACE"," ",114],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","username",114],",",["T_WHITESPACE"," ",114],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","password",114],")",";",["T_WHITESPACE","\n\n\t\t",114],["T_IF","if",116],["T_WHITESPACE"," ",116],"(",["T_WHITESPACE"," ",116],"!",["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","conn_id",116],")",["T_WHITESPACE","\n\t\t",116],"{",["T_WHITESPACE","\n\t\t\t",117],["T_RETURN","return",118],["T_WHITESPACE"," ",118],["T_STRING","FALSE",118],";",["T_WHITESPACE","\n\t\t",118],"}",["T_WHITESPACE","\n\n\t\t",119],["T_COMMENT","\/\/ ----------------------------------------------------------------\n",121],["T_WHITESPACE","\n\t\t",122],["T_COMMENT","\/\/ Select the DB... assuming a database name is specified in the config file\n",123],["T_WHITESPACE","\t\t",124],["T_IF","if",124],["T_WHITESPACE"," ",124],"(",["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","database",124],["T_WHITESPACE"," ",124],["T_IS_NOT_IDENTICAL","!==",124],["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","''",124],["T_WHITESPACE"," ",124],["T_BOOLEAN_AND","&&",124],["T_WHITESPACE"," ",124],"!",["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","db_select",124],"(",")",")",["T_WHITESPACE","\n\t\t",124],"{",["T_WHITESPACE","\n\t\t\t",125],["T_STRING","log_message",126],"(",["T_CONSTANT_ENCAPSED_STRING","'error'",126],",",["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'Unable to select database: '",126],".",["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","database",126],")",";",["T_WHITESPACE","\n\n\t\t\t",126],["T_RETURN","return",128],["T_WHITESPACE"," ",128],"(",["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","db_debug",128],["T_WHITESPACE"," ",128],["T_IS_IDENTICAL","===",128],["T_WHITESPACE"," ",128],["T_STRING","TRUE",128],")",["T_WHITESPACE","\n\t\t\t\t",128],"?",["T_WHITESPACE"," ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","display_error",129],"(",["T_CONSTANT_ENCAPSED_STRING","'db_unable_to_select'",129],",",["T_WHITESPACE"," ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","database",129],")",["T_WHITESPACE","\n\t\t\t\t",129],":",["T_WHITESPACE"," ",130],["T_STRING","FALSE",130],";",["T_WHITESPACE","\n\t\t",130],"}",["T_WHITESPACE","\n\n\t\t",131],["T_COMMENT","\/\/ Determine how identifiers are escaped\n",133],["T_WHITESPACE","\t\t",134],["T_VARIABLE","$query",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","query",134],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT CASE WHEN (@@OPTIONS | 256) = @@OPTIONS THEN 1 ELSE 0 END AS qi'",134],")",";",["T_WHITESPACE","\n\t\t",134],["T_VARIABLE","$query",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_VARIABLE","$query",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","row_array",135],"(",")",";",["T_WHITESPACE","\n\t\t",135],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","_quoted_identifier",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_EMPTY","empty",136],"(",["T_VARIABLE","$query",136],")",["T_WHITESPACE"," ",136],"?",["T_WHITESPACE"," ",136],["T_STRING","FALSE",136],["T_WHITESPACE"," ",136],":",["T_WHITESPACE"," ",136],["T_BOOL_CAST","(bool)",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$query",136],"[",["T_CONSTANT_ENCAPSED_STRING","'qi'",136],"]",";",["T_WHITESPACE","\n\t\t",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","_escape_char",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],"(",["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","_quoted_identifier",137],")",["T_WHITESPACE"," ",137],"?",["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'\"'",137],["T_WHITESPACE"," ",137],":",["T_WHITESPACE"," ",137],["T_ARRAY","array",137],"(",["T_CONSTANT_ENCAPSED_STRING","'['",137],",",["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","']'",137],")",";",["T_WHITESPACE","\n\n\t\t",137],["T_RETURN","return",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","conn_id",139],";",["T_WHITESPACE","\n\t",139],"}",["T_WHITESPACE","\n\n\t",140],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",142],["T_WHITESPACE","\n\t",143],["T_DOC_COMMENT","\/**\n\t * Select the database\n\t *\n\t * @param\tstring\t$database\n\t * @return\tbool\n\t *\/",144],["T_WHITESPACE","\n\t",149],["T_PUBLIC","public",150],["T_WHITESPACE"," ",150],["T_FUNCTION","function",150],["T_WHITESPACE"," ",150],["T_STRING","db_select",150],"(",["T_VARIABLE","$database",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_CONSTANT_ENCAPSED_STRING","''",150],")",["T_WHITESPACE","\n\t",150],"{",["T_WHITESPACE","\n\t\t",151],["T_IF","if",152],["T_WHITESPACE"," ",152],"(",["T_VARIABLE","$database",152],["T_WHITESPACE"," ",152],["T_IS_IDENTICAL","===",152],["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","''",152],")",["T_WHITESPACE","\n\t\t",152],"{",["T_WHITESPACE","\n\t\t\t",153],["T_VARIABLE","$database",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","database",154],";",["T_WHITESPACE","\n\t\t",154],"}",["T_WHITESPACE","\n\n\t\t",155],["T_COMMENT","\/\/ Note: Escaping is required in the event that the DB name\n",157],["T_WHITESPACE","\t\t",158],["T_COMMENT","\/\/ contains reserved characters.\n",158],["T_WHITESPACE","\t\t",159],["T_IF","if",159],["T_WHITESPACE"," ",159],"(",["T_STRING","mssql_select_db",159],"(",["T_CONSTANT_ENCAPSED_STRING","'['",159],".",["T_VARIABLE","$database",159],".",["T_CONSTANT_ENCAPSED_STRING","']'",159],",",["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","conn_id",159],")",")",["T_WHITESPACE","\n\t\t",159],"{",["T_WHITESPACE","\n\t\t\t",160],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","database",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_VARIABLE","$database",161],";",["T_WHITESPACE","\n\t\t\t",161],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","data_cache",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_ARRAY","array",162],"(",")",";",["T_WHITESPACE","\n\t\t\t",162],["T_RETURN","return",163],["T_WHITESPACE"," ",163],["T_STRING","TRUE",163],";",["T_WHITESPACE","\n\t\t",163],"}",["T_WHITESPACE","\n\n\t\t",164],["T_RETURN","return",166],["T_WHITESPACE"," ",166],["T_STRING","FALSE",166],";",["T_WHITESPACE","\n\t",166],"}",["T_WHITESPACE","\n\n\t",167],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",169],["T_WHITESPACE","\n\t",170],["T_DOC_COMMENT","\/**\n\t * Execute the query\n\t *\n\t * @param\tstring\t$sql\tan SQL query\n\t * @return\tmixed\tresource if rows are returned, bool otherwise\n\t *\/",171],["T_WHITESPACE","\n\t",176],["T_PROTECTED","protected",177],["T_WHITESPACE"," ",177],["T_FUNCTION","function",177],["T_WHITESPACE"," ",177],["T_STRING","_execute",177],"(",["T_VARIABLE","$sql",177],")",["T_WHITESPACE","\n\t",177],"{",["T_WHITESPACE","\n\t\t",178],["T_RETURN","return",179],["T_WHITESPACE"," ",179],["T_STRING","mssql_query",179],"(",["T_VARIABLE","$sql",179],",",["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","conn_id",179],")",";",["T_WHITESPACE","\n\t",179],"}",["T_WHITESPACE","\n\n\t",180],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",182],["T_WHITESPACE","\n\t",183],["T_DOC_COMMENT","\/**\n\t * Begin Transaction\n\t *\n\t * @return\tbool\n\t *\/",184],["T_WHITESPACE","\n\t",188],["T_PROTECTED","protected",189],["T_WHITESPACE"," ",189],["T_FUNCTION","function",189],["T_WHITESPACE"," ",189],["T_STRING","_trans_begin",189],"(",")",["T_WHITESPACE","\n\t",189],"{",["T_WHITESPACE","\n\t\t",190],["T_RETURN","return",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","simple_query",191],"(",["T_CONSTANT_ENCAPSED_STRING","'BEGIN TRAN'",191],")",";",["T_WHITESPACE","\n\t",191],"}",["T_WHITESPACE","\n\n\t",192],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",194],["T_WHITESPACE","\n\t",195],["T_DOC_COMMENT","\/**\n\t * Commit Transaction\n\t *\n\t * @return\tbool\n\t *\/",196],["T_WHITESPACE","\n\t",200],["T_PROTECTED","protected",201],["T_WHITESPACE"," ",201],["T_FUNCTION","function",201],["T_WHITESPACE"," ",201],["T_STRING","_trans_commit",201],"(",")",["T_WHITESPACE","\n\t",201],"{",["T_WHITESPACE","\n\t\t",202],["T_RETURN","return",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","simple_query",203],"(",["T_CONSTANT_ENCAPSED_STRING","'COMMIT TRAN'",203],")",";",["T_WHITESPACE","\n\t",203],"}",["T_WHITESPACE","\n\n\t",204],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",206],["T_WHITESPACE","\n\t",207],["T_DOC_COMMENT","\/**\n\t * Rollback Transaction\n\t *\n\t * @return\tbool\n\t *\/",208],["T_WHITESPACE","\n\t",212],["T_PROTECTED","protected",213],["T_WHITESPACE"," ",213],["T_FUNCTION","function",213],["T_WHITESPACE"," ",213],["T_STRING","_trans_rollback",213],"(",")",["T_WHITESPACE","\n\t",213],"{",["T_WHITESPACE","\n\t\t",214],["T_RETURN","return",215],["T_WHITESPACE"," ",215],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","simple_query",215],"(",["T_CONSTANT_ENCAPSED_STRING","'ROLLBACK TRAN'",215],")",";",["T_WHITESPACE","\n\t",215],"}",["T_WHITESPACE","\n\n\t",216],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",218],["T_WHITESPACE","\n\t",219],["T_DOC_COMMENT","\/**\n\t * Affected Rows\n\t *\n\t * @return\tint\n\t *\/",220],["T_WHITESPACE","\n\t",224],["T_PUBLIC","public",225],["T_WHITESPACE"," ",225],["T_FUNCTION","function",225],["T_WHITESPACE"," ",225],["T_STRING","affected_rows",225],"(",")",["T_WHITESPACE","\n\t",225],"{",["T_WHITESPACE","\n\t\t",226],["T_RETURN","return",227],["T_WHITESPACE"," ",227],["T_STRING","mssql_rows_affected",227],"(",["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","conn_id",227],")",";",["T_WHITESPACE","\n\t",227],"}",["T_WHITESPACE","\n\n\t",228],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",230],["T_WHITESPACE","\n\t",231],["T_DOC_COMMENT","\/**\n\t * Insert ID\n\t *\n\t * Returns the last id created in the Identity column.\n\t *\n\t * @return\tstring\n\t *\/",232],["T_WHITESPACE","\n\t",238],["T_PUBLIC","public",239],["T_WHITESPACE"," ",239],["T_FUNCTION","function",239],["T_WHITESPACE"," ",239],["T_STRING","insert_id",239],"(",")",["T_WHITESPACE","\n\t",239],"{",["T_WHITESPACE","\n\t\t",240],["T_VARIABLE","$query",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_STRING","version_compare",241],"(",["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","version",241],"(",")",",",["T_WHITESPACE"," ",241],["T_CONSTANT_ENCAPSED_STRING","'8'",241],",",["T_WHITESPACE"," ",241],["T_CONSTANT_ENCAPSED_STRING","'>='",241],")",["T_WHITESPACE","\n\t\t\t",241],"?",["T_WHITESPACE"," ",242],["T_CONSTANT_ENCAPSED_STRING","'SELECT SCOPE_IDENTITY() AS last_id'",242],["T_WHITESPACE","\n\t\t\t",242],":",["T_WHITESPACE"," ",243],["T_CONSTANT_ENCAPSED_STRING","'SELECT @@IDENTITY AS last_id'",243],";",["T_WHITESPACE","\n\n\t\t",243],["T_VARIABLE","$query",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","query",245],"(",["T_VARIABLE","$query",245],")",";",["T_WHITESPACE","\n\t\t",245],["T_VARIABLE","$query",246],["T_WHITESPACE"," ",246],"=",["T_WHITESPACE"," ",246],["T_VARIABLE","$query",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","row",246],"(",")",";",["T_WHITESPACE","\n\t\t",246],["T_RETURN","return",247],["T_WHITESPACE"," ",247],["T_VARIABLE","$query",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","last_id",247],";",["T_WHITESPACE","\n\t",247],"}",["T_WHITESPACE","\n\n\t",248],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",250],["T_WHITESPACE","\n\t",251],["T_DOC_COMMENT","\/**\n\t * Version number query string\n\t *\n\t * @return\tstring\n\t *\/",252],["T_WHITESPACE","\n\t",256],["T_PROTECTED","protected",257],["T_WHITESPACE"," ",257],["T_FUNCTION","function",257],["T_WHITESPACE"," ",257],["T_STRING","_version",257],"(",")",["T_WHITESPACE","\n\t",257],"{",["T_WHITESPACE","\n\t\t",258],["T_RETURN","return",259],["T_WHITESPACE"," ",259],["T_CONSTANT_ENCAPSED_STRING","\"SELECT SERVERPROPERTY('ProductVersion') AS ver\"",259],";",["T_WHITESPACE","\n\t",259],"}",["T_WHITESPACE","\n\n\t",260],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",262],["T_WHITESPACE","\n\t",263],["T_DOC_COMMENT","\/**\n\t * List table query\n\t *\n\t * Generates a platform-specific query string so that the table names can be fetched\n\t *\n\t * @param\tbool\t$prefix_limit\n\t * @return\tstring\n\t *\/",264],["T_WHITESPACE","\n\t",271],["T_PROTECTED","protected",272],["T_WHITESPACE"," ",272],["T_FUNCTION","function",272],["T_WHITESPACE"," ",272],["T_STRING","_list_tables",272],"(",["T_VARIABLE","$prefix_limit",272],["T_WHITESPACE"," ",272],"=",["T_WHITESPACE"," ",272],["T_STRING","FALSE",272],")",["T_WHITESPACE","\n\t",272],"{",["T_WHITESPACE","\n\t\t",273],["T_VARIABLE","$sql",274],["T_WHITESPACE"," ",274],"=",["T_WHITESPACE"," ",274],["T_CONSTANT_ENCAPSED_STRING","'SELECT '",274],".",["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","escape_identifiers",274],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",274],")",["T_WHITESPACE","\n\t\t\t",274],".",["T_CONSTANT_ENCAPSED_STRING","' FROM '",275],".",["T_VARIABLE","$this",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","escape_identifiers",275],"(",["T_CONSTANT_ENCAPSED_STRING","'sysobjects'",275],")",["T_WHITESPACE","\n\t\t\t",275],".",["T_CONSTANT_ENCAPSED_STRING","' WHERE '",276],".",["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","escape_identifiers",276],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",276],")",".",["T_CONSTANT_ENCAPSED_STRING","\" = 'U'\"",276],";",["T_WHITESPACE","\n\n\t\t",276],["T_IF","if",278],["T_WHITESPACE"," ",278],"(",["T_VARIABLE","$prefix_limit",278],["T_WHITESPACE"," ",278],["T_IS_NOT_IDENTICAL","!==",278],["T_WHITESPACE"," ",278],["T_STRING","FALSE",278],["T_WHITESPACE"," ",278],["T_BOOLEAN_AND","&&",278],["T_WHITESPACE"," ",278],["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","dbprefix",278],["T_WHITESPACE"," ",278],["T_IS_NOT_IDENTICAL","!==",278],["T_WHITESPACE"," ",278],["T_CONSTANT_ENCAPSED_STRING","''",278],")",["T_WHITESPACE","\n\t\t",278],"{",["T_WHITESPACE","\n\t\t\t",279],["T_VARIABLE","$sql",280],["T_WHITESPACE"," ",280],["T_CONCAT_EQUAL",".=",280],["T_WHITESPACE"," ",280],["T_CONSTANT_ENCAPSED_STRING","' AND '",280],".",["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","escape_identifiers",280],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",280],")",".",["T_CONSTANT_ENCAPSED_STRING","\" LIKE '\"",280],".",["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","escape_like_str",280],"(",["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","dbprefix",280],")",".",["T_CONSTANT_ENCAPSED_STRING","\"%' \"",280],["T_WHITESPACE","\n\t\t\t\t",280],".",["T_STRING","sprintf",281],"(",["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","_like_escape_str",281],",",["T_WHITESPACE"," ",281],["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","_like_escape_chr",281],")",";",["T_WHITESPACE","\n\t\t",281],"}",["T_WHITESPACE","\n\n\t\t",282],["T_RETURN","return",284],["T_WHITESPACE"," ",284],["T_VARIABLE","$sql",284],".",["T_CONSTANT_ENCAPSED_STRING","' ORDER BY '",284],".",["T_VARIABLE","$this",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","escape_identifiers",284],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",284],")",";",["T_WHITESPACE","\n\t",284],"}",["T_WHITESPACE","\n\n\t",285],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",287],["T_WHITESPACE","\n\t",288],["T_DOC_COMMENT","\/**\n\t * List column query\n\t *\n\t * Generates a platform-specific query string so that the column names can be fetched\n\t *\n\t * @param\tstring\t$table\n\t * @return\tstring\n\t *\/",289],["T_WHITESPACE","\n\t",296],["T_PROTECTED","protected",297],["T_WHITESPACE"," ",297],["T_FUNCTION","function",297],["T_WHITESPACE"," ",297],["T_STRING","_list_columns",297],"(",["T_VARIABLE","$table",297],["T_WHITESPACE"," ",297],"=",["T_WHITESPACE"," ",297],["T_CONSTANT_ENCAPSED_STRING","''",297],")",["T_WHITESPACE","\n\t",297],"{",["T_WHITESPACE","\n\t\t",298],["T_RETURN","return",299],["T_WHITESPACE"," ",299],["T_CONSTANT_ENCAPSED_STRING","'SELECT COLUMN_NAME\n\t\t\tFROM INFORMATION_SCHEMA.Columns\n\t\t\tWHERE UPPER(TABLE_NAME) = '",299],".",["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","escape",301],"(",["T_STRING","strtoupper",301],"(",["T_VARIABLE","$table",301],")",")",";",["T_WHITESPACE","\n\t",301],"}",["T_WHITESPACE","\n\n\t",302],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",304],["T_WHITESPACE","\n\t",305],["T_DOC_COMMENT","\/**\n\t * Returns an object with field data\n\t *\n\t * @param\tstring\t$table\n\t * @return\tarray\n\t *\/",306],["T_WHITESPACE","\n\t",311],["T_PUBLIC","public",312],["T_WHITESPACE"," ",312],["T_FUNCTION","function",312],["T_WHITESPACE"," ",312],["T_STRING","field_data",312],"(",["T_VARIABLE","$table",312],")",["T_WHITESPACE","\n\t",312],"{",["T_WHITESPACE","\n\t\t",313],["T_VARIABLE","$sql",314],["T_WHITESPACE"," ",314],"=",["T_WHITESPACE"," ",314],["T_CONSTANT_ENCAPSED_STRING","'SELECT COLUMN_NAME, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH, NUMERIC_PRECISION, COLUMN_DEFAULT\n\t\t\tFROM INFORMATION_SCHEMA.Columns\n\t\t\tWHERE UPPER(TABLE_NAME) = '",314],".",["T_VARIABLE","$this",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","escape",316],"(",["T_STRING","strtoupper",316],"(",["T_VARIABLE","$table",316],")",")",";",["T_WHITESPACE","\n\n\t\t",316],["T_IF","if",318],["T_WHITESPACE"," ",318],"(","(",["T_VARIABLE","$query",318],["T_WHITESPACE"," ",318],"=",["T_WHITESPACE"," ",318],["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","query",318],"(",["T_VARIABLE","$sql",318],")",")",["T_WHITESPACE"," ",318],["T_IS_IDENTICAL","===",318],["T_WHITESPACE"," ",318],["T_STRING","FALSE",318],")",["T_WHITESPACE","\n\t\t",318],"{",["T_WHITESPACE","\n\t\t\t",319],["T_RETURN","return",320],["T_WHITESPACE"," ",320],["T_STRING","FALSE",320],";",["T_WHITESPACE","\n\t\t",320],"}",["T_WHITESPACE","\n\t\t",321],["T_VARIABLE","$query",322],["T_WHITESPACE"," ",322],"=",["T_WHITESPACE"," ",322],["T_VARIABLE","$query",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","result_object",322],"(",")",";",["T_WHITESPACE","\n\n\t\t",322],["T_VARIABLE","$retval",324],["T_WHITESPACE"," ",324],"=",["T_WHITESPACE"," ",324],["T_ARRAY","array",324],"(",")",";",["T_WHITESPACE","\n\t\t",324],["T_FOR","for",325],["T_WHITESPACE"," ",325],"(",["T_VARIABLE","$i",325],["T_WHITESPACE"," ",325],"=",["T_WHITESPACE"," ",325],["T_LNUMBER","0",325],",",["T_WHITESPACE"," ",325],["T_VARIABLE","$c",325],["T_WHITESPACE"," ",325],"=",["T_WHITESPACE"," ",325],["T_STRING","count",325],"(",["T_VARIABLE","$query",325],")",";",["T_WHITESPACE"," ",325],["T_VARIABLE","$i",325],["T_WHITESPACE"," ",325],"<",["T_WHITESPACE"," ",325],["T_VARIABLE","$c",325],";",["T_WHITESPACE"," ",325],["T_VARIABLE","$i",325],["T_INC","++",325],")",["T_WHITESPACE","\n\t\t",325],"{",["T_WHITESPACE","\n\t\t\t",326],["T_VARIABLE","$retval",327],"[",["T_VARIABLE","$i",327],"]",["T_WHITESPACE","\t\t\t",327],"=",["T_WHITESPACE"," ",327],["T_NEW","new",327],["T_WHITESPACE"," ",327],["T_STRING","stdClass",327],"(",")",";",["T_WHITESPACE","\n\t\t\t",327],["T_VARIABLE","$retval",328],"[",["T_VARIABLE","$i",328],"]",["T_OBJECT_OPERATOR","->",328],["T_STRING","name",328],["T_WHITESPACE","\t\t",328],"=",["T_WHITESPACE"," ",328],["T_VARIABLE","$query",328],"[",["T_VARIABLE","$i",328],"]",["T_OBJECT_OPERATOR","->",328],["T_STRING","COLUMN_NAME",328],";",["T_WHITESPACE","\n\t\t\t",328],["T_VARIABLE","$retval",329],"[",["T_VARIABLE","$i",329],"]",["T_OBJECT_OPERATOR","->",329],["T_STRING","type",329],["T_WHITESPACE","\t\t",329],"=",["T_WHITESPACE"," ",329],["T_VARIABLE","$query",329],"[",["T_VARIABLE","$i",329],"]",["T_OBJECT_OPERATOR","->",329],["T_STRING","DATA_TYPE",329],";",["T_WHITESPACE","\n\t\t\t",329],["T_VARIABLE","$retval",330],"[",["T_VARIABLE","$i",330],"]",["T_OBJECT_OPERATOR","->",330],["T_STRING","max_length",330],["T_WHITESPACE","\t\t",330],"=",["T_WHITESPACE"," ",330],"(",["T_VARIABLE","$query",330],"[",["T_VARIABLE","$i",330],"]",["T_OBJECT_OPERATOR","->",330],["T_STRING","CHARACTER_MAXIMUM_LENGTH",330],["T_WHITESPACE"," ",330],">",["T_WHITESPACE"," ",330],["T_LNUMBER","0",330],")",["T_WHITESPACE"," ",330],"?",["T_WHITESPACE"," ",330],["T_VARIABLE","$query",330],"[",["T_VARIABLE","$i",330],"]",["T_OBJECT_OPERATOR","->",330],["T_STRING","CHARACTER_MAXIMUM_LENGTH",330],["T_WHITESPACE"," ",330],":",["T_WHITESPACE"," ",330],["T_VARIABLE","$query",330],"[",["T_VARIABLE","$i",330],"]",["T_OBJECT_OPERATOR","->",330],["T_STRING","NUMERIC_PRECISION",330],";",["T_WHITESPACE","\n\t\t\t",330],["T_VARIABLE","$retval",331],"[",["T_VARIABLE","$i",331],"]",["T_OBJECT_OPERATOR","->",331],["T_STRING","default",331],["T_WHITESPACE","\t\t",331],"=",["T_WHITESPACE"," ",331],["T_VARIABLE","$query",331],"[",["T_VARIABLE","$i",331],"]",["T_OBJECT_OPERATOR","->",331],["T_STRING","COLUMN_DEFAULT",331],";",["T_WHITESPACE","\n\t\t",331],"}",["T_WHITESPACE","\n\n\t\t",332],["T_RETURN","return",334],["T_WHITESPACE"," ",334],["T_VARIABLE","$retval",334],";",["T_WHITESPACE","\n\t",334],"}",["T_WHITESPACE","\n\n\t",335],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",337],["T_WHITESPACE","\n\t",338],["T_DOC_COMMENT","\/**\n\t * Error\n\t *\n\t * Returns an array containing code and message of the last\n\t * database error that has occurred.\n\t *\n\t * @return\tarray\n\t *\/",339],["T_WHITESPACE","\n\t",346],["T_PUBLIC","public",347],["T_WHITESPACE"," ",347],["T_FUNCTION","function",347],["T_WHITESPACE"," ",347],["T_STRING","error",347],"(",")",["T_WHITESPACE","\n\t",347],"{",["T_WHITESPACE","\n\t\t",348],["T_COMMENT","\/\/ We need this because the error info is discarded by the\n",349],["T_WHITESPACE","\t\t",350],["T_COMMENT","\/\/ server the first time you request it, and query() already\n",350],["T_WHITESPACE","\t\t",351],["T_COMMENT","\/\/ calls error() once for logging purposes when a query fails.\n",351],["T_WHITESPACE","\t\t",352],["T_STATIC","static",352],["T_WHITESPACE"," ",352],["T_VARIABLE","$error",352],["T_WHITESPACE"," ",352],"=",["T_WHITESPACE"," ",352],["T_ARRAY","array",352],"(",["T_CONSTANT_ENCAPSED_STRING","'code'",352],["T_WHITESPACE"," ",352],["T_DOUBLE_ARROW","=>",352],["T_WHITESPACE"," ",352],["T_LNUMBER","0",352],",",["T_WHITESPACE"," ",352],["T_CONSTANT_ENCAPSED_STRING","'message'",352],["T_WHITESPACE"," ",352],["T_DOUBLE_ARROW","=>",352],["T_WHITESPACE"," ",352],["T_STRING","NULL",352],")",";",["T_WHITESPACE","\n\n\t\t",352],["T_VARIABLE","$message",354],["T_WHITESPACE"," ",354],"=",["T_WHITESPACE"," ",354],["T_STRING","mssql_get_last_message",354],"(",")",";",["T_WHITESPACE","\n\t\t",354],["T_IF","if",355],["T_WHITESPACE"," ",355],"(",["T_WHITESPACE"," ",355],"!",["T_WHITESPACE"," ",355],["T_EMPTY","empty",355],"(",["T_VARIABLE","$message",355],")",")",["T_WHITESPACE","\n\t\t",355],"{",["T_WHITESPACE","\n\t\t\t",356],["T_VARIABLE","$error",357],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",357],"]",["T_WHITESPACE","    ",357],"=",["T_WHITESPACE"," ",357],["T_VARIABLE","$this",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","query",357],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT @@ERROR AS code'",357],")",["T_OBJECT_OPERATOR","->",357],["T_STRING","row",357],"(",")",["T_OBJECT_OPERATOR","->",357],["T_STRING","code",357],";",["T_WHITESPACE","\n\t\t\t",357],["T_VARIABLE","$error",358],"[",["T_CONSTANT_ENCAPSED_STRING","'message'",358],"]",["T_WHITESPACE"," ",358],"=",["T_WHITESPACE"," ",358],["T_VARIABLE","$message",358],";",["T_WHITESPACE","\n\t\t",358],"}",["T_WHITESPACE","\n\n\t\t",359],["T_RETURN","return",361],["T_WHITESPACE"," ",361],["T_VARIABLE","$error",361],";",["T_WHITESPACE","\n\t",361],"}",["T_WHITESPACE","\n\n\t",362],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",364],["T_WHITESPACE","\n\t",365],["T_DOC_COMMENT","\/**\n\t * Update statement\n\t *\n\t * Generates a platform-specific update string from the supplied data\n\t *\n\t * @param\tstring\t$table\n\t * @param\tarray\t$values\n\t * @return\tstring\n\t *\/",366],["T_WHITESPACE","\n\t",374],["T_PROTECTED","protected",375],["T_WHITESPACE"," ",375],["T_FUNCTION","function",375],["T_WHITESPACE"," ",375],["T_STRING","_update",375],"(",["T_VARIABLE","$table",375],",",["T_WHITESPACE"," ",375],["T_VARIABLE","$values",375],")",["T_WHITESPACE","\n\t",375],"{",["T_WHITESPACE","\n\t\t",376],["T_VARIABLE","$this",377],["T_OBJECT_OPERATOR","->",377],["T_STRING","qb_limit",377],["T_WHITESPACE"," ",377],"=",["T_WHITESPACE"," ",377],["T_STRING","FALSE",377],";",["T_WHITESPACE","\n\t\t",377],["T_VARIABLE","$this",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","qb_orderby",378],["T_WHITESPACE"," ",378],"=",["T_WHITESPACE"," ",378],["T_ARRAY","array",378],"(",")",";",["T_WHITESPACE","\n\t\t",378],["T_RETURN","return",379],["T_WHITESPACE"," ",379],["T_STRING","parent",379],["T_DOUBLE_COLON","::",379],["T_STRING","_update",379],"(",["T_VARIABLE","$table",379],",",["T_WHITESPACE"," ",379],["T_VARIABLE","$values",379],")",";",["T_WHITESPACE","\n\t",379],"}",["T_WHITESPACE","\n\n\t",380],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",382],["T_WHITESPACE","\n\t",383],["T_DOC_COMMENT","\/**\n\t * Truncate statement\n\t *\n\t * Generates a platform-specific truncate string from the supplied data\n\t *\n\t * If the database does not support the TRUNCATE statement,\n\t * then this method maps to 'DELETE FROM table'\n\t *\n\t * @param\tstring\t$table\n\t * @return\tstring\n\t *\/",384],["T_WHITESPACE","\n\t",394],["T_PROTECTED","protected",395],["T_WHITESPACE"," ",395],["T_FUNCTION","function",395],["T_WHITESPACE"," ",395],["T_STRING","_truncate",395],"(",["T_VARIABLE","$table",395],")",["T_WHITESPACE","\n\t",395],"{",["T_WHITESPACE","\n\t\t",396],["T_RETURN","return",397],["T_WHITESPACE"," ",397],["T_CONSTANT_ENCAPSED_STRING","'TRUNCATE TABLE '",397],".",["T_VARIABLE","$table",397],";",["T_WHITESPACE","\n\t",397],"}",["T_WHITESPACE","\n\n\t",398],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",400],["T_WHITESPACE","\n\t",401],["T_DOC_COMMENT","\/**\n\t * Delete statement\n\t *\n\t * Generates a platform-specific delete string from the supplied data\n\t *\n\t * @param\tstring\t$table\n\t * @return\tstring\n\t *\/",402],["T_WHITESPACE","\n\t",409],["T_PROTECTED","protected",410],["T_WHITESPACE"," ",410],["T_FUNCTION","function",410],["T_WHITESPACE"," ",410],["T_STRING","_delete",410],"(",["T_VARIABLE","$table",410],")",["T_WHITESPACE","\n\t",410],"{",["T_WHITESPACE","\n\t\t",411],["T_IF","if",412],["T_WHITESPACE"," ",412],"(",["T_VARIABLE","$this",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","qb_limit",412],")",["T_WHITESPACE","\n\t\t",412],"{",["T_WHITESPACE","\n\t\t\t",413],["T_RETURN","return",414],["T_WHITESPACE"," ",414],["T_CONSTANT_ENCAPSED_STRING","'WITH ci_delete AS (SELECT TOP '",414],".",["T_VARIABLE","$this",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","qb_limit",414],".",["T_CONSTANT_ENCAPSED_STRING","' * FROM '",414],".",["T_VARIABLE","$table",414],".",["T_VARIABLE","$this",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","_compile_wh",414],"(",["T_CONSTANT_ENCAPSED_STRING","'qb_where'",414],")",".",["T_CONSTANT_ENCAPSED_STRING","') DELETE FROM ci_delete'",414],";",["T_WHITESPACE","\n\t\t",414],"}",["T_WHITESPACE","\n\n\t\t",415],["T_RETURN","return",417],["T_WHITESPACE"," ",417],["T_STRING","parent",417],["T_DOUBLE_COLON","::",417],["T_STRING","_delete",417],"(",["T_VARIABLE","$table",417],")",";",["T_WHITESPACE","\n\t",417],"}",["T_WHITESPACE","\n\n\t",418],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",420],["T_WHITESPACE","\n\t",421],["T_DOC_COMMENT","\/**\n\t * LIMIT\n\t *\n\t * Generates a platform-specific LIMIT clause\n\t *\n\t * @param\tstring\t$sql\tSQL Query\n\t * @return\tstring\n\t *\/",422],["T_WHITESPACE","\n\t",429],["T_PROTECTED","protected",430],["T_WHITESPACE"," ",430],["T_FUNCTION","function",430],["T_WHITESPACE"," ",430],["T_STRING","_limit",430],"(",["T_VARIABLE","$sql",430],")",["T_WHITESPACE","\n\t",430],"{",["T_WHITESPACE","\n\t\t",431],["T_VARIABLE","$limit",432],["T_WHITESPACE"," ",432],"=",["T_WHITESPACE"," ",432],["T_VARIABLE","$this",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","qb_offset",432],["T_WHITESPACE"," ",432],"+",["T_WHITESPACE"," ",432],["T_VARIABLE","$this",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","qb_limit",432],";",["T_WHITESPACE","\n\n\t\t",432],["T_COMMENT","\/\/ As of SQL Server 2005 (9.0.*) ROW_NUMBER() is supported,\n",434],["T_WHITESPACE","\t\t",435],["T_COMMENT","\/\/ however an ORDER BY clause is required for it to work\n",435],["T_WHITESPACE","\t\t",436],["T_IF","if",436],["T_WHITESPACE"," ",436],"(",["T_STRING","version_compare",436],"(",["T_VARIABLE","$this",436],["T_OBJECT_OPERATOR","->",436],["T_STRING","version",436],"(",")",",",["T_WHITESPACE"," ",436],["T_CONSTANT_ENCAPSED_STRING","'9'",436],",",["T_WHITESPACE"," ",436],["T_CONSTANT_ENCAPSED_STRING","'>='",436],")",["T_WHITESPACE"," ",436],["T_BOOLEAN_AND","&&",436],["T_WHITESPACE"," ",436],["T_VARIABLE","$this",436],["T_OBJECT_OPERATOR","->",436],["T_STRING","qb_offset",436],["T_WHITESPACE"," ",436],["T_BOOLEAN_AND","&&",436],["T_WHITESPACE"," ",436],"!",["T_WHITESPACE"," ",436],["T_EMPTY","empty",436],"(",["T_VARIABLE","$this",436],["T_OBJECT_OPERATOR","->",436],["T_STRING","qb_orderby",436],")",")",["T_WHITESPACE","\n\t\t",436],"{",["T_WHITESPACE","\n\t\t\t",437],["T_VARIABLE","$orderby",438],["T_WHITESPACE"," ",438],"=",["T_WHITESPACE"," ",438],["T_VARIABLE","$this",438],["T_OBJECT_OPERATOR","->",438],["T_STRING","_compile_order_by",438],"(",")",";",["T_WHITESPACE","\n\n\t\t\t",438],["T_COMMENT","\/\/ We have to strip the ORDER BY clause\n",440],["T_WHITESPACE","\t\t\t",441],["T_VARIABLE","$sql",441],["T_WHITESPACE"," ",441],"=",["T_WHITESPACE"," ",441],["T_STRING","trim",441],"(",["T_STRING","substr",441],"(",["T_VARIABLE","$sql",441],",",["T_WHITESPACE"," ",441],["T_LNUMBER","0",441],",",["T_WHITESPACE"," ",441],["T_STRING","strrpos",441],"(",["T_VARIABLE","$sql",441],",",["T_WHITESPACE"," ",441],["T_VARIABLE","$orderby",441],")",")",")",";",["T_WHITESPACE","\n\n\t\t\t",441],["T_COMMENT","\/\/ Get the fields to select from our subquery, so that we can avoid CI_rownum appearing in the actual results\n",443],["T_WHITESPACE","\t\t\t",444],["T_IF","if",444],["T_WHITESPACE"," ",444],"(",["T_STRING","count",444],"(",["T_VARIABLE","$this",444],["T_OBJECT_OPERATOR","->",444],["T_STRING","qb_select",444],")",["T_WHITESPACE"," ",444],["T_IS_IDENTICAL","===",444],["T_WHITESPACE"," ",444],["T_LNUMBER","0",444],")",["T_WHITESPACE","\n\t\t\t",444],"{",["T_WHITESPACE","\n\t\t\t\t",445],["T_VARIABLE","$select",446],["T_WHITESPACE"," ",446],"=",["T_WHITESPACE"," ",446],["T_CONSTANT_ENCAPSED_STRING","'*'",446],";",["T_WHITESPACE"," ",446],["T_COMMENT","\/\/ Inevitable\n",446],["T_WHITESPACE","\t\t\t",447],"}",["T_WHITESPACE","\n\t\t\t",447],["T_ELSE","else",448],["T_WHITESPACE","\n\t\t\t",448],"{",["T_WHITESPACE","\n\t\t\t\t",449],["T_COMMENT","\/\/ Use only field names and their aliases, everything else is out of our scope.\n",450],["T_WHITESPACE","\t\t\t\t",451],["T_VARIABLE","$select",451],["T_WHITESPACE"," ",451],"=",["T_WHITESPACE"," ",451],["T_ARRAY","array",451],"(",")",";",["T_WHITESPACE","\n\t\t\t\t",451],["T_VARIABLE","$field_regexp",452],["T_WHITESPACE"," ",452],"=",["T_WHITESPACE"," ",452],"(",["T_VARIABLE","$this",452],["T_OBJECT_OPERATOR","->",452],["T_STRING","_quoted_identifier",452],")",["T_WHITESPACE","\n\t\t\t\t\t",452],"?",["T_WHITESPACE"," ",453],["T_CONSTANT_ENCAPSED_STRING","'(\"[^\\\"]+\")'",453],["T_WHITESPACE"," ",453],":",["T_WHITESPACE"," ",453],["T_CONSTANT_ENCAPSED_STRING","'(\\[[^\\]]+\\])'",453],";",["T_WHITESPACE","\n\t\t\t\t",453],["T_FOR","for",454],["T_WHITESPACE"," ",454],"(",["T_VARIABLE","$i",454],["T_WHITESPACE"," ",454],"=",["T_WHITESPACE"," ",454],["T_LNUMBER","0",454],",",["T_WHITESPACE"," ",454],["T_VARIABLE","$c",454],["T_WHITESPACE"," ",454],"=",["T_WHITESPACE"," ",454],["T_STRING","count",454],"(",["T_VARIABLE","$this",454],["T_OBJECT_OPERATOR","->",454],["T_STRING","qb_select",454],")",";",["T_WHITESPACE"," ",454],["T_VARIABLE","$i",454],["T_WHITESPACE"," ",454],"<",["T_WHITESPACE"," ",454],["T_VARIABLE","$c",454],";",["T_WHITESPACE"," ",454],["T_VARIABLE","$i",454],["T_INC","++",454],")",["T_WHITESPACE","\n\t\t\t\t",454],"{",["T_WHITESPACE","\n\t\t\t\t\t",455],["T_VARIABLE","$select",456],"[","]",["T_WHITESPACE"," ",456],"=",["T_WHITESPACE"," ",456],["T_STRING","preg_match",456],"(",["T_CONSTANT_ENCAPSED_STRING","'\/(?:\\s|\\.)'",456],".",["T_VARIABLE","$field_regexp",456],".",["T_CONSTANT_ENCAPSED_STRING","'$\/i'",456],",",["T_WHITESPACE"," ",456],["T_VARIABLE","$this",456],["T_OBJECT_OPERATOR","->",456],["T_STRING","qb_select",456],"[",["T_VARIABLE","$i",456],"]",",",["T_WHITESPACE"," ",456],["T_VARIABLE","$m",456],")",["T_WHITESPACE","\n\t\t\t\t\t\t",456],"?",["T_WHITESPACE"," ",457],["T_VARIABLE","$m",457],"[",["T_LNUMBER","1",457],"]",["T_WHITESPACE"," ",457],":",["T_WHITESPACE"," ",457],["T_VARIABLE","$this",457],["T_OBJECT_OPERATOR","->",457],["T_STRING","qb_select",457],"[",["T_VARIABLE","$i",457],"]",";",["T_WHITESPACE","\n\t\t\t\t",457],"}",["T_WHITESPACE","\n\t\t\t\t",458],["T_VARIABLE","$select",459],["T_WHITESPACE"," ",459],"=",["T_WHITESPACE"," ",459],["T_STRING","implode",459],"(",["T_CONSTANT_ENCAPSED_STRING","', '",459],",",["T_WHITESPACE"," ",459],["T_VARIABLE","$select",459],")",";",["T_WHITESPACE","\n\t\t\t",459],"}",["T_WHITESPACE","\n\n\t\t\t",460],["T_RETURN","return",462],["T_WHITESPACE"," ",462],["T_CONSTANT_ENCAPSED_STRING","'SELECT '",462],".",["T_VARIABLE","$select",462],".",["T_CONSTANT_ENCAPSED_STRING","\" FROM (\\n\\n\"",462],["T_WHITESPACE","\n\t\t\t\t",462],".",["T_STRING","preg_replace",463],"(",["T_CONSTANT_ENCAPSED_STRING","'\/^(SELECT( DISTINCT)?)\/i'",463],",",["T_WHITESPACE"," ",463],["T_CONSTANT_ENCAPSED_STRING","'\\\\1 ROW_NUMBER() OVER('",463],".",["T_STRING","trim",463],"(",["T_VARIABLE","$orderby",463],")",".",["T_CONSTANT_ENCAPSED_STRING","') AS '",463],".",["T_VARIABLE","$this",463],["T_OBJECT_OPERATOR","->",463],["T_STRING","escape_identifiers",463],"(",["T_CONSTANT_ENCAPSED_STRING","'CI_rownum'",463],")",".",["T_CONSTANT_ENCAPSED_STRING","', '",463],",",["T_WHITESPACE"," ",463],["T_VARIABLE","$sql",463],")",["T_WHITESPACE","\n\t\t\t\t",463],".",["T_CONSTANT_ENCAPSED_STRING","\"\\n\\n) \"",464],".",["T_VARIABLE","$this",464],["T_OBJECT_OPERATOR","->",464],["T_STRING","escape_identifiers",464],"(",["T_CONSTANT_ENCAPSED_STRING","'CI_subquery'",464],")",["T_WHITESPACE","\n\t\t\t\t",464],".",["T_CONSTANT_ENCAPSED_STRING","\"\\nWHERE \"",465],".",["T_VARIABLE","$this",465],["T_OBJECT_OPERATOR","->",465],["T_STRING","escape_identifiers",465],"(",["T_CONSTANT_ENCAPSED_STRING","'CI_rownum'",465],")",".",["T_CONSTANT_ENCAPSED_STRING","' BETWEEN '",465],".","(",["T_VARIABLE","$this",465],["T_OBJECT_OPERATOR","->",465],["T_STRING","qb_offset",465],["T_WHITESPACE"," ",465],"+",["T_WHITESPACE"," ",465],["T_LNUMBER","1",465],")",".",["T_CONSTANT_ENCAPSED_STRING","' AND '",465],".",["T_VARIABLE","$limit",465],";",["T_WHITESPACE","\n\t\t",465],"}",["T_WHITESPACE","\n\n\t\t",466],["T_RETURN","return",468],["T_WHITESPACE"," ",468],["T_STRING","preg_replace",468],"(",["T_CONSTANT_ENCAPSED_STRING","'\/(^\\SELECT (DISTINCT)?)\/i'",468],",",["T_CONSTANT_ENCAPSED_STRING","'\\\\1 TOP '",468],".",["T_VARIABLE","$limit",468],".",["T_CONSTANT_ENCAPSED_STRING","' '",468],",",["T_WHITESPACE"," ",468],["T_VARIABLE","$sql",468],")",";",["T_WHITESPACE","\n\t",468],"}",["T_WHITESPACE","\n\n\t",469],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",471],["T_WHITESPACE","\n\t",472],["T_DOC_COMMENT","\/**\n\t * Insert batch statement\n\t *\n\t * Generates a platform-specific insert string from the supplied data.\n\t *\n\t * @param\tstring\t$table\tTable name\n\t * @param\tarray\t$keys\tINSERT keys\n\t * @param\tarray\t$values\tINSERT values\n\t * @return\tstring|bool\n\t *\/",473],["T_WHITESPACE","\n\t",482],["T_PROTECTED","protected",483],["T_WHITESPACE"," ",483],["T_FUNCTION","function",483],["T_WHITESPACE"," ",483],["T_STRING","_insert_batch",483],"(",["T_VARIABLE","$table",483],",",["T_WHITESPACE"," ",483],["T_VARIABLE","$keys",483],",",["T_WHITESPACE"," ",483],["T_VARIABLE","$values",483],")",["T_WHITESPACE","\n\t",483],"{",["T_WHITESPACE","\n\t\t",484],["T_COMMENT","\/\/ Multiple-value inserts are only supported as of SQL Server 2008\n",485],["T_WHITESPACE","\t\t",486],["T_IF","if",486],["T_WHITESPACE"," ",486],"(",["T_STRING","version_compare",486],"(",["T_VARIABLE","$this",486],["T_OBJECT_OPERATOR","->",486],["T_STRING","version",486],"(",")",",",["T_WHITESPACE"," ",486],["T_CONSTANT_ENCAPSED_STRING","'10'",486],",",["T_WHITESPACE"," ",486],["T_CONSTANT_ENCAPSED_STRING","'>='",486],")",")",["T_WHITESPACE","\n\t\t",486],"{",["T_WHITESPACE","\n\t\t\t",487],["T_RETURN","return",488],["T_WHITESPACE"," ",488],["T_STRING","parent",488],["T_DOUBLE_COLON","::",488],["T_STRING","_insert_batch",488],"(",["T_VARIABLE","$table",488],",",["T_WHITESPACE"," ",488],["T_VARIABLE","$keys",488],",",["T_WHITESPACE"," ",488],["T_VARIABLE","$values",488],")",";",["T_WHITESPACE","\n\t\t",488],"}",["T_WHITESPACE","\n\n\t\t",489],["T_RETURN","return",491],["T_WHITESPACE"," ",491],"(",["T_VARIABLE","$this",491],["T_OBJECT_OPERATOR","->",491],["T_STRING","db",491],["T_OBJECT_OPERATOR","->",491],["T_STRING","db_debug",491],")",["T_WHITESPACE"," ",491],"?",["T_WHITESPACE"," ",491],["T_VARIABLE","$this",491],["T_OBJECT_OPERATOR","->",491],["T_STRING","db",491],["T_OBJECT_OPERATOR","->",491],["T_STRING","display_error",491],"(",["T_CONSTANT_ENCAPSED_STRING","'db_unsupported_feature'",491],")",["T_WHITESPACE"," ",491],":",["T_WHITESPACE"," ",491],["T_STRING","FALSE",491],";",["T_WHITESPACE","\n\t",491],"}",["T_WHITESPACE","\n\n\t",492],["T_COMMENT","\/\/ --------------------------------------------------------------------\n",494],["T_WHITESPACE","\n\t",495],["T_DOC_COMMENT","\/**\n\t * Close DB Connection\n\t *\n\t * @return\tvoid\n\t *\/",496],["T_WHITESPACE","\n\t",500],["T_PROTECTED","protected",501],["T_WHITESPACE"," ",501],["T_FUNCTION","function",501],["T_WHITESPACE"," ",501],["T_STRING","_close",501],"(",")",["T_WHITESPACE","\n\t",501],"{",["T_WHITESPACE","\n\t\t",502],["T_STRING","mssql_close",503],"(",["T_VARIABLE","$this",503],["T_OBJECT_OPERATOR","->",503],["T_STRING","conn_id",503],")",";",["T_WHITESPACE","\n\t",503],"}",["T_WHITESPACE","\n\n",504],"}",["T_WHITESPACE","\n",506]]