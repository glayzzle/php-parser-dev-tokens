[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Setup",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","App",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Filesystem",8],["T_NS_SEPARATOR","\\",8],["T_STRING","DirectoryList",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Filesystem",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Setup",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Model",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Cron",10],["T_NS_SEPARATOR","\\",10],["T_STRING","ReadinessCheck",10],";",["T_WHITESPACE","\n\n",10],["T_DOC_COMMENT","\/**\n * This class is used by Readiness check page to verify if Setup cron command\n * and Updater cron script are running properly.\n * This includes verifying file permission in Updater Cron and db privileges in Setup Cron.\n * It also verifies Cron time interval configuration.\n * This class only verifies the status files created by both Cron jobs. No actual checking logic is done in this class.\n *\/",12],["T_WHITESPACE","\n",18],["T_CLASS","class",19],["T_WHITESPACE"," ",19],["T_STRING","CronScriptReadinessCheck",19],["T_WHITESPACE","\n",19],"{",["T_WHITESPACE","\n    ",20],["T_DOC_COMMENT","\/**\n     * Setup type\n     *\/",21],["T_WHITESPACE","\n    ",23],["T_CONST","const",24],["T_WHITESPACE"," ",24],["T_STRING","SETUP",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","'setup'",24],";",["T_WHITESPACE","\n\n    ",24],["T_DOC_COMMENT","\/**\n     * Updater type\n     *\/",26],["T_WHITESPACE","\n    ",28],["T_CONST","const",29],["T_WHITESPACE"," ",29],["T_STRING","UPDATER",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_CONSTANT_ENCAPSED_STRING","'updater'",29],";",["T_WHITESPACE","\n\n    ",29],["T_DOC_COMMENT","\/**\n     * Basename to Updater status file\n     *\/",31],["T_WHITESPACE","\n    ",33],["T_CONST","const",34],["T_WHITESPACE"," ",34],["T_STRING","UPDATER_CRON_JOB_STATS_FILE",34],["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","'.update_cronjob_status'",34],";",["T_WHITESPACE","\n\n    ",34],["T_DOC_COMMENT","\/**\n     * Key in Updater status file\n     *\/",36],["T_WHITESPACE","\n    ",38],["T_CONST","const",39],["T_WHITESPACE"," ",39],["T_STRING","UPDATER_KEY_FILE_PERMISSIONS_VERIFIED",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'file_permissions_verified'",39],";",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * Error message for dependant checks\n     *\/",41],["T_WHITESPACE","\n    ",43],["T_CONST","const",44],["T_WHITESPACE"," ",44],["T_STRING","OTHER_CHECKS_WILL_FAIL_MSG",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE","\n        ",44],["T_CONSTANT_ENCAPSED_STRING","'<br\/>Other checks will fail as a result (PHP version, PHP settings, and PHP extensions)'",45],";",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * @var Filesystem\n     *\/",47],["T_WHITESPACE","\n    ",49],["T_PRIVATE","private",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$filesystem",50],";",["T_WHITESPACE","\n\n    ",50],["T_DOC_COMMENT","\/**\n     * Constructor\n     *\n     * @param Filesystem $filesystem\n     *\/",52],["T_WHITESPACE","\n    ",56],["T_PUBLIC","public",57],["T_WHITESPACE"," ",57],["T_FUNCTION","function",57],["T_WHITESPACE"," ",57],["T_STRING","__construct",57],"(",["T_STRING","Filesystem",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$filesystem",57],")",["T_WHITESPACE","\n    ",57],"{",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","filesystem",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$filesystem",59],";",["T_WHITESPACE","\n    ",59],"}",["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * Check Setup Cron job status file\n     *\n     * @return array\n     *\/",62],["T_WHITESPACE","\n    ",66],["T_PUBLIC","public",67],["T_WHITESPACE"," ",67],["T_FUNCTION","function",67],["T_WHITESPACE"," ",67],["T_STRING","checkSetup",67],"(",")",["T_WHITESPACE","\n    ",67],"{",["T_WHITESPACE","\n        ",68],["T_RETURN","return",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","checkJson",69],"(",["T_STRING","self",69],["T_DOUBLE_COLON","::",69],["T_STRING","SETUP",69],")",";",["T_WHITESPACE","\n    ",69],"}",["T_WHITESPACE","\n\n    ",70],["T_DOC_COMMENT","\/**\n     * Check Updater Cron job status file\n     *\n     * @return array\n     *\/",72],["T_WHITESPACE","\n    ",76],["T_PUBLIC","public",77],["T_WHITESPACE"," ",77],["T_FUNCTION","function",77],["T_WHITESPACE"," ",77],["T_STRING","checkUpdater",77],"(",")",["T_WHITESPACE","\n    ",77],"{",["T_WHITESPACE","\n        ",78],["T_RETURN","return",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","checkJson",79],"(",["T_STRING","self",79],["T_DOUBLE_COLON","::",79],["T_STRING","UPDATER",79],")",";",["T_WHITESPACE","\n    ",79],"}",["T_WHITESPACE","\n\n    ",80],["T_DOC_COMMENT","\/**\n     * Check JSON file created by Setup cron command and Updater cron script\n     *\n     * @param string $type\n     * @return array\n     *\/",82],["T_WHITESPACE","\n    ",87],["T_PRIVATE","private",88],["T_WHITESPACE"," ",88],["T_FUNCTION","function",88],["T_WHITESPACE"," ",88],["T_STRING","checkJson",88],"(",["T_VARIABLE","$type",88],")",["T_WHITESPACE","\n    ",88],"{",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$read",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","filesystem",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","getDirectoryRead",90],"(",["T_STRING","DirectoryList",90],["T_DOUBLE_COLON","::",90],["T_STRING","VAR_DIR",90],")",";",["T_WHITESPACE","\n        ",90],["T_TRY","try",91],["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n            ",91],["T_SWITCH","switch",92],["T_WHITESPACE"," ",92],"(",["T_VARIABLE","$type",92],")",["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n                ",92],["T_CASE","case",93],["T_WHITESPACE"," ",93],["T_STRING","self",93],["T_DOUBLE_COLON","::",93],["T_STRING","SETUP",93],":",["T_WHITESPACE","\n                    ",93],["T_VARIABLE","$key",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_STRING","ReadinessCheck",94],["T_DOUBLE_COLON","::",94],["T_STRING","KEY_DB_WRITE_PERMISSION_VERIFIED",94],";",["T_WHITESPACE","\n                    ",94],["T_VARIABLE","$jsonData",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_STRING","json_decode",95],"(",["T_VARIABLE","$read",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","readFile",95],"(",["T_STRING","ReadinessCheck",95],["T_DOUBLE_COLON","::",95],["T_STRING","SETUP_CRON_JOB_STATUS_FILE",95],")",",",["T_WHITESPACE"," ",95],["T_STRING","true",95],")",";",["T_WHITESPACE","\n                    ",95],["T_BREAK","break",96],";",["T_WHITESPACE","\n                ",96],["T_CASE","case",97],["T_WHITESPACE"," ",97],["T_STRING","self",97],["T_DOUBLE_COLON","::",97],["T_STRING","UPDATER",97],":",["T_WHITESPACE","\n                    ",97],["T_VARIABLE","$key",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_STRING","self",98],["T_DOUBLE_COLON","::",98],["T_STRING","UPDATER_KEY_FILE_PERMISSIONS_VERIFIED",98],";",["T_WHITESPACE","\n                    ",98],["T_VARIABLE","$jsonData",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_STRING","json_decode",99],"(",["T_VARIABLE","$read",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","readFile",99],"(",["T_STRING","self",99],["T_DOUBLE_COLON","::",99],["T_STRING","UPDATER_CRON_JOB_STATS_FILE",99],")",",",["T_WHITESPACE"," ",99],["T_STRING","true",99],")",";",["T_WHITESPACE","\n                    ",99],["T_BREAK","break",100],";",["T_WHITESPACE","\n                ",100],["T_DEFAULT","default",101],":",["T_WHITESPACE","\n                    ",101],["T_RETURN","return",102],["T_WHITESPACE"," ",102],"[",["T_CONSTANT_ENCAPSED_STRING","'success'",102],["T_WHITESPACE"," ",102],["T_DOUBLE_ARROW","=>",102],["T_WHITESPACE"," ",102],["T_STRING","false",102],",",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'error'",102],["T_WHITESPACE"," ",102],["T_DOUBLE_ARROW","=>",102],["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'Internal Error'",102],"]",";",["T_WHITESPACE","\n            ",102],"}",["T_WHITESPACE","\n        ",103],"}",["T_WHITESPACE"," ",104],["T_CATCH","catch",104],["T_WHITESPACE"," ",104],"(",["T_NS_SEPARATOR","\\",104],["T_STRING","Magento",104],["T_NS_SEPARATOR","\\",104],["T_STRING","Framework",104],["T_NS_SEPARATOR","\\",104],["T_STRING","Exception",104],["T_NS_SEPARATOR","\\",104],["T_STRING","FileSystemException",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$e",104],")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n            ",104],["T_VARIABLE","$error",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'Cron job has not been configured yet'",105],";",["T_WHITESPACE","\n            ",105],["T_IF","if",106],["T_WHITESPACE"," ",106],"(",["T_VARIABLE","$type",106],["T_WHITESPACE"," ",106],["T_IS_EQUAL","==",106],["T_WHITESPACE"," ",106],["T_STRING","self",106],["T_DOUBLE_COLON","::",106],["T_STRING","SETUP",106],")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n                ",106],["T_VARIABLE","$error",107],["T_WHITESPACE"," ",107],["T_CONCAT_EQUAL",".=",107],["T_WHITESPACE"," ",107],["T_STRING","self",107],["T_DOUBLE_COLON","::",107],["T_STRING","OTHER_CHECKS_WILL_FAIL_MSG",107],";",["T_WHITESPACE","\n            ",107],"}",["T_WHITESPACE","\n            ",108],["T_RETURN","return",109],["T_WHITESPACE"," ",109],"[",["T_WHITESPACE","\n                ",109],["T_CONSTANT_ENCAPSED_STRING","'success'",110],["T_WHITESPACE"," ",110],["T_DOUBLE_ARROW","=>",110],["T_WHITESPACE"," ",110],["T_STRING","false",110],",",["T_WHITESPACE","\n                ",110],["T_CONSTANT_ENCAPSED_STRING","'error'",111],["T_WHITESPACE"," ",111],["T_DOUBLE_ARROW","=>",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$error",111],["T_WHITESPACE","\n            ",111],"]",";",["T_WHITESPACE","\n        ",112],"}",["T_WHITESPACE","\n\n        ",113],["T_IF","if",115],["T_WHITESPACE"," ",115],"(",["T_ISSET","isset",115],"(",["T_VARIABLE","$jsonData",115],"[",["T_STRING","ReadinessCheck",115],["T_DOUBLE_COLON","::",115],["T_STRING","KEY_READINESS_CHECKS",115],"]",")",["T_WHITESPACE","\n            ",115],["T_BOOLEAN_AND","&&",116],["T_WHITESPACE"," ",116],["T_ISSET","isset",116],"(",["T_VARIABLE","$jsonData",116],"[",["T_STRING","ReadinessCheck",116],["T_DOUBLE_COLON","::",116],["T_STRING","KEY_READINESS_CHECKS",116],"]","[",["T_VARIABLE","$key",116],"]",")",["T_WHITESPACE","\n        ",116],")",["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n            ",117],["T_IF","if",118],["T_WHITESPACE"," ",118],"(",["T_VARIABLE","$jsonData",118],"[",["T_STRING","ReadinessCheck",118],["T_DOUBLE_COLON","::",118],["T_STRING","KEY_READINESS_CHECKS",118],"]","[",["T_VARIABLE","$key",118],"]",")",["T_WHITESPACE"," ",118],"{",["T_WHITESPACE","\n                ",118],["T_RETURN","return",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","checkCronTime",119],"(",["T_VARIABLE","$jsonData",119],")",";",["T_WHITESPACE","\n            ",119],"}",["T_WHITESPACE","\n            ",120],["T_RETURN","return",121],["T_WHITESPACE"," ",121],"[",["T_CONSTANT_ENCAPSED_STRING","'success'",121],["T_WHITESPACE"," ",121],["T_DOUBLE_ARROW","=>",121],["T_WHITESPACE"," ",121],["T_STRING","false",121],",",["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","'error'",121],["T_WHITESPACE"," ",121],["T_DOUBLE_ARROW","=>",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$jsonData",121],"[",["T_STRING","ReadinessCheck",121],["T_DOUBLE_COLON","::",121],["T_STRING","KEY_READINESS_CHECKS",121],"]","[",["T_CONSTANT_ENCAPSED_STRING","'error'",121],"]","]",";",["T_WHITESPACE","\n        ",121],"}",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$error",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'Cron job has not been configured yet'",123],";",["T_WHITESPACE","\n        ",123],["T_IF","if",124],["T_WHITESPACE"," ",124],"(",["T_VARIABLE","$type",124],["T_WHITESPACE"," ",124],["T_IS_EQUAL","==",124],["T_WHITESPACE"," ",124],["T_STRING","self",124],["T_DOUBLE_COLON","::",124],["T_STRING","SETUP",124],")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n            ",124],["T_VARIABLE","$error",125],["T_WHITESPACE"," ",125],["T_CONCAT_EQUAL",".=",125],["T_WHITESPACE"," ",125],["T_STRING","self",125],["T_DOUBLE_COLON","::",125],["T_STRING","OTHER_CHECKS_WILL_FAIL_MSG",125],";",["T_WHITESPACE","\n        ",125],"}",["T_WHITESPACE","\n        ",126],["T_RETURN","return",127],["T_WHITESPACE"," ",127],"[",["T_WHITESPACE","\n            ",127],["T_CONSTANT_ENCAPSED_STRING","'success'",128],["T_WHITESPACE"," ",128],["T_DOUBLE_ARROW","=>",128],["T_WHITESPACE"," ",128],["T_STRING","false",128],",",["T_WHITESPACE","\n            ",128],["T_CONSTANT_ENCAPSED_STRING","'error'",129],["T_WHITESPACE"," ",129],["T_DOUBLE_ARROW","=>",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$error",129],["T_WHITESPACE","\n        ",129],"]",";",["T_WHITESPACE","\n    ",130],"}",["T_WHITESPACE","\n\n    ",131],["T_DOC_COMMENT","\/**\n     * Check if Cron Job time interval is within acceptable range\n     *\n     * @param array $jsonData\n     * @return array\n     *\/",133],["T_WHITESPACE","\n    ",138],["T_PRIVATE","private",139],["T_WHITESPACE"," ",139],["T_FUNCTION","function",139],["T_WHITESPACE"," ",139],["T_STRING","checkCronTime",139],"(",["T_ARRAY","array",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$jsonData",139],")",["T_WHITESPACE","\n    ",139],"{",["T_WHITESPACE","\n        ",140],["T_IF","if",141],["T_WHITESPACE"," ",141],"(",["T_ISSET","isset",141],"(",["T_VARIABLE","$jsonData",141],"[",["T_STRING","ReadinessCheck",141],["T_DOUBLE_COLON","::",141],["T_STRING","KEY_CURRENT_TIMESTAMP",141],"]",")",["T_WHITESPACE","\n            ",141],["T_BOOLEAN_AND","&&",142],["T_WHITESPACE"," ",142],["T_ISSET","isset",142],"(",["T_VARIABLE","$jsonData",142],"[",["T_STRING","ReadinessCheck",142],["T_DOUBLE_COLON","::",142],["T_STRING","KEY_LAST_TIMESTAMP",142],"]",")",["T_WHITESPACE","\n        ",142],")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n            ",143],["T_VARIABLE","$timeDifference",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_VARIABLE","$jsonData",144],"[",["T_STRING","ReadinessCheck",144],["T_DOUBLE_COLON","::",144],["T_STRING","KEY_CURRENT_TIMESTAMP",144],"]",["T_WHITESPACE"," ",144],"-",["T_WHITESPACE","\n                ",144],["T_VARIABLE","$jsonData",145],"[",["T_STRING","ReadinessCheck",145],["T_DOUBLE_COLON","::",145],["T_STRING","KEY_LAST_TIMESTAMP",145],"]",";",["T_WHITESPACE","\n            ",145],["T_IF","if",146],["T_WHITESPACE"," ",146],"(",["T_VARIABLE","$timeDifference",146],["T_WHITESPACE"," ",146],"<",["T_WHITESPACE"," ",146],["T_LNUMBER","90",146],")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n                ",146],["T_RETURN","return",147],["T_WHITESPACE"," ",147],"[",["T_CONSTANT_ENCAPSED_STRING","'success'",147],["T_WHITESPACE"," ",147],["T_DOUBLE_ARROW","=>",147],["T_WHITESPACE"," ",147],["T_STRING","true",147],"]",";",["T_WHITESPACE","\n            ",147],"}",["T_WHITESPACE","\n            ",148],["T_RETURN","return",149],["T_WHITESPACE"," ",149],"[",["T_WHITESPACE","\n                ",149],["T_CONSTANT_ENCAPSED_STRING","'success'",150],["T_WHITESPACE"," ",150],["T_DOUBLE_ARROW","=>",150],["T_WHITESPACE"," ",150],["T_STRING","true",150],",",["T_WHITESPACE","\n                ",150],["T_CONSTANT_ENCAPSED_STRING","'notice'",151],["T_WHITESPACE"," ",151],["T_DOUBLE_ARROW","=>",151],["T_WHITESPACE"," ",151],["T_CONSTANT_ENCAPSED_STRING","'We recommend you schedule cron to run every 1 minute'",151],["T_WHITESPACE","\n            ",151],"]",";",["T_WHITESPACE","\n        ",152],"}",["T_WHITESPACE","\n        ",153],["T_RETURN","return",154],["T_WHITESPACE"," ",154],"[",["T_WHITESPACE","\n            ",154],["T_CONSTANT_ENCAPSED_STRING","'success'",155],["T_WHITESPACE"," ",155],["T_DOUBLE_ARROW","=>",155],["T_WHITESPACE"," ",155],["T_STRING","true",155],",",["T_WHITESPACE","\n            ",155],["T_CONSTANT_ENCAPSED_STRING","'notice'",156],["T_WHITESPACE"," ",156],["T_DOUBLE_ARROW","=>",156],["T_WHITESPACE"," ",156],["T_CONSTANT_ENCAPSED_STRING","'Unable to determine cron time interval. '",156],["T_WHITESPACE"," ",156],".",["T_WHITESPACE","\n                ",156],["T_CONSTANT_ENCAPSED_STRING","'We recommend you schedule cron to run every 1 minute'",157],["T_WHITESPACE","\n        ",157],"]",";",["T_WHITESPACE","\n    ",158],"}",["T_WHITESPACE","\n",159],"}",["T_WHITESPACE","\n",160]]