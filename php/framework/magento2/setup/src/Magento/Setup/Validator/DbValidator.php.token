[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Setup",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Validator",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Config",9],["T_NS_SEPARATOR","\\",9],["T_STRING","ConfigOptionsListConstants",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Setup",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Model",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Installer",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Setup",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Module",11],["T_NS_SEPARATOR","\\",11],["T_STRING","ConnectionFactory",11],";",["T_WHITESPACE","\n\n",11],["T_DOC_COMMENT","\/**\n * Class DbValidator - validates DB related settings\n *\/",13],["T_WHITESPACE","\n",15],["T_CLASS","class",16],["T_WHITESPACE"," ",16],["T_STRING","DbValidator",16],["T_WHITESPACE","\n",16],"{",["T_WHITESPACE","\n\n    ",17],["T_DOC_COMMENT","\/**\n     * Db prefix max length\n     *\/",19],["T_WHITESPACE","\n    ",21],["T_CONST","const",22],["T_WHITESPACE"," ",22],["T_STRING","DB_PREFIX_LENGTH",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_LNUMBER","5",22],";",["T_WHITESPACE","\n\n    ",22],["T_DOC_COMMENT","\/**\n     * DB connection factory\n     *\n     * @var ConnectionFactory\n     *\/",24],["T_WHITESPACE","\n    ",28],["T_PRIVATE","private",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$connectionFactory",29],";",["T_WHITESPACE","\n\n    ",29],["T_DOC_COMMENT","\/**\n     * Constructor\n     *\n     * @param ConnectionFactory $connectionFactory\n     *\/",31],["T_WHITESPACE","\n    ",35],["T_PUBLIC","public",36],["T_WHITESPACE"," ",36],["T_FUNCTION","function",36],["T_WHITESPACE"," ",36],["T_STRING","__construct",36],"(",["T_STRING","ConnectionFactory",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$connectionFactory",36],")",["T_WHITESPACE","\n    ",36],"{",["T_WHITESPACE","\n        ",37],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","connectionFactory",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_VARIABLE","$connectionFactory",38],";",["T_WHITESPACE","\n    ",38],"}",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * Check if database table prefix is valid\n     *\n     * @param string $prefix\n     * @return boolean\n     * @throws \\InvalidArgumentException\n     *\/",41],["T_WHITESPACE","\n    ",47],["T_PUBLIC","public",48],["T_WHITESPACE"," ",48],["T_FUNCTION","function",48],["T_WHITESPACE"," ",48],["T_STRING","checkDatabaseTablePrefix",48],"(",["T_VARIABLE","$prefix",48],")",["T_WHITESPACE","\n    ",48],"{",["T_WHITESPACE","\n        ",49],["T_COMMENT","\/\/The table prefix should contain only letters (a-z), numbers (0-9) or underscores (_);\n",50],["T_WHITESPACE","        ",51],["T_COMMENT","\/\/ the first character should be a letter.\n",51],["T_WHITESPACE","        ",52],["T_IF","if",52],["T_WHITESPACE"," ",52],"(",["T_VARIABLE","$prefix",52],["T_WHITESPACE"," ",52],["T_IS_NOT_IDENTICAL","!==",52],["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","''",52],["T_WHITESPACE"," ",52],["T_BOOLEAN_AND","&&",52],["T_WHITESPACE"," ",52],"!",["T_STRING","preg_match",52],"(",["T_CONSTANT_ENCAPSED_STRING","'\/^([a-zA-Z])([[:alnum:]_]+)$\/'",52],",",["T_WHITESPACE"," ",52],["T_VARIABLE","$prefix",52],")",")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n            ",52],["T_THROW","throw",53],["T_WHITESPACE"," ",53],["T_NEW","new",53],["T_WHITESPACE"," ",53],["T_NS_SEPARATOR","\\",53],["T_STRING","InvalidArgumentException",53],"(",["T_WHITESPACE","\n                ",53],["T_CONSTANT_ENCAPSED_STRING","'Please correct the table prefix format, should contain only numbers, letters or underscores.'",54],["T_WHITESPACE","\n                ",54],".",["T_CONSTANT_ENCAPSED_STRING","' The first character should be a letter.'",55],["T_WHITESPACE","\n            ",55],")",";",["T_WHITESPACE","\n        ",56],"}",["T_WHITESPACE","\n\n        ",57],["T_IF","if",59],["T_WHITESPACE"," ",59],"(",["T_STRING","strlen",59],"(",["T_VARIABLE","$prefix",59],")",["T_WHITESPACE"," ",59],">",["T_WHITESPACE"," ",59],["T_STRING","self",59],["T_DOUBLE_COLON","::",59],["T_STRING","DB_PREFIX_LENGTH",59],")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n            ",59],["T_THROW","throw",60],["T_WHITESPACE"," ",60],["T_NEW","new",60],["T_WHITESPACE"," ",60],["T_NS_SEPARATOR","\\",60],["T_STRING","InvalidArgumentException",60],"(",["T_WHITESPACE","\n                ",60],["T_CONSTANT_ENCAPSED_STRING","'Table prefix length can\\'t be more than '",61],["T_WHITESPACE"," ",61],".",["T_WHITESPACE"," ",61],["T_STRING","self",61],["T_DOUBLE_COLON","::",61],["T_STRING","DB_PREFIX_LENGTH",61],["T_WHITESPACE"," ",61],".",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","' characters.'",61],["T_WHITESPACE","\n            ",61],")",";",["T_WHITESPACE","\n        ",62],"}",["T_WHITESPACE","\n\n        ",63],["T_RETURN","return",65],["T_WHITESPACE"," ",65],["T_STRING","true",65],";",["T_WHITESPACE","\n    ",65],"}",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * Checks Database Connection\n     *\n     * @param string $dbName\n     * @param string $dbHost\n     * @param string $dbUser\n     * @param string $dbPass\n     * @return boolean\n     * @throws \\Magento\\Setup\\Exception\n     *\/",68],["T_WHITESPACE","\n    ",77],["T_PUBLIC","public",78],["T_WHITESPACE"," ",78],["T_FUNCTION","function",78],["T_WHITESPACE"," ",78],["T_STRING","checkDatabaseConnection",78],"(",["T_VARIABLE","$dbName",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$dbHost",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$dbUser",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$dbPass",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","''",78],")",["T_WHITESPACE","\n    ",78],"{",["T_WHITESPACE","\n        ",79],["T_COMMENT","\/\/ establish connection to information_schema view to retrieve information about user and table privileges\n",80],["T_WHITESPACE","        ",81],["T_VARIABLE","$connection",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","connectionFactory",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","create",81],"(","[",["T_WHITESPACE","\n            ",81],["T_STRING","ConfigOptionsListConstants",82],["T_DOUBLE_COLON","::",82],["T_STRING","KEY_NAME",82],["T_WHITESPACE"," ",82],["T_DOUBLE_ARROW","=>",82],["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'information_schema'",82],",",["T_WHITESPACE","\n            ",82],["T_STRING","ConfigOptionsListConstants",83],["T_DOUBLE_COLON","::",83],["T_STRING","KEY_HOST",83],["T_WHITESPACE"," ",83],["T_DOUBLE_ARROW","=>",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$dbHost",83],",",["T_WHITESPACE","\n            ",83],["T_STRING","ConfigOptionsListConstants",84],["T_DOUBLE_COLON","::",84],["T_STRING","KEY_USER",84],["T_WHITESPACE"," ",84],["T_DOUBLE_ARROW","=>",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$dbUser",84],",",["T_WHITESPACE","\n            ",84],["T_STRING","ConfigOptionsListConstants",85],["T_DOUBLE_COLON","::",85],["T_STRING","KEY_PASSWORD",85],["T_WHITESPACE"," ",85],["T_DOUBLE_ARROW","=>",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$dbPass",85],",",["T_WHITESPACE","\n            ",85],["T_STRING","ConfigOptionsListConstants",86],["T_DOUBLE_COLON","::",86],["T_STRING","KEY_ACTIVE",86],["T_WHITESPACE"," ",86],["T_DOUBLE_ARROW","=>",86],["T_WHITESPACE"," ",86],["T_STRING","true",86],",",["T_WHITESPACE","\n        ",86],"]",")",";",["T_WHITESPACE","\n\n        ",87],["T_IF","if",89],["T_WHITESPACE"," ",89],"(","!",["T_VARIABLE","$connection",89],")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n            ",89],["T_THROW","throw",90],["T_WHITESPACE"," ",90],["T_NEW","new",90],["T_WHITESPACE"," ",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Magento",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Setup",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Exception",90],"(",["T_CONSTANT_ENCAPSED_STRING","'Database connection failure.'",90],")",";",["T_WHITESPACE","\n        ",90],"}",["T_WHITESPACE","\n\n        ",91],["T_VARIABLE","$mysqlVersion",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$connection",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","fetchOne",93],"(",["T_CONSTANT_ENCAPSED_STRING","'SELECT version()'",93],")",";",["T_WHITESPACE","\n        ",93],["T_IF","if",94],["T_WHITESPACE"," ",94],"(",["T_VARIABLE","$mysqlVersion",94],")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n            ",94],["T_IF","if",95],["T_WHITESPACE"," ",95],"(",["T_STRING","preg_match",95],"(",["T_CONSTANT_ENCAPSED_STRING","'\/^([0-9\\.]+)\/'",95],",",["T_WHITESPACE"," ",95],["T_VARIABLE","$mysqlVersion",95],",",["T_WHITESPACE"," ",95],["T_VARIABLE","$matches",95],")",")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n                ",95],["T_IF","if",96],["T_WHITESPACE"," ",96],"(",["T_ISSET","isset",96],"(",["T_VARIABLE","$matches",96],"[",["T_LNUMBER","1",96],"]",")",["T_WHITESPACE"," ",96],["T_BOOLEAN_AND","&&",96],["T_WHITESPACE"," ",96],"!",["T_EMPTY","empty",96],"(",["T_VARIABLE","$matches",96],"[",["T_LNUMBER","1",96],"]",")",")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n                    ",96],["T_IF","if",97],["T_WHITESPACE"," ",97],"(",["T_STRING","version_compare",97],"(",["T_VARIABLE","$matches",97],"[",["T_LNUMBER","1",97],"]",",",["T_WHITESPACE"," ",97],["T_STRING","Installer",97],["T_DOUBLE_COLON","::",97],["T_STRING","MYSQL_VERSION_REQUIRED",97],")",["T_WHITESPACE"," ",97],"<",["T_WHITESPACE"," ",97],["T_LNUMBER","0",97],")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n                        ",97],["T_THROW","throw",98],["T_WHITESPACE"," ",98],["T_NEW","new",98],["T_WHITESPACE"," ",98],["T_NS_SEPARATOR","\\",98],["T_STRING","Magento",98],["T_NS_SEPARATOR","\\",98],["T_STRING","Setup",98],["T_NS_SEPARATOR","\\",98],["T_STRING","Exception",98],"(",["T_WHITESPACE","\n                            ",98],["T_CONSTANT_ENCAPSED_STRING","'Sorry, but we support MySQL version '",99],["T_WHITESPACE"," ",99],".",["T_WHITESPACE"," ",99],["T_STRING","Installer",99],["T_DOUBLE_COLON","::",99],["T_STRING","MYSQL_VERSION_REQUIRED",99],["T_WHITESPACE"," ",99],".",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","' or later.'",99],["T_WHITESPACE","\n                        ",99],")",";",["T_WHITESPACE","\n                    ",100],"}",["T_WHITESPACE","\n                ",101],"}",["T_WHITESPACE","\n            ",102],"}",["T_WHITESPACE","\n        ",103],"}",["T_WHITESPACE","\n\n        ",104],["T_RETURN","return",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","checkDatabaseName",106],"(",["T_VARIABLE","$connection",106],",",["T_WHITESPACE"," ",106],["T_VARIABLE","$dbName",106],")",["T_WHITESPACE"," ",106],["T_BOOLEAN_AND","&&",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","checkDatabasePrivileges",106],"(",["T_VARIABLE","$connection",106],",",["T_WHITESPACE"," ",106],["T_VARIABLE","$dbName",106],")",";",["T_WHITESPACE","\n    ",106],"}",["T_WHITESPACE","\n\n    ",107],["T_DOC_COMMENT","\/**\n     * Checks if specified database exists and visible to current user\n     *\n     * @param \\Magento\\Framework\\DB\\Adapter\\AdapterInterface $connection\n     * @param string $dbName\n     * @return bool\n     * @throws \\Magento\\Setup\\Exception\n     *\/",109],["T_WHITESPACE","\n    ",116],["T_PRIVATE","private",117],["T_WHITESPACE"," ",117],["T_FUNCTION","function",117],["T_WHITESPACE"," ",117],["T_STRING","checkDatabaseName",117],"(",["T_NS_SEPARATOR","\\",117],["T_STRING","Magento",117],["T_NS_SEPARATOR","\\",117],["T_STRING","Framework",117],["T_NS_SEPARATOR","\\",117],["T_STRING","DB",117],["T_NS_SEPARATOR","\\",117],["T_STRING","Adapter",117],["T_NS_SEPARATOR","\\",117],["T_STRING","AdapterInterface",117],["T_WHITESPACE"," ",117],["T_VARIABLE","$connection",117],",",["T_WHITESPACE"," ",117],["T_VARIABLE","$dbName",117],")",["T_WHITESPACE","\n    ",117],"{",["T_WHITESPACE","\n        ",118],["T_VARIABLE","$query",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_CONSTANT_ENCAPSED_STRING","\"SHOW DATABASES\"",119],";",["T_WHITESPACE","\n        ",119],["T_VARIABLE","$accessibleDbs",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_VARIABLE","$connection",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","query",120],"(",["T_VARIABLE","$query",120],")",["T_OBJECT_OPERATOR","->",120],["T_STRING","fetchAll",120],"(",["T_NS_SEPARATOR","\\",120],["T_STRING","PDO",120],["T_DOUBLE_COLON","::",120],["T_STRING","FETCH_COLUMN",120],",",["T_WHITESPACE"," ",120],["T_LNUMBER","0",120],")",";",["T_WHITESPACE","\n        ",120],["T_FOREACH","foreach",121],["T_WHITESPACE"," ",121],"(",["T_VARIABLE","$accessibleDbs",121],["T_WHITESPACE"," ",121],["T_AS","as",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$accessibleDbName",121],")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n            ",121],["T_IF","if",122],["T_WHITESPACE"," ",122],"(",["T_VARIABLE","$dbName",122],["T_WHITESPACE"," ",122],["T_IS_EQUAL","==",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$accessibleDbName",122],")",["T_WHITESPACE"," ",122],"{",["T_WHITESPACE","\n                ",122],["T_RETURN","return",123],["T_WHITESPACE"," ",123],["T_STRING","true",123],";",["T_WHITESPACE","\n            ",123],"}",["T_WHITESPACE","\n        ",124],"}",["T_WHITESPACE","\n        ",125],["T_THROW","throw",126],["T_WHITESPACE"," ",126],["T_NEW","new",126],["T_WHITESPACE"," ",126],["T_NS_SEPARATOR","\\",126],["T_STRING","Magento",126],["T_NS_SEPARATOR","\\",126],["T_STRING","Setup",126],["T_NS_SEPARATOR","\\",126],["T_STRING","Exception",126],"(",["T_WHITESPACE","\n            ",126],"\"",["T_ENCAPSED_AND_WHITESPACE","Database '",127],["T_CURLY_OPEN","{",127],["T_VARIABLE","$dbName",127],"}",["T_ENCAPSED_AND_WHITESPACE","' does not exist ",127],"\"",["T_WHITESPACE","\n            ",127],".",["T_CONSTANT_ENCAPSED_STRING","\"or specified database server user does not have privileges to access this database.\"",128],["T_WHITESPACE","\n        ",128],")",";",["T_WHITESPACE","\n    ",129],"}",["T_WHITESPACE","\n\n    ",130],["T_DOC_COMMENT","\/**\n     * Checks database privileges\n     *\n     * @param \\Magento\\Framework\\DB\\Adapter\\AdapterInterface $connection\n     * @param string $dbName\n     * @return bool\n     * @throws \\Magento\\Setup\\Exception\n     *\/",132],["T_WHITESPACE","\n    ",139],["T_PRIVATE","private",140],["T_WHITESPACE"," ",140],["T_FUNCTION","function",140],["T_WHITESPACE"," ",140],["T_STRING","checkDatabasePrivileges",140],"(",["T_NS_SEPARATOR","\\",140],["T_STRING","Magento",140],["T_NS_SEPARATOR","\\",140],["T_STRING","Framework",140],["T_NS_SEPARATOR","\\",140],["T_STRING","DB",140],["T_NS_SEPARATOR","\\",140],["T_STRING","Adapter",140],["T_NS_SEPARATOR","\\",140],["T_STRING","AdapterInterface",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$connection",140],",",["T_WHITESPACE"," ",140],["T_VARIABLE","$dbName",140],")",["T_WHITESPACE","\n    ",140],"{",["T_WHITESPACE","\n        ",141],["T_VARIABLE","$requiredPrivileges",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],"[",["T_WHITESPACE","\n            ",142],["T_CONSTANT_ENCAPSED_STRING","'SELECT'",143],",",["T_WHITESPACE","\n            ",143],["T_CONSTANT_ENCAPSED_STRING","'INSERT'",144],",",["T_WHITESPACE","\n            ",144],["T_CONSTANT_ENCAPSED_STRING","'UPDATE'",145],",",["T_WHITESPACE","\n            ",145],["T_CONSTANT_ENCAPSED_STRING","'DELETE'",146],",",["T_WHITESPACE","\n            ",146],["T_CONSTANT_ENCAPSED_STRING","'CREATE'",147],",",["T_WHITESPACE","\n            ",147],["T_CONSTANT_ENCAPSED_STRING","'DROP'",148],",",["T_WHITESPACE","\n            ",148],["T_CONSTANT_ENCAPSED_STRING","'REFERENCES'",149],",",["T_WHITESPACE","\n            ",149],["T_CONSTANT_ENCAPSED_STRING","'INDEX'",150],",",["T_WHITESPACE","\n            ",150],["T_CONSTANT_ENCAPSED_STRING","'ALTER'",151],",",["T_WHITESPACE","\n            ",151],["T_CONSTANT_ENCAPSED_STRING","'CREATE TEMPORARY TABLES'",152],",",["T_WHITESPACE","\n            ",152],["T_CONSTANT_ENCAPSED_STRING","'LOCK TABLES'",153],",",["T_WHITESPACE","\n            ",153],["T_CONSTANT_ENCAPSED_STRING","'EXECUTE'",154],",",["T_WHITESPACE","\n            ",154],["T_CONSTANT_ENCAPSED_STRING","'CREATE VIEW'",155],",",["T_WHITESPACE","\n            ",155],["T_CONSTANT_ENCAPSED_STRING","'SHOW VIEW'",156],",",["T_WHITESPACE","\n            ",156],["T_CONSTANT_ENCAPSED_STRING","'CREATE ROUTINE'",157],",",["T_WHITESPACE","\n            ",157],["T_CONSTANT_ENCAPSED_STRING","'ALTER ROUTINE'",158],",",["T_WHITESPACE","\n            ",158],["T_CONSTANT_ENCAPSED_STRING","'EVENT'",159],",",["T_WHITESPACE","\n            ",159],["T_CONSTANT_ENCAPSED_STRING","'TRIGGER'",160],["T_WHITESPACE","\n        ",160],"]",";",["T_WHITESPACE","\n\n        ",161],["T_COMMENT","\/\/ check global privileges\n",163],["T_WHITESPACE","        ",164],["T_VARIABLE","$userPrivilegesQuery",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","\"SELECT PRIVILEGE_TYPE FROM USER_PRIVILEGES \"",164],["T_WHITESPACE","\n            ",164],".",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","\"WHERE REPLACE(GRANTEE, '\\'', '') = current_user()\"",165],";",["T_WHITESPACE","\n        ",165],["T_VARIABLE","$grantInfo",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_VARIABLE","$connection",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","query",166],"(",["T_VARIABLE","$userPrivilegesQuery",166],")",["T_OBJECT_OPERATOR","->",166],["T_STRING","fetchAll",166],"(",["T_NS_SEPARATOR","\\",166],["T_STRING","PDO",166],["T_DOUBLE_COLON","::",166],["T_STRING","FETCH_NUM",166],")",";",["T_WHITESPACE","\n        ",166],["T_IF","if",167],["T_WHITESPACE"," ",167],"(",["T_EMPTY","empty",167],"(",["T_STRING","array_diff",167],"(",["T_VARIABLE","$requiredPrivileges",167],",",["T_WHITESPACE"," ",167],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","parseGrantInfo",167],"(",["T_VARIABLE","$grantInfo",167],")",")",")",")",["T_WHITESPACE"," ",167],"{",["T_WHITESPACE","\n            ",167],["T_RETURN","return",168],["T_WHITESPACE"," ",168],["T_STRING","true",168],";",["T_WHITESPACE","\n        ",168],"}",["T_WHITESPACE","\n\n        ",169],["T_COMMENT","\/\/ check table privileges\n",171],["T_WHITESPACE","        ",172],["T_VARIABLE","$schemaPrivilegesQuery",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_CONSTANT_ENCAPSED_STRING","\"SELECT PRIVILEGE_TYPE FROM SCHEMA_PRIVILEGES \"",172],["T_WHITESPACE"," ",172],".",["T_WHITESPACE","\n            ",172],"\"",["T_ENCAPSED_AND_WHITESPACE","WHERE '",173],["T_VARIABLE","$dbName",173],["T_ENCAPSED_AND_WHITESPACE","' LIKE TABLE_SCHEMA AND REPLACE(GRANTEE, '\\'', '') = current_user()",173],"\"",";",["T_WHITESPACE","\n        ",173],["T_VARIABLE","$grantInfo",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_VARIABLE","$connection",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","query",174],"(",["T_VARIABLE","$schemaPrivilegesQuery",174],")",["T_OBJECT_OPERATOR","->",174],["T_STRING","fetchAll",174],"(",["T_NS_SEPARATOR","\\",174],["T_STRING","PDO",174],["T_DOUBLE_COLON","::",174],["T_STRING","FETCH_NUM",174],")",";",["T_WHITESPACE","\n        ",174],["T_IF","if",175],["T_WHITESPACE"," ",175],"(",["T_EMPTY","empty",175],"(",["T_STRING","array_diff",175],"(",["T_VARIABLE","$requiredPrivileges",175],",",["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","parseGrantInfo",175],"(",["T_VARIABLE","$grantInfo",175],")",")",")",")",["T_WHITESPACE"," ",175],"{",["T_WHITESPACE","\n            ",175],["T_RETURN","return",176],["T_WHITESPACE"," ",176],["T_STRING","true",176],";",["T_WHITESPACE","\n        ",176],"}",["T_WHITESPACE","\n\n        ",177],["T_VARIABLE","$errorMessage",179],["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_CONSTANT_ENCAPSED_STRING","'Database user does not have enough privileges. Please make sure '",179],["T_WHITESPACE","\n            ",179],".",["T_WHITESPACE"," ",180],["T_STRING","implode",180],"(",["T_CONSTANT_ENCAPSED_STRING","', '",180],",",["T_WHITESPACE"," ",180],["T_VARIABLE","$requiredPrivileges",180],")",["T_WHITESPACE"," ",180],".",["T_WHITESPACE"," ",180],"\"",["T_ENCAPSED_AND_WHITESPACE"," privileges are granted to table '",180],["T_CURLY_OPEN","{",180],["T_VARIABLE","$dbName",180],"}",["T_ENCAPSED_AND_WHITESPACE","'.",180],"\"",";",["T_WHITESPACE","\n        ",180],["T_THROW","throw",181],["T_WHITESPACE"," ",181],["T_NEW","new",181],["T_WHITESPACE"," ",181],["T_NS_SEPARATOR","\\",181],["T_STRING","Magento",181],["T_NS_SEPARATOR","\\",181],["T_STRING","Setup",181],["T_NS_SEPARATOR","\\",181],["T_STRING","Exception",181],"(",["T_VARIABLE","$errorMessage",181],")",";",["T_WHITESPACE","\n    ",181],"}",["T_WHITESPACE","\n\n    ",182],["T_DOC_COMMENT","\/**\n     * Parses query result\n     *\n     * @param array $grantInfo\n     * @return array\n     *\/",184],["T_WHITESPACE","\n    ",189],["T_PRIVATE","private",190],["T_WHITESPACE"," ",190],["T_FUNCTION","function",190],["T_WHITESPACE"," ",190],["T_STRING","parseGrantInfo",190],"(",["T_ARRAY","array",190],["T_WHITESPACE"," ",190],["T_VARIABLE","$grantInfo",190],")",["T_WHITESPACE","\n    ",190],"{",["T_WHITESPACE","\n        ",191],["T_VARIABLE","$result",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],"[","]",";",["T_WHITESPACE","\n        ",192],["T_FOREACH","foreach",193],["T_WHITESPACE"," ",193],"(",["T_VARIABLE","$grantInfo",193],["T_WHITESPACE"," ",193],["T_AS","as",193],["T_WHITESPACE"," ",193],["T_VARIABLE","$grantRow",193],")",["T_WHITESPACE"," ",193],"{",["T_WHITESPACE","\n            ",193],["T_VARIABLE","$result",194],"[","]",["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],["T_VARIABLE","$grantRow",194],"[",["T_LNUMBER","0",194],"]",";",["T_WHITESPACE","\n        ",194],"}",["T_WHITESPACE","\n        ",195],["T_RETURN","return",196],["T_WHITESPACE"," ",196],["T_VARIABLE","$result",196],";",["T_WHITESPACE","\n    ",196],"}",["T_WHITESPACE","\n",197],"}",["T_WHITESPACE","\n",198]]