[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Framework",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Xml",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","DOMDocument",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Phrase",9],";",["T_WHITESPACE","\n\n",9],["T_DOC_COMMENT","\/**\n * Class Security\n *\/",11],["T_WHITESPACE","\n",13],["T_CLASS","class",14],["T_WHITESPACE"," ",14],["T_STRING","Security",14],["T_WHITESPACE","\n",14],"{",["T_WHITESPACE","\n    ",15],["T_DOC_COMMENT","\/**\n     * Heuristic scan to detect entity in XML\n     *\n     * @param string $xmlContent\n     * @return bool\n     *\/",16],["T_WHITESPACE","\n    ",21],["T_PRIVATE","private",22],["T_WHITESPACE"," ",22],["T_FUNCTION","function",22],["T_WHITESPACE"," ",22],["T_STRING","heuristicScan",22],"(",["T_VARIABLE","$xmlContent",22],")",["T_WHITESPACE","\n    ",22],"{",["T_WHITESPACE","\n        ",23],["T_RETURN","return",24],["T_WHITESPACE"," ",24],["T_STRING","strpos",24],"(",["T_VARIABLE","$xmlContent",24],",",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","'<!ENTITY'",24],")",["T_WHITESPACE"," ",24],["T_IS_IDENTICAL","===",24],["T_WHITESPACE"," ",24],["T_STRING","false",24],";",["T_WHITESPACE","\n    ",24],"}",["T_WHITESPACE","\n\n    ",25],["T_DOC_COMMENT","\/**\n     * Return true if PHP is running with PHP-FPM\n     *\n     * @return bool\n     *\/",27],["T_WHITESPACE","\n    ",31],["T_PRIVATE","private",32],["T_WHITESPACE"," ",32],["T_FUNCTION","function",32],["T_WHITESPACE"," ",32],["T_STRING","isPhpFpm",32],"(",")",["T_WHITESPACE","\n    ",32],"{",["T_WHITESPACE","\n        ",33],["T_RETURN","return",34],["T_WHITESPACE"," ",34],["T_STRING","substr",34],"(",["T_STRING","php_sapi_name",34],"(",")",",",["T_WHITESPACE"," ",34],["T_LNUMBER","0",34],",",["T_WHITESPACE"," ",34],["T_LNUMBER","3",34],")",["T_WHITESPACE"," ",34],["T_IS_IDENTICAL","===",34],["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","'fpm'",34],";",["T_WHITESPACE","\n    ",34],"}",["T_WHITESPACE","\n\n    ",35],["T_DOC_COMMENT","\/**\n     * Security check loaded XML document\n     *\n     * @param string $xmlContent\n     * @return bool\n     *\n     * @SuppressWarnings(PHPMD.UnusedLocalVariable)\n     *\/",37],["T_WHITESPACE","\n    ",44],["T_PUBLIC","public",45],["T_WHITESPACE"," ",45],["T_FUNCTION","function",45],["T_WHITESPACE"," ",45],["T_STRING","scan",45],"(",["T_VARIABLE","$xmlContent",45],")",["T_WHITESPACE","\n    ",45],"{",["T_WHITESPACE","\n        ",46],["T_DOC_COMMENT","\/**\n         * If running with PHP-FPM we perform an heuristic scan\n         * We cannot use libxml_disable_entity_loader because of this bug\n         * @see https:\/\/bugs.php.net\/bug.php?id=64938\n         *\/",47],["T_WHITESPACE","\n        ",51],["T_IF","if",52],["T_WHITESPACE"," ",52],"(",["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","isPhpFpm",52],"(",")",")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n            ",52],["T_RETURN","return",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","heuristicScan",53],"(",["T_VARIABLE","$xmlContent",53],")",";",["T_WHITESPACE","\n        ",53],"}",["T_WHITESPACE","\n\n        ",54],["T_VARIABLE","$document",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_NEW","new",56],["T_WHITESPACE"," ",56],["T_STRING","DOMDocument",56],"(",")",";",["T_WHITESPACE","\n\n        ",56],["T_VARIABLE","$loadEntities",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_STRING","libxml_disable_entity_loader",58],"(",["T_STRING","true",58],")",";",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$useInternalXmlErrors",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_STRING","libxml_use_internal_errors",59],"(",["T_STRING","true",59],")",";",["T_WHITESPACE","\n\n        ",59],["T_DOC_COMMENT","\/**\n         * Load XML with network access disabled (LIBXML_NONET)\n         * error disabled with @ for PHP-FPM scenario\n         *\/",61],["T_WHITESPACE","\n        ",64],["T_STRING","set_error_handler",65],"(",["T_WHITESPACE","\n            ",65],["T_FUNCTION","function",66],["T_WHITESPACE"," ",66],"(",["T_VARIABLE","$errno",66],",",["T_WHITESPACE"," ",66],["T_VARIABLE","$errstr",66],")",["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n                ",66],["T_IF","if",67],["T_WHITESPACE"," ",67],"(",["T_STRING","substr_count",67],"(",["T_VARIABLE","$errstr",67],",",["T_WHITESPACE"," ",67],["T_CONSTANT_ENCAPSED_STRING","'DOMDocument::loadXML()'",67],")",["T_WHITESPACE"," ",67],">",["T_WHITESPACE"," ",67],["T_LNUMBER","0",67],")",["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n                    ",67],["T_RETURN","return",68],["T_WHITESPACE"," ",68],["T_STRING","true",68],";",["T_WHITESPACE","\n                ",68],"}",["T_WHITESPACE","\n                ",69],["T_RETURN","return",70],["T_WHITESPACE"," ",70],["T_STRING","false",70],";",["T_WHITESPACE","\n            ",70],"}",",",["T_WHITESPACE","\n            ",71],["T_STRING","E_WARNING",72],["T_WHITESPACE","\n        ",72],")",";",["T_WHITESPACE","\n\n        ",73],["T_VARIABLE","$result",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_BOOL_CAST","(bool)",75],["T_VARIABLE","$document",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","loadXml",75],"(",["T_VARIABLE","$xmlContent",75],",",["T_WHITESPACE"," ",75],["T_STRING","LIBXML_NONET",75],")",";",["T_WHITESPACE","\n        ",75],["T_STRING","restore_error_handler",76],"(",")",";",["T_WHITESPACE","\n        ",76],["T_COMMENT","\/\/ Entity load to previous setting\n",77],["T_WHITESPACE","        ",78],["T_STRING","libxml_disable_entity_loader",78],"(",["T_VARIABLE","$loadEntities",78],")",";",["T_WHITESPACE","\n        ",78],["T_STRING","libxml_use_internal_errors",79],"(",["T_VARIABLE","$useInternalXmlErrors",79],")",";",["T_WHITESPACE","\n\n        ",79],["T_IF","if",81],["T_WHITESPACE"," ",81],"(","!",["T_VARIABLE","$result",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n            ",81],["T_RETURN","return",82],["T_WHITESPACE"," ",82],["T_STRING","false",82],";",["T_WHITESPACE","\n        ",82],"}",["T_WHITESPACE","\n\n        ",83],["T_FOREACH","foreach",85],["T_WHITESPACE"," ",85],"(",["T_VARIABLE","$document",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","childNodes",85],["T_WHITESPACE"," ",85],["T_AS","as",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$child",85],")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n            ",85],["T_IF","if",86],["T_WHITESPACE"," ",86],"(",["T_VARIABLE","$child",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","nodeType",86],["T_WHITESPACE"," ",86],["T_IS_IDENTICAL","===",86],["T_WHITESPACE"," ",86],["T_STRING","XML_DOCUMENT_TYPE_NODE",86],")",["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n                ",86],["T_IF","if",87],["T_WHITESPACE"," ",87],"(",["T_VARIABLE","$child",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","entities",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","length",87],["T_WHITESPACE"," ",87],">",["T_WHITESPACE"," ",87],["T_LNUMBER","0",87],")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n                    ",87],["T_RETURN","return",88],["T_WHITESPACE"," ",88],["T_STRING","false",88],";",["T_WHITESPACE","\n                ",88],"}",["T_WHITESPACE","\n            ",89],"}",["T_WHITESPACE","\n        ",90],"}",["T_WHITESPACE","\n\n        ",91],["T_RETURN","return",93],["T_WHITESPACE"," ",93],["T_STRING","true",93],";",["T_WHITESPACE","\n    ",93],"}",["T_WHITESPACE","\n",94],"}",["T_WHITESPACE","\n",95]]