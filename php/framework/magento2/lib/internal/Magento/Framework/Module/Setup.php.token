[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Base Resource Setup Model\n *\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",7],["T_NAMESPACE","namespace",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Module",8],";",["T_WHITESPACE","\n\n",8],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Setup",10],["T_NS_SEPARATOR","\\",10],["T_STRING","ModuleDataSetupInterface",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Framework",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Setup",11],["T_NS_SEPARATOR","\\",11],["T_STRING","SetupInterface",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Framework",12],["T_NS_SEPARATOR","\\",12],["T_STRING","App",12],["T_NS_SEPARATOR","\\",12],["T_STRING","ResourceConnection",12],";",["T_WHITESPACE","\n\n",12],["T_CLASS","class",14],["T_WHITESPACE"," ",14],["T_STRING","Setup",14],["T_WHITESPACE"," ",14],["T_IMPLEMENTS","implements",14],["T_WHITESPACE"," ",14],["T_STRING","SetupInterface",14],["T_WHITESPACE","\n",14],"{",["T_WHITESPACE","\n    ",15],["T_DOC_COMMENT","\/**\n     * Setup Connection\n     *\n     * @var \\Magento\\Framework\\DB\\Adapter\\AdapterInterface\n     *\/",16],["T_WHITESPACE","\n    ",20],["T_PRIVATE","private",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$connection",21],["T_WHITESPACE"," ",21],"=",["T_WHITESPACE"," ",21],["T_STRING","null",21],";",["T_WHITESPACE","\n\n    ",21],["T_DOC_COMMENT","\/**\n     * Tables cache array\n     *\n     * @var array\n     *\/",23],["T_WHITESPACE","\n    ",27],["T_PRIVATE","private",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$tables",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],"[","]",";",["T_WHITESPACE","\n\n    ",28],["T_DOC_COMMENT","\/**\n     * Modules configuration\n     *\n     * @var \\Magento\\Framework\\App\\ResourceConnection\n     *\/",30],["T_WHITESPACE","\n    ",34],["T_PRIVATE","private",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$resourceModel",35],";",["T_WHITESPACE","\n\n    ",35],["T_DOC_COMMENT","\/**\n     * Connection instance name\n     *\n     * @var string\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PRIVATE","private",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$connectionName",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Init\n     *\n     * @param \\Magento\\Framework\\App\\ResourceConnection $resource\n     * @param string $connectionName\n     *\/",44],["T_WHITESPACE","\n    ",49],["T_PUBLIC","public",50],["T_WHITESPACE"," ",50],["T_FUNCTION","function",50],["T_WHITESPACE"," ",50],["T_STRING","__construct",50],"(",["T_WHITESPACE","\n        ",50],["T_NS_SEPARATOR","\\",51],["T_STRING","Magento",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Framework",51],["T_NS_SEPARATOR","\\",51],["T_STRING","App",51],["T_NS_SEPARATOR","\\",51],["T_STRING","ResourceConnection",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$resource",51],",",["T_WHITESPACE","\n        ",51],["T_VARIABLE","$connectionName",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_STRING","ModuleDataSetupInterface",52],["T_DOUBLE_COLON","::",52],["T_STRING","DEFAULT_SETUP_CONNECTION",52],["T_WHITESPACE","\n    ",52],")",["T_WHITESPACE"," ",53],"{",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","resourceModel",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$resource",54],";",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","connectionName",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_VARIABLE","$connectionName",55],";",["T_WHITESPACE","\n    ",55],"}",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * Get connection object\n     *\n     * @param string|null $connectionName\n     * @return \\Magento\\Framework\\DB\\Adapter\\AdapterInterface\n     *\/",58],["T_WHITESPACE","\n    ",63],["T_PUBLIC","public",64],["T_WHITESPACE"," ",64],["T_FUNCTION","function",64],["T_WHITESPACE"," ",64],["T_STRING","getConnection",64],"(",["T_VARIABLE","$connectionName",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_STRING","null",64],")",["T_WHITESPACE","\n    ",64],"{",["T_WHITESPACE","\n        ",65],["T_IF","if",66],["T_WHITESPACE"," ",66],"(",["T_VARIABLE","$connectionName",66],["T_WHITESPACE"," ",66],["T_IS_NOT_IDENTICAL","!==",66],["T_WHITESPACE"," ",66],["T_STRING","null",66],")",["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n            ",66],["T_TRY","try",67],["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n                ",67],["T_RETURN","return",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","resourceModel",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","getConnectionByName",68],"(",["T_VARIABLE","$connectionName",68],")",";",["T_WHITESPACE","\n            ",68],"}",["T_WHITESPACE"," ",69],["T_CATCH","catch",69],["T_WHITESPACE"," ",69],"(",["T_NS_SEPARATOR","\\",69],["T_STRING","DomainException",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$exception",69],")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n                ",69],["T_COMMENT","\/\/Fallback to default connection\n",70],["T_WHITESPACE","            ",71],"}",["T_WHITESPACE","\n        ",71],"}",["T_WHITESPACE","\n        ",72],["T_RETURN","return",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","getDefaultConnection",73],"(",")",";",["T_WHITESPACE","\n    ",73],"}",["T_WHITESPACE","\n\n    ",74],["T_DOC_COMMENT","\/**\n     * Returns default setup connection instance\n     *\n     * @return \\Magento\\Framework\\DB\\Adapter\\AdapterInterface\n     *\/",76],["T_WHITESPACE","\n    ",80],["T_PRIVATE","private",81],["T_WHITESPACE"," ",81],["T_FUNCTION","function",81],["T_WHITESPACE"," ",81],["T_STRING","getDefaultConnection",81],"(",")",["T_WHITESPACE","\n    ",81],"{",["T_WHITESPACE","\n        ",82],["T_IF","if",83],["T_WHITESPACE"," ",83],"(",["T_STRING","null",83],["T_WHITESPACE"," ",83],["T_IS_IDENTICAL","===",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","connection",83],")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n            ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","connection",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","resourceModel",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getConnection",84],"(",["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","connectionName",84],")",";",["T_WHITESPACE","\n        ",84],"}",["T_WHITESPACE","\n        ",85],["T_RETURN","return",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","connection",86],";",["T_WHITESPACE","\n    ",86],"}",["T_WHITESPACE","\n\n    ",87],["T_DOC_COMMENT","\/**\n     * Add table placeholder\/table name relation\n     *\n     * @param string $tableName\n     * @param string $realTableName\n     * @return $this\n     *\/",89],["T_WHITESPACE","\n    ",95],["T_PUBLIC","public",96],["T_WHITESPACE"," ",96],["T_FUNCTION","function",96],["T_WHITESPACE"," ",96],["T_STRING","setTable",96],"(",["T_VARIABLE","$tableName",96],",",["T_WHITESPACE"," ",96],["T_VARIABLE","$realTableName",96],")",["T_WHITESPACE","\n    ",96],"{",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","tables",98],"[",["T_VARIABLE","$tableName",98],"]",["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$realTableName",98],";",["T_WHITESPACE","\n        ",98],["T_RETURN","return",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$this",99],";",["T_WHITESPACE","\n    ",99],"}",["T_WHITESPACE","\n\n    ",100],["T_DOC_COMMENT","\/**\n     * Gets table placeholder by table name\n     *\n     * @param string $tableName\n     * @return string\n     *\/",102],["T_WHITESPACE","\n    ",107],["T_PUBLIC","public",108],["T_WHITESPACE"," ",108],["T_FUNCTION","function",108],["T_WHITESPACE"," ",108],["T_STRING","getTablePlaceholder",108],"(",["T_VARIABLE","$tableName",108],")",["T_WHITESPACE","\n    ",108],"{",["T_WHITESPACE","\n        ",109],["T_RETURN","return",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","resourceModel",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getTablePlaceholder",110],"(",["T_VARIABLE","$tableName",110],")",";",["T_WHITESPACE","\n    ",110],"}",["T_WHITESPACE","\n\n    ",111],["T_DOC_COMMENT","\/**\n     * Get table name (validated by db adapter) by table placeholder\n     *\n     * @param string|array $tableName\n     * @param string $connectionName\n     * @return string\n     *\/",113],["T_WHITESPACE","\n    ",119],["T_PUBLIC","public",120],["T_WHITESPACE"," ",120],["T_FUNCTION","function",120],["T_WHITESPACE"," ",120],["T_STRING","getTable",120],"(",["T_VARIABLE","$tableName",120],",",["T_WHITESPACE"," ",120],["T_VARIABLE","$connectionName",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_STRING","ResourceConnection",120],["T_DOUBLE_COLON","::",120],["T_STRING","DEFAULT_CONNECTION",120],")",["T_WHITESPACE","\n    ",120],"{",["T_WHITESPACE","\n        ",121],["T_VARIABLE","$cacheKey",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","_getTableCacheName",122],"(",["T_VARIABLE","$tableName",122],")",";",["T_WHITESPACE","\n        ",122],["T_IF","if",123],["T_WHITESPACE"," ",123],"(","!",["T_ISSET","isset",123],"(",["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","tables",123],"[",["T_VARIABLE","$cacheKey",123],"]",")",")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n            ",123],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","tables",124],"[",["T_VARIABLE","$cacheKey",124],"]",["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","resourceModel",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","getTableName",124],"(",["T_VARIABLE","$tableName",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$connectionName",124],")",";",["T_WHITESPACE","\n        ",124],"}",["T_WHITESPACE","\n        ",125],["T_RETURN","return",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","tables",126],"[",["T_VARIABLE","$cacheKey",126],"]",";",["T_WHITESPACE","\n    ",126],"}",["T_WHITESPACE","\n\n    ",127],["T_DOC_COMMENT","\/**\n     * Retrieve table name for cache\n     *\n     * @param string|array $tableName\n     * @return string\n     *\/",129],["T_WHITESPACE","\n    ",134],["T_PRIVATE","private",135],["T_WHITESPACE"," ",135],["T_FUNCTION","function",135],["T_WHITESPACE"," ",135],["T_STRING","_getTableCacheName",135],"(",["T_VARIABLE","$tableName",135],")",["T_WHITESPACE","\n    ",135],"{",["T_WHITESPACE","\n        ",136],["T_IF","if",137],["T_WHITESPACE"," ",137],"(",["T_STRING","is_array",137],"(",["T_VARIABLE","$tableName",137],")",")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n            ",137],["T_RETURN","return",138],["T_WHITESPACE"," ",138],["T_STRING","join",138],"(",["T_CONSTANT_ENCAPSED_STRING","'_'",138],",",["T_WHITESPACE"," ",138],["T_VARIABLE","$tableName",138],")",";",["T_WHITESPACE","\n        ",138],"}",["T_WHITESPACE","\n        ",139],["T_RETURN","return",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$tableName",140],";",["T_WHITESPACE","\n    ",140],"}",["T_WHITESPACE","\n\n    ",141],["T_DOC_COMMENT","\/**\n     * Check is table exists\n     *\n     * @param string $table\n     * @param string $connectionName\n     * @return bool\n     *\/",143],["T_WHITESPACE","\n    ",149],["T_PUBLIC","public",150],["T_WHITESPACE"," ",150],["T_FUNCTION","function",150],["T_WHITESPACE"," ",150],["T_STRING","tableExists",150],"(",["T_VARIABLE","$table",150],",",["T_WHITESPACE"," ",150],["T_VARIABLE","$connectionName",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_STRING","ResourceConnection",150],["T_DOUBLE_COLON","::",150],["T_STRING","DEFAULT_CONNECTION",150],")",["T_WHITESPACE","\n    ",150],"{",["T_WHITESPACE","\n        ",151],["T_VARIABLE","$table",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","getTable",152],"(",["T_VARIABLE","$table",152],",",["T_WHITESPACE"," ",152],["T_VARIABLE","$connectionName",152],")",";",["T_WHITESPACE","\n        ",152],["T_RETURN","return",153],["T_WHITESPACE"," ",153],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","getConnection",153],"(",["T_VARIABLE","$connectionName",153],")",["T_OBJECT_OPERATOR","->",153],["T_STRING","isTableExists",153],"(",["T_VARIABLE","$table",153],")",";",["T_WHITESPACE","\n    ",153],"}",["T_WHITESPACE","\n\n    ",154],["T_DOC_COMMENT","\/**\n     * Run plain SQL query(ies)\n     *\n     * @param string $sql\n     * @return $this\n     *\/",156],["T_WHITESPACE","\n    ",161],["T_PUBLIC","public",162],["T_WHITESPACE"," ",162],["T_FUNCTION","function",162],["T_WHITESPACE"," ",162],["T_STRING","run",162],"(",["T_VARIABLE","$sql",162],")",["T_WHITESPACE","\n    ",162],"{",["T_WHITESPACE","\n        ",163],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","getConnection",164],"(",")",["T_OBJECT_OPERATOR","->",164],["T_STRING","query",164],"(",["T_VARIABLE","$sql",164],")",";",["T_WHITESPACE","\n        ",164],["T_RETURN","return",165],["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],";",["T_WHITESPACE","\n    ",165],"}",["T_WHITESPACE","\n\n    ",166],["T_DOC_COMMENT","\/**\n     * Prepare database before install\/upgrade\n     *\n     * @return $this\n     *\/",168],["T_WHITESPACE","\n    ",172],["T_PUBLIC","public",173],["T_WHITESPACE"," ",173],["T_FUNCTION","function",173],["T_WHITESPACE"," ",173],["T_STRING","startSetup",173],"(",")",["T_WHITESPACE","\n    ",173],"{",["T_WHITESPACE","\n        ",174],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","getConnection",175],"(",")",["T_OBJECT_OPERATOR","->",175],["T_STRING","startSetup",175],"(",")",";",["T_WHITESPACE","\n        ",175],["T_RETURN","return",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$this",176],";",["T_WHITESPACE","\n    ",176],"}",["T_WHITESPACE","\n\n    ",177],["T_DOC_COMMENT","\/**\n     * Prepare database after install\/upgrade\n     *\n     * @return $this\n     *\/",179],["T_WHITESPACE","\n    ",183],["T_PUBLIC","public",184],["T_WHITESPACE"," ",184],["T_FUNCTION","function",184],["T_WHITESPACE"," ",184],["T_STRING","endSetup",184],"(",")",["T_WHITESPACE","\n    ",184],"{",["T_WHITESPACE","\n        ",185],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","getConnection",186],"(",")",["T_OBJECT_OPERATOR","->",186],["T_STRING","endSetup",186],"(",")",";",["T_WHITESPACE","\n        ",186],["T_RETURN","return",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$this",187],";",["T_WHITESPACE","\n    ",187],"}",["T_WHITESPACE","\n",188],"}",["T_WHITESPACE","\n",189]]