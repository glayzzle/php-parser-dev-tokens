[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_COMMENT","\/\/ @codingStandardsIgnoreFile\n",7],["T_WHITESPACE","\n",8],["T_NAMESPACE","namespace",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Module",9],";",["T_WHITESPACE","\n\n",9],["T_DOC_COMMENT","\/**\n * Resource Model\n *\/",11],["T_WHITESPACE","\n",13],["T_CLASS","class",14],["T_WHITESPACE"," ",14],["T_STRING","ModuleResource",14],["T_WHITESPACE"," ",14],["T_EXTENDS","extends",14],["T_WHITESPACE"," ",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Framework",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Model",14],["T_NS_SEPARATOR","\\",14],["T_STRING","ResourceModel",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Db",14],["T_NS_SEPARATOR","\\",14],["T_STRING","AbstractDb",14],["T_WHITESPACE"," ",14],["T_IMPLEMENTS","implements",14],["T_WHITESPACE"," ",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Framework",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Module",14],["T_NS_SEPARATOR","\\",14],["T_STRING","ResourceInterface",14],["T_WHITESPACE","\n",14],"{",["T_WHITESPACE","\n    ",15],["T_DOC_COMMENT","\/**\n     * Database versions\n     *\n     * @var array\n     *\/",16],["T_WHITESPACE","\n    ",20],["T_PROTECTED","protected",21],["T_WHITESPACE"," ",21],["T_STATIC","static",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$schemaVersions",21],["T_WHITESPACE"," ",21],"=",["T_WHITESPACE"," ",21],["T_STRING","null",21],";",["T_WHITESPACE","\n\n    ",21],["T_DOC_COMMENT","\/**\n     * Resource data versions cache array\n     *\n     * @var array\n     *\/",23],["T_WHITESPACE","\n    ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_STATIC","static",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$dataVersions",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_STRING","null",28],";",["T_WHITESPACE","\n\n    ",28],["T_DOC_COMMENT","\/**\n     * Define main table\n     *\n     * @return void\n     *\/",30],["T_WHITESPACE","\n    ",34],["T_PROTECTED","protected",35],["T_WHITESPACE"," ",35],["T_FUNCTION","function",35],["T_WHITESPACE"," ",35],["T_STRING","_construct",35],"(",")",["T_WHITESPACE","\n    ",35],"{",["T_WHITESPACE","\n        ",36],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","_init",37],"(",["T_CONSTANT_ENCAPSED_STRING","'setup_module'",37],",",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'module'",37],")",";",["T_WHITESPACE","\n    ",37],"}",["T_WHITESPACE","\n\n    ",38],["T_DOC_COMMENT","\/**\n     * Fill static versions arrays.\n     * This routine fetches Db and Data versions of at once to optimize sql requests. However, when upgrading, it's\n     * possible that 'data' column will be created only after all Db installs are passed. So $neededType contains\n     * information on main purpose of calling this routine, and even when 'data' column is absent - it won't require\n     * reissuing new sql just to get 'db' version of module.\n     *\n     * @param string $needType Can be 'db' or 'data'\n     * @return $this\n     *\/",40],["T_WHITESPACE","\n    ",49],["T_PROTECTED","protected",50],["T_WHITESPACE"," ",50],["T_FUNCTION","function",50],["T_WHITESPACE"," ",50],["T_STRING","_loadVersion",50],"(",["T_VARIABLE","$needType",50],")",["T_WHITESPACE","\n    ",50],"{",["T_WHITESPACE","\n        ",51],["T_IF","if",52],["T_WHITESPACE"," ",52],"(",["T_VARIABLE","$needType",52],["T_WHITESPACE"," ",52],["T_IS_EQUAL","==",52],["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'db'",52],["T_WHITESPACE"," ",52],["T_BOOLEAN_AND","&&",52],["T_WHITESPACE"," ",52],["T_STRING","is_null",52],"(",["T_STRING","self",52],["T_DOUBLE_COLON","::",52],["T_VARIABLE","$schemaVersions",52],")",["T_WHITESPACE"," ",52],["T_BOOLEAN_OR","||",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$needType",52],["T_WHITESPACE"," ",52],["T_IS_EQUAL","==",52],["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'data'",52],["T_WHITESPACE"," ",52],["T_BOOLEAN_AND","&&",52],["T_WHITESPACE"," ",52],["T_STRING","is_null",52],"(",["T_STRING","self",52],["T_DOUBLE_COLON","::",52],["T_VARIABLE","$dataVersions",52],")",")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n            ",52],["T_STRING","self",53],["T_DOUBLE_COLON","::",53],["T_VARIABLE","$schemaVersions",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],"[","]",";",["T_WHITESPACE","\n            ",53],["T_COMMENT","\/\/ Db version column always exists\n",54],["T_WHITESPACE","            ",55],["T_STRING","self",55],["T_DOUBLE_COLON","::",55],["T_VARIABLE","$dataVersions",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","null",55],";",["T_WHITESPACE","\n            ",55],["T_COMMENT","\/\/ Data version array will be filled only if Data column exist\n",56],["T_WHITESPACE","\n            ",57],["T_IF","if",58],["T_WHITESPACE"," ",58],"(",["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","getConnection",58],"(",")",["T_OBJECT_OPERATOR","->",58],["T_STRING","isTableExists",58],"(",["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","getMainTable",58],"(",")",")",")",["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n                ",58],["T_VARIABLE","$select",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","getConnection",59],"(",")",["T_OBJECT_OPERATOR","->",59],["T_STRING","select",59],"(",")",["T_OBJECT_OPERATOR","->",59],["T_STRING","from",59],"(",["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","getMainTable",59],"(",")",",",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'*'",59],")",";",["T_WHITESPACE","\n                ",59],["T_VARIABLE","$rowset",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","getConnection",60],"(",")",["T_OBJECT_OPERATOR","->",60],["T_STRING","fetchAll",60],"(",["T_VARIABLE","$select",60],")",";",["T_WHITESPACE","\n                ",60],["T_FOREACH","foreach",61],["T_WHITESPACE"," ",61],"(",["T_VARIABLE","$rowset",61],["T_WHITESPACE"," ",61],["T_AS","as",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$row",61],")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n                    ",61],["T_STRING","self",62],["T_DOUBLE_COLON","::",62],["T_VARIABLE","$schemaVersions",62],"[",["T_VARIABLE","$row",62],"[",["T_CONSTANT_ENCAPSED_STRING","'module'",62],"]","]",["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_VARIABLE","$row",62],"[",["T_CONSTANT_ENCAPSED_STRING","'schema_version'",62],"]",";",["T_WHITESPACE","\n                    ",62],["T_IF","if",63],["T_WHITESPACE"," ",63],"(",["T_STRING","array_key_exists",63],"(",["T_CONSTANT_ENCAPSED_STRING","'data_version'",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$row",63],")",")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n                        ",63],["T_IF","if",64],["T_WHITESPACE"," ",64],"(",["T_STRING","is_null",64],"(",["T_STRING","self",64],["T_DOUBLE_COLON","::",64],["T_VARIABLE","$dataVersions",64],")",")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n                            ",64],["T_STRING","self",65],["T_DOUBLE_COLON","::",65],["T_VARIABLE","$dataVersions",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],"[","]",";",["T_WHITESPACE","\n                        ",65],"}",["T_WHITESPACE","\n                        ",66],["T_STRING","self",67],["T_DOUBLE_COLON","::",67],["T_VARIABLE","$dataVersions",67],"[",["T_VARIABLE","$row",67],"[",["T_CONSTANT_ENCAPSED_STRING","'module'",67],"]","]",["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$row",67],"[",["T_CONSTANT_ENCAPSED_STRING","'data_version'",67],"]",";",["T_WHITESPACE","\n                    ",67],"}",["T_WHITESPACE","\n                ",68],"}",["T_WHITESPACE","\n            ",69],"}",["T_WHITESPACE","\n        ",70],"}",["T_WHITESPACE","\n\n        ",71],["T_RETURN","return",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],";",["T_WHITESPACE","\n    ",73],"}",["T_WHITESPACE","\n\n    ",74],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",76],["T_WHITESPACE","\n    ",78],["T_PUBLIC","public",79],["T_WHITESPACE"," ",79],["T_FUNCTION","function",79],["T_WHITESPACE"," ",79],["T_STRING","getDbVersion",79],"(",["T_VARIABLE","$moduleName",79],")",["T_WHITESPACE","\n    ",79],"{",["T_WHITESPACE","\n        ",80],["T_IF","if",81],["T_WHITESPACE"," ",81],"(","!",["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getConnection",81],"(",")",")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n            ",81],["T_RETURN","return",82],["T_WHITESPACE"," ",82],["T_STRING","false",82],";",["T_WHITESPACE","\n        ",82],"}",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","_loadVersion",84],"(",["T_CONSTANT_ENCAPSED_STRING","'db'",84],")",";",["T_WHITESPACE","\n        ",84],["T_RETURN","return",85],["T_WHITESPACE"," ",85],["T_ISSET","isset",85],"(",["T_STRING","self",85],["T_DOUBLE_COLON","::",85],["T_VARIABLE","$schemaVersions",85],"[",["T_VARIABLE","$moduleName",85],"]",")",["T_WHITESPACE"," ",85],"?",["T_WHITESPACE"," ",85],["T_STRING","self",85],["T_DOUBLE_COLON","::",85],["T_VARIABLE","$schemaVersions",85],"[",["T_VARIABLE","$moduleName",85],"]",["T_WHITESPACE"," ",85],":",["T_WHITESPACE"," ",85],["T_STRING","false",85],";",["T_WHITESPACE","\n    ",85],"}",["T_WHITESPACE","\n\n    ",86],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",88],["T_WHITESPACE","\n    ",90],["T_PUBLIC","public",91],["T_WHITESPACE"," ",91],["T_FUNCTION","function",91],["T_WHITESPACE"," ",91],["T_STRING","setDbVersion",91],"(",["T_VARIABLE","$moduleName",91],",",["T_WHITESPACE"," ",91],["T_VARIABLE","$version",91],")",["T_WHITESPACE","\n    ",91],"{",["T_WHITESPACE","\n        ",92],["T_VARIABLE","$dbModuleInfo",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],"[",["T_CONSTANT_ENCAPSED_STRING","'module'",93],["T_WHITESPACE"," ",93],["T_DOUBLE_ARROW","=>",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$moduleName",93],",",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","'schema_version'",93],["T_WHITESPACE"," ",93],["T_DOUBLE_ARROW","=>",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$version",93],"]",";",["T_WHITESPACE","\n\n        ",93],["T_IF","if",95],["T_WHITESPACE"," ",95],"(",["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getDbVersion",95],"(",["T_VARIABLE","$moduleName",95],")",")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n            ",95],["T_STRING","self",96],["T_DOUBLE_COLON","::",96],["T_VARIABLE","$schemaVersions",96],"[",["T_VARIABLE","$moduleName",96],"]",["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$version",96],";",["T_WHITESPACE","\n            ",96],["T_RETURN","return",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","getConnection",97],"(",")",["T_OBJECT_OPERATOR","->",97],["T_STRING","update",97],"(",["T_WHITESPACE","\n                ",97],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getMainTable",98],"(",")",",",["T_WHITESPACE","\n                ",98],["T_VARIABLE","$dbModuleInfo",99],",",["T_WHITESPACE","\n                ",99],"[",["T_CONSTANT_ENCAPSED_STRING","'module = ?'",100],["T_WHITESPACE"," ",100],["T_DOUBLE_ARROW","=>",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$moduleName",100],"]",["T_WHITESPACE","\n            ",100],")",";",["T_WHITESPACE","\n        ",101],"}",["T_WHITESPACE"," ",102],["T_ELSE","else",102],["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n            ",102],["T_STRING","self",103],["T_DOUBLE_COLON","::",103],["T_VARIABLE","$schemaVersions",103],"[",["T_VARIABLE","$moduleName",103],"]",["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$version",103],";",["T_WHITESPACE","\n            ",103],["T_RETURN","return",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getConnection",104],"(",")",["T_OBJECT_OPERATOR","->",104],["T_STRING","insert",104],"(",["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getMainTable",104],"(",")",",",["T_WHITESPACE"," ",104],["T_VARIABLE","$dbModuleInfo",104],")",";",["T_WHITESPACE","\n        ",104],"}",["T_WHITESPACE","\n    ",105],"}",["T_WHITESPACE","\n\n    ",106],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",108],["T_WHITESPACE","\n    ",110],["T_PUBLIC","public",111],["T_WHITESPACE"," ",111],["T_FUNCTION","function",111],["T_WHITESPACE"," ",111],["T_STRING","getDataVersion",111],"(",["T_VARIABLE","$moduleName",111],")",["T_WHITESPACE","\n    ",111],"{",["T_WHITESPACE","\n        ",112],["T_IF","if",113],["T_WHITESPACE"," ",113],"(","!",["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","getConnection",113],"(",")",")",["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n            ",113],["T_RETURN","return",114],["T_WHITESPACE"," ",114],["T_STRING","false",114],";",["T_WHITESPACE","\n        ",114],"}",["T_WHITESPACE","\n        ",115],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","_loadVersion",116],"(",["T_CONSTANT_ENCAPSED_STRING","'data'",116],")",";",["T_WHITESPACE","\n        ",116],["T_RETURN","return",117],["T_WHITESPACE"," ",117],["T_ISSET","isset",117],"(",["T_STRING","self",117],["T_DOUBLE_COLON","::",117],["T_VARIABLE","$dataVersions",117],"[",["T_VARIABLE","$moduleName",117],"]",")",["T_WHITESPACE"," ",117],"?",["T_WHITESPACE"," ",117],["T_STRING","self",117],["T_DOUBLE_COLON","::",117],["T_VARIABLE","$dataVersions",117],"[",["T_VARIABLE","$moduleName",117],"]",["T_WHITESPACE"," ",117],":",["T_WHITESPACE"," ",117],["T_STRING","false",117],";",["T_WHITESPACE","\n    ",117],"}",["T_WHITESPACE","\n\n    ",118],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",120],["T_WHITESPACE","\n    ",122],["T_PUBLIC","public",123],["T_WHITESPACE"," ",123],["T_FUNCTION","function",123],["T_WHITESPACE"," ",123],["T_STRING","setDataVersion",123],"(",["T_VARIABLE","$moduleName",123],",",["T_WHITESPACE"," ",123],["T_VARIABLE","$version",123],")",["T_WHITESPACE","\n    ",123],"{",["T_WHITESPACE","\n        ",124],["T_VARIABLE","$data",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],"[",["T_CONSTANT_ENCAPSED_STRING","'module'",125],["T_WHITESPACE"," ",125],["T_DOUBLE_ARROW","=>",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$moduleName",125],",",["T_WHITESPACE"," ",125],["T_CONSTANT_ENCAPSED_STRING","'data_version'",125],["T_WHITESPACE"," ",125],["T_DOUBLE_ARROW","=>",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$version",125],"]",";",["T_WHITESPACE","\n\n        ",125],["T_IF","if",127],["T_WHITESPACE"," ",127],"(",["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","getDbVersion",127],"(",["T_VARIABLE","$moduleName",127],")",["T_WHITESPACE"," ",127],["T_BOOLEAN_OR","||",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","getDataVersion",127],"(",["T_VARIABLE","$moduleName",127],")",")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n            ",127],["T_STRING","self",128],["T_DOUBLE_COLON","::",128],["T_VARIABLE","$dataVersions",128],"[",["T_VARIABLE","$moduleName",128],"]",["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_VARIABLE","$version",128],";",["T_WHITESPACE","\n            ",128],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getConnection",129],"(",")",["T_OBJECT_OPERATOR","->",129],["T_STRING","update",129],"(",["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getMainTable",129],"(",")",",",["T_WHITESPACE"," ",129],["T_VARIABLE","$data",129],",",["T_WHITESPACE"," ",129],"[",["T_CONSTANT_ENCAPSED_STRING","'module = ?'",129],["T_WHITESPACE"," ",129],["T_DOUBLE_ARROW","=>",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$moduleName",129],"]",")",";",["T_WHITESPACE","\n        ",129],"}",["T_WHITESPACE"," ",130],["T_ELSE","else",130],["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n            ",130],["T_STRING","self",131],["T_DOUBLE_COLON","::",131],["T_VARIABLE","$dataVersions",131],"[",["T_VARIABLE","$moduleName",131],"]",["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_VARIABLE","$version",131],";",["T_WHITESPACE","\n            ",131],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","getConnection",132],"(",")",["T_OBJECT_OPERATOR","->",132],["T_STRING","insert",132],"(",["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","getMainTable",132],"(",")",",",["T_WHITESPACE"," ",132],["T_VARIABLE","$data",132],")",";",["T_WHITESPACE","\n        ",132],"}",["T_WHITESPACE","\n    ",133],"}",["T_WHITESPACE","\n",134],"}",["T_WHITESPACE","\n",135]]