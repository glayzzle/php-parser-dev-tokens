[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Framework",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Backup",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Filesystem",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Rollback",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Filesystem",8],["T_NS_SEPARATOR","\\",8],["T_STRING","DriverInterface",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * Rollback worker for rolling back via ftp\n *\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",10],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","Ftp",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_STRING","AbstractRollback",15],["T_WHITESPACE","\n",15],"{",["T_WHITESPACE","\n    ",16],["T_DOC_COMMENT","\/**\n     * Ftp client\n     *\n     * @var \\Magento\\Framework\\System\\Ftp\n     *\/",17],["T_WHITESPACE","\n    ",21],["T_PROTECTED","protected",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$_ftpClient",22],";",["T_WHITESPACE","\n\n    ",22],["T_DOC_COMMENT","\/**\n     * Files rollback implementation via ftp\n     *\n     * @return void\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     *\n     * @see AbstractRollback::run()\n     *\/",24],["T_WHITESPACE","\n    ",31],["T_PUBLIC","public",32],["T_WHITESPACE"," ",32],["T_FUNCTION","function",32],["T_WHITESPACE"," ",32],["T_STRING","run",32],"(",")",["T_WHITESPACE","\n    ",32],"{",["T_WHITESPACE","\n        ",33],["T_VARIABLE","$snapshotPath",34],["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","_snapshot",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","getBackupPath",34],"(",")",";",["T_WHITESPACE","\n\n        ",34],["T_IF","if",36],["T_WHITESPACE"," ",36],"(","!",["T_STRING","is_file",36],"(",["T_VARIABLE","$snapshotPath",36],")",["T_WHITESPACE"," ",36],["T_BOOLEAN_OR","||",36],["T_WHITESPACE"," ",36],"!",["T_STRING","is_readable",36],"(",["T_VARIABLE","$snapshotPath",36],")",")",["T_WHITESPACE"," ",36],"{",["T_WHITESPACE","\n            ",36],["T_THROW","throw",37],["T_WHITESPACE"," ",37],["T_NEW","new",37],["T_WHITESPACE"," ",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Magento",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Framework",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Backup",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Exception",37],["T_NS_SEPARATOR","\\",37],["T_STRING","CantLoadSnapshot",37],"(",["T_WHITESPACE","\n                ",37],["T_NEW","new",38],["T_WHITESPACE"," ",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Magento",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Framework",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Phrase",38],"(",["T_CONSTANT_ENCAPSED_STRING","'Can\\'t load snapshot archive'",38],")",["T_WHITESPACE","\n            ",38],")",";",["T_WHITESPACE","\n        ",39],"}",["T_WHITESPACE","\n\n        ",40],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","_initFtpClient",42],"(",")",";",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","_validateFtp",43],"(",")",";",["T_WHITESPACE","\n\n        ",43],["T_VARIABLE","$tmpDir",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","_createTmpDir",45],"(",")",";",["T_WHITESPACE","\n        ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","_unpackSnapshot",46],"(",["T_VARIABLE","$tmpDir",46],")",";",["T_WHITESPACE","\n\n        ",46],["T_VARIABLE","$fsHelper",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_NEW","new",48],["T_WHITESPACE"," ",48],["T_NS_SEPARATOR","\\",48],["T_STRING","Magento",48],["T_NS_SEPARATOR","\\",48],["T_STRING","Framework",48],["T_NS_SEPARATOR","\\",48],["T_STRING","Backup",48],["T_NS_SEPARATOR","\\",48],["T_STRING","Filesystem",48],["T_NS_SEPARATOR","\\",48],["T_STRING","Helper",48],"(",")",";",["T_WHITESPACE","\n\n        ",48],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","_cleanupFtp",50],"(",")",";",["T_WHITESPACE","\n        ",50],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","_uploadBackupToFtp",51],"(",["T_VARIABLE","$tmpDir",51],")",";",["T_WHITESPACE","\n\n        ",51],["T_VARIABLE","$fsHelper",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","rm",53],"(",["T_VARIABLE","$tmpDir",53],",",["T_WHITESPACE"," ",53],"[","]",",",["T_WHITESPACE"," ",53],["T_STRING","true",53],")",";",["T_WHITESPACE","\n    ",53],"}",["T_WHITESPACE","\n\n    ",54],["T_DOC_COMMENT","\/**\n     * Initialize ftp client and connect to ftp\n     *\n     * @return void\n     * @throws \\Magento\\Framework\\Backup\\Exception\\FtpConnectionFailed\n     *\/",56],["T_WHITESPACE","\n    ",61],["T_PROTECTED","protected",62],["T_WHITESPACE"," ",62],["T_FUNCTION","function",62],["T_WHITESPACE"," ",62],["T_STRING","_initFtpClient",62],"(",")",["T_WHITESPACE","\n    ",62],"{",["T_WHITESPACE","\n        ",63],["T_TRY","try",64],["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n            ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","_ftpClient",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_NEW","new",65],["T_WHITESPACE"," ",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Magento",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Framework",65],["T_NS_SEPARATOR","\\",65],["T_STRING","System",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Ftp",65],"(",")",";",["T_WHITESPACE","\n            ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","_ftpClient",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","connect",66],"(",["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","_snapshot",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getFtpConnectString",66],"(",")",")",";",["T_WHITESPACE","\n        ",66],"}",["T_WHITESPACE"," ",67],["T_CATCH","catch",67],["T_WHITESPACE"," ",67],"(",["T_NS_SEPARATOR","\\",67],["T_STRING","Exception",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$e",67],")",["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n            ",67],["T_THROW","throw",68],["T_WHITESPACE"," ",68],["T_NEW","new",68],["T_WHITESPACE"," ",68],["T_NS_SEPARATOR","\\",68],["T_STRING","Magento",68],["T_NS_SEPARATOR","\\",68],["T_STRING","Framework",68],["T_NS_SEPARATOR","\\",68],["T_STRING","Backup",68],["T_NS_SEPARATOR","\\",68],["T_STRING","Exception",68],["T_NS_SEPARATOR","\\",68],["T_STRING","FtpConnectionFailed",68],"(",["T_WHITESPACE","\n                ",68],["T_NEW","new",69],["T_WHITESPACE"," ",69],["T_NS_SEPARATOR","\\",69],["T_STRING","Magento",69],["T_NS_SEPARATOR","\\",69],["T_STRING","Framework",69],["T_NS_SEPARATOR","\\",69],["T_STRING","Phrase",69],"(",["T_VARIABLE","$e",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getMessage",69],"(",")",")",["T_WHITESPACE","\n            ",69],")",";",["T_WHITESPACE","\n        ",70],"}",["T_WHITESPACE","\n    ",71],"}",["T_WHITESPACE","\n\n    ",72],["T_DOC_COMMENT","\/**\n     * Perform ftp validation. Check whether ftp account provided points to current magento installation\n     *\n     * @return void\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     *\/",74],["T_WHITESPACE","\n    ",79],["T_PROTECTED","protected",80],["T_WHITESPACE"," ",80],["T_FUNCTION","function",80],["T_WHITESPACE"," ",80],["T_STRING","_validateFtp",80],"(",")",["T_WHITESPACE","\n    ",80],"{",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$validationFilename",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'~validation-'",82],["T_WHITESPACE"," ",82],".",["T_WHITESPACE"," ",82],["T_STRING","microtime",82],"(",["T_STRING","true",82],")",["T_WHITESPACE"," ",82],".",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'.tmp'",82],";",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$validationFilePath",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","_snapshot",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","getBackupsDir",83],"(",")",["T_WHITESPACE"," ",83],".",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'\/'",83],["T_WHITESPACE"," ",83],".",["T_WHITESPACE"," ",83],["T_VARIABLE","$validationFilename",83],";",["T_WHITESPACE","\n\n        ",83],["T_VARIABLE","$fh",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],"@",["T_STRING","fopen",85],"(",["T_VARIABLE","$validationFilePath",85],",",["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","'w'",85],")",";",["T_WHITESPACE","\n        ",85],"@",["T_STRING","fclose",86],"(",["T_VARIABLE","$fh",86],")",";",["T_WHITESPACE","\n\n        ",86],["T_IF","if",88],["T_WHITESPACE"," ",88],"(","!",["T_STRING","is_file",88],"(",["T_VARIABLE","$validationFilePath",88],")",")",["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n            ",88],["T_THROW","throw",89],["T_WHITESPACE"," ",89],["T_NEW","new",89],["T_WHITESPACE"," ",89],["T_NS_SEPARATOR","\\",89],["T_STRING","Magento",89],["T_NS_SEPARATOR","\\",89],["T_STRING","Framework",89],["T_NS_SEPARATOR","\\",89],["T_STRING","Exception",89],["T_NS_SEPARATOR","\\",89],["T_STRING","LocalizedException",89],"(",["T_WHITESPACE","\n                ",89],["T_NEW","new",90],["T_WHITESPACE"," ",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Magento",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Framework",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Phrase",90],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to validate ftp account'",90],")",["T_WHITESPACE","\n            ",90],")",";",["T_WHITESPACE","\n        ",91],"}",["T_WHITESPACE","\n\n        ",92],["T_VARIABLE","$rootDir",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","_snapshot",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getRootDir",94],"(",")",";",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$ftpPath",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","_snapshot",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getFtpPath",95],"(",")",["T_WHITESPACE"," ",95],".",["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","'\/'",95],["T_WHITESPACE"," ",95],".",["T_WHITESPACE"," ",95],["T_STRING","str_replace",95],"(",["T_VARIABLE","$rootDir",95],",",["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","''",95],",",["T_WHITESPACE"," ",95],["T_VARIABLE","$validationFilePath",95],")",";",["T_WHITESPACE","\n\n        ",95],["T_VARIABLE","$fileExistsOnFtp",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","_ftpClient",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","fileExists",97],"(",["T_VARIABLE","$ftpPath",97],")",";",["T_WHITESPACE","\n        ",97],"@",["T_STRING","unlink",98],"(",["T_VARIABLE","$validationFilePath",98],")",";",["T_WHITESPACE","\n\n        ",98],["T_IF","if",100],["T_WHITESPACE"," ",100],"(","!",["T_VARIABLE","$fileExistsOnFtp",100],")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n            ",100],["T_THROW","throw",101],["T_WHITESPACE"," ",101],["T_NEW","new",101],["T_WHITESPACE"," ",101],["T_NS_SEPARATOR","\\",101],["T_STRING","Magento",101],["T_NS_SEPARATOR","\\",101],["T_STRING","Framework",101],["T_NS_SEPARATOR","\\",101],["T_STRING","Backup",101],["T_NS_SEPARATOR","\\",101],["T_STRING","Exception",101],["T_NS_SEPARATOR","\\",101],["T_STRING","FtpValidationFailed",101],"(",["T_WHITESPACE","\n                ",101],["T_NEW","new",102],["T_WHITESPACE"," ",102],["T_NS_SEPARATOR","\\",102],["T_STRING","Magento",102],["T_NS_SEPARATOR","\\",102],["T_STRING","Framework",102],["T_NS_SEPARATOR","\\",102],["T_STRING","Phrase",102],"(",["T_CONSTANT_ENCAPSED_STRING","'Failed to validate ftp account'",102],")",["T_WHITESPACE","\n            ",102],")",";",["T_WHITESPACE","\n        ",103],"}",["T_WHITESPACE","\n    ",104],"}",["T_WHITESPACE","\n\n    ",105],["T_DOC_COMMENT","\/**\n     * Unpack snapshot\n     *\n     * @param string $tmpDir\n     * @return void\n     *\/",107],["T_WHITESPACE","\n    ",112],["T_PROTECTED","protected",113],["T_WHITESPACE"," ",113],["T_FUNCTION","function",113],["T_WHITESPACE"," ",113],["T_STRING","_unpackSnapshot",113],"(",["T_VARIABLE","$tmpDir",113],")",["T_WHITESPACE","\n    ",113],"{",["T_WHITESPACE","\n        ",114],["T_VARIABLE","$snapshotPath",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","_snapshot",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","getBackupPath",115],"(",")",";",["T_WHITESPACE","\n\n        ",115],["T_VARIABLE","$archiver",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_NEW","new",117],["T_WHITESPACE"," ",117],["T_NS_SEPARATOR","\\",117],["T_STRING","Magento",117],["T_NS_SEPARATOR","\\",117],["T_STRING","Framework",117],["T_NS_SEPARATOR","\\",117],["T_STRING","Archive",117],"(",")",";",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$archiver",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","unpack",118],"(",["T_VARIABLE","$snapshotPath",118],",",["T_WHITESPACE"," ",118],["T_VARIABLE","$tmpDir",118],")",";",["T_WHITESPACE","\n    ",118],"}",["T_WHITESPACE","\n\n    ",119],["T_DOC_COMMENT","\/**\n     * @return string\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     *\/",121],["T_WHITESPACE","\n    ",124],["T_PROTECTED","protected",125],["T_WHITESPACE"," ",125],["T_FUNCTION","function",125],["T_WHITESPACE"," ",125],["T_STRING","_createTmpDir",125],"(",")",["T_WHITESPACE","\n    ",125],"{",["T_WHITESPACE","\n        ",126],["T_VARIABLE","$tmpDir",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","_snapshot",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","getBackupsDir",127],"(",")",["T_WHITESPACE"," ",127],".",["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","'\/~tmp-'",127],["T_WHITESPACE"," ",127],".",["T_WHITESPACE"," ",127],["T_STRING","microtime",127],"(",["T_STRING","true",127],")",";",["T_WHITESPACE","\n\n        ",127],["T_VARIABLE","$result",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],"@",["T_STRING","mkdir",129],"(",["T_VARIABLE","$tmpDir",129],")",";",["T_WHITESPACE","\n\n        ",129],["T_IF","if",131],["T_WHITESPACE"," ",131],"(",["T_STRING","false",131],["T_WHITESPACE"," ",131],["T_IS_IDENTICAL","===",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$result",131],")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n            ",131],["T_THROW","throw",132],["T_WHITESPACE"," ",132],["T_NEW","new",132],["T_WHITESPACE"," ",132],["T_NS_SEPARATOR","\\",132],["T_STRING","Magento",132],["T_NS_SEPARATOR","\\",132],["T_STRING","Framework",132],["T_NS_SEPARATOR","\\",132],["T_STRING","Backup",132],["T_NS_SEPARATOR","\\",132],["T_STRING","Exception",132],["T_NS_SEPARATOR","\\",132],["T_STRING","NotEnoughPermissions",132],"(",["T_WHITESPACE","\n                ",132],["T_NEW","new",133],["T_WHITESPACE"," ",133],["T_NS_SEPARATOR","\\",133],["T_STRING","Magento",133],["T_NS_SEPARATOR","\\",133],["T_STRING","Framework",133],["T_NS_SEPARATOR","\\",133],["T_STRING","Phrase",133],"(",["T_CONSTANT_ENCAPSED_STRING","'Failed to create directory %1'",133],",",["T_WHITESPACE"," ",133],"[",["T_VARIABLE","$tmpDir",133],"]",")",["T_WHITESPACE","\n            ",133],")",";",["T_WHITESPACE","\n        ",134],"}",["T_WHITESPACE","\n\n        ",135],["T_RETURN","return",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$tmpDir",137],";",["T_WHITESPACE","\n    ",137],"}",["T_WHITESPACE","\n\n    ",138],["T_DOC_COMMENT","\/**\n     * Delete magento and all files from ftp\n     *\n     * @return void\n     *\/",140],["T_WHITESPACE","\n    ",144],["T_PROTECTED","protected",145],["T_WHITESPACE"," ",145],["T_FUNCTION","function",145],["T_WHITESPACE"," ",145],["T_STRING","_cleanupFtp",145],"(",")",["T_WHITESPACE","\n    ",145],"{",["T_WHITESPACE","\n        ",146],["T_VARIABLE","$rootDir",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","_snapshot",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","getRootDir",147],"(",")",";",["T_WHITESPACE","\n\n        ",147],["T_VARIABLE","$filesystemIterator",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_NEW","new",149],["T_WHITESPACE"," ",149],["T_NS_SEPARATOR","\\",149],["T_STRING","RecursiveIteratorIterator",149],"(",["T_WHITESPACE","\n            ",149],["T_NEW","new",150],["T_WHITESPACE"," ",150],["T_NS_SEPARATOR","\\",150],["T_STRING","RecursiveDirectoryIterator",150],"(",["T_VARIABLE","$rootDir",150],")",",",["T_WHITESPACE","\n            ",150],["T_NS_SEPARATOR","\\",151],["T_STRING","RecursiveIteratorIterator",151],["T_DOUBLE_COLON","::",151],["T_STRING","CHILD_FIRST",151],["T_WHITESPACE","\n        ",151],")",";",["T_WHITESPACE","\n\n        ",152],["T_VARIABLE","$iterator",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_NEW","new",154],["T_WHITESPACE"," ",154],["T_NS_SEPARATOR","\\",154],["T_STRING","Magento",154],["T_NS_SEPARATOR","\\",154],["T_STRING","Framework",154],["T_NS_SEPARATOR","\\",154],["T_STRING","Backup",154],["T_NS_SEPARATOR","\\",154],["T_STRING","Filesystem",154],["T_NS_SEPARATOR","\\",154],["T_STRING","Iterator",154],["T_NS_SEPARATOR","\\",154],["T_STRING","Filter",154],"(",["T_WHITESPACE","\n            ",154],["T_VARIABLE","$filesystemIterator",155],",",["T_WHITESPACE","\n            ",155],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","_snapshot",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","getIgnorePaths",156],"(",")",["T_WHITESPACE","\n        ",156],")",";",["T_WHITESPACE","\n\n        ",157],["T_FOREACH","foreach",159],["T_WHITESPACE"," ",159],"(",["T_VARIABLE","$iterator",159],["T_WHITESPACE"," ",159],["T_AS","as",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$item",159],")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n            ",159],["T_VARIABLE","$ftpPath",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","_snapshot",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","getFtpPath",160],"(",")",["T_WHITESPACE"," ",160],".",["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","'\/'",160],["T_WHITESPACE"," ",160],".",["T_WHITESPACE"," ",160],["T_STRING","str_replace",160],"(",["T_VARIABLE","$rootDir",160],",",["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","''",160],",",["T_WHITESPACE"," ",160],["T_VARIABLE","$item",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","__toString",160],"(",")",")",";",["T_WHITESPACE","\n            ",160],["T_VARIABLE","$ftpPath",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_STRING","str_replace",161],"(",["T_CONSTANT_ENCAPSED_STRING","'\\\\'",161],",",["T_WHITESPACE"," ",161],["T_CONSTANT_ENCAPSED_STRING","'\/'",161],",",["T_WHITESPACE"," ",161],["T_VARIABLE","$ftpPath",161],")",";",["T_WHITESPACE","\n\n            ",161],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","_ftpClient",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","delete",163],"(",["T_VARIABLE","$ftpPath",163],")",";",["T_WHITESPACE","\n        ",163],"}",["T_WHITESPACE","\n    ",164],"}",["T_WHITESPACE","\n\n    ",165],["T_DOC_COMMENT","\/**\n     * Perform files rollback\n     *\n     * @param string $tmpDir\n     * @return void\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     * @SuppressWarnings(PHPMD.UnusedLocalVariable)\n     *\/",167],["T_WHITESPACE","\n    ",174],["T_PROTECTED","protected",175],["T_WHITESPACE"," ",175],["T_FUNCTION","function",175],["T_WHITESPACE"," ",175],["T_STRING","_uploadBackupToFtp",175],"(",["T_VARIABLE","$tmpDir",175],")",["T_WHITESPACE","\n    ",175],"{",["T_WHITESPACE","\n        ",176],["T_VARIABLE","$filesystemIterator",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_NEW","new",177],["T_WHITESPACE"," ",177],["T_NS_SEPARATOR","\\",177],["T_STRING","RecursiveIteratorIterator",177],"(",["T_WHITESPACE","\n            ",177],["T_NEW","new",178],["T_WHITESPACE"," ",178],["T_NS_SEPARATOR","\\",178],["T_STRING","RecursiveDirectoryIterator",178],"(",["T_VARIABLE","$tmpDir",178],")",",",["T_WHITESPACE","\n            ",178],["T_NS_SEPARATOR","\\",179],["T_STRING","RecursiveIteratorIterator",179],["T_DOUBLE_COLON","::",179],["T_STRING","SELF_FIRST",179],["T_WHITESPACE","\n        ",179],")",";",["T_WHITESPACE","\n\n        ",180],["T_VARIABLE","$iterator",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_NEW","new",182],["T_WHITESPACE"," ",182],["T_NS_SEPARATOR","\\",182],["T_STRING","Magento",182],["T_NS_SEPARATOR","\\",182],["T_STRING","Framework",182],["T_NS_SEPARATOR","\\",182],["T_STRING","Backup",182],["T_NS_SEPARATOR","\\",182],["T_STRING","Filesystem",182],["T_NS_SEPARATOR","\\",182],["T_STRING","Iterator",182],["T_NS_SEPARATOR","\\",182],["T_STRING","Filter",182],"(",["T_WHITESPACE","\n            ",182],["T_VARIABLE","$filesystemIterator",183],",",["T_WHITESPACE","\n            ",183],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","_snapshot",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getIgnorePaths",184],"(",")",["T_WHITESPACE","\n        ",184],")",";",["T_WHITESPACE","\n\n        ",185],["T_FOREACH","foreach",187],["T_WHITESPACE"," ",187],"(",["T_VARIABLE","$filesystemIterator",187],["T_WHITESPACE"," ",187],["T_AS","as",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$item",187],")",["T_WHITESPACE"," ",187],"{",["T_WHITESPACE","\n            ",187],["T_VARIABLE","$ftpPath",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","_snapshot",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getFtpPath",188],"(",")",["T_WHITESPACE"," ",188],".",["T_WHITESPACE"," ",188],["T_CONSTANT_ENCAPSED_STRING","'\/'",188],["T_WHITESPACE"," ",188],".",["T_WHITESPACE"," ",188],["T_STRING","str_replace",188],"(",["T_VARIABLE","$tmpDir",188],",",["T_WHITESPACE"," ",188],["T_CONSTANT_ENCAPSED_STRING","''",188],",",["T_WHITESPACE"," ",188],["T_VARIABLE","$item",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","__toString",188],"(",")",")",";",["T_WHITESPACE","\n            ",188],["T_VARIABLE","$ftpPath",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_STRING","str_replace",189],"(",["T_CONSTANT_ENCAPSED_STRING","'\\\\'",189],",",["T_WHITESPACE"," ",189],["T_CONSTANT_ENCAPSED_STRING","'\/'",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$ftpPath",189],")",";",["T_WHITESPACE","\n\n            ",189],["T_IF","if",191],["T_WHITESPACE"," ",191],"(",["T_VARIABLE","$item",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","isLink",191],"(",")",")",["T_WHITESPACE"," ",191],"{",["T_WHITESPACE","\n                ",191],["T_CONTINUE","continue",192],";",["T_WHITESPACE","\n            ",192],"}",["T_WHITESPACE","\n\n            ",193],["T_IF","if",195],["T_WHITESPACE"," ",195],"(",["T_VARIABLE","$item",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","isDir",195],"(",")",")",["T_WHITESPACE"," ",195],"{",["T_WHITESPACE","\n                ",195],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","_ftpClient",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","mkdirRecursive",196],"(",["T_VARIABLE","$ftpPath",196],")",";",["T_WHITESPACE","\n            ",196],"}",["T_WHITESPACE"," ",197],["T_ELSE","else",197],["T_WHITESPACE"," ",197],"{",["T_WHITESPACE","\n                ",197],["T_VARIABLE","$result",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","_ftpClient",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","put",198],"(",["T_VARIABLE","$ftpPath",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$item",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","__toString",198],"(",")",")",";",["T_WHITESPACE","\n                ",198],["T_IF","if",199],["T_WHITESPACE"," ",199],"(",["T_STRING","false",199],["T_WHITESPACE"," ",199],["T_IS_IDENTICAL","===",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$result",199],")",["T_WHITESPACE"," ",199],"{",["T_WHITESPACE","\n                    ",199],["T_THROW","throw",200],["T_WHITESPACE"," ",200],["T_NEW","new",200],["T_WHITESPACE"," ",200],["T_NS_SEPARATOR","\\",200],["T_STRING","Magento",200],["T_NS_SEPARATOR","\\",200],["T_STRING","Framework",200],["T_NS_SEPARATOR","\\",200],["T_STRING","Backup",200],["T_NS_SEPARATOR","\\",200],["T_STRING","Exception",200],["T_NS_SEPARATOR","\\",200],["T_STRING","NotEnoughPermissions",200],"(",["T_WHITESPACE","\n                        ",200],["T_NEW","new",201],["T_WHITESPACE"," ",201],["T_NS_SEPARATOR","\\",201],["T_STRING","Magento",201],["T_NS_SEPARATOR","\\",201],["T_STRING","Framework",201],["T_NS_SEPARATOR","\\",201],["T_STRING","Phrase",201],"(",["T_CONSTANT_ENCAPSED_STRING","'Failed to upload file %1 to ftp'",201],",",["T_WHITESPACE"," ",201],"[",["T_VARIABLE","$item",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","__toString",201],"(",")","]",")",["T_WHITESPACE","\n                    ",201],")",";",["T_WHITESPACE","\n                ",202],"}",["T_WHITESPACE","\n            ",203],"}",["T_WHITESPACE","\n        ",204],"}",["T_WHITESPACE","\n    ",205],"}",["T_WHITESPACE","\n",206],"}",["T_WHITESPACE","\n",207]]