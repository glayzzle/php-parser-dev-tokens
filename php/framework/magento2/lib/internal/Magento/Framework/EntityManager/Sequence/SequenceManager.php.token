[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Framework",7],["T_NS_SEPARATOR","\\",7],["T_STRING","EntityManager",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Sequence",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Psr",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Log",9],["T_NS_SEPARATOR","\\",9],["T_STRING","LoggerInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","EntityManager",10],["T_NS_SEPARATOR","\\",10],["T_STRING","MetadataPool",10],";",["T_WHITESPACE","\n\n",10],["T_DOC_COMMENT","\/**\n * Class SequenceManager\n *\/",12],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","SequenceManager",15],["T_WHITESPACE","\n",15],"{",["T_WHITESPACE","\n    ",16],["T_DOC_COMMENT","\/**\n     * @var SequenceRegistry\n     *\/",17],["T_WHITESPACE","\n    ",19],["T_PRIVATE","private",20],["T_WHITESPACE"," ",20],["T_VARIABLE","$sequenceRegistry",20],";",["T_WHITESPACE","\n\n    ",20],["T_DOC_COMMENT","\/**\n     * @var MetadataPool\n     *\/",22],["T_WHITESPACE","\n    ",24],["T_PRIVATE","private",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$metadataPool",25],";",["T_WHITESPACE","\n\n    ",25],["T_DOC_COMMENT","\/**\n     * @var LoggerInterface\n     *\/",27],["T_WHITESPACE","\n    ",29],["T_PRIVATE","private",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$logger",30],";",["T_WHITESPACE","\n\n    ",30],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\App\\ResourceConnection\n     *\/",32],["T_WHITESPACE","\n    ",34],["T_PRIVATE","private",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$appResource",35],";",["T_WHITESPACE","\n\n    ",35],["T_DOC_COMMENT","\/**\n     * @param MetadataPool $metadataPool\n     * @param SequenceRegistry $sequenceRegistry\n     * @param LoggerInterface $logger\n     * @param \\Magento\\Framework\\App\\ResourceConnection $appResource\n     *\/",37],["T_WHITESPACE","\n    ",42],["T_PUBLIC","public",43],["T_WHITESPACE"," ",43],["T_FUNCTION","function",43],["T_WHITESPACE"," ",43],["T_STRING","__construct",43],"(",["T_WHITESPACE","\n        ",43],["T_STRING","MetadataPool",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$metadataPool",44],",",["T_WHITESPACE","\n        ",44],["T_STRING","SequenceRegistry",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$sequenceRegistry",45],",",["T_WHITESPACE","\n        ",45],["T_STRING","LoggerInterface",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$logger",46],",",["T_WHITESPACE","\n        ",46],["T_NS_SEPARATOR","\\",47],["T_STRING","Magento",47],["T_NS_SEPARATOR","\\",47],["T_STRING","Framework",47],["T_NS_SEPARATOR","\\",47],["T_STRING","App",47],["T_NS_SEPARATOR","\\",47],["T_STRING","ResourceConnection",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$appResource",47],["T_WHITESPACE","\n    ",47],")",["T_WHITESPACE"," ",48],"{",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","metadataPool",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$metadataPool",49],";",["T_WHITESPACE","\n        ",49],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","sequenceRegistry",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_VARIABLE","$sequenceRegistry",50],";",["T_WHITESPACE","\n        ",50],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","logger",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$logger",51],";",["T_WHITESPACE","\n        ",51],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","appResource",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$appResource",52],";",["T_WHITESPACE","\n    ",52],"}",["T_WHITESPACE","\n\n    ",53],["T_DOC_COMMENT","\/**\n     * Force sequence value creation\n     *\n     * @param string $entityType\n     * @param string|int $identifier\n     * @return int\n     * @throws \\Exception\n     *\/",55],["T_WHITESPACE","\n    ",62],["T_PUBLIC","public",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","force",63],"(",["T_VARIABLE","$entityType",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$identifier",63],")",["T_WHITESPACE","\n    ",63],"{",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$metadata",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","metadataPool",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getMetadata",65],"(",["T_VARIABLE","$entityType",65],")",";",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$sequenceInfo",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","sequenceRegistry",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","retrieve",66],"(",["T_VARIABLE","$entityType",66],")",";",["T_WHITESPACE","\n\n        ",66],["T_IF","if",68],["T_WHITESPACE"," ",68],"(","!",["T_ISSET","isset",68],"(",["T_VARIABLE","$sequenceInfo",68],"[",["T_CONSTANT_ENCAPSED_STRING","'sequenceTable'",68],"]",")",")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n            ",68],["T_THROW","throw",69],["T_WHITESPACE"," ",69],["T_NEW","new",69],["T_WHITESPACE"," ",69],["T_NS_SEPARATOR","\\",69],["T_STRING","Exception",69],"(",["T_CONSTANT_ENCAPSED_STRING","'TODO: use correct Exception class'",69],["T_WHITESPACE"," ",69],".",["T_WHITESPACE"," ",69],["T_STRING","PHP_EOL",69],["T_WHITESPACE","  ",69],".",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","' Sequence table doesnt exists'",69],")",";",["T_WHITESPACE","\n        ",69],"}",["T_WHITESPACE","\n        ",70],["T_TRY","try",71],["T_WHITESPACE"," ",71],"{",["T_WHITESPACE","\n            ",71],["T_VARIABLE","$connection",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","appResource",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","getConnectionByName",72],"(",["T_VARIABLE","$metadata",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","getEntityConnectionName",72],"(",")",")",";",["T_WHITESPACE","\n            ",72],["T_RETURN","return",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$connection",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","insert",73],"(",["T_WHITESPACE","\n                ",73],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","appResource",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","getTableName",74],"(",["T_VARIABLE","$sequenceInfo",74],"[",["T_CONSTANT_ENCAPSED_STRING","'sequenceTable'",74],"]",")",",",["T_WHITESPACE","\n                ",74],"[",["T_CONSTANT_ENCAPSED_STRING","'sequence_value'",75],["T_WHITESPACE"," ",75],["T_DOUBLE_ARROW","=>",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$identifier",75],"]",["T_WHITESPACE","\n            ",75],")",";",["T_WHITESPACE","\n        ",76],"}",["T_WHITESPACE"," ",77],["T_CATCH","catch",77],["T_WHITESPACE"," ",77],"(",["T_NS_SEPARATOR","\\",77],["T_STRING","Exception",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$e",77],")",["T_WHITESPACE"," ",77],"{",["T_WHITESPACE","\n            ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","logger",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","critical",78],"(",["T_VARIABLE","$e",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getMessage",78],"(",")",",",["T_WHITESPACE"," ",78],["T_VARIABLE","$e",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getTrace",78],"(",")",")",";",["T_WHITESPACE","\n            ",78],["T_THROW","throw",79],["T_WHITESPACE"," ",79],["T_NEW","new",79],["T_WHITESPACE"," ",79],["T_NS_SEPARATOR","\\",79],["T_STRING","Exception",79],"(",["T_CONSTANT_ENCAPSED_STRING","'TODO: use correct Exception class'",79],["T_WHITESPACE"," ",79],".",["T_WHITESPACE"," ",79],["T_STRING","PHP_EOL",79],["T_WHITESPACE"," ",79],".",["T_WHITESPACE"," ",79],["T_VARIABLE","$e",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","getMessage",79],"(",")",")",";",["T_WHITESPACE","\n        ",79],"}",["T_WHITESPACE","\n    ",80],"}",["T_WHITESPACE","\n\n    ",81],["T_DOC_COMMENT","\/**\n     * @param string $entityType\n     * @param int $identifier\n     * @return int\n     * @throws \\Exception\n     *\/",83],["T_WHITESPACE","\n    ",88],["T_PUBLIC","public",89],["T_WHITESPACE"," ",89],["T_FUNCTION","function",89],["T_WHITESPACE"," ",89],["T_STRING","delete",89],"(",["T_VARIABLE","$entityType",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$identifier",89],")",["T_WHITESPACE","\n    ",89],"{",["T_WHITESPACE","\n        ",90],["T_VARIABLE","$metadata",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","metadataPool",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getMetadata",91],"(",["T_VARIABLE","$entityType",91],")",";",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$sequenceInfo",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","sequenceRegistry",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","retrieve",92],"(",["T_VARIABLE","$entityType",92],")",";",["T_WHITESPACE","\n        ",92],["T_IF","if",93],["T_WHITESPACE"," ",93],"(","!",["T_ISSET","isset",93],"(",["T_VARIABLE","$sequenceInfo",93],"[",["T_CONSTANT_ENCAPSED_STRING","'sequenceTable'",93],"]",")",")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n            ",93],["T_THROW","throw",94],["T_WHITESPACE"," ",94],["T_NEW","new",94],["T_WHITESPACE"," ",94],["T_NS_SEPARATOR","\\",94],["T_STRING","Exception",94],"(",["T_CONSTANT_ENCAPSED_STRING","'TODO: use correct Exception class'",94],["T_WHITESPACE"," ",94],".",["T_WHITESPACE"," ",94],["T_STRING","PHP_EOL",94],["T_WHITESPACE","  ",94],".",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","' Sequence table doesnt exists'",94],")",";",["T_WHITESPACE","\n        ",94],"}",["T_WHITESPACE","\n        ",95],["T_TRY","try",96],["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n            ",96],["T_VARIABLE","$connection",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","appResource",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","getConnectionByName",97],"(",["T_VARIABLE","$metadata",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","getEntityConnectionName",97],"(",")",")",";",["T_WHITESPACE","\n            ",97],["T_RETURN","return",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$connection",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","delete",98],"(",["T_WHITESPACE","\n                ",98],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","appResource",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","getTableName",99],"(",["T_VARIABLE","$sequenceInfo",99],"[",["T_CONSTANT_ENCAPSED_STRING","'sequenceTable'",99],"]",")",",",["T_WHITESPACE","\n                ",99],"[",["T_CONSTANT_ENCAPSED_STRING","'sequence_value = ?'",100],["T_WHITESPACE"," ",100],["T_DOUBLE_ARROW","=>",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$identifier",100],"]",["T_WHITESPACE","\n            ",100],")",";",["T_WHITESPACE","\n        ",101],"}",["T_WHITESPACE"," ",102],["T_CATCH","catch",102],["T_WHITESPACE"," ",102],"(",["T_NS_SEPARATOR","\\",102],["T_STRING","Exception",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$e",102],")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n            ",102],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","logger",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","critical",103],"(",["T_VARIABLE","$e",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getMessage",103],"(",")",",",["T_WHITESPACE"," ",103],["T_VARIABLE","$e",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getTrace",103],"(",")",")",";",["T_WHITESPACE","\n            ",103],["T_THROW","throw",104],["T_WHITESPACE"," ",104],["T_NEW","new",104],["T_WHITESPACE"," ",104],["T_NS_SEPARATOR","\\",104],["T_STRING","Exception",104],"(",["T_CONSTANT_ENCAPSED_STRING","'TODO: use correct Exception class'",104],["T_WHITESPACE"," ",104],".",["T_WHITESPACE"," ",104],["T_STRING","PHP_EOL",104],["T_WHITESPACE"," ",104],".",["T_WHITESPACE"," ",104],["T_VARIABLE","$e",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getMessage",104],"(",")",")",";",["T_WHITESPACE","\n        ",104],"}",["T_WHITESPACE","\n    ",105],"}",["T_WHITESPACE","\n",106],"}",["T_WHITESPACE","\n",107]]