[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Framework",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Search",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Adapter",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Mysql",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","App",8],["T_NS_SEPARATOR","\\",8],["T_STRING","ResourceConnection",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","DB",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Ddl",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Table",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","DB",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Select",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Framework",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Search",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Adapter",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Mysql",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Filter",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Builder",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Framework",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Search",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Adapter",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Mysql",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Query",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Builder",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Match",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Framework",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Search",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Adapter",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Mysql",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Query",13],["T_NS_SEPARATOR","\\",13],["T_STRING","MatchContainer",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Framework",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Search",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Adapter",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Mysql",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Query",14],["T_NS_SEPARATOR","\\",14],["T_STRING","QueryContainer",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Magento",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Framework",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Search",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Adapter",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Mysql",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Query",15],["T_NS_SEPARATOR","\\",15],["T_STRING","QueryContainerFactory",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Magento",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Framework",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Search",16],["T_NS_SEPARATOR","\\",16],["T_STRING","EntityMetadata",16],";",["T_WHITESPACE","\n",16],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Magento",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Framework",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Search",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Request",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Query",17],["T_NS_SEPARATOR","\\",17],["T_STRING","BoolExpression",17],["T_WHITESPACE"," ",17],["T_AS","as",17],["T_WHITESPACE"," ",17],["T_STRING","BoolQuery",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Magento",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Framework",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Search",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Request",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Query",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Filter",18],["T_WHITESPACE"," ",18],["T_AS","as",18],["T_WHITESPACE"," ",18],["T_STRING","FilterQuery",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Magento",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Framework",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Search",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Request",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Query",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Match",19],["T_WHITESPACE"," ",19],["T_AS","as",19],["T_WHITESPACE"," ",19],["T_STRING","MatchQuery",19],";",["T_WHITESPACE","\n",19],["T_USE","use",20],["T_WHITESPACE"," ",20],["T_STRING","Magento",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Framework",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Search",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Request",20],["T_NS_SEPARATOR","\\",20],["T_STRING","QueryInterface",20],["T_WHITESPACE"," ",20],["T_AS","as",20],["T_WHITESPACE"," ",20],["T_STRING","RequestQueryInterface",20],";",["T_WHITESPACE","\n",20],["T_USE","use",21],["T_WHITESPACE"," ",21],["T_STRING","Magento",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Framework",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Search",21],["T_NS_SEPARATOR","\\",21],["T_STRING","RequestInterface",21],";",["T_WHITESPACE","\n\n",21],["T_DOC_COMMENT","\/**\n * Mapper class. Maps library request to specific adapter dependent query\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",23],["T_WHITESPACE","\n",26],["T_CLASS","class",27],["T_WHITESPACE"," ",27],["T_STRING","Mapper",27],["T_WHITESPACE","\n",27],"{",["T_WHITESPACE","\n    ",28],["T_DOC_COMMENT","\/**\n     * @var ScoreBuilder\n     *\/",29],["T_WHITESPACE","\n    ",31],["T_PRIVATE","private",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$scoreBuilderFactory",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * @var Filter\\Builder\n     *\/",34],["T_WHITESPACE","\n    ",36],["T_PRIVATE","private",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$filterBuilder",37],";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * @var ConditionManager\n     *\/",39],["T_WHITESPACE","\n    ",41],["T_PRIVATE","private",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$conditionManager",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * @var IndexBuilderInterface[]\n     *\/",44],["T_WHITESPACE","\n    ",46],["T_PRIVATE","private",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$indexProviders",47],";",["T_WHITESPACE","\n\n    ",47],["T_DOC_COMMENT","\/**\n     * @var Resource\n     *\/",49],["T_WHITESPACE","\n    ",51],["T_PRIVATE","private",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$resource",52],";",["T_WHITESPACE","\n\n    ",52],["T_DOC_COMMENT","\/**\n     * @var EntityMetadata\n     *\/",54],["T_WHITESPACE","\n    ",56],["T_PRIVATE","private",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$entityMetadata",57],";",["T_WHITESPACE","\n\n    ",57],["T_DOC_COMMENT","\/**\n     * @var QueryContainerFactory\n     *\/",59],["T_WHITESPACE","\n    ",61],["T_PRIVATE","private",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$queryContainerFactory",62],";",["T_WHITESPACE","\n\n    ",62],["T_DOC_COMMENT","\/**\n     * @var Query\\Builder\\Match\n     *\/",64],["T_WHITESPACE","\n    ",66],["T_PRIVATE","private",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$matchBuilder",67],";",["T_WHITESPACE","\n\n    ",67],["T_DOC_COMMENT","\/**\n     * @var TemporaryStorage\n     *\/",69],["T_WHITESPACE","\n    ",71],["T_PRIVATE","private",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$temporaryStorage",72],";",["T_WHITESPACE","\n\n    ",72],["T_DOC_COMMENT","\/**\n     * @param ScoreBuilderFactory $scoreBuilderFactory\n     * @param Builder $filterBuilder\n     * @param ConditionManager $conditionManager\n     * @param ResourceConnection $resource\n     * @param EntityMetadata $entityMetadata\n     * @param QueryContainerFactory $queryContainerFactory\n     * @param Query\\Builder\\Match $matchBuilder\n     * @param TemporaryStorageFactory $temporaryStorageFactory\n     * @param IndexBuilderInterface[] $indexProviders\n     *\/",74],["T_WHITESPACE","\n    ",84],["T_PUBLIC","public",85],["T_WHITESPACE"," ",85],["T_FUNCTION","function",85],["T_WHITESPACE"," ",85],["T_STRING","__construct",85],"(",["T_WHITESPACE","\n        ",85],["T_STRING","ScoreBuilderFactory",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$scoreBuilderFactory",86],",",["T_WHITESPACE","\n        ",86],["T_STRING","Builder",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$filterBuilder",87],",",["T_WHITESPACE","\n        ",87],["T_STRING","ConditionManager",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$conditionManager",88],",",["T_WHITESPACE","\n        ",88],["T_STRING","ResourceConnection",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$resource",89],",",["T_WHITESPACE","\n        ",89],["T_STRING","EntityMetadata",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$entityMetadata",90],",",["T_WHITESPACE","\n        ",90],["T_STRING","QueryContainerFactory",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$queryContainerFactory",91],",",["T_WHITESPACE","\n        ",91],["T_STRING","Match",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$matchBuilder",92],",",["T_WHITESPACE","\n        ",92],["T_STRING","TemporaryStorageFactory",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$temporaryStorageFactory",93],",",["T_WHITESPACE","\n        ",93],["T_ARRAY","array",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$indexProviders",94],["T_WHITESPACE","\n    ",94],")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n        ",95],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","scoreBuilderFactory",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$scoreBuilderFactory",96],";",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","filterBuilder",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$filterBuilder",97],";",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","conditionManager",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$conditionManager",98],";",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","resource",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_VARIABLE","$resource",99],";",["T_WHITESPACE","\n        ",99],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","entityMetadata",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$entityMetadata",100],";",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","indexProviders",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$indexProviders",101],";",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","queryContainerFactory",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$queryContainerFactory",102],";",["T_WHITESPACE","\n        ",102],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","matchBuilder",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$matchBuilder",103],";",["T_WHITESPACE","\n        ",103],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","temporaryStorage",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$temporaryStorageFactory",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","create",104],"(",")",";",["T_WHITESPACE","\n    ",104],"}",["T_WHITESPACE","\n\n    ",105],["T_DOC_COMMENT","\/**\n     * Build adapter dependent query\n     *\n     * @param RequestInterface $request\n     * @throws \\LogicException\n     * @return Select\n     *\/",107],["T_WHITESPACE","\n    ",113],["T_PUBLIC","public",114],["T_WHITESPACE"," ",114],["T_FUNCTION","function",114],["T_WHITESPACE"," ",114],["T_STRING","buildQuery",114],"(",["T_STRING","RequestInterface",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$request",114],")",["T_WHITESPACE","\n    ",114],"{",["T_WHITESPACE","\n        ",115],["T_IF","if",116],["T_WHITESPACE"," ",116],"(","!",["T_STRING","array_key_exists",116],"(",["T_VARIABLE","$request",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getIndex",116],"(",")",",",["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","indexProviders",116],")",")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n            ",116],["T_THROW","throw",117],["T_WHITESPACE"," ",117],["T_NEW","new",117],["T_WHITESPACE"," ",117],["T_NS_SEPARATOR","\\",117],["T_STRING","LogicException",117],"(",["T_CONSTANT_ENCAPSED_STRING","'Index provider not configured'",117],")",";",["T_WHITESPACE","\n        ",117],"}",["T_WHITESPACE","\n\n        ",118],["T_VARIABLE","$indexBuilder",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","indexProviders",120],"[",["T_VARIABLE","$request",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","getIndex",120],"(",")","]",";",["T_WHITESPACE","\n\n        ",120],["T_VARIABLE","$queryContainer",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","queryContainerFactory",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","create",122],"(",["T_WHITESPACE","\n            ",122],"[",["T_WHITESPACE","\n                ",123],["T_CONSTANT_ENCAPSED_STRING","'indexBuilder'",124],["T_WHITESPACE"," ",124],["T_DOUBLE_ARROW","=>",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$indexBuilder",124],",",["T_WHITESPACE","\n                ",124],["T_CONSTANT_ENCAPSED_STRING","'request'",125],["T_WHITESPACE"," ",125],["T_DOUBLE_ARROW","=>",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$request",125],",",["T_WHITESPACE","\n            ",125],"]",["T_WHITESPACE","\n        ",126],")",";",["T_WHITESPACE","\n        ",127],["T_VARIABLE","$select",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_VARIABLE","$indexBuilder",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","build",128],"(",["T_VARIABLE","$request",128],")",";",["T_WHITESPACE","\n        ",128],["T_DOC_COMMENT","\/** @var ScoreBuilder $scoreBuilder *\/",129],["T_WHITESPACE","\n        ",129],["T_VARIABLE","$scoreBuilder",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","scoreBuilderFactory",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","create",130],"(",")",";",["T_WHITESPACE","\n        ",130],["T_VARIABLE","$select",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","processQuery",131],"(",["T_WHITESPACE","\n            ",131],["T_VARIABLE","$scoreBuilder",132],",",["T_WHITESPACE","\n            ",132],["T_VARIABLE","$request",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getQuery",133],"(",")",",",["T_WHITESPACE","\n            ",133],["T_VARIABLE","$select",134],",",["T_WHITESPACE","\n            ",134],["T_STRING","BoolQuery",135],["T_DOUBLE_COLON","::",135],["T_STRING","QUERY_CONDITION_MUST",135],",",["T_WHITESPACE","\n            ",135],["T_VARIABLE","$queryContainer",136],["T_WHITESPACE","\n        ",136],")",";",["T_WHITESPACE","\n\n        ",137],["T_VARIABLE","$select",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","addDerivedQueries",139],"(",["T_WHITESPACE","\n            ",139],["T_VARIABLE","$request",140],",",["T_WHITESPACE","\n            ",140],["T_VARIABLE","$queryContainer",141],",",["T_WHITESPACE","\n            ",141],["T_VARIABLE","$scoreBuilder",142],",",["T_WHITESPACE","\n            ",142],["T_VARIABLE","$select",143],",",["T_WHITESPACE","\n            ",143],["T_VARIABLE","$indexBuilder",144],["T_WHITESPACE","\n        ",144],")",";",["T_WHITESPACE","\n\n        ",145],["T_VARIABLE","$select",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","limit",147],"(",["T_VARIABLE","$request",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","getSize",147],"(",")",")",";",["T_WHITESPACE","\n        ",147],["T_VARIABLE","$select",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","order",148],"(",["T_CONSTANT_ENCAPSED_STRING","'relevance '",148],["T_WHITESPACE"," ",148],".",["T_WHITESPACE"," ",148],["T_STRING","Select",148],["T_DOUBLE_COLON","::",148],["T_STRING","SQL_DESC",148],")",";",["T_WHITESPACE","\n        ",148],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_VARIABLE","$select",149],";",["T_WHITESPACE","\n    ",149],"}",["T_WHITESPACE","\n\n    ",150],["T_DOC_COMMENT","\/**\n     * @param Select $select\n     * @param ScoreBuilder $scoreBuilder\n     * @param string $scorePattern\n     * @return Select\n     *\/",152],["T_WHITESPACE","\n    ",157],["T_PRIVATE","private",158],["T_WHITESPACE"," ",158],["T_FUNCTION","function",158],["T_WHITESPACE"," ",158],["T_STRING","createAroundSelect",158],"(",["T_STRING","Select",158],["T_WHITESPACE"," ",158],["T_VARIABLE","$select",158],",",["T_WHITESPACE"," ",158],["T_STRING","ScoreBuilder",158],["T_WHITESPACE"," ",158],["T_VARIABLE","$scoreBuilder",158],")",["T_WHITESPACE","\n    ",158],"{",["T_WHITESPACE","\n        ",159],["T_VARIABLE","$parentSelect",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","getConnection",160],"(",")",["T_OBJECT_OPERATOR","->",160],["T_STRING","select",160],"(",")",";",["T_WHITESPACE","\n        ",160],["T_VARIABLE","$parentSelect",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","from",161],"(",["T_WHITESPACE","\n            ",161],"[",["T_CONSTANT_ENCAPSED_STRING","'main_select'",162],["T_WHITESPACE"," ",162],["T_DOUBLE_ARROW","=>",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$select",162],"]",",",["T_WHITESPACE","\n            ",162],"[",["T_WHITESPACE","\n                ",163],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","entityMetadata",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","getEntityId",164],"(",")",["T_WHITESPACE"," ",164],["T_DOUBLE_ARROW","=>",164],["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",164],",",["T_WHITESPACE","\n                ",164],["T_CONSTANT_ENCAPSED_STRING","'relevance'",165],["T_WHITESPACE"," ",165],["T_DOUBLE_ARROW","=>",165],["T_WHITESPACE"," ",165],["T_STRING","sprintf",165],"(",["T_CONSTANT_ENCAPSED_STRING","'MAX(%s)'",165],",",["T_WHITESPACE"," ",165],["T_VARIABLE","$scoreBuilder",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","getScoreAlias",165],"(",")",")",["T_WHITESPACE","\n            ",165],"]",["T_WHITESPACE","\n        ",166],")",["T_OBJECT_OPERATOR","->",167],["T_STRING","group",167],"(",["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","entityMetadata",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","getEntityId",167],"(",")",")",";",["T_WHITESPACE","\n        ",167],["T_RETURN","return",168],["T_WHITESPACE"," ",168],["T_VARIABLE","$parentSelect",168],";",["T_WHITESPACE","\n    ",168],"}",["T_WHITESPACE","\n\n    ",169],["T_DOC_COMMENT","\/**\n     * Process query\n     *\n     * @param ScoreBuilder $scoreBuilder\n     * @param RequestQueryInterface $query\n     * @param Select $select\n     * @param string $conditionType\n     * @param QueryContainer $queryContainer\n     * @return Select\n     * @throws \\InvalidArgumentException\n     *\/",171],["T_WHITESPACE","\n    ",181],["T_PROTECTED","protected",182],["T_WHITESPACE"," ",182],["T_FUNCTION","function",182],["T_WHITESPACE"," ",182],["T_STRING","processQuery",182],"(",["T_WHITESPACE","\n        ",182],["T_STRING","ScoreBuilder",183],["T_WHITESPACE"," ",183],["T_VARIABLE","$scoreBuilder",183],",",["T_WHITESPACE","\n        ",183],["T_STRING","RequestQueryInterface",184],["T_WHITESPACE"," ",184],["T_VARIABLE","$query",184],",",["T_WHITESPACE","\n        ",184],["T_STRING","Select",185],["T_WHITESPACE"," ",185],["T_VARIABLE","$select",185],",",["T_WHITESPACE","\n        ",185],["T_VARIABLE","$conditionType",186],",",["T_WHITESPACE","\n        ",186],["T_STRING","QueryContainer",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$queryContainer",187],["T_WHITESPACE","\n    ",187],")",["T_WHITESPACE"," ",188],"{",["T_WHITESPACE","\n        ",188],["T_SWITCH","switch",189],["T_WHITESPACE"," ",189],"(",["T_VARIABLE","$query",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getType",189],"(",")",")",["T_WHITESPACE"," ",189],"{",["T_WHITESPACE","\n            ",189],["T_CASE","case",190],["T_WHITESPACE"," ",190],["T_STRING","RequestQueryInterface",190],["T_DOUBLE_COLON","::",190],["T_STRING","TYPE_MATCH",190],":",["T_WHITESPACE","\n                ",190],["T_DOC_COMMENT","\/** @var MatchQuery $query *\/",191],["T_WHITESPACE","\n                ",191],["T_VARIABLE","$select",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_VARIABLE","$queryContainer",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","addMatchQuery",192],"(",["T_WHITESPACE","\n                    ",192],["T_VARIABLE","$select",193],",",["T_WHITESPACE","\n                    ",193],["T_VARIABLE","$query",194],",",["T_WHITESPACE","\n                    ",194],["T_VARIABLE","$conditionType",195],["T_WHITESPACE","\n                ",195],")",";",["T_WHITESPACE","\n                ",196],["T_BREAK","break",197],";",["T_WHITESPACE","\n            ",197],["T_CASE","case",198],["T_WHITESPACE"," ",198],["T_STRING","RequestQueryInterface",198],["T_DOUBLE_COLON","::",198],["T_STRING","TYPE_BOOL",198],":",["T_WHITESPACE","\n                ",198],["T_DOC_COMMENT","\/** @var BoolQuery $query *\/",199],["T_WHITESPACE","\n                ",199],["T_VARIABLE","$select",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","processBoolQuery",200],"(",["T_VARIABLE","$scoreBuilder",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$query",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$select",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$queryContainer",200],")",";",["T_WHITESPACE","\n                ",200],["T_BREAK","break",201],";",["T_WHITESPACE","\n            ",201],["T_CASE","case",202],["T_WHITESPACE"," ",202],["T_STRING","RequestQueryInterface",202],["T_DOUBLE_COLON","::",202],["T_STRING","TYPE_FILTER",202],":",["T_WHITESPACE","\n                ",202],["T_DOC_COMMENT","\/** @var FilterQuery $query *\/",203],["T_WHITESPACE","\n                ",203],["T_VARIABLE","$select",204],["T_WHITESPACE"," ",204],"=",["T_WHITESPACE"," ",204],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","processFilterQuery",204],"(",["T_VARIABLE","$scoreBuilder",204],",",["T_WHITESPACE"," ",204],["T_VARIABLE","$query",204],",",["T_WHITESPACE"," ",204],["T_VARIABLE","$select",204],",",["T_WHITESPACE"," ",204],["T_VARIABLE","$conditionType",204],",",["T_WHITESPACE"," ",204],["T_VARIABLE","$queryContainer",204],")",";",["T_WHITESPACE","\n                ",204],["T_BREAK","break",205],";",["T_WHITESPACE","\n            ",205],["T_DEFAULT","default",206],":",["T_WHITESPACE","\n                ",206],["T_THROW","throw",207],["T_WHITESPACE"," ",207],["T_NEW","new",207],["T_WHITESPACE"," ",207],["T_NS_SEPARATOR","\\",207],["T_STRING","InvalidArgumentException",207],"(",["T_STRING","sprintf",207],"(",["T_CONSTANT_ENCAPSED_STRING","'Unknown query type \\'%s\\''",207],",",["T_WHITESPACE"," ",207],["T_VARIABLE","$query",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","getType",207],"(",")",")",")",";",["T_WHITESPACE","\n        ",207],"}",["T_WHITESPACE","\n        ",208],["T_RETURN","return",209],["T_WHITESPACE"," ",209],["T_VARIABLE","$select",209],";",["T_WHITESPACE","\n    ",209],"}",["T_WHITESPACE","\n\n    ",210],["T_DOC_COMMENT","\/**\n     * Process bool query\n     *\n     * @param ScoreBuilder $scoreBuilder\n     * @param BoolQuery $query\n     * @param Select $select\n     * @param QueryContainer $queryContainer\n     * @return Select\n     *\/",212],["T_WHITESPACE","\n    ",220],["T_PRIVATE","private",221],["T_WHITESPACE"," ",221],["T_FUNCTION","function",221],["T_WHITESPACE"," ",221],["T_STRING","processBoolQuery",221],"(",["T_WHITESPACE","\n        ",221],["T_STRING","ScoreBuilder",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$scoreBuilder",222],",",["T_WHITESPACE","\n        ",222],["T_STRING","BoolQuery",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$query",223],",",["T_WHITESPACE","\n        ",223],["T_STRING","Select",224],["T_WHITESPACE"," ",224],["T_VARIABLE","$select",224],",",["T_WHITESPACE","\n        ",224],["T_STRING","QueryContainer",225],["T_WHITESPACE"," ",225],["T_VARIABLE","$queryContainer",225],["T_WHITESPACE","\n    ",225],")",["T_WHITESPACE"," ",226],"{",["T_WHITESPACE","\n        ",226],["T_VARIABLE","$scoreBuilder",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","startQuery",227],"(",")",";",["T_WHITESPACE","\n\n        ",227],["T_VARIABLE","$select",229],["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","processBoolQueryCondition",229],"(",["T_WHITESPACE","\n            ",229],["T_VARIABLE","$scoreBuilder",230],",",["T_WHITESPACE","\n            ",230],["T_VARIABLE","$query",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","getMust",231],"(",")",",",["T_WHITESPACE","\n            ",231],["T_VARIABLE","$select",232],",",["T_WHITESPACE","\n            ",232],["T_STRING","BoolQuery",233],["T_DOUBLE_COLON","::",233],["T_STRING","QUERY_CONDITION_MUST",233],",",["T_WHITESPACE","\n            ",233],["T_VARIABLE","$queryContainer",234],["T_WHITESPACE","\n        ",234],")",";",["T_WHITESPACE","\n\n        ",235],["T_VARIABLE","$select",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","processBoolQueryCondition",237],"(",["T_WHITESPACE","\n            ",237],["T_VARIABLE","$scoreBuilder",238],",",["T_WHITESPACE","\n            ",238],["T_VARIABLE","$query",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","getShould",239],"(",")",",",["T_WHITESPACE","\n            ",239],["T_VARIABLE","$select",240],",",["T_WHITESPACE","\n            ",240],["T_STRING","BoolQuery",241],["T_DOUBLE_COLON","::",241],["T_STRING","QUERY_CONDITION_SHOULD",241],",",["T_WHITESPACE","\n            ",241],["T_VARIABLE","$queryContainer",242],["T_WHITESPACE","\n        ",242],")",";",["T_WHITESPACE","\n\n        ",243],["T_VARIABLE","$select",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","processBoolQueryCondition",245],"(",["T_WHITESPACE","\n            ",245],["T_VARIABLE","$scoreBuilder",246],",",["T_WHITESPACE","\n            ",246],["T_VARIABLE","$query",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","getMustNot",247],"(",")",",",["T_WHITESPACE","\n            ",247],["T_VARIABLE","$select",248],",",["T_WHITESPACE","\n            ",248],["T_STRING","BoolQuery",249],["T_DOUBLE_COLON","::",249],["T_STRING","QUERY_CONDITION_NOT",249],",",["T_WHITESPACE","\n            ",249],["T_VARIABLE","$queryContainer",250],["T_WHITESPACE","\n        ",250],")",";",["T_WHITESPACE","\n\n        ",251],["T_VARIABLE","$scoreBuilder",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","endQuery",253],"(",["T_VARIABLE","$query",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","getBoost",253],"(",")",")",";",["T_WHITESPACE","\n\n        ",253],["T_RETURN","return",255],["T_WHITESPACE"," ",255],["T_VARIABLE","$select",255],";",["T_WHITESPACE","\n    ",255],"}",["T_WHITESPACE","\n\n    ",256],["T_DOC_COMMENT","\/**\n     * Process bool query condition (must, should, must_not)\n     *\n     * @param ScoreBuilder $scoreBuilder\n     * @param RequestQueryInterface[] $subQueryList\n     * @param Select $select\n     * @param string $conditionType\n     * @param QueryContainer $queryContainer\n     * @return Select\n     *\/",258],["T_WHITESPACE","\n    ",267],["T_PRIVATE","private",268],["T_WHITESPACE"," ",268],["T_FUNCTION","function",268],["T_WHITESPACE"," ",268],["T_STRING","processBoolQueryCondition",268],"(",["T_WHITESPACE","\n        ",268],["T_STRING","ScoreBuilder",269],["T_WHITESPACE"," ",269],["T_VARIABLE","$scoreBuilder",269],",",["T_WHITESPACE","\n        ",269],["T_ARRAY","array",270],["T_WHITESPACE"," ",270],["T_VARIABLE","$subQueryList",270],",",["T_WHITESPACE","\n        ",270],["T_STRING","Select",271],["T_WHITESPACE"," ",271],["T_VARIABLE","$select",271],",",["T_WHITESPACE","\n        ",271],["T_VARIABLE","$conditionType",272],",",["T_WHITESPACE","\n        ",272],["T_STRING","QueryContainer",273],["T_WHITESPACE"," ",273],["T_VARIABLE","$queryContainer",273],["T_WHITESPACE","\n    ",273],")",["T_WHITESPACE"," ",274],"{",["T_WHITESPACE","\n        ",274],["T_FOREACH","foreach",275],["T_WHITESPACE"," ",275],"(",["T_VARIABLE","$subQueryList",275],["T_WHITESPACE"," ",275],["T_AS","as",275],["T_WHITESPACE"," ",275],["T_VARIABLE","$subQuery",275],")",["T_WHITESPACE"," ",275],"{",["T_WHITESPACE","\n            ",275],["T_VARIABLE","$select",276],["T_WHITESPACE"," ",276],"=",["T_WHITESPACE"," ",276],["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","processQuery",276],"(",["T_VARIABLE","$scoreBuilder",276],",",["T_WHITESPACE"," ",276],["T_VARIABLE","$subQuery",276],",",["T_WHITESPACE"," ",276],["T_VARIABLE","$select",276],",",["T_WHITESPACE"," ",276],["T_VARIABLE","$conditionType",276],",",["T_WHITESPACE"," ",276],["T_VARIABLE","$queryContainer",276],")",";",["T_WHITESPACE","\n        ",276],"}",["T_WHITESPACE","\n        ",277],["T_RETURN","return",278],["T_WHITESPACE"," ",278],["T_VARIABLE","$select",278],";",["T_WHITESPACE","\n    ",278],"}",["T_WHITESPACE","\n\n    ",279],["T_DOC_COMMENT","\/**\n     * Process filter query\n     *\n     * @param ScoreBuilder $scoreBuilder\n     * @param FilterQuery $query\n     * @param Select $select\n     * @param string $conditionType\n     * @param QueryContainer $queryContainer\n     * @return Select\n     *\/",281],["T_WHITESPACE","\n    ",290],["T_PRIVATE","private",291],["T_WHITESPACE"," ",291],["T_FUNCTION","function",291],["T_WHITESPACE"," ",291],["T_STRING","processFilterQuery",291],"(",["T_WHITESPACE","\n        ",291],["T_STRING","ScoreBuilder",292],["T_WHITESPACE"," ",292],["T_VARIABLE","$scoreBuilder",292],",",["T_WHITESPACE","\n        ",292],["T_STRING","FilterQuery",293],["T_WHITESPACE"," ",293],["T_VARIABLE","$query",293],",",["T_WHITESPACE","\n        ",293],["T_STRING","Select",294],["T_WHITESPACE"," ",294],["T_VARIABLE","$select",294],",",["T_WHITESPACE","\n        ",294],["T_VARIABLE","$conditionType",295],",",["T_WHITESPACE","\n        ",295],["T_STRING","QueryContainer",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$queryContainer",296],["T_WHITESPACE","\n    ",296],")",["T_WHITESPACE"," ",297],"{",["T_WHITESPACE","\n        ",297],["T_VARIABLE","$scoreBuilder",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","startQuery",298],"(",")",";",["T_WHITESPACE","\n        ",298],["T_SWITCH","switch",299],["T_WHITESPACE"," ",299],"(",["T_VARIABLE","$query",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","getReferenceType",299],"(",")",")",["T_WHITESPACE"," ",299],"{",["T_WHITESPACE","\n            ",299],["T_CASE","case",300],["T_WHITESPACE"," ",300],["T_STRING","FilterQuery",300],["T_DOUBLE_COLON","::",300],["T_STRING","REFERENCE_QUERY",300],":",["T_WHITESPACE","\n                ",300],["T_VARIABLE","$select",301],["T_WHITESPACE"," ",301],"=",["T_WHITESPACE"," ",301],["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","processQuery",301],"(",["T_WHITESPACE","\n                    ",301],["T_VARIABLE","$scoreBuilder",302],",",["T_WHITESPACE","\n                    ",302],["T_VARIABLE","$query",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","getReference",303],"(",")",",",["T_WHITESPACE","\n                    ",303],["T_VARIABLE","$select",304],",",["T_WHITESPACE","\n                    ",304],["T_VARIABLE","$conditionType",305],",",["T_WHITESPACE","\n                    ",305],["T_VARIABLE","$queryContainer",306],["T_WHITESPACE","\n                ",306],")",";",["T_WHITESPACE","\n                ",307],["T_VARIABLE","$scoreBuilder",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","endQuery",308],"(",["T_VARIABLE","$query",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","getBoost",308],"(",")",")",";",["T_WHITESPACE","\n                ",308],["T_BREAK","break",309],";",["T_WHITESPACE","\n            ",309],["T_CASE","case",310],["T_WHITESPACE"," ",310],["T_STRING","FilterQuery",310],["T_DOUBLE_COLON","::",310],["T_STRING","REFERENCE_FILTER",310],":",["T_WHITESPACE","\n                ",310],["T_VARIABLE","$filterCondition",311],["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","filterBuilder",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","build",311],"(",["T_VARIABLE","$query",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","getReference",311],"(",")",",",["T_WHITESPACE"," ",311],["T_VARIABLE","$conditionType",311],")",";",["T_WHITESPACE","\n                ",311],["T_IF","if",312],["T_WHITESPACE"," ",312],"(",["T_VARIABLE","$filterCondition",312],")",["T_WHITESPACE"," ",312],"{",["T_WHITESPACE","\n                    ",312],["T_VARIABLE","$select",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","where",313],"(",["T_VARIABLE","$filterCondition",313],")",";",["T_WHITESPACE","\n                ",313],"}",["T_WHITESPACE","\n                ",314],["T_BREAK","break",315],";",["T_WHITESPACE","\n        ",315],"}",["T_WHITESPACE","\n        ",316],["T_VARIABLE","$scoreBuilder",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","endQuery",317],"(",["T_VARIABLE","$query",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","getBoost",317],"(",")",")",";",["T_WHITESPACE","\n        ",317],["T_RETURN","return",318],["T_WHITESPACE"," ",318],["T_VARIABLE","$select",318],";",["T_WHITESPACE","\n    ",318],"}",["T_WHITESPACE","\n\n    ",319],["T_DOC_COMMENT","\/**\n     * @param RequestInterface $request\n     * @param QueryContainer $queryContainer\n     * @param ScoreBuilder $scoreBuilder\n     * @param Select $select\n     * @param IndexBuilderInterface $indexBuilder\n     * @return Select\n     * @throws \\Zend_Db_Exception\n     *\/",321],["T_WHITESPACE","\n    ",329],["T_PRIVATE","private",330],["T_WHITESPACE"," ",330],["T_FUNCTION","function",330],["T_WHITESPACE"," ",330],["T_STRING","addDerivedQueries",330],"(",["T_WHITESPACE","\n        ",330],["T_STRING","RequestInterface",331],["T_WHITESPACE"," ",331],["T_VARIABLE","$request",331],",",["T_WHITESPACE","\n        ",331],["T_STRING","QueryContainer",332],["T_WHITESPACE"," ",332],["T_VARIABLE","$queryContainer",332],",",["T_WHITESPACE","\n        ",332],["T_STRING","ScoreBuilder",333],["T_WHITESPACE"," ",333],["T_VARIABLE","$scoreBuilder",333],",",["T_WHITESPACE","\n        ",333],["T_STRING","Select",334],["T_WHITESPACE"," ",334],["T_VARIABLE","$select",334],",",["T_WHITESPACE","\n        ",334],["T_STRING","IndexBuilderInterface",335],["T_WHITESPACE"," ",335],["T_VARIABLE","$indexBuilder",335],["T_WHITESPACE","\n    ",335],")",["T_WHITESPACE"," ",336],"{",["T_WHITESPACE","\n        ",336],["T_VARIABLE","$matchQueries",337],["T_WHITESPACE"," ",337],"=",["T_WHITESPACE"," ",337],["T_VARIABLE","$queryContainer",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","getMatchQueries",337],"(",")",";",["T_WHITESPACE","\n        ",337],["T_IF","if",338],["T_WHITESPACE"," ",338],"(","!",["T_VARIABLE","$matchQueries",338],")",["T_WHITESPACE"," ",338],"{",["T_WHITESPACE","\n            ",338],["T_VARIABLE","$select",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","columns",339],"(",["T_VARIABLE","$scoreBuilder",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","build",339],"(",")",")",";",["T_WHITESPACE","\n            ",339],["T_VARIABLE","$select",340],["T_WHITESPACE"," ",340],"=",["T_WHITESPACE"," ",340],["T_VARIABLE","$this",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","createAroundSelect",340],"(",["T_VARIABLE","$select",340],",",["T_WHITESPACE"," ",340],["T_VARIABLE","$scoreBuilder",340],")",";",["T_WHITESPACE","\n        ",340],"}",["T_WHITESPACE"," ",341],["T_ELSE","else",341],["T_WHITESPACE"," ",341],"{",["T_WHITESPACE","\n            ",341],["T_VARIABLE","$matchContainer",342],["T_WHITESPACE"," ",342],"=",["T_WHITESPACE"," ",342],["T_STRING","array_shift",342],"(",["T_VARIABLE","$matchQueries",342],")",";",["T_WHITESPACE","\n            ",342],["T_VARIABLE","$this",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","matchBuilder",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","build",343],"(",["T_WHITESPACE","\n                ",343],["T_VARIABLE","$scoreBuilder",344],",",["T_WHITESPACE","\n                ",344],["T_VARIABLE","$select",345],",",["T_WHITESPACE","\n                ",345],["T_VARIABLE","$matchContainer",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","getRequest",346],"(",")",",",["T_WHITESPACE","\n                ",346],["T_VARIABLE","$matchContainer",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","getConditionType",347],"(",")",["T_WHITESPACE","\n            ",347],")",";",["T_WHITESPACE","\n            ",348],["T_VARIABLE","$select",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","columns",349],"(",["T_VARIABLE","$scoreBuilder",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","build",349],"(",")",")",";",["T_WHITESPACE","\n            ",349],["T_VARIABLE","$select",350],["T_WHITESPACE"," ",350],"=",["T_WHITESPACE"," ",350],["T_VARIABLE","$this",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","createAroundSelect",350],"(",["T_VARIABLE","$select",350],",",["T_WHITESPACE"," ",350],["T_VARIABLE","$scoreBuilder",350],")",";",["T_WHITESPACE","\n            ",350],["T_VARIABLE","$select",351],["T_WHITESPACE"," ",351],"=",["T_WHITESPACE"," ",351],["T_VARIABLE","$this",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","addMatchQueries",351],"(",["T_VARIABLE","$request",351],",",["T_WHITESPACE"," ",351],["T_VARIABLE","$select",351],",",["T_WHITESPACE"," ",351],["T_VARIABLE","$indexBuilder",351],",",["T_WHITESPACE"," ",351],["T_VARIABLE","$matchQueries",351],")",";",["T_WHITESPACE","\n        ",351],"}",["T_WHITESPACE","\n\n        ",352],["T_RETURN","return",354],["T_WHITESPACE"," ",354],["T_VARIABLE","$select",354],";",["T_WHITESPACE","\n    ",354],"}",["T_WHITESPACE","\n\n    ",355],["T_DOC_COMMENT","\/**\n     * @return false|\\Magento\\Framework\\DB\\Adapter\\AdapterInterface\n     *\/",357],["T_WHITESPACE","\n    ",359],["T_PRIVATE","private",360],["T_WHITESPACE"," ",360],["T_FUNCTION","function",360],["T_WHITESPACE"," ",360],["T_STRING","getConnection",360],"(",")",["T_WHITESPACE","\n    ",360],"{",["T_WHITESPACE","\n        ",361],["T_RETURN","return",362],["T_WHITESPACE"," ",362],["T_VARIABLE","$this",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","resource",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","getConnection",362],"(",")",";",["T_WHITESPACE","\n    ",362],"}",["T_WHITESPACE","\n\n    ",363],["T_DOC_COMMENT","\/**\n     * @param RequestInterface $request\n     * @param Select $select\n     * @param IndexBuilderInterface $indexBuilder\n     * @param MatchContainer[] $matchQueries\n     * @return Select\n     *\/",365],["T_WHITESPACE","\n    ",371],["T_PRIVATE","private",372],["T_WHITESPACE"," ",372],["T_FUNCTION","function",372],["T_WHITESPACE"," ",372],["T_STRING","addMatchQueries",372],"(",["T_WHITESPACE","\n        ",372],["T_STRING","RequestInterface",373],["T_WHITESPACE"," ",373],["T_VARIABLE","$request",373],",",["T_WHITESPACE","\n        ",373],["T_STRING","Select",374],["T_WHITESPACE"," ",374],["T_VARIABLE","$select",374],",",["T_WHITESPACE","\n        ",374],["T_STRING","IndexBuilderInterface",375],["T_WHITESPACE"," ",375],["T_VARIABLE","$indexBuilder",375],",",["T_WHITESPACE","\n        ",375],["T_ARRAY","array",376],["T_WHITESPACE"," ",376],["T_VARIABLE","$matchQueries",376],["T_WHITESPACE","\n    ",376],")",["T_WHITESPACE"," ",377],"{",["T_WHITESPACE","\n        ",377],["T_VARIABLE","$queriesCount",378],["T_WHITESPACE"," ",378],"=",["T_WHITESPACE"," ",378],["T_STRING","count",378],"(",["T_VARIABLE","$matchQueries",378],")",";",["T_WHITESPACE","\n        ",378],["T_IF","if",379],["T_WHITESPACE"," ",379],"(",["T_VARIABLE","$queriesCount",379],")",["T_WHITESPACE"," ",379],"{",["T_WHITESPACE","\n            ",379],["T_VARIABLE","$table",380],["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],["T_VARIABLE","$this",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","temporaryStorage",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","storeDocumentsFromSelect",380],"(",["T_VARIABLE","$select",380],")",";",["T_WHITESPACE","\n            ",380],["T_FOREACH","foreach",381],["T_WHITESPACE"," ",381],"(",["T_VARIABLE","$matchQueries",381],["T_WHITESPACE"," ",381],["T_AS","as",381],["T_WHITESPACE"," ",381],["T_VARIABLE","$matchContainer",381],")",["T_WHITESPACE"," ",381],"{",["T_WHITESPACE","\n                ",381],["T_VARIABLE","$queriesCount",382],["T_DEC","--",382],";",["T_WHITESPACE","\n                ",382],["T_VARIABLE","$matchScoreBuilder",383],["T_WHITESPACE"," ",383],"=",["T_WHITESPACE"," ",383],["T_VARIABLE","$this",383],["T_OBJECT_OPERATOR","->",383],["T_STRING","scoreBuilderFactory",383],["T_OBJECT_OPERATOR","->",383],["T_STRING","create",383],"(",")",";",["T_WHITESPACE","\n                ",383],["T_VARIABLE","$matchSelect",384],["T_WHITESPACE"," ",384],"=",["T_WHITESPACE"," ",384],["T_VARIABLE","$this",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","matchBuilder",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","build",384],"(",["T_WHITESPACE","\n                    ",384],["T_VARIABLE","$matchScoreBuilder",385],",",["T_WHITESPACE","\n                    ",385],["T_VARIABLE","$indexBuilder",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","build",386],"(",["T_VARIABLE","$request",386],")",",",["T_WHITESPACE","\n                    ",386],["T_VARIABLE","$matchContainer",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","getRequest",387],"(",")",",",["T_WHITESPACE","\n                    ",387],["T_VARIABLE","$matchContainer",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","getConditionType",388],"(",")",["T_WHITESPACE","\n                ",388],")",";",["T_WHITESPACE","\n                ",389],["T_VARIABLE","$select",390],["T_WHITESPACE"," ",390],"=",["T_WHITESPACE"," ",390],["T_VARIABLE","$this",390],["T_OBJECT_OPERATOR","->",390],["T_STRING","joinPreviousResultToSelect",390],"(",["T_VARIABLE","$matchSelect",390],",",["T_WHITESPACE"," ",390],["T_VARIABLE","$table",390],",",["T_WHITESPACE"," ",390],["T_VARIABLE","$matchScoreBuilder",390],")",";",["T_WHITESPACE","\n                ",390],["T_IF","if",391],["T_WHITESPACE"," ",391],"(",["T_VARIABLE","$queriesCount",391],")",["T_WHITESPACE"," ",391],"{",["T_WHITESPACE","\n                    ",391],["T_VARIABLE","$previousResultTable",392],["T_WHITESPACE"," ",392],"=",["T_WHITESPACE"," ",392],["T_VARIABLE","$table",392],";",["T_WHITESPACE","\n                    ",392],["T_VARIABLE","$table",393],["T_WHITESPACE"," ",393],"=",["T_WHITESPACE"," ",393],["T_VARIABLE","$this",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","temporaryStorage",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","storeDocumentsFromSelect",393],"(",["T_VARIABLE","$select",393],")",";",["T_WHITESPACE","\n                    ",393],["T_VARIABLE","$this",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","getConnection",394],"(",")",["T_OBJECT_OPERATOR","->",394],["T_STRING","dropTable",394],"(",["T_VARIABLE","$previousResultTable",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","getName",394],"(",")",")",";",["T_WHITESPACE","\n                ",394],"}",["T_WHITESPACE","\n            ",395],"}",["T_WHITESPACE","\n        ",396],"}",["T_WHITESPACE","\n        ",397],["T_RETURN","return",398],["T_WHITESPACE"," ",398],["T_VARIABLE","$select",398],";",["T_WHITESPACE","\n    ",398],"}",["T_WHITESPACE","\n\n    ",399],["T_DOC_COMMENT","\/**\n     * @param Select $query\n     * @param Table $previousResultTable\n     * @param ScoreBuilder $scoreBuilder\n     * @return Select\n     * @throws \\Zend_Db_Exception\n     *\/",401],["T_WHITESPACE","\n    ",407],["T_PRIVATE","private",408],["T_WHITESPACE"," ",408],["T_FUNCTION","function",408],["T_WHITESPACE"," ",408],["T_STRING","joinPreviousResultToSelect",408],"(",["T_STRING","Select",408],["T_WHITESPACE"," ",408],["T_VARIABLE","$query",408],",",["T_WHITESPACE"," ",408],["T_STRING","Table",408],["T_WHITESPACE"," ",408],["T_VARIABLE","$previousResultTable",408],",",["T_WHITESPACE"," ",408],["T_STRING","ScoreBuilder",408],["T_WHITESPACE"," ",408],["T_VARIABLE","$scoreBuilder",408],")",["T_WHITESPACE","\n    ",408],"{",["T_WHITESPACE","\n        ",409],["T_VARIABLE","$query",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","joinInner",410],"(",["T_WHITESPACE","\n            ",410],"[",["T_CONSTANT_ENCAPSED_STRING","'previous_results'",411],["T_WHITESPACE"," ",411],["T_DOUBLE_ARROW","=>",411],["T_WHITESPACE"," ",411],["T_VARIABLE","$previousResultTable",411],["T_OBJECT_OPERATOR","->",411],["T_STRING","getName",411],"(",")","]",",",["T_WHITESPACE","\n            ",411],["T_CONSTANT_ENCAPSED_STRING","'previous_results.entity_id = search_index.entity_id'",412],",",["T_WHITESPACE","\n            ",412],"[","]",["T_WHITESPACE","\n        ",413],")",";",["T_WHITESPACE","\n        ",414],["T_VARIABLE","$scoreBuilder",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","addCondition",415],"(",["T_CONSTANT_ENCAPSED_STRING","'previous_results.score'",415],",",["T_WHITESPACE"," ",415],["T_STRING","false",415],")",";",["T_WHITESPACE","\n        ",415],["T_VARIABLE","$query",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","columns",416],"(",["T_VARIABLE","$scoreBuilder",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","build",416],"(",")",")",";",["T_WHITESPACE","\n\n        ",416],["T_VARIABLE","$query",418],["T_WHITESPACE"," ",418],"=",["T_WHITESPACE"," ",418],["T_VARIABLE","$this",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","createAroundSelect",418],"(",["T_VARIABLE","$query",418],",",["T_WHITESPACE"," ",418],["T_VARIABLE","$scoreBuilder",418],")",";",["T_WHITESPACE","\n\n        ",418],["T_RETURN","return",420],["T_WHITESPACE"," ",420],["T_VARIABLE","$query",420],";",["T_WHITESPACE","\n    ",420],"}",["T_WHITESPACE","\n",421],"}",["T_WHITESPACE","\n",422]]