[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Framework",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Search",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Request",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Exception",8],["T_NS_SEPARATOR","\\",8],["T_STRING","StateException",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Search",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Request",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Aggregation",9],["T_NS_SEPARATOR","\\",9],["T_STRING","StatusInterface",9],["T_WHITESPACE"," ",9],["T_AS","as",9],["T_WHITESPACE"," ",9],["T_STRING","AggregationStatus",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Phrase",10],";",["T_WHITESPACE","\n\n",10],["T_CLASS","class",12],["T_WHITESPACE"," ",12],["T_STRING","Cleaner",12],["T_WHITESPACE","\n",12],"{",["T_WHITESPACE","\n    ",13],["T_DOC_COMMENT","\/**\n     * @var array\n     *\/",14],["T_WHITESPACE","\n    ",16],["T_PRIVATE","private",17],["T_WHITESPACE"," ",17],["T_VARIABLE","$requestData",17],";",["T_WHITESPACE","\n\n    ",17],["T_DOC_COMMENT","\/**\n     * @var array\n     *\/",19],["T_WHITESPACE","\n    ",21],["T_PRIVATE","private",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$mappedQueries",22],";",["T_WHITESPACE","\n\n    ",22],["T_DOC_COMMENT","\/**\n     * @var array\n     *\/",24],["T_WHITESPACE","\n    ",26],["T_PRIVATE","private",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$mappedFilters",27],";",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * @var AggregationStatus\n     *\/",29],["T_WHITESPACE","\n    ",31],["T_PRIVATE","private",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$aggregationStatus",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * Cleaner constructor\n     *\n     * @param AggregationStatus $aggregationStatus\n     *\/",34],["T_WHITESPACE","\n    ",38],["T_PUBLIC","public",39],["T_WHITESPACE"," ",39],["T_FUNCTION","function",39],["T_WHITESPACE"," ",39],["T_STRING","__construct",39],"(",["T_STRING","AggregationStatus",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$aggregationStatus",39],")",["T_WHITESPACE","\n    ",39],"{",["T_WHITESPACE","\n        ",40],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","aggregationStatus",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$aggregationStatus",41],";",["T_WHITESPACE","\n    ",41],"}",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Clean not binder queries and filters\n     *\n     * @param array $requestData\n     * @return array\n     *\/",44],["T_WHITESPACE","\n    ",49],["T_PUBLIC","public",50],["T_WHITESPACE"," ",50],["T_FUNCTION","function",50],["T_WHITESPACE"," ",50],["T_STRING","clean",50],"(",["T_ARRAY","array",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$requestData",50],")",["T_WHITESPACE","\n    ",50],"{",["T_WHITESPACE","\n        ",51],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","clear",52],"(",")",";",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","requestData",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$requestData",53],";",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","cleanQuery",54],"(",["T_VARIABLE","$requestData",54],"[",["T_CONSTANT_ENCAPSED_STRING","'query'",54],"]",")",";",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","cleanAggregations",55],"(",")",";",["T_WHITESPACE","\n        ",55],["T_VARIABLE","$requestData",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","requestData",56],";",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","clear",57],"(",")",";",["T_WHITESPACE","\n\n        ",57],["T_IF","if",59],["T_WHITESPACE"," ",59],"(",["T_EMPTY","empty",59],"(",["T_VARIABLE","$requestData",59],"[",["T_CONSTANT_ENCAPSED_STRING","'queries'",59],"]",")",["T_WHITESPACE"," ",59],["T_BOOLEAN_AND","&&",59],["T_WHITESPACE"," ",59],["T_EMPTY","empty",59],"(",["T_VARIABLE","$requestData",59],"[",["T_CONSTANT_ENCAPSED_STRING","'filters'",59],"]",")",")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n            ",59],["T_THROW","throw",60],["T_WHITESPACE"," ",60],["T_NEW","new",60],["T_WHITESPACE"," ",60],["T_STRING","EmptyRequestDataException",60],"(",["T_NEW","new",60],["T_WHITESPACE"," ",60],["T_STRING","Phrase",60],"(",["T_CONSTANT_ENCAPSED_STRING","'Request query and filters are not set'",60],")",")",";",["T_WHITESPACE","\n        ",60],"}",["T_WHITESPACE","\n\n        ",61],["T_RETURN","return",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$requestData",63],";",["T_WHITESPACE","\n    ",63],"}",["T_WHITESPACE","\n\n    ",64],["T_DOC_COMMENT","\/**\n     * Clear don't bind queries\n     *\n     * @param string $queryName\n     * @return void\n     * @throws StateException\n     * @throws \\Exception\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     * @SuppressWarnings(PHPMD.UnusedLocalVariable)\n     *\/",66],["T_WHITESPACE","\n    ",75],["T_PRIVATE","private",76],["T_WHITESPACE"," ",76],["T_FUNCTION","function",76],["T_WHITESPACE"," ",76],["T_STRING","cleanQuery",76],"(",["T_VARIABLE","$queryName",76],")",["T_WHITESPACE","\n    ",76],"{",["T_WHITESPACE","\n        ",77],["T_IF","if",78],["T_WHITESPACE"," ",78],"(","!",["T_ISSET","isset",78],"(",["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","requestData",78],"[",["T_CONSTANT_ENCAPSED_STRING","'queries'",78],"]","[",["T_VARIABLE","$queryName",78],"]",")",")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n            ",78],["T_THROW","throw",79],["T_WHITESPACE"," ",79],["T_NEW","new",79],["T_WHITESPACE"," ",79],["T_NS_SEPARATOR","\\",79],["T_STRING","Exception",79],"(",["T_CONSTANT_ENCAPSED_STRING","'Query '",79],["T_WHITESPACE"," ",79],".",["T_WHITESPACE"," ",79],["T_VARIABLE","$queryName",79],["T_WHITESPACE"," ",79],".",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","' does not exist'",79],")",";",["T_WHITESPACE","\n        ",79],"}",["T_WHITESPACE"," ",80],["T_ELSEIF","elseif",80],["T_WHITESPACE"," ",80],"(",["T_STRING","in_array",80],"(",["T_VARIABLE","$queryName",80],",",["T_WHITESPACE"," ",80],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","mappedQueries",80],")",")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n            ",80],["T_THROW","throw",81],["T_WHITESPACE"," ",81],["T_NEW","new",81],["T_WHITESPACE"," ",81],["T_STRING","StateException",81],"(",["T_WHITESPACE","\n                ",81],["T_NEW","new",82],["T_WHITESPACE"," ",82],["T_STRING","Phrase",82],"(",["T_CONSTANT_ENCAPSED_STRING","'Cycle found. Query %1 already used in request hierarchy'",82],",",["T_WHITESPACE"," ",82],"[",["T_VARIABLE","$queryName",82],"]",")",["T_WHITESPACE","\n            ",82],")",";",["T_WHITESPACE","\n        ",83],"}",["T_WHITESPACE","\n        ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","mappedQueries",85],"[","]",["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_VARIABLE","$queryName",85],";",["T_WHITESPACE","\n        ",85],["T_VARIABLE","$query",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","requestData",86],"[",["T_CONSTANT_ENCAPSED_STRING","'queries'",86],"]","[",["T_VARIABLE","$queryName",86],"]",";",["T_WHITESPACE","\n        ",86],["T_SWITCH","switch",87],["T_WHITESPACE"," ",87],"(",["T_VARIABLE","$query",87],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",87],"]",")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n            ",87],["T_CASE","case",88],["T_WHITESPACE"," ",88],["T_STRING","QueryInterface",88],["T_DOUBLE_COLON","::",88],["T_STRING","TYPE_BOOL",88],":",["T_WHITESPACE","\n                ",88],["T_VARIABLE","$queryReference",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","processQueryReference",89],"(",["T_VARIABLE","$query",89],"[",["T_CONSTANT_ENCAPSED_STRING","'queryReference'",89],"]",")",";",["T_WHITESPACE","\n                ",89],["T_IF","if",90],["T_WHITESPACE"," ",90],"(",["T_EMPTY","empty",90],"(",["T_VARIABLE","$queryReference",90],")",")",["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n                    ",90],["T_UNSET","unset",91],"(",["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","requestData",91],"[",["T_CONSTANT_ENCAPSED_STRING","'queries'",91],"]","[",["T_VARIABLE","$queryName",91],"]",")",";",["T_WHITESPACE","\n                ",91],"}",["T_WHITESPACE"," ",92],["T_ELSE","else",92],["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n                    ",92],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","requestData",93],"[",["T_CONSTANT_ENCAPSED_STRING","'queries'",93],"]","[",["T_VARIABLE","$queryName",93],"]","[",["T_CONSTANT_ENCAPSED_STRING","'queryReference'",93],"]",["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_STRING","array_values",93],"(",["T_VARIABLE","$queryReference",93],")",";",["T_WHITESPACE","\n                ",93],"}",["T_WHITESPACE","\n                ",94],["T_BREAK","break",95],";",["T_WHITESPACE","\n            ",95],["T_CASE","case",96],["T_WHITESPACE"," ",96],["T_STRING","QueryInterface",96],["T_DOUBLE_COLON","::",96],["T_STRING","TYPE_MATCH",96],":",["T_WHITESPACE","\n                ",96],["T_IF","if",97],["T_WHITESPACE"," ",97],"(","!",["T_STRING","array_key_exists",97],"(",["T_CONSTANT_ENCAPSED_STRING","'is_bind'",97],",",["T_WHITESPACE"," ",97],["T_VARIABLE","$query",97],")",")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n                    ",97],["T_UNSET","unset",98],"(",["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","requestData",98],"[",["T_CONSTANT_ENCAPSED_STRING","'queries'",98],"]","[",["T_VARIABLE","$queryName",98],"]",")",";",["T_WHITESPACE","\n                ",98],"}",["T_WHITESPACE","\n                ",99],["T_BREAK","break",100],";",["T_WHITESPACE","\n            ",100],["T_CASE","case",101],["T_WHITESPACE"," ",101],["T_STRING","QueryInterface",101],["T_DOUBLE_COLON","::",101],["T_STRING","TYPE_FILTER",101],":",["T_WHITESPACE","\n                ",101],["T_IF","if",102],["T_WHITESPACE"," ",102],"(",["T_ISSET","isset",102],"(",["T_VARIABLE","$query",102],"[",["T_CONSTANT_ENCAPSED_STRING","'queryReference'",102],"]","[",["T_LNUMBER","0",102],"]",")",")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n                    ",102],["T_VARIABLE","$fQueryName",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$query",103],"[",["T_CONSTANT_ENCAPSED_STRING","'queryReference'",103],"]","[",["T_LNUMBER","0",103],"]","[",["T_CONSTANT_ENCAPSED_STRING","'ref'",103],"]",";",["T_WHITESPACE","\n                    ",103],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","cleanQuery",104],"(",["T_VARIABLE","$fQueryName",104],")",";",["T_WHITESPACE","\n                    ",104],["T_IF","if",105],["T_WHITESPACE"," ",105],"(","!",["T_ISSET","isset",105],"(",["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","requestData",105],"[",["T_CONSTANT_ENCAPSED_STRING","'queries'",105],"]","[",["T_VARIABLE","$fQueryName",105],"]",")",")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n                        ",105],["T_UNSET","unset",106],"(",["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","requestData",106],"[",["T_CONSTANT_ENCAPSED_STRING","'queries'",106],"]","[",["T_VARIABLE","$queryName",106],"]",")",";",["T_WHITESPACE","\n                    ",106],"}",["T_WHITESPACE","\n                ",107],"}",["T_WHITESPACE"," ",108],["T_ELSEIF","elseif",108],["T_WHITESPACE"," ",108],"(",["T_ISSET","isset",108],"(",["T_VARIABLE","$query",108],"[",["T_CONSTANT_ENCAPSED_STRING","'filterReference'",108],"]","[",["T_LNUMBER","0",108],"]",")",")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n                    ",108],["T_VARIABLE","$filterName",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$query",109],"[",["T_CONSTANT_ENCAPSED_STRING","'filterReference'",109],"]","[",["T_LNUMBER","0",109],"]","[",["T_CONSTANT_ENCAPSED_STRING","'ref'",109],"]",";",["T_WHITESPACE","\n                    ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","cleanFilter",110],"(",["T_VARIABLE","$filterName",110],")",";",["T_WHITESPACE","\n                    ",110],["T_IF","if",111],["T_WHITESPACE"," ",111],"(","!",["T_ISSET","isset",111],"(",["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","requestData",111],"[",["T_CONSTANT_ENCAPSED_STRING","'filters'",111],"]","[",["T_VARIABLE","$filterName",111],"]",")",")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n                        ",111],["T_UNSET","unset",112],"(",["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","requestData",112],"[",["T_CONSTANT_ENCAPSED_STRING","'queries'",112],"]","[",["T_VARIABLE","$queryName",112],"]",")",";",["T_WHITESPACE","\n                    ",112],"}",["T_WHITESPACE","\n                ",113],"}",["T_WHITESPACE"," ",114],["T_ELSE","else",114],["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n                    ",114],["T_THROW","throw",115],["T_WHITESPACE"," ",115],["T_NEW","new",115],["T_WHITESPACE"," ",115],["T_NS_SEPARATOR","\\",115],["T_STRING","Exception",115],"(",["T_CONSTANT_ENCAPSED_STRING","'Reference is not provided'",115],")",";",["T_WHITESPACE","\n                ",115],"}",["T_WHITESPACE","\n                ",116],["T_BREAK","break",117],";",["T_WHITESPACE","\n            ",117],["T_DEFAULT","default",118],":",["T_WHITESPACE","\n                ",118],["T_THROW","throw",119],["T_WHITESPACE"," ",119],["T_NEW","new",119],["T_WHITESPACE"," ",119],["T_NS_SEPARATOR","\\",119],["T_STRING","InvalidArgumentException",119],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid query type'",119],")",";",["T_WHITESPACE","\n        ",119],"}",["T_WHITESPACE","\n    ",120],"}",["T_WHITESPACE","\n\n    ",121],["T_DOC_COMMENT","\/**\n     * Clean aggregations if we don't need to process them\n     *\n     * @return void\n     *\/",123],["T_WHITESPACE","\n    ",127],["T_PRIVATE","private",128],["T_WHITESPACE"," ",128],["T_FUNCTION","function",128],["T_WHITESPACE"," ",128],["T_STRING","cleanAggregations",128],"(",")",["T_WHITESPACE","\n    ",128],"{",["T_WHITESPACE","\n        ",129],["T_IF","if",130],["T_WHITESPACE"," ",130],"(","!",["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","aggregationStatus",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","isEnabled",130],"(",")",")",["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n            ",130],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","requestData",131],"[",["T_CONSTANT_ENCAPSED_STRING","'aggregations'",131],"]",["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],"[","]",";",["T_WHITESPACE","\n        ",131],"}",["T_WHITESPACE"," ",132],["T_ELSE","else",132],["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n            ",132],["T_IF","if",133],["T_WHITESPACE"," ",133],"(",["T_STRING","array_key_exists",133],"(",["T_CONSTANT_ENCAPSED_STRING","'aggregations'",133],",",["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","requestData",133],")",["T_WHITESPACE"," ",133],["T_BOOLEAN_AND","&&",133],["T_WHITESPACE"," ",133],["T_STRING","is_array",133],"(",["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","requestData",133],"[",["T_CONSTANT_ENCAPSED_STRING","'aggregations'",133],"]",")",")",["T_WHITESPACE"," ",133],"{",["T_WHITESPACE","\n                ",133],["T_FOREACH","foreach",134],["T_WHITESPACE"," ",134],"(",["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","requestData",134],"[",["T_CONSTANT_ENCAPSED_STRING","'aggregations'",134],"]",["T_WHITESPACE"," ",134],["T_AS","as",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$aggregationName",134],["T_WHITESPACE"," ",134],["T_DOUBLE_ARROW","=>",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$aggregationValue",134],")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n                    ",134],["T_SWITCH","switch",135],["T_WHITESPACE"," ",135],"(",["T_VARIABLE","$aggregationValue",135],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",135],"]",")",["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n                        ",135],["T_CASE","case",136],["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","'dynamicBucket'",136],":",["T_WHITESPACE","\n                            ",136],["T_IF","if",137],["T_WHITESPACE"," ",137],"(",["T_STRING","is_string",137],"(",["T_VARIABLE","$aggregationValue",137],"[",["T_CONSTANT_ENCAPSED_STRING","'method'",137],"]",")",["T_WHITESPACE","\n                                ",137],["T_BOOLEAN_AND","&&",138],["T_WHITESPACE"," ",138],["T_STRING","preg_match",138],"(",["T_CONSTANT_ENCAPSED_STRING","'\/^\\$(.+)\\$$\/si'",138],",",["T_WHITESPACE"," ",138],["T_VARIABLE","$aggregationValue",138],"[",["T_CONSTANT_ENCAPSED_STRING","'method'",138],"]",")",["T_WHITESPACE","\n                            ",138],")",["T_WHITESPACE"," ",139],"{",["T_WHITESPACE","\n                                ",139],["T_UNSET","unset",140],"(",["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","requestData",140],"[",["T_CONSTANT_ENCAPSED_STRING","'aggregations'",140],"]","[",["T_VARIABLE","$aggregationName",140],"]",")",";",["T_WHITESPACE","\n                            ",140],"}",["T_WHITESPACE","\n                    ",141],"}",["T_WHITESPACE","\n                ",142],"}",["T_WHITESPACE","\n            ",143],"}",["T_WHITESPACE","\n        ",144],"}",["T_WHITESPACE","\n    ",145],"}",["T_WHITESPACE","\n\n    ",146],["T_DOC_COMMENT","\/**\n     * Clear don't bind filters\n     *\n     * @param string $filterName\n     * @return void\n     * @throws StateException\n     * @throws \\Exception\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     *\/",148],["T_WHITESPACE","\n    ",156],["T_PRIVATE","private",157],["T_WHITESPACE"," ",157],["T_FUNCTION","function",157],["T_WHITESPACE"," ",157],["T_STRING","cleanFilter",157],"(",["T_VARIABLE","$filterName",157],")",["T_WHITESPACE","\n    ",157],"{",["T_WHITESPACE","\n        ",158],["T_IF","if",159],["T_WHITESPACE"," ",159],"(","!",["T_ISSET","isset",159],"(",["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","requestData",159],"[",["T_CONSTANT_ENCAPSED_STRING","'filters'",159],"]","[",["T_VARIABLE","$filterName",159],"]",")",")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n            ",159],["T_THROW","throw",160],["T_WHITESPACE"," ",160],["T_NEW","new",160],["T_WHITESPACE"," ",160],["T_NS_SEPARATOR","\\",160],["T_STRING","Exception",160],"(",["T_CONSTANT_ENCAPSED_STRING","'Filter '",160],["T_WHITESPACE"," ",160],".",["T_WHITESPACE"," ",160],["T_VARIABLE","$filterName",160],["T_WHITESPACE"," ",160],".",["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","' does not exist'",160],")",";",["T_WHITESPACE","\n        ",160],"}",["T_WHITESPACE"," ",161],["T_ELSEIF","elseif",161],["T_WHITESPACE"," ",161],"(",["T_STRING","in_array",161],"(",["T_VARIABLE","$filterName",161],",",["T_WHITESPACE"," ",161],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","mappedFilters",161],")",")",["T_WHITESPACE"," ",161],"{",["T_WHITESPACE","\n            ",161],["T_THROW","throw",162],["T_WHITESPACE"," ",162],["T_NEW","new",162],["T_WHITESPACE"," ",162],["T_STRING","StateException",162],"(",["T_WHITESPACE","\n                ",162],["T_NEW","new",163],["T_WHITESPACE"," ",163],["T_STRING","Phrase",163],"(",["T_CONSTANT_ENCAPSED_STRING","'Cycle found. Filter %1 already used in request hierarchy'",163],",",["T_WHITESPACE"," ",163],"[",["T_VARIABLE","$filterName",163],"]",")",["T_WHITESPACE","\n            ",163],")",";",["T_WHITESPACE","\n        ",164],"}",["T_WHITESPACE","\n        ",165],["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","mappedFilters",166],"[","]",["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_VARIABLE","$filterName",166],";",["T_WHITESPACE","\n        ",166],["T_VARIABLE","$filter",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","requestData",167],"[",["T_CONSTANT_ENCAPSED_STRING","'filters'",167],"]","[",["T_VARIABLE","$filterName",167],"]",";",["T_WHITESPACE","\n        ",167],["T_SWITCH","switch",168],["T_WHITESPACE"," ",168],"(",["T_VARIABLE","$filter",168],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",168],"]",")",["T_WHITESPACE"," ",168],"{",["T_WHITESPACE","\n            ",168],["T_CASE","case",169],["T_WHITESPACE"," ",169],["T_STRING","FilterInterface",169],["T_DOUBLE_COLON","::",169],["T_STRING","TYPE_WILDCARD",169],":",["T_WHITESPACE","\n            ",169],["T_CASE","case",170],["T_WHITESPACE"," ",170],["T_STRING","FilterInterface",170],["T_DOUBLE_COLON","::",170],["T_STRING","TYPE_TERM",170],":",["T_WHITESPACE","\n                ",170],["T_IF","if",171],["T_WHITESPACE"," ",171],"(","!",["T_STRING","array_key_exists",171],"(",["T_CONSTANT_ENCAPSED_STRING","'is_bind'",171],",",["T_WHITESPACE"," ",171],["T_VARIABLE","$filter",171],")",")",["T_WHITESPACE"," ",171],"{",["T_WHITESPACE","\n                    ",171],["T_UNSET","unset",172],"(",["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","requestData",172],"[",["T_CONSTANT_ENCAPSED_STRING","'filters'",172],"]","[",["T_VARIABLE","$filterName",172],"]",")",";",["T_WHITESPACE","\n                ",172],"}",["T_WHITESPACE","\n                ",173],["T_BREAK","break",174],";",["T_WHITESPACE","\n            ",174],["T_CASE","case",175],["T_WHITESPACE"," ",175],["T_STRING","FilterInterface",175],["T_DOUBLE_COLON","::",175],["T_STRING","TYPE_RANGE",175],":",["T_WHITESPACE","\n                ",175],["T_VARIABLE","$keys",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],"[",["T_CONSTANT_ENCAPSED_STRING","'from'",176],",",["T_WHITESPACE"," ",176],["T_CONSTANT_ENCAPSED_STRING","'to'",176],"]",";",["T_WHITESPACE","\n                ",176],["T_FOREACH","foreach",177],["T_WHITESPACE"," ",177],"(",["T_VARIABLE","$keys",177],["T_WHITESPACE"," ",177],["T_AS","as",177],["T_WHITESPACE"," ",177],["T_VARIABLE","$key",177],")",["T_WHITESPACE"," ",177],"{",["T_WHITESPACE","\n                    ",177],["T_IF","if",178],["T_WHITESPACE"," ",178],"(",["T_ISSET","isset",178],"(",["T_VARIABLE","$filter",178],"[",["T_VARIABLE","$key",178],"]",")",["T_WHITESPACE"," ",178],["T_BOOLEAN_AND","&&",178],["T_WHITESPACE"," ",178],["T_STRING","preg_match",178],"(",["T_CONSTANT_ENCAPSED_STRING","'\/^\\$(.+)\\$$\/si'",178],",",["T_WHITESPACE"," ",178],["T_VARIABLE","$filter",178],"[",["T_VARIABLE","$key",178],"]",")",")",["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n                        ",178],["T_UNSET","unset",179],"(",["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","requestData",179],"[",["T_CONSTANT_ENCAPSED_STRING","'filters'",179],"]","[",["T_VARIABLE","$filterName",179],"]","[",["T_VARIABLE","$key",179],"]",")",";",["T_WHITESPACE","\n                    ",179],"}",["T_WHITESPACE","\n                ",180],"}",["T_WHITESPACE","\n                ",181],["T_VARIABLE","$filterKeys",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_STRING","array_keys",182],"(",["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","requestData",182],"[",["T_CONSTANT_ENCAPSED_STRING","'filters'",182],"]","[",["T_VARIABLE","$filterName",182],"]",")",";",["T_WHITESPACE","\n                ",182],["T_IF","if",183],["T_WHITESPACE"," ",183],"(",["T_STRING","count",183],"(",["T_STRING","array_diff",183],"(",["T_VARIABLE","$keys",183],",",["T_WHITESPACE"," ",183],["T_VARIABLE","$filterKeys",183],")",")",["T_WHITESPACE"," ",183],["T_IS_EQUAL","==",183],["T_WHITESPACE"," ",183],["T_STRING","count",183],"(",["T_VARIABLE","$keys",183],")",")",["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n                    ",183],["T_UNSET","unset",184],"(",["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","requestData",184],"[",["T_CONSTANT_ENCAPSED_STRING","'filters'",184],"]","[",["T_VARIABLE","$filterName",184],"]",")",";",["T_WHITESPACE","\n                ",184],"}",["T_WHITESPACE","\n                ",185],["T_BREAK","break",186],";",["T_WHITESPACE","\n            ",186],["T_CASE","case",187],["T_WHITESPACE"," ",187],["T_STRING","FilterInterface",187],["T_DOUBLE_COLON","::",187],["T_STRING","TYPE_BOOL",187],":",["T_WHITESPACE","\n                ",187],["T_VARIABLE","$filterReference",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","processFilterReference",188],"(",["T_VARIABLE","$filter",188],"[",["T_CONSTANT_ENCAPSED_STRING","'filterReference'",188],"]",")",";",["T_WHITESPACE","\n                ",188],["T_IF","if",189],["T_WHITESPACE"," ",189],"(",["T_EMPTY","empty",189],"(",["T_VARIABLE","$filterReference",189],")",")",["T_WHITESPACE"," ",189],"{",["T_WHITESPACE","\n                    ",189],["T_UNSET","unset",190],"(",["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","requestData",190],"[",["T_CONSTANT_ENCAPSED_STRING","'filters'",190],"]","[",["T_VARIABLE","$filterName",190],"]",")",";",["T_WHITESPACE","\n                ",190],"}",["T_WHITESPACE"," ",191],["T_ELSE","else",191],["T_WHITESPACE"," ",191],"{",["T_WHITESPACE","\n                    ",191],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","requestData",192],"[",["T_CONSTANT_ENCAPSED_STRING","'filters'",192],"]","[",["T_VARIABLE","$filterName",192],"]","[",["T_CONSTANT_ENCAPSED_STRING","'filterReference'",192],"]",["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_STRING","array_values",192],"(",["T_VARIABLE","$filterReference",192],")",";",["T_WHITESPACE","\n                ",192],"}",["T_WHITESPACE","\n                ",193],["T_BREAK","break",194],";",["T_WHITESPACE","\n            ",194],["T_DEFAULT","default",195],":",["T_WHITESPACE","\n                ",195],["T_THROW","throw",196],["T_WHITESPACE"," ",196],["T_NEW","new",196],["T_WHITESPACE"," ",196],["T_NS_SEPARATOR","\\",196],["T_STRING","InvalidArgumentException",196],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid filter type'",196],")",";",["T_WHITESPACE","\n        ",196],"}",["T_WHITESPACE","\n    ",197],"}",["T_WHITESPACE","\n\n    ",198],["T_DOC_COMMENT","\/**\n     * Aggregate Queries by clause\n     *\n     * @param array $queryReference\n     * @return array\n     *\/",200],["T_WHITESPACE","\n    ",205],["T_PRIVATE","private",206],["T_WHITESPACE"," ",206],["T_FUNCTION","function",206],["T_WHITESPACE"," ",206],["T_STRING","processQueryReference",206],"(",["T_VARIABLE","$queryReference",206],")",["T_WHITESPACE","\n    ",206],"{",["T_WHITESPACE","\n        ",207],["T_FOREACH","foreach",208],["T_WHITESPACE"," ",208],"(",["T_VARIABLE","$queryReference",208],["T_WHITESPACE"," ",208],["T_AS","as",208],["T_WHITESPACE"," ",208],["T_VARIABLE","$key",208],["T_WHITESPACE"," ",208],["T_DOUBLE_ARROW","=>",208],["T_WHITESPACE"," ",208],["T_VARIABLE","$value",208],")",["T_WHITESPACE"," ",208],"{",["T_WHITESPACE","\n            ",208],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","cleanQuery",209],"(",["T_VARIABLE","$value",209],"[",["T_CONSTANT_ENCAPSED_STRING","'ref'",209],"]",")",";",["T_WHITESPACE","\n            ",209],["T_IF","if",210],["T_WHITESPACE"," ",210],"(","!",["T_ISSET","isset",210],"(",["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","requestData",210],"[",["T_CONSTANT_ENCAPSED_STRING","'queries'",210],"]","[",["T_VARIABLE","$value",210],"[",["T_CONSTANT_ENCAPSED_STRING","'ref'",210],"]","]",")",")",["T_WHITESPACE"," ",210],"{",["T_WHITESPACE","\n                ",210],["T_UNSET","unset",211],"(",["T_VARIABLE","$queryReference",211],"[",["T_VARIABLE","$key",211],"]",")",";",["T_WHITESPACE","\n            ",211],"}",["T_WHITESPACE","\n        ",212],"}",["T_WHITESPACE","\n        ",213],["T_RETURN","return",214],["T_WHITESPACE"," ",214],["T_VARIABLE","$queryReference",214],";",["T_WHITESPACE","\n    ",214],"}",["T_WHITESPACE","\n\n    ",215],["T_DOC_COMMENT","\/**\n     * Aggregate Filters by clause\n     *\n     * @param array $filterReference\n     * @return array\n     *\/",217],["T_WHITESPACE","\n    ",222],["T_PRIVATE","private",223],["T_WHITESPACE"," ",223],["T_FUNCTION","function",223],["T_WHITESPACE"," ",223],["T_STRING","processFilterReference",223],"(",["T_VARIABLE","$filterReference",223],")",["T_WHITESPACE","\n    ",223],"{",["T_WHITESPACE","\n        ",224],["T_FOREACH","foreach",225],["T_WHITESPACE"," ",225],"(",["T_VARIABLE","$filterReference",225],["T_WHITESPACE"," ",225],["T_AS","as",225],["T_WHITESPACE"," ",225],["T_VARIABLE","$key",225],["T_WHITESPACE"," ",225],["T_DOUBLE_ARROW","=>",225],["T_WHITESPACE"," ",225],["T_VARIABLE","$value",225],")",["T_WHITESPACE"," ",225],"{",["T_WHITESPACE","\n            ",225],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","cleanFilter",226],"(",["T_VARIABLE","$value",226],"[",["T_CONSTANT_ENCAPSED_STRING","'ref'",226],"]",")",";",["T_WHITESPACE","\n            ",226],["T_IF","if",227],["T_WHITESPACE"," ",227],"(","!",["T_ISSET","isset",227],"(",["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","requestData",227],"[",["T_CONSTANT_ENCAPSED_STRING","'filters'",227],"]","[",["T_VARIABLE","$value",227],"[",["T_CONSTANT_ENCAPSED_STRING","'ref'",227],"]","]",")",")",["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n                ",227],["T_UNSET","unset",228],"(",["T_VARIABLE","$filterReference",228],"[",["T_VARIABLE","$key",228],"]",")",";",["T_WHITESPACE","\n            ",228],"}",["T_WHITESPACE","\n        ",229],"}",["T_WHITESPACE","\n        ",230],["T_RETURN","return",231],["T_WHITESPACE"," ",231],["T_VARIABLE","$filterReference",231],";",["T_WHITESPACE","\n    ",231],"}",["T_WHITESPACE","\n\n    ",232],["T_DOC_COMMENT","\/**\n     * Clear variables to default status\n     *\n     * @return void\n     *\/",234],["T_WHITESPACE","\n    ",238],["T_PRIVATE","private",239],["T_WHITESPACE"," ",239],["T_FUNCTION","function",239],["T_WHITESPACE"," ",239],["T_STRING","clear",239],"(",")",["T_WHITESPACE","\n    ",239],"{",["T_WHITESPACE","\n        ",240],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","mappedQueries",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],"[","]",";",["T_WHITESPACE","\n        ",241],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","mappedFilters",242],["T_WHITESPACE"," ",242],"=",["T_WHITESPACE"," ",242],"[","]",";",["T_WHITESPACE","\n        ",242],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","requestData",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],"[","]",";",["T_WHITESPACE","\n    ",243],"}",["T_WHITESPACE","\n",244],"}",["T_WHITESPACE","\n",245]]