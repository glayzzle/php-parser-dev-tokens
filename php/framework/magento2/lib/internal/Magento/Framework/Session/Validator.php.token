[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Framework",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Session",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Exception",8],["T_NS_SEPARATOR","\\",8],["T_STRING","SessionException",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Phrase",9],";",["T_WHITESPACE","\n\n",9],["T_DOC_COMMENT","\/**\n * Session Validator\n *\/",11],["T_WHITESPACE","\n",13],["T_CLASS","class",14],["T_WHITESPACE"," ",14],["T_STRING","Validator",14],["T_WHITESPACE"," ",14],["T_IMPLEMENTS","implements",14],["T_WHITESPACE"," ",14],["T_STRING","ValidatorInterface",14],["T_WHITESPACE","\n",14],"{",["T_WHITESPACE","\n    ",15],["T_CONST","const",16],["T_WHITESPACE"," ",16],["T_STRING","VALIDATOR_KEY",16],["T_WHITESPACE"," ",16],"=",["T_WHITESPACE"," ",16],["T_CONSTANT_ENCAPSED_STRING","'_session_validator_data'",16],";",["T_WHITESPACE","\n\n    ",16],["T_CONST","const",18],["T_WHITESPACE"," ",18],["T_STRING","VALIDATOR_HTTP_USER_AGENT_KEY",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],["T_CONSTANT_ENCAPSED_STRING","'http_user_agent'",18],";",["T_WHITESPACE","\n\n    ",18],["T_CONST","const",20],["T_WHITESPACE"," ",20],["T_STRING","VALIDATOR_HTTP_X_FORWARDED_FOR_KEY",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_CONSTANT_ENCAPSED_STRING","'http_x_forwarded_for'",20],";",["T_WHITESPACE","\n\n    ",20],["T_CONST","const",22],["T_WHITESPACE"," ",22],["T_STRING","VALIDATOR_HTTP_VIA_KEY",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'http_via'",22],";",["T_WHITESPACE","\n\n    ",22],["T_CONST","const",24],["T_WHITESPACE"," ",24],["T_STRING","VALIDATOR_REMOTE_ADDR_KEY",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","'remote_addr'",24],";",["T_WHITESPACE","\n\n    ",24],["T_CONST","const",26],["T_WHITESPACE"," ",26],["T_STRING","XML_PATH_USE_REMOTE_ADDR",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","'web\/session\/use_remote_addr'",26],";",["T_WHITESPACE","\n\n    ",26],["T_CONST","const",28],["T_WHITESPACE"," ",28],["T_STRING","XML_PATH_USE_HTTP_VIA",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_CONSTANT_ENCAPSED_STRING","'web\/session\/use_http_via'",28],";",["T_WHITESPACE","\n\n    ",28],["T_CONST","const",30],["T_WHITESPACE"," ",30],["T_STRING","XML_PATH_USE_X_FORWARDED",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_CONSTANT_ENCAPSED_STRING","'web\/session\/use_http_x_forwarded_for'",30],";",["T_WHITESPACE","\n\n    ",30],["T_CONST","const",32],["T_WHITESPACE"," ",32],["T_STRING","XML_PATH_USE_USER_AGENT",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","'web\/session\/use_http_user_agent'",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\App\\Config\\ScopeConfigInterface\n     *\/",34],["T_WHITESPACE","\n    ",36],["T_PROTECTED","protected",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$_scopeConfig",37],";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\HTTP\\PhpEnvironment\\RemoteAddress\n     *\/",39],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_remoteAddress",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * @var array\n     *\/",44],["T_WHITESPACE","\n    ",46],["T_PROTECTED","protected",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$_skippedAgentList",47],";",["T_WHITESPACE","\n\n    ",47],["T_DOC_COMMENT","\/**\n     * @var string\n     *\/",49],["T_WHITESPACE","\n    ",51],["T_PROTECTED","protected",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$_scopeType",52],";",["T_WHITESPACE","\n\n    ",52],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\App\\Config\\ScopeConfigInterface $scopeConfig\n     * @param \\Magento\\Framework\\HTTP\\PhpEnvironment\\RemoteAddress $remoteAddress\n     * @param string $scopeType\n     * @param array $skippedUserAgentList\n     *\/",54],["T_WHITESPACE","\n    ",59],["T_PUBLIC","public",60],["T_WHITESPACE"," ",60],["T_FUNCTION","function",60],["T_WHITESPACE"," ",60],["T_STRING","__construct",60],"(",["T_WHITESPACE","\n        ",60],["T_NS_SEPARATOR","\\",61],["T_STRING","Magento",61],["T_NS_SEPARATOR","\\",61],["T_STRING","Framework",61],["T_NS_SEPARATOR","\\",61],["T_STRING","App",61],["T_NS_SEPARATOR","\\",61],["T_STRING","Config",61],["T_NS_SEPARATOR","\\",61],["T_STRING","ScopeConfigInterface",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$scopeConfig",61],",",["T_WHITESPACE","\n        ",61],["T_NS_SEPARATOR","\\",62],["T_STRING","Magento",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Framework",62],["T_NS_SEPARATOR","\\",62],["T_STRING","HTTP",62],["T_NS_SEPARATOR","\\",62],["T_STRING","PhpEnvironment",62],["T_NS_SEPARATOR","\\",62],["T_STRING","RemoteAddress",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$remoteAddress",62],",",["T_WHITESPACE","\n        ",62],["T_VARIABLE","$scopeType",63],",",["T_WHITESPACE","\n        ",63],["T_ARRAY","array",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$skippedUserAgentList",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],"[","]",["T_WHITESPACE","\n    ",64],")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","_scopeConfig",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$scopeConfig",66],";",["T_WHITESPACE","\n        ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","_remoteAddress",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$remoteAddress",67],";",["T_WHITESPACE","\n        ",67],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","_skippedAgentList",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$skippedUserAgentList",68],";",["T_WHITESPACE","\n        ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","_scopeType",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_VARIABLE","$scopeType",69],";",["T_WHITESPACE","\n    ",69],"}",["T_WHITESPACE","\n\n    ",70],["T_DOC_COMMENT","\/**\n     * Validate session\n     *\n     * @param SessionManagerInterface $session\n     * @return void\n     * @throws SessionException\n     *\/",72],["T_WHITESPACE","\n    ",78],["T_PUBLIC","public",79],["T_WHITESPACE"," ",79],["T_FUNCTION","function",79],["T_WHITESPACE"," ",79],["T_STRING","validate",79],"(",["T_STRING","SessionManagerInterface",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$session",79],")",["T_WHITESPACE","\n    ",79],"{",["T_WHITESPACE","\n        ",80],["T_IF","if",81],["T_WHITESPACE"," ",81],"(","!",["T_ISSET","isset",81],"(",["T_VARIABLE","$_SESSION",81],"[",["T_STRING","self",81],["T_DOUBLE_COLON","::",81],["T_STRING","VALIDATOR_KEY",81],"]",")",")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n            ",81],["T_VARIABLE","$_SESSION",82],"[",["T_STRING","self",82],["T_DOUBLE_COLON","::",82],["T_STRING","VALIDATOR_KEY",82],"]",["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","_getSessionEnvironment",82],"(",")",";",["T_WHITESPACE","\n        ",82],"}",["T_WHITESPACE"," ",83],["T_ELSE","else",83],["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n            ",83],["T_TRY","try",84],["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n                ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","_validate",85],"(",")",";",["T_WHITESPACE","\n            ",85],"}",["T_WHITESPACE"," ",86],["T_CATCH","catch",86],["T_WHITESPACE"," ",86],"(",["T_STRING","SessionException",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$e",86],")",["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n                ",86],["T_VARIABLE","$session",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","destroy",87],"(","[",["T_CONSTANT_ENCAPSED_STRING","'clear_storage'",87],["T_WHITESPACE"," ",87],["T_DOUBLE_ARROW","=>",87],["T_WHITESPACE"," ",87],["T_STRING","false",87],"]",")",";",["T_WHITESPACE","\n                ",87],["T_COMMENT","\/\/ throw core session exception\n",88],["T_WHITESPACE","                ",89],["T_THROW","throw",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$e",89],";",["T_WHITESPACE","\n            ",89],"}",["T_WHITESPACE","\n        ",90],"}",["T_WHITESPACE","\n    ",91],"}",["T_WHITESPACE","\n\n    ",92],["T_DOC_COMMENT","\/**\n     * Validate data\n     *\n     * @return bool\n     * @throws SessionException\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     *\/",94],["T_WHITESPACE","\n    ",100],["T_PROTECTED","protected",101],["T_WHITESPACE"," ",101],["T_FUNCTION","function",101],["T_WHITESPACE"," ",101],["T_STRING","_validate",101],"(",")",["T_WHITESPACE","\n    ",101],"{",["T_WHITESPACE","\n        ",102],["T_VARIABLE","$sessionData",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$_SESSION",103],"[",["T_STRING","self",103],["T_DOUBLE_COLON","::",103],["T_STRING","VALIDATOR_KEY",103],"]",";",["T_WHITESPACE","\n        ",103],["T_VARIABLE","$validatorData",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","_getSessionEnvironment",104],"(",")",";",["T_WHITESPACE","\n\n        ",104],["T_IF","if",106],["T_WHITESPACE"," ",106],"(",["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","_scopeConfig",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","getValue",106],"(",["T_WHITESPACE","\n            ",106],["T_STRING","self",107],["T_DOUBLE_COLON","::",107],["T_STRING","XML_PATH_USE_REMOTE_ADDR",107],",",["T_WHITESPACE","\n            ",107],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","_scopeType",108],["T_WHITESPACE","\n        ",108],")",["T_WHITESPACE"," ",109],["T_BOOLEAN_AND","&&",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$sessionData",109],"[",["T_STRING","self",109],["T_DOUBLE_COLON","::",109],["T_STRING","VALIDATOR_REMOTE_ADDR_KEY",109],"]",["T_WHITESPACE"," ",109],["T_IS_NOT_EQUAL","!=",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$validatorData",109],"[",["T_STRING","self",109],["T_DOUBLE_COLON","::",109],["T_STRING","VALIDATOR_REMOTE_ADDR_KEY",109],"]",["T_WHITESPACE","\n        ",109],")",["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n            ",110],["T_THROW","throw",111],["T_WHITESPACE"," ",111],["T_NEW","new",111],["T_WHITESPACE"," ",111],["T_STRING","SessionException",111],"(",["T_WHITESPACE","\n                ",111],["T_NEW","new",112],["T_WHITESPACE"," ",112],["T_STRING","Phrase",112],"(",["T_WHITESPACE","\n                    ",112],["T_CONSTANT_ENCAPSED_STRING","'Invalid session %1 value.'",113],",",["T_WHITESPACE","\n                    ",113],"[",["T_STRING","self",114],["T_DOUBLE_COLON","::",114],["T_STRING","VALIDATOR_REMOTE_ADDR_KEY",114],"]",["T_WHITESPACE","\n                ",114],")",["T_WHITESPACE","\n            ",115],")",";",["T_WHITESPACE","\n        ",116],"}",["T_WHITESPACE","\n        ",117],["T_IF","if",118],["T_WHITESPACE"," ",118],"(",["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","_scopeConfig",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","getValue",118],"(",["T_WHITESPACE","\n            ",118],["T_STRING","self",119],["T_DOUBLE_COLON","::",119],["T_STRING","XML_PATH_USE_HTTP_VIA",119],",",["T_WHITESPACE","\n            ",119],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","_scopeType",120],["T_WHITESPACE","\n        ",120],")",["T_WHITESPACE"," ",121],["T_BOOLEAN_AND","&&",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$sessionData",121],"[",["T_STRING","self",121],["T_DOUBLE_COLON","::",121],["T_STRING","VALIDATOR_HTTP_VIA_KEY",121],"]",["T_WHITESPACE"," ",121],["T_IS_NOT_EQUAL","!=",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$validatorData",121],"[",["T_STRING","self",121],["T_DOUBLE_COLON","::",121],["T_STRING","VALIDATOR_HTTP_VIA_KEY",121],"]",["T_WHITESPACE","\n        ",121],")",["T_WHITESPACE"," ",122],"{",["T_WHITESPACE","\n            ",122],["T_THROW","throw",123],["T_WHITESPACE"," ",123],["T_NEW","new",123],["T_WHITESPACE"," ",123],["T_STRING","SessionException",123],"(",["T_WHITESPACE","\n                ",123],["T_NEW","new",124],["T_WHITESPACE"," ",124],["T_STRING","Phrase",124],"(",["T_WHITESPACE","\n                    ",124],["T_CONSTANT_ENCAPSED_STRING","'Invalid session %1 value.'",125],",",["T_WHITESPACE","\n                    ",125],"[",["T_STRING","self",126],["T_DOUBLE_COLON","::",126],["T_STRING","VALIDATOR_HTTP_VIA_KEY",126],"]",["T_WHITESPACE","\n                ",126],")",["T_WHITESPACE","\n            ",127],")",";",["T_WHITESPACE","\n        ",128],"}",["T_WHITESPACE","\n\n        ",129],["T_VARIABLE","$httpXForwardedKey",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_VARIABLE","$sessionData",131],"[",["T_STRING","self",131],["T_DOUBLE_COLON","::",131],["T_STRING","VALIDATOR_HTTP_X_FORWARDED_FOR_KEY",131],"]",";",["T_WHITESPACE","\n        ",131],["T_VARIABLE","$validatorXForwarded",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_VARIABLE","$validatorData",132],"[",["T_STRING","self",132],["T_DOUBLE_COLON","::",132],["T_STRING","VALIDATOR_HTTP_X_FORWARDED_FOR_KEY",132],"]",";",["T_WHITESPACE","\n        ",132],["T_IF","if",133],["T_WHITESPACE"," ",133],"(",["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_scopeConfig",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getValue",133],"(",["T_WHITESPACE","\n            ",133],["T_STRING","self",134],["T_DOUBLE_COLON","::",134],["T_STRING","XML_PATH_USE_X_FORWARDED",134],",",["T_WHITESPACE","\n            ",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","_scopeType",135],["T_WHITESPACE","\n        ",135],")",["T_WHITESPACE"," ",136],["T_BOOLEAN_AND","&&",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$httpXForwardedKey",136],["T_WHITESPACE"," ",136],["T_IS_NOT_EQUAL","!=",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$validatorXForwarded",136],["T_WHITESPACE","\n        ",136],")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n            ",137],["T_THROW","throw",138],["T_WHITESPACE"," ",138],["T_NEW","new",138],["T_WHITESPACE"," ",138],["T_STRING","SessionException",138],"(",["T_WHITESPACE","\n                ",138],["T_NEW","new",139],["T_WHITESPACE"," ",139],["T_STRING","Phrase",139],"(",["T_WHITESPACE","\n                    ",139],["T_CONSTANT_ENCAPSED_STRING","'Invalid session %1 value.'",140],",",["T_WHITESPACE","\n                    ",140],"[",["T_STRING","self",141],["T_DOUBLE_COLON","::",141],["T_STRING","VALIDATOR_HTTP_X_FORWARDED_FOR_KEY",141],"]",["T_WHITESPACE","\n                ",141],")",["T_WHITESPACE","\n            ",142],")",";",["T_WHITESPACE","\n        ",143],"}",["T_WHITESPACE","\n        ",144],["T_IF","if",145],["T_WHITESPACE"," ",145],"(",["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","_scopeConfig",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getValue",145],"(",["T_WHITESPACE","\n            ",145],["T_STRING","self",146],["T_DOUBLE_COLON","::",146],["T_STRING","XML_PATH_USE_USER_AGENT",146],",",["T_WHITESPACE","\n            ",146],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","_scopeType",147],["T_WHITESPACE","\n        ",147],")",["T_WHITESPACE"," ",148],["T_BOOLEAN_AND","&&",148],["T_WHITESPACE"," ",148],["T_VARIABLE","$sessionData",148],"[",["T_STRING","self",148],["T_DOUBLE_COLON","::",148],["T_STRING","VALIDATOR_HTTP_USER_AGENT_KEY",148],"]",["T_WHITESPACE"," ",148],["T_IS_NOT_EQUAL","!=",148],["T_WHITESPACE"," ",148],["T_VARIABLE","$validatorData",148],"[",["T_STRING","self",148],["T_DOUBLE_COLON","::",148],["T_STRING","VALIDATOR_HTTP_USER_AGENT_KEY",148],"]",["T_WHITESPACE","\n        ",148],")",["T_WHITESPACE"," ",149],"{",["T_WHITESPACE","\n            ",149],["T_FOREACH","foreach",150],["T_WHITESPACE"," ",150],"(",["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","_skippedAgentList",150],["T_WHITESPACE"," ",150],["T_AS","as",150],["T_WHITESPACE"," ",150],["T_VARIABLE","$agent",150],")",["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n                ",150],["T_IF","if",151],["T_WHITESPACE"," ",151],"(",["T_STRING","preg_match",151],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",151],["T_WHITESPACE"," ",151],".",["T_WHITESPACE"," ",151],["T_VARIABLE","$agent",151],["T_WHITESPACE"," ",151],".",["T_WHITESPACE"," ",151],["T_CONSTANT_ENCAPSED_STRING","'\/iu'",151],",",["T_WHITESPACE"," ",151],["T_VARIABLE","$validatorData",151],"[",["T_STRING","self",151],["T_DOUBLE_COLON","::",151],["T_STRING","VALIDATOR_HTTP_USER_AGENT_KEY",151],"]",")",")",["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n                    ",151],["T_RETURN","return",152],["T_WHITESPACE"," ",152],["T_STRING","true",152],";",["T_WHITESPACE","\n                ",152],"}",["T_WHITESPACE","\n            ",153],"}",["T_WHITESPACE","\n            ",154],["T_THROW","throw",155],["T_WHITESPACE"," ",155],["T_NEW","new",155],["T_WHITESPACE"," ",155],["T_STRING","SessionException",155],"(",["T_WHITESPACE","\n                ",155],["T_NEW","new",156],["T_WHITESPACE"," ",156],["T_STRING","Phrase",156],"(",["T_WHITESPACE","\n                    ",156],["T_CONSTANT_ENCAPSED_STRING","'Invalid session %1 value.'",157],",",["T_WHITESPACE","\n                    ",157],"[",["T_STRING","self",158],["T_DOUBLE_COLON","::",158],["T_STRING","VALIDATOR_HTTP_USER_AGENT_KEY",158],"]",["T_WHITESPACE","\n                ",158],")",["T_WHITESPACE","\n            ",159],")",";",["T_WHITESPACE","\n        ",160],"}",["T_WHITESPACE","\n\n        ",161],["T_RETURN","return",163],["T_WHITESPACE"," ",163],["T_STRING","true",163],";",["T_WHITESPACE","\n    ",163],"}",["T_WHITESPACE","\n\n    ",164],["T_DOC_COMMENT","\/**\n     * Prepare session environment data for validation\n     *\n     * @return array\n     *\/",166],["T_WHITESPACE","\n    ",170],["T_PROTECTED","protected",171],["T_WHITESPACE"," ",171],["T_FUNCTION","function",171],["T_WHITESPACE"," ",171],["T_STRING","_getSessionEnvironment",171],"(",")",["T_WHITESPACE","\n    ",171],"{",["T_WHITESPACE","\n        ",172],["T_VARIABLE","$parts",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],"[",["T_WHITESPACE","\n            ",173],["T_STRING","self",174],["T_DOUBLE_COLON","::",174],["T_STRING","VALIDATOR_REMOTE_ADDR_KEY",174],["T_WHITESPACE"," ",174],["T_DOUBLE_ARROW","=>",174],["T_WHITESPACE"," ",174],["T_CONSTANT_ENCAPSED_STRING","''",174],",",["T_WHITESPACE","\n            ",174],["T_STRING","self",175],["T_DOUBLE_COLON","::",175],["T_STRING","VALIDATOR_HTTP_VIA_KEY",175],["T_WHITESPACE"," ",175],["T_DOUBLE_ARROW","=>",175],["T_WHITESPACE"," ",175],["T_CONSTANT_ENCAPSED_STRING","''",175],",",["T_WHITESPACE","\n            ",175],["T_STRING","self",176],["T_DOUBLE_COLON","::",176],["T_STRING","VALIDATOR_HTTP_X_FORWARDED_FOR_KEY",176],["T_WHITESPACE"," ",176],["T_DOUBLE_ARROW","=>",176],["T_WHITESPACE"," ",176],["T_CONSTANT_ENCAPSED_STRING","''",176],",",["T_WHITESPACE","\n            ",176],["T_STRING","self",177],["T_DOUBLE_COLON","::",177],["T_STRING","VALIDATOR_HTTP_USER_AGENT_KEY",177],["T_WHITESPACE"," ",177],["T_DOUBLE_ARROW","=>",177],["T_WHITESPACE"," ",177],["T_CONSTANT_ENCAPSED_STRING","''",177],",",["T_WHITESPACE","\n        ",177],"]",";",["T_WHITESPACE","\n\n        ",178],["T_COMMENT","\/\/ collect ip data\n",180],["T_WHITESPACE","        ",181],["T_IF","if",181],["T_WHITESPACE"," ",181],"(",["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","_remoteAddress",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","getRemoteAddress",181],"(",")",")",["T_WHITESPACE"," ",181],"{",["T_WHITESPACE","\n            ",181],["T_VARIABLE","$parts",182],"[",["T_STRING","self",182],["T_DOUBLE_COLON","::",182],["T_STRING","VALIDATOR_REMOTE_ADDR_KEY",182],"]",["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","_remoteAddress",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","getRemoteAddress",182],"(",")",";",["T_WHITESPACE","\n        ",182],"}",["T_WHITESPACE","\n        ",183],["T_IF","if",184],["T_WHITESPACE"," ",184],"(",["T_ISSET","isset",184],"(",["T_VARIABLE","$_ENV",184],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_VIA'",184],"]",")",")",["T_WHITESPACE"," ",184],"{",["T_WHITESPACE","\n            ",184],["T_VARIABLE","$parts",185],"[",["T_STRING","self",185],["T_DOUBLE_COLON","::",185],["T_STRING","VALIDATOR_HTTP_VIA_KEY",185],"]",["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_STRING_CAST","(string)",185],["T_VARIABLE","$_ENV",185],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_VIA'",185],"]",";",["T_WHITESPACE","\n        ",185],"}",["T_WHITESPACE","\n        ",186],["T_IF","if",187],["T_WHITESPACE"," ",187],"(",["T_ISSET","isset",187],"(",["T_VARIABLE","$_ENV",187],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_X_FORWARDED_FOR'",187],"]",")",")",["T_WHITESPACE"," ",187],"{",["T_WHITESPACE","\n            ",187],["T_VARIABLE","$parts",188],"[",["T_STRING","self",188],["T_DOUBLE_COLON","::",188],["T_STRING","VALIDATOR_HTTP_X_FORWARDED_FOR_KEY",188],"]",["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_STRING_CAST","(string)",188],["T_VARIABLE","$_ENV",188],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_X_FORWARDED_FOR'",188],"]",";",["T_WHITESPACE","\n        ",188],"}",["T_WHITESPACE","\n\n        ",189],["T_COMMENT","\/\/ collect user agent data\n",191],["T_WHITESPACE","        ",192],["T_IF","if",192],["T_WHITESPACE"," ",192],"(",["T_ISSET","isset",192],"(",["T_VARIABLE","$_SERVER",192],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_USER_AGENT'",192],"]",")",")",["T_WHITESPACE"," ",192],"{",["T_WHITESPACE","\n            ",192],["T_VARIABLE","$parts",193],"[",["T_STRING","self",193],["T_DOUBLE_COLON","::",193],["T_STRING","VALIDATOR_HTTP_USER_AGENT_KEY",193],"]",["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_STRING_CAST","(string)",193],["T_VARIABLE","$_SERVER",193],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_USER_AGENT'",193],"]",";",["T_WHITESPACE","\n        ",193],"}",["T_WHITESPACE","\n\n        ",194],["T_RETURN","return",196],["T_WHITESPACE"," ",196],["T_VARIABLE","$parts",196],";",["T_WHITESPACE","\n    ",196],"}",["T_WHITESPACE","\n",197],"}",["T_WHITESPACE","\n",198]]