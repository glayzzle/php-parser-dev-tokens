[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Framework",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Oauth",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Encryption",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Helper",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Security",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Phrase",9],";",["T_WHITESPACE","\n\n",9],["T_CLASS","class",11],["T_WHITESPACE"," ",11],["T_STRING","Oauth",11],["T_WHITESPACE"," ",11],["T_IMPLEMENTS","implements",11],["T_WHITESPACE"," ",11],["T_STRING","OauthInterface",11],["T_WHITESPACE","\n",11],"{",["T_WHITESPACE","\n    ",12],["T_DOC_COMMENT","\/**\n     * @var  \\Magento\\Framework\\Oauth\\Helper\\Oauth\n     *\/",13],["T_WHITESPACE","\n    ",15],["T_PROTECTED","protected",16],["T_WHITESPACE"," ",16],["T_VARIABLE","$_oauthHelper",16],";",["T_WHITESPACE","\n\n    ",16],["T_DOC_COMMENT","\/**\n     * @var  \\Zend_Oauth_Http_Utility\n     *\/",18],["T_WHITESPACE","\n    ",20],["T_PROTECTED","protected",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$_httpUtility",21],";",["T_WHITESPACE","\n\n    ",21],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Oauth\\NonceGeneratorInterface\n     *\/",23],["T_WHITESPACE","\n    ",25],["T_PROTECTED","protected",26],["T_WHITESPACE"," ",26],["T_VARIABLE","$_nonceGenerator",26],";",["T_WHITESPACE","\n\n    ",26],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Oauth\\TokenProviderInterface\n     *\/",28],["T_WHITESPACE","\n    ",30],["T_PROTECTED","protected",31],["T_WHITESPACE"," ",31],["T_VARIABLE","$_tokenProvider",31],";",["T_WHITESPACE","\n\n    ",31],["T_DOC_COMMENT","\/**\n     * @param Helper\\Oauth $oauthHelper\n     * @param NonceGeneratorInterface $nonceGenerator\n     * @param TokenProviderInterface $tokenProvider\n     * @param \\Zend_Oauth_Http_Utility $httpUtility\n     *\/",33],["T_WHITESPACE","\n    ",38],["T_PUBLIC","public",39],["T_WHITESPACE"," ",39],["T_FUNCTION","function",39],["T_WHITESPACE"," ",39],["T_STRING","__construct",39],"(",["T_WHITESPACE","\n        ",39],["T_STRING","Helper",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Oauth",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$oauthHelper",40],",",["T_WHITESPACE","\n        ",40],["T_STRING","NonceGeneratorInterface",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$nonceGenerator",41],",",["T_WHITESPACE","\n        ",41],["T_STRING","TokenProviderInterface",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$tokenProvider",42],",",["T_WHITESPACE","\n        ",42],["T_NS_SEPARATOR","\\",43],["T_STRING","Zend_Oauth_Http_Utility",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$httpUtility",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_STRING","null",43],["T_WHITESPACE","\n    ",43],")",["T_WHITESPACE"," ",44],"{",["T_WHITESPACE","\n        ",44],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","_oauthHelper",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_VARIABLE","$oauthHelper",45],";",["T_WHITESPACE","\n        ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","_nonceGenerator",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$nonceGenerator",46],";",["T_WHITESPACE","\n        ",46],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","_tokenProvider",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$tokenProvider",47],";",["T_WHITESPACE","\n        ",47],["T_COMMENT","\/\/ null default to prevent ObjectManagerFactory from injecting, see MAGETWO-30809\n",48],["T_WHITESPACE","        ",49],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","_httpUtility",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$httpUtility",49],["T_WHITESPACE"," ",49],"?",":",["T_WHITESPACE"," ",49],["T_NEW","new",49],["T_WHITESPACE"," ",49],["T_NS_SEPARATOR","\\",49],["T_STRING","Zend_Oauth_Http_Utility",49],"(",")",";",["T_WHITESPACE","\n    ",49],"}",["T_WHITESPACE","\n\n    ",50],["T_DOC_COMMENT","\/**\n     * Retrieve array of supported signature methods.\n     *\n     * @return string[] - Supported HMAC-SHA1 and HMAC-SHA256 signature methods.\n     *\/",52],["T_WHITESPACE","\n    ",56],["T_PUBLIC","public",57],["T_WHITESPACE"," ",57],["T_STATIC","static",57],["T_WHITESPACE"," ",57],["T_FUNCTION","function",57],["T_WHITESPACE"," ",57],["T_STRING","getSupportedSignatureMethods",57],"(",")",["T_WHITESPACE","\n    ",57],"{",["T_WHITESPACE","\n        ",58],["T_RETURN","return",59],["T_WHITESPACE"," ",59],"[",["T_STRING","self",59],["T_DOUBLE_COLON","::",59],["T_STRING","SIGNATURE_SHA1",59],",",["T_WHITESPACE"," ",59],["T_STRING","self",59],["T_DOUBLE_COLON","::",59],["T_STRING","SIGNATURE_SHA256",59],"]",";",["T_WHITESPACE","\n    ",59],"}",["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",62],["T_WHITESPACE","\n    ",64],["T_PUBLIC","public",65],["T_WHITESPACE"," ",65],["T_FUNCTION","function",65],["T_WHITESPACE"," ",65],["T_STRING","getRequestToken",65],"(",["T_VARIABLE","$params",65],",",["T_WHITESPACE"," ",65],["T_VARIABLE","$requestUrl",65],",",["T_WHITESPACE"," ",65],["T_VARIABLE","$httpMethod",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'POST'",65],")",["T_WHITESPACE","\n    ",65],"{",["T_WHITESPACE","\n        ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","_validateProtocolParams",67],"(",["T_VARIABLE","$params",67],")",";",["T_WHITESPACE","\n        ",67],["T_VARIABLE","$consumer",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","_tokenProvider",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","getConsumerByKey",68],"(",["T_VARIABLE","$params",68],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_consumer_key'",68],"]",")",";",["T_WHITESPACE","\n        ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","_tokenProvider",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","validateConsumer",69],"(",["T_VARIABLE","$consumer",69],")",";",["T_WHITESPACE","\n        ",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","_validateSignature",70],"(",["T_VARIABLE","$params",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$consumer",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getSecret",70],"(",")",",",["T_WHITESPACE"," ",70],["T_VARIABLE","$httpMethod",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$requestUrl",70],")",";",["T_WHITESPACE","\n\n        ",70],["T_RETURN","return",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","_tokenProvider",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","createRequestToken",72],"(",["T_VARIABLE","$consumer",72],")",";",["T_WHITESPACE","\n    ",72],"}",["T_WHITESPACE","\n\n    ",73],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",75],["T_WHITESPACE","\n    ",77],["T_PUBLIC","public",78],["T_WHITESPACE"," ",78],["T_FUNCTION","function",78],["T_WHITESPACE"," ",78],["T_STRING","getAccessToken",78],"(",["T_VARIABLE","$params",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$requestUrl",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$httpMethod",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'POST'",78],")",["T_WHITESPACE","\n    ",78],"{",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$required",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],"[",["T_WHITESPACE","\n            ",80],["T_CONSTANT_ENCAPSED_STRING","'oauth_consumer_key'",81],",",["T_WHITESPACE","\n            ",81],["T_CONSTANT_ENCAPSED_STRING","'oauth_signature'",82],",",["T_WHITESPACE","\n            ",82],["T_CONSTANT_ENCAPSED_STRING","'oauth_signature_method'",83],",",["T_WHITESPACE","\n            ",83],["T_CONSTANT_ENCAPSED_STRING","'oauth_nonce'",84],",",["T_WHITESPACE","\n            ",84],["T_CONSTANT_ENCAPSED_STRING","'oauth_timestamp'",85],",",["T_WHITESPACE","\n            ",85],["T_CONSTANT_ENCAPSED_STRING","'oauth_token'",86],",",["T_WHITESPACE","\n            ",86],["T_CONSTANT_ENCAPSED_STRING","'oauth_verifier'",87],",",["T_WHITESPACE","\n        ",87],"]",";",["T_WHITESPACE","\n\n        ",88],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","_validateProtocolParams",90],"(",["T_VARIABLE","$params",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$required",90],")",";",["T_WHITESPACE","\n        ",90],["T_VARIABLE","$consumer",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","_tokenProvider",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getConsumerByKey",91],"(",["T_VARIABLE","$params",91],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_consumer_key'",91],"]",")",";",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$tokenSecret",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","_tokenProvider",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","validateRequestToken",92],"(",["T_WHITESPACE","\n            ",92],["T_VARIABLE","$params",93],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_token'",93],"]",",",["T_WHITESPACE","\n            ",93],["T_VARIABLE","$consumer",94],",",["T_WHITESPACE","\n            ",94],["T_VARIABLE","$params",95],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_verifier'",95],"]",["T_WHITESPACE","\n        ",95],")",";",["T_WHITESPACE","\n\n        ",96],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","_validateSignature",98],"(",["T_VARIABLE","$params",98],",",["T_WHITESPACE"," ",98],["T_VARIABLE","$consumer",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getSecret",98],"(",")",",",["T_WHITESPACE"," ",98],["T_VARIABLE","$httpMethod",98],",",["T_WHITESPACE"," ",98],["T_VARIABLE","$requestUrl",98],",",["T_WHITESPACE"," ",98],["T_VARIABLE","$tokenSecret",98],")",";",["T_WHITESPACE","\n\n        ",98],["T_RETURN","return",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","_tokenProvider",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getAccessToken",100],"(",["T_VARIABLE","$consumer",100],")",";",["T_WHITESPACE","\n    ",100],"}",["T_WHITESPACE","\n\n    ",101],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",103],["T_WHITESPACE","\n    ",105],["T_PUBLIC","public",106],["T_WHITESPACE"," ",106],["T_FUNCTION","function",106],["T_WHITESPACE"," ",106],["T_STRING","validateAccessTokenRequest",106],"(",["T_VARIABLE","$params",106],",",["T_WHITESPACE"," ",106],["T_VARIABLE","$requestUrl",106],",",["T_WHITESPACE"," ",106],["T_VARIABLE","$httpMethod",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'POST'",106],")",["T_WHITESPACE","\n    ",106],"{",["T_WHITESPACE","\n        ",107],["T_VARIABLE","$required",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],"[",["T_WHITESPACE","\n            ",108],["T_CONSTANT_ENCAPSED_STRING","'oauth_consumer_key'",109],",",["T_WHITESPACE","\n            ",109],["T_CONSTANT_ENCAPSED_STRING","'oauth_signature'",110],",",["T_WHITESPACE","\n            ",110],["T_CONSTANT_ENCAPSED_STRING","'oauth_signature_method'",111],",",["T_WHITESPACE","\n            ",111],["T_CONSTANT_ENCAPSED_STRING","'oauth_nonce'",112],",",["T_WHITESPACE","\n            ",112],["T_CONSTANT_ENCAPSED_STRING","'oauth_timestamp'",113],",",["T_WHITESPACE","\n            ",113],["T_CONSTANT_ENCAPSED_STRING","'oauth_token'",114],",",["T_WHITESPACE","\n        ",114],"]",";",["T_WHITESPACE","\n\n        ",115],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","_validateProtocolParams",117],"(",["T_VARIABLE","$params",117],",",["T_WHITESPACE"," ",117],["T_VARIABLE","$required",117],")",";",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$consumer",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","_tokenProvider",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","getConsumerByKey",118],"(",["T_VARIABLE","$params",118],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_consumer_key'",118],"]",")",";",["T_WHITESPACE","\n        ",118],["T_VARIABLE","$tokenSecret",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_tokenProvider",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","validateAccessTokenRequest",119],"(",["T_VARIABLE","$params",119],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_token'",119],"]",",",["T_WHITESPACE"," ",119],["T_VARIABLE","$consumer",119],")",";",["T_WHITESPACE","\n\n        ",119],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","_validateSignature",121],"(",["T_VARIABLE","$params",121],",",["T_WHITESPACE"," ",121],["T_VARIABLE","$consumer",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","getSecret",121],"(",")",",",["T_WHITESPACE"," ",121],["T_VARIABLE","$httpMethod",121],",",["T_WHITESPACE"," ",121],["T_VARIABLE","$requestUrl",121],",",["T_WHITESPACE"," ",121],["T_VARIABLE","$tokenSecret",121],")",";",["T_WHITESPACE","\n\n        ",121],["T_RETURN","return",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$consumer",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getId",123],"(",")",";",["T_WHITESPACE","\n    ",123],"}",["T_WHITESPACE","\n\n    ",124],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",126],["T_WHITESPACE","\n    ",128],["T_PUBLIC","public",129],["T_WHITESPACE"," ",129],["T_FUNCTION","function",129],["T_WHITESPACE"," ",129],["T_STRING","validateAccessToken",129],"(",["T_VARIABLE","$accessToken",129],")",["T_WHITESPACE","\n    ",129],"{",["T_WHITESPACE","\n        ",130],["T_RETURN","return",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","_tokenProvider",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","validateAccessToken",131],"(",["T_VARIABLE","$accessToken",131],")",";",["T_WHITESPACE","\n    ",131],"}",["T_WHITESPACE","\n\n    ",132],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",134],["T_WHITESPACE","\n    ",136],["T_PUBLIC","public",137],["T_WHITESPACE"," ",137],["T_FUNCTION","function",137],["T_WHITESPACE"," ",137],["T_STRING","buildAuthorizationHeader",137],"(",["T_WHITESPACE","\n        ",137],["T_VARIABLE","$params",138],",",["T_WHITESPACE","\n        ",138],["T_VARIABLE","$requestUrl",139],",",["T_WHITESPACE","\n        ",139],["T_VARIABLE","$signatureMethod",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_STRING","self",140],["T_DOUBLE_COLON","::",140],["T_STRING","SIGNATURE_SHA1",140],",",["T_WHITESPACE","\n        ",140],["T_VARIABLE","$httpMethod",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_CONSTANT_ENCAPSED_STRING","'POST'",141],["T_WHITESPACE","\n    ",141],")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n        ",142],["T_VARIABLE","$required",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],"[",["T_CONSTANT_ENCAPSED_STRING","\"oauth_consumer_key\"",143],",",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","\"oauth_consumer_secret\"",143],",",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","\"oauth_token\"",143],",",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","\"oauth_token_secret\"",143],"]",";",["T_WHITESPACE","\n        ",143],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","_checkRequiredParams",144],"(",["T_VARIABLE","$params",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$required",144],")",";",["T_WHITESPACE","\n        ",144],["T_VARIABLE","$consumer",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","_tokenProvider",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getConsumerByKey",145],"(",["T_VARIABLE","$params",145],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_consumer_key'",145],"]",")",";",["T_WHITESPACE","\n        ",145],["T_VARIABLE","$headerParameters",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],"[",["T_WHITESPACE","\n            ",146],["T_CONSTANT_ENCAPSED_STRING","'oauth_nonce'",147],["T_WHITESPACE"," ",147],["T_DOUBLE_ARROW","=>",147],["T_WHITESPACE"," ",147],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","_nonceGenerator",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","generateNonce",147],"(",["T_VARIABLE","$consumer",147],")",",",["T_WHITESPACE","\n            ",147],["T_CONSTANT_ENCAPSED_STRING","'oauth_timestamp'",148],["T_WHITESPACE"," ",148],["T_DOUBLE_ARROW","=>",148],["T_WHITESPACE"," ",148],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","_nonceGenerator",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","generateTimestamp",148],"(",")",",",["T_WHITESPACE","\n            ",148],["T_CONSTANT_ENCAPSED_STRING","'oauth_version'",149],["T_WHITESPACE"," ",149],["T_DOUBLE_ARROW","=>",149],["T_WHITESPACE"," ",149],["T_CONSTANT_ENCAPSED_STRING","'1.0'",149],",",["T_WHITESPACE","\n        ",149],"]",";",["T_WHITESPACE","\n        ",150],["T_VARIABLE","$headerParameters",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_STRING","array_merge",151],"(",["T_VARIABLE","$headerParameters",151],",",["T_WHITESPACE"," ",151],["T_VARIABLE","$params",151],")",";",["T_WHITESPACE","\n        ",151],["T_VARIABLE","$headerParameters",152],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_signature'",152],"]",["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","_httpUtility",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","sign",152],"(",["T_WHITESPACE","\n            ",152],["T_VARIABLE","$params",153],",",["T_WHITESPACE","\n            ",153],["T_VARIABLE","$signatureMethod",154],",",["T_WHITESPACE","\n            ",154],["T_VARIABLE","$headerParameters",155],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_consumer_secret'",155],"]",",",["T_WHITESPACE","\n            ",155],["T_VARIABLE","$headerParameters",156],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_token_secret'",156],"]",",",["T_WHITESPACE","\n            ",156],["T_VARIABLE","$httpMethod",157],",",["T_WHITESPACE","\n            ",157],["T_VARIABLE","$requestUrl",158],["T_WHITESPACE","\n        ",158],")",";",["T_WHITESPACE","\n        ",159],["T_VARIABLE","$authorizationHeader",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","_httpUtility",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","toAuthorizationHeader",160],"(",["T_VARIABLE","$headerParameters",160],")",";",["T_WHITESPACE","\n        ",160],["T_COMMENT","\/\/ toAuthorizationHeader adds an optional realm=\"\" which is not required for now.\n",161],["T_WHITESPACE","        ",162],["T_COMMENT","\/\/ http:\/\/tools.ietf.org\/html\/rfc2617#section-1.2\n",162],["T_WHITESPACE","        ",163],["T_RETURN","return",163],["T_WHITESPACE"," ",163],["T_STRING","str_replace",163],"(",["T_CONSTANT_ENCAPSED_STRING","'realm=\"\",'",163],",",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","''",163],",",["T_WHITESPACE"," ",163],["T_VARIABLE","$authorizationHeader",163],")",";",["T_WHITESPACE","\n    ",163],"}",["T_WHITESPACE","\n\n    ",164],["T_DOC_COMMENT","\/**\n     * Validate signature based on the signature method used.\n     *\n     * @param array $params\n     * @param string $consumerSecret\n     * @param string $httpMethod\n     * @param string $requestUrl\n     * @param string $tokenSecret\n     * @return void\n     * @throws Exception|OauthInputException\n     *\/",166],["T_WHITESPACE","\n    ",176],["T_PROTECTED","protected",177],["T_WHITESPACE"," ",177],["T_FUNCTION","function",177],["T_WHITESPACE"," ",177],["T_STRING","_validateSignature",177],"(",["T_VARIABLE","$params",177],",",["T_WHITESPACE"," ",177],["T_VARIABLE","$consumerSecret",177],",",["T_WHITESPACE"," ",177],["T_VARIABLE","$httpMethod",177],",",["T_WHITESPACE"," ",177],["T_VARIABLE","$requestUrl",177],",",["T_WHITESPACE"," ",177],["T_VARIABLE","$tokenSecret",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_STRING","null",177],")",["T_WHITESPACE","\n    ",177],"{",["T_WHITESPACE","\n        ",178],["T_IF","if",179],["T_WHITESPACE"," ",179],"(","!",["T_STRING","in_array",179],"(",["T_VARIABLE","$params",179],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_signature_method'",179],"]",",",["T_WHITESPACE"," ",179],["T_STRING","self",179],["T_DOUBLE_COLON","::",179],["T_STRING","getSupportedSignatureMethods",179],"(",")",")",")",["T_WHITESPACE"," ",179],"{",["T_WHITESPACE","\n            ",179],["T_THROW","throw",180],["T_WHITESPACE"," ",180],["T_NEW","new",180],["T_WHITESPACE"," ",180],["T_STRING","OauthInputException",180],"(",["T_WHITESPACE","\n                ",180],["T_NEW","new",181],["T_WHITESPACE"," ",181],["T_STRING","Phrase",181],"(",["T_WHITESPACE","\n                    ",181],["T_CONSTANT_ENCAPSED_STRING","'Signature method %1 is not supported'",182],",",["T_WHITESPACE","\n                    ",182],"[",["T_VARIABLE","$params",183],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_signature_method'",183],"]","]",["T_WHITESPACE","\n                ",183],")",["T_WHITESPACE","\n            ",184],")",";",["T_WHITESPACE","\n        ",185],"}",["T_WHITESPACE","\n\n        ",186],["T_VARIABLE","$allowedSignParams",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_VARIABLE","$params",188],";",["T_WHITESPACE","\n        ",188],["T_UNSET","unset",189],"(",["T_VARIABLE","$allowedSignParams",189],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_signature'",189],"]",")",";",["T_WHITESPACE","\n\n        ",189],["T_VARIABLE","$calculatedSign",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","_httpUtility",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","sign",191],"(",["T_WHITESPACE","\n            ",191],["T_VARIABLE","$allowedSignParams",192],",",["T_WHITESPACE","\n            ",192],["T_VARIABLE","$params",193],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_signature_method'",193],"]",",",["T_WHITESPACE","\n            ",193],["T_VARIABLE","$consumerSecret",194],",",["T_WHITESPACE","\n            ",194],["T_VARIABLE","$tokenSecret",195],",",["T_WHITESPACE","\n            ",195],["T_VARIABLE","$httpMethod",196],",",["T_WHITESPACE","\n            ",196],["T_VARIABLE","$requestUrl",197],["T_WHITESPACE","\n        ",197],")",";",["T_WHITESPACE","\n\n        ",198],["T_IF","if",200],["T_WHITESPACE"," ",200],"(","!",["T_STRING","Security",200],["T_DOUBLE_COLON","::",200],["T_STRING","compareStrings",200],"(",["T_VARIABLE","$calculatedSign",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$params",200],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_signature'",200],"]",")",")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n            ",200],["T_THROW","throw",201],["T_WHITESPACE"," ",201],["T_NEW","new",201],["T_WHITESPACE"," ",201],["T_STRING","Exception",201],"(",["T_NEW","new",201],["T_WHITESPACE"," ",201],["T_STRING","Phrase",201],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid signature'",201],")",")",";",["T_WHITESPACE","\n        ",201],"}",["T_WHITESPACE","\n    ",202],"}",["T_WHITESPACE","\n\n    ",203],["T_DOC_COMMENT","\/**\n     * Validate oauth version.\n     *\n     * @param string $version\n     * @return void\n     * @throws OauthInputException\n     *\/",205],["T_WHITESPACE","\n    ",211],["T_PROTECTED","protected",212],["T_WHITESPACE"," ",212],["T_FUNCTION","function",212],["T_WHITESPACE"," ",212],["T_STRING","_validateVersionParam",212],"(",["T_VARIABLE","$version",212],")",["T_WHITESPACE","\n    ",212],"{",["T_WHITESPACE","\n        ",213],["T_COMMENT","\/\/ validate version if specified\n",214],["T_WHITESPACE","        ",215],["T_IF","if",215],["T_WHITESPACE"," ",215],"(",["T_CONSTANT_ENCAPSED_STRING","'1.0'",215],["T_WHITESPACE"," ",215],["T_IS_NOT_EQUAL","!=",215],["T_WHITESPACE"," ",215],["T_VARIABLE","$version",215],")",["T_WHITESPACE"," ",215],"{",["T_WHITESPACE","\n            ",215],["T_THROW","throw",216],["T_WHITESPACE"," ",216],["T_NEW","new",216],["T_WHITESPACE"," ",216],["T_STRING","OauthInputException",216],"(",["T_NEW","new",216],["T_WHITESPACE"," ",216],["T_STRING","Phrase",216],"(",["T_CONSTANT_ENCAPSED_STRING","'OAuth version %1 is not supported'",216],",",["T_WHITESPACE"," ",216],"[",["T_VARIABLE","$version",216],"]",")",")",";",["T_WHITESPACE","\n        ",216],"}",["T_WHITESPACE","\n    ",217],"}",["T_WHITESPACE","\n\n    ",218],["T_DOC_COMMENT","\/**\n     * Validate request and header parameters.\n     *\n     * @param array $protocolParams\n     * @param array $requiredParams\n     * @return void\n     * @throws OauthInputException\n     *\/",220],["T_WHITESPACE","\n    ",227],["T_PROTECTED","protected",228],["T_WHITESPACE"," ",228],["T_FUNCTION","function",228],["T_WHITESPACE"," ",228],["T_STRING","_validateProtocolParams",228],"(",["T_VARIABLE","$protocolParams",228],",",["T_WHITESPACE"," ",228],["T_VARIABLE","$requiredParams",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],"[","]",")",["T_WHITESPACE","\n    ",228],"{",["T_WHITESPACE","\n        ",229],["T_COMMENT","\/\/ validate version if specified.\n",230],["T_WHITESPACE","        ",231],["T_IF","if",231],["T_WHITESPACE"," ",231],"(",["T_ISSET","isset",231],"(",["T_VARIABLE","$protocolParams",231],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_version'",231],"]",")",")",["T_WHITESPACE"," ",231],"{",["T_WHITESPACE","\n            ",231],["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","_validateVersionParam",232],"(",["T_VARIABLE","$protocolParams",232],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_version'",232],"]",")",";",["T_WHITESPACE","\n        ",232],"}",["T_WHITESPACE","\n\n        ",233],["T_COMMENT","\/\/ Required parameters validation. Default to minimum required params if not provided.\n",235],["T_WHITESPACE","        ",236],["T_IF","if",236],["T_WHITESPACE"," ",236],"(",["T_EMPTY","empty",236],"(",["T_VARIABLE","$requiredParams",236],")",")",["T_WHITESPACE"," ",236],"{",["T_WHITESPACE","\n            ",236],["T_VARIABLE","$requiredParams",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],"[",["T_WHITESPACE","\n                ",237],["T_CONSTANT_ENCAPSED_STRING","\"oauth_consumer_key\"",238],",",["T_WHITESPACE","\n                ",238],["T_CONSTANT_ENCAPSED_STRING","\"oauth_signature\"",239],",",["T_WHITESPACE","\n                ",239],["T_CONSTANT_ENCAPSED_STRING","\"oauth_signature_method\"",240],",",["T_WHITESPACE","\n                ",240],["T_CONSTANT_ENCAPSED_STRING","\"oauth_nonce\"",241],",",["T_WHITESPACE","\n                ",241],["T_CONSTANT_ENCAPSED_STRING","\"oauth_timestamp\"",242],",",["T_WHITESPACE","\n            ",242],"]",";",["T_WHITESPACE","\n        ",243],"}",["T_WHITESPACE","\n        ",244],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","_checkRequiredParams",245],"(",["T_VARIABLE","$protocolParams",245],",",["T_WHITESPACE"," ",245],["T_VARIABLE","$requiredParams",245],")",";",["T_WHITESPACE","\n\n        ",245],["T_IF","if",247],["T_WHITESPACE"," ",247],"(",["T_ISSET","isset",247],"(",["T_WHITESPACE","\n            ",247],["T_VARIABLE","$protocolParams",248],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_token'",248],"]",["T_WHITESPACE","\n        ",248],")",["T_WHITESPACE"," ",249],["T_BOOLEAN_AND","&&",249],["T_WHITESPACE"," ",249],"!",["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","_tokenProvider",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","validateOauthToken",249],"(",["T_WHITESPACE","\n            ",249],["T_VARIABLE","$protocolParams",250],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_token'",250],"]",["T_WHITESPACE","\n        ",250],")",["T_WHITESPACE","\n        ",251],")",["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n            ",252],["T_THROW","throw",253],["T_WHITESPACE"," ",253],["T_NEW","new",253],["T_WHITESPACE"," ",253],["T_STRING","OauthInputException",253],"(",["T_NEW","new",253],["T_WHITESPACE"," ",253],["T_STRING","Phrase",253],"(",["T_CONSTANT_ENCAPSED_STRING","'Token is not the correct length'",253],")",")",";",["T_WHITESPACE","\n        ",253],"}",["T_WHITESPACE","\n\n        ",254],["T_COMMENT","\/\/ Validate signature method.\n",256],["T_WHITESPACE","        ",257],["T_IF","if",257],["T_WHITESPACE"," ",257],"(","!",["T_STRING","in_array",257],"(",["T_VARIABLE","$protocolParams",257],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_signature_method'",257],"]",",",["T_WHITESPACE"," ",257],["T_STRING","self",257],["T_DOUBLE_COLON","::",257],["T_STRING","getSupportedSignatureMethods",257],"(",")",")",")",["T_WHITESPACE"," ",257],"{",["T_WHITESPACE","\n            ",257],["T_THROW","throw",258],["T_WHITESPACE"," ",258],["T_NEW","new",258],["T_WHITESPACE"," ",258],["T_STRING","OauthInputException",258],"(",["T_WHITESPACE","\n                ",258],["T_NEW","new",259],["T_WHITESPACE"," ",259],["T_STRING","Phrase",259],"(",["T_WHITESPACE","\n                    ",259],["T_CONSTANT_ENCAPSED_STRING","'Signature method %1 is not supported'",260],",",["T_WHITESPACE","\n                    ",260],"[",["T_VARIABLE","$protocolParams",261],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_signature_method'",261],"]","]",["T_WHITESPACE","\n                ",261],")",["T_WHITESPACE","\n            ",262],")",";",["T_WHITESPACE","\n        ",263],"}",["T_WHITESPACE","\n\n        ",264],["T_VARIABLE","$consumer",266],["T_WHITESPACE"," ",266],"=",["T_WHITESPACE"," ",266],["T_VARIABLE","$this",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","_tokenProvider",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","getConsumerByKey",266],"(",["T_VARIABLE","$protocolParams",266],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_consumer_key'",266],"]",")",";",["T_WHITESPACE","\n        ",266],["T_VARIABLE","$this",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","_nonceGenerator",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","validateNonce",267],"(",["T_WHITESPACE","\n            ",267],["T_VARIABLE","$consumer",268],",",["T_WHITESPACE","\n            ",268],["T_VARIABLE","$protocolParams",269],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_nonce'",269],"]",",",["T_WHITESPACE","\n            ",269],["T_VARIABLE","$protocolParams",270],"[",["T_CONSTANT_ENCAPSED_STRING","'oauth_timestamp'",270],"]",["T_WHITESPACE","\n        ",270],")",";",["T_WHITESPACE","\n    ",271],"}",["T_WHITESPACE","\n\n    ",272],["T_DOC_COMMENT","\/**\n     * Check if mandatory OAuth parameters are present.\n     *\n     * @param array $protocolParams\n     * @param array $requiredParams\n     * @return void\n     * @throws OauthInputException\n     *\/",274],["T_WHITESPACE","\n    ",281],["T_PROTECTED","protected",282],["T_WHITESPACE"," ",282],["T_FUNCTION","function",282],["T_WHITESPACE"," ",282],["T_STRING","_checkRequiredParams",282],"(",["T_VARIABLE","$protocolParams",282],",",["T_WHITESPACE"," ",282],["T_VARIABLE","$requiredParams",282],")",["T_WHITESPACE","\n    ",282],"{",["T_WHITESPACE","\n        ",283],["T_VARIABLE","$exception",284],["T_WHITESPACE"," ",284],"=",["T_WHITESPACE"," ",284],["T_NEW","new",284],["T_WHITESPACE"," ",284],["T_STRING","OauthInputException",284],"(",")",";",["T_WHITESPACE","\n        ",284],["T_FOREACH","foreach",285],["T_WHITESPACE"," ",285],"(",["T_VARIABLE","$requiredParams",285],["T_WHITESPACE"," ",285],["T_AS","as",285],["T_WHITESPACE"," ",285],["T_VARIABLE","$param",285],")",["T_WHITESPACE"," ",285],"{",["T_WHITESPACE","\n            ",285],["T_IF","if",286],["T_WHITESPACE"," ",286],"(","!",["T_ISSET","isset",286],"(",["T_VARIABLE","$protocolParams",286],"[",["T_VARIABLE","$param",286],"]",")",")",["T_WHITESPACE"," ",286],"{",["T_WHITESPACE","\n                ",286],["T_VARIABLE","$exception",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","addError",287],"(",["T_NEW","new",287],["T_WHITESPACE"," ",287],["T_STRING","Phrase",287],"(",["T_CONSTANT_ENCAPSED_STRING","'%fieldName is a required field.'",287],",",["T_WHITESPACE"," ",287],"[",["T_CONSTANT_ENCAPSED_STRING","'fieldName'",287],["T_WHITESPACE"," ",287],["T_DOUBLE_ARROW","=>",287],["T_WHITESPACE"," ",287],["T_VARIABLE","$param",287],"]",")",")",";",["T_WHITESPACE","\n            ",287],"}",["T_WHITESPACE","\n        ",288],"}",["T_WHITESPACE","\n        ",289],["T_IF","if",290],["T_WHITESPACE"," ",290],"(",["T_VARIABLE","$exception",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","wasErrorAdded",290],"(",")",")",["T_WHITESPACE"," ",290],"{",["T_WHITESPACE","\n            ",290],["T_THROW","throw",291],["T_WHITESPACE"," ",291],["T_VARIABLE","$exception",291],";",["T_WHITESPACE","\n        ",291],"}",["T_WHITESPACE","\n    ",292],"}",["T_WHITESPACE","\n",293],"}",["T_WHITESPACE","\n",294]]