[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_COMMENT","\/\/ @codingStandardsIgnoreFile\n",7],["T_WHITESPACE","\n",8],["T_NAMESPACE","namespace",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Mview",9],["T_NS_SEPARATOR","\\",9],["T_STRING","View",9],";",["T_WHITESPACE","\n\n",9],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Framework",11],["T_NS_SEPARATOR","\\",11],["T_STRING","App",11],["T_NS_SEPARATOR","\\",11],["T_STRING","ResourceConnection",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Framework",12],["T_NS_SEPARATOR","\\",12],["T_STRING","DB",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Ddl",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Trigger",12],";",["T_WHITESPACE","\n\n",12],["T_CLASS","class",14],["T_WHITESPACE"," ",14],["T_STRING","Subscription",14],["T_WHITESPACE"," ",14],["T_IMPLEMENTS","implements",14],["T_WHITESPACE"," ",14],["T_STRING","SubscriptionInterface",14],["T_WHITESPACE","\n",14],"{",["T_WHITESPACE","\n    ",15],["T_DOC_COMMENT","\/**\n     * Database connection\n     *\n     * @var \\Magento\\Framework\\DB\\Adapter\\AdapterInterface\n     *\/",16],["T_WHITESPACE","\n    ",20],["T_PROTECTED","protected",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$connection",21],";",["T_WHITESPACE","\n\n    ",21],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\DB\\Ddl\\TriggerFactory\n     *\/",23],["T_WHITESPACE","\n    ",25],["T_PROTECTED","protected",26],["T_WHITESPACE"," ",26],["T_VARIABLE","$triggerFactory",26],";",["T_WHITESPACE","\n\n    ",26],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Mview\\View\\CollectionInterface\n     *\/",28],["T_WHITESPACE","\n    ",30],["T_PROTECTED","protected",31],["T_WHITESPACE"," ",31],["T_VARIABLE","$viewCollection",31],";",["T_WHITESPACE","\n\n    ",31],["T_DOC_COMMENT","\/**\n     * @var string\n     *\/",33],["T_WHITESPACE","\n    ",35],["T_PROTECTED","protected",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$view",36],";",["T_WHITESPACE","\n\n    ",36],["T_DOC_COMMENT","\/**\n     * @var string\n     *\/",38],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$tableName",41],";",["T_WHITESPACE","\n\n    ",41],["T_DOC_COMMENT","\/**\n     * @var string\n     *\/",43],["T_WHITESPACE","\n    ",45],["T_PROTECTED","protected",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$columnName",46],";",["T_WHITESPACE","\n\n    ",46],["T_DOC_COMMENT","\/**\n     * List of views linked to the same entity as the current view\n     *\n     * @var array\n     *\/",48],["T_WHITESPACE","\n    ",52],["T_PROTECTED","protected",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$linkedViews",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],"[","]",";",["T_WHITESPACE","\n\n    ",53],["T_DOC_COMMENT","\/**\n     * @var Resource\n     *\/",55],["T_WHITESPACE","\n    ",57],["T_PROTECTED","protected",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$resource",58],";",["T_WHITESPACE","\n\n    ",58],["T_DOC_COMMENT","\/**\n     * @param ResourceConnection $resource\n     * @param \\Magento\\Framework\\DB\\Ddl\\TriggerFactory $triggerFactory\n     * @param \\Magento\\Framework\\Mview\\View\\CollectionInterface $viewCollection\n     * @param \\Magento\\Framework\\Mview\\ViewInterface $view\n     * @param string $tableName\n     * @param string $columnName\n     *\/",60],["T_WHITESPACE","\n    ",67],["T_PUBLIC","public",68],["T_WHITESPACE"," ",68],["T_FUNCTION","function",68],["T_WHITESPACE"," ",68],["T_STRING","__construct",68],"(",["T_WHITESPACE","\n        ",68],["T_STRING","ResourceConnection",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$resource",69],",",["T_WHITESPACE","\n        ",69],["T_NS_SEPARATOR","\\",70],["T_STRING","Magento",70],["T_NS_SEPARATOR","\\",70],["T_STRING","Framework",70],["T_NS_SEPARATOR","\\",70],["T_STRING","DB",70],["T_NS_SEPARATOR","\\",70],["T_STRING","Ddl",70],["T_NS_SEPARATOR","\\",70],["T_STRING","TriggerFactory",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$triggerFactory",70],",",["T_WHITESPACE","\n        ",70],["T_NS_SEPARATOR","\\",71],["T_STRING","Magento",71],["T_NS_SEPARATOR","\\",71],["T_STRING","Framework",71],["T_NS_SEPARATOR","\\",71],["T_STRING","Mview",71],["T_NS_SEPARATOR","\\",71],["T_STRING","View",71],["T_NS_SEPARATOR","\\",71],["T_STRING","CollectionInterface",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$viewCollection",71],",",["T_WHITESPACE","\n        ",71],["T_NS_SEPARATOR","\\",72],["T_STRING","Magento",72],["T_NS_SEPARATOR","\\",72],["T_STRING","Framework",72],["T_NS_SEPARATOR","\\",72],["T_STRING","Mview",72],["T_NS_SEPARATOR","\\",72],["T_STRING","ViewInterface",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$view",72],",",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$tableName",73],",",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$columnName",74],["T_WHITESPACE","\n    ",74],")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","connection",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$resource",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getConnection",76],"(",")",";",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","triggerFactory",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$triggerFactory",77],";",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","viewCollection",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$viewCollection",78],";",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","view",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$view",79],";",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","tableName",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$tableName",80],";",["T_WHITESPACE","\n        ",80],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","columnName",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$columnName",81],";",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","resource",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$resource",82],";",["T_WHITESPACE","\n    ",82],"}",["T_WHITESPACE","\n\n    ",83],["T_DOC_COMMENT","\/**\n     * Create subsciption\n     *\n     * @return \\Magento\\Framework\\Mview\\View\\SubscriptionInterface\n     *\/",85],["T_WHITESPACE","\n    ",89],["T_PUBLIC","public",90],["T_WHITESPACE"," ",90],["T_FUNCTION","function",90],["T_WHITESPACE"," ",90],["T_STRING","create",90],"(",")",["T_WHITESPACE","\n    ",90],"{",["T_WHITESPACE","\n        ",91],["T_FOREACH","foreach",92],["T_WHITESPACE"," ",92],"(",["T_STRING","Trigger",92],["T_DOUBLE_COLON","::",92],["T_STRING","getListOfEvents",92],"(",")",["T_WHITESPACE"," ",92],["T_AS","as",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$event",92],")",["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n            ",92],["T_VARIABLE","$triggerName",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getAfterEventTriggerName",93],"(",["T_VARIABLE","$event",93],")",";",["T_WHITESPACE","\n            ",93],["T_DOC_COMMENT","\/** @var Trigger $trigger *\/",94],["T_WHITESPACE","\n            ",94],["T_VARIABLE","$trigger",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","triggerFactory",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","create",95],"(",")",["T_WHITESPACE","\n                ",95],["T_OBJECT_OPERATOR","->",96],["T_STRING","setName",96],"(",["T_VARIABLE","$triggerName",96],")",["T_WHITESPACE","\n                ",96],["T_OBJECT_OPERATOR","->",97],["T_STRING","setTime",97],"(",["T_STRING","Trigger",97],["T_DOUBLE_COLON","::",97],["T_STRING","TIME_AFTER",97],")",["T_WHITESPACE","\n                ",97],["T_OBJECT_OPERATOR","->",98],["T_STRING","setEvent",98],"(",["T_VARIABLE","$event",98],")",["T_WHITESPACE","\n                ",98],["T_OBJECT_OPERATOR","->",99],["T_STRING","setTable",99],"(",["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","resource",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","getTableName",99],"(",["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","tableName",99],")",")",";",["T_WHITESPACE","\n\n            ",99],["T_VARIABLE","$trigger",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","addStatement",101],"(",["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","buildStatement",101],"(",["T_VARIABLE","$event",101],",",["T_WHITESPACE"," ",101],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getView",101],"(",")",["T_OBJECT_OPERATOR","->",101],["T_STRING","getChangelog",101],"(",")",")",")",";",["T_WHITESPACE","\n\n            ",101],["T_COMMENT","\/\/ Add statements for linked views\n",103],["T_WHITESPACE","            ",104],["T_FOREACH","foreach",104],["T_WHITESPACE"," ",104],"(",["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getLinkedViews",104],"(",")",["T_WHITESPACE"," ",104],["T_AS","as",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$view",104],")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n                ",104],["T_DOC_COMMENT","\/** @var \\Magento\\Framework\\Mview\\ViewInterface $view *\/",105],["T_WHITESPACE","\n                ",105],["T_VARIABLE","$trigger",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","addStatement",106],"(",["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","buildStatement",106],"(",["T_VARIABLE","$event",106],",",["T_WHITESPACE"," ",106],["T_VARIABLE","$view",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","getChangelog",106],"(",")",")",")",";",["T_WHITESPACE","\n            ",106],"}",["T_WHITESPACE","\n\n            ",107],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","connection",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","dropTrigger",109],"(",["T_VARIABLE","$trigger",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getName",109],"(",")",")",";",["T_WHITESPACE","\n            ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","connection",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","createTrigger",110],"(",["T_VARIABLE","$trigger",110],")",";",["T_WHITESPACE","\n        ",110],"}",["T_WHITESPACE","\n\n        ",111],["T_RETURN","return",113],["T_WHITESPACE"," ",113],["T_VARIABLE","$this",113],";",["T_WHITESPACE","\n    ",113],"}",["T_WHITESPACE","\n\n    ",114],["T_DOC_COMMENT","\/**\n     * Remove subscription\n     *\n     * @return \\Magento\\Framework\\Mview\\View\\SubscriptionInterface\n     *\/",116],["T_WHITESPACE","\n    ",120],["T_PUBLIC","public",121],["T_WHITESPACE"," ",121],["T_FUNCTION","function",121],["T_WHITESPACE"," ",121],["T_STRING","remove",121],"(",")",["T_WHITESPACE","\n    ",121],"{",["T_WHITESPACE","\n        ",122],["T_FOREACH","foreach",123],["T_WHITESPACE"," ",123],"(",["T_STRING","Trigger",123],["T_DOUBLE_COLON","::",123],["T_STRING","getListOfEvents",123],"(",")",["T_WHITESPACE"," ",123],["T_AS","as",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$event",123],")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n            ",123],["T_VARIABLE","$triggerName",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","getAfterEventTriggerName",124],"(",["T_VARIABLE","$event",124],")",";",["T_WHITESPACE","\n            ",124],["T_DOC_COMMENT","\/** @var Trigger $trigger *\/",125],["T_WHITESPACE","\n            ",125],["T_VARIABLE","$trigger",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","triggerFactory",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","create",126],"(",")",["T_WHITESPACE","\n                ",126],["T_OBJECT_OPERATOR","->",127],["T_STRING","setName",127],"(",["T_VARIABLE","$triggerName",127],")",["T_WHITESPACE","\n                ",127],["T_OBJECT_OPERATOR","->",128],["T_STRING","setTime",128],"(",["T_STRING","Trigger",128],["T_DOUBLE_COLON","::",128],["T_STRING","TIME_AFTER",128],")",["T_WHITESPACE","\n                ",128],["T_OBJECT_OPERATOR","->",129],["T_STRING","setEvent",129],"(",["T_VARIABLE","$event",129],")",["T_WHITESPACE","\n                ",129],["T_OBJECT_OPERATOR","->",130],["T_STRING","setTable",130],"(",["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","resource",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getTableName",130],"(",["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getTableName",130],"(",")",")",")",";",["T_WHITESPACE","\n\n            ",130],["T_COMMENT","\/\/ Add statements for linked views\n",132],["T_WHITESPACE","            ",133],["T_FOREACH","foreach",133],["T_WHITESPACE"," ",133],"(",["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getLinkedViews",133],"(",")",["T_WHITESPACE"," ",133],["T_AS","as",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$view",133],")",["T_WHITESPACE"," ",133],"{",["T_WHITESPACE","\n                ",133],["T_DOC_COMMENT","\/** @var \\Magento\\Framework\\Mview\\ViewInterface $view *\/",134],["T_WHITESPACE","\n                ",134],["T_VARIABLE","$trigger",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","addStatement",135],"(",["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","buildStatement",135],"(",["T_VARIABLE","$event",135],",",["T_WHITESPACE"," ",135],["T_VARIABLE","$view",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getChangelog",135],"(",")",")",")",";",["T_WHITESPACE","\n            ",135],"}",["T_WHITESPACE","\n\n            ",136],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","connection",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","dropTrigger",138],"(",["T_VARIABLE","$trigger",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","getName",138],"(",")",")",";",["T_WHITESPACE","\n\n            ",138],["T_COMMENT","\/\/ Re-create trigger if trigger used by linked views\n",140],["T_WHITESPACE","            ",141],["T_IF","if",141],["T_WHITESPACE"," ",141],"(",["T_VARIABLE","$trigger",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getStatements",141],"(",")",")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n                ",141],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","connection",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","createTrigger",142],"(",["T_VARIABLE","$trigger",142],")",";",["T_WHITESPACE","\n            ",142],"}",["T_WHITESPACE","\n        ",143],"}",["T_WHITESPACE","\n\n        ",144],["T_RETURN","return",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$this",146],";",["T_WHITESPACE","\n    ",146],"}",["T_WHITESPACE","\n\n    ",147],["T_DOC_COMMENT","\/**\n     * Retrieve list of linked views\n     *\n     * @return array\n     *\/",149],["T_WHITESPACE","\n    ",153],["T_PROTECTED","protected",154],["T_WHITESPACE"," ",154],["T_FUNCTION","function",154],["T_WHITESPACE"," ",154],["T_STRING","getLinkedViews",154],"(",")",["T_WHITESPACE","\n    ",154],"{",["T_WHITESPACE","\n        ",155],["T_IF","if",156],["T_WHITESPACE"," ",156],"(","!",["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","linkedViews",156],")",["T_WHITESPACE"," ",156],"{",["T_WHITESPACE","\n            ",156],["T_VARIABLE","$viewList",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","viewCollection",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","getViewsByStateMode",157],"(",["T_NS_SEPARATOR","\\",157],["T_STRING","Magento",157],["T_NS_SEPARATOR","\\",157],["T_STRING","Framework",157],["T_NS_SEPARATOR","\\",157],["T_STRING","Mview",157],["T_NS_SEPARATOR","\\",157],["T_STRING","View",157],["T_NS_SEPARATOR","\\",157],["T_STRING","StateInterface",157],["T_DOUBLE_COLON","::",157],["T_STRING","MODE_ENABLED",157],")",";",["T_WHITESPACE","\n\n            ",157],["T_FOREACH","foreach",159],["T_WHITESPACE"," ",159],"(",["T_VARIABLE","$viewList",159],["T_WHITESPACE"," ",159],["T_AS","as",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$view",159],")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n                ",159],["T_DOC_COMMENT","\/** @var \\Magento\\Framework\\Mview\\ViewInterface $view *\/",160],["T_WHITESPACE","\n                ",160],["T_COMMENT","\/\/ Skip the current view\n",161],["T_WHITESPACE","                ",162],["T_IF","if",162],["T_WHITESPACE"," ",162],"(",["T_VARIABLE","$view",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","getId",162],"(",")",["T_WHITESPACE"," ",162],["T_IS_EQUAL","==",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","getView",162],"(",")",["T_OBJECT_OPERATOR","->",162],["T_STRING","getId",162],"(",")",")",["T_WHITESPACE"," ",162],"{",["T_WHITESPACE","\n                    ",162],["T_CONTINUE","continue",163],";",["T_WHITESPACE","\n                ",163],"}",["T_WHITESPACE","\n                ",164],["T_COMMENT","\/\/ Search in view subscriptions\n",165],["T_WHITESPACE","                ",166],["T_FOREACH","foreach",166],["T_WHITESPACE"," ",166],"(",["T_VARIABLE","$view",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","getSubscriptions",166],"(",")",["T_WHITESPACE"," ",166],["T_AS","as",166],["T_WHITESPACE"," ",166],["T_VARIABLE","$subscription",166],")",["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n                    ",166],["T_IF","if",167],["T_WHITESPACE"," ",167],"(",["T_VARIABLE","$subscription",167],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",167],"]",["T_WHITESPACE"," ",167],["T_IS_NOT_EQUAL","!=",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","getTableName",167],"(",")",")",["T_WHITESPACE"," ",167],"{",["T_WHITESPACE","\n                        ",167],["T_CONTINUE","continue",168],";",["T_WHITESPACE","\n                    ",168],"}",["T_WHITESPACE","\n                    ",169],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","linkedViews",170],"[","]",["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_VARIABLE","$view",170],";",["T_WHITESPACE","\n                ",170],"}",["T_WHITESPACE","\n            ",171],"}",["T_WHITESPACE","\n        ",172],"}",["T_WHITESPACE","\n        ",173],["T_RETURN","return",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","linkedViews",174],";",["T_WHITESPACE","\n    ",174],"}",["T_WHITESPACE","\n\n    ",175],["T_DOC_COMMENT","\/**\n     * Build trigger statement for INSER, UPDATE, DELETE events\n     *\n     * @param string $event\n     * @param \\Magento\\Framework\\Mview\\View\\ChangelogInterface $changelog\n     * @return string\n     *\/",177],["T_WHITESPACE","\n    ",183],["T_PROTECTED","protected",184],["T_WHITESPACE"," ",184],["T_FUNCTION","function",184],["T_WHITESPACE"," ",184],["T_STRING","buildStatement",184],"(",["T_VARIABLE","$event",184],",",["T_WHITESPACE"," ",184],["T_VARIABLE","$changelog",184],")",["T_WHITESPACE","\n    ",184],"{",["T_WHITESPACE","\n        ",185],["T_SWITCH","switch",186],["T_WHITESPACE"," ",186],"(",["T_VARIABLE","$event",186],")",["T_WHITESPACE"," ",186],"{",["T_WHITESPACE","\n            ",186],["T_CASE","case",187],["T_WHITESPACE"," ",187],["T_STRING","Trigger",187],["T_DOUBLE_COLON","::",187],["T_STRING","EVENT_INSERT",187],":",["T_WHITESPACE","\n            ",187],["T_CASE","case",188],["T_WHITESPACE"," ",188],["T_STRING","Trigger",188],["T_DOUBLE_COLON","::",188],["T_STRING","EVENT_UPDATE",188],":",["T_WHITESPACE","\n                ",188],["T_RETURN","return",189],["T_WHITESPACE"," ",189],["T_STRING","sprintf",189],"(",["T_WHITESPACE","\n                    ",189],["T_CONSTANT_ENCAPSED_STRING","\"INSERT IGNORE INTO %s (%s) VALUES (NEW.%s);\"",190],",",["T_WHITESPACE","\n                    ",190],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","connection",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","quoteIdentifier",191],"(",["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","resource",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","getTableName",191],"(",["T_VARIABLE","$changelog",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","getName",191],"(",")",")",")",",",["T_WHITESPACE","\n                    ",191],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","connection",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","quoteIdentifier",192],"(",["T_VARIABLE","$changelog",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","getColumnName",192],"(",")",")",",",["T_WHITESPACE","\n                    ",192],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","connection",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","quoteIdentifier",193],"(",["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","getColumnName",193],"(",")",")",["T_WHITESPACE","\n                ",193],")",";",["T_WHITESPACE","\n\n            ",194],["T_CASE","case",196],["T_WHITESPACE"," ",196],["T_STRING","Trigger",196],["T_DOUBLE_COLON","::",196],["T_STRING","EVENT_DELETE",196],":",["T_WHITESPACE","\n                ",196],["T_RETURN","return",197],["T_WHITESPACE"," ",197],["T_STRING","sprintf",197],"(",["T_WHITESPACE","\n                    ",197],["T_CONSTANT_ENCAPSED_STRING","\"INSERT IGNORE INTO %s (%s) VALUES (OLD.%s);\"",198],",",["T_WHITESPACE","\n                    ",198],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","connection",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","quoteIdentifier",199],"(",["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","resource",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","getTableName",199],"(",["T_VARIABLE","$changelog",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","getName",199],"(",")",")",")",",",["T_WHITESPACE","\n                    ",199],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","connection",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","quoteIdentifier",200],"(",["T_VARIABLE","$changelog",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","getColumnName",200],"(",")",")",",",["T_WHITESPACE","\n                    ",200],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","connection",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","quoteIdentifier",201],"(",["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","getColumnName",201],"(",")",")",["T_WHITESPACE","\n                ",201],")",";",["T_WHITESPACE","\n\n            ",202],["T_DEFAULT","default",204],":",["T_WHITESPACE","\n                ",204],["T_RETURN","return",205],["T_WHITESPACE"," ",205],["T_CONSTANT_ENCAPSED_STRING","''",205],";",["T_WHITESPACE","\n        ",205],"}",["T_WHITESPACE","\n    ",206],"}",["T_WHITESPACE","\n\n    ",207],["T_DOC_COMMENT","\/**\n     * Build an \"after\" event for the given table and event\n     *\n     * @param string $event The DB level event, like \"update\" or \"insert\"\n     *\n     * @return string\n     *\/",209],["T_WHITESPACE","\n    ",215],["T_PRIVATE","private",216],["T_WHITESPACE"," ",216],["T_FUNCTION","function",216],["T_WHITESPACE"," ",216],["T_STRING","getAfterEventTriggerName",216],"(",["T_VARIABLE","$event",216],")",["T_WHITESPACE","\n    ",216],"{",["T_WHITESPACE","\n        ",217],["T_RETURN","return",218],["T_WHITESPACE"," ",218],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","resource",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","getTriggerName",218],"(",["T_WHITESPACE","\n            ",218],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","resource",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","getTableName",219],"(",["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","getTableName",219],"(",")",")",",",["T_WHITESPACE","\n            ",219],["T_STRING","Trigger",220],["T_DOUBLE_COLON","::",220],["T_STRING","TIME_AFTER",220],",",["T_WHITESPACE","\n            ",220],["T_VARIABLE","$event",221],["T_WHITESPACE","\n        ",221],")",";",["T_WHITESPACE","\n    ",222],"}",["T_WHITESPACE","\n\n    ",223],["T_DOC_COMMENT","\/**\n     * Retrieve View related to subscription\n     *\n     * @return \\Magento\\Framework\\Mview\\ViewInterface\n     * @codeCoverageIgnore\n     *\/",225],["T_WHITESPACE","\n    ",230],["T_PUBLIC","public",231],["T_WHITESPACE"," ",231],["T_FUNCTION","function",231],["T_WHITESPACE"," ",231],["T_STRING","getView",231],"(",")",["T_WHITESPACE","\n    ",231],"{",["T_WHITESPACE","\n        ",232],["T_RETURN","return",233],["T_WHITESPACE"," ",233],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","view",233],";",["T_WHITESPACE","\n    ",233],"}",["T_WHITESPACE","\n\n    ",234],["T_DOC_COMMENT","\/**\n     * Retrieve table name\n     *\n     * @return string\n     * @codeCoverageIgnore\n     *\/",236],["T_WHITESPACE","\n    ",241],["T_PUBLIC","public",242],["T_WHITESPACE"," ",242],["T_FUNCTION","function",242],["T_WHITESPACE"," ",242],["T_STRING","getTableName",242],"(",")",["T_WHITESPACE","\n    ",242],"{",["T_WHITESPACE","\n        ",243],["T_RETURN","return",244],["T_WHITESPACE"," ",244],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","tableName",244],";",["T_WHITESPACE","\n    ",244],"}",["T_WHITESPACE","\n\n    ",245],["T_DOC_COMMENT","\/**\n     * Retrieve table column name\n     *\n     * @return string\n     * @codeCoverageIgnore\n     *\/",247],["T_WHITESPACE","\n    ",252],["T_PUBLIC","public",253],["T_WHITESPACE"," ",253],["T_FUNCTION","function",253],["T_WHITESPACE"," ",253],["T_STRING","getColumnName",253],"(",")",["T_WHITESPACE","\n    ",253],"{",["T_WHITESPACE","\n        ",254],["T_RETURN","return",255],["T_WHITESPACE"," ",255],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","columnName",255],";",["T_WHITESPACE","\n    ",255],"}",["T_WHITESPACE","\n",256],"}",["T_WHITESPACE","\n",257]]