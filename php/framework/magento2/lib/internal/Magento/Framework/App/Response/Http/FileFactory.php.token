[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n *\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",6],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Framework",7],["T_NS_SEPARATOR","\\",7],["T_STRING","App",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Response",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Http",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","App",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Filesystem",9],["T_NS_SEPARATOR","\\",9],["T_STRING","DirectoryList",9],";",["T_WHITESPACE","\n\n",9],["T_CLASS","class",11],["T_WHITESPACE"," ",11],["T_STRING","FileFactory",11],["T_WHITESPACE","\n",11],"{",["T_WHITESPACE","\n    ",12],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\App\\ResponseInterface\n     *\/",13],["T_WHITESPACE","\n    ",15],["T_PROTECTED","protected",16],["T_WHITESPACE"," ",16],["T_VARIABLE","$_response",16],";",["T_WHITESPACE","\n\n    ",16],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Filesystem\n     *\/",18],["T_WHITESPACE","\n    ",20],["T_PROTECTED","protected",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$_filesystem",21],";",["T_WHITESPACE","\n\n    ",21],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\App\\ResponseInterface $response\n     * @param \\Magento\\Framework\\Filesystem $filesystem\n     *\/",23],["T_WHITESPACE","\n    ",26],["T_PUBLIC","public",27],["T_WHITESPACE"," ",27],["T_FUNCTION","function",27],["T_WHITESPACE"," ",27],["T_STRING","__construct",27],"(",["T_WHITESPACE","\n        ",27],["T_NS_SEPARATOR","\\",28],["T_STRING","Magento",28],["T_NS_SEPARATOR","\\",28],["T_STRING","Framework",28],["T_NS_SEPARATOR","\\",28],["T_STRING","App",28],["T_NS_SEPARATOR","\\",28],["T_STRING","ResponseInterface",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$response",28],",",["T_WHITESPACE","\n        ",28],["T_NS_SEPARATOR","\\",29],["T_STRING","Magento",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Framework",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Filesystem",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$filesystem",29],["T_WHITESPACE","\n    ",29],")",["T_WHITESPACE"," ",30],"{",["T_WHITESPACE","\n        ",30],["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","_response",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_VARIABLE","$response",31],";",["T_WHITESPACE","\n        ",31],["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","_filesystem",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_VARIABLE","$filesystem",32],";",["T_WHITESPACE","\n    ",32],"}",["T_WHITESPACE","\n\n    ",33],["T_DOC_COMMENT","\/**\n     * Declare headers and content file in response for file download\n     *\n     * @param string $fileName\n     * @param string|array $content set to null to avoid starting output, $contentLength should be set explicitly in\n     *                              that case\n     * @param string $baseDir\n     * @param string $contentType\n     * @param int $contentLength explicit content length, if strlen($content) isn't applicable\n     * @throws \\Exception\n     * @throws \\InvalidArgumentException\n     * @return \\Magento\\Framework\\App\\ResponseInterface\n     *\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     * @SuppressWarnings(PHPMD.NPathComplexity)\n     * @SuppressWarnings(PHPMD.ExitExpression)\n     *\/",35],["T_WHITESPACE","\n    ",51],["T_PUBLIC","public",52],["T_WHITESPACE"," ",52],["T_FUNCTION","function",52],["T_WHITESPACE"," ",52],["T_STRING","create",52],"(",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$fileName",53],",",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$content",54],",",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$baseDir",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","DirectoryList",55],["T_DOUBLE_COLON","::",55],["T_STRING","ROOT",55],",",["T_WHITESPACE","\n        ",55],["T_VARIABLE","$contentType",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'application\/octet-stream'",56],",",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$contentLength",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_STRING","null",57],["T_WHITESPACE","\n    ",57],")",["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$dir",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","_filesystem",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","getDirectoryWrite",59],"(",["T_VARIABLE","$baseDir",59],")",";",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$isFile",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_STRING","false",60],";",["T_WHITESPACE","\n        ",60],["T_VARIABLE","$file",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_STRING","null",61],";",["T_WHITESPACE","\n        ",61],["T_IF","if",62],["T_WHITESPACE"," ",62],"(",["T_STRING","is_array",62],"(",["T_VARIABLE","$content",62],")",")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n            ",62],["T_IF","if",63],["T_WHITESPACE"," ",63],"(","!",["T_ISSET","isset",63],"(",["T_VARIABLE","$content",63],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",63],"]",")",["T_WHITESPACE"," ",63],["T_BOOLEAN_OR","||",63],["T_WHITESPACE"," ",63],"!",["T_ISSET","isset",63],"(",["T_VARIABLE","$content",63],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",63],"]",")",")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n                ",63],["T_THROW","throw",64],["T_WHITESPACE"," ",64],["T_NEW","new",64],["T_WHITESPACE"," ",64],["T_NS_SEPARATOR","\\",64],["T_STRING","InvalidArgumentException",64],"(",["T_CONSTANT_ENCAPSED_STRING","\"Invalid arguments. Keys 'type' and 'value' are required.\"",64],")",";",["T_WHITESPACE","\n            ",64],"}",["T_WHITESPACE","\n            ",65],["T_IF","if",66],["T_WHITESPACE"," ",66],"(",["T_VARIABLE","$content",66],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",66],"]",["T_WHITESPACE"," ",66],["T_IS_EQUAL","==",66],["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'filename'",66],")",["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n                ",66],["T_VARIABLE","$isFile",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_STRING","true",67],";",["T_WHITESPACE","\n                ",67],["T_VARIABLE","$file",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$content",68],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",68],"]",";",["T_WHITESPACE","\n                ",68],["T_IF","if",69],["T_WHITESPACE"," ",69],"(","!",["T_VARIABLE","$dir",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","isFile",69],"(",["T_VARIABLE","$file",69],")",")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n                    ",69],["T_THROW","throw",70],["T_WHITESPACE"," ",70],["T_NEW","new",70],["T_WHITESPACE"," ",70],["T_NS_SEPARATOR","\\",70],["T_STRING","Exception",70],"(",["T_STRING_CAST","(string)",70],["T_NEW","new",70],["T_WHITESPACE"," ",70],["T_NS_SEPARATOR","\\",70],["T_STRING","Magento",70],["T_NS_SEPARATOR","\\",70],["T_STRING","Framework",70],["T_NS_SEPARATOR","\\",70],["T_STRING","Phrase",70],"(",["T_CONSTANT_ENCAPSED_STRING","'File not found'",70],")",")",";",["T_WHITESPACE","\n                ",70],"}",["T_WHITESPACE","\n                ",71],["T_VARIABLE","$contentLength",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_VARIABLE","$dir",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","stat",72],"(",["T_VARIABLE","$file",72],")","[",["T_CONSTANT_ENCAPSED_STRING","'size'",72],"]",";",["T_WHITESPACE","\n            ",72],"}",["T_WHITESPACE","\n        ",73],"}",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","_response",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","setHttpResponseCode",75],"(",["T_LNUMBER","200",75],")",["T_WHITESPACE","\n            ",75],["T_OBJECT_OPERATOR","->",76],["T_STRING","setHeader",76],"(",["T_CONSTANT_ENCAPSED_STRING","'Pragma'",76],",",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'public'",76],",",["T_WHITESPACE"," ",76],["T_STRING","true",76],")",["T_WHITESPACE","\n            ",76],["T_OBJECT_OPERATOR","->",77],["T_STRING","setHeader",77],"(",["T_CONSTANT_ENCAPSED_STRING","'Cache-Control'",77],",",["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","'must-revalidate, post-check=0, pre-check=0'",77],",",["T_WHITESPACE"," ",77],["T_STRING","true",77],")",["T_WHITESPACE","\n            ",77],["T_OBJECT_OPERATOR","->",78],["T_STRING","setHeader",78],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-type'",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$contentType",78],",",["T_WHITESPACE"," ",78],["T_STRING","true",78],")",["T_WHITESPACE","\n            ",78],["T_OBJECT_OPERATOR","->",79],["T_STRING","setHeader",79],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Length'",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$contentLength",79],["T_WHITESPACE"," ",79],["T_IS_IDENTICAL","===",79],["T_WHITESPACE"," ",79],["T_STRING","null",79],["T_WHITESPACE"," ",79],"?",["T_WHITESPACE"," ",79],["T_STRING","strlen",79],"(",["T_VARIABLE","$content",79],")",["T_WHITESPACE"," ",79],":",["T_WHITESPACE"," ",79],["T_VARIABLE","$contentLength",79],",",["T_WHITESPACE"," ",79],["T_STRING","true",79],")",["T_WHITESPACE","\n            ",79],["T_OBJECT_OPERATOR","->",80],["T_STRING","setHeader",80],"(",["T_CONSTANT_ENCAPSED_STRING","'Content-Disposition'",80],",",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'attachment; filename=\"'",80],["T_WHITESPACE"," ",80],".",["T_WHITESPACE"," ",80],["T_VARIABLE","$fileName",80],["T_WHITESPACE"," ",80],".",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'\"'",80],",",["T_WHITESPACE"," ",80],["T_STRING","true",80],")",["T_WHITESPACE","\n            ",80],["T_OBJECT_OPERATOR","->",81],["T_STRING","setHeader",81],"(",["T_CONSTANT_ENCAPSED_STRING","'Last-Modified'",81],",",["T_WHITESPACE"," ",81],["T_STRING","date",81],"(",["T_CONSTANT_ENCAPSED_STRING","'r'",81],")",",",["T_WHITESPACE"," ",81],["T_STRING","true",81],")",";",["T_WHITESPACE","\n\n        ",81],["T_IF","if",83],["T_WHITESPACE"," ",83],"(",["T_VARIABLE","$content",83],["T_WHITESPACE"," ",83],["T_IS_NOT_IDENTICAL","!==",83],["T_WHITESPACE"," ",83],["T_STRING","null",83],")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n            ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","_response",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","sendHeaders",84],"(",")",";",["T_WHITESPACE","\n            ",84],["T_IF","if",85],["T_WHITESPACE"," ",85],"(",["T_VARIABLE","$isFile",85],")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n                ",85],["T_VARIABLE","$stream",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$dir",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","openFile",86],"(",["T_VARIABLE","$file",86],",",["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","'r'",86],")",";",["T_WHITESPACE","\n                ",86],["T_WHILE","while",87],["T_WHITESPACE"," ",87],"(","!",["T_VARIABLE","$stream",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","eof",87],"(",")",")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n                    ",87],["T_ECHO","echo",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$stream",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","read",88],"(",["T_LNUMBER","1024",88],")",";",["T_WHITESPACE","\n                ",88],"}",["T_WHITESPACE","\n            ",89],"}",["T_WHITESPACE"," ",90],["T_ELSE","else",90],["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n                ",90],["T_VARIABLE","$dir",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","writeFile",91],"(",["T_VARIABLE","$fileName",91],",",["T_WHITESPACE"," ",91],["T_VARIABLE","$content",91],")",";",["T_WHITESPACE","\n                ",91],["T_VARIABLE","$stream",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$dir",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","openFile",92],"(",["T_VARIABLE","$fileName",92],",",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'r'",92],")",";",["T_WHITESPACE","\n                ",92],["T_WHILE","while",93],["T_WHITESPACE"," ",93],"(","!",["T_VARIABLE","$stream",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","eof",93],"(",")",")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n                    ",93],["T_ECHO","echo",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$stream",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","read",94],"(",["T_LNUMBER","1024",94],")",";",["T_WHITESPACE","\n                ",94],"}",["T_WHITESPACE","\n            ",95],"}",["T_WHITESPACE","\n            ",96],["T_VARIABLE","$stream",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","close",97],"(",")",";",["T_WHITESPACE","\n            ",97],["T_STRING","flush",98],"(",")",";",["T_WHITESPACE","\n            ",98],["T_IF","if",99],["T_WHITESPACE"," ",99],"(","!",["T_EMPTY","empty",99],"(",["T_VARIABLE","$content",99],"[",["T_CONSTANT_ENCAPSED_STRING","'rm'",99],"]",")",")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n                ",99],["T_VARIABLE","$dir",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","delete",100],"(",["T_VARIABLE","$file",100],")",";",["T_WHITESPACE","\n            ",100],"}",["T_WHITESPACE","\n            ",101],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","callExit",102],"(",")",";",["T_WHITESPACE","\n        ",102],"}",["T_WHITESPACE","\n        ",103],["T_RETURN","return",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","_response",104],";",["T_WHITESPACE","\n    ",104],"}",["T_WHITESPACE","\n\n    ",105],["T_DOC_COMMENT","\/**\n     * Call exit\n     *\n     * @return void\n     * @SuppressWarnings(PHPMD.ExitExpression)\n     *\/",107],["T_WHITESPACE","\n    ",112],["T_PROTECTED","protected",113],["T_WHITESPACE"," ",113],["T_FUNCTION","function",113],["T_WHITESPACE"," ",113],["T_STRING","callExit",113],"(",")",["T_WHITESPACE","\n    ",113],"{",["T_WHITESPACE","\n        ",114],["T_EXIT","exit",115],"(",["T_LNUMBER","0",115],")",";",["T_WHITESPACE","\n    ",115],"}",["T_WHITESPACE","\n",116],"}",["T_WHITESPACE","\n",117]]