[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Framework",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Encryption",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","App",8],["T_NS_SEPARATOR","\\",8],["T_STRING","DeploymentConfig",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Encryption",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Helper",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Security",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Math",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Random",10],";",["T_WHITESPACE","\n\n",10],["T_DOC_COMMENT","\/**\n * Class Encryptor provides basic logic for hashing strings and encrypting\/decrypting misc data\n *\/",12],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","Encryptor",15],["T_WHITESPACE"," ",15],["T_IMPLEMENTS","implements",15],["T_WHITESPACE"," ",15],["T_STRING","EncryptorInterface",15],["T_WHITESPACE","\n",15],"{",["T_WHITESPACE","\n    ",16],["T_DOC_COMMENT","\/**\n     * Key of md5 algorithm\n     *\/",17],["T_WHITESPACE","\n    ",19],["T_CONST","const",20],["T_WHITESPACE"," ",20],["T_STRING","HASH_VERSION_MD5",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_LNUMBER","0",20],";",["T_WHITESPACE","\n\n    ",20],["T_DOC_COMMENT","\/**\n     * Key of sha256 algorithm\n     *\/",22],["T_WHITESPACE","\n    ",24],["T_CONST","const",25],["T_WHITESPACE"," ",25],["T_STRING","HASH_VERSION_SHA256",25],["T_WHITESPACE"," ",25],"=",["T_WHITESPACE"," ",25],["T_LNUMBER","1",25],";",["T_WHITESPACE","\n\n    ",25],["T_DOC_COMMENT","\/**\n     * Key of latest used algorithm\n     *\/",27],["T_WHITESPACE","\n    ",29],["T_CONST","const",30],["T_WHITESPACE"," ",30],["T_STRING","HASH_VERSION_LATEST",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_LNUMBER","1",30],";",["T_WHITESPACE","\n\n    ",30],["T_DOC_COMMENT","\/**\n     * Default length of salt in bytes\n     *\/",32],["T_WHITESPACE","\n    ",34],["T_CONST","const",35],["T_WHITESPACE"," ",35],["T_STRING","DEFAULT_SALT_LENGTH",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_LNUMBER","32",35],";",["T_WHITESPACE","\n\n    ",35],["T_COMMENT","\/**#@+\n     * Exploded password hash keys\n     *\/",37],["T_WHITESPACE","\n    ",39],["T_CONST","const",40],["T_WHITESPACE"," ",40],["T_STRING","PASSWORD_HASH",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_LNUMBER","0",40],";",["T_WHITESPACE","\n    ",40],["T_CONST","const",41],["T_WHITESPACE"," ",41],["T_STRING","PASSWORD_SALT",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_LNUMBER","1",41],";",["T_WHITESPACE","\n    ",41],["T_CONST","const",42],["T_WHITESPACE"," ",42],["T_STRING","PASSWORD_VERSION",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_LNUMBER","2",42],";",["T_WHITESPACE","\n    ",42],["T_COMMENT","\/**#@-*\/",43],["T_WHITESPACE","\n\n    ",43],["T_DOC_COMMENT","\/**\n     * Array key of encryption key in deployment config\n     *\/",45],["T_WHITESPACE","\n    ",47],["T_CONST","const",48],["T_WHITESPACE"," ",48],["T_STRING","PARAM_CRYPT_KEY",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'crypt\/key'",48],";",["T_WHITESPACE","\n\n    ",48],["T_COMMENT","\/**#@+\n     * Cipher versions\n     *\/",50],["T_WHITESPACE","\n    ",52],["T_CONST","const",53],["T_WHITESPACE"," ",53],["T_STRING","CIPHER_BLOWFISH",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_LNUMBER","0",53],";",["T_WHITESPACE","\n\n    ",53],["T_CONST","const",55],["T_WHITESPACE"," ",55],["T_STRING","CIPHER_RIJNDAEL_128",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_LNUMBER","1",55],";",["T_WHITESPACE","\n\n    ",55],["T_CONST","const",57],["T_WHITESPACE"," ",57],["T_STRING","CIPHER_RIJNDAEL_256",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_LNUMBER","2",57],";",["T_WHITESPACE","\n\n    ",57],["T_CONST","const",59],["T_WHITESPACE"," ",59],["T_STRING","CIPHER_LATEST",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_LNUMBER","2",59],";",["T_WHITESPACE","\n    ",59],["T_COMMENT","\/**#@-*\/",60],["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * Default hash string delimiter\n     *\/",62],["T_WHITESPACE","\n    ",64],["T_CONST","const",65],["T_WHITESPACE"," ",65],["T_STRING","DELIMITER",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","':'",65],";",["T_WHITESPACE","\n\n    ",65],["T_DOC_COMMENT","\/**\n     * @var array map of hash versions\n     *\/",67],["T_WHITESPACE","\n    ",69],["T_PRIVATE","private",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$hashVersionMap",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],"[",["T_WHITESPACE","\n        ",70],["T_STRING","self",71],["T_DOUBLE_COLON","::",71],["T_STRING","HASH_VERSION_MD5",71],["T_WHITESPACE"," ",71],["T_DOUBLE_ARROW","=>",71],["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'md5'",71],",",["T_WHITESPACE","\n        ",71],["T_STRING","self",72],["T_DOUBLE_COLON","::",72],["T_STRING","HASH_VERSION_SHA256",72],["T_WHITESPACE"," ",72],["T_DOUBLE_ARROW","=>",72],["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'sha256'",72],["T_WHITESPACE","\n    ",72],"]",";",["T_WHITESPACE","\n\n    ",73],["T_DOC_COMMENT","\/**\n     * @var array map of password hash\n     *\/",75],["T_WHITESPACE","\n    ",77],["T_PRIVATE","private",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$passwordHashMap",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],"[",["T_WHITESPACE","\n        ",78],["T_STRING","self",79],["T_DOUBLE_COLON","::",79],["T_STRING","PASSWORD_HASH",79],["T_WHITESPACE"," ",79],["T_DOUBLE_ARROW","=>",79],["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","''",79],",",["T_WHITESPACE","\n        ",79],["T_STRING","self",80],["T_DOUBLE_COLON","::",80],["T_STRING","PASSWORD_SALT",80],["T_WHITESPACE"," ",80],["T_DOUBLE_ARROW","=>",80],["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","''",80],",",["T_WHITESPACE","\n        ",80],["T_STRING","self",81],["T_DOUBLE_COLON","::",81],["T_STRING","PASSWORD_VERSION",81],["T_WHITESPACE"," ",81],["T_DOUBLE_ARROW","=>",81],["T_WHITESPACE"," ",81],["T_STRING","self",81],["T_DOUBLE_COLON","::",81],["T_STRING","HASH_VERSION_LATEST",81],["T_WHITESPACE","\n    ",81],"]",";",["T_WHITESPACE","\n\n    ",82],["T_DOC_COMMENT","\/**\n     * Indicate cipher\n     *\n     * @var int\n     *\/",84],["T_WHITESPACE","\n    ",88],["T_PROTECTED","protected",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$cipher",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_STRING","self",89],["T_DOUBLE_COLON","::",89],["T_STRING","CIPHER_LATEST",89],";",["T_WHITESPACE","\n\n    ",89],["T_DOC_COMMENT","\/**\n     * Version of encryption key\n     *\n     * @var int\n     *\/",91],["T_WHITESPACE","\n    ",95],["T_PROTECTED","protected",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$keyVersion",96],";",["T_WHITESPACE","\n\n    ",96],["T_DOC_COMMENT","\/**\n     * Array of encryption keys\n     *\n     * @var string[]\n     *\/",98],["T_WHITESPACE","\n    ",102],["T_PROTECTED","protected",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$keys",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],"[","]",";",["T_WHITESPACE","\n\n    ",103],["T_DOC_COMMENT","\/**\n     * @param Random $random\n     * @param DeploymentConfig $deploymentConfig\n     *\/",105],["T_WHITESPACE","\n    ",108],["T_PUBLIC","public",109],["T_WHITESPACE"," ",109],["T_FUNCTION","function",109],["T_WHITESPACE"," ",109],["T_STRING","__construct",109],"(",["T_WHITESPACE","\n        ",109],["T_STRING","Random",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$random",110],",",["T_WHITESPACE","\n        ",110],["T_STRING","DeploymentConfig",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$deploymentConfig",111],["T_WHITESPACE","\n    ",111],")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n        ",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","random",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_VARIABLE","$random",113],";",["T_WHITESPACE","\n\n        ",113],["T_COMMENT","\/\/ load all possible keys\n",115],["T_WHITESPACE","        ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","keys",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_STRING","preg_split",116],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\\s+\/s'",116],",",["T_WHITESPACE"," ",116],["T_STRING","trim",116],"(",["T_VARIABLE","$deploymentConfig",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","get",116],"(",["T_STRING","self",116],["T_DOUBLE_COLON","::",116],["T_STRING","PARAM_CRYPT_KEY",116],")",")",")",";",["T_WHITESPACE","\n        ",116],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","keyVersion",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_STRING","count",117],"(",["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","keys",117],")",["T_WHITESPACE"," ",117],"-",["T_WHITESPACE"," ",117],["T_LNUMBER","1",117],";",["T_WHITESPACE","\n    ",117],"}",["T_WHITESPACE","\n\n    ",118],["T_DOC_COMMENT","\/**\n     * Check whether specified cipher version is supported\n     *\n     * Returns matched supported version or throws exception\n     *\n     * @param int $version\n     * @return int\n     * @throws \\Exception\n     *\/",120],["T_WHITESPACE","\n    ",128],["T_PUBLIC","public",129],["T_WHITESPACE"," ",129],["T_FUNCTION","function",129],["T_WHITESPACE"," ",129],["T_STRING","validateCipher",129],"(",["T_VARIABLE","$version",129],")",["T_WHITESPACE","\n    ",129],"{",["T_WHITESPACE","\n        ",130],["T_VARIABLE","$types",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],"[",["T_STRING","self",131],["T_DOUBLE_COLON","::",131],["T_STRING","CIPHER_BLOWFISH",131],",",["T_WHITESPACE"," ",131],["T_STRING","self",131],["T_DOUBLE_COLON","::",131],["T_STRING","CIPHER_RIJNDAEL_128",131],",",["T_WHITESPACE"," ",131],["T_STRING","self",131],["T_DOUBLE_COLON","::",131],["T_STRING","CIPHER_RIJNDAEL_256",131],"]",";",["T_WHITESPACE","\n\n        ",131],["T_VARIABLE","$version",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_INT_CAST","(int)",133],["T_VARIABLE","$version",133],";",["T_WHITESPACE","\n        ",133],["T_IF","if",134],["T_WHITESPACE"," ",134],"(","!",["T_STRING","in_array",134],"(",["T_VARIABLE","$version",134],",",["T_WHITESPACE"," ",134],["T_VARIABLE","$types",134],",",["T_WHITESPACE"," ",134],["T_STRING","true",134],")",")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n            ",134],["T_THROW","throw",135],["T_WHITESPACE"," ",135],["T_NEW","new",135],["T_WHITESPACE"," ",135],["T_NS_SEPARATOR","\\",135],["T_STRING","Exception",135],"(",["T_STRING_CAST","(string)",135],["T_NEW","new",135],["T_WHITESPACE"," ",135],["T_NS_SEPARATOR","\\",135],["T_STRING","Magento",135],["T_NS_SEPARATOR","\\",135],["T_STRING","Framework",135],["T_NS_SEPARATOR","\\",135],["T_STRING","Phrase",135],"(",["T_CONSTANT_ENCAPSED_STRING","'Not supported cipher version'",135],")",")",";",["T_WHITESPACE","\n        ",135],"}",["T_WHITESPACE","\n        ",136],["T_RETURN","return",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$version",137],";",["T_WHITESPACE","\n    ",137],"}",["T_WHITESPACE","\n\n    ",138],["T_DOC_COMMENT","\/**\n     * @inheritdoc\n     *\/",140],["T_WHITESPACE","\n    ",142],["T_PUBLIC","public",143],["T_WHITESPACE"," ",143],["T_FUNCTION","function",143],["T_WHITESPACE"," ",143],["T_STRING","getHash",143],"(",["T_VARIABLE","$password",143],",",["T_WHITESPACE"," ",143],["T_VARIABLE","$salt",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_STRING","false",143],",",["T_WHITESPACE"," ",143],["T_VARIABLE","$version",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_STRING","self",143],["T_DOUBLE_COLON","::",143],["T_STRING","HASH_VERSION_LATEST",143],")",["T_WHITESPACE","\n    ",143],"{",["T_WHITESPACE","\n        ",144],["T_IF","if",145],["T_WHITESPACE"," ",145],"(",["T_VARIABLE","$salt",145],["T_WHITESPACE"," ",145],["T_IS_IDENTICAL","===",145],["T_WHITESPACE"," ",145],["T_STRING","false",145],")",["T_WHITESPACE"," ",145],"{",["T_WHITESPACE","\n            ",145],["T_RETURN","return",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","hash",146],"(",["T_VARIABLE","$password",146],")",";",["T_WHITESPACE","\n        ",146],"}",["T_WHITESPACE","\n        ",147],["T_IF","if",148],["T_WHITESPACE"," ",148],"(",["T_VARIABLE","$salt",148],["T_WHITESPACE"," ",148],["T_IS_IDENTICAL","===",148],["T_WHITESPACE"," ",148],["T_STRING","true",148],")",["T_WHITESPACE"," ",148],"{",["T_WHITESPACE","\n            ",148],["T_VARIABLE","$salt",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_STRING","self",149],["T_DOUBLE_COLON","::",149],["T_STRING","DEFAULT_SALT_LENGTH",149],";",["T_WHITESPACE","\n        ",149],"}",["T_WHITESPACE","\n        ",150],["T_IF","if",151],["T_WHITESPACE"," ",151],"(",["T_STRING","is_integer",151],"(",["T_VARIABLE","$salt",151],")",")",["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n            ",151],["T_VARIABLE","$salt",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","random",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","getRandomString",152],"(",["T_VARIABLE","$salt",152],")",";",["T_WHITESPACE","\n        ",152],"}",["T_WHITESPACE","\n\n        ",153],["T_RETURN","return",155],["T_WHITESPACE"," ",155],["T_STRING","implode",155],"(",["T_WHITESPACE","\n            ",155],["T_STRING","self",156],["T_DOUBLE_COLON","::",156],["T_STRING","DELIMITER",156],",",["T_WHITESPACE","\n            ",156],"[",["T_WHITESPACE","\n                ",157],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","hash",158],"(",["T_VARIABLE","$salt",158],["T_WHITESPACE"," ",158],".",["T_WHITESPACE"," ",158],["T_VARIABLE","$password",158],")",",",["T_WHITESPACE","\n                ",158],["T_VARIABLE","$salt",159],",",["T_WHITESPACE","\n                ",159],["T_VARIABLE","$version",160],["T_WHITESPACE","\n            ",160],"]",["T_WHITESPACE","\n        ",161],")",";",["T_WHITESPACE","\n    ",162],"}",["T_WHITESPACE","\n\n    ",163],["T_DOC_COMMENT","\/**\n     * @inheritdoc\n     *\/",165],["T_WHITESPACE","\n    ",167],["T_PUBLIC","public",168],["T_WHITESPACE"," ",168],["T_FUNCTION","function",168],["T_WHITESPACE"," ",168],["T_STRING","hash",168],"(",["T_VARIABLE","$data",168],",",["T_WHITESPACE"," ",168],["T_VARIABLE","$version",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_STRING","self",168],["T_DOUBLE_COLON","::",168],["T_STRING","HASH_VERSION_LATEST",168],")",["T_WHITESPACE","\n    ",168],"{",["T_WHITESPACE","\n        ",169],["T_RETURN","return",170],["T_WHITESPACE"," ",170],["T_STRING","hash",170],"(",["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","hashVersionMap",170],"[",["T_VARIABLE","$version",170],"]",",",["T_WHITESPACE"," ",170],["T_VARIABLE","$data",170],")",";",["T_WHITESPACE","\n    ",170],"}",["T_WHITESPACE","\n\n    ",171],["T_DOC_COMMENT","\/**\n     * @inheritdoc\n     *\/",173],["T_WHITESPACE","\n    ",175],["T_PUBLIC","public",176],["T_WHITESPACE"," ",176],["T_FUNCTION","function",176],["T_WHITESPACE"," ",176],["T_STRING","validateHash",176],"(",["T_VARIABLE","$password",176],",",["T_WHITESPACE"," ",176],["T_VARIABLE","$hash",176],")",["T_WHITESPACE","\n    ",176],"{",["T_WHITESPACE","\n        ",177],["T_RETURN","return",178],["T_WHITESPACE"," ",178],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","isValidHash",178],"(",["T_VARIABLE","$password",178],",",["T_WHITESPACE"," ",178],["T_VARIABLE","$hash",178],")",";",["T_WHITESPACE","\n    ",178],"}",["T_WHITESPACE","\n\n    ",179],["T_DOC_COMMENT","\/**\n     * @inheritdoc\n     *\/",181],["T_WHITESPACE","\n    ",183],["T_PUBLIC","public",184],["T_WHITESPACE"," ",184],["T_FUNCTION","function",184],["T_WHITESPACE"," ",184],["T_STRING","isValidHash",184],"(",["T_VARIABLE","$password",184],",",["T_WHITESPACE"," ",184],["T_VARIABLE","$hash",184],")",["T_WHITESPACE","\n    ",184],"{",["T_WHITESPACE","\n        ",185],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","explodePasswordHash",186],"(",["T_VARIABLE","$hash",186],")",";",["T_WHITESPACE","\n\n        ",186],["T_FOREACH","foreach",188],["T_WHITESPACE"," ",188],"(",["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getPasswordVersion",188],"(",")",["T_WHITESPACE"," ",188],["T_AS","as",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$hashVersion",188],")",["T_WHITESPACE"," ",188],"{",["T_WHITESPACE","\n            ",188],["T_VARIABLE","$password",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","hash",189],"(",["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getPasswordSalt",189],"(",")",["T_WHITESPACE"," ",189],".",["T_WHITESPACE"," ",189],["T_VARIABLE","$password",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$hashVersion",189],")",";",["T_WHITESPACE","\n        ",189],"}",["T_WHITESPACE","\n\n        ",190],["T_RETURN","return",192],["T_WHITESPACE"," ",192],["T_STRING","Security",192],["T_DOUBLE_COLON","::",192],["T_STRING","compareStrings",192],"(",["T_WHITESPACE","\n            ",192],["T_VARIABLE","$password",193],",",["T_WHITESPACE","\n            ",193],["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","getPasswordHash",194],"(",")",["T_WHITESPACE","\n        ",194],")",";",["T_WHITESPACE","\n    ",195],"}",["T_WHITESPACE","\n\n    ",196],["T_DOC_COMMENT","\/**\n     * @inheritdoc\n     *\/",198],["T_WHITESPACE","\n    ",200],["T_PUBLIC","public",201],["T_WHITESPACE"," ",201],["T_FUNCTION","function",201],["T_WHITESPACE"," ",201],["T_STRING","validateHashVersion",201],"(",["T_VARIABLE","$hash",201],",",["T_WHITESPACE"," ",201],["T_VARIABLE","$validateCount",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_STRING","false",201],")",["T_WHITESPACE","\n    ",201],"{",["T_WHITESPACE","\n        ",202],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","explodePasswordHash",203],"(",["T_VARIABLE","$hash",203],")",";",["T_WHITESPACE","\n        ",203],["T_VARIABLE","$hashVersions",204],["T_WHITESPACE"," ",204],"=",["T_WHITESPACE"," ",204],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","getPasswordVersion",204],"(",")",";",["T_WHITESPACE","\n\n        ",204],["T_RETURN","return",206],["T_WHITESPACE"," ",206],["T_VARIABLE","$validateCount",206],["T_WHITESPACE","\n            ",206],"?",["T_WHITESPACE"," ",207],["T_STRING","end",207],"(",["T_VARIABLE","$hashVersions",207],")",["T_WHITESPACE"," ",207],["T_IS_IDENTICAL","===",207],["T_WHITESPACE"," ",207],["T_STRING","self",207],["T_DOUBLE_COLON","::",207],["T_STRING","HASH_VERSION_LATEST",207],["T_WHITESPACE"," ",207],["T_BOOLEAN_AND","&&",207],["T_WHITESPACE"," ",207],["T_STRING","count",207],"(",["T_VARIABLE","$hashVersions",207],")",["T_WHITESPACE"," ",207],["T_IS_IDENTICAL","===",207],["T_WHITESPACE"," ",207],["T_LNUMBER","1",207],["T_WHITESPACE","\n            ",207],":",["T_WHITESPACE"," ",208],["T_STRING","end",208],"(",["T_VARIABLE","$hashVersions",208],")",["T_WHITESPACE"," ",208],["T_IS_IDENTICAL","===",208],["T_WHITESPACE"," ",208],["T_STRING","self",208],["T_DOUBLE_COLON","::",208],["T_STRING","HASH_VERSION_LATEST",208],";",["T_WHITESPACE","\n    ",208],"}",["T_WHITESPACE","\n\n    ",209],["T_DOC_COMMENT","\/**\n     * @param string $hash\n     * @return array\n     *\/",211],["T_WHITESPACE","\n    ",214],["T_PRIVATE","private",215],["T_WHITESPACE"," ",215],["T_FUNCTION","function",215],["T_WHITESPACE"," ",215],["T_STRING","explodePasswordHash",215],"(",["T_VARIABLE","$hash",215],")",["T_WHITESPACE","\n    ",215],"{",["T_WHITESPACE","\n        ",216],["T_VARIABLE","$explodedPassword",217],["T_WHITESPACE"," ",217],"=",["T_WHITESPACE"," ",217],["T_STRING","explode",217],"(",["T_STRING","self",217],["T_DOUBLE_COLON","::",217],["T_STRING","DELIMITER",217],",",["T_WHITESPACE"," ",217],["T_VARIABLE","$hash",217],",",["T_WHITESPACE"," ",217],["T_LNUMBER","3",217],")",";",["T_WHITESPACE","\n\n        ",217],["T_FOREACH","foreach",219],["T_WHITESPACE"," ",219],"(",["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","passwordHashMap",219],["T_WHITESPACE"," ",219],["T_AS","as",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$key",219],["T_WHITESPACE"," ",219],["T_DOUBLE_ARROW","=>",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$defaultValue",219],")",["T_WHITESPACE"," ",219],"{",["T_WHITESPACE","\n            ",219],["T_VARIABLE","$this",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","passwordHashMap",220],"[",["T_VARIABLE","$key",220],"]",["T_WHITESPACE"," ",220],"=",["T_WHITESPACE"," ",220],"(",["T_ISSET","isset",220],"(",["T_VARIABLE","$explodedPassword",220],"[",["T_VARIABLE","$key",220],"]",")",")",["T_WHITESPACE"," ",220],"?",["T_WHITESPACE"," ",220],["T_VARIABLE","$explodedPassword",220],"[",["T_VARIABLE","$key",220],"]",["T_WHITESPACE"," ",220],":",["T_WHITESPACE"," ",220],["T_VARIABLE","$defaultValue",220],";",["T_WHITESPACE","\n        ",220],"}",["T_WHITESPACE","\n\n        ",221],["T_RETURN","return",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","passwordHashMap",223],";",["T_WHITESPACE","\n    ",223],"}",["T_WHITESPACE","\n\n    ",224],["T_DOC_COMMENT","\/**\n     * @return string\n     *\/",226],["T_WHITESPACE","\n    ",228],["T_PRIVATE","private",229],["T_WHITESPACE"," ",229],["T_FUNCTION","function",229],["T_WHITESPACE"," ",229],["T_STRING","getPasswordHash",229],"(",")",["T_WHITESPACE","\n    ",229],"{",["T_WHITESPACE","\n        ",230],["T_RETURN","return",231],["T_WHITESPACE"," ",231],["T_STRING_CAST","(string)",231],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","passwordHashMap",231],"[",["T_STRING","self",231],["T_DOUBLE_COLON","::",231],["T_STRING","PASSWORD_HASH",231],"]",";",["T_WHITESPACE","\n    ",231],"}",["T_WHITESPACE","\n\n    ",232],["T_DOC_COMMENT","\/**\n     * @return string\n     *\/",234],["T_WHITESPACE","\n    ",236],["T_PRIVATE","private",237],["T_WHITESPACE"," ",237],["T_FUNCTION","function",237],["T_WHITESPACE"," ",237],["T_STRING","getPasswordSalt",237],"(",")",["T_WHITESPACE","\n    ",237],"{",["T_WHITESPACE","\n        ",238],["T_RETURN","return",239],["T_WHITESPACE"," ",239],["T_STRING_CAST","(string)",239],["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","passwordHashMap",239],"[",["T_STRING","self",239],["T_DOUBLE_COLON","::",239],["T_STRING","PASSWORD_SALT",239],"]",";",["T_WHITESPACE","\n    ",239],"}",["T_WHITESPACE","\n\n    ",240],["T_DOC_COMMENT","\/**\n     * @return array\n     *\/",242],["T_WHITESPACE","\n    ",244],["T_PRIVATE","private",245],["T_WHITESPACE"," ",245],["T_FUNCTION","function",245],["T_WHITESPACE"," ",245],["T_STRING","getPasswordVersion",245],"(",")",["T_WHITESPACE","\n    ",245],"{",["T_WHITESPACE","\n        ",246],["T_RETURN","return",247],["T_WHITESPACE"," ",247],["T_STRING","array_map",247],"(",["T_CONSTANT_ENCAPSED_STRING","'intval'",247],",",["T_WHITESPACE"," ",247],["T_STRING","explode",247],"(",["T_STRING","self",247],["T_DOUBLE_COLON","::",247],["T_STRING","DELIMITER",247],",",["T_WHITESPACE"," ",247],["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","passwordHashMap",247],"[",["T_STRING","self",247],["T_DOUBLE_COLON","::",247],["T_STRING","PASSWORD_VERSION",247],"]",")",")",";",["T_WHITESPACE","\n    ",247],"}",["T_WHITESPACE","\n\n    ",248],["T_DOC_COMMENT","\/**\n     * Prepend key and cipher versions to encrypted data after encrypting\n     *\n     * @param string $data\n     * @return string\n     *\/",250],["T_WHITESPACE","\n    ",255],["T_PUBLIC","public",256],["T_WHITESPACE"," ",256],["T_FUNCTION","function",256],["T_WHITESPACE"," ",256],["T_STRING","encrypt",256],"(",["T_VARIABLE","$data",256],")",["T_WHITESPACE","\n    ",256],"{",["T_WHITESPACE","\n        ",257],["T_VARIABLE","$crypt",258],["T_WHITESPACE"," ",258],"=",["T_WHITESPACE"," ",258],["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","getCrypt",258],"(",")",";",["T_WHITESPACE","\n        ",258],["T_IF","if",259],["T_WHITESPACE"," ",259],"(",["T_STRING","null",259],["T_WHITESPACE"," ",259],["T_IS_IDENTICAL","===",259],["T_WHITESPACE"," ",259],["T_VARIABLE","$crypt",259],")",["T_WHITESPACE"," ",259],"{",["T_WHITESPACE","\n            ",259],["T_RETURN","return",260],["T_WHITESPACE"," ",260],["T_VARIABLE","$data",260],";",["T_WHITESPACE","\n        ",260],"}",["T_WHITESPACE","\n        ",261],["T_RETURN","return",262],["T_WHITESPACE"," ",262],["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","keyVersion",262],["T_WHITESPACE"," ",262],".",["T_WHITESPACE"," ",262],["T_CONSTANT_ENCAPSED_STRING","':'",262],["T_WHITESPACE"," ",262],".",["T_WHITESPACE"," ",262],["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","cipher",262],["T_WHITESPACE"," ",262],".",["T_WHITESPACE"," ",262],["T_CONSTANT_ENCAPSED_STRING","':'",262],["T_WHITESPACE"," ",262],".",["T_WHITESPACE"," ",262],"(",["T_STRING","MCRYPT_MODE_CBC",262],["T_WHITESPACE"," ",262],["T_IS_IDENTICAL","===",262],["T_WHITESPACE","\n        ",262],["T_VARIABLE","$crypt",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","getMode",263],"(",")",["T_WHITESPACE"," ",263],"?",["T_WHITESPACE"," ",263],["T_VARIABLE","$crypt",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","getInitVector",263],"(",")",["T_WHITESPACE"," ",263],".",["T_WHITESPACE"," ",263],["T_CONSTANT_ENCAPSED_STRING","':'",263],["T_WHITESPACE"," ",263],":",["T_WHITESPACE"," ",263],["T_CONSTANT_ENCAPSED_STRING","''",263],")",["T_WHITESPACE"," ",263],".",["T_WHITESPACE"," ",263],["T_STRING","base64_encode",263],"(",["T_WHITESPACE","\n            ",263],["T_VARIABLE","$crypt",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","encrypt",264],"(",["T_STRING_CAST","(string)",264],["T_VARIABLE","$data",264],")",["T_WHITESPACE","\n        ",264],")",";",["T_WHITESPACE","\n    ",265],"}",["T_WHITESPACE","\n\n    ",266],["T_DOC_COMMENT","\/**\n     * Look for key and crypt versions in encrypted data before decrypting\n     *\n     * Unsupported\/unspecified key version silently fallback to the oldest we have\n     * Unsupported cipher versions eventually throw exception\n     * Unspecified cipher version fallback to the oldest we support\n     *\n     * @param string $data\n     * @return string\n     *\/",268],["T_WHITESPACE","\n    ",277],["T_PUBLIC","public",278],["T_WHITESPACE"," ",278],["T_FUNCTION","function",278],["T_WHITESPACE"," ",278],["T_STRING","decrypt",278],"(",["T_VARIABLE","$data",278],")",["T_WHITESPACE","\n    ",278],"{",["T_WHITESPACE","\n        ",279],["T_IF","if",280],["T_WHITESPACE"," ",280],"(",["T_VARIABLE","$data",280],")",["T_WHITESPACE"," ",280],"{",["T_WHITESPACE","\n            ",280],["T_VARIABLE","$parts",281],["T_WHITESPACE"," ",281],"=",["T_WHITESPACE"," ",281],["T_STRING","explode",281],"(",["T_CONSTANT_ENCAPSED_STRING","':'",281],",",["T_WHITESPACE"," ",281],["T_VARIABLE","$data",281],",",["T_WHITESPACE"," ",281],["T_LNUMBER","4",281],")",";",["T_WHITESPACE","\n            ",281],["T_VARIABLE","$partsCount",282],["T_WHITESPACE"," ",282],"=",["T_WHITESPACE"," ",282],["T_STRING","count",282],"(",["T_VARIABLE","$parts",282],")",";",["T_WHITESPACE","\n\n            ",282],["T_VARIABLE","$initVector",284],["T_WHITESPACE"," ",284],"=",["T_WHITESPACE"," ",284],["T_STRING","false",284],";",["T_WHITESPACE","\n            ",284],["T_COMMENT","\/\/ specified key, specified crypt, specified iv\n",285],["T_WHITESPACE","            ",286],["T_IF","if",286],["T_WHITESPACE"," ",286],"(",["T_LNUMBER","4",286],["T_WHITESPACE"," ",286],["T_IS_IDENTICAL","===",286],["T_WHITESPACE"," ",286],["T_VARIABLE","$partsCount",286],")",["T_WHITESPACE"," ",286],"{",["T_WHITESPACE","\n                ",286],["T_LIST","list",287],"(",["T_VARIABLE","$keyVersion",287],",",["T_WHITESPACE"," ",287],["T_VARIABLE","$cryptVersion",287],",",["T_WHITESPACE"," ",287],["T_VARIABLE","$iv",287],",",["T_WHITESPACE"," ",287],["T_VARIABLE","$data",287],")",["T_WHITESPACE"," ",287],"=",["T_WHITESPACE"," ",287],["T_VARIABLE","$parts",287],";",["T_WHITESPACE","\n                ",287],["T_VARIABLE","$initVector",288],["T_WHITESPACE"," ",288],"=",["T_WHITESPACE"," ",288],["T_VARIABLE","$iv",288],["T_WHITESPACE"," ",288],"?",["T_WHITESPACE"," ",288],["T_VARIABLE","$iv",288],["T_WHITESPACE"," ",288],":",["T_WHITESPACE"," ",288],["T_STRING","false",288],";",["T_WHITESPACE","\n                ",288],["T_VARIABLE","$keyVersion",289],["T_WHITESPACE"," ",289],"=",["T_WHITESPACE"," ",289],["T_INT_CAST","(int)",289],["T_VARIABLE","$keyVersion",289],";",["T_WHITESPACE","\n                ",289],["T_VARIABLE","$cryptVersion",290],["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],["T_STRING","self",290],["T_DOUBLE_COLON","::",290],["T_STRING","CIPHER_RIJNDAEL_256",290],";",["T_WHITESPACE","\n                ",290],["T_COMMENT","\/\/ specified key, specified crypt\n",291],["T_WHITESPACE","            ",292],"}",["T_WHITESPACE"," ",292],["T_ELSEIF","elseif",292],["T_WHITESPACE"," ",292],"(",["T_LNUMBER","3",292],["T_WHITESPACE"," ",292],["T_IS_IDENTICAL","===",292],["T_WHITESPACE"," ",292],["T_VARIABLE","$partsCount",292],")",["T_WHITESPACE"," ",292],"{",["T_WHITESPACE","\n                ",292],["T_LIST","list",293],"(",["T_VARIABLE","$keyVersion",293],",",["T_WHITESPACE"," ",293],["T_VARIABLE","$cryptVersion",293],",",["T_WHITESPACE"," ",293],["T_VARIABLE","$data",293],")",["T_WHITESPACE"," ",293],"=",["T_WHITESPACE"," ",293],["T_VARIABLE","$parts",293],";",["T_WHITESPACE","\n                ",293],["T_VARIABLE","$keyVersion",294],["T_WHITESPACE"," ",294],"=",["T_WHITESPACE"," ",294],["T_INT_CAST","(int)",294],["T_VARIABLE","$keyVersion",294],";",["T_WHITESPACE","\n                ",294],["T_VARIABLE","$cryptVersion",295],["T_WHITESPACE"," ",295],"=",["T_WHITESPACE"," ",295],["T_INT_CAST","(int)",295],["T_VARIABLE","$cryptVersion",295],";",["T_WHITESPACE","\n                ",295],["T_COMMENT","\/\/ no key version = oldest key, specified crypt\n",296],["T_WHITESPACE","            ",297],"}",["T_WHITESPACE"," ",297],["T_ELSEIF","elseif",297],["T_WHITESPACE"," ",297],"(",["T_LNUMBER","2",297],["T_WHITESPACE"," ",297],["T_IS_IDENTICAL","===",297],["T_WHITESPACE"," ",297],["T_VARIABLE","$partsCount",297],")",["T_WHITESPACE"," ",297],"{",["T_WHITESPACE","\n                ",297],["T_LIST","list",298],"(",["T_VARIABLE","$cryptVersion",298],",",["T_WHITESPACE"," ",298],["T_VARIABLE","$data",298],")",["T_WHITESPACE"," ",298],"=",["T_WHITESPACE"," ",298],["T_VARIABLE","$parts",298],";",["T_WHITESPACE","\n                ",298],["T_VARIABLE","$keyVersion",299],["T_WHITESPACE"," ",299],"=",["T_WHITESPACE"," ",299],["T_LNUMBER","0",299],";",["T_WHITESPACE","\n                ",299],["T_VARIABLE","$cryptVersion",300],["T_WHITESPACE"," ",300],"=",["T_WHITESPACE"," ",300],["T_INT_CAST","(int)",300],["T_VARIABLE","$cryptVersion",300],";",["T_WHITESPACE","\n                ",300],["T_COMMENT","\/\/ no key version = oldest key, no crypt version = oldest crypt\n",301],["T_WHITESPACE","            ",302],"}",["T_WHITESPACE"," ",302],["T_ELSEIF","elseif",302],["T_WHITESPACE"," ",302],"(",["T_LNUMBER","1",302],["T_WHITESPACE"," ",302],["T_IS_IDENTICAL","===",302],["T_WHITESPACE"," ",302],["T_VARIABLE","$partsCount",302],")",["T_WHITESPACE"," ",302],"{",["T_WHITESPACE","\n                ",302],["T_VARIABLE","$keyVersion",303],["T_WHITESPACE"," ",303],"=",["T_WHITESPACE"," ",303],["T_LNUMBER","0",303],";",["T_WHITESPACE","\n                ",303],["T_VARIABLE","$cryptVersion",304],["T_WHITESPACE"," ",304],"=",["T_WHITESPACE"," ",304],["T_STRING","self",304],["T_DOUBLE_COLON","::",304],["T_STRING","CIPHER_BLOWFISH",304],";",["T_WHITESPACE","\n                ",304],["T_COMMENT","\/\/ not supported format\n",305],["T_WHITESPACE","            ",306],"}",["T_WHITESPACE"," ",306],["T_ELSE","else",306],["T_WHITESPACE"," ",306],"{",["T_WHITESPACE","\n                ",306],["T_RETURN","return",307],["T_WHITESPACE"," ",307],["T_CONSTANT_ENCAPSED_STRING","''",307],";",["T_WHITESPACE","\n            ",307],"}",["T_WHITESPACE","\n            ",308],["T_COMMENT","\/\/ no key for decryption\n",309],["T_WHITESPACE","            ",310],["T_IF","if",310],["T_WHITESPACE"," ",310],"(","!",["T_ISSET","isset",310],"(",["T_VARIABLE","$this",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","keys",310],"[",["T_VARIABLE","$keyVersion",310],"]",")",")",["T_WHITESPACE"," ",310],"{",["T_WHITESPACE","\n                ",310],["T_RETURN","return",311],["T_WHITESPACE"," ",311],["T_CONSTANT_ENCAPSED_STRING","''",311],";",["T_WHITESPACE","\n            ",311],"}",["T_WHITESPACE","\n            ",312],["T_VARIABLE","$crypt",313],["T_WHITESPACE"," ",313],"=",["T_WHITESPACE"," ",313],["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","getCrypt",313],"(",["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","keys",313],"[",["T_VARIABLE","$keyVersion",313],"]",",",["T_WHITESPACE"," ",313],["T_VARIABLE","$cryptVersion",313],",",["T_WHITESPACE"," ",313],["T_VARIABLE","$initVector",313],")",";",["T_WHITESPACE","\n            ",313],["T_IF","if",314],["T_WHITESPACE"," ",314],"(",["T_STRING","null",314],["T_WHITESPACE"," ",314],["T_IS_IDENTICAL","===",314],["T_WHITESPACE"," ",314],["T_VARIABLE","$crypt",314],")",["T_WHITESPACE"," ",314],"{",["T_WHITESPACE","\n                ",314],["T_RETURN","return",315],["T_WHITESPACE"," ",315],["T_CONSTANT_ENCAPSED_STRING","''",315],";",["T_WHITESPACE","\n            ",315],"}",["T_WHITESPACE","\n            ",316],["T_RETURN","return",317],["T_WHITESPACE"," ",317],["T_STRING","trim",317],"(",["T_VARIABLE","$crypt",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","decrypt",317],"(",["T_STRING","base64_decode",317],"(",["T_STRING_CAST","(string)",317],["T_VARIABLE","$data",317],")",")",")",";",["T_WHITESPACE","\n        ",317],"}",["T_WHITESPACE","\n        ",318],["T_RETURN","return",319],["T_WHITESPACE"," ",319],["T_CONSTANT_ENCAPSED_STRING","''",319],";",["T_WHITESPACE","\n    ",319],"}",["T_WHITESPACE","\n\n    ",320],["T_DOC_COMMENT","\/**\n     * Return crypt model, instantiate if it is empty\n     *\n     * @param string|null $key NULL value means usage of the default key specified on constructor\n     * @return \\Magento\\Framework\\Encryption\\Crypt\n     * @throws \\Exception\n     *\/",322],["T_WHITESPACE","\n    ",328],["T_PUBLIC","public",329],["T_WHITESPACE"," ",329],["T_FUNCTION","function",329],["T_WHITESPACE"," ",329],["T_STRING","validateKey",329],"(",["T_VARIABLE","$key",329],")",["T_WHITESPACE","\n    ",329],"{",["T_WHITESPACE","\n        ",330],["T_IF","if",331],["T_WHITESPACE"," ",331],"(",["T_STRING","preg_match",331],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\\s\/s'",331],",",["T_WHITESPACE"," ",331],["T_VARIABLE","$key",331],")",")",["T_WHITESPACE"," ",331],"{",["T_WHITESPACE","\n            ",331],["T_THROW","throw",332],["T_WHITESPACE"," ",332],["T_NEW","new",332],["T_WHITESPACE"," ",332],["T_NS_SEPARATOR","\\",332],["T_STRING","Exception",332],"(",["T_STRING_CAST","(string)",332],["T_NEW","new",332],["T_WHITESPACE"," ",332],["T_NS_SEPARATOR","\\",332],["T_STRING","Magento",332],["T_NS_SEPARATOR","\\",332],["T_STRING","Framework",332],["T_NS_SEPARATOR","\\",332],["T_STRING","Phrase",332],"(",["T_CONSTANT_ENCAPSED_STRING","'The encryption key format is invalid.'",332],")",")",";",["T_WHITESPACE","\n        ",332],"}",["T_WHITESPACE","\n        ",333],["T_RETURN","return",334],["T_WHITESPACE"," ",334],["T_VARIABLE","$this",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","getCrypt",334],"(",["T_VARIABLE","$key",334],")",";",["T_WHITESPACE","\n    ",334],"}",["T_WHITESPACE","\n\n    ",335],["T_DOC_COMMENT","\/**\n     * Attempt to append new key & version\n     *\n     * @param string $key\n     * @return $this\n     *\/",337],["T_WHITESPACE","\n    ",342],["T_PUBLIC","public",343],["T_WHITESPACE"," ",343],["T_FUNCTION","function",343],["T_WHITESPACE"," ",343],["T_STRING","setNewKey",343],"(",["T_VARIABLE","$key",343],")",["T_WHITESPACE","\n    ",343],"{",["T_WHITESPACE","\n        ",344],["T_VARIABLE","$this",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","validateKey",345],"(",["T_VARIABLE","$key",345],")",";",["T_WHITESPACE","\n        ",345],["T_VARIABLE","$this",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","keys",346],"[","]",["T_WHITESPACE"," ",346],"=",["T_WHITESPACE"," ",346],["T_VARIABLE","$key",346],";",["T_WHITESPACE","\n        ",346],["T_VARIABLE","$this",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","keyVersion",347],["T_WHITESPACE"," ",347],["T_PLUS_EQUAL","+=",347],["T_WHITESPACE"," ",347],["T_LNUMBER","1",347],";",["T_WHITESPACE","\n        ",347],["T_RETURN","return",348],["T_WHITESPACE"," ",348],["T_VARIABLE","$this",348],";",["T_WHITESPACE","\n    ",348],"}",["T_WHITESPACE","\n\n    ",349],["T_DOC_COMMENT","\/**\n     * Export current keys as string\n     *\n     * @return string\n     *\/",351],["T_WHITESPACE","\n    ",355],["T_PUBLIC","public",356],["T_WHITESPACE"," ",356],["T_FUNCTION","function",356],["T_WHITESPACE"," ",356],["T_STRING","exportKeys",356],"(",")",["T_WHITESPACE","\n    ",356],"{",["T_WHITESPACE","\n        ",357],["T_RETURN","return",358],["T_WHITESPACE"," ",358],["T_STRING","implode",358],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",358],",",["T_WHITESPACE"," ",358],["T_VARIABLE","$this",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","keys",358],")",";",["T_WHITESPACE","\n    ",358],"}",["T_WHITESPACE","\n\n    ",359],["T_DOC_COMMENT","\/**\n     * Initialize crypt module if needed\n     *\n     * By default initializes with latest key and crypt versions\n     *\n     * @param string $key\n     * @param int $cipherVersion\n     * @param bool $initVector\n     * @return Crypt|null\n     *\/",361],["T_WHITESPACE","\n    ",370],["T_PROTECTED","protected",371],["T_WHITESPACE"," ",371],["T_FUNCTION","function",371],["T_WHITESPACE"," ",371],["T_STRING","getCrypt",371],"(",["T_VARIABLE","$key",371],["T_WHITESPACE"," ",371],"=",["T_WHITESPACE"," ",371],["T_STRING","null",371],",",["T_WHITESPACE"," ",371],["T_VARIABLE","$cipherVersion",371],["T_WHITESPACE"," ",371],"=",["T_WHITESPACE"," ",371],["T_STRING","null",371],",",["T_WHITESPACE"," ",371],["T_VARIABLE","$initVector",371],["T_WHITESPACE"," ",371],"=",["T_WHITESPACE"," ",371],["T_STRING","true",371],")",["T_WHITESPACE","\n    ",371],"{",["T_WHITESPACE","\n        ",372],["T_IF","if",373],["T_WHITESPACE"," ",373],"(",["T_STRING","null",373],["T_WHITESPACE"," ",373],["T_IS_IDENTICAL","===",373],["T_WHITESPACE"," ",373],["T_VARIABLE","$key",373],["T_WHITESPACE"," ",373],["T_BOOLEAN_AND","&&",373],["T_WHITESPACE"," ",373],["T_STRING","null",373],["T_WHITESPACE"," ",373],["T_IS_IDENTICAL","===",373],["T_WHITESPACE"," ",373],["T_VARIABLE","$cipherVersion",373],")",["T_WHITESPACE"," ",373],"{",["T_WHITESPACE","\n            ",373],["T_VARIABLE","$cipherVersion",374],["T_WHITESPACE"," ",374],"=",["T_WHITESPACE"," ",374],["T_STRING","self",374],["T_DOUBLE_COLON","::",374],["T_STRING","CIPHER_RIJNDAEL_256",374],";",["T_WHITESPACE","\n        ",374],"}",["T_WHITESPACE","\n\n        ",375],["T_IF","if",377],["T_WHITESPACE"," ",377],"(",["T_STRING","null",377],["T_WHITESPACE"," ",377],["T_IS_IDENTICAL","===",377],["T_WHITESPACE"," ",377],["T_VARIABLE","$key",377],")",["T_WHITESPACE"," ",377],"{",["T_WHITESPACE","\n            ",377],["T_VARIABLE","$key",378],["T_WHITESPACE"," ",378],"=",["T_WHITESPACE"," ",378],["T_VARIABLE","$this",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","keys",378],"[",["T_VARIABLE","$this",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","keyVersion",378],"]",";",["T_WHITESPACE","\n        ",378],"}",["T_WHITESPACE","\n\n        ",379],["T_IF","if",381],["T_WHITESPACE"," ",381],"(","!",["T_VARIABLE","$key",381],")",["T_WHITESPACE"," ",381],"{",["T_WHITESPACE","\n            ",381],["T_RETURN","return",382],["T_WHITESPACE"," ",382],["T_STRING","null",382],";",["T_WHITESPACE","\n        ",382],"}",["T_WHITESPACE","\n\n        ",383],["T_IF","if",385],["T_WHITESPACE"," ",385],"(",["T_STRING","null",385],["T_WHITESPACE"," ",385],["T_IS_IDENTICAL","===",385],["T_WHITESPACE"," ",385],["T_VARIABLE","$cipherVersion",385],")",["T_WHITESPACE"," ",385],"{",["T_WHITESPACE","\n            ",385],["T_VARIABLE","$cipherVersion",386],["T_WHITESPACE"," ",386],"=",["T_WHITESPACE"," ",386],["T_VARIABLE","$this",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","cipher",386],";",["T_WHITESPACE","\n        ",386],"}",["T_WHITESPACE","\n        ",387],["T_VARIABLE","$cipherVersion",388],["T_WHITESPACE"," ",388],"=",["T_WHITESPACE"," ",388],["T_VARIABLE","$this",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","validateCipher",388],"(",["T_VARIABLE","$cipherVersion",388],")",";",["T_WHITESPACE","\n\n        ",388],["T_IF","if",390],["T_WHITESPACE"," ",390],"(",["T_VARIABLE","$cipherVersion",390],["T_WHITESPACE"," ",390],["T_IS_IDENTICAL","===",390],["T_WHITESPACE"," ",390],["T_STRING","self",390],["T_DOUBLE_COLON","::",390],["T_STRING","CIPHER_RIJNDAEL_128",390],")",["T_WHITESPACE"," ",390],"{",["T_WHITESPACE","\n            ",390],["T_VARIABLE","$cipher",391],["T_WHITESPACE"," ",391],"=",["T_WHITESPACE"," ",391],["T_STRING","MCRYPT_RIJNDAEL_128",391],";",["T_WHITESPACE","\n            ",391],["T_VARIABLE","$mode",392],["T_WHITESPACE"," ",392],"=",["T_WHITESPACE"," ",392],["T_STRING","MCRYPT_MODE_ECB",392],";",["T_WHITESPACE","\n        ",392],"}",["T_WHITESPACE"," ",393],["T_ELSEIF","elseif",393],["T_WHITESPACE"," ",393],"(",["T_VARIABLE","$cipherVersion",393],["T_WHITESPACE"," ",393],["T_IS_IDENTICAL","===",393],["T_WHITESPACE"," ",393],["T_STRING","self",393],["T_DOUBLE_COLON","::",393],["T_STRING","CIPHER_RIJNDAEL_256",393],")",["T_WHITESPACE"," ",393],"{",["T_WHITESPACE","\n            ",393],["T_VARIABLE","$cipher",394],["T_WHITESPACE"," ",394],"=",["T_WHITESPACE"," ",394],["T_STRING","MCRYPT_RIJNDAEL_256",394],";",["T_WHITESPACE","\n            ",394],["T_VARIABLE","$mode",395],["T_WHITESPACE"," ",395],"=",["T_WHITESPACE"," ",395],["T_STRING","MCRYPT_MODE_CBC",395],";",["T_WHITESPACE","\n        ",395],"}",["T_WHITESPACE"," ",396],["T_ELSE","else",396],["T_WHITESPACE"," ",396],"{",["T_WHITESPACE","\n            ",396],["T_VARIABLE","$cipher",397],["T_WHITESPACE"," ",397],"=",["T_WHITESPACE"," ",397],["T_STRING","MCRYPT_BLOWFISH",397],";",["T_WHITESPACE","\n            ",397],["T_VARIABLE","$mode",398],["T_WHITESPACE"," ",398],"=",["T_WHITESPACE"," ",398],["T_STRING","MCRYPT_MODE_ECB",398],";",["T_WHITESPACE","\n        ",398],"}",["T_WHITESPACE","\n\n        ",399],["T_RETURN","return",401],["T_WHITESPACE"," ",401],["T_NEW","new",401],["T_WHITESPACE"," ",401],["T_STRING","Crypt",401],"(",["T_VARIABLE","$key",401],",",["T_WHITESPACE"," ",401],["T_VARIABLE","$cipher",401],",",["T_WHITESPACE"," ",401],["T_VARIABLE","$mode",401],",",["T_WHITESPACE"," ",401],["T_VARIABLE","$initVector",401],")",";",["T_WHITESPACE","\n    ",401],"}",["T_WHITESPACE","\n",402],"}",["T_WHITESPACE","\n",403]]