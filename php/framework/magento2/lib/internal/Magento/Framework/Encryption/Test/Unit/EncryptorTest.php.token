[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Framework",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Encryption",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Test",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Unit",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Encryption",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Encryptor",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Encryption",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Crypt",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","App",10],["T_NS_SEPARATOR","\\",10],["T_STRING","DeploymentConfig",10],";",["T_WHITESPACE","\n\n",10],["T_CLASS","class",12],["T_WHITESPACE"," ",12],["T_STRING","EncryptorTest",12],["T_WHITESPACE"," ",12],["T_EXTENDS","extends",12],["T_WHITESPACE"," ",12],["T_NS_SEPARATOR","\\",12],["T_STRING","PHPUnit_Framework_TestCase",12],["T_WHITESPACE","\n",12],"{",["T_WHITESPACE","\n    ",13],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Encryption\\Encryptor\n     *\/",14],["T_WHITESPACE","\n    ",16],["T_PROTECTED","protected",17],["T_WHITESPACE"," ",17],["T_VARIABLE","$_model",17],";",["T_WHITESPACE","\n\n    ",17],["T_DOC_COMMENT","\/**\n     * @var \\PHPUnit_Framework_MockObject_MockObject\n     *\/",19],["T_WHITESPACE","\n    ",21],["T_PROTECTED","protected",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$_randomGenerator",22],";",["T_WHITESPACE","\n\n    ",22],["T_PROTECTED","protected",24],["T_WHITESPACE"," ",24],["T_FUNCTION","function",24],["T_WHITESPACE"," ",24],["T_STRING","setUp",24],"(",")",["T_WHITESPACE","\n    ",24],"{",["T_WHITESPACE","\n        ",25],["T_VARIABLE","$this",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","_randomGenerator",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_VARIABLE","$this",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","getMock",26],"(",["T_NS_SEPARATOR","\\",26],["T_STRING","Magento",26],["T_NS_SEPARATOR","\\",26],["T_STRING","Framework",26],["T_NS_SEPARATOR","\\",26],["T_STRING","Math",26],["T_NS_SEPARATOR","\\",26],["T_STRING","Random",26],["T_DOUBLE_COLON","::",26],["T_CLASS","class",26],",",["T_WHITESPACE"," ",26],"[","]",",",["T_WHITESPACE"," ",26],"[","]",",",["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","''",26],",",["T_WHITESPACE"," ",26],["T_STRING","false",26],")",";",["T_WHITESPACE","\n        ",26],["T_VARIABLE","$deploymentConfigMock",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],["T_VARIABLE","$this",27],["T_OBJECT_OPERATOR","->",27],["T_STRING","getMock",27],"(",["T_NS_SEPARATOR","\\",27],["T_STRING","Magento",27],["T_NS_SEPARATOR","\\",27],["T_STRING","Framework",27],["T_NS_SEPARATOR","\\",27],["T_STRING","App",27],["T_NS_SEPARATOR","\\",27],["T_STRING","DeploymentConfig",27],["T_DOUBLE_COLON","::",27],["T_CLASS","class",27],",",["T_WHITESPACE"," ",27],"[","]",",",["T_WHITESPACE"," ",27],"[","]",",",["T_WHITESPACE"," ",27],["T_CONSTANT_ENCAPSED_STRING","''",27],",",["T_WHITESPACE"," ",27],["T_STRING","false",27],")",";",["T_WHITESPACE","\n        ",27],["T_VARIABLE","$deploymentConfigMock",28],["T_OBJECT_OPERATOR","->",28],["T_STRING","expects",28],"(",["T_VARIABLE","$this",28],["T_OBJECT_OPERATOR","->",28],["T_STRING","any",28],"(",")",")",["T_WHITESPACE","\n            ",28],["T_OBJECT_OPERATOR","->",29],["T_STRING","method",29],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",29],")",["T_WHITESPACE","\n            ",29],["T_OBJECT_OPERATOR","->",30],["T_STRING","with",30],"(",["T_STRING","Encryptor",30],["T_DOUBLE_COLON","::",30],["T_STRING","PARAM_CRYPT_KEY",30],")",["T_WHITESPACE","\n            ",30],["T_OBJECT_OPERATOR","->",31],["T_STRING","will",31],"(",["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","returnValue",31],"(",["T_CONSTANT_ENCAPSED_STRING","'cryptKey'",31],")",")",";",["T_WHITESPACE","\n        ",31],["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","_model",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_NEW","new",32],["T_WHITESPACE"," ",32],["T_NS_SEPARATOR","\\",32],["T_STRING","Magento",32],["T_NS_SEPARATOR","\\",32],["T_STRING","Framework",32],["T_NS_SEPARATOR","\\",32],["T_STRING","Encryption",32],["T_NS_SEPARATOR","\\",32],["T_STRING","Encryptor",32],"(",["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","_randomGenerator",32],",",["T_WHITESPACE"," ",32],["T_VARIABLE","$deploymentConfigMock",32],")",";",["T_WHITESPACE","\n    ",32],"}",["T_WHITESPACE","\n\n    ",33],["T_PUBLIC","public",35],["T_WHITESPACE"," ",35],["T_FUNCTION","function",35],["T_WHITESPACE"," ",35],["T_STRING","testGetHashNoSalt",35],"(",")",["T_WHITESPACE","\n    ",35],"{",["T_WHITESPACE","\n        ",36],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","_randomGenerator",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","expects",37],"(",["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","never",37],"(",")",")",["T_OBJECT_OPERATOR","->",37],["T_STRING","method",37],"(",["T_CONSTANT_ENCAPSED_STRING","'getRandomString'",37],")",";",["T_WHITESPACE","\n        ",37],["T_VARIABLE","$expected",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_CONSTANT_ENCAPSED_STRING","'5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8'",38],";",["T_WHITESPACE","\n        ",38],["T_VARIABLE","$actual",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","_model",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","getHash",39],"(",["T_CONSTANT_ENCAPSED_STRING","'password'",39],")",";",["T_WHITESPACE","\n        ",39],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","assertEquals",40],"(",["T_VARIABLE","$expected",40],",",["T_WHITESPACE"," ",40],["T_VARIABLE","$actual",40],")",";",["T_WHITESPACE","\n    ",40],"}",["T_WHITESPACE","\n\n    ",41],["T_PUBLIC","public",43],["T_WHITESPACE"," ",43],["T_FUNCTION","function",43],["T_WHITESPACE"," ",43],["T_STRING","testGetHashSpecifiedSalt",43],"(",")",["T_WHITESPACE","\n    ",43],"{",["T_WHITESPACE","\n        ",44],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","_randomGenerator",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","expects",45],"(",["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","never",45],"(",")",")",["T_OBJECT_OPERATOR","->",45],["T_STRING","method",45],"(",["T_CONSTANT_ENCAPSED_STRING","'getRandomString'",45],")",";",["T_WHITESPACE","\n        ",45],["T_VARIABLE","$expected",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'13601bda4ea78e55a07b98866d2be6be0744e3866f13c00c811cab608a28f322:salt:1'",46],";",["T_WHITESPACE","\n        ",46],["T_VARIABLE","$actual",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","_model",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","getHash",47],"(",["T_CONSTANT_ENCAPSED_STRING","'password'",47],",",["T_WHITESPACE"," ",47],["T_CONSTANT_ENCAPSED_STRING","'salt'",47],")",";",["T_WHITESPACE","\n        ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","assertEquals",48],"(",["T_VARIABLE","$expected",48],",",["T_WHITESPACE"," ",48],["T_VARIABLE","$actual",48],")",";",["T_WHITESPACE","\n    ",48],"}",["T_WHITESPACE","\n\n    ",49],["T_PUBLIC","public",51],["T_WHITESPACE"," ",51],["T_FUNCTION","function",51],["T_WHITESPACE"," ",51],["T_STRING","testGetHashRandomSaltDefaultLength",51],"(",")",["T_WHITESPACE","\n    ",51],"{",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$salt",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_CONSTANT_ENCAPSED_STRING","'-----------random_salt----------'",53],";",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","_randomGenerator",54],["T_WHITESPACE","\n            ",54],["T_OBJECT_OPERATOR","->",55],["T_STRING","expects",55],"(",["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","once",55],"(",")",")",["T_WHITESPACE","\n            ",55],["T_OBJECT_OPERATOR","->",56],["T_STRING","method",56],"(",["T_CONSTANT_ENCAPSED_STRING","'getRandomString'",56],")",["T_WHITESPACE","\n            ",56],["T_OBJECT_OPERATOR","->",57],["T_STRING","with",57],"(",["T_LNUMBER","32",57],")",["T_WHITESPACE","\n            ",57],["T_OBJECT_OPERATOR","->",58],["T_STRING","will",58],"(",["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","returnValue",58],"(",["T_VARIABLE","$salt",58],")",")",";",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$expected",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'a1c7fc88037b70c9be84d3ad12522c7888f647915db78f42eb572008422ba2fa:'",59],["T_WHITESPACE"," ",59],".",["T_WHITESPACE"," ",59],["T_VARIABLE","$salt",59],["T_WHITESPACE"," ",59],".",["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","':1'",59],";",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$actual",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","_model",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","getHash",60],"(",["T_CONSTANT_ENCAPSED_STRING","'password'",60],",",["T_WHITESPACE"," ",60],["T_STRING","true",60],")",";",["T_WHITESPACE","\n        ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","assertEquals",61],"(",["T_VARIABLE","$expected",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$actual",61],")",";",["T_WHITESPACE","\n    ",61],"}",["T_WHITESPACE","\n\n    ",62],["T_PUBLIC","public",64],["T_WHITESPACE"," ",64],["T_FUNCTION","function",64],["T_WHITESPACE"," ",64],["T_STRING","testGetHashRandomSaltSpecifiedLength",64],"(",")",["T_WHITESPACE","\n    ",64],"{",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","_randomGenerator",66],["T_WHITESPACE","\n            ",66],["T_OBJECT_OPERATOR","->",67],["T_STRING","expects",67],"(",["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","once",67],"(",")",")",["T_WHITESPACE","\n            ",67],["T_OBJECT_OPERATOR","->",68],["T_STRING","method",68],"(",["T_CONSTANT_ENCAPSED_STRING","'getRandomString'",68],")",["T_WHITESPACE","\n            ",68],["T_OBJECT_OPERATOR","->",69],["T_STRING","with",69],"(",["T_LNUMBER","11",69],")",["T_WHITESPACE","\n            ",69],["T_OBJECT_OPERATOR","->",70],["T_STRING","will",70],"(",["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","returnValue",70],"(",["T_CONSTANT_ENCAPSED_STRING","'random_salt'",70],")",")",";",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$expected",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'4c5cab8dd00137d11258f8f87b93fd17bd94c5026fc52d3c5af911dd177a2611:random_salt:1'",71],";",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$actual",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","_model",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","getHash",72],"(",["T_CONSTANT_ENCAPSED_STRING","'password'",72],",",["T_WHITESPACE"," ",72],["T_LNUMBER","11",72],")",";",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","assertEquals",73],"(",["T_VARIABLE","$expected",73],",",["T_WHITESPACE"," ",73],["T_VARIABLE","$actual",73],")",";",["T_WHITESPACE","\n    ",73],"}",["T_WHITESPACE","\n\n    ",74],["T_DOC_COMMENT","\/**\n     * @param string $password\n     * @param string $hash\n     * @param bool $expected\n     *\n     * @dataProvider validateHashDataProvider\n     *\/",76],["T_WHITESPACE","\n    ",82],["T_PUBLIC","public",83],["T_WHITESPACE"," ",83],["T_FUNCTION","function",83],["T_WHITESPACE"," ",83],["T_STRING","testValidateHash",83],"(",["T_VARIABLE","$password",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$hash",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$expected",83],")",["T_WHITESPACE","\n    ",83],"{",["T_WHITESPACE","\n        ",84],["T_VARIABLE","$actual",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","_model",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","validateHash",85],"(",["T_VARIABLE","$password",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$hash",85],")",";",["T_WHITESPACE","\n        ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","assertEquals",86],"(",["T_VARIABLE","$expected",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$actual",86],")",";",["T_WHITESPACE","\n    ",86],"}",["T_WHITESPACE","\n\n    ",87],["T_PUBLIC","public",89],["T_WHITESPACE"," ",89],["T_FUNCTION","function",89],["T_WHITESPACE"," ",89],["T_STRING","validateHashDataProvider",89],"(",")",["T_WHITESPACE","\n    ",89],"{",["T_WHITESPACE","\n        ",90],["T_RETURN","return",91],["T_WHITESPACE"," ",91],"[",["T_WHITESPACE","\n            ",91],"[",["T_CONSTANT_ENCAPSED_STRING","'password'",92],",",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'hash:salt:1'",92],",",["T_WHITESPACE"," ",92],["T_STRING","false",92],"]",",",["T_WHITESPACE","\n            ",92],"[",["T_CONSTANT_ENCAPSED_STRING","'password'",93],",",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","'67a1e09bb1f83f5007dc119c14d663aa:salt:0'",93],",",["T_WHITESPACE"," ",93],["T_STRING","true",93],"]",",",["T_WHITESPACE","\n            ",93],"[",["T_CONSTANT_ENCAPSED_STRING","'password'",94],",",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'13601bda4ea78e55a07b98866d2be6be0744e3866f13c00c811cab608a28f322:salt:1'",94],",",["T_WHITESPACE"," ",94],["T_STRING","true",94],"]",",",["T_WHITESPACE","\n        ",94],"]",";",["T_WHITESPACE","\n    ",95],"}",["T_WHITESPACE","\n\n    ",96],["T_DOC_COMMENT","\/**\n     * @param mixed $key\n     *\n     * @dataProvider encryptWithEmptyKeyDataProvider\n     *\/",98],["T_WHITESPACE","\n    ",102],["T_PUBLIC","public",103],["T_WHITESPACE"," ",103],["T_FUNCTION","function",103],["T_WHITESPACE"," ",103],["T_STRING","testEncryptWithEmptyKey",103],"(",["T_VARIABLE","$key",103],")",["T_WHITESPACE","\n    ",103],"{",["T_WHITESPACE","\n        ",104],["T_VARIABLE","$deploymentConfigMock",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getMock",105],"(",["T_NS_SEPARATOR","\\",105],["T_STRING","Magento",105],["T_NS_SEPARATOR","\\",105],["T_STRING","Framework",105],["T_NS_SEPARATOR","\\",105],["T_STRING","App",105],["T_NS_SEPARATOR","\\",105],["T_STRING","DeploymentConfig",105],["T_DOUBLE_COLON","::",105],["T_CLASS","class",105],",",["T_WHITESPACE"," ",105],"[","]",",",["T_WHITESPACE"," ",105],"[","]",",",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","''",105],",",["T_WHITESPACE"," ",105],["T_STRING","false",105],")",";",["T_WHITESPACE","\n        ",105],["T_VARIABLE","$deploymentConfigMock",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","expects",106],"(",["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","any",106],"(",")",")",["T_WHITESPACE","\n            ",106],["T_OBJECT_OPERATOR","->",107],["T_STRING","method",107],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",107],")",["T_WHITESPACE","\n            ",107],["T_OBJECT_OPERATOR","->",108],["T_STRING","with",108],"(",["T_STRING","Encryptor",108],["T_DOUBLE_COLON","::",108],["T_STRING","PARAM_CRYPT_KEY",108],")",["T_WHITESPACE","\n            ",108],["T_OBJECT_OPERATOR","->",109],["T_STRING","will",109],"(",["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","returnValue",109],"(",["T_VARIABLE","$key",109],")",")",";",["T_WHITESPACE","\n        ",109],["T_VARIABLE","$model",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_NEW","new",110],["T_WHITESPACE"," ",110],["T_STRING","Encryptor",110],"(",["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","_randomGenerator",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$deploymentConfigMock",110],")",";",["T_WHITESPACE","\n        ",110],["T_VARIABLE","$value",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_CONSTANT_ENCAPSED_STRING","'arbitrary_string'",111],";",["T_WHITESPACE","\n        ",111],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","assertEquals",112],"(",["T_VARIABLE","$value",112],",",["T_WHITESPACE"," ",112],["T_VARIABLE","$model",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","encrypt",112],"(",["T_VARIABLE","$value",112],")",")",";",["T_WHITESPACE","\n    ",112],"}",["T_WHITESPACE","\n\n    ",113],["T_PUBLIC","public",115],["T_WHITESPACE"," ",115],["T_FUNCTION","function",115],["T_WHITESPACE"," ",115],["T_STRING","encryptWithEmptyKeyDataProvider",115],"(",")",["T_WHITESPACE","\n    ",115],"{",["T_WHITESPACE","\n        ",116],["T_RETURN","return",117],["T_WHITESPACE"," ",117],"[","[",["T_STRING","null",117],"]",",",["T_WHITESPACE"," ",117],"[",["T_LNUMBER","0",117],"]",",",["T_WHITESPACE"," ",117],"[",["T_CONSTANT_ENCAPSED_STRING","''",117],"]",",",["T_WHITESPACE"," ",117],"[",["T_CONSTANT_ENCAPSED_STRING","'0'",117],"]","]",";",["T_WHITESPACE","\n    ",117],"}",["T_WHITESPACE","\n\n    ",118],["T_DOC_COMMENT","\/**\n     * @param mixed $key\n     *\n     * @dataProvider decryptWithEmptyKeyDataProvider\n     *\/",120],["T_WHITESPACE","\n    ",124],["T_PUBLIC","public",125],["T_WHITESPACE"," ",125],["T_FUNCTION","function",125],["T_WHITESPACE"," ",125],["T_STRING","testDecryptWithEmptyKey",125],"(",["T_VARIABLE","$key",125],")",["T_WHITESPACE","\n    ",125],"{",["T_WHITESPACE","\n        ",126],["T_VARIABLE","$deploymentConfigMock",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","getMock",127],"(",["T_NS_SEPARATOR","\\",127],["T_STRING","Magento",127],["T_NS_SEPARATOR","\\",127],["T_STRING","Framework",127],["T_NS_SEPARATOR","\\",127],["T_STRING","App",127],["T_NS_SEPARATOR","\\",127],["T_STRING","DeploymentConfig",127],["T_DOUBLE_COLON","::",127],["T_CLASS","class",127],",",["T_WHITESPACE"," ",127],"[","]",",",["T_WHITESPACE"," ",127],"[","]",",",["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","''",127],",",["T_WHITESPACE"," ",127],["T_STRING","false",127],")",";",["T_WHITESPACE","\n        ",127],["T_VARIABLE","$deploymentConfigMock",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","expects",128],"(",["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","any",128],"(",")",")",["T_WHITESPACE","\n            ",128],["T_OBJECT_OPERATOR","->",129],["T_STRING","method",129],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",129],")",["T_WHITESPACE","\n            ",129],["T_OBJECT_OPERATOR","->",130],["T_STRING","with",130],"(",["T_STRING","Encryptor",130],["T_DOUBLE_COLON","::",130],["T_STRING","PARAM_CRYPT_KEY",130],")",["T_WHITESPACE","\n            ",130],["T_OBJECT_OPERATOR","->",131],["T_STRING","will",131],"(",["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","returnValue",131],"(",["T_VARIABLE","$key",131],")",")",";",["T_WHITESPACE","\n        ",131],["T_VARIABLE","$model",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_NEW","new",132],["T_WHITESPACE"," ",132],["T_STRING","Encryptor",132],"(",["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","_randomGenerator",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$deploymentConfigMock",132],")",";",["T_WHITESPACE","\n        ",132],["T_VARIABLE","$value",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","'arbitrary_string'",133],";",["T_WHITESPACE","\n        ",133],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","assertEquals",134],"(",["T_CONSTANT_ENCAPSED_STRING","''",134],",",["T_WHITESPACE"," ",134],["T_VARIABLE","$model",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","decrypt",134],"(",["T_VARIABLE","$value",134],")",")",";",["T_WHITESPACE","\n    ",134],"}",["T_WHITESPACE","\n\n    ",135],["T_PUBLIC","public",137],["T_WHITESPACE"," ",137],["T_FUNCTION","function",137],["T_WHITESPACE"," ",137],["T_STRING","decryptWithEmptyKeyDataProvider",137],"(",")",["T_WHITESPACE","\n    ",137],"{",["T_WHITESPACE","\n        ",138],["T_RETURN","return",139],["T_WHITESPACE"," ",139],"[","[",["T_STRING","null",139],"]",",",["T_WHITESPACE"," ",139],"[",["T_LNUMBER","0",139],"]",",",["T_WHITESPACE"," ",139],"[",["T_CONSTANT_ENCAPSED_STRING","''",139],"]",",",["T_WHITESPACE"," ",139],"[",["T_CONSTANT_ENCAPSED_STRING","'0'",139],"]","]",";",["T_WHITESPACE","\n    ",139],"}",["T_WHITESPACE","\n\n    ",140],["T_PUBLIC","public",142],["T_WHITESPACE"," ",142],["T_FUNCTION","function",142],["T_WHITESPACE"," ",142],["T_STRING","testEncrypt",142],"(",")",["T_WHITESPACE","\n    ",142],"{",["T_WHITESPACE","\n        ",143],["T_COMMENT","\/\/ sample data to encrypt\n",144],["T_WHITESPACE","        ",145],["T_VARIABLE","$data",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","'Mares eat oats and does eat oats, but little lambs eat ivy.'",145],";",["T_WHITESPACE","\n\n        ",145],["T_VARIABLE","$actual",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","_model",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","encrypt",147],"(",["T_VARIABLE","$data",147],")",";",["T_WHITESPACE","\n\n        ",147],["T_COMMENT","\/\/ Extract the initialization vector and encrypted data\n",149],["T_WHITESPACE","        ",150],["T_VARIABLE","$parts",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_STRING","explode",150],"(",["T_CONSTANT_ENCAPSED_STRING","':'",150],",",["T_WHITESPACE"," ",150],["T_VARIABLE","$actual",150],",",["T_WHITESPACE"," ",150],["T_LNUMBER","4",150],")",";",["T_WHITESPACE","\n        ",150],["T_LIST","list",151],"(",",",["T_WHITESPACE"," ",151],",",["T_WHITESPACE"," ",151],["T_VARIABLE","$iv",151],",",["T_WHITESPACE"," ",151],["T_VARIABLE","$encryptedData",151],")",["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_VARIABLE","$parts",151],";",["T_WHITESPACE","\n\n        ",151],["T_COMMENT","\/\/ Decrypt returned data with RIJNDAEL_256 cipher, cbc mode\n",153],["T_WHITESPACE","        ",154],["T_VARIABLE","$crypt",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_NEW","new",154],["T_WHITESPACE"," ",154],["T_STRING","Crypt",154],"(",["T_CONSTANT_ENCAPSED_STRING","'cryptKey'",154],",",["T_WHITESPACE"," ",154],["T_STRING","MCRYPT_RIJNDAEL_256",154],",",["T_WHITESPACE"," ",154],["T_STRING","MCRYPT_MODE_CBC",154],",",["T_WHITESPACE"," ",154],["T_VARIABLE","$iv",154],")",";",["T_WHITESPACE","\n        ",154],["T_COMMENT","\/\/ Verify decrypted matches original data\n",155],["T_WHITESPACE","        ",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","assertEquals",156],"(",["T_VARIABLE","$data",156],",",["T_WHITESPACE"," ",156],["T_VARIABLE","$crypt",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","decrypt",156],"(",["T_STRING","base64_decode",156],"(",["T_STRING_CAST","(string)",156],["T_VARIABLE","$encryptedData",156],")",")",")",";",["T_WHITESPACE","\n    ",156],"}",["T_WHITESPACE","\n\n    ",157],["T_PUBLIC","public",159],["T_WHITESPACE"," ",159],["T_FUNCTION","function",159],["T_WHITESPACE"," ",159],["T_STRING","testDecrypt",159],"(",")",["T_WHITESPACE","\n    ",159],"{",["T_WHITESPACE","\n        ",160],["T_COMMENT","\/\/ sample data to encrypt\n",161],["T_WHITESPACE","        ",162],["T_VARIABLE","$data",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_CONSTANT_ENCAPSED_STRING","'0:2:z3a4ACpkU35W6pV692U4ueCVQP0m0v0p:'",162],["T_WHITESPACE"," ",162],".",["T_WHITESPACE","\n            ",162],["T_CONSTANT_ENCAPSED_STRING","'7ZPIIRZzQrgQH+csfF3fyxYNwbzPTwegncnoTxvI3OZyqKGYlOCTSx5i1KRqNemCC8kuCiOAttLpAymXhzjhNQ=='",163],";",["T_WHITESPACE","\n\n        ",163],["T_VARIABLE","$actual",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","_model",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","decrypt",165],"(",["T_VARIABLE","$data",165],")",";",["T_WHITESPACE","\n\n        ",165],["T_COMMENT","\/\/ Extract the initialization vector and encrypted data\n",167],["T_WHITESPACE","        ",168],["T_VARIABLE","$parts",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_STRING","explode",168],"(",["T_CONSTANT_ENCAPSED_STRING","':'",168],",",["T_WHITESPACE"," ",168],["T_VARIABLE","$data",168],",",["T_WHITESPACE"," ",168],["T_LNUMBER","4",168],")",";",["T_WHITESPACE","\n        ",168],["T_LIST","list",169],"(",",",["T_WHITESPACE"," ",169],",",["T_WHITESPACE"," ",169],["T_VARIABLE","$iv",169],",",["T_WHITESPACE"," ",169],["T_VARIABLE","$encrypted",169],")",["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_VARIABLE","$parts",169],";",["T_WHITESPACE","\n\n        ",169],["T_COMMENT","\/\/ Decrypt returned data with RIJNDAEL_256 cipher, cbc mode\n",171],["T_WHITESPACE","        ",172],["T_VARIABLE","$crypt",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_NEW","new",172],["T_WHITESPACE"," ",172],["T_STRING","Crypt",172],"(",["T_CONSTANT_ENCAPSED_STRING","'cryptKey'",172],",",["T_WHITESPACE"," ",172],["T_STRING","MCRYPT_RIJNDAEL_256",172],",",["T_WHITESPACE"," ",172],["T_STRING","MCRYPT_MODE_CBC",172],",",["T_WHITESPACE"," ",172],["T_VARIABLE","$iv",172],")",";",["T_WHITESPACE","\n        ",172],["T_COMMENT","\/\/ Verify decrypted matches original data\n",173],["T_WHITESPACE","        ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","assertEquals",174],"(",["T_VARIABLE","$encrypted",174],",",["T_WHITESPACE"," ",174],["T_STRING","base64_encode",174],"(",["T_VARIABLE","$crypt",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","encrypt",174],"(",["T_VARIABLE","$actual",174],")",")",")",";",["T_WHITESPACE","\n    ",174],"}",["T_WHITESPACE","\n\n    ",175],["T_PUBLIC","public",177],["T_WHITESPACE"," ",177],["T_FUNCTION","function",177],["T_WHITESPACE"," ",177],["T_STRING","testEncryptDecryptNewKeyAdded",177],"(",")",["T_WHITESPACE","\n    ",177],"{",["T_WHITESPACE","\n        ",178],["T_VARIABLE","$deploymentConfigMock",179],["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","getMock",179],"(",["T_NS_SEPARATOR","\\",179],["T_STRING","Magento",179],["T_NS_SEPARATOR","\\",179],["T_STRING","Framework",179],["T_NS_SEPARATOR","\\",179],["T_STRING","App",179],["T_NS_SEPARATOR","\\",179],["T_STRING","DeploymentConfig",179],["T_DOUBLE_COLON","::",179],["T_CLASS","class",179],",",["T_WHITESPACE"," ",179],"[","]",",",["T_WHITESPACE"," ",179],"[","]",",",["T_WHITESPACE"," ",179],["T_CONSTANT_ENCAPSED_STRING","''",179],",",["T_WHITESPACE"," ",179],["T_STRING","false",179],")",";",["T_WHITESPACE","\n        ",179],["T_VARIABLE","$deploymentConfigMock",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","expects",180],"(",["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","at",180],"(",["T_LNUMBER","0",180],")",")",["T_WHITESPACE","\n            ",180],["T_OBJECT_OPERATOR","->",181],["T_STRING","method",181],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",181],")",["T_WHITESPACE","\n            ",181],["T_OBJECT_OPERATOR","->",182],["T_STRING","with",182],"(",["T_STRING","Encryptor",182],["T_DOUBLE_COLON","::",182],["T_STRING","PARAM_CRYPT_KEY",182],")",["T_WHITESPACE","\n            ",182],["T_OBJECT_OPERATOR","->",183],["T_STRING","will",183],"(",["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","returnValue",183],"(",["T_CONSTANT_ENCAPSED_STRING","\"cryptKey1\"",183],")",")",";",["T_WHITESPACE","\n        ",183],["T_VARIABLE","$deploymentConfigMock",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","expects",184],"(",["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","at",184],"(",["T_LNUMBER","1",184],")",")",["T_WHITESPACE","\n            ",184],["T_OBJECT_OPERATOR","->",185],["T_STRING","method",185],"(",["T_CONSTANT_ENCAPSED_STRING","'get'",185],")",["T_WHITESPACE","\n            ",185],["T_OBJECT_OPERATOR","->",186],["T_STRING","with",186],"(",["T_STRING","Encryptor",186],["T_DOUBLE_COLON","::",186],["T_STRING","PARAM_CRYPT_KEY",186],")",["T_WHITESPACE","\n            ",186],["T_OBJECT_OPERATOR","->",187],["T_STRING","will",187],"(",["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","returnValue",187],"(",["T_CONSTANT_ENCAPSED_STRING","\"cryptKey1\\ncryptKey2\"",187],")",")",";",["T_WHITESPACE","\n        ",187],["T_VARIABLE","$model1",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_NEW","new",188],["T_WHITESPACE"," ",188],["T_STRING","Encryptor",188],"(",["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","_randomGenerator",188],",",["T_WHITESPACE"," ",188],["T_VARIABLE","$deploymentConfigMock",188],")",";",["T_WHITESPACE","\n        ",188],["T_COMMENT","\/\/ simulate an encryption key is being added\n",189],["T_WHITESPACE","        ",190],["T_VARIABLE","$model2",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_NEW","new",190],["T_WHITESPACE"," ",190],["T_STRING","Encryptor",190],"(",["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","_randomGenerator",190],",",["T_WHITESPACE"," ",190],["T_VARIABLE","$deploymentConfigMock",190],")",";",["T_WHITESPACE","\n\n        ",190],["T_COMMENT","\/\/ sample data to encrypt\n",192],["T_WHITESPACE","        ",193],["T_VARIABLE","$data",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_CONSTANT_ENCAPSED_STRING","'Mares eat oats and does eat oats, but little lambs eat ivy.'",193],";",["T_WHITESPACE","\n        ",193],["T_COMMENT","\/\/ encrypt with old key\n",194],["T_WHITESPACE","        ",195],["T_VARIABLE","$encryptedData",195],["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_VARIABLE","$model1",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","encrypt",195],"(",["T_VARIABLE","$data",195],")",";",["T_WHITESPACE","\n        ",195],["T_VARIABLE","$decryptedData",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_VARIABLE","$model2",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","decrypt",196],"(",["T_VARIABLE","$encryptedData",196],")",";",["T_WHITESPACE","\n\n        ",196],["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","assertSame",198],"(",["T_VARIABLE","$data",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$decryptedData",198],",",["T_WHITESPACE"," ",198],["T_CONSTANT_ENCAPSED_STRING","'Encryptor failed to decrypt data encrypted by old keys.'",198],")",";",["T_WHITESPACE","\n    ",198],"}",["T_WHITESPACE","\n\n    ",199],["T_PUBLIC","public",201],["T_WHITESPACE"," ",201],["T_FUNCTION","function",201],["T_WHITESPACE"," ",201],["T_STRING","testValidateKey",201],"(",")",["T_WHITESPACE","\n    ",201],"{",["T_WHITESPACE","\n        ",202],["T_VARIABLE","$actual",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","_model",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","validateKey",203],"(",["T_CONSTANT_ENCAPSED_STRING","'some_key'",203],")",";",["T_WHITESPACE","\n        ",203],["T_VARIABLE","$crypt",204],["T_WHITESPACE"," ",204],"=",["T_WHITESPACE"," ",204],["T_NEW","new",204],["T_WHITESPACE"," ",204],["T_STRING","Crypt",204],"(",["T_CONSTANT_ENCAPSED_STRING","'some_key'",204],",",["T_WHITESPACE"," ",204],["T_STRING","MCRYPT_RIJNDAEL_256",204],",",["T_WHITESPACE"," ",204],["T_STRING","MCRYPT_MODE_CBC",204],",",["T_WHITESPACE"," ",204],["T_VARIABLE","$actual",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","getInitVector",204],"(",")",")",";",["T_WHITESPACE","\n        ",204],["T_VARIABLE","$expectedEncryptedData",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_STRING","base64_encode",205],"(",["T_VARIABLE","$crypt",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","encrypt",205],"(",["T_CONSTANT_ENCAPSED_STRING","'data'",205],")",")",";",["T_WHITESPACE","\n        ",205],["T_VARIABLE","$actualEncryptedData",206],["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],["T_STRING","base64_encode",206],"(",["T_VARIABLE","$actual",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","encrypt",206],"(",["T_CONSTANT_ENCAPSED_STRING","'data'",206],")",")",";",["T_WHITESPACE","\n        ",206],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","assertEquals",207],"(",["T_VARIABLE","$expectedEncryptedData",207],",",["T_WHITESPACE"," ",207],["T_VARIABLE","$actualEncryptedData",207],")",";",["T_WHITESPACE","\n        ",207],["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","assertEquals",208],"(",["T_VARIABLE","$crypt",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","decrypt",208],"(",["T_VARIABLE","$expectedEncryptedData",208],")",",",["T_WHITESPACE"," ",208],["T_VARIABLE","$actual",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","decrypt",208],"(",["T_VARIABLE","$actualEncryptedData",208],")",")",";",["T_WHITESPACE","\n    ",208],"}",["T_WHITESPACE","\n",209],"}",["T_WHITESPACE","\n",210]]