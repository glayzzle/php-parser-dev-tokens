[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Test case for \\Magento\\Framework\\Encryption\\Crypt\n *\/",7],["T_WHITESPACE","\n",9],["T_NAMESPACE","namespace",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Encryption",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Test",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Unit",10],";",["T_WHITESPACE","\n\n",10],["T_CLASS","class",12],["T_WHITESPACE"," ",12],["T_STRING","CryptTest",12],["T_WHITESPACE"," ",12],["T_EXTENDS","extends",12],["T_WHITESPACE"," ",12],["T_NS_SEPARATOR","\\",12],["T_STRING","PHPUnit_Framework_TestCase",12],["T_WHITESPACE","\n",12],"{",["T_WHITESPACE","\n    ",13],["T_PRIVATE","private",14],["T_WHITESPACE"," ",14],["T_VARIABLE","$_key",14],";",["T_WHITESPACE","\n\n    ",14],["T_PRIVATE","private",16],["T_WHITESPACE"," ",16],["T_STATIC","static",16],["T_WHITESPACE"," ",16],["T_VARIABLE","$_cipherInfo",16],";",["T_WHITESPACE","\n\n    ",16],["T_PROTECTED","protected",18],["T_WHITESPACE"," ",18],["T_VARIABLE","$_supportedCiphers",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],"[",["T_STRING","MCRYPT_BLOWFISH",18],",",["T_WHITESPACE"," ",18],["T_STRING","MCRYPT_RIJNDAEL_128",18],",",["T_WHITESPACE"," ",18],["T_STRING","MCRYPT_RIJNDAEL_256",18],"]",";",["T_WHITESPACE","\n\n    ",18],["T_PROTECTED","protected",20],["T_WHITESPACE"," ",20],["T_VARIABLE","$_supportedModes",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],"[",["T_WHITESPACE","\n        ",20],["T_STRING","MCRYPT_MODE_ECB",21],",",["T_WHITESPACE","\n        ",21],["T_STRING","MCRYPT_MODE_CBC",22],",",["T_WHITESPACE","\n        ",22],["T_STRING","MCRYPT_MODE_CFB",23],",",["T_WHITESPACE","\n        ",23],["T_STRING","MCRYPT_MODE_OFB",24],",",["T_WHITESPACE","\n        ",24],["T_STRING","MCRYPT_MODE_NOFB",25],",",["T_WHITESPACE","\n    ",25],"]",";",["T_WHITESPACE","\n\n    ",26],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_FUNCTION","function",28],["T_WHITESPACE"," ",28],["T_STRING","setUp",28],"(",")",["T_WHITESPACE","\n    ",28],"{",["T_WHITESPACE","\n        ",29],["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","_key",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_STRING","substr",30],"(",["T_CLASS_C","__CLASS__",30],",",["T_WHITESPACE"," ",30],"-",["T_LNUMBER","32",30],",",["T_WHITESPACE"," ",30],["T_LNUMBER","32",30],")",";",["T_WHITESPACE","\n    ",30],"}",["T_WHITESPACE","\n\n    ",31],["T_PROTECTED","protected",33],["T_WHITESPACE"," ",33],["T_FUNCTION","function",33],["T_WHITESPACE"," ",33],["T_STRING","_getRandomString",33],"(",["T_VARIABLE","$length",33],")",["T_WHITESPACE","\n    ",33],"{",["T_WHITESPACE","\n        ",34],["T_VARIABLE","$result",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_CONSTANT_ENCAPSED_STRING","''",35],";",["T_WHITESPACE","\n        ",35],["T_DO","do",36],["T_WHITESPACE"," ",36],"{",["T_WHITESPACE","\n            ",36],["T_VARIABLE","$result",37],["T_WHITESPACE"," ",37],["T_CONCAT_EQUAL",".=",37],["T_WHITESPACE"," ",37],["T_STRING","sha1",37],"(",["T_STRING","microtime",37],"(",")",")",";",["T_WHITESPACE","\n        ",37],"}",["T_WHITESPACE"," ",38],["T_WHILE","while",38],["T_WHITESPACE"," ",38],"(",["T_STRING","strlen",38],"(",["T_VARIABLE","$result",38],")",["T_WHITESPACE"," ",38],"<",["T_WHITESPACE"," ",38],["T_VARIABLE","$length",38],")",";",["T_WHITESPACE","\n        ",38],["T_RETURN","return",39],["T_WHITESPACE"," ",39],["T_STRING","substr",39],"(",["T_VARIABLE","$result",39],",",["T_WHITESPACE"," ",39],"-",["T_VARIABLE","$length",39],")",";",["T_WHITESPACE","\n    ",39],"}",["T_WHITESPACE","\n\n    ",40],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","_requireCipherInfo",42],"(",")",["T_WHITESPACE","\n    ",42],"{",["T_WHITESPACE","\n        ",43],["T_VARIABLE","$filename",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_DIR","__DIR__",44],["T_WHITESPACE"," ",44],".",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'\/Crypt\/_files\/_cipher_info.php'",44],";",["T_WHITESPACE","\n        ",44],["T_COMMENT","\/* Generate allowed sizes for encryption key and init vector\n           $data = array();\n           foreach ($this->_supportedCiphers as $cipher) {\n           if (!array_key_exists($cipher, $data)) {\n           $data[$cipher] = array();\n           }\n           foreach ($this->_supportedModes as $mode) {\n           $cipherHandle = mcrypt_module_open($cipher, '', $mode, '');\n           $data[$cipher][$mode] = array(\n           'key_size' => mcrypt_enc_get_key_size($cipherHandle),\n           'iv_size'  => mcrypt_enc_get_iv_size($cipherHandle),\n           );\n           mcrypt_module_close($cipherHandle);\n           }\n           }\n           file_put_contents($filename, '<?php return ' . var_export($data, true) . \";\\n\", LOCK_EX);\n           *\/",45],["T_WHITESPACE","\n        ",61],["T_IF","if",62],["T_WHITESPACE"," ",62],"(","!",["T_STRING","self",62],["T_DOUBLE_COLON","::",62],["T_VARIABLE","$_cipherInfo",62],")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n            ",62],["T_STRING","self",63],["T_DOUBLE_COLON","::",63],["T_VARIABLE","$_cipherInfo",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_INCLUDE","include",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$filename",63],";",["T_WHITESPACE","\n        ",63],"}",["T_WHITESPACE","\n    ",64],"}",["T_WHITESPACE","\n\n    ",65],["T_PROTECTED","protected",67],["T_WHITESPACE"," ",67],["T_FUNCTION","function",67],["T_WHITESPACE"," ",67],["T_STRING","_getKeySize",67],"(",["T_VARIABLE","$cipherName",67],",",["T_WHITESPACE"," ",67],["T_VARIABLE","$modeName",67],")",["T_WHITESPACE","\n    ",67],"{",["T_WHITESPACE","\n        ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","_requireCipherInfo",69],"(",")",";",["T_WHITESPACE","\n        ",69],["T_RETURN","return",70],["T_WHITESPACE"," ",70],["T_STRING","self",70],["T_DOUBLE_COLON","::",70],["T_VARIABLE","$_cipherInfo",70],"[",["T_VARIABLE","$cipherName",70],"]","[",["T_VARIABLE","$modeName",70],"]","[",["T_CONSTANT_ENCAPSED_STRING","'key_size'",70],"]",";",["T_WHITESPACE","\n    ",70],"}",["T_WHITESPACE","\n\n    ",71],["T_PROTECTED","protected",73],["T_WHITESPACE"," ",73],["T_FUNCTION","function",73],["T_WHITESPACE"," ",73],["T_STRING","_getInitVectorSize",73],"(",["T_VARIABLE","$cipherName",73],",",["T_WHITESPACE"," ",73],["T_VARIABLE","$modeName",73],")",["T_WHITESPACE","\n    ",73],"{",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","_requireCipherInfo",75],"(",")",";",["T_WHITESPACE","\n        ",75],["T_RETURN","return",76],["T_WHITESPACE"," ",76],["T_STRING","self",76],["T_DOUBLE_COLON","::",76],["T_VARIABLE","$_cipherInfo",76],"[",["T_VARIABLE","$cipherName",76],"]","[",["T_VARIABLE","$modeName",76],"]","[",["T_CONSTANT_ENCAPSED_STRING","'iv_size'",76],"]",";",["T_WHITESPACE","\n    ",76],"}",["T_WHITESPACE","\n\n    ",77],["T_PUBLIC","public",79],["T_WHITESPACE"," ",79],["T_FUNCTION","function",79],["T_WHITESPACE"," ",79],["T_STRING","getCipherModeCombinations",79],"(",")",["T_WHITESPACE","\n    ",79],"{",["T_WHITESPACE","\n        ",80],["T_VARIABLE","$result",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],"[","]",";",["T_WHITESPACE","\n        ",81],["T_FOREACH","foreach",82],["T_WHITESPACE"," ",82],"(",["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","_supportedCiphers",82],["T_WHITESPACE"," ",82],["T_AS","as",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$cipher",82],")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n            ",82],["T_FOREACH","foreach",83],["T_WHITESPACE"," ",83],"(",["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","_supportedModes",83],["T_WHITESPACE"," ",83],["T_AS","as",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$mode",83],")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n                ",83],["T_VARIABLE","$result",84],"[","]",["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],"[",["T_VARIABLE","$cipher",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$mode",84],"]",";",["T_WHITESPACE","\n            ",84],"}",["T_WHITESPACE","\n        ",85],"}",["T_WHITESPACE","\n        ",86],["T_RETURN","return",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$result",87],";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n\n    ",88],["T_DOC_COMMENT","\/**\n     * @dataProvider getCipherModeCombinations\n     *\/",90],["T_WHITESPACE","\n    ",92],["T_PUBLIC","public",93],["T_WHITESPACE"," ",93],["T_FUNCTION","function",93],["T_WHITESPACE"," ",93],["T_STRING","testConstructor",93],"(",["T_VARIABLE","$cipher",93],",",["T_WHITESPACE"," ",93],["T_VARIABLE","$mode",93],")",["T_WHITESPACE","\n    ",93],"{",["T_WHITESPACE","\n        ",94],["T_COMMENT","\/* Generate random init vector *\/",95],["T_WHITESPACE","\n        ",95],["T_VARIABLE","$initVector",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","_getRandomString",96],"(",["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","_getInitVectorSize",96],"(",["T_VARIABLE","$cipher",96],",",["T_WHITESPACE"," ",96],["T_VARIABLE","$mode",96],")",")",";",["T_WHITESPACE","\n\n        ",96],["T_VARIABLE","$crypt",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_NEW","new",98],["T_WHITESPACE"," ",98],["T_NS_SEPARATOR","\\",98],["T_STRING","Magento",98],["T_NS_SEPARATOR","\\",98],["T_STRING","Framework",98],["T_NS_SEPARATOR","\\",98],["T_STRING","Encryption",98],["T_NS_SEPARATOR","\\",98],["T_STRING","Crypt",98],"(",["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","_key",98],",",["T_WHITESPACE"," ",98],["T_VARIABLE","$cipher",98],",",["T_WHITESPACE"," ",98],["T_VARIABLE","$mode",98],",",["T_WHITESPACE"," ",98],["T_VARIABLE","$initVector",98],")",";",["T_WHITESPACE","\n\n        ",98],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","assertEquals",100],"(",["T_VARIABLE","$cipher",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$crypt",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getCipher",100],"(",")",")",";",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","assertEquals",101],"(",["T_VARIABLE","$mode",101],",",["T_WHITESPACE"," ",101],["T_VARIABLE","$crypt",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getMode",101],"(",")",")",";",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","assertEquals",102],"(",["T_VARIABLE","$initVector",102],",",["T_WHITESPACE"," ",102],["T_VARIABLE","$crypt",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getInitVector",102],"(",")",")",";",["T_WHITESPACE","\n    ",102],"}",["T_WHITESPACE","\n\n    ",103],["T_PUBLIC","public",105],["T_WHITESPACE"," ",105],["T_FUNCTION","function",105],["T_WHITESPACE"," ",105],["T_STRING","getConstructorExceptionData",105],"(",")",["T_WHITESPACE","\n    ",105],"{",["T_WHITESPACE","\n        ",106],["T_VARIABLE","$result",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],"[","]",";",["T_WHITESPACE","\n        ",107],["T_FOREACH","foreach",108],["T_WHITESPACE"," ",108],"(",["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","_supportedCiphers",108],["T_WHITESPACE"," ",108],["T_AS","as",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$cipher",108],")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n            ",108],["T_FOREACH","foreach",109],["T_WHITESPACE"," ",109],"(",["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","_supportedModes",109],["T_WHITESPACE"," ",109],["T_AS","as",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$mode",109],")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n                ",109],["T_VARIABLE","$tooLongKey",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_STRING","str_repeat",110],"(",["T_CONSTANT_ENCAPSED_STRING","'-'",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","_getKeySize",110],"(",["T_VARIABLE","$cipher",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$mode",110],")",["T_WHITESPACE"," ",110],"+",["T_WHITESPACE"," ",110],["T_LNUMBER","1",110],")",";",["T_WHITESPACE","\n                ",110],["T_VARIABLE","$tooShortInitVector",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_STRING","str_repeat",111],"(",["T_CONSTANT_ENCAPSED_STRING","'-'",111],",",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","_getInitVectorSize",111],"(",["T_VARIABLE","$cipher",111],",",["T_WHITESPACE"," ",111],["T_VARIABLE","$mode",111],")",["T_WHITESPACE"," ",111],"-",["T_WHITESPACE"," ",111],["T_LNUMBER","1",111],")",";",["T_WHITESPACE","\n                ",111],["T_VARIABLE","$tooLongInitVector",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_STRING","str_repeat",112],"(",["T_CONSTANT_ENCAPSED_STRING","'-'",112],",",["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","_getInitVectorSize",112],"(",["T_VARIABLE","$cipher",112],",",["T_WHITESPACE"," ",112],["T_VARIABLE","$mode",112],")",["T_WHITESPACE"," ",112],"+",["T_WHITESPACE"," ",112],["T_LNUMBER","1",112],")",";",["T_WHITESPACE","\n                ",112],["T_VARIABLE","$result",113],"[","]",["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],"[",["T_VARIABLE","$tooLongKey",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$cipher",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$mode",113],",",["T_WHITESPACE"," ",113],["T_STRING","false",113],"]",";",["T_WHITESPACE","\n                ",113],["T_VARIABLE","$result",114],"[","]",["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],"[",["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","_key",114],",",["T_WHITESPACE"," ",114],["T_VARIABLE","$cipher",114],",",["T_WHITESPACE"," ",114],["T_VARIABLE","$mode",114],",",["T_WHITESPACE"," ",114],["T_VARIABLE","$tooShortInitVector",114],"]",";",["T_WHITESPACE","\n                ",114],["T_VARIABLE","$result",115],"[","]",["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],"[",["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","_key",115],",",["T_WHITESPACE"," ",115],["T_VARIABLE","$cipher",115],",",["T_WHITESPACE"," ",115],["T_VARIABLE","$mode",115],",",["T_WHITESPACE"," ",115],["T_VARIABLE","$tooLongInitVector",115],"]",";",["T_WHITESPACE","\n            ",115],"}",["T_WHITESPACE","\n        ",116],"}",["T_WHITESPACE","\n        ",117],["T_RETURN","return",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$result",118],";",["T_WHITESPACE","\n    ",118],"}",["T_WHITESPACE","\n\n    ",119],["T_DOC_COMMENT","\/**\n     * @dataProvider getConstructorExceptionData\n     * @expectedException \\Magento\\Framework\\Exception\\LocalizedException\n     *\/",121],["T_WHITESPACE","\n    ",124],["T_PUBLIC","public",125],["T_WHITESPACE"," ",125],["T_FUNCTION","function",125],["T_WHITESPACE"," ",125],["T_STRING","testConstructorException",125],"(",["T_VARIABLE","$key",125],",",["T_WHITESPACE"," ",125],["T_VARIABLE","$cipher",125],",",["T_WHITESPACE"," ",125],["T_VARIABLE","$mode",125],",",["T_WHITESPACE"," ",125],["T_VARIABLE","$initVector",125],")",["T_WHITESPACE","\n    ",125],"{",["T_WHITESPACE","\n        ",126],["T_NEW","new",127],["T_WHITESPACE"," ",127],["T_NS_SEPARATOR","\\",127],["T_STRING","Magento",127],["T_NS_SEPARATOR","\\",127],["T_STRING","Framework",127],["T_NS_SEPARATOR","\\",127],["T_STRING","Encryption",127],["T_NS_SEPARATOR","\\",127],["T_STRING","Crypt",127],"(",["T_VARIABLE","$key",127],",",["T_WHITESPACE"," ",127],["T_VARIABLE","$cipher",127],",",["T_WHITESPACE"," ",127],["T_VARIABLE","$mode",127],",",["T_WHITESPACE"," ",127],["T_VARIABLE","$initVector",127],")",";",["T_WHITESPACE","\n    ",127],"}",["T_WHITESPACE","\n\n    ",128],["T_PUBLIC","public",130],["T_WHITESPACE"," ",130],["T_FUNCTION","function",130],["T_WHITESPACE"," ",130],["T_STRING","testConstructorDefaults",130],"(",")",["T_WHITESPACE","\n    ",130],"{",["T_WHITESPACE","\n        ",131],["T_VARIABLE","$cryptExpected",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_NEW","new",132],["T_WHITESPACE"," ",132],["T_NS_SEPARATOR","\\",132],["T_STRING","Magento",132],["T_NS_SEPARATOR","\\",132],["T_STRING","Framework",132],["T_NS_SEPARATOR","\\",132],["T_STRING","Encryption",132],["T_NS_SEPARATOR","\\",132],["T_STRING","Crypt",132],"(",["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","_key",132],",",["T_WHITESPACE"," ",132],["T_STRING","MCRYPT_BLOWFISH",132],",",["T_WHITESPACE"," ",132],["T_STRING","MCRYPT_MODE_ECB",132],",",["T_WHITESPACE"," ",132],["T_STRING","false",132],")",";",["T_WHITESPACE","\n        ",132],["T_VARIABLE","$cryptActual",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_NEW","new",133],["T_WHITESPACE"," ",133],["T_NS_SEPARATOR","\\",133],["T_STRING","Magento",133],["T_NS_SEPARATOR","\\",133],["T_STRING","Framework",133],["T_NS_SEPARATOR","\\",133],["T_STRING","Encryption",133],["T_NS_SEPARATOR","\\",133],["T_STRING","Crypt",133],"(",["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_key",133],")",";",["T_WHITESPACE","\n\n        ",133],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","assertEquals",135],"(",["T_VARIABLE","$cryptExpected",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getCipher",135],"(",")",",",["T_WHITESPACE"," ",135],["T_VARIABLE","$cryptActual",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getCipher",135],"(",")",")",";",["T_WHITESPACE","\n        ",135],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","assertEquals",136],"(",["T_VARIABLE","$cryptExpected",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getMode",136],"(",")",",",["T_WHITESPACE"," ",136],["T_VARIABLE","$cryptActual",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getMode",136],"(",")",")",";",["T_WHITESPACE","\n        ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","assertEquals",137],"(",["T_VARIABLE","$cryptExpected",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","getInitVector",137],"(",")",",",["T_WHITESPACE"," ",137],["T_VARIABLE","$cryptActual",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","getInitVector",137],"(",")",")",";",["T_WHITESPACE","\n    ",137],"}",["T_WHITESPACE","\n\n    ",138],["T_PUBLIC","public",140],["T_WHITESPACE"," ",140],["T_FUNCTION","function",140],["T_WHITESPACE"," ",140],["T_STRING","getCryptData",140],"(",")",["T_WHITESPACE","\n    ",140],"{",["T_WHITESPACE","\n        ",141],["T_VARIABLE","$fixturesFilename",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_DIR","__DIR__",142],["T_WHITESPACE"," ",142],".",["T_WHITESPACE"," ",142],["T_CONSTANT_ENCAPSED_STRING","'\/Crypt\/_files\/_crypt_fixtures.php'",142],";",["T_WHITESPACE","\n        ",142],["T_COMMENT","\/* Generate fixtures\n           $fixtures = array();\n           foreach (array('', 'Hello world!!!') as $inputString) {\n           foreach ($this->_supportedCiphers as $cipher) {\n           foreach ($this->_supportedModes as $mode) {\n           $randomKey = $this->_getRandomString($this->_getKeySize($cipher, $mode));\n           $randomInitVector = $this->_getRandomString($this->_getInitVectorSize($cipher, $mode));\n           $crypt = new \\Magento\\Framework\\Encryption\\Crypt($randomKey, $cipher, $mode, $randomInitVector);\n           $fixtures[] = array(\n           $randomKey, \/\/ Encryption key\n           $cipher,\n           $mode,\n           $randomInitVector, \/\/ Init vector\n           $inputString, \/\/ String to encrypt\n           base64_encode($crypt->encrypt($inputString)) \/\/ Store result of encryption as base64\n           );\n           }\n           }\n           }\n           file_put_contents($fixturesFilename, '<?php return ' . var_export($fixtures, true) . \";\\n\", LOCK_EX);\n           *\/",143],["T_WHITESPACE","\n        ",163],["T_VARIABLE","$result",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_INCLUDE","include",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$fixturesFilename",164],";",["T_WHITESPACE","\n        ",164],["T_COMMENT","\/* Restore encoded string back to binary *\/",165],["T_WHITESPACE","\n        ",165],["T_FOREACH","foreach",166],["T_WHITESPACE"," ",166],"(",["T_VARIABLE","$result",166],["T_WHITESPACE"," ",166],["T_AS","as",166],["T_WHITESPACE"," ",166],"&",["T_VARIABLE","$cryptParams",166],")",["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n            ",166],["T_VARIABLE","$cryptParams",167],"[",["T_LNUMBER","5",167],"]",["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_STRING","base64_decode",167],"(",["T_VARIABLE","$cryptParams",167],"[",["T_LNUMBER","5",167],"]",")",";",["T_WHITESPACE","\n        ",167],"}",["T_WHITESPACE","\n        ",168],["T_UNSET","unset",169],"(",["T_VARIABLE","$cryptParams",169],")",";",["T_WHITESPACE","\n        ",169],["T_RETURN","return",170],["T_WHITESPACE"," ",170],["T_VARIABLE","$result",170],";",["T_WHITESPACE","\n    ",170],"}",["T_WHITESPACE","\n\n    ",171],["T_DOC_COMMENT","\/**\n     * @dataProvider getCryptData\n     *\/",173],["T_WHITESPACE","\n    ",175],["T_PUBLIC","public",176],["T_WHITESPACE"," ",176],["T_FUNCTION","function",176],["T_WHITESPACE"," ",176],["T_STRING","testEncrypt",176],"(",["T_VARIABLE","$key",176],",",["T_WHITESPACE"," ",176],["T_VARIABLE","$cipher",176],",",["T_WHITESPACE"," ",176],["T_VARIABLE","$mode",176],",",["T_WHITESPACE"," ",176],["T_VARIABLE","$initVector",176],",",["T_WHITESPACE"," ",176],["T_VARIABLE","$inputData",176],",",["T_WHITESPACE"," ",176],["T_VARIABLE","$expectedData",176],")",["T_WHITESPACE","\n    ",176],"{",["T_WHITESPACE","\n        ",177],["T_VARIABLE","$crypt",178],["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_NEW","new",178],["T_WHITESPACE"," ",178],["T_NS_SEPARATOR","\\",178],["T_STRING","Magento",178],["T_NS_SEPARATOR","\\",178],["T_STRING","Framework",178],["T_NS_SEPARATOR","\\",178],["T_STRING","Encryption",178],["T_NS_SEPARATOR","\\",178],["T_STRING","Crypt",178],"(",["T_VARIABLE","$key",178],",",["T_WHITESPACE"," ",178],["T_VARIABLE","$cipher",178],",",["T_WHITESPACE"," ",178],["T_VARIABLE","$mode",178],",",["T_WHITESPACE"," ",178],["T_VARIABLE","$initVector",178],")",";",["T_WHITESPACE","\n        ",178],["T_VARIABLE","$actualData",179],["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_VARIABLE","$crypt",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","encrypt",179],"(",["T_VARIABLE","$inputData",179],")",";",["T_WHITESPACE","\n        ",179],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","assertEquals",180],"(",["T_VARIABLE","$expectedData",180],",",["T_WHITESPACE"," ",180],["T_VARIABLE","$actualData",180],")",";",["T_WHITESPACE","\n    ",180],"}",["T_WHITESPACE","\n\n    ",181],["T_DOC_COMMENT","\/**\n     * @dataProvider getCryptData\n     *\/",183],["T_WHITESPACE","\n    ",185],["T_PUBLIC","public",186],["T_WHITESPACE"," ",186],["T_FUNCTION","function",186],["T_WHITESPACE"," ",186],["T_STRING","testDecrypt",186],"(",["T_VARIABLE","$key",186],",",["T_WHITESPACE"," ",186],["T_VARIABLE","$cipher",186],",",["T_WHITESPACE"," ",186],["T_VARIABLE","$mode",186],",",["T_WHITESPACE"," ",186],["T_VARIABLE","$initVector",186],",",["T_WHITESPACE"," ",186],["T_VARIABLE","$expectedData",186],",",["T_WHITESPACE"," ",186],["T_VARIABLE","$inputData",186],")",["T_WHITESPACE","\n    ",186],"{",["T_WHITESPACE","\n        ",187],["T_VARIABLE","$crypt",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_NEW","new",188],["T_WHITESPACE"," ",188],["T_NS_SEPARATOR","\\",188],["T_STRING","Magento",188],["T_NS_SEPARATOR","\\",188],["T_STRING","Framework",188],["T_NS_SEPARATOR","\\",188],["T_STRING","Encryption",188],["T_NS_SEPARATOR","\\",188],["T_STRING","Crypt",188],"(",["T_VARIABLE","$key",188],",",["T_WHITESPACE"," ",188],["T_VARIABLE","$cipher",188],",",["T_WHITESPACE"," ",188],["T_VARIABLE","$mode",188],",",["T_WHITESPACE"," ",188],["T_VARIABLE","$initVector",188],")",";",["T_WHITESPACE","\n        ",188],["T_VARIABLE","$actualData",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_VARIABLE","$crypt",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","decrypt",189],"(",["T_VARIABLE","$inputData",189],")",";",["T_WHITESPACE","\n        ",189],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","assertEquals",190],"(",["T_VARIABLE","$expectedData",190],",",["T_WHITESPACE"," ",190],["T_VARIABLE","$actualData",190],")",";",["T_WHITESPACE","\n    ",190],"}",["T_WHITESPACE","\n\n    ",191],["T_DOC_COMMENT","\/**\n     * @dataProvider getCipherModeCombinations\n     *\/",193],["T_WHITESPACE","\n    ",195],["T_PUBLIC","public",196],["T_WHITESPACE"," ",196],["T_FUNCTION","function",196],["T_WHITESPACE"," ",196],["T_STRING","testInitVectorRandom",196],"(",["T_VARIABLE","$cipher",196],",",["T_WHITESPACE"," ",196],["T_VARIABLE","$mode",196],")",["T_WHITESPACE","\n    ",196],"{",["T_WHITESPACE","\n        ",197],["T_VARIABLE","$crypt1",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_NEW","new",198],["T_WHITESPACE"," ",198],["T_NS_SEPARATOR","\\",198],["T_STRING","Magento",198],["T_NS_SEPARATOR","\\",198],["T_STRING","Framework",198],["T_NS_SEPARATOR","\\",198],["T_STRING","Encryption",198],["T_NS_SEPARATOR","\\",198],["T_STRING","Crypt",198],"(",["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","_key",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$cipher",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$mode",198],",",["T_WHITESPACE"," ",198],["T_STRING","true",198],")",";",["T_WHITESPACE","\n        ",198],["T_VARIABLE","$initVector1",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_VARIABLE","$crypt1",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","getInitVector",199],"(",")",";",["T_WHITESPACE","\n\n        ",199],["T_VARIABLE","$crypt2",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_NEW","new",201],["T_WHITESPACE"," ",201],["T_NS_SEPARATOR","\\",201],["T_STRING","Magento",201],["T_NS_SEPARATOR","\\",201],["T_STRING","Framework",201],["T_NS_SEPARATOR","\\",201],["T_STRING","Encryption",201],["T_NS_SEPARATOR","\\",201],["T_STRING","Crypt",201],"(",["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","_key",201],",",["T_WHITESPACE"," ",201],["T_VARIABLE","$cipher",201],",",["T_WHITESPACE"," ",201],["T_VARIABLE","$mode",201],",",["T_WHITESPACE"," ",201],["T_STRING","true",201],")",";",["T_WHITESPACE","\n        ",201],["T_VARIABLE","$initVector2",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_VARIABLE","$crypt2",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","getInitVector",202],"(",")",";",["T_WHITESPACE","\n\n        ",202],["T_VARIABLE","$expectedSize",204],["T_WHITESPACE"," ",204],"=",["T_WHITESPACE"," ",204],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","_getInitVectorSize",204],"(",["T_VARIABLE","$cipher",204],",",["T_WHITESPACE"," ",204],["T_VARIABLE","$mode",204],")",";",["T_WHITESPACE","\n        ",204],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","assertEquals",205],"(",["T_VARIABLE","$expectedSize",205],",",["T_WHITESPACE"," ",205],["T_STRING","strlen",205],"(",["T_VARIABLE","$initVector1",205],")",")",";",["T_WHITESPACE","\n        ",205],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","assertEquals",206],"(",["T_VARIABLE","$expectedSize",206],",",["T_WHITESPACE"," ",206],["T_STRING","strlen",206],"(",["T_VARIABLE","$initVector2",206],")",")",";",["T_WHITESPACE","\n        ",206],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","assertNotEquals",207],"(",["T_VARIABLE","$initVector2",207],",",["T_WHITESPACE"," ",207],["T_VARIABLE","$initVector1",207],")",";",["T_WHITESPACE","\n    ",207],"}",["T_WHITESPACE","\n\n    ",208],["T_DOC_COMMENT","\/**\n     * @dataProvider getCipherModeCombinations\n     *\/",210],["T_WHITESPACE","\n    ",212],["T_PUBLIC","public",213],["T_WHITESPACE"," ",213],["T_FUNCTION","function",213],["T_WHITESPACE"," ",213],["T_STRING","testInitVectorNone",213],"(",["T_VARIABLE","$cipher",213],",",["T_WHITESPACE"," ",213],["T_VARIABLE","$mode",213],")",["T_WHITESPACE","\n    ",213],"{",["T_WHITESPACE","\n        ",214],["T_VARIABLE","$crypt",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_NEW","new",215],["T_WHITESPACE"," ",215],["T_NS_SEPARATOR","\\",215],["T_STRING","Magento",215],["T_NS_SEPARATOR","\\",215],["T_STRING","Framework",215],["T_NS_SEPARATOR","\\",215],["T_STRING","Encryption",215],["T_NS_SEPARATOR","\\",215],["T_STRING","Crypt",215],"(",["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","_key",215],",",["T_WHITESPACE"," ",215],["T_VARIABLE","$cipher",215],",",["T_WHITESPACE"," ",215],["T_VARIABLE","$mode",215],",",["T_WHITESPACE"," ",215],["T_STRING","false",215],")",";",["T_WHITESPACE","\n        ",215],["T_VARIABLE","$actualInitVector",216],["T_WHITESPACE"," ",216],"=",["T_WHITESPACE"," ",216],["T_VARIABLE","$crypt",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","getInitVector",216],"(",")",";",["T_WHITESPACE","\n\n        ",216],["T_VARIABLE","$expectedInitVector",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_STRING","str_repeat",218],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\0\"",218],",",["T_WHITESPACE"," ",218],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","_getInitVectorSize",218],"(",["T_VARIABLE","$cipher",218],",",["T_WHITESPACE"," ",218],["T_VARIABLE","$mode",218],")",")",";",["T_WHITESPACE","\n        ",218],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","assertEquals",219],"(",["T_VARIABLE","$expectedInitVector",219],",",["T_WHITESPACE"," ",219],["T_VARIABLE","$actualInitVector",219],")",";",["T_WHITESPACE","\n    ",219],"}",["T_WHITESPACE","\n",220],"}",["T_WHITESPACE","\n",221]]