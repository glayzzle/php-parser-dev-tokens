[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_COMMENT","\/\/ @codingStandardsIgnoreFile\n",7],["T_WHITESPACE","\n",8],["T_NAMESPACE","namespace",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Encryption",9],";",["T_WHITESPACE","\n\n",9],["T_DOC_COMMENT","\/**\n * Class encapsulates cryptographic algorithm\n *\/",11],["T_WHITESPACE","\n",13],["T_CLASS","class",14],["T_WHITESPACE"," ",14],["T_STRING","Crypt",14],["T_WHITESPACE","\n",14],"{",["T_WHITESPACE","\n    ",15],["T_DOC_COMMENT","\/**\n     * @var string\n     *\/",16],["T_WHITESPACE","\n    ",18],["T_PROTECTED","protected",19],["T_WHITESPACE"," ",19],["T_VARIABLE","$_cipher",19],";",["T_WHITESPACE","\n\n    ",19],["T_DOC_COMMENT","\/**\n     * @var string\n     *\/",21],["T_WHITESPACE","\n    ",23],["T_PROTECTED","protected",24],["T_WHITESPACE"," ",24],["T_VARIABLE","$_mode",24],";",["T_WHITESPACE","\n\n    ",24],["T_DOC_COMMENT","\/**\n     * @var string\n     *\/",26],["T_WHITESPACE","\n    ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$_initVector",29],";",["T_WHITESPACE","\n\n    ",29],["T_DOC_COMMENT","\/**\n     * Encryption algorithm module handle\n     *\n     * @var resource\n     *\/",31],["T_WHITESPACE","\n    ",35],["T_PROTECTED","protected",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$_handle",36],";",["T_WHITESPACE","\n\n    ",36],["T_DOC_COMMENT","\/**\n     * Constructor\n     *\n     * @param  string      $key        Secret encryption key.\n     *                                 It's unsafe to store encryption key in memory, so no getter for key exists.\n     * @param  string      $cipher     Cipher algorithm (one of the MCRYPT_ciphername constants)\n     * @param  string      $mode       Mode of cipher algorithm (MCRYPT_MODE_modeabbr constants)\n     * @param  string|bool $initVector Initial vector to fill algorithm blocks.\n     *                                 TRUE generates a random initial vector.\n     *                                 FALSE fills initial vector with zero bytes to not use it.\n     * @throws \\Exception\n     *\/",38],["T_WHITESPACE","\n    ",49],["T_PUBLIC","public",50],["T_WHITESPACE"," ",50],["T_FUNCTION","function",50],["T_WHITESPACE"," ",50],["T_STRING","__construct",50],"(",["T_VARIABLE","$key",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$cipher",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_STRING","MCRYPT_BLOWFISH",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$mode",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_STRING","MCRYPT_MODE_ECB",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$initVector",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_STRING","false",50],")",["T_WHITESPACE","\n    ",50],"{",["T_WHITESPACE","\n        ",51],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","_cipher",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$cipher",52],";",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","_mode",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$mode",53],";",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","_handle",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_STRING","mcrypt_module_open",54],"(",["T_VARIABLE","$cipher",54],",",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","''",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$mode",54],",",["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","''",54],")",";",["T_WHITESPACE","\n        ",54],["T_TRY","try",55],["T_WHITESPACE"," ",55],"{",["T_WHITESPACE","\n            ",55],["T_VARIABLE","$maxKeySize",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_STRING","mcrypt_enc_get_key_size",56],"(",["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","_handle",56],")",";",["T_WHITESPACE","\n            ",56],["T_IF","if",57],["T_WHITESPACE"," ",57],"(",["T_STRING","strlen",57],"(",["T_VARIABLE","$key",57],")",["T_WHITESPACE"," ",57],">",["T_WHITESPACE"," ",57],["T_VARIABLE","$maxKeySize",57],")",["T_WHITESPACE"," ",57],"{",["T_WHITESPACE","\n                ",57],["T_THROW","throw",58],["T_WHITESPACE"," ",58],["T_NEW","new",58],["T_WHITESPACE"," ",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Magento",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Framework",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Exception",58],["T_NS_SEPARATOR","\\",58],["T_STRING","LocalizedException",58],"(",["T_WHITESPACE","\n                    ",58],["T_NEW","new",59],["T_WHITESPACE"," ",59],["T_NS_SEPARATOR","\\",59],["T_STRING","Magento",59],["T_NS_SEPARATOR","\\",59],["T_STRING","Framework",59],["T_NS_SEPARATOR","\\",59],["T_STRING","Phrase",59],"(",["T_CONSTANT_ENCAPSED_STRING","'Key must not exceed %1 bytes.'",59],",",["T_WHITESPACE"," ",59],"[",["T_VARIABLE","$maxKeySize",59],"]",")",["T_WHITESPACE","\n                ",59],")",";",["T_WHITESPACE","\n            ",60],"}",["T_WHITESPACE","\n            ",61],["T_VARIABLE","$initVectorSize",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_STRING","mcrypt_enc_get_iv_size",62],"(",["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","_handle",62],")",";",["T_WHITESPACE","\n            ",62],["T_IF","if",63],["T_WHITESPACE"," ",63],"(",["T_STRING","true",63],["T_WHITESPACE"," ",63],["T_IS_IDENTICAL","===",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$initVector",63],")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n                ",63],["T_COMMENT","\/* Generate a random vector from human-readable characters *\/",64],["T_WHITESPACE","\n                ",64],["T_VARIABLE","$abc",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'",65],";",["T_WHITESPACE","\n                ",65],["T_VARIABLE","$initVector",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","''",66],";",["T_WHITESPACE","\n                ",66],["T_FOR","for",67],["T_WHITESPACE"," ",67],"(",["T_VARIABLE","$i",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_LNUMBER","0",67],";",["T_WHITESPACE"," ",67],["T_VARIABLE","$i",67],["T_WHITESPACE"," ",67],"<",["T_WHITESPACE"," ",67],["T_VARIABLE","$initVectorSize",67],";",["T_WHITESPACE"," ",67],["T_VARIABLE","$i",67],["T_INC","++",67],")",["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n                    ",67],["T_VARIABLE","$initVector",68],["T_WHITESPACE"," ",68],["T_CONCAT_EQUAL",".=",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$abc",68],"[",["T_STRING","rand",68],"(",["T_LNUMBER","0",68],",",["T_WHITESPACE"," ",68],["T_STRING","strlen",68],"(",["T_VARIABLE","$abc",68],")",["T_WHITESPACE"," ",68],"-",["T_WHITESPACE"," ",68],["T_LNUMBER","1",68],")","]",";",["T_WHITESPACE","\n                ",68],"}",["T_WHITESPACE","\n            ",69],"}",["T_WHITESPACE"," ",70],["T_ELSEIF","elseif",70],["T_WHITESPACE"," ",70],"(",["T_STRING","false",70],["T_WHITESPACE"," ",70],["T_IS_IDENTICAL","===",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$initVector",70],")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n                ",70],["T_COMMENT","\/* Set vector to zero bytes to not use it *\/",71],["T_WHITESPACE","\n                ",71],["T_VARIABLE","$initVector",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_STRING","str_repeat",72],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\0\"",72],",",["T_WHITESPACE"," ",72],["T_VARIABLE","$initVectorSize",72],")",";",["T_WHITESPACE","\n            ",72],"}",["T_WHITESPACE"," ",73],["T_ELSEIF","elseif",73],["T_WHITESPACE"," ",73],"(","!",["T_STRING","is_string",73],"(",["T_VARIABLE","$initVector",73],")",["T_WHITESPACE"," ",73],["T_BOOLEAN_OR","||",73],["T_WHITESPACE"," ",73],["T_STRING","strlen",73],"(",["T_VARIABLE","$initVector",73],")",["T_WHITESPACE"," ",73],["T_IS_NOT_EQUAL","!=",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$initVectorSize",73],")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n                ",73],["T_THROW","throw",74],["T_WHITESPACE"," ",74],["T_NEW","new",74],["T_WHITESPACE"," ",74],["T_NS_SEPARATOR","\\",74],["T_STRING","Magento",74],["T_NS_SEPARATOR","\\",74],["T_STRING","Framework",74],["T_NS_SEPARATOR","\\",74],["T_STRING","Exception",74],["T_NS_SEPARATOR","\\",74],["T_STRING","LocalizedException",74],"(",["T_WHITESPACE","\n                    ",74],["T_NEW","new",75],["T_WHITESPACE"," ",75],["T_NS_SEPARATOR","\\",75],["T_STRING","Magento",75],["T_NS_SEPARATOR","\\",75],["T_STRING","Framework",75],["T_NS_SEPARATOR","\\",75],["T_STRING","Phrase",75],"(",["T_CONSTANT_ENCAPSED_STRING","'Init vector must be a string of %1 bytes.'",75],",",["T_WHITESPACE"," ",75],"[",["T_VARIABLE","$initVectorSize",75],"]",")",["T_WHITESPACE","\n                ",75],")",";",["T_WHITESPACE","\n            ",76],"}",["T_WHITESPACE","\n            ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","_initVector",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$initVector",78],";",["T_WHITESPACE","\n        ",78],"}",["T_WHITESPACE"," ",79],["T_CATCH","catch",79],["T_WHITESPACE"," ",79],"(",["T_NS_SEPARATOR","\\",79],["T_STRING","Exception",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$e",79],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n            ",79],["T_STRING","mcrypt_module_close",80],"(",["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","_handle",80],")",";",["T_WHITESPACE","\n            ",80],["T_THROW","throw",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$e",81],";",["T_WHITESPACE","\n        ",81],"}",["T_WHITESPACE","\n        ",82],["T_STRING","mcrypt_generic_init",83],"(",["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","_handle",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$key",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$initVector",83],")",";",["T_WHITESPACE","\n    ",83],"}",["T_WHITESPACE","\n\n    ",84],["T_DOC_COMMENT","\/**\n     * Destructor frees allocated resources\n     *\n     * @return void\n     *\/",86],["T_WHITESPACE","\n    ",90],["T_PUBLIC","public",91],["T_WHITESPACE"," ",91],["T_FUNCTION","function",91],["T_WHITESPACE"," ",91],["T_STRING","__destruct",91],"(",")",["T_WHITESPACE","\n    ",91],"{",["T_WHITESPACE","\n        ",92],["T_STRING","mcrypt_generic_deinit",93],"(",["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","_handle",93],")",";",["T_WHITESPACE","\n        ",93],["T_STRING","mcrypt_module_close",94],"(",["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","_handle",94],")",";",["T_WHITESPACE","\n    ",94],"}",["T_WHITESPACE","\n\n    ",95],["T_DOC_COMMENT","\/**\n     * Retrieve a name of currently used cryptographic algorithm\n     *\n     * @return string\n     *\/",97],["T_WHITESPACE","\n    ",101],["T_PUBLIC","public",102],["T_WHITESPACE"," ",102],["T_FUNCTION","function",102],["T_WHITESPACE"," ",102],["T_STRING","getCipher",102],"(",")",["T_WHITESPACE","\n    ",102],"{",["T_WHITESPACE","\n        ",103],["T_RETURN","return",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","_cipher",104],";",["T_WHITESPACE","\n    ",104],"}",["T_WHITESPACE","\n\n    ",105],["T_DOC_COMMENT","\/**\n     * Mode in which cryptographic algorithm is running\n     *\n     * @return string\n     *\/",107],["T_WHITESPACE","\n    ",111],["T_PUBLIC","public",112],["T_WHITESPACE"," ",112],["T_FUNCTION","function",112],["T_WHITESPACE"," ",112],["T_STRING","getMode",112],"(",")",["T_WHITESPACE","\n    ",112],"{",["T_WHITESPACE","\n        ",113],["T_RETURN","return",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","_mode",114],";",["T_WHITESPACE","\n    ",114],"}",["T_WHITESPACE","\n\n    ",115],["T_DOC_COMMENT","\/**\n     * Retrieve an actual value of initial vector that has been used to initialize a cipher\n     *\n     * @return string\n     *\/",117],["T_WHITESPACE","\n    ",121],["T_PUBLIC","public",122],["T_WHITESPACE"," ",122],["T_FUNCTION","function",122],["T_WHITESPACE"," ",122],["T_STRING","getInitVector",122],"(",")",["T_WHITESPACE","\n    ",122],"{",["T_WHITESPACE","\n        ",123],["T_RETURN","return",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","_initVector",124],";",["T_WHITESPACE","\n    ",124],"}",["T_WHITESPACE","\n\n    ",125],["T_DOC_COMMENT","\/**\n     * Encrypt a data\n     *\n     * @param  string $data String to encrypt\n     * @return string\n     *\/",127],["T_WHITESPACE","\n    ",132],["T_PUBLIC","public",133],["T_WHITESPACE"," ",133],["T_FUNCTION","function",133],["T_WHITESPACE"," ",133],["T_STRING","encrypt",133],"(",["T_VARIABLE","$data",133],")",["T_WHITESPACE","\n    ",133],"{",["T_WHITESPACE","\n        ",134],["T_IF","if",135],["T_WHITESPACE"," ",135],"(",["T_STRING","strlen",135],"(",["T_VARIABLE","$data",135],")",["T_WHITESPACE"," ",135],["T_IS_EQUAL","==",135],["T_WHITESPACE"," ",135],["T_LNUMBER","0",135],")",["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n            ",135],["T_RETURN","return",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$data",136],";",["T_WHITESPACE","\n        ",136],"}",["T_WHITESPACE","\n        ",137],["T_RETURN","return",138],["T_WHITESPACE"," ",138],["T_STRING","mcrypt_generic",138],"(",["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","_handle",138],",",["T_WHITESPACE"," ",138],["T_VARIABLE","$data",138],")",";",["T_WHITESPACE","\n    ",138],"}",["T_WHITESPACE","\n\n    ",139],["T_DOC_COMMENT","\/**\n     * Decrypt a data\n     *\n     * @param  string $data String to decrypt\n     * @return string\n     *\/",141],["T_WHITESPACE","\n    ",146],["T_PUBLIC","public",147],["T_WHITESPACE"," ",147],["T_FUNCTION","function",147],["T_WHITESPACE"," ",147],["T_STRING","decrypt",147],"(",["T_VARIABLE","$data",147],")",["T_WHITESPACE","\n    ",147],"{",["T_WHITESPACE","\n        ",148],["T_IF","if",149],["T_WHITESPACE"," ",149],"(",["T_STRING","strlen",149],"(",["T_VARIABLE","$data",149],")",["T_WHITESPACE"," ",149],["T_IS_EQUAL","==",149],["T_WHITESPACE"," ",149],["T_LNUMBER","0",149],")",["T_WHITESPACE"," ",149],"{",["T_WHITESPACE","\n            ",149],["T_RETURN","return",150],["T_WHITESPACE"," ",150],["T_VARIABLE","$data",150],";",["T_WHITESPACE","\n        ",150],"}",["T_WHITESPACE","\n        ",151],["T_VARIABLE","$data",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_STRING","mdecrypt_generic",152],"(",["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","_handle",152],",",["T_WHITESPACE"," ",152],["T_VARIABLE","$data",152],")",";",["T_WHITESPACE","\n        ",152],["T_COMMENT","\/*\n         * Returned string can in fact be longer than the unencrypted string due to the padding of the data\n         * @link http:\/\/www.php.net\/manual\/en\/function.mdecrypt-generic.php\n         *\/",153],["T_WHITESPACE","\n        ",156],["T_VARIABLE","$data",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_STRING","rtrim",157],"(",["T_VARIABLE","$data",157],",",["T_WHITESPACE"," ",157],["T_CONSTANT_ENCAPSED_STRING","\"\\0\"",157],")",";",["T_WHITESPACE","\n        ",157],["T_RETURN","return",158],["T_WHITESPACE"," ",158],["T_VARIABLE","$data",158],";",["T_WHITESPACE","\n    ",158],"}",["T_WHITESPACE","\n",159],"}",["T_WHITESPACE","\n",160]]