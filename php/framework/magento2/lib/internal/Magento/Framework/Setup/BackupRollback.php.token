[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Framework",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Setup",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","App",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Filesystem",9],["T_NS_SEPARATOR","\\",9],["T_STRING","DirectoryList",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Backup",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Factory",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Framework",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Backup",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Exception",11],["T_NS_SEPARATOR","\\",11],["T_STRING","NotEnoughPermissions",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Framework",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Backup",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Filesystem",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Framework",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Backup",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Filesystem",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Helper",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Framework",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Exception",14],["T_NS_SEPARATOR","\\",14],["T_STRING","LocalizedException",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Magento",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Framework",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Filesystem",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Driver",15],["T_NS_SEPARATOR","\\",15],["T_STRING","File",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Magento",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Framework",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Filesystem",16],["T_NS_SEPARATOR","\\",16],["T_STRING","DriverInterface",16],";",["T_WHITESPACE","\n",16],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Magento",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Framework",17],["T_NS_SEPARATOR","\\",17],["T_STRING","ObjectManagerInterface",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Magento",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Framework",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Phrase",18],";",["T_WHITESPACE","\n\n",18],["T_DOC_COMMENT","\/**\n * Class to deal with backup and rollback functionality for database and Code base\n *\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",20],["T_WHITESPACE","\n",24],["T_CLASS","class",25],["T_WHITESPACE"," ",25],["T_STRING","BackupRollback",25],["T_WHITESPACE","\n",25],"{",["T_WHITESPACE","\n    ",26],["T_DOC_COMMENT","\/**\n     * Default backup directory\n     *\/",27],["T_WHITESPACE","\n    ",29],["T_CONST","const",30],["T_WHITESPACE"," ",30],["T_STRING","DEFAULT_BACKUP_DIRECTORY",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_CONSTANT_ENCAPSED_STRING","'backups'",30],";",["T_WHITESPACE","\n\n    ",30],["T_DOC_COMMENT","\/**\n     * Path to backup folder\n     *\n     * @var string\n     *\/",32],["T_WHITESPACE","\n    ",36],["T_PRIVATE","private",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$backupsDir",37],";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * Object Manager\n     *\n     * @var ObjectManagerInterface\n     *\/",39],["T_WHITESPACE","\n    ",43],["T_PRIVATE","private",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$objectManager",44],";",["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * Logger\n     *\n     * @var LoggerInterface\n     *\/",46],["T_WHITESPACE","\n    ",50],["T_PRIVATE","private",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$log",51],";",["T_WHITESPACE","\n\n    ",51],["T_DOC_COMMENT","\/**\n     * Filesystem Directory List\n     *\n     * @var DirectoryList\n     *\/",53],["T_WHITESPACE","\n    ",57],["T_PRIVATE","private",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$directoryList",58],";",["T_WHITESPACE","\n\n    ",58],["T_DOC_COMMENT","\/**\n     * File\n     *\n     * @var File\n     *\/",60],["T_WHITESPACE","\n    ",64],["T_PRIVATE","private",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$file",65],";",["T_WHITESPACE","\n\n    ",65],["T_DOC_COMMENT","\/**\n     * Filesystem Helper\n     *\n     * @var Helper\n     *\/",67],["T_WHITESPACE","\n    ",71],["T_PRIVATE","private",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$fsHelper",72],";",["T_WHITESPACE","\n\n    ",72],["T_DOC_COMMENT","\/**\n     * Constructor\n     *\n     * @param ObjectManagerInterface $objectManager\n     * @param LoggerInterface $log\n     * @param DirectoryList $directoryList\n     * @param File $file\n     * @param Helper $fsHelper\n     *\/",74],["T_WHITESPACE","\n    ",82],["T_PUBLIC","public",83],["T_WHITESPACE"," ",83],["T_FUNCTION","function",83],["T_WHITESPACE"," ",83],["T_STRING","__construct",83],"(",["T_WHITESPACE","\n        ",83],["T_STRING","ObjectManagerInterface",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$objectManager",84],",",["T_WHITESPACE","\n        ",84],["T_STRING","LoggerInterface",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$log",85],",",["T_WHITESPACE","\n        ",85],["T_STRING","DirectoryList",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$directoryList",86],",",["T_WHITESPACE","\n        ",86],["T_STRING","File",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$file",87],",",["T_WHITESPACE","\n        ",87],["T_STRING","Helper",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$fsHelper",88],["T_WHITESPACE","\n    ",88],")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","objectManager",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$objectManager",90],";",["T_WHITESPACE","\n        ",90],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","log",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_VARIABLE","$log",91],";",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","directoryList",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$directoryList",92],";",["T_WHITESPACE","\n        ",92],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","file",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$file",93],";",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","fsHelper",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_VARIABLE","$fsHelper",94],";",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","backupsDir",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","directoryList",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getPath",95],"(",["T_STRING","DirectoryList",95],["T_DOUBLE_COLON","::",95],["T_STRING","VAR_DIR",95],")",["T_WHITESPACE","\n            ",95],".",["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","'\/'",96],["T_WHITESPACE"," ",96],".",["T_WHITESPACE"," ",96],["T_STRING","self",96],["T_DOUBLE_COLON","::",96],["T_STRING","DEFAULT_BACKUP_DIRECTORY",96],";",["T_WHITESPACE","\n    ",96],"}",["T_WHITESPACE","\n\n    ",97],["T_DOC_COMMENT","\/**\n     * Take backup for code base\n     *\n     * @param int $time\n     * @param string $type\n     * @return string\n     * @throws LocalizedException\n     *\/",99],["T_WHITESPACE","\n    ",106],["T_PUBLIC","public",107],["T_WHITESPACE"," ",107],["T_FUNCTION","function",107],["T_WHITESPACE"," ",107],["T_STRING","codeBackup",107],"(",["T_VARIABLE","$time",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$type",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_STRING","Factory",107],["T_DOUBLE_COLON","::",107],["T_STRING","TYPE_FILESYSTEM",107],")",["T_WHITESPACE","\n    ",107],"{",["T_WHITESPACE","\n        ",108],["T_DOC_COMMENT","\/** @var \\Magento\\Framework\\Backup\\Filesystem $fsBackup *\/",109],["T_WHITESPACE","\n        ",109],["T_VARIABLE","$fsBackup",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","objectManager",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","create",110],"(",["T_NS_SEPARATOR","\\",110],["T_STRING","Magento",110],["T_NS_SEPARATOR","\\",110],["T_STRING","Framework",110],["T_NS_SEPARATOR","\\",110],["T_STRING","Backup",110],["T_NS_SEPARATOR","\\",110],["T_STRING","Filesystem",110],["T_DOUBLE_COLON","::",110],["T_CLASS","class",110],")",";",["T_WHITESPACE","\n        ",110],["T_VARIABLE","$fsBackup",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","setRootDir",111],"(",["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","directoryList",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","getRoot",111],"(",")",")",";",["T_WHITESPACE","\n        ",111],["T_IF","if",112],["T_WHITESPACE"," ",112],"(",["T_VARIABLE","$type",112],["T_WHITESPACE"," ",112],["T_IS_IDENTICAL","===",112],["T_WHITESPACE"," ",112],["T_STRING","Factory",112],["T_DOUBLE_COLON","::",112],["T_STRING","TYPE_FILESYSTEM",112],")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n            ",112],["T_VARIABLE","$fsBackup",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","addIgnorePaths",113],"(",["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","getCodeBackupIgnorePaths",113],"(",")",")",";",["T_WHITESPACE","\n            ",113],["T_VARIABLE","$granularType",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","'Code'",114],";",["T_WHITESPACE","\n            ",114],["T_VARIABLE","$fsBackup",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","setName",115],"(",["T_CONSTANT_ENCAPSED_STRING","'code'",115],")",";",["T_WHITESPACE","\n        ",115],"}",["T_WHITESPACE"," ",116],["T_ELSEIF","elseif",116],["T_WHITESPACE"," ",116],"(",["T_VARIABLE","$type",116],["T_WHITESPACE"," ",116],["T_IS_IDENTICAL","===",116],["T_WHITESPACE"," ",116],["T_STRING","Factory",116],["T_DOUBLE_COLON","::",116],["T_STRING","TYPE_MEDIA",116],")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n            ",116],["T_VARIABLE","$fsBackup",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","addIgnorePaths",117],"(",["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getMediaBackupIgnorePaths",117],"(",")",")",";",["T_WHITESPACE","\n            ",117],["T_VARIABLE","$granularType",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_CONSTANT_ENCAPSED_STRING","'Media'",118],";",["T_WHITESPACE","\n            ",118],["T_VARIABLE","$fsBackup",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","setName",119],"(",["T_CONSTANT_ENCAPSED_STRING","'media'",119],")",";",["T_WHITESPACE","\n        ",119],"}",["T_WHITESPACE"," ",120],["T_ELSE","else",120],["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n            ",120],["T_THROW","throw",121],["T_WHITESPACE"," ",121],["T_NEW","new",121],["T_WHITESPACE"," ",121],["T_STRING","LocalizedException",121],"(",["T_NEW","new",121],["T_WHITESPACE"," ",121],["T_STRING","Phrase",121],"(","\"",["T_ENCAPSED_AND_WHITESPACE","This backup type \\'",121],["T_VARIABLE","$type",121],["T_ENCAPSED_AND_WHITESPACE","\\' is not supported.",121],"\"",")",")",";",["T_WHITESPACE","\n        ",121],"}",["T_WHITESPACE","\n        ",122],["T_IF","if",123],["T_WHITESPACE"," ",123],"(","!",["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","file",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","isExists",123],"(",["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","backupsDir",123],")",")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n            ",123],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","file",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","createDirectory",124],"(",["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","backupsDir",124],")",";",["T_WHITESPACE","\n        ",124],"}",["T_WHITESPACE","\n        ",125],["T_VARIABLE","$fsBackup",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","setBackupsDir",126],"(",["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","backupsDir",126],")",";",["T_WHITESPACE","\n        ",126],["T_VARIABLE","$fsBackup",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","setBackupExtension",127],"(",["T_CONSTANT_ENCAPSED_STRING","'tgz'",127],")",";",["T_WHITESPACE","\n        ",127],["T_VARIABLE","$fsBackup",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","setTime",128],"(",["T_VARIABLE","$time",128],")",";",["T_WHITESPACE","\n        ",128],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","log",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","log",129],"(",["T_VARIABLE","$granularType",129],["T_WHITESPACE"," ",129],".",["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","' backup is starting...'",129],")",";",["T_WHITESPACE","\n        ",129],["T_VARIABLE","$fsBackup",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","create",130],"(",")",";",["T_WHITESPACE","\n        ",130],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","log",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","log",131],"(",["T_WHITESPACE","\n            ",131],["T_VARIABLE","$granularType",132],".",["T_WHITESPACE"," ",132],["T_CONSTANT_ENCAPSED_STRING","' backup filename: '",132],["T_WHITESPACE"," ",132],".",["T_WHITESPACE"," ",132],["T_VARIABLE","$fsBackup",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","getBackupFilename",132],"(",")",["T_WHITESPACE","\n            ",132],".",["T_WHITESPACE"," ",133],["T_CONSTANT_ENCAPSED_STRING","' (The archive can be uncompressed with 7-Zip on Windows systems)'",133],["T_WHITESPACE","\n        ",133],")",";",["T_WHITESPACE","\n        ",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","log",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","log",135],"(",["T_VARIABLE","$granularType",135],["T_WHITESPACE"," ",135],".",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","' backup path: '",135],["T_WHITESPACE"," ",135],".",["T_WHITESPACE"," ",135],["T_VARIABLE","$fsBackup",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getBackupPath",135],"(",")",")",";",["T_WHITESPACE","\n        ",135],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","log",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","logSuccess",136],"(",["T_VARIABLE","$granularType",136],["T_WHITESPACE"," ",136],".",["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","' backup completed successfully.'",136],")",";",["T_WHITESPACE","\n        ",136],["T_RETURN","return",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$fsBackup",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","getBackupPath",137],"(",")",";",["T_WHITESPACE","\n    ",137],"}",["T_WHITESPACE","\n\n    ",138],["T_DOC_COMMENT","\/**\n     * Roll back code base\n     *\n     * @param string $rollbackFile\n     * @param string $type\n     * @return void\n     * @throws LocalizedException\n     *\/",140],["T_WHITESPACE","\n    ",147],["T_PUBLIC","public",148],["T_WHITESPACE"," ",148],["T_FUNCTION","function",148],["T_WHITESPACE"," ",148],["T_STRING","codeRollback",148],"(",["T_VARIABLE","$rollbackFile",148],",",["T_WHITESPACE"," ",148],["T_VARIABLE","$type",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_STRING","Factory",148],["T_DOUBLE_COLON","::",148],["T_STRING","TYPE_FILESYSTEM",148],")",["T_WHITESPACE","\n    ",148],"{",["T_WHITESPACE","\n        ",149],["T_IF","if",150],["T_WHITESPACE"," ",150],"(",["T_STRING","preg_match",150],"(",["T_CONSTANT_ENCAPSED_STRING","'\/[0-9]_(filesystem)_(code|media)\\.(tgz)$\/'",150],",",["T_WHITESPACE"," ",150],["T_VARIABLE","$rollbackFile",150],")",["T_WHITESPACE"," ",150],["T_IS_NOT_IDENTICAL","!==",150],["T_WHITESPACE"," ",150],["T_LNUMBER","1",150],")",["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n            ",150],["T_THROW","throw",151],["T_WHITESPACE"," ",151],["T_NEW","new",151],["T_WHITESPACE"," ",151],["T_STRING","LocalizedException",151],"(",["T_NEW","new",151],["T_WHITESPACE"," ",151],["T_STRING","Phrase",151],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid rollback file.'",151],")",")",";",["T_WHITESPACE","\n        ",151],"}",["T_WHITESPACE","\n        ",152],["T_IF","if",153],["T_WHITESPACE"," ",153],"(","!",["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","file",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","isExists",153],"(",["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","backupsDir",153],["T_WHITESPACE"," ",153],".",["T_WHITESPACE"," ",153],["T_CONSTANT_ENCAPSED_STRING","'\/'",153],["T_WHITESPACE"," ",153],".",["T_WHITESPACE"," ",153],["T_VARIABLE","$rollbackFile",153],")",")",["T_WHITESPACE"," ",153],"{",["T_WHITESPACE","\n            ",153],["T_THROW","throw",154],["T_WHITESPACE"," ",154],["T_NEW","new",154],["T_WHITESPACE"," ",154],["T_STRING","LocalizedException",154],"(",["T_NEW","new",154],["T_WHITESPACE"," ",154],["T_STRING","Phrase",154],"(",["T_CONSTANT_ENCAPSED_STRING","'The rollback file does not exist.'",154],")",")",";",["T_WHITESPACE","\n        ",154],"}",["T_WHITESPACE","\n        ",155],["T_DOC_COMMENT","\/** @var \\Magento\\Framework\\Backup\\Filesystem $fsRollback *\/",156],["T_WHITESPACE","\n        ",156],["T_VARIABLE","$fsRollback",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","objectManager",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","create",157],"(",["T_NS_SEPARATOR","\\",157],["T_STRING","Magento",157],["T_NS_SEPARATOR","\\",157],["T_STRING","Framework",157],["T_NS_SEPARATOR","\\",157],["T_STRING","Backup",157],["T_NS_SEPARATOR","\\",157],["T_STRING","Filesystem",157],["T_DOUBLE_COLON","::",157],["T_CLASS","class",157],")",";",["T_WHITESPACE","\n        ",157],["T_IF","if",158],["T_WHITESPACE"," ",158],"(",["T_VARIABLE","$type",158],["T_WHITESPACE"," ",158],["T_IS_IDENTICAL","===",158],["T_WHITESPACE"," ",158],["T_STRING","Factory",158],["T_DOUBLE_COLON","::",158],["T_STRING","TYPE_FILESYSTEM",158],")",["T_WHITESPACE"," ",158],"{",["T_WHITESPACE","\n            ",158],["T_VARIABLE","$ignorePaths",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","getCodeBackupIgnorePaths",159],"(",")",";",["T_WHITESPACE","\n            ",159],["T_VARIABLE","$granularType",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","'Code'",160],";",["T_WHITESPACE","\n            ",160],["T_VARIABLE","$fsRollback",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","setName",161],"(",["T_CONSTANT_ENCAPSED_STRING","'code'",161],")",";",["T_WHITESPACE","\n        ",161],"}",["T_WHITESPACE"," ",162],["T_ELSEIF","elseif",162],["T_WHITESPACE"," ",162],"(",["T_VARIABLE","$type",162],["T_WHITESPACE"," ",162],["T_IS_IDENTICAL","===",162],["T_WHITESPACE"," ",162],["T_STRING","Factory",162],["T_DOUBLE_COLON","::",162],["T_STRING","TYPE_MEDIA",162],")",["T_WHITESPACE"," ",162],"{",["T_WHITESPACE","\n            ",162],["T_VARIABLE","$ignorePaths",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","getMediaBackupIgnorePaths",163],"(",")",";",["T_WHITESPACE","\n            ",163],["T_VARIABLE","$granularType",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","'Media'",164],";",["T_WHITESPACE","\n            ",164],["T_VARIABLE","$fsRollback",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","setName",165],"(",["T_CONSTANT_ENCAPSED_STRING","'media'",165],")",";",["T_WHITESPACE","\n        ",165],"}",["T_WHITESPACE"," ",166],["T_ELSE","else",166],["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n            ",166],["T_THROW","throw",167],["T_WHITESPACE"," ",167],["T_NEW","new",167],["T_WHITESPACE"," ",167],["T_STRING","LocalizedException",167],"(",["T_NEW","new",167],["T_WHITESPACE"," ",167],["T_STRING","Phrase",167],"(","\"",["T_ENCAPSED_AND_WHITESPACE","This backup type '",167],["T_VARIABLE","$type",167],["T_ENCAPSED_AND_WHITESPACE","' is not supported.",167],"\"",")",")",";",["T_WHITESPACE","\n        ",167],"}",["T_WHITESPACE","\n        ",168],["T_VARIABLE","$filesInfo",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","fsHelper",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","getInfo",169],"(",["T_WHITESPACE","\n            ",169],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","directoryList",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","getRoot",170],"(",")",",",["T_WHITESPACE","\n            ",170],["T_STRING","Helper",171],["T_DOUBLE_COLON","::",171],["T_STRING","INFO_WRITABLE",171],",",["T_WHITESPACE","\n            ",171],["T_VARIABLE","$ignorePaths",172],["T_WHITESPACE","\n        ",172],")",";",["T_WHITESPACE","\n        ",173],["T_IF","if",174],["T_WHITESPACE"," ",174],"(","!",["T_VARIABLE","$filesInfo",174],"[",["T_CONSTANT_ENCAPSED_STRING","'writable'",174],"]",")",["T_WHITESPACE"," ",174],"{",["T_WHITESPACE","\n            ",174],["T_THROW","throw",175],["T_WHITESPACE"," ",175],["T_NEW","new",175],["T_WHITESPACE"," ",175],["T_STRING","NotEnoughPermissions",175],"(",["T_WHITESPACE","\n                ",175],["T_NEW","new",176],["T_WHITESPACE"," ",176],["T_STRING","Phrase",176],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to make rollback because not all files are writable'",176],")",["T_WHITESPACE","\n            ",176],")",";",["T_WHITESPACE","\n        ",177],"}",["T_WHITESPACE","\n        ",178],["T_VARIABLE","$fsRollback",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","setRootDir",179],"(",["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","directoryList",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","getRoot",179],"(",")",")",";",["T_WHITESPACE","\n        ",179],["T_VARIABLE","$fsRollback",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","addIgnorePaths",180],"(",["T_VARIABLE","$ignorePaths",180],")",";",["T_WHITESPACE","\n        ",180],["T_VARIABLE","$fsRollback",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","setBackupsDir",181],"(",["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","backupsDir",181],")",";",["T_WHITESPACE","\n        ",181],["T_VARIABLE","$fsRollback",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","setBackupExtension",182],"(",["T_CONSTANT_ENCAPSED_STRING","'tgz'",182],")",";",["T_WHITESPACE","\n        ",182],["T_VARIABLE","$time",183],["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_STRING","explode",183],"(",["T_CONSTANT_ENCAPSED_STRING","'_'",183],",",["T_WHITESPACE"," ",183],["T_VARIABLE","$rollbackFile",183],")",";",["T_WHITESPACE","\n        ",183],["T_VARIABLE","$fsRollback",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","setTime",184],"(",["T_VARIABLE","$time",184],"[",["T_LNUMBER","0",184],"]",")",";",["T_WHITESPACE","\n        ",184],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","log",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","log",185],"(",["T_VARIABLE","$granularType",185],["T_WHITESPACE"," ",185],".",["T_WHITESPACE"," ",185],["T_CONSTANT_ENCAPSED_STRING","' rollback is starting ...'",185],")",";",["T_WHITESPACE","\n        ",185],["T_VARIABLE","$fsRollback",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","rollback",186],"(",")",";",["T_WHITESPACE","\n        ",186],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","log",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","log",187],"(",["T_VARIABLE","$granularType",187],["T_WHITESPACE"," ",187],".",["T_WHITESPACE"," ",187],["T_CONSTANT_ENCAPSED_STRING","' rollback filename: '",187],["T_WHITESPACE"," ",187],".",["T_WHITESPACE"," ",187],["T_VARIABLE","$fsRollback",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","getBackupFilename",187],"(",")",")",";",["T_WHITESPACE","\n        ",187],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","log",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","log",188],"(",["T_VARIABLE","$granularType",188],["T_WHITESPACE"," ",188],".",["T_WHITESPACE"," ",188],["T_CONSTANT_ENCAPSED_STRING","' rollback file path: '",188],["T_WHITESPACE"," ",188],".",["T_WHITESPACE"," ",188],["T_VARIABLE","$fsRollback",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getBackupPath",188],"(",")",")",";",["T_WHITESPACE","\n        ",188],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","log",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","logSuccess",189],"(",["T_VARIABLE","$granularType",189],["T_WHITESPACE"," ",189],".",["T_WHITESPACE"," ",189],["T_CONSTANT_ENCAPSED_STRING","' rollback completed successfully.'",189],")",";",["T_WHITESPACE","\n    ",189],"}",["T_WHITESPACE","\n\n    ",190],["T_DOC_COMMENT","\/**\n     * Take backup for database\n     *\n     * @param int $time\n     * @return string\n     *\/",192],["T_WHITESPACE","\n    ",197],["T_PUBLIC","public",198],["T_WHITESPACE"," ",198],["T_FUNCTION","function",198],["T_WHITESPACE"," ",198],["T_STRING","dbBackup",198],"(",["T_VARIABLE","$time",198],")",["T_WHITESPACE","\n    ",198],"{",["T_WHITESPACE","\n        ",199],["T_DOC_COMMENT","\/** @var \\Magento\\Framework\\Backup\\Db $dbBackup *\/",200],["T_WHITESPACE","\n        ",200],["T_VARIABLE","$dbBackup",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","objectManager",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","create",201],"(",["T_NS_SEPARATOR","\\",201],["T_STRING","Magento",201],["T_NS_SEPARATOR","\\",201],["T_STRING","Framework",201],["T_NS_SEPARATOR","\\",201],["T_STRING","Backup",201],["T_NS_SEPARATOR","\\",201],["T_STRING","Db",201],["T_DOUBLE_COLON","::",201],["T_CLASS","class",201],")",";",["T_WHITESPACE","\n        ",201],["T_VARIABLE","$dbBackup",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","setRootDir",202],"(",["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","directoryList",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","getRoot",202],"(",")",")",";",["T_WHITESPACE","\n        ",202],["T_IF","if",203],["T_WHITESPACE"," ",203],"(","!",["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","file",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","isExists",203],"(",["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","backupsDir",203],")",")",["T_WHITESPACE"," ",203],"{",["T_WHITESPACE","\n            ",203],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","file",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","createDirectory",204],"(",["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","backupsDir",204],")",";",["T_WHITESPACE","\n        ",204],"}",["T_WHITESPACE","\n        ",205],["T_VARIABLE","$dbBackup",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","setBackupsDir",206],"(",["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","backupsDir",206],")",";",["T_WHITESPACE","\n        ",206],["T_VARIABLE","$dbBackup",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","setBackupExtension",207],"(",["T_CONSTANT_ENCAPSED_STRING","'sql'",207],")",";",["T_WHITESPACE","\n        ",207],["T_VARIABLE","$dbBackup",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","setTime",208],"(",["T_VARIABLE","$time",208],")",";",["T_WHITESPACE","\n        ",208],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","log",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","log",209],"(",["T_CONSTANT_ENCAPSED_STRING","'DB backup is starting...'",209],")",";",["T_WHITESPACE","\n        ",209],["T_VARIABLE","$dbBackup",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","create",210],"(",")",";",["T_WHITESPACE","\n        ",210],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","log",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","log",211],"(",["T_CONSTANT_ENCAPSED_STRING","'DB backup filename: '",211],["T_WHITESPACE"," ",211],".",["T_WHITESPACE"," ",211],["T_VARIABLE","$dbBackup",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","getBackupFilename",211],"(",")",")",";",["T_WHITESPACE","\n        ",211],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","log",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","log",212],"(",["T_CONSTANT_ENCAPSED_STRING","'DB backup path: '",212],["T_WHITESPACE"," ",212],".",["T_WHITESPACE"," ",212],["T_VARIABLE","$dbBackup",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","getBackupPath",212],"(",")",")",";",["T_WHITESPACE","\n        ",212],["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","log",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","logSuccess",213],"(",["T_CONSTANT_ENCAPSED_STRING","'DB backup completed successfully.'",213],")",";",["T_WHITESPACE","\n        ",213],["T_RETURN","return",214],["T_WHITESPACE"," ",214],["T_VARIABLE","$dbBackup",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","getBackupPath",214],"(",")",";",["T_WHITESPACE","\n    ",214],"}",["T_WHITESPACE","\n\n    ",215],["T_DOC_COMMENT","\/**\n     * Roll back database\n     *\n     * @param string $rollbackFile\n     * @return void\n     * @throws LocalizedException\n     *\/",217],["T_WHITESPACE","\n    ",223],["T_PUBLIC","public",224],["T_WHITESPACE"," ",224],["T_FUNCTION","function",224],["T_WHITESPACE"," ",224],["T_STRING","dbRollback",224],"(",["T_VARIABLE","$rollbackFile",224],")",["T_WHITESPACE","\n    ",224],"{",["T_WHITESPACE","\n        ",225],["T_IF","if",226],["T_WHITESPACE"," ",226],"(",["T_STRING","preg_match",226],"(",["T_CONSTANT_ENCAPSED_STRING","'\/[0-9]_(db)(.*?).(sql)$\/'",226],",",["T_WHITESPACE"," ",226],["T_VARIABLE","$rollbackFile",226],")",["T_WHITESPACE"," ",226],["T_IS_NOT_IDENTICAL","!==",226],["T_WHITESPACE"," ",226],["T_LNUMBER","1",226],")",["T_WHITESPACE"," ",226],"{",["T_WHITESPACE","\n            ",226],["T_THROW","throw",227],["T_WHITESPACE"," ",227],["T_NEW","new",227],["T_WHITESPACE"," ",227],["T_STRING","LocalizedException",227],"(",["T_NEW","new",227],["T_WHITESPACE"," ",227],["T_STRING","Phrase",227],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid rollback file.'",227],")",")",";",["T_WHITESPACE","\n        ",227],"}",["T_WHITESPACE","\n        ",228],["T_IF","if",229],["T_WHITESPACE"," ",229],"(","!",["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","file",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","isExists",229],"(",["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","backupsDir",229],["T_WHITESPACE"," ",229],".",["T_WHITESPACE"," ",229],["T_CONSTANT_ENCAPSED_STRING","'\/'",229],["T_WHITESPACE"," ",229],".",["T_WHITESPACE"," ",229],["T_VARIABLE","$rollbackFile",229],")",")",["T_WHITESPACE"," ",229],"{",["T_WHITESPACE","\n            ",229],["T_THROW","throw",230],["T_WHITESPACE"," ",230],["T_NEW","new",230],["T_WHITESPACE"," ",230],["T_STRING","LocalizedException",230],"(",["T_NEW","new",230],["T_WHITESPACE"," ",230],["T_STRING","Phrase",230],"(",["T_CONSTANT_ENCAPSED_STRING","'The rollback file does not exist.'",230],")",")",";",["T_WHITESPACE","\n        ",230],"}",["T_WHITESPACE","\n        ",231],["T_DOC_COMMENT","\/** @var \\Magento\\Framework\\Backup\\Db $dbRollback *\/",232],["T_WHITESPACE","\n        ",232],["T_VARIABLE","$dbRollback",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","objectManager",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","create",233],"(",["T_NS_SEPARATOR","\\",233],["T_STRING","Magento",233],["T_NS_SEPARATOR","\\",233],["T_STRING","Framework",233],["T_NS_SEPARATOR","\\",233],["T_STRING","Backup",233],["T_NS_SEPARATOR","\\",233],["T_STRING","Db",233],["T_DOUBLE_COLON","::",233],["T_CLASS","class",233],")",";",["T_WHITESPACE","\n        ",233],["T_VARIABLE","$dbRollback",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","setRootDir",234],"(",["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","directoryList",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","getRoot",234],"(",")",")",";",["T_WHITESPACE","\n        ",234],["T_VARIABLE","$dbRollback",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","setBackupsDir",235],"(",["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","backupsDir",235],")",";",["T_WHITESPACE","\n        ",235],["T_VARIABLE","$dbRollback",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","setBackupExtension",236],"(",["T_CONSTANT_ENCAPSED_STRING","'sql'",236],")",";",["T_WHITESPACE","\n        ",236],["T_VARIABLE","$time",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_STRING","explode",237],"(",["T_CONSTANT_ENCAPSED_STRING","'_'",237],",",["T_WHITESPACE"," ",237],["T_VARIABLE","$rollbackFile",237],")",";",["T_WHITESPACE","\n        ",237],["T_IF","if",238],["T_WHITESPACE"," ",238],"(",["T_STRING","count",238],"(",["T_VARIABLE","$time",238],")",["T_WHITESPACE"," ",238],["T_IS_IDENTICAL","===",238],["T_WHITESPACE"," ",238],["T_LNUMBER","3",238],")",["T_WHITESPACE"," ",238],"{",["T_WHITESPACE","\n            ",238],["T_VARIABLE","$thirdPart",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_STRING","explode",239],"(",["T_CONSTANT_ENCAPSED_STRING","'.'",239],",",["T_WHITESPACE"," ",239],["T_VARIABLE","$time",239],"[",["T_LNUMBER","2",239],"]",")",";",["T_WHITESPACE","\n            ",239],["T_VARIABLE","$dbRollback",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","setName",240],"(",["T_VARIABLE","$thirdPart",240],"[",["T_LNUMBER","0",240],"]",")",";",["T_WHITESPACE","\n        ",240],"}",["T_WHITESPACE","\n        ",241],["T_VARIABLE","$dbRollback",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","setTime",242],"(",["T_VARIABLE","$time",242],"[",["T_LNUMBER","0",242],"]",")",";",["T_WHITESPACE","\n        ",242],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","log",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","log",243],"(",["T_CONSTANT_ENCAPSED_STRING","'DB rollback is starting...'",243],")",";",["T_WHITESPACE","\n        ",243],["T_VARIABLE","$dbRollback",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","setResourceModel",244],"(",["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","objectManager",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","create",244],"(",["T_NS_SEPARATOR","\\",244],["T_STRING","Magento",244],["T_NS_SEPARATOR","\\",244],["T_STRING","Backup",244],["T_NS_SEPARATOR","\\",244],["T_STRING","Model",244],["T_NS_SEPARATOR","\\",244],["T_STRING","ResourceModel",244],["T_NS_SEPARATOR","\\",244],["T_STRING","Db",244],["T_DOUBLE_COLON","::",244],["T_CLASS","class",244],")",")",";",["T_WHITESPACE","\n        ",244],["T_VARIABLE","$dbRollback",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","rollback",245],"(",")",";",["T_WHITESPACE","\n        ",245],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","log",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","log",246],"(",["T_CONSTANT_ENCAPSED_STRING","'DB rollback filename: '",246],["T_WHITESPACE"," ",246],".",["T_WHITESPACE"," ",246],["T_VARIABLE","$dbRollback",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","getBackupFilename",246],"(",")",")",";",["T_WHITESPACE","\n        ",246],["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","log",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","log",247],"(",["T_CONSTANT_ENCAPSED_STRING","'DB rollback path: '",247],["T_WHITESPACE"," ",247],".",["T_WHITESPACE"," ",247],["T_VARIABLE","$dbRollback",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","getBackupPath",247],"(",")",")",";",["T_WHITESPACE","\n        ",247],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","log",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","logSuccess",248],"(",["T_CONSTANT_ENCAPSED_STRING","'DB rollback completed successfully.'",248],")",";",["T_WHITESPACE","\n    ",248],"}",["T_WHITESPACE","\n\n    ",249],["T_DOC_COMMENT","\/**\n     * Get paths that should be excluded during iterative searches for locations for code backup only\n     *\n     * @return array\n     *\/",251],["T_WHITESPACE","\n    ",255],["T_PRIVATE","private",256],["T_WHITESPACE"," ",256],["T_FUNCTION","function",256],["T_WHITESPACE"," ",256],["T_STRING","getCodeBackupIgnorePaths",256],"(",")",["T_WHITESPACE","\n    ",256],"{",["T_WHITESPACE","\n        ",257],["T_RETURN","return",258],["T_WHITESPACE"," ",258],"[",["T_WHITESPACE","\n            ",258],["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","directoryList",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","getPath",259],"(",["T_STRING","DirectoryList",259],["T_DOUBLE_COLON","::",259],["T_STRING","MEDIA",259],")",",",["T_WHITESPACE","\n            ",259],["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","directoryList",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","getPath",260],"(",["T_STRING","DirectoryList",260],["T_DOUBLE_COLON","::",260],["T_STRING","STATIC_VIEW",260],")",",",["T_WHITESPACE","\n            ",260],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","directoryList",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","getPath",261],"(",["T_STRING","DirectoryList",261],["T_DOUBLE_COLON","::",261],["T_STRING","VAR_DIR",261],")",",",["T_WHITESPACE","\n            ",261],["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","directoryList",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","getRoot",262],"(",")",["T_WHITESPACE"," ",262],".",["T_WHITESPACE"," ",262],["T_CONSTANT_ENCAPSED_STRING","'\/update'",262],",",["T_WHITESPACE","\n            ",262],["T_VARIABLE","$this",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","directoryList",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","getRoot",263],"(",")",["T_WHITESPACE"," ",263],".",["T_WHITESPACE"," ",263],["T_CONSTANT_ENCAPSED_STRING","'\/node_modules'",263],",",["T_WHITESPACE","\n            ",263],["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","directoryList",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","getRoot",264],"(",")",["T_WHITESPACE"," ",264],".",["T_WHITESPACE"," ",264],["T_CONSTANT_ENCAPSED_STRING","'\/.grunt'",264],",",["T_WHITESPACE","\n            ",264],["T_VARIABLE","$this",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","directoryList",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","getRoot",265],"(",")",["T_WHITESPACE"," ",265],".",["T_WHITESPACE"," ",265],["T_CONSTANT_ENCAPSED_STRING","'\/.idea'",265],",",["T_WHITESPACE","\n            ",265],["T_VARIABLE","$this",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","directoryList",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","getRoot",266],"(",")",["T_WHITESPACE"," ",266],".",["T_WHITESPACE"," ",266],["T_CONSTANT_ENCAPSED_STRING","'\/.svn'",266],",",["T_WHITESPACE","\n            ",266],["T_VARIABLE","$this",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","directoryList",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","getRoot",267],"(",")",["T_WHITESPACE"," ",267],".",["T_WHITESPACE"," ",267],["T_CONSTANT_ENCAPSED_STRING","'\/.git'",267],["T_WHITESPACE","\n        ",267],"]",";",["T_WHITESPACE","\n    ",268],"}",["T_WHITESPACE","\n\n    ",269],["T_DOC_COMMENT","\/**\n     * Get paths that should be excluded during iterative searches for locations for media backup only\n     *\n     * @return array\n     *\/",271],["T_WHITESPACE","\n    ",275],["T_PRIVATE","private",276],["T_WHITESPACE"," ",276],["T_FUNCTION","function",276],["T_WHITESPACE"," ",276],["T_STRING","getMediaBackupIgnorePaths",276],"(",")",["T_WHITESPACE","\n    ",276],"{",["T_WHITESPACE","\n        ",277],["T_VARIABLE","$ignorePaths",278],["T_WHITESPACE"," ",278],"=",["T_WHITESPACE"," ",278],"[","]",";",["T_WHITESPACE","\n        ",278],["T_FOREACH","foreach",279],["T_WHITESPACE"," ",279],"(",["T_NEW","new",279],["T_WHITESPACE"," ",279],["T_NS_SEPARATOR","\\",279],["T_STRING","DirectoryIterator",279],"(",["T_VARIABLE","$this",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","directoryList",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","getRoot",279],"(",")",")",["T_WHITESPACE"," ",279],["T_AS","as",279],["T_WHITESPACE"," ",279],["T_VARIABLE","$item",279],")",["T_WHITESPACE"," ",279],"{",["T_WHITESPACE","\n            ",279],["T_IF","if",280],["T_WHITESPACE"," ",280],"(","!",["T_VARIABLE","$item",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","isDot",280],"(",")",["T_WHITESPACE"," ",280],["T_BOOLEAN_AND","&&",280],["T_WHITESPACE"," ",280],"(",["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","directoryList",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","getPath",280],"(",["T_STRING","DirectoryList",280],["T_DOUBLE_COLON","::",280],["T_STRING","PUB",280],")",["T_WHITESPACE"," ",280],["T_IS_NOT_IDENTICAL","!==",280],["T_WHITESPACE"," ",280],["T_VARIABLE","$item",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","getPathname",280],"(",")",")",")",["T_WHITESPACE"," ",280],"{",["T_WHITESPACE","\n                ",280],["T_VARIABLE","$ignorePaths",281],"[","]",["T_WHITESPACE"," ",281],"=",["T_WHITESPACE"," ",281],["T_STRING","str_replace",281],"(",["T_CONSTANT_ENCAPSED_STRING","'\\\\'",281],",",["T_WHITESPACE"," ",281],["T_CONSTANT_ENCAPSED_STRING","'\/'",281],",",["T_WHITESPACE"," ",281],["T_VARIABLE","$item",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","getPathname",281],"(",")",")",";",["T_WHITESPACE","\n            ",281],"}",["T_WHITESPACE","\n        ",282],"}",["T_WHITESPACE","\n        ",283],["T_FOREACH","foreach",284],["T_WHITESPACE"," ",284],"(",["T_NEW","new",284],["T_WHITESPACE"," ",284],["T_NS_SEPARATOR","\\",284],["T_STRING","DirectoryIterator",284],"(",["T_VARIABLE","$this",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","directoryList",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","getPath",284],"(",["T_STRING","DirectoryList",284],["T_DOUBLE_COLON","::",284],["T_STRING","PUB",284],")",")",["T_WHITESPACE"," ",284],["T_AS","as",284],["T_WHITESPACE"," ",284],["T_VARIABLE","$item",284],")",["T_WHITESPACE"," ",284],"{",["T_WHITESPACE","\n            ",284],["T_IF","if",285],["T_WHITESPACE"," ",285],"(","!",["T_VARIABLE","$item",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","isDot",285],"(",")",["T_WHITESPACE"," ",285],["T_BOOLEAN_AND","&&",285],["T_WHITESPACE"," ",285],"(",["T_VARIABLE","$this",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","directoryList",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","getPath",285],"(",["T_STRING","DirectoryList",285],["T_DOUBLE_COLON","::",285],["T_STRING","MEDIA",285],")",["T_WHITESPACE"," ",285],["T_IS_NOT_IDENTICAL","!==",285],["T_WHITESPACE"," ",285],["T_VARIABLE","$item",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","getPathname",285],"(",")",")",")",["T_WHITESPACE"," ",285],"{",["T_WHITESPACE","\n                ",285],["T_VARIABLE","$ignorePaths",286],"[","]",["T_WHITESPACE"," ",286],"=",["T_WHITESPACE"," ",286],["T_STRING","str_replace",286],"(",["T_CONSTANT_ENCAPSED_STRING","'\\\\'",286],",",["T_WHITESPACE"," ",286],["T_CONSTANT_ENCAPSED_STRING","'\/'",286],",",["T_WHITESPACE"," ",286],["T_VARIABLE","$item",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","getPathname",286],"(",")",")",";",["T_WHITESPACE","\n            ",286],"}",["T_WHITESPACE","\n        ",287],"}",["T_WHITESPACE","\n        ",288],["T_RETURN","return",289],["T_WHITESPACE"," ",289],["T_VARIABLE","$ignorePaths",289],";",["T_WHITESPACE","\n    ",289],"}",["T_WHITESPACE","\n\n    ",290],["T_DOC_COMMENT","\/**\n     * Get disk availability for filesystem backup\n     *\n     * @param string $type\n     * @return int\n     * @throws LocalizedException\n     *\/",292],["T_WHITESPACE","\n    ",298],["T_PUBLIC","public",299],["T_WHITESPACE"," ",299],["T_FUNCTION","function",299],["T_WHITESPACE"," ",299],["T_STRING","getFSDiskSpace",299],"(",["T_VARIABLE","$type",299],["T_WHITESPACE"," ",299],"=",["T_WHITESPACE"," ",299],["T_STRING","Factory",299],["T_DOUBLE_COLON","::",299],["T_STRING","TYPE_FILESYSTEM",299],")",["T_WHITESPACE","\n    ",299],"{",["T_WHITESPACE","\n        ",300],["T_VARIABLE","$filesystemSize",301],["T_WHITESPACE"," ",301],"=",["T_WHITESPACE"," ",301],["T_LNUMBER","0",301],";",["T_WHITESPACE","\n        ",301],["T_IF","if",302],["T_WHITESPACE"," ",302],"(",["T_VARIABLE","$type",302],["T_WHITESPACE"," ",302],["T_IS_IDENTICAL","===",302],["T_WHITESPACE"," ",302],["T_STRING","Factory",302],["T_DOUBLE_COLON","::",302],["T_STRING","TYPE_FILESYSTEM",302],")",["T_WHITESPACE"," ",302],"{",["T_WHITESPACE","\n            ",302],["T_VARIABLE","$ignorePaths",303],["T_WHITESPACE"," ",303],"=",["T_WHITESPACE"," ",303],["T_VARIABLE","$this",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","getCodeBackupIgnorePaths",303],"(",")",";",["T_WHITESPACE","\n        ",303],"}",["T_WHITESPACE"," ",304],["T_ELSEIF","elseif",304],["T_WHITESPACE"," ",304],"(",["T_VARIABLE","$type",304],["T_WHITESPACE"," ",304],["T_IS_IDENTICAL","===",304],["T_WHITESPACE"," ",304],["T_STRING","Factory",304],["T_DOUBLE_COLON","::",304],["T_STRING","TYPE_MEDIA",304],")",["T_WHITESPACE"," ",304],"{",["T_WHITESPACE","\n            ",304],["T_VARIABLE","$ignorePaths",305],["T_WHITESPACE"," ",305],"=",["T_WHITESPACE"," ",305],["T_VARIABLE","$this",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","getMediaBackupIgnorePaths",305],"(",")",";",["T_WHITESPACE","\n        ",305],"}",["T_WHITESPACE"," ",306],["T_ELSE","else",306],["T_WHITESPACE"," ",306],"{",["T_WHITESPACE","\n            ",306],["T_THROW","throw",307],["T_WHITESPACE"," ",307],["T_NEW","new",307],["T_WHITESPACE"," ",307],["T_STRING","LocalizedException",307],"(",["T_NEW","new",307],["T_WHITESPACE"," ",307],["T_STRING","Phrase",307],"(","\"",["T_ENCAPSED_AND_WHITESPACE","This backup type '",307],["T_VARIABLE","$type",307],["T_ENCAPSED_AND_WHITESPACE","' is not supported.",307],"\"",")",")",";",["T_WHITESPACE","\n        ",307],"}",["T_WHITESPACE","\n        ",308],["T_VARIABLE","$filesInfo",309],["T_WHITESPACE"," ",309],"=",["T_WHITESPACE"," ",309],["T_VARIABLE","$this",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","fsHelper",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","getInfo",309],"(",["T_WHITESPACE","\n            ",309],["T_VARIABLE","$this",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","directoryList",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","getRoot",310],"(",")",",",["T_WHITESPACE","\n            ",310],["T_STRING","Helper",311],["T_DOUBLE_COLON","::",311],["T_STRING","INFO_SIZE",311],",",["T_WHITESPACE","\n            ",311],["T_VARIABLE","$ignorePaths",312],["T_WHITESPACE","\n        ",312],")",";",["T_WHITESPACE","\n        ",313],["T_IF","if",314],["T_WHITESPACE"," ",314],"(",["T_VARIABLE","$filesInfo",314],"[",["T_CONSTANT_ENCAPSED_STRING","'size'",314],"]",")",["T_WHITESPACE"," ",314],"{",["T_WHITESPACE","\n            ",314],["T_VARIABLE","$filesystemSize",315],["T_WHITESPACE"," ",315],"=",["T_WHITESPACE"," ",315],["T_VARIABLE","$filesInfo",315],"[",["T_CONSTANT_ENCAPSED_STRING","'size'",315],"]",";",["T_WHITESPACE","\n        ",315],"}",["T_WHITESPACE","\n        ",316],["T_RETURN","return",317],["T_WHITESPACE"," ",317],["T_VARIABLE","$filesystemSize",317],";",["T_WHITESPACE","\n    ",317],"}",["T_WHITESPACE","\n\n    ",318],["T_DOC_COMMENT","\/**\n     * Get disk availability for database backup\n     *\n     * @return int\n     * @throws LocalizedException\n     *\/",320],["T_WHITESPACE","\n    ",325],["T_PUBLIC","public",326],["T_WHITESPACE"," ",326],["T_FUNCTION","function",326],["T_WHITESPACE"," ",326],["T_STRING","getDBDiskSpace",326],"(",")",["T_WHITESPACE","\n    ",326],"{",["T_WHITESPACE","\n        ",327],["T_DOC_COMMENT","\/** @var \\Magento\\Framework\\Backup\\Db $dbBackup *\/",328],["T_WHITESPACE","\n        ",328],["T_VARIABLE","$dbBackup",329],["T_WHITESPACE"," ",329],"=",["T_WHITESPACE"," ",329],["T_VARIABLE","$this",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","objectManager",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","create",329],"(",["T_NS_SEPARATOR","\\",329],["T_STRING","Magento",329],["T_NS_SEPARATOR","\\",329],["T_STRING","Framework",329],["T_NS_SEPARATOR","\\",329],["T_STRING","Backup",329],["T_NS_SEPARATOR","\\",329],["T_STRING","Db",329],["T_DOUBLE_COLON","::",329],["T_CLASS","class",329],")",";",["T_WHITESPACE","\n        ",329],["T_RETURN","return",330],["T_WHITESPACE"," ",330],["T_VARIABLE","$dbBackup",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","getDBSize",330],"(",")",";",["T_WHITESPACE","\n    ",330],"}",["T_WHITESPACE","\n",331],"}",["T_WHITESPACE","\n",332]]