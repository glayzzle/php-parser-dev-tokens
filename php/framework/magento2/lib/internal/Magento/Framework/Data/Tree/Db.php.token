[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Framework",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Data",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Tree",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Data DB tree\n *\n * Data model:\n * id  |  pid  |  level | order\n *\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",8],["T_WHITESPACE","\n",15],["T_CLASS","class",16],["T_WHITESPACE"," ",16],["T_STRING","Db",16],["T_WHITESPACE"," ",16],["T_EXTENDS","extends",16],["T_WHITESPACE"," ",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Magento",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Framework",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Data",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Tree",16],["T_WHITESPACE","\n",16],"{",["T_WHITESPACE","\n    ",17],["T_CONST","const",18],["T_WHITESPACE"," ",18],["T_STRING","ID_FIELD",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],["T_CONSTANT_ENCAPSED_STRING","'id'",18],";",["T_WHITESPACE","\n\n    ",18],["T_CONST","const",20],["T_WHITESPACE"," ",20],["T_STRING","PARENT_FIELD",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_CONSTANT_ENCAPSED_STRING","'parent'",20],";",["T_WHITESPACE","\n\n    ",20],["T_CONST","const",22],["T_WHITESPACE"," ",22],["T_STRING","LEVEL_FIELD",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'level'",22],";",["T_WHITESPACE","\n\n    ",22],["T_CONST","const",24],["T_WHITESPACE"," ",24],["T_STRING","ORDER_FIELD",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","'order'",24],";",["T_WHITESPACE","\n\n    ",24],["T_DOC_COMMENT","\/**\n     * DB connection\n     *\n     * @var \\Magento\\Framework\\DB\\Adapter\\AdapterInterface\n     *\/",26],["T_WHITESPACE","\n    ",30],["T_PROTECTED","protected",31],["T_WHITESPACE"," ",31],["T_VARIABLE","$_conn",31],";",["T_WHITESPACE","\n\n    ",31],["T_DOC_COMMENT","\/**\n     * Data table name\n     *\n     * @var string\n     *\/",33],["T_WHITESPACE","\n    ",37],["T_PROTECTED","protected",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$_table",38],";",["T_WHITESPACE","\n\n    ",38],["T_DOC_COMMENT","\/**\n     * SQL select object\n     *\n     * @var \\Magento\\Framework\\DB\\Select\n     *\/",40],["T_WHITESPACE","\n    ",44],["T_PROTECTED","protected",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$_select",45],";",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * Tree structure field name: _idField\n     *\n     * @var string\n     *\/",47],["T_WHITESPACE","\n    ",51],["T_PROTECTED","protected",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$_idField",52],";",["T_WHITESPACE","\n\n    ",52],["T_DOC_COMMENT","\/**\n     * Tree structure field name: _parentField\n     *\n     * @var string\n     *\/",54],["T_WHITESPACE","\n    ",58],["T_PROTECTED","protected",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$_parentField",59],";",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * Tree structure field name: _levelField\n     *\n     * @var string\n     *\/",61],["T_WHITESPACE","\n    ",65],["T_PROTECTED","protected",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$_levelField",66],";",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * Tree structure field name: _orderField\n     *\n     * @var string\n     *\/",68],["T_WHITESPACE","\n    ",72],["T_PROTECTED","protected",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$_orderField",73],";",["T_WHITESPACE","\n\n    ",73],["T_DOC_COMMENT","\/**\n     * Db tree constructor\n     *\n     * $fields = array(\n     *      \\Magento\\Framework\\Data\\Tree\\Db::ID_FIELD       => string,\n     *      \\Magento\\Framework\\Data\\Tree\\Db::PARENT_FIELD   => string,\n     *      \\Magento\\Framework\\Data\\Tree\\Db::LEVEL_FIELD    => string\n     *      \\Magento\\Framework\\Data\\Tree\\Db::ORDER_FIELD    => string\n     * )\n     *\n     * @param \\Magento\\Framework\\DB\\Adapter\\AdapterInterface $connection\n     * @param string $table\n     * @param array $fields\n     * @throws \\Exception\n     *\/",75],["T_WHITESPACE","\n    ",89],["T_PUBLIC","public",90],["T_WHITESPACE"," ",90],["T_FUNCTION","function",90],["T_WHITESPACE"," ",90],["T_STRING","__construct",90],"(",["T_NS_SEPARATOR","\\",90],["T_STRING","Magento",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Framework",90],["T_NS_SEPARATOR","\\",90],["T_STRING","DB",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Adapter",90],["T_NS_SEPARATOR","\\",90],["T_STRING","AdapterInterface",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$connection",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$table",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$fields",90],")",["T_WHITESPACE","\n    ",90],"{",["T_WHITESPACE","\n        ",91],["T_STRING","parent",92],["T_DOUBLE_COLON","::",92],["T_STRING","__construct",92],"(",")",";",["T_WHITESPACE","\n\n        ",92],["T_IF","if",94],["T_WHITESPACE"," ",94],"(","!",["T_VARIABLE","$connection",94],")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n            ",94],["T_THROW","throw",95],["T_WHITESPACE"," ",95],["T_NEW","new",95],["T_WHITESPACE"," ",95],["T_NS_SEPARATOR","\\",95],["T_STRING","Exception",95],"(",["T_CONSTANT_ENCAPSED_STRING","'Wrong \"$connection\" parametr'",95],")",";",["T_WHITESPACE","\n        ",95],"}",["T_WHITESPACE","\n\n        ",96],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","_conn",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$connection",98],";",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","_table",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_VARIABLE","$table",99],";",["T_WHITESPACE","\n\n        ",99],["T_IF","if",101],["T_WHITESPACE"," ",101],"(","!",["T_ISSET","isset",101],"(",["T_WHITESPACE","\n            ",101],["T_VARIABLE","$fields",102],"[",["T_STRING","self",102],["T_DOUBLE_COLON","::",102],["T_STRING","ID_FIELD",102],"]",["T_WHITESPACE","\n        ",102],")",["T_WHITESPACE"," ",103],["T_BOOLEAN_OR","||",103],["T_WHITESPACE"," ",103],"!",["T_ISSET","isset",103],"(",["T_WHITESPACE","\n            ",103],["T_VARIABLE","$fields",104],"[",["T_STRING","self",104],["T_DOUBLE_COLON","::",104],["T_STRING","PARENT_FIELD",104],"]",["T_WHITESPACE","\n        ",104],")",["T_WHITESPACE"," ",105],["T_BOOLEAN_OR","||",105],["T_WHITESPACE"," ",105],"!",["T_ISSET","isset",105],"(",["T_WHITESPACE","\n            ",105],["T_VARIABLE","$fields",106],"[",["T_STRING","self",106],["T_DOUBLE_COLON","::",106],["T_STRING","LEVEL_FIELD",106],"]",["T_WHITESPACE","\n        ",106],")",["T_WHITESPACE"," ",107],["T_BOOLEAN_OR","||",107],["T_WHITESPACE"," ",107],"!",["T_ISSET","isset",107],"(",["T_WHITESPACE","\n            ",107],["T_VARIABLE","$fields",108],"[",["T_STRING","self",108],["T_DOUBLE_COLON","::",108],["T_STRING","ORDER_FIELD",108],"]",["T_WHITESPACE","\n        ",108],")",["T_WHITESPACE","\n        ",109],")",["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n            ",110],["T_THROW","throw",111],["T_WHITESPACE"," ",111],["T_NEW","new",111],["T_WHITESPACE"," ",111],["T_NS_SEPARATOR","\\",111],["T_STRING","Exception",111],"(",["T_CONSTANT_ENCAPSED_STRING","'\"$fields\" tree configuratin array'",111],")",";",["T_WHITESPACE","\n        ",111],"}",["T_WHITESPACE","\n\n        ",112],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","_idField",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_VARIABLE","$fields",114],"[",["T_STRING","self",114],["T_DOUBLE_COLON","::",114],["T_STRING","ID_FIELD",114],"]",";",["T_WHITESPACE","\n        ",114],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","_parentField",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$fields",115],"[",["T_STRING","self",115],["T_DOUBLE_COLON","::",115],["T_STRING","PARENT_FIELD",115],"]",";",["T_WHITESPACE","\n        ",115],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","_levelField",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_VARIABLE","$fields",116],"[",["T_STRING","self",116],["T_DOUBLE_COLON","::",116],["T_STRING","LEVEL_FIELD",116],"]",";",["T_WHITESPACE","\n        ",116],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","_orderField",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_VARIABLE","$fields",117],"[",["T_STRING","self",117],["T_DOUBLE_COLON","::",117],["T_STRING","ORDER_FIELD",117],"]",";",["T_WHITESPACE","\n\n        ",117],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_select",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_conn",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","select",119],"(",")",";",["T_WHITESPACE","\n        ",119],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","_select",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","from",120],"(",["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","_table",120],",",["T_WHITESPACE"," ",120],["T_STRING","array_values",120],"(",["T_VARIABLE","$fields",120],")",")",";",["T_WHITESPACE","\n    ",120],"}",["T_WHITESPACE","\n\n    ",121],["T_DOC_COMMENT","\/**\n     * @return \\Magento\\Framework\\DB\\Select\n     *\/",123],["T_WHITESPACE","\n    ",125],["T_PUBLIC","public",126],["T_WHITESPACE"," ",126],["T_FUNCTION","function",126],["T_WHITESPACE"," ",126],["T_STRING","getDbSelect",126],"(",")",["T_WHITESPACE","\n    ",126],"{",["T_WHITESPACE","\n        ",127],["T_RETURN","return",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","_select",128],";",["T_WHITESPACE","\n    ",128],"}",["T_WHITESPACE","\n\n    ",129],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\DB\\Select $select\n     * @return void\n     *\/",131],["T_WHITESPACE","\n    ",134],["T_PUBLIC","public",135],["T_WHITESPACE"," ",135],["T_FUNCTION","function",135],["T_WHITESPACE"," ",135],["T_STRING","setDbSelect",135],"(",["T_VARIABLE","$select",135],")",["T_WHITESPACE","\n    ",135],"{",["T_WHITESPACE","\n        ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","_select",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_VARIABLE","$select",137],";",["T_WHITESPACE","\n    ",137],"}",["T_WHITESPACE","\n\n    ",138],["T_DOC_COMMENT","\/**\n     * Load tree\n     *\n     * @param   int|Node $parentNode\n     * @param   int $recursionLevel recursion level\n     * @return  $this\n     * @throws \\Exception\n     *\/",140],["T_WHITESPACE","\n    ",147],["T_PUBLIC","public",148],["T_WHITESPACE"," ",148],["T_FUNCTION","function",148],["T_WHITESPACE"," ",148],["T_STRING","load",148],"(",["T_VARIABLE","$parentNode",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_STRING","null",148],",",["T_WHITESPACE"," ",148],["T_VARIABLE","$recursionLevel",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_LNUMBER","100",148],")",["T_WHITESPACE","\n    ",148],"{",["T_WHITESPACE","\n        ",149],["T_IF","if",150],["T_WHITESPACE"," ",150],"(",["T_VARIABLE","$parentNode",150],["T_WHITESPACE"," ",150],["T_IS_IDENTICAL","===",150],["T_WHITESPACE"," ",150],["T_STRING","null",150],")",["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n            ",150],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","_loadFullTree",151],"(",")",";",["T_WHITESPACE","\n            ",151],["T_RETURN","return",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],";",["T_WHITESPACE","\n        ",152],"}",["T_WHITESPACE"," ",153],["T_ELSEIF","elseif",153],["T_WHITESPACE"," ",153],"(",["T_VARIABLE","$parentNode",153],["T_WHITESPACE"," ",153],["T_INSTANCEOF","instanceof",153],["T_WHITESPACE"," ",153],["T_STRING","Node",153],")",["T_WHITESPACE"," ",153],"{",["T_WHITESPACE","\n            ",153],["T_VARIABLE","$parentId",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_VARIABLE","$parentNode",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","getId",154],"(",")",";",["T_WHITESPACE","\n        ",154],"}",["T_WHITESPACE"," ",155],["T_ELSEIF","elseif",155],["T_WHITESPACE"," ",155],"(",["T_STRING","is_numeric",155],"(",["T_VARIABLE","$parentNode",155],")",")",["T_WHITESPACE"," ",155],"{",["T_WHITESPACE","\n            ",155],["T_VARIABLE","$parentId",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_VARIABLE","$parentNode",156],";",["T_WHITESPACE","\n            ",156],["T_VARIABLE","$parentNode",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_STRING","null",157],";",["T_WHITESPACE","\n        ",157],"}",["T_WHITESPACE"," ",158],["T_ELSE","else",158],["T_WHITESPACE"," ",158],"{",["T_WHITESPACE","\n            ",158],["T_THROW","throw",159],["T_WHITESPACE"," ",159],["T_NEW","new",159],["T_WHITESPACE"," ",159],["T_NS_SEPARATOR","\\",159],["T_STRING","Exception",159],"(",["T_CONSTANT_ENCAPSED_STRING","'root node id is not defined'",159],")",";",["T_WHITESPACE","\n        ",159],"}",["T_WHITESPACE","\n\n        ",160],["T_VARIABLE","$select",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_CLONE","clone",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","_select",162],";",["T_WHITESPACE","\n        ",162],["T_VARIABLE","$select",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","order",163],"(",["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","_table",163],["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","'.'",163],["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","_orderField",163],["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","' ASC'",163],")",";",["T_WHITESPACE","\n        ",163],["T_VARIABLE","$condition",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","_conn",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","quoteInto",164],"(","\"",["T_CURLY_OPEN","{",164],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","_table",164],"}",["T_ENCAPSED_AND_WHITESPACE",".",164],["T_CURLY_OPEN","{",164],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","_parentField",164],"}",["T_ENCAPSED_AND_WHITESPACE","=?",164],"\"",",",["T_WHITESPACE"," ",164],["T_VARIABLE","$parentId",164],")",";",["T_WHITESPACE","\n        ",164],["T_VARIABLE","$select",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","where",165],"(",["T_VARIABLE","$condition",165],")",";",["T_WHITESPACE","\n        ",165],["T_VARIABLE","$arrNodes",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","_conn",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","fetchAll",166],"(",["T_VARIABLE","$select",166],")",";",["T_WHITESPACE","\n        ",166],["T_FOREACH","foreach",167],["T_WHITESPACE"," ",167],"(",["T_VARIABLE","$arrNodes",167],["T_WHITESPACE"," ",167],["T_AS","as",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$nodeInfo",167],")",["T_WHITESPACE"," ",167],"{",["T_WHITESPACE","\n            ",167],["T_VARIABLE","$node",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_NEW","new",168],["T_WHITESPACE"," ",168],["T_STRING","Node",168],"(",["T_VARIABLE","$nodeInfo",168],",",["T_WHITESPACE"," ",168],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","_idField",168],",",["T_WHITESPACE"," ",168],["T_VARIABLE","$this",168],",",["T_WHITESPACE"," ",168],["T_VARIABLE","$parentNode",168],")",";",["T_WHITESPACE","\n            ",168],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","addNode",169],"(",["T_VARIABLE","$node",169],",",["T_WHITESPACE"," ",169],["T_VARIABLE","$parentNode",169],")",";",["T_WHITESPACE","\n\n            ",169],["T_IF","if",171],["T_WHITESPACE"," ",171],"(",["T_VARIABLE","$recursionLevel",171],")",["T_WHITESPACE"," ",171],"{",["T_WHITESPACE","\n                ",171],["T_VARIABLE","$node",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","loadChildren",172],"(",["T_VARIABLE","$recursionLevel",172],["T_WHITESPACE"," ",172],"-",["T_WHITESPACE"," ",172],["T_LNUMBER","1",172],")",";",["T_WHITESPACE","\n            ",172],"}",["T_WHITESPACE","\n        ",173],"}",["T_WHITESPACE","\n        ",174],["T_RETURN","return",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],";",["T_WHITESPACE","\n    ",175],"}",["T_WHITESPACE","\n\n    ",176],["T_DOC_COMMENT","\/**\n     * @param mixed $nodeId\n     * @return Node\n     *\/",178],["T_WHITESPACE","\n    ",181],["T_PUBLIC","public",182],["T_WHITESPACE"," ",182],["T_FUNCTION","function",182],["T_WHITESPACE"," ",182],["T_STRING","loadNode",182],"(",["T_VARIABLE","$nodeId",182],")",["T_WHITESPACE","\n    ",182],"{",["T_WHITESPACE","\n        ",183],["T_VARIABLE","$select",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_CLONE","clone",184],["T_WHITESPACE"," ",184],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","_select",184],";",["T_WHITESPACE","\n        ",184],["T_VARIABLE","$condition",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","_conn",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","quoteInto",185],"(","\"",["T_CURLY_OPEN","{",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","_table",185],"}",["T_ENCAPSED_AND_WHITESPACE",".",185],["T_CURLY_OPEN","{",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","_idField",185],"}",["T_ENCAPSED_AND_WHITESPACE","=?",185],"\"",",",["T_WHITESPACE"," ",185],["T_VARIABLE","$nodeId",185],")",";",["T_WHITESPACE","\n        ",185],["T_VARIABLE","$select",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","where",186],"(",["T_VARIABLE","$condition",186],")",";",["T_WHITESPACE","\n        ",186],["T_VARIABLE","$node",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_NEW","new",187],["T_WHITESPACE"," ",187],["T_STRING","Node",187],"(",["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","_conn",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","fetchRow",187],"(",["T_VARIABLE","$select",187],")",",",["T_WHITESPACE"," ",187],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","_idField",187],",",["T_WHITESPACE"," ",187],["T_VARIABLE","$this",187],")",";",["T_WHITESPACE","\n        ",187],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","addNode",188],"(",["T_VARIABLE","$node",188],")",";",["T_WHITESPACE","\n        ",188],["T_RETURN","return",189],["T_WHITESPACE"," ",189],["T_VARIABLE","$node",189],";",["T_WHITESPACE","\n    ",189],"}",["T_WHITESPACE","\n\n    ",190],["T_DOC_COMMENT","\/**\n     * @param Node $data\n     * @param Node $parentNode\n     * @param Node $prevNode\n     * @return Node\n     *\/",192],["T_WHITESPACE","\n    ",197],["T_PUBLIC","public",198],["T_WHITESPACE"," ",198],["T_FUNCTION","function",198],["T_WHITESPACE"," ",198],["T_STRING","appendChild",198],"(",["T_VARIABLE","$data",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$parentNode",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$prevNode",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_STRING","null",198],")",["T_WHITESPACE","\n    ",198],"{",["T_WHITESPACE","\n        ",199],["T_VARIABLE","$orderSelect",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","_conn",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","select",200],"(",")",";",["T_WHITESPACE","\n        ",200],["T_VARIABLE","$orderSelect",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","from",201],"(",["T_WHITESPACE","\n            ",201],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","_table",202],",",["T_WHITESPACE","\n            ",202],["T_NEW","new",203],["T_WHITESPACE"," ",203],["T_NS_SEPARATOR","\\",203],["T_STRING","Zend_Db_Expr",203],"(",["T_CONSTANT_ENCAPSED_STRING","'MAX('",203],["T_WHITESPACE"," ",203],".",["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","_conn",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","quoteIdentifier",203],"(",["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","_orderField",203],")",["T_WHITESPACE"," ",203],".",["T_WHITESPACE"," ",203],["T_CONSTANT_ENCAPSED_STRING","')'",203],")",["T_WHITESPACE","\n        ",203],")",["T_OBJECT_OPERATOR","->",204],["T_STRING","where",204],"(",["T_WHITESPACE","\n            ",204],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","_conn",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","quoteIdentifier",205],"(",["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","_parentField",205],")",["T_WHITESPACE"," ",205],".",["T_WHITESPACE"," ",205],["T_CONSTANT_ENCAPSED_STRING","'='",205],["T_WHITESPACE"," ",205],".",["T_WHITESPACE"," ",205],["T_VARIABLE","$parentNode",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","getId",205],"(",")",["T_WHITESPACE","\n        ",205],")",";",["T_WHITESPACE","\n\n        ",206],["T_VARIABLE","$order",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","_conn",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","fetchOne",208],"(",["T_VARIABLE","$orderSelect",208],")",";",["T_WHITESPACE","\n        ",208],["T_VARIABLE","$data",209],"[",["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","_parentField",209],"]",["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_VARIABLE","$parentNode",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","getId",209],"(",")",";",["T_WHITESPACE","\n        ",209],["T_VARIABLE","$data",210],"[",["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","_levelField",210],"]",["T_WHITESPACE"," ",210],"=",["T_WHITESPACE"," ",210],["T_VARIABLE","$parentNode",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","getData",210],"(",["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","_levelField",210],")",["T_WHITESPACE"," ",210],"+",["T_WHITESPACE"," ",210],["T_LNUMBER","1",210],";",["T_WHITESPACE","\n        ",210],["T_VARIABLE","$data",211],"[",["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","_orderField",211],"]",["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_VARIABLE","$order",211],["T_WHITESPACE"," ",211],"+",["T_WHITESPACE"," ",211],["T_LNUMBER","1",211],";",["T_WHITESPACE","\n\n        ",211],["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","_conn",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","insert",213],"(",["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","_table",213],",",["T_WHITESPACE"," ",213],["T_VARIABLE","$data",213],")",";",["T_WHITESPACE","\n        ",213],["T_VARIABLE","$data",214],"[",["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","_idField",214],"]",["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","_conn",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","lastInsertId",214],"(",")",";",["T_WHITESPACE","\n\n        ",214],["T_RETURN","return",216],["T_WHITESPACE"," ",216],["T_STRING","parent",216],["T_DOUBLE_COLON","::",216],["T_STRING","appendChild",216],"(",["T_VARIABLE","$data",216],",",["T_WHITESPACE"," ",216],["T_VARIABLE","$parentNode",216],",",["T_WHITESPACE"," ",216],["T_VARIABLE","$prevNode",216],")",";",["T_WHITESPACE","\n    ",216],"}",["T_WHITESPACE","\n\n    ",217],["T_DOC_COMMENT","\/**\n     * Move tree node\n     *\n     * @param Node $node\n     * @param Node $parentNode\n     * @param Node $prevNode\n     * @return void\n     * @throws \\Exception\n     *\/",219],["T_WHITESPACE","\n    ",227],["T_PUBLIC","public",228],["T_WHITESPACE"," ",228],["T_FUNCTION","function",228],["T_WHITESPACE"," ",228],["T_STRING","moveNodeTo",228],"(",["T_VARIABLE","$node",228],",",["T_WHITESPACE"," ",228],["T_VARIABLE","$parentNode",228],",",["T_WHITESPACE"," ",228],["T_VARIABLE","$prevNode",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],["T_STRING","null",228],")",["T_WHITESPACE","\n    ",228],"{",["T_WHITESPACE","\n        ",229],["T_VARIABLE","$data",230],["T_WHITESPACE"," ",230],"=",["T_WHITESPACE"," ",230],"[","]",";",["T_WHITESPACE","\n        ",230],["T_VARIABLE","$data",231],"[",["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","_parentField",231],"]",["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],["T_VARIABLE","$parentNode",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","getId",231],"(",")",";",["T_WHITESPACE","\n        ",231],["T_VARIABLE","$data",232],"[",["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","_levelField",232],"]",["T_WHITESPACE"," ",232],"=",["T_WHITESPACE"," ",232],["T_VARIABLE","$parentNode",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","getData",232],"(",["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","_levelField",232],")",["T_WHITESPACE"," ",232],"+",["T_WHITESPACE"," ",232],["T_LNUMBER","1",232],";",["T_WHITESPACE","\n        ",232],["T_COMMENT","\/\/ New node order\n",233],["T_WHITESPACE","        ",234],["T_IF","if",234],["T_WHITESPACE"," ",234],"(",["T_VARIABLE","$prevNode",234],["T_WHITESPACE"," ",234],["T_IS_IDENTICAL","===",234],["T_WHITESPACE"," ",234],["T_STRING","null",234],["T_WHITESPACE"," ",234],["T_BOOLEAN_OR","||",234],["T_WHITESPACE"," ",234],["T_VARIABLE","$prevNode",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","getData",234],"(",["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","_orderField",234],")",["T_WHITESPACE"," ",234],["T_IS_IDENTICAL","===",234],["T_WHITESPACE"," ",234],["T_STRING","null",234],")",["T_WHITESPACE"," ",234],"{",["T_WHITESPACE","\n            ",234],["T_VARIABLE","$data",235],"[",["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","_orderField",235],"]",["T_WHITESPACE"," ",235],"=",["T_WHITESPACE"," ",235],["T_LNUMBER","1",235],";",["T_WHITESPACE","\n        ",235],"}",["T_WHITESPACE"," ",236],["T_ELSE","else",236],["T_WHITESPACE"," ",236],"{",["T_WHITESPACE","\n            ",236],["T_VARIABLE","$data",237],"[",["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","_orderField",237],"]",["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_VARIABLE","$prevNode",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","getData",237],"(",["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","_orderField",237],")",["T_WHITESPACE"," ",237],"+",["T_WHITESPACE"," ",237],["T_LNUMBER","1",237],";",["T_WHITESPACE","\n        ",237],"}",["T_WHITESPACE","\n        ",238],["T_VARIABLE","$condition",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","_conn",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","quoteInto",239],"(","\"",["T_CURLY_OPEN","{",239],["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","_idField",239],"}",["T_ENCAPSED_AND_WHITESPACE","=?",239],"\"",",",["T_WHITESPACE"," ",239],["T_VARIABLE","$node",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","getId",239],"(",")",")",";",["T_WHITESPACE","\n\n        ",239],["T_COMMENT","\/\/ For reorder new node branch\n",241],["T_WHITESPACE","        ",242],["T_VARIABLE","$dataReorderNew",242],["T_WHITESPACE"," ",242],"=",["T_WHITESPACE"," ",242],"[",["T_WHITESPACE","\n            ",242],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","_orderField",243],["T_WHITESPACE"," ",243],["T_DOUBLE_ARROW","=>",243],["T_WHITESPACE"," ",243],["T_NEW","new",243],["T_WHITESPACE"," ",243],["T_NS_SEPARATOR","\\",243],["T_STRING","Zend_Db_Expr",243],"(",["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","_conn",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","quoteIdentifier",243],"(",["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","_orderField",243],")",["T_WHITESPACE"," ",243],".",["T_WHITESPACE"," ",243],["T_CONSTANT_ENCAPSED_STRING","'+1'",243],")",",",["T_WHITESPACE","\n        ",243],"]",";",["T_WHITESPACE","\n        ",244],["T_VARIABLE","$conditionReorderNew",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","_conn",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","quoteIdentifier",245],"(",["T_WHITESPACE","\n            ",245],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","_parentField",246],["T_WHITESPACE","\n        ",246],")",["T_WHITESPACE"," ",247],".",["T_WHITESPACE"," ",247],["T_CONSTANT_ENCAPSED_STRING","'='",247],["T_WHITESPACE"," ",247],".",["T_WHITESPACE"," ",247],["T_VARIABLE","$parentNode",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","getId",247],"(",")",["T_WHITESPACE"," ",247],".",["T_WHITESPACE"," ",247],["T_CONSTANT_ENCAPSED_STRING","' AND '",247],["T_WHITESPACE"," ",247],".",["T_WHITESPACE"," ",247],["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","_conn",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","quoteIdentifier",247],"(",["T_WHITESPACE","\n            ",247],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","_orderField",248],["T_WHITESPACE","\n        ",248],")",["T_WHITESPACE"," ",249],".",["T_WHITESPACE"," ",249],["T_CONSTANT_ENCAPSED_STRING","'>='",249],["T_WHITESPACE"," ",249],".",["T_WHITESPACE"," ",249],["T_VARIABLE","$data",249],"[",["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","_orderField",249],"]",";",["T_WHITESPACE","\n\n        ",249],["T_COMMENT","\/\/ For reorder old node branch\n",251],["T_WHITESPACE","        ",252],["T_VARIABLE","$dataReorderOld",252],["T_WHITESPACE"," ",252],"=",["T_WHITESPACE"," ",252],"[",["T_WHITESPACE","\n            ",252],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","_orderField",253],["T_WHITESPACE"," ",253],["T_DOUBLE_ARROW","=>",253],["T_WHITESPACE"," ",253],["T_NEW","new",253],["T_WHITESPACE"," ",253],["T_NS_SEPARATOR","\\",253],["T_STRING","Zend_Db_Expr",253],"(",["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","_conn",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","quoteIdentifier",253],"(",["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","_orderField",253],")",["T_WHITESPACE"," ",253],".",["T_WHITESPACE"," ",253],["T_CONSTANT_ENCAPSED_STRING","'-1'",253],")",",",["T_WHITESPACE","\n        ",253],"]",";",["T_WHITESPACE","\n        ",254],["T_VARIABLE","$conditionReorderOld",255],["T_WHITESPACE"," ",255],"=",["T_WHITESPACE"," ",255],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","_conn",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","quoteIdentifier",255],"(",["T_WHITESPACE","\n            ",255],["T_VARIABLE","$this",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","_parentField",256],["T_WHITESPACE","\n        ",256],")",["T_WHITESPACE"," ",257],".",["T_WHITESPACE"," ",257],["T_CONSTANT_ENCAPSED_STRING","'='",257],["T_WHITESPACE"," ",257],".",["T_WHITESPACE"," ",257],["T_VARIABLE","$node",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","getData",257],"(",["T_WHITESPACE","\n            ",257],["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","_parentField",258],["T_WHITESPACE","\n        ",258],")",["T_WHITESPACE"," ",259],".",["T_WHITESPACE"," ",259],["T_CONSTANT_ENCAPSED_STRING","' AND '",259],["T_WHITESPACE"," ",259],".",["T_WHITESPACE"," ",259],["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","_conn",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","quoteIdentifier",259],"(",["T_WHITESPACE","\n            ",259],["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","_orderField",260],["T_WHITESPACE","\n        ",260],")",["T_WHITESPACE"," ",261],".",["T_WHITESPACE"," ",261],["T_CONSTANT_ENCAPSED_STRING","'>'",261],["T_WHITESPACE"," ",261],".",["T_WHITESPACE"," ",261],["T_VARIABLE","$node",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","getData",261],"(",["T_WHITESPACE","\n            ",261],["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","_orderField",262],["T_WHITESPACE","\n        ",262],")",";",["T_WHITESPACE","\n\n        ",263],["T_VARIABLE","$this",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","_conn",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","beginTransaction",265],"(",")",";",["T_WHITESPACE","\n        ",265],["T_TRY","try",266],["T_WHITESPACE"," ",266],"{",["T_WHITESPACE","\n            ",266],["T_COMMENT","\/\/ Prepare new node branch\n",267],["T_WHITESPACE","            ",268],["T_VARIABLE","$this",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","_conn",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","update",268],"(",["T_VARIABLE","$this",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","_table",268],",",["T_WHITESPACE"," ",268],["T_VARIABLE","$dataReorderNew",268],",",["T_WHITESPACE"," ",268],["T_VARIABLE","$conditionReorderNew",268],")",";",["T_WHITESPACE","\n            ",268],["T_COMMENT","\/\/ Move node\n",269],["T_WHITESPACE","            ",270],["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","_conn",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","update",270],"(",["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","_table",270],",",["T_WHITESPACE"," ",270],["T_VARIABLE","$data",270],",",["T_WHITESPACE"," ",270],["T_VARIABLE","$condition",270],")",";",["T_WHITESPACE","\n            ",270],["T_COMMENT","\/\/ Update old node branch\n",271],["T_WHITESPACE","            ",272],["T_VARIABLE","$this",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","_conn",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","update",272],"(",["T_VARIABLE","$this",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","_table",272],",",["T_WHITESPACE"," ",272],["T_VARIABLE","$dataReorderOld",272],",",["T_WHITESPACE"," ",272],["T_VARIABLE","$conditionReorderOld",272],")",";",["T_WHITESPACE","\n            ",272],["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","_updateChildLevels",273],"(",["T_VARIABLE","$node",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","getId",273],"(",")",",",["T_WHITESPACE"," ",273],["T_VARIABLE","$data",273],"[",["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","_levelField",273],"]",")",";",["T_WHITESPACE","\n            ",273],["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","_conn",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","commit",274],"(",")",";",["T_WHITESPACE","\n        ",274],"}",["T_WHITESPACE"," ",275],["T_CATCH","catch",275],["T_WHITESPACE"," ",275],"(",["T_NS_SEPARATOR","\\",275],["T_STRING","Exception",275],["T_WHITESPACE"," ",275],["T_VARIABLE","$e",275],")",["T_WHITESPACE"," ",275],"{",["T_WHITESPACE","\n            ",275],["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","_conn",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","rollBack",276],"(",")",";",["T_WHITESPACE","\n            ",276],["T_THROW","throw",277],["T_WHITESPACE"," ",277],["T_NEW","new",277],["T_WHITESPACE"," ",277],["T_NS_SEPARATOR","\\",277],["T_STRING","Exception",277],"(",["T_CONSTANT_ENCAPSED_STRING","'Can\\'t move tree node'",277],")",";",["T_WHITESPACE","\n        ",277],"}",["T_WHITESPACE","\n    ",278],"}",["T_WHITESPACE","\n\n    ",279],["T_DOC_COMMENT","\/**\n     * @param mixed $parentId\n     * @param int $parentLevel\n     * @return $this\n     *\/",281],["T_WHITESPACE","\n    ",285],["T_PROTECTED","protected",286],["T_WHITESPACE"," ",286],["T_FUNCTION","function",286],["T_WHITESPACE"," ",286],["T_STRING","_updateChildLevels",286],"(",["T_VARIABLE","$parentId",286],",",["T_WHITESPACE"," ",286],["T_VARIABLE","$parentLevel",286],")",["T_WHITESPACE","\n    ",286],"{",["T_WHITESPACE","\n        ",287],["T_VARIABLE","$select",288],["T_WHITESPACE"," ",288],"=",["T_WHITESPACE"," ",288],["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","_conn",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","select",288],"(",")",["T_OBJECT_OPERATOR","->",288],["T_STRING","from",288],"(",["T_WHITESPACE","\n            ",288],["T_VARIABLE","$this",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","_table",289],",",["T_WHITESPACE","\n            ",289],["T_VARIABLE","$this",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","_idField",290],["T_WHITESPACE","\n        ",290],")",["T_OBJECT_OPERATOR","->",291],["T_STRING","where",291],"(",["T_WHITESPACE","\n            ",291],["T_VARIABLE","$this",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","_parentField",292],["T_WHITESPACE"," ",292],".",["T_WHITESPACE"," ",292],["T_CONSTANT_ENCAPSED_STRING","'=?'",292],",",["T_WHITESPACE","\n            ",292],["T_VARIABLE","$parentId",293],["T_WHITESPACE","\n        ",293],")",";",["T_WHITESPACE","\n        ",294],["T_VARIABLE","$ids",295],["T_WHITESPACE"," ",295],"=",["T_WHITESPACE"," ",295],["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","_conn",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","fetchCol",295],"(",["T_VARIABLE","$select",295],")",";",["T_WHITESPACE","\n\n        ",295],["T_IF","if",297],["T_WHITESPACE"," ",297],"(","!",["T_EMPTY","empty",297],"(",["T_VARIABLE","$ids",297],")",")",["T_WHITESPACE"," ",297],"{",["T_WHITESPACE","\n            ",297],["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","_conn",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","update",298],"(",["T_WHITESPACE","\n                ",298],["T_VARIABLE","$this",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","_table",299],",",["T_WHITESPACE","\n                ",299],"[",["T_VARIABLE","$this",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","_levelField",300],["T_WHITESPACE"," ",300],["T_DOUBLE_ARROW","=>",300],["T_WHITESPACE"," ",300],["T_VARIABLE","$parentLevel",300],["T_WHITESPACE"," ",300],"+",["T_WHITESPACE"," ",300],["T_LNUMBER","1",300],"]",",",["T_WHITESPACE","\n                ",300],["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","_conn",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","quoteInto",301],"(",["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","_idField",301],["T_WHITESPACE"," ",301],".",["T_WHITESPACE"," ",301],["T_CONSTANT_ENCAPSED_STRING","' IN (?)'",301],",",["T_WHITESPACE"," ",301],["T_VARIABLE","$ids",301],")",["T_WHITESPACE","\n            ",301],")",";",["T_WHITESPACE","\n            ",302],["T_FOREACH","foreach",303],["T_WHITESPACE"," ",303],"(",["T_VARIABLE","$ids",303],["T_WHITESPACE"," ",303],["T_AS","as",303],["T_WHITESPACE"," ",303],["T_VARIABLE","$id",303],")",["T_WHITESPACE"," ",303],"{",["T_WHITESPACE","\n                ",303],["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","_updateChildLevels",304],"(",["T_VARIABLE","$id",304],",",["T_WHITESPACE"," ",304],["T_VARIABLE","$parentLevel",304],["T_WHITESPACE"," ",304],"+",["T_WHITESPACE"," ",304],["T_LNUMBER","1",304],")",";",["T_WHITESPACE","\n            ",304],"}",["T_WHITESPACE","\n        ",305],"}",["T_WHITESPACE","\n        ",306],["T_RETURN","return",307],["T_WHITESPACE"," ",307],["T_VARIABLE","$this",307],";",["T_WHITESPACE","\n    ",307],"}",["T_WHITESPACE","\n\n    ",308],["T_DOC_COMMENT","\/**\n     * @return $this\n     *\/",310],["T_WHITESPACE","\n    ",312],["T_PROTECTED","protected",313],["T_WHITESPACE"," ",313],["T_FUNCTION","function",313],["T_WHITESPACE"," ",313],["T_STRING","_loadFullTree",313],"(",")",["T_WHITESPACE","\n    ",313],"{",["T_WHITESPACE","\n        ",314],["T_VARIABLE","$select",315],["T_WHITESPACE"," ",315],"=",["T_WHITESPACE"," ",315],["T_CLONE","clone",315],["T_WHITESPACE"," ",315],["T_VARIABLE","$this",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","_select",315],";",["T_WHITESPACE","\n        ",315],["T_VARIABLE","$select",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","order",316],"(",["T_VARIABLE","$this",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","_table",316],["T_WHITESPACE"," ",316],".",["T_WHITESPACE"," ",316],["T_CONSTANT_ENCAPSED_STRING","'.'",316],["T_WHITESPACE"," ",316],".",["T_WHITESPACE"," ",316],["T_VARIABLE","$this",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","_levelField",316],")",["T_OBJECT_OPERATOR","->",316],["T_STRING","order",316],"(",["T_VARIABLE","$this",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","_table",316],["T_WHITESPACE"," ",316],".",["T_WHITESPACE"," ",316],["T_CONSTANT_ENCAPSED_STRING","'.'",316],["T_WHITESPACE"," ",316],".",["T_WHITESPACE"," ",316],["T_VARIABLE","$this",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","_orderField",316],")",";",["T_WHITESPACE","\n\n        ",316],["T_VARIABLE","$arrNodes",318],["T_WHITESPACE"," ",318],"=",["T_WHITESPACE"," ",318],["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","_conn",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","fetchAll",318],"(",["T_VARIABLE","$select",318],")",";",["T_WHITESPACE","\n\n        ",318],["T_FOREACH","foreach",320],["T_WHITESPACE"," ",320],"(",["T_VARIABLE","$arrNodes",320],["T_WHITESPACE"," ",320],["T_AS","as",320],["T_WHITESPACE"," ",320],["T_VARIABLE","$nodeInfo",320],")",["T_WHITESPACE"," ",320],"{",["T_WHITESPACE","\n            ",320],["T_VARIABLE","$node",321],["T_WHITESPACE"," ",321],"=",["T_WHITESPACE"," ",321],["T_NEW","new",321],["T_WHITESPACE"," ",321],["T_STRING","Node",321],"(",["T_VARIABLE","$nodeInfo",321],",",["T_WHITESPACE"," ",321],["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","_idField",321],",",["T_WHITESPACE"," ",321],["T_VARIABLE","$this",321],")",";",["T_WHITESPACE","\n            ",321],["T_VARIABLE","$parentNode",322],["T_WHITESPACE"," ",322],"=",["T_WHITESPACE"," ",322],["T_VARIABLE","$this",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","getNodeById",322],"(",["T_VARIABLE","$nodeInfo",322],"[",["T_VARIABLE","$this",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","_parentField",322],"]",")",";",["T_WHITESPACE","\n            ",322],["T_VARIABLE","$this",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","addNode",323],"(",["T_VARIABLE","$node",323],",",["T_WHITESPACE"," ",323],["T_VARIABLE","$parentNode",323],")",";",["T_WHITESPACE","\n        ",323],"}",["T_WHITESPACE","\n\n        ",324],["T_RETURN","return",326],["T_WHITESPACE"," ",326],["T_VARIABLE","$this",326],";",["T_WHITESPACE","\n    ",326],"}",["T_WHITESPACE","\n\n    ",327],["T_DOC_COMMENT","\/**\n     * @param Node $node\n     * @return $this\n     * @throws \\Exception\n     *\/",329],["T_WHITESPACE","\n    ",333],["T_PUBLIC","public",334],["T_WHITESPACE"," ",334],["T_FUNCTION","function",334],["T_WHITESPACE"," ",334],["T_STRING","removeNode",334],"(",["T_VARIABLE","$node",334],")",["T_WHITESPACE","\n    ",334],"{",["T_WHITESPACE","\n        ",335],["T_COMMENT","\/\/ For reorder old node branch\n",336],["T_WHITESPACE","        ",337],["T_VARIABLE","$dataReorderOld",337],["T_WHITESPACE"," ",337],"=",["T_WHITESPACE"," ",337],"[",["T_WHITESPACE","\n            ",337],["T_VARIABLE","$this",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","_orderField",338],["T_WHITESPACE"," ",338],["T_DOUBLE_ARROW","=>",338],["T_WHITESPACE"," ",338],["T_NEW","new",338],["T_WHITESPACE"," ",338],["T_NS_SEPARATOR","\\",338],["T_STRING","Zend_Db_Expr",338],"(",["T_VARIABLE","$this",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","_conn",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","quoteIdentifier",338],"(",["T_VARIABLE","$this",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","_orderField",338],")",["T_WHITESPACE"," ",338],".",["T_WHITESPACE"," ",338],["T_CONSTANT_ENCAPSED_STRING","'-1'",338],")",",",["T_WHITESPACE","\n        ",338],"]",";",["T_WHITESPACE","\n        ",339],["T_VARIABLE","$conditionReorderOld",340],["T_WHITESPACE"," ",340],"=",["T_WHITESPACE"," ",340],["T_VARIABLE","$this",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","_conn",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","quoteIdentifier",340],"(",["T_WHITESPACE","\n            ",340],["T_VARIABLE","$this",341],["T_OBJECT_OPERATOR","->",341],["T_STRING","_parentField",341],["T_WHITESPACE","\n        ",341],")",["T_WHITESPACE"," ",342],".",["T_WHITESPACE"," ",342],["T_CONSTANT_ENCAPSED_STRING","'='",342],["T_WHITESPACE"," ",342],".",["T_WHITESPACE"," ",342],["T_VARIABLE","$node",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","getData",342],"(",["T_WHITESPACE","\n            ",342],["T_VARIABLE","$this",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","_parentField",343],["T_WHITESPACE","\n        ",343],")",["T_WHITESPACE"," ",344],".",["T_WHITESPACE"," ",344],["T_CONSTANT_ENCAPSED_STRING","' AND '",344],["T_WHITESPACE"," ",344],".",["T_WHITESPACE"," ",344],["T_VARIABLE","$this",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","_conn",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","quoteIdentifier",344],"(",["T_WHITESPACE","\n            ",344],["T_VARIABLE","$this",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","_orderField",345],["T_WHITESPACE","\n        ",345],")",["T_WHITESPACE"," ",346],".",["T_WHITESPACE"," ",346],["T_CONSTANT_ENCAPSED_STRING","'>'",346],["T_WHITESPACE"," ",346],".",["T_WHITESPACE"," ",346],["T_VARIABLE","$node",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","getData",346],"(",["T_WHITESPACE","\n            ",346],["T_VARIABLE","$this",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","_orderField",347],["T_WHITESPACE","\n        ",347],")",";",["T_WHITESPACE","\n\n        ",348],["T_VARIABLE","$this",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","_conn",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","beginTransaction",350],"(",")",";",["T_WHITESPACE","\n        ",350],["T_TRY","try",351],["T_WHITESPACE"," ",351],"{",["T_WHITESPACE","\n            ",351],["T_VARIABLE","$condition",352],["T_WHITESPACE"," ",352],"=",["T_WHITESPACE"," ",352],["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","_conn",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","quoteInto",352],"(","\"",["T_CURLY_OPEN","{",352],["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","_idField",352],"}",["T_ENCAPSED_AND_WHITESPACE","=?",352],"\"",",",["T_WHITESPACE"," ",352],["T_VARIABLE","$node",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","getId",352],"(",")",")",";",["T_WHITESPACE","\n            ",352],["T_VARIABLE","$this",353],["T_OBJECT_OPERATOR","->",353],["T_STRING","_conn",353],["T_OBJECT_OPERATOR","->",353],["T_STRING","delete",353],"(",["T_VARIABLE","$this",353],["T_OBJECT_OPERATOR","->",353],["T_STRING","_table",353],",",["T_WHITESPACE"," ",353],["T_VARIABLE","$condition",353],")",";",["T_WHITESPACE","\n            ",353],["T_COMMENT","\/\/ Update old node branch\n",354],["T_WHITESPACE","            ",355],["T_VARIABLE","$this",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","_conn",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","update",355],"(",["T_VARIABLE","$this",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","_table",355],",",["T_WHITESPACE"," ",355],["T_VARIABLE","$dataReorderOld",355],",",["T_WHITESPACE"," ",355],["T_VARIABLE","$conditionReorderOld",355],")",";",["T_WHITESPACE","\n            ",355],["T_VARIABLE","$this",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","_conn",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","commit",356],"(",")",";",["T_WHITESPACE","\n        ",356],"}",["T_WHITESPACE"," ",357],["T_CATCH","catch",357],["T_WHITESPACE"," ",357],"(",["T_NS_SEPARATOR","\\",357],["T_STRING","Exception",357],["T_WHITESPACE"," ",357],["T_VARIABLE","$e",357],")",["T_WHITESPACE"," ",357],"{",["T_WHITESPACE","\n            ",357],["T_VARIABLE","$this",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","_conn",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","rollBack",358],"(",")",";",["T_WHITESPACE","\n            ",358],["T_THROW","throw",359],["T_WHITESPACE"," ",359],["T_NEW","new",359],["T_WHITESPACE"," ",359],["T_NS_SEPARATOR","\\",359],["T_STRING","Exception",359],"(",["T_CONSTANT_ENCAPSED_STRING","'Can\\'t remove tree node'",359],")",";",["T_WHITESPACE","\n        ",359],"}",["T_WHITESPACE","\n        ",360],["T_STRING","parent",361],["T_DOUBLE_COLON","::",361],["T_STRING","removeNode",361],"(",["T_VARIABLE","$node",361],")",";",["T_WHITESPACE","\n        ",361],["T_RETURN","return",362],["T_WHITESPACE"," ",362],["T_VARIABLE","$this",362],";",["T_WHITESPACE","\n    ",362],"}",["T_WHITESPACE","\n",363],"}",["T_WHITESPACE","\n",364]]