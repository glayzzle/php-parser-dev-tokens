[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_COMMENT","\/\/ @codingStandardsIgnoreFile\n",7],["T_WHITESPACE","\n",8],["T_NAMESPACE","namespace",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Test",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Unit",9],";",["T_WHITESPACE","\n\n",9],["T_CLASS","class",11],["T_WHITESPACE"," ",11],["T_STRING","ShellTest",11],["T_WHITESPACE"," ",11],["T_EXTENDS","extends",11],["T_WHITESPACE"," ",11],["T_NS_SEPARATOR","\\",11],["T_STRING","PHPUnit_Framework_TestCase",11],["T_WHITESPACE","\n",11],"{",["T_WHITESPACE","\n    ",12],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Shell\\CommandRendererInterface|\\PHPUnit_Framework_MockObject_MockObject\n     *\/",13],["T_WHITESPACE","\n    ",15],["T_PROTECTED","protected",16],["T_WHITESPACE"," ",16],["T_VARIABLE","$commandRenderer",16],";",["T_WHITESPACE","\n\n    ",16],["T_DOC_COMMENT","\/**\n     * @var \\Zend_Log|\\PHPUnit_Framework_MockObject_MockObject\n     *\/",18],["T_WHITESPACE","\n    ",20],["T_PROTECTED","protected",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$logger",21],";",["T_WHITESPACE","\n\n    ",21],["T_PROTECTED","protected",23],["T_WHITESPACE"," ",23],["T_FUNCTION","function",23],["T_WHITESPACE"," ",23],["T_STRING","setUp",23],"(",")",["T_WHITESPACE","\n    ",23],"{",["T_WHITESPACE","\n        ",24],["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","logger",25],["T_WHITESPACE"," ",25],"=",["T_WHITESPACE"," ",25],["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","getMockBuilder",25],"(",["T_NS_SEPARATOR","\\",25],["T_STRING","Zend_Log",25],["T_DOUBLE_COLON","::",25],["T_CLASS","class",25],")",["T_WHITESPACE","\n            ",25],["T_OBJECT_OPERATOR","->",26],["T_STRING","setMethods",26],"(","[",["T_CONSTANT_ENCAPSED_STRING","'log'",26],"]",")",["T_WHITESPACE","\n            ",26],["T_OBJECT_OPERATOR","->",27],["T_STRING","disableOriginalConstructor",27],"(",")",["T_WHITESPACE","\n            ",27],["T_OBJECT_OPERATOR","->",28],["T_STRING","getMock",28],"(",")",";",["T_WHITESPACE","\n        ",28],["T_VARIABLE","$this",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","commandRenderer",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_NEW","new",29],["T_WHITESPACE"," ",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Magento",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Framework",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Shell",29],["T_NS_SEPARATOR","\\",29],["T_STRING","CommandRenderer",29],"(",")",";",["T_WHITESPACE","\n    ",29],"}",["T_WHITESPACE","\n\n    ",30],["T_DOC_COMMENT","\/**\n     * Test that a command with input arguments returns an expected result\n     *\n     * @param \\Magento\\Framework\\Shell $shell\n     * @param string $command\n     * @param array $commandArgs\n     * @param string $expectedResult\n     *\/",32],["T_WHITESPACE","\n    ",39],["T_PROTECTED","protected",40],["T_WHITESPACE"," ",40],["T_FUNCTION","function",40],["T_WHITESPACE"," ",40],["T_STRING","_testExecuteCommand",40],"(",["T_NS_SEPARATOR","\\",40],["T_STRING","Magento",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Framework",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Shell",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$shell",40],",",["T_WHITESPACE"," ",40],["T_VARIABLE","$command",40],",",["T_WHITESPACE"," ",40],["T_VARIABLE","$commandArgs",40],",",["T_WHITESPACE"," ",40],["T_VARIABLE","$expectedResult",40],")",["T_WHITESPACE","\n    ",40],"{",["T_WHITESPACE","\n        ",41],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","expectOutputString",42],"(",["T_CONSTANT_ENCAPSED_STRING","''",42],")",";",["T_WHITESPACE","\n        ",42],["T_COMMENT","\/\/ nothing is expected to be ever printed to the standard output\n",43],["T_WHITESPACE","        ",44],["T_VARIABLE","$actualResult",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_VARIABLE","$shell",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","execute",44],"(",["T_VARIABLE","$command",44],",",["T_WHITESPACE"," ",44],["T_VARIABLE","$commandArgs",44],")",";",["T_WHITESPACE","\n        ",44],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","assertEquals",45],"(",["T_VARIABLE","$expectedResult",45],",",["T_WHITESPACE"," ",45],["T_VARIABLE","$actualResult",45],")",";",["T_WHITESPACE","\n    ",45],"}",["T_WHITESPACE","\n\n    ",46],["T_DOC_COMMENT","\/**\n     * @param string $command\n     * @param array $commandArgs\n     * @param string $expectedResult\n     * @dataProvider executeDataProvider\n     *\/",48],["T_WHITESPACE","\n    ",53],["T_PUBLIC","public",54],["T_WHITESPACE"," ",54],["T_FUNCTION","function",54],["T_WHITESPACE"," ",54],["T_STRING","testExecute",54],"(",["T_VARIABLE","$command",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$commandArgs",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$expectedResult",54],")",["T_WHITESPACE","\n    ",54],"{",["T_WHITESPACE","\n        ",55],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","_testExecuteCommand",56],"(",["T_WHITESPACE","\n            ",56],["T_NEW","new",57],["T_WHITESPACE"," ",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Magento",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Framework",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Shell",57],"(",["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","commandRenderer",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","logger",57],")",",",["T_WHITESPACE"," ",57],["T_VARIABLE","$command",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$commandArgs",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$expectedResult",57],["T_WHITESPACE","\n        ",57],")",";",["T_WHITESPACE","\n    ",58],"}",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * @param string $command\n     * @param array $commandArgs\n     * @param string $expectedResult\n     * @param array $expectedLogRecords\n     * @dataProvider executeDataProvider\n     *\/",61],["T_WHITESPACE","\n    ",67],["T_PUBLIC","public",68],["T_WHITESPACE"," ",68],["T_FUNCTION","function",68],["T_WHITESPACE"," ",68],["T_STRING","testExecuteLog",68],"(",["T_VARIABLE","$command",68],",",["T_WHITESPACE"," ",68],["T_VARIABLE","$commandArgs",68],",",["T_WHITESPACE"," ",68],["T_VARIABLE","$expectedResult",68],",",["T_WHITESPACE"," ",68],["T_VARIABLE","$expectedLogRecords",68],")",["T_WHITESPACE","\n    ",68],"{",["T_WHITESPACE","\n        ",69],["T_VARIABLE","$quoteChar",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_STRING","substr",70],"(",["T_STRING","escapeshellarg",70],"(",["T_CONSTANT_ENCAPSED_STRING","' '",70],")",",",["T_WHITESPACE"," ",70],["T_LNUMBER","0",70],",",["T_WHITESPACE"," ",70],["T_LNUMBER","1",70],")",";",["T_WHITESPACE","\n        ",70],["T_COMMENT","\/\/ environment-dependent quote character\n",71],["T_WHITESPACE","        ",72],["T_FOREACH","foreach",72],["T_WHITESPACE"," ",72],"(",["T_VARIABLE","$expectedLogRecords",72],["T_WHITESPACE"," ",72],["T_AS","as",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$logRecordIndex",72],["T_WHITESPACE"," ",72],["T_DOUBLE_ARROW","=>",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$expectedLogMessage",72],")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n            ",72],["T_VARIABLE","$expectedLogMessage",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_STRING","str_replace",73],"(",["T_CONSTANT_ENCAPSED_STRING","'`'",73],",",["T_WHITESPACE"," ",73],["T_VARIABLE","$quoteChar",73],",",["T_WHITESPACE"," ",73],["T_VARIABLE","$expectedLogMessage",73],")",";",["T_WHITESPACE","\n            ",73],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","logger",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","expects",74],"(",["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","at",74],"(",["T_VARIABLE","$logRecordIndex",74],")",")",["T_WHITESPACE","\n                ",74],["T_OBJECT_OPERATOR","->",75],["T_STRING","method",75],"(",["T_CONSTANT_ENCAPSED_STRING","'log'",75],")",["T_WHITESPACE","\n                ",75],["T_OBJECT_OPERATOR","->",76],["T_STRING","with",76],"(",["T_VARIABLE","$expectedLogMessage",76],",",["T_WHITESPACE"," ",76],["T_NS_SEPARATOR","\\",76],["T_STRING","Zend_Log",76],["T_DOUBLE_COLON","::",76],["T_STRING","INFO",76],")",";",["T_WHITESPACE","\n        ",76],"}",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","_testExecuteCommand",78],"(",["T_WHITESPACE","\n            ",78],["T_NEW","new",79],["T_WHITESPACE"," ",79],["T_NS_SEPARATOR","\\",79],["T_STRING","Magento",79],["T_NS_SEPARATOR","\\",79],["T_STRING","Framework",79],["T_NS_SEPARATOR","\\",79],["T_STRING","Shell",79],"(",["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","commandRenderer",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","logger",79],")",",",["T_WHITESPACE","\n            ",79],["T_VARIABLE","$command",80],",",["T_WHITESPACE","\n            ",80],["T_VARIABLE","$commandArgs",81],",",["T_WHITESPACE","\n            ",81],["T_VARIABLE","$expectedResult",82],["T_WHITESPACE","\n        ",82],")",";",["T_WHITESPACE","\n    ",83],"}",["T_WHITESPACE","\n\n    ",84],["T_PUBLIC","public",86],["T_WHITESPACE"," ",86],["T_FUNCTION","function",86],["T_WHITESPACE"," ",86],["T_STRING","executeDataProvider",86],"(",")",["T_WHITESPACE","\n    ",86],"{",["T_WHITESPACE","\n        ",87],["T_COMMENT","\/\/ backtick symbol (`) has to be replaced with environment-dependent quote character\n",88],["T_WHITESPACE","        ",89],["T_RETURN","return",89],["T_WHITESPACE"," ",89],"[",["T_WHITESPACE","\n            ",89],["T_CONSTANT_ENCAPSED_STRING","'STDOUT'",90],["T_WHITESPACE"," ",90],["T_DOUBLE_ARROW","=>",90],["T_WHITESPACE"," ",90],"[",["T_CONSTANT_ENCAPSED_STRING","'php -r %s'",90],",",["T_WHITESPACE"," ",90],"[",["T_CONSTANT_ENCAPSED_STRING","'echo 27181;'",90],"]",",",["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'27181'",90],",",["T_WHITESPACE"," ",90],"[",["T_CONSTANT_ENCAPSED_STRING","'php -r `echo 27181;` 2>&1'",90],",",["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'27181'",90],"]","]",",",["T_WHITESPACE","\n            ",90],["T_CONSTANT_ENCAPSED_STRING","'STDERR'",91],["T_WHITESPACE"," ",91],["T_DOUBLE_ARROW","=>",91],["T_WHITESPACE"," ",91],"[",["T_WHITESPACE","\n                ",91],["T_CONSTANT_ENCAPSED_STRING","'php -r %s'",92],",",["T_WHITESPACE","\n                ",92],"[",["T_CONSTANT_ENCAPSED_STRING","'fwrite(STDERR, 27182);'",93],"]",",",["T_WHITESPACE","\n                ",93],["T_CONSTANT_ENCAPSED_STRING","'27182'",94],",",["T_WHITESPACE","\n                ",94],"[",["T_CONSTANT_ENCAPSED_STRING","'php -r `fwrite(STDERR, 27182);` 2>&1'",95],",",["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","'27182'",95],"]",",",["T_WHITESPACE","\n            ",95],"]",",",["T_WHITESPACE","\n            ",96],["T_CONSTANT_ENCAPSED_STRING","'piping STDERR -> STDOUT'",97],["T_WHITESPACE"," ",97],["T_DOUBLE_ARROW","=>",97],["T_WHITESPACE"," ",97],"[",["T_WHITESPACE","\n                ",97],["T_COMMENT","\/\/ intentionally no spaces around the pipe symbol\n",98],["T_WHITESPACE","                ",99],["T_CONSTANT_ENCAPSED_STRING","'php -r %s|php -r %s'",99],",",["T_WHITESPACE","\n                ",99],"[",["T_CONSTANT_ENCAPSED_STRING","'fwrite(STDERR, 27183);'",100],",",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","'echo fgets(STDIN);'",100],"]",",",["T_WHITESPACE","\n                ",100],["T_CONSTANT_ENCAPSED_STRING","'27183'",101],",",["T_WHITESPACE","\n                ",101],"[",["T_CONSTANT_ENCAPSED_STRING","'php -r `fwrite(STDERR, 27183);` 2>&1|php -r `echo fgets(STDIN);` 2>&1'",102],",",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'27183'",102],"]",",",["T_WHITESPACE","\n            ",102],"]",",",["T_WHITESPACE","\n            ",103],["T_CONSTANT_ENCAPSED_STRING","'piping STDERR -> STDERR'",104],["T_WHITESPACE"," ",104],["T_DOUBLE_ARROW","=>",104],["T_WHITESPACE"," ",104],"[",["T_WHITESPACE","\n                ",104],["T_CONSTANT_ENCAPSED_STRING","'php -r %s | php -r %s'",105],",",["T_WHITESPACE","\n                ",105],"[",["T_CONSTANT_ENCAPSED_STRING","'fwrite(STDERR, 27184);'",106],",",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'fwrite(STDERR, fgets(STDIN));'",106],"]",",",["T_WHITESPACE","\n                ",106],["T_CONSTANT_ENCAPSED_STRING","'27184'",107],",",["T_WHITESPACE","\n                ",107],"[",["T_CONSTANT_ENCAPSED_STRING","'php -r `fwrite(STDERR, 27184);` 2>&1 | php -r `fwrite(STDERR, fgets(STDIN));` 2>&1'",108],",",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'27184'",108],"]",",",["T_WHITESPACE","\n            ",108],"]",["T_WHITESPACE","\n        ",109],"]",";",["T_WHITESPACE","\n    ",110],"}",["T_WHITESPACE","\n\n    ",111],["T_DOC_COMMENT","\/**\n     * @expectedException \\Magento\\Framework\\Exception\\LocalizedException\n     * @expectedExceptionMessage Command returned non-zero exit code:\n     * @expectedExceptionCode 0\n     *\/",113],["T_WHITESPACE","\n    ",117],["T_PUBLIC","public",118],["T_WHITESPACE"," ",118],["T_FUNCTION","function",118],["T_WHITESPACE"," ",118],["T_STRING","testExecuteFailure",118],"(",")",["T_WHITESPACE","\n    ",118],"{",["T_WHITESPACE","\n        ",119],["T_VARIABLE","$shell",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_NEW","new",120],["T_WHITESPACE"," ",120],["T_NS_SEPARATOR","\\",120],["T_STRING","Magento",120],["T_NS_SEPARATOR","\\",120],["T_STRING","Framework",120],["T_NS_SEPARATOR","\\",120],["T_STRING","Shell",120],"(",["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","commandRenderer",120],",",["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","logger",120],")",";",["T_WHITESPACE","\n        ",120],["T_VARIABLE","$shell",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","execute",121],"(",["T_CONSTANT_ENCAPSED_STRING","'non_existing_command'",121],")",";",["T_WHITESPACE","\n    ",121],"}",["T_WHITESPACE","\n\n    ",122],["T_DOC_COMMENT","\/**\n     * @param string $command\n     * @param array $commandArgs\n     * @param string $expectedError\n     * @dataProvider executeDataProvider\n     *\/",124],["T_WHITESPACE","\n    ",129],["T_PUBLIC","public",130],["T_WHITESPACE"," ",130],["T_FUNCTION","function",130],["T_WHITESPACE"," ",130],["T_STRING","testExecuteFailureDetails",130],"(",["T_VARIABLE","$command",130],",",["T_WHITESPACE"," ",130],["T_VARIABLE","$commandArgs",130],",",["T_WHITESPACE"," ",130],["T_VARIABLE","$expectedError",130],")",["T_WHITESPACE","\n    ",130],"{",["T_WHITESPACE","\n        ",131],["T_TRY","try",132],["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n            ",132],["T_COMMENT","\/* Force command to return non-zero exit code *\/",133],["T_WHITESPACE","\n            ",133],["T_VARIABLE","$commandArgs",134],"[",["T_STRING","count",134],"(",["T_VARIABLE","$commandArgs",134],")",["T_WHITESPACE"," ",134],"-",["T_WHITESPACE"," ",134],["T_LNUMBER","1",134],"]",["T_WHITESPACE"," ",134],["T_CONCAT_EQUAL",".=",134],["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","' exit(42);'",134],";",["T_WHITESPACE","\n            ",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","testExecute",135],"(",["T_VARIABLE","$command",135],",",["T_WHITESPACE"," ",135],["T_VARIABLE","$commandArgs",135],",",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","''",135],")",";",["T_WHITESPACE"," ",135],["T_COMMENT","\/\/ no result is expected in a case of a command failure\n",135],["T_WHITESPACE","        ",136],"}",["T_WHITESPACE"," ",136],["T_CATCH","catch",136],["T_WHITESPACE"," ",136],"(",["T_NS_SEPARATOR","\\",136],["T_STRING","Magento",136],["T_NS_SEPARATOR","\\",136],["T_STRING","Framework",136],["T_NS_SEPARATOR","\\",136],["T_STRING","Exception",136],["T_NS_SEPARATOR","\\",136],["T_STRING","LocalizedException",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$e",136],")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n            ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","assertInstanceOf",137],"(",["T_CONSTANT_ENCAPSED_STRING","'Exception'",137],",",["T_WHITESPACE"," ",137],["T_VARIABLE","$e",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","getPrevious",137],"(",")",")",";",["T_WHITESPACE","\n            ",137],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","assertEquals",138],"(",["T_VARIABLE","$expectedError",138],",",["T_WHITESPACE"," ",138],["T_VARIABLE","$e",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","getPrevious",138],"(",")",["T_OBJECT_OPERATOR","->",138],["T_STRING","getMessage",138],"(",")",")",";",["T_WHITESPACE","\n            ",138],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","assertEquals",139],"(",["T_LNUMBER","42",139],",",["T_WHITESPACE"," ",139],["T_VARIABLE","$e",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getPrevious",139],"(",")",["T_OBJECT_OPERATOR","->",139],["T_STRING","getCode",139],"(",")",")",";",["T_WHITESPACE","\n        ",139],"}",["T_WHITESPACE","\n    ",140],"}",["T_WHITESPACE","\n",141],"}",["T_WHITESPACE","\n",142]]