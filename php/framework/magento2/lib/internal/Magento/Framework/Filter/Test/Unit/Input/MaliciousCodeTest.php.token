[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Framework",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Filter",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Test",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Unit",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Input",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Filter",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Input",9],["T_NS_SEPARATOR","\\",9],["T_STRING","MaliciousCode",9],";",["T_WHITESPACE","\n\n",9],["T_CLASS","class",11],["T_WHITESPACE"," ",11],["T_STRING","MaliciousCodeTest",11],["T_WHITESPACE"," ",11],["T_EXTENDS","extends",11],["T_WHITESPACE"," ",11],["T_NS_SEPARATOR","\\",11],["T_STRING","PHPUnit_Framework_TestCase",11],["T_WHITESPACE","\n",11],"{",["T_WHITESPACE","\n    ",12],["T_DOC_COMMENT","\/** @var \\Magento\\Framework\\Filter\\Input\\MaliciousCode *\/",13],["T_WHITESPACE","\n    ",13],["T_PROTECTED","protected",14],["T_WHITESPACE"," ",14],["T_VARIABLE","$filter",14],";",["T_WHITESPACE","\n\n    ",14],["T_PROTECTED","protected",16],["T_WHITESPACE"," ",16],["T_FUNCTION","function",16],["T_WHITESPACE"," ",16],["T_STRING","setUp",16],"(",")",["T_WHITESPACE","\n    ",16],"{",["T_WHITESPACE","\n        ",17],["T_VARIABLE","$this",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","filter",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],["T_NEW","new",18],["T_WHITESPACE"," ",18],["T_STRING","MaliciousCode",18],"(",")",";",["T_WHITESPACE","\n        ",18],["T_STRING","parent",19],["T_DOUBLE_COLON","::",19],["T_STRING","setUp",19],"(",")",";",["T_WHITESPACE","\n    ",19],"}",["T_WHITESPACE","\n\n    ",20],["T_DOC_COMMENT","\/**\n     * @param string|string[] $input\n     * @param string|string[] $expectedOutput\n     * @dataProvider filterDataProvider\n     *\/",22],["T_WHITESPACE","\n    ",26],["T_PUBLIC","public",27],["T_WHITESPACE"," ",27],["T_FUNCTION","function",27],["T_WHITESPACE"," ",27],["T_STRING","testFilter",27],"(",["T_VARIABLE","$input",27],",",["T_WHITESPACE"," ",27],["T_VARIABLE","$expectedOutput",27],")",["T_WHITESPACE","\n    ",27],"{",["T_WHITESPACE","\n        ",28],["T_VARIABLE","$this",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","assertEquals",29],"(",["T_WHITESPACE","\n            ",29],["T_VARIABLE","$expectedOutput",30],",",["T_WHITESPACE","\n            ",30],["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","filter",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","filter",31],"(",["T_VARIABLE","$input",31],")",",",["T_WHITESPACE","\n            ",31],["T_CONSTANT_ENCAPSED_STRING","'Malicious code is not filtered out correctly.'",32],["T_WHITESPACE","\n        ",32],")",";",["T_WHITESPACE","\n    ",33],"}",["T_WHITESPACE","\n\n    ",34],["T_PUBLIC","public",36],["T_WHITESPACE"," ",36],["T_FUNCTION","function",36],["T_WHITESPACE"," ",36],["T_STRING","filterDataProvider",36],"(",")",["T_WHITESPACE","\n    ",36],"{",["T_WHITESPACE","\n        ",37],["T_RETURN","return",38],["T_WHITESPACE"," ",38],"[",["T_WHITESPACE","\n            ",38],["T_CONSTANT_ENCAPSED_STRING","'Comments'",39],["T_WHITESPACE"," ",39],["T_DOUBLE_ARROW","=>",39],["T_WHITESPACE"," ",39],"[",["T_CONSTANT_ENCAPSED_STRING","'Comment \/** This is omitted *\/ is removed'",39],",",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'Comment  is removed'",39],"]",",",["T_WHITESPACE","\n            ",39],["T_CONSTANT_ENCAPSED_STRING","'Tabs'",40],["T_WHITESPACE"," ",40],["T_DOUBLE_ARROW","=>",40],["T_WHITESPACE"," ",40],"[",["T_CONSTANT_ENCAPSED_STRING","\"Tabs \\t\\t are removed\"",40],",",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'Tabs  are removed'",40],"]",",",["T_WHITESPACE","\n            ",40],["T_CONSTANT_ENCAPSED_STRING","'JS'",41],["T_WHITESPACE"," ",41],["T_DOUBLE_ARROW","=>",41],["T_WHITESPACE"," ",41],"[",["T_CONSTANT_ENCAPSED_STRING","'JS JavaScript    : is removed'",41],",",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'JS  is removed'",41],"]",",",["T_WHITESPACE","\n            ",41],["T_CONSTANT_ENCAPSED_STRING","'Import'",42],["T_WHITESPACE"," ",42],["T_DOUBLE_ARROW","=>",42],["T_WHITESPACE"," ",42],"[",["T_CONSTANT_ENCAPSED_STRING","'Import @import directive is removed'",42],",",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'Import  directive is removed'",42],"]",",",["T_WHITESPACE","\n            ",42],["T_CONSTANT_ENCAPSED_STRING","'JS in styles (array of strings to be filtered)'",43],["T_WHITESPACE"," ",43],["T_DOUBLE_ARROW","=>",43],["T_WHITESPACE"," ",43],"[",["T_WHITESPACE","\n                ",43],"[",["T_WHITESPACE","\n                    ",44],["T_CONSTANT_ENCAPSED_STRING","'<element style=\"behavior:url(malicious.example.com)\"><\/element>'",45],",",["T_WHITESPACE","\n                    ",45],["T_CONSTANT_ENCAPSED_STRING","'<img src=\"test.gif\" style=\"height: expression(compatMode==\\'CSS1Compat\\'? 200px : 300px\")\/>'",46],",",["T_WHITESPACE","\n                ",46],"]",",",["T_WHITESPACE","\n                ",47],"[",["T_WHITESPACE","\n                    ",48],["T_CONSTANT_ENCAPSED_STRING","'<element ><\/element>'",49],",",["T_WHITESPACE","\n                    ",49],["T_CONSTANT_ENCAPSED_STRING","'<img src=\"test.gif\" \/>'",50],["T_WHITESPACE","\n                ",50],"]",",",["T_WHITESPACE","\n            ",51],"]",",",["T_WHITESPACE","\n            ",52],["T_CONSTANT_ENCAPSED_STRING","'JS attributes (array of strings to be filtered)'",53],["T_WHITESPACE"," ",53],["T_DOUBLE_ARROW","=>",53],["T_WHITESPACE"," ",53],"[",["T_WHITESPACE","\n                ",53],"[",["T_WHITESPACE","\n                    ",54],["T_CONSTANT_ENCAPSED_STRING","'<element ondblclick=\"SomeJavaScriptCode\">'",55],",",["T_WHITESPACE","\n                    ",55],["T_CONSTANT_ENCAPSED_STRING","'<element onclick=\"SomeJavaScriptCode\">'",56],",",["T_WHITESPACE","\n                    ",56],["T_CONSTANT_ENCAPSED_STRING","'<element onkeydown=\"SomeJavaScriptCode\">'",57],",",["T_WHITESPACE","\n                    ",57],["T_CONSTANT_ENCAPSED_STRING","'<element onkeypress=\"SomeJavaScriptCode\">'",58],",",["T_WHITESPACE","\n                    ",58],["T_CONSTANT_ENCAPSED_STRING","'<element onkeyup=\"SomeJavaScriptCode\">'",59],",",["T_WHITESPACE","\n                    ",59],["T_CONSTANT_ENCAPSED_STRING","'<element onmousedown=\"SomeJavaScriptCode\">'",60],",",["T_WHITESPACE","\n                    ",60],["T_CONSTANT_ENCAPSED_STRING","'<element onmousemove=\"SomeJavaScriptCode\">'",61],",",["T_WHITESPACE","\n                    ",61],["T_CONSTANT_ENCAPSED_STRING","'<element onmouseout=\"SomeJavaScriptCode\">'",62],",",["T_WHITESPACE","\n                    ",62],["T_CONSTANT_ENCAPSED_STRING","'<element onmouseover=\"SomeJavaScriptCode\">'",63],",",["T_WHITESPACE","\n                    ",63],["T_CONSTANT_ENCAPSED_STRING","'<element onmouseup=\"SomeJavaScriptCode\">'",64],",",["T_WHITESPACE","\n                    ",64],["T_CONSTANT_ENCAPSED_STRING","'<element onload=\"SomeJavaScriptCode\">'",65],",",["T_WHITESPACE","\n                    ",65],["T_CONSTANT_ENCAPSED_STRING","'<element onunload=\"SomeJavaScriptCode\">'",66],",",["T_WHITESPACE","\n                    ",66],["T_CONSTANT_ENCAPSED_STRING","'<element onerror=\"SomeJavaScriptCode\" \/>'",67],",",["T_WHITESPACE","\n                ",67],"]",",",["T_WHITESPACE","\n                ",68],"[",["T_WHITESPACE","\n                    ",69],["T_CONSTANT_ENCAPSED_STRING","'<element >'",70],",",["T_WHITESPACE","\n                    ",70],["T_CONSTANT_ENCAPSED_STRING","'<element >'",71],",",["T_WHITESPACE","\n                    ",71],["T_CONSTANT_ENCAPSED_STRING","'<element >'",72],",",["T_WHITESPACE","\n                    ",72],["T_CONSTANT_ENCAPSED_STRING","'<element >'",73],",",["T_WHITESPACE","\n                    ",73],["T_CONSTANT_ENCAPSED_STRING","'<element >'",74],",",["T_WHITESPACE","\n                    ",74],["T_CONSTANT_ENCAPSED_STRING","'<element >'",75],",",["T_WHITESPACE","\n                    ",75],["T_CONSTANT_ENCAPSED_STRING","'<element >'",76],",",["T_WHITESPACE","\n                    ",76],["T_CONSTANT_ENCAPSED_STRING","'<element >'",77],",",["T_WHITESPACE","\n                    ",77],["T_CONSTANT_ENCAPSED_STRING","'<element >'",78],",",["T_WHITESPACE","\n                    ",78],["T_CONSTANT_ENCAPSED_STRING","'<element >'",79],",",["T_WHITESPACE","\n                    ",79],["T_CONSTANT_ENCAPSED_STRING","'<element >'",80],",",["T_WHITESPACE","\n                    ",80],["T_CONSTANT_ENCAPSED_STRING","'<element >'",81],",",["T_WHITESPACE","\n                    ",81],["T_CONSTANT_ENCAPSED_STRING","'<element \/>'",82],",",["T_WHITESPACE","\n                ",82],"]",",",["T_WHITESPACE","\n            ",83],"]",",",["T_WHITESPACE","\n            ",84],["T_CONSTANT_ENCAPSED_STRING","'Prohibited tags (array of strings to be filtered)'",85],["T_WHITESPACE"," ",85],["T_DOUBLE_ARROW","=>",85],["T_WHITESPACE"," ",85],"[",["T_WHITESPACE","\n                ",85],"[",["T_WHITESPACE","\n                    ",86],["T_CONSTANT_ENCAPSED_STRING","'Tag is removed <script>SomeScript<\/script>'",87],",",["T_WHITESPACE","\n                    ",87],["T_CONSTANT_ENCAPSED_STRING","'Tag is removed <meta>SomeMeta<\/meta>'",88],",",["T_WHITESPACE","\n                    ",88],["T_CONSTANT_ENCAPSED_STRING","'Tag is removed <link>SomeLink<\/link>'",89],",",["T_WHITESPACE","\n                    ",89],["T_CONSTANT_ENCAPSED_STRING","'Tag is removed <frame>SomeFrame<\/frame>'",90],",",["T_WHITESPACE","\n                    ",90],["T_CONSTANT_ENCAPSED_STRING","'Tag is removed <iframe>SomeIFrame<\/iframe>'",91],",",["T_WHITESPACE","\n                    ",91],["T_CONSTANT_ENCAPSED_STRING","'Tag is removed <object>SomeObject<\/object>'",92],",",["T_WHITESPACE","\n                ",92],"]",",",["T_WHITESPACE","\n                ",93],"[",["T_WHITESPACE","\n                    ",94],["T_CONSTANT_ENCAPSED_STRING","'Tag is removed SomeScript'",95],",",["T_WHITESPACE","\n                    ",95],["T_CONSTANT_ENCAPSED_STRING","'Tag is removed SomeMeta'",96],",",["T_WHITESPACE","\n                    ",96],["T_CONSTANT_ENCAPSED_STRING","'Tag is removed SomeLink'",97],",",["T_WHITESPACE","\n                    ",97],["T_CONSTANT_ENCAPSED_STRING","'Tag is removed SomeFrame'",98],",",["T_WHITESPACE","\n                    ",98],["T_CONSTANT_ENCAPSED_STRING","'Tag is removed SomeIFrame'",99],",",["T_WHITESPACE","\n                    ",99],["T_CONSTANT_ENCAPSED_STRING","'Tag is removed SomeObject'",100],",",["T_WHITESPACE","\n                ",100],"]",",",["T_WHITESPACE","\n            ",101],"]",",",["T_WHITESPACE","\n            ",102],["T_CONSTANT_ENCAPSED_STRING","'Base64'",103],["T_WHITESPACE"," ",103],["T_DOUBLE_ARROW","=>",103],["T_WHITESPACE"," ",103],"[",["T_WHITESPACE","\n                ",103],["T_CONSTANT_ENCAPSED_STRING","'<img alt=\"Embedded Image\" src=\"data:image\/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIA...\" \/>'",104],",",["T_WHITESPACE","\n                ",104],["T_CONSTANT_ENCAPSED_STRING","'<img alt=\"Embedded Image\" \/>'",105],",",["T_WHITESPACE","\n            ",105],"]",",",["T_WHITESPACE","\n            ",106],["T_CONSTANT_ENCAPSED_STRING","'Nested malicious tags'",107],["T_WHITESPACE"," ",107],["T_DOUBLE_ARROW","=>",107],["T_WHITESPACE"," ",107],"[",["T_WHITESPACE","\n                ",107],["T_CONSTANT_ENCAPSED_STRING","'<scri<script>pt>alert(1);<\/scri<script>pt>'",108],",",["T_WHITESPACE","\n                ",108],["T_CONSTANT_ENCAPSED_STRING","'alert(1);'",109],",",["T_WHITESPACE","\n            ",109],"]",["T_WHITESPACE","\n        ",110],"]",";",["T_WHITESPACE","\n    ",111],"}",["T_WHITESPACE","\n\n    ",112],["T_DOC_COMMENT","\/**\n     * Ensure that custom filtration regular expressions are applied.\n     *\/",114],["T_WHITESPACE","\n    ",116],["T_PUBLIC","public",117],["T_WHITESPACE"," ",117],["T_FUNCTION","function",117],["T_WHITESPACE"," ",117],["T_STRING","testAddExpression",117],"(",")",["T_WHITESPACE","\n    ",117],"{",["T_WHITESPACE","\n        ",118],["T_VARIABLE","$customExpression",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_CONSTANT_ENCAPSED_STRING","'\/<\\\/?(customMalicious).*>\/Uis'",119],";",["T_WHITESPACE","\n        ",119],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","filter",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","addExpression",120],"(",["T_VARIABLE","$customExpression",120],")",";",["T_WHITESPACE","\n        ",120],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","assertEquals",121],"(",["T_WHITESPACE","\n            ",121],["T_DOC_COMMENT","\/** Tabs should be filtered out along with custom malicious code *\/",122],["T_WHITESPACE","\n            ",122],["T_CONSTANT_ENCAPSED_STRING","'Custom malicious tag is removed customMalicious'",123],",",["T_WHITESPACE","\n            ",123],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","filter",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","filter",124],"(",["T_WHITESPACE","\n                ",124],["T_CONSTANT_ENCAPSED_STRING","\"Custom \\tmalicious tag\\t\\t is removed <customMalicious>customMalicious<\/customMalicious>\"",125],["T_WHITESPACE","\n            ",125],")",",",["T_WHITESPACE","\n            ",126],["T_CONSTANT_ENCAPSED_STRING","'Custom filters are not applied correctly.'",127],["T_WHITESPACE","\n        ",127],")",";",["T_WHITESPACE","\n    ",128],"}",["T_WHITESPACE","\n\n    ",129],["T_DOC_COMMENT","\/**\n     * Ensure that custom filtration regular expressions replace existing ones.\n     *\/",131],["T_WHITESPACE","\n    ",133],["T_PUBLIC","public",134],["T_WHITESPACE"," ",134],["T_FUNCTION","function",134],["T_WHITESPACE"," ",134],["T_STRING","testSetExpression",134],"(",")",["T_WHITESPACE","\n    ",134],"{",["T_WHITESPACE","\n        ",135],["T_VARIABLE","$customExpression",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","'\/<\\\/?(customMalicious).*>\/Uis'",136],";",["T_WHITESPACE","\n        ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","filter",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","setExpressions",137],"(","[",["T_VARIABLE","$customExpression",137],"]",")",";",["T_WHITESPACE","\n        ",137],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","assertEquals",138],"(",["T_WHITESPACE","\n            ",138],["T_DOC_COMMENT","\/** Tabs should not be filtered out along with custom malicious code *\/",139],["T_WHITESPACE","\n            ",139],["T_CONSTANT_ENCAPSED_STRING","\"Custom \\tmalicious tag\\t\\t is removed customMalicious\"",140],",",["T_WHITESPACE","\n            ",140],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","filter",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","filter",141],"(",["T_WHITESPACE","\n                ",141],["T_CONSTANT_ENCAPSED_STRING","\"Custom \\tmalicious tag\\t\\t is removed <customMalicious>customMalicious<\/customMalicious>\"",142],["T_WHITESPACE","\n            ",142],")",",",["T_WHITESPACE","\n            ",143],["T_CONSTANT_ENCAPSED_STRING","'Native filters should have been replaced with custom ones.'",144],["T_WHITESPACE","\n        ",144],")",";",["T_WHITESPACE","\n    ",145],"}",["T_WHITESPACE","\n",146],"}",["T_WHITESPACE","\n",147]]