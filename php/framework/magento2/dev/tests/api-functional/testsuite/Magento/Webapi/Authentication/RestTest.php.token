[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Test authentication mechanisms in REST.\n *\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",7],["T_NAMESPACE","namespace",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Webapi",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Authentication",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * @magentoApiDataFixture consumerFixture\n *\/",10],["T_WHITESPACE","\n",12],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","RestTest",13],["T_WHITESPACE"," ",13],["T_EXTENDS","extends",13],["T_WHITESPACE"," ",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","TestFramework",13],["T_NS_SEPARATOR","\\",13],["T_STRING","TestCase",13],["T_NS_SEPARATOR","\\",13],["T_STRING","WebapiAbstract",13],["T_WHITESPACE","\n",13],"{",["T_WHITESPACE","\n    ",14],["T_DOC_COMMENT","\/** @var \\Magento\\TestFramework\\Authentication\\Rest\\OauthClient[] *\/",15],["T_WHITESPACE","\n    ",15],["T_PROTECTED","protected",16],["T_WHITESPACE"," ",16],["T_VARIABLE","$_oAuthClients",16],["T_WHITESPACE"," ",16],"=",["T_WHITESPACE"," ",16],"[","]",";",["T_WHITESPACE","\n\n    ",16],["T_DOC_COMMENT","\/** @var \\Magento\\Integration\\Model\\Oauth\\Consumer *\/",18],["T_WHITESPACE","\n    ",18],["T_PROTECTED","protected",19],["T_WHITESPACE"," ",19],["T_STATIC","static",19],["T_WHITESPACE"," ",19],["T_VARIABLE","$_consumer",19],";",["T_WHITESPACE","\n\n    ",19],["T_DOC_COMMENT","\/** @var \\Magento\\Integration\\Model\\Oauth\\Token *\/",21],["T_WHITESPACE","\n    ",21],["T_PROTECTED","protected",22],["T_WHITESPACE"," ",22],["T_STATIC","static",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$_token",22],";",["T_WHITESPACE","\n\n    ",22],["T_DOC_COMMENT","\/** @var string *\/",24],["T_WHITESPACE","\n    ",24],["T_PROTECTED","protected",25],["T_WHITESPACE"," ",25],["T_STATIC","static",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$_consumerKey",25],";",["T_WHITESPACE","\n\n    ",25],["T_DOC_COMMENT","\/** @var string *\/",27],["T_WHITESPACE","\n    ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_STATIC","static",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$_consumerSecret",28],";",["T_WHITESPACE","\n\n    ",28],["T_DOC_COMMENT","\/** @var string *\/",30],["T_WHITESPACE","\n    ",30],["T_PROTECTED","protected",31],["T_WHITESPACE"," ",31],["T_STATIC","static",31],["T_WHITESPACE"," ",31],["T_VARIABLE","$_verifier",31],";",["T_WHITESPACE","\n\n    ",31],["T_PROTECTED","protected",33],["T_WHITESPACE"," ",33],["T_FUNCTION","function",33],["T_WHITESPACE"," ",33],["T_STRING","setUp",33],"(",")",["T_WHITESPACE","\n    ",33],"{",["T_WHITESPACE","\n        ",34],["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","_markTestAsRestOnly",35],"(",")",";",["T_WHITESPACE","\n        ",35],["T_STRING","parent",36],["T_DOUBLE_COLON","::",36],["T_STRING","setUp",36],"(",")",";",["T_WHITESPACE","\n    ",36],"}",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * Create a consumer\n     *\/",39],["T_WHITESPACE","\n    ",41],["T_PUBLIC","public",42],["T_WHITESPACE"," ",42],["T_STATIC","static",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","consumerFixture",42],"(",["T_VARIABLE","$date",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_STRING","null",42],")",["T_WHITESPACE","\n    ",42],"{",["T_WHITESPACE","\n        ",43],["T_DOC_COMMENT","\/** Clear the credentials because during the fixture generation, any previous credentials are invalidated *\/",44],["T_WHITESPACE","\n        ",44],["T_NS_SEPARATOR","\\",45],["T_STRING","Magento",45],["T_NS_SEPARATOR","\\",45],["T_STRING","TestFramework",45],["T_NS_SEPARATOR","\\",45],["T_STRING","Authentication",45],["T_NS_SEPARATOR","\\",45],["T_STRING","OauthHelper",45],["T_DOUBLE_COLON","::",45],["T_STRING","clearApiAccessCredentials",45],"(",")",";",["T_WHITESPACE","\n\n        ",45],["T_VARIABLE","$consumerCredentials",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_NS_SEPARATOR","\\",47],["T_STRING","Magento",47],["T_NS_SEPARATOR","\\",47],["T_STRING","TestFramework",47],["T_NS_SEPARATOR","\\",47],["T_STRING","Authentication",47],["T_NS_SEPARATOR","\\",47],["T_STRING","OauthHelper",47],["T_DOUBLE_COLON","::",47],["T_STRING","getConsumerCredentials",47],"(",["T_VARIABLE","$date",47],")",";",["T_WHITESPACE","\n        ",47],["T_STRING","self",48],["T_DOUBLE_COLON","::",48],["T_VARIABLE","$_consumerKey",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$consumerCredentials",48],"[",["T_CONSTANT_ENCAPSED_STRING","'key'",48],"]",";",["T_WHITESPACE","\n        ",48],["T_STRING","self",49],["T_DOUBLE_COLON","::",49],["T_VARIABLE","$_consumerSecret",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$consumerCredentials",49],"[",["T_CONSTANT_ENCAPSED_STRING","'secret'",49],"]",";",["T_WHITESPACE","\n        ",49],["T_STRING","self",50],["T_DOUBLE_COLON","::",50],["T_VARIABLE","$_verifier",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_VARIABLE","$consumerCredentials",50],"[",["T_CONSTANT_ENCAPSED_STRING","'verifier'",50],"]",";",["T_WHITESPACE","\n        ",50],["T_STRING","self",51],["T_DOUBLE_COLON","::",51],["T_VARIABLE","$_consumer",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$consumerCredentials",51],"[",["T_CONSTANT_ENCAPSED_STRING","'consumer'",51],"]",";",["T_WHITESPACE","\n        ",51],["T_STRING","self",52],["T_DOUBLE_COLON","::",52],["T_VARIABLE","$_token",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$consumerCredentials",52],"[",["T_CONSTANT_ENCAPSED_STRING","'token'",52],"]",";",["T_WHITESPACE","\n    ",52],"}",["T_WHITESPACE","\n\n    ",53],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_FUNCTION","function",55],["T_WHITESPACE"," ",55],["T_STRING","tearDown",55],"(",")",["T_WHITESPACE","\n    ",55],"{",["T_WHITESPACE","\n        ",56],["T_STRING","parent",57],["T_DOUBLE_COLON","::",57],["T_STRING","tearDown",57],"(",")",";",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","_oAuthClients",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],"[","]",";",["T_WHITESPACE","\n        ",58],["T_IF","if",59],["T_WHITESPACE"," ",59],"(",["T_ISSET","isset",59],"(",["T_STRING","self",59],["T_DOUBLE_COLON","::",59],["T_VARIABLE","$_consumer",59],")",")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n            ",59],["T_STRING","self",60],["T_DOUBLE_COLON","::",60],["T_VARIABLE","$_consumer",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","delete",60],"(",")",";",["T_WHITESPACE","\n            ",60],["T_STRING","self",61],["T_DOUBLE_COLON","::",61],["T_VARIABLE","$_token",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","delete",61],"(",")",";",["T_WHITESPACE","\n        ",61],"}",["T_WHITESPACE","\n    ",62],"}",["T_WHITESPACE","\n\n    ",63],["T_PUBLIC","public",65],["T_WHITESPACE"," ",65],["T_FUNCTION","function",65],["T_WHITESPACE"," ",65],["T_STRING","testGetRequestToken",65],"(",")",["T_WHITESPACE","\n    ",65],"{",["T_WHITESPACE","\n        ",66],["T_DOC_COMMENT","\/** @var $oAuthClient \\Magento\\TestFramework\\Authentication\\Rest\\OauthClient *\/",67],["T_WHITESPACE","\n        ",67],["T_VARIABLE","$oAuthClient",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","_getOauthClient",68],"(",["T_STRING","self",68],["T_DOUBLE_COLON","::",68],["T_VARIABLE","$_consumerKey",68],",",["T_WHITESPACE"," ",68],["T_STRING","self",68],["T_DOUBLE_COLON","::",68],["T_VARIABLE","$_consumerSecret",68],")",";",["T_WHITESPACE","\n        ",68],["T_VARIABLE","$requestToken",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_VARIABLE","$oAuthClient",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","requestRequestToken",69],"(",")",";",["T_WHITESPACE","\n\n        ",69],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","assertNotEmpty",71],"(",["T_VARIABLE","$requestToken",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getRequestToken",71],"(",")",",",["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","\"Request token value is not set\"",71],")",";",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","assertNotEmpty",72],"(",["T_VARIABLE","$requestToken",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","getRequestTokenSecret",72],"(",")",",",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","\"Request token secret is not set\"",72],")",";",["T_WHITESPACE","\n\n        ",72],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","assertEquals",74],"(",["T_WHITESPACE","\n            ",74],["T_NS_SEPARATOR","\\",75],["T_STRING","Magento",75],["T_NS_SEPARATOR","\\",75],["T_STRING","Framework",75],["T_NS_SEPARATOR","\\",75],["T_STRING","Oauth",75],["T_NS_SEPARATOR","\\",75],["T_STRING","Helper",75],["T_NS_SEPARATOR","\\",75],["T_STRING","Oauth",75],["T_DOUBLE_COLON","::",75],["T_STRING","LENGTH_TOKEN",75],",",["T_WHITESPACE","\n            ",75],["T_STRING","strlen",76],"(",["T_VARIABLE","$requestToken",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getRequestToken",76],"(",")",")",",",["T_WHITESPACE","\n            ",76],["T_CONSTANT_ENCAPSED_STRING","\"Request token value length should be \"",77],["T_WHITESPACE"," ",77],".",["T_WHITESPACE"," ",77],["T_NS_SEPARATOR","\\",77],["T_STRING","Magento",77],["T_NS_SEPARATOR","\\",77],["T_STRING","Framework",77],["T_NS_SEPARATOR","\\",77],["T_STRING","Oauth",77],["T_NS_SEPARATOR","\\",77],["T_STRING","Helper",77],["T_NS_SEPARATOR","\\",77],["T_STRING","Oauth",77],["T_DOUBLE_COLON","::",77],["T_STRING","LENGTH_TOKEN",77],["T_WHITESPACE","\n        ",77],")",";",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","assertEquals",79],"(",["T_WHITESPACE","\n            ",79],["T_NS_SEPARATOR","\\",80],["T_STRING","Magento",80],["T_NS_SEPARATOR","\\",80],["T_STRING","Framework",80],["T_NS_SEPARATOR","\\",80],["T_STRING","Oauth",80],["T_NS_SEPARATOR","\\",80],["T_STRING","Helper",80],["T_NS_SEPARATOR","\\",80],["T_STRING","Oauth",80],["T_DOUBLE_COLON","::",80],["T_STRING","LENGTH_TOKEN_SECRET",80],",",["T_WHITESPACE","\n            ",80],["T_STRING","strlen",81],"(",["T_VARIABLE","$requestToken",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getRequestTokenSecret",81],"(",")",")",",",["T_WHITESPACE","\n            ",81],["T_CONSTANT_ENCAPSED_STRING","\"Request token secret length should be \"",82],["T_WHITESPACE"," ",82],".",["T_WHITESPACE"," ",82],["T_NS_SEPARATOR","\\",82],["T_STRING","Magento",82],["T_NS_SEPARATOR","\\",82],["T_STRING","Framework",82],["T_NS_SEPARATOR","\\",82],["T_STRING","Oauth",82],["T_NS_SEPARATOR","\\",82],["T_STRING","Helper",82],["T_NS_SEPARATOR","\\",82],["T_STRING","Oauth",82],["T_DOUBLE_COLON","::",82],["T_STRING","LENGTH_TOKEN_SECRET",82],["T_WHITESPACE","\n        ",82],")",";",["T_WHITESPACE","\n    ",83],"}",["T_WHITESPACE","\n\n    ",84],["T_DOC_COMMENT","\/**\n     * @expectedException \\Exception\n     * @expectedExceptionMessage 401 Unauthorized\n     *\/",86],["T_WHITESPACE","\n    ",89],["T_PUBLIC","public",90],["T_WHITESPACE"," ",90],["T_FUNCTION","function",90],["T_WHITESPACE"," ",90],["T_STRING","testGetRequestTokenExpiredConsumer",90],"(",")",["T_WHITESPACE","\n    ",90],"{",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$this",92],["T_DOUBLE_COLON","::",92],["T_STRING","consumerFixture",92],"(",["T_CONSTANT_ENCAPSED_STRING","'2012-01-01 00:00:00'",92],")",";",["T_WHITESPACE","\n        ",92],["T_VARIABLE","$this",93],["T_DOUBLE_COLON","::",93],["T_VARIABLE","$_consumer",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","setUpdatedAt",93],"(",["T_CONSTANT_ENCAPSED_STRING","'2012-01-01 00:00:00'",93],")",";",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$this",94],["T_DOUBLE_COLON","::",94],["T_VARIABLE","$_consumer",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","save",94],"(",")",";",["T_WHITESPACE","\n        ",94],["T_DOC_COMMENT","\/** @var $oAuthClient \\Magento\\TestFramework\\Authentication\\Rest\\OauthClient *\/",95],["T_WHITESPACE","\n        ",95],["T_VARIABLE","$oAuthClient",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","_getOauthClient",96],"(",["T_STRING","self",96],["T_DOUBLE_COLON","::",96],["T_VARIABLE","$_consumerKey",96],",",["T_WHITESPACE"," ",96],["T_STRING","self",96],["T_DOUBLE_COLON","::",96],["T_VARIABLE","$_consumerSecret",96],")",";",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$oAuthClient",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","requestRequestToken",97],"(",")",";",["T_WHITESPACE","\n    ",97],"}",["T_WHITESPACE","\n\n    ",98],["T_DOC_COMMENT","\/**\n     * @expectedException \\Exception\n     * @expectedExceptionMessage 401 Unauthorized\n     *\/",100],["T_WHITESPACE","\n    ",103],["T_PUBLIC","public",104],["T_WHITESPACE"," ",104],["T_FUNCTION","function",104],["T_WHITESPACE"," ",104],["T_STRING","testGetRequestTokenInvalidConsumerKey",104],"(",")",["T_WHITESPACE","\n    ",104],"{",["T_WHITESPACE","\n        ",105],["T_VARIABLE","$oAuthClient",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","_getOauthClient",106],"(",["T_CONSTANT_ENCAPSED_STRING","'invalid_key'",106],",",["T_WHITESPACE"," ",106],["T_STRING","self",106],["T_DOUBLE_COLON","::",106],["T_VARIABLE","$_consumerSecret",106],")",";",["T_WHITESPACE","\n        ",106],["T_VARIABLE","$oAuthClient",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","requestRequestToken",107],"(",")",";",["T_WHITESPACE","\n    ",107],"}",["T_WHITESPACE","\n\n    ",108],["T_DOC_COMMENT","\/**\n     * @expectedException \\Exception\n     * @expectedExceptionMessage 401 Unauthorized\n     *\/",110],["T_WHITESPACE","\n    ",113],["T_PUBLIC","public",114],["T_WHITESPACE"," ",114],["T_FUNCTION","function",114],["T_WHITESPACE"," ",114],["T_STRING","testGetRequestTokenInvalidConsumerSecret",114],"(",")",["T_WHITESPACE","\n    ",114],"{",["T_WHITESPACE","\n        ",115],["T_VARIABLE","$oAuthClient",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","_getOauthClient",116],"(",["T_STRING","self",116],["T_DOUBLE_COLON","::",116],["T_VARIABLE","$_consumerKey",116],",",["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","'invalid_secret'",116],")",";",["T_WHITESPACE","\n        ",116],["T_VARIABLE","$oAuthClient",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","requestRequestToken",117],"(",")",";",["T_WHITESPACE","\n    ",117],"}",["T_WHITESPACE","\n\n    ",118],["T_PUBLIC","public",120],["T_WHITESPACE"," ",120],["T_FUNCTION","function",120],["T_WHITESPACE"," ",120],["T_STRING","testGetAccessToken",120],"(",")",["T_WHITESPACE","\n    ",120],"{",["T_WHITESPACE","\n        ",121],["T_VARIABLE","$oAuthClient",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","_getOauthClient",122],"(",["T_STRING","self",122],["T_DOUBLE_COLON","::",122],["T_VARIABLE","$_consumerKey",122],",",["T_WHITESPACE"," ",122],["T_STRING","self",122],["T_DOUBLE_COLON","::",122],["T_VARIABLE","$_consumerSecret",122],")",";",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$requestToken",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$oAuthClient",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","requestRequestToken",123],"(",")",";",["T_WHITESPACE","\n        ",123],["T_VARIABLE","$accessToken",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$oAuthClient",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","requestAccessToken",124],"(",["T_WHITESPACE","\n            ",124],["T_VARIABLE","$requestToken",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","getRequestToken",125],"(",")",",",["T_WHITESPACE","\n            ",125],["T_STRING","self",126],["T_DOUBLE_COLON","::",126],["T_VARIABLE","$_verifier",126],",",["T_WHITESPACE","\n            ",126],["T_VARIABLE","$requestToken",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","getRequestTokenSecret",127],"(",")",["T_WHITESPACE","\n        ",127],")",";",["T_WHITESPACE","\n        ",128],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","assertNotEmpty",129],"(",["T_VARIABLE","$accessToken",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getAccessToken",129],"(",")",",",["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","\"Access token value is not set.\"",129],")",";",["T_WHITESPACE","\n        ",129],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","assertNotEmpty",130],"(",["T_VARIABLE","$accessToken",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getAccessTokenSecret",130],"(",")",",",["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","\"Access token secret is not set.\"",130],")",";",["T_WHITESPACE","\n\n        ",130],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","assertEquals",132],"(",["T_WHITESPACE","\n            ",132],["T_NS_SEPARATOR","\\",133],["T_STRING","Magento",133],["T_NS_SEPARATOR","\\",133],["T_STRING","Framework",133],["T_NS_SEPARATOR","\\",133],["T_STRING","Oauth",133],["T_NS_SEPARATOR","\\",133],["T_STRING","Helper",133],["T_NS_SEPARATOR","\\",133],["T_STRING","Oauth",133],["T_DOUBLE_COLON","::",133],["T_STRING","LENGTH_TOKEN",133],",",["T_WHITESPACE","\n            ",133],["T_STRING","strlen",134],"(",["T_VARIABLE","$accessToken",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","getAccessToken",134],"(",")",")",",",["T_WHITESPACE","\n            ",134],["T_CONSTANT_ENCAPSED_STRING","\"Access token value length should be \"",135],["T_WHITESPACE"," ",135],".",["T_WHITESPACE"," ",135],["T_NS_SEPARATOR","\\",135],["T_STRING","Magento",135],["T_NS_SEPARATOR","\\",135],["T_STRING","Framework",135],["T_NS_SEPARATOR","\\",135],["T_STRING","Oauth",135],["T_NS_SEPARATOR","\\",135],["T_STRING","Helper",135],["T_NS_SEPARATOR","\\",135],["T_STRING","Oauth",135],["T_DOUBLE_COLON","::",135],["T_STRING","LENGTH_TOKEN",135],["T_WHITESPACE","\n        ",135],")",";",["T_WHITESPACE","\n        ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","assertEquals",137],"(",["T_WHITESPACE","\n            ",137],["T_NS_SEPARATOR","\\",138],["T_STRING","Magento",138],["T_NS_SEPARATOR","\\",138],["T_STRING","Framework",138],["T_NS_SEPARATOR","\\",138],["T_STRING","Oauth",138],["T_NS_SEPARATOR","\\",138],["T_STRING","Helper",138],["T_NS_SEPARATOR","\\",138],["T_STRING","Oauth",138],["T_DOUBLE_COLON","::",138],["T_STRING","LENGTH_TOKEN_SECRET",138],",",["T_WHITESPACE","\n            ",138],["T_STRING","strlen",139],"(",["T_VARIABLE","$accessToken",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getAccessTokenSecret",139],"(",")",")",",",["T_WHITESPACE","\n            ",139],["T_CONSTANT_ENCAPSED_STRING","\"Access token secret length should be \"",140],["T_WHITESPACE"," ",140],".",["T_WHITESPACE"," ",140],["T_NS_SEPARATOR","\\",140],["T_STRING","Magento",140],["T_NS_SEPARATOR","\\",140],["T_STRING","Framework",140],["T_NS_SEPARATOR","\\",140],["T_STRING","Oauth",140],["T_NS_SEPARATOR","\\",140],["T_STRING","Helper",140],["T_NS_SEPARATOR","\\",140],["T_STRING","Oauth",140],["T_DOUBLE_COLON","::",140],["T_STRING","LENGTH_TOKEN_SECRET",140],["T_WHITESPACE","\n        ",140],")",";",["T_WHITESPACE","\n    ",141],"}",["T_WHITESPACE","\n\n    ",142],["T_DOC_COMMENT","\/**\n     * @expectedException \\Exception\n     * @expectedExceptionMessage 401 Unauthorized\n     *\/",144],["T_WHITESPACE","\n    ",147],["T_PUBLIC","public",148],["T_WHITESPACE"," ",148],["T_FUNCTION","function",148],["T_WHITESPACE"," ",148],["T_STRING","testGetAccessTokenInvalidVerifier",148],"(",")",["T_WHITESPACE","\n    ",148],"{",["T_WHITESPACE","\n        ",149],["T_VARIABLE","$oAuthClient",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","_getOauthClient",150],"(",["T_STRING","self",150],["T_DOUBLE_COLON","::",150],["T_VARIABLE","$_consumerKey",150],",",["T_WHITESPACE"," ",150],["T_STRING","self",150],["T_DOUBLE_COLON","::",150],["T_VARIABLE","$_consumerSecret",150],")",";",["T_WHITESPACE","\n        ",150],["T_VARIABLE","$requestToken",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_VARIABLE","$oAuthClient",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","requestRequestToken",151],"(",")",";",["T_WHITESPACE","\n        ",151],["T_VARIABLE","$oAuthClient",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","requestAccessToken",152],"(",["T_WHITESPACE","\n            ",152],["T_VARIABLE","$requestToken",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","getRequestToken",153],"(",")",",",["T_WHITESPACE","\n            ",153],["T_CONSTANT_ENCAPSED_STRING","'invalid verifier'",154],",",["T_WHITESPACE","\n            ",154],["T_VARIABLE","$requestToken",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","getRequestTokenSecret",155],"(",")",["T_WHITESPACE","\n        ",155],")",";",["T_WHITESPACE","\n    ",156],"}",["T_WHITESPACE","\n\n    ",157],["T_DOC_COMMENT","\/**\n     * @expectedException \\Exception\n     * @expectedExceptionMessage 401 Unauthorized\n     *\/",159],["T_WHITESPACE","\n    ",162],["T_PUBLIC","public",163],["T_WHITESPACE"," ",163],["T_FUNCTION","function",163],["T_WHITESPACE"," ",163],["T_STRING","testGetAccessTokenConsumerMismatch",163],"(",")",["T_WHITESPACE","\n    ",163],"{",["T_WHITESPACE","\n        ",164],["T_VARIABLE","$oAuthClientA",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","_getOauthClient",165],"(",["T_STRING","self",165],["T_DOUBLE_COLON","::",165],["T_VARIABLE","$_consumerKey",165],",",["T_WHITESPACE"," ",165],["T_STRING","self",165],["T_DOUBLE_COLON","::",165],["T_VARIABLE","$_consumerSecret",165],")",";",["T_WHITESPACE","\n        ",165],["T_VARIABLE","$requestTokenA",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_VARIABLE","$oAuthClientA",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","requestRequestToken",166],"(",")",";",["T_WHITESPACE","\n        ",166],["T_VARIABLE","$oauthVerifierA",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_STRING","self",167],["T_DOUBLE_COLON","::",167],["T_VARIABLE","$_verifier",167],";",["T_WHITESPACE","\n\n        ",167],["T_STRING","self",169],["T_DOUBLE_COLON","::",169],["T_STRING","consumerFixture",169],"(",")",";",["T_WHITESPACE","\n        ",169],["T_VARIABLE","$oAuthClientB",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","_getOauthClient",170],"(",["T_STRING","self",170],["T_DOUBLE_COLON","::",170],["T_VARIABLE","$_consumerKey",170],",",["T_WHITESPACE"," ",170],["T_STRING","self",170],["T_DOUBLE_COLON","::",170],["T_VARIABLE","$_consumerSecret",170],")",";",["T_WHITESPACE","\n\n        ",170],["T_VARIABLE","$oAuthClientB",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","requestAccessToken",172],"(",["T_WHITESPACE","\n            ",172],["T_VARIABLE","$requestTokenA",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","getRequestToken",173],"(",")",",",["T_WHITESPACE","\n            ",173],["T_VARIABLE","$oauthVerifierA",174],",",["T_WHITESPACE","\n            ",174],["T_VARIABLE","$requestTokenA",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","getRequestTokenSecret",175],"(",")",["T_WHITESPACE","\n        ",175],")",";",["T_WHITESPACE","\n    ",176],"}",["T_WHITESPACE","\n\n    ",177],["T_DOC_COMMENT","\/**\n     * @expectedException \\Exception\n     * @expectedExceptionMessage 400 Bad Request\n     *\/",179],["T_WHITESPACE","\n    ",182],["T_PUBLIC","public",183],["T_WHITESPACE"," ",183],["T_FUNCTION","function",183],["T_WHITESPACE"," ",183],["T_STRING","testAccessApiInvalidAccessToken",183],"(",")",["T_WHITESPACE","\n    ",183],"{",["T_WHITESPACE","\n        ",184],["T_VARIABLE","$oAuthClient",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","_getOauthClient",185],"(",["T_STRING","self",185],["T_DOUBLE_COLON","::",185],["T_VARIABLE","$_consumerKey",185],",",["T_WHITESPACE"," ",185],["T_STRING","self",185],["T_DOUBLE_COLON","::",185],["T_VARIABLE","$_consumerSecret",185],")",";",["T_WHITESPACE","\n        ",185],["T_VARIABLE","$requestToken",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_VARIABLE","$oAuthClient",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","requestRequestToken",186],"(",")",";",["T_WHITESPACE","\n        ",186],["T_VARIABLE","$accessToken",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_VARIABLE","$oAuthClient",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","requestAccessToken",187],"(",["T_WHITESPACE","\n            ",187],["T_VARIABLE","$requestToken",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getRequestToken",188],"(",")",",",["T_WHITESPACE","\n            ",188],["T_STRING","self",189],["T_DOUBLE_COLON","::",189],["T_VARIABLE","$_verifier",189],",",["T_WHITESPACE","\n            ",189],["T_VARIABLE","$requestToken",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","getRequestTokenSecret",190],"(",")",["T_WHITESPACE","\n        ",190],")",";",["T_WHITESPACE","\n        ",191],["T_VARIABLE","$accessToken",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","setAccessToken",192],"(",["T_CONSTANT_ENCAPSED_STRING","'invalid'",192],")",";",["T_WHITESPACE","\n        ",192],["T_VARIABLE","$oAuthClient",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","validateAccessToken",193],"(",["T_VARIABLE","$accessToken",193],")",";",["T_WHITESPACE","\n    ",193],"}",["T_WHITESPACE","\n\n    ",194],["T_PROTECTED","protected",196],["T_WHITESPACE"," ",196],["T_FUNCTION","function",196],["T_WHITESPACE"," ",196],["T_STRING","_getOauthClient",196],"(",["T_VARIABLE","$consumerKey",196],",",["T_WHITESPACE"," ",196],["T_VARIABLE","$consumerSecret",196],")",["T_WHITESPACE","\n    ",196],"{",["T_WHITESPACE","\n        ",197],["T_IF","if",198],["T_WHITESPACE"," ",198],"(","!",["T_ISSET","isset",198],"(",["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","_oAuthClients",198],"[",["T_VARIABLE","$consumerKey",198],"]",")",")",["T_WHITESPACE"," ",198],"{",["T_WHITESPACE","\n            ",198],["T_VARIABLE","$credentials",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_NEW","new",199],["T_WHITESPACE"," ",199],["T_NS_SEPARATOR","\\",199],["T_STRING","OAuth",199],["T_NS_SEPARATOR","\\",199],["T_STRING","Common",199],["T_NS_SEPARATOR","\\",199],["T_STRING","Consumer",199],["T_NS_SEPARATOR","\\",199],["T_STRING","Credentials",199],"(",["T_VARIABLE","$consumerKey",199],",",["T_WHITESPACE"," ",199],["T_VARIABLE","$consumerSecret",199],",",["T_WHITESPACE"," ",199],["T_STRING","TESTS_BASE_URL",199],")",";",["T_WHITESPACE","\n            ",199],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","_oAuthClients",200],"[",["T_VARIABLE","$consumerKey",200],"]",["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_NEW","new",200],["T_WHITESPACE"," ",200],["T_NS_SEPARATOR","\\",200],["T_STRING","Magento",200],["T_NS_SEPARATOR","\\",200],["T_STRING","TestFramework",200],["T_NS_SEPARATOR","\\",200],["T_STRING","Authentication",200],["T_NS_SEPARATOR","\\",200],["T_STRING","Rest",200],["T_NS_SEPARATOR","\\",200],["T_STRING","OauthClient",200],"(",["T_WHITESPACE","\n                ",200],["T_VARIABLE","$credentials",201],["T_WHITESPACE","\n            ",201],")",";",["T_WHITESPACE","\n        ",202],"}",["T_WHITESPACE","\n        ",203],["T_RETURN","return",204],["T_WHITESPACE"," ",204],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","_oAuthClients",204],"[",["T_VARIABLE","$consumerKey",204],"]",";",["T_WHITESPACE","\n    ",204],"}",["T_WHITESPACE","\n",205],"}",["T_WHITESPACE","\n",206]]