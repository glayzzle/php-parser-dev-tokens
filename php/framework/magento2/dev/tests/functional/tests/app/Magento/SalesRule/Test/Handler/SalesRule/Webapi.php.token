[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","SalesRule",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Test",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Handler",7],["T_NS_SEPARATOR","\\",7],["T_STRING","SalesRule",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Mtf",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Config",9],["T_NS_SEPARATOR","\\",9],["T_STRING","DataInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Mtf",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Fixture",10],["T_NS_SEPARATOR","\\",10],["T_STRING","FixtureInterface",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Mtf",11],["T_NS_SEPARATOR","\\",11],["T_STRING","System",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Event",11],["T_NS_SEPARATOR","\\",11],["T_STRING","EventManagerInterface",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Mtf",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Util",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Protocol",12],["T_NS_SEPARATOR","\\",12],["T_STRING","CurlTransport",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Mtf",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Util",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Protocol",13],["T_NS_SEPARATOR","\\",13],["T_STRING","CurlTransport",13],["T_NS_SEPARATOR","\\",13],["T_STRING","WebapiDecorator",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Mtf",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Handler",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Webapi",14],["T_WHITESPACE"," ",14],["T_AS","as",14],["T_WHITESPACE"," ",14],["T_STRING","AbstractWebapi",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Magento",15],["T_NS_SEPARATOR","\\",15],["T_STRING","SalesRule",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Test",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Fixture",15],["T_NS_SEPARATOR","\\",15],["T_STRING","SalesRule",15],";",["T_WHITESPACE","\n\n",15],["T_DOC_COMMENT","\/**\n * Create new sales rule via webapi.\n *\/",17],["T_WHITESPACE","\n",19],["T_CLASS","class",20],["T_WHITESPACE"," ",20],["T_STRING","Webapi",20],["T_WHITESPACE"," ",20],["T_EXTENDS","extends",20],["T_WHITESPACE"," ",20],["T_STRING","AbstractWebapi",20],["T_WHITESPACE"," ",20],["T_IMPLEMENTS","implements",20],["T_WHITESPACE"," ",20],["T_STRING","SalesRuleInterface",20],["T_WHITESPACE","\n",20],"{",["T_WHITESPACE","\n    ",21],["T_DOC_COMMENT","\/**\n     * Sales rule instance.\n     *\n     * @var SalesRule\n     *\/",22],["T_WHITESPACE","\n    ",26],["T_PROTECTED","protected",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$fixture",27],";",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * Prepared data for creating sales rule.\n     *\n     * @var array\n     *\/",29],["T_WHITESPACE","\n    ",33],["T_PROTECTED","protected",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$data",34],";",["T_WHITESPACE","\n\n    ",34],["T_DOC_COMMENT","\/**\n     * Curl handler instance.\n     *\n     * @var Curl\n     *\/",36],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$handlerCurl",41],";",["T_WHITESPACE","\n\n    ",41],["T_DOC_COMMENT","\/**\n     * List fields that only relate to coupon.\n     *\n     * @var array\n     *\/",43],["T_WHITESPACE","\n    ",47],["T_PROTECTED","protected",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$couponFields",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],"[",["T_WHITESPACE","\n        ",48],["T_CONSTANT_ENCAPSED_STRING","'coupon_code'",49],["T_WHITESPACE","\n    ",49],"]",";",["T_WHITESPACE","\n\n    ",50],["T_DOC_COMMENT","\/**\n     * Attributes that has a setter while creating sales rule using web api.\n     *\n     * @var array\n     *\/",52],["T_WHITESPACE","\n    ",56],["T_PROTECTED","protected",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$basicAttributes",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],"[",["T_WHITESPACE","\n        ",57],["T_CONSTANT_ENCAPSED_STRING","\"rule_id\"",58],",",["T_WHITESPACE","\n        ",58],["T_CONSTANT_ENCAPSED_STRING","\"name\"",59],",",["T_WHITESPACE","\n        ",59],["T_CONSTANT_ENCAPSED_STRING","\"store_labels\"",60],",",["T_WHITESPACE","\n        ",60],["T_CONSTANT_ENCAPSED_STRING","\"description\"",61],",",["T_WHITESPACE","\n        ",61],["T_CONSTANT_ENCAPSED_STRING","\"website_ids\"",62],",",["T_WHITESPACE","\n        ",62],["T_CONSTANT_ENCAPSED_STRING","\"customer_group_ids\"",63],",",["T_WHITESPACE","\n        ",63],["T_CONSTANT_ENCAPSED_STRING","\"from_date\"",64],",",["T_WHITESPACE","\n        ",64],["T_CONSTANT_ENCAPSED_STRING","\"to_date\"",65],",",["T_WHITESPACE","\n        ",65],["T_CONSTANT_ENCAPSED_STRING","\"uses_per_customer\"",66],",",["T_WHITESPACE","\n        ",66],["T_CONSTANT_ENCAPSED_STRING","\"is_active\"",67],",",["T_WHITESPACE","\n        ",67],["T_CONSTANT_ENCAPSED_STRING","\"condition\"",68],",",["T_WHITESPACE","\n        ",68],["T_CONSTANT_ENCAPSED_STRING","\"action_condition\"",69],",",["T_WHITESPACE","\n        ",69],["T_CONSTANT_ENCAPSED_STRING","\"stop_rules_processing\"",70],",",["T_WHITESPACE","\n        ",70],["T_CONSTANT_ENCAPSED_STRING","\"is_advanced\"",71],",",["T_WHITESPACE","\n        ",71],["T_CONSTANT_ENCAPSED_STRING","\"product_ids\"",72],",",["T_WHITESPACE","\n        ",72],["T_CONSTANT_ENCAPSED_STRING","\"sort_order\"",73],",",["T_WHITESPACE","\n        ",73],["T_CONSTANT_ENCAPSED_STRING","\"simple_action\"",74],",",["T_WHITESPACE","\n        ",74],["T_CONSTANT_ENCAPSED_STRING","\"discount_amount\"",75],",",["T_WHITESPACE","\n        ",75],["T_CONSTANT_ENCAPSED_STRING","\"discount_qty\"",76],",",["T_WHITESPACE","\n        ",76],["T_CONSTANT_ENCAPSED_STRING","\"discount_step\"",77],",",["T_WHITESPACE","\n        ",77],["T_CONSTANT_ENCAPSED_STRING","\"apply_to_shipping\"",78],",",["T_WHITESPACE","\n        ",78],["T_CONSTANT_ENCAPSED_STRING","\"times_used\"",79],",",["T_WHITESPACE","\n        ",79],["T_CONSTANT_ENCAPSED_STRING","\"is_rss\"",80],",",["T_WHITESPACE","\n        ",80],["T_CONSTANT_ENCAPSED_STRING","\"coupon_type\"",81],",",["T_WHITESPACE","\n        ",81],["T_CONSTANT_ENCAPSED_STRING","\"use_auto_generation\"",82],",",["T_WHITESPACE","\n        ",82],["T_CONSTANT_ENCAPSED_STRING","\"uses_per_coupon\"",83],",",["T_WHITESPACE","\n        ",83],["T_CONSTANT_ENCAPSED_STRING","\"simple_free_shipping\"",84],",",["T_WHITESPACE","\n    ",84],"]",";",["T_WHITESPACE","\n\n    ",85],["T_DOC_COMMENT","\/**\n     * @constructor\n     * @param DataInterface $configuration\n     * @param EventManagerInterface $eventManager\n     * @param WebapiDecorator $webapiTransport\n     * @param Curl $handlerCurl\n     *\/",87],["T_WHITESPACE","\n    ",93],["T_PUBLIC","public",94],["T_WHITESPACE"," ",94],["T_FUNCTION","function",94],["T_WHITESPACE"," ",94],["T_STRING","__construct",94],"(",["T_WHITESPACE","\n        ",94],["T_STRING","DataInterface",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$configuration",95],",",["T_WHITESPACE","\n        ",95],["T_STRING","EventManagerInterface",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$eventManager",96],",",["T_WHITESPACE","\n        ",96],["T_STRING","WebapiDecorator",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$webapiTransport",97],",",["T_WHITESPACE","\n        ",97],["T_STRING","Curl",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$handlerCurl",98],["T_WHITESPACE","\n    ",98],")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n        ",99],["T_STRING","parent",100],["T_DOUBLE_COLON","::",100],["T_STRING","__construct",100],"(",["T_VARIABLE","$configuration",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$eventManager",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$webapiTransport",100],")",";",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","handlerCurl",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$handlerCurl",101],";",["T_WHITESPACE","\n    ",101],"}",["T_WHITESPACE","\n\n    ",102],["T_DOC_COMMENT","\/**\n     * Post request for creating sales rule.\n     *\n     * @param FixtureInterface|null $fixture [optional]\n     * @return array\n     * @throws \\Exception\n     *\/",104],["T_WHITESPACE","\n    ",110],["T_PUBLIC","public",111],["T_WHITESPACE"," ",111],["T_FUNCTION","function",111],["T_WHITESPACE"," ",111],["T_STRING","persist",111],"(",["T_STRING","FixtureInterface",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$fixture",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_STRING","null",111],")",["T_WHITESPACE","\n    ",111],"{",["T_WHITESPACE","\n        ",112],["T_VARIABLE","$data",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","prepareData",113],"(",["T_VARIABLE","$fixture",113],")",";",["T_WHITESPACE","\n        ",113],["T_VARIABLE","$url",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_VARIABLE","$_ENV",114],"[",["T_CONSTANT_ENCAPSED_STRING","'app_frontend_url'",114],"]",["T_WHITESPACE"," ",114],".",["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","'rest\/V1\/salesRules'",114],";",["T_WHITESPACE","\n\n        ",114],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","webapiTransport",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","write",116],"(",["T_VARIABLE","$url",116],",",["T_WHITESPACE"," ",116],["T_VARIABLE","$data",116],")",";",["T_WHITESPACE","\n        ",116],["T_VARIABLE","$response",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_STRING","json_decode",117],"(",["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","webapiTransport",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","read",117],"(",")",",",["T_WHITESPACE"," ",117],["T_STRING","true",117],")",";",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","webapiTransport",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","close",118],"(",")",";",["T_WHITESPACE","\n\n        ",118],["T_IF","if",120],["T_WHITESPACE"," ",120],"(",["T_EMPTY","empty",120],"(",["T_VARIABLE","$response",120],"[",["T_CONSTANT_ENCAPSED_STRING","'rule_id'",120],"]",")",")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n            ",120],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","eventManager",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","dispatchEvent",121],"(","[",["T_CONSTANT_ENCAPSED_STRING","'webapi_failed'",121],"]",",",["T_WHITESPACE"," ",121],"[",["T_VARIABLE","$response",121],"]",")",";",["T_WHITESPACE","\n            ",121],["T_THROW","throw",122],["T_WHITESPACE"," ",122],["T_NEW","new",122],["T_WHITESPACE"," ",122],["T_NS_SEPARATOR","\\",122],["T_STRING","Exception",122],"(",["T_CONSTANT_ENCAPSED_STRING","'sales rule creation by webapi handler was not successful!'",122],")",";",["T_WHITESPACE","\n        ",122],"}",["T_WHITESPACE","\n\n        ",123],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","createCoupon",125],"(",["T_VARIABLE","$response",125],"[",["T_CONSTANT_ENCAPSED_STRING","'rule_id'",125],"]",")",";",["T_WHITESPACE","\n\n        ",125],["T_RETURN","return",127],["T_WHITESPACE"," ",127],"[",["T_CONSTANT_ENCAPSED_STRING","'rule_id'",127],["T_WHITESPACE"," ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$response",127],"[",["T_CONSTANT_ENCAPSED_STRING","'rule_id'",127],"]","]",";",["T_WHITESPACE","\n    ",127],"}",["T_WHITESPACE","\n\n    ",128],["T_DOC_COMMENT","\/**\n     * Prepare sales rule data for webapi request.\n     *\n     * @param FixtureInterface $fixture\n     * @return array\n     *\/",130],["T_WHITESPACE","\n    ",135],["T_PUBLIC","public",136],["T_WHITESPACE"," ",136],["T_FUNCTION","function",136],["T_WHITESPACE"," ",136],["T_STRING","prepareData",136],"(",["T_STRING","FixtureInterface",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$fixture",136],")",["T_WHITESPACE","\n    ",136],"{",["T_WHITESPACE","\n        ",137],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","fixture",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_VARIABLE","$fixture",138],";",["T_WHITESPACE","\n        ",138],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","data",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","handlerCurl",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","prepareData",139],"(",["T_VARIABLE","$fixture",139],")",";",["T_WHITESPACE","\n\n        ",139],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","prepareRuleInformation",141],"(",")",";",["T_WHITESPACE","\n        ",141],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","prepareConditions",142],"(",")",";",["T_WHITESPACE","\n        ",142],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","prepareActions",143],"(",")",";",["T_WHITESPACE","\n        ",143],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","prepareLabels",144],"(",")",";",["T_WHITESPACE","\n        ",144],["T_UNSET","unset",145],"(",["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","data",145],"[",["T_CONSTANT_ENCAPSED_STRING","'rule'",145],"]",")",";",["T_WHITESPACE","\n        ",145],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","prepareExtensionAttributes",146],"(",")",";",["T_WHITESPACE","\n\n        ",146],["T_RETURN","return",148],["T_WHITESPACE"," ",148],"[",["T_CONSTANT_ENCAPSED_STRING","'rule'",148],["T_WHITESPACE"," ",148],["T_DOUBLE_ARROW","=>",148],["T_WHITESPACE"," ",148],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","data",148],"]",";",["T_WHITESPACE","\n    ",148],"}",["T_WHITESPACE","\n\n    ",149],["T_DOC_COMMENT","\/**\n     * Preparation of \"Rule Information\" tab.\n     *\n     * @return void\n     *\/",151],["T_WHITESPACE","\n    ",155],["T_PROTECTED","protected",156],["T_WHITESPACE"," ",156],["T_FUNCTION","function",156],["T_WHITESPACE"," ",156],["T_STRING","prepareRuleInformation",156],"(",")",["T_WHITESPACE","\n    ",156],"{",["T_WHITESPACE","\n        ",157],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","data",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_STRING","array_diff_key",158],"(",["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","data",158],",",["T_WHITESPACE"," ",158],["T_STRING","array_flip",158],"(",["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","couponFields",158],")",")",";",["T_WHITESPACE","\n        ",158],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","data",159],"[",["T_CONSTANT_ENCAPSED_STRING","'coupon_type'",159],"]",["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_STRING","strtoupper",159],"(",["T_STRING","str_replace",159],"(",["T_CONSTANT_ENCAPSED_STRING","' '",159],",",["T_WHITESPACE"," ",159],["T_CONSTANT_ENCAPSED_STRING","'_'",159],",",["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","fixture",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","getCouponType",159],"(",")",")",")",";",["T_WHITESPACE","\n    ",159],"}",["T_WHITESPACE","\n\n    ",160],["T_DOC_COMMENT","\/**\n     * Preparation of \"Conditions\" tab.\n     *\n     * @return void\n     *\/",162],["T_WHITESPACE","\n    ",166],["T_PROTECTED","protected",167],["T_WHITESPACE"," ",167],["T_FUNCTION","function",167],["T_WHITESPACE"," ",167],["T_STRING","prepareConditions",167],"(",")",["T_WHITESPACE","\n    ",167],"{",["T_WHITESPACE","\n        ",168],["T_IF","if",169],["T_WHITESPACE"," ",169],"(",["T_ISSET","isset",169],"(",["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","data",169],"[",["T_CONSTANT_ENCAPSED_STRING","'rule'",169],"]","[",["T_CONSTANT_ENCAPSED_STRING","'conditions'",169],"]",")",")",["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n            ",169],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","data",170],"[",["T_CONSTANT_ENCAPSED_STRING","'condition'",170],"]",["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","convertCondition",170],"(",["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","data",170],"[",["T_CONSTANT_ENCAPSED_STRING","'rule'",170],"]","[",["T_CONSTANT_ENCAPSED_STRING","'conditions'",170],"]",")","[",["T_LNUMBER","0",170],"]",";",["T_WHITESPACE","\n        ",170],"}",["T_WHITESPACE","\n    ",171],"}",["T_WHITESPACE","\n\n    ",172],["T_DOC_COMMENT","\/**\n     * Preparation of \"Actions\" tab.\n     *\n     * @return void\n     *\/",174],["T_WHITESPACE","\n    ",178],["T_PROTECTED","protected",179],["T_WHITESPACE"," ",179],["T_FUNCTION","function",179],["T_WHITESPACE"," ",179],["T_STRING","prepareActions",179],"(",")",["T_WHITESPACE","\n    ",179],"{",["T_WHITESPACE","\n        ",180],["T_IF","if",181],["T_WHITESPACE"," ",181],"(",["T_ISSET","isset",181],"(",["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","data",181],"[",["T_CONSTANT_ENCAPSED_STRING","'rule'",181],"]","[",["T_CONSTANT_ENCAPSED_STRING","'actions'",181],"]",")",")",["T_WHITESPACE"," ",181],"{",["T_WHITESPACE","\n            ",181],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","data",182],"[",["T_CONSTANT_ENCAPSED_STRING","'action_condition'",182],"]",["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","convertCondition",182],"(",["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","data",182],"[",["T_CONSTANT_ENCAPSED_STRING","'rule'",182],"]","[",["T_CONSTANT_ENCAPSED_STRING","'actions'",182],"]",")","[",["T_LNUMBER","0",182],"]",";",["T_WHITESPACE","\n        ",182],"}",["T_WHITESPACE","\n    ",183],"}",["T_WHITESPACE","\n\n    ",184],["T_DOC_COMMENT","\/**\n     * Preparation of \"Labels\" tab.\n     *\n     * @return void\n     *\/",186],["T_WHITESPACE","\n    ",190],["T_PROTECTED","protected",191],["T_WHITESPACE"," ",191],["T_FUNCTION","function",191],["T_WHITESPACE"," ",191],["T_STRING","prepareLabels",191],"(",")",["T_WHITESPACE","\n    ",191],"{",["T_WHITESPACE","\n        ",192],["T_IF","if",193],["T_WHITESPACE"," ",193],"(",["T_ISSET","isset",193],"(",["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","data",193],"[",["T_CONSTANT_ENCAPSED_STRING","'store_labels'",193],"]",")",")",["T_WHITESPACE"," ",193],"{",["T_WHITESPACE","\n            ",193],["T_FOREACH","foreach",194],["T_WHITESPACE"," ",194],"(",["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","data",194],"[",["T_CONSTANT_ENCAPSED_STRING","'store_labels'",194],"]",["T_WHITESPACE"," ",194],["T_AS","as",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$storeId",194],["T_WHITESPACE"," ",194],["T_DOUBLE_ARROW","=>",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$label",194],")",["T_WHITESPACE"," ",194],"{",["T_WHITESPACE","\n                ",194],["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","data",195],"[",["T_CONSTANT_ENCAPSED_STRING","'store_labels'",195],"]","[",["T_VARIABLE","$storeId",195],"]",["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],"[",["T_WHITESPACE","\n                    ",195],["T_CONSTANT_ENCAPSED_STRING","'store_id'",196],["T_WHITESPACE"," ",196],["T_DOUBLE_ARROW","=>",196],["T_WHITESPACE"," ",196],["T_VARIABLE","$storeId",196],",",["T_WHITESPACE","\n                    ",196],["T_CONSTANT_ENCAPSED_STRING","'store_label'",197],["T_WHITESPACE"," ",197],["T_DOUBLE_ARROW","=>",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$label",197],["T_WHITESPACE","\n                ",197],"]",";",["T_WHITESPACE","\n            ",198],"}",["T_WHITESPACE","\n        ",199],"}",["T_WHITESPACE","\n    ",200],"}",["T_WHITESPACE","\n\n    ",201],["T_DOC_COMMENT","\/**\n     * Create coupon related to sales rule .\n     *\n     * @param int $ruleId\n     * @return void\n     * @throws \\Exception\n     *\/",203],["T_WHITESPACE","\n    ",209],["T_PROTECTED","protected",210],["T_WHITESPACE"," ",210],["T_FUNCTION","function",210],["T_WHITESPACE"," ",210],["T_STRING","createCoupon",210],"(",["T_VARIABLE","$ruleId",210],")",["T_WHITESPACE","\n    ",210],"{",["T_WHITESPACE","\n        ",211],["T_IF","if",212],["T_WHITESPACE"," ",212],"(","!",["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","fixture",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","hasData",212],"(",["T_CONSTANT_ENCAPSED_STRING","'coupon_code'",212],")",")",["T_WHITESPACE"," ",212],"{",["T_WHITESPACE","\n            ",212],["T_RETURN","return",213],";",["T_WHITESPACE","\n        ",213],"}",["T_WHITESPACE","\n\n        ",214],["T_VARIABLE","$url",216],["T_WHITESPACE"," ",216],"=",["T_WHITESPACE"," ",216],["T_VARIABLE","$_ENV",216],"[",["T_CONSTANT_ENCAPSED_STRING","'app_frontend_url'",216],"]",["T_WHITESPACE"," ",216],".",["T_WHITESPACE"," ",216],["T_CONSTANT_ENCAPSED_STRING","'rest\/V1\/coupons'",216],";",["T_WHITESPACE","\n        ",216],["T_VARIABLE","$data",217],["T_WHITESPACE"," ",217],"=",["T_WHITESPACE"," ",217],"[",["T_WHITESPACE","\n            ",217],["T_CONSTANT_ENCAPSED_STRING","'coupon'",218],["T_WHITESPACE"," ",218],["T_DOUBLE_ARROW","=>",218],["T_WHITESPACE"," ",218],["T_STRING","array_filter",218],"(","[",["T_WHITESPACE","\n                ",218],["T_CONSTANT_ENCAPSED_STRING","'rule_id'",219],["T_WHITESPACE"," ",219],["T_DOUBLE_ARROW","=>",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$ruleId",219],",",["T_WHITESPACE","\n                ",219],["T_CONSTANT_ENCAPSED_STRING","'code'",220],["T_WHITESPACE"," ",220],["T_DOUBLE_ARROW","=>",220],["T_WHITESPACE"," ",220],["T_VARIABLE","$this",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","fixture",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","getCouponCode",220],"(",")",",",["T_WHITESPACE","\n                ",220],["T_CONSTANT_ENCAPSED_STRING","'type'",221],["T_WHITESPACE"," ",221],["T_DOUBLE_ARROW","=>",221],["T_WHITESPACE"," ",221],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","mappingData",221],"[",["T_CONSTANT_ENCAPSED_STRING","'coupon_type'",221],"]","[",["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","fixture",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","getCouponType",221],"(",")","]",",",["T_WHITESPACE","\n                ",221],["T_CONSTANT_ENCAPSED_STRING","'usage_limit'",222],["T_WHITESPACE"," ",222],["T_DOUBLE_ARROW","=>",222],["T_WHITESPACE"," ",222],["T_ISSET","isset",222],"(",["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","data",222],"[",["T_CONSTANT_ENCAPSED_STRING","'uses_per_coupon'",222],"]",")",["T_WHITESPACE","\n                    ",222],"?",["T_WHITESPACE"," ",223],["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","data",223],"[",["T_CONSTANT_ENCAPSED_STRING","'uses_per_coupon'",223],"]",["T_WHITESPACE","\n                    ",223],":",["T_WHITESPACE"," ",224],["T_STRING","null",224],",",["T_WHITESPACE","\n                ",224],["T_CONSTANT_ENCAPSED_STRING","'usage_per_customer'",225],["T_WHITESPACE"," ",225],["T_DOUBLE_ARROW","=>",225],["T_WHITESPACE"," ",225],["T_ISSET","isset",225],"(",["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","data",225],"[",["T_CONSTANT_ENCAPSED_STRING","'usage_per_customer'",225],"]",")",["T_WHITESPACE","\n                    ",225],"?",["T_WHITESPACE"," ",226],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","data",226],"[",["T_CONSTANT_ENCAPSED_STRING","'usage_per_customer'",226],"]",["T_WHITESPACE","\n                    ",226],":",["T_WHITESPACE"," ",227],["T_STRING","null",227],",",["T_WHITESPACE","\n                ",227],["T_CONSTANT_ENCAPSED_STRING","'is_primary'",228],["T_WHITESPACE"," ",228],["T_DOUBLE_ARROW","=>",228],["T_WHITESPACE"," ",228],["T_STRING","true",228],["T_WHITESPACE","\n            ",228],"]",")",["T_WHITESPACE","\n        ",229],"]",";",["T_WHITESPACE","\n\n        ",230],["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","webapiTransport",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","write",232],"(",["T_VARIABLE","$url",232],",",["T_WHITESPACE"," ",232],["T_VARIABLE","$data",232],")",";",["T_WHITESPACE","\n        ",232],["T_VARIABLE","$response",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_STRING","json_decode",233],"(",["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","webapiTransport",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","read",233],"(",")",",",["T_WHITESPACE"," ",233],["T_STRING","true",233],")",";",["T_WHITESPACE","\n        ",233],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","webapiTransport",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","close",234],"(",")",";",["T_WHITESPACE","\n\n        ",234],["T_IF","if",236],["T_WHITESPACE"," ",236],"(",["T_EMPTY","empty",236],"(",["T_VARIABLE","$response",236],"[",["T_CONSTANT_ENCAPSED_STRING","'coupon_id'",236],"]",")",")",["T_WHITESPACE"," ",236],"{",["T_WHITESPACE","\n            ",236],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","eventManager",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","dispatchEvent",237],"(","[",["T_CONSTANT_ENCAPSED_STRING","'webapi_failed'",237],"]",",",["T_WHITESPACE"," ",237],"[",["T_VARIABLE","$response",237],"]",")",";",["T_WHITESPACE","\n            ",237],["T_THROW","throw",238],["T_WHITESPACE"," ",238],["T_NEW","new",238],["T_WHITESPACE"," ",238],["T_NS_SEPARATOR","\\",238],["T_STRING","Exception",238],"(",["T_CONSTANT_ENCAPSED_STRING","'Coupon creation by webapi handler was not successful!'",238],")",";",["T_WHITESPACE","\n        ",238],"}",["T_WHITESPACE","\n    ",239],"}",["T_WHITESPACE","\n\n    ",240],["T_DOC_COMMENT","\/**\n     * Convert condition data to webapi structure request.\n     *\n     * @param array $condition\n     * @param string $prefix [optional]\n     * @param int $indent [optional]\n     * @return array\n     *\n     * @SuppressWarnings(PHPMD.NPathComplexity)\n     *\/",242],["T_WHITESPACE","\n    ",251],["T_PROTECTED","protected",252],["T_WHITESPACE"," ",252],["T_FUNCTION","function",252],["T_WHITESPACE"," ",252],["T_STRING","convertCondition",252],"(",["T_ARRAY","array",252],["T_WHITESPACE"," ",252],["T_VARIABLE","$condition",252],",",["T_WHITESPACE"," ",252],["T_VARIABLE","$prefix",252],["T_WHITESPACE"," ",252],"=",["T_WHITESPACE"," ",252],["T_CONSTANT_ENCAPSED_STRING","''",252],",",["T_WHITESPACE"," ",252],["T_VARIABLE","$indent",252],["T_WHITESPACE"," ",252],"=",["T_WHITESPACE"," ",252],["T_LNUMBER","1",252],")",["T_WHITESPACE","\n    ",252],"{",["T_WHITESPACE","\n        ",253],["T_VARIABLE","$result",254],["T_WHITESPACE"," ",254],"=",["T_WHITESPACE"," ",254],"[","]",";",["T_WHITESPACE","\n\n        ",254],["T_VARIABLE","$key",256],["T_WHITESPACE"," ",256],"=",["T_WHITESPACE"," ",256],"\"",["T_CURLY_OPEN","{",256],["T_VARIABLE","$prefix",256],"}",["T_CURLY_OPEN","{",256],["T_VARIABLE","$indent",256],"}","\"",";",["T_WHITESPACE","\n        ",256],["T_VARIABLE","$isContinue",257],["T_WHITESPACE"," ",257],"=",["T_WHITESPACE"," ",257],["T_ISSET","isset",257],"(",["T_VARIABLE","$condition",257],"[",["T_VARIABLE","$key",257],"]",")",";",["T_WHITESPACE","\n        ",257],["T_WHILE","while",258],["T_WHITESPACE"," ",258],"(",["T_VARIABLE","$isContinue",258],")",["T_WHITESPACE"," ",258],"{",["T_WHITESPACE","\n            ",258],["T_VARIABLE","$childCondition",259],["T_WHITESPACE"," ",259],"=",["T_WHITESPACE"," ",259],["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","convertCondition",259],"(",["T_VARIABLE","$condition",259],",",["T_WHITESPACE"," ",259],"\"",["T_CURLY_OPEN","{",259],["T_VARIABLE","$prefix",259],"}",["T_CURLY_OPEN","{",259],["T_VARIABLE","$indent",259],"}",["T_ENCAPSED_AND_WHITESPACE","--",259],"\"",",",["T_WHITESPACE"," ",259],["T_LNUMBER","1",259],")",";",["T_WHITESPACE","\n            ",259],["T_VARIABLE","$result",260],"[","]",["T_WHITESPACE"," ",260],"=",["T_WHITESPACE"," ",260],["T_STRING","array_filter",260],"(","[",["T_WHITESPACE","\n                ",260],["T_CONSTANT_ENCAPSED_STRING","'condition_type'",261],["T_WHITESPACE"," ",261],["T_DOUBLE_ARROW","=>",261],["T_WHITESPACE"," ",261],["T_VARIABLE","$condition",261],"[",["T_VARIABLE","$key",261],"]","[",["T_CONSTANT_ENCAPSED_STRING","'type'",261],"]",",",["T_WHITESPACE","\n                ",261],["T_CONSTANT_ENCAPSED_STRING","'aggregator_type'",262],["T_WHITESPACE"," ",262],["T_DOUBLE_ARROW","=>",262],["T_WHITESPACE"," ",262],["T_ISSET","isset",262],"(",["T_VARIABLE","$condition",262],"[",["T_VARIABLE","$key",262],"]","[",["T_CONSTANT_ENCAPSED_STRING","'aggregator'",262],"]",")",["T_WHITESPACE","\n                    ",262],"?",["T_WHITESPACE"," ",263],["T_VARIABLE","$condition",263],"[",["T_VARIABLE","$key",263],"]","[",["T_CONSTANT_ENCAPSED_STRING","'aggregator'",263],"]",["T_WHITESPACE","\n                    ",263],":",["T_WHITESPACE"," ",264],["T_STRING","null",264],",",["T_WHITESPACE","\n                ",264],["T_CONSTANT_ENCAPSED_STRING","'attribute_name'",265],["T_WHITESPACE"," ",265],["T_DOUBLE_ARROW","=>",265],["T_WHITESPACE"," ",265],["T_ISSET","isset",265],"(",["T_VARIABLE","$condition",265],"[",["T_VARIABLE","$key",265],"]","[",["T_CONSTANT_ENCAPSED_STRING","'attribute'",265],"]",")",["T_WHITESPACE","\n                    ",265],"?",["T_WHITESPACE"," ",266],["T_VARIABLE","$condition",266],"[",["T_VARIABLE","$key",266],"]","[",["T_CONSTANT_ENCAPSED_STRING","'attribute'",266],"]",["T_WHITESPACE","\n                    ",266],":",["T_WHITESPACE"," ",267],["T_STRING","null",267],",",["T_WHITESPACE","\n                ",267],["T_CONSTANT_ENCAPSED_STRING","'operator'",268],["T_WHITESPACE"," ",268],["T_DOUBLE_ARROW","=>",268],["T_WHITESPACE"," ",268],["T_ISSET","isset",268],"(",["T_VARIABLE","$condition",268],"[",["T_VARIABLE","$key",268],"]","[",["T_CONSTANT_ENCAPSED_STRING","'operator'",268],"]",")",["T_WHITESPACE","\n                    ",268],"?",["T_WHITESPACE"," ",269],["T_VARIABLE","$condition",269],"[",["T_VARIABLE","$key",269],"]","[",["T_CONSTANT_ENCAPSED_STRING","'operator'",269],"]",["T_WHITESPACE","\n                    ",269],":",["T_WHITESPACE"," ",270],["T_STRING","null",270],",",["T_WHITESPACE","\n                ",270],["T_CONSTANT_ENCAPSED_STRING","'value'",271],["T_WHITESPACE"," ",271],["T_DOUBLE_ARROW","=>",271],["T_WHITESPACE"," ",271],["T_VARIABLE","$condition",271],"[",["T_VARIABLE","$key",271],"]","[",["T_CONSTANT_ENCAPSED_STRING","'value'",271],"]",",",["T_WHITESPACE","\n                ",271],["T_CONSTANT_ENCAPSED_STRING","'conditions'",272],["T_WHITESPACE"," ",272],["T_DOUBLE_ARROW","=>",272],["T_WHITESPACE"," ",272],["T_EMPTY","empty",272],"(",["T_VARIABLE","$childCondition",272],")",["T_WHITESPACE"," ",272],"?",["T_WHITESPACE"," ",272],["T_STRING","null",272],["T_WHITESPACE"," ",272],":",["T_WHITESPACE"," ",272],["T_VARIABLE","$childCondition",272],["T_WHITESPACE","\n            ",272],"]",",",["T_WHITESPACE"," ",273],"[",["T_VARIABLE","$this",273],",",["T_WHITESPACE"," ",273],["T_CONSTANT_ENCAPSED_STRING","'filterCondition'",273],"]",")",";",["T_WHITESPACE","\n\n            ",273],["T_VARIABLE","$indent",275],["T_WHITESPACE"," ",275],["T_PLUS_EQUAL","+=",275],["T_WHITESPACE"," ",275],["T_LNUMBER","1",275],";",["T_WHITESPACE","\n            ",275],["T_VARIABLE","$key",276],["T_WHITESPACE"," ",276],"=",["T_WHITESPACE"," ",276],"\"",["T_CURLY_OPEN","{",276],["T_VARIABLE","$prefix",276],"}",["T_CURLY_OPEN","{",276],["T_VARIABLE","$indent",276],"}","\"",";",["T_WHITESPACE","\n            ",276],["T_VARIABLE","$isContinue",277],["T_WHITESPACE"," ",277],"=",["T_WHITESPACE"," ",277],["T_ISSET","isset",277],"(",["T_VARIABLE","$condition",277],"[",["T_VARIABLE","$key",277],"]",")",";",["T_WHITESPACE","\n        ",277],"}",["T_WHITESPACE","\n\n        ",278],["T_RETURN","return",280],["T_WHITESPACE"," ",280],["T_VARIABLE","$result",280],";",["T_WHITESPACE","\n    ",280],"}",["T_WHITESPACE","\n\n    ",281],["T_DOC_COMMENT","\/**\n     * Prepare extension attributes for the sales rule.\n     *\n     * @return void\n     *\/",283],["T_WHITESPACE","\n    ",287],["T_PROTECTED","protected",288],["T_WHITESPACE"," ",288],["T_FUNCTION","function",288],["T_WHITESPACE"," ",288],["T_STRING","prepareExtensionAttributes",288],"(",")",["T_WHITESPACE","\n    ",288],"{",["T_WHITESPACE","\n        ",289],["T_FOREACH","foreach",290],["T_WHITESPACE"," ",290],"(",["T_VARIABLE","$this",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","data",290],["T_WHITESPACE"," ",290],["T_AS","as",290],["T_WHITESPACE"," ",290],["T_VARIABLE","$fieldName",290],["T_WHITESPACE"," ",290],["T_DOUBLE_ARROW","=>",290],["T_WHITESPACE"," ",290],["T_VARIABLE","$fieldValue",290],")",["T_WHITESPACE"," ",290],"{",["T_WHITESPACE","\n            ",290],["T_IF","if",291],["T_WHITESPACE"," ",291],"(","!",["T_STRING","in_array",291],"(",["T_VARIABLE","$fieldName",291],",",["T_WHITESPACE"," ",291],["T_VARIABLE","$this",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","basicAttributes",291],")",")",["T_WHITESPACE"," ",291],"{",["T_WHITESPACE","\n                ",291],["T_VARIABLE","$this",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","data",292],"[",["T_CONSTANT_ENCAPSED_STRING","'extension_attributes'",292],"]","[",["T_VARIABLE","$fieldName",292],"]",["T_WHITESPACE"," ",292],"=",["T_WHITESPACE"," ",292],["T_VARIABLE","$fieldValue",292],";",["T_WHITESPACE","\n                ",292],["T_UNSET","unset",293],"(",["T_VARIABLE","$this",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","data",293],"[",["T_VARIABLE","$fieldName",293],"]",")",";",["T_WHITESPACE","\n            ",293],"}",["T_WHITESPACE","\n        ",294],"}",["T_WHITESPACE","\n    ",295],"}",["T_WHITESPACE","\n\n    ",296],["T_DOC_COMMENT","\/**\n     * Filter condition data.\n     *\n     * @param mixed $var\n     * @return bool\n     *\/",298],["T_WHITESPACE","\n    ",303],["T_PUBLIC","public",304],["T_WHITESPACE"," ",304],["T_FUNCTION","function",304],["T_WHITESPACE"," ",304],["T_STRING","filterCondition",304],"(",["T_VARIABLE","$var",304],")",["T_WHITESPACE","\n    ",304],"{",["T_WHITESPACE","\n        ",305],["T_RETURN","return",306],["T_WHITESPACE"," ",306],["T_STRING","null",306],["T_WHITESPACE"," ",306],["T_IS_NOT_IDENTICAL","!==",306],["T_WHITESPACE"," ",306],["T_VARIABLE","$var",306],";",["T_WHITESPACE","\n    ",306],"}",["T_WHITESPACE","\n",307],"}",["T_WHITESPACE","\n",308]]