[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Braintree",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Test",6],["T_NS_SEPARATOR","\\",6],["T_STRING","TestStep",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Mtf",8],["T_NS_SEPARATOR","\\",8],["T_STRING","TestStep",8],["T_NS_SEPARATOR","\\",8],["T_STRING","TestStepInterface",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Mtf",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Util",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Protocol",9],["T_NS_SEPARATOR","\\",9],["T_STRING","CurlTransport",9],["T_NS_SEPARATOR","\\",9],["T_STRING","WebapiDecorator",9],";",["T_WHITESPACE","\n\n",9],["T_DOC_COMMENT","\/**\n * Class ChangeOrderStatusToPaymentReviewStep\n *\n * This step changes order status via WEB API to \"Payment Review\", because Kount service always\n * return \"Review\" status for sandbox transactions.\n *\/",11],["T_WHITESPACE","\n",16],["T_CLASS","class",17],["T_WHITESPACE"," ",17],["T_STRING","ChangeOrderStatusToPaymentReviewStep",17],["T_WHITESPACE"," ",17],["T_IMPLEMENTS","implements",17],["T_WHITESPACE"," ",17],["T_STRING","TestStepInterface",17],["T_WHITESPACE","\n",17],"{",["T_WHITESPACE","\n    ",18],["T_DOC_COMMENT","\/**\n     * @var string\n     *\/",19],["T_WHITESPACE","\n    ",21],["T_PRIVATE","private",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$orderId",22],";",["T_WHITESPACE","\n\n    ",22],["T_DOC_COMMENT","\/**\n     * @var WebapiDecorator\n     *\/",24],["T_WHITESPACE","\n    ",26],["T_PRIVATE","private",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$webApi",27],";",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * ChangeOrderStatusToPaymentReviewStep constructor.\n     * @param $orderId\n     * @param WebapiDecorator $webApi\n     *\/",29],["T_WHITESPACE","\n    ",33],["T_PUBLIC","public",34],["T_WHITESPACE"," ",34],["T_FUNCTION","function",34],["T_WHITESPACE"," ",34],["T_STRING","__construct",34],"(",["T_VARIABLE","$orderId",34],",",["T_WHITESPACE"," ",34],["T_STRING","WebapiDecorator",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$webApi",34],")",["T_WHITESPACE","\n    ",34],"{",["T_WHITESPACE","\n        ",35],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","orderId",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$orderId",36],";",["T_WHITESPACE","\n        ",36],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","webApi",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_VARIABLE","$webApi",37],";",["T_WHITESPACE","\n    ",37],"}",["T_WHITESPACE","\n\n    ",38],["T_DOC_COMMENT","\/**\n     * @inheritdoc\n     *\/",40],["T_WHITESPACE","\n    ",42],["T_PUBLIC","public",43],["T_WHITESPACE"," ",43],["T_FUNCTION","function",43],["T_WHITESPACE"," ",43],["T_STRING","run",43],"(",")",["T_WHITESPACE","\n    ",43],"{",["T_WHITESPACE","\n        ",44],["T_VARIABLE","$order",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","getOrder",45],"(",["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","orderId",45],")",";",["T_WHITESPACE","\n        ",45],["T_VARIABLE","$order",46],"[",["T_CONSTANT_ENCAPSED_STRING","'state'",46],"]",["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'payment_review'",46],";",["T_WHITESPACE","\n        ",46],["T_VARIABLE","$order",47],"[",["T_CONSTANT_ENCAPSED_STRING","'status'",47],"]",["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_CONSTANT_ENCAPSED_STRING","'fraud'",47],";",["T_WHITESPACE","\n        ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","saveOrder",48],"(",["T_VARIABLE","$order",48],")",";",["T_WHITESPACE","\n    ",48],"}",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Get order by increment id\n     * @param string $incrementId\n     * @return array\n     *\/",51],["T_WHITESPACE","\n    ",55],["T_PRIVATE","private",56],["T_WHITESPACE"," ",56],["T_FUNCTION","function",56],["T_WHITESPACE"," ",56],["T_STRING","getOrder",56],"(",["T_VARIABLE","$incrementId",56],")",["T_WHITESPACE","\n    ",56],"{",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$url",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$_ENV",58],"[",["T_CONSTANT_ENCAPSED_STRING","'app_frontend_url'",58],"]",["T_WHITESPACE"," ",58],".",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'rest\/V1\/orders\/'",58],";",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$url",59],["T_WHITESPACE"," ",59],["T_CONCAT_EQUAL",".=",59],["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'?searchCriteria[filterGroups][0][filters][0][field]=increment_id'",59],";",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$url",60],["T_WHITESPACE"," ",60],["T_CONCAT_EQUAL",".=",60],["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'&searchCriteria[filterGroups][0][filters][0][value]='",60],["T_WHITESPACE"," ",60],".",["T_WHITESPACE"," ",60],["T_VARIABLE","$incrementId",60],";",["T_WHITESPACE","\n        ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","webApi",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","write",61],"(",["T_VARIABLE","$url",61],",",["T_WHITESPACE"," ",61],"[","]",",",["T_WHITESPACE"," ",61],["T_STRING","WebapiDecorator",61],["T_DOUBLE_COLON","::",61],["T_STRING","GET",61],")",";",["T_WHITESPACE","\n        ",61],["T_VARIABLE","$response",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_STRING","json_decode",62],"(",["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","webApi",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","read",62],"(",")",",",["T_WHITESPACE"," ",62],["T_STRING","true",62],")",";",["T_WHITESPACE","\n        ",62],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","webApi",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","close",63],"(",")",";",["T_WHITESPACE","\n        ",63],["T_RETURN","return",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$response",64],"[",["T_CONSTANT_ENCAPSED_STRING","'items'",64],"]","[",["T_LNUMBER","0",64],"]",";",["T_WHITESPACE","\n    ",64],"}",["T_WHITESPACE","\n\n    ",65],["T_DOC_COMMENT","\/**\n     * Update order entity\n     * @param array $order\n     * @throws \\Exception\n     *\/",67],["T_WHITESPACE","\n    ",71],["T_PRIVATE","private",72],["T_WHITESPACE"," ",72],["T_FUNCTION","function",72],["T_WHITESPACE"," ",72],["T_STRING","saveOrder",72],"(",["T_ARRAY","array",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$order",72],")",["T_WHITESPACE","\n    ",72],"{",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$url",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$_ENV",74],"[",["T_CONSTANT_ENCAPSED_STRING","'app_frontend_url'",74],"]",["T_WHITESPACE"," ",74],".",["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","'rest\/V1\/orders'",74],";",["T_WHITESPACE","\n        ",74],["T_COMMENT","\/\/ web api doesn't allow to save payment additional information\n",75],["T_WHITESPACE","        ",76],["T_UNSET","unset",76],"(",["T_VARIABLE","$order",76],"[",["T_CONSTANT_ENCAPSED_STRING","'payment'",76],"]","[",["T_CONSTANT_ENCAPSED_STRING","'additional_information'",76],"]",")",";",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","webApi",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","write",77],"(",["T_VARIABLE","$url",77],",",["T_WHITESPACE"," ",77],"[",["T_CONSTANT_ENCAPSED_STRING","'entity'",77],["T_WHITESPACE"," ",77],["T_DOUBLE_ARROW","=>",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$order",77],"]",",",["T_WHITESPACE"," ",77],["T_STRING","WebapiDecorator",77],["T_DOUBLE_COLON","::",77],["T_STRING","POST",77],")",";",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$response",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_STRING","json_decode",78],"(",["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","webApi",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","read",78],"(",")",",",["T_WHITESPACE"," ",78],["T_STRING","true",78],")",";",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","webApi",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","close",79],"(",")",";",["T_WHITESPACE","\n        ",79],["T_IF","if",80],["T_WHITESPACE"," ",80],"(",["T_EMPTY","empty",80],"(",["T_VARIABLE","$response",80],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",80],"]",")",")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n            ",80],["T_THROW","throw",81],["T_WHITESPACE"," ",81],["T_NEW","new",81],["T_WHITESPACE"," ",81],["T_NS_SEPARATOR","\\",81],["T_STRING","Exception",81],"(",["T_CONSTANT_ENCAPSED_STRING","'Couldn\\'t update order details'",81],")",";",["T_WHITESPACE","\n        ",81],"}",["T_WHITESPACE","\n    ",82],"}",["T_WHITESPACE","\n",83],"}",["T_WHITESPACE","\n",84]]