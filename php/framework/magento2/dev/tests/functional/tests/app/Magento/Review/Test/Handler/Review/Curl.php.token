[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Review",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Test",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Handler",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Review",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Mtf",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Fixture",9],["T_NS_SEPARATOR","\\",9],["T_STRING","FixtureInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Mtf",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Util",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Protocol",10],["T_NS_SEPARATOR","\\",10],["T_STRING","CurlTransport",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Review",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Test",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Fixture",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Rating",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Backend",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Test",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Handler",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Extractor",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Review",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Test",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Fixture",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Review",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Mtf",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Util",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Protocol",14],["T_NS_SEPARATOR","\\",14],["T_STRING","CurlTransport",14],["T_NS_SEPARATOR","\\",14],["T_STRING","BackendDecorator",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Magento",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Mtf",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Handler",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Curl",15],["T_WHITESPACE"," ",15],["T_AS","as",15],["T_WHITESPACE"," ",15],["T_STRING","AbstractCurl",15],";",["T_WHITESPACE","\n\n",15],["T_DOC_COMMENT","\/**\n * Class Curl\n * Curl handler for creating product Review through backend.\n *\/",17],["T_WHITESPACE","\n",20],["T_CLASS","class",21],["T_WHITESPACE"," ",21],["T_STRING","Curl",21],["T_WHITESPACE"," ",21],["T_EXTENDS","extends",21],["T_WHITESPACE"," ",21],["T_STRING","AbstractCurl",21],["T_WHITESPACE"," ",21],["T_IMPLEMENTS","implements",21],["T_WHITESPACE"," ",21],["T_STRING","ReviewInterface",21],["T_WHITESPACE","\n",21],"{",["T_WHITESPACE","\n    ",22],["T_DOC_COMMENT","\/**\n     * Mapping values for data.\n     *\n     * @var array\n     *\/",23],["T_WHITESPACE","\n    ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$mappingData",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],"[",["T_WHITESPACE","\n        ",28],["T_CONSTANT_ENCAPSED_STRING","'status_id'",29],["T_WHITESPACE"," ",29],["T_DOUBLE_ARROW","=>",29],["T_WHITESPACE"," ",29],"[",["T_WHITESPACE","\n            ",29],["T_CONSTANT_ENCAPSED_STRING","'Approved'",30],["T_WHITESPACE"," ",30],["T_DOUBLE_ARROW","=>",30],["T_WHITESPACE"," ",30],["T_LNUMBER","1",30],",",["T_WHITESPACE","\n            ",30],["T_CONSTANT_ENCAPSED_STRING","'Pending'",31],["T_WHITESPACE"," ",31],["T_DOUBLE_ARROW","=>",31],["T_WHITESPACE"," ",31],["T_LNUMBER","2",31],",",["T_WHITESPACE","\n            ",31],["T_CONSTANT_ENCAPSED_STRING","'Not Approved'",32],["T_WHITESPACE"," ",32],["T_DOUBLE_ARROW","=>",32],["T_WHITESPACE"," ",32],["T_LNUMBER","3",32],["T_WHITESPACE","\n        ",32],"]",",",["T_WHITESPACE","\n        ",33],["T_CONSTANT_ENCAPSED_STRING","'select_stores'",34],["T_WHITESPACE"," ",34],["T_DOUBLE_ARROW","=>",34],["T_WHITESPACE"," ",34],"[",["T_WHITESPACE","\n            ",34],["T_CONSTANT_ENCAPSED_STRING","'Main Website\/Main Website Store\/Default Store View'",35],["T_WHITESPACE"," ",35],["T_DOUBLE_ARROW","=>",35],["T_WHITESPACE"," ",35],["T_LNUMBER","1",35],["T_WHITESPACE","\n        ",35],"]",["T_WHITESPACE","\n    ",36],"]",";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * Post request for creating product Review in backend\n     *\n     * @param FixtureInterface|null $review [optional]\n     * @return array\n     * @throws \\Exception\n     *\/",39],["T_WHITESPACE","\n    ",45],["T_PUBLIC","public",46],["T_WHITESPACE"," ",46],["T_FUNCTION","function",46],["T_WHITESPACE"," ",46],["T_STRING","persist",46],"(",["T_STRING","FixtureInterface",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$review",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_STRING","null",46],")",["T_WHITESPACE","\n    ",46],"{",["T_WHITESPACE","\n        ",47],["T_DOC_COMMENT","\/** @var Review $review *\/",48],["T_WHITESPACE","\n        ",48],["T_VARIABLE","$url",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$_ENV",49],"[",["T_CONSTANT_ENCAPSED_STRING","'app_backend_url'",49],"]",["T_WHITESPACE"," ",49],".",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'review\/product\/post\/'",49],";",["T_WHITESPACE","\n        ",49],["T_VARIABLE","$curl",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_NEW","new",50],["T_WHITESPACE"," ",50],["T_STRING","BackendDecorator",50],"(",["T_NEW","new",50],["T_WHITESPACE"," ",50],["T_STRING","CurlTransport",50],"(",")",",",["T_WHITESPACE"," ",50],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","_configuration",50],")",";",["T_WHITESPACE","\n        ",50],["T_VARIABLE","$data",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","replaceMappingData",51],"(",["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","getPreparedData",51],"(",["T_VARIABLE","$review",51],")",")",";",["T_WHITESPACE","\n\n        ",51],["T_VARIABLE","$curl",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","write",53],"(",["T_VARIABLE","$url",53],",",["T_WHITESPACE"," ",53],["T_VARIABLE","$data",53],")",";",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$response",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$curl",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","read",54],"(",")",";",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$curl",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","close",55],"(",")",";",["T_WHITESPACE","\n        ",55],["T_IF","if",56],["T_WHITESPACE"," ",56],"(","!",["T_STRING","strpos",56],"(",["T_VARIABLE","$response",56],",",["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'data-ui-id=\"messages-message-success\"'",56],")",")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n            ",56],["T_THROW","throw",57],["T_WHITESPACE"," ",57],["T_NEW","new",57],["T_WHITESPACE"," ",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Exception",57],"(",["T_WHITESPACE","\n                ",57],["T_CONSTANT_ENCAPSED_STRING","'Product Review entity creating by curl handler was not successful! Response:'",58],["T_WHITESPACE"," ",58],".",["T_WHITESPACE"," ",58],["T_VARIABLE","$response",58],["T_WHITESPACE","\n            ",58],")",";",["T_WHITESPACE","\n        ",59],"}",["T_WHITESPACE","\n\n        ",60],["T_RETURN","return",62],["T_WHITESPACE"," ",62],"[",["T_CONSTANT_ENCAPSED_STRING","'review_id'",62],["T_WHITESPACE"," ",62],["T_DOUBLE_ARROW","=>",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","getReviewId",62],"(",")","]",";",["T_WHITESPACE","\n    ",62],"}",["T_WHITESPACE","\n\n    ",63],["T_DOC_COMMENT","\/**\n     * Prepare and return data of review\n     *\n     * @param FixtureInterface $review\n     * @return array\n     *\/",65],["T_WHITESPACE","\n    ",70],["T_PROTECTED","protected",71],["T_WHITESPACE"," ",71],["T_FUNCTION","function",71],["T_WHITESPACE"," ",71],["T_STRING","getPreparedData",71],"(",["T_STRING","FixtureInterface",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$review",71],")",["T_WHITESPACE","\n    ",71],"{",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$data",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$review",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","getData",73],"(",")",";",["T_WHITESPACE","\n\n        ",73],["T_COMMENT","\/* Prepare ratings *\/",75],["T_WHITESPACE","\n        ",75],["T_IF","if",76],["T_WHITESPACE"," ",76],"(",["T_VARIABLE","$review",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","hasData",76],"(",["T_CONSTANT_ENCAPSED_STRING","'ratings'",76],")",")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n            ",76],["T_VARIABLE","$sourceRatings",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$review",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getDataFieldConfig",77],"(",["T_CONSTANT_ENCAPSED_STRING","'ratings'",77],")","[",["T_CONSTANT_ENCAPSED_STRING","'source'",77],"]",";",["T_WHITESPACE","\n            ",77],["T_VARIABLE","$ratings",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],"[","]",";",["T_WHITESPACE","\n            ",78],["T_FOREACH","foreach",79],["T_WHITESPACE"," ",79],"(",["T_VARIABLE","$data",79],"[",["T_CONSTANT_ENCAPSED_STRING","'ratings'",79],"]",["T_WHITESPACE"," ",79],["T_AS","as",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$rating",79],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n                ",79],["T_VARIABLE","$ratings",80],"[",["T_VARIABLE","$rating",80],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",80],"]","]",["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$rating",80],"[",["T_CONSTANT_ENCAPSED_STRING","'rating'",80],"]",";",["T_WHITESPACE","\n            ",80],"}",["T_WHITESPACE","\n            ",81],["T_VARIABLE","$data",82],"[",["T_CONSTANT_ENCAPSED_STRING","'ratings'",82],"]",["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],"[","]",";",["T_WHITESPACE","\n            ",82],["T_FOREACH","foreach",83],["T_WHITESPACE"," ",83],"(",["T_VARIABLE","$sourceRatings",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","getRatings",83],"(",")",["T_WHITESPACE"," ",83],["T_AS","as",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$ratingFixture",83],")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n                ",83],["T_DOC_COMMENT","\/** @var Rating $ratingFixture *\/",84],["T_WHITESPACE","\n                ",84],["T_VARIABLE","$ratingCode",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_VARIABLE","$ratingFixture",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","getRatingCode",85],"(",")",";",["T_WHITESPACE","\n                ",85],["T_IF","if",86],["T_WHITESPACE"," ",86],"(",["T_ISSET","isset",86],"(",["T_VARIABLE","$ratings",86],"[",["T_VARIABLE","$ratingCode",86],"]",")",")",["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n                    ",86],["T_VARIABLE","$ratingOptions",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_VARIABLE","$ratingFixture",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getOptions",87],"(",")",";",["T_WHITESPACE","\n                    ",87],["T_VARIABLE","$vote",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$ratings",88],"[",["T_VARIABLE","$ratingCode",88],"]",";",["T_WHITESPACE","\n                    ",88],["T_VARIABLE","$data",89],"[",["T_CONSTANT_ENCAPSED_STRING","'ratings'",89],"]","[",["T_VARIABLE","$ratingFixture",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getRatingId",89],"(",")","]",["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$ratingOptions",89],"[",["T_VARIABLE","$vote",89],"]",";",["T_WHITESPACE","\n                ",89],"}",["T_WHITESPACE","\n            ",90],"}",["T_WHITESPACE","\n        ",91],"}",["T_WHITESPACE","\n\n        ",92],["T_IF","if",94],["T_WHITESPACE"," ",94],"(",["T_VARIABLE","$review",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","hasData",94],"(",["T_CONSTANT_ENCAPSED_STRING","'select_stores'",94],")",")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n            ",94],["T_FOREACH","foreach",95],["T_WHITESPACE"," ",95],"(",["T_STRING","array_keys",95],"(",["T_VARIABLE","$data",95],"[",["T_CONSTANT_ENCAPSED_STRING","'select_stores'",95],"]",")",["T_WHITESPACE"," ",95],["T_AS","as",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$key",95],")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n                ",95],["T_IF","if",96],["T_WHITESPACE"," ",96],"(",["T_ISSET","isset",96],"(",["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","mappingData",96],"[",["T_CONSTANT_ENCAPSED_STRING","'select_stores'",96],"]","[",["T_VARIABLE","$data",96],"[",["T_CONSTANT_ENCAPSED_STRING","'select_stores'",96],"]","[",["T_VARIABLE","$key",96],"]","]",")",")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n                    ",96],["T_VARIABLE","$data",97],"[",["T_CONSTANT_ENCAPSED_STRING","'select_stores'",97],"]","[",["T_VARIABLE","$key",97],"]",["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","mappingData",97],"[",["T_CONSTANT_ENCAPSED_STRING","'select_stores'",97],"]","[",["T_VARIABLE","$data",97],"[",["T_CONSTANT_ENCAPSED_STRING","'select_stores'",97],"]","[",["T_VARIABLE","$key",97],"]","]",";",["T_WHITESPACE","\n                ",97],"}",["T_WHITESPACE","\n            ",98],"}",["T_WHITESPACE","\n        ",99],"}",["T_WHITESPACE","\n\n        ",100],["T_COMMENT","\/* Prepare product id *\/",102],["T_WHITESPACE","\n        ",102],["T_VARIABLE","$data",103],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",103],"]",["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$data",103],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",103],"]",";",["T_WHITESPACE","\n        ",103],["T_UNSET","unset",104],"(",["T_VARIABLE","$data",104],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",104],"]",")",";",["T_WHITESPACE","\n\n        ",104],["T_RETURN","return",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$data",106],";",["T_WHITESPACE","\n    ",106],"}",["T_WHITESPACE","\n\n    ",107],["T_DOC_COMMENT","\/**\n     * Get product Rating id\n     *\n     * @return int|null\n     *\/",109],["T_WHITESPACE","\n    ",113],["T_PROTECTED","protected",114],["T_WHITESPACE"," ",114],["T_FUNCTION","function",114],["T_WHITESPACE"," ",114],["T_STRING","getReviewId",114],"(",")",["T_WHITESPACE","\n    ",114],"{",["T_WHITESPACE","\n        ",115],["T_VARIABLE","$url",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","'review\/product\/index\/sort\/review_id\/dir\/desc\/'",116],";",["T_WHITESPACE","\n        ",116],["T_VARIABLE","$regex",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_CONSTANT_ENCAPSED_STRING","'\/class=\"[^\"]+col-id[^\"]+\"[^>]*>\\s*([0-9]+)\\s*<\/'",117],";",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$extractor",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_NEW","new",118],["T_WHITESPACE"," ",118],["T_STRING","Extractor",118],"(",["T_VARIABLE","$url",118],",",["T_WHITESPACE"," ",118],["T_VARIABLE","$regex",118],")",";",["T_WHITESPACE","\n        ",118],["T_VARIABLE","$match",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$extractor",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getData",119],"(",")",";",["T_WHITESPACE","\n\n        ",119],["T_RETURN","return",121],["T_WHITESPACE"," ",121],["T_EMPTY","empty",121],"(",["T_VARIABLE","$match",121],"[",["T_LNUMBER","1",121],"]",")",["T_WHITESPACE"," ",121],"?",["T_WHITESPACE"," ",121],["T_STRING","null",121],["T_WHITESPACE"," ",121],":",["T_WHITESPACE"," ",121],["T_INT_CAST","(int)",121],["T_VARIABLE","$match",121],"[",["T_LNUMBER","1",121],"]",";",["T_WHITESPACE","\n    ",121],"}",["T_WHITESPACE","\n",122],"}",["T_WHITESPACE","\n",123]]