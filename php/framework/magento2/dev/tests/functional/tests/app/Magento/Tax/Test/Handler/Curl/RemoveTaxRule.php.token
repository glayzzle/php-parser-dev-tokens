[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Tax",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Test",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Handler",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Curl",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Mtf",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Fixture",9],["T_NS_SEPARATOR","\\",9],["T_STRING","FixtureInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Mtf",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Handler",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Curl",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Mtf",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Util",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Protocol",11],["T_NS_SEPARATOR","\\",11],["T_STRING","CurlInterface",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Mtf",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Util",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Protocol",12],["T_NS_SEPARATOR","\\",12],["T_STRING","CurlTransport",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Mtf",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Util",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Protocol",13],["T_NS_SEPARATOR","\\",13],["T_STRING","CurlTransport",13],["T_NS_SEPARATOR","\\",13],["T_STRING","BackendDecorator",13],";",["T_WHITESPACE","\n\n",13],["T_DOC_COMMENT","\/**\n * Curl handler remove all tax rules\n *\n *\/",15],["T_WHITESPACE","\n",18],["T_CLASS","class",19],["T_WHITESPACE"," ",19],["T_STRING","RemoveTaxRule",19],["T_WHITESPACE"," ",19],["T_EXTENDS","extends",19],["T_WHITESPACE"," ",19],["T_STRING","Curl",19],["T_WHITESPACE","\n",19],"{",["T_WHITESPACE","\n    ",20],["T_DOC_COMMENT","\/**\n     * Default EN_US message after removing tax rule\n     *\/",21],["T_WHITESPACE","\n    ",23],["T_CONST","const",24],["T_WHITESPACE"," ",24],["T_STRING","TAX_RULE_REMOVE_MESSAGE",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","'The tax rule has been deleted'",24],";",["T_WHITESPACE","\n\n    ",24],["T_DOC_COMMENT","\/**\n     * @var string\n     *\/",26],["T_WHITESPACE","\n    ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$taxRuleGridUrl",29],";",["T_WHITESPACE","\n\n    ",29],["T_DOC_COMMENT","\/**\n     * Entry point for handler\n     *\n     * @param FixtureInterface $fixture [optional]\n     * @return mixed|string\n     *\n     * @SuppressWarnings(PHPMD.UnusedFormalParameter)\n     *\/",31],["T_WHITESPACE","\n    ",38],["T_PUBLIC","public",39],["T_WHITESPACE"," ",39],["T_FUNCTION","function",39],["T_WHITESPACE"," ",39],["T_STRING","persist",39],"(",["T_STRING","FixtureInterface",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$fixture",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_STRING","null",39],")",["T_WHITESPACE","\n    ",39],"{",["T_WHITESPACE","\n        ",40],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","taxRuleGridUrl",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$_ENV",41],"[",["T_CONSTANT_ENCAPSED_STRING","'app_backend_url'",41],"]",["T_WHITESPACE"," ",41],".",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'tax\/rule\/index\/'",41],";",["T_WHITESPACE","\n        ",41],["T_VARIABLE","$curl",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","getCurl",42],"(",["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","taxRuleGridUrl",42],")",";",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$response",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_VARIABLE","$curl",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","read",43],"(",")",";",["T_WHITESPACE","\n        ",43],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","removeTaxRules",44],"(",["T_VARIABLE","$response",44],")",";",["T_WHITESPACE","\n        ",44],["T_VARIABLE","$curl",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","close",45],"(",")",";",["T_WHITESPACE","\n        ",45],["T_RETURN","return",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$response",46],";",["T_WHITESPACE","\n    ",46],"}",["T_WHITESPACE","\n\n    ",47],["T_DOC_COMMENT","\/**\n     * Prepare and return curl object\n     *\n     * @param string $url\n     * @return BackendDecorator\n     *\/",49],["T_WHITESPACE","\n    ",54],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_FUNCTION","function",55],["T_WHITESPACE"," ",55],["T_STRING","getCurl",55],"(",["T_VARIABLE","$url",55],")",["T_WHITESPACE","\n    ",55],"{",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$curl",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_NEW","new",57],["T_WHITESPACE"," ",57],["T_STRING","BackendDecorator",57],"(",["T_NEW","new",57],["T_WHITESPACE"," ",57],["T_STRING","CurlTransport",57],"(",")",",",["T_WHITESPACE"," ",57],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","_configuration",57],")",";",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$curl",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","write",58],"(",["T_VARIABLE","$url",58],",",["T_WHITESPACE"," ",58],"[","]",",",["T_WHITESPACE"," ",58],["T_STRING","CurlInterface",58],["T_DOUBLE_COLON","::",58],["T_STRING","GET",58],")",";",["T_WHITESPACE","\n        ",58],["T_RETURN","return",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$curl",59],";",["T_WHITESPACE","\n    ",59],"}",["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * Recursively remove tax rules\n     *\n     * @param string $data\n     * @return mixed\n     *\/",62],["T_WHITESPACE","\n    ",67],["T_PROTECTED","protected",68],["T_WHITESPACE"," ",68],["T_FUNCTION","function",68],["T_WHITESPACE"," ",68],["T_STRING","removeTaxRules",68],"(",["T_VARIABLE","$data",68],")",["T_WHITESPACE","\n    ",68],"{",["T_WHITESPACE","\n        ",69],["T_STRING","preg_match_all",70],"(",["T_CONSTANT_ENCAPSED_STRING","\"!tax\\\/rule\\\/edit\\\/rule\\\/([\\d]+)!\"",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$data",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$result",70],")",";",["T_WHITESPACE","\n        ",70],["T_IF","if",71],["T_WHITESPACE"," ",71],"(","!",["T_ISSET","isset",71],"(",["T_VARIABLE","$result",71],"[",["T_LNUMBER","1",71],"]",")",["T_WHITESPACE"," ",71],["T_BOOLEAN_OR","||",71],["T_WHITESPACE"," ",71],["T_EMPTY","empty",71],"(",["T_VARIABLE","$result",71],"[",["T_LNUMBER","1",71],"]",")",")",["T_WHITESPACE"," ",71],"{",["T_WHITESPACE","\n            ",71],["T_RETURN","return",72],["T_WHITESPACE"," ",72],["T_STRING","null",72],";",["T_WHITESPACE","\n        ",72],"}",["T_WHITESPACE","\n        ",73],["T_FOREACH","foreach",74],["T_WHITESPACE"," ",74],"(",["T_VARIABLE","$result",74],"[",["T_LNUMBER","1",74],"]",["T_WHITESPACE"," ",74],["T_AS","as",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$taxRuleId",74],")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n            ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","_deleteTaxRuleRequest",75],"(",["T_INT_CAST","(int)",75],["T_VARIABLE","$taxRuleId",75],")",";",["T_WHITESPACE","\n            ",75],["T_BREAK","break",76],";",["T_WHITESPACE","\n        ",76],"}",["T_WHITESPACE","\n\n        ",77],["T_VARIABLE","$curl",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","getCurl",79],"(",["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","taxRuleGridUrl",79],")",";",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$response",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$curl",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","read",80],"(",")",";",["T_WHITESPACE","\n        ",80],["T_VARIABLE","$curl",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","close",81],"(",")",";",["T_WHITESPACE","\n        ",81],["T_RETURN","return",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","removeTaxRules",82],"(",["T_VARIABLE","$response",82],")",";",["T_WHITESPACE","\n    ",82],"}",["T_WHITESPACE","\n\n    ",83],["T_DOC_COMMENT","\/**\n     * Make request to delete tax rule\n     *\n     * @param int $taxRuleId\n     *\/",85],["T_WHITESPACE","\n    ",89],["T_PROTECTED","protected",90],["T_WHITESPACE"," ",90],["T_FUNCTION","function",90],["T_WHITESPACE"," ",90],["T_STRING","deleteTaxRuleRequest",90],"(",["T_VARIABLE","$taxRuleId",90],")",["T_WHITESPACE","\n    ",90],"{",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$url",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$_ENV",92],"[",["T_CONSTANT_ENCAPSED_STRING","'app_backend_url'",92],"]",["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'tax\/rule\/delete\/rule\/'",92],["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_INT_CAST","(int)",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$taxRuleId",92],";",["T_WHITESPACE","\n        ",92],["T_VARIABLE","$curl",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getCurl",93],"(",["T_VARIABLE","$url",93],")",";",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$response",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_VARIABLE","$curl",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","read",94],"(",")",";",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","checkMessage",95],"(",["T_VARIABLE","$response",95],",",["T_WHITESPACE"," ",95],["T_VARIABLE","$taxRuleId",95],")",";",["T_WHITESPACE","\n        ",95],["T_VARIABLE","$curl",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","close",96],"(",")",";",["T_WHITESPACE","\n    ",96],"}",["T_WHITESPACE","\n\n    ",97],["T_DOC_COMMENT","\/**\n     * Validation for successfully deleted tax rule\n     *\n     * @param string $data\n     * @param int $taxRuleId\n     * @throws \\RuntimeException\n     *\/",99],["T_WHITESPACE","\n    ",105],["T_PROTECTED","protected",106],["T_WHITESPACE"," ",106],["T_FUNCTION","function",106],["T_WHITESPACE"," ",106],["T_STRING","checkMessage",106],"(",["T_VARIABLE","$data",106],",",["T_WHITESPACE"," ",106],["T_VARIABLE","$taxRuleId",106],")",["T_WHITESPACE","\n    ",106],"{",["T_WHITESPACE","\n        ",107],["T_STRING","preg_match_all",108],"(",["T_CONSTANT_ENCAPSED_STRING","'!('",108],["T_WHITESPACE"," ",108],".",["T_WHITESPACE"," ",108],["T_STATIC","static",108],["T_DOUBLE_COLON","::",108],["T_STRING","TAX_RULE_REMOVE_MESSAGE",108],["T_WHITESPACE"," ",108],".",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","')!'",108],",",["T_WHITESPACE"," ",108],["T_VARIABLE","$data",108],",",["T_WHITESPACE"," ",108],["T_VARIABLE","$result",108],")",";",["T_WHITESPACE","\n        ",108],["T_IF","if",109],["T_WHITESPACE"," ",109],"(","!",["T_ISSET","isset",109],"(",["T_VARIABLE","$result",109],"[",["T_LNUMBER","1",109],"]",")",["T_WHITESPACE"," ",109],["T_BOOLEAN_OR","||",109],["T_WHITESPACE"," ",109],["T_EMPTY","empty",109],"(",["T_VARIABLE","$result",109],"[",["T_LNUMBER","1",109],"]",")",")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n            ",109],["T_THROW","throw",110],["T_WHITESPACE"," ",110],["T_NEW","new",110],["T_WHITESPACE"," ",110],["T_NS_SEPARATOR","\\",110],["T_STRING","RuntimeException",110],"(",["T_CONSTANT_ENCAPSED_STRING","'Tax rule ID '",110],["T_WHITESPACE"," ",110],".",["T_WHITESPACE"," ",110],["T_VARIABLE","$taxRuleId",110],["T_WHITESPACE"," ",110],".",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'not removed!'",110],")",";",["T_WHITESPACE","\n        ",110],"}",["T_WHITESPACE","\n    ",111],"}",["T_WHITESPACE","\n",112],"}",["T_WHITESPACE","\n",113]]