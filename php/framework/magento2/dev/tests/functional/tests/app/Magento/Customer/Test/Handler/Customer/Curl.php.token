[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Customer",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Test",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Handler",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Customer",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Customer",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Test",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Fixture",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Customer",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Mtf",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Fixture",10],["T_NS_SEPARATOR","\\",10],["T_STRING","FixtureInterface",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Mtf",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Handler",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Curl",11],["T_WHITESPACE"," ",11],["T_AS","as",11],["T_WHITESPACE"," ",11],["T_STRING","AbstractCurl",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Mtf",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Util",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Protocol",12],["T_NS_SEPARATOR","\\",12],["T_STRING","CurlInterface",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Mtf",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Util",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Protocol",13],["T_NS_SEPARATOR","\\",13],["T_STRING","CurlTransport",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Mtf",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Util",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Protocol",14],["T_NS_SEPARATOR","\\",14],["T_STRING","CurlTransport",14],["T_NS_SEPARATOR","\\",14],["T_STRING","BackendDecorator",14],";",["T_WHITESPACE","\n\n",14],["T_DOC_COMMENT","\/**\n * Class Curl\n * Curl handler for creating customer through registration page.\n *\/",16],["T_WHITESPACE","\n",19],["T_CLASS","class",20],["T_WHITESPACE"," ",20],["T_STRING","Curl",20],["T_WHITESPACE"," ",20],["T_EXTENDS","extends",20],["T_WHITESPACE"," ",20],["T_STRING","AbstractCurl",20],["T_WHITESPACE"," ",20],["T_IMPLEMENTS","implements",20],["T_WHITESPACE"," ",20],["T_STRING","CustomerInterface",20],["T_WHITESPACE","\n",20],"{",["T_WHITESPACE","\n    ",21],["T_DOC_COMMENT","\/**\n     * Default customer group\n     *\/",22],["T_WHITESPACE","\n    ",24],["T_CONST","const",25],["T_WHITESPACE"," ",25],["T_STRING","GENERAL_GROUP",25],["T_WHITESPACE"," ",25],"=",["T_WHITESPACE"," ",25],["T_CONSTANT_ENCAPSED_STRING","'1'",25],";",["T_WHITESPACE","\n\n    ",25],["T_DOC_COMMENT","\/**\n     * Mapping values for data\n     *\n     * @var array\n     *\/",27],["T_WHITESPACE","\n    ",31],["T_PROTECTED","protected",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$mappingData",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],"[",["T_WHITESPACE","\n        ",32],["T_CONSTANT_ENCAPSED_STRING","'country_id'",33],["T_WHITESPACE"," ",33],["T_DOUBLE_ARROW","=>",33],["T_WHITESPACE"," ",33],"[",["T_WHITESPACE","\n            ",33],["T_CONSTANT_ENCAPSED_STRING","'United States'",34],["T_WHITESPACE"," ",34],["T_DOUBLE_ARROW","=>",34],["T_WHITESPACE"," ",34],["T_CONSTANT_ENCAPSED_STRING","'US'",34],",",["T_WHITESPACE","\n            ",34],["T_CONSTANT_ENCAPSED_STRING","'United Kingdom'",35],["T_WHITESPACE"," ",35],["T_DOUBLE_ARROW","=>",35],["T_WHITESPACE"," ",35],["T_CONSTANT_ENCAPSED_STRING","'GB'",35],",",["T_WHITESPACE","\n            ",35],["T_CONSTANT_ENCAPSED_STRING","'Germany'",36],["T_WHITESPACE"," ",36],["T_DOUBLE_ARROW","=>",36],["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'DE'",36],["T_WHITESPACE","\n        ",36],"]",",",["T_WHITESPACE","\n        ",37],["T_CONSTANT_ENCAPSED_STRING","'gender'",38],["T_WHITESPACE"," ",38],["T_DOUBLE_ARROW","=>",38],["T_WHITESPACE"," ",38],"[",["T_WHITESPACE","\n            ",38],["T_CONSTANT_ENCAPSED_STRING","'Male'",39],["T_WHITESPACE"," ",39],["T_DOUBLE_ARROW","=>",39],["T_WHITESPACE"," ",39],["T_LNUMBER","1",39],",",["T_WHITESPACE","\n            ",39],["T_CONSTANT_ENCAPSED_STRING","'Female'",40],["T_WHITESPACE"," ",40],["T_DOUBLE_ARROW","=>",40],["T_WHITESPACE"," ",40],["T_LNUMBER","2",40],",",["T_WHITESPACE","\n            ",40],["T_CONSTANT_ENCAPSED_STRING","'Not Specified'",41],["T_WHITESPACE"," ",41],["T_DOUBLE_ARROW","=>",41],["T_WHITESPACE"," ",41],["T_LNUMBER","3",41],["T_WHITESPACE","\n        ",41],"]",",",["T_WHITESPACE","\n        ",42],["T_CONSTANT_ENCAPSED_STRING","'region_id'",43],["T_WHITESPACE"," ",43],["T_DOUBLE_ARROW","=>",43],["T_WHITESPACE"," ",43],"[",["T_WHITESPACE","\n            ",43],["T_CONSTANT_ENCAPSED_STRING","'California'",44],["T_WHITESPACE"," ",44],["T_DOUBLE_ARROW","=>",44],["T_WHITESPACE"," ",44],["T_LNUMBER","12",44],",",["T_WHITESPACE","\n            ",44],["T_CONSTANT_ENCAPSED_STRING","'New York'",45],["T_WHITESPACE"," ",45],["T_DOUBLE_ARROW","=>",45],["T_WHITESPACE"," ",45],["T_LNUMBER","43",45],",",["T_WHITESPACE","\n            ",45],["T_CONSTANT_ENCAPSED_STRING","'Texas'",46],["T_WHITESPACE"," ",46],["T_DOUBLE_ARROW","=>",46],["T_WHITESPACE"," ",46],["T_LNUMBER","57",46],",",["T_WHITESPACE","\n        ",46],"]",",",["T_WHITESPACE","\n    ",47],"]",";",["T_WHITESPACE","\n\n    ",48],["T_DOC_COMMENT","\/**\n     * Curl mapping data\n     *\n     * @var array\n     *\/",50],["T_WHITESPACE","\n    ",54],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$curlMapping",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],"[",["T_WHITESPACE","\n        ",55],["T_CONSTANT_ENCAPSED_STRING","'customer'",56],["T_WHITESPACE"," ",56],["T_DOUBLE_ARROW","=>",56],["T_WHITESPACE"," ",56],"[",["T_WHITESPACE","\n            ",56],["T_CONSTANT_ENCAPSED_STRING","'group_id'",57],",",["T_WHITESPACE","\n            ",57],["T_CONSTANT_ENCAPSED_STRING","'firstname'",58],",",["T_WHITESPACE","\n            ",58],["T_CONSTANT_ENCAPSED_STRING","'lastname'",59],",",["T_WHITESPACE","\n            ",59],["T_CONSTANT_ENCAPSED_STRING","'email'",60],",",["T_WHITESPACE","\n            ",60],["T_CONSTANT_ENCAPSED_STRING","'dob'",61],",",["T_WHITESPACE","\n            ",61],["T_CONSTANT_ENCAPSED_STRING","'taxvat'",62],",",["T_WHITESPACE","\n            ",62],["T_CONSTANT_ENCAPSED_STRING","'gender'",63],",",["T_WHITESPACE","\n            ",63],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",64],",",["T_WHITESPACE","\n        ",64],"]",["T_WHITESPACE","\n    ",65],"]",";",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * Fields that have to be send using update curl.\n     *\n     * @var array\n     *\/",68],["T_WHITESPACE","\n    ",72],["T_PROTECTED","protected",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$fieldsToUpdate",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],"[",["T_WHITESPACE","\n        ",73],["T_CONSTANT_ENCAPSED_STRING","'address'",74],",",["T_WHITESPACE","\n        ",74],["T_CONSTANT_ENCAPSED_STRING","'group_id'",75],",",["T_WHITESPACE","\n    ",75],"]",";",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * Post request for creating customer in frontend\n     *\n     * @param FixtureInterface|null $customer\n     * @return array\n     * @throws \\Exception\n     *\/",78],["T_WHITESPACE","\n    ",84],["T_PUBLIC","public",85],["T_WHITESPACE"," ",85],["T_FUNCTION","function",85],["T_WHITESPACE"," ",85],["T_STRING","persist",85],"(",["T_STRING","FixtureInterface",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$customer",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_STRING","null",85],")",["T_WHITESPACE","\n    ",85],"{",["T_WHITESPACE","\n        ",86],["T_DOC_COMMENT","\/** @var Customer $customer *\/",87],["T_WHITESPACE","\n        ",87],["T_VARIABLE","$data",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$customer",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","getData",88],"(",")",";",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$data",89],"[",["T_CONSTANT_ENCAPSED_STRING","'group_id'",89],"]",["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getCustomerGroup",89],"(",["T_VARIABLE","$customer",89],")",";",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$data",90],"[",["T_CONSTANT_ENCAPSED_STRING","'website_id'",90],"]",["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","getCustomerWebsite",90],"(",["T_VARIABLE","$customer",90],")",";",["T_WHITESPACE","\n        ",90],["T_VARIABLE","$address",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],"[","]",";",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$url",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$_ENV",92],"[",["T_CONSTANT_ENCAPSED_STRING","'app_frontend_url'",92],"]",["T_WHITESPACE"," ",92],".",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","'customer\/account\/createpost\/?nocookie=true'",92],";",["T_WHITESPACE","\n\n        ",92],["T_IF","if",94],["T_WHITESPACE"," ",94],"(",["T_VARIABLE","$customer",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","hasData",94],"(",["T_CONSTANT_ENCAPSED_STRING","'address'",94],")",")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n            ",94],["T_VARIABLE","$address",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$customer",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getAddress",95],"(",")",";",["T_WHITESPACE","\n            ",95],["T_UNSET","unset",96],"(",["T_VARIABLE","$data",96],"[",["T_CONSTANT_ENCAPSED_STRING","'address'",96],"]",")",";",["T_WHITESPACE","\n        ",96],"}",["T_WHITESPACE","\n\n        ",97],["T_VARIABLE","$curl",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_NEW","new",99],["T_WHITESPACE"," ",99],["T_STRING","CurlTransport",99],"(",")",";",["T_WHITESPACE","\n        ",99],["T_VARIABLE","$curl",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","write",100],"(",["T_VARIABLE","$url",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$data",100],")",";",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$response",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$curl",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","read",101],"(",")",";",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$curl",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","close",102],"(",")",";",["T_WHITESPACE","\n        ",102],["T_COMMENT","\/\/ After caching My Account page we cannot check by success message\n",103],["T_WHITESPACE","        ",104],["T_IF","if",104],["T_WHITESPACE"," ",104],"(","!",["T_STRING","strpos",104],"(",["T_VARIABLE","$response",104],",",["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'block-dashboard-info'",104],")",")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n            ",104],["T_THROW","throw",105],["T_WHITESPACE"," ",105],["T_NEW","new",105],["T_WHITESPACE"," ",105],["T_NS_SEPARATOR","\\",105],["T_STRING","Exception",105],"(","\"",["T_ENCAPSED_AND_WHITESPACE","Customer entity creating  by curl handler was not successful! Response: ",105],["T_VARIABLE","$response",105],"\"",")",";",["T_WHITESPACE","\n        ",105],"}",["T_WHITESPACE","\n\n        ",106],["T_VARIABLE","$data",108],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",108],"]",["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getCustomerId",108],"(",["T_VARIABLE","$customer",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getEmail",108],"(",")",")",";",["T_WHITESPACE","\n\n        ",108],["T_IF","if",110],["T_WHITESPACE"," ",110],"(","!",["T_EMPTY","empty",110],"(",["T_VARIABLE","$address",110],")",")",["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n            ",110],["T_VARIABLE","$data",111],"[",["T_CONSTANT_ENCAPSED_STRING","'address'",111],"]",["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_VARIABLE","$address",111],";",["T_WHITESPACE","\n        ",111],"}",["T_WHITESPACE","\n        ",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","updateCustomer",113],"(",["T_VARIABLE","$data",113],")",";",["T_WHITESPACE","\n\n        ",113],["T_RETURN","return",115],["T_WHITESPACE"," ",115],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",115],["T_WHITESPACE"," ",115],["T_DOUBLE_ARROW","=>",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$data",115],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",115],"]","]",";",["T_WHITESPACE","\n    ",115],"}",["T_WHITESPACE","\n\n    ",116],["T_DOC_COMMENT","\/**\n     * Get customer id by email\n     *\n     * @param string $email\n     * @return int|null\n     *\/",118],["T_WHITESPACE","\n    ",123],["T_PROTECTED","protected",124],["T_WHITESPACE"," ",124],["T_FUNCTION","function",124],["T_WHITESPACE"," ",124],["T_STRING","getCustomerId",124],"(",["T_VARIABLE","$email",124],")",["T_WHITESPACE","\n    ",124],"{",["T_WHITESPACE","\n        ",125],["T_VARIABLE","$url",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$_ENV",126],"[",["T_CONSTANT_ENCAPSED_STRING","'app_backend_url'",126],"]",["T_WHITESPACE"," ",126],".",["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'mui\/index\/render\/'",126],";",["T_WHITESPACE","\n        ",126],["T_VARIABLE","$data",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],"[",["T_WHITESPACE","\n            ",127],["T_CONSTANT_ENCAPSED_STRING","'namespace'",128],["T_WHITESPACE"," ",128],["T_DOUBLE_ARROW","=>",128],["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'customer_listing'",128],",",["T_WHITESPACE","\n            ",128],["T_CONSTANT_ENCAPSED_STRING","'filters'",129],["T_WHITESPACE"," ",129],["T_DOUBLE_ARROW","=>",129],["T_WHITESPACE"," ",129],"[",["T_WHITESPACE","\n                ",129],["T_CONSTANT_ENCAPSED_STRING","'placeholder'",130],["T_WHITESPACE"," ",130],["T_DOUBLE_ARROW","=>",130],["T_WHITESPACE"," ",130],["T_STRING","true",130],",",["T_WHITESPACE","\n                ",130],["T_CONSTANT_ENCAPSED_STRING","'email'",131],["T_WHITESPACE"," ",131],["T_DOUBLE_ARROW","=>",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$email",131],["T_WHITESPACE","\n            ",131],"]",",",["T_WHITESPACE","\n            ",132],["T_CONSTANT_ENCAPSED_STRING","'isAjax'",133],["T_WHITESPACE"," ",133],["T_DOUBLE_ARROW","=>",133],["T_WHITESPACE"," ",133],["T_STRING","true",133],["T_WHITESPACE","\n        ",133],"]",";",["T_WHITESPACE","\n        ",134],["T_VARIABLE","$curl",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_NEW","new",135],["T_WHITESPACE"," ",135],["T_STRING","BackendDecorator",135],"(",["T_NEW","new",135],["T_WHITESPACE"," ",135],["T_STRING","CurlTransport",135],"(",")",",",["T_WHITESPACE"," ",135],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","_configuration",135],")",";",["T_WHITESPACE","\n\n        ",135],["T_VARIABLE","$curl",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","write",137],"(",["T_VARIABLE","$url",137],",",["T_WHITESPACE"," ",137],["T_VARIABLE","$data",137],",",["T_WHITESPACE"," ",137],["T_STRING","CurlInterface",137],["T_DOUBLE_COLON","::",137],["T_STRING","POST",137],")",";",["T_WHITESPACE","\n        ",137],["T_VARIABLE","$response",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_VARIABLE","$curl",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","read",138],"(",")",";",["T_WHITESPACE","\n        ",138],["T_VARIABLE","$curl",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","close",139],"(",")",";",["T_WHITESPACE","\n\n        ",139],["T_STRING","preg_match",141],"(",["T_CONSTANT_ENCAPSED_STRING","'\/customer_listing_data_source.+items.+\"entity_id\":\"(\\d+)\"\/'",141],",",["T_WHITESPACE"," ",141],["T_VARIABLE","$response",141],",",["T_WHITESPACE"," ",141],["T_VARIABLE","$match",141],")",";",["T_WHITESPACE","\n        ",141],["T_RETURN","return",142],["T_WHITESPACE"," ",142],["T_EMPTY","empty",142],"(",["T_VARIABLE","$match",142],"[",["T_LNUMBER","1",142],"]",")",["T_WHITESPACE"," ",142],"?",["T_WHITESPACE"," ",142],["T_STRING","null",142],["T_WHITESPACE"," ",142],":",["T_WHITESPACE"," ",142],["T_VARIABLE","$match",142],"[",["T_LNUMBER","1",142],"]",";",["T_WHITESPACE","\n    ",142],"}",["T_WHITESPACE","\n\n    ",143],["T_DOC_COMMENT","\/**\n     * Prepare customer for curl\n     *\n     * @param FixtureInterface $customer\n     * @return string\n     *\/",145],["T_WHITESPACE","\n    ",150],["T_PROTECTED","protected",151],["T_WHITESPACE"," ",151],["T_FUNCTION","function",151],["T_WHITESPACE"," ",151],["T_STRING","getCustomerGroup",151],"(",["T_STRING","FixtureInterface",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$customer",151],")",["T_WHITESPACE","\n    ",151],"{",["T_WHITESPACE","\n        ",152],["T_RETURN","return",153],["T_WHITESPACE"," ",153],["T_VARIABLE","$customer",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","hasData",153],"(",["T_CONSTANT_ENCAPSED_STRING","'group_id'",153],")",["T_WHITESPACE","\n            ",153],"?",["T_WHITESPACE"," ",154],["T_VARIABLE","$customer",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","getDataFieldConfig",154],"(",["T_CONSTANT_ENCAPSED_STRING","'group_id'",154],")","[",["T_CONSTANT_ENCAPSED_STRING","'source'",154],"]",["T_OBJECT_OPERATOR","->",154],["T_STRING","getCustomerGroup",154],"(",")",["T_OBJECT_OPERATOR","->",154],["T_STRING","getCustomerGroupId",154],"(",")",["T_WHITESPACE","\n            ",154],":",["T_WHITESPACE"," ",155],["T_STRING","self",155],["T_DOUBLE_COLON","::",155],["T_STRING","GENERAL_GROUP",155],";",["T_WHITESPACE","\n    ",155],"}",["T_WHITESPACE","\n\n    ",156],["T_DOC_COMMENT","\/**\n     * Update customer fields that can not be added at creation step.\n     * - address\n     * - group_id\n     *\n     * @param array $data\n     * @return void\n     * @throws \\Exception\n     *\/",158],["T_WHITESPACE","\n    ",166],["T_PROTECTED","protected",167],["T_WHITESPACE"," ",167],["T_FUNCTION","function",167],["T_WHITESPACE"," ",167],["T_STRING","updateCustomer",167],"(",["T_ARRAY","array",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$data",167],")",["T_WHITESPACE","\n    ",167],"{",["T_WHITESPACE","\n        ",168],["T_VARIABLE","$result",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_STRING","array_intersect",169],"(",["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","fieldsToUpdate",169],",",["T_WHITESPACE"," ",169],["T_STRING","array_keys",169],"(",["T_VARIABLE","$data",169],")",")",";",["T_WHITESPACE","\n        ",169],["T_IF","if",170],["T_WHITESPACE"," ",170],"(",["T_EMPTY","empty",170],"(",["T_VARIABLE","$result",170],")",")",["T_WHITESPACE"," ",170],"{",["T_WHITESPACE","\n            ",170],["T_RETURN","return",171],";",["T_WHITESPACE","\n        ",171],"}",["T_WHITESPACE","\n        ",172],["T_VARIABLE","$curlData",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],"[","]",";",["T_WHITESPACE","\n        ",173],["T_FOREACH","foreach",174],["T_WHITESPACE"," ",174],"(",["T_VARIABLE","$data",174],["T_WHITESPACE"," ",174],["T_AS","as",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$key",174],["T_WHITESPACE"," ",174],["T_DOUBLE_ARROW","=>",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$value",174],")",["T_WHITESPACE"," ",174],"{",["T_WHITESPACE","\n            ",174],["T_FOREACH","foreach",175],["T_WHITESPACE"," ",175],"(",["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","curlMapping",175],["T_WHITESPACE"," ",175],["T_AS","as",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$prefix",175],["T_WHITESPACE"," ",175],["T_DOUBLE_ARROW","=>",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$prefixValues",175],")",["T_WHITESPACE"," ",175],"{",["T_WHITESPACE","\n                ",175],["T_IF","if",176],["T_WHITESPACE"," ",176],"(",["T_STRING","in_array",176],"(",["T_VARIABLE","$key",176],",",["T_WHITESPACE"," ",176],["T_VARIABLE","$prefixValues",176],")",")",["T_WHITESPACE"," ",176],"{",["T_WHITESPACE","\n                    ",176],["T_VARIABLE","$curlData",177],"[",["T_VARIABLE","$prefix",177],"]","[",["T_VARIABLE","$key",177],"]",["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_VARIABLE","$value",177],";",["T_WHITESPACE","\n                    ",177],["T_UNSET","unset",178],"(",["T_VARIABLE","$data",178],"[",["T_VARIABLE","$key",178],"]",")",";",["T_WHITESPACE","\n                ",178],"}",["T_WHITESPACE","\n            ",179],"}",["T_WHITESPACE","\n        ",180],"}",["T_WHITESPACE","\n        ",181],["T_UNSET","unset",182],"(",["T_VARIABLE","$data",182],"[",["T_CONSTANT_ENCAPSED_STRING","'password'",182],"]",",",["T_WHITESPACE"," ",182],["T_VARIABLE","$data",182],"[",["T_CONSTANT_ENCAPSED_STRING","'password_confirmation'",182],"]",")",";",["T_WHITESPACE","\n\n        ",182],["T_VARIABLE","$curlData",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","replaceMappingData",184],"(",["T_STRING","array_replace_recursive",184],"(",["T_VARIABLE","$curlData",184],",",["T_WHITESPACE"," ",184],["T_VARIABLE","$data",184],")",")",";",["T_WHITESPACE","\n        ",184],["T_IF","if",185],["T_WHITESPACE"," ",185],"(","!",["T_EMPTY","empty",185],"(",["T_VARIABLE","$data",185],"[",["T_CONSTANT_ENCAPSED_STRING","'address'",185],"]",")",")",["T_WHITESPACE"," ",185],"{",["T_WHITESPACE","\n            ",185],["T_VARIABLE","$curlData",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","prepareAddressData",186],"(",["T_VARIABLE","$curlData",186],")",";",["T_WHITESPACE","\n        ",186],"}",["T_WHITESPACE","\n\n        ",187],["T_VARIABLE","$url",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_VARIABLE","$_ENV",189],"[",["T_CONSTANT_ENCAPSED_STRING","'app_backend_url'",189],"]",["T_WHITESPACE"," ",189],".",["T_WHITESPACE"," ",189],["T_CONSTANT_ENCAPSED_STRING","'customer\/index\/save\/id\/'",189],["T_WHITESPACE"," ",189],".",["T_WHITESPACE"," ",189],["T_VARIABLE","$curlData",189],"[",["T_CONSTANT_ENCAPSED_STRING","'customer'",189],"]","[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",189],"]",";",["T_WHITESPACE","\n        ",189],["T_VARIABLE","$curl",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_NEW","new",190],["T_WHITESPACE"," ",190],["T_STRING","BackendDecorator",190],"(",["T_NEW","new",190],["T_WHITESPACE"," ",190],["T_STRING","CurlTransport",190],"(",")",",",["T_WHITESPACE"," ",190],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","_configuration",190],")",";",["T_WHITESPACE","\n        ",190],["T_VARIABLE","$curl",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","write",191],"(",["T_VARIABLE","$url",191],",",["T_WHITESPACE"," ",191],["T_VARIABLE","$curlData",191],")",";",["T_WHITESPACE","\n        ",191],["T_VARIABLE","$response",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_VARIABLE","$curl",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","read",192],"(",")",";",["T_WHITESPACE","\n        ",192],["T_VARIABLE","$curl",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","close",193],"(",")",";",["T_WHITESPACE","\n\n        ",193],["T_IF","if",195],["T_WHITESPACE"," ",195],"(","!",["T_STRING","strpos",195],"(",["T_VARIABLE","$response",195],",",["T_WHITESPACE"," ",195],["T_CONSTANT_ENCAPSED_STRING","'data-ui-id=\"messages-message-success\"'",195],")",")",["T_WHITESPACE"," ",195],"{",["T_WHITESPACE","\n            ",195],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","_eventManager",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","dispatchEvent",196],"(","[",["T_CONSTANT_ENCAPSED_STRING","'curl_failed'",196],"]",",",["T_WHITESPACE"," ",196],"[",["T_VARIABLE","$response",196],"]",")",";",["T_WHITESPACE","\n            ",196],["T_THROW","throw",197],["T_WHITESPACE"," ",197],["T_NEW","new",197],["T_WHITESPACE"," ",197],["T_NS_SEPARATOR","\\",197],["T_STRING","Exception",197],"(",["T_CONSTANT_ENCAPSED_STRING","'Failed to update customer!'",197],")",";",["T_WHITESPACE","\n        ",197],"}",["T_WHITESPACE","\n    ",198],"}",["T_WHITESPACE","\n\n    ",199],["T_DOC_COMMENT","\/**\n     * Preparing address data for curl\n     *\n     * @param array $curlData\n     * @return array\n     *\/",201],["T_WHITESPACE","\n    ",206],["T_PROTECTED","protected",207],["T_WHITESPACE"," ",207],["T_FUNCTION","function",207],["T_WHITESPACE"," ",207],["T_STRING","prepareAddressData",207],"(",["T_ARRAY","array",207],["T_WHITESPACE"," ",207],["T_VARIABLE","$curlData",207],")",["T_WHITESPACE","\n    ",207],"{",["T_WHITESPACE","\n        ",208],["T_VARIABLE","$address",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],"[","]",";",["T_WHITESPACE","\n        ",209],["T_FOREACH","foreach",210],["T_WHITESPACE"," ",210],"(",["T_STRING","array_keys",210],"(",["T_VARIABLE","$curlData",210],"[",["T_CONSTANT_ENCAPSED_STRING","'address'",210],"]",")",["T_WHITESPACE"," ",210],["T_AS","as",210],["T_WHITESPACE"," ",210],["T_VARIABLE","$key",210],")",["T_WHITESPACE"," ",210],"{",["T_WHITESPACE","\n            ",210],["T_VARIABLE","$addressKey",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_CONSTANT_ENCAPSED_STRING","'new_'",211],["T_WHITESPACE"," ",211],".",["T_WHITESPACE"," ",211],["T_VARIABLE","$key",211],";",["T_WHITESPACE","\n            ",211],["T_VARIABLE","$address",212],"[",["T_VARIABLE","$addressKey",212],"]",["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_VARIABLE","$curlData",212],"[",["T_CONSTANT_ENCAPSED_STRING","'address'",212],"]","[",["T_VARIABLE","$key",212],"]",";",["T_WHITESPACE","\n            ",212],["T_VARIABLE","$address",213],"[",["T_VARIABLE","$addressKey",213],"]","[",["T_CONSTANT_ENCAPSED_STRING","'_deleted'",213],"]",["T_WHITESPACE"," ",213],"=",["T_WHITESPACE"," ",213],["T_CONSTANT_ENCAPSED_STRING","''",213],";",["T_WHITESPACE","\n            ",213],["T_VARIABLE","$address",214],"[",["T_VARIABLE","$addressKey",214],"]","[",["T_CONSTANT_ENCAPSED_STRING","'region'",214],"]",["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_CONSTANT_ENCAPSED_STRING","''",214],";",["T_WHITESPACE","\n            ",214],["T_IF","if",215],["T_WHITESPACE"," ",215],"(","!",["T_STRING","is_array",215],"(",["T_VARIABLE","$address",215],"[",["T_VARIABLE","$addressKey",215],"]","[",["T_CONSTANT_ENCAPSED_STRING","'street'",215],"]",")",")",["T_WHITESPACE"," ",215],"{",["T_WHITESPACE","\n                ",215],["T_VARIABLE","$street",216],["T_WHITESPACE"," ",216],"=",["T_WHITESPACE"," ",216],["T_VARIABLE","$address",216],"[",["T_VARIABLE","$addressKey",216],"]","[",["T_CONSTANT_ENCAPSED_STRING","'street'",216],"]",";",["T_WHITESPACE","\n                ",216],["T_VARIABLE","$address",217],"[",["T_VARIABLE","$addressKey",217],"]","[",["T_CONSTANT_ENCAPSED_STRING","'street'",217],"]",["T_WHITESPACE"," ",217],"=",["T_WHITESPACE"," ",217],"[","]",";",["T_WHITESPACE","\n                ",217],["T_VARIABLE","$address",218],"[",["T_VARIABLE","$addressKey",218],"]","[",["T_CONSTANT_ENCAPSED_STRING","'street'",218],"]","[","]",["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_VARIABLE","$street",218],";",["T_WHITESPACE","\n            ",218],"}",["T_WHITESPACE","\n            ",219],["T_IF","if",220],["T_WHITESPACE"," ",220],"(",["T_ISSET","isset",220],"(",["T_VARIABLE","$address",220],"[",["T_VARIABLE","$addressKey",220],"]","[",["T_CONSTANT_ENCAPSED_STRING","'default_billing'",220],"]",")",")",["T_WHITESPACE"," ",220],"{",["T_WHITESPACE","\n                ",220],["T_VARIABLE","$value",221],["T_WHITESPACE"," ",221],"=",["T_WHITESPACE"," ",221],["T_VARIABLE","$address",221],"[",["T_VARIABLE","$addressKey",221],"]","[",["T_CONSTANT_ENCAPSED_STRING","'default_billing'",221],"]",["T_WHITESPACE"," ",221],["T_IS_IDENTICAL","===",221],["T_WHITESPACE"," ",221],["T_CONSTANT_ENCAPSED_STRING","'Yes'",221],["T_WHITESPACE"," ",221],"?",["T_WHITESPACE"," ",221],["T_CONSTANT_ENCAPSED_STRING","'true'",221],["T_WHITESPACE"," ",221],":",["T_WHITESPACE"," ",221],["T_CONSTANT_ENCAPSED_STRING","'false'",221],";",["T_WHITESPACE","\n                ",221],["T_VARIABLE","$address",222],"[",["T_VARIABLE","$addressKey",222],"]","[",["T_CONSTANT_ENCAPSED_STRING","'default_billing'",222],"]",["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_VARIABLE","$value",222],";",["T_WHITESPACE","\n            ",222],"}",["T_WHITESPACE","\n            ",223],["T_IF","if",224],["T_WHITESPACE"," ",224],"(",["T_ISSET","isset",224],"(",["T_VARIABLE","$address",224],"[",["T_VARIABLE","$addressKey",224],"]","[",["T_CONSTANT_ENCAPSED_STRING","'default_shipping'",224],"]",")",")",["T_WHITESPACE"," ",224],"{",["T_WHITESPACE","\n                ",224],["T_VARIABLE","$value",225],["T_WHITESPACE"," ",225],"=",["T_WHITESPACE"," ",225],["T_VARIABLE","$address",225],"[",["T_VARIABLE","$addressKey",225],"]","[",["T_CONSTANT_ENCAPSED_STRING","'default_shipping'",225],"]",["T_WHITESPACE"," ",225],["T_IS_IDENTICAL","===",225],["T_WHITESPACE"," ",225],["T_CONSTANT_ENCAPSED_STRING","'Yes'",225],["T_WHITESPACE"," ",225],"?",["T_WHITESPACE"," ",225],["T_CONSTANT_ENCAPSED_STRING","'true'",225],["T_WHITESPACE"," ",225],":",["T_WHITESPACE"," ",225],["T_CONSTANT_ENCAPSED_STRING","'false'",225],";",["T_WHITESPACE","\n                ",225],["T_VARIABLE","$address",226],"[",["T_VARIABLE","$addressKey",226],"]","[",["T_CONSTANT_ENCAPSED_STRING","'default_shipping'",226],"]",["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_VARIABLE","$value",226],";",["T_WHITESPACE","\n            ",226],"}",["T_WHITESPACE","\n        ",227],"}",["T_WHITESPACE","\n        ",228],["T_VARIABLE","$curlData",229],"[",["T_CONSTANT_ENCAPSED_STRING","'address'",229],"]",["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],["T_VARIABLE","$address",229],";",["T_WHITESPACE","\n\n        ",229],["T_RETURN","return",231],["T_WHITESPACE"," ",231],["T_VARIABLE","$curlData",231],";",["T_WHITESPACE","\n    ",231],"}",["T_WHITESPACE","\n\n    ",232],["T_DOC_COMMENT","\/**\n     * Prepare customer website data.\n     *\n     * @param Customer $customer\n     * @return int\n     *\/",234],["T_WHITESPACE","\n    ",239],["T_PRIVATE","private",240],["T_WHITESPACE"," ",240],["T_FUNCTION","function",240],["T_WHITESPACE"," ",240],["T_STRING","getCustomerWebsite",240],"(",["T_STRING","Customer",240],["T_WHITESPACE"," ",240],["T_VARIABLE","$customer",240],")",["T_WHITESPACE","\n    ",240],"{",["T_WHITESPACE","\n        ",241],["T_RETURN","return",242],["T_WHITESPACE"," ",242],["T_VARIABLE","$customer",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","getDataFieldConfig",242],"(",["T_CONSTANT_ENCAPSED_STRING","'website_id'",242],")","[",["T_CONSTANT_ENCAPSED_STRING","'source'",242],"]",["T_OBJECT_OPERATOR","->",242],["T_STRING","getWebsite",242],"(",")",["T_OBJECT_OPERATOR","->",242],["T_STRING","getWebsiteId",242],"(",")",";",["T_WHITESPACE","\n    ",242],"}",["T_WHITESPACE","\n",243],"}",["T_WHITESPACE","\n",244]]