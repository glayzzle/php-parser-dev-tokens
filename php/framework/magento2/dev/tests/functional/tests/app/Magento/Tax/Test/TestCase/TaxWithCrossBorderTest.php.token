[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Tax",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Test",7],["T_NS_SEPARATOR","\\",7],["T_STRING","TestCase",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Catalog",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Test",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Fixture",9],["T_NS_SEPARATOR","\\",9],["T_STRING","CatalogProductSimple",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","CatalogRule",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Test",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Fixture",10],["T_NS_SEPARATOR","\\",10],["T_STRING","CatalogRule",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Customer",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Test",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Fixture",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Customer",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","SalesRule",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Test",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Fixture",12],["T_NS_SEPARATOR","\\",12],["T_STRING","SalesRule",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Mtf",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Fixture",13],["T_NS_SEPARATOR","\\",13],["T_STRING","FixtureFactory",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Mtf",14],["T_NS_SEPARATOR","\\",14],["T_STRING","TestCase",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Injectable",14],";",["T_WHITESPACE","\n\n",14],["T_DOC_COMMENT","\/**\n * Steps:\n * 1. Log in as default admin user.\n * 2. Go to Stores > Taxes > Tax Rules.\n * 3. Click 'Add New Tax Rule' button.\n * 4. Assign 3 different rates for different addresses\n * 5. Save Tax Rate.\n * 6. Go to Products > Catalog.\n * 7. Add new product.\n * 8. Fill data according to dataset.\n * 9. Save product.\n * 10. Go to Stores > Configuration.\n * 11. Fill Tax configuration according to data set.\n * 12. Save tax configuration.\n * 13. Register two customers on front end that will match two different rates\n * 14. Login with each customer and verify prices\n *\n * @group Tax\n * @ZephyrId MAGETWO-29052\n *\/",16],["T_WHITESPACE","\n",35],["T_CLASS","class",36],["T_WHITESPACE"," ",36],["T_STRING","TaxWithCrossBorderTest",36],["T_WHITESPACE"," ",36],["T_EXTENDS","extends",36],["T_WHITESPACE"," ",36],["T_STRING","Injectable",36],["T_WHITESPACE","\n",36],"{",["T_WHITESPACE","\n    ",37],["T_COMMENT","\/* tags *\/",38],["T_WHITESPACE","\n    ",38],["T_CONST","const",39],["T_WHITESPACE"," ",39],["T_STRING","MVP",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'yes'",39],";",["T_WHITESPACE","\n    ",39],["T_CONST","const",40],["T_WHITESPACE"," ",40],["T_STRING","STABLE",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'no'",40],";",["T_WHITESPACE","\n    ",40],["T_COMMENT","\/* end tags *\/",41],["T_WHITESPACE","\n\n    ",41],["T_DOC_COMMENT","\/**\n     * Fixture SalesRule.\n     *\n     * @var SalesRule\n     *\/",43],["T_WHITESPACE","\n    ",47],["T_PROTECTED","protected",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$salesRule",48],";",["T_WHITESPACE","\n\n    ",48],["T_DOC_COMMENT","\/**\n     * Fixture CatalogRule.\n     *\n     * @var CatalogRule\n     *\/",50],["T_WHITESPACE","\n    ",54],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$catalogRule",55],";",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * Fixture factory.\n     *\n     * @var FixtureFactory\n     *\/",57],["T_WHITESPACE","\n    ",61],["T_PROTECTED","protected",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$fixtureFactory",62],";",["T_WHITESPACE","\n\n    ",62],["T_DOC_COMMENT","\/**\n     * Prepare data.\n     *\n     * @param FixtureFactory $fixtureFactory\n     * @return array\n     *\/",64],["T_WHITESPACE","\n    ",69],["T_PUBLIC","public",70],["T_WHITESPACE"," ",70],["T_FUNCTION","function",70],["T_WHITESPACE"," ",70],["T_STRING","__prepare",70],"(",["T_STRING","FixtureFactory",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$fixtureFactory",70],")",["T_WHITESPACE","\n    ",70],"{",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","fixtureFactory",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_VARIABLE","$fixtureFactory",72],";",["T_WHITESPACE","\n\n        ",72],["T_RETURN","return",74],["T_WHITESPACE"," ",74],"[",["T_CONSTANT_ENCAPSED_STRING","'customers'",74],["T_WHITESPACE"," ",74],["T_DOUBLE_ARROW","=>",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","createCustomers",74],"(",")","]",";",["T_WHITESPACE","\n    ",74],"}",["T_WHITESPACE","\n\n    ",75],["T_DOC_COMMENT","\/**\n     * Injection data.\n     *\n     * @return void\n     *\/",77],["T_WHITESPACE","\n    ",81],["T_PUBLIC","public",82],["T_WHITESPACE"," ",82],["T_FUNCTION","function",82],["T_WHITESPACE"," ",82],["T_STRING","__inject",82],"(",")",["T_WHITESPACE","\n    ",82],"{",["T_WHITESPACE","\n        ",83],["T_COMMENT","\/\/ TODO: Move test set up to \"__prepare\" method after fix bug MAGETWO-29331\n",84],["T_WHITESPACE","        ",85],["T_VARIABLE","$taxRule",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","fixtureFactory",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","createByCode",85],"(",["T_CONSTANT_ENCAPSED_STRING","'taxRule'",85],",",["T_WHITESPACE"," ",85],"[",["T_CONSTANT_ENCAPSED_STRING","'dataset'",85],["T_WHITESPACE"," ",85],["T_DOUBLE_ARROW","=>",85],["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","'cross_border_tax_rule'",85],"]",")",";",["T_WHITESPACE","\n        ",85],["T_VARIABLE","$taxRule",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","persist",86],"(",")",";",["T_WHITESPACE","\n    ",86],"}",["T_WHITESPACE","\n\n    ",87],["T_DOC_COMMENT","\/**\n     * Create customers.\n     *\n     * @return array $customers\n     *\/",89],["T_WHITESPACE","\n    ",93],["T_PROTECTED","protected",94],["T_WHITESPACE"," ",94],["T_FUNCTION","function",94],["T_WHITESPACE"," ",94],["T_STRING","createCustomers",94],"(",")",["T_WHITESPACE","\n    ",94],"{",["T_WHITESPACE","\n        ",95],["T_VARIABLE","$customersData",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],"[",["T_CONSTANT_ENCAPSED_STRING","'johndoe_unique_TX'",96],",",["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","'johndoe_unique'",96],"]",";",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$customers",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],"[","]",";",["T_WHITESPACE","\n        ",97],["T_FOREACH","foreach",98],["T_WHITESPACE"," ",98],"(",["T_VARIABLE","$customersData",98],["T_WHITESPACE"," ",98],["T_AS","as",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$customerData",98],")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n            ",98],["T_VARIABLE","$customer",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","fixtureFactory",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","createByCode",99],"(",["T_CONSTANT_ENCAPSED_STRING","'customer'",99],",",["T_WHITESPACE"," ",99],"[",["T_CONSTANT_ENCAPSED_STRING","'dataset'",99],["T_WHITESPACE"," ",99],["T_DOUBLE_ARROW","=>",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$customerData",99],"]",")",";",["T_WHITESPACE","\n            ",99],["T_VARIABLE","$customer",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","persist",100],"(",")",";",["T_WHITESPACE","\n            ",100],["T_VARIABLE","$customers",101],"[","]",["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$customer",101],";",["T_WHITESPACE","\n        ",101],"}",["T_WHITESPACE","\n        ",102],["T_RETURN","return",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$customers",103],";",["T_WHITESPACE","\n    ",103],"}",["T_WHITESPACE","\n\n    ",104],["T_DOC_COMMENT","\/**\n     * Test product prices with tax.\n     *\n     * @param CatalogProductSimple $product\n     * @param string $configData\n     * @param SalesRule $salesRule [optional]\n     * @param CatalogRule $catalogRule [optional]\n     * @return void\n     *\/",106],["T_WHITESPACE","\n    ",114],["T_PUBLIC","public",115],["T_WHITESPACE"," ",115],["T_FUNCTION","function",115],["T_WHITESPACE"," ",115],["T_STRING","test",115],"(",["T_WHITESPACE","\n        ",115],["T_STRING","CatalogProductSimple",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$product",116],",",["T_WHITESPACE","\n        ",116],["T_VARIABLE","$configData",117],",",["T_WHITESPACE","\n        ",117],["T_STRING","SalesRule",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$salesRule",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_STRING","null",118],",",["T_WHITESPACE","\n        ",118],["T_STRING","CatalogRule",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$catalogRule",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_STRING","null",119],["T_WHITESPACE","\n    ",119],")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n        ",120],["T_COMMENT","\/\/Preconditions\n",121],["T_WHITESPACE","        ",122],["T_IF","if",122],["T_WHITESPACE"," ",122],"(",["T_VARIABLE","$salesRule",122],["T_WHITESPACE"," ",122],["T_IS_NOT_IDENTICAL","!==",122],["T_WHITESPACE"," ",122],["T_STRING","null",122],")",["T_WHITESPACE"," ",122],"{",["T_WHITESPACE","\n            ",122],["T_VARIABLE","$salesRule",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","persist",123],"(",")",";",["T_WHITESPACE","\n            ",123],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","salesRule",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$salesRule",124],";",["T_WHITESPACE","\n        ",124],"}",["T_WHITESPACE","\n        ",125],["T_IF","if",126],["T_WHITESPACE"," ",126],"(",["T_VARIABLE","$catalogRule",126],["T_WHITESPACE"," ",126],["T_IS_NOT_IDENTICAL","!==",126],["T_WHITESPACE"," ",126],["T_STRING","null",126],")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n            ",126],["T_VARIABLE","$catalogRule",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","persist",127],"(",")",";",["T_WHITESPACE","\n            ",127],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","catalogRule",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_VARIABLE","$catalogRule",128],";",["T_WHITESPACE","\n        ",128],"}",["T_WHITESPACE","\n        ",129],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","objectManager",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","create",130],"(",["T_WHITESPACE","\n            ",130],["T_NS_SEPARATOR","\\",131],["T_STRING","Magento",131],["T_NS_SEPARATOR","\\",131],["T_STRING","Config",131],["T_NS_SEPARATOR","\\",131],["T_STRING","Test",131],["T_NS_SEPARATOR","\\",131],["T_STRING","TestStep",131],["T_NS_SEPARATOR","\\",131],["T_STRING","SetupConfigurationStep",131],["T_DOUBLE_COLON","::",131],["T_CLASS","class",131],",",["T_WHITESPACE","\n            ",131],"[",["T_CONSTANT_ENCAPSED_STRING","'configData'",132],["T_WHITESPACE"," ",132],["T_DOUBLE_ARROW","=>",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$configData",132],"]",["T_WHITESPACE","\n        ",132],")",["T_OBJECT_OPERATOR","->",133],["T_STRING","run",133],"(",")",";",["T_WHITESPACE","\n        ",133],["T_VARIABLE","$product",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","persist",134],"(",")",";",["T_WHITESPACE","\n    ",134],"}",["T_WHITESPACE","\n\n    ",135],["T_DOC_COMMENT","\/**\n     * Tear down after test.\n     *\n     * @return void\n     *\/",137],["T_WHITESPACE","\n    ",141],["T_PUBLIC","public",142],["T_WHITESPACE"," ",142],["T_FUNCTION","function",142],["T_WHITESPACE"," ",142],["T_STRING","tearDown",142],"(",")",["T_WHITESPACE","\n    ",142],"{",["T_WHITESPACE","\n        ",143],["T_IF","if",144],["T_WHITESPACE"," ",144],"(",["T_ISSET","isset",144],"(",["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","salesRule",144],")",")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n            ",144],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","objectManager",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","create",145],"(",["T_NS_SEPARATOR","\\",145],["T_STRING","Magento",145],["T_NS_SEPARATOR","\\",145],["T_STRING","SalesRule",145],["T_NS_SEPARATOR","\\",145],["T_STRING","Test",145],["T_NS_SEPARATOR","\\",145],["T_STRING","TestStep",145],["T_NS_SEPARATOR","\\",145],["T_STRING","DeleteAllSalesRuleStep",145],["T_DOUBLE_COLON","::",145],["T_CLASS","class",145],")",["T_OBJECT_OPERATOR","->",145],["T_STRING","run",145],"(",")",";",["T_WHITESPACE","\n            ",145],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","salesRule",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_STRING","null",146],";",["T_WHITESPACE","\n        ",146],"}",["T_WHITESPACE","\n        ",147],["T_IF","if",148],["T_WHITESPACE"," ",148],"(",["T_ISSET","isset",148],"(",["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","catalogRule",148],")",")",["T_WHITESPACE"," ",148],"{",["T_WHITESPACE","\n            ",148],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","objectManager",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","create",149],"(",["T_NS_SEPARATOR","\\",149],["T_STRING","Magento",149],["T_NS_SEPARATOR","\\",149],["T_STRING","CatalogRule",149],["T_NS_SEPARATOR","\\",149],["T_STRING","Test",149],["T_NS_SEPARATOR","\\",149],["T_STRING","TestStep",149],["T_NS_SEPARATOR","\\",149],["T_STRING","DeleteAllCatalogRulesStep",149],["T_DOUBLE_COLON","::",149],["T_CLASS","class",149],")",["T_OBJECT_OPERATOR","->",149],["T_STRING","run",149],"(",")",";",["T_WHITESPACE","\n            ",149],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","catalogRule",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_STRING","null",150],";",["T_WHITESPACE","\n        ",150],"}",["T_WHITESPACE","\n\n        ",151],["T_COMMENT","\/\/ TODO: Move set default configuration to \"tearDownAfterClass\" method after fix bug MAGETWO-29331\n",153],["T_WHITESPACE","        ",154],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","objectManager",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","create",154],"(",["T_NS_SEPARATOR","\\",154],["T_STRING","Magento",154],["T_NS_SEPARATOR","\\",154],["T_STRING","Tax",154],["T_NS_SEPARATOR","\\",154],["T_STRING","Test",154],["T_NS_SEPARATOR","\\",154],["T_STRING","TestStep",154],["T_NS_SEPARATOR","\\",154],["T_STRING","DeleteAllTaxRulesStep",154],["T_DOUBLE_COLON","::",154],["T_CLASS","class",154],")",["T_OBJECT_OPERATOR","->",154],["T_STRING","run",154],"(",")",";",["T_WHITESPACE","\n        ",154],["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","objectManager",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","create",155],"(",["T_WHITESPACE","\n            ",155],["T_NS_SEPARATOR","\\",156],["T_STRING","Magento",156],["T_NS_SEPARATOR","\\",156],["T_STRING","Config",156],["T_NS_SEPARATOR","\\",156],["T_STRING","Test",156],["T_NS_SEPARATOR","\\",156],["T_STRING","TestStep",156],["T_NS_SEPARATOR","\\",156],["T_STRING","SetupConfigurationStep",156],["T_DOUBLE_COLON","::",156],["T_CLASS","class",156],",",["T_WHITESPACE","\n            ",156],"[",["T_CONSTANT_ENCAPSED_STRING","'configData'",157],["T_WHITESPACE"," ",157],["T_DOUBLE_ARROW","=>",157],["T_WHITESPACE"," ",157],["T_CONSTANT_ENCAPSED_STRING","'default_tax_configuration'",157],"]",["T_WHITESPACE","\n        ",157],")",["T_OBJECT_OPERATOR","->",158],["T_STRING","run",158],"(",")",";",["T_WHITESPACE","\n    ",158],"}",["T_WHITESPACE","\n",159],"}",["T_WHITESPACE","\n",160]]