[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Test",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Integrity",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Modular",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Email",6],";",["T_WHITESPACE","\n\n",6],["T_CLASS","class",8],["T_WHITESPACE"," ",8],["T_STRING","EmailTemplateConfigFilesTest",8],["T_WHITESPACE"," ",8],["T_EXTENDS","extends",8],["T_WHITESPACE"," ",8],["T_NS_SEPARATOR","\\",8],["T_STRING","PHPUnit_Framework_TestCase",8],["T_WHITESPACE","\n",8],"{",["T_WHITESPACE","\n    ",9],["T_DOC_COMMENT","\/**\n     * Test that email template configuration file matches the format\n     *\n     * @param string $file\n     * @dataProvider fileFormatDataProvider\n     *\/",10],["T_WHITESPACE","\n    ",15],["T_PUBLIC","public",16],["T_WHITESPACE"," ",16],["T_FUNCTION","function",16],["T_WHITESPACE"," ",16],["T_STRING","testFileFormat",16],"(",["T_VARIABLE","$file",16],")",["T_WHITESPACE","\n    ",16],"{",["T_WHITESPACE","\n        ",17],["T_VARIABLE","$urnResolver",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],["T_NEW","new",18],["T_WHITESPACE"," ",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Magento",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Framework",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Config",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Dom",18],["T_NS_SEPARATOR","\\",18],["T_STRING","UrnResolver",18],"(",")",";",["T_WHITESPACE","\n        ",18],["T_VARIABLE","$schemaFile",19],["T_WHITESPACE"," ",19],"=",["T_WHITESPACE"," ",19],["T_VARIABLE","$urnResolver",19],["T_OBJECT_OPERATOR","->",19],["T_STRING","getRealPath",19],"(",["T_CONSTANT_ENCAPSED_STRING","'urn:magento:module:Magento_Email:etc\/email_templates.xsd'",19],")",";",["T_WHITESPACE","\n        ",19],["T_VARIABLE","$validationStateMock",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_VARIABLE","$this",20],["T_OBJECT_OPERATOR","->",20],["T_STRING","getMock",20],"(",["T_WHITESPACE","\n            ",20],["T_NS_SEPARATOR","\\",21],["T_STRING","Magento",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Framework",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Config",21],["T_NS_SEPARATOR","\\",21],["T_STRING","ValidationStateInterface",21],["T_DOUBLE_COLON","::",21],["T_CLASS","class",21],",",["T_WHITESPACE","\n            ",21],"[","]",",",["T_WHITESPACE","\n            ",22],"[","]",",",["T_WHITESPACE","\n            ",23],["T_CONSTANT_ENCAPSED_STRING","''",24],",",["T_WHITESPACE","\n            ",24],["T_STRING","false",25],["T_WHITESPACE","\n        ",25],")",";",["T_WHITESPACE","\n        ",26],["T_VARIABLE","$validationStateMock",27],["T_OBJECT_OPERATOR","->",27],["T_STRING","method",27],"(",["T_CONSTANT_ENCAPSED_STRING","'isValidationRequired'",27],")",["T_WHITESPACE","\n            ",27],["T_OBJECT_OPERATOR","->",28],["T_STRING","willReturn",28],"(",["T_STRING","true",28],")",";",["T_WHITESPACE","\n        ",28],["T_VARIABLE","$dom",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_NEW","new",29],["T_WHITESPACE"," ",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Magento",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Framework",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Config",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Dom",29],"(",["T_STRING","file_get_contents",29],"(",["T_VARIABLE","$file",29],")",",",["T_WHITESPACE"," ",29],["T_VARIABLE","$validationStateMock",29],")",";",["T_WHITESPACE","\n        ",29],["T_VARIABLE","$result",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_VARIABLE","$dom",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","validate",30],"(",["T_VARIABLE","$schemaFile",30],",",["T_WHITESPACE"," ",30],["T_VARIABLE","$errors",30],")",";",["T_WHITESPACE","\n        ",30],["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","assertTrue",31],"(",["T_VARIABLE","$result",31],",",["T_WHITESPACE"," ",31],["T_STRING","print_r",31],"(",["T_VARIABLE","$errors",31],",",["T_WHITESPACE"," ",31],["T_STRING","true",31],")",")",";",["T_WHITESPACE","\n    ",31],"}",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * @return array\n     *\/",34],["T_WHITESPACE","\n    ",36],["T_PUBLIC","public",37],["T_WHITESPACE"," ",37],["T_FUNCTION","function",37],["T_WHITESPACE"," ",37],["T_STRING","fileFormatDataProvider",37],"(",")",["T_WHITESPACE","\n    ",37],"{",["T_WHITESPACE","\n        ",38],["T_RETURN","return",39],["T_WHITESPACE"," ",39],["T_NS_SEPARATOR","\\",39],["T_STRING","Magento",39],["T_NS_SEPARATOR","\\",39],["T_STRING","Framework",39],["T_NS_SEPARATOR","\\",39],["T_STRING","App",39],["T_NS_SEPARATOR","\\",39],["T_STRING","Utility",39],["T_NS_SEPARATOR","\\",39],["T_STRING","Files",39],["T_DOUBLE_COLON","::",39],["T_STRING","init",39],"(",")",["T_OBJECT_OPERATOR","->",39],["T_STRING","getConfigFiles",39],"(",["T_CONSTANT_ENCAPSED_STRING","'email_templates.xml'",39],")",";",["T_WHITESPACE","\n    ",39],"}",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/**\n     * Test that email template configuration contains references to existing template files\n     *\n     * @param string $templateId\n     * @dataProvider templateReferenceDataProvider\n     *\/",42],["T_WHITESPACE","\n    ",47],["T_PUBLIC","public",48],["T_WHITESPACE"," ",48],["T_FUNCTION","function",48],["T_WHITESPACE"," ",48],["T_STRING","testTemplateReference",48],"(",["T_VARIABLE","$templateId",48],")",["T_WHITESPACE","\n    ",48],"{",["T_WHITESPACE","\n        ",49],["T_DOC_COMMENT","\/** @var \\Magento\\Email\\Model\\Template\\Config $emailConfig *\/",50],["T_WHITESPACE","\n        ",50],["T_VARIABLE","$emailConfig",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Magento",51],["T_NS_SEPARATOR","\\",51],["T_STRING","TestFramework",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Helper",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Bootstrap",51],["T_DOUBLE_COLON","::",51],["T_STRING","getObjectManager",51],"(",")",["T_OBJECT_OPERATOR","->",51],["T_STRING","create",51],"(",["T_WHITESPACE","\n            ",51],["T_NS_SEPARATOR","\\",52],["T_STRING","Magento",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Email",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Model",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Template",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Config",52],["T_DOUBLE_COLON","::",52],["T_CLASS","class",52],["T_WHITESPACE","\n        ",52],")",";",["T_WHITESPACE","\n\n        ",53],["T_VARIABLE","$parts",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_VARIABLE","$emailConfig",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","parseTemplateIdParts",55],"(",["T_VARIABLE","$templateId",55],")",";",["T_WHITESPACE","\n        ",55],["T_VARIABLE","$templateId",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$parts",56],"[",["T_CONSTANT_ENCAPSED_STRING","'templateId'",56],"]",";",["T_WHITESPACE","\n\n        ",56],["T_VARIABLE","$designParams",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],"[","]",";",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$theme",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$parts",59],"[",["T_CONSTANT_ENCAPSED_STRING","'theme'",59],"]",";",["T_WHITESPACE","\n        ",59],["T_IF","if",60],["T_WHITESPACE"," ",60],"(",["T_VARIABLE","$theme",60],")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n            ",60],["T_VARIABLE","$designParams",61],"[",["T_CONSTANT_ENCAPSED_STRING","'theme'",61],"]",["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_VARIABLE","$theme",61],";",["T_WHITESPACE","\n        ",61],"}",["T_WHITESPACE","\n\n        ",62],["T_VARIABLE","$templateFilename",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$emailConfig",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","getTemplateFilename",64],"(",["T_VARIABLE","$templateId",64],",",["T_WHITESPACE"," ",64],["T_VARIABLE","$designParams",64],")",";",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","assertFileExists",65],"(",["T_VARIABLE","$templateFilename",65],",",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'Email template file, specified in the configuration, must exist'",65],")",";",["T_WHITESPACE","\n    ",65],"}",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * @return array\n     *\/",68],["T_WHITESPACE","\n    ",70],["T_PUBLIC","public",71],["T_WHITESPACE"," ",71],["T_FUNCTION","function",71],["T_WHITESPACE"," ",71],["T_STRING","templateReferenceDataProvider",71],"(",")",["T_WHITESPACE","\n    ",71],"{",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$data",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],"[","]",";",["T_WHITESPACE","\n        ",73],["T_DOC_COMMENT","\/** @var \\Magento\\Email\\Model\\Template\\Config $emailConfig *\/",74],["T_WHITESPACE","\n        ",74],["T_VARIABLE","$emailConfig",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_NS_SEPARATOR","\\",75],["T_STRING","Magento",75],["T_NS_SEPARATOR","\\",75],["T_STRING","TestFramework",75],["T_NS_SEPARATOR","\\",75],["T_STRING","Helper",75],["T_NS_SEPARATOR","\\",75],["T_STRING","Bootstrap",75],["T_DOUBLE_COLON","::",75],["T_STRING","getObjectManager",75],"(",")",["T_OBJECT_OPERATOR","->",75],["T_STRING","create",75],"(",["T_WHITESPACE","\n            ",75],["T_NS_SEPARATOR","\\",76],["T_STRING","Magento",76],["T_NS_SEPARATOR","\\",76],["T_STRING","Email",76],["T_NS_SEPARATOR","\\",76],["T_STRING","Model",76],["T_NS_SEPARATOR","\\",76],["T_STRING","Template",76],["T_NS_SEPARATOR","\\",76],["T_STRING","Config",76],["T_DOUBLE_COLON","::",76],["T_CLASS","class",76],["T_WHITESPACE","\n        ",76],")",";",["T_WHITESPACE","\n        ",77],["T_FOREACH","foreach",78],["T_WHITESPACE"," ",78],"(",["T_VARIABLE","$emailConfig",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getAvailableTemplates",78],"(",")",["T_WHITESPACE"," ",78],["T_AS","as",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$template",78],")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n            ",78],["T_VARIABLE","$data",79],"[",["T_VARIABLE","$template",79],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",79],"]","]",["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],"[",["T_VARIABLE","$template",79],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",79],"]","]",";",["T_WHITESPACE","\n        ",79],"}",["T_WHITESPACE","\n        ",80],["T_RETURN","return",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$data",81],";",["T_WHITESPACE","\n    ",81],"}",["T_WHITESPACE","\n\n    ",82],["T_DOC_COMMENT","\/**\n     * Test that merged configuration of email templates matches the format\n     *\/",84],["T_WHITESPACE","\n    ",86],["T_PUBLIC","public",87],["T_WHITESPACE"," ",87],["T_FUNCTION","function",87],["T_WHITESPACE"," ",87],["T_STRING","testMergedFormat",87],"(",")",["T_WHITESPACE","\n    ",87],"{",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$validationState",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getMock",89],"(",["T_NS_SEPARATOR","\\",89],["T_STRING","Magento",89],["T_NS_SEPARATOR","\\",89],["T_STRING","Framework",89],["T_NS_SEPARATOR","\\",89],["T_STRING","Config",89],["T_NS_SEPARATOR","\\",89],["T_STRING","ValidationStateInterface",89],["T_DOUBLE_COLON","::",89],["T_CLASS","class",89],")",";",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$validationState",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","expects",90],"(",["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","any",90],"(",")",")",["T_OBJECT_OPERATOR","->",90],["T_STRING","method",90],"(",["T_CONSTANT_ENCAPSED_STRING","'isValidationRequired'",90],")",["T_OBJECT_OPERATOR","->",90],["T_STRING","will",90],"(",["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","returnValue",90],"(",["T_STRING","true",90],")",")",";",["T_WHITESPACE","\n        ",90],["T_DOC_COMMENT","\/** @var \\Magento\\Email\\Model\\Template\\Config\\Reader $reader *\/",91],["T_WHITESPACE","\n        ",91],["T_VARIABLE","$reader",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_NS_SEPARATOR","\\",92],["T_STRING","Magento",92],["T_NS_SEPARATOR","\\",92],["T_STRING","TestFramework",92],["T_NS_SEPARATOR","\\",92],["T_STRING","Helper",92],["T_NS_SEPARATOR","\\",92],["T_STRING","Bootstrap",92],["T_DOUBLE_COLON","::",92],["T_STRING","getObjectManager",92],"(",")",["T_OBJECT_OPERATOR","->",92],["T_STRING","create",92],"(",["T_WHITESPACE","\n            ",92],["T_NS_SEPARATOR","\\",93],["T_STRING","Magento",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Email",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Model",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Template",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Config",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Reader",93],["T_DOUBLE_COLON","::",93],["T_CLASS","class",93],",",["T_WHITESPACE","\n            ",93],"[",["T_CONSTANT_ENCAPSED_STRING","'validationState'",94],["T_WHITESPACE"," ",94],["T_DOUBLE_ARROW","=>",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$validationState",94],"]",["T_WHITESPACE","\n        ",94],")",";",["T_WHITESPACE","\n        ",95],["T_TRY","try",96],["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n            ",96],["T_VARIABLE","$reader",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","read",97],"(",")",";",["T_WHITESPACE","\n        ",97],"}",["T_WHITESPACE"," ",98],["T_CATCH","catch",98],["T_WHITESPACE"," ",98],"(",["T_NS_SEPARATOR","\\",98],["T_STRING","Exception",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$e",98],")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n            ",98],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","fail",99],"(",["T_CONSTANT_ENCAPSED_STRING","'Merged email templates configuration does not pass XSD validation: '",99],["T_WHITESPACE"," ",99],".",["T_WHITESPACE"," ",99],["T_VARIABLE","$e",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","getMessage",99],"(",")",")",";",["T_WHITESPACE","\n        ",99],"}",["T_WHITESPACE","\n    ",100],"}",["T_WHITESPACE","\n",101],"}",["T_WHITESPACE","\n",102]]