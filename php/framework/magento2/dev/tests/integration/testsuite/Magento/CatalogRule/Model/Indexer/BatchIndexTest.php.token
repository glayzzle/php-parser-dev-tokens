[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","CatalogRule",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Model",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Indexer",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","TestFramework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Helper",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Bootstrap",9],";",["T_WHITESPACE","\n\n",9],["T_DOC_COMMENT","\/**\n * @magentoAppIsolation enabled\n * @magentoAppArea adminhtml\n * @magentoDataFixture Magento\/CatalogRule\/_files\/two_rules.php\n * @magentoDataFixture Magento\/Catalog\/_files\/product_simple.php\n *\/",11],["T_WHITESPACE","\n",16],["T_CLASS","class",17],["T_WHITESPACE"," ",17],["T_STRING","BatchIndexTest",17],["T_WHITESPACE"," ",17],["T_EXTENDS","extends",17],["T_WHITESPACE"," ",17],["T_NS_SEPARATOR","\\",17],["T_STRING","PHPUnit_Framework_TestCase",17],["T_WHITESPACE","\n",17],"{",["T_WHITESPACE","\n    ",18],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Catalog\\Model\\ProductRepository\n     *\/",19],["T_WHITESPACE","\n    ",21],["T_PROTECTED","protected",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$productRepository",22],";",["T_WHITESPACE","\n\n    ",22],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Catalog\\Model\\Product\n     *\/",24],["T_WHITESPACE","\n    ",26],["T_PROTECTED","protected",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$product",27],";",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\CatalogRule\\Model\\ResourceModel\\Rule\n     *\/",29],["T_WHITESPACE","\n    ",31],["T_PROTECTED","protected",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$resourceRule",32],";",["T_WHITESPACE","\n\n    ",32],["T_PROTECTED","protected",34],["T_WHITESPACE"," ",34],["T_FUNCTION","function",34],["T_WHITESPACE"," ",34],["T_STRING","setUp",34],"(",")",["T_WHITESPACE","\n    ",34],"{",["T_WHITESPACE","\n        ",35],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","resourceRule",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_STRING","Bootstrap",36],["T_DOUBLE_COLON","::",36],["T_STRING","getObjectManager",36],"(",")",["T_OBJECT_OPERATOR","->",36],["T_STRING","get",36],"(",["T_NS_SEPARATOR","\\",36],["T_STRING","Magento",36],["T_NS_SEPARATOR","\\",36],["T_STRING","CatalogRule",36],["T_NS_SEPARATOR","\\",36],["T_STRING","Model",36],["T_NS_SEPARATOR","\\",36],["T_STRING","ResourceModel",36],["T_NS_SEPARATOR","\\",36],["T_STRING","Rule",36],["T_DOUBLE_COLON","::",36],["T_CLASS","class",36],")",";",["T_WHITESPACE","\n        ",36],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","product",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_STRING","Bootstrap",37],["T_DOUBLE_COLON","::",37],["T_STRING","getObjectManager",37],"(",")",["T_OBJECT_OPERATOR","->",37],["T_STRING","get",37],"(",["T_NS_SEPARATOR","\\",37],["T_STRING","Magento",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Catalog",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Model",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Product",37],["T_DOUBLE_COLON","::",37],["T_CLASS","class",37],")",";",["T_WHITESPACE","\n        ",37],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","productRepository",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_STRING","Bootstrap",38],["T_DOUBLE_COLON","::",38],["T_STRING","getObjectManager",38],"(",")",["T_OBJECT_OPERATOR","->",38],["T_STRING","get",38],"(",["T_NS_SEPARATOR","\\",38],["T_STRING","Magento",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Catalog",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Model",38],["T_NS_SEPARATOR","\\",38],["T_STRING","ProductRepository",38],["T_DOUBLE_COLON","::",38],["T_CLASS","class",38],")",";",["T_WHITESPACE","\n    ",38],"}",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * @magentoDbIsolation enabled\n     * @dataProvider dataProvider\n     *\/",41],["T_WHITESPACE","\n    ",44],["T_PUBLIC","public",45],["T_WHITESPACE"," ",45],["T_FUNCTION","function",45],["T_WHITESPACE"," ",45],["T_STRING","testPriceForSmallBatch",45],"(",["T_VARIABLE","$batchCount",45],",",["T_WHITESPACE"," ",45],["T_VARIABLE","$price",45],",",["T_WHITESPACE"," ",45],["T_VARIABLE","$expectedPrice",45],")",["T_WHITESPACE","\n    ",45],"{",["T_WHITESPACE","\n        ",46],["T_VARIABLE","$productIds",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","prepareProducts",47],"(",["T_VARIABLE","$price",47],")",";",["T_WHITESPACE","\n\n        ",47],["T_DOC_COMMENT","\/**\n         * @var IndexBuilder $indexerBuilder\n         *\/",49],["T_WHITESPACE","\n        ",51],["T_VARIABLE","$indexerBuilder",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_STRING","Bootstrap",52],["T_DOUBLE_COLON","::",52],["T_STRING","getObjectManager",52],"(",")",["T_OBJECT_OPERATOR","->",52],["T_STRING","create",52],"(",["T_WHITESPACE","\n            ",52],["T_NS_SEPARATOR","\\",53],["T_STRING","Magento",53],["T_NS_SEPARATOR","\\",53],["T_STRING","CatalogRule",53],["T_NS_SEPARATOR","\\",53],["T_STRING","Model",53],["T_NS_SEPARATOR","\\",53],["T_STRING","Indexer",53],["T_NS_SEPARATOR","\\",53],["T_STRING","IndexBuilder",53],["T_DOUBLE_COLON","::",53],["T_CLASS","class",53],",",["T_WHITESPACE","\n            ",53],"[",["T_CONSTANT_ENCAPSED_STRING","'batchCount'",54],["T_WHITESPACE"," ",54],["T_DOUBLE_ARROW","=>",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$batchCount",54],"]",["T_WHITESPACE","\n        ",54],")",";",["T_WHITESPACE","\n\n        ",55],["T_VARIABLE","$indexerBuilder",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","reindexFull",57],"(",")",";",["T_WHITESPACE","\n\n        ",57],["T_FOREACH","foreach",59],["T_WHITESPACE"," ",59],"(","[",["T_LNUMBER","0",59],",",["T_WHITESPACE"," ",59],["T_LNUMBER","1",59],"]",["T_WHITESPACE"," ",59],["T_AS","as",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$customerGroupId",59],")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n            ",59],["T_FOREACH","foreach",60],["T_WHITESPACE"," ",60],"(",["T_VARIABLE","$productIds",60],["T_WHITESPACE"," ",60],["T_AS","as",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$productId",60],")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n                ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","assertEquals",61],"(",["T_WHITESPACE","\n                    ",61],["T_VARIABLE","$expectedPrice",62],",",["T_WHITESPACE","\n                    ",62],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","resourceRule",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","getRulePrice",63],"(",["T_NEW","new",63],["T_WHITESPACE"," ",63],["T_NS_SEPARATOR","\\",63],["T_STRING","DateTime",63],"(",")",",",["T_WHITESPACE"," ",63],["T_LNUMBER","1",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$customerGroupId",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$productId",63],")",["T_WHITESPACE","\n                ",63],")",";",["T_WHITESPACE","\n            ",64],"}",["T_WHITESPACE","\n        ",65],"}",["T_WHITESPACE","\n    ",66],"}",["T_WHITESPACE","\n\n    ",67],["T_DOC_COMMENT","\/**\n     * @return array\n     *\/",69],["T_WHITESPACE","\n    ",71],["T_PROTECTED","protected",72],["T_WHITESPACE"," ",72],["T_FUNCTION","function",72],["T_WHITESPACE"," ",72],["T_STRING","prepareProducts",72],"(",["T_VARIABLE","$price",72],")",["T_WHITESPACE","\n    ",72],"{",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","product",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","productRepository",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","get",74],"(",["T_CONSTANT_ENCAPSED_STRING","'simple'",74],")",";",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$productSecond",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_CLONE","clone",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","product",75],";",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$productSecond",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","setId",76],"(",["T_STRING","null",76],")",["T_WHITESPACE","\n            ",76],["T_OBJECT_OPERATOR","->",77],["T_STRING","setUrlKey",77],"(",["T_STRING","null",77],")",["T_WHITESPACE","\n            ",77],["T_OBJECT_OPERATOR","->",78],["T_STRING","setSku",78],"(",["T_STRING","uniqid",78],"(",["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","product",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getSku",78],"(",")",["T_WHITESPACE"," ",78],".",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'-'",78],")",")",["T_WHITESPACE","\n            ",78],["T_OBJECT_OPERATOR","->",79],["T_STRING","setName",79],"(",["T_STRING","uniqid",79],"(",["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","product",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","getName",79],"(",")",["T_WHITESPACE"," ",79],".",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'-'",79],")",")",["T_WHITESPACE","\n            ",79],["T_OBJECT_OPERATOR","->",80],["T_STRING","setWebsiteIds",80],"(","[",["T_LNUMBER","1",80],"]",")",";",["T_WHITESPACE","\n        ",80],["T_VARIABLE","$productSecond",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","save",81],"(",")",";",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$productSecond",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","setPrice",82],"(",["T_VARIABLE","$price",82],")",["T_OBJECT_OPERATOR","->",82],["T_STRING","save",82],"(",")",";",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$productThird",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_CLONE","clone",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","product",83],";",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$productThird",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","setId",84],"(",["T_STRING","null",84],")",["T_WHITESPACE","\n            ",84],["T_OBJECT_OPERATOR","->",85],["T_STRING","setUrlKey",85],"(",["T_STRING","null",85],")",["T_WHITESPACE","\n            ",85],["T_OBJECT_OPERATOR","->",86],["T_STRING","setSku",86],"(",["T_STRING","uniqid",86],"(",["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","product",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getSku",86],"(",")",["T_WHITESPACE"," ",86],".",["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","'-'",86],")",")",["T_WHITESPACE","\n            ",86],["T_OBJECT_OPERATOR","->",87],["T_STRING","setName",87],"(",["T_STRING","uniqid",87],"(",["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","product",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getName",87],"(",")",["T_WHITESPACE"," ",87],".",["T_WHITESPACE"," ",87],["T_CONSTANT_ENCAPSED_STRING","'-'",87],")",")",["T_WHITESPACE","\n            ",87],["T_OBJECT_OPERATOR","->",88],["T_STRING","setWebsiteIds",88],"(","[",["T_LNUMBER","1",88],"]",")",["T_WHITESPACE","\n            ",88],["T_OBJECT_OPERATOR","->",89],["T_STRING","save",89],"(",")",";",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$productThird",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","setPrice",90],"(",["T_VARIABLE","$price",90],")",["T_OBJECT_OPERATOR","->",90],["T_STRING","save",90],"(",")",";",["T_WHITESPACE","\n        ",90],["T_RETURN","return",91],["T_WHITESPACE"," ",91],"[",["T_WHITESPACE","\n            ",91],["T_VARIABLE","$productSecond",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getEntityId",92],"(",")",",",["T_WHITESPACE","\n            ",92],["T_VARIABLE","$productThird",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getEntityId",93],"(",")",",",["T_WHITESPACE","\n        ",93],"]",";",["T_WHITESPACE","\n    ",94],"}",["T_WHITESPACE","\n\n    ",95],["T_DOC_COMMENT","\/**\n     * @return array\n     *\/",97],["T_WHITESPACE","\n    ",99],["T_PUBLIC","public",100],["T_WHITESPACE"," ",100],["T_FUNCTION","function",100],["T_WHITESPACE"," ",100],["T_STRING","dataProvider",100],"(",")",["T_WHITESPACE","\n    ",100],"{",["T_WHITESPACE","\n        ",101],["T_RETURN","return",102],["T_WHITESPACE"," ",102],"[",["T_WHITESPACE","\n            ",102],"[",["T_LNUMBER","1",103],",",["T_WHITESPACE"," ",103],["T_LNUMBER","20",103],",",["T_WHITESPACE"," ",103],["T_LNUMBER","17",103],"]",",",["T_WHITESPACE","\n            ",103],"[",["T_LNUMBER","3",104],",",["T_WHITESPACE"," ",104],["T_LNUMBER","40",104],",",["T_WHITESPACE"," ",104],["T_LNUMBER","36",104],"]",",",["T_WHITESPACE","\n            ",104],"[",["T_LNUMBER","3",105],",",["T_WHITESPACE"," ",105],["T_LNUMBER","60",105],",",["T_WHITESPACE"," ",105],["T_LNUMBER","55",105],"]",",",["T_WHITESPACE","\n            ",105],"[",["T_LNUMBER","5",106],",",["T_WHITESPACE"," ",106],["T_LNUMBER","100",106],",",["T_WHITESPACE"," ",106],["T_LNUMBER","93",106],"]",",",["T_WHITESPACE","\n            ",106],"[",["T_LNUMBER","8",107],",",["T_WHITESPACE"," ",107],["T_LNUMBER","200",107],",",["T_WHITESPACE"," ",107],["T_LNUMBER","188",107],"]",",",["T_WHITESPACE","\n            ",107],"[",["T_LNUMBER","10",108],",",["T_WHITESPACE"," ",108],["T_LNUMBER","500",108],",",["T_WHITESPACE"," ",108],["T_LNUMBER","473",108],"]",",",["T_WHITESPACE","\n            ",108],"[",["T_LNUMBER","11",109],",",["T_WHITESPACE"," ",109],["T_LNUMBER","760",109],",",["T_WHITESPACE"," ",109],["T_LNUMBER","720",109],"]",",",["T_WHITESPACE","\n        ",109],"]",";",["T_WHITESPACE","\n    ",110],"}",["T_WHITESPACE","\n",111],"}",["T_WHITESPACE","\n",112]]