[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Integration",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Model",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Authorization",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Model",9],["T_NS_SEPARATOR","\\",9],["T_STRING","UserContextInterface",9],";",["T_WHITESPACE","\n\n",9],["T_DOC_COMMENT","\/**\n * Integration authorization service test.\n *\/",11],["T_WHITESPACE","\n",13],["T_CLASS","class",14],["T_WHITESPACE"," ",14],["T_STRING","AuthorizationServiceTest",14],["T_WHITESPACE"," ",14],["T_EXTENDS","extends",14],["T_WHITESPACE"," ",14],["T_NS_SEPARATOR","\\",14],["T_STRING","PHPUnit_Framework_TestCase",14],["T_WHITESPACE","\n",14],"{",["T_WHITESPACE","\n    ",15],["T_DOC_COMMENT","\/** @var AuthorizationService *\/",16],["T_WHITESPACE","\n    ",16],["T_PROTECTED","protected",17],["T_WHITESPACE"," ",17],["T_VARIABLE","$_service",17],";",["T_WHITESPACE","\n\n    ",17],["T_DOC_COMMENT","\/** @var \\Magento\\Framework\\Authorization *\/",19],["T_WHITESPACE","\n    ",19],["T_PROTECTED","protected",20],["T_WHITESPACE"," ",20],["T_VARIABLE","$libAuthorization",20],";",["T_WHITESPACE","\n\n    ",20],["T_DOC_COMMENT","\/** @var \\Magento\\Authorization\\Model\\UserContextInterface|\\PHPUnit_Framework_MockObject_MockObject *\/",22],["T_WHITESPACE","\n    ",22],["T_PROTECTED","protected",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$userContextMock",23],";",["T_WHITESPACE","\n\n    ",23],["T_PROTECTED","protected",25],["T_WHITESPACE"," ",25],["T_FUNCTION","function",25],["T_WHITESPACE"," ",25],["T_STRING","setUp",25],"(",")",["T_WHITESPACE","\n    ",25],"{",["T_WHITESPACE","\n        ",26],["T_STRING","parent",27],["T_DOUBLE_COLON","::",27],["T_STRING","setUp",27],"(",")",";",["T_WHITESPACE","\n        ",27],["T_VARIABLE","$objectManager",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_NS_SEPARATOR","\\",28],["T_STRING","Magento",28],["T_NS_SEPARATOR","\\",28],["T_STRING","TestFramework",28],["T_NS_SEPARATOR","\\",28],["T_STRING","Helper",28],["T_NS_SEPARATOR","\\",28],["T_STRING","Bootstrap",28],["T_DOUBLE_COLON","::",28],["T_STRING","getObjectManager",28],"(",")",";",["T_WHITESPACE","\n        ",28],["T_VARIABLE","$loggerMock",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_VARIABLE","$this",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","getMockBuilder",29],"(",["T_NS_SEPARATOR","\\",29],["T_STRING","Psr",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Log",29],["T_NS_SEPARATOR","\\",29],["T_STRING","LoggerInterface",29],["T_DOUBLE_COLON","::",29],["T_CLASS","class",29],")",["T_OBJECT_OPERATOR","->",29],["T_STRING","disableOriginalConstructor",29],"(",")",["T_OBJECT_OPERATOR","->",29],["T_STRING","getMock",29],"(",")",";",["T_WHITESPACE","\n        ",29],["T_VARIABLE","$loggerMock",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","expects",30],"(",["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","any",30],"(",")",")",["T_OBJECT_OPERATOR","->",30],["T_STRING","method",30],"(",["T_CONSTANT_ENCAPSED_STRING","'critical'",30],")",["T_OBJECT_OPERATOR","->",30],["T_STRING","will",30],"(",["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","returnSelf",30],"(",")",")",";",["T_WHITESPACE","\n        ",30],["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","_service",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_VARIABLE","$objectManager",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","create",31],"(",["T_WHITESPACE","\n            ",31],["T_NS_SEPARATOR","\\",32],["T_STRING","Magento",32],["T_NS_SEPARATOR","\\",32],["T_STRING","Integration",32],["T_NS_SEPARATOR","\\",32],["T_STRING","Model",32],["T_NS_SEPARATOR","\\",32],["T_STRING","AuthorizationService",32],["T_DOUBLE_COLON","::",32],["T_CLASS","class",32],",",["T_WHITESPACE","\n            ",32],"[",["T_WHITESPACE","\n                ",33],["T_CONSTANT_ENCAPSED_STRING","'logger'",34],["T_WHITESPACE"," ",34],["T_DOUBLE_ARROW","=>",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$loggerMock",34],["T_WHITESPACE","\n            ",34],"]",["T_WHITESPACE","\n        ",35],")",";",["T_WHITESPACE","\n\n        ",36],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","userContextMock",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","getMockForAbstractClass",38],"(",["T_WHITESPACE","\n            ",38],["T_NS_SEPARATOR","\\",39],["T_STRING","Magento",39],["T_NS_SEPARATOR","\\",39],["T_STRING","Authorization",39],["T_NS_SEPARATOR","\\",39],["T_STRING","Model",39],["T_NS_SEPARATOR","\\",39],["T_STRING","UserContextInterface",39],["T_DOUBLE_COLON","::",39],["T_CLASS","class",39],["T_WHITESPACE","\n        ",39],")",";",["T_WHITESPACE","\n        ",40],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","userContextMock",41],["T_WHITESPACE","\n            ",41],["T_OBJECT_OPERATOR","->",42],["T_STRING","expects",42],"(",["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","any",42],"(",")",")",["T_WHITESPACE","\n            ",42],["T_OBJECT_OPERATOR","->",43],["T_STRING","method",43],"(",["T_CONSTANT_ENCAPSED_STRING","'getUserType'",43],")",["T_WHITESPACE","\n            ",43],["T_OBJECT_OPERATOR","->",44],["T_STRING","will",44],"(",["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","returnValue",44],"(",["T_STRING","UserContextInterface",44],["T_DOUBLE_COLON","::",44],["T_STRING","USER_TYPE_INTEGRATION",44],")",")",";",["T_WHITESPACE","\n        ",44],["T_VARIABLE","$roleLocator",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_VARIABLE","$objectManager",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","create",45],"(",["T_WHITESPACE","\n            ",45],["T_NS_SEPARATOR","\\",46],["T_STRING","Magento",46],["T_NS_SEPARATOR","\\",46],["T_STRING","Webapi",46],["T_NS_SEPARATOR","\\",46],["T_STRING","Model",46],["T_NS_SEPARATOR","\\",46],["T_STRING","WebapiRoleLocator",46],["T_DOUBLE_COLON","::",46],["T_CLASS","class",46],",",["T_WHITESPACE","\n            ",46],"[",["T_CONSTANT_ENCAPSED_STRING","'userContext'",47],["T_WHITESPACE"," ",47],["T_DOUBLE_ARROW","=>",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","userContextMock",47],"]",["T_WHITESPACE","\n        ",47],")",";",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","libAuthorization",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$objectManager",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","create",49],"(",["T_WHITESPACE","\n            ",49],["T_NS_SEPARATOR","\\",50],["T_STRING","Magento",50],["T_NS_SEPARATOR","\\",50],["T_STRING","Framework",50],["T_NS_SEPARATOR","\\",50],["T_STRING","Authorization",50],["T_DOUBLE_COLON","::",50],["T_CLASS","class",50],",",["T_WHITESPACE","\n            ",50],"[",["T_CONSTANT_ENCAPSED_STRING","'roleLocator'",51],["T_WHITESPACE"," ",51],["T_DOUBLE_ARROW","=>",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$roleLocator",51],"]",["T_WHITESPACE","\n        ",51],")",";",["T_WHITESPACE","\n    ",52],"}",["T_WHITESPACE","\n\n    ",53],["T_DOC_COMMENT","\/**\n     * @magentoDbIsolation enabled\n     *\/",55],["T_WHITESPACE","\n    ",57],["T_PUBLIC","public",58],["T_WHITESPACE"," ",58],["T_FUNCTION","function",58],["T_WHITESPACE"," ",58],["T_STRING","testGrantPermissions",58],"(",")",["T_WHITESPACE","\n    ",58],"{",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$integrationId",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_STRING","rand",60],"(",["T_LNUMBER","1",60],",",["T_WHITESPACE"," ",60],["T_LNUMBER","1000",60],")",";",["T_WHITESPACE","\n        ",60],["T_VARIABLE","$resources",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],"[",["T_CONSTANT_ENCAPSED_STRING","'Magento_Sales::create'",61],",",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'Magento_Cms::page'",61],",",["T_WHITESPACE"," ",61],["T_CONSTANT_ENCAPSED_STRING","'Magento_Backend::dashboard'",61],"]",";",["T_WHITESPACE","\n        ",61],["T_DOC_COMMENT","\/** Preconditions check *\/",62],["T_WHITESPACE","\n        ",62],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","_ensurePermissionsAreNotGranted",63],"(",["T_VARIABLE","$integrationId",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$resources",63],")",";",["T_WHITESPACE","\n\n        ",63],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","_service",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","grantPermissions",65],"(",["T_VARIABLE","$integrationId",65],",",["T_WHITESPACE"," ",65],["T_VARIABLE","$resources",65],")",";",["T_WHITESPACE","\n\n        ",65],["T_DOC_COMMENT","\/** Validate that access to the specified resources is granted *\/",67],["T_WHITESPACE","\n        ",67],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","_ensurePermissionsAreGranted",68],"(",["T_VARIABLE","$integrationId",68],",",["T_WHITESPACE"," ",68],["T_VARIABLE","$resources",68],")",";",["T_WHITESPACE","\n    ",68],"}",["T_WHITESPACE","\n\n    ",69],["T_DOC_COMMENT","\/**\n     * @param int $integrationId\n     * @param string[] $initialResources\n     * @param string[] $newResources\n     * @magentoDbIsolation enabled\n     * @dataProvider changePermissionsProvider\n     *\/",71],["T_WHITESPACE","\n    ",77],["T_PUBLIC","public",78],["T_WHITESPACE"," ",78],["T_FUNCTION","function",78],["T_WHITESPACE"," ",78],["T_STRING","testChangePermissions",78],"(",["T_VARIABLE","$integrationId",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$initialResources",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$newResources",78],")",["T_WHITESPACE","\n    ",78],"{",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","_service",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","grantPermissions",80],"(",["T_VARIABLE","$integrationId",80],",",["T_WHITESPACE"," ",80],["T_VARIABLE","$initialResources",80],")",";",["T_WHITESPACE","\n        ",80],["T_DOC_COMMENT","\/** Preconditions check *\/",81],["T_WHITESPACE","\n        ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","_ensurePermissionsAreGranted",82],"(",["T_VARIABLE","$integrationId",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$initialResources",82],")",";",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","_ensurePermissionsAreNotGranted",83],"(",["T_VARIABLE","$integrationId",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$newResources",83],")",";",["T_WHITESPACE","\n\n        ",83],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","_service",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","grantPermissions",85],"(",["T_VARIABLE","$integrationId",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$newResources",85],")",";",["T_WHITESPACE","\n\n        ",85],["T_DOC_COMMENT","\/** Check the results of permissions change *\/",87],["T_WHITESPACE","\n        ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","_ensurePermissionsAreGranted",88],"(",["T_VARIABLE","$integrationId",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$newResources",88],")",";",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","_ensurePermissionsAreNotGranted",89],"(",["T_VARIABLE","$integrationId",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$initialResources",89],")",";",["T_WHITESPACE","\n    ",89],"}",["T_WHITESPACE","\n\n    ",90],["T_PUBLIC","public",92],["T_WHITESPACE"," ",92],["T_FUNCTION","function",92],["T_WHITESPACE"," ",92],["T_STRING","changePermissionsProvider",92],"(",")",["T_WHITESPACE","\n    ",92],"{",["T_WHITESPACE","\n        ",93],["T_RETURN","return",94],["T_WHITESPACE"," ",94],"[",["T_WHITESPACE","\n            ",94],["T_CONSTANT_ENCAPSED_STRING","'integration'",95],["T_WHITESPACE"," ",95],["T_DOUBLE_ARROW","=>",95],["T_WHITESPACE"," ",95],"[",["T_WHITESPACE","\n                ",95],["T_CONSTANT_ENCAPSED_STRING","'integrationId'",96],["T_WHITESPACE"," ",96],["T_DOUBLE_ARROW","=>",96],["T_WHITESPACE"," ",96],["T_STRING","rand",96],"(",["T_LNUMBER","1",96],",",["T_WHITESPACE"," ",96],["T_LNUMBER","1000",96],")",",",["T_WHITESPACE","\n                ",96],["T_CONSTANT_ENCAPSED_STRING","'initialResources'",97],["T_WHITESPACE"," ",97],["T_DOUBLE_ARROW","=>",97],["T_WHITESPACE"," ",97],"[",["T_CONSTANT_ENCAPSED_STRING","'Magento_Cms::page'",97],",",["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","'Magento_Backend::dashboard'",97],"]",",",["T_WHITESPACE","\n                ",97],["T_CONSTANT_ENCAPSED_STRING","'newResources'",98],["T_WHITESPACE"," ",98],["T_DOUBLE_ARROW","=>",98],["T_WHITESPACE"," ",98],"[",["T_CONSTANT_ENCAPSED_STRING","'Magento_Sales::cancel'",98],",",["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'Magento_Cms::page_delete'",98],"]",",",["T_WHITESPACE","\n            ",98],"]",",",["T_WHITESPACE","\n            ",99],["T_CONSTANT_ENCAPSED_STRING","'integration clear permissions'",100],["T_WHITESPACE"," ",100],["T_DOUBLE_ARROW","=>",100],["T_WHITESPACE"," ",100],"[",["T_WHITESPACE","\n                ",100],["T_CONSTANT_ENCAPSED_STRING","'integrationId'",101],["T_WHITESPACE"," ",101],["T_DOUBLE_ARROW","=>",101],["T_WHITESPACE"," ",101],["T_STRING","rand",101],"(",["T_LNUMBER","1",101],",",["T_WHITESPACE"," ",101],["T_LNUMBER","1000",101],")",",",["T_WHITESPACE","\n                ",101],["T_CONSTANT_ENCAPSED_STRING","'initialResources'",102],["T_WHITESPACE"," ",102],["T_DOUBLE_ARROW","=>",102],["T_WHITESPACE"," ",102],"[",["T_CONSTANT_ENCAPSED_STRING","'Magento_Sales::capture'",102],",",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'Magento_Cms::page_delete'",102],"]",",",["T_WHITESPACE","\n                ",102],["T_CONSTANT_ENCAPSED_STRING","'newResources'",103],["T_WHITESPACE"," ",103],["T_DOUBLE_ARROW","=>",103],["T_WHITESPACE"," ",103],"[","]",",",["T_WHITESPACE","\n            ",103],"]",["T_WHITESPACE","\n        ",104],"]",";",["T_WHITESPACE","\n    ",105],"}",["T_WHITESPACE","\n\n    ",106],["T_DOC_COMMENT","\/**\n     * @magentoDbIsolation enabled\n     *\/",108],["T_WHITESPACE","\n    ",110],["T_PUBLIC","public",111],["T_WHITESPACE"," ",111],["T_FUNCTION","function",111],["T_WHITESPACE"," ",111],["T_STRING","testGrantAllPermissions",111],"(",")",["T_WHITESPACE","\n    ",111],"{",["T_WHITESPACE","\n        ",112],["T_VARIABLE","$integrationId",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_STRING","rand",113],"(",["T_LNUMBER","1",113],",",["T_WHITESPACE"," ",113],["T_LNUMBER","1000",113],")",";",["T_WHITESPACE","\n        ",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","_service",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","grantAllPermissions",114],"(",["T_VARIABLE","$integrationId",114],")",";",["T_WHITESPACE","\n        ",114],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","_ensurePermissionsAreGranted",115],"(",["T_VARIABLE","$integrationId",115],",",["T_WHITESPACE"," ",115],"[",["T_CONSTANT_ENCAPSED_STRING","'Magento_Backend::all'",115],"]",")",";",["T_WHITESPACE","\n    ",115],"}",["T_WHITESPACE","\n\n    ",116],["T_DOC_COMMENT","\/**\n     * Check if user has access to the specified resources.\n     *\n     * @param int $integrationId\n     * @param string[] $resources\n     *\/",118],["T_WHITESPACE","\n    ",123],["T_PROTECTED","protected",124],["T_WHITESPACE"," ",124],["T_FUNCTION","function",124],["T_WHITESPACE"," ",124],["T_STRING","_ensurePermissionsAreGranted",124],"(",["T_VARIABLE","$integrationId",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$resources",124],")",["T_WHITESPACE","\n    ",124],"{",["T_WHITESPACE","\n        ",125],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","userContextMock",126],["T_WHITESPACE","\n            ",126],["T_OBJECT_OPERATOR","->",127],["T_STRING","expects",127],"(",["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","any",127],"(",")",")",["T_WHITESPACE","\n            ",127],["T_OBJECT_OPERATOR","->",128],["T_STRING","method",128],"(",["T_CONSTANT_ENCAPSED_STRING","'getUserId'",128],")",["T_WHITESPACE","\n            ",128],["T_OBJECT_OPERATOR","->",129],["T_STRING","will",129],"(",["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","returnValue",129],"(",["T_VARIABLE","$integrationId",129],")",")",";",["T_WHITESPACE","\n        ",129],["T_FOREACH","foreach",130],["T_WHITESPACE"," ",130],"(",["T_VARIABLE","$resources",130],["T_WHITESPACE"," ",130],["T_AS","as",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$resource",130],")",["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n            ",130],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","assertTrue",131],"(",["T_WHITESPACE","\n                ",131],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","libAuthorization",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","isAllowed",132],"(",["T_VARIABLE","$resource",132],")",",",["T_WHITESPACE","\n                ",132],"\"",["T_ENCAPSED_AND_WHITESPACE","Access to resource '",133],["T_CURLY_OPEN","{",133],["T_VARIABLE","$resource",133],"}",["T_ENCAPSED_AND_WHITESPACE","' is prohibited while it is expected to be granted.",133],"\"",["T_WHITESPACE","\n            ",133],")",";",["T_WHITESPACE","\n        ",134],"}",["T_WHITESPACE","\n    ",135],"}",["T_WHITESPACE","\n\n    ",136],["T_DOC_COMMENT","\/**\n     * Check if access to the specified resources is prohibited to the user.\n     *\n     * @param int $integrationId\n     * @param string[] $resources\n     *\/",138],["T_WHITESPACE","\n    ",143],["T_PROTECTED","protected",144],["T_WHITESPACE"," ",144],["T_FUNCTION","function",144],["T_WHITESPACE"," ",144],["T_STRING","_ensurePermissionsAreNotGranted",144],"(",["T_VARIABLE","$integrationId",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$resources",144],")",["T_WHITESPACE","\n    ",144],"{",["T_WHITESPACE","\n        ",145],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","userContextMock",146],["T_WHITESPACE","\n            ",146],["T_OBJECT_OPERATOR","->",147],["T_STRING","expects",147],"(",["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","any",147],"(",")",")",["T_WHITESPACE","\n            ",147],["T_OBJECT_OPERATOR","->",148],["T_STRING","method",148],"(",["T_CONSTANT_ENCAPSED_STRING","'getUserId'",148],")",["T_WHITESPACE","\n            ",148],["T_OBJECT_OPERATOR","->",149],["T_STRING","will",149],"(",["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","returnValue",149],"(",["T_VARIABLE","$integrationId",149],")",")",";",["T_WHITESPACE","\n        ",149],["T_FOREACH","foreach",150],["T_WHITESPACE"," ",150],"(",["T_VARIABLE","$resources",150],["T_WHITESPACE"," ",150],["T_AS","as",150],["T_WHITESPACE"," ",150],["T_VARIABLE","$resource",150],")",["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n            ",150],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","assertFalse",151],"(",["T_WHITESPACE","\n                ",151],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","libAuthorization",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","isAllowed",152],"(",["T_VARIABLE","$resource",152],")",",",["T_WHITESPACE","\n                ",152],"\"",["T_ENCAPSED_AND_WHITESPACE","Access to resource '",153],["T_CURLY_OPEN","{",153],["T_VARIABLE","$resource",153],"}",["T_ENCAPSED_AND_WHITESPACE","' is expected to be prohibited.",153],"\"",["T_WHITESPACE","\n            ",153],")",";",["T_WHITESPACE","\n        ",154],"}",["T_WHITESPACE","\n    ",155],"}",["T_WHITESPACE","\n",156],"}",["T_WHITESPACE","\n",157]]