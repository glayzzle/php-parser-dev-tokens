[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Paypal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * @magentoAppArea frontend\n *\/",8],["T_WHITESPACE","\n",10],["T_CLASS","class",11],["T_WHITESPACE"," ",11],["T_STRING","IpnTest",11],["T_WHITESPACE"," ",11],["T_EXTENDS","extends",11],["T_WHITESPACE"," ",11],["T_NS_SEPARATOR","\\",11],["T_STRING","PHPUnit_Framework_TestCase",11],["T_WHITESPACE","\n",11],"{",["T_WHITESPACE","\n    ",12],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\ObjectManagerInterface\n     *\/",13],["T_WHITESPACE","\n    ",15],["T_PROTECTED","protected",16],["T_WHITESPACE"," ",16],["T_VARIABLE","$_objectManager",16],";",["T_WHITESPACE","\n\n    ",16],["T_PROTECTED","protected",18],["T_WHITESPACE"," ",18],["T_FUNCTION","function",18],["T_WHITESPACE"," ",18],["T_STRING","setUp",18],"(",")",["T_WHITESPACE","\n    ",18],"{",["T_WHITESPACE","\n        ",19],["T_VARIABLE","$this",20],["T_OBJECT_OPERATOR","->",20],["T_STRING","_objectManager",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Magento",20],["T_NS_SEPARATOR","\\",20],["T_STRING","TestFramework",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Helper",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Bootstrap",20],["T_DOUBLE_COLON","::",20],["T_STRING","getObjectManager",20],"(",")",";",["T_WHITESPACE","\n    ",20],"}",["T_WHITESPACE","\n\n    ",21],["T_DOC_COMMENT","\/**\n     * @param string $currencyCode\n     * @dataProvider currencyProvider\n     * @magentoDataFixture Magento\/Paypal\/_files\/order_express.php\n     * @magentoConfigFixture current_store payment\/paypal_direct\/active 1\n     * @magentoConfigFixture current_store payment\/paypal_express\/active 1\n     * @magentoConfigFixture current_store paypal\/general\/merchant_country US\n     *\/",23],["T_WHITESPACE","\n    ",30],["T_PUBLIC","public",31],["T_WHITESPACE"," ",31],["T_FUNCTION","function",31],["T_WHITESPACE"," ",31],["T_STRING","testProcessIpnRequestExpressCurrency",31],"(",["T_VARIABLE","$currencyCode",31],")",["T_WHITESPACE","\n    ",31],"{",["T_WHITESPACE","\n        ",32],["T_VARIABLE","$this",33],["T_OBJECT_OPERATOR","->",33],["T_STRING","_processIpnRequestCurrency",33],"(",["T_VARIABLE","$currencyCode",33],")",";",["T_WHITESPACE","\n    ",33],"}",["T_WHITESPACE","\n\n    ",34],["T_DOC_COMMENT","\/**\n     * Test processIpnRequest() currency check for paypal_express and paypal_standard payment methods\n     *\n     * @param string $currencyCode\n     *\/",36],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_FUNCTION","function",41],["T_WHITESPACE"," ",41],["T_STRING","_processIpnRequestCurrency",41],"(",["T_VARIABLE","$currencyCode",41],")",["T_WHITESPACE","\n    ",41],"{",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$ipnData",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_REQUIRE","require",43],["T_WHITESPACE"," ",43],["T_DIR","__DIR__",43],["T_WHITESPACE"," ",43],".",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'\/..\/_files\/ipn.php'",43],";",["T_WHITESPACE","\n        ",43],["T_VARIABLE","$ipnData",44],"[",["T_CONSTANT_ENCAPSED_STRING","'mc_currency'",44],"]",["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_VARIABLE","$currencyCode",44],";",["T_WHITESPACE","\n\n        ",44],["T_DOC_COMMENT","\/** @var  $ipnFactory \\Magento\\Paypal\\Model\\IpnFactory *\/",46],["T_WHITESPACE","\n        ",46],["T_VARIABLE","$ipnFactory",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","_objectManager",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","create",47],"(",["T_NS_SEPARATOR","\\",47],["T_STRING","Magento",47],["T_NS_SEPARATOR","\\",47],["T_STRING","Paypal",47],["T_NS_SEPARATOR","\\",47],["T_STRING","Model",47],["T_NS_SEPARATOR","\\",47],["T_STRING","IpnFactory",47],["T_DOUBLE_COLON","::",47],["T_CLASS","class",47],")",";",["T_WHITESPACE","\n\n        ",47],["T_VARIABLE","$model",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$ipnFactory",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","create",49],"(","[",["T_CONSTANT_ENCAPSED_STRING","'data'",49],["T_WHITESPACE"," ",49],["T_DOUBLE_ARROW","=>",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$ipnData",49],",",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'curlFactory'",49],["T_WHITESPACE"," ",49],["T_DOUBLE_ARROW","=>",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","_createMockedHttpAdapter",49],"(",")","]",")",";",["T_WHITESPACE","\n        ",49],["T_VARIABLE","$model",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","processIpnRequest",50],"(",")",";",["T_WHITESPACE","\n\n        ",50],["T_VARIABLE","$order",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","_objectManager",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","create",52],"(",["T_NS_SEPARATOR","\\",52],["T_STRING","Magento",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Sales",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Model",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Order",52],["T_DOUBLE_COLON","::",52],["T_CLASS","class",52],")",";",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$order",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","loadByIncrementId",53],"(",["T_CONSTANT_ENCAPSED_STRING","'100000001'",53],")",";",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","_assertOrder",54],"(",["T_VARIABLE","$order",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$currencyCode",54],")",";",["T_WHITESPACE","\n    ",54],"}",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * Perform order state and status assertions depending on currency code\n     *\n     * @param \\Magento\\Sales\\Model\\Order $order\n     * @param string $currencyCode\n     *\/",57],["T_WHITESPACE","\n    ",62],["T_PROTECTED","protected",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","_assertOrder",63],"(",["T_VARIABLE","$order",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$currencyCode",63],")",["T_WHITESPACE","\n    ",63],"{",["T_WHITESPACE","\n        ",64],["T_IF","if",65],["T_WHITESPACE"," ",65],"(",["T_VARIABLE","$currencyCode",65],["T_WHITESPACE"," ",65],["T_IS_EQUAL","==",65],["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'USD'",65],")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n            ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","assertEquals",66],"(",["T_CONSTANT_ENCAPSED_STRING","'complete'",66],",",["T_WHITESPACE"," ",66],["T_VARIABLE","$order",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getState",66],"(",")",")",";",["T_WHITESPACE","\n            ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","assertEquals",67],"(",["T_CONSTANT_ENCAPSED_STRING","'complete'",67],",",["T_WHITESPACE"," ",67],["T_VARIABLE","$order",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getStatus",67],"(",")",")",";",["T_WHITESPACE","\n        ",67],"}",["T_WHITESPACE"," ",68],["T_ELSE","else",68],["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n            ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","assertEquals",69],"(",["T_CONSTANT_ENCAPSED_STRING","'payment_review'",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$order",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getState",69],"(",")",")",";",["T_WHITESPACE","\n            ",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","assertEquals",70],"(",["T_CONSTANT_ENCAPSED_STRING","'fraud'",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$order",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getStatus",70],"(",")",")",";",["T_WHITESPACE","\n        ",70],"}",["T_WHITESPACE","\n    ",71],"}",["T_WHITESPACE","\n\n    ",72],["T_DOC_COMMENT","\/**\n     * Data provider for currency check tests\n     *\n     * @static\n     * @return array\n     *\/",74],["T_WHITESPACE","\n    ",79],["T_PUBLIC","public",80],["T_WHITESPACE"," ",80],["T_STATIC","static",80],["T_WHITESPACE"," ",80],["T_FUNCTION","function",80],["T_WHITESPACE"," ",80],["T_STRING","currencyProvider",80],"(",")",["T_WHITESPACE","\n    ",80],"{",["T_WHITESPACE","\n        ",81],["T_RETURN","return",82],["T_WHITESPACE"," ",82],"[","[",["T_CONSTANT_ENCAPSED_STRING","'USD'",82],"]",",",["T_WHITESPACE"," ",82],"[",["T_CONSTANT_ENCAPSED_STRING","'EUR'",82],"]","]",";",["T_WHITESPACE","\n    ",82],"}",["T_WHITESPACE","\n\n    ",83],["T_DOC_COMMENT","\/**\n     * Mocked HTTP adapter to get VERIFIED PayPal IPN postback result\n     *\n     * @return \\Magento\\Framework\\HTTP\\Adapter\\Curl\n     *\/",85],["T_WHITESPACE","\n    ",89],["T_PROTECTED","protected",90],["T_WHITESPACE"," ",90],["T_FUNCTION","function",90],["T_WHITESPACE"," ",90],["T_STRING","_createMockedHttpAdapter",90],"(",")",["T_WHITESPACE","\n    ",90],"{",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$factory",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getMock",92],"(",["T_NS_SEPARATOR","\\",92],["T_STRING","Magento",92],["T_NS_SEPARATOR","\\",92],["T_STRING","Framework",92],["T_NS_SEPARATOR","\\",92],["T_STRING","HTTP",92],["T_NS_SEPARATOR","\\",92],["T_STRING","Adapter",92],["T_NS_SEPARATOR","\\",92],["T_STRING","CurlFactory",92],["T_DOUBLE_COLON","::",92],["T_CLASS","class",92],",",["T_WHITESPACE"," ",92],"[",["T_CONSTANT_ENCAPSED_STRING","'create'",92],"]",",",["T_WHITESPACE"," ",92],"[","]",",",["T_WHITESPACE"," ",92],["T_CONSTANT_ENCAPSED_STRING","''",92],",",["T_WHITESPACE"," ",92],["T_STRING","false",92],")",";",["T_WHITESPACE","\n        ",92],["T_VARIABLE","$adapter",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getMock",93],"(",["T_NS_SEPARATOR","\\",93],["T_STRING","Magento",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Framework",93],["T_NS_SEPARATOR","\\",93],["T_STRING","HTTP",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Adapter",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Curl",93],["T_DOUBLE_COLON","::",93],["T_CLASS","class",93],",",["T_WHITESPACE"," ",93],"[",["T_CONSTANT_ENCAPSED_STRING","'read'",93],",",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","'write'",93],"]",",",["T_WHITESPACE"," ",93],"[","]",",",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","''",93],",",["T_WHITESPACE"," ",93],["T_STRING","false",93],")",";",["T_WHITESPACE","\n\n        ",93],["T_VARIABLE","$adapter",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","expects",95],"(",["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","once",95],"(",")",")",["T_OBJECT_OPERATOR","->",95],["T_STRING","method",95],"(",["T_CONSTANT_ENCAPSED_STRING","'read'",95],")",["T_OBJECT_OPERATOR","->",95],["T_STRING","with",95],"(",")",["T_OBJECT_OPERATOR","->",95],["T_STRING","will",95],"(",["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","returnValue",95],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\nVERIFIED\"",95],")",")",";",["T_WHITESPACE","\n\n        ",95],["T_VARIABLE","$adapter",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","expects",97],"(",["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","once",97],"(",")",")",["T_OBJECT_OPERATOR","->",97],["T_STRING","method",97],"(",["T_CONSTANT_ENCAPSED_STRING","'write'",97],")",";",["T_WHITESPACE","\n\n        ",97],["T_VARIABLE","$factory",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","expects",99],"(",["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","once",99],"(",")",")",["T_OBJECT_OPERATOR","->",99],["T_STRING","method",99],"(",["T_CONSTANT_ENCAPSED_STRING","'create'",99],")",["T_OBJECT_OPERATOR","->",99],["T_STRING","with",99],"(",")",["T_OBJECT_OPERATOR","->",99],["T_STRING","will",99],"(",["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","returnValue",99],"(",["T_VARIABLE","$adapter",99],")",")",";",["T_WHITESPACE","\n        ",99],["T_RETURN","return",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$factory",100],";",["T_WHITESPACE","\n    ",100],"}",["T_WHITESPACE","\n",101],"}",["T_WHITESPACE","\n",102]]