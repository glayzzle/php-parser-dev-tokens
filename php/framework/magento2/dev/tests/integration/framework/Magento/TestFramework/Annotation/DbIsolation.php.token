[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","TestFramework",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Annotation",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Implementation of the @magentoDbIsolation DocBlock annotation\n *\/",8],["T_WHITESPACE","\n",10],["T_CLASS","class",11],["T_WHITESPACE"," ",11],["T_STRING","DbIsolation",11],["T_WHITESPACE","\n",11],"{",["T_WHITESPACE","\n    ",12],["T_CONST","const",13],["T_WHITESPACE"," ",13],["T_STRING","MAGENTO_DB_ISOLATION",13],["T_WHITESPACE"," ",13],"=",["T_WHITESPACE"," ",13],["T_CONSTANT_ENCAPSED_STRING","'magentoDbIsolation'",13],";",["T_WHITESPACE","\n    ",13],["T_DOC_COMMENT","\/**\n     * @var bool\n     *\/",14],["T_WHITESPACE","\n    ",16],["T_PROTECTED","protected",17],["T_WHITESPACE"," ",17],["T_VARIABLE","$_isIsolationActive",17],["T_WHITESPACE"," ",17],"=",["T_WHITESPACE"," ",17],["T_STRING","false",17],";",["T_WHITESPACE","\n\n    ",17],["T_DOC_COMMENT","\/**\n     * Handler for 'startTestTransactionRequest' event\n     *\n     * @param \\PHPUnit_Framework_TestCase $test\n     * @param \\Magento\\TestFramework\\Event\\Param\\Transaction $param\n     *\/",19],["T_WHITESPACE","\n    ",24],["T_PUBLIC","public",25],["T_WHITESPACE"," ",25],["T_FUNCTION","function",25],["T_WHITESPACE"," ",25],["T_STRING","startTestTransactionRequest",25],"(",["T_WHITESPACE","\n        ",25],["T_NS_SEPARATOR","\\",26],["T_STRING","PHPUnit_Framework_TestCase",26],["T_WHITESPACE"," ",26],["T_VARIABLE","$test",26],",",["T_WHITESPACE","\n        ",26],["T_NS_SEPARATOR","\\",27],["T_STRING","Magento",27],["T_NS_SEPARATOR","\\",27],["T_STRING","TestFramework",27],["T_NS_SEPARATOR","\\",27],["T_STRING","Event",27],["T_NS_SEPARATOR","\\",27],["T_STRING","Param",27],["T_NS_SEPARATOR","\\",27],["T_STRING","Transaction",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$param",27],["T_WHITESPACE","\n    ",27],")",["T_WHITESPACE"," ",28],"{",["T_WHITESPACE","\n        ",28],["T_VARIABLE","$methodIsolation",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_VARIABLE","$this",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","_getIsolation",29],"(",["T_VARIABLE","$test",29],")",";",["T_WHITESPACE","\n        ",29],["T_IF","if",30],["T_WHITESPACE"," ",30],"(",["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","_isIsolationActive",30],")",["T_WHITESPACE"," ",30],"{",["T_WHITESPACE","\n            ",30],["T_IF","if",31],["T_WHITESPACE"," ",31],"(",["T_VARIABLE","$methodIsolation",31],["T_WHITESPACE"," ",31],["T_IS_IDENTICAL","===",31],["T_WHITESPACE"," ",31],["T_STRING","false",31],")",["T_WHITESPACE"," ",31],"{",["T_WHITESPACE","\n                ",31],["T_VARIABLE","$param",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","requestTransactionRollback",32],"(",")",";",["T_WHITESPACE","\n            ",32],"}",["T_WHITESPACE","\n        ",33],"}",["T_WHITESPACE"," ",34],["T_ELSEIF","elseif",34],["T_WHITESPACE"," ",34],"(",["T_VARIABLE","$methodIsolation",34],["T_WHITESPACE"," ",34],["T_BOOLEAN_OR","||",34],["T_WHITESPACE"," ",34],"(",["T_VARIABLE","$methodIsolation",34],["T_WHITESPACE"," ",34],["T_IS_IDENTICAL","===",34],["T_WHITESPACE"," ",34],["T_STRING","null",34],["T_WHITESPACE"," ",34],["T_BOOLEAN_AND","&&",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","_getIsolation",34],"(",["T_VARIABLE","$test",34],")",")",")",["T_WHITESPACE"," ",34],"{",["T_WHITESPACE","\n            ",34],["T_VARIABLE","$param",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","requestTransactionStart",35],"(",")",";",["T_WHITESPACE","\n        ",35],"}",["T_WHITESPACE","\n    ",36],"}",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * Handler for 'endTestTransactionRequest' event\n     *\n     * @param \\PHPUnit_Framework_TestCase $test\n     * @param \\Magento\\TestFramework\\Event\\Param\\Transaction $param\n     *\/",39],["T_WHITESPACE","\n    ",44],["T_PUBLIC","public",45],["T_WHITESPACE"," ",45],["T_FUNCTION","function",45],["T_WHITESPACE"," ",45],["T_STRING","endTestTransactionRequest",45],"(",["T_WHITESPACE","\n        ",45],["T_NS_SEPARATOR","\\",46],["T_STRING","PHPUnit_Framework_TestCase",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$test",46],",",["T_WHITESPACE","\n        ",46],["T_NS_SEPARATOR","\\",47],["T_STRING","Magento",47],["T_NS_SEPARATOR","\\",47],["T_STRING","TestFramework",47],["T_NS_SEPARATOR","\\",47],["T_STRING","Event",47],["T_NS_SEPARATOR","\\",47],["T_STRING","Param",47],["T_NS_SEPARATOR","\\",47],["T_STRING","Transaction",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$param",47],["T_WHITESPACE","\n    ",47],")",["T_WHITESPACE"," ",48],"{",["T_WHITESPACE","\n        ",48],["T_IF","if",49],["T_WHITESPACE"," ",49],"(",["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","_isIsolationActive",49],["T_WHITESPACE"," ",49],["T_BOOLEAN_AND","&&",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","_getIsolation",49],"(",["T_VARIABLE","$test",49],")",")",["T_WHITESPACE"," ",49],"{",["T_WHITESPACE","\n            ",49],["T_VARIABLE","$param",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","requestTransactionRollback",50],"(",")",";",["T_WHITESPACE","\n        ",50],"}",["T_WHITESPACE","\n    ",51],"}",["T_WHITESPACE","\n\n    ",52],["T_DOC_COMMENT","\/**\n     * Handler for 'startTransaction' event\n     *\n     * @param \\PHPUnit_Framework_TestCase $test\n     *\n     * @SuppressWarnings(PHPMD.UnusedFormalParameter)\n     *\/",54],["T_WHITESPACE","\n    ",60],["T_PUBLIC","public",61],["T_WHITESPACE"," ",61],["T_FUNCTION","function",61],["T_WHITESPACE"," ",61],["T_STRING","startTransaction",61],"(",["T_NS_SEPARATOR","\\",61],["T_STRING","PHPUnit_Framework_TestCase",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$test",61],")",["T_WHITESPACE","\n    ",61],"{",["T_WHITESPACE","\n        ",62],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","_isIsolationActive",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_STRING","true",63],";",["T_WHITESPACE","\n    ",63],"}",["T_WHITESPACE","\n\n    ",64],["T_DOC_COMMENT","\/**\n     * Handler for 'rollbackTransaction' event\n     *\/",66],["T_WHITESPACE","\n    ",68],["T_PUBLIC","public",69],["T_WHITESPACE"," ",69],["T_FUNCTION","function",69],["T_WHITESPACE"," ",69],["T_STRING","rollbackTransaction",69],"(",")",["T_WHITESPACE","\n    ",69],"{",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","_isIsolationActive",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_STRING","false",71],";",["T_WHITESPACE","\n    ",71],"}",["T_WHITESPACE","\n\n    ",72],["T_DOC_COMMENT","\/**\n     * Retrieve database isolation annotation value for the current scope.\n     * Possible results:\n     *   NULL  - annotation is not defined\n     *   TRUE  - annotation is defined as 'enabled'\n     *   FALSE - annotation is defined as 'disabled'\n     *\n     * @param \\PHPUnit_Framework_TestCase $test\n     * @return bool|null Returns NULL, if isolation is not defined for the current scope\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     *\/",74],["T_WHITESPACE","\n    ",84],["T_PROTECTED","protected",85],["T_WHITESPACE"," ",85],["T_FUNCTION","function",85],["T_WHITESPACE"," ",85],["T_STRING","_getIsolation",85],"(",["T_NS_SEPARATOR","\\",85],["T_STRING","PHPUnit_Framework_TestCase",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$test",85],")",["T_WHITESPACE","\n    ",85],"{",["T_WHITESPACE","\n        ",86],["T_VARIABLE","$annotations",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getAnnotations",87],"(",["T_VARIABLE","$test",87],")",";",["T_WHITESPACE","\n        ",87],["T_IF","if",88],["T_WHITESPACE"," ",88],"(",["T_ISSET","isset",88],"(",["T_VARIABLE","$annotations",88],"[",["T_STRING","self",88],["T_DOUBLE_COLON","::",88],["T_STRING","MAGENTO_DB_ISOLATION",88],"]",")",")",["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n            ",88],["T_VARIABLE","$isolation",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$annotations",89],"[",["T_STRING","self",89],["T_DOUBLE_COLON","::",89],["T_STRING","MAGENTO_DB_ISOLATION",89],"]",";",["T_WHITESPACE","\n            ",89],["T_IF","if",90],["T_WHITESPACE"," ",90],"(",["T_VARIABLE","$isolation",90],["T_WHITESPACE"," ",90],["T_IS_NOT_IDENTICAL","!==",90],["T_WHITESPACE"," ",90],"[",["T_CONSTANT_ENCAPSED_STRING","'enabled'",90],"]",["T_WHITESPACE"," ",90],["T_BOOLEAN_AND","&&",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$isolation",90],["T_WHITESPACE"," ",90],["T_IS_NOT_IDENTICAL","!==",90],["T_WHITESPACE"," ",90],"[",["T_CONSTANT_ENCAPSED_STRING","'disabled'",90],"]",")",["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n                ",90],["T_THROW","throw",91],["T_WHITESPACE"," ",91],["T_NEW","new",91],["T_WHITESPACE"," ",91],["T_NS_SEPARATOR","\\",91],["T_STRING","Magento",91],["T_NS_SEPARATOR","\\",91],["T_STRING","Framework",91],["T_NS_SEPARATOR","\\",91],["T_STRING","Exception",91],["T_NS_SEPARATOR","\\",91],["T_STRING","LocalizedException",91],"(",["T_WHITESPACE","\n                    ",91],["T_STRING","__",92],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid \"@magentoDbIsolation\" annotation, can be \"enabled\" or \"disabled\" only.'",92],")",["T_WHITESPACE","\n                ",92],")",";",["T_WHITESPACE","\n            ",93],"}",["T_WHITESPACE","\n            ",94],["T_RETURN","return",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$isolation",95],["T_WHITESPACE"," ",95],["T_IS_IDENTICAL","===",95],["T_WHITESPACE"," ",95],"[",["T_CONSTANT_ENCAPSED_STRING","'enabled'",95],"]",";",["T_WHITESPACE","\n        ",95],"}",["T_WHITESPACE","\n        ",96],["T_RETURN","return",97],["T_WHITESPACE"," ",97],["T_STRING","null",97],";",["T_WHITESPACE","\n    ",97],"}",["T_WHITESPACE","\n\n    ",98],["T_DOC_COMMENT","\/**\n     * @param \\PHPUnit_Framework_TestCase $test\n     * @return array\n     *\/",100],["T_WHITESPACE","\n    ",103],["T_PRIVATE","private",104],["T_WHITESPACE"," ",104],["T_FUNCTION","function",104],["T_WHITESPACE"," ",104],["T_STRING","getAnnotations",104],"(",["T_NS_SEPARATOR","\\",104],["T_STRING","PHPUnit_Framework_TestCase",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$test",104],")",["T_WHITESPACE","\n    ",104],"{",["T_WHITESPACE","\n        ",105],["T_VARIABLE","$annotations",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_VARIABLE","$test",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","getAnnotations",106],"(",")",";",["T_WHITESPACE","\n        ",106],["T_RETURN","return",107],["T_WHITESPACE"," ",107],["T_STRING","array_replace",107],"(",["T_VARIABLE","$annotations",107],"[",["T_CONSTANT_ENCAPSED_STRING","'class'",107],"]",",",["T_WHITESPACE"," ",107],["T_VARIABLE","$annotations",107],"[",["T_CONSTANT_ENCAPSED_STRING","'method'",107],"]",")",";",["T_WHITESPACE","\n    ",107],"}",["T_WHITESPACE","\n",108],"}",["T_WHITESPACE","\n",109]]