[["T_OPEN_TAG","<?php\r\n",1],["T_DOC_COMMENT","\/**\r\n * Rule for searching php file dependency\r\n *\r\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\r\n * See COPYING.txt for license details.\r\n *\/",2],["T_WHITESPACE","\r\n",7],["T_NAMESPACE","namespace",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","TestFramework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Dependency",8],";",["T_WHITESPACE","\r\n\r\n",8],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","DOMDocument",10],";",["T_WHITESPACE","\r\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","DOMXPath",11],";",["T_WHITESPACE","\r\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Framework",12],["T_NS_SEPARATOR","\\",12],["T_STRING","App",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Utility",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Files",12],";",["T_WHITESPACE","\r\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","TestFramework",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Dependency",13],["T_NS_SEPARATOR","\\",13],["T_STRING","VirtualType",13],["T_NS_SEPARATOR","\\",13],["T_STRING","VirtualTypeMapper",13],";",["T_WHITESPACE","\r\n\r\n",13],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","DiRule",15],["T_WHITESPACE"," ",15],["T_IMPLEMENTS","implements",15],["T_WHITESPACE"," ",15],["T_STRING","RuleInterface",15],["T_WHITESPACE","\r\n",15],"{",["T_WHITESPACE","\r\n    ",16],["T_DOC_COMMENT","\/**\r\n     * @var VirtualTypeMapper\r\n     *\/",17],["T_WHITESPACE","\r\n    ",19],["T_PRIVATE","private",20],["T_WHITESPACE"," ",20],["T_VARIABLE","$mapper",20],";",["T_WHITESPACE","\r\n\r\n    ",20],["T_DOC_COMMENT","\/**\r\n     * @var string\r\n     *\/",22],["T_WHITESPACE","\r\n    ",24],["T_PRIVATE","private",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$pattern",25],";",["T_WHITESPACE","\r\n\r\n    ",25],["T_DOC_COMMENT","\/**\r\n     * @param VirtualTypeMapper $mapper\r\n     *\/",27],["T_WHITESPACE","\r\n    ",29],["T_PUBLIC","public",30],["T_WHITESPACE"," ",30],["T_FUNCTION","function",30],["T_WHITESPACE"," ",30],["T_STRING","__construct",30],"(",["T_STRING","VirtualTypeMapper",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$mapper",30],")",["T_WHITESPACE","\r\n    ",30],"{",["T_WHITESPACE","\r\n        ",31],["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","mapper",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_VARIABLE","$mapper",32],";",["T_WHITESPACE","\r\n    ",32],"}",["T_WHITESPACE","\r\n\r\n    ",33],["T_DOC_COMMENT","\/**\r\n     * @return string\r\n     * @throws \\Exception\r\n     *\/",35],["T_WHITESPACE","\r\n    ",38],["T_PRIVATE","private",39],["T_WHITESPACE"," ",39],["T_FUNCTION","function",39],["T_WHITESPACE"," ",39],["T_STRING","getPattern",39],"(",")",["T_WHITESPACE","\r\n    ",39],"{",["T_WHITESPACE","\r\n        ",40],["T_IF","if",41],["T_WHITESPACE"," ",41],"(",["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","pattern",41],["T_WHITESPACE"," ",41],["T_IS_IDENTICAL","===",41],["T_WHITESPACE"," ",41],["T_STRING","null",41],")",["T_WHITESPACE"," ",41],"{",["T_WHITESPACE","\r\n            ",41],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","pattern",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'~\\b(?<class>(?<module>('",42],["T_WHITESPACE","\r\n                ",42],".",["T_WHITESPACE"," ",43],["T_STRING","implode",43],"(",["T_CONSTANT_ENCAPSED_STRING","'_|'",43],",",["T_WHITESPACE"," ",43],["T_STRING","Files",43],["T_DOUBLE_COLON","::",43],["T_STRING","init",43],"(",")",["T_OBJECT_OPERATOR","->",43],["T_STRING","getNamespaces",43],"(",")",")",["T_WHITESPACE","\r\n                ",43],".",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'[_\\\\\\\\])[a-zA-Z0-9]+)[a-zA-Z0-9_\\\\\\\\]*)\\b~'",44],";",["T_WHITESPACE","\r\n        ",44],"}",["T_WHITESPACE","\r\n\r\n        ",45],["T_RETURN","return",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","pattern",47],";",["T_WHITESPACE","\r\n    ",47],"}",["T_WHITESPACE","\r\n\r\n    ",48],["T_DOC_COMMENT","\/**\r\n     * @var array\r\n     *\/",50],["T_WHITESPACE","\r\n    ",52],["T_PRIVATE","private",53],["T_WHITESPACE"," ",53],["T_STATIC","static",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$tagNameMap",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],"[",["T_WHITESPACE","\r\n        ",53],["T_CONSTANT_ENCAPSED_STRING","'type'",54],["T_WHITESPACE"," ",54],["T_DOUBLE_ARROW","=>",54],["T_WHITESPACE"," ",54],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",54],"]",",",["T_WHITESPACE","\r\n        ",54],["T_CONSTANT_ENCAPSED_STRING","'preference'",55],["T_WHITESPACE"," ",55],["T_DOUBLE_ARROW","=>",55],["T_WHITESPACE"," ",55],"[",["T_WHITESPACE","\r\n            ",55],["T_CONSTANT_ENCAPSED_STRING","'type'",56],",",["T_WHITESPACE","\r\n            ",56],["T_CONSTANT_ENCAPSED_STRING","'for'",57],["T_WHITESPACE","\r\n        ",57],"]",",",["T_WHITESPACE","\r\n        ",58],["T_CONSTANT_ENCAPSED_STRING","'plugin'",59],["T_WHITESPACE"," ",59],["T_DOUBLE_ARROW","=>",59],["T_WHITESPACE"," ",59],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",59],"]",",",["T_WHITESPACE","\r\n        ",59],["T_CONSTANT_ENCAPSED_STRING","'virtualType'",60],["T_WHITESPACE"," ",60],["T_DOUBLE_ARROW","=>",60],["T_WHITESPACE"," ",60],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",60],"]",["T_WHITESPACE","\r\n    ",60],"]",";",["T_WHITESPACE","\r\n\r\n    ",61],["T_DOC_COMMENT","\/**\r\n     * Gets alien dependencies information for current module by analyzing file's contents\r\n     *\r\n     * @param string $currentModule\r\n     * @param string $fileType\r\n     * @param string $file\r\n     * @param string $contents\r\n     * @return array\r\n     * @throws \\Exception\r\n     *\/",63],["T_WHITESPACE","\r\n    ",72],["T_PUBLIC","public",73],["T_WHITESPACE"," ",73],["T_FUNCTION","function",73],["T_WHITESPACE"," ",73],["T_STRING","getDependencyInfo",73],"(",["T_VARIABLE","$currentModule",73],",",["T_WHITESPACE"," ",73],["T_VARIABLE","$fileType",73],",",["T_WHITESPACE"," ",73],["T_VARIABLE","$file",73],",",["T_WHITESPACE"," ",73],"&",["T_VARIABLE","$contents",73],")",["T_WHITESPACE","\r\n    ",73],"{",["T_WHITESPACE","\r\n        ",74],["T_IF","if",75],["T_WHITESPACE"," ",75],"(",["T_STRING","pathinfo",75],"(",["T_VARIABLE","$file",75],",",["T_WHITESPACE"," ",75],["T_STRING","PATHINFO_BASENAME",75],")",["T_WHITESPACE"," ",75],["T_IS_NOT_IDENTICAL","!==",75],["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'di.xml'",75],")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\r\n            ",75],["T_RETURN","return",76],["T_WHITESPACE"," ",76],"[","]",";",["T_WHITESPACE","\r\n        ",76],"}",["T_WHITESPACE","\r\n\r\n        ",77],["T_VARIABLE","$dependenciesInfo",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],"[","]",";",["T_WHITESPACE","\r\n        ",79],["T_VARIABLE","$scope",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","mapper",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getScopeFromFile",80],"(",["T_VARIABLE","$file",80],")",";",["T_WHITESPACE","\r\n        ",80],["T_FOREACH","foreach",81],["T_WHITESPACE"," ",81],"(",["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","fetchPossibleDependencies",81],"(",["T_VARIABLE","$contents",81],")",["T_WHITESPACE"," ",81],["T_AS","as",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$type",81],["T_WHITESPACE"," ",81],["T_DOUBLE_ARROW","=>",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$deps",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\r\n            ",81],["T_FOREACH","foreach",82],["T_WHITESPACE"," ",82],"(",["T_VARIABLE","$deps",82],["T_WHITESPACE"," ",82],["T_AS","as",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$dep",82],")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\r\n                ",82],["T_VARIABLE","$dep",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","mapper",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","getType",83],"(",["T_VARIABLE","$dep",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$scope",83],")",";",["T_WHITESPACE","\r\n\r\n                ",83],["T_IF","if",85],["T_WHITESPACE"," ",85],"(",["T_STRING","preg_match",85],"(",["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","getPattern",85],"(",")",",",["T_WHITESPACE"," ",85],["T_VARIABLE","$dep",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$matches",85],")",")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\r\n                    ",85],["T_VARIABLE","$referenceModule",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_STRING","str_replace",86],"(",["T_CONSTANT_ENCAPSED_STRING","'_'",86],",",["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","'\\\\'",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$matches",86],"[",["T_CONSTANT_ENCAPSED_STRING","'module'",86],"]",")",";",["T_WHITESPACE","\r\n                    ",86],["T_IF","if",87],["T_WHITESPACE"," ",87],"(",["T_VARIABLE","$currentModule",87],["T_WHITESPACE"," ",87],["T_IS_IDENTICAL","===",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$referenceModule",87],")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\r\n                        ",87],["T_CONTINUE","continue",88],";",["T_WHITESPACE","\r\n                    ",88],"}",["T_WHITESPACE","\r\n                    ",89],["T_VARIABLE","$dependenciesInfo",90],"[","]",["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],"[",["T_WHITESPACE","\r\n                        ",90],["T_CONSTANT_ENCAPSED_STRING","'module'",91],["T_WHITESPACE"," ",91],["T_DOUBLE_ARROW","=>",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$referenceModule",91],",",["T_WHITESPACE","\r\n                        ",91],["T_CONSTANT_ENCAPSED_STRING","'type'",92],["T_WHITESPACE"," ",92],["T_DOUBLE_ARROW","=>",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$type",92],",",["T_WHITESPACE","\r\n                        ",92],["T_CONSTANT_ENCAPSED_STRING","'source'",93],["T_WHITESPACE"," ",93],["T_DOUBLE_ARROW","=>",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$matches",93],"[",["T_CONSTANT_ENCAPSED_STRING","'class'",93],"]",",",["T_WHITESPACE","\r\n                    ",93],"]",";",["T_WHITESPACE","\r\n                ",94],"}",["T_WHITESPACE","\r\n            ",95],"}",["T_WHITESPACE","\r\n        ",96],"}",["T_WHITESPACE","\r\n        ",97],["T_RETURN","return",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$dependenciesInfo",98],";",["T_WHITESPACE","\r\n    ",98],"}",["T_WHITESPACE","\r\n\r\n    ",99],["T_DOC_COMMENT","\/**\r\n     * @param string $contents\r\n     * @return array\r\n     *\/",101],["T_WHITESPACE","\r\n    ",104],["T_PRIVATE","private",105],["T_WHITESPACE"," ",105],["T_FUNCTION","function",105],["T_WHITESPACE"," ",105],["T_STRING","fetchPossibleDependencies",105],"(",["T_VARIABLE","$contents",105],")",["T_WHITESPACE","\r\n    ",105],"{",["T_WHITESPACE","\r\n        ",106],["T_VARIABLE","$doc",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_NEW","new",107],["T_WHITESPACE"," ",107],["T_STRING","DOMDocument",107],"(",")",";",["T_WHITESPACE","\r\n        ",107],["T_VARIABLE","$doc",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","loadXML",108],"(",["T_VARIABLE","$contents",108],")",";",["T_WHITESPACE","\r\n\r\n        ",108],["T_RETURN","return",110],["T_WHITESPACE"," ",110],"[",["T_WHITESPACE","\r\n            ",110],["T_STRING","RuleInterface",111],["T_DOUBLE_COLON","::",111],["T_STRING","TYPE_SOFT",111],["T_WHITESPACE"," ",111],["T_DOUBLE_ARROW","=>",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","getSoftDependencies",111],"(",["T_VARIABLE","$doc",111],")",",",["T_WHITESPACE","\r\n            ",111],["T_STRING","RuleInterface",112],["T_DOUBLE_COLON","::",112],["T_STRING","TYPE_HARD",112],["T_WHITESPACE"," ",112],["T_DOUBLE_ARROW","=>",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","getHardDependencies",112],"(",["T_VARIABLE","$doc",112],")",["T_WHITESPACE","\r\n        ",112],"]",";",["T_WHITESPACE","\r\n    ",113],"}",["T_WHITESPACE","\r\n\r\n    ",114],["T_DOC_COMMENT","\/**\r\n     * @param DOMDocument $doc\r\n     * @return array\r\n     *\/",116],["T_WHITESPACE","\r\n    ",119],["T_PRIVATE","private",120],["T_WHITESPACE"," ",120],["T_FUNCTION","function",120],["T_WHITESPACE"," ",120],["T_STRING","getSoftDependencies",120],"(",["T_STRING","DOMDocument",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$doc",120],")",["T_WHITESPACE","\r\n    ",120],"{",["T_WHITESPACE","\r\n        ",121],["T_VARIABLE","$result",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],"[","]",";",["T_WHITESPACE","\r\n        ",122],["T_FOREACH","foreach",123],["T_WHITESPACE"," ",123],"(",["T_STRING","self",123],["T_DOUBLE_COLON","::",123],["T_VARIABLE","$tagNameMap",123],["T_WHITESPACE"," ",123],["T_AS","as",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$tagName",123],["T_WHITESPACE"," ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$attributeNames",123],")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\r\n            ",123],["T_VARIABLE","$nodes",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$doc",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","getElementsByTagName",124],"(",["T_VARIABLE","$tagName",124],")",";",["T_WHITESPACE","\r\n            ",124],["T_DOC_COMMENT","\/** @var \\DOMElement $node *\/",125],["T_WHITESPACE","\r\n            ",125],["T_FOREACH","foreach",126],["T_WHITESPACE"," ",126],"(",["T_VARIABLE","$nodes",126],["T_WHITESPACE"," ",126],["T_AS","as",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$node",126],")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\r\n                ",126],["T_FOREACH","foreach",127],["T_WHITESPACE"," ",127],"(",["T_VARIABLE","$attributeNames",127],["T_WHITESPACE"," ",127],["T_AS","as",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$attributeName",127],")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\r\n                    ",127],["T_VARIABLE","$result",128],"[","]",["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_VARIABLE","$node",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","getAttribute",128],"(",["T_VARIABLE","$attributeName",128],")",";",["T_WHITESPACE","\r\n                ",128],"}",["T_WHITESPACE","\r\n            ",129],"}",["T_WHITESPACE","\r\n        ",130],"}",["T_WHITESPACE","\r\n\r\n        ",131],["T_RETURN","return",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$result",133],";",["T_WHITESPACE","\r\n    ",133],"}",["T_WHITESPACE","\r\n\r\n    ",134],["T_DOC_COMMENT","\/**\r\n     * @param DOMDocument $doc\r\n     * @return array\r\n     *\/",136],["T_WHITESPACE","\r\n    ",139],["T_PRIVATE","private",140],["T_WHITESPACE"," ",140],["T_FUNCTION","function",140],["T_WHITESPACE"," ",140],["T_STRING","getHardDependencies",140],"(",["T_STRING","DOMDocument",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$doc",140],")",["T_WHITESPACE","\r\n    ",140],"{",["T_WHITESPACE","\r\n        ",141],["T_VARIABLE","$result",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],"[","]",";",["T_WHITESPACE","\r\n        ",142],["T_VARIABLE","$xpath",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_NEW","new",143],["T_WHITESPACE"," ",143],["T_STRING","DOMXPath",143],"(",["T_VARIABLE","$doc",143],")",";",["T_WHITESPACE","\r\n        ",143],["T_VARIABLE","$textNodes",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_VARIABLE","$xpath",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","query",144],"(",["T_CONSTANT_ENCAPSED_STRING","'\/\/*[@xsi:type=\"object\"]'",144],")",";",["T_WHITESPACE","\r\n        ",144],["T_DOC_COMMENT","\/** @var \\DOMElement $node *\/",145],["T_WHITESPACE","\r\n        ",145],["T_FOREACH","foreach",146],["T_WHITESPACE"," ",146],"(",["T_VARIABLE","$textNodes",146],["T_WHITESPACE"," ",146],["T_AS","as",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$node",146],")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\r\n            ",146],["T_VARIABLE","$result",147],"[","]",["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_VARIABLE","$node",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","nodeValue",147],";",["T_WHITESPACE","\r\n        ",147],"}",["T_WHITESPACE","\r\n\r\n        ",148],["T_RETURN","return",150],["T_WHITESPACE"," ",150],["T_VARIABLE","$result",150],";",["T_WHITESPACE","\r\n    ",150],"}",["T_WHITESPACE","\r\n",151],"}",["T_WHITESPACE","\r\n",152]]