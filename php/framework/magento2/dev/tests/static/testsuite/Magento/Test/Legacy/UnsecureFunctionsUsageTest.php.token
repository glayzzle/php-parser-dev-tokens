[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Test",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Legacy",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","App",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Utility",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Files",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Component",9],["T_NS_SEPARATOR","\\",9],["T_STRING","ComponentRegistrar",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","TestFramework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Utility",10],["T_NS_SEPARATOR","\\",10],["T_STRING","FunctionDetector",10],";",["T_WHITESPACE","\n\n",10],["T_DOC_COMMENT","\/**\n * Tests to detect unsecure functions usage\n *\/",12],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","UnsecureFunctionsUsageTest",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_NS_SEPARATOR","\\",15],["T_STRING","PHPUnit_Framework_TestCase",15],["T_WHITESPACE","\n",15],"{",["T_WHITESPACE","\n    ",16],["T_DOC_COMMENT","\/**\n     * Php unsecure functions\n     *\n     * @var array\n     *\/",17],["T_WHITESPACE","\n    ",21],["T_PRIVATE","private",22],["T_WHITESPACE"," ",22],["T_STATIC","static",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$phpUnsecureFunctions",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],"[","]",";",["T_WHITESPACE","\n\n    ",22],["T_DOC_COMMENT","\/**\n     * JS unsecure functions\n     *\n     * @var array\n     *\/",24],["T_WHITESPACE","\n    ",28],["T_PRIVATE","private",29],["T_WHITESPACE"," ",29],["T_STATIC","static",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$jsUnsecureFunctions",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],"[","]",";",["T_WHITESPACE","\n\n    ",29],["T_DOC_COMMENT","\/**\n     * File extensions pattern to search for\n     *\n     * @var string\n     *\/",31],["T_WHITESPACE","\n    ",35],["T_PRIVATE","private",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$fileExtensions",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'\/\\.(php|phtml|js)$\/'",36],";",["T_WHITESPACE","\n\n    ",36],["T_DOC_COMMENT","\/**\n     * Read fixtures into memory as arrays\n     *\n     * @return void\n     *\/",38],["T_WHITESPACE","\n    ",42],["T_PUBLIC","public",43],["T_WHITESPACE"," ",43],["T_STATIC","static",43],["T_WHITESPACE"," ",43],["T_FUNCTION","function",43],["T_WHITESPACE"," ",43],["T_STRING","setUpBeforeClass",43],"(",")",["T_WHITESPACE","\n    ",43],"{",["T_WHITESPACE","\n        ",44],["T_STRING","self",45],["T_DOUBLE_COLON","::",45],["T_STRING","loadData",45],"(",["T_STRING","self",45],["T_DOUBLE_COLON","::",45],["T_VARIABLE","$phpUnsecureFunctions",45],",",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'unsecure_php_functions*.php'",45],")",";",["T_WHITESPACE","\n        ",45],["T_STRING","self",46],["T_DOUBLE_COLON","::",46],["T_STRING","loadData",46],"(",["T_STRING","self",46],["T_DOUBLE_COLON","::",46],["T_VARIABLE","$jsUnsecureFunctions",46],",",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'unsecure_js_functions*.php'",46],")",";",["T_WHITESPACE","\n    ",46],"}",["T_WHITESPACE","\n\n    ",47],["T_DOC_COMMENT","\/**\n     * Loads and merges data from fixtures\n     *\n     * @param array $data\n     * @param string $filePattern\n     * @return void\n     *\/",49],["T_WHITESPACE","\n    ",55],["T_PRIVATE","private",56],["T_WHITESPACE"," ",56],["T_STATIC","static",56],["T_WHITESPACE"," ",56],["T_FUNCTION","function",56],["T_WHITESPACE"," ",56],["T_STRING","loadData",56],"(",["T_ARRAY","array",56],["T_WHITESPACE"," ",56],"&",["T_VARIABLE","$data",56],",",["T_WHITESPACE"," ",56],["T_VARIABLE","$filePattern",56],")",["T_WHITESPACE","\n    ",56],"{",["T_WHITESPACE","\n        ",57],["T_FOREACH","foreach",58],["T_WHITESPACE"," ",58],"(",["T_STRING","glob",58],"(",["T_DIR","__DIR__",58],["T_WHITESPACE"," ",58],".",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'\/_files\/security\/'",58],["T_WHITESPACE"," ",58],".",["T_WHITESPACE"," ",58],["T_VARIABLE","$filePattern",58],")",["T_WHITESPACE"," ",58],["T_AS","as",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$file",58],")",["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n            ",58],["T_VARIABLE","$data",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_STRING","array_merge_recursive",59],"(",["T_VARIABLE","$data",59],",",["T_WHITESPACE"," ",59],["T_STRING","self",59],["T_DOUBLE_COLON","::",59],["T_STRING","readList",59],"(",["T_VARIABLE","$file",59],")",")",";",["T_WHITESPACE","\n        ",59],"}",["T_WHITESPACE","\n        ",60],["T_VARIABLE","$componentRegistrar",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_NEW","new",61],["T_WHITESPACE"," ",61],["T_STRING","ComponentRegistrar",61],"(",")",";",["T_WHITESPACE","\n        ",61],["T_FOREACH","foreach",62],["T_WHITESPACE"," ",62],"(",["T_VARIABLE","$data",62],["T_WHITESPACE"," ",62],["T_AS","as",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$key",62],["T_WHITESPACE"," ",62],["T_DOUBLE_ARROW","=>",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$value",62],")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n            ",62],["T_VARIABLE","$excludes",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_VARIABLE","$value",63],"[",["T_CONSTANT_ENCAPSED_STRING","'exclude'",63],"]",";",["T_WHITESPACE","\n            ",63],["T_VARIABLE","$excludePaths",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],"[","]",";",["T_WHITESPACE","\n            ",64],["T_FOREACH","foreach",65],["T_WHITESPACE"," ",65],"(",["T_VARIABLE","$excludes",65],["T_WHITESPACE"," ",65],["T_AS","as",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$exclude",65],")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n                ",65],["T_IF","if",66],["T_WHITESPACE"," ",66],"(",["T_CONSTANT_ENCAPSED_STRING","'setup'",66],["T_WHITESPACE"," ",66],["T_IS_EQUAL","==",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$exclude",66],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",66],"]",")",["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n                    ",66],["T_VARIABLE","$excludePaths",67],"[","]",["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_STRING","BP",67],["T_WHITESPACE"," ",67],".",["T_WHITESPACE"," ",67],["T_CONSTANT_ENCAPSED_STRING","'\/setup\/'",67],["T_WHITESPACE"," ",67],".",["T_WHITESPACE"," ",67],["T_VARIABLE","$exclude",67],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",67],"]",";",["T_WHITESPACE","\n                ",67],"}",["T_WHITESPACE"," ",68],["T_ELSE","else",68],["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n                    ",68],["T_VARIABLE","$excludePaths",69],"[","]",["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_VARIABLE","$componentRegistrar",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getPath",69],"(",["T_VARIABLE","$exclude",69],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",69],"]",",",["T_WHITESPACE"," ",69],["T_VARIABLE","$exclude",69],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",69],"]",")",["T_WHITESPACE","\n                        ",69],".",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'\/'",70],["T_WHITESPACE"," ",70],".",["T_WHITESPACE"," ",70],["T_VARIABLE","$exclude",70],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",70],"]",";",["T_WHITESPACE","\n                ",70],"}",["T_WHITESPACE","\n            ",71],"}",["T_WHITESPACE","\n            ",72],["T_VARIABLE","$data",73],"[",["T_VARIABLE","$key",73],"]","[",["T_CONSTANT_ENCAPSED_STRING","'exclude'",73],"]",["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$excludePaths",73],";",["T_WHITESPACE","\n        ",73],"}",["T_WHITESPACE","\n    ",74],"}",["T_WHITESPACE","\n\n    ",75],["T_DOC_COMMENT","\/**\n     * Isolate including a file into a method to reduce scope\n     *\n     * @param string $file\n     * @return array\n     *\/",77],["T_WHITESPACE","\n    ",82],["T_PRIVATE","private",83],["T_WHITESPACE"," ",83],["T_STATIC","static",83],["T_WHITESPACE"," ",83],["T_FUNCTION","function",83],["T_WHITESPACE"," ",83],["T_STRING","readList",83],"(",["T_VARIABLE","$file",83],")",["T_WHITESPACE","\n    ",83],"{",["T_WHITESPACE","\n        ",84],["T_RETURN","return",85],["T_WHITESPACE"," ",85],["T_INCLUDE","include",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$file",85],";",["T_WHITESPACE","\n    ",85],"}",["T_WHITESPACE","\n\n    ",86],["T_DOC_COMMENT","\/**\n     * Detect unsecure functions usage for changed files in whitelist with the exception of blacklist\n     *\n     * @return void\n     *\/",88],["T_WHITESPACE","\n    ",92],["T_PUBLIC","public",93],["T_WHITESPACE"," ",93],["T_FUNCTION","function",93],["T_WHITESPACE"," ",93],["T_STRING","testUnsecureFunctionsUsage",93],"(",")",["T_WHITESPACE","\n    ",93],"{",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$invoker",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_NEW","new",95],["T_WHITESPACE"," ",95],["T_NS_SEPARATOR","\\",95],["T_STRING","Magento",95],["T_NS_SEPARATOR","\\",95],["T_STRING","Framework",95],["T_NS_SEPARATOR","\\",95],["T_STRING","App",95],["T_NS_SEPARATOR","\\",95],["T_STRING","Utility",95],["T_NS_SEPARATOR","\\",95],["T_STRING","AggregateInvoker",95],"(",["T_VARIABLE","$this",95],")",";",["T_WHITESPACE","\n        ",95],["T_VARIABLE","$functionDetector",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_NEW","new",96],["T_WHITESPACE"," ",96],["T_STRING","FunctionDetector",96],"(",")",";",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$invoker",97],"(",["T_WHITESPACE","\n            ",97],["T_FUNCTION","function",98],["T_WHITESPACE"," ",98],"(",["T_VARIABLE","$fileFullPath",98],")",["T_WHITESPACE"," ",98],["T_USE","use",98],["T_WHITESPACE"," ",98],"(",["T_VARIABLE","$functionDetector",98],")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n                ",98],["T_VARIABLE","$functions",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","getFunctions",99],"(",["T_VARIABLE","$fileFullPath",99],")",";",["T_WHITESPACE","\n                ",99],["T_VARIABLE","$lines",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$functionDetector",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","detect",100],"(",["T_VARIABLE","$fileFullPath",100],",",["T_WHITESPACE"," ",100],["T_STRING","array_keys",100],"(",["T_VARIABLE","$functions",100],")",")",";",["T_WHITESPACE","\n\n                ",100],["T_VARIABLE","$message",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","''",102],";",["T_WHITESPACE","\n                ",102],["T_IF","if",103],["T_WHITESPACE"," ",103],"(","!",["T_EMPTY","empty",103],"(",["T_VARIABLE","$lines",103],")",")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n                    ",103],["T_VARIABLE","$message",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","composeMessage",104],"(",["T_VARIABLE","$fileFullPath",104],",",["T_WHITESPACE"," ",104],["T_VARIABLE","$lines",104],",",["T_WHITESPACE"," ",104],["T_VARIABLE","$functions",104],")",";",["T_WHITESPACE","\n                ",104],"}",["T_WHITESPACE","\n                ",105],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","assertEmpty",106],"(",["T_WHITESPACE","\n                    ",106],["T_VARIABLE","$lines",107],",",["T_WHITESPACE","\n                    ",107],["T_VARIABLE","$message",108],["T_WHITESPACE","\n                ",108],")",";",["T_WHITESPACE","\n            ",109],"}",",",["T_WHITESPACE","\n            ",110],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","getFilesToVerify",111],"(",")",["T_WHITESPACE","\n        ",111],")",";",["T_WHITESPACE","\n    ",112],"}",["T_WHITESPACE","\n\n    ",113],["T_DOC_COMMENT","\/**\n     * Compose message\n     *\n     * @param string $fileFullPath\n     * @param array $lines\n     * @param array $functionRules\n     * @return string\n     *\/",115],["T_WHITESPACE","\n    ",122],["T_PRIVATE","private",123],["T_WHITESPACE"," ",123],["T_FUNCTION","function",123],["T_WHITESPACE"," ",123],["T_STRING","composeMessage",123],"(",["T_VARIABLE","$fileFullPath",123],",",["T_WHITESPACE"," ",123],["T_VARIABLE","$lines",123],",",["T_WHITESPACE"," ",123],["T_VARIABLE","$functionRules",123],")",["T_WHITESPACE","\n    ",123],"{",["T_WHITESPACE","\n        ",124],["T_VARIABLE","$result",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_CONSTANT_ENCAPSED_STRING","''",125],";",["T_WHITESPACE","\n        ",125],["T_FOREACH","foreach",126],["T_WHITESPACE"," ",126],"(",["T_VARIABLE","$lines",126],["T_WHITESPACE"," ",126],["T_AS","as",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$lineNumber",126],["T_WHITESPACE"," ",126],["T_DOUBLE_ARROW","=>",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$detectedFunctions",126],")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n            ",126],["T_VARIABLE","$detectedFunctionRules",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_STRING","array_intersect_key",127],"(",["T_VARIABLE","$functionRules",127],",",["T_WHITESPACE"," ",127],["T_STRING","array_flip",127],"(",["T_VARIABLE","$detectedFunctions",127],")",")",";",["T_WHITESPACE","\n            ",127],["T_VARIABLE","$replacementString",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","''",128],";",["T_WHITESPACE","\n            ",128],["T_FOREACH","foreach",129],["T_WHITESPACE"," ",129],"(",["T_VARIABLE","$detectedFunctionRules",129],["T_WHITESPACE"," ",129],["T_AS","as",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$function",129],["T_WHITESPACE"," ",129],["T_DOUBLE_ARROW","=>",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$functionRule",129],")",["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n                ",129],["T_VARIABLE","$replacement",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$functionRule",130],"[",["T_CONSTANT_ENCAPSED_STRING","'replacement'",130],"]",";",["T_WHITESPACE","\n                ",130],["T_IF","if",131],["T_WHITESPACE"," ",131],"(",["T_STRING","is_array",131],"(",["T_VARIABLE","$replacement",131],")",")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n                    ",131],["T_VARIABLE","$replacement",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_STRING","array_unique",132],"(",["T_VARIABLE","$replacement",132],")",";",["T_WHITESPACE","\n                    ",132],["T_VARIABLE","$replacement",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_STRING","count",133],"(",["T_VARIABLE","$replacement",133],")",["T_WHITESPACE"," ",133],">",["T_WHITESPACE"," ",133],["T_LNUMBER","1",133],["T_WHITESPACE"," ",133],"?",["T_WHITESPACE","\n                        ",133],["T_CONSTANT_ENCAPSED_STRING","\"[\\n\\t\\t\\t\"",134],["T_WHITESPACE"," ",134],".",["T_WHITESPACE"," ",134],["T_STRING","implode",134],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\n\\t\\t\\t\"",134],",",["T_WHITESPACE"," ",134],["T_VARIABLE","$replacement",134],")",["T_WHITESPACE"," ",134],".",["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","\"\\n\\t\\t]\"",134],["T_WHITESPACE"," ",134],":",["T_WHITESPACE","\n                        ",134],["T_VARIABLE","$replacement",135],"[",["T_LNUMBER","0",135],"]",";",["T_WHITESPACE","\n                ",135],"}",["T_WHITESPACE","\n                ",136],["T_VARIABLE","$replacement",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_EMPTY","empty",137],"(",["T_VARIABLE","$replacement",137],")",["T_WHITESPACE"," ",137],"?",["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'No suggested replacement at this time'",137],["T_WHITESPACE"," ",137],":",["T_WHITESPACE"," ",137],["T_VARIABLE","$replacement",137],";",["T_WHITESPACE","\n                ",137],["T_VARIABLE","$replacementString",138],["T_WHITESPACE"," ",138],["T_CONCAT_EQUAL",".=",138],["T_WHITESPACE"," ",138],"\"",["T_ENCAPSED_AND_WHITESPACE","\\t\\t'",138],["T_VARIABLE","$function",138],["T_ENCAPSED_AND_WHITESPACE","' => '",138],["T_VARIABLE","$replacement",138],["T_ENCAPSED_AND_WHITESPACE","'\\n",138],"\"",";",["T_WHITESPACE","\n            ",138],"}",["T_WHITESPACE","\n            ",139],["T_VARIABLE","$result",140],["T_WHITESPACE"," ",140],["T_CONCAT_EQUAL",".=",140],["T_WHITESPACE"," ",140],["T_STRING","sprintf",140],"(",["T_WHITESPACE","\n                ",140],["T_CONSTANT_ENCAPSED_STRING","\"Functions '%s' are not secure in %s. \\n\\tSuggested replacement:\\n%s\"",141],",",["T_WHITESPACE","\n                ",141],["T_STRING","implode",142],"(",["T_CONSTANT_ENCAPSED_STRING","', '",142],",",["T_WHITESPACE"," ",142],["T_VARIABLE","$detectedFunctions",142],")",",",["T_WHITESPACE","\n                ",142],["T_VARIABLE","$fileFullPath",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_CONSTANT_ENCAPSED_STRING","':'",143],["T_WHITESPACE"," ",143],".",["T_WHITESPACE"," ",143],["T_VARIABLE","$lineNumber",143],",",["T_WHITESPACE","\n                ",143],["T_VARIABLE","$replacementString",144],["T_WHITESPACE","\n            ",144],")",";",["T_WHITESPACE","\n        ",145],"}",["T_WHITESPACE","\n        ",146],["T_RETURN","return",147],["T_WHITESPACE"," ",147],["T_VARIABLE","$result",147],";",["T_WHITESPACE","\n    ",147],"}",["T_WHITESPACE","\n\n    ",148],["T_DOC_COMMENT","\/**\n     * Get files to be verified\n     *\n     * @return array\n     *\/",150],["T_WHITESPACE","\n    ",154],["T_PRIVATE","private",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","getFilesToVerify",155],"(",")",["T_WHITESPACE","\n    ",155],"{",["T_WHITESPACE","\n        ",156],["T_VARIABLE","$fileExtensions",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","fileExtensions",157],";",["T_WHITESPACE","\n        ",157],["T_VARIABLE","$directoriesToScan",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_STRING","Files",158],["T_DOUBLE_COLON","::",158],["T_STRING","init",158],"(",")",["T_OBJECT_OPERATOR","->",158],["T_STRING","readLists",158],"(",["T_DIR","__DIR__",158],["T_WHITESPACE"," ",158],".",["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","'\/_files\/security\/whitelist.txt'",158],")",";",["T_WHITESPACE","\n\n        ",158],["T_VARIABLE","$filesToVerify",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],"[","]",";",["T_WHITESPACE","\n        ",160],["T_FOREACH","foreach",161],["T_WHITESPACE"," ",161],"(",["T_STRING","glob",161],"(",["T_DIR","__DIR__",161],["T_WHITESPACE"," ",161],".",["T_WHITESPACE"," ",161],["T_CONSTANT_ENCAPSED_STRING","'\/..\/_files\/changed_files*'",161],")",["T_WHITESPACE"," ",161],["T_AS","as",161],["T_WHITESPACE"," ",161],["T_VARIABLE","$listFile",161],")",["T_WHITESPACE"," ",161],"{",["T_WHITESPACE","\n            ",161],["T_VARIABLE","$filesToVerify",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_STRING","array_merge",162],"(",["T_WHITESPACE","\n                ",162],["T_VARIABLE","$filesToVerify",163],",",["T_WHITESPACE","\n                ",163],["T_STRING","file",164],"(",["T_VARIABLE","$listFile",164],",",["T_WHITESPACE"," ",164],["T_STRING","FILE_IGNORE_NEW_LINES",164],["T_WHITESPACE"," ",164],"|",["T_WHITESPACE"," ",164],["T_STRING","FILE_SKIP_EMPTY_LINES",164],")",["T_WHITESPACE","\n            ",164],")",";",["T_WHITESPACE","\n        ",165],"}",["T_WHITESPACE","\n        ",166],["T_STRING","array_walk",167],"(",["T_WHITESPACE","\n            ",167],["T_VARIABLE","$filesToVerify",168],",",["T_WHITESPACE","\n            ",168],["T_FUNCTION","function",169],["T_WHITESPACE"," ",169],"(","&",["T_VARIABLE","$file",169],")",["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n                ",169],["T_VARIABLE","$file",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],"[",["T_STRING","BP",170],["T_WHITESPACE"," ",170],".",["T_WHITESPACE"," ",170],["T_CONSTANT_ENCAPSED_STRING","'\/'",170],["T_WHITESPACE"," ",170],".",["T_WHITESPACE"," ",170],["T_VARIABLE","$file",170],"]",";",["T_WHITESPACE","\n            ",170],"}",["T_WHITESPACE","\n        ",171],")",";",["T_WHITESPACE","\n        ",172],["T_VARIABLE","$filesToVerify",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_STRING","array_filter",173],"(",["T_WHITESPACE","\n            ",173],["T_VARIABLE","$filesToVerify",174],",",["T_WHITESPACE","\n            ",174],["T_FUNCTION","function",175],["T_WHITESPACE"," ",175],"(",["T_VARIABLE","$path",175],")",["T_WHITESPACE"," ",175],["T_USE","use",175],["T_WHITESPACE"," ",175],"(",["T_VARIABLE","$directoriesToScan",175],",",["T_WHITESPACE"," ",175],["T_VARIABLE","$fileExtensions",175],")",["T_WHITESPACE"," ",175],"{",["T_WHITESPACE","\n                ",175],["T_IF","if",176],["T_WHITESPACE"," ",176],"(","!",["T_STRING","file_exists",176],"(",["T_VARIABLE","$path",176],"[",["T_LNUMBER","0",176],"]",")",")",["T_WHITESPACE"," ",176],"{",["T_WHITESPACE","\n                    ",176],["T_RETURN","return",177],["T_WHITESPACE"," ",177],["T_STRING","false",177],";",["T_WHITESPACE","\n                ",177],"}",["T_WHITESPACE","\n                ",178],["T_VARIABLE","$path",179],["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_STRING","realpath",179],"(",["T_VARIABLE","$path",179],"[",["T_LNUMBER","0",179],"]",")",";",["T_WHITESPACE","\n                ",179],["T_FOREACH","foreach",180],["T_WHITESPACE"," ",180],"(",["T_VARIABLE","$directoriesToScan",180],["T_WHITESPACE"," ",180],["T_AS","as",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$directory",180],")",["T_WHITESPACE"," ",180],"{",["T_WHITESPACE","\n                    ",180],["T_VARIABLE","$directory",181],["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_STRING","realpath",181],"(",["T_VARIABLE","$directory",181],")",";",["T_WHITESPACE","\n                    ",181],["T_IF","if",182],["T_WHITESPACE"," ",182],"(",["T_STRING","strpos",182],"(",["T_VARIABLE","$path",182],",",["T_WHITESPACE"," ",182],["T_VARIABLE","$directory",182],")",["T_WHITESPACE"," ",182],["T_IS_IDENTICAL","===",182],["T_WHITESPACE"," ",182],["T_LNUMBER","0",182],")",["T_WHITESPACE"," ",182],"{",["T_WHITESPACE","\n                        ",182],["T_IF","if",183],["T_WHITESPACE"," ",183],"(",["T_STRING","preg_match",183],"(",["T_VARIABLE","$fileExtensions",183],",",["T_WHITESPACE"," ",183],["T_VARIABLE","$path",183],")",")",["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n                            ",183],["T_COMMENT","\/\/ skip unit tests\n",184],["T_WHITESPACE","                            ",185],["T_IF","if",185],["T_WHITESPACE"," ",185],"(",["T_STRING","preg_match",185],"(",["T_CONSTANT_ENCAPSED_STRING","'#'",185],["T_WHITESPACE"," ",185],".",["T_WHITESPACE"," ",185],["T_STRING","preg_quote",185],"(",["T_CONSTANT_ENCAPSED_STRING","'Test\/Unit'",185],",",["T_WHITESPACE"," ",185],["T_CONSTANT_ENCAPSED_STRING","'#'",185],")",["T_WHITESPACE"," ",185],".",["T_WHITESPACE"," ",185],["T_CONSTANT_ENCAPSED_STRING","'#'",185],",",["T_WHITESPACE"," ",185],["T_VARIABLE","$path",185],")",")",["T_WHITESPACE"," ",185],"{",["T_WHITESPACE","\n                                ",185],["T_RETURN","return",186],["T_WHITESPACE"," ",186],["T_STRING","false",186],";",["T_WHITESPACE","\n                            ",186],"}",["T_WHITESPACE","\n                            ",187],["T_RETURN","return",188],["T_WHITESPACE"," ",188],["T_STRING","true",188],";",["T_WHITESPACE","\n                        ",188],"}",["T_WHITESPACE","\n                    ",189],"}",["T_WHITESPACE","\n                ",190],"}",["T_WHITESPACE","\n                ",191],["T_RETURN","return",192],["T_WHITESPACE"," ",192],["T_STRING","false",192],";",["T_WHITESPACE","\n            ",192],"}",["T_WHITESPACE","\n        ",193],")",";",["T_WHITESPACE","\n        ",194],["T_RETURN","return",195],["T_WHITESPACE"," ",195],["T_VARIABLE","$filesToVerify",195],";",["T_WHITESPACE","\n    ",195],"}",["T_WHITESPACE","\n\n    ",196],["T_DOC_COMMENT","\/**\n     * Get functions for the given file\n     *\n     * @param string $fileFullPath\n     * @return array\n     *\/",198],["T_WHITESPACE","\n    ",203],["T_PRIVATE","private",204],["T_WHITESPACE"," ",204],["T_FUNCTION","function",204],["T_WHITESPACE"," ",204],["T_STRING","getFunctions",204],"(",["T_VARIABLE","$fileFullPath",204],")",["T_WHITESPACE","\n    ",204],"{",["T_WHITESPACE","\n        ",205],["T_VARIABLE","$fileExtension",206],["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],["T_STRING","pathinfo",206],"(",["T_VARIABLE","$fileFullPath",206],",",["T_WHITESPACE"," ",206],["T_STRING","PATHINFO_EXTENSION",206],")",";",["T_WHITESPACE","\n        ",206],["T_VARIABLE","$functions",207],["T_WHITESPACE"," ",207],"=",["T_WHITESPACE"," ",207],"[","]",";",["T_WHITESPACE","\n        ",207],["T_IF","if",208],["T_WHITESPACE"," ",208],"(",["T_VARIABLE","$fileExtension",208],["T_WHITESPACE"," ",208],["T_IS_EQUAL","==",208],["T_WHITESPACE"," ",208],["T_CONSTANT_ENCAPSED_STRING","'php'",208],")",["T_WHITESPACE"," ",208],"{",["T_WHITESPACE","\n            ",208],["T_VARIABLE","$functions",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_STRING","self",209],["T_DOUBLE_COLON","::",209],["T_VARIABLE","$phpUnsecureFunctions",209],";",["T_WHITESPACE","\n        ",209],"}",["T_WHITESPACE"," ",210],["T_ELSEIF","elseif",210],["T_WHITESPACE"," ",210],"(",["T_VARIABLE","$fileExtension",210],["T_WHITESPACE"," ",210],["T_IS_EQUAL","==",210],["T_WHITESPACE"," ",210],["T_CONSTANT_ENCAPSED_STRING","'js'",210],")",["T_WHITESPACE"," ",210],"{",["T_WHITESPACE","\n            ",210],["T_VARIABLE","$functions",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_STRING","self",211],["T_DOUBLE_COLON","::",211],["T_VARIABLE","$jsUnsecureFunctions",211],";",["T_WHITESPACE","\n        ",211],"}",["T_WHITESPACE"," ",212],["T_ELSEIF","elseif",212],["T_WHITESPACE"," ",212],"(",["T_VARIABLE","$fileExtension",212],["T_WHITESPACE"," ",212],["T_IS_EQUAL","==",212],["T_WHITESPACE"," ",212],["T_CONSTANT_ENCAPSED_STRING","'phtml'",212],")",["T_WHITESPACE"," ",212],"{",["T_WHITESPACE","\n            ",212],["T_VARIABLE","$functions",213],["T_WHITESPACE"," ",213],"=",["T_WHITESPACE"," ",213],["T_STRING","array_merge_recursive",213],"(",["T_STRING","self",213],["T_DOUBLE_COLON","::",213],["T_VARIABLE","$phpUnsecureFunctions",213],",",["T_WHITESPACE"," ",213],["T_STRING","self",213],["T_DOUBLE_COLON","::",213],["T_VARIABLE","$jsUnsecureFunctions",213],")",";",["T_WHITESPACE","\n        ",213],"}",["T_WHITESPACE","\n        ",214],["T_FOREACH","foreach",215],["T_WHITESPACE"," ",215],"(",["T_VARIABLE","$functions",215],["T_WHITESPACE"," ",215],["T_AS","as",215],["T_WHITESPACE"," ",215],["T_VARIABLE","$function",215],["T_WHITESPACE"," ",215],["T_DOUBLE_ARROW","=>",215],["T_WHITESPACE"," ",215],["T_VARIABLE","$functionRules",215],")",["T_WHITESPACE"," ",215],"{",["T_WHITESPACE","\n            ",215],["T_IF","if",216],["T_WHITESPACE"," ",216],"(",["T_STRING","in_array",216],"(",["T_VARIABLE","$fileFullPath",216],",",["T_WHITESPACE"," ",216],["T_VARIABLE","$functionRules",216],"[",["T_CONSTANT_ENCAPSED_STRING","'exclude'",216],"]",")",")",["T_WHITESPACE"," ",216],"{",["T_WHITESPACE","\n                ",216],["T_UNSET","unset",217],"(",["T_VARIABLE","$functions",217],"[",["T_VARIABLE","$function",217],"]",")",";",["T_WHITESPACE","\n            ",217],"}",["T_WHITESPACE","\n        ",218],"}",["T_WHITESPACE","\n        ",219],["T_RETURN","return",220],["T_WHITESPACE"," ",220],["T_VARIABLE","$functions",220],";",["T_WHITESPACE","\n    ",220],"}",["T_WHITESPACE","\n",221],"}",["T_WHITESPACE","\n",222]]