[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Validates that payment groups referenced from store configuration matches the groups declared in payment.xml\n *\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",7],["T_NAMESPACE","namespace",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Test",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Integrity",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Payment",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Config",8],";",["T_WHITESPACE","\n\n",8],["T_CLASS","class",10],["T_WHITESPACE"," ",10],["T_STRING","ReferentialTest",10],["T_WHITESPACE"," ",10],["T_EXTENDS","extends",10],["T_WHITESPACE"," ",10],["T_NS_SEPARATOR","\\",10],["T_STRING","PHPUnit_Framework_TestCase",10],["T_WHITESPACE","\n",10],"{",["T_WHITESPACE","\n    ",11],["T_DOC_COMMENT","\/**\n     * @var string[] $usedGroups all payment groups used in store configuration\n     *\/",12],["T_WHITESPACE","\n    ",14],["T_PROTECTED","protected",15],["T_WHITESPACE"," ",15],["T_STATIC","static",15],["T_WHITESPACE"," ",15],["T_VARIABLE","$_usedGroups",15],["T_WHITESPACE"," ",15],"=",["T_WHITESPACE"," ",15],"[","]",";",["T_WHITESPACE","\n\n    ",15],["T_DOC_COMMENT","\/** @var string[] $_registeredGroups all registered payment groups *\/",17],["T_WHITESPACE","\n    ",17],["T_PROTECTED","protected",18],["T_WHITESPACE"," ",18],["T_STATIC","static",18],["T_WHITESPACE"," ",18],["T_VARIABLE","$_registeredGroups",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],"[","]",";",["T_WHITESPACE","\n\n    ",18],["T_PUBLIC","public",20],["T_WHITESPACE"," ",20],["T_STATIC","static",20],["T_WHITESPACE"," ",20],["T_FUNCTION","function",20],["T_WHITESPACE"," ",20],["T_STRING","setUpBeforeClass",20],"(",")",["T_WHITESPACE","\n    ",20],"{",["T_WHITESPACE","\n        ",21],["T_STRING","self",22],["T_DOUBLE_COLON","::",22],["T_STRING","_populateUsedGroups",22],"(",")",";",["T_WHITESPACE","\n        ",22],["T_STRING","self",23],["T_DOUBLE_COLON","::",23],["T_STRING","_populateRegisteredGroups",23],"(",")",";",["T_WHITESPACE","\n    ",23],"}",["T_WHITESPACE","\n\n    ",24],["T_DOC_COMMENT","\/**\n     * Gathers all payment groups used in store configuration\n     *\/",26],["T_WHITESPACE","\n    ",28],["T_PRIVATE","private",29],["T_WHITESPACE"," ",29],["T_STATIC","static",29],["T_WHITESPACE"," ",29],["T_FUNCTION","function",29],["T_WHITESPACE"," ",29],["T_STRING","_populateUsedGroups",29],"(",")",["T_WHITESPACE","\n    ",29],"{",["T_WHITESPACE","\n        ",30],["T_DOC_COMMENT","\/**\n         * @var string[] $configFiles\n         *\/",31],["T_WHITESPACE","\n        ",33],["T_VARIABLE","$configFiles",34],["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_NS_SEPARATOR","\\",34],["T_STRING","Magento",34],["T_NS_SEPARATOR","\\",34],["T_STRING","Framework",34],["T_NS_SEPARATOR","\\",34],["T_STRING","App",34],["T_NS_SEPARATOR","\\",34],["T_STRING","Utility",34],["T_NS_SEPARATOR","\\",34],["T_STRING","Files",34],["T_DOUBLE_COLON","::",34],["T_STRING","init",34],"(",")",["T_OBJECT_OPERATOR","->",34],["T_STRING","getConfigFiles",34],"(",["T_CONSTANT_ENCAPSED_STRING","'config.xml'",34],",",["T_WHITESPACE"," ",34],"[","]",",",["T_WHITESPACE"," ",34],["T_STRING","false",34],")",";",["T_WHITESPACE","\n        ",34],["T_DOC_COMMENT","\/**\n         * @var string $file\n         *\/",35],["T_WHITESPACE","\n        ",37],["T_FOREACH","foreach",38],["T_WHITESPACE"," ",38],"(",["T_VARIABLE","$configFiles",38],["T_WHITESPACE"," ",38],["T_AS","as",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$file",38],")",["T_WHITESPACE"," ",38],"{",["T_WHITESPACE","\n            ",38],["T_DOC_COMMENT","\/**\n             * @var \\DOMDocument $dom\n             *\/",39],["T_WHITESPACE","\n            ",41],["T_VARIABLE","$dom",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_NEW","new",42],["T_WHITESPACE"," ",42],["T_NS_SEPARATOR","\\",42],["T_STRING","DOMDocument",42],"(",")",";",["T_WHITESPACE","\n            ",42],["T_VARIABLE","$dom",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","loadXML",43],"(",["T_STRING","file_get_contents",43],"(",["T_VARIABLE","$file",43],")",")",";",["T_WHITESPACE","\n\n            ",43],["T_VARIABLE","$xpath",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_NEW","new",45],["T_WHITESPACE"," ",45],["T_NS_SEPARATOR","\\",45],["T_STRING","DOMXPath",45],"(",["T_VARIABLE","$dom",45],")",";",["T_WHITESPACE","\n            ",45],["T_FOREACH","foreach",46],["T_WHITESPACE"," ",46],"(",["T_VARIABLE","$xpath",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","query",46],"(",["T_CONSTANT_ENCAPSED_STRING","'\/config\/*\/payment\/*\/group'",46],")",["T_WHITESPACE"," ",46],["T_AS","as",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$group",46],")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n                ",46],["T_IF","if",47],["T_WHITESPACE"," ",47],"(","!",["T_STRING","in_array",47],"(",["T_VARIABLE","$group",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","nodeValue",47],",",["T_WHITESPACE"," ",47],["T_STRING","self",47],["T_DOUBLE_COLON","::",47],["T_VARIABLE","$_usedGroups",47],")",")",["T_WHITESPACE"," ",47],"{",["T_WHITESPACE","\n                    ",47],["T_STRING","self",48],["T_DOUBLE_COLON","::",48],["T_VARIABLE","$_usedGroups",48],"[","]",["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$group",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","nodeValue",48],";",["T_WHITESPACE","\n                ",48],"}",["T_WHITESPACE","\n            ",49],"}",["T_WHITESPACE","\n        ",50],"}",["T_WHITESPACE","\n    ",51],"}",["T_WHITESPACE","\n\n    ",52],["T_DOC_COMMENT","\/**\n     * Gathers all registered payment groups\n     *\/",54],["T_WHITESPACE","\n    ",56],["T_PRIVATE","private",57],["T_WHITESPACE"," ",57],["T_STATIC","static",57],["T_WHITESPACE"," ",57],["T_FUNCTION","function",57],["T_WHITESPACE"," ",57],["T_STRING","_populateRegisteredGroups",57],"(",")",["T_WHITESPACE","\n    ",57],"{",["T_WHITESPACE","\n        ",58],["T_DOC_COMMENT","\/**\n         * @var string[] $configFiles\n         *\/",59],["T_WHITESPACE","\n        ",61],["T_VARIABLE","$configFiles",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Magento",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Framework",62],["T_NS_SEPARATOR","\\",62],["T_STRING","App",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Utility",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Files",62],["T_DOUBLE_COLON","::",62],["T_STRING","init",62],"(",")",["T_OBJECT_OPERATOR","->",62],["T_STRING","getConfigFiles",62],"(",["T_CONSTANT_ENCAPSED_STRING","'payment.xml'",62],",",["T_WHITESPACE"," ",62],"[","]",",",["T_WHITESPACE"," ",62],["T_STRING","false",62],")",";",["T_WHITESPACE","\n        ",62],["T_DOC_COMMENT","\/**\n         * @var string $file\n         *\/",63],["T_WHITESPACE","\n        ",65],["T_FOREACH","foreach",66],["T_WHITESPACE"," ",66],"(",["T_VARIABLE","$configFiles",66],["T_WHITESPACE"," ",66],["T_AS","as",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$file",66],")",["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n            ",66],["T_DOC_COMMENT","\/**\n             * @var \\DOMDocument $dom\n             *\/",67],["T_WHITESPACE","\n            ",69],["T_VARIABLE","$dom",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_NEW","new",70],["T_WHITESPACE"," ",70],["T_NS_SEPARATOR","\\",70],["T_STRING","DOMDocument",70],"(",")",";",["T_WHITESPACE","\n            ",70],["T_VARIABLE","$dom",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","loadXML",71],"(",["T_STRING","file_get_contents",71],"(",["T_VARIABLE","$file",71],")",")",";",["T_WHITESPACE","\n\n            ",71],["T_VARIABLE","$xpath",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_NEW","new",73],["T_WHITESPACE"," ",73],["T_NS_SEPARATOR","\\",73],["T_STRING","DOMXPath",73],"(",["T_VARIABLE","$dom",73],")",";",["T_WHITESPACE","\n            ",73],["T_FOREACH","foreach",74],["T_WHITESPACE"," ",74],"(",["T_VARIABLE","$xpath",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","query",74],"(",["T_CONSTANT_ENCAPSED_STRING","'\/payment\/groups\/group'",74],")",["T_WHITESPACE"," ",74],["T_AS","as",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$group",74],")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n                ",74],["T_VARIABLE","$id",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$group",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","attributes",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getNamedItem",75],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",75],")",["T_OBJECT_OPERATOR","->",75],["T_STRING","nodeValue",75],";",["T_WHITESPACE","\n                ",75],["T_IF","if",76],["T_WHITESPACE"," ",76],"(","!",["T_STRING","in_array",76],"(",["T_VARIABLE","$id",76],",",["T_WHITESPACE"," ",76],["T_STRING","self",76],["T_DOUBLE_COLON","::",76],["T_VARIABLE","$_registeredGroups",76],")",")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n                    ",76],["T_STRING","self",77],["T_DOUBLE_COLON","::",77],["T_VARIABLE","$_registeredGroups",77],"[","]",["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$id",77],";",["T_WHITESPACE","\n                ",77],"}",["T_WHITESPACE","\n            ",78],"}",["T_WHITESPACE","\n        ",79],"}",["T_WHITESPACE","\n    ",80],"}",["T_WHITESPACE","\n\n    ",81],["T_PUBLIC","public",83],["T_WHITESPACE"," ",83],["T_FUNCTION","function",83],["T_WHITESPACE"," ",83],["T_STRING","testGroupsExists",83],"(",")",["T_WHITESPACE","\n    ",83],"{",["T_WHITESPACE","\n        ",84],["T_VARIABLE","$missing",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_STRING","array_diff",85],"(",["T_STRING","self",85],["T_DOUBLE_COLON","::",85],["T_VARIABLE","$_usedGroups",85],",",["T_WHITESPACE"," ",85],["T_STRING","self",85],["T_DOUBLE_COLON","::",85],["T_VARIABLE","$_registeredGroups",85],")",";",["T_WHITESPACE","\n\n        ",85],["T_IF","if",87],["T_WHITESPACE"," ",87],"(","!",["T_EMPTY","empty",87],"(",["T_VARIABLE","$missing",87],")",")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n            ",87],["T_VARIABLE","$message",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_STRING","sprintf",88],"(",["T_WHITESPACE","\n                ",88],["T_CONSTANT_ENCAPSED_STRING","\"The groups, referenced in store configuration for the payment, \"",89],["T_WHITESPACE"," ",89],".",["T_WHITESPACE","\n                ",89],["T_CONSTANT_ENCAPSED_STRING","\"don't correspond to any payment group declared in payment.xml: %s\"",90],",",["T_WHITESPACE","\n                ",90],["T_STRING","implode",91],"(",["T_CONSTANT_ENCAPSED_STRING","', '",91],",",["T_WHITESPACE"," ",91],["T_VARIABLE","$missing",91],")",["T_WHITESPACE","\n            ",91],")",";",["T_WHITESPACE","\n            ",92],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","fail",93],"(",["T_VARIABLE","$message",93],")",";",["T_WHITESPACE","\n        ",93],"}",["T_WHITESPACE","\n    ",94],"}",["T_WHITESPACE","\n",95],"}",["T_WHITESPACE","\n",96]]