[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Public media files entry point\n *\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","App",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Cache",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Frontend",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Factory",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","App",10],["T_NS_SEPARATOR","\\",10],["T_STRING","ObjectManagerFactory",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Framework",11],["T_NS_SEPARATOR","\\",11],["T_STRING","HTTP",11],["T_NS_SEPARATOR","\\",11],["T_STRING","PhpEnvironment",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Request",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Framework",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Stdlib",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Cookie",12],["T_NS_SEPARATOR","\\",12],["T_STRING","PhpCookieReader",12],";",["T_WHITESPACE","\n\n",12],["T_REQUIRE","require",14],["T_WHITESPACE"," ",14],["T_STRING","dirname",14],"(",["T_DIR","__DIR__",14],")",["T_WHITESPACE"," ",14],".",["T_WHITESPACE"," ",14],["T_CONSTANT_ENCAPSED_STRING","'\/app\/bootstrap.php'",14],";",["T_WHITESPACE","\n\n",14],["T_VARIABLE","$mediaDirectory",16],["T_WHITESPACE"," ",16],"=",["T_WHITESPACE"," ",16],["T_STRING","null",16],";",["T_WHITESPACE","\n",16],["T_VARIABLE","$allowedResources",17],["T_WHITESPACE"," ",17],"=",["T_WHITESPACE"," ",17],"[","]",";",["T_WHITESPACE","\n",17],["T_VARIABLE","$configCacheFile",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],["T_STRING","BP",18],["T_WHITESPACE"," ",18],".",["T_WHITESPACE"," ",18],["T_CONSTANT_ENCAPSED_STRING","'\/var\/resource_config.json'",18],";",["T_WHITESPACE","\n\n",18],["T_VARIABLE","$isAllowed",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_FUNCTION","function",20],["T_WHITESPACE"," ",20],"(",["T_VARIABLE","$resource",20],",",["T_WHITESPACE"," ",20],["T_ARRAY","array",20],["T_WHITESPACE"," ",20],["T_VARIABLE","$allowedResources",20],")",["T_WHITESPACE"," ",20],"{",["T_WHITESPACE","\n    ",20],["T_VARIABLE","$isResourceAllowed",21],["T_WHITESPACE"," ",21],"=",["T_WHITESPACE"," ",21],["T_STRING","false",21],";",["T_WHITESPACE","\n    ",21],["T_FOREACH","foreach",22],["T_WHITESPACE"," ",22],"(",["T_VARIABLE","$allowedResources",22],["T_WHITESPACE"," ",22],["T_AS","as",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$allowedResource",22],")",["T_WHITESPACE"," ",22],"{",["T_WHITESPACE","\n        ",22],["T_IF","if",23],["T_WHITESPACE"," ",23],"(",["T_LNUMBER","0",23],["T_WHITESPACE"," ",23],["T_IS_IDENTICAL","===",23],["T_WHITESPACE"," ",23],["T_STRING","stripos",23],"(",["T_VARIABLE","$resource",23],",",["T_WHITESPACE"," ",23],["T_VARIABLE","$allowedResource",23],")",")",["T_WHITESPACE"," ",23],"{",["T_WHITESPACE","\n            ",23],["T_VARIABLE","$isResourceAllowed",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_STRING","true",24],";",["T_WHITESPACE","\n        ",24],"}",["T_WHITESPACE","\n    ",25],"}",["T_WHITESPACE","\n    ",26],["T_RETURN","return",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$isResourceAllowed",27],";",["T_WHITESPACE","\n",27],"}",";",["T_WHITESPACE","\n\n",28],["T_VARIABLE","$request",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_NEW","new",30],["T_WHITESPACE"," ",30],["T_NS_SEPARATOR","\\",30],["T_STRING","Magento",30],["T_NS_SEPARATOR","\\",30],["T_STRING","MediaStorage",30],["T_NS_SEPARATOR","\\",30],["T_STRING","Model",30],["T_NS_SEPARATOR","\\",30],["T_STRING","File",30],["T_NS_SEPARATOR","\\",30],["T_STRING","Storage",30],["T_NS_SEPARATOR","\\",30],["T_STRING","Request",30],"(",["T_WHITESPACE","\n    ",30],["T_NEW","new",31],["T_WHITESPACE"," ",31],["T_STRING","Request",31],"(",["T_WHITESPACE","\n        ",31],["T_NEW","new",32],["T_WHITESPACE"," ",32],["T_STRING","PhpCookieReader",32],"(",")",",",["T_WHITESPACE","\n        ",32],["T_NEW","new",33],["T_WHITESPACE"," ",33],["T_STRING","Magento",33],["T_NS_SEPARATOR","\\",33],["T_STRING","Framework",33],["T_NS_SEPARATOR","\\",33],["T_STRING","Stdlib",33],["T_NS_SEPARATOR","\\",33],["T_STRING","StringUtils",33],"(",")",["T_WHITESPACE","\n    ",33],")",["T_WHITESPACE","\n",34],")",";",["T_WHITESPACE","\n",35],["T_VARIABLE","$relativePath",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$request",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","getPathInfo",36],"(",")",";",["T_WHITESPACE","\n",36],["T_IF","if",37],["T_WHITESPACE"," ",37],"(",["T_STRING","file_exists",37],"(",["T_VARIABLE","$configCacheFile",37],")",["T_WHITESPACE"," ",37],["T_BOOLEAN_AND","&&",37],["T_WHITESPACE"," ",37],["T_STRING","is_readable",37],"(",["T_VARIABLE","$configCacheFile",37],")",")",["T_WHITESPACE"," ",37],"{",["T_WHITESPACE","\n    ",37],["T_VARIABLE","$config",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_STRING","json_decode",38],"(",["T_STRING","file_get_contents",38],"(",["T_VARIABLE","$configCacheFile",38],")",",",["T_WHITESPACE"," ",38],["T_STRING","true",38],")",";",["T_WHITESPACE","\n\n    ",38],["T_COMMENT","\/\/checking update time\n",40],["T_WHITESPACE","    ",41],["T_IF","if",41],["T_WHITESPACE"," ",41],"(",["T_STRING","filemtime",41],"(",["T_VARIABLE","$configCacheFile",41],")",["T_WHITESPACE"," ",41],"+",["T_WHITESPACE"," ",41],["T_VARIABLE","$config",41],"[",["T_CONSTANT_ENCAPSED_STRING","'update_time'",41],"]",["T_WHITESPACE"," ",41],">",["T_WHITESPACE"," ",41],["T_STRING","time",41],"(",")",")",["T_WHITESPACE"," ",41],"{",["T_WHITESPACE","\n        ",41],["T_VARIABLE","$mediaDirectory",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_VARIABLE","$config",42],"[",["T_CONSTANT_ENCAPSED_STRING","'media_directory'",42],"]",";",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$allowedResources",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_VARIABLE","$config",43],"[",["T_CONSTANT_ENCAPSED_STRING","'allowed_resources'",43],"]",";",["T_WHITESPACE","\n\n        ",43],["T_COMMENT","\/\/ Serve file if it's materialized\n",45],["T_WHITESPACE","        ",46],["T_IF","if",46],["T_WHITESPACE"," ",46],"(",["T_VARIABLE","$mediaDirectory",46],")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n            ",46],["T_IF","if",47],["T_WHITESPACE"," ",47],"(","!",["T_VARIABLE","$isAllowed",47],"(",["T_VARIABLE","$relativePath",47],",",["T_WHITESPACE"," ",47],["T_VARIABLE","$allowedResources",47],")",")",["T_WHITESPACE"," ",47],"{",["T_WHITESPACE","\n                ",47],["T_REQUIRE_ONCE","require_once",48],["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'errors\/404.php'",48],";",["T_WHITESPACE","\n                ",48],["T_EXIT","exit",49],";",["T_WHITESPACE","\n            ",49],"}",["T_WHITESPACE","\n            ",50],["T_VARIABLE","$mediaAbsPath",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$mediaDirectory",51],["T_WHITESPACE"," ",51],".",["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","'\/'",51],["T_WHITESPACE"," ",51],".",["T_WHITESPACE"," ",51],["T_VARIABLE","$relativePath",51],";",["T_WHITESPACE","\n            ",51],["T_IF","if",52],["T_WHITESPACE"," ",52],"(",["T_STRING","is_readable",52],"(",["T_VARIABLE","$mediaAbsPath",52],")",")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n                ",52],["T_IF","if",53],["T_WHITESPACE"," ",53],"(",["T_STRING","is_dir",53],"(",["T_VARIABLE","$mediaAbsPath",53],")",")",["T_WHITESPACE"," ",53],"{",["T_WHITESPACE","\n                    ",53],["T_REQUIRE_ONCE","require_once",54],["T_WHITESPACE"," ",54],["T_CONSTANT_ENCAPSED_STRING","'errors\/404.php'",54],";",["T_WHITESPACE","\n                    ",54],["T_EXIT","exit",55],";",["T_WHITESPACE","\n                ",55],"}",["T_WHITESPACE","\n                ",56],["T_VARIABLE","$transfer",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_NEW","new",57],["T_WHITESPACE"," ",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Magento",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Framework",57],["T_NS_SEPARATOR","\\",57],["T_STRING","File",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Transfer",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Adapter",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Http",57],"(",["T_WHITESPACE","\n                    ",57],["T_NEW","new",58],["T_WHITESPACE"," ",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Magento",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Framework",58],["T_NS_SEPARATOR","\\",58],["T_STRING","HTTP",58],["T_NS_SEPARATOR","\\",58],["T_STRING","PhpEnvironment",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Response",58],"(",")",",",["T_WHITESPACE","\n                    ",58],["T_NEW","new",59],["T_WHITESPACE"," ",59],["T_NS_SEPARATOR","\\",59],["T_STRING","Magento",59],["T_NS_SEPARATOR","\\",59],["T_STRING","Framework",59],["T_NS_SEPARATOR","\\",59],["T_STRING","File",59],["T_NS_SEPARATOR","\\",59],["T_STRING","Mime",59],"(",")",["T_WHITESPACE","\n                ",59],")",";",["T_WHITESPACE","\n                ",60],["T_VARIABLE","$transfer",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","send",61],"(",["T_VARIABLE","$mediaAbsPath",61],")",";",["T_WHITESPACE","\n                ",61],["T_EXIT","exit",62],";",["T_WHITESPACE","\n            ",62],"}",["T_WHITESPACE","\n        ",63],"}",["T_WHITESPACE","\n    ",64],"}",["T_WHITESPACE","\n",65],"}",["T_WHITESPACE","\n\n",66],["T_COMMENT","\/\/ Materialize file in application\n",68],["T_VARIABLE","$params",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_VARIABLE","$_SERVER",69],";",["T_WHITESPACE","\n",69],["T_IF","if",70],["T_WHITESPACE"," ",70],"(",["T_EMPTY","empty",70],"(",["T_VARIABLE","$mediaDirectory",70],")",")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n    ",70],["T_VARIABLE","$params",71],"[",["T_STRING","ObjectManagerFactory",71],["T_DOUBLE_COLON","::",71],["T_STRING","INIT_PARAM_DEPLOYMENT_CONFIG",71],"]",["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],"[","]",";",["T_WHITESPACE","\n    ",71],["T_VARIABLE","$params",72],"[",["T_STRING","Factory",72],["T_DOUBLE_COLON","::",72],["T_STRING","PARAM_CACHE_FORCED_OPTIONS",72],"]",["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],"[",["T_CONSTANT_ENCAPSED_STRING","'frontend_options'",72],["T_WHITESPACE"," ",72],["T_DOUBLE_ARROW","=>",72],["T_WHITESPACE"," ",72],"[",["T_CONSTANT_ENCAPSED_STRING","'disable_save'",72],["T_WHITESPACE"," ",72],["T_DOUBLE_ARROW","=>",72],["T_WHITESPACE"," ",72],["T_STRING","true",72],"]","]",";",["T_WHITESPACE","\n",72],"}",["T_WHITESPACE","\n",73],["T_VARIABLE","$bootstrap",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_NS_SEPARATOR","\\",74],["T_STRING","Magento",74],["T_NS_SEPARATOR","\\",74],["T_STRING","Framework",74],["T_NS_SEPARATOR","\\",74],["T_STRING","App",74],["T_NS_SEPARATOR","\\",74],["T_STRING","Bootstrap",74],["T_DOUBLE_COLON","::",74],["T_STRING","create",74],"(",["T_STRING","BP",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$params",74],")",";",["T_WHITESPACE","\n",74],["T_DOC_COMMENT","\/** @var \\Magento\\MediaStorage\\App\\Media $app *\/",75],["T_WHITESPACE","\n",75],["T_VARIABLE","$app",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$bootstrap",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","createApplication",76],"(",["T_WHITESPACE","\n    ",76],["T_NS_SEPARATOR","\\",77],["T_STRING","Magento",77],["T_NS_SEPARATOR","\\",77],["T_STRING","MediaStorage",77],["T_NS_SEPARATOR","\\",77],["T_STRING","App",77],["T_NS_SEPARATOR","\\",77],["T_STRING","Media",77],["T_DOUBLE_COLON","::",77],["T_CLASS","class",77],",",["T_WHITESPACE","\n    ",77],"[",["T_WHITESPACE","\n        ",78],["T_CONSTANT_ENCAPSED_STRING","'mediaDirectory'",79],["T_WHITESPACE"," ",79],["T_DOUBLE_ARROW","=>",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$mediaDirectory",79],",",["T_WHITESPACE","\n        ",79],["T_CONSTANT_ENCAPSED_STRING","'configCacheFile'",80],["T_WHITESPACE"," ",80],["T_DOUBLE_ARROW","=>",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$configCacheFile",80],",",["T_WHITESPACE","\n        ",80],["T_CONSTANT_ENCAPSED_STRING","'isAllowed'",81],["T_WHITESPACE"," ",81],["T_DOUBLE_ARROW","=>",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$isAllowed",81],",",["T_WHITESPACE","\n        ",81],["T_CONSTANT_ENCAPSED_STRING","'relativeFileName'",82],["T_WHITESPACE"," ",82],["T_DOUBLE_ARROW","=>",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$relativePath",82],",",["T_WHITESPACE","\n    ",82],"]",["T_WHITESPACE","\n",83],")",";",["T_WHITESPACE","\n",84],["T_VARIABLE","$bootstrap",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","run",85],"(",["T_VARIABLE","$app",85],")",";",["T_WHITESPACE","\n",85]]