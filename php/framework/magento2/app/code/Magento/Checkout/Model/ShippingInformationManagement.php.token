[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Checkout",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Exception",8],["T_NS_SEPARATOR","\\",8],["T_STRING","InputException",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Exception",9],["T_NS_SEPARATOR","\\",9],["T_STRING","StateException",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Exception",10],["T_NS_SEPARATOR","\\",10],["T_STRING","NoSuchEntityException",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Quote",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Api",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Data",11],["T_NS_SEPARATOR","\\",11],["T_STRING","AddressInterface",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Quote",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Api",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Data",12],["T_NS_SEPARATOR","\\",12],["T_STRING","CartInterface",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Psr",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Log",13],["T_NS_SEPARATOR","\\",13],["T_STRING","LoggerInterface",13],["T_WHITESPACE"," ",13],["T_AS","as",13],["T_WHITESPACE"," ",13],["T_STRING","Logger",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Quote",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Model",14],["T_NS_SEPARATOR","\\",14],["T_STRING","QuoteAddressValidator",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Magento",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Quote",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Api",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Data",15],["T_NS_SEPARATOR","\\",15],["T_STRING","CartExtensionFactory",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Magento",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Quote",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Model",16],["T_NS_SEPARATOR","\\",16],["T_STRING","ShippingAssignmentFactory",16],";",["T_WHITESPACE","\n",16],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Magento",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Quote",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Model",17],["T_NS_SEPARATOR","\\",17],["T_STRING","ShippingFactory",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Magento",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Framework",18],["T_NS_SEPARATOR","\\",18],["T_STRING","App",18],["T_NS_SEPARATOR","\\",18],["T_STRING","ObjectManager",18],";",["T_WHITESPACE","\n\n",18],["T_DOC_COMMENT","\/**\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",20],["T_WHITESPACE","\n",22],["T_CLASS","class",23],["T_WHITESPACE"," ",23],["T_STRING","ShippingInformationManagement",23],["T_WHITESPACE"," ",23],["T_IMPLEMENTS","implements",23],["T_WHITESPACE"," ",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Magento",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Checkout",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Api",23],["T_NS_SEPARATOR","\\",23],["T_STRING","ShippingInformationManagementInterface",23],["T_WHITESPACE","\n",23],"{",["T_WHITESPACE","\n    ",24],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Api\\PaymentMethodManagementInterface\n     *\/",25],["T_WHITESPACE","\n    ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$paymentMethodManagement",28],";",["T_WHITESPACE","\n\n    ",28],["T_DOC_COMMENT","\/**\n     * @var PaymentDetailsFactory\n     *\/",30],["T_WHITESPACE","\n    ",32],["T_PROTECTED","protected",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$paymentDetailsFactory",33],";",["T_WHITESPACE","\n\n    ",33],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Api\\CartTotalRepositoryInterface\n     *\/",35],["T_WHITESPACE","\n    ",37],["T_PROTECTED","protected",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$cartTotalsRepository",38],";",["T_WHITESPACE","\n\n    ",38],["T_DOC_COMMENT","\/**\n     * Quote repository.\n     *\n     * @var \\Magento\\Quote\\Api\\CartRepositoryInterface\n     *\/",40],["T_WHITESPACE","\n    ",44],["T_PROTECTED","protected",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$quoteRepository",45],";",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * Logger.\n     *\n     * @var Logger\n     *\/",47],["T_WHITESPACE","\n    ",51],["T_PROTECTED","protected",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$logger",52],";",["T_WHITESPACE","\n\n    ",52],["T_DOC_COMMENT","\/**\n     * Validator.\n     *\n     * @var QuoteAddressValidator\n     *\/",54],["T_WHITESPACE","\n    ",58],["T_PROTECTED","protected",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$addressValidator",59],";",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Customer\\Api\\AddressRepositoryInterface\n     *\/",61],["T_WHITESPACE","\n    ",63],["T_PROTECTED","protected",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$addressRepository",64],";",["T_WHITESPACE","\n\n    ",64],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\App\\Config\\ScopeConfigInterface\n     *\/",66],["T_WHITESPACE","\n    ",68],["T_PROTECTED","protected",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$scopeConfig",69],";",["T_WHITESPACE","\n\n    ",69],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Model\\Quote\\TotalsCollector\n     *\/",71],["T_WHITESPACE","\n    ",73],["T_PROTECTED","protected",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$totalsCollector",74],";",["T_WHITESPACE","\n\n    ",74],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Api\\Data\\CartExtensionFactory\n     *\/",76],["T_WHITESPACE","\n    ",78],["T_PRIVATE","private",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$cartExtensionFactory",79],";",["T_WHITESPACE","\n\n    ",79],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Model\\ShippingAssignmentFactory\n     *\/",81],["T_WHITESPACE","\n    ",83],["T_PROTECTED","protected",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$shippingAssignmentFactory",84],";",["T_WHITESPACE","\n\n    ",84],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Model\\ShippingFactory\n     *\/",86],["T_WHITESPACE","\n    ",88],["T_PRIVATE","private",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$shippingFactory",89],";",["T_WHITESPACE","\n\n    ",89],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Quote\\Api\\PaymentMethodManagementInterface $paymentMethodManagement\n     * @param \\Magento\\Checkout\\Model\\PaymentDetailsFactory $paymentDetailsFactory\n     * @param \\Magento\\Quote\\Api\\CartTotalRepositoryInterface $cartTotalsRepository\n     * @param \\Magento\\Quote\\Api\\CartRepositoryInterface $quoteRepository\n     * @param \\Magento\\Quote\\Model\\QuoteAddressValidator $addressValidator\n     * @param Logger $logger\n     * @param \\Magento\\Customer\\Api\\AddressRepositoryInterface $addressRepository\n     * @param \\Magento\\Framework\\App\\Config\\ScopeConfigInterface $scopeConfig\n     * @param \\Magento\\Quote\\Model\\Quote\\TotalsCollector $totalsCollector\n     * @codeCoverageIgnore\n     *\/",91],["T_WHITESPACE","\n    ",102],["T_PUBLIC","public",103],["T_WHITESPACE"," ",103],["T_FUNCTION","function",103],["T_WHITESPACE"," ",103],["T_STRING","__construct",103],"(",["T_WHITESPACE","\n        ",103],["T_NS_SEPARATOR","\\",104],["T_STRING","Magento",104],["T_NS_SEPARATOR","\\",104],["T_STRING","Quote",104],["T_NS_SEPARATOR","\\",104],["T_STRING","Api",104],["T_NS_SEPARATOR","\\",104],["T_STRING","PaymentMethodManagementInterface",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$paymentMethodManagement",104],",",["T_WHITESPACE","\n        ",104],["T_NS_SEPARATOR","\\",105],["T_STRING","Magento",105],["T_NS_SEPARATOR","\\",105],["T_STRING","Checkout",105],["T_NS_SEPARATOR","\\",105],["T_STRING","Model",105],["T_NS_SEPARATOR","\\",105],["T_STRING","PaymentDetailsFactory",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$paymentDetailsFactory",105],",",["T_WHITESPACE","\n        ",105],["T_NS_SEPARATOR","\\",106],["T_STRING","Magento",106],["T_NS_SEPARATOR","\\",106],["T_STRING","Quote",106],["T_NS_SEPARATOR","\\",106],["T_STRING","Api",106],["T_NS_SEPARATOR","\\",106],["T_STRING","CartTotalRepositoryInterface",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$cartTotalsRepository",106],",",["T_WHITESPACE","\n        ",106],["T_NS_SEPARATOR","\\",107],["T_STRING","Magento",107],["T_NS_SEPARATOR","\\",107],["T_STRING","Quote",107],["T_NS_SEPARATOR","\\",107],["T_STRING","Api",107],["T_NS_SEPARATOR","\\",107],["T_STRING","CartRepositoryInterface",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$quoteRepository",107],",",["T_WHITESPACE","\n        ",107],["T_STRING","QuoteAddressValidator",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$addressValidator",108],",",["T_WHITESPACE","\n        ",108],["T_STRING","Logger",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$logger",109],",",["T_WHITESPACE","\n        ",109],["T_NS_SEPARATOR","\\",110],["T_STRING","Magento",110],["T_NS_SEPARATOR","\\",110],["T_STRING","Customer",110],["T_NS_SEPARATOR","\\",110],["T_STRING","Api",110],["T_NS_SEPARATOR","\\",110],["T_STRING","AddressRepositoryInterface",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$addressRepository",110],",",["T_WHITESPACE","\n        ",110],["T_NS_SEPARATOR","\\",111],["T_STRING","Magento",111],["T_NS_SEPARATOR","\\",111],["T_STRING","Framework",111],["T_NS_SEPARATOR","\\",111],["T_STRING","App",111],["T_NS_SEPARATOR","\\",111],["T_STRING","Config",111],["T_NS_SEPARATOR","\\",111],["T_STRING","ScopeConfigInterface",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$scopeConfig",111],",",["T_WHITESPACE","\n        ",111],["T_NS_SEPARATOR","\\",112],["T_STRING","Magento",112],["T_NS_SEPARATOR","\\",112],["T_STRING","Quote",112],["T_NS_SEPARATOR","\\",112],["T_STRING","Model",112],["T_NS_SEPARATOR","\\",112],["T_STRING","Quote",112],["T_NS_SEPARATOR","\\",112],["T_STRING","TotalsCollector",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$totalsCollector",112],["T_WHITESPACE","\n    ",112],")",["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n        ",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","paymentMethodManagement",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_VARIABLE","$paymentMethodManagement",114],";",["T_WHITESPACE","\n        ",114],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","paymentDetailsFactory",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$paymentDetailsFactory",115],";",["T_WHITESPACE","\n        ",115],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","cartTotalsRepository",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_VARIABLE","$cartTotalsRepository",116],";",["T_WHITESPACE","\n        ",116],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","quoteRepository",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_VARIABLE","$quoteRepository",117],";",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","addressValidator",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$addressValidator",118],";",["T_WHITESPACE","\n        ",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","logger",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$logger",119],";",["T_WHITESPACE","\n        ",119],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","addressRepository",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_VARIABLE","$addressRepository",120],";",["T_WHITESPACE","\n        ",120],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","scopeConfig",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_VARIABLE","$scopeConfig",121],";",["T_WHITESPACE","\n        ",121],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","totalsCollector",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_VARIABLE","$totalsCollector",122],";",["T_WHITESPACE","\n    ",122],"}",["T_WHITESPACE","\n\n    ",123],["T_DOC_COMMENT","\/**\n     * {@inheritDoc}\n     *\/",125],["T_WHITESPACE","\n    ",127],["T_PUBLIC","public",128],["T_WHITESPACE"," ",128],["T_FUNCTION","function",128],["T_WHITESPACE"," ",128],["T_STRING","saveAddressInformation",128],"(",["T_WHITESPACE","\n        ",128],["T_VARIABLE","$cartId",129],",",["T_WHITESPACE","\n        ",129],["T_NS_SEPARATOR","\\",130],["T_STRING","Magento",130],["T_NS_SEPARATOR","\\",130],["T_STRING","Checkout",130],["T_NS_SEPARATOR","\\",130],["T_STRING","Api",130],["T_NS_SEPARATOR","\\",130],["T_STRING","Data",130],["T_NS_SEPARATOR","\\",130],["T_STRING","ShippingInformationInterface",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$addressInformation",130],["T_WHITESPACE","\n    ",130],")",["T_WHITESPACE"," ",131],"{",["T_WHITESPACE","\n        ",131],["T_VARIABLE","$address",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_VARIABLE","$addressInformation",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","getShippingAddress",132],"(",")",";",["T_WHITESPACE","\n        ",132],["T_VARIABLE","$billingAddress",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_VARIABLE","$addressInformation",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getBillingAddress",133],"(",")",";",["T_WHITESPACE","\n        ",133],["T_VARIABLE","$carrierCode",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_VARIABLE","$addressInformation",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","getShippingCarrierCode",134],"(",")",";",["T_WHITESPACE","\n        ",134],["T_VARIABLE","$methodCode",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_VARIABLE","$addressInformation",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getShippingMethodCode",135],"(",")",";",["T_WHITESPACE","\n\n        ",135],["T_IF","if",137],["T_WHITESPACE"," ",137],"(","!",["T_VARIABLE","$address",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","getCustomerAddressId",137],"(",")",")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n            ",137],["T_VARIABLE","$address",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","setCustomerAddressId",138],"(",["T_STRING","null",138],")",";",["T_WHITESPACE","\n        ",138],"}",["T_WHITESPACE","\n\n        ",139],["T_IF","if",141],["T_WHITESPACE"," ",141],"(","!",["T_VARIABLE","$address",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getCountryId",141],"(",")",")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n            ",141],["T_THROW","throw",142],["T_WHITESPACE"," ",142],["T_NEW","new",142],["T_WHITESPACE"," ",142],["T_STRING","StateException",142],"(",["T_STRING","__",142],"(",["T_CONSTANT_ENCAPSED_STRING","'Shipping address is not set'",142],")",")",";",["T_WHITESPACE","\n        ",142],"}",["T_WHITESPACE","\n\n        ",143],["T_DOC_COMMENT","\/** @var \\Magento\\Quote\\Model\\Quote $quote *\/",145],["T_WHITESPACE","\n        ",145],["T_VARIABLE","$quote",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","quoteRepository",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","getActive",146],"(",["T_VARIABLE","$cartId",146],")",";",["T_WHITESPACE","\n        ",146],["T_VARIABLE","$address",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","setLimitCarrier",147],"(",["T_VARIABLE","$carrierCode",147],")",";",["T_WHITESPACE","\n        ",147],["T_VARIABLE","$quote",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","prepareShippingAssignment",148],"(",["T_VARIABLE","$quote",148],",",["T_WHITESPACE"," ",148],["T_VARIABLE","$address",148],",",["T_WHITESPACE"," ",148],["T_VARIABLE","$carrierCode",148],["T_WHITESPACE"," ",148],".",["T_WHITESPACE"," ",148],["T_CONSTANT_ENCAPSED_STRING","'_'",148],["T_WHITESPACE"," ",148],".",["T_WHITESPACE"," ",148],["T_VARIABLE","$methodCode",148],")",";",["T_WHITESPACE","\n        ",148],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","validateQuote",149],"(",["T_VARIABLE","$quote",149],")",";",["T_WHITESPACE","\n        ",149],["T_VARIABLE","$quote",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","setIsMultiShipping",150],"(",["T_STRING","false",150],")",";",["T_WHITESPACE","\n\n        ",150],["T_IF","if",152],["T_WHITESPACE"," ",152],"(",["T_VARIABLE","$billingAddress",152],")",["T_WHITESPACE"," ",152],"{",["T_WHITESPACE","\n            ",152],["T_VARIABLE","$quote",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","setBillingAddress",153],"(",["T_VARIABLE","$billingAddress",153],")",";",["T_WHITESPACE","\n        ",153],"}",["T_WHITESPACE","\n\n        ",154],["T_TRY","try",156],["T_WHITESPACE"," ",156],"{",["T_WHITESPACE","\n            ",156],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","quoteRepository",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","save",157],"(",["T_VARIABLE","$quote",157],")",";",["T_WHITESPACE","\n        ",157],"}",["T_WHITESPACE"," ",158],["T_CATCH","catch",158],["T_WHITESPACE"," ",158],"(",["T_NS_SEPARATOR","\\",158],["T_STRING","Exception",158],["T_WHITESPACE"," ",158],["T_VARIABLE","$e",158],")",["T_WHITESPACE"," ",158],"{",["T_WHITESPACE","\n            ",158],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","logger",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","critical",159],"(",["T_VARIABLE","$e",159],")",";",["T_WHITESPACE","\n            ",159],["T_THROW","throw",160],["T_WHITESPACE"," ",160],["T_NEW","new",160],["T_WHITESPACE"," ",160],["T_STRING","InputException",160],"(",["T_STRING","__",160],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to save shipping information. Please check input data.'",160],")",")",";",["T_WHITESPACE","\n        ",160],"}",["T_WHITESPACE","\n\n        ",161],["T_VARIABLE","$shippingAddress",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_VARIABLE","$quote",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","getShippingAddress",163],"(",")",";",["T_WHITESPACE","\n\n        ",163],["T_IF","if",165],["T_WHITESPACE"," ",165],"(","!",["T_VARIABLE","$shippingAddress",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","getShippingRateByCode",165],"(",["T_VARIABLE","$shippingAddress",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","getShippingMethod",165],"(",")",")",")",["T_WHITESPACE"," ",165],"{",["T_WHITESPACE","\n            ",165],["T_THROW","throw",166],["T_WHITESPACE"," ",166],["T_NEW","new",166],["T_WHITESPACE"," ",166],["T_STRING","NoSuchEntityException",166],"(",["T_WHITESPACE","\n                ",166],["T_STRING","__",167],"(",["T_CONSTANT_ENCAPSED_STRING","'Carrier with such method not found: %1, %2'",167],",",["T_WHITESPACE"," ",167],["T_VARIABLE","$carrierCode",167],",",["T_WHITESPACE"," ",167],["T_VARIABLE","$methodCode",167],")",["T_WHITESPACE","\n            ",167],")",";",["T_WHITESPACE","\n        ",168],"}",["T_WHITESPACE","\n\n        ",169],["T_DOC_COMMENT","\/** @var \\Magento\\Checkout\\Api\\Data\\PaymentDetailsInterface $paymentDetails *\/",171],["T_WHITESPACE","\n        ",171],["T_VARIABLE","$paymentDetails",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","paymentDetailsFactory",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","create",172],"(",")",";",["T_WHITESPACE","\n        ",172],["T_VARIABLE","$paymentDetails",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","setPaymentMethods",173],"(",["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","paymentMethodManagement",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","getList",173],"(",["T_VARIABLE","$cartId",173],")",")",";",["T_WHITESPACE","\n        ",173],["T_VARIABLE","$paymentDetails",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","setTotals",174],"(",["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","cartTotalsRepository",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","get",174],"(",["T_VARIABLE","$cartId",174],")",")",";",["T_WHITESPACE","\n        ",174],["T_RETURN","return",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$paymentDetails",175],";",["T_WHITESPACE","\n    ",175],"}",["T_WHITESPACE","\n\n    ",176],["T_DOC_COMMENT","\/**\n     * Validate quote\n     *\n     * @param \\Magento\\Quote\\Model\\Quote $quote\n     * @throws InputException\n     * @throws NoSuchEntityException\n     * @return void\n     *\/",178],["T_WHITESPACE","\n    ",185],["T_PROTECTED","protected",186],["T_WHITESPACE"," ",186],["T_FUNCTION","function",186],["T_WHITESPACE"," ",186],["T_STRING","validateQuote",186],"(",["T_NS_SEPARATOR","\\",186],["T_STRING","Magento",186],["T_NS_SEPARATOR","\\",186],["T_STRING","Quote",186],["T_NS_SEPARATOR","\\",186],["T_STRING","Model",186],["T_NS_SEPARATOR","\\",186],["T_STRING","Quote",186],["T_WHITESPACE"," ",186],["T_VARIABLE","$quote",186],")",["T_WHITESPACE","\n    ",186],"{",["T_WHITESPACE","\n        ",187],["T_IF","if",188],["T_WHITESPACE"," ",188],"(",["T_LNUMBER","0",188],["T_WHITESPACE"," ",188],["T_IS_EQUAL","==",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$quote",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getItemsCount",188],"(",")",")",["T_WHITESPACE"," ",188],"{",["T_WHITESPACE","\n            ",188],["T_THROW","throw",189],["T_WHITESPACE"," ",189],["T_NEW","new",189],["T_WHITESPACE"," ",189],["T_STRING","InputException",189],"(",["T_STRING","__",189],"(",["T_CONSTANT_ENCAPSED_STRING","'Shipping method is not applicable for empty cart'",189],")",")",";",["T_WHITESPACE","\n        ",189],"}",["T_WHITESPACE","\n    ",190],"}",["T_WHITESPACE","\n\n    ",191],["T_DOC_COMMENT","\/**\n     * @param CartInterface $quote\n     * @param AddressInterface $address\n     * @param string $method\n     * @return CartInterface\n     *\/",193],["T_WHITESPACE","\n    ",198],["T_PRIVATE","private",199],["T_WHITESPACE"," ",199],["T_FUNCTION","function",199],["T_WHITESPACE"," ",199],["T_STRING","prepareShippingAssignment",199],"(",["T_STRING","CartInterface",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$quote",199],",",["T_WHITESPACE"," ",199],["T_STRING","AddressInterface",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$address",199],",",["T_WHITESPACE"," ",199],["T_VARIABLE","$method",199],")",["T_WHITESPACE","\n    ",199],"{",["T_WHITESPACE","\n        ",200],["T_VARIABLE","$cartExtension",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_VARIABLE","$quote",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","getExtensionAttributes",201],"(",")",";",["T_WHITESPACE","\n        ",201],["T_IF","if",202],["T_WHITESPACE"," ",202],"(",["T_VARIABLE","$cartExtension",202],["T_WHITESPACE"," ",202],["T_IS_IDENTICAL","===",202],["T_WHITESPACE"," ",202],["T_STRING","null",202],")",["T_WHITESPACE"," ",202],"{",["T_WHITESPACE","\n            ",202],["T_VARIABLE","$cartExtension",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","getCartExtensionFactory",203],"(",")",["T_OBJECT_OPERATOR","->",203],["T_STRING","create",203],"(",")",";",["T_WHITESPACE","\n        ",203],"}",["T_WHITESPACE","\n\n        ",204],["T_VARIABLE","$shippingAssignments",206],["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],["T_VARIABLE","$cartExtension",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","getShippingAssignments",206],"(",")",";",["T_WHITESPACE","\n        ",206],["T_IF","if",207],["T_WHITESPACE"," ",207],"(",["T_EMPTY","empty",207],"(",["T_VARIABLE","$shippingAssignments",207],")",")",["T_WHITESPACE"," ",207],"{",["T_WHITESPACE","\n            ",207],["T_VARIABLE","$shippingAssignment",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","getShippingAssignmentFactory",208],"(",")",["T_OBJECT_OPERATOR","->",208],["T_STRING","create",208],"(",")",";",["T_WHITESPACE","\n        ",208],"}",["T_WHITESPACE"," ",209],["T_ELSE","else",209],["T_WHITESPACE"," ",209],"{",["T_WHITESPACE","\n            ",209],["T_VARIABLE","$shippingAssignment",210],["T_WHITESPACE"," ",210],"=",["T_WHITESPACE"," ",210],["T_VARIABLE","$shippingAssignments",210],"[",["T_LNUMBER","0",210],"]",";",["T_WHITESPACE","\n        ",210],"}",["T_WHITESPACE","\n\n        ",211],["T_VARIABLE","$shipping",213],["T_WHITESPACE"," ",213],"=",["T_WHITESPACE"," ",213],["T_VARIABLE","$shippingAssignment",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","getShipping",213],"(",")",";",["T_WHITESPACE","\n        ",213],["T_IF","if",214],["T_WHITESPACE"," ",214],"(",["T_VARIABLE","$shipping",214],["T_WHITESPACE"," ",214],["T_IS_IDENTICAL","===",214],["T_WHITESPACE"," ",214],["T_STRING","null",214],")",["T_WHITESPACE"," ",214],"{",["T_WHITESPACE","\n            ",214],["T_VARIABLE","$shipping",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","getShippingFactory",215],"(",")",["T_OBJECT_OPERATOR","->",215],["T_STRING","create",215],"(",")",";",["T_WHITESPACE","\n        ",215],"}",["T_WHITESPACE","\n\n        ",216],["T_VARIABLE","$shipping",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","setAddress",218],"(",["T_VARIABLE","$address",218],")",";",["T_WHITESPACE","\n        ",218],["T_VARIABLE","$shipping",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","setMethod",219],"(",["T_VARIABLE","$method",219],")",";",["T_WHITESPACE","\n        ",219],["T_VARIABLE","$shippingAssignment",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","setShipping",220],"(",["T_VARIABLE","$shipping",220],")",";",["T_WHITESPACE","\n        ",220],["T_VARIABLE","$cartExtension",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","setShippingAssignments",221],"(","[",["T_VARIABLE","$shippingAssignment",221],"]",")",";",["T_WHITESPACE","\n        ",221],["T_RETURN","return",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$quote",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","setExtensionAttributes",222],"(",["T_VARIABLE","$cartExtension",222],")",";",["T_WHITESPACE","\n    ",222],"}",["T_WHITESPACE","\n\n    ",223],["T_DOC_COMMENT","\/**\n     * @return CartExtensionFactory\n     *\/",225],["T_WHITESPACE","\n    ",227],["T_PRIVATE","private",228],["T_WHITESPACE"," ",228],["T_FUNCTION","function",228],["T_WHITESPACE"," ",228],["T_STRING","getCartExtensionFactory",228],"(",")",["T_WHITESPACE","\n    ",228],"{",["T_WHITESPACE","\n        ",229],["T_IF","if",230],["T_WHITESPACE"," ",230],"(","!",["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","cartExtensionFactory",230],")",["T_WHITESPACE"," ",230],"{",["T_WHITESPACE","\n            ",230],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","cartExtensionFactory",231],["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],["T_STRING","ObjectManager",231],["T_DOUBLE_COLON","::",231],["T_STRING","getInstance",231],"(",")",["T_OBJECT_OPERATOR","->",231],["T_STRING","get",231],"(",["T_STRING","CartExtensionFactory",231],["T_DOUBLE_COLON","::",231],["T_CLASS","class",231],")",";",["T_WHITESPACE","\n        ",231],"}",["T_WHITESPACE","\n        ",232],["T_RETURN","return",233],["T_WHITESPACE"," ",233],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","cartExtensionFactory",233],";",["T_WHITESPACE","\n    ",233],"}",["T_WHITESPACE","\n\n    ",234],["T_DOC_COMMENT","\/**\n     * @return ShippingAssignmentFactory\n     *\/",236],["T_WHITESPACE","\n    ",238],["T_PRIVATE","private",239],["T_WHITESPACE"," ",239],["T_FUNCTION","function",239],["T_WHITESPACE"," ",239],["T_STRING","getShippingAssignmentFactory",239],"(",")",["T_WHITESPACE","\n    ",239],"{",["T_WHITESPACE","\n        ",240],["T_IF","if",241],["T_WHITESPACE"," ",241],"(","!",["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","shippingAssignmentFactory",241],")",["T_WHITESPACE"," ",241],"{",["T_WHITESPACE","\n            ",241],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","shippingAssignmentFactory",242],["T_WHITESPACE"," ",242],"=",["T_WHITESPACE"," ",242],["T_STRING","ObjectManager",242],["T_DOUBLE_COLON","::",242],["T_STRING","getInstance",242],"(",")",["T_OBJECT_OPERATOR","->",242],["T_STRING","get",242],"(",["T_STRING","ShippingAssignmentFactory",242],["T_DOUBLE_COLON","::",242],["T_CLASS","class",242],")",";",["T_WHITESPACE","\n        ",242],"}",["T_WHITESPACE","\n        ",243],["T_RETURN","return",244],["T_WHITESPACE"," ",244],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","shippingAssignmentFactory",244],";",["T_WHITESPACE","\n    ",244],"}",["T_WHITESPACE","\n\n    ",245],["T_DOC_COMMENT","\/**\n     * @return ShippingFactory\n     *\/",247],["T_WHITESPACE","\n    ",249],["T_PRIVATE","private",250],["T_WHITESPACE"," ",250],["T_FUNCTION","function",250],["T_WHITESPACE"," ",250],["T_STRING","getShippingFactory",250],"(",")",["T_WHITESPACE","\n    ",250],"{",["T_WHITESPACE","\n        ",251],["T_IF","if",252],["T_WHITESPACE"," ",252],"(","!",["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","shippingFactory",252],")",["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n            ",252],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","shippingFactory",253],["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],["T_STRING","ObjectManager",253],["T_DOUBLE_COLON","::",253],["T_STRING","getInstance",253],"(",")",["T_OBJECT_OPERATOR","->",253],["T_STRING","get",253],"(",["T_STRING","ShippingFactory",253],["T_DOUBLE_COLON","::",253],["T_CLASS","class",253],")",";",["T_WHITESPACE","\n        ",253],"}",["T_WHITESPACE","\n        ",254],["T_RETURN","return",255],["T_WHITESPACE"," ",255],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","shippingFactory",255],";",["T_WHITESPACE","\n    ",255],"}",["T_WHITESPACE","\n",256],"}",["T_WHITESPACE","\n",257]]