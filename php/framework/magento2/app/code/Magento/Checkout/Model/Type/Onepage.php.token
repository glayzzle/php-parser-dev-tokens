[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Checkout",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Type",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Customer",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Api",8],["T_NS_SEPARATOR","\\",8],["T_STRING","AccountManagementInterface",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Customer",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Api",9],["T_NS_SEPARATOR","\\",9],["T_STRING","AddressMetadataInterface",9],["T_WHITESPACE"," ",9],["T_AS","as",9],["T_WHITESPACE"," ",9],["T_STRING","AddressMetadata",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Customer",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Api",10],["T_NS_SEPARATOR","\\",10],["T_STRING","AddressRepositoryInterface",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Customer",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Api",11],["T_NS_SEPARATOR","\\",11],["T_STRING","CustomerRepositoryInterface",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Customer",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Api",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Data",12],["T_NS_SEPARATOR","\\",12],["T_STRING","CustomerInterfaceFactory",12],["T_WHITESPACE"," ",12],["T_AS","as",12],["T_WHITESPACE"," ",12],["T_STRING","CustomerDataFactory",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Customer",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Api",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Data",13],["T_NS_SEPARATOR","\\",13],["T_STRING","GroupInterface",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Customer",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Model",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Metadata",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Form",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Magento",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Framework",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Exception",15],["T_NS_SEPARATOR","\\",15],["T_STRING","NoSuchEntityException",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Magento",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Sales",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Model",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Order",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Email",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Sender",16],["T_NS_SEPARATOR","\\",16],["T_STRING","OrderSender",16],";",["T_WHITESPACE","\n\n",16],["T_DOC_COMMENT","\/**\n * @SuppressWarnings(PHPMD.TooManyFields)\n * @SuppressWarnings(PHPMD.ExcessiveClassComplexity)\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",18],["T_WHITESPACE","\n",22],["T_CLASS","class",23],["T_WHITESPACE"," ",23],["T_STRING","Onepage",23],["T_WHITESPACE","\n",23],"{",["T_WHITESPACE","\n    ",24],["T_DOC_COMMENT","\/**\n     * Checkout types: Checkout as Guest, Register, Logged In Customer\n     *\/",25],["T_WHITESPACE","\n    ",27],["T_CONST","const",28],["T_WHITESPACE"," ",28],["T_STRING","METHOD_GUEST",28],["T_WHITESPACE","    ",28],"=",["T_WHITESPACE"," ",28],["T_CONSTANT_ENCAPSED_STRING","'guest'",28],";",["T_WHITESPACE","\n    ",28],["T_CONST","const",29],["T_WHITESPACE"," ",29],["T_STRING","METHOD_REGISTER",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_CONSTANT_ENCAPSED_STRING","'register'",29],";",["T_WHITESPACE","\n    ",29],["T_CONST","const",30],["T_WHITESPACE"," ",30],["T_STRING","METHOD_CUSTOMER",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_CONSTANT_ENCAPSED_STRING","'customer'",30],";",["T_WHITESPACE","\n    ",30],["T_CONST","const",31],["T_WHITESPACE"," ",31],["T_STRING","USE_FOR_SHIPPING",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_LNUMBER","1",31],";",["T_WHITESPACE","\n    ",31],["T_CONST","const",32],["T_WHITESPACE"," ",32],["T_STRING","NOT_USE_FOR_SHIPPING",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_LNUMBER","0",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Customer\\Model\\Session\n     *\/",34],["T_WHITESPACE","\n    ",36],["T_PROTECTED","protected",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$_customerSession",37],";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Checkout\\Model\\Session\n     *\/",39],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_checkoutSession",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Model\\Quote\n     *\/",44],["T_WHITESPACE","\n    ",46],["T_PROTECTED","protected",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$_quote",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_STRING","null",47],";",["T_WHITESPACE","\n\n    ",47],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Checkout\\Helper\\Data\n     *\/",49],["T_WHITESPACE","\n    ",51],["T_PROTECTED","protected",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$_helper",52],";",["T_WHITESPACE","\n\n    ",52],["T_DOC_COMMENT","\/**\n     * @var \\Psr\\Log\\LoggerInterface\n     *\/",54],["T_WHITESPACE","\n    ",56],["T_PROTECTED","protected",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$_logger",57],";",["T_WHITESPACE","\n\n    ",57],["T_DOC_COMMENT","\/**\n     * Customer url\n     *\n     * @var \\Magento\\Customer\\Model\\Url\n     *\/",59],["T_WHITESPACE","\n    ",63],["T_PROTECTED","protected",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$_customerUrl",64],";",["T_WHITESPACE","\n\n    ",64],["T_DOC_COMMENT","\/**\n     * Core event manager proxy\n     *\n     * @var \\Magento\\Framework\\Event\\ManagerInterface\n     *\/",66],["T_WHITESPACE","\n    ",70],["T_PROTECTED","protected",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$_eventManager",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_STRING","null",71],";",["T_WHITESPACE","\n\n    ",71],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Store\\Model\\StoreManagerInterface\n     *\/",73],["T_WHITESPACE","\n    ",75],["T_PROTECTED","protected",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$_storeManager",76],";",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\App\\RequestInterface\n     *\/",78],["T_WHITESPACE","\n    ",80],["T_PROTECTED","protected",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$_request",81],";",["T_WHITESPACE","\n\n    ",81],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Customer\\Model\\AddressFactory\n     *\/",83],["T_WHITESPACE","\n    ",85],["T_PROTECTED","protected",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$_customrAddrFactory",86],";",["T_WHITESPACE","\n\n    ",86],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Customer\\Model\\FormFactory\n     *\/",88],["T_WHITESPACE","\n    ",90],["T_PROTECTED","protected",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$_customerFormFactory",91],";",["T_WHITESPACE","\n\n    ",91],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Customer\\Model\\CustomerFactory\n     *\/",93],["T_WHITESPACE","\n    ",95],["T_PROTECTED","protected",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$_customerFactory",96],";",["T_WHITESPACE","\n\n    ",96],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Sales\\Model\\OrderFactory\n     *\/",98],["T_WHITESPACE","\n    ",100],["T_PROTECTED","protected",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$_orderFactory",101],";",["T_WHITESPACE","\n\n    ",101],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\DataObject\\Copy\n     *\/",103],["T_WHITESPACE","\n    ",105],["T_PROTECTED","protected",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$_objectCopyService",106],";",["T_WHITESPACE","\n\n    ",106],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Message\\ManagerInterface\n     *\/",108],["T_WHITESPACE","\n    ",110],["T_PROTECTED","protected",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$messageManager",111],";",["T_WHITESPACE","\n\n    ",111],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Customer\\Model\\Metadata\\FormFactory\n     *\/",113],["T_WHITESPACE","\n    ",115],["T_PROTECTED","protected",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$_formFactory",116],";",["T_WHITESPACE","\n\n    ",116],["T_DOC_COMMENT","\/**\n     * @var CustomerDataFactory\n     *\/",118],["T_WHITESPACE","\n    ",120],["T_PROTECTED","protected",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$customerDataFactory",121],";",["T_WHITESPACE","\n\n    ",121],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Math\\Random\n     *\/",123],["T_WHITESPACE","\n    ",125],["T_PROTECTED","protected",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$mathRandom",126],";",["T_WHITESPACE","\n\n    ",126],["T_DOC_COMMENT","\/**\n     * @var AddressRepositoryInterface\n     *\/",128],["T_WHITESPACE","\n    ",130],["T_PROTECTED","protected",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$addressRepository",131],";",["T_WHITESPACE","\n\n    ",131],["T_DOC_COMMENT","\/**\n     * @var AccountManagementInterface\n     *\/",133],["T_WHITESPACE","\n    ",135],["T_PROTECTED","protected",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$accountManagement",136],";",["T_WHITESPACE","\n\n    ",136],["T_DOC_COMMENT","\/**\n     * @var OrderSender\n     *\/",138],["T_WHITESPACE","\n    ",140],["T_PROTECTED","protected",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$orderSender",141],";",["T_WHITESPACE","\n\n    ",141],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Api\\CartRepositoryInterface\n     *\/",143],["T_WHITESPACE","\n    ",145],["T_PROTECTED","protected",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$quoteRepository",146],";",["T_WHITESPACE","\n\n    ",146],["T_DOC_COMMENT","\/**\n     * @var CustomerRepositoryInterface\n     *\/",148],["T_WHITESPACE","\n    ",150],["T_PROTECTED","protected",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$customerRepository",151],";",["T_WHITESPACE","\n\n    ",151],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Api\\ExtensibleDataObjectConverter\n     *\/",153],["T_WHITESPACE","\n    ",155],["T_PROTECTED","protected",156],["T_WHITESPACE"," ",156],["T_VARIABLE","$extensibleDataObjectConverter",156],";",["T_WHITESPACE","\n\n    ",156],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Api\\CartManagementInterface\n     *\/",158],["T_WHITESPACE","\n    ",160],["T_PROTECTED","protected",161],["T_WHITESPACE"," ",161],["T_VARIABLE","$quoteManagement",161],";",["T_WHITESPACE","\n\n    ",161],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Api\\DataObjectHelper\n     *\/",163],["T_WHITESPACE","\n    ",165],["T_PROTECTED","protected",166],["T_WHITESPACE"," ",166],["T_VARIABLE","$dataObjectHelper",166],";",["T_WHITESPACE","\n\n    ",166],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Model\\Quote\\TotalsCollector\n     *\/",168],["T_WHITESPACE","\n    ",170],["T_PROTECTED","protected",171],["T_WHITESPACE"," ",171],["T_VARIABLE","$totalsCollector",171],";",["T_WHITESPACE","\n\n    ",171],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\Event\\ManagerInterface $eventManager\n     * @param \\Magento\\Checkout\\Helper\\Data $helper\n     * @param \\Magento\\Customer\\Model\\Url $customerUrl\n     * @param \\Psr\\Log\\LoggerInterface $logger\n     * @param \\Magento\\Checkout\\Model\\Session $checkoutSession\n     * @param \\Magento\\Customer\\Model\\Session $customerSession\n     * @param \\Magento\\Store\\Model\\StoreManagerInterface $storeManager\n     * @param \\Magento\\Framework\\App\\RequestInterface $request\n     * @param \\Magento\\Customer\\Model\\AddressFactory $customrAddrFactory\n     * @param \\Magento\\Customer\\Model\\FormFactory $customerFormFactory\n     * @param \\Magento\\Customer\\Model\\CustomerFactory $customerFactory\n     * @param \\Magento\\Sales\\Model\\OrderFactory $orderFactory\n     * @param \\Magento\\Framework\\DataObject\\Copy $objectCopyService\n     * @param \\Magento\\Framework\\Message\\ManagerInterface $messageManager\n     * @param \\Magento\\Customer\\Model\\Metadata\\FormFactory $formFactory\n     * @param CustomerDataFactory $customerDataFactory\n     * @param \\Magento\\Framework\\Math\\Random $mathRandom\n     * @param \\Magento\\Framework\\Encryption\\EncryptorInterface $encryptor\n     * @param AddressRepositoryInterface $addressRepository\n     * @param AccountManagementInterface $accountManagement\n     * @param OrderSender $orderSender\n     * @param CustomerRepositoryInterface $customerRepository\n     * @param \\Magento\\Quote\\Api\\CartRepositoryInterface $quoteRepository\n     * @param \\Magento\\Framework\\Api\\ExtensibleDataObjectConverter $extensibleDataObjectConverter\n     * @param \\Magento\\Quote\\Api\\CartManagementInterface $quoteManagement\n     * @param \\Magento\\Framework\\Api\\DataObjectHelper $dataObjectHelper\n     * @param \\Magento\\Quote\\Model\\Quote\\TotalsCollector $totalsCollector\n     * @codeCoverageIgnore\n     * @SuppressWarnings(PHPMD.ExcessiveParameterList)\n     *\/",173],["T_WHITESPACE","\n    ",203],["T_PUBLIC","public",204],["T_WHITESPACE"," ",204],["T_FUNCTION","function",204],["T_WHITESPACE"," ",204],["T_STRING","__construct",204],"(",["T_WHITESPACE","\n        ",204],["T_NS_SEPARATOR","\\",205],["T_STRING","Magento",205],["T_NS_SEPARATOR","\\",205],["T_STRING","Framework",205],["T_NS_SEPARATOR","\\",205],["T_STRING","Event",205],["T_NS_SEPARATOR","\\",205],["T_STRING","ManagerInterface",205],["T_WHITESPACE"," ",205],["T_VARIABLE","$eventManager",205],",",["T_WHITESPACE","\n        ",205],["T_NS_SEPARATOR","\\",206],["T_STRING","Magento",206],["T_NS_SEPARATOR","\\",206],["T_STRING","Checkout",206],["T_NS_SEPARATOR","\\",206],["T_STRING","Helper",206],["T_NS_SEPARATOR","\\",206],["T_STRING","Data",206],["T_WHITESPACE"," ",206],["T_VARIABLE","$helper",206],",",["T_WHITESPACE","\n        ",206],["T_NS_SEPARATOR","\\",207],["T_STRING","Magento",207],["T_NS_SEPARATOR","\\",207],["T_STRING","Customer",207],["T_NS_SEPARATOR","\\",207],["T_STRING","Model",207],["T_NS_SEPARATOR","\\",207],["T_STRING","Url",207],["T_WHITESPACE"," ",207],["T_VARIABLE","$customerUrl",207],",",["T_WHITESPACE","\n        ",207],["T_NS_SEPARATOR","\\",208],["T_STRING","Psr",208],["T_NS_SEPARATOR","\\",208],["T_STRING","Log",208],["T_NS_SEPARATOR","\\",208],["T_STRING","LoggerInterface",208],["T_WHITESPACE"," ",208],["T_VARIABLE","$logger",208],",",["T_WHITESPACE","\n        ",208],["T_NS_SEPARATOR","\\",209],["T_STRING","Magento",209],["T_NS_SEPARATOR","\\",209],["T_STRING","Checkout",209],["T_NS_SEPARATOR","\\",209],["T_STRING","Model",209],["T_NS_SEPARATOR","\\",209],["T_STRING","Session",209],["T_WHITESPACE"," ",209],["T_VARIABLE","$checkoutSession",209],",",["T_WHITESPACE","\n        ",209],["T_NS_SEPARATOR","\\",210],["T_STRING","Magento",210],["T_NS_SEPARATOR","\\",210],["T_STRING","Customer",210],["T_NS_SEPARATOR","\\",210],["T_STRING","Model",210],["T_NS_SEPARATOR","\\",210],["T_STRING","Session",210],["T_WHITESPACE"," ",210],["T_VARIABLE","$customerSession",210],",",["T_WHITESPACE","\n        ",210],["T_NS_SEPARATOR","\\",211],["T_STRING","Magento",211],["T_NS_SEPARATOR","\\",211],["T_STRING","Store",211],["T_NS_SEPARATOR","\\",211],["T_STRING","Model",211],["T_NS_SEPARATOR","\\",211],["T_STRING","StoreManagerInterface",211],["T_WHITESPACE"," ",211],["T_VARIABLE","$storeManager",211],",",["T_WHITESPACE","\n        ",211],["T_NS_SEPARATOR","\\",212],["T_STRING","Magento",212],["T_NS_SEPARATOR","\\",212],["T_STRING","Framework",212],["T_NS_SEPARATOR","\\",212],["T_STRING","App",212],["T_NS_SEPARATOR","\\",212],["T_STRING","RequestInterface",212],["T_WHITESPACE"," ",212],["T_VARIABLE","$request",212],",",["T_WHITESPACE","\n        ",212],["T_NS_SEPARATOR","\\",213],["T_STRING","Magento",213],["T_NS_SEPARATOR","\\",213],["T_STRING","Customer",213],["T_NS_SEPARATOR","\\",213],["T_STRING","Model",213],["T_NS_SEPARATOR","\\",213],["T_STRING","AddressFactory",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$customrAddrFactory",213],",",["T_WHITESPACE","\n        ",213],["T_NS_SEPARATOR","\\",214],["T_STRING","Magento",214],["T_NS_SEPARATOR","\\",214],["T_STRING","Customer",214],["T_NS_SEPARATOR","\\",214],["T_STRING","Model",214],["T_NS_SEPARATOR","\\",214],["T_STRING","FormFactory",214],["T_WHITESPACE"," ",214],["T_VARIABLE","$customerFormFactory",214],",",["T_WHITESPACE","\n        ",214],["T_NS_SEPARATOR","\\",215],["T_STRING","Magento",215],["T_NS_SEPARATOR","\\",215],["T_STRING","Customer",215],["T_NS_SEPARATOR","\\",215],["T_STRING","Model",215],["T_NS_SEPARATOR","\\",215],["T_STRING","CustomerFactory",215],["T_WHITESPACE"," ",215],["T_VARIABLE","$customerFactory",215],",",["T_WHITESPACE","\n        ",215],["T_NS_SEPARATOR","\\",216],["T_STRING","Magento",216],["T_NS_SEPARATOR","\\",216],["T_STRING","Sales",216],["T_NS_SEPARATOR","\\",216],["T_STRING","Model",216],["T_NS_SEPARATOR","\\",216],["T_STRING","OrderFactory",216],["T_WHITESPACE"," ",216],["T_VARIABLE","$orderFactory",216],",",["T_WHITESPACE","\n        ",216],["T_NS_SEPARATOR","\\",217],["T_STRING","Magento",217],["T_NS_SEPARATOR","\\",217],["T_STRING","Framework",217],["T_NS_SEPARATOR","\\",217],["T_STRING","DataObject",217],["T_NS_SEPARATOR","\\",217],["T_STRING","Copy",217],["T_WHITESPACE"," ",217],["T_VARIABLE","$objectCopyService",217],",",["T_WHITESPACE","\n        ",217],["T_NS_SEPARATOR","\\",218],["T_STRING","Magento",218],["T_NS_SEPARATOR","\\",218],["T_STRING","Framework",218],["T_NS_SEPARATOR","\\",218],["T_STRING","Message",218],["T_NS_SEPARATOR","\\",218],["T_STRING","ManagerInterface",218],["T_WHITESPACE"," ",218],["T_VARIABLE","$messageManager",218],",",["T_WHITESPACE","\n        ",218],["T_NS_SEPARATOR","\\",219],["T_STRING","Magento",219],["T_NS_SEPARATOR","\\",219],["T_STRING","Customer",219],["T_NS_SEPARATOR","\\",219],["T_STRING","Model",219],["T_NS_SEPARATOR","\\",219],["T_STRING","Metadata",219],["T_NS_SEPARATOR","\\",219],["T_STRING","FormFactory",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$formFactory",219],",",["T_WHITESPACE","\n        ",219],["T_STRING","CustomerDataFactory",220],["T_WHITESPACE"," ",220],["T_VARIABLE","$customerDataFactory",220],",",["T_WHITESPACE","\n        ",220],["T_NS_SEPARATOR","\\",221],["T_STRING","Magento",221],["T_NS_SEPARATOR","\\",221],["T_STRING","Framework",221],["T_NS_SEPARATOR","\\",221],["T_STRING","Math",221],["T_NS_SEPARATOR","\\",221],["T_STRING","Random",221],["T_WHITESPACE"," ",221],["T_VARIABLE","$mathRandom",221],",",["T_WHITESPACE","\n        ",221],["T_NS_SEPARATOR","\\",222],["T_STRING","Magento",222],["T_NS_SEPARATOR","\\",222],["T_STRING","Framework",222],["T_NS_SEPARATOR","\\",222],["T_STRING","Encryption",222],["T_NS_SEPARATOR","\\",222],["T_STRING","EncryptorInterface",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$encryptor",222],",",["T_WHITESPACE","\n        ",222],["T_STRING","AddressRepositoryInterface",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$addressRepository",223],",",["T_WHITESPACE","\n        ",223],["T_STRING","AccountManagementInterface",224],["T_WHITESPACE"," ",224],["T_VARIABLE","$accountManagement",224],",",["T_WHITESPACE","\n        ",224],["T_STRING","OrderSender",225],["T_WHITESPACE"," ",225],["T_VARIABLE","$orderSender",225],",",["T_WHITESPACE","\n        ",225],["T_STRING","CustomerRepositoryInterface",226],["T_WHITESPACE"," ",226],["T_VARIABLE","$customerRepository",226],",",["T_WHITESPACE","\n        ",226],["T_NS_SEPARATOR","\\",227],["T_STRING","Magento",227],["T_NS_SEPARATOR","\\",227],["T_STRING","Quote",227],["T_NS_SEPARATOR","\\",227],["T_STRING","Api",227],["T_NS_SEPARATOR","\\",227],["T_STRING","CartRepositoryInterface",227],["T_WHITESPACE"," ",227],["T_VARIABLE","$quoteRepository",227],",",["T_WHITESPACE","\n        ",227],["T_NS_SEPARATOR","\\",228],["T_STRING","Magento",228],["T_NS_SEPARATOR","\\",228],["T_STRING","Framework",228],["T_NS_SEPARATOR","\\",228],["T_STRING","Api",228],["T_NS_SEPARATOR","\\",228],["T_STRING","ExtensibleDataObjectConverter",228],["T_WHITESPACE"," ",228],["T_VARIABLE","$extensibleDataObjectConverter",228],",",["T_WHITESPACE","\n        ",228],["T_NS_SEPARATOR","\\",229],["T_STRING","Magento",229],["T_NS_SEPARATOR","\\",229],["T_STRING","Quote",229],["T_NS_SEPARATOR","\\",229],["T_STRING","Api",229],["T_NS_SEPARATOR","\\",229],["T_STRING","CartManagementInterface",229],["T_WHITESPACE"," ",229],["T_VARIABLE","$quoteManagement",229],",",["T_WHITESPACE","\n        ",229],["T_NS_SEPARATOR","\\",230],["T_STRING","Magento",230],["T_NS_SEPARATOR","\\",230],["T_STRING","Framework",230],["T_NS_SEPARATOR","\\",230],["T_STRING","Api",230],["T_NS_SEPARATOR","\\",230],["T_STRING","DataObjectHelper",230],["T_WHITESPACE"," ",230],["T_VARIABLE","$dataObjectHelper",230],",",["T_WHITESPACE","\n        ",230],["T_NS_SEPARATOR","\\",231],["T_STRING","Magento",231],["T_NS_SEPARATOR","\\",231],["T_STRING","Quote",231],["T_NS_SEPARATOR","\\",231],["T_STRING","Model",231],["T_NS_SEPARATOR","\\",231],["T_STRING","Quote",231],["T_NS_SEPARATOR","\\",231],["T_STRING","TotalsCollector",231],["T_WHITESPACE"," ",231],["T_VARIABLE","$totalsCollector",231],["T_WHITESPACE","\n    ",231],")",["T_WHITESPACE"," ",232],"{",["T_WHITESPACE","\n        ",232],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","_eventManager",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_VARIABLE","$eventManager",233],";",["T_WHITESPACE","\n        ",233],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","_customerUrl",234],["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_VARIABLE","$customerUrl",234],";",["T_WHITESPACE","\n        ",234],["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","_helper",235],["T_WHITESPACE"," ",235],"=",["T_WHITESPACE"," ",235],["T_VARIABLE","$helper",235],";",["T_WHITESPACE","\n        ",235],["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","_checkoutSession",236],["T_WHITESPACE"," ",236],"=",["T_WHITESPACE"," ",236],["T_VARIABLE","$checkoutSession",236],";",["T_WHITESPACE","\n        ",236],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","_customerSession",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_VARIABLE","$customerSession",237],";",["T_WHITESPACE","\n        ",237],["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","_logger",238],["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],["T_VARIABLE","$logger",238],";",["T_WHITESPACE","\n        ",238],["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","_storeManager",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_VARIABLE","$storeManager",239],";",["T_WHITESPACE","\n        ",239],["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","_request",240],["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],["T_VARIABLE","$request",240],";",["T_WHITESPACE","\n        ",240],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","_customrAddrFactory",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_VARIABLE","$customrAddrFactory",241],";",["T_WHITESPACE","\n        ",241],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","_customerFormFactory",242],["T_WHITESPACE"," ",242],"=",["T_WHITESPACE"," ",242],["T_VARIABLE","$customerFormFactory",242],";",["T_WHITESPACE","\n        ",242],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","_customerFactory",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_VARIABLE","$customerFactory",243],";",["T_WHITESPACE","\n        ",243],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","_orderFactory",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_VARIABLE","$orderFactory",244],";",["T_WHITESPACE","\n        ",244],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","_objectCopyService",245],["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_VARIABLE","$objectCopyService",245],";",["T_WHITESPACE","\n        ",245],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","messageManager",246],["T_WHITESPACE"," ",246],"=",["T_WHITESPACE"," ",246],["T_VARIABLE","$messageManager",246],";",["T_WHITESPACE","\n        ",246],["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","_formFactory",247],["T_WHITESPACE"," ",247],"=",["T_WHITESPACE"," ",247],["T_VARIABLE","$formFactory",247],";",["T_WHITESPACE","\n        ",247],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","customerDataFactory",248],["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_VARIABLE","$customerDataFactory",248],";",["T_WHITESPACE","\n        ",248],["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","mathRandom",249],["T_WHITESPACE"," ",249],"=",["T_WHITESPACE"," ",249],["T_VARIABLE","$mathRandom",249],";",["T_WHITESPACE","\n        ",249],["T_VARIABLE","$this",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","_encryptor",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_VARIABLE","$encryptor",250],";",["T_WHITESPACE","\n        ",250],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","addressRepository",251],["T_WHITESPACE"," ",251],"=",["T_WHITESPACE"," ",251],["T_VARIABLE","$addressRepository",251],";",["T_WHITESPACE","\n        ",251],["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","accountManagement",252],["T_WHITESPACE"," ",252],"=",["T_WHITESPACE"," ",252],["T_VARIABLE","$accountManagement",252],";",["T_WHITESPACE","\n        ",252],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","orderSender",253],["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],["T_VARIABLE","$orderSender",253],";",["T_WHITESPACE","\n        ",253],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","customerRepository",254],["T_WHITESPACE"," ",254],"=",["T_WHITESPACE"," ",254],["T_VARIABLE","$customerRepository",254],";",["T_WHITESPACE","\n        ",254],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","quoteRepository",255],["T_WHITESPACE"," ",255],"=",["T_WHITESPACE"," ",255],["T_VARIABLE","$quoteRepository",255],";",["T_WHITESPACE","\n        ",255],["T_VARIABLE","$this",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","extensibleDataObjectConverter",256],["T_WHITESPACE"," ",256],"=",["T_WHITESPACE"," ",256],["T_VARIABLE","$extensibleDataObjectConverter",256],";",["T_WHITESPACE","\n        ",256],["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","quoteManagement",257],["T_WHITESPACE"," ",257],"=",["T_WHITESPACE"," ",257],["T_VARIABLE","$quoteManagement",257],";",["T_WHITESPACE","\n        ",257],["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","dataObjectHelper",258],["T_WHITESPACE"," ",258],"=",["T_WHITESPACE"," ",258],["T_VARIABLE","$dataObjectHelper",258],";",["T_WHITESPACE","\n        ",258],["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","totalsCollector",259],["T_WHITESPACE"," ",259],"=",["T_WHITESPACE"," ",259],["T_VARIABLE","$totalsCollector",259],";",["T_WHITESPACE","\n    ",259],"}",["T_WHITESPACE","\n\n    ",260],["T_DOC_COMMENT","\/**\n     * Get frontend checkout session object\n     *\n     * @return \\Magento\\Checkout\\Model\\Session\n     * @codeCoverageIgnore\n     *\/",262],["T_WHITESPACE","\n    ",267],["T_PUBLIC","public",268],["T_WHITESPACE"," ",268],["T_FUNCTION","function",268],["T_WHITESPACE"," ",268],["T_STRING","getCheckout",268],"(",")",["T_WHITESPACE","\n    ",268],"{",["T_WHITESPACE","\n        ",269],["T_RETURN","return",270],["T_WHITESPACE"," ",270],["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","_checkoutSession",270],";",["T_WHITESPACE","\n    ",270],"}",["T_WHITESPACE","\n\n    ",271],["T_DOC_COMMENT","\/**\n     * Quote object getter\n     *\n     * @return \\Magento\\Quote\\Model\\Quote\n     *\/",273],["T_WHITESPACE","\n    ",277],["T_PUBLIC","public",278],["T_WHITESPACE"," ",278],["T_FUNCTION","function",278],["T_WHITESPACE"," ",278],["T_STRING","getQuote",278],"(",")",["T_WHITESPACE","\n    ",278],"{",["T_WHITESPACE","\n        ",279],["T_IF","if",280],["T_WHITESPACE"," ",280],"(",["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","_quote",280],["T_WHITESPACE"," ",280],["T_IS_IDENTICAL","===",280],["T_WHITESPACE"," ",280],["T_STRING","null",280],")",["T_WHITESPACE"," ",280],"{",["T_WHITESPACE","\n            ",280],["T_RETURN","return",281],["T_WHITESPACE"," ",281],["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","_checkoutSession",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","getQuote",281],"(",")",";",["T_WHITESPACE","\n        ",281],"}",["T_WHITESPACE","\n        ",282],["T_RETURN","return",283],["T_WHITESPACE"," ",283],["T_VARIABLE","$this",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","_quote",283],";",["T_WHITESPACE","\n    ",283],"}",["T_WHITESPACE","\n\n    ",284],["T_DOC_COMMENT","\/**\n     * Declare checkout quote instance\n     *\n     * @param \\Magento\\Quote\\Model\\Quote $quote\n     * @return $this\n     * @codeCoverageIgnore\n     *\/",286],["T_WHITESPACE","\n    ",292],["T_PUBLIC","public",293],["T_WHITESPACE"," ",293],["T_FUNCTION","function",293],["T_WHITESPACE"," ",293],["T_STRING","setQuote",293],"(",["T_NS_SEPARATOR","\\",293],["T_STRING","Magento",293],["T_NS_SEPARATOR","\\",293],["T_STRING","Quote",293],["T_NS_SEPARATOR","\\",293],["T_STRING","Model",293],["T_NS_SEPARATOR","\\",293],["T_STRING","Quote",293],["T_WHITESPACE"," ",293],["T_VARIABLE","$quote",293],")",["T_WHITESPACE","\n    ",293],"{",["T_WHITESPACE","\n        ",294],["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","_quote",295],["T_WHITESPACE"," ",295],"=",["T_WHITESPACE"," ",295],["T_VARIABLE","$quote",295],";",["T_WHITESPACE","\n        ",295],["T_RETURN","return",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$this",296],";",["T_WHITESPACE","\n    ",296],"}",["T_WHITESPACE","\n\n    ",297],["T_DOC_COMMENT","\/**\n     * Get customer session object\n     *\n     * @return \\Magento\\Customer\\Model\\Session\n     * @codeCoverageIgnore\n     *\/",299],["T_WHITESPACE","\n    ",304],["T_PUBLIC","public",305],["T_WHITESPACE"," ",305],["T_FUNCTION","function",305],["T_WHITESPACE"," ",305],["T_STRING","getCustomerSession",305],"(",")",["T_WHITESPACE","\n    ",305],"{",["T_WHITESPACE","\n        ",306],["T_RETURN","return",307],["T_WHITESPACE"," ",307],["T_VARIABLE","$this",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","_customerSession",307],";",["T_WHITESPACE","\n    ",307],"}",["T_WHITESPACE","\n\n    ",308],["T_DOC_COMMENT","\/**\n     * Initialize quote state to be valid for one page checkout\n     *\n     * @return $this\n     * @SuppressWarnings(PHPMD.UnusedLocalVariable)\n     *\/",310],["T_WHITESPACE","\n    ",315],["T_PUBLIC","public",316],["T_WHITESPACE"," ",316],["T_FUNCTION","function",316],["T_WHITESPACE"," ",316],["T_STRING","initCheckout",316],"(",")",["T_WHITESPACE","\n    ",316],"{",["T_WHITESPACE","\n        ",317],["T_VARIABLE","$checkout",318],["T_WHITESPACE"," ",318],"=",["T_WHITESPACE"," ",318],["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","getCheckout",318],"(",")",";",["T_WHITESPACE","\n        ",318],["T_VARIABLE","$customerSession",319],["T_WHITESPACE"," ",319],"=",["T_WHITESPACE"," ",319],["T_VARIABLE","$this",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","getCustomerSession",319],"(",")",";",["T_WHITESPACE","\n        ",319],["T_IF","if",320],["T_WHITESPACE"," ",320],"(",["T_STRING","is_array",320],"(",["T_VARIABLE","$checkout",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","getStepData",320],"(",")",")",")",["T_WHITESPACE"," ",320],"{",["T_WHITESPACE","\n            ",320],["T_FOREACH","foreach",321],["T_WHITESPACE"," ",321],"(",["T_VARIABLE","$checkout",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","getStepData",321],"(",")",["T_WHITESPACE"," ",321],["T_AS","as",321],["T_WHITESPACE"," ",321],["T_VARIABLE","$step",321],["T_WHITESPACE"," ",321],["T_DOUBLE_ARROW","=>",321],["T_WHITESPACE"," ",321],["T_VARIABLE","$data",321],")",["T_WHITESPACE"," ",321],"{",["T_WHITESPACE","\n                ",321],["T_IF","if",322],["T_WHITESPACE"," ",322],"(","!","(",["T_VARIABLE","$step",322],["T_WHITESPACE"," ",322],["T_IS_IDENTICAL","===",322],["T_WHITESPACE"," ",322],["T_CONSTANT_ENCAPSED_STRING","'login'",322],["T_WHITESPACE"," ",322],["T_BOOLEAN_OR","||",322],["T_WHITESPACE"," ",322],["T_VARIABLE","$customerSession",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","isLoggedIn",322],"(",")",["T_WHITESPACE"," ",322],["T_BOOLEAN_AND","&&",322],["T_WHITESPACE"," ",322],["T_VARIABLE","$step",322],["T_WHITESPACE"," ",322],["T_IS_IDENTICAL","===",322],["T_WHITESPACE"," ",322],["T_CONSTANT_ENCAPSED_STRING","'billing'",322],")",")",["T_WHITESPACE"," ",322],"{",["T_WHITESPACE","\n                    ",322],["T_VARIABLE","$checkout",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","setStepData",323],"(",["T_VARIABLE","$step",323],",",["T_WHITESPACE"," ",323],["T_CONSTANT_ENCAPSED_STRING","'allow'",323],",",["T_WHITESPACE"," ",323],["T_STRING","false",323],")",";",["T_WHITESPACE","\n                ",323],"}",["T_WHITESPACE","\n            ",324],"}",["T_WHITESPACE","\n        ",325],"}",["T_WHITESPACE","\n\n        ",326],["T_VARIABLE","$quote",328],["T_WHITESPACE"," ",328],"=",["T_WHITESPACE"," ",328],["T_VARIABLE","$this",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","getQuote",328],"(",")",";",["T_WHITESPACE","\n        ",328],["T_IF","if",329],["T_WHITESPACE"," ",329],"(",["T_VARIABLE","$quote",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","isMultipleShippingAddresses",329],"(",")",")",["T_WHITESPACE"," ",329],"{",["T_WHITESPACE","\n            ",329],["T_VARIABLE","$quote",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","removeAllAddresses",330],"(",")",";",["T_WHITESPACE","\n            ",330],["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","quoteRepository",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","save",331],"(",["T_VARIABLE","$quote",331],")",";",["T_WHITESPACE","\n        ",331],"}",["T_WHITESPACE","\n\n        ",332],["T_COMMENT","\/*\n         * want to load the correct customer information by assigning to address\n         * instead of just loading from sales\/quote_address\n         *\/",334],["T_WHITESPACE","\n        ",337],["T_VARIABLE","$customer",338],["T_WHITESPACE"," ",338],"=",["T_WHITESPACE"," ",338],["T_VARIABLE","$customerSession",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","getCustomerDataObject",338],"(",")",";",["T_WHITESPACE","\n        ",338],["T_IF","if",339],["T_WHITESPACE"," ",339],"(",["T_VARIABLE","$customer",339],")",["T_WHITESPACE"," ",339],"{",["T_WHITESPACE","\n            ",339],["T_VARIABLE","$quote",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","assignCustomer",340],"(",["T_VARIABLE","$customer",340],")",";",["T_WHITESPACE","\n        ",340],"}",["T_WHITESPACE","\n        ",341],["T_RETURN","return",342],["T_WHITESPACE"," ",342],["T_VARIABLE","$this",342],";",["T_WHITESPACE","\n    ",342],"}",["T_WHITESPACE","\n\n    ",343],["T_DOC_COMMENT","\/**\n     * Get quote checkout method\n     *\n     * @return string\n     *\/",345],["T_WHITESPACE","\n    ",349],["T_PUBLIC","public",350],["T_WHITESPACE"," ",350],["T_FUNCTION","function",350],["T_WHITESPACE"," ",350],["T_STRING","getCheckoutMethod",350],"(",")",["T_WHITESPACE","\n    ",350],"{",["T_WHITESPACE","\n        ",351],["T_IF","if",352],["T_WHITESPACE"," ",352],"(",["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","getCustomerSession",352],"(",")",["T_OBJECT_OPERATOR","->",352],["T_STRING","isLoggedIn",352],"(",")",")",["T_WHITESPACE"," ",352],"{",["T_WHITESPACE","\n            ",352],["T_RETURN","return",353],["T_WHITESPACE"," ",353],["T_STRING","self",353],["T_DOUBLE_COLON","::",353],["T_STRING","METHOD_CUSTOMER",353],";",["T_WHITESPACE","\n        ",353],"}",["T_WHITESPACE","\n        ",354],["T_IF","if",355],["T_WHITESPACE"," ",355],"(","!",["T_VARIABLE","$this",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","getQuote",355],"(",")",["T_OBJECT_OPERATOR","->",355],["T_STRING","getCheckoutMethod",355],"(",")",")",["T_WHITESPACE"," ",355],"{",["T_WHITESPACE","\n            ",355],["T_IF","if",356],["T_WHITESPACE"," ",356],"(",["T_VARIABLE","$this",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","_helper",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","isAllowedGuestCheckout",356],"(",["T_VARIABLE","$this",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","getQuote",356],"(",")",")",")",["T_WHITESPACE"," ",356],"{",["T_WHITESPACE","\n                ",356],["T_VARIABLE","$this",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","getQuote",357],"(",")",["T_OBJECT_OPERATOR","->",357],["T_STRING","setCheckoutMethod",357],"(",["T_STRING","self",357],["T_DOUBLE_COLON","::",357],["T_STRING","METHOD_GUEST",357],")",";",["T_WHITESPACE","\n            ",357],"}",["T_WHITESPACE"," ",358],["T_ELSE","else",358],["T_WHITESPACE"," ",358],"{",["T_WHITESPACE","\n                ",358],["T_VARIABLE","$this",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","getQuote",359],"(",")",["T_OBJECT_OPERATOR","->",359],["T_STRING","setCheckoutMethod",359],"(",["T_STRING","self",359],["T_DOUBLE_COLON","::",359],["T_STRING","METHOD_REGISTER",359],")",";",["T_WHITESPACE","\n            ",359],"}",["T_WHITESPACE","\n        ",360],"}",["T_WHITESPACE","\n        ",361],["T_RETURN","return",362],["T_WHITESPACE"," ",362],["T_VARIABLE","$this",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","getQuote",362],"(",")",["T_OBJECT_OPERATOR","->",362],["T_STRING","getCheckoutMethod",362],"(",")",";",["T_WHITESPACE","\n    ",362],"}",["T_WHITESPACE","\n\n    ",363],["T_DOC_COMMENT","\/**\n     * Specify checkout method\n     *\n     * @param   string $method\n     * @return  array\n     *\/",365],["T_WHITESPACE","\n    ",370],["T_PUBLIC","public",371],["T_WHITESPACE"," ",371],["T_FUNCTION","function",371],["T_WHITESPACE"," ",371],["T_STRING","saveCheckoutMethod",371],"(",["T_VARIABLE","$method",371],")",["T_WHITESPACE","\n    ",371],"{",["T_WHITESPACE","\n        ",372],["T_IF","if",373],["T_WHITESPACE"," ",373],"(",["T_EMPTY","empty",373],"(",["T_VARIABLE","$method",373],")",")",["T_WHITESPACE"," ",373],"{",["T_WHITESPACE","\n            ",373],["T_RETURN","return",374],["T_WHITESPACE"," ",374],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",374],["T_WHITESPACE"," ",374],["T_DOUBLE_ARROW","=>",374],["T_WHITESPACE"," ",374],"-",["T_LNUMBER","1",374],",",["T_WHITESPACE"," ",374],["T_CONSTANT_ENCAPSED_STRING","'message'",374],["T_WHITESPACE"," ",374],["T_DOUBLE_ARROW","=>",374],["T_WHITESPACE"," ",374],["T_STRING","__",374],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid data'",374],")","]",";",["T_WHITESPACE","\n        ",374],"}",["T_WHITESPACE","\n\n        ",375],["T_VARIABLE","$this",377],["T_OBJECT_OPERATOR","->",377],["T_STRING","quoteRepository",377],["T_OBJECT_OPERATOR","->",377],["T_STRING","save",377],"(",["T_VARIABLE","$this",377],["T_OBJECT_OPERATOR","->",377],["T_STRING","getQuote",377],"(",")",["T_OBJECT_OPERATOR","->",377],["T_STRING","setCheckoutMethod",377],"(",["T_VARIABLE","$method",377],")",")",";",["T_WHITESPACE","\n        ",377],["T_VARIABLE","$this",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","getCheckout",378],"(",")",["T_OBJECT_OPERATOR","->",378],["T_STRING","setStepData",378],"(",["T_CONSTANT_ENCAPSED_STRING","'billing'",378],",",["T_WHITESPACE"," ",378],["T_CONSTANT_ENCAPSED_STRING","'allow'",378],",",["T_WHITESPACE"," ",378],["T_STRING","true",378],")",";",["T_WHITESPACE","\n        ",378],["T_RETURN","return",379],["T_WHITESPACE"," ",379],"[","]",";",["T_WHITESPACE","\n    ",379],"}",["T_WHITESPACE","\n\n    ",380],["T_DOC_COMMENT","\/**\n     * Check whether checkout method is \"register\"\n     *\n     * @return bool\n     *\/",382],["T_WHITESPACE","\n    ",386],["T_PROTECTED","protected",387],["T_WHITESPACE"," ",387],["T_FUNCTION","function",387],["T_WHITESPACE"," ",387],["T_STRING","isCheckoutMethodRegister",387],"(",")",["T_WHITESPACE","\n    ",387],"{",["T_WHITESPACE","\n        ",388],["T_RETURN","return",389],["T_WHITESPACE"," ",389],["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","getQuote",389],"(",")",["T_OBJECT_OPERATOR","->",389],["T_STRING","getCheckoutMethod",389],"(",")",["T_WHITESPACE"," ",389],["T_IS_EQUAL","==",389],["T_WHITESPACE"," ",389],["T_STRING","self",389],["T_DOUBLE_COLON","::",389],["T_STRING","METHOD_REGISTER",389],";",["T_WHITESPACE","\n    ",389],"}",["T_WHITESPACE","\n\n    ",390],["T_DOC_COMMENT","\/**\n     * Save checkout shipping address\n     *\n     * @param   array $data\n     * @param   int $customerAddressId\n     * @return  array\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     * @SuppressWarnings(PHPMD.NPathComplexity)\n     *\/",392],["T_WHITESPACE","\n    ",400],["T_PUBLIC","public",401],["T_WHITESPACE"," ",401],["T_FUNCTION","function",401],["T_WHITESPACE"," ",401],["T_STRING","saveShipping",401],"(",["T_VARIABLE","$data",401],",",["T_WHITESPACE"," ",401],["T_VARIABLE","$customerAddressId",401],")",["T_WHITESPACE","\n    ",401],"{",["T_WHITESPACE","\n        ",402],["T_IF","if",403],["T_WHITESPACE"," ",403],"(",["T_EMPTY","empty",403],"(",["T_VARIABLE","$data",403],")",")",["T_WHITESPACE"," ",403],"{",["T_WHITESPACE","\n            ",403],["T_RETURN","return",404],["T_WHITESPACE"," ",404],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",404],["T_WHITESPACE"," ",404],["T_DOUBLE_ARROW","=>",404],["T_WHITESPACE"," ",404],"-",["T_LNUMBER","1",404],",",["T_WHITESPACE"," ",404],["T_CONSTANT_ENCAPSED_STRING","'message'",404],["T_WHITESPACE"," ",404],["T_DOUBLE_ARROW","=>",404],["T_WHITESPACE"," ",404],["T_STRING","__",404],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid data'",404],")","]",";",["T_WHITESPACE","\n        ",404],"}",["T_WHITESPACE","\n        ",405],["T_VARIABLE","$address",406],["T_WHITESPACE"," ",406],"=",["T_WHITESPACE"," ",406],["T_VARIABLE","$this",406],["T_OBJECT_OPERATOR","->",406],["T_STRING","getQuote",406],"(",")",["T_OBJECT_OPERATOR","->",406],["T_STRING","getShippingAddress",406],"(",")",";",["T_WHITESPACE","\n\n        ",406],["T_VARIABLE","$addressForm",408],["T_WHITESPACE"," ",408],"=",["T_WHITESPACE"," ",408],["T_VARIABLE","$this",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","_formFactory",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","create",408],"(",["T_WHITESPACE","\n            ",408],["T_NS_SEPARATOR","\\",409],["T_STRING","customer_address",409],["T_DOUBLE_COLON","::",409],["T_CLASS","class",409],",",["T_WHITESPACE","\n            ",409],["T_CONSTANT_ENCAPSED_STRING","'customer_address_edit'",410],",",["T_WHITESPACE","\n            ",410],"[","]",",",["T_WHITESPACE","\n            ",411],["T_VARIABLE","$this",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","_request",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","isAjax",412],"(",")",",",["T_WHITESPACE","\n            ",412],["T_STRING","Form",413],["T_DOUBLE_COLON","::",413],["T_STRING","IGNORE_INVISIBLE",413],",",["T_WHITESPACE","\n            ",413],"[","]",["T_WHITESPACE","\n        ",414],")",";",["T_WHITESPACE","\n\n        ",415],["T_IF","if",417],["T_WHITESPACE"," ",417],"(","!",["T_EMPTY","empty",417],"(",["T_VARIABLE","$customerAddressId",417],")",")",["T_WHITESPACE"," ",417],"{",["T_WHITESPACE","\n            ",417],["T_VARIABLE","$addressData",418],["T_WHITESPACE"," ",418],"=",["T_WHITESPACE"," ",418],["T_STRING","null",418],";",["T_WHITESPACE","\n            ",418],["T_TRY","try",419],["T_WHITESPACE"," ",419],"{",["T_WHITESPACE","\n                ",419],["T_VARIABLE","$addressData",420],["T_WHITESPACE"," ",420],"=",["T_WHITESPACE"," ",420],["T_VARIABLE","$this",420],["T_OBJECT_OPERATOR","->",420],["T_STRING","addressRepository",420],["T_OBJECT_OPERATOR","->",420],["T_STRING","getById",420],"(",["T_VARIABLE","$customerAddressId",420],")",";",["T_WHITESPACE","\n            ",420],"}",["T_WHITESPACE"," ",421],["T_CATCH","catch",421],["T_WHITESPACE"," ",421],"(",["T_STRING","NoSuchEntityException",421],["T_WHITESPACE"," ",421],["T_VARIABLE","$e",421],")",["T_WHITESPACE"," ",421],"{",["T_WHITESPACE","\n                ",421],["T_COMMENT","\/\/ do nothing if customer is not found by id\n",422],["T_WHITESPACE","            ",423],"}",["T_WHITESPACE","\n\n            ",423],["T_IF","if",425],["T_WHITESPACE"," ",425],"(",["T_VARIABLE","$addressData",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","getCustomerId",425],"(",")",["T_WHITESPACE"," ",425],["T_IS_NOT_EQUAL","!=",425],["T_WHITESPACE"," ",425],["T_VARIABLE","$this",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","getQuote",425],"(",")",["T_OBJECT_OPERATOR","->",425],["T_STRING","getCustomerId",425],"(",")",")",["T_WHITESPACE"," ",425],"{",["T_WHITESPACE","\n                ",425],["T_RETURN","return",426],["T_WHITESPACE"," ",426],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",426],["T_WHITESPACE"," ",426],["T_DOUBLE_ARROW","=>",426],["T_WHITESPACE"," ",426],["T_LNUMBER","1",426],",",["T_WHITESPACE"," ",426],["T_CONSTANT_ENCAPSED_STRING","'message'",426],["T_WHITESPACE"," ",426],["T_DOUBLE_ARROW","=>",426],["T_WHITESPACE"," ",426],["T_STRING","__",426],"(",["T_CONSTANT_ENCAPSED_STRING","'The customer address is not valid.'",426],")","]",";",["T_WHITESPACE","\n            ",426],"}",["T_WHITESPACE","\n\n            ",427],["T_VARIABLE","$address",429],["T_OBJECT_OPERATOR","->",429],["T_STRING","importCustomerAddressData",429],"(",["T_VARIABLE","$addressData",429],")",["T_OBJECT_OPERATOR","->",429],["T_STRING","setSaveInAddressBook",429],"(",["T_LNUMBER","0",429],")",";",["T_WHITESPACE","\n            ",429],["T_VARIABLE","$addressErrors",430],["T_WHITESPACE"," ",430],"=",["T_WHITESPACE"," ",430],["T_VARIABLE","$addressForm",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","validateData",430],"(",["T_VARIABLE","$address",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","getData",430],"(",")",")",";",["T_WHITESPACE","\n            ",430],["T_IF","if",431],["T_WHITESPACE"," ",431],"(",["T_VARIABLE","$addressErrors",431],["T_WHITESPACE"," ",431],["T_IS_NOT_IDENTICAL","!==",431],["T_WHITESPACE"," ",431],["T_STRING","true",431],")",["T_WHITESPACE"," ",431],"{",["T_WHITESPACE","\n                ",431],["T_RETURN","return",432],["T_WHITESPACE"," ",432],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",432],["T_WHITESPACE"," ",432],["T_DOUBLE_ARROW","=>",432],["T_WHITESPACE"," ",432],["T_LNUMBER","1",432],",",["T_WHITESPACE"," ",432],["T_CONSTANT_ENCAPSED_STRING","'message'",432],["T_WHITESPACE"," ",432],["T_DOUBLE_ARROW","=>",432],["T_WHITESPACE"," ",432],["T_VARIABLE","$addressErrors",432],"]",";",["T_WHITESPACE","\n            ",432],"}",["T_WHITESPACE","\n        ",433],"}",["T_WHITESPACE"," ",434],["T_ELSE","else",434],["T_WHITESPACE"," ",434],"{",["T_WHITESPACE","\n            ",434],["T_COMMENT","\/\/ emulate request object\n",435],["T_WHITESPACE","            ",436],["T_VARIABLE","$addressData",436],["T_WHITESPACE"," ",436],"=",["T_WHITESPACE"," ",436],["T_VARIABLE","$addressForm",436],["T_OBJECT_OPERATOR","->",436],["T_STRING","extractData",436],"(",["T_VARIABLE","$addressForm",436],["T_OBJECT_OPERATOR","->",436],["T_STRING","prepareRequest",436],"(",["T_VARIABLE","$data",436],")",")",";",["T_WHITESPACE","\n            ",436],["T_VARIABLE","$addressErrors",437],["T_WHITESPACE"," ",437],"=",["T_WHITESPACE"," ",437],["T_VARIABLE","$addressForm",437],["T_OBJECT_OPERATOR","->",437],["T_STRING","validateData",437],"(",["T_VARIABLE","$addressData",437],")",";",["T_WHITESPACE","\n            ",437],["T_IF","if",438],["T_WHITESPACE"," ",438],"(",["T_VARIABLE","$addressErrors",438],["T_WHITESPACE"," ",438],["T_IS_NOT_IDENTICAL","!==",438],["T_WHITESPACE"," ",438],["T_STRING","true",438],")",["T_WHITESPACE"," ",438],"{",["T_WHITESPACE","\n                ",438],["T_RETURN","return",439],["T_WHITESPACE"," ",439],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",439],["T_WHITESPACE"," ",439],["T_DOUBLE_ARROW","=>",439],["T_WHITESPACE"," ",439],["T_LNUMBER","1",439],",",["T_WHITESPACE"," ",439],["T_CONSTANT_ENCAPSED_STRING","'message'",439],["T_WHITESPACE"," ",439],["T_DOUBLE_ARROW","=>",439],["T_WHITESPACE"," ",439],["T_VARIABLE","$addressErrors",439],"]",";",["T_WHITESPACE","\n            ",439],"}",["T_WHITESPACE","\n            ",440],["T_VARIABLE","$compactedData",441],["T_WHITESPACE"," ",441],"=",["T_WHITESPACE"," ",441],["T_VARIABLE","$addressForm",441],["T_OBJECT_OPERATOR","->",441],["T_STRING","compactData",441],"(",["T_VARIABLE","$addressData",441],")",";",["T_WHITESPACE","\n            ",441],["T_COMMENT","\/\/ unset shipping address attributes which were not shown in form\n",442],["T_WHITESPACE","            ",443],["T_FOREACH","foreach",443],["T_WHITESPACE"," ",443],"(",["T_VARIABLE","$addressForm",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","getAttributes",443],"(",")",["T_WHITESPACE"," ",443],["T_AS","as",443],["T_WHITESPACE"," ",443],["T_VARIABLE","$attribute",443],")",["T_WHITESPACE"," ",443],"{",["T_WHITESPACE","\n                ",443],["T_VARIABLE","$attributeCode",444],["T_WHITESPACE"," ",444],"=",["T_WHITESPACE"," ",444],["T_VARIABLE","$attribute",444],["T_OBJECT_OPERATOR","->",444],["T_STRING","getAttributeCode",444],"(",")",";",["T_WHITESPACE","\n                ",444],["T_IF","if",445],["T_WHITESPACE"," ",445],"(","!",["T_ISSET","isset",445],"(",["T_VARIABLE","$data",445],"[",["T_VARIABLE","$attributeCode",445],"]",")",")",["T_WHITESPACE"," ",445],"{",["T_WHITESPACE","\n                    ",445],["T_VARIABLE","$address",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","setData",446],"(",["T_VARIABLE","$attributeCode",446],",",["T_WHITESPACE"," ",446],["T_STRING","null",446],")",";",["T_WHITESPACE","\n                ",446],"}",["T_WHITESPACE"," ",447],["T_ELSE","else",447],["T_WHITESPACE"," ",447],"{",["T_WHITESPACE","\n                    ",447],["T_IF","if",448],["T_WHITESPACE"," ",448],"(",["T_ISSET","isset",448],"(",["T_VARIABLE","$compactedData",448],"[",["T_VARIABLE","$attributeCode",448],"]",")",")",["T_WHITESPACE"," ",448],"{",["T_WHITESPACE","\n                        ",448],["T_VARIABLE","$address",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","setDataUsingMethod",449],"(",["T_VARIABLE","$attributeCode",449],",",["T_WHITESPACE"," ",449],["T_VARIABLE","$compactedData",449],"[",["T_VARIABLE","$attributeCode",449],"]",")",";",["T_WHITESPACE","\n                    ",449],"}",["T_WHITESPACE","\n                ",450],"}",["T_WHITESPACE","\n            ",451],"}",["T_WHITESPACE","\n\n            ",452],["T_VARIABLE","$address",454],["T_OBJECT_OPERATOR","->",454],["T_STRING","setCustomerAddressId",454],"(",["T_STRING","null",454],")",";",["T_WHITESPACE","\n            ",454],["T_COMMENT","\/\/ Additional form data, not fetched by extractData (as it fetches only attributes)\n",455],["T_WHITESPACE","            ",456],["T_VARIABLE","$address",456],["T_OBJECT_OPERATOR","->",456],["T_STRING","setSaveInAddressBook",456],"(",["T_EMPTY","empty",456],"(",["T_VARIABLE","$data",456],"[",["T_CONSTANT_ENCAPSED_STRING","'save_in_address_book'",456],"]",")",["T_WHITESPACE"," ",456],"?",["T_WHITESPACE"," ",456],["T_LNUMBER","0",456],["T_WHITESPACE"," ",456],":",["T_WHITESPACE"," ",456],["T_LNUMBER","1",456],")",";",["T_WHITESPACE","\n            ",456],["T_VARIABLE","$address",457],["T_OBJECT_OPERATOR","->",457],["T_STRING","setSameAsBilling",457],"(",["T_EMPTY","empty",457],"(",["T_VARIABLE","$data",457],"[",["T_CONSTANT_ENCAPSED_STRING","'same_as_billing'",457],"]",")",["T_WHITESPACE"," ",457],"?",["T_WHITESPACE"," ",457],["T_LNUMBER","0",457],["T_WHITESPACE"," ",457],":",["T_WHITESPACE"," ",457],["T_LNUMBER","1",457],")",";",["T_WHITESPACE","\n        ",457],"}",["T_WHITESPACE","\n\n        ",458],["T_VARIABLE","$address",460],["T_OBJECT_OPERATOR","->",460],["T_STRING","setCollectShippingRates",460],"(",["T_STRING","true",460],")",";",["T_WHITESPACE","\n\n        ",460],["T_IF","if",462],["T_WHITESPACE"," ",462],"(","(",["T_VARIABLE","$validateRes",462],["T_WHITESPACE"," ",462],"=",["T_WHITESPACE"," ",462],["T_VARIABLE","$address",462],["T_OBJECT_OPERATOR","->",462],["T_STRING","validate",462],"(",")",")",["T_WHITESPACE"," ",462],["T_IS_NOT_IDENTICAL","!==",462],["T_WHITESPACE"," ",462],["T_STRING","true",462],")",["T_WHITESPACE"," ",462],"{",["T_WHITESPACE","\n            ",462],["T_RETURN","return",463],["T_WHITESPACE"," ",463],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",463],["T_WHITESPACE"," ",463],["T_DOUBLE_ARROW","=>",463],["T_WHITESPACE"," ",463],["T_LNUMBER","1",463],",",["T_WHITESPACE"," ",463],["T_CONSTANT_ENCAPSED_STRING","'message'",463],["T_WHITESPACE"," ",463],["T_DOUBLE_ARROW","=>",463],["T_WHITESPACE"," ",463],["T_VARIABLE","$validateRes",463],"]",";",["T_WHITESPACE","\n        ",463],"}",["T_WHITESPACE","\n\n        ",464],["T_VARIABLE","$this",466],["T_OBJECT_OPERATOR","->",466],["T_STRING","totalsCollector",466],["T_OBJECT_OPERATOR","->",466],["T_STRING","collectAddressTotals",466],"(",["T_VARIABLE","$this",466],["T_OBJECT_OPERATOR","->",466],["T_STRING","getQuote",466],"(",")",",",["T_WHITESPACE"," ",466],["T_VARIABLE","$address",466],")",";",["T_WHITESPACE","\n        ",466],["T_VARIABLE","$address",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","save",467],"(",")",";",["T_WHITESPACE","\n\n        ",467],["T_VARIABLE","$this",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","getCheckout",469],"(",")",["T_OBJECT_OPERATOR","->",469],["T_STRING","setStepData",469],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping'",469],",",["T_WHITESPACE"," ",469],["T_CONSTANT_ENCAPSED_STRING","'complete'",469],",",["T_WHITESPACE"," ",469],["T_STRING","true",469],")",["T_OBJECT_OPERATOR","->",469],["T_STRING","setStepData",469],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",469],",",["T_WHITESPACE"," ",469],["T_CONSTANT_ENCAPSED_STRING","'allow'",469],",",["T_WHITESPACE"," ",469],["T_STRING","true",469],")",";",["T_WHITESPACE","\n\n        ",469],["T_RETURN","return",471],["T_WHITESPACE"," ",471],"[","]",";",["T_WHITESPACE","\n    ",471],"}",["T_WHITESPACE","\n\n    ",472],["T_DOC_COMMENT","\/**\n     * Specify quote shipping method\n     *\n     * @param   string $shippingMethod\n     * @return  array\n     *\/",474],["T_WHITESPACE","\n    ",479],["T_PUBLIC","public",480],["T_WHITESPACE"," ",480],["T_FUNCTION","function",480],["T_WHITESPACE"," ",480],["T_STRING","saveShippingMethod",480],"(",["T_VARIABLE","$shippingMethod",480],")",["T_WHITESPACE","\n    ",480],"{",["T_WHITESPACE","\n        ",481],["T_IF","if",482],["T_WHITESPACE"," ",482],"(",["T_EMPTY","empty",482],"(",["T_VARIABLE","$shippingMethod",482],")",")",["T_WHITESPACE"," ",482],"{",["T_WHITESPACE","\n            ",482],["T_RETURN","return",483],["T_WHITESPACE"," ",483],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",483],["T_WHITESPACE"," ",483],["T_DOUBLE_ARROW","=>",483],["T_WHITESPACE"," ",483],"-",["T_LNUMBER","1",483],",",["T_WHITESPACE"," ",483],["T_CONSTANT_ENCAPSED_STRING","'message'",483],["T_WHITESPACE"," ",483],["T_DOUBLE_ARROW","=>",483],["T_WHITESPACE"," ",483],["T_STRING","__",483],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid shipping method'",483],")","]",";",["T_WHITESPACE","\n        ",483],"}",["T_WHITESPACE","\n        ",484],["T_VARIABLE","$shippingAddress",485],["T_WHITESPACE"," ",485],"=",["T_WHITESPACE"," ",485],["T_VARIABLE","$this",485],["T_OBJECT_OPERATOR","->",485],["T_STRING","getQuote",485],"(",")",["T_OBJECT_OPERATOR","->",485],["T_STRING","getShippingAddress",485],"(",")",";",["T_WHITESPACE","\n        ",485],["T_VARIABLE","$rate",486],["T_WHITESPACE"," ",486],"=",["T_WHITESPACE"," ",486],["T_VARIABLE","$shippingAddress",486],["T_OBJECT_OPERATOR","->",486],["T_STRING","getShippingRateByCode",486],"(",["T_VARIABLE","$shippingMethod",486],")",";",["T_WHITESPACE","\n        ",486],["T_IF","if",487],["T_WHITESPACE"," ",487],"(","!",["T_VARIABLE","$rate",487],")",["T_WHITESPACE"," ",487],"{",["T_WHITESPACE","\n            ",487],["T_RETURN","return",488],["T_WHITESPACE"," ",488],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",488],["T_WHITESPACE"," ",488],["T_DOUBLE_ARROW","=>",488],["T_WHITESPACE"," ",488],"-",["T_LNUMBER","1",488],",",["T_WHITESPACE"," ",488],["T_CONSTANT_ENCAPSED_STRING","'message'",488],["T_WHITESPACE"," ",488],["T_DOUBLE_ARROW","=>",488],["T_WHITESPACE"," ",488],["T_STRING","__",488],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid shipping method'",488],")","]",";",["T_WHITESPACE","\n        ",488],"}",["T_WHITESPACE"," ",489],["T_ELSE","else",489],["T_WHITESPACE"," ",489],"{",["T_WHITESPACE","\n            ",489],["T_VARIABLE","$shippingDescription",490],["T_WHITESPACE"," ",490],"=",["T_WHITESPACE"," ",490],["T_VARIABLE","$rate",490],["T_OBJECT_OPERATOR","->",490],["T_STRING","getCarrierTitle",490],"(",")",["T_WHITESPACE"," ",490],".",["T_WHITESPACE"," ",490],["T_CONSTANT_ENCAPSED_STRING","' - '",490],["T_WHITESPACE"," ",490],".",["T_WHITESPACE"," ",490],["T_VARIABLE","$rate",490],["T_OBJECT_OPERATOR","->",490],["T_STRING","getMethodTitle",490],"(",")",";",["T_WHITESPACE","\n            ",490],["T_VARIABLE","$shippingAddress",491],["T_OBJECT_OPERATOR","->",491],["T_STRING","setShippingDescription",491],"(",["T_STRING","trim",491],"(",["T_VARIABLE","$shippingDescription",491],",",["T_WHITESPACE"," ",491],["T_CONSTANT_ENCAPSED_STRING","' -'",491],")",")",";",["T_WHITESPACE","\n        ",491],"}",["T_WHITESPACE","\n        ",492],["T_VARIABLE","$shippingAddress",493],["T_OBJECT_OPERATOR","->",493],["T_STRING","setShippingMethod",493],"(",["T_VARIABLE","$shippingMethod",493],")",["T_OBJECT_OPERATOR","->",493],["T_STRING","save",493],"(",")",";",["T_WHITESPACE","\n\n        ",493],["T_VARIABLE","$this",495],["T_OBJECT_OPERATOR","->",495],["T_STRING","getCheckout",495],"(",")",["T_OBJECT_OPERATOR","->",495],["T_STRING","setStepData",495],"(",["T_CONSTANT_ENCAPSED_STRING","'shipping_method'",495],",",["T_WHITESPACE"," ",495],["T_CONSTANT_ENCAPSED_STRING","'complete'",495],",",["T_WHITESPACE"," ",495],["T_STRING","true",495],")",["T_OBJECT_OPERATOR","->",495],["T_STRING","setStepData",495],"(",["T_CONSTANT_ENCAPSED_STRING","'payment'",495],",",["T_WHITESPACE"," ",495],["T_CONSTANT_ENCAPSED_STRING","'allow'",495],",",["T_WHITESPACE"," ",495],["T_STRING","true",495],")",";",["T_WHITESPACE","\n\n        ",495],["T_RETURN","return",497],["T_WHITESPACE"," ",497],"[","]",";",["T_WHITESPACE","\n    ",497],"}",["T_WHITESPACE","\n\n    ",498],["T_DOC_COMMENT","\/**\n     * Specify quote payment method\n     *\n     * @param   array $data\n     * @return  array\n     *\/",500],["T_WHITESPACE","\n    ",505],["T_PUBLIC","public",506],["T_WHITESPACE"," ",506],["T_FUNCTION","function",506],["T_WHITESPACE"," ",506],["T_STRING","savePayment",506],"(",["T_VARIABLE","$data",506],")",["T_WHITESPACE","\n    ",506],"{",["T_WHITESPACE","\n        ",507],["T_IF","if",508],["T_WHITESPACE"," ",508],"(",["T_EMPTY","empty",508],"(",["T_VARIABLE","$data",508],")",")",["T_WHITESPACE"," ",508],"{",["T_WHITESPACE","\n            ",508],["T_RETURN","return",509],["T_WHITESPACE"," ",509],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",509],["T_WHITESPACE"," ",509],["T_DOUBLE_ARROW","=>",509],["T_WHITESPACE"," ",509],"-",["T_LNUMBER","1",509],",",["T_WHITESPACE"," ",509],["T_CONSTANT_ENCAPSED_STRING","'message'",509],["T_WHITESPACE"," ",509],["T_DOUBLE_ARROW","=>",509],["T_WHITESPACE"," ",509],["T_STRING","__",509],"(",["T_CONSTANT_ENCAPSED_STRING","'Invalid data'",509],")","]",";",["T_WHITESPACE","\n        ",509],"}",["T_WHITESPACE","\n        ",510],["T_VARIABLE","$quote",511],["T_WHITESPACE"," ",511],"=",["T_WHITESPACE"," ",511],["T_VARIABLE","$this",511],["T_OBJECT_OPERATOR","->",511],["T_STRING","getQuote",511],"(",")",";",["T_WHITESPACE","\n\n        ",511],["T_COMMENT","\/\/ shipping totals may be affected by payment method\n",513],["T_WHITESPACE","        ",514],["T_IF","if",514],["T_WHITESPACE"," ",514],"(","!",["T_VARIABLE","$quote",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","isVirtual",514],"(",")",["T_WHITESPACE"," ",514],["T_BOOLEAN_AND","&&",514],["T_WHITESPACE"," ",514],["T_VARIABLE","$quote",514],["T_OBJECT_OPERATOR","->",514],["T_STRING","getShippingAddress",514],"(",")",")",["T_WHITESPACE"," ",514],"{",["T_WHITESPACE","\n            ",514],["T_VARIABLE","$quote",515],["T_OBJECT_OPERATOR","->",515],["T_STRING","getShippingAddress",515],"(",")",["T_OBJECT_OPERATOR","->",515],["T_STRING","setCollectShippingRates",515],"(",["T_STRING","true",515],")",";",["T_WHITESPACE","\n        ",515],"}",["T_WHITESPACE","\n\n        ",516],["T_VARIABLE","$data",518],"[",["T_CONSTANT_ENCAPSED_STRING","'checks'",518],"]",["T_WHITESPACE"," ",518],"=",["T_WHITESPACE"," ",518],"[",["T_WHITESPACE","\n            ",518],["T_NS_SEPARATOR","\\",519],["T_STRING","Magento",519],["T_NS_SEPARATOR","\\",519],["T_STRING","Payment",519],["T_NS_SEPARATOR","\\",519],["T_STRING","Model",519],["T_NS_SEPARATOR","\\",519],["T_STRING","Method",519],["T_NS_SEPARATOR","\\",519],["T_STRING","AbstractMethod",519],["T_DOUBLE_COLON","::",519],["T_STRING","CHECK_USE_CHECKOUT",519],",",["T_WHITESPACE","\n            ",519],["T_NS_SEPARATOR","\\",520],["T_STRING","Magento",520],["T_NS_SEPARATOR","\\",520],["T_STRING","Payment",520],["T_NS_SEPARATOR","\\",520],["T_STRING","Model",520],["T_NS_SEPARATOR","\\",520],["T_STRING","Method",520],["T_NS_SEPARATOR","\\",520],["T_STRING","AbstractMethod",520],["T_DOUBLE_COLON","::",520],["T_STRING","CHECK_USE_FOR_COUNTRY",520],",",["T_WHITESPACE","\n            ",520],["T_NS_SEPARATOR","\\",521],["T_STRING","Magento",521],["T_NS_SEPARATOR","\\",521],["T_STRING","Payment",521],["T_NS_SEPARATOR","\\",521],["T_STRING","Model",521],["T_NS_SEPARATOR","\\",521],["T_STRING","Method",521],["T_NS_SEPARATOR","\\",521],["T_STRING","AbstractMethod",521],["T_DOUBLE_COLON","::",521],["T_STRING","CHECK_USE_FOR_CURRENCY",521],",",["T_WHITESPACE","\n            ",521],["T_NS_SEPARATOR","\\",522],["T_STRING","Magento",522],["T_NS_SEPARATOR","\\",522],["T_STRING","Payment",522],["T_NS_SEPARATOR","\\",522],["T_STRING","Model",522],["T_NS_SEPARATOR","\\",522],["T_STRING","Method",522],["T_NS_SEPARATOR","\\",522],["T_STRING","AbstractMethod",522],["T_DOUBLE_COLON","::",522],["T_STRING","CHECK_ORDER_TOTAL_MIN_MAX",522],",",["T_WHITESPACE","\n            ",522],["T_NS_SEPARATOR","\\",523],["T_STRING","Magento",523],["T_NS_SEPARATOR","\\",523],["T_STRING","Payment",523],["T_NS_SEPARATOR","\\",523],["T_STRING","Model",523],["T_NS_SEPARATOR","\\",523],["T_STRING","Method",523],["T_NS_SEPARATOR","\\",523],["T_STRING","AbstractMethod",523],["T_DOUBLE_COLON","::",523],["T_STRING","CHECK_ZERO_TOTAL",523],",",["T_WHITESPACE","\n        ",523],"]",";",["T_WHITESPACE","\n\n        ",524],["T_VARIABLE","$payment",526],["T_WHITESPACE"," ",526],"=",["T_WHITESPACE"," ",526],["T_VARIABLE","$quote",526],["T_OBJECT_OPERATOR","->",526],["T_STRING","getPayment",526],"(",")",";",["T_WHITESPACE","\n        ",526],["T_VARIABLE","$payment",527],["T_OBJECT_OPERATOR","->",527],["T_STRING","importData",527],"(",["T_VARIABLE","$data",527],")",";",["T_WHITESPACE","\n\n        ",527],["T_VARIABLE","$this",529],["T_OBJECT_OPERATOR","->",529],["T_STRING","quoteRepository",529],["T_OBJECT_OPERATOR","->",529],["T_STRING","save",529],"(",["T_VARIABLE","$quote",529],")",";",["T_WHITESPACE","\n\n        ",529],["T_VARIABLE","$this",531],["T_OBJECT_OPERATOR","->",531],["T_STRING","getCheckout",531],"(",")",["T_OBJECT_OPERATOR","->",531],["T_STRING","setStepData",531],"(",["T_CONSTANT_ENCAPSED_STRING","'payment'",531],",",["T_WHITESPACE"," ",531],["T_CONSTANT_ENCAPSED_STRING","'complete'",531],",",["T_WHITESPACE"," ",531],["T_STRING","true",531],")",["T_OBJECT_OPERATOR","->",531],["T_STRING","setStepData",531],"(",["T_CONSTANT_ENCAPSED_STRING","'review'",531],",",["T_WHITESPACE"," ",531],["T_CONSTANT_ENCAPSED_STRING","'allow'",531],",",["T_WHITESPACE"," ",531],["T_STRING","true",531],")",";",["T_WHITESPACE","\n\n        ",531],["T_RETURN","return",533],["T_WHITESPACE"," ",533],"[","]",";",["T_WHITESPACE","\n    ",533],"}",["T_WHITESPACE","\n\n    ",534],["T_DOC_COMMENT","\/**\n     * Validate quote state to be integrated with one page checkout process\n     *\n     * @return void\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     *\/",536],["T_WHITESPACE","\n    ",541],["T_PROTECTED","protected",542],["T_WHITESPACE"," ",542],["T_FUNCTION","function",542],["T_WHITESPACE"," ",542],["T_STRING","validate",542],"(",")",["T_WHITESPACE","\n    ",542],"{",["T_WHITESPACE","\n        ",543],["T_VARIABLE","$quote",544],["T_WHITESPACE"," ",544],"=",["T_WHITESPACE"," ",544],["T_VARIABLE","$this",544],["T_OBJECT_OPERATOR","->",544],["T_STRING","getQuote",544],"(",")",";",["T_WHITESPACE","\n\n        ",544],["T_IF","if",546],["T_WHITESPACE"," ",546],"(",["T_VARIABLE","$quote",546],["T_OBJECT_OPERATOR","->",546],["T_STRING","isMultipleShippingAddresses",546],"(",")",")",["T_WHITESPACE"," ",546],"{",["T_WHITESPACE","\n            ",546],["T_THROW","throw",547],["T_WHITESPACE"," ",547],["T_NEW","new",547],["T_WHITESPACE"," ",547],["T_NS_SEPARATOR","\\",547],["T_STRING","Magento",547],["T_NS_SEPARATOR","\\",547],["T_STRING","Framework",547],["T_NS_SEPARATOR","\\",547],["T_STRING","Exception",547],["T_NS_SEPARATOR","\\",547],["T_STRING","LocalizedException",547],"(",["T_WHITESPACE","\n                ",547],["T_STRING","__",548],"(",["T_CONSTANT_ENCAPSED_STRING","'There are more than one shipping addresses.'",548],")",["T_WHITESPACE","\n            ",548],")",";",["T_WHITESPACE","\n        ",549],"}",["T_WHITESPACE","\n\n        ",550],["T_IF","if",552],["T_WHITESPACE"," ",552],"(",["T_VARIABLE","$quote",552],["T_OBJECT_OPERATOR","->",552],["T_STRING","getCheckoutMethod",552],"(",")",["T_WHITESPACE"," ",552],["T_IS_EQUAL","==",552],["T_WHITESPACE"," ",552],["T_STRING","self",552],["T_DOUBLE_COLON","::",552],["T_STRING","METHOD_GUEST",552],["T_WHITESPACE"," ",552],["T_BOOLEAN_AND","&&",552],["T_WHITESPACE"," ",552],"!",["T_VARIABLE","$this",552],["T_OBJECT_OPERATOR","->",552],["T_STRING","_helper",552],["T_OBJECT_OPERATOR","->",552],["T_STRING","isAllowedGuestCheckout",552],"(",["T_VARIABLE","$quote",552],")",")",["T_WHITESPACE"," ",552],"{",["T_WHITESPACE","\n            ",552],["T_THROW","throw",553],["T_WHITESPACE"," ",553],["T_NEW","new",553],["T_WHITESPACE"," ",553],["T_NS_SEPARATOR","\\",553],["T_STRING","Magento",553],["T_NS_SEPARATOR","\\",553],["T_STRING","Framework",553],["T_NS_SEPARATOR","\\",553],["T_STRING","Exception",553],["T_NS_SEPARATOR","\\",553],["T_STRING","LocalizedException",553],"(",["T_STRING","__",553],"(",["T_CONSTANT_ENCAPSED_STRING","'Sorry, guest checkout is not available.'",553],")",")",";",["T_WHITESPACE","\n        ",553],"}",["T_WHITESPACE","\n    ",554],"}",["T_WHITESPACE","\n\n    ",555],["T_DOC_COMMENT","\/**\n     * Prepare quote for guest checkout order submit\n     *\n     * @return $this\n     *\/",557],["T_WHITESPACE","\n    ",561],["T_PROTECTED","protected",562],["T_WHITESPACE"," ",562],["T_FUNCTION","function",562],["T_WHITESPACE"," ",562],["T_STRING","_prepareGuestQuote",562],"(",")",["T_WHITESPACE","\n    ",562],"{",["T_WHITESPACE","\n        ",563],["T_VARIABLE","$quote",564],["T_WHITESPACE"," ",564],"=",["T_WHITESPACE"," ",564],["T_VARIABLE","$this",564],["T_OBJECT_OPERATOR","->",564],["T_STRING","getQuote",564],"(",")",";",["T_WHITESPACE","\n        ",564],["T_VARIABLE","$quote",565],["T_OBJECT_OPERATOR","->",565],["T_STRING","setCustomerId",565],"(",["T_STRING","null",565],")",["T_WHITESPACE","\n            ",565],["T_OBJECT_OPERATOR","->",566],["T_STRING","setCustomerEmail",566],"(",["T_VARIABLE","$quote",566],["T_OBJECT_OPERATOR","->",566],["T_STRING","getBillingAddress",566],"(",")",["T_OBJECT_OPERATOR","->",566],["T_STRING","getEmail",566],"(",")",")",["T_WHITESPACE","\n            ",566],["T_OBJECT_OPERATOR","->",567],["T_STRING","setCustomerIsGuest",567],"(",["T_STRING","true",567],")",["T_WHITESPACE","\n            ",567],["T_OBJECT_OPERATOR","->",568],["T_STRING","setCustomerGroupId",568],"(",["T_STRING","GroupInterface",568],["T_DOUBLE_COLON","::",568],["T_STRING","NOT_LOGGED_IN_ID",568],")",";",["T_WHITESPACE","\n        ",568],["T_RETURN","return",569],["T_WHITESPACE"," ",569],["T_VARIABLE","$this",569],";",["T_WHITESPACE","\n    ",569],"}",["T_WHITESPACE","\n\n    ",570],["T_DOC_COMMENT","\/**\n     * Prepare quote for customer registration and customer order submit\n     *\n     * @return void\n     *\/",572],["T_WHITESPACE","\n    ",576],["T_PROTECTED","protected",577],["T_WHITESPACE"," ",577],["T_FUNCTION","function",577],["T_WHITESPACE"," ",577],["T_STRING","_prepareNewCustomerQuote",577],"(",")",["T_WHITESPACE","\n    ",577],"{",["T_WHITESPACE","\n        ",578],["T_VARIABLE","$quote",579],["T_WHITESPACE"," ",579],"=",["T_WHITESPACE"," ",579],["T_VARIABLE","$this",579],["T_OBJECT_OPERATOR","->",579],["T_STRING","getQuote",579],"(",")",";",["T_WHITESPACE","\n        ",579],["T_VARIABLE","$billing",580],["T_WHITESPACE"," ",580],"=",["T_WHITESPACE"," ",580],["T_VARIABLE","$quote",580],["T_OBJECT_OPERATOR","->",580],["T_STRING","getBillingAddress",580],"(",")",";",["T_WHITESPACE","\n        ",580],["T_VARIABLE","$shipping",581],["T_WHITESPACE"," ",581],"=",["T_WHITESPACE"," ",581],["T_VARIABLE","$quote",581],["T_OBJECT_OPERATOR","->",581],["T_STRING","isVirtual",581],"(",")",["T_WHITESPACE"," ",581],"?",["T_WHITESPACE"," ",581],["T_STRING","null",581],["T_WHITESPACE"," ",581],":",["T_WHITESPACE"," ",581],["T_VARIABLE","$quote",581],["T_OBJECT_OPERATOR","->",581],["T_STRING","getShippingAddress",581],"(",")",";",["T_WHITESPACE","\n\n        ",581],["T_VARIABLE","$customer",583],["T_WHITESPACE"," ",583],"=",["T_WHITESPACE"," ",583],["T_VARIABLE","$quote",583],["T_OBJECT_OPERATOR","->",583],["T_STRING","getCustomer",583],"(",")",";",["T_WHITESPACE","\n        ",583],["T_VARIABLE","$customerBillingData",584],["T_WHITESPACE"," ",584],"=",["T_WHITESPACE"," ",584],["T_VARIABLE","$billing",584],["T_OBJECT_OPERATOR","->",584],["T_STRING","exportCustomerAddress",584],"(",")",";",["T_WHITESPACE","\n        ",584],["T_VARIABLE","$dataArray",585],["T_WHITESPACE"," ",585],"=",["T_WHITESPACE"," ",585],["T_VARIABLE","$this",585],["T_OBJECT_OPERATOR","->",585],["T_STRING","_objectCopyService",585],["T_OBJECT_OPERATOR","->",585],["T_STRING","getDataFromFieldset",585],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout_onepage_quote'",585],",",["T_WHITESPACE"," ",585],["T_CONSTANT_ENCAPSED_STRING","'to_customer'",585],",",["T_WHITESPACE"," ",585],["T_VARIABLE","$quote",585],")",";",["T_WHITESPACE","\n        ",585],["T_VARIABLE","$this",586],["T_OBJECT_OPERATOR","->",586],["T_STRING","dataObjectHelper",586],["T_OBJECT_OPERATOR","->",586],["T_STRING","populateWithArray",586],"(",["T_WHITESPACE","\n            ",586],["T_VARIABLE","$customer",587],",",["T_WHITESPACE","\n            ",587],["T_VARIABLE","$dataArray",588],",",["T_WHITESPACE","\n            ",588],["T_NS_SEPARATOR","\\",589],["T_STRING","Magento",589],["T_NS_SEPARATOR","\\",589],["T_STRING","Customer",589],["T_NS_SEPARATOR","\\",589],["T_STRING","Api",589],["T_NS_SEPARATOR","\\",589],["T_STRING","Data",589],["T_NS_SEPARATOR","\\",589],["T_STRING","CustomerInterface",589],["T_DOUBLE_COLON","::",589],["T_CLASS","class",589],["T_WHITESPACE","\n        ",589],")",";",["T_WHITESPACE","\n        ",590],["T_VARIABLE","$quote",591],["T_OBJECT_OPERATOR","->",591],["T_STRING","setCustomer",591],"(",["T_VARIABLE","$customer",591],")",["T_OBJECT_OPERATOR","->",591],["T_STRING","setCustomerId",591],"(",["T_STRING","true",591],")",";",["T_WHITESPACE","\n\n        ",591],["T_VARIABLE","$customerBillingData",593],["T_OBJECT_OPERATOR","->",593],["T_STRING","setIsDefaultBilling",593],"(",["T_STRING","true",593],")",";",["T_WHITESPACE","\n\n        ",593],["T_IF","if",595],["T_WHITESPACE"," ",595],"(",["T_VARIABLE","$shipping",595],")",["T_WHITESPACE"," ",595],"{",["T_WHITESPACE","\n            ",595],["T_IF","if",596],["T_WHITESPACE"," ",596],"(","!",["T_VARIABLE","$shipping",596],["T_OBJECT_OPERATOR","->",596],["T_STRING","getSameAsBilling",596],"(",")",")",["T_WHITESPACE"," ",596],"{",["T_WHITESPACE","\n                ",596],["T_VARIABLE","$customerShippingData",597],["T_WHITESPACE"," ",597],"=",["T_WHITESPACE"," ",597],["T_VARIABLE","$shipping",597],["T_OBJECT_OPERATOR","->",597],["T_STRING","exportCustomerAddress",597],"(",")",";",["T_WHITESPACE","\n                ",597],["T_VARIABLE","$customerShippingData",598],["T_OBJECT_OPERATOR","->",598],["T_STRING","setIsDefaultShipping",598],"(",["T_STRING","true",598],")",";",["T_WHITESPACE","\n                ",598],["T_VARIABLE","$shipping",599],["T_OBJECT_OPERATOR","->",599],["T_STRING","setCustomerAddressData",599],"(",["T_VARIABLE","$customerShippingData",599],")",";",["T_WHITESPACE","\n                ",599],["T_COMMENT","\/\/ Add shipping address to quote since customer Data Object does not hold address information\n",600],["T_WHITESPACE","                ",601],["T_VARIABLE","$quote",601],["T_OBJECT_OPERATOR","->",601],["T_STRING","addCustomerAddress",601],"(",["T_VARIABLE","$customerShippingData",601],")",";",["T_WHITESPACE","\n            ",601],"}",["T_WHITESPACE"," ",602],["T_ELSE","else",602],["T_WHITESPACE"," ",602],"{",["T_WHITESPACE","\n                ",602],["T_VARIABLE","$shipping",603],["T_OBJECT_OPERATOR","->",603],["T_STRING","setCustomerAddressData",603],"(",["T_VARIABLE","$customerBillingData",603],")",";",["T_WHITESPACE","\n                ",603],["T_VARIABLE","$customerBillingData",604],["T_OBJECT_OPERATOR","->",604],["T_STRING","setIsDefaultShipping",604],"(",["T_STRING","true",604],")",";",["T_WHITESPACE","\n            ",604],"}",["T_WHITESPACE","\n        ",605],"}",["T_WHITESPACE"," ",606],["T_ELSE","else",606],["T_WHITESPACE"," ",606],"{",["T_WHITESPACE","\n            ",606],["T_VARIABLE","$customerBillingData",607],["T_OBJECT_OPERATOR","->",607],["T_STRING","setIsDefaultShipping",607],"(",["T_STRING","true",607],")",";",["T_WHITESPACE","\n        ",607],"}",["T_WHITESPACE","\n        ",608],["T_VARIABLE","$billing",609],["T_OBJECT_OPERATOR","->",609],["T_STRING","setCustomerAddressData",609],"(",["T_VARIABLE","$customerBillingData",609],")",";",["T_WHITESPACE","\n        ",609],["T_COMMENT","\/\/ TODO : Eventually need to remove this legacy hack\n",610],["T_WHITESPACE","        ",611],["T_COMMENT","\/\/ Add billing address to quote since customer Data Object does not hold address information\n",611],["T_WHITESPACE","        ",612],["T_VARIABLE","$quote",612],["T_OBJECT_OPERATOR","->",612],["T_STRING","addCustomerAddress",612],"(",["T_VARIABLE","$customerBillingData",612],")",";",["T_WHITESPACE","\n    ",612],"}",["T_WHITESPACE","\n\n    ",613],["T_DOC_COMMENT","\/**\n     * Prepare quote for customer order submit\n     *\n     * @return void\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     *\/",615],["T_WHITESPACE","\n    ",620],["T_PROTECTED","protected",621],["T_WHITESPACE"," ",621],["T_FUNCTION","function",621],["T_WHITESPACE"," ",621],["T_STRING","_prepareCustomerQuote",621],"(",")",["T_WHITESPACE","\n    ",621],"{",["T_WHITESPACE","\n        ",622],["T_VARIABLE","$quote",623],["T_WHITESPACE"," ",623],"=",["T_WHITESPACE"," ",623],["T_VARIABLE","$this",623],["T_OBJECT_OPERATOR","->",623],["T_STRING","getQuote",623],"(",")",";",["T_WHITESPACE","\n        ",623],["T_VARIABLE","$billing",624],["T_WHITESPACE"," ",624],"=",["T_WHITESPACE"," ",624],["T_VARIABLE","$quote",624],["T_OBJECT_OPERATOR","->",624],["T_STRING","getBillingAddress",624],"(",")",";",["T_WHITESPACE","\n        ",624],["T_VARIABLE","$shipping",625],["T_WHITESPACE"," ",625],"=",["T_WHITESPACE"," ",625],["T_VARIABLE","$quote",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","isVirtual",625],"(",")",["T_WHITESPACE"," ",625],"?",["T_WHITESPACE"," ",625],["T_STRING","null",625],["T_WHITESPACE"," ",625],":",["T_WHITESPACE"," ",625],["T_VARIABLE","$quote",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","getShippingAddress",625],"(",")",";",["T_WHITESPACE","\n\n        ",625],["T_VARIABLE","$customer",627],["T_WHITESPACE"," ",627],"=",["T_WHITESPACE"," ",627],["T_VARIABLE","$this",627],["T_OBJECT_OPERATOR","->",627],["T_STRING","customerRepository",627],["T_OBJECT_OPERATOR","->",627],["T_STRING","getById",627],"(",["T_VARIABLE","$this",627],["T_OBJECT_OPERATOR","->",627],["T_STRING","getCustomerSession",627],"(",")",["T_OBJECT_OPERATOR","->",627],["T_STRING","getCustomerId",627],"(",")",")",";",["T_WHITESPACE","\n        ",627],["T_VARIABLE","$hasDefaultBilling",628],["T_WHITESPACE"," ",628],"=",["T_WHITESPACE"," ",628],["T_BOOL_CAST","(bool)",628],["T_VARIABLE","$customer",628],["T_OBJECT_OPERATOR","->",628],["T_STRING","getDefaultBilling",628],"(",")",";",["T_WHITESPACE","\n        ",628],["T_VARIABLE","$hasDefaultShipping",629],["T_WHITESPACE"," ",629],"=",["T_WHITESPACE"," ",629],["T_BOOL_CAST","(bool)",629],["T_VARIABLE","$customer",629],["T_OBJECT_OPERATOR","->",629],["T_STRING","getDefaultShipping",629],"(",")",";",["T_WHITESPACE","\n\n        ",629],["T_IF","if",631],["T_WHITESPACE"," ",631],"(",["T_VARIABLE","$shipping",631],["T_WHITESPACE"," ",631],["T_BOOLEAN_AND","&&",631],["T_WHITESPACE"," ",631],"!",["T_VARIABLE","$shipping",631],["T_OBJECT_OPERATOR","->",631],["T_STRING","getSameAsBilling",631],"(",")",["T_WHITESPACE"," ",631],["T_BOOLEAN_AND","&&",631],["T_WHITESPACE","\n            ",631],"(","!",["T_VARIABLE","$shipping",632],["T_OBJECT_OPERATOR","->",632],["T_STRING","getCustomerId",632],"(",")",["T_WHITESPACE"," ",632],["T_BOOLEAN_OR","||",632],["T_WHITESPACE"," ",632],["T_VARIABLE","$shipping",632],["T_OBJECT_OPERATOR","->",632],["T_STRING","getSaveInAddressBook",632],"(",")",")",["T_WHITESPACE","\n        ",632],")",["T_WHITESPACE"," ",633],"{",["T_WHITESPACE","\n            ",633],["T_VARIABLE","$shippingAddress",634],["T_WHITESPACE"," ",634],"=",["T_WHITESPACE"," ",634],["T_VARIABLE","$shipping",634],["T_OBJECT_OPERATOR","->",634],["T_STRING","exportCustomerAddress",634],"(",")",";",["T_WHITESPACE","\n            ",634],["T_IF","if",635],["T_WHITESPACE"," ",635],"(","!",["T_VARIABLE","$hasDefaultShipping",635],")",["T_WHITESPACE"," ",635],"{",["T_WHITESPACE","\n                ",635],["T_COMMENT","\/\/Make provided address as default shipping address\n",636],["T_WHITESPACE","                ",637],["T_VARIABLE","$shippingAddress",637],["T_OBJECT_OPERATOR","->",637],["T_STRING","setIsDefaultShipping",637],"(",["T_STRING","true",637],")",";",["T_WHITESPACE","\n                ",637],["T_VARIABLE","$hasDefaultShipping",638],["T_WHITESPACE"," ",638],"=",["T_WHITESPACE"," ",638],["T_STRING","true",638],";",["T_WHITESPACE","\n            ",638],"}",["T_WHITESPACE","\n            ",639],["T_VARIABLE","$quote",640],["T_OBJECT_OPERATOR","->",640],["T_STRING","addCustomerAddress",640],"(",["T_VARIABLE","$shippingAddress",640],")",";",["T_WHITESPACE","\n            ",640],["T_VARIABLE","$shipping",641],["T_OBJECT_OPERATOR","->",641],["T_STRING","setCustomerAddressData",641],"(",["T_VARIABLE","$shippingAddress",641],")",";",["T_WHITESPACE","\n        ",641],"}",["T_WHITESPACE","\n\n        ",642],["T_IF","if",644],["T_WHITESPACE"," ",644],"(","!",["T_VARIABLE","$billing",644],["T_OBJECT_OPERATOR","->",644],["T_STRING","getCustomerId",644],"(",")",["T_WHITESPACE"," ",644],["T_BOOLEAN_OR","||",644],["T_WHITESPACE"," ",644],["T_VARIABLE","$billing",644],["T_OBJECT_OPERATOR","->",644],["T_STRING","getSaveInAddressBook",644],"(",")",")",["T_WHITESPACE"," ",644],"{",["T_WHITESPACE","\n            ",644],["T_VARIABLE","$billingAddress",645],["T_WHITESPACE"," ",645],"=",["T_WHITESPACE"," ",645],["T_VARIABLE","$billing",645],["T_OBJECT_OPERATOR","->",645],["T_STRING","exportCustomerAddress",645],"(",")",";",["T_WHITESPACE","\n            ",645],["T_IF","if",646],["T_WHITESPACE"," ",646],"(","!",["T_VARIABLE","$hasDefaultBilling",646],")",["T_WHITESPACE"," ",646],"{",["T_WHITESPACE","\n                ",646],["T_COMMENT","\/\/Make provided address as default shipping address\n",647],["T_WHITESPACE","                ",648],["T_IF","if",648],["T_WHITESPACE"," ",648],"(","!",["T_VARIABLE","$hasDefaultShipping",648],")",["T_WHITESPACE"," ",648],"{",["T_WHITESPACE","\n                    ",648],["T_COMMENT","\/\/Make provided address as default shipping address\n",649],["T_WHITESPACE","                    ",650],["T_VARIABLE","$billingAddress",650],["T_OBJECT_OPERATOR","->",650],["T_STRING","setIsDefaultShipping",650],"(",["T_STRING","true",650],")",";",["T_WHITESPACE","\n                ",650],"}",["T_WHITESPACE","\n                ",651],["T_VARIABLE","$billingAddress",652],["T_OBJECT_OPERATOR","->",652],["T_STRING","setIsDefaultBilling",652],"(",["T_STRING","true",652],")",";",["T_WHITESPACE","\n            ",652],"}",["T_WHITESPACE","\n            ",653],["T_VARIABLE","$quote",654],["T_OBJECT_OPERATOR","->",654],["T_STRING","addCustomerAddress",654],"(",["T_VARIABLE","$billingAddress",654],")",";",["T_WHITESPACE","\n            ",654],["T_VARIABLE","$billing",655],["T_OBJECT_OPERATOR","->",655],["T_STRING","setCustomerAddressData",655],"(",["T_VARIABLE","$billingAddress",655],")",";",["T_WHITESPACE","\n        ",655],"}",["T_WHITESPACE","\n    ",656],"}",["T_WHITESPACE","\n\n    ",657],["T_DOC_COMMENT","\/**\n     * Involve new customer to system\n     *\n     * @return $this\n     *\/",659],["T_WHITESPACE","\n    ",663],["T_PROTECTED","protected",664],["T_WHITESPACE"," ",664],["T_FUNCTION","function",664],["T_WHITESPACE"," ",664],["T_STRING","_involveNewCustomer",664],"(",")",["T_WHITESPACE","\n    ",664],"{",["T_WHITESPACE","\n        ",665],["T_VARIABLE","$customer",666],["T_WHITESPACE"," ",666],"=",["T_WHITESPACE"," ",666],["T_VARIABLE","$this",666],["T_OBJECT_OPERATOR","->",666],["T_STRING","getQuote",666],"(",")",["T_OBJECT_OPERATOR","->",666],["T_STRING","getCustomer",666],"(",")",";",["T_WHITESPACE","\n        ",666],["T_VARIABLE","$confirmationStatus",667],["T_WHITESPACE"," ",667],"=",["T_WHITESPACE"," ",667],["T_VARIABLE","$this",667],["T_OBJECT_OPERATOR","->",667],["T_STRING","accountManagement",667],["T_OBJECT_OPERATOR","->",667],["T_STRING","getConfirmationStatus",667],"(",["T_VARIABLE","$customer",667],["T_OBJECT_OPERATOR","->",667],["T_STRING","getId",667],"(",")",")",";",["T_WHITESPACE","\n        ",667],["T_IF","if",668],["T_WHITESPACE"," ",668],"(",["T_VARIABLE","$confirmationStatus",668],["T_WHITESPACE"," ",668],["T_IS_IDENTICAL","===",668],["T_WHITESPACE"," ",668],["T_NS_SEPARATOR","\\",668],["T_STRING","Magento",668],["T_NS_SEPARATOR","\\",668],["T_STRING","Customer",668],["T_NS_SEPARATOR","\\",668],["T_STRING","Model",668],["T_NS_SEPARATOR","\\",668],["T_STRING","AccountManagement",668],["T_DOUBLE_COLON","::",668],["T_STRING","ACCOUNT_CONFIRMATION_REQUIRED",668],")",["T_WHITESPACE"," ",668],"{",["T_WHITESPACE","\n            ",668],["T_VARIABLE","$url",669],["T_WHITESPACE"," ",669],"=",["T_WHITESPACE"," ",669],["T_VARIABLE","$this",669],["T_OBJECT_OPERATOR","->",669],["T_STRING","_customerUrl",669],["T_OBJECT_OPERATOR","->",669],["T_STRING","getEmailConfirmationUrl",669],"(",["T_VARIABLE","$customer",669],["T_OBJECT_OPERATOR","->",669],["T_STRING","getEmail",669],"(",")",")",";",["T_WHITESPACE","\n            ",669],["T_VARIABLE","$this",670],["T_OBJECT_OPERATOR","->",670],["T_STRING","messageManager",670],["T_OBJECT_OPERATOR","->",670],["T_STRING","addSuccess",670],"(",["T_WHITESPACE","\n                ",670],["T_COMMENT","\/\/ @codingStandardsIgnoreStart\n",671],["T_WHITESPACE","                ",672],["T_STRING","__",672],"(",["T_WHITESPACE","\n                    ",672],["T_CONSTANT_ENCAPSED_STRING","'You must confirm your account. Please check your email for the confirmation link or <a href=\"%1\">click here<\/a> for a new link.'",673],",",["T_WHITESPACE","\n                    ",673],["T_VARIABLE","$url",674],["T_WHITESPACE","\n                ",674],")",["T_WHITESPACE","\n                ",675],["T_COMMENT","\/\/ @codingStandardsIgnoreEnd\n",676],["T_WHITESPACE","            ",677],")",";",["T_WHITESPACE","\n        ",677],"}",["T_WHITESPACE"," ",678],["T_ELSE","else",678],["T_WHITESPACE"," ",678],"{",["T_WHITESPACE","\n            ",678],["T_VARIABLE","$this",679],["T_OBJECT_OPERATOR","->",679],["T_STRING","getCustomerSession",679],"(",")",["T_OBJECT_OPERATOR","->",679],["T_STRING","loginById",679],"(",["T_VARIABLE","$customer",679],["T_OBJECT_OPERATOR","->",679],["T_STRING","getId",679],"(",")",")",";",["T_WHITESPACE","\n        ",679],"}",["T_WHITESPACE","\n        ",680],["T_RETURN","return",681],["T_WHITESPACE"," ",681],["T_VARIABLE","$this",681],";",["T_WHITESPACE","\n    ",681],"}",["T_WHITESPACE","\n\n    ",682],["T_DOC_COMMENT","\/**\n     * Create order based on checkout type. Create customer if necessary.\n     *\n     * @return $this\n     *\/",684],["T_WHITESPACE","\n    ",688],["T_PUBLIC","public",689],["T_WHITESPACE"," ",689],["T_FUNCTION","function",689],["T_WHITESPACE"," ",689],["T_STRING","saveOrder",689],"(",")",["T_WHITESPACE","\n    ",689],"{",["T_WHITESPACE","\n        ",690],["T_VARIABLE","$this",691],["T_OBJECT_OPERATOR","->",691],["T_STRING","validate",691],"(",")",";",["T_WHITESPACE","\n        ",691],["T_VARIABLE","$isNewCustomer",692],["T_WHITESPACE"," ",692],"=",["T_WHITESPACE"," ",692],["T_STRING","false",692],";",["T_WHITESPACE","\n        ",692],["T_SWITCH","switch",693],["T_WHITESPACE"," ",693],"(",["T_VARIABLE","$this",693],["T_OBJECT_OPERATOR","->",693],["T_STRING","getCheckoutMethod",693],"(",")",")",["T_WHITESPACE"," ",693],"{",["T_WHITESPACE","\n            ",693],["T_CASE","case",694],["T_WHITESPACE"," ",694],["T_STRING","self",694],["T_DOUBLE_COLON","::",694],["T_STRING","METHOD_GUEST",694],":",["T_WHITESPACE","\n                ",694],["T_VARIABLE","$this",695],["T_OBJECT_OPERATOR","->",695],["T_STRING","_prepareGuestQuote",695],"(",")",";",["T_WHITESPACE","\n                ",695],["T_BREAK","break",696],";",["T_WHITESPACE","\n            ",696],["T_CASE","case",697],["T_WHITESPACE"," ",697],["T_STRING","self",697],["T_DOUBLE_COLON","::",697],["T_STRING","METHOD_REGISTER",697],":",["T_WHITESPACE","\n                ",697],["T_VARIABLE","$this",698],["T_OBJECT_OPERATOR","->",698],["T_STRING","_prepareNewCustomerQuote",698],"(",")",";",["T_WHITESPACE","\n                ",698],["T_VARIABLE","$isNewCustomer",699],["T_WHITESPACE"," ",699],"=",["T_WHITESPACE"," ",699],["T_STRING","true",699],";",["T_WHITESPACE","\n                ",699],["T_BREAK","break",700],";",["T_WHITESPACE","\n            ",700],["T_DEFAULT","default",701],":",["T_WHITESPACE","\n                ",701],["T_VARIABLE","$this",702],["T_OBJECT_OPERATOR","->",702],["T_STRING","_prepareCustomerQuote",702],"(",")",";",["T_WHITESPACE","\n                ",702],["T_BREAK","break",703],";",["T_WHITESPACE","\n        ",703],"}",["T_WHITESPACE","\n        ",704],["T_VARIABLE","$order",705],["T_WHITESPACE"," ",705],"=",["T_WHITESPACE"," ",705],["T_VARIABLE","$this",705],["T_OBJECT_OPERATOR","->",705],["T_STRING","quoteManagement",705],["T_OBJECT_OPERATOR","->",705],["T_STRING","submit",705],"(",["T_VARIABLE","$this",705],["T_OBJECT_OPERATOR","->",705],["T_STRING","getQuote",705],"(",")",")",";",["T_WHITESPACE","\n        ",705],["T_IF","if",706],["T_WHITESPACE"," ",706],"(",["T_VARIABLE","$isNewCustomer",706],")",["T_WHITESPACE"," ",706],"{",["T_WHITESPACE","\n            ",706],["T_TRY","try",707],["T_WHITESPACE"," ",707],"{",["T_WHITESPACE","\n                ",707],["T_VARIABLE","$this",708],["T_OBJECT_OPERATOR","->",708],["T_STRING","_involveNewCustomer",708],"(",")",";",["T_WHITESPACE","\n            ",708],"}",["T_WHITESPACE"," ",709],["T_CATCH","catch",709],["T_WHITESPACE"," ",709],"(",["T_NS_SEPARATOR","\\",709],["T_STRING","Exception",709],["T_WHITESPACE"," ",709],["T_VARIABLE","$e",709],")",["T_WHITESPACE"," ",709],"{",["T_WHITESPACE","\n                ",709],["T_VARIABLE","$this",710],["T_OBJECT_OPERATOR","->",710],["T_STRING","_logger",710],["T_OBJECT_OPERATOR","->",710],["T_STRING","critical",710],"(",["T_VARIABLE","$e",710],")",";",["T_WHITESPACE","\n            ",710],"}",["T_WHITESPACE","\n        ",711],"}",["T_WHITESPACE","\n        ",712],["T_VARIABLE","$this",713],["T_OBJECT_OPERATOR","->",713],["T_STRING","_checkoutSession",713],["T_WHITESPACE","\n            ",713],["T_OBJECT_OPERATOR","->",714],["T_STRING","setLastQuoteId",714],"(",["T_VARIABLE","$this",714],["T_OBJECT_OPERATOR","->",714],["T_STRING","getQuote",714],"(",")",["T_OBJECT_OPERATOR","->",714],["T_STRING","getId",714],"(",")",")",["T_WHITESPACE","\n            ",714],["T_OBJECT_OPERATOR","->",715],["T_STRING","setLastSuccessQuoteId",715],"(",["T_VARIABLE","$this",715],["T_OBJECT_OPERATOR","->",715],["T_STRING","getQuote",715],"(",")",["T_OBJECT_OPERATOR","->",715],["T_STRING","getId",715],"(",")",")",["T_WHITESPACE","\n            ",715],["T_OBJECT_OPERATOR","->",716],["T_STRING","clearHelperData",716],"(",")",";",["T_WHITESPACE","\n\n        ",716],["T_IF","if",718],["T_WHITESPACE"," ",718],"(",["T_VARIABLE","$order",718],")",["T_WHITESPACE"," ",718],"{",["T_WHITESPACE","\n            ",718],["T_VARIABLE","$this",719],["T_OBJECT_OPERATOR","->",719],["T_STRING","_eventManager",719],["T_OBJECT_OPERATOR","->",719],["T_STRING","dispatch",719],"(",["T_WHITESPACE","\n                ",719],["T_CONSTANT_ENCAPSED_STRING","'checkout_type_onepage_save_order_after'",720],",",["T_WHITESPACE","\n                ",720],"[",["T_CONSTANT_ENCAPSED_STRING","'order'",721],["T_WHITESPACE"," ",721],["T_DOUBLE_ARROW","=>",721],["T_WHITESPACE"," ",721],["T_VARIABLE","$order",721],",",["T_WHITESPACE"," ",721],["T_CONSTANT_ENCAPSED_STRING","'quote'",721],["T_WHITESPACE"," ",721],["T_DOUBLE_ARROW","=>",721],["T_WHITESPACE"," ",721],["T_VARIABLE","$this",721],["T_OBJECT_OPERATOR","->",721],["T_STRING","getQuote",721],"(",")","]",["T_WHITESPACE","\n            ",721],")",";",["T_WHITESPACE","\n\n            ",722],["T_DOC_COMMENT","\/**\n             * a flag to set that there will be redirect to third party after confirmation\n             *\/",724],["T_WHITESPACE","\n            ",726],["T_VARIABLE","$redirectUrl",727],["T_WHITESPACE"," ",727],"=",["T_WHITESPACE"," ",727],["T_VARIABLE","$this",727],["T_OBJECT_OPERATOR","->",727],["T_STRING","getQuote",727],"(",")",["T_OBJECT_OPERATOR","->",727],["T_STRING","getPayment",727],"(",")",["T_OBJECT_OPERATOR","->",727],["T_STRING","getOrderPlaceRedirectUrl",727],"(",")",";",["T_WHITESPACE","\n            ",727],["T_DOC_COMMENT","\/**\n             * we only want to send to customer about new order when there is no redirect to third party\n             *\/",728],["T_WHITESPACE","\n            ",730],["T_IF","if",731],["T_WHITESPACE"," ",731],"(","!",["T_VARIABLE","$redirectUrl",731],["T_WHITESPACE"," ",731],["T_BOOLEAN_AND","&&",731],["T_WHITESPACE"," ",731],["T_VARIABLE","$order",731],["T_OBJECT_OPERATOR","->",731],["T_STRING","getCanSendNewEmailFlag",731],"(",")",")",["T_WHITESPACE"," ",731],"{",["T_WHITESPACE","\n                ",731],["T_TRY","try",732],["T_WHITESPACE"," ",732],"{",["T_WHITESPACE","\n                    ",732],["T_VARIABLE","$this",733],["T_OBJECT_OPERATOR","->",733],["T_STRING","orderSender",733],["T_OBJECT_OPERATOR","->",733],["T_STRING","send",733],"(",["T_VARIABLE","$order",733],")",";",["T_WHITESPACE","\n                ",733],"}",["T_WHITESPACE"," ",734],["T_CATCH","catch",734],["T_WHITESPACE"," ",734],"(",["T_NS_SEPARATOR","\\",734],["T_STRING","Exception",734],["T_WHITESPACE"," ",734],["T_VARIABLE","$e",734],")",["T_WHITESPACE"," ",734],"{",["T_WHITESPACE","\n                    ",734],["T_VARIABLE","$this",735],["T_OBJECT_OPERATOR","->",735],["T_STRING","_logger",735],["T_OBJECT_OPERATOR","->",735],["T_STRING","critical",735],"(",["T_VARIABLE","$e",735],")",";",["T_WHITESPACE","\n                ",735],"}",["T_WHITESPACE","\n            ",736],"}",["T_WHITESPACE","\n\n            ",737],["T_COMMENT","\/\/ add order information to the session\n",739],["T_WHITESPACE","            ",740],["T_VARIABLE","$this",740],["T_OBJECT_OPERATOR","->",740],["T_STRING","_checkoutSession",740],["T_WHITESPACE","\n                ",740],["T_OBJECT_OPERATOR","->",741],["T_STRING","setLastOrderId",741],"(",["T_VARIABLE","$order",741],["T_OBJECT_OPERATOR","->",741],["T_STRING","getId",741],"(",")",")",["T_WHITESPACE","\n                ",741],["T_OBJECT_OPERATOR","->",742],["T_STRING","setRedirectUrl",742],"(",["T_VARIABLE","$redirectUrl",742],")",["T_WHITESPACE","\n                ",742],["T_OBJECT_OPERATOR","->",743],["T_STRING","setLastRealOrderId",743],"(",["T_VARIABLE","$order",743],["T_OBJECT_OPERATOR","->",743],["T_STRING","getIncrementId",743],"(",")",")",["T_WHITESPACE","\n                ",743],["T_OBJECT_OPERATOR","->",744],["T_STRING","setLastOrderStatus",744],"(",["T_VARIABLE","$order",744],["T_OBJECT_OPERATOR","->",744],["T_STRING","getStatus",744],"(",")",")",";",["T_WHITESPACE","\n        ",744],"}",["T_WHITESPACE","\n\n        ",745],["T_VARIABLE","$this",747],["T_OBJECT_OPERATOR","->",747],["T_STRING","_eventManager",747],["T_OBJECT_OPERATOR","->",747],["T_STRING","dispatch",747],"(",["T_WHITESPACE","\n            ",747],["T_CONSTANT_ENCAPSED_STRING","'checkout_submit_all_after'",748],",",["T_WHITESPACE","\n            ",748],"[",["T_WHITESPACE","\n                ",749],["T_CONSTANT_ENCAPSED_STRING","'order'",750],["T_WHITESPACE"," ",750],["T_DOUBLE_ARROW","=>",750],["T_WHITESPACE"," ",750],["T_VARIABLE","$order",750],",",["T_WHITESPACE","\n                ",750],["T_CONSTANT_ENCAPSED_STRING","'quote'",751],["T_WHITESPACE"," ",751],["T_DOUBLE_ARROW","=>",751],["T_WHITESPACE"," ",751],["T_VARIABLE","$this",751],["T_OBJECT_OPERATOR","->",751],["T_STRING","getQuote",751],"(",")",["T_WHITESPACE","\n            ",751],"]",["T_WHITESPACE","\n        ",752],")",";",["T_WHITESPACE","\n        ",753],["T_RETURN","return",754],["T_WHITESPACE"," ",754],["T_VARIABLE","$this",754],";",["T_WHITESPACE","\n    ",754],"}",["T_WHITESPACE","\n\n    ",755],["T_DOC_COMMENT","\/**\n     * Check if customer email exists\n     *\n     * @param string $email\n     * @param int $websiteId\n     * @return false|\\Magento\\Customer\\Model\\Customer\n     * @codeCoverageIgnore\n     *\/",757],["T_WHITESPACE","\n    ",764],["T_PROTECTED","protected",765],["T_WHITESPACE"," ",765],["T_FUNCTION","function",765],["T_WHITESPACE"," ",765],["T_STRING","_customerEmailExists",765],"(",["T_VARIABLE","$email",765],",",["T_WHITESPACE"," ",765],["T_VARIABLE","$websiteId",765],["T_WHITESPACE"," ",765],"=",["T_WHITESPACE"," ",765],["T_STRING","null",765],")",["T_WHITESPACE","\n    ",765],"{",["T_WHITESPACE","\n        ",766],["T_RETURN","return",767],["T_WHITESPACE"," ",767],"!",["T_VARIABLE","$this",767],["T_OBJECT_OPERATOR","->",767],["T_STRING","accountManagement",767],["T_OBJECT_OPERATOR","->",767],["T_STRING","isEmailAvailable",767],"(",["T_VARIABLE","$email",767],",",["T_WHITESPACE"," ",767],["T_VARIABLE","$websiteId",767],")",";",["T_WHITESPACE","\n    ",767],"}",["T_WHITESPACE","\n\n    ",768],["T_DOC_COMMENT","\/**\n     * Get last order increment id by order id\n     *\n     * @return string\n     *\/",770],["T_WHITESPACE","\n    ",774],["T_PUBLIC","public",775],["T_WHITESPACE"," ",775],["T_FUNCTION","function",775],["T_WHITESPACE"," ",775],["T_STRING","getLastOrderId",775],"(",")",["T_WHITESPACE","\n    ",775],"{",["T_WHITESPACE","\n        ",776],["T_VARIABLE","$lastId",777],["T_WHITESPACE"," ",777],"=",["T_WHITESPACE"," ",777],["T_VARIABLE","$this",777],["T_OBJECT_OPERATOR","->",777],["T_STRING","getCheckout",777],"(",")",["T_OBJECT_OPERATOR","->",777],["T_STRING","getLastOrderId",777],"(",")",";",["T_WHITESPACE","\n        ",777],["T_VARIABLE","$orderId",778],["T_WHITESPACE"," ",778],"=",["T_WHITESPACE"," ",778],["T_STRING","false",778],";",["T_WHITESPACE","\n        ",778],["T_IF","if",779],["T_WHITESPACE"," ",779],"(",["T_VARIABLE","$lastId",779],")",["T_WHITESPACE"," ",779],"{",["T_WHITESPACE","\n            ",779],["T_VARIABLE","$order",780],["T_WHITESPACE"," ",780],"=",["T_WHITESPACE"," ",780],["T_VARIABLE","$this",780],["T_OBJECT_OPERATOR","->",780],["T_STRING","_orderFactory",780],["T_OBJECT_OPERATOR","->",780],["T_STRING","create",780],"(",")",";",["T_WHITESPACE","\n            ",780],["T_VARIABLE","$order",781],["T_OBJECT_OPERATOR","->",781],["T_STRING","load",781],"(",["T_VARIABLE","$lastId",781],")",";",["T_WHITESPACE","\n            ",781],["T_VARIABLE","$orderId",782],["T_WHITESPACE"," ",782],"=",["T_WHITESPACE"," ",782],["T_VARIABLE","$order",782],["T_OBJECT_OPERATOR","->",782],["T_STRING","getIncrementId",782],"(",")",";",["T_WHITESPACE","\n        ",782],"}",["T_WHITESPACE","\n        ",783],["T_RETURN","return",784],["T_WHITESPACE"," ",784],["T_VARIABLE","$orderId",784],";",["T_WHITESPACE","\n    ",784],"}",["T_WHITESPACE","\n",785],"}",["T_WHITESPACE","\n",786]]