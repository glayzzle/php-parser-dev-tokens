[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_COMMENT","\/\/ @codingStandardsIgnoreFile\n",7],["T_WHITESPACE","\n",8],["T_CLOSE_TAG","?>\n",9],["T_INLINE_HTML","\n",10],["T_OPEN_TAG","<?php ",11],["T_COMMENT","\/* @var $block \\Magento\\MediaStorage\\Block\\System\\Config\\System\\Storage\\Media\\Synchronize *\/",11],["T_WHITESPACE"," ",11],["T_CLOSE_TAG","?>\n",11],["T_INLINE_HTML","\n<script>\nrequire([\n    'jquery',\n    'prototype',\n    'mage\/backend\/validation',\n    'jquery\/validate'\n], function(jQuery){\n\n    allowedStorages = [],\n    getConnectionName = function (storageType, connection) {\n        if (storageType == 0) {\n            return storageType;\n        } else if (connection != '') {\n            return storageType + '_' + connection;\n        }\n\n        return '';\n    };\n\n    addAllowedStorage(\n        $('system_media_storage_configuration_media_storage').value,\n        $('system_media_storage_configuration_media_database').value\n    );\n\n    ",12],["T_OPEN_TAG","<?php ",37],["T_VARIABLE","$syncStorageParams",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_VARIABLE","$block",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","getSyncStorageParams",37],"(",")",["T_WHITESPACE"," ",37],["T_CLOSE_TAG","?>\n",37],["T_INLINE_HTML","    addAllowedStorage(",38],["T_OPEN_TAG","<?php ",38],["T_COMMENT","\/* @escapeNotVerified *\/",38],["T_WHITESPACE"," ",38],["T_ECHO","echo",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$syncStorageParams",38],"[",["T_CONSTANT_ENCAPSED_STRING","'storage_type'",38],"]",["T_WHITESPACE"," ",38],["T_CLOSE_TAG","?>",38],["T_INLINE_HTML",", '",38],["T_OPEN_TAG","<?php ",38],["T_COMMENT","\/* @escapeNotVerified *\/",38],["T_WHITESPACE"," ",38],["T_ECHO","echo",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$syncStorageParams",38],"[",["T_CONSTANT_ENCAPSED_STRING","'connection_name'",38],"]",["T_WHITESPACE"," ",38],["T_CLOSE_TAG","?>",38],["T_INLINE_HTML","');\n\n    defaultValues   = [];\n    defaultValues['system_media_storage_configuration_media_storage']   = $('system_media_storage_configuration_media_storage').value;\n    defaultValues['system_media_storage_configuration_media_database']  = $('system_media_storage_configuration_media_database').value;\n\n\n    function addAllowedStorage(storageType, connection)\n    {\n        storage = getConnectionName(storageType, connection);\n\n        if (storage != '' && !allowedStorages.include(storage)) {\n            allowedStorages.push(storage);\n        }\n        $('system_media_storage_configuration_media_storage').value = storageType;\n        $('system_media_storage_configuration_media_database').value = connection;\n    }\n\n    function checkButtonState(event) {\n        var element = Event.element(event);\n\n        defaultStorage = getConnectionName(\n            defaultValues['system_media_storage_configuration_media_storage'],\n            defaultValues['system_media_storage_configuration_media_database']\n        );\n\n        storage = getConnectionName(\n            $('system_media_storage_configuration_media_storage').value,\n            $('system_media_storage_configuration_media_database').value\n        );\n        if (defaultStorage != storage) {\n            enableSyncButton();\n        } else {\n            disableSyncButton();\n        }\n    }\n\n    function enableStorageSelection() {\n        $('system_media_storage_configuration_media_storage').enable('enabled');\n        $('system_media_storage_configuration_media_database').enable('enabled');\n    }\n\n    function disableStorageSelection() {\n        $('system_media_storage_configuration_media_storage').disable('disabled');\n        $('system_media_storage_configuration_media_database').disable('disabled');\n    }\n\n    function enableSyncButton() {\n        Form.Element.enable('synchronize_button');\n        $('synchronize_button').removeClassName('disabled');\n    }\n\n    function disableSyncButton() {\n        Form.Element.disable('synchronize_button');\n        $('synchronize_button').addClassName('disabled');\n    }\n\n    var checkStatus = function() {\n        u = new Ajax.PeriodicalUpdater('', '",38],["T_OPEN_TAG","<?php ",96],["T_COMMENT","\/* @escapeNotVerified *\/",96],["T_WHITESPACE"," ",96],["T_ECHO","echo",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$block",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getAjaxStatusUpdateUrl",96],"(",")",["T_WHITESPACE"," ",96],["T_CLOSE_TAG","?>",96],["T_INLINE_HTML","', {\n            method:     'get',\n            frequency:  5,\n            loaderArea: false,\n\n            onSuccess: function(transport) {\n                var response;\n\n                try {\n                    response = JSON.parse(transport.responseText);\n                    if (response.state == '",96],["T_OPEN_TAG","<?php ",106],["T_COMMENT","\/* @escapeNotVerified *\/",106],["T_WHITESPACE"," ",106],["T_ECHO","echo",106],["T_WHITESPACE"," ",106],["T_NS_SEPARATOR","\\",106],["T_STRING","Magento",106],["T_NS_SEPARATOR","\\",106],["T_STRING","MediaStorage",106],["T_NS_SEPARATOR","\\",106],["T_STRING","Model",106],["T_NS_SEPARATOR","\\",106],["T_STRING","File",106],["T_NS_SEPARATOR","\\",106],["T_STRING","Storage",106],["T_NS_SEPARATOR","\\",106],["T_STRING","Flag",106],["T_DOUBLE_COLON","::",106],["T_STRING","STATE_RUNNING",106],["T_WHITESPACE"," ",106],["T_CLOSE_TAG","?>",106],["T_INLINE_HTML","'\n                        && response.message\n                    ) {\n                        if ($('sync_span').hasClassName('no-display')) {\n                            $('sync_span').removeClassName('no-display');\n                            $('sync_message_span').update(response.message);\n                        }\n                    } else {\n                        u.stop();\n                        enableStorageSelection();\n                        $('sync_span').addClassName('no-display');\n\n                        if (response.state == '",106],["T_OPEN_TAG","<?php ",118],["T_COMMENT","\/* @escapeNotVerified *\/",118],["T_WHITESPACE"," ",118],["T_ECHO","echo",118],["T_WHITESPACE"," ",118],["T_NS_SEPARATOR","\\",118],["T_STRING","Magento",118],["T_NS_SEPARATOR","\\",118],["T_STRING","MediaStorage",118],["T_NS_SEPARATOR","\\",118],["T_STRING","Model",118],["T_NS_SEPARATOR","\\",118],["T_STRING","File",118],["T_NS_SEPARATOR","\\",118],["T_STRING","Storage",118],["T_NS_SEPARATOR","\\",118],["T_STRING","Flag",118],["T_DOUBLE_COLON","::",118],["T_STRING","STATE_FINISHED",118],["T_WHITESPACE"," ",118],["T_CLOSE_TAG","?>",118],["T_INLINE_HTML","') {\n                            addAllowedStorage(\n                                $('system_media_storage_configuration_media_storage').value,\n                                $('system_media_storage_configuration_media_database').value\n                            );\n                        } else if (response.state == '",118],["T_OPEN_TAG","<?php ",123],["T_COMMENT","\/* @escapeNotVerified *\/",123],["T_WHITESPACE"," ",123],["T_ECHO","echo",123],["T_WHITESPACE"," ",123],["T_NS_SEPARATOR","\\",123],["T_STRING","Magento",123],["T_NS_SEPARATOR","\\",123],["T_STRING","MediaStorage",123],["T_NS_SEPARATOR","\\",123],["T_STRING","Model",123],["T_NS_SEPARATOR","\\",123],["T_STRING","File",123],["T_NS_SEPARATOR","\\",123],["T_STRING","Storage",123],["T_NS_SEPARATOR","\\",123],["T_STRING","Flag",123],["T_DOUBLE_COLON","::",123],["T_STRING","STATE_NOTIFIED",123],["T_WHITESPACE"," ",123],["T_CLOSE_TAG","?>",123],["T_INLINE_HTML","') {\n                            if (response.has_errors) {\n                                enableSyncButton();\n                            } else {\n                                addAllowedStorage(\n                                    $('system_media_storage_configuration_media_storage').value,\n                                    $('system_media_storage_configuration_media_database').value\n                                );\n                            }\n                        }\n                    }\n                } catch (e) {\n                    response = {};\n                }\n            }\n        });\n    };\n\n    Event.observe(window, 'load', function(){\n        disableStorageSelection();\n        disableSyncButton();\n        checkStatus();\n    });\n    $('system_media_storage_configuration_media_storage').observe('change', checkButtonState);\n    $('system_media_storage_configuration_media_database').observe('change', checkButtonState);\n\n    jQuery('#synchronize_button').click(function () {\n        if (!jQuery.validator.validateElement('#synchronize-validation-input')) {\n            jQuery('[for=\"synchronize-validation-input\"]').hide();\n        }\n        params = {\n            storage:    $('system_media_storage_configuration_media_storage').value,\n            connection: $('system_media_storage_configuration_media_database').value\n        };\n\n        new Ajax.Request('",123],["T_OPEN_TAG","<?php ",158],["T_COMMENT","\/* @escapeNotVerified *\/",158],["T_WHITESPACE"," ",158],["T_ECHO","echo",158],["T_WHITESPACE"," ",158],["T_VARIABLE","$block",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","getAjaxSyncUrl",158],"(",")",["T_WHITESPACE"," ",158],["T_CLOSE_TAG","?>",158],["T_INLINE_HTML","', {\n            parameters:     params,\n            loaderArea:     false,\n            asynchronous:   true\n        });\n\n        window.setTimeout(checkStatus, 2011);\n\n        disableStorageSelection();\n        disableSyncButton();\n    });\n\n    jQuery.validator.addMethod('required-synchronize', function(){\n        storage = getConnectionName(\n            $('system_media_storage_configuration_media_storage').value,\n            $('system_media_storage_configuration_media_database').value\n        );\n        return allowedStorages.include(storage);\n    }, 'Synchronization is required.');\n});\n<\/script>\n\n",158],["T_OPEN_TAG","<?php ",180],["T_ECHO","echo",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$block",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","getButtonHtml",180],"(",")",["T_WHITESPACE"," ",180],["T_CLOSE_TAG","?>\n",180],["T_INLINE_HTML","<span class=\"sync-indicator no-display\" id=\"sync_span\">\n    <img alt=\"Synchronize\" style=\"margin:0 5px\" src=\"",181],["T_OPEN_TAG","<?php ",182],["T_COMMENT","\/* @escapeNotVerified *\/",182],["T_WHITESPACE"," ",182],["T_ECHO","echo",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$block",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","getViewFileUrl",182],"(",["T_CONSTANT_ENCAPSED_STRING","'images\/process_spinner.gif'",182],")",["T_WHITESPACE"," ",182],["T_CLOSE_TAG","?>",182],["T_INLINE_HTML","\"\/>\n    <span id=\"sync_message_span\"><\/span>\n<\/span>\n<input type=\"hidden\" id=\"synchronize-validation-input\" class=\"required-synchronize no-display\"\/>\n",182]]