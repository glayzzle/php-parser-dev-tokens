[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","MediaStorage",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","ResourceModel",6],["T_NS_SEPARATOR","\\",6],["T_STRING","File",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Storage",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Class Database\n *\/",8],["T_WHITESPACE","\n",10],["T_CLASS","class",11],["T_WHITESPACE"," ",11],["T_STRING","Database",11],["T_WHITESPACE"," ",11],["T_EXTENDS","extends",11],["T_WHITESPACE"," ",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","MediaStorage",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Model",11],["T_NS_SEPARATOR","\\",11],["T_STRING","ResourceModel",11],["T_NS_SEPARATOR","\\",11],["T_STRING","File",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Storage",11],["T_NS_SEPARATOR","\\",11],["T_STRING","AbstractStorage",11],["T_WHITESPACE","\n",11],"{",["T_WHITESPACE","\n    ",12],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\DB\\Helper\n     *\/",13],["T_WHITESPACE","\n    ",15],["T_PROTECTED","protected",16],["T_WHITESPACE"," ",16],["T_VARIABLE","$_resourceHelper",16],";",["T_WHITESPACE","\n\n    ",16],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\Model\\ResourceModel\\Db\\Context $context\n     * @param \\Magento\\Framework\\DB\\Helper $resourceHelper\n     * @param string $connectionName\n     *\/",18],["T_WHITESPACE","\n    ",22],["T_PUBLIC","public",23],["T_WHITESPACE"," ",23],["T_FUNCTION","function",23],["T_WHITESPACE"," ",23],["T_STRING","__construct",23],"(",["T_WHITESPACE","\n        ",23],["T_NS_SEPARATOR","\\",24],["T_STRING","Magento",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Framework",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Model",24],["T_NS_SEPARATOR","\\",24],["T_STRING","ResourceModel",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Db",24],["T_NS_SEPARATOR","\\",24],["T_STRING","Context",24],["T_WHITESPACE"," ",24],["T_VARIABLE","$context",24],",",["T_WHITESPACE","\n        ",24],["T_NS_SEPARATOR","\\",25],["T_STRING","Magento",25],["T_NS_SEPARATOR","\\",25],["T_STRING","Framework",25],["T_NS_SEPARATOR","\\",25],["T_STRING","DB",25],["T_NS_SEPARATOR","\\",25],["T_STRING","Helper",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$resourceHelper",25],",",["T_WHITESPACE","\n        ",25],["T_VARIABLE","$connectionName",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_STRING","null",26],["T_WHITESPACE","\n    ",26],")",["T_WHITESPACE"," ",27],"{",["T_WHITESPACE","\n        ",27],["T_STRING","parent",28],["T_DOUBLE_COLON","::",28],["T_STRING","__construct",28],"(",["T_VARIABLE","$context",28],",",["T_WHITESPACE"," ",28],["T_VARIABLE","$connectionName",28],")",";",["T_WHITESPACE","\n        ",28],["T_VARIABLE","$this",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","_resourceHelper",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_VARIABLE","$resourceHelper",29],";",["T_WHITESPACE","\n    ",29],"}",["T_WHITESPACE","\n\n    ",30],["T_DOC_COMMENT","\/**\n     * Define table name and id field for resource\n     *\n     * @return void\n     *\/",32],["T_WHITESPACE","\n    ",36],["T_PROTECTED","protected",37],["T_WHITESPACE"," ",37],["T_FUNCTION","function",37],["T_WHITESPACE"," ",37],["T_STRING","_construct",37],"(",")",["T_WHITESPACE","\n    ",37],"{",["T_WHITESPACE","\n        ",38],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","_init",39],"(",["T_CONSTANT_ENCAPSED_STRING","'media_storage_file_storage'",39],",",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","'file_id'",39],")",";",["T_WHITESPACE","\n    ",39],"}",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/**\n     * Create database scheme for storing files\n     *\n     * @return $this\n     *\/",42],["T_WHITESPACE","\n    ",46],["T_PUBLIC","public",47],["T_WHITESPACE"," ",47],["T_FUNCTION","function",47],["T_WHITESPACE"," ",47],["T_STRING","createDatabaseScheme",47],"(",")",["T_WHITESPACE","\n    ",47],"{",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$connection",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","getConnection",49],"(",")",";",["T_WHITESPACE","\n        ",49],["T_VARIABLE","$table",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","getMainTable",50],"(",")",";",["T_WHITESPACE","\n        ",50],["T_IF","if",51],["T_WHITESPACE"," ",51],"(",["T_VARIABLE","$connection",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","isTableExists",51],"(",["T_VARIABLE","$table",51],")",")",["T_WHITESPACE"," ",51],"{",["T_WHITESPACE","\n            ",51],["T_RETURN","return",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$this",52],";",["T_WHITESPACE","\n        ",52],"}",["T_WHITESPACE","\n\n        ",53],["T_VARIABLE","$dirStorageTable",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","getTable",55],"(",["T_CONSTANT_ENCAPSED_STRING","'media_storage_directory_storage'",55],")",";",["T_WHITESPACE","\n        ",55],["T_COMMENT","\/\/ For foreign key\n",56],["T_WHITESPACE","\n        ",57],["T_VARIABLE","$ddlTable",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$connection",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","newTable",58],"(",["T_WHITESPACE","\n            ",58],["T_VARIABLE","$table",59],["T_WHITESPACE","\n        ",59],")",["T_OBJECT_OPERATOR","->",60],["T_STRING","addColumn",60],"(",["T_WHITESPACE","\n            ",60],["T_CONSTANT_ENCAPSED_STRING","'file_id'",61],",",["T_WHITESPACE","\n            ",61],["T_NS_SEPARATOR","\\",62],["T_STRING","Magento",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Framework",62],["T_NS_SEPARATOR","\\",62],["T_STRING","DB",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Ddl",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Table",62],["T_DOUBLE_COLON","::",62],["T_STRING","TYPE_INTEGER",62],",",["T_WHITESPACE","\n            ",62],["T_STRING","null",63],",",["T_WHITESPACE","\n            ",63],"[",["T_CONSTANT_ENCAPSED_STRING","'identity'",64],["T_WHITESPACE"," ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_STRING","true",64],",",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",64],["T_WHITESPACE"," ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_STRING","true",64],",",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'nullable'",64],["T_WHITESPACE"," ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_STRING","false",64],",",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'primary'",64],["T_WHITESPACE"," ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_STRING","true",64],"]",",",["T_WHITESPACE","\n            ",64],["T_CONSTANT_ENCAPSED_STRING","'File Id'",65],["T_WHITESPACE","\n        ",65],")",["T_OBJECT_OPERATOR","->",66],["T_STRING","addColumn",66],"(",["T_WHITESPACE","\n            ",66],["T_CONSTANT_ENCAPSED_STRING","'content'",67],",",["T_WHITESPACE","\n            ",67],["T_NS_SEPARATOR","\\",68],["T_STRING","Magento",68],["T_NS_SEPARATOR","\\",68],["T_STRING","Framework",68],["T_NS_SEPARATOR","\\",68],["T_STRING","DB",68],["T_NS_SEPARATOR","\\",68],["T_STRING","Ddl",68],["T_NS_SEPARATOR","\\",68],["T_STRING","Table",68],["T_DOUBLE_COLON","::",68],["T_STRING","TYPE_VARBINARY",68],",",["T_WHITESPACE","\n            ",68],["T_NS_SEPARATOR","\\",69],["T_STRING","Magento",69],["T_NS_SEPARATOR","\\",69],["T_STRING","Framework",69],["T_NS_SEPARATOR","\\",69],["T_STRING","DB",69],["T_NS_SEPARATOR","\\",69],["T_STRING","Ddl",69],["T_NS_SEPARATOR","\\",69],["T_STRING","Table",69],["T_DOUBLE_COLON","::",69],["T_STRING","MAX_VARBINARY_SIZE",69],",",["T_WHITESPACE","\n            ",69],"[",["T_CONSTANT_ENCAPSED_STRING","'nullable'",70],["T_WHITESPACE"," ",70],["T_DOUBLE_ARROW","=>",70],["T_WHITESPACE"," ",70],["T_STRING","false",70],"]",",",["T_WHITESPACE","\n            ",70],["T_CONSTANT_ENCAPSED_STRING","'File Content'",71],["T_WHITESPACE","\n        ",71],")",["T_OBJECT_OPERATOR","->",72],["T_STRING","addColumn",72],"(",["T_WHITESPACE","\n            ",72],["T_CONSTANT_ENCAPSED_STRING","'upload_time'",73],",",["T_WHITESPACE","\n            ",73],["T_NS_SEPARATOR","\\",74],["T_STRING","Magento",74],["T_NS_SEPARATOR","\\",74],["T_STRING","Framework",74],["T_NS_SEPARATOR","\\",74],["T_STRING","DB",74],["T_NS_SEPARATOR","\\",74],["T_STRING","Ddl",74],["T_NS_SEPARATOR","\\",74],["T_STRING","Table",74],["T_DOUBLE_COLON","::",74],["T_STRING","TYPE_TIMESTAMP",74],",",["T_WHITESPACE","\n            ",74],["T_STRING","null",75],",",["T_WHITESPACE","\n            ",75],"[",["T_CONSTANT_ENCAPSED_STRING","'nullable'",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],["T_STRING","false",76],",",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'default'",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],["T_NS_SEPARATOR","\\",76],["T_STRING","Magento",76],["T_NS_SEPARATOR","\\",76],["T_STRING","Framework",76],["T_NS_SEPARATOR","\\",76],["T_STRING","DB",76],["T_NS_SEPARATOR","\\",76],["T_STRING","Ddl",76],["T_NS_SEPARATOR","\\",76],["T_STRING","Table",76],["T_DOUBLE_COLON","::",76],["T_STRING","TIMESTAMP_INIT",76],"]",",",["T_WHITESPACE","\n            ",76],["T_CONSTANT_ENCAPSED_STRING","'Upload Timestamp'",77],["T_WHITESPACE","\n        ",77],")",["T_OBJECT_OPERATOR","->",78],["T_STRING","addColumn",78],"(",["T_WHITESPACE","\n            ",78],["T_CONSTANT_ENCAPSED_STRING","'filename'",79],",",["T_WHITESPACE","\n            ",79],["T_NS_SEPARATOR","\\",80],["T_STRING","Magento",80],["T_NS_SEPARATOR","\\",80],["T_STRING","Framework",80],["T_NS_SEPARATOR","\\",80],["T_STRING","DB",80],["T_NS_SEPARATOR","\\",80],["T_STRING","Ddl",80],["T_NS_SEPARATOR","\\",80],["T_STRING","Table",80],["T_DOUBLE_COLON","::",80],["T_STRING","TYPE_TEXT",80],",",["T_WHITESPACE","\n            ",80],["T_LNUMBER","100",81],",",["T_WHITESPACE","\n            ",81],"[",["T_CONSTANT_ENCAPSED_STRING","'nullable'",82],["T_WHITESPACE"," ",82],["T_DOUBLE_ARROW","=>",82],["T_WHITESPACE"," ",82],["T_STRING","false",82],"]",",",["T_WHITESPACE","\n            ",82],["T_CONSTANT_ENCAPSED_STRING","'Filename'",83],["T_WHITESPACE","\n        ",83],")",["T_OBJECT_OPERATOR","->",84],["T_STRING","addColumn",84],"(",["T_WHITESPACE","\n            ",84],["T_CONSTANT_ENCAPSED_STRING","'directory_id'",85],",",["T_WHITESPACE","\n            ",85],["T_NS_SEPARATOR","\\",86],["T_STRING","Magento",86],["T_NS_SEPARATOR","\\",86],["T_STRING","Framework",86],["T_NS_SEPARATOR","\\",86],["T_STRING","DB",86],["T_NS_SEPARATOR","\\",86],["T_STRING","Ddl",86],["T_NS_SEPARATOR","\\",86],["T_STRING","Table",86],["T_DOUBLE_COLON","::",86],["T_STRING","TYPE_INTEGER",86],",",["T_WHITESPACE","\n            ",86],["T_STRING","null",87],",",["T_WHITESPACE","\n            ",87],"[",["T_CONSTANT_ENCAPSED_STRING","'unsigned'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_STRING","true",88],",",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'default'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_STRING","null",88],"]",",",["T_WHITESPACE","\n            ",88],["T_CONSTANT_ENCAPSED_STRING","'Identifier of Directory where File is Located'",89],["T_WHITESPACE","\n        ",89],")",["T_OBJECT_OPERATOR","->",90],["T_STRING","addColumn",90],"(",["T_WHITESPACE","\n            ",90],["T_CONSTANT_ENCAPSED_STRING","'directory'",91],",",["T_WHITESPACE","\n            ",91],["T_NS_SEPARATOR","\\",92],["T_STRING","Magento",92],["T_NS_SEPARATOR","\\",92],["T_STRING","Framework",92],["T_NS_SEPARATOR","\\",92],["T_STRING","DB",92],["T_NS_SEPARATOR","\\",92],["T_STRING","Ddl",92],["T_NS_SEPARATOR","\\",92],["T_STRING","Table",92],["T_DOUBLE_COLON","::",92],["T_STRING","TYPE_TEXT",92],",",["T_WHITESPACE","\n            ",92],["T_LNUMBER","255",93],",",["T_WHITESPACE","\n            ",93],"[",["T_CONSTANT_ENCAPSED_STRING","'default'",94],["T_WHITESPACE"," ",94],["T_DOUBLE_ARROW","=>",94],["T_WHITESPACE"," ",94],["T_STRING","null",94],"]",",",["T_WHITESPACE","\n            ",94],["T_CONSTANT_ENCAPSED_STRING","'Directory Path'",95],["T_WHITESPACE","\n        ",95],")",["T_OBJECT_OPERATOR","->",96],["T_STRING","addIndex",96],"(",["T_WHITESPACE","\n            ",96],["T_VARIABLE","$connection",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","getIndexName",97],"(",["T_WHITESPACE","\n                ",97],["T_VARIABLE","$table",98],",",["T_WHITESPACE","\n                ",98],"[",["T_CONSTANT_ENCAPSED_STRING","'filename'",99],",",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","'directory_id'",99],"]",",",["T_WHITESPACE","\n                ",99],["T_NS_SEPARATOR","\\",100],["T_STRING","Magento",100],["T_NS_SEPARATOR","\\",100],["T_STRING","Framework",100],["T_NS_SEPARATOR","\\",100],["T_STRING","DB",100],["T_NS_SEPARATOR","\\",100],["T_STRING","Adapter",100],["T_NS_SEPARATOR","\\",100],["T_STRING","AdapterInterface",100],["T_DOUBLE_COLON","::",100],["T_STRING","INDEX_TYPE_UNIQUE",100],["T_WHITESPACE","\n            ",100],")",",",["T_WHITESPACE","\n            ",101],"[",["T_CONSTANT_ENCAPSED_STRING","'filename'",102],",",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'directory_id'",102],"]",",",["T_WHITESPACE","\n            ",102],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",103],["T_WHITESPACE"," ",103],["T_DOUBLE_ARROW","=>",103],["T_WHITESPACE"," ",103],["T_NS_SEPARATOR","\\",103],["T_STRING","Magento",103],["T_NS_SEPARATOR","\\",103],["T_STRING","Framework",103],["T_NS_SEPARATOR","\\",103],["T_STRING","DB",103],["T_NS_SEPARATOR","\\",103],["T_STRING","Adapter",103],["T_NS_SEPARATOR","\\",103],["T_STRING","AdapterInterface",103],["T_DOUBLE_COLON","::",103],["T_STRING","INDEX_TYPE_UNIQUE",103],"]",["T_WHITESPACE","\n        ",103],")",["T_OBJECT_OPERATOR","->",104],["T_STRING","addIndex",104],"(",["T_WHITESPACE","\n            ",104],["T_VARIABLE","$connection",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getIndexName",105],"(",["T_VARIABLE","$table",105],",",["T_WHITESPACE"," ",105],"[",["T_CONSTANT_ENCAPSED_STRING","'directory_id'",105],"]",")",",",["T_WHITESPACE","\n            ",105],"[",["T_CONSTANT_ENCAPSED_STRING","'directory_id'",106],"]",["T_WHITESPACE","\n        ",106],")",["T_OBJECT_OPERATOR","->",107],["T_STRING","addForeignKey",107],"(",["T_WHITESPACE","\n            ",107],["T_VARIABLE","$connection",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getForeignKeyName",108],"(",["T_VARIABLE","$table",108],",",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'directory_id'",108],",",["T_WHITESPACE"," ",108],["T_VARIABLE","$dirStorageTable",108],",",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'directory_id'",108],")",",",["T_WHITESPACE","\n            ",108],["T_CONSTANT_ENCAPSED_STRING","'directory_id'",109],",",["T_WHITESPACE","\n            ",109],["T_VARIABLE","$dirStorageTable",110],",",["T_WHITESPACE","\n            ",110],["T_CONSTANT_ENCAPSED_STRING","'directory_id'",111],",",["T_WHITESPACE","\n            ",111],["T_NS_SEPARATOR","\\",112],["T_STRING","Magento",112],["T_NS_SEPARATOR","\\",112],["T_STRING","Framework",112],["T_NS_SEPARATOR","\\",112],["T_STRING","DB",112],["T_NS_SEPARATOR","\\",112],["T_STRING","Ddl",112],["T_NS_SEPARATOR","\\",112],["T_STRING","Table",112],["T_DOUBLE_COLON","::",112],["T_STRING","ACTION_CASCADE",112],["T_WHITESPACE","\n        ",112],")",["T_OBJECT_OPERATOR","->",113],["T_STRING","setComment",113],"(",["T_WHITESPACE","\n            ",113],["T_CONSTANT_ENCAPSED_STRING","'File Storage'",114],["T_WHITESPACE","\n        ",114],")",";",["T_WHITESPACE","\n\n        ",115],["T_VARIABLE","$connection",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","createTable",117],"(",["T_VARIABLE","$ddlTable",117],")",";",["T_WHITESPACE","\n        ",117],["T_RETURN","return",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],";",["T_WHITESPACE","\n    ",118],"}",["T_WHITESPACE","\n\n    ",119],["T_DOC_COMMENT","\/**\n     * Decodes blob content retrieved by DB driver\n     *\n     * @param  array $row Table row with 'content' key in it\n     * @return array\n     *\/",121],["T_WHITESPACE","\n    ",126],["T_PROTECTED","protected",127],["T_WHITESPACE"," ",127],["T_FUNCTION","function",127],["T_WHITESPACE"," ",127],["T_STRING","_decodeFileContent",127],"(",["T_VARIABLE","$row",127],")",["T_WHITESPACE","\n    ",127],"{",["T_WHITESPACE","\n        ",128],["T_VARIABLE","$row",129],"[",["T_CONSTANT_ENCAPSED_STRING","'content'",129],"]",["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getConnection",129],"(",")",["T_OBJECT_OPERATOR","->",129],["T_STRING","decodeVarbinary",129],"(",["T_VARIABLE","$row",129],"[",["T_CONSTANT_ENCAPSED_STRING","'content'",129],"]",")",";",["T_WHITESPACE","\n        ",129],["T_RETURN","return",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$row",130],";",["T_WHITESPACE","\n    ",130],"}",["T_WHITESPACE","\n\n    ",131],["T_DOC_COMMENT","\/**\n     * Decodes blob content retrieved by Database driver\n     *\n     * @param  array $rows Array of table rows (files), each containing 'content' key\n     * @return array\n     *\/",133],["T_WHITESPACE","\n    ",138],["T_PROTECTED","protected",139],["T_WHITESPACE"," ",139],["T_FUNCTION","function",139],["T_WHITESPACE"," ",139],["T_STRING","_decodeAllFilesContent",139],"(",["T_VARIABLE","$rows",139],")",["T_WHITESPACE","\n    ",139],"{",["T_WHITESPACE","\n        ",140],["T_FOREACH","foreach",141],["T_WHITESPACE"," ",141],"(",["T_VARIABLE","$rows",141],["T_WHITESPACE"," ",141],["T_AS","as",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$key",141],["T_WHITESPACE"," ",141],["T_DOUBLE_ARROW","=>",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$row",141],")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n            ",141],["T_VARIABLE","$rows",142],"[",["T_VARIABLE","$key",142],"]",["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","_decodeFileContent",142],"(",["T_VARIABLE","$row",142],")",";",["T_WHITESPACE","\n        ",142],"}",["T_WHITESPACE","\n        ",143],["T_RETURN","return",144],["T_WHITESPACE"," ",144],["T_VARIABLE","$rows",144],";",["T_WHITESPACE","\n    ",144],"}",["T_WHITESPACE","\n\n    ",145],["T_DOC_COMMENT","\/**\n     * Load entity by filename\n     *\n     * @param  \\Magento\\MediaStorage\\Model\\File\\Storage\\Database $object\n     * @param  string $filename\n     * @param  string $path\n     * @return $this\n     *\/",147],["T_WHITESPACE","\n    ",154],["T_PUBLIC","public",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","loadByFilename",155],"(",["T_NS_SEPARATOR","\\",155],["T_STRING","Magento",155],["T_NS_SEPARATOR","\\",155],["T_STRING","MediaStorage",155],["T_NS_SEPARATOR","\\",155],["T_STRING","Model",155],["T_NS_SEPARATOR","\\",155],["T_STRING","File",155],["T_NS_SEPARATOR","\\",155],["T_STRING","Storage",155],["T_NS_SEPARATOR","\\",155],["T_STRING","Database",155],["T_WHITESPACE"," ",155],["T_VARIABLE","$object",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$filename",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$path",155],")",["T_WHITESPACE","\n    ",155],"{",["T_WHITESPACE","\n        ",156],["T_VARIABLE","$connection",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","getConnection",157],"(",")",";",["T_WHITESPACE","\n\n        ",157],["T_VARIABLE","$select",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_VARIABLE","$connection",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","select",159],"(",")",["T_OBJECT_OPERATOR","->",159],["T_STRING","from",159],"(",["T_WHITESPACE","\n            ",159],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",160],["T_WHITESPACE"," ",160],["T_DOUBLE_ARROW","=>",160],["T_WHITESPACE"," ",160],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","getMainTable",160],"(",")","]",["T_WHITESPACE","\n        ",160],")",["T_OBJECT_OPERATOR","->",161],["T_STRING","where",161],"(",["T_WHITESPACE","\n            ",161],["T_CONSTANT_ENCAPSED_STRING","'filename = ?'",162],",",["T_WHITESPACE","\n            ",162],["T_VARIABLE","$filename",163],["T_WHITESPACE","\n        ",163],")",["T_OBJECT_OPERATOR","->",164],["T_STRING","where",164],"(",["T_WHITESPACE","\n            ",164],["T_VARIABLE","$connection",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","prepareSqlCondition",165],"(",["T_CONSTANT_ENCAPSED_STRING","'directory'",165],",",["T_WHITESPACE"," ",165],"[",["T_CONSTANT_ENCAPSED_STRING","'seq'",165],["T_WHITESPACE"," ",165],["T_DOUBLE_ARROW","=>",165],["T_WHITESPACE"," ",165],["T_VARIABLE","$path",165],"]",")",["T_WHITESPACE","\n        ",165],")",";",["T_WHITESPACE","\n\n        ",166],["T_VARIABLE","$row",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_VARIABLE","$connection",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","fetchRow",168],"(",["T_VARIABLE","$select",168],")",";",["T_WHITESPACE","\n        ",168],["T_IF","if",169],["T_WHITESPACE"," ",169],"(",["T_VARIABLE","$row",169],")",["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n            ",169],["T_VARIABLE","$row",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","_decodeFileContent",170],"(",["T_VARIABLE","$row",170],")",";",["T_WHITESPACE","\n            ",170],["T_VARIABLE","$object",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","setData",171],"(",["T_VARIABLE","$row",171],")",";",["T_WHITESPACE","\n            ",171],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","_afterLoad",172],"(",["T_VARIABLE","$object",172],")",";",["T_WHITESPACE","\n        ",172],"}",["T_WHITESPACE","\n\n        ",173],["T_RETURN","return",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],";",["T_WHITESPACE","\n    ",175],"}",["T_WHITESPACE","\n\n    ",176],["T_DOC_COMMENT","\/**\n     * Clear files in storage\n     *\n     * @return $this\n     *\/",178],["T_WHITESPACE","\n    ",182],["T_PUBLIC","public",183],["T_WHITESPACE"," ",183],["T_FUNCTION","function",183],["T_WHITESPACE"," ",183],["T_STRING","clearFiles",183],"(",")",["T_WHITESPACE","\n    ",183],"{",["T_WHITESPACE","\n        ",184],["T_VARIABLE","$connection",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","getConnection",185],"(",")",";",["T_WHITESPACE","\n        ",185],["T_VARIABLE","$connection",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","delete",186],"(",["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","getMainTable",186],"(",")",")",";",["T_WHITESPACE","\n\n        ",186],["T_RETURN","return",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$this",188],";",["T_WHITESPACE","\n    ",188],"}",["T_WHITESPACE","\n\n    ",189],["T_DOC_COMMENT","\/**\n     * Get files from storage at defined range\n     *\n     * @param  int $offset\n     * @param  int $count\n     * @return array\n     *\/",191],["T_WHITESPACE","\n    ",197],["T_PUBLIC","public",198],["T_WHITESPACE"," ",198],["T_FUNCTION","function",198],["T_WHITESPACE"," ",198],["T_STRING","getFiles",198],"(",["T_VARIABLE","$offset",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_LNUMBER","0",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$count",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_LNUMBER","100",198],")",["T_WHITESPACE","\n    ",198],"{",["T_WHITESPACE","\n        ",199],["T_VARIABLE","$connection",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","getConnection",200],"(",")",";",["T_WHITESPACE","\n\n        ",200],["T_VARIABLE","$select",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_VARIABLE","$connection",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","select",202],"(",")",["T_OBJECT_OPERATOR","->",202],["T_STRING","from",202],"(",["T_WHITESPACE","\n            ",202],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",203],["T_WHITESPACE"," ",203],["T_DOUBLE_ARROW","=>",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","getMainTable",203],"(",")","]",",",["T_WHITESPACE","\n            ",203],"[",["T_CONSTANT_ENCAPSED_STRING","'filename'",204],",",["T_WHITESPACE"," ",204],["T_CONSTANT_ENCAPSED_STRING","'content'",204],",",["T_WHITESPACE"," ",204],["T_CONSTANT_ENCAPSED_STRING","'directory'",204],"]",["T_WHITESPACE","\n        ",204],")",["T_OBJECT_OPERATOR","->",205],["T_STRING","order",205],"(",["T_WHITESPACE","\n            ",205],["T_CONSTANT_ENCAPSED_STRING","'file_id'",206],["T_WHITESPACE","\n        ",206],")",["T_OBJECT_OPERATOR","->",207],["T_STRING","limit",207],"(",["T_WHITESPACE","\n            ",207],["T_VARIABLE","$count",208],",",["T_WHITESPACE","\n            ",208],["T_VARIABLE","$offset",209],["T_WHITESPACE","\n        ",209],")",";",["T_WHITESPACE","\n\n        ",210],["T_VARIABLE","$rows",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_VARIABLE","$connection",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","fetchAll",212],"(",["T_VARIABLE","$select",212],")",";",["T_WHITESPACE","\n        ",212],["T_RETURN","return",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","_decodeAllFilesContent",213],"(",["T_VARIABLE","$rows",213],")",";",["T_WHITESPACE","\n    ",213],"}",["T_WHITESPACE","\n\n    ",214],["T_DOC_COMMENT","\/**\n     * Save file to storage\n     *\n     * @param  array $file\n     * @return $this\n     *\/",216],["T_WHITESPACE","\n    ",221],["T_PUBLIC","public",222],["T_WHITESPACE"," ",222],["T_FUNCTION","function",222],["T_WHITESPACE"," ",222],["T_STRING","saveFile",222],"(",["T_VARIABLE","$file",222],")",["T_WHITESPACE","\n    ",222],"{",["T_WHITESPACE","\n        ",223],["T_VARIABLE","$connection",224],["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","getConnection",224],"(",")",";",["T_WHITESPACE","\n\n        ",224],["T_VARIABLE","$contentParam",226],["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_NEW","new",226],["T_WHITESPACE"," ",226],["T_NS_SEPARATOR","\\",226],["T_STRING","Magento",226],["T_NS_SEPARATOR","\\",226],["T_STRING","Framework",226],["T_NS_SEPARATOR","\\",226],["T_STRING","DB",226],["T_NS_SEPARATOR","\\",226],["T_STRING","Statement",226],["T_NS_SEPARATOR","\\",226],["T_STRING","Parameter",226],"(",["T_VARIABLE","$file",226],"[",["T_CONSTANT_ENCAPSED_STRING","'content'",226],"]",")",";",["T_WHITESPACE","\n        ",226],["T_VARIABLE","$contentParam",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","setIsBlob",227],"(",["T_STRING","true",227],")",";",["T_WHITESPACE","\n        ",227],["T_VARIABLE","$data",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],"[",["T_WHITESPACE","\n            ",228],["T_CONSTANT_ENCAPSED_STRING","'content'",229],["T_WHITESPACE"," ",229],["T_DOUBLE_ARROW","=>",229],["T_WHITESPACE"," ",229],["T_VARIABLE","$contentParam",229],",",["T_WHITESPACE","\n            ",229],["T_CONSTANT_ENCAPSED_STRING","'upload_time'",230],["T_WHITESPACE"," ",230],["T_DOUBLE_ARROW","=>",230],["T_WHITESPACE"," ",230],["T_VARIABLE","$file",230],"[",["T_CONSTANT_ENCAPSED_STRING","'update_time'",230],"]",",",["T_WHITESPACE","\n            ",230],["T_CONSTANT_ENCAPSED_STRING","'filename'",231],["T_WHITESPACE"," ",231],["T_DOUBLE_ARROW","=>",231],["T_WHITESPACE"," ",231],["T_VARIABLE","$file",231],"[",["T_CONSTANT_ENCAPSED_STRING","'filename'",231],"]",",",["T_WHITESPACE","\n            ",231],["T_CONSTANT_ENCAPSED_STRING","'directory_id'",232],["T_WHITESPACE"," ",232],["T_DOUBLE_ARROW","=>",232],["T_WHITESPACE"," ",232],["T_VARIABLE","$file",232],"[",["T_CONSTANT_ENCAPSED_STRING","'directory_id'",232],"]",",",["T_WHITESPACE","\n            ",232],["T_CONSTANT_ENCAPSED_STRING","'directory'",233],["T_WHITESPACE"," ",233],["T_DOUBLE_ARROW","=>",233],["T_WHITESPACE"," ",233],["T_VARIABLE","$file",233],"[",["T_CONSTANT_ENCAPSED_STRING","'directory'",233],"]",",",["T_WHITESPACE","\n        ",233],"]",";",["T_WHITESPACE","\n\n        ",234],["T_VARIABLE","$connection",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","insertOnDuplicate",236],"(",["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","getMainTable",236],"(",")",",",["T_WHITESPACE"," ",236],["T_VARIABLE","$data",236],",",["T_WHITESPACE"," ",236],"[",["T_CONSTANT_ENCAPSED_STRING","'content'",236],",",["T_WHITESPACE"," ",236],["T_CONSTANT_ENCAPSED_STRING","'upload_time'",236],"]",")",";",["T_WHITESPACE","\n\n        ",236],["T_RETURN","return",238],["T_WHITESPACE"," ",238],["T_VARIABLE","$this",238],";",["T_WHITESPACE","\n    ",238],"}",["T_WHITESPACE","\n\n    ",239],["T_DOC_COMMENT","\/**\n     * Rename files in database\n     *\n     * @param  string $oldFilename\n     * @param  string $oldPath\n     * @param  string $newFilename\n     * @param  string $newPath\n     * @return $this\n     *\/",241],["T_WHITESPACE","\n    ",249],["T_PUBLIC","public",250],["T_WHITESPACE"," ",250],["T_FUNCTION","function",250],["T_WHITESPACE"," ",250],["T_STRING","renameFile",250],"(",["T_VARIABLE","$oldFilename",250],",",["T_WHITESPACE"," ",250],["T_VARIABLE","$oldPath",250],",",["T_WHITESPACE"," ",250],["T_VARIABLE","$newFilename",250],",",["T_WHITESPACE"," ",250],["T_VARIABLE","$newPath",250],")",["T_WHITESPACE","\n    ",250],"{",["T_WHITESPACE","\n        ",251],["T_VARIABLE","$connection",252],["T_WHITESPACE"," ",252],"=",["T_WHITESPACE"," ",252],["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","getConnection",252],"(",")",";",["T_WHITESPACE","\n        ",252],["T_VARIABLE","$dataUpdate",253],["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],"[",["T_CONSTANT_ENCAPSED_STRING","'filename'",253],["T_WHITESPACE"," ",253],["T_DOUBLE_ARROW","=>",253],["T_WHITESPACE"," ",253],["T_VARIABLE","$newFilename",253],",",["T_WHITESPACE"," ",253],["T_CONSTANT_ENCAPSED_STRING","'directory'",253],["T_WHITESPACE"," ",253],["T_DOUBLE_ARROW","=>",253],["T_WHITESPACE"," ",253],["T_VARIABLE","$newPath",253],"]",";",["T_WHITESPACE","\n\n        ",253],["T_VARIABLE","$dataWhere",255],["T_WHITESPACE"," ",255],"=",["T_WHITESPACE"," ",255],"[",["T_CONSTANT_ENCAPSED_STRING","'filename = ?'",255],["T_WHITESPACE"," ",255],["T_DOUBLE_ARROW","=>",255],["T_WHITESPACE"," ",255],["T_VARIABLE","$oldFilename",255],"]",";",["T_WHITESPACE","\n        ",255],["T_VARIABLE","$dataWhere",256],"[","]",["T_WHITESPACE"," ",256],"=",["T_WHITESPACE"," ",256],["T_NEW","new",256],["T_WHITESPACE"," ",256],["T_NS_SEPARATOR","\\",256],["T_STRING","Zend_Db_Expr",256],"(",["T_VARIABLE","$connection",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","prepareSqlCondition",256],"(",["T_CONSTANT_ENCAPSED_STRING","'directory'",256],",",["T_WHITESPACE"," ",256],"[",["T_CONSTANT_ENCAPSED_STRING","'seq'",256],["T_WHITESPACE"," ",256],["T_DOUBLE_ARROW","=>",256],["T_WHITESPACE"," ",256],["T_VARIABLE","$oldPath",256],"]",")",")",";",["T_WHITESPACE","\n\n        ",256],["T_VARIABLE","$connection",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","update",258],"(",["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","getMainTable",258],"(",")",",",["T_WHITESPACE"," ",258],["T_VARIABLE","$dataUpdate",258],",",["T_WHITESPACE"," ",258],["T_VARIABLE","$dataWhere",258],")",";",["T_WHITESPACE","\n\n        ",258],["T_RETURN","return",260],["T_WHITESPACE"," ",260],["T_VARIABLE","$this",260],";",["T_WHITESPACE","\n    ",260],"}",["T_WHITESPACE","\n\n    ",261],["T_DOC_COMMENT","\/**\n     * Copy files in database\n     *\n     * @param  string $oldFilename\n     * @param  string $oldPath\n     * @param  string $newFilename\n     * @param  string $newPath\n     * @return $this\n     *\/",263],["T_WHITESPACE","\n    ",271],["T_PUBLIC","public",272],["T_WHITESPACE"," ",272],["T_FUNCTION","function",272],["T_WHITESPACE"," ",272],["T_STRING","copyFile",272],"(",["T_VARIABLE","$oldFilename",272],",",["T_WHITESPACE"," ",272],["T_VARIABLE","$oldPath",272],",",["T_WHITESPACE"," ",272],["T_VARIABLE","$newFilename",272],",",["T_WHITESPACE"," ",272],["T_VARIABLE","$newPath",272],")",["T_WHITESPACE","\n    ",272],"{",["T_WHITESPACE","\n        ",273],["T_VARIABLE","$connection",274],["T_WHITESPACE"," ",274],"=",["T_WHITESPACE"," ",274],["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","getConnection",274],"(",")",";",["T_WHITESPACE","\n\n        ",274],["T_VARIABLE","$select",276],["T_WHITESPACE"," ",276],"=",["T_WHITESPACE"," ",276],["T_VARIABLE","$connection",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","select",276],"(",")",["T_OBJECT_OPERATOR","->",276],["T_STRING","from",276],"(",["T_WHITESPACE","\n            ",276],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",277],["T_WHITESPACE"," ",277],["T_DOUBLE_ARROW","=>",277],["T_WHITESPACE"," ",277],["T_VARIABLE","$this",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","getMainTable",277],"(",")","]",["T_WHITESPACE","\n        ",277],")",["T_OBJECT_OPERATOR","->",278],["T_STRING","where",278],"(",["T_WHITESPACE","\n            ",278],["T_CONSTANT_ENCAPSED_STRING","'filename = ?'",279],",",["T_WHITESPACE","\n            ",279],["T_VARIABLE","$oldFilename",280],["T_WHITESPACE","\n        ",280],")",["T_OBJECT_OPERATOR","->",281],["T_STRING","where",281],"(",["T_WHITESPACE","\n            ",281],["T_VARIABLE","$connection",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","prepareSqlCondition",282],"(",["T_CONSTANT_ENCAPSED_STRING","'directory'",282],",",["T_WHITESPACE"," ",282],"[",["T_CONSTANT_ENCAPSED_STRING","'seq'",282],["T_WHITESPACE"," ",282],["T_DOUBLE_ARROW","=>",282],["T_WHITESPACE"," ",282],["T_VARIABLE","$oldPath",282],"]",")",["T_WHITESPACE","\n        ",282],")",";",["T_WHITESPACE","\n\n        ",283],["T_VARIABLE","$data",285],["T_WHITESPACE"," ",285],"=",["T_WHITESPACE"," ",285],["T_VARIABLE","$connection",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","fetchRow",285],"(",["T_VARIABLE","$select",285],")",";",["T_WHITESPACE","\n        ",285],["T_IF","if",286],["T_WHITESPACE"," ",286],"(","!",["T_VARIABLE","$data",286],")",["T_WHITESPACE"," ",286],"{",["T_WHITESPACE","\n            ",286],["T_RETURN","return",287],["T_WHITESPACE"," ",287],["T_VARIABLE","$this",287],";",["T_WHITESPACE","\n        ",287],"}",["T_WHITESPACE","\n\n        ",288],["T_IF","if",290],["T_WHITESPACE"," ",290],"(",["T_ISSET","isset",290],"(",["T_VARIABLE","$data",290],"[",["T_CONSTANT_ENCAPSED_STRING","'file_id'",290],"]",")",["T_WHITESPACE"," ",290],["T_BOOLEAN_AND","&&",290],["T_WHITESPACE"," ",290],["T_ISSET","isset",290],"(",["T_VARIABLE","$data",290],"[",["T_CONSTANT_ENCAPSED_STRING","'filename'",290],"]",")",")",["T_WHITESPACE"," ",290],"{",["T_WHITESPACE","\n            ",290],["T_UNSET","unset",291],"(",["T_VARIABLE","$data",291],"[",["T_CONSTANT_ENCAPSED_STRING","'file_id'",291],"]",")",";",["T_WHITESPACE","\n            ",291],["T_VARIABLE","$data",292],"[",["T_CONSTANT_ENCAPSED_STRING","'filename'",292],"]",["T_WHITESPACE"," ",292],"=",["T_WHITESPACE"," ",292],["T_VARIABLE","$newFilename",292],";",["T_WHITESPACE","\n            ",292],["T_VARIABLE","$data",293],"[",["T_CONSTANT_ENCAPSED_STRING","'directory'",293],"]",["T_WHITESPACE"," ",293],"=",["T_WHITESPACE"," ",293],["T_VARIABLE","$newPath",293],";",["T_WHITESPACE","\n\n            ",293],["T_VARIABLE","$connection",295],["T_WHITESPACE"," ",295],"=",["T_WHITESPACE"," ",295],["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","getConnection",295],"(",")",";",["T_WHITESPACE","\n            ",295],["T_VARIABLE","$connection",296],["T_OBJECT_OPERATOR","->",296],["T_STRING","insertOnDuplicate",296],"(",["T_VARIABLE","$this",296],["T_OBJECT_OPERATOR","->",296],["T_STRING","getMainTable",296],"(",")",",",["T_WHITESPACE"," ",296],["T_VARIABLE","$data",296],",",["T_WHITESPACE"," ",296],"[",["T_CONSTANT_ENCAPSED_STRING","'content'",296],",",["T_WHITESPACE"," ",296],["T_CONSTANT_ENCAPSED_STRING","'upload_time'",296],"]",")",";",["T_WHITESPACE","\n        ",296],"}",["T_WHITESPACE","\n\n        ",297],["T_RETURN","return",299],["T_WHITESPACE"," ",299],["T_VARIABLE","$this",299],";",["T_WHITESPACE","\n    ",299],"}",["T_WHITESPACE","\n\n    ",300],["T_DOC_COMMENT","\/**\n     * Check whether file exists in DB\n     *\n     * @param string $filename\n     * @param string $path\n     * @return bool\n     *\/",302],["T_WHITESPACE","\n    ",308],["T_PUBLIC","public",309],["T_WHITESPACE"," ",309],["T_FUNCTION","function",309],["T_WHITESPACE"," ",309],["T_STRING","fileExists",309],"(",["T_VARIABLE","$filename",309],",",["T_WHITESPACE"," ",309],["T_VARIABLE","$path",309],")",["T_WHITESPACE","\n    ",309],"{",["T_WHITESPACE","\n        ",310],["T_VARIABLE","$connection",311],["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","getConnection",311],"(",")",";",["T_WHITESPACE","\n\n        ",311],["T_VARIABLE","$select",313],["T_WHITESPACE"," ",313],"=",["T_WHITESPACE"," ",313],["T_VARIABLE","$connection",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","select",313],"(",")",["T_OBJECT_OPERATOR","->",313],["T_STRING","from",313],"(",["T_WHITESPACE","\n            ",313],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",314],["T_WHITESPACE"," ",314],["T_DOUBLE_ARROW","=>",314],["T_WHITESPACE"," ",314],["T_VARIABLE","$this",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","getMainTable",314],"(",")","]",["T_WHITESPACE","\n        ",314],")",["T_OBJECT_OPERATOR","->",315],["T_STRING","where",315],"(",["T_WHITESPACE","\n            ",315],["T_CONSTANT_ENCAPSED_STRING","'filename = ?'",316],",",["T_WHITESPACE","\n            ",316],["T_VARIABLE","$filename",317],["T_WHITESPACE","\n        ",317],")",["T_OBJECT_OPERATOR","->",318],["T_STRING","where",318],"(",["T_WHITESPACE","\n            ",318],["T_VARIABLE","$connection",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","prepareSqlCondition",319],"(",["T_CONSTANT_ENCAPSED_STRING","'directory'",319],",",["T_WHITESPACE"," ",319],"[",["T_CONSTANT_ENCAPSED_STRING","'seq'",319],["T_WHITESPACE"," ",319],["T_DOUBLE_ARROW","=>",319],["T_WHITESPACE"," ",319],["T_VARIABLE","$path",319],"]",")",["T_WHITESPACE","\n        ",319],")",["T_OBJECT_OPERATOR","->",320],["T_STRING","limit",320],"(",["T_WHITESPACE","\n            ",320],["T_LNUMBER","1",321],["T_WHITESPACE","\n        ",321],")",";",["T_WHITESPACE","\n\n        ",322],["T_VARIABLE","$data",324],["T_WHITESPACE"," ",324],"=",["T_WHITESPACE"," ",324],["T_VARIABLE","$connection",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","fetchRow",324],"(",["T_VARIABLE","$select",324],")",";",["T_WHITESPACE","\n        ",324],["T_RETURN","return",325],["T_WHITESPACE"," ",325],["T_BOOL_CAST","(bool)",325],["T_VARIABLE","$data",325],";",["T_WHITESPACE","\n    ",325],"}",["T_WHITESPACE","\n\n    ",326],["T_DOC_COMMENT","\/**\n     * Delete files that starts with given $folderName\n     *\n     * @param string $folderName\n     * @return void\n     *\/",328],["T_WHITESPACE","\n    ",333],["T_PUBLIC","public",334],["T_WHITESPACE"," ",334],["T_FUNCTION","function",334],["T_WHITESPACE"," ",334],["T_STRING","deleteFolder",334],"(",["T_VARIABLE","$folderName",334],["T_WHITESPACE"," ",334],"=",["T_WHITESPACE"," ",334],["T_CONSTANT_ENCAPSED_STRING","''",334],")",["T_WHITESPACE","\n    ",334],"{",["T_WHITESPACE","\n        ",335],["T_VARIABLE","$folderName",336],["T_WHITESPACE"," ",336],"=",["T_WHITESPACE"," ",336],["T_STRING","rtrim",336],"(",["T_VARIABLE","$folderName",336],",",["T_WHITESPACE"," ",336],["T_CONSTANT_ENCAPSED_STRING","'\/'",336],")",";",["T_WHITESPACE","\n        ",336],["T_IF","if",337],["T_WHITESPACE"," ",337],"(","!",["T_STRING","strlen",337],"(",["T_VARIABLE","$folderName",337],")",")",["T_WHITESPACE"," ",337],"{",["T_WHITESPACE","\n            ",337],["T_RETURN","return",338],";",["T_WHITESPACE","\n        ",338],"}",["T_WHITESPACE","\n\n        ",339],["T_VARIABLE","$likeExpression",341],["T_WHITESPACE"," ",341],"=",["T_WHITESPACE"," ",341],["T_VARIABLE","$this",341],["T_OBJECT_OPERATOR","->",341],["T_STRING","_resourceHelper",341],["T_OBJECT_OPERATOR","->",341],["T_STRING","addLikeEscape",341],"(",["T_VARIABLE","$folderName",341],["T_WHITESPACE"," ",341],".",["T_WHITESPACE"," ",341],["T_CONSTANT_ENCAPSED_STRING","'\/'",341],",",["T_WHITESPACE"," ",341],"[",["T_CONSTANT_ENCAPSED_STRING","'position'",341],["T_WHITESPACE"," ",341],["T_DOUBLE_ARROW","=>",341],["T_WHITESPACE"," ",341],["T_CONSTANT_ENCAPSED_STRING","'start'",341],"]",")",";",["T_WHITESPACE","\n        ",341],["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","getConnection",342],"(",")",["T_OBJECT_OPERATOR","->",342],["T_STRING","delete",342],"(",["T_WHITESPACE","\n            ",342],["T_VARIABLE","$this",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","getMainTable",343],"(",")",",",["T_WHITESPACE","\n            ",343],["T_NEW","new",344],["T_WHITESPACE"," ",344],["T_NS_SEPARATOR","\\",344],["T_STRING","Zend_Db_Expr",344],"(",["T_CONSTANT_ENCAPSED_STRING","'filename LIKE '",344],["T_WHITESPACE"," ",344],".",["T_WHITESPACE"," ",344],["T_VARIABLE","$likeExpression",344],")",["T_WHITESPACE","\n        ",344],")",";",["T_WHITESPACE","\n    ",345],"}",["T_WHITESPACE","\n\n    ",346],["T_DOC_COMMENT","\/**\n     * Delete file\n     *\n     * @param string $filename\n     * @param string $directory\n     * @return void\n     *\/",348],["T_WHITESPACE","\n    ",354],["T_PUBLIC","public",355],["T_WHITESPACE"," ",355],["T_FUNCTION","function",355],["T_WHITESPACE"," ",355],["T_STRING","deleteFile",355],"(",["T_VARIABLE","$filename",355],",",["T_WHITESPACE"," ",355],["T_VARIABLE","$directory",355],")",["T_WHITESPACE","\n    ",355],"{",["T_WHITESPACE","\n        ",356],["T_VARIABLE","$connection",357],["T_WHITESPACE"," ",357],"=",["T_WHITESPACE"," ",357],["T_VARIABLE","$this",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","getConnection",357],"(",")",";",["T_WHITESPACE","\n\n        ",357],["T_VARIABLE","$where",359],["T_WHITESPACE"," ",359],"=",["T_WHITESPACE"," ",359],"[",["T_CONSTANT_ENCAPSED_STRING","'filename = ?'",359],["T_WHITESPACE"," ",359],["T_DOUBLE_ARROW","=>",359],["T_WHITESPACE"," ",359],["T_VARIABLE","$filename",359],"]",";",["T_WHITESPACE","\n        ",359],["T_VARIABLE","$where",360],"[","]",["T_WHITESPACE"," ",360],"=",["T_WHITESPACE"," ",360],["T_NEW","new",360],["T_WHITESPACE"," ",360],["T_NS_SEPARATOR","\\",360],["T_STRING","Zend_Db_Expr",360],"(",["T_VARIABLE","$connection",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","prepareSqlCondition",360],"(",["T_CONSTANT_ENCAPSED_STRING","'directory'",360],",",["T_WHITESPACE"," ",360],"[",["T_CONSTANT_ENCAPSED_STRING","'seq'",360],["T_WHITESPACE"," ",360],["T_DOUBLE_ARROW","=>",360],["T_WHITESPACE"," ",360],["T_VARIABLE","$directory",360],"]",")",")",";",["T_WHITESPACE","\n\n        ",360],["T_VARIABLE","$connection",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","delete",362],"(",["T_VARIABLE","$this",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","getMainTable",362],"(",")",",",["T_WHITESPACE"," ",362],["T_VARIABLE","$where",362],")",";",["T_WHITESPACE","\n    ",362],"}",["T_WHITESPACE","\n\n    ",363],["T_DOC_COMMENT","\/**\n     * Return directory file listing\n     *\n     * @param string $directory\n     * @return array\n     *\/",365],["T_WHITESPACE","\n    ",370],["T_PUBLIC","public",371],["T_WHITESPACE"," ",371],["T_FUNCTION","function",371],["T_WHITESPACE"," ",371],["T_STRING","getDirectoryFiles",371],"(",["T_VARIABLE","$directory",371],")",["T_WHITESPACE","\n    ",371],"{",["T_WHITESPACE","\n        ",372],["T_VARIABLE","$directory",373],["T_WHITESPACE"," ",373],"=",["T_WHITESPACE"," ",373],["T_STRING","trim",373],"(",["T_VARIABLE","$directory",373],",",["T_WHITESPACE"," ",373],["T_CONSTANT_ENCAPSED_STRING","'\/'",373],")",";",["T_WHITESPACE","\n        ",373],["T_VARIABLE","$connection",374],["T_WHITESPACE"," ",374],"=",["T_WHITESPACE"," ",374],["T_VARIABLE","$this",374],["T_OBJECT_OPERATOR","->",374],["T_STRING","getConnection",374],"(",")",";",["T_WHITESPACE","\n\n        ",374],["T_VARIABLE","$select",376],["T_WHITESPACE"," ",376],"=",["T_WHITESPACE"," ",376],["T_VARIABLE","$connection",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","select",376],"(",")",["T_OBJECT_OPERATOR","->",376],["T_STRING","from",376],"(",["T_WHITESPACE","\n            ",376],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",377],["T_WHITESPACE"," ",377],["T_DOUBLE_ARROW","=>",377],["T_WHITESPACE"," ",377],["T_VARIABLE","$this",377],["T_OBJECT_OPERATOR","->",377],["T_STRING","getMainTable",377],"(",")","]",",",["T_WHITESPACE","\n            ",377],"[",["T_CONSTANT_ENCAPSED_STRING","'filename'",378],",",["T_WHITESPACE"," ",378],["T_CONSTANT_ENCAPSED_STRING","'directory'",378],",",["T_WHITESPACE"," ",378],["T_CONSTANT_ENCAPSED_STRING","'content'",378],"]",["T_WHITESPACE","\n        ",378],")",["T_OBJECT_OPERATOR","->",379],["T_STRING","where",379],"(",["T_WHITESPACE","\n            ",379],["T_VARIABLE","$connection",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","prepareSqlCondition",380],"(",["T_CONSTANT_ENCAPSED_STRING","'directory'",380],",",["T_WHITESPACE"," ",380],"[",["T_CONSTANT_ENCAPSED_STRING","'seq'",380],["T_WHITESPACE"," ",380],["T_DOUBLE_ARROW","=>",380],["T_WHITESPACE"," ",380],["T_VARIABLE","$directory",380],"]",")",["T_WHITESPACE","\n        ",380],")",["T_OBJECT_OPERATOR","->",381],["T_STRING","order",381],"(",["T_WHITESPACE","\n            ",381],["T_CONSTANT_ENCAPSED_STRING","'file_id'",382],["T_WHITESPACE","\n        ",382],")",";",["T_WHITESPACE","\n\n        ",383],["T_VARIABLE","$rows",385],["T_WHITESPACE"," ",385],"=",["T_WHITESPACE"," ",385],["T_VARIABLE","$connection",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","fetchAll",385],"(",["T_VARIABLE","$select",385],")",";",["T_WHITESPACE","\n        ",385],["T_RETURN","return",386],["T_WHITESPACE"," ",386],["T_VARIABLE","$this",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","_decodeAllFilesContent",386],"(",["T_VARIABLE","$rows",386],")",";",["T_WHITESPACE","\n    ",386],"}",["T_WHITESPACE","\n",387],"}",["T_WHITESPACE","\n",388]]