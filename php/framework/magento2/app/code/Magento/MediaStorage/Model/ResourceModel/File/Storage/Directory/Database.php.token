[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","MediaStorage",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","ResourceModel",6],["T_NS_SEPARATOR","\\",6],["T_STRING","File",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Storage",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Directory",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Class Database\n *\/",8],["T_WHITESPACE","\n",10],["T_CLASS","class",11],["T_WHITESPACE"," ",11],["T_STRING","Database",11],["T_WHITESPACE"," ",11],["T_EXTENDS","extends",11],["T_WHITESPACE"," ",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","MediaStorage",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Model",11],["T_NS_SEPARATOR","\\",11],["T_STRING","ResourceModel",11],["T_NS_SEPARATOR","\\",11],["T_STRING","File",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Storage",11],["T_NS_SEPARATOR","\\",11],["T_STRING","AbstractStorage",11],["T_WHITESPACE","\n",11],"{",["T_WHITESPACE","\n    ",12],["T_DOC_COMMENT","\/**\n     * Define table name and id field for resource\n     *\n     * @return void\n     *\/",13],["T_WHITESPACE","\n    ",17],["T_PROTECTED","protected",18],["T_WHITESPACE"," ",18],["T_FUNCTION","function",18],["T_WHITESPACE"," ",18],["T_STRING","_construct",18],"(",")",["T_WHITESPACE","\n    ",18],"{",["T_WHITESPACE","\n        ",19],["T_VARIABLE","$this",20],["T_OBJECT_OPERATOR","->",20],["T_STRING","_init",20],"(",["T_CONSTANT_ENCAPSED_STRING","'media_storage_directory_storage'",20],",",["T_WHITESPACE"," ",20],["T_CONSTANT_ENCAPSED_STRING","'directory_id'",20],")",";",["T_WHITESPACE","\n    ",20],"}",["T_WHITESPACE","\n\n    ",21],["T_DOC_COMMENT","\/**\n     * Create database scheme for storing files\n     *\n     * @return $this\n     *\/",23],["T_WHITESPACE","\n    ",27],["T_PUBLIC","public",28],["T_WHITESPACE"," ",28],["T_FUNCTION","function",28],["T_WHITESPACE"," ",28],["T_STRING","createDatabaseScheme",28],"(",")",["T_WHITESPACE","\n    ",28],"{",["T_WHITESPACE","\n        ",29],["T_VARIABLE","$connection",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","getConnection",30],"(",")",";",["T_WHITESPACE","\n        ",30],["T_VARIABLE","$table",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","getMainTable",31],"(",")",";",["T_WHITESPACE","\n        ",31],["T_IF","if",32],["T_WHITESPACE"," ",32],"(",["T_VARIABLE","$connection",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","isTableExists",32],"(",["T_VARIABLE","$table",32],")",")",["T_WHITESPACE"," ",32],"{",["T_WHITESPACE","\n            ",32],["T_RETURN","return",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$this",33],";",["T_WHITESPACE","\n        ",33],"}",["T_WHITESPACE","\n\n        ",34],["T_VARIABLE","$ddlTable",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$connection",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","newTable",36],"(",["T_WHITESPACE","\n            ",36],["T_VARIABLE","$table",37],["T_WHITESPACE","\n        ",37],")",["T_OBJECT_OPERATOR","->",38],["T_STRING","addColumn",38],"(",["T_WHITESPACE","\n            ",38],["T_CONSTANT_ENCAPSED_STRING","'directory_id'",39],",",["T_WHITESPACE","\n            ",39],["T_NS_SEPARATOR","\\",40],["T_STRING","Magento",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Framework",40],["T_NS_SEPARATOR","\\",40],["T_STRING","DB",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Ddl",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Table",40],["T_DOUBLE_COLON","::",40],["T_STRING","TYPE_INTEGER",40],",",["T_WHITESPACE","\n            ",40],["T_STRING","null",41],",",["T_WHITESPACE","\n            ",41],"[",["T_CONSTANT_ENCAPSED_STRING","'identity'",42],["T_WHITESPACE"," ",42],["T_DOUBLE_ARROW","=>",42],["T_WHITESPACE"," ",42],["T_STRING","true",42],",",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",42],["T_WHITESPACE"," ",42],["T_DOUBLE_ARROW","=>",42],["T_WHITESPACE"," ",42],["T_STRING","true",42],",",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'nullable'",42],["T_WHITESPACE"," ",42],["T_DOUBLE_ARROW","=>",42],["T_WHITESPACE"," ",42],["T_STRING","false",42],",",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'primary'",42],["T_WHITESPACE"," ",42],["T_DOUBLE_ARROW","=>",42],["T_WHITESPACE"," ",42],["T_STRING","true",42],"]",",",["T_WHITESPACE","\n            ",42],["T_CONSTANT_ENCAPSED_STRING","'Directory Id'",43],["T_WHITESPACE","\n        ",43],")",["T_OBJECT_OPERATOR","->",44],["T_STRING","addColumn",44],"(",["T_WHITESPACE","\n            ",44],["T_CONSTANT_ENCAPSED_STRING","'name'",45],",",["T_WHITESPACE","\n            ",45],["T_NS_SEPARATOR","\\",46],["T_STRING","Magento",46],["T_NS_SEPARATOR","\\",46],["T_STRING","Framework",46],["T_NS_SEPARATOR","\\",46],["T_STRING","DB",46],["T_NS_SEPARATOR","\\",46],["T_STRING","Ddl",46],["T_NS_SEPARATOR","\\",46],["T_STRING","Table",46],["T_DOUBLE_COLON","::",46],["T_STRING","TYPE_TEXT",46],",",["T_WHITESPACE","\n            ",46],["T_LNUMBER","100",47],",",["T_WHITESPACE","\n            ",47],"[",["T_CONSTANT_ENCAPSED_STRING","'nullable'",48],["T_WHITESPACE"," ",48],["T_DOUBLE_ARROW","=>",48],["T_WHITESPACE"," ",48],["T_STRING","false",48],"]",",",["T_WHITESPACE","\n            ",48],["T_CONSTANT_ENCAPSED_STRING","'Directory Name'",49],["T_WHITESPACE","\n        ",49],")",["T_OBJECT_OPERATOR","->",50],["T_STRING","addColumn",50],"(",["T_WHITESPACE","\n            ",50],["T_CONSTANT_ENCAPSED_STRING","'path'",51],",",["T_WHITESPACE","\n            ",51],["T_NS_SEPARATOR","\\",52],["T_STRING","Magento",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Framework",52],["T_NS_SEPARATOR","\\",52],["T_STRING","DB",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Ddl",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Table",52],["T_DOUBLE_COLON","::",52],["T_STRING","TYPE_TEXT",52],",",["T_WHITESPACE","\n            ",52],["T_LNUMBER","255",53],",",["T_WHITESPACE","\n            ",53],"[",["T_CONSTANT_ENCAPSED_STRING","'default'",54],["T_WHITESPACE"," ",54],["T_DOUBLE_ARROW","=>",54],["T_WHITESPACE"," ",54],["T_STRING","null",54],"]",",",["T_WHITESPACE","\n            ",54],["T_CONSTANT_ENCAPSED_STRING","'Path to the \\Directory'",55],["T_WHITESPACE","\n        ",55],")",["T_OBJECT_OPERATOR","->",56],["T_STRING","addColumn",56],"(",["T_WHITESPACE","\n            ",56],["T_CONSTANT_ENCAPSED_STRING","'upload_time'",57],",",["T_WHITESPACE","\n            ",57],["T_NS_SEPARATOR","\\",58],["T_STRING","Magento",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Framework",58],["T_NS_SEPARATOR","\\",58],["T_STRING","DB",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Ddl",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Table",58],["T_DOUBLE_COLON","::",58],["T_STRING","TYPE_TIMESTAMP",58],",",["T_WHITESPACE","\n            ",58],["T_STRING","null",59],",",["T_WHITESPACE","\n            ",59],"[",["T_CONSTANT_ENCAPSED_STRING","'nullable'",60],["T_WHITESPACE"," ",60],["T_DOUBLE_ARROW","=>",60],["T_WHITESPACE"," ",60],["T_STRING","false",60],",",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'default'",60],["T_WHITESPACE"," ",60],["T_DOUBLE_ARROW","=>",60],["T_WHITESPACE"," ",60],["T_NS_SEPARATOR","\\",60],["T_STRING","Magento",60],["T_NS_SEPARATOR","\\",60],["T_STRING","Framework",60],["T_NS_SEPARATOR","\\",60],["T_STRING","DB",60],["T_NS_SEPARATOR","\\",60],["T_STRING","Ddl",60],["T_NS_SEPARATOR","\\",60],["T_STRING","Table",60],["T_DOUBLE_COLON","::",60],["T_STRING","TIMESTAMP_INIT",60],"]",",",["T_WHITESPACE","\n            ",60],["T_CONSTANT_ENCAPSED_STRING","'Upload Timestamp'",61],["T_WHITESPACE","\n        ",61],")",["T_OBJECT_OPERATOR","->",62],["T_STRING","addColumn",62],"(",["T_WHITESPACE","\n            ",62],["T_CONSTANT_ENCAPSED_STRING","'parent_id'",63],",",["T_WHITESPACE","\n            ",63],["T_NS_SEPARATOR","\\",64],["T_STRING","Magento",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Framework",64],["T_NS_SEPARATOR","\\",64],["T_STRING","DB",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Ddl",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Table",64],["T_DOUBLE_COLON","::",64],["T_STRING","TYPE_INTEGER",64],",",["T_WHITESPACE","\n            ",64],["T_STRING","null",65],",",["T_WHITESPACE","\n            ",65],"[",["T_CONSTANT_ENCAPSED_STRING","'nullable'",66],["T_WHITESPACE"," ",66],["T_DOUBLE_ARROW","=>",66],["T_WHITESPACE"," ",66],["T_STRING","true",66],",",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'default'",66],["T_WHITESPACE"," ",66],["T_DOUBLE_ARROW","=>",66],["T_WHITESPACE"," ",66],["T_STRING","null",66],",",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",66],["T_WHITESPACE"," ",66],["T_DOUBLE_ARROW","=>",66],["T_WHITESPACE"," ",66],["T_STRING","true",66],"]",",",["T_WHITESPACE","\n            ",66],["T_CONSTANT_ENCAPSED_STRING","'Parent \\Directory Id'",67],["T_WHITESPACE","\n        ",67],")",["T_OBJECT_OPERATOR","->",68],["T_STRING","addIndex",68],"(",["T_WHITESPACE","\n            ",68],["T_VARIABLE","$connection",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getIndexName",69],"(",["T_WHITESPACE","\n                ",69],["T_VARIABLE","$table",70],",",["T_WHITESPACE","\n                ",70],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",71],",",["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'parent_id'",71],"]",",",["T_WHITESPACE","\n                ",71],["T_NS_SEPARATOR","\\",72],["T_STRING","Magento",72],["T_NS_SEPARATOR","\\",72],["T_STRING","Framework",72],["T_NS_SEPARATOR","\\",72],["T_STRING","DB",72],["T_NS_SEPARATOR","\\",72],["T_STRING","Adapter",72],["T_NS_SEPARATOR","\\",72],["T_STRING","AdapterInterface",72],["T_DOUBLE_COLON","::",72],["T_STRING","INDEX_TYPE_UNIQUE",72],["T_WHITESPACE","\n            ",72],")",",",["T_WHITESPACE","\n            ",73],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",74],",",["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","'parent_id'",74],"]",",",["T_WHITESPACE","\n            ",74],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",75],["T_WHITESPACE"," ",75],["T_DOUBLE_ARROW","=>",75],["T_WHITESPACE"," ",75],["T_NS_SEPARATOR","\\",75],["T_STRING","Magento",75],["T_NS_SEPARATOR","\\",75],["T_STRING","Framework",75],["T_NS_SEPARATOR","\\",75],["T_STRING","DB",75],["T_NS_SEPARATOR","\\",75],["T_STRING","Adapter",75],["T_NS_SEPARATOR","\\",75],["T_STRING","AdapterInterface",75],["T_DOUBLE_COLON","::",75],["T_STRING","INDEX_TYPE_UNIQUE",75],"]",["T_WHITESPACE","\n        ",75],")",["T_OBJECT_OPERATOR","->",76],["T_STRING","addIndex",76],"(",["T_WHITESPACE","\n            ",76],["T_VARIABLE","$connection",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getIndexName",77],"(",["T_VARIABLE","$table",77],",",["T_WHITESPACE"," ",77],"[",["T_CONSTANT_ENCAPSED_STRING","'parent_id'",77],"]",")",",",["T_WHITESPACE","\n            ",77],"[",["T_CONSTANT_ENCAPSED_STRING","'parent_id'",78],"]",["T_WHITESPACE","\n        ",78],")",["T_OBJECT_OPERATOR","->",79],["T_STRING","addForeignKey",79],"(",["T_WHITESPACE","\n            ",79],["T_VARIABLE","$connection",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getForeignKeyName",80],"(",["T_VARIABLE","$table",80],",",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'parent_id'",80],",",["T_WHITESPACE"," ",80],["T_VARIABLE","$table",80],",",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'directory_id'",80],")",",",["T_WHITESPACE","\n            ",80],["T_CONSTANT_ENCAPSED_STRING","'parent_id'",81],",",["T_WHITESPACE","\n            ",81],["T_VARIABLE","$table",82],",",["T_WHITESPACE","\n            ",82],["T_CONSTANT_ENCAPSED_STRING","'directory_id'",83],",",["T_WHITESPACE","\n            ",83],["T_NS_SEPARATOR","\\",84],["T_STRING","Magento",84],["T_NS_SEPARATOR","\\",84],["T_STRING","Framework",84],["T_NS_SEPARATOR","\\",84],["T_STRING","DB",84],["T_NS_SEPARATOR","\\",84],["T_STRING","Ddl",84],["T_NS_SEPARATOR","\\",84],["T_STRING","Table",84],["T_DOUBLE_COLON","::",84],["T_STRING","ACTION_CASCADE",84],["T_WHITESPACE","\n        ",84],")",["T_OBJECT_OPERATOR","->",85],["T_STRING","setComment",85],"(",["T_WHITESPACE","\n            ",85],["T_CONSTANT_ENCAPSED_STRING","'Directory Storage'",86],["T_WHITESPACE","\n        ",86],")",";",["T_WHITESPACE","\n\n        ",87],["T_VARIABLE","$connection",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","createTable",89],"(",["T_VARIABLE","$ddlTable",89],")",";",["T_WHITESPACE","\n        ",89],["T_RETURN","return",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],";",["T_WHITESPACE","\n    ",90],"}",["T_WHITESPACE","\n\n    ",91],["T_DOC_COMMENT","\/**\n     * Load entity by path\n     *\n     * @param  \\Magento\\MediaStorage\\Model\\File\\Storage\\Directory\\Database $object\n     * @param  string $path\n     * @return $this\n     *\/",93],["T_WHITESPACE","\n    ",99],["T_PUBLIC","public",100],["T_WHITESPACE"," ",100],["T_FUNCTION","function",100],["T_WHITESPACE"," ",100],["T_STRING","loadByPath",100],"(",["T_NS_SEPARATOR","\\",100],["T_STRING","Magento",100],["T_NS_SEPARATOR","\\",100],["T_STRING","MediaStorage",100],["T_NS_SEPARATOR","\\",100],["T_STRING","Model",100],["T_NS_SEPARATOR","\\",100],["T_STRING","File",100],["T_NS_SEPARATOR","\\",100],["T_STRING","Storage",100],["T_NS_SEPARATOR","\\",100],["T_STRING","Directory",100],["T_NS_SEPARATOR","\\",100],["T_STRING","Database",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$object",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$path",100],")",["T_WHITESPACE","\n    ",100],"{",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$connection",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getConnection",102],"(",")",";",["T_WHITESPACE","\n\n        ",102],["T_VARIABLE","$name",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_STRING","basename",104],"(",["T_VARIABLE","$path",104],")",";",["T_WHITESPACE","\n        ",104],["T_VARIABLE","$path",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_STRING","dirname",105],"(",["T_VARIABLE","$path",105],")",";",["T_WHITESPACE","\n        ",105],["T_IF","if",106],["T_WHITESPACE"," ",106],"(",["T_VARIABLE","$path",106],["T_WHITESPACE"," ",106],["T_IS_EQUAL","==",106],["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'.'",106],")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n            ",106],["T_VARIABLE","$path",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","''",107],";",["T_WHITESPACE","\n        ",107],"}",["T_WHITESPACE","\n\n        ",108],["T_VARIABLE","$select",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$connection",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","select",110],"(",")",["T_OBJECT_OPERATOR","->",110],["T_STRING","from",110],"(",["T_WHITESPACE","\n            ",110],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",111],["T_WHITESPACE"," ",111],["T_DOUBLE_ARROW","=>",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","getMainTable",111],"(",")","]",["T_WHITESPACE","\n        ",111],")",["T_OBJECT_OPERATOR","->",112],["T_STRING","where",112],"(",["T_WHITESPACE","\n            ",112],["T_CONSTANT_ENCAPSED_STRING","'name = ?'",113],",",["T_WHITESPACE","\n            ",113],["T_VARIABLE","$name",114],["T_WHITESPACE","\n        ",114],")",["T_OBJECT_OPERATOR","->",115],["T_STRING","where",115],"(",["T_WHITESPACE","\n            ",115],["T_VARIABLE","$connection",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","prepareSqlCondition",116],"(",["T_CONSTANT_ENCAPSED_STRING","'path'",116],",",["T_WHITESPACE"," ",116],"[",["T_CONSTANT_ENCAPSED_STRING","'seq'",116],["T_WHITESPACE"," ",116],["T_DOUBLE_ARROW","=>",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$path",116],"]",")",["T_WHITESPACE","\n        ",116],")",";",["T_WHITESPACE","\n\n        ",117],["T_VARIABLE","$data",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$connection",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","fetchRow",119],"(",["T_VARIABLE","$select",119],")",";",["T_WHITESPACE","\n        ",119],["T_IF","if",120],["T_WHITESPACE"," ",120],"(",["T_VARIABLE","$data",120],")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n            ",120],["T_VARIABLE","$object",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","setData",121],"(",["T_VARIABLE","$data",121],")",";",["T_WHITESPACE","\n            ",121],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","_afterLoad",122],"(",["T_VARIABLE","$object",122],")",";",["T_WHITESPACE","\n        ",122],"}",["T_WHITESPACE","\n\n        ",123],["T_RETURN","return",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$this",125],";",["T_WHITESPACE","\n    ",125],"}",["T_WHITESPACE","\n\n    ",126],["T_DOC_COMMENT","\/**\n     * Return parent id\n     *\n     * @param string $path\n     * @return int\n     *\/",128],["T_WHITESPACE","\n    ",133],["T_PUBLIC","public",134],["T_WHITESPACE"," ",134],["T_FUNCTION","function",134],["T_WHITESPACE"," ",134],["T_STRING","getParentId",134],"(",["T_VARIABLE","$path",134],")",["T_WHITESPACE","\n    ",134],"{",["T_WHITESPACE","\n        ",135],["T_VARIABLE","$connection",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getConnection",136],"(",")",";",["T_WHITESPACE","\n\n        ",136],["T_VARIABLE","$name",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_STRING","basename",138],"(",["T_VARIABLE","$path",138],")",";",["T_WHITESPACE","\n        ",138],["T_VARIABLE","$path",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_STRING","dirname",139],"(",["T_VARIABLE","$path",139],")",";",["T_WHITESPACE","\n        ",139],["T_IF","if",140],["T_WHITESPACE"," ",140],"(",["T_VARIABLE","$path",140],["T_WHITESPACE"," ",140],["T_IS_EQUAL","==",140],["T_WHITESPACE"," ",140],["T_CONSTANT_ENCAPSED_STRING","'.'",140],")",["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n            ",140],["T_VARIABLE","$path",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_CONSTANT_ENCAPSED_STRING","''",141],";",["T_WHITESPACE","\n        ",141],"}",["T_WHITESPACE","\n\n        ",142],["T_VARIABLE","$select",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_VARIABLE","$connection",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","select",144],"(",")",["T_OBJECT_OPERATOR","->",144],["T_STRING","from",144],"(",["T_WHITESPACE","\n            ",144],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",145],["T_WHITESPACE"," ",145],["T_DOUBLE_ARROW","=>",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getMainTable",145],"(",")","]",",",["T_WHITESPACE","\n            ",145],"[",["T_CONSTANT_ENCAPSED_STRING","'directory_id'",146],"]",["T_WHITESPACE","\n        ",146],")",["T_OBJECT_OPERATOR","->",147],["T_STRING","where",147],"(",["T_WHITESPACE","\n            ",147],["T_CONSTANT_ENCAPSED_STRING","'name = ?'",148],",",["T_WHITESPACE","\n            ",148],["T_VARIABLE","$name",149],["T_WHITESPACE","\n        ",149],")",["T_OBJECT_OPERATOR","->",150],["T_STRING","where",150],"(",["T_WHITESPACE","\n            ",150],["T_VARIABLE","$connection",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","prepareSqlCondition",151],"(",["T_CONSTANT_ENCAPSED_STRING","'path'",151],",",["T_WHITESPACE"," ",151],"[",["T_CONSTANT_ENCAPSED_STRING","'seq'",151],["T_WHITESPACE"," ",151],["T_DOUBLE_ARROW","=>",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$path",151],"]",")",["T_WHITESPACE","\n        ",151],")",";",["T_WHITESPACE","\n\n        ",152],["T_RETURN","return",154],["T_WHITESPACE"," ",154],["T_VARIABLE","$connection",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","fetchOne",154],"(",["T_VARIABLE","$select",154],")",";",["T_WHITESPACE","\n    ",154],"}",["T_WHITESPACE","\n\n    ",155],["T_DOC_COMMENT","\/**\n     * Delete all directories from storage\n     *\n     * @return $this\n     *\/",157],["T_WHITESPACE","\n    ",161],["T_PUBLIC","public",162],["T_WHITESPACE"," ",162],["T_FUNCTION","function",162],["T_WHITESPACE"," ",162],["T_STRING","clearDirectories",162],"(",")",["T_WHITESPACE","\n    ",162],"{",["T_WHITESPACE","\n        ",163],["T_VARIABLE","$connection",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","getConnection",164],"(",")",";",["T_WHITESPACE","\n        ",164],["T_VARIABLE","$connection",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","delete",165],"(",["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","getMainTable",165],"(",")",")",";",["T_WHITESPACE","\n\n        ",165],["T_RETURN","return",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$this",167],";",["T_WHITESPACE","\n    ",167],"}",["T_WHITESPACE","\n\n    ",168],["T_DOC_COMMENT","\/**\n     * Export directories from database\n     *\n     * @param int $offset\n     * @param int $count\n     * @return array\n     *\/",170],["T_WHITESPACE","\n    ",176],["T_PUBLIC","public",177],["T_WHITESPACE"," ",177],["T_FUNCTION","function",177],["T_WHITESPACE"," ",177],["T_STRING","exportDirectories",177],"(",["T_VARIABLE","$offset",177],",",["T_WHITESPACE"," ",177],["T_VARIABLE","$count",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_LNUMBER","100",177],")",["T_WHITESPACE","\n    ",177],"{",["T_WHITESPACE","\n        ",178],["T_VARIABLE","$connection",179],["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","getConnection",179],"(",")",";",["T_WHITESPACE","\n\n        ",179],["T_VARIABLE","$select",181],["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_VARIABLE","$connection",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","select",181],"(",")",["T_OBJECT_OPERATOR","->",181],["T_STRING","from",181],"(",["T_WHITESPACE","\n            ",181],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",182],["T_WHITESPACE"," ",182],["T_DOUBLE_ARROW","=>",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","getMainTable",182],"(",")","]",",",["T_WHITESPACE","\n            ",182],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",183],",",["T_WHITESPACE"," ",183],["T_CONSTANT_ENCAPSED_STRING","'path'",183],"]",["T_WHITESPACE","\n        ",183],")",["T_OBJECT_OPERATOR","->",184],["T_STRING","order",184],"(",["T_WHITESPACE","\n            ",184],["T_CONSTANT_ENCAPSED_STRING","'directory_id'",185],["T_WHITESPACE","\n        ",185],")",["T_OBJECT_OPERATOR","->",186],["T_STRING","limit",186],"(",["T_WHITESPACE","\n            ",186],["T_VARIABLE","$count",187],",",["T_WHITESPACE","\n            ",187],["T_VARIABLE","$offset",188],["T_WHITESPACE","\n        ",188],")",";",["T_WHITESPACE","\n\n        ",189],["T_RETURN","return",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$connection",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","fetchAll",191],"(",["T_VARIABLE","$select",191],")",";",["T_WHITESPACE","\n    ",191],"}",["T_WHITESPACE","\n\n    ",192],["T_DOC_COMMENT","\/**\n     * Return directory file listing\n     *\n     * @param string $directory\n     * @return array\n     *\/",194],["T_WHITESPACE","\n    ",199],["T_PUBLIC","public",200],["T_WHITESPACE"," ",200],["T_FUNCTION","function",200],["T_WHITESPACE"," ",200],["T_STRING","getSubdirectories",200],"(",["T_VARIABLE","$directory",200],")",["T_WHITESPACE","\n    ",200],"{",["T_WHITESPACE","\n        ",201],["T_VARIABLE","$directory",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_STRING","trim",202],"(",["T_VARIABLE","$directory",202],",",["T_WHITESPACE"," ",202],["T_CONSTANT_ENCAPSED_STRING","'\/'",202],")",";",["T_WHITESPACE","\n        ",202],["T_VARIABLE","$connection",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","getConnection",203],"(",")",";",["T_WHITESPACE","\n\n        ",203],["T_VARIABLE","$select",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_VARIABLE","$connection",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","select",205],"(",")",["T_OBJECT_OPERATOR","->",205],["T_STRING","from",205],"(",["T_WHITESPACE","\n            ",205],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",206],["T_WHITESPACE"," ",206],["T_DOUBLE_ARROW","=>",206],["T_WHITESPACE"," ",206],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","getMainTable",206],"(",")","]",",",["T_WHITESPACE","\n            ",206],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",207],",",["T_WHITESPACE"," ",207],["T_CONSTANT_ENCAPSED_STRING","'path'",207],"]",["T_WHITESPACE","\n        ",207],")",["T_OBJECT_OPERATOR","->",208],["T_STRING","where",208],"(",["T_WHITESPACE","\n            ",208],["T_VARIABLE","$connection",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","prepareSqlCondition",209],"(",["T_CONSTANT_ENCAPSED_STRING","'path'",209],",",["T_WHITESPACE"," ",209],"[",["T_CONSTANT_ENCAPSED_STRING","'seq'",209],["T_WHITESPACE"," ",209],["T_DOUBLE_ARROW","=>",209],["T_WHITESPACE"," ",209],["T_VARIABLE","$directory",209],"]",")",["T_WHITESPACE","\n        ",209],")",["T_OBJECT_OPERATOR","->",210],["T_STRING","order",210],"(",["T_WHITESPACE","\n            ",210],["T_CONSTANT_ENCAPSED_STRING","'directory_id'",211],["T_WHITESPACE","\n        ",211],")",";",["T_WHITESPACE","\n\n        ",212],["T_RETURN","return",214],["T_WHITESPACE"," ",214],["T_VARIABLE","$connection",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","fetchAll",214],"(",["T_VARIABLE","$select",214],")",";",["T_WHITESPACE","\n    ",214],"}",["T_WHITESPACE","\n\n    ",215],["T_DOC_COMMENT","\/**\n     * Delete directory\n     *\n     * @param string $name\n     * @param string $path\n     * @return void\n     *\/",217],["T_WHITESPACE","\n    ",223],["T_PUBLIC","public",224],["T_WHITESPACE"," ",224],["T_FUNCTION","function",224],["T_WHITESPACE"," ",224],["T_STRING","deleteDirectory",224],"(",["T_VARIABLE","$name",224],",",["T_WHITESPACE"," ",224],["T_VARIABLE","$path",224],")",["T_WHITESPACE","\n    ",224],"{",["T_WHITESPACE","\n        ",225],["T_VARIABLE","$connection",226],["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","getConnection",226],"(",")",";",["T_WHITESPACE","\n\n        ",226],["T_VARIABLE","$where",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],"[",["T_CONSTANT_ENCAPSED_STRING","'name = ?'",228],["T_WHITESPACE"," ",228],["T_DOUBLE_ARROW","=>",228],["T_WHITESPACE"," ",228],["T_VARIABLE","$name",228],"]",";",["T_WHITESPACE","\n        ",228],["T_VARIABLE","$where",229],"[","]",["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],["T_NEW","new",229],["T_WHITESPACE"," ",229],["T_NS_SEPARATOR","\\",229],["T_STRING","Zend_Db_Expr",229],"(",["T_VARIABLE","$connection",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","prepareSqlCondition",229],"(",["T_CONSTANT_ENCAPSED_STRING","'path'",229],",",["T_WHITESPACE"," ",229],"[",["T_CONSTANT_ENCAPSED_STRING","'seq'",229],["T_WHITESPACE"," ",229],["T_DOUBLE_ARROW","=>",229],["T_WHITESPACE"," ",229],["T_VARIABLE","$path",229],"]",")",")",";",["T_WHITESPACE","\n\n        ",229],["T_VARIABLE","$connection",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","delete",231],"(",["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","getMainTable",231],"(",")",",",["T_WHITESPACE"," ",231],["T_VARIABLE","$where",231],")",";",["T_WHITESPACE","\n    ",231],"}",["T_WHITESPACE","\n",232],"}",["T_WHITESPACE","\n",233]]