[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Validator for check not protected\/available path\n *\n * Mask symbols from path:\n * \"?\" - something directory with any name\n * \"*\" - something directory structure, which can not exist\n * Note: For set directory structure which must be exist, need to set mask \"\/?\/{@*}\"\n * Mask symbols from filename:\n * \"*\" - something symbols in file name\n * Example:\n * <code>\n * \/\/set available path\n * $validator->setAvailablePath(array('\/path\/to\/?\/*fileMask.xml'));\n * $validator->isValid('\/path\/to\/MyDir\/Some-fileMask.xml'); \/\/return true\n * $validator->setAvailablePath(array('\/path\/to\/{@*}*.xml'));\n * $validator->isValid('\/path\/to\/my.xml'); \/\/return true, because directory structure can't exist\n * <\/code>\n *\n * @author     Magento Core Team <core@magentocommerce.com>\n *\/",7],["T_WHITESPACE","\n",26],["T_NAMESPACE","namespace",27],["T_WHITESPACE"," ",27],["T_STRING","Magento",27],["T_NS_SEPARATOR","\\",27],["T_STRING","MediaStorage",27],["T_NS_SEPARATOR","\\",27],["T_STRING","Model",27],["T_NS_SEPARATOR","\\",27],["T_STRING","File",27],["T_NS_SEPARATOR","\\",27],["T_STRING","Validator",27],";",["T_WHITESPACE","\n\n",27],["T_CLASS","class",29],["T_WHITESPACE"," ",29],["T_STRING","AvailablePath",29],["T_WHITESPACE"," ",29],["T_EXTENDS","extends",29],["T_WHITESPACE"," ",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Zend_Validate_Abstract",29],["T_WHITESPACE","\n",29],"{",["T_WHITESPACE","\n    ",30],["T_CONST","const",31],["T_WHITESPACE"," ",31],["T_STRING","PROTECTED_PATH",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_CONSTANT_ENCAPSED_STRING","'protectedPath'",31],";",["T_WHITESPACE","\n\n    ",31],["T_CONST","const",33],["T_WHITESPACE"," ",33],["T_STRING","NOT_AVAILABLE_PATH",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'notAvailablePath'",33],";",["T_WHITESPACE","\n\n    ",33],["T_CONST","const",35],["T_WHITESPACE"," ",35],["T_STRING","PROTECTED_LFI",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_CONSTANT_ENCAPSED_STRING","'protectedLfi'",35],";",["T_WHITESPACE","\n\n    ",35],["T_DOC_COMMENT","\/**\n     * The path\n     *\n     * @var string\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_value",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Protected paths\n     *\n     * @var string[]\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_protectedPaths",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],"[","]",";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Available paths\n     *\n     * @var string[]\n     *\/",51],["T_WHITESPACE","\n    ",55],["T_PROTECTED","protected",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$_availablePaths",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],"[","]",";",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * Cache of made regular expressions from path masks\n     *\n     * @var array\n     *\/",58],["T_WHITESPACE","\n    ",62],["T_PROTECTED","protected",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$_pathsData",63],";",["T_WHITESPACE","\n\n    ",63],["T_DOC_COMMENT","\/**\n     * Construct\n     *\/",65],["T_WHITESPACE","\n    ",67],["T_PUBLIC","public",68],["T_WHITESPACE"," ",68],["T_FUNCTION","function",68],["T_WHITESPACE"," ",68],["T_STRING","__construct",68],"(",")",["T_WHITESPACE","\n    ",68],"{",["T_WHITESPACE","\n        ",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","_initMessageTemplates",70],"(",")",";",["T_WHITESPACE","\n    ",70],"}",["T_WHITESPACE","\n\n    ",71],["T_DOC_COMMENT","\/**\n     * Initialize message templates with translating\n     *\n     * @return $this\n     *\/",73],["T_WHITESPACE","\n    ",77],["T_PROTECTED","protected",78],["T_WHITESPACE"," ",78],["T_FUNCTION","function",78],["T_WHITESPACE"," ",78],["T_STRING","_initMessageTemplates",78],"(",")",["T_WHITESPACE","\n    ",78],"{",["T_WHITESPACE","\n        ",79],["T_IF","if",80],["T_WHITESPACE"," ",80],"(","!",["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","_messageTemplates",80],")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n            ",80],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","_messageTemplates",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],"[",["T_WHITESPACE","\n                ",81],["T_STRING","self",82],["T_DOUBLE_COLON","::",82],["T_STRING","PROTECTED_PATH",82],["T_WHITESPACE"," ",82],["T_DOUBLE_ARROW","=>",82],["T_WHITESPACE"," ",82],["T_STRING","__",82],"(",["T_CONSTANT_ENCAPSED_STRING","'Path \"%value%\" is protected and cannot be used.'",82],")",",",["T_WHITESPACE","\n                ",82],["T_STRING","self",83],["T_DOUBLE_COLON","::",83],["T_STRING","NOT_AVAILABLE_PATH",83],["T_WHITESPACE"," ",83],["T_DOUBLE_ARROW","=>",83],["T_WHITESPACE"," ",83],["T_STRING","__",83],"(",["T_CONSTANT_ENCAPSED_STRING","'Path \"%value%\" is not available and cannot be used.'",83],")",",",["T_WHITESPACE","\n                ",83],["T_STRING","self",84],["T_DOUBLE_COLON","::",84],["T_STRING","PROTECTED_LFI",84],["T_WHITESPACE"," ",84],["T_DOUBLE_ARROW","=>",84],["T_WHITESPACE"," ",84],["T_STRING","__",84],"(",["T_CONSTANT_ENCAPSED_STRING","'Path \"%value%\" may not include parent directory traversal (\"..\/\", \"..\\\\\").'",84],")",",",["T_WHITESPACE","\n            ",84],"]",";",["T_WHITESPACE","\n        ",85],"}",["T_WHITESPACE","\n        ",86],["T_RETURN","return",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n\n    ",88],["T_DOC_COMMENT","\/**\n     * Set paths masks\n     *\n     * @param array $paths  All paths masks types.\n     *                      E.g.: array('available' => array(...), 'protected' => array(...))\n     * @return $this\n     *\/",90],["T_WHITESPACE","\n    ",96],["T_PUBLIC","public",97],["T_WHITESPACE"," ",97],["T_FUNCTION","function",97],["T_WHITESPACE"," ",97],["T_STRING","setPaths",97],"(",["T_ARRAY","array",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$paths",97],")",["T_WHITESPACE","\n    ",97],"{",["T_WHITESPACE","\n        ",98],["T_IF","if",99],["T_WHITESPACE"," ",99],"(",["T_ISSET","isset",99],"(",["T_VARIABLE","$paths",99],"[",["T_CONSTANT_ENCAPSED_STRING","'available'",99],"]",")",["T_WHITESPACE"," ",99],["T_BOOLEAN_AND","&&",99],["T_WHITESPACE"," ",99],["T_STRING","is_array",99],"(",["T_VARIABLE","$paths",99],"[",["T_CONSTANT_ENCAPSED_STRING","'available'",99],"]",")",")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n            ",99],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","_availablePaths",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$paths",100],"[",["T_CONSTANT_ENCAPSED_STRING","'available'",100],"]",";",["T_WHITESPACE","\n        ",100],"}",["T_WHITESPACE","\n        ",101],["T_IF","if",102],["T_WHITESPACE"," ",102],"(",["T_ISSET","isset",102],"(",["T_VARIABLE","$paths",102],"[",["T_CONSTANT_ENCAPSED_STRING","'protected'",102],"]",")",["T_WHITESPACE"," ",102],["T_BOOLEAN_AND","&&",102],["T_WHITESPACE"," ",102],["T_STRING","is_array",102],"(",["T_VARIABLE","$paths",102],"[",["T_CONSTANT_ENCAPSED_STRING","'protected'",102],"]",")",")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n            ",102],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","_protectedPaths",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$paths",103],"[",["T_CONSTANT_ENCAPSED_STRING","'protected'",103],"]",";",["T_WHITESPACE","\n        ",103],"}",["T_WHITESPACE","\n        ",104],["T_RETURN","return",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],";",["T_WHITESPACE","\n    ",105],"}",["T_WHITESPACE","\n\n    ",106],["T_DOC_COMMENT","\/**\n     * Set protected paths masks\n     *\n     * @param array $paths\n     * @return $this\n     *\/",108],["T_WHITESPACE","\n    ",113],["T_PUBLIC","public",114],["T_WHITESPACE"," ",114],["T_FUNCTION","function",114],["T_WHITESPACE"," ",114],["T_STRING","setProtectedPaths",114],"(",["T_ARRAY","array",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$paths",114],")",["T_WHITESPACE","\n    ",114],"{",["T_WHITESPACE","\n        ",115],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","_protectedPaths",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_VARIABLE","$paths",116],";",["T_WHITESPACE","\n        ",116],["T_RETURN","return",117],["T_WHITESPACE"," ",117],["T_VARIABLE","$this",117],";",["T_WHITESPACE","\n    ",117],"}",["T_WHITESPACE","\n\n    ",118],["T_DOC_COMMENT","\/**\n     * Add protected paths masks\n     *\n     * @param string|string[] $path\n     * @return $this\n     *\/",120],["T_WHITESPACE","\n    ",125],["T_PUBLIC","public",126],["T_WHITESPACE"," ",126],["T_FUNCTION","function",126],["T_WHITESPACE"," ",126],["T_STRING","addProtectedPath",126],"(",["T_VARIABLE","$path",126],")",["T_WHITESPACE","\n    ",126],"{",["T_WHITESPACE","\n        ",127],["T_IF","if",128],["T_WHITESPACE"," ",128],"(",["T_STRING","is_array",128],"(",["T_VARIABLE","$path",128],")",")",["T_WHITESPACE"," ",128],"{",["T_WHITESPACE","\n            ",128],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","_protectedPaths",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_STRING","array_merge",129],"(",["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","_protectedPaths",129],",",["T_WHITESPACE"," ",129],["T_VARIABLE","$path",129],")",";",["T_WHITESPACE","\n        ",129],"}",["T_WHITESPACE"," ",130],["T_ELSE","else",130],["T_WHITESPACE"," ",130],"{",["T_WHITESPACE","\n            ",130],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","_protectedPaths",131],"[","]",["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_VARIABLE","$path",131],";",["T_WHITESPACE","\n        ",131],"}",["T_WHITESPACE","\n        ",132],["T_RETURN","return",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],";",["T_WHITESPACE","\n    ",133],"}",["T_WHITESPACE","\n\n    ",134],["T_DOC_COMMENT","\/**\n     * Get protected paths masks\n     *\n     * @return string[]\n     *\/",136],["T_WHITESPACE","\n    ",140],["T_PUBLIC","public",141],["T_WHITESPACE"," ",141],["T_FUNCTION","function",141],["T_WHITESPACE"," ",141],["T_STRING","getProtectedPaths",141],"(",")",["T_WHITESPACE","\n    ",141],"{",["T_WHITESPACE","\n        ",142],["T_RETURN","return",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","_protectedPaths",143],";",["T_WHITESPACE","\n    ",143],"}",["T_WHITESPACE","\n\n    ",144],["T_DOC_COMMENT","\/**\n     * Set available paths masks\n     *\n     * @param array $paths\n     * @return $this\n     *\/",146],["T_WHITESPACE","\n    ",151],["T_PUBLIC","public",152],["T_WHITESPACE"," ",152],["T_FUNCTION","function",152],["T_WHITESPACE"," ",152],["T_STRING","setAvailablePaths",152],"(",["T_ARRAY","array",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$paths",152],")",["T_WHITESPACE","\n    ",152],"{",["T_WHITESPACE","\n        ",153],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","_availablePaths",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_VARIABLE","$paths",154],";",["T_WHITESPACE","\n        ",154],["T_RETURN","return",155],["T_WHITESPACE"," ",155],["T_VARIABLE","$this",155],";",["T_WHITESPACE","\n    ",155],"}",["T_WHITESPACE","\n\n    ",156],["T_DOC_COMMENT","\/**\n     * Add available paths mask\n     *\n     * @param string|string[] $path\n     * @return $this\n     *\/",158],["T_WHITESPACE","\n    ",163],["T_PUBLIC","public",164],["T_WHITESPACE"," ",164],["T_FUNCTION","function",164],["T_WHITESPACE"," ",164],["T_STRING","addAvailablePath",164],"(",["T_VARIABLE","$path",164],")",["T_WHITESPACE","\n    ",164],"{",["T_WHITESPACE","\n        ",165],["T_IF","if",166],["T_WHITESPACE"," ",166],"(",["T_STRING","is_array",166],"(",["T_VARIABLE","$path",166],")",")",["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n            ",166],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","_availablePaths",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_STRING","array_merge",167],"(",["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","_availablePaths",167],",",["T_WHITESPACE"," ",167],["T_VARIABLE","$path",167],")",";",["T_WHITESPACE","\n        ",167],"}",["T_WHITESPACE"," ",168],["T_ELSE","else",168],["T_WHITESPACE"," ",168],"{",["T_WHITESPACE","\n            ",168],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","_availablePaths",169],"[","]",["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_VARIABLE","$path",169],";",["T_WHITESPACE","\n        ",169],"}",["T_WHITESPACE","\n        ",170],["T_RETURN","return",171],["T_WHITESPACE"," ",171],["T_VARIABLE","$this",171],";",["T_WHITESPACE","\n    ",171],"}",["T_WHITESPACE","\n\n    ",172],["T_DOC_COMMENT","\/**\n     * Get available paths masks\n     *\n     * @return string[]\n     *\/",174],["T_WHITESPACE","\n    ",178],["T_PUBLIC","public",179],["T_WHITESPACE"," ",179],["T_FUNCTION","function",179],["T_WHITESPACE"," ",179],["T_STRING","getAvailablePaths",179],"(",")",["T_WHITESPACE","\n    ",179],"{",["T_WHITESPACE","\n        ",180],["T_RETURN","return",181],["T_WHITESPACE"," ",181],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","_availablePaths",181],";",["T_WHITESPACE","\n    ",181],"}",["T_WHITESPACE","\n\n    ",182],["T_DOC_COMMENT","\/**\n     * Returns true if and only if $value meets the validation requirements\n     *\n     * If $value fails validation, then this method returns false, and\n     * getMessages() will return an array of messages that explain why the\n     * validation failed.\n     *\n     * @param string $value     File\/dir path\n     * @return bool\n     * @throws \\Exception       Throw exception on empty both paths masks types\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     *\/",184],["T_WHITESPACE","\n    ",195],["T_PUBLIC","public",196],["T_WHITESPACE"," ",196],["T_FUNCTION","function",196],["T_WHITESPACE"," ",196],["T_STRING","isValid",196],"(",["T_VARIABLE","$value",196],")",["T_WHITESPACE","\n    ",196],"{",["T_WHITESPACE","\n        ",197],["T_VARIABLE","$value",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_STRING","trim",198],"(",["T_VARIABLE","$value",198],")",";",["T_WHITESPACE","\n        ",198],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","_setValue",199],"(",["T_VARIABLE","$value",199],")",";",["T_WHITESPACE","\n\n        ",199],["T_IF","if",201],["T_WHITESPACE"," ",201],"(","!",["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","_availablePaths",201],["T_WHITESPACE"," ",201],["T_BOOLEAN_AND","&&",201],["T_WHITESPACE"," ",201],"!",["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","_protectedPaths",201],")",["T_WHITESPACE"," ",201],"{",["T_WHITESPACE","\n            ",201],["T_THROW","throw",202],["T_WHITESPACE"," ",202],["T_NEW","new",202],["T_WHITESPACE"," ",202],["T_NS_SEPARATOR","\\",202],["T_STRING","Exception",202],"(",["T_STRING","__",202],"(",["T_CONSTANT_ENCAPSED_STRING","'Please set available and\/or protected paths list(s) before validation.'",202],")",")",";",["T_WHITESPACE","\n        ",202],"}",["T_WHITESPACE","\n\n        ",203],["T_IF","if",205],["T_WHITESPACE"," ",205],"(",["T_STRING","preg_match",205],"(",["T_CONSTANT_ENCAPSED_STRING","'#\\.\\.[\\\\\\\/]#'",205],",",["T_WHITESPACE"," ",205],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","_value",205],")",")",["T_WHITESPACE"," ",205],"{",["T_WHITESPACE","\n            ",205],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","_error",206],"(",["T_STRING","self",206],["T_DOUBLE_COLON","::",206],["T_STRING","PROTECTED_LFI",206],",",["T_WHITESPACE"," ",206],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","_value",206],")",";",["T_WHITESPACE","\n            ",206],["T_RETURN","return",207],["T_WHITESPACE"," ",207],["T_STRING","false",207],";",["T_WHITESPACE","\n        ",207],"}",["T_WHITESPACE","\n\n        ",208],["T_COMMENT","\/\/validation\n",210],["T_WHITESPACE","        ",211],["T_VARIABLE","$value",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_STRING","str_replace",211],"(",["T_CONSTANT_ENCAPSED_STRING","'\\\\'",211],",",["T_WHITESPACE"," ",211],["T_CONSTANT_ENCAPSED_STRING","'\/'",211],",",["T_WHITESPACE"," ",211],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","_value",211],")",";",["T_WHITESPACE","\n        ",211],["T_VARIABLE","$valuePathInfo",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_STRING","pathinfo",212],"(",["T_STRING","ltrim",212],"(",["T_VARIABLE","$value",212],",",["T_WHITESPACE"," ",212],["T_CONSTANT_ENCAPSED_STRING","'\\\\\/'",212],")",")",";",["T_WHITESPACE","\n        ",212],["T_IF","if",213],["T_WHITESPACE"," ",213],"(",["T_VARIABLE","$valuePathInfo",213],"[",["T_CONSTANT_ENCAPSED_STRING","'dirname'",213],"]",["T_WHITESPACE"," ",213],["T_IS_EQUAL","==",213],["T_WHITESPACE"," ",213],["T_CONSTANT_ENCAPSED_STRING","'.'",213],["T_WHITESPACE"," ",213],["T_BOOLEAN_OR","||",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$valuePathInfo",213],"[",["T_CONSTANT_ENCAPSED_STRING","'dirname'",213],"]",["T_WHITESPACE"," ",213],["T_IS_EQUAL","==",213],["T_WHITESPACE"," ",213],["T_CONSTANT_ENCAPSED_STRING","'\/'",213],")",["T_WHITESPACE"," ",213],"{",["T_WHITESPACE","\n            ",213],["T_VARIABLE","$valuePathInfo",214],"[",["T_CONSTANT_ENCAPSED_STRING","'dirname'",214],"]",["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_CONSTANT_ENCAPSED_STRING","''",214],";",["T_WHITESPACE","\n        ",214],"}",["T_WHITESPACE","\n\n        ",215],["T_IF","if",217],["T_WHITESPACE"," ",217],"(",["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","_protectedPaths",217],["T_WHITESPACE"," ",217],["T_BOOLEAN_AND","&&",217],["T_WHITESPACE"," ",217],"!",["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","_isValidByPaths",217],"(",["T_VARIABLE","$valuePathInfo",217],",",["T_WHITESPACE"," ",217],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","_protectedPaths",217],",",["T_WHITESPACE"," ",217],["T_STRING","true",217],")",")",["T_WHITESPACE"," ",217],"{",["T_WHITESPACE","\n            ",217],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","_error",218],"(",["T_STRING","self",218],["T_DOUBLE_COLON","::",218],["T_STRING","PROTECTED_PATH",218],",",["T_WHITESPACE"," ",218],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","_value",218],")",";",["T_WHITESPACE","\n            ",218],["T_RETURN","return",219],["T_WHITESPACE"," ",219],["T_STRING","false",219],";",["T_WHITESPACE","\n        ",219],"}",["T_WHITESPACE","\n        ",220],["T_IF","if",221],["T_WHITESPACE"," ",221],"(",["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","_availablePaths",221],["T_WHITESPACE"," ",221],["T_BOOLEAN_AND","&&",221],["T_WHITESPACE"," ",221],"!",["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","_isValidByPaths",221],"(",["T_VARIABLE","$valuePathInfo",221],",",["T_WHITESPACE"," ",221],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","_availablePaths",221],",",["T_WHITESPACE"," ",221],["T_STRING","false",221],")",")",["T_WHITESPACE"," ",221],"{",["T_WHITESPACE","\n            ",221],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","_error",222],"(",["T_STRING","self",222],["T_DOUBLE_COLON","::",222],["T_STRING","NOT_AVAILABLE_PATH",222],",",["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","_value",222],")",";",["T_WHITESPACE","\n            ",222],["T_RETURN","return",223],["T_WHITESPACE"," ",223],["T_STRING","false",223],";",["T_WHITESPACE","\n        ",223],"}",["T_WHITESPACE","\n\n        ",224],["T_RETURN","return",226],["T_WHITESPACE"," ",226],["T_STRING","true",226],";",["T_WHITESPACE","\n    ",226],"}",["T_WHITESPACE","\n\n    ",227],["T_DOC_COMMENT","\/**\n     * Validate value by path masks\n     *\n     * @param array $valuePathInfo  Path info from value path\n     * @param string[] $paths          Protected\/available paths masks\n     * @param bool $protected       Paths masks is protected?\n     * @return bool\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     * @SuppressWarnings(PHPMD.NPathComplexity)\n     *\/",229],["T_WHITESPACE","\n    ",238],["T_PROTECTED","protected",239],["T_WHITESPACE"," ",239],["T_FUNCTION","function",239],["T_WHITESPACE"," ",239],["T_STRING","_isValidByPaths",239],"(",["T_VARIABLE","$valuePathInfo",239],",",["T_WHITESPACE"," ",239],["T_VARIABLE","$paths",239],",",["T_WHITESPACE"," ",239],["T_VARIABLE","$protected",239],")",["T_WHITESPACE","\n    ",239],"{",["T_WHITESPACE","\n        ",240],["T_FOREACH","foreach",241],["T_WHITESPACE"," ",241],"(",["T_VARIABLE","$paths",241],["T_WHITESPACE"," ",241],["T_AS","as",241],["T_WHITESPACE"," ",241],["T_VARIABLE","$path",241],")",["T_WHITESPACE"," ",241],"{",["T_WHITESPACE","\n            ",241],["T_VARIABLE","$path",242],["T_WHITESPACE"," ",242],"=",["T_WHITESPACE"," ",242],["T_STRING","ltrim",242],"(",["T_VARIABLE","$path",242],",",["T_WHITESPACE"," ",242],["T_CONSTANT_ENCAPSED_STRING","'\\\\\/'",242],")",";",["T_WHITESPACE","\n            ",242],["T_IF","if",243],["T_WHITESPACE"," ",243],"(","!",["T_ISSET","isset",243],"(",["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","_pathsData",243],"[",["T_VARIABLE","$path",243],"]","[",["T_CONSTANT_ENCAPSED_STRING","'regFilename'",243],"]",")",")",["T_WHITESPACE"," ",243],"{",["T_WHITESPACE","\n                ",243],["T_VARIABLE","$pathInfo",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_STRING","pathinfo",244],"(",["T_VARIABLE","$path",244],")",";",["T_WHITESPACE","\n                ",244],["T_VARIABLE","$options",245],"[",["T_CONSTANT_ENCAPSED_STRING","'file_mask'",245],"]",["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_VARIABLE","$pathInfo",245],"[",["T_CONSTANT_ENCAPSED_STRING","'basename'",245],"]",";",["T_WHITESPACE","\n                ",245],["T_IF","if",246],["T_WHITESPACE"," ",246],"(",["T_VARIABLE","$pathInfo",246],"[",["T_CONSTANT_ENCAPSED_STRING","'dirname'",246],"]",["T_WHITESPACE"," ",246],["T_IS_EQUAL","==",246],["T_WHITESPACE"," ",246],["T_CONSTANT_ENCAPSED_STRING","'.'",246],["T_WHITESPACE"," ",246],["T_BOOLEAN_OR","||",246],["T_WHITESPACE"," ",246],["T_VARIABLE","$pathInfo",246],"[",["T_CONSTANT_ENCAPSED_STRING","'dirname'",246],"]",["T_WHITESPACE"," ",246],["T_IS_EQUAL","==",246],["T_WHITESPACE"," ",246],["T_CONSTANT_ENCAPSED_STRING","'\/'",246],")",["T_WHITESPACE"," ",246],"{",["T_WHITESPACE","\n                    ",246],["T_VARIABLE","$pathInfo",247],"[",["T_CONSTANT_ENCAPSED_STRING","'dirname'",247],"]",["T_WHITESPACE"," ",247],"=",["T_WHITESPACE"," ",247],["T_CONSTANT_ENCAPSED_STRING","''",247],";",["T_WHITESPACE","\n                ",247],"}",["T_WHITESPACE"," ",248],["T_ELSE","else",248],["T_WHITESPACE"," ",248],"{",["T_WHITESPACE","\n                    ",248],["T_VARIABLE","$pathInfo",249],"[",["T_CONSTANT_ENCAPSED_STRING","'dirname'",249],"]",["T_WHITESPACE"," ",249],"=",["T_WHITESPACE"," ",249],["T_STRING","str_replace",249],"(",["T_CONSTANT_ENCAPSED_STRING","'\\\\'",249],",",["T_WHITESPACE"," ",249],["T_CONSTANT_ENCAPSED_STRING","'\/'",249],",",["T_WHITESPACE"," ",249],["T_VARIABLE","$pathInfo",249],"[",["T_CONSTANT_ENCAPSED_STRING","'dirname'",249],"]",")",";",["T_WHITESPACE","\n                ",249],"}",["T_WHITESPACE","\n                ",250],["T_VARIABLE","$options",251],"[",["T_CONSTANT_ENCAPSED_STRING","'dir_mask'",251],"]",["T_WHITESPACE"," ",251],"=",["T_WHITESPACE"," ",251],["T_VARIABLE","$pathInfo",251],"[",["T_CONSTANT_ENCAPSED_STRING","'dirname'",251],"]",";",["T_WHITESPACE","\n                ",251],["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","_pathsData",252],"[",["T_VARIABLE","$path",252],"]","[",["T_CONSTANT_ENCAPSED_STRING","'options'",252],"]",["T_WHITESPACE"," ",252],"=",["T_WHITESPACE"," ",252],["T_VARIABLE","$options",252],";",["T_WHITESPACE","\n            ",252],"}",["T_WHITESPACE"," ",253],["T_ELSE","else",253],["T_WHITESPACE"," ",253],"{",["T_WHITESPACE","\n                ",253],["T_VARIABLE","$options",254],["T_WHITESPACE"," ",254],"=",["T_WHITESPACE"," ",254],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","_pathsData",254],"[",["T_VARIABLE","$path",254],"]","[",["T_CONSTANT_ENCAPSED_STRING","'options'",254],"]",";",["T_WHITESPACE","\n            ",254],"}",["T_WHITESPACE","\n\n            ",255],["T_COMMENT","\/\/file mask\n",257],["T_WHITESPACE","            ",258],["T_IF","if",258],["T_WHITESPACE"," ",258],"(",["T_STRING","false",258],["T_WHITESPACE"," ",258],["T_IS_NOT_IDENTICAL","!==",258],["T_WHITESPACE"," ",258],["T_STRING","strpos",258],"(",["T_VARIABLE","$options",258],"[",["T_CONSTANT_ENCAPSED_STRING","'file_mask'",258],"]",",",["T_WHITESPACE"," ",258],["T_CONSTANT_ENCAPSED_STRING","'*'",258],")",")",["T_WHITESPACE"," ",258],"{",["T_WHITESPACE","\n                ",258],["T_IF","if",259],["T_WHITESPACE"," ",259],"(","!",["T_ISSET","isset",259],"(",["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","_pathsData",259],"[",["T_VARIABLE","$path",259],"]","[",["T_CONSTANT_ENCAPSED_STRING","'regFilename'",259],"]",")",")",["T_WHITESPACE"," ",259],"{",["T_WHITESPACE","\n                    ",259],["T_COMMENT","\/\/make regular\n",260],["T_WHITESPACE","                    ",261],["T_VARIABLE","$reg",261],["T_WHITESPACE"," ",261],"=",["T_WHITESPACE"," ",261],["T_VARIABLE","$options",261],"[",["T_CONSTANT_ENCAPSED_STRING","'file_mask'",261],"]",";",["T_WHITESPACE","\n                    ",261],["T_VARIABLE","$reg",262],["T_WHITESPACE"," ",262],"=",["T_WHITESPACE"," ",262],["T_STRING","str_replace",262],"(",["T_CONSTANT_ENCAPSED_STRING","'.'",262],",",["T_WHITESPACE"," ",262],["T_CONSTANT_ENCAPSED_STRING","'\\.'",262],",",["T_WHITESPACE"," ",262],["T_VARIABLE","$reg",262],")",";",["T_WHITESPACE","\n                    ",262],["T_VARIABLE","$reg",263],["T_WHITESPACE"," ",263],"=",["T_WHITESPACE"," ",263],["T_STRING","str_replace",263],"(",["T_CONSTANT_ENCAPSED_STRING","'*'",263],",",["T_WHITESPACE"," ",263],["T_CONSTANT_ENCAPSED_STRING","'.*?'",263],",",["T_WHITESPACE"," ",263],["T_VARIABLE","$reg",263],")",";",["T_WHITESPACE","\n                    ",263],["T_VARIABLE","$reg",264],["T_WHITESPACE"," ",264],"=",["T_WHITESPACE"," ",264],"\"",["T_ENCAPSED_AND_WHITESPACE","\/^(",264],["T_CURLY_OPEN","{",264],["T_VARIABLE","$reg",264],"}",["T_ENCAPSED_AND_WHITESPACE",")\\$\/",264],"\"",";",["T_WHITESPACE","\n                ",264],"}",["T_WHITESPACE"," ",265],["T_ELSE","else",265],["T_WHITESPACE"," ",265],"{",["T_WHITESPACE","\n                    ",265],["T_VARIABLE","$reg",266],["T_WHITESPACE"," ",266],"=",["T_WHITESPACE"," ",266],["T_VARIABLE","$this",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","_pathsData",266],"[",["T_VARIABLE","$path",266],"]","[",["T_CONSTANT_ENCAPSED_STRING","'regFilename'",266],"]",";",["T_WHITESPACE","\n                ",266],"}",["T_WHITESPACE","\n                ",267],["T_VARIABLE","$resultFile",268],["T_WHITESPACE"," ",268],"=",["T_WHITESPACE"," ",268],["T_STRING","preg_match",268],"(",["T_VARIABLE","$reg",268],",",["T_WHITESPACE"," ",268],["T_VARIABLE","$valuePathInfo",268],"[",["T_CONSTANT_ENCAPSED_STRING","'basename'",268],"]",")",";",["T_WHITESPACE","\n            ",268],"}",["T_WHITESPACE"," ",269],["T_ELSE","else",269],["T_WHITESPACE"," ",269],"{",["T_WHITESPACE","\n                ",269],["T_VARIABLE","$resultFile",270],["T_WHITESPACE"," ",270],"=",["T_WHITESPACE"," ",270],["T_VARIABLE","$options",270],"[",["T_CONSTANT_ENCAPSED_STRING","'file_mask'",270],"]",["T_WHITESPACE"," ",270],["T_IS_EQUAL","==",270],["T_WHITESPACE"," ",270],["T_VARIABLE","$valuePathInfo",270],"[",["T_CONSTANT_ENCAPSED_STRING","'basename'",270],"]",";",["T_WHITESPACE","\n            ",270],"}",["T_WHITESPACE","\n\n            ",271],["T_COMMENT","\/\/directory mask\n",273],["T_WHITESPACE","            ",274],["T_VARIABLE","$reg",274],["T_WHITESPACE"," ",274],"=",["T_WHITESPACE"," ",274],["T_VARIABLE","$options",274],"[",["T_CONSTANT_ENCAPSED_STRING","'dir_mask'",274],"]",["T_WHITESPACE"," ",274],".",["T_WHITESPACE"," ",274],["T_CONSTANT_ENCAPSED_STRING","'\/'",274],";",["T_WHITESPACE","\n            ",274],["T_IF","if",275],["T_WHITESPACE"," ",275],"(","!",["T_ISSET","isset",275],"(",["T_VARIABLE","$this",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","_pathsData",275],"[",["T_VARIABLE","$path",275],"]","[",["T_CONSTANT_ENCAPSED_STRING","'regDir'",275],"]",")",")",["T_WHITESPACE"," ",275],"{",["T_WHITESPACE","\n                ",275],["T_COMMENT","\/\/make regular\n",276],["T_WHITESPACE","                ",277],["T_VARIABLE","$reg",277],["T_WHITESPACE"," ",277],"=",["T_WHITESPACE"," ",277],["T_STRING","str_replace",277],"(",["T_CONSTANT_ENCAPSED_STRING","'.'",277],",",["T_WHITESPACE"," ",277],["T_CONSTANT_ENCAPSED_STRING","'\\.'",277],",",["T_WHITESPACE"," ",277],["T_VARIABLE","$reg",277],")",";",["T_WHITESPACE","\n                ",277],["T_VARIABLE","$reg",278],["T_WHITESPACE"," ",278],"=",["T_WHITESPACE"," ",278],["T_STRING","str_replace",278],"(",["T_CONSTANT_ENCAPSED_STRING","'*\\\\'",278],",",["T_WHITESPACE"," ",278],["T_CONSTANT_ENCAPSED_STRING","'||'",278],",",["T_WHITESPACE"," ",278],["T_VARIABLE","$reg",278],")",";",["T_WHITESPACE","\n                ",278],["T_VARIABLE","$reg",279],["T_WHITESPACE"," ",279],"=",["T_WHITESPACE"," ",279],["T_STRING","str_replace",279],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/'",279],",",["T_WHITESPACE"," ",279],["T_CONSTANT_ENCAPSED_STRING","'||'",279],",",["T_WHITESPACE"," ",279],["T_VARIABLE","$reg",279],")",";",["T_WHITESPACE","\n                ",279],["T_COMMENT","\/\/$reg = str_replace('*', '||', $reg);\n",280],["T_WHITESPACE","                ",281],["T_VARIABLE","$reg",281],["T_WHITESPACE"," ",281],"=",["T_WHITESPACE"," ",281],["T_STRING","str_replace",281],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",281],",",["T_WHITESPACE"," ",281],["T_CONSTANT_ENCAPSED_STRING","'[\\\\\/]'",281],",",["T_WHITESPACE"," ",281],["T_VARIABLE","$reg",281],")",";",["T_WHITESPACE","\n                ",281],["T_VARIABLE","$reg",282],["T_WHITESPACE"," ",282],"=",["T_WHITESPACE"," ",282],["T_STRING","str_replace",282],"(",["T_CONSTANT_ENCAPSED_STRING","'?'",282],",",["T_WHITESPACE"," ",282],["T_CONSTANT_ENCAPSED_STRING","'([^\\\\\/]+)'",282],",",["T_WHITESPACE"," ",282],["T_VARIABLE","$reg",282],")",";",["T_WHITESPACE","\n                ",282],["T_VARIABLE","$reg",283],["T_WHITESPACE"," ",283],"=",["T_WHITESPACE"," ",283],["T_STRING","str_replace",283],"(",["T_CONSTANT_ENCAPSED_STRING","'||'",283],",",["T_WHITESPACE"," ",283],["T_CONSTANT_ENCAPSED_STRING","'(.*[\\\\\/])?'",283],",",["T_WHITESPACE"," ",283],["T_VARIABLE","$reg",283],")",";",["T_WHITESPACE","\n                ",283],["T_VARIABLE","$reg",284],["T_WHITESPACE"," ",284],"=",["T_WHITESPACE"," ",284],"\"",["T_ENCAPSED_AND_WHITESPACE","\/^",284],["T_CURLY_OPEN","{",284],["T_VARIABLE","$reg",284],"}",["T_ENCAPSED_AND_WHITESPACE","\\$\/",284],"\"",";",["T_WHITESPACE","\n            ",284],"}",["T_WHITESPACE"," ",285],["T_ELSE","else",285],["T_WHITESPACE"," ",285],"{",["T_WHITESPACE","\n                ",285],["T_VARIABLE","$reg",286],["T_WHITESPACE"," ",286],"=",["T_WHITESPACE"," ",286],["T_VARIABLE","$this",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","_pathsData",286],"[",["T_VARIABLE","$path",286],"]","[",["T_CONSTANT_ENCAPSED_STRING","'regDir'",286],"]",";",["T_WHITESPACE","\n            ",286],"}",["T_WHITESPACE","\n            ",287],["T_VARIABLE","$resultDir",288],["T_WHITESPACE"," ",288],"=",["T_WHITESPACE"," ",288],["T_STRING","preg_match",288],"(",["T_VARIABLE","$reg",288],",",["T_WHITESPACE"," ",288],["T_VARIABLE","$valuePathInfo",288],"[",["T_CONSTANT_ENCAPSED_STRING","'dirname'",288],"]",["T_WHITESPACE"," ",288],".",["T_WHITESPACE"," ",288],["T_CONSTANT_ENCAPSED_STRING","'\/'",288],")",";",["T_WHITESPACE","\n\n            ",288],["T_IF","if",290],["T_WHITESPACE"," ",290],"(",["T_VARIABLE","$protected",290],["T_WHITESPACE"," ",290],["T_BOOLEAN_AND","&&",290],["T_WHITESPACE"," ",290],"(",["T_VARIABLE","$resultDir",290],["T_WHITESPACE"," ",290],["T_BOOLEAN_AND","&&",290],["T_WHITESPACE"," ",290],["T_VARIABLE","$resultFile",290],")",")",["T_WHITESPACE"," ",290],"{",["T_WHITESPACE","\n                ",290],["T_RETURN","return",291],["T_WHITESPACE"," ",291],["T_STRING","false",291],";",["T_WHITESPACE","\n            ",291],"}",["T_WHITESPACE"," ",292],["T_ELSEIF","elseif",292],["T_WHITESPACE"," ",292],"(","!",["T_VARIABLE","$protected",292],["T_WHITESPACE"," ",292],["T_BOOLEAN_AND","&&",292],["T_WHITESPACE"," ",292],"(",["T_VARIABLE","$resultDir",292],["T_WHITESPACE"," ",292],["T_BOOLEAN_AND","&&",292],["T_WHITESPACE"," ",292],["T_VARIABLE","$resultFile",292],")",")",["T_WHITESPACE"," ",292],"{",["T_WHITESPACE","\n                ",292],["T_COMMENT","\/\/return true because one match with available path mask\n",293],["T_WHITESPACE","                ",294],["T_RETURN","return",294],["T_WHITESPACE"," ",294],["T_STRING","true",294],";",["T_WHITESPACE","\n            ",294],"}",["T_WHITESPACE","\n        ",295],"}",["T_WHITESPACE","\n        ",296],["T_IF","if",297],["T_WHITESPACE"," ",297],"(",["T_VARIABLE","$protected",297],")",["T_WHITESPACE"," ",297],"{",["T_WHITESPACE","\n            ",297],["T_RETURN","return",298],["T_WHITESPACE"," ",298],["T_STRING","true",298],";",["T_WHITESPACE","\n        ",298],"}",["T_WHITESPACE"," ",299],["T_ELSE","else",299],["T_WHITESPACE"," ",299],"{",["T_WHITESPACE","\n            ",299],["T_COMMENT","\/\/return false because no one match with available path mask\n",300],["T_WHITESPACE","            ",301],["T_RETURN","return",301],["T_WHITESPACE"," ",301],["T_STRING","false",301],";",["T_WHITESPACE","\n        ",301],"}",["T_WHITESPACE","\n    ",302],"}",["T_WHITESPACE","\n",303],"}",["T_WHITESPACE","\n",304]]