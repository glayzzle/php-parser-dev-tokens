[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_COMMENT","\/\/ @codingStandardsIgnoreFile\n",7],["T_WHITESPACE","\n",8],["T_NAMESPACE","namespace",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","MediaStorage",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Model",9],["T_NS_SEPARATOR","\\",9],["T_STRING","File",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Storage",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Directory",9],";",["T_WHITESPACE","\n\n",9],["T_DOC_COMMENT","\/**\n * Class Database\n *\/",11],["T_WHITESPACE","\n",13],["T_CLASS","class",14],["T_WHITESPACE"," ",14],["T_STRING","Database",14],["T_WHITESPACE"," ",14],["T_EXTENDS","extends",14],["T_WHITESPACE"," ",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","MediaStorage",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Model",14],["T_NS_SEPARATOR","\\",14],["T_STRING","File",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Storage",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Database",14],["T_NS_SEPARATOR","\\",14],["T_STRING","AbstractDatabase",14],["T_WHITESPACE","\n",14],"{",["T_WHITESPACE","\n    ",15],["T_DOC_COMMENT","\/**\n     * Prefix of model events names\n     *\n     * @var string\n     *\/",16],["T_WHITESPACE","\n    ",20],["T_PROTECTED","protected",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$_eventPrefix",21],["T_WHITESPACE"," ",21],"=",["T_WHITESPACE"," ",21],["T_CONSTANT_ENCAPSED_STRING","'media_storage_file_storage_directory_database'",21],";",["T_WHITESPACE","\n\n    ",21],["T_DOC_COMMENT","\/**\n     * Collect errors during sync process\n     *\n     * @var string[]\n     *\/",23],["T_WHITESPACE","\n    ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$_errors",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],"[","]",";",["T_WHITESPACE","\n\n    ",28],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\MediaStorage\\Model\\File\\Storage\\Directory\\DatabaseFactory\n     *\/",30],["T_WHITESPACE","\n    ",32],["T_PROTECTED","protected",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$_directoryFactory",33],";",["T_WHITESPACE","\n\n    ",33],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\Model\\Context $context\n     * @param \\Magento\\Framework\\Registry $registry\n     * @param \\Magento\\MediaStorage\\Helper\\File\\Storage\\Database $coreFileStorageDb\n     * @param \\Magento\\Framework\\Stdlib\\DateTime\\DateTime $dateModel\n     * @param \\Magento\\Framework\\App\\Config\\ScopeConfigInterface $configuration\n     * @param DatabaseFactory $directoryFactory\n     * @param \\Magento\\MediaStorage\\Model\\ResourceModel\\File\\Storage\\Directory\\Database $resource\n     * @param \\Magento\\Framework\\Data\\Collection\\AbstractDb $resourceCollection\n     * @param string $connectionName\n     * @param array $data\n     * @SuppressWarnings(PHPMD.ExcessiveParameterList)\n     *\/",35],["T_WHITESPACE","\n    ",47],["T_PUBLIC","public",48],["T_WHITESPACE"," ",48],["T_FUNCTION","function",48],["T_WHITESPACE"," ",48],["T_STRING","__construct",48],"(",["T_WHITESPACE","\n        ",48],["T_NS_SEPARATOR","\\",49],["T_STRING","Magento",49],["T_NS_SEPARATOR","\\",49],["T_STRING","Framework",49],["T_NS_SEPARATOR","\\",49],["T_STRING","Model",49],["T_NS_SEPARATOR","\\",49],["T_STRING","Context",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$context",49],",",["T_WHITESPACE","\n        ",49],["T_NS_SEPARATOR","\\",50],["T_STRING","Magento",50],["T_NS_SEPARATOR","\\",50],["T_STRING","Framework",50],["T_NS_SEPARATOR","\\",50],["T_STRING","Registry",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$registry",50],",",["T_WHITESPACE","\n        ",50],["T_NS_SEPARATOR","\\",51],["T_STRING","Magento",51],["T_NS_SEPARATOR","\\",51],["T_STRING","MediaStorage",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Helper",51],["T_NS_SEPARATOR","\\",51],["T_STRING","File",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Storage",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Database",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$coreFileStorageDb",51],",",["T_WHITESPACE","\n        ",51],["T_NS_SEPARATOR","\\",52],["T_STRING","Magento",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Framework",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Stdlib",52],["T_NS_SEPARATOR","\\",52],["T_STRING","DateTime",52],["T_NS_SEPARATOR","\\",52],["T_STRING","DateTime",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$dateModel",52],",",["T_WHITESPACE","\n        ",52],["T_NS_SEPARATOR","\\",53],["T_STRING","Magento",53],["T_NS_SEPARATOR","\\",53],["T_STRING","Framework",53],["T_NS_SEPARATOR","\\",53],["T_STRING","App",53],["T_NS_SEPARATOR","\\",53],["T_STRING","Config",53],["T_NS_SEPARATOR","\\",53],["T_STRING","ScopeConfigInterface",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$configuration",53],",",["T_WHITESPACE","\n        ",53],["T_NS_SEPARATOR","\\",54],["T_STRING","Magento",54],["T_NS_SEPARATOR","\\",54],["T_STRING","MediaStorage",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Model",54],["T_NS_SEPARATOR","\\",54],["T_STRING","File",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Storage",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Directory",54],["T_NS_SEPARATOR","\\",54],["T_STRING","DatabaseFactory",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$directoryFactory",54],",",["T_WHITESPACE","\n        ",54],["T_NS_SEPARATOR","\\",55],["T_STRING","Magento",55],["T_NS_SEPARATOR","\\",55],["T_STRING","MediaStorage",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Model",55],["T_NS_SEPARATOR","\\",55],["T_STRING","ResourceModel",55],["T_NS_SEPARATOR","\\",55],["T_STRING","File",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Storage",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Directory",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Database",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$resource",55],",",["T_WHITESPACE","\n        ",55],["T_NS_SEPARATOR","\\",56],["T_STRING","Magento",56],["T_NS_SEPARATOR","\\",56],["T_STRING","Framework",56],["T_NS_SEPARATOR","\\",56],["T_STRING","Data",56],["T_NS_SEPARATOR","\\",56],["T_STRING","Collection",56],["T_NS_SEPARATOR","\\",56],["T_STRING","AbstractDb",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$resourceCollection",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_STRING","null",56],",",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$connectionName",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_STRING","null",57],",",["T_WHITESPACE","\n        ",57],["T_ARRAY","array",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$data",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],"[","]",["T_WHITESPACE","\n    ",58],")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","_directoryFactory",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$directoryFactory",60],";",["T_WHITESPACE","\n        ",60],["T_STRING","parent",61],["T_DOUBLE_COLON","::",61],["T_STRING","__construct",61],"(",["T_WHITESPACE","\n            ",61],["T_VARIABLE","$context",62],",",["T_WHITESPACE","\n            ",62],["T_VARIABLE","$registry",63],",",["T_WHITESPACE","\n            ",63],["T_VARIABLE","$coreFileStorageDb",64],",",["T_WHITESPACE","\n            ",64],["T_VARIABLE","$dateModel",65],",",["T_WHITESPACE","\n            ",65],["T_VARIABLE","$configuration",66],",",["T_WHITESPACE","\n            ",66],["T_VARIABLE","$resource",67],",",["T_WHITESPACE","\n            ",67],["T_VARIABLE","$resourceCollection",68],",",["T_WHITESPACE","\n            ",68],["T_VARIABLE","$connectionName",69],",",["T_WHITESPACE","\n            ",69],["T_VARIABLE","$data",70],["T_WHITESPACE","\n        ",70],")",";",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","_init",72],"(",["T_STRING","get_class",72],"(",["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","_resource",72],")",")",";",["T_WHITESPACE","\n    ",72],"}",["T_WHITESPACE","\n\n    ",73],["T_DOC_COMMENT","\/**\n     * Load object data by path\n     *\n     * @param  string $path\n     * @return $this\n     *\/",75],["T_WHITESPACE","\n    ",80],["T_PUBLIC","public",81],["T_WHITESPACE"," ",81],["T_FUNCTION","function",81],["T_WHITESPACE"," ",81],["T_STRING","loadByPath",81],"(",["T_VARIABLE","$path",81],")",["T_WHITESPACE","\n    ",81],"{",["T_WHITESPACE","\n        ",82],["T_DOC_COMMENT","\/**\n         * Clear model data\n         * addData() is used because it's needed to clear only db storaged data\n         *\/",83],["T_WHITESPACE","\n        ",86],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","addData",87],"(",["T_WHITESPACE","\n            ",87],"[",["T_CONSTANT_ENCAPSED_STRING","'directory_id'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_STRING","null",88],",",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'name'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_STRING","null",88],",",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'path'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_STRING","null",88],",",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'upload_time'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_STRING","null",88],",",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'parent_id'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_STRING","null",88],"]",["T_WHITESPACE","\n        ",88],")",";",["T_WHITESPACE","\n\n        ",89],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","_getResource",91],"(",")",["T_OBJECT_OPERATOR","->",91],["T_STRING","loadByPath",91],"(",["T_VARIABLE","$this",91],",",["T_WHITESPACE"," ",91],["T_VARIABLE","$path",91],")",";",["T_WHITESPACE","\n        ",91],["T_RETURN","return",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],";",["T_WHITESPACE","\n    ",92],"}",["T_WHITESPACE","\n\n    ",93],["T_DOC_COMMENT","\/**\n     * Check if there was errors during sync process\n     *\n     * @return bool\n     *\/",95],["T_WHITESPACE","\n    ",99],["T_PUBLIC","public",100],["T_WHITESPACE"," ",100],["T_FUNCTION","function",100],["T_WHITESPACE"," ",100],["T_STRING","hasErrors",100],"(",")",["T_WHITESPACE","\n    ",100],"{",["T_WHITESPACE","\n        ",101],["T_RETURN","return",102],["T_WHITESPACE"," ",102],"!",["T_EMPTY","empty",102],"(",["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","_errors",102],")",";",["T_WHITESPACE","\n    ",102],"}",["T_WHITESPACE","\n\n    ",103],["T_DOC_COMMENT","\/**\n     * Retrieve directory parent id\n     *\n     * @return int\n     *\/",105],["T_WHITESPACE","\n    ",109],["T_PUBLIC","public",110],["T_WHITESPACE"," ",110],["T_FUNCTION","function",110],["T_WHITESPACE"," ",110],["T_STRING","getParentId",110],"(",")",["T_WHITESPACE","\n    ",110],"{",["T_WHITESPACE","\n        ",111],["T_IF","if",112],["T_WHITESPACE"," ",112],"(","!",["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","getData",112],"(",["T_CONSTANT_ENCAPSED_STRING","'parent_id'",112],")",")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n            ",112],["T_VARIABLE","$parentId",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","_getResource",113],"(",")",["T_OBJECT_OPERATOR","->",113],["T_STRING","getParentId",113],"(",["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","getPath",113],"(",")",")",";",["T_WHITESPACE","\n            ",113],["T_IF","if",114],["T_WHITESPACE"," ",114],"(",["T_EMPTY","empty",114],"(",["T_VARIABLE","$parentId",114],")",")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n                ",114],["T_VARIABLE","$parentId",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_STRING","null",115],";",["T_WHITESPACE","\n            ",115],"}",["T_WHITESPACE","\n\n            ",116],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","setData",118],"(",["T_CONSTANT_ENCAPSED_STRING","'parent_id'",118],",",["T_WHITESPACE"," ",118],["T_VARIABLE","$parentId",118],")",";",["T_WHITESPACE","\n        ",118],"}",["T_WHITESPACE","\n\n        ",119],["T_RETURN","return",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$parentId",121],";",["T_WHITESPACE","\n    ",121],"}",["T_WHITESPACE","\n\n    ",122],["T_DOC_COMMENT","\/**\n     * Create directories recursively\n     *\n     * @param  string $path\n     * @return $this\n     *\/",124],["T_WHITESPACE","\n    ",129],["T_PUBLIC","public",130],["T_WHITESPACE"," ",130],["T_FUNCTION","function",130],["T_WHITESPACE"," ",130],["T_STRING","createRecursive",130],"(",["T_VARIABLE","$path",130],")",["T_WHITESPACE","\n    ",130],"{",["T_WHITESPACE","\n        ",131],["T_VARIABLE","$directory",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","_directoryFactory",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","create",132],"(",")",["T_OBJECT_OPERATOR","->",132],["T_STRING","loadByPath",132],"(",["T_VARIABLE","$path",132],")",";",["T_WHITESPACE","\n\n        ",132],["T_IF","if",134],["T_WHITESPACE"," ",134],"(","!",["T_VARIABLE","$directory",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","getId",134],"(",")",")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n            ",134],["T_VARIABLE","$dirName",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_STRING","basename",135],"(",["T_VARIABLE","$path",135],")",";",["T_WHITESPACE","\n            ",135],["T_VARIABLE","$dirPath",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_STRING","dirname",136],"(",["T_VARIABLE","$path",136],")",";",["T_WHITESPACE","\n\n            ",136],["T_IF","if",138],["T_WHITESPACE"," ",138],"(",["T_VARIABLE","$dirPath",138],["T_WHITESPACE"," ",138],["T_IS_NOT_EQUAL","!=",138],["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","'.'",138],")",["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n                ",138],["T_VARIABLE","$parentDir",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","createRecursive",139],"(",["T_VARIABLE","$dirPath",139],")",";",["T_WHITESPACE","\n                ",139],["T_VARIABLE","$parentId",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_VARIABLE","$parentDir",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","getId",140],"(",")",";",["T_WHITESPACE","\n            ",140],"}",["T_WHITESPACE"," ",141],["T_ELSE","else",141],["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n                ",141],["T_VARIABLE","$dirPath",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_CONSTANT_ENCAPSED_STRING","''",142],";",["T_WHITESPACE","\n                ",142],["T_VARIABLE","$parentId",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_STRING","null",143],";",["T_WHITESPACE","\n            ",143],"}",["T_WHITESPACE","\n\n            ",144],["T_VARIABLE","$directory",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","setName",146],"(",["T_VARIABLE","$dirName",146],")",";",["T_WHITESPACE","\n            ",146],["T_VARIABLE","$directory",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","setPath",147],"(",["T_VARIABLE","$dirPath",147],")",";",["T_WHITESPACE","\n            ",147],["T_VARIABLE","$directory",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","setParentId",148],"(",["T_VARIABLE","$parentId",148],")",";",["T_WHITESPACE","\n            ",148],["T_VARIABLE","$directory",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","save",149],"(",")",";",["T_WHITESPACE","\n        ",149],"}",["T_WHITESPACE","\n\n        ",150],["T_RETURN","return",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$directory",152],";",["T_WHITESPACE","\n    ",152],"}",["T_WHITESPACE","\n\n    ",153],["T_DOC_COMMENT","\/**\n     * Export directories from storage\n     *\n     * @param  int $offset\n     * @param  int $count\n     * @return bool\n     *\/",155],["T_WHITESPACE","\n    ",161],["T_PUBLIC","public",162],["T_WHITESPACE"," ",162],["T_FUNCTION","function",162],["T_WHITESPACE"," ",162],["T_STRING","exportDirectories",162],"(",["T_VARIABLE","$offset",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_LNUMBER","0",162],",",["T_WHITESPACE"," ",162],["T_VARIABLE","$count",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_LNUMBER","100",162],")",["T_WHITESPACE","\n    ",162],"{",["T_WHITESPACE","\n        ",163],["T_VARIABLE","$offset",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_INT_CAST","(int)",164],["T_VARIABLE","$offset",164],["T_WHITESPACE"," ",164],["T_IS_GREATER_OR_EQUAL",">=",164],["T_WHITESPACE"," ",164],["T_LNUMBER","0",164],["T_WHITESPACE"," ",164],"?",["T_WHITESPACE"," ",164],["T_INT_CAST","(int)",164],["T_VARIABLE","$offset",164],["T_WHITESPACE"," ",164],":",["T_WHITESPACE"," ",164],["T_LNUMBER","0",164],";",["T_WHITESPACE","\n        ",164],["T_VARIABLE","$count",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_INT_CAST","(int)",165],["T_VARIABLE","$count",165],["T_WHITESPACE"," ",165],["T_IS_GREATER_OR_EQUAL",">=",165],["T_WHITESPACE"," ",165],["T_LNUMBER","1",165],["T_WHITESPACE"," ",165],"?",["T_WHITESPACE"," ",165],["T_INT_CAST","(int)",165],["T_VARIABLE","$count",165],["T_WHITESPACE"," ",165],":",["T_WHITESPACE"," ",165],["T_LNUMBER","1",165],";",["T_WHITESPACE","\n\n        ",165],["T_VARIABLE","$result",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","_getResource",167],"(",")",["T_OBJECT_OPERATOR","->",167],["T_STRING","exportDirectories",167],"(",["T_VARIABLE","$offset",167],",",["T_WHITESPACE"," ",167],["T_VARIABLE","$count",167],")",";",["T_WHITESPACE","\n\n        ",167],["T_IF","if",169],["T_WHITESPACE"," ",169],"(",["T_EMPTY","empty",169],"(",["T_VARIABLE","$result",169],")",")",["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n            ",169],["T_RETURN","return",170],["T_WHITESPACE"," ",170],["T_STRING","false",170],";",["T_WHITESPACE","\n        ",170],"}",["T_WHITESPACE","\n\n        ",171],["T_RETURN","return",173],["T_WHITESPACE"," ",173],["T_VARIABLE","$result",173],";",["T_WHITESPACE","\n    ",173],"}",["T_WHITESPACE","\n\n    ",174],["T_DOC_COMMENT","\/**\n     * Import directories to storage\n     *\n     * @param  array $dirs\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     * @return $this\n     *\/",176],["T_WHITESPACE","\n    ",182],["T_PUBLIC","public",183],["T_WHITESPACE"," ",183],["T_FUNCTION","function",183],["T_WHITESPACE"," ",183],["T_STRING","importDirectories",183],"(",["T_VARIABLE","$dirs",183],")",["T_WHITESPACE","\n    ",183],"{",["T_WHITESPACE","\n        ",184],["T_IF","if",185],["T_WHITESPACE"," ",185],"(","!",["T_STRING","is_array",185],"(",["T_VARIABLE","$dirs",185],")",")",["T_WHITESPACE"," ",185],"{",["T_WHITESPACE","\n            ",185],["T_RETURN","return",186],["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],";",["T_WHITESPACE","\n        ",186],"}",["T_WHITESPACE","\n\n        ",187],["T_VARIABLE","$dateSingleton",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","_date",189],";",["T_WHITESPACE","\n        ",189],["T_FOREACH","foreach",190],["T_WHITESPACE"," ",190],"(",["T_VARIABLE","$dirs",190],["T_WHITESPACE"," ",190],["T_AS","as",190],["T_WHITESPACE"," ",190],["T_VARIABLE","$dir",190],")",["T_WHITESPACE"," ",190],"{",["T_WHITESPACE","\n            ",190],["T_IF","if",191],["T_WHITESPACE"," ",191],"(","!",["T_STRING","is_array",191],"(",["T_VARIABLE","$dir",191],")",["T_WHITESPACE"," ",191],["T_BOOLEAN_OR","||",191],["T_WHITESPACE"," ",191],"!",["T_ISSET","isset",191],"(",["T_VARIABLE","$dir",191],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",191],"]",")",["T_WHITESPACE"," ",191],["T_BOOLEAN_OR","||",191],["T_WHITESPACE"," ",191],"!",["T_STRING","strlen",191],"(",["T_VARIABLE","$dir",191],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",191],"]",")",")",["T_WHITESPACE"," ",191],"{",["T_WHITESPACE","\n                ",191],["T_CONTINUE","continue",192],";",["T_WHITESPACE","\n            ",192],"}",["T_WHITESPACE","\n\n            ",193],["T_TRY","try",195],["T_WHITESPACE"," ",195],"{",["T_WHITESPACE","\n                ",195],["T_VARIABLE","$dir",196],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",196],"]",["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_STRING","ltrim",196],"(",["T_VARIABLE","$dir",196],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",196],"]",",",["T_WHITESPACE"," ",196],["T_CONSTANT_ENCAPSED_STRING","'.\/'",196],")",";",["T_WHITESPACE","\n                ",196],["T_VARIABLE","$directory",197],["T_WHITESPACE"," ",197],"=",["T_WHITESPACE"," ",197],["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","_directoryFactory",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","create",197],"(","[",["T_CONSTANT_ENCAPSED_STRING","'connectionName'",197],["T_WHITESPACE"," ",197],["T_DOUBLE_ARROW","=>",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","getConnectionName",197],"(",")","]",")",";",["T_WHITESPACE","\n                ",197],["T_VARIABLE","$directory",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","setPath",198],"(",["T_VARIABLE","$dir",198],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",198],"]",")",";",["T_WHITESPACE","\n\n                ",198],["T_VARIABLE","$parentId",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_VARIABLE","$directory",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","getParentId",200],"(",")",";",["T_WHITESPACE","\n                ",200],["T_IF","if",201],["T_WHITESPACE"," ",201],"(",["T_VARIABLE","$parentId",201],["T_WHITESPACE"," ",201],["T_BOOLEAN_OR","||",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$dir",201],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",201],"]",["T_WHITESPACE"," ",201],["T_IS_EQUAL","==",201],["T_WHITESPACE"," ",201],["T_CONSTANT_ENCAPSED_STRING","''",201],")",["T_WHITESPACE"," ",201],"{",["T_WHITESPACE","\n                    ",201],["T_VARIABLE","$directory",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","setName",202],"(",["T_VARIABLE","$dir",202],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",202],"]",")",";",["T_WHITESPACE","\n                    ",202],["T_VARIABLE","$directory",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","setUploadTime",203],"(",["T_VARIABLE","$dateSingleton",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","date",203],"(",")",")",";",["T_WHITESPACE","\n                    ",203],["T_VARIABLE","$directory",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","save",204],"(",")",";",["T_WHITESPACE","\n                ",204],"}",["T_WHITESPACE"," ",205],["T_ELSE","else",205],["T_WHITESPACE"," ",205],"{",["T_WHITESPACE","\n                    ",205],["T_THROW","throw",206],["T_WHITESPACE"," ",206],["T_NEW","new",206],["T_WHITESPACE"," ",206],["T_NS_SEPARATOR","\\",206],["T_STRING","Magento",206],["T_NS_SEPARATOR","\\",206],["T_STRING","Framework",206],["T_NS_SEPARATOR","\\",206],["T_STRING","Exception",206],["T_NS_SEPARATOR","\\",206],["T_STRING","LocalizedException",206],"(",["T_WHITESPACE","\n                        ",206],["T_STRING","__",207],"(",["T_CONSTANT_ENCAPSED_STRING","'Parent directory does not exist: %1'",207],",",["T_WHITESPACE"," ",207],["T_VARIABLE","$dir",207],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",207],"]",")",["T_WHITESPACE","\n                    ",207],")",";",["T_WHITESPACE","\n                ",208],"}",["T_WHITESPACE","\n            ",209],"}",["T_WHITESPACE"," ",210],["T_CATCH","catch",210],["T_WHITESPACE"," ",210],"(",["T_NS_SEPARATOR","\\",210],["T_STRING","Exception",210],["T_WHITESPACE"," ",210],["T_VARIABLE","$e",210],")",["T_WHITESPACE"," ",210],"{",["T_WHITESPACE","\n                ",210],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","_logger",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","critical",211],"(",["T_VARIABLE","$e",211],")",";",["T_WHITESPACE","\n            ",211],"}",["T_WHITESPACE","\n        ",212],"}",["T_WHITESPACE","\n\n        ",213],["T_RETURN","return",215],["T_WHITESPACE"," ",215],["T_VARIABLE","$this",215],";",["T_WHITESPACE","\n    ",215],"}",["T_WHITESPACE","\n\n    ",216],["T_DOC_COMMENT","\/**\n     * Clean directories at storage\n     *\n     * @return $this\n     *\/",218],["T_WHITESPACE","\n    ",222],["T_PUBLIC","public",223],["T_WHITESPACE"," ",223],["T_FUNCTION","function",223],["T_WHITESPACE"," ",223],["T_STRING","clearDirectories",223],"(",")",["T_WHITESPACE","\n    ",223],"{",["T_WHITESPACE","\n        ",224],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","_getResource",225],"(",")",["T_OBJECT_OPERATOR","->",225],["T_STRING","clearDirectories",225],"(",")",";",["T_WHITESPACE","\n        ",225],["T_RETURN","return",226],["T_WHITESPACE"," ",226],["T_VARIABLE","$this",226],";",["T_WHITESPACE","\n    ",226],"}",["T_WHITESPACE","\n\n    ",227],["T_DOC_COMMENT","\/**\n     * Return subdirectories\n     *\n     * @param string $directory\n     * @return array\n     *\/",229],["T_WHITESPACE","\n    ",234],["T_PUBLIC","public",235],["T_WHITESPACE"," ",235],["T_FUNCTION","function",235],["T_WHITESPACE"," ",235],["T_STRING","getSubdirectories",235],"(",["T_VARIABLE","$directory",235],")",["T_WHITESPACE","\n    ",235],"{",["T_WHITESPACE","\n        ",236],["T_VARIABLE","$directory",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","_coreFileStorageDb",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","getMediaRelativePath",237],"(",["T_VARIABLE","$directory",237],")",";",["T_WHITESPACE","\n\n        ",237],["T_RETURN","return",239],["T_WHITESPACE"," ",239],["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","_getResource",239],"(",")",["T_OBJECT_OPERATOR","->",239],["T_STRING","getSubdirectories",239],"(",["T_VARIABLE","$directory",239],")",";",["T_WHITESPACE","\n    ",239],"}",["T_WHITESPACE","\n\n    ",240],["T_DOC_COMMENT","\/**\n     * Delete directory from database\n     *\n     * @param string $dirPath\n     * @return $this\n     *\/",242],["T_WHITESPACE","\n    ",247],["T_PUBLIC","public",248],["T_WHITESPACE"," ",248],["T_FUNCTION","function",248],["T_WHITESPACE"," ",248],["T_STRING","deleteDirectory",248],"(",["T_VARIABLE","$dirPath",248],")",["T_WHITESPACE","\n    ",248],"{",["T_WHITESPACE","\n        ",249],["T_VARIABLE","$dirPath",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_VARIABLE","$this",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","_coreFileStorageDb",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","getMediaRelativePath",250],"(",["T_VARIABLE","$dirPath",250],")",";",["T_WHITESPACE","\n        ",250],["T_VARIABLE","$name",251],["T_WHITESPACE"," ",251],"=",["T_WHITESPACE"," ",251],["T_STRING","basename",251],"(",["T_VARIABLE","$dirPath",251],")",";",["T_WHITESPACE","\n        ",251],["T_VARIABLE","$path",252],["T_WHITESPACE"," ",252],"=",["T_WHITESPACE"," ",252],["T_STRING","dirname",252],"(",["T_VARIABLE","$dirPath",252],")",";",["T_WHITESPACE","\n\n        ",252],["T_IF","if",254],["T_WHITESPACE"," ",254],"(",["T_CONSTANT_ENCAPSED_STRING","'.'",254],["T_WHITESPACE"," ",254],["T_IS_EQUAL","==",254],["T_WHITESPACE"," ",254],["T_VARIABLE","$path",254],")",["T_WHITESPACE"," ",254],"{",["T_WHITESPACE","\n            ",254],["T_VARIABLE","$path",255],["T_WHITESPACE"," ",255],"=",["T_WHITESPACE"," ",255],["T_CONSTANT_ENCAPSED_STRING","''",255],";",["T_WHITESPACE","\n        ",255],"}",["T_WHITESPACE","\n\n        ",256],["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","_getResource",258],"(",")",["T_OBJECT_OPERATOR","->",258],["T_STRING","deleteDirectory",258],"(",["T_VARIABLE","$name",258],",",["T_WHITESPACE"," ",258],["T_VARIABLE","$path",258],")",";",["T_WHITESPACE","\n\n        ",258],["T_RETURN","return",260],["T_WHITESPACE"," ",260],["T_VARIABLE","$this",260],";",["T_WHITESPACE","\n    ",260],"}",["T_WHITESPACE","\n",261],"}",["T_WHITESPACE","\n",262]]