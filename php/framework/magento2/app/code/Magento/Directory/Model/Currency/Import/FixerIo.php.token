[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Directory",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Currency",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Import",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Currency rate import model (From http:\/\/fixer.io\/)\n *\/",8],["T_WHITESPACE","\n",10],["T_CLASS","class",11],["T_WHITESPACE"," ",11],["T_STRING","FixerIo",11],["T_WHITESPACE"," ",11],["T_EXTENDS","extends",11],["T_WHITESPACE"," ",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Directory",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Model",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Currency",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Import",11],["T_NS_SEPARATOR","\\",11],["T_STRING","AbstractImport",11],["T_WHITESPACE","\n",11],"{",["T_WHITESPACE","\n    ",12],["T_DOC_COMMENT","\/**\n     * @var string\n     *\/",13],["T_WHITESPACE","\n    ",15],["T_CONST","const",16],["T_WHITESPACE"," ",16],["T_STRING","CURRENCY_CONVERTER_URL",16],["T_WHITESPACE"," ",16],"=",["T_WHITESPACE"," ",16],["T_CONSTANT_ENCAPSED_STRING","'http:\/\/api.fixer.io\/latest?base={{CURRENCY_FROM}}&symbols={{CURRENCY_TO}}'",16],";",["T_WHITESPACE","\n\n    ",16],["T_DOC_COMMENT","\/**\n     * Http Client Factory\n     *\n     * @var \\Magento\\Framework\\HTTP\\ZendClientFactory\n     *\/",18],["T_WHITESPACE","\n    ",22],["T_PROTECTED","protected",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$httpClientFactory",23],";",["T_WHITESPACE","\n\n    ",23],["T_DOC_COMMENT","\/**\n     * Core scope config\n     *\n     * @var \\Magento\\Framework\\App\\Config\\ScopeConfigInterface\n     *\/",25],["T_WHITESPACE","\n    ",29],["T_PRIVATE","private",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$scopeConfig",30],";",["T_WHITESPACE","\n\n    ",30],["T_DOC_COMMENT","\/**\n     * Initialize dependencies\n     *\n     * @param \\Magento\\Directory\\Model\\CurrencyFactory $currencyFactory\n     * @param \\Magento\\Framework\\App\\Config\\ScopeConfigInterface $scopeConfig\n     * @param \\Magento\\Framework\\HTTP\\ZendClientFactory $httpClientFactory\n     *\/",32],["T_WHITESPACE","\n    ",38],["T_PUBLIC","public",39],["T_WHITESPACE"," ",39],["T_FUNCTION","function",39],["T_WHITESPACE"," ",39],["T_STRING","__construct",39],"(",["T_WHITESPACE","\n        ",39],["T_NS_SEPARATOR","\\",40],["T_STRING","Magento",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Directory",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Model",40],["T_NS_SEPARATOR","\\",40],["T_STRING","CurrencyFactory",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$currencyFactory",40],",",["T_WHITESPACE","\n        ",40],["T_NS_SEPARATOR","\\",41],["T_STRING","Magento",41],["T_NS_SEPARATOR","\\",41],["T_STRING","Framework",41],["T_NS_SEPARATOR","\\",41],["T_STRING","App",41],["T_NS_SEPARATOR","\\",41],["T_STRING","Config",41],["T_NS_SEPARATOR","\\",41],["T_STRING","ScopeConfigInterface",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$scopeConfig",41],",",["T_WHITESPACE","\n        ",41],["T_NS_SEPARATOR","\\",42],["T_STRING","Magento",42],["T_NS_SEPARATOR","\\",42],["T_STRING","Framework",42],["T_NS_SEPARATOR","\\",42],["T_STRING","HTTP",42],["T_NS_SEPARATOR","\\",42],["T_STRING","ZendClientFactory",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$httpClientFactory",42],["T_WHITESPACE","\n    ",42],")",["T_WHITESPACE"," ",43],"{",["T_WHITESPACE","\n        ",43],["T_STRING","parent",44],["T_DOUBLE_COLON","::",44],["T_STRING","__construct",44],"(",["T_VARIABLE","$currencyFactory",44],")",";",["T_WHITESPACE","\n        ",44],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","scopeConfig",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_VARIABLE","$scopeConfig",45],";",["T_WHITESPACE","\n        ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","httpClientFactory",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$httpClientFactory",46],";",["T_WHITESPACE","\n    ",46],"}",["T_WHITESPACE","\n\n    ",47],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",49],["T_WHITESPACE","\n    ",51],["T_PUBLIC","public",52],["T_WHITESPACE"," ",52],["T_FUNCTION","function",52],["T_WHITESPACE"," ",52],["T_STRING","fetchRates",52],"(",")",["T_WHITESPACE","\n    ",52],"{",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$data",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],"[","]",";",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$currencies",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","_getCurrencyCodes",55],"(",")",";",["T_WHITESPACE","\n        ",55],["T_VARIABLE","$defaultCurrencies",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","_getDefaultCurrencyCodes",56],"(",")",";",["T_WHITESPACE","\n\n        ",56],["T_FOREACH","foreach",58],["T_WHITESPACE"," ",58],"(",["T_VARIABLE","$defaultCurrencies",58],["T_WHITESPACE"," ",58],["T_AS","as",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$currencyFrom",58],")",["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n            ",58],["T_IF","if",59],["T_WHITESPACE"," ",59],"(","!",["T_ISSET","isset",59],"(",["T_VARIABLE","$data",59],"[",["T_VARIABLE","$currencyFrom",59],"]",")",")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n                ",59],["T_VARIABLE","$data",60],"[",["T_VARIABLE","$currencyFrom",60],"]",["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],"[","]",";",["T_WHITESPACE","\n            ",60],"}",["T_WHITESPACE","\n            ",61],["T_VARIABLE","$data",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","convertBatch",62],"(",["T_VARIABLE","$data",62],",",["T_WHITESPACE"," ",62],["T_VARIABLE","$currencyFrom",62],",",["T_WHITESPACE"," ",62],["T_VARIABLE","$currencies",62],")",";",["T_WHITESPACE","\n            ",62],["T_STRING","ksort",63],"(",["T_VARIABLE","$data",63],"[",["T_VARIABLE","$currencyFrom",63],"]",")",";",["T_WHITESPACE","\n        ",63],"}",["T_WHITESPACE","\n        ",64],["T_RETURN","return",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$data",65],";",["T_WHITESPACE","\n    ",65],"}",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * Return currencies convert rates in batch mode\n     *\n     * @param array $data\n     * @param string $currencyFrom\n     * @param array $currenciesTo\n     * @return array\n     *\/",68],["T_WHITESPACE","\n    ",75],["T_PRIVATE","private",76],["T_WHITESPACE"," ",76],["T_FUNCTION","function",76],["T_WHITESPACE"," ",76],["T_STRING","convertBatch",76],"(",["T_VARIABLE","$data",76],",",["T_WHITESPACE"," ",76],["T_VARIABLE","$currencyFrom",76],",",["T_WHITESPACE"," ",76],["T_VARIABLE","$currenciesTo",76],")",["T_WHITESPACE","\n    ",76],"{",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$currenciesStr",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_STRING","implode",78],"(",["T_CONSTANT_ENCAPSED_STRING","','",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$currenciesTo",78],")",";",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$url",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_STRING","str_replace",79],"(",["T_CONSTANT_ENCAPSED_STRING","'{{CURRENCY_FROM}}'",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$currencyFrom",79],",",["T_WHITESPACE"," ",79],["T_STRING","self",79],["T_DOUBLE_COLON","::",79],["T_STRING","CURRENCY_CONVERTER_URL",79],")",";",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$url",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_STRING","str_replace",80],"(",["T_CONSTANT_ENCAPSED_STRING","'{{CURRENCY_TO}}'",80],",",["T_WHITESPACE"," ",80],["T_VARIABLE","$currenciesStr",80],",",["T_WHITESPACE"," ",80],["T_VARIABLE","$url",80],")",";",["T_WHITESPACE","\n\n        ",80],["T_STRING","set_time_limit",82],"(",["T_LNUMBER","0",82],")",";",["T_WHITESPACE","\n        ",82],["T_TRY","try",83],["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n            ",83],["T_VARIABLE","$response",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getServiceResponse",84],"(",["T_VARIABLE","$url",84],")",";",["T_WHITESPACE","\n        ",84],"}",["T_WHITESPACE"," ",85],["T_FINALLY","finally",85],["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n            ",85],["T_STRING","ini_restore",86],"(",["T_CONSTANT_ENCAPSED_STRING","'max_execution_time'",86],")",";",["T_WHITESPACE","\n        ",86],"}",["T_WHITESPACE","\n\n        ",87],["T_FOREACH","foreach",89],["T_WHITESPACE"," ",89],"(",["T_VARIABLE","$currenciesTo",89],["T_WHITESPACE"," ",89],["T_AS","as",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$currencyTo",89],")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n            ",89],["T_IF","if",90],["T_WHITESPACE"," ",90],"(",["T_VARIABLE","$currencyFrom",90],["T_WHITESPACE"," ",90],["T_IS_EQUAL","==",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$currencyTo",90],")",["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n                ",90],["T_VARIABLE","$data",91],"[",["T_VARIABLE","$currencyFrom",91],"]","[",["T_VARIABLE","$currencyTo",91],"]",["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","_numberFormat",91],"(",["T_LNUMBER","1",91],")",";",["T_WHITESPACE","\n            ",91],"}",["T_WHITESPACE"," ",92],["T_ELSE","else",92],["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n                ",92],["T_IF","if",93],["T_WHITESPACE"," ",93],"(",["T_EMPTY","empty",93],"(",["T_VARIABLE","$response",93],"[",["T_CONSTANT_ENCAPSED_STRING","'rates'",93],"]","[",["T_VARIABLE","$currencyTo",93],"]",")",")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n                    ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","_messages",94],"[","]",["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_STRING","__",94],"(",["T_CONSTANT_ENCAPSED_STRING","'We can\\'t retrieve a rate from %1 for %2.'",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$url",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$currencyTo",94],")",";",["T_WHITESPACE","\n                    ",94],["T_VARIABLE","$data",95],"[",["T_VARIABLE","$currencyFrom",95],"]","[",["T_VARIABLE","$currencyTo",95],"]",["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_STRING","null",95],";",["T_WHITESPACE","\n                ",95],"}",["T_WHITESPACE"," ",96],["T_ELSE","else",96],["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n                    ",96],["T_VARIABLE","$data",97],"[",["T_VARIABLE","$currencyFrom",97],"]","[",["T_VARIABLE","$currencyTo",97],"]",["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","_numberFormat",97],"(",["T_WHITESPACE","\n                        ",97],["T_DOUBLE_CAST","(double)",98],["T_VARIABLE","$response",98],"[",["T_CONSTANT_ENCAPSED_STRING","'rates'",98],"]","[",["T_VARIABLE","$currencyTo",98],"]",["T_WHITESPACE","\n                    ",98],")",";",["T_WHITESPACE","\n                ",99],"}",["T_WHITESPACE","\n            ",100],"}",["T_WHITESPACE","\n        ",101],"}",["T_WHITESPACE","\n        ",102],["T_RETURN","return",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$data",103],";",["T_WHITESPACE","\n    ",103],"}",["T_WHITESPACE","\n\n    ",104],["T_DOC_COMMENT","\/**\n     * Get Fixer.io service response\n     *\n     * @param string $url\n     * @param int $retry\n     * @return array\n     *\/",106],["T_WHITESPACE","\n    ",112],["T_PRIVATE","private",113],["T_WHITESPACE"," ",113],["T_FUNCTION","function",113],["T_WHITESPACE"," ",113],["T_STRING","getServiceResponse",113],"(",["T_VARIABLE","$url",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$retry",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_LNUMBER","0",113],")",["T_WHITESPACE","\n    ",113],"{",["T_WHITESPACE","\n        ",114],["T_DOC_COMMENT","\/** @var \\Magento\\Framework\\HTTP\\ZendClient $httpClient *\/",115],["T_WHITESPACE","\n        ",115],["T_VARIABLE","$httpClient",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","httpClientFactory",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","create",116],"(",")",";",["T_WHITESPACE","\n        ",116],["T_VARIABLE","$response",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],"[","]",";",["T_WHITESPACE","\n\n        ",117],["T_TRY","try",119],["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n            ",119],["T_VARIABLE","$jsonResponse",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_VARIABLE","$httpClient",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","setUri",120],"(",["T_WHITESPACE","\n                ",120],["T_VARIABLE","$url",121],["T_WHITESPACE","\n            ",121],")",["T_OBJECT_OPERATOR","->",122],["T_STRING","setConfig",122],"(",["T_WHITESPACE","\n                ",122],"[",["T_WHITESPACE","\n                    ",123],["T_CONSTANT_ENCAPSED_STRING","'timeout'",124],["T_WHITESPACE"," ",124],["T_DOUBLE_ARROW","=>",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","scopeConfig",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","getValue",124],"(",["T_WHITESPACE","\n                        ",124],["T_CONSTANT_ENCAPSED_STRING","'currency\/fixerio\/timeout'",125],",",["T_WHITESPACE","\n                        ",125],["T_NS_SEPARATOR","\\",126],["T_STRING","Magento",126],["T_NS_SEPARATOR","\\",126],["T_STRING","Store",126],["T_NS_SEPARATOR","\\",126],["T_STRING","Model",126],["T_NS_SEPARATOR","\\",126],["T_STRING","ScopeInterface",126],["T_DOUBLE_COLON","::",126],["T_STRING","SCOPE_STORE",126],["T_WHITESPACE","\n                    ",126],")",",",["T_WHITESPACE","\n                ",127],"]",["T_WHITESPACE","\n            ",128],")",["T_OBJECT_OPERATOR","->",129],["T_STRING","request",129],"(",["T_WHITESPACE","\n                ",129],["T_CONSTANT_ENCAPSED_STRING","'GET'",130],["T_WHITESPACE","\n            ",130],")",["T_OBJECT_OPERATOR","->",131],["T_STRING","getBody",131],"(",")",";",["T_WHITESPACE","\n\n            ",131],["T_VARIABLE","$response",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_STRING","json_decode",133],"(",["T_VARIABLE","$jsonResponse",133],",",["T_WHITESPACE"," ",133],["T_STRING","true",133],")",";",["T_WHITESPACE","\n        ",133],"}",["T_WHITESPACE"," ",134],["T_CATCH","catch",134],["T_WHITESPACE"," ",134],"(",["T_NS_SEPARATOR","\\",134],["T_STRING","Exception",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$e",134],")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n            ",134],["T_IF","if",135],["T_WHITESPACE"," ",135],"(",["T_VARIABLE","$retry",135],["T_WHITESPACE"," ",135],["T_IS_EQUAL","==",135],["T_WHITESPACE"," ",135],["T_LNUMBER","0",135],")",["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n                ",135],["T_VARIABLE","$response",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getServiceResponse",136],"(",["T_VARIABLE","$url",136],",",["T_WHITESPACE"," ",136],["T_LNUMBER","1",136],")",";",["T_WHITESPACE","\n            ",136],"}",["T_WHITESPACE","\n        ",137],"}",["T_WHITESPACE","\n        ",138],["T_RETURN","return",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$response",139],";",["T_WHITESPACE","\n    ",139],"}",["T_WHITESPACE","\n\n    ",140],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",142],["T_WHITESPACE","\n    ",144],["T_PROTECTED","protected",145],["T_WHITESPACE"," ",145],["T_FUNCTION","function",145],["T_WHITESPACE"," ",145],["T_STRING","_convert",145],"(",["T_VARIABLE","$currencyFrom",145],",",["T_WHITESPACE"," ",145],["T_VARIABLE","$currencyTo",145],")",["T_WHITESPACE","\n    ",145],"{",["T_WHITESPACE","\n    ",146],"}",["T_WHITESPACE","\n",147],"}",["T_WHITESPACE","\n",148]]