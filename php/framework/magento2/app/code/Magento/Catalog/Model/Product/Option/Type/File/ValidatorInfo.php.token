[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Catalog",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Model",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Product",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Option",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Type",7],["T_NS_SEPARATOR","\\",7],["T_STRING","File",7],";",["T_WHITESPACE","\n\n",7],["T_CLASS","class",9],["T_WHITESPACE"," ",9],["T_STRING","ValidatorInfo",9],["T_WHITESPACE"," ",9],["T_EXTENDS","extends",9],["T_WHITESPACE"," ",9],["T_STRING","Validator",9],["T_WHITESPACE","\n",9],"{",["T_WHITESPACE","\n    ",10],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\MediaStorage\\Helper\\File\\Storage\\Database\n     *\/",11],["T_WHITESPACE","\n    ",13],["T_PROTECTED","protected",14],["T_WHITESPACE"," ",14],["T_VARIABLE","$coreFileStorageDatabase",14],";",["T_WHITESPACE","\n\n    ",14],["T_DOC_COMMENT","\/**\n     * @var ValidateFactory\n     *\/",16],["T_WHITESPACE","\n    ",18],["T_PROTECTED","protected",19],["T_WHITESPACE"," ",19],["T_VARIABLE","$validateFactory",19],";",["T_WHITESPACE","\n\n    ",19],["T_DOC_COMMENT","\/**\n     * @var mixed\n     *\/",21],["T_WHITESPACE","\n    ",23],["T_PROTECTED","protected",24],["T_WHITESPACE"," ",24],["T_VARIABLE","$useQuotePath",24],";",["T_WHITESPACE","\n\n    ",24],["T_DOC_COMMENT","\/**\n     * @var string\n     *\/",26],["T_WHITESPACE","\n    ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$fileFullPath",29],";",["T_WHITESPACE","\n\n    ",29],["T_DOC_COMMENT","\/**\n     * @var string\n     *\/",31],["T_WHITESPACE","\n    ",33],["T_PROTECTED","protected",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$fileRelativePath",34],";",["T_WHITESPACE","\n\n    ",34],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\App\\Config\\ScopeConfigInterface $scopeConfig\n     * @param \\Magento\\Framework\\Filesystem $filesystem\n     * @param \\Magento\\Framework\\File\\Size $fileSize\n     * @param \\Magento\\MediaStorage\\Helper\\File\\Storage\\Database $coreFileStorageDatabase\n     * @param ValidateFactory $validateFactory\n     *\/",36],["T_WHITESPACE","\n    ",42],["T_PUBLIC","public",43],["T_WHITESPACE"," ",43],["T_FUNCTION","function",43],["T_WHITESPACE"," ",43],["T_STRING","__construct",43],"(",["T_WHITESPACE","\n        ",43],["T_NS_SEPARATOR","\\",44],["T_STRING","Magento",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Framework",44],["T_NS_SEPARATOR","\\",44],["T_STRING","App",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Config",44],["T_NS_SEPARATOR","\\",44],["T_STRING","ScopeConfigInterface",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$scopeConfig",44],",",["T_WHITESPACE","\n        ",44],["T_NS_SEPARATOR","\\",45],["T_STRING","Magento",45],["T_NS_SEPARATOR","\\",45],["T_STRING","Framework",45],["T_NS_SEPARATOR","\\",45],["T_STRING","Filesystem",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$filesystem",45],",",["T_WHITESPACE","\n        ",45],["T_NS_SEPARATOR","\\",46],["T_STRING","Magento",46],["T_NS_SEPARATOR","\\",46],["T_STRING","Framework",46],["T_NS_SEPARATOR","\\",46],["T_STRING","File",46],["T_NS_SEPARATOR","\\",46],["T_STRING","Size",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$fileSize",46],",",["T_WHITESPACE","\n        ",46],["T_NS_SEPARATOR","\\",47],["T_STRING","Magento",47],["T_NS_SEPARATOR","\\",47],["T_STRING","MediaStorage",47],["T_NS_SEPARATOR","\\",47],["T_STRING","Helper",47],["T_NS_SEPARATOR","\\",47],["T_STRING","File",47],["T_NS_SEPARATOR","\\",47],["T_STRING","Storage",47],["T_NS_SEPARATOR","\\",47],["T_STRING","Database",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$coreFileStorageDatabase",47],",",["T_WHITESPACE","\n        ",47],["T_NS_SEPARATOR","\\",48],["T_STRING","Magento",48],["T_NS_SEPARATOR","\\",48],["T_STRING","Catalog",48],["T_NS_SEPARATOR","\\",48],["T_STRING","Model",48],["T_NS_SEPARATOR","\\",48],["T_STRING","Product",48],["T_NS_SEPARATOR","\\",48],["T_STRING","Option",48],["T_NS_SEPARATOR","\\",48],["T_STRING","Type",48],["T_NS_SEPARATOR","\\",48],["T_STRING","File",48],["T_NS_SEPARATOR","\\",48],["T_STRING","ValidateFactory",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$validateFactory",48],["T_WHITESPACE","\n    ",48],")",["T_WHITESPACE"," ",49],"{",["T_WHITESPACE","\n        ",49],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","coreFileStorageDatabase",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_VARIABLE","$coreFileStorageDatabase",50],";",["T_WHITESPACE","\n        ",50],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","validateFactory",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$validateFactory",51],";",["T_WHITESPACE","\n        ",51],["T_STRING","parent",52],["T_DOUBLE_COLON","::",52],["T_STRING","__construct",52],"(",["T_VARIABLE","$scopeConfig",52],",",["T_WHITESPACE"," ",52],["T_VARIABLE","$filesystem",52],",",["T_WHITESPACE"," ",52],["T_VARIABLE","$fileSize",52],")",";",["T_WHITESPACE","\n    ",52],"}",["T_WHITESPACE","\n\n    ",53],["T_DOC_COMMENT","\/**\n     * @param mixed $useQuotePath\n     * @return $this\n     *\/",55],["T_WHITESPACE","\n    ",58],["T_PUBLIC","public",59],["T_WHITESPACE"," ",59],["T_FUNCTION","function",59],["T_WHITESPACE"," ",59],["T_STRING","setUseQuotePath",59],"(",["T_VARIABLE","$useQuotePath",59],")",["T_WHITESPACE","\n    ",59],"{",["T_WHITESPACE","\n        ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","useQuotePath",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_VARIABLE","$useQuotePath",61],";",["T_WHITESPACE","\n        ",61],["T_RETURN","return",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$this",62],";",["T_WHITESPACE","\n    ",62],"}",["T_WHITESPACE","\n\n    ",63],["T_DOC_COMMENT","\/**\n     * @param array $optionValue\n     * @param \\Magento\\Catalog\\Model\\Product\\Option $option\n     * @return bool\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     *\/",65],["T_WHITESPACE","\n    ",70],["T_PUBLIC","public",71],["T_WHITESPACE"," ",71],["T_FUNCTION","function",71],["T_WHITESPACE"," ",71],["T_STRING","validate",71],"(",["T_VARIABLE","$optionValue",71],",",["T_WHITESPACE"," ",71],["T_VARIABLE","$option",71],")",["T_WHITESPACE","\n    ",71],"{",["T_WHITESPACE","\n        ",72],["T_IF","if",73],["T_WHITESPACE"," ",73],"(","!",["T_STRING","is_array",73],"(",["T_VARIABLE","$optionValue",73],")",")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n            ",73],["T_RETURN","return",74],["T_WHITESPACE"," ",74],["T_STRING","false",74],";",["T_WHITESPACE","\n        ",74],"}",["T_WHITESPACE","\n\n        ",75],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","fileFullPath",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_STRING","null",77],";",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","fileRelativePath",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_STRING","null",78],";",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","initFilePath",79],"(",["T_VARIABLE","$optionValue",79],")",";",["T_WHITESPACE","\n\n        ",79],["T_IF","if",81],["T_WHITESPACE"," ",81],"(",["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","fileFullPath",81],["T_WHITESPACE"," ",81],["T_IS_IDENTICAL","===",81],["T_WHITESPACE"," ",81],["T_STRING","null",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n            ",81],["T_RETURN","return",82],["T_WHITESPACE"," ",82],["T_STRING","false",82],";",["T_WHITESPACE","\n        ",82],"}",["T_WHITESPACE","\n\n        ",83],["T_VARIABLE","$validatorChain",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","validateFactory",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","create",85],"(",")",";",["T_WHITESPACE","\n        ",85],["T_TRY","try",86],["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n            ",86],["T_VARIABLE","$validatorChain",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","buildImageValidator",87],"(",["T_VARIABLE","$validatorChain",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$option",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","fileFullPath",87],")",";",["T_WHITESPACE","\n        ",87],"}",["T_WHITESPACE"," ",88],["T_CATCH","catch",88],["T_WHITESPACE"," ",88],"(",["T_NS_SEPARATOR","\\",88],["T_STRING","Magento",88],["T_NS_SEPARATOR","\\",88],["T_STRING","Framework",88],["T_NS_SEPARATOR","\\",88],["T_STRING","Exception",88],["T_NS_SEPARATOR","\\",88],["T_STRING","InputException",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$notImage",88],")",["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n            ",88],["T_RETURN","return",89],["T_WHITESPACE"," ",89],["T_STRING","false",89],";",["T_WHITESPACE","\n        ",89],"}",["T_WHITESPACE","\n\n        ",90],["T_VARIABLE","$result",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_STRING","false",92],";",["T_WHITESPACE","\n        ",92],["T_IF","if",93],["T_WHITESPACE"," ",93],"(",["T_VARIABLE","$validatorChain",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","isValid",93],"(",["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","fileFullPath",93],")",")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n            ",93],["T_VARIABLE","$result",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","rootDirectory",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","isReadable",94],"(",["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","fileRelativePath",94],")",["T_WHITESPACE","\n                ",94],["T_BOOLEAN_AND","&&",95],["T_WHITESPACE"," ",95],["T_ISSET","isset",95],"(",["T_VARIABLE","$optionValue",95],"[",["T_CONSTANT_ENCAPSED_STRING","'secret_key'",95],"]",")",["T_WHITESPACE","\n                ",95],["T_BOOLEAN_AND","&&",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","buildSecretKey",96],"(",["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","fileRelativePath",96],")",["T_WHITESPACE"," ",96],["T_IS_EQUAL","==",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$optionValue",96],"[",["T_CONSTANT_ENCAPSED_STRING","'secret_key'",96],"]",";",["T_WHITESPACE","\n        ",96],"}",["T_WHITESPACE"," ",97],["T_ELSEIF","elseif",97],["T_WHITESPACE"," ",97],"(",["T_VARIABLE","$validatorChain",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","getErrors",97],"(",")",")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n            ",97],["T_VARIABLE","$errors",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getValidatorErrors",98],"(",["T_VARIABLE","$validatorChain",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getErrors",98],"(",")",",",["T_WHITESPACE"," ",98],["T_VARIABLE","$optionValue",98],",",["T_WHITESPACE"," ",98],["T_VARIABLE","$option",98],")",";",["T_WHITESPACE","\n\n            ",98],["T_IF","if",100],["T_WHITESPACE"," ",100],"(",["T_STRING","count",100],"(",["T_VARIABLE","$errors",100],")",["T_WHITESPACE"," ",100],">",["T_WHITESPACE"," ",100],["T_LNUMBER","0",100],")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n                ",100],["T_THROW","throw",101],["T_WHITESPACE"," ",101],["T_NEW","new",101],["T_WHITESPACE"," ",101],["T_NS_SEPARATOR","\\",101],["T_STRING","Magento",101],["T_NS_SEPARATOR","\\",101],["T_STRING","Framework",101],["T_NS_SEPARATOR","\\",101],["T_STRING","Exception",101],["T_NS_SEPARATOR","\\",101],["T_STRING","LocalizedException",101],"(",["T_STRING","__",101],"(",["T_STRING","implode",101],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",101],",",["T_WHITESPACE"," ",101],["T_VARIABLE","$errors",101],")",")",")",";",["T_WHITESPACE","\n            ",101],"}",["T_WHITESPACE","\n        ",102],"}",["T_WHITESPACE"," ",103],["T_ELSE","else",103],["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n            ",103],["T_THROW","throw",104],["T_WHITESPACE"," ",104],["T_NEW","new",104],["T_WHITESPACE"," ",104],["T_NS_SEPARATOR","\\",104],["T_STRING","Magento",104],["T_NS_SEPARATOR","\\",104],["T_STRING","Framework",104],["T_NS_SEPARATOR","\\",104],["T_STRING","Exception",104],["T_NS_SEPARATOR","\\",104],["T_STRING","LocalizedException",104],"(",["T_WHITESPACE","\n                ",104],["T_STRING","__",105],"(",["T_CONSTANT_ENCAPSED_STRING","'Please specify product\\'s required option(s).'",105],")",["T_WHITESPACE","\n            ",105],")",";",["T_WHITESPACE","\n        ",106],"}",["T_WHITESPACE","\n        ",107],["T_RETURN","return",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$result",108],";",["T_WHITESPACE","\n    ",108],"}",["T_WHITESPACE","\n\n    ",109],["T_DOC_COMMENT","\/**\n     * @param string $fileRelativePath\n     * @return string\n     *\/",111],["T_WHITESPACE","\n    ",114],["T_PROTECTED","protected",115],["T_WHITESPACE"," ",115],["T_FUNCTION","function",115],["T_WHITESPACE"," ",115],["T_STRING","buildSecretKey",115],"(",["T_VARIABLE","$fileRelativePath",115],")",["T_WHITESPACE","\n    ",115],"{",["T_WHITESPACE","\n        ",116],["T_RETURN","return",117],["T_WHITESPACE"," ",117],["T_STRING","substr",117],"(",["T_STRING","md5",117],"(",["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","rootDirectory",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","readFile",117],"(",["T_VARIABLE","$fileRelativePath",117],")",")",",",["T_WHITESPACE"," ",117],["T_LNUMBER","0",117],",",["T_WHITESPACE"," ",117],["T_LNUMBER","20",117],")",";",["T_WHITESPACE","\n    ",117],"}",["T_WHITESPACE","\n\n    ",118],["T_DOC_COMMENT","\/**\n     * @param array $optionValue\n     * @return void\n     *\/",120],["T_WHITESPACE","\n    ",123],["T_PROTECTED","protected",124],["T_WHITESPACE"," ",124],["T_FUNCTION","function",124],["T_WHITESPACE"," ",124],["T_STRING","initFilePath",124],"(",["T_VARIABLE","$optionValue",124],")",["T_WHITESPACE","\n    ",124],"{",["T_WHITESPACE","\n        ",125],["T_DOC_COMMENT","\/**\n         * @see \\Magento\\Catalog\\Model\\Product\\Option\\Type\\File\\ValidatorFile::validate\n         *              There setUserValue() sets correct fileFullPath only for\n         *              quote_path. So we must form both full paths manually and\n         *              check them.\n         *\/",126],["T_WHITESPACE","\n        ",131],["T_VARIABLE","$checkPaths",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],"[","]",";",["T_WHITESPACE","\n        ",132],["T_IF","if",133],["T_WHITESPACE"," ",133],"(",["T_ISSET","isset",133],"(",["T_VARIABLE","$optionValue",133],"[",["T_CONSTANT_ENCAPSED_STRING","'quote_path'",133],"]",")",")",["T_WHITESPACE"," ",133],"{",["T_WHITESPACE","\n            ",133],["T_VARIABLE","$checkPaths",134],"[","]",["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_VARIABLE","$optionValue",134],"[",["T_CONSTANT_ENCAPSED_STRING","'quote_path'",134],"]",";",["T_WHITESPACE","\n        ",134],"}",["T_WHITESPACE","\n        ",135],["T_IF","if",136],["T_WHITESPACE"," ",136],"(",["T_ISSET","isset",136],"(",["T_VARIABLE","$optionValue",136],"[",["T_CONSTANT_ENCAPSED_STRING","'order_path'",136],"]",")",["T_WHITESPACE"," ",136],["T_BOOLEAN_AND","&&",136],["T_WHITESPACE"," ",136],"!",["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","useQuotePath",136],")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n            ",136],["T_VARIABLE","$checkPaths",137],"[","]",["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_VARIABLE","$optionValue",137],"[",["T_CONSTANT_ENCAPSED_STRING","'order_path'",137],"]",";",["T_WHITESPACE","\n        ",137],"}",["T_WHITESPACE","\n\n        ",138],["T_FOREACH","foreach",140],["T_WHITESPACE"," ",140],"(",["T_VARIABLE","$checkPaths",140],["T_WHITESPACE"," ",140],["T_AS","as",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$path",140],")",["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n            ",140],["T_IF","if",141],["T_WHITESPACE"," ",141],"(","!",["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","rootDirectory",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","isFile",141],"(",["T_VARIABLE","$path",141],")",")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n                ",141],["T_IF","if",142],["T_WHITESPACE"," ",142],"(","!",["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","coreFileStorageDatabase",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","saveFileToFilesystem",142],"(",["T_VARIABLE","$path",142],")",")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n                    ",142],["T_CONTINUE","continue",143],";",["T_WHITESPACE","\n                ",143],"}",["T_WHITESPACE","\n            ",144],"}",["T_WHITESPACE","\n            ",145],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","fileFullPath",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","rootDirectory",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","getAbsolutePath",146],"(",["T_VARIABLE","$path",146],")",";",["T_WHITESPACE","\n            ",146],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","fileRelativePath",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_VARIABLE","$path",147],";",["T_WHITESPACE","\n            ",147],["T_BREAK","break",148],";",["T_WHITESPACE","\n        ",148],"}",["T_WHITESPACE","\n    ",149],"}",["T_WHITESPACE","\n",150],"}",["T_WHITESPACE","\n",151]]