[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Catalog",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","ResourceModel",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Product",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Store",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Model",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Store",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * Catalog product media gallery resource model.\n *\/",10],["T_WHITESPACE","\n",12],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","Gallery",13],["T_WHITESPACE"," ",13],["T_EXTENDS","extends",13],["T_WHITESPACE"," ",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Framework",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Model",13],["T_NS_SEPARATOR","\\",13],["T_STRING","ResourceModel",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Db",13],["T_NS_SEPARATOR","\\",13],["T_STRING","AbstractDb",13],["T_WHITESPACE","\n",13],"{",["T_WHITESPACE","\n    ",14],["T_COMMENT","\/**#@+\n     * Constants defined for keys of  data array\n     *\/",15],["T_WHITESPACE","\n    ",17],["T_CONST","const",18],["T_WHITESPACE"," ",18],["T_STRING","GALLERY_TABLE",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity_media_gallery'",18],";",["T_WHITESPACE","\n\n    ",18],["T_CONST","const",20],["T_WHITESPACE"," ",20],["T_STRING","GALLERY_VALUE_TABLE",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity_media_gallery_value'",20],";",["T_WHITESPACE","\n\n    ",20],["T_CONST","const",22],["T_WHITESPACE"," ",22],["T_STRING","GALLERY_VALUE_TO_ENTITY_TABLE",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity_media_gallery_value_to_entity'",22],";",["T_WHITESPACE","\n    ",22],["T_COMMENT","\/**#@-*\/",23],["T_WHITESPACE","\n\n    ",23],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\EntityManager\\EntityMetadata\n     *\/",25],["T_WHITESPACE","\n    ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$metadata",28],";",["T_WHITESPACE","\n\n    ",28],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\Model\\ResourceModel\\Db\\Context $context\n     * @param \\Magento\\Framework\\EntityManager\\MetadataPool $metadataPool\n     * @param string $connectionName\n     *\/",30],["T_WHITESPACE","\n    ",34],["T_PUBLIC","public",35],["T_WHITESPACE"," ",35],["T_FUNCTION","function",35],["T_WHITESPACE"," ",35],["T_STRING","__construct",35],"(",["T_WHITESPACE","\n        ",35],["T_NS_SEPARATOR","\\",36],["T_STRING","Magento",36],["T_NS_SEPARATOR","\\",36],["T_STRING","Framework",36],["T_NS_SEPARATOR","\\",36],["T_STRING","Model",36],["T_NS_SEPARATOR","\\",36],["T_STRING","ResourceModel",36],["T_NS_SEPARATOR","\\",36],["T_STRING","Db",36],["T_NS_SEPARATOR","\\",36],["T_STRING","Context",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$context",36],",",["T_WHITESPACE","\n        ",36],["T_NS_SEPARATOR","\\",37],["T_STRING","Magento",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Framework",37],["T_NS_SEPARATOR","\\",37],["T_STRING","EntityManager",37],["T_NS_SEPARATOR","\\",37],["T_STRING","MetadataPool",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$metadataPool",37],",",["T_WHITESPACE","\n        ",37],["T_VARIABLE","$connectionName",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_STRING","null",38],["T_WHITESPACE","\n    ",38],")",["T_WHITESPACE"," ",39],"{",["T_WHITESPACE","\n        ",39],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","metadata",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$metadataPool",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","getMetadata",40],"(",["T_WHITESPACE","\n            ",40],["T_NS_SEPARATOR","\\",41],["T_STRING","Magento",41],["T_NS_SEPARATOR","\\",41],["T_STRING","Catalog",41],["T_NS_SEPARATOR","\\",41],["T_STRING","Api",41],["T_NS_SEPARATOR","\\",41],["T_STRING","Data",41],["T_NS_SEPARATOR","\\",41],["T_STRING","ProductInterface",41],["T_DOUBLE_COLON","::",41],["T_CLASS","class",41],["T_WHITESPACE","\n        ",41],")",";",["T_WHITESPACE","\n\n        ",42],["T_STRING","parent",44],["T_DOUBLE_COLON","::",44],["T_STRING","__construct",44],"(",["T_VARIABLE","$context",44],",",["T_WHITESPACE"," ",44],["T_VARIABLE","$connectionName",44],")",";",["T_WHITESPACE","\n    ",44],"}",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",47],["T_WHITESPACE","\n    ",49],["T_PROTECTED","protected",50],["T_WHITESPACE"," ",50],["T_FUNCTION","function",50],["T_WHITESPACE"," ",50],["T_STRING","_construct",50],"(",")",["T_WHITESPACE","\n    ",50],"{",["T_WHITESPACE","\n        ",51],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","_init",52],"(",["T_STRING","self",52],["T_DOUBLE_COLON","::",52],["T_STRING","GALLERY_TABLE",52],",",["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","'value_id'",52],")",";",["T_WHITESPACE","\n    ",52],"}",["T_WHITESPACE","\n\n    ",53],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",55],["T_WHITESPACE","\n    ",57],["T_PUBLIC","public",58],["T_WHITESPACE"," ",58],["T_FUNCTION","function",58],["T_WHITESPACE"," ",58],["T_STRING","getConnection",58],"(",")",["T_WHITESPACE","\n    ",58],"{",["T_WHITESPACE","\n        ",59],["T_RETURN","return",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","metadata",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","getEntityConnection",60],"(",")",";",["T_WHITESPACE","\n    ",60],"}",["T_WHITESPACE","\n\n    ",61],["T_DOC_COMMENT","\/**\n     * @param string $tableNameAlias\n     * @param array $ids\n     * @param int|null $storeId\n     * @param array|null $cols\n     * @param array $leftJoinTables\n     * @param string $whereCondition\n     * @return array\n     *\/",63],["T_WHITESPACE","\n    ",71],["T_PUBLIC","public",72],["T_WHITESPACE"," ",72],["T_FUNCTION","function",72],["T_WHITESPACE"," ",72],["T_STRING","loadDataFromTableByValueId",72],"(",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$tableNameAlias",73],",",["T_WHITESPACE","\n        ",73],["T_ARRAY","array",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$ids",74],",",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$storeId",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_STRING","null",75],",",["T_WHITESPACE","\n        ",75],["T_ARRAY","array",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$cols",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_STRING","null",76],",",["T_WHITESPACE","\n        ",76],["T_ARRAY","array",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$leftJoinTables",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],"[","]",",",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$whereCondition",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_STRING","null",78],["T_WHITESPACE","\n    ",78],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n        ",79],["T_IF","if",80],["T_WHITESPACE"," ",80],"(",["T_STRING","null",80],["T_WHITESPACE"," ",80],["T_IS_EQUAL","==",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$cols",80],")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n            ",80],["T_VARIABLE","$cols",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'*'",81],";",["T_WHITESPACE","\n        ",81],"}",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$mainTableAlias",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","getMainTableAlias",83],"(",")",";",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$select",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getConnection",84],"(",")",["T_OBJECT_OPERATOR","->",84],["T_STRING","select",84],"(",")",["T_WHITESPACE","\n            ",84],["T_OBJECT_OPERATOR","->",85],["T_STRING","from",85],"(",["T_WHITESPACE","\n                ",85],"[",["T_VARIABLE","$mainTableAlias",86],["T_WHITESPACE"," ",86],["T_DOUBLE_ARROW","=>",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getTable",86],"(",["T_VARIABLE","$tableNameAlias",86],")","]",",",["T_WHITESPACE","\n                ",86],["T_VARIABLE","$cols",87],["T_WHITESPACE","\n            ",87],")",["T_OBJECT_OPERATOR","->",88],["T_STRING","where",88],"(",["T_WHITESPACE","\n                ",88],["T_VARIABLE","$mainTableAlias",89],".",["T_CONSTANT_ENCAPSED_STRING","'.value_id IN(?)'",89],",",["T_WHITESPACE","\n                ",89],["T_VARIABLE","$ids",90],["T_WHITESPACE","\n            ",90],")",";",["T_WHITESPACE","\n        ",91],["T_IF","if",92],["T_WHITESPACE"," ",92],"(",["T_STRING","null",92],["T_WHITESPACE"," ",92],["T_IS_NOT_IDENTICAL","!==",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$storeId",92],")",["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n            ",92],["T_VARIABLE","$select",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","where",93],"(",["T_VARIABLE","$mainTableAlias",93],["T_WHITESPACE"," ",93],".",["T_WHITESPACE"," ",93],["T_CONSTANT_ENCAPSED_STRING","'.store_id = ?'",93],",",["T_WHITESPACE"," ",93],["T_VARIABLE","$storeId",93],")",";",["T_WHITESPACE","\n        ",93],"}",["T_WHITESPACE","\n        ",94],["T_IF","if",95],["T_WHITESPACE"," ",95],"(",["T_STRING","null",95],["T_WHITESPACE"," ",95],["T_IS_NOT_IDENTICAL","!==",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$whereCondition",95],")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n            ",95],["T_VARIABLE","$select",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","where",96],"(",["T_VARIABLE","$whereCondition",96],")",";",["T_WHITESPACE","\n        ",96],"}",["T_WHITESPACE","\n        ",97],["T_FOREACH","foreach",98],["T_WHITESPACE"," ",98],"(",["T_VARIABLE","$leftJoinTables",98],["T_WHITESPACE"," ",98],["T_AS","as",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$joinParameters",98],")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n            ",98],["T_VARIABLE","$select",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","joinLeft",99],"(",["T_VARIABLE","$joinParameters",99],"[",["T_LNUMBER","0",99],"]",",",["T_WHITESPACE"," ",99],["T_VARIABLE","$joinParameters",99],"[",["T_LNUMBER","1",99],"]",",",["T_WHITESPACE"," ",99],["T_VARIABLE","$joinParameters",99],"[",["T_LNUMBER","2",99],"]",")",";",["T_WHITESPACE","\n        ",99],"}",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$result",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getConnection",101],"(",")",["T_OBJECT_OPERATOR","->",101],["T_STRING","fetchAll",101],"(",["T_VARIABLE","$select",101],")",";",["T_WHITESPACE","\n\n        ",101],["T_RETURN","return",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$result",103],";",["T_WHITESPACE","\n    ",103],"}",["T_WHITESPACE","\n\n    ",104],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @param int $attributeId\n     * @return array\n     *\/",106],["T_WHITESPACE","\n    ",110],["T_PUBLIC","public",111],["T_WHITESPACE"," ",111],["T_FUNCTION","function",111],["T_WHITESPACE"," ",111],["T_STRING","loadProductGalleryByAttributeId",111],"(",["T_VARIABLE","$product",111],",",["T_WHITESPACE"," ",111],["T_VARIABLE","$attributeId",111],")",["T_WHITESPACE","\n    ",111],"{",["T_WHITESPACE","\n        ",112],["T_VARIABLE","$select",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","createBaseLoadSelect",113],"(",["T_WHITESPACE","\n            ",113],["T_VARIABLE","$product",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","getData",114],"(",["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","metadata",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","getLinkField",114],"(",")",")",",",["T_WHITESPACE","\n            ",114],["T_VARIABLE","$product",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","getStoreId",115],"(",")",",",["T_WHITESPACE","\n            ",115],["T_VARIABLE","$attributeId",116],["T_WHITESPACE","\n        ",116],")",";",["T_WHITESPACE","\n\n        ",117],["T_VARIABLE","$result",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getConnection",119],"(",")",["T_OBJECT_OPERATOR","->",119],["T_STRING","fetchAll",119],"(",["T_VARIABLE","$select",119],")",";",["T_WHITESPACE","\n\n        ",119],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","removeDuplicates",121],"(",["T_VARIABLE","$result",121],")",";",["T_WHITESPACE","\n\n        ",121],["T_RETURN","return",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$result",123],";",["T_WHITESPACE","\n    ",123],"}",["T_WHITESPACE","\n\n    ",124],["T_DOC_COMMENT","\/**\n     * @param int $entityId\n     * @param int $storeId\n     * @param int $attributeId\n     * @return \\Magento\\Framework\\DB\\Select\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     *\/",126],["T_WHITESPACE","\n    ",132],["T_PROTECTED","protected",133],["T_WHITESPACE"," ",133],["T_FUNCTION","function",133],["T_WHITESPACE"," ",133],["T_STRING","createBaseLoadSelect",133],"(",["T_VARIABLE","$entityId",133],",",["T_WHITESPACE"," ",133],["T_VARIABLE","$storeId",133],",",["T_WHITESPACE"," ",133],["T_VARIABLE","$attributeId",133],")",["T_WHITESPACE","\n    ",133],"{",["T_WHITESPACE","\n        ",134],["T_VARIABLE","$select",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE","  ",135],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","createBatchBaseSelect",135],"(",["T_VARIABLE","$storeId",135],",",["T_WHITESPACE"," ",135],["T_VARIABLE","$attributeId",135],")",";",["T_WHITESPACE","\n\n        ",135],["T_VARIABLE","$select",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_VARIABLE","$select",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","where",137],"(",["T_WHITESPACE","\n            ",137],["T_CONSTANT_ENCAPSED_STRING","'entity.'",138],["T_WHITESPACE"," ",138],".",["T_WHITESPACE"," ",138],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","metadata",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","getLinkField",138],"(",")",["T_WHITESPACE"," ",138],".",["T_CONSTANT_ENCAPSED_STRING","' = ?'",138],",",["T_WHITESPACE","\n            ",138],["T_VARIABLE","$entityId",139],["T_WHITESPACE","\n        ",139],")",";",["T_WHITESPACE","\n        ",140],["T_RETURN","return",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$select",141],";",["T_WHITESPACE","\n    ",141],"}",["T_WHITESPACE","\n\n    ",142],["T_DOC_COMMENT","\/**\n     * @param int $storeId\n     * @param int $attributeId\n     * @return \\Magento\\Framework\\DB\\Select\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     *\/",144],["T_WHITESPACE","\n    ",149],["T_PUBLIC","public",150],["T_WHITESPACE"," ",150],["T_FUNCTION","function",150],["T_WHITESPACE"," ",150],["T_STRING","createBatchBaseSelect",150],"(",["T_VARIABLE","$storeId",150],",",["T_WHITESPACE"," ",150],["T_VARIABLE","$attributeId",150],")",["T_WHITESPACE","\n    ",150],"{",["T_WHITESPACE","\n        ",151],["T_VARIABLE","$linkField",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","metadata",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","getLinkField",152],"(",")",";",["T_WHITESPACE","\n\n        ",152],["T_VARIABLE","$positionCheckSql",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","getConnection",154],"(",")",["T_OBJECT_OPERATOR","->",154],["T_STRING","getCheckSql",154],"(",["T_WHITESPACE","\n            ",154],["T_CONSTANT_ENCAPSED_STRING","'value.position IS NULL'",155],",",["T_WHITESPACE","\n            ",155],["T_CONSTANT_ENCAPSED_STRING","'default_value.position'",156],",",["T_WHITESPACE","\n            ",156],["T_CONSTANT_ENCAPSED_STRING","'value.position'",157],["T_WHITESPACE","\n        ",157],")",";",["T_WHITESPACE","\n\n        ",158],["T_VARIABLE","$mainTableAlias",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","getMainTableAlias",160],"(",")",";",["T_WHITESPACE","\n\n        ",160],["T_VARIABLE","$select",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","getConnection",162],"(",")",["T_OBJECT_OPERATOR","->",162],["T_STRING","select",162],"(",")",["T_OBJECT_OPERATOR","->",162],["T_STRING","from",162],"(",["T_WHITESPACE","\n            ",162],"[",["T_VARIABLE","$mainTableAlias",163],["T_WHITESPACE"," ",163],["T_DOUBLE_ARROW","=>",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","getMainTable",163],"(",")","]",",",["T_WHITESPACE","\n            ",163],"[",["T_WHITESPACE","\n                ",164],["T_CONSTANT_ENCAPSED_STRING","'value_id'",165],",",["T_WHITESPACE","\n                ",165],["T_CONSTANT_ENCAPSED_STRING","'file'",166],["T_WHITESPACE"," ",166],["T_DOUBLE_ARROW","=>",166],["T_WHITESPACE"," ",166],["T_CONSTANT_ENCAPSED_STRING","'value'",166],",",["T_WHITESPACE","\n                ",166],["T_CONSTANT_ENCAPSED_STRING","'media_type'",167],["T_WHITESPACE","\n            ",167],"]",["T_WHITESPACE","\n        ",168],")",["T_OBJECT_OPERATOR","->",169],["T_STRING","joinInner",169],"(",["T_WHITESPACE","\n            ",169],"[",["T_CONSTANT_ENCAPSED_STRING","'entity'",170],["T_WHITESPACE"," ",170],["T_DOUBLE_ARROW","=>",170],["T_WHITESPACE"," ",170],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","getTable",170],"(",["T_STRING","self",170],["T_DOUBLE_COLON","::",170],["T_STRING","GALLERY_VALUE_TO_ENTITY_TABLE",170],")","]",",",["T_WHITESPACE","\n            ",170],["T_VARIABLE","$mainTableAlias",171],["T_WHITESPACE"," ",171],".",["T_WHITESPACE"," ",171],["T_CONSTANT_ENCAPSED_STRING","'.value_id = entity.value_id'",171],",",["T_WHITESPACE","\n            ",171],"[",["T_VARIABLE","$linkField",172],"]",["T_WHITESPACE","\n        ",172],")",["T_OBJECT_OPERATOR","->",173],["T_STRING","joinLeft",173],"(",["T_WHITESPACE","\n            ",173],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",174],["T_WHITESPACE"," ",174],["T_DOUBLE_ARROW","=>",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","getTable",174],"(",["T_STRING","self",174],["T_DOUBLE_COLON","::",174],["T_STRING","GALLERY_VALUE_TABLE",174],")","]",",",["T_WHITESPACE","\n            ",174],["T_STRING","implode",175],"(",["T_WHITESPACE","\n                ",175],["T_CONSTANT_ENCAPSED_STRING","' AND '",176],",",["T_WHITESPACE","\n                ",176],"[",["T_WHITESPACE","\n                    ",177],["T_VARIABLE","$mainTableAlias",178],["T_WHITESPACE"," ",178],".",["T_WHITESPACE"," ",178],["T_CONSTANT_ENCAPSED_STRING","'.value_id = value.value_id'",178],",",["T_WHITESPACE","\n                    ",178],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","getConnection",179],"(",")",["T_OBJECT_OPERATOR","->",179],["T_STRING","quoteInto",179],"(",["T_CONSTANT_ENCAPSED_STRING","'value.store_id = ?'",179],",",["T_WHITESPACE"," ",179],["T_INT_CAST","(int)",179],["T_VARIABLE","$storeId",179],")",",",["T_WHITESPACE","\n                ",179],"]",["T_WHITESPACE","\n            ",180],")",",",["T_WHITESPACE","\n            ",181],"[",["T_CONSTANT_ENCAPSED_STRING","'label'",182],",",["T_WHITESPACE"," ",182],["T_CONSTANT_ENCAPSED_STRING","'position'",182],",",["T_WHITESPACE"," ",182],["T_CONSTANT_ENCAPSED_STRING","'disabled'",182],"]",["T_WHITESPACE","\n        ",182],")",["T_OBJECT_OPERATOR","->",183],["T_STRING","joinLeft",183],"(",["T_WHITESPACE","\n            ",183],"[",["T_CONSTANT_ENCAPSED_STRING","'default_value'",184],["T_WHITESPACE"," ",184],["T_DOUBLE_ARROW","=>",184],["T_WHITESPACE"," ",184],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getTable",184],"(",["T_STRING","self",184],["T_DOUBLE_COLON","::",184],["T_STRING","GALLERY_VALUE_TABLE",184],")","]",",",["T_WHITESPACE","\n            ",184],["T_STRING","implode",185],"(",["T_WHITESPACE","\n                ",185],["T_CONSTANT_ENCAPSED_STRING","' AND '",186],",",["T_WHITESPACE","\n                ",186],"[",["T_WHITESPACE","\n                    ",187],["T_VARIABLE","$mainTableAlias",188],["T_WHITESPACE"," ",188],".",["T_WHITESPACE"," ",188],["T_CONSTANT_ENCAPSED_STRING","'.value_id = default_value.value_id'",188],",",["T_WHITESPACE","\n                    ",188],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getConnection",189],"(",")",["T_OBJECT_OPERATOR","->",189],["T_STRING","quoteInto",189],"(",["T_CONSTANT_ENCAPSED_STRING","'default_value.store_id = ?'",189],",",["T_WHITESPACE"," ",189],["T_STRING","Store",189],["T_DOUBLE_COLON","::",189],["T_STRING","DEFAULT_STORE_ID",189],")",",",["T_WHITESPACE","\n                ",189],"]",["T_WHITESPACE","\n            ",190],")",",",["T_WHITESPACE","\n            ",191],"[",["T_CONSTANT_ENCAPSED_STRING","'label_default'",192],["T_WHITESPACE"," ",192],["T_DOUBLE_ARROW","=>",192],["T_WHITESPACE"," ",192],["T_CONSTANT_ENCAPSED_STRING","'label'",192],",",["T_WHITESPACE"," ",192],["T_CONSTANT_ENCAPSED_STRING","'position_default'",192],["T_WHITESPACE"," ",192],["T_DOUBLE_ARROW","=>",192],["T_WHITESPACE"," ",192],["T_CONSTANT_ENCAPSED_STRING","'position'",192],",",["T_WHITESPACE"," ",192],["T_CONSTANT_ENCAPSED_STRING","'disabled_default'",192],["T_WHITESPACE"," ",192],["T_DOUBLE_ARROW","=>",192],["T_WHITESPACE"," ",192],["T_CONSTANT_ENCAPSED_STRING","'disabled'",192],"]",["T_WHITESPACE","\n        ",192],")",["T_OBJECT_OPERATOR","->",193],["T_STRING","where",193],"(",["T_WHITESPACE","\n            ",193],["T_VARIABLE","$mainTableAlias",194],["T_WHITESPACE"," ",194],".",["T_WHITESPACE"," ",194],["T_CONSTANT_ENCAPSED_STRING","'.attribute_id = ?'",194],",",["T_WHITESPACE","\n            ",194],["T_VARIABLE","$attributeId",195],["T_WHITESPACE","\n        ",195],")",["T_OBJECT_OPERATOR","->",196],["T_STRING","where",196],"(",["T_WHITESPACE","\n            ",196],["T_VARIABLE","$mainTableAlias",197],["T_WHITESPACE"," ",197],".",["T_WHITESPACE"," ",197],["T_CONSTANT_ENCAPSED_STRING","'.disabled = 0'",197],["T_WHITESPACE","\n        ",197],")",["T_OBJECT_OPERATOR","->",198],["T_STRING","order",198],"(",["T_WHITESPACE","\n            ",198],["T_VARIABLE","$positionCheckSql",199],["T_WHITESPACE"," ",199],".",["T_WHITESPACE"," ",199],["T_CONSTANT_ENCAPSED_STRING","' '",199],["T_WHITESPACE"," ",199],".",["T_WHITESPACE"," ",199],["T_NS_SEPARATOR","\\",199],["T_STRING","Magento",199],["T_NS_SEPARATOR","\\",199],["T_STRING","Framework",199],["T_NS_SEPARATOR","\\",199],["T_STRING","DB",199],["T_NS_SEPARATOR","\\",199],["T_STRING","Select",199],["T_DOUBLE_COLON","::",199],["T_STRING","SQL_ASC",199],["T_WHITESPACE","\n        ",199],")",";",["T_WHITESPACE","\n\n        ",200],["T_RETURN","return",202],["T_WHITESPACE"," ",202],["T_VARIABLE","$select",202],";",["T_WHITESPACE","\n    ",202],"}",["T_WHITESPACE","\n\n    ",203],["T_DOC_COMMENT","\/**\n     * Removes duplicates.\n     *\n     * @param array &$result\n     * @return $this\n     *\/",205],["T_WHITESPACE","\n    ",210],["T_PROTECTED","protected",211],["T_WHITESPACE"," ",211],["T_FUNCTION","function",211],["T_WHITESPACE"," ",211],["T_STRING","removeDuplicates",211],"(","&",["T_VARIABLE","$result",211],")",["T_WHITESPACE","\n    ",211],"{",["T_WHITESPACE","\n        ",212],["T_VARIABLE","$fileToId",213],["T_WHITESPACE"," ",213],"=",["T_WHITESPACE"," ",213],"[","]",";",["T_WHITESPACE","\n\n        ",213],["T_FOREACH","foreach",215],["T_WHITESPACE"," ",215],"(",["T_STRING","array_keys",215],"(",["T_VARIABLE","$result",215],")",["T_WHITESPACE"," ",215],["T_AS","as",215],["T_WHITESPACE"," ",215],["T_VARIABLE","$index",215],")",["T_WHITESPACE"," ",215],"{",["T_WHITESPACE","\n            ",215],["T_IF","if",216],["T_WHITESPACE"," ",216],"(","!",["T_ISSET","isset",216],"(",["T_VARIABLE","$fileToId",216],"[",["T_VARIABLE","$result",216],"[",["T_VARIABLE","$index",216],"]","[",["T_CONSTANT_ENCAPSED_STRING","'file'",216],"]","]",")",")",["T_WHITESPACE"," ",216],"{",["T_WHITESPACE","\n                ",216],["T_VARIABLE","$fileToId",217],"[",["T_VARIABLE","$result",217],"[",["T_VARIABLE","$index",217],"]","[",["T_CONSTANT_ENCAPSED_STRING","'file'",217],"]","]",["T_WHITESPACE"," ",217],"=",["T_WHITESPACE"," ",217],["T_VARIABLE","$result",217],"[",["T_VARIABLE","$index",217],"]","[",["T_CONSTANT_ENCAPSED_STRING","'value_id'",217],"]",";",["T_WHITESPACE","\n            ",217],"}",["T_WHITESPACE"," ",218],["T_ELSEIF","elseif",218],["T_WHITESPACE"," ",218],"(",["T_VARIABLE","$fileToId",218],"[",["T_VARIABLE","$result",218],"[",["T_VARIABLE","$index",218],"]","[",["T_CONSTANT_ENCAPSED_STRING","'file'",218],"]","]",["T_WHITESPACE"," ",218],["T_IS_NOT_EQUAL","!=",218],["T_WHITESPACE"," ",218],["T_VARIABLE","$result",218],"[",["T_VARIABLE","$index",218],"]","[",["T_CONSTANT_ENCAPSED_STRING","'value_id'",218],"]",")",["T_WHITESPACE"," ",218],"{",["T_WHITESPACE","\n                ",218],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","deleteGallery",219],"(",["T_VARIABLE","$result",219],"[",["T_VARIABLE","$index",219],"]","[",["T_CONSTANT_ENCAPSED_STRING","'value_id'",219],"]",")",";",["T_WHITESPACE","\n                ",219],["T_UNSET","unset",220],"(",["T_VARIABLE","$result",220],"[",["T_VARIABLE","$index",220],"]",")",";",["T_WHITESPACE","\n            ",220],"}",["T_WHITESPACE","\n        ",221],"}",["T_WHITESPACE","\n\n        ",222],["T_VARIABLE","$result",224],["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],["T_STRING","array_values",224],"(",["T_VARIABLE","$result",224],")",";",["T_WHITESPACE","\n\n        ",224],["T_RETURN","return",226],["T_WHITESPACE"," ",226],["T_VARIABLE","$this",226],";",["T_WHITESPACE","\n    ",226],"}",["T_WHITESPACE","\n\n    ",227],["T_DOC_COMMENT","\/**\n     * @return string\n     *\/",229],["T_WHITESPACE","\n    ",231],["T_PUBLIC","public",232],["T_WHITESPACE"," ",232],["T_FUNCTION","function",232],["T_WHITESPACE"," ",232],["T_STRING","getMainTableAlias",232],"(",")",["T_WHITESPACE","\n    ",232],"{",["T_WHITESPACE","\n        ",233],["T_RETURN","return",234],["T_WHITESPACE"," ",234],["T_CONSTANT_ENCAPSED_STRING","'main'",234],";",["T_WHITESPACE","\n    ",234],"}",["T_WHITESPACE","\n\n    ",235],["T_DOC_COMMENT","\/**\n     * @param int $valueId\n     * @param int $entityId\n     * @return int\n     *\/",237],["T_WHITESPACE","\n    ",241],["T_PUBLIC","public",242],["T_WHITESPACE"," ",242],["T_FUNCTION","function",242],["T_WHITESPACE"," ",242],["T_STRING","bindValueToEntity",242],"(",["T_VARIABLE","$valueId",242],",",["T_WHITESPACE"," ",242],["T_VARIABLE","$entityId",242],")",["T_WHITESPACE","\n    ",242],"{",["T_WHITESPACE","\n        ",243],["T_RETURN","return",244],["T_WHITESPACE"," ",244],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","saveDataRow",244],"(",["T_WHITESPACE","\n            ",244],["T_STRING","self",245],["T_DOUBLE_COLON","::",245],["T_STRING","GALLERY_VALUE_TO_ENTITY_TABLE",245],",",["T_WHITESPACE","\n            ",245],"[",["T_WHITESPACE","\n                ",246],["T_CONSTANT_ENCAPSED_STRING","'value_id'",247],["T_WHITESPACE"," ",247],["T_DOUBLE_ARROW","=>",247],["T_WHITESPACE"," ",247],["T_VARIABLE","$valueId",247],",",["T_WHITESPACE","\n                ",247],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","metadata",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","getLinkField",248],"(",")",["T_WHITESPACE"," ",248],["T_DOUBLE_ARROW","=>",248],["T_WHITESPACE"," ",248],["T_VARIABLE","$entityId",248],["T_WHITESPACE","\n            ",248],"]",["T_WHITESPACE","\n        ",249],")",";",["T_WHITESPACE","\n    ",250],"}",["T_WHITESPACE","\n\n    ",251],["T_DOC_COMMENT","\/**\n     * @param string $table\n     * @param array $data\n     * @param array $fields\n     * @return int\n     *\/",253],["T_WHITESPACE","\n    ",258],["T_PUBLIC","public",259],["T_WHITESPACE"," ",259],["T_FUNCTION","function",259],["T_WHITESPACE"," ",259],["T_STRING","saveDataRow",259],"(",["T_VARIABLE","$table",259],",",["T_WHITESPACE"," ",259],["T_ARRAY","array",259],["T_WHITESPACE"," ",259],["T_VARIABLE","$data",259],",",["T_WHITESPACE"," ",259],["T_ARRAY","array",259],["T_WHITESPACE"," ",259],["T_VARIABLE","$fields",259],["T_WHITESPACE"," ",259],"=",["T_WHITESPACE"," ",259],"[","]",")",["T_WHITESPACE","\n    ",259],"{",["T_WHITESPACE","\n        ",260],["T_VARIABLE","$table",261],["T_WHITESPACE"," ",261],"=",["T_WHITESPACE"," ",261],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","getTable",261],"(",["T_VARIABLE","$table",261],")",";",["T_WHITESPACE","\n        ",261],["T_RETURN","return",262],["T_WHITESPACE"," ",262],["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","getConnection",262],"(",")",["T_OBJECT_OPERATOR","->",262],["T_STRING","insertOnDuplicate",262],"(",["T_VARIABLE","$table",262],",",["T_WHITESPACE"," ",262],["T_VARIABLE","$data",262],",",["T_WHITESPACE"," ",262],["T_VARIABLE","$fields",262],")",";",["T_WHITESPACE","\n    ",262],"}",["T_WHITESPACE","\n\n    ",263],["T_DOC_COMMENT","\/**\n     * Inserts gallery value to DB and retrieve last Id.\n     *\n     * @param array $data\n     * @return int\n     *\/",265],["T_WHITESPACE","\n    ",270],["T_PUBLIC","public",271],["T_WHITESPACE"," ",271],["T_FUNCTION","function",271],["T_WHITESPACE"," ",271],["T_STRING","insertGallery",271],"(",["T_VARIABLE","$data",271],")",["T_WHITESPACE","\n    ",271],"{",["T_WHITESPACE","\n        ",272],["T_VARIABLE","$data",273],["T_WHITESPACE"," ",273],"=",["T_WHITESPACE"," ",273],["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","_prepareDataForTable",273],"(",["T_WHITESPACE","\n            ",273],["T_NEW","new",274],["T_WHITESPACE"," ",274],["T_NS_SEPARATOR","\\",274],["T_STRING","Magento",274],["T_NS_SEPARATOR","\\",274],["T_STRING","Framework",274],["T_NS_SEPARATOR","\\",274],["T_STRING","DataObject",274],"(",["T_VARIABLE","$data",274],")",",",["T_WHITESPACE","\n            ",274],["T_VARIABLE","$this",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","getMainTable",275],"(",")",["T_WHITESPACE","\n        ",275],")",";",["T_WHITESPACE","\n\n        ",276],["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","getConnection",278],"(",")",["T_OBJECT_OPERATOR","->",278],["T_STRING","insert",278],"(",["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","getMainTable",278],"(",")",",",["T_WHITESPACE"," ",278],["T_VARIABLE","$data",278],")",";",["T_WHITESPACE","\n\n        ",278],["T_RETURN","return",280],["T_WHITESPACE"," ",280],["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","getConnection",280],"(",")",["T_OBJECT_OPERATOR","->",280],["T_STRING","lastInsertId",280],"(",["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","getMainTable",280],"(",")",")",";",["T_WHITESPACE","\n    ",280],"}",["T_WHITESPACE","\n\n    ",281],["T_DOC_COMMENT","\/**\n     * Deletes gallery value in Db.\n     *\n     * @param array|integer $valueId\n     * @return $this\n     *\/",283],["T_WHITESPACE","\n    ",288],["T_PUBLIC","public",289],["T_WHITESPACE"," ",289],["T_FUNCTION","function",289],["T_WHITESPACE"," ",289],["T_STRING","deleteGallery",289],"(",["T_VARIABLE","$valueId",289],")",["T_WHITESPACE","\n    ",289],"{",["T_WHITESPACE","\n        ",290],["T_IF","if",291],["T_WHITESPACE"," ",291],"(",["T_STRING","is_array",291],"(",["T_VARIABLE","$valueId",291],")",["T_WHITESPACE"," ",291],["T_BOOLEAN_AND","&&",291],["T_WHITESPACE"," ",291],["T_STRING","count",291],"(",["T_VARIABLE","$valueId",291],")",["T_WHITESPACE"," ",291],">",["T_WHITESPACE"," ",291],["T_LNUMBER","0",291],")",["T_WHITESPACE"," ",291],"{",["T_WHITESPACE","\n            ",291],["T_VARIABLE","$condition",292],["T_WHITESPACE"," ",292],"=",["T_WHITESPACE"," ",292],["T_VARIABLE","$this",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","getConnection",292],"(",")",["T_OBJECT_OPERATOR","->",292],["T_STRING","quoteInto",292],"(",["T_CONSTANT_ENCAPSED_STRING","'value_id IN(?) '",292],",",["T_WHITESPACE"," ",292],["T_VARIABLE","$valueId",292],")",";",["T_WHITESPACE","\n        ",292],"}",["T_WHITESPACE"," ",293],["T_ELSEIF","elseif",293],["T_WHITESPACE"," ",293],"(","!",["T_STRING","is_array",293],"(",["T_VARIABLE","$valueId",293],")",")",["T_WHITESPACE"," ",293],"{",["T_WHITESPACE","\n            ",293],["T_VARIABLE","$condition",294],["T_WHITESPACE"," ",294],"=",["T_WHITESPACE"," ",294],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","getConnection",294],"(",")",["T_OBJECT_OPERATOR","->",294],["T_STRING","quoteInto",294],"(",["T_CONSTANT_ENCAPSED_STRING","'value_id = ? '",294],",",["T_WHITESPACE"," ",294],["T_VARIABLE","$valueId",294],")",";",["T_WHITESPACE","\n        ",294],"}",["T_WHITESPACE"," ",295],["T_ELSE","else",295],["T_WHITESPACE"," ",295],"{",["T_WHITESPACE","\n            ",295],["T_RETURN","return",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$this",296],";",["T_WHITESPACE","\n        ",296],"}",["T_WHITESPACE","\n\n        ",297],["T_VARIABLE","$this",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","getConnection",299],"(",")",["T_OBJECT_OPERATOR","->",299],["T_STRING","delete",299],"(",["T_VARIABLE","$this",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","getMainTable",299],"(",")",",",["T_WHITESPACE"," ",299],["T_VARIABLE","$condition",299],")",";",["T_WHITESPACE","\n\n        ",299],["T_RETURN","return",301],["T_WHITESPACE"," ",301],["T_VARIABLE","$this",301],";",["T_WHITESPACE","\n    ",301],"}",["T_WHITESPACE","\n\n    ",302],["T_DOC_COMMENT","\/**\n     * Inserts gallery value for store to Db.\n     *\n     * @param array $data\n     * @return $this\n     *\/",304],["T_WHITESPACE","\n    ",309],["T_PUBLIC","public",310],["T_WHITESPACE"," ",310],["T_FUNCTION","function",310],["T_WHITESPACE"," ",310],["T_STRING","insertGalleryValueInStore",310],"(",["T_VARIABLE","$data",310],")",["T_WHITESPACE","\n    ",310],"{",["T_WHITESPACE","\n        ",311],["T_VARIABLE","$data",312],["T_WHITESPACE"," ",312],"=",["T_WHITESPACE"," ",312],["T_VARIABLE","$this",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","_prepareDataForTable",312],"(",["T_WHITESPACE","\n            ",312],["T_NEW","new",313],["T_WHITESPACE"," ",313],["T_NS_SEPARATOR","\\",313],["T_STRING","Magento",313],["T_NS_SEPARATOR","\\",313],["T_STRING","Framework",313],["T_NS_SEPARATOR","\\",313],["T_STRING","DataObject",313],"(",["T_VARIABLE","$data",313],")",",",["T_WHITESPACE","\n            ",313],["T_VARIABLE","$this",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","getTable",314],"(",["T_STRING","self",314],["T_DOUBLE_COLON","::",314],["T_STRING","GALLERY_VALUE_TABLE",314],")",["T_WHITESPACE","\n        ",314],")",";",["T_WHITESPACE","\n\n        ",315],["T_VARIABLE","$this",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","getConnection",317],"(",")",["T_OBJECT_OPERATOR","->",317],["T_STRING","insert",317],"(",["T_WHITESPACE","\n            ",317],["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","getTable",318],"(",["T_STRING","self",318],["T_DOUBLE_COLON","::",318],["T_STRING","GALLERY_VALUE_TABLE",318],")",",",["T_WHITESPACE","\n            ",318],["T_VARIABLE","$data",319],["T_WHITESPACE","\n        ",319],")",";",["T_WHITESPACE","\n\n        ",320],["T_RETURN","return",322],["T_WHITESPACE"," ",322],["T_VARIABLE","$this",322],";",["T_WHITESPACE","\n    ",322],"}",["T_WHITESPACE","\n\n    ",323],["T_DOC_COMMENT","\/**\n     * Deletes gallery value for store in DB.\n     *\n     * @param int $valueId\n     * @param int $entityId\n     * @param int $storeId\n     * @return $this\n     *\/",325],["T_WHITESPACE","\n    ",332],["T_PUBLIC","public",333],["T_WHITESPACE"," ",333],["T_FUNCTION","function",333],["T_WHITESPACE"," ",333],["T_STRING","deleteGalleryValueInStore",333],"(",["T_VARIABLE","$valueId",333],",",["T_WHITESPACE"," ",333],["T_VARIABLE","$entityId",333],",",["T_WHITESPACE"," ",333],["T_VARIABLE","$storeId",333],")",["T_WHITESPACE","\n    ",333],"{",["T_WHITESPACE","\n        ",334],["T_VARIABLE","$conditions",335],["T_WHITESPACE"," ",335],"=",["T_WHITESPACE"," ",335],["T_STRING","implode",335],"(",["T_WHITESPACE","\n            ",335],["T_CONSTANT_ENCAPSED_STRING","' AND '",336],",",["T_WHITESPACE","\n            ",336],"[",["T_WHITESPACE","\n                ",337],["T_VARIABLE","$this",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","getConnection",338],"(",")",["T_OBJECT_OPERATOR","->",338],["T_STRING","quoteInto",338],"(",["T_CONSTANT_ENCAPSED_STRING","'value_id = ?'",338],",",["T_WHITESPACE"," ",338],["T_INT_CAST","(int)",338],["T_WHITESPACE"," ",338],["T_VARIABLE","$valueId",338],")",",",["T_WHITESPACE","\n                ",338],["T_VARIABLE","$this",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","getConnection",339],"(",")",["T_OBJECT_OPERATOR","->",339],["T_STRING","quoteInto",339],"(",["T_VARIABLE","$this",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","metadata",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","getLinkField",339],"(",")",["T_WHITESPACE"," ",339],".",["T_WHITESPACE"," ",339],["T_CONSTANT_ENCAPSED_STRING","' = ?'",339],",",["T_WHITESPACE"," ",339],["T_INT_CAST","(int)",339],["T_WHITESPACE"," ",339],["T_VARIABLE","$entityId",339],")",",",["T_WHITESPACE","\n                ",339],["T_VARIABLE","$this",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","getConnection",340],"(",")",["T_OBJECT_OPERATOR","->",340],["T_STRING","quoteInto",340],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id = ?'",340],",",["T_WHITESPACE"," ",340],["T_INT_CAST","(int)",340],["T_WHITESPACE"," ",340],["T_VARIABLE","$storeId",340],")",["T_WHITESPACE","\n            ",340],"]",["T_WHITESPACE","\n        ",341],")",";",["T_WHITESPACE","\n\n        ",342],["T_VARIABLE","$this",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","getConnection",344],"(",")",["T_OBJECT_OPERATOR","->",344],["T_STRING","delete",344],"(",["T_WHITESPACE","\n            ",344],["T_VARIABLE","$this",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","getTable",345],"(",["T_STRING","self",345],["T_DOUBLE_COLON","::",345],["T_STRING","GALLERY_VALUE_TABLE",345],")",",",["T_WHITESPACE","\n            ",345],["T_VARIABLE","$conditions",346],["T_WHITESPACE","\n        ",346],")",";",["T_WHITESPACE","\n\n        ",347],["T_RETURN","return",349],["T_WHITESPACE"," ",349],["T_VARIABLE","$this",349],";",["T_WHITESPACE","\n    ",349],"}",["T_WHITESPACE","\n\n    ",350],["T_DOC_COMMENT","\/**\n     * Duplicates gallery DB values.\n     *\n     * @param int $attributeId\n     * @param array $newFiles\n     * @param int $originalProductId\n     * @param int $newProductId\n     * @return array\n     *\/",352],["T_WHITESPACE","\n    ",360],["T_PUBLIC","public",361],["T_WHITESPACE"," ",361],["T_FUNCTION","function",361],["T_WHITESPACE"," ",361],["T_STRING","duplicate",361],"(",["T_VARIABLE","$attributeId",361],",",["T_WHITESPACE"," ",361],["T_VARIABLE","$newFiles",361],",",["T_WHITESPACE"," ",361],["T_VARIABLE","$originalProductId",361],",",["T_WHITESPACE"," ",361],["T_VARIABLE","$newProductId",361],")",["T_WHITESPACE","\n    ",361],"{",["T_WHITESPACE","\n        ",362],["T_VARIABLE","$linkField",363],["T_WHITESPACE"," ",363],"=",["T_WHITESPACE"," ",363],["T_VARIABLE","$this",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","metadata",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","getLinkField",363],"(",")",";",["T_WHITESPACE","\n\n        ",363],["T_VARIABLE","$select",365],["T_WHITESPACE"," ",365],"=",["T_WHITESPACE"," ",365],["T_VARIABLE","$this",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","getConnection",365],"(",")",["T_OBJECT_OPERATOR","->",365],["T_STRING","select",365],"(",")",["T_OBJECT_OPERATOR","->",365],["T_STRING","from",365],"(",["T_WHITESPACE","\n            ",365],"[",["T_VARIABLE","$this",366],["T_OBJECT_OPERATOR","->",366],["T_STRING","getMainTableAlias",366],"(",")",["T_WHITESPACE"," ",366],["T_DOUBLE_ARROW","=>",366],["T_WHITESPACE"," ",366],["T_VARIABLE","$this",366],["T_OBJECT_OPERATOR","->",366],["T_STRING","getMainTable",366],"(",")","]",",",["T_WHITESPACE","\n            ",366],"[",["T_CONSTANT_ENCAPSED_STRING","'value_id'",367],",",["T_WHITESPACE"," ",367],["T_CONSTANT_ENCAPSED_STRING","'value'",367],"]",["T_WHITESPACE","\n        ",367],")",["T_OBJECT_OPERATOR","->",368],["T_STRING","joinInner",368],"(",["T_WHITESPACE","\n            ",368],"[",["T_CONSTANT_ENCAPSED_STRING","'entity'",369],["T_WHITESPACE"," ",369],["T_DOUBLE_ARROW","=>",369],["T_WHITESPACE"," ",369],["T_VARIABLE","$this",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","getTable",369],"(",["T_STRING","self",369],["T_DOUBLE_COLON","::",369],["T_STRING","GALLERY_VALUE_TO_ENTITY_TABLE",369],")","]",",",["T_WHITESPACE","\n            ",369],["T_VARIABLE","$this",370],["T_OBJECT_OPERATOR","->",370],["T_STRING","getMainTableAlias",370],"(",")",["T_WHITESPACE"," ",370],".",["T_WHITESPACE"," ",370],["T_CONSTANT_ENCAPSED_STRING","'.value_id = entity.value_id'",370],",",["T_WHITESPACE","\n            ",370],"[",["T_VARIABLE","$linkField",371],"]",["T_WHITESPACE","\n        ",371],")",["T_OBJECT_OPERATOR","->",372],["T_STRING","where",372],"(",["T_WHITESPACE","\n            ",372],["T_CONSTANT_ENCAPSED_STRING","'attribute_id = ?'",373],",",["T_WHITESPACE","\n            ",373],["T_VARIABLE","$attributeId",374],["T_WHITESPACE","\n        ",374],")",["T_OBJECT_OPERATOR","->",375],["T_STRING","where",375],"(",["T_WHITESPACE","\n            ",375],["T_CONSTANT_ENCAPSED_STRING","'entity.'",376],["T_WHITESPACE"," ",376],".",["T_WHITESPACE"," ",376],["T_VARIABLE","$linkField",376],["T_WHITESPACE"," ",376],".",["T_WHITESPACE"," ",376],["T_CONSTANT_ENCAPSED_STRING","' = ?'",376],",",["T_WHITESPACE","\n            ",376],["T_VARIABLE","$originalProductId",377],["T_WHITESPACE","\n        ",377],")",";",["T_WHITESPACE","\n\n        ",378],["T_VARIABLE","$valueIdMap",380],["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],"[","]",";",["T_WHITESPACE","\n\n        ",380],["T_COMMENT","\/\/ Duplicate main entries of gallery\n",382],["T_WHITESPACE","        ",383],["T_FOREACH","foreach",383],["T_WHITESPACE"," ",383],"(",["T_VARIABLE","$this",383],["T_OBJECT_OPERATOR","->",383],["T_STRING","getConnection",383],"(",")",["T_OBJECT_OPERATOR","->",383],["T_STRING","fetchAll",383],"(",["T_VARIABLE","$select",383],")",["T_WHITESPACE"," ",383],["T_AS","as",383],["T_WHITESPACE"," ",383],["T_VARIABLE","$row",383],")",["T_WHITESPACE"," ",383],"{",["T_WHITESPACE","\n            ",383],["T_VARIABLE","$data",384],["T_WHITESPACE"," ",384],"=",["T_WHITESPACE"," ",384],"[",["T_WHITESPACE","\n                ",384],["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",385],["T_WHITESPACE"," ",385],["T_DOUBLE_ARROW","=>",385],["T_WHITESPACE"," ",385],["T_VARIABLE","$attributeId",385],",",["T_WHITESPACE","\n                ",385],["T_CONSTANT_ENCAPSED_STRING","'value'",386],["T_WHITESPACE"," ",386],["T_DOUBLE_ARROW","=>",386],["T_WHITESPACE"," ",386],["T_ISSET","isset",386],"(",["T_VARIABLE","$newFiles",386],"[",["T_VARIABLE","$row",386],"[",["T_CONSTANT_ENCAPSED_STRING","'value_id'",386],"]","]",")",["T_WHITESPACE"," ",386],"?",["T_WHITESPACE"," ",386],["T_VARIABLE","$newFiles",386],"[",["T_VARIABLE","$row",386],"[",["T_CONSTANT_ENCAPSED_STRING","'value_id'",386],"]","]",["T_WHITESPACE"," ",386],":",["T_WHITESPACE"," ",386],["T_VARIABLE","$row",386],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",386],"]",",",["T_WHITESPACE","\n            ",386],"]",";",["T_WHITESPACE","\n\n            ",387],["T_VARIABLE","$valueIdMap",389],"[",["T_VARIABLE","$row",389],"[",["T_CONSTANT_ENCAPSED_STRING","'value_id'",389],"]","]",["T_WHITESPACE"," ",389],"=",["T_WHITESPACE"," ",389],["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","insertGallery",389],"(",["T_VARIABLE","$data",389],")",";",["T_WHITESPACE","\n            ",389],["T_VARIABLE","$this",390],["T_OBJECT_OPERATOR","->",390],["T_STRING","bindValueToEntity",390],"(",["T_VARIABLE","$valueIdMap",390],"[",["T_VARIABLE","$row",390],"[",["T_CONSTANT_ENCAPSED_STRING","'value_id'",390],"]","]",",",["T_WHITESPACE"," ",390],["T_VARIABLE","$newProductId",390],")",";",["T_WHITESPACE","\n        ",390],"}",["T_WHITESPACE","\n\n        ",391],["T_IF","if",393],["T_WHITESPACE"," ",393],"(",["T_STRING","count",393],"(",["T_VARIABLE","$valueIdMap",393],")",["T_WHITESPACE"," ",393],["T_IS_EQUAL","==",393],["T_WHITESPACE"," ",393],["T_LNUMBER","0",393],")",["T_WHITESPACE"," ",393],"{",["T_WHITESPACE","\n            ",393],["T_RETURN","return",394],["T_WHITESPACE"," ",394],"[","]",";",["T_WHITESPACE","\n        ",394],"}",["T_WHITESPACE","\n\n        ",395],["T_COMMENT","\/\/ Duplicate per store gallery values\n",397],["T_WHITESPACE","        ",398],["T_VARIABLE","$select",398],["T_WHITESPACE"," ",398],"=",["T_WHITESPACE"," ",398],["T_VARIABLE","$this",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","getConnection",398],"(",")",["T_OBJECT_OPERATOR","->",398],["T_STRING","select",398],"(",")",["T_OBJECT_OPERATOR","->",398],["T_STRING","from",398],"(",["T_WHITESPACE","\n            ",398],["T_VARIABLE","$this",399],["T_OBJECT_OPERATOR","->",399],["T_STRING","getTable",399],"(",["T_STRING","self",399],["T_DOUBLE_COLON","::",399],["T_STRING","GALLERY_VALUE_TABLE",399],")",["T_WHITESPACE","\n        ",399],")",["T_OBJECT_OPERATOR","->",400],["T_STRING","where",400],"(",["T_WHITESPACE","\n            ",400],["T_CONSTANT_ENCAPSED_STRING","'value_id IN(?)'",401],",",["T_WHITESPACE","\n            ",401],["T_STRING","array_keys",402],"(",["T_VARIABLE","$valueIdMap",402],")",["T_WHITESPACE","\n        ",402],")",";",["T_WHITESPACE","\n\n        ",403],["T_FOREACH","foreach",405],["T_WHITESPACE"," ",405],"(",["T_VARIABLE","$this",405],["T_OBJECT_OPERATOR","->",405],["T_STRING","getConnection",405],"(",")",["T_OBJECT_OPERATOR","->",405],["T_STRING","fetchAll",405],"(",["T_VARIABLE","$select",405],")",["T_WHITESPACE"," ",405],["T_AS","as",405],["T_WHITESPACE"," ",405],["T_VARIABLE","$row",405],")",["T_WHITESPACE"," ",405],"{",["T_WHITESPACE","\n            ",405],["T_UNSET","unset",406],"(",["T_VARIABLE","$row",406],"[",["T_CONSTANT_ENCAPSED_STRING","'record_id'",406],"]",")",";",["T_WHITESPACE","\n\n            ",406],["T_VARIABLE","$row",408],"[",["T_VARIABLE","$linkField",408],"]",["T_WHITESPACE"," ",408],"=",["T_WHITESPACE"," ",408],["T_VARIABLE","$newProductId",408],";",["T_WHITESPACE","\n            ",408],["T_VARIABLE","$row",409],"[",["T_CONSTANT_ENCAPSED_STRING","'value_id'",409],"]",["T_WHITESPACE"," ",409],"=",["T_WHITESPACE"," ",409],["T_VARIABLE","$valueIdMap",409],"[",["T_VARIABLE","$row",409],"[",["T_CONSTANT_ENCAPSED_STRING","'value_id'",409],"]","]",";",["T_WHITESPACE","\n\n            ",409],["T_VARIABLE","$this",411],["T_OBJECT_OPERATOR","->",411],["T_STRING","insertGalleryValueInStore",411],"(",["T_VARIABLE","$row",411],")",";",["T_WHITESPACE","\n        ",411],"}",["T_WHITESPACE","\n\n        ",412],["T_RETURN","return",414],["T_WHITESPACE"," ",414],["T_VARIABLE","$valueIdMap",414],";",["T_WHITESPACE","\n    ",414],"}",["T_WHITESPACE","\n\n    ",415],["T_DOC_COMMENT","\/**\n     * Returns product images in specific stores.\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @param int|array $storeIds\n     * @return array\n     *\/",417],["T_WHITESPACE","\n    ",423],["T_PUBLIC","public",424],["T_WHITESPACE"," ",424],["T_FUNCTION","function",424],["T_WHITESPACE"," ",424],["T_STRING","getProductImages",424],"(",["T_VARIABLE","$product",424],",",["T_WHITESPACE"," ",424],["T_VARIABLE","$storeIds",424],")",["T_WHITESPACE","\n    ",424],"{",["T_WHITESPACE","\n        ",425],["T_IF","if",426],["T_WHITESPACE"," ",426],"(","!",["T_STRING","is_array",426],"(",["T_VARIABLE","$storeIds",426],")",")",["T_WHITESPACE"," ",426],"{",["T_WHITESPACE","\n            ",426],["T_VARIABLE","$storeIds",427],["T_WHITESPACE"," ",427],"=",["T_WHITESPACE"," ",427],"[",["T_VARIABLE","$storeIds",427],"]",";",["T_WHITESPACE","\n        ",427],"}",["T_WHITESPACE","\n\n        ",428],["T_VARIABLE","$mainTable",430],["T_WHITESPACE"," ",430],"=",["T_WHITESPACE"," ",430],["T_VARIABLE","$product",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","getResource",430],"(",")",["T_OBJECT_OPERATOR","->",430],["T_STRING","getAttribute",430],"(",["T_CONSTANT_ENCAPSED_STRING","'image'",430],")",["T_OBJECT_OPERATOR","->",430],["T_STRING","getBackend",430],"(",")",["T_OBJECT_OPERATOR","->",430],["T_STRING","getTable",430],"(",")",";",["T_WHITESPACE","\n\n        ",430],["T_VARIABLE","$select",432],["T_WHITESPACE"," ",432],"=",["T_WHITESPACE"," ",432],["T_VARIABLE","$this",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","getConnection",432],"(",")",["T_OBJECT_OPERATOR","->",432],["T_STRING","select",432],"(",")",["T_OBJECT_OPERATOR","->",432],["T_STRING","from",432],"(",["T_WHITESPACE","\n            ",432],"[",["T_CONSTANT_ENCAPSED_STRING","'images'",433],["T_WHITESPACE"," ",433],["T_DOUBLE_ARROW","=>",433],["T_WHITESPACE"," ",433],["T_VARIABLE","$mainTable",433],"]",",",["T_WHITESPACE","\n            ",433],"[",["T_CONSTANT_ENCAPSED_STRING","'value as filepath'",434],",",["T_WHITESPACE"," ",434],["T_CONSTANT_ENCAPSED_STRING","'store_id'",434],"]",["T_WHITESPACE","\n        ",434],")",["T_OBJECT_OPERATOR","->",435],["T_STRING","joinLeft",435],"(",["T_WHITESPACE","\n            ",435],"[",["T_CONSTANT_ENCAPSED_STRING","'attr'",436],["T_WHITESPACE"," ",436],["T_DOUBLE_ARROW","=>",436],["T_WHITESPACE"," ",436],["T_VARIABLE","$this",436],["T_OBJECT_OPERATOR","->",436],["T_STRING","getTable",436],"(",["T_CONSTANT_ENCAPSED_STRING","'eav_attribute'",436],")","]",",",["T_WHITESPACE","\n            ",436],["T_CONSTANT_ENCAPSED_STRING","'images.attribute_id = attr.attribute_id'",437],",",["T_WHITESPACE","\n            ",437],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_code'",438],"]",["T_WHITESPACE","\n        ",438],")",["T_OBJECT_OPERATOR","->",439],["T_STRING","where",439],"(",["T_WHITESPACE","\n            ",439],["T_VARIABLE","$this",440],["T_OBJECT_OPERATOR","->",440],["T_STRING","metadata",440],["T_OBJECT_OPERATOR","->",440],["T_STRING","getLinkField",440],"(",")",["T_WHITESPACE"," ",440],".",["T_WHITESPACE"," ",440],["T_CONSTANT_ENCAPSED_STRING","' = ?'",440],",",["T_WHITESPACE","\n            ",440],["T_VARIABLE","$product",441],["T_OBJECT_OPERATOR","->",441],["T_STRING","getData",441],"(",["T_VARIABLE","$this",441],["T_OBJECT_OPERATOR","->",441],["T_STRING","metadata",441],["T_OBJECT_OPERATOR","->",441],["T_STRING","getLinkField",441],"(",")",")",["T_WHITESPACE","\n        ",441],")",["T_OBJECT_OPERATOR","->",442],["T_STRING","where",442],"(",["T_WHITESPACE","\n            ",442],["T_CONSTANT_ENCAPSED_STRING","'store_id IN (?)'",443],",",["T_WHITESPACE","\n            ",443],["T_VARIABLE","$storeIds",444],["T_WHITESPACE","\n        ",444],")",["T_OBJECT_OPERATOR","->",445],["T_STRING","where",445],"(",["T_WHITESPACE","\n            ",445],["T_CONSTANT_ENCAPSED_STRING","'attribute_code IN (?)'",446],",",["T_WHITESPACE","\n            ",446],"[",["T_CONSTANT_ENCAPSED_STRING","'small_image'",447],",",["T_WHITESPACE"," ",447],["T_CONSTANT_ENCAPSED_STRING","'thumbnail'",447],",",["T_WHITESPACE"," ",447],["T_CONSTANT_ENCAPSED_STRING","'image'",447],"]",["T_WHITESPACE","\n        ",447],")",";",["T_WHITESPACE","\n\n        ",448],["T_RETURN","return",450],["T_WHITESPACE"," ",450],["T_VARIABLE","$this",450],["T_OBJECT_OPERATOR","->",450],["T_STRING","getConnection",450],"(",")",["T_OBJECT_OPERATOR","->",450],["T_STRING","fetchAll",450],"(",["T_VARIABLE","$select",450],")",";",["T_WHITESPACE","\n    ",450],"}",["T_WHITESPACE","\n",451],"}",["T_WHITESPACE","\n",452]]