[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Catalog",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Indexer",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Product",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Flat",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Catalog",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Api",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Data",8],["T_NS_SEPARATOR","\\",8],["T_STRING","ProductInterface",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","App",9],["T_NS_SEPARATOR","\\",9],["T_STRING","ResourceConnection",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","EntityManager",10],["T_NS_SEPARATOR","\\",10],["T_STRING","MetadataPool",10],";",["T_WHITESPACE","\n\n",10],["T_DOC_COMMENT","\/**\n * Abstract action reindex class\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",12],["T_WHITESPACE","\n",15],["T_ABSTRACT","abstract",16],["T_WHITESPACE"," ",16],["T_CLASS","class",16],["T_WHITESPACE"," ",16],["T_STRING","AbstractAction",16],["T_WHITESPACE","\n",16],"{",["T_WHITESPACE","\n    ",17],["T_DOC_COMMENT","\/**\n     * Suffix for value field on composite attributes\n     *\n     * @var string\n     *\/",18],["T_WHITESPACE","\n    ",22],["T_PROTECTED","protected",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$_valueFieldSuffix",23],["T_WHITESPACE"," ",23],"=",["T_WHITESPACE"," ",23],["T_CONSTANT_ENCAPSED_STRING","'_value'",23],";",["T_WHITESPACE","\n\n    ",23],["T_DOC_COMMENT","\/**\n     * Suffix for drop table (uses on flat table rename)\n     *\n     * @var string\n     *\/",25],["T_WHITESPACE","\n    ",29],["T_PROTECTED","protected",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$_tableDropSuffix",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_CONSTANT_ENCAPSED_STRING","'_drop_indexer'",30],";",["T_WHITESPACE","\n\n    ",30],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Store\\Model\\StoreManagerInterface\n     *\/",32],["T_WHITESPACE","\n    ",34],["T_PROTECTED","protected",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$_storeManager",35],";",["T_WHITESPACE","\n\n    ",35],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Catalog\\Helper\\Product\\Flat\\Indexer\n     *\/",37],["T_WHITESPACE","\n    ",39],["T_PROTECTED","protected",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$_productIndexerHelper",40],";",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\DB\\Adapter\\AdapterInterface\n     *\/",42],["T_WHITESPACE","\n    ",44],["T_PROTECTED","protected",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$_connection",45],";",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Catalog\\Model\\Product\\Type\n     *\/",47],["T_WHITESPACE","\n    ",49],["T_PROTECTED","protected",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$_productType",50],";",["T_WHITESPACE","\n\n    ",50],["T_DOC_COMMENT","\/**\n     * Existing flat tables flags pool\n     *\n     * @var array\n     *\/",52],["T_WHITESPACE","\n    ",56],["T_PROTECTED","protected",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$_flatTablesExist",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],"[","]",";",["T_WHITESPACE","\n\n    ",57],["T_DOC_COMMENT","\/**\n     * List of product types available in installation\n     *\n     * @var array\n     *\/",59],["T_WHITESPACE","\n    ",63],["T_PROTECTED","protected",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$_productTypes",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],"[","]",";",["T_WHITESPACE","\n\n    ",64],["T_DOC_COMMENT","\/**\n     * @var TableBuilder\n     *\/",66],["T_WHITESPACE","\n    ",68],["T_PROTECTED","protected",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$_tableBuilder",69],";",["T_WHITESPACE","\n\n    ",69],["T_DOC_COMMENT","\/**\n     * @var FlatTableBuilder\n     *\/",71],["T_WHITESPACE","\n    ",73],["T_PROTECTED","protected",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$_flatTableBuilder",74],";",["T_WHITESPACE","\n\n    ",74],["T_DOC_COMMENT","\/**\n     * @var MetadataPool\n     *\/",76],["T_WHITESPACE","\n    ",78],["T_PRIVATE","private",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$metadataPool",79],";",["T_WHITESPACE","\n\n    ",79],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\App\\ResourceConnection $resource\n     * @param \\Magento\\Store\\Model\\StoreManagerInterface $storeManager\n     * @param \\Magento\\Catalog\\Helper\\Product\\Flat\\Indexer $productHelper\n     * @param \\Magento\\Catalog\\Model\\Product\\Type $productType\n     * @param TableBuilder $tableBuilder\n     * @param FlatTableBuilder $flatTableBuilder\n     *\/",81],["T_WHITESPACE","\n    ",88],["T_PUBLIC","public",89],["T_WHITESPACE"," ",89],["T_FUNCTION","function",89],["T_WHITESPACE"," ",89],["T_STRING","__construct",89],"(",["T_WHITESPACE","\n        ",89],["T_NS_SEPARATOR","\\",90],["T_STRING","Magento",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Framework",90],["T_NS_SEPARATOR","\\",90],["T_STRING","App",90],["T_NS_SEPARATOR","\\",90],["T_STRING","ResourceConnection",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$resource",90],",",["T_WHITESPACE","\n        ",90],["T_NS_SEPARATOR","\\",91],["T_STRING","Magento",91],["T_NS_SEPARATOR","\\",91],["T_STRING","Store",91],["T_NS_SEPARATOR","\\",91],["T_STRING","Model",91],["T_NS_SEPARATOR","\\",91],["T_STRING","StoreManagerInterface",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$storeManager",91],",",["T_WHITESPACE","\n        ",91],["T_NS_SEPARATOR","\\",92],["T_STRING","Magento",92],["T_NS_SEPARATOR","\\",92],["T_STRING","Catalog",92],["T_NS_SEPARATOR","\\",92],["T_STRING","Helper",92],["T_NS_SEPARATOR","\\",92],["T_STRING","Product",92],["T_NS_SEPARATOR","\\",92],["T_STRING","Flat",92],["T_NS_SEPARATOR","\\",92],["T_STRING","Indexer",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$productHelper",92],",",["T_WHITESPACE","\n        ",92],["T_NS_SEPARATOR","\\",93],["T_STRING","Magento",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Catalog",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Model",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Product",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Type",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$productType",93],",",["T_WHITESPACE","\n        ",93],["T_STRING","TableBuilder",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$tableBuilder",94],",",["T_WHITESPACE","\n        ",94],["T_STRING","FlatTableBuilder",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$flatTableBuilder",95],["T_WHITESPACE","\n    ",95],")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","_storeManager",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$storeManager",97],";",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","_productIndexerHelper",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$productHelper",98],";",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","_productType",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_VARIABLE","$productType",99],";",["T_WHITESPACE","\n        ",99],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","_connection",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$resource",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getConnection",100],"(",")",";",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","_tableBuilder",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$tableBuilder",101],";",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","_flatTableBuilder",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$flatTableBuilder",102],";",["T_WHITESPACE","\n    ",102],"}",["T_WHITESPACE","\n\n    ",103],["T_DOC_COMMENT","\/**\n     * Execute action for given ids\n     *\n     * @param array|int $ids\n     * @return \\Magento\\Catalog\\Model\\Indexer\\Product\\Flat\\AbstractAction\n     *\/",105],["T_WHITESPACE","\n    ",110],["T_ABSTRACT","abstract",111],["T_WHITESPACE"," ",111],["T_PUBLIC","public",111],["T_WHITESPACE"," ",111],["T_FUNCTION","function",111],["T_WHITESPACE"," ",111],["T_STRING","execute",111],"(",["T_VARIABLE","$ids",111],")",";",["T_WHITESPACE","\n\n    ",111],["T_DOC_COMMENT","\/**\n     * Return temporary table name by regular table name\n     *\n     * @param string $tableName\n     * @return string\n     *\/",113],["T_WHITESPACE","\n    ",118],["T_PROTECTED","protected",119],["T_WHITESPACE"," ",119],["T_FUNCTION","function",119],["T_WHITESPACE"," ",119],["T_STRING","_getTemporaryTableName",119],"(",["T_VARIABLE","$tableName",119],")",["T_WHITESPACE","\n    ",119],"{",["T_WHITESPACE","\n        ",120],["T_RETURN","return",121],["T_WHITESPACE"," ",121],["T_STRING","sprintf",121],"(",["T_CONSTANT_ENCAPSED_STRING","'%s_tmp_indexer'",121],",",["T_WHITESPACE"," ",121],["T_VARIABLE","$tableName",121],")",";",["T_WHITESPACE","\n    ",121],"}",["T_WHITESPACE","\n\n    ",122],["T_DOC_COMMENT","\/**\n     * Drop temporary tables created by reindex process\n     *\n     * @param array $tablesList\n     * @param int|string $storeId\n     * @return void\n     * @SuppressWarnings(PHPMD.UnusedLocalVariable)\n     *\/",124],["T_WHITESPACE","\n    ",131],["T_PROTECTED","protected",132],["T_WHITESPACE"," ",132],["T_FUNCTION","function",132],["T_WHITESPACE"," ",132],["T_STRING","_cleanOnFailure",132],"(",["T_ARRAY","array",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$tablesList",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$storeId",132],")",["T_WHITESPACE","\n    ",132],"{",["T_WHITESPACE","\n        ",133],["T_FOREACH","foreach",134],["T_WHITESPACE"," ",134],"(",["T_VARIABLE","$tablesList",134],["T_WHITESPACE"," ",134],["T_AS","as",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$table",134],["T_WHITESPACE"," ",134],["T_DOUBLE_ARROW","=>",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$columns",134],")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n            ",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","_connection",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","dropTemporaryTable",135],"(",["T_VARIABLE","$table",135],")",";",["T_WHITESPACE","\n        ",135],"}",["T_WHITESPACE","\n        ",136],["T_VARIABLE","$tableName",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","_getTemporaryTableName",137],"(",["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","_productIndexerHelper",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","getFlatTableName",137],"(",["T_VARIABLE","$storeId",137],")",")",";",["T_WHITESPACE","\n        ",137],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","_connection",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","dropTable",138],"(",["T_VARIABLE","$tableName",138],")",";",["T_WHITESPACE","\n    ",138],"}",["T_WHITESPACE","\n\n    ",139],["T_DOC_COMMENT","\/**\n     * Rebuild catalog flat index from scratch\n     *\n     * @param int $storeId\n     * @param array $changedIds\n     * @return void\n     * @throws \\Exception\n     *\/",141],["T_WHITESPACE","\n    ",148],["T_PROTECTED","protected",149],["T_WHITESPACE"," ",149],["T_FUNCTION","function",149],["T_WHITESPACE"," ",149],["T_STRING","_reindex",149],"(",["T_VARIABLE","$storeId",149],",",["T_WHITESPACE"," ",149],["T_ARRAY","array",149],["T_WHITESPACE"," ",149],["T_VARIABLE","$changedIds",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],"[","]",")",["T_WHITESPACE","\n    ",149],"{",["T_WHITESPACE","\n        ",150],["T_TRY","try",151],["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n            ",151],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","_tableBuilder",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","build",152],"(",["T_VARIABLE","$storeId",152],",",["T_WHITESPACE"," ",152],["T_VARIABLE","$changedIds",152],",",["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","_valueFieldSuffix",152],")",";",["T_WHITESPACE","\n            ",152],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","_flatTableBuilder",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","build",153],"(",["T_WHITESPACE","\n                ",153],["T_VARIABLE","$storeId",154],",",["T_WHITESPACE","\n                ",154],["T_VARIABLE","$changedIds",155],",",["T_WHITESPACE","\n                ",155],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","_valueFieldSuffix",156],",",["T_WHITESPACE","\n                ",156],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","_tableDropSuffix",157],",",["T_WHITESPACE","\n                ",157],["T_STRING","true",158],["T_WHITESPACE","\n            ",158],")",";",["T_WHITESPACE","\n\n            ",159],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","_updateRelationProducts",161],"(",["T_VARIABLE","$storeId",161],",",["T_WHITESPACE"," ",161],["T_VARIABLE","$changedIds",161],")",";",["T_WHITESPACE","\n            ",161],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","_cleanRelationProducts",162],"(",["T_VARIABLE","$storeId",162],")",";",["T_WHITESPACE","\n        ",162],"}",["T_WHITESPACE"," ",163],["T_CATCH","catch",163],["T_WHITESPACE"," ",163],"(",["T_NS_SEPARATOR","\\",163],["T_STRING","Exception",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$e",163],")",["T_WHITESPACE"," ",163],"{",["T_WHITESPACE","\n            ",163],["T_VARIABLE","$attributes",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","_productIndexerHelper",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","getAttributes",164],"(",")",";",["T_WHITESPACE","\n            ",164],["T_VARIABLE","$eavAttributes",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","_productIndexerHelper",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","getTablesStructure",165],"(",["T_VARIABLE","$attributes",165],")",";",["T_WHITESPACE","\n            ",165],["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","_cleanOnFailure",166],"(",["T_VARIABLE","$eavAttributes",166],",",["T_WHITESPACE"," ",166],["T_VARIABLE","$storeId",166],")",";",["T_WHITESPACE","\n            ",166],["T_THROW","throw",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$e",167],";",["T_WHITESPACE","\n        ",167],"}",["T_WHITESPACE","\n    ",168],"}",["T_WHITESPACE","\n\n    ",169],["T_DOC_COMMENT","\/**\n     * Retrieve Product Type Instances\n     * as key - type code, value - instance model\n     *\n     * @return array\n     *\/",171],["T_WHITESPACE","\n    ",176],["T_PROTECTED","protected",177],["T_WHITESPACE"," ",177],["T_FUNCTION","function",177],["T_WHITESPACE"," ",177],["T_STRING","_getProductTypeInstances",177],"(",")",["T_WHITESPACE","\n    ",177],"{",["T_WHITESPACE","\n        ",178],["T_IF","if",179],["T_WHITESPACE"," ",179],"(",["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","_productTypes",179],["T_WHITESPACE"," ",179],["T_IS_IDENTICAL","===",179],["T_WHITESPACE"," ",179],["T_STRING","null",179],")",["T_WHITESPACE"," ",179],"{",["T_WHITESPACE","\n            ",179],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","_productTypes",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],"[","]",";",["T_WHITESPACE","\n            ",180],["T_VARIABLE","$productEmulator",181],["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_NEW","new",181],["T_WHITESPACE"," ",181],["T_NS_SEPARATOR","\\",181],["T_STRING","Magento",181],["T_NS_SEPARATOR","\\",181],["T_STRING","Framework",181],["T_NS_SEPARATOR","\\",181],["T_STRING","DataObject",181],"(",")",";",["T_WHITESPACE","\n            ",181],["T_FOREACH","foreach",182],["T_WHITESPACE"," ",182],"(",["T_STRING","array_keys",182],"(",["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","_productType",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","getTypes",182],"(",")",")",["T_WHITESPACE"," ",182],["T_AS","as",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$typeId",182],")",["T_WHITESPACE"," ",182],"{",["T_WHITESPACE","\n                ",182],["T_VARIABLE","$productEmulator",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","setTypeId",183],"(",["T_VARIABLE","$typeId",183],")",";",["T_WHITESPACE","\n                ",183],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","_productTypes",184],"[",["T_VARIABLE","$typeId",184],"]",["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","_productType",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","factory",184],"(",["T_VARIABLE","$productEmulator",184],")",";",["T_WHITESPACE","\n            ",184],"}",["T_WHITESPACE","\n        ",185],"}",["T_WHITESPACE","\n        ",186],["T_RETURN","return",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","_productTypes",187],";",["T_WHITESPACE","\n    ",187],"}",["T_WHITESPACE","\n\n    ",188],["T_DOC_COMMENT","\/**\n     * Update relation products\n     *\n     * @param int $storeId\n     * @param int|array $productIds Update child product(s) only\n     * @return \\Magento\\Catalog\\Model\\Indexer\\Product\\Flat\\AbstractAction\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     *\/",190],["T_WHITESPACE","\n    ",197],["T_PROTECTED","protected",198],["T_WHITESPACE"," ",198],["T_FUNCTION","function",198],["T_WHITESPACE"," ",198],["T_STRING","_updateRelationProducts",198],"(",["T_VARIABLE","$storeId",198],",",["T_WHITESPACE"," ",198],["T_VARIABLE","$productIds",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_STRING","null",198],")",["T_WHITESPACE","\n    ",198],"{",["T_WHITESPACE","\n        ",199],["T_IF","if",200],["T_WHITESPACE"," ",200],"(","!",["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","_productIndexerHelper",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","isAddChildData",200],"(",")",["T_WHITESPACE"," ",200],["T_BOOLEAN_OR","||",200],["T_WHITESPACE"," ",200],"!",["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","_isFlatTableExists",200],"(",["T_VARIABLE","$storeId",200],")",")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n            ",200],["T_RETURN","return",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$this",201],";",["T_WHITESPACE","\n        ",201],"}",["T_WHITESPACE","\n\n        ",202],["T_VARIABLE","$metadata",204],["T_WHITESPACE"," ",204],"=",["T_WHITESPACE"," ",204],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","getMetadataPool",204],"(",")",["T_OBJECT_OPERATOR","->",204],["T_STRING","getMetadata",204],"(",["T_STRING","ProductInterface",204],["T_DOUBLE_COLON","::",204],["T_CLASS","class",204],")",";",["T_WHITESPACE","\n\n        ",204],["T_FOREACH","foreach",206],["T_WHITESPACE"," ",206],"(",["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","_getProductTypeInstances",206],"(",")",["T_WHITESPACE"," ",206],["T_AS","as",206],["T_WHITESPACE"," ",206],["T_VARIABLE","$typeInstance",206],")",["T_WHITESPACE"," ",206],"{",["T_WHITESPACE","\n            ",206],["T_DOC_COMMENT","\/** @var $typeInstance \\Magento\\Catalog\\Model\\Product\\Type\\AbstractType *\/",207],["T_WHITESPACE","\n            ",207],["T_IF","if",208],["T_WHITESPACE"," ",208],"(","!",["T_VARIABLE","$typeInstance",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","isComposite",208],"(",["T_STRING","null",208],")",")",["T_WHITESPACE"," ",208],"{",["T_WHITESPACE","\n                ",208],["T_CONTINUE","continue",209],";",["T_WHITESPACE","\n            ",209],"}",["T_WHITESPACE","\n            ",210],["T_VARIABLE","$relation",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_VARIABLE","$typeInstance",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","getRelationInfo",211],"(",")",";",["T_WHITESPACE","\n            ",211],["T_IF","if",212],["T_WHITESPACE"," ",212],"(",["T_VARIABLE","$relation",212],["T_WHITESPACE"," ",212],["T_BOOLEAN_AND","&&",212],["T_WHITESPACE"," ",212],["T_VARIABLE","$relation",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","getTable",212],"(",")",["T_WHITESPACE"," ",212],["T_BOOLEAN_AND","&&",212],["T_WHITESPACE"," ",212],["T_VARIABLE","$relation",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","getParentFieldName",212],"(",")",["T_WHITESPACE"," ",212],["T_BOOLEAN_AND","&&",212],["T_WHITESPACE"," ",212],["T_VARIABLE","$relation",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","getChildFieldName",212],"(",")",["T_WHITESPACE","\n            ",212],")",["T_WHITESPACE"," ",213],"{",["T_WHITESPACE","\n                ",213],["T_VARIABLE","$columns",214],["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","_productIndexerHelper",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","getFlatColumns",214],"(",")",";",["T_WHITESPACE","\n                ",214],["T_VARIABLE","$fieldList",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_STRING","array_keys",215],"(",["T_VARIABLE","$columns",215],")",";",["T_WHITESPACE","\n                ",215],["T_UNSET","unset",216],"(",["T_VARIABLE","$columns",216],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",216],"]",")",";",["T_WHITESPACE","\n                ",216],["T_UNSET","unset",217],"(",["T_VARIABLE","$columns",217],"[",["T_CONSTANT_ENCAPSED_STRING","'child_id'",217],"]",")",";",["T_WHITESPACE","\n                ",217],["T_UNSET","unset",218],"(",["T_VARIABLE","$columns",218],"[",["T_CONSTANT_ENCAPSED_STRING","'is_child'",218],"]",")",";",["T_WHITESPACE","\n                ",218],["T_DOC_COMMENT","\/** @var $select \\Magento\\Framework\\DB\\Select *\/",219],["T_WHITESPACE","\n                ",219],["T_VARIABLE","$select",220],["T_WHITESPACE"," ",220],"=",["T_WHITESPACE"," ",220],["T_VARIABLE","$this",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","_connection",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","select",220],"(",")",["T_OBJECT_OPERATOR","->",220],["T_STRING","from",220],"(",["T_WHITESPACE","\n                    ",220],"[",["T_CONSTANT_ENCAPSED_STRING","'t'",221],["T_WHITESPACE"," ",221],["T_DOUBLE_ARROW","=>",221],["T_WHITESPACE"," ",221],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","_productIndexerHelper",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","getTable",221],"(",["T_VARIABLE","$relation",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","getTable",221],"(",")",")","]",",",["T_WHITESPACE","\n                    ",221],"[",["T_VARIABLE","$relation",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","getChildFieldName",222],"(",")",",",["T_WHITESPACE"," ",222],["T_NEW","new",222],["T_WHITESPACE"," ",222],["T_NS_SEPARATOR","\\",222],["T_STRING","Zend_Db_Expr",222],"(",["T_CONSTANT_ENCAPSED_STRING","'1'",222],")","]",["T_WHITESPACE","\n                ",222],")",["T_OBJECT_OPERATOR","->",223],["T_STRING","join",223],"(",["T_WHITESPACE","\n                    ",223],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_table'",224],["T_WHITESPACE"," ",224],["T_DOUBLE_ARROW","=>",224],["T_WHITESPACE"," ",224],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","_connection",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","getTableName",224],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity'",224],")","]",",",["T_WHITESPACE","\n                    ",224],["T_CONSTANT_ENCAPSED_STRING","'entity_table.'",225],["T_WHITESPACE"," ",225],".",["T_WHITESPACE"," ",225],["T_VARIABLE","$metadata",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","getLinkField",225],"(",")",["T_WHITESPACE"," ",225],".",["T_WHITESPACE"," ",225],["T_CONSTANT_ENCAPSED_STRING","'t.'",225],["T_WHITESPACE"," ",225],".",["T_WHITESPACE"," ",225],["T_VARIABLE","$relation",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","getParentFieldName",225],"(",")",",",["T_WHITESPACE","\n                    ",225],"[",["T_VARIABLE","$relation",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","getParentFieldName",226],"(",")",["T_WHITESPACE"," ",226],["T_DOUBLE_ARROW","=>",226],["T_WHITESPACE"," ",226],["T_CONSTANT_ENCAPSED_STRING","'entity_table.entity_id'",226],"]",["T_WHITESPACE","\n                ",226],")",["T_OBJECT_OPERATOR","->",227],["T_STRING","join",227],"(",["T_WHITESPACE","\n                    ",227],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",228],["T_WHITESPACE"," ",228],["T_DOUBLE_ARROW","=>",228],["T_WHITESPACE"," ",228],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","_productIndexerHelper",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getFlatTableName",228],"(",["T_VARIABLE","$storeId",228],")","]",",",["T_WHITESPACE","\n                    ",228],"\"",["T_ENCAPSED_AND_WHITESPACE","e.entity_id = t.",229],["T_CURLY_OPEN","{",229],["T_VARIABLE","$relation",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","getChildFieldName",229],"(",")","}","\"",",",["T_WHITESPACE","\n                    ",229],["T_STRING","array_keys",230],"(",["T_VARIABLE","$columns",230],")",["T_WHITESPACE","\n                ",230],")",";",["T_WHITESPACE","\n                ",231],["T_IF","if",232],["T_WHITESPACE"," ",232],"(",["T_VARIABLE","$relation",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","getWhere",232],"(",")",["T_WHITESPACE"," ",232],["T_IS_NOT_IDENTICAL","!==",232],["T_WHITESPACE"," ",232],["T_STRING","null",232],")",["T_WHITESPACE"," ",232],"{",["T_WHITESPACE","\n                    ",232],["T_VARIABLE","$select",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","where",233],"(",["T_VARIABLE","$relation",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","getWhere",233],"(",")",")",";",["T_WHITESPACE","\n                ",233],"}",["T_WHITESPACE","\n                ",234],["T_IF","if",235],["T_WHITESPACE"," ",235],"(",["T_VARIABLE","$productIds",235],["T_WHITESPACE"," ",235],["T_IS_NOT_IDENTICAL","!==",235],["T_WHITESPACE"," ",235],["T_STRING","null",235],")",["T_WHITESPACE"," ",235],"{",["T_WHITESPACE","\n                    ",235],["T_VARIABLE","$cond",236],["T_WHITESPACE"," ",236],"=",["T_WHITESPACE"," ",236],"[",["T_WHITESPACE","\n                        ",236],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","_connection",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","quoteInto",237],"(","\"",["T_CURLY_OPEN","{",237],["T_VARIABLE","$relation",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","getChildFieldName",237],"(",")","}",["T_ENCAPSED_AND_WHITESPACE"," IN(?)",237],"\"",",",["T_WHITESPACE"," ",237],["T_VARIABLE","$productIds",237],")",",",["T_WHITESPACE","\n                        ",237],["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","_connection",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","quoteInto",238],"(",["T_CONSTANT_ENCAPSED_STRING","\"entity_table.entity_id IN(?)\"",238],",",["T_WHITESPACE"," ",238],["T_VARIABLE","$productIds",238],")",",",["T_WHITESPACE","\n                    ",238],"]",";",["T_WHITESPACE","\n\n                    ",239],["T_VARIABLE","$select",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","where",241],"(",["T_STRING","implode",241],"(",["T_CONSTANT_ENCAPSED_STRING","' OR '",241],",",["T_WHITESPACE"," ",241],["T_VARIABLE","$cond",241],")",")",";",["T_WHITESPACE","\n                ",241],"}",["T_WHITESPACE","\n                ",242],["T_VARIABLE","$sql",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_VARIABLE","$select",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","insertFromSelect",243],"(",["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","_productIndexerHelper",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","getFlatTableName",243],"(",["T_VARIABLE","$storeId",243],")",",",["T_WHITESPACE"," ",243],["T_VARIABLE","$fieldList",243],")",";",["T_WHITESPACE","\n                ",243],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","_connection",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","query",244],"(",["T_VARIABLE","$sql",244],")",";",["T_WHITESPACE","\n            ",244],"}",["T_WHITESPACE","\n        ",245],"}",["T_WHITESPACE","\n\n        ",246],["T_RETURN","return",248],["T_WHITESPACE"," ",248],["T_VARIABLE","$this",248],";",["T_WHITESPACE","\n    ",248],"}",["T_WHITESPACE","\n\n    ",249],["T_DOC_COMMENT","\/**\n     * Clean unused relation products\n     *\n     * @param int $storeId\n     * @return \\Magento\\Catalog\\Model\\Indexer\\Product\\Flat\\AbstractAction\n     *\/",251],["T_WHITESPACE","\n    ",256],["T_PROTECTED","protected",257],["T_WHITESPACE"," ",257],["T_FUNCTION","function",257],["T_WHITESPACE"," ",257],["T_STRING","_cleanRelationProducts",257],"(",["T_VARIABLE","$storeId",257],")",["T_WHITESPACE","\n    ",257],"{",["T_WHITESPACE","\n        ",258],["T_IF","if",259],["T_WHITESPACE"," ",259],"(","!",["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","_productIndexerHelper",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","isAddChildData",259],"(",")",")",["T_WHITESPACE"," ",259],"{",["T_WHITESPACE","\n            ",259],["T_RETURN","return",260],["T_WHITESPACE"," ",260],["T_VARIABLE","$this",260],";",["T_WHITESPACE","\n        ",260],"}",["T_WHITESPACE","\n\n        ",261],["T_VARIABLE","$metadata",263],["T_WHITESPACE"," ",263],"=",["T_WHITESPACE"," ",263],["T_VARIABLE","$this",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","getMetadataPool",263],"(",")",["T_OBJECT_OPERATOR","->",263],["T_STRING","getMetadata",263],"(",["T_STRING","ProductInterface",263],["T_DOUBLE_COLON","::",263],["T_CLASS","class",263],")",";",["T_WHITESPACE","\n\n        ",263],["T_FOREACH","foreach",265],["T_WHITESPACE"," ",265],"(",["T_VARIABLE","$this",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","_getProductTypeInstances",265],"(",")",["T_WHITESPACE"," ",265],["T_AS","as",265],["T_WHITESPACE"," ",265],["T_VARIABLE","$typeInstance",265],")",["T_WHITESPACE"," ",265],"{",["T_WHITESPACE","\n            ",265],["T_DOC_COMMENT","\/** @var $typeInstance \\Magento\\Catalog\\Model\\Product\\Type\\AbstractType *\/",266],["T_WHITESPACE","\n            ",266],["T_IF","if",267],["T_WHITESPACE"," ",267],"(","!",["T_VARIABLE","$typeInstance",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","isComposite",267],"(",["T_STRING","null",267],")",")",["T_WHITESPACE"," ",267],"{",["T_WHITESPACE","\n                ",267],["T_CONTINUE","continue",268],";",["T_WHITESPACE","\n            ",268],"}",["T_WHITESPACE","\n            ",269],["T_VARIABLE","$relation",270],["T_WHITESPACE"," ",270],"=",["T_WHITESPACE"," ",270],["T_VARIABLE","$typeInstance",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","getRelationInfo",270],"(",")",";",["T_WHITESPACE","\n            ",270],["T_IF","if",271],["T_WHITESPACE"," ",271],"(",["T_VARIABLE","$relation",271],["T_WHITESPACE"," ",271],["T_BOOLEAN_AND","&&",271],["T_WHITESPACE"," ",271],["T_VARIABLE","$relation",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","getTable",271],"(",")",["T_WHITESPACE"," ",271],["T_BOOLEAN_AND","&&",271],["T_WHITESPACE"," ",271],["T_VARIABLE","$relation",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","getParentFieldName",271],"(",")",["T_WHITESPACE"," ",271],["T_BOOLEAN_AND","&&",271],["T_WHITESPACE"," ",271],["T_VARIABLE","$relation",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","getChildFieldName",271],"(",")",["T_WHITESPACE","\n            ",271],")",["T_WHITESPACE"," ",272],"{",["T_WHITESPACE","\n                ",272],["T_VARIABLE","$select",273],["T_WHITESPACE"," ",273],"=",["T_WHITESPACE"," ",273],["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","_connection",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","select",273],"(",")",["T_OBJECT_OPERATOR","->",273],["T_STRING","distinct",273],"(",["T_WHITESPACE","\n                    ",273],["T_STRING","true",274],["T_WHITESPACE","\n                ",274],")",["T_OBJECT_OPERATOR","->",275],["T_STRING","from",275],"(",["T_WHITESPACE","\n                    ",275],"[",["T_CONSTANT_ENCAPSED_STRING","'t'",276],["T_WHITESPACE"," ",276],["T_DOUBLE_ARROW","=>",276],["T_WHITESPACE"," ",276],["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","_productIndexerHelper",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","getTable",276],"(",["T_VARIABLE","$relation",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","getTable",276],"(",")",")","]",",",["T_WHITESPACE","\n                    ",276],"[","]",["T_WHITESPACE","\n                ",277],")",["T_OBJECT_OPERATOR","->",278],["T_STRING","join",278],"(",["T_WHITESPACE","\n                    ",278],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_table'",279],["T_WHITESPACE"," ",279],["T_DOUBLE_ARROW","=>",279],["T_WHITESPACE"," ",279],["T_VARIABLE","$this",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","_connection",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","getTableName",279],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity'",279],")","]",",",["T_WHITESPACE","\n                    ",279],["T_CONSTANT_ENCAPSED_STRING","'entity_table.'",280],["T_WHITESPACE"," ",280],".",["T_WHITESPACE"," ",280],["T_VARIABLE","$metadata",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","getLinkField",280],"(",")",["T_WHITESPACE"," ",280],".",["T_WHITESPACE"," ",280],["T_CONSTANT_ENCAPSED_STRING","'t.'",280],["T_WHITESPACE"," ",280],".",["T_WHITESPACE"," ",280],["T_VARIABLE","$relation",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","getParentFieldName",280],"(",")",",",["T_WHITESPACE","\n                    ",280],"[",["T_VARIABLE","$relation",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","getParentFieldName",281],"(",")",["T_WHITESPACE"," ",281],["T_DOUBLE_ARROW","=>",281],["T_WHITESPACE"," ",281],["T_CONSTANT_ENCAPSED_STRING","'entity_table.entity_id'",281],"]",["T_WHITESPACE","\n                ",281],")",";",["T_WHITESPACE","\n                ",282],["T_VARIABLE","$joinLeftCond",283],["T_WHITESPACE"," ",283],"=",["T_WHITESPACE"," ",283],"[",["T_WHITESPACE","\n                    ",283],["T_CONSTANT_ENCAPSED_STRING","\"e.entity_id = entity_table.entity_id\"",284],",",["T_WHITESPACE","\n                    ",284],"\"",["T_ENCAPSED_AND_WHITESPACE","e.child_id = t.",285],["T_CURLY_OPEN","{",285],["T_VARIABLE","$relation",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","getChildFieldName",285],"(",")","}","\"",",",["T_WHITESPACE","\n                ",285],"]",";",["T_WHITESPACE","\n                ",286],["T_IF","if",287],["T_WHITESPACE"," ",287],"(",["T_VARIABLE","$relation",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","getWhere",287],"(",")",["T_WHITESPACE"," ",287],["T_IS_NOT_IDENTICAL","!==",287],["T_WHITESPACE"," ",287],["T_STRING","null",287],")",["T_WHITESPACE"," ",287],"{",["T_WHITESPACE","\n                    ",287],["T_VARIABLE","$select",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","where",288],"(",["T_VARIABLE","$relation",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","getWhere",288],"(",")",")",";",["T_WHITESPACE","\n                    ",288],["T_VARIABLE","$joinLeftCond",289],"[","]",["T_WHITESPACE"," ",289],"=",["T_WHITESPACE"," ",289],["T_VARIABLE","$relation",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","getWhere",289],"(",")",";",["T_WHITESPACE","\n                ",289],"}",["T_WHITESPACE","\n\n                ",290],["T_VARIABLE","$entitySelect",292],["T_WHITESPACE"," ",292],"=",["T_WHITESPACE"," ",292],["T_NEW","new",292],["T_WHITESPACE"," ",292],["T_NS_SEPARATOR","\\",292],["T_STRING","Zend_Db_Expr",292],"(",["T_VARIABLE","$select",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","__toString",292],"(",")",")",";",["T_WHITESPACE","\n                ",292],["T_DOC_COMMENT","\/** @var $select \\Magento\\Framework\\DB\\Select *\/",293],["T_WHITESPACE","\n                ",293],["T_VARIABLE","$select",294],["T_WHITESPACE"," ",294],"=",["T_WHITESPACE"," ",294],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","_connection",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","select",294],"(",")",["T_OBJECT_OPERATOR","->",294],["T_STRING","from",294],"(",["T_WHITESPACE","\n                    ",294],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",295],["T_WHITESPACE"," ",295],["T_DOUBLE_ARROW","=>",295],["T_WHITESPACE"," ",295],["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","_productIndexerHelper",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","getFlatTableName",295],"(",["T_VARIABLE","$storeId",295],")","]",",",["T_WHITESPACE","\n                    ",295],["T_STRING","null",296],["T_WHITESPACE","\n                ",296],")",["T_OBJECT_OPERATOR","->",297],["T_STRING","joinLeft",297],"(",["T_WHITESPACE","\n                    ",297],"[",["T_CONSTANT_ENCAPSED_STRING","'t'",298],["T_WHITESPACE"," ",298],["T_DOUBLE_ARROW","=>",298],["T_WHITESPACE"," ",298],["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","_productIndexerHelper",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","getTable",298],"(",["T_VARIABLE","$relation",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","getTable",298],"(",")",")","]",",",["T_WHITESPACE","\n                    ",298],["T_STRING","implode",299],"(",["T_CONSTANT_ENCAPSED_STRING","' AND '",299],",",["T_WHITESPACE"," ",299],["T_VARIABLE","$joinLeftCond",299],")",",",["T_WHITESPACE","\n                    ",299],"[","]",["T_WHITESPACE","\n                ",300],")",["T_OBJECT_OPERATOR","->",301],["T_STRING","where",301],"(",["T_WHITESPACE","\n                    ",301],["T_CONSTANT_ENCAPSED_STRING","'e.is_child = ?'",302],",",["T_WHITESPACE","\n                    ",302],["T_LNUMBER","1",303],["T_WHITESPACE","\n                ",303],")",["T_OBJECT_OPERATOR","->",304],["T_STRING","where",304],"(",["T_WHITESPACE","\n                    ",304],["T_CONSTANT_ENCAPSED_STRING","'e.entity_id IN(?)'",305],",",["T_WHITESPACE","\n                    ",305],["T_VARIABLE","$entitySelect",306],["T_WHITESPACE","\n                ",306],")",["T_OBJECT_OPERATOR","->",307],["T_STRING","where",307],"(",["T_WHITESPACE","\n                    ",307],"\"",["T_ENCAPSED_AND_WHITESPACE","t.",308],["T_CURLY_OPEN","{",308],["T_VARIABLE","$relation",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","getChildFieldName",308],"(",")","}",["T_ENCAPSED_AND_WHITESPACE"," IS NULL",308],"\"",["T_WHITESPACE","\n                ",308],")",";",["T_WHITESPACE","\n\n                ",309],["T_VARIABLE","$sql",311],["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],["T_VARIABLE","$select",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","deleteFromSelect",311],"(",["T_CONSTANT_ENCAPSED_STRING","'e'",311],")",";",["T_WHITESPACE","\n                ",311],["T_VARIABLE","$this",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","_connection",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","query",312],"(",["T_VARIABLE","$sql",312],")",";",["T_WHITESPACE","\n            ",312],"}",["T_WHITESPACE","\n        ",313],"}",["T_WHITESPACE","\n\n        ",314],["T_RETURN","return",316],["T_WHITESPACE"," ",316],["T_VARIABLE","$this",316],";",["T_WHITESPACE","\n    ",316],"}",["T_WHITESPACE","\n\n    ",317],["T_DOC_COMMENT","\/**\n     * Check is flat table for store exists\n     *\n     * @param int $storeId\n     * @return bool\n     *\/",319],["T_WHITESPACE","\n    ",324],["T_PROTECTED","protected",325],["T_WHITESPACE"," ",325],["T_FUNCTION","function",325],["T_WHITESPACE"," ",325],["T_STRING","_isFlatTableExists",325],"(",["T_VARIABLE","$storeId",325],")",["T_WHITESPACE","\n    ",325],"{",["T_WHITESPACE","\n        ",326],["T_IF","if",327],["T_WHITESPACE"," ",327],"(","!",["T_ISSET","isset",327],"(",["T_VARIABLE","$this",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","_flatTablesExist",327],"[",["T_VARIABLE","$storeId",327],"]",")",")",["T_WHITESPACE"," ",327],"{",["T_WHITESPACE","\n            ",327],["T_VARIABLE","$tableName",328],["T_WHITESPACE"," ",328],"=",["T_WHITESPACE"," ",328],["T_VARIABLE","$this",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","_productIndexerHelper",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","getFlatTableName",328],"(",["T_VARIABLE","$storeId",328],")",";",["T_WHITESPACE","\n            ",328],["T_VARIABLE","$isTableExists",329],["T_WHITESPACE"," ",329],"=",["T_WHITESPACE"," ",329],["T_VARIABLE","$this",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","_connection",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","isTableExists",329],"(",["T_VARIABLE","$tableName",329],")",";",["T_WHITESPACE","\n\n            ",329],["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","_flatTablesExist",331],"[",["T_VARIABLE","$storeId",331],"]",["T_WHITESPACE"," ",331],"=",["T_WHITESPACE"," ",331],["T_VARIABLE","$isTableExists",331],["T_WHITESPACE"," ",331],"?",["T_WHITESPACE"," ",331],["T_STRING","true",331],["T_WHITESPACE"," ",331],":",["T_WHITESPACE"," ",331],["T_STRING","false",331],";",["T_WHITESPACE","\n        ",331],"}",["T_WHITESPACE","\n\n        ",332],["T_RETURN","return",334],["T_WHITESPACE"," ",334],["T_VARIABLE","$this",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","_flatTablesExist",334],"[",["T_VARIABLE","$storeId",334],"]",";",["T_WHITESPACE","\n    ",334],"}",["T_WHITESPACE","\n\n    ",335],["T_DOC_COMMENT","\/**\n     * @return \\Magento\\Framework\\EntityManager\\MetadataPool\n     *\/",337],["T_WHITESPACE","\n    ",339],["T_PRIVATE","private",340],["T_WHITESPACE"," ",340],["T_FUNCTION","function",340],["T_WHITESPACE"," ",340],["T_STRING","getMetadataPool",340],"(",")",["T_WHITESPACE","\n    ",340],"{",["T_WHITESPACE","\n        ",341],["T_IF","if",342],["T_WHITESPACE"," ",342],"(",["T_STRING","null",342],["T_WHITESPACE"," ",342],["T_IS_IDENTICAL","===",342],["T_WHITESPACE"," ",342],["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","metadataPool",342],")",["T_WHITESPACE"," ",342],"{",["T_WHITESPACE","\n            ",342],["T_VARIABLE","$this",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","metadataPool",343],["T_WHITESPACE"," ",343],"=",["T_WHITESPACE"," ",343],["T_NS_SEPARATOR","\\",343],["T_STRING","Magento",343],["T_NS_SEPARATOR","\\",343],["T_STRING","Framework",343],["T_NS_SEPARATOR","\\",343],["T_STRING","App",343],["T_NS_SEPARATOR","\\",343],["T_STRING","ObjectManager",343],["T_DOUBLE_COLON","::",343],["T_STRING","getInstance",343],"(",")",["T_WHITESPACE","\n                ",343],["T_OBJECT_OPERATOR","->",344],["T_STRING","get",344],"(",["T_NS_SEPARATOR","\\",344],["T_STRING","Magento",344],["T_NS_SEPARATOR","\\",344],["T_STRING","Framework",344],["T_NS_SEPARATOR","\\",344],["T_STRING","EntityManager",344],["T_NS_SEPARATOR","\\",344],["T_STRING","MetadataPool",344],["T_DOUBLE_COLON","::",344],["T_CLASS","class",344],")",";",["T_WHITESPACE","\n        ",344],"}",["T_WHITESPACE","\n        ",345],["T_RETURN","return",346],["T_WHITESPACE"," ",346],["T_VARIABLE","$this",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","metadataPool",346],";",["T_WHITESPACE","\n    ",346],"}",["T_WHITESPACE","\n",347],"}",["T_WHITESPACE","\n",348]]