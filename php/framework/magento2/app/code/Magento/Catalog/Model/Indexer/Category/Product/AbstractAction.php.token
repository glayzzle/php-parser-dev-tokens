[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_COMMENT","\/\/ @codingStandardsIgnoreFile\n",7],["T_WHITESPACE","\n",8],["T_NAMESPACE","namespace",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Catalog",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Model",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Indexer",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Category",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Product",9],";",["T_WHITESPACE","\n\n",9],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Framework",11],["T_NS_SEPARATOR","\\",11],["T_STRING","App",11],["T_NS_SEPARATOR","\\",11],["T_STRING","ResourceConnection",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Framework",12],["T_NS_SEPARATOR","\\",12],["T_STRING","EntityManager",12],["T_NS_SEPARATOR","\\",12],["T_STRING","MetadataPool",12],";",["T_WHITESPACE","\n\n",12],["T_DOC_COMMENT","\/**\n * Class AbstractAction\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",14],["T_WHITESPACE","\n",17],["T_ABSTRACT","abstract",18],["T_WHITESPACE"," ",18],["T_CLASS","class",18],["T_WHITESPACE"," ",18],["T_STRING","AbstractAction",18],["T_WHITESPACE","\n",18],"{",["T_WHITESPACE","\n    ",19],["T_DOC_COMMENT","\/**\n     * Chunk size\n     *\/",20],["T_WHITESPACE","\n    ",22],["T_CONST","const",23],["T_WHITESPACE"," ",23],["T_STRING","RANGE_CATEGORY_STEP",23],["T_WHITESPACE"," ",23],"=",["T_WHITESPACE"," ",23],["T_LNUMBER","500",23],";",["T_WHITESPACE","\n\n    ",23],["T_DOC_COMMENT","\/**\n     * Chunk size for product\n     *\/",25],["T_WHITESPACE","\n    ",27],["T_CONST","const",28],["T_WHITESPACE"," ",28],["T_STRING","RANGE_PRODUCT_STEP",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_LNUMBER","1000000",28],";",["T_WHITESPACE","\n\n    ",28],["T_DOC_COMMENT","\/**\n     * Catalog category index table name\n     *\/",30],["T_WHITESPACE","\n    ",32],["T_CONST","const",33],["T_WHITESPACE"," ",33],["T_STRING","MAIN_INDEX_TABLE",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'catalog_category_product_index'",33],";",["T_WHITESPACE","\n\n    ",33],["T_DOC_COMMENT","\/**\n     * Suffix for table to show it is temporary\n     *\/",35],["T_WHITESPACE","\n    ",37],["T_CONST","const",38],["T_WHITESPACE"," ",38],["T_STRING","TEMPORARY_TABLE_SUFFIX",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_CONSTANT_ENCAPSED_STRING","'_tmp'",38],";",["T_WHITESPACE","\n\n    ",38],["T_DOC_COMMENT","\/**\n     * Cached non anchor categories select by store id\n     *\n     * @var \\Magento\\Framework\\DB\\Select[]\n     *\/",40],["T_WHITESPACE","\n    ",44],["T_PROTECTED","protected",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$nonAnchorSelects",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],"[","]",";",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * Cached anchor categories select by store id\n     *\n     * @var \\Magento\\Framework\\DB\\Select[]\n     *\/",47],["T_WHITESPACE","\n    ",51],["T_PROTECTED","protected",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$anchorSelects",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],"[","]",";",["T_WHITESPACE","\n\n    ",52],["T_DOC_COMMENT","\/**\n     * Cached all product select by store id\n     *\n     * @var \\Magento\\Framework\\DB\\Select[]\n     *\/",54],["T_WHITESPACE","\n    ",58],["T_PROTECTED","protected",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$productsSelects",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],"[","]",";",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * Category path by id\n     *\n     * @var string[]\n     *\/",61],["T_WHITESPACE","\n    ",65],["T_PROTECTED","protected",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$categoryPath",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],"[","]",";",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\App\\ResourceConnection\n     *\/",68],["T_WHITESPACE","\n    ",70],["T_PROTECTED","protected",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$resource",71],";",["T_WHITESPACE","\n\n    ",71],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Store\\Model\\StoreManagerInterface\n     *\/",73],["T_WHITESPACE","\n    ",75],["T_PROTECTED","protected",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$storeManager",76],";",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Catalog\\Model\\Config\n     *\/",78],["T_WHITESPACE","\n    ",80],["T_PROTECTED","protected",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$config",81],";",["T_WHITESPACE","\n\n    ",81],["T_DOC_COMMENT","\/**\n     * Whether to use main or temporary index table\n     *\n     * @var bool\n     *\/",83],["T_WHITESPACE","\n    ",87],["T_PROTECTED","protected",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$useTempTable",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_STRING","true",88],";",["T_WHITESPACE","\n\n    ",88],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\DB\\Adapter\\AdapterInterface\n     *\/",90],["T_WHITESPACE","\n    ",92],["T_PROTECTED","protected",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$connection",93],";",["T_WHITESPACE","\n\n    ",93],["T_DOC_COMMENT","\/**\n     * @var MetadataPool\n     *\/",95],["T_WHITESPACE","\n    ",97],["T_PROTECTED","protected",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$metadataPool",98],";",["T_WHITESPACE","\n\n    ",98],["T_DOC_COMMENT","\/**\n     * @var string\n     *\/",100],["T_WHITESPACE","\n    ",102],["T_PROTECTED","protected",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$tempTreeIndexTableName",103],";",["T_WHITESPACE","\n\n    ",103],["T_DOC_COMMENT","\/**\n     * @param ResourceConnection $resource\n     * @param \\Magento\\Store\\Model\\StoreManagerInterface $storeManager\n     * @param \\Magento\\Catalog\\Model\\Config $config\n     *\/",105],["T_WHITESPACE","\n    ",109],["T_PUBLIC","public",110],["T_WHITESPACE"," ",110],["T_FUNCTION","function",110],["T_WHITESPACE"," ",110],["T_STRING","__construct",110],"(",["T_WHITESPACE","\n        ",110],["T_NS_SEPARATOR","\\",111],["T_STRING","Magento",111],["T_NS_SEPARATOR","\\",111],["T_STRING","Framework",111],["T_NS_SEPARATOR","\\",111],["T_STRING","App",111],["T_NS_SEPARATOR","\\",111],["T_STRING","ResourceConnection",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$resource",111],",",["T_WHITESPACE","\n        ",111],["T_NS_SEPARATOR","\\",112],["T_STRING","Magento",112],["T_NS_SEPARATOR","\\",112],["T_STRING","Store",112],["T_NS_SEPARATOR","\\",112],["T_STRING","Model",112],["T_NS_SEPARATOR","\\",112],["T_STRING","StoreManagerInterface",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$storeManager",112],",",["T_WHITESPACE","\n        ",112],["T_NS_SEPARATOR","\\",113],["T_STRING","Magento",113],["T_NS_SEPARATOR","\\",113],["T_STRING","Catalog",113],["T_NS_SEPARATOR","\\",113],["T_STRING","Model",113],["T_NS_SEPARATOR","\\",113],["T_STRING","Config",113],["T_WHITESPACE"," ",113],["T_VARIABLE","$config",113],["T_WHITESPACE","\n    ",113],")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n        ",114],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","resource",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$resource",115],";",["T_WHITESPACE","\n        ",115],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","connection",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_VARIABLE","$resource",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getConnection",116],"(",")",";",["T_WHITESPACE","\n        ",116],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","storeManager",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_VARIABLE","$storeManager",117],";",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","config",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$config",118],";",["T_WHITESPACE","\n    ",118],"}",["T_WHITESPACE","\n\n    ",119],["T_DOC_COMMENT","\/**\n     * Run full reindex\n     *\n     * @return $this\n     *\/",121],["T_WHITESPACE","\n    ",125],["T_ABSTRACT","abstract",126],["T_WHITESPACE"," ",126],["T_PUBLIC","public",126],["T_WHITESPACE"," ",126],["T_FUNCTION","function",126],["T_WHITESPACE"," ",126],["T_STRING","execute",126],"(",")",";",["T_WHITESPACE","\n\n    ",126],["T_DOC_COMMENT","\/**\n     * Run reindexation\n     *\n     * @return void\n     *\/",128],["T_WHITESPACE","\n    ",132],["T_PROTECTED","protected",133],["T_WHITESPACE"," ",133],["T_FUNCTION","function",133],["T_WHITESPACE"," ",133],["T_STRING","reindex",133],"(",")",["T_WHITESPACE","\n    ",133],"{",["T_WHITESPACE","\n        ",134],["T_FOREACH","foreach",135],["T_WHITESPACE"," ",135],"(",["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","storeManager",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getStores",135],"(",")",["T_WHITESPACE"," ",135],["T_AS","as",135],["T_WHITESPACE"," ",135],["T_VARIABLE","$store",135],")",["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n            ",135],["T_IF","if",136],["T_WHITESPACE"," ",136],"(",["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getPathFromCategoryId",136],"(",["T_VARIABLE","$store",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getRootCategoryId",136],"(",")",")",")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n                ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","reindexRootCategory",137],"(",["T_VARIABLE","$store",137],")",";",["T_WHITESPACE","\n                ",137],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","reindexAnchorCategories",138],"(",["T_VARIABLE","$store",138],")",";",["T_WHITESPACE","\n                ",138],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","reindexNonAnchorCategories",139],"(",["T_VARIABLE","$store",139],")",";",["T_WHITESPACE","\n            ",139],"}",["T_WHITESPACE","\n        ",140],"}",["T_WHITESPACE","\n    ",141],"}",["T_WHITESPACE","\n\n    ",142],["T_DOC_COMMENT","\/**\n     * Return validated table name\n     *\n     * @param string|string[] $table\n     * @return string\n     *\/",144],["T_WHITESPACE","\n    ",149],["T_PROTECTED","protected",150],["T_WHITESPACE"," ",150],["T_FUNCTION","function",150],["T_WHITESPACE"," ",150],["T_STRING","getTable",150],"(",["T_VARIABLE","$table",150],")",["T_WHITESPACE","\n    ",150],"{",["T_WHITESPACE","\n        ",151],["T_RETURN","return",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","resource",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","getTableName",152],"(",["T_VARIABLE","$table",152],")",";",["T_WHITESPACE","\n    ",152],"}",["T_WHITESPACE","\n\n    ",153],["T_DOC_COMMENT","\/**\n     * Return main index table name\n     *\n     * @return string\n     *\/",155],["T_WHITESPACE","\n    ",159],["T_PROTECTED","protected",160],["T_WHITESPACE"," ",160],["T_FUNCTION","function",160],["T_WHITESPACE"," ",160],["T_STRING","getMainTable",160],"(",")",["T_WHITESPACE","\n    ",160],"{",["T_WHITESPACE","\n        ",161],["T_RETURN","return",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","getTable",162],"(",["T_STRING","self",162],["T_DOUBLE_COLON","::",162],["T_STRING","MAIN_INDEX_TABLE",162],")",";",["T_WHITESPACE","\n    ",162],"}",["T_WHITESPACE","\n\n    ",163],["T_DOC_COMMENT","\/**\n     * Return temporary index table name\n     *\n     * @return string\n     *\/",165],["T_WHITESPACE","\n    ",169],["T_PROTECTED","protected",170],["T_WHITESPACE"," ",170],["T_FUNCTION","function",170],["T_WHITESPACE"," ",170],["T_STRING","getMainTmpTable",170],"(",")",["T_WHITESPACE","\n    ",170],"{",["T_WHITESPACE","\n        ",171],["T_RETURN","return",172],["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","useTempTable",172],["T_WHITESPACE"," ",172],"?",["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","getTable",172],"(",["T_WHITESPACE","\n            ",172],["T_STRING","self",173],["T_DOUBLE_COLON","::",173],["T_STRING","MAIN_INDEX_TABLE",173],["T_WHITESPACE"," ",173],".",["T_WHITESPACE"," ",173],["T_STRING","self",173],["T_DOUBLE_COLON","::",173],["T_STRING","TEMPORARY_TABLE_SUFFIX",173],["T_WHITESPACE","\n        ",173],")",["T_WHITESPACE"," ",174],":",["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","getMainTable",174],"(",")",";",["T_WHITESPACE","\n    ",174],"}",["T_WHITESPACE","\n\n    ",175],["T_DOC_COMMENT","\/**\n     * Return category path by id\n     *\n     * @param int $categoryId\n     * @return string\n     *\/",177],["T_WHITESPACE","\n    ",182],["T_PROTECTED","protected",183],["T_WHITESPACE"," ",183],["T_FUNCTION","function",183],["T_WHITESPACE"," ",183],["T_STRING","getPathFromCategoryId",183],"(",["T_VARIABLE","$categoryId",183],")",["T_WHITESPACE","\n    ",183],"{",["T_WHITESPACE","\n        ",184],["T_IF","if",185],["T_WHITESPACE"," ",185],"(","!",["T_ISSET","isset",185],"(",["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","categoryPath",185],"[",["T_VARIABLE","$categoryId",185],"]",")",")",["T_WHITESPACE"," ",185],"{",["T_WHITESPACE","\n            ",185],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","categoryPath",186],"[",["T_VARIABLE","$categoryId",186],"]",["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","connection",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","fetchOne",186],"(",["T_WHITESPACE","\n                ",186],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","connection",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","select",187],"(",")",["T_OBJECT_OPERATOR","->",187],["T_STRING","from",187],"(",["T_WHITESPACE","\n                    ",187],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getTable",188],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_entity'",188],")",",",["T_WHITESPACE","\n                    ",188],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",189],"]",["T_WHITESPACE","\n                ",189],")",["T_OBJECT_OPERATOR","->",190],["T_STRING","where",190],"(",["T_WHITESPACE","\n                    ",190],["T_CONSTANT_ENCAPSED_STRING","'entity_id = ?'",191],",",["T_WHITESPACE","\n                    ",191],["T_VARIABLE","$categoryId",192],["T_WHITESPACE","\n                ",192],")",["T_WHITESPACE","\n            ",193],")",";",["T_WHITESPACE","\n        ",194],"}",["T_WHITESPACE","\n        ",195],["T_RETURN","return",196],["T_WHITESPACE"," ",196],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","categoryPath",196],"[",["T_VARIABLE","$categoryId",196],"]",";",["T_WHITESPACE","\n    ",196],"}",["T_WHITESPACE","\n\n    ",197],["T_DOC_COMMENT","\/**\n     * Retrieve select for reindex products of non anchor categories\n     *\n     * @param \\Magento\\Store\\Model\\Store $store\n     * @return \\Magento\\Framework\\DB\\Select\n     *\/",199],["T_WHITESPACE","\n    ",204],["T_PROTECTED","protected",205],["T_WHITESPACE"," ",205],["T_FUNCTION","function",205],["T_WHITESPACE"," ",205],["T_STRING","getNonAnchorCategoriesSelect",205],"(",["T_NS_SEPARATOR","\\",205],["T_STRING","Magento",205],["T_NS_SEPARATOR","\\",205],["T_STRING","Store",205],["T_NS_SEPARATOR","\\",205],["T_STRING","Model",205],["T_NS_SEPARATOR","\\",205],["T_STRING","Store",205],["T_WHITESPACE"," ",205],["T_VARIABLE","$store",205],")",["T_WHITESPACE","\n    ",205],"{",["T_WHITESPACE","\n        ",206],["T_IF","if",207],["T_WHITESPACE"," ",207],"(","!",["T_ISSET","isset",207],"(",["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","nonAnchorSelects",207],"[",["T_VARIABLE","$store",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","getId",207],"(",")","]",")",")",["T_WHITESPACE"," ",207],"{",["T_WHITESPACE","\n            ",207],["T_VARIABLE","$statusAttributeId",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","config",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","getAttribute",208],"(",["T_WHITESPACE","\n                ",208],["T_NS_SEPARATOR","\\",209],["T_STRING","Magento",209],["T_NS_SEPARATOR","\\",209],["T_STRING","Catalog",209],["T_NS_SEPARATOR","\\",209],["T_STRING","Model",209],["T_NS_SEPARATOR","\\",209],["T_STRING","Product",209],["T_DOUBLE_COLON","::",209],["T_STRING","ENTITY",209],",",["T_WHITESPACE","\n                ",209],["T_CONSTANT_ENCAPSED_STRING","'status'",210],["T_WHITESPACE","\n            ",210],")",["T_OBJECT_OPERATOR","->",211],["T_STRING","getId",211],"(",")",";",["T_WHITESPACE","\n            ",211],["T_VARIABLE","$visibilityAttributeId",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","config",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","getAttribute",212],"(",["T_WHITESPACE","\n                ",212],["T_NS_SEPARATOR","\\",213],["T_STRING","Magento",213],["T_NS_SEPARATOR","\\",213],["T_STRING","Catalog",213],["T_NS_SEPARATOR","\\",213],["T_STRING","Model",213],["T_NS_SEPARATOR","\\",213],["T_STRING","Product",213],["T_DOUBLE_COLON","::",213],["T_STRING","ENTITY",213],",",["T_WHITESPACE","\n                ",213],["T_CONSTANT_ENCAPSED_STRING","'visibility'",214],["T_WHITESPACE","\n            ",214],")",["T_OBJECT_OPERATOR","->",215],["T_STRING","getId",215],"(",")",";",["T_WHITESPACE","\n\n            ",215],["T_VARIABLE","$rootPath",217],["T_WHITESPACE"," ",217],"=",["T_WHITESPACE"," ",217],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","getPathFromCategoryId",217],"(",["T_VARIABLE","$store",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","getRootCategoryId",217],"(",")",")",";",["T_WHITESPACE","\n\n            ",217],["T_VARIABLE","$metadata",219],["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","getMetadataPool",219],"(",")",["T_OBJECT_OPERATOR","->",219],["T_STRING","getMetadata",219],"(",["T_NS_SEPARATOR","\\",219],["T_STRING","Magento",219],["T_NS_SEPARATOR","\\",219],["T_STRING","Catalog",219],["T_NS_SEPARATOR","\\",219],["T_STRING","Api",219],["T_NS_SEPARATOR","\\",219],["T_STRING","Data",219],["T_NS_SEPARATOR","\\",219],["T_STRING","ProductInterface",219],["T_DOUBLE_COLON","::",219],["T_CLASS","class",219],")",";",["T_WHITESPACE","\n            ",219],["T_VARIABLE","$linkField",220],["T_WHITESPACE"," ",220],"=",["T_WHITESPACE"," ",220],["T_VARIABLE","$metadata",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","getLinkField",220],"(",")",";",["T_WHITESPACE","\n            ",220],["T_VARIABLE","$select",221],["T_WHITESPACE"," ",221],"=",["T_WHITESPACE"," ",221],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","connection",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","select",221],"(",")",["T_OBJECT_OPERATOR","->",221],["T_STRING","from",221],"(",["T_WHITESPACE","\n                ",221],"[",["T_CONSTANT_ENCAPSED_STRING","'cc'",222],["T_WHITESPACE"," ",222],["T_DOUBLE_ARROW","=>",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","getTable",222],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_entity'",222],")","]",",",["T_WHITESPACE","\n                ",222],"[","]",["T_WHITESPACE","\n            ",223],")",["T_OBJECT_OPERATOR","->",224],["T_STRING","joinInner",224],"(",["T_WHITESPACE","\n                ",224],"[",["T_CONSTANT_ENCAPSED_STRING","'ccp'",225],["T_WHITESPACE"," ",225],["T_DOUBLE_ARROW","=>",225],["T_WHITESPACE"," ",225],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","getTable",225],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_product'",225],")","]",",",["T_WHITESPACE","\n                ",225],["T_CONSTANT_ENCAPSED_STRING","'ccp.category_id = cc.entity_id'",226],",",["T_WHITESPACE","\n                ",226],"[","]",["T_WHITESPACE","\n            ",227],")",["T_OBJECT_OPERATOR","->",228],["T_STRING","joinInner",228],"(",["T_WHITESPACE","\n                ",228],"[",["T_CONSTANT_ENCAPSED_STRING","'cpw'",229],["T_WHITESPACE"," ",229],["T_DOUBLE_ARROW","=>",229],["T_WHITESPACE"," ",229],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","getTable",229],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_website'",229],")","]",",",["T_WHITESPACE","\n                ",229],["T_CONSTANT_ENCAPSED_STRING","'cpw.product_id = ccp.product_id'",230],",",["T_WHITESPACE","\n                ",230],"[","]",["T_WHITESPACE","\n            ",231],")",["T_OBJECT_OPERATOR","->",232],["T_STRING","joinInner",232],"(",["T_WHITESPACE","\n                ",232],"[",["T_CONSTANT_ENCAPSED_STRING","'cpe'",233],["T_WHITESPACE"," ",233],["T_DOUBLE_ARROW","=>",233],["T_WHITESPACE"," ",233],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","getTable",233],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity'",233],")","]",",",["T_WHITESPACE","\n                ",233],["T_CONSTANT_ENCAPSED_STRING","'ccp.product_id = cpe.entity_id'",234],",",["T_WHITESPACE","\n                ",234],"[","]",["T_WHITESPACE","\n            ",235],")",["T_OBJECT_OPERATOR","->",236],["T_STRING","joinInner",236],"(",["T_WHITESPACE","\n                ",236],"[",["T_CONSTANT_ENCAPSED_STRING","'cpsd'",237],["T_WHITESPACE"," ",237],["T_DOUBLE_ARROW","=>",237],["T_WHITESPACE"," ",237],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","getTable",237],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity_int'",237],")","]",",",["T_WHITESPACE","\n                ",237],["T_CONSTANT_ENCAPSED_STRING","'cpsd.'",238],["T_WHITESPACE"," ",238],".",["T_WHITESPACE"," ",238],["T_VARIABLE","$linkField",238],["T_WHITESPACE"," ",238],".",["T_WHITESPACE"," ",238],["T_CONSTANT_ENCAPSED_STRING","' = cpe.'",238],["T_WHITESPACE"," ",238],".",["T_WHITESPACE"," ",238],["T_VARIABLE","$linkField",238],["T_WHITESPACE"," ",238],".",["T_WHITESPACE"," ",238],["T_CONSTANT_ENCAPSED_STRING","' AND cpsd.store_id = 0'",238],["T_WHITESPACE"," ",238],".",["T_WHITESPACE","\n                ",238],["T_CONSTANT_ENCAPSED_STRING","' AND cpsd.attribute_id = '",239],["T_WHITESPACE"," ",239],".",["T_WHITESPACE","\n                ",239],["T_VARIABLE","$statusAttributeId",240],",",["T_WHITESPACE","\n                ",240],"[","]",["T_WHITESPACE","\n            ",241],")",["T_OBJECT_OPERATOR","->",242],["T_STRING","joinLeft",242],"(",["T_WHITESPACE","\n                ",242],"[",["T_CONSTANT_ENCAPSED_STRING","'cpss'",243],["T_WHITESPACE"," ",243],["T_DOUBLE_ARROW","=>",243],["T_WHITESPACE"," ",243],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","getTable",243],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity_int'",243],")","]",",",["T_WHITESPACE","\n                ",243],["T_CONSTANT_ENCAPSED_STRING","'cpss.'",244],["T_WHITESPACE"," ",244],".",["T_WHITESPACE"," ",244],["T_VARIABLE","$linkField",244],["T_WHITESPACE"," ",244],".",["T_WHITESPACE"," ",244],["T_CONSTANT_ENCAPSED_STRING","' = cpe.'",244],["T_WHITESPACE"," ",244],".",["T_WHITESPACE"," ",244],["T_VARIABLE","$linkField",244],["T_WHITESPACE"," ",244],".",["T_WHITESPACE"," ",244],["T_CONSTANT_ENCAPSED_STRING","' AND cpss.attribute_id = cpsd.attribute_id'",244],["T_WHITESPACE"," ",244],".",["T_WHITESPACE","\n                ",244],["T_CONSTANT_ENCAPSED_STRING","' AND cpss.store_id = '",245],["T_WHITESPACE"," ",245],".",["T_WHITESPACE","\n                ",245],["T_VARIABLE","$store",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","getId",246],"(",")",",",["T_WHITESPACE","\n                ",246],"[","]",["T_WHITESPACE","\n            ",247],")",["T_OBJECT_OPERATOR","->",248],["T_STRING","joinInner",248],"(",["T_WHITESPACE","\n                ",248],"[",["T_CONSTANT_ENCAPSED_STRING","'cpvd'",249],["T_WHITESPACE"," ",249],["T_DOUBLE_ARROW","=>",249],["T_WHITESPACE"," ",249],["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","getTable",249],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity_int'",249],")","]",",",["T_WHITESPACE","\n                ",249],["T_CONSTANT_ENCAPSED_STRING","'cpvd.'",250],["T_WHITESPACE"," ",250],".",["T_WHITESPACE"," ",250],["T_VARIABLE","$linkField",250],["T_WHITESPACE"," ",250],".",["T_WHITESPACE"," ",250],["T_CONSTANT_ENCAPSED_STRING","' = cpe.'",250],["T_WHITESPACE"," ",250],".",["T_WHITESPACE"," ",250],["T_VARIABLE","$linkField",250],["T_WHITESPACE"," ",250],".",["T_WHITESPACE"," ",250],["T_CONSTANT_ENCAPSED_STRING","' AND cpvd.store_id = 0'",250],["T_WHITESPACE"," ",250],".",["T_WHITESPACE","\n                ",250],["T_CONSTANT_ENCAPSED_STRING","' AND cpvd.attribute_id = '",251],["T_WHITESPACE"," ",251],".",["T_WHITESPACE","\n                ",251],["T_VARIABLE","$visibilityAttributeId",252],",",["T_WHITESPACE","\n                ",252],"[","]",["T_WHITESPACE","\n            ",253],")",["T_OBJECT_OPERATOR","->",254],["T_STRING","joinLeft",254],"(",["T_WHITESPACE","\n                ",254],"[",["T_CONSTANT_ENCAPSED_STRING","'cpvs'",255],["T_WHITESPACE"," ",255],["T_DOUBLE_ARROW","=>",255],["T_WHITESPACE"," ",255],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","getTable",255],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity_int'",255],")","]",",",["T_WHITESPACE","\n                ",255],["T_CONSTANT_ENCAPSED_STRING","'cpvs.'",256],["T_WHITESPACE"," ",256],".",["T_WHITESPACE"," ",256],["T_VARIABLE","$linkField",256],["T_WHITESPACE"," ",256],".",["T_WHITESPACE"," ",256],["T_CONSTANT_ENCAPSED_STRING","' = cpe.'",256],["T_WHITESPACE"," ",256],".",["T_WHITESPACE"," ",256],["T_VARIABLE","$linkField",256],["T_WHITESPACE"," ",256],".",["T_WHITESPACE"," ",256],["T_CONSTANT_ENCAPSED_STRING","' AND cpvs.attribute_id = cpvd.attribute_id'",256],["T_WHITESPACE"," ",256],".",["T_WHITESPACE","\n                ",256],["T_CONSTANT_ENCAPSED_STRING","' AND cpvs.store_id = '",257],["T_WHITESPACE"," ",257],".",["T_WHITESPACE","\n                ",257],["T_VARIABLE","$store",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","getId",258],"(",")",",",["T_WHITESPACE","\n                ",258],"[","]",["T_WHITESPACE","\n            ",259],")",["T_OBJECT_OPERATOR","->",260],["T_STRING","where",260],"(",["T_WHITESPACE","\n                ",260],["T_CONSTANT_ENCAPSED_STRING","'cc.path LIKE '",261],["T_WHITESPACE"," ",261],".",["T_WHITESPACE"," ",261],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","connection",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","quote",261],"(",["T_VARIABLE","$rootPath",261],["T_WHITESPACE"," ",261],".",["T_WHITESPACE"," ",261],["T_CONSTANT_ENCAPSED_STRING","'\/%'",261],")",["T_WHITESPACE","\n            ",261],")",["T_OBJECT_OPERATOR","->",262],["T_STRING","where",262],"(",["T_WHITESPACE","\n                ",262],["T_CONSTANT_ENCAPSED_STRING","'cpw.website_id = ?'",263],",",["T_WHITESPACE","\n                ",263],["T_VARIABLE","$store",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","getWebsiteId",264],"(",")",["T_WHITESPACE","\n            ",264],")",["T_OBJECT_OPERATOR","->",265],["T_STRING","where",265],"(",["T_WHITESPACE","\n                ",265],["T_VARIABLE","$this",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","connection",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","getIfNullSql",266],"(",["T_CONSTANT_ENCAPSED_STRING","'cpss.value'",266],",",["T_WHITESPACE"," ",266],["T_CONSTANT_ENCAPSED_STRING","'cpsd.value'",266],")",["T_WHITESPACE"," ",266],".",["T_WHITESPACE"," ",266],["T_CONSTANT_ENCAPSED_STRING","' = ?'",266],",",["T_WHITESPACE","\n                ",266],["T_NS_SEPARATOR","\\",267],["T_STRING","Magento",267],["T_NS_SEPARATOR","\\",267],["T_STRING","Catalog",267],["T_NS_SEPARATOR","\\",267],["T_STRING","Model",267],["T_NS_SEPARATOR","\\",267],["T_STRING","Product",267],["T_NS_SEPARATOR","\\",267],["T_STRING","Attribute",267],["T_NS_SEPARATOR","\\",267],["T_STRING","Source",267],["T_NS_SEPARATOR","\\",267],["T_STRING","Status",267],["T_DOUBLE_COLON","::",267],["T_STRING","STATUS_ENABLED",267],["T_WHITESPACE","\n            ",267],")",["T_OBJECT_OPERATOR","->",268],["T_STRING","where",268],"(",["T_WHITESPACE","\n                ",268],["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","connection",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","getIfNullSql",269],"(",["T_CONSTANT_ENCAPSED_STRING","'cpvs.value'",269],",",["T_WHITESPACE"," ",269],["T_CONSTANT_ENCAPSED_STRING","'cpvd.value'",269],")",["T_WHITESPACE"," ",269],".",["T_WHITESPACE"," ",269],["T_CONSTANT_ENCAPSED_STRING","' IN (?)'",269],",",["T_WHITESPACE","\n                ",269],"[",["T_WHITESPACE","\n                    ",270],["T_NS_SEPARATOR","\\",271],["T_STRING","Magento",271],["T_NS_SEPARATOR","\\",271],["T_STRING","Catalog",271],["T_NS_SEPARATOR","\\",271],["T_STRING","Model",271],["T_NS_SEPARATOR","\\",271],["T_STRING","Product",271],["T_NS_SEPARATOR","\\",271],["T_STRING","Visibility",271],["T_DOUBLE_COLON","::",271],["T_STRING","VISIBILITY_IN_CATALOG",271],",",["T_WHITESPACE","\n                    ",271],["T_NS_SEPARATOR","\\",272],["T_STRING","Magento",272],["T_NS_SEPARATOR","\\",272],["T_STRING","Catalog",272],["T_NS_SEPARATOR","\\",272],["T_STRING","Model",272],["T_NS_SEPARATOR","\\",272],["T_STRING","Product",272],["T_NS_SEPARATOR","\\",272],["T_STRING","Visibility",272],["T_DOUBLE_COLON","::",272],["T_STRING","VISIBILITY_IN_SEARCH",272],",",["T_WHITESPACE","\n                    ",272],["T_NS_SEPARATOR","\\",273],["T_STRING","Magento",273],["T_NS_SEPARATOR","\\",273],["T_STRING","Catalog",273],["T_NS_SEPARATOR","\\",273],["T_STRING","Model",273],["T_NS_SEPARATOR","\\",273],["T_STRING","Product",273],["T_NS_SEPARATOR","\\",273],["T_STRING","Visibility",273],["T_DOUBLE_COLON","::",273],["T_STRING","VISIBILITY_BOTH",273],["T_WHITESPACE","\n                ",273],"]",["T_WHITESPACE","\n            ",274],")",["T_OBJECT_OPERATOR","->",275],["T_STRING","columns",275],"(",["T_WHITESPACE","\n                ",275],"[",["T_WHITESPACE","\n                    ",276],["T_CONSTANT_ENCAPSED_STRING","'category_id'",277],["T_WHITESPACE"," ",277],["T_DOUBLE_ARROW","=>",277],["T_WHITESPACE"," ",277],["T_CONSTANT_ENCAPSED_STRING","'cc.entity_id'",277],",",["T_WHITESPACE","\n                    ",277],["T_CONSTANT_ENCAPSED_STRING","'product_id'",278],["T_WHITESPACE"," ",278],["T_DOUBLE_ARROW","=>",278],["T_WHITESPACE"," ",278],["T_CONSTANT_ENCAPSED_STRING","'ccp.product_id'",278],",",["T_WHITESPACE","\n                    ",278],["T_CONSTANT_ENCAPSED_STRING","'position'",279],["T_WHITESPACE"," ",279],["T_DOUBLE_ARROW","=>",279],["T_WHITESPACE"," ",279],["T_CONSTANT_ENCAPSED_STRING","'ccp.position'",279],",",["T_WHITESPACE","\n                    ",279],["T_CONSTANT_ENCAPSED_STRING","'is_parent'",280],["T_WHITESPACE"," ",280],["T_DOUBLE_ARROW","=>",280],["T_WHITESPACE"," ",280],["T_NEW","new",280],["T_WHITESPACE"," ",280],["T_NS_SEPARATOR","\\",280],["T_STRING","Zend_Db_Expr",280],"(",["T_CONSTANT_ENCAPSED_STRING","'1'",280],")",",",["T_WHITESPACE","\n                    ",280],["T_CONSTANT_ENCAPSED_STRING","'store_id'",281],["T_WHITESPACE"," ",281],["T_DOUBLE_ARROW","=>",281],["T_WHITESPACE"," ",281],["T_NEW","new",281],["T_WHITESPACE"," ",281],["T_NS_SEPARATOR","\\",281],["T_STRING","Zend_Db_Expr",281],"(",["T_VARIABLE","$store",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","getId",281],"(",")",")",",",["T_WHITESPACE","\n                    ",281],["T_CONSTANT_ENCAPSED_STRING","'visibility'",282],["T_WHITESPACE"," ",282],["T_DOUBLE_ARROW","=>",282],["T_WHITESPACE"," ",282],["T_NEW","new",282],["T_WHITESPACE"," ",282],["T_NS_SEPARATOR","\\",282],["T_STRING","Zend_Db_Expr",282],"(",["T_WHITESPACE","\n                        ",282],["T_VARIABLE","$this",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","connection",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","getIfNullSql",283],"(",["T_CONSTANT_ENCAPSED_STRING","'cpvs.value'",283],",",["T_WHITESPACE"," ",283],["T_CONSTANT_ENCAPSED_STRING","'cpvd.value'",283],")",["T_WHITESPACE","\n                    ",283],")",",",["T_WHITESPACE","\n                ",284],"]",["T_WHITESPACE","\n            ",285],")",";",["T_WHITESPACE","\n\n            ",286],["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","nonAnchorSelects",288],"[",["T_VARIABLE","$store",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","getId",288],"(",")","]",["T_WHITESPACE"," ",288],"=",["T_WHITESPACE"," ",288],["T_VARIABLE","$select",288],";",["T_WHITESPACE","\n        ",288],"}",["T_WHITESPACE","\n\n        ",289],["T_RETURN","return",291],["T_WHITESPACE"," ",291],["T_VARIABLE","$this",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","nonAnchorSelects",291],"[",["T_VARIABLE","$store",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","getId",291],"(",")","]",";",["T_WHITESPACE","\n    ",291],"}",["T_WHITESPACE","\n\n    ",292],["T_DOC_COMMENT","\/**\n     * Check whether select ranging is needed\n     *\n     * @return bool\n     *\/",294],["T_WHITESPACE","\n    ",298],["T_PROTECTED","protected",299],["T_WHITESPACE"," ",299],["T_FUNCTION","function",299],["T_WHITESPACE"," ",299],["T_STRING","isRangingNeeded",299],"(",")",["T_WHITESPACE","\n    ",299],"{",["T_WHITESPACE","\n        ",300],["T_RETURN","return",301],["T_WHITESPACE"," ",301],["T_STRING","true",301],";",["T_WHITESPACE","\n    ",301],"}",["T_WHITESPACE","\n\n    ",302],["T_DOC_COMMENT","\/**\n     * Return selects cut by min and max\n     *\n     * @param \\Magento\\Framework\\DB\\Select $select\n     * @param string $field\n     * @param int $range\n     * @return \\Magento\\Framework\\DB\\Select[]\n     *\/",304],["T_WHITESPACE","\n    ",311],["T_PROTECTED","protected",312],["T_WHITESPACE"," ",312],["T_FUNCTION","function",312],["T_WHITESPACE"," ",312],["T_STRING","prepareSelectsByRange",312],"(",["T_NS_SEPARATOR","\\",312],["T_STRING","Magento",312],["T_NS_SEPARATOR","\\",312],["T_STRING","Framework",312],["T_NS_SEPARATOR","\\",312],["T_STRING","DB",312],["T_NS_SEPARATOR","\\",312],["T_STRING","Select",312],["T_WHITESPACE"," ",312],["T_VARIABLE","$select",312],",",["T_WHITESPACE"," ",312],["T_VARIABLE","$field",312],",",["T_WHITESPACE"," ",312],["T_VARIABLE","$range",312],["T_WHITESPACE"," ",312],"=",["T_WHITESPACE"," ",312],["T_STRING","self",312],["T_DOUBLE_COLON","::",312],["T_STRING","RANGE_CATEGORY_STEP",312],")",["T_WHITESPACE","\n    ",312],"{",["T_WHITESPACE","\n        ",313],["T_RETURN","return",314],["T_WHITESPACE"," ",314],["T_VARIABLE","$this",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","isRangingNeeded",314],"(",")",["T_WHITESPACE"," ",314],"?",["T_WHITESPACE"," ",314],["T_VARIABLE","$this",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","connection",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","selectsByRange",314],"(",["T_WHITESPACE","\n            ",314],["T_VARIABLE","$field",315],",",["T_WHITESPACE","\n            ",315],["T_VARIABLE","$select",316],",",["T_WHITESPACE","\n            ",316],["T_VARIABLE","$range",317],["T_WHITESPACE","\n        ",317],")",["T_WHITESPACE"," ",318],":",["T_WHITESPACE"," ",318],"[",["T_WHITESPACE","\n            ",318],["T_VARIABLE","$select",319],["T_WHITESPACE","\n        ",319],"]",";",["T_WHITESPACE","\n    ",320],"}",["T_WHITESPACE","\n\n    ",321],["T_DOC_COMMENT","\/**\n     * Reindex products of non anchor categories\n     *\n     * @param \\Magento\\Store\\Model\\Store $store\n     * @return void\n     *\/",323],["T_WHITESPACE","\n    ",328],["T_PROTECTED","protected",329],["T_WHITESPACE"," ",329],["T_FUNCTION","function",329],["T_WHITESPACE"," ",329],["T_STRING","reindexNonAnchorCategories",329],"(",["T_NS_SEPARATOR","\\",329],["T_STRING","Magento",329],["T_NS_SEPARATOR","\\",329],["T_STRING","Store",329],["T_NS_SEPARATOR","\\",329],["T_STRING","Model",329],["T_NS_SEPARATOR","\\",329],["T_STRING","Store",329],["T_WHITESPACE"," ",329],["T_VARIABLE","$store",329],")",["T_WHITESPACE","\n    ",329],"{",["T_WHITESPACE","\n        ",330],["T_VARIABLE","$selects",331],["T_WHITESPACE"," ",331],"=",["T_WHITESPACE"," ",331],["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","prepareSelectsByRange",331],"(",["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","getNonAnchorCategoriesSelect",331],"(",["T_VARIABLE","$store",331],")",",",["T_WHITESPACE"," ",331],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",331],")",";",["T_WHITESPACE","\n        ",331],["T_FOREACH","foreach",332],["T_WHITESPACE"," ",332],"(",["T_VARIABLE","$selects",332],["T_WHITESPACE"," ",332],["T_AS","as",332],["T_WHITESPACE"," ",332],["T_VARIABLE","$select",332],")",["T_WHITESPACE"," ",332],"{",["T_WHITESPACE","\n            ",332],["T_VARIABLE","$this",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","connection",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","query",333],"(",["T_WHITESPACE","\n                ",333],["T_VARIABLE","$this",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","connection",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","insertFromSelect",334],"(",["T_WHITESPACE","\n                    ",334],["T_VARIABLE","$select",335],",",["T_WHITESPACE","\n                    ",335],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","getMainTmpTable",336],"(",")",",",["T_WHITESPACE","\n                    ",336],"[",["T_CONSTANT_ENCAPSED_STRING","'category_id'",337],",",["T_WHITESPACE"," ",337],["T_CONSTANT_ENCAPSED_STRING","'product_id'",337],",",["T_WHITESPACE"," ",337],["T_CONSTANT_ENCAPSED_STRING","'position'",337],",",["T_WHITESPACE"," ",337],["T_CONSTANT_ENCAPSED_STRING","'is_parent'",337],",",["T_WHITESPACE"," ",337],["T_CONSTANT_ENCAPSED_STRING","'store_id'",337],",",["T_WHITESPACE"," ",337],["T_CONSTANT_ENCAPSED_STRING","'visibility'",337],"]",",",["T_WHITESPACE","\n                    ",337],["T_NS_SEPARATOR","\\",338],["T_STRING","Magento",338],["T_NS_SEPARATOR","\\",338],["T_STRING","Framework",338],["T_NS_SEPARATOR","\\",338],["T_STRING","DB",338],["T_NS_SEPARATOR","\\",338],["T_STRING","Adapter",338],["T_NS_SEPARATOR","\\",338],["T_STRING","AdapterInterface",338],["T_DOUBLE_COLON","::",338],["T_STRING","INSERT_ON_DUPLICATE",338],["T_WHITESPACE","\n                ",338],")",["T_WHITESPACE","\n            ",339],")",";",["T_WHITESPACE","\n        ",340],"}",["T_WHITESPACE","\n    ",341],"}",["T_WHITESPACE","\n\n    ",342],["T_DOC_COMMENT","\/**\n     * Check if anchor select isset\n     *\n     * @param \\Magento\\Store\\Model\\Store $store\n     * @return bool\n     *\/",344],["T_WHITESPACE","\n    ",349],["T_PROTECTED","protected",350],["T_WHITESPACE"," ",350],["T_FUNCTION","function",350],["T_WHITESPACE"," ",350],["T_STRING","hasAnchorSelect",350],"(",["T_NS_SEPARATOR","\\",350],["T_STRING","Magento",350],["T_NS_SEPARATOR","\\",350],["T_STRING","Store",350],["T_NS_SEPARATOR","\\",350],["T_STRING","Model",350],["T_NS_SEPARATOR","\\",350],["T_STRING","Store",350],["T_WHITESPACE"," ",350],["T_VARIABLE","$store",350],")",["T_WHITESPACE","\n    ",350],"{",["T_WHITESPACE","\n        ",351],["T_RETURN","return",352],["T_WHITESPACE"," ",352],["T_ISSET","isset",352],"(",["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","anchorSelects",352],"[",["T_VARIABLE","$store",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","getId",352],"(",")","]",")",";",["T_WHITESPACE","\n    ",352],"}",["T_WHITESPACE","\n\n    ",353],["T_DOC_COMMENT","\/**\n     * Create anchor select\n     *\n     * @param \\Magento\\Store\\Model\\Store $store\n     * @return \\Magento\\Framework\\DB\\Select\n     * @SuppressWarnings(PHPMD.ExcessiveMethodLength)\n     *\/",355],["T_WHITESPACE","\n    ",361],["T_PROTECTED","protected",362],["T_WHITESPACE"," ",362],["T_FUNCTION","function",362],["T_WHITESPACE"," ",362],["T_STRING","createAnchorSelect",362],"(",["T_NS_SEPARATOR","\\",362],["T_STRING","Magento",362],["T_NS_SEPARATOR","\\",362],["T_STRING","Store",362],["T_NS_SEPARATOR","\\",362],["T_STRING","Model",362],["T_NS_SEPARATOR","\\",362],["T_STRING","Store",362],["T_WHITESPACE"," ",362],["T_VARIABLE","$store",362],")",["T_WHITESPACE","\n    ",362],"{",["T_WHITESPACE","\n        ",363],["T_VARIABLE","$isAnchorAttributeId",364],["T_WHITESPACE"," ",364],"=",["T_WHITESPACE"," ",364],["T_VARIABLE","$this",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","config",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","getAttribute",364],"(",["T_WHITESPACE","\n            ",364],["T_NS_SEPARATOR","\\",365],["T_STRING","Magento",365],["T_NS_SEPARATOR","\\",365],["T_STRING","Catalog",365],["T_NS_SEPARATOR","\\",365],["T_STRING","Model",365],["T_NS_SEPARATOR","\\",365],["T_STRING","Category",365],["T_DOUBLE_COLON","::",365],["T_STRING","ENTITY",365],",",["T_WHITESPACE","\n            ",365],["T_CONSTANT_ENCAPSED_STRING","'is_anchor'",366],["T_WHITESPACE","\n        ",366],")",["T_OBJECT_OPERATOR","->",367],["T_STRING","getId",367],"(",")",";",["T_WHITESPACE","\n        ",367],["T_VARIABLE","$statusAttributeId",368],["T_WHITESPACE"," ",368],"=",["T_WHITESPACE"," ",368],["T_VARIABLE","$this",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","config",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","getAttribute",368],"(",["T_NS_SEPARATOR","\\",368],["T_STRING","Magento",368],["T_NS_SEPARATOR","\\",368],["T_STRING","Catalog",368],["T_NS_SEPARATOR","\\",368],["T_STRING","Model",368],["T_NS_SEPARATOR","\\",368],["T_STRING","Product",368],["T_DOUBLE_COLON","::",368],["T_STRING","ENTITY",368],",",["T_WHITESPACE"," ",368],["T_CONSTANT_ENCAPSED_STRING","'status'",368],")",["T_OBJECT_OPERATOR","->",368],["T_STRING","getId",368],"(",")",";",["T_WHITESPACE","\n        ",368],["T_VARIABLE","$visibilityAttributeId",369],["T_WHITESPACE"," ",369],"=",["T_WHITESPACE"," ",369],["T_VARIABLE","$this",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","config",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","getAttribute",369],"(",["T_WHITESPACE","\n            ",369],["T_NS_SEPARATOR","\\",370],["T_STRING","Magento",370],["T_NS_SEPARATOR","\\",370],["T_STRING","Catalog",370],["T_NS_SEPARATOR","\\",370],["T_STRING","Model",370],["T_NS_SEPARATOR","\\",370],["T_STRING","Product",370],["T_DOUBLE_COLON","::",370],["T_STRING","ENTITY",370],",",["T_WHITESPACE","\n            ",370],["T_CONSTANT_ENCAPSED_STRING","'visibility'",371],["T_WHITESPACE","\n        ",371],")",["T_OBJECT_OPERATOR","->",372],["T_STRING","getId",372],"(",")",";",["T_WHITESPACE","\n        ",372],["T_VARIABLE","$rootCatIds",373],["T_WHITESPACE"," ",373],"=",["T_WHITESPACE"," ",373],["T_STRING","explode",373],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",373],",",["T_WHITESPACE"," ",373],["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","getPathFromCategoryId",373],"(",["T_VARIABLE","$store",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","getRootCategoryId",373],"(",")",")",")",";",["T_WHITESPACE","\n        ",373],["T_STRING","array_pop",374],"(",["T_VARIABLE","$rootCatIds",374],")",";",["T_WHITESPACE","\n\n        ",374],["T_VARIABLE","$temporaryTreeTable",376],["T_WHITESPACE"," ",376],"=",["T_WHITESPACE"," ",376],["T_VARIABLE","$this",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","makeTempCategoryTreeIndex",376],"(",")",";",["T_WHITESPACE","\n\n        ",376],["T_VARIABLE","$productMetadata",378],["T_WHITESPACE"," ",378],"=",["T_WHITESPACE"," ",378],["T_VARIABLE","$this",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","getMetadataPool",378],"(",")",["T_OBJECT_OPERATOR","->",378],["T_STRING","getMetadata",378],"(",["T_NS_SEPARATOR","\\",378],["T_STRING","Magento",378],["T_NS_SEPARATOR","\\",378],["T_STRING","Catalog",378],["T_NS_SEPARATOR","\\",378],["T_STRING","Api",378],["T_NS_SEPARATOR","\\",378],["T_STRING","Data",378],["T_NS_SEPARATOR","\\",378],["T_STRING","ProductInterface",378],["T_DOUBLE_COLON","::",378],["T_CLASS","class",378],")",";",["T_WHITESPACE","\n        ",378],["T_VARIABLE","$categoryMetadata",379],["T_WHITESPACE"," ",379],"=",["T_WHITESPACE"," ",379],["T_VARIABLE","$this",379],["T_OBJECT_OPERATOR","->",379],["T_STRING","getMetadataPool",379],"(",")",["T_OBJECT_OPERATOR","->",379],["T_STRING","getMetadata",379],"(",["T_NS_SEPARATOR","\\",379],["T_STRING","Magento",379],["T_NS_SEPARATOR","\\",379],["T_STRING","Catalog",379],["T_NS_SEPARATOR","\\",379],["T_STRING","Api",379],["T_NS_SEPARATOR","\\",379],["T_STRING","Data",379],["T_NS_SEPARATOR","\\",379],["T_STRING","CategoryInterface",379],["T_DOUBLE_COLON","::",379],["T_CLASS","class",379],")",";",["T_WHITESPACE","\n        ",379],["T_VARIABLE","$productLinkField",380],["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],["T_VARIABLE","$productMetadata",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","getLinkField",380],"(",")",";",["T_WHITESPACE","\n        ",380],["T_VARIABLE","$categoryLinkField",381],["T_WHITESPACE"," ",381],"=",["T_WHITESPACE"," ",381],["T_VARIABLE","$categoryMetadata",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","getLinkField",381],"(",")",";",["T_WHITESPACE","\n\n        ",381],["T_RETURN","return",383],["T_WHITESPACE"," ",383],["T_VARIABLE","$this",383],["T_OBJECT_OPERATOR","->",383],["T_STRING","connection",383],["T_OBJECT_OPERATOR","->",383],["T_STRING","select",383],"(",")",["T_OBJECT_OPERATOR","->",383],["T_STRING","from",383],"(",["T_WHITESPACE","\n            ",383],"[",["T_CONSTANT_ENCAPSED_STRING","'cc'",384],["T_WHITESPACE"," ",384],["T_DOUBLE_ARROW","=>",384],["T_WHITESPACE"," ",384],["T_VARIABLE","$this",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","getTable",384],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_entity'",384],")","]",",",["T_WHITESPACE","\n            ",384],"[","]",["T_WHITESPACE","\n        ",385],")",["T_OBJECT_OPERATOR","->",386],["T_STRING","joinInner",386],"(",["T_WHITESPACE","\n            ",386],"[",["T_CONSTANT_ENCAPSED_STRING","'cc2'",387],["T_WHITESPACE"," ",387],["T_DOUBLE_ARROW","=>",387],["T_WHITESPACE"," ",387],["T_VARIABLE","$temporaryTreeTable",387],"]",",",["T_WHITESPACE","\n            ",387],["T_CONSTANT_ENCAPSED_STRING","'cc2.parent_id = cc.entity_id AND cc.entity_id NOT IN ('",388],["T_WHITESPACE"," ",388],".",["T_WHITESPACE"," ",388],["T_STRING","implode",388],"(",["T_WHITESPACE","\n                ",388],["T_CONSTANT_ENCAPSED_STRING","','",389],",",["T_WHITESPACE","\n                ",389],["T_VARIABLE","$rootCatIds",390],["T_WHITESPACE","\n            ",390],")",["T_WHITESPACE"," ",391],".",["T_WHITESPACE"," ",391],["T_CONSTANT_ENCAPSED_STRING","')'",391],",",["T_WHITESPACE","\n            ",391],"[","]",["T_WHITESPACE","\n        ",392],")",["T_OBJECT_OPERATOR","->",393],["T_STRING","joinInner",393],"(",["T_WHITESPACE","\n            ",393],"[",["T_CONSTANT_ENCAPSED_STRING","'ccp'",394],["T_WHITESPACE"," ",394],["T_DOUBLE_ARROW","=>",394],["T_WHITESPACE"," ",394],["T_VARIABLE","$this",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","getTable",394],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_product'",394],")","]",",",["T_WHITESPACE","\n            ",394],["T_CONSTANT_ENCAPSED_STRING","'ccp.category_id = cc2.child_id'",395],",",["T_WHITESPACE","\n            ",395],"[","]",["T_WHITESPACE","\n        ",396],")",["T_OBJECT_OPERATOR","->",397],["T_STRING","joinInner",397],"(",["T_WHITESPACE","\n            ",397],"[",["T_CONSTANT_ENCAPSED_STRING","'cpe'",398],["T_WHITESPACE"," ",398],["T_DOUBLE_ARROW","=>",398],["T_WHITESPACE"," ",398],["T_VARIABLE","$this",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","getTable",398],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity'",398],")","]",",",["T_WHITESPACE","\n            ",398],["T_CONSTANT_ENCAPSED_STRING","'ccp.product_id = cpe.entity_id'",399],",",["T_WHITESPACE","\n            ",399],"[","]",["T_WHITESPACE","\n        ",400],")",["T_OBJECT_OPERATOR","->",401],["T_STRING","joinInner",401],"(",["T_WHITESPACE","\n            ",401],"[",["T_CONSTANT_ENCAPSED_STRING","'cpw'",402],["T_WHITESPACE"," ",402],["T_DOUBLE_ARROW","=>",402],["T_WHITESPACE"," ",402],["T_VARIABLE","$this",402],["T_OBJECT_OPERATOR","->",402],["T_STRING","getTable",402],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_website'",402],")","]",",",["T_WHITESPACE","\n            ",402],["T_CONSTANT_ENCAPSED_STRING","'cpw.product_id = ccp.product_id'",403],",",["T_WHITESPACE","\n            ",403],"[","]",["T_WHITESPACE","\n        ",404],")",["T_OBJECT_OPERATOR","->",405],["T_STRING","joinInner",405],"(",["T_WHITESPACE","\n            ",405],"[",["T_CONSTANT_ENCAPSED_STRING","'cpsd'",406],["T_WHITESPACE"," ",406],["T_DOUBLE_ARROW","=>",406],["T_WHITESPACE"," ",406],["T_VARIABLE","$this",406],["T_OBJECT_OPERATOR","->",406],["T_STRING","getTable",406],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity_int'",406],")","]",",",["T_WHITESPACE","\n            ",406],["T_CONSTANT_ENCAPSED_STRING","'cpsd.'",407],["T_WHITESPACE"," ",407],".",["T_WHITESPACE"," ",407],["T_VARIABLE","$productLinkField",407],["T_WHITESPACE"," ",407],".",["T_WHITESPACE"," ",407],["T_CONSTANT_ENCAPSED_STRING","' = cpe.'",407],["T_WHITESPACE"," ",407],".",["T_WHITESPACE"," ",407],["T_VARIABLE","$productLinkField",407],["T_WHITESPACE"," ",407],".",["T_WHITESPACE"," ",407],["T_CONSTANT_ENCAPSED_STRING","' AND cpsd.store_id = 0'",407],["T_WHITESPACE","\n                ",407],".",["T_WHITESPACE"," ",408],["T_CONSTANT_ENCAPSED_STRING","' AND cpsd.attribute_id = '",408],["T_WHITESPACE"," ",408],".",["T_WHITESPACE"," ",408],["T_VARIABLE","$statusAttributeId",408],",",["T_WHITESPACE","\n            ",408],"[","]",["T_WHITESPACE","\n        ",409],")",["T_OBJECT_OPERATOR","->",410],["T_STRING","joinLeft",410],"(",["T_WHITESPACE","\n            ",410],"[",["T_CONSTANT_ENCAPSED_STRING","'cpss'",411],["T_WHITESPACE"," ",411],["T_DOUBLE_ARROW","=>",411],["T_WHITESPACE"," ",411],["T_VARIABLE","$this",411],["T_OBJECT_OPERATOR","->",411],["T_STRING","getTable",411],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity_int'",411],")","]",",",["T_WHITESPACE","\n            ",411],["T_CONSTANT_ENCAPSED_STRING","'cpss.'",412],["T_WHITESPACE"," ",412],".",["T_WHITESPACE"," ",412],["T_VARIABLE","$productLinkField",412],["T_WHITESPACE"," ",412],".",["T_WHITESPACE"," ",412],["T_CONSTANT_ENCAPSED_STRING","' = cpe.'",412],["T_WHITESPACE"," ",412],".",["T_WHITESPACE"," ",412],["T_VARIABLE","$productLinkField",412],["T_WHITESPACE"," ",412],".",["T_WHITESPACE"," ",412],["T_CONSTANT_ENCAPSED_STRING","' AND cpss.attribute_id = cpsd.attribute_id'",412],["T_WHITESPACE"," ",412],".",["T_WHITESPACE","\n            ",412],["T_CONSTANT_ENCAPSED_STRING","' AND cpss.store_id = '",413],["T_WHITESPACE"," ",413],".",["T_WHITESPACE","\n            ",413],["T_VARIABLE","$store",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","getId",414],"(",")",",",["T_WHITESPACE","\n            ",414],"[","]",["T_WHITESPACE","\n        ",415],")",["T_OBJECT_OPERATOR","->",416],["T_STRING","joinInner",416],"(",["T_WHITESPACE","\n            ",416],"[",["T_CONSTANT_ENCAPSED_STRING","'cpvd'",417],["T_WHITESPACE"," ",417],["T_DOUBLE_ARROW","=>",417],["T_WHITESPACE"," ",417],["T_VARIABLE","$this",417],["T_OBJECT_OPERATOR","->",417],["T_STRING","getTable",417],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity_int'",417],")","]",",",["T_WHITESPACE","\n            ",417],["T_CONSTANT_ENCAPSED_STRING","'cpvd.'",418],["T_WHITESPACE"," ",418],".",["T_WHITESPACE"," ",418],["T_VARIABLE","$productLinkField",418],["T_WHITESPACE"," ",418],".",["T_WHITESPACE"," ",418],["T_CONSTANT_ENCAPSED_STRING","' = cpe. '",418],["T_WHITESPACE"," ",418],".",["T_WHITESPACE"," ",418],["T_VARIABLE","$productLinkField",418],["T_WHITESPACE"," ",418],".",["T_WHITESPACE"," ",418],["T_CONSTANT_ENCAPSED_STRING","' AND cpvd.store_id = 0'",418],["T_WHITESPACE"," ",418],".",["T_WHITESPACE","\n            ",418],["T_CONSTANT_ENCAPSED_STRING","' AND cpvd.attribute_id = '",419],["T_WHITESPACE"," ",419],".",["T_WHITESPACE","\n            ",419],["T_VARIABLE","$visibilityAttributeId",420],",",["T_WHITESPACE","\n            ",420],"[","]",["T_WHITESPACE","\n        ",421],")",["T_OBJECT_OPERATOR","->",422],["T_STRING","joinLeft",422],"(",["T_WHITESPACE","\n            ",422],"[",["T_CONSTANT_ENCAPSED_STRING","'cpvs'",423],["T_WHITESPACE"," ",423],["T_DOUBLE_ARROW","=>",423],["T_WHITESPACE"," ",423],["T_VARIABLE","$this",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","getTable",423],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity_int'",423],")","]",",",["T_WHITESPACE","\n            ",423],["T_CONSTANT_ENCAPSED_STRING","'cpvs.'",424],["T_WHITESPACE"," ",424],".",["T_WHITESPACE"," ",424],["T_VARIABLE","$productLinkField",424],["T_WHITESPACE"," ",424],".",["T_WHITESPACE"," ",424],["T_CONSTANT_ENCAPSED_STRING","' = cpe.'",424],["T_WHITESPACE"," ",424],".",["T_WHITESPACE"," ",424],["T_VARIABLE","$productLinkField",424],["T_WHITESPACE"," ",424],".",["T_WHITESPACE","\n            ",424],["T_CONSTANT_ENCAPSED_STRING","' AND cpvs.attribute_id = cpvd.attribute_id '",425],["T_WHITESPACE"," ",425],".",["T_WHITESPACE"," ",425],["T_CONSTANT_ENCAPSED_STRING","'AND cpvs.store_id = '",425],["T_WHITESPACE"," ",425],".",["T_WHITESPACE","\n            ",425],["T_VARIABLE","$store",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","getId",426],"(",")",",",["T_WHITESPACE","\n            ",426],"[","]",["T_WHITESPACE","\n        ",427],")",["T_OBJECT_OPERATOR","->",428],["T_STRING","joinInner",428],"(",["T_WHITESPACE","\n            ",428],"[",["T_CONSTANT_ENCAPSED_STRING","'ccad'",429],["T_WHITESPACE"," ",429],["T_DOUBLE_ARROW","=>",429],["T_WHITESPACE"," ",429],["T_VARIABLE","$this",429],["T_OBJECT_OPERATOR","->",429],["T_STRING","getTable",429],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_entity_int'",429],")","]",",",["T_WHITESPACE","\n            ",429],["T_CONSTANT_ENCAPSED_STRING","'ccad.'",430],["T_WHITESPACE"," ",430],".",["T_WHITESPACE"," ",430],["T_VARIABLE","$categoryLinkField",430],["T_WHITESPACE"," ",430],".",["T_WHITESPACE"," ",430],["T_CONSTANT_ENCAPSED_STRING","' = cc.'",430],["T_WHITESPACE"," ",430],".",["T_WHITESPACE"," ",430],["T_VARIABLE","$categoryLinkField",430],["T_WHITESPACE"," ",430],".",["T_WHITESPACE"," ",430],["T_CONSTANT_ENCAPSED_STRING","' AND ccad.store_id = 0'",430],["T_WHITESPACE"," ",430],".",["T_WHITESPACE","\n            ",430],["T_CONSTANT_ENCAPSED_STRING","' AND ccad.attribute_id = '",431],["T_WHITESPACE"," ",431],".",["T_WHITESPACE"," ",431],["T_VARIABLE","$isAnchorAttributeId",431],",",["T_WHITESPACE","\n            ",431],"[","]",["T_WHITESPACE","\n        ",432],")",["T_OBJECT_OPERATOR","->",433],["T_STRING","joinLeft",433],"(",["T_WHITESPACE","\n            ",433],"[",["T_CONSTANT_ENCAPSED_STRING","'ccas'",434],["T_WHITESPACE"," ",434],["T_DOUBLE_ARROW","=>",434],["T_WHITESPACE"," ",434],["T_VARIABLE","$this",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","getTable",434],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_entity_int'",434],")","]",",",["T_WHITESPACE","\n            ",434],["T_CONSTANT_ENCAPSED_STRING","'ccas.'",435],["T_WHITESPACE"," ",435],".",["T_WHITESPACE"," ",435],["T_VARIABLE","$categoryLinkField",435],["T_WHITESPACE"," ",435],".",["T_WHITESPACE"," ",435],["T_CONSTANT_ENCAPSED_STRING","' = cc.'",435],["T_WHITESPACE"," ",435],".",["T_WHITESPACE"," ",435],["T_VARIABLE","$categoryLinkField",435],["T_WHITESPACE","\n            ",435],".",["T_WHITESPACE"," ",436],["T_CONSTANT_ENCAPSED_STRING","' AND ccas.attribute_id = ccad.attribute_id AND ccas.store_id = '",436],["T_WHITESPACE"," ",436],".",["T_WHITESPACE","\n            ",436],["T_VARIABLE","$store",437],["T_OBJECT_OPERATOR","->",437],["T_STRING","getId",437],"(",")",",",["T_WHITESPACE","\n            ",437],"[","]",["T_WHITESPACE","\n        ",438],")",["T_OBJECT_OPERATOR","->",439],["T_STRING","where",439],"(",["T_WHITESPACE","\n            ",439],["T_CONSTANT_ENCAPSED_STRING","'cpw.website_id = ?'",440],",",["T_WHITESPACE","\n            ",440],["T_VARIABLE","$store",441],["T_OBJECT_OPERATOR","->",441],["T_STRING","getWebsiteId",441],"(",")",["T_WHITESPACE","\n        ",441],")",["T_OBJECT_OPERATOR","->",442],["T_STRING","where",442],"(",["T_WHITESPACE","\n            ",442],["T_VARIABLE","$this",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","connection",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","getIfNullSql",443],"(",["T_CONSTANT_ENCAPSED_STRING","'cpss.value'",443],",",["T_WHITESPACE"," ",443],["T_CONSTANT_ENCAPSED_STRING","'cpsd.value'",443],")",["T_WHITESPACE"," ",443],".",["T_WHITESPACE"," ",443],["T_CONSTANT_ENCAPSED_STRING","' = ?'",443],",",["T_WHITESPACE","\n            ",443],["T_NS_SEPARATOR","\\",444],["T_STRING","Magento",444],["T_NS_SEPARATOR","\\",444],["T_STRING","Catalog",444],["T_NS_SEPARATOR","\\",444],["T_STRING","Model",444],["T_NS_SEPARATOR","\\",444],["T_STRING","Product",444],["T_NS_SEPARATOR","\\",444],["T_STRING","Attribute",444],["T_NS_SEPARATOR","\\",444],["T_STRING","Source",444],["T_NS_SEPARATOR","\\",444],["T_STRING","Status",444],["T_DOUBLE_COLON","::",444],["T_STRING","STATUS_ENABLED",444],["T_WHITESPACE","\n        ",444],")",["T_OBJECT_OPERATOR","->",445],["T_STRING","where",445],"(",["T_WHITESPACE","\n            ",445],["T_VARIABLE","$this",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","connection",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","getIfNullSql",446],"(",["T_CONSTANT_ENCAPSED_STRING","'cpvs.value'",446],",",["T_WHITESPACE"," ",446],["T_CONSTANT_ENCAPSED_STRING","'cpvd.value'",446],")",["T_WHITESPACE"," ",446],".",["T_WHITESPACE"," ",446],["T_CONSTANT_ENCAPSED_STRING","' IN (?)'",446],",",["T_WHITESPACE","\n            ",446],"[",["T_WHITESPACE","\n                ",447],["T_NS_SEPARATOR","\\",448],["T_STRING","Magento",448],["T_NS_SEPARATOR","\\",448],["T_STRING","Catalog",448],["T_NS_SEPARATOR","\\",448],["T_STRING","Model",448],["T_NS_SEPARATOR","\\",448],["T_STRING","Product",448],["T_NS_SEPARATOR","\\",448],["T_STRING","Visibility",448],["T_DOUBLE_COLON","::",448],["T_STRING","VISIBILITY_IN_CATALOG",448],",",["T_WHITESPACE","\n                ",448],["T_NS_SEPARATOR","\\",449],["T_STRING","Magento",449],["T_NS_SEPARATOR","\\",449],["T_STRING","Catalog",449],["T_NS_SEPARATOR","\\",449],["T_STRING","Model",449],["T_NS_SEPARATOR","\\",449],["T_STRING","Product",449],["T_NS_SEPARATOR","\\",449],["T_STRING","Visibility",449],["T_DOUBLE_COLON","::",449],["T_STRING","VISIBILITY_IN_SEARCH",449],",",["T_WHITESPACE","\n                ",449],["T_NS_SEPARATOR","\\",450],["T_STRING","Magento",450],["T_NS_SEPARATOR","\\",450],["T_STRING","Catalog",450],["T_NS_SEPARATOR","\\",450],["T_STRING","Model",450],["T_NS_SEPARATOR","\\",450],["T_STRING","Product",450],["T_NS_SEPARATOR","\\",450],["T_STRING","Visibility",450],["T_DOUBLE_COLON","::",450],["T_STRING","VISIBILITY_BOTH",450],["T_WHITESPACE","\n            ",450],"]",["T_WHITESPACE","\n        ",451],")",["T_OBJECT_OPERATOR","->",452],["T_STRING","where",452],"(",["T_WHITESPACE","\n            ",452],["T_VARIABLE","$this",453],["T_OBJECT_OPERATOR","->",453],["T_STRING","connection",453],["T_OBJECT_OPERATOR","->",453],["T_STRING","getIfNullSql",453],"(",["T_CONSTANT_ENCAPSED_STRING","'ccas.value'",453],",",["T_WHITESPACE"," ",453],["T_CONSTANT_ENCAPSED_STRING","'ccad.value'",453],")",["T_WHITESPACE"," ",453],".",["T_WHITESPACE"," ",453],["T_CONSTANT_ENCAPSED_STRING","' = ?'",453],",",["T_WHITESPACE","\n            ",453],["T_LNUMBER","1",454],["T_WHITESPACE","\n        ",454],")",["T_OBJECT_OPERATOR","->",455],["T_STRING","columns",455],"(",["T_WHITESPACE","\n            ",455],"[",["T_WHITESPACE","\n                ",456],["T_CONSTANT_ENCAPSED_STRING","'category_id'",457],["T_WHITESPACE"," ",457],["T_DOUBLE_ARROW","=>",457],["T_WHITESPACE"," ",457],["T_CONSTANT_ENCAPSED_STRING","'cc.entity_id'",457],",",["T_WHITESPACE","\n                ",457],["T_CONSTANT_ENCAPSED_STRING","'product_id'",458],["T_WHITESPACE"," ",458],["T_DOUBLE_ARROW","=>",458],["T_WHITESPACE"," ",458],["T_CONSTANT_ENCAPSED_STRING","'ccp.product_id'",458],",",["T_WHITESPACE","\n                ",458],["T_CONSTANT_ENCAPSED_STRING","'position'",459],["T_WHITESPACE"," ",459],["T_DOUBLE_ARROW","=>",459],["T_WHITESPACE"," ",459],["T_NEW","new",459],["T_WHITESPACE"," ",459],["T_NS_SEPARATOR","\\",459],["T_STRING","Zend_Db_Expr",459],"(",["T_CONSTANT_ENCAPSED_STRING","'ccp.position + 10000'",459],")",",",["T_WHITESPACE","\n                ",459],["T_CONSTANT_ENCAPSED_STRING","'is_parent'",460],["T_WHITESPACE"," ",460],["T_DOUBLE_ARROW","=>",460],["T_WHITESPACE"," ",460],["T_NEW","new",460],["T_WHITESPACE"," ",460],["T_NS_SEPARATOR","\\",460],["T_STRING","Zend_Db_Expr",460],"(",["T_CONSTANT_ENCAPSED_STRING","'0'",460],")",",",["T_WHITESPACE","\n                ",460],["T_CONSTANT_ENCAPSED_STRING","'store_id'",461],["T_WHITESPACE"," ",461],["T_DOUBLE_ARROW","=>",461],["T_WHITESPACE"," ",461],["T_NEW","new",461],["T_WHITESPACE"," ",461],["T_NS_SEPARATOR","\\",461],["T_STRING","Zend_Db_Expr",461],"(",["T_VARIABLE","$store",461],["T_OBJECT_OPERATOR","->",461],["T_STRING","getId",461],"(",")",")",",",["T_WHITESPACE","\n                ",461],["T_CONSTANT_ENCAPSED_STRING","'visibility'",462],["T_WHITESPACE"," ",462],["T_DOUBLE_ARROW","=>",462],["T_WHITESPACE"," ",462],["T_NEW","new",462],["T_WHITESPACE"," ",462],["T_NS_SEPARATOR","\\",462],["T_STRING","Zend_Db_Expr",462],"(",["T_VARIABLE","$this",462],["T_OBJECT_OPERATOR","->",462],["T_STRING","connection",462],["T_OBJECT_OPERATOR","->",462],["T_STRING","getIfNullSql",462],"(",["T_CONSTANT_ENCAPSED_STRING","'cpvs.value'",462],",",["T_WHITESPACE"," ",462],["T_CONSTANT_ENCAPSED_STRING","'cpvd.value'",462],")",")",",",["T_WHITESPACE","\n            ",462],"]",["T_WHITESPACE","\n        ",463],")",";",["T_WHITESPACE","\n    ",464],"}",["T_WHITESPACE","\n\n    ",465],["T_DOC_COMMENT","\/**\n     * Get temporary table name for concurrent indexing in persistent connection\n     * Temp table name is NOT shared between action instances and each action has it's own temp tree index\n     *\n     * @return string\n     *\/",467],["T_WHITESPACE","\n    ",472],["T_PROTECTED","protected",473],["T_WHITESPACE"," ",473],["T_FUNCTION","function",473],["T_WHITESPACE"," ",473],["T_STRING","getTemporaryTreeIndexTableName",473],"(",")",["T_WHITESPACE","\n    ",473],"{",["T_WHITESPACE","\n        ",474],["T_IF","if",475],["T_WHITESPACE"," ",475],"(",["T_EMPTY","empty",475],"(",["T_VARIABLE","$this",475],["T_OBJECT_OPERATOR","->",475],["T_STRING","tempTreeIndexTableName",475],")",")",["T_WHITESPACE"," ",475],"{",["T_WHITESPACE","\n            ",475],["T_VARIABLE","$this",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","tempTreeIndexTableName",476],["T_WHITESPACE"," ",476],"=",["T_WHITESPACE"," ",476],["T_VARIABLE","$this",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","connection",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","getTableName",476],"(",["T_CONSTANT_ENCAPSED_STRING","'temp_catalog_category_tree_index'",476],")",["T_WHITESPACE","\n                ",476],".",["T_WHITESPACE"," ",477],["T_CONSTANT_ENCAPSED_STRING","'_'",477],["T_WHITESPACE","\n                ",477],".",["T_WHITESPACE"," ",478],["T_STRING","substr",478],"(",["T_STRING","md5",478],"(",["T_STRING","time",478],"(",")",["T_WHITESPACE"," ",478],".",["T_WHITESPACE"," ",478],["T_STRING","rand",478],"(",["T_LNUMBER","0",478],",",["T_WHITESPACE"," ",478],["T_LNUMBER","999999999",478],")",")",",",["T_WHITESPACE"," ",478],["T_LNUMBER","0",478],",",["T_WHITESPACE"," ",478],["T_LNUMBER","8",478],")",";",["T_WHITESPACE","\n        ",478],"}",["T_WHITESPACE","\n\n        ",479],["T_RETURN","return",481],["T_WHITESPACE"," ",481],["T_VARIABLE","$this",481],["T_OBJECT_OPERATOR","->",481],["T_STRING","tempTreeIndexTableName",481],";",["T_WHITESPACE","\n    ",481],"}",["T_WHITESPACE","\n\n    ",482],["T_DOC_COMMENT","\/**\n     * Build and populate the temporary category tree index table\n     *\n     * Returns the name of the temporary table to use in queries.\n     *\n     * @return string\n     *\/",484],["T_WHITESPACE","\n    ",490],["T_PROTECTED","protected",491],["T_WHITESPACE"," ",491],["T_FUNCTION","function",491],["T_WHITESPACE"," ",491],["T_STRING","makeTempCategoryTreeIndex",491],"(",")",["T_WHITESPACE","\n    ",491],"{",["T_WHITESPACE","\n        ",492],["T_COMMENT","\/\/ Note: this temporary table is per-connection, so won't conflict by prefix.\n",493],["T_WHITESPACE","        ",494],["T_VARIABLE","$temporaryName",494],["T_WHITESPACE"," ",494],"=",["T_WHITESPACE"," ",494],["T_VARIABLE","$this",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","getTemporaryTreeIndexTableName",494],"(",")",";",["T_WHITESPACE","\n\n        ",494],["T_VARIABLE","$temporaryTable",496],["T_WHITESPACE"," ",496],"=",["T_WHITESPACE"," ",496],["T_VARIABLE","$this",496],["T_OBJECT_OPERATOR","->",496],["T_STRING","connection",496],["T_OBJECT_OPERATOR","->",496],["T_STRING","newTable",496],"(",["T_VARIABLE","$temporaryName",496],")",";",["T_WHITESPACE","\n        ",496],["T_VARIABLE","$temporaryTable",497],["T_OBJECT_OPERATOR","->",497],["T_STRING","addColumn",497],"(",["T_WHITESPACE","\n            ",497],["T_CONSTANT_ENCAPSED_STRING","'parent_id'",498],",",["T_WHITESPACE","\n            ",498],["T_NS_SEPARATOR","\\",499],["T_STRING","Magento",499],["T_NS_SEPARATOR","\\",499],["T_STRING","Framework",499],["T_NS_SEPARATOR","\\",499],["T_STRING","DB",499],["T_NS_SEPARATOR","\\",499],["T_STRING","Ddl",499],["T_NS_SEPARATOR","\\",499],["T_STRING","Table",499],["T_DOUBLE_COLON","::",499],["T_STRING","TYPE_INTEGER",499],",",["T_WHITESPACE","\n            ",499],["T_STRING","null",500],",",["T_WHITESPACE","\n            ",500],"[",["T_CONSTANT_ENCAPSED_STRING","'nullable'",501],["T_WHITESPACE"," ",501],["T_DOUBLE_ARROW","=>",501],["T_WHITESPACE"," ",501],["T_STRING","false",501],",",["T_WHITESPACE"," ",501],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",501],["T_WHITESPACE"," ",501],["T_DOUBLE_ARROW","=>",501],["T_WHITESPACE"," ",501],["T_STRING","true",501],"]",["T_WHITESPACE","\n        ",501],")",";",["T_WHITESPACE","\n        ",502],["T_VARIABLE","$temporaryTable",503],["T_OBJECT_OPERATOR","->",503],["T_STRING","addColumn",503],"(",["T_WHITESPACE","\n            ",503],["T_CONSTANT_ENCAPSED_STRING","'child_id'",504],",",["T_WHITESPACE","\n            ",504],["T_NS_SEPARATOR","\\",505],["T_STRING","Magento",505],["T_NS_SEPARATOR","\\",505],["T_STRING","Framework",505],["T_NS_SEPARATOR","\\",505],["T_STRING","DB",505],["T_NS_SEPARATOR","\\",505],["T_STRING","Ddl",505],["T_NS_SEPARATOR","\\",505],["T_STRING","Table",505],["T_DOUBLE_COLON","::",505],["T_STRING","TYPE_INTEGER",505],",",["T_WHITESPACE","\n            ",505],["T_STRING","null",506],",",["T_WHITESPACE","\n            ",506],"[",["T_CONSTANT_ENCAPSED_STRING","'nullable'",507],["T_WHITESPACE"," ",507],["T_DOUBLE_ARROW","=>",507],["T_WHITESPACE"," ",507],["T_STRING","false",507],",",["T_WHITESPACE"," ",507],["T_CONSTANT_ENCAPSED_STRING","'unsigned'",507],["T_WHITESPACE"," ",507],["T_DOUBLE_ARROW","=>",507],["T_WHITESPACE"," ",507],["T_STRING","true",507],"]",["T_WHITESPACE","\n        ",507],")",";",["T_WHITESPACE","\n        ",508],["T_COMMENT","\/\/ Each entry will be unique.\n",509],["T_WHITESPACE","        ",510],["T_VARIABLE","$temporaryTable",510],["T_OBJECT_OPERATOR","->",510],["T_STRING","addIndex",510],"(",["T_WHITESPACE","\n            ",510],["T_CONSTANT_ENCAPSED_STRING","'idx_primary'",511],",",["T_WHITESPACE","\n            ",511],"[",["T_CONSTANT_ENCAPSED_STRING","'parent_id'",512],",",["T_WHITESPACE"," ",512],["T_CONSTANT_ENCAPSED_STRING","'child_id'",512],"]",",",["T_WHITESPACE","\n            ",512],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",513],["T_WHITESPACE"," ",513],["T_DOUBLE_ARROW","=>",513],["T_WHITESPACE"," ",513],["T_NS_SEPARATOR","\\",513],["T_STRING","Magento",513],["T_NS_SEPARATOR","\\",513],["T_STRING","Framework",513],["T_NS_SEPARATOR","\\",513],["T_STRING","DB",513],["T_NS_SEPARATOR","\\",513],["T_STRING","Adapter",513],["T_NS_SEPARATOR","\\",513],["T_STRING","AdapterInterface",513],["T_DOUBLE_COLON","::",513],["T_STRING","INDEX_TYPE_PRIMARY",513],"]",["T_WHITESPACE","\n        ",513],")",";",["T_WHITESPACE","\n\n        ",514],["T_COMMENT","\/\/ Drop the temporary table in case it already exists on this (persistent?) connection.\n",516],["T_WHITESPACE","        ",517],["T_VARIABLE","$this",517],["T_OBJECT_OPERATOR","->",517],["T_STRING","connection",517],["T_OBJECT_OPERATOR","->",517],["T_STRING","dropTemporaryTable",517],"(",["T_VARIABLE","$temporaryName",517],")",";",["T_WHITESPACE","\n        ",517],["T_VARIABLE","$this",518],["T_OBJECT_OPERATOR","->",518],["T_STRING","connection",518],["T_OBJECT_OPERATOR","->",518],["T_STRING","createTemporaryTable",518],"(",["T_VARIABLE","$temporaryTable",518],")",";",["T_WHITESPACE","\n\n        ",518],["T_VARIABLE","$this",520],["T_OBJECT_OPERATOR","->",520],["T_STRING","fillTempCategoryTreeIndex",520],"(",["T_VARIABLE","$temporaryName",520],")",";",["T_WHITESPACE","\n\n        ",520],["T_RETURN","return",522],["T_WHITESPACE"," ",522],["T_VARIABLE","$temporaryName",522],";",["T_WHITESPACE","\n    ",522],"}",["T_WHITESPACE","\n\n    ",523],["T_DOC_COMMENT","\/**\n     * Populate the temporary category tree index table\n     *\n     * @param string $temporaryName\n     *\/",525],["T_WHITESPACE","\n    ",529],["T_PROTECTED","protected",530],["T_WHITESPACE"," ",530],["T_FUNCTION","function",530],["T_WHITESPACE"," ",530],["T_STRING","fillTempCategoryTreeIndex",530],"(",["T_VARIABLE","$temporaryName",530],")",["T_WHITESPACE","\n    ",530],"{",["T_WHITESPACE","\n        ",531],["T_COMMENT","\/\/ This finds all children (cc2) that descend from a parent (cc) by path.\n",532],["T_WHITESPACE","        ",533],["T_COMMENT","\/\/ For example, cc.path may be '1\/2', and cc2.path may be '1\/2\/3\/4\/5'.\n",533],["T_WHITESPACE","        ",534],["T_VARIABLE","$temporarySelect",534],["T_WHITESPACE"," ",534],"=",["T_WHITESPACE"," ",534],["T_VARIABLE","$this",534],["T_OBJECT_OPERATOR","->",534],["T_STRING","connection",534],["T_OBJECT_OPERATOR","->",534],["T_STRING","select",534],"(",")",["T_OBJECT_OPERATOR","->",534],["T_STRING","from",534],"(",["T_WHITESPACE","\n            ",534],"[",["T_CONSTANT_ENCAPSED_STRING","'cc'",535],["T_WHITESPACE"," ",535],["T_DOUBLE_ARROW","=>",535],["T_WHITESPACE"," ",535],["T_VARIABLE","$this",535],["T_OBJECT_OPERATOR","->",535],["T_STRING","getTable",535],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_entity'",535],")","]",",",["T_WHITESPACE","\n            ",535],"[",["T_CONSTANT_ENCAPSED_STRING","'parent_id'",536],["T_WHITESPACE"," ",536],["T_DOUBLE_ARROW","=>",536],["T_WHITESPACE"," ",536],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",536],"]",["T_WHITESPACE","\n        ",536],")",["T_OBJECT_OPERATOR","->",537],["T_STRING","joinInner",537],"(",["T_WHITESPACE","\n            ",537],"[",["T_CONSTANT_ENCAPSED_STRING","'cc2'",538],["T_WHITESPACE"," ",538],["T_DOUBLE_ARROW","=>",538],["T_WHITESPACE"," ",538],["T_VARIABLE","$this",538],["T_OBJECT_OPERATOR","->",538],["T_STRING","getTable",538],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_entity'",538],")","]",",",["T_WHITESPACE","\n            ",538],["T_CONSTANT_ENCAPSED_STRING","'cc2.path LIKE '",539],["T_WHITESPACE"," ",539],".",["T_WHITESPACE"," ",539],["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","connection",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","getConcatSql",539],"(",["T_WHITESPACE","\n                ",539],"[",["T_VARIABLE","$this",540],["T_OBJECT_OPERATOR","->",540],["T_STRING","connection",540],["T_OBJECT_OPERATOR","->",540],["T_STRING","quoteIdentifier",540],"(",["T_CONSTANT_ENCAPSED_STRING","'cc.path'",540],")",",",["T_WHITESPACE"," ",540],["T_VARIABLE","$this",540],["T_OBJECT_OPERATOR","->",540],["T_STRING","connection",540],["T_OBJECT_OPERATOR","->",540],["T_STRING","quote",540],"(",["T_CONSTANT_ENCAPSED_STRING","'\/%'",540],")","]",["T_WHITESPACE","\n            ",540],")",",",["T_WHITESPACE","\n            ",541],"[",["T_CONSTANT_ENCAPSED_STRING","'child_id'",542],["T_WHITESPACE"," ",542],["T_DOUBLE_ARROW","=>",542],["T_WHITESPACE"," ",542],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",542],"]",["T_WHITESPACE","\n        ",542],")",";",["T_WHITESPACE","\n\n        ",543],["T_VARIABLE","$this",545],["T_OBJECT_OPERATOR","->",545],["T_STRING","connection",545],["T_OBJECT_OPERATOR","->",545],["T_STRING","query",545],"(",["T_WHITESPACE","\n            ",545],["T_VARIABLE","$temporarySelect",546],["T_OBJECT_OPERATOR","->",546],["T_STRING","insertFromSelect",546],"(",["T_WHITESPACE","\n                ",546],["T_VARIABLE","$temporaryName",547],",",["T_WHITESPACE","\n                ",547],"[",["T_CONSTANT_ENCAPSED_STRING","'parent_id'",548],",",["T_WHITESPACE"," ",548],["T_CONSTANT_ENCAPSED_STRING","'child_id'",548],"]",["T_WHITESPACE","\n            ",548],")",["T_WHITESPACE","\n        ",549],")",";",["T_WHITESPACE","\n    ",550],"}",["T_WHITESPACE","\n\n    ",551],["T_DOC_COMMENT","\/**\n     * Retrieve select for reindex products of non anchor categories\n     *\n     * @param \\Magento\\Store\\Model\\Store $store\n     * @return \\Magento\\Framework\\DB\\Select\n     *\/",553],["T_WHITESPACE","\n    ",558],["T_PROTECTED","protected",559],["T_WHITESPACE"," ",559],["T_FUNCTION","function",559],["T_WHITESPACE"," ",559],["T_STRING","getAnchorCategoriesSelect",559],"(",["T_NS_SEPARATOR","\\",559],["T_STRING","Magento",559],["T_NS_SEPARATOR","\\",559],["T_STRING","Store",559],["T_NS_SEPARATOR","\\",559],["T_STRING","Model",559],["T_NS_SEPARATOR","\\",559],["T_STRING","Store",559],["T_WHITESPACE"," ",559],["T_VARIABLE","$store",559],")",["T_WHITESPACE","\n    ",559],"{",["T_WHITESPACE","\n        ",560],["T_IF","if",561],["T_WHITESPACE"," ",561],"(","!",["T_VARIABLE","$this",561],["T_OBJECT_OPERATOR","->",561],["T_STRING","hasAnchorSelect",561],"(",["T_VARIABLE","$store",561],")",")",["T_WHITESPACE"," ",561],"{",["T_WHITESPACE","\n            ",561],["T_VARIABLE","$this",562],["T_OBJECT_OPERATOR","->",562],["T_STRING","anchorSelects",562],"[",["T_VARIABLE","$store",562],["T_OBJECT_OPERATOR","->",562],["T_STRING","getId",562],"(",")","]",["T_WHITESPACE"," ",562],"=",["T_WHITESPACE"," ",562],["T_VARIABLE","$this",562],["T_OBJECT_OPERATOR","->",562],["T_STRING","createAnchorSelect",562],"(",["T_VARIABLE","$store",562],")",";",["T_WHITESPACE","\n        ",562],"}",["T_WHITESPACE","\n        ",563],["T_RETURN","return",564],["T_WHITESPACE"," ",564],["T_VARIABLE","$this",564],["T_OBJECT_OPERATOR","->",564],["T_STRING","anchorSelects",564],"[",["T_VARIABLE","$store",564],["T_OBJECT_OPERATOR","->",564],["T_STRING","getId",564],"(",")","]",";",["T_WHITESPACE","\n    ",564],"}",["T_WHITESPACE","\n\n    ",565],["T_DOC_COMMENT","\/**\n     * Reindex products of anchor categories\n     *\n     * @param \\Magento\\Store\\Model\\Store $store\n     * @return void\n     *\/",567],["T_WHITESPACE","\n    ",572],["T_PROTECTED","protected",573],["T_WHITESPACE"," ",573],["T_FUNCTION","function",573],["T_WHITESPACE"," ",573],["T_STRING","reindexAnchorCategories",573],"(",["T_NS_SEPARATOR","\\",573],["T_STRING","Magento",573],["T_NS_SEPARATOR","\\",573],["T_STRING","Store",573],["T_NS_SEPARATOR","\\",573],["T_STRING","Model",573],["T_NS_SEPARATOR","\\",573],["T_STRING","Store",573],["T_WHITESPACE"," ",573],["T_VARIABLE","$store",573],")",["T_WHITESPACE","\n    ",573],"{",["T_WHITESPACE","\n        ",574],["T_VARIABLE","$selects",575],["T_WHITESPACE"," ",575],"=",["T_WHITESPACE"," ",575],["T_VARIABLE","$this",575],["T_OBJECT_OPERATOR","->",575],["T_STRING","prepareSelectsByRange",575],"(",["T_VARIABLE","$this",575],["T_OBJECT_OPERATOR","->",575],["T_STRING","getAnchorCategoriesSelect",575],"(",["T_VARIABLE","$store",575],")",",",["T_WHITESPACE"," ",575],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",575],")",";",["T_WHITESPACE","\n\n        ",575],["T_FOREACH","foreach",577],["T_WHITESPACE"," ",577],"(",["T_VARIABLE","$selects",577],["T_WHITESPACE"," ",577],["T_AS","as",577],["T_WHITESPACE"," ",577],["T_VARIABLE","$select",577],")",["T_WHITESPACE"," ",577],"{",["T_WHITESPACE","\n            ",577],["T_VARIABLE","$this",578],["T_OBJECT_OPERATOR","->",578],["T_STRING","connection",578],["T_OBJECT_OPERATOR","->",578],["T_STRING","query",578],"(",["T_WHITESPACE","\n                ",578],["T_VARIABLE","$this",579],["T_OBJECT_OPERATOR","->",579],["T_STRING","connection",579],["T_OBJECT_OPERATOR","->",579],["T_STRING","insertFromSelect",579],"(",["T_WHITESPACE","\n                    ",579],["T_VARIABLE","$select",580],",",["T_WHITESPACE","\n                    ",580],["T_VARIABLE","$this",581],["T_OBJECT_OPERATOR","->",581],["T_STRING","getMainTmpTable",581],"(",")",",",["T_WHITESPACE","\n                    ",581],"[",["T_CONSTANT_ENCAPSED_STRING","'category_id'",582],",",["T_WHITESPACE"," ",582],["T_CONSTANT_ENCAPSED_STRING","'product_id'",582],",",["T_WHITESPACE"," ",582],["T_CONSTANT_ENCAPSED_STRING","'position'",582],",",["T_WHITESPACE"," ",582],["T_CONSTANT_ENCAPSED_STRING","'is_parent'",582],",",["T_WHITESPACE"," ",582],["T_CONSTANT_ENCAPSED_STRING","'store_id'",582],",",["T_WHITESPACE"," ",582],["T_CONSTANT_ENCAPSED_STRING","'visibility'",582],"]",",",["T_WHITESPACE","\n                    ",582],["T_NS_SEPARATOR","\\",583],["T_STRING","Magento",583],["T_NS_SEPARATOR","\\",583],["T_STRING","Framework",583],["T_NS_SEPARATOR","\\",583],["T_STRING","DB",583],["T_NS_SEPARATOR","\\",583],["T_STRING","Adapter",583],["T_NS_SEPARATOR","\\",583],["T_STRING","AdapterInterface",583],["T_DOUBLE_COLON","::",583],["T_STRING","INSERT_ON_DUPLICATE",583],["T_WHITESPACE","\n                ",583],")",["T_WHITESPACE","\n            ",584],")",";",["T_WHITESPACE","\n        ",585],"}",["T_WHITESPACE","\n    ",586],"}",["T_WHITESPACE","\n\n    ",587],["T_DOC_COMMENT","\/**\n     * Get select for all products\n     *\n     * @param \\Magento\\Store\\Model\\Store $store\n     * @return \\Magento\\Framework\\DB\\Select\n     *\/",589],["T_WHITESPACE","\n    ",594],["T_PROTECTED","protected",595],["T_WHITESPACE"," ",595],["T_FUNCTION","function",595],["T_WHITESPACE"," ",595],["T_STRING","getAllProducts",595],"(",["T_NS_SEPARATOR","\\",595],["T_STRING","Magento",595],["T_NS_SEPARATOR","\\",595],["T_STRING","Store",595],["T_NS_SEPARATOR","\\",595],["T_STRING","Model",595],["T_NS_SEPARATOR","\\",595],["T_STRING","Store",595],["T_WHITESPACE"," ",595],["T_VARIABLE","$store",595],")",["T_WHITESPACE","\n    ",595],"{",["T_WHITESPACE","\n        ",596],["T_IF","if",597],["T_WHITESPACE"," ",597],"(","!",["T_ISSET","isset",597],"(",["T_VARIABLE","$this",597],["T_OBJECT_OPERATOR","->",597],["T_STRING","productsSelects",597],"[",["T_VARIABLE","$store",597],["T_OBJECT_OPERATOR","->",597],["T_STRING","getId",597],"(",")","]",")",")",["T_WHITESPACE"," ",597],"{",["T_WHITESPACE","\n            ",597],["T_VARIABLE","$statusAttributeId",598],["T_WHITESPACE"," ",598],"=",["T_WHITESPACE"," ",598],["T_VARIABLE","$this",598],["T_OBJECT_OPERATOR","->",598],["T_STRING","config",598],["T_OBJECT_OPERATOR","->",598],["T_STRING","getAttribute",598],"(",["T_WHITESPACE","\n                ",598],["T_NS_SEPARATOR","\\",599],["T_STRING","Magento",599],["T_NS_SEPARATOR","\\",599],["T_STRING","Catalog",599],["T_NS_SEPARATOR","\\",599],["T_STRING","Model",599],["T_NS_SEPARATOR","\\",599],["T_STRING","Product",599],["T_DOUBLE_COLON","::",599],["T_STRING","ENTITY",599],",",["T_WHITESPACE","\n                ",599],["T_CONSTANT_ENCAPSED_STRING","'status'",600],["T_WHITESPACE","\n            ",600],")",["T_OBJECT_OPERATOR","->",601],["T_STRING","getId",601],"(",")",";",["T_WHITESPACE","\n            ",601],["T_VARIABLE","$visibilityAttributeId",602],["T_WHITESPACE"," ",602],"=",["T_WHITESPACE"," ",602],["T_VARIABLE","$this",602],["T_OBJECT_OPERATOR","->",602],["T_STRING","config",602],["T_OBJECT_OPERATOR","->",602],["T_STRING","getAttribute",602],"(",["T_WHITESPACE","\n                ",602],["T_NS_SEPARATOR","\\",603],["T_STRING","Magento",603],["T_NS_SEPARATOR","\\",603],["T_STRING","Catalog",603],["T_NS_SEPARATOR","\\",603],["T_STRING","Model",603],["T_NS_SEPARATOR","\\",603],["T_STRING","Product",603],["T_DOUBLE_COLON","::",603],["T_STRING","ENTITY",603],",",["T_WHITESPACE","\n                ",603],["T_CONSTANT_ENCAPSED_STRING","'visibility'",604],["T_WHITESPACE","\n            ",604],")",["T_OBJECT_OPERATOR","->",605],["T_STRING","getId",605],"(",")",";",["T_WHITESPACE","\n\n            ",605],["T_VARIABLE","$metadata",607],["T_WHITESPACE"," ",607],"=",["T_WHITESPACE"," ",607],["T_VARIABLE","$this",607],["T_OBJECT_OPERATOR","->",607],["T_STRING","getMetadataPool",607],"(",")",["T_OBJECT_OPERATOR","->",607],["T_STRING","getMetadata",607],"(",["T_NS_SEPARATOR","\\",607],["T_STRING","Magento",607],["T_NS_SEPARATOR","\\",607],["T_STRING","Catalog",607],["T_NS_SEPARATOR","\\",607],["T_STRING","Api",607],["T_NS_SEPARATOR","\\",607],["T_STRING","Data",607],["T_NS_SEPARATOR","\\",607],["T_STRING","ProductInterface",607],["T_DOUBLE_COLON","::",607],["T_CLASS","class",607],")",";",["T_WHITESPACE","\n            ",607],["T_VARIABLE","$linkField",608],["T_WHITESPACE"," ",608],"=",["T_WHITESPACE"," ",608],["T_VARIABLE","$metadata",608],["T_OBJECT_OPERATOR","->",608],["T_STRING","getLinkField",608],"(",")",";",["T_WHITESPACE","\n\n            ",608],["T_VARIABLE","$select",610],["T_WHITESPACE"," ",610],"=",["T_WHITESPACE"," ",610],["T_VARIABLE","$this",610],["T_OBJECT_OPERATOR","->",610],["T_STRING","connection",610],["T_OBJECT_OPERATOR","->",610],["T_STRING","select",610],"(",")",["T_OBJECT_OPERATOR","->",610],["T_STRING","from",610],"(",["T_WHITESPACE","\n                ",610],"[",["T_CONSTANT_ENCAPSED_STRING","'cp'",611],["T_WHITESPACE"," ",611],["T_DOUBLE_ARROW","=>",611],["T_WHITESPACE"," ",611],["T_VARIABLE","$this",611],["T_OBJECT_OPERATOR","->",611],["T_STRING","getTable",611],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity'",611],")","]",",",["T_WHITESPACE","\n                ",611],"[","]",["T_WHITESPACE","\n            ",612],")",["T_OBJECT_OPERATOR","->",613],["T_STRING","joinInner",613],"(",["T_WHITESPACE","\n                ",613],"[",["T_CONSTANT_ENCAPSED_STRING","'cpw'",614],["T_WHITESPACE"," ",614],["T_DOUBLE_ARROW","=>",614],["T_WHITESPACE"," ",614],["T_VARIABLE","$this",614],["T_OBJECT_OPERATOR","->",614],["T_STRING","getTable",614],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_website'",614],")","]",",",["T_WHITESPACE","\n                ",614],["T_CONSTANT_ENCAPSED_STRING","'cpw.product_id = cp.entity_id'",615],",",["T_WHITESPACE","\n                ",615],"[","]",["T_WHITESPACE","\n            ",616],")",["T_OBJECT_OPERATOR","->",617],["T_STRING","joinInner",617],"(",["T_WHITESPACE","\n                ",617],"[",["T_CONSTANT_ENCAPSED_STRING","'cpsd'",618],["T_WHITESPACE"," ",618],["T_DOUBLE_ARROW","=>",618],["T_WHITESPACE"," ",618],["T_VARIABLE","$this",618],["T_OBJECT_OPERATOR","->",618],["T_STRING","getTable",618],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity_int'",618],")","]",",",["T_WHITESPACE","\n                ",618],["T_CONSTANT_ENCAPSED_STRING","'cpsd.'",619],["T_WHITESPACE"," ",619],".",["T_WHITESPACE"," ",619],["T_VARIABLE","$linkField",619],["T_WHITESPACE"," ",619],".",["T_WHITESPACE"," ",619],["T_CONSTANT_ENCAPSED_STRING","' = cp.'",619],["T_WHITESPACE"," ",619],".",["T_WHITESPACE"," ",619],["T_VARIABLE","$linkField",619],["T_WHITESPACE"," ",619],".",["T_WHITESPACE"," ",619],["T_CONSTANT_ENCAPSED_STRING","' AND cpsd.store_id = 0'",619],["T_WHITESPACE"," ",619],".",["T_WHITESPACE","\n                ",619],["T_CONSTANT_ENCAPSED_STRING","' AND cpsd.attribute_id = '",620],["T_WHITESPACE"," ",620],".",["T_WHITESPACE","\n                ",620],["T_VARIABLE","$statusAttributeId",621],",",["T_WHITESPACE","\n                ",621],"[","]",["T_WHITESPACE","\n            ",622],")",["T_OBJECT_OPERATOR","->",623],["T_STRING","joinLeft",623],"(",["T_WHITESPACE","\n                ",623],"[",["T_CONSTANT_ENCAPSED_STRING","'cpss'",624],["T_WHITESPACE"," ",624],["T_DOUBLE_ARROW","=>",624],["T_WHITESPACE"," ",624],["T_VARIABLE","$this",624],["T_OBJECT_OPERATOR","->",624],["T_STRING","getTable",624],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity_int'",624],")","]",",",["T_WHITESPACE","\n                ",624],["T_CONSTANT_ENCAPSED_STRING","'cpss.'",625],["T_WHITESPACE"," ",625],".",["T_WHITESPACE"," ",625],["T_VARIABLE","$linkField",625],["T_WHITESPACE"," ",625],".",["T_WHITESPACE"," ",625],["T_CONSTANT_ENCAPSED_STRING","' = cp.'",625],["T_WHITESPACE"," ",625],".",["T_WHITESPACE"," ",625],["T_VARIABLE","$linkField",625],["T_WHITESPACE"," ",625],".",["T_WHITESPACE"," ",625],["T_CONSTANT_ENCAPSED_STRING","' AND cpss.attribute_id = cpsd.attribute_id'",625],["T_WHITESPACE"," ",625],".",["T_WHITESPACE","\n                ",625],["T_CONSTANT_ENCAPSED_STRING","' AND cpss.store_id = '",626],["T_WHITESPACE"," ",626],".",["T_WHITESPACE","\n                ",626],["T_VARIABLE","$store",627],["T_OBJECT_OPERATOR","->",627],["T_STRING","getId",627],"(",")",",",["T_WHITESPACE","\n                ",627],"[","]",["T_WHITESPACE","\n            ",628],")",["T_OBJECT_OPERATOR","->",629],["T_STRING","joinInner",629],"(",["T_WHITESPACE","\n                ",629],"[",["T_CONSTANT_ENCAPSED_STRING","'cpvd'",630],["T_WHITESPACE"," ",630],["T_DOUBLE_ARROW","=>",630],["T_WHITESPACE"," ",630],["T_VARIABLE","$this",630],["T_OBJECT_OPERATOR","->",630],["T_STRING","getTable",630],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity_int'",630],")","]",",",["T_WHITESPACE","\n                ",630],["T_CONSTANT_ENCAPSED_STRING","'cpvd.'",631],["T_WHITESPACE"," ",631],".",["T_WHITESPACE"," ",631],["T_VARIABLE","$linkField",631],["T_WHITESPACE"," ",631],".",["T_WHITESPACE"," ",631],["T_CONSTANT_ENCAPSED_STRING","' = cp.'",631],["T_WHITESPACE"," ",631],".",["T_WHITESPACE"," ",631],["T_VARIABLE","$linkField",631],["T_WHITESPACE"," ",631],".",["T_WHITESPACE"," ",631],["T_CONSTANT_ENCAPSED_STRING","' AND cpvd.store_id = 0'",631],["T_WHITESPACE"," ",631],".",["T_WHITESPACE","\n                ",631],["T_CONSTANT_ENCAPSED_STRING","' AND cpvd.attribute_id = '",632],["T_WHITESPACE"," ",632],".",["T_WHITESPACE","\n                ",632],["T_VARIABLE","$visibilityAttributeId",633],",",["T_WHITESPACE","\n                ",633],"[","]",["T_WHITESPACE","\n            ",634],")",["T_OBJECT_OPERATOR","->",635],["T_STRING","joinLeft",635],"(",["T_WHITESPACE","\n                ",635],"[",["T_CONSTANT_ENCAPSED_STRING","'cpvs'",636],["T_WHITESPACE"," ",636],["T_DOUBLE_ARROW","=>",636],["T_WHITESPACE"," ",636],["T_VARIABLE","$this",636],["T_OBJECT_OPERATOR","->",636],["T_STRING","getTable",636],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity_int'",636],")","]",",",["T_WHITESPACE","\n                ",636],["T_CONSTANT_ENCAPSED_STRING","'cpvs.'",637],["T_WHITESPACE"," ",637],".",["T_WHITESPACE"," ",637],["T_VARIABLE","$linkField",637],["T_WHITESPACE"," ",637],".",["T_WHITESPACE"," ",637],["T_CONSTANT_ENCAPSED_STRING","' = cp.'",637],["T_WHITESPACE"," ",637],".",["T_WHITESPACE"," ",637],["T_VARIABLE","$linkField",637],["T_WHITESPACE"," ",637],".",["T_WHITESPACE"," ",637],["T_CONSTANT_ENCAPSED_STRING","' AND cpvs.attribute_id = cpvd.attribute_id '",637],["T_WHITESPACE"," ",637],".",["T_WHITESPACE","\n                ",637],["T_CONSTANT_ENCAPSED_STRING","' AND cpvs.store_id = '",638],["T_WHITESPACE"," ",638],".",["T_WHITESPACE","\n                ",638],["T_VARIABLE","$store",639],["T_OBJECT_OPERATOR","->",639],["T_STRING","getId",639],"(",")",",",["T_WHITESPACE","\n                ",639],"[","]",["T_WHITESPACE","\n            ",640],")",["T_OBJECT_OPERATOR","->",641],["T_STRING","joinLeft",641],"(",["T_WHITESPACE","\n                ",641],"[",["T_CONSTANT_ENCAPSED_STRING","'ccp'",642],["T_WHITESPACE"," ",642],["T_DOUBLE_ARROW","=>",642],["T_WHITESPACE"," ",642],["T_VARIABLE","$this",642],["T_OBJECT_OPERATOR","->",642],["T_STRING","getTable",642],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_product'",642],")","]",",",["T_WHITESPACE","\n                ",642],["T_CONSTANT_ENCAPSED_STRING","'ccp.product_id = cp.entity_id'",643],",",["T_WHITESPACE","\n                ",643],"[","]",["T_WHITESPACE","\n            ",644],")",["T_OBJECT_OPERATOR","->",645],["T_STRING","where",645],"(",["T_WHITESPACE","\n                ",645],["T_CONSTANT_ENCAPSED_STRING","'cpw.website_id = ?'",646],",",["T_WHITESPACE","\n                ",646],["T_VARIABLE","$store",647],["T_OBJECT_OPERATOR","->",647],["T_STRING","getWebsiteId",647],"(",")",["T_WHITESPACE","\n            ",647],")",["T_OBJECT_OPERATOR","->",648],["T_STRING","where",648],"(",["T_WHITESPACE","\n                ",648],["T_VARIABLE","$this",649],["T_OBJECT_OPERATOR","->",649],["T_STRING","connection",649],["T_OBJECT_OPERATOR","->",649],["T_STRING","getIfNullSql",649],"(",["T_CONSTANT_ENCAPSED_STRING","'cpss.value'",649],",",["T_WHITESPACE"," ",649],["T_CONSTANT_ENCAPSED_STRING","'cpsd.value'",649],")",["T_WHITESPACE"," ",649],".",["T_WHITESPACE"," ",649],["T_CONSTANT_ENCAPSED_STRING","' = ?'",649],",",["T_WHITESPACE","\n                ",649],["T_NS_SEPARATOR","\\",650],["T_STRING","Magento",650],["T_NS_SEPARATOR","\\",650],["T_STRING","Catalog",650],["T_NS_SEPARATOR","\\",650],["T_STRING","Model",650],["T_NS_SEPARATOR","\\",650],["T_STRING","Product",650],["T_NS_SEPARATOR","\\",650],["T_STRING","Attribute",650],["T_NS_SEPARATOR","\\",650],["T_STRING","Source",650],["T_NS_SEPARATOR","\\",650],["T_STRING","Status",650],["T_DOUBLE_COLON","::",650],["T_STRING","STATUS_ENABLED",650],["T_WHITESPACE","\n            ",650],")",["T_OBJECT_OPERATOR","->",651],["T_STRING","where",651],"(",["T_WHITESPACE","\n                ",651],["T_VARIABLE","$this",652],["T_OBJECT_OPERATOR","->",652],["T_STRING","connection",652],["T_OBJECT_OPERATOR","->",652],["T_STRING","getIfNullSql",652],"(",["T_CONSTANT_ENCAPSED_STRING","'cpvs.value'",652],",",["T_WHITESPACE"," ",652],["T_CONSTANT_ENCAPSED_STRING","'cpvd.value'",652],")",["T_WHITESPACE"," ",652],".",["T_WHITESPACE"," ",652],["T_CONSTANT_ENCAPSED_STRING","' IN (?)'",652],",",["T_WHITESPACE","\n                ",652],"[",["T_WHITESPACE","\n                    ",653],["T_NS_SEPARATOR","\\",654],["T_STRING","Magento",654],["T_NS_SEPARATOR","\\",654],["T_STRING","Catalog",654],["T_NS_SEPARATOR","\\",654],["T_STRING","Model",654],["T_NS_SEPARATOR","\\",654],["T_STRING","Product",654],["T_NS_SEPARATOR","\\",654],["T_STRING","Visibility",654],["T_DOUBLE_COLON","::",654],["T_STRING","VISIBILITY_IN_CATALOG",654],",",["T_WHITESPACE","\n                    ",654],["T_NS_SEPARATOR","\\",655],["T_STRING","Magento",655],["T_NS_SEPARATOR","\\",655],["T_STRING","Catalog",655],["T_NS_SEPARATOR","\\",655],["T_STRING","Model",655],["T_NS_SEPARATOR","\\",655],["T_STRING","Product",655],["T_NS_SEPARATOR","\\",655],["T_STRING","Visibility",655],["T_DOUBLE_COLON","::",655],["T_STRING","VISIBILITY_IN_SEARCH",655],",",["T_WHITESPACE","\n                    ",655],["T_NS_SEPARATOR","\\",656],["T_STRING","Magento",656],["T_NS_SEPARATOR","\\",656],["T_STRING","Catalog",656],["T_NS_SEPARATOR","\\",656],["T_STRING","Model",656],["T_NS_SEPARATOR","\\",656],["T_STRING","Product",656],["T_NS_SEPARATOR","\\",656],["T_STRING","Visibility",656],["T_DOUBLE_COLON","::",656],["T_STRING","VISIBILITY_BOTH",656],["T_WHITESPACE","\n                ",656],"]",["T_WHITESPACE","\n            ",657],")",["T_OBJECT_OPERATOR","->",658],["T_STRING","group",658],"(",["T_WHITESPACE","\n                ",658],["T_CONSTANT_ENCAPSED_STRING","'cp.entity_id'",659],["T_WHITESPACE","\n            ",659],")",["T_OBJECT_OPERATOR","->",660],["T_STRING","columns",660],"(",["T_WHITESPACE","\n                ",660],"[",["T_WHITESPACE","\n                    ",661],["T_CONSTANT_ENCAPSED_STRING","'category_id'",662],["T_WHITESPACE"," ",662],["T_DOUBLE_ARROW","=>",662],["T_WHITESPACE"," ",662],["T_NEW","new",662],["T_WHITESPACE"," ",662],["T_NS_SEPARATOR","\\",662],["T_STRING","Zend_Db_Expr",662],"(",["T_VARIABLE","$store",662],["T_OBJECT_OPERATOR","->",662],["T_STRING","getRootCategoryId",662],"(",")",")",",",["T_WHITESPACE","\n                    ",662],["T_CONSTANT_ENCAPSED_STRING","'product_id'",663],["T_WHITESPACE"," ",663],["T_DOUBLE_ARROW","=>",663],["T_WHITESPACE"," ",663],["T_CONSTANT_ENCAPSED_STRING","'cp.entity_id'",663],",",["T_WHITESPACE","\n                    ",663],["T_CONSTANT_ENCAPSED_STRING","'position'",664],["T_WHITESPACE"," ",664],["T_DOUBLE_ARROW","=>",664],["T_WHITESPACE"," ",664],["T_NEW","new",664],["T_WHITESPACE"," ",664],["T_NS_SEPARATOR","\\",664],["T_STRING","Zend_Db_Expr",664],"(",["T_WHITESPACE","\n                        ",664],["T_VARIABLE","$this",665],["T_OBJECT_OPERATOR","->",665],["T_STRING","connection",665],["T_OBJECT_OPERATOR","->",665],["T_STRING","getCheckSql",665],"(",["T_CONSTANT_ENCAPSED_STRING","'ccp.product_id IS NOT NULL'",665],",",["T_WHITESPACE"," ",665],["T_CONSTANT_ENCAPSED_STRING","'ccp.position'",665],",",["T_WHITESPACE"," ",665],["T_CONSTANT_ENCAPSED_STRING","'0'",665],")",["T_WHITESPACE","\n                    ",665],")",",",["T_WHITESPACE","\n                    ",666],["T_CONSTANT_ENCAPSED_STRING","'is_parent'",667],["T_WHITESPACE"," ",667],["T_DOUBLE_ARROW","=>",667],["T_WHITESPACE"," ",667],["T_NEW","new",667],["T_WHITESPACE"," ",667],["T_NS_SEPARATOR","\\",667],["T_STRING","Zend_Db_Expr",667],"(",["T_WHITESPACE","\n                        ",667],["T_VARIABLE","$this",668],["T_OBJECT_OPERATOR","->",668],["T_STRING","connection",668],["T_OBJECT_OPERATOR","->",668],["T_STRING","getCheckSql",668],"(",["T_CONSTANT_ENCAPSED_STRING","'ccp.product_id IS NOT NULL'",668],",",["T_WHITESPACE"," ",668],["T_CONSTANT_ENCAPSED_STRING","'1'",668],",",["T_WHITESPACE"," ",668],["T_CONSTANT_ENCAPSED_STRING","'0'",668],")",["T_WHITESPACE","\n                    ",668],")",",",["T_WHITESPACE","\n                    ",669],["T_CONSTANT_ENCAPSED_STRING","'store_id'",670],["T_WHITESPACE"," ",670],["T_DOUBLE_ARROW","=>",670],["T_WHITESPACE"," ",670],["T_NEW","new",670],["T_WHITESPACE"," ",670],["T_NS_SEPARATOR","\\",670],["T_STRING","Zend_Db_Expr",670],"(",["T_VARIABLE","$store",670],["T_OBJECT_OPERATOR","->",670],["T_STRING","getId",670],"(",")",")",",",["T_WHITESPACE","\n                    ",670],["T_CONSTANT_ENCAPSED_STRING","'visibility'",671],["T_WHITESPACE"," ",671],["T_DOUBLE_ARROW","=>",671],["T_WHITESPACE"," ",671],["T_NEW","new",671],["T_WHITESPACE"," ",671],["T_NS_SEPARATOR","\\",671],["T_STRING","Zend_Db_Expr",671],"(",["T_WHITESPACE","\n                        ",671],["T_VARIABLE","$this",672],["T_OBJECT_OPERATOR","->",672],["T_STRING","connection",672],["T_OBJECT_OPERATOR","->",672],["T_STRING","getIfNullSql",672],"(",["T_CONSTANT_ENCAPSED_STRING","'cpvs.value'",672],",",["T_WHITESPACE"," ",672],["T_CONSTANT_ENCAPSED_STRING","'cpvd.value'",672],")",["T_WHITESPACE","\n                    ",672],")",",",["T_WHITESPACE","\n                ",673],"]",["T_WHITESPACE","\n            ",674],")",";",["T_WHITESPACE","\n\n            ",675],["T_VARIABLE","$this",677],["T_OBJECT_OPERATOR","->",677],["T_STRING","productsSelects",677],"[",["T_VARIABLE","$store",677],["T_OBJECT_OPERATOR","->",677],["T_STRING","getId",677],"(",")","]",["T_WHITESPACE"," ",677],"=",["T_WHITESPACE"," ",677],["T_VARIABLE","$select",677],";",["T_WHITESPACE","\n        ",677],"}",["T_WHITESPACE","\n\n        ",678],["T_RETURN","return",680],["T_WHITESPACE"," ",680],["T_VARIABLE","$this",680],["T_OBJECT_OPERATOR","->",680],["T_STRING","productsSelects",680],"[",["T_VARIABLE","$store",680],["T_OBJECT_OPERATOR","->",680],["T_STRING","getId",680],"(",")","]",";",["T_WHITESPACE","\n    ",680],"}",["T_WHITESPACE","\n\n    ",681],["T_DOC_COMMENT","\/**\n     * Check whether indexation of root category is needed\n     *\n     * @return bool\n     *\/",683],["T_WHITESPACE","\n    ",687],["T_PROTECTED","protected",688],["T_WHITESPACE"," ",688],["T_FUNCTION","function",688],["T_WHITESPACE"," ",688],["T_STRING","isIndexRootCategoryNeeded",688],"(",")",["T_WHITESPACE","\n    ",688],"{",["T_WHITESPACE","\n        ",689],["T_RETURN","return",690],["T_WHITESPACE"," ",690],["T_STRING","true",690],";",["T_WHITESPACE","\n    ",690],"}",["T_WHITESPACE","\n\n    ",691],["T_DOC_COMMENT","\/**\n     * Reindex all products to root category\n     *\n     * @param \\Magento\\Store\\Model\\Store $store\n     * @return void\n     *\/",693],["T_WHITESPACE","\n    ",698],["T_PROTECTED","protected",699],["T_WHITESPACE"," ",699],["T_FUNCTION","function",699],["T_WHITESPACE"," ",699],["T_STRING","reindexRootCategory",699],"(",["T_NS_SEPARATOR","\\",699],["T_STRING","Magento",699],["T_NS_SEPARATOR","\\",699],["T_STRING","Store",699],["T_NS_SEPARATOR","\\",699],["T_STRING","Model",699],["T_NS_SEPARATOR","\\",699],["T_STRING","Store",699],["T_WHITESPACE"," ",699],["T_VARIABLE","$store",699],")",["T_WHITESPACE","\n    ",699],"{",["T_WHITESPACE","\n        ",700],["T_IF","if",701],["T_WHITESPACE"," ",701],"(",["T_VARIABLE","$this",701],["T_OBJECT_OPERATOR","->",701],["T_STRING","isIndexRootCategoryNeeded",701],"(",")",")",["T_WHITESPACE"," ",701],"{",["T_WHITESPACE","\n            ",701],["T_VARIABLE","$selects",702],["T_WHITESPACE"," ",702],"=",["T_WHITESPACE"," ",702],["T_VARIABLE","$this",702],["T_OBJECT_OPERATOR","->",702],["T_STRING","prepareSelectsByRange",702],"(",["T_WHITESPACE","\n                ",702],["T_VARIABLE","$this",703],["T_OBJECT_OPERATOR","->",703],["T_STRING","getAllProducts",703],"(",["T_VARIABLE","$store",703],")",",",["T_WHITESPACE","\n                ",703],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",704],",",["T_WHITESPACE","\n                ",704],["T_STRING","self",705],["T_DOUBLE_COLON","::",705],["T_STRING","RANGE_PRODUCT_STEP",705],["T_WHITESPACE","\n            ",705],")",";",["T_WHITESPACE","\n\n            ",706],["T_FOREACH","foreach",708],["T_WHITESPACE"," ",708],"(",["T_VARIABLE","$selects",708],["T_WHITESPACE"," ",708],["T_AS","as",708],["T_WHITESPACE"," ",708],["T_VARIABLE","$select",708],")",["T_WHITESPACE"," ",708],"{",["T_WHITESPACE","\n                ",708],["T_VARIABLE","$this",709],["T_OBJECT_OPERATOR","->",709],["T_STRING","connection",709],["T_OBJECT_OPERATOR","->",709],["T_STRING","query",709],"(",["T_WHITESPACE","\n                    ",709],["T_VARIABLE","$this",710],["T_OBJECT_OPERATOR","->",710],["T_STRING","connection",710],["T_OBJECT_OPERATOR","->",710],["T_STRING","insertFromSelect",710],"(",["T_WHITESPACE","\n                        ",710],["T_VARIABLE","$select",711],",",["T_WHITESPACE","\n                        ",711],["T_VARIABLE","$this",712],["T_OBJECT_OPERATOR","->",712],["T_STRING","getMainTmpTable",712],"(",")",",",["T_WHITESPACE","\n                        ",712],"[",["T_CONSTANT_ENCAPSED_STRING","'category_id'",713],",",["T_WHITESPACE"," ",713],["T_CONSTANT_ENCAPSED_STRING","'product_id'",713],",",["T_WHITESPACE"," ",713],["T_CONSTANT_ENCAPSED_STRING","'position'",713],",",["T_WHITESPACE"," ",713],["T_CONSTANT_ENCAPSED_STRING","'is_parent'",713],",",["T_WHITESPACE"," ",713],["T_CONSTANT_ENCAPSED_STRING","'store_id'",713],",",["T_WHITESPACE"," ",713],["T_CONSTANT_ENCAPSED_STRING","'visibility'",713],"]",",",["T_WHITESPACE","\n                        ",713],["T_NS_SEPARATOR","\\",714],["T_STRING","Magento",714],["T_NS_SEPARATOR","\\",714],["T_STRING","Framework",714],["T_NS_SEPARATOR","\\",714],["T_STRING","DB",714],["T_NS_SEPARATOR","\\",714],["T_STRING","Adapter",714],["T_NS_SEPARATOR","\\",714],["T_STRING","AdapterInterface",714],["T_DOUBLE_COLON","::",714],["T_STRING","INSERT_ON_DUPLICATE",714],["T_WHITESPACE","\n                    ",714],")",["T_WHITESPACE","\n                ",715],")",";",["T_WHITESPACE","\n            ",716],"}",["T_WHITESPACE","\n        ",717],"}",["T_WHITESPACE","\n    ",718],"}",["T_WHITESPACE","\n\n    ",719],["T_DOC_COMMENT","\/**\n     * @return \\Magento\\Framework\\EntityManager\\MetadataPool\n     *\/",721],["T_WHITESPACE","\n    ",723],["T_PRIVATE","private",724],["T_WHITESPACE"," ",724],["T_FUNCTION","function",724],["T_WHITESPACE"," ",724],["T_STRING","getMetadataPool",724],"(",")",["T_WHITESPACE","\n    ",724],"{",["T_WHITESPACE","\n        ",725],["T_IF","if",726],["T_WHITESPACE"," ",726],"(",["T_STRING","null",726],["T_WHITESPACE"," ",726],["T_IS_IDENTICAL","===",726],["T_WHITESPACE"," ",726],["T_VARIABLE","$this",726],["T_OBJECT_OPERATOR","->",726],["T_STRING","metadataPool",726],")",["T_WHITESPACE"," ",726],"{",["T_WHITESPACE","\n            ",726],["T_VARIABLE","$this",727],["T_OBJECT_OPERATOR","->",727],["T_STRING","metadataPool",727],["T_WHITESPACE"," ",727],"=",["T_WHITESPACE"," ",727],["T_NS_SEPARATOR","\\",727],["T_STRING","Magento",727],["T_NS_SEPARATOR","\\",727],["T_STRING","Framework",727],["T_NS_SEPARATOR","\\",727],["T_STRING","App",727],["T_NS_SEPARATOR","\\",727],["T_STRING","ObjectManager",727],["T_DOUBLE_COLON","::",727],["T_STRING","getInstance",727],"(",")",["T_WHITESPACE","\n                ",727],["T_OBJECT_OPERATOR","->",728],["T_STRING","get",728],"(",["T_NS_SEPARATOR","\\",728],["T_STRING","Magento",728],["T_NS_SEPARATOR","\\",728],["T_STRING","Framework",728],["T_NS_SEPARATOR","\\",728],["T_STRING","EntityManager",728],["T_NS_SEPARATOR","\\",728],["T_STRING","MetadataPool",728],["T_DOUBLE_COLON","::",728],["T_CLASS","class",728],")",";",["T_WHITESPACE","\n        ",728],"}",["T_WHITESPACE","\n        ",729],["T_RETURN","return",730],["T_WHITESPACE"," ",730],["T_VARIABLE","$this",730],["T_OBJECT_OPERATOR","->",730],["T_STRING","metadataPool",730],";",["T_WHITESPACE","\n    ",730],"}",["T_WHITESPACE","\n",731],"}",["T_WHITESPACE","\n",732]]