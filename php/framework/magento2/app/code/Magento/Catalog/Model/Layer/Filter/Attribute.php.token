[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Catalog",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Layer",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Filter",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Layer attribute filter\n *\n * @SuppressWarnings(PHPMD.LongVariable)\n *\/",8],["T_WHITESPACE","\n",12],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","Attribute",13],["T_WHITESPACE"," ",13],["T_EXTENDS","extends",13],["T_WHITESPACE"," ",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Catalog",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Model",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Layer",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Filter",13],["T_NS_SEPARATOR","\\",13],["T_STRING","AbstractFilter",13],["T_WHITESPACE","\n",13],"{",["T_WHITESPACE","\n    ",14],["T_DOC_COMMENT","\/**\n     * Resource instance\n     *\n     * @var \\Magento\\Catalog\\Model\\ResourceModel\\Layer\\Filter\\Attribute\n     *\/",15],["T_WHITESPACE","\n    ",19],["T_PROTECTED","protected",20],["T_WHITESPACE"," ",20],["T_VARIABLE","$_resource",20],";",["T_WHITESPACE","\n\n    ",20],["T_DOC_COMMENT","\/**\n     * Magento string lib\n     *\n     * @var \\Magento\\Framework\\Stdlib\\StringUtils\n     *\/",22],["T_WHITESPACE","\n    ",26],["T_PROTECTED","protected",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$string",27],";",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Filter\\StripTags\n     *\/",29],["T_WHITESPACE","\n    ",31],["T_PROTECTED","protected",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$tagFilter",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * @param ItemFactory $filterItemFactory\n     * @param \\Magento\\Store\\Model\\StoreManagerInterface $storeManager\n     * @param \\Magento\\Catalog\\Model\\Layer $layer\n     * @param \\Magento\\Catalog\\Model\\Layer\\Filter\\Item\\DataBuilder $itemDataBuilder\n     * @param \\Magento\\Catalog\\Model\\ResourceModel\\Layer\\Filter\\AttributeFactory $filterAttributeFactory\n     * @param \\Magento\\Framework\\Stdlib\\StringUtils $string\n     * @param \\Magento\\Framework\\Filter\\StripTags $tagFilter\n     * @param array $data\n     *\/",34],["T_WHITESPACE","\n    ",43],["T_PUBLIC","public",44],["T_WHITESPACE"," ",44],["T_FUNCTION","function",44],["T_WHITESPACE"," ",44],["T_STRING","__construct",44],"(",["T_WHITESPACE","\n        ",44],["T_NS_SEPARATOR","\\",45],["T_STRING","Magento",45],["T_NS_SEPARATOR","\\",45],["T_STRING","Catalog",45],["T_NS_SEPARATOR","\\",45],["T_STRING","Model",45],["T_NS_SEPARATOR","\\",45],["T_STRING","Layer",45],["T_NS_SEPARATOR","\\",45],["T_STRING","Filter",45],["T_NS_SEPARATOR","\\",45],["T_STRING","ItemFactory",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$filterItemFactory",45],",",["T_WHITESPACE","\n        ",45],["T_NS_SEPARATOR","\\",46],["T_STRING","Magento",46],["T_NS_SEPARATOR","\\",46],["T_STRING","Store",46],["T_NS_SEPARATOR","\\",46],["T_STRING","Model",46],["T_NS_SEPARATOR","\\",46],["T_STRING","StoreManagerInterface",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$storeManager",46],",",["T_WHITESPACE","\n        ",46],["T_NS_SEPARATOR","\\",47],["T_STRING","Magento",47],["T_NS_SEPARATOR","\\",47],["T_STRING","Catalog",47],["T_NS_SEPARATOR","\\",47],["T_STRING","Model",47],["T_NS_SEPARATOR","\\",47],["T_STRING","Layer",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$layer",47],",",["T_WHITESPACE","\n        ",47],["T_NS_SEPARATOR","\\",48],["T_STRING","Magento",48],["T_NS_SEPARATOR","\\",48],["T_STRING","Catalog",48],["T_NS_SEPARATOR","\\",48],["T_STRING","Model",48],["T_NS_SEPARATOR","\\",48],["T_STRING","Layer",48],["T_NS_SEPARATOR","\\",48],["T_STRING","Filter",48],["T_NS_SEPARATOR","\\",48],["T_STRING","Item",48],["T_NS_SEPARATOR","\\",48],["T_STRING","DataBuilder",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$itemDataBuilder",48],",",["T_WHITESPACE","\n        ",48],["T_NS_SEPARATOR","\\",49],["T_STRING","Magento",49],["T_NS_SEPARATOR","\\",49],["T_STRING","Catalog",49],["T_NS_SEPARATOR","\\",49],["T_STRING","Model",49],["T_NS_SEPARATOR","\\",49],["T_STRING","ResourceModel",49],["T_NS_SEPARATOR","\\",49],["T_STRING","Layer",49],["T_NS_SEPARATOR","\\",49],["T_STRING","Filter",49],["T_NS_SEPARATOR","\\",49],["T_STRING","AttributeFactory",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$filterAttributeFactory",49],",",["T_WHITESPACE","\n        ",49],["T_NS_SEPARATOR","\\",50],["T_STRING","Magento",50],["T_NS_SEPARATOR","\\",50],["T_STRING","Framework",50],["T_NS_SEPARATOR","\\",50],["T_STRING","Stdlib",50],["T_NS_SEPARATOR","\\",50],["T_STRING","StringUtils",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$string",50],",",["T_WHITESPACE","\n        ",50],["T_NS_SEPARATOR","\\",51],["T_STRING","Magento",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Framework",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Filter",51],["T_NS_SEPARATOR","\\",51],["T_STRING","StripTags",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$tagFilter",51],",",["T_WHITESPACE","\n        ",51],["T_ARRAY","array",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$data",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],"[","]",["T_WHITESPACE","\n    ",52],")",["T_WHITESPACE"," ",53],"{",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","_resource",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$filterAttributeFactory",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","create",54],"(",")",";",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","string",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_VARIABLE","$string",55],";",["T_WHITESPACE","\n        ",55],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","_requestVar",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_CONSTANT_ENCAPSED_STRING","'attribute'",56],";",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","tagFilter",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$tagFilter",57],";",["T_WHITESPACE","\n        ",57],["T_STRING","parent",58],["T_DOUBLE_COLON","::",58],["T_STRING","__construct",58],"(",["T_VARIABLE","$filterItemFactory",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$storeManager",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$layer",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$itemDataBuilder",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$data",58],")",";",["T_WHITESPACE","\n    ",58],"}",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * Retrieve resource instance\n     *\n     * @return \\Magento\\Catalog\\Model\\ResourceModel\\Layer\\Filter\\Attribute\n     *\/",61],["T_WHITESPACE","\n    ",65],["T_PROTECTED","protected",66],["T_WHITESPACE"," ",66],["T_FUNCTION","function",66],["T_WHITESPACE"," ",66],["T_STRING","_getResource",66],"(",")",["T_WHITESPACE","\n    ",66],"{",["T_WHITESPACE","\n        ",67],["T_RETURN","return",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","_resource",68],";",["T_WHITESPACE","\n    ",68],"}",["T_WHITESPACE","\n\n    ",69],["T_DOC_COMMENT","\/**\n     * Apply attribute option filter to product collection\n     *\n     * @param   \\Magento\\Framework\\App\\RequestInterface $request\n     * @return  $this\n     *\/",71],["T_WHITESPACE","\n    ",76],["T_PUBLIC","public",77],["T_WHITESPACE"," ",77],["T_FUNCTION","function",77],["T_WHITESPACE"," ",77],["T_STRING","apply",77],"(",["T_NS_SEPARATOR","\\",77],["T_STRING","Magento",77],["T_NS_SEPARATOR","\\",77],["T_STRING","Framework",77],["T_NS_SEPARATOR","\\",77],["T_STRING","App",77],["T_NS_SEPARATOR","\\",77],["T_STRING","RequestInterface",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$request",77],")",["T_WHITESPACE","\n    ",77],"{",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$filter",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$request",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","getParam",79],"(",["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","_requestVar",79],")",";",["T_WHITESPACE","\n        ",79],["T_IF","if",80],["T_WHITESPACE"," ",80],"(",["T_STRING","is_array",80],"(",["T_VARIABLE","$filter",80],")",")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n            ",80],["T_RETURN","return",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],";",["T_WHITESPACE","\n        ",81],"}",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$text",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","getOptionText",83],"(",["T_VARIABLE","$filter",83],")",";",["T_WHITESPACE","\n        ",83],["T_IF","if",84],["T_WHITESPACE"," ",84],"(",["T_VARIABLE","$filter",84],["T_WHITESPACE"," ",84],["T_BOOLEAN_AND","&&",84],["T_WHITESPACE"," ",84],["T_STRING","strlen",84],"(",["T_VARIABLE","$text",84],")",")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n            ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","_getResource",85],"(",")",["T_OBJECT_OPERATOR","->",85],["T_STRING","applyFilterToCollection",85],"(",["T_VARIABLE","$this",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$filter",85],")",";",["T_WHITESPACE","\n            ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getLayer",86],"(",")",["T_OBJECT_OPERATOR","->",86],["T_STRING","getState",86],"(",")",["T_OBJECT_OPERATOR","->",86],["T_STRING","addFilter",86],"(",["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","_createItem",86],"(",["T_VARIABLE","$text",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$filter",86],")",")",";",["T_WHITESPACE","\n            ",86],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","_items",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],"[","]",";",["T_WHITESPACE","\n        ",87],"}",["T_WHITESPACE","\n        ",88],["T_RETURN","return",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],";",["T_WHITESPACE","\n    ",89],"}",["T_WHITESPACE","\n\n    ",90],["T_DOC_COMMENT","\/**\n     * Get data array for building attribute filter items\n     *\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     * @return array\n     *\/",92],["T_WHITESPACE","\n    ",97],["T_PROTECTED","protected",98],["T_WHITESPACE"," ",98],["T_FUNCTION","function",98],["T_WHITESPACE"," ",98],["T_STRING","_getItemsData",98],"(",")",["T_WHITESPACE","\n    ",98],"{",["T_WHITESPACE","\n        ",99],["T_VARIABLE","$attribute",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getAttributeModel",100],"(",")",";",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","_requestVar",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$attribute",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getAttributeCode",101],"(",")",";",["T_WHITESPACE","\n\n        ",101],["T_VARIABLE","$options",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$attribute",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getFrontend",103],"(",")",["T_OBJECT_OPERATOR","->",103],["T_STRING","getSelectOptions",103],"(",")",";",["T_WHITESPACE","\n        ",103],["T_VARIABLE","$optionsCount",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","_getResource",104],"(",")",["T_OBJECT_OPERATOR","->",104],["T_STRING","getCount",104],"(",["T_VARIABLE","$this",104],")",";",["T_WHITESPACE","\n        ",104],["T_FOREACH","foreach",105],["T_WHITESPACE"," ",105],"(",["T_VARIABLE","$options",105],["T_WHITESPACE"," ",105],["T_AS","as",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$option",105],")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n            ",105],["T_IF","if",106],["T_WHITESPACE"," ",106],"(",["T_STRING","is_array",106],"(",["T_VARIABLE","$option",106],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",106],"]",")",")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n                ",106],["T_CONTINUE","continue",107],";",["T_WHITESPACE","\n            ",107],"}",["T_WHITESPACE","\n            ",108],["T_IF","if",109],["T_WHITESPACE"," ",109],"(",["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","string",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","strlen",109],"(",["T_VARIABLE","$option",109],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",109],"]",")",")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n                ",109],["T_COMMENT","\/\/ Check filter type\n",110],["T_WHITESPACE","                ",111],["T_IF","if",111],["T_WHITESPACE"," ",111],"(",["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","getAttributeIsFilterable",111],"(",["T_VARIABLE","$attribute",111],")",["T_WHITESPACE"," ",111],["T_IS_EQUAL","==",111],["T_WHITESPACE"," ",111],["T_STRING","self",111],["T_DOUBLE_COLON","::",111],["T_STRING","ATTRIBUTE_OPTIONS_ONLY_WITH_RESULTS",111],")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n                    ",111],["T_IF","if",112],["T_WHITESPACE"," ",112],"(","!",["T_EMPTY","empty",112],"(",["T_VARIABLE","$optionsCount",112],"[",["T_VARIABLE","$option",112],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",112],"]","]",")",")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n                        ",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","itemDataBuilder",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","addItemData",113],"(",["T_WHITESPACE","\n                            ",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","tagFilter",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","filter",114],"(",["T_VARIABLE","$option",114],"[",["T_CONSTANT_ENCAPSED_STRING","'label'",114],"]",")",",",["T_WHITESPACE","\n                            ",114],["T_VARIABLE","$option",115],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",115],"]",",",["T_WHITESPACE","\n                            ",115],["T_VARIABLE","$optionsCount",116],"[",["T_VARIABLE","$option",116],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",116],"]","]",["T_WHITESPACE","\n                        ",116],")",";",["T_WHITESPACE","\n                    ",117],"}",["T_WHITESPACE","\n                ",118],"}",["T_WHITESPACE"," ",119],["T_ELSE","else",119],["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n                    ",119],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","itemDataBuilder",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","addItemData",120],"(",["T_WHITESPACE","\n                        ",120],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","tagFilter",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","filter",121],"(",["T_VARIABLE","$option",121],"[",["T_CONSTANT_ENCAPSED_STRING","'label'",121],"]",")",",",["T_WHITESPACE","\n                        ",121],["T_VARIABLE","$option",122],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",122],"]",",",["T_WHITESPACE","\n                        ",122],["T_ISSET","isset",123],"(",["T_VARIABLE","$optionsCount",123],"[",["T_VARIABLE","$option",123],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",123],"]","]",")",["T_WHITESPACE"," ",123],"?",["T_WHITESPACE"," ",123],["T_VARIABLE","$optionsCount",123],"[",["T_VARIABLE","$option",123],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",123],"]","]",["T_WHITESPACE"," ",123],":",["T_WHITESPACE"," ",123],["T_LNUMBER","0",123],["T_WHITESPACE","\n                    ",123],")",";",["T_WHITESPACE","\n                ",124],"}",["T_WHITESPACE","\n            ",125],"}",["T_WHITESPACE","\n        ",126],"}",["T_WHITESPACE","\n\n        ",127],["T_RETURN","return",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","itemDataBuilder",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","build",129],"(",")",";",["T_WHITESPACE","\n    ",129],"}",["T_WHITESPACE","\n",130],"}",["T_WHITESPACE","\n",131]]