[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Catalog",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Product",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Compare",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Catalog",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Model",8],["T_NS_SEPARATOR","\\",8],["T_STRING","ResourceModel",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Product",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Compare",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Item",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Collection",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * Product Compare List Model\n *\n * @SuppressWarnings(PHPMD.LongVariable)\n *\/",10],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","ListCompare",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Magento",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Framework",15],["T_NS_SEPARATOR","\\",15],["T_STRING","DataObject",15],["T_WHITESPACE","\n",15],"{",["T_WHITESPACE","\n    ",16],["T_DOC_COMMENT","\/**\n     * Customer visitor\n     *\n     * @var \\Magento\\Customer\\Model\\Visitor\n     *\/",17],["T_WHITESPACE","\n    ",21],["T_PROTECTED","protected",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$_customerVisitor",22],";",["T_WHITESPACE","\n\n    ",22],["T_DOC_COMMENT","\/**\n     * Customer session\n     *\n     * @var \\Magento\\Customer\\Model\\Session\n     *\/",24],["T_WHITESPACE","\n    ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$_customerSession",29],";",["T_WHITESPACE","\n\n    ",29],["T_DOC_COMMENT","\/**\n     * Catalog product compare item\n     *\n     * @var \\Magento\\Catalog\\Model\\ResourceModel\\Product\\Compare\\Item\n     *\/",31],["T_WHITESPACE","\n    ",35],["T_PROTECTED","protected",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$_catalogProductCompareItem",36],";",["T_WHITESPACE","\n\n    ",36],["T_DOC_COMMENT","\/**\n     * Item collection factory\n     *\n     * @var \\Magento\\Catalog\\Model\\ResourceModel\\Product\\Compare\\Item\\CollectionFactory\n     *\/",38],["T_WHITESPACE","\n    ",42],["T_PROTECTED","protected",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$_itemCollectionFactory",43],";",["T_WHITESPACE","\n\n    ",43],["T_DOC_COMMENT","\/**\n     * Compare item factory\n     *\n     * @var \\Magento\\Catalog\\Model\\Product\\Compare\\ItemFactory\n     *\/",45],["T_WHITESPACE","\n    ",49],["T_PROTECTED","protected",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$_compareItemFactory",50],";",["T_WHITESPACE","\n\n    ",50],["T_DOC_COMMENT","\/**\n     * Constructor\n     *\n     * @param \\Magento\\Catalog\\Model\\Product\\Compare\\ItemFactory $compareItemFactory\n     * @param \\Magento\\Catalog\\Model\\ResourceModel\\Product\\Compare\\Item\\CollectionFactory $itemCollectionFactory\n     * @param \\Magento\\Catalog\\Model\\ResourceModel\\Product\\Compare\\Item $catalogProductCompareItem\n     * @param \\Magento\\Customer\\Model\\Session $customerSession\n     * @param \\Magento\\Customer\\Model\\Visitor $customerVisitor\n     * @param array $data\n     *\/",52],["T_WHITESPACE","\n    ",61],["T_PUBLIC","public",62],["T_WHITESPACE"," ",62],["T_FUNCTION","function",62],["T_WHITESPACE"," ",62],["T_STRING","__construct",62],"(",["T_WHITESPACE","\n        ",62],["T_NS_SEPARATOR","\\",63],["T_STRING","Magento",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Catalog",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Model",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Product",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Compare",63],["T_NS_SEPARATOR","\\",63],["T_STRING","ItemFactory",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$compareItemFactory",63],",",["T_WHITESPACE","\n        ",63],["T_NS_SEPARATOR","\\",64],["T_STRING","Magento",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Catalog",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Model",64],["T_NS_SEPARATOR","\\",64],["T_STRING","ResourceModel",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Product",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Compare",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Item",64],["T_NS_SEPARATOR","\\",64],["T_STRING","CollectionFactory",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$itemCollectionFactory",64],",",["T_WHITESPACE","\n        ",64],["T_NS_SEPARATOR","\\",65],["T_STRING","Magento",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Catalog",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Model",65],["T_NS_SEPARATOR","\\",65],["T_STRING","ResourceModel",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Product",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Compare",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Item",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$catalogProductCompareItem",65],",",["T_WHITESPACE","\n        ",65],["T_NS_SEPARATOR","\\",66],["T_STRING","Magento",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Customer",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Model",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Session",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$customerSession",66],",",["T_WHITESPACE","\n        ",66],["T_NS_SEPARATOR","\\",67],["T_STRING","Magento",67],["T_NS_SEPARATOR","\\",67],["T_STRING","Customer",67],["T_NS_SEPARATOR","\\",67],["T_STRING","Model",67],["T_NS_SEPARATOR","\\",67],["T_STRING","Visitor",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$customerVisitor",67],",",["T_WHITESPACE","\n        ",67],["T_ARRAY","array",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$data",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],"[","]",["T_WHITESPACE","\n    ",68],")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n        ",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","_compareItemFactory",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$compareItemFactory",70],";",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","_itemCollectionFactory",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$itemCollectionFactory",71],";",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","_catalogProductCompareItem",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_VARIABLE","$catalogProductCompareItem",72],";",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","_customerSession",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$customerSession",73],";",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","_customerVisitor",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$customerVisitor",74],";",["T_WHITESPACE","\n        ",74],["T_STRING","parent",75],["T_DOUBLE_COLON","::",75],["T_STRING","__construct",75],"(",["T_VARIABLE","$data",75],")",";",["T_WHITESPACE","\n    ",75],"}",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * Add product to Compare List\n     *\n     * @param int|\\Magento\\Catalog\\Model\\Product $product\n     * @return $this\n     *\/",78],["T_WHITESPACE","\n    ",83],["T_PUBLIC","public",84],["T_WHITESPACE"," ",84],["T_FUNCTION","function",84],["T_WHITESPACE"," ",84],["T_STRING","addProduct",84],"(",["T_VARIABLE","$product",84],")",["T_WHITESPACE","\n    ",84],"{",["T_WHITESPACE","\n        ",85],["T_COMMENT","\/* @var $item \\Magento\\Catalog\\Model\\Product\\Compare\\Item *\/",86],["T_WHITESPACE","\n        ",86],["T_VARIABLE","$item",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","_compareItemFactory",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","create",87],"(",")",";",["T_WHITESPACE","\n        ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","_addVisitorToItem",88],"(",["T_VARIABLE","$item",88],")",";",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$item",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","loadByProduct",89],"(",["T_VARIABLE","$product",89],")",";",["T_WHITESPACE","\n\n        ",89],["T_IF","if",91],["T_WHITESPACE"," ",91],"(","!",["T_VARIABLE","$item",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getId",91],"(",")",")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n            ",91],["T_VARIABLE","$item",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","addProductData",92],"(",["T_VARIABLE","$product",92],")",";",["T_WHITESPACE","\n            ",92],["T_VARIABLE","$item",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","save",93],"(",")",";",["T_WHITESPACE","\n        ",93],"}",["T_WHITESPACE","\n\n        ",94],["T_RETURN","return",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$this",96],";",["T_WHITESPACE","\n    ",96],"}",["T_WHITESPACE","\n\n    ",97],["T_DOC_COMMENT","\/**\n     * Add products to compare list\n     *\n     * @param string[] $productIds\n     * @return $this\n     *\/",99],["T_WHITESPACE","\n    ",104],["T_PUBLIC","public",105],["T_WHITESPACE"," ",105],["T_FUNCTION","function",105],["T_WHITESPACE"," ",105],["T_STRING","addProducts",105],"(",["T_VARIABLE","$productIds",105],")",["T_WHITESPACE","\n    ",105],"{",["T_WHITESPACE","\n        ",106],["T_IF","if",107],["T_WHITESPACE"," ",107],"(",["T_STRING","is_array",107],"(",["T_VARIABLE","$productIds",107],")",")",["T_WHITESPACE"," ",107],"{",["T_WHITESPACE","\n            ",107],["T_FOREACH","foreach",108],["T_WHITESPACE"," ",108],"(",["T_VARIABLE","$productIds",108],["T_WHITESPACE"," ",108],["T_AS","as",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$productId",108],")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n                ",108],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","addProduct",109],"(",["T_VARIABLE","$productId",109],")",";",["T_WHITESPACE","\n            ",109],"}",["T_WHITESPACE","\n        ",110],"}",["T_WHITESPACE","\n        ",111],["T_RETURN","return",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],";",["T_WHITESPACE","\n    ",112],"}",["T_WHITESPACE","\n\n    ",113],["T_DOC_COMMENT","\/**\n     * Retrieve Compare Items Collection\n     *\n     * @return Collection\n     *\/",115],["T_WHITESPACE","\n    ",119],["T_PUBLIC","public",120],["T_WHITESPACE"," ",120],["T_FUNCTION","function",120],["T_WHITESPACE"," ",120],["T_STRING","getItemCollection",120],"(",")",["T_WHITESPACE","\n    ",120],"{",["T_WHITESPACE","\n        ",121],["T_RETURN","return",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","_itemCollectionFactory",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","create",122],"(",")",";",["T_WHITESPACE","\n    ",122],"}",["T_WHITESPACE","\n\n    ",123],["T_DOC_COMMENT","\/**\n     * Remove product from compare list\n     *\n     * @param int|\\Magento\\Catalog\\Model\\Product $product\n     * @return $this\n     *\/",125],["T_WHITESPACE","\n    ",130],["T_PUBLIC","public",131],["T_WHITESPACE"," ",131],["T_FUNCTION","function",131],["T_WHITESPACE"," ",131],["T_STRING","removeProduct",131],"(",["T_VARIABLE","$product",131],")",["T_WHITESPACE","\n    ",131],"{",["T_WHITESPACE","\n        ",132],["T_COMMENT","\/* @var $item \\Magento\\Catalog\\Model\\Product\\Compare\\Item *\/",133],["T_WHITESPACE","\n        ",133],["T_VARIABLE","$item",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","_compareItemFactory",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","create",134],"(",")",";",["T_WHITESPACE","\n        ",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","_addVisitorToItem",135],"(",["T_VARIABLE","$item",135],")",";",["T_WHITESPACE","\n        ",135],["T_VARIABLE","$item",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","loadByProduct",136],"(",["T_VARIABLE","$product",136],")",";",["T_WHITESPACE","\n\n        ",136],["T_IF","if",138],["T_WHITESPACE"," ",138],"(",["T_VARIABLE","$item",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","getId",138],"(",")",")",["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n            ",138],["T_VARIABLE","$item",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","delete",139],"(",")",";",["T_WHITESPACE","\n        ",139],"}",["T_WHITESPACE","\n\n        ",140],["T_RETURN","return",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],";",["T_WHITESPACE","\n    ",142],"}",["T_WHITESPACE","\n\n    ",143],["T_DOC_COMMENT","\/**\n     * Add visitor and customer data to compare item\n     *\n     * @param \\Magento\\Catalog\\Model\\Product\\Compare\\Item $item\n     * @return $this\n     *\/",145],["T_WHITESPACE","\n    ",150],["T_PROTECTED","protected",151],["T_WHITESPACE"," ",151],["T_FUNCTION","function",151],["T_WHITESPACE"," ",151],["T_STRING","_addVisitorToItem",151],"(",["T_VARIABLE","$item",151],")",["T_WHITESPACE","\n    ",151],"{",["T_WHITESPACE","\n        ",152],["T_VARIABLE","$item",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","addVisitorId",153],"(",["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","_customerVisitor",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","getId",153],"(",")",")",";",["T_WHITESPACE","\n        ",153],["T_IF","if",154],["T_WHITESPACE"," ",154],"(",["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","_customerSession",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","isLoggedIn",154],"(",")",")",["T_WHITESPACE"," ",154],"{",["T_WHITESPACE","\n            ",154],["T_VARIABLE","$item",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","setCustomerId",155],"(",["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","_customerSession",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","getCustomerId",155],"(",")",")",";",["T_WHITESPACE","\n        ",155],"}",["T_WHITESPACE","\n\n        ",156],["T_RETURN","return",158],["T_WHITESPACE"," ",158],["T_VARIABLE","$this",158],";",["T_WHITESPACE","\n    ",158],"}",["T_WHITESPACE","\n\n    ",159],["T_DOC_COMMENT","\/**\n     * Check has compare items by visitor\/customer\n     *\n     * @param int $customerId\n     * @param int $visitorId\n     * @return bool\n     *\/",161],["T_WHITESPACE","\n    ",167],["T_PUBLIC","public",168],["T_WHITESPACE"," ",168],["T_FUNCTION","function",168],["T_WHITESPACE"," ",168],["T_STRING","hasItems",168],"(",["T_VARIABLE","$customerId",168],",",["T_WHITESPACE"," ",168],["T_VARIABLE","$visitorId",168],")",["T_WHITESPACE","\n    ",168],"{",["T_WHITESPACE","\n        ",169],["T_RETURN","return",170],["T_WHITESPACE"," ",170],["T_BOOL_CAST","(bool)",170],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","_catalogProductCompareItem",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","getCount",170],"(",["T_VARIABLE","$customerId",170],",",["T_WHITESPACE"," ",170],["T_VARIABLE","$visitorId",170],")",";",["T_WHITESPACE","\n    ",170],"}",["T_WHITESPACE","\n",171],"}",["T_WHITESPACE","\n",172]]