[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Catalog",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Indexer",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Product",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Price",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Abstract action reindex class\n *\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",8],["T_WHITESPACE","\n",12],["T_ABSTRACT","abstract",13],["T_WHITESPACE"," ",13],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","AbstractAction",13],["T_WHITESPACE","\n",13],"{",["T_WHITESPACE","\n    ",14],["T_DOC_COMMENT","\/**\n     * Default Product Type Price indexer resource model\n     *\n     * @var \\Magento\\Catalog\\Model\\ResourceModel\\Product\\Indexer\\Price\\DefaultPrice\n     *\/",15],["T_WHITESPACE","\n    ",19],["T_PROTECTED","protected",20],["T_WHITESPACE"," ",20],["T_VARIABLE","$_defaultIndexerResource",20],";",["T_WHITESPACE","\n\n    ",20],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\DB\\Adapter\\AdapterInterface\n     *\/",22],["T_WHITESPACE","\n    ",24],["T_PROTECTED","protected",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$_connection",25],";",["T_WHITESPACE","\n\n    ",25],["T_DOC_COMMENT","\/**\n     * Core config model\n     *\n     * @var \\Magento\\Framework\\App\\Config\\ScopeConfigInterface\n     *\/",27],["T_WHITESPACE","\n    ",31],["T_PROTECTED","protected",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$_config",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Store\\Model\\StoreManagerInterface\n     *\/",34],["T_WHITESPACE","\n    ",36],["T_PROTECTED","protected",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$_storeManager",37],";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * Currency factory\n     *\n     * @var \\Magento\\Directory\\Model\\CurrencyFactory\n     *\/",39],["T_WHITESPACE","\n    ",43],["T_PROTECTED","protected",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$_currencyFactory",44],";",["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Stdlib\\DateTime\\TimezoneInterface\n     *\/",46],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_localeDate",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Stdlib\\DateTime\n     *\/",51],["T_WHITESPACE","\n    ",53],["T_PROTECTED","protected",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$_dateTime",54],";",["T_WHITESPACE","\n\n    ",54],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Catalog\\Model\\Product\\Type\n     *\/",56],["T_WHITESPACE","\n    ",58],["T_PROTECTED","protected",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$_catalogProductType",59],";",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * Indexer price factory\n     *\n     * @var \\Magento\\Catalog\\Model\\ResourceModel\\Product\\Indexer\\Price\\Factory\n     *\/",61],["T_WHITESPACE","\n    ",65],["T_PROTECTED","protected",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$_indexerPriceFactory",66],";",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * @var array|null\n     *\/",68],["T_WHITESPACE","\n    ",70],["T_PROTECTED","protected",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$_indexers",71],";",["T_WHITESPACE","\n\n    ",71],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Catalog\\Model\\ResourceModel\\Product\n     *\/",73],["T_WHITESPACE","\n    ",75],["T_PRIVATE","private",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$productResource",76],";",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\App\\Config\\ScopeConfigInterface $config\n     * @param \\Magento\\Store\\Model\\StoreManagerInterface $storeManager\n     * @param \\Magento\\Directory\\Model\\CurrencyFactory $currencyFactory\n     * @param \\Magento\\Framework\\Stdlib\\DateTime\\TimezoneInterface $localeDate\n     * @param \\Magento\\Framework\\Stdlib\\DateTime $dateTime\n     * @param \\Magento\\Catalog\\Model\\Product\\Type $catalogProductType\n     * @param \\Magento\\Catalog\\Model\\ResourceModel\\Product\\Indexer\\Price\\Factory $indexerPriceFactory\n     * @param \\Magento\\Catalog\\Model\\ResourceModel\\Product\\Indexer\\Price\\DefaultPrice $defaultIndexerResource\n     *\/",78],["T_WHITESPACE","\n    ",87],["T_PUBLIC","public",88],["T_WHITESPACE"," ",88],["T_FUNCTION","function",88],["T_WHITESPACE"," ",88],["T_STRING","__construct",88],"(",["T_WHITESPACE","\n        ",88],["T_NS_SEPARATOR","\\",89],["T_STRING","Magento",89],["T_NS_SEPARATOR","\\",89],["T_STRING","Framework",89],["T_NS_SEPARATOR","\\",89],["T_STRING","App",89],["T_NS_SEPARATOR","\\",89],["T_STRING","Config",89],["T_NS_SEPARATOR","\\",89],["T_STRING","ScopeConfigInterface",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$config",89],",",["T_WHITESPACE","\n        ",89],["T_NS_SEPARATOR","\\",90],["T_STRING","Magento",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Store",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Model",90],["T_NS_SEPARATOR","\\",90],["T_STRING","StoreManagerInterface",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$storeManager",90],",",["T_WHITESPACE","\n        ",90],["T_NS_SEPARATOR","\\",91],["T_STRING","Magento",91],["T_NS_SEPARATOR","\\",91],["T_STRING","Directory",91],["T_NS_SEPARATOR","\\",91],["T_STRING","Model",91],["T_NS_SEPARATOR","\\",91],["T_STRING","CurrencyFactory",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$currencyFactory",91],",",["T_WHITESPACE","\n        ",91],["T_NS_SEPARATOR","\\",92],["T_STRING","Magento",92],["T_NS_SEPARATOR","\\",92],["T_STRING","Framework",92],["T_NS_SEPARATOR","\\",92],["T_STRING","Stdlib",92],["T_NS_SEPARATOR","\\",92],["T_STRING","DateTime",92],["T_NS_SEPARATOR","\\",92],["T_STRING","TimezoneInterface",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$localeDate",92],",",["T_WHITESPACE","\n        ",92],["T_NS_SEPARATOR","\\",93],["T_STRING","Magento",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Framework",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Stdlib",93],["T_NS_SEPARATOR","\\",93],["T_STRING","DateTime",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$dateTime",93],",",["T_WHITESPACE","\n        ",93],["T_NS_SEPARATOR","\\",94],["T_STRING","Magento",94],["T_NS_SEPARATOR","\\",94],["T_STRING","Catalog",94],["T_NS_SEPARATOR","\\",94],["T_STRING","Model",94],["T_NS_SEPARATOR","\\",94],["T_STRING","Product",94],["T_NS_SEPARATOR","\\",94],["T_STRING","Type",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$catalogProductType",94],",",["T_WHITESPACE","\n        ",94],["T_NS_SEPARATOR","\\",95],["T_STRING","Magento",95],["T_NS_SEPARATOR","\\",95],["T_STRING","Catalog",95],["T_NS_SEPARATOR","\\",95],["T_STRING","Model",95],["T_NS_SEPARATOR","\\",95],["T_STRING","ResourceModel",95],["T_NS_SEPARATOR","\\",95],["T_STRING","Product",95],["T_NS_SEPARATOR","\\",95],["T_STRING","Indexer",95],["T_NS_SEPARATOR","\\",95],["T_STRING","Price",95],["T_NS_SEPARATOR","\\",95],["T_STRING","Factory",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$indexerPriceFactory",95],",",["T_WHITESPACE","\n        ",95],["T_NS_SEPARATOR","\\",96],["T_STRING","Magento",96],["T_NS_SEPARATOR","\\",96],["T_STRING","Catalog",96],["T_NS_SEPARATOR","\\",96],["T_STRING","Model",96],["T_NS_SEPARATOR","\\",96],["T_STRING","ResourceModel",96],["T_NS_SEPARATOR","\\",96],["T_STRING","Product",96],["T_NS_SEPARATOR","\\",96],["T_STRING","Indexer",96],["T_NS_SEPARATOR","\\",96],["T_STRING","Price",96],["T_NS_SEPARATOR","\\",96],["T_STRING","DefaultPrice",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$defaultIndexerResource",96],["T_WHITESPACE","\n    ",96],")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","_config",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$config",98],";",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","_storeManager",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_VARIABLE","$storeManager",99],";",["T_WHITESPACE","\n        ",99],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","_currencyFactory",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$currencyFactory",100],";",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","_localeDate",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$localeDate",101],";",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","_dateTime",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$dateTime",102],";",["T_WHITESPACE","\n        ",102],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","_catalogProductType",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$catalogProductType",103],";",["T_WHITESPACE","\n        ",103],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","_indexerPriceFactory",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$indexerPriceFactory",104],";",["T_WHITESPACE","\n        ",104],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","_defaultIndexerResource",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$defaultIndexerResource",105],";",["T_WHITESPACE","\n        ",105],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","_connection",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","_defaultIndexerResource",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","getConnection",106],"(",")",";",["T_WHITESPACE","\n    ",106],"}",["T_WHITESPACE","\n\n    ",107],["T_DOC_COMMENT","\/**\n     * Execute action for given ids\n     *\n     * @param array|int $ids\n     * @return void\n     *\/",109],["T_WHITESPACE","\n    ",114],["T_ABSTRACT","abstract",115],["T_WHITESPACE"," ",115],["T_PUBLIC","public",115],["T_WHITESPACE"," ",115],["T_FUNCTION","function",115],["T_WHITESPACE"," ",115],["T_STRING","execute",115],"(",["T_VARIABLE","$ids",115],")",";",["T_WHITESPACE","\n\n    ",115],["T_DOC_COMMENT","\/**\n     * Synchronize data between index storage and original storage\n     *\n     * @param array $processIds\n     * @return \\Magento\\Catalog\\Model\\Indexer\\Product\\Price\\AbstractAction\n     *\/",117],["T_WHITESPACE","\n    ",122],["T_PROTECTED","protected",123],["T_WHITESPACE"," ",123],["T_FUNCTION","function",123],["T_WHITESPACE"," ",123],["T_STRING","_syncData",123],"(",["T_ARRAY","array",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$processIds",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],"[","]",")",["T_WHITESPACE","\n    ",123],"{",["T_WHITESPACE","\n        ",124],["T_COMMENT","\/\/ delete invalid rows\n",125],["T_WHITESPACE","        ",126],["T_VARIABLE","$select",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","_connection",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","select",126],"(",")",["T_OBJECT_OPERATOR","->",126],["T_STRING","from",126],"(",["T_WHITESPACE","\n            ",126],"[",["T_CONSTANT_ENCAPSED_STRING","'index_price'",127],["T_WHITESPACE"," ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","_defaultIndexerResource",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","getTable",127],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_index_price'",127],")","]",",",["T_WHITESPACE","\n            ",127],["T_STRING","null",128],["T_WHITESPACE","\n        ",128],")",["T_OBJECT_OPERATOR","->",129],["T_STRING","joinLeft",129],"(",["T_WHITESPACE","\n            ",129],"[",["T_CONSTANT_ENCAPSED_STRING","'ip_tmp'",130],["T_WHITESPACE"," ",130],["T_DOUBLE_ARROW","=>",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","_defaultIndexerResource",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getIdxTable",130],"(",")","]",",",["T_WHITESPACE","\n            ",130],["T_CONSTANT_ENCAPSED_STRING","'index_price.entity_id = ip_tmp.entity_id AND index_price.website_id = ip_tmp.website_id'",131],",",["T_WHITESPACE","\n            ",131],"[","]",["T_WHITESPACE","\n        ",132],")",["T_OBJECT_OPERATOR","->",133],["T_STRING","where",133],"(",["T_WHITESPACE","\n            ",133],["T_CONSTANT_ENCAPSED_STRING","'ip_tmp.entity_id IS NULL'",134],["T_WHITESPACE","\n        ",134],")",";",["T_WHITESPACE","\n        ",135],["T_IF","if",136],["T_WHITESPACE"," ",136],"(","!",["T_EMPTY","empty",136],"(",["T_VARIABLE","$processIds",136],")",")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n            ",136],["T_VARIABLE","$select",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","where",137],"(",["T_CONSTANT_ENCAPSED_STRING","'index_price.entity_id IN(?)'",137],",",["T_WHITESPACE"," ",137],["T_VARIABLE","$processIds",137],")",";",["T_WHITESPACE","\n        ",137],"}",["T_WHITESPACE","\n        ",138],["T_VARIABLE","$sql",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$select",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","deleteFromSelect",139],"(",["T_CONSTANT_ENCAPSED_STRING","'index_price'",139],")",";",["T_WHITESPACE","\n        ",139],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","_connection",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","query",140],"(",["T_VARIABLE","$sql",140],")",";",["T_WHITESPACE","\n\n        ",140],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","_insertFromTable",142],"(",["T_WHITESPACE","\n            ",142],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","_defaultIndexerResource",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getIdxTable",143],"(",")",",",["T_WHITESPACE","\n            ",143],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","_defaultIndexerResource",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","getTable",144],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_index_price'",144],")",["T_WHITESPACE","\n        ",144],")",";",["T_WHITESPACE","\n        ",145],["T_RETURN","return",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$this",146],";",["T_WHITESPACE","\n    ",146],"}",["T_WHITESPACE","\n\n    ",147],["T_DOC_COMMENT","\/**\n     * Prepare website current dates table\n     *\n     * @return \\Magento\\Catalog\\Model\\Indexer\\Product\\Price\\AbstractAction\n     *\/",149],["T_WHITESPACE","\n    ",153],["T_PROTECTED","protected",154],["T_WHITESPACE"," ",154],["T_FUNCTION","function",154],["T_WHITESPACE"," ",154],["T_STRING","_prepareWebsiteDateTable",154],"(",")",["T_WHITESPACE","\n    ",154],"{",["T_WHITESPACE","\n        ",155],["T_VARIABLE","$baseCurrency",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","_config",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","getValue",156],"(",["T_NS_SEPARATOR","\\",156],["T_STRING","Magento",156],["T_NS_SEPARATOR","\\",156],["T_STRING","Directory",156],["T_NS_SEPARATOR","\\",156],["T_STRING","Model",156],["T_NS_SEPARATOR","\\",156],["T_STRING","Currency",156],["T_DOUBLE_COLON","::",156],["T_STRING","XML_PATH_CURRENCY_BASE",156],")",";",["T_WHITESPACE","\n\n        ",156],["T_VARIABLE","$select",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","_connection",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","select",158],"(",")",["T_OBJECT_OPERATOR","->",158],["T_STRING","from",158],"(",["T_WHITESPACE","\n            ",158],"[",["T_CONSTANT_ENCAPSED_STRING","'cw'",159],["T_WHITESPACE"," ",159],["T_DOUBLE_ARROW","=>",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","_defaultIndexerResource",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","getTable",159],"(",["T_CONSTANT_ENCAPSED_STRING","'store_website'",159],")","]",",",["T_WHITESPACE","\n            ",159],"[",["T_CONSTANT_ENCAPSED_STRING","'website_id'",160],"]",["T_WHITESPACE","\n        ",160],")",["T_OBJECT_OPERATOR","->",161],["T_STRING","join",161],"(",["T_WHITESPACE","\n            ",161],"[",["T_CONSTANT_ENCAPSED_STRING","'csg'",162],["T_WHITESPACE"," ",162],["T_DOUBLE_ARROW","=>",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","_defaultIndexerResource",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","getTable",162],"(",["T_CONSTANT_ENCAPSED_STRING","'store_group'",162],")","]",",",["T_WHITESPACE","\n            ",162],["T_CONSTANT_ENCAPSED_STRING","'cw.default_group_id = csg.group_id'",163],",",["T_WHITESPACE","\n            ",163],"[",["T_CONSTANT_ENCAPSED_STRING","'store_id'",164],["T_WHITESPACE"," ",164],["T_DOUBLE_ARROW","=>",164],["T_WHITESPACE"," ",164],["T_CONSTANT_ENCAPSED_STRING","'default_store_id'",164],"]",["T_WHITESPACE","\n        ",164],")",["T_OBJECT_OPERATOR","->",165],["T_STRING","where",165],"(",["T_WHITESPACE","\n            ",165],["T_CONSTANT_ENCAPSED_STRING","'cw.website_id != 0'",166],["T_WHITESPACE","\n        ",166],")",";",["T_WHITESPACE","\n\n        ",167],["T_VARIABLE","$data",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],"[","]",";",["T_WHITESPACE","\n        ",169],["T_FOREACH","foreach",170],["T_WHITESPACE"," ",170],"(",["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","_connection",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","fetchAll",170],"(",["T_VARIABLE","$select",170],")",["T_WHITESPACE"," ",170],["T_AS","as",170],["T_WHITESPACE"," ",170],["T_VARIABLE","$item",170],")",["T_WHITESPACE"," ",170],"{",["T_WHITESPACE","\n            ",170],["T_DOC_COMMENT","\/** @var $website \\Magento\\Store\\Model\\Website *\/",171],["T_WHITESPACE","\n            ",171],["T_VARIABLE","$website",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","_storeManager",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","getWebsite",172],"(",["T_VARIABLE","$item",172],"[",["T_CONSTANT_ENCAPSED_STRING","'website_id'",172],"]",")",";",["T_WHITESPACE","\n\n            ",172],["T_IF","if",174],["T_WHITESPACE"," ",174],"(",["T_VARIABLE","$website",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","getBaseCurrencyCode",174],"(",")",["T_WHITESPACE"," ",174],["T_IS_NOT_EQUAL","!=",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$baseCurrency",174],")",["T_WHITESPACE"," ",174],"{",["T_WHITESPACE","\n                ",174],["T_VARIABLE","$rate",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","_currencyFactory",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","create",175],"(",")",["T_OBJECT_OPERATOR","->",175],["T_STRING","load",175],"(",["T_WHITESPACE","\n                    ",175],["T_VARIABLE","$baseCurrency",176],["T_WHITESPACE","\n                ",176],")",["T_OBJECT_OPERATOR","->",177],["T_STRING","getRate",177],"(",["T_WHITESPACE","\n                    ",177],["T_VARIABLE","$website",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","getBaseCurrencyCode",178],"(",")",["T_WHITESPACE","\n                ",178],")",";",["T_WHITESPACE","\n                ",179],["T_IF","if",180],["T_WHITESPACE"," ",180],"(","!",["T_VARIABLE","$rate",180],")",["T_WHITESPACE"," ",180],"{",["T_WHITESPACE","\n                    ",180],["T_VARIABLE","$rate",181],["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_LNUMBER","1",181],";",["T_WHITESPACE","\n                ",181],"}",["T_WHITESPACE","\n            ",182],"}",["T_WHITESPACE"," ",183],["T_ELSE","else",183],["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n                ",183],["T_VARIABLE","$rate",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_LNUMBER","1",184],";",["T_WHITESPACE","\n            ",184],"}",["T_WHITESPACE","\n\n            ",185],["T_DOC_COMMENT","\/** @var $store \\Magento\\Store\\Model\\Store *\/",187],["T_WHITESPACE","\n            ",187],["T_VARIABLE","$store",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","_storeManager",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getStore",188],"(",["T_VARIABLE","$item",188],"[",["T_CONSTANT_ENCAPSED_STRING","'store_id'",188],"]",")",";",["T_WHITESPACE","\n            ",188],["T_IF","if",189],["T_WHITESPACE"," ",189],"(",["T_VARIABLE","$store",189],")",["T_WHITESPACE"," ",189],"{",["T_WHITESPACE","\n                ",189],["T_VARIABLE","$timestamp",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","_localeDate",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","scopeTimeStamp",190],"(",["T_VARIABLE","$store",190],")",";",["T_WHITESPACE","\n                ",190],["T_VARIABLE","$data",191],"[","]",["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],"[",["T_WHITESPACE","\n                    ",191],["T_CONSTANT_ENCAPSED_STRING","'website_id'",192],["T_WHITESPACE"," ",192],["T_DOUBLE_ARROW","=>",192],["T_WHITESPACE"," ",192],["T_VARIABLE","$website",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","getId",192],"(",")",",",["T_WHITESPACE","\n                    ",192],["T_CONSTANT_ENCAPSED_STRING","'website_date'",193],["T_WHITESPACE"," ",193],["T_DOUBLE_ARROW","=>",193],["T_WHITESPACE"," ",193],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","_dateTime",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","formatDate",193],"(",["T_VARIABLE","$timestamp",193],",",["T_WHITESPACE"," ",193],["T_STRING","false",193],")",",",["T_WHITESPACE","\n                    ",193],["T_CONSTANT_ENCAPSED_STRING","'rate'",194],["T_WHITESPACE"," ",194],["T_DOUBLE_ARROW","=>",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$rate",194],",",["T_WHITESPACE","\n                ",194],"]",";",["T_WHITESPACE","\n            ",195],"}",["T_WHITESPACE","\n        ",196],"}",["T_WHITESPACE","\n\n        ",197],["T_VARIABLE","$table",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","_defaultIndexerResource",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","getTable",199],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_index_website'",199],")",";",["T_WHITESPACE","\n        ",199],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","_emptyTable",200],"(",["T_VARIABLE","$table",200],")",";",["T_WHITESPACE","\n        ",200],["T_IF","if",201],["T_WHITESPACE"," ",201],"(",["T_VARIABLE","$data",201],")",["T_WHITESPACE"," ",201],"{",["T_WHITESPACE","\n            ",201],["T_FOREACH","foreach",202],["T_WHITESPACE"," ",202],"(",["T_VARIABLE","$data",202],["T_WHITESPACE"," ",202],["T_AS","as",202],["T_WHITESPACE"," ",202],["T_VARIABLE","$row",202],")",["T_WHITESPACE"," ",202],"{",["T_WHITESPACE","\n                ",202],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","_connection",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","insertOnDuplicate",203],"(",["T_VARIABLE","$table",203],",",["T_WHITESPACE"," ",203],["T_VARIABLE","$row",203],",",["T_WHITESPACE"," ",203],["T_STRING","array_keys",203],"(",["T_VARIABLE","$row",203],")",")",";",["T_WHITESPACE","\n            ",203],"}",["T_WHITESPACE","\n        ",204],"}",["T_WHITESPACE","\n\n        ",205],["T_RETURN","return",207],["T_WHITESPACE"," ",207],["T_VARIABLE","$this",207],";",["T_WHITESPACE","\n    ",207],"}",["T_WHITESPACE","\n\n    ",208],["T_DOC_COMMENT","\/**\n     * Prepare tier price index table\n     *\n     * @param int|array $entityIds the entity ids limitation\n     * @return \\Magento\\Catalog\\Model\\Indexer\\Product\\Price\\AbstractAction\n     *\/",210],["T_WHITESPACE","\n    ",215],["T_PROTECTED","protected",216],["T_WHITESPACE"," ",216],["T_FUNCTION","function",216],["T_WHITESPACE"," ",216],["T_STRING","_prepareTierPriceIndex",216],"(",["T_VARIABLE","$entityIds",216],["T_WHITESPACE"," ",216],"=",["T_WHITESPACE"," ",216],["T_STRING","null",216],")",["T_WHITESPACE","\n    ",216],"{",["T_WHITESPACE","\n        ",217],["T_VARIABLE","$table",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","_defaultIndexerResource",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","getTable",218],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_index_tier_price'",218],")",";",["T_WHITESPACE","\n        ",218],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","_emptyTable",219],"(",["T_VARIABLE","$table",219],")",";",["T_WHITESPACE","\n\n        ",219],["T_VARIABLE","$tierPriceExpression",221],["T_WHITESPACE"," ",221],"=",["T_WHITESPACE"," ",221],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","_connection",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","getCheckSql",221],"(",["T_WHITESPACE","\n            ",221],["T_CONSTANT_ENCAPSED_STRING","'tp.value = 0'",222],",",["T_WHITESPACE","\n            ",222],["T_CONSTANT_ENCAPSED_STRING","'product_price.value * (1 - tp.percentage_value \/ 100)'",223],",",["T_WHITESPACE","\n            ",223],["T_CONSTANT_ENCAPSED_STRING","'tp.value'",224],["T_WHITESPACE","\n        ",224],")",";",["T_WHITESPACE","\n        ",225],["T_VARIABLE","$websiteExpression",226],["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","_connection",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","getCheckSql",226],"(",["T_WHITESPACE","\n            ",226],["T_CONSTANT_ENCAPSED_STRING","'tp.website_id = 0'",227],",",["T_WHITESPACE","\n            ",227],["T_CONSTANT_ENCAPSED_STRING","'ROUND('",228],["T_WHITESPACE"," ",228],".",["T_WHITESPACE"," ",228],["T_VARIABLE","$tierPriceExpression",228],["T_WHITESPACE"," ",228],".",["T_WHITESPACE"," ",228],["T_CONSTANT_ENCAPSED_STRING","' * cwd.rate, 4)'",228],",",["T_WHITESPACE","\n            ",228],["T_VARIABLE","$tierPriceExpression",229],["T_WHITESPACE","\n        ",229],")",";",["T_WHITESPACE","\n        ",230],["T_VARIABLE","$linkField",231],["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","getProductIdFieldName",231],"(",")",";",["T_WHITESPACE","\n        ",231],["T_VARIABLE","$priceAttribute",232],["T_WHITESPACE"," ",232],"=",["T_WHITESPACE"," ",232],["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","getProductResource",232],"(",")",["T_OBJECT_OPERATOR","->",232],["T_STRING","getAttribute",232],"(",["T_CONSTANT_ENCAPSED_STRING","'price'",232],")",";",["T_WHITESPACE","\n\n        ",232],["T_VARIABLE","$select",234],["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","_connection",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","select",234],"(",")",["T_OBJECT_OPERATOR","->",234],["T_STRING","from",234],"(",["T_WHITESPACE","\n            ",234],"[",["T_CONSTANT_ENCAPSED_STRING","'cpe'",235],["T_WHITESPACE"," ",235],["T_DOUBLE_ARROW","=>",235],["T_WHITESPACE"," ",235],["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","_defaultIndexerResource",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","getTable",235],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity'",235],")","]",",",["T_WHITESPACE","\n            ",235],"[",["T_CONSTANT_ENCAPSED_STRING","'cpe.entity_id'",236],"]",["T_WHITESPACE","\n        ",236],")",["T_OBJECT_OPERATOR","->",237],["T_STRING","join",237],"(",["T_WHITESPACE","\n            ",237],"[",["T_CONSTANT_ENCAPSED_STRING","'tp'",238],["T_WHITESPACE"," ",238],["T_DOUBLE_ARROW","=>",238],["T_WHITESPACE"," ",238],["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","_defaultIndexerResource",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","getTable",238],"(","[",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity'",238],",",["T_WHITESPACE"," ",238],["T_CONSTANT_ENCAPSED_STRING","'tier_price'",238],"]",")","]",",",["T_WHITESPACE","\n            ",238],["T_CONSTANT_ENCAPSED_STRING","'tp.'",239],["T_WHITESPACE"," ",239],".",["T_WHITESPACE"," ",239],["T_VARIABLE","$linkField",239],["T_WHITESPACE"," ",239],".",["T_WHITESPACE"," ",239],["T_CONSTANT_ENCAPSED_STRING","' = cpe.'",239],["T_WHITESPACE"," ",239],".",["T_WHITESPACE"," ",239],["T_VARIABLE","$linkField",239],",",["T_WHITESPACE","\n            ",239],"[","]",["T_WHITESPACE","\n        ",240],")",["T_OBJECT_OPERATOR","->",241],["T_STRING","join",241],"(",["T_WHITESPACE","\n            ",241],"[",["T_CONSTANT_ENCAPSED_STRING","'cg'",242],["T_WHITESPACE"," ",242],["T_DOUBLE_ARROW","=>",242],["T_WHITESPACE"," ",242],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","_defaultIndexerResource",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","getTable",242],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_group'",242],")","]",",",["T_WHITESPACE","\n            ",242],["T_CONSTANT_ENCAPSED_STRING","'tp.all_groups = 1 OR (tp.all_groups = 0 AND tp.customer_group_id = cg.customer_group_id)'",243],",",["T_WHITESPACE","\n            ",243],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_group_id'",244],"]",["T_WHITESPACE","\n        ",244],")",["T_OBJECT_OPERATOR","->",245],["T_STRING","join",245],"(",["T_WHITESPACE","\n            ",245],"[",["T_CONSTANT_ENCAPSED_STRING","'cw'",246],["T_WHITESPACE"," ",246],["T_DOUBLE_ARROW","=>",246],["T_WHITESPACE"," ",246],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","_defaultIndexerResource",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","getTable",246],"(",["T_CONSTANT_ENCAPSED_STRING","'store_website'",246],")","]",",",["T_WHITESPACE","\n            ",246],["T_CONSTANT_ENCAPSED_STRING","'tp.website_id = 0 OR tp.website_id = cw.website_id'",247],",",["T_WHITESPACE","\n            ",247],"[",["T_CONSTANT_ENCAPSED_STRING","'website_id'",248],"]",["T_WHITESPACE","\n        ",248],")",["T_OBJECT_OPERATOR","->",249],["T_STRING","join",249],"(",["T_WHITESPACE","\n            ",249],"[",["T_CONSTANT_ENCAPSED_STRING","'cwd'",250],["T_WHITESPACE"," ",250],["T_DOUBLE_ARROW","=>",250],["T_WHITESPACE"," ",250],["T_VARIABLE","$this",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","_defaultIndexerResource",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","getTable",250],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_index_website'",250],")","]",",",["T_WHITESPACE","\n            ",250],["T_CONSTANT_ENCAPSED_STRING","'cw.website_id = cwd.website_id'",251],",",["T_WHITESPACE","\n            ",251],"[","]",["T_WHITESPACE","\n        ",252],")",["T_OBJECT_OPERATOR","->",253],["T_STRING","join",253],"(",["T_WHITESPACE","\n            ",253],"[",["T_CONSTANT_ENCAPSED_STRING","'product_price'",254],["T_WHITESPACE"," ",254],["T_DOUBLE_ARROW","=>",254],["T_WHITESPACE"," ",254],["T_VARIABLE","$priceAttribute",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","getBackend",254],"(",")",["T_OBJECT_OPERATOR","->",254],["T_STRING","getTable",254],"(",")","]",",",["T_WHITESPACE","\n            ",254],["T_CONSTANT_ENCAPSED_STRING","'tp.'",255],["T_WHITESPACE"," ",255],".",["T_WHITESPACE"," ",255],["T_VARIABLE","$linkField",255],["T_WHITESPACE"," ",255],".",["T_WHITESPACE"," ",255],["T_CONSTANT_ENCAPSED_STRING","' = product_price.'",255],["T_WHITESPACE"," ",255],".",["T_WHITESPACE"," ",255],["T_VARIABLE","$linkField",255],",",["T_WHITESPACE","\n            ",255],"[","]",["T_WHITESPACE","\n        ",256],")",["T_OBJECT_OPERATOR","->",257],["T_STRING","where",257],"(",["T_WHITESPACE","\n            ",257],["T_CONSTANT_ENCAPSED_STRING","'cw.website_id != 0'",258],["T_WHITESPACE","\n        ",258],")",["T_OBJECT_OPERATOR","->",259],["T_STRING","where",259],"(",["T_WHITESPACE","\n            ",259],["T_CONSTANT_ENCAPSED_STRING","'product_price.attribute_id = ?'",260],",",["T_WHITESPACE","\n            ",260],["T_VARIABLE","$priceAttribute",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","getAttributeId",261],"(",")",["T_WHITESPACE","\n        ",261],")",["T_OBJECT_OPERATOR","->",262],["T_STRING","columns",262],"(",["T_WHITESPACE","\n            ",262],["T_NEW","new",263],["T_WHITESPACE"," ",263],["T_NS_SEPARATOR","\\",263],["T_STRING","Zend_Db_Expr",263],"(","\"",["T_ENCAPSED_AND_WHITESPACE","MIN(",263],["T_CURLY_OPEN","{",263],["T_VARIABLE","$websiteExpression",263],"}",["T_ENCAPSED_AND_WHITESPACE",")",263],"\"",")",["T_WHITESPACE","\n        ",263],")",["T_OBJECT_OPERATOR","->",264],["T_STRING","group",264],"(",["T_WHITESPACE","\n            ",264],"[",["T_CONSTANT_ENCAPSED_STRING","'cpe.entity_id'",265],",",["T_WHITESPACE"," ",265],["T_CONSTANT_ENCAPSED_STRING","'cg.customer_group_id'",265],",",["T_WHITESPACE"," ",265],["T_CONSTANT_ENCAPSED_STRING","'cw.website_id'",265],"]",["T_WHITESPACE","\n        ",265],")",";",["T_WHITESPACE","\n\n        ",266],["T_IF","if",268],["T_WHITESPACE"," ",268],"(","!",["T_EMPTY","empty",268],"(",["T_VARIABLE","$entityIds",268],")",")",["T_WHITESPACE"," ",268],"{",["T_WHITESPACE","\n            ",268],["T_VARIABLE","$select",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","where",269],"(",["T_CONSTANT_ENCAPSED_STRING","\"cpe.entity_id IN(?)\"",269],",",["T_WHITESPACE"," ",269],["T_VARIABLE","$entityIds",269],")",";",["T_WHITESPACE","\n        ",269],"}",["T_WHITESPACE","\n\n        ",270],["T_VARIABLE","$query",272],["T_WHITESPACE"," ",272],"=",["T_WHITESPACE"," ",272],["T_VARIABLE","$select",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","insertFromSelect",272],"(",["T_VARIABLE","$table",272],")",";",["T_WHITESPACE","\n        ",272],["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","_connection",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","query",273],"(",["T_VARIABLE","$query",273],")",";",["T_WHITESPACE","\n\n        ",273],["T_RETURN","return",275],["T_WHITESPACE"," ",275],["T_VARIABLE","$this",275],";",["T_WHITESPACE","\n    ",275],"}",["T_WHITESPACE","\n\n    ",276],["T_DOC_COMMENT","\/**\n     * Retrieve price indexers per product type\n     *\n     * @return \\Magento\\Catalog\\Model\\ResourceModel\\Product\\Indexer\\Price\\PriceInterface[]\n     *\/",278],["T_WHITESPACE","\n    ",282],["T_PUBLIC","public",283],["T_WHITESPACE"," ",283],["T_FUNCTION","function",283],["T_WHITESPACE"," ",283],["T_STRING","getTypeIndexers",283],"(",")",["T_WHITESPACE","\n    ",283],"{",["T_WHITESPACE","\n        ",284],["T_IF","if",285],["T_WHITESPACE"," ",285],"(",["T_VARIABLE","$this",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","_indexers",285],["T_WHITESPACE"," ",285],["T_IS_IDENTICAL","===",285],["T_WHITESPACE"," ",285],["T_STRING","null",285],")",["T_WHITESPACE"," ",285],"{",["T_WHITESPACE","\n            ",285],["T_VARIABLE","$this",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","_indexers",286],["T_WHITESPACE"," ",286],"=",["T_WHITESPACE"," ",286],"[","]",";",["T_WHITESPACE","\n            ",286],["T_VARIABLE","$types",287],["T_WHITESPACE"," ",287],"=",["T_WHITESPACE"," ",287],["T_VARIABLE","$this",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","_catalogProductType",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","getTypesByPriority",287],"(",")",";",["T_WHITESPACE","\n            ",287],["T_FOREACH","foreach",288],["T_WHITESPACE"," ",288],"(",["T_VARIABLE","$types",288],["T_WHITESPACE"," ",288],["T_AS","as",288],["T_WHITESPACE"," ",288],["T_VARIABLE","$typeId",288],["T_WHITESPACE"," ",288],["T_DOUBLE_ARROW","=>",288],["T_WHITESPACE"," ",288],["T_VARIABLE","$typeInfo",288],")",["T_WHITESPACE"," ",288],"{",["T_WHITESPACE","\n                ",288],["T_VARIABLE","$modelName",289],["T_WHITESPACE"," ",289],"=",["T_WHITESPACE"," ",289],["T_ISSET","isset",289],"(",["T_WHITESPACE","\n                    ",289],["T_VARIABLE","$typeInfo",290],"[",["T_CONSTANT_ENCAPSED_STRING","'price_indexer'",290],"]",["T_WHITESPACE","\n                ",290],")",["T_WHITESPACE"," ",291],"?",["T_WHITESPACE"," ",291],["T_VARIABLE","$typeInfo",291],"[",["T_CONSTANT_ENCAPSED_STRING","'price_indexer'",291],"]",["T_WHITESPACE"," ",291],":",["T_WHITESPACE"," ",291],["T_STRING","get_class",291],"(",["T_VARIABLE","$this",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","_defaultIndexerResource",291],")",";",["T_WHITESPACE","\n\n                ",291],["T_VARIABLE","$isComposite",293],["T_WHITESPACE"," ",293],"=",["T_WHITESPACE"," ",293],"!",["T_EMPTY","empty",293],"(",["T_VARIABLE","$typeInfo",293],"[",["T_CONSTANT_ENCAPSED_STRING","'composite'",293],"]",")",";",["T_WHITESPACE","\n                ",293],["T_VARIABLE","$indexer",294],["T_WHITESPACE"," ",294],"=",["T_WHITESPACE"," ",294],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","_indexerPriceFactory",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","create",294],"(",["T_WHITESPACE","\n                    ",294],["T_VARIABLE","$modelName",295],["T_WHITESPACE","\n                ",295],")",["T_OBJECT_OPERATOR","->",296],["T_STRING","setTypeId",296],"(",["T_WHITESPACE","\n                    ",296],["T_VARIABLE","$typeId",297],["T_WHITESPACE","\n                ",297],")",["T_OBJECT_OPERATOR","->",298],["T_STRING","setIsComposite",298],"(",["T_WHITESPACE","\n                    ",298],["T_VARIABLE","$isComposite",299],["T_WHITESPACE","\n                ",299],")",";",["T_WHITESPACE","\n                ",300],["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","_indexers",301],"[",["T_VARIABLE","$typeId",301],"]",["T_WHITESPACE"," ",301],"=",["T_WHITESPACE"," ",301],["T_VARIABLE","$indexer",301],";",["T_WHITESPACE","\n            ",301],"}",["T_WHITESPACE","\n        ",302],"}",["T_WHITESPACE","\n\n        ",303],["T_RETURN","return",305],["T_WHITESPACE"," ",305],["T_VARIABLE","$this",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","_indexers",305],";",["T_WHITESPACE","\n    ",305],"}",["T_WHITESPACE","\n\n    ",306],["T_DOC_COMMENT","\/**\n     * Retrieve Price indexer by Product Type\n     *\n     * @param string $productTypeId\n     * @return \\Magento\\Catalog\\Model\\ResourceModel\\Product\\Indexer\\Price\\PriceInterface\n     * @throws \\Magento\\Framework\\Exception\\InputException\n     *\/",308],["T_WHITESPACE","\n    ",314],["T_PROTECTED","protected",315],["T_WHITESPACE"," ",315],["T_FUNCTION","function",315],["T_WHITESPACE"," ",315],["T_STRING","_getIndexer",315],"(",["T_VARIABLE","$productTypeId",315],")",["T_WHITESPACE","\n    ",315],"{",["T_WHITESPACE","\n        ",316],["T_VARIABLE","$this",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","getTypeIndexers",317],"(",")",";",["T_WHITESPACE","\n        ",317],["T_IF","if",318],["T_WHITESPACE"," ",318],"(","!",["T_ISSET","isset",318],"(",["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","_indexers",318],"[",["T_VARIABLE","$productTypeId",318],"]",")",")",["T_WHITESPACE"," ",318],"{",["T_WHITESPACE","\n            ",318],["T_THROW","throw",319],["T_WHITESPACE"," ",319],["T_NEW","new",319],["T_WHITESPACE"," ",319],["T_NS_SEPARATOR","\\",319],["T_STRING","Magento",319],["T_NS_SEPARATOR","\\",319],["T_STRING","Framework",319],["T_NS_SEPARATOR","\\",319],["T_STRING","Exception",319],["T_NS_SEPARATOR","\\",319],["T_STRING","InputException",319],"(",["T_STRING","__",319],"(",["T_CONSTANT_ENCAPSED_STRING","'Unsupported product type \"%1\".'",319],",",["T_WHITESPACE"," ",319],["T_VARIABLE","$productTypeId",319],")",")",";",["T_WHITESPACE","\n        ",319],"}",["T_WHITESPACE","\n        ",320],["T_RETURN","return",321],["T_WHITESPACE"," ",321],["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","_indexers",321],"[",["T_VARIABLE","$productTypeId",321],"]",";",["T_WHITESPACE","\n    ",321],"}",["T_WHITESPACE","\n\n    ",322],["T_DOC_COMMENT","\/**\n     * Copy data from source table to destination\n     *\n     * @param string $sourceTable\n     * @param string $destTable\n     * @param null|string $where\n     * @return void\n     *\/",324],["T_WHITESPACE","\n    ",331],["T_PROTECTED","protected",332],["T_WHITESPACE"," ",332],["T_FUNCTION","function",332],["T_WHITESPACE"," ",332],["T_STRING","_insertFromTable",332],"(",["T_VARIABLE","$sourceTable",332],",",["T_WHITESPACE"," ",332],["T_VARIABLE","$destTable",332],",",["T_WHITESPACE"," ",332],["T_VARIABLE","$where",332],["T_WHITESPACE"," ",332],"=",["T_WHITESPACE"," ",332],["T_STRING","null",332],")",["T_WHITESPACE","\n    ",332],"{",["T_WHITESPACE","\n        ",333],["T_VARIABLE","$sourceColumns",334],["T_WHITESPACE"," ",334],"=",["T_WHITESPACE"," ",334],["T_STRING","array_keys",334],"(",["T_VARIABLE","$this",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","_connection",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","describeTable",334],"(",["T_VARIABLE","$sourceTable",334],")",")",";",["T_WHITESPACE","\n        ",334],["T_VARIABLE","$targetColumns",335],["T_WHITESPACE"," ",335],"=",["T_WHITESPACE"," ",335],["T_STRING","array_keys",335],"(",["T_VARIABLE","$this",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","_connection",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","describeTable",335],"(",["T_VARIABLE","$destTable",335],")",")",";",["T_WHITESPACE","\n        ",335],["T_VARIABLE","$select",336],["T_WHITESPACE"," ",336],"=",["T_WHITESPACE"," ",336],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","_connection",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","select",336],"(",")",["T_OBJECT_OPERATOR","->",336],["T_STRING","from",336],"(",["T_VARIABLE","$sourceTable",336],",",["T_WHITESPACE"," ",336],["T_VARIABLE","$sourceColumns",336],")",";",["T_WHITESPACE","\n        ",336],["T_IF","if",337],["T_WHITESPACE"," ",337],"(",["T_VARIABLE","$where",337],")",["T_WHITESPACE"," ",337],"{",["T_WHITESPACE","\n            ",337],["T_VARIABLE","$select",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","where",338],"(",["T_VARIABLE","$where",338],")",";",["T_WHITESPACE","\n        ",338],"}",["T_WHITESPACE","\n        ",339],["T_VARIABLE","$query",340],["T_WHITESPACE"," ",340],"=",["T_WHITESPACE"," ",340],["T_VARIABLE","$this",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","_connection",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","insertFromSelect",340],"(",["T_WHITESPACE","\n            ",340],["T_VARIABLE","$select",341],",",["T_WHITESPACE","\n            ",341],["T_VARIABLE","$destTable",342],",",["T_WHITESPACE","\n            ",342],["T_VARIABLE","$targetColumns",343],",",["T_WHITESPACE","\n            ",343],["T_NS_SEPARATOR","\\",344],["T_STRING","Magento",344],["T_NS_SEPARATOR","\\",344],["T_STRING","Framework",344],["T_NS_SEPARATOR","\\",344],["T_STRING","DB",344],["T_NS_SEPARATOR","\\",344],["T_STRING","Adapter",344],["T_NS_SEPARATOR","\\",344],["T_STRING","AdapterInterface",344],["T_DOUBLE_COLON","::",344],["T_STRING","INSERT_ON_DUPLICATE",344],["T_WHITESPACE","\n        ",344],")",";",["T_WHITESPACE","\n        ",345],["T_VARIABLE","$this",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","_connection",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","query",346],"(",["T_VARIABLE","$query",346],")",";",["T_WHITESPACE","\n    ",346],"}",["T_WHITESPACE","\n\n    ",347],["T_DOC_COMMENT","\/**\n     * Removes all data from the table\n     *\n     * @param string $table\n     * @return void\n     *\/",349],["T_WHITESPACE","\n    ",354],["T_PROTECTED","protected",355],["T_WHITESPACE"," ",355],["T_FUNCTION","function",355],["T_WHITESPACE"," ",355],["T_STRING","_emptyTable",355],"(",["T_VARIABLE","$table",355],")",["T_WHITESPACE","\n    ",355],"{",["T_WHITESPACE","\n        ",356],["T_VARIABLE","$this",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","_connection",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","delete",357],"(",["T_VARIABLE","$table",357],")",";",["T_WHITESPACE","\n    ",357],"}",["T_WHITESPACE","\n\n    ",358],["T_DOC_COMMENT","\/**\n     * Refresh entities index\n     *\n     * @param array $changedIds\n     * @return array Affected ids\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     *\/",360],["T_WHITESPACE","\n    ",366],["T_PROTECTED","protected",367],["T_WHITESPACE"," ",367],["T_FUNCTION","function",367],["T_WHITESPACE"," ",367],["T_STRING","_reindexRows",367],"(",["T_VARIABLE","$changedIds",367],["T_WHITESPACE"," ",367],"=",["T_WHITESPACE"," ",367],"[","]",")",["T_WHITESPACE","\n    ",367],"{",["T_WHITESPACE","\n        ",368],["T_VARIABLE","$this",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","_emptyTable",369],"(",["T_VARIABLE","$this",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","_defaultIndexerResource",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","getIdxTable",369],"(",")",")",";",["T_WHITESPACE","\n        ",369],["T_VARIABLE","$this",370],["T_OBJECT_OPERATOR","->",370],["T_STRING","_prepareWebsiteDateTable",370],"(",")",";",["T_WHITESPACE","\n\n        ",370],["T_VARIABLE","$select",372],["T_WHITESPACE"," ",372],"=",["T_WHITESPACE"," ",372],["T_VARIABLE","$this",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","_connection",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","select",372],"(",")",["T_OBJECT_OPERATOR","->",372],["T_STRING","from",372],"(",["T_WHITESPACE","\n            ",372],["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","_defaultIndexerResource",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","getTable",373],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity'",373],")",",",["T_WHITESPACE","\n            ",373],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",374],",",["T_WHITESPACE"," ",374],["T_CONSTANT_ENCAPSED_STRING","'type_id'",374],"]",["T_WHITESPACE","\n        ",374],")",["T_OBJECT_OPERATOR","->",375],["T_STRING","where",375],"(",["T_WHITESPACE","\n            ",375],["T_CONSTANT_ENCAPSED_STRING","'entity_id IN(?)'",376],",",["T_WHITESPACE","\n            ",376],["T_VARIABLE","$changedIds",377],["T_WHITESPACE","\n        ",377],")",";",["T_WHITESPACE","\n        ",378],["T_VARIABLE","$pairs",379],["T_WHITESPACE"," ",379],"=",["T_WHITESPACE"," ",379],["T_VARIABLE","$this",379],["T_OBJECT_OPERATOR","->",379],["T_STRING","_connection",379],["T_OBJECT_OPERATOR","->",379],["T_STRING","fetchPairs",379],"(",["T_VARIABLE","$select",379],")",";",["T_WHITESPACE","\n        ",379],["T_VARIABLE","$byType",380],["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],"[","]",";",["T_WHITESPACE","\n        ",380],["T_FOREACH","foreach",381],["T_WHITESPACE"," ",381],"(",["T_VARIABLE","$pairs",381],["T_WHITESPACE"," ",381],["T_AS","as",381],["T_WHITESPACE"," ",381],["T_VARIABLE","$productId",381],["T_WHITESPACE"," ",381],["T_DOUBLE_ARROW","=>",381],["T_WHITESPACE"," ",381],["T_VARIABLE","$productType",381],")",["T_WHITESPACE"," ",381],"{",["T_WHITESPACE","\n            ",381],["T_VARIABLE","$byType",382],"[",["T_VARIABLE","$productType",382],"]","[",["T_VARIABLE","$productId",382],"]",["T_WHITESPACE"," ",382],"=",["T_WHITESPACE"," ",382],["T_VARIABLE","$productId",382],";",["T_WHITESPACE","\n        ",382],"}",["T_WHITESPACE","\n\n        ",383],["T_VARIABLE","$compositeIds",385],["T_WHITESPACE"," ",385],"=",["T_WHITESPACE"," ",385],"[","]",";",["T_WHITESPACE","\n        ",385],["T_VARIABLE","$notCompositeIds",386],["T_WHITESPACE"," ",386],"=",["T_WHITESPACE"," ",386],"[","]",";",["T_WHITESPACE","\n\n        ",386],["T_FOREACH","foreach",388],["T_WHITESPACE"," ",388],"(",["T_VARIABLE","$byType",388],["T_WHITESPACE"," ",388],["T_AS","as",388],["T_WHITESPACE"," ",388],["T_VARIABLE","$productType",388],["T_WHITESPACE"," ",388],["T_DOUBLE_ARROW","=>",388],["T_WHITESPACE"," ",388],["T_VARIABLE","$entityIds",388],")",["T_WHITESPACE"," ",388],"{",["T_WHITESPACE","\n            ",388],["T_VARIABLE","$indexer",389],["T_WHITESPACE"," ",389],"=",["T_WHITESPACE"," ",389],["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","_getIndexer",389],"(",["T_VARIABLE","$productType",389],")",";",["T_WHITESPACE","\n            ",389],["T_IF","if",390],["T_WHITESPACE"," ",390],"(",["T_VARIABLE","$indexer",390],["T_OBJECT_OPERATOR","->",390],["T_STRING","getIsComposite",390],"(",")",")",["T_WHITESPACE"," ",390],"{",["T_WHITESPACE","\n                ",390],["T_VARIABLE","$compositeIds",391],["T_WHITESPACE"," ",391],["T_PLUS_EQUAL","+=",391],["T_WHITESPACE"," ",391],["T_VARIABLE","$entityIds",391],";",["T_WHITESPACE","\n            ",391],"}",["T_WHITESPACE"," ",392],["T_ELSE","else",392],["T_WHITESPACE"," ",392],"{",["T_WHITESPACE","\n                ",392],["T_VARIABLE","$notCompositeIds",393],["T_WHITESPACE"," ",393],["T_PLUS_EQUAL","+=",393],["T_WHITESPACE"," ",393],["T_VARIABLE","$entityIds",393],";",["T_WHITESPACE","\n            ",393],"}",["T_WHITESPACE","\n        ",394],"}",["T_WHITESPACE","\n\n        ",395],["T_IF","if",397],["T_WHITESPACE"," ",397],"(","!",["T_EMPTY","empty",397],"(",["T_VARIABLE","$notCompositeIds",397],")",")",["T_WHITESPACE"," ",397],"{",["T_WHITESPACE","\n            ",397],["T_VARIABLE","$select",398],["T_WHITESPACE"," ",398],"=",["T_WHITESPACE"," ",398],["T_VARIABLE","$this",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","_connection",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","select",398],"(",")",["T_OBJECT_OPERATOR","->",398],["T_STRING","from",398],"(",["T_WHITESPACE","\n                ",398],"[",["T_CONSTANT_ENCAPSED_STRING","'l'",399],["T_WHITESPACE"," ",399],["T_DOUBLE_ARROW","=>",399],["T_WHITESPACE"," ",399],["T_VARIABLE","$this",399],["T_OBJECT_OPERATOR","->",399],["T_STRING","_defaultIndexerResource",399],["T_OBJECT_OPERATOR","->",399],["T_STRING","getTable",399],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_relation'",399],")","]",",",["T_WHITESPACE","\n                ",399],["T_CONSTANT_ENCAPSED_STRING","''",400],["T_WHITESPACE","\n            ",400],")",["T_OBJECT_OPERATOR","->",401],["T_STRING","join",401],"(",["T_WHITESPACE","\n                ",401],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",402],["T_WHITESPACE"," ",402],["T_DOUBLE_ARROW","=>",402],["T_WHITESPACE"," ",402],["T_VARIABLE","$this",402],["T_OBJECT_OPERATOR","->",402],["T_STRING","_defaultIndexerResource",402],["T_OBJECT_OPERATOR","->",402],["T_STRING","getTable",402],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity'",402],")","]",",",["T_WHITESPACE","\n                ",402],["T_CONSTANT_ENCAPSED_STRING","'e.'",403],["T_WHITESPACE"," ",403],".",["T_WHITESPACE"," ",403],["T_VARIABLE","$this",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","getProductIdFieldName",403],"(",")",["T_WHITESPACE"," ",403],".",["T_WHITESPACE"," ",403],["T_CONSTANT_ENCAPSED_STRING","' = l.parent_id'",403],",",["T_WHITESPACE","\n                ",403],"[",["T_CONSTANT_ENCAPSED_STRING","'e.entity_id as parent_id'",404],",",["T_WHITESPACE"," ",404],["T_CONSTANT_ENCAPSED_STRING","'type_id'",404],"]",["T_WHITESPACE","\n            ",404],")",["T_OBJECT_OPERATOR","->",405],["T_STRING","where",405],"(",["T_WHITESPACE","\n                ",405],["T_CONSTANT_ENCAPSED_STRING","'l.child_id IN(?)'",406],",",["T_WHITESPACE","\n                ",406],["T_VARIABLE","$notCompositeIds",407],["T_WHITESPACE","\n            ",407],")",";",["T_WHITESPACE","\n            ",408],["T_VARIABLE","$pairs",409],["T_WHITESPACE"," ",409],"=",["T_WHITESPACE"," ",409],["T_VARIABLE","$this",409],["T_OBJECT_OPERATOR","->",409],["T_STRING","_connection",409],["T_OBJECT_OPERATOR","->",409],["T_STRING","fetchPairs",409],"(",["T_VARIABLE","$select",409],")",";",["T_WHITESPACE","\n            ",409],["T_FOREACH","foreach",410],["T_WHITESPACE"," ",410],"(",["T_VARIABLE","$pairs",410],["T_WHITESPACE"," ",410],["T_AS","as",410],["T_WHITESPACE"," ",410],["T_VARIABLE","$productId",410],["T_WHITESPACE"," ",410],["T_DOUBLE_ARROW","=>",410],["T_WHITESPACE"," ",410],["T_VARIABLE","$productType",410],")",["T_WHITESPACE"," ",410],"{",["T_WHITESPACE","\n                ",410],["T_IF","if",411],["T_WHITESPACE"," ",411],"(","!",["T_STRING","in_array",411],"(",["T_VARIABLE","$productId",411],",",["T_WHITESPACE"," ",411],["T_VARIABLE","$changedIds",411],")",")",["T_WHITESPACE"," ",411],"{",["T_WHITESPACE","\n                    ",411],["T_VARIABLE","$changedIds",412],"[","]",["T_WHITESPACE"," ",412],"=",["T_WHITESPACE"," ",412],["T_STRING_CAST","(string)",412],["T_WHITESPACE"," ",412],["T_VARIABLE","$productId",412],";",["T_WHITESPACE","\n                    ",412],["T_VARIABLE","$byType",413],"[",["T_VARIABLE","$productType",413],"]","[",["T_VARIABLE","$productId",413],"]",["T_WHITESPACE"," ",413],"=",["T_WHITESPACE"," ",413],["T_VARIABLE","$productId",413],";",["T_WHITESPACE","\n                    ",413],["T_VARIABLE","$compositeIds",414],"[",["T_VARIABLE","$productId",414],"]",["T_WHITESPACE"," ",414],"=",["T_WHITESPACE"," ",414],["T_VARIABLE","$productId",414],";",["T_WHITESPACE","\n                ",414],"}",["T_WHITESPACE","\n            ",415],"}",["T_WHITESPACE","\n        ",416],"}",["T_WHITESPACE","\n\n        ",417],["T_IF","if",419],["T_WHITESPACE"," ",419],"(","!",["T_EMPTY","empty",419],"(",["T_VARIABLE","$compositeIds",419],")",")",["T_WHITESPACE"," ",419],"{",["T_WHITESPACE","\n            ",419],["T_VARIABLE","$this",420],["T_OBJECT_OPERATOR","->",420],["T_STRING","_copyRelationIndexData",420],"(",["T_VARIABLE","$compositeIds",420],",",["T_WHITESPACE"," ",420],["T_VARIABLE","$notCompositeIds",420],")",";",["T_WHITESPACE","\n        ",420],"}",["T_WHITESPACE","\n        ",421],["T_VARIABLE","$this",422],["T_OBJECT_OPERATOR","->",422],["T_STRING","_prepareTierPriceIndex",422],"(",["T_VARIABLE","$compositeIds",422],["T_WHITESPACE"," ",422],"+",["T_WHITESPACE"," ",422],["T_VARIABLE","$notCompositeIds",422],")",";",["T_WHITESPACE","\n\n        ",422],["T_VARIABLE","$indexers",424],["T_WHITESPACE"," ",424],"=",["T_WHITESPACE"," ",424],["T_VARIABLE","$this",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","getTypeIndexers",424],"(",")",";",["T_WHITESPACE","\n        ",424],["T_FOREACH","foreach",425],["T_WHITESPACE"," ",425],"(",["T_VARIABLE","$indexers",425],["T_WHITESPACE"," ",425],["T_AS","as",425],["T_WHITESPACE"," ",425],["T_VARIABLE","$indexer",425],")",["T_WHITESPACE"," ",425],"{",["T_WHITESPACE","\n            ",425],["T_IF","if",426],["T_WHITESPACE"," ",426],"(","!",["T_EMPTY","empty",426],"(",["T_VARIABLE","$byType",426],"[",["T_VARIABLE","$indexer",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","getTypeId",426],"(",")","]",")",")",["T_WHITESPACE"," ",426],"{",["T_WHITESPACE","\n                ",426],["T_VARIABLE","$indexer",427],["T_OBJECT_OPERATOR","->",427],["T_STRING","reindexEntity",427],"(",["T_VARIABLE","$byType",427],"[",["T_VARIABLE","$indexer",427],["T_OBJECT_OPERATOR","->",427],["T_STRING","getTypeId",427],"(",")","]",")",";",["T_WHITESPACE","\n            ",427],"}",["T_WHITESPACE","\n        ",428],"}",["T_WHITESPACE","\n        ",429],["T_VARIABLE","$this",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","_syncData",430],"(",["T_VARIABLE","$changedIds",430],")",";",["T_WHITESPACE","\n\n        ",430],["T_RETURN","return",432],["T_WHITESPACE"," ",432],["T_VARIABLE","$compositeIds",432],["T_WHITESPACE"," ",432],"+",["T_WHITESPACE"," ",432],["T_VARIABLE","$notCompositeIds",432],";",["T_WHITESPACE","\n    ",432],"}",["T_WHITESPACE","\n\n    ",433],["T_DOC_COMMENT","\/**\n     * Copy relations product index from primary index to temporary index table by parent entity\n     *\n     * @param null|array $parentIds\n     * @param array $excludeIds\n     * @return \\Magento\\Catalog\\Model\\Indexer\\Product\\Price\\AbstractAction\n     *\/",435],["T_WHITESPACE","\n    ",441],["T_PROTECTED","protected",442],["T_WHITESPACE"," ",442],["T_FUNCTION","function",442],["T_WHITESPACE"," ",442],["T_STRING","_copyRelationIndexData",442],"(",["T_VARIABLE","$parentIds",442],",",["T_WHITESPACE"," ",442],["T_VARIABLE","$excludeIds",442],["T_WHITESPACE"," ",442],"=",["T_WHITESPACE"," ",442],["T_STRING","null",442],")",["T_WHITESPACE","\n    ",442],"{",["T_WHITESPACE","\n        ",443],["T_VARIABLE","$linkField",444],["T_WHITESPACE"," ",444],"=",["T_WHITESPACE"," ",444],["T_VARIABLE","$this",444],["T_OBJECT_OPERATOR","->",444],["T_STRING","getProductIdFieldName",444],"(",")",";",["T_WHITESPACE","\n        ",444],["T_VARIABLE","$select",445],["T_WHITESPACE"," ",445],"=",["T_WHITESPACE"," ",445],["T_VARIABLE","$this",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","_connection",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","select",445],"(",")",["T_OBJECT_OPERATOR","->",445],["T_STRING","from",445],"(",["T_WHITESPACE","\n            ",445],["T_VARIABLE","$this",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","_defaultIndexerResource",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","getTable",446],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_relation'",446],")",",",["T_WHITESPACE","\n            ",446],"[",["T_CONSTANT_ENCAPSED_STRING","'child_id'",447],"]",["T_WHITESPACE","\n        ",447],")",["T_OBJECT_OPERATOR","->",448],["T_STRING","join",448],"(",["T_WHITESPACE","\n            ",448],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",449],["T_WHITESPACE"," ",449],["T_DOUBLE_ARROW","=>",449],["T_WHITESPACE"," ",449],["T_VARIABLE","$this",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","_defaultIndexerResource",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","getTable",449],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity'",449],")","]",",",["T_WHITESPACE","\n            ",449],["T_CONSTANT_ENCAPSED_STRING","'e.'",450],["T_WHITESPACE"," ",450],".",["T_WHITESPACE"," ",450],["T_VARIABLE","$linkField",450],["T_WHITESPACE"," ",450],".",["T_WHITESPACE"," ",450],["T_CONSTANT_ENCAPSED_STRING","' = parent_id'",450],["T_WHITESPACE","\n        ",450],")",["T_OBJECT_OPERATOR","->",451],["T_STRING","where",451],"(",["T_WHITESPACE","\n            ",451],["T_CONSTANT_ENCAPSED_STRING","'e.entity_id IN(?)'",452],",",["T_WHITESPACE","\n            ",452],["T_VARIABLE","$parentIds",453],["T_WHITESPACE","\n        ",453],")",";",["T_WHITESPACE","\n        ",454],["T_IF","if",455],["T_WHITESPACE"," ",455],"(","!",["T_EMPTY","empty",455],"(",["T_VARIABLE","$excludeIds",455],")",")",["T_WHITESPACE"," ",455],"{",["T_WHITESPACE","\n            ",455],["T_VARIABLE","$select",456],["T_OBJECT_OPERATOR","->",456],["T_STRING","where",456],"(",["T_CONSTANT_ENCAPSED_STRING","'child_id NOT IN(?)'",456],",",["T_WHITESPACE"," ",456],["T_VARIABLE","$excludeIds",456],")",";",["T_WHITESPACE","\n        ",456],"}",["T_WHITESPACE","\n\n        ",457],["T_VARIABLE","$children",459],["T_WHITESPACE"," ",459],"=",["T_WHITESPACE"," ",459],["T_VARIABLE","$this",459],["T_OBJECT_OPERATOR","->",459],["T_STRING","_connection",459],["T_OBJECT_OPERATOR","->",459],["T_STRING","fetchCol",459],"(",["T_VARIABLE","$select",459],")",";",["T_WHITESPACE","\n\n        ",459],["T_IF","if",461],["T_WHITESPACE"," ",461],"(",["T_VARIABLE","$children",461],")",["T_WHITESPACE"," ",461],"{",["T_WHITESPACE","\n            ",461],["T_VARIABLE","$select",462],["T_WHITESPACE"," ",462],"=",["T_WHITESPACE"," ",462],["T_VARIABLE","$this",462],["T_OBJECT_OPERATOR","->",462],["T_STRING","_connection",462],["T_OBJECT_OPERATOR","->",462],["T_STRING","select",462],"(",")",["T_OBJECT_OPERATOR","->",462],["T_STRING","from",462],"(",["T_WHITESPACE","\n                ",462],["T_VARIABLE","$this",463],["T_OBJECT_OPERATOR","->",463],["T_STRING","_defaultIndexerResource",463],["T_OBJECT_OPERATOR","->",463],["T_STRING","getTable",463],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_index_price'",463],")",["T_WHITESPACE","\n            ",463],")",["T_OBJECT_OPERATOR","->",464],["T_STRING","where",464],"(",["T_WHITESPACE","\n                ",464],["T_CONSTANT_ENCAPSED_STRING","'entity_id IN(?)'",465],",",["T_WHITESPACE","\n                ",465],["T_VARIABLE","$children",466],["T_WHITESPACE","\n            ",466],")",";",["T_WHITESPACE","\n            ",467],["T_VARIABLE","$query",468],["T_WHITESPACE"," ",468],"=",["T_WHITESPACE"," ",468],["T_VARIABLE","$select",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","insertFromSelect",468],"(",["T_VARIABLE","$this",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","_defaultIndexerResource",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","getIdxTable",468],"(",")",",",["T_WHITESPACE"," ",468],"[","]",",",["T_WHITESPACE"," ",468],["T_STRING","false",468],")",";",["T_WHITESPACE","\n            ",468],["T_VARIABLE","$this",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","_connection",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","query",469],"(",["T_VARIABLE","$query",469],")",";",["T_WHITESPACE","\n        ",469],"}",["T_WHITESPACE","\n\n        ",470],["T_RETURN","return",472],["T_WHITESPACE"," ",472],["T_VARIABLE","$this",472],";",["T_WHITESPACE","\n    ",472],"}",["T_WHITESPACE","\n\n    ",473],["T_DOC_COMMENT","\/**\n     * @return string\n     *\/",475],["T_WHITESPACE","\n    ",477],["T_PROTECTED","protected",478],["T_WHITESPACE"," ",478],["T_FUNCTION","function",478],["T_WHITESPACE"," ",478],["T_STRING","getProductIdFieldName",478],"(",")",["T_WHITESPACE","\n    ",478],"{",["T_WHITESPACE","\n        ",479],["T_VARIABLE","$table",480],["T_WHITESPACE"," ",480],"=",["T_WHITESPACE"," ",480],["T_VARIABLE","$this",480],["T_OBJECT_OPERATOR","->",480],["T_STRING","_defaultIndexerResource",480],["T_OBJECT_OPERATOR","->",480],["T_STRING","getTable",480],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity'",480],")",";",["T_WHITESPACE","\n        ",480],["T_VARIABLE","$indexList",481],["T_WHITESPACE"," ",481],"=",["T_WHITESPACE"," ",481],["T_VARIABLE","$this",481],["T_OBJECT_OPERATOR","->",481],["T_STRING","_connection",481],["T_OBJECT_OPERATOR","->",481],["T_STRING","getIndexList",481],"(",["T_VARIABLE","$table",481],")",";",["T_WHITESPACE","\n        ",481],["T_RETURN","return",482],["T_WHITESPACE"," ",482],["T_VARIABLE","$indexList",482],"[",["T_VARIABLE","$this",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","_connection",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","getPrimaryKeyName",482],"(",["T_VARIABLE","$table",482],")","]","[",["T_CONSTANT_ENCAPSED_STRING","'COLUMNS_LIST'",482],"]","[",["T_LNUMBER","0",482],"]",";",["T_WHITESPACE","\n    ",482],"}",["T_WHITESPACE","\n\n    ",483],["T_DOC_COMMENT","\/**\n     * @return \\Magento\\Catalog\\Model\\ResourceModel\\Product\n     * @deprecated\n     *\/",485],["T_WHITESPACE","\n    ",488],["T_PRIVATE","private",489],["T_WHITESPACE"," ",489],["T_FUNCTION","function",489],["T_WHITESPACE"," ",489],["T_STRING","getProductResource",489],"(",")",["T_WHITESPACE","\n    ",489],"{",["T_WHITESPACE","\n        ",490],["T_IF","if",491],["T_WHITESPACE"," ",491],"(",["T_STRING","null",491],["T_WHITESPACE"," ",491],["T_IS_IDENTICAL","===",491],["T_WHITESPACE"," ",491],["T_VARIABLE","$this",491],["T_OBJECT_OPERATOR","->",491],["T_STRING","productResource",491],")",["T_WHITESPACE"," ",491],"{",["T_WHITESPACE","\n            ",491],["T_VARIABLE","$this",492],["T_OBJECT_OPERATOR","->",492],["T_STRING","productResource",492],["T_WHITESPACE"," ",492],"=",["T_WHITESPACE"," ",492],["T_NS_SEPARATOR","\\",492],["T_STRING","Magento",492],["T_NS_SEPARATOR","\\",492],["T_STRING","Framework",492],["T_NS_SEPARATOR","\\",492],["T_STRING","App",492],["T_NS_SEPARATOR","\\",492],["T_STRING","ObjectManager",492],["T_DOUBLE_COLON","::",492],["T_STRING","getInstance",492],"(",")",["T_WHITESPACE","\n                ",492],["T_OBJECT_OPERATOR","->",493],["T_STRING","get",493],"(",["T_NS_SEPARATOR","\\",493],["T_STRING","Magento",493],["T_NS_SEPARATOR","\\",493],["T_STRING","Catalog",493],["T_NS_SEPARATOR","\\",493],["T_STRING","Model",493],["T_NS_SEPARATOR","\\",493],["T_STRING","ResourceModel",493],["T_NS_SEPARATOR","\\",493],["T_STRING","Product",493],["T_DOUBLE_COLON","::",493],["T_CLASS","class",493],")",";",["T_WHITESPACE","\n        ",493],"}",["T_WHITESPACE","\n        ",494],["T_RETURN","return",495],["T_WHITESPACE"," ",495],["T_VARIABLE","$this",495],["T_OBJECT_OPERATOR","->",495],["T_STRING","productResource",495],";",["T_WHITESPACE","\n    ",495],"}",["T_WHITESPACE","\n",496],"}",["T_WHITESPACE","\n",497]]