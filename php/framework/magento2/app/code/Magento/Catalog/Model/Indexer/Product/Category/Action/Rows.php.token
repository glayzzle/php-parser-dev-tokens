[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Catalog",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Indexer",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Product",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Category",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Action",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Catalog",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Model",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Category",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Catalog",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Model",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Product",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Indexer",10],["T_NS_SEPARATOR","\\",10],["T_STRING","CacheContext",10],";",["T_WHITESPACE","\n\n",10],["T_CLASS","class",12],["T_WHITESPACE"," ",12],["T_STRING","Rows",12],["T_WHITESPACE"," ",12],["T_EXTENDS","extends",12],["T_WHITESPACE"," ",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Catalog",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Model",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Indexer",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Category",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Product",12],["T_NS_SEPARATOR","\\",12],["T_STRING","AbstractAction",12],["T_WHITESPACE","\n",12],"{",["T_WHITESPACE","\n    ",13],["T_DOC_COMMENT","\/**\n     * Limitation by products\n     *\n     * @var int[]\n     *\/",14],["T_WHITESPACE","\n    ",18],["T_PROTECTED","protected",19],["T_WHITESPACE"," ",19],["T_VARIABLE","$limitationByProducts",19],";",["T_WHITESPACE","\n\n    ",19],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Indexer\\CacheContext\n     *\/",21],["T_WHITESPACE","\n    ",23],["T_PRIVATE","private",24],["T_WHITESPACE"," ",24],["T_VARIABLE","$cacheContext",24],";",["T_WHITESPACE","\n\n    ",24],["T_DOC_COMMENT","\/**\n     * Refresh entities index\n     *\n     * @param int[] $entityIds\n     * @param bool $useTempTable\n     * @return $this\n     *\/",26],["T_WHITESPACE","\n    ",32],["T_PUBLIC","public",33],["T_WHITESPACE"," ",33],["T_FUNCTION","function",33],["T_WHITESPACE"," ",33],["T_STRING","execute",33],"(",["T_ARRAY","array",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$entityIds",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],"[","]",",",["T_WHITESPACE"," ",33],["T_VARIABLE","$useTempTable",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_STRING","false",33],")",["T_WHITESPACE","\n    ",33],"{",["T_WHITESPACE","\n        ",34],["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","limitationByProducts",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_VARIABLE","$entityIds",35],";",["T_WHITESPACE","\n        ",35],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","useTempTable",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$useTempTable",36],";",["T_WHITESPACE","\n\n        ",36],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","removeEntries",38],"(",")",";",["T_WHITESPACE","\n\n        ",38],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","reindex",40],"(",")",";",["T_WHITESPACE","\n\n        ",40],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","registerProducts",42],"(",["T_VARIABLE","$entityIds",42],")",";",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","registerCategories",43],"(",["T_VARIABLE","$entityIds",43],")",";",["T_WHITESPACE","\n\n        ",43],["T_RETURN","return",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$this",45],";",["T_WHITESPACE","\n    ",45],"}",["T_WHITESPACE","\n\n    ",46],["T_DOC_COMMENT","\/**\n     * Register affected products\n     * \n     * @param array $entityIds\n     * @return void\n     *\/",48],["T_WHITESPACE","\n    ",53],["T_PRIVATE","private",54],["T_WHITESPACE"," ",54],["T_FUNCTION","function",54],["T_WHITESPACE"," ",54],["T_STRING","registerProducts",54],"(",["T_VARIABLE","$entityIds",54],")",["T_WHITESPACE","\n    ",54],"{",["T_WHITESPACE","\n        ",55],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","getCacheContext",56],"(",")",["T_OBJECT_OPERATOR","->",56],["T_STRING","registerEntities",56],"(",["T_STRING","Product",56],["T_DOUBLE_COLON","::",56],["T_STRING","CACHE_TAG",56],",",["T_WHITESPACE"," ",56],["T_VARIABLE","$entityIds",56],")",";",["T_WHITESPACE","\n    ",56],"}",["T_WHITESPACE","\n\n    ",57],["T_DOC_COMMENT","\/**\n     * Register categories assigned to products\n     *\n     * @param array $entityIds\n     * @return void\n     *\/",59],["T_WHITESPACE","\n    ",64],["T_PRIVATE","private",65],["T_WHITESPACE"," ",65],["T_FUNCTION","function",65],["T_WHITESPACE"," ",65],["T_STRING","registerCategories",65],"(",["T_VARIABLE","$entityIds",65],")",["T_WHITESPACE","\n    ",65],"{",["T_WHITESPACE","\n        ",66],["T_VARIABLE","$categories",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","connection",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","fetchCol",67],"(",["T_WHITESPACE","\n            ",67],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","connection",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","select",68],"(",")",["T_WHITESPACE","\n                ",68],["T_OBJECT_OPERATOR","->",69],["T_STRING","from",69],"(",["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getMainTable",69],"(",")",",",["T_WHITESPACE"," ",69],"[",["T_CONSTANT_ENCAPSED_STRING","'category_id'",69],"]",")",["T_WHITESPACE","\n                ",69],["T_OBJECT_OPERATOR","->",70],["T_STRING","where",70],"(",["T_CONSTANT_ENCAPSED_STRING","'product_id IN (?)'",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$entityIds",70],")",["T_WHITESPACE","\n                ",70],["T_OBJECT_OPERATOR","->",71],["T_STRING","distinct",71],"(",")",["T_WHITESPACE","\n        ",71],")",";",["T_WHITESPACE","\n\n        ",72],["T_IF","if",74],["T_WHITESPACE"," ",74],"(",["T_VARIABLE","$categories",74],")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n            ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getCacheContext",75],"(",")",["T_OBJECT_OPERATOR","->",75],["T_STRING","registerEntities",75],"(",["T_STRING","Category",75],["T_DOUBLE_COLON","::",75],["T_STRING","CACHE_TAG",75],",",["T_WHITESPACE"," ",75],["T_VARIABLE","$categories",75],")",";",["T_WHITESPACE","\n        ",75],"}",["T_WHITESPACE","\n    ",76],"}",["T_WHITESPACE","\n\n    ",77],["T_DOC_COMMENT","\/**\n     * Remove index entries before reindexation\n     *\n     * @return void\n     *\/",79],["T_WHITESPACE","\n    ",83],["T_PROTECTED","protected",84],["T_WHITESPACE"," ",84],["T_FUNCTION","function",84],["T_WHITESPACE"," ",84],["T_STRING","removeEntries",84],"(",")",["T_WHITESPACE","\n    ",84],"{",["T_WHITESPACE","\n        ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","connection",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","delete",86],"(",["T_WHITESPACE","\n            ",86],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getMainTable",87],"(",")",",",["T_WHITESPACE","\n            ",87],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id IN (?)'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","limitationByProducts",88],"]",["T_WHITESPACE","\n        ",88],")",";",["T_WHITESPACE","\n    ",89],"}",["T_WHITESPACE","\n\n    ",90],["T_DOC_COMMENT","\/**\n     * Retrieve select for reindex products of non anchor categories\n     *\n     * @param \\Magento\\Store\\Model\\Store $store\n     * @return \\Magento\\Framework\\DB\\Select\n     *\/",92],["T_WHITESPACE","\n    ",97],["T_PROTECTED","protected",98],["T_WHITESPACE"," ",98],["T_FUNCTION","function",98],["T_WHITESPACE"," ",98],["T_STRING","getNonAnchorCategoriesSelect",98],"(",["T_NS_SEPARATOR","\\",98],["T_STRING","Magento",98],["T_NS_SEPARATOR","\\",98],["T_STRING","Store",98],["T_NS_SEPARATOR","\\",98],["T_STRING","Model",98],["T_NS_SEPARATOR","\\",98],["T_STRING","Store",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$store",98],")",["T_WHITESPACE","\n    ",98],"{",["T_WHITESPACE","\n        ",99],["T_VARIABLE","$select",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_STRING","parent",100],["T_DOUBLE_COLON","::",100],["T_STRING","getNonAnchorCategoriesSelect",100],"(",["T_VARIABLE","$store",100],")",";",["T_WHITESPACE","\n        ",100],["T_RETURN","return",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$select",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","where",101],"(",["T_CONSTANT_ENCAPSED_STRING","'ccp.product_id IN (?)'",101],",",["T_WHITESPACE"," ",101],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","limitationByProducts",101],")",";",["T_WHITESPACE","\n    ",101],"}",["T_WHITESPACE","\n\n    ",102],["T_DOC_COMMENT","\/**\n     * Retrieve select for reindex products of non anchor categories\n     *\n     * @param \\Magento\\Store\\Model\\Store $store\n     * @return \\Magento\\Framework\\DB\\Select\n     *\/",104],["T_WHITESPACE","\n    ",109],["T_PROTECTED","protected",110],["T_WHITESPACE"," ",110],["T_FUNCTION","function",110],["T_WHITESPACE"," ",110],["T_STRING","getAnchorCategoriesSelect",110],"(",["T_NS_SEPARATOR","\\",110],["T_STRING","Magento",110],["T_NS_SEPARATOR","\\",110],["T_STRING","Store",110],["T_NS_SEPARATOR","\\",110],["T_STRING","Model",110],["T_NS_SEPARATOR","\\",110],["T_STRING","Store",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$store",110],")",["T_WHITESPACE","\n    ",110],"{",["T_WHITESPACE","\n        ",111],["T_VARIABLE","$select",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_STRING","parent",112],["T_DOUBLE_COLON","::",112],["T_STRING","getAnchorCategoriesSelect",112],"(",["T_VARIABLE","$store",112],")",";",["T_WHITESPACE","\n        ",112],["T_RETURN","return",113],["T_WHITESPACE"," ",113],["T_VARIABLE","$select",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","where",113],"(",["T_CONSTANT_ENCAPSED_STRING","'ccp.product_id IN (?)'",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","limitationByProducts",113],")",";",["T_WHITESPACE","\n    ",113],"}",["T_WHITESPACE","\n\n    ",114],["T_DOC_COMMENT","\/**\n     * Get select for all products\n     *\n     * @param \\Magento\\Store\\Model\\Store $store\n     * @return \\Magento\\Framework\\DB\\Select\n     *\/",116],["T_WHITESPACE","\n    ",121],["T_PROTECTED","protected",122],["T_WHITESPACE"," ",122],["T_FUNCTION","function",122],["T_WHITESPACE"," ",122],["T_STRING","getAllProducts",122],"(",["T_NS_SEPARATOR","\\",122],["T_STRING","Magento",122],["T_NS_SEPARATOR","\\",122],["T_STRING","Store",122],["T_NS_SEPARATOR","\\",122],["T_STRING","Model",122],["T_NS_SEPARATOR","\\",122],["T_STRING","Store",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$store",122],")",["T_WHITESPACE","\n    ",122],"{",["T_WHITESPACE","\n        ",123],["T_VARIABLE","$select",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_STRING","parent",124],["T_DOUBLE_COLON","::",124],["T_STRING","getAllProducts",124],"(",["T_VARIABLE","$store",124],")",";",["T_WHITESPACE","\n        ",124],["T_RETURN","return",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$select",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","where",125],"(",["T_CONSTANT_ENCAPSED_STRING","'cp.entity_id IN (?)'",125],",",["T_WHITESPACE"," ",125],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","limitationByProducts",125],")",";",["T_WHITESPACE","\n    ",125],"}",["T_WHITESPACE","\n\n    ",126],["T_DOC_COMMENT","\/**\n     * Check whether select ranging is needed\n     *\n     * @return bool\n     *\/",128],["T_WHITESPACE","\n    ",132],["T_PROTECTED","protected",133],["T_WHITESPACE"," ",133],["T_FUNCTION","function",133],["T_WHITESPACE"," ",133],["T_STRING","isRangingNeeded",133],"(",")",["T_WHITESPACE","\n    ",133],"{",["T_WHITESPACE","\n        ",134],["T_RETURN","return",135],["T_WHITESPACE"," ",135],["T_STRING","false",135],";",["T_WHITESPACE","\n    ",135],"}",["T_WHITESPACE","\n\n    ",136],["T_DOC_COMMENT","\/**\n     * Get cache context\n     *\n     * @return \\Magento\\Framework\\Indexer\\CacheContext\n     * @deprecated\n     *\/",138],["T_WHITESPACE","\n    ",143],["T_PRIVATE","private",144],["T_WHITESPACE"," ",144],["T_FUNCTION","function",144],["T_WHITESPACE"," ",144],["T_STRING","getCacheContext",144],"(",")",["T_WHITESPACE","\n    ",144],"{",["T_WHITESPACE","\n        ",145],["T_IF","if",146],["T_WHITESPACE"," ",146],"(",["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","cacheContext",146],["T_WHITESPACE"," ",146],["T_IS_IDENTICAL","===",146],["T_WHITESPACE"," ",146],["T_STRING","null",146],")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n            ",146],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","cacheContext",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_NS_SEPARATOR","\\",147],["T_STRING","Magento",147],["T_NS_SEPARATOR","\\",147],["T_STRING","Framework",147],["T_NS_SEPARATOR","\\",147],["T_STRING","App",147],["T_NS_SEPARATOR","\\",147],["T_STRING","ObjectManager",147],["T_DOUBLE_COLON","::",147],["T_STRING","getInstance",147],"(",")",["T_OBJECT_OPERATOR","->",147],["T_STRING","get",147],"(",["T_STRING","CacheContext",147],["T_DOUBLE_COLON","::",147],["T_CLASS","class",147],")",";",["T_WHITESPACE","\n        ",147],"}",["T_WHITESPACE","\n        ",148],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","cacheContext",149],";",["T_WHITESPACE","\n    ",149],"}",["T_WHITESPACE","\n",150],"}",["T_WHITESPACE","\n",151]]