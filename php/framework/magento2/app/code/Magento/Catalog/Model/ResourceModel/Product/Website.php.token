[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Catalog",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","ResourceModel",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Product",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Catalog Product Website Resource Model\n *\/",8],["T_WHITESPACE","\n",10],["T_CLASS","class",11],["T_WHITESPACE"," ",11],["T_STRING","Website",11],["T_WHITESPACE"," ",11],["T_EXTENDS","extends",11],["T_WHITESPACE"," ",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Framework",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Model",11],["T_NS_SEPARATOR","\\",11],["T_STRING","ResourceModel",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Db",11],["T_NS_SEPARATOR","\\",11],["T_STRING","AbstractDb",11],["T_WHITESPACE","\n",11],"{",["T_WHITESPACE","\n    ",12],["T_DOC_COMMENT","\/**\n     * Store manager\n     *\n     * @var \\Magento\\Store\\Model\\StoreManagerInterface\n     *\/",13],["T_WHITESPACE","\n    ",17],["T_PROTECTED","protected",18],["T_WHITESPACE"," ",18],["T_VARIABLE","$_storeManager",18],";",["T_WHITESPACE","\n\n    ",18],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\Model\\ResourceModel\\Db\\Context $context\n     * @param \\Magento\\Store\\Model\\StoreManagerInterface $storeManager\n     * @param string $connectionName\n     *\/",20],["T_WHITESPACE","\n    ",24],["T_PUBLIC","public",25],["T_WHITESPACE"," ",25],["T_FUNCTION","function",25],["T_WHITESPACE"," ",25],["T_STRING","__construct",25],"(",["T_WHITESPACE","\n        ",25],["T_NS_SEPARATOR","\\",26],["T_STRING","Magento",26],["T_NS_SEPARATOR","\\",26],["T_STRING","Framework",26],["T_NS_SEPARATOR","\\",26],["T_STRING","Model",26],["T_NS_SEPARATOR","\\",26],["T_STRING","ResourceModel",26],["T_NS_SEPARATOR","\\",26],["T_STRING","Db",26],["T_NS_SEPARATOR","\\",26],["T_STRING","Context",26],["T_WHITESPACE"," ",26],["T_VARIABLE","$context",26],",",["T_WHITESPACE","\n        ",26],["T_NS_SEPARATOR","\\",27],["T_STRING","Magento",27],["T_NS_SEPARATOR","\\",27],["T_STRING","Store",27],["T_NS_SEPARATOR","\\",27],["T_STRING","Model",27],["T_NS_SEPARATOR","\\",27],["T_STRING","StoreManagerInterface",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$storeManager",27],",",["T_WHITESPACE","\n        ",27],["T_VARIABLE","$connectionName",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_STRING","null",28],["T_WHITESPACE","\n    ",28],")",["T_WHITESPACE"," ",29],"{",["T_WHITESPACE","\n        ",29],["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","_storeManager",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_VARIABLE","$storeManager",30],";",["T_WHITESPACE","\n        ",30],["T_STRING","parent",31],["T_DOUBLE_COLON","::",31],["T_STRING","__construct",31],"(",["T_VARIABLE","$context",31],",",["T_WHITESPACE"," ",31],["T_VARIABLE","$connectionName",31],")",";",["T_WHITESPACE","\n    ",31],"}",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * Initialize connection and define resource table\n     *\n     * @return void\n     *\/",34],["T_WHITESPACE","\n    ",38],["T_PROTECTED","protected",39],["T_WHITESPACE"," ",39],["T_FUNCTION","function",39],["T_WHITESPACE"," ",39],["T_STRING","_construct",39],"(",")",["T_WHITESPACE","\n    ",39],"{",["T_WHITESPACE","\n        ",40],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","_init",41],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_website'",41],",",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'product_id'",41],")",";",["T_WHITESPACE","\n    ",41],"}",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Removes products from websites\n     *\n     * @param array $websiteIds\n     * @param array $productIds\n     * @return $this\n     * @throws \\Exception\n     *\/",44],["T_WHITESPACE","\n    ",51],["T_PUBLIC","public",52],["T_WHITESPACE"," ",52],["T_FUNCTION","function",52],["T_WHITESPACE"," ",52],["T_STRING","removeProducts",52],"(",["T_VARIABLE","$websiteIds",52],",",["T_WHITESPACE"," ",52],["T_VARIABLE","$productIds",52],")",["T_WHITESPACE","\n    ",52],"{",["T_WHITESPACE","\n        ",53],["T_IF","if",54],["T_WHITESPACE"," ",54],"(","!",["T_STRING","is_array",54],"(",["T_VARIABLE","$websiteIds",54],")",["T_WHITESPACE"," ",54],["T_BOOLEAN_OR","||",54],["T_WHITESPACE"," ",54],"!",["T_STRING","is_array",54],"(",["T_VARIABLE","$productIds",54],")",["T_WHITESPACE"," ",54],["T_BOOLEAN_OR","||",54],["T_WHITESPACE"," ",54],["T_STRING","count",54],"(",["T_VARIABLE","$websiteIds",54],")",["T_WHITESPACE"," ",54],["T_IS_EQUAL","==",54],["T_WHITESPACE"," ",54],["T_LNUMBER","0",54],["T_WHITESPACE"," ",54],["T_BOOLEAN_OR","||",54],["T_WHITESPACE"," ",54],["T_STRING","count",54],"(",["T_VARIABLE","$productIds",54],")",["T_WHITESPACE"," ",54],["T_IS_EQUAL","==",54],["T_WHITESPACE"," ",54],["T_LNUMBER","0",54],")",["T_WHITESPACE"," ",54],"{",["T_WHITESPACE","\n            ",54],["T_RETURN","return",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$this",55],";",["T_WHITESPACE","\n        ",55],"}",["T_WHITESPACE","\n\n        ",56],["T_VARIABLE","$connection",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","getConnection",58],"(",")",";",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$whereCond",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],"[",["T_WHITESPACE","\n            ",59],["T_VARIABLE","$connection",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","quoteInto",60],"(",["T_CONSTANT_ENCAPSED_STRING","'website_id IN(?)'",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$websiteIds",60],")",",",["T_WHITESPACE","\n            ",60],["T_VARIABLE","$connection",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","quoteInto",61],"(",["T_CONSTANT_ENCAPSED_STRING","'product_id IN(?)'",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$productIds",61],")",",",["T_WHITESPACE","\n        ",61],"]",";",["T_WHITESPACE","\n        ",62],["T_VARIABLE","$whereCond",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_STRING","join",63],"(",["T_CONSTANT_ENCAPSED_STRING","' AND '",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$whereCond",63],")",";",["T_WHITESPACE","\n\n        ",63],["T_VARIABLE","$connection",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","beginTransaction",65],"(",")",";",["T_WHITESPACE","\n        ",65],["T_TRY","try",66],["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n            ",66],["T_VARIABLE","$connection",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","delete",67],"(",["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getMainTable",67],"(",")",",",["T_WHITESPACE"," ",67],["T_VARIABLE","$whereCond",67],")",";",["T_WHITESPACE","\n            ",67],["T_VARIABLE","$connection",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","commit",68],"(",")",";",["T_WHITESPACE","\n        ",68],"}",["T_WHITESPACE"," ",69],["T_CATCH","catch",69],["T_WHITESPACE"," ",69],"(",["T_NS_SEPARATOR","\\",69],["T_STRING","Exception",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$e",69],")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n            ",69],["T_VARIABLE","$connection",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","rollBack",70],"(",")",";",["T_WHITESPACE","\n            ",70],["T_THROW","throw",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$e",71],";",["T_WHITESPACE","\n        ",71],"}",["T_WHITESPACE","\n\n        ",72],["T_RETURN","return",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$this",74],";",["T_WHITESPACE","\n    ",74],"}",["T_WHITESPACE","\n\n    ",75],["T_DOC_COMMENT","\/**\n     * Add products to websites\n     *\n     * @param array $websiteIds\n     * @param array $productIds\n     * @return $this\n     * @throws \\Exception\n     *\/",77],["T_WHITESPACE","\n    ",84],["T_PUBLIC","public",85],["T_WHITESPACE"," ",85],["T_FUNCTION","function",85],["T_WHITESPACE"," ",85],["T_STRING","addProducts",85],"(",["T_VARIABLE","$websiteIds",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$productIds",85],")",["T_WHITESPACE","\n    ",85],"{",["T_WHITESPACE","\n        ",86],["T_IF","if",87],["T_WHITESPACE"," ",87],"(","!",["T_STRING","is_array",87],"(",["T_VARIABLE","$websiteIds",87],")",["T_WHITESPACE"," ",87],["T_BOOLEAN_OR","||",87],["T_WHITESPACE"," ",87],"!",["T_STRING","is_array",87],"(",["T_VARIABLE","$productIds",87],")",["T_WHITESPACE"," ",87],["T_BOOLEAN_OR","||",87],["T_WHITESPACE"," ",87],["T_STRING","count",87],"(",["T_VARIABLE","$websiteIds",87],")",["T_WHITESPACE"," ",87],["T_IS_EQUAL","==",87],["T_WHITESPACE"," ",87],["T_LNUMBER","0",87],["T_WHITESPACE"," ",87],["T_BOOLEAN_OR","||",87],["T_WHITESPACE"," ",87],["T_STRING","count",87],"(",["T_VARIABLE","$productIds",87],")",["T_WHITESPACE"," ",87],["T_IS_EQUAL","==",87],["T_WHITESPACE"," ",87],["T_LNUMBER","0",87],")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n            ",87],["T_RETURN","return",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],";",["T_WHITESPACE","\n        ",88],"}",["T_WHITESPACE","\n\n        ",89],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getConnection",91],"(",")",["T_OBJECT_OPERATOR","->",91],["T_STRING","beginTransaction",91],"(",")",";",["T_WHITESPACE","\n\n        ",91],["T_COMMENT","\/\/ Before adding of products we should remove it old rows with same ids\n",93],["T_WHITESPACE","        ",94],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","removeProducts",94],"(",["T_VARIABLE","$websiteIds",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$productIds",94],")",";",["T_WHITESPACE","\n        ",94],["T_TRY","try",95],["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n            ",95],["T_FOREACH","foreach",96],["T_WHITESPACE"," ",96],"(",["T_VARIABLE","$websiteIds",96],["T_WHITESPACE"," ",96],["T_AS","as",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$websiteId",96],")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n                ",96],["T_FOREACH","foreach",97],["T_WHITESPACE"," ",97],"(",["T_VARIABLE","$productIds",97],["T_WHITESPACE"," ",97],["T_AS","as",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$productId",97],")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n                    ",97],["T_IF","if",98],["T_WHITESPACE"," ",98],"(","!",["T_VARIABLE","$productId",98],")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n                        ",98],["T_CONTINUE","continue",99],";",["T_WHITESPACE","\n                    ",99],"}",["T_WHITESPACE","\n                    ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getConnection",101],"(",")",["T_OBJECT_OPERATOR","->",101],["T_STRING","insert",101],"(",["T_WHITESPACE","\n                        ",101],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getMainTable",102],"(",")",",",["T_WHITESPACE","\n                        ",102],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",103],["T_WHITESPACE"," ",103],["T_DOUBLE_ARROW","=>",103],["T_WHITESPACE"," ",103],["T_INT_CAST","(int)",103],["T_VARIABLE","$productId",103],",",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'website_id'",103],["T_WHITESPACE"," ",103],["T_DOUBLE_ARROW","=>",103],["T_WHITESPACE"," ",103],["T_INT_CAST","(int)",103],["T_VARIABLE","$websiteId",103],"]",["T_WHITESPACE","\n                    ",103],")",";",["T_WHITESPACE","\n                ",104],"}",["T_WHITESPACE","\n            ",105],"}",["T_WHITESPACE","\n            ",106],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","getConnection",107],"(",")",["T_OBJECT_OPERATOR","->",107],["T_STRING","commit",107],"(",")",";",["T_WHITESPACE","\n        ",107],"}",["T_WHITESPACE"," ",108],["T_CATCH","catch",108],["T_WHITESPACE"," ",108],"(",["T_NS_SEPARATOR","\\",108],["T_STRING","Exception",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$e",108],")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n            ",108],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getConnection",109],"(",")",["T_OBJECT_OPERATOR","->",109],["T_STRING","rollBack",109],"(",")",";",["T_WHITESPACE","\n            ",109],["T_THROW","throw",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$e",110],";",["T_WHITESPACE","\n        ",110],"}",["T_WHITESPACE","\n        ",111],["T_RETURN","return",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],";",["T_WHITESPACE","\n    ",112],"}",["T_WHITESPACE","\n\n    ",113],["T_DOC_COMMENT","\/**\n     * Retrieve product(s) website ids.\n     *\n     * @param array $productIds\n     * @return array\n     *\/",115],["T_WHITESPACE","\n    ",120],["T_PUBLIC","public",121],["T_WHITESPACE"," ",121],["T_FUNCTION","function",121],["T_WHITESPACE"," ",121],["T_STRING","getWebsites",121],"(",["T_VARIABLE","$productIds",121],")",["T_WHITESPACE","\n    ",121],"{",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$select",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getConnection",123],"(",")",["T_OBJECT_OPERATOR","->",123],["T_STRING","select",123],"(",")",["T_OBJECT_OPERATOR","->",123],["T_STRING","from",123],"(",["T_WHITESPACE","\n            ",123],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","getMainTable",124],"(",")",",",["T_WHITESPACE","\n            ",124],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",125],",",["T_WHITESPACE"," ",125],["T_CONSTANT_ENCAPSED_STRING","'website_id'",125],"]",["T_WHITESPACE","\n        ",125],")",["T_OBJECT_OPERATOR","->",126],["T_STRING","where",126],"(",["T_WHITESPACE","\n            ",126],["T_CONSTANT_ENCAPSED_STRING","'product_id IN (?)'",127],",",["T_WHITESPACE","\n            ",127],["T_VARIABLE","$productIds",128],["T_WHITESPACE","\n        ",128],")",";",["T_WHITESPACE","\n        ",129],["T_VARIABLE","$rowset",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getConnection",130],"(",")",["T_OBJECT_OPERATOR","->",130],["T_STRING","fetchAll",130],"(",["T_VARIABLE","$select",130],")",";",["T_WHITESPACE","\n\n        ",130],["T_VARIABLE","$result",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],"[","]",";",["T_WHITESPACE","\n        ",132],["T_FOREACH","foreach",133],["T_WHITESPACE"," ",133],"(",["T_VARIABLE","$rowset",133],["T_WHITESPACE"," ",133],["T_AS","as",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$row",133],")",["T_WHITESPACE"," ",133],"{",["T_WHITESPACE","\n            ",133],["T_VARIABLE","$result",134],"[",["T_VARIABLE","$row",134],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",134],"]","]","[","]",["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_VARIABLE","$row",134],"[",["T_CONSTANT_ENCAPSED_STRING","'website_id'",134],"]",";",["T_WHITESPACE","\n        ",134],"}",["T_WHITESPACE","\n\n        ",135],["T_RETURN","return",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$result",137],";",["T_WHITESPACE","\n    ",137],"}",["T_WHITESPACE","\n",138],"}",["T_WHITESPACE","\n",139]]