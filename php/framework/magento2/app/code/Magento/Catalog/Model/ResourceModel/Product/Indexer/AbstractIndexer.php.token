[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Catalog",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","ResourceModel",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Product",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Indexer",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Catalog",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Api",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Data",8],["T_NS_SEPARATOR","\\",8],["T_STRING","ProductInterface",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * Catalog Product Indexer Abstract Resource Model\n *\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",10],["T_WHITESPACE","\n",14],["T_ABSTRACT","abstract",15],["T_WHITESPACE"," ",15],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","AbstractIndexer",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Magento",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Indexer",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Model",15],["T_NS_SEPARATOR","\\",15],["T_STRING","ResourceModel",15],["T_NS_SEPARATOR","\\",15],["T_STRING","AbstractResource",15],["T_WHITESPACE","\n",15],"{",["T_WHITESPACE","\n    ",16],["T_DOC_COMMENT","\/**\n     * Eav config\n     *\n     * @var \\Magento\\Eav\\Model\\Config\n     *\/",17],["T_WHITESPACE","\n    ",21],["T_PROTECTED","protected",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$_eavConfig",22],";",["T_WHITESPACE","\n\n    ",22],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\EntityManager\\MetadataPool\n     *\/",24],["T_WHITESPACE","\n    ",26],["T_PROTECTED","protected",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$metadataPool",27],";",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * Class constructor\n     *\n     * @param \\Magento\\Framework\\Model\\ResourceModel\\Db\\Context $context\n     * @param \\Magento\\Framework\\Indexer\\Table\\StrategyInterface $tableStrategy\n     * @param \\Magento\\Eav\\Model\\Config $eavConfig\n     * @param string $connectionName\n     *\/",29],["T_WHITESPACE","\n    ",36],["T_PUBLIC","public",37],["T_WHITESPACE"," ",37],["T_FUNCTION","function",37],["T_WHITESPACE"," ",37],["T_STRING","__construct",37],"(",["T_WHITESPACE","\n        ",37],["T_NS_SEPARATOR","\\",38],["T_STRING","Magento",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Framework",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Model",38],["T_NS_SEPARATOR","\\",38],["T_STRING","ResourceModel",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Db",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Context",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$context",38],",",["T_WHITESPACE","\n        ",38],["T_NS_SEPARATOR","\\",39],["T_STRING","Magento",39],["T_NS_SEPARATOR","\\",39],["T_STRING","Framework",39],["T_NS_SEPARATOR","\\",39],["T_STRING","Indexer",39],["T_NS_SEPARATOR","\\",39],["T_STRING","Table",39],["T_NS_SEPARATOR","\\",39],["T_STRING","StrategyInterface",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$tableStrategy",39],",",["T_WHITESPACE","\n        ",39],["T_NS_SEPARATOR","\\",40],["T_STRING","Magento",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Eav",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Model",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Config",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$eavConfig",40],",",["T_WHITESPACE","\n        ",40],["T_VARIABLE","$connectionName",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_STRING","null",41],["T_WHITESPACE","\n    ",41],")",["T_WHITESPACE"," ",42],"{",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","_eavConfig",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_VARIABLE","$eavConfig",43],";",["T_WHITESPACE","\n        ",43],["T_STRING","parent",44],["T_DOUBLE_COLON","::",44],["T_STRING","__construct",44],"(",["T_VARIABLE","$context",44],",",["T_WHITESPACE"," ",44],["T_VARIABLE","$tableStrategy",44],",",["T_WHITESPACE"," ",44],["T_VARIABLE","$connectionName",44],")",";",["T_WHITESPACE","\n    ",44],"}",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * Retrieve catalog_product attribute instance by attribute code\n     *\n     * @param string $attributeCode\n     * @return \\Magento\\Catalog\\Model\\ResourceModel\\Eav\\Attribute\n     *\/",47],["T_WHITESPACE","\n    ",52],["T_PROTECTED","protected",53],["T_WHITESPACE"," ",53],["T_FUNCTION","function",53],["T_WHITESPACE"," ",53],["T_STRING","_getAttribute",53],"(",["T_VARIABLE","$attributeCode",53],")",["T_WHITESPACE","\n    ",53],"{",["T_WHITESPACE","\n        ",54],["T_RETURN","return",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","_eavConfig",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","getAttribute",55],"(",["T_NS_SEPARATOR","\\",55],["T_STRING","Magento",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Catalog",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Model",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Product",55],["T_DOUBLE_COLON","::",55],["T_STRING","ENTITY",55],",",["T_WHITESPACE"," ",55],["T_VARIABLE","$attributeCode",55],")",";",["T_WHITESPACE","\n    ",55],"}",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * Add attribute join condition to select and return \\Zend_Db_Expr\n     * attribute value definition\n     * If $condition is not empty apply limitation for select\n     *\n     * @param \\Magento\\Framework\\DB\\Select $select\n     * @param string $attrCode              the attribute code\n     * @param string|\\Zend_Db_Expr $entity   the entity field or expression for condition\n     * @param string|\\Zend_Db_Expr $store    the store field or expression for condition\n     * @param \\Zend_Db_Expr $condition       the limitation condition\n     * @param bool $required                if required or has condition used INNER join, else - LEFT\n     * @return \\Zend_Db_Expr                 the attribute value expression\n     *\/",58],["T_WHITESPACE","\n    ",70],["T_PROTECTED","protected",71],["T_WHITESPACE"," ",71],["T_FUNCTION","function",71],["T_WHITESPACE"," ",71],["T_STRING","_addAttributeToSelect",71],"(",["T_VARIABLE","$select",71],",",["T_WHITESPACE"," ",71],["T_VARIABLE","$attrCode",71],",",["T_WHITESPACE"," ",71],["T_VARIABLE","$entity",71],",",["T_WHITESPACE"," ",71],["T_VARIABLE","$store",71],",",["T_WHITESPACE"," ",71],["T_VARIABLE","$condition",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_STRING","null",71],",",["T_WHITESPACE"," ",71],["T_VARIABLE","$required",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_STRING","false",71],")",["T_WHITESPACE","\n    ",71],"{",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$attribute",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","_getAttribute",73],"(",["T_VARIABLE","$attrCode",73],")",";",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$attributeId",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$attribute",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","getAttributeId",74],"(",")",";",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$attributeTable",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$attribute",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getBackend",75],"(",")",["T_OBJECT_OPERATOR","->",75],["T_STRING","getTable",75],"(",")",";",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$connection",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getConnection",76],"(",")",";",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$joinType",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$condition",77],["T_WHITESPACE"," ",77],["T_IS_NOT_IDENTICAL","!==",77],["T_WHITESPACE"," ",77],["T_STRING","null",77],["T_WHITESPACE"," ",77],["T_BOOLEAN_OR","||",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$required",77],["T_WHITESPACE"," ",77],"?",["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","'join'",77],["T_WHITESPACE"," ",77],":",["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","'joinLeft'",77],";",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$productIdField",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getMetadataPool",78],"(",")",["T_OBJECT_OPERATOR","->",78],["T_STRING","getMetadata",78],"(",["T_STRING","ProductInterface",78],["T_DOUBLE_COLON","::",78],["T_CLASS","class",78],")",["T_OBJECT_OPERATOR","->",78],["T_STRING","getLinkField",78],"(",")",";",["T_WHITESPACE","\n\n        ",78],["T_IF","if",80],["T_WHITESPACE"," ",80],"(",["T_VARIABLE","$attribute",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","isScopeGlobal",80],"(",")",")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n            ",80],["T_VARIABLE","$alias",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'ta_'",81],["T_WHITESPACE"," ",81],".",["T_WHITESPACE"," ",81],["T_VARIABLE","$attrCode",81],";",["T_WHITESPACE","\n            ",81],["T_VARIABLE","$select",82],["T_OBJECT_OPERATOR","->",82],"{",["T_VARIABLE","$joinType",82],"}","(",["T_WHITESPACE","\n                ",82],"[",["T_VARIABLE","$alias",83],["T_WHITESPACE"," ",83],["T_DOUBLE_ARROW","=>",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$attributeTable",83],"]",",",["T_WHITESPACE","\n                ",83],"\"",["T_CURLY_OPEN","{",84],["T_VARIABLE","$alias",84],"}",["T_ENCAPSED_AND_WHITESPACE",".",84],["T_CURLY_OPEN","{",84],["T_VARIABLE","$productIdField",84],"}",["T_ENCAPSED_AND_WHITESPACE"," = ",84],["T_CURLY_OPEN","{",84],["T_VARIABLE","$entity",84],"}",["T_ENCAPSED_AND_WHITESPACE"," AND ",84],["T_CURLY_OPEN","{",84],["T_VARIABLE","$alias",84],"}",["T_ENCAPSED_AND_WHITESPACE",".attribute_id = ",84],["T_CURLY_OPEN","{",84],["T_VARIABLE","$attributeId",84],"}","\"",["T_WHITESPACE"," ",84],".",["T_WHITESPACE","\n                ",84],"\"",["T_ENCAPSED_AND_WHITESPACE"," AND ",85],["T_CURLY_OPEN","{",85],["T_VARIABLE","$alias",85],"}",["T_ENCAPSED_AND_WHITESPACE",".store_id = 0",85],"\"",",",["T_WHITESPACE","\n                ",85],"[","]",["T_WHITESPACE","\n            ",86],")",";",["T_WHITESPACE","\n            ",87],["T_VARIABLE","$expression",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_NEW","new",88],["T_WHITESPACE"," ",88],["T_NS_SEPARATOR","\\",88],["T_STRING","Zend_Db_Expr",88],"(","\"",["T_CURLY_OPEN","{",88],["T_VARIABLE","$alias",88],"}",["T_ENCAPSED_AND_WHITESPACE",".value",88],"\"",")",";",["T_WHITESPACE","\n        ",88],"}",["T_WHITESPACE"," ",89],["T_ELSE","else",89],["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n            ",89],["T_VARIABLE","$dAlias",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'tad_'",90],["T_WHITESPACE"," ",90],".",["T_WHITESPACE"," ",90],["T_VARIABLE","$attrCode",90],";",["T_WHITESPACE","\n            ",90],["T_VARIABLE","$sAlias",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_CONSTANT_ENCAPSED_STRING","'tas_'",91],["T_WHITESPACE"," ",91],".",["T_WHITESPACE"," ",91],["T_VARIABLE","$attrCode",91],";",["T_WHITESPACE","\n\n            ",91],["T_VARIABLE","$select",93],["T_OBJECT_OPERATOR","->",93],"{",["T_VARIABLE","$joinType",93],"}","(",["T_WHITESPACE","\n                ",93],"[",["T_VARIABLE","$dAlias",94],["T_WHITESPACE"," ",94],["T_DOUBLE_ARROW","=>",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$attributeTable",94],"]",",",["T_WHITESPACE","\n                ",94],"\"",["T_CURLY_OPEN","{",95],["T_VARIABLE","$dAlias",95],"}",["T_ENCAPSED_AND_WHITESPACE",".",95],["T_CURLY_OPEN","{",95],["T_VARIABLE","$productIdField",95],"}",["T_ENCAPSED_AND_WHITESPACE"," = ",95],["T_CURLY_OPEN","{",95],["T_VARIABLE","$entity",95],"}",["T_ENCAPSED_AND_WHITESPACE"," AND ",95],["T_CURLY_OPEN","{",95],["T_VARIABLE","$dAlias",95],"}",["T_ENCAPSED_AND_WHITESPACE",".attribute_id = ",95],["T_CURLY_OPEN","{",95],["T_VARIABLE","$attributeId",95],"}","\"",["T_WHITESPACE"," ",95],".",["T_WHITESPACE","\n                ",95],"\"",["T_ENCAPSED_AND_WHITESPACE"," AND ",96],["T_CURLY_OPEN","{",96],["T_VARIABLE","$dAlias",96],"}",["T_ENCAPSED_AND_WHITESPACE",".store_id = 0",96],"\"",",",["T_WHITESPACE","\n                ",96],"[","]",["T_WHITESPACE","\n            ",97],")",";",["T_WHITESPACE","\n            ",98],["T_VARIABLE","$select",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","joinLeft",99],"(",["T_WHITESPACE","\n                ",99],"[",["T_VARIABLE","$sAlias",100],["T_WHITESPACE"," ",100],["T_DOUBLE_ARROW","=>",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$attributeTable",100],"]",",",["T_WHITESPACE","\n                ",100],"\"",["T_CURLY_OPEN","{",101],["T_VARIABLE","$sAlias",101],"}",["T_ENCAPSED_AND_WHITESPACE",".",101],["T_CURLY_OPEN","{",101],["T_VARIABLE","$productIdField",101],"}",["T_ENCAPSED_AND_WHITESPACE"," = ",101],["T_CURLY_OPEN","{",101],["T_VARIABLE","$entity",101],"}",["T_ENCAPSED_AND_WHITESPACE"," AND ",101],["T_CURLY_OPEN","{",101],["T_VARIABLE","$sAlias",101],"}",["T_ENCAPSED_AND_WHITESPACE",".attribute_id = ",101],["T_CURLY_OPEN","{",101],["T_VARIABLE","$attributeId",101],"}","\"",["T_WHITESPACE"," ",101],".",["T_WHITESPACE","\n                ",101],"\"",["T_ENCAPSED_AND_WHITESPACE"," AND ",102],["T_CURLY_OPEN","{",102],["T_VARIABLE","$sAlias",102],"}",["T_ENCAPSED_AND_WHITESPACE",".store_id = ",102],["T_CURLY_OPEN","{",102],["T_VARIABLE","$store",102],"}","\"",",",["T_WHITESPACE","\n                ",102],"[","]",["T_WHITESPACE","\n            ",103],")",";",["T_WHITESPACE","\n            ",104],["T_VARIABLE","$expression",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$connection",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getCheckSql",105],"(",["T_WHITESPACE","\n                ",105],["T_VARIABLE","$connection",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","getIfNullSql",106],"(","\"",["T_CURLY_OPEN","{",106],["T_VARIABLE","$sAlias",106],"}",["T_ENCAPSED_AND_WHITESPACE",".value_id",106],"\"",",",["T_WHITESPACE"," ",106],"-",["T_LNUMBER","1",106],")",["T_WHITESPACE"," ",106],".",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","' > 0'",106],",",["T_WHITESPACE","\n                ",106],"\"",["T_CURLY_OPEN","{",107],["T_VARIABLE","$sAlias",107],"}",["T_ENCAPSED_AND_WHITESPACE",".value",107],"\"",",",["T_WHITESPACE","\n                ",107],"\"",["T_CURLY_OPEN","{",108],["T_VARIABLE","$dAlias",108],"}",["T_ENCAPSED_AND_WHITESPACE",".value",108],"\"",["T_WHITESPACE","\n            ",108],")",";",["T_WHITESPACE","\n        ",109],"}",["T_WHITESPACE","\n\n        ",110],["T_IF","if",112],["T_WHITESPACE"," ",112],"(",["T_VARIABLE","$condition",112],["T_WHITESPACE"," ",112],["T_IS_NOT_IDENTICAL","!==",112],["T_WHITESPACE"," ",112],["T_STRING","null",112],")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n            ",112],["T_VARIABLE","$select",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","where",113],"(","\"",["T_CURLY_OPEN","{",113],["T_VARIABLE","$expression",113],"}",["T_CURLY_OPEN","{",113],["T_VARIABLE","$condition",113],"}","\"",")",";",["T_WHITESPACE","\n        ",113],"}",["T_WHITESPACE","\n\n        ",114],["T_RETURN","return",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$expression",116],";",["T_WHITESPACE","\n    ",116],"}",["T_WHITESPACE","\n\n    ",117],["T_DOC_COMMENT","\/**\n     * Add website data join to select\n     * If add default store join also limitation of only has default store website\n     * Joined table has aliases\n     *  cw for website table,\n     *  csg for store group table (joined by website default group)\n     *  cs for store table (joined by website default store)\n     *\n     * @param \\Magento\\Framework\\DB\\Select $select the select object\n     * @param bool $store add default store join\n     * @param string|\\Zend_Db_Expr $joinCondition the limitation for website_id\n     * @return $this\n     *\/",119],["T_WHITESPACE","\n    ",131],["T_PROTECTED","protected",132],["T_WHITESPACE"," ",132],["T_FUNCTION","function",132],["T_WHITESPACE"," ",132],["T_STRING","_addWebsiteJoinToSelect",132],"(",["T_VARIABLE","$select",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$store",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_STRING","true",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$joinCondition",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_STRING","null",132],")",["T_WHITESPACE","\n    ",132],"{",["T_WHITESPACE","\n        ",133],["T_IF","if",134],["T_WHITESPACE"," ",134],"(",["T_VARIABLE","$joinCondition",134],["T_WHITESPACE"," ",134],["T_IS_NOT_IDENTICAL","!==",134],["T_WHITESPACE"," ",134],["T_STRING","null",134],")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n            ",134],["T_VARIABLE","$joinCondition",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","'cw.website_id = '",135],["T_WHITESPACE"," ",135],".",["T_WHITESPACE"," ",135],["T_VARIABLE","$joinCondition",135],";",["T_WHITESPACE","\n        ",135],"}",["T_WHITESPACE","\n\n        ",136],["T_VARIABLE","$select",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","join",138],"(","[",["T_CONSTANT_ENCAPSED_STRING","'cw'",138],["T_WHITESPACE"," ",138],["T_DOUBLE_ARROW","=>",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","getTable",138],"(",["T_CONSTANT_ENCAPSED_STRING","'store_website'",138],")","]",",",["T_WHITESPACE"," ",138],["T_VARIABLE","$joinCondition",138],",",["T_WHITESPACE"," ",138],"[","]",")",";",["T_WHITESPACE","\n\n        ",138],["T_IF","if",140],["T_WHITESPACE"," ",140],"(",["T_VARIABLE","$store",140],")",["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n            ",140],["T_VARIABLE","$select",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","join",141],"(",["T_WHITESPACE","\n                ",141],"[",["T_CONSTANT_ENCAPSED_STRING","'csg'",142],["T_WHITESPACE"," ",142],["T_DOUBLE_ARROW","=>",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","getTable",142],"(",["T_CONSTANT_ENCAPSED_STRING","'store_group'",142],")","]",",",["T_WHITESPACE","\n                ",142],["T_CONSTANT_ENCAPSED_STRING","'csg.group_id = cw.default_group_id'",143],",",["T_WHITESPACE","\n                ",143],"[","]",["T_WHITESPACE","\n            ",144],")",["T_OBJECT_OPERATOR","->",145],["T_STRING","join",145],"(",["T_WHITESPACE","\n                ",145],"[",["T_CONSTANT_ENCAPSED_STRING","'cs'",146],["T_WHITESPACE"," ",146],["T_DOUBLE_ARROW","=>",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","getTable",146],"(",["T_CONSTANT_ENCAPSED_STRING","'store'",146],")","]",",",["T_WHITESPACE","\n                ",146],["T_CONSTANT_ENCAPSED_STRING","'cs.store_id = csg.default_store_id'",147],",",["T_WHITESPACE","\n                ",147],"[","]",["T_WHITESPACE","\n            ",148],")",";",["T_WHITESPACE","\n        ",149],"}",["T_WHITESPACE","\n\n        ",150],["T_RETURN","return",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],";",["T_WHITESPACE","\n    ",152],"}",["T_WHITESPACE","\n\n    ",153],["T_DOC_COMMENT","\/**\n     * Add join for catalog\/product_website table\n     * Joined table has alias pw\n     *\n     * @param \\Magento\\Framework\\DB\\Select $select the select object\n     * @param string|\\Zend_Db_Expr $website the limitation of website_id\n     * @param string|\\Zend_Db_Expr $product the limitation of product_id\n     * @return $this\n     *\/",155],["T_WHITESPACE","\n    ",163],["T_PROTECTED","protected",164],["T_WHITESPACE"," ",164],["T_FUNCTION","function",164],["T_WHITESPACE"," ",164],["T_STRING","_addProductWebsiteJoinToSelect",164],"(",["T_VARIABLE","$select",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$website",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$product",164],")",["T_WHITESPACE","\n    ",164],"{",["T_WHITESPACE","\n        ",165],["T_VARIABLE","$select",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","join",166],"(",["T_WHITESPACE","\n            ",166],"[",["T_CONSTANT_ENCAPSED_STRING","'pw'",167],["T_WHITESPACE"," ",167],["T_DOUBLE_ARROW","=>",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","getTable",167],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_website'",167],")","]",",",["T_WHITESPACE","\n            ",167],"\"",["T_ENCAPSED_AND_WHITESPACE","pw.product_id = ",168],["T_CURLY_OPEN","{",168],["T_VARIABLE","$product",168],"}",["T_ENCAPSED_AND_WHITESPACE"," AND pw.website_id = ",168],["T_CURLY_OPEN","{",168],["T_VARIABLE","$website",168],"}","\"",",",["T_WHITESPACE","\n            ",168],"[","]",["T_WHITESPACE","\n        ",169],")",";",["T_WHITESPACE","\n\n        ",170],["T_RETURN","return",172],["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],";",["T_WHITESPACE","\n    ",172],"}",["T_WHITESPACE","\n\n    ",173],["T_DOC_COMMENT","\/**\n     * Retrieve product relations by children\n     *\n     * @param int|array $childIds\n     * @return array\n     *\/",175],["T_WHITESPACE","\n    ",180],["T_PUBLIC","public",181],["T_WHITESPACE"," ",181],["T_FUNCTION","function",181],["T_WHITESPACE"," ",181],["T_STRING","getRelationsByChild",181],"(",["T_VARIABLE","$childIds",181],")",["T_WHITESPACE","\n    ",181],"{",["T_WHITESPACE","\n        ",182],["T_VARIABLE","$connection",183],["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","getConnection",183],"(",")",";",["T_WHITESPACE","\n        ",183],["T_VARIABLE","$linkField",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getMetadataPool",184],"(",")",["T_OBJECT_OPERATOR","->",184],["T_STRING","getMetadata",184],"(",["T_STRING","ProductInterface",184],["T_DOUBLE_COLON","::",184],["T_CLASS","class",184],")",["T_OBJECT_OPERATOR","->",184],["T_STRING","getLinkField",184],"(",")",";",["T_WHITESPACE","\n        ",184],["T_VARIABLE","$select",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_VARIABLE","$connection",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","select",185],"(",")",["T_OBJECT_OPERATOR","->",185],["T_STRING","from",185],"(",["T_WHITESPACE","\n            ",185],"[",["T_CONSTANT_ENCAPSED_STRING","'relation'",186],["T_WHITESPACE"," ",186],["T_DOUBLE_ARROW","=>",186],["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","getTable",186],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_relation'",186],")","]",",",["T_WHITESPACE","\n            ",186],"[","]",["T_WHITESPACE","\n        ",187],")",["T_OBJECT_OPERATOR","->",188],["T_STRING","join",188],"(",["T_WHITESPACE","\n            ",188],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",189],["T_WHITESPACE"," ",189],["T_DOUBLE_ARROW","=>",189],["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getTable",189],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity'",189],")","]",",",["T_WHITESPACE","\n            ",189],["T_CONSTANT_ENCAPSED_STRING","'e.'",190],["T_WHITESPACE"," ",190],".",["T_WHITESPACE"," ",190],["T_VARIABLE","$linkField",190],["T_WHITESPACE"," ",190],".",["T_WHITESPACE"," ",190],["T_CONSTANT_ENCAPSED_STRING","' = relation.parent_id'",190],",",["T_WHITESPACE","\n            ",190],"[",["T_CONSTANT_ENCAPSED_STRING","'e.entity_id'",191],"]",["T_WHITESPACE","\n        ",191],")",["T_OBJECT_OPERATOR","->",192],["T_STRING","where",192],"(",["T_WHITESPACE","\n            ",192],["T_CONSTANT_ENCAPSED_STRING","'relation.child_id IN(?)'",193],",",["T_WHITESPACE","\n            ",193],["T_VARIABLE","$childIds",194],["T_WHITESPACE","\n        ",194],")",";",["T_WHITESPACE","\n\n        ",195],["T_RETURN","return",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$connection",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","fetchCol",197],"(",["T_VARIABLE","$select",197],")",";",["T_WHITESPACE","\n    ",197],"}",["T_WHITESPACE","\n\n    ",198],["T_DOC_COMMENT","\/**\n     * Retrieve product relations by parents\n     *\n     * @param int|array $parentIds\n     * @return array\n     *\/",200],["T_WHITESPACE","\n    ",205],["T_PUBLIC","public",206],["T_WHITESPACE"," ",206],["T_FUNCTION","function",206],["T_WHITESPACE"," ",206],["T_STRING","getRelationsByParent",206],"(",["T_VARIABLE","$parentIds",206],")",["T_WHITESPACE","\n    ",206],"{",["T_WHITESPACE","\n        ",207],["T_IF","if",208],["T_WHITESPACE"," ",208],"(","!",["T_STRING","is_array",208],"(",["T_VARIABLE","$parentIds",208],")",")",["T_WHITESPACE"," ",208],"{",["T_WHITESPACE","\n            ",208],["T_VARIABLE","$parentIds",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],"[",["T_VARIABLE","$parentIds",209],"]",";",["T_WHITESPACE","\n        ",209],"}",["T_WHITESPACE","\n\n        ",210],["T_VARIABLE","$result",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],"[","]",";",["T_WHITESPACE","\n        ",212],["T_IF","if",213],["T_WHITESPACE"," ",213],"(","!",["T_EMPTY","empty",213],"(",["T_VARIABLE","$parentIds",213],")",")",["T_WHITESPACE"," ",213],"{",["T_WHITESPACE","\n            ",213],["T_VARIABLE","$connection",214],["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","getConnection",214],"(",")",";",["T_WHITESPACE","\n            ",214],["T_VARIABLE","$linkField",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","getMetadataPool",215],"(",")",["T_OBJECT_OPERATOR","->",215],["T_STRING","getMetadata",215],"(",["T_STRING","ProductInterface",215],["T_DOUBLE_COLON","::",215],["T_CLASS","class",215],")",["T_OBJECT_OPERATOR","->",215],["T_STRING","getLinkField",215],"(",")",";",["T_WHITESPACE","\n            ",215],["T_VARIABLE","$select",216],["T_WHITESPACE"," ",216],"=",["T_WHITESPACE"," ",216],["T_VARIABLE","$connection",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","select",216],"(",")",["T_OBJECT_OPERATOR","->",216],["T_STRING","from",216],"(",["T_WHITESPACE","\n                ",216],"[",["T_CONSTANT_ENCAPSED_STRING","'cpr'",217],["T_WHITESPACE"," ",217],["T_DOUBLE_ARROW","=>",217],["T_WHITESPACE"," ",217],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","getTable",217],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_relation'",217],")","]",",",["T_WHITESPACE","\n                ",217],["T_CONSTANT_ENCAPSED_STRING","'child_id'",218],["T_WHITESPACE","\n            ",218],")",["T_OBJECT_OPERATOR","->",219],["T_STRING","join",219],"(",["T_WHITESPACE","\n                ",219],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",220],["T_WHITESPACE"," ",220],["T_DOUBLE_ARROW","=>",220],["T_WHITESPACE"," ",220],["T_VARIABLE","$this",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","getTable",220],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity'",220],")","]",",",["T_WHITESPACE","\n                ",220],["T_CONSTANT_ENCAPSED_STRING","'e.'",221],["T_WHITESPACE"," ",221],".",["T_WHITESPACE"," ",221],["T_VARIABLE","$linkField",221],["T_WHITESPACE"," ",221],".",["T_WHITESPACE"," ",221],["T_CONSTANT_ENCAPSED_STRING","' = cpr.parent_id'",221],["T_WHITESPACE","\n            ",221],")",["T_OBJECT_OPERATOR","->",222],["T_STRING","where",222],"(",["T_WHITESPACE","\n                ",222],["T_CONSTANT_ENCAPSED_STRING","'e.entity_id IN(?)'",223],",",["T_WHITESPACE","\n                ",223],["T_VARIABLE","$parentIds",224],["T_WHITESPACE","\n            ",224],")",";",["T_WHITESPACE","\n            ",225],["T_VARIABLE","$result",226],["T_WHITESPACE"," ",226],"=",["T_WHITESPACE"," ",226],["T_VARIABLE","$connection",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","fetchCol",226],"(",["T_VARIABLE","$select",226],")",";",["T_WHITESPACE","\n        ",226],"}",["T_WHITESPACE","\n\n        ",227],["T_RETURN","return",229],["T_WHITESPACE"," ",229],["T_VARIABLE","$result",229],";",["T_WHITESPACE","\n    ",229],"}",["T_WHITESPACE","\n\n    ",230],["T_DOC_COMMENT","\/**\n     * @return \\Magento\\Framework\\EntityManager\\MetadataPool\n     *\/",232],["T_WHITESPACE","\n    ",234],["T_PROTECTED","protected",235],["T_WHITESPACE"," ",235],["T_FUNCTION","function",235],["T_WHITESPACE"," ",235],["T_STRING","getMetadataPool",235],"(",")",["T_WHITESPACE","\n    ",235],"{",["T_WHITESPACE","\n        ",236],["T_IF","if",237],["T_WHITESPACE"," ",237],"(",["T_STRING","null",237],["T_WHITESPACE"," ",237],["T_IS_IDENTICAL","===",237],["T_WHITESPACE"," ",237],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","metadataPool",237],")",["T_WHITESPACE"," ",237],"{",["T_WHITESPACE","\n            ",237],["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","metadataPool",238],["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],["T_NS_SEPARATOR","\\",238],["T_STRING","Magento",238],["T_NS_SEPARATOR","\\",238],["T_STRING","Framework",238],["T_NS_SEPARATOR","\\",238],["T_STRING","App",238],["T_NS_SEPARATOR","\\",238],["T_STRING","ObjectManager",238],["T_DOUBLE_COLON","::",238],["T_STRING","getInstance",238],"(",")",["T_WHITESPACE","\n                ",238],["T_OBJECT_OPERATOR","->",239],["T_STRING","get",239],"(",["T_NS_SEPARATOR","\\",239],["T_STRING","Magento",239],["T_NS_SEPARATOR","\\",239],["T_STRING","Framework",239],["T_NS_SEPARATOR","\\",239],["T_STRING","EntityManager",239],["T_NS_SEPARATOR","\\",239],["T_STRING","MetadataPool",239],["T_DOUBLE_COLON","::",239],["T_CLASS","class",239],")",";",["T_WHITESPACE","\n        ",239],"}",["T_WHITESPACE","\n        ",240],["T_RETURN","return",241],["T_WHITESPACE"," ",241],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","metadataPool",241],";",["T_WHITESPACE","\n    ",241],"}",["T_WHITESPACE","\n",242],"}",["T_WHITESPACE","\n",243]]