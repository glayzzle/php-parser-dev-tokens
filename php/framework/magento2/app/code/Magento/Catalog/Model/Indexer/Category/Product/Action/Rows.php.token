[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Catalog",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Indexer",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Category",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Product",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Action",6],";",["T_WHITESPACE","\n\n",6],["T_CLASS","class",8],["T_WHITESPACE"," ",8],["T_STRING","Rows",8],["T_WHITESPACE"," ",8],["T_EXTENDS","extends",8],["T_WHITESPACE"," ",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Catalog",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Model",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Indexer",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Category",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Product",8],["T_NS_SEPARATOR","\\",8],["T_STRING","AbstractAction",8],["T_WHITESPACE","\n",8],"{",["T_WHITESPACE","\n    ",9],["T_DOC_COMMENT","\/**\n     * Limitation by categories\n     *\n     * @var int[]\n     *\/",10],["T_WHITESPACE","\n    ",14],["T_PROTECTED","protected",15],["T_WHITESPACE"," ",15],["T_VARIABLE","$limitationByCategories",15],";",["T_WHITESPACE","\n\n    ",15],["T_DOC_COMMENT","\/**\n     * Refresh entities index\n     *\n     * @param int[] $entityIds\n     * @param bool $useTempTable\n     * @return $this\n     *\/",17],["T_WHITESPACE","\n    ",23],["T_PUBLIC","public",24],["T_WHITESPACE"," ",24],["T_FUNCTION","function",24],["T_WHITESPACE"," ",24],["T_STRING","execute",24],"(",["T_ARRAY","array",24],["T_WHITESPACE"," ",24],["T_VARIABLE","$entityIds",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],"[","]",",",["T_WHITESPACE"," ",24],["T_VARIABLE","$useTempTable",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_STRING","false",24],")",["T_WHITESPACE","\n    ",24],"{",["T_WHITESPACE","\n        ",25],["T_VARIABLE","$this",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","limitationByCategories",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_VARIABLE","$entityIds",26],";",["T_WHITESPACE","\n        ",26],["T_VARIABLE","$this",27],["T_OBJECT_OPERATOR","->",27],["T_STRING","useTempTable",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],["T_VARIABLE","$useTempTable",27],";",["T_WHITESPACE","\n\n        ",27],["T_VARIABLE","$this",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","removeEntries",29],"(",")",";",["T_WHITESPACE","\n\n        ",29],["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","reindex",31],"(",")",";",["T_WHITESPACE","\n\n        ",31],["T_RETURN","return",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$this",33],";",["T_WHITESPACE","\n    ",33],"}",["T_WHITESPACE","\n\n    ",34],["T_DOC_COMMENT","\/**\n     * Return array of all category root IDs + tree root ID\n     *\n     * @return int[]\n     *\/",36],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_FUNCTION","function",41],["T_WHITESPACE"," ",41],["T_STRING","getRootCategoryIds",41],"(",")",["T_WHITESPACE","\n    ",41],"{",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$rootIds",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],"[",["T_NS_SEPARATOR","\\",43],["T_STRING","Magento",43],["T_NS_SEPARATOR","\\",43],["T_STRING","Catalog",43],["T_NS_SEPARATOR","\\",43],["T_STRING","Model",43],["T_NS_SEPARATOR","\\",43],["T_STRING","Category",43],["T_DOUBLE_COLON","::",43],["T_STRING","TREE_ROOT_ID",43],"]",";",["T_WHITESPACE","\n        ",43],["T_FOREACH","foreach",44],["T_WHITESPACE"," ",44],"(",["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","storeManager",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","getStores",44],"(",")",["T_WHITESPACE"," ",44],["T_AS","as",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$store",44],")",["T_WHITESPACE"," ",44],"{",["T_WHITESPACE","\n            ",44],["T_IF","if",45],["T_WHITESPACE"," ",45],"(",["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","getPathFromCategoryId",45],"(",["T_VARIABLE","$store",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","getRootCategoryId",45],"(",")",")",")",["T_WHITESPACE"," ",45],"{",["T_WHITESPACE","\n                ",45],["T_VARIABLE","$rootIds",46],"[","]",["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$store",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","getRootCategoryId",46],"(",")",";",["T_WHITESPACE","\n            ",46],"}",["T_WHITESPACE","\n        ",47],"}",["T_WHITESPACE","\n        ",48],["T_RETURN","return",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$rootIds",49],";",["T_WHITESPACE","\n    ",49],"}",["T_WHITESPACE","\n\n    ",50],["T_DOC_COMMENT","\/**\n     * Remove index entries before reindexation\n     *\n     * @return void\n     *\/",52],["T_WHITESPACE","\n    ",56],["T_PROTECTED","protected",57],["T_WHITESPACE"," ",57],["T_FUNCTION","function",57],["T_WHITESPACE"," ",57],["T_STRING","removeEntries",57],"(",")",["T_WHITESPACE","\n    ",57],"{",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$removalCategoryIds",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_STRING","array_diff",59],"(",["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","limitationByCategories",59],",",["T_WHITESPACE"," ",59],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","getRootCategoryIds",59],"(",")",")",";",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","connection",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","delete",60],"(",["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","getMainTable",60],"(",")",",",["T_WHITESPACE"," ",60],"[",["T_CONSTANT_ENCAPSED_STRING","'category_id IN (?)'",60],["T_WHITESPACE"," ",60],["T_DOUBLE_ARROW","=>",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$removalCategoryIds",60],"]",")",";",["T_WHITESPACE","\n    ",60],"}",["T_WHITESPACE","\n\n    ",61],["T_DOC_COMMENT","\/**\n     * Retrieve select for reindex products of non anchor categories\n     *\n     * @param \\Magento\\Store\\Model\\Store $store\n     * @return \\Magento\\Framework\\DB\\Select\n     *\/",63],["T_WHITESPACE","\n    ",68],["T_PROTECTED","protected",69],["T_WHITESPACE"," ",69],["T_FUNCTION","function",69],["T_WHITESPACE"," ",69],["T_STRING","getNonAnchorCategoriesSelect",69],"(",["T_NS_SEPARATOR","\\",69],["T_STRING","Magento",69],["T_NS_SEPARATOR","\\",69],["T_STRING","Store",69],["T_NS_SEPARATOR","\\",69],["T_STRING","Model",69],["T_NS_SEPARATOR","\\",69],["T_STRING","Store",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$store",69],")",["T_WHITESPACE","\n    ",69],"{",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$select",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_STRING","parent",71],["T_DOUBLE_COLON","::",71],["T_STRING","getNonAnchorCategoriesSelect",71],"(",["T_VARIABLE","$store",71],")",";",["T_WHITESPACE","\n        ",71],["T_RETURN","return",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$select",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","where",72],"(",["T_CONSTANT_ENCAPSED_STRING","'cc.entity_id IN (?)'",72],",",["T_WHITESPACE"," ",72],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","limitationByCategories",72],")",";",["T_WHITESPACE","\n    ",72],"}",["T_WHITESPACE","\n\n    ",73],["T_DOC_COMMENT","\/**\n     * Retrieve select for reindex products of non anchor categories\n     *\n     * @param \\Magento\\Store\\Model\\Store $store\n     * @return \\Magento\\Framework\\DB\\Select\n     *\/",75],["T_WHITESPACE","\n    ",80],["T_PROTECTED","protected",81],["T_WHITESPACE"," ",81],["T_FUNCTION","function",81],["T_WHITESPACE"," ",81],["T_STRING","getAnchorCategoriesSelect",81],"(",["T_NS_SEPARATOR","\\",81],["T_STRING","Magento",81],["T_NS_SEPARATOR","\\",81],["T_STRING","Store",81],["T_NS_SEPARATOR","\\",81],["T_STRING","Model",81],["T_NS_SEPARATOR","\\",81],["T_STRING","Store",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$store",81],")",["T_WHITESPACE","\n    ",81],"{",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$select",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_STRING","parent",83],["T_DOUBLE_COLON","::",83],["T_STRING","getAnchorCategoriesSelect",83],"(",["T_VARIABLE","$store",83],")",";",["T_WHITESPACE","\n        ",83],["T_RETURN","return",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$select",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","where",84],"(",["T_CONSTANT_ENCAPSED_STRING","'cc.entity_id IN (?)'",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","limitationByCategories",84],")",";",["T_WHITESPACE","\n    ",84],"}",["T_WHITESPACE","\n\n    ",85],["T_DOC_COMMENT","\/**\n     * Check whether select ranging is needed\n     *\n     * @return bool\n     *\/",87],["T_WHITESPACE","\n    ",91],["T_PROTECTED","protected",92],["T_WHITESPACE"," ",92],["T_FUNCTION","function",92],["T_WHITESPACE"," ",92],["T_STRING","isRangingNeeded",92],"(",")",["T_WHITESPACE","\n    ",92],"{",["T_WHITESPACE","\n        ",93],["T_RETURN","return",94],["T_WHITESPACE"," ",94],["T_STRING","false",94],";",["T_WHITESPACE","\n    ",94],"}",["T_WHITESPACE","\n\n    ",95],["T_DOC_COMMENT","\/**\n     * Check whether indexation of root category is needed\n     *\n     * @return bool\n     *\/",97],["T_WHITESPACE","\n    ",101],["T_PROTECTED","protected",102],["T_WHITESPACE"," ",102],["T_FUNCTION","function",102],["T_WHITESPACE"," ",102],["T_STRING","isIndexRootCategoryNeeded",102],"(",")",["T_WHITESPACE","\n    ",102],"{",["T_WHITESPACE","\n        ",103],["T_RETURN","return",104],["T_WHITESPACE"," ",104],["T_STRING","false",104],";",["T_WHITESPACE","\n    ",104],"}",["T_WHITESPACE","\n",105],"}",["T_WHITESPACE","\n",106]]