[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_COMMENT","\/\/ @codingStandardsIgnoreFile\n",7],["T_WHITESPACE","\n",8],["T_DOC_COMMENT","\/**\n * Catalog Template Filter Model\n *\n * @author      Magento Core Team <core@magentocommerce.com>\n * @todo        Needs to be reimplemented to get rid of the copypasted methods\n *\/",9],["T_WHITESPACE","\n",14],["T_NAMESPACE","namespace",15],["T_WHITESPACE"," ",15],["T_STRING","Magento",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Catalog",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Model",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Template",15],";",["T_WHITESPACE","\n\n",15],["T_DOC_COMMENT","\/**\n * Work with catalog(store, website) urls\n *\n * @package Magento\\Catalog\\Model\\Template\n *\/",17],["T_WHITESPACE","\n",21],["T_CLASS","class",22],["T_WHITESPACE"," ",22],["T_STRING","Filter",22],["T_WHITESPACE"," ",22],["T_EXTENDS","extends",22],["T_WHITESPACE"," ",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Magento",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Framework",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Filter",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Template",22],["T_WHITESPACE","\n",22],"{",["T_WHITESPACE","\n    ",23],["T_DOC_COMMENT","\/**\n     * Use absolute links flag\n     *\n     * @var bool\n     *\/",24],["T_WHITESPACE","\n    ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$_useAbsoluteLinks",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_STRING","false",29],";",["T_WHITESPACE","\n\n    ",29],["T_DOC_COMMENT","\/**\n     * Whether to allow SID in store directive: NO\n     *\n     * @var bool\n     *\/",31],["T_WHITESPACE","\n    ",35],["T_PROTECTED","protected",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$_useSessionInUrl",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_STRING","false",36],";",["T_WHITESPACE","\n\n    ",36],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\View\\Asset\\Repository\n     *\/",38],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$_assetRepo",41],";",["T_WHITESPACE","\n\n    ",41],["T_DOC_COMMENT","\/**\n     * Store manager\n     *\n     * @var \\Magento\\Store\\Model\\StoreManagerInterface\n     *\/",43],["T_WHITESPACE","\n    ",47],["T_PROTECTED","protected",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$_storeManager",48],";",["T_WHITESPACE","\n\n    ",48],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\Stdlib\\StringUtils $string\n     * @param \\Magento\\Store\\Model\\StoreManagerInterface $storeManager\n     * @param \\Magento\\Framework\\View\\Asset\\Repository $assetRepo\n     * @param array $variables\n     *\/",50],["T_WHITESPACE","\n    ",55],["T_PUBLIC","public",56],["T_WHITESPACE"," ",56],["T_FUNCTION","function",56],["T_WHITESPACE"," ",56],["T_STRING","__construct",56],"(",["T_WHITESPACE","\n        ",56],["T_NS_SEPARATOR","\\",57],["T_STRING","Magento",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Framework",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Stdlib",57],["T_NS_SEPARATOR","\\",57],["T_STRING","StringUtils",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$string",57],",",["T_WHITESPACE","\n        ",57],["T_NS_SEPARATOR","\\",58],["T_STRING","Magento",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Store",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Model",58],["T_NS_SEPARATOR","\\",58],["T_STRING","StoreManagerInterface",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$storeManager",58],",",["T_WHITESPACE","\n        ",58],["T_NS_SEPARATOR","\\",59],["T_STRING","Magento",59],["T_NS_SEPARATOR","\\",59],["T_STRING","Framework",59],["T_NS_SEPARATOR","\\",59],["T_STRING","View",59],["T_NS_SEPARATOR","\\",59],["T_STRING","Asset",59],["T_NS_SEPARATOR","\\",59],["T_STRING","Repository",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$assetRepo",59],",",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$variables",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],"[","]",["T_WHITESPACE","\n    ",60],")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n        ",61],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","_storeManager",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_VARIABLE","$storeManager",62],";",["T_WHITESPACE","\n        ",62],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","_assetRepo",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_VARIABLE","$assetRepo",63],";",["T_WHITESPACE","\n        ",63],["T_STRING","parent",64],["T_DOUBLE_COLON","::",64],["T_STRING","__construct",64],"(",["T_VARIABLE","$string",64],",",["T_WHITESPACE"," ",64],["T_VARIABLE","$variables",64],")",";",["T_WHITESPACE","\n    ",64],"}",["T_WHITESPACE","\n\n    ",65],["T_DOC_COMMENT","\/**\n     * Set use absolute links flag\n     *\n     * @param bool $flag\n     * @return \\Magento\\Email\\Model\\Template\\Filter\n     *\/",67],["T_WHITESPACE","\n    ",72],["T_PUBLIC","public",73],["T_WHITESPACE"," ",73],["T_FUNCTION","function",73],["T_WHITESPACE"," ",73],["T_STRING","setUseAbsoluteLinks",73],"(",["T_VARIABLE","$flag",73],")",["T_WHITESPACE","\n    ",73],"{",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","_useAbsoluteLinks",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$flag",75],";",["T_WHITESPACE","\n        ",75],["T_RETURN","return",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],";",["T_WHITESPACE","\n    ",76],"}",["T_WHITESPACE","\n\n    ",77],["T_DOC_COMMENT","\/**\n     * Setter whether SID is allowed in store directive\n     * Doesn't set anything intentionally, since SID is not allowed in any kind of emails\n     *\n     * @param bool $flag\n     * @return \\Magento\\Email\\Model\\Template\\Filter\n     *\/",79],["T_WHITESPACE","\n    ",85],["T_PUBLIC","public",86],["T_WHITESPACE"," ",86],["T_FUNCTION","function",86],["T_WHITESPACE"," ",86],["T_STRING","setUseSessionInUrl",86],"(",["T_VARIABLE","$flag",86],")",["T_WHITESPACE","\n    ",86],"{",["T_WHITESPACE","\n        ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","_useSessionInUrl",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$flag",88],";",["T_WHITESPACE","\n        ",88],["T_RETURN","return",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],";",["T_WHITESPACE","\n    ",89],"}",["T_WHITESPACE","\n\n    ",90],["T_DOC_COMMENT","\/**\n     * Retrieve View URL directive\n     *\n     * @param array $construction\n     * @return string\n     * @see \\Magento\\Email\\Model\\Template\\Filter::viewDirective() method has been copypasted\n     *\/",92],["T_WHITESPACE","\n    ",98],["T_PUBLIC","public",99],["T_WHITESPACE"," ",99],["T_FUNCTION","function",99],["T_WHITESPACE"," ",99],["T_STRING","viewDirective",99],"(",["T_VARIABLE","$construction",99],")",["T_WHITESPACE","\n    ",99],"{",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$params",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getParameters",101],"(",["T_VARIABLE","$construction",101],"[",["T_LNUMBER","2",101],"]",")",";",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$params",102],"[",["T_CONSTANT_ENCAPSED_STRING","'_absolute'",102],"]",["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","_useAbsoluteLinks",102],";",["T_WHITESPACE","\n        ",102],["T_DOC_COMMENT","\/**\n         * @bug: the \"_absolute\" key is not supported by underlying services\n         * probably this happened because of multitude of refactorings in past\n         * The original intent of _absolute parameter was to simply append specified path to a base URL\n         * bypassing any kind of processing.\n         * For example, normally you would use {{view url=\"css\/styles.css\"}} directive which would automatically resolve\n         * into something like http:\/\/example.com\/pub\/static\/area\/theme\/en_US\/css\/styles.css\n         * But with _absolute, the expected behavior is this: {{view url=\"favicon.ico\" _absolute=true}} should resolve\n         * into something like http:\/\/example.com\/favicon.ico\n         *\n         * To fix the issue, it is better not to maintain the _absolute parameter anymore in undrelying services,\n         * but instead just create a different type of directive, for example {{baseUrl path=\"favicon.ico\"}}\n         *\/",103],["T_WHITESPACE","\n        ",115],["T_VARIABLE","$url",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","_assetRepo",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getUrlWithParams",116],"(",["T_VARIABLE","$params",116],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",116],"]",",",["T_WHITESPACE"," ",116],["T_VARIABLE","$params",116],")",";",["T_WHITESPACE","\n\n        ",116],["T_RETURN","return",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$url",118],";",["T_WHITESPACE","\n    ",118],"}",["T_WHITESPACE","\n\n    ",119],["T_DOC_COMMENT","\/**\n     * Retrieve media file URL directive\n     *\n     * @param array $construction\n     * @return string\n     * @see \\Magento\\Email\\Model\\Template\\Filter::mediaDirective() method has been copypasted\n     *\/",121],["T_WHITESPACE","\n    ",127],["T_PUBLIC","public",128],["T_WHITESPACE"," ",128],["T_FUNCTION","function",128],["T_WHITESPACE"," ",128],["T_STRING","mediaDirective",128],"(",["T_VARIABLE","$construction",128],")",["T_WHITESPACE","\n    ",128],"{",["T_WHITESPACE","\n        ",129],["T_VARIABLE","$params",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getParameters",130],"(",["T_VARIABLE","$construction",130],"[",["T_LNUMBER","2",130],"]",")",";",["T_WHITESPACE","\n        ",130],["T_RETURN","return",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","_storeManager",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","getStore",131],"(",")",["T_OBJECT_OPERATOR","->",131],["T_STRING","getBaseUrl",131],"(",["T_NS_SEPARATOR","\\",131],["T_STRING","Magento",131],["T_NS_SEPARATOR","\\",131],["T_STRING","Framework",131],["T_NS_SEPARATOR","\\",131],["T_STRING","UrlInterface",131],["T_DOUBLE_COLON","::",131],["T_STRING","URL_TYPE_MEDIA",131],")",["T_WHITESPACE"," ",131],".",["T_WHITESPACE"," ",131],["T_VARIABLE","$params",131],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",131],"]",";",["T_WHITESPACE","\n    ",131],"}",["T_WHITESPACE","\n\n    ",132],["T_DOC_COMMENT","\/**\n     * Retrieve store URL directive\n     * Support url and direct_url properties\n     *\n     * @param array $construction\n     * @return string\n     * @see \\Magento\\Email\\Model\\Template\\Filter::storeDirective() method has been copypasted\n     *\/",134],["T_WHITESPACE","\n    ",141],["T_PUBLIC","public",142],["T_WHITESPACE"," ",142],["T_FUNCTION","function",142],["T_WHITESPACE"," ",142],["T_STRING","storeDirective",142],"(",["T_VARIABLE","$construction",142],")",["T_WHITESPACE","\n    ",142],"{",["T_WHITESPACE","\n        ",143],["T_VARIABLE","$params",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","getParameters",144],"(",["T_VARIABLE","$construction",144],"[",["T_LNUMBER","2",144],"]",")",";",["T_WHITESPACE","\n        ",144],["T_IF","if",145],["T_WHITESPACE"," ",145],"(","!",["T_ISSET","isset",145],"(",["T_VARIABLE","$params",145],"[",["T_CONSTANT_ENCAPSED_STRING","'_query'",145],"]",")",")",["T_WHITESPACE"," ",145],"{",["T_WHITESPACE","\n            ",145],["T_VARIABLE","$params",146],"[",["T_CONSTANT_ENCAPSED_STRING","'_query'",146],"]",["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],"[","]",";",["T_WHITESPACE","\n        ",146],"}",["T_WHITESPACE","\n        ",147],["T_FOREACH","foreach",148],["T_WHITESPACE"," ",148],"(",["T_VARIABLE","$params",148],["T_WHITESPACE"," ",148],["T_AS","as",148],["T_WHITESPACE"," ",148],["T_VARIABLE","$key",148],["T_WHITESPACE"," ",148],["T_DOUBLE_ARROW","=>",148],["T_WHITESPACE"," ",148],["T_VARIABLE","$value",148],")",["T_WHITESPACE"," ",148],"{",["T_WHITESPACE","\n            ",148],["T_IF","if",149],["T_WHITESPACE"," ",149],"(",["T_STRING","strpos",149],"(",["T_VARIABLE","$key",149],",",["T_WHITESPACE"," ",149],["T_CONSTANT_ENCAPSED_STRING","'_query_'",149],")",["T_WHITESPACE"," ",149],["T_IS_IDENTICAL","===",149],["T_WHITESPACE"," ",149],["T_LNUMBER","0",149],")",["T_WHITESPACE"," ",149],"{",["T_WHITESPACE","\n                ",149],["T_VARIABLE","$params",150],"[",["T_CONSTANT_ENCAPSED_STRING","'_query'",150],"]","[",["T_STRING","substr",150],"(",["T_VARIABLE","$key",150],",",["T_WHITESPACE"," ",150],["T_LNUMBER","7",150],")","]",["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_VARIABLE","$value",150],";",["T_WHITESPACE","\n                ",150],["T_UNSET","unset",151],"(",["T_VARIABLE","$params",151],"[",["T_VARIABLE","$key",151],"]",")",";",["T_WHITESPACE","\n            ",151],"}",["T_WHITESPACE","\n        ",152],"}",["T_WHITESPACE","\n        ",153],["T_VARIABLE","$params",154],"[",["T_CONSTANT_ENCAPSED_STRING","'_absolute'",154],"]",["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","_useAbsoluteLinks",154],";",["T_WHITESPACE","\n\n        ",154],["T_IF","if",156],["T_WHITESPACE"," ",156],"(",["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","_useSessionInUrl",156],["T_WHITESPACE"," ",156],["T_IS_IDENTICAL","===",156],["T_WHITESPACE"," ",156],["T_STRING","false",156],")",["T_WHITESPACE"," ",156],"{",["T_WHITESPACE","\n            ",156],["T_VARIABLE","$params",157],"[",["T_CONSTANT_ENCAPSED_STRING","'_nosid'",157],"]",["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_STRING","true",157],";",["T_WHITESPACE","\n        ",157],"}",["T_WHITESPACE","\n\n        ",158],["T_IF","if",160],["T_WHITESPACE"," ",160],"(",["T_ISSET","isset",160],"(",["T_VARIABLE","$params",160],"[",["T_CONSTANT_ENCAPSED_STRING","'direct_url'",160],"]",")",")",["T_WHITESPACE"," ",160],"{",["T_WHITESPACE","\n            ",160],["T_VARIABLE","$path",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_CONSTANT_ENCAPSED_STRING","''",161],";",["T_WHITESPACE","\n            ",161],["T_VARIABLE","$params",162],"[",["T_CONSTANT_ENCAPSED_STRING","'_direct'",162],"]",["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_VARIABLE","$params",162],"[",["T_CONSTANT_ENCAPSED_STRING","'direct_url'",162],"]",";",["T_WHITESPACE","\n            ",162],["T_UNSET","unset",163],"(",["T_VARIABLE","$params",163],"[",["T_CONSTANT_ENCAPSED_STRING","'direct_url'",163],"]",")",";",["T_WHITESPACE","\n        ",163],"}",["T_WHITESPACE"," ",164],["T_ELSE","else",164],["T_WHITESPACE"," ",164],"{",["T_WHITESPACE","\n            ",164],["T_VARIABLE","$path",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_ISSET","isset",165],"(",["T_VARIABLE","$params",165],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",165],"]",")",["T_WHITESPACE"," ",165],"?",["T_WHITESPACE"," ",165],["T_VARIABLE","$params",165],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",165],"]",["T_WHITESPACE"," ",165],":",["T_WHITESPACE"," ",165],["T_CONSTANT_ENCAPSED_STRING","''",165],";",["T_WHITESPACE","\n            ",165],["T_UNSET","unset",166],"(",["T_VARIABLE","$params",166],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",166],"]",")",";",["T_WHITESPACE","\n        ",166],"}",["T_WHITESPACE","\n\n        ",167],["T_RETURN","return",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","_storeManager",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","getStore",169],"(",")",["T_OBJECT_OPERATOR","->",169],["T_STRING","getUrl",169],"(",["T_VARIABLE","$path",169],",",["T_WHITESPACE"," ",169],["T_VARIABLE","$params",169],")",";",["T_WHITESPACE","\n    ",169],"}",["T_WHITESPACE","\n",170],"}",["T_WHITESPACE","\n",171]]