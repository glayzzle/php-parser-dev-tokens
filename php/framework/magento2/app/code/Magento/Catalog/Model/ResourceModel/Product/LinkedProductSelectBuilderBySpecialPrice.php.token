[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Catalog",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","ResourceModel",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Product",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Catalog",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Api",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Data",8],["T_NS_SEPARATOR","\\",8],["T_STRING","ProductInterface",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Catalog",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Model",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Product",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","App",10],["T_NS_SEPARATOR","\\",10],["T_STRING","ObjectManager",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Framework",11],["T_NS_SEPARATOR","\\",11],["T_STRING","DB",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Select",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Store",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Model",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Store",12],";",["T_WHITESPACE","\n\n",12],["T_DOC_COMMENT","\/**\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",14],["T_WHITESPACE","\n",16],["T_CLASS","class",17],["T_WHITESPACE"," ",17],["T_STRING","LinkedProductSelectBuilderBySpecialPrice",17],["T_WHITESPACE"," ",17],["T_IMPLEMENTS","implements",17],["T_WHITESPACE"," ",17],["T_STRING","LinkedProductSelectBuilderInterface",17],["T_WHITESPACE","\n",17],"{",["T_WHITESPACE","\n    ",18],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Store\\Model\\StoreManagerInterface\n     *\/",19],["T_WHITESPACE","\n    ",21],["T_PRIVATE","private",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$storeManager",22],";",["T_WHITESPACE","\n\n    ",22],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\App\\ResourceConnection\n     *\/",24],["T_WHITESPACE","\n    ",26],["T_PRIVATE","private",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$resource",27],";",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Eav\\Model\\Config\n     *\/",29],["T_WHITESPACE","\n    ",31],["T_PRIVATE","private",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$eavConfig",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Catalog\\Helper\\Data\n     *\/",34],["T_WHITESPACE","\n    ",36],["T_PRIVATE","private",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$catalogHelper",37],";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Stdlib\\DateTime\n     *\/",39],["T_WHITESPACE","\n    ",41],["T_PRIVATE","private",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$dateTime",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Stdlib\\DateTime\\TimezoneInterface\n     *\/",44],["T_WHITESPACE","\n    ",46],["T_PRIVATE","private",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$localeDate",47],";",["T_WHITESPACE","\n\n    ",47],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\EntityManager\\MetadataPool\n     *\/",49],["T_WHITESPACE","\n    ",51],["T_PRIVATE","private",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$metadataPool",52],";",["T_WHITESPACE","\n\n    ",52],["T_DOC_COMMENT","\/**\n     * @var BaseSelectProcessorInterface\n     *\/",54],["T_WHITESPACE","\n    ",56],["T_PRIVATE","private",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$baseSelectProcessor",57],";",["T_WHITESPACE","\n\n    ",57],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Store\\Model\\StoreManagerInterface $storeManager\n     * @param \\Magento\\Framework\\App\\ResourceConnection $resourceConnection\n     * @param \\Magento\\Eav\\Model\\Config $eavConfig\n     * @param \\Magento\\Catalog\\Helper\\Data $catalogHelper\n     * @param \\Magento\\Framework\\Stdlib\\DateTime $dateTime\n     * @param \\Magento\\Framework\\Stdlib\\DateTime\\TimezoneInterface $localeDate\n     * @param \\Magento\\Framework\\EntityManager\\MetadataPool $metadataPool\n     * @param BaseSelectProcessorInterface $baseSelectProcessor\n     *\/",59],["T_WHITESPACE","\n    ",68],["T_PUBLIC","public",69],["T_WHITESPACE"," ",69],["T_FUNCTION","function",69],["T_WHITESPACE"," ",69],["T_STRING","__construct",69],"(",["T_WHITESPACE","\n        ",69],["T_NS_SEPARATOR","\\",70],["T_STRING","Magento",70],["T_NS_SEPARATOR","\\",70],["T_STRING","Store",70],["T_NS_SEPARATOR","\\",70],["T_STRING","Model",70],["T_NS_SEPARATOR","\\",70],["T_STRING","StoreManagerInterface",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$storeManager",70],",",["T_WHITESPACE","\n        ",70],["T_NS_SEPARATOR","\\",71],["T_STRING","Magento",71],["T_NS_SEPARATOR","\\",71],["T_STRING","Framework",71],["T_NS_SEPARATOR","\\",71],["T_STRING","App",71],["T_NS_SEPARATOR","\\",71],["T_STRING","ResourceConnection",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$resourceConnection",71],",",["T_WHITESPACE","\n        ",71],["T_NS_SEPARATOR","\\",72],["T_STRING","Magento",72],["T_NS_SEPARATOR","\\",72],["T_STRING","Eav",72],["T_NS_SEPARATOR","\\",72],["T_STRING","Model",72],["T_NS_SEPARATOR","\\",72],["T_STRING","Config",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$eavConfig",72],",",["T_WHITESPACE","\n        ",72],["T_NS_SEPARATOR","\\",73],["T_STRING","Magento",73],["T_NS_SEPARATOR","\\",73],["T_STRING","Catalog",73],["T_NS_SEPARATOR","\\",73],["T_STRING","Helper",73],["T_NS_SEPARATOR","\\",73],["T_STRING","Data",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$catalogHelper",73],",",["T_WHITESPACE","\n        ",73],["T_NS_SEPARATOR","\\",74],["T_STRING","Magento",74],["T_NS_SEPARATOR","\\",74],["T_STRING","Framework",74],["T_NS_SEPARATOR","\\",74],["T_STRING","Stdlib",74],["T_NS_SEPARATOR","\\",74],["T_STRING","DateTime",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$dateTime",74],",",["T_WHITESPACE","\n        ",74],["T_NS_SEPARATOR","\\",75],["T_STRING","Magento",75],["T_NS_SEPARATOR","\\",75],["T_STRING","Framework",75],["T_NS_SEPARATOR","\\",75],["T_STRING","Stdlib",75],["T_NS_SEPARATOR","\\",75],["T_STRING","DateTime",75],["T_NS_SEPARATOR","\\",75],["T_STRING","TimezoneInterface",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$localeDate",75],",",["T_WHITESPACE","\n        ",75],["T_NS_SEPARATOR","\\",76],["T_STRING","Magento",76],["T_NS_SEPARATOR","\\",76],["T_STRING","Framework",76],["T_NS_SEPARATOR","\\",76],["T_STRING","EntityManager",76],["T_NS_SEPARATOR","\\",76],["T_STRING","MetadataPool",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$metadataPool",76],",",["T_WHITESPACE","\n        ",76],["T_STRING","BaseSelectProcessorInterface",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$baseSelectProcessor",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_STRING","null",77],["T_WHITESPACE","\n    ",77],")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","storeManager",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$storeManager",79],";",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","resource",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$resourceConnection",80],";",["T_WHITESPACE","\n        ",80],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","eavConfig",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$eavConfig",81],";",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","catalogHelper",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$catalogHelper",82],";",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","dateTime",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$dateTime",83],";",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","localeDate",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$localeDate",84],";",["T_WHITESPACE","\n        ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","metadataPool",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_VARIABLE","$metadataPool",85],";",["T_WHITESPACE","\n        ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","baseSelectProcessor",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],"(",["T_STRING","null",86],["T_WHITESPACE"," ",86],["T_IS_NOT_IDENTICAL","!==",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$baseSelectProcessor",86],")",["T_WHITESPACE","\n            ",86],"?",["T_WHITESPACE"," ",87],["T_VARIABLE","$baseSelectProcessor",87],["T_WHITESPACE"," ",87],":",["T_WHITESPACE"," ",87],["T_STRING","ObjectManager",87],["T_DOUBLE_COLON","::",87],["T_STRING","getInstance",87],"(",")",["T_OBJECT_OPERATOR","->",87],["T_STRING","get",87],"(",["T_STRING","BaseSelectProcessorInterface",87],["T_DOUBLE_COLON","::",87],["T_CLASS","class",87],")",";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n\n    ",88],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",90],["T_WHITESPACE","\n    ",92],["T_PUBLIC","public",93],["T_WHITESPACE"," ",93],["T_FUNCTION","function",93],["T_WHITESPACE"," ",93],["T_STRING","build",93],"(",["T_VARIABLE","$productId",93],")",["T_WHITESPACE","\n    ",93],"{",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$linkField",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","metadataPool",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getMetadata",95],"(",["T_STRING","ProductInterface",95],["T_DOUBLE_COLON","::",95],["T_CLASS","class",95],")",["T_OBJECT_OPERATOR","->",95],["T_STRING","getLinkField",95],"(",")",";",["T_WHITESPACE","\n        ",95],["T_VARIABLE","$connection",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","resource",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getConnection",96],"(",")",";",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$specialPriceAttribute",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","eavConfig",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","getAttribute",97],"(",["T_STRING","Product",97],["T_DOUBLE_COLON","::",97],["T_STRING","ENTITY",97],",",["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","'special_price'",97],")",";",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$specialPriceFromDate",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","eavConfig",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getAttribute",98],"(",["T_STRING","Product",98],["T_DOUBLE_COLON","::",98],["T_STRING","ENTITY",98],",",["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'special_from_date'",98],")",";",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$specialPriceToDate",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","eavConfig",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","getAttribute",99],"(",["T_STRING","Product",99],["T_DOUBLE_COLON","::",99],["T_STRING","ENTITY",99],",",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","'special_to_date'",99],")",";",["T_WHITESPACE","\n        ",99],["T_VARIABLE","$timestamp",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","localeDate",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","scopeTimeStamp",100],"(",["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","storeManager",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getStore",100],"(",")",")",";",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$currentDate",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","dateTime",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","formatDate",101],"(",["T_VARIABLE","$timestamp",101],",",["T_WHITESPACE"," ",101],["T_STRING","false",101],")",";",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$productTable",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","resource",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getTableName",102],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity'",102],")",";",["T_WHITESPACE","\n\n        ",102],["T_VARIABLE","$specialPrice",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","resource",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getConnection",104],"(",")",["T_OBJECT_OPERATOR","->",104],["T_STRING","select",104],"(",")",["T_WHITESPACE","\n            ",104],["T_OBJECT_OPERATOR","->",105],["T_STRING","from",105],"(","[",["T_CONSTANT_ENCAPSED_STRING","'parent'",105],["T_WHITESPACE"," ",105],["T_DOUBLE_ARROW","=>",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$productTable",105],"]",",",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","''",105],")",["T_WHITESPACE","\n            ",105],["T_OBJECT_OPERATOR","->",106],["T_STRING","joinInner",106],"(",["T_WHITESPACE","\n                ",106],"[",["T_CONSTANT_ENCAPSED_STRING","'link'",107],["T_WHITESPACE"," ",107],["T_DOUBLE_ARROW","=>",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","resource",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","getTableName",107],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_relation'",107],")","]",",",["T_WHITESPACE","\n                ",107],"\"",["T_ENCAPSED_AND_WHITESPACE","link.parent_id = parent.",108],["T_VARIABLE","$linkField",108],"\"",",",["T_WHITESPACE","\n                ",108],"[","]",["T_WHITESPACE","\n            ",109],")",["T_OBJECT_OPERATOR","->",110],["T_STRING","joinInner",110],"(",["T_WHITESPACE","\n                ",110],"[",["T_STRING","BaseSelectProcessorInterface",111],["T_DOUBLE_COLON","::",111],["T_STRING","PRODUCT_TABLE_ALIAS",111],["T_WHITESPACE"," ",111],["T_DOUBLE_ARROW","=>",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$productTable",111],"]",",",["T_WHITESPACE","\n                ",111],["T_STRING","sprintf",112],"(",["T_CONSTANT_ENCAPSED_STRING","'%s.entity_id = link.child_id'",112],",",["T_WHITESPACE"," ",112],["T_STRING","BaseSelectProcessorInterface",112],["T_DOUBLE_COLON","::",112],["T_STRING","PRODUCT_TABLE_ALIAS",112],")",",",["T_WHITESPACE","\n                ",112],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",113],"]",["T_WHITESPACE","\n            ",113],")",["T_OBJECT_OPERATOR","->",114],["T_STRING","joinInner",114],"(",["T_WHITESPACE","\n                ",114],"[",["T_CONSTANT_ENCAPSED_STRING","'t'",115],["T_WHITESPACE"," ",115],["T_DOUBLE_ARROW","=>",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$specialPriceAttribute",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","getBackendTable",115],"(",")","]",",",["T_WHITESPACE","\n                ",115],["T_STRING","sprintf",116],"(",["T_CONSTANT_ENCAPSED_STRING","'t.%s = %s.%1$s'",116],",",["T_WHITESPACE"," ",116],["T_VARIABLE","$linkField",116],",",["T_WHITESPACE"," ",116],["T_STRING","BaseSelectProcessorInterface",116],["T_DOUBLE_COLON","::",116],["T_STRING","PRODUCT_TABLE_ALIAS",116],")",",",["T_WHITESPACE","\n                ",116],"[","]",["T_WHITESPACE","\n            ",117],")",["T_OBJECT_OPERATOR","->",118],["T_STRING","joinLeft",118],"(",["T_WHITESPACE","\n                ",118],"[",["T_CONSTANT_ENCAPSED_STRING","'special_from'",119],["T_WHITESPACE"," ",119],["T_DOUBLE_ARROW","=>",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$specialPriceFromDate",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getBackendTable",119],"(",")","]",",",["T_WHITESPACE","\n                ",119],["T_VARIABLE","$connection",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","quoteInto",120],"(",["T_WHITESPACE","\n                    ",120],"\"",["T_ENCAPSED_AND_WHITESPACE","t.",121],["T_CURLY_OPEN","{",121],["T_VARIABLE","$linkField",121],"}",["T_ENCAPSED_AND_WHITESPACE"," = special_from.",121],["T_CURLY_OPEN","{",121],["T_VARIABLE","$linkField",121],"}",["T_ENCAPSED_AND_WHITESPACE"," AND special_from.attribute_id = ?",121],"\"",",",["T_WHITESPACE","\n                    ",121],["T_VARIABLE","$specialPriceFromDate",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","getAttributeId",122],"(",")",["T_WHITESPACE","\n                ",122],")",",",["T_WHITESPACE","\n                ",123],["T_CONSTANT_ENCAPSED_STRING","''",124],["T_WHITESPACE","\n            ",124],")",["T_OBJECT_OPERATOR","->",125],["T_STRING","joinLeft",125],"(",["T_WHITESPACE","\n                ",125],"[",["T_CONSTANT_ENCAPSED_STRING","'special_to'",126],["T_WHITESPACE"," ",126],["T_DOUBLE_ARROW","=>",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$specialPriceToDate",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getBackendTable",126],"(",")","]",",",["T_WHITESPACE","\n                ",126],["T_VARIABLE","$connection",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","quoteInto",127],"(",["T_WHITESPACE","\n                    ",127],"\"",["T_ENCAPSED_AND_WHITESPACE","t.",128],["T_CURLY_OPEN","{",128],["T_VARIABLE","$linkField",128],"}",["T_ENCAPSED_AND_WHITESPACE"," = special_to.",128],["T_CURLY_OPEN","{",128],["T_VARIABLE","$linkField",128],"}",["T_ENCAPSED_AND_WHITESPACE"," AND special_to.attribute_id = ?",128],"\"",",",["T_WHITESPACE","\n                    ",128],["T_VARIABLE","$specialPriceToDate",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getAttributeId",129],"(",")",["T_WHITESPACE","\n                ",129],")",",",["T_WHITESPACE","\n                ",130],["T_CONSTANT_ENCAPSED_STRING","''",131],["T_WHITESPACE","\n            ",131],")",["T_OBJECT_OPERATOR","->",132],["T_STRING","where",132],"(",["T_CONSTANT_ENCAPSED_STRING","'parent.entity_id = ?'",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$productId",132],")",["T_WHITESPACE","\n            ",132],["T_OBJECT_OPERATOR","->",133],["T_STRING","where",133],"(",["T_CONSTANT_ENCAPSED_STRING","'t.attribute_id = ?'",133],",",["T_WHITESPACE"," ",133],["T_VARIABLE","$specialPriceAttribute",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getAttributeId",133],"(",")",")",["T_WHITESPACE","\n            ",133],["T_OBJECT_OPERATOR","->",134],["T_STRING","where",134],"(",["T_CONSTANT_ENCAPSED_STRING","'t.value IS NOT NULL'",134],")",["T_WHITESPACE","\n            ",134],["T_OBJECT_OPERATOR","->",135],["T_STRING","where",135],"(",["T_WHITESPACE","\n                ",135],["T_CONSTANT_ENCAPSED_STRING","'special_from.value IS NULL OR '",136],["T_WHITESPACE"," ",136],".",["T_WHITESPACE"," ",136],["T_VARIABLE","$connection",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getDatePartSql",136],"(",["T_CONSTANT_ENCAPSED_STRING","'special_from.value'",136],")",["T_WHITESPACE"," ",136],".",["T_CONSTANT_ENCAPSED_STRING","' <= ?'",136],",",["T_WHITESPACE","\n                ",136],["T_VARIABLE","$currentDate",137],["T_WHITESPACE","\n            ",137],")",["T_OBJECT_OPERATOR","->",138],["T_STRING","where",138],"(",["T_WHITESPACE","\n                ",138],["T_CONSTANT_ENCAPSED_STRING","'special_to.value IS NULL OR '",139],["T_WHITESPACE"," ",139],".",["T_WHITESPACE"," ",139],["T_VARIABLE","$connection",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getDatePartSql",139],"(",["T_CONSTANT_ENCAPSED_STRING","'special_to.value'",139],")",["T_WHITESPACE"," ",139],".",["T_CONSTANT_ENCAPSED_STRING","' >= ?'",139],",",["T_WHITESPACE","\n                ",139],["T_VARIABLE","$currentDate",140],["T_WHITESPACE","\n            ",140],")",["T_OBJECT_OPERATOR","->",141],["T_STRING","order",141],"(",["T_CONSTANT_ENCAPSED_STRING","'t.value '",141],["T_WHITESPACE"," ",141],".",["T_WHITESPACE"," ",141],["T_STRING","Select",141],["T_DOUBLE_COLON","::",141],["T_STRING","SQL_ASC",141],")",["T_WHITESPACE","\n            ",141],["T_OBJECT_OPERATOR","->",142],["T_STRING","limit",142],"(",["T_LNUMBER","1",142],")",";",["T_WHITESPACE","\n        ",142],["T_VARIABLE","$specialPrice",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","baseSelectProcessor",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","process",143],"(",["T_VARIABLE","$specialPrice",143],")",";",["T_WHITESPACE","\n\n        ",143],["T_VARIABLE","$specialPriceDefault",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_CLONE","clone",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$specialPrice",145],";",["T_WHITESPACE","\n        ",145],["T_VARIABLE","$specialPriceDefault",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","where",146],"(",["T_CONSTANT_ENCAPSED_STRING","'t.store_id = ?'",146],",",["T_WHITESPACE"," ",146],["T_STRING","Store",146],["T_DOUBLE_COLON","::",146],["T_STRING","DEFAULT_STORE_ID",146],")",";",["T_WHITESPACE","\n        ",146],["T_VARIABLE","$select",147],"[","]",["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_VARIABLE","$specialPriceDefault",147],";",["T_WHITESPACE","\n\n        ",147],["T_IF","if",149],["T_WHITESPACE"," ",149],"(","!",["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","catalogHelper",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","isPriceGlobal",149],"(",")",")",["T_WHITESPACE"," ",149],"{",["T_WHITESPACE","\n            ",149],["T_VARIABLE","$specialPrice",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","where",150],"(",["T_CONSTANT_ENCAPSED_STRING","'t.store_id = ?'",150],",",["T_WHITESPACE"," ",150],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","storeManager",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","getStore",150],"(",")",["T_OBJECT_OPERATOR","->",150],["T_STRING","getId",150],"(",")",")",";",["T_WHITESPACE","\n            ",150],["T_VARIABLE","$select",151],"[","]",["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_VARIABLE","$specialPrice",151],";",["T_WHITESPACE","\n        ",151],"}",["T_WHITESPACE","\n\n        ",152],["T_RETURN","return",154],["T_WHITESPACE"," ",154],["T_VARIABLE","$select",154],";",["T_WHITESPACE","\n    ",154],"}",["T_WHITESPACE","\n",155],"}",["T_WHITESPACE","\n",156]]