[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n *\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",6],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Catalog",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Model",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Indexer",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Product",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Flat",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Action",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Catalog",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Api",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Data",9],["T_NS_SEPARATOR","\\",9],["T_STRING","ProductInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","App",10],["T_NS_SEPARATOR","\\",10],["T_STRING","ResourceConnection",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Framework",11],["T_NS_SEPARATOR","\\",11],["T_STRING","EntityManager",11],["T_NS_SEPARATOR","\\",11],["T_STRING","MetadataPool",11],";",["T_WHITESPACE","\n\n",11],["T_DOC_COMMENT","\/**\n * Class Indexer\n *\/",13],["T_WHITESPACE","\n",15],["T_CLASS","class",16],["T_WHITESPACE"," ",16],["T_STRING","Indexer",16],["T_WHITESPACE","\n",16],"{",["T_WHITESPACE","\n    ",17],["T_DOC_COMMENT","\/**\n     * @var MetadataPool\n     *\/",18],["T_WHITESPACE","\n    ",20],["T_PROTECTED","protected",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$metadataPool",21],";",["T_WHITESPACE","\n\n    ",21],["T_DOC_COMMENT","\/**\n     * Maximum size of attributes chunk\n     *\/",23],["T_WHITESPACE","\n    ",25],["T_CONST","const",26],["T_WHITESPACE"," ",26],["T_STRING","ATTRIBUTES_CHUNK_SIZE",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_LNUMBER","59",26],";",["T_WHITESPACE","\n\n    ",26],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Catalog\\Helper\\Product\\Flat\\Indexer\n     *\/",28],["T_WHITESPACE","\n    ",30],["T_PROTECTED","protected",31],["T_WHITESPACE"," ",31],["T_VARIABLE","$_productIndexerHelper",31],";",["T_WHITESPACE","\n\n    ",31],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\DB\\Adapter\\AdapterInterface\n     *\/",33],["T_WHITESPACE","\n    ",35],["T_PROTECTED","protected",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$_connection",36],";",["T_WHITESPACE","\n\n    ",36],["T_DOC_COMMENT","\/**\n     * @param ResourceConnection $resource\n     * @param \\Magento\\Catalog\\Helper\\Product\\Flat\\Indexer $productHelper\n     *\/",38],["T_WHITESPACE","\n    ",41],["T_PUBLIC","public",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","__construct",42],"(",["T_WHITESPACE","\n        ",42],["T_NS_SEPARATOR","\\",43],["T_STRING","Magento",43],["T_NS_SEPARATOR","\\",43],["T_STRING","Framework",43],["T_NS_SEPARATOR","\\",43],["T_STRING","App",43],["T_NS_SEPARATOR","\\",43],["T_STRING","ResourceConnection",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$resource",43],",",["T_WHITESPACE","\n        ",43],["T_NS_SEPARATOR","\\",44],["T_STRING","Magento",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Catalog",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Helper",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Product",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Flat",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Indexer",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$productHelper",44],["T_WHITESPACE","\n    ",44],")",["T_WHITESPACE"," ",45],"{",["T_WHITESPACE","\n        ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","_productIndexerHelper",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$productHelper",46],";",["T_WHITESPACE","\n        ",46],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","_connection",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$resource",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","getConnection",47],"(",")",";",["T_WHITESPACE","\n    ",47],"}",["T_WHITESPACE","\n\n    ",48],["T_DOC_COMMENT","\/**\n     * Write single product into flat product table\n     *\n     * @param int $storeId\n     * @param int $productId\n     * @param string $valueFieldSuffix\n     * @return \\Magento\\Catalog\\Model\\Indexer\\Product\\Flat\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     * @SuppressWarnings(PHPMD.ExcessiveMethodLength)\n     *\/",50],["T_WHITESPACE","\n    ",59],["T_PUBLIC","public",60],["T_WHITESPACE"," ",60],["T_FUNCTION","function",60],["T_WHITESPACE"," ",60],["T_STRING","write",60],"(",["T_VARIABLE","$storeId",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$productId",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$valueFieldSuffix",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","''",60],")",["T_WHITESPACE","\n    ",60],"{",["T_WHITESPACE","\n        ",61],["T_VARIABLE","$flatTable",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","_productIndexerHelper",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","getFlatTableName",62],"(",["T_VARIABLE","$storeId",62],")",";",["T_WHITESPACE","\n\n        ",62],["T_VARIABLE","$attributes",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","_productIndexerHelper",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","getAttributes",64],"(",")",";",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$eavAttributes",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","_productIndexerHelper",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getTablesStructure",65],"(",["T_VARIABLE","$attributes",65],")",";",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$updateData",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],"[","]",";",["T_WHITESPACE","\n        ",66],["T_VARIABLE","$describe",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","_connection",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","describeTable",67],"(",["T_VARIABLE","$flatTable",67],")",";",["T_WHITESPACE","\n\n        ",67],["T_FOREACH","foreach",69],["T_WHITESPACE"," ",69],"(",["T_VARIABLE","$eavAttributes",69],["T_WHITESPACE"," ",69],["T_AS","as",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$tableName",69],["T_WHITESPACE"," ",69],["T_DOUBLE_ARROW","=>",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$tableColumns",69],")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n            ",69],["T_VARIABLE","$columnsChunks",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_STRING","array_chunk",70],"(",["T_VARIABLE","$tableColumns",70],",",["T_WHITESPACE"," ",70],["T_STRING","self",70],["T_DOUBLE_COLON","::",70],["T_STRING","ATTRIBUTES_CHUNK_SIZE",70],",",["T_WHITESPACE"," ",70],["T_STRING","true",70],")",";",["T_WHITESPACE","\n\n            ",70],["T_FOREACH","foreach",72],["T_WHITESPACE"," ",72],"(",["T_VARIABLE","$columnsChunks",72],["T_WHITESPACE"," ",72],["T_AS","as",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$columns",72],")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n                ",72],["T_VARIABLE","$select",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","_connection",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","select",73],"(",")",";",["T_WHITESPACE","\n                ",73],["T_VARIABLE","$selectValue",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","_connection",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","select",74],"(",")",";",["T_WHITESPACE","\n                ",74],["T_VARIABLE","$keyColumns",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],"[",["T_WHITESPACE","\n                    ",75],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'e.entity_id'",76],",",["T_WHITESPACE","\n                    ",76],["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",77],["T_WHITESPACE"," ",77],["T_DOUBLE_ARROW","=>",77],["T_WHITESPACE"," ",77],["T_CONSTANT_ENCAPSED_STRING","'t.attribute_id'",77],",",["T_WHITESPACE","\n                    ",77],["T_CONSTANT_ENCAPSED_STRING","'value'",78],["T_WHITESPACE"," ",78],["T_DOUBLE_ARROW","=>",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","_connection",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getIfNullSql",78],"(",["T_CONSTANT_ENCAPSED_STRING","'`t2`.`value`'",78],",",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'`t`.`value`'",78],")",",",["T_WHITESPACE","\n                ",78],"]",";",["T_WHITESPACE","\n\n                ",79],["T_IF","if",81],["T_WHITESPACE"," ",81],"(",["T_VARIABLE","$tableName",81],["T_WHITESPACE"," ",81],["T_IS_NOT_EQUAL","!=",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","_productIndexerHelper",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getTable",81],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity'",81],")",")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n                    ",81],["T_VARIABLE","$valueColumns",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],"[","]",";",["T_WHITESPACE","\n                    ",82],["T_VARIABLE","$ids",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],"[","]",";",["T_WHITESPACE","\n                    ",83],["T_VARIABLE","$select",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","from",84],"(",["T_WHITESPACE","\n                        ",84],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",85],["T_WHITESPACE"," ",85],["T_DOUBLE_ARROW","=>",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","_productIndexerHelper",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","getTable",85],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity'",85],")","]",",",["T_WHITESPACE","\n                        ",85],["T_VARIABLE","$keyColumns",86],["T_WHITESPACE","\n                    ",86],")",";",["T_WHITESPACE","\n\n                    ",87],["T_VARIABLE","$selectValue",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","from",89],"(",["T_WHITESPACE","\n                        ",89],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",90],["T_WHITESPACE"," ",90],["T_DOUBLE_ARROW","=>",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","_productIndexerHelper",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","getTable",90],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity'",90],")","]",",",["T_WHITESPACE","\n                        ",90],["T_VARIABLE","$keyColumns",91],["T_WHITESPACE","\n                    ",91],")",";",["T_WHITESPACE","\n\n                    ",92],["T_DOC_COMMENT","\/** @var $attribute \\Magento\\Catalog\\Model\\ResourceModel\\Eav\\Attribute *\/",94],["T_WHITESPACE","\n                    ",94],["T_FOREACH","foreach",95],["T_WHITESPACE"," ",95],"(",["T_VARIABLE","$columns",95],["T_WHITESPACE"," ",95],["T_AS","as",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$columnName",95],["T_WHITESPACE"," ",95],["T_DOUBLE_ARROW","=>",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$attribute",95],")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n                        ",95],["T_IF","if",96],["T_WHITESPACE"," ",96],"(",["T_ISSET","isset",96],"(",["T_VARIABLE","$describe",96],"[",["T_VARIABLE","$columnName",96],"]",")",")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n                            ",96],["T_VARIABLE","$ids",97],"[",["T_VARIABLE","$attribute",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","getId",97],"(",")","]",["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$columnName",97],";",["T_WHITESPACE","\n                        ",97],"}",["T_WHITESPACE","\n                    ",98],"}",["T_WHITESPACE","\n                    ",99],["T_VARIABLE","$linkField",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getMetadataPool",100],"(",")",["T_OBJECT_OPERATOR","->",100],["T_STRING","getMetadata",100],"(",["T_STRING","ProductInterface",100],["T_DOUBLE_COLON","::",100],["T_CLASS","class",100],")",["T_OBJECT_OPERATOR","->",100],["T_STRING","getLinkField",100],"(",")",";",["T_WHITESPACE","\n                    ",100],["T_VARIABLE","$select",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","joinLeft",101],"(",["T_WHITESPACE","\n                        ",101],"[",["T_CONSTANT_ENCAPSED_STRING","'t'",102],["T_WHITESPACE"," ",102],["T_DOUBLE_ARROW","=>",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$tableName",102],"]",",",["T_WHITESPACE","\n                        ",102],["T_STRING","sprintf",103],"(",["T_CONSTANT_ENCAPSED_STRING","'e.%s = t.%s '",103],",",["T_WHITESPACE"," ",103],["T_VARIABLE","$linkField",103],",",["T_WHITESPACE"," ",103],["T_VARIABLE","$linkField",103],")",["T_WHITESPACE"," ",103],".",["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","_connection",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","quoteInto",103],"(",["T_WHITESPACE","\n                            ",103],["T_CONSTANT_ENCAPSED_STRING","' AND t.attribute_id IN (?)'",104],",",["T_WHITESPACE","\n                            ",104],["T_STRING","array_keys",105],"(",["T_VARIABLE","$ids",105],")",["T_WHITESPACE","\n                        ",105],")",["T_WHITESPACE"," ",106],".",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","' AND t.store_id = 0'",106],",",["T_WHITESPACE","\n                        ",106],"[","]",["T_WHITESPACE","\n                    ",107],")",["T_OBJECT_OPERATOR","->",108],["T_STRING","joinLeft",108],"(",["T_WHITESPACE","\n                        ",108],"[",["T_CONSTANT_ENCAPSED_STRING","'t2'",109],["T_WHITESPACE"," ",109],["T_DOUBLE_ARROW","=>",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$tableName",109],"]",",",["T_WHITESPACE","\n                        ",109],["T_STRING","sprintf",110],"(",["T_CONSTANT_ENCAPSED_STRING","'t.%s = t2.%s '",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$linkField",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$linkField",110],")",["T_WHITESPACE"," ",110],".",["T_WHITESPACE","\n                        ",110],["T_CONSTANT_ENCAPSED_STRING","' AND t.attribute_id = t2.attribute_id  '",111],["T_WHITESPACE"," ",111],".",["T_WHITESPACE","\n                        ",111],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","_connection",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","quoteInto",112],"(",["T_WHITESPACE","\n                            ",112],["T_CONSTANT_ENCAPSED_STRING","' AND t2.store_id = ?'",113],",",["T_WHITESPACE","\n                            ",113],["T_VARIABLE","$storeId",114],["T_WHITESPACE","\n                        ",114],")",",",["T_WHITESPACE","\n                        ",115],"[","]",["T_WHITESPACE","\n                    ",116],")",["T_OBJECT_OPERATOR","->",117],["T_STRING","where",117],"(",["T_WHITESPACE","\n                        ",117],["T_CONSTANT_ENCAPSED_STRING","'e.entity_id = '",118],["T_WHITESPACE"," ",118],".",["T_WHITESPACE"," ",118],["T_VARIABLE","$productId",118],["T_WHITESPACE","\n                    ",118],")",["T_OBJECT_OPERATOR","->",119],["T_STRING","where",119],"(",["T_WHITESPACE","\n                        ",119],["T_CONSTANT_ENCAPSED_STRING","'t.attribute_id IS NOT NULL'",120],["T_WHITESPACE","\n                    ",120],")",";",["T_WHITESPACE","\n                    ",121],["T_VARIABLE","$cursor",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","_connection",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","query",122],"(",["T_VARIABLE","$select",122],")",";",["T_WHITESPACE","\n                    ",122],["T_WHILE","while",123],["T_WHITESPACE"," ",123],"(",["T_VARIABLE","$row",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$cursor",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","fetch",123],"(",["T_NS_SEPARATOR","\\",123],["T_STRING","Zend_Db",123],["T_DOUBLE_COLON","::",123],["T_STRING","FETCH_ASSOC",123],")",")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n                        ",123],["T_VARIABLE","$updateData",124],"[",["T_VARIABLE","$ids",124],"[",["T_VARIABLE","$row",124],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",124],"]","]","]",["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$row",124],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",124],"]",";",["T_WHITESPACE","\n                        ",124],["T_VARIABLE","$valueColumnName",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_VARIABLE","$ids",125],"[",["T_VARIABLE","$row",125],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",125],"]","]",["T_WHITESPACE"," ",125],".",["T_WHITESPACE"," ",125],["T_VARIABLE","$valueFieldSuffix",125],";",["T_WHITESPACE","\n                        ",125],["T_IF","if",126],["T_WHITESPACE"," ",126],"(",["T_ISSET","isset",126],"(",["T_VARIABLE","$describe",126],"[",["T_VARIABLE","$valueColumnName",126],"]",")",")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n                            ",126],["T_VARIABLE","$valueColumns",127],"[",["T_VARIABLE","$row",127],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",127],"]","]",["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_VARIABLE","$valueColumnName",127],";",["T_WHITESPACE","\n                        ",127],"}",["T_WHITESPACE","\n                    ",128],"}",["T_WHITESPACE","\n\n                    ",129],["T_COMMENT","\/\/Update not simple attributes (eg. dropdown)\n",131],["T_WHITESPACE","                    ",132],["T_IF","if",132],["T_WHITESPACE"," ",132],"(","!",["T_EMPTY","empty",132],"(",["T_VARIABLE","$valueColumns",132],")",")",["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n                        ",132],["T_VARIABLE","$valueIds",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_STRING","array_keys",133],"(",["T_VARIABLE","$valueColumns",133],")",";",["T_WHITESPACE","\n\n                        ",133],["T_VARIABLE","$select",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","_connection",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","select",135],"(",")",["T_OBJECT_OPERATOR","->",135],["T_STRING","from",135],"(",["T_WHITESPACE","\n                            ",135],"[",["T_CONSTANT_ENCAPSED_STRING","'t'",136],["T_WHITESPACE"," ",136],["T_DOUBLE_ARROW","=>",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","_productIndexerHelper",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getTable",136],"(",["T_CONSTANT_ENCAPSED_STRING","'eav_attribute_option_value'",136],")","]",",",["T_WHITESPACE","\n                            ",136],"[",["T_CONSTANT_ENCAPSED_STRING","'t.option_id'",137],",",["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'t.value'",137],"]",["T_WHITESPACE","\n                        ",137],")",["T_OBJECT_OPERATOR","->",138],["T_STRING","where",138],"(",["T_WHITESPACE","\n                            ",138],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","_connection",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","quoteInto",139],"(",["T_CONSTANT_ENCAPSED_STRING","'t.option_id IN (?)'",139],",",["T_WHITESPACE"," ",139],["T_VARIABLE","$valueIds",139],")",["T_WHITESPACE","\n                        ",139],")",";",["T_WHITESPACE","\n                        ",140],["T_VARIABLE","$cursor",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","_connection",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","query",141],"(",["T_VARIABLE","$select",141],")",";",["T_WHITESPACE","\n                        ",141],["T_WHILE","while",142],["T_WHITESPACE"," ",142],"(",["T_VARIABLE","$row",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_VARIABLE","$cursor",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","fetch",142],"(",["T_NS_SEPARATOR","\\",142],["T_STRING","Zend_Db",142],["T_DOUBLE_COLON","::",142],["T_STRING","FETCH_ASSOC",142],")",")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n                            ",142],["T_VARIABLE","$valueColumnName",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_VARIABLE","$valueColumns",143],"[",["T_VARIABLE","$row",143],"[",["T_CONSTANT_ENCAPSED_STRING","'option_id'",143],"]","]",";",["T_WHITESPACE","\n                            ",143],["T_IF","if",144],["T_WHITESPACE"," ",144],"(",["T_ISSET","isset",144],"(",["T_VARIABLE","$describe",144],"[",["T_VARIABLE","$valueColumnName",144],"]",")",")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n                                ",144],["T_VARIABLE","$updateData",145],"[",["T_VARIABLE","$valueColumnName",145],"]",["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_VARIABLE","$row",145],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",145],"]",";",["T_WHITESPACE","\n                            ",145],"}",["T_WHITESPACE","\n                        ",146],"}",["T_WHITESPACE","\n                    ",147],"}",["T_WHITESPACE","\n                ",148],"}",["T_WHITESPACE"," ",149],["T_ELSE","else",149],["T_WHITESPACE"," ",149],"{",["T_WHITESPACE","\n                    ",149],["T_VARIABLE","$columnNames",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_STRING","array_keys",150],"(",["T_VARIABLE","$columns",150],")",";",["T_WHITESPACE","\n                    ",150],["T_VARIABLE","$columnNames",151],"[","]",["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_CONSTANT_ENCAPSED_STRING","'attribute_set_id'",151],";",["T_WHITESPACE","\n                    ",151],["T_VARIABLE","$columnNames",152],"[","]",["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","'type_id'",152],";",["T_WHITESPACE","\n                    ",152],["T_VARIABLE","$select",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","from",153],"(",["T_WHITESPACE","\n                        ",153],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",154],["T_WHITESPACE"," ",154],["T_DOUBLE_ARROW","=>",154],["T_WHITESPACE"," ",154],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","_productIndexerHelper",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","getTable",154],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity'",154],")","]",",",["T_WHITESPACE","\n                        ",154],["T_VARIABLE","$columnNames",155],["T_WHITESPACE","\n                    ",155],")",["T_OBJECT_OPERATOR","->",156],["T_STRING","where",156],"(",["T_WHITESPACE","\n                        ",156],["T_CONSTANT_ENCAPSED_STRING","'e.entity_id = '",157],["T_WHITESPACE"," ",157],".",["T_WHITESPACE"," ",157],["T_VARIABLE","$productId",157],["T_WHITESPACE","\n                    ",157],")",";",["T_WHITESPACE","\n                    ",158],["T_VARIABLE","$cursor",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","_connection",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","query",159],"(",["T_VARIABLE","$select",159],")",";",["T_WHITESPACE","\n                    ",159],["T_VARIABLE","$row",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_VARIABLE","$cursor",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","fetch",160],"(",["T_NS_SEPARATOR","\\",160],["T_STRING","Zend_Db",160],["T_DOUBLE_COLON","::",160],["T_STRING","FETCH_ASSOC",160],")",";",["T_WHITESPACE","\n                    ",160],["T_IF","if",161],["T_WHITESPACE"," ",161],"(","!",["T_EMPTY","empty",161],"(",["T_VARIABLE","$row",161],")",")",["T_WHITESPACE"," ",161],"{",["T_WHITESPACE","\n                        ",161],["T_FOREACH","foreach",162],["T_WHITESPACE"," ",162],"(",["T_VARIABLE","$row",162],["T_WHITESPACE"," ",162],["T_AS","as",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$columnName",162],["T_WHITESPACE"," ",162],["T_DOUBLE_ARROW","=>",162],["T_WHITESPACE"," ",162],["T_VARIABLE","$value",162],")",["T_WHITESPACE"," ",162],"{",["T_WHITESPACE","\n                            ",162],["T_VARIABLE","$updateData",163],"[",["T_VARIABLE","$columnName",163],"]",["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_VARIABLE","$value",163],";",["T_WHITESPACE","\n                        ",163],"}",["T_WHITESPACE","\n                    ",164],"}",["T_WHITESPACE","\n                ",165],"}",["T_WHITESPACE","\n            ",166],"}",["T_WHITESPACE","\n        ",167],"}",["T_WHITESPACE","\n\n        ",168],["T_IF","if",170],["T_WHITESPACE"," ",170],"(","!",["T_EMPTY","empty",170],"(",["T_VARIABLE","$updateData",170],")",")",["T_WHITESPACE"," ",170],"{",["T_WHITESPACE","\n            ",170],["T_VARIABLE","$updateData",171],["T_WHITESPACE"," ",171],["T_PLUS_EQUAL","+=",171],["T_WHITESPACE"," ",171],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",171],["T_WHITESPACE"," ",171],["T_DOUBLE_ARROW","=>",171],["T_WHITESPACE"," ",171],["T_VARIABLE","$productId",171],"]",";",["T_WHITESPACE","\n            ",171],["T_VARIABLE","$updateFields",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],"[","]",";",["T_WHITESPACE","\n            ",172],["T_FOREACH","foreach",173],["T_WHITESPACE"," ",173],"(",["T_VARIABLE","$updateData",173],["T_WHITESPACE"," ",173],["T_AS","as",173],["T_WHITESPACE"," ",173],["T_VARIABLE","$key",173],["T_WHITESPACE"," ",173],["T_DOUBLE_ARROW","=>",173],["T_WHITESPACE"," ",173],["T_VARIABLE","$value",173],")",["T_WHITESPACE"," ",173],"{",["T_WHITESPACE","\n                ",173],["T_VARIABLE","$updateFields",174],"[",["T_VARIABLE","$key",174],"]",["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_VARIABLE","$key",174],";",["T_WHITESPACE","\n            ",174],"}",["T_WHITESPACE","\n            ",175],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","_connection",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","insertOnDuplicate",176],"(",["T_VARIABLE","$flatTable",176],",",["T_WHITESPACE"," ",176],["T_VARIABLE","$updateData",176],",",["T_WHITESPACE"," ",176],["T_VARIABLE","$updateFields",176],")",";",["T_WHITESPACE","\n        ",176],"}",["T_WHITESPACE","\n\n        ",177],["T_RETURN","return",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],";",["T_WHITESPACE","\n    ",179],"}",["T_WHITESPACE","\n\n    ",180],["T_DOC_COMMENT","\/**\n     * @return \\Magento\\Framework\\EntityManager\\MetadataPool\n     *\/",182],["T_WHITESPACE","\n    ",184],["T_PRIVATE","private",185],["T_WHITESPACE"," ",185],["T_FUNCTION","function",185],["T_WHITESPACE"," ",185],["T_STRING","getMetadataPool",185],"(",")",["T_WHITESPACE","\n    ",185],"{",["T_WHITESPACE","\n        ",186],["T_IF","if",187],["T_WHITESPACE"," ",187],"(",["T_STRING","null",187],["T_WHITESPACE"," ",187],["T_IS_IDENTICAL","===",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","metadataPool",187],")",["T_WHITESPACE"," ",187],"{",["T_WHITESPACE","\n            ",187],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","metadataPool",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_NS_SEPARATOR","\\",188],["T_STRING","Magento",188],["T_NS_SEPARATOR","\\",188],["T_STRING","Framework",188],["T_NS_SEPARATOR","\\",188],["T_STRING","App",188],["T_NS_SEPARATOR","\\",188],["T_STRING","ObjectManager",188],["T_DOUBLE_COLON","::",188],["T_STRING","getInstance",188],"(",")",["T_WHITESPACE","\n                ",188],["T_OBJECT_OPERATOR","->",189],["T_STRING","get",189],"(",["T_NS_SEPARATOR","\\",189],["T_STRING","Magento",189],["T_NS_SEPARATOR","\\",189],["T_STRING","Framework",189],["T_NS_SEPARATOR","\\",189],["T_STRING","EntityManager",189],["T_NS_SEPARATOR","\\",189],["T_STRING","MetadataPool",189],["T_DOUBLE_COLON","::",189],["T_CLASS","class",189],")",";",["T_WHITESPACE","\n        ",189],"}",["T_WHITESPACE","\n        ",190],["T_RETURN","return",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","metadataPool",191],";",["T_WHITESPACE","\n    ",191],"}",["T_WHITESPACE","\n",192],"}",["T_WHITESPACE","\n",193]]