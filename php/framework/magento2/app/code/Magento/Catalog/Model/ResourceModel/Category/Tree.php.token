[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Catalog",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","ResourceModel",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Category",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Data",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Tree",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Dbp",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Catalog",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Api",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Data",9],["T_NS_SEPARATOR","\\",9],["T_STRING","CategoryInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","EntityManager",10],["T_NS_SEPARATOR","\\",10],["T_STRING","MetadataPool",10],";",["T_WHITESPACE","\n\n",10],["T_DOC_COMMENT","\/**\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",12],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","Tree",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_STRING","Dbp",15],["T_WHITESPACE","\n",15],"{",["T_WHITESPACE","\n    ",16],["T_CONST","const",17],["T_WHITESPACE"," ",17],["T_STRING","ID_FIELD",17],["T_WHITESPACE"," ",17],"=",["T_WHITESPACE"," ",17],["T_CONSTANT_ENCAPSED_STRING","'id'",17],";",["T_WHITESPACE","\n\n    ",17],["T_CONST","const",19],["T_WHITESPACE"," ",19],["T_STRING","PATH_FIELD",19],["T_WHITESPACE"," ",19],"=",["T_WHITESPACE"," ",19],["T_CONSTANT_ENCAPSED_STRING","'path'",19],";",["T_WHITESPACE","\n\n    ",19],["T_CONST","const",21],["T_WHITESPACE"," ",21],["T_STRING","ORDER_FIELD",21],["T_WHITESPACE"," ",21],"=",["T_WHITESPACE"," ",21],["T_CONSTANT_ENCAPSED_STRING","'order'",21],";",["T_WHITESPACE","\n\n    ",21],["T_CONST","const",23],["T_WHITESPACE"," ",23],["T_STRING","LEVEL_FIELD",23],["T_WHITESPACE"," ",23],"=",["T_WHITESPACE"," ",23],["T_CONSTANT_ENCAPSED_STRING","'level'",23],";",["T_WHITESPACE","\n\n    ",23],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Event\\ManagerInterface\n     *\/",25],["T_WHITESPACE","\n    ",27],["T_PRIVATE","private",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$_eventManager",28],";",["T_WHITESPACE","\n\n    ",28],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Catalog\\Model\\Attribute\\Config\n     *\/",30],["T_WHITESPACE","\n    ",32],["T_PRIVATE","private",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$_attributeConfig",33],";",["T_WHITESPACE","\n\n    ",33],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Catalog\\Model\\ResourceModel\\Category\\Collection\\Factory\n     *\/",35],["T_WHITESPACE","\n    ",37],["T_PRIVATE","private",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$_collectionFactory",38],";",["T_WHITESPACE","\n\n    ",38],["T_DOC_COMMENT","\/**\n     * Categories resource collection\n     *\n     * @var Collection\n     *\/",40],["T_WHITESPACE","\n    ",44],["T_PROTECTED","protected",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$_collection",45],";",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * Join URL rewrites data to collection flag\n     *\n     * @var boolean\n     *\/",47],["T_WHITESPACE","\n    ",51],["T_PROTECTED","protected",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$_joinUrlRewriteIntoCollection",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_STRING","false",52],";",["T_WHITESPACE","\n\n    ",52],["T_DOC_COMMENT","\/**\n     * Inactive categories ids\n     *\n     * @var array\n     *\/",54],["T_WHITESPACE","\n    ",58],["T_PROTECTED","protected",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$_inactiveCategoryIds",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_STRING","null",59],";",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * Store id\n     *\n     * @var integer\n     *\/",61],["T_WHITESPACE","\n    ",65],["T_PROTECTED","protected",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$_storeId",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_STRING","null",66],";",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\App\\ResourceConnection\n     *\/",68],["T_WHITESPACE","\n    ",70],["T_PROTECTED","protected",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$_coreResource",71],";",["T_WHITESPACE","\n\n    ",71],["T_DOC_COMMENT","\/**\n     * Store manager\n     *\n     * @var \\Magento\\Store\\Model\\StoreManagerInterface\n     *\/",73],["T_WHITESPACE","\n    ",77],["T_PROTECTED","protected",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$_storeManager",78],";",["T_WHITESPACE","\n\n    ",78],["T_DOC_COMMENT","\/**\n     * Cache\n     *\n     * @var \\Magento\\Framework\\App\\CacheInterface\n     *\/",80],["T_WHITESPACE","\n    ",84],["T_PROTECTED","protected",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$_cache",85],";",["T_WHITESPACE","\n\n    ",85],["T_DOC_COMMENT","\/**\n     * Catalog category\n     *\n     * @var \\Magento\\Catalog\\Model\\ResourceModel\\Category\n     *\/",87],["T_WHITESPACE","\n    ",91],["T_PROTECTED","protected",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$_catalogCategory",92],";",["T_WHITESPACE","\n\n    ",92],["T_DOC_COMMENT","\/**\n     * @var MetadataPool\n     *\/",94],["T_WHITESPACE","\n    ",96],["T_PROTECTED","protected",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$metadataPool",97],";",["T_WHITESPACE","\n\n    ",97],["T_DOC_COMMENT","\/**\n     * Tree constructor.\n     * @param \\Magento\\Catalog\\Model\\ResourceModel\\Category $catalogCategory\n     * @param \\Magento\\Framework\\App\\CacheInterface $cache\n     * @param \\Magento\\Store\\Model\\StoreManagerInterface $storeManager\n     * @param \\Magento\\Framework\\App\\ResourceConnection $resource\n     * @param \\Magento\\Framework\\Event\\ManagerInterface $eventManager\n     * @param \\Magento\\Catalog\\Model\\Attribute\\Config $attributeConfig\n     * @param Collection\\Factory $collectionFactory\n     *\/",99],["T_WHITESPACE","\n    ",108],["T_PUBLIC","public",109],["T_WHITESPACE"," ",109],["T_FUNCTION","function",109],["T_WHITESPACE"," ",109],["T_STRING","__construct",109],"(",["T_WHITESPACE","\n        ",109],["T_NS_SEPARATOR","\\",110],["T_STRING","Magento",110],["T_NS_SEPARATOR","\\",110],["T_STRING","Catalog",110],["T_NS_SEPARATOR","\\",110],["T_STRING","Model",110],["T_NS_SEPARATOR","\\",110],["T_STRING","ResourceModel",110],["T_NS_SEPARATOR","\\",110],["T_STRING","Category",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$catalogCategory",110],",",["T_WHITESPACE","\n        ",110],["T_NS_SEPARATOR","\\",111],["T_STRING","Magento",111],["T_NS_SEPARATOR","\\",111],["T_STRING","Framework",111],["T_NS_SEPARATOR","\\",111],["T_STRING","App",111],["T_NS_SEPARATOR","\\",111],["T_STRING","CacheInterface",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$cache",111],",",["T_WHITESPACE","\n        ",111],["T_NS_SEPARATOR","\\",112],["T_STRING","Magento",112],["T_NS_SEPARATOR","\\",112],["T_STRING","Store",112],["T_NS_SEPARATOR","\\",112],["T_STRING","Model",112],["T_NS_SEPARATOR","\\",112],["T_STRING","StoreManagerInterface",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$storeManager",112],",",["T_WHITESPACE","\n        ",112],["T_NS_SEPARATOR","\\",113],["T_STRING","Magento",113],["T_NS_SEPARATOR","\\",113],["T_STRING","Framework",113],["T_NS_SEPARATOR","\\",113],["T_STRING","App",113],["T_NS_SEPARATOR","\\",113],["T_STRING","ResourceConnection",113],["T_WHITESPACE"," ",113],["T_VARIABLE","$resource",113],",",["T_WHITESPACE","\n        ",113],["T_NS_SEPARATOR","\\",114],["T_STRING","Magento",114],["T_NS_SEPARATOR","\\",114],["T_STRING","Framework",114],["T_NS_SEPARATOR","\\",114],["T_STRING","Event",114],["T_NS_SEPARATOR","\\",114],["T_STRING","ManagerInterface",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$eventManager",114],",",["T_WHITESPACE","\n        ",114],["T_NS_SEPARATOR","\\",115],["T_STRING","Magento",115],["T_NS_SEPARATOR","\\",115],["T_STRING","Catalog",115],["T_NS_SEPARATOR","\\",115],["T_STRING","Model",115],["T_NS_SEPARATOR","\\",115],["T_STRING","Attribute",115],["T_NS_SEPARATOR","\\",115],["T_STRING","Config",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$attributeConfig",115],",",["T_WHITESPACE","\n        ",115],["T_NS_SEPARATOR","\\",116],["T_STRING","Magento",116],["T_NS_SEPARATOR","\\",116],["T_STRING","Catalog",116],["T_NS_SEPARATOR","\\",116],["T_STRING","Model",116],["T_NS_SEPARATOR","\\",116],["T_STRING","ResourceModel",116],["T_NS_SEPARATOR","\\",116],["T_STRING","Category",116],["T_NS_SEPARATOR","\\",116],["T_STRING","Collection",116],["T_NS_SEPARATOR","\\",116],["T_STRING","Factory",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$collectionFactory",116],["T_WHITESPACE","\n    ",116],")",["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","_catalogCategory",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$catalogCategory",118],";",["T_WHITESPACE","\n        ",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_cache",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$cache",119],";",["T_WHITESPACE","\n        ",119],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","_storeManager",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_VARIABLE","$storeManager",120],";",["T_WHITESPACE","\n        ",120],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","_coreResource",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_VARIABLE","$resource",121],";",["T_WHITESPACE","\n        ",121],["T_STRING","parent",122],["T_DOUBLE_COLON","::",122],["T_STRING","__construct",122],"(",["T_WHITESPACE","\n            ",122],["T_VARIABLE","$resource",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getConnection",123],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog'",123],")",",",["T_WHITESPACE","\n            ",123],["T_VARIABLE","$resource",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","getTableName",124],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_entity'",124],")",",",["T_WHITESPACE","\n            ",124],"[",["T_WHITESPACE","\n                ",125],["T_STRING","Dbp",126],["T_DOUBLE_COLON","::",126],["T_STRING","ID_FIELD",126],["T_WHITESPACE"," ",126],["T_DOUBLE_ARROW","=>",126],["T_WHITESPACE"," ",126],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",126],",",["T_WHITESPACE","\n                ",126],["T_STRING","Dbp",127],["T_DOUBLE_COLON","::",127],["T_STRING","PATH_FIELD",127],["T_WHITESPACE"," ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],["T_CONSTANT_ENCAPSED_STRING","'path'",127],",",["T_WHITESPACE","\n                ",127],["T_STRING","Dbp",128],["T_DOUBLE_COLON","::",128],["T_STRING","ORDER_FIELD",128],["T_WHITESPACE"," ",128],["T_DOUBLE_ARROW","=>",128],["T_WHITESPACE"," ",128],["T_CONSTANT_ENCAPSED_STRING","'position'",128],",",["T_WHITESPACE","\n                ",128],["T_STRING","Dbp",129],["T_DOUBLE_COLON","::",129],["T_STRING","LEVEL_FIELD",129],["T_WHITESPACE"," ",129],["T_DOUBLE_ARROW","=>",129],["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","'level'",129],["T_WHITESPACE","\n            ",129],"]",["T_WHITESPACE","\n        ",130],")",";",["T_WHITESPACE","\n        ",131],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","_eventManager",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_VARIABLE","$eventManager",132],";",["T_WHITESPACE","\n        ",132],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_attributeConfig",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_VARIABLE","$attributeConfig",133],";",["T_WHITESPACE","\n        ",133],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","_collectionFactory",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_VARIABLE","$collectionFactory",134],";",["T_WHITESPACE","\n    ",134],"}",["T_WHITESPACE","\n\n    ",135],["T_DOC_COMMENT","\/**\n     * Set store id\n     *\n     * @param integer $storeId\n     * @return $this\n     *\/",137],["T_WHITESPACE","\n    ",142],["T_PUBLIC","public",143],["T_WHITESPACE"," ",143],["T_FUNCTION","function",143],["T_WHITESPACE"," ",143],["T_STRING","setStoreId",143],"(",["T_VARIABLE","$storeId",143],")",["T_WHITESPACE","\n    ",143],"{",["T_WHITESPACE","\n        ",144],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","_storeId",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_INT_CAST","(int)",145],["T_VARIABLE","$storeId",145],";",["T_WHITESPACE","\n        ",145],["T_RETURN","return",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$this",146],";",["T_WHITESPACE","\n    ",146],"}",["T_WHITESPACE","\n\n    ",147],["T_DOC_COMMENT","\/**\n     * Return store id\n     *\n     * @return integer\n     *\/",149],["T_WHITESPACE","\n    ",153],["T_PUBLIC","public",154],["T_WHITESPACE"," ",154],["T_FUNCTION","function",154],["T_WHITESPACE"," ",154],["T_STRING","getStoreId",154],"(",")",["T_WHITESPACE","\n    ",154],"{",["T_WHITESPACE","\n        ",155],["T_IF","if",156],["T_WHITESPACE"," ",156],"(",["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","_storeId",156],["T_WHITESPACE"," ",156],["T_IS_IDENTICAL","===",156],["T_WHITESPACE"," ",156],["T_STRING","null",156],")",["T_WHITESPACE"," ",156],"{",["T_WHITESPACE","\n            ",156],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","_storeId",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","_storeManager",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","getStore",157],"(",")",["T_OBJECT_OPERATOR","->",157],["T_STRING","getId",157],"(",")",";",["T_WHITESPACE","\n        ",157],"}",["T_WHITESPACE","\n        ",158],["T_RETURN","return",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","_storeId",159],";",["T_WHITESPACE","\n    ",159],"}",["T_WHITESPACE","\n\n    ",160],["T_DOC_COMMENT","\/**\n     * Add data to collection\n     *\n     * @param Collection $collection\n     * @param boolean $sorted\n     * @param array $exclude\n     * @param boolean $toLoad\n     * @param boolean $onlyActive\n     * @return $this\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     * @SuppressWarnings(PHPMD.NPathComplexity)\n     *\/",162],["T_WHITESPACE","\n    ",173],["T_PUBLIC","public",174],["T_WHITESPACE"," ",174],["T_FUNCTION","function",174],["T_WHITESPACE"," ",174],["T_STRING","addCollectionData",174],"(",["T_WHITESPACE","\n        ",174],["T_VARIABLE","$collection",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_STRING","null",175],",",["T_WHITESPACE","\n        ",175],["T_VARIABLE","$sorted",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_STRING","false",176],",",["T_WHITESPACE","\n        ",176],["T_VARIABLE","$exclude",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],"[","]",",",["T_WHITESPACE","\n        ",177],["T_VARIABLE","$toLoad",178],["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_STRING","true",178],",",["T_WHITESPACE","\n        ",178],["T_VARIABLE","$onlyActive",179],["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_STRING","false",179],["T_WHITESPACE","\n    ",179],")",["T_WHITESPACE"," ",180],"{",["T_WHITESPACE","\n        ",180],["T_IF","if",181],["T_WHITESPACE"," ",181],"(",["T_VARIABLE","$collection",181],["T_WHITESPACE"," ",181],["T_IS_IDENTICAL","===",181],["T_WHITESPACE"," ",181],["T_STRING","null",181],")",["T_WHITESPACE"," ",181],"{",["T_WHITESPACE","\n            ",181],["T_VARIABLE","$collection",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","getCollection",182],"(",["T_VARIABLE","$sorted",182],")",";",["T_WHITESPACE","\n        ",182],"}",["T_WHITESPACE"," ",183],["T_ELSE","else",183],["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n            ",183],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","setCollection",184],"(",["T_VARIABLE","$collection",184],")",";",["T_WHITESPACE","\n        ",184],"}",["T_WHITESPACE","\n\n        ",185],["T_IF","if",187],["T_WHITESPACE"," ",187],"(","!",["T_STRING","is_array",187],"(",["T_VARIABLE","$exclude",187],")",")",["T_WHITESPACE"," ",187],"{",["T_WHITESPACE","\n            ",187],["T_VARIABLE","$exclude",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],"[",["T_VARIABLE","$exclude",188],"]",";",["T_WHITESPACE","\n        ",188],"}",["T_WHITESPACE","\n\n        ",189],["T_VARIABLE","$nodeIds",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],"[","]",";",["T_WHITESPACE","\n        ",191],["T_FOREACH","foreach",192],["T_WHITESPACE"," ",192],"(",["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","getNodes",192],"(",")",["T_WHITESPACE"," ",192],["T_AS","as",192],["T_WHITESPACE"," ",192],["T_VARIABLE","$node",192],")",["T_WHITESPACE"," ",192],"{",["T_WHITESPACE","\n            ",192],["T_IF","if",193],["T_WHITESPACE"," ",193],"(","!",["T_STRING","in_array",193],"(",["T_VARIABLE","$node",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","getId",193],"(",")",",",["T_WHITESPACE"," ",193],["T_VARIABLE","$exclude",193],")",")",["T_WHITESPACE"," ",193],"{",["T_WHITESPACE","\n                ",193],["T_VARIABLE","$nodeIds",194],"[","]",["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],["T_VARIABLE","$node",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","getId",194],"(",")",";",["T_WHITESPACE","\n            ",194],"}",["T_WHITESPACE","\n        ",195],"}",["T_WHITESPACE","\n        ",196],["T_VARIABLE","$collection",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","addIdFilter",197],"(",["T_VARIABLE","$nodeIds",197],")",";",["T_WHITESPACE","\n        ",197],["T_IF","if",198],["T_WHITESPACE"," ",198],"(",["T_VARIABLE","$onlyActive",198],")",["T_WHITESPACE"," ",198],"{",["T_WHITESPACE","\n            ",198],["T_VARIABLE","$disabledIds",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","_getDisabledIds",199],"(",["T_VARIABLE","$collection",199],",",["T_WHITESPACE"," ",199],["T_VARIABLE","$nodeIds",199],")",";",["T_WHITESPACE","\n            ",199],["T_IF","if",200],["T_WHITESPACE"," ",200],"(",["T_VARIABLE","$disabledIds",200],")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n                ",200],["T_VARIABLE","$collection",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","addFieldToFilter",201],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",201],",",["T_WHITESPACE"," ",201],"[",["T_CONSTANT_ENCAPSED_STRING","'nin'",201],["T_WHITESPACE"," ",201],["T_DOUBLE_ARROW","=>",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$disabledIds",201],"]",")",";",["T_WHITESPACE","\n            ",201],"}",["T_WHITESPACE","\n            ",202],["T_VARIABLE","$collection",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","addAttributeToFilter",203],"(",["T_CONSTANT_ENCAPSED_STRING","'is_active'",203],",",["T_WHITESPACE"," ",203],["T_LNUMBER","1",203],")",";",["T_WHITESPACE","\n            ",203],["T_VARIABLE","$collection",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","addAttributeToFilter",204],"(",["T_CONSTANT_ENCAPSED_STRING","'include_in_menu'",204],",",["T_WHITESPACE"," ",204],["T_LNUMBER","1",204],")",";",["T_WHITESPACE","\n        ",204],"}",["T_WHITESPACE","\n\n        ",205],["T_IF","if",207],["T_WHITESPACE"," ",207],"(",["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","_joinUrlRewriteIntoCollection",207],")",["T_WHITESPACE"," ",207],"{",["T_WHITESPACE","\n            ",207],["T_VARIABLE","$collection",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","joinUrlRewrite",208],"(",")",";",["T_WHITESPACE","\n            ",208],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","_joinUrlRewriteIntoCollection",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_STRING","false",209],";",["T_WHITESPACE","\n        ",209],"}",["T_WHITESPACE","\n\n        ",210],["T_IF","if",212],["T_WHITESPACE"," ",212],"(",["T_VARIABLE","$toLoad",212],")",["T_WHITESPACE"," ",212],"{",["T_WHITESPACE","\n            ",212],["T_VARIABLE","$collection",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","load",213],"(",")",";",["T_WHITESPACE","\n\n            ",213],["T_FOREACH","foreach",215],["T_WHITESPACE"," ",215],"(",["T_VARIABLE","$collection",215],["T_WHITESPACE"," ",215],["T_AS","as",215],["T_WHITESPACE"," ",215],["T_VARIABLE","$category",215],")",["T_WHITESPACE"," ",215],"{",["T_WHITESPACE","\n                ",215],["T_IF","if",216],["T_WHITESPACE"," ",216],"(",["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","getNodeById",216],"(",["T_VARIABLE","$category",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","getId",216],"(",")",")",")",["T_WHITESPACE"," ",216],"{",["T_WHITESPACE","\n                    ",216],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","getNodeById",217],"(",["T_VARIABLE","$category",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","getId",217],"(",")",")",["T_OBJECT_OPERATOR","->",217],["T_STRING","addData",217],"(",["T_VARIABLE","$category",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","getData",217],"(",")",")",";",["T_WHITESPACE","\n                ",217],"}",["T_WHITESPACE","\n            ",218],"}",["T_WHITESPACE","\n\n            ",219],["T_FOREACH","foreach",221],["T_WHITESPACE"," ",221],"(",["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","getNodes",221],"(",")",["T_WHITESPACE"," ",221],["T_AS","as",221],["T_WHITESPACE"," ",221],["T_VARIABLE","$node",221],")",["T_WHITESPACE"," ",221],"{",["T_WHITESPACE","\n                ",221],["T_IF","if",222],["T_WHITESPACE"," ",222],"(","!",["T_VARIABLE","$collection",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","getItemById",222],"(",["T_VARIABLE","$node",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","getId",222],"(",")",")",["T_WHITESPACE"," ",222],["T_BOOLEAN_AND","&&",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$node",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","getParent",222],"(",")",")",["T_WHITESPACE"," ",222],"{",["T_WHITESPACE","\n                    ",222],["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","removeNode",223],"(",["T_VARIABLE","$node",223],")",";",["T_WHITESPACE","\n                ",223],"}",["T_WHITESPACE","\n            ",224],"}",["T_WHITESPACE","\n        ",225],"}",["T_WHITESPACE","\n\n        ",226],["T_RETURN","return",228],["T_WHITESPACE"," ",228],["T_VARIABLE","$this",228],";",["T_WHITESPACE","\n    ",228],"}",["T_WHITESPACE","\n\n    ",229],["T_DOC_COMMENT","\/**\n     * Add inactive categories ids\n     *\n     * @param mixed $ids\n     * @return $this\n     *\/",231],["T_WHITESPACE","\n    ",236],["T_PUBLIC","public",237],["T_WHITESPACE"," ",237],["T_FUNCTION","function",237],["T_WHITESPACE"," ",237],["T_STRING","addInactiveCategoryIds",237],"(",["T_VARIABLE","$ids",237],")",["T_WHITESPACE","\n    ",237],"{",["T_WHITESPACE","\n        ",238],["T_IF","if",239],["T_WHITESPACE"," ",239],"(","!",["T_STRING","is_array",239],"(",["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","_inactiveCategoryIds",239],")",")",["T_WHITESPACE"," ",239],"{",["T_WHITESPACE","\n            ",239],["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","_initInactiveCategoryIds",240],"(",")",";",["T_WHITESPACE","\n        ",240],"}",["T_WHITESPACE","\n        ",241],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","_inactiveCategoryIds",242],["T_WHITESPACE"," ",242],"=",["T_WHITESPACE"," ",242],["T_STRING","array_merge",242],"(",["T_VARIABLE","$ids",242],",",["T_WHITESPACE"," ",242],["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","_inactiveCategoryIds",242],")",";",["T_WHITESPACE","\n        ",242],["T_RETURN","return",243],["T_WHITESPACE"," ",243],["T_VARIABLE","$this",243],";",["T_WHITESPACE","\n    ",243],"}",["T_WHITESPACE","\n\n    ",244],["T_DOC_COMMENT","\/**\n     * Retrieve inactive categories ids\n     *\n     * @return $this\n     *\/",246],["T_WHITESPACE","\n    ",250],["T_PROTECTED","protected",251],["T_WHITESPACE"," ",251],["T_FUNCTION","function",251],["T_WHITESPACE"," ",251],["T_STRING","_initInactiveCategoryIds",251],"(",")",["T_WHITESPACE","\n    ",251],"{",["T_WHITESPACE","\n        ",252],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","_inactiveCategoryIds",253],["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],"[","]",";",["T_WHITESPACE","\n        ",253],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","_eventManager",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","dispatch",254],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_tree_init_inactive_category_ids'",254],",",["T_WHITESPACE"," ",254],"[",["T_CONSTANT_ENCAPSED_STRING","'tree'",254],["T_WHITESPACE"," ",254],["T_DOUBLE_ARROW","=>",254],["T_WHITESPACE"," ",254],["T_VARIABLE","$this",254],"]",")",";",["T_WHITESPACE","\n        ",254],["T_RETURN","return",255],["T_WHITESPACE"," ",255],["T_VARIABLE","$this",255],";",["T_WHITESPACE","\n    ",255],"}",["T_WHITESPACE","\n\n    ",256],["T_DOC_COMMENT","\/**\n     * Retrieve inactive categories ids\n     *\n     * @return array\n     *\/",258],["T_WHITESPACE","\n    ",262],["T_PUBLIC","public",263],["T_WHITESPACE"," ",263],["T_FUNCTION","function",263],["T_WHITESPACE"," ",263],["T_STRING","getInactiveCategoryIds",263],"(",")",["T_WHITESPACE","\n    ",263],"{",["T_WHITESPACE","\n        ",264],["T_IF","if",265],["T_WHITESPACE"," ",265],"(","!",["T_STRING","is_array",265],"(",["T_VARIABLE","$this",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","_inactiveCategoryIds",265],")",")",["T_WHITESPACE"," ",265],"{",["T_WHITESPACE","\n            ",265],["T_VARIABLE","$this",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","_initInactiveCategoryIds",266],"(",")",";",["T_WHITESPACE","\n        ",266],"}",["T_WHITESPACE","\n\n        ",267],["T_RETURN","return",269],["T_WHITESPACE"," ",269],["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","_inactiveCategoryIds",269],";",["T_WHITESPACE","\n    ",269],"}",["T_WHITESPACE","\n\n    ",270],["T_DOC_COMMENT","\/**\n     * Return disable category ids\n     *\n     * @param Collection $collection\n     * @param array $allIds\n     * @return array\n     *\/",272],["T_WHITESPACE","\n    ",278],["T_PROTECTED","protected",279],["T_WHITESPACE"," ",279],["T_FUNCTION","function",279],["T_WHITESPACE"," ",279],["T_STRING","_getDisabledIds",279],"(",["T_VARIABLE","$collection",279],",",["T_WHITESPACE"," ",279],["T_VARIABLE","$allIds",279],")",["T_WHITESPACE","\n    ",279],"{",["T_WHITESPACE","\n        ",280],["T_VARIABLE","$storeId",281],["T_WHITESPACE"," ",281],"=",["T_WHITESPACE"," ",281],["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","_storeManager",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","getStore",281],"(",")",["T_OBJECT_OPERATOR","->",281],["T_STRING","getId",281],"(",")",";",["T_WHITESPACE","\n        ",281],["T_VARIABLE","$this",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","_inactiveItems",282],["T_WHITESPACE"," ",282],"=",["T_WHITESPACE"," ",282],["T_VARIABLE","$this",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","getInactiveCategoryIds",282],"(",")",";",["T_WHITESPACE","\n        ",282],["T_VARIABLE","$this",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","_inactiveItems",283],["T_WHITESPACE"," ",283],"=",["T_WHITESPACE"," ",283],["T_STRING","array_merge",283],"(",["T_VARIABLE","$this",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","_getInactiveItemIds",283],"(",["T_VARIABLE","$collection",283],",",["T_WHITESPACE"," ",283],["T_VARIABLE","$storeId",283],")",",",["T_WHITESPACE"," ",283],["T_VARIABLE","$this",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","_inactiveItems",283],")",";",["T_WHITESPACE","\n\n        ",283],["T_VARIABLE","$disabledIds",285],["T_WHITESPACE"," ",285],"=",["T_WHITESPACE"," ",285],"[","]",";",["T_WHITESPACE","\n\n        ",285],["T_FOREACH","foreach",287],["T_WHITESPACE"," ",287],"(",["T_VARIABLE","$allIds",287],["T_WHITESPACE"," ",287],["T_AS","as",287],["T_WHITESPACE"," ",287],["T_VARIABLE","$id",287],")",["T_WHITESPACE"," ",287],"{",["T_WHITESPACE","\n            ",287],["T_VARIABLE","$parents",288],["T_WHITESPACE"," ",288],"=",["T_WHITESPACE"," ",288],["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","getNodeById",288],"(",["T_VARIABLE","$id",288],")",["T_OBJECT_OPERATOR","->",288],["T_STRING","getPath",288],"(",")",";",["T_WHITESPACE","\n            ",288],["T_FOREACH","foreach",289],["T_WHITESPACE"," ",289],"(",["T_VARIABLE","$parents",289],["T_WHITESPACE"," ",289],["T_AS","as",289],["T_WHITESPACE"," ",289],["T_VARIABLE","$parent",289],")",["T_WHITESPACE"," ",289],"{",["T_WHITESPACE","\n                ",289],["T_IF","if",290],["T_WHITESPACE"," ",290],"(","!",["T_VARIABLE","$this",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","_getItemIsActive",290],"(",["T_VARIABLE","$parent",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","getId",290],"(",")",",",["T_WHITESPACE"," ",290],["T_VARIABLE","$storeId",290],")",")",["T_WHITESPACE"," ",290],"{",["T_WHITESPACE","\n                    ",290],["T_VARIABLE","$disabledIds",291],"[","]",["T_WHITESPACE"," ",291],"=",["T_WHITESPACE"," ",291],["T_VARIABLE","$id",291],";",["T_WHITESPACE","\n                    ",291],["T_CONTINUE","continue",292],";",["T_WHITESPACE","\n                ",292],"}",["T_WHITESPACE","\n            ",293],"}",["T_WHITESPACE","\n        ",294],"}",["T_WHITESPACE","\n        ",295],["T_RETURN","return",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$disabledIds",296],";",["T_WHITESPACE","\n    ",296],"}",["T_WHITESPACE","\n\n    ",297],["T_DOC_COMMENT","\/**\n     * Retrieve inactive category item ids\n     *\n     * @param Collection $collection\n     * @param int $storeId\n     * @return array\n     *\/",299],["T_WHITESPACE","\n    ",305],["T_PROTECTED","protected",306],["T_WHITESPACE"," ",306],["T_FUNCTION","function",306],["T_WHITESPACE"," ",306],["T_STRING","_getInactiveItemIds",306],"(",["T_VARIABLE","$collection",306],",",["T_WHITESPACE"," ",306],["T_VARIABLE","$storeId",306],")",["T_WHITESPACE","\n    ",306],"{",["T_WHITESPACE","\n        ",307],["T_VARIABLE","$linkField",308],["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],["T_VARIABLE","$this",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","getMetadataPool",308],"(",")",["T_OBJECT_OPERATOR","->",308],["T_STRING","getMetadata",308],"(",["T_STRING","CategoryInterface",308],["T_DOUBLE_COLON","::",308],["T_CLASS","class",308],")",["T_OBJECT_OPERATOR","->",308],["T_STRING","getLinkField",308],"(",")",";",["T_WHITESPACE","\n        ",308],["T_VARIABLE","$intTable",309],["T_WHITESPACE"," ",309],"=",["T_WHITESPACE"," ",309],["T_VARIABLE","$this",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","_coreResource",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","getTableName",309],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_entity_int'",309],")",";",["T_WHITESPACE","\n\n        ",309],["T_VARIABLE","$select",311],["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],["T_VARIABLE","$collection",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","getAllIdsSql",311],"(",")",["T_WHITESPACE","\n            ",311],["T_OBJECT_OPERATOR","->",312],["T_STRING","joinInner",312],"(",["T_WHITESPACE","\n                ",312],"[",["T_CONSTANT_ENCAPSED_STRING","'d'",313],["T_WHITESPACE"," ",313],["T_DOUBLE_ARROW","=>",313],["T_WHITESPACE"," ",313],["T_VARIABLE","$intTable",313],"]",",",["T_WHITESPACE","\n                ",313],"\"",["T_ENCAPSED_AND_WHITESPACE","e.",314],["T_CURLY_OPEN","{",314],["T_VARIABLE","$linkField",314],"}",["T_ENCAPSED_AND_WHITESPACE"," = d.",314],["T_CURLY_OPEN","{",314],["T_VARIABLE","$linkField",314],"}","\"",",",["T_WHITESPACE","\n                ",314],"[","]",["T_WHITESPACE","\n            ",315],")",["T_OBJECT_OPERATOR","->",316],["T_STRING","joinLeft",316],"(",["T_WHITESPACE","\n                ",316],"[",["T_CONSTANT_ENCAPSED_STRING","'c'",317],["T_WHITESPACE"," ",317],["T_DOUBLE_ARROW","=>",317],["T_WHITESPACE"," ",317],["T_VARIABLE","$intTable",317],"]",",",["T_WHITESPACE","\n                ",317],"\"",["T_ENCAPSED_AND_WHITESPACE","c.attribute_id = :attribute_id AND c.store_id = :store_id AND c.",318],["T_CURLY_OPEN","{",318],["T_VARIABLE","$linkField",318],"}",["T_ENCAPSED_AND_WHITESPACE"," = d.",318],["T_CURLY_OPEN","{",318],["T_VARIABLE","$linkField",318],"}","\"",",",["T_WHITESPACE","\n                ",318],"[","]",["T_WHITESPACE","\n            ",319],")",["T_OBJECT_OPERATOR","->",320],["T_STRING","where",320],"(",["T_WHITESPACE","\n                ",320],["T_CONSTANT_ENCAPSED_STRING","'d.attribute_id = :attribute_id'",321],["T_WHITESPACE","\n            ",321],")",["T_OBJECT_OPERATOR","->",322],["T_STRING","where",322],"(",["T_WHITESPACE","\n                ",322],["T_CONSTANT_ENCAPSED_STRING","'d.store_id = :zero_store_id'",323],["T_WHITESPACE","\n            ",323],")",["T_OBJECT_OPERATOR","->",324],["T_STRING","where",324],"(",["T_WHITESPACE","\n                ",324],["T_VARIABLE","$this",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","_conn",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","getCheckSql",325],"(",["T_CONSTANT_ENCAPSED_STRING","'c.value_id > 0'",325],",",["T_WHITESPACE"," ",325],["T_CONSTANT_ENCAPSED_STRING","'c.value'",325],",",["T_WHITESPACE"," ",325],["T_CONSTANT_ENCAPSED_STRING","'d.value'",325],")",["T_WHITESPACE"," ",325],".",["T_WHITESPACE"," ",325],["T_CONSTANT_ENCAPSED_STRING","' = :cond'",325],["T_WHITESPACE","\n            ",325],")",";",["T_WHITESPACE","\n\n        ",326],["T_RETURN","return",328],["T_WHITESPACE"," ",328],["T_VARIABLE","$this",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","_conn",328],["T_OBJECT_OPERATOR","->",328],["T_STRING","fetchCol",328],"(",["T_WHITESPACE","\n            ",328],["T_VARIABLE","$select",329],",",["T_WHITESPACE","\n            ",329],"[",["T_WHITESPACE","\n                ",330],["T_CONSTANT_ENCAPSED_STRING","'attribute_id'",331],["T_WHITESPACE"," ",331],["T_DOUBLE_ARROW","=>",331],["T_WHITESPACE"," ",331],["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","_catalogCategory",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","getIsActiveAttributeId",331],"(",")",",",["T_WHITESPACE","\n                ",331],["T_CONSTANT_ENCAPSED_STRING","'store_id'",332],["T_WHITESPACE"," ",332],["T_DOUBLE_ARROW","=>",332],["T_WHITESPACE"," ",332],["T_VARIABLE","$storeId",332],",",["T_WHITESPACE","\n                ",332],["T_CONSTANT_ENCAPSED_STRING","'zero_store_id'",333],["T_WHITESPACE"," ",333],["T_DOUBLE_ARROW","=>",333],["T_WHITESPACE"," ",333],["T_LNUMBER","0",333],",",["T_WHITESPACE","\n                ",333],["T_CONSTANT_ENCAPSED_STRING","'cond'",334],["T_WHITESPACE"," ",334],["T_DOUBLE_ARROW","=>",334],["T_WHITESPACE"," ",334],["T_LNUMBER","0",334],["T_WHITESPACE","\n            ",334],"]",["T_WHITESPACE","\n        ",335],")",";",["T_WHITESPACE","\n    ",336],"}",["T_WHITESPACE","\n\n    ",337],["T_DOC_COMMENT","\/**\n     * Check is category items active\n     *\n     * @param int $id\n     * @return boolean\n     * @SuppressWarnings(PHPMD.BooleanGetMethodName)\n     *\/",339],["T_WHITESPACE","\n    ",345],["T_PROTECTED","protected",346],["T_WHITESPACE"," ",346],["T_FUNCTION","function",346],["T_WHITESPACE"," ",346],["T_STRING","_getItemIsActive",346],"(",["T_VARIABLE","$id",346],")",["T_WHITESPACE","\n    ",346],"{",["T_WHITESPACE","\n        ",347],["T_IF","if",348],["T_WHITESPACE"," ",348],"(","!",["T_STRING","in_array",348],"(",["T_VARIABLE","$id",348],",",["T_WHITESPACE"," ",348],["T_VARIABLE","$this",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","_inactiveItems",348],")",")",["T_WHITESPACE"," ",348],"{",["T_WHITESPACE","\n            ",348],["T_RETURN","return",349],["T_WHITESPACE"," ",349],["T_STRING","true",349],";",["T_WHITESPACE","\n        ",349],"}",["T_WHITESPACE","\n        ",350],["T_RETURN","return",351],["T_WHITESPACE"," ",351],["T_STRING","false",351],";",["T_WHITESPACE","\n    ",351],"}",["T_WHITESPACE","\n\n    ",352],["T_DOC_COMMENT","\/**\n     * Get categories collection\n     *\n     * @param boolean $sorted\n     * @return Collection\n     *\/",354],["T_WHITESPACE","\n    ",359],["T_PUBLIC","public",360],["T_WHITESPACE"," ",360],["T_FUNCTION","function",360],["T_WHITESPACE"," ",360],["T_STRING","getCollection",360],"(",["T_VARIABLE","$sorted",360],["T_WHITESPACE"," ",360],"=",["T_WHITESPACE"," ",360],["T_STRING","false",360],")",["T_WHITESPACE","\n    ",360],"{",["T_WHITESPACE","\n        ",361],["T_IF","if",362],["T_WHITESPACE"," ",362],"(",["T_VARIABLE","$this",362],["T_OBJECT_OPERATOR","->",362],["T_STRING","_collection",362],["T_WHITESPACE"," ",362],["T_IS_IDENTICAL","===",362],["T_WHITESPACE"," ",362],["T_STRING","null",362],")",["T_WHITESPACE"," ",362],"{",["T_WHITESPACE","\n            ",362],["T_VARIABLE","$this",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","_collection",363],["T_WHITESPACE"," ",363],"=",["T_WHITESPACE"," ",363],["T_VARIABLE","$this",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","_getDefaultCollection",363],"(",["T_VARIABLE","$sorted",363],")",";",["T_WHITESPACE","\n        ",363],"}",["T_WHITESPACE","\n        ",364],["T_RETURN","return",365],["T_WHITESPACE"," ",365],["T_VARIABLE","$this",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","_collection",365],";",["T_WHITESPACE","\n    ",365],"}",["T_WHITESPACE","\n\n    ",366],["T_DOC_COMMENT","\/**\n     * Clean unneeded collection\n     *\n     * @param Collection|array $object\n     * @return void\n     *\/",368],["T_WHITESPACE","\n    ",373],["T_PROTECTED","protected",374],["T_WHITESPACE"," ",374],["T_FUNCTION","function",374],["T_WHITESPACE"," ",374],["T_STRING","_clean",374],"(",["T_VARIABLE","$object",374],")",["T_WHITESPACE","\n    ",374],"{",["T_WHITESPACE","\n        ",375],["T_IF","if",376],["T_WHITESPACE"," ",376],"(",["T_STRING","is_array",376],"(",["T_VARIABLE","$object",376],")",")",["T_WHITESPACE"," ",376],"{",["T_WHITESPACE","\n            ",376],["T_FOREACH","foreach",377],["T_WHITESPACE"," ",377],"(",["T_VARIABLE","$object",377],["T_WHITESPACE"," ",377],["T_AS","as",377],["T_WHITESPACE"," ",377],["T_VARIABLE","$obj",377],")",["T_WHITESPACE"," ",377],"{",["T_WHITESPACE","\n                ",377],["T_VARIABLE","$this",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","_clean",378],"(",["T_VARIABLE","$obj",378],")",";",["T_WHITESPACE","\n            ",378],"}",["T_WHITESPACE","\n        ",379],"}",["T_WHITESPACE","\n        ",380],["T_UNSET","unset",381],"(",["T_VARIABLE","$object",381],")",";",["T_WHITESPACE","\n    ",381],"}",["T_WHITESPACE","\n\n    ",382],["T_DOC_COMMENT","\/**\n     * Enter description here...\n     *\n     * @param Collection $collection\n     * @return $this\n     *\/",384],["T_WHITESPACE","\n    ",389],["T_PUBLIC","public",390],["T_WHITESPACE"," ",390],["T_FUNCTION","function",390],["T_WHITESPACE"," ",390],["T_STRING","setCollection",390],"(",["T_VARIABLE","$collection",390],")",["T_WHITESPACE","\n    ",390],"{",["T_WHITESPACE","\n        ",391],["T_IF","if",392],["T_WHITESPACE"," ",392],"(",["T_VARIABLE","$this",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","_collection",392],["T_WHITESPACE"," ",392],["T_IS_NOT_IDENTICAL","!==",392],["T_WHITESPACE"," ",392],["T_STRING","null",392],")",["T_WHITESPACE"," ",392],"{",["T_WHITESPACE","\n            ",392],["T_VARIABLE","$this",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","_clean",393],"(",["T_VARIABLE","$this",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","_collection",393],")",";",["T_WHITESPACE","\n        ",393],"}",["T_WHITESPACE","\n        ",394],["T_VARIABLE","$this",395],["T_OBJECT_OPERATOR","->",395],["T_STRING","_collection",395],["T_WHITESPACE"," ",395],"=",["T_WHITESPACE"," ",395],["T_VARIABLE","$collection",395],";",["T_WHITESPACE","\n        ",395],["T_RETURN","return",396],["T_WHITESPACE"," ",396],["T_VARIABLE","$this",396],";",["T_WHITESPACE","\n    ",396],"}",["T_WHITESPACE","\n\n    ",397],["T_DOC_COMMENT","\/**\n     * Enter description here...\n     *\n     * @param boolean $sorted\n     * @return Collection\n     *\/",399],["T_WHITESPACE","\n    ",404],["T_PROTECTED","protected",405],["T_WHITESPACE"," ",405],["T_FUNCTION","function",405],["T_WHITESPACE"," ",405],["T_STRING","_getDefaultCollection",405],"(",["T_VARIABLE","$sorted",405],["T_WHITESPACE"," ",405],"=",["T_WHITESPACE"," ",405],["T_STRING","false",405],")",["T_WHITESPACE","\n    ",405],"{",["T_WHITESPACE","\n        ",406],["T_VARIABLE","$this",407],["T_OBJECT_OPERATOR","->",407],["T_STRING","_joinUrlRewriteIntoCollection",407],["T_WHITESPACE"," ",407],"=",["T_WHITESPACE"," ",407],["T_STRING","true",407],";",["T_WHITESPACE","\n        ",407],["T_VARIABLE","$collection",408],["T_WHITESPACE"," ",408],"=",["T_WHITESPACE"," ",408],["T_VARIABLE","$this",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","_collectionFactory",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","create",408],"(",")",";",["T_WHITESPACE","\n        ",408],["T_VARIABLE","$attributes",409],["T_WHITESPACE"," ",409],"=",["T_WHITESPACE"," ",409],["T_VARIABLE","$this",409],["T_OBJECT_OPERATOR","->",409],["T_STRING","_attributeConfig",409],["T_OBJECT_OPERATOR","->",409],["T_STRING","getAttributeNames",409],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category'",409],")",";",["T_WHITESPACE","\n        ",409],["T_VARIABLE","$collection",410],["T_OBJECT_OPERATOR","->",410],["T_STRING","addAttributeToSelect",410],"(",["T_VARIABLE","$attributes",410],")",";",["T_WHITESPACE","\n\n        ",410],["T_IF","if",412],["T_WHITESPACE"," ",412],"(",["T_VARIABLE","$sorted",412],")",["T_WHITESPACE"," ",412],"{",["T_WHITESPACE","\n            ",412],["T_IF","if",413],["T_WHITESPACE"," ",413],"(",["T_STRING","is_string",413],"(",["T_VARIABLE","$sorted",413],")",")",["T_WHITESPACE"," ",413],"{",["T_WHITESPACE","\n                ",413],["T_COMMENT","\/\/ $sorted is supposed to be attribute name\n",414],["T_WHITESPACE","                ",415],["T_VARIABLE","$collection",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","addAttributeToSort",415],"(",["T_VARIABLE","$sorted",415],")",";",["T_WHITESPACE","\n            ",415],"}",["T_WHITESPACE"," ",416],["T_ELSE","else",416],["T_WHITESPACE"," ",416],"{",["T_WHITESPACE","\n                ",416],["T_VARIABLE","$collection",417],["T_OBJECT_OPERATOR","->",417],["T_STRING","addAttributeToSort",417],"(",["T_CONSTANT_ENCAPSED_STRING","'name'",417],")",";",["T_WHITESPACE","\n            ",417],"}",["T_WHITESPACE","\n        ",418],"}",["T_WHITESPACE","\n\n        ",419],["T_RETURN","return",421],["T_WHITESPACE"," ",421],["T_VARIABLE","$collection",421],";",["T_WHITESPACE","\n    ",421],"}",["T_WHITESPACE","\n\n    ",422],["T_DOC_COMMENT","\/**\n     * Executing parents move method and cleaning cache after it\n     *\n     * @param mixed $category\n     * @param mixed $newParent\n     * @param mixed $prevNode\n     * @return void\n     *\/",424],["T_WHITESPACE","\n    ",431],["T_PUBLIC","public",432],["T_WHITESPACE"," ",432],["T_FUNCTION","function",432],["T_WHITESPACE"," ",432],["T_STRING","move",432],"(",["T_VARIABLE","$category",432],",",["T_WHITESPACE"," ",432],["T_VARIABLE","$newParent",432],",",["T_WHITESPACE"," ",432],["T_VARIABLE","$prevNode",432],["T_WHITESPACE"," ",432],"=",["T_WHITESPACE"," ",432],["T_STRING","null",432],")",["T_WHITESPACE","\n    ",432],"{",["T_WHITESPACE","\n        ",433],["T_VARIABLE","$this",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","_catalogCategory",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","move",434],"(",["T_VARIABLE","$category",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","getId",434],"(",")",",",["T_WHITESPACE"," ",434],["T_VARIABLE","$newParent",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","getId",434],"(",")",")",";",["T_WHITESPACE","\n        ",434],["T_STRING","parent",435],["T_DOUBLE_COLON","::",435],["T_STRING","move",435],"(",["T_VARIABLE","$category",435],",",["T_WHITESPACE"," ",435],["T_VARIABLE","$newParent",435],",",["T_WHITESPACE"," ",435],["T_VARIABLE","$prevNode",435],")",";",["T_WHITESPACE","\n\n        ",435],["T_VARIABLE","$this",437],["T_OBJECT_OPERATOR","->",437],["T_STRING","_afterMove",437],"(",")",";",["T_WHITESPACE","\n    ",437],"}",["T_WHITESPACE","\n\n    ",438],["T_DOC_COMMENT","\/**\n     * Move tree after\n     *\n     * @return $this\n     *\/",440],["T_WHITESPACE","\n    ",444],["T_PROTECTED","protected",445],["T_WHITESPACE"," ",445],["T_FUNCTION","function",445],["T_WHITESPACE"," ",445],["T_STRING","_afterMove",445],"(",")",["T_WHITESPACE","\n    ",445],"{",["T_WHITESPACE","\n        ",446],["T_VARIABLE","$this",447],["T_OBJECT_OPERATOR","->",447],["T_STRING","_cache",447],["T_OBJECT_OPERATOR","->",447],["T_STRING","clean",447],"(","[",["T_NS_SEPARATOR","\\",447],["T_STRING","Magento",447],["T_NS_SEPARATOR","\\",447],["T_STRING","Catalog",447],["T_NS_SEPARATOR","\\",447],["T_STRING","Model",447],["T_NS_SEPARATOR","\\",447],["T_STRING","Category",447],["T_DOUBLE_COLON","::",447],["T_STRING","CACHE_TAG",447],"]",")",";",["T_WHITESPACE","\n        ",447],["T_RETURN","return",448],["T_WHITESPACE"," ",448],["T_VARIABLE","$this",448],";",["T_WHITESPACE","\n    ",448],"}",["T_WHITESPACE","\n\n    ",449],["T_DOC_COMMENT","\/**\n     * Load whole category tree, that will include specified categories ids.\n     *\n     * @param array $ids\n     * @param bool $addCollectionData\n     * @param bool $updateAnchorProductCount\n     * @return $this|bool\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     * @SuppressWarnings(PHPMD.NPathComplexity)\n     *\/",451],["T_WHITESPACE","\n    ",460],["T_PUBLIC","public",461],["T_WHITESPACE"," ",461],["T_FUNCTION","function",461],["T_WHITESPACE"," ",461],["T_STRING","loadByIds",461],"(",["T_VARIABLE","$ids",461],",",["T_WHITESPACE"," ",461],["T_VARIABLE","$addCollectionData",461],["T_WHITESPACE"," ",461],"=",["T_WHITESPACE"," ",461],["T_STRING","true",461],",",["T_WHITESPACE"," ",461],["T_VARIABLE","$updateAnchorProductCount",461],["T_WHITESPACE"," ",461],"=",["T_WHITESPACE"," ",461],["T_STRING","true",461],")",["T_WHITESPACE","\n    ",461],"{",["T_WHITESPACE","\n        ",462],["T_VARIABLE","$levelField",463],["T_WHITESPACE"," ",463],"=",["T_WHITESPACE"," ",463],["T_VARIABLE","$this",463],["T_OBJECT_OPERATOR","->",463],["T_STRING","_conn",463],["T_OBJECT_OPERATOR","->",463],["T_STRING","quoteIdentifier",463],"(",["T_CONSTANT_ENCAPSED_STRING","'level'",463],")",";",["T_WHITESPACE","\n        ",463],["T_VARIABLE","$pathField",464],["T_WHITESPACE"," ",464],"=",["T_WHITESPACE"," ",464],["T_VARIABLE","$this",464],["T_OBJECT_OPERATOR","->",464],["T_STRING","_conn",464],["T_OBJECT_OPERATOR","->",464],["T_STRING","quoteIdentifier",464],"(",["T_CONSTANT_ENCAPSED_STRING","'path'",464],")",";",["T_WHITESPACE","\n        ",464],["T_COMMENT","\/\/ load first two levels, if no ids specified\n",465],["T_WHITESPACE","        ",466],["T_IF","if",466],["T_WHITESPACE"," ",466],"(",["T_EMPTY","empty",466],"(",["T_VARIABLE","$ids",466],")",")",["T_WHITESPACE"," ",466],"{",["T_WHITESPACE","\n            ",466],["T_VARIABLE","$select",467],["T_WHITESPACE"," ",467],"=",["T_WHITESPACE"," ",467],["T_VARIABLE","$this",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","_conn",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","select",467],"(",")",["T_OBJECT_OPERATOR","->",467],["T_STRING","from",467],"(",["T_VARIABLE","$this",467],["T_OBJECT_OPERATOR","->",467],["T_STRING","_table",467],",",["T_WHITESPACE"," ",467],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",467],")",["T_OBJECT_OPERATOR","->",467],["T_STRING","where",467],"(",["T_VARIABLE","$levelField",467],["T_WHITESPACE"," ",467],".",["T_WHITESPACE"," ",467],["T_CONSTANT_ENCAPSED_STRING","' <= 2'",467],")",";",["T_WHITESPACE","\n            ",467],["T_VARIABLE","$ids",468],["T_WHITESPACE"," ",468],"=",["T_WHITESPACE"," ",468],["T_VARIABLE","$this",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","_conn",468],["T_OBJECT_OPERATOR","->",468],["T_STRING","fetchCol",468],"(",["T_VARIABLE","$select",468],")",";",["T_WHITESPACE","\n        ",468],"}",["T_WHITESPACE","\n        ",469],["T_IF","if",470],["T_WHITESPACE"," ",470],"(","!",["T_STRING","is_array",470],"(",["T_VARIABLE","$ids",470],")",")",["T_WHITESPACE"," ",470],"{",["T_WHITESPACE","\n            ",470],["T_VARIABLE","$ids",471],["T_WHITESPACE"," ",471],"=",["T_WHITESPACE"," ",471],"[",["T_VARIABLE","$ids",471],"]",";",["T_WHITESPACE","\n        ",471],"}",["T_WHITESPACE","\n        ",472],["T_FOREACH","foreach",473],["T_WHITESPACE"," ",473],"(",["T_VARIABLE","$ids",473],["T_WHITESPACE"," ",473],["T_AS","as",473],["T_WHITESPACE"," ",473],["T_VARIABLE","$key",473],["T_WHITESPACE"," ",473],["T_DOUBLE_ARROW","=>",473],["T_WHITESPACE"," ",473],["T_VARIABLE","$id",473],")",["T_WHITESPACE"," ",473],"{",["T_WHITESPACE","\n            ",473],["T_VARIABLE","$ids",474],"[",["T_VARIABLE","$key",474],"]",["T_WHITESPACE"," ",474],"=",["T_WHITESPACE"," ",474],["T_INT_CAST","(int)",474],["T_VARIABLE","$id",474],";",["T_WHITESPACE","\n        ",474],"}",["T_WHITESPACE","\n\n        ",475],["T_COMMENT","\/\/ collect paths of specified IDs and prepare to collect all their parents and neighbours\n",477],["T_WHITESPACE","        ",478],["T_VARIABLE","$select",478],["T_WHITESPACE"," ",478],"=",["T_WHITESPACE"," ",478],["T_VARIABLE","$this",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","_conn",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","select",478],"(",")",["T_OBJECT_OPERATOR","->",478],["T_STRING","from",478],"(",["T_VARIABLE","$this",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","_table",478],",",["T_WHITESPACE"," ",478],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",478],",",["T_WHITESPACE"," ",478],["T_CONSTANT_ENCAPSED_STRING","'level'",478],"]",")",["T_OBJECT_OPERATOR","->",478],["T_STRING","where",478],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id IN (?)'",478],",",["T_WHITESPACE"," ",478],["T_VARIABLE","$ids",478],")",";",["T_WHITESPACE","\n        ",478],["T_VARIABLE","$where",479],["T_WHITESPACE"," ",479],"=",["T_WHITESPACE"," ",479],"[",["T_VARIABLE","$levelField",479],["T_WHITESPACE"," ",479],".",["T_WHITESPACE"," ",479],["T_CONSTANT_ENCAPSED_STRING","'=0'",479],["T_WHITESPACE"," ",479],["T_DOUBLE_ARROW","=>",479],["T_WHITESPACE"," ",479],["T_STRING","true",479],"]",";",["T_WHITESPACE","\n\n        ",479],["T_FOREACH","foreach",481],["T_WHITESPACE"," ",481],"(",["T_VARIABLE","$this",481],["T_OBJECT_OPERATOR","->",481],["T_STRING","_conn",481],["T_OBJECT_OPERATOR","->",481],["T_STRING","fetchAll",481],"(",["T_VARIABLE","$select",481],")",["T_WHITESPACE"," ",481],["T_AS","as",481],["T_WHITESPACE"," ",481],["T_VARIABLE","$item",481],")",["T_WHITESPACE"," ",481],"{",["T_WHITESPACE","\n            ",481],["T_VARIABLE","$pathIds",482],["T_WHITESPACE"," ",482],"=",["T_WHITESPACE"," ",482],["T_STRING","explode",482],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",482],",",["T_WHITESPACE"," ",482],["T_VARIABLE","$item",482],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",482],"]",")",";",["T_WHITESPACE","\n            ",482],["T_VARIABLE","$level",483],["T_WHITESPACE"," ",483],"=",["T_WHITESPACE"," ",483],["T_INT_CAST","(int)",483],["T_VARIABLE","$item",483],"[",["T_CONSTANT_ENCAPSED_STRING","'level'",483],"]",";",["T_WHITESPACE","\n            ",483],["T_WHILE","while",484],["T_WHITESPACE"," ",484],"(",["T_VARIABLE","$level",484],["T_WHITESPACE"," ",484],">",["T_WHITESPACE"," ",484],["T_LNUMBER","0",484],")",["T_WHITESPACE"," ",484],"{",["T_WHITESPACE","\n                ",484],["T_VARIABLE","$pathIds",485],"[",["T_STRING","count",485],"(",["T_VARIABLE","$pathIds",485],")",["T_WHITESPACE"," ",485],"-",["T_WHITESPACE"," ",485],["T_LNUMBER","1",485],"]",["T_WHITESPACE"," ",485],"=",["T_WHITESPACE"," ",485],["T_CONSTANT_ENCAPSED_STRING","'%'",485],";",["T_WHITESPACE","\n                ",485],["T_VARIABLE","$path",486],["T_WHITESPACE"," ",486],"=",["T_WHITESPACE"," ",486],["T_STRING","implode",486],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",486],",",["T_WHITESPACE"," ",486],["T_VARIABLE","$pathIds",486],")",";",["T_WHITESPACE","\n                ",486],["T_VARIABLE","$where",487],"[","\"",["T_CURLY_OPEN","{",487],["T_VARIABLE","$levelField",487],"}",["T_ENCAPSED_AND_WHITESPACE","=",487],["T_CURLY_OPEN","{",487],["T_VARIABLE","$level",487],"}",["T_ENCAPSED_AND_WHITESPACE"," AND ",487],["T_CURLY_OPEN","{",487],["T_VARIABLE","$pathField",487],"}",["T_ENCAPSED_AND_WHITESPACE"," LIKE '",487],["T_CURLY_OPEN","{",487],["T_VARIABLE","$path",487],"}",["T_ENCAPSED_AND_WHITESPACE","'",487],"\"","]",["T_WHITESPACE"," ",487],"=",["T_WHITESPACE"," ",487],["T_STRING","true",487],";",["T_WHITESPACE","\n                ",487],["T_STRING","array_pop",488],"(",["T_VARIABLE","$pathIds",488],")",";",["T_WHITESPACE","\n                ",488],["T_VARIABLE","$level",489],["T_DEC","--",489],";",["T_WHITESPACE","\n            ",489],"}",["T_WHITESPACE","\n        ",490],"}",["T_WHITESPACE","\n        ",491],["T_VARIABLE","$where",492],["T_WHITESPACE"," ",492],"=",["T_WHITESPACE"," ",492],["T_STRING","array_keys",492],"(",["T_VARIABLE","$where",492],")",";",["T_WHITESPACE","\n\n        ",492],["T_COMMENT","\/\/ get all required records\n",494],["T_WHITESPACE","        ",495],["T_IF","if",495],["T_WHITESPACE"," ",495],"(",["T_VARIABLE","$addCollectionData",495],")",["T_WHITESPACE"," ",495],"{",["T_WHITESPACE","\n            ",495],["T_VARIABLE","$select",496],["T_WHITESPACE"," ",496],"=",["T_WHITESPACE"," ",496],["T_VARIABLE","$this",496],["T_OBJECT_OPERATOR","->",496],["T_STRING","_createCollectionDataSelect",496],"(",")",";",["T_WHITESPACE","\n        ",496],"}",["T_WHITESPACE"," ",497],["T_ELSE","else",497],["T_WHITESPACE"," ",497],"{",["T_WHITESPACE","\n            ",497],["T_VARIABLE","$select",498],["T_WHITESPACE"," ",498],"=",["T_WHITESPACE"," ",498],["T_CLONE","clone",498],["T_WHITESPACE"," ",498],["T_VARIABLE","$this",498],["T_OBJECT_OPERATOR","->",498],["T_STRING","_select",498],";",["T_WHITESPACE","\n            ",498],["T_VARIABLE","$select",499],["T_OBJECT_OPERATOR","->",499],["T_STRING","order",499],"(",["T_VARIABLE","$this",499],["T_OBJECT_OPERATOR","->",499],["T_STRING","_orderField",499],["T_WHITESPACE"," ",499],".",["T_WHITESPACE"," ",499],["T_CONSTANT_ENCAPSED_STRING","' '",499],["T_WHITESPACE"," ",499],".",["T_WHITESPACE"," ",499],["T_NS_SEPARATOR","\\",499],["T_STRING","Magento",499],["T_NS_SEPARATOR","\\",499],["T_STRING","Framework",499],["T_NS_SEPARATOR","\\",499],["T_STRING","DB",499],["T_NS_SEPARATOR","\\",499],["T_STRING","Select",499],["T_DOUBLE_COLON","::",499],["T_STRING","SQL_ASC",499],")",";",["T_WHITESPACE","\n        ",499],"}",["T_WHITESPACE","\n        ",500],["T_VARIABLE","$select",501],["T_OBJECT_OPERATOR","->",501],["T_STRING","where",501],"(",["T_STRING","implode",501],"(",["T_CONSTANT_ENCAPSED_STRING","' OR '",501],",",["T_WHITESPACE"," ",501],["T_VARIABLE","$where",501],")",")",";",["T_WHITESPACE","\n\n        ",501],["T_COMMENT","\/\/ get array of records and add them as nodes to the tree\n",503],["T_WHITESPACE","        ",504],["T_VARIABLE","$arrNodes",504],["T_WHITESPACE"," ",504],"=",["T_WHITESPACE"," ",504],["T_VARIABLE","$this",504],["T_OBJECT_OPERATOR","->",504],["T_STRING","_conn",504],["T_OBJECT_OPERATOR","->",504],["T_STRING","fetchAll",504],"(",["T_VARIABLE","$select",504],")",";",["T_WHITESPACE","\n        ",504],["T_IF","if",505],["T_WHITESPACE"," ",505],"(","!",["T_VARIABLE","$arrNodes",505],")",["T_WHITESPACE"," ",505],"{",["T_WHITESPACE","\n            ",505],["T_RETURN","return",506],["T_WHITESPACE"," ",506],["T_STRING","false",506],";",["T_WHITESPACE","\n        ",506],"}",["T_WHITESPACE","\n        ",507],["T_IF","if",508],["T_WHITESPACE"," ",508],"(",["T_VARIABLE","$updateAnchorProductCount",508],")",["T_WHITESPACE"," ",508],"{",["T_WHITESPACE","\n            ",508],["T_VARIABLE","$this",509],["T_OBJECT_OPERATOR","->",509],["T_STRING","_updateAnchorProductCount",509],"(",["T_VARIABLE","$arrNodes",509],")",";",["T_WHITESPACE","\n        ",509],"}",["T_WHITESPACE","\n        ",510],["T_VARIABLE","$childrenItems",511],["T_WHITESPACE"," ",511],"=",["T_WHITESPACE"," ",511],"[","]",";",["T_WHITESPACE","\n        ",511],["T_FOREACH","foreach",512],["T_WHITESPACE"," ",512],"(",["T_VARIABLE","$arrNodes",512],["T_WHITESPACE"," ",512],["T_AS","as",512],["T_WHITESPACE"," ",512],["T_VARIABLE","$key",512],["T_WHITESPACE"," ",512],["T_DOUBLE_ARROW","=>",512],["T_WHITESPACE"," ",512],["T_VARIABLE","$nodeInfo",512],")",["T_WHITESPACE"," ",512],"{",["T_WHITESPACE","\n            ",512],["T_VARIABLE","$pathToParent",513],["T_WHITESPACE"," ",513],"=",["T_WHITESPACE"," ",513],["T_STRING","explode",513],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",513],",",["T_WHITESPACE"," ",513],["T_VARIABLE","$nodeInfo",513],"[",["T_VARIABLE","$this",513],["T_OBJECT_OPERATOR","->",513],["T_STRING","_pathField",513],"]",")",";",["T_WHITESPACE","\n            ",513],["T_STRING","array_pop",514],"(",["T_VARIABLE","$pathToParent",514],")",";",["T_WHITESPACE","\n            ",514],["T_VARIABLE","$pathToParent",515],["T_WHITESPACE"," ",515],"=",["T_WHITESPACE"," ",515],["T_STRING","implode",515],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",515],",",["T_WHITESPACE"," ",515],["T_VARIABLE","$pathToParent",515],")",";",["T_WHITESPACE","\n            ",515],["T_VARIABLE","$childrenItems",516],"[",["T_VARIABLE","$pathToParent",516],"]","[","]",["T_WHITESPACE"," ",516],"=",["T_WHITESPACE"," ",516],["T_VARIABLE","$nodeInfo",516],";",["T_WHITESPACE","\n        ",516],"}",["T_WHITESPACE","\n        ",517],["T_VARIABLE","$this",518],["T_OBJECT_OPERATOR","->",518],["T_STRING","addChildNodes",518],"(",["T_VARIABLE","$childrenItems",518],",",["T_WHITESPACE"," ",518],["T_CONSTANT_ENCAPSED_STRING","''",518],",",["T_WHITESPACE"," ",518],["T_STRING","null",518],")",";",["T_WHITESPACE","\n        ",518],["T_RETURN","return",519],["T_WHITESPACE"," ",519],["T_VARIABLE","$this",519],";",["T_WHITESPACE","\n    ",519],"}",["T_WHITESPACE","\n\n    ",520],["T_DOC_COMMENT","\/**\n     * Load array of category parents\n     *\n     * @param string $path\n     * @param bool $addCollectionData\n     * @param bool $withRootNode\n     * @return array\n     *\/",522],["T_WHITESPACE","\n    ",529],["T_PUBLIC","public",530],["T_WHITESPACE"," ",530],["T_FUNCTION","function",530],["T_WHITESPACE"," ",530],["T_STRING","loadBreadcrumbsArray",530],"(",["T_VARIABLE","$path",530],",",["T_WHITESPACE"," ",530],["T_VARIABLE","$addCollectionData",530],["T_WHITESPACE"," ",530],"=",["T_WHITESPACE"," ",530],["T_STRING","true",530],",",["T_WHITESPACE"," ",530],["T_VARIABLE","$withRootNode",530],["T_WHITESPACE"," ",530],"=",["T_WHITESPACE"," ",530],["T_STRING","false",530],")",["T_WHITESPACE","\n    ",530],"{",["T_WHITESPACE","\n        ",531],["T_VARIABLE","$pathIds",532],["T_WHITESPACE"," ",532],"=",["T_WHITESPACE"," ",532],["T_STRING","explode",532],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",532],",",["T_WHITESPACE"," ",532],["T_VARIABLE","$path",532],")",";",["T_WHITESPACE","\n        ",532],["T_IF","if",533],["T_WHITESPACE"," ",533],"(","!",["T_VARIABLE","$withRootNode",533],")",["T_WHITESPACE"," ",533],"{",["T_WHITESPACE","\n            ",533],["T_STRING","array_shift",534],"(",["T_VARIABLE","$pathIds",534],")",";",["T_WHITESPACE","\n        ",534],"}",["T_WHITESPACE","\n        ",535],["T_VARIABLE","$result",536],["T_WHITESPACE"," ",536],"=",["T_WHITESPACE"," ",536],"[","]",";",["T_WHITESPACE","\n        ",536],["T_IF","if",537],["T_WHITESPACE"," ",537],"(","!",["T_EMPTY","empty",537],"(",["T_VARIABLE","$pathIds",537],")",")",["T_WHITESPACE"," ",537],"{",["T_WHITESPACE","\n            ",537],["T_IF","if",538],["T_WHITESPACE"," ",538],"(",["T_VARIABLE","$addCollectionData",538],")",["T_WHITESPACE"," ",538],"{",["T_WHITESPACE","\n                ",538],["T_VARIABLE","$select",539],["T_WHITESPACE"," ",539],"=",["T_WHITESPACE"," ",539],["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","_createCollectionDataSelect",539],"(",["T_STRING","false",539],")",";",["T_WHITESPACE","\n            ",539],"}",["T_WHITESPACE"," ",540],["T_ELSE","else",540],["T_WHITESPACE"," ",540],"{",["T_WHITESPACE","\n                ",540],["T_VARIABLE","$select",541],["T_WHITESPACE"," ",541],"=",["T_WHITESPACE"," ",541],["T_CLONE","clone",541],["T_WHITESPACE"," ",541],["T_VARIABLE","$this",541],["T_OBJECT_OPERATOR","->",541],["T_STRING","_select",541],";",["T_WHITESPACE","\n            ",541],"}",["T_WHITESPACE","\n            ",542],["T_VARIABLE","$select",543],["T_OBJECT_OPERATOR","->",543],["T_STRING","where",543],"(",["T_WHITESPACE","\n                ",543],["T_CONSTANT_ENCAPSED_STRING","'e.entity_id IN(?)'",544],",",["T_WHITESPACE","\n                ",544],["T_VARIABLE","$pathIds",545],["T_WHITESPACE","\n            ",545],")",["T_OBJECT_OPERATOR","->",546],["T_STRING","order",546],"(",["T_WHITESPACE","\n                ",546],["T_VARIABLE","$this",547],["T_OBJECT_OPERATOR","->",547],["T_STRING","_conn",547],["T_OBJECT_OPERATOR","->",547],["T_STRING","getLengthSql",547],"(",["T_CONSTANT_ENCAPSED_STRING","'e.path'",547],")",["T_WHITESPACE"," ",547],".",["T_WHITESPACE"," ",547],["T_CONSTANT_ENCAPSED_STRING","' '",547],["T_WHITESPACE"," ",547],".",["T_WHITESPACE"," ",547],["T_NS_SEPARATOR","\\",547],["T_STRING","Magento",547],["T_NS_SEPARATOR","\\",547],["T_STRING","Framework",547],["T_NS_SEPARATOR","\\",547],["T_STRING","DB",547],["T_NS_SEPARATOR","\\",547],["T_STRING","Select",547],["T_DOUBLE_COLON","::",547],["T_STRING","SQL_ASC",547],["T_WHITESPACE","\n            ",547],")",";",["T_WHITESPACE","\n            ",548],["T_VARIABLE","$result",549],["T_WHITESPACE"," ",549],"=",["T_WHITESPACE"," ",549],["T_VARIABLE","$this",549],["T_OBJECT_OPERATOR","->",549],["T_STRING","_conn",549],["T_OBJECT_OPERATOR","->",549],["T_STRING","fetchAll",549],"(",["T_VARIABLE","$select",549],")",";",["T_WHITESPACE","\n            ",549],["T_VARIABLE","$this",550],["T_OBJECT_OPERATOR","->",550],["T_STRING","_updateAnchorProductCount",550],"(",["T_VARIABLE","$result",550],")",";",["T_WHITESPACE","\n        ",550],"}",["T_WHITESPACE","\n        ",551],["T_RETURN","return",552],["T_WHITESPACE"," ",552],["T_VARIABLE","$result",552],";",["T_WHITESPACE","\n    ",552],"}",["T_WHITESPACE","\n\n    ",553],["T_DOC_COMMENT","\/**\n     * Replace products count with self products count, if category is non-anchor\n     *\n     * @param array &$data\n     * @return void\n     *\/",555],["T_WHITESPACE","\n    ",560],["T_PROTECTED","protected",561],["T_WHITESPACE"," ",561],["T_FUNCTION","function",561],["T_WHITESPACE"," ",561],["T_STRING","_updateAnchorProductCount",561],"(","&",["T_VARIABLE","$data",561],")",["T_WHITESPACE","\n    ",561],"{",["T_WHITESPACE","\n        ",562],["T_FOREACH","foreach",563],["T_WHITESPACE"," ",563],"(",["T_VARIABLE","$data",563],["T_WHITESPACE"," ",563],["T_AS","as",563],["T_WHITESPACE"," ",563],["T_VARIABLE","$key",563],["T_WHITESPACE"," ",563],["T_DOUBLE_ARROW","=>",563],["T_WHITESPACE"," ",563],["T_VARIABLE","$row",563],")",["T_WHITESPACE"," ",563],"{",["T_WHITESPACE","\n            ",563],["T_IF","if",564],["T_WHITESPACE"," ",564],"(",["T_LNUMBER","0",564],["T_WHITESPACE"," ",564],["T_IS_IDENTICAL","===",564],["T_WHITESPACE"," ",564],["T_INT_CAST","(int)",564],["T_VARIABLE","$row",564],"[",["T_CONSTANT_ENCAPSED_STRING","'is_anchor'",564],"]",")",["T_WHITESPACE"," ",564],"{",["T_WHITESPACE","\n                ",564],["T_VARIABLE","$data",565],"[",["T_VARIABLE","$key",565],"]","[",["T_CONSTANT_ENCAPSED_STRING","'product_count'",565],"]",["T_WHITESPACE"," ",565],"=",["T_WHITESPACE"," ",565],["T_VARIABLE","$row",565],"[",["T_CONSTANT_ENCAPSED_STRING","'self_product_count'",565],"]",";",["T_WHITESPACE","\n            ",565],"}",["T_WHITESPACE","\n        ",566],"}",["T_WHITESPACE","\n    ",567],"}",["T_WHITESPACE","\n\n    ",568],["T_DOC_COMMENT","\/**\n     * Obtain select for categories with attributes.\n     * By default everything from entity table is selected\n     * + name, is_active and is_anchor\n     * Also the correct product_count is selected, depending on is the category anchor or not.\n     *\n     * @param bool $sorted\n     * @param array $optionalAttributes\n     * @return \\Magento\\Framework\\DB\\Select\n     *\/",570],["T_WHITESPACE","\n    ",579],["T_PROTECTED","protected",580],["T_WHITESPACE"," ",580],["T_FUNCTION","function",580],["T_WHITESPACE"," ",580],["T_STRING","_createCollectionDataSelect",580],"(",["T_VARIABLE","$sorted",580],["T_WHITESPACE"," ",580],"=",["T_WHITESPACE"," ",580],["T_STRING","true",580],",",["T_WHITESPACE"," ",580],["T_VARIABLE","$optionalAttributes",580],["T_WHITESPACE"," ",580],"=",["T_WHITESPACE"," ",580],"[","]",")",["T_WHITESPACE","\n    ",580],"{",["T_WHITESPACE","\n        ",581],["T_VARIABLE","$meta",582],["T_WHITESPACE"," ",582],"=",["T_WHITESPACE"," ",582],["T_VARIABLE","$this",582],["T_OBJECT_OPERATOR","->",582],["T_STRING","getMetadataPool",582],"(",")",["T_OBJECT_OPERATOR","->",582],["T_STRING","getMetadata",582],"(",["T_STRING","CategoryInterface",582],["T_DOUBLE_COLON","::",582],["T_CLASS","class",582],")",";",["T_WHITESPACE","\n        ",582],["T_VARIABLE","$linkField",583],["T_WHITESPACE"," ",583],"=",["T_WHITESPACE"," ",583],["T_VARIABLE","$meta",583],["T_OBJECT_OPERATOR","->",583],["T_STRING","getLinkField",583],"(",")",";",["T_WHITESPACE","\n\n        ",583],["T_VARIABLE","$select",585],["T_WHITESPACE"," ",585],"=",["T_WHITESPACE"," ",585],["T_VARIABLE","$this",585],["T_OBJECT_OPERATOR","->",585],["T_STRING","_getDefaultCollection",585],"(",["T_VARIABLE","$sorted",585],["T_WHITESPACE"," ",585],"?",["T_WHITESPACE"," ",585],["T_VARIABLE","$this",585],["T_OBJECT_OPERATOR","->",585],["T_STRING","_orderField",585],["T_WHITESPACE"," ",585],":",["T_WHITESPACE"," ",585],["T_STRING","false",585],")",["T_OBJECT_OPERATOR","->",585],["T_STRING","getSelect",585],"(",")",";",["T_WHITESPACE","\n        ",585],["T_COMMENT","\/\/ add attributes to select\n",586],["T_WHITESPACE","        ",587],["T_VARIABLE","$attributes",587],["T_WHITESPACE"," ",587],"=",["T_WHITESPACE"," ",587],"[",["T_CONSTANT_ENCAPSED_STRING","'name'",587],",",["T_WHITESPACE"," ",587],["T_CONSTANT_ENCAPSED_STRING","'is_active'",587],",",["T_WHITESPACE"," ",587],["T_CONSTANT_ENCAPSED_STRING","'is_anchor'",587],"]",";",["T_WHITESPACE","\n        ",587],["T_IF","if",588],["T_WHITESPACE"," ",588],"(",["T_VARIABLE","$optionalAttributes",588],")",["T_WHITESPACE"," ",588],"{",["T_WHITESPACE","\n            ",588],["T_VARIABLE","$attributes",589],["T_WHITESPACE"," ",589],"=",["T_WHITESPACE"," ",589],["T_STRING","array_unique",589],"(",["T_STRING","array_merge",589],"(",["T_VARIABLE","$attributes",589],",",["T_WHITESPACE"," ",589],["T_VARIABLE","$optionalAttributes",589],")",")",";",["T_WHITESPACE","\n        ",589],"}",["T_WHITESPACE","\n        ",590],["T_VARIABLE","$resource",591],["T_WHITESPACE"," ",591],"=",["T_WHITESPACE"," ",591],["T_VARIABLE","$this",591],["T_OBJECT_OPERATOR","->",591],["T_STRING","_catalogCategory",591],";",["T_WHITESPACE","\n        ",591],["T_FOREACH","foreach",592],["T_WHITESPACE"," ",592],"(",["T_VARIABLE","$attributes",592],["T_WHITESPACE"," ",592],["T_AS","as",592],["T_WHITESPACE"," ",592],["T_VARIABLE","$attributeCode",592],")",["T_WHITESPACE"," ",592],"{",["T_WHITESPACE","\n            ",592],["T_COMMENT","\/* @var $attribute \\Magento\\Eav\\Model\\Entity\\Attribute *\/",593],["T_WHITESPACE","\n            ",593],["T_VARIABLE","$attribute",594],["T_WHITESPACE"," ",594],"=",["T_WHITESPACE"," ",594],["T_VARIABLE","$resource",594],["T_OBJECT_OPERATOR","->",594],["T_STRING","getAttribute",594],"(",["T_VARIABLE","$attributeCode",594],")",";",["T_WHITESPACE","\n            ",594],["T_COMMENT","\/\/ join non-static attribute table\n",595],["T_WHITESPACE","            ",596],["T_IF","if",596],["T_WHITESPACE"," ",596],"(","!",["T_VARIABLE","$attribute",596],["T_OBJECT_OPERATOR","->",596],["T_STRING","getBackend",596],"(",")",["T_OBJECT_OPERATOR","->",596],["T_STRING","isStatic",596],"(",")",")",["T_WHITESPACE"," ",596],"{",["T_WHITESPACE","\n                ",596],["T_VARIABLE","$tableDefault",597],["T_WHITESPACE"," ",597],"=",["T_WHITESPACE"," ",597],["T_STRING","sprintf",597],"(",["T_CONSTANT_ENCAPSED_STRING","'d_%s'",597],",",["T_WHITESPACE"," ",597],["T_VARIABLE","$attributeCode",597],")",";",["T_WHITESPACE","\n                ",597],["T_VARIABLE","$tableStore",598],["T_WHITESPACE"," ",598],"=",["T_WHITESPACE"," ",598],["T_STRING","sprintf",598],"(",["T_CONSTANT_ENCAPSED_STRING","'s_%s'",598],",",["T_WHITESPACE"," ",598],["T_VARIABLE","$attributeCode",598],")",";",["T_WHITESPACE","\n                ",598],["T_VARIABLE","$valueExpr",599],["T_WHITESPACE"," ",599],"=",["T_WHITESPACE"," ",599],["T_VARIABLE","$this",599],["T_OBJECT_OPERATOR","->",599],["T_STRING","_conn",599],["T_OBJECT_OPERATOR","->",599],["T_STRING","getCheckSql",599],"(",["T_WHITESPACE","\n                    ",599],"\"",["T_CURLY_OPEN","{",600],["T_VARIABLE","$tableStore",600],"}",["T_ENCAPSED_AND_WHITESPACE",".value_id > 0",600],"\"",",",["T_WHITESPACE","\n                    ",600],"\"",["T_CURLY_OPEN","{",601],["T_VARIABLE","$tableStore",601],"}",["T_ENCAPSED_AND_WHITESPACE",".value",601],"\"",",",["T_WHITESPACE","\n                    ",601],"\"",["T_CURLY_OPEN","{",602],["T_VARIABLE","$tableDefault",602],"}",["T_ENCAPSED_AND_WHITESPACE",".value",602],"\"",["T_WHITESPACE","\n                ",602],")",";",["T_WHITESPACE","\n\n                ",603],["T_VARIABLE","$select",605],["T_OBJECT_OPERATOR","->",605],["T_STRING","joinLeft",605],"(",["T_WHITESPACE","\n                    ",605],"[",["T_VARIABLE","$tableDefault",606],["T_WHITESPACE"," ",606],["T_DOUBLE_ARROW","=>",606],["T_WHITESPACE"," ",606],["T_VARIABLE","$attribute",606],["T_OBJECT_OPERATOR","->",606],["T_STRING","getBackend",606],"(",")",["T_OBJECT_OPERATOR","->",606],["T_STRING","getTable",606],"(",")","]",",",["T_WHITESPACE","\n                    ",606],["T_STRING","sprintf",607],"(",["T_WHITESPACE","\n                        ",607],["T_CONSTANT_ENCAPSED_STRING","'%1$s.'",608],["T_WHITESPACE"," ",608],".",["T_WHITESPACE"," ",608],["T_VARIABLE","$linkField",608],["T_WHITESPACE"," ",608],".",["T_WHITESPACE"," ",608],["T_CONSTANT_ENCAPSED_STRING","'=e.'",608],["T_WHITESPACE"," ",608],".",["T_WHITESPACE"," ",608],["T_VARIABLE","$linkField",608],["T_WHITESPACE"," ",608],".",["T_WHITESPACE","\n                        ",608],["T_CONSTANT_ENCAPSED_STRING","' AND %1$s.attribute_id=%2$d AND %1$s.store_id=%3$d'",609],",",["T_WHITESPACE","\n                        ",609],["T_VARIABLE","$tableDefault",610],",",["T_WHITESPACE","\n                        ",610],["T_VARIABLE","$attribute",611],["T_OBJECT_OPERATOR","->",611],["T_STRING","getId",611],"(",")",",",["T_WHITESPACE","\n                        ",611],["T_NS_SEPARATOR","\\",612],["T_STRING","Magento",612],["T_NS_SEPARATOR","\\",612],["T_STRING","Store",612],["T_NS_SEPARATOR","\\",612],["T_STRING","Model",612],["T_NS_SEPARATOR","\\",612],["T_STRING","Store",612],["T_DOUBLE_COLON","::",612],["T_STRING","DEFAULT_STORE_ID",612],["T_WHITESPACE","\n                    ",612],")",",",["T_WHITESPACE","\n                    ",613],"[",["T_VARIABLE","$attributeCode",614],["T_WHITESPACE"," ",614],["T_DOUBLE_ARROW","=>",614],["T_WHITESPACE"," ",614],["T_CONSTANT_ENCAPSED_STRING","'value'",614],"]",["T_WHITESPACE","\n                ",614],")",["T_OBJECT_OPERATOR","->",615],["T_STRING","joinLeft",615],"(",["T_WHITESPACE","\n                    ",615],"[",["T_VARIABLE","$tableStore",616],["T_WHITESPACE"," ",616],["T_DOUBLE_ARROW","=>",616],["T_WHITESPACE"," ",616],["T_VARIABLE","$attribute",616],["T_OBJECT_OPERATOR","->",616],["T_STRING","getBackend",616],"(",")",["T_OBJECT_OPERATOR","->",616],["T_STRING","getTable",616],"(",")","]",",",["T_WHITESPACE","\n                    ",616],["T_STRING","sprintf",617],"(",["T_WHITESPACE","\n                        ",617],["T_CONSTANT_ENCAPSED_STRING","'%1$s.'",618],["T_WHITESPACE"," ",618],".",["T_WHITESPACE"," ",618],["T_VARIABLE","$linkField",618],["T_WHITESPACE"," ",618],".",["T_WHITESPACE"," ",618],["T_CONSTANT_ENCAPSED_STRING","'=e.'",618],["T_WHITESPACE"," ",618],".",["T_WHITESPACE"," ",618],["T_VARIABLE","$linkField",618],["T_WHITESPACE"," ",618],".",["T_WHITESPACE","\n                        ",618],["T_CONSTANT_ENCAPSED_STRING","' AND %1$s.attribute_id=%2$d AND %1$s.store_id=%3$d'",619],",",["T_WHITESPACE","\n                        ",619],["T_VARIABLE","$tableStore",620],",",["T_WHITESPACE","\n                        ",620],["T_VARIABLE","$attribute",621],["T_OBJECT_OPERATOR","->",621],["T_STRING","getId",621],"(",")",",",["T_WHITESPACE","\n                        ",621],["T_VARIABLE","$this",622],["T_OBJECT_OPERATOR","->",622],["T_STRING","getStoreId",622],"(",")",["T_WHITESPACE","\n                    ",622],")",",",["T_WHITESPACE","\n                    ",623],"[",["T_VARIABLE","$attributeCode",624],["T_WHITESPACE"," ",624],["T_DOUBLE_ARROW","=>",624],["T_WHITESPACE"," ",624],["T_VARIABLE","$valueExpr",624],"]",["T_WHITESPACE","\n                ",624],")",";",["T_WHITESPACE","\n            ",625],"}",["T_WHITESPACE","\n        ",626],"}",["T_WHITESPACE","\n\n        ",627],["T_COMMENT","\/\/ count children products qty plus self products qty\n",629],["T_WHITESPACE","        ",630],["T_VARIABLE","$categoriesTable",630],["T_WHITESPACE"," ",630],"=",["T_WHITESPACE"," ",630],["T_VARIABLE","$this",630],["T_OBJECT_OPERATOR","->",630],["T_STRING","_coreResource",630],["T_OBJECT_OPERATOR","->",630],["T_STRING","getTableName",630],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_entity'",630],")",";",["T_WHITESPACE","\n        ",630],["T_VARIABLE","$categoriesProductsTable",631],["T_WHITESPACE"," ",631],"=",["T_WHITESPACE"," ",631],["T_VARIABLE","$this",631],["T_OBJECT_OPERATOR","->",631],["T_STRING","_coreResource",631],["T_OBJECT_OPERATOR","->",631],["T_STRING","getTableName",631],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_category_product'",631],")",";",["T_WHITESPACE","\n\n        ",631],["T_VARIABLE","$subConcat",633],["T_WHITESPACE"," ",633],"=",["T_WHITESPACE"," ",633],["T_VARIABLE","$this",633],["T_OBJECT_OPERATOR","->",633],["T_STRING","_conn",633],["T_OBJECT_OPERATOR","->",633],["T_STRING","getConcatSql",633],"(","[",["T_CONSTANT_ENCAPSED_STRING","'e.path'",633],",",["T_WHITESPACE"," ",633],["T_VARIABLE","$this",633],["T_OBJECT_OPERATOR","->",633],["T_STRING","_conn",633],["T_OBJECT_OPERATOR","->",633],["T_STRING","quote",633],"(",["T_CONSTANT_ENCAPSED_STRING","'\/%'",633],")","]",")",";",["T_WHITESPACE","\n        ",633],["T_VARIABLE","$subSelect",634],["T_WHITESPACE"," ",634],"=",["T_WHITESPACE"," ",634],["T_VARIABLE","$this",634],["T_OBJECT_OPERATOR","->",634],["T_STRING","_conn",634],["T_OBJECT_OPERATOR","->",634],["T_STRING","select",634],"(",")",["T_OBJECT_OPERATOR","->",634],["T_STRING","from",634],"(",["T_WHITESPACE","\n            ",634],"[",["T_CONSTANT_ENCAPSED_STRING","'see'",635],["T_WHITESPACE"," ",635],["T_DOUBLE_ARROW","=>",635],["T_WHITESPACE"," ",635],["T_VARIABLE","$categoriesTable",635],"]",",",["T_WHITESPACE","\n            ",635],["T_STRING","null",636],["T_WHITESPACE","\n        ",636],")",["T_OBJECT_OPERATOR","->",637],["T_STRING","joinLeft",637],"(",["T_WHITESPACE","\n            ",637],"[",["T_CONSTANT_ENCAPSED_STRING","'scp'",638],["T_WHITESPACE"," ",638],["T_DOUBLE_ARROW","=>",638],["T_WHITESPACE"," ",638],["T_VARIABLE","$categoriesProductsTable",638],"]",",",["T_WHITESPACE","\n            ",638],["T_CONSTANT_ENCAPSED_STRING","'see.entity_id=scp.category_id'",639],",",["T_WHITESPACE","\n            ",639],"[",["T_CONSTANT_ENCAPSED_STRING","'COUNT(DISTINCT scp.product_id)'",640],"]",["T_WHITESPACE","\n        ",640],")",["T_OBJECT_OPERATOR","->",641],["T_STRING","where",641],"(",["T_WHITESPACE","\n            ",641],["T_CONSTANT_ENCAPSED_STRING","'see.entity_id = e.entity_id'",642],["T_WHITESPACE","\n        ",642],")",["T_OBJECT_OPERATOR","->",643],["T_STRING","orWhere",643],"(",["T_WHITESPACE","\n            ",643],["T_CONSTANT_ENCAPSED_STRING","'see.path LIKE ?'",644],",",["T_WHITESPACE","\n            ",644],["T_VARIABLE","$subConcat",645],["T_WHITESPACE","\n        ",645],")",";",["T_WHITESPACE","\n        ",646],["T_VARIABLE","$select",647],["T_OBJECT_OPERATOR","->",647],["T_STRING","columns",647],"(","[",["T_CONSTANT_ENCAPSED_STRING","'product_count'",647],["T_WHITESPACE"," ",647],["T_DOUBLE_ARROW","=>",647],["T_WHITESPACE"," ",647],["T_VARIABLE","$subSelect",647],"]",")",";",["T_WHITESPACE","\n\n        ",647],["T_VARIABLE","$subSelect",649],["T_WHITESPACE"," ",649],"=",["T_WHITESPACE"," ",649],["T_VARIABLE","$this",649],["T_OBJECT_OPERATOR","->",649],["T_STRING","_conn",649],["T_OBJECT_OPERATOR","->",649],["T_STRING","select",649],"(",")",["T_OBJECT_OPERATOR","->",649],["T_STRING","from",649],"(",["T_WHITESPACE","\n            ",649],"[",["T_CONSTANT_ENCAPSED_STRING","'cp'",650],["T_WHITESPACE"," ",650],["T_DOUBLE_ARROW","=>",650],["T_WHITESPACE"," ",650],["T_VARIABLE","$categoriesProductsTable",650],"]",",",["T_WHITESPACE","\n            ",650],["T_CONSTANT_ENCAPSED_STRING","'COUNT(cp.product_id)'",651],["T_WHITESPACE","\n        ",651],")",["T_OBJECT_OPERATOR","->",652],["T_STRING","where",652],"(",["T_WHITESPACE","\n            ",652],["T_CONSTANT_ENCAPSED_STRING","'cp.category_id = e.entity_id'",653],["T_WHITESPACE","\n        ",653],")",";",["T_WHITESPACE","\n\n        ",654],["T_VARIABLE","$select",656],["T_OBJECT_OPERATOR","->",656],["T_STRING","columns",656],"(","[",["T_CONSTANT_ENCAPSED_STRING","'self_product_count'",656],["T_WHITESPACE"," ",656],["T_DOUBLE_ARROW","=>",656],["T_WHITESPACE"," ",656],["T_VARIABLE","$subSelect",656],"]",")",";",["T_WHITESPACE","\n\n        ",656],["T_RETURN","return",658],["T_WHITESPACE"," ",658],["T_VARIABLE","$select",658],";",["T_WHITESPACE","\n    ",658],"}",["T_WHITESPACE","\n\n    ",659],["T_DOC_COMMENT","\/**\n     * Get real existing category ids by specified ids\n     *\n     * @param array $ids\n     * @return array\n     *\/",661],["T_WHITESPACE","\n    ",666],["T_PUBLIC","public",667],["T_WHITESPACE"," ",667],["T_FUNCTION","function",667],["T_WHITESPACE"," ",667],["T_STRING","getExistingCategoryIdsBySpecifiedIds",667],"(",["T_VARIABLE","$ids",667],")",["T_WHITESPACE","\n    ",667],"{",["T_WHITESPACE","\n        ",668],["T_IF","if",669],["T_WHITESPACE"," ",669],"(",["T_EMPTY","empty",669],"(",["T_VARIABLE","$ids",669],")",")",["T_WHITESPACE"," ",669],"{",["T_WHITESPACE","\n            ",669],["T_RETURN","return",670],["T_WHITESPACE"," ",670],"[","]",";",["T_WHITESPACE","\n        ",670],"}",["T_WHITESPACE","\n        ",671],["T_IF","if",672],["T_WHITESPACE"," ",672],"(","!",["T_STRING","is_array",672],"(",["T_VARIABLE","$ids",672],")",")",["T_WHITESPACE"," ",672],"{",["T_WHITESPACE","\n            ",672],["T_VARIABLE","$ids",673],["T_WHITESPACE"," ",673],"=",["T_WHITESPACE"," ",673],"[",["T_VARIABLE","$ids",673],"]",";",["T_WHITESPACE","\n        ",673],"}",["T_WHITESPACE","\n        ",674],["T_VARIABLE","$select",675],["T_WHITESPACE"," ",675],"=",["T_WHITESPACE"," ",675],["T_VARIABLE","$this",675],["T_OBJECT_OPERATOR","->",675],["T_STRING","_conn",675],["T_OBJECT_OPERATOR","->",675],["T_STRING","select",675],"(",")",["T_OBJECT_OPERATOR","->",675],["T_STRING","from",675],"(",["T_VARIABLE","$this",675],["T_OBJECT_OPERATOR","->",675],["T_STRING","_table",675],",",["T_WHITESPACE"," ",675],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",675],"]",")",["T_OBJECT_OPERATOR","->",675],["T_STRING","where",675],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id IN (?)'",675],",",["T_WHITESPACE"," ",675],["T_VARIABLE","$ids",675],")",";",["T_WHITESPACE","\n        ",675],["T_RETURN","return",676],["T_WHITESPACE"," ",676],["T_VARIABLE","$this",676],["T_OBJECT_OPERATOR","->",676],["T_STRING","_conn",676],["T_OBJECT_OPERATOR","->",676],["T_STRING","fetchCol",676],"(",["T_VARIABLE","$select",676],")",";",["T_WHITESPACE","\n    ",676],"}",["T_WHITESPACE","\n\n    ",677],["T_DOC_COMMENT","\/**\n     * @return \\Magento\\Framework\\EntityManager\\MetadataPool\n     *\/",679],["T_WHITESPACE","\n    ",681],["T_PRIVATE","private",682],["T_WHITESPACE"," ",682],["T_FUNCTION","function",682],["T_WHITESPACE"," ",682],["T_STRING","getMetadataPool",682],"(",")",["T_WHITESPACE","\n    ",682],"{",["T_WHITESPACE","\n        ",683],["T_IF","if",684],["T_WHITESPACE"," ",684],"(",["T_STRING","null",684],["T_WHITESPACE"," ",684],["T_IS_IDENTICAL","===",684],["T_WHITESPACE"," ",684],["T_VARIABLE","$this",684],["T_OBJECT_OPERATOR","->",684],["T_STRING","metadataPool",684],")",["T_WHITESPACE"," ",684],"{",["T_WHITESPACE","\n            ",684],["T_VARIABLE","$this",685],["T_OBJECT_OPERATOR","->",685],["T_STRING","metadataPool",685],["T_WHITESPACE"," ",685],"=",["T_WHITESPACE"," ",685],["T_NS_SEPARATOR","\\",685],["T_STRING","Magento",685],["T_NS_SEPARATOR","\\",685],["T_STRING","Framework",685],["T_NS_SEPARATOR","\\",685],["T_STRING","App",685],["T_NS_SEPARATOR","\\",685],["T_STRING","ObjectManager",685],["T_DOUBLE_COLON","::",685],["T_STRING","getInstance",685],"(",")",["T_WHITESPACE","\n                ",685],["T_OBJECT_OPERATOR","->",686],["T_STRING","get",686],"(",["T_NS_SEPARATOR","\\",686],["T_STRING","Magento",686],["T_NS_SEPARATOR","\\",686],["T_STRING","Framework",686],["T_NS_SEPARATOR","\\",686],["T_STRING","EntityManager",686],["T_NS_SEPARATOR","\\",686],["T_STRING","MetadataPool",686],["T_DOUBLE_COLON","::",686],["T_CLASS","class",686],")",";",["T_WHITESPACE","\n        ",686],"}",["T_WHITESPACE","\n        ",687],["T_RETURN","return",688],["T_WHITESPACE"," ",688],["T_VARIABLE","$this",688],["T_OBJECT_OPERATOR","->",688],["T_STRING","metadataPool",688],";",["T_WHITESPACE","\n    ",688],"}",["T_WHITESPACE","\n",689],"}",["T_WHITESPACE","\n",690]]