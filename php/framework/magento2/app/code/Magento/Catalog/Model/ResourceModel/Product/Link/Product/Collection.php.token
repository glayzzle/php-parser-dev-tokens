[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Catalog",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","ResourceModel",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Product",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Link",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Product",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Catalog product linked products collection\n *\n * @author      Magento Core Team <core@magentocommerce.com>\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",8],["T_WHITESPACE","\n",13],["T_CLASS","class",14],["T_WHITESPACE"," ",14],["T_STRING","Collection",14],["T_WHITESPACE"," ",14],["T_EXTENDS","extends",14],["T_WHITESPACE"," ",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Catalog",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Model",14],["T_NS_SEPARATOR","\\",14],["T_STRING","ResourceModel",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Product",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Collection",14],["T_WHITESPACE","\n",14],"{",["T_WHITESPACE","\n    ",15],["T_DOC_COMMENT","\/**\n     * Store product model\n     *\n     * @var \\Magento\\Catalog\\Model\\Product\n     *\/",16],["T_WHITESPACE","\n    ",20],["T_PROTECTED","protected",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$_product",21],";",["T_WHITESPACE","\n\n    ",21],["T_DOC_COMMENT","\/**\n     * Store product link model\n     *\n     * @var \\Magento\\Catalog\\Model\\Product\\Link\n     *\/",23],["T_WHITESPACE","\n    ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$_linkModel",28],";",["T_WHITESPACE","\n\n    ",28],["T_DOC_COMMENT","\/**\n     * Store link type id\n     *\n     * @var int\n     *\/",30],["T_WHITESPACE","\n    ",34],["T_PROTECTED","protected",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$_linkTypeId",35],";",["T_WHITESPACE","\n\n    ",35],["T_DOC_COMMENT","\/**\n     * Store strong mode flag that determine if needed for inner join or left join of linked products\n     *\n     * @var bool\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_isStrongMode",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Store flag that determine if product filter was enabled\n     *\n     * @var bool\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_hasLinkFilter",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_STRING","false",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Declare link model and initialize type attributes join\n     *\n     * @param \\Magento\\Catalog\\Model\\Product\\Link $linkModel\n     * @return $this\n     *\/",51],["T_WHITESPACE","\n    ",56],["T_PUBLIC","public",57],["T_WHITESPACE"," ",57],["T_FUNCTION","function",57],["T_WHITESPACE"," ",57],["T_STRING","setLinkModel",57],"(",["T_NS_SEPARATOR","\\",57],["T_STRING","Magento",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Catalog",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Model",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Product",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Link",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$linkModel",57],")",["T_WHITESPACE","\n    ",57],"{",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","_linkModel",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$linkModel",59],";",["T_WHITESPACE","\n        ",59],["T_IF","if",60],["T_WHITESPACE"," ",60],"(",["T_VARIABLE","$linkModel",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","getLinkTypeId",60],"(",")",")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n            ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","_linkTypeId",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_VARIABLE","$linkModel",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","getLinkTypeId",61],"(",")",";",["T_WHITESPACE","\n        ",61],"}",["T_WHITESPACE","\n        ",62],["T_RETURN","return",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$this",63],";",["T_WHITESPACE","\n    ",63],"}",["T_WHITESPACE","\n\n    ",64],["T_DOC_COMMENT","\/**\n     * Enable strong mode for inner join of linked products\n     *\n     * @return $this\n     *\/",66],["T_WHITESPACE","\n    ",70],["T_PUBLIC","public",71],["T_WHITESPACE"," ",71],["T_FUNCTION","function",71],["T_WHITESPACE"," ",71],["T_STRING","setIsStrongMode",71],"(",")",["T_WHITESPACE","\n    ",71],"{",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","_isStrongMode",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_STRING","true",73],";",["T_WHITESPACE","\n        ",73],["T_RETURN","return",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$this",74],";",["T_WHITESPACE","\n    ",74],"}",["T_WHITESPACE","\n\n    ",75],["T_DOC_COMMENT","\/**\n     * Retrieve collection link model\n     *\n     * @return \\Magento\\Catalog\\Model\\Product\\Link\n     *\/",77],["T_WHITESPACE","\n    ",81],["T_PUBLIC","public",82],["T_WHITESPACE"," ",82],["T_FUNCTION","function",82],["T_WHITESPACE"," ",82],["T_STRING","getLinkModel",82],"(",")",["T_WHITESPACE","\n    ",82],"{",["T_WHITESPACE","\n        ",83],["T_RETURN","return",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","_linkModel",84],";",["T_WHITESPACE","\n    ",84],"}",["T_WHITESPACE","\n\n    ",85],["T_DOC_COMMENT","\/**\n     * Initialize collection parent product and add limitation join\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return $this\n     *\/",87],["T_WHITESPACE","\n    ",92],["T_PUBLIC","public",93],["T_WHITESPACE"," ",93],["T_FUNCTION","function",93],["T_WHITESPACE"," ",93],["T_STRING","setProduct",93],"(",["T_NS_SEPARATOR","\\",93],["T_STRING","Magento",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Catalog",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Model",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Product",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$product",93],")",["T_WHITESPACE","\n    ",93],"{",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","_product",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$product",95],";",["T_WHITESPACE","\n        ",95],["T_IF","if",96],["T_WHITESPACE"," ",96],"(",["T_VARIABLE","$product",96],["T_WHITESPACE"," ",96],["T_BOOLEAN_AND","&&",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$product",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getId",96],"(",")",")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n            ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","_hasLinkFilter",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_STRING","true",97],";",["T_WHITESPACE","\n            ",97],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","setStore",98],"(",["T_VARIABLE","$product",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getStore",98],"(",")",")",";",["T_WHITESPACE","\n        ",98],"}",["T_WHITESPACE","\n        ",99],["T_RETURN","return",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],";",["T_WHITESPACE","\n    ",100],"}",["T_WHITESPACE","\n\n    ",101],["T_DOC_COMMENT","\/**\n     * Retrieve collection base product object\n     *\n     * @return \\Magento\\Catalog\\Model\\Product\n     *\/",103],["T_WHITESPACE","\n    ",107],["T_PUBLIC","public",108],["T_WHITESPACE"," ",108],["T_FUNCTION","function",108],["T_WHITESPACE"," ",108],["T_STRING","getProduct",108],"(",")",["T_WHITESPACE","\n    ",108],"{",["T_WHITESPACE","\n        ",109],["T_RETURN","return",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","_product",110],";",["T_WHITESPACE","\n    ",110],"}",["T_WHITESPACE","\n\n    ",111],["T_DOC_COMMENT","\/**\n     * Exclude products from filter\n     *\n     * @param array $products\n     * @return $this\n     *\/",113],["T_WHITESPACE","\n    ",118],["T_PUBLIC","public",119],["T_WHITESPACE"," ",119],["T_FUNCTION","function",119],["T_WHITESPACE"," ",119],["T_STRING","addExcludeProductFilter",119],"(",["T_VARIABLE","$products",119],")",["T_WHITESPACE","\n    ",119],"{",["T_WHITESPACE","\n        ",120],["T_IF","if",121],["T_WHITESPACE"," ",121],"(","!",["T_EMPTY","empty",121],"(",["T_VARIABLE","$products",121],")",")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n            ",121],["T_IF","if",122],["T_WHITESPACE"," ",122],"(","!",["T_STRING","is_array",122],"(",["T_VARIABLE","$products",122],")",")",["T_WHITESPACE"," ",122],"{",["T_WHITESPACE","\n                ",122],["T_VARIABLE","$products",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],"[",["T_VARIABLE","$products",123],"]",";",["T_WHITESPACE","\n            ",123],"}",["T_WHITESPACE","\n            ",124],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","_hasLinkFilter",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_STRING","true",125],";",["T_WHITESPACE","\n            ",125],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getSelect",126],"(",")",["T_OBJECT_OPERATOR","->",126],["T_STRING","where",126],"(",["T_CONSTANT_ENCAPSED_STRING","'links.linked_product_id NOT IN (?)'",126],",",["T_WHITESPACE"," ",126],["T_VARIABLE","$products",126],")",";",["T_WHITESPACE","\n        ",126],"}",["T_WHITESPACE","\n        ",127],["T_RETURN","return",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$this",128],";",["T_WHITESPACE","\n    ",128],"}",["T_WHITESPACE","\n\n    ",129],["T_DOC_COMMENT","\/**\n     * Add products to filter\n     *\n     * @param array|int|string $products\n     * @return $this\n     *\/",131],["T_WHITESPACE","\n    ",136],["T_PUBLIC","public",137],["T_WHITESPACE"," ",137],["T_FUNCTION","function",137],["T_WHITESPACE"," ",137],["T_STRING","addProductFilter",137],"(",["T_VARIABLE","$products",137],")",["T_WHITESPACE","\n    ",137],"{",["T_WHITESPACE","\n        ",138],["T_IF","if",139],["T_WHITESPACE"," ",139],"(","!",["T_EMPTY","empty",139],"(",["T_VARIABLE","$products",139],")",")",["T_WHITESPACE"," ",139],"{",["T_WHITESPACE","\n            ",139],["T_IF","if",140],["T_WHITESPACE"," ",140],"(","!",["T_STRING","is_array",140],"(",["T_VARIABLE","$products",140],")",")",["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n                ",140],["T_VARIABLE","$products",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],"[",["T_VARIABLE","$products",141],"]",";",["T_WHITESPACE","\n            ",141],"}",["T_WHITESPACE","\n            ",142],["T_VARIABLE","$identifierField",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getProductEntityMetadata",143],"(",")",["T_OBJECT_OPERATOR","->",143],["T_STRING","getIdentifierField",143],"(",")",";",["T_WHITESPACE","\n            ",143],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","getSelect",144],"(",")",["T_OBJECT_OPERATOR","->",144],["T_STRING","where",144],"(","\"",["T_ENCAPSED_AND_WHITESPACE","product_entity_table.",144],["T_VARIABLE","$identifierField",144],["T_ENCAPSED_AND_WHITESPACE"," IN (?)",144],"\"",",",["T_WHITESPACE"," ",144],["T_VARIABLE","$products",144],")",";",["T_WHITESPACE","\n            ",144],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","_hasLinkFilter",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_STRING","true",145],";",["T_WHITESPACE","\n        ",145],"}",["T_WHITESPACE","\n\n        ",146],["T_RETURN","return",148],["T_WHITESPACE"," ",148],["T_VARIABLE","$this",148],";",["T_WHITESPACE","\n    ",148],"}",["T_WHITESPACE","\n\n    ",149],["T_DOC_COMMENT","\/**\n     * Add random sorting order\n     *\n     * @return $this\n     *\/",151],["T_WHITESPACE","\n    ",155],["T_PUBLIC","public",156],["T_WHITESPACE"," ",156],["T_FUNCTION","function",156],["T_WHITESPACE"," ",156],["T_STRING","setRandomOrder",156],"(",")",["T_WHITESPACE","\n    ",156],"{",["T_WHITESPACE","\n        ",157],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","getSelect",158],"(",")",["T_OBJECT_OPERATOR","->",158],["T_STRING","orderRand",158],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.entity_id'",158],")",";",["T_WHITESPACE","\n        ",158],["T_RETURN","return",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],";",["T_WHITESPACE","\n    ",159],"}",["T_WHITESPACE","\n\n    ",160],["T_DOC_COMMENT","\/**\n     * Setting group by to exclude duplications in collection\n     *\n     * @param string $groupBy\n     * @return $this\n     *\/",162],["T_WHITESPACE","\n    ",167],["T_PUBLIC","public",168],["T_WHITESPACE"," ",168],["T_FUNCTION","function",168],["T_WHITESPACE"," ",168],["T_STRING","setGroupBy",168],"(",["T_VARIABLE","$groupBy",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_CONSTANT_ENCAPSED_STRING","'e.entity_id'",168],")",["T_WHITESPACE","\n    ",168],"{",["T_WHITESPACE","\n        ",169],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","getSelect",170],"(",")",["T_OBJECT_OPERATOR","->",170],["T_STRING","group",170],"(",["T_VARIABLE","$groupBy",170],")",";",["T_WHITESPACE","\n        ",170],["T_RETURN","return",171],["T_WHITESPACE"," ",171],["T_VARIABLE","$this",171],";",["T_WHITESPACE","\n    ",171],"}",["T_WHITESPACE","\n\n    ",172],["T_DOC_COMMENT","\/**\n     * Join linked products when specified link model\n     *\n     * @return $this\n     *\/",174],["T_WHITESPACE","\n    ",178],["T_PROTECTED","protected",179],["T_WHITESPACE"," ",179],["T_FUNCTION","function",179],["T_WHITESPACE"," ",179],["T_STRING","_beforeLoad",179],"(",")",["T_WHITESPACE","\n    ",179],"{",["T_WHITESPACE","\n        ",180],["T_IF","if",181],["T_WHITESPACE"," ",181],"(",["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","getLinkModel",181],"(",")",")",["T_WHITESPACE"," ",181],"{",["T_WHITESPACE","\n            ",181],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","_joinLinks",182],"(",")",";",["T_WHITESPACE","\n            ",182],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","joinProductsToLinks",183],"(",")",";",["T_WHITESPACE","\n        ",183],"}",["T_WHITESPACE","\n        ",184],["T_RETURN","return",185],["T_WHITESPACE"," ",185],["T_STRING","parent",185],["T_DOUBLE_COLON","::",185],["T_STRING","_beforeLoad",185],"(",")",";",["T_WHITESPACE","\n    ",185],"}",["T_WHITESPACE","\n\n    ",186],["T_DOC_COMMENT","\/**\n     * Join linked products and their attributes\n     *\n     * @return $this\n     *\/",188],["T_WHITESPACE","\n    ",192],["T_PROTECTED","protected",193],["T_WHITESPACE"," ",193],["T_FUNCTION","function",193],["T_WHITESPACE"," ",193],["T_STRING","_joinLinks",193],"(",")",["T_WHITESPACE","\n    ",193],"{",["T_WHITESPACE","\n        ",194],["T_VARIABLE","$select",195],["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","getSelect",195],"(",")",";",["T_WHITESPACE","\n        ",195],["T_VARIABLE","$connection",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_VARIABLE","$select",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","getConnection",196],"(",")",";",["T_WHITESPACE","\n\n        ",196],["T_VARIABLE","$joinCondition",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],"[",["T_WHITESPACE","\n            ",198],["T_CONSTANT_ENCAPSED_STRING","'links.linked_product_id = e.entity_id'",199],",",["T_WHITESPACE","\n            ",199],["T_VARIABLE","$connection",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","quoteInto",200],"(",["T_CONSTANT_ENCAPSED_STRING","'links.link_type_id = ?'",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","_linkTypeId",200],")",",",["T_WHITESPACE","\n        ",200],"]",";",["T_WHITESPACE","\n        ",201],["T_VARIABLE","$joinType",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_CONSTANT_ENCAPSED_STRING","'join'",202],";",["T_WHITESPACE","\n        ",202],["T_VARIABLE","$linkField",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","getProductEntityMetadata",203],"(",")",["T_OBJECT_OPERATOR","->",203],["T_STRING","getLinkField",203],"(",")",";",["T_WHITESPACE","\n        ",203],["T_IF","if",204],["T_WHITESPACE"," ",204],"(",["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","getProduct",204],"(",")",["T_WHITESPACE"," ",204],["T_BOOLEAN_AND","&&",204],["T_WHITESPACE"," ",204],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","getProduct",204],"(",")",["T_OBJECT_OPERATOR","->",204],["T_STRING","getId",204],"(",")",")",["T_WHITESPACE"," ",204],"{",["T_WHITESPACE","\n            ",204],["T_VARIABLE","$linkFieldId",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","getProduct",205],"(",")",["T_OBJECT_OPERATOR","->",205],["T_STRING","getData",205],"(",["T_WHITESPACE","\n                ",205],["T_VARIABLE","$linkField",206],["T_WHITESPACE","\n            ",206],")",";",["T_WHITESPACE","\n            ",207],["T_IF","if",208],["T_WHITESPACE"," ",208],"(",["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","_isStrongMode",208],")",["T_WHITESPACE"," ",208],"{",["T_WHITESPACE","\n                ",208],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","getSelect",209],"(",")",["T_OBJECT_OPERATOR","->",209],["T_STRING","where",209],"(",["T_CONSTANT_ENCAPSED_STRING","'links.product_id = ?'",209],",",["T_WHITESPACE"," ",209],["T_INT_CAST","(int)",209],["T_VARIABLE","$linkFieldId",209],")",";",["T_WHITESPACE","\n            ",209],"}",["T_WHITESPACE"," ",210],["T_ELSE","else",210],["T_WHITESPACE"," ",210],"{",["T_WHITESPACE","\n                ",210],["T_VARIABLE","$joinType",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_CONSTANT_ENCAPSED_STRING","'joinLeft'",211],";",["T_WHITESPACE","\n                ",211],["T_VARIABLE","$joinCondition",212],"[","]",["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_VARIABLE","$connection",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","quoteInto",212],"(",["T_CONSTANT_ENCAPSED_STRING","'links.product_id = ?'",212],",",["T_WHITESPACE"," ",212],["T_VARIABLE","$linkFieldId",212],")",";",["T_WHITESPACE","\n            ",212],"}",["T_WHITESPACE","\n            ",213],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","addFieldToFilter",214],"(",["T_WHITESPACE","\n                ",214],["T_VARIABLE","$linkField",215],",",["T_WHITESPACE","\n                ",215],"[",["T_CONSTANT_ENCAPSED_STRING","'neq'",216],["T_WHITESPACE"," ",216],["T_DOUBLE_ARROW","=>",216],["T_WHITESPACE"," ",216],["T_VARIABLE","$linkFieldId",216],"]",["T_WHITESPACE","\n            ",216],")",";",["T_WHITESPACE","\n        ",217],"}",["T_WHITESPACE"," ",218],["T_ELSEIF","elseif",218],["T_WHITESPACE"," ",218],"(",["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","_isStrongMode",218],")",["T_WHITESPACE"," ",218],"{",["T_WHITESPACE","\n            ",218],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","addFieldToFilter",219],"(",["T_WHITESPACE","\n                ",219],["T_VARIABLE","$linkField",220],",",["T_WHITESPACE","\n                ",220],"[",["T_CONSTANT_ENCAPSED_STRING","'eq'",221],["T_WHITESPACE"," ",221],["T_DOUBLE_ARROW","=>",221],["T_WHITESPACE"," ",221],"-",["T_LNUMBER","1",221],"]",["T_WHITESPACE","\n            ",221],")",";",["T_WHITESPACE","\n        ",222],"}",["T_WHITESPACE","\n        ",223],["T_IF","if",224],["T_WHITESPACE"," ",224],"(",["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","_hasLinkFilter",224],")",["T_WHITESPACE"," ",224],"{",["T_WHITESPACE","\n            ",224],["T_VARIABLE","$select",225],["T_OBJECT_OPERATOR","->",225],"{",["T_VARIABLE","$joinType",225],"}","(",["T_WHITESPACE","\n                ",225],"[",["T_CONSTANT_ENCAPSED_STRING","'links'",226],["T_WHITESPACE"," ",226],["T_DOUBLE_ARROW","=>",226],["T_WHITESPACE"," ",226],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","getTable",226],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_link'",226],")","]",",",["T_WHITESPACE","\n                ",226],["T_STRING","implode",227],"(",["T_CONSTANT_ENCAPSED_STRING","' AND '",227],",",["T_WHITESPACE"," ",227],["T_VARIABLE","$joinCondition",227],")",",",["T_WHITESPACE","\n                ",227],"[",["T_CONSTANT_ENCAPSED_STRING","'link_id'",228],"]",["T_WHITESPACE","\n            ",228],")",";",["T_WHITESPACE","\n            ",229],["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","joinAttributes",230],"(",")",";",["T_WHITESPACE","\n        ",230],"}",["T_WHITESPACE","\n        ",231],["T_RETURN","return",232],["T_WHITESPACE"," ",232],["T_VARIABLE","$this",232],";",["T_WHITESPACE","\n    ",232],"}",["T_WHITESPACE","\n\n    ",233],["T_DOC_COMMENT","\/**\n     * Enable sorting products by its position\n     *\n     * @param string $dir sort type asc|desc\n     * @return $this\n     *\/",235],["T_WHITESPACE","\n    ",240],["T_PUBLIC","public",241],["T_WHITESPACE"," ",241],["T_FUNCTION","function",241],["T_WHITESPACE"," ",241],["T_STRING","setPositionOrder",241],"(",["T_VARIABLE","$dir",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_STRING","self",241],["T_DOUBLE_COLON","::",241],["T_STRING","SORT_ORDER_ASC",241],")",["T_WHITESPACE","\n    ",241],"{",["T_WHITESPACE","\n        ",242],["T_IF","if",243],["T_WHITESPACE"," ",243],"(",["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","_hasLinkFilter",243],")",["T_WHITESPACE"," ",243],"{",["T_WHITESPACE","\n            ",243],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","getSelect",244],"(",")",["T_OBJECT_OPERATOR","->",244],["T_STRING","order",244],"(",["T_CONSTANT_ENCAPSED_STRING","'position '",244],["T_WHITESPACE"," ",244],".",["T_WHITESPACE"," ",244],["T_VARIABLE","$dir",244],")",";",["T_WHITESPACE","\n        ",244],"}",["T_WHITESPACE","\n        ",245],["T_RETURN","return",246],["T_WHITESPACE"," ",246],["T_VARIABLE","$this",246],";",["T_WHITESPACE","\n    ",246],"}",["T_WHITESPACE","\n\n    ",247],["T_DOC_COMMENT","\/**\n     * Enable sorting products by its attribute set name\n     *\n     * @param string $dir sort type asc|desc\n     * @return $this\n     *\/",249],["T_WHITESPACE","\n    ",254],["T_PUBLIC","public",255],["T_WHITESPACE"," ",255],["T_FUNCTION","function",255],["T_WHITESPACE"," ",255],["T_STRING","setAttributeSetIdOrder",255],"(",["T_VARIABLE","$dir",255],["T_WHITESPACE"," ",255],"=",["T_WHITESPACE"," ",255],["T_STRING","self",255],["T_DOUBLE_COLON","::",255],["T_STRING","SORT_ORDER_ASC",255],")",["T_WHITESPACE","\n    ",255],"{",["T_WHITESPACE","\n        ",256],["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","getSelect",257],"(",")",["T_OBJECT_OPERATOR","->",257],["T_STRING","joinLeft",257],"(",["T_WHITESPACE","\n            ",257],"[",["T_CONSTANT_ENCAPSED_STRING","'set'",258],["T_WHITESPACE"," ",258],["T_DOUBLE_ARROW","=>",258],["T_WHITESPACE"," ",258],["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","getTable",258],"(",["T_CONSTANT_ENCAPSED_STRING","'eav_attribute_set'",258],")","]",",",["T_WHITESPACE","\n            ",258],["T_CONSTANT_ENCAPSED_STRING","'e.attribute_set_id = set.attribute_set_id'",259],",",["T_WHITESPACE","\n            ",259],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_set_name'",260],"]",["T_WHITESPACE","\n        ",260],")",["T_OBJECT_OPERATOR","->",261],["T_STRING","order",261],"(",["T_WHITESPACE","\n            ",261],["T_CONSTANT_ENCAPSED_STRING","'set.attribute_set_name '",262],["T_WHITESPACE"," ",262],".",["T_WHITESPACE"," ",262],["T_VARIABLE","$dir",262],["T_WHITESPACE","\n        ",262],")",";",["T_WHITESPACE","\n        ",263],["T_RETURN","return",264],["T_WHITESPACE"," ",264],["T_VARIABLE","$this",264],";",["T_WHITESPACE","\n    ",264],"}",["T_WHITESPACE","\n\n    ",265],["T_DOC_COMMENT","\/**\n     * Join attributes\n     *\n     * @return $this\n     *\/",267],["T_WHITESPACE","\n    ",271],["T_PUBLIC","public",272],["T_WHITESPACE"," ",272],["T_FUNCTION","function",272],["T_WHITESPACE"," ",272],["T_STRING","joinAttributes",272],"(",")",["T_WHITESPACE","\n    ",272],"{",["T_WHITESPACE","\n        ",273],["T_IF","if",274],["T_WHITESPACE"," ",274],"(","!",["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","getLinkModel",274],"(",")",")",["T_WHITESPACE"," ",274],"{",["T_WHITESPACE","\n            ",274],["T_RETURN","return",275],["T_WHITESPACE"," ",275],["T_VARIABLE","$this",275],";",["T_WHITESPACE","\n        ",275],"}",["T_WHITESPACE","\n\n        ",276],["T_FOREACH","foreach",278],["T_WHITESPACE"," ",278],"(",["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","getLinkAttributes",278],"(",")",["T_WHITESPACE"," ",278],["T_AS","as",278],["T_WHITESPACE"," ",278],["T_VARIABLE","$attribute",278],")",["T_WHITESPACE"," ",278],"{",["T_WHITESPACE","\n            ",278],["T_VARIABLE","$table",279],["T_WHITESPACE"," ",279],"=",["T_WHITESPACE"," ",279],["T_VARIABLE","$this",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","getLinkModel",279],"(",")",["T_OBJECT_OPERATOR","->",279],["T_STRING","getAttributeTypeTable",279],"(",["T_VARIABLE","$attribute",279],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",279],"]",")",";",["T_WHITESPACE","\n            ",279],["T_VARIABLE","$alias",280],["T_WHITESPACE"," ",280],"=",["T_WHITESPACE"," ",280],["T_STRING","sprintf",280],"(",["T_CONSTANT_ENCAPSED_STRING","'link_attribute_%s_%s'",280],",",["T_WHITESPACE"," ",280],["T_VARIABLE","$attribute",280],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",280],"]",",",["T_WHITESPACE"," ",280],["T_VARIABLE","$attribute",280],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",280],"]",")",";",["T_WHITESPACE","\n\n            ",280],["T_VARIABLE","$joinCondiotion",282],["T_WHITESPACE"," ",282],"=",["T_WHITESPACE"," ",282],"[",["T_WHITESPACE","\n                ",282],"\"",["T_CURLY_OPEN","{",283],["T_VARIABLE","$alias",283],"}",["T_ENCAPSED_AND_WHITESPACE",".link_id = links.link_id",283],"\"",",",["T_WHITESPACE","\n                ",283],["T_VARIABLE","$this",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","getSelect",284],"(",")",["T_OBJECT_OPERATOR","->",284],["T_STRING","getConnection",284],"(",")",["T_WHITESPACE","\n                    ",284],["T_OBJECT_OPERATOR","->",285],["T_STRING","quoteInto",285],"(","\"",["T_CURLY_OPEN","{",285],["T_VARIABLE","$alias",285],"}",["T_ENCAPSED_AND_WHITESPACE",".product_link_attribute_id = ?",285],"\"",",",["T_WHITESPACE"," ",285],["T_VARIABLE","$attribute",285],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",285],"]",")",",",["T_WHITESPACE","\n            ",285],"]",";",["T_WHITESPACE","\n            ",286],["T_VARIABLE","$this",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","getSelect",287],"(",")",["T_OBJECT_OPERATOR","->",287],["T_STRING","joinLeft",287],"(",["T_WHITESPACE","\n                ",287],"[",["T_VARIABLE","$alias",288],["T_WHITESPACE"," ",288],["T_DOUBLE_ARROW","=>",288],["T_WHITESPACE"," ",288],["T_VARIABLE","$table",288],"]",",",["T_WHITESPACE","\n                ",288],["T_STRING","implode",289],"(",["T_CONSTANT_ENCAPSED_STRING","' AND '",289],",",["T_WHITESPACE"," ",289],["T_VARIABLE","$joinCondiotion",289],")",",",["T_WHITESPACE","\n                ",289],"[",["T_VARIABLE","$attribute",290],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",290],"]",["T_WHITESPACE"," ",290],["T_DOUBLE_ARROW","=>",290],["T_WHITESPACE"," ",290],["T_CONSTANT_ENCAPSED_STRING","'value'",290],"]",["T_WHITESPACE","\n            ",290],")",";",["T_WHITESPACE","\n        ",291],"}",["T_WHITESPACE","\n\n        ",292],["T_RETURN","return",294],["T_WHITESPACE"," ",294],["T_VARIABLE","$this",294],";",["T_WHITESPACE","\n    ",294],"}",["T_WHITESPACE","\n\n    ",295],["T_DOC_COMMENT","\/**\n     * Set sorting order\n     *\n     * $attribute can also be an array of attributes\n     *\n     * @param string|array $attribute\n     * @param string $dir\n     * @return $this\n     *\/",297],["T_WHITESPACE","\n    ",305],["T_PUBLIC","public",306],["T_WHITESPACE"," ",306],["T_FUNCTION","function",306],["T_WHITESPACE"," ",306],["T_STRING","setOrder",306],"(",["T_VARIABLE","$attribute",306],",",["T_WHITESPACE"," ",306],["T_VARIABLE","$dir",306],["T_WHITESPACE"," ",306],"=",["T_WHITESPACE"," ",306],["T_STRING","self",306],["T_DOUBLE_COLON","::",306],["T_STRING","SORT_ORDER_ASC",306],")",["T_WHITESPACE","\n    ",306],"{",["T_WHITESPACE","\n        ",307],["T_IF","if",308],["T_WHITESPACE"," ",308],"(",["T_VARIABLE","$attribute",308],["T_WHITESPACE"," ",308],["T_IS_EQUAL","==",308],["T_WHITESPACE"," ",308],["T_CONSTANT_ENCAPSED_STRING","'position'",308],")",["T_WHITESPACE"," ",308],"{",["T_WHITESPACE","\n            ",308],["T_RETURN","return",309],["T_WHITESPACE"," ",309],["T_VARIABLE","$this",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","setPositionOrder",309],"(",["T_VARIABLE","$dir",309],")",";",["T_WHITESPACE","\n        ",309],"}",["T_WHITESPACE"," ",310],["T_ELSEIF","elseif",310],["T_WHITESPACE"," ",310],"(",["T_VARIABLE","$attribute",310],["T_WHITESPACE"," ",310],["T_IS_EQUAL","==",310],["T_WHITESPACE"," ",310],["T_CONSTANT_ENCAPSED_STRING","'attribute_set_id'",310],")",["T_WHITESPACE"," ",310],"{",["T_WHITESPACE","\n            ",310],["T_RETURN","return",311],["T_WHITESPACE"," ",311],["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","setAttributeSetIdOrder",311],"(",["T_VARIABLE","$dir",311],")",";",["T_WHITESPACE","\n        ",311],"}",["T_WHITESPACE","\n        ",312],["T_RETURN","return",313],["T_WHITESPACE"," ",313],["T_STRING","parent",313],["T_DOUBLE_COLON","::",313],["T_STRING","setOrder",313],"(",["T_VARIABLE","$attribute",313],",",["T_WHITESPACE"," ",313],["T_VARIABLE","$dir",313],")",";",["T_WHITESPACE","\n    ",313],"}",["T_WHITESPACE","\n\n    ",314],["T_DOC_COMMENT","\/**\n     * Get attributes of specified link type\n     *\n     * @param int $type\n     * @return array\n     *\/",316],["T_WHITESPACE","\n    ",321],["T_PUBLIC","public",322],["T_WHITESPACE"," ",322],["T_FUNCTION","function",322],["T_WHITESPACE"," ",322],["T_STRING","getLinkAttributes",322],"(",["T_VARIABLE","$type",322],["T_WHITESPACE"," ",322],"=",["T_WHITESPACE"," ",322],["T_STRING","null",322],")",["T_WHITESPACE","\n    ",322],"{",["T_WHITESPACE","\n        ",323],["T_RETURN","return",324],["T_WHITESPACE"," ",324],["T_VARIABLE","$this",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","getLinkModel",324],"(",")",["T_OBJECT_OPERATOR","->",324],["T_STRING","getAttributes",324],"(",["T_VARIABLE","$type",324],")",";",["T_WHITESPACE","\n    ",324],"}",["T_WHITESPACE","\n\n    ",325],["T_DOC_COMMENT","\/**\n     * Add link attribute to filter.\n     *\n     * @param string $code\n     * @param array $condition\n     * @return $this\n     *\/",327],["T_WHITESPACE","\n    ",333],["T_PUBLIC","public",334],["T_WHITESPACE"," ",334],["T_FUNCTION","function",334],["T_WHITESPACE"," ",334],["T_STRING","addLinkAttributeToFilter",334],"(",["T_VARIABLE","$code",334],",",["T_WHITESPACE"," ",334],["T_VARIABLE","$condition",334],")",["T_WHITESPACE","\n    ",334],"{",["T_WHITESPACE","\n        ",335],["T_FOREACH","foreach",336],["T_WHITESPACE"," ",336],"(",["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","getLinkAttributes",336],"(",")",["T_WHITESPACE"," ",336],["T_AS","as",336],["T_WHITESPACE"," ",336],["T_VARIABLE","$attribute",336],")",["T_WHITESPACE"," ",336],"{",["T_WHITESPACE","\n            ",336],["T_IF","if",337],["T_WHITESPACE"," ",337],"(",["T_VARIABLE","$attribute",337],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",337],"]",["T_WHITESPACE"," ",337],["T_IS_EQUAL","==",337],["T_WHITESPACE"," ",337],["T_VARIABLE","$code",337],")",["T_WHITESPACE"," ",337],"{",["T_WHITESPACE","\n                ",337],["T_VARIABLE","$alias",338],["T_WHITESPACE"," ",338],"=",["T_WHITESPACE"," ",338],["T_STRING","sprintf",338],"(",["T_CONSTANT_ENCAPSED_STRING","'link_attribute_%s_%s'",338],",",["T_WHITESPACE"," ",338],["T_VARIABLE","$code",338],",",["T_WHITESPACE"," ",338],["T_VARIABLE","$attribute",338],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",338],"]",")",";",["T_WHITESPACE","\n                ",338],["T_VARIABLE","$whereCondition",339],["T_WHITESPACE"," ",339],"=",["T_WHITESPACE"," ",339],["T_VARIABLE","$this",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","_getConditionSql",339],"(",["T_VARIABLE","$alias",339],["T_WHITESPACE"," ",339],".",["T_WHITESPACE"," ",339],["T_CONSTANT_ENCAPSED_STRING","'.`value`'",339],",",["T_WHITESPACE"," ",339],["T_VARIABLE","$condition",339],")",";",["T_WHITESPACE","\n                ",339],["T_VARIABLE","$this",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","getSelect",340],"(",")",["T_OBJECT_OPERATOR","->",340],["T_STRING","where",340],"(",["T_VARIABLE","$whereCondition",340],")",";",["T_WHITESPACE","\n            ",340],"}",["T_WHITESPACE","\n        ",341],"}",["T_WHITESPACE","\n        ",342],["T_RETURN","return",343],["T_WHITESPACE"," ",343],["T_VARIABLE","$this",343],";",["T_WHITESPACE","\n    ",343],"}",["T_WHITESPACE","\n\n    ",344],["T_DOC_COMMENT","\/**\n     * Join Product To Links\n     * @return void\n     *\/",346],["T_WHITESPACE","\n    ",349],["T_PRIVATE","private",350],["T_WHITESPACE"," ",350],["T_FUNCTION","function",350],["T_WHITESPACE"," ",350],["T_STRING","joinProductsToLinks",350],"(",")",["T_WHITESPACE","\n    ",350],"{",["T_WHITESPACE","\n        ",351],["T_IF","if",352],["T_WHITESPACE"," ",352],"(",["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","_hasLinkFilter",352],")",["T_WHITESPACE"," ",352],"{",["T_WHITESPACE","\n            ",352],["T_VARIABLE","$metaDataPool",353],["T_WHITESPACE"," ",353],"=",["T_WHITESPACE"," ",353],["T_VARIABLE","$this",353],["T_OBJECT_OPERATOR","->",353],["T_STRING","getProductEntityMetadata",353],"(",")",";",["T_WHITESPACE","\n            ",353],["T_VARIABLE","$linkField",354],["T_WHITESPACE"," ",354],"=",["T_WHITESPACE"," ",354],["T_VARIABLE","$metaDataPool",354],["T_OBJECT_OPERATOR","->",354],["T_STRING","getLinkField",354],"(",")",";",["T_WHITESPACE","\n            ",354],["T_VARIABLE","$entityTable",355],["T_WHITESPACE"," ",355],"=",["T_WHITESPACE"," ",355],["T_VARIABLE","$metaDataPool",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","getEntityTable",355],"(",")",";",["T_WHITESPACE","\n            ",355],["T_VARIABLE","$this",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","getSelect",356],"(",")",["T_WHITESPACE","\n                ",356],["T_OBJECT_OPERATOR","->",357],["T_STRING","join",357],"(",["T_WHITESPACE","\n                    ",357],"[",["T_CONSTANT_ENCAPSED_STRING","'product_entity_table'",358],["T_WHITESPACE"," ",358],["T_DOUBLE_ARROW","=>",358],["T_WHITESPACE"," ",358],["T_VARIABLE","$entityTable",358],"]",",",["T_WHITESPACE","\n                    ",358],"\"",["T_ENCAPSED_AND_WHITESPACE","links.product_id = product_entity_table.",359],["T_VARIABLE","$linkField",359],"\"",",",["T_WHITESPACE","\n                    ",359],"[","]",["T_WHITESPACE","\n                ",360],")",";",["T_WHITESPACE","\n        ",361],"}",["T_WHITESPACE","\n    ",362],"}",["T_WHITESPACE","\n",363],"}",["T_WHITESPACE","\n",364]]