[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Sales",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Helper",6],";",["T_WHITESPACE","\n\n",6],["T_CLASS","class",8],["T_WHITESPACE"," ",8],["T_STRING","Admin",8],["T_WHITESPACE"," ",8],["T_EXTENDS","extends",8],["T_WHITESPACE"," ",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","App",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Helper",8],["T_NS_SEPARATOR","\\",8],["T_STRING","AbstractHelper",8],["T_WHITESPACE","\n",8],"{",["T_WHITESPACE","\n    ",9],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Sales\\Model\\Config\n     *\/",10],["T_WHITESPACE","\n    ",12],["T_PROTECTED","protected",13],["T_WHITESPACE"," ",13],["T_VARIABLE","$_salesConfig",13],";",["T_WHITESPACE","\n\n    ",13],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Store\\Model\\StoreManagerInterface\n     *\/",15],["T_WHITESPACE","\n    ",17],["T_PROTECTED","protected",18],["T_WHITESPACE"," ",18],["T_VARIABLE","$_storeManager",18],";",["T_WHITESPACE","\n\n    ",18],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Pricing\\PriceCurrencyInterface\n     *\/",20],["T_WHITESPACE","\n    ",22],["T_PROTECTED","protected",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$priceCurrency",23],";",["T_WHITESPACE","\n\n    ",23],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Escaper\n     *\/",25],["T_WHITESPACE","\n    ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$escaper",28],";",["T_WHITESPACE","\n\n    ",28],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\App\\Helper\\Context $context\n     * @param \\Magento\\Store\\Model\\StoreManagerInterface $storeManager\n     * @param \\Magento\\Sales\\Model\\Config $salesConfig\n     * @param \\Magento\\Framework\\Pricing\\PriceCurrencyInterface $priceCurrency\n     * @param \\Magento\\Framework\\Escaper $escaper\n     *\/",30],["T_WHITESPACE","\n    ",36],["T_PUBLIC","public",37],["T_WHITESPACE"," ",37],["T_FUNCTION","function",37],["T_WHITESPACE"," ",37],["T_STRING","__construct",37],"(",["T_WHITESPACE","\n        ",37],["T_NS_SEPARATOR","\\",38],["T_STRING","Magento",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Framework",38],["T_NS_SEPARATOR","\\",38],["T_STRING","App",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Helper",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Context",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$context",38],",",["T_WHITESPACE","\n        ",38],["T_NS_SEPARATOR","\\",39],["T_STRING","Magento",39],["T_NS_SEPARATOR","\\",39],["T_STRING","Store",39],["T_NS_SEPARATOR","\\",39],["T_STRING","Model",39],["T_NS_SEPARATOR","\\",39],["T_STRING","StoreManagerInterface",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$storeManager",39],",",["T_WHITESPACE","\n        ",39],["T_NS_SEPARATOR","\\",40],["T_STRING","Magento",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Sales",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Model",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Config",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$salesConfig",40],",",["T_WHITESPACE","\n        ",40],["T_NS_SEPARATOR","\\",41],["T_STRING","Magento",41],["T_NS_SEPARATOR","\\",41],["T_STRING","Framework",41],["T_NS_SEPARATOR","\\",41],["T_STRING","Pricing",41],["T_NS_SEPARATOR","\\",41],["T_STRING","PriceCurrencyInterface",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$priceCurrency",41],",",["T_WHITESPACE","\n        ",41],["T_NS_SEPARATOR","\\",42],["T_STRING","Magento",42],["T_NS_SEPARATOR","\\",42],["T_STRING","Framework",42],["T_NS_SEPARATOR","\\",42],["T_STRING","Escaper",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$escaper",42],["T_WHITESPACE","\n    ",42],")",["T_WHITESPACE"," ",43],"{",["T_WHITESPACE","\n        ",43],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","priceCurrency",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_VARIABLE","$priceCurrency",44],";",["T_WHITESPACE","\n        ",44],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","_storeManager",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_VARIABLE","$storeManager",45],";",["T_WHITESPACE","\n        ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","_salesConfig",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$salesConfig",46],";",["T_WHITESPACE","\n        ",46],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","escaper",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$escaper",47],";",["T_WHITESPACE","\n        ",47],["T_STRING","parent",48],["T_DOUBLE_COLON","::",48],["T_STRING","__construct",48],"(",["T_VARIABLE","$context",48],")",";",["T_WHITESPACE","\n    ",48],"}",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Display price attribute value in base order currency and in place order currency\n     *\n     * @param   \\Magento\\Framework\\DataObject $dataObject\n     * @param   string $code\n     * @param   bool $strong\n     * @param   string $separator\n     * @return  string\n     *\/",51],["T_WHITESPACE","\n    ",59],["T_PUBLIC","public",60],["T_WHITESPACE"," ",60],["T_FUNCTION","function",60],["T_WHITESPACE"," ",60],["T_STRING","displayPriceAttribute",60],"(",["T_VARIABLE","$dataObject",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$code",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$strong",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_STRING","false",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$separator",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'<br\/>'",60],")",["T_WHITESPACE","\n    ",60],"{",["T_WHITESPACE","\n        ",61],["T_COMMENT","\/\/ Fix for 'bs_customer_bal_total_refunded' attribute\n",62],["T_WHITESPACE","        ",63],["T_VARIABLE","$baseValue",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_VARIABLE","$dataObject",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","hasData",63],"(",["T_CONSTANT_ENCAPSED_STRING","'bs_'",63],["T_WHITESPACE"," ",63],".",["T_WHITESPACE"," ",63],["T_VARIABLE","$code",63],")",["T_WHITESPACE","\n            ",63],"?",["T_WHITESPACE"," ",64],["T_VARIABLE","$dataObject",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","getData",64],"(",["T_CONSTANT_ENCAPSED_STRING","'bs_'",64],["T_WHITESPACE"," ",64],".",["T_WHITESPACE"," ",64],["T_VARIABLE","$code",64],")",["T_WHITESPACE","\n            ",64],":",["T_WHITESPACE"," ",65],["T_VARIABLE","$dataObject",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getData",65],"(",["T_CONSTANT_ENCAPSED_STRING","'base_'",65],["T_WHITESPACE"," ",65],".",["T_WHITESPACE"," ",65],["T_VARIABLE","$code",65],")",";",["T_WHITESPACE","\n        ",65],["T_RETURN","return",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","displayPrices",66],"(",["T_WHITESPACE","\n            ",66],["T_VARIABLE","$dataObject",67],",",["T_WHITESPACE","\n            ",67],["T_VARIABLE","$baseValue",68],",",["T_WHITESPACE","\n            ",68],["T_VARIABLE","$dataObject",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getData",69],"(",["T_VARIABLE","$code",69],")",",",["T_WHITESPACE","\n            ",69],["T_VARIABLE","$strong",70],",",["T_WHITESPACE","\n            ",70],["T_VARIABLE","$separator",71],["T_WHITESPACE","\n        ",71],")",";",["T_WHITESPACE","\n    ",72],"}",["T_WHITESPACE","\n\n    ",73],["T_DOC_COMMENT","\/**\n     * Get \"double\" prices html (block with base and place currency)\n     *\n     * @param   \\Magento\\Framework\\DataObject $dataObject\n     * @param   float $basePrice\n     * @param   float $price\n     * @param   bool $strong\n     * @param   string $separator\n     * @return  string\n     *\/",75],["T_WHITESPACE","\n    ",84],["T_PUBLIC","public",85],["T_WHITESPACE"," ",85],["T_FUNCTION","function",85],["T_WHITESPACE"," ",85],["T_STRING","displayPrices",85],"(",["T_VARIABLE","$dataObject",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$basePrice",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$price",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$strong",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_STRING","false",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$separator",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","'<br\/>'",85],")",["T_WHITESPACE","\n    ",85],"{",["T_WHITESPACE","\n        ",86],["T_VARIABLE","$order",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_STRING","false",87],";",["T_WHITESPACE","\n        ",87],["T_IF","if",88],["T_WHITESPACE"," ",88],"(",["T_VARIABLE","$dataObject",88],["T_WHITESPACE"," ",88],["T_INSTANCEOF","instanceof",88],["T_WHITESPACE"," ",88],["T_NS_SEPARATOR","\\",88],["T_STRING","Magento",88],["T_NS_SEPARATOR","\\",88],["T_STRING","Sales",88],["T_NS_SEPARATOR","\\",88],["T_STRING","Model",88],["T_NS_SEPARATOR","\\",88],["T_STRING","Order",88],")",["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n            ",88],["T_VARIABLE","$order",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$dataObject",89],";",["T_WHITESPACE","\n        ",89],"}",["T_WHITESPACE"," ",90],["T_ELSE","else",90],["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n            ",90],["T_VARIABLE","$order",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_VARIABLE","$dataObject",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getOrder",91],"(",")",";",["T_WHITESPACE","\n        ",91],"}",["T_WHITESPACE","\n\n        ",92],["T_IF","if",94],["T_WHITESPACE"," ",94],"(",["T_VARIABLE","$order",94],["T_WHITESPACE"," ",94],["T_BOOLEAN_AND","&&",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$order",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","isCurrencyDifferent",94],"(",")",")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n            ",94],["T_VARIABLE","$res",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","'<strong>'",95],";",["T_WHITESPACE","\n            ",95],["T_VARIABLE","$res",96],["T_WHITESPACE"," ",96],["T_CONCAT_EQUAL",".=",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$order",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","formatBasePrice",96],"(",["T_VARIABLE","$basePrice",96],")",";",["T_WHITESPACE","\n            ",96],["T_VARIABLE","$res",97],["T_WHITESPACE"," ",97],["T_CONCAT_EQUAL",".=",97],["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","'<\/strong>'",97],["T_WHITESPACE"," ",97],".",["T_WHITESPACE"," ",97],["T_VARIABLE","$separator",97],";",["T_WHITESPACE","\n            ",97],["T_VARIABLE","$res",98],["T_WHITESPACE"," ",98],["T_CONCAT_EQUAL",".=",98],["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'['",98],["T_WHITESPACE"," ",98],".",["T_WHITESPACE"," ",98],["T_VARIABLE","$order",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","formatPrice",98],"(",["T_VARIABLE","$price",98],")",["T_WHITESPACE"," ",98],".",["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","']'",98],";",["T_WHITESPACE","\n        ",98],"}",["T_WHITESPACE"," ",99],["T_ELSEIF","elseif",99],["T_WHITESPACE"," ",99],"(",["T_VARIABLE","$order",99],")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n            ",99],["T_VARIABLE","$res",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$order",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","formatPrice",100],"(",["T_VARIABLE","$price",100],")",";",["T_WHITESPACE","\n            ",100],["T_IF","if",101],["T_WHITESPACE"," ",101],"(",["T_VARIABLE","$strong",101],")",["T_WHITESPACE"," ",101],"{",["T_WHITESPACE","\n                ",101],["T_VARIABLE","$res",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'<strong>'",102],["T_WHITESPACE"," ",102],".",["T_WHITESPACE"," ",102],["T_VARIABLE","$res",102],["T_WHITESPACE"," ",102],".",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'<\/strong>'",102],";",["T_WHITESPACE","\n            ",102],"}",["T_WHITESPACE","\n        ",103],"}",["T_WHITESPACE"," ",104],["T_ELSE","else",104],["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n            ",104],["T_VARIABLE","$res",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","priceCurrency",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","format",105],"(",["T_VARIABLE","$price",105],")",";",["T_WHITESPACE","\n            ",105],["T_IF","if",106],["T_WHITESPACE"," ",106],"(",["T_VARIABLE","$strong",106],")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n                ",106],["T_VARIABLE","$res",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'<strong>'",107],["T_WHITESPACE"," ",107],".",["T_WHITESPACE"," ",107],["T_VARIABLE","$res",107],["T_WHITESPACE"," ",107],".",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'<\/strong>'",107],";",["T_WHITESPACE","\n            ",107],"}",["T_WHITESPACE","\n        ",108],"}",["T_WHITESPACE","\n        ",109],["T_RETURN","return",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$res",110],";",["T_WHITESPACE","\n    ",110],"}",["T_WHITESPACE","\n\n    ",111],["T_DOC_COMMENT","\/**\n     * Filter collection by removing not available product types\n     *\n     * @param \\Magento\\Framework\\Model\\ResourceModel\\Db\\Collection\\AbstractCollection $collection\n     * @return \\Magento\\Framework\\Model\\ResourceModel\\Db\\Collection\\AbstractCollection\n     *\/",113],["T_WHITESPACE","\n    ",118],["T_PUBLIC","public",119],["T_WHITESPACE"," ",119],["T_FUNCTION","function",119],["T_WHITESPACE"," ",119],["T_STRING","applySalableProductTypesFilter",119],"(",["T_VARIABLE","$collection",119],")",["T_WHITESPACE","\n    ",119],"{",["T_WHITESPACE","\n        ",120],["T_VARIABLE","$productTypes",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","_salesConfig",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","getAvailableProductTypes",121],"(",")",";",["T_WHITESPACE","\n        ",121],["T_FOREACH","foreach",122],["T_WHITESPACE"," ",122],"(",["T_VARIABLE","$collection",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","getItems",122],"(",")",["T_WHITESPACE"," ",122],["T_AS","as",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$key",122],["T_WHITESPACE"," ",122],["T_DOUBLE_ARROW","=>",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$item",122],")",["T_WHITESPACE"," ",122],"{",["T_WHITESPACE","\n            ",122],["T_IF","if",123],["T_WHITESPACE"," ",123],"(",["T_VARIABLE","$item",123],["T_WHITESPACE"," ",123],["T_INSTANCEOF","instanceof",123],["T_WHITESPACE"," ",123],["T_NS_SEPARATOR","\\",123],["T_STRING","Magento",123],["T_NS_SEPARATOR","\\",123],["T_STRING","Catalog",123],["T_NS_SEPARATOR","\\",123],["T_STRING","Model",123],["T_NS_SEPARATOR","\\",123],["T_STRING","Product",123],")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n                ",123],["T_VARIABLE","$type",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$item",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","getTypeId",124],"(",")",";",["T_WHITESPACE","\n            ",124],"}",["T_WHITESPACE"," ",125],["T_ELSEIF","elseif",125],["T_WHITESPACE"," ",125],"(",["T_VARIABLE","$item",125],["T_WHITESPACE"," ",125],["T_INSTANCEOF","instanceof",125],["T_WHITESPACE"," ",125],["T_NS_SEPARATOR","\\",125],["T_STRING","Magento",125],["T_NS_SEPARATOR","\\",125],["T_STRING","Sales",125],["T_NS_SEPARATOR","\\",125],["T_STRING","Model",125],["T_NS_SEPARATOR","\\",125],["T_STRING","Order",125],["T_NS_SEPARATOR","\\",125],["T_STRING","Item",125],")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n                ",125],["T_VARIABLE","$type",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$item",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getProductType",126],"(",")",";",["T_WHITESPACE","\n            ",126],"}",["T_WHITESPACE"," ",127],["T_ELSEIF","elseif",127],["T_WHITESPACE"," ",127],"(",["T_VARIABLE","$item",127],["T_WHITESPACE"," ",127],["T_INSTANCEOF","instanceof",127],["T_WHITESPACE"," ",127],["T_NS_SEPARATOR","\\",127],["T_STRING","Magento",127],["T_NS_SEPARATOR","\\",127],["T_STRING","Quote",127],["T_NS_SEPARATOR","\\",127],["T_STRING","Model",127],["T_NS_SEPARATOR","\\",127],["T_STRING","Quote",127],["T_NS_SEPARATOR","\\",127],["T_STRING","Item",127],")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n                ",127],["T_VARIABLE","$type",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_VARIABLE","$item",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","getProductType",128],"(",")",";",["T_WHITESPACE","\n            ",128],"}",["T_WHITESPACE"," ",129],["T_ELSE","else",129],["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n                ",129],["T_VARIABLE","$type",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","''",130],";",["T_WHITESPACE","\n            ",130],"}",["T_WHITESPACE","\n            ",131],["T_IF","if",132],["T_WHITESPACE"," ",132],"(","!",["T_STRING","in_array",132],"(",["T_VARIABLE","$type",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$productTypes",132],")",")",["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n                ",132],["T_VARIABLE","$collection",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","removeItemByKey",133],"(",["T_VARIABLE","$key",133],")",";",["T_WHITESPACE","\n            ",133],"}",["T_WHITESPACE","\n        ",134],"}",["T_WHITESPACE","\n        ",135],["T_RETURN","return",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$collection",136],";",["T_WHITESPACE","\n    ",136],"}",["T_WHITESPACE","\n\n    ",137],["T_DOC_COMMENT","\/**\n     * Escape string preserving links\n     *\n     * @param string $data\n     * @param null|array $allowedTags\n     * @return string\n     *\/",139],["T_WHITESPACE","\n    ",145],["T_PUBLIC","public",146],["T_WHITESPACE"," ",146],["T_FUNCTION","function",146],["T_WHITESPACE"," ",146],["T_STRING","escapeHtmlWithLinks",146],"(",["T_VARIABLE","$data",146],",",["T_WHITESPACE"," ",146],["T_VARIABLE","$allowedTags",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_STRING","null",146],")",["T_WHITESPACE","\n    ",146],"{",["T_WHITESPACE","\n        ",147],["T_IF","if",148],["T_WHITESPACE"," ",148],"(","!",["T_EMPTY","empty",148],"(",["T_VARIABLE","$data",148],")",["T_WHITESPACE"," ",148],["T_BOOLEAN_AND","&&",148],["T_WHITESPACE"," ",148],["T_STRING","is_array",148],"(",["T_VARIABLE","$allowedTags",148],")",["T_WHITESPACE"," ",148],["T_BOOLEAN_AND","&&",148],["T_WHITESPACE"," ",148],["T_STRING","in_array",148],"(",["T_CONSTANT_ENCAPSED_STRING","'a'",148],",",["T_WHITESPACE"," ",148],["T_VARIABLE","$allowedTags",148],")",")",["T_WHITESPACE"," ",148],"{",["T_WHITESPACE","\n            ",148],["T_VARIABLE","$links",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],"[","]",";",["T_WHITESPACE","\n            ",149],["T_VARIABLE","$i",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_LNUMBER","1",150],";",["T_WHITESPACE","\n            ",150],["T_VARIABLE","$data",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_STRING","str_replace",151],"(",["T_CONSTANT_ENCAPSED_STRING","'%'",151],",",["T_WHITESPACE"," ",151],["T_CONSTANT_ENCAPSED_STRING","'%%'",151],",",["T_WHITESPACE"," ",151],["T_VARIABLE","$data",151],")",";",["T_WHITESPACE","\n            ",151],["T_VARIABLE","$regexp",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_CONSTANT_ENCAPSED_STRING","\"\/<a\\s[^>]*href\\s*?=\\s*?([\\\"\\']??)([^\\\" >]*?)\\\\1[^>]*>(.*)<\\\/a>\/siU\"",152],";",["T_WHITESPACE","\n            ",152],["T_WHILE","while",153],["T_WHITESPACE"," ",153],"(",["T_STRING","preg_match",153],"(",["T_VARIABLE","$regexp",153],",",["T_WHITESPACE"," ",153],["T_VARIABLE","$data",153],",",["T_WHITESPACE"," ",153],["T_VARIABLE","$matches",153],")",")",["T_WHITESPACE"," ",153],"{",["T_WHITESPACE","\n                ",153],["T_COMMENT","\/\/Revert the sprintf escaping\n",154],["T_WHITESPACE","                ",155],["T_VARIABLE","$url",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_STRING","str_replace",155],"(",["T_CONSTANT_ENCAPSED_STRING","'%%'",155],",",["T_WHITESPACE"," ",155],["T_CONSTANT_ENCAPSED_STRING","'%'",155],",",["T_WHITESPACE"," ",155],["T_VARIABLE","$matches",155],"[",["T_LNUMBER","2",155],"]",")",";",["T_WHITESPACE","\n                ",155],["T_VARIABLE","$text",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_STRING","str_replace",156],"(",["T_CONSTANT_ENCAPSED_STRING","'%%'",156],",",["T_WHITESPACE"," ",156],["T_CONSTANT_ENCAPSED_STRING","'%'",156],",",["T_WHITESPACE"," ",156],["T_VARIABLE","$matches",156],"[",["T_LNUMBER","3",156],"]",")",";",["T_WHITESPACE","\n                ",156],["T_COMMENT","\/\/Check for an valid url\n",157],["T_WHITESPACE","                ",158],["T_IF","if",158],["T_WHITESPACE"," ",158],"(",["T_VARIABLE","$url",158],")",["T_WHITESPACE"," ",158],"{",["T_WHITESPACE","\n                    ",158],["T_VARIABLE","$urlScheme",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_STRING","strtolower",159],"(",["T_STRING","parse_url",159],"(",["T_VARIABLE","$url",159],",",["T_WHITESPACE"," ",159],["T_STRING","PHP_URL_SCHEME",159],")",")",";",["T_WHITESPACE","\n                    ",159],["T_IF","if",160],["T_WHITESPACE"," ",160],"(",["T_VARIABLE","$urlScheme",160],["T_WHITESPACE"," ",160],["T_IS_NOT_IDENTICAL","!==",160],["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","'http'",160],["T_WHITESPACE"," ",160],["T_BOOLEAN_AND","&&",160],["T_WHITESPACE"," ",160],["T_VARIABLE","$urlScheme",160],["T_WHITESPACE"," ",160],["T_IS_NOT_IDENTICAL","!==",160],["T_WHITESPACE"," ",160],["T_CONSTANT_ENCAPSED_STRING","'https'",160],")",["T_WHITESPACE"," ",160],"{",["T_WHITESPACE","\n                        ",160],["T_VARIABLE","$url",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_STRING","null",161],";",["T_WHITESPACE","\n                    ",161],"}",["T_WHITESPACE","\n                ",162],"}",["T_WHITESPACE","\n                ",163],["T_COMMENT","\/\/Use hash tag as fallback\n",164],["T_WHITESPACE","                ",165],["T_IF","if",165],["T_WHITESPACE"," ",165],"(","!",["T_VARIABLE","$url",165],")",["T_WHITESPACE"," ",165],"{",["T_WHITESPACE","\n                    ",165],["T_VARIABLE","$url",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_CONSTANT_ENCAPSED_STRING","'#'",166],";",["T_WHITESPACE","\n                ",166],"}",["T_WHITESPACE","\n                ",167],["T_COMMENT","\/\/Recreate a minimalistic secure a tag\n",168],["T_WHITESPACE","                ",169],["T_VARIABLE","$links",169],"[","]",["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_STRING","sprintf",169],"(",["T_WHITESPACE","\n                    ",169],["T_CONSTANT_ENCAPSED_STRING","'<a href=\"%s\">%s<\/a>'",170],",",["T_WHITESPACE","\n                    ",170],["T_STRING","htmlspecialchars",171],"(",["T_VARIABLE","$url",171],",",["T_WHITESPACE"," ",171],["T_STRING","ENT_QUOTES",171],",",["T_WHITESPACE"," ",171],["T_CONSTANT_ENCAPSED_STRING","'UTF-8'",171],",",["T_WHITESPACE"," ",171],["T_STRING","false",171],")",",",["T_WHITESPACE","\n                    ",171],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","escaper",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","escapeHtml",172],"(",["T_VARIABLE","$text",172],")",["T_WHITESPACE","\n                ",172],")",";",["T_WHITESPACE","\n                ",173],["T_VARIABLE","$data",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_STRING","str_replace",174],"(",["T_VARIABLE","$matches",174],"[",["T_LNUMBER","0",174],"]",",",["T_WHITESPACE"," ",174],["T_CONSTANT_ENCAPSED_STRING","'%'",174],["T_WHITESPACE"," ",174],".",["T_WHITESPACE"," ",174],["T_VARIABLE","$i",174],["T_WHITESPACE"," ",174],".",["T_WHITESPACE"," ",174],["T_CONSTANT_ENCAPSED_STRING","'$s'",174],",",["T_WHITESPACE"," ",174],["T_VARIABLE","$data",174],")",";",["T_WHITESPACE","\n                ",174],["T_INC","++",175],["T_VARIABLE","$i",175],";",["T_WHITESPACE","\n            ",175],"}",["T_WHITESPACE","\n            ",176],["T_VARIABLE","$data",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","escaper",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","escapeHtml",177],"(",["T_VARIABLE","$data",177],",",["T_WHITESPACE"," ",177],["T_VARIABLE","$allowedTags",177],")",";",["T_WHITESPACE","\n            ",177],["T_RETURN","return",178],["T_WHITESPACE"," ",178],["T_STRING","vsprintf",178],"(",["T_VARIABLE","$data",178],",",["T_WHITESPACE"," ",178],["T_VARIABLE","$links",178],")",";",["T_WHITESPACE","\n        ",178],"}",["T_WHITESPACE","\n        ",179],["T_RETURN","return",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","escaper",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","escapeHtml",180],"(",["T_VARIABLE","$data",180],",",["T_WHITESPACE"," ",180],["T_VARIABLE","$allowedTags",180],")",";",["T_WHITESPACE","\n    ",180],"}",["T_WHITESPACE","\n",181],"}",["T_WHITESPACE","\n",182]]