[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_COMMENT","\/\/ @codingStandardsIgnoreFile\n",7],["T_WHITESPACE","\n",8],["T_NAMESPACE","namespace",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Sales",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Test",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Unit",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Model",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Order",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Creditmemo",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Total",9],";",["T_WHITESPACE","\n\n",9],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Framework",11],["T_NS_SEPARATOR","\\",11],["T_STRING","DataObject",11],["T_WHITESPACE"," ",11],["T_AS","as",11],["T_WHITESPACE"," ",11],["T_STRING","MagentoObject",11],";",["T_WHITESPACE","\n\n",11],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","TaxTest",13],["T_WHITESPACE"," ",13],["T_EXTENDS","extends",13],["T_WHITESPACE"," ",13],["T_NS_SEPARATOR","\\",13],["T_STRING","PHPUnit_Framework_TestCase",13],["T_WHITESPACE","\n",13],"{",["T_WHITESPACE","\n    ",14],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Sales\\Model\\Order\\Creditmemo\\Total\\Tax\n     *\/",15],["T_WHITESPACE","\n    ",17],["T_PROTECTED","protected",18],["T_WHITESPACE"," ",18],["T_VARIABLE","$model",18],";",["T_WHITESPACE","\n\n    ",18],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Sales\\Model\\Order|\\PHPUnit_Framework_MockObject_MockObject\n     *\/",20],["T_WHITESPACE","\n    ",22],["T_PROTECTED","protected",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$order",23],";",["T_WHITESPACE","\n\n    ",23],["T_DOC_COMMENT","\/**\n     * @var  \\Magento\\Framework\\TestFramework\\Unit\\Helper\\ObjectManager\n     *\/",25],["T_WHITESPACE","\n    ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$objectManager",28],";",["T_WHITESPACE","\n\n    ",28],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Sales\\Model\\Order\\Creditmemo|\\PHPUnit_Framework_MockObject_MockObject\n     *\/",30],["T_WHITESPACE","\n    ",32],["T_PROTECTED","protected",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$creditmemo",33],";",["T_WHITESPACE","\n\n    ",33],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Sales\\Model\\Order\\Creditmemo|\\PHPUnit_Framework_MockObject_MockObject\n     *\/",35],["T_WHITESPACE","\n    ",37],["T_PROTECTED","protected",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$invoice",38],";",["T_WHITESPACE","\n\n    ",38],["T_PROTECTED","protected",40],["T_WHITESPACE"," ",40],["T_FUNCTION","function",40],["T_WHITESPACE"," ",40],["T_STRING","setUp",40],"(",")",["T_WHITESPACE","\n    ",40],"{",["T_WHITESPACE","\n        ",41],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","objectManager",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_NEW","new",42],["T_WHITESPACE"," ",42],["T_NS_SEPARATOR","\\",42],["T_STRING","Magento",42],["T_NS_SEPARATOR","\\",42],["T_STRING","Framework",42],["T_NS_SEPARATOR","\\",42],["T_STRING","TestFramework",42],["T_NS_SEPARATOR","\\",42],["T_STRING","Unit",42],["T_NS_SEPARATOR","\\",42],["T_STRING","Helper",42],["T_NS_SEPARATOR","\\",42],["T_STRING","ObjectManager",42],"(",["T_VARIABLE","$this",42],")",";",["T_WHITESPACE","\n        ",42],["T_DOC_COMMENT","\/** @var \\Magento\\Sales\\Model\\Order\\Creditmemo\\Total\\Tax $model *\/",43],["T_WHITESPACE","\n        ",43],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","model",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","objectManager",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","getObject",44],"(",["T_NS_SEPARATOR","\\",44],["T_STRING","Magento",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Sales",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Model",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Order",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Creditmemo",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Total",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Tax",44],["T_DOUBLE_COLON","::",44],["T_CLASS","class",44],")",";",["T_WHITESPACE","\n\n        ",44],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","order",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","getMock",46],"(",["T_WHITESPACE","\r\n            ",46],["T_NS_SEPARATOR","\\",47],["T_STRING","Magento",47],["T_NS_SEPARATOR","\\",47],["T_STRING","Sales",47],["T_NS_SEPARATOR","\\",47],["T_STRING","Model",47],["T_NS_SEPARATOR","\\",47],["T_STRING","Order",47],["T_DOUBLE_COLON","::",47],["T_CLASS","class",47],",",["T_WHITESPACE","\n            ",47],"[",["T_WHITESPACE","\n                ",48],["T_CONSTANT_ENCAPSED_STRING","'__wakeup'",49],["T_WHITESPACE","\n            ",49],"]",",",["T_WHITESPACE","\n            ",50],"[","]",",",["T_WHITESPACE","\n            ",51],["T_CONSTANT_ENCAPSED_STRING","''",52],",",["T_WHITESPACE","\n            ",52],["T_STRING","false",53],["T_WHITESPACE","\n        ",53],")",";",["T_WHITESPACE","\n\n        ",54],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","invoice",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","getMock",56],"(",["T_WHITESPACE","\r\n            ",56],["T_NS_SEPARATOR","\\",57],["T_STRING","Magento",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Sales",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Model",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Order",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Invoice",57],["T_DOUBLE_COLON","::",57],["T_CLASS","class",57],",",["T_WHITESPACE","\n            ",57],"[",["T_WHITESPACE","\n                ",58],["T_CONSTANT_ENCAPSED_STRING","'__wakeup'",59],",",["T_WHITESPACE","\n            ",59],"]",",",["T_WHITESPACE","\n            ",60],"[","]",",",["T_WHITESPACE","\n            ",61],["T_CONSTANT_ENCAPSED_STRING","''",62],",",["T_WHITESPACE","\n            ",62],["T_STRING","false",63],["T_WHITESPACE","\n        ",63],")",";",["T_WHITESPACE","\n\n        ",64],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","creditmemo",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getMock",66],"(",["T_WHITESPACE","\r\n            ",66],["T_NS_SEPARATOR","\\",67],["T_STRING","Magento",67],["T_NS_SEPARATOR","\\",67],["T_STRING","Sales",67],["T_NS_SEPARATOR","\\",67],["T_STRING","Model",67],["T_NS_SEPARATOR","\\",67],["T_STRING","Order",67],["T_NS_SEPARATOR","\\",67],["T_STRING","Creditmemo",67],["T_DOUBLE_COLON","::",67],["T_CLASS","class",67],",",["T_WHITESPACE","\n            ",67],"[",["T_WHITESPACE","\n                ",68],["T_CONSTANT_ENCAPSED_STRING","'getAllItems'",69],",",["T_WHITESPACE","\n                ",69],["T_CONSTANT_ENCAPSED_STRING","'getOrder'",70],",",["T_WHITESPACE","\n                ",70],["T_CONSTANT_ENCAPSED_STRING","'roundPrice'",71],",",["T_WHITESPACE","\n                ",71],["T_CONSTANT_ENCAPSED_STRING","'isLast'",72],",",["T_WHITESPACE","\n                ",72],["T_CONSTANT_ENCAPSED_STRING","'__wakeup'",73],",",["T_WHITESPACE","\n            ",73],"]",",",["T_WHITESPACE","\n            ",74],"[","]",",",["T_WHITESPACE","\n            ",75],["T_CONSTANT_ENCAPSED_STRING","''",76],",",["T_WHITESPACE","\n            ",76],["T_STRING","false",77],["T_WHITESPACE","\n        ",77],")",";",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","creditmemo",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","expects",79],"(",["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","atLeastOnce",79],"(",")",")",["T_OBJECT_OPERATOR","->",79],["T_STRING","method",79],"(",["T_CONSTANT_ENCAPSED_STRING","'getOrder'",79],")",["T_OBJECT_OPERATOR","->",79],["T_STRING","will",79],"(",["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","returnValue",79],"(",["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","order",79],")",")",";",["T_WHITESPACE","\n    ",79],"}",["T_WHITESPACE","\n\n    ",80],["T_DOC_COMMENT","\/**\n     * @param array $orderData\n     * @param array $creditmemoData\n     * @param array $expectedResults\n     * @dataProvider collectDataProvider\n     *\/",82],["T_WHITESPACE","\n    ",87],["T_PUBLIC","public",88],["T_WHITESPACE"," ",88],["T_FUNCTION","function",88],["T_WHITESPACE"," ",88],["T_STRING","testCollect",88],"(",["T_VARIABLE","$orderData",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$creditmemoData",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$expectedResults",88],")",["T_WHITESPACE","\n    ",88],"{",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$roundingDelta",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],"[","]",";",["T_WHITESPACE","\n\n        ",90],["T_COMMENT","\/\/Set up order mock\n",92],["T_WHITESPACE","        ",93],["T_FOREACH","foreach",93],["T_WHITESPACE"," ",93],"(",["T_VARIABLE","$orderData",93],"[",["T_CONSTANT_ENCAPSED_STRING","'data_fields'",93],"]",["T_WHITESPACE"," ",93],["T_AS","as",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$key",93],["T_WHITESPACE"," ",93],["T_DOUBLE_ARROW","=>",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$value",93],")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n            ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","order",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","setData",94],"(",["T_VARIABLE","$key",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$value",94],")",";",["T_WHITESPACE","\n        ",94],"}",["T_WHITESPACE","\n\n        ",95],["T_COMMENT","\/\/Set up creditmemo mock\n",97],["T_WHITESPACE","        ",98],["T_DOC_COMMENT","\/** @var \\Magento\\Sales\\Model\\Order\\Creditmemo\\Item[] $creditmemoItems *\/",98],["T_WHITESPACE","\n        ",98],["T_VARIABLE","$creditmemoItems",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],"[","]",";",["T_WHITESPACE","\n        ",99],["T_FOREACH","foreach",100],["T_WHITESPACE"," ",100],"(",["T_VARIABLE","$creditmemoData",100],"[",["T_CONSTANT_ENCAPSED_STRING","'items'",100],"]",["T_WHITESPACE"," ",100],["T_AS","as",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$itemKey",100],["T_WHITESPACE"," ",100],["T_DOUBLE_ARROW","=>",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$creditmemoItemData",100],")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n            ",100],["T_VARIABLE","$creditmemoItems",101],"[",["T_VARIABLE","$itemKey",101],"]",["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getCreditmemoItem",101],"(",["T_VARIABLE","$creditmemoItemData",101],")",";",["T_WHITESPACE","\n        ",101],"}",["T_WHITESPACE","\n        ",102],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","creditmemo",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","expects",103],"(",["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","once",103],"(",")",")",["T_WHITESPACE","\n            ",103],["T_OBJECT_OPERATOR","->",104],["T_STRING","method",104],"(",["T_CONSTANT_ENCAPSED_STRING","'getAllItems'",104],")",["T_WHITESPACE","\n            ",104],["T_OBJECT_OPERATOR","->",105],["T_STRING","will",105],"(",["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","returnValue",105],"(",["T_VARIABLE","$creditmemoItems",105],")",")",";",["T_WHITESPACE","\n        ",105],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","creditmemo",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","expects",106],"(",["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","any",106],"(",")",")",["T_WHITESPACE","\n            ",106],["T_OBJECT_OPERATOR","->",107],["T_STRING","method",107],"(",["T_CONSTANT_ENCAPSED_STRING","'isLast'",107],")",["T_WHITESPACE","\n            ",107],["T_OBJECT_OPERATOR","->",108],["T_STRING","will",108],"(",["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","returnValue",108],"(",["T_VARIABLE","$creditmemoData",108],"[",["T_CONSTANT_ENCAPSED_STRING","'is_last'",108],"]",")",")",";",["T_WHITESPACE","\n        ",108],["T_FOREACH","foreach",109],["T_WHITESPACE"," ",109],"(",["T_VARIABLE","$creditmemoData",109],"[",["T_CONSTANT_ENCAPSED_STRING","'data_fields'",109],"]",["T_WHITESPACE"," ",109],["T_AS","as",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$key",109],["T_WHITESPACE"," ",109],["T_DOUBLE_ARROW","=>",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$value",109],")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n            ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","creditmemo",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","setData",110],"(",["T_VARIABLE","$key",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$value",110],")",";",["T_WHITESPACE","\n        ",110],"}",["T_WHITESPACE","\n        ",111],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","creditmemo",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","expects",112],"(",["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","any",112],"(",")",")",["T_WHITESPACE","\n            ",112],["T_OBJECT_OPERATOR","->",113],["T_STRING","method",113],"(",["T_CONSTANT_ENCAPSED_STRING","'roundPrice'",113],")",["T_WHITESPACE","\n            ",113],["T_OBJECT_OPERATOR","->",114],["T_STRING","will",114],"(",["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","returnCallback",114],"(",["T_WHITESPACE","\n                ",114],["T_FUNCTION","function",115],["T_WHITESPACE"," ",115],"(",["T_VARIABLE","$price",115],",",["T_WHITESPACE"," ",115],["T_VARIABLE","$type",115],")",["T_WHITESPACE"," ",115],["T_USE","use",115],["T_WHITESPACE"," ",115],"(","&",["T_VARIABLE","$roundingDelta",115],")",["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n                    ",115],["T_IF","if",116],["T_WHITESPACE"," ",116],"(","!",["T_ISSET","isset",116],"(",["T_VARIABLE","$roundingDelta",116],"[",["T_VARIABLE","$type",116],"]",")",")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n                        ",116],["T_VARIABLE","$roundingDelta",117],"[",["T_VARIABLE","$type",117],"]",["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_LNUMBER","0",117],";",["T_WHITESPACE","\n                    ",117],"}",["T_WHITESPACE","\n                    ",118],["T_VARIABLE","$roundedPrice",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_STRING","round",119],"(",["T_VARIABLE","$price",119],["T_WHITESPACE"," ",119],"+",["T_WHITESPACE"," ",119],["T_VARIABLE","$roundingDelta",119],"[",["T_VARIABLE","$type",119],"]",",",["T_WHITESPACE"," ",119],["T_LNUMBER","2",119],")",";",["T_WHITESPACE","\n                    ",119],["T_VARIABLE","$roundingDelta",120],"[",["T_VARIABLE","$type",120],"]",["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_VARIABLE","$price",120],["T_WHITESPACE"," ",120],"-",["T_WHITESPACE"," ",120],["T_VARIABLE","$roundedPrice",120],";",["T_WHITESPACE","\n                    ",120],["T_RETURN","return",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$roundedPrice",121],";",["T_WHITESPACE","\n                ",121],"}",["T_WHITESPACE","\n            ",122],")",")",";",["T_WHITESPACE","\n\n        ",123],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","model",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","collect",125],"(",["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","creditmemo",125],")",";",["T_WHITESPACE","\n\n        ",125],["T_COMMENT","\/\/verify invoice data\n",127],["T_WHITESPACE","        ",128],["T_FOREACH","foreach",128],["T_WHITESPACE"," ",128],"(",["T_VARIABLE","$expectedResults",128],"[",["T_CONSTANT_ENCAPSED_STRING","'creditmemo_data'",128],"]",["T_WHITESPACE"," ",128],["T_AS","as",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$key",128],["T_WHITESPACE"," ",128],["T_DOUBLE_ARROW","=>",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$value",128],")",["T_WHITESPACE"," ",128],"{",["T_WHITESPACE","\n            ",128],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","assertEquals",129],"(",["T_VARIABLE","$value",129],",",["T_WHITESPACE"," ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","creditmemo",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getData",129],"(",["T_VARIABLE","$key",129],")",")",";",["T_WHITESPACE","\n        ",129],"}",["T_WHITESPACE","\n        ",130],["T_COMMENT","\/\/verify invoice item data\n",131],["T_WHITESPACE","        ",132],["T_FOREACH","foreach",132],["T_WHITESPACE"," ",132],"(",["T_VARIABLE","$expectedResults",132],"[",["T_CONSTANT_ENCAPSED_STRING","'creditmemo_items'",132],"]",["T_WHITESPACE"," ",132],["T_AS","as",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$itemKey",132],["T_WHITESPACE"," ",132],["T_DOUBLE_ARROW","=>",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$itemData",132],")",["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n            ",132],["T_VARIABLE","$creditmemoItem",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_VARIABLE","$creditmemoItems",133],"[",["T_VARIABLE","$itemKey",133],"]",";",["T_WHITESPACE","\n            ",133],["T_FOREACH","foreach",134],["T_WHITESPACE"," ",134],"(",["T_VARIABLE","$itemData",134],["T_WHITESPACE"," ",134],["T_AS","as",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$key",134],["T_WHITESPACE"," ",134],["T_DOUBLE_ARROW","=>",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$value",134],")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n                ",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","assertEquals",135],"(",["T_VARIABLE","$value",135],",",["T_WHITESPACE"," ",135],["T_VARIABLE","$creditmemoItem",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getData",135],"(",["T_VARIABLE","$key",135],")",")",";",["T_WHITESPACE","\n            ",135],"}",["T_WHITESPACE","\n        ",136],"}",["T_WHITESPACE","\n    ",137],"}",["T_WHITESPACE","\n\n    ",138],["T_DOC_COMMENT","\/**\n     * @SuppressWarnings(PHPMD.ExcessiveMethodLength)\n     * @return array\n     *\/",140],["T_WHITESPACE","\n    ",143],["T_PUBLIC","public",144],["T_WHITESPACE"," ",144],["T_FUNCTION","function",144],["T_WHITESPACE"," ",144],["T_STRING","collectDataProvider",144],"(",")",["T_WHITESPACE","\n    ",144],"{",["T_WHITESPACE","\n        ",145],["T_VARIABLE","$result",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],"[","]",";",["T_WHITESPACE","\n        ",146],["T_COMMENT","\/\/ scenario 1: 3 item_1, 3 item_2, $99 each, 8.19 tax rate\n",147],["T_WHITESPACE","        ",148],["T_COMMENT","\/\/ 1 item_1 and 2 item_2 are invoiced\n",148],["T_WHITESPACE","        ",149],["T_VARIABLE","$result",149],"[",["T_CONSTANT_ENCAPSED_STRING","'partial_invoice_partial_creditmemo'",149],"]",["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],"[",["T_WHITESPACE","\n            ",149],["T_CONSTANT_ENCAPSED_STRING","'order_data'",150],["T_WHITESPACE"," ",150],["T_DOUBLE_ARROW","=>",150],["T_WHITESPACE"," ",150],"[",["T_WHITESPACE","\n                ",150],["T_CONSTANT_ENCAPSED_STRING","'data_fields'",151],["T_WHITESPACE"," ",151],["T_DOUBLE_ARROW","=>",151],["T_WHITESPACE"," ",151],"[",["T_WHITESPACE","\n                    ",151],["T_CONSTANT_ENCAPSED_STRING","'shipping_tax_amount'",152],["T_WHITESPACE"," ",152],["T_DOUBLE_ARROW","=>",152],["T_WHITESPACE"," ",152],["T_DNUMBER","2.45",152],",",["T_WHITESPACE","\n                    ",152],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_tax_amount'",153],["T_WHITESPACE"," ",153],["T_DOUBLE_ARROW","=>",153],["T_WHITESPACE"," ",153],["T_DNUMBER","2.45",153],",",["T_WHITESPACE","\n                    ",153],["T_CONSTANT_ENCAPSED_STRING","'shipping_discount_tax_compensation_amount'",154],["T_WHITESPACE"," ",154],["T_DOUBLE_ARROW","=>",154],["T_WHITESPACE"," ",154],["T_LNUMBER","0",154],",",["T_WHITESPACE","\n                    ",154],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_discount_tax_compensation_amount'",155],["T_WHITESPACE"," ",155],["T_DOUBLE_ARROW","=>",155],["T_WHITESPACE"," ",155],["T_LNUMBER","0",155],",",["T_WHITESPACE","\n                    ",155],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",156],["T_WHITESPACE"," ",156],["T_DOUBLE_ARROW","=>",156],["T_WHITESPACE"," ",156],["T_DNUMBER","53.56",156],",",["T_WHITESPACE","\n                    ",156],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",157],["T_WHITESPACE"," ",157],["T_DOUBLE_ARROW","=>",157],["T_WHITESPACE"," ",157],["T_DNUMBER","53.56",157],",",["T_WHITESPACE","\n                    ",157],["T_CONSTANT_ENCAPSED_STRING","'tax_invoiced'",158],["T_WHITESPACE"," ",158],["T_DOUBLE_ARROW","=>",158],["T_WHITESPACE"," ",158],["T_DNUMBER","24.33",158],",",["T_WHITESPACE","\n                    ",158],["T_CONSTANT_ENCAPSED_STRING","'base_tax_invoiced'",159],["T_WHITESPACE"," ",159],["T_DOUBLE_ARROW","=>",159],["T_WHITESPACE"," ",159],["T_DNUMBER","24.33",159],",",["T_WHITESPACE","\n                    ",159],["T_CONSTANT_ENCAPSED_STRING","'tax_refunded'",160],["T_WHITESPACE"," ",160],["T_DOUBLE_ARROW","=>",160],["T_WHITESPACE"," ",160],["T_LNUMBER","0",160],",",["T_WHITESPACE","\n                    ",160],["T_CONSTANT_ENCAPSED_STRING","'base_tax_refunded'",161],["T_WHITESPACE"," ",161],["T_DOUBLE_ARROW","=>",161],["T_WHITESPACE"," ",161],["T_LNUMBER","0",161],",",["T_WHITESPACE","\n                    ",161],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_amount'",162],["T_WHITESPACE"," ",162],["T_DOUBLE_ARROW","=>",162],["T_WHITESPACE"," ",162],["T_LNUMBER","30",162],",",["T_WHITESPACE","\n                ",162],"]",",",["T_WHITESPACE","\n            ",163],"]",",",["T_WHITESPACE","\n            ",164],["T_CONSTANT_ENCAPSED_STRING","'creditmemo_data'",165],["T_WHITESPACE"," ",165],["T_DOUBLE_ARROW","=>",165],["T_WHITESPACE"," ",165],"[",["T_WHITESPACE","\n                ",165],["T_CONSTANT_ENCAPSED_STRING","'items'",166],["T_WHITESPACE"," ",166],["T_DOUBLE_ARROW","=>",166],["T_WHITESPACE"," ",166],"[",["T_WHITESPACE","\n                    ",166],["T_CONSTANT_ENCAPSED_STRING","'item_1'",167],["T_WHITESPACE"," ",167],["T_DOUBLE_ARROW","=>",167],["T_WHITESPACE"," ",167],"[",["T_WHITESPACE","\n                        ",167],["T_CONSTANT_ENCAPSED_STRING","'order_item'",168],["T_WHITESPACE"," ",168],["T_DOUBLE_ARROW","=>",168],["T_WHITESPACE"," ",168],"[",["T_WHITESPACE","\n                            ",168],["T_CONSTANT_ENCAPSED_STRING","'qty_invoiced'",169],["T_WHITESPACE"," ",169],["T_DOUBLE_ARROW","=>",169],["T_WHITESPACE"," ",169],["T_LNUMBER","1",169],",",["T_WHITESPACE","\n                            ",169],["T_CONSTANT_ENCAPSED_STRING","'tax_invoiced'",170],["T_WHITESPACE"," ",170],["T_DOUBLE_ARROW","=>",170],["T_WHITESPACE"," ",170],["T_DNUMBER","8.11",170],",",["T_WHITESPACE","\n                            ",170],["T_CONSTANT_ENCAPSED_STRING","'tax_refunded'",171],["T_WHITESPACE"," ",171],["T_DOUBLE_ARROW","=>",171],["T_WHITESPACE"," ",171],["T_LNUMBER","0",171],",",["T_WHITESPACE","\n                            ",171],["T_CONSTANT_ENCAPSED_STRING","'base_tax_invoiced'",172],["T_WHITESPACE"," ",172],["T_DOUBLE_ARROW","=>",172],["T_WHITESPACE"," ",172],["T_DNUMBER","8.11",172],",",["T_WHITESPACE","\n                            ",172],["T_CONSTANT_ENCAPSED_STRING","'base_tax_refunded'",173],["T_WHITESPACE"," ",173],["T_DOUBLE_ARROW","=>",173],["T_WHITESPACE"," ",173],["T_LNUMBER","0",173],",",["T_WHITESPACE","\n                            ",173],["T_CONSTANT_ENCAPSED_STRING","'discount_tax_compensation_amount'",174],["T_WHITESPACE"," ",174],["T_DOUBLE_ARROW","=>",174],["T_WHITESPACE"," ",174],["T_LNUMBER","0",174],",",["T_WHITESPACE","\n                            ",174],["T_CONSTANT_ENCAPSED_STRING","'base_discount_tax_compensation_amount'",175],["T_WHITESPACE"," ",175],["T_DOUBLE_ARROW","=>",175],["T_WHITESPACE"," ",175],["T_LNUMBER","0",175],",",["T_WHITESPACE","\n                            ",175],["T_CONSTANT_ENCAPSED_STRING","'qty_refunded'",176],["T_WHITESPACE"," ",176],["T_DOUBLE_ARROW","=>",176],["T_WHITESPACE"," ",176],["T_LNUMBER","0",176],",",["T_WHITESPACE","\n                        ",176],"]",",",["T_WHITESPACE","\n                        ",177],["T_CONSTANT_ENCAPSED_STRING","'is_last'",178],["T_WHITESPACE"," ",178],["T_DOUBLE_ARROW","=>",178],["T_WHITESPACE"," ",178],["T_STRING","false",178],",",["T_WHITESPACE","\n                        ",178],["T_CONSTANT_ENCAPSED_STRING","'qty'",179],["T_WHITESPACE"," ",179],["T_DOUBLE_ARROW","=>",179],["T_WHITESPACE"," ",179],["T_LNUMBER","1",179],",",["T_WHITESPACE","\n                    ",179],"]",",",["T_WHITESPACE","\n                    ",180],["T_CONSTANT_ENCAPSED_STRING","'item_2'",181],["T_WHITESPACE"," ",181],["T_DOUBLE_ARROW","=>",181],["T_WHITESPACE"," ",181],"[",["T_WHITESPACE","\n                        ",181],["T_CONSTANT_ENCAPSED_STRING","'order_item'",182],["T_WHITESPACE"," ",182],["T_DOUBLE_ARROW","=>",182],["T_WHITESPACE"," ",182],"[",["T_WHITESPACE","\n                            ",182],["T_CONSTANT_ENCAPSED_STRING","'qty_invoiced'",183],["T_WHITESPACE"," ",183],["T_DOUBLE_ARROW","=>",183],["T_WHITESPACE"," ",183],["T_LNUMBER","2",183],",",["T_WHITESPACE","\n                            ",183],["T_CONSTANT_ENCAPSED_STRING","'tax_refunded'",184],["T_WHITESPACE"," ",184],["T_DOUBLE_ARROW","=>",184],["T_WHITESPACE"," ",184],["T_LNUMBER","0",184],",",["T_WHITESPACE","\n                            ",184],["T_CONSTANT_ENCAPSED_STRING","'tax_invoiced'",185],["T_WHITESPACE"," ",185],["T_DOUBLE_ARROW","=>",185],["T_WHITESPACE"," ",185],["T_DNUMBER","16.22",185],",",["T_WHITESPACE","\n                            ",185],["T_CONSTANT_ENCAPSED_STRING","'base_tax_refunded'",186],["T_WHITESPACE"," ",186],["T_DOUBLE_ARROW","=>",186],["T_WHITESPACE"," ",186],["T_LNUMBER","0",186],",",["T_WHITESPACE","\n                            ",186],["T_CONSTANT_ENCAPSED_STRING","'base_tax_invoiced'",187],["T_WHITESPACE"," ",187],["T_DOUBLE_ARROW","=>",187],["T_WHITESPACE"," ",187],["T_DNUMBER","16.22",187],",",["T_WHITESPACE","\n                            ",187],["T_CONSTANT_ENCAPSED_STRING","'discount_tax_compensation_amount'",188],["T_WHITESPACE"," ",188],["T_DOUBLE_ARROW","=>",188],["T_WHITESPACE"," ",188],["T_LNUMBER","0",188],",",["T_WHITESPACE","\n                            ",188],["T_CONSTANT_ENCAPSED_STRING","'base_discount_tax_compensation_amount'",189],["T_WHITESPACE"," ",189],["T_DOUBLE_ARROW","=>",189],["T_WHITESPACE"," ",189],["T_LNUMBER","0",189],",",["T_WHITESPACE","\n                            ",189],["T_CONSTANT_ENCAPSED_STRING","'qty_refunded'",190],["T_WHITESPACE"," ",190],["T_DOUBLE_ARROW","=>",190],["T_WHITESPACE"," ",190],["T_LNUMBER","0",190],",",["T_WHITESPACE","\n                        ",190],"]",",",["T_WHITESPACE","\n                        ",191],["T_CONSTANT_ENCAPSED_STRING","'is_last'",192],["T_WHITESPACE"," ",192],["T_DOUBLE_ARROW","=>",192],["T_WHITESPACE"," ",192],["T_STRING","false",192],",",["T_WHITESPACE","\n                        ",192],["T_CONSTANT_ENCAPSED_STRING","'qty'",193],["T_WHITESPACE"," ",193],["T_DOUBLE_ARROW","=>",193],["T_WHITESPACE"," ",193],["T_LNUMBER","1",193],",",["T_WHITESPACE","\n                    ",193],"]",",",["T_WHITESPACE","\n                ",194],"]",",",["T_WHITESPACE","\n                ",195],["T_CONSTANT_ENCAPSED_STRING","'is_last'",196],["T_WHITESPACE"," ",196],["T_DOUBLE_ARROW","=>",196],["T_WHITESPACE"," ",196],["T_STRING","false",196],",",["T_WHITESPACE","\n                ",196],["T_CONSTANT_ENCAPSED_STRING","'data_fields'",197],["T_WHITESPACE"," ",197],["T_DOUBLE_ARROW","=>",197],["T_WHITESPACE"," ",197],"[",["T_WHITESPACE","\n                    ",197],["T_CONSTANT_ENCAPSED_STRING","'grand_total'",198],["T_WHITESPACE"," ",198],["T_DOUBLE_ARROW","=>",198],["T_WHITESPACE"," ",198],["T_LNUMBER","198",198],",",["T_WHITESPACE","\n                    ",198],["T_CONSTANT_ENCAPSED_STRING","'base_grand_total'",199],["T_WHITESPACE"," ",199],["T_DOUBLE_ARROW","=>",199],["T_WHITESPACE"," ",199],["T_LNUMBER","198",199],",",["T_WHITESPACE","\n                    ",199],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_amount'",200],["T_WHITESPACE"," ",200],["T_DOUBLE_ARROW","=>",200],["T_WHITESPACE"," ",200],["T_LNUMBER","30",200],",",["T_WHITESPACE","\n                    ",200],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",201],["T_WHITESPACE"," ",201],["T_DOUBLE_ARROW","=>",201],["T_WHITESPACE"," ",201],["T_DNUMBER","0.82",201],",",["T_WHITESPACE","\n                    ",201],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",202],["T_WHITESPACE"," ",202],["T_DOUBLE_ARROW","=>",202],["T_WHITESPACE"," ",202],["T_DNUMBER","0.82",202],",",["T_WHITESPACE","\n                    ",202],["T_CONSTANT_ENCAPSED_STRING","'invoice'",203],["T_WHITESPACE"," ",203],["T_DOUBLE_ARROW","=>",203],["T_WHITESPACE"," ",203],["T_NEW","new",203],["T_WHITESPACE"," ",203],["T_STRING","MagentoObject",203],"(",["T_WHITESPACE","\n                            ",203],"[",["T_WHITESPACE","\n                                ",204],["T_CONSTANT_ENCAPSED_STRING","'shipping_tax_amount'",205],["T_WHITESPACE"," ",205],["T_DOUBLE_ARROW","=>",205],["T_WHITESPACE"," ",205],["T_DNUMBER","2.45",205],",",["T_WHITESPACE","\n                                ",205],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_tax_amount'",206],["T_WHITESPACE"," ",206],["T_DOUBLE_ARROW","=>",206],["T_WHITESPACE"," ",206],["T_DNUMBER","2.45",206],",",["T_WHITESPACE","\n                                ",206],["T_CONSTANT_ENCAPSED_STRING","'shipping_discount_tax_compensation_amount'",207],["T_WHITESPACE"," ",207],["T_DOUBLE_ARROW","=>",207],["T_WHITESPACE"," ",207],["T_LNUMBER","0",207],",",["T_WHITESPACE","\n                                ",207],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_discount_tax_compensation_amount'",208],["T_WHITESPACE"," ",208],["T_DOUBLE_ARROW","=>",208],["T_WHITESPACE"," ",208],["T_LNUMBER","0",208],",",["T_WHITESPACE","\n                            ",208],"]",["T_WHITESPACE","\n                        ",209],")",",",["T_WHITESPACE","\n                ",210],"]",",",["T_WHITESPACE","\n            ",211],"]",",",["T_WHITESPACE","\n            ",212],["T_CONSTANT_ENCAPSED_STRING","'expected_results'",213],["T_WHITESPACE"," ",213],["T_DOUBLE_ARROW","=>",213],["T_WHITESPACE"," ",213],"[",["T_WHITESPACE","\n                ",213],["T_CONSTANT_ENCAPSED_STRING","'creditmemo_items'",214],["T_WHITESPACE"," ",214],["T_DOUBLE_ARROW","=>",214],["T_WHITESPACE"," ",214],"[",["T_WHITESPACE","\n                    ",214],["T_CONSTANT_ENCAPSED_STRING","'item_1'",215],["T_WHITESPACE"," ",215],["T_DOUBLE_ARROW","=>",215],["T_WHITESPACE"," ",215],"[",["T_WHITESPACE","\n                        ",215],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",216],["T_WHITESPACE"," ",216],["T_DOUBLE_ARROW","=>",216],["T_WHITESPACE"," ",216],["T_DNUMBER","8.11",216],",",["T_WHITESPACE","\n                        ",216],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",217],["T_WHITESPACE"," ",217],["T_DOUBLE_ARROW","=>",217],["T_WHITESPACE"," ",217],["T_DNUMBER","8.11",217],",",["T_WHITESPACE","\n                    ",217],"]",",",["T_WHITESPACE","\n                    ",218],["T_CONSTANT_ENCAPSED_STRING","'item_2'",219],["T_WHITESPACE"," ",219],["T_DOUBLE_ARROW","=>",219],["T_WHITESPACE"," ",219],"[",["T_WHITESPACE","\n                        ",219],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",220],["T_WHITESPACE"," ",220],["T_DOUBLE_ARROW","=>",220],["T_WHITESPACE"," ",220],["T_DNUMBER","8.11",220],",",["T_WHITESPACE","\n                        ",220],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",221],["T_WHITESPACE"," ",221],["T_DOUBLE_ARROW","=>",221],["T_WHITESPACE"," ",221],["T_DNUMBER","8.11",221],",",["T_WHITESPACE","\n                    ",221],"]",",",["T_WHITESPACE","\n                ",222],"]",",",["T_WHITESPACE","\n                ",223],["T_CONSTANT_ENCAPSED_STRING","'creditmemo_data'",224],["T_WHITESPACE"," ",224],["T_DOUBLE_ARROW","=>",224],["T_WHITESPACE"," ",224],"[",["T_WHITESPACE","\n                    ",224],["T_CONSTANT_ENCAPSED_STRING","'grand_total'",225],["T_WHITESPACE"," ",225],["T_DOUBLE_ARROW","=>",225],["T_WHITESPACE"," ",225],["T_DNUMBER","216.67",225],",",["T_WHITESPACE","\n                    ",225],["T_CONSTANT_ENCAPSED_STRING","'base_grand_total'",226],["T_WHITESPACE"," ",226],["T_DOUBLE_ARROW","=>",226],["T_WHITESPACE"," ",226],["T_DNUMBER","216.67",226],",",["T_WHITESPACE","\n                    ",226],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",227],["T_WHITESPACE"," ",227],["T_DOUBLE_ARROW","=>",227],["T_WHITESPACE"," ",227],["T_DNUMBER","19.49",227],",",["T_WHITESPACE","\n                    ",227],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",228],["T_WHITESPACE"," ",228],["T_DOUBLE_ARROW","=>",228],["T_WHITESPACE"," ",228],["T_DNUMBER","19.49",228],",",["T_WHITESPACE","\n                    ",228],["T_CONSTANT_ENCAPSED_STRING","'shipping_tax_amount'",229],["T_WHITESPACE"," ",229],["T_DOUBLE_ARROW","=>",229],["T_WHITESPACE"," ",229],["T_DNUMBER","2.45",229],",",["T_WHITESPACE","\n                    ",229],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_tax_amount'",230],["T_WHITESPACE"," ",230],["T_DOUBLE_ARROW","=>",230],["T_WHITESPACE"," ",230],["T_DNUMBER","2.45",230],",",["T_WHITESPACE","\n                ",230],"]",",",["T_WHITESPACE","\n            ",231],"]",",",["T_WHITESPACE","\n        ",232],"]",";",["T_WHITESPACE","\n\n        ",233],["T_VARIABLE","$currencyRatio",235],["T_WHITESPACE"," ",235],"=",["T_WHITESPACE"," ",235],["T_LNUMBER","2",235],";",["T_WHITESPACE","\n        ",235],["T_COMMENT","\/\/ scenario 1: 3 item_1, 3 item_2, $99 each, 8.19 tax rate\n",236],["T_WHITESPACE","        ",237],["T_COMMENT","\/\/ 1 item_1 and 2 item_2 are invoiced and base currency <> display currency\n",237],["T_WHITESPACE","        ",238],["T_VARIABLE","$result",238],"[",["T_CONSTANT_ENCAPSED_STRING","'partial_invoice_partial_creditmemo_different_currencies'",238],"]",["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],"[",["T_WHITESPACE","\n            ",238],["T_CONSTANT_ENCAPSED_STRING","'order_data'",239],["T_WHITESPACE"," ",239],["T_DOUBLE_ARROW","=>",239],["T_WHITESPACE"," ",239],"[",["T_WHITESPACE","\n                ",239],["T_CONSTANT_ENCAPSED_STRING","'data_fields'",240],["T_WHITESPACE"," ",240],["T_DOUBLE_ARROW","=>",240],["T_WHITESPACE"," ",240],"[",["T_WHITESPACE","\n                    ",240],["T_CONSTANT_ENCAPSED_STRING","'shipping_tax_amount'",241],["T_WHITESPACE"," ",241],["T_DOUBLE_ARROW","=>",241],["T_WHITESPACE"," ",241],["T_DNUMBER","2.45",241],["T_WHITESPACE"," ",241],"*",["T_WHITESPACE"," ",241],["T_VARIABLE","$currencyRatio",241],",",["T_WHITESPACE","\n                    ",241],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_tax_amount'",242],["T_WHITESPACE"," ",242],["T_DOUBLE_ARROW","=>",242],["T_WHITESPACE"," ",242],["T_DNUMBER","2.45",242],",",["T_WHITESPACE","\n                    ",242],["T_CONSTANT_ENCAPSED_STRING","'shipping_discount_tax_compensation_amount'",243],["T_WHITESPACE"," ",243],["T_DOUBLE_ARROW","=>",243],["T_WHITESPACE"," ",243],["T_DNUMBER","0.00",243],",",["T_WHITESPACE","\n                    ",243],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_discount_tax_compensation_amount'",244],["T_WHITESPACE"," ",244],["T_DOUBLE_ARROW","=>",244],["T_WHITESPACE"," ",244],["T_DNUMBER","0.00",244],",",["T_WHITESPACE","\n                    ",244],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",245],["T_WHITESPACE"," ",245],["T_DOUBLE_ARROW","=>",245],["T_WHITESPACE"," ",245],["T_DNUMBER","53.56",245],["T_WHITESPACE"," ",245],"*",["T_WHITESPACE"," ",245],["T_VARIABLE","$currencyRatio",245],",",["T_WHITESPACE","\n                    ",245],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",246],["T_WHITESPACE"," ",246],["T_DOUBLE_ARROW","=>",246],["T_WHITESPACE"," ",246],["T_DNUMBER","53.56",246],",",["T_WHITESPACE","\n                    ",246],["T_CONSTANT_ENCAPSED_STRING","'tax_invoiced'",247],["T_WHITESPACE"," ",247],["T_DOUBLE_ARROW","=>",247],["T_WHITESPACE"," ",247],["T_DNUMBER","24.33",247],["T_WHITESPACE"," ",247],"*",["T_WHITESPACE"," ",247],["T_VARIABLE","$currencyRatio",247],",",["T_WHITESPACE","\n                    ",247],["T_CONSTANT_ENCAPSED_STRING","'base_tax_invoiced'",248],["T_WHITESPACE"," ",248],["T_DOUBLE_ARROW","=>",248],["T_WHITESPACE"," ",248],["T_DNUMBER","24.33",248],",",["T_WHITESPACE","\n                    ",248],["T_CONSTANT_ENCAPSED_STRING","'tax_refunded'",249],["T_WHITESPACE"," ",249],["T_DOUBLE_ARROW","=>",249],["T_WHITESPACE"," ",249],["T_DNUMBER","0.00",249],",",["T_WHITESPACE","\n                    ",249],["T_CONSTANT_ENCAPSED_STRING","'base_tax_refunded'",250],["T_WHITESPACE"," ",250],["T_DOUBLE_ARROW","=>",250],["T_WHITESPACE"," ",250],["T_DNUMBER","0.00",250],",",["T_WHITESPACE","\n                    ",250],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_amount'",251],["T_WHITESPACE"," ",251],["T_DOUBLE_ARROW","=>",251],["T_WHITESPACE"," ",251],["T_DNUMBER","30.00",251],",",["T_WHITESPACE","\n                ",251],"]",",",["T_WHITESPACE","\n            ",252],"]",",",["T_WHITESPACE","\n            ",253],["T_CONSTANT_ENCAPSED_STRING","'creditmemo_data'",254],["T_WHITESPACE"," ",254],["T_DOUBLE_ARROW","=>",254],["T_WHITESPACE"," ",254],"[",["T_WHITESPACE","\n                ",254],["T_CONSTANT_ENCAPSED_STRING","'items'",255],["T_WHITESPACE"," ",255],["T_DOUBLE_ARROW","=>",255],["T_WHITESPACE"," ",255],"[",["T_WHITESPACE","\n                    ",255],["T_CONSTANT_ENCAPSED_STRING","'item_1'",256],["T_WHITESPACE"," ",256],["T_DOUBLE_ARROW","=>",256],["T_WHITESPACE"," ",256],"[",["T_WHITESPACE","\n                        ",256],["T_CONSTANT_ENCAPSED_STRING","'order_item'",257],["T_WHITESPACE"," ",257],["T_DOUBLE_ARROW","=>",257],["T_WHITESPACE"," ",257],"[",["T_WHITESPACE","\n                            ",257],["T_CONSTANT_ENCAPSED_STRING","'qty_invoiced'",258],["T_WHITESPACE"," ",258],["T_DOUBLE_ARROW","=>",258],["T_WHITESPACE"," ",258],["T_LNUMBER","1",258],",",["T_WHITESPACE","\n                            ",258],["T_CONSTANT_ENCAPSED_STRING","'tax_invoiced'",259],["T_WHITESPACE"," ",259],["T_DOUBLE_ARROW","=>",259],["T_WHITESPACE"," ",259],["T_DNUMBER","8.11",259],["T_WHITESPACE"," ",259],"*",["T_WHITESPACE"," ",259],["T_VARIABLE","$currencyRatio",259],",",["T_WHITESPACE","\n                            ",259],["T_CONSTANT_ENCAPSED_STRING","'tax_refunded'",260],["T_WHITESPACE"," ",260],["T_DOUBLE_ARROW","=>",260],["T_WHITESPACE"," ",260],["T_LNUMBER","0",260],",",["T_WHITESPACE","\n                            ",260],["T_CONSTANT_ENCAPSED_STRING","'base_tax_invoiced'",261],["T_WHITESPACE"," ",261],["T_DOUBLE_ARROW","=>",261],["T_WHITESPACE"," ",261],["T_DNUMBER","8.11",261],",",["T_WHITESPACE","\n                            ",261],["T_CONSTANT_ENCAPSED_STRING","'base_tax_refunded'",262],["T_WHITESPACE"," ",262],["T_DOUBLE_ARROW","=>",262],["T_WHITESPACE"," ",262],["T_LNUMBER","0",262],",",["T_WHITESPACE","\n                            ",262],["T_CONSTANT_ENCAPSED_STRING","'discount_tax_compensation_amount'",263],["T_WHITESPACE"," ",263],["T_DOUBLE_ARROW","=>",263],["T_WHITESPACE"," ",263],["T_LNUMBER","0",263],",",["T_WHITESPACE","\n                            ",263],["T_CONSTANT_ENCAPSED_STRING","'base_discount_tax_compensation_amount'",264],["T_WHITESPACE"," ",264],["T_DOUBLE_ARROW","=>",264],["T_WHITESPACE"," ",264],["T_LNUMBER","0",264],",",["T_WHITESPACE","\n                            ",264],["T_CONSTANT_ENCAPSED_STRING","'qty_refunded'",265],["T_WHITESPACE"," ",265],["T_DOUBLE_ARROW","=>",265],["T_WHITESPACE"," ",265],["T_LNUMBER","0",265],",",["T_WHITESPACE","\n                        ",265],"]",",",["T_WHITESPACE","\n                        ",266],["T_CONSTANT_ENCAPSED_STRING","'is_last'",267],["T_WHITESPACE"," ",267],["T_DOUBLE_ARROW","=>",267],["T_WHITESPACE"," ",267],["T_STRING","false",267],",",["T_WHITESPACE","\n                        ",267],["T_CONSTANT_ENCAPSED_STRING","'qty'",268],["T_WHITESPACE"," ",268],["T_DOUBLE_ARROW","=>",268],["T_WHITESPACE"," ",268],["T_LNUMBER","1",268],",",["T_WHITESPACE","\n                    ",268],"]",",",["T_WHITESPACE","\n                    ",269],["T_CONSTANT_ENCAPSED_STRING","'item_2'",270],["T_WHITESPACE"," ",270],["T_DOUBLE_ARROW","=>",270],["T_WHITESPACE"," ",270],"[",["T_WHITESPACE","\n                        ",270],["T_CONSTANT_ENCAPSED_STRING","'order_item'",271],["T_WHITESPACE"," ",271],["T_DOUBLE_ARROW","=>",271],["T_WHITESPACE"," ",271],"[",["T_WHITESPACE","\n                            ",271],["T_CONSTANT_ENCAPSED_STRING","'qty_invoiced'",272],["T_WHITESPACE"," ",272],["T_DOUBLE_ARROW","=>",272],["T_WHITESPACE"," ",272],["T_LNUMBER","2",272],",",["T_WHITESPACE","\n                            ",272],["T_CONSTANT_ENCAPSED_STRING","'tax_refunded'",273],["T_WHITESPACE"," ",273],["T_DOUBLE_ARROW","=>",273],["T_WHITESPACE"," ",273],["T_LNUMBER","0",273],",",["T_WHITESPACE","\n                            ",273],["T_CONSTANT_ENCAPSED_STRING","'tax_invoiced'",274],["T_WHITESPACE"," ",274],["T_DOUBLE_ARROW","=>",274],["T_WHITESPACE"," ",274],["T_DNUMBER","16.22",274],["T_WHITESPACE"," ",274],"*",["T_WHITESPACE"," ",274],["T_VARIABLE","$currencyRatio",274],",",["T_WHITESPACE","\n                            ",274],["T_CONSTANT_ENCAPSED_STRING","'base_tax_refunded'",275],["T_WHITESPACE"," ",275],["T_DOUBLE_ARROW","=>",275],["T_WHITESPACE"," ",275],["T_LNUMBER","0",275],",",["T_WHITESPACE","\n                            ",275],["T_CONSTANT_ENCAPSED_STRING","'base_tax_invoiced'",276],["T_WHITESPACE"," ",276],["T_DOUBLE_ARROW","=>",276],["T_WHITESPACE"," ",276],["T_DNUMBER","16.22",276],",",["T_WHITESPACE","\n                            ",276],["T_CONSTANT_ENCAPSED_STRING","'discount_tax_compensation_amount'",277],["T_WHITESPACE"," ",277],["T_DOUBLE_ARROW","=>",277],["T_WHITESPACE"," ",277],["T_LNUMBER","0",277],",",["T_WHITESPACE","\n                            ",277],["T_CONSTANT_ENCAPSED_STRING","'base_discount_tax_compensation_amount'",278],["T_WHITESPACE"," ",278],["T_DOUBLE_ARROW","=>",278],["T_WHITESPACE"," ",278],["T_LNUMBER","0",278],",",["T_WHITESPACE","\n                            ",278],["T_CONSTANT_ENCAPSED_STRING","'qty_refunded'",279],["T_WHITESPACE"," ",279],["T_DOUBLE_ARROW","=>",279],["T_WHITESPACE"," ",279],["T_LNUMBER","0",279],",",["T_WHITESPACE","\n                        ",279],"]",",",["T_WHITESPACE","\n                        ",280],["T_CONSTANT_ENCAPSED_STRING","'is_last'",281],["T_WHITESPACE"," ",281],["T_DOUBLE_ARROW","=>",281],["T_WHITESPACE"," ",281],["T_STRING","false",281],",",["T_WHITESPACE","\n                        ",281],["T_CONSTANT_ENCAPSED_STRING","'qty'",282],["T_WHITESPACE"," ",282],["T_DOUBLE_ARROW","=>",282],["T_WHITESPACE"," ",282],["T_LNUMBER","1",282],",",["T_WHITESPACE","\n                    ",282],"]",",",["T_WHITESPACE","\n                ",283],"]",",",["T_WHITESPACE","\n                ",284],["T_CONSTANT_ENCAPSED_STRING","'is_last'",285],["T_WHITESPACE"," ",285],["T_DOUBLE_ARROW","=>",285],["T_WHITESPACE"," ",285],["T_STRING","false",285],",",["T_WHITESPACE","\n                ",285],["T_CONSTANT_ENCAPSED_STRING","'data_fields'",286],["T_WHITESPACE"," ",286],["T_DOUBLE_ARROW","=>",286],["T_WHITESPACE"," ",286],"[",["T_WHITESPACE","\n                    ",286],["T_CONSTANT_ENCAPSED_STRING","'grand_total'",287],["T_WHITESPACE"," ",287],["T_DOUBLE_ARROW","=>",287],["T_WHITESPACE"," ",287],["T_LNUMBER","198",287],["T_WHITESPACE"," ",287],"*",["T_WHITESPACE"," ",287],["T_VARIABLE","$currencyRatio",287],",",["T_WHITESPACE","\n                    ",287],["T_CONSTANT_ENCAPSED_STRING","'base_grand_total'",288],["T_WHITESPACE"," ",288],["T_DOUBLE_ARROW","=>",288],["T_WHITESPACE"," ",288],["T_LNUMBER","198",288],",",["T_WHITESPACE","\n                    ",288],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_amount'",289],["T_WHITESPACE"," ",289],["T_DOUBLE_ARROW","=>",289],["T_WHITESPACE"," ",289],["T_LNUMBER","30",289],",",["T_WHITESPACE","\n                    ",289],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",290],["T_WHITESPACE"," ",290],["T_DOUBLE_ARROW","=>",290],["T_WHITESPACE"," ",290],["T_DNUMBER","0.82",290],["T_WHITESPACE"," ",290],"*",["T_WHITESPACE"," ",290],["T_VARIABLE","$currencyRatio",290],",",["T_WHITESPACE","\n                    ",290],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",291],["T_WHITESPACE"," ",291],["T_DOUBLE_ARROW","=>",291],["T_WHITESPACE"," ",291],["T_DNUMBER","0.82",291],",",["T_WHITESPACE","\n                    ",291],["T_CONSTANT_ENCAPSED_STRING","'invoice'",292],["T_WHITESPACE"," ",292],["T_DOUBLE_ARROW","=>",292],["T_WHITESPACE"," ",292],["T_NEW","new",292],["T_WHITESPACE"," ",292],["T_STRING","MagentoObject",292],"(",["T_WHITESPACE","\n                        ",292],"[",["T_WHITESPACE","\n                            ",293],["T_CONSTANT_ENCAPSED_STRING","'shipping_tax_amount'",294],["T_WHITESPACE"," ",294],["T_DOUBLE_ARROW","=>",294],["T_WHITESPACE"," ",294],["T_DNUMBER","2.45",294],["T_WHITESPACE"," ",294],"*",["T_WHITESPACE"," ",294],["T_VARIABLE","$currencyRatio",294],",",["T_WHITESPACE","\n                            ",294],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_tax_amount'",295],["T_WHITESPACE"," ",295],["T_DOUBLE_ARROW","=>",295],["T_WHITESPACE"," ",295],["T_DNUMBER","2.45",295],",",["T_WHITESPACE","\n                            ",295],["T_CONSTANT_ENCAPSED_STRING","'shipping_discount_tax_compensation_amount'",296],["T_WHITESPACE"," ",296],["T_DOUBLE_ARROW","=>",296],["T_WHITESPACE"," ",296],["T_LNUMBER","0",296],",",["T_WHITESPACE","\n                            ",296],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_discount_tax_compensation_amount'",297],["T_WHITESPACE"," ",297],["T_DOUBLE_ARROW","=>",297],["T_WHITESPACE"," ",297],["T_LNUMBER","0",297],",",["T_WHITESPACE","\n                        ",297],"]",["T_WHITESPACE","\n                    ",298],")",",",["T_WHITESPACE","\n                ",299],"]",",",["T_WHITESPACE","\n            ",300],"]",",",["T_WHITESPACE","\n            ",301],["T_CONSTANT_ENCAPSED_STRING","'expected_results'",302],["T_WHITESPACE"," ",302],["T_DOUBLE_ARROW","=>",302],["T_WHITESPACE"," ",302],"[",["T_WHITESPACE","\n                ",302],["T_CONSTANT_ENCAPSED_STRING","'creditmemo_items'",303],["T_WHITESPACE"," ",303],["T_DOUBLE_ARROW","=>",303],["T_WHITESPACE"," ",303],"[",["T_WHITESPACE","\n                    ",303],["T_CONSTANT_ENCAPSED_STRING","'item_1'",304],["T_WHITESPACE"," ",304],["T_DOUBLE_ARROW","=>",304],["T_WHITESPACE"," ",304],"[",["T_WHITESPACE","\n                        ",304],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",305],["T_WHITESPACE"," ",305],["T_DOUBLE_ARROW","=>",305],["T_WHITESPACE"," ",305],["T_DNUMBER","8.11",305],["T_WHITESPACE"," ",305],"*",["T_WHITESPACE"," ",305],["T_VARIABLE","$currencyRatio",305],",",["T_WHITESPACE","\n                        ",305],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",306],["T_WHITESPACE"," ",306],["T_DOUBLE_ARROW","=>",306],["T_WHITESPACE"," ",306],["T_DNUMBER","8.11",306],",",["T_WHITESPACE","\n                    ",306],"]",",",["T_WHITESPACE","\n                    ",307],["T_CONSTANT_ENCAPSED_STRING","'item_2'",308],["T_WHITESPACE"," ",308],["T_DOUBLE_ARROW","=>",308],["T_WHITESPACE"," ",308],"[",["T_WHITESPACE","\n                        ",308],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",309],["T_WHITESPACE"," ",309],["T_DOUBLE_ARROW","=>",309],["T_WHITESPACE"," ",309],["T_DNUMBER","8.11",309],["T_WHITESPACE"," ",309],"*",["T_WHITESPACE"," ",309],["T_VARIABLE","$currencyRatio",309],",",["T_WHITESPACE","\n                        ",309],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",310],["T_WHITESPACE"," ",310],["T_DOUBLE_ARROW","=>",310],["T_WHITESPACE"," ",310],["T_DNUMBER","8.11",310],",",["T_WHITESPACE","\n                    ",310],"]",",",["T_WHITESPACE","\n                ",311],"]",",",["T_WHITESPACE","\n                ",312],["T_CONSTANT_ENCAPSED_STRING","'creditmemo_data'",313],["T_WHITESPACE"," ",313],["T_DOUBLE_ARROW","=>",313],["T_WHITESPACE"," ",313],"[",["T_WHITESPACE","\n                    ",313],["T_CONSTANT_ENCAPSED_STRING","'grand_total'",314],["T_WHITESPACE"," ",314],["T_DOUBLE_ARROW","=>",314],["T_WHITESPACE"," ",314],["T_DNUMBER","216.67",314],["T_WHITESPACE"," ",314],"*",["T_WHITESPACE"," ",314],["T_VARIABLE","$currencyRatio",314],",",["T_WHITESPACE","\n                    ",314],["T_CONSTANT_ENCAPSED_STRING","'base_grand_total'",315],["T_WHITESPACE"," ",315],["T_DOUBLE_ARROW","=>",315],["T_WHITESPACE"," ",315],["T_DNUMBER","216.67",315],",",["T_WHITESPACE","\n                    ",315],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",316],["T_WHITESPACE"," ",316],["T_DOUBLE_ARROW","=>",316],["T_WHITESPACE"," ",316],["T_DNUMBER","19.49",316],["T_WHITESPACE"," ",316],"*",["T_WHITESPACE"," ",316],["T_VARIABLE","$currencyRatio",316],",",["T_WHITESPACE","\n                    ",316],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",317],["T_WHITESPACE"," ",317],["T_DOUBLE_ARROW","=>",317],["T_WHITESPACE"," ",317],["T_DNUMBER","19.49",317],",",["T_WHITESPACE","\n                    ",317],["T_CONSTANT_ENCAPSED_STRING","'shipping_tax_amount'",318],["T_WHITESPACE"," ",318],["T_DOUBLE_ARROW","=>",318],["T_WHITESPACE"," ",318],["T_DNUMBER","2.45",318],["T_WHITESPACE"," ",318],"*",["T_WHITESPACE"," ",318],["T_VARIABLE","$currencyRatio",318],",",["T_WHITESPACE","\n                    ",318],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_tax_amount'",319],["T_WHITESPACE"," ",319],["T_DOUBLE_ARROW","=>",319],["T_WHITESPACE"," ",319],["T_DNUMBER","2.45",319],",",["T_WHITESPACE","\n                ",319],"]",",",["T_WHITESPACE","\n            ",320],"]",",",["T_WHITESPACE","\n        ",321],"]",";",["T_WHITESPACE","\n\n        ",322],["T_COMMENT","\/\/ scenario 2: 3 items, 2 invoiced, rowtotal of 150 with 8.25 tax rate\n",324],["T_WHITESPACE","        ",325],["T_COMMENT","\/\/ extra tax amount exist (weee tax), make sure that tax amount\n",325],["T_WHITESPACE","        ",326],["T_COMMENT","\/\/ is not over the amount invoiced\n",326],["T_WHITESPACE","        ",327],["T_VARIABLE","$result",327],"[",["T_CONSTANT_ENCAPSED_STRING","'tax_amount_not_over_invoiced_tax_amount'",327],"]",["T_WHITESPACE"," ",327],"=",["T_WHITESPACE"," ",327],"[",["T_WHITESPACE","\n            ",327],["T_CONSTANT_ENCAPSED_STRING","'order_data'",328],["T_WHITESPACE"," ",328],["T_DOUBLE_ARROW","=>",328],["T_WHITESPACE"," ",328],"[",["T_WHITESPACE","\n                ",328],["T_CONSTANT_ENCAPSED_STRING","'data_fields'",329],["T_WHITESPACE"," ",329],["T_DOUBLE_ARROW","=>",329],["T_WHITESPACE"," ",329],"[",["T_WHITESPACE","\n                    ",329],["T_CONSTANT_ENCAPSED_STRING","'shipping_tax_amount'",330],["T_WHITESPACE"," ",330],["T_DOUBLE_ARROW","=>",330],["T_WHITESPACE"," ",330],["T_DNUMBER","1.24",330],",",["T_WHITESPACE","\n                    ",330],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_tax_amount'",331],["T_WHITESPACE"," ",331],["T_DOUBLE_ARROW","=>",331],["T_WHITESPACE"," ",331],["T_DNUMBER","1.24",331],",",["T_WHITESPACE","\n                    ",331],["T_CONSTANT_ENCAPSED_STRING","'shipping_discount_tax_compensation_amount'",332],["T_WHITESPACE"," ",332],["T_DOUBLE_ARROW","=>",332],["T_WHITESPACE"," ",332],["T_LNUMBER","0",332],",",["T_WHITESPACE","\n                    ",332],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_discount_tax_compensation_amount'",333],["T_WHITESPACE"," ",333],["T_DOUBLE_ARROW","=>",333],["T_WHITESPACE"," ",333],["T_LNUMBER","0",333],",",["T_WHITESPACE","\n                    ",333],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",334],["T_WHITESPACE"," ",334],["T_DOUBLE_ARROW","=>",334],["T_WHITESPACE"," ",334],["T_DNUMBER","16.09",334],",",["T_WHITESPACE","\n                    ",334],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",335],["T_WHITESPACE"," ",335],["T_DOUBLE_ARROW","=>",335],["T_WHITESPACE"," ",335],["T_DNUMBER","16.09",335],",",["T_WHITESPACE","\n                    ",335],["T_CONSTANT_ENCAPSED_STRING","'tax_invoiced'",336],["T_WHITESPACE"," ",336],["T_DOUBLE_ARROW","=>",336],["T_WHITESPACE"," ",336],["T_DNUMBER","11.14",336],",",["T_WHITESPACE","\n                    ",336],["T_CONSTANT_ENCAPSED_STRING","'base_tax_invoiced'",337],["T_WHITESPACE"," ",337],["T_DOUBLE_ARROW","=>",337],["T_WHITESPACE"," ",337],["T_DNUMBER","11.14",337],",",["T_WHITESPACE","\n                    ",337],["T_CONSTANT_ENCAPSED_STRING","'tax_refunded'",338],["T_WHITESPACE"," ",338],["T_DOUBLE_ARROW","=>",338],["T_WHITESPACE"," ",338],["T_LNUMBER","0",338],",",["T_WHITESPACE","\n                    ",338],["T_CONSTANT_ENCAPSED_STRING","'base_tax_refunded'",339],["T_WHITESPACE"," ",339],["T_DOUBLE_ARROW","=>",339],["T_WHITESPACE"," ",339],["T_LNUMBER","0",339],",",["T_WHITESPACE","\n                    ",339],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_amount'",340],["T_WHITESPACE"," ",340],["T_DOUBLE_ARROW","=>",340],["T_WHITESPACE"," ",340],["T_LNUMBER","30",340],",",["T_WHITESPACE","\n                ",340],"]",",",["T_WHITESPACE","\n            ",341],"]",",",["T_WHITESPACE","\n            ",342],["T_CONSTANT_ENCAPSED_STRING","'creditmemo_data'",343],["T_WHITESPACE"," ",343],["T_DOUBLE_ARROW","=>",343],["T_WHITESPACE"," ",343],"[",["T_WHITESPACE","\n                ",343],["T_CONSTANT_ENCAPSED_STRING","'items'",344],["T_WHITESPACE"," ",344],["T_DOUBLE_ARROW","=>",344],["T_WHITESPACE"," ",344],"[",["T_WHITESPACE","\n                    ",344],["T_CONSTANT_ENCAPSED_STRING","'item_1'",345],["T_WHITESPACE"," ",345],["T_DOUBLE_ARROW","=>",345],["T_WHITESPACE"," ",345],"[",["T_WHITESPACE","\n                        ",345],["T_CONSTANT_ENCAPSED_STRING","'order_item'",346],["T_WHITESPACE"," ",346],["T_DOUBLE_ARROW","=>",346],["T_WHITESPACE"," ",346],"[",["T_WHITESPACE","\n                            ",346],["T_CONSTANT_ENCAPSED_STRING","'qty_invoiced'",347],["T_WHITESPACE"," ",347],["T_DOUBLE_ARROW","=>",347],["T_WHITESPACE"," ",347],["T_LNUMBER","2",347],",",["T_WHITESPACE","\n                            ",347],["T_CONSTANT_ENCAPSED_STRING","'tax_invoiced'",348],["T_WHITESPACE"," ",348],["T_DOUBLE_ARROW","=>",348],["T_WHITESPACE"," ",348],["T_DNUMBER","8.26",348],",",["T_WHITESPACE","\n                            ",348],["T_CONSTANT_ENCAPSED_STRING","'tax_refunded'",349],["T_WHITESPACE"," ",349],["T_DOUBLE_ARROW","=>",349],["T_WHITESPACE"," ",349],["T_LNUMBER","0",349],",",["T_WHITESPACE","\n                            ",349],["T_CONSTANT_ENCAPSED_STRING","'base_tax_invoiced'",350],["T_WHITESPACE"," ",350],["T_DOUBLE_ARROW","=>",350],["T_WHITESPACE"," ",350],["T_DNUMBER","8.26",350],",",["T_WHITESPACE","\n                            ",350],["T_CONSTANT_ENCAPSED_STRING","'base_tax_refunded'",351],["T_WHITESPACE"," ",351],["T_DOUBLE_ARROW","=>",351],["T_WHITESPACE"," ",351],["T_LNUMBER","0",351],",",["T_WHITESPACE","\n                            ",351],["T_CONSTANT_ENCAPSED_STRING","'discount_tax_compensation_amount'",352],["T_WHITESPACE"," ",352],["T_DOUBLE_ARROW","=>",352],["T_WHITESPACE"," ",352],["T_LNUMBER","0",352],",",["T_WHITESPACE","\n                            ",352],["T_CONSTANT_ENCAPSED_STRING","'base_discount_tax_compensation_amount'",353],["T_WHITESPACE"," ",353],["T_DOUBLE_ARROW","=>",353],["T_WHITESPACE"," ",353],["T_LNUMBER","0",353],",",["T_WHITESPACE","\n                            ",353],["T_CONSTANT_ENCAPSED_STRING","'qty_refunded'",354],["T_WHITESPACE"," ",354],["T_DOUBLE_ARROW","=>",354],["T_WHITESPACE"," ",354],["T_LNUMBER","0",354],",",["T_WHITESPACE","\n                        ",354],"]",",",["T_WHITESPACE","\n                        ",355],["T_CONSTANT_ENCAPSED_STRING","'is_last'",356],["T_WHITESPACE"," ",356],["T_DOUBLE_ARROW","=>",356],["T_WHITESPACE"," ",356],["T_STRING","false",356],",",["T_WHITESPACE","\n                        ",356],["T_CONSTANT_ENCAPSED_STRING","'qty'",357],["T_WHITESPACE"," ",357],["T_DOUBLE_ARROW","=>",357],["T_WHITESPACE"," ",357],["T_LNUMBER","2",357],",",["T_WHITESPACE","\n                    ",357],"]",",",["T_WHITESPACE","\n                ",358],"]",",",["T_WHITESPACE","\n                ",359],["T_CONSTANT_ENCAPSED_STRING","'is_last'",360],["T_WHITESPACE"," ",360],["T_DOUBLE_ARROW","=>",360],["T_WHITESPACE"," ",360],["T_STRING","false",360],",",["T_WHITESPACE","\n                ",360],["T_CONSTANT_ENCAPSED_STRING","'data_fields'",361],["T_WHITESPACE"," ",361],["T_DOUBLE_ARROW","=>",361],["T_WHITESPACE"," ",361],"[",["T_WHITESPACE","\n                    ",361],["T_CONSTANT_ENCAPSED_STRING","'grand_total'",362],["T_WHITESPACE"," ",362],["T_DOUBLE_ARROW","=>",362],["T_WHITESPACE"," ",362],["T_DNUMBER","136.65",362],",",["T_WHITESPACE","\n                    ",362],["T_CONSTANT_ENCAPSED_STRING","'base_grand_total'",363],["T_WHITESPACE"," ",363],["T_DOUBLE_ARROW","=>",363],["T_WHITESPACE"," ",363],["T_DNUMBER","136.65",363],",",["T_WHITESPACE","\n                    ",363],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_amount'",364],["T_WHITESPACE"," ",364],["T_DOUBLE_ARROW","=>",364],["T_WHITESPACE"," ",364],["T_LNUMBER","30",364],",",["T_WHITESPACE","\n                    ",364],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",365],["T_WHITESPACE"," ",365],["T_DOUBLE_ARROW","=>",365],["T_WHITESPACE"," ",365],["T_DNUMBER","1.65",365],",",["T_WHITESPACE","\n                    ",365],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",366],["T_WHITESPACE"," ",366],["T_DOUBLE_ARROW","=>",366],["T_WHITESPACE"," ",366],["T_DNUMBER","1.65",366],",",["T_WHITESPACE","\n                    ",366],["T_CONSTANT_ENCAPSED_STRING","'invoice'",367],["T_WHITESPACE"," ",367],["T_DOUBLE_ARROW","=>",367],["T_WHITESPACE"," ",367],["T_NEW","new",367],["T_WHITESPACE"," ",367],["T_STRING","MagentoObject",367],"(",["T_WHITESPACE","\n                            ",367],"[",["T_WHITESPACE","\n                                ",368],["T_CONSTANT_ENCAPSED_STRING","'shipping_tax_amount'",369],["T_WHITESPACE"," ",369],["T_DOUBLE_ARROW","=>",369],["T_WHITESPACE"," ",369],["T_DNUMBER","1.24",369],",",["T_WHITESPACE","\n                                ",369],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_tax_amount'",370],["T_WHITESPACE"," ",370],["T_DOUBLE_ARROW","=>",370],["T_WHITESPACE"," ",370],["T_DNUMBER","1.24",370],",",["T_WHITESPACE","\n                                ",370],["T_CONSTANT_ENCAPSED_STRING","'shipping_discount_tax_compensation_amount'",371],["T_WHITESPACE"," ",371],["T_DOUBLE_ARROW","=>",371],["T_WHITESPACE"," ",371],["T_LNUMBER","0",371],",",["T_WHITESPACE","\n                                ",371],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_discount_tax_compensation_amount'",372],["T_WHITESPACE"," ",372],["T_DOUBLE_ARROW","=>",372],["T_WHITESPACE"," ",372],["T_LNUMBER","0",372],",",["T_WHITESPACE","\n                            ",372],"]",["T_WHITESPACE","\n                        ",373],")",",",["T_WHITESPACE","\n                ",374],"]",",",["T_WHITESPACE","\n            ",375],"]",",",["T_WHITESPACE","\n            ",376],["T_CONSTANT_ENCAPSED_STRING","'expected_results'",377],["T_WHITESPACE"," ",377],["T_DOUBLE_ARROW","=>",377],["T_WHITESPACE"," ",377],"[",["T_WHITESPACE","\n                ",377],["T_CONSTANT_ENCAPSED_STRING","'creditmemo_items'",378],["T_WHITESPACE"," ",378],["T_DOUBLE_ARROW","=>",378],["T_WHITESPACE"," ",378],"[",["T_WHITESPACE","\n                    ",378],["T_CONSTANT_ENCAPSED_STRING","'item_1'",379],["T_WHITESPACE"," ",379],["T_DOUBLE_ARROW","=>",379],["T_WHITESPACE"," ",379],"[",["T_WHITESPACE","\n                        ",379],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",380],["T_WHITESPACE"," ",380],["T_DOUBLE_ARROW","=>",380],["T_WHITESPACE"," ",380],["T_DNUMBER","8.26",380],",",["T_WHITESPACE","\n                        ",380],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",381],["T_WHITESPACE"," ",381],["T_DOUBLE_ARROW","=>",381],["T_WHITESPACE"," ",381],["T_DNUMBER","8.26",381],",",["T_WHITESPACE","\n                    ",381],"]",",",["T_WHITESPACE","\n                ",382],"]",",",["T_WHITESPACE","\n                ",383],["T_CONSTANT_ENCAPSED_STRING","'creditmemo_data'",384],["T_WHITESPACE"," ",384],["T_DOUBLE_ARROW","=>",384],["T_WHITESPACE"," ",384],"[",["T_WHITESPACE","\n                    ",384],["T_CONSTANT_ENCAPSED_STRING","'grand_total'",385],["T_WHITESPACE"," ",385],["T_DOUBLE_ARROW","=>",385],["T_WHITESPACE"," ",385],["T_DNUMBER","146.14",385],",",["T_WHITESPACE","\n                    ",385],["T_CONSTANT_ENCAPSED_STRING","'base_grand_total'",386],["T_WHITESPACE"," ",386],["T_DOUBLE_ARROW","=>",386],["T_WHITESPACE"," ",386],["T_DNUMBER","146.14",386],",",["T_WHITESPACE","\n                    ",386],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",387],["T_WHITESPACE"," ",387],["T_DOUBLE_ARROW","=>",387],["T_WHITESPACE"," ",387],["T_DNUMBER","11.14",387],",",["T_WHITESPACE","\n                    ",387],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",388],["T_WHITESPACE"," ",388],["T_DOUBLE_ARROW","=>",388],["T_WHITESPACE"," ",388],["T_DNUMBER","11.14",388],",",["T_WHITESPACE","\n                    ",388],["T_CONSTANT_ENCAPSED_STRING","'shipping_tax_amount'",389],["T_WHITESPACE"," ",389],["T_DOUBLE_ARROW","=>",389],["T_WHITESPACE"," ",389],["T_DNUMBER","1.24",389],",",["T_WHITESPACE","\n                    ",389],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_tax_amount'",390],["T_WHITESPACE"," ",390],["T_DOUBLE_ARROW","=>",390],["T_WHITESPACE"," ",390],["T_DNUMBER","1.24",390],",",["T_WHITESPACE","\n                ",390],"]",",",["T_WHITESPACE","\n            ",391],"]",",",["T_WHITESPACE","\n        ",392],"]",";",["T_WHITESPACE","\n\n        ",393],["T_COMMENT","\/\/ scenario 3: 3 items, 3 invoiced, rowtotal of 150 with 8.25 tax rate\n",395],["T_WHITESPACE","        ",396],["T_COMMENT","\/\/ extra tax amount exist (weee tax), make sure that tax amount\n",396],["T_WHITESPACE","        ",397],["T_COMMENT","\/\/ equals to tax amount invoiced\n",397],["T_WHITESPACE","        ",398],["T_VARIABLE","$result",398],"[",["T_CONSTANT_ENCAPSED_STRING","'last_partial_creditmemo'",398],"]",["T_WHITESPACE"," ",398],"=",["T_WHITESPACE"," ",398],"[",["T_WHITESPACE","\n            ",398],["T_CONSTANT_ENCAPSED_STRING","'order_data'",399],["T_WHITESPACE"," ",399],["T_DOUBLE_ARROW","=>",399],["T_WHITESPACE"," ",399],"[",["T_WHITESPACE","\n                ",399],["T_CONSTANT_ENCAPSED_STRING","'data_fields'",400],["T_WHITESPACE"," ",400],["T_DOUBLE_ARROW","=>",400],["T_WHITESPACE"," ",400],"[",["T_WHITESPACE","\n                    ",400],["T_CONSTANT_ENCAPSED_STRING","'shipping_tax_amount'",401],["T_WHITESPACE"," ",401],["T_DOUBLE_ARROW","=>",401],["T_WHITESPACE"," ",401],["T_DNUMBER","1.24",401],",",["T_WHITESPACE","\n                    ",401],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_tax_amount'",402],["T_WHITESPACE"," ",402],["T_DOUBLE_ARROW","=>",402],["T_WHITESPACE"," ",402],["T_DNUMBER","1.24",402],",",["T_WHITESPACE","\n                    ",402],["T_CONSTANT_ENCAPSED_STRING","'shipping_tax_refunded'",403],["T_WHITESPACE"," ",403],["T_DOUBLE_ARROW","=>",403],["T_WHITESPACE"," ",403],["T_DNUMBER","1.24",403],",",["T_WHITESPACE","\n                    ",403],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_tax_refunded'",404],["T_WHITESPACE"," ",404],["T_DOUBLE_ARROW","=>",404],["T_WHITESPACE"," ",404],["T_DNUMBER","1.24",404],",",["T_WHITESPACE","\n                    ",404],["T_CONSTANT_ENCAPSED_STRING","'shipping_discount_tax_compensation_amount'",405],["T_WHITESPACE"," ",405],["T_DOUBLE_ARROW","=>",405],["T_WHITESPACE"," ",405],["T_LNUMBER","0",405],",",["T_WHITESPACE","\n                    ",405],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_discount_tax_compensation_amount'",406],["T_WHITESPACE"," ",406],["T_DOUBLE_ARROW","=>",406],["T_WHITESPACE"," ",406],["T_LNUMBER","0",406],",",["T_WHITESPACE","\n                    ",406],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",407],["T_WHITESPACE"," ",407],["T_DOUBLE_ARROW","=>",407],["T_WHITESPACE"," ",407],["T_DNUMBER","16.09",407],",",["T_WHITESPACE","\n                    ",407],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",408],["T_WHITESPACE"," ",408],["T_DOUBLE_ARROW","=>",408],["T_WHITESPACE"," ",408],["T_DNUMBER","16.09",408],",",["T_WHITESPACE","\n                    ",408],["T_CONSTANT_ENCAPSED_STRING","'tax_invoiced'",409],["T_WHITESPACE"," ",409],["T_DOUBLE_ARROW","=>",409],["T_WHITESPACE"," ",409],["T_DNUMBER","16.09",409],",",["T_WHITESPACE","\n                    ",409],["T_CONSTANT_ENCAPSED_STRING","'base_tax_invoiced'",410],["T_WHITESPACE"," ",410],["T_DOUBLE_ARROW","=>",410],["T_WHITESPACE"," ",410],["T_DNUMBER","16.09",410],",",["T_WHITESPACE","\n                    ",410],["T_CONSTANT_ENCAPSED_STRING","'tax_refunded'",411],["T_WHITESPACE"," ",411],["T_DOUBLE_ARROW","=>",411],["T_WHITESPACE"," ",411],["T_DNUMBER","11.14",411],",",["T_WHITESPACE","\n                    ",411],["T_CONSTANT_ENCAPSED_STRING","'base_tax_refunded'",412],["T_WHITESPACE"," ",412],["T_DOUBLE_ARROW","=>",412],["T_WHITESPACE"," ",412],["T_DNUMBER","11.14",412],",",["T_WHITESPACE","\n                    ",412],["T_CONSTANT_ENCAPSED_STRING","'shipping_amount'",413],["T_WHITESPACE"," ",413],["T_DOUBLE_ARROW","=>",413],["T_WHITESPACE"," ",413],["T_LNUMBER","15",413],",",["T_WHITESPACE","\n                    ",413],["T_CONSTANT_ENCAPSED_STRING","'shipping_amount_refunded'",414],["T_WHITESPACE"," ",414],["T_DOUBLE_ARROW","=>",414],["T_WHITESPACE"," ",414],["T_LNUMBER","15",414],",",["T_WHITESPACE","\n                    ",414],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_amount'",415],["T_WHITESPACE"," ",415],["T_DOUBLE_ARROW","=>",415],["T_WHITESPACE"," ",415],["T_LNUMBER","15",415],",",["T_WHITESPACE","\n                    ",415],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_amount_refunded'",416],["T_WHITESPACE"," ",416],["T_DOUBLE_ARROW","=>",416],["T_WHITESPACE"," ",416],["T_LNUMBER","15",416],",",["T_WHITESPACE","\n                ",416],"]",",",["T_WHITESPACE","\n            ",417],"]",",",["T_WHITESPACE","\n            ",418],["T_CONSTANT_ENCAPSED_STRING","'creditmemo_data'",419],["T_WHITESPACE"," ",419],["T_DOUBLE_ARROW","=>",419],["T_WHITESPACE"," ",419],"[",["T_WHITESPACE","\n                ",419],["T_CONSTANT_ENCAPSED_STRING","'items'",420],["T_WHITESPACE"," ",420],["T_DOUBLE_ARROW","=>",420],["T_WHITESPACE"," ",420],"[",["T_WHITESPACE","\n                    ",420],["T_CONSTANT_ENCAPSED_STRING","'item_1'",421],["T_WHITESPACE"," ",421],["T_DOUBLE_ARROW","=>",421],["T_WHITESPACE"," ",421],"[",["T_WHITESPACE","\n                        ",421],["T_CONSTANT_ENCAPSED_STRING","'order_item'",422],["T_WHITESPACE"," ",422],["T_DOUBLE_ARROW","=>",422],["T_WHITESPACE"," ",422],"[",["T_WHITESPACE","\n                            ",422],["T_CONSTANT_ENCAPSED_STRING","'qty_invoiced'",423],["T_WHITESPACE"," ",423],["T_DOUBLE_ARROW","=>",423],["T_WHITESPACE"," ",423],["T_LNUMBER","3",423],",",["T_WHITESPACE","\n                            ",423],["T_CONSTANT_ENCAPSED_STRING","'tax_invoiced'",424],["T_WHITESPACE"," ",424],["T_DOUBLE_ARROW","=>",424],["T_WHITESPACE"," ",424],["T_DNUMBER","12.38",424],",",["T_WHITESPACE","\n                            ",424],["T_CONSTANT_ENCAPSED_STRING","'tax_refunded'",425],["T_WHITESPACE"," ",425],["T_DOUBLE_ARROW","=>",425],["T_WHITESPACE"," ",425],["T_DNUMBER","8.26",425],",",["T_WHITESPACE","\n                            ",425],["T_CONSTANT_ENCAPSED_STRING","'base_tax_invoiced'",426],["T_WHITESPACE"," ",426],["T_DOUBLE_ARROW","=>",426],["T_WHITESPACE"," ",426],["T_DNUMBER","12.38",426],",",["T_WHITESPACE","\n                            ",426],["T_CONSTANT_ENCAPSED_STRING","'base_tax_refunded'",427],["T_WHITESPACE"," ",427],["T_DOUBLE_ARROW","=>",427],["T_WHITESPACE"," ",427],["T_DNUMBER","8.26",427],",",["T_WHITESPACE","\n                            ",427],["T_CONSTANT_ENCAPSED_STRING","'discount_tax_compensation_amount'",428],["T_WHITESPACE"," ",428],["T_DOUBLE_ARROW","=>",428],["T_WHITESPACE"," ",428],["T_LNUMBER","0",428],",",["T_WHITESPACE","\n                            ",428],["T_CONSTANT_ENCAPSED_STRING","'base_discount_tax_compensation_amount'",429],["T_WHITESPACE"," ",429],["T_DOUBLE_ARROW","=>",429],["T_WHITESPACE"," ",429],["T_LNUMBER","0",429],",",["T_WHITESPACE","\n                            ",429],["T_CONSTANT_ENCAPSED_STRING","'qty_refunded'",430],["T_WHITESPACE"," ",430],["T_DOUBLE_ARROW","=>",430],["T_WHITESPACE"," ",430],["T_LNUMBER","2",430],",",["T_WHITESPACE","\n                        ",430],"]",",",["T_WHITESPACE","\n                        ",431],["T_CONSTANT_ENCAPSED_STRING","'is_last'",432],["T_WHITESPACE"," ",432],["T_DOUBLE_ARROW","=>",432],["T_WHITESPACE"," ",432],["T_STRING","true",432],",",["T_WHITESPACE","\n                        ",432],["T_CONSTANT_ENCAPSED_STRING","'qty'",433],["T_WHITESPACE"," ",433],["T_DOUBLE_ARROW","=>",433],["T_WHITESPACE"," ",433],["T_LNUMBER","1",433],",",["T_WHITESPACE","\n                    ",433],"]",",",["T_WHITESPACE","\n                ",434],"]",",",["T_WHITESPACE","\n                ",435],["T_CONSTANT_ENCAPSED_STRING","'is_last'",436],["T_WHITESPACE"," ",436],["T_DOUBLE_ARROW","=>",436],["T_WHITESPACE"," ",436],["T_STRING","true",436],",",["T_WHITESPACE","\n                ",436],["T_CONSTANT_ENCAPSED_STRING","'data_fields'",437],["T_WHITESPACE"," ",437],["T_DOUBLE_ARROW","=>",437],["T_WHITESPACE"," ",437],"[",["T_WHITESPACE","\n                    ",437],["T_CONSTANT_ENCAPSED_STRING","'grand_total'",438],["T_WHITESPACE"," ",438],["T_DOUBLE_ARROW","=>",438],["T_WHITESPACE"," ",438],["T_DNUMBER","60.82",438],",",["T_WHITESPACE","\n                    ",438],["T_CONSTANT_ENCAPSED_STRING","'base_grand_total'",439],["T_WHITESPACE"," ",439],["T_DOUBLE_ARROW","=>",439],["T_WHITESPACE"," ",439],["T_DNUMBER","60.82",439],",",["T_WHITESPACE","\n                    ",439],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_amount'",440],["T_WHITESPACE"," ",440],["T_DOUBLE_ARROW","=>",440],["T_WHITESPACE"," ",440],["T_LNUMBER","0",440],",",["T_WHITESPACE","\n                    ",440],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",441],["T_WHITESPACE"," ",441],["T_DOUBLE_ARROW","=>",441],["T_WHITESPACE"," ",441],["T_DNUMBER","0.82",441],",",["T_WHITESPACE","\n                    ",441],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",442],["T_WHITESPACE"," ",442],["T_DOUBLE_ARROW","=>",442],["T_WHITESPACE"," ",442],["T_DNUMBER","0.82",442],",",["T_WHITESPACE","\n                    ",442],["T_CONSTANT_ENCAPSED_STRING","'invoice'",443],["T_WHITESPACE"," ",443],["T_DOUBLE_ARROW","=>",443],["T_WHITESPACE"," ",443],["T_NEW","new",443],["T_WHITESPACE"," ",443],["T_STRING","MagentoObject",443],"(",["T_WHITESPACE","\n                            ",443],"[",["T_WHITESPACE","\n                                ",444],["T_CONSTANT_ENCAPSED_STRING","'shipping_tax_amount'",445],["T_WHITESPACE"," ",445],["T_DOUBLE_ARROW","=>",445],["T_WHITESPACE"," ",445],["T_DNUMBER","1.24",445],",",["T_WHITESPACE","\n                                ",445],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_tax_amount'",446],["T_WHITESPACE"," ",446],["T_DOUBLE_ARROW","=>",446],["T_WHITESPACE"," ",446],["T_DNUMBER","1.24",446],",",["T_WHITESPACE","\n                                ",446],["T_CONSTANT_ENCAPSED_STRING","'shipping_discount_tax_compensation_amount'",447],["T_WHITESPACE"," ",447],["T_DOUBLE_ARROW","=>",447],["T_WHITESPACE"," ",447],["T_LNUMBER","0",447],",",["T_WHITESPACE","\n                                ",447],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_discount_tax_compensation_amount'",448],["T_WHITESPACE"," ",448],["T_DOUBLE_ARROW","=>",448],["T_WHITESPACE"," ",448],["T_LNUMBER","0",448],",",["T_WHITESPACE","\n                            ",448],"]",["T_WHITESPACE","\n                        ",449],")",",",["T_WHITESPACE","\n                ",450],"]",",",["T_WHITESPACE","\n            ",451],"]",",",["T_WHITESPACE","\n            ",452],["T_CONSTANT_ENCAPSED_STRING","'expected_results'",453],["T_WHITESPACE"," ",453],["T_DOUBLE_ARROW","=>",453],["T_WHITESPACE"," ",453],"[",["T_WHITESPACE","\n                ",453],["T_CONSTANT_ENCAPSED_STRING","'creditmemo_items'",454],["T_WHITESPACE"," ",454],["T_DOUBLE_ARROW","=>",454],["T_WHITESPACE"," ",454],"[",["T_WHITESPACE","\n                    ",454],["T_CONSTANT_ENCAPSED_STRING","'item_1'",455],["T_WHITESPACE"," ",455],["T_DOUBLE_ARROW","=>",455],["T_WHITESPACE"," ",455],"[",["T_WHITESPACE","\n                        ",455],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",456],["T_WHITESPACE"," ",456],["T_DOUBLE_ARROW","=>",456],["T_WHITESPACE"," ",456],["T_DNUMBER","4.12",456],",",["T_WHITESPACE","\n                        ",456],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",457],["T_WHITESPACE"," ",457],["T_DOUBLE_ARROW","=>",457],["T_WHITESPACE"," ",457],["T_DNUMBER","4.12",457],",",["T_WHITESPACE","\n                    ",457],"]",",",["T_WHITESPACE","\n                ",458],"]",",",["T_WHITESPACE","\n                ",459],["T_CONSTANT_ENCAPSED_STRING","'creditmemo_data'",460],["T_WHITESPACE"," ",460],["T_DOUBLE_ARROW","=>",460],["T_WHITESPACE"," ",460],"[",["T_WHITESPACE","\n                    ",460],["T_CONSTANT_ENCAPSED_STRING","'grand_total'",461],["T_WHITESPACE"," ",461],["T_DOUBLE_ARROW","=>",461],["T_WHITESPACE"," ",461],["T_DNUMBER","64.95",461],",",["T_WHITESPACE","\n                    ",461],["T_CONSTANT_ENCAPSED_STRING","'base_grand_total'",462],["T_WHITESPACE"," ",462],["T_DOUBLE_ARROW","=>",462],["T_WHITESPACE"," ",462],["T_DNUMBER","64.95",462],",",["T_WHITESPACE","\n                    ",462],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",463],["T_WHITESPACE"," ",463],["T_DOUBLE_ARROW","=>",463],["T_WHITESPACE"," ",463],["T_DNUMBER","4.95",463],",",["T_WHITESPACE","\n                    ",463],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",464],["T_WHITESPACE"," ",464],["T_DOUBLE_ARROW","=>",464],["T_WHITESPACE"," ",464],["T_DNUMBER","4.95",464],",",["T_WHITESPACE","\n                ",464],"]",",",["T_WHITESPACE","\n            ",465],"]",",",["T_WHITESPACE","\n        ",466],"]",";",["T_WHITESPACE","\n\n        ",467],["T_COMMENT","\/\/ scenario 4: 3 items, 2 invoiced, price includes tax\n",469],["T_WHITESPACE","        ",470],["T_COMMENT","\/\/ partial credit memo, make sure that discount tax compensation is calculated correctly\n",470],["T_WHITESPACE","        ",471],["T_VARIABLE","$result",471],"[",["T_CONSTANT_ENCAPSED_STRING","'partial_invoice_partial_creditmemo_price_incl_tax'",471],"]",["T_WHITESPACE"," ",471],"=",["T_WHITESPACE"," ",471],"[",["T_WHITESPACE","\n            ",471],["T_CONSTANT_ENCAPSED_STRING","'order_data'",472],["T_WHITESPACE"," ",472],["T_DOUBLE_ARROW","=>",472],["T_WHITESPACE"," ",472],"[",["T_WHITESPACE","\n                ",472],["T_CONSTANT_ENCAPSED_STRING","'data_fields'",473],["T_WHITESPACE"," ",473],["T_DOUBLE_ARROW","=>",473],["T_WHITESPACE"," ",473],"[",["T_WHITESPACE","\n                    ",473],["T_CONSTANT_ENCAPSED_STRING","'shipping_tax_amount'",474],["T_WHITESPACE"," ",474],["T_DOUBLE_ARROW","=>",474],["T_WHITESPACE"," ",474],["T_LNUMBER","0",474],",",["T_WHITESPACE","\n                    ",474],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_tax_amount'",475],["T_WHITESPACE"," ",475],["T_DOUBLE_ARROW","=>",475],["T_WHITESPACE"," ",475],["T_LNUMBER","0",475],",",["T_WHITESPACE","\n                    ",475],["T_CONSTANT_ENCAPSED_STRING","'shipping_tax_refunded'",476],["T_WHITESPACE"," ",476],["T_DOUBLE_ARROW","=>",476],["T_WHITESPACE"," ",476],["T_LNUMBER","0",476],",",["T_WHITESPACE","\n                    ",476],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_tax_refunded'",477],["T_WHITESPACE"," ",477],["T_DOUBLE_ARROW","=>",477],["T_WHITESPACE"," ",477],["T_LNUMBER","0",477],",",["T_WHITESPACE","\n                    ",477],["T_CONSTANT_ENCAPSED_STRING","'shipping_discount_tax_compensation_amount'",478],["T_WHITESPACE"," ",478],["T_DOUBLE_ARROW","=>",478],["T_WHITESPACE"," ",478],["T_LNUMBER","0",478],",",["T_WHITESPACE","\n                    ",478],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_discount_tax_compensation_amount'",479],["T_WHITESPACE"," ",479],["T_DOUBLE_ARROW","=>",479],["T_WHITESPACE"," ",479],["T_LNUMBER","0",479],",",["T_WHITESPACE","\n                    ",479],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",480],["T_WHITESPACE"," ",480],["T_DOUBLE_ARROW","=>",480],["T_WHITESPACE"," ",480],["T_DNUMBER","13.72",480],",",["T_WHITESPACE","\n                    ",480],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",481],["T_WHITESPACE"," ",481],["T_DOUBLE_ARROW","=>",481],["T_WHITESPACE"," ",481],["T_DNUMBER","13.72",481],",",["T_WHITESPACE","\n                    ",481],["T_CONSTANT_ENCAPSED_STRING","'tax_invoiced'",482],["T_WHITESPACE"," ",482],["T_DOUBLE_ARROW","=>",482],["T_WHITESPACE"," ",482],["T_DNUMBER","9.15",482],",",["T_WHITESPACE","\n                    ",482],["T_CONSTANT_ENCAPSED_STRING","'base_tax_invoiced'",483],["T_WHITESPACE"," ",483],["T_DOUBLE_ARROW","=>",483],["T_WHITESPACE"," ",483],["T_DNUMBER","9.15",483],",",["T_WHITESPACE","\n                    ",483],["T_CONSTANT_ENCAPSED_STRING","'tax_refunded'",484],["T_WHITESPACE"," ",484],["T_DOUBLE_ARROW","=>",484],["T_WHITESPACE"," ",484],["T_LNUMBER","0",484],",",["T_WHITESPACE","\n                    ",484],["T_CONSTANT_ENCAPSED_STRING","'base_tax_refunded'",485],["T_WHITESPACE"," ",485],["T_DOUBLE_ARROW","=>",485],["T_WHITESPACE"," ",485],["T_LNUMBER","0",485],",",["T_WHITESPACE","\n                    ",485],["T_CONSTANT_ENCAPSED_STRING","'discount_tax_compensation_amount'",486],["T_WHITESPACE"," ",486],["T_DOUBLE_ARROW","=>",486],["T_WHITESPACE"," ",486],["T_DNUMBER","11.43",486],",",["T_WHITESPACE","\n                    ",486],["T_CONSTANT_ENCAPSED_STRING","'base_discount_tax_compensation_amount'",487],["T_WHITESPACE"," ",487],["T_DOUBLE_ARROW","=>",487],["T_WHITESPACE"," ",487],["T_DNUMBER","11.43",487],",",["T_WHITESPACE","\n                    ",487],["T_CONSTANT_ENCAPSED_STRING","'discount_tax_compensation_invoiced'",488],["T_WHITESPACE"," ",488],["T_DOUBLE_ARROW","=>",488],["T_WHITESPACE"," ",488],["T_DNUMBER","7.62",488],",",["T_WHITESPACE","\n                    ",488],["T_CONSTANT_ENCAPSED_STRING","'base_discount_tax_compensation_invoiced'",489],["T_WHITESPACE"," ",489],["T_DOUBLE_ARROW","=>",489],["T_WHITESPACE"," ",489],["T_DNUMBER","7.62",489],",",["T_WHITESPACE","\n                    ",489],["T_CONSTANT_ENCAPSED_STRING","'discount_tax_compensation_refunded'",490],["T_WHITESPACE"," ",490],["T_DOUBLE_ARROW","=>",490],["T_WHITESPACE"," ",490],["T_LNUMBER","0",490],",",["T_WHITESPACE","\n                    ",490],["T_CONSTANT_ENCAPSED_STRING","'base_discount_tax_compensation_refunded'",491],["T_WHITESPACE"," ",491],["T_DOUBLE_ARROW","=>",491],["T_WHITESPACE"," ",491],["T_LNUMBER","0",491],",",["T_WHITESPACE","\n                    ",491],["T_CONSTANT_ENCAPSED_STRING","'shipping_amount'",492],["T_WHITESPACE"," ",492],["T_DOUBLE_ARROW","=>",492],["T_WHITESPACE"," ",492],["T_LNUMBER","0",492],",",["T_WHITESPACE","\n                    ",492],["T_CONSTANT_ENCAPSED_STRING","'shipping_amount_refunded'",493],["T_WHITESPACE"," ",493],["T_DOUBLE_ARROW","=>",493],["T_WHITESPACE"," ",493],["T_LNUMBER","0",493],",",["T_WHITESPACE","\n                    ",493],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_amount'",494],["T_WHITESPACE"," ",494],["T_DOUBLE_ARROW","=>",494],["T_WHITESPACE"," ",494],["T_LNUMBER","0",494],",",["T_WHITESPACE","\n                    ",494],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_amount_refunded'",495],["T_WHITESPACE"," ",495],["T_DOUBLE_ARROW","=>",495],["T_WHITESPACE"," ",495],["T_LNUMBER","0",495],",",["T_WHITESPACE","\n                ",495],"]",",",["T_WHITESPACE","\n            ",496],"]",",",["T_WHITESPACE","\n            ",497],["T_CONSTANT_ENCAPSED_STRING","'creditmemo_data'",498],["T_WHITESPACE"," ",498],["T_DOUBLE_ARROW","=>",498],["T_WHITESPACE"," ",498],"[",["T_WHITESPACE","\n                ",498],["T_CONSTANT_ENCAPSED_STRING","'items'",499],["T_WHITESPACE"," ",499],["T_DOUBLE_ARROW","=>",499],["T_WHITESPACE"," ",499],"[",["T_WHITESPACE","\n                    ",499],["T_CONSTANT_ENCAPSED_STRING","'item_1'",500],["T_WHITESPACE"," ",500],["T_DOUBLE_ARROW","=>",500],["T_WHITESPACE"," ",500],"[",["T_WHITESPACE","\n                        ",500],["T_CONSTANT_ENCAPSED_STRING","'order_item'",501],["T_WHITESPACE"," ",501],["T_DOUBLE_ARROW","=>",501],["T_WHITESPACE"," ",501],"[",["T_WHITESPACE","\n                            ",501],["T_CONSTANT_ENCAPSED_STRING","'qty_invoiced'",502],["T_WHITESPACE"," ",502],["T_DOUBLE_ARROW","=>",502],["T_WHITESPACE"," ",502],["T_LNUMBER","2",502],",",["T_WHITESPACE","\n                            ",502],["T_CONSTANT_ENCAPSED_STRING","'tax_invoiced'",503],["T_WHITESPACE"," ",503],["T_DOUBLE_ARROW","=>",503],["T_WHITESPACE"," ",503],["T_DNUMBER","7.62",503],",",["T_WHITESPACE","\n                            ",503],["T_CONSTANT_ENCAPSED_STRING","'tax_refunded'",504],["T_WHITESPACE"," ",504],["T_DOUBLE_ARROW","=>",504],["T_WHITESPACE"," ",504],["T_LNUMBER","0",504],",",["T_WHITESPACE","\n                            ",504],["T_CONSTANT_ENCAPSED_STRING","'base_tax_invoiced'",505],["T_WHITESPACE"," ",505],["T_DOUBLE_ARROW","=>",505],["T_WHITESPACE"," ",505],["T_DNUMBER","7.62",505],",",["T_WHITESPACE","\n                            ",505],["T_CONSTANT_ENCAPSED_STRING","'base_tax_refunded'",506],["T_WHITESPACE"," ",506],["T_DOUBLE_ARROW","=>",506],["T_WHITESPACE"," ",506],["T_LNUMBER","0",506],",",["T_WHITESPACE","\n                            ",506],["T_CONSTANT_ENCAPSED_STRING","'discount_tax_compensation_amount'",507],["T_WHITESPACE"," ",507],["T_DOUBLE_ARROW","=>",507],["T_WHITESPACE"," ",507],["T_DNUMBER","11.43",507],",",["T_WHITESPACE","\n                            ",507],["T_CONSTANT_ENCAPSED_STRING","'base_discount_tax_compensation_amount'",508],["T_WHITESPACE"," ",508],["T_DOUBLE_ARROW","=>",508],["T_WHITESPACE"," ",508],["T_DNUMBER","11.43",508],",",["T_WHITESPACE","\n                            ",508],["T_CONSTANT_ENCAPSED_STRING","'discount_tax_compensation_invoiced'",509],["T_WHITESPACE"," ",509],["T_DOUBLE_ARROW","=>",509],["T_WHITESPACE"," ",509],["T_DNUMBER","7.62",509],",",["T_WHITESPACE","\n                            ",509],["T_CONSTANT_ENCAPSED_STRING","'base_discount_tax_compensation_invoiced'",510],["T_WHITESPACE"," ",510],["T_DOUBLE_ARROW","=>",510],["T_WHITESPACE"," ",510],["T_DNUMBER","7.62",510],",",["T_WHITESPACE","\n                            ",510],["T_CONSTANT_ENCAPSED_STRING","'qty_refunded'",511],["T_WHITESPACE"," ",511],["T_DOUBLE_ARROW","=>",511],["T_WHITESPACE"," ",511],["T_LNUMBER","0",511],",",["T_WHITESPACE","\n                        ",511],"]",",",["T_WHITESPACE","\n                        ",512],["T_CONSTANT_ENCAPSED_STRING","'is_last'",513],["T_WHITESPACE"," ",513],["T_DOUBLE_ARROW","=>",513],["T_WHITESPACE"," ",513],["T_STRING","false",513],",",["T_WHITESPACE","\n                        ",513],["T_CONSTANT_ENCAPSED_STRING","'qty'",514],["T_WHITESPACE"," ",514],["T_DOUBLE_ARROW","=>",514],["T_WHITESPACE"," ",514],["T_LNUMBER","1",514],",",["T_WHITESPACE","\n                    ",514],"]",",",["T_WHITESPACE","\n                ",515],"]",",",["T_WHITESPACE","\n                ",516],["T_CONSTANT_ENCAPSED_STRING","'is_last'",517],["T_WHITESPACE"," ",517],["T_DOUBLE_ARROW","=>",517],["T_WHITESPACE"," ",517],["T_STRING","false",517],",",["T_WHITESPACE","\n                ",517],["T_CONSTANT_ENCAPSED_STRING","'data_fields'",518],["T_WHITESPACE"," ",518],["T_DOUBLE_ARROW","=>",518],["T_WHITESPACE"," ",518],"[",["T_WHITESPACE","\n                    ",518],["T_CONSTANT_ENCAPSED_STRING","'grand_total'",519],["T_WHITESPACE"," ",519],["T_DOUBLE_ARROW","=>",519],["T_WHITESPACE"," ",519],["T_DNUMBER","52.38",519],",",["T_WHITESPACE","\n                    ",519],["T_CONSTANT_ENCAPSED_STRING","'base_grand_total'",520],["T_WHITESPACE"," ",520],["T_DOUBLE_ARROW","=>",520],["T_WHITESPACE"," ",520],["T_DNUMBER","52.38",520],",",["T_WHITESPACE","\n                    ",520],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_amount'",521],["T_WHITESPACE"," ",521],["T_DOUBLE_ARROW","=>",521],["T_WHITESPACE"," ",521],["T_LNUMBER","0",521],",",["T_WHITESPACE","\n                    ",521],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",522],["T_WHITESPACE"," ",522],["T_DOUBLE_ARROW","=>",522],["T_WHITESPACE"," ",522],["T_DNUMBER","0.76",522],",",["T_WHITESPACE","\n                    ",522],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",523],["T_WHITESPACE"," ",523],["T_DOUBLE_ARROW","=>",523],["T_WHITESPACE"," ",523],["T_DNUMBER","0.76",523],",",["T_WHITESPACE","\n                    ",523],["T_CONSTANT_ENCAPSED_STRING","'invoice'",524],["T_WHITESPACE"," ",524],["T_DOUBLE_ARROW","=>",524],["T_WHITESPACE"," ",524],["T_NEW","new",524],["T_WHITESPACE"," ",524],["T_STRING","MagentoObject",524],"(",["T_WHITESPACE","\n                            ",524],"[",["T_WHITESPACE","\n                                ",525],["T_CONSTANT_ENCAPSED_STRING","'shipping_tax_amount'",526],["T_WHITESPACE"," ",526],["T_DOUBLE_ARROW","=>",526],["T_WHITESPACE"," ",526],["T_LNUMBER","0",526],",",["T_WHITESPACE","\n                                ",526],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_tax_amount'",527],["T_WHITESPACE"," ",527],["T_DOUBLE_ARROW","=>",527],["T_WHITESPACE"," ",527],["T_LNUMBER","0",527],",",["T_WHITESPACE","\n                                ",527],["T_CONSTANT_ENCAPSED_STRING","'shipping_discount_tax_compensation_amount'",528],["T_WHITESPACE"," ",528],["T_DOUBLE_ARROW","=>",528],["T_WHITESPACE"," ",528],["T_LNUMBER","0",528],",",["T_WHITESPACE","\n                                ",528],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_discount_tax_compensation_amount'",529],["T_WHITESPACE"," ",529],["T_DOUBLE_ARROW","=>",529],["T_WHITESPACE"," ",529],["T_LNUMBER","0",529],",",["T_WHITESPACE","\n                            ",529],"]",["T_WHITESPACE","\n                        ",530],")",",",["T_WHITESPACE","\n                ",531],"]",",",["T_WHITESPACE","\n            ",532],"]",",",["T_WHITESPACE","\n            ",533],["T_CONSTANT_ENCAPSED_STRING","'expected_results'",534],["T_WHITESPACE"," ",534],["T_DOUBLE_ARROW","=>",534],["T_WHITESPACE"," ",534],"[",["T_WHITESPACE","\n                ",534],["T_CONSTANT_ENCAPSED_STRING","'creditmemo_items'",535],["T_WHITESPACE"," ",535],["T_DOUBLE_ARROW","=>",535],["T_WHITESPACE"," ",535],"[",["T_WHITESPACE","\n                    ",535],["T_CONSTANT_ENCAPSED_STRING","'item_1'",536],["T_WHITESPACE"," ",536],["T_DOUBLE_ARROW","=>",536],["T_WHITESPACE"," ",536],"[",["T_WHITESPACE","\n                        ",536],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",537],["T_WHITESPACE"," ",537],["T_DOUBLE_ARROW","=>",537],["T_WHITESPACE"," ",537],["T_DNUMBER","3.81",537],",",["T_WHITESPACE","\n                        ",537],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",538],["T_WHITESPACE"," ",538],["T_DOUBLE_ARROW","=>",538],["T_WHITESPACE"," ",538],["T_DNUMBER","3.81",538],",",["T_WHITESPACE","\n                    ",538],"]",",",["T_WHITESPACE","\n                ",539],"]",",",["T_WHITESPACE","\n                ",540],["T_CONSTANT_ENCAPSED_STRING","'creditmemo_data'",541],["T_WHITESPACE"," ",541],["T_DOUBLE_ARROW","=>",541],["T_WHITESPACE"," ",541],"[",["T_WHITESPACE","\n                    ",541],["T_CONSTANT_ENCAPSED_STRING","'grand_total'",542],["T_WHITESPACE"," ",542],["T_DOUBLE_ARROW","=>",542],["T_WHITESPACE"," ",542],["T_LNUMBER","60",542],",",["T_WHITESPACE","\n                    ",542],["T_CONSTANT_ENCAPSED_STRING","'base_grand_total'",543],["T_WHITESPACE"," ",543],["T_DOUBLE_ARROW","=>",543],["T_WHITESPACE"," ",543],["T_LNUMBER","60",543],",",["T_WHITESPACE","\n                    ",543],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",544],["T_WHITESPACE"," ",544],["T_DOUBLE_ARROW","=>",544],["T_WHITESPACE"," ",544],["T_DNUMBER","4.57",544],",",["T_WHITESPACE","\n                    ",544],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",545],["T_WHITESPACE"," ",545],["T_DOUBLE_ARROW","=>",545],["T_WHITESPACE"," ",545],["T_DNUMBER","4.57",545],",",["T_WHITESPACE","\n                ",545],"]",",",["T_WHITESPACE","\n            ",546],"]",",",["T_WHITESPACE","\n        ",547],"]",";",["T_WHITESPACE","\n\n        ",548],["T_COMMENT","\/\/ scenario 5: 3 items, 3 invoiced, rowtotal of 150 with 8.25 tax rate\n",550],["T_WHITESPACE","        ",551],["T_COMMENT","\/\/ shipping is partially returned\n",551],["T_WHITESPACE","        ",552],["T_VARIABLE","$result",552],"[",["T_CONSTANT_ENCAPSED_STRING","'last_partial_creditmemo_with_partial_shipping_refund'",552],"]",["T_WHITESPACE"," ",552],"=",["T_WHITESPACE"," ",552],"[",["T_WHITESPACE","\n            ",552],["T_CONSTANT_ENCAPSED_STRING","'order_data'",553],["T_WHITESPACE"," ",553],["T_DOUBLE_ARROW","=>",553],["T_WHITESPACE"," ",553],"[",["T_WHITESPACE","\n                ",553],["T_CONSTANT_ENCAPSED_STRING","'data_fields'",554],["T_WHITESPACE"," ",554],["T_DOUBLE_ARROW","=>",554],["T_WHITESPACE"," ",554],"[",["T_WHITESPACE","\n                    ",554],["T_CONSTANT_ENCAPSED_STRING","'shipping_tax_amount'",555],["T_WHITESPACE"," ",555],["T_DOUBLE_ARROW","=>",555],["T_WHITESPACE"," ",555],["T_DNUMBER","1.24",555],",",["T_WHITESPACE","\n                    ",555],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_tax_amount'",556],["T_WHITESPACE"," ",556],["T_DOUBLE_ARROW","=>",556],["T_WHITESPACE"," ",556],["T_DNUMBER","1.24",556],",",["T_WHITESPACE","\n                    ",556],["T_CONSTANT_ENCAPSED_STRING","'shipping_tax_refunded'",557],["T_WHITESPACE"," ",557],["T_DOUBLE_ARROW","=>",557],["T_WHITESPACE"," ",557],["T_LNUMBER","0",557],",",["T_WHITESPACE","\n                    ",557],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_tax_refunded'",558],["T_WHITESPACE"," ",558],["T_DOUBLE_ARROW","=>",558],["T_WHITESPACE"," ",558],["T_LNUMBER","0",558],",",["T_WHITESPACE","\n                    ",558],["T_CONSTANT_ENCAPSED_STRING","'shipping_discount_tax_compensation_amount'",559],["T_WHITESPACE"," ",559],["T_DOUBLE_ARROW","=>",559],["T_WHITESPACE"," ",559],["T_LNUMBER","0",559],",",["T_WHITESPACE","\n                    ",559],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_discount_tax_compensation_amount'",560],["T_WHITESPACE"," ",560],["T_DOUBLE_ARROW","=>",560],["T_WHITESPACE"," ",560],["T_LNUMBER","0",560],",",["T_WHITESPACE","\n                    ",560],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",561],["T_WHITESPACE"," ",561],["T_DOUBLE_ARROW","=>",561],["T_WHITESPACE"," ",561],["T_DNUMBER","16.09",561],",",["T_WHITESPACE","\n                    ",561],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",562],["T_WHITESPACE"," ",562],["T_DOUBLE_ARROW","=>",562],["T_WHITESPACE"," ",562],["T_DNUMBER","16.09",562],",",["T_WHITESPACE","\n                    ",562],["T_CONSTANT_ENCAPSED_STRING","'tax_invoiced'",563],["T_WHITESPACE"," ",563],["T_DOUBLE_ARROW","=>",563],["T_WHITESPACE"," ",563],["T_DNUMBER","16.09",563],",",["T_WHITESPACE","\n                    ",563],["T_CONSTANT_ENCAPSED_STRING","'base_tax_invoiced'",564],["T_WHITESPACE"," ",564],["T_DOUBLE_ARROW","=>",564],["T_WHITESPACE"," ",564],["T_DNUMBER","16.09",564],",",["T_WHITESPACE","\n                    ",564],["T_CONSTANT_ENCAPSED_STRING","'tax_refunded'",565],["T_WHITESPACE"," ",565],["T_DOUBLE_ARROW","=>",565],["T_WHITESPACE"," ",565],["T_DNUMBER","9.9",565],",",["T_WHITESPACE","\n                    ",565],["T_CONSTANT_ENCAPSED_STRING","'base_tax_refunded'",566],["T_WHITESPACE"," ",566],["T_DOUBLE_ARROW","=>",566],["T_WHITESPACE"," ",566],["T_DNUMBER","9.9",566],",",["T_WHITESPACE","\n                    ",566],["T_CONSTANT_ENCAPSED_STRING","'shipping_amount'",567],["T_WHITESPACE"," ",567],["T_DOUBLE_ARROW","=>",567],["T_WHITESPACE"," ",567],["T_LNUMBER","15",567],",",["T_WHITESPACE","\n                    ",567],["T_CONSTANT_ENCAPSED_STRING","'shipping_amount_refunded'",568],["T_WHITESPACE"," ",568],["T_DOUBLE_ARROW","=>",568],["T_WHITESPACE"," ",568],["T_LNUMBER","0",568],",",["T_WHITESPACE","\n                    ",568],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_amount'",569],["T_WHITESPACE"," ",569],["T_DOUBLE_ARROW","=>",569],["T_WHITESPACE"," ",569],["T_LNUMBER","15",569],",",["T_WHITESPACE","\n                    ",569],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_amount_refunded'",570],["T_WHITESPACE"," ",570],["T_DOUBLE_ARROW","=>",570],["T_WHITESPACE"," ",570],["T_LNUMBER","0",570],",",["T_WHITESPACE","\n                ",570],"]",",",["T_WHITESPACE","\n            ",571],"]",",",["T_WHITESPACE","\n            ",572],["T_CONSTANT_ENCAPSED_STRING","'creditmemo_data'",573],["T_WHITESPACE"," ",573],["T_DOUBLE_ARROW","=>",573],["T_WHITESPACE"," ",573],"[",["T_WHITESPACE","\n                ",573],["T_CONSTANT_ENCAPSED_STRING","'items'",574],["T_WHITESPACE"," ",574],["T_DOUBLE_ARROW","=>",574],["T_WHITESPACE"," ",574],"[",["T_WHITESPACE","\n                    ",574],["T_CONSTANT_ENCAPSED_STRING","'item_1'",575],["T_WHITESPACE"," ",575],["T_DOUBLE_ARROW","=>",575],["T_WHITESPACE"," ",575],"[",["T_WHITESPACE","\n                        ",575],["T_CONSTANT_ENCAPSED_STRING","'order_item'",576],["T_WHITESPACE"," ",576],["T_DOUBLE_ARROW","=>",576],["T_WHITESPACE"," ",576],"[",["T_WHITESPACE","\n                            ",576],["T_CONSTANT_ENCAPSED_STRING","'qty_invoiced'",577],["T_WHITESPACE"," ",577],["T_DOUBLE_ARROW","=>",577],["T_WHITESPACE"," ",577],["T_LNUMBER","3",577],",",["T_WHITESPACE","\n                            ",577],["T_CONSTANT_ENCAPSED_STRING","'tax_invoiced'",578],["T_WHITESPACE"," ",578],["T_DOUBLE_ARROW","=>",578],["T_WHITESPACE"," ",578],["T_DNUMBER","12.38",578],",",["T_WHITESPACE","\n                            ",578],["T_CONSTANT_ENCAPSED_STRING","'tax_refunded'",579],["T_WHITESPACE"," ",579],["T_DOUBLE_ARROW","=>",579],["T_WHITESPACE"," ",579],["T_DNUMBER","8.26",579],",",["T_WHITESPACE","\n                            ",579],["T_CONSTANT_ENCAPSED_STRING","'base_tax_invoiced'",580],["T_WHITESPACE"," ",580],["T_DOUBLE_ARROW","=>",580],["T_WHITESPACE"," ",580],["T_DNUMBER","12.38",580],",",["T_WHITESPACE","\n                            ",580],["T_CONSTANT_ENCAPSED_STRING","'base_tax_refunded'",581],["T_WHITESPACE"," ",581],["T_DOUBLE_ARROW","=>",581],["T_WHITESPACE"," ",581],["T_DNUMBER","8.26",581],",",["T_WHITESPACE","\n                            ",581],["T_CONSTANT_ENCAPSED_STRING","'discount_tax_compensation_amount'",582],["T_WHITESPACE"," ",582],["T_DOUBLE_ARROW","=>",582],["T_WHITESPACE"," ",582],["T_LNUMBER","0",582],",",["T_WHITESPACE","\n                            ",582],["T_CONSTANT_ENCAPSED_STRING","'base_discount_tax_compensation_amount'",583],["T_WHITESPACE"," ",583],["T_DOUBLE_ARROW","=>",583],["T_WHITESPACE"," ",583],["T_LNUMBER","0",583],",",["T_WHITESPACE","\n                            ",583],["T_CONSTANT_ENCAPSED_STRING","'qty_refunded'",584],["T_WHITESPACE"," ",584],["T_DOUBLE_ARROW","=>",584],["T_WHITESPACE"," ",584],["T_LNUMBER","2",584],",",["T_WHITESPACE","\n                        ",584],"]",",",["T_WHITESPACE","\n                        ",585],["T_CONSTANT_ENCAPSED_STRING","'is_last'",586],["T_WHITESPACE"," ",586],["T_DOUBLE_ARROW","=>",586],["T_WHITESPACE"," ",586],["T_STRING","true",586],",",["T_WHITESPACE","\n                        ",586],["T_CONSTANT_ENCAPSED_STRING","'qty'",587],["T_WHITESPACE"," ",587],["T_DOUBLE_ARROW","=>",587],["T_WHITESPACE"," ",587],["T_LNUMBER","1",587],",",["T_WHITESPACE","\n                    ",587],"]",",",["T_WHITESPACE","\n                ",588],"]",",",["T_WHITESPACE","\n                ",589],["T_CONSTANT_ENCAPSED_STRING","'is_last'",590],["T_WHITESPACE"," ",590],["T_DOUBLE_ARROW","=>",590],["T_WHITESPACE"," ",590],["T_STRING","true",590],",",["T_WHITESPACE","\n                ",590],["T_CONSTANT_ENCAPSED_STRING","'data_fields'",591],["T_WHITESPACE"," ",591],["T_DOUBLE_ARROW","=>",591],["T_WHITESPACE"," ",591],"[",["T_WHITESPACE","\n                    ",591],["T_CONSTANT_ENCAPSED_STRING","'shipping_amount'",592],["T_WHITESPACE"," ",592],["T_DOUBLE_ARROW","=>",592],["T_WHITESPACE"," ",592],["T_DNUMBER","7.5",592],",",["T_WHITESPACE","\n                    ",592],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_amount'",593],["T_WHITESPACE"," ",593],["T_DOUBLE_ARROW","=>",593],["T_WHITESPACE"," ",593],["T_DNUMBER","7.5",593],",",["T_WHITESPACE","\n                    ",593],["T_CONSTANT_ENCAPSED_STRING","'grand_total'",594],["T_WHITESPACE"," ",594],["T_DOUBLE_ARROW","=>",594],["T_WHITESPACE"," ",594],["T_DNUMBER","60.82",594],",",["T_WHITESPACE","\n                    ",594],["T_CONSTANT_ENCAPSED_STRING","'base_grand_total'",595],["T_WHITESPACE"," ",595],["T_DOUBLE_ARROW","=>",595],["T_WHITESPACE"," ",595],["T_DNUMBER","60.82",595],",",["T_WHITESPACE","\n                    ",595],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",596],["T_WHITESPACE"," ",596],["T_DOUBLE_ARROW","=>",596],["T_WHITESPACE"," ",596],["T_DNUMBER","0.82",596],",",["T_WHITESPACE","\n                    ",596],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",597],["T_WHITESPACE"," ",597],["T_DOUBLE_ARROW","=>",597],["T_WHITESPACE"," ",597],["T_DNUMBER","0.82",597],",",["T_WHITESPACE","\n                    ",597],["T_CONSTANT_ENCAPSED_STRING","'invoice'",598],["T_WHITESPACE"," ",598],["T_DOUBLE_ARROW","=>",598],["T_WHITESPACE"," ",598],["T_NEW","new",598],["T_WHITESPACE"," ",598],["T_STRING","MagentoObject",598],"(",["T_WHITESPACE","\n                        ",598],"[",["T_WHITESPACE","\n                            ",599],["T_CONSTANT_ENCAPSED_STRING","'shipping_tax_amount'",600],["T_WHITESPACE"," ",600],["T_DOUBLE_ARROW","=>",600],["T_WHITESPACE"," ",600],["T_DNUMBER","1.24",600],",",["T_WHITESPACE","\n                            ",600],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_tax_amount'",601],["T_WHITESPACE"," ",601],["T_DOUBLE_ARROW","=>",601],["T_WHITESPACE"," ",601],["T_DNUMBER","1.24",601],",",["T_WHITESPACE","\n                            ",601],["T_CONSTANT_ENCAPSED_STRING","'shipping_discount_tax_compensation_amount'",602],["T_WHITESPACE"," ",602],["T_DOUBLE_ARROW","=>",602],["T_WHITESPACE"," ",602],["T_LNUMBER","0",602],",",["T_WHITESPACE","\n                            ",602],["T_CONSTANT_ENCAPSED_STRING","'base_shipping_discount_tax_compensation_amount'",603],["T_WHITESPACE"," ",603],["T_DOUBLE_ARROW","=>",603],["T_WHITESPACE"," ",603],["T_LNUMBER","0",603],",",["T_WHITESPACE","\n                        ",603],"]",["T_WHITESPACE","\n                    ",604],")",",",["T_WHITESPACE","\n                ",605],"]",",",["T_WHITESPACE","\n            ",606],"]",",",["T_WHITESPACE","\n            ",607],["T_CONSTANT_ENCAPSED_STRING","'expected_results'",608],["T_WHITESPACE"," ",608],["T_DOUBLE_ARROW","=>",608],["T_WHITESPACE"," ",608],"[",["T_WHITESPACE","\n                ",608],["T_CONSTANT_ENCAPSED_STRING","'creditmemo_items'",609],["T_WHITESPACE"," ",609],["T_DOUBLE_ARROW","=>",609],["T_WHITESPACE"," ",609],"[",["T_WHITESPACE","\n                    ",609],["T_CONSTANT_ENCAPSED_STRING","'item_1'",610],["T_WHITESPACE"," ",610],["T_DOUBLE_ARROW","=>",610],["T_WHITESPACE"," ",610],"[",["T_WHITESPACE","\n                        ",610],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",611],["T_WHITESPACE"," ",611],["T_DOUBLE_ARROW","=>",611],["T_WHITESPACE"," ",611],["T_DNUMBER","4.12",611],",",["T_WHITESPACE","\n                        ",611],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",612],["T_WHITESPACE"," ",612],["T_DOUBLE_ARROW","=>",612],["T_WHITESPACE"," ",612],["T_DNUMBER","4.12",612],",",["T_WHITESPACE","\n                    ",612],"]",",",["T_WHITESPACE","\n                ",613],"]",",",["T_WHITESPACE","\n                ",614],["T_CONSTANT_ENCAPSED_STRING","'creditmemo_data'",615],["T_WHITESPACE"," ",615],["T_DOUBLE_ARROW","=>",615],["T_WHITESPACE"," ",615],"[",["T_WHITESPACE","\n                    ",615],["T_CONSTANT_ENCAPSED_STRING","'grand_total'",616],["T_WHITESPACE"," ",616],["T_DOUBLE_ARROW","=>",616],["T_WHITESPACE"," ",616],["T_DNUMBER","65.56",616],",",["T_WHITESPACE","\n                    ",616],["T_CONSTANT_ENCAPSED_STRING","'base_grand_total'",617],["T_WHITESPACE"," ",617],["T_DOUBLE_ARROW","=>",617],["T_WHITESPACE"," ",617],["T_DNUMBER","65.56",617],",",["T_WHITESPACE","\n                    ",617],["T_CONSTANT_ENCAPSED_STRING","'tax_amount'",618],["T_WHITESPACE"," ",618],["T_DOUBLE_ARROW","=>",618],["T_WHITESPACE"," ",618],["T_DNUMBER","5.56",618],",",["T_WHITESPACE","\n                    ",618],["T_CONSTANT_ENCAPSED_STRING","'base_tax_amount'",619],["T_WHITESPACE"," ",619],["T_DOUBLE_ARROW","=>",619],["T_WHITESPACE"," ",619],["T_DNUMBER","5.56",619],",",["T_WHITESPACE","\n                ",619],"]",",",["T_WHITESPACE","\n            ",620],"]",",",["T_WHITESPACE","\n        ",621],"]",";",["T_WHITESPACE","\n\n        ",622],["T_RETURN","return",624],["T_WHITESPACE"," ",624],["T_VARIABLE","$result",624],";",["T_WHITESPACE","\n    ",624],"}",["T_WHITESPACE","\n\n    ",625],["T_DOC_COMMENT","\/**\n     * @param $creditmemoItemData array\n     * @return \\Magento\\Sales\\Model\\Order\\Creditmemo\\Item|\\PHPUnit_Framework_MockObject_MockObject\n     *\/",627],["T_WHITESPACE","\n    ",630],["T_PROTECTED","protected",631],["T_WHITESPACE"," ",631],["T_FUNCTION","function",631],["T_WHITESPACE"," ",631],["T_STRING","getCreditmemoItem",631],"(",["T_VARIABLE","$creditmemoItemData",631],")",["T_WHITESPACE","\n    ",631],"{",["T_WHITESPACE","\n        ",632],["T_DOC_COMMENT","\/** @var \\Magento\\Sales\\Model\\Order\\Item|\\PHPUnit_Framework_MockObject_MockObject $orderItem *\/",633],["T_WHITESPACE","\n        ",633],["T_VARIABLE","$orderItem",634],["T_WHITESPACE"," ",634],"=",["T_WHITESPACE"," ",634],["T_VARIABLE","$this",634],["T_OBJECT_OPERATOR","->",634],["T_STRING","getMock",634],"(",["T_WHITESPACE","\r\n            ",634],["T_NS_SEPARATOR","\\",635],["T_STRING","Magento",635],["T_NS_SEPARATOR","\\",635],["T_STRING","Sales",635],["T_NS_SEPARATOR","\\",635],["T_STRING","Model",635],["T_NS_SEPARATOR","\\",635],["T_STRING","Order",635],["T_NS_SEPARATOR","\\",635],["T_STRING","Item",635],["T_DOUBLE_COLON","::",635],["T_CLASS","class",635],",",["T_WHITESPACE","\n            ",635],"[",["T_WHITESPACE","\n                ",636],["T_CONSTANT_ENCAPSED_STRING","'isDummy'",637],",",["T_WHITESPACE","\n                ",637],["T_CONSTANT_ENCAPSED_STRING","'__wakeup'",638],["T_WHITESPACE","\n            ",638],"]",",",["T_WHITESPACE","\n            ",639],"[","]",",",["T_WHITESPACE","\n            ",640],["T_CONSTANT_ENCAPSED_STRING","''",641],",",["T_WHITESPACE","\n            ",641],["T_STRING","false",642],["T_WHITESPACE","\n        ",642],")",";",["T_WHITESPACE","\n        ",643],["T_FOREACH","foreach",644],["T_WHITESPACE"," ",644],"(",["T_VARIABLE","$creditmemoItemData",644],"[",["T_CONSTANT_ENCAPSED_STRING","'order_item'",644],"]",["T_WHITESPACE"," ",644],["T_AS","as",644],["T_WHITESPACE"," ",644],["T_VARIABLE","$key",644],["T_WHITESPACE"," ",644],["T_DOUBLE_ARROW","=>",644],["T_WHITESPACE"," ",644],["T_VARIABLE","$value",644],")",["T_WHITESPACE"," ",644],"{",["T_WHITESPACE","\n            ",644],["T_VARIABLE","$orderItem",645],["T_OBJECT_OPERATOR","->",645],["T_STRING","setData",645],"(",["T_VARIABLE","$key",645],",",["T_WHITESPACE"," ",645],["T_VARIABLE","$value",645],")",";",["T_WHITESPACE","\n        ",645],"}",["T_WHITESPACE","\n\n        ",646],["T_DOC_COMMENT","\/** @var \\Magento\\Sales\\Model\\Order\\Creditmemo\\Item|\\PHPUnit_Framework_MockObject_MockObject $creditmemoItem *\/",648],["T_WHITESPACE","\n        ",648],["T_VARIABLE","$creditmemoItem",649],["T_WHITESPACE"," ",649],"=",["T_WHITESPACE"," ",649],["T_VARIABLE","$this",649],["T_OBJECT_OPERATOR","->",649],["T_STRING","getMock",649],"(",["T_WHITESPACE","\r\n            ",649],["T_NS_SEPARATOR","\\",650],["T_STRING","Magento",650],["T_NS_SEPARATOR","\\",650],["T_STRING","Sales",650],["T_NS_SEPARATOR","\\",650],["T_STRING","Model",650],["T_NS_SEPARATOR","\\",650],["T_STRING","Order",650],["T_NS_SEPARATOR","\\",650],["T_STRING","Creditmemo",650],["T_NS_SEPARATOR","\\",650],["T_STRING","Item",650],["T_DOUBLE_COLON","::",650],["T_CLASS","class",650],",",["T_WHITESPACE","\n            ",650],"[",["T_WHITESPACE","\n                ",651],["T_CONSTANT_ENCAPSED_STRING","'getOrderItem'",652],",",["T_WHITESPACE","\n                ",652],["T_CONSTANT_ENCAPSED_STRING","'isLast'",653],",",["T_WHITESPACE","\n                ",653],["T_CONSTANT_ENCAPSED_STRING","'__wakeup'",654],["T_WHITESPACE","\n            ",654],"]",",",["T_WHITESPACE","\n            ",655],"[","]",",",["T_WHITESPACE","\n            ",656],["T_CONSTANT_ENCAPSED_STRING","''",657],",",["T_WHITESPACE","\n            ",657],["T_STRING","false",658],["T_WHITESPACE","\n        ",658],")",";",["T_WHITESPACE","\n        ",659],["T_VARIABLE","$creditmemoItem",660],["T_OBJECT_OPERATOR","->",660],["T_STRING","expects",660],"(",["T_VARIABLE","$this",660],["T_OBJECT_OPERATOR","->",660],["T_STRING","any",660],"(",")",")",["T_OBJECT_OPERATOR","->",660],["T_STRING","method",660],"(",["T_CONSTANT_ENCAPSED_STRING","'getOrderItem'",660],")",["T_OBJECT_OPERATOR","->",660],["T_STRING","will",660],"(",["T_VARIABLE","$this",660],["T_OBJECT_OPERATOR","->",660],["T_STRING","returnValue",660],"(",["T_VARIABLE","$orderItem",660],")",")",";",["T_WHITESPACE","\n        ",660],["T_VARIABLE","$creditmemoItem",661],["T_OBJECT_OPERATOR","->",661],["T_STRING","expects",661],"(",["T_VARIABLE","$this",661],["T_OBJECT_OPERATOR","->",661],["T_STRING","any",661],"(",")",")",["T_WHITESPACE","\n            ",661],["T_OBJECT_OPERATOR","->",662],["T_STRING","method",662],"(",["T_CONSTANT_ENCAPSED_STRING","'isLast'",662],")",["T_WHITESPACE","\n            ",662],["T_OBJECT_OPERATOR","->",663],["T_STRING","will",663],"(",["T_VARIABLE","$this",663],["T_OBJECT_OPERATOR","->",663],["T_STRING","returnValue",663],"(",["T_VARIABLE","$creditmemoItemData",663],"[",["T_CONSTANT_ENCAPSED_STRING","'is_last'",663],"]",")",")",";",["T_WHITESPACE","\n        ",663],["T_VARIABLE","$creditmemoItem",664],["T_OBJECT_OPERATOR","->",664],["T_STRING","setData",664],"(",["T_CONSTANT_ENCAPSED_STRING","'qty'",664],",",["T_WHITESPACE"," ",664],["T_VARIABLE","$creditmemoItemData",664],"[",["T_CONSTANT_ENCAPSED_STRING","'qty'",664],"]",")",";",["T_WHITESPACE","\n        ",664],["T_RETURN","return",665],["T_WHITESPACE"," ",665],["T_VARIABLE","$creditmemoItem",665],";",["T_WHITESPACE","\n    ",665],"}",["T_WHITESPACE","\n",666],"}",["T_WHITESPACE","\n",667]]