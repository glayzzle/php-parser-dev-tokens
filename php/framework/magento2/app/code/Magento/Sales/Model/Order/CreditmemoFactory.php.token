[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Sales",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Order",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Factory class for @see \\Magento\\Sales\\Model\\Order\\Creditmemo\n *\/",8],["T_WHITESPACE","\n",10],["T_CLASS","class",11],["T_WHITESPACE"," ",11],["T_STRING","CreditmemoFactory",11],["T_WHITESPACE","\n",11],"{",["T_WHITESPACE","\n    ",12],["T_DOC_COMMENT","\/**\n     * Quote convert object\n     *\n     * @var \\Magento\\Sales\\Model\\Convert\\Order\n     *\/",13],["T_WHITESPACE","\n    ",17],["T_PROTECTED","protected",18],["T_WHITESPACE"," ",18],["T_VARIABLE","$convertor",18],";",["T_WHITESPACE","\n\n    ",18],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Tax\\Model\\Config\n     *\/",20],["T_WHITESPACE","\n    ",22],["T_PROTECTED","protected",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$taxConfig",23],";",["T_WHITESPACE","\n\n    ",23],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Unserialize\\Unserialize\n     * @deprecated\n     *\/",25],["T_WHITESPACE","\n    ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$unserialize",29],";",["T_WHITESPACE","\n\n    ",29],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Serialize\\Serializer\\Json\n     *\/",31],["T_WHITESPACE","\n    ",33],["T_PRIVATE","private",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$serializer",34],";",["T_WHITESPACE","\n\n    ",34],["T_DOC_COMMENT","\/**\n     * Factory constructor\n     *\n     * @param \\Magento\\Sales\\Model\\Convert\\OrderFactory $convertOrderFactory\n     * @param \\Magento\\Tax\\Model\\Config $taxConfig\n     * @param \\Magento\\Framework\\Serialize\\Serializer\\Json $serializer\n     *\/",36],["T_WHITESPACE","\n    ",42],["T_PUBLIC","public",43],["T_WHITESPACE"," ",43],["T_FUNCTION","function",43],["T_WHITESPACE"," ",43],["T_STRING","__construct",43],"(",["T_WHITESPACE","\n        ",43],["T_NS_SEPARATOR","\\",44],["T_STRING","Magento",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Sales",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Model",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Convert",44],["T_NS_SEPARATOR","\\",44],["T_STRING","OrderFactory",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$convertOrderFactory",44],",",["T_WHITESPACE","\n        ",44],["T_NS_SEPARATOR","\\",45],["T_STRING","Magento",45],["T_NS_SEPARATOR","\\",45],["T_STRING","Tax",45],["T_NS_SEPARATOR","\\",45],["T_STRING","Model",45],["T_NS_SEPARATOR","\\",45],["T_STRING","Config",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$taxConfig",45],",",["T_WHITESPACE","\n        ",45],["T_NS_SEPARATOR","\\",46],["T_STRING","Magento",46],["T_NS_SEPARATOR","\\",46],["T_STRING","Framework",46],["T_NS_SEPARATOR","\\",46],["T_STRING","Serialize",46],["T_NS_SEPARATOR","\\",46],["T_STRING","Serializer",46],["T_NS_SEPARATOR","\\",46],["T_STRING","Json",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$serializer",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_STRING","null",46],["T_WHITESPACE","\n    ",46],")",["T_WHITESPACE"," ",47],"{",["T_WHITESPACE","\n        ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","convertor",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$convertOrderFactory",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","create",48],"(",")",";",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","taxConfig",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$taxConfig",49],";",["T_WHITESPACE","\n        ",49],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","serializer",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_VARIABLE","$serializer",50],["T_WHITESPACE"," ",50],"?",":",["T_WHITESPACE"," ",50],["T_NS_SEPARATOR","\\",50],["T_STRING","Magento",50],["T_NS_SEPARATOR","\\",50],["T_STRING","Framework",50],["T_NS_SEPARATOR","\\",50],["T_STRING","App",50],["T_NS_SEPARATOR","\\",50],["T_STRING","ObjectManager",50],["T_DOUBLE_COLON","::",50],["T_STRING","getInstance",50],"(",")",["T_OBJECT_OPERATOR","->",50],["T_STRING","get",50],"(",["T_WHITESPACE","\n            ",50],["T_NS_SEPARATOR","\\",51],["T_STRING","Magento",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Framework",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Serialize",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Serializer",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Json",51],["T_DOUBLE_COLON","::",51],["T_CLASS","class",51],["T_WHITESPACE","\n        ",51],")",";",["T_WHITESPACE","\n    ",52],"}",["T_WHITESPACE","\n\n    ",53],["T_DOC_COMMENT","\/**\n     * Prepare order creditmemo based on order items and requested params\n     *\n     * @param \\Magento\\Sales\\Model\\Order $order\n     * @param array $data\n     * @return Creditmemo\n     *\/",55],["T_WHITESPACE","\n    ",61],["T_PUBLIC","public",62],["T_WHITESPACE"," ",62],["T_FUNCTION","function",62],["T_WHITESPACE"," ",62],["T_STRING","createByOrder",62],"(",["T_NS_SEPARATOR","\\",62],["T_STRING","Magento",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Sales",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Model",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Order",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$order",62],",",["T_WHITESPACE"," ",62],["T_ARRAY","array",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$data",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],"[","]",")",["T_WHITESPACE","\n    ",62],"{",["T_WHITESPACE","\n        ",63],["T_VARIABLE","$totalQty",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_LNUMBER","0",64],";",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$creditmemo",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","convertor",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","toCreditmemo",65],"(",["T_VARIABLE","$order",65],")",";",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$qtys",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_ISSET","isset",66],"(",["T_VARIABLE","$data",66],"[",["T_CONSTANT_ENCAPSED_STRING","'qtys'",66],"]",")",["T_WHITESPACE"," ",66],"?",["T_WHITESPACE"," ",66],["T_VARIABLE","$data",66],"[",["T_CONSTANT_ENCAPSED_STRING","'qtys'",66],"]",["T_WHITESPACE"," ",66],":",["T_WHITESPACE"," ",66],"[","]",";",["T_WHITESPACE","\n\n        ",66],["T_FOREACH","foreach",68],["T_WHITESPACE"," ",68],"(",["T_VARIABLE","$order",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","getAllItems",68],"(",")",["T_WHITESPACE"," ",68],["T_AS","as",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$orderItem",68],")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n            ",68],["T_IF","if",69],["T_WHITESPACE"," ",69],"(","!",["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","canRefundItem",69],"(",["T_VARIABLE","$orderItem",69],",",["T_WHITESPACE"," ",69],["T_VARIABLE","$qtys",69],")",")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n                ",69],["T_CONTINUE","continue",70],";",["T_WHITESPACE","\n            ",70],"}",["T_WHITESPACE","\n\n            ",71],["T_VARIABLE","$item",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","convertor",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","itemToCreditmemoItem",73],"(",["T_VARIABLE","$orderItem",73],")",";",["T_WHITESPACE","\n            ",73],["T_IF","if",74],["T_WHITESPACE"," ",74],"(",["T_VARIABLE","$orderItem",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","isDummy",74],"(",")",")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n                ",74],["T_IF","if",75],["T_WHITESPACE"," ",75],"(",["T_ISSET","isset",75],"(",["T_VARIABLE","$data",75],"[",["T_CONSTANT_ENCAPSED_STRING","'qtys'",75],"]","[",["T_VARIABLE","$orderItem",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getParentItemId",75],"(",")","]",")",")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n                    ",75],["T_VARIABLE","$parentQty",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$data",76],"[",["T_CONSTANT_ENCAPSED_STRING","'qtys'",76],"]","[",["T_VARIABLE","$orderItem",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getParentItemId",76],"(",")","]",";",["T_WHITESPACE","\n                ",76],"}",["T_WHITESPACE"," ",77],["T_ELSE","else",77],["T_WHITESPACE"," ",77],"{",["T_WHITESPACE","\n                    ",77],["T_VARIABLE","$parentQty",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$orderItem",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getParentItem",78],"(",")",["T_WHITESPACE"," ",78],"?",["T_WHITESPACE"," ",78],["T_VARIABLE","$orderItem",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getParentItem",78],"(",")",["T_OBJECT_OPERATOR","->",78],["T_STRING","getQtyToRefund",78],"(",")",["T_WHITESPACE"," ",78],":",["T_WHITESPACE"," ",78],["T_LNUMBER","1",78],";",["T_WHITESPACE","\n                ",78],"}",["T_WHITESPACE","\n                ",79],["T_VARIABLE","$qty",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","calculateProductOptions",80],"(",["T_VARIABLE","$orderItem",80],",",["T_WHITESPACE"," ",80],["T_VARIABLE","$parentQty",80],")",";",["T_WHITESPACE","\n                ",80],["T_VARIABLE","$orderItem",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","setLockedDoShip",81],"(",["T_STRING","true",81],")",";",["T_WHITESPACE","\n            ",81],"}",["T_WHITESPACE"," ",82],["T_ELSE","else",82],["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n                ",82],["T_IF","if",83],["T_WHITESPACE"," ",83],"(",["T_ISSET","isset",83],"(",["T_VARIABLE","$qtys",83],"[",["T_VARIABLE","$orderItem",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","getId",83],"(",")","]",")",")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n                    ",83],["T_VARIABLE","$qty",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_DOUBLE_CAST","(double)",84],["T_VARIABLE","$qtys",84],"[",["T_VARIABLE","$orderItem",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getId",84],"(",")","]",";",["T_WHITESPACE","\n                ",84],"}",["T_WHITESPACE"," ",85],["T_ELSEIF","elseif",85],["T_WHITESPACE"," ",85],"(","!",["T_STRING","count",85],"(",["T_VARIABLE","$qtys",85],")",")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n                    ",85],["T_VARIABLE","$qty",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$orderItem",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getQtyToRefund",86],"(",")",";",["T_WHITESPACE","\n                ",86],"}",["T_WHITESPACE"," ",87],["T_ELSE","else",87],["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n                    ",87],["T_CONTINUE","continue",88],";",["T_WHITESPACE","\n                ",88],"}",["T_WHITESPACE","\n            ",89],"}",["T_WHITESPACE","\n            ",90],["T_VARIABLE","$totalQty",91],["T_WHITESPACE"," ",91],["T_PLUS_EQUAL","+=",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$qty",91],";",["T_WHITESPACE","\n            ",91],["T_VARIABLE","$item",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","setQty",92],"(",["T_VARIABLE","$qty",92],")",";",["T_WHITESPACE","\n            ",92],["T_VARIABLE","$creditmemo",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","addItem",93],"(",["T_VARIABLE","$item",93],")",";",["T_WHITESPACE","\n        ",93],"}",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$creditmemo",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","setTotalQty",95],"(",["T_VARIABLE","$totalQty",95],")",";",["T_WHITESPACE","\n\n        ",95],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","initData",97],"(",["T_VARIABLE","$creditmemo",97],",",["T_WHITESPACE"," ",97],["T_VARIABLE","$data",97],")",";",["T_WHITESPACE","\n\n        ",97],["T_VARIABLE","$creditmemo",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","collectTotals",99],"(",")",";",["T_WHITESPACE","\n        ",99],["T_RETURN","return",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$creditmemo",100],";",["T_WHITESPACE","\n    ",100],"}",["T_WHITESPACE","\n\n    ",101],["T_DOC_COMMENT","\/**\n     * Prepare order creditmemo based on invoice and requested params\n     *\n     * @param \\Magento\\Sales\\Model\\Order\\Invoice $invoice\n     * @param array $data\n     * @return Creditmemo\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     * @SuppressWarnings(PHPMD.NPathComplexity)\n     *\/",103],["T_WHITESPACE","\n    ",111],["T_PUBLIC","public",112],["T_WHITESPACE"," ",112],["T_FUNCTION","function",112],["T_WHITESPACE"," ",112],["T_STRING","createByInvoice",112],"(",["T_NS_SEPARATOR","\\",112],["T_STRING","Magento",112],["T_NS_SEPARATOR","\\",112],["T_STRING","Sales",112],["T_NS_SEPARATOR","\\",112],["T_STRING","Model",112],["T_NS_SEPARATOR","\\",112],["T_STRING","Order",112],["T_NS_SEPARATOR","\\",112],["T_STRING","Invoice",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$invoice",112],",",["T_WHITESPACE"," ",112],["T_ARRAY","array",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$data",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],"[","]",")",["T_WHITESPACE","\n    ",112],"{",["T_WHITESPACE","\n        ",113],["T_VARIABLE","$order",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_VARIABLE","$invoice",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","getOrder",114],"(",")",";",["T_WHITESPACE","\n        ",114],["T_VARIABLE","$totalQty",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_LNUMBER","0",115],";",["T_WHITESPACE","\n        ",115],["T_VARIABLE","$qtys",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_ISSET","isset",116],"(",["T_VARIABLE","$data",116],"[",["T_CONSTANT_ENCAPSED_STRING","'qtys'",116],"]",")",["T_WHITESPACE"," ",116],"?",["T_WHITESPACE"," ",116],["T_VARIABLE","$data",116],"[",["T_CONSTANT_ENCAPSED_STRING","'qtys'",116],"]",["T_WHITESPACE"," ",116],":",["T_WHITESPACE"," ",116],"[","]",";",["T_WHITESPACE","\n        ",116],["T_VARIABLE","$creditmemo",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","convertor",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","toCreditmemo",117],"(",["T_VARIABLE","$order",117],")",";",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$creditmemo",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","setInvoice",118],"(",["T_VARIABLE","$invoice",118],")",";",["T_WHITESPACE","\n\n        ",118],["T_VARIABLE","$invoiceQtysRefunded",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],"[","]",";",["T_WHITESPACE","\n        ",120],["T_FOREACH","foreach",121],["T_WHITESPACE"," ",121],"(",["T_VARIABLE","$invoice",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","getOrder",121],"(",")",["T_OBJECT_OPERATOR","->",121],["T_STRING","getCreditmemosCollection",121],"(",")",["T_WHITESPACE"," ",121],["T_AS","as",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$createdCreditmemo",121],")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n            ",121],["T_IF","if",122],["T_WHITESPACE"," ",122],"(",["T_VARIABLE","$createdCreditmemo",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","getState",122],"(",")",["T_WHITESPACE"," ",122],["T_IS_NOT_EQUAL","!=",122],["T_WHITESPACE"," ",122],["T_STRING","Creditmemo",122],["T_DOUBLE_COLON","::",122],["T_STRING","STATE_CANCELED",122],["T_WHITESPACE"," ",122],["T_BOOLEAN_AND","&&",122],["T_WHITESPACE","\n                ",122],["T_VARIABLE","$createdCreditmemo",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getInvoiceId",123],"(",")",["T_WHITESPACE"," ",123],["T_IS_EQUAL","==",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$invoice",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getId",123],"(",")",["T_WHITESPACE","\n            ",123],")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n                ",124],["T_FOREACH","foreach",125],["T_WHITESPACE"," ",125],"(",["T_VARIABLE","$createdCreditmemo",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","getAllItems",125],"(",")",["T_WHITESPACE"," ",125],["T_AS","as",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$createdCreditmemoItem",125],")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n                    ",125],["T_VARIABLE","$orderItemId",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$createdCreditmemoItem",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getOrderItem",126],"(",")",["T_OBJECT_OPERATOR","->",126],["T_STRING","getId",126],"(",")",";",["T_WHITESPACE","\n                    ",126],["T_IF","if",127],["T_WHITESPACE"," ",127],"(",["T_ISSET","isset",127],"(",["T_VARIABLE","$invoiceQtysRefunded",127],"[",["T_VARIABLE","$orderItemId",127],"]",")",")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n                        ",127],["T_VARIABLE","$invoiceQtysRefunded",128],"[",["T_VARIABLE","$orderItemId",128],"]",["T_WHITESPACE"," ",128],["T_PLUS_EQUAL","+=",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$createdCreditmemoItem",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","getQty",128],"(",")",";",["T_WHITESPACE","\n                    ",128],"}",["T_WHITESPACE"," ",129],["T_ELSE","else",129],["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n                        ",129],["T_VARIABLE","$invoiceQtysRefunded",130],"[",["T_VARIABLE","$orderItemId",130],"]",["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$createdCreditmemoItem",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getQty",130],"(",")",";",["T_WHITESPACE","\n                    ",130],"}",["T_WHITESPACE","\n                ",131],"}",["T_WHITESPACE","\n            ",132],"}",["T_WHITESPACE","\n        ",133],"}",["T_WHITESPACE","\n\n        ",134],["T_VARIABLE","$invoiceQtysRefundLimits",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],"[","]",";",["T_WHITESPACE","\n        ",136],["T_FOREACH","foreach",137],["T_WHITESPACE"," ",137],"(",["T_VARIABLE","$invoice",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","getAllItems",137],"(",")",["T_WHITESPACE"," ",137],["T_AS","as",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$invoiceItem",137],")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n            ",137],["T_VARIABLE","$invoiceQtyCanBeRefunded",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_VARIABLE","$invoiceItem",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","getQty",138],"(",")",";",["T_WHITESPACE","\n            ",138],["T_VARIABLE","$orderItemId",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$invoiceItem",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getOrderItem",139],"(",")",["T_OBJECT_OPERATOR","->",139],["T_STRING","getId",139],"(",")",";",["T_WHITESPACE","\n            ",139],["T_IF","if",140],["T_WHITESPACE"," ",140],"(",["T_ISSET","isset",140],"(",["T_VARIABLE","$invoiceQtysRefunded",140],"[",["T_VARIABLE","$orderItemId",140],"]",")",")",["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n                ",140],["T_VARIABLE","$invoiceQtyCanBeRefunded",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_VARIABLE","$invoiceQtyCanBeRefunded",141],["T_WHITESPACE"," ",141],"-",["T_WHITESPACE"," ",141],["T_VARIABLE","$invoiceQtysRefunded",141],"[",["T_VARIABLE","$orderItemId",141],"]",";",["T_WHITESPACE","\n            ",141],"}",["T_WHITESPACE","\n            ",142],["T_VARIABLE","$invoiceQtysRefundLimits",143],"[",["T_VARIABLE","$orderItemId",143],"]",["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_VARIABLE","$invoiceQtyCanBeRefunded",143],";",["T_WHITESPACE","\n        ",143],"}",["T_WHITESPACE","\n\n        ",144],["T_FOREACH","foreach",146],["T_WHITESPACE"," ",146],"(",["T_VARIABLE","$invoice",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","getAllItems",146],"(",")",["T_WHITESPACE"," ",146],["T_AS","as",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$invoiceItem",146],")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n            ",146],["T_VARIABLE","$orderItem",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_VARIABLE","$invoiceItem",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","getOrderItem",147],"(",")",";",["T_WHITESPACE","\n\n            ",147],["T_IF","if",149],["T_WHITESPACE"," ",149],"(","!",["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","canRefundItem",149],"(",["T_VARIABLE","$orderItem",149],",",["T_WHITESPACE"," ",149],["T_VARIABLE","$qtys",149],",",["T_WHITESPACE"," ",149],["T_VARIABLE","$invoiceQtysRefundLimits",149],")",")",["T_WHITESPACE"," ",149],"{",["T_WHITESPACE","\n                ",149],["T_CONTINUE","continue",150],";",["T_WHITESPACE","\n            ",150],"}",["T_WHITESPACE","\n\n            ",151],["T_VARIABLE","$item",153],["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","convertor",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","itemToCreditmemoItem",153],"(",["T_VARIABLE","$orderItem",153],")",";",["T_WHITESPACE","\n            ",153],["T_IF","if",154],["T_WHITESPACE"," ",154],"(",["T_VARIABLE","$orderItem",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","isDummy",154],"(",")",")",["T_WHITESPACE"," ",154],"{",["T_WHITESPACE","\n                ",154],["T_IF","if",155],["T_WHITESPACE"," ",155],"(",["T_ISSET","isset",155],"(",["T_VARIABLE","$data",155],"[",["T_CONSTANT_ENCAPSED_STRING","'qtys'",155],"]","[",["T_VARIABLE","$orderItem",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","getParentItemId",155],"(",")","]",")",")",["T_WHITESPACE"," ",155],"{",["T_WHITESPACE","\n                    ",155],["T_VARIABLE","$parentQty",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_VARIABLE","$data",156],"[",["T_CONSTANT_ENCAPSED_STRING","'qtys'",156],"]","[",["T_VARIABLE","$orderItem",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","getParentItemId",156],"(",")","]",";",["T_WHITESPACE","\n                ",156],"}",["T_WHITESPACE"," ",157],["T_ELSE","else",157],["T_WHITESPACE"," ",157],"{",["T_WHITESPACE","\n                    ",157],["T_VARIABLE","$parentQty",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_VARIABLE","$orderItem",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","getParentItem",158],"(",")",["T_WHITESPACE"," ",158],"?",["T_WHITESPACE"," ",158],["T_VARIABLE","$orderItem",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","getParentItem",158],"(",")",["T_OBJECT_OPERATOR","->",158],["T_STRING","getQtyToRefund",158],"(",")",["T_WHITESPACE"," ",158],":",["T_WHITESPACE"," ",158],["T_LNUMBER","1",158],";",["T_WHITESPACE","\n                ",158],"}",["T_WHITESPACE","\n                ",159],["T_VARIABLE","$qty",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","calculateProductOptions",160],"(",["T_VARIABLE","$orderItem",160],",",["T_WHITESPACE"," ",160],["T_VARIABLE","$parentQty",160],")",";",["T_WHITESPACE","\n            ",160],"}",["T_WHITESPACE"," ",161],["T_ELSE","else",161],["T_WHITESPACE"," ",161],"{",["T_WHITESPACE","\n                ",161],["T_IF","if",162],["T_WHITESPACE"," ",162],"(",["T_ISSET","isset",162],"(",["T_VARIABLE","$qtys",162],"[",["T_VARIABLE","$orderItem",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","getId",162],"(",")","]",")",")",["T_WHITESPACE"," ",162],"{",["T_WHITESPACE","\n                    ",162],["T_VARIABLE","$qty",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_DOUBLE_CAST","(double)",163],["T_VARIABLE","$qtys",163],"[",["T_VARIABLE","$orderItem",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","getId",163],"(",")","]",";",["T_WHITESPACE","\n                ",163],"}",["T_WHITESPACE"," ",164],["T_ELSEIF","elseif",164],["T_WHITESPACE"," ",164],"(","!",["T_STRING","count",164],"(",["T_VARIABLE","$qtys",164],")",")",["T_WHITESPACE"," ",164],"{",["T_WHITESPACE","\n                    ",164],["T_VARIABLE","$qty",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_VARIABLE","$orderItem",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","getQtyToRefund",165],"(",")",";",["T_WHITESPACE","\n                ",165],"}",["T_WHITESPACE"," ",166],["T_ELSE","else",166],["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n                    ",166],["T_CONTINUE","continue",167],";",["T_WHITESPACE","\n                ",167],"}",["T_WHITESPACE","\n                ",168],["T_IF","if",169],["T_WHITESPACE"," ",169],"(",["T_ISSET","isset",169],"(",["T_VARIABLE","$invoiceQtysRefundLimits",169],"[",["T_VARIABLE","$orderItem",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","getId",169],"(",")","]",")",")",["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n                    ",169],["T_VARIABLE","$qty",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_STRING","min",170],"(",["T_VARIABLE","$qty",170],",",["T_WHITESPACE"," ",170],["T_VARIABLE","$invoiceQtysRefundLimits",170],"[",["T_VARIABLE","$orderItem",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","getId",170],"(",")","]",")",";",["T_WHITESPACE","\n                ",170],"}",["T_WHITESPACE","\n            ",171],"}",["T_WHITESPACE","\n            ",172],["T_VARIABLE","$qty",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_STRING","min",173],"(",["T_VARIABLE","$qty",173],",",["T_WHITESPACE"," ",173],["T_VARIABLE","$invoiceItem",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","getQty",173],"(",")",")",";",["T_WHITESPACE","\n            ",173],["T_VARIABLE","$totalQty",174],["T_WHITESPACE"," ",174],["T_PLUS_EQUAL","+=",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$qty",174],";",["T_WHITESPACE","\n            ",174],["T_VARIABLE","$item",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","setQty",175],"(",["T_VARIABLE","$qty",175],")",";",["T_WHITESPACE","\n            ",175],["T_VARIABLE","$creditmemo",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","addItem",176],"(",["T_VARIABLE","$item",176],")",";",["T_WHITESPACE","\n        ",176],"}",["T_WHITESPACE","\n        ",177],["T_VARIABLE","$creditmemo",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","setTotalQty",178],"(",["T_VARIABLE","$totalQty",178],")",";",["T_WHITESPACE","\n\n        ",178],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","initData",180],"(",["T_VARIABLE","$creditmemo",180],",",["T_WHITESPACE"," ",180],["T_VARIABLE","$data",180],")",";",["T_WHITESPACE","\n        ",180],["T_IF","if",181],["T_WHITESPACE"," ",181],"(","!",["T_ISSET","isset",181],"(",["T_VARIABLE","$data",181],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_amount'",181],"]",")",")",["T_WHITESPACE"," ",181],"{",["T_WHITESPACE","\n            ",181],["T_VARIABLE","$isShippingInclTax",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","taxConfig",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","displaySalesShippingInclTax",182],"(",["T_VARIABLE","$order",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","getStoreId",182],"(",")",")",";",["T_WHITESPACE","\n            ",182],["T_IF","if",183],["T_WHITESPACE"," ",183],"(",["T_VARIABLE","$isShippingInclTax",183],")",["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n                ",183],["T_VARIABLE","$baseAllowedAmount",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_VARIABLE","$order",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getBaseShippingInclTax",184],"(",")",["T_WHITESPACE"," ",184],"-",["T_WHITESPACE","\n                    ",184],["T_VARIABLE","$order",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","getBaseShippingRefunded",185],"(",")",["T_WHITESPACE"," ",185],"-",["T_WHITESPACE","\n                    ",185],["T_VARIABLE","$order",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","getBaseShippingTaxRefunded",186],"(",")",";",["T_WHITESPACE","\n            ",186],"}",["T_WHITESPACE"," ",187],["T_ELSE","else",187],["T_WHITESPACE"," ",187],"{",["T_WHITESPACE","\n                ",187],["T_VARIABLE","$baseAllowedAmount",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_VARIABLE","$order",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getBaseShippingAmount",188],"(",")",["T_WHITESPACE"," ",188],"-",["T_WHITESPACE"," ",188],["T_VARIABLE","$order",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getBaseShippingRefunded",188],"(",")",";",["T_WHITESPACE","\n                ",188],["T_VARIABLE","$baseAllowedAmount",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_STRING","min",189],"(",["T_VARIABLE","$baseAllowedAmount",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$invoice",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getBaseShippingAmount",189],"(",")",")",";",["T_WHITESPACE","\n            ",189],"}",["T_WHITESPACE","\n            ",190],["T_VARIABLE","$creditmemo",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","setBaseShippingAmount",191],"(",["T_VARIABLE","$baseAllowedAmount",191],")",";",["T_WHITESPACE","\n        ",191],"}",["T_WHITESPACE","\n\n        ",192],["T_VARIABLE","$creditmemo",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","collectTotals",194],"(",")",";",["T_WHITESPACE","\n        ",194],["T_RETURN","return",195],["T_WHITESPACE"," ",195],["T_VARIABLE","$creditmemo",195],";",["T_WHITESPACE","\n    ",195],"}",["T_WHITESPACE","\n\n    ",196],["T_DOC_COMMENT","\/**\n     * Check if order item can be refunded\n     *\n     * @param \\Magento\\Sales\\Model\\Order\\Item $item\n     * @param array $qtys\n     * @param array $invoiceQtysRefundLimits\n     * @return bool\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     *\/",198],["T_WHITESPACE","\n    ",206],["T_PROTECTED","protected",207],["T_WHITESPACE"," ",207],["T_FUNCTION","function",207],["T_WHITESPACE"," ",207],["T_STRING","canRefundItem",207],"(",["T_VARIABLE","$item",207],",",["T_WHITESPACE"," ",207],["T_VARIABLE","$qtys",207],["T_WHITESPACE"," ",207],"=",["T_WHITESPACE"," ",207],"[","]",",",["T_WHITESPACE"," ",207],["T_VARIABLE","$invoiceQtysRefundLimits",207],["T_WHITESPACE"," ",207],"=",["T_WHITESPACE"," ",207],"[","]",")",["T_WHITESPACE","\n    ",207],"{",["T_WHITESPACE","\n        ",208],["T_IF","if",209],["T_WHITESPACE"," ",209],"(",["T_VARIABLE","$item",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","isDummy",209],"(",")",")",["T_WHITESPACE"," ",209],"{",["T_WHITESPACE","\n            ",209],["T_IF","if",210],["T_WHITESPACE"," ",210],"(",["T_VARIABLE","$item",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","getHasChildren",210],"(",")",")",["T_WHITESPACE"," ",210],"{",["T_WHITESPACE","\n                ",210],["T_FOREACH","foreach",211],["T_WHITESPACE"," ",211],"(",["T_VARIABLE","$item",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","getChildrenItems",211],"(",")",["T_WHITESPACE"," ",211],["T_AS","as",211],["T_WHITESPACE"," ",211],["T_VARIABLE","$child",211],")",["T_WHITESPACE"," ",211],"{",["T_WHITESPACE","\n                    ",211],["T_IF","if",212],["T_WHITESPACE"," ",212],"(",["T_EMPTY","empty",212],"(",["T_VARIABLE","$qtys",212],")",")",["T_WHITESPACE"," ",212],"{",["T_WHITESPACE","\n                        ",212],["T_IF","if",213],["T_WHITESPACE"," ",213],"(",["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","canRefundNoDummyItem",213],"(",["T_VARIABLE","$child",213],",",["T_WHITESPACE"," ",213],["T_VARIABLE","$invoiceQtysRefundLimits",213],")",")",["T_WHITESPACE"," ",213],"{",["T_WHITESPACE","\n                            ",213],["T_RETURN","return",214],["T_WHITESPACE"," ",214],["T_STRING","true",214],";",["T_WHITESPACE","\n                        ",214],"}",["T_WHITESPACE","\n                    ",215],"}",["T_WHITESPACE"," ",216],["T_ELSE","else",216],["T_WHITESPACE"," ",216],"{",["T_WHITESPACE","\n                        ",216],["T_IF","if",217],["T_WHITESPACE"," ",217],"(",["T_ISSET","isset",217],"(",["T_VARIABLE","$qtys",217],"[",["T_VARIABLE","$child",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","getId",217],"(",")","]",")",["T_WHITESPACE"," ",217],["T_BOOLEAN_AND","&&",217],["T_WHITESPACE"," ",217],["T_VARIABLE","$qtys",217],"[",["T_VARIABLE","$child",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","getId",217],"(",")","]",["T_WHITESPACE"," ",217],">",["T_WHITESPACE"," ",217],["T_LNUMBER","0",217],")",["T_WHITESPACE"," ",217],"{",["T_WHITESPACE","\n                            ",217],["T_RETURN","return",218],["T_WHITESPACE"," ",218],["T_STRING","true",218],";",["T_WHITESPACE","\n                        ",218],"}",["T_WHITESPACE","\n                    ",219],"}",["T_WHITESPACE","\n                ",220],"}",["T_WHITESPACE","\n                ",221],["T_RETURN","return",222],["T_WHITESPACE"," ",222],["T_STRING","false",222],";",["T_WHITESPACE","\n            ",222],"}",["T_WHITESPACE"," ",223],["T_ELSEIF","elseif",223],["T_WHITESPACE"," ",223],"(",["T_VARIABLE","$item",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","getParentItem",223],"(",")",")",["T_WHITESPACE"," ",223],"{",["T_WHITESPACE","\n                ",223],["T_VARIABLE","$parent",224],["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],["T_VARIABLE","$item",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","getParentItem",224],"(",")",";",["T_WHITESPACE","\n                ",224],["T_IF","if",225],["T_WHITESPACE"," ",225],"(",["T_EMPTY","empty",225],"(",["T_VARIABLE","$qtys",225],")",")",["T_WHITESPACE"," ",225],"{",["T_WHITESPACE","\n                    ",225],["T_RETURN","return",226],["T_WHITESPACE"," ",226],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","canRefundNoDummyItem",226],"(",["T_VARIABLE","$parent",226],",",["T_WHITESPACE"," ",226],["T_VARIABLE","$invoiceQtysRefundLimits",226],")",";",["T_WHITESPACE","\n                ",226],"}",["T_WHITESPACE"," ",227],["T_ELSE","else",227],["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n                    ",227],["T_RETURN","return",228],["T_WHITESPACE"," ",228],["T_ISSET","isset",228],"(",["T_VARIABLE","$qtys",228],"[",["T_VARIABLE","$parent",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getId",228],"(",")","]",")",["T_WHITESPACE"," ",228],["T_BOOLEAN_AND","&&",228],["T_WHITESPACE"," ",228],["T_VARIABLE","$qtys",228],"[",["T_VARIABLE","$parent",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getId",228],"(",")","]",["T_WHITESPACE"," ",228],">",["T_WHITESPACE"," ",228],["T_LNUMBER","0",228],";",["T_WHITESPACE","\n                ",228],"}",["T_WHITESPACE","\n            ",229],"}",["T_WHITESPACE","\n        ",230],"}",["T_WHITESPACE"," ",231],["T_ELSE","else",231],["T_WHITESPACE"," ",231],"{",["T_WHITESPACE","\n            ",231],["T_RETURN","return",232],["T_WHITESPACE"," ",232],["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","canRefundNoDummyItem",232],"(",["T_VARIABLE","$item",232],",",["T_WHITESPACE"," ",232],["T_VARIABLE","$invoiceQtysRefundLimits",232],")",";",["T_WHITESPACE","\n        ",232],"}",["T_WHITESPACE","\n    ",233],"}",["T_WHITESPACE","\n\n    ",234],["T_DOC_COMMENT","\/**\n     * Check if no dummy order item can be refunded\n     *\n     * @param \\Magento\\Sales\\Model\\Order\\Item $item\n     * @param array $invoiceQtysRefundLimits\n     * @return bool\n     *\/",236],["T_WHITESPACE","\n    ",242],["T_PROTECTED","protected",243],["T_WHITESPACE"," ",243],["T_FUNCTION","function",243],["T_WHITESPACE"," ",243],["T_STRING","canRefundNoDummyItem",243],"(",["T_VARIABLE","$item",243],",",["T_WHITESPACE"," ",243],["T_VARIABLE","$invoiceQtysRefundLimits",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],"[","]",")",["T_WHITESPACE","\n    ",243],"{",["T_WHITESPACE","\n        ",244],["T_IF","if",245],["T_WHITESPACE"," ",245],"(",["T_VARIABLE","$item",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","getQtyToRefund",245],"(",")",["T_WHITESPACE"," ",245],"<",["T_WHITESPACE"," ",245],["T_LNUMBER","0",245],")",["T_WHITESPACE"," ",245],"{",["T_WHITESPACE","\n            ",245],["T_RETURN","return",246],["T_WHITESPACE"," ",246],["T_STRING","false",246],";",["T_WHITESPACE","\n        ",246],"}",["T_WHITESPACE","\n        ",247],["T_IF","if",248],["T_WHITESPACE"," ",248],"(",["T_ISSET","isset",248],"(",["T_VARIABLE","$invoiceQtysRefundLimits",248],"[",["T_VARIABLE","$item",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","getId",248],"(",")","]",")",")",["T_WHITESPACE"," ",248],"{",["T_WHITESPACE","\n            ",248],["T_RETURN","return",249],["T_WHITESPACE"," ",249],["T_VARIABLE","$invoiceQtysRefundLimits",249],"[",["T_VARIABLE","$item",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","getId",249],"(",")","]",["T_WHITESPACE"," ",249],">",["T_WHITESPACE"," ",249],["T_LNUMBER","0",249],";",["T_WHITESPACE","\n        ",249],"}",["T_WHITESPACE","\n        ",250],["T_RETURN","return",251],["T_WHITESPACE"," ",251],["T_STRING","true",251],";",["T_WHITESPACE","\n    ",251],"}",["T_WHITESPACE","\n\n    ",252],["T_DOC_COMMENT","\/**\n     * Initialize creditmemo state based on requested parameters\n     *\n     * @param Creditmemo $creditmemo\n     * @param array $data\n     * @return void\n     *\/",254],["T_WHITESPACE","\n    ",260],["T_PROTECTED","protected",261],["T_WHITESPACE"," ",261],["T_FUNCTION","function",261],["T_WHITESPACE"," ",261],["T_STRING","initData",261],"(",["T_VARIABLE","$creditmemo",261],",",["T_WHITESPACE"," ",261],["T_VARIABLE","$data",261],")",["T_WHITESPACE","\n    ",261],"{",["T_WHITESPACE","\n        ",262],["T_IF","if",263],["T_WHITESPACE"," ",263],"(",["T_ISSET","isset",263],"(",["T_VARIABLE","$data",263],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_amount'",263],"]",")",")",["T_WHITESPACE"," ",263],"{",["T_WHITESPACE","\n            ",263],["T_VARIABLE","$creditmemo",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","setBaseShippingAmount",264],"(",["T_DOUBLE_CAST","(double)",264],["T_VARIABLE","$data",264],"[",["T_CONSTANT_ENCAPSED_STRING","'shipping_amount'",264],"]",")",";",["T_WHITESPACE","\n        ",264],"}",["T_WHITESPACE","\n        ",265],["T_IF","if",266],["T_WHITESPACE"," ",266],"(",["T_ISSET","isset",266],"(",["T_VARIABLE","$data",266],"[",["T_CONSTANT_ENCAPSED_STRING","'adjustment_positive'",266],"]",")",")",["T_WHITESPACE"," ",266],"{",["T_WHITESPACE","\n            ",266],["T_VARIABLE","$creditmemo",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","setAdjustmentPositive",267],"(",["T_VARIABLE","$data",267],"[",["T_CONSTANT_ENCAPSED_STRING","'adjustment_positive'",267],"]",")",";",["T_WHITESPACE","\n        ",267],"}",["T_WHITESPACE","\n        ",268],["T_IF","if",269],["T_WHITESPACE"," ",269],"(",["T_ISSET","isset",269],"(",["T_VARIABLE","$data",269],"[",["T_CONSTANT_ENCAPSED_STRING","'adjustment_negative'",269],"]",")",")",["T_WHITESPACE"," ",269],"{",["T_WHITESPACE","\n            ",269],["T_VARIABLE","$creditmemo",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","setAdjustmentNegative",270],"(",["T_VARIABLE","$data",270],"[",["T_CONSTANT_ENCAPSED_STRING","'adjustment_negative'",270],"]",")",";",["T_WHITESPACE","\n        ",270],"}",["T_WHITESPACE","\n    ",271],"}",["T_WHITESPACE","\n\n    ",272],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Sales\\Api\\Data\\OrderItemInterface $orderItem\n     * @param int $parentQty\n     * @return int\n     *\/",274],["T_WHITESPACE","\n    ",278],["T_PRIVATE","private",279],["T_WHITESPACE"," ",279],["T_FUNCTION","function",279],["T_WHITESPACE"," ",279],["T_STRING","calculateProductOptions",279],"(",["T_NS_SEPARATOR","\\",279],["T_STRING","Magento",279],["T_NS_SEPARATOR","\\",279],["T_STRING","Sales",279],["T_NS_SEPARATOR","\\",279],["T_STRING","Api",279],["T_NS_SEPARATOR","\\",279],["T_STRING","Data",279],["T_NS_SEPARATOR","\\",279],["T_STRING","OrderItemInterface",279],["T_WHITESPACE"," ",279],["T_VARIABLE","$orderItem",279],",",["T_WHITESPACE"," ",279],["T_VARIABLE","$parentQty",279],")",["T_WHITESPACE","\n    ",279],"{",["T_WHITESPACE","\n        ",280],["T_VARIABLE","$qty",281],["T_WHITESPACE"," ",281],"=",["T_WHITESPACE"," ",281],["T_VARIABLE","$parentQty",281],";",["T_WHITESPACE","\n        ",281],["T_VARIABLE","$productOptions",282],["T_WHITESPACE"," ",282],"=",["T_WHITESPACE"," ",282],["T_VARIABLE","$orderItem",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","getProductOptions",282],"(",")",";",["T_WHITESPACE","\n        ",282],["T_IF","if",283],["T_WHITESPACE"," ",283],"(",["T_ISSET","isset",283],"(",["T_VARIABLE","$productOptions",283],"[",["T_CONSTANT_ENCAPSED_STRING","'bundle_selection_attributes'",283],"]",")",")",["T_WHITESPACE"," ",283],"{",["T_WHITESPACE","\n            ",283],["T_VARIABLE","$bundleSelectionAttributes",284],["T_WHITESPACE"," ",284],"=",["T_WHITESPACE"," ",284],["T_VARIABLE","$this",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","serializer",284],["T_WHITESPACE","\n                ",284],["T_OBJECT_OPERATOR","->",285],["T_STRING","unserialize",285],"(",["T_VARIABLE","$productOptions",285],"[",["T_CONSTANT_ENCAPSED_STRING","'bundle_selection_attributes'",285],"]",")",";",["T_WHITESPACE","\n            ",285],["T_IF","if",286],["T_WHITESPACE"," ",286],"(",["T_VARIABLE","$bundleSelectionAttributes",286],")",["T_WHITESPACE"," ",286],"{",["T_WHITESPACE","\n                ",286],["T_VARIABLE","$qty",287],["T_WHITESPACE"," ",287],"=",["T_WHITESPACE"," ",287],["T_VARIABLE","$bundleSelectionAttributes",287],"[",["T_CONSTANT_ENCAPSED_STRING","'qty'",287],"]",["T_WHITESPACE"," ",287],"*",["T_WHITESPACE"," ",287],["T_VARIABLE","$parentQty",287],";",["T_WHITESPACE","\n            ",287],"}",["T_WHITESPACE","\n        ",288],"}",["T_WHITESPACE","\n        ",289],["T_RETURN","return",290],["T_WHITESPACE"," ",290],["T_VARIABLE","$qty",290],";",["T_WHITESPACE","\n    ",290],"}",["T_WHITESPACE","\n",291],"}",["T_WHITESPACE","\n",292]]