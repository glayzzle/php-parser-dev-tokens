[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_COMMENT","\/\/ @codingStandardsIgnoreFile\n",7],["T_WHITESPACE","\n",8],["T_NAMESPACE","namespace",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Sales",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Model",9],["T_NS_SEPARATOR","\\",9],["T_STRING","ResourceModel",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Report",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Bestsellers",9],";",["T_WHITESPACE","\n\n",9],["T_DOC_COMMENT","\/**\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",11],["T_WHITESPACE","\n",13],["T_CLASS","class",14],["T_WHITESPACE"," ",14],["T_STRING","Collection",14],["T_WHITESPACE"," ",14],["T_EXTENDS","extends",14],["T_WHITESPACE"," ",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Sales",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Model",14],["T_NS_SEPARATOR","\\",14],["T_STRING","ResourceModel",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Report",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Collection",14],["T_NS_SEPARATOR","\\",14],["T_STRING","AbstractCollection",14],["T_WHITESPACE","\n",14],"{",["T_WHITESPACE","\n    ",15],["T_DOC_COMMENT","\/**\n     * Rating limit\n     *\n     * @var int\n     *\/",16],["T_WHITESPACE","\n    ",20],["T_PROTECTED","protected",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$_ratingLimit",21],["T_WHITESPACE"," ",21],"=",["T_WHITESPACE"," ",21],["T_LNUMBER","5",21],";",["T_WHITESPACE","\n\n    ",21],["T_DOC_COMMENT","\/**\n     * Selected columns\n     *\n     * @var array\n     *\/",23],["T_WHITESPACE","\n    ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$_selectedColumns",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],"[","]",";",["T_WHITESPACE","\n\n    ",28],["T_DOC_COMMENT","\/**\n     * Tables per period\n     *\n     * @var array\n     *\/",30],["T_WHITESPACE","\n    ",34],["T_PROTECTED","protected",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$tableForPeriod",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],"[",["T_WHITESPACE","\n        ",35],["T_CONSTANT_ENCAPSED_STRING","'daily'",36],["T_WHITESPACE","   ",36],["T_DOUBLE_ARROW","=>",36],["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'sales_bestsellers_aggregated_daily'",36],",",["T_WHITESPACE","\n        ",36],["T_CONSTANT_ENCAPSED_STRING","'monthly'",37],["T_WHITESPACE"," ",37],["T_DOUBLE_ARROW","=>",37],["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'sales_bestsellers_aggregated_monthly'",37],",",["T_WHITESPACE","\n        ",37],["T_CONSTANT_ENCAPSED_STRING","'yearly'",38],["T_WHITESPACE","  ",38],["T_DOUBLE_ARROW","=>",38],["T_WHITESPACE"," ",38],["T_CONSTANT_ENCAPSED_STRING","'sales_bestsellers_aggregated_yearly'",38],",",["T_WHITESPACE","\n    ",38],"]",";",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\Data\\Collection\\EntityFactory $entityFactory\n     * @param \\Psr\\Log\\LoggerInterface $logger\n     * @param \\Magento\\Framework\\Data\\Collection\\Db\\FetchStrategyInterface $fetchStrategy\n     * @param \\Magento\\Framework\\Event\\ManagerInterface $eventManager\n     * @param \\Magento\\Sales\\Model\\ResourceModel\\Report $resource\n     * @param \\Magento\\Framework\\DB\\Adapter\\AdapterInterface $connection\n     *\/",41],["T_WHITESPACE","\n    ",48],["T_PUBLIC","public",49],["T_WHITESPACE"," ",49],["T_FUNCTION","function",49],["T_WHITESPACE"," ",49],["T_STRING","__construct",49],"(",["T_WHITESPACE","\n        ",49],["T_NS_SEPARATOR","\\",50],["T_STRING","Magento",50],["T_NS_SEPARATOR","\\",50],["T_STRING","Framework",50],["T_NS_SEPARATOR","\\",50],["T_STRING","Data",50],["T_NS_SEPARATOR","\\",50],["T_STRING","Collection",50],["T_NS_SEPARATOR","\\",50],["T_STRING","EntityFactory",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$entityFactory",50],",",["T_WHITESPACE","\n        ",50],["T_NS_SEPARATOR","\\",51],["T_STRING","Psr",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Log",51],["T_NS_SEPARATOR","\\",51],["T_STRING","LoggerInterface",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$logger",51],",",["T_WHITESPACE","\n        ",51],["T_NS_SEPARATOR","\\",52],["T_STRING","Magento",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Framework",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Data",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Collection",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Db",52],["T_NS_SEPARATOR","\\",52],["T_STRING","FetchStrategyInterface",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$fetchStrategy",52],",",["T_WHITESPACE","\n        ",52],["T_NS_SEPARATOR","\\",53],["T_STRING","Magento",53],["T_NS_SEPARATOR","\\",53],["T_STRING","Framework",53],["T_NS_SEPARATOR","\\",53],["T_STRING","Event",53],["T_NS_SEPARATOR","\\",53],["T_STRING","ManagerInterface",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$eventManager",53],",",["T_WHITESPACE","\n        ",53],["T_NS_SEPARATOR","\\",54],["T_STRING","Magento",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Sales",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Model",54],["T_NS_SEPARATOR","\\",54],["T_STRING","ResourceModel",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Report",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$resource",54],",",["T_WHITESPACE","\n        ",54],["T_NS_SEPARATOR","\\",55],["T_STRING","Magento",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Framework",55],["T_NS_SEPARATOR","\\",55],["T_STRING","DB",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Adapter",55],["T_NS_SEPARATOR","\\",55],["T_STRING","AdapterInterface",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$connection",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","null",55],["T_WHITESPACE","\n    ",55],")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$resource",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","init",57],"(",["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","getTableByAggregationPeriod",57],"(",["T_CONSTANT_ENCAPSED_STRING","'daily'",57],")",")",";",["T_WHITESPACE","\n        ",57],["T_STRING","parent",58],["T_DOUBLE_COLON","::",58],["T_STRING","__construct",58],"(",["T_VARIABLE","$entityFactory",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$logger",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$fetchStrategy",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$eventManager",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$resource",58],",",["T_WHITESPACE"," ",58],["T_VARIABLE","$connection",58],")",";",["T_WHITESPACE","\n    ",58],"}",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * Return ordered filed\n     *\n     * @return string\n     *\/",61],["T_WHITESPACE","\n    ",65],["T_PROTECTED","protected",66],["T_WHITESPACE"," ",66],["T_FUNCTION","function",66],["T_WHITESPACE"," ",66],["T_STRING","getOrderedField",66],"(",")",["T_WHITESPACE","\n    ",66],"{",["T_WHITESPACE","\n        ",67],["T_RETURN","return",68],["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'qty_ordered'",68],";",["T_WHITESPACE","\n    ",68],"}",["T_WHITESPACE","\n\n    ",69],["T_DOC_COMMENT","\/**\n     * Return table per period\n     *\n     * @param string $period\n     * @return mixed\n     *\/",71],["T_WHITESPACE","\n    ",76],["T_PUBLIC","public",77],["T_WHITESPACE"," ",77],["T_FUNCTION","function",77],["T_WHITESPACE"," ",77],["T_STRING","getTableByAggregationPeriod",77],"(",["T_VARIABLE","$period",77],")",["T_WHITESPACE","\n    ",77],"{",["T_WHITESPACE","\n        ",78],["T_RETURN","return",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","tableForPeriod",79],"[",["T_VARIABLE","$period",79],"]",";",["T_WHITESPACE","\n    ",79],"}",["T_WHITESPACE","\n\n    ",80],["T_DOC_COMMENT","\/**\n     * Retrieve selected columns\n     *\n     * @return array\n     *\/",82],["T_WHITESPACE","\n    ",86],["T_PROTECTED","protected",87],["T_WHITESPACE"," ",87],["T_FUNCTION","function",87],["T_WHITESPACE"," ",87],["T_STRING","_getSelectedColumns",87],"(",")",["T_WHITESPACE","\n    ",87],"{",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$connection",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getConnection",89],"(",")",";",["T_WHITESPACE","\n\n        ",89],["T_IF","if",91],["T_WHITESPACE"," ",91],"(","!",["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","_selectedColumns",91],")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n            ",91],["T_IF","if",92],["T_WHITESPACE"," ",92],"(",["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","isTotals",92],"(",")",")",["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n                ",92],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","_selectedColumns",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getAggregatedColumns",93],"(",")",";",["T_WHITESPACE","\n            ",93],"}",["T_WHITESPACE"," ",94],["T_ELSE","else",94],["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n                ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","_selectedColumns",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],"[",["T_WHITESPACE","\n                    ",95],["T_CONSTANT_ENCAPSED_STRING","'period'",96],["T_WHITESPACE"," ",96],["T_DOUBLE_ARROW","=>",96],["T_WHITESPACE"," ",96],["T_STRING","sprintf",96],"(",["T_CONSTANT_ENCAPSED_STRING","'MAX(%s)'",96],",",["T_WHITESPACE"," ",96],["T_VARIABLE","$connection",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getDateFormatSql",96],"(",["T_CONSTANT_ENCAPSED_STRING","'period'",96],",",["T_WHITESPACE"," ",96],["T_CONSTANT_ENCAPSED_STRING","'%Y-%m-%d'",96],")",")",",",["T_WHITESPACE","\n                    ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","getOrderedField",97],"(",")",["T_WHITESPACE"," ",97],["T_DOUBLE_ARROW","=>",97],["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","'SUM('",97],["T_WHITESPACE"," ",97],".",["T_WHITESPACE"," ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","getOrderedField",97],"(",")",["T_WHITESPACE"," ",97],".",["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","')'",97],",",["T_WHITESPACE","\n                    ",97],["T_CONSTANT_ENCAPSED_STRING","'product_id'",98],["T_WHITESPACE"," ",98],["T_DOUBLE_ARROW","=>",98],["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","'product_id'",98],",",["T_WHITESPACE","\n                    ",98],["T_CONSTANT_ENCAPSED_STRING","'product_name'",99],["T_WHITESPACE"," ",99],["T_DOUBLE_ARROW","=>",99],["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","'MAX(product_name)'",99],",",["T_WHITESPACE","\n                    ",99],["T_CONSTANT_ENCAPSED_STRING","'product_price'",100],["T_WHITESPACE"," ",100],["T_DOUBLE_ARROW","=>",100],["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","'MAX(product_price)'",100],",",["T_WHITESPACE","\n                ",100],"]",";",["T_WHITESPACE","\n                ",101],["T_IF","if",102],["T_WHITESPACE"," ",102],"(",["T_CONSTANT_ENCAPSED_STRING","'year'",102],["T_WHITESPACE"," ",102],["T_IS_EQUAL","==",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","_period",102],")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n                    ",102],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","_selectedColumns",103],"[",["T_CONSTANT_ENCAPSED_STRING","'period'",103],"]",["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$connection",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getDateFormatSql",103],"(",["T_CONSTANT_ENCAPSED_STRING","'period'",103],",",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","'%Y'",103],")",";",["T_WHITESPACE","\n                ",103],"}",["T_WHITESPACE"," ",104],["T_ELSEIF","elseif",104],["T_WHITESPACE"," ",104],"(",["T_CONSTANT_ENCAPSED_STRING","'month'",104],["T_WHITESPACE"," ",104],["T_IS_EQUAL","==",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","_period",104],")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n                    ",104],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","_selectedColumns",105],"[",["T_CONSTANT_ENCAPSED_STRING","'period'",105],"]",["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_VARIABLE","$connection",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getDateFormatSql",105],"(",["T_CONSTANT_ENCAPSED_STRING","'period'",105],",",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'%Y-%m'",105],")",";",["T_WHITESPACE","\n                ",105],"}",["T_WHITESPACE","\n            ",106],"}",["T_WHITESPACE","\n        ",107],"}",["T_WHITESPACE","\n        ",108],["T_RETURN","return",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","_selectedColumns",109],";",["T_WHITESPACE","\n    ",109],"}",["T_WHITESPACE","\n\n    ",110],["T_DOC_COMMENT","\/**\n     * Make select object for date boundary\n     *\n     * @param string $from\n     * @param string $to\n     * @return \\Magento\\Framework\\DB\\Select\n     *\/",112],["T_WHITESPACE","\n    ",118],["T_PROTECTED","protected",119],["T_WHITESPACE"," ",119],["T_FUNCTION","function",119],["T_WHITESPACE"," ",119],["T_STRING","_makeBoundarySelect",119],"(",["T_VARIABLE","$from",119],",",["T_WHITESPACE"," ",119],["T_VARIABLE","$to",119],")",["T_WHITESPACE","\n    ",119],"{",["T_WHITESPACE","\n        ",120],["T_VARIABLE","$connection",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","getConnection",121],"(",")",";",["T_WHITESPACE","\n        ",121],["T_VARIABLE","$cols",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","_getSelectedColumns",122],"(",")",";",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$cols",123],"[",["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getOrderedField",123],"(",")","]",["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'SUM('",123],["T_WHITESPACE"," ",123],".",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getOrderedField",123],"(",")",["T_WHITESPACE"," ",123],".",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","')'",123],";",["T_WHITESPACE","\n        ",123],["T_VARIABLE","$select",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$connection",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","select",124],"(",")",["T_OBJECT_OPERATOR","->",124],["T_STRING","from",124],"(",["T_WHITESPACE","\n            ",124],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","getResource",125],"(",")",["T_OBJECT_OPERATOR","->",125],["T_STRING","getMainTable",125],"(",")",",",["T_WHITESPACE","\n            ",125],["T_VARIABLE","$cols",126],["T_WHITESPACE","\n        ",126],")",["T_OBJECT_OPERATOR","->",127],["T_STRING","where",127],"(",["T_WHITESPACE","\n            ",127],["T_CONSTANT_ENCAPSED_STRING","'period >= ?'",128],",",["T_WHITESPACE","\n            ",128],["T_VARIABLE","$from",129],["T_WHITESPACE","\n        ",129],")",["T_OBJECT_OPERATOR","->",130],["T_STRING","where",130],"(",["T_WHITESPACE","\n            ",130],["T_CONSTANT_ENCAPSED_STRING","'period <= ?'",131],",",["T_WHITESPACE","\n            ",131],["T_VARIABLE","$to",132],["T_WHITESPACE","\n        ",132],")",["T_OBJECT_OPERATOR","->",133],["T_STRING","group",133],"(",["T_WHITESPACE","\n            ",133],["T_CONSTANT_ENCAPSED_STRING","'product_id'",134],["T_WHITESPACE","\n        ",134],")",["T_OBJECT_OPERATOR","->",135],["T_STRING","order",135],"(",["T_WHITESPACE","\n            ",135],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getOrderedField",136],"(",")",["T_WHITESPACE"," ",136],".",["T_WHITESPACE"," ",136],["T_CONSTANT_ENCAPSED_STRING","' DESC'",136],["T_WHITESPACE","\n        ",136],")",["T_OBJECT_OPERATOR","->",137],["T_STRING","limit",137],"(",["T_WHITESPACE","\n            ",137],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","_ratingLimit",138],["T_WHITESPACE","\n        ",138],")",";",["T_WHITESPACE","\n\n        ",139],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","_applyStoresFilterToSelect",141],"(",["T_VARIABLE","$select",141],")",";",["T_WHITESPACE","\n\n        ",141],["T_RETURN","return",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$select",143],";",["T_WHITESPACE","\n    ",143],"}",["T_WHITESPACE","\n\n    ",144],["T_DOC_COMMENT","\/**\n     * Init collection select\n     *\n     * @return $this\n     *\/",146],["T_WHITESPACE","\n    ",150],["T_PROTECTED","protected",151],["T_WHITESPACE"," ",151],["T_FUNCTION","function",151],["T_WHITESPACE"," ",151],["T_STRING","_applyAggregatedTable",151],"(",")",["T_WHITESPACE","\n    ",151],"{",["T_WHITESPACE","\n        ",152],["T_VARIABLE","$select",153],["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","getSelect",153],"(",")",";",["T_WHITESPACE","\n\n        ",153],["T_COMMENT","\/\/if grouping by product, not by period\n",155],["T_WHITESPACE","        ",156],["T_IF","if",156],["T_WHITESPACE"," ",156],"(","!",["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","_period",156],")",["T_WHITESPACE"," ",156],"{",["T_WHITESPACE","\n            ",156],["T_VARIABLE","$cols",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","_getSelectedColumns",157],"(",")",";",["T_WHITESPACE","\n            ",157],["T_VARIABLE","$cols",158],"[",["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","getOrderedField",158],"(",")","]",["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","'SUM('",158],["T_WHITESPACE"," ",158],".",["T_WHITESPACE"," ",158],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","getOrderedField",158],"(",")",["T_WHITESPACE"," ",158],".",["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","')'",158],";",["T_WHITESPACE","\n            ",158],["T_IF","if",159],["T_WHITESPACE"," ",159],"(",["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","_from",159],["T_WHITESPACE"," ",159],["T_BOOLEAN_OR","||",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","_to",159],")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n                ",159],["T_VARIABLE","$mainTable",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","getTable",160],"(",["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","getTableByAggregationPeriod",160],"(",["T_CONSTANT_ENCAPSED_STRING","'daily'",160],")",")",";",["T_WHITESPACE","\n                ",160],["T_VARIABLE","$select",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","from",161],"(",["T_VARIABLE","$mainTable",161],",",["T_WHITESPACE"," ",161],["T_VARIABLE","$cols",161],")",";",["T_WHITESPACE","\n            ",161],"}",["T_WHITESPACE"," ",162],["T_ELSE","else",162],["T_WHITESPACE"," ",162],"{",["T_WHITESPACE","\n                ",162],["T_VARIABLE","$mainTable",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","getTable",163],"(",["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","getTableByAggregationPeriod",163],"(",["T_CONSTANT_ENCAPSED_STRING","'yearly'",163],")",")",";",["T_WHITESPACE","\n                ",163],["T_VARIABLE","$select",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","from",164],"(",["T_VARIABLE","$mainTable",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$cols",164],")",";",["T_WHITESPACE","\n            ",164],"}",["T_WHITESPACE","\n\n            ",165],["T_COMMENT","\/\/exclude removed products\n",167],["T_WHITESPACE","            ",168],["T_VARIABLE","$select",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","where",168],"(",["T_NEW","new",168],["T_WHITESPACE"," ",168],["T_NS_SEPARATOR","\\",168],["T_STRING","Zend_Db_Expr",168],"(",["T_VARIABLE","$mainTable",168],["T_WHITESPACE"," ",168],".",["T_WHITESPACE"," ",168],["T_CONSTANT_ENCAPSED_STRING","'.product_id IS NOT NULL'",168],")",")",["T_OBJECT_OPERATOR","->",168],["T_STRING","group",168],"(",["T_WHITESPACE","\n                ",168],["T_CONSTANT_ENCAPSED_STRING","'product_id'",169],["T_WHITESPACE","\n            ",169],")",["T_OBJECT_OPERATOR","->",170],["T_STRING","order",170],"(",["T_WHITESPACE","\n                ",170],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","getOrderedField",171],"(",")",["T_WHITESPACE"," ",171],".",["T_WHITESPACE"," ",171],["T_CONSTANT_ENCAPSED_STRING","' '",171],["T_WHITESPACE"," ",171],".",["T_WHITESPACE"," ",171],["T_NS_SEPARATOR","\\",171],["T_STRING","Magento",171],["T_NS_SEPARATOR","\\",171],["T_STRING","Framework",171],["T_NS_SEPARATOR","\\",171],["T_STRING","DB",171],["T_NS_SEPARATOR","\\",171],["T_STRING","Select",171],["T_DOUBLE_COLON","::",171],["T_STRING","SQL_DESC",171],["T_WHITESPACE","\n            ",171],")",["T_OBJECT_OPERATOR","->",172],["T_STRING","limit",172],"(",["T_WHITESPACE","\n                ",172],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","_ratingLimit",173],["T_WHITESPACE","\n            ",173],")",";",["T_WHITESPACE","\n\n            ",174],["T_RETURN","return",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$this",176],";",["T_WHITESPACE","\n        ",176],"}",["T_WHITESPACE","\n\n        ",177],["T_IF","if",179],["T_WHITESPACE"," ",179],"(",["T_CONSTANT_ENCAPSED_STRING","'year'",179],["T_WHITESPACE"," ",179],["T_IS_EQUAL","==",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","_period",179],")",["T_WHITESPACE"," ",179],"{",["T_WHITESPACE","\n            ",179],["T_VARIABLE","$mainTable",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","getTable",180],"(",["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","getTableByAggregationPeriod",180],"(",["T_CONSTANT_ENCAPSED_STRING","'yearly'",180],")",")",";",["T_WHITESPACE","\n            ",180],["T_VARIABLE","$select",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","from",181],"(",["T_VARIABLE","$mainTable",181],",",["T_WHITESPACE"," ",181],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","_getSelectedColumns",181],"(",")",")",";",["T_WHITESPACE","\n        ",181],"}",["T_WHITESPACE"," ",182],["T_ELSEIF","elseif",182],["T_WHITESPACE"," ",182],"(",["T_CONSTANT_ENCAPSED_STRING","'month'",182],["T_WHITESPACE"," ",182],["T_IS_EQUAL","==",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","_period",182],")",["T_WHITESPACE"," ",182],"{",["T_WHITESPACE","\n            ",182],["T_VARIABLE","$mainTable",183],["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","getTable",183],"(",["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","getTableByAggregationPeriod",183],"(",["T_CONSTANT_ENCAPSED_STRING","'monthly'",183],")",")",";",["T_WHITESPACE","\n            ",183],["T_VARIABLE","$select",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","from",184],"(",["T_VARIABLE","$mainTable",184],",",["T_WHITESPACE"," ",184],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","_getSelectedColumns",184],"(",")",")",";",["T_WHITESPACE","\n        ",184],"}",["T_WHITESPACE"," ",185],["T_ELSE","else",185],["T_WHITESPACE"," ",185],"{",["T_WHITESPACE","\n            ",185],["T_VARIABLE","$mainTable",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","getTable",186],"(",["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","getTableByAggregationPeriod",186],"(",["T_CONSTANT_ENCAPSED_STRING","'daily'",186],")",")",";",["T_WHITESPACE","\n            ",186],["T_VARIABLE","$select",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","from",187],"(",["T_VARIABLE","$mainTable",187],",",["T_WHITESPACE"," ",187],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","_getSelectedColumns",187],"(",")",")",";",["T_WHITESPACE","\n        ",187],"}",["T_WHITESPACE","\n        ",188],["T_IF","if",189],["T_WHITESPACE"," ",189],"(","!",["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","isTotals",189],"(",")",")",["T_WHITESPACE"," ",189],"{",["T_WHITESPACE","\n            ",189],["T_VARIABLE","$select",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","group",190],"(","[",["T_CONSTANT_ENCAPSED_STRING","'period'",190],",",["T_WHITESPACE"," ",190],["T_CONSTANT_ENCAPSED_STRING","'product_id'",190],"]",")",";",["T_WHITESPACE","\n        ",190],"}",["T_WHITESPACE","\n        ",191],["T_VARIABLE","$select",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","where",192],"(",["T_CONSTANT_ENCAPSED_STRING","'rating_pos <= ?'",192],",",["T_WHITESPACE"," ",192],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","_ratingLimit",192],")",";",["T_WHITESPACE","\n\n        ",192],["T_RETURN","return",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$this",194],";",["T_WHITESPACE","\n    ",194],"}",["T_WHITESPACE","\n\n    ",195],["T_DOC_COMMENT","\/**\n     * Get SQL for get record count\n     *\n     * @return \\Magento\\Framework\\DB\\Select\n     *\/",197],["T_WHITESPACE","\n    ",201],["T_PUBLIC","public",202],["T_WHITESPACE"," ",202],["T_FUNCTION","function",202],["T_WHITESPACE"," ",202],["T_STRING","getSelectCountSql",202],"(",")",["T_WHITESPACE","\n    ",202],"{",["T_WHITESPACE","\n        ",203],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","_renderFilters",204],"(",")",";",["T_WHITESPACE","\n        ",204],["T_VARIABLE","$select",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_CLONE","clone",205],["T_WHITESPACE"," ",205],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","getSelect",205],"(",")",";",["T_WHITESPACE","\n        ",205],["T_VARIABLE","$select",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","reset",206],"(",["T_NS_SEPARATOR","\\",206],["T_STRING","Magento",206],["T_NS_SEPARATOR","\\",206],["T_STRING","Framework",206],["T_NS_SEPARATOR","\\",206],["T_STRING","DB",206],["T_NS_SEPARATOR","\\",206],["T_STRING","Select",206],["T_DOUBLE_COLON","::",206],["T_STRING","ORDER",206],")",";",["T_WHITESPACE","\n        ",206],["T_RETURN","return",207],["T_WHITESPACE"," ",207],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","getConnection",207],"(",")",["T_OBJECT_OPERATOR","->",207],["T_STRING","select",207],"(",")",["T_OBJECT_OPERATOR","->",207],["T_STRING","from",207],"(",["T_VARIABLE","$select",207],",",["T_WHITESPACE"," ",207],["T_CONSTANT_ENCAPSED_STRING","'COUNT(*)'",207],")",";",["T_WHITESPACE","\n    ",207],"}",["T_WHITESPACE","\n\n    ",208],["T_DOC_COMMENT","\/**\n     * Set ids for store restrictions\n     *\n     * @param  int|int[] $storeIds\n     * @return $this\n     *\/",210],["T_WHITESPACE","\n    ",215],["T_PUBLIC","public",216],["T_WHITESPACE"," ",216],["T_FUNCTION","function",216],["T_WHITESPACE"," ",216],["T_STRING","addStoreRestrictions",216],"(",["T_VARIABLE","$storeIds",216],")",["T_WHITESPACE","\n    ",216],"{",["T_WHITESPACE","\n        ",217],["T_IF","if",218],["T_WHITESPACE"," ",218],"(","!",["T_STRING","is_array",218],"(",["T_VARIABLE","$storeIds",218],")",")",["T_WHITESPACE"," ",218],"{",["T_WHITESPACE","\n            ",218],["T_VARIABLE","$storeIds",219],["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],"[",["T_VARIABLE","$storeIds",219],"]",";",["T_WHITESPACE","\n        ",219],"}",["T_WHITESPACE","\n        ",220],["T_VARIABLE","$currentStoreIds",221],["T_WHITESPACE"," ",221],"=",["T_WHITESPACE"," ",221],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","_storesIds",221],";",["T_WHITESPACE","\n        ",221],["T_IF","if",222],["T_WHITESPACE"," ",222],"(",["T_ISSET","isset",222],"(",["T_WHITESPACE","\n            ",222],["T_VARIABLE","$currentStoreIds",223],["T_WHITESPACE","\n        ",223],")",["T_WHITESPACE"," ",224],["T_BOOLEAN_AND","&&",224],["T_WHITESPACE"," ",224],["T_VARIABLE","$currentStoreIds",224],["T_WHITESPACE"," ",224],["T_IS_NOT_EQUAL","!=",224],["T_WHITESPACE"," ",224],["T_NS_SEPARATOR","\\",224],["T_STRING","Magento",224],["T_NS_SEPARATOR","\\",224],["T_STRING","Store",224],["T_NS_SEPARATOR","\\",224],["T_STRING","Model",224],["T_NS_SEPARATOR","\\",224],["T_STRING","Store",224],["T_DOUBLE_COLON","::",224],["T_STRING","DEFAULT_STORE_ID",224],["T_WHITESPACE"," ",224],["T_BOOLEAN_AND","&&",224],["T_WHITESPACE"," ",224],["T_VARIABLE","$currentStoreIds",224],["T_WHITESPACE"," ",224],["T_IS_NOT_EQUAL","!=",224],["T_WHITESPACE"," ",224],"[",["T_WHITESPACE","\n            ",224],["T_NS_SEPARATOR","\\",225],["T_STRING","Magento",225],["T_NS_SEPARATOR","\\",225],["T_STRING","Store",225],["T_NS_SEPARATOR","\\",225],["T_STRING","Model",225],["T_NS_SEPARATOR","\\",225],["T_STRING","Store",225],["T_DOUBLE_COLON","::",225],["T_STRING","DEFAULT_STORE_ID",225],["T_WHITESPACE","\n        ",225],"]",["T_WHITESPACE","\n        ",226],")",["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n            ",227],["T_IF","if",228],["T_WHITESPACE"," ",228],"(","!",["T_STRING","is_array",228],"(",["T_VARIABLE","$currentStoreIds",228],")",")",["T_WHITESPACE"," ",228],"{",["T_WHITESPACE","\n                ",228],["T_VARIABLE","$currentStoreIds",229],["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],"[",["T_VARIABLE","$currentStoreIds",229],"]",";",["T_WHITESPACE","\n            ",229],"}",["T_WHITESPACE","\n            ",230],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","_storesIds",231],["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],["T_STRING","array_intersect",231],"(",["T_VARIABLE","$currentStoreIds",231],",",["T_WHITESPACE"," ",231],["T_VARIABLE","$storeIds",231],")",";",["T_WHITESPACE","\n        ",231],"}",["T_WHITESPACE"," ",232],["T_ELSE","else",232],["T_WHITESPACE"," ",232],"{",["T_WHITESPACE","\n            ",232],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","_storesIds",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_VARIABLE","$storeIds",233],";",["T_WHITESPACE","\n        ",233],"}",["T_WHITESPACE","\n\n        ",234],["T_RETURN","return",236],["T_WHITESPACE"," ",236],["T_VARIABLE","$this",236],";",["T_WHITESPACE","\n    ",236],"}",["T_WHITESPACE","\n\n    ",237],["T_DOC_COMMENT","\/**\n     * Redeclare parent method for applying filters after parent method\n     * but before adding unions and calculating totals\n     *\n     * @return $this|\\Magento\\Framework\\Model\\ResourceModel\\Db\\Collection\\AbstractCollection\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     * @SuppressWarnings(PHPMD.NPathComplexity)\n     * @SuppressWarnings(PHPMD.ExcessiveMethodLength)\n     *\/",239],["T_WHITESPACE","\n    ",247],["T_PROTECTED","protected",248],["T_WHITESPACE"," ",248],["T_FUNCTION","function",248],["T_WHITESPACE"," ",248],["T_STRING","_beforeLoad",248],"(",")",["T_WHITESPACE","\n    ",248],"{",["T_WHITESPACE","\n        ",249],["T_STRING","parent",250],["T_DOUBLE_COLON","::",250],["T_STRING","_beforeLoad",250],"(",")",";",["T_WHITESPACE","\n\n        ",250],["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","_applyStoresFilter",252],"(",")",";",["T_WHITESPACE","\n\n        ",252],["T_IF","if",254],["T_WHITESPACE"," ",254],"(",["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","_period",254],")",["T_WHITESPACE"," ",254],"{",["T_WHITESPACE","\n            ",254],["T_VARIABLE","$selectUnions",255],["T_WHITESPACE"," ",255],"=",["T_WHITESPACE"," ",255],"[","]",";",["T_WHITESPACE","\n\n            ",255],["T_COMMENT","\/\/ apply date boundaries (before calling $this->_applyDateRangeFilter())\n",257],["T_WHITESPACE","            ",258],["T_VARIABLE","$periodFrom",258],["T_WHITESPACE"," ",258],"=",["T_WHITESPACE"," ",258],"!",["T_STRING","is_null",258],"(",["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","_from",258],")",["T_WHITESPACE"," ",258],"?",["T_WHITESPACE"," ",258],["T_NEW","new",258],["T_WHITESPACE"," ",258],["T_NS_SEPARATOR","\\",258],["T_STRING","DateTime",258],"(",["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","_from",258],")",["T_WHITESPACE"," ",258],":",["T_WHITESPACE"," ",258],["T_STRING","null",258],";",["T_WHITESPACE","\n            ",258],["T_VARIABLE","$periodTo",259],["T_WHITESPACE"," ",259],"=",["T_WHITESPACE"," ",259],"!",["T_STRING","is_null",259],"(",["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","_to",259],")",["T_WHITESPACE"," ",259],"?",["T_WHITESPACE"," ",259],["T_NEW","new",259],["T_WHITESPACE"," ",259],["T_NS_SEPARATOR","\\",259],["T_STRING","DateTime",259],"(",["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","_to",259],")",["T_WHITESPACE"," ",259],":",["T_WHITESPACE"," ",259],["T_STRING","null",259],";",["T_WHITESPACE","\n            ",259],["T_IF","if",260],["T_WHITESPACE"," ",260],"(",["T_CONSTANT_ENCAPSED_STRING","'year'",260],["T_WHITESPACE"," ",260],["T_IS_EQUAL","==",260],["T_WHITESPACE"," ",260],["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","_period",260],")",["T_WHITESPACE"," ",260],"{",["T_WHITESPACE","\n                ",260],["T_IF","if",261],["T_WHITESPACE"," ",261],"(",["T_VARIABLE","$periodFrom",261],")",["T_WHITESPACE"," ",261],"{",["T_WHITESPACE","\n                    ",261],["T_COMMENT","\/\/ not the first day of the year\n",262],["T_WHITESPACE","                    ",263],["T_IF","if",263],["T_WHITESPACE"," ",263],"(",["T_VARIABLE","$periodFrom",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","format",263],"(",["T_CONSTANT_ENCAPSED_STRING","'m'",263],")",["T_WHITESPACE"," ",263],["T_IS_NOT_EQUAL","!=",263],["T_WHITESPACE"," ",263],["T_LNUMBER","1",263],["T_WHITESPACE"," ",263],["T_BOOLEAN_OR","||",263],["T_WHITESPACE"," ",263],["T_VARIABLE","$periodFrom",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","format",263],"(",["T_CONSTANT_ENCAPSED_STRING","'d'",263],")",["T_WHITESPACE"," ",263],["T_IS_NOT_EQUAL","!=",263],["T_WHITESPACE"," ",263],["T_LNUMBER","1",263],")",["T_WHITESPACE"," ",263],"{",["T_WHITESPACE","\n                        ",263],["T_VARIABLE","$dtFrom",264],["T_WHITESPACE"," ",264],"=",["T_WHITESPACE"," ",264],["T_CLONE","clone",264],["T_WHITESPACE"," ",264],["T_VARIABLE","$periodFrom",264],";",["T_WHITESPACE","\n                        ",264],["T_COMMENT","\/\/ last day of the year\n",265],["T_WHITESPACE","                        ",266],["T_VARIABLE","$dtTo",266],["T_WHITESPACE"," ",266],"=",["T_WHITESPACE"," ",266],["T_CLONE","clone",266],["T_WHITESPACE"," ",266],["T_VARIABLE","$periodFrom",266],";",["T_WHITESPACE","\n                        ",266],["T_VARIABLE","$dtTo",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","setDate",267],"(",["T_VARIABLE","$dtTo",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","format",267],"(",["T_CONSTANT_ENCAPSED_STRING","'Y'",267],")",",",["T_WHITESPACE"," ",267],["T_LNUMBER","12",267],",",["T_WHITESPACE"," ",267],["T_LNUMBER","31",267],")",";",["T_WHITESPACE","\n                        ",267],["T_IF","if",268],["T_WHITESPACE"," ",268],"(","!",["T_VARIABLE","$periodTo",268],["T_WHITESPACE"," ",268],["T_BOOLEAN_OR","||",268],["T_WHITESPACE"," ",268],["T_VARIABLE","$dtTo",268],["T_WHITESPACE"," ",268],"<",["T_WHITESPACE"," ",268],["T_VARIABLE","$periodTo",268],")",["T_WHITESPACE"," ",268],"{",["T_WHITESPACE","\n                            ",268],["T_VARIABLE","$selectUnions",269],"[","]",["T_WHITESPACE"," ",269],"=",["T_WHITESPACE"," ",269],["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","_makeBoundarySelect",269],"(",["T_WHITESPACE","\n                                ",269],["T_VARIABLE","$dtFrom",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","format",270],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d'",270],")",",",["T_WHITESPACE","\n                                ",270],["T_VARIABLE","$dtTo",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","format",271],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d'",271],")",["T_WHITESPACE","\n                            ",271],")",";",["T_WHITESPACE","\n\n                            ",272],["T_COMMENT","\/\/ first day of the next year\n",274],["T_WHITESPACE","                            ",275],["T_VARIABLE","$this",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","_from",275],["T_WHITESPACE"," ",275],"=",["T_WHITESPACE"," ",275],["T_CLONE","clone",275],["T_WHITESPACE"," ",275],["T_VARIABLE","$periodFrom",275],";",["T_WHITESPACE","\n                            ",275],["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","_from",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","modify",276],"(",["T_CONSTANT_ENCAPSED_STRING","'+1 year'",276],")",";",["T_WHITESPACE","\n                            ",276],["T_VARIABLE","$this",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","_from",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","setDate",277],"(",["T_VARIABLE","$this",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","_from",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","format",277],"(",["T_CONSTANT_ENCAPSED_STRING","'Y'",277],")",",",["T_WHITESPACE"," ",277],["T_LNUMBER","1",277],",",["T_WHITESPACE"," ",277],["T_LNUMBER","1",277],")",";",["T_WHITESPACE","\n                            ",277],["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","_from",278],["T_WHITESPACE"," ",278],"=",["T_WHITESPACE"," ",278],["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","_from",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","format",278],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d'",278],")",";",["T_WHITESPACE","\n                        ",278],"}",["T_WHITESPACE","\n                    ",279],"}",["T_WHITESPACE","\n                ",280],"}",["T_WHITESPACE","\n\n                ",281],["T_IF","if",283],["T_WHITESPACE"," ",283],"(",["T_VARIABLE","$periodTo",283],")",["T_WHITESPACE"," ",283],"{",["T_WHITESPACE","\n                    ",283],["T_COMMENT","\/\/ not the last day of the year\n",284],["T_WHITESPACE","                    ",285],["T_IF","if",285],["T_WHITESPACE"," ",285],"(",["T_VARIABLE","$periodTo",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","format",285],"(",["T_CONSTANT_ENCAPSED_STRING","'m'",285],")",["T_WHITESPACE"," ",285],["T_IS_NOT_EQUAL","!=",285],["T_WHITESPACE"," ",285],["T_LNUMBER","12",285],["T_WHITESPACE"," ",285],["T_BOOLEAN_OR","||",285],["T_WHITESPACE"," ",285],["T_VARIABLE","$periodTo",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","format",285],"(",["T_CONSTANT_ENCAPSED_STRING","'d'",285],")",["T_WHITESPACE"," ",285],["T_IS_NOT_EQUAL","!=",285],["T_WHITESPACE"," ",285],["T_LNUMBER","31",285],")",["T_WHITESPACE"," ",285],"{",["T_WHITESPACE","\n                        ",285],["T_VARIABLE","$dtFrom",286],["T_WHITESPACE"," ",286],"=",["T_WHITESPACE"," ",286],["T_CLONE","clone",286],["T_WHITESPACE"," ",286],["T_VARIABLE","$periodTo",286],";",["T_WHITESPACE","\n                        ",286],["T_VARIABLE","$dtFrom",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","setDate",287],"(",["T_VARIABLE","$dtFrom",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","format",287],"(",["T_CONSTANT_ENCAPSED_STRING","'Y'",287],")",",",["T_WHITESPACE"," ",287],["T_LNUMBER","1",287],",",["T_WHITESPACE"," ",287],["T_LNUMBER","1",287],")",";",["T_WHITESPACE","\n                        ",287],["T_COMMENT","\/\/ first day of the year\n",288],["T_WHITESPACE","                        ",289],["T_VARIABLE","$dtTo",289],["T_WHITESPACE"," ",289],"=",["T_WHITESPACE"," ",289],["T_CLONE","clone",289],["T_WHITESPACE"," ",289],["T_VARIABLE","$periodTo",289],";",["T_WHITESPACE","\n                        ",289],["T_IF","if",290],["T_WHITESPACE"," ",290],"(","!",["T_VARIABLE","$periodFrom",290],["T_WHITESPACE"," ",290],["T_BOOLEAN_OR","||",290],["T_WHITESPACE"," ",290],["T_VARIABLE","$dtFrom",290],["T_WHITESPACE"," ",290],">",["T_WHITESPACE"," ",290],["T_VARIABLE","$periodFrom",290],")",["T_WHITESPACE"," ",290],"{",["T_WHITESPACE","\n                            ",290],["T_VARIABLE","$selectUnions",291],"[","]",["T_WHITESPACE"," ",291],"=",["T_WHITESPACE"," ",291],["T_VARIABLE","$this",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","_makeBoundarySelect",291],"(",["T_WHITESPACE","\n                                ",291],["T_VARIABLE","$dtFrom",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","format",292],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d'",292],")",",",["T_WHITESPACE","\n                                ",292],["T_VARIABLE","$dtTo",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","format",293],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d'",293],")",["T_WHITESPACE","\n                            ",293],")",";",["T_WHITESPACE","\n\n                            ",294],["T_COMMENT","\/\/ last day of the previous year\n",296],["T_WHITESPACE","                            ",297],["T_VARIABLE","$this",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","_to",297],["T_WHITESPACE"," ",297],"=",["T_WHITESPACE"," ",297],["T_CLONE","clone",297],["T_WHITESPACE"," ",297],["T_VARIABLE","$periodTo",297],";",["T_WHITESPACE","\n                            ",297],["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","_to",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","modify",298],"(",["T_CONSTANT_ENCAPSED_STRING","'-1 year'",298],")",";",["T_WHITESPACE","\n                            ",298],["T_VARIABLE","$this",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","_to",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","setDate",299],"(",["T_VARIABLE","$this",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","_to",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","format",299],"(",["T_CONSTANT_ENCAPSED_STRING","'Y'",299],")",",",["T_WHITESPACE"," ",299],["T_LNUMBER","12",299],",",["T_WHITESPACE"," ",299],["T_LNUMBER","31",299],")",";",["T_WHITESPACE","\n                            ",299],["T_VARIABLE","$this",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","_to",300],["T_WHITESPACE"," ",300],"=",["T_WHITESPACE"," ",300],["T_VARIABLE","$this",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","_to",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","format",300],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d'",300],")",";",["T_WHITESPACE","\n                        ",300],"}",["T_WHITESPACE","\n                    ",301],"}",["T_WHITESPACE","\n                ",302],"}",["T_WHITESPACE","\n\n                ",303],["T_IF","if",305],["T_WHITESPACE"," ",305],"(",["T_VARIABLE","$periodFrom",305],["T_WHITESPACE"," ",305],["T_BOOLEAN_AND","&&",305],["T_WHITESPACE"," ",305],["T_VARIABLE","$periodTo",305],")",["T_WHITESPACE"," ",305],"{",["T_WHITESPACE","\n                    ",305],["T_COMMENT","\/\/ the same year\n",306],["T_WHITESPACE","                    ",307],["T_IF","if",307],["T_WHITESPACE"," ",307],"(",["T_VARIABLE","$periodTo",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","format",307],"(",["T_CONSTANT_ENCAPSED_STRING","'Y'",307],")",["T_WHITESPACE"," ",307],["T_IS_EQUAL","==",307],["T_WHITESPACE"," ",307],["T_VARIABLE","$periodFrom",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","format",307],"(",["T_CONSTANT_ENCAPSED_STRING","'Y'",307],")",")",["T_WHITESPACE"," ",307],"{",["T_WHITESPACE","\n                        ",307],["T_VARIABLE","$dtFrom",308],["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],["T_CLONE","clone",308],["T_WHITESPACE"," ",308],["T_VARIABLE","$periodFrom",308],";",["T_WHITESPACE","\n                        ",308],["T_VARIABLE","$dtTo",309],["T_WHITESPACE"," ",309],"=",["T_WHITESPACE"," ",309],["T_CLONE","clone",309],["T_WHITESPACE"," ",309],["T_VARIABLE","$periodTo",309],";",["T_WHITESPACE","\n                        ",309],["T_VARIABLE","$selectUnions",310],"[","]",["T_WHITESPACE"," ",310],"=",["T_WHITESPACE"," ",310],["T_VARIABLE","$this",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","_makeBoundarySelect",310],"(",["T_WHITESPACE","\n                            ",310],["T_VARIABLE","$dtFrom",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","format",311],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d'",311],")",",",["T_WHITESPACE","\n                            ",311],["T_VARIABLE","$dtTo",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","format",312],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d'",312],")",["T_WHITESPACE","\n                        ",312],")",";",["T_WHITESPACE","\n\n                        ",313],["T_VARIABLE","$this",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","getSelect",315],"(",")",["T_OBJECT_OPERATOR","->",315],["T_STRING","where",315],"(",["T_CONSTANT_ENCAPSED_STRING","'1<>1'",315],")",";",["T_WHITESPACE","\n                    ",315],"}",["T_WHITESPACE","\n                ",316],"}",["T_WHITESPACE","\n            ",317],"}",["T_WHITESPACE"," ",318],["T_ELSEIF","elseif",318],["T_WHITESPACE"," ",318],"(",["T_CONSTANT_ENCAPSED_STRING","'month'",318],["T_WHITESPACE"," ",318],["T_IS_EQUAL","==",318],["T_WHITESPACE"," ",318],["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","_period",318],")",["T_WHITESPACE"," ",318],"{",["T_WHITESPACE","\n                ",318],["T_IF","if",319],["T_WHITESPACE"," ",319],"(",["T_VARIABLE","$periodFrom",319],")",["T_WHITESPACE"," ",319],"{",["T_WHITESPACE","\n                    ",319],["T_COMMENT","\/\/ not the first day of the month\n",320],["T_WHITESPACE","                    ",321],["T_IF","if",321],["T_WHITESPACE"," ",321],"(",["T_VARIABLE","$periodFrom",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","format",321],"(",["T_CONSTANT_ENCAPSED_STRING","'d'",321],")",["T_WHITESPACE"," ",321],["T_IS_NOT_EQUAL","!=",321],["T_WHITESPACE"," ",321],["T_LNUMBER","1",321],")",["T_WHITESPACE"," ",321],"{",["T_WHITESPACE","\n                        ",321],["T_VARIABLE","$dtFrom",322],["T_WHITESPACE"," ",322],"=",["T_WHITESPACE"," ",322],["T_CLONE","clone",322],["T_WHITESPACE"," ",322],["T_VARIABLE","$periodFrom",322],";",["T_WHITESPACE","\n                        ",322],["T_COMMENT","\/\/ last day of the month\n",323],["T_WHITESPACE","                        ",324],["T_VARIABLE","$dtTo",324],["T_WHITESPACE"," ",324],"=",["T_WHITESPACE"," ",324],["T_CLONE","clone",324],["T_WHITESPACE"," ",324],["T_VARIABLE","$periodFrom",324],";",["T_WHITESPACE","\n                        ",324],["T_VARIABLE","$dtTo",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","modify",325],"(",["T_CONSTANT_ENCAPSED_STRING","'+1 month'",325],")",";",["T_WHITESPACE","\n                        ",325],["T_VARIABLE","$dtTo",326],["T_OBJECT_OPERATOR","->",326],["T_STRING","setDate",326],"(",["T_VARIABLE","$dtTo",326],["T_OBJECT_OPERATOR","->",326],["T_STRING","format",326],"(",["T_CONSTANT_ENCAPSED_STRING","'Y'",326],")",",",["T_WHITESPACE"," ",326],["T_VARIABLE","$dtTo",326],["T_OBJECT_OPERATOR","->",326],["T_STRING","format",326],"(",["T_CONSTANT_ENCAPSED_STRING","'m'",326],")",",",["T_WHITESPACE"," ",326],["T_LNUMBER","1",326],")",";",["T_WHITESPACE","\n                        ",326],["T_VARIABLE","$dtTo",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","modify",327],"(",["T_CONSTANT_ENCAPSED_STRING","'-1 day'",327],")",";",["T_WHITESPACE","\n                        ",327],["T_IF","if",328],["T_WHITESPACE"," ",328],"(","!",["T_VARIABLE","$periodTo",328],["T_WHITESPACE"," ",328],["T_BOOLEAN_OR","||",328],["T_WHITESPACE"," ",328],["T_VARIABLE","$dtTo",328],["T_WHITESPACE"," ",328],"<",["T_WHITESPACE"," ",328],["T_VARIABLE","$periodTo",328],")",["T_WHITESPACE"," ",328],"{",["T_WHITESPACE","\n                            ",328],["T_VARIABLE","$selectUnions",329],"[","]",["T_WHITESPACE"," ",329],"=",["T_WHITESPACE"," ",329],["T_VARIABLE","$this",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","_makeBoundarySelect",329],"(",["T_WHITESPACE","\n                                ",329],["T_VARIABLE","$dtFrom",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","format",330],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d'",330],")",",",["T_WHITESPACE","\n                                ",330],["T_VARIABLE","$dtTo",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","format",331],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d'",331],")",["T_WHITESPACE","\n                            ",331],")",";",["T_WHITESPACE","\n\n                            ",332],["T_COMMENT","\/\/ first day of the next month\n",334],["T_WHITESPACE","                            ",335],["T_VARIABLE","$this",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","_from",335],["T_WHITESPACE"," ",335],"=",["T_WHITESPACE"," ",335],["T_CLONE","clone",335],["T_WHITESPACE"," ",335],["T_VARIABLE","$periodFrom",335],";",["T_WHITESPACE","\n                            ",335],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","_from",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","modify",336],"(",["T_CONSTANT_ENCAPSED_STRING","'+1 month'",336],")",";",["T_WHITESPACE","\n                            ",336],["T_VARIABLE","$this",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","_from",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","setDate",337],"(",["T_VARIABLE","$this",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","_from",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","format",337],"(",["T_CONSTANT_ENCAPSED_STRING","'Y'",337],")",",",["T_WHITESPACE"," ",337],["T_VARIABLE","$this",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","_from",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","format",337],"(",["T_CONSTANT_ENCAPSED_STRING","'m'",337],")",",",["T_WHITESPACE"," ",337],["T_LNUMBER","1",337],")",";",["T_WHITESPACE","\n                            ",337],["T_VARIABLE","$this",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","_from",338],["T_WHITESPACE"," ",338],"=",["T_WHITESPACE"," ",338],["T_VARIABLE","$this",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","_from",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","format",338],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d'",338],")",";",["T_WHITESPACE","\n                        ",338],"}",["T_WHITESPACE","\n                    ",339],"}",["T_WHITESPACE","\n                ",340],"}",["T_WHITESPACE","\n\n                ",341],["T_IF","if",343],["T_WHITESPACE"," ",343],"(",["T_VARIABLE","$periodTo",343],")",["T_WHITESPACE"," ",343],"{",["T_WHITESPACE","\n                    ",343],["T_COMMENT","\/\/ not the last day of the month\n",344],["T_WHITESPACE","                    ",345],["T_IF","if",345],["T_WHITESPACE"," ",345],"(",["T_VARIABLE","$periodTo",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","format",345],"(",["T_CONSTANT_ENCAPSED_STRING","'d'",345],")",["T_WHITESPACE"," ",345],["T_IS_NOT_EQUAL","!=",345],["T_WHITESPACE"," ",345],["T_VARIABLE","$periodTo",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","format",345],"(",["T_CONSTANT_ENCAPSED_STRING","'t'",345],")",")",["T_WHITESPACE"," ",345],"{",["T_WHITESPACE","\n                        ",345],["T_VARIABLE","$dtFrom",346],["T_WHITESPACE"," ",346],"=",["T_WHITESPACE"," ",346],["T_CLONE","clone",346],["T_WHITESPACE"," ",346],["T_VARIABLE","$periodTo",346],";",["T_WHITESPACE","\n                        ",346],["T_VARIABLE","$dtFrom",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","setDate",347],"(",["T_VARIABLE","$dtFrom",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","format",347],"(",["T_CONSTANT_ENCAPSED_STRING","'Y'",347],")",",",["T_WHITESPACE"," ",347],["T_VARIABLE","$dtFrom",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","format",347],"(",["T_CONSTANT_ENCAPSED_STRING","'m'",347],")",",",["T_WHITESPACE"," ",347],["T_LNUMBER","1",347],")",";",["T_WHITESPACE","\n                        ",347],["T_COMMENT","\/\/ first day of the month\n",348],["T_WHITESPACE","                        ",349],["T_VARIABLE","$dtTo",349],["T_WHITESPACE"," ",349],"=",["T_WHITESPACE"," ",349],["T_CLONE","clone",349],["T_WHITESPACE"," ",349],["T_VARIABLE","$periodTo",349],";",["T_WHITESPACE","\n                        ",349],["T_IF","if",350],["T_WHITESPACE"," ",350],"(","!",["T_VARIABLE","$periodFrom",350],["T_WHITESPACE"," ",350],["T_BOOLEAN_OR","||",350],["T_WHITESPACE"," ",350],["T_VARIABLE","$dtFrom",350],["T_WHITESPACE"," ",350],">",["T_WHITESPACE"," ",350],["T_VARIABLE","$periodFrom",350],")",["T_WHITESPACE"," ",350],"{",["T_WHITESPACE","\n                            ",350],["T_VARIABLE","$selectUnions",351],"[","]",["T_WHITESPACE"," ",351],"=",["T_WHITESPACE"," ",351],["T_VARIABLE","$this",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","_makeBoundarySelect",351],"(",["T_WHITESPACE","\n                                ",351],["T_VARIABLE","$dtFrom",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","format",352],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d'",352],")",",",["T_WHITESPACE","\n                                ",352],["T_VARIABLE","$dtTo",353],["T_OBJECT_OPERATOR","->",353],["T_STRING","format",353],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d'",353],")",["T_WHITESPACE","\n                            ",353],")",";",["T_WHITESPACE","\n\n                            ",354],["T_COMMENT","\/\/ last day of the previous month\n",356],["T_WHITESPACE","                            ",357],["T_VARIABLE","$this",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","_to",357],["T_WHITESPACE"," ",357],"=",["T_WHITESPACE"," ",357],["T_CLONE","clone",357],["T_WHITESPACE"," ",357],["T_VARIABLE","$periodTo",357],";",["T_WHITESPACE","\n                            ",357],["T_VARIABLE","$this",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","_to",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","setDate",358],"(",["T_VARIABLE","$this",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","_to",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","format",358],"(",["T_CONSTANT_ENCAPSED_STRING","'Y'",358],")",",",["T_WHITESPACE"," ",358],["T_VARIABLE","$this",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","_to",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","format",358],"(",["T_CONSTANT_ENCAPSED_STRING","'m'",358],")",",",["T_WHITESPACE"," ",358],["T_LNUMBER","1",358],")",";",["T_WHITESPACE","\n                            ",358],["T_VARIABLE","$this",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","_to",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","modify",359],"(",["T_CONSTANT_ENCAPSED_STRING","'-1 day'",359],")",";",["T_WHITESPACE","\n                            ",359],["T_VARIABLE","$this",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","_to",360],["T_WHITESPACE"," ",360],"=",["T_WHITESPACE"," ",360],["T_VARIABLE","$this",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","_to",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","format",360],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d'",360],")",";",["T_WHITESPACE","\n                        ",360],"}",["T_WHITESPACE","\n                    ",361],"}",["T_WHITESPACE","\n                ",362],"}",["T_WHITESPACE","\n\n                ",363],["T_IF","if",365],["T_WHITESPACE"," ",365],"(",["T_VARIABLE","$periodFrom",365],["T_WHITESPACE"," ",365],["T_BOOLEAN_AND","&&",365],["T_WHITESPACE"," ",365],["T_VARIABLE","$periodTo",365],")",["T_WHITESPACE"," ",365],"{",["T_WHITESPACE","\n                    ",365],["T_COMMENT","\/\/ the same month\n",366],["T_WHITESPACE","                    ",367],["T_IF","if",367],["T_WHITESPACE"," ",367],"(",["T_VARIABLE","$periodTo",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","format",367],"(",["T_CONSTANT_ENCAPSED_STRING","'Y'",367],")",["T_WHITESPACE"," ",367],["T_IS_EQUAL","==",367],["T_WHITESPACE"," ",367],["T_VARIABLE","$periodFrom",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","format",367],"(",["T_CONSTANT_ENCAPSED_STRING","'Y'",367],")",["T_WHITESPACE"," ",367],["T_BOOLEAN_AND","&&",367],["T_WHITESPACE","\n                        ",367],["T_VARIABLE","$periodTo",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","format",368],"(",["T_CONSTANT_ENCAPSED_STRING","'m'",368],")",["T_WHITESPACE"," ",368],["T_IS_EQUAL","==",368],["T_WHITESPACE"," ",368],["T_VARIABLE","$periodFrom",368],["T_OBJECT_OPERATOR","->",368],["T_STRING","format",368],"(",["T_CONSTANT_ENCAPSED_STRING","'m'",368],")",["T_WHITESPACE","\n                    ",368],")",["T_WHITESPACE"," ",369],"{",["T_WHITESPACE","\n                        ",369],["T_VARIABLE","$dtFrom",370],["T_WHITESPACE"," ",370],"=",["T_WHITESPACE"," ",370],["T_CLONE","clone",370],["T_WHITESPACE"," ",370],["T_VARIABLE","$periodFrom",370],";",["T_WHITESPACE","\n                        ",370],["T_VARIABLE","$dtTo",371],["T_WHITESPACE"," ",371],"=",["T_WHITESPACE"," ",371],["T_CLONE","clone",371],["T_WHITESPACE"," ",371],["T_VARIABLE","$periodTo",371],";",["T_WHITESPACE","\n                        ",371],["T_VARIABLE","$selectUnions",372],"[","]",["T_WHITESPACE"," ",372],"=",["T_WHITESPACE"," ",372],["T_VARIABLE","$this",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","_makeBoundarySelect",372],"(",["T_WHITESPACE","\n                            ",372],["T_VARIABLE","$dtFrom",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","format",373],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d'",373],")",",",["T_WHITESPACE","\n                            ",373],["T_VARIABLE","$dtTo",374],["T_OBJECT_OPERATOR","->",374],["T_STRING","format",374],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d'",374],")",["T_WHITESPACE","\n                        ",374],")",";",["T_WHITESPACE","\n\n                        ",375],["T_VARIABLE","$this",377],["T_OBJECT_OPERATOR","->",377],["T_STRING","getSelect",377],"(",")",["T_OBJECT_OPERATOR","->",377],["T_STRING","where",377],"(",["T_CONSTANT_ENCAPSED_STRING","'1<>1'",377],")",";",["T_WHITESPACE","\n                    ",377],"}",["T_WHITESPACE","\n                ",378],"}",["T_WHITESPACE","\n            ",379],"}",["T_WHITESPACE","\n\n            ",380],["T_VARIABLE","$this",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","_applyDateRangeFilter",382],"(",")",";",["T_WHITESPACE","\n\n            ",382],["T_COMMENT","\/\/ add unions to select\n",384],["T_WHITESPACE","            ",385],["T_IF","if",385],["T_WHITESPACE"," ",385],"(",["T_VARIABLE","$selectUnions",385],")",["T_WHITESPACE"," ",385],"{",["T_WHITESPACE","\n                ",385],["T_VARIABLE","$unionParts",386],["T_WHITESPACE"," ",386],"=",["T_WHITESPACE"," ",386],"[","]",";",["T_WHITESPACE","\n                ",386],["T_VARIABLE","$cloneSelect",387],["T_WHITESPACE"," ",387],"=",["T_WHITESPACE"," ",387],["T_CLONE","clone",387],["T_WHITESPACE"," ",387],["T_VARIABLE","$this",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","getSelect",387],"(",")",";",["T_WHITESPACE","\n                ",387],["T_VARIABLE","$unionParts",388],"[","]",["T_WHITESPACE"," ",388],"=",["T_WHITESPACE"," ",388],["T_CONSTANT_ENCAPSED_STRING","'('",388],["T_WHITESPACE"," ",388],".",["T_WHITESPACE"," ",388],["T_VARIABLE","$cloneSelect",388],["T_WHITESPACE"," ",388],".",["T_WHITESPACE"," ",388],["T_CONSTANT_ENCAPSED_STRING","')'",388],";",["T_WHITESPACE","\n                ",388],["T_FOREACH","foreach",389],["T_WHITESPACE"," ",389],"(",["T_VARIABLE","$selectUnions",389],["T_WHITESPACE"," ",389],["T_AS","as",389],["T_WHITESPACE"," ",389],["T_VARIABLE","$union",389],")",["T_WHITESPACE"," ",389],"{",["T_WHITESPACE","\n                    ",389],["T_VARIABLE","$unionParts",390],"[","]",["T_WHITESPACE"," ",390],"=",["T_WHITESPACE"," ",390],["T_CONSTANT_ENCAPSED_STRING","'('",390],["T_WHITESPACE"," ",390],".",["T_WHITESPACE"," ",390],["T_VARIABLE","$union",390],["T_WHITESPACE"," ",390],".",["T_WHITESPACE"," ",390],["T_CONSTANT_ENCAPSED_STRING","')'",390],";",["T_WHITESPACE","\n                ",390],"}",["T_WHITESPACE","\n                ",391],["T_VARIABLE","$this",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","getSelect",392],"(",")",["T_OBJECT_OPERATOR","->",392],["T_STRING","reset",392],"(",")",["T_OBJECT_OPERATOR","->",392],["T_STRING","union",392],"(",["T_VARIABLE","$unionParts",392],",",["T_WHITESPACE"," ",392],["T_NS_SEPARATOR","\\",392],["T_STRING","Magento",392],["T_NS_SEPARATOR","\\",392],["T_STRING","Framework",392],["T_NS_SEPARATOR","\\",392],["T_STRING","DB",392],["T_NS_SEPARATOR","\\",392],["T_STRING","Select",392],["T_DOUBLE_COLON","::",392],["T_STRING","SQL_UNION_ALL",392],")",";",["T_WHITESPACE","\n            ",392],"}",["T_WHITESPACE","\n\n            ",393],["T_IF","if",395],["T_WHITESPACE"," ",395],"(",["T_VARIABLE","$this",395],["T_OBJECT_OPERATOR","->",395],["T_STRING","isTotals",395],"(",")",")",["T_WHITESPACE"," ",395],"{",["T_WHITESPACE","\n                ",395],["T_COMMENT","\/\/ calculate total\n",396],["T_WHITESPACE","                ",397],["T_VARIABLE","$cloneSelect",397],["T_WHITESPACE"," ",397],"=",["T_WHITESPACE"," ",397],["T_CLONE","clone",397],["T_WHITESPACE"," ",397],["T_VARIABLE","$this",397],["T_OBJECT_OPERATOR","->",397],["T_STRING","getSelect",397],"(",")",";",["T_WHITESPACE","\n                ",397],["T_VARIABLE","$this",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","getSelect",398],"(",")",["T_OBJECT_OPERATOR","->",398],["T_STRING","reset",398],"(",")",["T_OBJECT_OPERATOR","->",398],["T_STRING","from",398],"(",["T_VARIABLE","$cloneSelect",398],",",["T_WHITESPACE"," ",398],["T_VARIABLE","$this",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","getAggregatedColumns",398],"(",")",")",";",["T_WHITESPACE","\n            ",398],"}",["T_WHITESPACE"," ",399],["T_ELSE","else",399],["T_WHITESPACE"," ",399],"{",["T_WHITESPACE","\n                ",399],["T_COMMENT","\/\/ add sorting\n",400],["T_WHITESPACE","                ",401],["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","getSelect",401],"(",")",["T_OBJECT_OPERATOR","->",401],["T_STRING","order",401],"(","[",["T_CONSTANT_ENCAPSED_STRING","'period ASC'",401],",",["T_WHITESPACE"," ",401],["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","getOrderedField",401],"(",")",["T_WHITESPACE"," ",401],".",["T_WHITESPACE"," ",401],["T_CONSTANT_ENCAPSED_STRING","' DESC'",401],"]",")",";",["T_WHITESPACE","\n            ",401],"}",["T_WHITESPACE","\n        ",402],"}",["T_WHITESPACE","\n\n        ",403],["T_RETURN","return",405],["T_WHITESPACE"," ",405],["T_VARIABLE","$this",405],";",["T_WHITESPACE","\n    ",405],"}",["T_WHITESPACE","\n",406],"}",["T_WHITESPACE","\n",407]]