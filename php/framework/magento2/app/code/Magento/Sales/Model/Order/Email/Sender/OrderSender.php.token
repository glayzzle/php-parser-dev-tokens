[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Sales",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Order",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Email",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Sender",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Payment",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Helper",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Data",8],["T_WHITESPACE"," ",8],["T_AS","as",8],["T_WHITESPACE"," ",8],["T_STRING","PaymentHelper",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Sales",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Model",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Order",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Sales",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Model",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Order",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Email",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Container",10],["T_NS_SEPARATOR","\\",10],["T_STRING","OrderIdentity",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Sales",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Model",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Order",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Email",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Container",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Template",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Sales",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Model",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Order",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Email",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Sender",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Sales",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Model",13],["T_NS_SEPARATOR","\\",13],["T_STRING","ResourceModel",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Order",13],["T_WHITESPACE"," ",13],["T_AS","as",13],["T_WHITESPACE"," ",13],["T_STRING","OrderResource",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Sales",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Model",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Order",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Address",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Renderer",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Magento",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Framework",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Event",15],["T_NS_SEPARATOR","\\",15],["T_STRING","ManagerInterface",15],";",["T_WHITESPACE","\n\n",15],["T_DOC_COMMENT","\/**\n * Class OrderSender\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",17],["T_WHITESPACE","\n",20],["T_CLASS","class",21],["T_WHITESPACE"," ",21],["T_STRING","OrderSender",21],["T_WHITESPACE"," ",21],["T_EXTENDS","extends",21],["T_WHITESPACE"," ",21],["T_STRING","Sender",21],["T_WHITESPACE","\n",21],"{",["T_WHITESPACE","\n    ",22],["T_DOC_COMMENT","\/**\n     * @var PaymentHelper\n     *\/",23],["T_WHITESPACE","\n    ",25],["T_PROTECTED","protected",26],["T_WHITESPACE"," ",26],["T_VARIABLE","$paymentHelper",26],";",["T_WHITESPACE","\n\n    ",26],["T_DOC_COMMENT","\/**\n     * @var OrderResource\n     *\/",28],["T_WHITESPACE","\n    ",30],["T_PROTECTED","protected",31],["T_WHITESPACE"," ",31],["T_VARIABLE","$orderResource",31],";",["T_WHITESPACE","\n\n    ",31],["T_DOC_COMMENT","\/**\n     * Global configuration storage.\n     *\n     * @var \\Magento\\Framework\\App\\Config\\ScopeConfigInterface\n     *\/",33],["T_WHITESPACE","\n    ",37],["T_PROTECTED","protected",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$globalConfig",38],";",["T_WHITESPACE","\n\n    ",38],["T_DOC_COMMENT","\/**\n     * @var Renderer\n     *\/",40],["T_WHITESPACE","\n    ",42],["T_PROTECTED","protected",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$addressRenderer",43],";",["T_WHITESPACE","\n\n    ",43],["T_DOC_COMMENT","\/**\n     * Application Event Dispatcher\n     *\n     * @var ManagerInterface\n     *\/",45],["T_WHITESPACE","\n    ",49],["T_PROTECTED","protected",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$eventManager",50],";",["T_WHITESPACE","\n\n    ",50],["T_DOC_COMMENT","\/**\n     * @param Template $templateContainer\n     * @param OrderIdentity $identityContainer\n     * @param Order\\Email\\SenderBuilderFactory $senderBuilderFactory\n     * @param \\Psr\\Log\\LoggerInterface $logger\n     * @param PaymentHelper $paymentHelper\n     * @param OrderResource $orderResource\n     * @param \\Magento\\Framework\\App\\Config\\ScopeConfigInterface $globalConfig\n     * @param Renderer $addressRenderer\n     * @param ManagerInterface $eventManager\n     *\/",52],["T_WHITESPACE","\n    ",62],["T_PUBLIC","public",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","__construct",63],"(",["T_WHITESPACE","\n        ",63],["T_STRING","Template",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$templateContainer",64],",",["T_WHITESPACE","\n        ",64],["T_STRING","OrderIdentity",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$identityContainer",65],",",["T_WHITESPACE","\n        ",65],["T_NS_SEPARATOR","\\",66],["T_STRING","Magento",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Sales",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Model",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Order",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Email",66],["T_NS_SEPARATOR","\\",66],["T_STRING","SenderBuilderFactory",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$senderBuilderFactory",66],",",["T_WHITESPACE","\n        ",66],["T_NS_SEPARATOR","\\",67],["T_STRING","Psr",67],["T_NS_SEPARATOR","\\",67],["T_STRING","Log",67],["T_NS_SEPARATOR","\\",67],["T_STRING","LoggerInterface",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$logger",67],",",["T_WHITESPACE","\n        ",67],["T_STRING","Renderer",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$addressRenderer",68],",",["T_WHITESPACE","\n        ",68],["T_STRING","PaymentHelper",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$paymentHelper",69],",",["T_WHITESPACE","\n        ",69],["T_STRING","OrderResource",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$orderResource",70],",",["T_WHITESPACE","\n        ",70],["T_NS_SEPARATOR","\\",71],["T_STRING","Magento",71],["T_NS_SEPARATOR","\\",71],["T_STRING","Framework",71],["T_NS_SEPARATOR","\\",71],["T_STRING","App",71],["T_NS_SEPARATOR","\\",71],["T_STRING","Config",71],["T_NS_SEPARATOR","\\",71],["T_STRING","ScopeConfigInterface",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$globalConfig",71],",",["T_WHITESPACE","\n        ",71],["T_STRING","ManagerInterface",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$eventManager",72],["T_WHITESPACE","\n    ",72],")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n        ",73],["T_STRING","parent",74],["T_DOUBLE_COLON","::",74],["T_STRING","__construct",74],"(",["T_VARIABLE","$templateContainer",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$identityContainer",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$senderBuilderFactory",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$logger",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$addressRenderer",74],")",";",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","paymentHelper",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$paymentHelper",75],";",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","orderResource",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$orderResource",76],";",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","globalConfig",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$globalConfig",77],";",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","addressRenderer",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$addressRenderer",78],";",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","eventManager",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$eventManager",79],";",["T_WHITESPACE","\n    ",79],"}",["T_WHITESPACE","\n\n    ",80],["T_DOC_COMMENT","\/**\n     * Sends order email to the customer.\n     *\n     * Email will be sent immediately in two cases:\n     *\n     * - if asynchronous email sending is disabled in global settings\n     * - if $forceSyncMode parameter is set to TRUE\n     *\n     * Otherwise, email will be sent later during running of\n     * corresponding cron job.\n     *\n     * @param Order $order\n     * @param bool $forceSyncMode\n     * @return bool\n     *\/",82],["T_WHITESPACE","\n    ",96],["T_PUBLIC","public",97],["T_WHITESPACE"," ",97],["T_FUNCTION","function",97],["T_WHITESPACE"," ",97],["T_STRING","send",97],"(",["T_STRING","Order",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$order",97],",",["T_WHITESPACE"," ",97],["T_VARIABLE","$forceSyncMode",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_STRING","false",97],")",["T_WHITESPACE","\n    ",97],"{",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$order",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","setSendEmail",99],"(",["T_STRING","true",99],")",";",["T_WHITESPACE","\n\n        ",99],["T_IF","if",101],["T_WHITESPACE"," ",101],"(","!",["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","globalConfig",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getValue",101],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_email\/general\/async_sending'",101],")",["T_WHITESPACE"," ",101],["T_BOOLEAN_OR","||",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$forceSyncMode",101],")",["T_WHITESPACE"," ",101],"{",["T_WHITESPACE","\n            ",101],["T_IF","if",102],["T_WHITESPACE"," ",102],"(",["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","checkAndSend",102],"(",["T_VARIABLE","$order",102],")",")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n                ",102],["T_VARIABLE","$order",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","setEmailSent",103],"(",["T_STRING","true",103],")",";",["T_WHITESPACE","\n                ",103],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","orderResource",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","saveAttribute",104],"(",["T_VARIABLE","$order",104],",",["T_WHITESPACE"," ",104],"[",["T_CONSTANT_ENCAPSED_STRING","'send_email'",104],",",["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'email_sent'",104],"]",")",";",["T_WHITESPACE","\n                ",104],["T_RETURN","return",105],["T_WHITESPACE"," ",105],["T_STRING","true",105],";",["T_WHITESPACE","\n            ",105],"}",["T_WHITESPACE","\n        ",106],"}",["T_WHITESPACE"," ",107],["T_ELSE","else",107],["T_WHITESPACE"," ",107],"{",["T_WHITESPACE","\n            ",107],["T_VARIABLE","$order",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","setEmailSent",108],"(",["T_STRING","null",108],")",";",["T_WHITESPACE","\n            ",108],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","orderResource",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","saveAttribute",109],"(",["T_VARIABLE","$order",109],",",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'email_sent'",109],")",";",["T_WHITESPACE","\n        ",109],"}",["T_WHITESPACE","\n\n        ",110],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","orderResource",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","saveAttribute",112],"(",["T_VARIABLE","$order",112],",",["T_WHITESPACE"," ",112],["T_CONSTANT_ENCAPSED_STRING","'send_email'",112],")",";",["T_WHITESPACE","\n\n        ",112],["T_RETURN","return",114],["T_WHITESPACE"," ",114],["T_STRING","false",114],";",["T_WHITESPACE","\n    ",114],"}",["T_WHITESPACE","\n\n    ",115],["T_DOC_COMMENT","\/**\n     * Prepare email template with variables\n     *\n     * @param Order $order\n     * @return void\n     *\/",117],["T_WHITESPACE","\n    ",122],["T_PROTECTED","protected",123],["T_WHITESPACE"," ",123],["T_FUNCTION","function",123],["T_WHITESPACE"," ",123],["T_STRING","prepareTemplate",123],"(",["T_STRING","Order",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$order",123],")",["T_WHITESPACE","\n    ",123],"{",["T_WHITESPACE","\n        ",124],["T_VARIABLE","$transport",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],"[",["T_WHITESPACE","\n            ",125],["T_CONSTANT_ENCAPSED_STRING","'order'",126],["T_WHITESPACE"," ",126],["T_DOUBLE_ARROW","=>",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$order",126],",",["T_WHITESPACE","\n            ",126],["T_CONSTANT_ENCAPSED_STRING","'billing'",127],["T_WHITESPACE"," ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$order",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","getBillingAddress",127],"(",")",",",["T_WHITESPACE","\n            ",127],["T_CONSTANT_ENCAPSED_STRING","'payment_html'",128],["T_WHITESPACE"," ",128],["T_DOUBLE_ARROW","=>",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","getPaymentHtml",128],"(",["T_VARIABLE","$order",128],")",",",["T_WHITESPACE","\n            ",128],["T_CONSTANT_ENCAPSED_STRING","'store'",129],["T_WHITESPACE"," ",129],["T_DOUBLE_ARROW","=>",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$order",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getStore",129],"(",")",",",["T_WHITESPACE","\n            ",129],["T_CONSTANT_ENCAPSED_STRING","'formattedShippingAddress'",130],["T_WHITESPACE"," ",130],["T_DOUBLE_ARROW","=>",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getFormattedShippingAddress",130],"(",["T_VARIABLE","$order",130],")",",",["T_WHITESPACE","\n            ",130],["T_CONSTANT_ENCAPSED_STRING","'formattedBillingAddress'",131],["T_WHITESPACE"," ",131],["T_DOUBLE_ARROW","=>",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","getFormattedBillingAddress",131],"(",["T_VARIABLE","$order",131],")",",",["T_WHITESPACE","\n        ",131],"]",";",["T_WHITESPACE","\n        ",132],["T_VARIABLE","$transport",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_NEW","new",133],["T_WHITESPACE"," ",133],["T_NS_SEPARATOR","\\",133],["T_STRING","Magento",133],["T_NS_SEPARATOR","\\",133],["T_STRING","Framework",133],["T_NS_SEPARATOR","\\",133],["T_STRING","DataObject",133],"(",["T_VARIABLE","$transport",133],")",";",["T_WHITESPACE","\n\n        ",133],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","eventManager",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","dispatch",135],"(",["T_WHITESPACE","\n            ",135],["T_CONSTANT_ENCAPSED_STRING","'email_order_set_template_vars_before'",136],",",["T_WHITESPACE","\n            ",136],"[",["T_CONSTANT_ENCAPSED_STRING","'sender'",137],["T_WHITESPACE"," ",137],["T_DOUBLE_ARROW","=>",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$this",137],",",["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'transport'",137],["T_WHITESPACE"," ",137],["T_DOUBLE_ARROW","=>",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$transport",137],"]",["T_WHITESPACE","\n        ",137],")",";",["T_WHITESPACE","\n\n        ",138],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","templateContainer",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","setTemplateVars",140],"(",["T_VARIABLE","$transport",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","getData",140],"(",")",")",";",["T_WHITESPACE","\n\n        ",140],["T_STRING","parent",142],["T_DOUBLE_COLON","::",142],["T_STRING","prepareTemplate",142],"(",["T_VARIABLE","$order",142],")",";",["T_WHITESPACE","\n    ",142],"}",["T_WHITESPACE","\n\n    ",143],["T_DOC_COMMENT","\/**\n     * Get payment info block as html\n     *\n     * @param Order $order\n     * @return string\n     *\/",145],["T_WHITESPACE","\n    ",150],["T_PROTECTED","protected",151],["T_WHITESPACE"," ",151],["T_FUNCTION","function",151],["T_WHITESPACE"," ",151],["T_STRING","getPaymentHtml",151],"(",["T_STRING","Order",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$order",151],")",["T_WHITESPACE","\n    ",151],"{",["T_WHITESPACE","\n        ",152],["T_RETURN","return",153],["T_WHITESPACE"," ",153],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","paymentHelper",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","getInfoBlockHtml",153],"(",["T_WHITESPACE","\n            ",153],["T_VARIABLE","$order",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","getPayment",154],"(",")",",",["T_WHITESPACE","\n            ",154],["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","identityContainer",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","getStore",155],"(",")",["T_OBJECT_OPERATOR","->",155],["T_STRING","getStoreId",155],"(",")",["T_WHITESPACE","\n        ",155],")",";",["T_WHITESPACE","\n    ",156],"}",["T_WHITESPACE","\n",157],"}",["T_WHITESPACE","\n",158]]