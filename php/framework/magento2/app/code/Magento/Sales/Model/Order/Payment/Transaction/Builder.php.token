[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Sales",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Model",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Order",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Payment",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Transaction",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Sales",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Api",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Data",9],["T_NS_SEPARATOR","\\",9],["T_STRING","OrderInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Sales",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Api",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Data",10],["T_NS_SEPARATOR","\\",10],["T_STRING","OrderPaymentInterface",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Sales",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Api",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Data",11],["T_NS_SEPARATOR","\\",11],["T_STRING","TransactionInterface",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Sales",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Api",12],["T_NS_SEPARATOR","\\",12],["T_STRING","TransactionRepositoryInterface",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Sales",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Model",13],["T_NS_SEPARATOR","\\",13],["T_STRING","AbstractModel",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Sales",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Model",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Order",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Payment",14],";",["T_WHITESPACE","\n\n",14],["T_DOC_COMMENT","\/**\n * Class Builder build transaction\n *\/",16],["T_WHITESPACE","\n",18],["T_CLASS","class",19],["T_WHITESPACE"," ",19],["T_STRING","Builder",19],["T_WHITESPACE"," ",19],["T_IMPLEMENTS","implements",19],["T_WHITESPACE"," ",19],["T_STRING","BuilderInterface",19],["T_WHITESPACE","\n",19],"{",["T_WHITESPACE","\n    ",20],["T_DOC_COMMENT","\/**\n     * @var OrderPaymentInterface\n     *\/",21],["T_WHITESPACE","\n    ",23],["T_PROTECTED","protected",24],["T_WHITESPACE"," ",24],["T_VARIABLE","$payment",24],";",["T_WHITESPACE","\n\n    ",24],["T_DOC_COMMENT","\/**\n     * @var OrderInterface\n     *\/",26],["T_WHITESPACE","\n    ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$order",29],";",["T_WHITESPACE","\n\n    ",29],["T_DOC_COMMENT","\/**\n     * @var AbstractModel\n     *\/",31],["T_WHITESPACE","\n    ",33],["T_PROTECTED","protected",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$document",34],";",["T_WHITESPACE","\n\n    ",34],["T_DOC_COMMENT","\/**\n     * @var bool\n     *\/",36],["T_WHITESPACE","\n    ",38],["T_PROTECTED","protected",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$failSafe",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_STRING","false",39],";",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * @var string\n     *\/",41],["T_WHITESPACE","\n    ",43],["T_PROTECTED","protected",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$message",44],";",["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * @var string\n     *\/",46],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$transactionId",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * @var array\n     *\/",51],["T_WHITESPACE","\n    ",53],["T_PROTECTED","protected",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$transactionAdditionalInfo",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],"[","]",";",["T_WHITESPACE","\n\n    ",54],["T_DOC_COMMENT","\/**\n     * @var TransactionRepositoryInterface\n     *\/",56],["T_WHITESPACE","\n    ",58],["T_PROTECTED","protected",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$transactionRepository",59],";",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * @param TransactionRepositoryInterface $transactionRepository\n     *\/",61],["T_WHITESPACE","\n    ",63],["T_PUBLIC","public",64],["T_WHITESPACE"," ",64],["T_FUNCTION","function",64],["T_WHITESPACE"," ",64],["T_STRING","__construct",64],"(",["T_STRING","TransactionRepositoryInterface",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$transactionRepository",64],")",["T_WHITESPACE","\n    ",64],"{",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","transactionRepository",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$transactionRepository",66],";",["T_WHITESPACE","\n    ",66],"}",["T_WHITESPACE","\n\n    ",67],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",69],["T_WHITESPACE","\n    ",71],["T_PUBLIC","public",72],["T_WHITESPACE"," ",72],["T_FUNCTION","function",72],["T_WHITESPACE"," ",72],["T_STRING","setPayment",72],"(",["T_STRING","OrderPaymentInterface",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$payment",72],")",["T_WHITESPACE","\n    ",72],"{",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","payment",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$payment",74],";",["T_WHITESPACE","\n        ",74],["T_RETURN","return",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],";",["T_WHITESPACE","\n    ",75],"}",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",78],["T_WHITESPACE","\n    ",80],["T_PUBLIC","public",81],["T_WHITESPACE"," ",81],["T_FUNCTION","function",81],["T_WHITESPACE"," ",81],["T_STRING","setOrder",81],"(",["T_STRING","OrderInterface",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$order",81],")",["T_WHITESPACE","\n    ",81],"{",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","order",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$order",83],";",["T_WHITESPACE","\n        ",83],["T_RETURN","return",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],";",["T_WHITESPACE","\n    ",84],"}",["T_WHITESPACE","\n\n    ",85],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",87],["T_WHITESPACE","\n    ",89],["T_PUBLIC","public",90],["T_WHITESPACE"," ",90],["T_FUNCTION","function",90],["T_WHITESPACE"," ",90],["T_STRING","setSalesDocument",90],"(",["T_NS_SEPARATOR","\\",90],["T_STRING","Magento",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Sales",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Model",90],["T_NS_SEPARATOR","\\",90],["T_STRING","AbstractModel",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$document",90],")",["T_WHITESPACE","\n    ",90],"{",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","document",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$document",92],";",["T_WHITESPACE","\n        ",92],["T_RETURN","return",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],";",["T_WHITESPACE","\n    ",93],"}",["T_WHITESPACE","\n\n    ",94],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",96],["T_WHITESPACE","\n    ",98],["T_PUBLIC","public",99],["T_WHITESPACE"," ",99],["T_FUNCTION","function",99],["T_WHITESPACE"," ",99],["T_STRING","setFailSafe",99],"(",["T_VARIABLE","$failSafe",99],")",["T_WHITESPACE","\n    ",99],"{",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","failSafe",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$failSafe",101],";",["T_WHITESPACE","\n        ",101],["T_RETURN","return",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],";",["T_WHITESPACE","\n    ",102],"}",["T_WHITESPACE","\n\n    ",103],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",105],["T_WHITESPACE","\n    ",107],["T_PUBLIC","public",108],["T_WHITESPACE"," ",108],["T_FUNCTION","function",108],["T_WHITESPACE"," ",108],["T_STRING","setMessage",108],"(",["T_VARIABLE","$message",108],")",["T_WHITESPACE","\n    ",108],"{",["T_WHITESPACE","\n        ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","message",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$message",110],";",["T_WHITESPACE","\n        ",110],["T_RETURN","return",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],";",["T_WHITESPACE","\n    ",111],"}",["T_WHITESPACE","\n\n    ",112],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",114],["T_WHITESPACE","\n    ",116],["T_PUBLIC","public",117],["T_WHITESPACE"," ",117],["T_FUNCTION","function",117],["T_WHITESPACE"," ",117],["T_STRING","setTransactionId",117],"(",["T_VARIABLE","$transactionId",117],")",["T_WHITESPACE","\n    ",117],"{",["T_WHITESPACE","\n        ",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","transactionId",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$transactionId",119],";",["T_WHITESPACE","\n        ",119],["T_RETURN","return",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],";",["T_WHITESPACE","\n    ",120],"}",["T_WHITESPACE","\n\n\n    ",121],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",124],["T_WHITESPACE","\n    ",126],["T_PUBLIC","public",127],["T_WHITESPACE"," ",127],["T_FUNCTION","function",127],["T_WHITESPACE"," ",127],["T_STRING","setAdditionalInformation",127],"(",["T_ARRAY","array",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$value",127],")",["T_WHITESPACE","\n    ",127],"{",["T_WHITESPACE","\n        ",128],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","transactionAdditionalInfo",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_VARIABLE","$value",129],";",["T_WHITESPACE","\n        ",129],["T_RETURN","return",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],";",["T_WHITESPACE","\n    ",130],"}",["T_WHITESPACE","\n\n    ",131],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",133],["T_WHITESPACE","\n    ",135],["T_PUBLIC","public",136],["T_WHITESPACE"," ",136],["T_FUNCTION","function",136],["T_WHITESPACE"," ",136],["T_STRING","addAdditionalInformation",136],"(",["T_VARIABLE","$key",136],",",["T_WHITESPACE"," ",136],["T_VARIABLE","$value",136],")",["T_WHITESPACE","\n    ",136],"{",["T_WHITESPACE","\n        ",137],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","transactionAdditionalInfo",138],"[",["T_VARIABLE","$key",138],"]",["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_VARIABLE","$value",138],";",["T_WHITESPACE","\n        ",138],["T_RETURN","return",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],";",["T_WHITESPACE","\n    ",139],"}",["T_WHITESPACE","\n\n    ",140],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",142],["T_WHITESPACE","\n    ",144],["T_PUBLIC","public",145],["T_WHITESPACE"," ",145],["T_FUNCTION","function",145],["T_WHITESPACE"," ",145],["T_STRING","reset",145],"(",")",["T_WHITESPACE","\n    ",145],"{",["T_WHITESPACE","\n        ",146],["T_UNSET","unset",147],"(",["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","payment",147],")",";",["T_WHITESPACE","\n        ",147],["T_UNSET","unset",148],"(",["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","document",148],")",";",["T_WHITESPACE","\n        ",148],["T_UNSET","unset",149],"(",["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","order",149],")",";",["T_WHITESPACE","\n        ",149],["T_UNSET","unset",150],"(",["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","message",150],")",";",["T_WHITESPACE","\n        ",150],["T_UNSET","unset",151],"(",["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","transactionId",151],")",";",["T_WHITESPACE","\n        ",151],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","failSafe",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_STRING","false",152],";",["T_WHITESPACE","\n        ",152],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","transactionAdditionalInfo",153],["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],"[","]",";",["T_WHITESPACE","\n        ",153],["T_RETURN","return",154],["T_WHITESPACE"," ",154],["T_VARIABLE","$this",154],";",["T_WHITESPACE","\n    ",154],"}",["T_WHITESPACE","\n\n    ",155],["T_DOC_COMMENT","\/**\n     * Checks if payment was set\n     *\n     * @return bool\n     *\/",157],["T_WHITESPACE","\n    ",161],["T_PROTECTED","protected",162],["T_WHITESPACE"," ",162],["T_FUNCTION","function",162],["T_WHITESPACE"," ",162],["T_STRING","isPaymentExists",162],"(",")",["T_WHITESPACE","\n    ",162],"{",["T_WHITESPACE","\n        ",163],["T_IF","if",164],["T_WHITESPACE"," ",164],"(",["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","payment",164],")",["T_WHITESPACE"," ",164],"{",["T_WHITESPACE","\n            ",164],["T_IF","if",165],["T_WHITESPACE"," ",165],"(",["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","payment",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","getSkipTransactionCreation",165],"(",")",")",["T_WHITESPACE"," ",165],"{",["T_WHITESPACE","\n                ",165],["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","payment",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","unsTransactionId",166],"(",")",";",["T_WHITESPACE","\n                ",166],["T_RETURN","return",167],["T_WHITESPACE"," ",167],["T_STRING","false",167],";",["T_WHITESPACE","\n            ",167],"}",["T_WHITESPACE","\n            ",168],["T_RETURN","return",169],["T_WHITESPACE"," ",169],["T_STRING","true",169],";",["T_WHITESPACE","\n        ",169],"}",["T_WHITESPACE","\n        ",170],["T_RETURN","return",171],["T_WHITESPACE"," ",171],["T_STRING","false",171],";",["T_WHITESPACE","\n    ",171],"}",["T_WHITESPACE","\n\n    ",172],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",174],["T_WHITESPACE","\n    ",176],["T_PUBLIC","public",177],["T_WHITESPACE"," ",177],["T_FUNCTION","function",177],["T_WHITESPACE"," ",177],["T_STRING","build",177],"(",["T_VARIABLE","$type",177],")",["T_WHITESPACE","\n    ",177],"{",["T_WHITESPACE","\n        ",178],["T_IF","if",179],["T_WHITESPACE"," ",179],"(",["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","isPaymentExists",179],"(",")",["T_WHITESPACE"," ",179],["T_BOOLEAN_AND","&&",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","transactionId",179],["T_WHITESPACE"," ",179],["T_IS_NOT_IDENTICAL","!==",179],["T_WHITESPACE"," ",179],["T_STRING","null",179],")",["T_WHITESPACE"," ",179],"{",["T_WHITESPACE","\n            ",179],["T_VARIABLE","$transaction",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","transactionRepository",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","getByTransactionId",180],"(",["T_WHITESPACE","\n                ",180],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","transactionId",181],",",["T_WHITESPACE","\n                ",181],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","payment",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","getId",182],"(",")",",",["T_WHITESPACE","\n                ",182],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","order",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","getId",183],"(",")",["T_WHITESPACE","\n            ",183],")",";",["T_WHITESPACE","\n            ",184],["T_IF","if",185],["T_WHITESPACE"," ",185],"(","!",["T_VARIABLE","$transaction",185],")",["T_WHITESPACE"," ",185],"{",["T_WHITESPACE","\n                ",185],["T_VARIABLE","$transaction",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","transactionRepository",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","create",186],"(",")",["T_OBJECT_OPERATOR","->",186],["T_STRING","setTxnId",186],"(",["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","transactionId",186],")",";",["T_WHITESPACE","\n            ",186],"}",["T_WHITESPACE","\n            ",187],["T_VARIABLE","$transaction",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","setPaymentId",188],"(",["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","payment",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","getId",188],"(",")",")",["T_WHITESPACE","\n                ",188],["T_OBJECT_OPERATOR","->",189],["T_STRING","setPayment",189],"(",["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","payment",189],")",["T_WHITESPACE","\n                ",189],["T_OBJECT_OPERATOR","->",190],["T_STRING","setOrderId",190],"(",["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","order",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","getId",190],"(",")",")",["T_WHITESPACE","\n                ",190],["T_OBJECT_OPERATOR","->",191],["T_STRING","setOrder",191],"(",["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","order",191],")",["T_WHITESPACE","\n                ",191],["T_OBJECT_OPERATOR","->",192],["T_STRING","setTxnType",192],"(",["T_VARIABLE","$type",192],")",["T_WHITESPACE","\n                ",192],["T_OBJECT_OPERATOR","->",193],["T_STRING","isFailsafe",193],"(",["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","failSafe",193],")",";",["T_WHITESPACE","\n\n            ",193],["T_IF","if",195],["T_WHITESPACE"," ",195],"(",["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","payment",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","hasIsTransactionClosed",195],"(",")",")",["T_WHITESPACE"," ",195],"{",["T_WHITESPACE","\n                ",195],["T_VARIABLE","$transaction",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","setIsClosed",196],"(",["T_INT_CAST","(int)",196],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","payment",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","getIsTransactionClosed",196],"(",")",")",";",["T_WHITESPACE","\n            ",196],"}",["T_WHITESPACE","\n            ",197],["T_IF","if",198],["T_WHITESPACE"," ",198],"(",["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","transactionAdditionalInfo",198],")",["T_WHITESPACE"," ",198],"{",["T_WHITESPACE","\n                ",198],["T_FOREACH","foreach",199],["T_WHITESPACE"," ",199],"(",["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","transactionAdditionalInfo",199],["T_WHITESPACE"," ",199],["T_AS","as",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$key",199],["T_WHITESPACE"," ",199],["T_DOUBLE_ARROW","=>",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$value",199],")",["T_WHITESPACE"," ",199],"{",["T_WHITESPACE","\n                    ",199],["T_VARIABLE","$transaction",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","setAdditionalInformation",200],"(",["T_VARIABLE","$key",200],",",["T_WHITESPACE"," ",200],["T_VARIABLE","$value",200],")",";",["T_WHITESPACE","\n                ",200],"}",["T_WHITESPACE","\n            ",201],"}",["T_WHITESPACE","\n            ",202],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","transactionAdditionalInfo",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],"[","]",";",["T_WHITESPACE","\n\n            ",203],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","payment",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","setLastTransId",205],"(",["T_VARIABLE","$transaction",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","getTxnId",205],"(",")",")",";",["T_WHITESPACE","\n            ",205],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","payment",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","setCreatedTransaction",206],"(",["T_VARIABLE","$transaction",206],")",";",["T_WHITESPACE","\n            ",206],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","order",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","addRelatedObject",207],"(",["T_VARIABLE","$transaction",207],")",";",["T_WHITESPACE","\n            ",207],["T_IF","if",208],["T_WHITESPACE"," ",208],"(",["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","document",208],["T_WHITESPACE"," ",208],["T_BOOLEAN_AND","&&",208],["T_WHITESPACE"," ",208],["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","document",208],["T_WHITESPACE"," ",208],["T_INSTANCEOF","instanceof",208],["T_WHITESPACE"," ",208],["T_STRING","AbstractModel",208],")",["T_WHITESPACE"," ",208],"{",["T_WHITESPACE","\n                ",208],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","document",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","setTransactionId",209],"(",["T_VARIABLE","$transaction",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","getTxnId",209],"(",")",")",";",["T_WHITESPACE","\n            ",209],"}",["T_WHITESPACE","\n\n            ",210],["T_RETURN","return",212],["T_WHITESPACE"," ",212],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","linkWithParentTransaction",212],"(",["T_VARIABLE","$transaction",212],")",";",["T_WHITESPACE","\n        ",212],"}",["T_WHITESPACE","\n        ",213],["T_RETURN","return",214],["T_WHITESPACE"," ",214],["T_STRING","null",214],";",["T_WHITESPACE","\n    ",214],"}",["T_WHITESPACE","\n\n    ",215],["T_DOC_COMMENT","\/**\n     * Links transaction with parent transaction\n     *\n     * @param TransactionInterface $transaction\n     * @return TransactionInterface\n     *\/",217],["T_WHITESPACE","\n    ",222],["T_PROTECTED","protected",223],["T_WHITESPACE"," ",223],["T_FUNCTION","function",223],["T_WHITESPACE"," ",223],["T_STRING","linkWithParentTransaction",223],"(",["T_STRING","TransactionInterface",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$transaction",223],")",["T_WHITESPACE","\n    ",223],"{",["T_WHITESPACE","\n        ",224],["T_VARIABLE","$parentTransactionId",225],["T_WHITESPACE"," ",225],"=",["T_WHITESPACE"," ",225],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","payment",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","getParentTransactionId",225],"(",")",";",["T_WHITESPACE","\n\n        ",225],["T_IF","if",227],["T_WHITESPACE"," ",227],"(",["T_VARIABLE","$parentTransactionId",227],")",["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n            ",227],["T_VARIABLE","$transaction",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","setParentTxnId",228],"(",["T_VARIABLE","$parentTransactionId",228],")",";",["T_WHITESPACE","\n            ",228],["T_IF","if",229],["T_WHITESPACE"," ",229],"(",["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","payment",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","getShouldCloseParentTransaction",229],"(",")",")",["T_WHITESPACE"," ",229],"{",["T_WHITESPACE","\n                ",229],["T_VARIABLE","$parentTransaction",230],["T_WHITESPACE"," ",230],"=",["T_WHITESPACE"," ",230],["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","transactionRepository",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","getByTransactionId",230],"(",["T_WHITESPACE","\n                    ",230],["T_VARIABLE","$parentTransactionId",231],",",["T_WHITESPACE","\n                    ",231],["T_VARIABLE","$this",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","payment",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","getid",232],"(",")",",",["T_WHITESPACE","\n                    ",232],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","order",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","getId",233],"(",")",["T_WHITESPACE","\n                ",233],")",";",["T_WHITESPACE","\n                ",234],["T_IF","if",235],["T_WHITESPACE"," ",235],"(",["T_VARIABLE","$parentTransaction",235],")",["T_WHITESPACE"," ",235],"{",["T_WHITESPACE","\n                    ",235],["T_IF","if",236],["T_WHITESPACE"," ",236],"(","!",["T_VARIABLE","$parentTransaction",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","getIsClosed",236],"(",")",")",["T_WHITESPACE"," ",236],"{",["T_WHITESPACE","\n                        ",236],["T_VARIABLE","$parentTransaction",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","isFailsafe",237],"(",["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","failSafe",237],")",["T_OBJECT_OPERATOR","->",237],["T_STRING","close",237],"(",["T_STRING","false",237],")",";",["T_WHITESPACE","\n                    ",237],"}",["T_WHITESPACE","\n                    ",238],["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","order",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","addRelatedObject",239],"(",["T_VARIABLE","$parentTransaction",239],")",";",["T_WHITESPACE","\n                ",239],"}",["T_WHITESPACE","\n            ",240],"}",["T_WHITESPACE","\n        ",241],"}",["T_WHITESPACE","\n        ",242],["T_RETURN","return",243],["T_WHITESPACE"," ",243],["T_VARIABLE","$transaction",243],";",["T_WHITESPACE","\n    ",243],"}",["T_WHITESPACE","\n",244],"}",["T_WHITESPACE","\n",245]]