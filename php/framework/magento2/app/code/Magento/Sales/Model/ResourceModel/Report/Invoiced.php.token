[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Sales",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","ResourceModel",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Report",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Invoice report resource model\n *\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",8],["T_WHITESPACE","\n",12],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","Invoiced",13],["T_WHITESPACE"," ",13],["T_EXTENDS","extends",13],["T_WHITESPACE"," ",13],["T_STRING","AbstractReport",13],["T_WHITESPACE","\n",13],"{",["T_WHITESPACE","\n    ",14],["T_DOC_COMMENT","\/**\n     * Model initialization\n     *\n     * @return void\n     *\/",15],["T_WHITESPACE","\n    ",19],["T_PROTECTED","protected",20],["T_WHITESPACE"," ",20],["T_FUNCTION","function",20],["T_WHITESPACE"," ",20],["T_STRING","_construct",20],"(",")",["T_WHITESPACE","\n    ",20],"{",["T_WHITESPACE","\n        ",21],["T_VARIABLE","$this",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","_setResource",22],"(",["T_CONSTANT_ENCAPSED_STRING","'sales'",22],")",";",["T_WHITESPACE","\n    ",22],"}",["T_WHITESPACE","\n\n    ",23],["T_DOC_COMMENT","\/**\n     * Aggregate Invoiced data\n     *\n     * @param string|int|\\DateTime|array|null $from\n     * @param string|int|\\DateTime|array|null $to\n     * @return $this\n     *\/",25],["T_WHITESPACE","\n    ",31],["T_PUBLIC","public",32],["T_WHITESPACE"," ",32],["T_FUNCTION","function",32],["T_WHITESPACE"," ",32],["T_STRING","aggregate",32],"(",["T_VARIABLE","$from",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_STRING","null",32],",",["T_WHITESPACE"," ",32],["T_VARIABLE","$to",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_STRING","null",32],")",["T_WHITESPACE","\n    ",32],"{",["T_WHITESPACE","\n        ",33],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","_aggregateByOrderCreatedAt",34],"(",["T_VARIABLE","$from",34],",",["T_WHITESPACE"," ",34],["T_VARIABLE","$to",34],")",";",["T_WHITESPACE","\n        ",34],["T_VARIABLE","$this",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","_aggregateByInvoiceCreatedAt",35],"(",["T_VARIABLE","$from",35],",",["T_WHITESPACE"," ",35],["T_VARIABLE","$to",35],")",";",["T_WHITESPACE","\n\n        ",35],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","_setFlagData",37],"(",["T_NS_SEPARATOR","\\",37],["T_STRING","Magento",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Reports",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Model",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Flag",37],["T_DOUBLE_COLON","::",37],["T_STRING","REPORT_INVOICE_FLAG_CODE",37],")",";",["T_WHITESPACE","\n        ",37],["T_RETURN","return",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$this",38],";",["T_WHITESPACE","\n    ",38],"}",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * Aggregate Invoiced data by invoice created_at as period\n     *\n     * @param string|null $from\n     * @param string|null $to\n     * @return $this\n     * @throws \\Exception\n     * @SuppressWarnings(PHPMD.ExcessiveMethodLength)\n     *\/",41],["T_WHITESPACE","\n    ",49],["T_PROTECTED","protected",50],["T_WHITESPACE"," ",50],["T_FUNCTION","function",50],["T_WHITESPACE"," ",50],["T_STRING","_aggregateByInvoiceCreatedAt",50],"(",["T_VARIABLE","$from",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$to",50],")",["T_WHITESPACE","\n    ",50],"{",["T_WHITESPACE","\n        ",51],["T_VARIABLE","$table",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","getTable",52],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_invoiced_aggregated'",52],")",";",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$sourceTable",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","getTable",53],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_invoice'",53],")",";",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$orderTable",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","getTable",54],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_order'",54],")",";",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$connection",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","getConnection",55],"(",")",";",["T_WHITESPACE","\n\n        ",55],["T_VARIABLE","$connection",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","beginTransaction",57],"(",")",";",["T_WHITESPACE","\n\n        ",57],["T_TRY","try",59],["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n            ",59],["T_IF","if",60],["T_WHITESPACE"," ",60],"(",["T_VARIABLE","$from",60],["T_WHITESPACE"," ",60],["T_IS_NOT_IDENTICAL","!==",60],["T_WHITESPACE"," ",60],["T_STRING","null",60],["T_WHITESPACE"," ",60],["T_BOOLEAN_OR","||",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$to",60],["T_WHITESPACE"," ",60],["T_IS_NOT_IDENTICAL","!==",60],["T_WHITESPACE"," ",60],["T_STRING","null",60],")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n                ",60],["T_VARIABLE","$subSelect",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","_getTableDateRangeRelatedSelect",61],"(",["T_WHITESPACE","\n                    ",61],["T_VARIABLE","$sourceTable",62],",",["T_WHITESPACE","\n                    ",62],["T_VARIABLE","$orderTable",63],",",["T_WHITESPACE","\n                    ",63],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",64],["T_WHITESPACE"," ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",64],"]",",",["T_WHITESPACE","\n                    ",64],["T_CONSTANT_ENCAPSED_STRING","'created_at'",65],",",["T_WHITESPACE","\n                    ",65],["T_CONSTANT_ENCAPSED_STRING","'updated_at'",66],",",["T_WHITESPACE","\n                    ",66],["T_VARIABLE","$from",67],",",["T_WHITESPACE","\n                    ",67],["T_VARIABLE","$to",68],["T_WHITESPACE","\n                ",68],")",";",["T_WHITESPACE","\n            ",69],"}",["T_WHITESPACE"," ",70],["T_ELSE","else",70],["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n                ",70],["T_VARIABLE","$subSelect",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_STRING","null",71],";",["T_WHITESPACE","\n            ",71],"}",["T_WHITESPACE","\n\n            ",72],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","_clearTableByDateRange",74],"(",["T_VARIABLE","$table",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$from",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$to",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$subSelect",74],")",";",["T_WHITESPACE","\n            ",74],["T_COMMENT","\/\/ convert dates to current admin timezone\n",75],["T_WHITESPACE","            ",76],["T_VARIABLE","$periodExpr",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$connection",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getDatePartSql",76],"(",["T_WHITESPACE","\n                ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getStoreTZOffsetQuery",77],"(",["T_WHITESPACE","\n                    ",77],"[",["T_CONSTANT_ENCAPSED_STRING","'source_table'",78],["T_WHITESPACE"," ",78],["T_DOUBLE_ARROW","=>",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$sourceTable",78],"]",",",["T_WHITESPACE","\n                    ",78],["T_CONSTANT_ENCAPSED_STRING","'source_table.created_at'",79],",",["T_WHITESPACE","\n                    ",79],["T_VARIABLE","$from",80],",",["T_WHITESPACE","\n                    ",80],["T_VARIABLE","$to",81],["T_WHITESPACE","\n                ",81],")",["T_WHITESPACE","\n            ",82],")",";",["T_WHITESPACE","\n            ",83],["T_VARIABLE","$columns",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],"[",["T_WHITESPACE","\n                ",84],["T_CONSTANT_ENCAPSED_STRING","'period'",85],["T_WHITESPACE"," ",85],["T_DOUBLE_ARROW","=>",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$periodExpr",85],",",["T_WHITESPACE","\n                ",85],["T_CONSTANT_ENCAPSED_STRING","'store_id'",86],["T_WHITESPACE"," ",86],["T_DOUBLE_ARROW","=>",86],["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","'order_table.store_id'",86],",",["T_WHITESPACE","\n                ",86],["T_CONSTANT_ENCAPSED_STRING","'order_status'",87],["T_WHITESPACE"," ",87],["T_DOUBLE_ARROW","=>",87],["T_WHITESPACE"," ",87],["T_CONSTANT_ENCAPSED_STRING","'order_table.status'",87],",",["T_WHITESPACE","\n                ",87],["T_CONSTANT_ENCAPSED_STRING","'orders_count'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_NEW","new",88],["T_WHITESPACE"," ",88],["T_NS_SEPARATOR","\\",88],["T_STRING","Zend_Db_Expr",88],"(",["T_CONSTANT_ENCAPSED_STRING","'COUNT(order_table.entity_id)'",88],")",",",["T_WHITESPACE","\n                ",88],["T_CONSTANT_ENCAPSED_STRING","'orders_invoiced'",89],["T_WHITESPACE"," ",89],["T_DOUBLE_ARROW","=>",89],["T_WHITESPACE"," ",89],["T_NEW","new",89],["T_WHITESPACE"," ",89],["T_NS_SEPARATOR","\\",89],["T_STRING","Zend_Db_Expr",89],"(",["T_CONSTANT_ENCAPSED_STRING","'COUNT(order_table.entity_id)'",89],")",",",["T_WHITESPACE","\n                ",89],["T_CONSTANT_ENCAPSED_STRING","'invoiced'",90],["T_WHITESPACE"," ",90],["T_DOUBLE_ARROW","=>",90],["T_WHITESPACE"," ",90],["T_NEW","new",90],["T_WHITESPACE"," ",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Zend_Db_Expr",90],"(",["T_WHITESPACE","\n                    ",90],["T_CONSTANT_ENCAPSED_STRING","'SUM(order_table.base_total_invoiced * order_table.base_to_global_rate)'",91],["T_WHITESPACE","\n                ",91],")",",",["T_WHITESPACE","\n                ",92],["T_CONSTANT_ENCAPSED_STRING","'invoiced_captured'",93],["T_WHITESPACE"," ",93],["T_DOUBLE_ARROW","=>",93],["T_WHITESPACE"," ",93],["T_NEW","new",93],["T_WHITESPACE"," ",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Zend_Db_Expr",93],"(",["T_WHITESPACE","\n                    ",93],["T_CONSTANT_ENCAPSED_STRING","'SUM(order_table.base_total_paid * order_table.base_to_global_rate)'",94],["T_WHITESPACE","\n                ",94],")",",",["T_WHITESPACE","\n                ",95],["T_CONSTANT_ENCAPSED_STRING","'invoiced_not_captured'",96],["T_WHITESPACE"," ",96],["T_DOUBLE_ARROW","=>",96],["T_WHITESPACE"," ",96],["T_NEW","new",96],["T_WHITESPACE"," ",96],["T_NS_SEPARATOR","\\",96],["T_STRING","Zend_Db_Expr",96],"(",["T_WHITESPACE","\n                    ",96],["T_CONSTANT_ENCAPSED_STRING","'SUM((order_table.base_total_invoiced - order_table.base_total_paid)'",97],["T_WHITESPACE"," ",97],".",["T_WHITESPACE","\n                    ",97],["T_CONSTANT_ENCAPSED_STRING","' * order_table.base_to_global_rate)'",98],["T_WHITESPACE","\n                ",98],")",",",["T_WHITESPACE","\n            ",99],"]",";",["T_WHITESPACE","\n\n            ",100],["T_VARIABLE","$select",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$connection",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","select",102],"(",")",";",["T_WHITESPACE","\n            ",102],["T_VARIABLE","$select",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","from",103],"(",["T_WHITESPACE","\n                ",103],"[",["T_CONSTANT_ENCAPSED_STRING","'source_table'",104],["T_WHITESPACE"," ",104],["T_DOUBLE_ARROW","=>",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$sourceTable",104],"]",",",["T_WHITESPACE","\n                ",104],["T_VARIABLE","$columns",105],["T_WHITESPACE","\n            ",105],")",["T_OBJECT_OPERATOR","->",106],["T_STRING","joinInner",106],"(",["T_WHITESPACE","\n                ",106],"[",["T_CONSTANT_ENCAPSED_STRING","'order_table'",107],["T_WHITESPACE"," ",107],["T_DOUBLE_ARROW","=>",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$orderTable",107],"]",",",["T_WHITESPACE","\n                ",107],["T_VARIABLE","$connection",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","quoteInto",108],"(",["T_WHITESPACE","\n                    ",108],["T_CONSTANT_ENCAPSED_STRING","'source_table.order_id = order_table.entity_id AND order_table.state <> ?'",109],",",["T_WHITESPACE","\n                    ",109],["T_NS_SEPARATOR","\\",110],["T_STRING","Magento",110],["T_NS_SEPARATOR","\\",110],["T_STRING","Sales",110],["T_NS_SEPARATOR","\\",110],["T_STRING","Model",110],["T_NS_SEPARATOR","\\",110],["T_STRING","Order",110],["T_DOUBLE_COLON","::",110],["T_STRING","STATE_CANCELED",110],["T_WHITESPACE","\n                ",110],")",",",["T_WHITESPACE","\n                ",111],"[","]",["T_WHITESPACE","\n            ",112],")",";",["T_WHITESPACE","\n\n            ",113],["T_VARIABLE","$filterSubSelect",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$connection",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","select",115],"(",")",";",["T_WHITESPACE","\n            ",115],["T_VARIABLE","$filterSubSelect",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","from",116],"(",["T_WHITESPACE","\n                ",116],"[",["T_CONSTANT_ENCAPSED_STRING","'filter_source_table'",117],["T_WHITESPACE"," ",117],["T_DOUBLE_ARROW","=>",117],["T_WHITESPACE"," ",117],["T_VARIABLE","$sourceTable",117],"]",",",["T_WHITESPACE","\n                ",117],["T_CONSTANT_ENCAPSED_STRING","'MAX(filter_source_table.entity_id)'",118],["T_WHITESPACE","\n            ",118],")",["T_OBJECT_OPERATOR","->",119],["T_STRING","where",119],"(",["T_WHITESPACE","\n                ",119],["T_CONSTANT_ENCAPSED_STRING","'filter_source_table.order_id = source_table.order_id'",120],["T_WHITESPACE","\n            ",120],")",";",["T_WHITESPACE","\n\n            ",121],["T_IF","if",123],["T_WHITESPACE"," ",123],"(",["T_VARIABLE","$subSelect",123],["T_WHITESPACE"," ",123],["T_IS_NOT_IDENTICAL","!==",123],["T_WHITESPACE"," ",123],["T_STRING","null",123],")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n                ",123],["T_VARIABLE","$select",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","having",124],"(",["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","_makeConditionFromDateRangeSelect",124],"(",["T_VARIABLE","$subSelect",124],",",["T_WHITESPACE"," ",124],["T_CONSTANT_ENCAPSED_STRING","'period'",124],")",")",";",["T_WHITESPACE","\n            ",124],"}",["T_WHITESPACE","\n\n            ",125],["T_VARIABLE","$select",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","where",127],"(",["T_CONSTANT_ENCAPSED_STRING","'source_table.entity_id = (?)'",127],",",["T_WHITESPACE"," ",127],["T_NEW","new",127],["T_WHITESPACE"," ",127],["T_NS_SEPARATOR","\\",127],["T_STRING","Zend_Db_Expr",127],"(",["T_VARIABLE","$filterSubSelect",127],")",")",";",["T_WHITESPACE","\n            ",127],["T_UNSET","unset",128],"(",["T_VARIABLE","$filterSubSelect",128],")",";",["T_WHITESPACE","\n\n            ",128],["T_VARIABLE","$select",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","group",130],"(","[",["T_VARIABLE","$periodExpr",130],",",["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","'order_table.store_id'",130],",",["T_WHITESPACE"," ",130],["T_CONSTANT_ENCAPSED_STRING","'order_table.status'",130],"]",")",";",["T_WHITESPACE","\n\n            ",130],["T_VARIABLE","$select",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","having",132],"(",["T_CONSTANT_ENCAPSED_STRING","'orders_count > 0'",132],")",";",["T_WHITESPACE","\n            ",132],["T_VARIABLE","$insertQuery",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_VARIABLE","$select",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","insertFromSelect",133],"(",["T_VARIABLE","$table",133],",",["T_WHITESPACE"," ",133],["T_STRING","array_keys",133],"(",["T_VARIABLE","$columns",133],")",")",";",["T_WHITESPACE","\n            ",133],["T_VARIABLE","$connection",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","query",134],"(",["T_VARIABLE","$insertQuery",134],")",";",["T_WHITESPACE","\n            ",134],["T_VARIABLE","$select",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","reset",135],"(",")",";",["T_WHITESPACE","\n\n            ",135],["T_VARIABLE","$columns",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],"[",["T_WHITESPACE","\n                ",137],["T_CONSTANT_ENCAPSED_STRING","'period'",138],["T_WHITESPACE"," ",138],["T_DOUBLE_ARROW","=>",138],["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","'period'",138],",",["T_WHITESPACE","\n                ",138],["T_CONSTANT_ENCAPSED_STRING","'store_id'",139],["T_WHITESPACE"," ",139],["T_DOUBLE_ARROW","=>",139],["T_WHITESPACE"," ",139],["T_NEW","new",139],["T_WHITESPACE"," ",139],["T_NS_SEPARATOR","\\",139],["T_STRING","Zend_Db_Expr",139],"(",["T_NS_SEPARATOR","\\",139],["T_STRING","Magento",139],["T_NS_SEPARATOR","\\",139],["T_STRING","Store",139],["T_NS_SEPARATOR","\\",139],["T_STRING","Model",139],["T_NS_SEPARATOR","\\",139],["T_STRING","Store",139],["T_DOUBLE_COLON","::",139],["T_STRING","DEFAULT_STORE_ID",139],")",",",["T_WHITESPACE","\n                ",139],["T_CONSTANT_ENCAPSED_STRING","'order_status'",140],["T_WHITESPACE"," ",140],["T_DOUBLE_ARROW","=>",140],["T_WHITESPACE"," ",140],["T_CONSTANT_ENCAPSED_STRING","'order_status'",140],",",["T_WHITESPACE","\n                ",140],["T_CONSTANT_ENCAPSED_STRING","'orders_count'",141],["T_WHITESPACE"," ",141],["T_DOUBLE_ARROW","=>",141],["T_WHITESPACE"," ",141],["T_NEW","new",141],["T_WHITESPACE"," ",141],["T_NS_SEPARATOR","\\",141],["T_STRING","Zend_Db_Expr",141],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(orders_count)'",141],")",",",["T_WHITESPACE","\n                ",141],["T_CONSTANT_ENCAPSED_STRING","'orders_invoiced'",142],["T_WHITESPACE"," ",142],["T_DOUBLE_ARROW","=>",142],["T_WHITESPACE"," ",142],["T_NEW","new",142],["T_WHITESPACE"," ",142],["T_NS_SEPARATOR","\\",142],["T_STRING","Zend_Db_Expr",142],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(orders_invoiced)'",142],")",",",["T_WHITESPACE","\n                ",142],["T_CONSTANT_ENCAPSED_STRING","'invoiced'",143],["T_WHITESPACE"," ",143],["T_DOUBLE_ARROW","=>",143],["T_WHITESPACE"," ",143],["T_NEW","new",143],["T_WHITESPACE"," ",143],["T_NS_SEPARATOR","\\",143],["T_STRING","Zend_Db_Expr",143],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(invoiced)'",143],")",",",["T_WHITESPACE","\n                ",143],["T_CONSTANT_ENCAPSED_STRING","'invoiced_captured'",144],["T_WHITESPACE"," ",144],["T_DOUBLE_ARROW","=>",144],["T_WHITESPACE"," ",144],["T_NEW","new",144],["T_WHITESPACE"," ",144],["T_NS_SEPARATOR","\\",144],["T_STRING","Zend_Db_Expr",144],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(invoiced_captured)'",144],")",",",["T_WHITESPACE","\n                ",144],["T_CONSTANT_ENCAPSED_STRING","'invoiced_not_captured'",145],["T_WHITESPACE"," ",145],["T_DOUBLE_ARROW","=>",145],["T_WHITESPACE"," ",145],["T_NEW","new",145],["T_WHITESPACE"," ",145],["T_NS_SEPARATOR","\\",145],["T_STRING","Zend_Db_Expr",145],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(invoiced_not_captured)'",145],")",",",["T_WHITESPACE","\n            ",145],"]",";",["T_WHITESPACE","\n\n            ",146],["T_VARIABLE","$select",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","from",148],"(",["T_VARIABLE","$table",148],",",["T_WHITESPACE"," ",148],["T_VARIABLE","$columns",148],")",["T_OBJECT_OPERATOR","->",148],["T_STRING","where",148],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id <> ?'",148],",",["T_WHITESPACE"," ",148],["T_NS_SEPARATOR","\\",148],["T_STRING","Magento",148],["T_NS_SEPARATOR","\\",148],["T_STRING","Store",148],["T_NS_SEPARATOR","\\",148],["T_STRING","Model",148],["T_NS_SEPARATOR","\\",148],["T_STRING","Store",148],["T_DOUBLE_COLON","::",148],["T_STRING","DEFAULT_STORE_ID",148],")",";",["T_WHITESPACE","\n\n            ",148],["T_IF","if",150],["T_WHITESPACE"," ",150],"(",["T_VARIABLE","$subSelect",150],["T_WHITESPACE"," ",150],["T_IS_NOT_IDENTICAL","!==",150],["T_WHITESPACE"," ",150],["T_STRING","null",150],")",["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n                ",150],["T_VARIABLE","$select",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","where",151],"(",["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","_makeConditionFromDateRangeSelect",151],"(",["T_VARIABLE","$subSelect",151],",",["T_WHITESPACE"," ",151],["T_CONSTANT_ENCAPSED_STRING","'period'",151],")",")",";",["T_WHITESPACE","\n            ",151],"}",["T_WHITESPACE","\n\n            ",152],["T_VARIABLE","$select",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","group",154],"(","[",["T_CONSTANT_ENCAPSED_STRING","'period'",154],",",["T_WHITESPACE"," ",154],["T_CONSTANT_ENCAPSED_STRING","'order_status'",154],"]",")",";",["T_WHITESPACE","\n            ",154],["T_VARIABLE","$insertQuery",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_VARIABLE","$select",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","insertFromSelect",155],"(",["T_VARIABLE","$table",155],",",["T_WHITESPACE"," ",155],["T_STRING","array_keys",155],"(",["T_VARIABLE","$columns",155],")",")",";",["T_WHITESPACE","\n            ",155],["T_VARIABLE","$connection",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","query",156],"(",["T_VARIABLE","$insertQuery",156],")",";",["T_WHITESPACE","\n            ",156],["T_VARIABLE","$connection",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","commit",157],"(",")",";",["T_WHITESPACE","\n        ",157],"}",["T_WHITESPACE"," ",158],["T_CATCH","catch",158],["T_WHITESPACE"," ",158],"(",["T_NS_SEPARATOR","\\",158],["T_STRING","Exception",158],["T_WHITESPACE"," ",158],["T_VARIABLE","$e",158],")",["T_WHITESPACE"," ",158],"{",["T_WHITESPACE","\n            ",158],["T_VARIABLE","$connection",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","rollBack",159],"(",")",";",["T_WHITESPACE","\n            ",159],["T_THROW","throw",160],["T_WHITESPACE"," ",160],["T_VARIABLE","$e",160],";",["T_WHITESPACE","\n        ",160],"}",["T_WHITESPACE","\n\n        ",161],["T_RETURN","return",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$this",163],";",["T_WHITESPACE","\n    ",163],"}",["T_WHITESPACE","\n\n    ",164],["T_DOC_COMMENT","\/**\n     * Aggregate Invoiced data by order created_at as period\n     *\n     * @param string|null $from\n     * @param string|null $to\n     * @return $this\n     *\/",166],["T_WHITESPACE","\n    ",172],["T_PROTECTED","protected",173],["T_WHITESPACE"," ",173],["T_FUNCTION","function",173],["T_WHITESPACE"," ",173],["T_STRING","_aggregateByOrderCreatedAt",173],"(",["T_VARIABLE","$from",173],",",["T_WHITESPACE"," ",173],["T_VARIABLE","$to",173],")",["T_WHITESPACE","\n    ",173],"{",["T_WHITESPACE","\n        ",174],["T_VARIABLE","$table",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","getTable",175],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_invoiced_aggregated_order'",175],")",";",["T_WHITESPACE","\n        ",175],["T_VARIABLE","$sourceTable",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","getTable",176],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_order'",176],")",";",["T_WHITESPACE","\n        ",176],["T_VARIABLE","$connection",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","getConnection",177],"(",")",";",["T_WHITESPACE","\n\n        ",177],["T_IF","if",179],["T_WHITESPACE"," ",179],"(",["T_VARIABLE","$from",179],["T_WHITESPACE"," ",179],["T_IS_NOT_IDENTICAL","!==",179],["T_WHITESPACE"," ",179],["T_STRING","null",179],["T_WHITESPACE"," ",179],["T_BOOLEAN_OR","||",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$to",179],["T_WHITESPACE"," ",179],["T_IS_NOT_IDENTICAL","!==",179],["T_WHITESPACE"," ",179],["T_STRING","null",179],")",["T_WHITESPACE"," ",179],"{",["T_WHITESPACE","\n            ",179],["T_VARIABLE","$subSelect",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","_getTableDateRangeSelect",180],"(",["T_VARIABLE","$sourceTable",180],",",["T_WHITESPACE"," ",180],["T_CONSTANT_ENCAPSED_STRING","'created_at'",180],",",["T_WHITESPACE"," ",180],["T_CONSTANT_ENCAPSED_STRING","'updated_at'",180],",",["T_WHITESPACE"," ",180],["T_VARIABLE","$from",180],",",["T_WHITESPACE"," ",180],["T_VARIABLE","$to",180],")",";",["T_WHITESPACE","\n        ",180],"}",["T_WHITESPACE"," ",181],["T_ELSE","else",181],["T_WHITESPACE"," ",181],"{",["T_WHITESPACE","\n            ",181],["T_VARIABLE","$subSelect",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],["T_STRING","null",182],";",["T_WHITESPACE","\n        ",182],"}",["T_WHITESPACE","\n\n        ",183],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","_clearTableByDateRange",185],"(",["T_VARIABLE","$table",185],",",["T_WHITESPACE"," ",185],["T_VARIABLE","$from",185],",",["T_WHITESPACE"," ",185],["T_VARIABLE","$to",185],",",["T_WHITESPACE"," ",185],["T_VARIABLE","$subSelect",185],")",";",["T_WHITESPACE","\n        ",185],["T_COMMENT","\/\/ convert dates to current admin timezone\n",186],["T_WHITESPACE","        ",187],["T_VARIABLE","$periodExpr",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_VARIABLE","$connection",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","getDatePartSql",187],"(",["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","getStoreTZOffsetQuery",187],"(",["T_VARIABLE","$sourceTable",187],",",["T_WHITESPACE"," ",187],["T_CONSTANT_ENCAPSED_STRING","'created_at'",187],",",["T_WHITESPACE"," ",187],["T_VARIABLE","$from",187],",",["T_WHITESPACE"," ",187],["T_VARIABLE","$to",187],")",")",";",["T_WHITESPACE","\n\n        ",187],["T_VARIABLE","$columns",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],"[",["T_WHITESPACE","\n            ",189],["T_CONSTANT_ENCAPSED_STRING","'period'",190],["T_WHITESPACE"," ",190],["T_DOUBLE_ARROW","=>",190],["T_WHITESPACE"," ",190],["T_VARIABLE","$periodExpr",190],",",["T_WHITESPACE","\n            ",190],["T_CONSTANT_ENCAPSED_STRING","'store_id'",191],["T_WHITESPACE"," ",191],["T_DOUBLE_ARROW","=>",191],["T_WHITESPACE"," ",191],["T_CONSTANT_ENCAPSED_STRING","'store_id'",191],",",["T_WHITESPACE","\n            ",191],["T_CONSTANT_ENCAPSED_STRING","'order_status'",192],["T_WHITESPACE"," ",192],["T_DOUBLE_ARROW","=>",192],["T_WHITESPACE"," ",192],["T_CONSTANT_ENCAPSED_STRING","'status'",192],",",["T_WHITESPACE","\n            ",192],["T_CONSTANT_ENCAPSED_STRING","'orders_count'",193],["T_WHITESPACE"," ",193],["T_DOUBLE_ARROW","=>",193],["T_WHITESPACE"," ",193],["T_NEW","new",193],["T_WHITESPACE"," ",193],["T_NS_SEPARATOR","\\",193],["T_STRING","Zend_Db_Expr",193],"(",["T_CONSTANT_ENCAPSED_STRING","'COUNT(base_total_invoiced)'",193],")",",",["T_WHITESPACE","\n            ",193],["T_CONSTANT_ENCAPSED_STRING","'orders_invoiced'",194],["T_WHITESPACE"," ",194],["T_DOUBLE_ARROW","=>",194],["T_WHITESPACE"," ",194],["T_NEW","new",194],["T_WHITESPACE"," ",194],["T_NS_SEPARATOR","\\",194],["T_STRING","Zend_Db_Expr",194],"(",["T_WHITESPACE","\n                ",194],["T_STRING","sprintf",195],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(%s)'",195],",",["T_WHITESPACE"," ",195],["T_VARIABLE","$connection",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","getCheckSql",195],"(",["T_CONSTANT_ENCAPSED_STRING","'base_total_invoiced > 0'",195],",",["T_WHITESPACE"," ",195],["T_LNUMBER","1",195],",",["T_WHITESPACE"," ",195],["T_LNUMBER","0",195],")",")",["T_WHITESPACE","\n            ",195],")",",",["T_WHITESPACE","\n            ",196],["T_CONSTANT_ENCAPSED_STRING","'invoiced'",197],["T_WHITESPACE"," ",197],["T_DOUBLE_ARROW","=>",197],["T_WHITESPACE"," ",197],["T_NEW","new",197],["T_WHITESPACE"," ",197],["T_NS_SEPARATOR","\\",197],["T_STRING","Zend_Db_Expr",197],"(",["T_WHITESPACE","\n                ",197],["T_STRING","sprintf",198],"(",["T_WHITESPACE","\n                    ",198],["T_CONSTANT_ENCAPSED_STRING","'SUM(%s * %s)'",199],",",["T_WHITESPACE","\n                    ",199],["T_VARIABLE","$connection",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","getIfNullSql",200],"(",["T_CONSTANT_ENCAPSED_STRING","'base_total_invoiced'",200],",",["T_WHITESPACE"," ",200],["T_LNUMBER","0",200],")",",",["T_WHITESPACE","\n                    ",200],["T_VARIABLE","$connection",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","getIfNullSql",201],"(",["T_CONSTANT_ENCAPSED_STRING","'base_to_global_rate'",201],",",["T_WHITESPACE"," ",201],["T_LNUMBER","0",201],")",["T_WHITESPACE","\n                ",201],")",["T_WHITESPACE","\n            ",202],")",",",["T_WHITESPACE","\n            ",203],["T_CONSTANT_ENCAPSED_STRING","'invoiced_captured'",204],["T_WHITESPACE"," ",204],["T_DOUBLE_ARROW","=>",204],["T_WHITESPACE"," ",204],["T_NEW","new",204],["T_WHITESPACE"," ",204],["T_NS_SEPARATOR","\\",204],["T_STRING","Zend_Db_Expr",204],"(",["T_WHITESPACE","\n                ",204],["T_STRING","sprintf",205],"(",["T_WHITESPACE","\n                    ",205],["T_CONSTANT_ENCAPSED_STRING","'SUM(%s * %s)'",206],",",["T_WHITESPACE","\n                    ",206],["T_VARIABLE","$connection",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","getIfNullSql",207],"(",["T_CONSTANT_ENCAPSED_STRING","'base_total_paid'",207],",",["T_WHITESPACE"," ",207],["T_LNUMBER","0",207],")",",",["T_WHITESPACE","\n                    ",207],["T_VARIABLE","$connection",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","getIfNullSql",208],"(",["T_CONSTANT_ENCAPSED_STRING","'base_to_global_rate'",208],",",["T_WHITESPACE"," ",208],["T_LNUMBER","0",208],")",["T_WHITESPACE","\n                ",208],")",["T_WHITESPACE","\n            ",209],")",",",["T_WHITESPACE","\n            ",210],["T_CONSTANT_ENCAPSED_STRING","'invoiced_not_captured'",211],["T_WHITESPACE"," ",211],["T_DOUBLE_ARROW","=>",211],["T_WHITESPACE"," ",211],["T_NEW","new",211],["T_WHITESPACE"," ",211],["T_NS_SEPARATOR","\\",211],["T_STRING","Zend_Db_Expr",211],"(",["T_WHITESPACE","\n                ",211],["T_STRING","sprintf",212],"(",["T_WHITESPACE","\n                    ",212],["T_CONSTANT_ENCAPSED_STRING","'SUM((%s - %s) * %s)'",213],",",["T_WHITESPACE","\n                    ",213],["T_VARIABLE","$connection",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","getIfNullSql",214],"(",["T_CONSTANT_ENCAPSED_STRING","'base_total_invoiced'",214],",",["T_WHITESPACE"," ",214],["T_LNUMBER","0",214],")",",",["T_WHITESPACE","\n                    ",214],["T_VARIABLE","$connection",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","getIfNullSql",215],"(",["T_CONSTANT_ENCAPSED_STRING","'base_total_paid'",215],",",["T_WHITESPACE"," ",215],["T_LNUMBER","0",215],")",",",["T_WHITESPACE","\n                    ",215],["T_VARIABLE","$connection",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","getIfNullSql",216],"(",["T_CONSTANT_ENCAPSED_STRING","'base_to_global_rate'",216],",",["T_WHITESPACE"," ",216],["T_LNUMBER","0",216],")",["T_WHITESPACE","\n                ",216],")",["T_WHITESPACE","\n            ",217],")",",",["T_WHITESPACE","\n        ",218],"]",";",["T_WHITESPACE","\n\n        ",219],["T_VARIABLE","$select",221],["T_WHITESPACE"," ",221],"=",["T_WHITESPACE"," ",221],["T_VARIABLE","$connection",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","select",221],"(",")",";",["T_WHITESPACE","\n        ",221],["T_VARIABLE","$select",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","from",222],"(",["T_VARIABLE","$sourceTable",222],",",["T_WHITESPACE"," ",222],["T_VARIABLE","$columns",222],")",["T_OBJECT_OPERATOR","->",222],["T_STRING","where",222],"(",["T_CONSTANT_ENCAPSED_STRING","'state <> ?'",222],",",["T_WHITESPACE"," ",222],["T_NS_SEPARATOR","\\",222],["T_STRING","Magento",222],["T_NS_SEPARATOR","\\",222],["T_STRING","Sales",222],["T_NS_SEPARATOR","\\",222],["T_STRING","Model",222],["T_NS_SEPARATOR","\\",222],["T_STRING","Order",222],["T_DOUBLE_COLON","::",222],["T_STRING","STATE_CANCELED",222],")",";",["T_WHITESPACE","\n\n        ",222],["T_IF","if",224],["T_WHITESPACE"," ",224],"(",["T_VARIABLE","$subSelect",224],["T_WHITESPACE"," ",224],["T_IS_NOT_IDENTICAL","!==",224],["T_WHITESPACE"," ",224],["T_STRING","null",224],")",["T_WHITESPACE"," ",224],"{",["T_WHITESPACE","\n            ",224],["T_VARIABLE","$select",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","having",225],"(",["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","_makeConditionFromDateRangeSelect",225],"(",["T_VARIABLE","$subSelect",225],",",["T_WHITESPACE"," ",225],["T_CONSTANT_ENCAPSED_STRING","'period'",225],")",")",";",["T_WHITESPACE","\n        ",225],"}",["T_WHITESPACE","\n\n        ",226],["T_VARIABLE","$select",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","group",228],"(","[",["T_VARIABLE","$periodExpr",228],",",["T_WHITESPACE"," ",228],["T_CONSTANT_ENCAPSED_STRING","'store_id'",228],",",["T_WHITESPACE"," ",228],["T_CONSTANT_ENCAPSED_STRING","'status'",228],"]",")",";",["T_WHITESPACE","\n        ",228],["T_VARIABLE","$select",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","having",229],"(",["T_CONSTANT_ENCAPSED_STRING","'orders_count > 0'",229],")",";",["T_WHITESPACE","\n\n        ",229],["T_VARIABLE","$insertQuery",231],["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],["T_VARIABLE","$select",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","insertFromSelect",231],"(",["T_VARIABLE","$table",231],",",["T_WHITESPACE"," ",231],["T_STRING","array_keys",231],"(",["T_VARIABLE","$columns",231],")",")",";",["T_WHITESPACE","\n        ",231],["T_VARIABLE","$connection",232],["T_OBJECT_OPERATOR","->",232],["T_STRING","query",232],"(",["T_VARIABLE","$insertQuery",232],")",";",["T_WHITESPACE","\n        ",232],["T_VARIABLE","$select",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","reset",233],"(",")",";",["T_WHITESPACE","\n\n        ",233],["T_VARIABLE","$columns",235],["T_WHITESPACE"," ",235],"=",["T_WHITESPACE"," ",235],"[",["T_WHITESPACE","\n            ",235],["T_CONSTANT_ENCAPSED_STRING","'period'",236],["T_WHITESPACE"," ",236],["T_DOUBLE_ARROW","=>",236],["T_WHITESPACE"," ",236],["T_CONSTANT_ENCAPSED_STRING","'period'",236],",",["T_WHITESPACE","\n            ",236],["T_CONSTANT_ENCAPSED_STRING","'store_id'",237],["T_WHITESPACE"," ",237],["T_DOUBLE_ARROW","=>",237],["T_WHITESPACE"," ",237],["T_NEW","new",237],["T_WHITESPACE"," ",237],["T_NS_SEPARATOR","\\",237],["T_STRING","Zend_Db_Expr",237],"(",["T_NS_SEPARATOR","\\",237],["T_STRING","Magento",237],["T_NS_SEPARATOR","\\",237],["T_STRING","Store",237],["T_NS_SEPARATOR","\\",237],["T_STRING","Model",237],["T_NS_SEPARATOR","\\",237],["T_STRING","Store",237],["T_DOUBLE_COLON","::",237],["T_STRING","DEFAULT_STORE_ID",237],")",",",["T_WHITESPACE","\n            ",237],["T_CONSTANT_ENCAPSED_STRING","'order_status'",238],["T_WHITESPACE"," ",238],["T_DOUBLE_ARROW","=>",238],["T_WHITESPACE"," ",238],["T_CONSTANT_ENCAPSED_STRING","'order_status'",238],",",["T_WHITESPACE","\n            ",238],["T_CONSTANT_ENCAPSED_STRING","'orders_count'",239],["T_WHITESPACE"," ",239],["T_DOUBLE_ARROW","=>",239],["T_WHITESPACE"," ",239],["T_NEW","new",239],["T_WHITESPACE"," ",239],["T_NS_SEPARATOR","\\",239],["T_STRING","Zend_Db_Expr",239],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(orders_count)'",239],")",",",["T_WHITESPACE","\n            ",239],["T_CONSTANT_ENCAPSED_STRING","'orders_invoiced'",240],["T_WHITESPACE"," ",240],["T_DOUBLE_ARROW","=>",240],["T_WHITESPACE"," ",240],["T_NEW","new",240],["T_WHITESPACE"," ",240],["T_NS_SEPARATOR","\\",240],["T_STRING","Zend_Db_Expr",240],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(orders_invoiced)'",240],")",",",["T_WHITESPACE","\n            ",240],["T_CONSTANT_ENCAPSED_STRING","'invoiced'",241],["T_WHITESPACE"," ",241],["T_DOUBLE_ARROW","=>",241],["T_WHITESPACE"," ",241],["T_NEW","new",241],["T_WHITESPACE"," ",241],["T_NS_SEPARATOR","\\",241],["T_STRING","Zend_Db_Expr",241],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(invoiced)'",241],")",",",["T_WHITESPACE","\n            ",241],["T_CONSTANT_ENCAPSED_STRING","'invoiced_captured'",242],["T_WHITESPACE"," ",242],["T_DOUBLE_ARROW","=>",242],["T_WHITESPACE"," ",242],["T_NEW","new",242],["T_WHITESPACE"," ",242],["T_NS_SEPARATOR","\\",242],["T_STRING","Zend_Db_Expr",242],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(invoiced_captured)'",242],")",",",["T_WHITESPACE","\n            ",242],["T_CONSTANT_ENCAPSED_STRING","'invoiced_not_captured'",243],["T_WHITESPACE"," ",243],["T_DOUBLE_ARROW","=>",243],["T_WHITESPACE"," ",243],["T_NEW","new",243],["T_WHITESPACE"," ",243],["T_NS_SEPARATOR","\\",243],["T_STRING","Zend_Db_Expr",243],"(",["T_CONSTANT_ENCAPSED_STRING","'SUM(invoiced_not_captured)'",243],")",",",["T_WHITESPACE","\n        ",243],"]",";",["T_WHITESPACE","\n\n        ",244],["T_VARIABLE","$select",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","from",246],"(",["T_VARIABLE","$table",246],",",["T_WHITESPACE"," ",246],["T_VARIABLE","$columns",246],")",["T_OBJECT_OPERATOR","->",246],["T_STRING","where",246],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id <> ?'",246],",",["T_WHITESPACE"," ",246],["T_NS_SEPARATOR","\\",246],["T_STRING","Magento",246],["T_NS_SEPARATOR","\\",246],["T_STRING","Store",246],["T_NS_SEPARATOR","\\",246],["T_STRING","Model",246],["T_NS_SEPARATOR","\\",246],["T_STRING","Store",246],["T_DOUBLE_COLON","::",246],["T_STRING","DEFAULT_STORE_ID",246],")",";",["T_WHITESPACE","\n\n        ",246],["T_IF","if",248],["T_WHITESPACE"," ",248],"(",["T_VARIABLE","$subSelect",248],["T_WHITESPACE"," ",248],["T_IS_NOT_IDENTICAL","!==",248],["T_WHITESPACE"," ",248],["T_STRING","null",248],")",["T_WHITESPACE"," ",248],"{",["T_WHITESPACE","\n            ",248],["T_VARIABLE","$select",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","where",249],"(",["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","_makeConditionFromDateRangeSelect",249],"(",["T_VARIABLE","$subSelect",249],",",["T_WHITESPACE"," ",249],["T_CONSTANT_ENCAPSED_STRING","'period'",249],")",")",";",["T_WHITESPACE","\n        ",249],"}",["T_WHITESPACE","\n\n        ",250],["T_VARIABLE","$select",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","group",252],"(","[",["T_CONSTANT_ENCAPSED_STRING","'period'",252],",",["T_WHITESPACE"," ",252],["T_CONSTANT_ENCAPSED_STRING","'order_status'",252],"]",")",";",["T_WHITESPACE","\n        ",252],["T_VARIABLE","$insertQuery",253],["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],["T_VARIABLE","$select",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","insertFromSelect",253],"(",["T_VARIABLE","$table",253],",",["T_WHITESPACE"," ",253],["T_STRING","array_keys",253],"(",["T_VARIABLE","$columns",253],")",")",";",["T_WHITESPACE","\n        ",253],["T_VARIABLE","$connection",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","query",254],"(",["T_VARIABLE","$insertQuery",254],")",";",["T_WHITESPACE","\n        ",254],["T_RETURN","return",255],["T_WHITESPACE"," ",255],["T_VARIABLE","$this",255],";",["T_WHITESPACE","\n    ",255],"}",["T_WHITESPACE","\n",256],"}",["T_WHITESPACE","\n",257]]