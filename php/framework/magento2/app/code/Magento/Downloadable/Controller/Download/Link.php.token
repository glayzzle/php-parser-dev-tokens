[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n *\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",6],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Downloadable",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Controller",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Download",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Downloadable",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Helper",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Download",9],["T_WHITESPACE"," ",9],["T_AS","as",9],["T_WHITESPACE"," ",9],["T_STRING","DownloadHelper",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Downloadable",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Model",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Link",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Purchased",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Item",10],["T_WHITESPACE"," ",10],["T_AS","as",10],["T_WHITESPACE"," ",10],["T_STRING","PurchasedLink",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Framework",11],["T_NS_SEPARATOR","\\",11],["T_STRING","App",11],["T_NS_SEPARATOR","\\",11],["T_STRING","ResponseInterface",11],";",["T_WHITESPACE","\n\n",11],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","Link",13],["T_WHITESPACE"," ",13],["T_EXTENDS","extends",13],["T_WHITESPACE"," ",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Downloadable",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Controller",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Download",13],["T_WHITESPACE","\n",13],"{",["T_WHITESPACE","\n    ",14],["T_DOC_COMMENT","\/**\n     * Return customer session object\n     *\n     * @return \\Magento\\Customer\\Model\\Session\n     *\/",15],["T_WHITESPACE","\n    ",19],["T_PROTECTED","protected",20],["T_WHITESPACE"," ",20],["T_FUNCTION","function",20],["T_WHITESPACE"," ",20],["T_STRING","_getCustomerSession",20],"(",")",["T_WHITESPACE","\n    ",20],"{",["T_WHITESPACE","\n        ",21],["T_RETURN","return",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$this",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","_objectManager",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","get",22],"(",["T_NS_SEPARATOR","\\",22],["T_STRING","Magento",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Customer",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Model",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Session",22],["T_DOUBLE_COLON","::",22],["T_CLASS","class",22],")",";",["T_WHITESPACE","\n    ",22],"}",["T_WHITESPACE","\n\n    ",23],["T_DOC_COMMENT","\/**\n     * Download link action\n     *\n     * @return void|ResponseInterface\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     * @SuppressWarnings(PHPMD.NPathComplexity)\n     * @SuppressWarnings(PHPMD.ExcessiveMethodLength)\n     * @SuppressWarnings(PHPMD.ExitExpression)\n     *\/",25],["T_WHITESPACE","\n    ",33],["T_PUBLIC","public",34],["T_WHITESPACE"," ",34],["T_FUNCTION","function",34],["T_WHITESPACE"," ",34],["T_STRING","execute",34],"(",")",["T_WHITESPACE","\n    ",34],"{",["T_WHITESPACE","\n        ",35],["T_VARIABLE","$session",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","_getCustomerSession",36],"(",")",";",["T_WHITESPACE","\n\n        ",36],["T_VARIABLE","$id",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","getRequest",38],"(",")",["T_OBJECT_OPERATOR","->",38],["T_STRING","getParam",38],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",38],",",["T_WHITESPACE"," ",38],["T_LNUMBER","0",38],")",";",["T_WHITESPACE","\n        ",38],["T_DOC_COMMENT","\/** @var PurchasedLink $linkPurchasedItem *\/",39],["T_WHITESPACE","\n        ",39],["T_VARIABLE","$linkPurchasedItem",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","_objectManager",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","create",40],"(",["T_WHITESPACE","\n            ",40],["T_NS_SEPARATOR","\\",41],["T_STRING","Magento",41],["T_NS_SEPARATOR","\\",41],["T_STRING","Downloadable",41],["T_NS_SEPARATOR","\\",41],["T_STRING","Model",41],["T_NS_SEPARATOR","\\",41],["T_STRING","Link",41],["T_NS_SEPARATOR","\\",41],["T_STRING","Purchased",41],["T_NS_SEPARATOR","\\",41],["T_STRING","Item",41],["T_DOUBLE_COLON","::",41],["T_CLASS","class",41],["T_WHITESPACE","\n        ",41],")",["T_OBJECT_OPERATOR","->",42],["T_STRING","load",42],"(",["T_WHITESPACE","\n            ",42],["T_VARIABLE","$id",43],",",["T_WHITESPACE","\n            ",43],["T_CONSTANT_ENCAPSED_STRING","'link_hash'",44],["T_WHITESPACE","\n        ",44],")",";",["T_WHITESPACE","\n        ",45],["T_IF","if",46],["T_WHITESPACE"," ",46],"(","!",["T_VARIABLE","$linkPurchasedItem",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","getId",46],"(",")",")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n            ",46],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","messageManager",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","addNotice",47],"(",["T_STRING","__",47],"(",["T_CONSTANT_ENCAPSED_STRING","\"We can't find the link you requested.\"",47],")",")",";",["T_WHITESPACE","\n            ",47],["T_RETURN","return",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","_redirect",48],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/customer\/products'",48],")",";",["T_WHITESPACE","\n        ",48],"}",["T_WHITESPACE","\n        ",49],["T_IF","if",50],["T_WHITESPACE"," ",50],"(","!",["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","_objectManager",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","get",50],"(",["T_NS_SEPARATOR","\\",50],["T_STRING","Magento",50],["T_NS_SEPARATOR","\\",50],["T_STRING","Downloadable",50],["T_NS_SEPARATOR","\\",50],["T_STRING","Helper",50],["T_NS_SEPARATOR","\\",50],["T_STRING","Data",50],["T_DOUBLE_COLON","::",50],["T_CLASS","class",50],")",["T_OBJECT_OPERATOR","->",50],["T_STRING","getIsShareable",50],"(",["T_VARIABLE","$linkPurchasedItem",50],")",")",["T_WHITESPACE"," ",50],"{",["T_WHITESPACE","\n            ",50],["T_VARIABLE","$customerId",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$session",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","getCustomerId",51],"(",")",";",["T_WHITESPACE","\n            ",51],["T_IF","if",52],["T_WHITESPACE"," ",52],"(","!",["T_VARIABLE","$customerId",52],")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n                ",52],["T_DOC_COMMENT","\/** @var \\Magento\\Catalog\\Model\\Product $product *\/",53],["T_WHITESPACE","\n                ",53],["T_VARIABLE","$product",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","_objectManager",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","create",54],"(",["T_WHITESPACE","\n                    ",54],["T_NS_SEPARATOR","\\",55],["T_STRING","Magento",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Catalog",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Model",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Product",55],["T_DOUBLE_COLON","::",55],["T_CLASS","class",55],["T_WHITESPACE","\n                ",55],")",["T_OBJECT_OPERATOR","->",56],["T_STRING","load",56],"(",["T_WHITESPACE","\n                    ",56],["T_VARIABLE","$linkPurchasedItem",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","getProductId",57],"(",")",["T_WHITESPACE","\n                ",57],")",";",["T_WHITESPACE","\n                ",58],["T_IF","if",59],["T_WHITESPACE"," ",59],"(",["T_VARIABLE","$product",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","getId",59],"(",")",")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n                    ",59],["T_VARIABLE","$notice",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_STRING","__",60],"(",["T_WHITESPACE","\n                        ",60],["T_CONSTANT_ENCAPSED_STRING","'Please sign in to download your product or purchase <a href=\"%1\">%2<\/a>.'",61],",",["T_WHITESPACE","\n                        ",61],["T_VARIABLE","$product",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","getProductUrl",62],"(",")",",",["T_WHITESPACE","\n                        ",62],["T_VARIABLE","$product",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","getName",63],"(",")",["T_WHITESPACE","\n                    ",63],")",";",["T_WHITESPACE","\n                ",64],"}",["T_WHITESPACE"," ",65],["T_ELSE","else",65],["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n                    ",65],["T_VARIABLE","$notice",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_STRING","__",66],"(",["T_CONSTANT_ENCAPSED_STRING","'Please sign in to download your product.'",66],")",";",["T_WHITESPACE","\n                ",66],"}",["T_WHITESPACE","\n                ",67],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","messageManager",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","addNotice",68],"(",["T_VARIABLE","$notice",68],")",";",["T_WHITESPACE","\n                ",68],["T_VARIABLE","$session",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","authenticate",69],"(",")",";",["T_WHITESPACE","\n                ",69],["T_VARIABLE","$session",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","setBeforeAuthUrl",70],"(",["T_WHITESPACE","\n                    ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","_objectManager",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","create",71],"(",["T_WHITESPACE","\n                        ",71],["T_NS_SEPARATOR","\\",72],["T_STRING","Magento",72],["T_NS_SEPARATOR","\\",72],["T_STRING","Framework",72],["T_NS_SEPARATOR","\\",72],["T_STRING","UrlInterface",72],["T_DOUBLE_COLON","::",72],["T_CLASS","class",72],["T_WHITESPACE","\n                    ",72],")",["T_OBJECT_OPERATOR","->",73],["T_STRING","getUrl",73],"(",["T_WHITESPACE","\n                        ",73],["T_CONSTANT_ENCAPSED_STRING","'downloadable\/customer\/products\/'",74],",",["T_WHITESPACE","\n                        ",74],"[",["T_CONSTANT_ENCAPSED_STRING","'_secure'",75],["T_WHITESPACE"," ",75],["T_DOUBLE_ARROW","=>",75],["T_WHITESPACE"," ",75],["T_STRING","true",75],"]",["T_WHITESPACE","\n                    ",75],")",["T_WHITESPACE","\n                ",76],")",";",["T_WHITESPACE","\n                ",77],["T_RETURN","return",78],";",["T_WHITESPACE","\n            ",78],"}",["T_WHITESPACE","\n            ",79],["T_DOC_COMMENT","\/** @var \\Magento\\Downloadable\\Model\\Link\\Purchased $linkPurchased *\/",80],["T_WHITESPACE","\n            ",80],["T_VARIABLE","$linkPurchased",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","_objectManager",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","create",81],"(",["T_WHITESPACE","\n                ",81],["T_NS_SEPARATOR","\\",82],["T_STRING","Magento",82],["T_NS_SEPARATOR","\\",82],["T_STRING","Downloadable",82],["T_NS_SEPARATOR","\\",82],["T_STRING","Model",82],["T_NS_SEPARATOR","\\",82],["T_STRING","Link",82],["T_NS_SEPARATOR","\\",82],["T_STRING","Purchased",82],["T_DOUBLE_COLON","::",82],["T_CLASS","class",82],["T_WHITESPACE","\n            ",82],")",["T_OBJECT_OPERATOR","->",83],["T_STRING","load",83],"(",["T_WHITESPACE","\n                ",83],["T_VARIABLE","$linkPurchasedItem",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getPurchasedId",84],"(",")",["T_WHITESPACE","\n            ",84],")",";",["T_WHITESPACE","\n            ",85],["T_IF","if",86],["T_WHITESPACE"," ",86],"(",["T_VARIABLE","$linkPurchased",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getCustomerId",86],"(",")",["T_WHITESPACE"," ",86],["T_IS_NOT_EQUAL","!=",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$customerId",86],")",["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n                ",86],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","messageManager",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","addNotice",87],"(",["T_STRING","__",87],"(",["T_CONSTANT_ENCAPSED_STRING","\"We can't find the link you requested.\"",87],")",")",";",["T_WHITESPACE","\n                ",87],["T_RETURN","return",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","_redirect",88],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/customer\/products'",88],")",";",["T_WHITESPACE","\n            ",88],"}",["T_WHITESPACE","\n        ",89],"}",["T_WHITESPACE","\n        ",90],["T_VARIABLE","$downloadsLeft",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_VARIABLE","$linkPurchasedItem",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getNumberOfDownloadsBought",91],"(",")",["T_WHITESPACE"," ",91],"-",["T_WHITESPACE","\n            ",91],["T_VARIABLE","$linkPurchasedItem",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getNumberOfDownloadsUsed",92],"(",")",";",["T_WHITESPACE","\n\n        ",92],["T_VARIABLE","$status",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_VARIABLE","$linkPurchasedItem",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getStatus",94],"(",")",";",["T_WHITESPACE","\n        ",94],["T_IF","if",95],["T_WHITESPACE"," ",95],"(",["T_VARIABLE","$status",95],["T_WHITESPACE"," ",95],["T_IS_EQUAL","==",95],["T_WHITESPACE"," ",95],["T_STRING","PurchasedLink",95],["T_DOUBLE_COLON","::",95],["T_STRING","LINK_STATUS_AVAILABLE",95],["T_WHITESPACE"," ",95],["T_BOOLEAN_AND","&&",95],["T_WHITESPACE"," ",95],"(",["T_VARIABLE","$downloadsLeft",95],["T_WHITESPACE"," ",95],["T_BOOLEAN_OR","||",95],["T_WHITESPACE","\n            ",95],["T_VARIABLE","$linkPurchasedItem",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getNumberOfDownloadsBought",96],"(",")",["T_WHITESPACE"," ",96],["T_IS_EQUAL","==",96],["T_WHITESPACE"," ",96],["T_LNUMBER","0",96],")",["T_WHITESPACE","\n        ",96],")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n            ",97],["T_VARIABLE","$resource",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_CONSTANT_ENCAPSED_STRING","''",98],";",["T_WHITESPACE","\n            ",98],["T_VARIABLE","$resourceType",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","''",99],";",["T_WHITESPACE","\n            ",99],["T_IF","if",100],["T_WHITESPACE"," ",100],"(",["T_VARIABLE","$linkPurchasedItem",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getLinkType",100],"(",")",["T_WHITESPACE"," ",100],["T_IS_EQUAL","==",100],["T_WHITESPACE"," ",100],["T_STRING","DownloadHelper",100],["T_DOUBLE_COLON","::",100],["T_STRING","LINK_TYPE_URL",100],")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n                ",100],["T_VARIABLE","$resource",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$linkPurchasedItem",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getLinkUrl",101],"(",")",";",["T_WHITESPACE","\n                ",101],["T_VARIABLE","$resourceType",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_STRING","DownloadHelper",102],["T_DOUBLE_COLON","::",102],["T_STRING","LINK_TYPE_URL",102],";",["T_WHITESPACE","\n            ",102],"}",["T_WHITESPACE"," ",103],["T_ELSEIF","elseif",103],["T_WHITESPACE"," ",103],"(",["T_VARIABLE","$linkPurchasedItem",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getLinkType",103],"(",")",["T_WHITESPACE"," ",103],["T_IS_EQUAL","==",103],["T_WHITESPACE"," ",103],["T_STRING","DownloadHelper",103],["T_DOUBLE_COLON","::",103],["T_STRING","LINK_TYPE_FILE",103],")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n                ",103],["T_VARIABLE","$resource",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","_objectManager",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","get",104],"(",["T_WHITESPACE","\n                    ",104],["T_NS_SEPARATOR","\\",105],["T_STRING","Magento",105],["T_NS_SEPARATOR","\\",105],["T_STRING","Downloadable",105],["T_NS_SEPARATOR","\\",105],["T_STRING","Helper",105],["T_NS_SEPARATOR","\\",105],["T_STRING","File",105],["T_DOUBLE_COLON","::",105],["T_CLASS","class",105],["T_WHITESPACE","\n                ",105],")",["T_OBJECT_OPERATOR","->",106],["T_STRING","getFilePath",106],"(",["T_WHITESPACE","\n                    ",106],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","_getLink",107],"(",")",["T_OBJECT_OPERATOR","->",107],["T_STRING","getBasePath",107],"(",")",",",["T_WHITESPACE","\n                    ",107],["T_VARIABLE","$linkPurchasedItem",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getLinkFile",108],"(",")",["T_WHITESPACE","\n                ",108],")",";",["T_WHITESPACE","\n                ",109],["T_VARIABLE","$resourceType",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_STRING","DownloadHelper",110],["T_DOUBLE_COLON","::",110],["T_STRING","LINK_TYPE_FILE",110],";",["T_WHITESPACE","\n            ",110],"}",["T_WHITESPACE","\n            ",111],["T_TRY","try",112],["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n                ",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","_processDownload",113],"(",["T_VARIABLE","$resource",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$resourceType",113],")",";",["T_WHITESPACE","\n                ",113],["T_VARIABLE","$linkPurchasedItem",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","setNumberOfDownloadsUsed",114],"(",["T_VARIABLE","$linkPurchasedItem",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","getNumberOfDownloadsUsed",114],"(",")",["T_WHITESPACE"," ",114],"+",["T_WHITESPACE"," ",114],["T_LNUMBER","1",114],")",";",["T_WHITESPACE","\n\n                ",114],["T_IF","if",116],["T_WHITESPACE"," ",116],"(",["T_VARIABLE","$linkPurchasedItem",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getNumberOfDownloadsBought",116],"(",")",["T_WHITESPACE"," ",116],["T_IS_NOT_EQUAL","!=",116],["T_WHITESPACE"," ",116],["T_LNUMBER","0",116],["T_WHITESPACE"," ",116],["T_BOOLEAN_AND","&&",116],["T_WHITESPACE"," ",116],"!","(",["T_VARIABLE","$downloadsLeft",116],["T_WHITESPACE"," ",116],"-",["T_WHITESPACE"," ",116],["T_LNUMBER","1",116],")",")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n                    ",116],["T_VARIABLE","$linkPurchasedItem",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","setStatus",117],"(",["T_STRING","PurchasedLink",117],["T_DOUBLE_COLON","::",117],["T_STRING","LINK_STATUS_EXPIRED",117],")",";",["T_WHITESPACE","\n                ",117],"}",["T_WHITESPACE","\n                ",118],["T_VARIABLE","$linkPurchasedItem",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","save",119],"(",")",";",["T_WHITESPACE","\n                ",119],["T_EXIT","exit",120],"(",["T_LNUMBER","0",120],")",";",["T_WHITESPACE","\n            ",120],"}",["T_WHITESPACE"," ",121],["T_CATCH","catch",121],["T_WHITESPACE"," ",121],"(",["T_NS_SEPARATOR","\\",121],["T_STRING","Exception",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$e",121],")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n                ",121],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","messageManager",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","addError",122],"(",["T_STRING","__",122],"(",["T_CONSTANT_ENCAPSED_STRING","'Something went wrong while getting the requested content.'",122],")",")",";",["T_WHITESPACE","\n            ",122],"}",["T_WHITESPACE","\n        ",123],"}",["T_WHITESPACE"," ",124],["T_ELSEIF","elseif",124],["T_WHITESPACE"," ",124],"(",["T_VARIABLE","$status",124],["T_WHITESPACE"," ",124],["T_IS_EQUAL","==",124],["T_WHITESPACE"," ",124],["T_STRING","PurchasedLink",124],["T_DOUBLE_COLON","::",124],["T_STRING","LINK_STATUS_EXPIRED",124],")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n            ",124],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","messageManager",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","addNotice",125],"(",["T_STRING","__",125],"(",["T_CONSTANT_ENCAPSED_STRING","'The link has expired.'",125],")",")",";",["T_WHITESPACE","\n        ",125],"}",["T_WHITESPACE"," ",126],["T_ELSEIF","elseif",126],["T_WHITESPACE"," ",126],"(",["T_VARIABLE","$status",126],["T_WHITESPACE"," ",126],["T_IS_EQUAL","==",126],["T_WHITESPACE"," ",126],["T_STRING","PurchasedLink",126],["T_DOUBLE_COLON","::",126],["T_STRING","LINK_STATUS_PENDING",126],["T_WHITESPACE"," ",126],["T_BOOLEAN_OR","||",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$status",126],["T_WHITESPACE"," ",126],["T_IS_EQUAL","==",126],["T_WHITESPACE"," ",126],["T_STRING","PurchasedLink",126],["T_DOUBLE_COLON","::",126],["T_STRING","LINK_STATUS_PAYMENT_REVIEW",126],["T_WHITESPACE","\n        ",126],")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n            ",127],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","messageManager",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","addNotice",128],"(",["T_STRING","__",128],"(",["T_CONSTANT_ENCAPSED_STRING","'The link is not available.'",128],")",")",";",["T_WHITESPACE","\n        ",128],"}",["T_WHITESPACE"," ",129],["T_ELSE","else",129],["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n            ",129],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","messageManager",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","addError",130],"(",["T_STRING","__",130],"(",["T_CONSTANT_ENCAPSED_STRING","'Something went wrong while getting the requested content.'",130],")",")",";",["T_WHITESPACE","\n        ",130],"}",["T_WHITESPACE","\n        ",131],["T_RETURN","return",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","_redirect",132],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/customer\/products'",132],")",";",["T_WHITESPACE","\n    ",132],"}",["T_WHITESPACE","\n",133],"}",["T_WHITESPACE","\n",134]]