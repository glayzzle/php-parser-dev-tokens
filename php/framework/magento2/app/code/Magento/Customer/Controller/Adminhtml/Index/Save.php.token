[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Customer",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Controller",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Adminhtml",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Index",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Customer",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Api",8],["T_NS_SEPARATOR","\\",8],["T_STRING","AddressMetadataInterface",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Customer",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Api",9],["T_NS_SEPARATOR","\\",9],["T_STRING","CustomerMetadataInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Customer",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Api",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Data",10],["T_NS_SEPARATOR","\\",10],["T_STRING","CustomerInterface",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Customer",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Controller",11],["T_NS_SEPARATOR","\\",11],["T_STRING","RegistryConstants",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Customer",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Model",12],["T_NS_SEPARATOR","\\",12],["T_STRING","EmailNotificationInterface",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Customer",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Model",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Metadata",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Form",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Framework",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Exception",14],["T_NS_SEPARATOR","\\",14],["T_STRING","LocalizedException",14],";",["T_WHITESPACE","\n\n",14],["T_CLASS","class",16],["T_WHITESPACE"," ",16],["T_STRING","Save",16],["T_WHITESPACE"," ",16],["T_EXTENDS","extends",16],["T_WHITESPACE"," ",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Magento",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Customer",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Controller",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Adminhtml",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Index",16],["T_WHITESPACE","\n",16],"{",["T_WHITESPACE","\n    ",17],["T_DOC_COMMENT","\/**\n     * @var EmailNotificationInterface\n     *\/",18],["T_WHITESPACE","\n    ",20],["T_PRIVATE","private",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$emailNotification",21],";",["T_WHITESPACE","\n\n    ",21],["T_DOC_COMMENT","\/**\n     * Reformat customer account data to be compatible with customer service interface\n     *\n     * @return array\n     *\/",23],["T_WHITESPACE","\n    ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_FUNCTION","function",28],["T_WHITESPACE"," ",28],["T_STRING","_extractCustomerData",28],"(",")",["T_WHITESPACE","\n    ",28],"{",["T_WHITESPACE","\n        ",29],["T_VARIABLE","$customerData",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],"[","]",";",["T_WHITESPACE","\n        ",30],["T_IF","if",31],["T_WHITESPACE"," ",31],"(",["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","getRequest",31],"(",")",["T_OBJECT_OPERATOR","->",31],["T_STRING","getPost",31],"(",["T_CONSTANT_ENCAPSED_STRING","'customer'",31],")",")",["T_WHITESPACE"," ",31],"{",["T_WHITESPACE","\n            ",31],["T_VARIABLE","$additionalAttributes",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],"[",["T_WHITESPACE","\n                ",32],["T_STRING","CustomerInterface",33],["T_DOUBLE_COLON","::",33],["T_STRING","DEFAULT_BILLING",33],",",["T_WHITESPACE","\n                ",33],["T_STRING","CustomerInterface",34],["T_DOUBLE_COLON","::",34],["T_STRING","DEFAULT_SHIPPING",34],",",["T_WHITESPACE","\n                ",34],["T_CONSTANT_ENCAPSED_STRING","'confirmation'",35],",",["T_WHITESPACE","\n                ",35],["T_CONSTANT_ENCAPSED_STRING","'sendemail_store_id'",36],",",["T_WHITESPACE","\n                ",36],["T_CONSTANT_ENCAPSED_STRING","'extension_attributes'",37],",",["T_WHITESPACE","\n            ",37],"]",";",["T_WHITESPACE","\n\n            ",38],["T_VARIABLE","$customerData",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","_extractData",40],"(",["T_WHITESPACE","\n                ",40],["T_CONSTANT_ENCAPSED_STRING","'adminhtml_customer'",41],",",["T_WHITESPACE","\n                ",41],["T_STRING","CustomerMetadataInterface",42],["T_DOUBLE_COLON","::",42],["T_STRING","ENTITY_TYPE_CUSTOMER",42],",",["T_WHITESPACE","\n                ",42],["T_VARIABLE","$additionalAttributes",43],",",["T_WHITESPACE","\n                ",43],["T_CONSTANT_ENCAPSED_STRING","'customer'",44],["T_WHITESPACE","\n            ",44],")",";",["T_WHITESPACE","\n        ",45],"}",["T_WHITESPACE","\n\n        ",46],["T_IF","if",48],["T_WHITESPACE"," ",48],"(",["T_ISSET","isset",48],"(",["T_VARIABLE","$customerData",48],"[",["T_CONSTANT_ENCAPSED_STRING","'disable_auto_group_change'",48],"]",")",")",["T_WHITESPACE"," ",48],"{",["T_WHITESPACE","\n            ",48],["T_VARIABLE","$customerData",49],"[",["T_CONSTANT_ENCAPSED_STRING","'disable_auto_group_change'",49],"]",["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_INT_CAST","(int)",49],["T_WHITESPACE"," ",49],["T_STRING","filter_var",49],"(",["T_WHITESPACE","\n                ",49],["T_VARIABLE","$customerData",50],"[",["T_CONSTANT_ENCAPSED_STRING","'disable_auto_group_change'",50],"]",",",["T_WHITESPACE","\n                ",50],["T_STRING","FILTER_VALIDATE_BOOLEAN",51],["T_WHITESPACE","\n            ",51],")",";",["T_WHITESPACE","\n        ",52],"}",["T_WHITESPACE","\n\n        ",53],["T_RETURN","return",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$customerData",55],";",["T_WHITESPACE","\n    ",55],"}",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * Perform customer data filtration based on form code and form object\n     *\n     * @param string $formCode The code of EAV form to take the list of attributes from\n     * @param string $entityType entity type for the form\n     * @param string[] $additionalAttributes The list of attribute codes to skip filtration for\n     * @param string $scope scope of the request\n     * @return array\n     *\/",58],["T_WHITESPACE","\n    ",66],["T_PROTECTED","protected",67],["T_WHITESPACE"," ",67],["T_FUNCTION","function",67],["T_WHITESPACE"," ",67],["T_STRING","_extractData",67],"(",["T_WHITESPACE","\n        ",67],["T_VARIABLE","$formCode",68],",",["T_WHITESPACE","\n        ",68],["T_VARIABLE","$entityType",69],",",["T_WHITESPACE","\n        ",69],["T_VARIABLE","$additionalAttributes",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],"[","]",",",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$scope",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_STRING","null",71],["T_WHITESPACE","\n    ",71],")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$metadataForm",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","getMetadataForm",73],"(",["T_VARIABLE","$entityType",73],",",["T_WHITESPACE"," ",73],["T_VARIABLE","$formCode",73],",",["T_WHITESPACE"," ",73],["T_VARIABLE","$scope",73],")",";",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$formData",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$metadataForm",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","extractData",74],"(",["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","getRequest",74],"(",")",",",["T_WHITESPACE"," ",74],["T_VARIABLE","$scope",74],")",";",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$formData",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$metadataForm",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","compactData",75],"(",["T_VARIABLE","$formData",75],")",";",["T_WHITESPACE","\n\n        ",75],["T_COMMENT","\/\/ Initialize additional attributes\n",77],["T_WHITESPACE","        ",78],["T_DOC_COMMENT","\/** @var \\Magento\\Framework\\DataObject $object *\/",78],["T_WHITESPACE","\n        ",78],["T_VARIABLE","$object",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","_objectFactory",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","create",79],"(","[",["T_CONSTANT_ENCAPSED_STRING","'data'",79],["T_WHITESPACE"," ",79],["T_DOUBLE_ARROW","=>",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","getRequest",79],"(",")",["T_OBJECT_OPERATOR","->",79],["T_STRING","getPostValue",79],"(",")","]",")",";",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$requestData",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$object",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getData",80],"(",["T_VARIABLE","$scope",80],")",";",["T_WHITESPACE","\n        ",80],["T_FOREACH","foreach",81],["T_WHITESPACE"," ",81],"(",["T_VARIABLE","$additionalAttributes",81],["T_WHITESPACE"," ",81],["T_AS","as",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$attributeCode",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n            ",81],["T_VARIABLE","$formData",82],"[",["T_VARIABLE","$attributeCode",82],"]",["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_ISSET","isset",82],"(",["T_VARIABLE","$requestData",82],"[",["T_VARIABLE","$attributeCode",82],"]",")",["T_WHITESPACE"," ",82],"?",["T_WHITESPACE"," ",82],["T_VARIABLE","$requestData",82],"[",["T_VARIABLE","$attributeCode",82],"]",["T_WHITESPACE"," ",82],":",["T_WHITESPACE"," ",82],["T_STRING","false",82],";",["T_WHITESPACE","\n        ",82],"}",["T_WHITESPACE","\n\n        ",83],["T_COMMENT","\/\/ Unset unused attributes\n",85],["T_WHITESPACE","        ",86],["T_VARIABLE","$formAttributes",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$metadataForm",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getAttributes",86],"(",")",";",["T_WHITESPACE","\n        ",86],["T_FOREACH","foreach",87],["T_WHITESPACE"," ",87],"(",["T_VARIABLE","$formAttributes",87],["T_WHITESPACE"," ",87],["T_AS","as",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$attribute",87],")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n            ",87],["T_DOC_COMMENT","\/** @var \\Magento\\Customer\\Api\\Data\\AttributeMetadataInterface $attribute *\/",88],["T_WHITESPACE","\n            ",88],["T_VARIABLE","$attributeCode",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$attribute",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getAttributeCode",89],"(",")",";",["T_WHITESPACE","\n            ",89],["T_IF","if",90],["T_WHITESPACE"," ",90],"(",["T_VARIABLE","$attribute",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","getFrontendInput",90],"(",")",["T_WHITESPACE"," ",90],["T_IS_NOT_EQUAL","!=",90],["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'boolean'",90],["T_WHITESPACE","\n                ",90],["T_BOOLEAN_AND","&&",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$formData",91],"[",["T_VARIABLE","$attributeCode",91],"]",["T_WHITESPACE"," ",91],["T_IS_IDENTICAL","===",91],["T_WHITESPACE"," ",91],["T_STRING","false",91],["T_WHITESPACE","\n            ",91],")",["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n                ",92],["T_UNSET","unset",93],"(",["T_VARIABLE","$formData",93],"[",["T_VARIABLE","$attributeCode",93],"]",")",";",["T_WHITESPACE","\n            ",93],"}",["T_WHITESPACE","\n        ",94],"}",["T_WHITESPACE","\n\n        ",95],["T_IF","if",97],["T_WHITESPACE"," ",97],"(",["T_EMPTY","empty",97],"(",["T_VARIABLE","$formData",97],"[",["T_CONSTANT_ENCAPSED_STRING","'extension_attributes'",97],"]",")",")",["T_WHITESPACE"," ",97],"{",["T_WHITESPACE","\n            ",97],["T_UNSET","unset",98],"(",["T_VARIABLE","$formData",98],"[",["T_CONSTANT_ENCAPSED_STRING","'extension_attributes'",98],"]",")",";",["T_WHITESPACE","\n        ",98],"}",["T_WHITESPACE","\n\n        ",99],["T_RETURN","return",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$formData",101],";",["T_WHITESPACE","\n    ",101],"}",["T_WHITESPACE","\n\n    ",102],["T_DOC_COMMENT","\/**\n     * Saves default_billing and default_shipping flags for customer address\n     *\n     * @param array $addressIdList\n     * @param array $extractedCustomerData\n     * @return array\n     *\/",104],["T_WHITESPACE","\n    ",110],["T_PROTECTED","protected",111],["T_WHITESPACE"," ",111],["T_FUNCTION","function",111],["T_WHITESPACE"," ",111],["T_STRING","saveDefaultFlags",111],"(",["T_ARRAY","array",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$addressIdList",111],",",["T_WHITESPACE"," ",111],["T_ARRAY","array",111],["T_WHITESPACE"," ",111],"&",["T_WHITESPACE"," ",111],["T_VARIABLE","$extractedCustomerData",111],")",["T_WHITESPACE","\n    ",111],"{",["T_WHITESPACE","\n        ",112],["T_VARIABLE","$result",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],"[","]",";",["T_WHITESPACE","\n        ",113],["T_VARIABLE","$extractedCustomerData",114],"[",["T_STRING","CustomerInterface",114],["T_DOUBLE_COLON","::",114],["T_STRING","DEFAULT_BILLING",114],"]",["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_STRING","null",114],";",["T_WHITESPACE","\n        ",114],["T_VARIABLE","$extractedCustomerData",115],"[",["T_STRING","CustomerInterface",115],["T_DOUBLE_COLON","::",115],["T_STRING","DEFAULT_SHIPPING",115],"]",["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_STRING","null",115],";",["T_WHITESPACE","\n        ",115],["T_FOREACH","foreach",116],["T_WHITESPACE"," ",116],"(",["T_VARIABLE","$addressIdList",116],["T_WHITESPACE"," ",116],["T_AS","as",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$addressId",116],")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n            ",116],["T_VARIABLE","$scope",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_STRING","sprintf",117],"(",["T_CONSTANT_ENCAPSED_STRING","'address\/%s'",117],",",["T_WHITESPACE"," ",117],["T_VARIABLE","$addressId",117],")",";",["T_WHITESPACE","\n            ",117],["T_VARIABLE","$addressData",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","_extractData",118],"(",["T_WHITESPACE","\n                ",118],["T_CONSTANT_ENCAPSED_STRING","'adminhtml_customer_address'",119],",",["T_WHITESPACE","\n                ",119],["T_STRING","AddressMetadataInterface",120],["T_DOUBLE_COLON","::",120],["T_STRING","ENTITY_TYPE_ADDRESS",120],",",["T_WHITESPACE","\n                ",120],"[",["T_CONSTANT_ENCAPSED_STRING","'default_billing'",121],",",["T_WHITESPACE"," ",121],["T_CONSTANT_ENCAPSED_STRING","'default_shipping'",121],"]",",",["T_WHITESPACE","\n                ",121],["T_VARIABLE","$scope",122],["T_WHITESPACE","\n            ",122],")",";",["T_WHITESPACE","\n\n            ",123],["T_IF","if",125],["T_WHITESPACE"," ",125],"(",["T_STRING","is_numeric",125],"(",["T_VARIABLE","$addressId",125],")",")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n                ",125],["T_VARIABLE","$addressData",126],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",126],"]",["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$addressId",126],";",["T_WHITESPACE","\n            ",126],"}",["T_WHITESPACE","\n            ",127],["T_COMMENT","\/\/ Set default billing and shipping flags to customer\n",128],["T_WHITESPACE","            ",129],["T_IF","if",129],["T_WHITESPACE"," ",129],"(","!",["T_EMPTY","empty",129],"(",["T_VARIABLE","$addressData",129],"[",["T_CONSTANT_ENCAPSED_STRING","'default_billing'",129],"]",")",["T_WHITESPACE"," ",129],["T_BOOLEAN_AND","&&",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$addressData",129],"[",["T_CONSTANT_ENCAPSED_STRING","'default_billing'",129],"]",["T_WHITESPACE"," ",129],["T_IS_IDENTICAL","===",129],["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","'true'",129],")",["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n                ",129],["T_VARIABLE","$extractedCustomerData",130],"[",["T_STRING","CustomerInterface",130],["T_DOUBLE_COLON","::",130],["T_STRING","DEFAULT_BILLING",130],"]",["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$addressId",130],";",["T_WHITESPACE","\n                ",130],["T_VARIABLE","$addressData",131],"[",["T_CONSTANT_ENCAPSED_STRING","'default_billing'",131],"]",["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_STRING","true",131],";",["T_WHITESPACE","\n            ",131],"}",["T_WHITESPACE"," ",132],["T_ELSE","else",132],["T_WHITESPACE"," ",132],"{",["T_WHITESPACE","\n                ",132],["T_VARIABLE","$addressData",133],"[",["T_CONSTANT_ENCAPSED_STRING","'default_billing'",133],"]",["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_STRING","false",133],";",["T_WHITESPACE","\n            ",133],"}",["T_WHITESPACE","\n            ",134],["T_IF","if",135],["T_WHITESPACE"," ",135],"(","!",["T_EMPTY","empty",135],"(",["T_VARIABLE","$addressData",135],"[",["T_CONSTANT_ENCAPSED_STRING","'default_shipping'",135],"]",")",["T_WHITESPACE"," ",135],["T_BOOLEAN_AND","&&",135],["T_WHITESPACE"," ",135],["T_VARIABLE","$addressData",135],"[",["T_CONSTANT_ENCAPSED_STRING","'default_shipping'",135],"]",["T_WHITESPACE"," ",135],["T_IS_IDENTICAL","===",135],["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","'true'",135],")",["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n                ",135],["T_VARIABLE","$extractedCustomerData",136],"[",["T_STRING","CustomerInterface",136],["T_DOUBLE_COLON","::",136],["T_STRING","DEFAULT_SHIPPING",136],"]",["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_VARIABLE","$addressId",136],";",["T_WHITESPACE","\n                ",136],["T_VARIABLE","$addressData",137],"[",["T_CONSTANT_ENCAPSED_STRING","'default_shipping'",137],"]",["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_STRING","true",137],";",["T_WHITESPACE","\n            ",137],"}",["T_WHITESPACE"," ",138],["T_ELSE","else",138],["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n                ",138],["T_VARIABLE","$addressData",139],"[",["T_CONSTANT_ENCAPSED_STRING","'default_shipping'",139],"]",["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_STRING","false",139],";",["T_WHITESPACE","\n            ",139],"}",["T_WHITESPACE","\n            ",140],["T_VARIABLE","$result",141],"[","]",["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_VARIABLE","$addressData",141],";",["T_WHITESPACE","\n        ",141],"}",["T_WHITESPACE","\n        ",142],["T_RETURN","return",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$result",143],";",["T_WHITESPACE","\n    ",143],"}",["T_WHITESPACE","\n\n    ",144],["T_DOC_COMMENT","\/**\n     * Reformat customer addresses data to be compatible with customer service interface\n     *\n     * @param array $extractedCustomerData\n     * @return array\n     *\/",146],["T_WHITESPACE","\n    ",151],["T_PROTECTED","protected",152],["T_WHITESPACE"," ",152],["T_FUNCTION","function",152],["T_WHITESPACE"," ",152],["T_STRING","_extractCustomerAddressData",152],"(",["T_ARRAY","array",152],["T_WHITESPACE"," ",152],"&",["T_WHITESPACE"," ",152],["T_VARIABLE","$extractedCustomerData",152],")",["T_WHITESPACE","\n    ",152],"{",["T_WHITESPACE","\n        ",153],["T_VARIABLE","$addresses",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","getRequest",154],"(",")",["T_OBJECT_OPERATOR","->",154],["T_STRING","getPost",154],"(",["T_CONSTANT_ENCAPSED_STRING","'address'",154],")",";",["T_WHITESPACE","\n        ",154],["T_VARIABLE","$result",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],"[","]",";",["T_WHITESPACE","\n        ",155],["T_IF","if",156],["T_WHITESPACE"," ",156],"(",["T_STRING","is_array",156],"(",["T_VARIABLE","$addresses",156],")",")",["T_WHITESPACE"," ",156],"{",["T_WHITESPACE","\n            ",156],["T_IF","if",157],["T_WHITESPACE"," ",157],"(",["T_ISSET","isset",157],"(",["T_VARIABLE","$addresses",157],"[",["T_CONSTANT_ENCAPSED_STRING","'_template_'",157],"]",")",")",["T_WHITESPACE"," ",157],"{",["T_WHITESPACE","\n                ",157],["T_UNSET","unset",158],"(",["T_VARIABLE","$addresses",158],"[",["T_CONSTANT_ENCAPSED_STRING","'_template_'",158],"]",")",";",["T_WHITESPACE","\n            ",158],"}",["T_WHITESPACE","\n\n            ",159],["T_VARIABLE","$addressIdList",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_STRING","array_keys",161],"(",["T_VARIABLE","$addresses",161],")",";",["T_WHITESPACE","\n            ",161],["T_VARIABLE","$result",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","saveDefaultFlags",162],"(",["T_VARIABLE","$addressIdList",162],",",["T_WHITESPACE"," ",162],["T_VARIABLE","$extractedCustomerData",162],")",";",["T_WHITESPACE","\n        ",162],"}",["T_WHITESPACE","\n\n        ",163],["T_RETURN","return",165],["T_WHITESPACE"," ",165],["T_VARIABLE","$result",165],";",["T_WHITESPACE","\n    ",165],"}",["T_WHITESPACE","\n\n    ",166],["T_DOC_COMMENT","\/**\n     * Save customer action\n     *\n     * @return \\Magento\\Backend\\Model\\View\\Result\\Redirect\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     * @SuppressWarnings(PHPMD.ExcessiveMethodLength)\n     * @SuppressWarnings(PHPMD.NPathComplexity)\n     *\/",168],["T_WHITESPACE","\n    ",175],["T_PUBLIC","public",176],["T_WHITESPACE"," ",176],["T_FUNCTION","function",176],["T_WHITESPACE"," ",176],["T_STRING","execute",176],"(",")",["T_WHITESPACE","\n    ",176],"{",["T_WHITESPACE","\n        ",177],["T_VARIABLE","$returnToEdit",178],["T_WHITESPACE"," ",178],"=",["T_WHITESPACE"," ",178],["T_STRING","false",178],";",["T_WHITESPACE","\n        ",178],["T_VARIABLE","$originalRequestData",179],["T_WHITESPACE"," ",179],"=",["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","getRequest",179],"(",")",["T_OBJECT_OPERATOR","->",179],["T_STRING","getPostValue",179],"(",")",";",["T_WHITESPACE","\n\n        ",179],["T_VARIABLE","$customerId",181],["T_WHITESPACE"," ",181],"=",["T_WHITESPACE"," ",181],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","getCurrentCustomerId",181],"(",")",";",["T_WHITESPACE","\n\n        ",181],["T_IF","if",183],["T_WHITESPACE"," ",183],"(",["T_VARIABLE","$originalRequestData",183],")",["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n            ",183],["T_TRY","try",184],["T_WHITESPACE"," ",184],"{",["T_WHITESPACE","\n                ",184],["T_COMMENT","\/\/ optional fields might be set in request for future processing by observers in other modules\n",185],["T_WHITESPACE","                ",186],["T_VARIABLE","$customerData",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","_extractCustomerData",186],"(",")",";",["T_WHITESPACE","\n                ",186],["T_VARIABLE","$addressesData",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","_extractCustomerAddressData",187],"(",["T_VARIABLE","$customerData",187],")",";",["T_WHITESPACE","\n\n                ",187],["T_IF","if",189],["T_WHITESPACE"," ",189],"(",["T_VARIABLE","$customerId",189],")",["T_WHITESPACE"," ",189],"{",["T_WHITESPACE","\n                    ",189],["T_VARIABLE","$currentCustomer",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","_customerRepository",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","getById",190],"(",["T_VARIABLE","$customerId",190],")",";",["T_WHITESPACE","\n                    ",190],["T_VARIABLE","$customerData",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_STRING","array_merge",191],"(",["T_WHITESPACE","\n                        ",191],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","customerMapper",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","toFlatArray",192],"(",["T_VARIABLE","$currentCustomer",192],")",",",["T_WHITESPACE","\n                        ",192],["T_VARIABLE","$customerData",193],["T_WHITESPACE","\n                    ",193],")",";",["T_WHITESPACE","\n                    ",194],["T_VARIABLE","$customerData",195],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",195],"]",["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_VARIABLE","$customerId",195],";",["T_WHITESPACE","\n                ",195],"}",["T_WHITESPACE","\n\n                ",196],["T_DOC_COMMENT","\/** @var CustomerInterface $customer *\/",198],["T_WHITESPACE","\n                ",198],["T_VARIABLE","$customer",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","customerDataFactory",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","create",199],"(",")",";",["T_WHITESPACE","\n                ",199],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","dataObjectHelper",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","populateWithArray",200],"(",["T_WHITESPACE","\n                    ",200],["T_VARIABLE","$customer",201],",",["T_WHITESPACE","\n                    ",201],["T_VARIABLE","$customerData",202],",",["T_WHITESPACE","\n                    ",202],["T_NS_SEPARATOR","\\",203],["T_STRING","Magento",203],["T_NS_SEPARATOR","\\",203],["T_STRING","Customer",203],["T_NS_SEPARATOR","\\",203],["T_STRING","Api",203],["T_NS_SEPARATOR","\\",203],["T_STRING","Data",203],["T_NS_SEPARATOR","\\",203],["T_STRING","CustomerInterface",203],["T_DOUBLE_COLON","::",203],["T_CLASS","class",203],["T_WHITESPACE","\n                ",203],")",";",["T_WHITESPACE","\n                ",204],["T_VARIABLE","$addresses",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],"[","]",";",["T_WHITESPACE","\n                ",205],["T_FOREACH","foreach",206],["T_WHITESPACE"," ",206],"(",["T_VARIABLE","$addressesData",206],["T_WHITESPACE"," ",206],["T_AS","as",206],["T_WHITESPACE"," ",206],["T_VARIABLE","$addressData",206],")",["T_WHITESPACE"," ",206],"{",["T_WHITESPACE","\n                    ",206],["T_VARIABLE","$region",207],["T_WHITESPACE"," ",207],"=",["T_WHITESPACE"," ",207],["T_ISSET","isset",207],"(",["T_VARIABLE","$addressData",207],"[",["T_CONSTANT_ENCAPSED_STRING","'region'",207],"]",")",["T_WHITESPACE"," ",207],"?",["T_WHITESPACE"," ",207],["T_VARIABLE","$addressData",207],"[",["T_CONSTANT_ENCAPSED_STRING","'region'",207],"]",["T_WHITESPACE"," ",207],":",["T_WHITESPACE"," ",207],["T_STRING","null",207],";",["T_WHITESPACE","\n                    ",207],["T_VARIABLE","$regionId",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_ISSET","isset",208],"(",["T_VARIABLE","$addressData",208],"[",["T_CONSTANT_ENCAPSED_STRING","'region_id'",208],"]",")",["T_WHITESPACE"," ",208],"?",["T_WHITESPACE"," ",208],["T_VARIABLE","$addressData",208],"[",["T_CONSTANT_ENCAPSED_STRING","'region_id'",208],"]",["T_WHITESPACE"," ",208],":",["T_WHITESPACE"," ",208],["T_STRING","null",208],";",["T_WHITESPACE","\n                    ",208],["T_VARIABLE","$addressData",209],"[",["T_CONSTANT_ENCAPSED_STRING","'region'",209],"]",["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],"[",["T_WHITESPACE","\n                        ",209],["T_CONSTANT_ENCAPSED_STRING","'region'",210],["T_WHITESPACE"," ",210],["T_DOUBLE_ARROW","=>",210],["T_WHITESPACE"," ",210],["T_VARIABLE","$region",210],",",["T_WHITESPACE","\n                        ",210],["T_CONSTANT_ENCAPSED_STRING","'region_id'",211],["T_WHITESPACE"," ",211],["T_DOUBLE_ARROW","=>",211],["T_WHITESPACE"," ",211],["T_VARIABLE","$regionId",211],",",["T_WHITESPACE","\n                    ",211],"]",";",["T_WHITESPACE","\n                    ",212],["T_VARIABLE","$addressDataObject",213],["T_WHITESPACE"," ",213],"=",["T_WHITESPACE"," ",213],["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","addressDataFactory",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","create",213],"(",")",";",["T_WHITESPACE","\n                    ",213],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","dataObjectHelper",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","populateWithArray",214],"(",["T_WHITESPACE","\n                        ",214],["T_VARIABLE","$addressDataObject",215],",",["T_WHITESPACE","\n                        ",215],["T_VARIABLE","$addressData",216],",",["T_WHITESPACE","\n                        ",216],["T_NS_SEPARATOR","\\",217],["T_STRING","Magento",217],["T_NS_SEPARATOR","\\",217],["T_STRING","Customer",217],["T_NS_SEPARATOR","\\",217],["T_STRING","Api",217],["T_NS_SEPARATOR","\\",217],["T_STRING","Data",217],["T_NS_SEPARATOR","\\",217],["T_STRING","AddressInterface",217],["T_DOUBLE_COLON","::",217],["T_CLASS","class",217],["T_WHITESPACE","\n                    ",217],")",";",["T_WHITESPACE","\n                    ",218],["T_VARIABLE","$addresses",219],"[","]",["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],["T_VARIABLE","$addressDataObject",219],";",["T_WHITESPACE","\n                ",219],"}",["T_WHITESPACE","\n\n                ",220],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","_eventManager",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","dispatch",222],"(",["T_WHITESPACE","\n                    ",222],["T_CONSTANT_ENCAPSED_STRING","'adminhtml_customer_prepare_save'",223],",",["T_WHITESPACE","\n                    ",223],"[",["T_CONSTANT_ENCAPSED_STRING","'customer'",224],["T_WHITESPACE"," ",224],["T_DOUBLE_ARROW","=>",224],["T_WHITESPACE"," ",224],["T_VARIABLE","$customer",224],",",["T_WHITESPACE"," ",224],["T_CONSTANT_ENCAPSED_STRING","'request'",224],["T_WHITESPACE"," ",224],["T_DOUBLE_ARROW","=>",224],["T_WHITESPACE"," ",224],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","getRequest",224],"(",")","]",["T_WHITESPACE","\n                ",224],")",";",["T_WHITESPACE","\n                ",225],["T_VARIABLE","$customer",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","setAddresses",226],"(",["T_VARIABLE","$addresses",226],")",";",["T_WHITESPACE","\n                ",226],["T_IF","if",227],["T_WHITESPACE"," ",227],"(",["T_ISSET","isset",227],"(",["T_VARIABLE","$customerData",227],"[",["T_CONSTANT_ENCAPSED_STRING","'sendemail_store_id'",227],"]",")",")",["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n                    ",227],["T_VARIABLE","$customer",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","setStoreId",228],"(",["T_VARIABLE","$customerData",228],"[",["T_CONSTANT_ENCAPSED_STRING","'sendemail_store_id'",228],"]",")",";",["T_WHITESPACE","\n                ",228],"}",["T_WHITESPACE","\n\n                ",229],["T_COMMENT","\/\/ Save customer\n",231],["T_WHITESPACE","                ",232],["T_IF","if",232],["T_WHITESPACE"," ",232],"(",["T_VARIABLE","$customerId",232],")",["T_WHITESPACE"," ",232],"{",["T_WHITESPACE","\n                    ",232],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","_customerRepository",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","save",233],"(",["T_VARIABLE","$customer",233],")",";",["T_WHITESPACE","\n\n                    ",233],["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","getEmailNotification",235],"(",")",["T_OBJECT_OPERATOR","->",235],["T_STRING","credentialsChanged",235],"(",["T_VARIABLE","$customer",235],",",["T_WHITESPACE"," ",235],["T_VARIABLE","$currentCustomer",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","getEmail",235],"(",")",")",";",["T_WHITESPACE","\n                ",235],"}",["T_WHITESPACE"," ",236],["T_ELSE","else",236],["T_WHITESPACE"," ",236],"{",["T_WHITESPACE","\n                    ",236],["T_VARIABLE","$customer",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","customerAccountManagement",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","createAccount",237],"(",["T_VARIABLE","$customer",237],")",";",["T_WHITESPACE","\n                    ",237],["T_VARIABLE","$customerId",238],["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],["T_VARIABLE","$customer",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","getId",238],"(",")",";",["T_WHITESPACE","\n                ",238],"}",["T_WHITESPACE","\n\n                ",239],["T_VARIABLE","$isSubscribed",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_STRING","null",241],";",["T_WHITESPACE","\n                ",241],["T_IF","if",242],["T_WHITESPACE"," ",242],"(",["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","_authorization",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","isAllowed",242],"(",["T_STRING","null",242],")",")",["T_WHITESPACE"," ",242],"{",["T_WHITESPACE","\n                    ",242],["T_VARIABLE","$isSubscribed",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","getRequest",243],"(",")",["T_OBJECT_OPERATOR","->",243],["T_STRING","getPost",243],"(",["T_CONSTANT_ENCAPSED_STRING","'subscription'",243],")",";",["T_WHITESPACE","\n                ",243],"}",["T_WHITESPACE","\n                ",244],["T_IF","if",245],["T_WHITESPACE"," ",245],"(",["T_VARIABLE","$isSubscribed",245],["T_WHITESPACE"," ",245],["T_IS_NOT_IDENTICAL","!==",245],["T_WHITESPACE"," ",245],["T_STRING","null",245],")",["T_WHITESPACE"," ",245],"{",["T_WHITESPACE","\n                    ",245],["T_IF","if",246],["T_WHITESPACE"," ",246],"(",["T_VARIABLE","$isSubscribed",246],["T_WHITESPACE"," ",246],["T_IS_NOT_IDENTICAL","!==",246],["T_WHITESPACE"," ",246],["T_CONSTANT_ENCAPSED_STRING","'false'",246],")",["T_WHITESPACE"," ",246],"{",["T_WHITESPACE","\n                        ",246],["T_VARIABLE","$this",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","_subscriberFactory",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","create",247],"(",")",["T_OBJECT_OPERATOR","->",247],["T_STRING","subscribeCustomerById",247],"(",["T_VARIABLE","$customerId",247],")",";",["T_WHITESPACE","\n                    ",247],"}",["T_WHITESPACE"," ",248],["T_ELSE","else",248],["T_WHITESPACE"," ",248],"{",["T_WHITESPACE","\n                        ",248],["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","_subscriberFactory",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","create",249],"(",")",["T_OBJECT_OPERATOR","->",249],["T_STRING","unsubscribeCustomerById",249],"(",["T_VARIABLE","$customerId",249],")",";",["T_WHITESPACE","\n                    ",249],"}",["T_WHITESPACE","\n                ",250],"}",["T_WHITESPACE","\n\n                ",251],["T_COMMENT","\/\/ After save\n",253],["T_WHITESPACE","                ",254],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","_eventManager",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","dispatch",254],"(",["T_WHITESPACE","\n                    ",254],["T_CONSTANT_ENCAPSED_STRING","'adminhtml_customer_save_after'",255],",",["T_WHITESPACE","\n                    ",255],"[",["T_CONSTANT_ENCAPSED_STRING","'customer'",256],["T_WHITESPACE"," ",256],["T_DOUBLE_ARROW","=>",256],["T_WHITESPACE"," ",256],["T_VARIABLE","$customer",256],",",["T_WHITESPACE"," ",256],["T_CONSTANT_ENCAPSED_STRING","'request'",256],["T_WHITESPACE"," ",256],["T_DOUBLE_ARROW","=>",256],["T_WHITESPACE"," ",256],["T_VARIABLE","$this",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","getRequest",256],"(",")","]",["T_WHITESPACE","\n                ",256],")",";",["T_WHITESPACE","\n                ",257],["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","_getSession",258],"(",")",["T_OBJECT_OPERATOR","->",258],["T_STRING","unsCustomerFormData",258],"(",")",";",["T_WHITESPACE","\n                ",258],["T_COMMENT","\/\/ Done Saving customer, finish save action\n",259],["T_WHITESPACE","                ",260],["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","_coreRegistry",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","register",260],"(",["T_STRING","RegistryConstants",260],["T_DOUBLE_COLON","::",260],["T_STRING","CURRENT_CUSTOMER_ID",260],",",["T_WHITESPACE"," ",260],["T_VARIABLE","$customerId",260],")",";",["T_WHITESPACE","\n                ",260],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","messageManager",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","addSuccess",261],"(",["T_STRING","__",261],"(",["T_CONSTANT_ENCAPSED_STRING","'You saved the customer.'",261],")",")",";",["T_WHITESPACE","\n                ",261],["T_VARIABLE","$returnToEdit",262],["T_WHITESPACE"," ",262],"=",["T_WHITESPACE"," ",262],["T_BOOL_CAST","(bool)",262],["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","getRequest",262],"(",")",["T_OBJECT_OPERATOR","->",262],["T_STRING","getParam",262],"(",["T_CONSTANT_ENCAPSED_STRING","'back'",262],",",["T_WHITESPACE"," ",262],["T_STRING","false",262],")",";",["T_WHITESPACE","\n            ",262],"}",["T_WHITESPACE"," ",263],["T_CATCH","catch",263],["T_WHITESPACE"," ",263],"(",["T_NS_SEPARATOR","\\",263],["T_STRING","Magento",263],["T_NS_SEPARATOR","\\",263],["T_STRING","Framework",263],["T_NS_SEPARATOR","\\",263],["T_STRING","Validator",263],["T_NS_SEPARATOR","\\",263],["T_STRING","Exception",263],["T_WHITESPACE"," ",263],["T_VARIABLE","$exception",263],")",["T_WHITESPACE"," ",263],"{",["T_WHITESPACE","\n                ",263],["T_VARIABLE","$messages",264],["T_WHITESPACE"," ",264],"=",["T_WHITESPACE"," ",264],["T_VARIABLE","$exception",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","getMessages",264],"(",")",";",["T_WHITESPACE","\n                ",264],["T_IF","if",265],["T_WHITESPACE"," ",265],"(",["T_EMPTY","empty",265],"(",["T_VARIABLE","$messages",265],")",")",["T_WHITESPACE"," ",265],"{",["T_WHITESPACE","\n                    ",265],["T_VARIABLE","$messages",266],["T_WHITESPACE"," ",266],"=",["T_WHITESPACE"," ",266],["T_VARIABLE","$exception",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","getMessage",266],"(",")",";",["T_WHITESPACE","\n                ",266],"}",["T_WHITESPACE","\n                ",267],["T_VARIABLE","$this",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","_addSessionErrorMessages",268],"(",["T_VARIABLE","$messages",268],")",";",["T_WHITESPACE","\n                ",268],["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","_getSession",269],"(",")",["T_OBJECT_OPERATOR","->",269],["T_STRING","setCustomerFormData",269],"(",["T_VARIABLE","$originalRequestData",269],")",";",["T_WHITESPACE","\n                ",269],["T_VARIABLE","$returnToEdit",270],["T_WHITESPACE"," ",270],"=",["T_WHITESPACE"," ",270],["T_STRING","true",270],";",["T_WHITESPACE","\n            ",270],"}",["T_WHITESPACE"," ",271],["T_CATCH","catch",271],["T_WHITESPACE"," ",271],"(",["T_STRING","LocalizedException",271],["T_WHITESPACE"," ",271],["T_VARIABLE","$exception",271],")",["T_WHITESPACE"," ",271],"{",["T_WHITESPACE","\n                ",271],["T_VARIABLE","$this",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","_addSessionErrorMessages",272],"(",["T_VARIABLE","$exception",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","getMessage",272],"(",")",")",";",["T_WHITESPACE","\n                ",272],["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","_getSession",273],"(",")",["T_OBJECT_OPERATOR","->",273],["T_STRING","setCustomerFormData",273],"(",["T_VARIABLE","$originalRequestData",273],")",";",["T_WHITESPACE","\n                ",273],["T_VARIABLE","$returnToEdit",274],["T_WHITESPACE"," ",274],"=",["T_WHITESPACE"," ",274],["T_STRING","true",274],";",["T_WHITESPACE","\n            ",274],"}",["T_WHITESPACE"," ",275],["T_CATCH","catch",275],["T_WHITESPACE"," ",275],"(",["T_NS_SEPARATOR","\\",275],["T_STRING","Exception",275],["T_WHITESPACE"," ",275],["T_VARIABLE","$exception",275],")",["T_WHITESPACE"," ",275],"{",["T_WHITESPACE","\n                ",275],["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","messageManager",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","addException",276],"(",["T_VARIABLE","$exception",276],",",["T_WHITESPACE"," ",276],["T_STRING","__",276],"(",["T_CONSTANT_ENCAPSED_STRING","'Something went wrong while saving the customer.'",276],")",")",";",["T_WHITESPACE","\n                ",276],["T_VARIABLE","$this",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","_getSession",277],"(",")",["T_OBJECT_OPERATOR","->",277],["T_STRING","setCustomerFormData",277],"(",["T_VARIABLE","$originalRequestData",277],")",";",["T_WHITESPACE","\n                ",277],["T_VARIABLE","$returnToEdit",278],["T_WHITESPACE"," ",278],"=",["T_WHITESPACE"," ",278],["T_STRING","true",278],";",["T_WHITESPACE","\n            ",278],"}",["T_WHITESPACE","\n        ",279],"}",["T_WHITESPACE","\n        ",280],["T_VARIABLE","$resultRedirect",281],["T_WHITESPACE"," ",281],"=",["T_WHITESPACE"," ",281],["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","resultRedirectFactory",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","create",281],"(",")",";",["T_WHITESPACE","\n        ",281],["T_IF","if",282],["T_WHITESPACE"," ",282],"(",["T_VARIABLE","$returnToEdit",282],")",["T_WHITESPACE"," ",282],"{",["T_WHITESPACE","\n            ",282],["T_IF","if",283],["T_WHITESPACE"," ",283],"(",["T_VARIABLE","$customerId",283],")",["T_WHITESPACE"," ",283],"{",["T_WHITESPACE","\n                ",283],["T_VARIABLE","$resultRedirect",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","setPath",284],"(",["T_WHITESPACE","\n                    ",284],["T_CONSTANT_ENCAPSED_STRING","'customer\/*\/edit'",285],",",["T_WHITESPACE","\n                    ",285],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",286],["T_WHITESPACE"," ",286],["T_DOUBLE_ARROW","=>",286],["T_WHITESPACE"," ",286],["T_VARIABLE","$customerId",286],",",["T_WHITESPACE"," ",286],["T_CONSTANT_ENCAPSED_STRING","'_current'",286],["T_WHITESPACE"," ",286],["T_DOUBLE_ARROW","=>",286],["T_WHITESPACE"," ",286],["T_STRING","true",286],"]",["T_WHITESPACE","\n                ",286],")",";",["T_WHITESPACE","\n            ",287],"}",["T_WHITESPACE"," ",288],["T_ELSE","else",288],["T_WHITESPACE"," ",288],"{",["T_WHITESPACE","\n                ",288],["T_VARIABLE","$resultRedirect",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","setPath",289],"(",["T_WHITESPACE","\n                    ",289],["T_CONSTANT_ENCAPSED_STRING","'customer\/*\/new'",290],",",["T_WHITESPACE","\n                    ",290],"[",["T_CONSTANT_ENCAPSED_STRING","'_current'",291],["T_WHITESPACE"," ",291],["T_DOUBLE_ARROW","=>",291],["T_WHITESPACE"," ",291],["T_STRING","true",291],"]",["T_WHITESPACE","\n                ",291],")",";",["T_WHITESPACE","\n            ",292],"}",["T_WHITESPACE","\n        ",293],"}",["T_WHITESPACE"," ",294],["T_ELSE","else",294],["T_WHITESPACE"," ",294],"{",["T_WHITESPACE","\n            ",294],["T_VARIABLE","$resultRedirect",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","setPath",295],"(",["T_CONSTANT_ENCAPSED_STRING","'customer\/index'",295],")",";",["T_WHITESPACE","\n        ",295],"}",["T_WHITESPACE","\n        ",296],["T_RETURN","return",297],["T_WHITESPACE"," ",297],["T_VARIABLE","$resultRedirect",297],";",["T_WHITESPACE","\n    ",297],"}",["T_WHITESPACE","\n\n    ",298],["T_DOC_COMMENT","\/**\n     * Get email notification\n     *\n     * @return EmailNotificationInterface\n     * @deprecated\n     *\/",300],["T_WHITESPACE","\n    ",305],["T_PRIVATE","private",306],["T_WHITESPACE"," ",306],["T_FUNCTION","function",306],["T_WHITESPACE"," ",306],["T_STRING","getEmailNotification",306],"(",")",["T_WHITESPACE","\n    ",306],"{",["T_WHITESPACE","\n        ",307],["T_IF","if",308],["T_WHITESPACE"," ",308],"(","!","(",["T_VARIABLE","$this",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","emailNotification",308],["T_WHITESPACE"," ",308],["T_INSTANCEOF","instanceof",308],["T_WHITESPACE"," ",308],["T_STRING","EmailNotificationInterface",308],")",")",["T_WHITESPACE"," ",308],"{",["T_WHITESPACE","\n            ",308],["T_RETURN","return",309],["T_WHITESPACE"," ",309],["T_NS_SEPARATOR","\\",309],["T_STRING","Magento",309],["T_NS_SEPARATOR","\\",309],["T_STRING","Framework",309],["T_NS_SEPARATOR","\\",309],["T_STRING","App",309],["T_NS_SEPARATOR","\\",309],["T_STRING","ObjectManager",309],["T_DOUBLE_COLON","::",309],["T_STRING","getInstance",309],"(",")",["T_OBJECT_OPERATOR","->",309],["T_STRING","get",309],"(",["T_WHITESPACE","\n                ",309],["T_STRING","EmailNotificationInterface",310],["T_DOUBLE_COLON","::",310],["T_CLASS","class",310],["T_WHITESPACE","\n            ",310],")",";",["T_WHITESPACE","\n        ",311],"}",["T_WHITESPACE"," ",312],["T_ELSE","else",312],["T_WHITESPACE"," ",312],"{",["T_WHITESPACE","\n            ",312],["T_RETURN","return",313],["T_WHITESPACE"," ",313],["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","emailNotification",313],";",["T_WHITESPACE","\n        ",313],"}",["T_WHITESPACE","\n    ",314],"}",["T_WHITESPACE","\n\n    ",315],["T_DOC_COMMENT","\/**\n     * Get metadata form\n     *\n     * @param string $entityType\n     * @param string $formCode\n     * @param string $scope\n     * @return Form\n     *\/",317],["T_WHITESPACE","\n    ",324],["T_PRIVATE","private",325],["T_WHITESPACE"," ",325],["T_FUNCTION","function",325],["T_WHITESPACE"," ",325],["T_STRING","getMetadataForm",325],"(",["T_VARIABLE","$entityType",325],",",["T_WHITESPACE"," ",325],["T_VARIABLE","$formCode",325],",",["T_WHITESPACE"," ",325],["T_VARIABLE","$scope",325],")",["T_WHITESPACE","\n    ",325],"{",["T_WHITESPACE","\n        ",326],["T_VARIABLE","$attributeValues",327],["T_WHITESPACE"," ",327],"=",["T_WHITESPACE"," ",327],"[","]",";",["T_WHITESPACE","\n\n        ",327],["T_IF","if",329],["T_WHITESPACE"," ",329],"(",["T_VARIABLE","$entityType",329],["T_WHITESPACE"," ",329],["T_IS_EQUAL","==",329],["T_WHITESPACE"," ",329],["T_STRING","CustomerMetadataInterface",329],["T_DOUBLE_COLON","::",329],["T_STRING","ENTITY_TYPE_CUSTOMER",329],")",["T_WHITESPACE"," ",329],"{",["T_WHITESPACE","\n            ",329],["T_VARIABLE","$customerId",330],["T_WHITESPACE"," ",330],"=",["T_WHITESPACE"," ",330],["T_VARIABLE","$this",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","getCurrentCustomerId",330],"(",")",";",["T_WHITESPACE","\n            ",330],["T_IF","if",331],["T_WHITESPACE"," ",331],"(",["T_VARIABLE","$customerId",331],")",["T_WHITESPACE"," ",331],"{",["T_WHITESPACE","\n                ",331],["T_VARIABLE","$customer",332],["T_WHITESPACE"," ",332],"=",["T_WHITESPACE"," ",332],["T_VARIABLE","$this",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","_customerRepository",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","getById",332],"(",["T_VARIABLE","$customerId",332],")",";",["T_WHITESPACE","\n                ",332],["T_VARIABLE","$attributeValues",333],["T_WHITESPACE"," ",333],"=",["T_WHITESPACE"," ",333],["T_VARIABLE","$this",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","customerMapper",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","toFlatArray",333],"(",["T_VARIABLE","$customer",333],")",";",["T_WHITESPACE","\n            ",333],"}",["T_WHITESPACE","\n        ",334],"}",["T_WHITESPACE","\n\n        ",335],["T_IF","if",337],["T_WHITESPACE"," ",337],"(",["T_VARIABLE","$entityType",337],["T_WHITESPACE"," ",337],["T_IS_EQUAL","==",337],["T_WHITESPACE"," ",337],["T_STRING","AddressMetadataInterface",337],["T_DOUBLE_COLON","::",337],["T_STRING","ENTITY_TYPE_ADDRESS",337],")",["T_WHITESPACE"," ",337],"{",["T_WHITESPACE","\n            ",337],["T_VARIABLE","$scopeData",338],["T_WHITESPACE"," ",338],"=",["T_WHITESPACE"," ",338],["T_STRING","explode",338],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",338],",",["T_WHITESPACE"," ",338],["T_VARIABLE","$scope",338],")",";",["T_WHITESPACE","\n            ",338],["T_IF","if",339],["T_WHITESPACE"," ",339],"(",["T_ISSET","isset",339],"(",["T_VARIABLE","$scopeData",339],"[",["T_LNUMBER","1",339],"]",")",["T_WHITESPACE"," ",339],["T_BOOLEAN_AND","&&",339],["T_WHITESPACE"," ",339],["T_STRING","is_numeric",339],"(",["T_VARIABLE","$scopeData",339],"[",["T_LNUMBER","1",339],"]",")",")",["T_WHITESPACE"," ",339],"{",["T_WHITESPACE","\n                ",339],["T_VARIABLE","$customerAddress",340],["T_WHITESPACE"," ",340],"=",["T_WHITESPACE"," ",340],["T_VARIABLE","$this",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","addressRepository",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","getById",340],"(",["T_VARIABLE","$scopeData",340],"[",["T_LNUMBER","1",340],"]",")",";",["T_WHITESPACE","\n                ",340],["T_VARIABLE","$attributeValues",341],["T_WHITESPACE"," ",341],"=",["T_WHITESPACE"," ",341],["T_VARIABLE","$this",341],["T_OBJECT_OPERATOR","->",341],["T_STRING","addressMapper",341],["T_OBJECT_OPERATOR","->",341],["T_STRING","toFlatArray",341],"(",["T_VARIABLE","$customerAddress",341],")",";",["T_WHITESPACE","\n            ",341],"}",["T_WHITESPACE","\n        ",342],"}",["T_WHITESPACE","\n\n        ",343],["T_VARIABLE","$metadataForm",345],["T_WHITESPACE"," ",345],"=",["T_WHITESPACE"," ",345],["T_VARIABLE","$this",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","_formFactory",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","create",345],"(",["T_WHITESPACE","\n            ",345],["T_VARIABLE","$entityType",346],",",["T_WHITESPACE","\n            ",346],["T_VARIABLE","$formCode",347],",",["T_WHITESPACE","\n            ",347],["T_VARIABLE","$attributeValues",348],",",["T_WHITESPACE","\n            ",348],["T_STRING","false",349],",",["T_WHITESPACE","\n            ",349],["T_STRING","Form",350],["T_DOUBLE_COLON","::",350],["T_STRING","DONT_IGNORE_INVISIBLE",350],["T_WHITESPACE","\n        ",350],")",";",["T_WHITESPACE","\n\n        ",351],["T_RETURN","return",353],["T_WHITESPACE"," ",353],["T_VARIABLE","$metadataForm",353],";",["T_WHITESPACE","\n    ",353],"}",["T_WHITESPACE","\n\n    ",354],["T_DOC_COMMENT","\/**\n     * Retrieve current customer ID\n     *\n     * @return int\n     *\/",356],["T_WHITESPACE","\n    ",360],["T_PRIVATE","private",361],["T_WHITESPACE"," ",361],["T_FUNCTION","function",361],["T_WHITESPACE"," ",361],["T_STRING","getCurrentCustomerId",361],"(",")",["T_WHITESPACE","\n    ",361],"{",["T_WHITESPACE","\n        ",362],["T_VARIABLE","$originalRequestData",363],["T_WHITESPACE"," ",363],"=",["T_WHITESPACE"," ",363],["T_VARIABLE","$this",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","getRequest",363],"(",")",["T_OBJECT_OPERATOR","->",363],["T_STRING","getPostValue",363],"(",["T_STRING","CustomerMetadataInterface",363],["T_DOUBLE_COLON","::",363],["T_STRING","ENTITY_TYPE_CUSTOMER",363],")",";",["T_WHITESPACE","\n\n        ",363],["T_VARIABLE","$customerId",365],["T_WHITESPACE"," ",365],"=",["T_WHITESPACE"," ",365],["T_ISSET","isset",365],"(",["T_VARIABLE","$originalRequestData",365],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",365],"]",")",["T_WHITESPACE","\n            ",365],"?",["T_WHITESPACE"," ",366],["T_VARIABLE","$originalRequestData",366],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",366],"]",["T_WHITESPACE","\n            ",366],":",["T_WHITESPACE"," ",367],["T_STRING","null",367],";",["T_WHITESPACE","\n\n        ",367],["T_RETURN","return",369],["T_WHITESPACE"," ",369],["T_VARIABLE","$customerId",369],";",["T_WHITESPACE","\n    ",369],"}",["T_WHITESPACE","\n",370],"}",["T_WHITESPACE","\n",371]]