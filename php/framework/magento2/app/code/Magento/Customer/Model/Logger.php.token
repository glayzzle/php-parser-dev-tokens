[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Customer",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","App",8],["T_NS_SEPARATOR","\\",8],["T_STRING","ResourceConnection",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * Customer log data logger.\n *\n * Saves and retrieves customer log data.\n *\/",10],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","Logger",15],["T_WHITESPACE","\n",15],"{",["T_WHITESPACE","\n    ",16],["T_DOC_COMMENT","\/**\n     * Resource instance.\n     *\n     * @var Resource\n     *\/",17],["T_WHITESPACE","\n    ",21],["T_PROTECTED","protected",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$resource",22],";",["T_WHITESPACE","\n\n    ",22],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Customer\\Model\\LogFactory\n     *\/",24],["T_WHITESPACE","\n    ",26],["T_PROTECTED","protected",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$logFactory",27],";",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * @param ResourceConnection $resource\n     * @param \\Magento\\Customer\\Model\\LogFactory $logFactory\n     *\/",29],["T_WHITESPACE","\n    ",32],["T_PUBLIC","public",33],["T_WHITESPACE"," ",33],["T_FUNCTION","function",33],["T_WHITESPACE"," ",33],["T_STRING","__construct",33],"(",["T_WHITESPACE","\n        ",33],["T_STRING","ResourceConnection",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$resource",34],",",["T_WHITESPACE","\n        ",34],["T_NS_SEPARATOR","\\",35],["T_STRING","Magento",35],["T_NS_SEPARATOR","\\",35],["T_STRING","Customer",35],["T_NS_SEPARATOR","\\",35],["T_STRING","Model",35],["T_NS_SEPARATOR","\\",35],["T_STRING","LogFactory",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$logFactory",35],["T_WHITESPACE","\n    ",35],")",["T_WHITESPACE"," ",36],"{",["T_WHITESPACE","\n        ",36],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","resource",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_VARIABLE","$resource",37],";",["T_WHITESPACE","\n        ",37],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","logFactory",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_VARIABLE","$logFactory",38],";",["T_WHITESPACE","\n    ",38],"}",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * Save (insert new or update existing) log.\n     *\n     * @param int $customerId\n     * @param array $data\n     * @return $this\n     * @throws \\InvalidArgumentException\n     *\/",41],["T_WHITESPACE","\n    ",48],["T_PUBLIC","public",49],["T_WHITESPACE"," ",49],["T_FUNCTION","function",49],["T_WHITESPACE"," ",49],["T_STRING","log",49],"(",["T_VARIABLE","$customerId",49],",",["T_WHITESPACE"," ",49],["T_ARRAY","array",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$data",49],")",["T_WHITESPACE","\n    ",49],"{",["T_WHITESPACE","\n        ",50],["T_VARIABLE","$data",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_STRING","array_filter",51],"(",["T_VARIABLE","$data",51],")",";",["T_WHITESPACE","\n\n        ",51],["T_IF","if",53],["T_WHITESPACE"," ",53],"(","!",["T_VARIABLE","$data",53],")",["T_WHITESPACE"," ",53],"{",["T_WHITESPACE","\n            ",53],["T_THROW","throw",54],["T_WHITESPACE"," ",54],["T_NEW","new",54],["T_WHITESPACE"," ",54],["T_NS_SEPARATOR","\\",54],["T_STRING","InvalidArgumentException",54],"(",["T_CONSTANT_ENCAPSED_STRING","\"Log data is empty\"",54],")",";",["T_WHITESPACE","\n        ",54],"}",["T_WHITESPACE","\n\n        ",55],["T_DOC_COMMENT","\/** @var \\Magento\\Framework\\DB\\Adapter\\AdapterInterface $connection *\/",57],["T_WHITESPACE","\n        ",57],["T_VARIABLE","$connection",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","resource",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","getConnection",58],"(",["T_STRING","ResourceConnection",58],["T_DOUBLE_COLON","::",58],["T_STRING","DEFAULT_CONNECTION",58],")",";",["T_WHITESPACE","\n\n        ",58],["T_VARIABLE","$connection",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","insertOnDuplicate",60],"(",["T_WHITESPACE","\n            ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","resource",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","getTableName",61],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_log'",61],")",",",["T_WHITESPACE","\n            ",61],["T_STRING","array_merge",62],"(","[",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",62],["T_WHITESPACE"," ",62],["T_DOUBLE_ARROW","=>",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$customerId",62],"]",",",["T_WHITESPACE"," ",62],["T_VARIABLE","$data",62],")",",",["T_WHITESPACE","\n            ",62],["T_STRING","array_keys",63],"(",["T_VARIABLE","$data",63],")",["T_WHITESPACE","\n        ",63],")",";",["T_WHITESPACE","\n\n        ",64],["T_RETURN","return",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],";",["T_WHITESPACE","\n    ",66],"}",["T_WHITESPACE","\n\n    ",67],["T_DOC_COMMENT","\/**\n     * Load log by Customer Id.\n     *\n     * @param int $customerId\n     * @return Log\n     *\/",69],["T_WHITESPACE","\n    ",74],["T_PUBLIC","public",75],["T_WHITESPACE"," ",75],["T_FUNCTION","function",75],["T_WHITESPACE"," ",75],["T_STRING","get",75],"(",["T_VARIABLE","$customerId",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_STRING","null",75],")",["T_WHITESPACE","\n    ",75],"{",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$data",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],"(",["T_STRING","null",77],["T_WHITESPACE"," ",77],["T_IS_NOT_IDENTICAL","!==",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$customerId",77],")",["T_WHITESPACE"," ",77],"?",["T_WHITESPACE"," ",77],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","loadLogData",77],"(",["T_VARIABLE","$customerId",77],")",["T_WHITESPACE"," ",77],":",["T_WHITESPACE"," ",77],"[","]",";",["T_WHITESPACE","\n\n        ",77],["T_RETURN","return",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","logFactory",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","create",79],"(",["T_WHITESPACE","\n            ",79],"[",["T_WHITESPACE","\n                ",80],["T_CONSTANT_ENCAPSED_STRING","'customerId'",81],["T_WHITESPACE"," ",81],["T_DOUBLE_ARROW","=>",81],["T_WHITESPACE"," ",81],["T_ISSET","isset",81],"(",["T_VARIABLE","$data",81],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",81],"]",")",["T_WHITESPACE"," ",81],"?",["T_WHITESPACE"," ",81],["T_VARIABLE","$data",81],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",81],"]",["T_WHITESPACE"," ",81],":",["T_WHITESPACE"," ",81],["T_STRING","null",81],",",["T_WHITESPACE","\n                ",81],["T_CONSTANT_ENCAPSED_STRING","'lastLoginAt'",82],["T_WHITESPACE"," ",82],["T_DOUBLE_ARROW","=>",82],["T_WHITESPACE"," ",82],["T_ISSET","isset",82],"(",["T_VARIABLE","$data",82],"[",["T_CONSTANT_ENCAPSED_STRING","'last_login_at'",82],"]",")",["T_WHITESPACE"," ",82],"?",["T_WHITESPACE"," ",82],["T_VARIABLE","$data",82],"[",["T_CONSTANT_ENCAPSED_STRING","'last_login_at'",82],"]",["T_WHITESPACE"," ",82],":",["T_WHITESPACE"," ",82],["T_STRING","null",82],",",["T_WHITESPACE","\n                ",82],["T_CONSTANT_ENCAPSED_STRING","'lastLogoutAt'",83],["T_WHITESPACE"," ",83],["T_DOUBLE_ARROW","=>",83],["T_WHITESPACE"," ",83],["T_ISSET","isset",83],"(",["T_VARIABLE","$data",83],"[",["T_CONSTANT_ENCAPSED_STRING","'last_logout_at'",83],"]",")",["T_WHITESPACE"," ",83],"?",["T_WHITESPACE"," ",83],["T_VARIABLE","$data",83],"[",["T_CONSTANT_ENCAPSED_STRING","'last_logout_at'",83],"]",["T_WHITESPACE"," ",83],":",["T_WHITESPACE"," ",83],["T_STRING","null",83],",",["T_WHITESPACE","\n                ",83],["T_CONSTANT_ENCAPSED_STRING","'lastVisitAt'",84],["T_WHITESPACE"," ",84],["T_DOUBLE_ARROW","=>",84],["T_WHITESPACE"," ",84],["T_ISSET","isset",84],"(",["T_VARIABLE","$data",84],"[",["T_CONSTANT_ENCAPSED_STRING","'last_visit_at'",84],"]",")",["T_WHITESPACE"," ",84],"?",["T_WHITESPACE"," ",84],["T_VARIABLE","$data",84],"[",["T_CONSTANT_ENCAPSED_STRING","'last_visit_at'",84],"]",["T_WHITESPACE"," ",84],":",["T_WHITESPACE"," ",84],["T_STRING","null",84],["T_WHITESPACE","\n            ",84],"]",["T_WHITESPACE","\n        ",85],")",";",["T_WHITESPACE","\n    ",86],"}",["T_WHITESPACE","\n\n    ",87],["T_DOC_COMMENT","\/**\n     * Load customer log data by customer id\n     *\n     * @param int $customerId\n     * @return array\n     *\/",89],["T_WHITESPACE","\n    ",94],["T_PROTECTED","protected",95],["T_WHITESPACE"," ",95],["T_FUNCTION","function",95],["T_WHITESPACE"," ",95],["T_STRING","loadLogData",95],"(",["T_VARIABLE","$customerId",95],")",["T_WHITESPACE","\n    ",95],"{",["T_WHITESPACE","\n        ",96],["T_DOC_COMMENT","\/** @var \\Magento\\Framework\\DB\\Adapter\\AdapterInterface $connection *\/",97],["T_WHITESPACE","\n        ",97],["T_VARIABLE","$connection",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","resource",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getConnection",98],"(",")",";",["T_WHITESPACE","\n\n        ",98],["T_VARIABLE","$select",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$connection",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","select",100],"(",")",["T_WHITESPACE","\n            ",100],["T_OBJECT_OPERATOR","->",101],["T_STRING","from",101],"(",["T_WHITESPACE","\n                ",101],"[",["T_CONSTANT_ENCAPSED_STRING","'cl'",102],["T_WHITESPACE"," ",102],["T_DOUBLE_ARROW","=>",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","resource",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getTableName",102],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_log'",102],")","]",["T_WHITESPACE","\n            ",102],")",["T_WHITESPACE","\n            ",103],["T_OBJECT_OPERATOR","->",104],["T_STRING","joinLeft",104],"(",["T_WHITESPACE","\n                ",104],"[",["T_CONSTANT_ENCAPSED_STRING","'cv'",105],["T_WHITESPACE"," ",105],["T_DOUBLE_ARROW","=>",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","resource",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getTableName",105],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_visitor'",105],")","]",",",["T_WHITESPACE","\n                ",105],["T_CONSTANT_ENCAPSED_STRING","'cv.customer_id = cl.customer_id'",106],",",["T_WHITESPACE","\n                ",106],"[",["T_CONSTANT_ENCAPSED_STRING","'last_visit_at'",107],"]",["T_WHITESPACE","\n            ",107],")",["T_WHITESPACE","\n            ",108],["T_OBJECT_OPERATOR","->",109],["T_STRING","where",109],"(",["T_WHITESPACE","\n                ",109],["T_CONSTANT_ENCAPSED_STRING","'cl.customer_id = ?'",110],",",["T_WHITESPACE","\n                ",110],["T_VARIABLE","$customerId",111],["T_WHITESPACE","\n            ",111],")",["T_WHITESPACE","\n            ",112],["T_OBJECT_OPERATOR","->",113],["T_STRING","order",113],"(",["T_WHITESPACE","\n                ",113],["T_CONSTANT_ENCAPSED_STRING","'cv.visitor_id DESC'",114],["T_WHITESPACE","\n            ",114],")",["T_WHITESPACE","\n            ",115],["T_OBJECT_OPERATOR","->",116],["T_STRING","limit",116],"(",["T_LNUMBER","1",116],")",";",["T_WHITESPACE","\n\n        ",116],["T_RETURN","return",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$connection",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","fetchRow",118],"(",["T_VARIABLE","$select",118],")",";",["T_WHITESPACE","\n    ",118],"}",["T_WHITESPACE","\n",119],"}",["T_WHITESPACE","\n",120]]