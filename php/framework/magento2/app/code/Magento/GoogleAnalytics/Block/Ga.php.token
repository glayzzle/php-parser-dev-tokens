[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_COMMENT","\/\/ @codingStandardsIgnoreFile\n",7],["T_WHITESPACE","\n",8],["T_NAMESPACE","namespace",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","GoogleAnalytics",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Block",9],";",["T_WHITESPACE","\n\n",9],["T_DOC_COMMENT","\/**\n * GoogleAnalytics Page Block\n *\/",11],["T_WHITESPACE","\n",13],["T_CLASS","class",14],["T_WHITESPACE"," ",14],["T_STRING","Ga",14],["T_WHITESPACE"," ",14],["T_EXTENDS","extends",14],["T_WHITESPACE"," ",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Framework",14],["T_NS_SEPARATOR","\\",14],["T_STRING","View",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Element",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Template",14],["T_WHITESPACE","\n",14],"{",["T_WHITESPACE","\n    ",15],["T_DOC_COMMENT","\/**\n     * Google analytics data\n     *\n     * @var \\Magento\\GoogleAnalytics\\Helper\\Data\n     *\/",16],["T_WHITESPACE","\n    ",20],["T_PROTECTED","protected",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$_googleAnalyticsData",21],["T_WHITESPACE"," ",21],"=",["T_WHITESPACE"," ",21],["T_STRING","null",21],";",["T_WHITESPACE","\n\n    ",21],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Sales\\Model\\ResourceModel\\Order\\CollectionFactory\n     *\/",23],["T_WHITESPACE","\n    ",25],["T_PROTECTED","protected",26],["T_WHITESPACE"," ",26],["T_VARIABLE","$_salesOrderCollection",26],";",["T_WHITESPACE","\n\n    ",26],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\View\\Element\\Template\\Context $context\n     * @param \\Magento\\Sales\\Model\\ResourceModel\\Order\\CollectionFactory $salesOrderCollection\n     * @param \\Magento\\GoogleAnalytics\\Helper\\Data $googleAnalyticsData\n     * @param array $data\n     *\/",28],["T_WHITESPACE","\n    ",33],["T_PUBLIC","public",34],["T_WHITESPACE"," ",34],["T_FUNCTION","function",34],["T_WHITESPACE"," ",34],["T_STRING","__construct",34],"(",["T_WHITESPACE","\n        ",34],["T_NS_SEPARATOR","\\",35],["T_STRING","Magento",35],["T_NS_SEPARATOR","\\",35],["T_STRING","Framework",35],["T_NS_SEPARATOR","\\",35],["T_STRING","View",35],["T_NS_SEPARATOR","\\",35],["T_STRING","Element",35],["T_NS_SEPARATOR","\\",35],["T_STRING","Template",35],["T_NS_SEPARATOR","\\",35],["T_STRING","Context",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$context",35],",",["T_WHITESPACE","\n        ",35],["T_NS_SEPARATOR","\\",36],["T_STRING","Magento",36],["T_NS_SEPARATOR","\\",36],["T_STRING","Sales",36],["T_NS_SEPARATOR","\\",36],["T_STRING","Model",36],["T_NS_SEPARATOR","\\",36],["T_STRING","ResourceModel",36],["T_NS_SEPARATOR","\\",36],["T_STRING","Order",36],["T_NS_SEPARATOR","\\",36],["T_STRING","CollectionFactory",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$salesOrderCollection",36],",",["T_WHITESPACE","\n        ",36],["T_NS_SEPARATOR","\\",37],["T_STRING","Magento",37],["T_NS_SEPARATOR","\\",37],["T_STRING","GoogleAnalytics",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Helper",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Data",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$googleAnalyticsData",37],",",["T_WHITESPACE","\n        ",37],["T_ARRAY","array",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$data",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],"[","]",["T_WHITESPACE","\n    ",38],")",["T_WHITESPACE"," ",39],"{",["T_WHITESPACE","\n        ",39],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","_googleAnalyticsData",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$googleAnalyticsData",40],";",["T_WHITESPACE","\n        ",40],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","_salesOrderCollection",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$salesOrderCollection",41],";",["T_WHITESPACE","\n        ",41],["T_STRING","parent",42],["T_DOUBLE_COLON","::",42],["T_STRING","__construct",42],"(",["T_VARIABLE","$context",42],",",["T_WHITESPACE"," ",42],["T_VARIABLE","$data",42],")",";",["T_WHITESPACE","\n    ",42],"}",["T_WHITESPACE","\n\n    ",43],["T_DOC_COMMENT","\/**\n     * Get config\n     *\n     * @param string $path\n     * @return mixed\n     *\/",45],["T_WHITESPACE","\n    ",50],["T_PUBLIC","public",51],["T_WHITESPACE"," ",51],["T_FUNCTION","function",51],["T_WHITESPACE"," ",51],["T_STRING","getConfig",51],"(",["T_VARIABLE","$path",51],")",["T_WHITESPACE","\n    ",51],"{",["T_WHITESPACE","\n        ",52],["T_RETURN","return",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","_scopeConfig",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","getValue",53],"(",["T_VARIABLE","$path",53],",",["T_WHITESPACE"," ",53],["T_NS_SEPARATOR","\\",53],["T_STRING","Magento",53],["T_NS_SEPARATOR","\\",53],["T_STRING","Store",53],["T_NS_SEPARATOR","\\",53],["T_STRING","Model",53],["T_NS_SEPARATOR","\\",53],["T_STRING","ScopeInterface",53],["T_DOUBLE_COLON","::",53],["T_STRING","SCOPE_STORE",53],")",";",["T_WHITESPACE","\n    ",53],"}",["T_WHITESPACE","\n\n    ",54],["T_DOC_COMMENT","\/**\n     * Get a specific page name (may be customized via layout)\n     *\n     * @return string|null\n     *\/",56],["T_WHITESPACE","\n    ",60],["T_PUBLIC","public",61],["T_WHITESPACE"," ",61],["T_FUNCTION","function",61],["T_WHITESPACE"," ",61],["T_STRING","getPageName",61],"(",")",["T_WHITESPACE","\n    ",61],"{",["T_WHITESPACE","\n        ",62],["T_RETURN","return",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","_getData",63],"(",["T_CONSTANT_ENCAPSED_STRING","'page_name'",63],")",";",["T_WHITESPACE","\n    ",63],"}",["T_WHITESPACE","\n\n    ",64],["T_DOC_COMMENT","\/**\n     * Render regular page tracking javascript code\n     * The custom \"page name\" may be set from layout or somewhere else. It must start from slash.\n     *\n     * @param string $accountId\n     * @return string\n     * @link https:\/\/developers.google.com\/analytics\/devguides\/collection\/analyticsjs\/method-reference#set\n     * @link https:\/\/developers.google.com\/analytics\/devguides\/collection\/analyticsjs\/method-reference#gaObjectMethods\n     *\/",66],["T_WHITESPACE","\n    ",74],["T_PUBLIC","public",75],["T_WHITESPACE"," ",75],["T_FUNCTION","function",75],["T_WHITESPACE"," ",75],["T_STRING","getPageTrackingCode",75],"(",["T_VARIABLE","$accountId",75],")",["T_WHITESPACE","\n    ",75],"{",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$pageName",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_STRING","trim",77],"(",["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getPageName",77],"(",")",")",";",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$optPageURL",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","''",78],";",["T_WHITESPACE","\n        ",78],["T_IF","if",79],["T_WHITESPACE"," ",79],"(",["T_VARIABLE","$pageName",79],["T_WHITESPACE"," ",79],["T_BOOLEAN_AND","&&",79],["T_WHITESPACE"," ",79],["T_STRING","substr",79],"(",["T_VARIABLE","$pageName",79],",",["T_WHITESPACE"," ",79],["T_LNUMBER","0",79],",",["T_WHITESPACE"," ",79],["T_LNUMBER","1",79],")",["T_WHITESPACE"," ",79],["T_IS_EQUAL","==",79],["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'\/'",79],["T_WHITESPACE"," ",79],["T_BOOLEAN_AND","&&",79],["T_WHITESPACE"," ",79],["T_STRING","strlen",79],"(",["T_VARIABLE","$pageName",79],")",["T_WHITESPACE"," ",79],">",["T_WHITESPACE"," ",79],["T_LNUMBER","1",79],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n            ",79],["T_VARIABLE","$optPageURL",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","\", '\"",80],["T_WHITESPACE"," ",80],".",["T_WHITESPACE"," ",80],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","escapeHtmlAttr",80],"(",["T_VARIABLE","$pageName",80],",",["T_WHITESPACE"," ",80],["T_STRING","false",80],")",["T_WHITESPACE"," ",80],".",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","\"'\"",80],";",["T_WHITESPACE","\n        ",80],"}",["T_WHITESPACE","\n\n        ",81],["T_RETURN","return",83],["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","\"\\nga('create', '\"",83],["T_WHITESPACE"," ",83],".",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","escapeHtmlAttr",83],"(",["T_VARIABLE","$accountId",83],",",["T_WHITESPACE"," ",83],["T_STRING","false",83],")",["T_WHITESPACE","\n            ",83],".",["T_WHITESPACE"," ",84],"\"",["T_ENCAPSED_AND_WHITESPACE",", 'auto');\\nga('send', 'pageview'",84],["T_CURLY_OPEN","{",84],["T_VARIABLE","$optPageURL",84],"}",["T_ENCAPSED_AND_WHITESPACE",");\\n",84],"\"",";",["T_WHITESPACE","\n    ",84],"}",["T_WHITESPACE","\n\n    ",85],["T_DOC_COMMENT","\/**\n     * Render information about specified orders and their items\n     *\n     * @link https:\/\/developers.google.com\/analytics\/devguides\/collection\/analyticsjs\/enhanced-ecommerce#checkout-options\n     * @link https:\/\/developers.google.com\/analytics\/devguides\/collection\/analyticsjs\/enhanced-ecommerce#measuring-transactions\n     * @link https:\/\/developers.google.com\/analytics\/devguides\/collection\/analyticsjs\/enhanced-ecommerce#transaction\n     *\n     * @return string|void\n     *\/",87],["T_WHITESPACE","\n    ",95],["T_PUBLIC","public",96],["T_WHITESPACE"," ",96],["T_FUNCTION","function",96],["T_WHITESPACE"," ",96],["T_STRING","getOrdersTrackingCode",96],"(",")",["T_WHITESPACE","\n    ",96],"{",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$orderIds",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getOrderIds",98],"(",")",";",["T_WHITESPACE","\n        ",98],["T_IF","if",99],["T_WHITESPACE"," ",99],"(",["T_EMPTY","empty",99],"(",["T_VARIABLE","$orderIds",99],")",["T_WHITESPACE"," ",99],["T_BOOLEAN_OR","||",99],["T_WHITESPACE"," ",99],"!",["T_STRING","is_array",99],"(",["T_VARIABLE","$orderIds",99],")",")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n            ",99],["T_RETURN","return",100],";",["T_WHITESPACE","\n        ",100],"}",["T_WHITESPACE","\n\n        ",101],["T_VARIABLE","$collection",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","_salesOrderCollection",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","create",103],"(",")",";",["T_WHITESPACE","\n        ",103],["T_VARIABLE","$collection",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","addFieldToFilter",104],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",104],",",["T_WHITESPACE"," ",104],"[",["T_CONSTANT_ENCAPSED_STRING","'in'",104],["T_WHITESPACE"," ",104],["T_DOUBLE_ARROW","=>",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$orderIds",104],"]",")",";",["T_WHITESPACE","\n        ",104],["T_VARIABLE","$result",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],"[","]",";",["T_WHITESPACE","\n\n        ",105],["T_VARIABLE","$result",107],"[","]",["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","\"ga('require', 'ec', 'ec.js');\"",107],";",["T_WHITESPACE","\n        ",107],["T_FOREACH","foreach",108],["T_WHITESPACE"," ",108],"(",["T_VARIABLE","$collection",108],["T_WHITESPACE"," ",108],["T_AS","as",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$order",108],")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n            ",108],["T_IF","if",109],["T_WHITESPACE"," ",109],"(",["T_VARIABLE","$order",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getIsVirtual",109],"(",")",")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n                ",109],["T_VARIABLE","$address",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$order",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getBillingAddress",110],"(",")",";",["T_WHITESPACE","\n            ",110],"}",["T_WHITESPACE"," ",111],["T_ELSE","else",111],["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n                ",111],["T_VARIABLE","$address",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$order",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","getShippingAddress",112],"(",")",";",["T_WHITESPACE","\n            ",112],"}",["T_WHITESPACE","\n\n            ",113],["T_FOREACH","foreach",115],["T_WHITESPACE"," ",115],"(",["T_VARIABLE","$order",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","getAllVisibleItems",115],"(",")",["T_WHITESPACE"," ",115],["T_AS","as",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$item",115],")",["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n                ",115],["T_VARIABLE","$result",116],"[","]",["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_STRING","sprintf",116],"(",["T_WHITESPACE","\n                    ",116],["T_CONSTANT_ENCAPSED_STRING","\"ga('ec:addProduct', {\n                        'id': '%s',\n                        'name': '%s',\n                        'price': '%s',\n                        'quantity': %s\n                    });\"",117],",",["T_WHITESPACE","\n                    ",122],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","escapeJs",123],"(",["T_VARIABLE","$item",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getSku",123],"(",")",")",",",["T_WHITESPACE","\n                    ",123],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","escapeJs",124],"(",["T_VARIABLE","$item",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","getName",124],"(",")",")",",",["T_WHITESPACE","\n                    ",124],["T_VARIABLE","$item",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","getBasePrice",125],"(",")",",",["T_WHITESPACE","\n                    ",125],["T_VARIABLE","$item",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getQtyOrdered",126],"(",")",["T_WHITESPACE","\n                ",126],")",";",["T_WHITESPACE","\n            ",127],"}",["T_WHITESPACE","\n\n            ",128],["T_VARIABLE","$result",130],"[","]",["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_STRING","sprintf",130],"(",["T_WHITESPACE","\n                ",130],["T_CONSTANT_ENCAPSED_STRING","\"ga('ec:setAction', 'purchase', {\n                    'id': '%s',\n                    'affiliation': '%s',\n                    'revenue': '%s',\n                    'tax': '%s',\n                    'shipping': '%s'\n                });\"",131],",",["T_WHITESPACE","\n                ",137],["T_VARIABLE","$order",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","getIncrementId",138],"(",")",",",["T_WHITESPACE","\n                ",138],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","escapeJs",139],"(",["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","_storeManager",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getStore",139],"(",")",["T_OBJECT_OPERATOR","->",139],["T_STRING","getFrontendName",139],"(",")",")",",",["T_WHITESPACE","\n                ",139],["T_VARIABLE","$order",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","getBaseGrandTotal",140],"(",")",",",["T_WHITESPACE","\n                ",140],["T_VARIABLE","$order",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getBaseTaxAmount",141],"(",")",",",["T_WHITESPACE","\n                ",141],["T_VARIABLE","$order",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","getBaseShippingAmount",142],"(",")",["T_WHITESPACE","\n            ",142],")",";",["T_WHITESPACE","\n\n            ",143],["T_VARIABLE","$result",145],"[","]",["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","\"ga('send', 'pageview');\"",145],";",["T_WHITESPACE","\n        ",145],"}",["T_WHITESPACE","\n        ",146],["T_RETURN","return",147],["T_WHITESPACE"," ",147],["T_STRING","implode",147],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",147],",",["T_WHITESPACE"," ",147],["T_VARIABLE","$result",147],")",";",["T_WHITESPACE","\n    ",147],"}",["T_WHITESPACE","\n\n    ",148],["T_DOC_COMMENT","\/**\n     * Render GA tracking scripts\n     *\n     * @return string\n     *\/",150],["T_WHITESPACE","\n    ",154],["T_PROTECTED","protected",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","_toHtml",155],"(",")",["T_WHITESPACE","\n    ",155],"{",["T_WHITESPACE","\n        ",156],["T_IF","if",157],["T_WHITESPACE"," ",157],"(","!",["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","_googleAnalyticsData",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","isGoogleAnalyticsAvailable",157],"(",")",")",["T_WHITESPACE"," ",157],"{",["T_WHITESPACE","\n            ",157],["T_RETURN","return",158],["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","''",158],";",["T_WHITESPACE","\n        ",158],"}",["T_WHITESPACE","\n\n        ",159],["T_RETURN","return",161],["T_WHITESPACE"," ",161],["T_STRING","parent",161],["T_DOUBLE_COLON","::",161],["T_STRING","_toHtml",161],"(",")",";",["T_WHITESPACE","\n    ",161],"}",["T_WHITESPACE","\n",162],"}",["T_WHITESPACE","\n",163]]