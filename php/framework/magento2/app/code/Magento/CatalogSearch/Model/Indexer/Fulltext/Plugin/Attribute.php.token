[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","CatalogSearch",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Indexer",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Fulltext",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Plugin",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","CatalogSearch",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Model",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Indexer",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Fulltext",8],";",["T_WHITESPACE","\n\n",8],["T_CLASS","class",10],["T_WHITESPACE"," ",10],["T_STRING","Attribute",10],["T_WHITESPACE"," ",10],["T_EXTENDS","extends",10],["T_WHITESPACE"," ",10],["T_STRING","AbstractPlugin",10],["T_WHITESPACE","\n",10],"{",["T_WHITESPACE","\n    ",11],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Search\\Request\\Config\n     *\/",12],["T_WHITESPACE","\n    ",14],["T_PRIVATE","private",15],["T_WHITESPACE"," ",15],["T_VARIABLE","$config",15],";",["T_WHITESPACE","\n\n    ",15],["T_DOC_COMMENT","\/**\n     * @var boolean\n     *\/",17],["T_WHITESPACE","\n    ",19],["T_PRIVATE","private",20],["T_WHITESPACE"," ",20],["T_VARIABLE","$deleteNeedInvalidation",20],";",["T_WHITESPACE","\n\n    ",20],["T_DOC_COMMENT","\/**\n     * @var boolean\n     *\/",22],["T_WHITESPACE","\n    ",24],["T_PRIVATE","private",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$saveNeedInvalidation",25],";",["T_WHITESPACE","\n\n    ",25],["T_DOC_COMMENT","\/**\n     * @var boolean\n     *\/",27],["T_WHITESPACE","\n    ",29],["T_PRIVATE","private",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$saveIsNew",30],";",["T_WHITESPACE","\n\n    ",30],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\Indexer\\IndexerRegistry $indexerRegistry\n     * @param \\Magento\\Framework\\Search\\Request\\Config $config\n     *\/",32],["T_WHITESPACE","\n    ",35],["T_PUBLIC","public",36],["T_WHITESPACE"," ",36],["T_FUNCTION","function",36],["T_WHITESPACE"," ",36],["T_STRING","__construct",36],"(",["T_WHITESPACE","\n        ",36],["T_NS_SEPARATOR","\\",37],["T_STRING","Magento",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Framework",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Indexer",37],["T_NS_SEPARATOR","\\",37],["T_STRING","IndexerRegistry",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$indexerRegistry",37],",",["T_WHITESPACE","\n        ",37],["T_NS_SEPARATOR","\\",38],["T_STRING","Magento",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Framework",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Search",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Request",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Config",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$config",38],["T_WHITESPACE","\n    ",38],")",["T_WHITESPACE"," ",39],"{",["T_WHITESPACE","\n        ",39],["T_STRING","parent",40],["T_DOUBLE_COLON","::",40],["T_STRING","__construct",40],"(",["T_VARIABLE","$indexerRegistry",40],")",";",["T_WHITESPACE"," ",40],["T_COMMENT","\/\/ TODO: Change the autogenerated stub\n",40],["T_WHITESPACE","        ",41],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","config",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$config",41],";",["T_WHITESPACE","\n    ",41],"}",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Check if indexer invalidation is needed on attribute save (searchable flag change)\n     *\n     * @param \\Magento\\Catalog\\Model\\ResourceModel\\Attribute $subject\n     * @param \\Magento\\Framework\\Model\\AbstractModel $attribute\n     *\n     * @return void\n     * @SuppressWarnings(PHPMD.UnusedFormalParameter)\n     *\/",44],["T_WHITESPACE","\n    ",52],["T_PUBLIC","public",53],["T_WHITESPACE"," ",53],["T_FUNCTION","function",53],["T_WHITESPACE"," ",53],["T_STRING","beforeSave",53],"(",["T_WHITESPACE","\n        ",53],["T_NS_SEPARATOR","\\",54],["T_STRING","Magento",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Catalog",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Model",54],["T_NS_SEPARATOR","\\",54],["T_STRING","ResourceModel",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Attribute",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$subject",54],",",["T_WHITESPACE","\n        ",54],["T_NS_SEPARATOR","\\",55],["T_STRING","Magento",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Framework",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Model",55],["T_NS_SEPARATOR","\\",55],["T_STRING","AbstractModel",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$attribute",55],["T_WHITESPACE","\n    ",55],")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","saveIsNew",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$attribute",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","isObjectNew",57],"(",")",";",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","saveNeedInvalidation",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],"(",["T_WHITESPACE","\n                ",58],["T_VARIABLE","$attribute",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","dataHasChangedFor",59],"(",["T_CONSTANT_ENCAPSED_STRING","'is_searchable'",59],")",["T_WHITESPACE","\n                ",59],["T_BOOLEAN_OR","||",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$attribute",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","dataHasChangedFor",60],"(",["T_CONSTANT_ENCAPSED_STRING","'is_filterable'",60],")",["T_WHITESPACE","\n                ",60],["T_BOOLEAN_OR","||",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$attribute",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","dataHasChangedFor",61],"(",["T_CONSTANT_ENCAPSED_STRING","'is_visible_in_advanced_search'",61],")",["T_WHITESPACE","\n            ",61],")",["T_WHITESPACE"," ",62],["T_BOOLEAN_AND","&&",62],["T_WHITESPACE"," ",62],"!",["T_WHITESPACE"," ",62],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","saveIsNew",62],";",["T_WHITESPACE","\n    ",62],"}",["T_WHITESPACE","\n\n    ",63],["T_DOC_COMMENT","\/**\n     * Invalidate indexer on attribute save (searchable flag change)\n     *\n     * @param \\Magento\\Catalog\\Model\\ResourceModel\\Attribute $subject\n     * @param \\Magento\\Catalog\\Model\\ResourceModel\\Attribute $result\n     *\n     * @return \\Magento\\Catalog\\Model\\ResourceModel\\Attribute\n     * @SuppressWarnings(PHPMD.UnusedFormalParameter)\n     *\/",65],["T_WHITESPACE","\n    ",73],["T_PUBLIC","public",74],["T_WHITESPACE"," ",74],["T_FUNCTION","function",74],["T_WHITESPACE"," ",74],["T_STRING","afterSave",74],"(",["T_WHITESPACE","\n        ",74],["T_NS_SEPARATOR","\\",75],["T_STRING","Magento",75],["T_NS_SEPARATOR","\\",75],["T_STRING","Catalog",75],["T_NS_SEPARATOR","\\",75],["T_STRING","Model",75],["T_NS_SEPARATOR","\\",75],["T_STRING","ResourceModel",75],["T_NS_SEPARATOR","\\",75],["T_STRING","Attribute",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$subject",75],",",["T_WHITESPACE","\n        ",75],["T_NS_SEPARATOR","\\",76],["T_STRING","Magento",76],["T_NS_SEPARATOR","\\",76],["T_STRING","Catalog",76],["T_NS_SEPARATOR","\\",76],["T_STRING","Model",76],["T_NS_SEPARATOR","\\",76],["T_STRING","ResourceModel",76],["T_NS_SEPARATOR","\\",76],["T_STRING","Attribute",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$result",76],["T_WHITESPACE","\n    ",76],")",["T_WHITESPACE"," ",77],"{",["T_WHITESPACE","\n        ",77],["T_IF","if",78],["T_WHITESPACE"," ",78],"(",["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","saveNeedInvalidation",78],")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n            ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","indexerRegistry",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","get",79],"(",["T_STRING","Fulltext",79],["T_DOUBLE_COLON","::",79],["T_STRING","INDEXER_ID",79],")",["T_OBJECT_OPERATOR","->",79],["T_STRING","invalidate",79],"(",")",";",["T_WHITESPACE","\n        ",79],"}",["T_WHITESPACE","\n        ",80],["T_IF","if",81],["T_WHITESPACE"," ",81],"(",["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","saveIsNew",81],["T_WHITESPACE"," ",81],["T_BOOLEAN_OR","||",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","saveNeedInvalidation",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n            ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","config",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","reset",82],"(",")",";",["T_WHITESPACE","\n        ",82],"}",["T_WHITESPACE","\n\n        ",83],["T_RETURN","return",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$result",85],";",["T_WHITESPACE","\n    ",85],"}",["T_WHITESPACE","\n\n    ",86],["T_DOC_COMMENT","\/**\n     * Check if indexer invalidation is needed on searchable attribute delete\n     *\n     * @param \\Magento\\Catalog\\Model\\ResourceModel\\Attribute $subject\n     * @param \\Magento\\Framework\\Model\\AbstractModel $attribute\n     *\n     * @return void\n     * @SuppressWarnings(PHPMD.UnusedFormalParameter)\n     *\/",88],["T_WHITESPACE","\n    ",96],["T_PUBLIC","public",97],["T_WHITESPACE"," ",97],["T_FUNCTION","function",97],["T_WHITESPACE"," ",97],["T_STRING","beforeDelete",97],"(",["T_WHITESPACE","\n        ",97],["T_NS_SEPARATOR","\\",98],["T_STRING","Magento",98],["T_NS_SEPARATOR","\\",98],["T_STRING","Catalog",98],["T_NS_SEPARATOR","\\",98],["T_STRING","Model",98],["T_NS_SEPARATOR","\\",98],["T_STRING","ResourceModel",98],["T_NS_SEPARATOR","\\",98],["T_STRING","Attribute",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$subject",98],",",["T_WHITESPACE","\n        ",98],["T_NS_SEPARATOR","\\",99],["T_STRING","Magento",99],["T_NS_SEPARATOR","\\",99],["T_STRING","Framework",99],["T_NS_SEPARATOR","\\",99],["T_STRING","Model",99],["T_NS_SEPARATOR","\\",99],["T_STRING","AbstractModel",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$attribute",99],["T_WHITESPACE","\n    ",99],")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","deleteNeedInvalidation",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],"!",["T_VARIABLE","$attribute",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","isObjectNew",101],"(",")",["T_WHITESPACE"," ",101],["T_BOOLEAN_AND","&&",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$attribute",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getIsSearchable",101],"(",")",";",["T_WHITESPACE","\n    ",101],"}",["T_WHITESPACE","\n\n    ",102],["T_DOC_COMMENT","\/**\n     * Invalidate indexer on searchable attribute delete\n     *\n     * @param \\Magento\\Catalog\\Model\\ResourceModel\\Attribute $subject\n     * @param \\Magento\\Catalog\\Model\\ResourceModel\\Attribute $result\n     *\n     * @return \\Magento\\Catalog\\Model\\ResourceModel\\Attribute\n     * @SuppressWarnings(PHPMD.UnusedFormalParameter)\n     *\/",104],["T_WHITESPACE","\n    ",112],["T_PUBLIC","public",113],["T_WHITESPACE"," ",113],["T_FUNCTION","function",113],["T_WHITESPACE"," ",113],["T_STRING","afterDelete",113],"(",["T_WHITESPACE","\n        ",113],["T_NS_SEPARATOR","\\",114],["T_STRING","Magento",114],["T_NS_SEPARATOR","\\",114],["T_STRING","Catalog",114],["T_NS_SEPARATOR","\\",114],["T_STRING","Model",114],["T_NS_SEPARATOR","\\",114],["T_STRING","ResourceModel",114],["T_NS_SEPARATOR","\\",114],["T_STRING","Attribute",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$subject",114],",",["T_WHITESPACE","\n        ",114],["T_NS_SEPARATOR","\\",115],["T_STRING","Magento",115],["T_NS_SEPARATOR","\\",115],["T_STRING","Catalog",115],["T_NS_SEPARATOR","\\",115],["T_STRING","Model",115],["T_NS_SEPARATOR","\\",115],["T_STRING","ResourceModel",115],["T_NS_SEPARATOR","\\",115],["T_STRING","Attribute",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$result",115],["T_WHITESPACE","\n    ",115],")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n        ",116],["T_IF","if",117],["T_WHITESPACE"," ",117],"(",["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","deleteNeedInvalidation",117],")",["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n            ",117],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","indexerRegistry",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","get",118],"(",["T_STRING","Fulltext",118],["T_DOUBLE_COLON","::",118],["T_STRING","INDEXER_ID",118],")",["T_OBJECT_OPERATOR","->",118],["T_STRING","invalidate",118],"(",")",";",["T_WHITESPACE","\n        ",118],"}",["T_WHITESPACE","\n        ",119],["T_RETURN","return",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$result",120],";",["T_WHITESPACE","\n    ",120],"}",["T_WHITESPACE","\n",121],"}",["T_WHITESPACE","\n",122]]