[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Captcha",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Implementation of \\Zend_Captcha\n *\n * @author     Magento Core Team <core@magentocommerce.com>\n *\/",8],["T_WHITESPACE","\n",12],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","DefaultModel",13],["T_WHITESPACE"," ",13],["T_EXTENDS","extends",13],["T_WHITESPACE"," ",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Zend_Captcha_Image",13],["T_WHITESPACE"," ",13],["T_IMPLEMENTS","implements",13],["T_WHITESPACE"," ",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Captcha",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Model",13],["T_NS_SEPARATOR","\\",13],["T_STRING","CaptchaInterface",13],["T_WHITESPACE","\n",13],"{",["T_WHITESPACE","\n    ",14],["T_DOC_COMMENT","\/**\n     * Key in session for captcha code\n     *\/",15],["T_WHITESPACE","\n    ",17],["T_CONST","const",18],["T_WHITESPACE"," ",18],["T_STRING","SESSION_WORD",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],["T_CONSTANT_ENCAPSED_STRING","'word'",18],";",["T_WHITESPACE","\n\n    ",18],["T_DOC_COMMENT","\/**\n     * Min captcha lengths default value\n     *\/",20],["T_WHITESPACE","\n    ",22],["T_CONST","const",23],["T_WHITESPACE"," ",23],["T_STRING","DEFAULT_WORD_LENGTH_FROM",23],["T_WHITESPACE"," ",23],"=",["T_WHITESPACE"," ",23],["T_LNUMBER","3",23],";",["T_WHITESPACE","\n\n    ",23],["T_DOC_COMMENT","\/**\n     * Max captcha lengths default value\n     *\/",25],["T_WHITESPACE","\n    ",27],["T_CONST","const",28],["T_WHITESPACE"," ",28],["T_STRING","DEFAULT_WORD_LENGTH_TO",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_LNUMBER","5",28],";",["T_WHITESPACE","\n\n    ",28],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Captcha\\Helper\\Data\n     *\/",30],["T_WHITESPACE","\n    ",32],["T_PROTECTED","protected",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$_captchaData",33],";",["T_WHITESPACE","\n\n    ",33],["T_DOC_COMMENT","\/**\n     * Captcha expire time\n     * @var int\n     *\/",35],["T_WHITESPACE","\n    ",38],["T_PROTECTED","protected",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$_expiration",39],";",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * Override default value to prevent a captcha cut off\n     * @var int\n     * @see \\Zend_Captcha_Image::$_fsize\n     *\/",41],["T_WHITESPACE","\n    ",45],["T_PROTECTED","protected",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$_fsize",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_LNUMBER","22",46],";",["T_WHITESPACE","\n\n    ",46],["T_DOC_COMMENT","\/**\n     * Captcha form id\n     * @var string\n     *\/",48],["T_WHITESPACE","\n    ",51],["T_PROTECTED","protected",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$_formId",52],";",["T_WHITESPACE","\n\n    ",52],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Captcha\\Model\\ResourceModel\\LogFactory\n     *\/",54],["T_WHITESPACE","\n    ",56],["T_PROTECTED","protected",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$_resLogFactory",57],";",["T_WHITESPACE","\n\n    ",57],["T_DOC_COMMENT","\/**\n     * Overrides parent parameter as session comes in constructor.\n     *\n     * @var bool\n     *\/",59],["T_WHITESPACE","\n    ",63],["T_PROTECTED","protected",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$_keepSession",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_STRING","true",64],";",["T_WHITESPACE","\n\n    ",64],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Session\\SessionManagerInterface\n     *\/",66],["T_WHITESPACE","\n    ",68],["T_PROTECTED","protected",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$_session",69],";",["T_WHITESPACE","\n\n    ",69],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\Session\\SessionManagerInterface $session\n     * @param \\Magento\\Captcha\\Helper\\Data $captchaData\n     * @param \\Magento\\Captcha\\Model\\ResourceModel\\LogFactory $resLogFactory\n     * @param string $formId\n     *\/",71],["T_WHITESPACE","\n    ",76],["T_PUBLIC","public",77],["T_WHITESPACE"," ",77],["T_FUNCTION","function",77],["T_WHITESPACE"," ",77],["T_STRING","__construct",77],"(",["T_WHITESPACE","\n        ",77],["T_NS_SEPARATOR","\\",78],["T_STRING","Magento",78],["T_NS_SEPARATOR","\\",78],["T_STRING","Framework",78],["T_NS_SEPARATOR","\\",78],["T_STRING","Session",78],["T_NS_SEPARATOR","\\",78],["T_STRING","SessionManagerInterface",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$session",78],",",["T_WHITESPACE","\n        ",78],["T_NS_SEPARATOR","\\",79],["T_STRING","Magento",79],["T_NS_SEPARATOR","\\",79],["T_STRING","Captcha",79],["T_NS_SEPARATOR","\\",79],["T_STRING","Helper",79],["T_NS_SEPARATOR","\\",79],["T_STRING","Data",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$captchaData",79],",",["T_WHITESPACE","\n        ",79],["T_NS_SEPARATOR","\\",80],["T_STRING","Magento",80],["T_NS_SEPARATOR","\\",80],["T_STRING","Captcha",80],["T_NS_SEPARATOR","\\",80],["T_STRING","Model",80],["T_NS_SEPARATOR","\\",80],["T_STRING","ResourceModel",80],["T_NS_SEPARATOR","\\",80],["T_STRING","LogFactory",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$resLogFactory",80],",",["T_WHITESPACE","\n        ",80],["T_VARIABLE","$formId",81],["T_WHITESPACE","\n    ",81],")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","_session",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$session",83],";",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","_captchaData",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$captchaData",84],";",["T_WHITESPACE","\n        ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","_resLogFactory",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_VARIABLE","$resLogFactory",85],";",["T_WHITESPACE","\n        ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","_formId",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$formId",86],";",["T_WHITESPACE","\n    ",86],"}",["T_WHITESPACE","\n\n    ",87],["T_DOC_COMMENT","\/**\n     * Returns key with respect of current form ID\n     *\n     * @param string $key\n     * @return string\n     *\/",89],["T_WHITESPACE","\n    ",94],["T_PROTECTED","protected",95],["T_WHITESPACE"," ",95],["T_FUNCTION","function",95],["T_WHITESPACE"," ",95],["T_STRING","_getFormIdKey",95],"(",["T_VARIABLE","$key",95],")",["T_WHITESPACE","\n    ",95],"{",["T_WHITESPACE","\n        ",96],["T_RETURN","return",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","_formId",97],["T_WHITESPACE"," ",97],".",["T_WHITESPACE"," ",97],["T_CONSTANT_ENCAPSED_STRING","'_'",97],["T_WHITESPACE"," ",97],".",["T_WHITESPACE"," ",97],["T_VARIABLE","$key",97],";",["T_WHITESPACE","\n    ",97],"}",["T_WHITESPACE","\n\n    ",98],["T_DOC_COMMENT","\/**\n     * Get Block Name\n     *\n     * @return string\n     *\/",100],["T_WHITESPACE","\n    ",104],["T_PUBLIC","public",105],["T_WHITESPACE"," ",105],["T_FUNCTION","function",105],["T_WHITESPACE"," ",105],["T_STRING","getBlockName",105],"(",")",["T_WHITESPACE","\n    ",105],"{",["T_WHITESPACE","\n        ",106],["T_RETURN","return",107],["T_WHITESPACE"," ",107],["T_NS_SEPARATOR","\\",107],["T_STRING","Magento",107],["T_NS_SEPARATOR","\\",107],["T_STRING","Captcha",107],["T_NS_SEPARATOR","\\",107],["T_STRING","Block",107],["T_NS_SEPARATOR","\\",107],["T_STRING","Captcha",107],["T_NS_SEPARATOR","\\",107],["T_STRING","DefaultCaptcha",107],["T_DOUBLE_COLON","::",107],["T_CLASS","class",107],";",["T_WHITESPACE","\n    ",107],"}",["T_WHITESPACE","\n\n    ",108],["T_DOC_COMMENT","\/**\n     * Whether captcha is required to be inserted to this form\n     *\n     * @param null|string $login\n     * @return bool\n     *\/",110],["T_WHITESPACE","\n    ",115],["T_PUBLIC","public",116],["T_WHITESPACE"," ",116],["T_FUNCTION","function",116],["T_WHITESPACE"," ",116],["T_STRING","isRequired",116],"(",["T_VARIABLE","$login",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_STRING","null",116],")",["T_WHITESPACE","\n    ",116],"{",["T_WHITESPACE","\n        ",117],["T_IF","if",118],["T_WHITESPACE"," ",118],"(",["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","_isUserAuth",118],"(",")",["T_WHITESPACE"," ",118],["T_BOOLEAN_AND","&&",118],["T_WHITESPACE"," ",118],"!",["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","isShownToLoggedInUser",118],"(",")",["T_WHITESPACE"," ",118],["T_BOOLEAN_OR","||",118],["T_WHITESPACE"," ",118],"!",["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","_isEnabled",118],"(",")",["T_WHITESPACE"," ",118],["T_BOOLEAN_OR","||",118],["T_WHITESPACE"," ",118],"!",["T_STRING","in_array",118],"(",["T_WHITESPACE","\n            ",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_formId",119],",",["T_WHITESPACE","\n            ",119],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","_getTargetForms",120],"(",")",["T_WHITESPACE","\n        ",120],")",["T_WHITESPACE","\n        ",121],")",["T_WHITESPACE"," ",122],"{",["T_WHITESPACE","\n            ",122],["T_RETURN","return",123],["T_WHITESPACE"," ",123],["T_STRING","false",123],";",["T_WHITESPACE","\n        ",123],"}",["T_WHITESPACE","\n\n        ",124],["T_RETURN","return",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","_isShowAlways",126],"(",")",["T_WHITESPACE"," ",126],["T_BOOLEAN_OR","||",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","_isOverLimitAttempts",126],"(",["T_WHITESPACE","\n            ",126],["T_VARIABLE","$login",127],["T_WHITESPACE","\n        ",127],")",["T_WHITESPACE"," ",128],["T_BOOLEAN_OR","||",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","_session",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","getData",128],"(",["T_WHITESPACE","\n            ",128],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","_getFormIdKey",129],"(",["T_CONSTANT_ENCAPSED_STRING","'show_captcha'",129],")",["T_WHITESPACE","\n        ",129],")",";",["T_WHITESPACE","\n    ",130],"}",["T_WHITESPACE","\n\n    ",131],["T_DOC_COMMENT","\/**\n     * Check if CAPTCHA has to be shown to logged in user on this form\n     *\n     * @return bool\n     *\/",133],["T_WHITESPACE","\n    ",137],["T_PUBLIC","public",138],["T_WHITESPACE"," ",138],["T_FUNCTION","function",138],["T_WHITESPACE"," ",138],["T_STRING","isShownToLoggedInUser",138],"(",")",["T_WHITESPACE","\n    ",138],"{",["T_WHITESPACE","\n        ",139],["T_VARIABLE","$forms",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_ARRAY_CAST","(array)",140],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","_captchaData",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","getConfig",140],"(",["T_CONSTANT_ENCAPSED_STRING","'shown_to_logged_in_user'",140],")",";",["T_WHITESPACE","\n        ",140],["T_FOREACH","foreach",141],["T_WHITESPACE"," ",141],"(",["T_VARIABLE","$forms",141],["T_WHITESPACE"," ",141],["T_AS","as",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$formId",141],["T_WHITESPACE"," ",141],["T_DOUBLE_ARROW","=>",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$isShownToLoggedIn",141],")",["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n            ",141],["T_IF","if",142],["T_WHITESPACE"," ",142],"(",["T_VARIABLE","$isShownToLoggedIn",142],["T_WHITESPACE"," ",142],["T_BOOLEAN_AND","&&",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","_formId",142],["T_WHITESPACE"," ",142],["T_IS_EQUAL","==",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$formId",142],")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n                ",142],["T_RETURN","return",143],["T_WHITESPACE"," ",143],["T_STRING","true",143],";",["T_WHITESPACE","\n            ",143],"}",["T_WHITESPACE","\n        ",144],"}",["T_WHITESPACE","\n        ",145],["T_RETURN","return",146],["T_WHITESPACE"," ",146],["T_STRING","false",146],";",["T_WHITESPACE","\n    ",146],"}",["T_WHITESPACE","\n\n    ",147],["T_DOC_COMMENT","\/**\n     * Check is over limit attempts\n     *\n     * @param string $login\n     * @return bool\n     *\/",149],["T_WHITESPACE","\n    ",154],["T_PROTECTED","protected",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","_isOverLimitAttempts",155],"(",["T_VARIABLE","$login",155],")",["T_WHITESPACE","\n    ",155],"{",["T_WHITESPACE","\n        ",156],["T_RETURN","return",157],["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","_isOverLimitIpAttempt",157],"(",")",["T_WHITESPACE"," ",157],["T_BOOLEAN_OR","||",157],["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","_isOverLimitLoginAttempts",157],"(",["T_VARIABLE","$login",157],")",";",["T_WHITESPACE","\n    ",157],"}",["T_WHITESPACE","\n\n    ",158],["T_DOC_COMMENT","\/**\n     * Returns number of allowed attempts for same login\n     *\n     * @return int\n     *\/",160],["T_WHITESPACE","\n    ",164],["T_PROTECTED","protected",165],["T_WHITESPACE"," ",165],["T_FUNCTION","function",165],["T_WHITESPACE"," ",165],["T_STRING","_getAllowedAttemptsForSameLogin",165],"(",")",["T_WHITESPACE","\n    ",165],"{",["T_WHITESPACE","\n        ",166],["T_RETURN","return",167],["T_WHITESPACE"," ",167],["T_INT_CAST","(int)",167],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","_captchaData",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","getConfig",167],"(",["T_CONSTANT_ENCAPSED_STRING","'failed_attempts_login'",167],")",";",["T_WHITESPACE","\n    ",167],"}",["T_WHITESPACE","\n\n    ",168],["T_DOC_COMMENT","\/**\n     * Returns number of allowed attempts from same IP\n     *\n     * @return int\n     *\/",170],["T_WHITESPACE","\n    ",174],["T_PROTECTED","protected",175],["T_WHITESPACE"," ",175],["T_FUNCTION","function",175],["T_WHITESPACE"," ",175],["T_STRING","_getAllowedAttemptsFromSameIp",175],"(",")",["T_WHITESPACE","\n    ",175],"{",["T_WHITESPACE","\n        ",176],["T_RETURN","return",177],["T_WHITESPACE"," ",177],["T_INT_CAST","(int)",177],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","_captchaData",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","getConfig",177],"(",["T_CONSTANT_ENCAPSED_STRING","'failed_attempts_ip'",177],")",";",["T_WHITESPACE","\n    ",177],"}",["T_WHITESPACE","\n\n    ",178],["T_DOC_COMMENT","\/**\n     * Check is overlimit saved attempts from one ip\n     *\n     * @return bool\n     *\/",180],["T_WHITESPACE","\n    ",184],["T_PROTECTED","protected",185],["T_WHITESPACE"," ",185],["T_FUNCTION","function",185],["T_WHITESPACE"," ",185],["T_STRING","_isOverLimitIpAttempt",185],"(",")",["T_WHITESPACE","\n    ",185],"{",["T_WHITESPACE","\n        ",186],["T_VARIABLE","$countAttemptsByIp",187],["T_WHITESPACE"," ",187],"=",["T_WHITESPACE"," ",187],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","_getResourceModel",187],"(",")",["T_OBJECT_OPERATOR","->",187],["T_STRING","countAttemptsByRemoteAddress",187],"(",")",";",["T_WHITESPACE","\n        ",187],["T_RETURN","return",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$countAttemptsByIp",188],["T_WHITESPACE"," ",188],["T_IS_GREATER_OR_EQUAL",">=",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","_getAllowedAttemptsFromSameIp",188],"(",")",";",["T_WHITESPACE","\n    ",188],"}",["T_WHITESPACE","\n\n    ",189],["T_DOC_COMMENT","\/**\n     * Is Over Limit Login Attempts\n     *\n     * @param string $login\n     * @return bool\n     *\/",191],["T_WHITESPACE","\n    ",196],["T_PROTECTED","protected",197],["T_WHITESPACE"," ",197],["T_FUNCTION","function",197],["T_WHITESPACE"," ",197],["T_STRING","_isOverLimitLoginAttempts",197],"(",["T_VARIABLE","$login",197],")",["T_WHITESPACE","\n    ",197],"{",["T_WHITESPACE","\n        ",198],["T_IF","if",199],["T_WHITESPACE"," ",199],"(",["T_VARIABLE","$login",199],["T_WHITESPACE"," ",199],["T_IS_NOT_EQUAL","!=",199],["T_WHITESPACE"," ",199],["T_STRING","false",199],")",["T_WHITESPACE"," ",199],"{",["T_WHITESPACE","\n            ",199],["T_VARIABLE","$countAttemptsByLogin",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","_getResourceModel",200],"(",")",["T_OBJECT_OPERATOR","->",200],["T_STRING","countAttemptsByUserLogin",200],"(",["T_VARIABLE","$login",200],")",";",["T_WHITESPACE","\n            ",200],["T_RETURN","return",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$countAttemptsByLogin",201],["T_WHITESPACE"," ",201],["T_IS_GREATER_OR_EQUAL",">=",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","_getAllowedAttemptsForSameLogin",201],"(",")",";",["T_WHITESPACE","\n        ",201],"}",["T_WHITESPACE","\n        ",202],["T_RETURN","return",203],["T_WHITESPACE"," ",203],["T_STRING","false",203],";",["T_WHITESPACE","\n    ",203],"}",["T_WHITESPACE","\n\n    ",204],["T_DOC_COMMENT","\/**\n     * Check is user auth\n     *\n     * @return bool\n     *\/",206],["T_WHITESPACE","\n    ",210],["T_PROTECTED","protected",211],["T_WHITESPACE"," ",211],["T_FUNCTION","function",211],["T_WHITESPACE"," ",211],["T_STRING","_isUserAuth",211],"(",")",["T_WHITESPACE","\n    ",211],"{",["T_WHITESPACE","\n        ",212],["T_RETURN","return",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","_session",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","isLoggedIn",213],"(",")",";",["T_WHITESPACE","\n    ",213],"}",["T_WHITESPACE","\n\n    ",214],["T_DOC_COMMENT","\/**\n     * Whether to respect case while checking the answer\n     *\n     * @return bool\n     *\/",216],["T_WHITESPACE","\n    ",220],["T_PUBLIC","public",221],["T_WHITESPACE"," ",221],["T_FUNCTION","function",221],["T_WHITESPACE"," ",221],["T_STRING","isCaseSensitive",221],"(",")",["T_WHITESPACE","\n    ",221],"{",["T_WHITESPACE","\n        ",222],["T_RETURN","return",223],["T_WHITESPACE"," ",223],["T_STRING_CAST","(string)",223],["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","_captchaData",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","getConfig",223],"(",["T_CONSTANT_ENCAPSED_STRING","'case_sensitive'",223],")",";",["T_WHITESPACE","\n    ",223],"}",["T_WHITESPACE","\n\n    ",224],["T_DOC_COMMENT","\/**\n     * Get font to use when generating captcha\n     *\n     * @return string\n     *\/",226],["T_WHITESPACE","\n    ",230],["T_PUBLIC","public",231],["T_WHITESPACE"," ",231],["T_FUNCTION","function",231],["T_WHITESPACE"," ",231],["T_STRING","getFont",231],"(",")",["T_WHITESPACE","\n    ",231],"{",["T_WHITESPACE","\n        ",232],["T_VARIABLE","$font",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_STRING_CAST","(string)",233],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","_captchaData",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","getConfig",233],"(",["T_CONSTANT_ENCAPSED_STRING","'font'",233],")",";",["T_WHITESPACE","\n        ",233],["T_VARIABLE","$fonts",234],["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","_captchaData",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","getFonts",234],"(",")",";",["T_WHITESPACE","\n\n        ",234],["T_IF","if",236],["T_WHITESPACE"," ",236],"(",["T_ISSET","isset",236],"(",["T_VARIABLE","$fonts",236],"[",["T_VARIABLE","$font",236],"]",")",")",["T_WHITESPACE"," ",236],"{",["T_WHITESPACE","\n            ",236],["T_VARIABLE","$fontPath",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_VARIABLE","$fonts",237],"[",["T_VARIABLE","$font",237],"]","[",["T_CONSTANT_ENCAPSED_STRING","'path'",237],"]",";",["T_WHITESPACE","\n        ",237],"}",["T_WHITESPACE"," ",238],["T_ELSE","else",238],["T_WHITESPACE"," ",238],"{",["T_WHITESPACE","\n            ",238],["T_VARIABLE","$fontData",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_STRING","array_shift",239],"(",["T_VARIABLE","$fonts",239],")",";",["T_WHITESPACE","\n            ",239],["T_VARIABLE","$fontPath",240],["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],["T_VARIABLE","$fontData",240],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",240],"]",";",["T_WHITESPACE","\n        ",240],"}",["T_WHITESPACE","\n\n        ",241],["T_RETURN","return",243],["T_WHITESPACE"," ",243],["T_VARIABLE","$fontPath",243],";",["T_WHITESPACE","\n    ",243],"}",["T_WHITESPACE","\n\n    ",244],["T_DOC_COMMENT","\/**\n     * After this time isCorrect() is going to return FALSE even if word was guessed correctly\n     *\n     * @return int\n     *\/",246],["T_WHITESPACE","\n    ",250],["T_PUBLIC","public",251],["T_WHITESPACE"," ",251],["T_FUNCTION","function",251],["T_WHITESPACE"," ",251],["T_STRING","getExpiration",251],"(",")",["T_WHITESPACE","\n    ",251],"{",["T_WHITESPACE","\n        ",252],["T_IF","if",253],["T_WHITESPACE"," ",253],"(","!",["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","_expiration",253],")",["T_WHITESPACE"," ",253],"{",["T_WHITESPACE","\n            ",253],["T_DOC_COMMENT","\/**\n             * as \"timeout\" configuration parameter specifies timeout in minutes - we multiply it on 60 to set\n             * expiration in seconds\n             *\/",254],["T_WHITESPACE","\n            ",257],["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","_expiration",258],["T_WHITESPACE"," ",258],"=",["T_WHITESPACE"," ",258],["T_INT_CAST","(int)",258],["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","_captchaData",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","getConfig",258],"(",["T_CONSTANT_ENCAPSED_STRING","'timeout'",258],")",["T_WHITESPACE"," ",258],"*",["T_WHITESPACE"," ",258],["T_LNUMBER","60",258],";",["T_WHITESPACE","\n        ",258],"}",["T_WHITESPACE","\n        ",259],["T_RETURN","return",260],["T_WHITESPACE"," ",260],["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","_expiration",260],";",["T_WHITESPACE","\n    ",260],"}",["T_WHITESPACE","\n\n    ",261],["T_DOC_COMMENT","\/**\n     * Get timeout for session token\n     *\n     * @return int\n     *\/",263],["T_WHITESPACE","\n    ",267],["T_PUBLIC","public",268],["T_WHITESPACE"," ",268],["T_FUNCTION","function",268],["T_WHITESPACE"," ",268],["T_STRING","getTimeout",268],"(",")",["T_WHITESPACE","\n    ",268],"{",["T_WHITESPACE","\n        ",269],["T_RETURN","return",270],["T_WHITESPACE"," ",270],["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","getExpiration",270],"(",")",";",["T_WHITESPACE","\n    ",270],"}",["T_WHITESPACE","\n\n    ",271],["T_DOC_COMMENT","\/**\n     * Get captcha image directory\n     *\n     * @return string\n     *\/",273],["T_WHITESPACE","\n    ",277],["T_PUBLIC","public",278],["T_WHITESPACE"," ",278],["T_FUNCTION","function",278],["T_WHITESPACE"," ",278],["T_STRING","getImgDir",278],"(",")",["T_WHITESPACE","\n    ",278],"{",["T_WHITESPACE","\n        ",279],["T_RETURN","return",280],["T_WHITESPACE"," ",280],["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","_captchaData",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","getImgDir",280],"(",")",";",["T_WHITESPACE","\n    ",280],"}",["T_WHITESPACE","\n\n    ",281],["T_DOC_COMMENT","\/**\n     * Get captcha image base URL\n     *\n     * @return string\n     *\/",283],["T_WHITESPACE","\n    ",287],["T_PUBLIC","public",288],["T_WHITESPACE"," ",288],["T_FUNCTION","function",288],["T_WHITESPACE"," ",288],["T_STRING","getImgUrl",288],"(",")",["T_WHITESPACE","\n    ",288],"{",["T_WHITESPACE","\n        ",289],["T_RETURN","return",290],["T_WHITESPACE"," ",290],["T_VARIABLE","$this",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","_captchaData",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","getImgUrl",290],"(",")",";",["T_WHITESPACE","\n    ",290],"}",["T_WHITESPACE","\n\n    ",291],["T_DOC_COMMENT","\/**\n     * Checks whether captcha was guessed correctly by user\n     *\n     * @param string $word\n     * @return bool\n     *\/",293],["T_WHITESPACE","\n    ",298],["T_PUBLIC","public",299],["T_WHITESPACE"," ",299],["T_FUNCTION","function",299],["T_WHITESPACE"," ",299],["T_STRING","isCorrect",299],"(",["T_VARIABLE","$word",299],")",["T_WHITESPACE","\n    ",299],"{",["T_WHITESPACE","\n        ",300],["T_VARIABLE","$storedWord",301],["T_WHITESPACE"," ",301],"=",["T_WHITESPACE"," ",301],["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","getWord",301],"(",")",";",["T_WHITESPACE","\n        ",301],["T_VARIABLE","$this",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","_clearWord",302],"(",")",";",["T_WHITESPACE","\n\n        ",302],["T_IF","if",304],["T_WHITESPACE"," ",304],"(","!",["T_VARIABLE","$word",304],["T_WHITESPACE"," ",304],["T_BOOLEAN_OR","||",304],["T_WHITESPACE"," ",304],"!",["T_VARIABLE","$storedWord",304],")",["T_WHITESPACE"," ",304],"{",["T_WHITESPACE","\n            ",304],["T_RETURN","return",305],["T_WHITESPACE"," ",305],["T_STRING","false",305],";",["T_WHITESPACE","\n        ",305],"}",["T_WHITESPACE","\n\n        ",306],["T_IF","if",308],["T_WHITESPACE"," ",308],"(","!",["T_VARIABLE","$this",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","isCaseSensitive",308],"(",")",")",["T_WHITESPACE"," ",308],"{",["T_WHITESPACE","\n            ",308],["T_VARIABLE","$storedWord",309],["T_WHITESPACE"," ",309],"=",["T_WHITESPACE"," ",309],["T_STRING","strtolower",309],"(",["T_VARIABLE","$storedWord",309],")",";",["T_WHITESPACE","\n            ",309],["T_VARIABLE","$word",310],["T_WHITESPACE"," ",310],"=",["T_WHITESPACE"," ",310],["T_STRING","strtolower",310],"(",["T_VARIABLE","$word",310],")",";",["T_WHITESPACE","\n        ",310],"}",["T_WHITESPACE","\n        ",311],["T_RETURN","return",312],["T_WHITESPACE"," ",312],["T_VARIABLE","$word",312],["T_WHITESPACE"," ",312],["T_IS_IDENTICAL","===",312],["T_WHITESPACE"," ",312],["T_VARIABLE","$storedWord",312],";",["T_WHITESPACE","\n    ",312],"}",["T_WHITESPACE","\n\n    ",313],["T_DOC_COMMENT","\/**\n     * Return full URL to captcha image\n     *\n     * @return string\n     *\/",315],["T_WHITESPACE","\n    ",319],["T_PUBLIC","public",320],["T_WHITESPACE"," ",320],["T_FUNCTION","function",320],["T_WHITESPACE"," ",320],["T_STRING","getImgSrc",320],"(",")",["T_WHITESPACE","\n    ",320],"{",["T_WHITESPACE","\n        ",321],["T_RETURN","return",322],["T_WHITESPACE"," ",322],["T_VARIABLE","$this",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","getImgUrl",322],"(",")",["T_WHITESPACE"," ",322],".",["T_WHITESPACE"," ",322],["T_VARIABLE","$this",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","getId",322],"(",")",["T_WHITESPACE"," ",322],".",["T_WHITESPACE"," ",322],["T_VARIABLE","$this",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","getSuffix",322],"(",")",";",["T_WHITESPACE","\n    ",322],"}",["T_WHITESPACE","\n\n    ",323],["T_DOC_COMMENT","\/**\n     * Log attempt\n     *\n     * @param string $login\n     * @return $this\n     *\/",325],["T_WHITESPACE","\n    ",330],["T_PUBLIC","public",331],["T_WHITESPACE"," ",331],["T_FUNCTION","function",331],["T_WHITESPACE"," ",331],["T_STRING","logAttempt",331],"(",["T_VARIABLE","$login",331],")",["T_WHITESPACE","\n    ",331],"{",["T_WHITESPACE","\n        ",332],["T_IF","if",333],["T_WHITESPACE"," ",333],"(",["T_VARIABLE","$this",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","_isEnabled",333],"(",")",["T_WHITESPACE"," ",333],["T_BOOLEAN_AND","&&",333],["T_WHITESPACE"," ",333],["T_STRING","in_array",333],"(",["T_VARIABLE","$this",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","_formId",333],",",["T_WHITESPACE"," ",333],["T_VARIABLE","$this",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","_getTargetForms",333],"(",")",")",")",["T_WHITESPACE"," ",333],"{",["T_WHITESPACE","\n            ",333],["T_VARIABLE","$this",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","_getResourceModel",334],"(",")",["T_OBJECT_OPERATOR","->",334],["T_STRING","logAttempt",334],"(",["T_VARIABLE","$login",334],")",";",["T_WHITESPACE","\n            ",334],["T_IF","if",335],["T_WHITESPACE"," ",335],"(",["T_VARIABLE","$this",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","_isOverLimitLoginAttempts",335],"(",["T_VARIABLE","$login",335],")",")",["T_WHITESPACE"," ",335],"{",["T_WHITESPACE","\n                ",335],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","setShowCaptchaInSession",336],"(",["T_STRING","true",336],")",";",["T_WHITESPACE","\n            ",336],"}",["T_WHITESPACE","\n        ",337],"}",["T_WHITESPACE","\n        ",338],["T_RETURN","return",339],["T_WHITESPACE"," ",339],["T_VARIABLE","$this",339],";",["T_WHITESPACE","\n    ",339],"}",["T_WHITESPACE","\n\n    ",340],["T_DOC_COMMENT","\/**\n     * Set show_captcha flag in session\n     *\n     * @param bool $value\n     * @return void\n     *\/",342],["T_WHITESPACE","\n    ",347],["T_PUBLIC","public",348],["T_WHITESPACE"," ",348],["T_FUNCTION","function",348],["T_WHITESPACE"," ",348],["T_STRING","setShowCaptchaInSession",348],"(",["T_VARIABLE","$value",348],["T_WHITESPACE"," ",348],"=",["T_WHITESPACE"," ",348],["T_STRING","true",348],")",["T_WHITESPACE","\n    ",348],"{",["T_WHITESPACE","\n        ",349],["T_IF","if",350],["T_WHITESPACE"," ",350],"(",["T_VARIABLE","$value",350],["T_WHITESPACE"," ",350],["T_IS_NOT_IDENTICAL","!==",350],["T_WHITESPACE"," ",350],["T_STRING","true",350],")",["T_WHITESPACE"," ",350],"{",["T_WHITESPACE","\n            ",350],["T_VARIABLE","$value",351],["T_WHITESPACE"," ",351],"=",["T_WHITESPACE"," ",351],["T_STRING","false",351],";",["T_WHITESPACE","\n        ",351],"}",["T_WHITESPACE","\n\n        ",352],["T_VARIABLE","$this",354],["T_OBJECT_OPERATOR","->",354],["T_STRING","_session",354],["T_OBJECT_OPERATOR","->",354],["T_STRING","setData",354],"(",["T_VARIABLE","$this",354],["T_OBJECT_OPERATOR","->",354],["T_STRING","_getFormIdKey",354],"(",["T_CONSTANT_ENCAPSED_STRING","'show_captcha'",354],")",",",["T_WHITESPACE"," ",354],["T_VARIABLE","$value",354],")",";",["T_WHITESPACE","\n    ",354],"}",["T_WHITESPACE","\n\n    ",355],["T_DOC_COMMENT","\/**\n     * Generate word used for captcha render\n     *\n     * @return string\n     *\/",357],["T_WHITESPACE","\n    ",361],["T_PROTECTED","protected",362],["T_WHITESPACE"," ",362],["T_FUNCTION","function",362],["T_WHITESPACE"," ",362],["T_STRING","_generateWord",362],"(",")",["T_WHITESPACE","\n    ",362],"{",["T_WHITESPACE","\n        ",363],["T_VARIABLE","$word",364],["T_WHITESPACE"," ",364],"=",["T_WHITESPACE"," ",364],["T_CONSTANT_ENCAPSED_STRING","''",364],";",["T_WHITESPACE","\n        ",364],["T_VARIABLE","$symbols",365],["T_WHITESPACE"," ",365],"=",["T_WHITESPACE"," ",365],["T_VARIABLE","$this",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","_getSymbols",365],"(",")",";",["T_WHITESPACE","\n        ",365],["T_VARIABLE","$wordLen",366],["T_WHITESPACE"," ",366],"=",["T_WHITESPACE"," ",366],["T_VARIABLE","$this",366],["T_OBJECT_OPERATOR","->",366],["T_STRING","_getWordLen",366],"(",")",";",["T_WHITESPACE","\n        ",366],["T_FOR","for",367],["T_WHITESPACE"," ",367],"(",["T_VARIABLE","$i",367],["T_WHITESPACE"," ",367],"=",["T_WHITESPACE"," ",367],["T_LNUMBER","0",367],";",["T_WHITESPACE"," ",367],["T_VARIABLE","$i",367],["T_WHITESPACE"," ",367],"<",["T_WHITESPACE"," ",367],["T_VARIABLE","$wordLen",367],";",["T_WHITESPACE"," ",367],["T_VARIABLE","$i",367],["T_INC","++",367],")",["T_WHITESPACE"," ",367],"{",["T_WHITESPACE","\n            ",367],["T_VARIABLE","$word",368],["T_WHITESPACE"," ",368],["T_CONCAT_EQUAL",".=",368],["T_WHITESPACE"," ",368],["T_VARIABLE","$symbols",368],"[",["T_STRING","array_rand",368],"(",["T_VARIABLE","$symbols",368],")","]",";",["T_WHITESPACE","\n        ",368],"}",["T_WHITESPACE","\n        ",369],["T_RETURN","return",370],["T_WHITESPACE"," ",370],["T_VARIABLE","$word",370],";",["T_WHITESPACE","\n    ",370],"}",["T_WHITESPACE","\n\n    ",371],["T_DOC_COMMENT","\/**\n     * Get symbols array to use for word generation\n     *\n     * @return array\n     *\/",373],["T_WHITESPACE","\n    ",377],["T_PROTECTED","protected",378],["T_WHITESPACE"," ",378],["T_FUNCTION","function",378],["T_WHITESPACE"," ",378],["T_STRING","_getSymbols",378],"(",")",["T_WHITESPACE","\n    ",378],"{",["T_WHITESPACE","\n        ",379],["T_RETURN","return",380],["T_WHITESPACE"," ",380],["T_STRING","str_split",380],"(",["T_STRING_CAST","(string)",380],["T_VARIABLE","$this",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","_captchaData",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","getConfig",380],"(",["T_CONSTANT_ENCAPSED_STRING","'symbols'",380],")",")",";",["T_WHITESPACE","\n    ",380],"}",["T_WHITESPACE","\n\n    ",381],["T_DOC_COMMENT","\/**\n     * Returns length for generating captcha word. This value may be dynamic.\n     *\n     * @return int\n     *\/",383],["T_WHITESPACE","\n    ",387],["T_PROTECTED","protected",388],["T_WHITESPACE"," ",388],["T_FUNCTION","function",388],["T_WHITESPACE"," ",388],["T_STRING","_getWordLen",388],"(",")",["T_WHITESPACE","\n    ",388],"{",["T_WHITESPACE","\n        ",389],["T_VARIABLE","$from",390],["T_WHITESPACE"," ",390],"=",["T_WHITESPACE"," ",390],["T_LNUMBER","0",390],";",["T_WHITESPACE","\n        ",390],["T_VARIABLE","$to",391],["T_WHITESPACE"," ",391],"=",["T_WHITESPACE"," ",391],["T_LNUMBER","0",391],";",["T_WHITESPACE","\n        ",391],["T_VARIABLE","$length",392],["T_WHITESPACE"," ",392],"=",["T_WHITESPACE"," ",392],["T_STRING_CAST","(string)",392],["T_VARIABLE","$this",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","_captchaData",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","getConfig",392],"(",["T_CONSTANT_ENCAPSED_STRING","'length'",392],")",";",["T_WHITESPACE","\n        ",392],["T_IF","if",393],["T_WHITESPACE"," ",393],"(","!",["T_STRING","is_numeric",393],"(",["T_VARIABLE","$length",393],")",")",["T_WHITESPACE"," ",393],"{",["T_WHITESPACE","\n            ",393],["T_IF","if",394],["T_WHITESPACE"," ",394],"(",["T_STRING","preg_match",394],"(",["T_CONSTANT_ENCAPSED_STRING","'\/(\\d+)-(\\d+)\/'",394],",",["T_WHITESPACE"," ",394],["T_VARIABLE","$length",394],",",["T_WHITESPACE"," ",394],["T_VARIABLE","$matches",394],")",")",["T_WHITESPACE"," ",394],"{",["T_WHITESPACE","\n                ",394],["T_VARIABLE","$from",395],["T_WHITESPACE"," ",395],"=",["T_WHITESPACE"," ",395],["T_INT_CAST","(int)",395],["T_VARIABLE","$matches",395],"[",["T_LNUMBER","1",395],"]",";",["T_WHITESPACE","\n                ",395],["T_VARIABLE","$to",396],["T_WHITESPACE"," ",396],"=",["T_WHITESPACE"," ",396],["T_INT_CAST","(int)",396],["T_VARIABLE","$matches",396],"[",["T_LNUMBER","2",396],"]",";",["T_WHITESPACE","\n            ",396],"}",["T_WHITESPACE","\n        ",397],"}",["T_WHITESPACE"," ",398],["T_ELSE","else",398],["T_WHITESPACE"," ",398],"{",["T_WHITESPACE","\n            ",398],["T_VARIABLE","$from",399],["T_WHITESPACE"," ",399],"=",["T_WHITESPACE"," ",399],["T_INT_CAST","(int)",399],["T_VARIABLE","$length",399],";",["T_WHITESPACE","\n            ",399],["T_VARIABLE","$to",400],["T_WHITESPACE"," ",400],"=",["T_WHITESPACE"," ",400],["T_INT_CAST","(int)",400],["T_VARIABLE","$length",400],";",["T_WHITESPACE","\n        ",400],"}",["T_WHITESPACE","\n\n        ",401],["T_IF","if",403],["T_WHITESPACE"," ",403],"(",["T_VARIABLE","$to",403],["T_WHITESPACE"," ",403],"<",["T_WHITESPACE"," ",403],["T_VARIABLE","$from",403],["T_WHITESPACE"," ",403],["T_BOOLEAN_OR","||",403],["T_WHITESPACE"," ",403],["T_VARIABLE","$from",403],["T_WHITESPACE"," ",403],"<",["T_WHITESPACE"," ",403],["T_LNUMBER","1",403],["T_WHITESPACE"," ",403],["T_BOOLEAN_OR","||",403],["T_WHITESPACE"," ",403],["T_VARIABLE","$to",403],["T_WHITESPACE"," ",403],"<",["T_WHITESPACE"," ",403],["T_LNUMBER","1",403],")",["T_WHITESPACE"," ",403],"{",["T_WHITESPACE","\n            ",403],["T_VARIABLE","$from",404],["T_WHITESPACE"," ",404],"=",["T_WHITESPACE"," ",404],["T_STRING","self",404],["T_DOUBLE_COLON","::",404],["T_STRING","DEFAULT_WORD_LENGTH_FROM",404],";",["T_WHITESPACE","\n            ",404],["T_VARIABLE","$to",405],["T_WHITESPACE"," ",405],"=",["T_WHITESPACE"," ",405],["T_STRING","self",405],["T_DOUBLE_COLON","::",405],["T_STRING","DEFAULT_WORD_LENGTH_TO",405],";",["T_WHITESPACE","\n        ",405],"}",["T_WHITESPACE","\n\n        ",406],["T_RETURN","return",408],["T_WHITESPACE"," ",408],["T_NS_SEPARATOR","\\",408],["T_STRING","Magento",408],["T_NS_SEPARATOR","\\",408],["T_STRING","Framework",408],["T_NS_SEPARATOR","\\",408],["T_STRING","Math",408],["T_NS_SEPARATOR","\\",408],["T_STRING","Random",408],["T_DOUBLE_COLON","::",408],["T_STRING","getRandomNumber",408],"(",["T_VARIABLE","$from",408],",",["T_WHITESPACE"," ",408],["T_VARIABLE","$to",408],")",";",["T_WHITESPACE","\n    ",408],"}",["T_WHITESPACE","\n\n    ",409],["T_DOC_COMMENT","\/**\n     * Whether to show captcha for this form every time\n     *\n     * @return bool\n     *\/",411],["T_WHITESPACE","\n    ",415],["T_PROTECTED","protected",416],["T_WHITESPACE"," ",416],["T_FUNCTION","function",416],["T_WHITESPACE"," ",416],["T_STRING","_isShowAlways",416],"(",")",["T_WHITESPACE","\n    ",416],"{",["T_WHITESPACE","\n        ",417],["T_IF","if",418],["T_WHITESPACE"," ",418],"(",["T_STRING_CAST","(string)",418],["T_VARIABLE","$this",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","_captchaData",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","getConfig",418],"(",["T_CONSTANT_ENCAPSED_STRING","'mode'",418],")",["T_WHITESPACE"," ",418],["T_IS_EQUAL","==",418],["T_WHITESPACE"," ",418],["T_NS_SEPARATOR","\\",418],["T_STRING","Magento",418],["T_NS_SEPARATOR","\\",418],["T_STRING","Captcha",418],["T_NS_SEPARATOR","\\",418],["T_STRING","Helper",418],["T_NS_SEPARATOR","\\",418],["T_STRING","Data",418],["T_DOUBLE_COLON","::",418],["T_STRING","MODE_ALWAYS",418],")",["T_WHITESPACE"," ",418],"{",["T_WHITESPACE","\n            ",418],["T_RETURN","return",419],["T_WHITESPACE"," ",419],["T_STRING","true",419],";",["T_WHITESPACE","\n        ",419],"}",["T_WHITESPACE","\n\n        ",420],["T_IF","if",422],["T_WHITESPACE"," ",422],"(",["T_STRING_CAST","(string)",422],["T_VARIABLE","$this",422],["T_OBJECT_OPERATOR","->",422],["T_STRING","_captchaData",422],["T_OBJECT_OPERATOR","->",422],["T_STRING","getConfig",422],"(",["T_WHITESPACE","\n            ",422],["T_CONSTANT_ENCAPSED_STRING","'mode'",423],["T_WHITESPACE","\n        ",423],")",["T_WHITESPACE"," ",424],["T_IS_EQUAL","==",424],["T_WHITESPACE"," ",424],["T_NS_SEPARATOR","\\",424],["T_STRING","Magento",424],["T_NS_SEPARATOR","\\",424],["T_STRING","Captcha",424],["T_NS_SEPARATOR","\\",424],["T_STRING","Helper",424],["T_NS_SEPARATOR","\\",424],["T_STRING","Data",424],["T_DOUBLE_COLON","::",424],["T_STRING","MODE_AFTER_FAIL",424],["T_WHITESPACE"," ",424],["T_BOOLEAN_AND","&&",424],["T_WHITESPACE"," ",424],["T_VARIABLE","$this",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","_getAllowedAttemptsForSameLogin",424],"(",")",["T_WHITESPACE"," ",424],["T_IS_EQUAL","==",424],["T_WHITESPACE"," ",424],["T_LNUMBER","0",424],["T_WHITESPACE","\n        ",424],")",["T_WHITESPACE"," ",425],"{",["T_WHITESPACE","\n            ",425],["T_RETURN","return",426],["T_WHITESPACE"," ",426],["T_STRING","true",426],";",["T_WHITESPACE","\n        ",426],"}",["T_WHITESPACE","\n\n        ",427],["T_VARIABLE","$alwaysFor",429],["T_WHITESPACE"," ",429],"=",["T_WHITESPACE"," ",429],["T_VARIABLE","$this",429],["T_OBJECT_OPERATOR","->",429],["T_STRING","_captchaData",429],["T_OBJECT_OPERATOR","->",429],["T_STRING","getConfig",429],"(",["T_CONSTANT_ENCAPSED_STRING","'always_for'",429],")",";",["T_WHITESPACE","\n        ",429],["T_FOREACH","foreach",430],["T_WHITESPACE"," ",430],"(",["T_VARIABLE","$alwaysFor",430],["T_WHITESPACE"," ",430],["T_AS","as",430],["T_WHITESPACE"," ",430],["T_VARIABLE","$nodeFormId",430],["T_WHITESPACE"," ",430],["T_DOUBLE_ARROW","=>",430],["T_WHITESPACE"," ",430],["T_VARIABLE","$isAlwaysFor",430],")",["T_WHITESPACE"," ",430],"{",["T_WHITESPACE","\n            ",430],["T_IF","if",431],["T_WHITESPACE"," ",431],"(",["T_VARIABLE","$isAlwaysFor",431],["T_WHITESPACE"," ",431],["T_BOOLEAN_AND","&&",431],["T_WHITESPACE"," ",431],["T_VARIABLE","$this",431],["T_OBJECT_OPERATOR","->",431],["T_STRING","_formId",431],["T_WHITESPACE"," ",431],["T_IS_EQUAL","==",431],["T_WHITESPACE"," ",431],["T_VARIABLE","$nodeFormId",431],")",["T_WHITESPACE"," ",431],"{",["T_WHITESPACE","\n                ",431],["T_RETURN","return",432],["T_WHITESPACE"," ",432],["T_STRING","true",432],";",["T_WHITESPACE","\n            ",432],"}",["T_WHITESPACE","\n        ",433],"}",["T_WHITESPACE","\n\n        ",434],["T_RETURN","return",436],["T_WHITESPACE"," ",436],["T_STRING","false",436],";",["T_WHITESPACE","\n    ",436],"}",["T_WHITESPACE","\n\n    ",437],["T_DOC_COMMENT","\/**\n     * Whether captcha is enabled at this area\n     *\n     * @return bool\n     *\/",439],["T_WHITESPACE","\n    ",443],["T_PROTECTED","protected",444],["T_WHITESPACE"," ",444],["T_FUNCTION","function",444],["T_WHITESPACE"," ",444],["T_STRING","_isEnabled",444],"(",")",["T_WHITESPACE","\n    ",444],"{",["T_WHITESPACE","\n        ",445],["T_RETURN","return",446],["T_WHITESPACE"," ",446],["T_STRING_CAST","(string)",446],["T_VARIABLE","$this",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","_captchaData",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","getConfig",446],"(",["T_CONSTANT_ENCAPSED_STRING","'enable'",446],")",";",["T_WHITESPACE","\n    ",446],"}",["T_WHITESPACE","\n\n    ",447],["T_DOC_COMMENT","\/**\n     * Retrieve list of forms where captcha must be shown\n     *\n     * For frontend this list is based on current website\n     *\n     * @return array\n     *\/",449],["T_WHITESPACE","\n    ",455],["T_PROTECTED","protected",456],["T_WHITESPACE"," ",456],["T_FUNCTION","function",456],["T_WHITESPACE"," ",456],["T_STRING","_getTargetForms",456],"(",")",["T_WHITESPACE","\n    ",456],"{",["T_WHITESPACE","\n        ",457],["T_VARIABLE","$formsString",458],["T_WHITESPACE"," ",458],"=",["T_WHITESPACE"," ",458],["T_STRING_CAST","(string)",458],["T_VARIABLE","$this",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","_captchaData",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","getConfig",458],"(",["T_CONSTANT_ENCAPSED_STRING","'forms'",458],")",";",["T_WHITESPACE","\n        ",458],["T_RETURN","return",459],["T_WHITESPACE"," ",459],["T_STRING","explode",459],"(",["T_CONSTANT_ENCAPSED_STRING","','",459],",",["T_WHITESPACE"," ",459],["T_VARIABLE","$formsString",459],")",";",["T_WHITESPACE","\n    ",459],"}",["T_WHITESPACE","\n\n    ",460],["T_DOC_COMMENT","\/**\n     * Get captcha word\n     *\n     * @return string\n     *\/",462],["T_WHITESPACE","\n    ",466],["T_PUBLIC","public",467],["T_WHITESPACE"," ",467],["T_FUNCTION","function",467],["T_WHITESPACE"," ",467],["T_STRING","getWord",467],"(",")",["T_WHITESPACE","\n    ",467],"{",["T_WHITESPACE","\n        ",468],["T_VARIABLE","$sessionData",469],["T_WHITESPACE"," ",469],"=",["T_WHITESPACE"," ",469],["T_VARIABLE","$this",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","_session",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","getData",469],"(",["T_VARIABLE","$this",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","_getFormIdKey",469],"(",["T_STRING","self",469],["T_DOUBLE_COLON","::",469],["T_STRING","SESSION_WORD",469],")",")",";",["T_WHITESPACE","\n        ",469],["T_RETURN","return",470],["T_WHITESPACE"," ",470],["T_STRING","time",470],"(",")",["T_WHITESPACE"," ",470],"<",["T_WHITESPACE"," ",470],["T_VARIABLE","$sessionData",470],"[",["T_CONSTANT_ENCAPSED_STRING","'expires'",470],"]",["T_WHITESPACE"," ",470],"?",["T_WHITESPACE"," ",470],["T_VARIABLE","$sessionData",470],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",470],"]",["T_WHITESPACE"," ",470],":",["T_WHITESPACE"," ",470],["T_STRING","null",470],";",["T_WHITESPACE","\n    ",470],"}",["T_WHITESPACE","\n\n    ",471],["T_DOC_COMMENT","\/**\n     * Set captcha word\n     *\n     * @param  string $word\n     * @return $this\n     *\/",473],["T_WHITESPACE","\n    ",478],["T_PROTECTED","protected",479],["T_WHITESPACE"," ",479],["T_FUNCTION","function",479],["T_WHITESPACE"," ",479],["T_STRING","_setWord",479],"(",["T_VARIABLE","$word",479],")",["T_WHITESPACE","\n    ",479],"{",["T_WHITESPACE","\n        ",480],["T_VARIABLE","$this",481],["T_OBJECT_OPERATOR","->",481],["T_STRING","_session",481],["T_OBJECT_OPERATOR","->",481],["T_STRING","setData",481],"(",["T_WHITESPACE","\n            ",481],["T_VARIABLE","$this",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","_getFormIdKey",482],"(",["T_STRING","self",482],["T_DOUBLE_COLON","::",482],["T_STRING","SESSION_WORD",482],")",",",["T_WHITESPACE","\n            ",482],"[",["T_CONSTANT_ENCAPSED_STRING","'data'",483],["T_WHITESPACE"," ",483],["T_DOUBLE_ARROW","=>",483],["T_WHITESPACE"," ",483],["T_VARIABLE","$word",483],",",["T_WHITESPACE"," ",483],["T_CONSTANT_ENCAPSED_STRING","'expires'",483],["T_WHITESPACE"," ",483],["T_DOUBLE_ARROW","=>",483],["T_WHITESPACE"," ",483],["T_STRING","time",483],"(",")",["T_WHITESPACE"," ",483],"+",["T_WHITESPACE"," ",483],["T_VARIABLE","$this",483],["T_OBJECT_OPERATOR","->",483],["T_STRING","getTimeout",483],"(",")","]",["T_WHITESPACE","\n        ",483],")",";",["T_WHITESPACE","\n        ",484],["T_VARIABLE","$this",485],["T_OBJECT_OPERATOR","->",485],["T_STRING","_word",485],["T_WHITESPACE"," ",485],"=",["T_WHITESPACE"," ",485],["T_VARIABLE","$word",485],";",["T_WHITESPACE","\n        ",485],["T_RETURN","return",486],["T_WHITESPACE"," ",486],["T_VARIABLE","$this",486],";",["T_WHITESPACE","\n    ",486],"}",["T_WHITESPACE","\n\n    ",487],["T_DOC_COMMENT","\/**\n     * Set captcha word\n     *\n     * @return $this\n     *\/",489],["T_WHITESPACE","\n    ",493],["T_PROTECTED","protected",494],["T_WHITESPACE"," ",494],["T_FUNCTION","function",494],["T_WHITESPACE"," ",494],["T_STRING","_clearWord",494],"(",")",["T_WHITESPACE","\n    ",494],"{",["T_WHITESPACE","\n        ",495],["T_VARIABLE","$this",496],["T_OBJECT_OPERATOR","->",496],["T_STRING","_session",496],["T_OBJECT_OPERATOR","->",496],["T_STRING","unsetData",496],"(",["T_VARIABLE","$this",496],["T_OBJECT_OPERATOR","->",496],["T_STRING","_getFormIdKey",496],"(",["T_STRING","self",496],["T_DOUBLE_COLON","::",496],["T_STRING","SESSION_WORD",496],")",")",";",["T_WHITESPACE","\n        ",496],["T_VARIABLE","$this",497],["T_OBJECT_OPERATOR","->",497],["T_STRING","_word",497],["T_WHITESPACE"," ",497],"=",["T_WHITESPACE"," ",497],["T_STRING","null",497],";",["T_WHITESPACE","\n        ",497],["T_RETURN","return",498],["T_WHITESPACE"," ",498],["T_VARIABLE","$this",498],";",["T_WHITESPACE","\n    ",498],"}",["T_WHITESPACE","\n\n    ",499],["T_DOC_COMMENT","\/**\n     * Override function to generate less curly captcha that will not cut off\n     *\n     * @see \\Zend_Captcha_Image::_randomSize()\n     * @return int\n     *\/",501],["T_WHITESPACE","\n    ",506],["T_PROTECTED","protected",507],["T_WHITESPACE"," ",507],["T_FUNCTION","function",507],["T_WHITESPACE"," ",507],["T_STRING","_randomSize",507],"(",")",["T_WHITESPACE","\n    ",507],"{",["T_WHITESPACE","\n        ",508],["T_RETURN","return",509],["T_WHITESPACE"," ",509],["T_NS_SEPARATOR","\\",509],["T_STRING","Magento",509],["T_NS_SEPARATOR","\\",509],["T_STRING","Framework",509],["T_NS_SEPARATOR","\\",509],["T_STRING","Math",509],["T_NS_SEPARATOR","\\",509],["T_STRING","Random",509],["T_DOUBLE_COLON","::",509],["T_STRING","getRandomNumber",509],"(",["T_LNUMBER","280",509],",",["T_WHITESPACE"," ",509],["T_LNUMBER","300",509],")",["T_WHITESPACE"," ",509],"\/",["T_WHITESPACE"," ",509],["T_LNUMBER","100",509],";",["T_WHITESPACE","\n    ",509],"}",["T_WHITESPACE","\n\n    ",510],["T_DOC_COMMENT","\/**\n     * Overlap of the parent method\n     *\n     * @return void\n     *\n     * Now deleting old captcha images make crontab script\n     * @see \\Magento\\Captcha\\Cron\\DeleteExpiredImages::execute\n     *\/",512],["T_WHITESPACE","\n    ",519],["T_PROTECTED","protected",520],["T_WHITESPACE"," ",520],["T_FUNCTION","function",520],["T_WHITESPACE"," ",520],["T_STRING","_gc",520],"(",")",["T_WHITESPACE","\n    ",520],"{",["T_WHITESPACE","\n        ",521],["T_COMMENT","\/\/do nothing\n",522],["T_WHITESPACE","    ",523],"}",["T_WHITESPACE","\n\n    ",523],["T_DOC_COMMENT","\/**\n     * Get resource model\n     *\n     * @return \\Magento\\Captcha\\Model\\ResourceModel\\Log\n     *\/",525],["T_WHITESPACE","\n    ",529],["T_PROTECTED","protected",530],["T_WHITESPACE"," ",530],["T_FUNCTION","function",530],["T_WHITESPACE"," ",530],["T_STRING","_getResourceModel",530],"(",")",["T_WHITESPACE","\n    ",530],"{",["T_WHITESPACE","\n        ",531],["T_RETURN","return",532],["T_WHITESPACE"," ",532],["T_VARIABLE","$this",532],["T_OBJECT_OPERATOR","->",532],["T_STRING","_resLogFactory",532],["T_OBJECT_OPERATOR","->",532],["T_STRING","create",532],"(",")",";",["T_WHITESPACE","\n    ",532],"}",["T_WHITESPACE","\n",533],"}",["T_WHITESPACE","\n",534]]