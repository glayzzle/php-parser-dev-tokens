[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n *\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",6],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Shipping",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Controller",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Adminhtml",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Order",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Shipment",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Backend",9],["T_NS_SEPARATOR","\\",9],["T_STRING","App",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Action",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Sales",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Model",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Order",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Shipment",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Validation",10],["T_NS_SEPARATOR","\\",10],["T_STRING","QuantityValidator",10],";",["T_WHITESPACE","\n\n",10],["T_DOC_COMMENT","\/**\n * Class Save\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",12],["T_WHITESPACE","\n",15],["T_CLASS","class",16],["T_WHITESPACE"," ",16],["T_STRING","Save",16],["T_WHITESPACE"," ",16],["T_EXTENDS","extends",16],["T_WHITESPACE"," ",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Magento",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Backend",16],["T_NS_SEPARATOR","\\",16],["T_STRING","App",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Action",16],["T_WHITESPACE","\n",16],"{",["T_WHITESPACE","\n    ",17],["T_DOC_COMMENT","\/**\n     * Authorization level of a basic admin session\n     *\n     * @see _isAllowed()\n     *\/",18],["T_WHITESPACE","\n    ",22],["T_CONST","const",23],["T_WHITESPACE"," ",23],["T_STRING","ADMIN_RESOURCE",23],["T_WHITESPACE"," ",23],"=",["T_WHITESPACE"," ",23],["T_CONSTANT_ENCAPSED_STRING","'Magento_Sales::shipment'",23],";",["T_WHITESPACE","\n\n    ",23],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Shipping\\Controller\\Adminhtml\\Order\\ShipmentLoader\n     *\/",25],["T_WHITESPACE","\n    ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$shipmentLoader",28],";",["T_WHITESPACE","\n\n    ",28],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Shipping\\Model\\Shipping\\LabelGenerator\n     *\/",30],["T_WHITESPACE","\n    ",32],["T_PROTECTED","protected",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$labelGenerator",33],";",["T_WHITESPACE","\n\n    ",33],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Sales\\Model\\Order\\Email\\Sender\\ShipmentSender\n     *\/",35],["T_WHITESPACE","\n    ",37],["T_PROTECTED","protected",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$shipmentSender",38],";",["T_WHITESPACE","\n\n    ",38],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Sales\\Model\\Order\\Shipment\\ShipmentValidatorInterface\n     *\/",40],["T_WHITESPACE","\n    ",42],["T_PRIVATE","private",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$shipmentValidator",43],";",["T_WHITESPACE","\n\n    ",43],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Backend\\App\\Action\\Context $context\n     * @param \\Magento\\Shipping\\Controller\\Adminhtml\\Order\\ShipmentLoader $shipmentLoader\n     * @param \\Magento\\Shipping\\Model\\Shipping\\LabelGenerator $labelGenerator\n     * @param \\Magento\\Sales\\Model\\Order\\Email\\Sender\\ShipmentSender $shipmentSender\n     *\/",45],["T_WHITESPACE","\n    ",50],["T_PUBLIC","public",51],["T_WHITESPACE"," ",51],["T_FUNCTION","function",51],["T_WHITESPACE"," ",51],["T_STRING","__construct",51],"(",["T_WHITESPACE","\n        ",51],["T_NS_SEPARATOR","\\",52],["T_STRING","Magento",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Backend",52],["T_NS_SEPARATOR","\\",52],["T_STRING","App",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Action",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Context",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$context",52],",",["T_WHITESPACE","\n        ",52],["T_NS_SEPARATOR","\\",53],["T_STRING","Magento",53],["T_NS_SEPARATOR","\\",53],["T_STRING","Shipping",53],["T_NS_SEPARATOR","\\",53],["T_STRING","Controller",53],["T_NS_SEPARATOR","\\",53],["T_STRING","Adminhtml",53],["T_NS_SEPARATOR","\\",53],["T_STRING","Order",53],["T_NS_SEPARATOR","\\",53],["T_STRING","ShipmentLoader",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$shipmentLoader",53],",",["T_WHITESPACE","\n        ",53],["T_NS_SEPARATOR","\\",54],["T_STRING","Magento",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Shipping",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Model",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Shipping",54],["T_NS_SEPARATOR","\\",54],["T_STRING","LabelGenerator",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$labelGenerator",54],",",["T_WHITESPACE","\n        ",54],["T_NS_SEPARATOR","\\",55],["T_STRING","Magento",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Sales",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Model",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Order",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Email",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Sender",55],["T_NS_SEPARATOR","\\",55],["T_STRING","ShipmentSender",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$shipmentSender",55],["T_WHITESPACE","\n    ",55],")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","shipmentLoader",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$shipmentLoader",57],";",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","labelGenerator",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$labelGenerator",58],";",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","shipmentSender",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$shipmentSender",59],";",["T_WHITESPACE","\n        ",59],["T_STRING","parent",60],["T_DOUBLE_COLON","::",60],["T_STRING","__construct",60],"(",["T_VARIABLE","$context",60],")",";",["T_WHITESPACE","\n    ",60],"}",["T_WHITESPACE","\n\n    ",61],["T_DOC_COMMENT","\/**\n     * Save shipment and order in one transaction\n     *\n     * @param \\Magento\\Sales\\Model\\Order\\Shipment $shipment\n     * @return $this\n     *\/",63],["T_WHITESPACE","\n    ",68],["T_PROTECTED","protected",69],["T_WHITESPACE"," ",69],["T_FUNCTION","function",69],["T_WHITESPACE"," ",69],["T_STRING","_saveShipment",69],"(",["T_VARIABLE","$shipment",69],")",["T_WHITESPACE","\n    ",69],"{",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$shipment",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getOrder",71],"(",")",["T_OBJECT_OPERATOR","->",71],["T_STRING","setIsInProcess",71],"(",["T_STRING","true",71],")",";",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$transaction",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","_objectManager",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","create",72],"(",["T_WHITESPACE","\n            ",72],["T_NS_SEPARATOR","\\",73],["T_STRING","Magento",73],["T_NS_SEPARATOR","\\",73],["T_STRING","Framework",73],["T_NS_SEPARATOR","\\",73],["T_STRING","DB",73],["T_NS_SEPARATOR","\\",73],["T_STRING","Transaction",73],["T_DOUBLE_COLON","::",73],["T_CLASS","class",73],["T_WHITESPACE","\n        ",73],")",";",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$transaction",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","addObject",75],"(",["T_WHITESPACE","\n            ",75],["T_VARIABLE","$shipment",76],["T_WHITESPACE","\n        ",76],")",["T_OBJECT_OPERATOR","->",77],["T_STRING","addObject",77],"(",["T_WHITESPACE","\n            ",77],["T_VARIABLE","$shipment",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getOrder",78],"(",")",["T_WHITESPACE","\n        ",78],")",["T_OBJECT_OPERATOR","->",79],["T_STRING","save",79],"(",")",";",["T_WHITESPACE","\n\n        ",79],["T_RETURN","return",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],";",["T_WHITESPACE","\n    ",81],"}",["T_WHITESPACE","\n\n    ",82],["T_DOC_COMMENT","\/**\n     * Save shipment\n     * We can save only new shipment. Existing shipments are not editable\n     *\n     * @return void\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     * @SuppressWarnings(PHPMD.NPathComplexity)\n     *\/",84],["T_WHITESPACE","\n    ",91],["T_PUBLIC","public",92],["T_WHITESPACE"," ",92],["T_FUNCTION","function",92],["T_WHITESPACE"," ",92],["T_STRING","execute",92],"(",")",["T_WHITESPACE","\n    ",92],"{",["T_WHITESPACE","\n        ",93],["T_DOC_COMMENT","\/** @var \\Magento\\Backend\\Model\\View\\Result\\Redirect $resultRedirect *\/",94],["T_WHITESPACE","\n        ",94],["T_VARIABLE","$resultRedirect",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","resultRedirectFactory",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","create",95],"(",")",";",["T_WHITESPACE","\n\n        ",95],["T_VARIABLE","$formKeyIsValid",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","_formKeyValidator",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","validate",97],"(",["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","getRequest",97],"(",")",")",";",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$isPost",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getRequest",98],"(",")",["T_OBJECT_OPERATOR","->",98],["T_STRING","isPost",98],"(",")",";",["T_WHITESPACE","\n        ",98],["T_IF","if",99],["T_WHITESPACE"," ",99],"(","!",["T_VARIABLE","$formKeyIsValid",99],["T_WHITESPACE"," ",99],["T_BOOLEAN_OR","||",99],["T_WHITESPACE"," ",99],"!",["T_VARIABLE","$isPost",99],")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n            ",99],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","messageManager",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","addError",100],"(",["T_STRING","__",100],"(",["T_CONSTANT_ENCAPSED_STRING","'We can\\'t save the shipment right now.'",100],")",")",";",["T_WHITESPACE","\n            ",100],["T_RETURN","return",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$resultRedirect",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","setPath",101],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order\/index'",101],")",";",["T_WHITESPACE","\n        ",101],"}",["T_WHITESPACE","\n\n        ",102],["T_VARIABLE","$data",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getRequest",104],"(",")",["T_OBJECT_OPERATOR","->",104],["T_STRING","getParam",104],"(",["T_CONSTANT_ENCAPSED_STRING","'shipment'",104],")",";",["T_WHITESPACE","\n\n        ",104],["T_IF","if",106],["T_WHITESPACE"," ",106],"(","!",["T_EMPTY","empty",106],"(",["T_VARIABLE","$data",106],"[",["T_CONSTANT_ENCAPSED_STRING","'comment_text'",106],"]",")",")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n            ",106],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","_objectManager",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","get",107],"(",["T_NS_SEPARATOR","\\",107],["T_STRING","Magento",107],["T_NS_SEPARATOR","\\",107],["T_STRING","Backend",107],["T_NS_SEPARATOR","\\",107],["T_STRING","Model",107],["T_NS_SEPARATOR","\\",107],["T_STRING","Session",107],["T_DOUBLE_COLON","::",107],["T_CLASS","class",107],")",["T_OBJECT_OPERATOR","->",107],["T_STRING","setCommentText",107],"(",["T_VARIABLE","$data",107],"[",["T_CONSTANT_ENCAPSED_STRING","'comment_text'",107],"]",")",";",["T_WHITESPACE","\n        ",107],"}",["T_WHITESPACE","\n\n        ",108],["T_VARIABLE","$isNeedCreateLabel",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_ISSET","isset",110],"(",["T_VARIABLE","$data",110],"[",["T_CONSTANT_ENCAPSED_STRING","'create_shipping_label'",110],"]",")",["T_WHITESPACE"," ",110],["T_BOOLEAN_AND","&&",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$data",110],"[",["T_CONSTANT_ENCAPSED_STRING","'create_shipping_label'",110],"]",";",["T_WHITESPACE","\n\n        ",110],["T_TRY","try",112],["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n            ",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","shipmentLoader",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","setOrderId",113],"(",["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","getRequest",113],"(",")",["T_OBJECT_OPERATOR","->",113],["T_STRING","getParam",113],"(",["T_CONSTANT_ENCAPSED_STRING","'order_id'",113],")",")",";",["T_WHITESPACE","\n            ",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","shipmentLoader",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","setShipmentId",114],"(",["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","getRequest",114],"(",")",["T_OBJECT_OPERATOR","->",114],["T_STRING","getParam",114],"(",["T_CONSTANT_ENCAPSED_STRING","'shipment_id'",114],")",")",";",["T_WHITESPACE","\n            ",114],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","shipmentLoader",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","setShipment",115],"(",["T_VARIABLE","$data",115],")",";",["T_WHITESPACE","\n            ",115],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","shipmentLoader",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","setTracking",116],"(",["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getRequest",116],"(",")",["T_OBJECT_OPERATOR","->",116],["T_STRING","getParam",116],"(",["T_CONSTANT_ENCAPSED_STRING","'tracking'",116],")",")",";",["T_WHITESPACE","\n            ",116],["T_VARIABLE","$shipment",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","shipmentLoader",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","load",117],"(",")",";",["T_WHITESPACE","\n            ",117],["T_IF","if",118],["T_WHITESPACE"," ",118],"(","!",["T_VARIABLE","$shipment",118],")",["T_WHITESPACE"," ",118],"{",["T_WHITESPACE","\n                ",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_forward",119],"(",["T_CONSTANT_ENCAPSED_STRING","'noroute'",119],")",";",["T_WHITESPACE","\n                ",119],["T_RETURN","return",120],";",["T_WHITESPACE","\n            ",120],"}",["T_WHITESPACE","\n\n            ",121],["T_IF","if",123],["T_WHITESPACE"," ",123],"(","!",["T_EMPTY","empty",123],"(",["T_VARIABLE","$data",123],"[",["T_CONSTANT_ENCAPSED_STRING","'comment_text'",123],"]",")",")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n                ",123],["T_VARIABLE","$shipment",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","addComment",124],"(",["T_WHITESPACE","\n                    ",124],["T_VARIABLE","$data",125],"[",["T_CONSTANT_ENCAPSED_STRING","'comment_text'",125],"]",",",["T_WHITESPACE","\n                    ",125],["T_ISSET","isset",126],"(",["T_VARIABLE","$data",126],"[",["T_CONSTANT_ENCAPSED_STRING","'comment_customer_notify'",126],"]",")",",",["T_WHITESPACE","\n                    ",126],["T_ISSET","isset",127],"(",["T_VARIABLE","$data",127],"[",["T_CONSTANT_ENCAPSED_STRING","'is_visible_on_front'",127],"]",")",["T_WHITESPACE","\n                ",127],")",";",["T_WHITESPACE","\n\n                ",128],["T_VARIABLE","$shipment",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","setCustomerNote",130],"(",["T_VARIABLE","$data",130],"[",["T_CONSTANT_ENCAPSED_STRING","'comment_text'",130],"]",")",";",["T_WHITESPACE","\n                ",130],["T_VARIABLE","$shipment",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","setCustomerNoteNotify",131],"(",["T_ISSET","isset",131],"(",["T_VARIABLE","$data",131],"[",["T_CONSTANT_ENCAPSED_STRING","'comment_customer_notify'",131],"]",")",")",";",["T_WHITESPACE","\n            ",131],"}",["T_WHITESPACE","\n            ",132],["T_VARIABLE","$validationResult",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getShipmentValidator",133],"(",")",["T_WHITESPACE","\n                ",133],["T_OBJECT_OPERATOR","->",134],["T_STRING","validate",134],"(",["T_VARIABLE","$shipment",134],",",["T_WHITESPACE"," ",134],"[",["T_STRING","QuantityValidator",134],["T_DOUBLE_COLON","::",134],["T_CLASS","class",134],"]",")",";",["T_WHITESPACE","\n\n            ",134],["T_IF","if",136],["T_WHITESPACE"," ",136],"(",["T_VARIABLE","$validationResult",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","hasMessages",136],"(",")",")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n                ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","messageManager",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","addError",137],"(",["T_WHITESPACE","\n                    ",137],["T_STRING","__",138],"(",["T_CONSTANT_ENCAPSED_STRING","\"Shipment Document Validation Error(s):\\n\"",138],["T_WHITESPACE"," ",138],".",["T_WHITESPACE"," ",138],["T_STRING","implode",138],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",138],",",["T_WHITESPACE"," ",138],["T_VARIABLE","$validationResult",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","getMessages",138],"(",")",")",")",["T_WHITESPACE","\n                ",138],")",";",["T_WHITESPACE","\n                ",139],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","_redirect",140],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/new'",140],",",["T_WHITESPACE"," ",140],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",140],["T_WHITESPACE"," ",140],["T_DOUBLE_ARROW","=>",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","getRequest",140],"(",")",["T_OBJECT_OPERATOR","->",140],["T_STRING","getParam",140],"(",["T_CONSTANT_ENCAPSED_STRING","'order_id'",140],")","]",")",";",["T_WHITESPACE","\n                ",140],["T_RETURN","return",141],";",["T_WHITESPACE","\n            ",141],"}",["T_WHITESPACE","\n            ",142],["T_VARIABLE","$shipment",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","register",143],"(",")",";",["T_WHITESPACE","\n\n            ",143],["T_VARIABLE","$shipment",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getOrder",145],"(",")",["T_OBJECT_OPERATOR","->",145],["T_STRING","setCustomerNoteNotify",145],"(","!",["T_EMPTY","empty",145],"(",["T_VARIABLE","$data",145],"[",["T_CONSTANT_ENCAPSED_STRING","'send_email'",145],"]",")",")",";",["T_WHITESPACE","\n            ",145],["T_VARIABLE","$responseAjax",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_NEW","new",146],["T_WHITESPACE"," ",146],["T_NS_SEPARATOR","\\",146],["T_STRING","Magento",146],["T_NS_SEPARATOR","\\",146],["T_STRING","Framework",146],["T_NS_SEPARATOR","\\",146],["T_STRING","DataObject",146],"(",")",";",["T_WHITESPACE","\n\n            ",146],["T_IF","if",148],["T_WHITESPACE"," ",148],"(",["T_VARIABLE","$isNeedCreateLabel",148],")",["T_WHITESPACE"," ",148],"{",["T_WHITESPACE","\n                ",148],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","labelGenerator",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","create",149],"(",["T_VARIABLE","$shipment",149],",",["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","_request",149],")",";",["T_WHITESPACE","\n                ",149],["T_VARIABLE","$responseAjax",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","setOk",150],"(",["T_STRING","true",150],")",";",["T_WHITESPACE","\n            ",150],"}",["T_WHITESPACE","\n\n            ",151],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","_saveShipment",153],"(",["T_VARIABLE","$shipment",153],")",";",["T_WHITESPACE","\n\n            ",153],["T_IF","if",155],["T_WHITESPACE"," ",155],"(","!",["T_EMPTY","empty",155],"(",["T_VARIABLE","$data",155],"[",["T_CONSTANT_ENCAPSED_STRING","'send_email'",155],"]",")",")",["T_WHITESPACE"," ",155],"{",["T_WHITESPACE","\n                ",155],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","shipmentSender",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","send",156],"(",["T_VARIABLE","$shipment",156],")",";",["T_WHITESPACE","\n            ",156],"}",["T_WHITESPACE","\n\n            ",157],["T_VARIABLE","$shipmentCreatedMessage",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_STRING","__",159],"(",["T_CONSTANT_ENCAPSED_STRING","'The shipment has been created.'",159],")",";",["T_WHITESPACE","\n            ",159],["T_VARIABLE","$labelCreatedMessage",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_STRING","__",160],"(",["T_CONSTANT_ENCAPSED_STRING","'You created the shipping label.'",160],")",";",["T_WHITESPACE","\n\n            ",160],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","messageManager",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","addSuccess",162],"(",["T_WHITESPACE","\n                ",162],["T_VARIABLE","$isNeedCreateLabel",163],["T_WHITESPACE"," ",163],"?",["T_WHITESPACE"," ",163],["T_VARIABLE","$shipmentCreatedMessage",163],["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_CONSTANT_ENCAPSED_STRING","' '",163],["T_WHITESPACE"," ",163],".",["T_WHITESPACE"," ",163],["T_VARIABLE","$labelCreatedMessage",163],["T_WHITESPACE"," ",163],":",["T_WHITESPACE"," ",163],["T_VARIABLE","$shipmentCreatedMessage",163],["T_WHITESPACE","\n            ",163],")",";",["T_WHITESPACE","\n            ",164],["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","_objectManager",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","get",165],"(",["T_NS_SEPARATOR","\\",165],["T_STRING","Magento",165],["T_NS_SEPARATOR","\\",165],["T_STRING","Backend",165],["T_NS_SEPARATOR","\\",165],["T_STRING","Model",165],["T_NS_SEPARATOR","\\",165],["T_STRING","Session",165],["T_DOUBLE_COLON","::",165],["T_CLASS","class",165],")",["T_OBJECT_OPERATOR","->",165],["T_STRING","getCommentText",165],"(",["T_STRING","true",165],")",";",["T_WHITESPACE","\n        ",165],"}",["T_WHITESPACE"," ",166],["T_CATCH","catch",166],["T_WHITESPACE"," ",166],"(",["T_NS_SEPARATOR","\\",166],["T_STRING","Magento",166],["T_NS_SEPARATOR","\\",166],["T_STRING","Framework",166],["T_NS_SEPARATOR","\\",166],["T_STRING","Exception",166],["T_NS_SEPARATOR","\\",166],["T_STRING","LocalizedException",166],["T_WHITESPACE"," ",166],["T_VARIABLE","$e",166],")",["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n            ",166],["T_IF","if",167],["T_WHITESPACE"," ",167],"(",["T_VARIABLE","$isNeedCreateLabel",167],")",["T_WHITESPACE"," ",167],"{",["T_WHITESPACE","\n                ",167],["T_VARIABLE","$responseAjax",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","setError",168],"(",["T_STRING","true",168],")",";",["T_WHITESPACE","\n                ",168],["T_VARIABLE","$responseAjax",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","setMessage",169],"(",["T_VARIABLE","$e",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","getMessage",169],"(",")",")",";",["T_WHITESPACE","\n            ",169],"}",["T_WHITESPACE"," ",170],["T_ELSE","else",170],["T_WHITESPACE"," ",170],"{",["T_WHITESPACE","\n                ",170],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","messageManager",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","addError",171],"(",["T_VARIABLE","$e",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","getMessage",171],"(",")",")",";",["T_WHITESPACE","\n                ",171],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","_redirect",172],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/new'",172],",",["T_WHITESPACE"," ",172],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",172],["T_WHITESPACE"," ",172],["T_DOUBLE_ARROW","=>",172],["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","getRequest",172],"(",")",["T_OBJECT_OPERATOR","->",172],["T_STRING","getParam",172],"(",["T_CONSTANT_ENCAPSED_STRING","'order_id'",172],")","]",")",";",["T_WHITESPACE","\n            ",172],"}",["T_WHITESPACE","\n        ",173],"}",["T_WHITESPACE"," ",174],["T_CATCH","catch",174],["T_WHITESPACE"," ",174],"(",["T_NS_SEPARATOR","\\",174],["T_STRING","Exception",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$e",174],")",["T_WHITESPACE"," ",174],"{",["T_WHITESPACE","\n            ",174],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","_objectManager",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","get",175],"(",["T_NS_SEPARATOR","\\",175],["T_STRING","Psr",175],["T_NS_SEPARATOR","\\",175],["T_STRING","Log",175],["T_NS_SEPARATOR","\\",175],["T_STRING","LoggerInterface",175],["T_DOUBLE_COLON","::",175],["T_CLASS","class",175],")",["T_OBJECT_OPERATOR","->",175],["T_STRING","critical",175],"(",["T_VARIABLE","$e",175],")",";",["T_WHITESPACE","\n            ",175],["T_IF","if",176],["T_WHITESPACE"," ",176],"(",["T_VARIABLE","$isNeedCreateLabel",176],")",["T_WHITESPACE"," ",176],"{",["T_WHITESPACE","\n                ",176],["T_VARIABLE","$responseAjax",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","setError",177],"(",["T_STRING","true",177],")",";",["T_WHITESPACE","\n                ",177],["T_VARIABLE","$responseAjax",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","setMessage",178],"(",["T_STRING","__",178],"(",["T_CONSTANT_ENCAPSED_STRING","'An error occurred while creating shipping label.'",178],")",")",";",["T_WHITESPACE","\n            ",178],"}",["T_WHITESPACE"," ",179],["T_ELSE","else",179],["T_WHITESPACE"," ",179],"{",["T_WHITESPACE","\n                ",179],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","messageManager",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","addError",180],"(",["T_STRING","__",180],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot save shipment.'",180],")",")",";",["T_WHITESPACE","\n                ",180],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","_redirect",181],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/new'",181],",",["T_WHITESPACE"," ",181],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",181],["T_WHITESPACE"," ",181],["T_DOUBLE_ARROW","=>",181],["T_WHITESPACE"," ",181],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","getRequest",181],"(",")",["T_OBJECT_OPERATOR","->",181],["T_STRING","getParam",181],"(",["T_CONSTANT_ENCAPSED_STRING","'order_id'",181],")","]",")",";",["T_WHITESPACE","\n            ",181],"}",["T_WHITESPACE","\n        ",182],"}",["T_WHITESPACE","\n        ",183],["T_IF","if",184],["T_WHITESPACE"," ",184],"(",["T_VARIABLE","$isNeedCreateLabel",184],")",["T_WHITESPACE"," ",184],"{",["T_WHITESPACE","\n            ",184],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","getResponse",185],"(",")",["T_OBJECT_OPERATOR","->",185],["T_STRING","representJson",185],"(",["T_VARIABLE","$responseAjax",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","toJson",185],"(",")",")",";",["T_WHITESPACE","\n        ",185],"}",["T_WHITESPACE"," ",186],["T_ELSE","else",186],["T_WHITESPACE"," ",186],"{",["T_WHITESPACE","\n            ",186],["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","_redirect",187],"(",["T_CONSTANT_ENCAPSED_STRING","'sales\/order\/view'",187],",",["T_WHITESPACE"," ",187],"[",["T_CONSTANT_ENCAPSED_STRING","'order_id'",187],["T_WHITESPACE"," ",187],["T_DOUBLE_ARROW","=>",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$shipment",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","getOrderId",187],"(",")","]",")",";",["T_WHITESPACE","\n        ",187],"}",["T_WHITESPACE","\n    ",188],"}",["T_WHITESPACE","\n\n    ",189],["T_DOC_COMMENT","\/**\n     * @return \\Magento\\Sales\\Model\\Order\\Shipment\\ShipmentValidatorInterface\n     * @deprecated\n     *\/",191],["T_WHITESPACE","\n    ",194],["T_PRIVATE","private",195],["T_WHITESPACE"," ",195],["T_FUNCTION","function",195],["T_WHITESPACE"," ",195],["T_STRING","getShipmentValidator",195],"(",")",["T_WHITESPACE","\n    ",195],"{",["T_WHITESPACE","\n        ",196],["T_IF","if",197],["T_WHITESPACE"," ",197],"(",["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","shipmentValidator",197],["T_WHITESPACE"," ",197],["T_IS_IDENTICAL","===",197],["T_WHITESPACE"," ",197],["T_STRING","null",197],")",["T_WHITESPACE"," ",197],"{",["T_WHITESPACE","\n            ",197],["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","shipmentValidator",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","_objectManager",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","get",198],"(",["T_WHITESPACE","\n                ",198],["T_NS_SEPARATOR","\\",199],["T_STRING","Magento",199],["T_NS_SEPARATOR","\\",199],["T_STRING","Sales",199],["T_NS_SEPARATOR","\\",199],["T_STRING","Model",199],["T_NS_SEPARATOR","\\",199],["T_STRING","Order",199],["T_NS_SEPARATOR","\\",199],["T_STRING","Shipment",199],["T_NS_SEPARATOR","\\",199],["T_STRING","ShipmentValidatorInterface",199],["T_DOUBLE_COLON","::",199],["T_CLASS","class",199],["T_WHITESPACE","\n            ",199],")",";",["T_WHITESPACE","\n        ",200],"}",["T_WHITESPACE","\n\n        ",201],["T_RETURN","return",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","shipmentValidator",203],";",["T_WHITESPACE","\n    ",203],"}",["T_WHITESPACE","\n",204],"}",["T_WHITESPACE","\n",205]]