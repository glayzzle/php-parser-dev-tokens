[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Analytics",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Model",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Exception",9],["T_NS_SEPARATOR","\\",9],["T_STRING","NoSuchEntityException",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Integration",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Api",10],["T_NS_SEPARATOR","\\",10],["T_STRING","IntegrationServiceInterface",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Config",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Model",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Config",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Integration",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Model",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Integration",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Integration",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Api",13],["T_NS_SEPARATOR","\\",13],["T_STRING","OauthServiceInterface",13],";",["T_WHITESPACE","\n\n",13],["T_DOC_COMMENT","\/**\n * Class IntegrationManager\n *\n * Manages the integration user at magento side.\n * User name stored in config.\n * User roles\n *\/",15],["T_WHITESPACE","\n",21],["T_CLASS","class",22],["T_WHITESPACE"," ",22],["T_STRING","IntegrationManager",22],["T_WHITESPACE","\n",22],"{",["T_WHITESPACE","\n    ",23],["T_DOC_COMMENT","\/**\n     * @var Config\n     *\/",24],["T_WHITESPACE","\n    ",26],["T_PRIVATE","private",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$config",27],";",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * @var IntegrationServiceInterface\n     *\/",29],["T_WHITESPACE","\n    ",31],["T_PRIVATE","private",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$integrationService",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * @var OauthServiceInterface\n     *\/",34],["T_WHITESPACE","\n    ",36],["T_PRIVATE","private",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$oauthService",37],";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * IntegrationManager constructor\n     *\n     * @param Config $config\n     * @param IntegrationServiceInterface $integrationService\n     * @param OauthServiceInterface $oauthService\n     *\/",39],["T_WHITESPACE","\n    ",45],["T_PUBLIC","public",46],["T_WHITESPACE"," ",46],["T_FUNCTION","function",46],["T_WHITESPACE"," ",46],["T_STRING","__construct",46],"(",["T_WHITESPACE","\n        ",46],["T_STRING","Config",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$config",47],",",["T_WHITESPACE","\n        ",47],["T_STRING","IntegrationServiceInterface",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$integrationService",48],",",["T_WHITESPACE","\n        ",48],["T_STRING","OauthServiceInterface",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$oauthService",49],["T_WHITESPACE","\n    ",49],")",["T_WHITESPACE"," ",50],"{",["T_WHITESPACE","\n        ",50],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","integrationService",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$integrationService",51],";",["T_WHITESPACE","\n        ",51],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","config",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$config",52],";",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","oauthService",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$oauthService",53],";",["T_WHITESPACE","\n    ",53],"}",["T_WHITESPACE","\n\n    ",54],["T_DOC_COMMENT","\/**\n     * Activate predefined integration user\n     *\n     * @return bool\n     * @throws NoSuchEntityException\n     *\/",56],["T_WHITESPACE","\n    ",61],["T_PUBLIC","public",62],["T_WHITESPACE"," ",62],["T_FUNCTION","function",62],["T_WHITESPACE"," ",62],["T_STRING","activateIntegration",62],"(",")",["T_WHITESPACE","\n    ",62],"{",["T_WHITESPACE","\n        ",63],["T_VARIABLE","$integration",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","integrationService",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","findByName",64],"(",["T_WHITESPACE","\n            ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","config",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getConfigDataValue",65],"(",["T_CONSTANT_ENCAPSED_STRING","'analytics\/integration_name'",65],")",["T_WHITESPACE","\n        ",65],")",";",["T_WHITESPACE","\n        ",66],["T_IF","if",67],["T_WHITESPACE"," ",67],"(","!",["T_VARIABLE","$integration",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getId",67],"(",")",")",["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n            ",67],["T_THROW","throw",68],["T_WHITESPACE"," ",68],["T_NEW","new",68],["T_WHITESPACE"," ",68],["T_STRING","NoSuchEntityException",68],"(",["T_STRING","__",68],"(",["T_CONSTANT_ENCAPSED_STRING","'Cannot find predefined integration user!'",68],")",")",";",["T_WHITESPACE","\n        ",68],"}",["T_WHITESPACE","\n        ",69],["T_VARIABLE","$integrationData",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getIntegrationData",70],"(",["T_STRING","Integration",70],["T_DOUBLE_COLON","::",70],["T_STRING","STATUS_ACTIVE",70],")",";",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$integrationData",71],"[",["T_CONSTANT_ENCAPSED_STRING","'integration_id'",71],"]",["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$integration",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getId",71],"(",")",";",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","integrationService",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","update",72],"(",["T_VARIABLE","$integrationData",72],")",";",["T_WHITESPACE","\n        ",72],["T_RETURN","return",73],["T_WHITESPACE"," ",73],["T_STRING","true",73],";",["T_WHITESPACE","\n    ",73],"}",["T_WHITESPACE","\n\n    ",74],["T_DOC_COMMENT","\/**\n     * This method execute Generate Token command and enable integration\n     *\n     * @return bool|string\n     *\/",76],["T_WHITESPACE","\n    ",80],["T_PUBLIC","public",81],["T_WHITESPACE"," ",81],["T_FUNCTION","function",81],["T_WHITESPACE"," ",81],["T_STRING","generateToken",81],"(",")",["T_WHITESPACE","\n    ",81],"{",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$consumerId",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","generateIntegration",83],"(",")",["T_OBJECT_OPERATOR","->",83],["T_STRING","getConsumerId",83],"(",")",";",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$accessToken",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","oauthService",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getAccessToken",84],"(",["T_VARIABLE","$consumerId",84],")",";",["T_WHITESPACE","\n        ",84],["T_IF","if",85],["T_WHITESPACE"," ",85],"(","!",["T_VARIABLE","$accessToken",85],["T_WHITESPACE"," ",85],["T_BOOLEAN_AND","&&",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","oauthService",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","createAccessToken",85],"(",["T_VARIABLE","$consumerId",85],",",["T_WHITESPACE"," ",85],["T_STRING","true",85],")",")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n            ",85],["T_VARIABLE","$accessToken",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","oauthService",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getAccessToken",86],"(",["T_VARIABLE","$consumerId",86],")",";",["T_WHITESPACE","\n        ",86],"}",["T_WHITESPACE","\n        ",87],["T_RETURN","return",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$accessToken",88],";",["T_WHITESPACE","\n    ",88],"}",["T_WHITESPACE","\n\n    ",89],["T_DOC_COMMENT","\/**\n     * Returns consumer Id for MA integration user\n     *\n     * @return \\Magento\\Integration\\Model\\Integration\n     *\/",91],["T_WHITESPACE","\n    ",95],["T_PRIVATE","private",96],["T_WHITESPACE"," ",96],["T_FUNCTION","function",96],["T_WHITESPACE"," ",96],["T_STRING","generateIntegration",96],"(",")",["T_WHITESPACE","\n    ",96],"{",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$integration",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","integrationService",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","findByName",98],"(",["T_WHITESPACE","\n            ",98],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","config",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","getConfigDataValue",99],"(",["T_CONSTANT_ENCAPSED_STRING","'analytics\/integration_name'",99],")",["T_WHITESPACE","\n        ",99],")",";",["T_WHITESPACE","\n        ",100],["T_IF","if",101],["T_WHITESPACE"," ",101],"(","!",["T_VARIABLE","$integration",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getId",101],"(",")",")",["T_WHITESPACE"," ",101],"{",["T_WHITESPACE","\n            ",101],["T_VARIABLE","$integration",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","integrationService",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","create",102],"(",["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getIntegrationData",102],"(",")",")",";",["T_WHITESPACE","\n        ",102],"}",["T_WHITESPACE","\n        ",103],["T_RETURN","return",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$integration",104],";",["T_WHITESPACE","\n    ",104],"}",["T_WHITESPACE","\n\n    ",105],["T_DOC_COMMENT","\/**\n     * Returns default attributes for MA integration user\n     *\n     * @param int $status\n     * @return array\n     *\/",107],["T_WHITESPACE","\n    ",112],["T_PRIVATE","private",113],["T_WHITESPACE"," ",113],["T_FUNCTION","function",113],["T_WHITESPACE"," ",113],["T_STRING","getIntegrationData",113],"(",["T_VARIABLE","$status",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_STRING","Integration",113],["T_DOUBLE_COLON","::",113],["T_STRING","STATUS_INACTIVE",113],")",["T_WHITESPACE","\n    ",113],"{",["T_WHITESPACE","\n        ",114],["T_VARIABLE","$integrationData",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],"[",["T_WHITESPACE","\n            ",115],["T_CONSTANT_ENCAPSED_STRING","'name'",116],["T_WHITESPACE"," ",116],["T_DOUBLE_ARROW","=>",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","config",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getConfigDataValue",116],"(",["T_CONSTANT_ENCAPSED_STRING","'analytics\/integration_name'",116],")",",",["T_WHITESPACE","\n            ",116],["T_CONSTANT_ENCAPSED_STRING","'status'",117],["T_WHITESPACE"," ",117],["T_DOUBLE_ARROW","=>",117],["T_WHITESPACE"," ",117],["T_VARIABLE","$status",117],",",["T_WHITESPACE","\n            ",117],["T_CONSTANT_ENCAPSED_STRING","'all_resources'",118],["T_WHITESPACE"," ",118],["T_DOUBLE_ARROW","=>",118],["T_WHITESPACE"," ",118],["T_STRING","false",118],",",["T_WHITESPACE","\n            ",118],["T_CONSTANT_ENCAPSED_STRING","'resource'",119],["T_WHITESPACE"," ",119],["T_DOUBLE_ARROW","=>",119],["T_WHITESPACE"," ",119],"[",["T_WHITESPACE","\n                ",119],["T_CONSTANT_ENCAPSED_STRING","'Magento_Analytics::analytics'",120],",",["T_WHITESPACE","\n                ",120],["T_CONSTANT_ENCAPSED_STRING","'Magento_Analytics::analytics_api'",121],["T_WHITESPACE","\n            ",121],"]",",",["T_WHITESPACE","\n        ",122],"]",";",["T_WHITESPACE","\n        ",123],["T_RETURN","return",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$integrationData",124],";",["T_WHITESPACE","\n    ",124],"}",["T_WHITESPACE","\n",125],"}",["T_WHITESPACE","\n",126]]