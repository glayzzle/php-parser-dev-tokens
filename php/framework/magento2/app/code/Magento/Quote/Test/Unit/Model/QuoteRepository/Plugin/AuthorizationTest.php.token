[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Quote",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Test",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Unit",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","QuoteRepository",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Plugin",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Quote",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Model",8],["T_NS_SEPARATOR","\\",8],["T_STRING","QuoteRepository",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Plugin",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Authorization",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Authorization",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Model",9],["T_NS_SEPARATOR","\\",9],["T_STRING","UserContextInterface",9],";",["T_WHITESPACE","\n\n",9],["T_DOC_COMMENT","\/**\n * Class AuthorizationTest\n *\/",11],["T_WHITESPACE","\n",13],["T_CLASS","class",14],["T_WHITESPACE"," ",14],["T_STRING","AuthorizationTest",14],["T_WHITESPACE"," ",14],["T_EXTENDS","extends",14],["T_WHITESPACE"," ",14],["T_NS_SEPARATOR","\\",14],["T_STRING","PHPUnit_Framework_TestCase",14],["T_WHITESPACE","\n",14],"{",["T_WHITESPACE","\n    ",15],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Model\\QuoteRepository\\Plugin\\Authorization\n     *\/",16],["T_WHITESPACE","\n    ",18],["T_PRIVATE","private",19],["T_WHITESPACE"," ",19],["T_VARIABLE","$authorization",19],";",["T_WHITESPACE","\n\n    ",19],["T_DOC_COMMENT","\/**\n     * @var \\PHPUnit_Framework_MockObject_MockObject | \\Magento\\Authorization\\Model\\UserContextInterface\n     *\/",21],["T_WHITESPACE","\n    ",23],["T_PRIVATE","private",24],["T_WHITESPACE"," ",24],["T_VARIABLE","$userContextMock",24],";",["T_WHITESPACE","\n\n    ",24],["T_PROTECTED","protected",26],["T_WHITESPACE"," ",26],["T_FUNCTION","function",26],["T_WHITESPACE"," ",26],["T_STRING","setUp",26],"(",")",["T_WHITESPACE","\n    ",26],"{",["T_WHITESPACE","\n        ",27],["T_VARIABLE","$this",28],["T_OBJECT_OPERATOR","->",28],["T_STRING","userContextMock",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_VARIABLE","$this",28],["T_OBJECT_OPERATOR","->",28],["T_STRING","getMock",28],"(",["T_NS_SEPARATOR","\\",28],["T_STRING","Magento",28],["T_NS_SEPARATOR","\\",28],["T_STRING","Authorization",28],["T_NS_SEPARATOR","\\",28],["T_STRING","Model",28],["T_NS_SEPARATOR","\\",28],["T_STRING","UserContextInterface",28],["T_DOUBLE_COLON","::",28],["T_CLASS","class",28],")",";",["T_WHITESPACE","\n        ",28],["T_VARIABLE","$this",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","authorization",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_NEW","new",29],["T_WHITESPACE"," ",29],["T_STRING","Authorization",29],"(",["T_VARIABLE","$this",29],["T_OBJECT_OPERATOR","->",29],["T_STRING","userContextMock",29],")",";",["T_WHITESPACE","\n    ",29],"}",["T_WHITESPACE","\n\n    ",30],["T_DOC_COMMENT","\/**\n     * @expectedException \\Magento\\Framework\\Exception\\NoSuchEntityException\n     * @expectedExceptionMessage No such entity\n     *\/",32],["T_WHITESPACE","\n    ",35],["T_PUBLIC","public",36],["T_WHITESPACE"," ",36],["T_FUNCTION","function",36],["T_WHITESPACE"," ",36],["T_STRING","testAfterGetActiveThrowsExceptionIfQuoteIsNotAllowedForCurrentUserContext",36],"(",")",["T_WHITESPACE","\n    ",36],"{",["T_WHITESPACE","\n        ",37],["T_COMMENT","\/\/ Quote without customer ID\n",38],["T_WHITESPACE","        ",39],["T_VARIABLE","$quoteMock",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","getMock",39],"(",["T_NS_SEPARATOR","\\",39],["T_STRING","Magento",39],["T_NS_SEPARATOR","\\",39],["T_STRING","Quote",39],["T_NS_SEPARATOR","\\",39],["T_STRING","Model",39],["T_NS_SEPARATOR","\\",39],["T_STRING","Quote",39],["T_DOUBLE_COLON","::",39],["T_CLASS","class",39],",",["T_WHITESPACE"," ",39],"[",["T_CONSTANT_ENCAPSED_STRING","'getCustomerId'",39],"]",",",["T_WHITESPACE"," ",39],"[","]",",",["T_WHITESPACE"," ",39],["T_CONSTANT_ENCAPSED_STRING","''",39],",",["T_WHITESPACE"," ",39],["T_STRING","false",39],")",";",["T_WHITESPACE","\n        ",39],["T_VARIABLE","$quoteRepositoryMock",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","getMock",40],"(",["T_NS_SEPARATOR","\\",40],["T_STRING","Magento",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Quote",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Api",40],["T_NS_SEPARATOR","\\",40],["T_STRING","CartRepositoryInterface",40],["T_DOUBLE_COLON","::",40],["T_CLASS","class",40],")",";",["T_WHITESPACE","\n        ",40],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","userContextMock",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","expects",41],"(",["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","any",41],"(",")",")",["T_WHITESPACE","\n            ",41],["T_OBJECT_OPERATOR","->",42],["T_STRING","method",42],"(",["T_CONSTANT_ENCAPSED_STRING","'getUserType'",42],")",["T_WHITESPACE","\n            ",42],["T_OBJECT_OPERATOR","->",43],["T_STRING","willReturn",43],"(",["T_STRING","UserContextInterface",43],["T_DOUBLE_COLON","::",43],["T_STRING","USER_TYPE_CUSTOMER",43],")",";",["T_WHITESPACE","\n        ",43],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","userContextMock",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","expects",44],"(",["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","any",44],"(",")",")",["T_OBJECT_OPERATOR","->",44],["T_STRING","method",44],"(",["T_CONSTANT_ENCAPSED_STRING","'getUserId'",44],")",["T_OBJECT_OPERATOR","->",44],["T_STRING","willReturn",44],"(",["T_LNUMBER","1",44],")",";",["T_WHITESPACE","\n        ",44],["T_VARIABLE","$quoteMock",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","expects",45],"(",["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","exactly",45],"(",["T_LNUMBER","2",45],")",")",["T_OBJECT_OPERATOR","->",45],["T_STRING","method",45],"(",["T_CONSTANT_ENCAPSED_STRING","'getCustomerId'",45],")",["T_OBJECT_OPERATOR","->",45],["T_STRING","willReturn",45],"(",["T_LNUMBER","2",45],")",";",["T_WHITESPACE","\n        ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","authorization",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","afterGetActive",46],"(",["T_VARIABLE","$quoteRepositoryMock",46],",",["T_WHITESPACE"," ",46],["T_VARIABLE","$quoteMock",46],")",";",["T_WHITESPACE","\n    ",46],"}",["T_WHITESPACE","\n\n    ",47],["T_PUBLIC","public",49],["T_WHITESPACE"," ",49],["T_FUNCTION","function",49],["T_WHITESPACE"," ",49],["T_STRING","testAfterGetActiveReturnsQuoteIfQuoteIsAllowedForCurrentUserContext",49],"(",")",["T_WHITESPACE","\n    ",49],"{",["T_WHITESPACE","\n        ",50],["T_VARIABLE","$quoteMock",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","getMock",51],"(",["T_NS_SEPARATOR","\\",51],["T_STRING","Magento",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Quote",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Model",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Quote",51],["T_DOUBLE_COLON","::",51],["T_CLASS","class",51],",",["T_WHITESPACE"," ",51],"[","]",",",["T_WHITESPACE"," ",51],"[","]",",",["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","''",51],",",["T_WHITESPACE"," ",51],["T_STRING","false",51],")",";",["T_WHITESPACE","\n        ",51],["T_VARIABLE","$quoteRepositoryMock",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","getMock",52],"(",["T_NS_SEPARATOR","\\",52],["T_STRING","Magento",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Quote",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Api",52],["T_NS_SEPARATOR","\\",52],["T_STRING","CartRepositoryInterface",52],["T_DOUBLE_COLON","::",52],["T_CLASS","class",52],")",";",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","userContextMock",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","expects",53],"(",["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","any",53],"(",")",")",["T_WHITESPACE","\n            ",53],["T_OBJECT_OPERATOR","->",54],["T_STRING","method",54],"(",["T_CONSTANT_ENCAPSED_STRING","'getUserType'",54],")",["T_WHITESPACE","\n            ",54],["T_OBJECT_OPERATOR","->",55],["T_STRING","willReturn",55],"(",["T_STRING","UserContextInterface",55],["T_DOUBLE_COLON","::",55],["T_STRING","USER_TYPE_GUEST",55],")",";",["T_WHITESPACE","\n        ",55],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","assertEquals",56],"(",["T_VARIABLE","$quoteMock",56],",",["T_WHITESPACE"," ",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","authorization",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","afterGetActive",56],"(",["T_VARIABLE","$quoteRepositoryMock",56],",",["T_WHITESPACE"," ",56],["T_VARIABLE","$quoteMock",56],")",")",";",["T_WHITESPACE","\n    ",56],"}",["T_WHITESPACE","\n\n    ",57],["T_DOC_COMMENT","\/**\n     * @expectedException \\Magento\\Framework\\Exception\\NoSuchEntityException\n     * @expectedExceptionMessage No such entity\n     *\/",59],["T_WHITESPACE","\n    ",62],["T_PUBLIC","public",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","testAfterGetActiveForCustomerThrowsExceptionIfQuoteIsNotAllowedForCurrentUserContext",63],"(",")",["T_WHITESPACE","\n    ",63],"{",["T_WHITESPACE","\n        ",64],["T_COMMENT","\/\/ Quote without customer ID\n",65],["T_WHITESPACE","        ",66],["T_VARIABLE","$quoteMock",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getMock",66],"(",["T_NS_SEPARATOR","\\",66],["T_STRING","Magento",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Quote",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Model",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Quote",66],["T_DOUBLE_COLON","::",66],["T_CLASS","class",66],",",["T_WHITESPACE"," ",66],"[",["T_CONSTANT_ENCAPSED_STRING","'getCustomerId'",66],"]",",",["T_WHITESPACE"," ",66],"[","]",",",["T_WHITESPACE"," ",66],["T_CONSTANT_ENCAPSED_STRING","''",66],",",["T_WHITESPACE"," ",66],["T_STRING","false",66],")",";",["T_WHITESPACE","\n        ",66],["T_VARIABLE","$quoteRepositoryMock",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getMock",67],"(",["T_NS_SEPARATOR","\\",67],["T_STRING","Magento",67],["T_NS_SEPARATOR","\\",67],["T_STRING","Quote",67],["T_NS_SEPARATOR","\\",67],["T_STRING","Api",67],["T_NS_SEPARATOR","\\",67],["T_STRING","CartRepositoryInterface",67],["T_DOUBLE_COLON","::",67],["T_CLASS","class",67],")",";",["T_WHITESPACE","\n        ",67],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","userContextMock",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","expects",68],"(",["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","any",68],"(",")",")",["T_OBJECT_OPERATOR","->",68],["T_STRING","method",68],"(",["T_CONSTANT_ENCAPSED_STRING","'getUserType'",68],")",["T_OBJECT_OPERATOR","->",68],["T_STRING","willReturn",68],"(",["T_WHITESPACE","\n            ",68],["T_STRING","UserContextInterface",69],["T_DOUBLE_COLON","::",69],["T_STRING","USER_TYPE_CUSTOMER",69],["T_WHITESPACE","\n        ",69],")",";",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$quoteMock",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","expects",71],"(",["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","exactly",71],"(",["T_LNUMBER","2",71],")",")",["T_OBJECT_OPERATOR","->",71],["T_STRING","method",71],"(",["T_CONSTANT_ENCAPSED_STRING","'getCustomerId'",71],")",["T_OBJECT_OPERATOR","->",71],["T_STRING","willReturn",71],"(",["T_LNUMBER","2",71],")",";",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","userContextMock",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","expects",72],"(",["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","any",72],"(",")",")",["T_OBJECT_OPERATOR","->",72],["T_STRING","method",72],"(",["T_CONSTANT_ENCAPSED_STRING","'getUserId'",72],")",["T_OBJECT_OPERATOR","->",72],["T_STRING","willReturn",72],"(",["T_LNUMBER","1",72],")",";",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","authorization",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","afterGetActive",73],"(",["T_VARIABLE","$quoteRepositoryMock",73],",",["T_WHITESPACE"," ",73],["T_VARIABLE","$quoteMock",73],")",";",["T_WHITESPACE","\n    ",73],"}",["T_WHITESPACE","\n\n    ",74],["T_PUBLIC","public",76],["T_WHITESPACE"," ",76],["T_FUNCTION","function",76],["T_WHITESPACE"," ",76],["T_STRING","testAfterGetActiveForCustomerReturnsQuoteIfQuoteIsAllowedForCurrentUserContext",76],"(",")",["T_WHITESPACE","\n    ",76],"{",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$quoteMock",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getMock",78],"(",["T_NS_SEPARATOR","\\",78],["T_STRING","Magento",78],["T_NS_SEPARATOR","\\",78],["T_STRING","Quote",78],["T_NS_SEPARATOR","\\",78],["T_STRING","Model",78],["T_NS_SEPARATOR","\\",78],["T_STRING","Quote",78],["T_DOUBLE_COLON","::",78],["T_CLASS","class",78],",",["T_WHITESPACE"," ",78],"[","]",",",["T_WHITESPACE"," ",78],"[","]",",",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","''",78],",",["T_WHITESPACE"," ",78],["T_STRING","false",78],")",";",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$quoteRepositoryMock",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","getMock",79],"(",["T_NS_SEPARATOR","\\",79],["T_STRING","Magento",79],["T_NS_SEPARATOR","\\",79],["T_STRING","Quote",79],["T_NS_SEPARATOR","\\",79],["T_STRING","Api",79],["T_NS_SEPARATOR","\\",79],["T_STRING","CartRepositoryInterface",79],["T_DOUBLE_COLON","::",79],["T_CLASS","class",79],")",";",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","userContextMock",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","expects",80],"(",["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","any",80],"(",")",")",["T_WHITESPACE","\n            ",80],["T_OBJECT_OPERATOR","->",81],["T_STRING","method",81],"(",["T_CONSTANT_ENCAPSED_STRING","'getUserType'",81],")",["T_WHITESPACE","\n            ",81],["T_OBJECT_OPERATOR","->",82],["T_STRING","willReturn",82],"(",["T_STRING","UserContextInterface",82],["T_DOUBLE_COLON","::",82],["T_STRING","USER_TYPE_GUEST",82],")",";",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","assertEquals",83],"(",["T_VARIABLE","$quoteMock",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","authorization",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","afterGetActive",83],"(",["T_VARIABLE","$quoteRepositoryMock",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$quoteMock",83],")",")",";",["T_WHITESPACE","\n    ",83],"}",["T_WHITESPACE","\n",84],"}",["T_WHITESPACE","\n",85]]