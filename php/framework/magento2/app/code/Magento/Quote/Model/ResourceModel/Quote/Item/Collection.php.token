[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Quote",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","ResourceModel",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Quote",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Item",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Quote item resource collection\n *\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",8],["T_WHITESPACE","\n",12],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","Collection",13],["T_WHITESPACE"," ",13],["T_EXTENDS","extends",13],["T_WHITESPACE"," ",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Framework",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Model",13],["T_NS_SEPARATOR","\\",13],["T_STRING","ResourceModel",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Db",13],["T_NS_SEPARATOR","\\",13],["T_STRING","VersionControl",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Collection",13],["T_WHITESPACE","\n",13],"{",["T_WHITESPACE","\n    ",14],["T_DOC_COMMENT","\/**\n     * Collection quote instance\n     *\n     * @var \\Magento\\Quote\\Model\\Quote\n     *\/",15],["T_WHITESPACE","\n    ",19],["T_PROTECTED","protected",20],["T_WHITESPACE"," ",20],["T_VARIABLE","$_quote",20],";",["T_WHITESPACE","\n\n    ",20],["T_DOC_COMMENT","\/**\n     * Product Ids array\n     *\n     * @var int[]\n     *\/",22],["T_WHITESPACE","\n    ",26],["T_PROTECTED","protected",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$_productIds",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],"[","]",";",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Model\\ResourceModel\\Quote\\Item\\Option\\CollectionFactory\n     *\/",29],["T_WHITESPACE","\n    ",31],["T_PROTECTED","protected",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$_itemOptionCollectionFactory",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Catalog\\Model\\ResourceModel\\Product\\CollectionFactory\n     *\/",34],["T_WHITESPACE","\n    ",36],["T_PROTECTED","protected",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$_productCollectionFactory",37],";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Model\\Quote\\Config\n     *\/",39],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$_quoteConfig",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\Data\\Collection\\EntityFactory $entityFactory\n     * @param \\Psr\\Log\\LoggerInterface $logger\n     * @param \\Magento\\Framework\\Data\\Collection\\Db\\FetchStrategyInterface $fetchStrategy\n     * @param \\Magento\\Framework\\Event\\ManagerInterface $eventManager\n     * @param \\Magento\\Framework\\Model\\ResourceModel\\Db\\VersionControl\\Snapshot $entitySnapshot\n     * @param Option\\CollectionFactory $itemOptionCollectionFactory\n     * @param \\Magento\\Catalog\\Model\\ResourceModel\\Product\\CollectionFactory $productCollectionFactory\n     * @param \\Magento\\Quote\\Model\\Quote\\Config $quoteConfig\n     * @param \\Magento\\Framework\\DB\\Adapter\\AdapterInterface $connection\n     * @param \\Magento\\Framework\\Model\\ResourceModel\\Db\\AbstractDb $resource\n     * @SuppressWarnings(PHPMD.ExcessiveParameterList)\n     *\/",44],["T_WHITESPACE","\n    ",56],["T_PUBLIC","public",57],["T_WHITESPACE"," ",57],["T_FUNCTION","function",57],["T_WHITESPACE"," ",57],["T_STRING","__construct",57],"(",["T_WHITESPACE","\n        ",57],["T_NS_SEPARATOR","\\",58],["T_STRING","Magento",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Framework",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Data",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Collection",58],["T_NS_SEPARATOR","\\",58],["T_STRING","EntityFactory",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$entityFactory",58],",",["T_WHITESPACE","\n        ",58],["T_NS_SEPARATOR","\\",59],["T_STRING","Psr",59],["T_NS_SEPARATOR","\\",59],["T_STRING","Log",59],["T_NS_SEPARATOR","\\",59],["T_STRING","LoggerInterface",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$logger",59],",",["T_WHITESPACE","\n        ",59],["T_NS_SEPARATOR","\\",60],["T_STRING","Magento",60],["T_NS_SEPARATOR","\\",60],["T_STRING","Framework",60],["T_NS_SEPARATOR","\\",60],["T_STRING","Data",60],["T_NS_SEPARATOR","\\",60],["T_STRING","Collection",60],["T_NS_SEPARATOR","\\",60],["T_STRING","Db",60],["T_NS_SEPARATOR","\\",60],["T_STRING","FetchStrategyInterface",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$fetchStrategy",60],",",["T_WHITESPACE","\n        ",60],["T_NS_SEPARATOR","\\",61],["T_STRING","Magento",61],["T_NS_SEPARATOR","\\",61],["T_STRING","Framework",61],["T_NS_SEPARATOR","\\",61],["T_STRING","Event",61],["T_NS_SEPARATOR","\\",61],["T_STRING","ManagerInterface",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$eventManager",61],",",["T_WHITESPACE","\n        ",61],["T_NS_SEPARATOR","\\",62],["T_STRING","Magento",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Framework",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Model",62],["T_NS_SEPARATOR","\\",62],["T_STRING","ResourceModel",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Db",62],["T_NS_SEPARATOR","\\",62],["T_STRING","VersionControl",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Snapshot",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$entitySnapshot",62],",",["T_WHITESPACE","\n        ",62],["T_NS_SEPARATOR","\\",63],["T_STRING","Magento",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Quote",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Model",63],["T_NS_SEPARATOR","\\",63],["T_STRING","ResourceModel",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Quote",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Item",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Option",63],["T_NS_SEPARATOR","\\",63],["T_STRING","CollectionFactory",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$itemOptionCollectionFactory",63],",",["T_WHITESPACE","\n        ",63],["T_NS_SEPARATOR","\\",64],["T_STRING","Magento",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Catalog",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Model",64],["T_NS_SEPARATOR","\\",64],["T_STRING","ResourceModel",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Product",64],["T_NS_SEPARATOR","\\",64],["T_STRING","CollectionFactory",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$productCollectionFactory",64],",",["T_WHITESPACE","\n        ",64],["T_NS_SEPARATOR","\\",65],["T_STRING","Magento",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Quote",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Model",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Quote",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Config",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$quoteConfig",65],",",["T_WHITESPACE","\n        ",65],["T_NS_SEPARATOR","\\",66],["T_STRING","Magento",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Framework",66],["T_NS_SEPARATOR","\\",66],["T_STRING","DB",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Adapter",66],["T_NS_SEPARATOR","\\",66],["T_STRING","AdapterInterface",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$connection",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_STRING","null",66],",",["T_WHITESPACE","\n        ",66],["T_NS_SEPARATOR","\\",67],["T_STRING","Magento",67],["T_NS_SEPARATOR","\\",67],["T_STRING","Framework",67],["T_NS_SEPARATOR","\\",67],["T_STRING","Model",67],["T_NS_SEPARATOR","\\",67],["T_STRING","ResourceModel",67],["T_NS_SEPARATOR","\\",67],["T_STRING","Db",67],["T_NS_SEPARATOR","\\",67],["T_STRING","AbstractDb",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$resource",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_STRING","null",67],["T_WHITESPACE","\n    ",67],")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n        ",68],["T_STRING","parent",69],["T_DOUBLE_COLON","::",69],["T_STRING","__construct",69],"(",["T_WHITESPACE","\n            ",69],["T_VARIABLE","$entityFactory",70],",",["T_WHITESPACE","\n            ",70],["T_VARIABLE","$logger",71],",",["T_WHITESPACE","\n            ",71],["T_VARIABLE","$fetchStrategy",72],",",["T_WHITESPACE","\n            ",72],["T_VARIABLE","$eventManager",73],",",["T_WHITESPACE","\n            ",73],["T_VARIABLE","$entitySnapshot",74],",",["T_WHITESPACE","\n            ",74],["T_VARIABLE","$connection",75],",",["T_WHITESPACE","\n            ",75],["T_VARIABLE","$resource",76],["T_WHITESPACE","\n        ",76],")",";",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","_itemOptionCollectionFactory",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$itemOptionCollectionFactory",78],";",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","_productCollectionFactory",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$productCollectionFactory",79],";",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","_quoteConfig",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$quoteConfig",80],";",["T_WHITESPACE","\n    ",80],"}",["T_WHITESPACE","\n\n    ",81],["T_DOC_COMMENT","\/**\n     * Initialize resource model\n     *\n     * @return void\n     *\/",83],["T_WHITESPACE","\n    ",87],["T_PROTECTED","protected",88],["T_WHITESPACE"," ",88],["T_FUNCTION","function",88],["T_WHITESPACE"," ",88],["T_STRING","_construct",88],"(",")",["T_WHITESPACE","\n    ",88],"{",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","_init",90],"(",["T_NS_SEPARATOR","\\",90],["T_STRING","Magento",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Quote",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Model",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Quote",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Item",90],["T_DOUBLE_COLON","::",90],["T_CLASS","class",90],",",["T_WHITESPACE"," ",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Magento",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Quote",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Model",90],["T_NS_SEPARATOR","\\",90],["T_STRING","ResourceModel",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Quote",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Item",90],["T_DOUBLE_COLON","::",90],["T_CLASS","class",90],")",";",["T_WHITESPACE","\n    ",90],"}",["T_WHITESPACE","\n\n    ",91],["T_DOC_COMMENT","\/**\n     * Retrieve store Id (From Quote)\n     *\n     * @return int\n     *\/",93],["T_WHITESPACE","\n    ",97],["T_PUBLIC","public",98],["T_WHITESPACE"," ",98],["T_FUNCTION","function",98],["T_WHITESPACE"," ",98],["T_STRING","getStoreId",98],"(",")",["T_WHITESPACE","\n    ",98],"{",["T_WHITESPACE","\n        ",99],["T_RETURN","return",100],["T_WHITESPACE"," ",100],["T_INT_CAST","(int)",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","_quote",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getStoreId",100],"(",")",";",["T_WHITESPACE","\n    ",100],"}",["T_WHITESPACE","\n\n    ",101],["T_DOC_COMMENT","\/**\n     * Set Quote object to Collection\n     *\n     * @param \\Magento\\Quote\\Model\\Quote $quote\n     * @return $this\n     *\/",103],["T_WHITESPACE","\n    ",108],["T_PUBLIC","public",109],["T_WHITESPACE"," ",109],["T_FUNCTION","function",109],["T_WHITESPACE"," ",109],["T_STRING","setQuote",109],"(",["T_VARIABLE","$quote",109],")",["T_WHITESPACE","\n    ",109],"{",["T_WHITESPACE","\n        ",110],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","_quote",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_VARIABLE","$quote",111],";",["T_WHITESPACE","\n        ",111],["T_VARIABLE","$quoteId",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$quote",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","getId",112],"(",")",";",["T_WHITESPACE","\n        ",112],["T_IF","if",113],["T_WHITESPACE"," ",113],"(",["T_VARIABLE","$quoteId",113],")",["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n            ",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","addFieldToFilter",114],"(",["T_CONSTANT_ENCAPSED_STRING","'quote_id'",114],",",["T_WHITESPACE"," ",114],["T_VARIABLE","$quote",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","getId",114],"(",")",")",";",["T_WHITESPACE","\n        ",114],"}",["T_WHITESPACE"," ",115],["T_ELSE","else",115],["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n            ",115],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","_totalRecords",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_LNUMBER","0",116],";",["T_WHITESPACE","\n            ",116],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","_setIsLoaded",117],"(",["T_STRING","true",117],")",";",["T_WHITESPACE","\n        ",117],"}",["T_WHITESPACE","\n        ",118],["T_RETURN","return",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],";",["T_WHITESPACE","\n    ",119],"}",["T_WHITESPACE","\n\n    ",120],["T_DOC_COMMENT","\/**\n     * Reset the collection and inner join it to quotes table\n     * Optionally can select items with specified product id only\n     *\n     * @param string $quotesTableName\n     * @param int $productId\n     * @return $this\n     *\/",122],["T_WHITESPACE","\n    ",129],["T_PUBLIC","public",130],["T_WHITESPACE"," ",130],["T_FUNCTION","function",130],["T_WHITESPACE"," ",130],["T_STRING","resetJoinQuotes",130],"(",["T_VARIABLE","$quotesTableName",130],",",["T_WHITESPACE"," ",130],["T_VARIABLE","$productId",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_STRING","null",130],")",["T_WHITESPACE","\n    ",130],"{",["T_WHITESPACE","\n        ",131],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","getSelect",132],"(",")",["T_OBJECT_OPERATOR","->",132],["T_STRING","reset",132],"(",")",["T_OBJECT_OPERATOR","->",132],["T_STRING","from",132],"(",["T_WHITESPACE","\n            ",132],"[",["T_CONSTANT_ENCAPSED_STRING","'qi'",133],["T_WHITESPACE"," ",133],["T_DOUBLE_ARROW","=>",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getResource",133],"(",")",["T_OBJECT_OPERATOR","->",133],["T_STRING","getMainTable",133],"(",")","]",",",["T_WHITESPACE","\n            ",133],"[",["T_CONSTANT_ENCAPSED_STRING","'item_id'",134],",",["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","'qty'",134],",",["T_WHITESPACE"," ",134],["T_CONSTANT_ENCAPSED_STRING","'quote_id'",134],"]",["T_WHITESPACE","\n        ",134],")",["T_OBJECT_OPERATOR","->",135],["T_STRING","joinInner",135],"(",["T_WHITESPACE","\n            ",135],"[",["T_CONSTANT_ENCAPSED_STRING","'q'",136],["T_WHITESPACE"," ",136],["T_DOUBLE_ARROW","=>",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$quotesTableName",136],"]",",",["T_WHITESPACE","\n            ",136],["T_CONSTANT_ENCAPSED_STRING","'qi.quote_id = q.entity_id'",137],",",["T_WHITESPACE","\n            ",137],"[",["T_CONSTANT_ENCAPSED_STRING","'store_id'",138],",",["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","'items_qty'",138],",",["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","'items_count'",138],"]",["T_WHITESPACE","\n        ",138],")",";",["T_WHITESPACE","\n        ",139],["T_IF","if",140],["T_WHITESPACE"," ",140],"(",["T_VARIABLE","$productId",140],")",["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n            ",140],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getSelect",141],"(",")",["T_OBJECT_OPERATOR","->",141],["T_STRING","where",141],"(",["T_CONSTANT_ENCAPSED_STRING","'qi.product_id = ?'",141],",",["T_WHITESPACE"," ",141],["T_INT_CAST","(int)",141],["T_VARIABLE","$productId",141],")",";",["T_WHITESPACE","\n        ",141],"}",["T_WHITESPACE","\n        ",142],["T_RETURN","return",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],";",["T_WHITESPACE","\n    ",143],"}",["T_WHITESPACE","\n\n    ",144],["T_DOC_COMMENT","\/**\n     * After load processing\n     *\n     * @return $this\n     *\/",146],["T_WHITESPACE","\n    ",150],["T_PROTECTED","protected",151],["T_WHITESPACE"," ",151],["T_FUNCTION","function",151],["T_WHITESPACE"," ",151],["T_STRING","_afterLoad",151],"(",")",["T_WHITESPACE","\n    ",151],"{",["T_WHITESPACE","\n        ",152],["T_STRING","parent",153],["T_DOUBLE_COLON","::",153],["T_STRING","_afterLoad",153],"(",")",";",["T_WHITESPACE","\n\n        ",153],["T_DOC_COMMENT","\/**\n         * Assign parent items\n         *\/",155],["T_WHITESPACE","\n        ",157],["T_FOREACH","foreach",158],["T_WHITESPACE"," ",158],"(",["T_VARIABLE","$this",158],["T_WHITESPACE"," ",158],["T_AS","as",158],["T_WHITESPACE"," ",158],["T_VARIABLE","$item",158],")",["T_WHITESPACE"," ",158],"{",["T_WHITESPACE","\n            ",158],["T_IF","if",159],["T_WHITESPACE"," ",159],"(",["T_VARIABLE","$item",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","getParentItemId",159],"(",")",")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n                ",159],["T_VARIABLE","$item",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","setParentItem",160],"(",["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","getItemById",160],"(",["T_VARIABLE","$item",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","getParentItemId",160],"(",")",")",")",";",["T_WHITESPACE","\n            ",160],"}",["T_WHITESPACE","\n            ",161],["T_IF","if",162],["T_WHITESPACE"," ",162],"(",["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","_quote",162],")",["T_WHITESPACE"," ",162],"{",["T_WHITESPACE","\n                ",162],["T_VARIABLE","$item",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","setQuote",163],"(",["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","_quote",163],")",";",["T_WHITESPACE","\n            ",163],"}",["T_WHITESPACE","\n        ",164],"}",["T_WHITESPACE","\n\n        ",165],["T_DOC_COMMENT","\/**\n         * Assign options and products\n         *\/",167],["T_WHITESPACE","\n        ",169],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","_assignOptions",170],"(",")",";",["T_WHITESPACE","\n        ",170],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","_assignProducts",171],"(",")",";",["T_WHITESPACE","\n        ",171],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","resetItemsDataChanged",172],"(",")",";",["T_WHITESPACE","\n\n        ",172],["T_RETURN","return",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],";",["T_WHITESPACE","\n    ",174],"}",["T_WHITESPACE","\n\n    ",175],["T_DOC_COMMENT","\/**\n     * Add options to items\n     *\n     * @return $this\n     *\/",177],["T_WHITESPACE","\n    ",181],["T_PROTECTED","protected",182],["T_WHITESPACE"," ",182],["T_FUNCTION","function",182],["T_WHITESPACE"," ",182],["T_STRING","_assignOptions",182],"(",")",["T_WHITESPACE","\n    ",182],"{",["T_WHITESPACE","\n        ",183],["T_VARIABLE","$itemIds",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_STRING","array_keys",184],"(",["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","_items",184],")",";",["T_WHITESPACE","\n        ",184],["T_VARIABLE","$optionCollection",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","_itemOptionCollectionFactory",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","create",185],"(",")",["T_OBJECT_OPERATOR","->",185],["T_STRING","addItemFilter",185],"(",["T_VARIABLE","$itemIds",185],")",";",["T_WHITESPACE","\n        ",185],["T_FOREACH","foreach",186],["T_WHITESPACE"," ",186],"(",["T_VARIABLE","$this",186],["T_WHITESPACE"," ",186],["T_AS","as",186],["T_WHITESPACE"," ",186],["T_VARIABLE","$item",186],")",["T_WHITESPACE"," ",186],"{",["T_WHITESPACE","\n            ",186],["T_VARIABLE","$item",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","setOptions",187],"(",["T_VARIABLE","$optionCollection",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","getOptionsByItem",187],"(",["T_VARIABLE","$item",187],")",")",";",["T_WHITESPACE","\n        ",187],"}",["T_WHITESPACE","\n        ",188],["T_VARIABLE","$productIds",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_VARIABLE","$optionCollection",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getProductIds",189],"(",")",";",["T_WHITESPACE","\n        ",189],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","_productIds",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_STRING","array_merge",190],"(",["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","_productIds",190],",",["T_WHITESPACE"," ",190],["T_VARIABLE","$productIds",190],")",";",["T_WHITESPACE","\n\n        ",190],["T_RETURN","return",192],["T_WHITESPACE"," ",192],["T_VARIABLE","$this",192],";",["T_WHITESPACE","\n    ",192],"}",["T_WHITESPACE","\n\n    ",193],["T_DOC_COMMENT","\/**\n     * Add products to items and item options\n     *\n     * @return $this\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     *\/",195],["T_WHITESPACE","\n    ",200],["T_PROTECTED","protected",201],["T_WHITESPACE"," ",201],["T_FUNCTION","function",201],["T_WHITESPACE"," ",201],["T_STRING","_assignProducts",201],"(",")",["T_WHITESPACE","\n    ",201],"{",["T_WHITESPACE","\n        ",202],["T_NS_SEPARATOR","\\",203],["T_STRING","Magento",203],["T_NS_SEPARATOR","\\",203],["T_STRING","Framework",203],["T_NS_SEPARATOR","\\",203],["T_STRING","Profiler",203],["T_DOUBLE_COLON","::",203],["T_STRING","start",203],"(",["T_CONSTANT_ENCAPSED_STRING","'QUOTE:'",203],["T_WHITESPACE"," ",203],".",["T_WHITESPACE"," ",203],["T_METHOD_C","__METHOD__",203],",",["T_WHITESPACE"," ",203],"[",["T_CONSTANT_ENCAPSED_STRING","'group'",203],["T_WHITESPACE"," ",203],["T_DOUBLE_ARROW","=>",203],["T_WHITESPACE"," ",203],["T_CONSTANT_ENCAPSED_STRING","'QUOTE'",203],",",["T_WHITESPACE"," ",203],["T_CONSTANT_ENCAPSED_STRING","'method'",203],["T_WHITESPACE"," ",203],["T_DOUBLE_ARROW","=>",203],["T_WHITESPACE"," ",203],["T_METHOD_C","__METHOD__",203],"]",")",";",["T_WHITESPACE","\n        ",203],["T_VARIABLE","$productIds",204],["T_WHITESPACE"," ",204],"=",["T_WHITESPACE"," ",204],"[","]",";",["T_WHITESPACE","\n        ",204],["T_FOREACH","foreach",205],["T_WHITESPACE"," ",205],"(",["T_VARIABLE","$this",205],["T_WHITESPACE"," ",205],["T_AS","as",205],["T_WHITESPACE"," ",205],["T_VARIABLE","$item",205],")",["T_WHITESPACE"," ",205],"{",["T_WHITESPACE","\n            ",205],["T_VARIABLE","$productIds",206],"[","]",["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],["T_INT_CAST","(int)",206],["T_VARIABLE","$item",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","getProductId",206],"(",")",";",["T_WHITESPACE","\n        ",206],"}",["T_WHITESPACE","\n        ",207],["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","_productIds",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_STRING","array_merge",208],"(",["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","_productIds",208],",",["T_WHITESPACE"," ",208],["T_VARIABLE","$productIds",208],")",";",["T_WHITESPACE","\n\n        ",208],["T_VARIABLE","$productCollection",210],["T_WHITESPACE"," ",210],"=",["T_WHITESPACE"," ",210],["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","_productCollectionFactory",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","create",210],"(",")",["T_OBJECT_OPERATOR","->",210],["T_STRING","setStoreId",210],"(",["T_WHITESPACE","\n            ",210],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","getStoreId",211],"(",")",["T_WHITESPACE","\n        ",211],")",["T_OBJECT_OPERATOR","->",212],["T_STRING","addIdFilter",212],"(",["T_WHITESPACE","\n            ",212],["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","_productIds",213],["T_WHITESPACE","\n        ",213],")",["T_OBJECT_OPERATOR","->",214],["T_STRING","addAttributeToSelect",214],"(",["T_WHITESPACE","\n            ",214],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","_quoteConfig",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","getProductAttributes",215],"(",")",["T_WHITESPACE","\n        ",215],")",["T_OBJECT_OPERATOR","->",216],["T_STRING","addOptionsToResult",216],"(",")",["T_OBJECT_OPERATOR","->",216],["T_STRING","addStoreFilter",216],"(",")",["T_OBJECT_OPERATOR","->",216],["T_STRING","addUrlRewrite",216],"(",")",["T_OBJECT_OPERATOR","->",216],["T_STRING","addTierPriceData",216],"(",")",";",["T_WHITESPACE","\n\n        ",216],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","_eventManager",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","dispatch",218],"(",["T_WHITESPACE","\n            ",218],["T_CONSTANT_ENCAPSED_STRING","'prepare_catalog_product_collection_prices'",219],",",["T_WHITESPACE","\n            ",219],"[",["T_CONSTANT_ENCAPSED_STRING","'collection'",220],["T_WHITESPACE"," ",220],["T_DOUBLE_ARROW","=>",220],["T_WHITESPACE"," ",220],["T_VARIABLE","$productCollection",220],",",["T_WHITESPACE"," ",220],["T_CONSTANT_ENCAPSED_STRING","'store_id'",220],["T_WHITESPACE"," ",220],["T_DOUBLE_ARROW","=>",220],["T_WHITESPACE"," ",220],["T_VARIABLE","$this",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","getStoreId",220],"(",")","]",["T_WHITESPACE","\n        ",220],")",";",["T_WHITESPACE","\n        ",221],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","_eventManager",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","dispatch",222],"(",["T_WHITESPACE","\n            ",222],["T_CONSTANT_ENCAPSED_STRING","'sales_quote_item_collection_products_after_load'",223],",",["T_WHITESPACE","\n            ",223],"[",["T_CONSTANT_ENCAPSED_STRING","'collection'",224],["T_WHITESPACE"," ",224],["T_DOUBLE_ARROW","=>",224],["T_WHITESPACE"," ",224],["T_VARIABLE","$productCollection",224],"]",["T_WHITESPACE","\n        ",224],")",";",["T_WHITESPACE","\n\n        ",225],["T_VARIABLE","$recollectQuote",227],["T_WHITESPACE"," ",227],"=",["T_WHITESPACE"," ",227],["T_STRING","false",227],";",["T_WHITESPACE","\n        ",227],["T_FOREACH","foreach",228],["T_WHITESPACE"," ",228],"(",["T_VARIABLE","$this",228],["T_WHITESPACE"," ",228],["T_AS","as",228],["T_WHITESPACE"," ",228],["T_VARIABLE","$item",228],")",["T_WHITESPACE"," ",228],"{",["T_WHITESPACE","\n            ",228],["T_VARIABLE","$product",229],["T_WHITESPACE"," ",229],"=",["T_WHITESPACE"," ",229],["T_VARIABLE","$productCollection",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","getItemById",229],"(",["T_VARIABLE","$item",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","getProductId",229],"(",")",")",";",["T_WHITESPACE","\n            ",229],["T_IF","if",230],["T_WHITESPACE"," ",230],"(",["T_VARIABLE","$product",230],")",["T_WHITESPACE"," ",230],"{",["T_WHITESPACE","\n                ",230],["T_VARIABLE","$product",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","setCustomOptions",231],"(","[","]",")",";",["T_WHITESPACE","\n                ",231],["T_VARIABLE","$qtyOptions",232],["T_WHITESPACE"," ",232],"=",["T_WHITESPACE"," ",232],"[","]",";",["T_WHITESPACE","\n                ",232],["T_VARIABLE","$optionProductIds",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],"[","]",";",["T_WHITESPACE","\n                ",233],["T_FOREACH","foreach",234],["T_WHITESPACE"," ",234],"(",["T_VARIABLE","$item",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","getOptions",234],"(",")",["T_WHITESPACE"," ",234],["T_AS","as",234],["T_WHITESPACE"," ",234],["T_VARIABLE","$option",234],")",["T_WHITESPACE"," ",234],"{",["T_WHITESPACE","\n                    ",234],["T_DOC_COMMENT","\/**\n                     * Call type-specific logic for product associated with quote item\n                     *\/",235],["T_WHITESPACE","\n                    ",237],["T_VARIABLE","$product",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","getTypeInstance",238],"(",")",["T_OBJECT_OPERATOR","->",238],["T_STRING","assignProductToOption",238],"(",["T_WHITESPACE","\n                        ",238],["T_VARIABLE","$productCollection",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","getItemById",239],"(",["T_VARIABLE","$option",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","getProductId",239],"(",")",")",",",["T_WHITESPACE","\n                        ",239],["T_VARIABLE","$option",240],",",["T_WHITESPACE","\n                        ",240],["T_VARIABLE","$product",241],["T_WHITESPACE","\n                    ",241],")",";",["T_WHITESPACE","\n\n                    ",242],["T_IF","if",244],["T_WHITESPACE"," ",244],"(",["T_STRING","is_object",244],"(",["T_VARIABLE","$option",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","getProduct",244],"(",")",")",["T_WHITESPACE"," ",244],["T_BOOLEAN_AND","&&",244],["T_WHITESPACE"," ",244],["T_VARIABLE","$option",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","getProduct",244],"(",")",["T_OBJECT_OPERATOR","->",244],["T_STRING","getId",244],"(",")",["T_WHITESPACE"," ",244],["T_IS_NOT_EQUAL","!=",244],["T_WHITESPACE"," ",244],["T_VARIABLE","$product",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","getId",244],"(",")",")",["T_WHITESPACE"," ",244],"{",["T_WHITESPACE","\n                        ",244],["T_VARIABLE","$optionProductIds",245],"[",["T_VARIABLE","$option",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","getProduct",245],"(",")",["T_OBJECT_OPERATOR","->",245],["T_STRING","getId",245],"(",")","]",["T_WHITESPACE"," ",245],"=",["T_WHITESPACE"," ",245],["T_VARIABLE","$option",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","getProduct",245],"(",")",["T_OBJECT_OPERATOR","->",245],["T_STRING","getId",245],"(",")",";",["T_WHITESPACE","\n                    ",245],"}",["T_WHITESPACE","\n                ",246],"}",["T_WHITESPACE","\n\n                ",247],["T_IF","if",249],["T_WHITESPACE"," ",249],"(",["T_VARIABLE","$optionProductIds",249],")",["T_WHITESPACE"," ",249],"{",["T_WHITESPACE","\n                    ",249],["T_FOREACH","foreach",250],["T_WHITESPACE"," ",250],"(",["T_VARIABLE","$optionProductIds",250],["T_WHITESPACE"," ",250],["T_AS","as",250],["T_WHITESPACE"," ",250],["T_VARIABLE","$optionProductId",250],")",["T_WHITESPACE"," ",250],"{",["T_WHITESPACE","\n                        ",250],["T_VARIABLE","$qtyOption",251],["T_WHITESPACE"," ",251],"=",["T_WHITESPACE"," ",251],["T_VARIABLE","$item",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","getOptionByCode",251],"(",["T_CONSTANT_ENCAPSED_STRING","'product_qty_'",251],["T_WHITESPACE"," ",251],".",["T_WHITESPACE"," ",251],["T_VARIABLE","$optionProductId",251],")",";",["T_WHITESPACE","\n                        ",251],["T_IF","if",252],["T_WHITESPACE"," ",252],"(",["T_VARIABLE","$qtyOption",252],")",["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n                            ",252],["T_VARIABLE","$qtyOptions",253],"[",["T_VARIABLE","$optionProductId",253],"]",["T_WHITESPACE"," ",253],"=",["T_WHITESPACE"," ",253],["T_VARIABLE","$qtyOption",253],";",["T_WHITESPACE","\n                        ",253],"}",["T_WHITESPACE","\n                    ",254],"}",["T_WHITESPACE","\n                ",255],"}",["T_WHITESPACE","\n\n                ",256],["T_VARIABLE","$item",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","setQtyOptions",258],"(",["T_VARIABLE","$qtyOptions",258],")",["T_OBJECT_OPERATOR","->",258],["T_STRING","setProduct",258],"(",["T_VARIABLE","$product",258],")",";",["T_WHITESPACE","\n            ",258],"}",["T_WHITESPACE"," ",259],["T_ELSE","else",259],["T_WHITESPACE"," ",259],"{",["T_WHITESPACE","\n                ",259],["T_VARIABLE","$item",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","isDeleted",260],"(",["T_STRING","true",260],")",";",["T_WHITESPACE","\n                ",260],["T_VARIABLE","$recollectQuote",261],["T_WHITESPACE"," ",261],"=",["T_WHITESPACE"," ",261],["T_STRING","true",261],";",["T_WHITESPACE","\n            ",261],"}",["T_WHITESPACE","\n            ",262],["T_VARIABLE","$item",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","checkData",263],"(",")",";",["T_WHITESPACE","\n        ",263],"}",["T_WHITESPACE","\n\n        ",264],["T_IF","if",266],["T_WHITESPACE"," ",266],"(",["T_VARIABLE","$recollectQuote",266],["T_WHITESPACE"," ",266],["T_BOOLEAN_AND","&&",266],["T_WHITESPACE"," ",266],["T_VARIABLE","$this",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","_quote",266],")",["T_WHITESPACE"," ",266],"{",["T_WHITESPACE","\n            ",266],["T_VARIABLE","$this",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","_quote",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","collectTotals",267],"(",")",";",["T_WHITESPACE","\n        ",267],"}",["T_WHITESPACE","\n        ",268],["T_NS_SEPARATOR","\\",269],["T_STRING","Magento",269],["T_NS_SEPARATOR","\\",269],["T_STRING","Framework",269],["T_NS_SEPARATOR","\\",269],["T_STRING","Profiler",269],["T_DOUBLE_COLON","::",269],["T_STRING","stop",269],"(",["T_CONSTANT_ENCAPSED_STRING","'QUOTE:'",269],["T_WHITESPACE"," ",269],".",["T_WHITESPACE"," ",269],["T_METHOD_C","__METHOD__",269],")",";",["T_WHITESPACE","\n\n        ",269],["T_RETURN","return",271],["T_WHITESPACE"," ",271],["T_VARIABLE","$this",271],";",["T_WHITESPACE","\n    ",271],"}",["T_WHITESPACE","\n",272],"}",["T_WHITESPACE","\n",273]]