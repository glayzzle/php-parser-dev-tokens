[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_COMMENT","\/\/ @codingStandardsIgnoreFile\n",7],["T_WHITESPACE","\n",8],["T_NAMESPACE","namespace",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Quote",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Model",9],["T_NS_SEPARATOR","\\",9],["T_STRING","ResourceModel",9],";",["T_WHITESPACE","\n\n",9],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Framework",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Model",11],["T_NS_SEPARATOR","\\",11],["T_STRING","ResourceModel",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Db",11],["T_NS_SEPARATOR","\\",11],["T_STRING","VersionControl",11],["T_NS_SEPARATOR","\\",11],["T_STRING","AbstractDb",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Framework",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Model",12],["T_NS_SEPARATOR","\\",12],["T_STRING","ResourceModel",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Db",12],["T_NS_SEPARATOR","\\",12],["T_STRING","VersionControl",12],["T_NS_SEPARATOR","\\",12],["T_STRING","RelationComposite",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Framework",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Model",13],["T_NS_SEPARATOR","\\",13],["T_STRING","ResourceModel",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Db",13],["T_NS_SEPARATOR","\\",13],["T_STRING","VersionControl",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Snapshot",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","SalesSequence",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Model",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Manager",14],";",["T_WHITESPACE","\n\n",14],["T_DOC_COMMENT","\/**\n * Quote resource model\n *\/",16],["T_WHITESPACE","\n",18],["T_CLASS","class",19],["T_WHITESPACE"," ",19],["T_STRING","Quote",19],["T_WHITESPACE"," ",19],["T_EXTENDS","extends",19],["T_WHITESPACE"," ",19],["T_STRING","AbstractDb",19],["T_WHITESPACE","\n",19],"{",["T_WHITESPACE","\n    ",20],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\SalesSequence\\Model\\Manager\n     *\/",21],["T_WHITESPACE","\n    ",23],["T_PROTECTED","protected",24],["T_WHITESPACE"," ",24],["T_VARIABLE","$sequenceManager",24],";",["T_WHITESPACE","\n\n    ",24],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\Model\\ResourceModel\\Db\\Context $context\n     * @param Snapshot $entitySnapshot,\n     * @param RelationComposite $entityRelationComposite,\n     * @param \\Magento\\SalesSequence\\Model\\Manager $sequenceManager\n     * @param string $connectionName\n     *\/",26],["T_WHITESPACE","\n    ",32],["T_PUBLIC","public",33],["T_WHITESPACE"," ",33],["T_FUNCTION","function",33],["T_WHITESPACE"," ",33],["T_STRING","__construct",33],"(",["T_WHITESPACE","\n        ",33],["T_NS_SEPARATOR","\\",34],["T_STRING","Magento",34],["T_NS_SEPARATOR","\\",34],["T_STRING","Framework",34],["T_NS_SEPARATOR","\\",34],["T_STRING","Model",34],["T_NS_SEPARATOR","\\",34],["T_STRING","ResourceModel",34],["T_NS_SEPARATOR","\\",34],["T_STRING","Db",34],["T_NS_SEPARATOR","\\",34],["T_STRING","Context",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$context",34],",",["T_WHITESPACE","\n        ",34],["T_STRING","Snapshot",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$entitySnapshot",35],",",["T_WHITESPACE","\n        ",35],["T_STRING","RelationComposite",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$entityRelationComposite",36],",",["T_WHITESPACE","\n        ",36],["T_STRING","Manager",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$sequenceManager",37],",",["T_WHITESPACE","\n        ",37],["T_VARIABLE","$connectionName",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_STRING","null",38],["T_WHITESPACE","\n    ",38],")",["T_WHITESPACE"," ",39],"{",["T_WHITESPACE","\n        ",39],["T_STRING","parent",40],["T_DOUBLE_COLON","::",40],["T_STRING","__construct",40],"(",["T_VARIABLE","$context",40],",",["T_WHITESPACE"," ",40],["T_VARIABLE","$entitySnapshot",40],",",["T_WHITESPACE"," ",40],["T_VARIABLE","$entityRelationComposite",40],",",["T_WHITESPACE"," ",40],["T_VARIABLE","$connectionName",40],")",";",["T_WHITESPACE","\n        ",40],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","sequenceManager",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$sequenceManager",41],";",["T_WHITESPACE","\n    ",41],"}",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Initialize table nad PK name\n     *\n     * @return void\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_FUNCTION","function",49],["T_WHITESPACE"," ",49],["T_STRING","_construct",49],"(",")",["T_WHITESPACE","\n    ",49],"{",["T_WHITESPACE","\n        ",50],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","_init",51],"(",["T_CONSTANT_ENCAPSED_STRING","'quote'",51],",",["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",51],")",";",["T_WHITESPACE","\n    ",51],"}",["T_WHITESPACE","\n\n    ",52],["T_DOC_COMMENT","\/**\n     * Retrieve select object for load object data\n     *\n     * @param string $field\n     * @param mixed $value\n     * @param \\Magento\\Framework\\Model\\AbstractModel $object\n     * @return \\Magento\\Framework\\DB\\Select\n     *\/",54],["T_WHITESPACE","\n    ",61],["T_PROTECTED","protected",62],["T_WHITESPACE"," ",62],["T_FUNCTION","function",62],["T_WHITESPACE"," ",62],["T_STRING","_getLoadSelect",62],"(",["T_VARIABLE","$field",62],",",["T_WHITESPACE"," ",62],["T_VARIABLE","$value",62],",",["T_WHITESPACE"," ",62],["T_VARIABLE","$object",62],")",["T_WHITESPACE","\n    ",62],"{",["T_WHITESPACE","\n        ",63],["T_VARIABLE","$select",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_STRING","parent",64],["T_DOUBLE_COLON","::",64],["T_STRING","_getLoadSelect",64],"(",["T_VARIABLE","$field",64],",",["T_WHITESPACE"," ",64],["T_VARIABLE","$value",64],",",["T_WHITESPACE"," ",64],["T_VARIABLE","$object",64],")",";",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$storeIds",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$object",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getSharedStoreIds",65],"(",")",";",["T_WHITESPACE","\n        ",65],["T_IF","if",66],["T_WHITESPACE"," ",66],"(",["T_VARIABLE","$storeIds",66],")",["T_WHITESPACE"," ",66],"{",["T_WHITESPACE","\n            ",66],["T_IF","if",67],["T_WHITESPACE"," ",67],"(",["T_VARIABLE","$storeIds",67],["T_WHITESPACE"," ",67],["T_IS_NOT_EQUAL","!=",67],["T_WHITESPACE"," ",67],"[",["T_CONSTANT_ENCAPSED_STRING","'*'",67],"]",")",["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n                ",67],["T_VARIABLE","$select",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","where",68],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id IN (?)'",68],",",["T_WHITESPACE"," ",68],["T_VARIABLE","$storeIds",68],")",";",["T_WHITESPACE","\n            ",68],"}",["T_WHITESPACE","\n        ",69],"}",["T_WHITESPACE"," ",70],["T_ELSE","else",70],["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n            ",70],["T_DOC_COMMENT","\/**\n             * For empty result\n             *\/",71],["T_WHITESPACE","\n            ",73],["T_VARIABLE","$select",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","where",74],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id < ?'",74],",",["T_WHITESPACE"," ",74],["T_LNUMBER","0",74],")",";",["T_WHITESPACE","\n        ",74],"}",["T_WHITESPACE","\n\n        ",75],["T_RETURN","return",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$select",77],";",["T_WHITESPACE","\n    ",77],"}",["T_WHITESPACE","\n\n    ",78],["T_DOC_COMMENT","\/**\n     * Load quote data by customer identifier\n     *\n     * @param \\Magento\\Quote\\Model\\Quote $quote\n     * @param int $customerId\n     * @return $this\n     *\/",80],["T_WHITESPACE","\n    ",86],["T_PUBLIC","public",87],["T_WHITESPACE"," ",87],["T_FUNCTION","function",87],["T_WHITESPACE"," ",87],["T_STRING","loadByCustomerId",87],"(",["T_VARIABLE","$quote",87],",",["T_WHITESPACE"," ",87],["T_VARIABLE","$customerId",87],")",["T_WHITESPACE","\n    ",87],"{",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$connection",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getConnection",89],"(",")",";",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$select",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","_getLoadSelect",90],"(",["T_WHITESPACE","\n            ",90],["T_CONSTANT_ENCAPSED_STRING","'customer_id'",91],",",["T_WHITESPACE","\n            ",91],["T_VARIABLE","$customerId",92],",",["T_WHITESPACE","\n            ",92],["T_VARIABLE","$quote",93],["T_WHITESPACE","\n        ",93],")",["T_OBJECT_OPERATOR","->",94],["T_STRING","where",94],"(",["T_WHITESPACE","\n            ",94],["T_CONSTANT_ENCAPSED_STRING","'is_active = ?'",95],",",["T_WHITESPACE","\n            ",95],["T_LNUMBER","1",96],["T_WHITESPACE","\n        ",96],")",["T_OBJECT_OPERATOR","->",97],["T_STRING","order",97],"(",["T_WHITESPACE","\n            ",97],["T_CONSTANT_ENCAPSED_STRING","'updated_at '",98],["T_WHITESPACE"," ",98],".",["T_WHITESPACE"," ",98],["T_NS_SEPARATOR","\\",98],["T_STRING","Magento",98],["T_NS_SEPARATOR","\\",98],["T_STRING","Framework",98],["T_NS_SEPARATOR","\\",98],["T_STRING","DB",98],["T_NS_SEPARATOR","\\",98],["T_STRING","Select",98],["T_DOUBLE_COLON","::",98],["T_STRING","SQL_DESC",98],["T_WHITESPACE","\n        ",98],")",["T_OBJECT_OPERATOR","->",99],["T_STRING","limit",99],"(",["T_WHITESPACE","\n            ",99],["T_LNUMBER","1",100],["T_WHITESPACE","\n        ",100],")",";",["T_WHITESPACE","\n\n        ",101],["T_VARIABLE","$data",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$connection",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","fetchRow",103],"(",["T_VARIABLE","$select",103],")",";",["T_WHITESPACE","\n\n        ",103],["T_IF","if",105],["T_WHITESPACE"," ",105],"(",["T_VARIABLE","$data",105],")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n            ",105],["T_VARIABLE","$quote",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","setData",106],"(",["T_VARIABLE","$data",106],")",";",["T_WHITESPACE","\n        ",106],"}",["T_WHITESPACE","\n\n        ",107],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","_afterLoad",109],"(",["T_VARIABLE","$quote",109],")",";",["T_WHITESPACE","\n\n        ",109],["T_RETURN","return",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],";",["T_WHITESPACE","\n    ",111],"}",["T_WHITESPACE","\n\n    ",112],["T_DOC_COMMENT","\/**\n     * Load only active quote\n     *\n     * @param \\Magento\\Quote\\Model\\Quote $quote\n     * @param int $quoteId\n     * @return $this\n     *\/",114],["T_WHITESPACE","\n    ",120],["T_PUBLIC","public",121],["T_WHITESPACE"," ",121],["T_FUNCTION","function",121],["T_WHITESPACE"," ",121],["T_STRING","loadActive",121],"(",["T_VARIABLE","$quote",121],",",["T_WHITESPACE"," ",121],["T_VARIABLE","$quoteId",121],")",["T_WHITESPACE","\n    ",121],"{",["T_WHITESPACE","\n        ",122],["T_VARIABLE","$connection",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getConnection",123],"(",")",";",["T_WHITESPACE","\n        ",123],["T_VARIABLE","$select",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","_getLoadSelect",124],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$quoteId",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$quote",124],")",["T_OBJECT_OPERATOR","->",124],["T_STRING","where",124],"(",["T_CONSTANT_ENCAPSED_STRING","'is_active = ?'",124],",",["T_WHITESPACE"," ",124],["T_LNUMBER","1",124],")",";",["T_WHITESPACE","\n\n        ",124],["T_VARIABLE","$data",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$connection",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","fetchRow",126],"(",["T_VARIABLE","$select",126],")",";",["T_WHITESPACE","\n        ",126],["T_IF","if",127],["T_WHITESPACE"," ",127],"(",["T_VARIABLE","$data",127],")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n            ",127],["T_VARIABLE","$quote",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","setData",128],"(",["T_VARIABLE","$data",128],")",";",["T_WHITESPACE","\n        ",128],"}",["T_WHITESPACE","\n\n        ",129],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","_afterLoad",131],"(",["T_VARIABLE","$quote",131],")",";",["T_WHITESPACE","\n\n        ",131],["T_RETURN","return",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],";",["T_WHITESPACE","\n    ",133],"}",["T_WHITESPACE","\n\n    ",134],["T_DOC_COMMENT","\/**\n     * Load quote data by identifier without store\n     *\n     * @param \\Magento\\Quote\\Model\\Quote $quote\n     * @param int $quoteId\n     * @return $this\n     *\/",136],["T_WHITESPACE","\n    ",142],["T_PUBLIC","public",143],["T_WHITESPACE"," ",143],["T_FUNCTION","function",143],["T_WHITESPACE"," ",143],["T_STRING","loadByIdWithoutStore",143],"(",["T_VARIABLE","$quote",143],",",["T_WHITESPACE"," ",143],["T_VARIABLE","$quoteId",143],")",["T_WHITESPACE","\n    ",143],"{",["T_WHITESPACE","\n        ",144],["T_VARIABLE","$connection",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getConnection",145],"(",")",";",["T_WHITESPACE","\n        ",145],["T_IF","if",146],["T_WHITESPACE"," ",146],"(",["T_VARIABLE","$connection",146],")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n            ",146],["T_VARIABLE","$select",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_STRING","parent",147],["T_DOUBLE_COLON","::",147],["T_STRING","_getLoadSelect",147],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",147],",",["T_WHITESPACE"," ",147],["T_VARIABLE","$quoteId",147],",",["T_WHITESPACE"," ",147],["T_VARIABLE","$quote",147],")",";",["T_WHITESPACE","\n\n            ",147],["T_VARIABLE","$data",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_VARIABLE","$connection",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","fetchRow",149],"(",["T_VARIABLE","$select",149],")",";",["T_WHITESPACE","\n\n            ",149],["T_IF","if",151],["T_WHITESPACE"," ",151],"(",["T_VARIABLE","$data",151],")",["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n                ",151],["T_VARIABLE","$quote",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","setData",152],"(",["T_VARIABLE","$data",152],")",";",["T_WHITESPACE","\n            ",152],"}",["T_WHITESPACE","\n        ",153],"}",["T_WHITESPACE","\n\n        ",154],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","_afterLoad",156],"(",["T_VARIABLE","$quote",156],")",";",["T_WHITESPACE","\n        ",156],["T_RETURN","return",157],["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],";",["T_WHITESPACE","\n    ",157],"}",["T_WHITESPACE","\n\n    ",158],["T_DOC_COMMENT","\/**\n     * Get reserved order id\n     *\n     * @param \\Magento\\Quote\\Model\\Quote $quote\n     * @return string\n     *\/",160],["T_WHITESPACE","\n    ",165],["T_PUBLIC","public",166],["T_WHITESPACE"," ",166],["T_FUNCTION","function",166],["T_WHITESPACE"," ",166],["T_STRING","getReservedOrderId",166],"(",["T_VARIABLE","$quote",166],")",["T_WHITESPACE","\n    ",166],"{",["T_WHITESPACE","\n        ",167],["T_RETURN","return",168],["T_WHITESPACE"," ",168],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","sequenceManager",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","getSequence",168],"(",["T_WHITESPACE","\n            ",168],["T_NS_SEPARATOR","\\",169],["T_STRING","Magento",169],["T_NS_SEPARATOR","\\",169],["T_STRING","Sales",169],["T_NS_SEPARATOR","\\",169],["T_STRING","Model",169],["T_NS_SEPARATOR","\\",169],["T_STRING","Order",169],["T_DOUBLE_COLON","::",169],["T_STRING","ENTITY",169],",",["T_WHITESPACE","\n            ",169],["T_VARIABLE","$quote",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","getStore",170],"(",")",["T_OBJECT_OPERATOR","->",170],["T_STRING","getGroup",170],"(",")",["T_OBJECT_OPERATOR","->",170],["T_STRING","getDefaultStoreId",170],"(",")",["T_WHITESPACE","\n        ",170],")",["T_WHITESPACE","\n        ",171],["T_OBJECT_OPERATOR","->",172],["T_STRING","getNextValue",172],"(",")",";",["T_WHITESPACE","\n    ",172],"}",["T_WHITESPACE","\n\n    ",173],["T_DOC_COMMENT","\/**\n     * Check if order increment ID is already used.\n     * Method can be used to avoid collisions of order IDs.\n     *\n     * @param int $orderIncrementId\n     * @return bool\n     *\/",175],["T_WHITESPACE","\n    ",181],["T_PUBLIC","public",182],["T_WHITESPACE"," ",182],["T_FUNCTION","function",182],["T_WHITESPACE"," ",182],["T_STRING","isOrderIncrementIdUsed",182],"(",["T_VARIABLE","$orderIncrementId",182],")",["T_WHITESPACE","\n    ",182],"{",["T_WHITESPACE","\n        ",183],["T_DOC_COMMENT","\/** @var  \\Magento\\Framework\\DB\\Adapter\\AdapterInterface $adapter *\/",184],["T_WHITESPACE","\n        ",184],["T_VARIABLE","$adapter",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","getConnection",185],"(",")",";",["T_WHITESPACE","\n        ",185],["T_VARIABLE","$bind",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],"[",["T_CONSTANT_ENCAPSED_STRING","':increment_id'",186],["T_WHITESPACE"," ",186],["T_DOUBLE_ARROW","=>",186],["T_WHITESPACE"," ",186],["T_VARIABLE","$orderIncrementId",186],"]",";",["T_WHITESPACE","\n        ",186],["T_DOC_COMMENT","\/** @var \\Magento\\Framework\\DB\\Select $select *\/",187],["T_WHITESPACE","\n        ",187],["T_VARIABLE","$select",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_VARIABLE","$adapter",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","select",188],"(",")",";",["T_WHITESPACE","\n        ",188],["T_VARIABLE","$select",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","from",189],"(",["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getTable",189],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_order'",189],")",",",["T_WHITESPACE"," ",189],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",189],")",["T_OBJECT_OPERATOR","->",189],["T_STRING","where",189],"(",["T_CONSTANT_ENCAPSED_STRING","'increment_id = :increment_id'",189],")",";",["T_WHITESPACE","\n        ",189],["T_VARIABLE","$entity_id",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_VARIABLE","$adapter",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","fetchOne",190],"(",["T_VARIABLE","$select",190],",",["T_WHITESPACE"," ",190],["T_VARIABLE","$bind",190],")",";",["T_WHITESPACE","\n        ",190],["T_IF","if",191],["T_WHITESPACE"," ",191],"(",["T_VARIABLE","$entity_id",191],["T_WHITESPACE"," ",191],">",["T_WHITESPACE"," ",191],["T_LNUMBER","0",191],")",["T_WHITESPACE"," ",191],"{",["T_WHITESPACE","\n            ",191],["T_RETURN","return",192],["T_WHITESPACE"," ",192],["T_STRING","true",192],";",["T_WHITESPACE","\n        ",192],"}",["T_WHITESPACE","\n\n        ",193],["T_RETURN","return",195],["T_WHITESPACE"," ",195],["T_STRING","false",195],";",["T_WHITESPACE","\n    ",195],"}",["T_WHITESPACE","\n\n    ",196],["T_DOC_COMMENT","\/**\n     * Mark quotes - that depend on catalog price rules - to be recollected on demand\n     *\n     * @return $this\n     *\/",198],["T_WHITESPACE","\n    ",202],["T_PUBLIC","public",203],["T_WHITESPACE"," ",203],["T_FUNCTION","function",203],["T_WHITESPACE"," ",203],["T_STRING","markQuotesRecollectOnCatalogRules",203],"(",")",["T_WHITESPACE","\n    ",203],"{",["T_WHITESPACE","\n        ",204],["T_VARIABLE","$tableQuote",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","getTable",205],"(",["T_CONSTANT_ENCAPSED_STRING","'quote'",205],")",";",["T_WHITESPACE","\n        ",205],["T_VARIABLE","$subSelect",206],["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","getConnection",206],"(",")",["T_OBJECT_OPERATOR","->",206],["T_STRING","select",206],"(",")",["T_OBJECT_OPERATOR","->",206],["T_STRING","from",206],"(",["T_WHITESPACE","\n            ",206],"[",["T_CONSTANT_ENCAPSED_STRING","'t2'",207],["T_WHITESPACE"," ",207],["T_DOUBLE_ARROW","=>",207],["T_WHITESPACE"," ",207],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","getTable",207],"(",["T_CONSTANT_ENCAPSED_STRING","'quote_item'",207],")","]",",",["T_WHITESPACE","\n            ",207],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",208],["T_WHITESPACE"," ",208],["T_DOUBLE_ARROW","=>",208],["T_WHITESPACE"," ",208],["T_CONSTANT_ENCAPSED_STRING","'quote_id'",208],"]",["T_WHITESPACE","\n        ",208],")",["T_OBJECT_OPERATOR","->",209],["T_STRING","from",209],"(",["T_WHITESPACE","\n            ",209],"[",["T_CONSTANT_ENCAPSED_STRING","'t3'",210],["T_WHITESPACE"," ",210],["T_DOUBLE_ARROW","=>",210],["T_WHITESPACE"," ",210],["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","getTable",210],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogrule_product_price'",210],")","]",",",["T_WHITESPACE","\n            ",210],"[","]",["T_WHITESPACE","\n        ",211],")",["T_OBJECT_OPERATOR","->",212],["T_STRING","where",212],"(",["T_WHITESPACE","\n            ",212],["T_CONSTANT_ENCAPSED_STRING","'t2.product_id = t3.product_id'",213],["T_WHITESPACE","\n        ",213],")",["T_OBJECT_OPERATOR","->",214],["T_STRING","group",214],"(",["T_WHITESPACE","\n            ",214],["T_CONSTANT_ENCAPSED_STRING","'quote_id'",215],["T_WHITESPACE","\n        ",215],")",";",["T_WHITESPACE","\n\n        ",216],["T_VARIABLE","$select",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","getConnection",218],"(",")",["T_OBJECT_OPERATOR","->",218],["T_STRING","select",218],"(",")",["T_OBJECT_OPERATOR","->",218],["T_STRING","join",218],"(",["T_WHITESPACE","\n            ",218],"[",["T_CONSTANT_ENCAPSED_STRING","'t2'",219],["T_WHITESPACE"," ",219],["T_DOUBLE_ARROW","=>",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$subSelect",219],"]",",",["T_WHITESPACE","\n            ",219],["T_CONSTANT_ENCAPSED_STRING","'t1.entity_id = t2.entity_id'",220],",",["T_WHITESPACE","\n            ",220],"[",["T_CONSTANT_ENCAPSED_STRING","'trigger_recollect'",221],["T_WHITESPACE"," ",221],["T_DOUBLE_ARROW","=>",221],["T_WHITESPACE"," ",221],["T_NEW","new",221],["T_WHITESPACE"," ",221],["T_NS_SEPARATOR","\\",221],["T_STRING","Zend_Db_Expr",221],"(",["T_CONSTANT_ENCAPSED_STRING","'1'",221],")","]",["T_WHITESPACE","\n        ",221],")",";",["T_WHITESPACE","\n\n        ",222],["T_VARIABLE","$updateQuery",224],["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],["T_VARIABLE","$select",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","crossUpdateFromSelect",224],"(","[",["T_CONSTANT_ENCAPSED_STRING","'t1'",224],["T_WHITESPACE"," ",224],["T_DOUBLE_ARROW","=>",224],["T_WHITESPACE"," ",224],["T_VARIABLE","$tableQuote",224],"]",")",";",["T_WHITESPACE","\n\n        ",224],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","getConnection",226],"(",")",["T_OBJECT_OPERATOR","->",226],["T_STRING","query",226],"(",["T_VARIABLE","$updateQuery",226],")",";",["T_WHITESPACE","\n\n        ",226],["T_RETURN","return",228],["T_WHITESPACE"," ",228],["T_VARIABLE","$this",228],";",["T_WHITESPACE","\n    ",228],"}",["T_WHITESPACE","\n\n    ",229],["T_DOC_COMMENT","\/**\n     * Subtract product from all quotes quantities\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return $this\n     *\/",231],["T_WHITESPACE","\n    ",236],["T_PUBLIC","public",237],["T_WHITESPACE"," ",237],["T_FUNCTION","function",237],["T_WHITESPACE"," ",237],["T_STRING","substractProductFromQuotes",237],"(",["T_VARIABLE","$product",237],")",["T_WHITESPACE","\n    ",237],"{",["T_WHITESPACE","\n        ",238],["T_VARIABLE","$productId",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_INT_CAST","(int)",239],["T_VARIABLE","$product",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","getId",239],"(",")",";",["T_WHITESPACE","\n        ",239],["T_IF","if",240],["T_WHITESPACE"," ",240],"(","!",["T_VARIABLE","$productId",240],")",["T_WHITESPACE"," ",240],"{",["T_WHITESPACE","\n            ",240],["T_RETURN","return",241],["T_WHITESPACE"," ",241],["T_VARIABLE","$this",241],";",["T_WHITESPACE","\n        ",241],"}",["T_WHITESPACE","\n        ",242],["T_VARIABLE","$connection",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","getConnection",243],"(",")",";",["T_WHITESPACE","\n        ",243],["T_VARIABLE","$subSelect",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_VARIABLE","$connection",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","select",244],"(",")",";",["T_WHITESPACE","\n\n        ",244],["T_VARIABLE","$subSelect",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","from",246],"(",["T_WHITESPACE","\n            ",246],["T_STRING","false",247],",",["T_WHITESPACE","\n            ",247],"[",["T_WHITESPACE","\n                ",248],["T_CONSTANT_ENCAPSED_STRING","'items_qty'",249],["T_WHITESPACE"," ",249],["T_DOUBLE_ARROW","=>",249],["T_WHITESPACE"," ",249],["T_NEW","new",249],["T_WHITESPACE"," ",249],["T_NS_SEPARATOR","\\",249],["T_STRING","Zend_Db_Expr",249],"(",["T_WHITESPACE","\n                    ",249],["T_VARIABLE","$connection",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","quoteIdentifier",250],"(",["T_CONSTANT_ENCAPSED_STRING","'q.items_qty'",250],")",["T_WHITESPACE"," ",250],".",["T_WHITESPACE"," ",250],["T_CONSTANT_ENCAPSED_STRING","' - '",250],["T_WHITESPACE"," ",250],".",["T_WHITESPACE"," ",250],["T_VARIABLE","$connection",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","quoteIdentifier",250],"(",["T_CONSTANT_ENCAPSED_STRING","'qi.qty'",250],")",["T_WHITESPACE","\n                ",250],")",",",["T_WHITESPACE","\n                ",251],["T_CONSTANT_ENCAPSED_STRING","'items_count'",252],["T_WHITESPACE"," ",252],["T_DOUBLE_ARROW","=>",252],["T_WHITESPACE"," ",252],["T_NEW","new",252],["T_WHITESPACE"," ",252],["T_NS_SEPARATOR","\\",252],["T_STRING","Zend_Db_Expr",252],"(",["T_VARIABLE","$connection",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","quoteIdentifier",252],"(",["T_CONSTANT_ENCAPSED_STRING","'q.items_count'",252],")",["T_WHITESPACE"," ",252],".",["T_WHITESPACE"," ",252],["T_CONSTANT_ENCAPSED_STRING","' - 1'",252],")",["T_WHITESPACE","\n            ",252],"]",["T_WHITESPACE","\n        ",253],")",["T_OBJECT_OPERATOR","->",254],["T_STRING","join",254],"(",["T_WHITESPACE","\n            ",254],"[",["T_CONSTANT_ENCAPSED_STRING","'qi'",255],["T_WHITESPACE"," ",255],["T_DOUBLE_ARROW","=>",255],["T_WHITESPACE"," ",255],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","getTable",255],"(",["T_CONSTANT_ENCAPSED_STRING","'quote_item'",255],")","]",",",["T_WHITESPACE","\n            ",255],["T_STRING","implode",256],"(",["T_WHITESPACE","\n                ",256],["T_CONSTANT_ENCAPSED_STRING","' AND '",257],",",["T_WHITESPACE","\n                ",257],"[",["T_WHITESPACE","\n                    ",258],["T_CONSTANT_ENCAPSED_STRING","'q.entity_id = qi.quote_id'",259],",",["T_WHITESPACE","\n                    ",259],["T_CONSTANT_ENCAPSED_STRING","'qi.parent_item_id IS NULL'",260],",",["T_WHITESPACE","\n                    ",260],["T_VARIABLE","$connection",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","quoteInto",261],"(",["T_CONSTANT_ENCAPSED_STRING","'qi.product_id = ?'",261],",",["T_WHITESPACE"," ",261],["T_VARIABLE","$productId",261],")",["T_WHITESPACE","\n                ",261],"]",["T_WHITESPACE","\n            ",262],")",",",["T_WHITESPACE","\n            ",263],"[","]",["T_WHITESPACE","\n        ",264],")",";",["T_WHITESPACE","\n\n        ",265],["T_VARIABLE","$updateQuery",267],["T_WHITESPACE"," ",267],"=",["T_WHITESPACE"," ",267],["T_VARIABLE","$connection",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","updateFromSelect",267],"(",["T_VARIABLE","$subSelect",267],",",["T_WHITESPACE"," ",267],"[",["T_CONSTANT_ENCAPSED_STRING","'q'",267],["T_WHITESPACE"," ",267],["T_DOUBLE_ARROW","=>",267],["T_WHITESPACE"," ",267],["T_VARIABLE","$this",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","getTable",267],"(",["T_CONSTANT_ENCAPSED_STRING","'quote'",267],")","]",")",";",["T_WHITESPACE","\n\n        ",267],["T_VARIABLE","$connection",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","query",269],"(",["T_VARIABLE","$updateQuery",269],")",";",["T_WHITESPACE","\n\n        ",269],["T_RETURN","return",271],["T_WHITESPACE"," ",271],["T_VARIABLE","$this",271],";",["T_WHITESPACE","\n    ",271],"}",["T_WHITESPACE","\n\n    ",272],["T_DOC_COMMENT","\/**\n     * Mark recollect contain product(s) quotes\n     *\n     * @param array|int|\\Zend_Db_Expr $productIds\n     * @return $this\n     *\/",274],["T_WHITESPACE","\n    ",279],["T_PUBLIC","public",280],["T_WHITESPACE"," ",280],["T_FUNCTION","function",280],["T_WHITESPACE"," ",280],["T_STRING","markQuotesRecollect",280],"(",["T_VARIABLE","$productIds",280],")",["T_WHITESPACE","\n    ",280],"{",["T_WHITESPACE","\n        ",281],["T_VARIABLE","$tableQuote",282],["T_WHITESPACE"," ",282],"=",["T_WHITESPACE"," ",282],["T_VARIABLE","$this",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","getTable",282],"(",["T_CONSTANT_ENCAPSED_STRING","'quote'",282],")",";",["T_WHITESPACE","\n        ",282],["T_VARIABLE","$tableItem",283],["T_WHITESPACE"," ",283],"=",["T_WHITESPACE"," ",283],["T_VARIABLE","$this",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","getTable",283],"(",["T_CONSTANT_ENCAPSED_STRING","'quote_item'",283],")",";",["T_WHITESPACE","\n        ",283],["T_VARIABLE","$subSelect",284],["T_WHITESPACE"," ",284],"=",["T_WHITESPACE"," ",284],["T_VARIABLE","$this",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","getConnection",284],"(",")",["T_OBJECT_OPERATOR","->",284],["T_STRING","select",284],"(",")",["T_OBJECT_OPERATOR","->",284],["T_STRING","from",284],"(",["T_WHITESPACE","\n            ",284],["T_VARIABLE","$tableItem",285],",",["T_WHITESPACE","\n            ",285],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",286],["T_WHITESPACE"," ",286],["T_DOUBLE_ARROW","=>",286],["T_WHITESPACE"," ",286],["T_CONSTANT_ENCAPSED_STRING","'quote_id'",286],"]",["T_WHITESPACE","\n        ",286],")",["T_OBJECT_OPERATOR","->",287],["T_STRING","where",287],"(",["T_WHITESPACE","\n            ",287],["T_CONSTANT_ENCAPSED_STRING","'product_id IN ( ? )'",288],",",["T_WHITESPACE","\n            ",288],["T_VARIABLE","$productIds",289],["T_WHITESPACE","\n        ",289],")",["T_OBJECT_OPERATOR","->",290],["T_STRING","group",290],"(",["T_WHITESPACE","\n            ",290],["T_CONSTANT_ENCAPSED_STRING","'quote_id'",291],["T_WHITESPACE","\n        ",291],")",";",["T_WHITESPACE","\n\n        ",292],["T_VARIABLE","$select",294],["T_WHITESPACE"," ",294],"=",["T_WHITESPACE"," ",294],["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","getConnection",294],"(",")",["T_OBJECT_OPERATOR","->",294],["T_STRING","select",294],"(",")",["T_OBJECT_OPERATOR","->",294],["T_STRING","join",294],"(",["T_WHITESPACE","\n            ",294],"[",["T_CONSTANT_ENCAPSED_STRING","'t2'",295],["T_WHITESPACE"," ",295],["T_DOUBLE_ARROW","=>",295],["T_WHITESPACE"," ",295],["T_VARIABLE","$subSelect",295],"]",",",["T_WHITESPACE","\n            ",295],["T_CONSTANT_ENCAPSED_STRING","'t1.entity_id = t2.entity_id'",296],",",["T_WHITESPACE","\n            ",296],"[",["T_CONSTANT_ENCAPSED_STRING","'trigger_recollect'",297],["T_WHITESPACE"," ",297],["T_DOUBLE_ARROW","=>",297],["T_WHITESPACE"," ",297],["T_NEW","new",297],["T_WHITESPACE"," ",297],["T_NS_SEPARATOR","\\",297],["T_STRING","Zend_Db_Expr",297],"(",["T_CONSTANT_ENCAPSED_STRING","'1'",297],")","]",["T_WHITESPACE","\n        ",297],")",";",["T_WHITESPACE","\n        ",298],["T_VARIABLE","$updateQuery",299],["T_WHITESPACE"," ",299],"=",["T_WHITESPACE"," ",299],["T_VARIABLE","$select",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","crossUpdateFromSelect",299],"(","[",["T_CONSTANT_ENCAPSED_STRING","'t1'",299],["T_WHITESPACE"," ",299],["T_DOUBLE_ARROW","=>",299],["T_WHITESPACE"," ",299],["T_VARIABLE","$tableQuote",299],"]",")",";",["T_WHITESPACE","\n        ",299],["T_VARIABLE","$this",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","getConnection",300],"(",")",["T_OBJECT_OPERATOR","->",300],["T_STRING","query",300],"(",["T_VARIABLE","$updateQuery",300],")",";",["T_WHITESPACE","\n\n        ",300],["T_RETURN","return",302],["T_WHITESPACE"," ",302],["T_VARIABLE","$this",302],";",["T_WHITESPACE","\n    ",302],"}",["T_WHITESPACE","\n\n    ",303],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",305],["T_WHITESPACE","\n    ",307],["T_PUBLIC","public",308],["T_WHITESPACE"," ",308],["T_FUNCTION","function",308],["T_WHITESPACE"," ",308],["T_STRING","save",308],"(",["T_NS_SEPARATOR","\\",308],["T_STRING","Magento",308],["T_NS_SEPARATOR","\\",308],["T_STRING","Framework",308],["T_NS_SEPARATOR","\\",308],["T_STRING","Model",308],["T_NS_SEPARATOR","\\",308],["T_STRING","AbstractModel",308],["T_WHITESPACE"," ",308],["T_VARIABLE","$object",308],")",["T_WHITESPACE","\n    ",308],"{",["T_WHITESPACE","\n        ",309],["T_IF","if",310],["T_WHITESPACE"," ",310],"(","!",["T_VARIABLE","$object",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","isPreventSaving",310],"(",")",")",["T_WHITESPACE"," ",310],"{",["T_WHITESPACE","\n            ",310],["T_RETURN","return",311],["T_WHITESPACE"," ",311],["T_STRING","parent",311],["T_DOUBLE_COLON","::",311],["T_STRING","save",311],"(",["T_VARIABLE","$object",311],")",";",["T_WHITESPACE","\n        ",311],"}",["T_WHITESPACE","\n    ",312],"}",["T_WHITESPACE","\n",313],"}",["T_WHITESPACE","\n",314]]