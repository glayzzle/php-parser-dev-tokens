[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","PageCache",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Layout",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","View",8],["T_NS_SEPARATOR","\\",8],["T_STRING","EntitySpecificHandlesList",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * Plugin for @see \\Magento\\Framework\\View\\Model\\Layout\\Merge\n *\/",10],["T_WHITESPACE","\n",12],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","MergePlugin",13],["T_WHITESPACE","\n",13],"{",["T_WHITESPACE","\n    ",14],["T_DOC_COMMENT","\/**\n     * @var EntitySpecificHandlesList\n     *\/",15],["T_WHITESPACE","\n    ",17],["T_PRIVATE","private",18],["T_WHITESPACE"," ",18],["T_VARIABLE","$entitySpecificHandlesList",18],";",["T_WHITESPACE","\n\n    ",18],["T_DOC_COMMENT","\/**\n     * Constructor\n     *\n     * @param EntitySpecificHandlesList $entitySpecificHandlesList\n     *\/",20],["T_WHITESPACE","\n    ",24],["T_PUBLIC","public",25],["T_WHITESPACE"," ",25],["T_FUNCTION","function",25],["T_WHITESPACE"," ",25],["T_STRING","__construct",25],"(",["T_WHITESPACE","\n        ",25],["T_STRING","EntitySpecificHandlesList",26],["T_WHITESPACE"," ",26],["T_VARIABLE","$entitySpecificHandlesList",26],["T_WHITESPACE","\n    ",26],")",["T_WHITESPACE"," ",27],"{",["T_WHITESPACE","\n        ",27],["T_VARIABLE","$this",28],["T_OBJECT_OPERATOR","->",28],["T_STRING","entitySpecificHandlesList",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_VARIABLE","$entitySpecificHandlesList",28],";",["T_WHITESPACE","\n    ",28],"}",["T_WHITESPACE","\n\n    ",29],["T_DOC_COMMENT","\/**\n     * Make sure that page specific handles (those which contain entity ID) do not have any declarations of ESI blocks\n     *\n     * ESI blocks cannot be declared for page specific handles, otherwise they will not be shared between pages\n     *\n     * @param \\Magento\\Framework\\View\\Model\\Layout\\Merge $subject\n     * @param string $handle\n     * @param string $updateXml\n     * @return array|null\n     * @SuppressWarnings(PHPMD.UnusedFormalParameter)\n     *\/",31],["T_WHITESPACE","\n    ",41],["T_PUBLIC","public",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","beforeValidateUpdate",42],"(",["T_NS_SEPARATOR","\\",42],["T_STRING","Magento",42],["T_NS_SEPARATOR","\\",42],["T_STRING","Framework",42],["T_NS_SEPARATOR","\\",42],["T_STRING","View",42],["T_NS_SEPARATOR","\\",42],["T_STRING","Model",42],["T_NS_SEPARATOR","\\",42],["T_STRING","Layout",42],["T_NS_SEPARATOR","\\",42],["T_STRING","Merge",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$subject",42],",",["T_WHITESPACE"," ",42],["T_VARIABLE","$handle",42],",",["T_WHITESPACE"," ",42],["T_VARIABLE","$updateXml",42],")",["T_WHITESPACE","\n    ",42],"{",["T_WHITESPACE","\n        ",43],["T_IF","if",44],["T_WHITESPACE"," ",44],"(",["T_STRING","in_array",44],"(",["T_VARIABLE","$handle",44],",",["T_WHITESPACE"," ",44],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","entitySpecificHandlesList",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","getHandles",44],"(",")",")",["T_WHITESPACE","\n            ",44],["T_BOOLEAN_AND","&&",45],["T_WHITESPACE"," ",45],"(",["T_STRING","strpos",45],"(",["T_VARIABLE","$updateXml",45],",",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'ttl='",45],")",["T_WHITESPACE"," ",45],["T_IS_NOT_IDENTICAL","!==",45],["T_WHITESPACE"," ",45],["T_STRING","false",45],")",["T_WHITESPACE","\n        ",45],")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n            ",46],["T_THROW","throw",47],["T_WHITESPACE"," ",47],["T_NEW","new",47],["T_WHITESPACE"," ",47],["T_NS_SEPARATOR","\\",47],["T_STRING","LogicException",47],"(",["T_WHITESPACE","\n                ",47],"\"",["T_ENCAPSED_AND_WHITESPACE","Handle '",48],["T_CURLY_OPEN","{",48],["T_VARIABLE","$handle",48],"}",["T_ENCAPSED_AND_WHITESPACE","' must not contain blocks with 'ttl' attribute specified. ",48],"\"",["T_WHITESPACE","\n                ",48],".",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","\"Otherwise, these blocks will be treated as ESI by Varnish, however will not be shared between pages \"",49],["T_WHITESPACE","\n                ",49],".",["T_WHITESPACE"," ",50],"\"",["T_ENCAPSED_AND_WHITESPACE","because handle '",50],["T_CURLY_OPEN","{",50],["T_VARIABLE","$handle",50],"}",["T_ENCAPSED_AND_WHITESPACE","' is not generic. Such blocks will not be rendered on the page",50],"\"",["T_WHITESPACE","\n            ",50],")",";",["T_WHITESPACE","\n        ",51],"}",["T_WHITESPACE","\n        ",52],["T_RETURN","return",53],["T_WHITESPACE"," ",53],["T_STRING","null",53],";",["T_WHITESPACE","\n    ",53],"}",["T_WHITESPACE","\n",54],"}",["T_WHITESPACE","\n",55]]