[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n *\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",6],["T_NAMESPACE","namespace",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","GiftMessage",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Model",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Plugin",8],";",["T_WHITESPACE","\n\n",8],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Exception",10],["T_NS_SEPARATOR","\\",10],["T_STRING","CouldNotSaveException",10],";",["T_WHITESPACE","\n\n",10],["T_CLASS","class",12],["T_WHITESPACE"," ",12],["T_STRING","OrderSave",12],["T_WHITESPACE","\n",12],"{",["T_WHITESPACE","\n    ",13],["T_DOC_COMMENT","\/** @var \\Magento\\GiftMessage\\Api\\OrderRepositoryInterface *\/",14],["T_WHITESPACE","\n    ",14],["T_PROTECTED","protected",15],["T_WHITESPACE"," ",15],["T_VARIABLE","$giftMessageOrderRepository",15],";",["T_WHITESPACE","\n\n    ",15],["T_DOC_COMMENT","\/** @var \\Magento\\GiftMessage\\Api\\OrderItemRepositoryInterface *\/",17],["T_WHITESPACE","\n    ",17],["T_PROTECTED","protected",18],["T_WHITESPACE"," ",18],["T_VARIABLE","$giftMessageOrderItemRepository",18],";",["T_WHITESPACE","\n\n    ",18],["T_DOC_COMMENT","\/**\n     * Init plugin\n     *\n     * @param \\Magento\\GiftMessage\\Api\\OrderRepositoryInterface $giftMessageOrderRepository\n     * @param \\Magento\\GiftMessage\\Api\\OrderItemRepositoryInterface $giftMessageOrderItemRepository\n     *\/",20],["T_WHITESPACE","\n    ",25],["T_PUBLIC","public",26],["T_WHITESPACE"," ",26],["T_FUNCTION","function",26],["T_WHITESPACE"," ",26],["T_STRING","__construct",26],"(",["T_WHITESPACE","\n        ",26],["T_NS_SEPARATOR","\\",27],["T_STRING","Magento",27],["T_NS_SEPARATOR","\\",27],["T_STRING","GiftMessage",27],["T_NS_SEPARATOR","\\",27],["T_STRING","Api",27],["T_NS_SEPARATOR","\\",27],["T_STRING","OrderRepositoryInterface",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$giftMessageOrderRepository",27],",",["T_WHITESPACE","\n        ",27],["T_NS_SEPARATOR","\\",28],["T_STRING","Magento",28],["T_NS_SEPARATOR","\\",28],["T_STRING","GiftMessage",28],["T_NS_SEPARATOR","\\",28],["T_STRING","Api",28],["T_NS_SEPARATOR","\\",28],["T_STRING","OrderItemRepositoryInterface",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$giftMessageOrderItemRepository",28],["T_WHITESPACE","\n    ",28],")",["T_WHITESPACE"," ",29],"{",["T_WHITESPACE","\n        ",29],["T_VARIABLE","$this",30],["T_OBJECT_OPERATOR","->",30],["T_STRING","giftMessageOrderRepository",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],["T_VARIABLE","$giftMessageOrderRepository",30],";",["T_WHITESPACE","\n        ",30],["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","giftMessageOrderItemRepository",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_VARIABLE","$giftMessageOrderItemRepository",31],";",["T_WHITESPACE","\n    ",31],"}",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * Save gift message\n     *\n     * @param \\Magento\\Sales\\Api\\OrderRepositoryInterface $subject\n     * @param \\Magento\\Sales\\Api\\Data\\OrderInterface $resultOrder\n     * @return \\Magento\\Sales\\Api\\Data\\OrderInterface\n     * @SuppressWarnings(PHPMD.UnusedFormalParameter)\n     * @throws CouldNotSaveException\n     *\/",34],["T_WHITESPACE","\n    ",42],["T_PUBLIC","public",43],["T_WHITESPACE"," ",43],["T_FUNCTION","function",43],["T_WHITESPACE"," ",43],["T_STRING","afterSave",43],"(",["T_WHITESPACE","\n        ",43],["T_NS_SEPARATOR","\\",44],["T_STRING","Magento",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Sales",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Api",44],["T_NS_SEPARATOR","\\",44],["T_STRING","OrderRepositoryInterface",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$subject",44],",",["T_WHITESPACE","\n        ",44],["T_NS_SEPARATOR","\\",45],["T_STRING","Magento",45],["T_NS_SEPARATOR","\\",45],["T_STRING","Sales",45],["T_NS_SEPARATOR","\\",45],["T_STRING","Api",45],["T_NS_SEPARATOR","\\",45],["T_STRING","Data",45],["T_NS_SEPARATOR","\\",45],["T_STRING","OrderInterface",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$resultOrder",45],["T_WHITESPACE","\n    ",45],")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n        ",46],["T_DOC_COMMENT","\/** @var \\Magento\\Sales\\Api\\Data\\OrderInterface $resultOrder *\/",47],["T_WHITESPACE","\n        ",47],["T_VARIABLE","$resultOrder",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","saveOrderGiftMessage",48],"(",["T_VARIABLE","$resultOrder",48],")",";",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$resultOrder",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","saveOrderItemGiftMessage",49],"(",["T_VARIABLE","$resultOrder",49],")",";",["T_WHITESPACE","\n\n        ",49],["T_RETURN","return",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$resultOrder",51],";",["T_WHITESPACE","\n    ",51],"}",["T_WHITESPACE","\n\n    ",52],["T_DOC_COMMENT","\/**\n     * Save gift message for order\n     *\n     * @param \\Magento\\Sales\\Api\\Data\\OrderInterface $order\n     * @return \\Magento\\Sales\\Api\\Data\\OrderInterface\n     * @throws CouldNotSaveException\n     *\/",54],["T_WHITESPACE","\n    ",60],["T_PROTECTED","protected",61],["T_WHITESPACE"," ",61],["T_FUNCTION","function",61],["T_WHITESPACE"," ",61],["T_STRING","saveOrderGiftMessage",61],"(",["T_NS_SEPARATOR","\\",61],["T_STRING","Magento",61],["T_NS_SEPARATOR","\\",61],["T_STRING","Sales",61],["T_NS_SEPARATOR","\\",61],["T_STRING","Api",61],["T_NS_SEPARATOR","\\",61],["T_STRING","Data",61],["T_NS_SEPARATOR","\\",61],["T_STRING","OrderInterface",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$order",61],")",["T_WHITESPACE","\n    ",61],"{",["T_WHITESPACE","\n        ",62],["T_VARIABLE","$extensionAttributes",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_VARIABLE","$order",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","getExtensionAttributes",63],"(",")",";",["T_WHITESPACE","\n        ",63],["T_IF","if",64],["T_WHITESPACE"," ",64],"(",["T_WHITESPACE","\n            ",64],["T_STRING","null",65],["T_WHITESPACE"," ",65],["T_IS_NOT_IDENTICAL","!==",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$extensionAttributes",65],["T_WHITESPACE"," ",65],["T_BOOLEAN_AND","&&",65],["T_WHITESPACE","\n            ",65],["T_STRING","null",66],["T_WHITESPACE"," ",66],["T_IS_NOT_IDENTICAL","!==",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$extensionAttributes",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getGiftMessage",66],"(",")",["T_WHITESPACE","\n        ",66],")",["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n            ",67],["T_COMMENT","\/* @var \\Magento\\GiftMessage\\Api\\Data\\MessageInterface $giftMessage *\/",68],["T_WHITESPACE","\n            ",68],["T_VARIABLE","$giftMessage",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_VARIABLE","$extensionAttributes",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getGiftMessage",69],"(",")",";",["T_WHITESPACE","\n            ",69],["T_TRY","try",70],["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n                ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","giftMessageOrderRepository",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","save",71],"(",["T_VARIABLE","$order",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getEntityId",71],"(",")",",",["T_WHITESPACE"," ",71],["T_VARIABLE","$giftMessage",71],")",";",["T_WHITESPACE","\n            ",71],"}",["T_WHITESPACE"," ",72],["T_CATCH","catch",72],["T_WHITESPACE"," ",72],"(",["T_NS_SEPARATOR","\\",72],["T_STRING","Exception",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$e",72],")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n                ",72],["T_THROW","throw",73],["T_WHITESPACE"," ",73],["T_NEW","new",73],["T_WHITESPACE"," ",73],["T_STRING","CouldNotSaveException",73],"(",["T_WHITESPACE","\n                    ",73],["T_STRING","__",74],"(",["T_CONSTANT_ENCAPSED_STRING","'Could not add gift message to order: \"%1\"'",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$e",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","getMessage",74],"(",")",")",",",["T_WHITESPACE","\n                    ",74],["T_VARIABLE","$e",75],["T_WHITESPACE","\n                ",75],")",";",["T_WHITESPACE","\n            ",76],"}",["T_WHITESPACE","\n        ",77],"}",["T_WHITESPACE","\n        ",78],["T_RETURN","return",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$order",79],";",["T_WHITESPACE","\n    ",79],"}",["T_WHITESPACE","\n\n    ",80],["T_DOC_COMMENT","\/**\n     * Save gift message for items of order\n     *\n     * @param \\Magento\\Sales\\Api\\Data\\OrderInterface $order\n     * @return \\Magento\\Sales\\Api\\Data\\OrderInterface\n     * @throws CouldNotSaveException\n     *\/",82],["T_WHITESPACE","\n    ",88],["T_PROTECTED","protected",89],["T_WHITESPACE"," ",89],["T_FUNCTION","function",89],["T_WHITESPACE"," ",89],["T_STRING","saveOrderItemGiftMessage",89],"(",["T_NS_SEPARATOR","\\",89],["T_STRING","Magento",89],["T_NS_SEPARATOR","\\",89],["T_STRING","Sales",89],["T_NS_SEPARATOR","\\",89],["T_STRING","Api",89],["T_NS_SEPARATOR","\\",89],["T_STRING","Data",89],["T_NS_SEPARATOR","\\",89],["T_STRING","OrderInterface",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$order",89],")",["T_WHITESPACE","\n    ",89],"{",["T_WHITESPACE","\n        ",90],["T_VARIABLE","$items",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_VARIABLE","$order",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getItems",91],"(",")",";",["T_WHITESPACE","\n        ",91],["T_IF","if",92],["T_WHITESPACE"," ",92],"(",["T_STRING","null",92],["T_WHITESPACE"," ",92],["T_IS_NOT_IDENTICAL","!==",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$items",92],")",["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n            ",92],["T_DOC_COMMENT","\/** @var \\Magento\\Sales\\Api\\Data\\OrderItemInterface $orderItem *\/",93],["T_WHITESPACE","\n            ",93],["T_FOREACH","foreach",94],["T_WHITESPACE"," ",94],"(",["T_VARIABLE","$items",94],["T_WHITESPACE"," ",94],["T_AS","as",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$orderItem",94],")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n                ",94],["T_VARIABLE","$extensionAttribute",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$orderItem",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getExtensionAttributes",95],"(",")",";",["T_WHITESPACE","\n                ",95],["T_IF","if",96],["T_WHITESPACE"," ",96],"(",["T_WHITESPACE","\n                    ",96],["T_STRING","null",97],["T_WHITESPACE"," ",97],["T_IS_NOT_IDENTICAL","!==",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$extensionAttribute",97],["T_WHITESPACE"," ",97],["T_BOOLEAN_AND","&&",97],["T_WHITESPACE","\n                    ",97],["T_STRING","null",98],["T_WHITESPACE"," ",98],["T_IS_NOT_IDENTICAL","!==",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$extensionAttribute",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getGiftMessage",98],"(",")",["T_WHITESPACE","\n                ",98],")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n                    ",99],["T_COMMENT","\/* @var \\Magento\\GiftMessage\\Api\\Data\\MessageInterface $giftMessage *\/",100],["T_WHITESPACE","\n                    ",100],["T_VARIABLE","$giftMessage",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$extensionAttribute",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getGiftMessage",101],"(",")",";",["T_WHITESPACE","\n                    ",101],["T_TRY","try",102],["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n                        ",102],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","giftMessageOrderItemRepository",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","save",103],"(",["T_WHITESPACE","\n                            ",103],["T_VARIABLE","$order",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getEntityId",104],"(",")",",",["T_WHITESPACE","\n                            ",104],["T_VARIABLE","$orderItem",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getItemId",105],"(",")",",",["T_WHITESPACE","\n                            ",105],["T_VARIABLE","$giftMessage",106],["T_WHITESPACE","\n                        ",106],")",";",["T_WHITESPACE","\n                    ",107],"}",["T_WHITESPACE"," ",108],["T_CATCH","catch",108],["T_WHITESPACE"," ",108],"(",["T_NS_SEPARATOR","\\",108],["T_STRING","Exception",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$e",108],")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n                        ",108],["T_THROW","throw",109],["T_WHITESPACE"," ",109],["T_NEW","new",109],["T_WHITESPACE"," ",109],["T_STRING","CouldNotSaveException",109],"(",["T_WHITESPACE","\n                            ",109],["T_STRING","__",110],"(",["T_CONSTANT_ENCAPSED_STRING","'Could not add gift message to order\\'s item: \"%1\"'",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$e",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getMessage",110],"(",")",")",",",["T_WHITESPACE","\n                            ",110],["T_VARIABLE","$e",111],["T_WHITESPACE","\n                        ",111],")",";",["T_WHITESPACE","\n                    ",112],"}",["T_WHITESPACE","\n                ",113],"}",["T_WHITESPACE","\n            ",114],"}",["T_WHITESPACE","\n        ",115],"}",["T_WHITESPACE","\n        ",116],["T_RETURN","return",117],["T_WHITESPACE"," ",117],["T_VARIABLE","$order",117],";",["T_WHITESPACE","\n    ",117],"}",["T_WHITESPACE","\n",118],"}",["T_WHITESPACE","\n",119]]