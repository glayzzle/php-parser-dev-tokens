[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Paypal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Hostedpro",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Customer",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Helper",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Address",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","DataObject",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Locale",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Resolver",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Payment",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Helper",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Formatter",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Paypal",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Model",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Hostedpro",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Sales",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Model",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Order",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Tax",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Helper",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Data",14],";",["T_WHITESPACE","\n\n",14],["T_DOC_COMMENT","\/**\n *  Website Payments Pro Hosted Solution request model to get token.\n *\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",16],["T_WHITESPACE","\n",20],["T_CLASS","class",21],["T_WHITESPACE"," ",21],["T_STRING","Request",21],["T_WHITESPACE"," ",21],["T_EXTENDS","extends",21],["T_WHITESPACE"," ",21],["T_STRING","DataObject",21],["T_WHITESPACE","\n",21],"{",["T_WHITESPACE","\n    ",22],["T_USE","use",23],["T_WHITESPACE"," ",23],["T_STRING","Formatter",23],";",["T_WHITESPACE","\n\n    ",23],["T_DOC_COMMENT","\/**\n     * Request's order model\n     *\n     * @var \\Magento\\Sales\\Model\\Order\n     *\/",25],["T_WHITESPACE","\n    ",29],["T_PROTECTED","protected",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$order",30],";",["T_WHITESPACE","\n\n    ",30],["T_DOC_COMMENT","\/**\n     * Request's Hosted Pro payment method model\n     *\n     * @var \\Magento\\Paypal\\Model\\Hostedpro\n     *\/",32],["T_WHITESPACE","\n    ",36],["T_PROTECTED","protected",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$paymentMethod",37],";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * Name format for button variables\n     *\n     * @var string\n     *\/",39],["T_WHITESPACE","\n    ",43],["T_PROTECTED","protected",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$buttonVarFormat",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'L_BUTTONVAR%d'",44],";",["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * Request Parameters which dont have to wrap as button vars\n     *\n     * @var string[]\n     *\/",46],["T_WHITESPACE","\n    ",50],["T_PROTECTED","protected",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$notButtonVars",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],"[",["T_CONSTANT_ENCAPSED_STRING","'METHOD'",51],",",["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","'BUTTONCODE'",51],",",["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","'BUTTONTYPE'",51],"]",";",["T_WHITESPACE","\n\n    ",51],["T_DOC_COMMENT","\/**\n     * Customer address\n     *\n     * @var \\Magento\\Customer\\Helper\\Address\n     *\/",53],["T_WHITESPACE","\n    ",57],["T_PROTECTED","protected",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$customerAddress",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_STRING","null",58],";",["T_WHITESPACE","\n\n    ",58],["T_DOC_COMMENT","\/**\n     * Tax data\n     *\n     * @var \\Magento\\Tax\\Helper\\Data\n     *\/",60],["T_WHITESPACE","\n    ",64],["T_PROTECTED","protected",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$taxData",65],";",["T_WHITESPACE","\n\n    ",65],["T_DOC_COMMENT","\/**\n     * Locale Resolver\n     *\n     * @var \\Magento\\Framework\\Locale\\Resolver\n     *\/",67],["T_WHITESPACE","\n    ",71],["T_PROTECTED","protected",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$localeResolver",72],";",["T_WHITESPACE","\n\n    ",72],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\Locale\\Resolver $localeResolver\n     * @param \\Magento\\Customer\\Helper\\Address $customerAddress\n     * @param \\Magento\\Tax\\Helper\\Data $taxData\n     * @param array $data\n     *\/",74],["T_WHITESPACE","\n    ",79],["T_PUBLIC","public",80],["T_WHITESPACE"," ",80],["T_FUNCTION","function",80],["T_WHITESPACE"," ",80],["T_STRING","__construct",80],"(",["T_WHITESPACE","\n        ",80],["T_STRING","Resolver",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$localeResolver",81],",",["T_WHITESPACE","\n        ",81],["T_STRING","Address",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$customerAddress",82],",",["T_WHITESPACE","\n        ",82],["T_STRING","Data",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$taxData",83],",",["T_WHITESPACE","\n        ",83],["T_ARRAY","array",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$data",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],"[","]",["T_WHITESPACE","\n    ",84],")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n        ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","customerAddress",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$customerAddress",86],";",["T_WHITESPACE","\n        ",86],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","localeResolver",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_VARIABLE","$localeResolver",87],";",["T_WHITESPACE","\n        ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","taxData",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$taxData",88],";",["T_WHITESPACE","\n        ",88],["T_STRING","parent",89],["T_DOUBLE_COLON","::",89],["T_STRING","__construct",89],"(",["T_VARIABLE","$data",89],")",";",["T_WHITESPACE","\n    ",89],"}",["T_WHITESPACE","\n\n    ",90],["T_DOC_COMMENT","\/**\n     * Build and return request array from object data\n     *\n     * @return array\n     *\/",92],["T_WHITESPACE","\n    ",96],["T_PUBLIC","public",97],["T_WHITESPACE"," ",97],["T_FUNCTION","function",97],["T_WHITESPACE"," ",97],["T_STRING","getRequestData",97],"(",")",["T_WHITESPACE","\n    ",97],"{",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$requestData",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],"[","]",";",["T_WHITESPACE","\n        ",99],["T_IF","if",100],["T_WHITESPACE"," ",100],"(","!",["T_EMPTY","empty",100],"(",["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","_data",100],")",")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n            ",100],["T_COMMENT","\/\/ insert params to request as additional button variables,\n",101],["T_WHITESPACE","            ",102],["T_COMMENT","\/\/ except special params from _notButtonVars list\n",102],["T_WHITESPACE","            ",103],["T_VARIABLE","$i",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_LNUMBER","0",103],";",["T_WHITESPACE","\n            ",103],["T_FOREACH","foreach",104],["T_WHITESPACE"," ",104],"(",["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","_data",104],["T_WHITESPACE"," ",104],["T_AS","as",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$key",104],["T_WHITESPACE"," ",104],["T_DOUBLE_ARROW","=>",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$value",104],")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n                ",104],["T_IF","if",105],["T_WHITESPACE"," ",105],"(",["T_STRING","in_array",105],"(",["T_VARIABLE","$key",105],",",["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","notButtonVars",105],")",")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n                    ",105],["T_VARIABLE","$requestData",106],"[",["T_VARIABLE","$key",106],"]",["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_VARIABLE","$value",106],";",["T_WHITESPACE","\n                ",106],"}",["T_WHITESPACE"," ",107],["T_ELSE","else",107],["T_WHITESPACE"," ",107],"{",["T_WHITESPACE","\n                    ",107],["T_VARIABLE","$varKey",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_STRING","sprintf",108],"(",["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","buttonVarFormat",108],",",["T_WHITESPACE"," ",108],["T_VARIABLE","$i",108],")",";",["T_WHITESPACE","\n                    ",108],["T_VARIABLE","$requestData",109],"[",["T_VARIABLE","$varKey",109],"]",["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$key",109],["T_WHITESPACE"," ",109],".",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'='",109],["T_WHITESPACE"," ",109],".",["T_WHITESPACE"," ",109],["T_VARIABLE","$value",109],";",["T_WHITESPACE","\n                    ",109],["T_VARIABLE","$i",110],["T_INC","++",110],";",["T_WHITESPACE","\n                ",110],"}",["T_WHITESPACE","\n            ",111],"}",["T_WHITESPACE","\n        ",112],"}",["T_WHITESPACE","\n\n        ",113],["T_RETURN","return",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$requestData",115],";",["T_WHITESPACE","\n    ",115],"}",["T_WHITESPACE","\n\n    ",116],["T_DOC_COMMENT","\/**\n     * Append payment data to request\n     *\n     * @param \\Magento\\Paypal\\Model\\Hostedpro $paymentMethod\n     * @return $this\n     *\/",118],["T_WHITESPACE","\n    ",123],["T_PUBLIC","public",124],["T_WHITESPACE"," ",124],["T_FUNCTION","function",124],["T_WHITESPACE"," ",124],["T_STRING","setPaymentMethod",124],"(",["T_VARIABLE","$paymentMethod",124],")",["T_WHITESPACE","\n    ",124],"{",["T_WHITESPACE","\n        ",125],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","paymentMethod",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$paymentMethod",126],";",["T_WHITESPACE","\n        ",126],["T_VARIABLE","$requestData",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","getPaymentData",127],"(",["T_VARIABLE","$paymentMethod",127],")",";",["T_WHITESPACE","\n        ",127],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","addData",128],"(",["T_VARIABLE","$requestData",128],")",";",["T_WHITESPACE","\n\n        ",128],["T_RETURN","return",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],";",["T_WHITESPACE","\n    ",130],"}",["T_WHITESPACE","\n\n    ",131],["T_DOC_COMMENT","\/**\n     * Append order data to request\n     *\n     * @param \\Magento\\Sales\\Model\\Order $order\n     * @return $this\n     *\/",133],["T_WHITESPACE","\n    ",138],["T_PUBLIC","public",139],["T_WHITESPACE"," ",139],["T_FUNCTION","function",139],["T_WHITESPACE"," ",139],["T_STRING","setOrder",139],"(",["T_STRING","Order",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$order",139],")",["T_WHITESPACE","\n    ",139],"{",["T_WHITESPACE","\n        ",140],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","order",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_VARIABLE","$order",141],";",["T_WHITESPACE","\n        ",141],["T_VARIABLE","$requestData",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","getOrderData",142],"(",["T_VARIABLE","$order",142],")",";",["T_WHITESPACE","\n        ",142],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","addData",143],"(",["T_VARIABLE","$requestData",143],")",";",["T_WHITESPACE","\n\n        ",143],["T_RETURN","return",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$this",145],";",["T_WHITESPACE","\n    ",145],"}",["T_WHITESPACE","\n\n    ",146],["T_DOC_COMMENT","\/**\n     * Add amount data to request\n     *\n     * @access public\n     * @param \\Magento\\Sales\\Model\\Order $order\n     * @return $this\n     *\/",148],["T_WHITESPACE","\n    ",154],["T_PUBLIC","public",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","setAmount",155],"(",["T_STRING","Order",155],["T_WHITESPACE"," ",155],["T_VARIABLE","$order",155],")",["T_WHITESPACE","\n    ",155],"{",["T_WHITESPACE","\n        ",156],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","addData",157],"(",["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","getAmountData",157],"(",["T_VARIABLE","$order",157],")",")",";",["T_WHITESPACE","\n        ",157],["T_RETURN","return",158],["T_WHITESPACE"," ",158],["T_VARIABLE","$this",158],";",["T_WHITESPACE","\n    ",158],"}",["T_WHITESPACE","\n\n    ",159],["T_DOC_COMMENT","\/**\n     * Calculate amount for order\n     * @param \\Magento\\Sales\\Model\\Order $order\n     * @return array\n     * @throws \\Exception\n     *\/",161],["T_WHITESPACE","\n    ",166],["T_PROTECTED","protected",167],["T_WHITESPACE"," ",167],["T_FUNCTION","function",167],["T_WHITESPACE"," ",167],["T_STRING","getAmountData",167],"(",["T_STRING","Order",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$order",167],")",["T_WHITESPACE","\n    ",167],"{",["T_WHITESPACE","\n        ",168],["T_COMMENT","\/\/ if tax is included - need add to request only total amount\n",169],["T_WHITESPACE","        ",170],["T_IF","if",170],["T_WHITESPACE"," ",170],"(",["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","taxData",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","getConfig",170],"(",")",["T_OBJECT_OPERATOR","->",170],["T_STRING","priceIncludesTax",170],"(",")",")",["T_WHITESPACE"," ",170],"{",["T_WHITESPACE","\n            ",170],["T_RETURN","return",171],["T_WHITESPACE"," ",171],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","getTaxableAmount",171],"(",["T_VARIABLE","$order",171],")",";",["T_WHITESPACE","\n        ",171],"}",["T_WHITESPACE"," ",172],["T_ELSE","else",172],["T_WHITESPACE"," ",172],"{",["T_WHITESPACE","\n            ",172],["T_RETURN","return",173],["T_WHITESPACE"," ",173],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","getNonTaxableAmount",173],"(",["T_VARIABLE","$order",173],")",";",["T_WHITESPACE","\n        ",173],"}",["T_WHITESPACE","\n    ",174],"}",["T_WHITESPACE","\n\n    ",175],["T_DOC_COMMENT","\/**\n     * Get payment amount data with excluded tax\n     * @param \\Magento\\Sales\\Model\\Order $order\n     * @return array\n     *\/",177],["T_WHITESPACE","\n    ",181],["T_PRIVATE","private",182],["T_WHITESPACE"," ",182],["T_FUNCTION","function",182],["T_WHITESPACE"," ",182],["T_STRING","getNonTaxableAmount",182],"(",["T_STRING","Order",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$order",182],")",["T_WHITESPACE","\n    ",182],"{",["T_WHITESPACE","\n        ",183],["T_COMMENT","\/\/ PayPal denied transaction with 0 amount\n",184],["T_WHITESPACE","        ",185],["T_VARIABLE","$subtotal",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_VARIABLE","$order",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","getBaseSubtotal",185],"(",")",["T_WHITESPACE"," ",185],"?",["T_WHITESPACE"," ",185],":",["T_WHITESPACE"," ",185],["T_VARIABLE","$order",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","getPayment",185],"(",")",["T_OBJECT_OPERATOR","->",185],["T_STRING","getBaseAmountAuthorized",185],"(",")",";",["T_WHITESPACE","\n\n        ",185],["T_RETURN","return",187],["T_WHITESPACE"," ",187],"[",["T_WHITESPACE","\n            ",187],["T_CONSTANT_ENCAPSED_STRING","'subtotal'",188],["T_WHITESPACE"," ",188],["T_DOUBLE_ARROW","=>",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","formatPrice",188],"(",["T_VARIABLE","$subtotal",188],")",",",["T_WHITESPACE","\n            ",188],["T_CONSTANT_ENCAPSED_STRING","'total'",189],["T_WHITESPACE"," ",189],["T_DOUBLE_ARROW","=>",189],["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","formatPrice",189],"(",["T_VARIABLE","$order",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getPayment",189],"(",")",["T_OBJECT_OPERATOR","->",189],["T_STRING","getBaseAmountAuthorized",189],"(",")",")",",",["T_WHITESPACE","\n            ",189],["T_CONSTANT_ENCAPSED_STRING","'tax'",190],["T_WHITESPACE"," ",190],["T_DOUBLE_ARROW","=>",190],["T_WHITESPACE"," ",190],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","formatPrice",190],"(",["T_VARIABLE","$order",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","getBaseTaxAmount",190],"(",")",")",",",["T_WHITESPACE","\n            ",190],["T_CONSTANT_ENCAPSED_STRING","'shipping'",191],["T_WHITESPACE"," ",191],["T_DOUBLE_ARROW","=>",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","formatPrice",191],"(",["T_VARIABLE","$order",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","getBaseShippingAmount",191],"(",")",")",",",["T_WHITESPACE","\n            ",191],["T_CONSTANT_ENCAPSED_STRING","'discount'",192],["T_WHITESPACE"," ",192],["T_DOUBLE_ARROW","=>",192],["T_WHITESPACE"," ",192],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","formatPrice",192],"(",["T_STRING","abs",192],"(",["T_VARIABLE","$order",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","getBaseDiscountAmount",192],"(",")",")",")",["T_WHITESPACE","\n        ",192],"]",";",["T_WHITESPACE","\n    ",193],"}",["T_WHITESPACE","\n\n    ",194],["T_DOC_COMMENT","\/**\n     * Get order amount data with included tax\n     * @param \\Magento\\Sales\\Model\\Order $order\n     * @return array\n     *\/",196],["T_WHITESPACE","\n    ",200],["T_PRIVATE","private",201],["T_WHITESPACE"," ",201],["T_FUNCTION","function",201],["T_WHITESPACE"," ",201],["T_STRING","getTaxableAmount",201],"(",["T_STRING","Order",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$order",201],")",["T_WHITESPACE","\n    ",201],"{",["T_WHITESPACE","\n        ",202],["T_VARIABLE","$amount",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","formatPrice",203],"(",["T_VARIABLE","$order",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","getPayment",203],"(",")",["T_OBJECT_OPERATOR","->",203],["T_STRING","getBaseAmountAuthorized",203],"(",")",")",";",["T_WHITESPACE","\n\n        ",203],["T_RETURN","return",205],["T_WHITESPACE"," ",205],"[",["T_WHITESPACE","\n            ",205],["T_CONSTANT_ENCAPSED_STRING","'amount'",206],["T_WHITESPACE"," ",206],["T_DOUBLE_ARROW","=>",206],["T_WHITESPACE"," ",206],["T_VARIABLE","$amount",206],",",["T_WHITESPACE","\n            ",206],["T_CONSTANT_ENCAPSED_STRING","'subtotal'",207],["T_WHITESPACE"," ",207],["T_DOUBLE_ARROW","=>",207],["T_WHITESPACE"," ",207],["T_VARIABLE","$amount",207],["T_WHITESPACE"," ",207],["T_COMMENT","\/\/ subtotal always is required\n",207],["T_WHITESPACE","        ",208],"]",";",["T_WHITESPACE","\n    ",208],"}",["T_WHITESPACE","\n\n    ",209],["T_DOC_COMMENT","\/**\n     * Get payment request data as array\n     *\n     * @param \\Magento\\Paypal\\Model\\Hostedpro $paymentMethod\n     * @return array\n     *\/",211],["T_WHITESPACE","\n    ",216],["T_PROTECTED","protected",217],["T_WHITESPACE"," ",217],["T_FUNCTION","function",217],["T_WHITESPACE"," ",217],["T_STRING","getPaymentData",217],"(",["T_STRING","Hostedpro",217],["T_WHITESPACE"," ",217],["T_VARIABLE","$paymentMethod",217],")",["T_WHITESPACE","\n    ",217],"{",["T_WHITESPACE","\n        ",218],["T_VARIABLE","$request",219],["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],"[",["T_WHITESPACE","\n            ",219],["T_CONSTANT_ENCAPSED_STRING","'paymentaction'",220],["T_WHITESPACE"," ",220],["T_DOUBLE_ARROW","=>",220],["T_WHITESPACE"," ",220],["T_STRING","strtolower",220],"(",["T_VARIABLE","$paymentMethod",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","getConfigData",220],"(",["T_CONSTANT_ENCAPSED_STRING","'payment_action'",220],")",")",",",["T_WHITESPACE","\n            ",220],["T_CONSTANT_ENCAPSED_STRING","'notify_url'",221],["T_WHITESPACE"," ",221],["T_DOUBLE_ARROW","=>",221],["T_WHITESPACE"," ",221],["T_VARIABLE","$paymentMethod",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","getNotifyUrl",221],"(",")",",",["T_WHITESPACE","\n            ",221],["T_CONSTANT_ENCAPSED_STRING","'cancel_return'",222],["T_WHITESPACE"," ",222],["T_DOUBLE_ARROW","=>",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$paymentMethod",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","getCancelUrl",222],"(",")",",",["T_WHITESPACE","\n            ",222],["T_CONSTANT_ENCAPSED_STRING","'return'",223],["T_WHITESPACE"," ",223],["T_DOUBLE_ARROW","=>",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$paymentMethod",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","getReturnUrl",223],"(",")",",",["T_WHITESPACE","\n            ",223],["T_CONSTANT_ENCAPSED_STRING","'lc'",224],["T_WHITESPACE"," ",224],["T_DOUBLE_ARROW","=>",224],["T_WHITESPACE"," ",224],["T_NS_SEPARATOR","\\",224],["T_STRING","Locale",224],["T_DOUBLE_COLON","::",224],["T_STRING","getRegion",224],"(",["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","localeResolver",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","getLocale",224],"(",")",")",",",["T_WHITESPACE","\n            ",224],["T_CONSTANT_ENCAPSED_STRING","'template'",225],["T_WHITESPACE"," ",225],["T_DOUBLE_ARROW","=>",225],["T_WHITESPACE"," ",225],["T_CONSTANT_ENCAPSED_STRING","'mobile-iframe'",225],",",["T_WHITESPACE","\n            ",225],["T_CONSTANT_ENCAPSED_STRING","'showBillingAddress'",226],["T_WHITESPACE"," ",226],["T_DOUBLE_ARROW","=>",226],["T_WHITESPACE"," ",226],["T_CONSTANT_ENCAPSED_STRING","'false'",226],",",["T_WHITESPACE","\n            ",226],["T_CONSTANT_ENCAPSED_STRING","'showShippingAddress'",227],["T_WHITESPACE"," ",227],["T_DOUBLE_ARROW","=>",227],["T_WHITESPACE"," ",227],["T_CONSTANT_ENCAPSED_STRING","'true'",227],",",["T_WHITESPACE","\n            ",227],["T_CONSTANT_ENCAPSED_STRING","'showBillingEmail'",228],["T_WHITESPACE"," ",228],["T_DOUBLE_ARROW","=>",228],["T_WHITESPACE"," ",228],["T_CONSTANT_ENCAPSED_STRING","'false'",228],",",["T_WHITESPACE","\n            ",228],["T_CONSTANT_ENCAPSED_STRING","'showBillingPhone'",229],["T_WHITESPACE"," ",229],["T_DOUBLE_ARROW","=>",229],["T_WHITESPACE"," ",229],["T_CONSTANT_ENCAPSED_STRING","'false'",229],",",["T_WHITESPACE","\n            ",229],["T_CONSTANT_ENCAPSED_STRING","'showCustomerName'",230],["T_WHITESPACE"," ",230],["T_DOUBLE_ARROW","=>",230],["T_WHITESPACE"," ",230],["T_CONSTANT_ENCAPSED_STRING","'false'",230],",",["T_WHITESPACE","\n            ",230],["T_CONSTANT_ENCAPSED_STRING","'showCardInfo'",231],["T_WHITESPACE"," ",231],["T_DOUBLE_ARROW","=>",231],["T_WHITESPACE"," ",231],["T_CONSTANT_ENCAPSED_STRING","'true'",231],",",["T_WHITESPACE","\n            ",231],["T_CONSTANT_ENCAPSED_STRING","'showHostedThankyouPage'",232],["T_WHITESPACE"," ",232],["T_DOUBLE_ARROW","=>",232],["T_WHITESPACE"," ",232],["T_CONSTANT_ENCAPSED_STRING","'false'",232],",",["T_WHITESPACE","\n        ",232],"]",";",["T_WHITESPACE","\n\n        ",233],["T_RETURN","return",235],["T_WHITESPACE"," ",235],["T_VARIABLE","$request",235],";",["T_WHITESPACE","\n    ",235],"}",["T_WHITESPACE","\n\n    ",236],["T_DOC_COMMENT","\/**\n     * Get order request data as array\n     *\n     * @param \\Magento\\Sales\\Model\\Order $order\n     * @return array\n     *\/",238],["T_WHITESPACE","\n    ",243],["T_PROTECTED","protected",244],["T_WHITESPACE"," ",244],["T_FUNCTION","function",244],["T_WHITESPACE"," ",244],["T_STRING","getOrderData",244],"(",["T_STRING","Order",244],["T_WHITESPACE"," ",244],["T_VARIABLE","$order",244],")",["T_WHITESPACE","\n    ",244],"{",["T_WHITESPACE","\n        ",245],["T_VARIABLE","$request",246],["T_WHITESPACE"," ",246],"=",["T_WHITESPACE"," ",246],"[",["T_WHITESPACE","\n            ",246],["T_CONSTANT_ENCAPSED_STRING","'invoice'",247],["T_WHITESPACE"," ",247],["T_DOUBLE_ARROW","=>",247],["T_WHITESPACE"," ",247],["T_VARIABLE","$order",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","getIncrementId",247],"(",")",",",["T_WHITESPACE","\n            ",247],["T_CONSTANT_ENCAPSED_STRING","'address_override'",248],["T_WHITESPACE"," ",248],["T_DOUBLE_ARROW","=>",248],["T_WHITESPACE"," ",248],["T_CONSTANT_ENCAPSED_STRING","'true'",248],",",["T_WHITESPACE","\n            ",248],["T_CONSTANT_ENCAPSED_STRING","'currency_code'",249],["T_WHITESPACE"," ",249],["T_DOUBLE_ARROW","=>",249],["T_WHITESPACE"," ",249],["T_VARIABLE","$order",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","getBaseCurrencyCode",249],"(",")",",",["T_WHITESPACE","\n            ",249],["T_CONSTANT_ENCAPSED_STRING","'buyer_email'",250],["T_WHITESPACE"," ",250],["T_DOUBLE_ARROW","=>",250],["T_WHITESPACE"," ",250],["T_VARIABLE","$order",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","getCustomerEmail",250],"(",")",",",["T_WHITESPACE","\n        ",250],"]",";",["T_WHITESPACE","\n\n        ",251],["T_COMMENT","\/\/ append to request billing address data\n",253],["T_WHITESPACE","        ",254],["T_IF","if",254],["T_WHITESPACE"," ",254],"(",["T_VARIABLE","$billingAddress",254],["T_WHITESPACE"," ",254],"=",["T_WHITESPACE"," ",254],["T_VARIABLE","$order",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","getBillingAddress",254],"(",")",")",["T_WHITESPACE"," ",254],"{",["T_WHITESPACE","\n            ",254],["T_VARIABLE","$request",255],["T_WHITESPACE"," ",255],"=",["T_WHITESPACE"," ",255],["T_STRING","array_merge",255],"(",["T_VARIABLE","$request",255],",",["T_WHITESPACE"," ",255],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","getAddress",255],"(",["T_VARIABLE","$billingAddress",255],",",["T_WHITESPACE"," ",255],["T_CONSTANT_ENCAPSED_STRING","'billing'",255],")",")",";",["T_WHITESPACE","\n        ",255],"}",["T_WHITESPACE","\n\n        ",256],["T_COMMENT","\/\/ append to request shipping address data\n",258],["T_WHITESPACE","        ",259],["T_IF","if",259],["T_WHITESPACE"," ",259],"(",["T_VARIABLE","$shippingAddress",259],["T_WHITESPACE"," ",259],"=",["T_WHITESPACE"," ",259],["T_VARIABLE","$order",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","getShippingAddress",259],"(",")",")",["T_WHITESPACE"," ",259],"{",["T_WHITESPACE","\n            ",259],["T_VARIABLE","$request",260],["T_WHITESPACE"," ",260],"=",["T_WHITESPACE"," ",260],["T_STRING","array_merge",260],"(",["T_VARIABLE","$request",260],",",["T_WHITESPACE"," ",260],["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","getAddress",260],"(",["T_VARIABLE","$shippingAddress",260],")",")",";",["T_WHITESPACE","\n        ",260],"}",["T_WHITESPACE","\n\n        ",261],["T_RETURN","return",263],["T_WHITESPACE"," ",263],["T_VARIABLE","$request",263],";",["T_WHITESPACE","\n    ",263],"}",["T_WHITESPACE","\n\n    ",264],["T_DOC_COMMENT","\/**\n     * Export address data to request\n     *\n     * @param DataObject $address\n     * @param string $type\n     * @return array\n     *\/",266],["T_WHITESPACE","\n    ",272],["T_PROTECTED","protected",273],["T_WHITESPACE"," ",273],["T_FUNCTION","function",273],["T_WHITESPACE"," ",273],["T_STRING","getAddress",273],"(",["T_STRING","DataObject",273],["T_WHITESPACE"," ",273],["T_VARIABLE","$address",273],",",["T_WHITESPACE"," ",273],["T_VARIABLE","$type",273],["T_WHITESPACE"," ",273],"=",["T_WHITESPACE"," ",273],["T_CONSTANT_ENCAPSED_STRING","''",273],")",["T_WHITESPACE","\n    ",273],"{",["T_WHITESPACE","\n        ",274],["T_VARIABLE","$type",275],["T_WHITESPACE"," ",275],"=",["T_WHITESPACE"," ",275],"!",["T_EMPTY","empty",275],"(",["T_VARIABLE","$type",275],")",["T_WHITESPACE"," ",275],"?",["T_WHITESPACE"," ",275],["T_VARIABLE","$type",275],["T_WHITESPACE"," ",275],".",["T_WHITESPACE"," ",275],["T_CONSTANT_ENCAPSED_STRING","'_'",275],["T_WHITESPACE"," ",275],":",["T_WHITESPACE"," ",275],["T_CONSTANT_ENCAPSED_STRING","''",275],";",["T_WHITESPACE","\n        ",275],["T_VARIABLE","$request",276],["T_WHITESPACE"," ",276],"=",["T_WHITESPACE"," ",276],"[",["T_WHITESPACE","\n            ",276],["T_VARIABLE","$type",277],["T_WHITESPACE"," ",277],".",["T_WHITESPACE"," ",277],["T_CONSTANT_ENCAPSED_STRING","'first_name'",277],["T_WHITESPACE"," ",277],["T_DOUBLE_ARROW","=>",277],["T_WHITESPACE"," ",277],["T_VARIABLE","$address",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","getFirstname",277],"(",")",",",["T_WHITESPACE","\n            ",277],["T_VARIABLE","$type",278],["T_WHITESPACE"," ",278],".",["T_WHITESPACE"," ",278],["T_CONSTANT_ENCAPSED_STRING","'last_name'",278],["T_WHITESPACE"," ",278],["T_DOUBLE_ARROW","=>",278],["T_WHITESPACE"," ",278],["T_VARIABLE","$address",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","getLastname",278],"(",")",",",["T_WHITESPACE","\n            ",278],["T_VARIABLE","$type",279],["T_WHITESPACE"," ",279],".",["T_WHITESPACE"," ",279],["T_CONSTANT_ENCAPSED_STRING","'city'",279],["T_WHITESPACE"," ",279],["T_DOUBLE_ARROW","=>",279],["T_WHITESPACE"," ",279],["T_VARIABLE","$address",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","getCity",279],"(",")",",",["T_WHITESPACE","\n            ",279],["T_VARIABLE","$type",280],["T_WHITESPACE"," ",280],".",["T_WHITESPACE"," ",280],["T_CONSTANT_ENCAPSED_STRING","'state'",280],["T_WHITESPACE"," ",280],["T_DOUBLE_ARROW","=>",280],["T_WHITESPACE"," ",280],["T_VARIABLE","$this",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","getRegion",280],"(",["T_VARIABLE","$address",280],")",",",["T_WHITESPACE","\n            ",280],["T_VARIABLE","$type",281],["T_WHITESPACE"," ",281],".",["T_WHITESPACE"," ",281],["T_CONSTANT_ENCAPSED_STRING","'zip'",281],["T_WHITESPACE"," ",281],["T_DOUBLE_ARROW","=>",281],["T_WHITESPACE"," ",281],["T_VARIABLE","$address",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","getPostcode",281],"(",")",",",["T_WHITESPACE","\n            ",281],["T_VARIABLE","$type",282],["T_WHITESPACE"," ",282],".",["T_WHITESPACE"," ",282],["T_CONSTANT_ENCAPSED_STRING","'country'",282],["T_WHITESPACE"," ",282],["T_DOUBLE_ARROW","=>",282],["T_WHITESPACE"," ",282],["T_VARIABLE","$address",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","getCountryId",282],"(",")",",",["T_WHITESPACE","\n        ",282],"]",";",["T_WHITESPACE","\n\n        ",283],["T_VARIABLE","$streets",285],["T_WHITESPACE"," ",285],"=",["T_WHITESPACE"," ",285],["T_VARIABLE","$this",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","getAddressStreets",285],"(",["T_VARIABLE","$address",285],")",";",["T_WHITESPACE","\n        ",285],["T_VARIABLE","$request",286],"[",["T_VARIABLE","$type",286],["T_WHITESPACE"," ",286],".",["T_WHITESPACE"," ",286],["T_CONSTANT_ENCAPSED_STRING","'address1'",286],"]",["T_WHITESPACE"," ",286],"=",["T_WHITESPACE"," ",286],["T_VARIABLE","$streets",286],"[",["T_LNUMBER","0",286],"]",";",["T_WHITESPACE","\n        ",286],["T_VARIABLE","$request",287],"[",["T_VARIABLE","$type",287],["T_WHITESPACE"," ",287],".",["T_WHITESPACE"," ",287],["T_CONSTANT_ENCAPSED_STRING","'address2'",287],"]",["T_WHITESPACE"," ",287],"=",["T_WHITESPACE"," ",287],["T_VARIABLE","$streets",287],"[",["T_LNUMBER","1",287],"]",";",["T_WHITESPACE","\n\n        ",287],["T_RETURN","return",289],["T_WHITESPACE"," ",289],["T_VARIABLE","$request",289],";",["T_WHITESPACE","\n    ",289],"}",["T_WHITESPACE","\n\n    ",290],["T_DOC_COMMENT","\/**\n     * Export region code from address data\n     *\n     * @param DataObject $address\n     * @return string\n     *\/",292],["T_WHITESPACE","\n    ",297],["T_PROTECTED","protected",298],["T_WHITESPACE"," ",298],["T_FUNCTION","function",298],["T_WHITESPACE"," ",298],["T_STRING","getRegion",298],"(",["T_STRING","DataObject",298],["T_WHITESPACE"," ",298],["T_VARIABLE","$address",298],")",["T_WHITESPACE","\n    ",298],"{",["T_WHITESPACE","\n        ",299],["T_COMMENT","\/\/ get region code, otherwise - region, otherwise - city\n",300],["T_WHITESPACE","        ",301],["T_RETURN","return",301],["T_WHITESPACE"," ",301],["T_VARIABLE","$address",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","getRegionCode",301],"(",")",["T_WHITESPACE"," ",301],"?",":",["T_WHITESPACE"," ",301],"(",["T_VARIABLE","$address",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","getRegion",301],"(",")",["T_WHITESPACE"," ",301],"?",":",["T_WHITESPACE"," ",301],["T_VARIABLE","$address",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","getCity",301],"(",")",")",";",["T_WHITESPACE","\n    ",301],"}",["T_WHITESPACE","\n\n    ",302],["T_DOC_COMMENT","\/**\n     * Export streets from address data\n     *\n     * @param DataObject $address\n     * @return array\n     *\/",304],["T_WHITESPACE","\n    ",309],["T_PROTECTED","protected",310],["T_WHITESPACE"," ",310],["T_FUNCTION","function",310],["T_WHITESPACE"," ",310],["T_STRING","getAddressStreets",310],"(",["T_STRING","DataObject",310],["T_WHITESPACE"," ",310],["T_VARIABLE","$address",310],")",["T_WHITESPACE","\n    ",310],"{",["T_WHITESPACE","\n        ",311],["T_VARIABLE","$street1",312],["T_WHITESPACE"," ",312],"=",["T_WHITESPACE"," ",312],["T_CONSTANT_ENCAPSED_STRING","''",312],";",["T_WHITESPACE","\n        ",312],["T_VARIABLE","$street2",313],["T_WHITESPACE"," ",313],"=",["T_WHITESPACE"," ",313],["T_CONSTANT_ENCAPSED_STRING","''",313],";",["T_WHITESPACE","\n        ",313],["T_VARIABLE","$data",314],["T_WHITESPACE"," ",314],"=",["T_WHITESPACE"," ",314],["T_VARIABLE","$this",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","customerAddress",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","convertStreetLines",314],"(",["T_VARIABLE","$address",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","getStreet",314],"(",")",",",["T_WHITESPACE"," ",314],["T_LNUMBER","2",314],")",";",["T_WHITESPACE","\n        ",314],["T_IF","if",315],["T_WHITESPACE"," ",315],"(","!",["T_EMPTY","empty",315],"(",["T_VARIABLE","$data",315],"[",["T_LNUMBER","0",315],"]",")",")",["T_WHITESPACE"," ",315],"{",["T_WHITESPACE","\n            ",315],["T_VARIABLE","$street1",316],["T_WHITESPACE"," ",316],"=",["T_WHITESPACE"," ",316],["T_VARIABLE","$data",316],"[",["T_LNUMBER","0",316],"]",";",["T_WHITESPACE","\n        ",316],"}",["T_WHITESPACE","\n        ",317],["T_IF","if",318],["T_WHITESPACE"," ",318],"(","!",["T_EMPTY","empty",318],"(",["T_VARIABLE","$data",318],"[",["T_LNUMBER","1",318],"]",")",")",["T_WHITESPACE"," ",318],"{",["T_WHITESPACE","\n            ",318],["T_VARIABLE","$street2",319],["T_WHITESPACE"," ",319],"=",["T_WHITESPACE"," ",319],["T_VARIABLE","$data",319],"[",["T_LNUMBER","1",319],"]",";",["T_WHITESPACE","\n        ",319],"}",["T_WHITESPACE","\n        ",320],["T_RETURN","return",321],["T_WHITESPACE"," ",321],"[",["T_VARIABLE","$street1",321],",",["T_WHITESPACE"," ",321],["T_VARIABLE","$street2",321],"]",";",["T_WHITESPACE","\n    ",321],"}",["T_WHITESPACE","\n",322],"}",["T_WHITESPACE","\n",323]]