[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Paypal",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Payflow",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * PayPal Website Payments Pro (Payflow Edition) implementation for payment method instances\n * This model was created because right now PayPal Direct and PayPal Express payment\n * (Payflow Edition) methods cannot have same abstract\n *\/",8],["T_WHITESPACE","\n",12],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","Pro",13],["T_WHITESPACE"," ",13],["T_EXTENDS","extends",13],["T_WHITESPACE"," ",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Paypal",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Model",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Pro",13],["T_WHITESPACE","\n",13],"{",["T_WHITESPACE","\n    ",14],["T_DOC_COMMENT","\/**\n     * Api model type\n     *\n     * @var string\n     *\/",15],["T_WHITESPACE","\n    ",19],["T_PROTECTED","protected",20],["T_WHITESPACE"," ",20],["T_VARIABLE","$_apiType",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Magento",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Paypal",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Model",20],["T_NS_SEPARATOR","\\",20],["T_STRING","Api",20],["T_NS_SEPARATOR","\\",20],["T_STRING","PayflowNvp",20],["T_DOUBLE_COLON","::",20],["T_CLASS","class",20],";",["T_WHITESPACE","\n\n    ",20],["T_DOC_COMMENT","\/**\n     * Config model type\n     *\n     * @var string\n     *\/",22],["T_WHITESPACE","\n    ",26],["T_PROTECTED","protected",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$_configType",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],["T_NS_SEPARATOR","\\",27],["T_STRING","Magento",27],["T_NS_SEPARATOR","\\",27],["T_STRING","Paypal",27],["T_NS_SEPARATOR","\\",27],["T_STRING","Model",27],["T_NS_SEPARATOR","\\",27],["T_STRING","Config",27],["T_DOUBLE_COLON","::",27],["T_CLASS","class",27],";",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * Payflow trx_id key in transaction info\n     *\/",29],["T_WHITESPACE","\n    ",31],["T_CONST","const",32],["T_WHITESPACE"," ",32],["T_STRING","TRANSPORT_PAYFLOW_TXN_ID",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","'payflow_trxid'",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * Refund a capture transaction\n     *\n     * @param \\Magento\\Framework\\DataObject $payment\n     * @param float $amount\n     * @return void\n     *\/",34],["T_WHITESPACE","\n    ",40],["T_PUBLIC","public",41],["T_WHITESPACE"," ",41],["T_FUNCTION","function",41],["T_WHITESPACE"," ",41],["T_STRING","refund",41],"(",["T_NS_SEPARATOR","\\",41],["T_STRING","Magento",41],["T_NS_SEPARATOR","\\",41],["T_STRING","Framework",41],["T_NS_SEPARATOR","\\",41],["T_STRING","DataObject",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$payment",41],",",["T_WHITESPACE"," ",41],["T_VARIABLE","$amount",41],")",["T_WHITESPACE","\n    ",41],"{",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$captureTxnId",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","_getParentTransactionId",43],"(",["T_VARIABLE","$payment",43],")",";",["T_WHITESPACE","\n        ",43],["T_IF","if",44],["T_WHITESPACE"," ",44],"(",["T_VARIABLE","$captureTxnId",44],")",["T_WHITESPACE"," ",44],"{",["T_WHITESPACE","\n            ",44],["T_VARIABLE","$api",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","getApi",45],"(",")",";",["T_WHITESPACE","\n            ",45],["T_VARIABLE","$api",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","setAuthorizationId",46],"(",["T_VARIABLE","$captureTxnId",46],")",";",["T_WHITESPACE","\n        ",46],"}",["T_WHITESPACE","\n        ",47],["T_STRING","parent",48],["T_DOUBLE_COLON","::",48],["T_STRING","refund",48],"(",["T_VARIABLE","$payment",48],",",["T_WHITESPACE"," ",48],["T_VARIABLE","$amount",48],")",";",["T_WHITESPACE","\n    ",48],"}",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Is capture request needed on this transaction\n     *\n     * @return true\n     *\/",51],["T_WHITESPACE","\n    ",55],["T_PROTECTED","protected",56],["T_WHITESPACE"," ",56],["T_FUNCTION","function",56],["T_WHITESPACE"," ",56],["T_STRING","_isCaptureNeeded",56],"(",")",["T_WHITESPACE","\n    ",56],"{",["T_WHITESPACE","\n        ",57],["T_RETURN","return",58],["T_WHITESPACE"," ",58],["T_STRING","true",58],";",["T_WHITESPACE","\n    ",58],"}",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * Get payflow transaction id from parent transaction\n     *\n     * @param \\Magento\\Framework\\DataObject $payment\n     * @return string\n     *\/",61],["T_WHITESPACE","\n    ",66],["T_PROTECTED","protected",67],["T_WHITESPACE"," ",67],["T_FUNCTION","function",67],["T_WHITESPACE"," ",67],["T_STRING","_getParentTransactionId",67],"(",["T_NS_SEPARATOR","\\",67],["T_STRING","Magento",67],["T_NS_SEPARATOR","\\",67],["T_STRING","Framework",67],["T_NS_SEPARATOR","\\",67],["T_STRING","DataObject",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$payment",67],")",["T_WHITESPACE","\n    ",67],"{",["T_WHITESPACE","\n        ",68],["T_IF","if",69],["T_WHITESPACE"," ",69],"(",["T_VARIABLE","$payment",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getParentTransactionId",69],"(",")",")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n            ",69],["T_RETURN","return",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","transactionRepository",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getByTransactionId",70],"(",["T_WHITESPACE","\n                ",70],["T_VARIABLE","$payment",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getParentTransactionId",71],"(",")",",",["T_WHITESPACE","\n                ",71],["T_VARIABLE","$payment",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","getId",72],"(",")",",",["T_WHITESPACE","\n                ",72],["T_VARIABLE","$payment",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","getOrder",73],"(",")",["T_OBJECT_OPERATOR","->",73],["T_STRING","getId",73],"(",")",["T_WHITESPACE","\n            ",73],")",["T_OBJECT_OPERATOR","->",74],["T_STRING","getAdditionalInformation",74],"(",["T_WHITESPACE","\n                ",74],["T_STRING","self",75],["T_DOUBLE_COLON","::",75],["T_STRING","TRANSPORT_PAYFLOW_TXN_ID",75],["T_WHITESPACE","\n            ",75],")",";",["T_WHITESPACE","\n        ",76],"}",["T_WHITESPACE","\n        ",77],["T_RETURN","return",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$payment",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getParentTransactionId",78],"(",")",";",["T_WHITESPACE","\n    ",78],"}",["T_WHITESPACE","\n\n    ",79],["T_DOC_COMMENT","\/**\n     * Import capture results to payment\n     *\n     * @param \\Magento\\Paypal\\Model\\Api\\Nvp $api\n     * @param \\Magento\\Sales\\Model\\Order\\Payment $payment\n     * @return void\n     *\/",81],["T_WHITESPACE","\n    ",87],["T_PROTECTED","protected",88],["T_WHITESPACE"," ",88],["T_FUNCTION","function",88],["T_WHITESPACE"," ",88],["T_STRING","_importCaptureResultToPayment",88],"(",["T_VARIABLE","$api",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$payment",88],")",["T_WHITESPACE","\n    ",88],"{",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$payment",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","setTransactionId",90],"(",["T_WHITESPACE","\n            ",90],["T_VARIABLE","$api",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getPaypalTransactionId",91],"(",")",["T_WHITESPACE","\n        ",91],")",["T_OBJECT_OPERATOR","->",92],["T_STRING","setIsTransactionClosed",92],"(",["T_WHITESPACE","\n            ",92],["T_STRING","false",93],["T_WHITESPACE","\n        ",93],")",["T_OBJECT_OPERATOR","->",94],["T_STRING","setTransactionAdditionalInfo",94],"(",["T_WHITESPACE","\n            ",94],["T_STRING","self",95],["T_DOUBLE_COLON","::",95],["T_STRING","TRANSPORT_PAYFLOW_TXN_ID",95],",",["T_WHITESPACE","\n            ",95],["T_VARIABLE","$api",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getTransactionId",96],"(",")",["T_WHITESPACE","\n        ",96],")",";",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$payment",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","setPreparedMessage",98],"(",["T_STRING","__",98],"(",["T_CONSTANT_ENCAPSED_STRING","'Payflow PNREF: #%1.'",98],",",["T_WHITESPACE"," ",98],["T_VARIABLE","$api",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getTransactionId",98],"(",")",")",")",";",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","_infoFactory",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","create",99],"(",")",["T_OBJECT_OPERATOR","->",99],["T_STRING","importToPayment",99],"(",["T_VARIABLE","$api",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$payment",99],")",";",["T_WHITESPACE","\n    ",99],"}",["T_WHITESPACE","\n\n    ",100],["T_DOC_COMMENT","\/**\n     * Fetch transaction details info method does not exists in Payflow\n     *\n     * @param \\Magento\\Payment\\Model\\InfoInterface $payment\n     * @param string $transactionId\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     * @return void\n     * @SuppressWarnings(PHPMD.UnusedFormalParameter)\n     *\/",102],["T_WHITESPACE","\n    ",110],["T_PUBLIC","public",111],["T_WHITESPACE"," ",111],["T_FUNCTION","function",111],["T_WHITESPACE"," ",111],["T_STRING","fetchTransactionInfo",111],"(",["T_NS_SEPARATOR","\\",111],["T_STRING","Magento",111],["T_NS_SEPARATOR","\\",111],["T_STRING","Payment",111],["T_NS_SEPARATOR","\\",111],["T_STRING","Model",111],["T_NS_SEPARATOR","\\",111],["T_STRING","InfoInterface",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$payment",111],",",["T_WHITESPACE"," ",111],["T_VARIABLE","$transactionId",111],")",["T_WHITESPACE","\n    ",111],"{",["T_WHITESPACE","\n        ",112],["T_THROW","throw",113],["T_WHITESPACE"," ",113],["T_NEW","new",113],["T_WHITESPACE"," ",113],["T_NS_SEPARATOR","\\",113],["T_STRING","Magento",113],["T_NS_SEPARATOR","\\",113],["T_STRING","Framework",113],["T_NS_SEPARATOR","\\",113],["T_STRING","Exception",113],["T_NS_SEPARATOR","\\",113],["T_STRING","LocalizedException",113],"(",["T_WHITESPACE","\n            ",113],["T_STRING","__",114],"(",["T_CONSTANT_ENCAPSED_STRING","'Unable to fetch transaction details.'",114],")",["T_WHITESPACE","\n        ",114],")",";",["T_WHITESPACE","\n    ",115],"}",["T_WHITESPACE","\n\n    ",116],["T_DOC_COMMENT","\/**\n     * Import refund results to payment\n     *\n     * @param \\Magento\\Paypal\\Model\\Api\\Nvp $api\n     * @param \\Magento\\Sales\\Model\\Order\\Payment $payment\n     * @param bool $canRefundMore\n     * @return void\n     *\/",118],["T_WHITESPACE","\n    ",125],["T_PROTECTED","protected",126],["T_WHITESPACE"," ",126],["T_FUNCTION","function",126],["T_WHITESPACE"," ",126],["T_STRING","_importRefundResultToPayment",126],"(",["T_VARIABLE","$api",126],",",["T_WHITESPACE"," ",126],["T_VARIABLE","$payment",126],",",["T_WHITESPACE"," ",126],["T_VARIABLE","$canRefundMore",126],")",["T_WHITESPACE","\n    ",126],"{",["T_WHITESPACE","\n        ",127],["T_VARIABLE","$payment",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","setTransactionId",128],"(",["T_WHITESPACE","\n            ",128],["T_VARIABLE","$api",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getPaypalTransactionId",129],"(",")",["T_WHITESPACE","\n        ",129],")",["T_OBJECT_OPERATOR","->",130],["T_STRING","setIsTransactionClosed",130],"(",["T_WHITESPACE","\n            ",130],["T_LNUMBER","1",131],["T_WHITESPACE"," ",131],["T_COMMENT","\/\/ refund initiated by merchant\n",131],["T_WHITESPACE","        ",132],")",["T_OBJECT_OPERATOR","->",132],["T_STRING","setShouldCloseParentTransaction",132],"(",["T_WHITESPACE","\n            ",132],"!",["T_VARIABLE","$canRefundMore",133],["T_WHITESPACE","\n        ",133],")",["T_OBJECT_OPERATOR","->",134],["T_STRING","setTransactionAdditionalInfo",134],"(",["T_WHITESPACE","\n            ",134],["T_STRING","self",135],["T_DOUBLE_COLON","::",135],["T_STRING","TRANSPORT_PAYFLOW_TXN_ID",135],",",["T_WHITESPACE","\n            ",135],["T_VARIABLE","$api",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getTransactionId",136],"(",")",["T_WHITESPACE","\n        ",136],")",";",["T_WHITESPACE","\n        ",137],["T_VARIABLE","$payment",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","setPreparedMessage",138],"(",["T_STRING","__",138],"(",["T_CONSTANT_ENCAPSED_STRING","'Payflow PNREF: #%1.'",138],",",["T_WHITESPACE"," ",138],["T_VARIABLE","$api",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","getTransactionId",138],"(",")",")",")",";",["T_WHITESPACE","\n        ",138],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","_infoFactory",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","create",139],"(",")",["T_OBJECT_OPERATOR","->",139],["T_STRING","importToPayment",139],"(",["T_VARIABLE","$api",139],",",["T_WHITESPACE"," ",139],["T_VARIABLE","$payment",139],")",";",["T_WHITESPACE","\n    ",139],"}",["T_WHITESPACE","\n",140],"}",["T_WHITESPACE","\n",141]]