[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_COMMENT","\/\/ @codingStandardsIgnoreFile\n",7],["T_WHITESPACE","\n",8],["T_NAMESPACE","namespace",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Paypal",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Model",9],";",["T_WHITESPACE","\n\n",9],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Paypal",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Model",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Api",11],["T_NS_SEPARATOR","\\",11],["T_STRING","AbstractApi",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Sales",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Api",12],["T_NS_SEPARATOR","\\",12],["T_STRING","TransactionRepositoryInterface",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Paypal",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Model",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Info",13],";",["T_WHITESPACE","\n\n",13],["T_DOC_COMMENT","\/**\n * PayPal Website Payments Pro implementation for payment method instances\n * This model was created because right now PayPal Direct and PayPal Express payment methods cannot have same abstract\n *\/",15],["T_WHITESPACE","\n",18],["T_CLASS","class",19],["T_WHITESPACE"," ",19],["T_STRING","Pro",19],["T_WHITESPACE","\n",19],"{",["T_WHITESPACE","\n    ",20],["T_DOC_COMMENT","\/**\n     * Possible payment review actions (for FMF only)\n     *\/",21],["T_WHITESPACE","\n    ",23],["T_CONST","const",24],["T_WHITESPACE"," ",24],["T_STRING","PAYMENT_REVIEW_ACCEPT",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","'accept'",24],";",["T_WHITESPACE","\n\n    ",24],["T_CONST","const",26],["T_WHITESPACE"," ",26],["T_STRING","PAYMENT_REVIEW_DENY",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","'deny'",26],";",["T_WHITESPACE","\n\n    ",26],["T_DOC_COMMENT","\/**\n     * Config instance\n     *\n     * @var \\Magento\\Paypal\\Model\\Config\n     *\/",28],["T_WHITESPACE","\n    ",32],["T_PROTECTED","protected",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$_config",33],";",["T_WHITESPACE","\n\n    ",33],["T_DOC_COMMENT","\/**\n     * API instance\n     *\n     * @var \\Magento\\Paypal\\Model\\Api\\Nvp\n     *\/",35],["T_WHITESPACE","\n    ",39],["T_PROTECTED","protected",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$_api",40],";",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/**\n     * PayPal info object\n     *\n     * @var \\Magento\\Paypal\\Model\\Info\n     *\/",42],["T_WHITESPACE","\n    ",46],["T_PROTECTED","protected",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$_infoInstance",47],";",["T_WHITESPACE","\n\n    ",47],["T_DOC_COMMENT","\/**\n     * API model type\n     *\n     * @var string\n     *\/",49],["T_WHITESPACE","\n    ",53],["T_PROTECTED","protected",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$_apiType",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Magento",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Paypal",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Model",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Api",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Nvp",54],["T_DOUBLE_COLON","::",54],["T_CLASS","class",54],";",["T_WHITESPACE","\n\n    ",54],["T_DOC_COMMENT","\/**\n     * Config model type\n     *\n     * @var string\n     *\/",56],["T_WHITESPACE","\n    ",60],["T_PROTECTED","protected",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$_configType",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_NS_SEPARATOR","\\",61],["T_STRING","Magento",61],["T_NS_SEPARATOR","\\",61],["T_STRING","Paypal",61],["T_NS_SEPARATOR","\\",61],["T_STRING","Model",61],["T_NS_SEPARATOR","\\",61],["T_STRING","Config",61],["T_DOUBLE_COLON","::",61],["T_CLASS","class",61],";",["T_WHITESPACE","\n\n    ",61],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Paypal\\Model\\Config\\Factory\n     *\/",63],["T_WHITESPACE","\n    ",65],["T_PROTECTED","protected",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$_configFactory",66],";",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Paypal\\Model\\Api\\Type\\Factory\n     *\/",68],["T_WHITESPACE","\n    ",70],["T_PROTECTED","protected",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$_apiFactory",71],";",["T_WHITESPACE","\n\n    ",71],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Paypal\\Model\\InfoFactory\n     *\/",73],["T_WHITESPACE","\n    ",75],["T_PROTECTED","protected",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$_infoFactory",76],";",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * @var TransactionRepositoryInterface\n     *\/",78],["T_WHITESPACE","\n    ",80],["T_PROTECTED","protected",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$transactionRepository",81],";",["T_WHITESPACE","\n\n    ",81],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Paypal\\Model\\Config\\Factory $configFactory\n     * @param \\Magento\\Paypal\\Model\\Api\\Type\\Factory $apiFactory\n     * @param \\Magento\\Paypal\\Model\\InfoFactory $infoFactory\n     * @param TransactionRepositoryInterface $transactionRepository\n     *\/",83],["T_WHITESPACE","\n    ",88],["T_PUBLIC","public",89],["T_WHITESPACE"," ",89],["T_FUNCTION","function",89],["T_WHITESPACE"," ",89],["T_STRING","__construct",89],"(",["T_WHITESPACE","\n        ",89],["T_NS_SEPARATOR","\\",90],["T_STRING","Magento",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Paypal",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Model",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Config",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Factory",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$configFactory",90],",",["T_WHITESPACE","\n        ",90],["T_NS_SEPARATOR","\\",91],["T_STRING","Magento",91],["T_NS_SEPARATOR","\\",91],["T_STRING","Paypal",91],["T_NS_SEPARATOR","\\",91],["T_STRING","Model",91],["T_NS_SEPARATOR","\\",91],["T_STRING","Api",91],["T_NS_SEPARATOR","\\",91],["T_STRING","Type",91],["T_NS_SEPARATOR","\\",91],["T_STRING","Factory",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$apiFactory",91],",",["T_WHITESPACE","\n        ",91],["T_NS_SEPARATOR","\\",92],["T_STRING","Magento",92],["T_NS_SEPARATOR","\\",92],["T_STRING","Paypal",92],["T_NS_SEPARATOR","\\",92],["T_STRING","Model",92],["T_NS_SEPARATOR","\\",92],["T_STRING","InfoFactory",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$infoFactory",92],",",["T_WHITESPACE","\n        ",92],["T_STRING","TransactionRepositoryInterface",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$transactionRepository",93],["T_WHITESPACE","\n    ",93],")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","_configFactory",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$configFactory",95],";",["T_WHITESPACE","\n        ",95],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","_apiFactory",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$apiFactory",96],";",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","_infoFactory",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$infoFactory",97],";",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","transactionRepository",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$transactionRepository",98],";",["T_WHITESPACE","\n    ",98],"}",["T_WHITESPACE","\n\n    ",99],["T_DOC_COMMENT","\/**\n     * Payment method code setter. Also instantiates\/updates config\n     *\n     * @param string $code\n     * @param int|null $storeId\n     * @return $this\n     *\/",101],["T_WHITESPACE","\n    ",107],["T_PUBLIC","public",108],["T_WHITESPACE"," ",108],["T_FUNCTION","function",108],["T_WHITESPACE"," ",108],["T_STRING","setMethod",108],"(",["T_VARIABLE","$code",108],",",["T_WHITESPACE"," ",108],["T_VARIABLE","$storeId",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_STRING","null",108],")",["T_WHITESPACE","\n    ",108],"{",["T_WHITESPACE","\n        ",109],["T_IF","if",110],["T_WHITESPACE"," ",110],"(",["T_STRING","null",110],["T_WHITESPACE"," ",110],["T_IS_IDENTICAL","===",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","_config",110],")",["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n            ",110],["T_VARIABLE","$params",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],"[",["T_VARIABLE","$code",111],"]",";",["T_WHITESPACE","\n            ",111],["T_IF","if",112],["T_WHITESPACE"," ",112],"(",["T_STRING","null",112],["T_WHITESPACE"," ",112],["T_IS_NOT_IDENTICAL","!==",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$storeId",112],")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n                ",112],["T_VARIABLE","$params",113],"[","]",["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_VARIABLE","$storeId",113],";",["T_WHITESPACE","\n            ",113],"}",["T_WHITESPACE","\n            ",114],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","_config",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","_configFactory",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","create",115],"(",["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","_configType",115],",",["T_WHITESPACE"," ",115],"[",["T_CONSTANT_ENCAPSED_STRING","'params'",115],["T_WHITESPACE"," ",115],["T_DOUBLE_ARROW","=>",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$params",115],"]",")",";",["T_WHITESPACE","\n        ",115],"}",["T_WHITESPACE"," ",116],["T_ELSE","else",116],["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n            ",116],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","_config",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","setMethod",117],"(",["T_VARIABLE","$code",117],")",";",["T_WHITESPACE","\n            ",117],["T_IF","if",118],["T_WHITESPACE"," ",118],"(",["T_STRING","null",118],["T_WHITESPACE"," ",118],["T_IS_NOT_IDENTICAL","!==",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$storeId",118],")",["T_WHITESPACE"," ",118],"{",["T_WHITESPACE","\n                ",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_config",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","setStoreId",119],"(",["T_VARIABLE","$storeId",119],")",";",["T_WHITESPACE","\n            ",119],"}",["T_WHITESPACE","\n        ",120],"}",["T_WHITESPACE","\n        ",121],["T_RETURN","return",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$this",122],";",["T_WHITESPACE","\n    ",122],"}",["T_WHITESPACE","\n\n    ",123],["T_DOC_COMMENT","\/**\n     * Config instance setter\n     *\n     * @param \\Magento\\Paypal\\Model\\Config $instace\n     * @param int|null $storeId\n     * @return $this\n     *\/",125],["T_WHITESPACE","\n    ",131],["T_PUBLIC","public",132],["T_WHITESPACE"," ",132],["T_FUNCTION","function",132],["T_WHITESPACE"," ",132],["T_STRING","setConfig",132],"(",["T_NS_SEPARATOR","\\",132],["T_STRING","Magento",132],["T_NS_SEPARATOR","\\",132],["T_STRING","Paypal",132],["T_NS_SEPARATOR","\\",132],["T_STRING","Model",132],["T_NS_SEPARATOR","\\",132],["T_STRING","Config",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$instance",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$storeId",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_STRING","null",132],")",["T_WHITESPACE","\n    ",132],"{",["T_WHITESPACE","\n        ",133],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","_config",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_VARIABLE","$instance",134],";",["T_WHITESPACE","\n        ",134],["T_IF","if",135],["T_WHITESPACE"," ",135],"(",["T_STRING","null",135],["T_WHITESPACE"," ",135],["T_IS_NOT_IDENTICAL","!==",135],["T_WHITESPACE"," ",135],["T_VARIABLE","$storeId",135],")",["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n            ",135],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","_config",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","setStoreId",136],"(",["T_VARIABLE","$storeId",136],")",";",["T_WHITESPACE","\n        ",136],"}",["T_WHITESPACE","\n        ",137],["T_RETURN","return",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$this",138],";",["T_WHITESPACE","\n    ",138],"}",["T_WHITESPACE","\n\n    ",139],["T_DOC_COMMENT","\/**\n     * Config instance getter\n     *\n     * @return \\Magento\\Paypal\\Model\\Config\n     *\/",141],["T_WHITESPACE","\n    ",145],["T_PUBLIC","public",146],["T_WHITESPACE"," ",146],["T_FUNCTION","function",146],["T_WHITESPACE"," ",146],["T_STRING","getConfig",146],"(",")",["T_WHITESPACE","\n    ",146],"{",["T_WHITESPACE","\n        ",147],["T_RETURN","return",148],["T_WHITESPACE"," ",148],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","_config",148],";",["T_WHITESPACE","\n    ",148],"}",["T_WHITESPACE","\n\n    ",149],["T_DOC_COMMENT","\/**\n     * API instance getter\n     * Sets current store id to current config instance and passes it to API\n     *\n     * @return \\Magento\\Paypal\\Model\\Api\\Nvp\n     *\/",151],["T_WHITESPACE","\n    ",156],["T_PUBLIC","public",157],["T_WHITESPACE"," ",157],["T_FUNCTION","function",157],["T_WHITESPACE"," ",157],["T_STRING","getApi",157],"(",")",["T_WHITESPACE","\n    ",157],"{",["T_WHITESPACE","\n        ",158],["T_IF","if",159],["T_WHITESPACE"," ",159],"(",["T_STRING","null",159],["T_WHITESPACE"," ",159],["T_IS_IDENTICAL","===",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","_api",159],")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n            ",159],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","_api",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","_apiFactory",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","create",160],"(",["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","_apiType",160],")",";",["T_WHITESPACE","\n        ",160],"}",["T_WHITESPACE","\n        ",161],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","_api",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","setConfigObject",162],"(",["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","_config",162],")",";",["T_WHITESPACE","\n        ",162],["T_RETURN","return",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","_api",163],";",["T_WHITESPACE","\n    ",163],"}",["T_WHITESPACE","\n\n    ",164],["T_DOC_COMMENT","\/**\n     * Destroy existing NVP Api object\n     *\n     * @return $this\n     *\/",166],["T_WHITESPACE","\n    ",170],["T_PUBLIC","public",171],["T_WHITESPACE"," ",171],["T_FUNCTION","function",171],["T_WHITESPACE"," ",171],["T_STRING","resetApi",171],"(",")",["T_WHITESPACE","\n    ",171],"{",["T_WHITESPACE","\n        ",172],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","_api",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_STRING","null",173],";",["T_WHITESPACE","\n\n        ",173],["T_RETURN","return",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],";",["T_WHITESPACE","\n    ",175],"}",["T_WHITESPACE","\n\n    ",176],["T_DOC_COMMENT","\/**\n     * Instantiate and return info model\n     *\n     * @return \\Magento\\Paypal\\Model\\Info\n     *\/",178],["T_WHITESPACE","\n    ",182],["T_PUBLIC","public",183],["T_WHITESPACE"," ",183],["T_FUNCTION","function",183],["T_WHITESPACE"," ",183],["T_STRING","getInfo",183],"(",")",["T_WHITESPACE","\n    ",183],"{",["T_WHITESPACE","\n        ",184],["T_IF","if",185],["T_WHITESPACE"," ",185],"(",["T_STRING","null",185],["T_WHITESPACE"," ",185],["T_IS_IDENTICAL","===",185],["T_WHITESPACE"," ",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","_infoInstance",185],")",["T_WHITESPACE"," ",185],"{",["T_WHITESPACE","\n            ",185],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","_infoInstance",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","_infoFactory",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","create",186],"(",")",";",["T_WHITESPACE","\n        ",186],"}",["T_WHITESPACE","\n        ",187],["T_RETURN","return",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","_infoInstance",188],";",["T_WHITESPACE","\n    ",188],"}",["T_WHITESPACE","\n\n    ",189],["T_DOC_COMMENT","\/**\n     * Transfer transaction\/payment information from API instance to order payment\n     *\n     * @param \\Magento\\Framework\\DataObject|AbstractApi $from\n     * @param \\Magento\\Payment\\Model\\InfoInterface $to\n     * @return $this\n     *\/",191],["T_WHITESPACE","\n    ",197],["T_PUBLIC","public",198],["T_WHITESPACE"," ",198],["T_FUNCTION","function",198],["T_WHITESPACE"," ",198],["T_STRING","importPaymentInfo",198],"(",["T_NS_SEPARATOR","\\",198],["T_STRING","Magento",198],["T_NS_SEPARATOR","\\",198],["T_STRING","Framework",198],["T_NS_SEPARATOR","\\",198],["T_STRING","DataObject",198],["T_WHITESPACE"," ",198],["T_VARIABLE","$from",198],",",["T_WHITESPACE"," ",198],["T_NS_SEPARATOR","\\",198],["T_STRING","Magento",198],["T_NS_SEPARATOR","\\",198],["T_STRING","Payment",198],["T_NS_SEPARATOR","\\",198],["T_STRING","Model",198],["T_NS_SEPARATOR","\\",198],["T_STRING","InfoInterface",198],["T_WHITESPACE"," ",198],["T_VARIABLE","$to",198],")",["T_WHITESPACE","\n    ",198],"{",["T_WHITESPACE","\n        ",199],["T_COMMENT","\/\/ update PayPal-specific payment information in the payment object\n",200],["T_WHITESPACE","        ",201],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","getInfo",201],"(",")",["T_OBJECT_OPERATOR","->",201],["T_STRING","importToPayment",201],"(",["T_VARIABLE","$from",201],",",["T_WHITESPACE"," ",201],["T_VARIABLE","$to",201],")",";",["T_WHITESPACE","\n\n        ",201],["T_DOC_COMMENT","\/**\n         * Detect payment review and\/or frauds\n         * PayPal pro API returns fraud results only in the payment call response\n         *\/",203],["T_WHITESPACE","\n        ",206],["T_IF","if",207],["T_WHITESPACE"," ",207],"(",["T_VARIABLE","$from",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","getDataUsingMethod",207],"(",["T_NS_SEPARATOR","\\",207],["T_STRING","Magento",207],["T_NS_SEPARATOR","\\",207],["T_STRING","Paypal",207],["T_NS_SEPARATOR","\\",207],["T_STRING","Model",207],["T_NS_SEPARATOR","\\",207],["T_STRING","Info",207],["T_DOUBLE_COLON","::",207],["T_STRING","IS_FRAUD",207],")",")",["T_WHITESPACE"," ",207],"{",["T_WHITESPACE","\n            ",207],["T_VARIABLE","$to",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","setIsTransactionPending",208],"(",["T_STRING","true",208],")",";",["T_WHITESPACE","\n            ",208],["T_VARIABLE","$to",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","setIsFraudDetected",209],"(",["T_STRING","true",209],")",";",["T_WHITESPACE","\n        ",209],"}",["T_WHITESPACE"," ",210],["T_ELSEIF","elseif",210],["T_WHITESPACE"," ",210],"(",["T_STRING","Info",210],["T_DOUBLE_COLON","::",210],["T_STRING","isPaymentReviewRequired",210],"(",["T_VARIABLE","$to",210],")",")",["T_WHITESPACE"," ",210],"{",["T_WHITESPACE","\n            ",210],["T_VARIABLE","$to",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","setIsTransactionPending",211],"(",["T_STRING","true",211],")",";",["T_WHITESPACE","\n        ",211],"}",["T_WHITESPACE","\n\n        ",212],["T_COMMENT","\/\/ give generic info about transaction state\n",214],["T_WHITESPACE","        ",215],["T_IF","if",215],["T_WHITESPACE"," ",215],"(",["T_STRING","Info",215],["T_DOUBLE_COLON","::",215],["T_STRING","isPaymentSuccessful",215],"(",["T_VARIABLE","$to",215],")",")",["T_WHITESPACE"," ",215],"{",["T_WHITESPACE","\n            ",215],["T_VARIABLE","$to",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","setIsTransactionApproved",216],"(",["T_STRING","true",216],")",";",["T_WHITESPACE","\n        ",216],"}",["T_WHITESPACE"," ",217],["T_ELSEIF","elseif",217],["T_WHITESPACE"," ",217],"(",["T_STRING","Info",217],["T_DOUBLE_COLON","::",217],["T_STRING","isPaymentFailed",217],"(",["T_VARIABLE","$to",217],")",")",["T_WHITESPACE"," ",217],"{",["T_WHITESPACE","\n            ",217],["T_VARIABLE","$to",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","setIsTransactionDenied",218],"(",["T_STRING","true",218],")",";",["T_WHITESPACE","\n        ",218],"}",["T_WHITESPACE","\n\n        ",219],["T_RETURN","return",221],["T_WHITESPACE"," ",221],["T_VARIABLE","$this",221],";",["T_WHITESPACE","\n    ",221],"}",["T_WHITESPACE","\n\n    ",222],["T_DOC_COMMENT","\/**\n     * Void transaction\n     *\n     * @param \\Magento\\Framework\\DataObject $payment\n     * @return void\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     *\/",224],["T_WHITESPACE","\n    ",230],["T_PUBLIC","public",231],["T_WHITESPACE"," ",231],["T_FUNCTION","function",231],["T_WHITESPACE"," ",231],["T_STRING","void",231],"(",["T_NS_SEPARATOR","\\",231],["T_STRING","Magento",231],["T_NS_SEPARATOR","\\",231],["T_STRING","Framework",231],["T_NS_SEPARATOR","\\",231],["T_STRING","DataObject",231],["T_WHITESPACE"," ",231],["T_VARIABLE","$payment",231],")",["T_WHITESPACE","\n    ",231],"{",["T_WHITESPACE","\n        ",232],["T_VARIABLE","$authTransactionId",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","_getParentTransactionId",233],"(",["T_VARIABLE","$payment",233],")",";",["T_WHITESPACE","\n        ",233],["T_IF","if",234],["T_WHITESPACE"," ",234],"(",["T_VARIABLE","$authTransactionId",234],")",["T_WHITESPACE"," ",234],"{",["T_WHITESPACE","\n            ",234],["T_VARIABLE","$api",235],["T_WHITESPACE"," ",235],"=",["T_WHITESPACE"," ",235],["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","getApi",235],"(",")",";",["T_WHITESPACE","\n            ",235],["T_VARIABLE","$api",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","setPayment",236],"(",["T_VARIABLE","$payment",236],")",["T_OBJECT_OPERATOR","->",236],["T_STRING","setAuthorizationId",236],"(",["T_VARIABLE","$authTransactionId",236],")",["T_OBJECT_OPERATOR","->",236],["T_STRING","callDoVoid",236],"(",")",";",["T_WHITESPACE","\n            ",236],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","importPaymentInfo",237],"(",["T_VARIABLE","$api",237],",",["T_WHITESPACE"," ",237],["T_VARIABLE","$payment",237],")",";",["T_WHITESPACE","\n        ",237],"}",["T_WHITESPACE"," ",238],["T_ELSE","else",238],["T_WHITESPACE"," ",238],"{",["T_WHITESPACE","\n            ",238],["T_THROW","throw",239],["T_WHITESPACE"," ",239],["T_NEW","new",239],["T_WHITESPACE"," ",239],["T_NS_SEPARATOR","\\",239],["T_STRING","Magento",239],["T_NS_SEPARATOR","\\",239],["T_STRING","Framework",239],["T_NS_SEPARATOR","\\",239],["T_STRING","Exception",239],["T_NS_SEPARATOR","\\",239],["T_STRING","LocalizedException",239],"(",["T_WHITESPACE","\n                ",239],["T_STRING","__",240],"(",["T_CONSTANT_ENCAPSED_STRING","'You need an authorization transaction to void.'",240],")",["T_WHITESPACE","\n            ",240],")",";",["T_WHITESPACE","\n        ",241],"}",["T_WHITESPACE","\n    ",242],"}",["T_WHITESPACE","\n\n    ",243],["T_DOC_COMMENT","\/**\n     * Attempt to capture payment\n     * Will return false if the payment is not supposed to be captured\n     *\n     * @param \\Magento\\Framework\\DataObject $payment\n     * @param float $amount\n     * @return false|null\n     *\/",245],["T_WHITESPACE","\n    ",252],["T_PUBLIC","public",253],["T_WHITESPACE"," ",253],["T_FUNCTION","function",253],["T_WHITESPACE"," ",253],["T_STRING","capture",253],"(",["T_NS_SEPARATOR","\\",253],["T_STRING","Magento",253],["T_NS_SEPARATOR","\\",253],["T_STRING","Framework",253],["T_NS_SEPARATOR","\\",253],["T_STRING","DataObject",253],["T_WHITESPACE"," ",253],["T_VARIABLE","$payment",253],",",["T_WHITESPACE"," ",253],["T_VARIABLE","$amount",253],")",["T_WHITESPACE","\n    ",253],"{",["T_WHITESPACE","\n        ",254],["T_VARIABLE","$authTransactionId",255],["T_WHITESPACE"," ",255],"=",["T_WHITESPACE"," ",255],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","_getParentTransactionId",255],"(",["T_VARIABLE","$payment",255],")",";",["T_WHITESPACE","\n        ",255],["T_IF","if",256],["T_WHITESPACE"," ",256],"(","!",["T_VARIABLE","$authTransactionId",256],")",["T_WHITESPACE"," ",256],"{",["T_WHITESPACE","\n            ",256],["T_RETURN","return",257],["T_WHITESPACE"," ",257],["T_STRING","false",257],";",["T_WHITESPACE","\n        ",257],"}",["T_WHITESPACE","\n        ",258],["T_VARIABLE","$api",259],["T_WHITESPACE"," ",259],"=",["T_WHITESPACE"," ",259],["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","getApi",259],"(",")",["T_WHITESPACE","\n            ",259],["T_OBJECT_OPERATOR","->",260],["T_STRING","setAuthorizationId",260],"(",["T_VARIABLE","$authTransactionId",260],")",["T_WHITESPACE","\n            ",260],["T_OBJECT_OPERATOR","->",261],["T_STRING","setIsCaptureComplete",261],"(",["T_VARIABLE","$payment",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","getShouldCloseParentTransaction",261],"(",")",")",["T_WHITESPACE","\n            ",261],["T_OBJECT_OPERATOR","->",262],["T_STRING","setAmount",262],"(",["T_VARIABLE","$amount",262],")",";",["T_WHITESPACE","\n\n        ",262],["T_VARIABLE","$order",264],["T_WHITESPACE"," ",264],"=",["T_WHITESPACE"," ",264],["T_VARIABLE","$payment",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","getOrder",264],"(",")",";",["T_WHITESPACE","\n        ",264],["T_VARIABLE","$orderIncrementId",265],["T_WHITESPACE"," ",265],"=",["T_WHITESPACE"," ",265],["T_VARIABLE","$order",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","getIncrementId",265],"(",")",";",["T_WHITESPACE","\n        ",265],["T_VARIABLE","$api",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","setCurrencyCode",266],"(",["T_VARIABLE","$order",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","getBaseCurrencyCode",266],"(",")",")",["T_WHITESPACE","\n            ",266],["T_OBJECT_OPERATOR","->",267],["T_STRING","setInvNum",267],"(",["T_VARIABLE","$orderIncrementId",267],")",["T_WHITESPACE","\n            ",267],["T_OBJECT_OPERATOR","->",268],["T_STRING","setCustref",268],"(",["T_VARIABLE","$orderIncrementId",268],")",["T_WHITESPACE","\n            ",268],["T_OBJECT_OPERATOR","->",269],["T_STRING","setPonum",269],"(",["T_VARIABLE","$order",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","getId",269],"(",")",")",";",["T_WHITESPACE","\n        ",269],["T_COMMENT","\/\/ TODO: pass 'NOTE' to API\n",270],["T_WHITESPACE","\n        ",271],["T_VARIABLE","$api",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","callDoCapture",272],"(",")",";",["T_WHITESPACE","\n        ",272],["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","_importCaptureResultToPayment",273],"(",["T_VARIABLE","$api",273],",",["T_WHITESPACE"," ",273],["T_VARIABLE","$payment",273],")",";",["T_WHITESPACE","\n    ",273],"}",["T_WHITESPACE","\n\n    ",274],["T_DOC_COMMENT","\/**\n     * Refund a capture transaction\n     *\n     * @param \\Magento\\Framework\\DataObject $payment\n     * @param float $amount\n     * @return void\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     *\/",276],["T_WHITESPACE","\n    ",283],["T_PUBLIC","public",284],["T_WHITESPACE"," ",284],["T_FUNCTION","function",284],["T_WHITESPACE"," ",284],["T_STRING","refund",284],"(",["T_NS_SEPARATOR","\\",284],["T_STRING","Magento",284],["T_NS_SEPARATOR","\\",284],["T_STRING","Framework",284],["T_NS_SEPARATOR","\\",284],["T_STRING","DataObject",284],["T_WHITESPACE"," ",284],["T_VARIABLE","$payment",284],",",["T_WHITESPACE"," ",284],["T_VARIABLE","$amount",284],")",["T_WHITESPACE","\n    ",284],"{",["T_WHITESPACE","\n        ",285],["T_VARIABLE","$captureTxnId",286],["T_WHITESPACE"," ",286],"=",["T_WHITESPACE"," ",286],["T_VARIABLE","$this",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","_getParentTransactionId",286],"(",["T_VARIABLE","$payment",286],")",";",["T_WHITESPACE","\n        ",286],["T_IF","if",287],["T_WHITESPACE"," ",287],"(",["T_VARIABLE","$captureTxnId",287],")",["T_WHITESPACE"," ",287],"{",["T_WHITESPACE","\n            ",287],["T_VARIABLE","$api",288],["T_WHITESPACE"," ",288],"=",["T_WHITESPACE"," ",288],["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","getApi",288],"(",")",";",["T_WHITESPACE","\n            ",288],["T_VARIABLE","$order",289],["T_WHITESPACE"," ",289],"=",["T_WHITESPACE"," ",289],["T_VARIABLE","$payment",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","getOrder",289],"(",")",";",["T_WHITESPACE","\n            ",289],["T_VARIABLE","$api",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","setPayment",290],"(",["T_WHITESPACE","\n                ",290],["T_VARIABLE","$payment",291],["T_WHITESPACE","\n            ",291],")",["T_OBJECT_OPERATOR","->",292],["T_STRING","setTransactionId",292],"(",["T_WHITESPACE","\n                ",292],["T_VARIABLE","$captureTxnId",293],["T_WHITESPACE","\n            ",293],")",["T_OBJECT_OPERATOR","->",294],["T_STRING","setAmount",294],"(",["T_WHITESPACE","\n                ",294],["T_VARIABLE","$amount",295],["T_WHITESPACE","\n            ",295],")",["T_OBJECT_OPERATOR","->",296],["T_STRING","setCurrencyCode",296],"(",["T_WHITESPACE","\n                ",296],["T_VARIABLE","$order",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","getBaseCurrencyCode",297],"(",")",["T_WHITESPACE","\n            ",297],")",";",["T_WHITESPACE","\n            ",298],["T_VARIABLE","$canRefundMore",299],["T_WHITESPACE"," ",299],"=",["T_WHITESPACE"," ",299],["T_VARIABLE","$payment",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","getCreditmemo",299],"(",")",["T_OBJECT_OPERATOR","->",299],["T_STRING","getInvoice",299],"(",")",["T_OBJECT_OPERATOR","->",299],["T_STRING","canRefund",299],"(",")",";",["T_WHITESPACE","\n            ",299],["T_VARIABLE","$isFullRefund",300],["T_WHITESPACE"," ",300],"=",["T_WHITESPACE"," ",300],"!",["T_VARIABLE","$canRefundMore",300],["T_WHITESPACE"," ",300],["T_BOOLEAN_AND","&&",300],["T_WHITESPACE","\n                ",300],["T_LNUMBER","0",301],["T_WHITESPACE"," ",301],["T_IS_EQUAL","==",301],["T_WHITESPACE"," ",301],["T_DOUBLE_CAST","(double)",301],["T_VARIABLE","$order",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","getBaseTotalOnlineRefunded",301],"(",")",["T_WHITESPACE"," ",301],"+",["T_WHITESPACE"," ",301],["T_DOUBLE_CAST","(double)",301],["T_VARIABLE","$order",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","getBaseTotalOfflineRefunded",301],"(",")",";",["T_WHITESPACE","\n            ",301],["T_VARIABLE","$api",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","setRefundType",302],"(",["T_WHITESPACE","\n                ",302],["T_VARIABLE","$isFullRefund",303],["T_WHITESPACE"," ",303],"?",["T_WHITESPACE"," ",303],["T_NS_SEPARATOR","\\",303],["T_STRING","Magento",303],["T_NS_SEPARATOR","\\",303],["T_STRING","Paypal",303],["T_NS_SEPARATOR","\\",303],["T_STRING","Model",303],["T_NS_SEPARATOR","\\",303],["T_STRING","Config",303],["T_DOUBLE_COLON","::",303],["T_STRING","REFUND_TYPE_FULL",303],["T_WHITESPACE"," ",303],":",["T_WHITESPACE"," ",303],["T_NS_SEPARATOR","\\",303],["T_STRING","Magento",303],["T_NS_SEPARATOR","\\",303],["T_STRING","Paypal",303],["T_NS_SEPARATOR","\\",303],["T_STRING","Model",303],["T_NS_SEPARATOR","\\",303],["T_STRING","Config",303],["T_DOUBLE_COLON","::",303],["T_STRING","REFUND_TYPE_PARTIAL",303],["T_WHITESPACE","\n            ",303],")",";",["T_WHITESPACE","\n            ",304],["T_VARIABLE","$api",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","callRefundTransaction",305],"(",")",";",["T_WHITESPACE","\n            ",305],["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","_importRefundResultToPayment",306],"(",["T_VARIABLE","$api",306],",",["T_WHITESPACE"," ",306],["T_VARIABLE","$payment",306],",",["T_WHITESPACE"," ",306],["T_VARIABLE","$canRefundMore",306],")",";",["T_WHITESPACE","\n        ",306],"}",["T_WHITESPACE"," ",307],["T_ELSE","else",307],["T_WHITESPACE"," ",307],"{",["T_WHITESPACE","\n            ",307],["T_THROW","throw",308],["T_WHITESPACE"," ",308],["T_NEW","new",308],["T_WHITESPACE"," ",308],["T_NS_SEPARATOR","\\",308],["T_STRING","Magento",308],["T_NS_SEPARATOR","\\",308],["T_STRING","Framework",308],["T_NS_SEPARATOR","\\",308],["T_STRING","Exception",308],["T_NS_SEPARATOR","\\",308],["T_STRING","LocalizedException",308],"(",["T_WHITESPACE","\n                ",308],["T_STRING","__",309],"(",["T_CONSTANT_ENCAPSED_STRING","'We can\\'t issue a refund transaction because there is no capture transaction.'",309],")",["T_WHITESPACE","\n            ",309],")",";",["T_WHITESPACE","\n        ",310],"}",["T_WHITESPACE","\n    ",311],"}",["T_WHITESPACE","\n\n    ",312],["T_DOC_COMMENT","\/**\n     * Cancel payment\n     *\n     * @param \\Magento\\Framework\\DataObject $payment\n     * @return void\n     *\/",314],["T_WHITESPACE","\n    ",319],["T_PUBLIC","public",320],["T_WHITESPACE"," ",320],["T_FUNCTION","function",320],["T_WHITESPACE"," ",320],["T_STRING","cancel",320],"(",["T_NS_SEPARATOR","\\",320],["T_STRING","Magento",320],["T_NS_SEPARATOR","\\",320],["T_STRING","Framework",320],["T_NS_SEPARATOR","\\",320],["T_STRING","DataObject",320],["T_WHITESPACE"," ",320],["T_VARIABLE","$payment",320],")",["T_WHITESPACE","\n    ",320],"{",["T_WHITESPACE","\n        ",321],["T_IF","if",322],["T_WHITESPACE"," ",322],"(","!",["T_VARIABLE","$payment",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","getOrder",322],"(",")",["T_OBJECT_OPERATOR","->",322],["T_STRING","getInvoiceCollection",322],"(",")",["T_OBJECT_OPERATOR","->",322],["T_STRING","count",322],"(",")",")",["T_WHITESPACE"," ",322],"{",["T_WHITESPACE","\n            ",322],["T_VARIABLE","$this",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","void",323],"(",["T_VARIABLE","$payment",323],")",";",["T_WHITESPACE","\n        ",323],"}",["T_WHITESPACE","\n    ",324],"}",["T_WHITESPACE","\n\n    ",325],["T_DOC_COMMENT","\/**\n     * Check whether can do payment review\n     *\n     * @param \\Magento\\Payment\\Model\\InfoInterface $payment\n     * @return bool\n     *\/",327],["T_WHITESPACE","\n    ",332],["T_PUBLIC","public",333],["T_WHITESPACE"," ",333],["T_FUNCTION","function",333],["T_WHITESPACE"," ",333],["T_STRING","canReviewPayment",333],"(",["T_NS_SEPARATOR","\\",333],["T_STRING","Magento",333],["T_NS_SEPARATOR","\\",333],["T_STRING","Payment",333],["T_NS_SEPARATOR","\\",333],["T_STRING","Model",333],["T_NS_SEPARATOR","\\",333],["T_STRING","InfoInterface",333],["T_WHITESPACE"," ",333],["T_VARIABLE","$payment",333],")",["T_WHITESPACE","\n    ",333],"{",["T_WHITESPACE","\n        ",334],["T_VARIABLE","$pendingReason",335],["T_WHITESPACE"," ",335],"=",["T_WHITESPACE"," ",335],["T_VARIABLE","$payment",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","getAdditionalInformation",335],"(",["T_NS_SEPARATOR","\\",335],["T_STRING","Magento",335],["T_NS_SEPARATOR","\\",335],["T_STRING","Paypal",335],["T_NS_SEPARATOR","\\",335],["T_STRING","Model",335],["T_NS_SEPARATOR","\\",335],["T_STRING","Info",335],["T_DOUBLE_COLON","::",335],["T_STRING","PENDING_REASON_GLOBAL",335],")",";",["T_WHITESPACE","\n        ",335],["T_RETURN","return",336],["T_WHITESPACE"," ",336],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","_isPaymentReviewRequired",336],"(",["T_WHITESPACE","\n            ",336],["T_VARIABLE","$payment",337],["T_WHITESPACE","\n        ",337],")",["T_WHITESPACE"," ",338],["T_BOOLEAN_AND","&&",338],["T_WHITESPACE"," ",338],["T_VARIABLE","$pendingReason",338],["T_WHITESPACE"," ",338],["T_IS_NOT_EQUAL","!=",338],["T_WHITESPACE"," ",338],["T_NS_SEPARATOR","\\",338],["T_STRING","Magento",338],["T_NS_SEPARATOR","\\",338],["T_STRING","Paypal",338],["T_NS_SEPARATOR","\\",338],["T_STRING","Model",338],["T_NS_SEPARATOR","\\",338],["T_STRING","Info",338],["T_DOUBLE_COLON","::",338],["T_STRING","PAYMENTSTATUS_REVIEW",338],";",["T_WHITESPACE","\n    ",338],"}",["T_WHITESPACE","\n\n    ",339],["T_DOC_COMMENT","\/**\n     * Check whether payment review is required\n     *\n     * @param \\Magento\\Payment\\Model\\InfoInterface $payment\n     * @return bool\n     *\/",341],["T_WHITESPACE","\n    ",346],["T_PROTECTED","protected",347],["T_WHITESPACE"," ",347],["T_FUNCTION","function",347],["T_WHITESPACE"," ",347],["T_STRING","_isPaymentReviewRequired",347],"(",["T_NS_SEPARATOR","\\",347],["T_STRING","Magento",347],["T_NS_SEPARATOR","\\",347],["T_STRING","Payment",347],["T_NS_SEPARATOR","\\",347],["T_STRING","Model",347],["T_NS_SEPARATOR","\\",347],["T_STRING","InfoInterface",347],["T_WHITESPACE"," ",347],["T_VARIABLE","$payment",347],")",["T_WHITESPACE","\n    ",347],"{",["T_WHITESPACE","\n        ",348],["T_RETURN","return",349],["T_WHITESPACE"," ",349],["T_STRING","Info",349],["T_DOUBLE_COLON","::",349],["T_STRING","isPaymentReviewRequired",349],"(",["T_VARIABLE","$payment",349],")",";",["T_WHITESPACE","\n    ",349],"}",["T_WHITESPACE","\n\n    ",350],["T_DOC_COMMENT","\/**\n     * Perform the payment review\n     *\n     * @param \\Magento\\Payment\\Model\\InfoInterface $payment\n     * @param string $action\n     * @return bool\n     *\/",352],["T_WHITESPACE","\n    ",358],["T_PUBLIC","public",359],["T_WHITESPACE"," ",359],["T_FUNCTION","function",359],["T_WHITESPACE"," ",359],["T_STRING","reviewPayment",359],"(",["T_NS_SEPARATOR","\\",359],["T_STRING","Magento",359],["T_NS_SEPARATOR","\\",359],["T_STRING","Payment",359],["T_NS_SEPARATOR","\\",359],["T_STRING","Model",359],["T_NS_SEPARATOR","\\",359],["T_STRING","InfoInterface",359],["T_WHITESPACE"," ",359],["T_VARIABLE","$payment",359],",",["T_WHITESPACE"," ",359],["T_VARIABLE","$action",359],")",["T_WHITESPACE","\n    ",359],"{",["T_WHITESPACE","\n        ",360],["T_VARIABLE","$api",361],["T_WHITESPACE"," ",361],"=",["T_WHITESPACE"," ",361],["T_VARIABLE","$this",361],["T_OBJECT_OPERATOR","->",361],["T_STRING","getApi",361],"(",")",["T_OBJECT_OPERATOR","->",361],["T_STRING","setTransactionId",361],"(",["T_VARIABLE","$payment",361],["T_OBJECT_OPERATOR","->",361],["T_STRING","getLastTransId",361],"(",")",")",";",["T_WHITESPACE","\n\n        ",361],["T_COMMENT","\/\/ check whether the review is still needed\n",363],["T_WHITESPACE","        ",364],["T_VARIABLE","$api",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","callGetTransactionDetails",364],"(",")",";",["T_WHITESPACE","\n        ",364],["T_VARIABLE","$this",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","importPaymentInfo",365],"(",["T_VARIABLE","$api",365],",",["T_WHITESPACE"," ",365],["T_VARIABLE","$payment",365],")",";",["T_WHITESPACE","\n        ",365],["T_IF","if",366],["T_WHITESPACE"," ",366],"(","!",["T_STRING","Info",366],["T_DOUBLE_COLON","::",366],["T_STRING","isPaymentReviewRequired",366],"(",["T_VARIABLE","$payment",366],")",")",["T_WHITESPACE"," ",366],"{",["T_WHITESPACE","\n            ",366],["T_RETURN","return",367],["T_WHITESPACE"," ",367],["T_STRING","false",367],";",["T_WHITESPACE","\n        ",367],"}",["T_WHITESPACE","\n\n        ",368],["T_COMMENT","\/\/ perform the review action\n",370],["T_WHITESPACE","        ",371],["T_VARIABLE","$api",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","setAction",371],"(",["T_VARIABLE","$action",371],")",["T_OBJECT_OPERATOR","->",371],["T_STRING","callManagePendingTransactionStatus",371],"(",")",";",["T_WHITESPACE","\n        ",371],["T_VARIABLE","$api",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","callGetTransactionDetails",372],"(",")",";",["T_WHITESPACE","\n        ",372],["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","importPaymentInfo",373],"(",["T_VARIABLE","$api",373],",",["T_WHITESPACE"," ",373],["T_VARIABLE","$payment",373],")",";",["T_WHITESPACE","\n        ",373],["T_RETURN","return",374],["T_WHITESPACE"," ",374],["T_STRING","true",374],";",["T_WHITESPACE","\n    ",374],"}",["T_WHITESPACE","\n\n    ",375],["T_DOC_COMMENT","\/**\n     * Fetch transaction details info\n     *\n     * @param \\Magento\\Payment\\Model\\InfoInterface $payment\n     * @param string $transactionId\n     * @return array\n     *\/",377],["T_WHITESPACE","\n    ",383],["T_PUBLIC","public",384],["T_WHITESPACE"," ",384],["T_FUNCTION","function",384],["T_WHITESPACE"," ",384],["T_STRING","fetchTransactionInfo",384],"(",["T_NS_SEPARATOR","\\",384],["T_STRING","Magento",384],["T_NS_SEPARATOR","\\",384],["T_STRING","Payment",384],["T_NS_SEPARATOR","\\",384],["T_STRING","Model",384],["T_NS_SEPARATOR","\\",384],["T_STRING","InfoInterface",384],["T_WHITESPACE"," ",384],["T_VARIABLE","$payment",384],",",["T_WHITESPACE"," ",384],["T_VARIABLE","$transactionId",384],")",["T_WHITESPACE","\n    ",384],"{",["T_WHITESPACE","\n        ",385],["T_VARIABLE","$api",386],["T_WHITESPACE"," ",386],"=",["T_WHITESPACE"," ",386],["T_VARIABLE","$this",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","getApi",386],"(",")",["T_OBJECT_OPERATOR","->",386],["T_STRING","setTransactionId",386],"(",["T_VARIABLE","$transactionId",386],")",["T_OBJECT_OPERATOR","->",386],["T_STRING","setRawResponseNeeded",386],"(",["T_STRING","true",386],")",";",["T_WHITESPACE","\n        ",386],["T_VARIABLE","$api",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","callGetTransactionDetails",387],"(",")",";",["T_WHITESPACE","\n        ",387],["T_VARIABLE","$this",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","importPaymentInfo",388],"(",["T_VARIABLE","$api",388],",",["T_WHITESPACE"," ",388],["T_VARIABLE","$payment",388],")",";",["T_WHITESPACE","\n        ",388],["T_VARIABLE","$data",389],["T_WHITESPACE"," ",389],"=",["T_WHITESPACE"," ",389],["T_VARIABLE","$api",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","getRawSuccessResponseData",389],"(",")",";",["T_WHITESPACE","\n        ",389],["T_RETURN","return",390],["T_WHITESPACE"," ",390],["T_VARIABLE","$data",390],["T_WHITESPACE"," ",390],"?",["T_WHITESPACE"," ",390],["T_VARIABLE","$data",390],["T_WHITESPACE"," ",390],":",["T_WHITESPACE"," ",390],"[","]",";",["T_WHITESPACE","\n    ",390],"}",["T_WHITESPACE","\n\n    ",391],["T_DOC_COMMENT","\/**\n     * Import capture results to payment\n     *\n     * @param \\Magento\\Paypal\\Model\\Api\\Nvp $api\n     * @param \\Magento\\Sales\\Model\\Order\\Payment $payment\n     * @return void\n     *\/",393],["T_WHITESPACE","\n    ",399],["T_PROTECTED","protected",400],["T_WHITESPACE"," ",400],["T_FUNCTION","function",400],["T_WHITESPACE"," ",400],["T_STRING","_importCaptureResultToPayment",400],"(",["T_VARIABLE","$api",400],",",["T_WHITESPACE"," ",400],["T_VARIABLE","$payment",400],")",["T_WHITESPACE","\n    ",400],"{",["T_WHITESPACE","\n        ",401],["T_VARIABLE","$payment",402],["T_OBJECT_OPERATOR","->",402],["T_STRING","setTransactionId",402],"(",["T_VARIABLE","$api",402],["T_OBJECT_OPERATOR","->",402],["T_STRING","getTransactionId",402],"(",")",")",["T_OBJECT_OPERATOR","->",402],["T_STRING","setIsTransactionClosed",402],"(",["T_STRING","false",402],")",";",["T_WHITESPACE","\n        ",402],["T_VARIABLE","$this",403],["T_OBJECT_OPERATOR","->",403],["T_STRING","importPaymentInfo",403],"(",["T_VARIABLE","$api",403],",",["T_WHITESPACE"," ",403],["T_VARIABLE","$payment",403],")",";",["T_WHITESPACE","\n    ",403],"}",["T_WHITESPACE","\n\n    ",404],["T_DOC_COMMENT","\/**\n     * Import refund results to payment\n     *\n     * @param \\Magento\\Paypal\\Model\\Api\\Nvp $api\n     * @param \\Magento\\Sales\\Model\\Order\\Payment $payment\n     * @param bool $canRefundMore\n     * @return void\n     *\/",406],["T_WHITESPACE","\n    ",413],["T_PROTECTED","protected",414],["T_WHITESPACE"," ",414],["T_FUNCTION","function",414],["T_WHITESPACE"," ",414],["T_STRING","_importRefundResultToPayment",414],"(",["T_VARIABLE","$api",414],",",["T_WHITESPACE"," ",414],["T_VARIABLE","$payment",414],",",["T_WHITESPACE"," ",414],["T_VARIABLE","$canRefundMore",414],")",["T_WHITESPACE","\n    ",414],"{",["T_WHITESPACE","\n        ",415],["T_VARIABLE","$payment",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","setTransactionId",416],"(",["T_WHITESPACE","\n            ",416],["T_VARIABLE","$api",417],["T_OBJECT_OPERATOR","->",417],["T_STRING","getRefundTransactionId",417],"(",")",["T_WHITESPACE","\n        ",417],")",["T_OBJECT_OPERATOR","->",418],["T_STRING","setIsTransactionClosed",418],"(",["T_WHITESPACE","\n            ",418],["T_LNUMBER","1",419],["T_WHITESPACE"," ",419],["T_COMMENT","\/\/ refund initiated by merchant\n",419],["T_WHITESPACE","        ",420],")",["T_OBJECT_OPERATOR","->",420],["T_STRING","setShouldCloseParentTransaction",420],"(",["T_WHITESPACE","\n            ",420],"!",["T_VARIABLE","$canRefundMore",421],["T_WHITESPACE","\n        ",421],")",";",["T_WHITESPACE","\n        ",422],["T_VARIABLE","$this",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","importPaymentInfo",423],"(",["T_VARIABLE","$api",423],",",["T_WHITESPACE"," ",423],["T_VARIABLE","$payment",423],")",";",["T_WHITESPACE","\n    ",423],"}",["T_WHITESPACE","\n\n    ",424],["T_DOC_COMMENT","\/**\n     * Parent transaction id getter\n     *\n     * @param \\Magento\\Framework\\DataObject $payment\n     * @return string\n     *\/",426],["T_WHITESPACE","\n    ",431],["T_PROTECTED","protected",432],["T_WHITESPACE"," ",432],["T_FUNCTION","function",432],["T_WHITESPACE"," ",432],["T_STRING","_getParentTransactionId",432],"(",["T_NS_SEPARATOR","\\",432],["T_STRING","Magento",432],["T_NS_SEPARATOR","\\",432],["T_STRING","Framework",432],["T_NS_SEPARATOR","\\",432],["T_STRING","DataObject",432],["T_WHITESPACE"," ",432],["T_VARIABLE","$payment",432],")",["T_WHITESPACE","\n    ",432],"{",["T_WHITESPACE","\n        ",433],["T_RETURN","return",434],["T_WHITESPACE"," ",434],["T_VARIABLE","$payment",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","getParentTransactionId",434],"(",")",";",["T_WHITESPACE","\n    ",434],"}",["T_WHITESPACE","\n",435],"}",["T_WHITESPACE","\n",436]]