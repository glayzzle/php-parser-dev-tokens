[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","UrlRewrite",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Storage",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","App",8],["T_NS_SEPARATOR","\\",8],["T_STRING","ResourceConnection",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","UrlRewrite",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Service",9],["T_NS_SEPARATOR","\\",9],["T_STRING","V1",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Data",9],["T_NS_SEPARATOR","\\",9],["T_STRING","UrlRewrite",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","UrlRewrite",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Service",10],["T_NS_SEPARATOR","\\",10],["T_STRING","V1",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Data",10],["T_NS_SEPARATOR","\\",10],["T_STRING","UrlRewriteFactory",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Framework",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Api",11],["T_NS_SEPARATOR","\\",11],["T_STRING","DataObjectHelper",11],";",["T_WHITESPACE","\n\n",11],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","DbStorage",13],["T_WHITESPACE"," ",13],["T_EXTENDS","extends",13],["T_WHITESPACE"," ",13],["T_STRING","AbstractStorage",13],["T_WHITESPACE","\n",13],"{",["T_WHITESPACE","\n    ",14],["T_DOC_COMMENT","\/**\n     * DB Storage table name\n     *\/",15],["T_WHITESPACE","\n    ",17],["T_CONST","const",18],["T_WHITESPACE"," ",18],["T_STRING","TABLE_NAME",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],["T_CONSTANT_ENCAPSED_STRING","'url_rewrite'",18],";",["T_WHITESPACE","\n\n    ",18],["T_DOC_COMMENT","\/**\n     * Code of \"Integrity constraint violation: 1062 Duplicate entry\" error\n     *\/",20],["T_WHITESPACE","\n    ",22],["T_CONST","const",23],["T_WHITESPACE"," ",23],["T_STRING","ERROR_CODE_DUPLICATE_ENTRY",23],["T_WHITESPACE"," ",23],"=",["T_WHITESPACE"," ",23],["T_LNUMBER","23000",23],";",["T_WHITESPACE","\n\n    ",23],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\DB\\Adapter\\AdapterInterface\n     *\/",25],["T_WHITESPACE","\n    ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$connection",28],";",["T_WHITESPACE","\n\n    ",28],["T_DOC_COMMENT","\/**\n     * @var Resource\n     *\/",30],["T_WHITESPACE","\n    ",32],["T_PROTECTED","protected",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$resource",33],";",["T_WHITESPACE","\n\n    ",33],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\UrlRewrite\\Service\\V1\\Data\\UrlRewriteFactory $urlRewriteFactory\n     * @param DataObjectHelper $dataObjectHelper\n     * @param \\Magento\\Framework\\App\\ResourceConnection $resource\n     *\/",35],["T_WHITESPACE","\n    ",39],["T_PUBLIC","public",40],["T_WHITESPACE"," ",40],["T_FUNCTION","function",40],["T_WHITESPACE"," ",40],["T_STRING","__construct",40],"(",["T_WHITESPACE","\n        ",40],["T_STRING","UrlRewriteFactory",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$urlRewriteFactory",41],",",["T_WHITESPACE","\n        ",41],["T_STRING","DataObjectHelper",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$dataObjectHelper",42],",",["T_WHITESPACE","\n        ",42],["T_STRING","ResourceConnection",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$resource",43],["T_WHITESPACE","\n    ",43],")",["T_WHITESPACE"," ",44],"{",["T_WHITESPACE","\n        ",44],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","connection",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_VARIABLE","$resource",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","getConnection",45],"(",")",";",["T_WHITESPACE","\n        ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","resource",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$resource",46],";",["T_WHITESPACE","\n\n        ",46],["T_STRING","parent",48],["T_DOUBLE_COLON","::",48],["T_STRING","__construct",48],"(",["T_VARIABLE","$urlRewriteFactory",48],",",["T_WHITESPACE"," ",48],["T_VARIABLE","$dataObjectHelper",48],")",";",["T_WHITESPACE","\n    ",48],"}",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Prepare select statement for specific filter\n     *\n     * @param array $data\n     * @return \\Magento\\Framework\\DB\\Select\n     *\/",51],["T_WHITESPACE","\n    ",56],["T_PROTECTED","protected",57],["T_WHITESPACE"," ",57],["T_FUNCTION","function",57],["T_WHITESPACE"," ",57],["T_STRING","prepareSelect",57],"(",["T_VARIABLE","$data",57],")",["T_WHITESPACE","\n    ",57],"{",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$select",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","connection",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","select",59],"(",")",";",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$select",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","from",60],"(",["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","resource",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","getTableName",60],"(",["T_STRING","self",60],["T_DOUBLE_COLON","::",60],["T_STRING","TABLE_NAME",60],")",")",";",["T_WHITESPACE","\n\n        ",60],["T_FOREACH","foreach",62],["T_WHITESPACE"," ",62],"(",["T_VARIABLE","$data",62],["T_WHITESPACE"," ",62],["T_AS","as",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$column",62],["T_WHITESPACE"," ",62],["T_DOUBLE_ARROW","=>",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$value",62],")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n            ",62],["T_VARIABLE","$select",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","where",63],"(",["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","connection",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","quoteIdentifier",63],"(",["T_VARIABLE","$column",63],")",["T_WHITESPACE"," ",63],".",["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","' IN (?)'",63],",",["T_WHITESPACE"," ",63],["T_VARIABLE","$value",63],")",";",["T_WHITESPACE","\n        ",63],"}",["T_WHITESPACE","\n        ",64],["T_RETURN","return",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$select",65],";",["T_WHITESPACE","\n    ",65],"}",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",68],["T_WHITESPACE","\n    ",70],["T_PROTECTED","protected",71],["T_WHITESPACE"," ",71],["T_FUNCTION","function",71],["T_WHITESPACE"," ",71],["T_STRING","doFindAllByData",71],"(",["T_VARIABLE","$data",71],")",["T_WHITESPACE","\n    ",71],"{",["T_WHITESPACE","\n        ",72],["T_RETURN","return",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","connection",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","fetchAll",73],"(",["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","prepareSelect",73],"(",["T_VARIABLE","$data",73],")",")",";",["T_WHITESPACE","\n    ",73],"}",["T_WHITESPACE","\n\n    ",74],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",76],["T_WHITESPACE","\n    ",78],["T_PROTECTED","protected",79],["T_WHITESPACE"," ",79],["T_FUNCTION","function",79],["T_WHITESPACE"," ",79],["T_STRING","doFindOneByData",79],"(",["T_VARIABLE","$data",79],")",["T_WHITESPACE","\n    ",79],"{",["T_WHITESPACE","\n        ",80],["T_RETURN","return",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","connection",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","fetchRow",81],"(",["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","prepareSelect",81],"(",["T_VARIABLE","$data",81],")",")",";",["T_WHITESPACE","\n    ",81],"}",["T_WHITESPACE","\n\n    ",82],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",84],["T_WHITESPACE","\n    ",86],["T_PROTECTED","protected",87],["T_WHITESPACE"," ",87],["T_FUNCTION","function",87],["T_WHITESPACE"," ",87],["T_STRING","doReplace",87],"(",["T_VARIABLE","$urls",87],")",["T_WHITESPACE","\n    ",87],"{",["T_WHITESPACE","\n        ",88],["T_FOREACH","foreach",89],["T_WHITESPACE"," ",89],"(",["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","createFilterDataBasedOnUrls",89],"(",["T_VARIABLE","$urls",89],")",["T_WHITESPACE"," ",89],["T_AS","as",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$type",89],["T_WHITESPACE"," ",89],["T_DOUBLE_ARROW","=>",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$urlData",89],")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n            ",89],["T_VARIABLE","$urlData",90],"[",["T_STRING","UrlRewrite",90],["T_DOUBLE_COLON","::",90],["T_STRING","ENTITY_TYPE",90],"]",["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$type",90],";",["T_WHITESPACE","\n            ",90],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","deleteByData",91],"(",["T_VARIABLE","$urlData",91],")",";",["T_WHITESPACE","\n        ",91],"}",["T_WHITESPACE","\n        ",92],["T_VARIABLE","$data",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],"[","]",";",["T_WHITESPACE","\n        ",93],["T_FOREACH","foreach",94],["T_WHITESPACE"," ",94],"(",["T_VARIABLE","$urls",94],["T_WHITESPACE"," ",94],["T_AS","as",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$url",94],")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n            ",94],["T_VARIABLE","$data",95],"[","]",["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$url",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","toArray",95],"(",")",";",["T_WHITESPACE","\n        ",95],"}",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","insertMultiple",97],"(",["T_VARIABLE","$data",97],")",";",["T_WHITESPACE","\n    ",97],"}",["T_WHITESPACE","\n\n    ",98],["T_DOC_COMMENT","\/**\n     * Insert multiple\n     *\n     * @param array $data\n     * @return void\n     * @throws \\Magento\\Framework\\Exception\\AlreadyExistsException\n     * @throws \\Exception\n     *\/",100],["T_WHITESPACE","\n    ",107],["T_PROTECTED","protected",108],["T_WHITESPACE"," ",108],["T_FUNCTION","function",108],["T_WHITESPACE"," ",108],["T_STRING","insertMultiple",108],"(",["T_VARIABLE","$data",108],")",["T_WHITESPACE","\n    ",108],"{",["T_WHITESPACE","\n        ",109],["T_TRY","try",110],["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n            ",110],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","connection",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","insertMultiple",111],"(",["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","resource",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","getTableName",111],"(",["T_STRING","self",111],["T_DOUBLE_COLON","::",111],["T_STRING","TABLE_NAME",111],")",",",["T_WHITESPACE"," ",111],["T_VARIABLE","$data",111],")",";",["T_WHITESPACE","\n        ",111],"}",["T_WHITESPACE"," ",112],["T_CATCH","catch",112],["T_WHITESPACE"," ",112],"(",["T_NS_SEPARATOR","\\",112],["T_STRING","Exception",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$e",112],")",["T_WHITESPACE"," ",112],"{",["T_WHITESPACE","\n            ",112],["T_IF","if",113],["T_WHITESPACE"," ",113],"(",["T_VARIABLE","$e",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","getCode",113],"(",")",["T_WHITESPACE"," ",113],["T_IS_IDENTICAL","===",113],["T_WHITESPACE"," ",113],["T_STRING","self",113],["T_DOUBLE_COLON","::",113],["T_STRING","ERROR_CODE_DUPLICATE_ENTRY",113],["T_WHITESPACE","\n                ",113],["T_BOOLEAN_AND","&&",114],["T_WHITESPACE"," ",114],["T_STRING","preg_match",114],"(",["T_CONSTANT_ENCAPSED_STRING","'#SQLSTATE\\[23000\\]: [^:]+: 1062[^\\d]#'",114],",",["T_WHITESPACE"," ",114],["T_VARIABLE","$e",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","getMessage",114],"(",")",")",["T_WHITESPACE","\n            ",114],")",["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n                ",115],["T_THROW","throw",116],["T_WHITESPACE"," ",116],["T_NEW","new",116],["T_WHITESPACE"," ",116],["T_NS_SEPARATOR","\\",116],["T_STRING","Magento",116],["T_NS_SEPARATOR","\\",116],["T_STRING","Framework",116],["T_NS_SEPARATOR","\\",116],["T_STRING","Exception",116],["T_NS_SEPARATOR","\\",116],["T_STRING","AlreadyExistsException",116],"(",["T_WHITESPACE","\n                    ",116],["T_STRING","__",117],"(",["T_CONSTANT_ENCAPSED_STRING","'URL key for specified store already exists.'",117],")",["T_WHITESPACE","\n                ",117],")",";",["T_WHITESPACE","\n            ",118],"}",["T_WHITESPACE","\n            ",119],["T_THROW","throw",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$e",120],";",["T_WHITESPACE","\n        ",120],"}",["T_WHITESPACE","\n    ",121],"}",["T_WHITESPACE","\n\n    ",122],["T_DOC_COMMENT","\/**\n     * Get filter for url rows deletion due to provided urls\n     *\n     * @param UrlRewrite[] $urls\n     * @return array\n     *\/",124],["T_WHITESPACE","\n    ",129],["T_PROTECTED","protected",130],["T_WHITESPACE"," ",130],["T_FUNCTION","function",130],["T_WHITESPACE"," ",130],["T_STRING","createFilterDataBasedOnUrls",130],"(",["T_VARIABLE","$urls",130],")",["T_WHITESPACE","\n    ",130],"{",["T_WHITESPACE","\n        ",131],["T_VARIABLE","$data",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],"[","]",";",["T_WHITESPACE","\n        ",132],["T_FOREACH","foreach",133],["T_WHITESPACE"," ",133],"(",["T_VARIABLE","$urls",133],["T_WHITESPACE"," ",133],["T_AS","as",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$url",133],")",["T_WHITESPACE"," ",133],"{",["T_WHITESPACE","\n            ",133],["T_VARIABLE","$entityType",134],["T_WHITESPACE"," ",134],"=",["T_WHITESPACE"," ",134],["T_VARIABLE","$url",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","getEntityType",134],"(",")",";",["T_WHITESPACE","\n            ",134],["T_FOREACH","foreach",135],["T_WHITESPACE"," ",135],"(","[",["T_STRING","UrlRewrite",135],["T_DOUBLE_COLON","::",135],["T_STRING","ENTITY_ID",135],",",["T_WHITESPACE"," ",135],["T_STRING","UrlRewrite",135],["T_DOUBLE_COLON","::",135],["T_STRING","STORE_ID",135],"]",["T_WHITESPACE"," ",135],["T_AS","as",135],["T_WHITESPACE"," ",135],["T_VARIABLE","$key",135],")",["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n                ",135],["T_VARIABLE","$fieldValue",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_VARIABLE","$url",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getByKey",136],"(",["T_VARIABLE","$key",136],")",";",["T_WHITESPACE","\n                ",136],["T_IF","if",137],["T_WHITESPACE"," ",137],"(","!",["T_ISSET","isset",137],"(",["T_VARIABLE","$data",137],"[",["T_VARIABLE","$entityType",137],"]","[",["T_VARIABLE","$key",137],"]",")",["T_WHITESPACE"," ",137],["T_BOOLEAN_OR","||",137],["T_WHITESPACE"," ",137],"!",["T_STRING","in_array",137],"(",["T_VARIABLE","$fieldValue",137],",",["T_WHITESPACE"," ",137],["T_VARIABLE","$data",137],"[",["T_VARIABLE","$entityType",137],"]","[",["T_VARIABLE","$key",137],"]",")",")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n                    ",137],["T_VARIABLE","$data",138],"[",["T_VARIABLE","$entityType",138],"]","[",["T_VARIABLE","$key",138],"]","[","]",["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_VARIABLE","$fieldValue",138],";",["T_WHITESPACE","\n                ",138],"}",["T_WHITESPACE","\n            ",139],"}",["T_WHITESPACE","\n        ",140],"}",["T_WHITESPACE","\n        ",141],["T_RETURN","return",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$data",142],";",["T_WHITESPACE","\n    ",142],"}",["T_WHITESPACE","\n\n    ",143],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",145],["T_WHITESPACE","\n    ",147],["T_PUBLIC","public",148],["T_WHITESPACE"," ",148],["T_FUNCTION","function",148],["T_WHITESPACE"," ",148],["T_STRING","deleteByData",148],"(",["T_ARRAY","array",148],["T_WHITESPACE"," ",148],["T_VARIABLE","$data",148],")",["T_WHITESPACE","\n    ",148],"{",["T_WHITESPACE","\n        ",149],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","connection",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","query",150],"(",["T_WHITESPACE","\n            ",150],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","prepareSelect",151],"(",["T_VARIABLE","$data",151],")",["T_OBJECT_OPERATOR","->",151],["T_STRING","deleteFromSelect",151],"(",["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","resource",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","getTableName",151],"(",["T_STRING","self",151],["T_DOUBLE_COLON","::",151],["T_STRING","TABLE_NAME",151],")",")",["T_WHITESPACE","\n        ",151],")",";",["T_WHITESPACE","\n    ",152],"}",["T_WHITESPACE","\n",153],"}",["T_WHITESPACE","\n",154]]