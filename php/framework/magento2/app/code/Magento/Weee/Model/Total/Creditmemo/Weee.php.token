[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Weee",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Model",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Total",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Creditmemo",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Sales",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Model",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Order",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Creditmemo",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Weee",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Helper",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Data",10],["T_WHITESPACE"," ",10],["T_AS","as",10],["T_WHITESPACE"," ",10],["T_STRING","WeeeHelper",10],";",["T_WHITESPACE","\n\n",10],["T_CLASS","class",12],["T_WHITESPACE"," ",12],["T_STRING","Weee",12],["T_WHITESPACE"," ",12],["T_EXTENDS","extends",12],["T_WHITESPACE"," ",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Sales",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Model",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Order",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Creditmemo",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Total",12],["T_NS_SEPARATOR","\\",12],["T_STRING","AbstractTotal",12],["T_WHITESPACE","\n",12],"{",["T_WHITESPACE","\n    ",13],["T_DOC_COMMENT","\/**\n     * Weee data\n     *\n     * @var \\Magento\\Weee\\Helper\\Data\n     *\/",14],["T_WHITESPACE","\n    ",18],["T_PROTECTED","protected",19],["T_WHITESPACE"," ",19],["T_VARIABLE","$_weeeData",19],["T_WHITESPACE"," ",19],"=",["T_WHITESPACE"," ",19],["T_STRING","null",19],";",["T_WHITESPACE","\n\n    ",19],["T_DOC_COMMENT","\/**\n     * Constructor\n     *\n     * By default is looking for first argument as array and assigns it as object\n     * attributes This behavior may change in child classes\n     *\n     * @param \\Magento\\Weee\\Helper\\Data $weeeData\n     * @param array                     $data\n     *\/",21],["T_WHITESPACE","\n    ",29],["T_PUBLIC","public",30],["T_WHITESPACE"," ",30],["T_FUNCTION","function",30],["T_WHITESPACE"," ",30],["T_STRING","__construct",30],"(",["T_NS_SEPARATOR","\\",30],["T_STRING","Magento",30],["T_NS_SEPARATOR","\\",30],["T_STRING","Weee",30],["T_NS_SEPARATOR","\\",30],["T_STRING","Helper",30],["T_NS_SEPARATOR","\\",30],["T_STRING","Data",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$weeeData",30],",",["T_WHITESPACE"," ",30],["T_ARRAY","array",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$data",30],["T_WHITESPACE"," ",30],"=",["T_WHITESPACE"," ",30],"[","]",")",["T_WHITESPACE","\n    ",30],"{",["T_WHITESPACE","\n        ",31],["T_VARIABLE","$this",32],["T_OBJECT_OPERATOR","->",32],["T_STRING","_weeeData",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_VARIABLE","$weeeData",32],";",["T_WHITESPACE","\n        ",32],["T_STRING","parent",33],["T_DOUBLE_COLON","::",33],["T_STRING","__construct",33],"(",["T_VARIABLE","$data",33],")",";",["T_WHITESPACE","\n    ",33],"}",["T_WHITESPACE","\n\n    ",34],["T_DOC_COMMENT","\/**\n     * Collect Weee amounts for the credit memo\n     *\n     * @param  Creditmemo $creditmemo\n     * @return $this\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     * @SuppressWarnings(PHPMD.NPathComplexity)\n     * @SuppressWarnings(PHPMD.ExcessiveMethodLength)\n     * @SuppressWarnings(PHPMD.UnusedLocalVariable)\n     *\/",36],["T_WHITESPACE","\n    ",45],["T_PUBLIC","public",46],["T_WHITESPACE"," ",46],["T_FUNCTION","function",46],["T_WHITESPACE"," ",46],["T_STRING","collect",46],"(",["T_STRING","Creditmemo",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$creditmemo",46],")",["T_WHITESPACE","\n    ",46],"{",["T_WHITESPACE","\n        ",47],["T_VARIABLE","$store",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$creditmemo",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","getStore",48],"(",")",";",["T_WHITESPACE","\n\n        ",48],["T_VARIABLE","$totalWeeeAmount",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_LNUMBER","0",50],";",["T_WHITESPACE","\n        ",50],["T_VARIABLE","$baseTotalWeeeAmount",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_LNUMBER","0",51],";",["T_WHITESPACE","\n        ",51],["T_VARIABLE","$totalWeeeAmountInclTax",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_LNUMBER","0",52],";",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$baseTotalWeeeAmountInclTax",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_LNUMBER","0",53],";",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$totalTaxAmount",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_LNUMBER","0",54],";",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$baseTotalTaxAmount",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_LNUMBER","0",55],";",["T_WHITESPACE","\n\n        ",55],["T_FOREACH","foreach",57],["T_WHITESPACE"," ",57],"(",["T_VARIABLE","$creditmemo",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","getAllItems",57],"(",")",["T_WHITESPACE"," ",57],["T_AS","as",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$item",57],")",["T_WHITESPACE"," ",57],"{",["T_WHITESPACE","\n            ",57],["T_VARIABLE","$orderItem",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$item",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","getOrderItem",58],"(",")",";",["T_WHITESPACE","\n            ",58],["T_VARIABLE","$orderItemQty",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$orderItem",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","getQtyOrdered",59],"(",")",";",["T_WHITESPACE","\n\n            ",59],["T_IF","if",61],["T_WHITESPACE"," ",61],"(","!",["T_VARIABLE","$orderItemQty",61],["T_WHITESPACE"," ",61],["T_BOOLEAN_OR","||",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$orderItem",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","isDummy",61],"(",")",["T_WHITESPACE"," ",61],["T_BOOLEAN_OR","||",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$item",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","getQty",61],"(",")",["T_WHITESPACE"," ",61],"<",["T_WHITESPACE"," ",61],["T_LNUMBER","0",61],")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n                ",61],["T_CONTINUE","continue",62],";",["T_WHITESPACE","\n            ",62],"}",["T_WHITESPACE","\n\n            ",63],["T_VARIABLE","$ratio",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$item",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getQty",65],"(",")",["T_WHITESPACE"," ",65],"\/",["T_WHITESPACE"," ",65],["T_VARIABLE","$orderItemQty",65],";",["T_WHITESPACE","\n\n            ",65],["T_VARIABLE","$orderItemWeeeAmountExclTax",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$orderItem",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getWeeeTaxAppliedRowAmount",67],"(",")",";",["T_WHITESPACE","\n            ",67],["T_VARIABLE","$orderItemBaseWeeeAmountExclTax",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$orderItem",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","getBaseWeeeTaxAppliedRowAmnt",68],"(",")",";",["T_WHITESPACE","\n            ",68],["T_VARIABLE","$weeeAmountExclTax",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_VARIABLE","$creditmemo",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","roundPrice",69],"(",["T_VARIABLE","$orderItemWeeeAmountExclTax",69],["T_WHITESPACE"," ",69],"*",["T_WHITESPACE"," ",69],["T_VARIABLE","$ratio",69],")",";",["T_WHITESPACE","\n            ",69],["T_VARIABLE","$baseWeeeAmountExclTax",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$creditmemo",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","roundPrice",70],"(",["T_VARIABLE","$orderItemBaseWeeeAmountExclTax",70],["T_WHITESPACE"," ",70],"*",["T_WHITESPACE"," ",70],["T_VARIABLE","$ratio",70],",",["T_WHITESPACE"," ",70],["T_CONSTANT_ENCAPSED_STRING","'base'",70],")",";",["T_WHITESPACE","\n\n            ",70],["T_VARIABLE","$orderItemWeeeAmountInclTax",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","_weeeData",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","getRowWeeeTaxInclTax",72],"(",["T_VARIABLE","$orderItem",72],")",";",["T_WHITESPACE","\n            ",72],["T_VARIABLE","$orderItemBaseWeeeAmountInclTax",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","_weeeData",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","getBaseRowWeeeTaxInclTax",73],"(",["T_VARIABLE","$orderItem",73],")",";",["T_WHITESPACE","\n            ",73],["T_VARIABLE","$weeeAmountInclTax",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$creditmemo",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","roundPrice",74],"(",["T_VARIABLE","$orderItemWeeeAmountInclTax",74],["T_WHITESPACE"," ",74],"*",["T_WHITESPACE"," ",74],["T_VARIABLE","$ratio",74],")",";",["T_WHITESPACE","\n            ",74],["T_VARIABLE","$baseWeeeAmountInclTax",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$creditmemo",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","roundPrice",75],"(",["T_VARIABLE","$orderItemBaseWeeeAmountInclTax",75],["T_WHITESPACE"," ",75],"*",["T_WHITESPACE"," ",75],["T_VARIABLE","$ratio",75],",",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'base'",75],")",";",["T_WHITESPACE","\n\n            ",75],["T_VARIABLE","$itemTaxAmount",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$weeeAmountInclTax",77],["T_WHITESPACE"," ",77],"-",["T_WHITESPACE"," ",77],["T_VARIABLE","$weeeAmountExclTax",77],";",["T_WHITESPACE","\n            ",77],["T_VARIABLE","$itemBaseTaxAmount",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$baseWeeeAmountInclTax",78],["T_WHITESPACE"," ",78],"-",["T_WHITESPACE"," ",78],["T_VARIABLE","$baseWeeeAmountExclTax",78],";",["T_WHITESPACE","\n\n            ",78],["T_VARIABLE","$weeeAmountAvailable",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","_weeeData",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getWeeeAmountInvoiced",80],"(",["T_VARIABLE","$orderItem",80],")",["T_WHITESPACE"," ",80],"-",["T_WHITESPACE","\n                ",80],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","_weeeData",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getWeeeAmountRefunded",81],"(",["T_VARIABLE","$orderItem",81],")",";",["T_WHITESPACE","\n            ",81],["T_VARIABLE","$baseWeeeAmountAvailable",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","_weeeData",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","getBaseWeeeAmountInvoiced",82],"(",["T_VARIABLE","$orderItem",82],")",["T_WHITESPACE"," ",82],"-",["T_WHITESPACE","\n                ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","_weeeData",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","getBaseWeeeAmountRefunded",83],"(",["T_VARIABLE","$orderItem",83],")",";",["T_WHITESPACE","\n            ",83],["T_VARIABLE","$weeeTaxAmountAvailable",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","_weeeData",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getWeeeTaxAmountInvoiced",84],"(",["T_VARIABLE","$orderItem",84],")",["T_WHITESPACE"," ",84],"-",["T_WHITESPACE","\n                ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","_weeeData",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","getWeeeTaxAmountRefunded",85],"(",["T_VARIABLE","$orderItem",85],")",";",["T_WHITESPACE","\n            ",85],["T_VARIABLE","$baseWeeeTaxAmountAvailable",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","_weeeData",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getBaseWeeeTaxAmountInvoiced",86],"(",["T_VARIABLE","$orderItem",86],")",["T_WHITESPACE"," ",86],"-",["T_WHITESPACE","\n                ",86],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","_weeeData",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getBaseWeeeTaxAmountRefunded",87],"(",["T_VARIABLE","$orderItem",87],")",";",["T_WHITESPACE","\n\n            ",87],["T_IF","if",89],["T_WHITESPACE"," ",89],"(",["T_VARIABLE","$item",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","isLast",89],"(",")",")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n                ",89],["T_VARIABLE","$weeeAmountExclTax",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$weeeAmountAvailable",90],";",["T_WHITESPACE","\n                ",90],["T_VARIABLE","$baseWeeeAmountExclTax",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_VARIABLE","$baseWeeeAmountAvailable",91],";",["T_WHITESPACE","\n                ",91],["T_VARIABLE","$itemTaxAmount",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$weeeTaxAmountAvailable",92],";",["T_WHITESPACE","\n                ",92],["T_VARIABLE","$itemBaseTaxAmount",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$baseWeeeTaxAmountAvailable",93],";",["T_WHITESPACE","\n            ",93],"}",["T_WHITESPACE"," ",94],["T_ELSE","else",94],["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n                ",94],["T_VARIABLE","$weeeAmountExclTax",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_STRING","min",95],"(",["T_VARIABLE","$weeeAmountExclTax",95],",",["T_WHITESPACE"," ",95],["T_VARIABLE","$weeeAmountAvailable",95],")",";",["T_WHITESPACE","\n                ",95],["T_VARIABLE","$baseWeeeAmountExclTax",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_STRING","min",96],"(",["T_VARIABLE","$baseWeeeAmountExclTax",96],",",["T_WHITESPACE"," ",96],["T_VARIABLE","$baseWeeeAmountAvailable",96],")",";",["T_WHITESPACE","\n                ",96],["T_VARIABLE","$itemTaxAmount",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_STRING","min",97],"(",["T_VARIABLE","$itemTaxAmount",97],",",["T_WHITESPACE"," ",97],["T_VARIABLE","$weeeTaxAmountAvailable",97],")",";",["T_WHITESPACE","\n                ",97],["T_VARIABLE","$itemBaseTaxAmount",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_STRING","min",98],"(",["T_VARIABLE","$itemBaseTaxAmount",98],",",["T_WHITESPACE"," ",98],["T_VARIABLE","$baseWeeeTaxAmountAvailable",98],")",";",["T_WHITESPACE","\n            ",98],"}",["T_WHITESPACE","\n\n            ",99],["T_VARIABLE","$totalWeeeAmount",101],["T_WHITESPACE"," ",101],["T_PLUS_EQUAL","+=",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$weeeAmountExclTax",101],";",["T_WHITESPACE","\n            ",101],["T_VARIABLE","$baseTotalWeeeAmount",102],["T_WHITESPACE"," ",102],["T_PLUS_EQUAL","+=",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$baseWeeeAmountExclTax",102],";",["T_WHITESPACE","\n\n            ",102],["T_VARIABLE","$item",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","setWeeeTaxAppliedRowAmount",104],"(",["T_VARIABLE","$weeeAmountExclTax",104],")",";",["T_WHITESPACE","\n            ",104],["T_VARIABLE","$item",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","setBaseWeeeTaxAppliedRowAmount",105],"(",["T_VARIABLE","$baseWeeeAmountExclTax",105],")",";",["T_WHITESPACE","\n\n            ",105],["T_VARIABLE","$totalTaxAmount",107],["T_WHITESPACE"," ",107],["T_PLUS_EQUAL","+=",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$itemTaxAmount",107],";",["T_WHITESPACE","\n            ",107],["T_VARIABLE","$baseTotalTaxAmount",108],["T_WHITESPACE"," ",108],["T_PLUS_EQUAL","+=",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$itemBaseTaxAmount",108],";",["T_WHITESPACE","\n\n            ",108],["T_COMMENT","\/\/Set the ratio of the tax amount in invoice item compared to tax amount in order item\n",110],["T_WHITESPACE","            ",111],["T_COMMENT","\/\/This information is needed to calculate tax per tax rate later\n",111],["T_WHITESPACE","            ",112],["T_VARIABLE","$orderItemTaxAmount",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$orderItemWeeeAmountInclTax",112],["T_WHITESPACE"," ",112],"-",["T_WHITESPACE"," ",112],["T_VARIABLE","$orderItemWeeeAmountExclTax",112],";",["T_WHITESPACE","\n            ",112],["T_IF","if",113],["T_WHITESPACE"," ",113],"(",["T_VARIABLE","$orderItemTaxAmount",113],["T_WHITESPACE"," ",113],["T_IS_NOT_EQUAL","!=",113],["T_WHITESPACE"," ",113],["T_LNUMBER","0",113],")",["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n                ",113],["T_VARIABLE","$taxRatio",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],"[","]",";",["T_WHITESPACE","\n                ",114],["T_IF","if",115],["T_WHITESPACE"," ",115],"(",["T_VARIABLE","$item",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","getTaxRatio",115],"(",")",")",["T_WHITESPACE"," ",115],"{",["T_WHITESPACE","\n                    ",115],["T_VARIABLE","$taxRatio",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_STRING","unserialize",116],"(",["T_VARIABLE","$item",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","getTaxRatio",116],"(",")",")",";",["T_WHITESPACE","\n                ",116],"}",["T_WHITESPACE","\n                ",117],["T_VARIABLE","$taxRatio",118],"[",["T_NS_SEPARATOR","\\",118],["T_STRING","Magento",118],["T_NS_SEPARATOR","\\",118],["T_STRING","Weee",118],["T_NS_SEPARATOR","\\",118],["T_STRING","Model",118],["T_NS_SEPARATOR","\\",118],["T_STRING","Total",118],["T_NS_SEPARATOR","\\",118],["T_STRING","Quote",118],["T_NS_SEPARATOR","\\",118],["T_STRING","Weee",118],["T_DOUBLE_COLON","::",118],["T_STRING","ITEM_TYPE",118],"]",["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$itemTaxAmount",118],["T_WHITESPACE"," ",118],"\/",["T_WHITESPACE"," ",118],["T_VARIABLE","$orderItemTaxAmount",118],";",["T_WHITESPACE","\n                ",118],["T_VARIABLE","$item",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","setTaxRatio",119],"(",["T_STRING","serialize",119],"(",["T_VARIABLE","$taxRatio",119],")",")",";",["T_WHITESPACE","\n            ",119],"}",["T_WHITESPACE","\n\n            ",120],["T_VARIABLE","$totalWeeeAmountInclTax",122],["T_WHITESPACE"," ",122],["T_PLUS_EQUAL","+=",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$weeeAmountInclTax",122],";",["T_WHITESPACE","\n            ",122],["T_VARIABLE","$baseTotalWeeeAmountInclTax",123],["T_WHITESPACE"," ",123],["T_PLUS_EQUAL","+=",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$baseWeeeAmountInclTax",123],";",["T_WHITESPACE","\n\n            ",123],["T_VARIABLE","$newApplied",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],"[","]",";",["T_WHITESPACE","\n            ",125],["T_VARIABLE","$applied",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","_weeeData",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getApplied",126],"(",["T_VARIABLE","$orderItem",126],")",";",["T_WHITESPACE","\n            ",126],["T_FOREACH","foreach",127],["T_WHITESPACE"," ",127],"(",["T_VARIABLE","$applied",127],["T_WHITESPACE"," ",127],["T_AS","as",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$one",127],")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n                ",127],["T_VARIABLE","$title",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_STRING_CAST","(string)",128],["T_VARIABLE","$one",128],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",128],"]",";",["T_WHITESPACE","\n                ",128],["T_VARIABLE","$one",129],"[",["T_CONSTANT_ENCAPSED_STRING","'base_row_amount'",129],"]",["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_VARIABLE","$creditmemo",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","roundPrice",129],"(",["T_VARIABLE","$one",129],"[",["T_CONSTANT_ENCAPSED_STRING","'base_row_amount'",129],"]",["T_WHITESPACE"," ",129],"*",["T_WHITESPACE"," ",129],["T_VARIABLE","$ratio",129],",",["T_WHITESPACE"," ",129],["T_VARIABLE","$title",129],".",["T_CONSTANT_ENCAPSED_STRING","'_base'",129],")",";",["T_WHITESPACE","\n                ",129],["T_VARIABLE","$one",130],"[",["T_CONSTANT_ENCAPSED_STRING","'row_amount'",130],"]",["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$creditmemo",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","roundPrice",130],"(",["T_VARIABLE","$one",130],"[",["T_CONSTANT_ENCAPSED_STRING","'row_amount'",130],"]",["T_WHITESPACE"," ",130],"*",["T_WHITESPACE"," ",130],["T_VARIABLE","$ratio",130],",",["T_WHITESPACE"," ",130],["T_VARIABLE","$title",130],")",";",["T_WHITESPACE","\n                ",130],["T_VARIABLE","$one",131],"[",["T_CONSTANT_ENCAPSED_STRING","'base_row_amount_incl_tax'",131],"]",["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_VARIABLE","$creditmemo",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","roundPrice",131],"(",["T_WHITESPACE","\n                    ",131],["T_VARIABLE","$one",132],"[",["T_CONSTANT_ENCAPSED_STRING","'base_row_amount_incl_tax'",132],"]",["T_WHITESPACE"," ",132],"*",["T_WHITESPACE"," ",132],["T_VARIABLE","$ratio",132],",",["T_WHITESPACE","\n                    ",132],["T_VARIABLE","$title",133],".",["T_CONSTANT_ENCAPSED_STRING","'_base'",133],["T_WHITESPACE","\n                ",133],")",";",["T_WHITESPACE","\n                ",134],["T_VARIABLE","$one",135],"[",["T_CONSTANT_ENCAPSED_STRING","'row_amount_incl_tax'",135],"]",["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_VARIABLE","$creditmemo",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","roundPrice",135],"(",["T_VARIABLE","$one",135],"[",["T_CONSTANT_ENCAPSED_STRING","'row_amount_incl_tax'",135],"]",["T_WHITESPACE"," ",135],"*",["T_WHITESPACE"," ",135],["T_VARIABLE","$ratio",135],",",["T_WHITESPACE"," ",135],["T_VARIABLE","$title",135],")",";",["T_WHITESPACE","\n\n                ",135],["T_VARIABLE","$newApplied",137],"[","]",["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_VARIABLE","$one",137],";",["T_WHITESPACE","\n            ",137],"}",["T_WHITESPACE","\n            ",138],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","_weeeData",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","setApplied",139],"(",["T_VARIABLE","$item",139],",",["T_WHITESPACE"," ",139],["T_VARIABLE","$newApplied",139],")",";",["T_WHITESPACE","\n\n            ",139],["T_COMMENT","\/\/ Update order item\n",141],["T_WHITESPACE","            ",142],["T_VARIABLE","$newApplied",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],"[","]",";",["T_WHITESPACE","\n            ",142],["T_VARIABLE","$applied",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","_weeeData",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getApplied",143],"(",["T_VARIABLE","$orderItem",143],")",";",["T_WHITESPACE","\n            ",143],["T_FOREACH","foreach",144],["T_WHITESPACE"," ",144],"(",["T_VARIABLE","$applied",144],["T_WHITESPACE"," ",144],["T_AS","as",144],["T_WHITESPACE"," ",144],["T_VARIABLE","$one",144],")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n                ",144],["T_IF","if",145],["T_WHITESPACE"," ",145],"(",["T_ISSET","isset",145],"(",["T_VARIABLE","$one",145],"[",["T_STRING","WeeeHelper",145],["T_DOUBLE_COLON","::",145],["T_STRING","KEY_BASE_WEEE_AMOUNT_REFUNDED",145],"]",")",")",["T_WHITESPACE"," ",145],"{",["T_WHITESPACE","\n                    ",145],["T_VARIABLE","$one",146],"[",["T_STRING","WeeeHelper",146],["T_DOUBLE_COLON","::",146],["T_STRING","KEY_BASE_WEEE_AMOUNT_REFUNDED",146],"]",["T_WHITESPACE"," ",146],"=",["T_WHITESPACE","\n                        ",146],["T_VARIABLE","$one",147],"[",["T_STRING","WeeeHelper",147],["T_DOUBLE_COLON","::",147],["T_STRING","KEY_BASE_WEEE_AMOUNT_REFUNDED",147],"]",["T_WHITESPACE"," ",147],"+",["T_WHITESPACE"," ",147],["T_VARIABLE","$baseWeeeAmountExclTax",147],";",["T_WHITESPACE","\n                ",147],"}",["T_WHITESPACE"," ",148],["T_ELSE","else",148],["T_WHITESPACE"," ",148],"{",["T_WHITESPACE","\n                    ",148],["T_VARIABLE","$one",149],"[",["T_STRING","WeeeHelper",149],["T_DOUBLE_COLON","::",149],["T_STRING","KEY_BASE_WEEE_AMOUNT_REFUNDED",149],"]",["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_VARIABLE","$baseWeeeAmountExclTax",149],";",["T_WHITESPACE","\n                ",149],"}",["T_WHITESPACE","\n                ",150],["T_IF","if",151],["T_WHITESPACE"," ",151],"(",["T_ISSET","isset",151],"(",["T_VARIABLE","$one",151],"[",["T_STRING","WeeeHelper",151],["T_DOUBLE_COLON","::",151],["T_STRING","KEY_WEEE_AMOUNT_REFUNDED",151],"]",")",")",["T_WHITESPACE"," ",151],"{",["T_WHITESPACE","\n                    ",151],["T_VARIABLE","$one",152],"[",["T_STRING","WeeeHelper",152],["T_DOUBLE_COLON","::",152],["T_STRING","KEY_WEEE_AMOUNT_REFUNDED",152],"]",["T_WHITESPACE"," ",152],"=",["T_WHITESPACE","\n                        ",152],["T_VARIABLE","$one",153],"[",["T_STRING","WeeeHelper",153],["T_DOUBLE_COLON","::",153],["T_STRING","KEY_WEEE_AMOUNT_REFUNDED",153],"]",["T_WHITESPACE"," ",153],"+",["T_WHITESPACE"," ",153],["T_VARIABLE","$weeeAmountExclTax",153],";",["T_WHITESPACE","\n                ",153],"}",["T_WHITESPACE"," ",154],["T_ELSE","else",154],["T_WHITESPACE"," ",154],"{",["T_WHITESPACE","\n                    ",154],["T_VARIABLE","$one",155],"[",["T_STRING","WeeeHelper",155],["T_DOUBLE_COLON","::",155],["T_STRING","KEY_WEEE_AMOUNT_REFUNDED",155],"]",["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_VARIABLE","$weeeAmountExclTax",155],";",["T_WHITESPACE","\n                ",155],"}",["T_WHITESPACE","\n                ",156],["T_IF","if",157],["T_WHITESPACE"," ",157],"(",["T_ISSET","isset",157],"(",["T_VARIABLE","$one",157],"[",["T_STRING","WeeeHelper",157],["T_DOUBLE_COLON","::",157],["T_STRING","KEY_BASE_WEEE_TAX_AMOUNT_REFUNDED",157],"]",")",")",["T_WHITESPACE"," ",157],"{",["T_WHITESPACE","\n                    ",157],["T_VARIABLE","$one",158],"[",["T_STRING","WeeeHelper",158],["T_DOUBLE_COLON","::",158],["T_STRING","KEY_BASE_WEEE_TAX_AMOUNT_REFUNDED",158],"]",["T_WHITESPACE"," ",158],"=",["T_WHITESPACE","\n                        ",158],["T_VARIABLE","$one",159],"[",["T_STRING","WeeeHelper",159],["T_DOUBLE_COLON","::",159],["T_STRING","KEY_BASE_WEEE_TAX_AMOUNT_REFUNDED",159],"]",["T_WHITESPACE"," ",159],"+",["T_WHITESPACE"," ",159],["T_VARIABLE","$itemBaseTaxAmount",159],";",["T_WHITESPACE","\n                ",159],"}",["T_WHITESPACE"," ",160],["T_ELSE","else",160],["T_WHITESPACE"," ",160],"{",["T_WHITESPACE","\n                    ",160],["T_VARIABLE","$one",161],"[",["T_STRING","WeeeHelper",161],["T_DOUBLE_COLON","::",161],["T_STRING","KEY_BASE_WEEE_TAX_AMOUNT_REFUNDED",161],"]",["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_VARIABLE","$itemBaseTaxAmount",161],";",["T_WHITESPACE","\n                ",161],"}",["T_WHITESPACE","\n                ",162],["T_IF","if",163],["T_WHITESPACE"," ",163],"(",["T_ISSET","isset",163],"(",["T_VARIABLE","$one",163],"[",["T_STRING","WeeeHelper",163],["T_DOUBLE_COLON","::",163],["T_STRING","KEY_WEEE_TAX_AMOUNT_REFUNDED",163],"]",")",")",["T_WHITESPACE"," ",163],"{",["T_WHITESPACE","\n                    ",163],["T_VARIABLE","$one",164],"[",["T_STRING","WeeeHelper",164],["T_DOUBLE_COLON","::",164],["T_STRING","KEY_WEEE_TAX_AMOUNT_REFUNDED",164],"]",["T_WHITESPACE"," ",164],"=",["T_WHITESPACE","\n                        ",164],["T_VARIABLE","$one",165],"[",["T_STRING","WeeeHelper",165],["T_DOUBLE_COLON","::",165],["T_STRING","KEY_WEEE_TAX_AMOUNT_REFUNDED",165],"]",["T_WHITESPACE"," ",165],"+",["T_WHITESPACE"," ",165],["T_VARIABLE","$itemTaxAmount",165],";",["T_WHITESPACE","\n                ",165],"}",["T_WHITESPACE"," ",166],["T_ELSE","else",166],["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n                    ",166],["T_VARIABLE","$one",167],"[",["T_STRING","WeeeHelper",167],["T_DOUBLE_COLON","::",167],["T_STRING","KEY_WEEE_TAX_AMOUNT_REFUNDED",167],"]",["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_VARIABLE","$itemTaxAmount",167],";",["T_WHITESPACE","\n                ",167],"}",["T_WHITESPACE","\n\n                ",168],["T_VARIABLE","$newApplied",170],"[","]",["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_VARIABLE","$one",170],";",["T_WHITESPACE","\n            ",170],"}",["T_WHITESPACE","\n            ",171],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","_weeeData",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","setApplied",172],"(",["T_VARIABLE","$orderItem",172],",",["T_WHITESPACE"," ",172],["T_VARIABLE","$newApplied",172],")",";",["T_WHITESPACE","\n\n            ",172],["T_VARIABLE","$item",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","setWeeeTaxRowDisposition",174],"(",["T_VARIABLE","$item",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","getWeeeTaxDisposition",174],"(",")",["T_WHITESPACE"," ",174],"*",["T_WHITESPACE"," ",174],["T_VARIABLE","$item",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","getQty",174],"(",")",")",";",["T_WHITESPACE","\n            ",174],["T_VARIABLE","$item",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","setBaseWeeeTaxRowDisposition",175],"(",["T_VARIABLE","$item",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","getBaseWeeeTaxDisposition",175],"(",")",["T_WHITESPACE"," ",175],"*",["T_WHITESPACE"," ",175],["T_VARIABLE","$item",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","getQty",175],"(",")",")",";",["T_WHITESPACE","\n        ",175],"}",["T_WHITESPACE","\n\n        ",176],["T_IF","if",178],["T_WHITESPACE"," ",178],"(",["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","_weeeData",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","includeInSubtotal",178],"(",["T_VARIABLE","$store",178],")",")",["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n            ",178],["T_VARIABLE","$creditmemo",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","setSubtotal",179],"(",["T_VARIABLE","$creditmemo",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","getSubtotal",179],"(",")",["T_WHITESPACE"," ",179],"+",["T_WHITESPACE"," ",179],["T_VARIABLE","$totalWeeeAmount",179],")",";",["T_WHITESPACE","\n            ",179],["T_VARIABLE","$creditmemo",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","setBaseSubtotal",180],"(",["T_VARIABLE","$creditmemo",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","getBaseSubtotal",180],"(",")",["T_WHITESPACE"," ",180],"+",["T_WHITESPACE"," ",180],["T_VARIABLE","$baseTotalWeeeAmount",180],")",";",["T_WHITESPACE","\n        ",180],"}",["T_WHITESPACE","\n\n        ",181],["T_VARIABLE","$creditmemo",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","setTaxAmount",183],"(",["T_VARIABLE","$creditmemo",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","getTaxAmount",183],"(",")",["T_WHITESPACE"," ",183],"+",["T_WHITESPACE"," ",183],["T_VARIABLE","$totalTaxAmount",183],")",";",["T_WHITESPACE","\n        ",183],["T_VARIABLE","$creditmemo",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","setBaseTaxAmount",184],"(",["T_VARIABLE","$creditmemo",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getBaseTaxAmount",184],"(",")",["T_WHITESPACE"," ",184],"+",["T_WHITESPACE"," ",184],["T_VARIABLE","$baseTotalTaxAmount",184],")",";",["T_WHITESPACE","\n\n        ",184],["T_VARIABLE","$creditmemo",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","setSubtotalInclTax",186],"(",["T_WHITESPACE","\n            ",186],["T_VARIABLE","$creditmemo",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","getSubtotalInclTax",187],"(",")",["T_WHITESPACE"," ",187],"+",["T_WHITESPACE"," ",187],["T_VARIABLE","$totalWeeeAmountInclTax",187],["T_WHITESPACE","\n        ",187],")",";",["T_WHITESPACE","\n        ",188],["T_VARIABLE","$creditmemo",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","setBaseSubtotalInclTax",189],"(",["T_WHITESPACE","\n            ",189],["T_VARIABLE","$creditmemo",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","getBaseSubtotalInclTax",190],"(",")",["T_WHITESPACE"," ",190],"+",["T_WHITESPACE"," ",190],["T_VARIABLE","$baseTotalWeeeAmountInclTax",190],["T_WHITESPACE","\n        ",190],")",";",["T_WHITESPACE","\n\n        ",191],["T_VARIABLE","$creditmemo",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","setGrandTotal",193],"(",["T_VARIABLE","$creditmemo",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","getGrandTotal",193],"(",")",["T_WHITESPACE"," ",193],"+",["T_WHITESPACE"," ",193],["T_VARIABLE","$totalWeeeAmount",193],["T_WHITESPACE"," ",193],"+",["T_WHITESPACE"," ",193],["T_VARIABLE","$totalTaxAmount",193],")",";",["T_WHITESPACE","\n        ",193],["T_VARIABLE","$creditmemo",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","setBaseGrandTotal",194],"(",["T_VARIABLE","$creditmemo",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","getBaseGrandTotal",194],"(",")",["T_WHITESPACE"," ",194],"+",["T_WHITESPACE"," ",194],["T_VARIABLE","$baseTotalWeeeAmount",194],["T_WHITESPACE"," ",194],"+",["T_WHITESPACE"," ",194],["T_VARIABLE","$baseTotalTaxAmount",194],")",";",["T_WHITESPACE","\n\n        ",194],["T_RETURN","return",196],["T_WHITESPACE"," ",196],["T_VARIABLE","$this",196],";",["T_WHITESPACE","\n    ",196],"}",["T_WHITESPACE","\n",197],"}",["T_WHITESPACE","\n",198]]