[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Weee",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Observer",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Event",8],["T_NS_SEPARATOR","\\",8],["T_STRING","ObserverInterface",8],";",["T_WHITESPACE","\n\n",8],["T_CLASS","class",10],["T_WHITESPACE"," ",10],["T_STRING","UpdateProductOptionsObserver",10],["T_WHITESPACE"," ",10],["T_IMPLEMENTS","implements",10],["T_WHITESPACE"," ",10],["T_STRING","ObserverInterface",10],["T_WHITESPACE","\n",10],"{",["T_WHITESPACE","\n    ",11],["T_DOC_COMMENT","\/**\n     * Weee data\n     *\n     * @var \\Magento\\Weee\\Helper\\Data\n     *\/",12],["T_WHITESPACE","\n    ",16],["T_PROTECTED","protected",17],["T_WHITESPACE"," ",17],["T_VARIABLE","$weeeData",17],["T_WHITESPACE"," ",17],"=",["T_WHITESPACE"," ",17],["T_STRING","null",17],";",["T_WHITESPACE","\n\n    ",17],["T_DOC_COMMENT","\/** @var \\Magento\\Framework\\Registry *\/",19],["T_WHITESPACE","\n    ",19],["T_PROTECTED","protected",20],["T_WHITESPACE"," ",20],["T_VARIABLE","$registry",20],";",["T_WHITESPACE","\n\n    ",20],["T_DOC_COMMENT","\/**\n     * Tax data\n     *\n     * @var \\Magento\\Tax\\Helper\\Data\n     *\/",22],["T_WHITESPACE","\n    ",26],["T_PROTECTED","protected",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$taxData",27],";",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\Registry $registry\n     * @param \\Magento\\Weee\\Helper\\Data $weeeData\n     * @param \\Magento\\Tax\\Helper\\Data $taxData\n     *\/",29],["T_WHITESPACE","\n    ",33],["T_PUBLIC","public",34],["T_WHITESPACE"," ",34],["T_FUNCTION","function",34],["T_WHITESPACE"," ",34],["T_STRING","__construct",34],"(",["T_WHITESPACE","\n        ",34],["T_NS_SEPARATOR","\\",35],["T_STRING","Magento",35],["T_NS_SEPARATOR","\\",35],["T_STRING","Framework",35],["T_NS_SEPARATOR","\\",35],["T_STRING","Registry",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$registry",35],",",["T_WHITESPACE","\n        ",35],["T_NS_SEPARATOR","\\",36],["T_STRING","Magento",36],["T_NS_SEPARATOR","\\",36],["T_STRING","Weee",36],["T_NS_SEPARATOR","\\",36],["T_STRING","Helper",36],["T_NS_SEPARATOR","\\",36],["T_STRING","Data",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$weeeData",36],",",["T_WHITESPACE","\n        ",36],["T_NS_SEPARATOR","\\",37],["T_STRING","Magento",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Tax",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Helper",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Data",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$taxData",37],["T_WHITESPACE","\n    ",37],")",["T_WHITESPACE"," ",38],"{",["T_WHITESPACE","\n        ",38],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","weeeData",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_VARIABLE","$weeeData",39],";",["T_WHITESPACE","\n        ",39],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","registry",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$registry",40],";",["T_WHITESPACE","\n        ",40],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","taxData",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$taxData",41],";",["T_WHITESPACE","\n    ",41],"}",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Change default JavaScript templates for options rendering\n     *\n     * @param \\Magento\\Framework\\Event\\Observer $observer\n     * @return $this\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     *\/",44],["T_WHITESPACE","\n    ",50],["T_PUBLIC","public",51],["T_WHITESPACE"," ",51],["T_FUNCTION","function",51],["T_WHITESPACE"," ",51],["T_STRING","execute",51],"(",["T_NS_SEPARATOR","\\",51],["T_STRING","Magento",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Framework",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Event",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Observer",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$observer",51],")",["T_WHITESPACE","\n    ",51],"{",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$response",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$observer",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","getEvent",53],"(",")",["T_OBJECT_OPERATOR","->",53],["T_STRING","getResponseObject",53],"(",")",";",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$options",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$response",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","getAdditionalOptions",54],"(",")",";",["T_WHITESPACE","\n\n        ",54],["T_DOC_COMMENT","\/** @var \\Magento\\Catalog\\Model\\Product $product *\/",56],["T_WHITESPACE","\n        ",56],["T_VARIABLE","$product",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","registry",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","registry",57],"(",["T_CONSTANT_ENCAPSED_STRING","'current_product'",57],")",";",["T_WHITESPACE","\n        ",57],["T_IF","if",58],["T_WHITESPACE"," ",58],"(","!",["T_VARIABLE","$product",58],")",["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n            ",58],["T_RETURN","return",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$this",59],";",["T_WHITESPACE","\n        ",59],"}",["T_WHITESPACE","\n\n        ",60],["T_COMMENT","\/\/ if the Weee module is enabled, then only do processing on bundle products\n",62],["T_WHITESPACE","        ",63],["T_IF","if",63],["T_WHITESPACE"," ",63],"(",["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","weeeData",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","isEnabled",63],"(",")",["T_WHITESPACE"," ",63],["T_BOOLEAN_AND","&&",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$product",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","getTypeId",63],"(",")",["T_WHITESPACE"," ",63],["T_IS_EQUAL","==",63],["T_WHITESPACE"," ",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Magento",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Catalog",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Model",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Product",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Type",63],["T_DOUBLE_COLON","::",63],["T_STRING","TYPE_BUNDLE",63],")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n\n            ",63],["T_IF","if",65],["T_WHITESPACE"," ",65],"(",["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","taxData",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","priceIncludesTax",65],"(",")",["T_WHITESPACE"," ",65],["T_BOOLEAN_AND","&&",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","taxData",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","displayPriceExcludingTax",65],"(",")",")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n                ",65],["T_COMMENT","\/\/ the Tax module might have set up a default, but we will re-decide which calcPrice field to use\n",66],["T_WHITESPACE","                ",67],["T_UNSET","unset",67],"(",["T_VARIABLE","$options",67],"[",["T_CONSTANT_ENCAPSED_STRING","'optionTemplate'",67],"]",")",";",["T_WHITESPACE","\n            ",67],"}",["T_WHITESPACE","\n\n            ",68],["T_IF","if",70],["T_WHITESPACE"," ",70],"(","!",["T_STRING","array_key_exists",70],"(",["T_CONSTANT_ENCAPSED_STRING","'optionTemplate'",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$options",70],")",")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n                ",70],["T_VARIABLE","$calcPrice",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getWhichCalcPriceToUse",71],"(",["T_VARIABLE","$product",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getStoreId",71],"(",")",")",";",["T_WHITESPACE","\n                ",71],["T_VARIABLE","$options",72],"[",["T_CONSTANT_ENCAPSED_STRING","'optionTemplate'",72],"]",["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_CONSTANT_ENCAPSED_STRING","'<%- data.label %>'",72],["T_WHITESPACE","\n                    ",72],".",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'<% if (data.'",73],["T_WHITESPACE"," ",73],".",["T_WHITESPACE"," ",73],["T_VARIABLE","$calcPrice",73],["T_WHITESPACE"," ",73],".",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'.value) { %>'",73],["T_WHITESPACE","\n                    ",73],".",["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","' +<%- data.'",74],["T_WHITESPACE"," ",74],".",["T_WHITESPACE"," ",74],["T_VARIABLE","$calcPrice",74],["T_WHITESPACE"," ",74],".",["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","'.formatted %>'",74],["T_WHITESPACE","\n                    ",74],".",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","'<% } %>'",75],";",["T_WHITESPACE","\n            ",75],"}",["T_WHITESPACE","\n\n            ",76],["T_IF","if",78],["T_WHITESPACE"," ",78],"(","!",["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","weeeData",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","isDisplayIncl",78],"(",["T_VARIABLE","$product",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getStoreId",78],"(",")",")",["T_WHITESPACE"," ",78],["T_BOOLEAN_AND","&&",78],["T_WHITESPACE","\n                ",78],"!",["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","weeeData",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","isDisplayExcl",79],"(",["T_VARIABLE","$product",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","getStoreId",79],"(",")",")",")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n                ",79],["T_COMMENT","\/\/ we need to display the individual Weee amounts\n",80],["T_WHITESPACE","                ",81],["T_FOREACH","foreach",81],["T_WHITESPACE"," ",81],"(",["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","weeeData",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getWeeeAttributesForBundle",81],"(",["T_VARIABLE","$product",81],")",["T_WHITESPACE"," ",81],["T_AS","as",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$weeeAttributes",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n                    ",81],["T_FOREACH","foreach",82],["T_WHITESPACE"," ",82],"(",["T_VARIABLE","$weeeAttributes",82],["T_WHITESPACE"," ",82],["T_AS","as",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$weeeAttribute",82],")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n                        ",82],["T_IF","if",83],["T_WHITESPACE"," ",83],"(","!",["T_STRING","preg_match",83],"(",["T_CONSTANT_ENCAPSED_STRING","'\/'",83],["T_WHITESPACE"," ",83],".",["T_WHITESPACE"," ",83],["T_VARIABLE","$weeeAttribute",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","getCode",83],"(",")",["T_WHITESPACE"," ",83],".",["T_WHITESPACE"," ",83],["T_CONSTANT_ENCAPSED_STRING","'\/'",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$options",83],"[",["T_CONSTANT_ENCAPSED_STRING","'optionTemplate'",83],"]",")",")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n                            ",83],["T_VARIABLE","$options",84],"[",["T_CONSTANT_ENCAPSED_STRING","'optionTemplate'",84],"]",["T_WHITESPACE"," ",84],["T_CONCAT_EQUAL",".=",84],["T_WHITESPACE"," ",84],["T_STRING","sprintf",84],"(",["T_WHITESPACE","\n                                ",84],["T_CONSTANT_ENCAPSED_STRING","' <%% if (data.weeePrice'",85],["T_WHITESPACE"," ",85],".",["T_WHITESPACE"," ",85],["T_VARIABLE","$weeeAttribute",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","getCode",85],"(",")",["T_WHITESPACE"," ",85],".",["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","') { %%>'",85],["T_WHITESPACE","\n                                ",85],".",["T_WHITESPACE"," ",86],["T_CONSTANT_ENCAPSED_STRING","'  ('",86],["T_WHITESPACE"," ",86],".",["T_WHITESPACE"," ",86],["T_VARIABLE","$weeeAttribute",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getName",86],"(",")",["T_WHITESPACE","\n                                ",86],".",["T_WHITESPACE"," ",87],["T_CONSTANT_ENCAPSED_STRING","': <%%- data.weeePrice'",87],["T_WHITESPACE"," ",87],".",["T_WHITESPACE"," ",87],["T_VARIABLE","$weeeAttribute",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getCode",87],"(",")",["T_WHITESPACE","\n                                ",87],".",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'.formatted %%>)'",88],["T_WHITESPACE","\n                                ",88],".",["T_WHITESPACE"," ",89],["T_CONSTANT_ENCAPSED_STRING","'<%% } %%>'",89],["T_WHITESPACE","\n                            ",89],")",";",["T_WHITESPACE","\n                        ",90],"}",["T_WHITESPACE","\n                    ",91],"}",["T_WHITESPACE","\n                ",92],"}",["T_WHITESPACE","\n            ",93],"}",["T_WHITESPACE","\n\n            ",94],["T_IF","if",96],["T_WHITESPACE"," ",96],"(",["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","weeeData",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","isDisplayExclDescIncl",96],"(",["T_VARIABLE","$product",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getStoreId",96],"(",")",")",")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n                ",96],["T_VARIABLE","$options",97],"[",["T_CONSTANT_ENCAPSED_STRING","'optionTemplate'",97],"]",["T_WHITESPACE"," ",97],["T_CONCAT_EQUAL",".=",97],["T_WHITESPACE"," ",97],["T_STRING","sprintf",97],"(",["T_WHITESPACE","\n                    ",97],["T_CONSTANT_ENCAPSED_STRING","' <%% if (data.weeePrice) { %%>'",98],["T_WHITESPACE","\n                    ",98],".",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","'<%%- data.weeePrice.formatted %%>'",99],["T_WHITESPACE","\n                    ",99],".",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","'<%% } %%>'",100],["T_WHITESPACE","\n                ",100],")",";",["T_WHITESPACE","\n            ",101],"}",["T_WHITESPACE","\n        ",102],"}",["T_WHITESPACE","\n        ",103],["T_VARIABLE","$response",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","setAdditionalOptions",104],"(",["T_VARIABLE","$options",104],")",";",["T_WHITESPACE","\n        ",104],["T_RETURN","return",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],";",["T_WHITESPACE","\n    ",105],"}",["T_WHITESPACE","\n\n    ",106],["T_DOC_COMMENT","\/**\n     * Returns which product price to show (before listing the individual Weee amounts, if applicable)\n     *\n     * @param  int|null $storeId\n     * @return string\n     *\/",108],["T_WHITESPACE","\n    ",113],["T_PROTECTED","protected",114],["T_WHITESPACE"," ",114],["T_FUNCTION","function",114],["T_WHITESPACE"," ",114],["T_STRING","getWhichCalcPriceToUse",114],"(",["T_VARIABLE","$storeId",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_STRING","null",114],")",["T_WHITESPACE","\n    ",114],"{",["T_WHITESPACE","\n        ",115],["T_VARIABLE","$calcPrice",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","'finalPrice'",116],";",["T_WHITESPACE","\n\n        ",116],["T_IF","if",118],["T_WHITESPACE"," ",118],"(",["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","weeeData",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","isDisplayExclDescIncl",118],"(",["T_VARIABLE","$storeId",118],")",["T_WHITESPACE"," ",118],["T_BOOLEAN_OR","||",118],["T_WHITESPACE","\n            ",118],"(",["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","weeeData",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","isDisplayExcl",119],"(",["T_VARIABLE","$storeId",119],")",["T_WHITESPACE"," ",119],["T_BOOLEAN_AND","&&",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","taxData",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","displayPriceExcludingTax",119],"(",")",")",")",["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n            ",119],["T_VARIABLE","$calcPrice",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_CONSTANT_ENCAPSED_STRING","'basePrice'",120],";",["T_WHITESPACE","\n        ",120],"}",["T_WHITESPACE","\n        ",121],["T_RETURN","return",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$calcPrice",122],";",["T_WHITESPACE","\n    ",122],"}",["T_WHITESPACE","\n",123],"}",["T_WHITESPACE","\n",124]]