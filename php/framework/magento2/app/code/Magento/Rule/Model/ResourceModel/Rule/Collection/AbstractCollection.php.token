[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Abstract Rule entity resource collection model\n *\n * @author Magento Core Team <core@magentocommerce.com>\n *\/",7],["T_WHITESPACE","\n",11],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Rule",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Model",12],["T_NS_SEPARATOR","\\",12],["T_STRING","ResourceModel",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Rule",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Collection",12],";",["T_WHITESPACE","\n\n",12],["T_ABSTRACT","abstract",14],["T_WHITESPACE"," ",14],["T_CLASS","class",14],["T_WHITESPACE"," ",14],["T_STRING","AbstractCollection",14],["T_WHITESPACE"," ",14],["T_EXTENDS","extends",14],["T_WHITESPACE"," ",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Framework",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Model",14],["T_NS_SEPARATOR","\\",14],["T_STRING","ResourceModel",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Db",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Collection",14],["T_NS_SEPARATOR","\\",14],["T_STRING","AbstractCollection",14],["T_WHITESPACE","\n",14],"{",["T_WHITESPACE","\n    ",15],["T_DOC_COMMENT","\/**\n     * Store associated with rule entities information map\n     *\n     * Example:\n     * array(\n     *    'entity_type1' => array(\n     *        'associations_table' => 'table_name',\n     *        'rule_id_field'      => 'rule_id',\n     *        'entity_id_field'    => 'entity_id'\n     *    ),\n     *    'entity_type2' => array(\n     *        'associations_table' => 'table_name',\n     *        'rule_id_field'      => 'rule_id',\n     *        'entity_id_field'    => 'entity_id'\n     *    )\n     *    ....\n     * )\n     *\n     * @var array\n     *\/",16],["T_WHITESPACE","\n    ",35],["T_PROTECTED","protected",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$_associatedEntitiesMap",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],"[","]",";",["T_WHITESPACE","\n\n    ",36],["T_DOC_COMMENT","\/**\n     * Add website ids to rules data\n     *\n     * @return $this\n     *\/",38],["T_WHITESPACE","\n    ",42],["T_PROTECTED","protected",43],["T_WHITESPACE"," ",43],["T_FUNCTION","function",43],["T_WHITESPACE"," ",43],["T_STRING","_afterLoad",43],"(",")",["T_WHITESPACE","\n    ",43],"{",["T_WHITESPACE","\n        ",44],["T_STRING","parent",45],["T_DOUBLE_COLON","::",45],["T_STRING","_afterLoad",45],"(",")",";",["T_WHITESPACE","\n        ",45],["T_IF","if",46],["T_WHITESPACE"," ",46],"(",["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","getFlag",46],"(",["T_CONSTANT_ENCAPSED_STRING","'add_websites_to_result'",46],")",["T_WHITESPACE"," ",46],["T_BOOLEAN_AND","&&",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","_items",46],")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n            ",46],["T_DOC_COMMENT","\/** @var \\Magento\\Rule\\Model\\AbstractModel $item *\/",47],["T_WHITESPACE","\n            ",47],["T_FOREACH","foreach",48],["T_WHITESPACE"," ",48],"(",["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","_items",48],["T_WHITESPACE"," ",48],["T_AS","as",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$item",48],")",["T_WHITESPACE"," ",48],"{",["T_WHITESPACE","\n                ",48],["T_VARIABLE","$item",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","afterLoad",49],"(",")",";",["T_WHITESPACE","\n            ",49],"}",["T_WHITESPACE","\n        ",50],"}",["T_WHITESPACE","\n\n        ",51],["T_RETURN","return",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$this",53],";",["T_WHITESPACE","\n    ",53],"}",["T_WHITESPACE","\n\n    ",54],["T_DOC_COMMENT","\/**\n     * Init flag for adding rule website ids to collection result\n     *\n     * @param bool|null $flag\n     * @return $this\n     *\/",56],["T_WHITESPACE","\n    ",61],["T_PUBLIC","public",62],["T_WHITESPACE"," ",62],["T_FUNCTION","function",62],["T_WHITESPACE"," ",62],["T_STRING","addWebsitesToResult",62],"(",["T_VARIABLE","$flag",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_STRING","null",62],")",["T_WHITESPACE","\n    ",62],"{",["T_WHITESPACE","\n        ",63],["T_VARIABLE","$flag",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$flag",64],["T_WHITESPACE"," ",64],["T_IS_IDENTICAL","===",64],["T_WHITESPACE"," ",64],["T_STRING","null",64],["T_WHITESPACE"," ",64],"?",["T_WHITESPACE"," ",64],["T_STRING","true",64],["T_WHITESPACE"," ",64],":",["T_WHITESPACE"," ",64],["T_VARIABLE","$flag",64],";",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","setFlag",65],"(",["T_CONSTANT_ENCAPSED_STRING","'add_websites_to_result'",65],",",["T_WHITESPACE"," ",65],["T_VARIABLE","$flag",65],")",";",["T_WHITESPACE","\n        ",65],["T_RETURN","return",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],";",["T_WHITESPACE","\n    ",66],"}",["T_WHITESPACE","\n\n    ",67],["T_DOC_COMMENT","\/**\n     * Limit rules collection by specific websites\n     *\n     * @param int|int[]|\\Magento\\Store\\Model\\Website $websiteId\n     * @return $this\n     *\/",69],["T_WHITESPACE","\n    ",74],["T_PUBLIC","public",75],["T_WHITESPACE"," ",75],["T_FUNCTION","function",75],["T_WHITESPACE"," ",75],["T_STRING","addWebsiteFilter",75],"(",["T_VARIABLE","$websiteId",75],")",["T_WHITESPACE","\n    ",75],"{",["T_WHITESPACE","\n        ",76],["T_IF","if",77],["T_WHITESPACE"," ",77],"(","!",["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getFlag",77],"(",["T_CONSTANT_ENCAPSED_STRING","'is_website_table_joined'",77],")",")",["T_WHITESPACE"," ",77],"{",["T_WHITESPACE","\n            ",77],["T_VARIABLE","$websiteIds",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_STRING","is_array",78],"(",["T_VARIABLE","$websiteId",78],")",["T_WHITESPACE"," ",78],"?",["T_WHITESPACE"," ",78],["T_VARIABLE","$websiteId",78],["T_WHITESPACE"," ",78],":",["T_WHITESPACE"," ",78],"[",["T_VARIABLE","$websiteId",78],"]",";",["T_WHITESPACE","\n            ",78],["T_VARIABLE","$entityInfo",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","_getAssociatedEntityInfo",79],"(",["T_CONSTANT_ENCAPSED_STRING","'website'",79],")",";",["T_WHITESPACE","\n            ",79],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","setFlag",80],"(",["T_CONSTANT_ENCAPSED_STRING","'is_website_table_joined'",80],",",["T_WHITESPACE"," ",80],["T_STRING","true",80],")",";",["T_WHITESPACE","\n            ",80],["T_FOREACH","foreach",81],["T_WHITESPACE"," ",81],"(",["T_VARIABLE","$websiteIds",81],["T_WHITESPACE"," ",81],["T_AS","as",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$index",81],["T_WHITESPACE"," ",81],["T_DOUBLE_ARROW","=>",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$website",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n                ",81],["T_IF","if",82],["T_WHITESPACE"," ",82],"(",["T_VARIABLE","$website",82],["T_WHITESPACE"," ",82],["T_INSTANCEOF","instanceof",82],["T_WHITESPACE"," ",82],["T_NS_SEPARATOR","\\",82],["T_STRING","Magento",82],["T_NS_SEPARATOR","\\",82],["T_STRING","Store",82],["T_NS_SEPARATOR","\\",82],["T_STRING","Model",82],["T_NS_SEPARATOR","\\",82],["T_STRING","Website",82],")",["T_WHITESPACE"," ",82],"{",["T_WHITESPACE","\n                    ",82],["T_VARIABLE","$websiteIds",83],"[",["T_VARIABLE","$index",83],"]",["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$website",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","getId",83],"(",")",";",["T_WHITESPACE","\n                ",83],"}",["T_WHITESPACE","\n            ",84],"}",["T_WHITESPACE","\n            ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getSelect",86],"(",")",["T_OBJECT_OPERATOR","->",86],["T_STRING","join",86],"(",["T_WHITESPACE","\n                ",86],"[",["T_CONSTANT_ENCAPSED_STRING","'website'",87],["T_WHITESPACE"," ",87],["T_DOUBLE_ARROW","=>",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getTable",87],"(",["T_VARIABLE","$entityInfo",87],"[",["T_CONSTANT_ENCAPSED_STRING","'associations_table'",87],"]",")","]",",",["T_WHITESPACE","\n                ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","getConnection",88],"(",")",["T_OBJECT_OPERATOR","->",88],["T_STRING","quoteInto",88],"(",["T_CONSTANT_ENCAPSED_STRING","'website.'",88],["T_WHITESPACE"," ",88],".",["T_WHITESPACE"," ",88],["T_VARIABLE","$entityInfo",88],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id_field'",88],"]",["T_WHITESPACE"," ",88],".",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","' IN (?)'",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$websiteIds",88],")",["T_WHITESPACE","\n                ",88],".",["T_WHITESPACE"," ",89],["T_CONSTANT_ENCAPSED_STRING","' AND main_table.'",89],["T_WHITESPACE"," ",89],".",["T_WHITESPACE"," ",89],["T_VARIABLE","$entityInfo",89],"[",["T_CONSTANT_ENCAPSED_STRING","'rule_id_field'",89],"]",["T_WHITESPACE"," ",89],".",["T_WHITESPACE"," ",89],["T_CONSTANT_ENCAPSED_STRING","' = website.'",89],["T_WHITESPACE"," ",89],".",["T_WHITESPACE"," ",89],["T_VARIABLE","$entityInfo",89],"[",["T_CONSTANT_ENCAPSED_STRING","'rule_id_field'",89],"]",",",["T_WHITESPACE","\n                ",89],"[","]",["T_WHITESPACE","\n            ",90],")",";",["T_WHITESPACE","\n        ",91],"}",["T_WHITESPACE","\n        ",92],["T_RETURN","return",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],";",["T_WHITESPACE","\n    ",93],"}",["T_WHITESPACE","\n\n    ",94],["T_DOC_COMMENT","\/**\n     * Provide support for website id filter\n     *\n     * @param string $field\n     * @param null|string|array $condition\n     * @return $this\n     *\/",96],["T_WHITESPACE","\n    ",102],["T_PUBLIC","public",103],["T_WHITESPACE"," ",103],["T_FUNCTION","function",103],["T_WHITESPACE"," ",103],["T_STRING","addFieldToFilter",103],"(",["T_VARIABLE","$field",103],",",["T_WHITESPACE"," ",103],["T_VARIABLE","$condition",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_STRING","null",103],")",["T_WHITESPACE","\n    ",103],"{",["T_WHITESPACE","\n        ",104],["T_IF","if",105],["T_WHITESPACE"," ",105],"(",["T_VARIABLE","$field",105],["T_WHITESPACE"," ",105],["T_IS_EQUAL","==",105],["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'website_ids'",105],")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n            ",105],["T_RETURN","return",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","addWebsiteFilter",106],"(",["T_VARIABLE","$condition",106],")",";",["T_WHITESPACE","\n        ",106],"}",["T_WHITESPACE","\n\n        ",107],["T_STRING","parent",109],["T_DOUBLE_COLON","::",109],["T_STRING","addFieldToFilter",109],"(",["T_VARIABLE","$field",109],",",["T_WHITESPACE"," ",109],["T_VARIABLE","$condition",109],")",";",["T_WHITESPACE","\n        ",109],["T_RETURN","return",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],";",["T_WHITESPACE","\n    ",110],"}",["T_WHITESPACE","\n\n    ",111],["T_DOC_COMMENT","\/**\n     * Filter collection to only active or inactive rules\n     *\n     * @param int $isActive\n     * @return $this\n     *\/",113],["T_WHITESPACE","\n    ",118],["T_PUBLIC","public",119],["T_WHITESPACE"," ",119],["T_FUNCTION","function",119],["T_WHITESPACE"," ",119],["T_STRING","addIsActiveFilter",119],"(",["T_VARIABLE","$isActive",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_LNUMBER","1",119],")",["T_WHITESPACE","\n    ",119],"{",["T_WHITESPACE","\n        ",120],["T_IF","if",121],["T_WHITESPACE"," ",121],"(","!",["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","getFlag",121],"(",["T_CONSTANT_ENCAPSED_STRING","'is_active_filter'",121],")",")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n            ",121],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","addFieldToFilter",122],"(",["T_CONSTANT_ENCAPSED_STRING","'is_active'",122],",",["T_WHITESPACE"," ",122],["T_INT_CAST","(int)",122],["T_VARIABLE","$isActive",122],["T_WHITESPACE"," ",122],"?",["T_WHITESPACE"," ",122],["T_LNUMBER","1",122],["T_WHITESPACE"," ",122],":",["T_WHITESPACE"," ",122],["T_LNUMBER","0",122],")",";",["T_WHITESPACE","\n            ",122],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","setFlag",123],"(",["T_CONSTANT_ENCAPSED_STRING","'is_active_filter'",123],",",["T_WHITESPACE"," ",123],["T_STRING","true",123],")",";",["T_WHITESPACE","\n        ",123],"}",["T_WHITESPACE","\n        ",124],["T_RETURN","return",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$this",125],";",["T_WHITESPACE","\n    ",125],"}",["T_WHITESPACE","\n\n    ",126],["T_DOC_COMMENT","\/**\n     * Retrieve correspondent entity information (associations table name, columns names)\n     * of rule's associated entity by specified entity type\n     *\n     * @param string $entityType\n     *\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     * @return array\n     *\/",128],["T_WHITESPACE","\n    ",136],["T_PROTECTED","protected",137],["T_WHITESPACE"," ",137],["T_FUNCTION","function",137],["T_WHITESPACE"," ",137],["T_STRING","_getAssociatedEntityInfo",137],"(",["T_VARIABLE","$entityType",137],")",["T_WHITESPACE","\n    ",137],"{",["T_WHITESPACE","\n        ",138],["T_IF","if",139],["T_WHITESPACE"," ",139],"(",["T_ISSET","isset",139],"(",["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","_associatedEntitiesMap",139],"[",["T_VARIABLE","$entityType",139],"]",")",")",["T_WHITESPACE"," ",139],"{",["T_WHITESPACE","\n            ",139],["T_RETURN","return",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","_associatedEntitiesMap",140],"[",["T_VARIABLE","$entityType",140],"]",";",["T_WHITESPACE","\n        ",140],"}",["T_WHITESPACE","\n\n        ",141],["T_THROW","throw",143],["T_WHITESPACE"," ",143],["T_NEW","new",143],["T_WHITESPACE"," ",143],["T_NS_SEPARATOR","\\",143],["T_STRING","Magento",143],["T_NS_SEPARATOR","\\",143],["T_STRING","Framework",143],["T_NS_SEPARATOR","\\",143],["T_STRING","Exception",143],["T_NS_SEPARATOR","\\",143],["T_STRING","LocalizedException",143],"(",["T_WHITESPACE","\n            ",143],["T_STRING","__",144],"(",["T_CONSTANT_ENCAPSED_STRING","'There is no information about associated entity type \"%1\".'",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$entityType",144],")",["T_WHITESPACE","\n        ",144],")",";",["T_WHITESPACE","\n    ",145],"}",["T_WHITESPACE","\n",146],"}",["T_WHITESPACE","\n",147]]