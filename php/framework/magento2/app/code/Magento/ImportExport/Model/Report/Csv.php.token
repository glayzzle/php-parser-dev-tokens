[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","ImportExport",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Model",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Report",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","ImportExport",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Model",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Import",9],["T_NS_SEPARATOR","\\",9],["T_STRING","ErrorProcessing",9],["T_NS_SEPARATOR","\\",9],["T_STRING","ProcessingErrorAggregatorInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","App",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Filesystem",10],["T_NS_SEPARATOR","\\",10],["T_STRING","DirectoryList",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","ImportExport",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Model",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Import",11],";",["T_WHITESPACE","\n\n",11],["T_DOC_COMMENT","\/**\n * Class Csv create new CSV file and add Error data in additional column\n *\/",13],["T_WHITESPACE","\n",15],["T_CLASS","class",16],["T_WHITESPACE"," ",16],["T_STRING","Csv",16],["T_WHITESPACE"," ",16],["T_IMPLEMENTS","implements",16],["T_WHITESPACE"," ",16],["T_STRING","ReportProcessorInterface",16],["T_WHITESPACE","\n",16],"{",["T_WHITESPACE","\n    ",17],["T_CONST","const",18],["T_WHITESPACE"," ",18],["T_STRING","ERROR_REPORT_FILE_SUFFIX",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],["T_CONSTANT_ENCAPSED_STRING","'_error_report'",18],";",["T_WHITESPACE","\n\n    ",18],["T_CONST","const",20],["T_WHITESPACE"," ",20],["T_STRING","ERROR_REPORT_FILE_EXTENSION",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_CONSTANT_ENCAPSED_STRING","'.csv'",20],";",["T_WHITESPACE","\n\n    ",20],["T_CONST","const",22],["T_WHITESPACE"," ",22],["T_STRING","REPORT_ERROR_COLUMN_NAME",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'errors'",22],";",["T_WHITESPACE","\n\n    ",22],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\ImportExport\\Helper\\Report\n     *\/",24],["T_WHITESPACE","\n    ",26],["T_PROTECTED","protected",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$reportHelper",27],";",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\ImportExport\\Model\\Import\\Source\\CsvFactory\n     *\/",29],["T_WHITESPACE","\n    ",31],["T_PROTECTED","protected",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$sourceCsvFactory",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\ImportExport\\Model\\Export\\Adapter\\CsvFactory\n     *\/",34],["T_WHITESPACE","\n    ",36],["T_PROTECTED","protected",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$outputCsvFactory",37],";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Filesystem\n     *\/",39],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$filesystem",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\ImportExport\\Helper\\Report $reportHelper\n     * @param Import\\Source\\CsvFactory $sourceCsvFactory\n     * @param \\Magento\\ImportExport\\Model\\Export\\Adapter\\CsvFactory $outputCsvFactory\n     * @param \\Magento\\Framework\\Filesystem $filesystem\n     *\/",44],["T_WHITESPACE","\n    ",49],["T_PUBLIC","public",50],["T_WHITESPACE"," ",50],["T_FUNCTION","function",50],["T_WHITESPACE"," ",50],["T_STRING","__construct",50],"(",["T_WHITESPACE","\n        ",50],["T_NS_SEPARATOR","\\",51],["T_STRING","Magento",51],["T_NS_SEPARATOR","\\",51],["T_STRING","ImportExport",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Helper",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Report",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$reportHelper",51],",",["T_WHITESPACE","\n        ",51],["T_NS_SEPARATOR","\\",52],["T_STRING","Magento",52],["T_NS_SEPARATOR","\\",52],["T_STRING","ImportExport",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Model",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Import",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Source",52],["T_NS_SEPARATOR","\\",52],["T_STRING","CsvFactory",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$sourceCsvFactory",52],",",["T_WHITESPACE","\n        ",52],["T_NS_SEPARATOR","\\",53],["T_STRING","Magento",53],["T_NS_SEPARATOR","\\",53],["T_STRING","ImportExport",53],["T_NS_SEPARATOR","\\",53],["T_STRING","Model",53],["T_NS_SEPARATOR","\\",53],["T_STRING","Export",53],["T_NS_SEPARATOR","\\",53],["T_STRING","Adapter",53],["T_NS_SEPARATOR","\\",53],["T_STRING","CsvFactory",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$outputCsvFactory",53],",",["T_WHITESPACE","\n        ",53],["T_NS_SEPARATOR","\\",54],["T_STRING","Magento",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Framework",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Filesystem",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$filesystem",54],["T_WHITESPACE","\n    ",54],")",["T_WHITESPACE"," ",55],"{",["T_WHITESPACE","\n        ",55],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","reportHelper",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$reportHelper",56],";",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","sourceCsvFactory",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$sourceCsvFactory",57],";",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","outputCsvFactory",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$outputCsvFactory",58],";",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","filesystem",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$filesystem",59],";",["T_WHITESPACE","\n    ",59],"}",["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * @param string $originalFileName\n     * @param ProcessingErrorAggregatorInterface $errorAggregator\n     * @param bool $writeOnlyErrorItems\n     * @return string\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     *\/",62],["T_WHITESPACE","\n    ",68],["T_PUBLIC","public",69],["T_WHITESPACE"," ",69],["T_FUNCTION","function",69],["T_WHITESPACE"," ",69],["T_STRING","createReport",69],"(",["T_WHITESPACE","\n        ",69],["T_VARIABLE","$originalFileName",70],",",["T_WHITESPACE","\n        ",70],["T_STRING","ProcessingErrorAggregatorInterface",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$errorAggregator",71],",",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$writeOnlyErrorItems",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_STRING","false",72],["T_WHITESPACE","\n    ",72],")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$sourceCsv",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","createSourceCsvModel",74],"(",["T_VARIABLE","$originalFileName",74],")",";",["T_WHITESPACE","\n\n        ",74],["T_VARIABLE","$outputFileName",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","generateOutputFileName",76],"(",["T_VARIABLE","$originalFileName",76],")",";",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$outputCsv",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","createOutputCsvModel",77],"(",["T_VARIABLE","$outputFileName",77],")",";",["T_WHITESPACE","\n\n        ",77],["T_VARIABLE","$columnsName",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$sourceCsv",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","getColNames",79],"(",")",";",["T_WHITESPACE","\n        ",79],["T_STRING","array_push",80],"(",["T_VARIABLE","$columnsName",80],",",["T_WHITESPACE"," ",80],["T_STRING","self",80],["T_DOUBLE_COLON","::",80],["T_STRING","REPORT_ERROR_COLUMN_NAME",80],")",";",["T_WHITESPACE","\n        ",80],["T_VARIABLE","$outputCsv",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","setHeaderCols",81],"(",["T_VARIABLE","$columnsName",81],")",";",["T_WHITESPACE","\n\n        ",81],["T_FOREACH","foreach",83],["T_WHITESPACE"," ",83],"(",["T_VARIABLE","$sourceCsv",83],["T_WHITESPACE"," ",83],["T_AS","as",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$rowNum",83],["T_WHITESPACE"," ",83],["T_DOUBLE_ARROW","=>",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$rowData",83],")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n            ",83],["T_VARIABLE","$errorMessages",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","retrieveErrorMessagesByRowNumber",84],"(",["T_VARIABLE","$rowNum",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$errorAggregator",84],")",";",["T_WHITESPACE","\n            ",84],["T_IF","if",85],["T_WHITESPACE"," ",85],"(","!",["T_VARIABLE","$writeOnlyErrorItems",85],["T_WHITESPACE"," ",85],["T_BOOLEAN_OR","||",85],["T_WHITESPACE"," ",85],"(",["T_VARIABLE","$writeOnlyErrorItems",85],["T_WHITESPACE"," ",85],["T_BOOLEAN_AND","&&",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$errorMessages",85],")",")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n                ",85],["T_VARIABLE","$rowData",86],"[",["T_STRING","self",86],["T_DOUBLE_COLON","::",86],["T_STRING","REPORT_ERROR_COLUMN_NAME",86],"]",["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$errorMessages",86],";",["T_WHITESPACE","\n                ",86],["T_VARIABLE","$outputCsv",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","writeRow",87],"(",["T_VARIABLE","$rowData",87],")",";",["T_WHITESPACE","\n            ",87],"}",["T_WHITESPACE","\n        ",88],"}",["T_WHITESPACE","\n\n        ",89],["T_RETURN","return",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$outputFileName",91],";",["T_WHITESPACE","\n    ",91],"}",["T_WHITESPACE","\n\n    ",92],["T_DOC_COMMENT","\/**\n     * @param int $rowNumber\n     * @param ProcessingErrorAggregatorInterface $errorAggregator\n     * @return string\n     *\/",94],["T_WHITESPACE","\n    ",98],["T_PUBLIC","public",99],["T_WHITESPACE"," ",99],["T_FUNCTION","function",99],["T_WHITESPACE"," ",99],["T_STRING","retrieveErrorMessagesByRowNumber",99],"(",["T_VARIABLE","$rowNumber",99],",",["T_WHITESPACE"," ",99],["T_STRING","ProcessingErrorAggregatorInterface",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$errorAggregator",99],")",["T_WHITESPACE","\n    ",99],"{",["T_WHITESPACE","\n        ",100],["T_VARIABLE","$messages",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","''",101],";",["T_WHITESPACE","\n        ",101],["T_FOREACH","foreach",102],["T_WHITESPACE"," ",102],"(",["T_VARIABLE","$errorAggregator",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","getErrorByRowNumber",102],"(",["T_INT_CAST","(int)",102],["T_VARIABLE","$rowNumber",102],")",["T_WHITESPACE"," ",102],["T_AS","as",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$error",102],")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n            ",102],["T_VARIABLE","$messages",103],["T_WHITESPACE"," ",103],["T_CONCAT_EQUAL",".=",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$error",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getErrorMessage",103],"(",")",["T_WHITESPACE"," ",103],".",["T_WHITESPACE"," ",103],["T_CONSTANT_ENCAPSED_STRING","','",103],";",["T_WHITESPACE","\n        ",103],"}",["T_WHITESPACE","\n        ",104],["T_VARIABLE","$messages",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_STRING","rtrim",105],"(",["T_VARIABLE","$messages",105],",",["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","','",105],")",";",["T_WHITESPACE","\n\n        ",105],["T_IF","if",107],["T_WHITESPACE"," ",107],"(",["T_VARIABLE","$messages",107],")",["T_WHITESPACE"," ",107],"{",["T_WHITESPACE","\n            ",107],["T_VARIABLE","$messages",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_STRING","str_pad",108],"(",["T_VARIABLE","$messages",108],",",["T_WHITESPACE"," ",108],["T_LNUMBER","1",108],",",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'\"'",108],",",["T_WHITESPACE"," ",108],["T_STRING","STR_PAD_BOTH",108],")",";",["T_WHITESPACE","\n        ",108],"}",["T_WHITESPACE","\n\n        ",109],["T_RETURN","return",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$messages",111],";",["T_WHITESPACE","\n    ",111],"}",["T_WHITESPACE","\n\n    ",112],["T_DOC_COMMENT","\/**\n     * @param string $sourceFile\n     * @return string\n     *\/",114],["T_WHITESPACE","\n    ",117],["T_PROTECTED","protected",118],["T_WHITESPACE"," ",118],["T_FUNCTION","function",118],["T_WHITESPACE"," ",118],["T_STRING","generateOutputFileName",118],"(",["T_VARIABLE","$sourceFile",118],")",["T_WHITESPACE","\n    ",118],"{",["T_WHITESPACE","\n        ",119],["T_VARIABLE","$fileName",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_STRING","basename",120],"(",["T_VARIABLE","$sourceFile",120],",",["T_WHITESPACE"," ",120],["T_STRING","self",120],["T_DOUBLE_COLON","::",120],["T_STRING","ERROR_REPORT_FILE_EXTENSION",120],")",";",["T_WHITESPACE","\n        ",120],["T_RETURN","return",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$fileName",121],["T_WHITESPACE"," ",121],".",["T_WHITESPACE"," ",121],["T_STRING","self",121],["T_DOUBLE_COLON","::",121],["T_STRING","ERROR_REPORT_FILE_SUFFIX",121],["T_WHITESPACE"," ",121],".",["T_WHITESPACE"," ",121],["T_STRING","self",121],["T_DOUBLE_COLON","::",121],["T_STRING","ERROR_REPORT_FILE_EXTENSION",121],";",["T_WHITESPACE","\n    ",121],"}",["T_WHITESPACE","\n\n    ",122],["T_DOC_COMMENT","\/**\n     * @param string $sourceFile\n     * @return \\Magento\\ImportExport\\Model\\Import\\Source\\Csv\n     *\/",124],["T_WHITESPACE","\n    ",127],["T_PROTECTED","protected",128],["T_WHITESPACE"," ",128],["T_FUNCTION","function",128],["T_WHITESPACE"," ",128],["T_STRING","createSourceCsvModel",128],"(",["T_VARIABLE","$sourceFile",128],")",["T_WHITESPACE","\n    ",128],"{",["T_WHITESPACE","\n        ",129],["T_RETURN","return",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","sourceCsvFactory",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","create",130],"(",["T_WHITESPACE","\n            ",130],"[",["T_WHITESPACE","\n                ",131],["T_CONSTANT_ENCAPSED_STRING","'file'",132],["T_WHITESPACE"," ",132],["T_DOUBLE_ARROW","=>",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$sourceFile",132],",",["T_WHITESPACE","\n                ",132],["T_CONSTANT_ENCAPSED_STRING","'directory'",133],["T_WHITESPACE"," ",133],["T_DOUBLE_ARROW","=>",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","filesystem",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getDirectoryWrite",133],"(",["T_STRING","DirectoryList",133],["T_DOUBLE_COLON","::",133],["T_STRING","VAR_DIR",133],")",["T_WHITESPACE","\n            ",133],"]",["T_WHITESPACE","\n        ",134],")",";",["T_WHITESPACE","\n    ",135],"}",["T_WHITESPACE","\n\n    ",136],["T_DOC_COMMENT","\/**\n     * @param string $outputFileName\n     * @return \\Magento\\ImportExport\\Model\\Export\\Adapter\\Csv\n     *\/",138],["T_WHITESPACE","\n    ",141],["T_PROTECTED","protected",142],["T_WHITESPACE"," ",142],["T_FUNCTION","function",142],["T_WHITESPACE"," ",142],["T_STRING","createOutputCsvModel",142],"(",["T_VARIABLE","$outputFileName",142],")",["T_WHITESPACE","\n    ",142],"{",["T_WHITESPACE","\n        ",143],["T_RETURN","return",144],["T_WHITESPACE"," ",144],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","outputCsvFactory",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","create",144],"(",["T_WHITESPACE","\n            ",144],"[",["T_WHITESPACE","\n                ",145],["T_CONSTANT_ENCAPSED_STRING","'destination'",146],["T_WHITESPACE"," ",146],["T_DOUBLE_ARROW","=>",146],["T_WHITESPACE"," ",146],["T_STRING","Import",146],["T_DOUBLE_COLON","::",146],["T_STRING","IMPORT_HISTORY_DIR",146],["T_WHITESPACE"," ",146],".",["T_WHITESPACE"," ",146],["T_VARIABLE","$outputFileName",146],",",["T_WHITESPACE","\n                ",146],["T_CONSTANT_ENCAPSED_STRING","'destinationDirectoryCode'",147],["T_WHITESPACE"," ",147],["T_DOUBLE_ARROW","=>",147],["T_WHITESPACE"," ",147],["T_STRING","DirectoryList",147],["T_DOUBLE_COLON","::",147],["T_STRING","VAR_DIR",147],",",["T_WHITESPACE","\n            ",147],"]",["T_WHITESPACE","\n        ",148],")",";",["T_WHITESPACE","\n    ",149],"}",["T_WHITESPACE","\n",150],"}",["T_WHITESPACE","\n",151]]