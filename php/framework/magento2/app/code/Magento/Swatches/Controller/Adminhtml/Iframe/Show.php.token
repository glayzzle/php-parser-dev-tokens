[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Swatches",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Controller",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Adminhtml",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Iframe",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","App",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Filesystem",8],["T_NS_SEPARATOR","\\",8],["T_STRING","DirectoryList",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * Class to show swatch image and save it on disk\n *\/",10],["T_WHITESPACE","\n",12],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","Show",13],["T_WHITESPACE"," ",13],["T_EXTENDS","extends",13],["T_WHITESPACE"," ",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Backend",13],["T_NS_SEPARATOR","\\",13],["T_STRING","App",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Action",13],["T_WHITESPACE","\n",13],"{",["T_WHITESPACE","\n    ",14],["T_DOC_COMMENT","\/**\n     * Authorization level of a basic admin session\n     *\n     * @see _isAllowed()\n     *\/",15],["T_WHITESPACE","\n    ",19],["T_CONST","const",20],["T_WHITESPACE"," ",20],["T_STRING","ADMIN_RESOURCE",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_CONSTANT_ENCAPSED_STRING","'Magento_Swatches::iframe'",20],";",["T_WHITESPACE","\n\n    ",20],["T_DOC_COMMENT","\/**\n     * Helper to move image from tmp to catalog\n     *\n     * @var \\Magento\\Swatches\\Helper\\Media\n     *\/",22],["T_WHITESPACE","\n    ",26],["T_PROTECTED","protected",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$swatchHelper",27],";",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Image\\AdapterFactory\n     *\/",29],["T_WHITESPACE","\n    ",31],["T_PROTECTED","protected",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$adapterFactory",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Catalog\\Model\\Product\\Media\\Config\n     *\/",34],["T_WHITESPACE","\n    ",36],["T_PROTECTED","protected",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$config",37],";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Filesystem\n     *\/",39],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$filesystem",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\MediaStorage\\Model\\File\\UploaderFactory\n     *\/",44],["T_WHITESPACE","\n    ",46],["T_PROTECTED","protected",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$uploaderFactory",47],";",["T_WHITESPACE","\n\n    ",47],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Backend\\App\\Action\\Context $context\n     * @param \\Magento\\Swatches\\Helper\\Media $swatchHelper\n     * @param \\Magento\\Framework\\Image\\AdapterFactory $adapterFactory\n     * @param \\Magento\\Catalog\\Model\\Product\\Media\\Config $config\n     * @param \\Magento\\Framework\\Filesystem $filesystem\n     * @param \\Magento\\MediaStorage\\Model\\File\\UploaderFactory $uploaderFactory\n     *\/",49],["T_WHITESPACE","\n    ",56],["T_PUBLIC","public",57],["T_WHITESPACE"," ",57],["T_FUNCTION","function",57],["T_WHITESPACE"," ",57],["T_STRING","__construct",57],"(",["T_WHITESPACE","\n        ",57],["T_NS_SEPARATOR","\\",58],["T_STRING","Magento",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Backend",58],["T_NS_SEPARATOR","\\",58],["T_STRING","App",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Action",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Context",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$context",58],",",["T_WHITESPACE","\n        ",58],["T_NS_SEPARATOR","\\",59],["T_STRING","Magento",59],["T_NS_SEPARATOR","\\",59],["T_STRING","Swatches",59],["T_NS_SEPARATOR","\\",59],["T_STRING","Helper",59],["T_NS_SEPARATOR","\\",59],["T_STRING","Media",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$swatchHelper",59],",",["T_WHITESPACE","\n        ",59],["T_NS_SEPARATOR","\\",60],["T_STRING","Magento",60],["T_NS_SEPARATOR","\\",60],["T_STRING","Framework",60],["T_NS_SEPARATOR","\\",60],["T_STRING","Image",60],["T_NS_SEPARATOR","\\",60],["T_STRING","AdapterFactory",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$adapterFactory",60],",",["T_WHITESPACE","\n        ",60],["T_NS_SEPARATOR","\\",61],["T_STRING","Magento",61],["T_NS_SEPARATOR","\\",61],["T_STRING","Catalog",61],["T_NS_SEPARATOR","\\",61],["T_STRING","Model",61],["T_NS_SEPARATOR","\\",61],["T_STRING","Product",61],["T_NS_SEPARATOR","\\",61],["T_STRING","Media",61],["T_NS_SEPARATOR","\\",61],["T_STRING","Config",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$config",61],",",["T_WHITESPACE","\n        ",61],["T_NS_SEPARATOR","\\",62],["T_STRING","Magento",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Framework",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Filesystem",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$filesystem",62],",",["T_WHITESPACE","\n        ",62],["T_NS_SEPARATOR","\\",63],["T_STRING","Magento",63],["T_NS_SEPARATOR","\\",63],["T_STRING","MediaStorage",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Model",63],["T_NS_SEPARATOR","\\",63],["T_STRING","File",63],["T_NS_SEPARATOR","\\",63],["T_STRING","UploaderFactory",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$uploaderFactory",63],["T_WHITESPACE","\n    ",63],")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","swatchHelper",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$swatchHelper",65],";",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","adapterFactory",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$adapterFactory",66],";",["T_WHITESPACE","\n        ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","config",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$config",67],";",["T_WHITESPACE","\n        ",67],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","filesystem",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$filesystem",68],";",["T_WHITESPACE","\n        ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","uploaderFactory",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_VARIABLE","$uploaderFactory",69],";",["T_WHITESPACE","\n        ",69],["T_STRING","parent",70],["T_DOUBLE_COLON","::",70],["T_STRING","__construct",70],"(",["T_VARIABLE","$context",70],")",";",["T_WHITESPACE","\n    ",70],"}",["T_WHITESPACE","\n\n    ",71],["T_DOC_COMMENT","\/**\n     * Image upload action in iframe\n     *\n     * @return string\n     *\/",73],["T_WHITESPACE","\n    ",77],["T_PUBLIC","public",78],["T_WHITESPACE"," ",78],["T_FUNCTION","function",78],["T_WHITESPACE"," ",78],["T_STRING","execute",78],"(",")",["T_WHITESPACE","\n    ",78],"{",["T_WHITESPACE","\n        ",79],["T_TRY","try",80],["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n            ",80],["T_VARIABLE","$uploader",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","uploaderFactory",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","create",81],"(","[",["T_CONSTANT_ENCAPSED_STRING","'fileId'",81],["T_WHITESPACE"," ",81],["T_DOUBLE_ARROW","=>",81],["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'datafile'",81],"]",")",";",["T_WHITESPACE","\n            ",81],["T_VARIABLE","$uploader",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","setAllowedExtensions",82],"(","[",["T_CONSTANT_ENCAPSED_STRING","'jpg'",82],",",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'jpeg'",82],",",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'gif'",82],",",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'png'",82],"]",")",";",["T_WHITESPACE","\n            ",82],["T_DOC_COMMENT","\/** @var \\Magento\\Framework\\Image\\Adapter\\AdapterInterface $imageAdapter *\/",83],["T_WHITESPACE","\n            ",83],["T_VARIABLE","$imageAdapter",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","adapterFactory",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","create",84],"(",")",";",["T_WHITESPACE","\n            ",84],["T_VARIABLE","$uploader",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","addValidateCallback",85],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_image'",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$imageAdapter",85],",",["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","'validateUploadFile'",85],")",";",["T_WHITESPACE","\n            ",85],["T_VARIABLE","$uploader",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","setAllowRenameFiles",86],"(",["T_STRING","true",86],")",";",["T_WHITESPACE","\n            ",86],["T_VARIABLE","$uploader",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","setFilesDispersion",87],"(",["T_STRING","true",87],")",";",["T_WHITESPACE","\n            ",87],["T_DOC_COMMENT","\/** @var \\Magento\\Framework\\Filesystem\\Directory\\Read $mediaDirectory *\/",88],["T_WHITESPACE","\n            ",88],["T_VARIABLE","$mediaDirectory",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","filesystem",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getDirectoryRead",89],"(",["T_STRING","DirectoryList",89],["T_DOUBLE_COLON","::",89],["T_STRING","MEDIA",89],")",";",["T_WHITESPACE","\n            ",89],["T_VARIABLE","$config",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","config",90],";",["T_WHITESPACE","\n            ",90],["T_VARIABLE","$result",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_VARIABLE","$uploader",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","save",91],"(",["T_VARIABLE","$mediaDirectory",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getAbsolutePath",91],"(",["T_VARIABLE","$config",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getBaseTmpMediaPath",91],"(",")",")",")",";",["T_WHITESPACE","\n\n            ",91],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","_eventManager",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","dispatch",93],"(",["T_WHITESPACE","\n                ",93],["T_CONSTANT_ENCAPSED_STRING","'swatch_gallery_upload_image_after'",94],",",["T_WHITESPACE","\n                ",94],"[",["T_CONSTANT_ENCAPSED_STRING","'result'",95],["T_WHITESPACE"," ",95],["T_DOUBLE_ARROW","=>",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$result",95],",",["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","'action'",95],["T_WHITESPACE"," ",95],["T_DOUBLE_ARROW","=>",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],"]",["T_WHITESPACE","\n            ",95],")",";",["T_WHITESPACE","\n\n            ",96],["T_UNSET","unset",98],"(",["T_VARIABLE","$result",98],"[",["T_CONSTANT_ENCAPSED_STRING","'tmp_name'",98],"]",")",";",["T_WHITESPACE","\n            ",98],["T_UNSET","unset",99],"(",["T_VARIABLE","$result",99],"[",["T_CONSTANT_ENCAPSED_STRING","'path'",99],"]",")",";",["T_WHITESPACE","\n\n            ",99],["T_VARIABLE","$result",101],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",101],"]",["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","config",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getTmpMediaUrl",101],"(",["T_VARIABLE","$result",101],"[",["T_CONSTANT_ENCAPSED_STRING","'file'",101],"]",")",";",["T_WHITESPACE","\n            ",101],["T_VARIABLE","$result",102],"[",["T_CONSTANT_ENCAPSED_STRING","'file'",102],"]",["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$result",102],"[",["T_CONSTANT_ENCAPSED_STRING","'file'",102],"]",["T_WHITESPACE"," ",102],".",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'.tmp'",102],";",["T_WHITESPACE","\n\n            ",102],["T_VARIABLE","$newFile",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","swatchHelper",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","moveImageFromTmp",104],"(",["T_VARIABLE","$result",104],"[",["T_CONSTANT_ENCAPSED_STRING","'file'",104],"]",")",";",["T_WHITESPACE","\n            ",104],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","swatchHelper",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","generateSwatchVariations",105],"(",["T_VARIABLE","$newFile",105],")",";",["T_WHITESPACE","\n            ",105],["T_VARIABLE","$fileData",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],"[",["T_CONSTANT_ENCAPSED_STRING","'swatch_path'",106],["T_WHITESPACE"," ",106],["T_DOUBLE_ARROW","=>",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","swatchHelper",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","getSwatchMediaUrl",106],"(",")",",",["T_WHITESPACE"," ",106],["T_CONSTANT_ENCAPSED_STRING","'file_path'",106],["T_WHITESPACE"," ",106],["T_DOUBLE_ARROW","=>",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$newFile",106],"]",";",["T_WHITESPACE","\n            ",106],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","getResponse",107],"(",")",["T_OBJECT_OPERATOR","->",107],["T_STRING","setBody",107],"(",["T_STRING","json_encode",107],"(",["T_VARIABLE","$fileData",107],")",")",";",["T_WHITESPACE","\n        ",107],"}",["T_WHITESPACE"," ",108],["T_CATCH","catch",108],["T_WHITESPACE"," ",108],"(",["T_NS_SEPARATOR","\\",108],["T_STRING","Exception",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$e",108],")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n            ",108],["T_VARIABLE","$result",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",109],["T_WHITESPACE"," ",109],["T_DOUBLE_ARROW","=>",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$e",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getMessage",109],"(",")",",",["T_WHITESPACE"," ",109],["T_CONSTANT_ENCAPSED_STRING","'errorcode'",109],["T_WHITESPACE"," ",109],["T_DOUBLE_ARROW","=>",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$e",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getCode",109],"(",")","]",";",["T_WHITESPACE","\n            ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getResponse",110],"(",")",["T_OBJECT_OPERATOR","->",110],["T_STRING","setBody",110],"(",["T_STRING","json_encode",110],"(",["T_VARIABLE","$result",110],")",")",";",["T_WHITESPACE","\n        ",110],"}",["T_WHITESPACE","\n    ",111],"}",["T_WHITESPACE","\n",112],"}",["T_WHITESPACE","\n",113]]