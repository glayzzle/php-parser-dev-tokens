[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n *\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",6],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Swatches",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Controller",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Ajax",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","App",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Action",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Context",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Controller",10],["T_NS_SEPARATOR","\\",10],["T_STRING","ResultFactory",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Catalog",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Model",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Product",11],";",["T_WHITESPACE","\n\n",11],["T_DOC_COMMENT","\/**\n * Class Media\n *\n * @package Magento\\Swatches\\Controller\\Ajax\n *\/",13],["T_WHITESPACE","\n",17],["T_CLASS","class",18],["T_WHITESPACE"," ",18],["T_STRING","Media",18],["T_WHITESPACE"," ",18],["T_EXTENDS","extends",18],["T_WHITESPACE"," ",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Magento",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Framework",18],["T_NS_SEPARATOR","\\",18],["T_STRING","App",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Action",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Action",18],["T_WHITESPACE","\n",18],"{",["T_WHITESPACE","\n    ",19],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Swatches\\Helper\\Data\n     *\/",20],["T_WHITESPACE","\n    ",22],["T_PROTECTED","protected",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$swatchHelper",23],";",["T_WHITESPACE","\n\n    ",23],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Catalog\\Model\\ProductFactory\n     *\/",25],["T_WHITESPACE","\n    ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$productModelFactory",28],";",["T_WHITESPACE","\n\n    ",28],["T_DOC_COMMENT","\/**\n     * @param Context $context\n     * @param \\Magento\\Swatches\\Helper\\Data $swatchHelper\n     * @param \\Magento\\Catalog\\Model\\ProductFactory $productModelFactory\n     *\/",30],["T_WHITESPACE","\n    ",34],["T_PUBLIC","public",35],["T_WHITESPACE"," ",35],["T_FUNCTION","function",35],["T_WHITESPACE"," ",35],["T_STRING","__construct",35],"(",["T_WHITESPACE","\n        ",35],["T_STRING","Context",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$context",36],",",["T_WHITESPACE","\n        ",36],["T_NS_SEPARATOR","\\",37],["T_STRING","Magento",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Swatches",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Helper",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Data",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$swatchHelper",37],",",["T_WHITESPACE","\n        ",37],["T_NS_SEPARATOR","\\",38],["T_STRING","Magento",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Catalog",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Model",38],["T_NS_SEPARATOR","\\",38],["T_STRING","ProductFactory",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$productModelFactory",38],["T_WHITESPACE","\n    ",38],")",["T_WHITESPACE"," ",39],"{",["T_WHITESPACE","\n        ",39],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","swatchHelper",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$swatchHelper",40],";",["T_WHITESPACE","\n        ",40],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","productModelFactory",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$productModelFactory",41],";",["T_WHITESPACE","\n\n        ",41],["T_STRING","parent",43],["T_DOUBLE_COLON","::",43],["T_STRING","__construct",43],"(",["T_VARIABLE","$context",43],")",";",["T_WHITESPACE","\n    ",43],"}",["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * Get product media by fallback:\n     * 1stly by default attribute values\n     * 2ndly by getting base image from configurable product\n     *\n     * @return string\n     *\/",46],["T_WHITESPACE","\n    ",52],["T_PUBLIC","public",53],["T_WHITESPACE"," ",53],["T_FUNCTION","function",53],["T_WHITESPACE"," ",53],["T_STRING","execute",53],"(",")",["T_WHITESPACE","\n    ",53],"{",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$productMedia",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],"[","]",";",["T_WHITESPACE","\n        ",55],["T_IF","if",56],["T_WHITESPACE"," ",56],"(",["T_VARIABLE","$productId",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_INT_CAST","(int)",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","getRequest",56],"(",")",["T_OBJECT_OPERATOR","->",56],["T_STRING","getParam",56],"(",["T_CONSTANT_ENCAPSED_STRING","'product_id'",56],")",")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n            ",56],["T_VARIABLE","$currentConfigurable",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","productModelFactory",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","create",57],"(",")",["T_OBJECT_OPERATOR","->",57],["T_STRING","load",57],"(",["T_VARIABLE","$productId",57],")",";",["T_WHITESPACE","\n            ",57],["T_VARIABLE","$attributes",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_ARRAY_CAST","(array)",58],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","getRequest",58],"(",")",["T_OBJECT_OPERATOR","->",58],["T_STRING","getParam",58],"(",["T_CONSTANT_ENCAPSED_STRING","'attributes'",58],")",";",["T_WHITESPACE","\n            ",58],["T_IF","if",59],["T_WHITESPACE"," ",59],"(","!",["T_EMPTY","empty",59],"(",["T_VARIABLE","$attributes",59],")",")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n                ",59],["T_VARIABLE","$product",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","getProductVariationWithMedia",60],"(",["T_VARIABLE","$currentConfigurable",60],",",["T_WHITESPACE"," ",60],["T_VARIABLE","$attributes",60],")",";",["T_WHITESPACE","\n            ",60],"}",["T_WHITESPACE","\n            ",61],["T_IF","if",62],["T_WHITESPACE"," ",62],"(","(",["T_EMPTY","empty",62],"(",["T_VARIABLE","$product",62],")",["T_WHITESPACE"," ",62],["T_BOOLEAN_OR","||",62],["T_WHITESPACE"," ",62],"(","!",["T_VARIABLE","$product",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","getImage",62],"(",")",["T_WHITESPACE"," ",62],["T_BOOLEAN_OR","||",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$product",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","getImage",62],"(",")",["T_WHITESPACE"," ",62],["T_IS_EQUAL","==",62],["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'no_selection'",62],")",")",["T_WHITESPACE","\n                ",62],["T_BOOLEAN_AND","&&",63],["T_WHITESPACE"," ",63],["T_ISSET","isset",63],"(",["T_VARIABLE","$currentConfigurable",63],")",["T_WHITESPACE","\n            ",63],")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n                ",64],["T_VARIABLE","$product",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$currentConfigurable",65],";",["T_WHITESPACE","\n            ",65],"}",["T_WHITESPACE","\n            ",66],["T_VARIABLE","$productMedia",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","swatchHelper",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getProductMediaGallery",67],"(",["T_VARIABLE","$product",67],")",";",["T_WHITESPACE","\n        ",67],"}",["T_WHITESPACE","\n\n        ",68],["T_DOC_COMMENT","\/** @var \\Magento\\Framework\\Controller\\Result\\Json $resultJson *\/",70],["T_WHITESPACE","\n        ",70],["T_VARIABLE","$resultJson",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","resultFactory",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","create",71],"(",["T_STRING","ResultFactory",71],["T_DOUBLE_COLON","::",71],["T_STRING","TYPE_JSON",71],")",";",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$resultJson",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","setData",72],"(",["T_VARIABLE","$productMedia",72],")",";",["T_WHITESPACE","\n        ",72],["T_RETURN","return",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$resultJson",73],";",["T_WHITESPACE","\n    ",73],"}",["T_WHITESPACE","\n\n    ",74],["T_PROTECTED","protected",76],["T_WHITESPACE"," ",76],["T_FUNCTION","function",76],["T_WHITESPACE"," ",76],["T_STRING","getProductVariationWithMedia",76],"(",["T_STRING","Product",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$currentConfigurable",76],",",["T_WHITESPACE"," ",76],["T_ARRAY","array",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$attributes",76],")",["T_WHITESPACE","\n    ",76],"{",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$product",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_STRING","null",78],";",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$layeredAttributes",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],"[","]",";",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$configurableAttributes",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","swatchHelper",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getAttributesFromConfigurable",80],"(",["T_VARIABLE","$currentConfigurable",80],")",";",["T_WHITESPACE","\n        ",80],["T_IF","if",81],["T_WHITESPACE"," ",81],"(",["T_VARIABLE","$configurableAttributes",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n            ",81],["T_VARIABLE","$layeredAttributes",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","getLayeredAttributesIfExists",82],"(",["T_VARIABLE","$configurableAttributes",82],")",";",["T_WHITESPACE","\n        ",82],"}",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$resultAttributes",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_STRING","array_merge",84],"(",["T_VARIABLE","$layeredAttributes",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$attributes",84],")",";",["T_WHITESPACE","\n\n        ",84],["T_VARIABLE","$product",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","swatchHelper",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","loadVariationByFallback",86],"(",["T_VARIABLE","$currentConfigurable",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$resultAttributes",86],")",";",["T_WHITESPACE","\n        ",86],["T_IF","if",87],["T_WHITESPACE"," ",87],"(","!",["T_VARIABLE","$product",87],["T_WHITESPACE"," ",87],["T_BOOLEAN_OR","||",87],["T_WHITESPACE"," ",87],"(","!",["T_VARIABLE","$product",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getImage",87],"(",")",["T_WHITESPACE"," ",87],["T_BOOLEAN_OR","||",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$product",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getImage",87],"(",")",["T_WHITESPACE"," ",87],["T_IS_EQUAL","==",87],["T_WHITESPACE"," ",87],["T_CONSTANT_ENCAPSED_STRING","'no_selection'",87],")",")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n            ",87],["T_VARIABLE","$product",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","swatchHelper",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","loadFirstVariationWithSwatchImage",88],"(",["T_VARIABLE","$currentConfigurable",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$resultAttributes",88],")",";",["T_WHITESPACE","\n        ",88],"}",["T_WHITESPACE","\n        ",89],["T_IF","if",90],["T_WHITESPACE"," ",90],"(","!",["T_VARIABLE","$product",90],")",["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n            ",90],["T_VARIABLE","$product",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","swatchHelper",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","loadFirstVariationWithImage",91],"(",["T_VARIABLE","$currentConfigurable",91],",",["T_WHITESPACE"," ",91],["T_VARIABLE","$resultAttributes",91],")",";",["T_WHITESPACE","\n        ",91],"}",["T_WHITESPACE","\n        ",92],["T_RETURN","return",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$product",93],";",["T_WHITESPACE","\n    ",93],"}",["T_WHITESPACE","\n\n    ",94],["T_DOC_COMMENT","\/**\n     * @param array $configurableAttributes\n     * @return array\n     *\/",96],["T_WHITESPACE","\n    ",99],["T_PROTECTED","protected",100],["T_WHITESPACE"," ",100],["T_FUNCTION","function",100],["T_WHITESPACE"," ",100],["T_STRING","getLayeredAttributesIfExists",100],"(",["T_ARRAY","array",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$configurableAttributes",100],")",["T_WHITESPACE","\n    ",100],"{",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$layeredAttributes",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],"[","]",";",["T_WHITESPACE","\n\n        ",102],["T_FOREACH","foreach",104],["T_WHITESPACE"," ",104],"(",["T_VARIABLE","$configurableAttributes",104],["T_WHITESPACE"," ",104],["T_AS","as",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$attribute",104],")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n            ",104],["T_IF","if",105],["T_WHITESPACE"," ",105],"(",["T_VARIABLE","$urlAdditional",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_ARRAY_CAST","(array)",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getRequest",105],"(",")",["T_OBJECT_OPERATOR","->",105],["T_STRING","getParam",105],"(",["T_CONSTANT_ENCAPSED_STRING","'additional'",105],")",")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n                ",105],["T_IF","if",106],["T_WHITESPACE"," ",106],"(",["T_STRING","array_key_exists",106],"(",["T_VARIABLE","$attribute",106],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_code'",106],"]",",",["T_WHITESPACE"," ",106],["T_VARIABLE","$urlAdditional",106],")",")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n                    ",106],["T_VARIABLE","$layeredAttributes",107],"[",["T_VARIABLE","$attribute",107],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_code'",107],"]","]",["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_VARIABLE","$urlAdditional",107],"[",["T_VARIABLE","$attribute",107],"[",["T_CONSTANT_ENCAPSED_STRING","'attribute_code'",107],"]","]",";",["T_WHITESPACE","\n                ",107],"}",["T_WHITESPACE","\n            ",108],"}",["T_WHITESPACE","\n        ",109],"}",["T_WHITESPACE","\n        ",110],["T_RETURN","return",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$layeredAttributes",111],";",["T_WHITESPACE","\n    ",111],"}",["T_WHITESPACE","\n",112],"}",["T_WHITESPACE","\n",113]]