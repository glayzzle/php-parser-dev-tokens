[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Swatches",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Plugin",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Class ProductImage replace original configurable product with first child\n *\/",8],["T_WHITESPACE","\n",10],["T_CLASS","class",11],["T_WHITESPACE"," ",11],["T_STRING","ProductImage",11],["T_WHITESPACE","\n",11],"{",["T_WHITESPACE","\n    ",12],["T_DOC_COMMENT","\/**\n     * Determine context of creation image block\n     * which defined in catalog\/product\/list.phtml\n     *\/",13],["T_WHITESPACE","\n    ",16],["T_CONST","const",17],["T_WHITESPACE"," ",17],["T_STRING","CATEGORY_PAGE_GRID_LOCATION",17],["T_WHITESPACE"," ",17],"=",["T_WHITESPACE"," ",17],["T_CONSTANT_ENCAPSED_STRING","'category_page_grid'",17],";",["T_WHITESPACE","\n    ",17],["T_CONST","const",18],["T_WHITESPACE"," ",18],["T_STRING","CATEGORY_PAGE_LIST_LOCATION",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],["T_CONSTANT_ENCAPSED_STRING","'category_page_list'",18],";",["T_WHITESPACE","\n\n    ",18],["T_DOC_COMMENT","\/**\n     * Data helper to get child product image\n     *\n     * @var \\Magento\\Swatches\\Helper\\Data $productHelper\n     *\/",20],["T_WHITESPACE","\n    ",24],["T_PROTECTED","protected",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$swatchHelperData",25],";",["T_WHITESPACE","\n\n    ",25],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Eav\\Model\\Config\n     *\/",27],["T_WHITESPACE","\n    ",29],["T_PROTECTED","protected",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$eavConfig",30],";",["T_WHITESPACE","\n\n    ",30],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\App\\Request\\Http\n     *\/",32],["T_WHITESPACE","\n    ",34],["T_PROTECTED","protected",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$request",35],";",["T_WHITESPACE","\n\n    ",35],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Swatches\\Helper\\Data $swatchesHelperData\n     * @param \\Magento\\Eav\\Model\\Config $eavConfig\n     * @param \\Magento\\Framework\\App\\Request\\Http $request\n     *\/",37],["T_WHITESPACE","\n    ",41],["T_PUBLIC","public",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","__construct",42],["T_WHITESPACE"," ",42],"(",["T_WHITESPACE","\n        ",42],["T_NS_SEPARATOR","\\",43],["T_STRING","Magento",43],["T_NS_SEPARATOR","\\",43],["T_STRING","Swatches",43],["T_NS_SEPARATOR","\\",43],["T_STRING","Helper",43],["T_NS_SEPARATOR","\\",43],["T_STRING","Data",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$swatchesHelperData",43],",",["T_WHITESPACE","\n        ",43],["T_NS_SEPARATOR","\\",44],["T_STRING","Magento",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Eav",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Model",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Config",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$eavConfig",44],",",["T_WHITESPACE","\n        ",44],["T_NS_SEPARATOR","\\",45],["T_STRING","Magento",45],["T_NS_SEPARATOR","\\",45],["T_STRING","Framework",45],["T_NS_SEPARATOR","\\",45],["T_STRING","App",45],["T_NS_SEPARATOR","\\",45],["T_STRING","Request",45],["T_NS_SEPARATOR","\\",45],["T_STRING","Http",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$request",45],["T_WHITESPACE","\n    ",45],")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n        ",46],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","swatchHelperData",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$swatchesHelperData",47],";",["T_WHITESPACE","\n        ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","eavConfig",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$eavConfig",48],";",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","request",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$request",49],";",["T_WHITESPACE","\n    ",49],"}",["T_WHITESPACE","\n\n    ",50],["T_DOC_COMMENT","\/**\n     * Replace original configurable product with first child\n     *\n     * @SuppressWarnings(PHPMD.UnusedFormalParameter)\n     * @param \\Magento\\Catalog\\Block\\Product\\AbstractProduct $subject\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @param string $location\n     * @param array $attributes\n     * @return array\n     *\/",52],["T_WHITESPACE","\n    ",61],["T_PUBLIC","public",62],["T_WHITESPACE"," ",62],["T_FUNCTION","function",62],["T_WHITESPACE"," ",62],["T_STRING","beforeGetImage",62],"(",["T_WHITESPACE","\n        ",62],["T_NS_SEPARATOR","\\",63],["T_STRING","Magento",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Catalog",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Block",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Product",63],["T_NS_SEPARATOR","\\",63],["T_STRING","AbstractProduct",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$subject",63],",",["T_WHITESPACE","\n        ",63],["T_NS_SEPARATOR","\\",64],["T_STRING","Magento",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Catalog",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Model",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Product",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$product",64],",",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$location",65],",",["T_WHITESPACE","\n        ",65],["T_ARRAY","array",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$attributes",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],"[","]",["T_WHITESPACE","\n    ",66],")",["T_WHITESPACE"," ",67],"{",["T_WHITESPACE","\n        ",67],["T_IF","if",68],["T_WHITESPACE"," ",68],"(",["T_VARIABLE","$product",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","getTypeId",68],"(",")",["T_WHITESPACE"," ",68],["T_IS_EQUAL","==",68],["T_WHITESPACE"," ",68],["T_NS_SEPARATOR","\\",68],["T_STRING","Magento",68],["T_NS_SEPARATOR","\\",68],["T_STRING","ConfigurableProduct",68],["T_NS_SEPARATOR","\\",68],["T_STRING","Model",68],["T_NS_SEPARATOR","\\",68],["T_STRING","Product",68],["T_NS_SEPARATOR","\\",68],["T_STRING","Type",68],["T_NS_SEPARATOR","\\",68],["T_STRING","Configurable",68],["T_DOUBLE_COLON","::",68],["T_STRING","TYPE_CODE",68],["T_WHITESPACE","\n            ",68],["T_BOOLEAN_AND","&&",69],["T_WHITESPACE"," ",69],"(",["T_VARIABLE","$location",69],["T_WHITESPACE"," ",69],["T_IS_EQUAL","==",69],["T_WHITESPACE"," ",69],["T_STRING","self",69],["T_DOUBLE_COLON","::",69],["T_STRING","CATEGORY_PAGE_GRID_LOCATION",69],["T_WHITESPACE"," ",69],["T_BOOLEAN_OR","||",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$location",69],["T_WHITESPACE"," ",69],["T_IS_EQUAL","==",69],["T_WHITESPACE"," ",69],["T_STRING","self",69],["T_DOUBLE_COLON","::",69],["T_STRING","CATEGORY_PAGE_LIST_LOCATION",69],")",")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n            ",69],["T_VARIABLE","$request",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","request",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getParams",70],"(",")",";",["T_WHITESPACE","\n            ",70],["T_IF","if",71],["T_WHITESPACE"," ",71],"(",["T_STRING","is_array",71],"(",["T_VARIABLE","$request",71],")",")",["T_WHITESPACE"," ",71],"{",["T_WHITESPACE","\n                ",71],["T_VARIABLE","$filterArray",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","getFilterArray",72],"(",["T_VARIABLE","$request",72],")",";",["T_WHITESPACE","\n                ",72],["T_IF","if",73],["T_WHITESPACE"," ",73],"(","!",["T_EMPTY","empty",73],"(",["T_VARIABLE","$filterArray",73],")",")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n                    ",73],["T_VARIABLE","$product",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","loadSimpleVariation",74],"(",["T_VARIABLE","$product",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$filterArray",74],")",";",["T_WHITESPACE","\n                ",74],"}",["T_WHITESPACE","\n            ",75],"}",["T_WHITESPACE","\n        ",76],"}",["T_WHITESPACE","\n        ",77],["T_RETURN","return",78],["T_WHITESPACE"," ",78],"[",["T_VARIABLE","$product",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$location",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$attributes",78],"]",";",["T_WHITESPACE","\n    ",78],"}",["T_WHITESPACE","\n\n    ",79],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Catalog\\Model\\Product $parentProduct\n     * @param array $filterArray\n     * @return bool|\\Magento\\Catalog\\Model\\Product\n     *\/",81],["T_WHITESPACE","\n    ",85],["T_PROTECTED","protected",86],["T_WHITESPACE"," ",86],["T_FUNCTION","function",86],["T_WHITESPACE"," ",86],["T_STRING","loadSimpleVariation",86],"(",["T_NS_SEPARATOR","\\",86],["T_STRING","Magento",86],["T_NS_SEPARATOR","\\",86],["T_STRING","Catalog",86],["T_NS_SEPARATOR","\\",86],["T_STRING","Model",86],["T_NS_SEPARATOR","\\",86],["T_STRING","Product",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$parentProduct",86],",",["T_WHITESPACE"," ",86],["T_ARRAY","array",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$filterArray",86],")",["T_WHITESPACE","\n    ",86],"{",["T_WHITESPACE","\n        ",87],["T_VARIABLE","$childProduct",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","swatchHelperData",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","loadVariationByFallback",88],"(",["T_VARIABLE","$parentProduct",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$filterArray",88],")",";",["T_WHITESPACE","\n        ",88],["T_IF","if",89],["T_WHITESPACE"," ",89],"(",["T_VARIABLE","$childProduct",89],["T_WHITESPACE"," ",89],["T_BOOLEAN_AND","&&",89],["T_WHITESPACE"," ",89],"!",["T_VARIABLE","$childProduct",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getImage",89],"(",")",")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n            ",89],["T_VARIABLE","$childProduct",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","swatchHelperData",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","loadFirstVariationWithImage",90],"(",["T_VARIABLE","$parentProduct",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$filterArray",90],")",";",["T_WHITESPACE","\n        ",90],"}",["T_WHITESPACE","\n        ",91],["T_IF","if",92],["T_WHITESPACE"," ",92],"(","!",["T_VARIABLE","$childProduct",92],")",["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n            ",92],["T_VARIABLE","$childProduct",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$parentProduct",93],";",["T_WHITESPACE","\n        ",93],"}",["T_WHITESPACE","\n        ",94],["T_RETURN","return",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$childProduct",95],";",["T_WHITESPACE","\n    ",95],"}",["T_WHITESPACE","\n\n    ",96],["T_DOC_COMMENT","\/**\n     * Get filters from request\n     *\n     * @param array $request\n     * @return array\n     *\/",98],["T_WHITESPACE","\n    ",103],["T_PROTECTED","protected",104],["T_WHITESPACE"," ",104],["T_FUNCTION","function",104],["T_WHITESPACE"," ",104],["T_STRING","getFilterArray",104],"(",["T_ARRAY","array",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$request",104],")",["T_WHITESPACE","\n    ",104],"{",["T_WHITESPACE","\n        ",105],["T_VARIABLE","$filterArray",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],"[","]",";",["T_WHITESPACE","\n        ",106],["T_VARIABLE","$attributeCodes",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","eavConfig",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","getEntityAttributeCodes",107],"(",["T_NS_SEPARATOR","\\",107],["T_STRING","Magento",107],["T_NS_SEPARATOR","\\",107],["T_STRING","Catalog",107],["T_NS_SEPARATOR","\\",107],["T_STRING","Model",107],["T_NS_SEPARATOR","\\",107],["T_STRING","Product",107],["T_DOUBLE_COLON","::",107],["T_STRING","ENTITY",107],")",";",["T_WHITESPACE","\n        ",107],["T_FOREACH","foreach",108],["T_WHITESPACE"," ",108],"(",["T_VARIABLE","$request",108],["T_WHITESPACE"," ",108],["T_AS","as",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$code",108],["T_WHITESPACE"," ",108],["T_DOUBLE_ARROW","=>",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$value",108],")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n            ",108],["T_IF","if",109],["T_WHITESPACE"," ",109],"(",["T_STRING","in_array",109],"(",["T_VARIABLE","$code",109],",",["T_WHITESPACE"," ",109],["T_VARIABLE","$attributeCodes",109],")",")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n                ",109],["T_VARIABLE","$attribute",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","eavConfig",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getAttribute",110],"(",["T_NS_SEPARATOR","\\",110],["T_STRING","Magento",110],["T_NS_SEPARATOR","\\",110],["T_STRING","Catalog",110],["T_NS_SEPARATOR","\\",110],["T_STRING","Model",110],["T_NS_SEPARATOR","\\",110],["T_STRING","Product",110],["T_DOUBLE_COLON","::",110],["T_STRING","ENTITY",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$code",110],")",";",["T_WHITESPACE","\n                ",110],["T_IF","if",111],["T_WHITESPACE"," ",111],"(",["T_VARIABLE","$attribute",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","getId",111],"(",")",["T_WHITESPACE"," ",111],["T_BOOLEAN_AND","&&",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","canReplaceImageWithSwatch",111],"(",["T_VARIABLE","$attribute",111],")",")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n                    ",111],["T_VARIABLE","$filterArray",112],"[",["T_VARIABLE","$code",112],"]",["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$value",112],";",["T_WHITESPACE","\n                ",112],"}",["T_WHITESPACE","\n            ",113],"}",["T_WHITESPACE","\n        ",114],"}",["T_WHITESPACE","\n        ",115],["T_RETURN","return",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$filterArray",116],";",["T_WHITESPACE","\n    ",116],"}",["T_WHITESPACE","\n\n    ",117],["T_DOC_COMMENT","\/**\n     * Check if we can replace original image with swatch image on catalog\/category\/list page\n     *\n     * @param \\Magento\\Catalog\\Model\\ResourceModel\\Eav\\Attribute $attribute\n     * @return bool\n     *\/",119],["T_WHITESPACE","\n    ",124],["T_PROTECTED","protected",125],["T_WHITESPACE"," ",125],["T_FUNCTION","function",125],["T_WHITESPACE"," ",125],["T_STRING","canReplaceImageWithSwatch",125],"(",["T_VARIABLE","$attribute",125],")",["T_WHITESPACE","\n    ",125],"{",["T_WHITESPACE","\n        ",126],["T_VARIABLE","$result",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_STRING","true",127],";",["T_WHITESPACE","\n        ",127],["T_IF","if",128],["T_WHITESPACE"," ",128],"(","!",["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","swatchHelperData",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","isSwatchAttribute",128],"(",["T_VARIABLE","$attribute",128],")",")",["T_WHITESPACE"," ",128],"{",["T_WHITESPACE","\n            ",128],["T_VARIABLE","$result",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_STRING","false",129],";",["T_WHITESPACE","\n        ",129],"}",["T_WHITESPACE","\n\n        ",130],["T_IF","if",132],["T_WHITESPACE"," ",132],"(","!",["T_VARIABLE","$attribute",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","getUsedInProductListing",132],"(",")",["T_WHITESPACE","\n            ",132],["T_BOOLEAN_OR","||",133],["T_WHITESPACE"," ",133],"!",["T_VARIABLE","$attribute",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getIsFilterable",133],"(",")",["T_WHITESPACE","\n            ",133],["T_BOOLEAN_OR","||",134],["T_WHITESPACE"," ",134],"!",["T_VARIABLE","$attribute",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","getData",134],"(",["T_CONSTANT_ENCAPSED_STRING","'update_product_preview_image'",134],")",["T_WHITESPACE","\n        ",134],")",["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n            ",135],["T_VARIABLE","$result",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_STRING","false",136],";",["T_WHITESPACE","\n        ",136],"}",["T_WHITESPACE","\n\n        ",137],["T_RETURN","return",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$result",139],";",["T_WHITESPACE","\n    ",139],"}",["T_WHITESPACE","\n",140],"}",["T_WHITESPACE","\n",141]]