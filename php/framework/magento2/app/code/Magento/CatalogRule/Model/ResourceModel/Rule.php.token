[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Catalog rules resource model\n *\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",7],["T_WHITESPACE","\n",11],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","CatalogRule",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Model",12],["T_NS_SEPARATOR","\\",12],["T_STRING","ResourceModel",12],";",["T_WHITESPACE","\n\n",12],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Catalog",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Model",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Product",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Magento",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Framework",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Model",15],["T_NS_SEPARATOR","\\",15],["T_STRING","AbstractModel",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Magento",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Framework",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Pricing",16],["T_NS_SEPARATOR","\\",16],["T_STRING","PriceCurrencyInterface",16],";",["T_WHITESPACE","\n\n",16],["T_DOC_COMMENT","\/**\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",18],["T_WHITESPACE","\n",20],["T_CLASS","class",21],["T_WHITESPACE"," ",21],["T_STRING","Rule",21],["T_WHITESPACE"," ",21],["T_EXTENDS","extends",21],["T_WHITESPACE"," ",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Magento",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Rule",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Model",21],["T_NS_SEPARATOR","\\",21],["T_STRING","ResourceModel",21],["T_NS_SEPARATOR","\\",21],["T_STRING","AbstractResource",21],["T_WHITESPACE","\n",21],"{",["T_WHITESPACE","\n    ",22],["T_DOC_COMMENT","\/**\n     * Store number of seconds in a day\n     *\/",23],["T_WHITESPACE","\n    ",25],["T_CONST","const",26],["T_WHITESPACE"," ",26],["T_STRING","SECONDS_IN_DAY",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_LNUMBER","86400",26],";",["T_WHITESPACE","\n\n    ",26],["T_DOC_COMMENT","\/**\n     * @var \\Psr\\Log\\LoggerInterface\n     *\/",28],["T_WHITESPACE","\n    ",30],["T_PROTECTED","protected",31],["T_WHITESPACE"," ",31],["T_VARIABLE","$_logger",31],";",["T_WHITESPACE","\n\n    ",31],["T_DOC_COMMENT","\/**\n     * Catalog rule data\n     *\n     * @var \\Magento\\CatalogRule\\Helper\\Data\n     *\/",33],["T_WHITESPACE","\n    ",37],["T_PROTECTED","protected",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$_catalogRuleData",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_STRING","null",38],";",["T_WHITESPACE","\n\n    ",38],["T_DOC_COMMENT","\/**\n     * Core event manager proxy\n     *\n     * @var \\Magento\\Framework\\Event\\ManagerInterface\n     *\/",40],["T_WHITESPACE","\n    ",44],["T_PROTECTED","protected",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$_eventManager",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_STRING","null",45],";",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Eav\\Model\\Config\n     *\/",47],["T_WHITESPACE","\n    ",49],["T_PROTECTED","protected",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$_eavConfig",50],";",["T_WHITESPACE","\n\n    ",50],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Stdlib\\DateTime\\DateTime\n     *\/",52],["T_WHITESPACE","\n    ",54],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$_coreDate",55],";",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Catalog\\Model\\Product\\ConditionFactory\n     *\/",57],["T_WHITESPACE","\n    ",59],["T_PROTECTED","protected",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$_conditionFactory",60],";",["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Store\\Model\\StoreManagerInterface\n     *\/",62],["T_WHITESPACE","\n    ",64],["T_PROTECTED","protected",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$_storeManager",65],";",["T_WHITESPACE","\n\n    ",65],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Stdlib\\DateTime\n     *\/",67],["T_WHITESPACE","\n    ",69],["T_PROTECTED","protected",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$dateTime",70],";",["T_WHITESPACE","\n\n    ",70],["T_DOC_COMMENT","\/**\n     * @var PriceCurrencyInterface\n     *\/",72],["T_WHITESPACE","\n    ",74],["T_PROTECTED","protected",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$priceCurrency",75],";",["T_WHITESPACE","\n\n    ",75],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\EntityManager\\EntityManager\n     *\/",77],["T_WHITESPACE","\n    ",79],["T_PROTECTED","protected",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$entityManager",80],";",["T_WHITESPACE","\n\n    ",80],["T_DOC_COMMENT","\/**\n     * Rule constructor.\n     * @param \\Magento\\Framework\\Model\\ResourceModel\\Db\\Context $context\n     * @param \\Magento\\Store\\Model\\StoreManagerInterface $storeManager\n     * @param Product\\ConditionFactory $conditionFactory\n     * @param \\Magento\\Framework\\Stdlib\\DateTime\\DateTime $coreDate\n     * @param \\Magento\\Eav\\Model\\Config $eavConfig\n     * @param \\Magento\\Framework\\Event\\ManagerInterface $eventManager\n     * @param \\Magento\\CatalogRule\\Helper\\Data $catalogRuleData\n     * @param \\Psr\\Log\\LoggerInterface $logger\n     * @param \\Magento\\Framework\\Stdlib\\DateTime $dateTime\n     * @param PriceCurrencyInterface $priceCurrency\n     * @param null $connectionName\n     * @SuppressWarnings(PHPMD.ExcessiveParameterList)\n     *\/",82],["T_WHITESPACE","\n    ",96],["T_PUBLIC","public",97],["T_WHITESPACE"," ",97],["T_FUNCTION","function",97],["T_WHITESPACE"," ",97],["T_STRING","__construct",97],"(",["T_WHITESPACE","\n        ",97],["T_NS_SEPARATOR","\\",98],["T_STRING","Magento",98],["T_NS_SEPARATOR","\\",98],["T_STRING","Framework",98],["T_NS_SEPARATOR","\\",98],["T_STRING","Model",98],["T_NS_SEPARATOR","\\",98],["T_STRING","ResourceModel",98],["T_NS_SEPARATOR","\\",98],["T_STRING","Db",98],["T_NS_SEPARATOR","\\",98],["T_STRING","Context",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$context",98],",",["T_WHITESPACE","\n        ",98],["T_NS_SEPARATOR","\\",99],["T_STRING","Magento",99],["T_NS_SEPARATOR","\\",99],["T_STRING","Store",99],["T_NS_SEPARATOR","\\",99],["T_STRING","Model",99],["T_NS_SEPARATOR","\\",99],["T_STRING","StoreManagerInterface",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$storeManager",99],",",["T_WHITESPACE","\n        ",99],["T_NS_SEPARATOR","\\",100],["T_STRING","Magento",100],["T_NS_SEPARATOR","\\",100],["T_STRING","Catalog",100],["T_NS_SEPARATOR","\\",100],["T_STRING","Model",100],["T_NS_SEPARATOR","\\",100],["T_STRING","Product",100],["T_NS_SEPARATOR","\\",100],["T_STRING","ConditionFactory",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$conditionFactory",100],",",["T_WHITESPACE","\n        ",100],["T_NS_SEPARATOR","\\",101],["T_STRING","Magento",101],["T_NS_SEPARATOR","\\",101],["T_STRING","Framework",101],["T_NS_SEPARATOR","\\",101],["T_STRING","Stdlib",101],["T_NS_SEPARATOR","\\",101],["T_STRING","DateTime",101],["T_NS_SEPARATOR","\\",101],["T_STRING","DateTime",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$coreDate",101],",",["T_WHITESPACE","\n        ",101],["T_NS_SEPARATOR","\\",102],["T_STRING","Magento",102],["T_NS_SEPARATOR","\\",102],["T_STRING","Eav",102],["T_NS_SEPARATOR","\\",102],["T_STRING","Model",102],["T_NS_SEPARATOR","\\",102],["T_STRING","Config",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$eavConfig",102],",",["T_WHITESPACE","\n        ",102],["T_NS_SEPARATOR","\\",103],["T_STRING","Magento",103],["T_NS_SEPARATOR","\\",103],["T_STRING","Framework",103],["T_NS_SEPARATOR","\\",103],["T_STRING","Event",103],["T_NS_SEPARATOR","\\",103],["T_STRING","ManagerInterface",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$eventManager",103],",",["T_WHITESPACE","\n        ",103],["T_NS_SEPARATOR","\\",104],["T_STRING","Magento",104],["T_NS_SEPARATOR","\\",104],["T_STRING","CatalogRule",104],["T_NS_SEPARATOR","\\",104],["T_STRING","Helper",104],["T_NS_SEPARATOR","\\",104],["T_STRING","Data",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$catalogRuleData",104],",",["T_WHITESPACE","\n        ",104],["T_NS_SEPARATOR","\\",105],["T_STRING","Psr",105],["T_NS_SEPARATOR","\\",105],["T_STRING","Log",105],["T_NS_SEPARATOR","\\",105],["T_STRING","LoggerInterface",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$logger",105],",",["T_WHITESPACE","\n        ",105],["T_NS_SEPARATOR","\\",106],["T_STRING","Magento",106],["T_NS_SEPARATOR","\\",106],["T_STRING","Framework",106],["T_NS_SEPARATOR","\\",106],["T_STRING","Stdlib",106],["T_NS_SEPARATOR","\\",106],["T_STRING","DateTime",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$dateTime",106],",",["T_WHITESPACE","\n        ",106],["T_STRING","PriceCurrencyInterface",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$priceCurrency",107],",",["T_WHITESPACE","\n        ",107],["T_VARIABLE","$connectionName",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_STRING","null",108],["T_WHITESPACE","\n    ",108],")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n        ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","_storeManager",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$storeManager",110],";",["T_WHITESPACE","\n        ",110],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","_conditionFactory",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_VARIABLE","$conditionFactory",111],";",["T_WHITESPACE","\n        ",111],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","_coreDate",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$coreDate",112],";",["T_WHITESPACE","\n        ",112],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","_eavConfig",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_VARIABLE","$eavConfig",113],";",["T_WHITESPACE","\n        ",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","_eventManager",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_VARIABLE","$eventManager",114],";",["T_WHITESPACE","\n        ",114],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","_catalogRuleData",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$catalogRuleData",115],";",["T_WHITESPACE","\n        ",115],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","_logger",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_VARIABLE","$logger",116],";",["T_WHITESPACE","\n        ",116],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","dateTime",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_VARIABLE","$dateTime",117],";",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","priceCurrency",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$priceCurrency",118],";",["T_WHITESPACE","\n        ",118],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_associatedEntitiesMap",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getAssociatedEntitiesMap",119],"(",")",";",["T_WHITESPACE","\n        ",119],["T_STRING","parent",120],["T_DOUBLE_COLON","::",120],["T_STRING","__construct",120],"(",["T_VARIABLE","$context",120],",",["T_WHITESPACE"," ",120],["T_VARIABLE","$connectionName",120],")",";",["T_WHITESPACE","\n    ",120],"}",["T_WHITESPACE","\n\n    ",121],["T_DOC_COMMENT","\/**\n     * Initialize main table and table id field\n     *\n     * @return void\n     * @codeCoverageIgnore\n     *\/",123],["T_WHITESPACE","\n    ",128],["T_PROTECTED","protected",129],["T_WHITESPACE"," ",129],["T_FUNCTION","function",129],["T_WHITESPACE"," ",129],["T_STRING","_construct",129],"(",")",["T_WHITESPACE","\n    ",129],"{",["T_WHITESPACE","\n        ",130],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","_init",131],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogrule'",131],",",["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","'rule_id'",131],")",";",["T_WHITESPACE","\n    ",131],"}",["T_WHITESPACE","\n\n    ",132],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\Model\\AbstractModel $rule\n     * @return $this\n     *\/",134],["T_WHITESPACE","\n    ",137],["T_PROTECTED","protected",138],["T_WHITESPACE"," ",138],["T_FUNCTION","function",138],["T_WHITESPACE"," ",138],["T_STRING","_afterDelete",138],"(",["T_NS_SEPARATOR","\\",138],["T_STRING","Magento",138],["T_NS_SEPARATOR","\\",138],["T_STRING","Framework",138],["T_NS_SEPARATOR","\\",138],["T_STRING","Model",138],["T_NS_SEPARATOR","\\",138],["T_STRING","AbstractModel",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$rule",138],")",["T_WHITESPACE","\n    ",138],"{",["T_WHITESPACE","\n        ",139],["T_VARIABLE","$connection",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","getConnection",140],"(",")",";",["T_WHITESPACE","\n        ",140],["T_VARIABLE","$connection",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","delete",141],"(",["T_WHITESPACE","\n            ",141],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","getTable",142],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogrule_product'",142],")",",",["T_WHITESPACE","\n            ",142],"[",["T_CONSTANT_ENCAPSED_STRING","'rule_id=?'",143],["T_WHITESPACE"," ",143],["T_DOUBLE_ARROW","=>",143],["T_WHITESPACE"," ",143],["T_VARIABLE","$rule",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getId",143],"(",")","]",["T_WHITESPACE","\n        ",143],")",";",["T_WHITESPACE","\n        ",144],["T_VARIABLE","$connection",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","delete",145],"(",["T_WHITESPACE","\n            ",145],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","getTable",146],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogrule_group_website'",146],")",",",["T_WHITESPACE","\n            ",146],"[",["T_CONSTANT_ENCAPSED_STRING","'rule_id=?'",147],["T_WHITESPACE"," ",147],["T_DOUBLE_ARROW","=>",147],["T_WHITESPACE"," ",147],["T_VARIABLE","$rule",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","getId",147],"(",")","]",["T_WHITESPACE","\n        ",147],")",";",["T_WHITESPACE","\n        ",148],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_STRING","parent",149],["T_DOUBLE_COLON","::",149],["T_STRING","_afterDelete",149],"(",["T_VARIABLE","$rule",149],")",";",["T_WHITESPACE","\n    ",149],"}",["T_WHITESPACE","\n\n    ",150],["T_DOC_COMMENT","\/**\n     * Get catalog rules product price for specific date, website and\n     * customer group\n     *\n     * @param \\DateTime $date\n     * @param int $wId\n     * @param int $gId\n     * @param int $pId\n     * @return float|false\n     *\/",152],["T_WHITESPACE","\n    ",161],["T_PUBLIC","public",162],["T_WHITESPACE"," ",162],["T_FUNCTION","function",162],["T_WHITESPACE"," ",162],["T_STRING","getRulePrice",162],"(",["T_VARIABLE","$date",162],",",["T_WHITESPACE"," ",162],["T_VARIABLE","$wId",162],",",["T_WHITESPACE"," ",162],["T_VARIABLE","$gId",162],",",["T_WHITESPACE"," ",162],["T_VARIABLE","$pId",162],")",["T_WHITESPACE","\n    ",162],"{",["T_WHITESPACE","\n        ",163],["T_VARIABLE","$data",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","getRulePrices",164],"(",["T_VARIABLE","$date",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$wId",164],",",["T_WHITESPACE"," ",164],["T_VARIABLE","$gId",164],",",["T_WHITESPACE"," ",164],"[",["T_VARIABLE","$pId",164],"]",")",";",["T_WHITESPACE","\n        ",164],["T_IF","if",165],["T_WHITESPACE"," ",165],"(",["T_ISSET","isset",165],"(",["T_VARIABLE","$data",165],"[",["T_VARIABLE","$pId",165],"]",")",")",["T_WHITESPACE"," ",165],"{",["T_WHITESPACE","\n            ",165],["T_RETURN","return",166],["T_WHITESPACE"," ",166],["T_VARIABLE","$data",166],"[",["T_VARIABLE","$pId",166],"]",";",["T_WHITESPACE","\n        ",166],"}",["T_WHITESPACE","\n\n        ",167],["T_RETURN","return",169],["T_WHITESPACE"," ",169],["T_STRING","false",169],";",["T_WHITESPACE","\n    ",169],"}",["T_WHITESPACE","\n\n    ",170],["T_DOC_COMMENT","\/**\n     * Retrieve product prices by catalog rule for specific date, website and customer group\n     * Collect data with  product Id => price pairs\n     *\n     * @param \\DateTime $date\n     * @param int $websiteId\n     * @param int $customerGroupId\n     * @param array $productIds\n     * @return array\n     *\/",172],["T_WHITESPACE","\n    ",181],["T_PUBLIC","public",182],["T_WHITESPACE"," ",182],["T_FUNCTION","function",182],["T_WHITESPACE"," ",182],["T_STRING","getRulePrices",182],"(",["T_NS_SEPARATOR","\\",182],["T_STRING","DateTime",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$date",182],",",["T_WHITESPACE"," ",182],["T_VARIABLE","$websiteId",182],",",["T_WHITESPACE"," ",182],["T_VARIABLE","$customerGroupId",182],",",["T_WHITESPACE"," ",182],["T_VARIABLE","$productIds",182],")",["T_WHITESPACE","\n    ",182],"{",["T_WHITESPACE","\n        ",183],["T_VARIABLE","$connection",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getConnection",184],"(",")",";",["T_WHITESPACE","\n        ",184],["T_VARIABLE","$select",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_VARIABLE","$connection",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","select",185],"(",")",["T_WHITESPACE","\n            ",185],["T_OBJECT_OPERATOR","->",186],["T_STRING","from",186],"(",["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","getTable",186],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogrule_product_price'",186],")",",",["T_WHITESPACE"," ",186],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",186],",",["T_WHITESPACE"," ",186],["T_CONSTANT_ENCAPSED_STRING","'rule_price'",186],"]",")",["T_WHITESPACE","\n            ",186],["T_OBJECT_OPERATOR","->",187],["T_STRING","where",187],"(",["T_CONSTANT_ENCAPSED_STRING","'rule_date = ?'",187],",",["T_WHITESPACE"," ",187],["T_VARIABLE","$date",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","format",187],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d'",187],")",")",["T_WHITESPACE","\n            ",187],["T_OBJECT_OPERATOR","->",188],["T_STRING","where",188],"(",["T_CONSTANT_ENCAPSED_STRING","'website_id = ?'",188],",",["T_WHITESPACE"," ",188],["T_VARIABLE","$websiteId",188],")",["T_WHITESPACE","\n            ",188],["T_OBJECT_OPERATOR","->",189],["T_STRING","where",189],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_group_id = ?'",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$customerGroupId",189],")",["T_WHITESPACE","\n            ",189],["T_OBJECT_OPERATOR","->",190],["T_STRING","where",190],"(",["T_CONSTANT_ENCAPSED_STRING","'product_id IN(?)'",190],",",["T_WHITESPACE"," ",190],["T_VARIABLE","$productIds",190],")",";",["T_WHITESPACE","\n\n        ",190],["T_RETURN","return",192],["T_WHITESPACE"," ",192],["T_VARIABLE","$connection",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","fetchPairs",192],"(",["T_VARIABLE","$select",192],")",";",["T_WHITESPACE","\n    ",192],"}",["T_WHITESPACE","\n\n    ",193],["T_DOC_COMMENT","\/**\n     * Get active rule data based on few filters\n     *\n     * @param int|string $date\n     * @param int $websiteId\n     * @param int $customerGroupId\n     * @param int $productId\n     * @return array\n     *\/",195],["T_WHITESPACE","\n    ",203],["T_PUBLIC","public",204],["T_WHITESPACE"," ",204],["T_FUNCTION","function",204],["T_WHITESPACE"," ",204],["T_STRING","getRulesFromProduct",204],"(",["T_VARIABLE","$date",204],",",["T_WHITESPACE"," ",204],["T_VARIABLE","$websiteId",204],",",["T_WHITESPACE"," ",204],["T_VARIABLE","$customerGroupId",204],",",["T_WHITESPACE"," ",204],["T_VARIABLE","$productId",204],")",["T_WHITESPACE","\n    ",204],"{",["T_WHITESPACE","\n        ",205],["T_VARIABLE","$connection",206],["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","getConnection",206],"(",")",";",["T_WHITESPACE","\n        ",206],["T_IF","if",207],["T_WHITESPACE"," ",207],"(",["T_STRING","is_string",207],"(",["T_VARIABLE","$date",207],")",")",["T_WHITESPACE"," ",207],"{",["T_WHITESPACE","\n            ",207],["T_VARIABLE","$date",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_STRING","strtotime",208],"(",["T_VARIABLE","$date",208],")",";",["T_WHITESPACE","\n        ",208],"}",["T_WHITESPACE","\n        ",209],["T_VARIABLE","$select",210],["T_WHITESPACE"," ",210],"=",["T_WHITESPACE"," ",210],["T_VARIABLE","$connection",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","select",210],"(",")",["T_WHITESPACE","\n            ",210],["T_OBJECT_OPERATOR","->",211],["T_STRING","from",211],"(",["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","getTable",211],"(",["T_CONSTANT_ENCAPSED_STRING","'catalogrule_product'",211],")",")",["T_WHITESPACE","\n            ",211],["T_OBJECT_OPERATOR","->",212],["T_STRING","where",212],"(",["T_CONSTANT_ENCAPSED_STRING","'website_id = ?'",212],",",["T_WHITESPACE"," ",212],["T_VARIABLE","$websiteId",212],")",["T_WHITESPACE","\n            ",212],["T_OBJECT_OPERATOR","->",213],["T_STRING","where",213],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_group_id = ?'",213],",",["T_WHITESPACE"," ",213],["T_VARIABLE","$customerGroupId",213],")",["T_WHITESPACE","\n            ",213],["T_OBJECT_OPERATOR","->",214],["T_STRING","where",214],"(",["T_CONSTANT_ENCAPSED_STRING","'product_id = ?'",214],",",["T_WHITESPACE"," ",214],["T_VARIABLE","$productId",214],")",["T_WHITESPACE","\n            ",214],["T_OBJECT_OPERATOR","->",215],["T_STRING","where",215],"(",["T_CONSTANT_ENCAPSED_STRING","'from_time = 0 or from_time < ?'",215],",",["T_WHITESPACE"," ",215],["T_VARIABLE","$date",215],")",["T_WHITESPACE","\n            ",215],["T_OBJECT_OPERATOR","->",216],["T_STRING","where",216],"(",["T_CONSTANT_ENCAPSED_STRING","'to_time = 0 or to_time > ?'",216],",",["T_WHITESPACE"," ",216],["T_VARIABLE","$date",216],")",";",["T_WHITESPACE","\n\n        ",216],["T_RETURN","return",218],["T_WHITESPACE"," ",218],["T_VARIABLE","$connection",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","fetchAll",218],"(",["T_VARIABLE","$select",218],")",";",["T_WHITESPACE","\n    ",218],"}",["T_WHITESPACE","\n\n    ",219],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\Model\\AbstractModel $object\n     * @param mixed $value\n     * @param string $field\n     * @return $this\n     * @SuppressWarnings(PHPMD.UnusedFormalParameter)\n     *\/",221],["T_WHITESPACE","\n    ",227],["T_PUBLIC","public",228],["T_WHITESPACE"," ",228],["T_FUNCTION","function",228],["T_WHITESPACE"," ",228],["T_STRING","load",228],"(",["T_NS_SEPARATOR","\\",228],["T_STRING","Magento",228],["T_NS_SEPARATOR","\\",228],["T_STRING","Framework",228],["T_NS_SEPARATOR","\\",228],["T_STRING","Model",228],["T_NS_SEPARATOR","\\",228],["T_STRING","AbstractModel",228],["T_WHITESPACE"," ",228],["T_VARIABLE","$object",228],",",["T_WHITESPACE"," ",228],["T_VARIABLE","$value",228],",",["T_WHITESPACE"," ",228],["T_VARIABLE","$field",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],["T_STRING","null",228],")",["T_WHITESPACE","\n    ",228],"{",["T_WHITESPACE","\n        ",229],["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","getEntityManager",230],"(",")",["T_OBJECT_OPERATOR","->",230],["T_STRING","load",230],"(",["T_VARIABLE","$object",230],",",["T_WHITESPACE"," ",230],["T_VARIABLE","$value",230],")",";",["T_WHITESPACE","\n        ",230],["T_RETURN","return",231],["T_WHITESPACE"," ",231],["T_VARIABLE","$this",231],";",["T_WHITESPACE","\n    ",231],"}",["T_WHITESPACE","\n\n    ",232],["T_DOC_COMMENT","\/**\n     * @param AbstractModel $object\n     * @return $this\n     * @throws \\Exception\n     *\/",234],["T_WHITESPACE","\n    ",238],["T_PUBLIC","public",239],["T_WHITESPACE"," ",239],["T_FUNCTION","function",239],["T_WHITESPACE"," ",239],["T_STRING","save",239],"(",["T_NS_SEPARATOR","\\",239],["T_STRING","Magento",239],["T_NS_SEPARATOR","\\",239],["T_STRING","Framework",239],["T_NS_SEPARATOR","\\",239],["T_STRING","Model",239],["T_NS_SEPARATOR","\\",239],["T_STRING","AbstractModel",239],["T_WHITESPACE"," ",239],["T_VARIABLE","$object",239],")",["T_WHITESPACE","\n    ",239],"{",["T_WHITESPACE","\n        ",240],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","getEntityManager",241],"(",")",["T_OBJECT_OPERATOR","->",241],["T_STRING","save",241],"(",["T_VARIABLE","$object",241],")",";",["T_WHITESPACE","\n        ",241],["T_RETURN","return",242],["T_WHITESPACE"," ",242],["T_VARIABLE","$this",242],";",["T_WHITESPACE","\n    ",242],"}",["T_WHITESPACE","\n\n    ",243],["T_DOC_COMMENT","\/**\n     * Delete the object\n     *\n     * @param \\Magento\\Framework\\Model\\AbstractModel $object\n     * @return $this\n     * @throws \\Exception\n     *\/",245],["T_WHITESPACE","\n    ",251],["T_PUBLIC","public",252],["T_WHITESPACE"," ",252],["T_FUNCTION","function",252],["T_WHITESPACE"," ",252],["T_STRING","delete",252],"(",["T_STRING","AbstractModel",252],["T_WHITESPACE"," ",252],["T_VARIABLE","$object",252],")",["T_WHITESPACE","\n    ",252],"{",["T_WHITESPACE","\n        ",253],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","getEntityManager",254],"(",")",["T_OBJECT_OPERATOR","->",254],["T_STRING","delete",254],"(",["T_VARIABLE","$object",254],")",";",["T_WHITESPACE","\n        ",254],["T_RETURN","return",255],["T_WHITESPACE"," ",255],["T_VARIABLE","$this",255],";",["T_WHITESPACE","\n    ",255],"}",["T_WHITESPACE","\n\n    ",256],["T_DOC_COMMENT","\/**\n     * @return array\n     * @deprecated\n     *\/",258],["T_WHITESPACE","\n    ",261],["T_PRIVATE","private",262],["T_WHITESPACE"," ",262],["T_FUNCTION","function",262],["T_WHITESPACE"," ",262],["T_STRING","getAssociatedEntitiesMap",262],"(",")",["T_WHITESPACE","\n    ",262],"{",["T_WHITESPACE","\n        ",263],["T_IF","if",264],["T_WHITESPACE"," ",264],"(","!",["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","_associatedEntitiesMap",264],")",["T_WHITESPACE"," ",264],"{",["T_WHITESPACE","\n            ",264],["T_VARIABLE","$this",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","_associatedEntitiesMap",265],["T_WHITESPACE"," ",265],"=",["T_WHITESPACE"," ",265],["T_NS_SEPARATOR","\\",265],["T_STRING","Magento",265],["T_NS_SEPARATOR","\\",265],["T_STRING","Framework",265],["T_NS_SEPARATOR","\\",265],["T_STRING","App",265],["T_NS_SEPARATOR","\\",265],["T_STRING","ObjectManager",265],["T_DOUBLE_COLON","::",265],["T_STRING","getInstance",265],"(",")",["T_WHITESPACE","\n                ",265],["T_OBJECT_OPERATOR","->",266],["T_STRING","get",266],"(",["T_NS_SEPARATOR","\\",266],["T_STRING","Magento",266],["T_NS_SEPARATOR","\\",266],["T_STRING","CatalogRule",266],["T_NS_SEPARATOR","\\",266],["T_STRING","Model",266],["T_NS_SEPARATOR","\\",266],["T_STRING","ResourceModel",266],["T_NS_SEPARATOR","\\",266],["T_STRING","Rule",266],["T_NS_SEPARATOR","\\",266],["T_STRING","AssociatedEntityMap",266],["T_DOUBLE_COLON","::",266],["T_CLASS","class",266],")",["T_WHITESPACE","\n                ",266],["T_OBJECT_OPERATOR","->",267],["T_STRING","getData",267],"(",")",";",["T_WHITESPACE","\n        ",267],"}",["T_WHITESPACE","\n        ",268],["T_RETURN","return",269],["T_WHITESPACE"," ",269],["T_VARIABLE","$this",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","_associatedEntitiesMap",269],";",["T_WHITESPACE","\n    ",269],"}",["T_WHITESPACE","\n\n    ",270],["T_DOC_COMMENT","\/**\n     * @return \\Magento\\Framework\\EntityManager\\EntityManager\n     * @deprecated\n     *\/",272],["T_WHITESPACE","\n    ",275],["T_PRIVATE","private",276],["T_WHITESPACE"," ",276],["T_FUNCTION","function",276],["T_WHITESPACE"," ",276],["T_STRING","getEntityManager",276],"(",")",["T_WHITESPACE","\n    ",276],"{",["T_WHITESPACE","\n        ",277],["T_IF","if",278],["T_WHITESPACE"," ",278],"(",["T_STRING","null",278],["T_WHITESPACE"," ",278],["T_IS_IDENTICAL","===",278],["T_WHITESPACE"," ",278],["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","entityManager",278],")",["T_WHITESPACE"," ",278],"{",["T_WHITESPACE","\n            ",278],["T_VARIABLE","$this",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","entityManager",279],["T_WHITESPACE"," ",279],"=",["T_WHITESPACE"," ",279],["T_NS_SEPARATOR","\\",279],["T_STRING","Magento",279],["T_NS_SEPARATOR","\\",279],["T_STRING","Framework",279],["T_NS_SEPARATOR","\\",279],["T_STRING","App",279],["T_NS_SEPARATOR","\\",279],["T_STRING","ObjectManager",279],["T_DOUBLE_COLON","::",279],["T_STRING","getInstance",279],"(",")",["T_WHITESPACE","\n                ",279],["T_OBJECT_OPERATOR","->",280],["T_STRING","get",280],"(",["T_NS_SEPARATOR","\\",280],["T_STRING","Magento",280],["T_NS_SEPARATOR","\\",280],["T_STRING","Framework",280],["T_NS_SEPARATOR","\\",280],["T_STRING","EntityManager",280],["T_NS_SEPARATOR","\\",280],["T_STRING","EntityManager",280],["T_DOUBLE_COLON","::",280],["T_CLASS","class",280],")",";",["T_WHITESPACE","\n        ",280],"}",["T_WHITESPACE","\n        ",281],["T_RETURN","return",282],["T_WHITESPACE"," ",282],["T_VARIABLE","$this",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","entityManager",282],";",["T_WHITESPACE","\n    ",282],"}",["T_WHITESPACE","\n",283],"}",["T_WHITESPACE","\n",284]]