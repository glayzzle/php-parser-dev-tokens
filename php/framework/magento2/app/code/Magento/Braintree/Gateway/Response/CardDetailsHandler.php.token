[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Braintree",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Gateway",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Response",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Braintree",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Transaction",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Braintree",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Gateway",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Config",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Config",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Payment",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Gateway",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Helper",10],["T_NS_SEPARATOR","\\",10],["T_STRING","ContextHelper",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Sales",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Api",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Data",11],["T_NS_SEPARATOR","\\",11],["T_STRING","OrderPaymentInterface",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Braintree",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Gateway",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Helper",12],["T_NS_SEPARATOR","\\",12],["T_STRING","SubjectReader",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Payment",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Gateway",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Response",13],["T_NS_SEPARATOR","\\",13],["T_STRING","HandlerInterface",13],";",["T_WHITESPACE","\n\n",13],["T_DOC_COMMENT","\/**\n * Class CardDetailsHandler\n *\/",15],["T_WHITESPACE","\n",17],["T_CLASS","class",18],["T_WHITESPACE"," ",18],["T_STRING","CardDetailsHandler",18],["T_WHITESPACE"," ",18],["T_IMPLEMENTS","implements",18],["T_WHITESPACE"," ",18],["T_STRING","HandlerInterface",18],["T_WHITESPACE","\n",18],"{",["T_WHITESPACE","\n    ",19],["T_CONST","const",20],["T_WHITESPACE"," ",20],["T_STRING","CARD_TYPE",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_CONSTANT_ENCAPSED_STRING","'cardType'",20],";",["T_WHITESPACE","\n\n    ",20],["T_CONST","const",22],["T_WHITESPACE"," ",22],["T_STRING","CARD_EXP_MONTH",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'expirationMonth'",22],";",["T_WHITESPACE","\n\n    ",22],["T_CONST","const",24],["T_WHITESPACE"," ",24],["T_STRING","CARD_EXP_YEAR",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","'expirationYear'",24],";",["T_WHITESPACE","\n\n    ",24],["T_CONST","const",26],["T_WHITESPACE"," ",26],["T_STRING","CARD_LAST4",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","'last4'",26],";",["T_WHITESPACE","\n\n    ",26],["T_CONST","const",28],["T_WHITESPACE"," ",28],["T_STRING","CARD_NUMBER",28],["T_WHITESPACE"," ",28],"=",["T_WHITESPACE"," ",28],["T_CONSTANT_ENCAPSED_STRING","'cc_number'",28],";",["T_WHITESPACE","\n\n    ",28],["T_DOC_COMMENT","\/**\n     * @var Config\n     *\/",30],["T_WHITESPACE","\n    ",32],["T_PRIVATE","private",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$config",33],";",["T_WHITESPACE","\n\n    ",33],["T_DOC_COMMENT","\/**\n     * @var SubjectReader\n     *\/",35],["T_WHITESPACE","\n    ",37],["T_PRIVATE","private",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$subjectReader",38],";",["T_WHITESPACE","\n\n    ",38],["T_DOC_COMMENT","\/**\n     * Constructor\n     *\n     * @param Config $config\n     * @param SubjectReader $subjectReader\n     *\/",40],["T_WHITESPACE","\n    ",45],["T_PUBLIC","public",46],["T_WHITESPACE"," ",46],["T_FUNCTION","function",46],["T_WHITESPACE"," ",46],["T_STRING","__construct",46],"(",["T_WHITESPACE","\n        ",46],["T_STRING","Config",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$config",47],",",["T_WHITESPACE","\n        ",47],["T_STRING","SubjectReader",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$subjectReader",48],["T_WHITESPACE","\n    ",48],")",["T_WHITESPACE"," ",49],"{",["T_WHITESPACE","\n        ",49],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","config",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_VARIABLE","$config",50],";",["T_WHITESPACE","\n        ",50],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","subjectReader",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$subjectReader",51],";",["T_WHITESPACE","\n    ",51],"}",["T_WHITESPACE","\n\n    ",52],["T_DOC_COMMENT","\/**\n     * @inheritdoc\n     *\/",54],["T_WHITESPACE","\n    ",56],["T_PUBLIC","public",57],["T_WHITESPACE"," ",57],["T_FUNCTION","function",57],["T_WHITESPACE"," ",57],["T_STRING","handle",57],"(",["T_ARRAY","array",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$handlingSubject",57],",",["T_WHITESPACE"," ",57],["T_ARRAY","array",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$response",57],")",["T_WHITESPACE","\n    ",57],"{",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$paymentDO",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","subjectReader",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","readPayment",59],"(",["T_VARIABLE","$handlingSubject",59],")",";",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$transaction",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","subjectReader",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","readTransaction",60],"(",["T_VARIABLE","$response",60],")",";",["T_WHITESPACE","\n\n        ",60],["T_DOC_COMMENT","\/**\n         * @TODO after changes in sales module should be refactored for new interfaces\n         *\/",62],["T_WHITESPACE","\n        ",64],["T_VARIABLE","$payment",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$paymentDO",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getPayment",65],"(",")",";",["T_WHITESPACE","\n        ",65],["T_STRING","ContextHelper",66],["T_DOUBLE_COLON","::",66],["T_STRING","assertOrderPayment",66],"(",["T_VARIABLE","$payment",66],")",";",["T_WHITESPACE","\n\n        ",66],["T_VARIABLE","$creditCard",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$transaction",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","creditCard",68],";",["T_WHITESPACE","\n        ",68],["T_VARIABLE","$payment",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","setCcLast4",69],"(",["T_VARIABLE","$creditCard",69],"[",["T_STRING","self",69],["T_DOUBLE_COLON","::",69],["T_STRING","CARD_LAST4",69],"]",")",";",["T_WHITESPACE","\n        ",69],["T_VARIABLE","$payment",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","setCcExpMonth",70],"(",["T_VARIABLE","$creditCard",70],"[",["T_STRING","self",70],["T_DOUBLE_COLON","::",70],["T_STRING","CARD_EXP_MONTH",70],"]",")",";",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$payment",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","setCcExpYear",71],"(",["T_VARIABLE","$creditCard",71],"[",["T_STRING","self",71],["T_DOUBLE_COLON","::",71],["T_STRING","CARD_EXP_YEAR",71],"]",")",";",["T_WHITESPACE","\n\n        ",71],["T_VARIABLE","$payment",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","setCcType",73],"(",["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","getCreditCardType",73],"(",["T_VARIABLE","$creditCard",73],"[",["T_STRING","self",73],["T_DOUBLE_COLON","::",73],["T_STRING","CARD_TYPE",73],"]",")",")",";",["T_WHITESPACE","\n\n        ",73],["T_COMMENT","\/\/ set card details to additional info\n",75],["T_WHITESPACE","        ",76],["T_VARIABLE","$payment",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","setAdditionalInformation",76],"(",["T_STRING","self",76],["T_DOUBLE_COLON","::",76],["T_STRING","CARD_NUMBER",76],",",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'xxxx-'",76],["T_WHITESPACE"," ",76],".",["T_WHITESPACE"," ",76],["T_VARIABLE","$creditCard",76],"[",["T_STRING","self",76],["T_DOUBLE_COLON","::",76],["T_STRING","CARD_LAST4",76],"]",")",";",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$payment",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","setAdditionalInformation",77],"(",["T_STRING","OrderPaymentInterface",77],["T_DOUBLE_COLON","::",77],["T_STRING","CC_TYPE",77],",",["T_WHITESPACE"," ",77],["T_VARIABLE","$creditCard",77],"[",["T_STRING","self",77],["T_DOUBLE_COLON","::",77],["T_STRING","CARD_TYPE",77],"]",")",";",["T_WHITESPACE","\n    ",77],"}",["T_WHITESPACE","\n\n    ",78],["T_DOC_COMMENT","\/**\n     * Get type of credit card mapped from Braintree\n     *\n     * @param string $type\n     * @return array\n     *\/",80],["T_WHITESPACE","\n    ",85],["T_PRIVATE","private",86],["T_WHITESPACE"," ",86],["T_FUNCTION","function",86],["T_WHITESPACE"," ",86],["T_STRING","getCreditCardType",86],"(",["T_VARIABLE","$type",86],")",["T_WHITESPACE","\n    ",86],"{",["T_WHITESPACE","\n        ",87],["T_VARIABLE","$replaced",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_STRING","str_replace",88],"(",["T_CONSTANT_ENCAPSED_STRING","' '",88],",",["T_WHITESPACE"," ",88],["T_CONSTANT_ENCAPSED_STRING","'-'",88],",",["T_WHITESPACE"," ",88],["T_STRING","strtolower",88],"(",["T_VARIABLE","$type",88],")",")",";",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$mapper",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","config",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getCctypesMapper",89],"(",")",";",["T_WHITESPACE","\n\n        ",89],["T_RETURN","return",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$mapper",91],"[",["T_VARIABLE","$replaced",91],"]",";",["T_WHITESPACE","\n    ",91],"}",["T_WHITESPACE","\n",92],"}",["T_WHITESPACE","\n",93]]