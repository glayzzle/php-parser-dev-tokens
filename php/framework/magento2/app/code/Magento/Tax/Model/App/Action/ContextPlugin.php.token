[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Tax",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Model",7],["T_NS_SEPARATOR","\\",7],["T_STRING","App",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Action",7],";",["T_WHITESPACE","\n\n",7],["T_DOC_COMMENT","\/**\n * Class ContextPlugin\n *\/",9],["T_WHITESPACE","\n",11],["T_CLASS","class",12],["T_WHITESPACE"," ",12],["T_STRING","ContextPlugin",12],["T_WHITESPACE","\n",12],"{",["T_WHITESPACE","\n    ",13],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Customer\\Model\\Session\n     *\/",14],["T_WHITESPACE","\n    ",16],["T_PROTECTED","protected",17],["T_WHITESPACE"," ",17],["T_VARIABLE","$customerSession",17],";",["T_WHITESPACE","\n\n    ",17],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\App\\Http\\Context\n     *\/",19],["T_WHITESPACE","\n    ",21],["T_PROTECTED","protected",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$httpContext",22],";",["T_WHITESPACE","\n\n    ",22],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Tax\\Helper\\Data\n     *\/",24],["T_WHITESPACE","\n    ",26],["T_PROTECTED","protected",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$taxHelper",27],";",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Tax\\Model\\Calculation\\Proxy\n     *\/",29],["T_WHITESPACE","\n    ",31],["T_PROTECTED","protected",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$taxCalculation",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * Module manager\n     *\n     * @var \\Magento\\Framework\\Module\\Manager\n     *\/",34],["T_WHITESPACE","\n    ",38],["T_PRIVATE","private",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$moduleManager",39],";",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * Cache config\n     *\n     * @var \\Magento\\PageCache\\Model\\Config\n     *\/",41],["T_WHITESPACE","\n    ",45],["T_PRIVATE","private",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$cacheConfig",46],";",["T_WHITESPACE","\n\n    ",46],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Customer\\Model\\Session $customerSession\n     * @param \\Magento\\Framework\\App\\Http\\Context $httpContext\n     * @param \\Magento\\Tax\\Model\\Calculation\\Proxy $calculation\n     * @param \\Magento\\Tax\\Helper\\Data $taxHelper\n     * @param \\Magento\\Framework\\Module\\Manager $moduleManager\n     * @param \\Magento\\PageCache\\Model\\Config $cacheConfig\n     *\/",48],["T_WHITESPACE","\n    ",55],["T_PUBLIC","public",56],["T_WHITESPACE"," ",56],["T_FUNCTION","function",56],["T_WHITESPACE"," ",56],["T_STRING","__construct",56],"(",["T_WHITESPACE","\n        ",56],["T_NS_SEPARATOR","\\",57],["T_STRING","Magento",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Customer",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Model",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Session",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$customerSession",57],",",["T_WHITESPACE","\n        ",57],["T_NS_SEPARATOR","\\",58],["T_STRING","Magento",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Framework",58],["T_NS_SEPARATOR","\\",58],["T_STRING","App",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Http",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Context",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$httpContext",58],",",["T_WHITESPACE","\n        ",58],["T_NS_SEPARATOR","\\",59],["T_STRING","Magento",59],["T_NS_SEPARATOR","\\",59],["T_STRING","Tax",59],["T_NS_SEPARATOR","\\",59],["T_STRING","Model",59],["T_NS_SEPARATOR","\\",59],["T_STRING","Calculation",59],["T_NS_SEPARATOR","\\",59],["T_STRING","Proxy",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$calculation",59],",",["T_WHITESPACE","\n        ",59],["T_NS_SEPARATOR","\\",60],["T_STRING","Magento",60],["T_NS_SEPARATOR","\\",60],["T_STRING","Tax",60],["T_NS_SEPARATOR","\\",60],["T_STRING","Helper",60],["T_NS_SEPARATOR","\\",60],["T_STRING","Data",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$taxHelper",60],",",["T_WHITESPACE","\n        ",60],["T_NS_SEPARATOR","\\",61],["T_STRING","Magento",61],["T_NS_SEPARATOR","\\",61],["T_STRING","Framework",61],["T_NS_SEPARATOR","\\",61],["T_STRING","Module",61],["T_NS_SEPARATOR","\\",61],["T_STRING","Manager",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$moduleManager",61],",",["T_WHITESPACE","\n        ",61],["T_NS_SEPARATOR","\\",62],["T_STRING","Magento",62],["T_NS_SEPARATOR","\\",62],["T_STRING","PageCache",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Model",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Config",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$cacheConfig",62],["T_WHITESPACE","\n    ",62],")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n        ",63],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","customerSession",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$customerSession",64],";",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","httpContext",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$httpContext",65],";",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","taxCalculation",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$calculation",66],";",["T_WHITESPACE","\n        ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","taxHelper",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$taxHelper",67],";",["T_WHITESPACE","\n        ",67],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","moduleManager",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$moduleManager",68],";",["T_WHITESPACE","\n        ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","cacheConfig",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_VARIABLE","$cacheConfig",69],";",["T_WHITESPACE","\n    ",69],"}",["T_WHITESPACE","\n\n    ",70],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\App\\ActionInterface $subject\n     * @param \\Magento\\Framework\\App\\RequestInterface $request\n     * @return mixed\n     * @SuppressWarnings(PHPMD.UnusedFormalParameter)\n     *\/",72],["T_WHITESPACE","\n    ",77],["T_PUBLIC","public",78],["T_WHITESPACE"," ",78],["T_FUNCTION","function",78],["T_WHITESPACE"," ",78],["T_STRING","beforeDispatch",78],"(",["T_WHITESPACE","\n        ",78],["T_NS_SEPARATOR","\\",79],["T_STRING","Magento",79],["T_NS_SEPARATOR","\\",79],["T_STRING","Framework",79],["T_NS_SEPARATOR","\\",79],["T_STRING","App",79],["T_NS_SEPARATOR","\\",79],["T_STRING","ActionInterface",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$subject",79],",",["T_WHITESPACE","\n        ",79],["T_NS_SEPARATOR","\\",80],["T_STRING","Magento",80],["T_NS_SEPARATOR","\\",80],["T_STRING","Framework",80],["T_NS_SEPARATOR","\\",80],["T_STRING","App",80],["T_NS_SEPARATOR","\\",80],["T_STRING","RequestInterface",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$request",80],["T_WHITESPACE","\n    ",80],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n        ",81],["T_IF","if",82],["T_WHITESPACE"," ",82],"(","!",["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","customerSession",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","isLoggedIn",82],"(",")",["T_WHITESPACE"," ",82],["T_BOOLEAN_OR","||",82],["T_WHITESPACE","\n            ",82],"!",["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","moduleManager",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","isEnabled",83],"(",["T_CONSTANT_ENCAPSED_STRING","'Magento_PageCache'",83],")",["T_WHITESPACE"," ",83],["T_BOOLEAN_OR","||",83],["T_WHITESPACE","\n            ",83],"!",["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","cacheConfig",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","isEnabled",84],"(",")",["T_WHITESPACE"," ",84],["T_BOOLEAN_OR","||",84],["T_WHITESPACE","\n            ",84],"!",["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","taxHelper",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","isCatalogPriceDisplayAffectedByTax",85],"(",")",")",["T_WHITESPACE"," ",85],"{",["T_WHITESPACE","\n            ",85],["T_RETURN","return",86],";",["T_WHITESPACE","\n        ",86],"}",["T_WHITESPACE","\n\n        ",87],["T_VARIABLE","$defaultBillingAddress",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","customerSession",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getDefaultTaxBillingAddress",89],"(",")",";",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$defaultShippingAddress",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","customerSession",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","getDefaultTaxShippingAddress",90],"(",")",";",["T_WHITESPACE","\n        ",90],["T_VARIABLE","$customerTaxClassId",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","customerSession",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getCustomerTaxClassId",91],"(",")",";",["T_WHITESPACE","\n\n        ",91],["T_IF","if",93],["T_WHITESPACE"," ",93],"(","!",["T_EMPTY","empty",93],"(",["T_VARIABLE","$defaultBillingAddress",93],")",["T_WHITESPACE"," ",93],["T_BOOLEAN_OR","||",93],["T_WHITESPACE"," ",93],"!",["T_EMPTY","empty",93],"(",["T_VARIABLE","$defaultShippingAddress",93],")",")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n            ",93],["T_VARIABLE","$taxRates",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","taxCalculation",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getTaxRates",94],"(",["T_WHITESPACE","\n                ",94],["T_VARIABLE","$defaultBillingAddress",95],",",["T_WHITESPACE","\n                ",95],["T_VARIABLE","$defaultShippingAddress",96],",",["T_WHITESPACE","\n                ",96],["T_VARIABLE","$customerTaxClassId",97],["T_WHITESPACE","\n            ",97],")",";",["T_WHITESPACE","\n            ",98],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","httpContext",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","setValue",99],"(",["T_WHITESPACE","\n                ",99],["T_CONSTANT_ENCAPSED_STRING","'tax_rates'",100],",",["T_WHITESPACE","\n                ",100],["T_VARIABLE","$taxRates",101],",",["T_WHITESPACE","\n                ",101],["T_LNUMBER","0",102],["T_WHITESPACE","\n            ",102],")",";",["T_WHITESPACE","\n        ",103],"}",["T_WHITESPACE","\n    ",104],"}",["T_WHITESPACE","\n",105],"}",["T_WHITESPACE","\n",106]]