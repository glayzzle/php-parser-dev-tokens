[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Tax rate collection\n *\/",7],["T_WHITESPACE","\n",9],["T_NAMESPACE","namespace",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Tax",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Model",10],["T_NS_SEPARATOR","\\",10],["T_STRING","ResourceModel",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Calculation",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Rate",10],";",["T_WHITESPACE","\n\n",10],["T_CLASS","class",12],["T_WHITESPACE"," ",12],["T_STRING","Collection",12],["T_WHITESPACE"," ",12],["T_EXTENDS","extends",12],["T_WHITESPACE"," ",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Framework",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Model",12],["T_NS_SEPARATOR","\\",12],["T_STRING","ResourceModel",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Db",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Collection",12],["T_NS_SEPARATOR","\\",12],["T_STRING","AbstractCollection",12],["T_WHITESPACE","\n",12],"{",["T_WHITESPACE","\n    ",13],["T_DOC_COMMENT","\/**\n     * Value of fetched from DB of rules per cycle\n     *\/",14],["T_WHITESPACE","\n    ",16],["T_CONST","const",17],["T_WHITESPACE"," ",17],["T_STRING","TAX_RULES_CHUNK_SIZE",17],["T_WHITESPACE"," ",17],"=",["T_WHITESPACE"," ",17],["T_LNUMBER","1000",17],";",["T_WHITESPACE","\n\n    ",17],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Store\\Model\\StoreManagerInterface\n     *\/",19],["T_WHITESPACE","\n    ",21],["T_PROTECTED","protected",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$_storeManager",22],";",["T_WHITESPACE","\n\n    ",22],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\Data\\Collection\\EntityFactory $entityFactory\n     * @param \\Psr\\Log\\LoggerInterface $logger\n     * @param \\Magento\\Framework\\Data\\Collection\\Db\\FetchStrategyInterface $fetchStrategy\n     * @param \\Magento\\Framework\\Event\\ManagerInterface $eventManager\n     * @param \\Magento\\Store\\Model\\StoreManagerInterface $storeManager\n     * @param mixed $connection\n     * @param \\Magento\\Framework\\Model\\ResourceModel\\Db\\AbstractDb $resource\n     *\/",24],["T_WHITESPACE","\n    ",32],["T_PUBLIC","public",33],["T_WHITESPACE"," ",33],["T_FUNCTION","function",33],["T_WHITESPACE"," ",33],["T_STRING","__construct",33],"(",["T_WHITESPACE","\n        ",33],["T_NS_SEPARATOR","\\",34],["T_STRING","Magento",34],["T_NS_SEPARATOR","\\",34],["T_STRING","Framework",34],["T_NS_SEPARATOR","\\",34],["T_STRING","Data",34],["T_NS_SEPARATOR","\\",34],["T_STRING","Collection",34],["T_NS_SEPARATOR","\\",34],["T_STRING","EntityFactory",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$entityFactory",34],",",["T_WHITESPACE","\n        ",34],["T_NS_SEPARATOR","\\",35],["T_STRING","Psr",35],["T_NS_SEPARATOR","\\",35],["T_STRING","Log",35],["T_NS_SEPARATOR","\\",35],["T_STRING","LoggerInterface",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$logger",35],",",["T_WHITESPACE","\n        ",35],["T_NS_SEPARATOR","\\",36],["T_STRING","Magento",36],["T_NS_SEPARATOR","\\",36],["T_STRING","Framework",36],["T_NS_SEPARATOR","\\",36],["T_STRING","Data",36],["T_NS_SEPARATOR","\\",36],["T_STRING","Collection",36],["T_NS_SEPARATOR","\\",36],["T_STRING","Db",36],["T_NS_SEPARATOR","\\",36],["T_STRING","FetchStrategyInterface",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$fetchStrategy",36],",",["T_WHITESPACE","\n        ",36],["T_NS_SEPARATOR","\\",37],["T_STRING","Magento",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Framework",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Event",37],["T_NS_SEPARATOR","\\",37],["T_STRING","ManagerInterface",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$eventManager",37],",",["T_WHITESPACE","\n        ",37],["T_NS_SEPARATOR","\\",38],["T_STRING","Magento",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Store",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Model",38],["T_NS_SEPARATOR","\\",38],["T_STRING","StoreManagerInterface",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$storeManager",38],",",["T_WHITESPACE","\n        ",38],["T_NS_SEPARATOR","\\",39],["T_STRING","Magento",39],["T_NS_SEPARATOR","\\",39],["T_STRING","Framework",39],["T_NS_SEPARATOR","\\",39],["T_STRING","DB",39],["T_NS_SEPARATOR","\\",39],["T_STRING","Adapter",39],["T_NS_SEPARATOR","\\",39],["T_STRING","AdapterInterface",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$connection",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_STRING","null",39],",",["T_WHITESPACE","\n        ",39],["T_NS_SEPARATOR","\\",40],["T_STRING","Magento",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Framework",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Model",40],["T_NS_SEPARATOR","\\",40],["T_STRING","ResourceModel",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Db",40],["T_NS_SEPARATOR","\\",40],["T_STRING","AbstractDb",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$resource",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_STRING","null",40],["T_WHITESPACE","\n    ",40],")",["T_WHITESPACE"," ",41],"{",["T_WHITESPACE","\n        ",41],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","_storeManager",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_VARIABLE","$storeManager",42],";",["T_WHITESPACE","\n        ",42],["T_STRING","parent",43],["T_DOUBLE_COLON","::",43],["T_STRING","__construct",43],"(",["T_VARIABLE","$entityFactory",43],",",["T_WHITESPACE"," ",43],["T_VARIABLE","$logger",43],",",["T_WHITESPACE"," ",43],["T_VARIABLE","$fetchStrategy",43],",",["T_WHITESPACE"," ",43],["T_VARIABLE","$eventManager",43],",",["T_WHITESPACE"," ",43],["T_VARIABLE","$connection",43],",",["T_WHITESPACE"," ",43],["T_VARIABLE","$resource",43],")",";",["T_WHITESPACE","\n    ",43],"}",["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * Resource initialization\n     *\n     * @return void\n     *\/",46],["T_WHITESPACE","\n    ",50],["T_PROTECTED","protected",51],["T_WHITESPACE"," ",51],["T_FUNCTION","function",51],["T_WHITESPACE"," ",51],["T_STRING","_construct",51],"(",")",["T_WHITESPACE","\n    ",51],"{",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","_init",53],"(",["T_WHITESPACE","\n            ",53],["T_NS_SEPARATOR","\\",54],["T_STRING","Magento",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Tax",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Model",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Calculation",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Rate",54],["T_DOUBLE_COLON","::",54],["T_CLASS","class",54],",",["T_WHITESPACE","\n            ",54],["T_NS_SEPARATOR","\\",55],["T_STRING","Magento",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Tax",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Model",55],["T_NS_SEPARATOR","\\",55],["T_STRING","ResourceModel",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Calculation",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Rate",55],["T_DOUBLE_COLON","::",55],["T_CLASS","class",55],["T_WHITESPACE","\n        ",55],")",";",["T_WHITESPACE","\n    ",56],"}",["T_WHITESPACE","\n\n    ",57],["T_DOC_COMMENT","\/**\n     * Join country table to result\n     *\n     * @return $this\n     *\/",59],["T_WHITESPACE","\n    ",63],["T_PUBLIC","public",64],["T_WHITESPACE"," ",64],["T_FUNCTION","function",64],["T_WHITESPACE"," ",64],["T_STRING","joinCountryTable",64],"(",")",["T_WHITESPACE","\n    ",64],"{",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","_select",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","join",66],"(",["T_WHITESPACE","\n            ",66],"[",["T_CONSTANT_ENCAPSED_STRING","'country_table'",67],["T_WHITESPACE"," ",67],["T_DOUBLE_ARROW","=>",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","getTable",67],"(",["T_CONSTANT_ENCAPSED_STRING","'directory_country'",67],")","]",",",["T_WHITESPACE","\n            ",67],["T_CONSTANT_ENCAPSED_STRING","'main_table.tax_country_id = country_table.country_id'",68],",",["T_WHITESPACE","\n            ",68],"[",["T_CONSTANT_ENCAPSED_STRING","'country_name'",69],["T_WHITESPACE"," ",69],["T_DOUBLE_ARROW","=>",69],["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'iso2_code'",69],"]",["T_WHITESPACE","\n        ",69],")",";",["T_WHITESPACE","\n\n        ",70],["T_RETURN","return",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$this",72],";",["T_WHITESPACE","\n    ",72],"}",["T_WHITESPACE","\n\n    ",73],["T_DOC_COMMENT","\/**\n     * Join Region Table\n     *\n     * @return $this\n     *\/",75],["T_WHITESPACE","\n    ",79],["T_PUBLIC","public",80],["T_WHITESPACE"," ",80],["T_FUNCTION","function",80],["T_WHITESPACE"," ",80],["T_STRING","joinRegionTable",80],"(",")",["T_WHITESPACE","\n    ",80],"{",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","_select",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","joinLeft",82],"(",["T_WHITESPACE","\n            ",82],"[",["T_CONSTANT_ENCAPSED_STRING","'region_table'",83],["T_WHITESPACE"," ",83],["T_DOUBLE_ARROW","=>",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","getTable",83],"(",["T_CONSTANT_ENCAPSED_STRING","'directory_country_region'",83],")","]",",",["T_WHITESPACE","\n            ",83],["T_CONSTANT_ENCAPSED_STRING","'main_table.tax_region_id = region_table.region_id'",84],",",["T_WHITESPACE","\n            ",84],"[",["T_CONSTANT_ENCAPSED_STRING","'region_name'",85],["T_WHITESPACE"," ",85],["T_DOUBLE_ARROW","=>",85],["T_WHITESPACE"," ",85],["T_CONSTANT_ENCAPSED_STRING","'code'",85],"]",["T_WHITESPACE","\n        ",85],")",";",["T_WHITESPACE","\n        ",86],["T_RETURN","return",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n\n    ",88],["T_DOC_COMMENT","\/**\n     * Join rate title for specified store\n     *\n     * @param \\Magento\\Store\\Model\\Store|string|int $store\n     * @return $this\n     *\/",90],["T_WHITESPACE","\n    ",95],["T_PUBLIC","public",96],["T_WHITESPACE"," ",96],["T_FUNCTION","function",96],["T_WHITESPACE"," ",96],["T_STRING","joinTitle",96],"(",["T_VARIABLE","$store",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_STRING","null",96],")",["T_WHITESPACE","\n    ",96],"{",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$storeId",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_INT_CAST","(int)",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","_storeManager",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getStore",98],"(",["T_VARIABLE","$store",98],")",["T_OBJECT_OPERATOR","->",98],["T_STRING","getId",98],"(",")",";",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","_select",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","joinLeft",99],"(",["T_WHITESPACE","\n            ",99],"[",["T_CONSTANT_ENCAPSED_STRING","'title_table'",100],["T_WHITESPACE"," ",100],["T_DOUBLE_ARROW","=>",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getTable",100],"(",["T_CONSTANT_ENCAPSED_STRING","'tax_calculation_rate_title'",100],")","]",",",["T_WHITESPACE","\n            ",100],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getConnection",101],"(",")",["T_OBJECT_OPERATOR","->",101],["T_STRING","quoteInto",101],"(",["T_WHITESPACE","\n                ",101],["T_CONSTANT_ENCAPSED_STRING","'main_table.tax_calculation_rate_id = title_table.tax_calculation_rate_id AND title_table.store_id = ?'",102],",",["T_WHITESPACE","\n                ",102],["T_VARIABLE","$storeId",103],["T_WHITESPACE","\n            ",103],")",",",["T_WHITESPACE","\n            ",104],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",105],["T_WHITESPACE"," ",105],["T_DOUBLE_ARROW","=>",105],["T_WHITESPACE"," ",105],["T_CONSTANT_ENCAPSED_STRING","'value'",105],"]",["T_WHITESPACE","\n        ",105],")",";",["T_WHITESPACE","\n\n        ",106],["T_RETURN","return",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$this",108],";",["T_WHITESPACE","\n    ",108],"}",["T_WHITESPACE","\n\n    ",109],["T_DOC_COMMENT","\/**\n     * Joins store titles for rates\n     *\n     * @return $this\n     *\/",111],["T_WHITESPACE","\n    ",115],["T_PUBLIC","public",116],["T_WHITESPACE"," ",116],["T_FUNCTION","function",116],["T_WHITESPACE"," ",116],["T_STRING","joinStoreTitles",116],"(",")",["T_WHITESPACE","\n    ",116],"{",["T_WHITESPACE","\n        ",117],["T_VARIABLE","$storeCollection",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","_storeManager",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","getStores",118],"(",["T_STRING","true",118],")",";",["T_WHITESPACE","\n        ",118],["T_FOREACH","foreach",119],["T_WHITESPACE"," ",119],"(",["T_VARIABLE","$storeCollection",119],["T_WHITESPACE"," ",119],["T_AS","as",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$store",119],")",["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n            ",119],["T_VARIABLE","$tableAlias",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_STRING","sprintf",120],"(",["T_CONSTANT_ENCAPSED_STRING","'title_table_%s'",120],",",["T_WHITESPACE"," ",120],["T_VARIABLE","$store",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","getId",120],"(",")",")",";",["T_WHITESPACE","\n            ",120],["T_VARIABLE","$joinCondition",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_STRING","implode",121],"(",["T_WHITESPACE","\n                ",121],["T_CONSTANT_ENCAPSED_STRING","' AND '",122],",",["T_WHITESPACE","\n                ",122],"[",["T_WHITESPACE","\n                    ",123],"\"",["T_ENCAPSED_AND_WHITESPACE","main_table.tax_calculation_rate_id = ",124],["T_CURLY_OPEN","{",124],["T_VARIABLE","$tableAlias",124],"}",["T_ENCAPSED_AND_WHITESPACE",".tax_calculation_rate_id",124],"\"",",",["T_WHITESPACE","\n                    ",124],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","getConnection",125],"(",")",["T_OBJECT_OPERATOR","->",125],["T_STRING","quoteInto",125],"(",["T_VARIABLE","$tableAlias",125],["T_WHITESPACE"," ",125],".",["T_WHITESPACE"," ",125],["T_CONSTANT_ENCAPSED_STRING","'.store_id = ?'",125],",",["T_WHITESPACE"," ",125],["T_VARIABLE","$store",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","getId",125],"(",")",")",["T_WHITESPACE","\n                ",125],"]",["T_WHITESPACE","\n            ",126],")",";",["T_WHITESPACE","\n            ",127],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","_select",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","joinLeft",128],"(",["T_WHITESPACE","\n                ",128],"[",["T_VARIABLE","$tableAlias",129],["T_WHITESPACE"," ",129],["T_DOUBLE_ARROW","=>",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getTable",129],"(",["T_CONSTANT_ENCAPSED_STRING","'tax_calculation_rate_title'",129],")","]",",",["T_WHITESPACE","\n                ",129],["T_VARIABLE","$joinCondition",130],",",["T_WHITESPACE","\n                ",130],"[",["T_VARIABLE","$tableAlias",131],["T_WHITESPACE"," ",131],["T_DOUBLE_ARROW","=>",131],["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","'value'",131],"]",["T_WHITESPACE","\n            ",131],")",";",["T_WHITESPACE","\n        ",132],"}",["T_WHITESPACE","\n        ",133],["T_RETURN","return",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$this",134],";",["T_WHITESPACE","\n    ",134],"}",["T_WHITESPACE","\n\n    ",135],["T_DOC_COMMENT","\/**\n     * Add rate filter\n     *\n     * @param int $rateId\n     * @return $this\n     *\/",137],["T_WHITESPACE","\n    ",142],["T_PUBLIC","public",143],["T_WHITESPACE"," ",143],["T_FUNCTION","function",143],["T_WHITESPACE"," ",143],["T_STRING","addRateFilter",143],"(",["T_VARIABLE","$rateId",143],")",["T_WHITESPACE","\n    ",143],"{",["T_WHITESPACE","\n        ",144],["T_IF","if",145],["T_WHITESPACE"," ",145],"(",["T_STRING","is_int",145],"(",["T_VARIABLE","$rateId",145],")",["T_WHITESPACE"," ",145],["T_BOOLEAN_AND","&&",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$rateId",145],["T_WHITESPACE"," ",145],">",["T_WHITESPACE"," ",145],["T_LNUMBER","0",145],")",["T_WHITESPACE"," ",145],"{",["T_WHITESPACE","\n            ",145],["T_RETURN","return",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","addFieldToFilter",146],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.tax_rate_id'",146],",",["T_WHITESPACE"," ",146],["T_VARIABLE","$rateId",146],")",";",["T_WHITESPACE","\n        ",146],"}",["T_WHITESPACE","\n\n        ",147],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],";",["T_WHITESPACE","\n    ",149],"}",["T_WHITESPACE","\n\n    ",150],["T_DOC_COMMENT","\/**\n     * Retrieve option array\n     *\n     * @return array\n     *\/",152],["T_WHITESPACE","\n    ",156],["T_PUBLIC","public",157],["T_WHITESPACE"," ",157],["T_FUNCTION","function",157],["T_WHITESPACE"," ",157],["T_STRING","toOptionArray",157],"(",")",["T_WHITESPACE","\n    ",157],"{",["T_WHITESPACE","\n        ",158],["T_RETURN","return",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","_toOptionArray",159],"(",["T_CONSTANT_ENCAPSED_STRING","'tax_calculation_rate_id'",159],",",["T_WHITESPACE"," ",159],["T_CONSTANT_ENCAPSED_STRING","'code'",159],")",";",["T_WHITESPACE","\n    ",159],"}",["T_WHITESPACE","\n\n    ",160],["T_DOC_COMMENT","\/**\n     * Retrieve option hash\n     *\n     * @return array\n     *\/",162],["T_WHITESPACE","\n    ",166],["T_PUBLIC","public",167],["T_WHITESPACE"," ",167],["T_FUNCTION","function",167],["T_WHITESPACE"," ",167],["T_STRING","toOptionHash",167],"(",")",["T_WHITESPACE","\n    ",167],"{",["T_WHITESPACE","\n        ",168],["T_RETURN","return",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$this",169],["T_OBJECT_OPERATOR","->",169],["T_STRING","_toOptionHash",169],"(",["T_CONSTANT_ENCAPSED_STRING","'tax_calculation_rate_id'",169],",",["T_WHITESPACE"," ",169],["T_CONSTANT_ENCAPSED_STRING","'code'",169],")",";",["T_WHITESPACE","\n    ",169],"}",["T_WHITESPACE","\n\n    ",170],["T_DOC_COMMENT","\/**\n     * Convert items array to hash for select options\n     * using fetchItem method\n     *\n     * @see fetchItem()\n     *\n     * @return array\n     *\/",172],["T_WHITESPACE","\n    ",179],["T_PUBLIC","public",180],["T_WHITESPACE"," ",180],["T_FUNCTION","function",180],["T_WHITESPACE"," ",180],["T_STRING","toOptionHashOptimized",180],"(",")",["T_WHITESPACE","\n    ",180],"{",["T_WHITESPACE","\n        ",181],["T_VARIABLE","$result",182],["T_WHITESPACE"," ",182],"=",["T_WHITESPACE"," ",182],"[","]",";",["T_WHITESPACE","\n        ",182],["T_WHILE","while",183],["T_WHITESPACE"," ",183],"(",["T_VARIABLE","$item",183],["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","fetchItem",183],"(",")",")",["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n            ",183],["T_VARIABLE","$result",184],"[",["T_VARIABLE","$item",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getData",184],"(",["T_CONSTANT_ENCAPSED_STRING","'tax_calculation_rate_id'",184],")","]",["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_VARIABLE","$item",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getData",184],"(",["T_CONSTANT_ENCAPSED_STRING","'code'",184],")",";",["T_WHITESPACE","\n        ",184],"}",["T_WHITESPACE","\n        ",185],["T_RETURN","return",186],["T_WHITESPACE"," ",186],["T_VARIABLE","$result",186],";",["T_WHITESPACE","\n    ",186],"}",["T_WHITESPACE","\n\n    ",187],["T_DOC_COMMENT","\/**\n     * Get rates array without memory leak\n     *\n     * @return array\n     *\/",189],["T_WHITESPACE","\n    ",193],["T_PUBLIC","public",194],["T_WHITESPACE"," ",194],["T_FUNCTION","function",194],["T_WHITESPACE"," ",194],["T_STRING","getOptionRates",194],"(",")",["T_WHITESPACE","\n    ",194],"{",["T_WHITESPACE","\n        ",195],["T_VARIABLE","$size",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_STRING","self",196],["T_DOUBLE_COLON","::",196],["T_STRING","TAX_RULES_CHUNK_SIZE",196],";",["T_WHITESPACE","\n        ",196],["T_VARIABLE","$page",197],["T_WHITESPACE"," ",197],"=",["T_WHITESPACE"," ",197],["T_LNUMBER","1",197],";",["T_WHITESPACE","\n        ",197],["T_VARIABLE","$rates",198],["T_WHITESPACE"," ",198],"=",["T_WHITESPACE"," ",198],"[","]",";",["T_WHITESPACE","\n        ",198],["T_DO","do",199],["T_WHITESPACE"," ",199],"{",["T_WHITESPACE","\n            ",199],["T_VARIABLE","$offset",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_VARIABLE","$size",200],["T_WHITESPACE"," ",200],"*",["T_WHITESPACE"," ",200],"(",["T_VARIABLE","$page",200],["T_WHITESPACE"," ",200],"-",["T_WHITESPACE"," ",200],["T_LNUMBER","1",200],")",";",["T_WHITESPACE","\n            ",200],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","getSelect",201],"(",")",["T_OBJECT_OPERATOR","->",201],["T_STRING","reset",201],"(",")",";",["T_WHITESPACE","\n            ",201],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","getSelect",202],"(",")",["T_WHITESPACE","\n                ",202],["T_OBJECT_OPERATOR","->",203],["T_STRING","from",203],"(",["T_WHITESPACE","\n                    ",203],"[",["T_CONSTANT_ENCAPSED_STRING","'rates'",204],["T_WHITESPACE"," ",204],["T_DOUBLE_ARROW","=>",204],["T_WHITESPACE"," ",204],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","getMainTable",204],"(",")","]",",",["T_WHITESPACE","\n                    ",204],"[",["T_CONSTANT_ENCAPSED_STRING","'tax_calculation_rate_id'",205],",",["T_WHITESPACE"," ",205],["T_CONSTANT_ENCAPSED_STRING","'code'",205],"]",["T_WHITESPACE","\n                ",205],")",["T_WHITESPACE","\n                ",206],["T_OBJECT_OPERATOR","->",207],["T_STRING","limit",207],"(",["T_VARIABLE","$size",207],",",["T_WHITESPACE"," ",207],["T_VARIABLE","$offset",207],")",";",["T_WHITESPACE","\n\n            ",207],["T_VARIABLE","$rates",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_STRING","array_merge",209],"(",["T_VARIABLE","$rates",209],",",["T_WHITESPACE"," ",209],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","toOptionArray",209],"(",")",")",";",["T_WHITESPACE","\n            ",209],["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","clear",210],"(",")",";",["T_WHITESPACE","\n            ",210],["T_VARIABLE","$page",211],["T_INC","++",211],";",["T_WHITESPACE","\n        ",211],"}",["T_WHITESPACE"," ",212],["T_WHILE","while",212],["T_WHITESPACE"," ",212],"(",["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","getSize",212],"(",")",["T_WHITESPACE"," ",212],">",["T_WHITESPACE"," ",212],["T_VARIABLE","$offset",212],")",";",["T_WHITESPACE","\n\n        ",212],["T_RETURN","return",214],["T_WHITESPACE"," ",214],["T_VARIABLE","$rates",214],";",["T_WHITESPACE","\n    ",214],"}",["T_WHITESPACE","\n",215],"}",["T_WHITESPACE","\n",216]]