[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Calculate items and address amounts including\/excluding tax\n *\/",7],["T_WHITESPACE","\n",9],["T_NAMESPACE","namespace",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Tax",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Model",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Sales",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Total",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Quote",10],";",["T_WHITESPACE","\n\n",10],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Quote",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Model",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Quote",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Address",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Quote",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Api",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Data",13],["T_NS_SEPARATOR","\\",13],["T_STRING","ShippingAssignmentInterface",13],";",["T_WHITESPACE","\n\n",13],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","Subtotal",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_STRING","CommonTaxCollector",15],["T_WHITESPACE","\n",15],"{",["T_WHITESPACE","\n    ",16],["T_DOC_COMMENT","\/**\n     * Calculate tax on product items. The result will be used to determine shipping\n     * and discount later.\n     *\n     * @param \\Magento\\Quote\\Model\\Quote $quote\n     * @param ShippingAssignmentInterface $shippingAssignment\n     * @param Address\\Total $total\n     * @return $this\n     *\/",17],["T_WHITESPACE","\n    ",25],["T_PUBLIC","public",26],["T_WHITESPACE"," ",26],["T_FUNCTION","function",26],["T_WHITESPACE"," ",26],["T_STRING","collect",26],"(",["T_WHITESPACE","\n        ",26],["T_NS_SEPARATOR","\\",27],["T_STRING","Magento",27],["T_NS_SEPARATOR","\\",27],["T_STRING","Quote",27],["T_NS_SEPARATOR","\\",27],["T_STRING","Model",27],["T_NS_SEPARATOR","\\",27],["T_STRING","Quote",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$quote",27],",",["T_WHITESPACE","\n        ",27],["T_NS_SEPARATOR","\\",28],["T_STRING","Magento",28],["T_NS_SEPARATOR","\\",28],["T_STRING","Quote",28],["T_NS_SEPARATOR","\\",28],["T_STRING","Api",28],["T_NS_SEPARATOR","\\",28],["T_STRING","Data",28],["T_NS_SEPARATOR","\\",28],["T_STRING","ShippingAssignmentInterface",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$shippingAssignment",28],",",["T_WHITESPACE","\n        ",28],["T_NS_SEPARATOR","\\",29],["T_STRING","Magento",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Quote",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Model",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Quote",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Address",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Total",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$total",29],["T_WHITESPACE","\n    ",29],")",["T_WHITESPACE"," ",30],"{",["T_WHITESPACE","\n        ",30],["T_VARIABLE","$items",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_VARIABLE","$shippingAssignment",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","getItems",31],"(",")",";",["T_WHITESPACE","\n        ",31],["T_IF","if",32],["T_WHITESPACE"," ",32],"(","!",["T_VARIABLE","$items",32],")",["T_WHITESPACE"," ",32],"{",["T_WHITESPACE","\n            ",32],["T_RETURN","return",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$this",33],";",["T_WHITESPACE","\n        ",33],"}",["T_WHITESPACE","\n\n        ",34],["T_VARIABLE","$store",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$quote",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","getStore",36],"(",")",";",["T_WHITESPACE","\n        ",36],["T_VARIABLE","$priceIncludesTax",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","_config",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","priceIncludesTax",37],"(",["T_VARIABLE","$store",37],")",";",["T_WHITESPACE","\n\n        ",37],["T_COMMENT","\/\/Setup taxable items\n",39],["T_WHITESPACE","        ",40],["T_VARIABLE","$itemDataObjects",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","mapItems",40],"(",["T_VARIABLE","$shippingAssignment",40],",",["T_WHITESPACE"," ",40],["T_VARIABLE","$priceIncludesTax",40],",",["T_WHITESPACE"," ",40],["T_STRING","false",40],")",";",["T_WHITESPACE","\n        ",40],["T_VARIABLE","$quoteDetails",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_VARIABLE","$this",41],["T_OBJECT_OPERATOR","->",41],["T_STRING","prepareQuoteDetails",41],"(",["T_VARIABLE","$shippingAssignment",41],",",["T_WHITESPACE"," ",41],["T_VARIABLE","$itemDataObjects",41],")",";",["T_WHITESPACE","\n        ",41],["T_VARIABLE","$taxDetails",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","taxCalculationService",42],["T_WHITESPACE","\n            ",42],["T_OBJECT_OPERATOR","->",43],["T_STRING","calculateTax",43],"(",["T_VARIABLE","$quoteDetails",43],",",["T_WHITESPACE"," ",43],["T_VARIABLE","$store",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","getStoreId",43],"(",")",")",";",["T_WHITESPACE","\n\n        ",43],["T_VARIABLE","$itemDataObjects",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","mapItems",45],"(",["T_VARIABLE","$shippingAssignment",45],",",["T_WHITESPACE"," ",45],["T_VARIABLE","$priceIncludesTax",45],",",["T_WHITESPACE"," ",45],["T_STRING","true",45],")",";",["T_WHITESPACE","\n        ",45],["T_VARIABLE","$baseQuoteDetails",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","prepareQuoteDetails",46],"(",["T_VARIABLE","$shippingAssignment",46],",",["T_WHITESPACE"," ",46],["T_VARIABLE","$itemDataObjects",46],")",";",["T_WHITESPACE","\n        ",46],["T_VARIABLE","$baseTaxDetails",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","taxCalculationService",47],["T_WHITESPACE","\n            ",47],["T_OBJECT_OPERATOR","->",48],["T_STRING","calculateTax",48],"(",["T_VARIABLE","$baseQuoteDetails",48],",",["T_WHITESPACE"," ",48],["T_VARIABLE","$store",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","getStoreId",48],"(",")",")",";",["T_WHITESPACE","\n\n        ",48],["T_VARIABLE","$itemsByType",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","organizeItemTaxDetailsByType",50],"(",["T_VARIABLE","$taxDetails",50],",",["T_WHITESPACE"," ",50],["T_VARIABLE","$baseTaxDetails",50],")",";",["T_WHITESPACE","\n\n        ",50],["T_IF","if",52],["T_WHITESPACE"," ",52],"(",["T_ISSET","isset",52],"(",["T_VARIABLE","$itemsByType",52],"[",["T_STRING","self",52],["T_DOUBLE_COLON","::",52],["T_STRING","ITEM_TYPE_PRODUCT",52],"]",")",")",["T_WHITESPACE"," ",52],"{",["T_WHITESPACE","\n            ",52],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","processProductItems",53],"(",["T_VARIABLE","$shippingAssignment",53],",",["T_WHITESPACE"," ",53],["T_VARIABLE","$itemsByType",53],"[",["T_STRING","self",53],["T_DOUBLE_COLON","::",53],["T_STRING","ITEM_TYPE_PRODUCT",53],"]",",",["T_WHITESPACE"," ",53],["T_VARIABLE","$total",53],")",";",["T_WHITESPACE","\n        ",53],"}",["T_WHITESPACE","\n\n        ",54],["T_RETURN","return",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$this",56],";",["T_WHITESPACE","\n    ",56],"}",["T_WHITESPACE","\n\n    ",57],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Quote\\Model\\Quote $quote\n     * @param Address\\Total $total\n     * @return null\n     * @codeCoverageIgnore\n     *\/",59],["T_WHITESPACE","\n    ",64],["T_PUBLIC","public",65],["T_WHITESPACE"," ",65],["T_FUNCTION","function",65],["T_WHITESPACE"," ",65],["T_STRING","fetch",65],"(",["T_NS_SEPARATOR","\\",65],["T_STRING","Magento",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Quote",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Model",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Quote",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$quote",65],",",["T_WHITESPACE"," ",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Magento",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Quote",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Model",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Quote",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Address",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Total",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$total",65],")",["T_WHITESPACE","\n    ",65],"{",["T_WHITESPACE","\n        ",66],["T_RETURN","return",67],["T_WHITESPACE"," ",67],["T_STRING","null",67],";",["T_WHITESPACE","\n    ",67],"}",["T_WHITESPACE","\n",68],"}",["T_WHITESPACE","\n",69]]