[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Tax",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Quote",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Quote",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Api",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Data",8],["T_NS_SEPARATOR","\\",8],["T_STRING","TotalSegmentExtensionFactory",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Serialize",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Serializer",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Json",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","App",10],["T_NS_SEPARATOR","\\",10],["T_STRING","ObjectManager",10],";",["T_WHITESPACE","\n\n",10],["T_CLASS","class",12],["T_WHITESPACE"," ",12],["T_STRING","GrandTotalDetailsPlugin",12],["T_WHITESPACE","\n",12],"{",["T_WHITESPACE","\n    ",13],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Tax\\Api\\Data\\GrandTotalDetailsInterfaceFactory\n     *\/",14],["T_WHITESPACE","\n    ",16],["T_PRIVATE","private",17],["T_WHITESPACE"," ",17],["T_VARIABLE","$detailsFactory",17],";",["T_WHITESPACE","\n\n    ",17],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Tax\\Api\\Data\\GrandTotalRatesInterfaceFactory\n     *\/",19],["T_WHITESPACE","\n    ",21],["T_PRIVATE","private",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$ratesFactory",22],";",["T_WHITESPACE","\n\n    ",22],["T_DOC_COMMENT","\/**\n     * @var TotalSegmentExtensionFactory\n     *\/",24],["T_WHITESPACE","\n    ",26],["T_PRIVATE","private",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$totalSegmentExtensionFactory",27],";",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Tax\\Model\\Config\n     *\/",29],["T_WHITESPACE","\n    ",31],["T_PRIVATE","private",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$taxConfig",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * @var string\n     *\/",34],["T_WHITESPACE","\n    ",36],["T_PRIVATE","private",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$code",37],";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * @var Json\n     *\/",39],["T_WHITESPACE","\n    ",41],["T_PRIVATE","private",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$serializer",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Constructor\n     *\n     * @param \\Magento\\Tax\\Api\\Data\\GrandTotalDetailsInterfaceFactory $detailsFactory\n     * @param \\Magento\\Tax\\Api\\Data\\GrandTotalRatesInterfaceFactory $ratesFactory\n     * @param TotalSegmentExtensionFactory $totalSegmentExtensionFactory\n     * @param \\Magento\\Tax\\Model\\Config $taxConfig\n     * @param Json $serializer\n     *\/",44],["T_WHITESPACE","\n    ",52],["T_PUBLIC","public",53],["T_WHITESPACE"," ",53],["T_FUNCTION","function",53],["T_WHITESPACE"," ",53],["T_STRING","__construct",53],"(",["T_WHITESPACE","\n        ",53],["T_NS_SEPARATOR","\\",54],["T_STRING","Magento",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Tax",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Api",54],["T_NS_SEPARATOR","\\",54],["T_STRING","Data",54],["T_NS_SEPARATOR","\\",54],["T_STRING","GrandTotalDetailsInterfaceFactory",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$detailsFactory",54],",",["T_WHITESPACE","\n        ",54],["T_NS_SEPARATOR","\\",55],["T_STRING","Magento",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Tax",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Api",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Data",55],["T_NS_SEPARATOR","\\",55],["T_STRING","GrandTotalRatesInterfaceFactory",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$ratesFactory",55],",",["T_WHITESPACE","\n        ",55],["T_STRING","TotalSegmentExtensionFactory",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$totalSegmentExtensionFactory",56],",",["T_WHITESPACE","\n        ",56],["T_NS_SEPARATOR","\\",57],["T_STRING","Magento",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Tax",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Model",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Config",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$taxConfig",57],",",["T_WHITESPACE","\n        ",57],["T_STRING","Json",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$serializer",58],["T_WHITESPACE","\n    ",58],")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","detailsFactory",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$detailsFactory",60],";",["T_WHITESPACE","\n        ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","ratesFactory",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_VARIABLE","$ratesFactory",61],";",["T_WHITESPACE","\n        ",61],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","totalSegmentExtensionFactory",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_VARIABLE","$totalSegmentExtensionFactory",62],";",["T_WHITESPACE","\n        ",62],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","taxConfig",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_VARIABLE","$taxConfig",63],";",["T_WHITESPACE","\n        ",63],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","serializer",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$serializer",64],";",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","code",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'tax'",65],";",["T_WHITESPACE","\n    ",65],"}",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * @param array $rates\n     * @return array\n     *\/",68],["T_WHITESPACE","\n    ",71],["T_PROTECTED","protected",72],["T_WHITESPACE"," ",72],["T_FUNCTION","function",72],["T_WHITESPACE"," ",72],["T_STRING","getRatesData",72],"(",["T_VARIABLE","$rates",72],")",["T_WHITESPACE","\n    ",72],"{",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$taxRates",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],"[","]",";",["T_WHITESPACE","\n        ",74],["T_FOREACH","foreach",75],["T_WHITESPACE"," ",75],"(",["T_VARIABLE","$rates",75],["T_WHITESPACE"," ",75],["T_AS","as",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$rate",75],")",["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n            ",75],["T_VARIABLE","$taxRate",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","ratesFactory",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","create",76],"(","[","]",")",";",["T_WHITESPACE","\n            ",76],["T_VARIABLE","$taxRate",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","setPercent",77],"(",["T_VARIABLE","$rate",77],"[",["T_CONSTANT_ENCAPSED_STRING","'percent'",77],"]",")",";",["T_WHITESPACE","\n            ",77],["T_VARIABLE","$taxRate",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","setTitle",78],"(",["T_VARIABLE","$rate",78],"[",["T_CONSTANT_ENCAPSED_STRING","'title'",78],"]",")",";",["T_WHITESPACE","\n            ",78],["T_VARIABLE","$taxRates",79],"[","]",["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$taxRate",79],";",["T_WHITESPACE","\n        ",79],"}",["T_WHITESPACE","\n        ",80],["T_RETURN","return",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$taxRates",81],";",["T_WHITESPACE","\n    ",81],"}",["T_WHITESPACE","\n\n    ",82],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Quote\\Model\\Cart\\TotalsConverter $subject\n     * @param \\Magento\\Quote\\Api\\Data\\TotalSegmentInterface[] $totalSegments\n     * @param \\Magento\\Quote\\Model\\Quote\\Address\\Total[] $addressTotals\n     * @return \\Magento\\Quote\\Api\\Data\\TotalSegmentInterface[]\n     * @SuppressWarnings(PHPMD.UnusedFormalParameter)\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     *\/",84],["T_WHITESPACE","\n    ",91],["T_PUBLIC","public",92],["T_WHITESPACE"," ",92],["T_FUNCTION","function",92],["T_WHITESPACE"," ",92],["T_STRING","afterProcess",92],"(",["T_WHITESPACE","\n        ",92],["T_NS_SEPARATOR","\\",93],["T_STRING","Magento",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Quote",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Model",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Cart",93],["T_NS_SEPARATOR","\\",93],["T_STRING","TotalsConverter",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$subject",93],",",["T_WHITESPACE","\n        ",93],["T_ARRAY","array",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$totalSegments",94],",",["T_WHITESPACE","\n        ",94],["T_ARRAY","array",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$addressTotals",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],"[","]",["T_WHITESPACE","\n    ",95],")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n\n        ",96],["T_IF","if",98],["T_WHITESPACE"," ",98],"(","!",["T_STRING","array_key_exists",98],"(",["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","code",98],",",["T_WHITESPACE"," ",98],["T_VARIABLE","$addressTotals",98],")",")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n            ",98],["T_RETURN","return",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$totalSegments",99],";",["T_WHITESPACE","\n        ",99],"}",["T_WHITESPACE","\n\n        ",100],["T_VARIABLE","$taxes",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$addressTotals",102],"[",["T_CONSTANT_ENCAPSED_STRING","'tax'",102],"]",["T_OBJECT_OPERATOR","->",102],["T_STRING","getData",102],"(",")",";",["T_WHITESPACE","\n        ",102],["T_IF","if",103],["T_WHITESPACE"," ",103],"(","!",["T_STRING","array_key_exists",103],"(",["T_CONSTANT_ENCAPSED_STRING","'full_info'",103],",",["T_WHITESPACE"," ",103],["T_VARIABLE","$taxes",103],")",")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n            ",103],["T_RETURN","return",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$totalSegments",104],";",["T_WHITESPACE","\n        ",104],"}",["T_WHITESPACE","\n\n        ",105],["T_VARIABLE","$detailsId",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_LNUMBER","1",107],";",["T_WHITESPACE","\n        ",107],["T_VARIABLE","$finalData",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],"[","]",";",["T_WHITESPACE","\n        ",108],["T_VARIABLE","$fullInfo",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_VARIABLE","$taxes",109],"[",["T_CONSTANT_ENCAPSED_STRING","'full_info'",109],"]",";",["T_WHITESPACE","\n        ",109],["T_IF","if",110],["T_WHITESPACE"," ",110],"(",["T_STRING","is_string",110],"(",["T_VARIABLE","$fullInfo",110],")",")",["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n            ",110],["T_VARIABLE","$fullInfo",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","serializer",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","unserialize",111],"(",["T_VARIABLE","$fullInfo",111],")",";",["T_WHITESPACE","\n        ",111],"}",["T_WHITESPACE","\n        ",112],["T_FOREACH","foreach",113],["T_WHITESPACE"," ",113],"(",["T_VARIABLE","$fullInfo",113],["T_WHITESPACE"," ",113],["T_AS","as",113],["T_WHITESPACE"," ",113],["T_VARIABLE","$info",113],")",["T_WHITESPACE"," ",113],"{",["T_WHITESPACE","\n            ",113],["T_IF","if",114],["T_WHITESPACE"," ",114],"(","(",["T_STRING","array_key_exists",114],"(",["T_CONSTANT_ENCAPSED_STRING","'hidden'",114],",",["T_WHITESPACE"," ",114],["T_VARIABLE","$info",114],")",["T_WHITESPACE"," ",114],["T_BOOLEAN_AND","&&",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$info",114],"[",["T_CONSTANT_ENCAPSED_STRING","'hidden'",114],"]",")",["T_WHITESPACE","\n                ",114],["T_BOOLEAN_OR","||",115],["T_WHITESPACE"," ",115],"(",["T_VARIABLE","$info",115],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",115],"]",["T_WHITESPACE"," ",115],["T_IS_EQUAL","==",115],["T_WHITESPACE"," ",115],["T_LNUMBER","0",115],["T_WHITESPACE"," ",115],["T_BOOLEAN_AND","&&",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","taxConfig",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","displayCartZeroTax",115],"(",")",")",["T_WHITESPACE","\n            ",115],")",["T_WHITESPACE"," ",116],"{",["T_WHITESPACE","\n                ",116],["T_CONTINUE","continue",117],";",["T_WHITESPACE","\n            ",117],"}",["T_WHITESPACE","\n\n            ",118],["T_VARIABLE","$taxDetails",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","detailsFactory",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","create",120],"(","[","]",")",";",["T_WHITESPACE","\n            ",120],["T_VARIABLE","$taxDetails",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","setAmount",121],"(",["T_VARIABLE","$info",121],"[",["T_CONSTANT_ENCAPSED_STRING","'amount'",121],"]",")",";",["T_WHITESPACE","\n            ",121],["T_VARIABLE","$taxRates",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","getRatesData",122],"(",["T_VARIABLE","$info",122],"[",["T_CONSTANT_ENCAPSED_STRING","'rates'",122],"]",")",";",["T_WHITESPACE","\n            ",122],["T_VARIABLE","$taxDetails",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","setRates",123],"(",["T_VARIABLE","$taxRates",123],")",";",["T_WHITESPACE","\n            ",123],["T_VARIABLE","$taxDetails",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","setGroupId",124],"(",["T_VARIABLE","$detailsId",124],")",";",["T_WHITESPACE","\n            ",124],["T_VARIABLE","$finalData",125],"[","]",["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_VARIABLE","$taxDetails",125],";",["T_WHITESPACE","\n            ",125],["T_VARIABLE","$detailsId",126],["T_INC","++",126],";",["T_WHITESPACE","\n        ",126],"}",["T_WHITESPACE","\n        ",127],["T_VARIABLE","$attributes",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_VARIABLE","$totalSegments",128],"[",["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","code",128],"]",["T_OBJECT_OPERATOR","->",128],["T_STRING","getExtensionAttributes",128],"(",")",";",["T_WHITESPACE","\n        ",128],["T_IF","if",129],["T_WHITESPACE"," ",129],"(",["T_VARIABLE","$attributes",129],["T_WHITESPACE"," ",129],["T_IS_IDENTICAL","===",129],["T_WHITESPACE"," ",129],["T_STRING","null",129],")",["T_WHITESPACE"," ",129],"{",["T_WHITESPACE","\n            ",129],["T_VARIABLE","$attributes",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","totalSegmentExtensionFactory",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","create",130],"(",")",";",["T_WHITESPACE","\n        ",130],"}",["T_WHITESPACE","\n        ",131],["T_VARIABLE","$attributes",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","setTaxGrandtotalDetails",132],"(",["T_VARIABLE","$finalData",132],")",";",["T_WHITESPACE","\n        ",132],["T_VARIABLE","$totalSegments",133],"[",["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","code",133],"]",["T_OBJECT_OPERATOR","->",133],["T_STRING","setExtensionAttributes",133],"(",["T_VARIABLE","$attributes",133],")",";",["T_WHITESPACE","\n        ",133],["T_RETURN","return",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$totalSegments",134],";",["T_WHITESPACE","\n    ",134],"}",["T_WHITESPACE","\n",135],"}",["T_WHITESPACE","\n",136]]