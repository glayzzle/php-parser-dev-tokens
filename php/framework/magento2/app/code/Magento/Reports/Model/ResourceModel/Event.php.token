[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Reports",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","ResourceModel",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Report events resource model\n *\/",8],["T_WHITESPACE","\n",10],["T_CLASS","class",11],["T_WHITESPACE"," ",11],["T_STRING","Event",11],["T_WHITESPACE"," ",11],["T_EXTENDS","extends",11],["T_WHITESPACE"," ",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Framework",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Model",11],["T_NS_SEPARATOR","\\",11],["T_STRING","ResourceModel",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Db",11],["T_NS_SEPARATOR","\\",11],["T_STRING","AbstractDb",11],["T_WHITESPACE","\n",11],"{",["T_WHITESPACE","\n    ",12],["T_DOC_COMMENT","\/**\n     * Core store config\n     *\n     * @var \\Magento\\Framework\\App\\Config\\ScopeConfigInterface\n     *\/",13],["T_WHITESPACE","\n    ",17],["T_PROTECTED","protected",18],["T_WHITESPACE"," ",18],["T_VARIABLE","$_scopeConfig",18],";",["T_WHITESPACE","\n\n    ",18],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Store\\Model\\StoreManagerInterface\n     *\/",20],["T_WHITESPACE","\n    ",22],["T_PROTECTED","protected",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$_storeManager",23],";",["T_WHITESPACE","\n\n    ",23],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\Model\\ResourceModel\\Db\\Context $context\n     * @param \\Magento\\Framework\\App\\Config\\ScopeConfigInterface $scopeConfig\n     * @param \\Magento\\Store\\Model\\StoreManagerInterface $storeManager\n     * @param string $connectionName\n     *\/",25],["T_WHITESPACE","\n    ",30],["T_PUBLIC","public",31],["T_WHITESPACE"," ",31],["T_FUNCTION","function",31],["T_WHITESPACE"," ",31],["T_STRING","__construct",31],"(",["T_WHITESPACE","\n        ",31],["T_NS_SEPARATOR","\\",32],["T_STRING","Magento",32],["T_NS_SEPARATOR","\\",32],["T_STRING","Framework",32],["T_NS_SEPARATOR","\\",32],["T_STRING","Model",32],["T_NS_SEPARATOR","\\",32],["T_STRING","ResourceModel",32],["T_NS_SEPARATOR","\\",32],["T_STRING","Db",32],["T_NS_SEPARATOR","\\",32],["T_STRING","Context",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$context",32],",",["T_WHITESPACE","\n        ",32],["T_NS_SEPARATOR","\\",33],["T_STRING","Magento",33],["T_NS_SEPARATOR","\\",33],["T_STRING","Framework",33],["T_NS_SEPARATOR","\\",33],["T_STRING","App",33],["T_NS_SEPARATOR","\\",33],["T_STRING","Config",33],["T_NS_SEPARATOR","\\",33],["T_STRING","ScopeConfigInterface",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$scopeConfig",33],",",["T_WHITESPACE","\n        ",33],["T_NS_SEPARATOR","\\",34],["T_STRING","Magento",34],["T_NS_SEPARATOR","\\",34],["T_STRING","Store",34],["T_NS_SEPARATOR","\\",34],["T_STRING","Model",34],["T_NS_SEPARATOR","\\",34],["T_STRING","StoreManagerInterface",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$storeManager",34],",",["T_WHITESPACE","\n        ",34],["T_VARIABLE","$connectionName",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_STRING","null",35],["T_WHITESPACE","\n    ",35],")",["T_WHITESPACE"," ",36],"{",["T_WHITESPACE","\n        ",36],["T_STRING","parent",37],["T_DOUBLE_COLON","::",37],["T_STRING","__construct",37],"(",["T_VARIABLE","$context",37],",",["T_WHITESPACE"," ",37],["T_VARIABLE","$connectionName",37],")",";",["T_WHITESPACE","\n        ",37],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","_scopeConfig",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_VARIABLE","$scopeConfig",38],";",["T_WHITESPACE","\n        ",38],["T_VARIABLE","$this",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","_storeManager",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_VARIABLE","$storeManager",39],";",["T_WHITESPACE","\n    ",39],"}",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/**\n     * Initialize main table and identifier field. Set main entity table name and primary key field name.\n     *\n     * @return void\n     *\/",42],["T_WHITESPACE","\n    ",46],["T_PROTECTED","protected",47],["T_WHITESPACE"," ",47],["T_FUNCTION","function",47],["T_WHITESPACE"," ",47],["T_STRING","_construct",47],"(",")",["T_WHITESPACE","\n    ",47],"{",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","_init",49],"(",["T_CONSTANT_ENCAPSED_STRING","'report_event'",49],",",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'event_id'",49],")",";",["T_WHITESPACE","\n    ",49],"}",["T_WHITESPACE","\n\n    ",50],["T_DOC_COMMENT","\/**\n     * Update customer type after customer login\n     *\n     * @param \\Magento\\Reports\\Model\\Event $model\n     * @param int $visitorId\n     * @param int $customerId\n     * @param array $types\n     * @return $this\n     * @SuppressWarnings(PHPMD.UnusedFormalParameter)\n     *\/",52],["T_WHITESPACE","\n    ",61],["T_PUBLIC","public",62],["T_WHITESPACE"," ",62],["T_FUNCTION","function",62],["T_WHITESPACE"," ",62],["T_STRING","updateCustomerType",62],"(",["T_NS_SEPARATOR","\\",62],["T_STRING","Magento",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Reports",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Model",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Event",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$model",62],",",["T_WHITESPACE"," ",62],["T_VARIABLE","$visitorId",62],",",["T_WHITESPACE"," ",62],["T_VARIABLE","$customerId",62],",",["T_WHITESPACE"," ",62],["T_VARIABLE","$types",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],"[","]",")",["T_WHITESPACE","\n    ",62],"{",["T_WHITESPACE","\n        ",63],["T_IF","if",64],["T_WHITESPACE"," ",64],"(",["T_VARIABLE","$types",64],")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n            ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getConnection",65],"(",")",["T_OBJECT_OPERATOR","->",65],["T_STRING","update",65],"(",["T_WHITESPACE","\n                ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getMainTable",66],"(",")",",",["T_WHITESPACE","\n                ",66],"[",["T_CONSTANT_ENCAPSED_STRING","'subject_id'",67],["T_WHITESPACE"," ",67],["T_DOUBLE_ARROW","=>",67],["T_WHITESPACE"," ",67],["T_INT_CAST","(int)",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$customerId",67],",",["T_WHITESPACE"," ",67],["T_CONSTANT_ENCAPSED_STRING","'subtype'",67],["T_WHITESPACE"," ",67],["T_DOUBLE_ARROW","=>",67],["T_WHITESPACE"," ",67],["T_LNUMBER","0",67],"]",",",["T_WHITESPACE","\n                ",67],"[",["T_CONSTANT_ENCAPSED_STRING","'subject_id = ?'",68],["T_WHITESPACE"," ",68],["T_DOUBLE_ARROW","=>",68],["T_WHITESPACE"," ",68],["T_INT_CAST","(int)",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$visitorId",68],",",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'subtype = ?'",68],["T_WHITESPACE"," ",68],["T_DOUBLE_ARROW","=>",68],["T_WHITESPACE"," ",68],["T_LNUMBER","1",68],",",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'event_type_id IN(?)'",68],["T_WHITESPACE"," ",68],["T_DOUBLE_ARROW","=>",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$types",68],"]",["T_WHITESPACE","\n            ",68],")",";",["T_WHITESPACE","\n        ",69],"}",["T_WHITESPACE","\n        ",70],["T_RETURN","return",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$this",71],";",["T_WHITESPACE","\n    ",71],"}",["T_WHITESPACE","\n\n    ",72],["T_DOC_COMMENT","\/**\n     * Add events log to a collection\n     * The collection id field is used without corellation, so it must be unique.\n     * DESC ordering by event will be added to the collection\n     *\n     * @param \\Magento\\Framework\\Data\\Collection\\AbstractDb $collection\n     * @param int $eventTypeId\n     * @param int $eventSubjectId\n     * @param int $subtype\n     * @param array $skipIds\n     * @return $this\n     *\/",74],["T_WHITESPACE","\n    ",85],["T_PUBLIC","public",86],["T_WHITESPACE"," ",86],["T_FUNCTION","function",86],["T_WHITESPACE"," ",86],["T_STRING","applyLogToCollection",86],"(",["T_WHITESPACE","\n        ",86],["T_NS_SEPARATOR","\\",87],["T_STRING","Magento",87],["T_NS_SEPARATOR","\\",87],["T_STRING","Framework",87],["T_NS_SEPARATOR","\\",87],["T_STRING","Data",87],["T_NS_SEPARATOR","\\",87],["T_STRING","Collection",87],["T_NS_SEPARATOR","\\",87],["T_STRING","AbstractDb",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$collection",87],",",["T_WHITESPACE","\n        ",87],["T_VARIABLE","$eventTypeId",88],",",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$eventSubjectId",89],",",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$subtype",90],",",["T_WHITESPACE","\n        ",90],["T_VARIABLE","$skipIds",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],"[","]",["T_WHITESPACE","\n    ",91],")",["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n        ",92],["T_VARIABLE","$idFieldName",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$collection",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getResource",93],"(",")",["T_OBJECT_OPERATOR","->",93],["T_STRING","getIdFieldName",93],"(",")",";",["T_WHITESPACE","\n\n        ",93],["T_VARIABLE","$derivedSelect",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getConnection",95],"(",")",["T_WHITESPACE","\n            ",95],["T_OBJECT_OPERATOR","->",96],["T_STRING","select",96],"(",")",["T_WHITESPACE","\n            ",96],["T_OBJECT_OPERATOR","->",97],["T_STRING","from",97],"(",["T_WHITESPACE","\n                ",97],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","getTable",98],"(",["T_CONSTANT_ENCAPSED_STRING","'report_event'",98],")",",",["T_WHITESPACE","\n                ",98],"[",["T_CONSTANT_ENCAPSED_STRING","'event_id'",99],["T_WHITESPACE"," ",99],["T_DOUBLE_ARROW","=>",99],["T_WHITESPACE"," ",99],["T_NEW","new",99],["T_WHITESPACE"," ",99],["T_NS_SEPARATOR","\\",99],["T_STRING","Zend_Db_Expr",99],"(",["T_CONSTANT_ENCAPSED_STRING","'MAX(event_id)'",99],")",",",["T_WHITESPACE"," ",99],["T_CONSTANT_ENCAPSED_STRING","'object_id'",99],"]",["T_WHITESPACE","\n            ",99],")",["T_WHITESPACE","\n            ",100],["T_OBJECT_OPERATOR","->",101],["T_STRING","where",101],"(",["T_CONSTANT_ENCAPSED_STRING","'event_type_id = ?'",101],",",["T_WHITESPACE"," ",101],["T_INT_CAST","(int)",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$eventTypeId",101],")",["T_WHITESPACE","\n            ",101],["T_OBJECT_OPERATOR","->",102],["T_STRING","where",102],"(",["T_CONSTANT_ENCAPSED_STRING","'subject_id = ?'",102],",",["T_WHITESPACE"," ",102],["T_INT_CAST","(int)",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$eventSubjectId",102],")",["T_WHITESPACE","\n            ",102],["T_OBJECT_OPERATOR","->",103],["T_STRING","where",103],"(",["T_CONSTANT_ENCAPSED_STRING","'subtype = ?'",103],",",["T_WHITESPACE"," ",103],["T_INT_CAST","(int)",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$subtype",103],")",["T_WHITESPACE","\n            ",103],["T_OBJECT_OPERATOR","->",104],["T_STRING","where",104],"(",["T_CONSTANT_ENCAPSED_STRING","'store_id IN(?)'",104],",",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getCurrentStoreIds",104],"(",")",")",["T_WHITESPACE","\n            ",104],["T_OBJECT_OPERATOR","->",105],["T_STRING","group",105],"(",["T_CONSTANT_ENCAPSED_STRING","'object_id'",105],")",";",["T_WHITESPACE","\n\n        ",105],["T_IF","if",107],["T_WHITESPACE"," ",107],"(",["T_VARIABLE","$skipIds",107],")",["T_WHITESPACE"," ",107],"{",["T_WHITESPACE","\n            ",107],["T_IF","if",108],["T_WHITESPACE"," ",108],"(","!",["T_STRING","is_array",108],"(",["T_VARIABLE","$skipIds",108],")",")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n                ",108],["T_VARIABLE","$skipIds",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],"[",["T_INT_CAST","(int)",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$skipIds",109],"]",";",["T_WHITESPACE","\n            ",109],"}",["T_WHITESPACE","\n            ",110],["T_VARIABLE","$derivedSelect",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","where",111],"(",["T_CONSTANT_ENCAPSED_STRING","'object_id NOT IN(?)'",111],",",["T_WHITESPACE"," ",111],["T_VARIABLE","$skipIds",111],")",";",["T_WHITESPACE","\n        ",111],"}",["T_WHITESPACE","\n\n        ",112],["T_VARIABLE","$collection",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","getSelect",114],"(",")",["T_OBJECT_OPERATOR","->",114],["T_STRING","joinInner",114],"(",["T_WHITESPACE","\n            ",114],"[",["T_CONSTANT_ENCAPSED_STRING","'evt'",115],["T_WHITESPACE"," ",115],["T_DOUBLE_ARROW","=>",115],["T_WHITESPACE"," ",115],["T_NEW","new",115],["T_WHITESPACE"," ",115],["T_NS_SEPARATOR","\\",115],["T_STRING","Zend_Db_Expr",115],"(","\"",["T_ENCAPSED_AND_WHITESPACE","(",115],["T_CURLY_OPEN","{",115],["T_VARIABLE","$derivedSelect",115],"}",["T_ENCAPSED_AND_WHITESPACE",")",115],"\"",")","]",",",["T_WHITESPACE","\n            ",115],"\"",["T_CURLY_OPEN","{",116],["T_VARIABLE","$idFieldName",116],"}",["T_ENCAPSED_AND_WHITESPACE"," = evt.object_id",116],"\"",",",["T_WHITESPACE","\n            ",116],"[","]",["T_WHITESPACE","\n        ",117],")",["T_OBJECT_OPERATOR","->",118],["T_STRING","order",118],"(",["T_CONSTANT_ENCAPSED_STRING","'evt.event_id '",118],["T_WHITESPACE"," ",118],".",["T_WHITESPACE"," ",118],["T_NS_SEPARATOR","\\",118],["T_STRING","Magento",118],["T_NS_SEPARATOR","\\",118],["T_STRING","Framework",118],["T_NS_SEPARATOR","\\",118],["T_STRING","DB",118],["T_NS_SEPARATOR","\\",118],["T_STRING","Select",118],["T_DOUBLE_COLON","::",118],["T_STRING","SQL_DESC",118],")",";",["T_WHITESPACE","\n\n        ",118],["T_RETURN","return",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],";",["T_WHITESPACE","\n    ",120],"}",["T_WHITESPACE","\n\n    ",121],["T_DOC_COMMENT","\/**\n     * Obtain all current store ids, depending on configuration\n     *\n     * @param null|array $predefinedStoreIds\n     * @return array\n     *\/",123],["T_WHITESPACE","\n    ",128],["T_PUBLIC","public",129],["T_WHITESPACE"," ",129],["T_FUNCTION","function",129],["T_WHITESPACE"," ",129],["T_STRING","getCurrentStoreIds",129],"(",["T_ARRAY","array",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$predefinedStoreIds",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_STRING","null",129],")",["T_WHITESPACE","\n    ",129],"{",["T_WHITESPACE","\n        ",130],["T_VARIABLE","$stores",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],"[","]",";",["T_WHITESPACE","\n        ",131],["T_COMMENT","\/\/ get all or specified stores\n",132],["T_WHITESPACE","        ",133],["T_IF","if",133],["T_WHITESPACE"," ",133],"(",["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_storeManager",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getStore",133],"(",")",["T_OBJECT_OPERATOR","->",133],["T_STRING","getId",133],"(",")",["T_WHITESPACE"," ",133],["T_IS_EQUAL","==",133],["T_WHITESPACE"," ",133],["T_LNUMBER","0",133],")",["T_WHITESPACE"," ",133],"{",["T_WHITESPACE","\n            ",133],["T_IF","if",134],["T_WHITESPACE"," ",134],"(",["T_STRING","null",134],["T_WHITESPACE"," ",134],["T_IS_NOT_IDENTICAL","!==",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$predefinedStoreIds",134],")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n                ",134],["T_VARIABLE","$stores",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_VARIABLE","$predefinedStoreIds",135],";",["T_WHITESPACE","\n            ",135],"}",["T_WHITESPACE"," ",136],["T_ELSE","else",136],["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n                ",136],["T_FOREACH","foreach",137],["T_WHITESPACE"," ",137],"(",["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","_storeManager",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","getStores",137],"(",")",["T_WHITESPACE"," ",137],["T_AS","as",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$store",137],")",["T_WHITESPACE"," ",137],"{",["T_WHITESPACE","\n                    ",137],["T_VARIABLE","$stores",138],"[","]",["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_VARIABLE","$store",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","getId",138],"(",")",";",["T_WHITESPACE","\n                ",138],"}",["T_WHITESPACE","\n            ",139],"}",["T_WHITESPACE","\n        ",140],"}",["T_WHITESPACE"," ",141],["T_ELSE","else",141],["T_WHITESPACE"," ",141],"{",["T_WHITESPACE","\n            ",141],["T_COMMENT","\/\/ get all stores, required by configuration in current store scope\n",142],["T_WHITESPACE","            ",143],["T_VARIABLE","$productsScope",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","_scopeConfig",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getValue",143],"(",["T_WHITESPACE","\n                ",143],["T_CONSTANT_ENCAPSED_STRING","'catalog\/recently_products\/scope'",144],",",["T_WHITESPACE","\n                ",144],["T_NS_SEPARATOR","\\",145],["T_STRING","Magento",145],["T_NS_SEPARATOR","\\",145],["T_STRING","Store",145],["T_NS_SEPARATOR","\\",145],["T_STRING","Model",145],["T_NS_SEPARATOR","\\",145],["T_STRING","ScopeInterface",145],["T_DOUBLE_COLON","::",145],["T_STRING","SCOPE_STORE",145],["T_WHITESPACE","\n            ",145],")",";",["T_WHITESPACE","\n            ",146],["T_SWITCH","switch",147],["T_WHITESPACE"," ",147],"(",["T_VARIABLE","$productsScope",147],")",["T_WHITESPACE"," ",147],"{",["T_WHITESPACE","\n                ",147],["T_CASE","case",148],["T_WHITESPACE"," ",148],["T_CONSTANT_ENCAPSED_STRING","'website'",148],":",["T_WHITESPACE","\n                    ",148],["T_VARIABLE","$resourceStore",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","_storeManager",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","getStore",149],"(",")",["T_OBJECT_OPERATOR","->",149],["T_STRING","getWebsite",149],"(",")",["T_OBJECT_OPERATOR","->",149],["T_STRING","getStores",149],"(",")",";",["T_WHITESPACE","\n                    ",149],["T_BREAK","break",150],";",["T_WHITESPACE","\n                ",150],["T_CASE","case",151],["T_WHITESPACE"," ",151],["T_CONSTANT_ENCAPSED_STRING","'group'",151],":",["T_WHITESPACE","\n                    ",151],["T_VARIABLE","$resourceStore",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","_storeManager",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","getStore",152],"(",")",["T_OBJECT_OPERATOR","->",152],["T_STRING","getGroup",152],"(",")",["T_OBJECT_OPERATOR","->",152],["T_STRING","getStores",152],"(",")",";",["T_WHITESPACE","\n                    ",152],["T_BREAK","break",153],";",["T_WHITESPACE","\n                ",153],["T_DEFAULT","default",154],":",["T_WHITESPACE","\n                    ",154],["T_VARIABLE","$resourceStore",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],"[",["T_VARIABLE","$this",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","_storeManager",155],["T_OBJECT_OPERATOR","->",155],["T_STRING","getStore",155],"(",")","]",";",["T_WHITESPACE","\n                    ",155],["T_BREAK","break",156],";",["T_WHITESPACE","\n            ",156],"}",["T_WHITESPACE","\n\n            ",157],["T_FOREACH","foreach",159],["T_WHITESPACE"," ",159],"(",["T_VARIABLE","$resourceStore",159],["T_WHITESPACE"," ",159],["T_AS","as",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$store",159],")",["T_WHITESPACE"," ",159],"{",["T_WHITESPACE","\n                ",159],["T_VARIABLE","$stores",160],"[","]",["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_VARIABLE","$store",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","getId",160],"(",")",";",["T_WHITESPACE","\n            ",160],"}",["T_WHITESPACE","\n        ",161],"}",["T_WHITESPACE","\n        ",162],["T_FOREACH","foreach",163],["T_WHITESPACE"," ",163],"(",["T_VARIABLE","$stores",163],["T_WHITESPACE"," ",163],["T_AS","as",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$key",163],["T_WHITESPACE"," ",163],["T_DOUBLE_ARROW","=>",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$store",163],")",["T_WHITESPACE"," ",163],"{",["T_WHITESPACE","\n            ",163],["T_VARIABLE","$stores",164],"[",["T_VARIABLE","$key",164],"]",["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],["T_INT_CAST","(int)",164],["T_WHITESPACE"," ",164],["T_VARIABLE","$store",164],";",["T_WHITESPACE","\n        ",164],"}",["T_WHITESPACE","\n\n        ",165],["T_RETURN","return",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$stores",167],";",["T_WHITESPACE","\n    ",167],"}",["T_WHITESPACE","\n\n    ",168],["T_DOC_COMMENT","\/**\n     * Clean report event table\n     *\n     * @param \\Magento\\Reports\\Model\\Event $object\n     * @return $this\n     * @SuppressWarnings(PHPMD.UnusedFormalParameter)\n     *\/",170],["T_WHITESPACE","\n    ",176],["T_PUBLIC","public",177],["T_WHITESPACE"," ",177],["T_FUNCTION","function",177],["T_WHITESPACE"," ",177],["T_STRING","clean",177],"(",["T_NS_SEPARATOR","\\",177],["T_STRING","Magento",177],["T_NS_SEPARATOR","\\",177],["T_STRING","Reports",177],["T_NS_SEPARATOR","\\",177],["T_STRING","Model",177],["T_NS_SEPARATOR","\\",177],["T_STRING","Event",177],["T_WHITESPACE"," ",177],["T_VARIABLE","$object",177],")",["T_WHITESPACE","\n    ",177],"{",["T_WHITESPACE","\n        ",178],["T_WHILE","while",179],["T_WHITESPACE"," ",179],"(",["T_STRING","true",179],")",["T_WHITESPACE"," ",179],"{",["T_WHITESPACE","\n            ",179],["T_VARIABLE","$select",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","getConnection",180],"(",")",["T_OBJECT_OPERATOR","->",180],["T_STRING","select",180],"(",")",["T_OBJECT_OPERATOR","->",180],["T_STRING","from",180],"(",["T_WHITESPACE","\n                ",180],"[",["T_CONSTANT_ENCAPSED_STRING","'event_table'",181],["T_WHITESPACE"," ",181],["T_DOUBLE_ARROW","=>",181],["T_WHITESPACE"," ",181],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","getMainTable",181],"(",")","]",",",["T_WHITESPACE","\n                ",181],"[",["T_CONSTANT_ENCAPSED_STRING","'event_id'",182],"]",["T_WHITESPACE","\n            ",182],")",["T_OBJECT_OPERATOR","->",183],["T_STRING","joinLeft",183],"(",["T_WHITESPACE","\n                ",183],"[",["T_CONSTANT_ENCAPSED_STRING","'visitor_table'",184],["T_WHITESPACE"," ",184],["T_DOUBLE_ARROW","=>",184],["T_WHITESPACE"," ",184],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getTable",184],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_visitor'",184],")","]",",",["T_WHITESPACE","\n                ",184],["T_CONSTANT_ENCAPSED_STRING","'event_table.subject_id = visitor_table.visitor_id'",185],",",["T_WHITESPACE","\n                ",185],"[","]",["T_WHITESPACE","\n            ",186],")",["T_OBJECT_OPERATOR","->",187],["T_STRING","where",187],"(",["T_CONSTANT_ENCAPSED_STRING","'visitor_table.visitor_id IS NULL'",187],")",["T_WHITESPACE","\n                ",187],["T_OBJECT_OPERATOR","->",188],["T_STRING","where",188],"(",["T_CONSTANT_ENCAPSED_STRING","'event_table.subtype = ?'",188],",",["T_WHITESPACE"," ",188],["T_LNUMBER","1",188],")",["T_WHITESPACE","\n                ",188],["T_OBJECT_OPERATOR","->",189],["T_STRING","limit",189],"(",["T_LNUMBER","1000",189],")",";",["T_WHITESPACE","\n            ",189],["T_VARIABLE","$eventIds",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","getConnection",190],"(",")",["T_OBJECT_OPERATOR","->",190],["T_STRING","fetchCol",190],"(",["T_VARIABLE","$select",190],")",";",["T_WHITESPACE","\n\n            ",190],["T_IF","if",192],["T_WHITESPACE"," ",192],"(","!",["T_VARIABLE","$eventIds",192],")",["T_WHITESPACE"," ",192],"{",["T_WHITESPACE","\n                ",192],["T_BREAK","break",193],";",["T_WHITESPACE","\n            ",193],"}",["T_WHITESPACE","\n\n            ",194],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","getConnection",196],"(",")",["T_OBJECT_OPERATOR","->",196],["T_STRING","delete",196],"(",["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","getMainTable",196],"(",")",",",["T_WHITESPACE"," ",196],"[",["T_CONSTANT_ENCAPSED_STRING","'event_id IN(?)'",196],["T_WHITESPACE"," ",196],["T_DOUBLE_ARROW","=>",196],["T_WHITESPACE"," ",196],["T_VARIABLE","$eventIds",196],"]",")",";",["T_WHITESPACE","\n        ",196],"}",["T_WHITESPACE","\n        ",197],["T_RETURN","return",198],["T_WHITESPACE"," ",198],["T_VARIABLE","$this",198],";",["T_WHITESPACE","\n    ",198],"}",["T_WHITESPACE","\n",199],"}",["T_WHITESPACE","\n",200]]