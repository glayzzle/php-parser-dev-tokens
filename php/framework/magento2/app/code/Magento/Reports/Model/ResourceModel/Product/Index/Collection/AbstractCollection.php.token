[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Reports Product Index Abstract Product Resource Collection\n *\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",7],["T_WHITESPACE","\n",11],["T_NAMESPACE","namespace",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Reports",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Model",12],["T_NS_SEPARATOR","\\",12],["T_STRING","ResourceModel",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Product",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Index",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Collection",12],";",["T_WHITESPACE","\n\n",12],["T_DOC_COMMENT","\/**\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",14],["T_WHITESPACE","\n",16],["T_ABSTRACT","abstract",17],["T_WHITESPACE"," ",17],["T_CLASS","class",17],["T_WHITESPACE"," ",17],["T_STRING","AbstractCollection",17],["T_WHITESPACE"," ",17],["T_EXTENDS","extends",17],["T_WHITESPACE"," ",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Magento",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Catalog",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Model",17],["T_NS_SEPARATOR","\\",17],["T_STRING","ResourceModel",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Product",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Collection",17],["T_WHITESPACE","\n",17],"{",["T_WHITESPACE","\n    ",18],["T_DOC_COMMENT","\/**\n     * Customer id\n     *\n     * @var null|int\n     *\/",19],["T_WHITESPACE","\n    ",23],["T_PROTECTED","protected",24],["T_WHITESPACE"," ",24],["T_VARIABLE","$_customerId",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_STRING","null",24],";",["T_WHITESPACE","\n\n    ",24],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Customer\\Model\\Visitor\n     *\/",26],["T_WHITESPACE","\n    ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$_customerVisitor",29],";",["T_WHITESPACE","\n\n    ",29],["T_DOC_COMMENT","\/**\n     * AbstractCollection constructor.\n     * @param \\Magento\\Framework\\Data\\Collection\\EntityFactory $entityFactory\n     * @param \\Psr\\Log\\LoggerInterface $logger\n     * @param \\Magento\\Framework\\Data\\Collection\\Db\\FetchStrategyInterface $fetchStrategy\n     * @param \\Magento\\Framework\\Event\\ManagerInterface $eventManager\n     * @param \\Magento\\Eav\\Model\\Config $eavConfig\n     * @param \\Magento\\Framework\\App\\ResourceConnection $resource\n     * @param \\Magento\\Eav\\Model\\EntityFactory $eavEntityFactory\n     * @param \\Magento\\Catalog\\Model\\ResourceModel\\Helper $resourceHelper\n     * @param \\Magento\\Framework\\Validator\\UniversalFactory $universalFactory\n     * @param \\Magento\\Store\\Model\\StoreManagerInterface $storeManager\n     * @param \\Magento\\Framework\\Module\\Manager $moduleManager\n     * @param \\Magento\\Catalog\\Model\\Indexer\\Product\\Flat\\State $catalogProductFlatState\n     * @param \\Magento\\Framework\\App\\Config\\ScopeConfigInterface $scopeConfig\n     * @param \\Magento\\Catalog\\Model\\Product\\OptionFactory $productOptionFactory\n     * @param \\Magento\\Catalog\\Model\\ResourceModel\\Url $catalogUrl\n     * @param \\Magento\\Framework\\Stdlib\\DateTime\\TimezoneInterface $localeDate\n     * @param \\Magento\\Customer\\Model\\Session $customerSession\n     * @param \\Magento\\Framework\\Stdlib\\DateTime $dateTime\n     * @param \\Magento\\Customer\\Api\\GroupManagementInterface $groupManagement\n     * @param \\Magento\\Customer\\Model\\Visitor $customerVisitor\n     * @param mixed $connection\n     *\n     * @SuppressWarnings(PHPMD.ExcessiveParameterList)\n     *\/",31],["T_WHITESPACE","\n    ",56],["T_PUBLIC","public",57],["T_WHITESPACE"," ",57],["T_FUNCTION","function",57],["T_WHITESPACE"," ",57],["T_STRING","__construct",57],"(",["T_WHITESPACE","\n        ",57],["T_NS_SEPARATOR","\\",58],["T_STRING","Magento",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Framework",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Data",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Collection",58],["T_NS_SEPARATOR","\\",58],["T_STRING","EntityFactory",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$entityFactory",58],",",["T_WHITESPACE","\n        ",58],["T_NS_SEPARATOR","\\",59],["T_STRING","Psr",59],["T_NS_SEPARATOR","\\",59],["T_STRING","Log",59],["T_NS_SEPARATOR","\\",59],["T_STRING","LoggerInterface",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$logger",59],",",["T_WHITESPACE","\n        ",59],["T_NS_SEPARATOR","\\",60],["T_STRING","Magento",60],["T_NS_SEPARATOR","\\",60],["T_STRING","Framework",60],["T_NS_SEPARATOR","\\",60],["T_STRING","Data",60],["T_NS_SEPARATOR","\\",60],["T_STRING","Collection",60],["T_NS_SEPARATOR","\\",60],["T_STRING","Db",60],["T_NS_SEPARATOR","\\",60],["T_STRING","FetchStrategyInterface",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$fetchStrategy",60],",",["T_WHITESPACE","\n        ",60],["T_NS_SEPARATOR","\\",61],["T_STRING","Magento",61],["T_NS_SEPARATOR","\\",61],["T_STRING","Framework",61],["T_NS_SEPARATOR","\\",61],["T_STRING","Event",61],["T_NS_SEPARATOR","\\",61],["T_STRING","ManagerInterface",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$eventManager",61],",",["T_WHITESPACE","\n        ",61],["T_NS_SEPARATOR","\\",62],["T_STRING","Magento",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Eav",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Model",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Config",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$eavConfig",62],",",["T_WHITESPACE","\n        ",62],["T_NS_SEPARATOR","\\",63],["T_STRING","Magento",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Framework",63],["T_NS_SEPARATOR","\\",63],["T_STRING","App",63],["T_NS_SEPARATOR","\\",63],["T_STRING","ResourceConnection",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$resource",63],",",["T_WHITESPACE","\n        ",63],["T_NS_SEPARATOR","\\",64],["T_STRING","Magento",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Eav",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Model",64],["T_NS_SEPARATOR","\\",64],["T_STRING","EntityFactory",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$eavEntityFactory",64],",",["T_WHITESPACE","\n        ",64],["T_NS_SEPARATOR","\\",65],["T_STRING","Magento",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Catalog",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Model",65],["T_NS_SEPARATOR","\\",65],["T_STRING","ResourceModel",65],["T_NS_SEPARATOR","\\",65],["T_STRING","Helper",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$resourceHelper",65],",",["T_WHITESPACE","\n        ",65],["T_NS_SEPARATOR","\\",66],["T_STRING","Magento",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Framework",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Validator",66],["T_NS_SEPARATOR","\\",66],["T_STRING","UniversalFactory",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$universalFactory",66],",",["T_WHITESPACE","\n        ",66],["T_NS_SEPARATOR","\\",67],["T_STRING","Magento",67],["T_NS_SEPARATOR","\\",67],["T_STRING","Store",67],["T_NS_SEPARATOR","\\",67],["T_STRING","Model",67],["T_NS_SEPARATOR","\\",67],["T_STRING","StoreManagerInterface",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$storeManager",67],",",["T_WHITESPACE","\n        ",67],["T_NS_SEPARATOR","\\",68],["T_STRING","Magento",68],["T_NS_SEPARATOR","\\",68],["T_STRING","Framework",68],["T_NS_SEPARATOR","\\",68],["T_STRING","Module",68],["T_NS_SEPARATOR","\\",68],["T_STRING","Manager",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$moduleManager",68],",",["T_WHITESPACE","\n        ",68],["T_NS_SEPARATOR","\\",69],["T_STRING","Magento",69],["T_NS_SEPARATOR","\\",69],["T_STRING","Catalog",69],["T_NS_SEPARATOR","\\",69],["T_STRING","Model",69],["T_NS_SEPARATOR","\\",69],["T_STRING","Indexer",69],["T_NS_SEPARATOR","\\",69],["T_STRING","Product",69],["T_NS_SEPARATOR","\\",69],["T_STRING","Flat",69],["T_NS_SEPARATOR","\\",69],["T_STRING","State",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$catalogProductFlatState",69],",",["T_WHITESPACE","\n        ",69],["T_NS_SEPARATOR","\\",70],["T_STRING","Magento",70],["T_NS_SEPARATOR","\\",70],["T_STRING","Framework",70],["T_NS_SEPARATOR","\\",70],["T_STRING","App",70],["T_NS_SEPARATOR","\\",70],["T_STRING","Config",70],["T_NS_SEPARATOR","\\",70],["T_STRING","ScopeConfigInterface",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$scopeConfig",70],",",["T_WHITESPACE","\n        ",70],["T_NS_SEPARATOR","\\",71],["T_STRING","Magento",71],["T_NS_SEPARATOR","\\",71],["T_STRING","Catalog",71],["T_NS_SEPARATOR","\\",71],["T_STRING","Model",71],["T_NS_SEPARATOR","\\",71],["T_STRING","Product",71],["T_NS_SEPARATOR","\\",71],["T_STRING","OptionFactory",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$productOptionFactory",71],",",["T_WHITESPACE","\n        ",71],["T_NS_SEPARATOR","\\",72],["T_STRING","Magento",72],["T_NS_SEPARATOR","\\",72],["T_STRING","Catalog",72],["T_NS_SEPARATOR","\\",72],["T_STRING","Model",72],["T_NS_SEPARATOR","\\",72],["T_STRING","ResourceModel",72],["T_NS_SEPARATOR","\\",72],["T_STRING","Url",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$catalogUrl",72],",",["T_WHITESPACE","\n        ",72],["T_NS_SEPARATOR","\\",73],["T_STRING","Magento",73],["T_NS_SEPARATOR","\\",73],["T_STRING","Framework",73],["T_NS_SEPARATOR","\\",73],["T_STRING","Stdlib",73],["T_NS_SEPARATOR","\\",73],["T_STRING","DateTime",73],["T_NS_SEPARATOR","\\",73],["T_STRING","TimezoneInterface",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$localeDate",73],",",["T_WHITESPACE","\n        ",73],["T_NS_SEPARATOR","\\",74],["T_STRING","Magento",74],["T_NS_SEPARATOR","\\",74],["T_STRING","Customer",74],["T_NS_SEPARATOR","\\",74],["T_STRING","Model",74],["T_NS_SEPARATOR","\\",74],["T_STRING","Session",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$customerSession",74],",",["T_WHITESPACE","\n        ",74],["T_NS_SEPARATOR","\\",75],["T_STRING","Magento",75],["T_NS_SEPARATOR","\\",75],["T_STRING","Framework",75],["T_NS_SEPARATOR","\\",75],["T_STRING","Stdlib",75],["T_NS_SEPARATOR","\\",75],["T_STRING","DateTime",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$dateTime",75],",",["T_WHITESPACE","\n        ",75],["T_NS_SEPARATOR","\\",76],["T_STRING","Magento",76],["T_NS_SEPARATOR","\\",76],["T_STRING","Customer",76],["T_NS_SEPARATOR","\\",76],["T_STRING","Api",76],["T_NS_SEPARATOR","\\",76],["T_STRING","GroupManagementInterface",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$groupManagement",76],",",["T_WHITESPACE","\n        ",76],["T_NS_SEPARATOR","\\",77],["T_STRING","Magento",77],["T_NS_SEPARATOR","\\",77],["T_STRING","Customer",77],["T_NS_SEPARATOR","\\",77],["T_STRING","Model",77],["T_NS_SEPARATOR","\\",77],["T_STRING","Visitor",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$customerVisitor",77],",",["T_WHITESPACE","\n        ",77],["T_NS_SEPARATOR","\\",78],["T_STRING","Magento",78],["T_NS_SEPARATOR","\\",78],["T_STRING","Framework",78],["T_NS_SEPARATOR","\\",78],["T_STRING","DB",78],["T_NS_SEPARATOR","\\",78],["T_STRING","Adapter",78],["T_NS_SEPARATOR","\\",78],["T_STRING","AdapterInterface",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$connection",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_STRING","null",78],["T_WHITESPACE","\n    ",78],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n        ",79],["T_STRING","parent",80],["T_DOUBLE_COLON","::",80],["T_STRING","__construct",80],"(",["T_WHITESPACE","\n            ",80],["T_VARIABLE","$entityFactory",81],",",["T_WHITESPACE","\n            ",81],["T_VARIABLE","$logger",82],",",["T_WHITESPACE","\n            ",82],["T_VARIABLE","$fetchStrategy",83],",",["T_WHITESPACE","\n            ",83],["T_VARIABLE","$eventManager",84],",",["T_WHITESPACE","\n            ",84],["T_VARIABLE","$eavConfig",85],",",["T_WHITESPACE","\n            ",85],["T_VARIABLE","$resource",86],",",["T_WHITESPACE","\n            ",86],["T_VARIABLE","$eavEntityFactory",87],",",["T_WHITESPACE","\n            ",87],["T_VARIABLE","$resourceHelper",88],",",["T_WHITESPACE","\n            ",88],["T_VARIABLE","$universalFactory",89],",",["T_WHITESPACE","\n            ",89],["T_VARIABLE","$storeManager",90],",",["T_WHITESPACE","\n            ",90],["T_VARIABLE","$moduleManager",91],",",["T_WHITESPACE","\n            ",91],["T_VARIABLE","$catalogProductFlatState",92],",",["T_WHITESPACE","\n            ",92],["T_VARIABLE","$scopeConfig",93],",",["T_WHITESPACE","\n            ",93],["T_VARIABLE","$productOptionFactory",94],",",["T_WHITESPACE","\n            ",94],["T_VARIABLE","$catalogUrl",95],",",["T_WHITESPACE","\n            ",95],["T_VARIABLE","$localeDate",96],",",["T_WHITESPACE","\n            ",96],["T_VARIABLE","$customerSession",97],",",["T_WHITESPACE","\n            ",97],["T_VARIABLE","$dateTime",98],",",["T_WHITESPACE","\n            ",98],["T_VARIABLE","$groupManagement",99],",",["T_WHITESPACE","\n            ",99],["T_VARIABLE","$connection",100],["T_WHITESPACE","\n        ",100],")",";",["T_WHITESPACE","\n        ",101],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","_customerVisitor",102],["T_WHITESPACE"," ",102],"=",["T_WHITESPACE"," ",102],["T_VARIABLE","$customerVisitor",102],";",["T_WHITESPACE","\n    ",102],"}",["T_WHITESPACE","\n\n    ",103],["T_DOC_COMMENT","\/**\n     * Retrieve Product Index table name\n     *\n     * @return string\n     *\/",105],["T_WHITESPACE","\n    ",109],["T_ABSTRACT","abstract",110],["T_WHITESPACE"," ",110],["T_PROTECTED","protected",110],["T_WHITESPACE"," ",110],["T_FUNCTION","function",110],["T_WHITESPACE"," ",110],["T_STRING","_getTableName",110],"(",")",";",["T_WHITESPACE","\n\n    ",110],["T_DOC_COMMENT","\/**\n     * Join index table\n     *\n     * @return $this\n     *\/",112],["T_WHITESPACE","\n    ",116],["T_PROTECTED","protected",117],["T_WHITESPACE"," ",117],["T_FUNCTION","function",117],["T_WHITESPACE"," ",117],["T_STRING","_joinIdxTable",117],"(",")",["T_WHITESPACE","\n    ",117],"{",["T_WHITESPACE","\n        ",118],["T_IF","if",119],["T_WHITESPACE"," ",119],"(","!",["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getFlag",119],"(",["T_CONSTANT_ENCAPSED_STRING","'is_idx_table_joined'",119],")",")",["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n            ",119],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","joinTable",120],"(",["T_WHITESPACE","\n                ",120],"[",["T_CONSTANT_ENCAPSED_STRING","'idx_table'",121],["T_WHITESPACE"," ",121],["T_DOUBLE_ARROW","=>",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","_getTableName",121],"(",")","]",",",["T_WHITESPACE","\n                ",121],["T_CONSTANT_ENCAPSED_STRING","'product_id=entity_id'",122],",",["T_WHITESPACE","\n                ",122],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",123],["T_WHITESPACE"," ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'product_id'",123],",",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'item_store_id'",123],["T_WHITESPACE"," ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'store_id'",123],",",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'added_at'",123],["T_WHITESPACE"," ",123],["T_DOUBLE_ARROW","=>",123],["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'added_at'",123],"]",",",["T_WHITESPACE","\n                ",123],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","_getWhereCondition",124],"(",")",["T_WHITESPACE","\n            ",124],")",";",["T_WHITESPACE","\n            ",125],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","setFlag",126],"(",["T_CONSTANT_ENCAPSED_STRING","'is_idx_table_joined'",126],",",["T_WHITESPACE"," ",126],["T_STRING","true",126],")",";",["T_WHITESPACE","\n        ",126],"}",["T_WHITESPACE","\n        ",127],["T_RETURN","return",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$this",128],";",["T_WHITESPACE","\n    ",128],"}",["T_WHITESPACE","\n\n    ",129],["T_DOC_COMMENT","\/**\n     * Add Viewed Products Index to Collection\n     *\n     * @return $this\n     *\/",131],["T_WHITESPACE","\n    ",135],["T_PUBLIC","public",136],["T_WHITESPACE"," ",136],["T_FUNCTION","function",136],["T_WHITESPACE"," ",136],["T_STRING","addIndexFilter",136],"(",")",["T_WHITESPACE","\n    ",136],"{",["T_WHITESPACE","\n        ",137],["T_VARIABLE","$this",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","_joinIdxTable",138],"(",")",";",["T_WHITESPACE","\n        ",138],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","_productLimitationFilters",139],"[",["T_CONSTANT_ENCAPSED_STRING","'store_table'",139],"]",["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'idx_table'",139],";",["T_WHITESPACE","\n        ",139],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","setFlag",140],"(",["T_CONSTANT_ENCAPSED_STRING","'url_data_object'",140],",",["T_WHITESPACE"," ",140],["T_STRING","true",140],")",";",["T_WHITESPACE","\n        ",140],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","setFlag",141],"(",["T_CONSTANT_ENCAPSED_STRING","'do_not_use_category_id'",141],",",["T_WHITESPACE"," ",141],["T_STRING","true",141],")",";",["T_WHITESPACE","\n        ",141],["T_RETURN","return",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$this",142],";",["T_WHITESPACE","\n    ",142],"}",["T_WHITESPACE","\n\n    ",143],["T_DOC_COMMENT","\/**\n     * Add filter by product ids\n     *\n     * @param array $ids\n     * @return $this\n     *\/",145],["T_WHITESPACE","\n    ",150],["T_PUBLIC","public",151],["T_WHITESPACE"," ",151],["T_FUNCTION","function",151],["T_WHITESPACE"," ",151],["T_STRING","addFilterByIds",151],"(",["T_VARIABLE","$ids",151],")",["T_WHITESPACE","\n    ",151],"{",["T_WHITESPACE","\n        ",152],["T_IF","if",153],["T_WHITESPACE"," ",153],"(",["T_EMPTY","empty",153],"(",["T_VARIABLE","$ids",153],")",")",["T_WHITESPACE"," ",153],"{",["T_WHITESPACE","\n            ",153],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","getSelect",154],"(",")",["T_OBJECT_OPERATOR","->",154],["T_STRING","where",154],"(",["T_CONSTANT_ENCAPSED_STRING","'1=0'",154],")",";",["T_WHITESPACE","\n        ",154],"}",["T_WHITESPACE"," ",155],["T_ELSE","else",155],["T_WHITESPACE"," ",155],"{",["T_WHITESPACE","\n            ",155],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","getSelect",156],"(",")",["T_OBJECT_OPERATOR","->",156],["T_STRING","where",156],"(",["T_CONSTANT_ENCAPSED_STRING","'e.entity_id IN(?)'",156],",",["T_WHITESPACE"," ",156],["T_VARIABLE","$ids",156],")",";",["T_WHITESPACE","\n        ",156],"}",["T_WHITESPACE","\n        ",157],["T_RETURN","return",158],["T_WHITESPACE"," ",158],["T_VARIABLE","$this",158],";",["T_WHITESPACE","\n    ",158],"}",["T_WHITESPACE","\n\n    ",159],["T_DOC_COMMENT","\/**\n     * Retrieve Where Condition to Index table\n     *\n     * @return array\n     *\/",161],["T_WHITESPACE","\n    ",165],["T_PROTECTED","protected",166],["T_WHITESPACE"," ",166],["T_FUNCTION","function",166],["T_WHITESPACE"," ",166],["T_STRING","_getWhereCondition",166],"(",")",["T_WHITESPACE","\n    ",166],"{",["T_WHITESPACE","\n        ",167],["T_VARIABLE","$condition",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],"[","]",";",["T_WHITESPACE","\n\n        ",168],["T_IF","if",170],["T_WHITESPACE"," ",170],"(",["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","_customerSession",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","isLoggedIn",170],"(",")",")",["T_WHITESPACE"," ",170],"{",["T_WHITESPACE","\n            ",170],["T_VARIABLE","$condition",171],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",171],"]",["T_WHITESPACE"," ",171],"=",["T_WHITESPACE"," ",171],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","_customerSession",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","getCustomerId",171],"(",")",";",["T_WHITESPACE","\n        ",171],"}",["T_WHITESPACE"," ",172],["T_ELSEIF","elseif",172],["T_WHITESPACE"," ",172],"(",["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","_customerId",172],")",["T_WHITESPACE"," ",172],"{",["T_WHITESPACE","\n            ",172],["T_VARIABLE","$condition",173],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",173],"]",["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","_customerId",173],";",["T_WHITESPACE","\n        ",173],"}",["T_WHITESPACE"," ",174],["T_ELSE","else",174],["T_WHITESPACE"," ",174],"{",["T_WHITESPACE","\n            ",174],["T_VARIABLE","$condition",175],"[",["T_CONSTANT_ENCAPSED_STRING","'visitor_id'",175],"]",["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","_customerVisitor",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","getId",175],"(",")",";",["T_WHITESPACE","\n        ",175],"}",["T_WHITESPACE","\n\n        ",176],["T_RETURN","return",178],["T_WHITESPACE"," ",178],["T_VARIABLE","$condition",178],";",["T_WHITESPACE","\n    ",178],"}",["T_WHITESPACE","\n\n    ",179],["T_DOC_COMMENT","\/**\n     * Set customer id, that will be used in 'whereCondition'\n     * @codeCoverageIgnore\n     *\n     * @param int $id\n     * @return $this\n     *\/",181],["T_WHITESPACE","\n    ",187],["T_PUBLIC","public",188],["T_WHITESPACE"," ",188],["T_FUNCTION","function",188],["T_WHITESPACE"," ",188],["T_STRING","setCustomerId",188],"(",["T_VARIABLE","$id",188],")",["T_WHITESPACE","\n    ",188],"{",["T_WHITESPACE","\n        ",189],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","_customerId",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_INT_CAST","(int)",190],["T_VARIABLE","$id",190],";",["T_WHITESPACE","\n        ",190],["T_RETURN","return",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$this",191],";",["T_WHITESPACE","\n    ",191],"}",["T_WHITESPACE","\n\n    ",192],["T_DOC_COMMENT","\/**\n     * Add order by \"added at\"\n     *\n     * @param string $dir\n     * @return $this\n     *\/",194],["T_WHITESPACE","\n    ",199],["T_PUBLIC","public",200],["T_WHITESPACE"," ",200],["T_FUNCTION","function",200],["T_WHITESPACE"," ",200],["T_STRING","setAddedAtOrder",200],"(",["T_VARIABLE","$dir",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_STRING","self",200],["T_DOUBLE_COLON","::",200],["T_STRING","SORT_ORDER_DESC",200],")",["T_WHITESPACE","\n    ",200],"{",["T_WHITESPACE","\n        ",201],["T_IF","if",202],["T_WHITESPACE"," ",202],"(",["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","getFlag",202],"(",["T_CONSTANT_ENCAPSED_STRING","'is_idx_table_joined'",202],")",")",["T_WHITESPACE"," ",202],"{",["T_WHITESPACE","\n            ",202],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","getSelect",203],"(",")",["T_OBJECT_OPERATOR","->",203],["T_STRING","order",203],"(",["T_CONSTANT_ENCAPSED_STRING","'added_at '",203],["T_WHITESPACE"," ",203],".",["T_WHITESPACE"," ",203],["T_VARIABLE","$dir",203],")",";",["T_WHITESPACE","\n        ",203],"}",["T_WHITESPACE","\n        ",204],["T_RETURN","return",205],["T_WHITESPACE"," ",205],["T_VARIABLE","$this",205],";",["T_WHITESPACE","\n    ",205],"}",["T_WHITESPACE","\n\n    ",206],["T_DOC_COMMENT","\/**\n     * Add exclude Product Ids\n     *\n     * @param int|array $productIds\n     * @return $this\n     *\/",208],["T_WHITESPACE","\n    ",213],["T_PUBLIC","public",214],["T_WHITESPACE"," ",214],["T_FUNCTION","function",214],["T_WHITESPACE"," ",214],["T_STRING","excludeProductIds",214],"(",["T_VARIABLE","$productIds",214],")",["T_WHITESPACE","\n    ",214],"{",["T_WHITESPACE","\n        ",215],["T_IF","if",216],["T_WHITESPACE"," ",216],"(",["T_EMPTY","empty",216],"(",["T_VARIABLE","$productIds",216],")",")",["T_WHITESPACE"," ",216],"{",["T_WHITESPACE","\n            ",216],["T_RETURN","return",217],["T_WHITESPACE"," ",217],["T_VARIABLE","$this",217],";",["T_WHITESPACE","\n        ",217],"}",["T_WHITESPACE","\n        ",218],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","_joinIdxTable",219],"(",")",";",["T_WHITESPACE","\n        ",219],["T_VARIABLE","$this",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","getSelect",220],"(",")",["T_OBJECT_OPERATOR","->",220],["T_STRING","where",220],"(",["T_CONSTANT_ENCAPSED_STRING","'idx_table.product_id NOT IN(?)'",220],",",["T_WHITESPACE"," ",220],["T_VARIABLE","$productIds",220],")",";",["T_WHITESPACE","\n        ",220],["T_RETURN","return",221],["T_WHITESPACE"," ",221],["T_VARIABLE","$this",221],";",["T_WHITESPACE","\n    ",221],"}",["T_WHITESPACE","\n",222],"}",["T_WHITESPACE","\n",223]]