[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_DOC_COMMENT","\/**\n * Customers Report collection\n *\/",7],["T_WHITESPACE","\n",9],["T_NAMESPACE","namespace",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Reports",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Model",10],["T_NS_SEPARATOR","\\",10],["T_STRING","ResourceModel",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Customer",10],";",["T_WHITESPACE","\n\n",10],["T_DOC_COMMENT","\/**\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",12],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","Collection",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Magento",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Customer",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Model",15],["T_NS_SEPARATOR","\\",15],["T_STRING","ResourceModel",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Customer",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Collection",15],["T_WHITESPACE","\n",15],"{",["T_WHITESPACE","\n    ",16],["T_DOC_COMMENT","\/**\n     * Add order statistics flag\n     *\n     * @var bool\n     *\/",17],["T_WHITESPACE","\n    ",21],["T_PROTECTED","protected",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$_addOrderStatistics",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_STRING","false",22],";",["T_WHITESPACE","\n\n    ",22],["T_DOC_COMMENT","\/**\n     * Add order statistics is filter flag\n     *\n     * @var bool\n     *\/",24],["T_WHITESPACE","\n    ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$_addOrderStatFilter",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_STRING","false",29],";",["T_WHITESPACE","\n\n    ",29],["T_DOC_COMMENT","\/**\n     * Customer id table name\n     *\n     * @var string\n     *\/",31],["T_WHITESPACE","\n    ",35],["T_PROTECTED","protected",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$_customerIdTableName",36],";",["T_WHITESPACE","\n\n    ",36],["T_DOC_COMMENT","\/**\n     * Customer id field name\n     *\n     * @var string\n     *\/",38],["T_WHITESPACE","\n    ",42],["T_PROTECTED","protected",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$_customerIdFieldName",43],";",["T_WHITESPACE","\n\n    ",43],["T_DOC_COMMENT","\/**\n     * Order entity table name\n     *\n     * @var string\n     *\/",45],["T_WHITESPACE","\n    ",49],["T_PROTECTED","protected",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$_orderEntityTable",50],";",["T_WHITESPACE","\n\n    ",50],["T_DOC_COMMENT","\/**\n     * Order entity field name\n     *\n     * @var string\n     *\/",52],["T_WHITESPACE","\n    ",56],["T_PROTECTED","protected",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$_orderEntityField",57],";",["T_WHITESPACE","\n\n    ",57],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Api\\CartRepositoryInterface\n     *\/",59],["T_WHITESPACE","\n    ",61],["T_PROTECTED","protected",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$quoteRepository",62],";",["T_WHITESPACE","\n\n    ",62],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Model\\ResourceModel\\Quote\\Item\\CollectionFactory\n     *\/",64],["T_WHITESPACE","\n    ",66],["T_PROTECTED","protected",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$_quoteItemFactory",67],";",["T_WHITESPACE","\n\n    ",67],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Sales\\Model\\ResourceModel\\Order\\Collection\n     *\/",69],["T_WHITESPACE","\n    ",71],["T_PROTECTED","protected",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$orderResource",72],";",["T_WHITESPACE","\n\n    ",72],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\Data\\Collection\\EntityFactory $entityFactory\n     * @param \\Psr\\Log\\LoggerInterface $logger\n     * @param \\Magento\\Framework\\Data\\Collection\\Db\\FetchStrategyInterface $fetchStrategy\n     * @param \\Magento\\Framework\\Event\\ManagerInterface $eventManager\n     * @param \\Magento\\Eav\\Model\\Config $eavConfig\n     * @param \\Magento\\Framework\\App\\ResourceConnection $resource\n     * @param \\Magento\\Eav\\Model\\EntityFactory $eavEntityFactory\n     * @param \\Magento\\Eav\\Model\\ResourceModel\\Helper $resourceHelper\n     * @param \\Magento\\Framework\\Validator\\UniversalFactory $universalFactory\n     * @param \\Magento\\Framework\\Model\\ResourceModel\\Db\\VersionControl\\Snapshot $entitySnapshot\n     * @param \\Magento\\Framework\\DataObject\\Copy\\Config $fieldsetConfig\n     * @param \\Magento\\Quote\\Api\\CartRepositoryInterface $quoteRepository\n     * @param \\Magento\\Quote\\Model\\ResourceModel\\Quote\\Item\\CollectionFactory $quoteItemFactory\n     * @param \\Magento\\Sales\\Model\\ResourceModel\\Order\\Collection $orderResource\n     * @param mixed $connection\n     * @param string $modelName\n     *\n     * @SuppressWarnings(PHPMD.ExcessiveParameterList)\n     *\/",74],["T_WHITESPACE","\n    ",93],["T_PUBLIC","public",94],["T_WHITESPACE"," ",94],["T_FUNCTION","function",94],["T_WHITESPACE"," ",94],["T_STRING","__construct",94],"(",["T_WHITESPACE","\n        ",94],["T_NS_SEPARATOR","\\",95],["T_STRING","Magento",95],["T_NS_SEPARATOR","\\",95],["T_STRING","Framework",95],["T_NS_SEPARATOR","\\",95],["T_STRING","Data",95],["T_NS_SEPARATOR","\\",95],["T_STRING","Collection",95],["T_NS_SEPARATOR","\\",95],["T_STRING","EntityFactory",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$entityFactory",95],",",["T_WHITESPACE","\n        ",95],["T_NS_SEPARATOR","\\",96],["T_STRING","Psr",96],["T_NS_SEPARATOR","\\",96],["T_STRING","Log",96],["T_NS_SEPARATOR","\\",96],["T_STRING","LoggerInterface",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$logger",96],",",["T_WHITESPACE","\n        ",96],["T_NS_SEPARATOR","\\",97],["T_STRING","Magento",97],["T_NS_SEPARATOR","\\",97],["T_STRING","Framework",97],["T_NS_SEPARATOR","\\",97],["T_STRING","Data",97],["T_NS_SEPARATOR","\\",97],["T_STRING","Collection",97],["T_NS_SEPARATOR","\\",97],["T_STRING","Db",97],["T_NS_SEPARATOR","\\",97],["T_STRING","FetchStrategyInterface",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$fetchStrategy",97],",",["T_WHITESPACE","\n        ",97],["T_NS_SEPARATOR","\\",98],["T_STRING","Magento",98],["T_NS_SEPARATOR","\\",98],["T_STRING","Framework",98],["T_NS_SEPARATOR","\\",98],["T_STRING","Event",98],["T_NS_SEPARATOR","\\",98],["T_STRING","ManagerInterface",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$eventManager",98],",",["T_WHITESPACE","\n        ",98],["T_NS_SEPARATOR","\\",99],["T_STRING","Magento",99],["T_NS_SEPARATOR","\\",99],["T_STRING","Eav",99],["T_NS_SEPARATOR","\\",99],["T_STRING","Model",99],["T_NS_SEPARATOR","\\",99],["T_STRING","Config",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$eavConfig",99],",",["T_WHITESPACE","\n        ",99],["T_NS_SEPARATOR","\\",100],["T_STRING","Magento",100],["T_NS_SEPARATOR","\\",100],["T_STRING","Framework",100],["T_NS_SEPARATOR","\\",100],["T_STRING","App",100],["T_NS_SEPARATOR","\\",100],["T_STRING","ResourceConnection",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$resource",100],",",["T_WHITESPACE","\n        ",100],["T_NS_SEPARATOR","\\",101],["T_STRING","Magento",101],["T_NS_SEPARATOR","\\",101],["T_STRING","Eav",101],["T_NS_SEPARATOR","\\",101],["T_STRING","Model",101],["T_NS_SEPARATOR","\\",101],["T_STRING","EntityFactory",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$eavEntityFactory",101],",",["T_WHITESPACE","\n        ",101],["T_NS_SEPARATOR","\\",102],["T_STRING","Magento",102],["T_NS_SEPARATOR","\\",102],["T_STRING","Eav",102],["T_NS_SEPARATOR","\\",102],["T_STRING","Model",102],["T_NS_SEPARATOR","\\",102],["T_STRING","ResourceModel",102],["T_NS_SEPARATOR","\\",102],["T_STRING","Helper",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$resourceHelper",102],",",["T_WHITESPACE","\n        ",102],["T_NS_SEPARATOR","\\",103],["T_STRING","Magento",103],["T_NS_SEPARATOR","\\",103],["T_STRING","Framework",103],["T_NS_SEPARATOR","\\",103],["T_STRING","Validator",103],["T_NS_SEPARATOR","\\",103],["T_STRING","UniversalFactory",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$universalFactory",103],",",["T_WHITESPACE","\n        ",103],["T_NS_SEPARATOR","\\",104],["T_STRING","Magento",104],["T_NS_SEPARATOR","\\",104],["T_STRING","Framework",104],["T_NS_SEPARATOR","\\",104],["T_STRING","Model",104],["T_NS_SEPARATOR","\\",104],["T_STRING","ResourceModel",104],["T_NS_SEPARATOR","\\",104],["T_STRING","Db",104],["T_NS_SEPARATOR","\\",104],["T_STRING","VersionControl",104],["T_NS_SEPARATOR","\\",104],["T_STRING","Snapshot",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$entitySnapshot",104],",",["T_WHITESPACE","\n        ",104],["T_NS_SEPARATOR","\\",105],["T_STRING","Magento",105],["T_NS_SEPARATOR","\\",105],["T_STRING","Framework",105],["T_NS_SEPARATOR","\\",105],["T_STRING","DataObject",105],["T_NS_SEPARATOR","\\",105],["T_STRING","Copy",105],["T_NS_SEPARATOR","\\",105],["T_STRING","Config",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$fieldsetConfig",105],",",["T_WHITESPACE","\n        ",105],["T_NS_SEPARATOR","\\",106],["T_STRING","Magento",106],["T_NS_SEPARATOR","\\",106],["T_STRING","Quote",106],["T_NS_SEPARATOR","\\",106],["T_STRING","Api",106],["T_NS_SEPARATOR","\\",106],["T_STRING","CartRepositoryInterface",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$quoteRepository",106],",",["T_WHITESPACE","\n        ",106],["T_NS_SEPARATOR","\\",107],["T_STRING","Magento",107],["T_NS_SEPARATOR","\\",107],["T_STRING","Quote",107],["T_NS_SEPARATOR","\\",107],["T_STRING","Model",107],["T_NS_SEPARATOR","\\",107],["T_STRING","ResourceModel",107],["T_NS_SEPARATOR","\\",107],["T_STRING","Quote",107],["T_NS_SEPARATOR","\\",107],["T_STRING","Item",107],["T_NS_SEPARATOR","\\",107],["T_STRING","CollectionFactory",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$quoteItemFactory",107],",",["T_WHITESPACE","\n        ",107],["T_NS_SEPARATOR","\\",108],["T_STRING","Magento",108],["T_NS_SEPARATOR","\\",108],["T_STRING","Sales",108],["T_NS_SEPARATOR","\\",108],["T_STRING","Model",108],["T_NS_SEPARATOR","\\",108],["T_STRING","ResourceModel",108],["T_NS_SEPARATOR","\\",108],["T_STRING","Order",108],["T_NS_SEPARATOR","\\",108],["T_STRING","Collection",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$orderResource",108],",",["T_WHITESPACE","\n        ",108],["T_NS_SEPARATOR","\\",109],["T_STRING","Magento",109],["T_NS_SEPARATOR","\\",109],["T_STRING","Framework",109],["T_NS_SEPARATOR","\\",109],["T_STRING","DB",109],["T_NS_SEPARATOR","\\",109],["T_STRING","Adapter",109],["T_NS_SEPARATOR","\\",109],["T_STRING","AdapterInterface",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$connection",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],["T_STRING","null",109],",",["T_WHITESPACE","\n        ",109],["T_VARIABLE","$modelName",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_STRING","self",110],["T_DOUBLE_COLON","::",110],["T_STRING","CUSTOMER_MODEL_NAME",110],["T_WHITESPACE","\n    ",110],")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n        ",111],["T_STRING","parent",112],["T_DOUBLE_COLON","::",112],["T_STRING","__construct",112],"(",["T_WHITESPACE","\n            ",112],["T_VARIABLE","$entityFactory",113],",",["T_WHITESPACE","\n            ",113],["T_VARIABLE","$logger",114],",",["T_WHITESPACE","\n            ",114],["T_VARIABLE","$fetchStrategy",115],",",["T_WHITESPACE","\n            ",115],["T_VARIABLE","$eventManager",116],",",["T_WHITESPACE","\n            ",116],["T_VARIABLE","$eavConfig",117],",",["T_WHITESPACE","\n            ",117],["T_VARIABLE","$resource",118],",",["T_WHITESPACE","\n            ",118],["T_VARIABLE","$eavEntityFactory",119],",",["T_WHITESPACE","\n            ",119],["T_VARIABLE","$resourceHelper",120],",",["T_WHITESPACE","\n            ",120],["T_VARIABLE","$universalFactory",121],",",["T_WHITESPACE","\n            ",121],["T_VARIABLE","$entitySnapshot",122],",",["T_WHITESPACE","\n            ",122],["T_VARIABLE","$fieldsetConfig",123],",",["T_WHITESPACE","\n            ",123],["T_VARIABLE","$connection",124],",",["T_WHITESPACE","\n            ",124],["T_VARIABLE","$modelName",125],["T_WHITESPACE","\n        ",125],")",";",["T_WHITESPACE","\n        ",126],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","orderResource",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_VARIABLE","$orderResource",127],";",["T_WHITESPACE","\n        ",127],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","quoteRepository",128],["T_WHITESPACE"," ",128],"=",["T_WHITESPACE"," ",128],["T_VARIABLE","$quoteRepository",128],";",["T_WHITESPACE","\n        ",128],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","_quoteItemFactory",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_VARIABLE","$quoteItemFactory",129],";",["T_WHITESPACE","\n    ",129],"}",["T_WHITESPACE","\n\n    ",130],["T_DOC_COMMENT","\/**\n     * Add cart info to collection\n     *\n     * @return $this\n     *\/",132],["T_WHITESPACE","\n    ",136],["T_PUBLIC","public",137],["T_WHITESPACE"," ",137],["T_FUNCTION","function",137],["T_WHITESPACE"," ",137],["T_STRING","addCartInfo",137],"(",")",["T_WHITESPACE","\n    ",137],"{",["T_WHITESPACE","\n        ",138],["T_FOREACH","foreach",139],["T_WHITESPACE"," ",139],"(",["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getItems",139],"(",")",["T_WHITESPACE"," ",139],["T_AS","as",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$item",139],")",["T_WHITESPACE"," ",139],"{",["T_WHITESPACE","\n            ",139],["T_TRY","try",140],["T_WHITESPACE"," ",140],"{",["T_WHITESPACE","\n                ",140],["T_VARIABLE","$quote",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","quoteRepository",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getForCustomer",141],"(",["T_VARIABLE","$item",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getId",141],"(",")",")",";",["T_WHITESPACE","\n\n                ",141],["T_VARIABLE","$totals",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_VARIABLE","$quote",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getTotals",143],"(",")",";",["T_WHITESPACE","\n                ",143],["T_VARIABLE","$item",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","setTotal",144],"(",["T_VARIABLE","$totals",144],"[",["T_CONSTANT_ENCAPSED_STRING","'subtotal'",144],"]",["T_OBJECT_OPERATOR","->",144],["T_STRING","getValue",144],"(",")",")",";",["T_WHITESPACE","\n                ",144],["T_VARIABLE","$quoteItems",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","_quoteItemFactory",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","create",145],"(",")",["T_OBJECT_OPERATOR","->",145],["T_STRING","setQuoteFilter",145],"(",["T_VARIABLE","$quote",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getId",145],"(",")",")",";",["T_WHITESPACE","\n                ",145],["T_VARIABLE","$quoteItems",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","load",146],"(",")",";",["T_WHITESPACE","\n                ",146],["T_VARIABLE","$item",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","setItems",147],"(",["T_VARIABLE","$quoteItems",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","count",147],"(",")",")",";",["T_WHITESPACE","\n            ",147],"}",["T_WHITESPACE"," ",148],["T_CATCH","catch",148],["T_WHITESPACE"," ",148],"(",["T_NS_SEPARATOR","\\",148],["T_STRING","Magento",148],["T_NS_SEPARATOR","\\",148],["T_STRING","Framework",148],["T_NS_SEPARATOR","\\",148],["T_STRING","Exception",148],["T_NS_SEPARATOR","\\",148],["T_STRING","NoSuchEntityException",148],["T_WHITESPACE"," ",148],["T_VARIABLE","$e",148],")",["T_WHITESPACE"," ",148],"{",["T_WHITESPACE","\n                ",148],["T_VARIABLE","$item",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","remove",149],"(",")",";",["T_WHITESPACE","\n            ",149],"}",["T_WHITESPACE","\n        ",150],"}",["T_WHITESPACE","\n        ",151],["T_RETURN","return",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],";",["T_WHITESPACE","\n    ",152],"}",["T_WHITESPACE","\n\n    ",153],["T_DOC_COMMENT","\/**\n     * Add customer name to results\n     *\n     * @return $this\n     *\/",155],["T_WHITESPACE","\n    ",159],["T_PUBLIC","public",160],["T_WHITESPACE"," ",160],["T_FUNCTION","function",160],["T_WHITESPACE"," ",160],["T_STRING","addCustomerName",160],"(",")",["T_WHITESPACE","\n    ",160],"{",["T_WHITESPACE","\n        ",161],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","addNameToSelect",162],"(",")",";",["T_WHITESPACE","\n        ",162],["T_RETURN","return",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$this",163],";",["T_WHITESPACE","\n    ",163],"}",["T_WHITESPACE","\n\n    ",164],["T_DOC_COMMENT","\/**\n     * Add order statistics\n     *\n     * @param bool $isFilter\n     * @return $this\n     *\/",166],["T_WHITESPACE","\n    ",171],["T_PUBLIC","public",172],["T_WHITESPACE"," ",172],["T_FUNCTION","function",172],["T_WHITESPACE"," ",172],["T_STRING","addOrdersStatistics",172],"(",["T_VARIABLE","$isFilter",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_STRING","false",172],")",["T_WHITESPACE","\n    ",172],"{",["T_WHITESPACE","\n        ",173],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","_addOrderStatistics",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_STRING","true",174],";",["T_WHITESPACE","\n        ",174],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","_addOrderStatFilter",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_BOOL_CAST","(bool)",175],["T_VARIABLE","$isFilter",175],";",["T_WHITESPACE","\n        ",175],["T_RETURN","return",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$this",176],";",["T_WHITESPACE","\n    ",176],"}",["T_WHITESPACE","\n\n    ",177],["T_DOC_COMMENT","\/**\n     * Add orders statistics to collection items\n     *\n     * @return $this\n     *\/",179],["T_WHITESPACE","\n    ",183],["T_PROTECTED","protected",184],["T_WHITESPACE"," ",184],["T_FUNCTION","function",184],["T_WHITESPACE"," ",184],["T_STRING","_addOrdersStatistics",184],"(",")",["T_WHITESPACE","\n    ",184],"{",["T_WHITESPACE","\n        ",185],["T_VARIABLE","$customerIds",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","getColumnValues",186],"(",["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","getResource",186],"(",")",["T_OBJECT_OPERATOR","->",186],["T_STRING","getIdFieldName",186],"(",")",")",";",["T_WHITESPACE","\n\n        ",186],["T_IF","if",188],["T_WHITESPACE"," ",188],"(",["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","_addOrderStatistics",188],["T_WHITESPACE"," ",188],["T_BOOLEAN_AND","&&",188],["T_WHITESPACE"," ",188],"!",["T_EMPTY","empty",188],"(",["T_VARIABLE","$customerIds",188],")",")",["T_WHITESPACE"," ",188],"{",["T_WHITESPACE","\n            ",188],["T_VARIABLE","$connection",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","orderResource",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getConnection",189],"(",")",";",["T_WHITESPACE","\n            ",189],["T_VARIABLE","$baseSubtotalRefunded",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],["T_VARIABLE","$connection",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","getIfNullSql",190],"(",["T_CONSTANT_ENCAPSED_STRING","'orders.base_subtotal_refunded'",190],",",["T_WHITESPACE"," ",190],["T_LNUMBER","0",190],")",";",["T_WHITESPACE","\n            ",190],["T_VARIABLE","$baseSubtotalCanceled",191],["T_WHITESPACE"," ",191],"=",["T_WHITESPACE"," ",191],["T_VARIABLE","$connection",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","getIfNullSql",191],"(",["T_CONSTANT_ENCAPSED_STRING","'orders.base_subtotal_canceled'",191],",",["T_WHITESPACE"," ",191],["T_LNUMBER","0",191],")",";",["T_WHITESPACE","\n            ",191],["T_VARIABLE","$baseDiscountCanceled",192],["T_WHITESPACE"," ",192],"=",["T_WHITESPACE"," ",192],["T_VARIABLE","$connection",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","getIfNullSql",192],"(",["T_CONSTANT_ENCAPSED_STRING","'orders.base_discount_canceled'",192],",",["T_WHITESPACE"," ",192],["T_LNUMBER","0",192],")",";",["T_WHITESPACE","\n\n            ",192],["T_VARIABLE","$totalExpr",194],["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","_addOrderStatFilter",194],["T_WHITESPACE"," ",194],"?",["T_WHITESPACE","\n                ",194],"\"",["T_ENCAPSED_AND_WHITESPACE","(orders.base_subtotal-",195],["T_CURLY_OPEN","{",195],["T_VARIABLE","$baseSubtotalCanceled",195],"}",["T_ENCAPSED_AND_WHITESPACE","-",195],["T_CURLY_OPEN","{",195],["T_VARIABLE","$baseSubtotalRefunded",195],"}",["T_ENCAPSED_AND_WHITESPACE"," - ",195],["T_CURLY_OPEN","{",195],["T_VARIABLE","$baseDiscountCanceled",195],"}","\"",["T_WHITESPACE","\n                    ",195],".",["T_WHITESPACE"," ",196],["T_CONSTANT_ENCAPSED_STRING","\" - ABS(orders.base_discount_amount))*orders.base_to_global_rate\"",196],["T_WHITESPACE"," ",196],":",["T_WHITESPACE","\n                ",196],"\"",["T_ENCAPSED_AND_WHITESPACE","orders.base_subtotal-",197],["T_CURLY_OPEN","{",197],["T_VARIABLE","$baseSubtotalCanceled",197],"}",["T_ENCAPSED_AND_WHITESPACE","-",197],["T_CURLY_OPEN","{",197],["T_VARIABLE","$baseSubtotalRefunded",197],"}",["T_ENCAPSED_AND_WHITESPACE"," - ",197],["T_CURLY_OPEN","{",197],["T_VARIABLE","$baseDiscountCanceled",197],"}","\"",["T_WHITESPACE","\n                    ",197],".",["T_WHITESPACE"," ",198],["T_CONSTANT_ENCAPSED_STRING","\" - ABS(orders.base_discount_amount)\"",198],";",["T_WHITESPACE","\n\n            ",198],["T_VARIABLE","$select",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","orderResource",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","getConnection",200],"(",")",["T_OBJECT_OPERATOR","->",200],["T_STRING","select",200],"(",")",";",["T_WHITESPACE","\n            ",200],["T_VARIABLE","$select",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","from",201],"(",["T_WHITESPACE","\n                ",201],"[",["T_CONSTANT_ENCAPSED_STRING","'orders'",202],["T_WHITESPACE"," ",202],["T_DOUBLE_ARROW","=>",202],["T_WHITESPACE"," ",202],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","orderResource",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","getTable",202],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_order'",202],")","]",",",["T_WHITESPACE","\n                ",202],"[",["T_WHITESPACE","\n                    ",203],["T_CONSTANT_ENCAPSED_STRING","'orders_avg_amount'",204],["T_WHITESPACE"," ",204],["T_DOUBLE_ARROW","=>",204],["T_WHITESPACE"," ",204],"\"",["T_ENCAPSED_AND_WHITESPACE","AVG(",204],["T_CURLY_OPEN","{",204],["T_VARIABLE","$totalExpr",204],"}",["T_ENCAPSED_AND_WHITESPACE",")",204],"\"",",",["T_WHITESPACE","\n                    ",204],["T_CONSTANT_ENCAPSED_STRING","'orders_sum_amount'",205],["T_WHITESPACE"," ",205],["T_DOUBLE_ARROW","=>",205],["T_WHITESPACE"," ",205],"\"",["T_ENCAPSED_AND_WHITESPACE","SUM(",205],["T_CURLY_OPEN","{",205],["T_VARIABLE","$totalExpr",205],"}",["T_ENCAPSED_AND_WHITESPACE",")",205],"\"",",",["T_WHITESPACE","\n                    ",205],["T_CONSTANT_ENCAPSED_STRING","'orders_count'",206],["T_WHITESPACE"," ",206],["T_DOUBLE_ARROW","=>",206],["T_WHITESPACE"," ",206],["T_CONSTANT_ENCAPSED_STRING","'COUNT(orders.entity_id)'",206],",",["T_WHITESPACE","\n                    ",206],["T_CONSTANT_ENCAPSED_STRING","'customer_id'",207],["T_WHITESPACE","\n                ",207],"]",["T_WHITESPACE","\n            ",208],")",["T_OBJECT_OPERATOR","->",209],["T_STRING","where",209],"(",["T_WHITESPACE","\n                ",209],["T_CONSTANT_ENCAPSED_STRING","'orders.state <> ?'",210],",",["T_WHITESPACE","\n                ",210],["T_NS_SEPARATOR","\\",211],["T_STRING","Magento",211],["T_NS_SEPARATOR","\\",211],["T_STRING","Sales",211],["T_NS_SEPARATOR","\\",211],["T_STRING","Model",211],["T_NS_SEPARATOR","\\",211],["T_STRING","Order",211],["T_DOUBLE_COLON","::",211],["T_STRING","STATE_CANCELED",211],["T_WHITESPACE","\n            ",211],")",["T_OBJECT_OPERATOR","->",212],["T_STRING","where",212],"(",["T_WHITESPACE","\n                ",212],["T_CONSTANT_ENCAPSED_STRING","'orders.customer_id IN(?)'",213],",",["T_WHITESPACE","\n                ",213],["T_VARIABLE","$customerIds",214],["T_WHITESPACE","\n            ",214],")",["T_OBJECT_OPERATOR","->",215],["T_STRING","group",215],"(",["T_WHITESPACE","\n                ",215],["T_CONSTANT_ENCAPSED_STRING","'orders.customer_id'",216],["T_WHITESPACE","\n            ",216],")",";",["T_WHITESPACE","\n\n            ",217],["T_FOREACH","foreach",219],["T_WHITESPACE"," ",219],"(",["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","orderResource",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","getConnection",219],"(",")",["T_OBJECT_OPERATOR","->",219],["T_STRING","fetchAll",219],"(",["T_VARIABLE","$select",219],")",["T_WHITESPACE"," ",219],["T_AS","as",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$ordersInfo",219],")",["T_WHITESPACE"," ",219],"{",["T_WHITESPACE","\n                ",219],["T_VARIABLE","$this",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","getItemById",220],"(",["T_VARIABLE","$ordersInfo",220],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_id'",220],"]",")",["T_OBJECT_OPERATOR","->",220],["T_STRING","addData",220],"(",["T_VARIABLE","$ordersInfo",220],")",";",["T_WHITESPACE","\n            ",220],"}",["T_WHITESPACE","\n        ",221],"}",["T_WHITESPACE","\n\n        ",222],["T_RETURN","return",224],["T_WHITESPACE"," ",224],["T_VARIABLE","$this",224],";",["T_WHITESPACE","\n    ",224],"}",["T_WHITESPACE","\n\n    ",225],["T_DOC_COMMENT","\/**\n     * Collection after load operations like adding orders statistics\n     *\n     * @return $this\n     *\/",227],["T_WHITESPACE","\n    ",231],["T_PROTECTED","protected",232],["T_WHITESPACE"," ",232],["T_FUNCTION","function",232],["T_WHITESPACE"," ",232],["T_STRING","_afterLoad",232],"(",")",["T_WHITESPACE","\n    ",232],"{",["T_WHITESPACE","\n        ",233],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","_addOrdersStatistics",234],"(",")",";",["T_WHITESPACE","\n        ",234],["T_RETURN","return",235],["T_WHITESPACE"," ",235],["T_VARIABLE","$this",235],";",["T_WHITESPACE","\n    ",235],"}",["T_WHITESPACE","\n\n    ",236],["T_DOC_COMMENT","\/**\n     * Order by customer registration\n     *\n     * @param string $dir\n     * @return $this\n     *\/",238],["T_WHITESPACE","\n    ",243],["T_PUBLIC","public",244],["T_WHITESPACE"," ",244],["T_FUNCTION","function",244],["T_WHITESPACE"," ",244],["T_STRING","orderByCustomerRegistration",244],"(",["T_VARIABLE","$dir",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_STRING","self",244],["T_DOUBLE_COLON","::",244],["T_STRING","SORT_ORDER_DESC",244],")",["T_WHITESPACE","\n    ",244],"{",["T_WHITESPACE","\n        ",245],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","addAttributeToSort",246],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",246],",",["T_WHITESPACE"," ",246],["T_VARIABLE","$dir",246],")",";",["T_WHITESPACE","\n        ",246],["T_RETURN","return",247],["T_WHITESPACE"," ",247],["T_VARIABLE","$this",247],";",["T_WHITESPACE","\n    ",247],"}",["T_WHITESPACE","\n\n    ",248],["T_DOC_COMMENT","\/**\n     * Get select count sql\n     *\n     * @return string\n     *\/",250],["T_WHITESPACE","\n    ",254],["T_PUBLIC","public",255],["T_WHITESPACE"," ",255],["T_FUNCTION","function",255],["T_WHITESPACE"," ",255],["T_STRING","getSelectCountSql",255],"(",")",["T_WHITESPACE","\n    ",255],"{",["T_WHITESPACE","\n        ",256],["T_VARIABLE","$countSelect",257],["T_WHITESPACE"," ",257],"=",["T_WHITESPACE"," ",257],["T_CLONE","clone",257],["T_WHITESPACE"," ",257],["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","getSelect",257],"(",")",";",["T_WHITESPACE","\n        ",257],["T_VARIABLE","$countSelect",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","reset",258],"(",["T_NS_SEPARATOR","\\",258],["T_STRING","Magento",258],["T_NS_SEPARATOR","\\",258],["T_STRING","Framework",258],["T_NS_SEPARATOR","\\",258],["T_STRING","DB",258],["T_NS_SEPARATOR","\\",258],["T_STRING","Select",258],["T_DOUBLE_COLON","::",258],["T_STRING","ORDER",258],")",";",["T_WHITESPACE","\n        ",258],["T_VARIABLE","$countSelect",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","reset",259],"(",["T_NS_SEPARATOR","\\",259],["T_STRING","Magento",259],["T_NS_SEPARATOR","\\",259],["T_STRING","Framework",259],["T_NS_SEPARATOR","\\",259],["T_STRING","DB",259],["T_NS_SEPARATOR","\\",259],["T_STRING","Select",259],["T_DOUBLE_COLON","::",259],["T_STRING","LIMIT_COUNT",259],")",";",["T_WHITESPACE","\n        ",259],["T_VARIABLE","$countSelect",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","reset",260],"(",["T_NS_SEPARATOR","\\",260],["T_STRING","Magento",260],["T_NS_SEPARATOR","\\",260],["T_STRING","Framework",260],["T_NS_SEPARATOR","\\",260],["T_STRING","DB",260],["T_NS_SEPARATOR","\\",260],["T_STRING","Select",260],["T_DOUBLE_COLON","::",260],["T_STRING","LIMIT_OFFSET",260],")",";",["T_WHITESPACE","\n        ",260],["T_VARIABLE","$countSelect",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","reset",261],"(",["T_NS_SEPARATOR","\\",261],["T_STRING","Magento",261],["T_NS_SEPARATOR","\\",261],["T_STRING","Framework",261],["T_NS_SEPARATOR","\\",261],["T_STRING","DB",261],["T_NS_SEPARATOR","\\",261],["T_STRING","Select",261],["T_DOUBLE_COLON","::",261],["T_STRING","COLUMNS",261],")",";",["T_WHITESPACE","\n        ",261],["T_VARIABLE","$countSelect",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","reset",262],"(",["T_NS_SEPARATOR","\\",262],["T_STRING","Magento",262],["T_NS_SEPARATOR","\\",262],["T_STRING","Framework",262],["T_NS_SEPARATOR","\\",262],["T_STRING","DB",262],["T_NS_SEPARATOR","\\",262],["T_STRING","Select",262],["T_DOUBLE_COLON","::",262],["T_STRING","GROUP",262],")",";",["T_WHITESPACE","\n        ",262],["T_VARIABLE","$countSelect",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","reset",263],"(",["T_NS_SEPARATOR","\\",263],["T_STRING","Magento",263],["T_NS_SEPARATOR","\\",263],["T_STRING","Framework",263],["T_NS_SEPARATOR","\\",263],["T_STRING","DB",263],["T_NS_SEPARATOR","\\",263],["T_STRING","Select",263],["T_DOUBLE_COLON","::",263],["T_STRING","HAVING",263],")",";",["T_WHITESPACE","\n        ",263],["T_VARIABLE","$countSelect",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","columns",264],"(",["T_CONSTANT_ENCAPSED_STRING","\"count(DISTINCT e.entity_id)\"",264],")",";",["T_WHITESPACE","\n\n        ",264],["T_RETURN","return",266],["T_WHITESPACE"," ",266],["T_VARIABLE","$countSelect",266],";",["T_WHITESPACE","\n    ",266],"}",["T_WHITESPACE","\n",267],"}",["T_WHITESPACE","\n",268]]