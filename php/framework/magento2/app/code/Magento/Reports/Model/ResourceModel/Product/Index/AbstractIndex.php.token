[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Reports",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Model",7],["T_NS_SEPARATOR","\\",7],["T_STRING","ResourceModel",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Product",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Index",7],";",["T_WHITESPACE","\n\n",7],["T_DOC_COMMENT","\/**\n * Reports Product Index Abstract Resource Model\n *\/",9],["T_WHITESPACE","\n",11],["T_ABSTRACT","abstract",12],["T_WHITESPACE"," ",12],["T_CLASS","class",12],["T_WHITESPACE"," ",12],["T_STRING","AbstractIndex",12],["T_WHITESPACE"," ",12],["T_EXTENDS","extends",12],["T_WHITESPACE"," ",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Framework",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Model",12],["T_NS_SEPARATOR","\\",12],["T_STRING","ResourceModel",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Db",12],["T_NS_SEPARATOR","\\",12],["T_STRING","AbstractDb",12],["T_WHITESPACE","\n",12],"{",["T_WHITESPACE","\n    ",13],["T_DOC_COMMENT","\/**\n     * Reports helper\n     *\n     * @var \\Magento\\Reports\\Model\\ResourceModel\\Helper\n     *\/",14],["T_WHITESPACE","\n    ",18],["T_PROTECTED","protected",19],["T_WHITESPACE"," ",19],["T_VARIABLE","$_resourceHelper",19],";",["T_WHITESPACE","\n\n    ",19],["T_DOC_COMMENT","\/**\n     * Constructor\n     *\n     * @param \\Magento\\Framework\\Model\\ResourceModel\\Db\\Context $context\n     * @param \\Magento\\Reports\\Model\\ResourceModel\\Helper $resourceHelper\n     * @param string $connectionName\n     *\/",21],["T_WHITESPACE","\n    ",27],["T_PUBLIC","public",28],["T_WHITESPACE"," ",28],["T_FUNCTION","function",28],["T_WHITESPACE"," ",28],["T_STRING","__construct",28],"(",["T_WHITESPACE","\n        ",28],["T_NS_SEPARATOR","\\",29],["T_STRING","Magento",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Framework",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Model",29],["T_NS_SEPARATOR","\\",29],["T_STRING","ResourceModel",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Db",29],["T_NS_SEPARATOR","\\",29],["T_STRING","Context",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$context",29],",",["T_WHITESPACE","\n        ",29],["T_NS_SEPARATOR","\\",30],["T_STRING","Magento",30],["T_NS_SEPARATOR","\\",30],["T_STRING","Reports",30],["T_NS_SEPARATOR","\\",30],["T_STRING","Model",30],["T_NS_SEPARATOR","\\",30],["T_STRING","ResourceModel",30],["T_NS_SEPARATOR","\\",30],["T_STRING","Helper",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$resourceHelper",30],",",["T_WHITESPACE","\n        ",30],["T_VARIABLE","$connectionName",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_STRING","null",31],["T_WHITESPACE","\n    ",31],")",["T_WHITESPACE"," ",32],"{",["T_WHITESPACE","\n        ",32],["T_STRING","parent",33],["T_DOUBLE_COLON","::",33],["T_STRING","__construct",33],"(",["T_VARIABLE","$context",33],",",["T_WHITESPACE"," ",33],["T_VARIABLE","$connectionName",33],")",";",["T_WHITESPACE","\n        ",33],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","_resourceHelper",34],["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_VARIABLE","$resourceHelper",34],";",["T_WHITESPACE","\n    ",34],"}",["T_WHITESPACE","\n\n    ",35],["T_DOC_COMMENT","\/**\n     * Update Customer from visitor (Customer logged in)\n     *\n     * @param \\Magento\\Reports\\Model\\Product\\Index\\AbstractIndex $object\n     * @return $this\n     *\/",37],["T_WHITESPACE","\n    ",42],["T_PUBLIC","public",43],["T_WHITESPACE"," ",43],["T_FUNCTION","function",43],["T_WHITESPACE"," ",43],["T_STRING","updateCustomerFromVisitor",43],"(",["T_NS_SEPARATOR","\\",43],["T_STRING","Magento",43],["T_NS_SEPARATOR","\\",43],["T_STRING","Reports",43],["T_NS_SEPARATOR","\\",43],["T_STRING","Model",43],["T_NS_SEPARATOR","\\",43],["T_STRING","Product",43],["T_NS_SEPARATOR","\\",43],["T_STRING","Index",43],["T_NS_SEPARATOR","\\",43],["T_STRING","AbstractIndex",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$object",43],")",["T_WHITESPACE","\n    ",43],"{",["T_WHITESPACE","\n        ",44],["T_DOC_COMMENT","\/**\n         * Do nothing if customer not logged in\n         *\/",45],["T_WHITESPACE","\n        ",47],["T_IF","if",48],["T_WHITESPACE"," ",48],"(","!",["T_VARIABLE","$object",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","getCustomerId",48],"(",")",["T_WHITESPACE"," ",48],["T_BOOLEAN_OR","||",48],["T_WHITESPACE"," ",48],"!",["T_VARIABLE","$object",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","getVisitorId",48],"(",")",")",["T_WHITESPACE"," ",48],"{",["T_WHITESPACE","\n            ",48],["T_RETURN","return",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$this",49],";",["T_WHITESPACE","\n        ",49],"}",["T_WHITESPACE","\n        ",50],["T_VARIABLE","$connection",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","getConnection",51],"(",")",";",["T_WHITESPACE","\n        ",51],["T_VARIABLE","$select",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$connection",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","select",52],"(",")",["T_WHITESPACE","\n            ",52],["T_OBJECT_OPERATOR","->",53],["T_STRING","from",53],"(",["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","getMainTable",53],"(",")",")",["T_WHITESPACE","\n            ",53],["T_OBJECT_OPERATOR","->",54],["T_STRING","where",54],"(",["T_CONSTANT_ENCAPSED_STRING","'visitor_id = ?'",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$object",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","getVisitorId",54],"(",")",")",";",["T_WHITESPACE","\n\n        ",54],["T_VARIABLE","$rowSet",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$select",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","query",56],"(",")",["T_OBJECT_OPERATOR","->",56],["T_STRING","fetchAll",56],"(",")",";",["T_WHITESPACE","\n        ",56],["T_FOREACH","foreach",57],["T_WHITESPACE"," ",57],"(",["T_VARIABLE","$rowSet",57],["T_WHITESPACE"," ",57],["T_AS","as",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$row",57],")",["T_WHITESPACE"," ",57],"{",["T_WHITESPACE","\n            ",57],["T_COMMENT","\/* We need to determine if there are rows with known\n               customer for current product.\n               *\/",58],["T_WHITESPACE","\n\n            ",60],["T_VARIABLE","$select",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_VARIABLE","$connection",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","select",62],"(",")",["T_OBJECT_OPERATOR","->",62],["T_STRING","from",62],"(",["T_WHITESPACE","\n                ",62],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","getMainTable",63],"(",")",["T_WHITESPACE","\n            ",63],")",["T_OBJECT_OPERATOR","->",64],["T_STRING","where",64],"(",["T_WHITESPACE","\n                ",64],["T_CONSTANT_ENCAPSED_STRING","'customer_id = ?'",65],",",["T_WHITESPACE","\n                ",65],["T_VARIABLE","$object",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getCustomerId",66],"(",")",["T_WHITESPACE","\n            ",66],")",["T_OBJECT_OPERATOR","->",67],["T_STRING","where",67],"(",["T_WHITESPACE","\n                ",67],["T_CONSTANT_ENCAPSED_STRING","'product_id = ?'",68],",",["T_WHITESPACE","\n                ",68],["T_VARIABLE","$row",69],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",69],"]",["T_WHITESPACE","\n            ",69],")",";",["T_WHITESPACE","\n            ",70],["T_VARIABLE","$idx",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$connection",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","fetchRow",71],"(",["T_VARIABLE","$select",71],")",";",["T_WHITESPACE","\n\n            ",71],["T_IF","if",73],["T_WHITESPACE"," ",73],"(",["T_VARIABLE","$idx",73],")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n                ",73],["T_DOC_COMMENT","\/**\n                 * If we are here it means that we have two rows: one with known customer and second with guest visitor\n                 * One row should be updated with customer_id, second should be deleted\n                 *\/",74],["T_WHITESPACE","\n                ",77],["T_VARIABLE","$connection",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","delete",78],"(",["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getMainTable",78],"(",")",",",["T_WHITESPACE"," ",78],"[",["T_CONSTANT_ENCAPSED_STRING","'index_id = ?'",78],["T_WHITESPACE"," ",78],["T_DOUBLE_ARROW","=>",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$row",78],"[",["T_CONSTANT_ENCAPSED_STRING","'index_id'",78],"]","]",")",";",["T_WHITESPACE","\n                ",78],["T_VARIABLE","$where",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],"[",["T_CONSTANT_ENCAPSED_STRING","'index_id = ?'",79],["T_WHITESPACE"," ",79],["T_DOUBLE_ARROW","=>",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$idx",79],"[",["T_CONSTANT_ENCAPSED_STRING","'index_id'",79],"]","]",";",["T_WHITESPACE","\n                ",79],["T_VARIABLE","$data",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],"[",["T_WHITESPACE","\n                    ",80],["T_CONSTANT_ENCAPSED_STRING","'visitor_id'",81],["T_WHITESPACE"," ",81],["T_DOUBLE_ARROW","=>",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$object",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getVisitorId",81],"(",")",",",["T_WHITESPACE","\n                    ",81],["T_CONSTANT_ENCAPSED_STRING","'store_id'",82],["T_WHITESPACE"," ",82],["T_DOUBLE_ARROW","=>",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$object",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","getStoreId",82],"(",")",",",["T_WHITESPACE","\n                ",82],"]",";",["T_WHITESPACE","\n            ",83],"}",["T_WHITESPACE"," ",84],["T_ELSE","else",84],["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n                ",84],["T_VARIABLE","$where",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],"[",["T_CONSTANT_ENCAPSED_STRING","'index_id = ?'",85],["T_WHITESPACE"," ",85],["T_DOUBLE_ARROW","=>",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$row",85],"[",["T_CONSTANT_ENCAPSED_STRING","'index_id'",85],"]","]",";",["T_WHITESPACE","\n                ",85],["T_VARIABLE","$data",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],"[",["T_WHITESPACE","\n                    ",86],["T_CONSTANT_ENCAPSED_STRING","'customer_id'",87],["T_WHITESPACE"," ",87],["T_DOUBLE_ARROW","=>",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$object",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getCustomerId",87],"(",")",",",["T_WHITESPACE","\n                    ",87],["T_CONSTANT_ENCAPSED_STRING","'store_id'",88],["T_WHITESPACE"," ",88],["T_DOUBLE_ARROW","=>",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$object",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","getStoreId",88],"(",")",",",["T_WHITESPACE","\n                ",88],"]",";",["T_WHITESPACE","\n            ",89],"}",["T_WHITESPACE","\n\n            ",90],["T_VARIABLE","$connection",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","update",92],"(",["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getMainTable",92],"(",")",",",["T_WHITESPACE"," ",92],["T_VARIABLE","$data",92],",",["T_WHITESPACE"," ",92],["T_VARIABLE","$where",92],")",";",["T_WHITESPACE","\n        ",92],"}",["T_WHITESPACE","\n        ",93],["T_RETURN","return",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],";",["T_WHITESPACE","\n    ",94],"}",["T_WHITESPACE","\n\n    ",95],["T_DOC_COMMENT","\/**\n     * Purge visitor data by customer (logout)\n     *\n     * @param \\Magento\\Reports\\Model\\Product\\Index\\AbstractIndex $object\n     * @return $this\n     *\/",97],["T_WHITESPACE","\n    ",102],["T_PUBLIC","public",103],["T_WHITESPACE"," ",103],["T_FUNCTION","function",103],["T_WHITESPACE"," ",103],["T_STRING","purgeVisitorByCustomer",103],"(",["T_NS_SEPARATOR","\\",103],["T_STRING","Magento",103],["T_NS_SEPARATOR","\\",103],["T_STRING","Reports",103],["T_NS_SEPARATOR","\\",103],["T_STRING","Model",103],["T_NS_SEPARATOR","\\",103],["T_STRING","Product",103],["T_NS_SEPARATOR","\\",103],["T_STRING","Index",103],["T_NS_SEPARATOR","\\",103],["T_STRING","AbstractIndex",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$object",103],")",["T_WHITESPACE","\n    ",103],"{",["T_WHITESPACE","\n        ",104],["T_DOC_COMMENT","\/**\n         * Do nothing if customer not logged in\n         *\/",105],["T_WHITESPACE","\n        ",107],["T_IF","if",108],["T_WHITESPACE"," ",108],"(","!",["T_VARIABLE","$object",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getCustomerId",108],"(",")",")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n            ",108],["T_RETURN","return",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$this",109],";",["T_WHITESPACE","\n        ",109],"}",["T_WHITESPACE","\n\n        ",110],["T_VARIABLE","$bind",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],"[",["T_CONSTANT_ENCAPSED_STRING","'visitor_id'",112],["T_WHITESPACE"," ",112],["T_DOUBLE_ARROW","=>",112],["T_WHITESPACE"," ",112],["T_STRING","null",112],"]",";",["T_WHITESPACE","\n        ",112],["T_VARIABLE","$where",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_id = ?'",113],["T_WHITESPACE"," ",113],["T_DOUBLE_ARROW","=>",113],["T_WHITESPACE"," ",113],["T_INT_CAST","(int)",113],["T_VARIABLE","$object",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","getCustomerId",113],"(",")","]",";",["T_WHITESPACE","\n        ",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","getConnection",114],"(",")",["T_OBJECT_OPERATOR","->",114],["T_STRING","update",114],"(",["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","getMainTable",114],"(",")",",",["T_WHITESPACE"," ",114],["T_VARIABLE","$bind",114],",",["T_WHITESPACE"," ",114],["T_VARIABLE","$where",114],")",";",["T_WHITESPACE","\n\n        ",114],["T_RETURN","return",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],";",["T_WHITESPACE","\n    ",116],"}",["T_WHITESPACE","\n\n    ",117],["T_DOC_COMMENT","\/**\n     * Save Product Index data (forced save)\n     *\n     * @param \\Magento\\Framework\\Model\\AbstractModel $object\n     * @return $this|\\Magento\\Framework\\Model\\ResourceModel\\Db\\AbstractDb\n     *\/",119],["T_WHITESPACE","\n    ",124],["T_PUBLIC","public",125],["T_WHITESPACE"," ",125],["T_FUNCTION","function",125],["T_WHITESPACE"," ",125],["T_STRING","save",125],"(",["T_NS_SEPARATOR","\\",125],["T_STRING","Magento",125],["T_NS_SEPARATOR","\\",125],["T_STRING","Framework",125],["T_NS_SEPARATOR","\\",125],["T_STRING","Model",125],["T_NS_SEPARATOR","\\",125],["T_STRING","AbstractModel",125],["T_WHITESPACE"," ",125],["T_VARIABLE","$object",125],")",["T_WHITESPACE","\n    ",125],"{",["T_WHITESPACE","\n        ",126],["T_IF","if",127],["T_WHITESPACE"," ",127],"(",["T_VARIABLE","$object",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","isDeleted",127],"(",")",")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n            ",127],["T_RETURN","return",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","delete",128],"(",["T_VARIABLE","$object",128],")",";",["T_WHITESPACE","\n        ",128],"}",["T_WHITESPACE","\n\n        ",129],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","_serializeFields",131],"(",["T_VARIABLE","$object",131],")",";",["T_WHITESPACE","\n        ",131],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","_beforeSave",132],"(",["T_VARIABLE","$object",132],")",";",["T_WHITESPACE","\n        ",132],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_checkUnique",133],"(",["T_VARIABLE","$object",133],")",";",["T_WHITESPACE","\n\n        ",133],["T_VARIABLE","$data",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","_prepareDataForSave",135],"(",["T_VARIABLE","$object",135],")",";",["T_WHITESPACE","\n        ",135],["T_UNSET","unset",136],"(",["T_VARIABLE","$data",136],"[",["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","getIdFieldName",136],"(",")","]",")",";",["T_WHITESPACE","\n\n        ",136],["T_VARIABLE","$matchFields",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",138],",",["T_WHITESPACE"," ",138],["T_CONSTANT_ENCAPSED_STRING","'store_id'",138],"]",";",["T_WHITESPACE","\n\n        ",138],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","_resourceHelper",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","mergeVisitorProductIndex",140],"(",["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","getMainTable",140],"(",")",",",["T_WHITESPACE"," ",140],["T_VARIABLE","$data",140],",",["T_WHITESPACE"," ",140],["T_VARIABLE","$matchFields",140],")",";",["T_WHITESPACE","\n\n        ",140],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","unserializeFields",142],"(",["T_VARIABLE","$object",142],")",";",["T_WHITESPACE","\n        ",142],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","_afterSave",143],"(",["T_VARIABLE","$object",143],")",";",["T_WHITESPACE","\n\n        ",143],["T_RETURN","return",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$this",145],";",["T_WHITESPACE","\n    ",145],"}",["T_WHITESPACE","\n\n    ",146],["T_DOC_COMMENT","\/**\n     * Clean index (visitor)\n     *\n     * @return $this\n     *\/",148],["T_WHITESPACE","\n    ",152],["T_PUBLIC","public",153],["T_WHITESPACE"," ",153],["T_FUNCTION","function",153],["T_WHITESPACE"," ",153],["T_STRING","clean",153],"(",")",["T_WHITESPACE","\n    ",153],"{",["T_WHITESPACE","\n        ",154],["T_WHILE","while",155],["T_WHITESPACE"," ",155],"(",["T_STRING","true",155],")",["T_WHITESPACE"," ",155],"{",["T_WHITESPACE","\n            ",155],["T_VARIABLE","$select",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","getConnection",156],"(",")",["T_OBJECT_OPERATOR","->",156],["T_STRING","select",156],"(",")",["T_OBJECT_OPERATOR","->",156],["T_STRING","from",156],"(",["T_WHITESPACE","\n                ",156],"[",["T_CONSTANT_ENCAPSED_STRING","'main_table'",157],["T_WHITESPACE"," ",157],["T_DOUBLE_ARROW","=>",157],["T_WHITESPACE"," ",157],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","getMainTable",157],"(",")","]",",",["T_WHITESPACE","\n                ",157],"[",["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","getIdFieldName",158],"(",")","]",["T_WHITESPACE","\n            ",158],")",["T_OBJECT_OPERATOR","->",159],["T_STRING","joinLeft",159],"(",["T_WHITESPACE","\n                ",159],"[",["T_CONSTANT_ENCAPSED_STRING","'visitor_table'",160],["T_WHITESPACE"," ",160],["T_DOUBLE_ARROW","=>",160],["T_WHITESPACE"," ",160],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","getTable",160],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_visitor'",160],")","]",",",["T_WHITESPACE","\n                ",160],["T_CONSTANT_ENCAPSED_STRING","'main_table.visitor_id = visitor_table.visitor_id'",161],",",["T_WHITESPACE","\n                ",161],"[","]",["T_WHITESPACE","\n            ",162],")",["T_OBJECT_OPERATOR","->",163],["T_STRING","where",163],"(",["T_WHITESPACE","\n                ",163],["T_CONSTANT_ENCAPSED_STRING","'main_table.visitor_id > ?'",164],",",["T_WHITESPACE","\n                ",164],["T_LNUMBER","0",165],["T_WHITESPACE","\n            ",165],")",["T_OBJECT_OPERATOR","->",166],["T_STRING","where",166],"(",["T_WHITESPACE","\n                ",166],["T_CONSTANT_ENCAPSED_STRING","'visitor_table.visitor_id IS NULL'",167],["T_WHITESPACE","\n            ",167],")",["T_OBJECT_OPERATOR","->",168],["T_STRING","limit",168],"(",["T_WHITESPACE","\n                ",168],["T_LNUMBER","100",169],["T_WHITESPACE","\n            ",169],")",";",["T_WHITESPACE","\n            ",170],["T_VARIABLE","$indexIds",171],["T_WHITESPACE"," ",171],"=",["T_WHITESPACE"," ",171],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","getConnection",171],"(",")",["T_OBJECT_OPERATOR","->",171],["T_STRING","fetchCol",171],"(",["T_VARIABLE","$select",171],")",";",["T_WHITESPACE","\n\n            ",171],["T_IF","if",173],["T_WHITESPACE"," ",173],"(","!",["T_VARIABLE","$indexIds",173],")",["T_WHITESPACE"," ",173],"{",["T_WHITESPACE","\n                ",173],["T_BREAK","break",174],";",["T_WHITESPACE","\n            ",174],"}",["T_WHITESPACE","\n\n            ",175],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","getConnection",177],"(",")",["T_OBJECT_OPERATOR","->",177],["T_STRING","delete",177],"(",["T_WHITESPACE","\n                ",177],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","getMainTable",178],"(",")",",",["T_WHITESPACE","\n                ",178],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","getConnection",179],"(",")",["T_OBJECT_OPERATOR","->",179],["T_STRING","quoteInto",179],"(",["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","getIdFieldName",179],"(",")",["T_WHITESPACE"," ",179],".",["T_WHITESPACE"," ",179],["T_CONSTANT_ENCAPSED_STRING","' IN(?)'",179],",",["T_WHITESPACE"," ",179],["T_VARIABLE","$indexIds",179],")",["T_WHITESPACE","\n            ",179],")",";",["T_WHITESPACE","\n        ",180],"}",["T_WHITESPACE","\n        ",181],["T_RETURN","return",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$this",182],";",["T_WHITESPACE","\n    ",182],"}",["T_WHITESPACE","\n\n    ",183],["T_DOC_COMMENT","\/**\n     * Add information about product ids to visitor\/customer\n     *\n     * @param \\Magento\\Framework\\DataObject|\\Magento\\Reports\\Model\\Product\\Index\\AbstractIndex $object\n     * @param int[] $productIds\n     * @return $this\n     *\/",185],["T_WHITESPACE","\n    ",191],["T_PUBLIC","public",192],["T_WHITESPACE"," ",192],["T_FUNCTION","function",192],["T_WHITESPACE"," ",192],["T_STRING","registerIds",192],"(",["T_NS_SEPARATOR","\\",192],["T_STRING","Magento",192],["T_NS_SEPARATOR","\\",192],["T_STRING","Framework",192],["T_NS_SEPARATOR","\\",192],["T_STRING","DataObject",192],["T_WHITESPACE"," ",192],["T_VARIABLE","$object",192],",",["T_WHITESPACE"," ",192],["T_VARIABLE","$productIds",192],")",["T_WHITESPACE","\n    ",192],"{",["T_WHITESPACE","\n        ",193],["T_VARIABLE","$row",194],["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],"[",["T_WHITESPACE","\n            ",194],["T_CONSTANT_ENCAPSED_STRING","'visitor_id'",195],["T_WHITESPACE"," ",195],["T_DOUBLE_ARROW","=>",195],["T_WHITESPACE"," ",195],["T_VARIABLE","$object",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","getVisitorId",195],"(",")",",",["T_WHITESPACE","\n            ",195],["T_CONSTANT_ENCAPSED_STRING","'customer_id'",196],["T_WHITESPACE"," ",196],["T_DOUBLE_ARROW","=>",196],["T_WHITESPACE"," ",196],["T_VARIABLE","$object",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","getCustomerId",196],"(",")",",",["T_WHITESPACE","\n            ",196],["T_CONSTANT_ENCAPSED_STRING","'store_id'",197],["T_WHITESPACE"," ",197],["T_DOUBLE_ARROW","=>",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$object",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","getStoreId",197],"(",")",",",["T_WHITESPACE","\n        ",197],"]",";",["T_WHITESPACE","\n        ",198],["T_VARIABLE","$data",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],"[","]",";",["T_WHITESPACE","\n        ",199],["T_FOREACH","foreach",200],["T_WHITESPACE"," ",200],"(",["T_VARIABLE","$productIds",200],["T_WHITESPACE"," ",200],["T_AS","as",200],["T_WHITESPACE"," ",200],["T_VARIABLE","$productId",200],")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n            ",200],["T_VARIABLE","$productId",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_INT_CAST","(int)",201],["T_VARIABLE","$productId",201],";",["T_WHITESPACE","\n            ",201],["T_IF","if",202],["T_WHITESPACE"," ",202],"(",["T_VARIABLE","$productId",202],")",["T_WHITESPACE"," ",202],"{",["T_WHITESPACE","\n                ",202],["T_VARIABLE","$row",203],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",203],"]",["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_VARIABLE","$productId",203],";",["T_WHITESPACE","\n                ",203],["T_VARIABLE","$data",204],"[","]",["T_WHITESPACE"," ",204],"=",["T_WHITESPACE"," ",204],["T_VARIABLE","$row",204],";",["T_WHITESPACE","\n            ",204],"}",["T_WHITESPACE","\n        ",205],"}",["T_WHITESPACE","\n\n        ",206],["T_VARIABLE","$matchFields",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",208],",",["T_WHITESPACE"," ",208],["T_CONSTANT_ENCAPSED_STRING","'store_id'",208],"]",";",["T_WHITESPACE","\n        ",208],["T_FOREACH","foreach",209],["T_WHITESPACE"," ",209],"(",["T_VARIABLE","$data",209],["T_WHITESPACE"," ",209],["T_AS","as",209],["T_WHITESPACE"," ",209],["T_VARIABLE","$row",209],")",["T_WHITESPACE"," ",209],"{",["T_WHITESPACE","\n            ",209],["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","_resourceHelper",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","mergeVisitorProductIndex",210],"(",["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","getMainTable",210],"(",")",",",["T_WHITESPACE"," ",210],["T_VARIABLE","$row",210],",",["T_WHITESPACE"," ",210],["T_VARIABLE","$matchFields",210],")",";",["T_WHITESPACE","\n        ",210],"}",["T_WHITESPACE","\n        ",211],["T_RETURN","return",212],["T_WHITESPACE"," ",212],["T_VARIABLE","$this",212],";",["T_WHITESPACE","\n    ",212],"}",["T_WHITESPACE","\n",213],"}",["T_WHITESPACE","\n",214]]