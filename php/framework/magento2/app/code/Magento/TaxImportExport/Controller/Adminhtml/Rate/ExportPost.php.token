[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","TaxImportExport",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Controller",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Adminhtml",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Rate",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","App",8],["T_NS_SEPARATOR","\\",8],["T_STRING","ResponseInterface",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","App",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Filesystem",9],["T_NS_SEPARATOR","\\",9],["T_STRING","DirectoryList",9],";",["T_WHITESPACE","\n\n",9],["T_CLASS","class",11],["T_WHITESPACE"," ",11],["T_STRING","ExportPost",11],["T_WHITESPACE"," ",11],["T_EXTENDS","extends",11],["T_WHITESPACE"," ",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","TaxImportExport",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Controller",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Adminhtml",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Rate",11],["T_WHITESPACE","\n",11],"{",["T_WHITESPACE","\n    ",12],["T_DOC_COMMENT","\/**\n     * Export action from import\/export tax\n     *\n     * @return ResponseInterface\n     *\/",13],["T_WHITESPACE","\n    ",17],["T_PUBLIC","public",18],["T_WHITESPACE"," ",18],["T_FUNCTION","function",18],["T_WHITESPACE"," ",18],["T_STRING","execute",18],"(",")",["T_WHITESPACE","\n    ",18],"{",["T_WHITESPACE","\n        ",19],["T_DOC_COMMENT","\/** start csv content and set template *\/",20],["T_WHITESPACE","\n        ",20],["T_VARIABLE","$headers",21],["T_WHITESPACE"," ",21],"=",["T_WHITESPACE"," ",21],["T_NEW","new",21],["T_WHITESPACE"," ",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Magento",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Framework",21],["T_NS_SEPARATOR","\\",21],["T_STRING","DataObject",21],"(",["T_WHITESPACE","\n            ",21],"[",["T_WHITESPACE","\n                ",22],["T_CONSTANT_ENCAPSED_STRING","'code'",23],["T_WHITESPACE"," ",23],["T_DOUBLE_ARROW","=>",23],["T_WHITESPACE"," ",23],["T_STRING","__",23],"(",["T_CONSTANT_ENCAPSED_STRING","'Code'",23],")",",",["T_WHITESPACE","\n                ",23],["T_CONSTANT_ENCAPSED_STRING","'country_name'",24],["T_WHITESPACE"," ",24],["T_DOUBLE_ARROW","=>",24],["T_WHITESPACE"," ",24],["T_STRING","__",24],"(",["T_CONSTANT_ENCAPSED_STRING","'Country'",24],")",",",["T_WHITESPACE","\n                ",24],["T_CONSTANT_ENCAPSED_STRING","'region_name'",25],["T_WHITESPACE"," ",25],["T_DOUBLE_ARROW","=>",25],["T_WHITESPACE"," ",25],["T_STRING","__",25],"(",["T_CONSTANT_ENCAPSED_STRING","'State'",25],")",",",["T_WHITESPACE","\n                ",25],["T_CONSTANT_ENCAPSED_STRING","'tax_postcode'",26],["T_WHITESPACE"," ",26],["T_DOUBLE_ARROW","=>",26],["T_WHITESPACE"," ",26],["T_STRING","__",26],"(",["T_CONSTANT_ENCAPSED_STRING","'Zip\/Post Code'",26],")",",",["T_WHITESPACE","\n                ",26],["T_CONSTANT_ENCAPSED_STRING","'rate'",27],["T_WHITESPACE"," ",27],["T_DOUBLE_ARROW","=>",27],["T_WHITESPACE"," ",27],["T_STRING","__",27],"(",["T_CONSTANT_ENCAPSED_STRING","'Rate'",27],")",",",["T_WHITESPACE","\n                ",27],["T_CONSTANT_ENCAPSED_STRING","'zip_is_range'",28],["T_WHITESPACE"," ",28],["T_DOUBLE_ARROW","=>",28],["T_WHITESPACE"," ",28],["T_STRING","__",28],"(",["T_CONSTANT_ENCAPSED_STRING","'Zip\/Post is Range'",28],")",",",["T_WHITESPACE","\n                ",28],["T_CONSTANT_ENCAPSED_STRING","'zip_from'",29],["T_WHITESPACE"," ",29],["T_DOUBLE_ARROW","=>",29],["T_WHITESPACE"," ",29],["T_STRING","__",29],"(",["T_CONSTANT_ENCAPSED_STRING","'Range From'",29],")",",",["T_WHITESPACE","\n                ",29],["T_CONSTANT_ENCAPSED_STRING","'zip_to'",30],["T_WHITESPACE"," ",30],["T_DOUBLE_ARROW","=>",30],["T_WHITESPACE"," ",30],["T_STRING","__",30],"(",["T_CONSTANT_ENCAPSED_STRING","'Range To'",30],")",",",["T_WHITESPACE","\n            ",30],"]",["T_WHITESPACE","\n        ",31],")",";",["T_WHITESPACE","\n        ",32],["T_VARIABLE","$template",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'\"{{code}}\",\"{{country_name}}\",\"{{region_name}}\",\"{{tax_postcode}}\",\"{{rate}}\"'",33],["T_WHITESPACE"," ",33],".",["T_WHITESPACE","\n            ",33],["T_CONSTANT_ENCAPSED_STRING","',\"{{zip_is_range}}\",\"{{zip_from}}\",\"{{zip_to}}\"'",34],";",["T_WHITESPACE","\n        ",34],["T_VARIABLE","$content",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_VARIABLE","$headers",35],["T_OBJECT_OPERATOR","->",35],["T_STRING","toString",35],"(",["T_VARIABLE","$template",35],")",";",["T_WHITESPACE","\n\n        ",35],["T_VARIABLE","$storeTaxTitleTemplate",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],"[","]",";",["T_WHITESPACE","\n        ",37],["T_VARIABLE","$taxCalculationRateTitleDict",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],"[","]",";",["T_WHITESPACE","\n\n        ",38],["T_FOREACH","foreach",40],["T_WHITESPACE"," ",40],"(",["T_VARIABLE","$this",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","_objectManager",40],["T_OBJECT_OPERATOR","->",40],["T_STRING","create",40],"(",["T_WHITESPACE","\n            ",40],["T_NS_SEPARATOR","\\",41],["T_STRING","Magento",41],["T_NS_SEPARATOR","\\",41],["T_STRING","Store",41],["T_NS_SEPARATOR","\\",41],["T_STRING","Model",41],["T_NS_SEPARATOR","\\",41],["T_STRING","Store",41],["T_DOUBLE_COLON","::",41],["T_CLASS","class",41],["T_WHITESPACE","\n        ",41],")",["T_OBJECT_OPERATOR","->",42],["T_STRING","getCollection",42],"(",")",["T_OBJECT_OPERATOR","->",42],["T_STRING","setLoadDefault",42],"(",["T_WHITESPACE","\n            ",42],["T_STRING","false",43],["T_WHITESPACE","\n        ",43],")",["T_WHITESPACE"," ",44],["T_AS","as",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$store",44],")",["T_WHITESPACE"," ",44],"{",["T_WHITESPACE","\n            ",44],["T_VARIABLE","$storeTitle",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'title_'",45],["T_WHITESPACE"," ",45],".",["T_WHITESPACE"," ",45],["T_VARIABLE","$store",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","getId",45],"(",")",";",["T_WHITESPACE","\n            ",45],["T_VARIABLE","$content",46],["T_WHITESPACE"," ",46],["T_CONCAT_EQUAL",".=",46],["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","',\"'",46],["T_WHITESPACE"," ",46],".",["T_WHITESPACE"," ",46],["T_VARIABLE","$store",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","getCode",46],"(",")",["T_WHITESPACE"," ",46],".",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'\"'",46],";",["T_WHITESPACE","\n            ",46],["T_VARIABLE","$template",47],["T_WHITESPACE"," ",47],["T_CONCAT_EQUAL",".=",47],["T_WHITESPACE"," ",47],["T_CONSTANT_ENCAPSED_STRING","',\"{{'",47],["T_WHITESPACE"," ",47],".",["T_WHITESPACE"," ",47],["T_VARIABLE","$storeTitle",47],["T_WHITESPACE"," ",47],".",["T_WHITESPACE"," ",47],["T_CONSTANT_ENCAPSED_STRING","'}}\"'",47],";",["T_WHITESPACE","\n            ",47],["T_VARIABLE","$storeTaxTitleTemplate",48],"[",["T_VARIABLE","$storeTitle",48],"]",["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_STRING","null",48],";",["T_WHITESPACE","\n        ",48],"}",["T_WHITESPACE","\n        ",49],["T_UNSET","unset",50],"(",["T_VARIABLE","$store",50],")",";",["T_WHITESPACE","\n\n        ",50],["T_VARIABLE","$content",52],["T_WHITESPACE"," ",52],["T_CONCAT_EQUAL",".=",52],["T_WHITESPACE"," ",52],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",52],";",["T_WHITESPACE","\n\n        ",52],["T_FOREACH","foreach",54],["T_WHITESPACE"," ",54],"(",["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","_objectManager",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","create",54],"(",["T_WHITESPACE","\n            ",54],["T_NS_SEPARATOR","\\",55],["T_STRING","Magento",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Tax",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Model",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Calculation",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Rate",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Title",55],["T_DOUBLE_COLON","::",55],["T_CLASS","class",55],["T_WHITESPACE","\n        ",55],")",["T_OBJECT_OPERATOR","->",56],["T_STRING","getCollection",56],"(",")",["T_WHITESPACE"," ",56],["T_AS","as",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$title",56],")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n            ",56],["T_VARIABLE","$rateId",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$title",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","getTaxCalculationRateId",57],"(",")",";",["T_WHITESPACE","\n\n            ",57],["T_IF","if",59],["T_WHITESPACE"," ",59],"(","!",["T_STRING","array_key_exists",59],"(",["T_VARIABLE","$rateId",59],",",["T_WHITESPACE"," ",59],["T_VARIABLE","$taxCalculationRateTitleDict",59],")",")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n                ",59],["T_VARIABLE","$taxCalculationRateTitleDict",60],"[",["T_VARIABLE","$rateId",60],"]",["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$storeTaxTitleTemplate",60],";",["T_WHITESPACE","\n            ",60],"}",["T_WHITESPACE","\n\n            ",61],["T_VARIABLE","$taxCalculationRateTitleDict",63],"[",["T_VARIABLE","$rateId",63],"]","[",["T_CONSTANT_ENCAPSED_STRING","'title_'",63],["T_WHITESPACE"," ",63],".",["T_WHITESPACE"," ",63],["T_VARIABLE","$title",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","getStoreId",63],"(",")","]",["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_VARIABLE","$title",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","getValue",63],"(",")",";",["T_WHITESPACE","\n        ",63],"}",["T_WHITESPACE","\n        ",64],["T_UNSET","unset",65],"(",["T_VARIABLE","$title",65],")",";",["T_WHITESPACE","\n\n        ",65],["T_VARIABLE","$collection",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","_objectManager",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","create",67],"(",["T_WHITESPACE","\n            ",67],["T_NS_SEPARATOR","\\",68],["T_STRING","Magento",68],["T_NS_SEPARATOR","\\",68],["T_STRING","Tax",68],["T_NS_SEPARATOR","\\",68],["T_STRING","Model",68],["T_NS_SEPARATOR","\\",68],["T_STRING","ResourceModel",68],["T_NS_SEPARATOR","\\",68],["T_STRING","Calculation",68],["T_NS_SEPARATOR","\\",68],["T_STRING","Rate",68],["T_NS_SEPARATOR","\\",68],["T_STRING","Collection",68],["T_DOUBLE_COLON","::",68],["T_CLASS","class",68],["T_WHITESPACE","\n        ",68],")",["T_OBJECT_OPERATOR","->",69],["T_STRING","joinCountryTable",69],"(",")",["T_OBJECT_OPERATOR","->",69],["T_STRING","joinRegionTable",69],"(",")",";",["T_WHITESPACE","\n\n        ",69],["T_WHILE","while",71],["T_WHITESPACE"," ",71],"(",["T_VARIABLE","$rate",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$collection",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","fetchItem",71],"(",")",")",["T_WHITESPACE"," ",71],"{",["T_WHITESPACE","\n            ",71],["T_IF","if",72],["T_WHITESPACE"," ",72],"(",["T_VARIABLE","$rate",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","getTaxRegionId",72],"(",")",["T_WHITESPACE"," ",72],["T_IS_EQUAL","==",72],["T_WHITESPACE"," ",72],["T_LNUMBER","0",72],")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n                ",72],["T_VARIABLE","$rate",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","setRegionName",73],"(",["T_CONSTANT_ENCAPSED_STRING","'*'",73],")",";",["T_WHITESPACE","\n            ",73],"}",["T_WHITESPACE","\n\n            ",74],["T_IF","if",76],["T_WHITESPACE"," ",76],"(",["T_STRING","array_key_exists",76],"(",["T_VARIABLE","$rate",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getId",76],"(",")",",",["T_WHITESPACE"," ",76],["T_VARIABLE","$taxCalculationRateTitleDict",76],")",")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n                ",76],["T_VARIABLE","$rate",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","addData",77],"(",["T_VARIABLE","$taxCalculationRateTitleDict",77],"[",["T_VARIABLE","$rate",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getId",77],"(",")","]",")",";",["T_WHITESPACE","\n            ",77],"}",["T_WHITESPACE"," ",78],["T_ELSE","else",78],["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n                ",78],["T_VARIABLE","$rate",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","addData",79],"(",["T_VARIABLE","$storeTaxTitleTemplate",79],")",";",["T_WHITESPACE","\n            ",79],"}",["T_WHITESPACE","\n\n            ",80],["T_VARIABLE","$content",82],["T_WHITESPACE"," ",82],["T_CONCAT_EQUAL",".=",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$rate",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","toString",82],"(",["T_VARIABLE","$template",82],")",["T_WHITESPACE"," ",82],".",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",82],";",["T_WHITESPACE","\n        ",82],"}",["T_WHITESPACE","\n        ",83],["T_RETURN","return",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","fileFactory",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","create",84],"(",["T_CONSTANT_ENCAPSED_STRING","'tax_rates.csv'",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$content",84],",",["T_WHITESPACE"," ",84],["T_STRING","DirectoryList",84],["T_DOUBLE_COLON","::",84],["T_STRING","VAR_DIR",84],")",";",["T_WHITESPACE","\n    ",84],"}",["T_WHITESPACE","\n\n    ",85],["T_DOC_COMMENT","\/**\n     * @return bool\n     *\/",87],["T_WHITESPACE","\n    ",89],["T_PROTECTED","protected",90],["T_WHITESPACE"," ",90],["T_FUNCTION","function",90],["T_WHITESPACE"," ",90],["T_STRING","_isAllowed",90],"(",")",["T_WHITESPACE","\n    ",90],"{",["T_WHITESPACE","\n        ",91],["T_RETURN","return",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","_authorization",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","isAllowed",92],"(",["T_WHITESPACE","\n            ",92],["T_CONSTANT_ENCAPSED_STRING","'Magento_Tax::manage_tax'",93],["T_WHITESPACE","\n        ",93],")",["T_WHITESPACE"," ",94],["T_BOOLEAN_OR","||",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","_authorization",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","isAllowed",94],"(",["T_WHITESPACE","\n            ",94],["T_CONSTANT_ENCAPSED_STRING","'Magento_TaxImportExport::import_export'",95],["T_WHITESPACE","\n        ",95],")",";",["T_WHITESPACE","\n\n    ",96],"}",["T_WHITESPACE","\n",98],"}",["T_WHITESPACE","\n",99]]