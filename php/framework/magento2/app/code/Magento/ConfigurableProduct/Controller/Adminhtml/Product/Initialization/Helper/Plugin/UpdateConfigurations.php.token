[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Product initialzation helper\n *\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",7],["T_NAMESPACE","namespace",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","ConfigurableProduct",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Controller",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Adminhtml",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Product",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Initialization",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Helper",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Plugin",8],";",["T_WHITESPACE","\n\n",8],["T_CLASS","class",10],["T_WHITESPACE"," ",10],["T_STRING","UpdateConfigurations",10],["T_WHITESPACE","\n",10],"{",["T_WHITESPACE","\n    ",11],["T_DOC_COMMENT","\/** @var \\Magento\\Catalog\\Api\\ProductRepositoryInterface  *\/",12],["T_WHITESPACE","\n    ",12],["T_PROTECTED","protected",13],["T_WHITESPACE"," ",13],["T_VARIABLE","$productRepository",13],";",["T_WHITESPACE","\n\n    ",13],["T_DOC_COMMENT","\/** @var \\Magento\\Framework\\App\\RequestInterface *\/",15],["T_WHITESPACE","\n    ",15],["T_PROTECTED","protected",16],["T_WHITESPACE"," ",16],["T_VARIABLE","$request",16],";",["T_WHITESPACE","\n\n    ",16],["T_DOC_COMMENT","\/** @var \\Magento\\ConfigurableProduct\\Model\\Product\\VariationHandler *\/",18],["T_WHITESPACE","\n    ",18],["T_PROTECTED","protected",19],["T_WHITESPACE"," ",19],["T_VARIABLE","$variationHandler",19],";",["T_WHITESPACE","\n\n    ",19],["T_DOC_COMMENT","\/**\n     * @var array\n     *\/",21],["T_WHITESPACE","\n    ",23],["T_PRIVATE","private",24],["T_WHITESPACE"," ",24],["T_VARIABLE","$keysPost",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],"[",["T_WHITESPACE","\n        ",24],["T_CONSTANT_ENCAPSED_STRING","'status'",25],",",["T_WHITESPACE","\n        ",25],["T_CONSTANT_ENCAPSED_STRING","'sku'",26],",",["T_WHITESPACE","\n        ",26],["T_CONSTANT_ENCAPSED_STRING","'name'",27],",",["T_WHITESPACE","\n        ",27],["T_CONSTANT_ENCAPSED_STRING","'price'",28],",",["T_WHITESPACE","\n        ",28],["T_CONSTANT_ENCAPSED_STRING","'configurable_attribute'",29],",",["T_WHITESPACE","\n        ",29],["T_CONSTANT_ENCAPSED_STRING","'weight'",30],",",["T_WHITESPACE","\n        ",30],["T_CONSTANT_ENCAPSED_STRING","'media_gallery'",31],",",["T_WHITESPACE","\n        ",31],["T_CONSTANT_ENCAPSED_STRING","'swatch_image'",32],",",["T_WHITESPACE","\n        ",32],["T_CONSTANT_ENCAPSED_STRING","'small_image'",33],",",["T_WHITESPACE","\n        ",33],["T_CONSTANT_ENCAPSED_STRING","'thumbnail'",34],",",["T_WHITESPACE","\n        ",34],["T_CONSTANT_ENCAPSED_STRING","'image'",35],",",["T_WHITESPACE","\n    ",35],"]",";",["T_WHITESPACE","\n\n    ",36],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\App\\RequestInterface $request\n     * @param \\Magento\\Catalog\\Api\\ProductRepositoryInterface $productRepository\n     * @param \\Magento\\ConfigurableProduct\\Model\\Product\\VariationHandler $variationHandler\n     *\/",38],["T_WHITESPACE","\n    ",42],["T_PUBLIC","public",43],["T_WHITESPACE"," ",43],["T_FUNCTION","function",43],["T_WHITESPACE"," ",43],["T_STRING","__construct",43],"(",["T_WHITESPACE","\n        ",43],["T_NS_SEPARATOR","\\",44],["T_STRING","Magento",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Framework",44],["T_NS_SEPARATOR","\\",44],["T_STRING","App",44],["T_NS_SEPARATOR","\\",44],["T_STRING","RequestInterface",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$request",44],",",["T_WHITESPACE","\n        ",44],["T_NS_SEPARATOR","\\",45],["T_STRING","Magento",45],["T_NS_SEPARATOR","\\",45],["T_STRING","Catalog",45],["T_NS_SEPARATOR","\\",45],["T_STRING","Api",45],["T_NS_SEPARATOR","\\",45],["T_STRING","ProductRepositoryInterface",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$productRepository",45],",",["T_WHITESPACE","\n        ",45],["T_NS_SEPARATOR","\\",46],["T_STRING","Magento",46],["T_NS_SEPARATOR","\\",46],["T_STRING","ConfigurableProduct",46],["T_NS_SEPARATOR","\\",46],["T_STRING","Model",46],["T_NS_SEPARATOR","\\",46],["T_STRING","Product",46],["T_NS_SEPARATOR","\\",46],["T_STRING","VariationHandler",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$variationHandler",46],["T_WHITESPACE","\n    ",46],")",["T_WHITESPACE"," ",47],"{",["T_WHITESPACE","\n        ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","request",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$request",48],";",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","productRepository",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$productRepository",49],";",["T_WHITESPACE","\n        ",49],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","variationHandler",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_VARIABLE","$variationHandler",50],";",["T_WHITESPACE","\n    ",50],"}",["T_WHITESPACE","\n\n    ",51],["T_DOC_COMMENT","\/**\n     * Update data for configurable product configurations\n     *\n     * @param \\Magento\\Catalog\\Controller\\Adminhtml\\Product\\Initialization\\Helper $subject\n     * @param \\Magento\\Catalog\\Model\\Product $configurableProduct\n     *\n     * @return \\Magento\\Catalog\\Model\\Product\n     * @SuppressWarnings(PHPMD.UnusedFormalParameter)\n     *\/",53],["T_WHITESPACE","\n    ",61],["T_PUBLIC","public",62],["T_WHITESPACE"," ",62],["T_FUNCTION","function",62],["T_WHITESPACE"," ",62],["T_STRING","afterInitialize",62],"(",["T_WHITESPACE","\n        ",62],["T_NS_SEPARATOR","\\",63],["T_STRING","Magento",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Catalog",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Controller",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Adminhtml",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Product",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Initialization",63],["T_NS_SEPARATOR","\\",63],["T_STRING","Helper",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$subject",63],",",["T_WHITESPACE","\n        ",63],["T_NS_SEPARATOR","\\",64],["T_STRING","Magento",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Catalog",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Model",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Product",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$configurableProduct",64],["T_WHITESPACE","\n    ",64],")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$configurations",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getConfigurations",66],"(",")",";",["T_WHITESPACE","\n        ",66],["T_VARIABLE","$configurations",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","variationHandler",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","duplicateImagesForVariations",67],"(",["T_VARIABLE","$configurations",67],")",";",["T_WHITESPACE","\n        ",67],["T_IF","if",68],["T_WHITESPACE"," ",68],"(",["T_STRING","count",68],"(",["T_VARIABLE","$configurations",68],")",")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n            ",68],["T_FOREACH","foreach",69],["T_WHITESPACE"," ",69],"(",["T_VARIABLE","$configurations",69],["T_WHITESPACE"," ",69],["T_AS","as",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$productId",69],["T_WHITESPACE"," ",69],["T_DOUBLE_ARROW","=>",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$productData",69],")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n                ",69],["T_DOC_COMMENT","\/** @var \\Magento\\Catalog\\Model\\Product $product *\/",70],["T_WHITESPACE","\n                ",70],["T_VARIABLE","$product",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","productRepository",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getById",71],"(",["T_VARIABLE","$productId",71],",",["T_WHITESPACE"," ",71],["T_STRING","false",71],",",["T_WHITESPACE"," ",71],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","request",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getParam",71],"(",["T_CONSTANT_ENCAPSED_STRING","'store'",71],",",["T_WHITESPACE"," ",71],["T_LNUMBER","0",71],")",")",";",["T_WHITESPACE","\n                ",71],["T_VARIABLE","$productData",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","variationHandler",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","processMediaGallery",72],"(",["T_VARIABLE","$product",72],",",["T_WHITESPACE"," ",72],["T_VARIABLE","$productData",72],")",";",["T_WHITESPACE","\n                ",72],["T_VARIABLE","$product",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","addData",73],"(",["T_VARIABLE","$productData",73],")",";",["T_WHITESPACE","\n                ",73],["T_IF","if",74],["T_WHITESPACE"," ",74],"(",["T_VARIABLE","$product",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","hasDataChanges",74],"(",")",")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n                    ",74],["T_VARIABLE","$product",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","save",75],"(",")",";",["T_WHITESPACE","\n                ",75],"}",["T_WHITESPACE","\n            ",76],"}",["T_WHITESPACE","\n        ",77],"}",["T_WHITESPACE","\n        ",78],["T_RETURN","return",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$configurableProduct",79],";",["T_WHITESPACE","\n    ",79],"}",["T_WHITESPACE","\n\n    ",80],["T_DOC_COMMENT","\/**\n     * Get configurations from request\n     *\n     * @return array\n     *\/",82],["T_WHITESPACE","\n    ",86],["T_PROTECTED","protected",87],["T_WHITESPACE"," ",87],["T_FUNCTION","function",87],["T_WHITESPACE"," ",87],["T_STRING","getConfigurations",87],"(",")",["T_WHITESPACE","\n    ",87],"{",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$result",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],"[","]",";",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$configurableMatrix",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","request",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","getParam",90],"(",["T_CONSTANT_ENCAPSED_STRING","'configurable-matrix-serialized'",90],",",["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'[]'",90],")",";",["T_WHITESPACE","\n        ",90],["T_IF","if",91],["T_WHITESPACE"," ",91],"(",["T_VARIABLE","$configurableMatrix",91],["T_WHITESPACE"," ",91],["T_IS_NOT_EQUAL","!=",91],["T_WHITESPACE"," ",91],["T_STRING","null",91],["T_WHITESPACE"," ",91],["T_BOOLEAN_AND","&&",91],["T_WHITESPACE"," ",91],"!",["T_EMPTY","empty",91],"(",["T_VARIABLE","$configurableMatrix",91],")",")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n            ",91],["T_VARIABLE","$configurableMatrix",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_STRING","json_decode",92],"(",["T_VARIABLE","$configurableMatrix",92],",",["T_WHITESPACE"," ",92],["T_STRING","true",92],")",";",["T_WHITESPACE","\n        ",92],"}",["T_WHITESPACE","\n\n        ",93],["T_FOREACH","foreach",95],["T_WHITESPACE"," ",95],"(",["T_VARIABLE","$configurableMatrix",95],["T_WHITESPACE"," ",95],["T_AS","as",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$item",95],")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n            ",95],["T_IF","if",96],["T_WHITESPACE"," ",96],"(",["T_EMPTY","empty",96],"(",["T_VARIABLE","$item",96],"[",["T_CONSTANT_ENCAPSED_STRING","'was_changed'",96],"]",")",")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n                ",96],["T_CONTINUE","continue",97],";",["T_WHITESPACE","\n            ",97],"}",["T_WHITESPACE"," ",98],["T_ELSE","else",98],["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n                ",98],["T_UNSET","unset",99],"(",["T_VARIABLE","$item",99],"[",["T_CONSTANT_ENCAPSED_STRING","'was_changed'",99],"]",")",";",["T_WHITESPACE","\n            ",99],"}",["T_WHITESPACE","\n\n            ",100],["T_IF","if",102],["T_WHITESPACE"," ",102],"(","!",["T_VARIABLE","$item",102],"[",["T_CONSTANT_ENCAPSED_STRING","'newProduct'",102],"]",")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n                ",102],["T_VARIABLE","$result",103],"[",["T_VARIABLE","$item",103],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",103],"]","]",["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","mapData",103],"(",["T_VARIABLE","$item",103],")",";",["T_WHITESPACE","\n\n                ",103],["T_IF","if",105],["T_WHITESPACE"," ",105],"(",["T_ISSET","isset",105],"(",["T_VARIABLE","$item",105],"[",["T_CONSTANT_ENCAPSED_STRING","'qty'",105],"]",")",")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n                    ",105],["T_VARIABLE","$result",106],"[",["T_VARIABLE","$item",106],"[",["T_CONSTANT_ENCAPSED_STRING","'id'",106],"]","]","[",["T_CONSTANT_ENCAPSED_STRING","'quantity_and_stock_status'",106],"]","[",["T_CONSTANT_ENCAPSED_STRING","'qty'",106],"]",["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_VARIABLE","$item",106],"[",["T_CONSTANT_ENCAPSED_STRING","'qty'",106],"]",";",["T_WHITESPACE","\n                ",106],"}",["T_WHITESPACE","\n            ",107],"}",["T_WHITESPACE","\n        ",108],"}",["T_WHITESPACE","\n\n        ",109],["T_RETURN","return",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$result",111],";",["T_WHITESPACE","\n    ",111],"}",["T_WHITESPACE","\n\n    ",112],["T_DOC_COMMENT","\/**\n     * Map data from POST\n     *\n     * @param array $item\n     * @return array\n     *\/",114],["T_WHITESPACE","\n    ",119],["T_PRIVATE","private",120],["T_WHITESPACE"," ",120],["T_FUNCTION","function",120],["T_WHITESPACE"," ",120],["T_STRING","mapData",120],"(",["T_ARRAY","array",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$item",120],")",["T_WHITESPACE","\n    ",120],"{",["T_WHITESPACE","\n        ",121],["T_VARIABLE","$result",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],"[","]",";",["T_WHITESPACE","\n\n        ",122],["T_FOREACH","foreach",124],["T_WHITESPACE"," ",124],"(",["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","keysPost",124],["T_WHITESPACE"," ",124],["T_AS","as",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$key",124],")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n            ",124],["T_IF","if",125],["T_WHITESPACE"," ",125],"(",["T_ISSET","isset",125],"(",["T_VARIABLE","$item",125],"[",["T_VARIABLE","$key",125],"]",")",")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n                ",125],["T_VARIABLE","$result",126],"[",["T_VARIABLE","$key",126],"]",["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$item",126],"[",["T_VARIABLE","$key",126],"]",";",["T_WHITESPACE","\n            ",126],"}",["T_WHITESPACE","\n        ",127],"}",["T_WHITESPACE","\n\n        ",128],["T_RETURN","return",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$result",130],";",["T_WHITESPACE","\n    ",130],"}",["T_WHITESPACE","\n",131],"}",["T_WHITESPACE","\n",132]]