[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_COMMENT","\/\/ @codingStandardsIgnoreFile\n",7],["T_WHITESPACE","\n",8],["T_COMMENT","\/* @var $block \\Magento\\ConfigurableProduct\\Block\\Product\\Configurable\\AttributeSelector *\/",9],["T_WHITESPACE","\n",9],["T_CLOSE_TAG","?>\n",10],["T_INLINE_HTML","<script>\n(function(){\n    'use strict';\n    \n    var $form;\n\n    require([\n        'jquery',\n        'jquery\/ui',\n        'Magento_Ui\/js\/modal\/modal'\n    ], function($){\n        $form = $('[data-role=affected-attribute-set-selector]');\n        var resetValidation = function() {\n                $form.find('.messages .message.error').hide();\n                $form.find('form').validation().data('validator').resetForm();\n            },\n            setAttributeSetId = function (id) {\n                $('[data-role=new-variations-attribute-set-id]').val(id);\n            },\n            closeDialogAndProcessForm = function (form) {\n                form.modal('closeModal').data('target').click();\n            },\n            newAttributeSetContainer = $('[data-role=affected-attribute-set-new-name-container]'),\n            existingAttributeSetContainer = $('[data-role=affected-attribute-set-existing-name-container]');\n\n        $form.find('input[type=text]').on('keypress',function(e){\n            if(e.keyCode === 13){\n                e.preventDefault();\n                $form.closest('[data-role=modal]').find('button[data-action=confirm]').click();\n            }\n        });\n\n        $('[data-form=edit-product]').append($('<input>', {\n            type: 'hidden',\n            name: 'new-variations-attribute-set-id',\n            'data-role': 'new-variations-attribute-set-id'\n        }));\n\n        $form\n            .modal({\n                title: '",11],["T_OPEN_TAG","<?php ",51],["T_COMMENT","\/* @escapeNotVerified *\/",51],["T_WHITESPACE"," ",51],["T_ECHO","echo",51],["T_WHITESPACE"," ",51],["T_STRING","__",51],"(",["T_CONSTANT_ENCAPSED_STRING","'Choose Affected Attribute Set'",51],")",";",["T_WHITESPACE"," ",51],["T_CLOSE_TAG","?>",51],["T_INLINE_HTML","',\n                closed: function () {\n                    resetValidation();\n                },\n                buttons: [{\n                    text: '",51],["T_OPEN_TAG","<?php ",56],["T_COMMENT","\/* @escapeNotVerified *\/",56],["T_WHITESPACE"," ",56],["T_ECHO","echo",56],["T_WHITESPACE"," ",56],["T_STRING","__",56],"(",["T_CONSTANT_ENCAPSED_STRING","'Confirm'",56],")",";",["T_WHITESPACE"," ",56],["T_CLOSE_TAG","?>",56],["T_INLINE_HTML","',\n                    attr: {\n                        'data-action': 'confirm'\n                    },\n                    'class': 'action-primary',\n                    click: function() {\n                        var affectedAttributeSetId = $form.find('input[name=affected-attribute-set]:checked').val();\n                        if (affectedAttributeSetId == 'current') {\n                            setAttributeSetId($('#attribute_set_id').val());\n                            closeDialogAndProcessForm($form);\n                            return;\n                        } else if (affectedAttributeSetId == 'existing') {\n                            setAttributeSetId($('select', existingAttributeSetContainer).val());\n                            closeDialogAndProcessForm($form);\n                        }\n\n                        $form.find('.messages .message.error').hide();\n                        if (!$form.find('form').validation().valid()) {\n                            $form.find('input[name=new-attribute-set-name]').focus();\n                            return false;\n                        }\n\n                        $.ajax({\n                            type: 'POST',\n                            url: '",56],["T_OPEN_TAG","<?php ",80],["T_COMMENT","\/* @escapeNotVerified *\/",80],["T_WHITESPACE"," ",80],["T_ECHO","echo",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$block",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getAttributeSetCreationUrl",80],"(",")",["T_CLOSE_TAG","?>",80],["T_INLINE_HTML","',\n                            data: {\n                                gotoEdit: 1,\n                                attribute_set_name: $form.find('input[name=new-attribute-set-name]').val(),\n                                skeleton_set: $('#attribute_set_id').val(),\n                                form_key: '",80],["T_OPEN_TAG","<?php ",85],["T_COMMENT","\/* @escapeNotVerified *\/",85],["T_WHITESPACE"," ",85],["T_ECHO","echo",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$block",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","getFormKey",85],"(",")",["T_CLOSE_TAG","?>",85],["T_INLINE_HTML","',\n                                return_session_messages_only: 1\n                            },\n                            dataType: 'json',\n                            showLoader: true,\n                            context: $form\n                        })\n                            .success(function (data) {\n                                if (!data.error) {\n                                    setAttributeSetId(data.id);\n                                    closeDialogAndProcessForm($form);\n                                } else {\n                                    $form.find('.messages .message.error').replaceWith($(data.messages).find('.message.error'));\n                                }\n                            });\n\n                        return false;\n                    }\n                },{\n                    text: '",85],["T_OPEN_TAG","<?php ",104],["T_COMMENT","\/* @escapeNotVerified *\/",104],["T_WHITESPACE"," ",104],["T_ECHO","echo",104],["T_WHITESPACE"," ",104],["T_STRING","__",104],"(",["T_CONSTANT_ENCAPSED_STRING","'Cancel'",104],")",";",["T_WHITESPACE"," ",104],["T_CLOSE_TAG","?>",104],["T_INLINE_HTML","',\n                    id: '",104],["T_OPEN_TAG","<?php ",105],["T_COMMENT","\/* @escapeNotVerified *\/",105],["T_WHITESPACE"," ",105],["T_ECHO","echo",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$block",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","getJsId",105],"(",["T_CONSTANT_ENCAPSED_STRING","'close-button'",105],")",["T_WHITESPACE"," ",105],["T_CLOSE_TAG","?>",105],["T_INLINE_HTML","',\n                    'class': 'action-close',\n                    click: function() {\n                        $form.modal('closeModal');\n                    }\n                }]\n            })\n            .find('input[name=affected-attribute-set]').on('change', function() {\n                var affectedAttributeSet = $(this).val();\n                newAttributeSetContainer[affectedAttributeSet == 'new' ? 'show' : 'hide']();\n                existingAttributeSetContainer[affectedAttributeSet == 'existing' ? 'show' : 'hide']();\n                resetValidation();\n                if (affectedAttributeSet == 'new') {\n                    newAttributeSetContainer.find('input[name=new-attribute-set-name]').focus();\n                }\n            });\n    });\n    \n    require([\n        'jquery'\n    ], function ($) {\n\n        \/**\n         * Retrieve list of attributes\n         *\n         * @return {Array}\n         *\/\n        var getAttributes = function ($node) {\n            return $.map(\n                $node.find('[data-role=configurable-attributes-container] [data-role=attribute-info]') || [],\n                function (attribute) {\n                    var $attribute = $(attribute);\n\n                    return {\n                        id: $attribute.find('[name$=\"[attribute_id]\"]').val(),\n                        code: $attribute.find('[name$=\"[code]\"]').val(),\n                        label: $attribute.find('[name$=\"[label]\"]').val(),\n                        position: $attribute.find('[name$=\"[position]\"]').val()\n                    };\n                }\n            );\n        };\n\n        \/**\n         * This fix was made in order to properly handle 'stopImmediatePropagation'.\n         *\/\n        $('#save-split-button .item').on('click', function(event) {\n            if ($('[data-role=new-variations-attribute-set-id]').val() != '') {\n                return; \/\/ affected attribute set was already chosen\n            }\n\n            var extendingAttributes = [];\n\n            $.each(getAttributes($('[data-role=product-variations-matrix]')), function () {\n                if (!$('#attribute-' + this.code + '-container').length) {\n                    extendingAttributes.push(this.id);\n                }\n            });\n            if (!extendingAttributes.length) {\n                $('[data-role=new-variations-attribute-set-id]').val($('#attribute_set_id').val());\n                return; \/\/ all selected configurable attributes belong to current attribute set\n            }\n            if (!$('[data-role=product-variations-matrix] [data-column=entity_id]')\n                .closest('tr').has('input[name$=\"[name]\"]').length\n            ) {\n                return; \/\/ no new simple products to save from matrix: uniting attribute set is not needed\n            }\n\n            event.stopImmediatePropagation();\n\n            $form.data('target', event.target).modal('openModal');\n        });\n\n    });\n\n})();\n<\/script>\n",105]]