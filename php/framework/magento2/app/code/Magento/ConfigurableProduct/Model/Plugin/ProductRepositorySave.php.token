[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","ConfigurableProduct",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Plugin",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Catalog",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Model",8],["T_NS_SEPARATOR","\\",8],["T_STRING","ProductFactory",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Catalog",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Api",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Data",9],["T_NS_SEPARATOR","\\",9],["T_STRING","ProductInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Exception",10],["T_NS_SEPARATOR","\\",10],["T_STRING","InputException",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Catalog",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Api",11],["T_NS_SEPARATOR","\\",11],["T_STRING","ProductRepositoryInterface",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Framework",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Exception",12],["T_NS_SEPARATOR","\\",12],["T_STRING","CouldNotSaveException",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","ConfigurableProduct",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Api",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Data",13],["T_NS_SEPARATOR","\\",13],["T_STRING","OptionInterface",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Catalog",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Api",14],["T_NS_SEPARATOR","\\",14],["T_STRING","ProductAttributeRepositoryInterface",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Magento",15],["T_NS_SEPARATOR","\\",15],["T_STRING","ConfigurableProduct",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Model",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Product",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Type",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Configurable",15],";",["T_WHITESPACE","\n\n",15],["T_CLASS","class",17],["T_WHITESPACE"," ",17],["T_STRING","ProductRepositorySave",17],["T_WHITESPACE","\n",17],"{",["T_WHITESPACE","\n    ",18],["T_DOC_COMMENT","\/**\n     * @var ProductAttributeRepositoryInterface\n     *\/",19],["T_WHITESPACE","\n    ",21],["T_PRIVATE","private",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$productAttributeRepository",22],";",["T_WHITESPACE","\n\n    ",22],["T_DOC_COMMENT","\/**\n     * @var ProductFactory\n     *\/",24],["T_WHITESPACE","\n    ",26],["T_PRIVATE","private",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$productFactory",27],";",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * @param ProductAttributeRepositoryInterface $productAttributeRepository\n     * @param ProductFactory $productFactory\n     *\/",29],["T_WHITESPACE","\n    ",32],["T_PUBLIC","public",33],["T_WHITESPACE"," ",33],["T_FUNCTION","function",33],["T_WHITESPACE"," ",33],["T_STRING","__construct",33],"(",["T_WHITESPACE","\n        ",33],["T_STRING","ProductAttributeRepositoryInterface",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$productAttributeRepository",34],",",["T_WHITESPACE","\n        ",34],["T_STRING","ProductFactory",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$productFactory",35],["T_WHITESPACE","\n    ",35],")",["T_WHITESPACE"," ",36],"{",["T_WHITESPACE","\n        ",36],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","productAttributeRepository",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_VARIABLE","$productAttributeRepository",37],";",["T_WHITESPACE","\n        ",37],["T_VARIABLE","$this",38],["T_OBJECT_OPERATOR","->",38],["T_STRING","productFactory",38],["T_WHITESPACE"," ",38],"=",["T_WHITESPACE"," ",38],["T_VARIABLE","$productFactory",38],";",["T_WHITESPACE","\n    ",38],"}",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * Validate product links and reset configurable attributes to configurable product\n     *\n     * @param ProductRepositoryInterface $subject\n     * @param ProductInterface $result\n     * @param ProductInterface $product\n     * @param bool $saveOptions\n     * @return ProductInterface\n     * @throws CouldNotSaveException\n     * @throws InputException\n     *\n     * @SuppressWarnings(PHPMD.UnusedFormalParameter)\n     *\/",41],["T_WHITESPACE","\n    ",53],["T_PUBLIC","public",54],["T_WHITESPACE"," ",54],["T_FUNCTION","function",54],["T_WHITESPACE"," ",54],["T_STRING","afterSave",54],"(",["T_WHITESPACE","\n        ",54],["T_STRING","ProductRepositoryInterface",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$subject",55],",",["T_WHITESPACE","\n        ",55],["T_STRING","ProductInterface",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$result",56],",",["T_WHITESPACE","\n        ",56],["T_STRING","ProductInterface",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$product",57],",",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$saveOptions",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_STRING","false",58],["T_WHITESPACE","\n    ",58],")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n        ",59],["T_IF","if",60],["T_WHITESPACE"," ",60],"(",["T_VARIABLE","$product",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","getTypeId",60],"(",")",["T_WHITESPACE"," ",60],["T_IS_NOT_IDENTICAL","!==",60],["T_WHITESPACE"," ",60],["T_STRING","Configurable",60],["T_DOUBLE_COLON","::",60],["T_STRING","TYPE_CODE",60],")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n            ",60],["T_RETURN","return",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$result",61],";",["T_WHITESPACE","\n        ",61],"}",["T_WHITESPACE","\n\n        ",62],["T_VARIABLE","$extensionAttributes",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$result",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","getExtensionAttributes",64],"(",")",";",["T_WHITESPACE","\n        ",64],["T_IF","if",65],["T_WHITESPACE"," ",65],"(",["T_VARIABLE","$extensionAttributes",65],["T_WHITESPACE"," ",65],["T_IS_IDENTICAL","===",65],["T_WHITESPACE"," ",65],["T_STRING","null",65],")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n            ",65],["T_RETURN","return",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$result",66],";",["T_WHITESPACE","\n        ",66],"}",["T_WHITESPACE","\n\n        ",67],["T_VARIABLE","$configurableLinks",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_ARRAY_CAST","(array)",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$extensionAttributes",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getConfigurableProductLinks",69],"(",")",";",["T_WHITESPACE","\n        ",69],["T_VARIABLE","$configurableOptions",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_ARRAY_CAST","(array)",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$extensionAttributes",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getConfigurableProductOptions",70],"(",")",";",["T_WHITESPACE","\n\n        ",70],["T_IF","if",72],["T_WHITESPACE"," ",72],"(",["T_EMPTY","empty",72],"(",["T_VARIABLE","$configurableLinks",72],")",["T_WHITESPACE"," ",72],["T_BOOLEAN_AND","&&",72],["T_WHITESPACE"," ",72],["T_EMPTY","empty",72],"(",["T_VARIABLE","$configurableOptions",72],")",")",["T_WHITESPACE"," ",72],"{",["T_WHITESPACE","\n            ",72],["T_RETURN","return",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$result",73],";",["T_WHITESPACE","\n        ",73],"}",["T_WHITESPACE","\n\n        ",74],["T_VARIABLE","$attributeCodes",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],"[","]",";",["T_WHITESPACE","\n        ",76],["T_DOC_COMMENT","\/** @var OptionInterface $configurableOption *\/",77],["T_WHITESPACE","\n        ",77],["T_FOREACH","foreach",78],["T_WHITESPACE"," ",78],"(",["T_VARIABLE","$configurableOptions",78],["T_WHITESPACE"," ",78],["T_AS","as",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$configurableOption",78],")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n            ",78],["T_VARIABLE","$eavAttribute",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","productAttributeRepository",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","get",79],"(",["T_VARIABLE","$configurableOption",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","getAttributeId",79],"(",")",")",";",["T_WHITESPACE","\n            ",79],["T_VARIABLE","$attributeCode",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$eavAttribute",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getAttributeCode",80],"(",")",";",["T_WHITESPACE","\n            ",80],["T_VARIABLE","$attributeCodes",81],"[","]",["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$attributeCode",81],";",["T_WHITESPACE","\n        ",81],"}",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","validateProductLinks",83],"(",["T_VARIABLE","$attributeCodes",83],",",["T_WHITESPACE"," ",83],["T_VARIABLE","$configurableLinks",83],")",";",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$product",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getTypeInstance",84],"(",")",["T_OBJECT_OPERATOR","->",84],["T_STRING","resetConfigurableAttributes",84],"(",["T_VARIABLE","$product",84],")",";",["T_WHITESPACE","\n\n        ",84],["T_RETURN","return",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$product",86],";",["T_WHITESPACE","\n    ",86],"}",["T_WHITESPACE","\n\n    ",87],["T_DOC_COMMENT","\/**\n     * @param array $attributeCodes\n     * @param array $linkIds\n     * @return $this\n     * @throws InputException\n     *\/",89],["T_WHITESPACE","\n    ",94],["T_PRIVATE","private",95],["T_WHITESPACE"," ",95],["T_FUNCTION","function",95],["T_WHITESPACE"," ",95],["T_STRING","validateProductLinks",95],"(",["T_ARRAY","array",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$attributeCodes",95],",",["T_WHITESPACE"," ",95],["T_ARRAY","array",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$linkIds",95],")",["T_WHITESPACE","\n    ",95],"{",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$valueMap",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],"[","]",";",["T_WHITESPACE","\n\n        ",97],["T_FOREACH","foreach",99],["T_WHITESPACE"," ",99],"(",["T_VARIABLE","$linkIds",99],["T_WHITESPACE"," ",99],["T_AS","as",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$productId",99],")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n            ",99],["T_VARIABLE","$variation",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","productFactory",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","create",100],"(",")",["T_OBJECT_OPERATOR","->",100],["T_STRING","load",100],"(",["T_VARIABLE","$productId",100],")",";",["T_WHITESPACE","\n            ",100],["T_VARIABLE","$valueKey",101],["T_WHITESPACE"," ",101],"=",["T_WHITESPACE"," ",101],["T_CONSTANT_ENCAPSED_STRING","''",101],";",["T_WHITESPACE","\n            ",101],["T_FOREACH","foreach",102],["T_WHITESPACE"," ",102],"(",["T_VARIABLE","$attributeCodes",102],["T_WHITESPACE"," ",102],["T_AS","as",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$attributeCode",102],")",["T_WHITESPACE"," ",102],"{",["T_WHITESPACE","\n                ",102],["T_IF","if",103],["T_WHITESPACE"," ",103],"(","!",["T_VARIABLE","$variation",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getData",103],"(",["T_VARIABLE","$attributeCode",103],")",")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n                    ",103],["T_THROW","throw",104],["T_WHITESPACE"," ",104],["T_NEW","new",104],["T_WHITESPACE"," ",104],["T_STRING","InputException",104],"(",["T_WHITESPACE","\n                        ",104],["T_STRING","__",105],"(",["T_CONSTANT_ENCAPSED_STRING","'Product with id \"%1\" does not contain required attribute \"%2\".'",105],",",["T_WHITESPACE"," ",105],["T_VARIABLE","$productId",105],",",["T_WHITESPACE"," ",105],["T_VARIABLE","$attributeCode",105],")",["T_WHITESPACE","\n                    ",105],")",";",["T_WHITESPACE","\n                ",106],"}",["T_WHITESPACE","\n                ",107],["T_VARIABLE","$valueKey",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$valueKey",108],["T_WHITESPACE"," ",108],".",["T_WHITESPACE"," ",108],["T_VARIABLE","$attributeCode",108],["T_WHITESPACE"," ",108],".",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","':'",108],["T_WHITESPACE"," ",108],".",["T_WHITESPACE"," ",108],["T_VARIABLE","$variation",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getData",108],"(",["T_VARIABLE","$attributeCode",108],")",["T_WHITESPACE"," ",108],".",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","';'",108],";",["T_WHITESPACE","\n            ",108],"}",["T_WHITESPACE","\n            ",109],["T_IF","if",110],["T_WHITESPACE"," ",110],"(",["T_ISSET","isset",110],"(",["T_VARIABLE","$valueMap",110],"[",["T_VARIABLE","$valueKey",110],"]",")",")",["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n                ",110],["T_THROW","throw",111],["T_WHITESPACE"," ",111],["T_NEW","new",111],["T_WHITESPACE"," ",111],["T_STRING","InputException",111],"(",["T_WHITESPACE","\n                    ",111],["T_STRING","__",112],"(",["T_WHITESPACE","\n                        ",112],["T_CONSTANT_ENCAPSED_STRING","'Products \"%1\" and \"%2\" have the same set of attribute values.'",113],",",["T_WHITESPACE","\n                        ",113],["T_VARIABLE","$productId",114],",",["T_WHITESPACE","\n                        ",114],["T_VARIABLE","$valueMap",115],"[",["T_VARIABLE","$valueKey",115],"]",["T_WHITESPACE","\n                    ",115],")",["T_WHITESPACE","\n                ",116],")",";",["T_WHITESPACE","\n            ",117],"}",["T_WHITESPACE","\n            ",118],["T_VARIABLE","$valueMap",119],"[",["T_VARIABLE","$valueKey",119],"]",["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_VARIABLE","$productId",119],";",["T_WHITESPACE","\n        ",119],"}",["T_WHITESPACE","\n    ",120],"}",["T_WHITESPACE","\n",121],"}",["T_WHITESPACE","\n",122]]