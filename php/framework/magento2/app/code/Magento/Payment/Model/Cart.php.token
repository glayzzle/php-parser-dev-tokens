[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Payment",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Provide methods for collecting cart items information of specific sales model entity\n *\/",8],["T_WHITESPACE","\n",10],["T_CLASS","class",11],["T_WHITESPACE"," ",11],["T_STRING","Cart",11],["T_WHITESPACE","\n",11],"{",["T_WHITESPACE","\n    ",12],["T_COMMENT","\/**#@+\n     * Amounts\n     *\/",13],["T_WHITESPACE","\n    ",15],["T_CONST","const",16],["T_WHITESPACE"," ",16],["T_STRING","AMOUNT_TAX",16],["T_WHITESPACE"," ",16],"=",["T_WHITESPACE"," ",16],["T_CONSTANT_ENCAPSED_STRING","'tax'",16],";",["T_WHITESPACE","\n\n    ",16],["T_CONST","const",18],["T_WHITESPACE"," ",18],["T_STRING","AMOUNT_SHIPPING",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],["T_CONSTANT_ENCAPSED_STRING","'shipping'",18],";",["T_WHITESPACE","\n\n    ",18],["T_CONST","const",20],["T_WHITESPACE"," ",20],["T_STRING","AMOUNT_DISCOUNT",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_CONSTANT_ENCAPSED_STRING","'discount'",20],";",["T_WHITESPACE","\n\n    ",20],["T_CONST","const",22],["T_WHITESPACE"," ",22],["T_STRING","AMOUNT_SUBTOTAL",22],["T_WHITESPACE"," ",22],"=",["T_WHITESPACE"," ",22],["T_CONSTANT_ENCAPSED_STRING","'subtotal'",22],";",["T_WHITESPACE","\n\n    ",22],["T_COMMENT","\/**@@+*\/",24],["T_WHITESPACE","\n\n    ",24],["T_DOC_COMMENT","\/**\n     * Sales model\n     *\n     * @var \\Magento\\Payment\\Model\\Cart\\SalesModel\\SalesModelInterface\n     *\/",26],["T_WHITESPACE","\n    ",30],["T_PROTECTED","protected",31],["T_WHITESPACE"," ",31],["T_VARIABLE","$_salesModel",31],";",["T_WHITESPACE","\n\n    ",31],["T_DOC_COMMENT","\/**\n     * Core event manager proxy\n     *\n     * @var \\Magento\\Framework\\Event\\ManagerInterface\n     *\/",33],["T_WHITESPACE","\n    ",37],["T_PROTECTED","protected",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$_eventManager",38],";",["T_WHITESPACE","\n\n    ",38],["T_DOC_COMMENT","\/**\n     * Amounts\n     *\n     * @var array\n     *\/",40],["T_WHITESPACE","\n    ",44],["T_PROTECTED","protected",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$_amounts",45],";",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * Custom items list\n     *\n     * @var array\n     *\/",47],["T_WHITESPACE","\n    ",51],["T_PROTECTED","protected",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$_customItems",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],"[","]",";",["T_WHITESPACE","\n\n    ",52],["T_DOC_COMMENT","\/**\n     * Items imported from sales model\n     *\n     * @var array\n     *\/",54],["T_WHITESPACE","\n    ",58],["T_PROTECTED","protected",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$_salesModelItems",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],"[","]",";",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * Flags that indicates whether discount, shopping and taxes should be transferred as cart item\n     *\n     * @var array\n     *\/",61],["T_WHITESPACE","\n    ",65],["T_PROTECTED","protected",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$_transferFlags",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],"[","]",";",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * Flags which indicates whether items data is outdated and has to be recollected\n     *\n     * @var bool\n     *\/",68],["T_WHITESPACE","\n    ",72],["T_PROTECTED","protected",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$_itemsCollectingRequired",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_STRING","true",73],";",["T_WHITESPACE","\n\n    ",73],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Payment\\Model\\Cart\\SalesModel\\Factory $salesModelFactory\n     * @param \\Magento\\Framework\\Event\\ManagerInterface $eventManager\n     * @param \\Magento\\Quote\\Api\\Data\\CartInterface $salesModel\n     *\/",75],["T_WHITESPACE","\n    ",79],["T_PUBLIC","public",80],["T_WHITESPACE"," ",80],["T_FUNCTION","function",80],["T_WHITESPACE"," ",80],["T_STRING","__construct",80],"(",["T_WHITESPACE","\n        ",80],["T_NS_SEPARATOR","\\",81],["T_STRING","Magento",81],["T_NS_SEPARATOR","\\",81],["T_STRING","Payment",81],["T_NS_SEPARATOR","\\",81],["T_STRING","Model",81],["T_NS_SEPARATOR","\\",81],["T_STRING","Cart",81],["T_NS_SEPARATOR","\\",81],["T_STRING","SalesModel",81],["T_NS_SEPARATOR","\\",81],["T_STRING","Factory",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$salesModelFactory",81],",",["T_WHITESPACE","\n        ",81],["T_NS_SEPARATOR","\\",82],["T_STRING","Magento",82],["T_NS_SEPARATOR","\\",82],["T_STRING","Framework",82],["T_NS_SEPARATOR","\\",82],["T_STRING","Event",82],["T_NS_SEPARATOR","\\",82],["T_STRING","ManagerInterface",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$eventManager",82],",",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$salesModel",83],["T_WHITESPACE","\n    ",83],")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n        ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","_eventManager",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_VARIABLE","$eventManager",85],";",["T_WHITESPACE","\n        ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","_salesModel",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_VARIABLE","$salesModelFactory",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","create",86],"(",["T_VARIABLE","$salesModel",86],")",";",["T_WHITESPACE","\n        ",86],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","_resetAmounts",87],"(",")",";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n\n    ",88],["T_DOC_COMMENT","\/**\n     * Return payment cart sales model\n     *\n     * @return \\Magento\\Payment\\Model\\Cart\\SalesModel\\SalesModelInterface\n     * @api\n     *\/",90],["T_WHITESPACE","\n    ",95],["T_PUBLIC","public",96],["T_WHITESPACE"," ",96],["T_FUNCTION","function",96],["T_WHITESPACE"," ",96],["T_STRING","getSalesModel",96],"(",")",["T_WHITESPACE","\n    ",96],"{",["T_WHITESPACE","\n        ",97],["T_RETURN","return",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","_salesModel",98],";",["T_WHITESPACE","\n    ",98],"}",["T_WHITESPACE","\n\n    ",99],["T_DOC_COMMENT","\/**\n     * Add amount to existing tax amount\n     *\n     * @param float $taxAmount\n     * @return void\n     * @api\n     *\/",101],["T_WHITESPACE","\n    ",107],["T_PUBLIC","public",108],["T_WHITESPACE"," ",108],["T_FUNCTION","function",108],["T_WHITESPACE"," ",108],["T_STRING","addTax",108],"(",["T_VARIABLE","$taxAmount",108],")",["T_WHITESPACE","\n    ",108],"{",["T_WHITESPACE","\n        ",109],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","_addAmount",110],"(",["T_STRING","self",110],["T_DOUBLE_COLON","::",110],["T_STRING","AMOUNT_TAX",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$taxAmount",110],")",";",["T_WHITESPACE","\n    ",110],"}",["T_WHITESPACE","\n\n    ",111],["T_DOC_COMMENT","\/**\n     * Set tax. Old value will be overwritten\n     *\n     * @param float $taxAmount\n     * @return void\n     * @api\n     *\/",113],["T_WHITESPACE","\n    ",119],["T_PUBLIC","public",120],["T_WHITESPACE"," ",120],["T_FUNCTION","function",120],["T_WHITESPACE"," ",120],["T_STRING","setTax",120],"(",["T_VARIABLE","$taxAmount",120],")",["T_WHITESPACE","\n    ",120],"{",["T_WHITESPACE","\n        ",121],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","_setAmount",122],"(",["T_STRING","self",122],["T_DOUBLE_COLON","::",122],["T_STRING","AMOUNT_TAX",122],",",["T_WHITESPACE"," ",122],["T_VARIABLE","$taxAmount",122],")",";",["T_WHITESPACE","\n    ",122],"}",["T_WHITESPACE","\n\n    ",123],["T_DOC_COMMENT","\/**\n     * Get tax amount\n     *\n     * @return float\n     * @api\n     *\/",125],["T_WHITESPACE","\n    ",130],["T_PUBLIC","public",131],["T_WHITESPACE"," ",131],["T_FUNCTION","function",131],["T_WHITESPACE"," ",131],["T_STRING","getTax",131],"(",")",["T_WHITESPACE","\n    ",131],"{",["T_WHITESPACE","\n        ",132],["T_RETURN","return",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","_getAmount",133],"(",["T_STRING","self",133],["T_DOUBLE_COLON","::",133],["T_STRING","AMOUNT_TAX",133],")",";",["T_WHITESPACE","\n    ",133],"}",["T_WHITESPACE","\n\n    ",134],["T_DOC_COMMENT","\/**\n     * Add amount to existing discount amount\n     *\n     * @param float $discountAmount\n     * @return void\n     * @api\n     *\/",136],["T_WHITESPACE","\n    ",142],["T_PUBLIC","public",143],["T_WHITESPACE"," ",143],["T_FUNCTION","function",143],["T_WHITESPACE"," ",143],["T_STRING","addDiscount",143],"(",["T_VARIABLE","$discountAmount",143],")",["T_WHITESPACE","\n    ",143],"{",["T_WHITESPACE","\n        ",144],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","_addAmount",145],"(",["T_STRING","self",145],["T_DOUBLE_COLON","::",145],["T_STRING","AMOUNT_DISCOUNT",145],",",["T_WHITESPACE"," ",145],["T_VARIABLE","$discountAmount",145],")",";",["T_WHITESPACE","\n    ",145],"}",["T_WHITESPACE","\n\n    ",146],["T_DOC_COMMENT","\/**\n     * Set discount. Old value will be overwritten\n     *\n     * @param float $discountAmount\n     * @return void\n     * @api\n     *\/",148],["T_WHITESPACE","\n    ",154],["T_PUBLIC","public",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","setDiscount",155],"(",["T_VARIABLE","$discountAmount",155],")",["T_WHITESPACE","\n    ",155],"{",["T_WHITESPACE","\n        ",156],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","_setAmount",157],"(",["T_STRING","self",157],["T_DOUBLE_COLON","::",157],["T_STRING","AMOUNT_DISCOUNT",157],",",["T_WHITESPACE"," ",157],["T_VARIABLE","$discountAmount",157],")",";",["T_WHITESPACE","\n    ",157],"}",["T_WHITESPACE","\n\n    ",158],["T_DOC_COMMENT","\/**\n     * Get discount amount\n     *\n     * @return float\n     * @api\n     *\/",160],["T_WHITESPACE","\n    ",165],["T_PUBLIC","public",166],["T_WHITESPACE"," ",166],["T_FUNCTION","function",166],["T_WHITESPACE"," ",166],["T_STRING","getDiscount",166],"(",")",["T_WHITESPACE","\n    ",166],"{",["T_WHITESPACE","\n        ",167],["T_RETURN","return",168],["T_WHITESPACE"," ",168],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","_getAmount",168],"(",["T_STRING","self",168],["T_DOUBLE_COLON","::",168],["T_STRING","AMOUNT_DISCOUNT",168],")",";",["T_WHITESPACE","\n    ",168],"}",["T_WHITESPACE","\n\n    ",169],["T_DOC_COMMENT","\/**\n     * Add amount to existing shipping amount\n     *\n     * @param float $shippingAmount\n     * @return void\n     * @api\n     *\/",171],["T_WHITESPACE","\n    ",177],["T_PUBLIC","public",178],["T_WHITESPACE"," ",178],["T_FUNCTION","function",178],["T_WHITESPACE"," ",178],["T_STRING","addShipping",178],"(",["T_VARIABLE","$shippingAmount",178],")",["T_WHITESPACE","\n    ",178],"{",["T_WHITESPACE","\n        ",179],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","_addAmount",180],"(",["T_STRING","self",180],["T_DOUBLE_COLON","::",180],["T_STRING","AMOUNT_SHIPPING",180],",",["T_WHITESPACE"," ",180],["T_VARIABLE","$shippingAmount",180],")",";",["T_WHITESPACE","\n    ",180],"}",["T_WHITESPACE","\n\n    ",181],["T_DOC_COMMENT","\/**\n     * Set shipping. Old value will be overwritten\n     *\n     * @param float $shippingAmount\n     * @return void\n     * @api\n     *\/",183],["T_WHITESPACE","\n    ",189],["T_PUBLIC","public",190],["T_WHITESPACE"," ",190],["T_FUNCTION","function",190],["T_WHITESPACE"," ",190],["T_STRING","setShipping",190],"(",["T_VARIABLE","$shippingAmount",190],")",["T_WHITESPACE","\n    ",190],"{",["T_WHITESPACE","\n        ",191],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","_setAmount",192],"(",["T_STRING","self",192],["T_DOUBLE_COLON","::",192],["T_STRING","AMOUNT_SHIPPING",192],",",["T_WHITESPACE"," ",192],["T_VARIABLE","$shippingAmount",192],")",";",["T_WHITESPACE","\n    ",192],"}",["T_WHITESPACE","\n\n    ",193],["T_DOC_COMMENT","\/**\n     * Get shipping amount\n     *\n     * @return float\n     * @api\n     *\/",195],["T_WHITESPACE","\n    ",200],["T_PUBLIC","public",201],["T_WHITESPACE"," ",201],["T_FUNCTION","function",201],["T_WHITESPACE"," ",201],["T_STRING","getShipping",201],"(",")",["T_WHITESPACE","\n    ",201],"{",["T_WHITESPACE","\n        ",202],["T_RETURN","return",203],["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","_getAmount",203],"(",["T_STRING","self",203],["T_DOUBLE_COLON","::",203],["T_STRING","AMOUNT_SHIPPING",203],")",";",["T_WHITESPACE","\n    ",203],"}",["T_WHITESPACE","\n\n    ",204],["T_DOC_COMMENT","\/**\n     * Add amount to existing subtotal amount\n     *\n     * @param float $subtotalAmount\n     * @return void\n     * @api\n     *\/",206],["T_WHITESPACE","\n    ",212],["T_PUBLIC","public",213],["T_WHITESPACE"," ",213],["T_FUNCTION","function",213],["T_WHITESPACE"," ",213],["T_STRING","addSubtotal",213],"(",["T_VARIABLE","$subtotalAmount",213],")",["T_WHITESPACE","\n    ",213],"{",["T_WHITESPACE","\n        ",214],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","_addAmount",215],"(",["T_STRING","self",215],["T_DOUBLE_COLON","::",215],["T_STRING","AMOUNT_SUBTOTAL",215],",",["T_WHITESPACE"," ",215],["T_VARIABLE","$subtotalAmount",215],")",";",["T_WHITESPACE","\n    ",215],"}",["T_WHITESPACE","\n\n    ",216],["T_DOC_COMMENT","\/**\n     * Get subtotal amount\n     *\n     * @return float\n     * @api\n     *\/",218],["T_WHITESPACE","\n    ",223],["T_PUBLIC","public",224],["T_WHITESPACE"," ",224],["T_FUNCTION","function",224],["T_WHITESPACE"," ",224],["T_STRING","getSubtotal",224],"(",")",["T_WHITESPACE","\n    ",224],"{",["T_WHITESPACE","\n        ",225],["T_RETURN","return",226],["T_WHITESPACE"," ",226],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","_getAmount",226],"(",["T_STRING","self",226],["T_DOUBLE_COLON","::",226],["T_STRING","AMOUNT_SUBTOTAL",226],")",";",["T_WHITESPACE","\n    ",226],"}",["T_WHITESPACE","\n\n    ",227],["T_DOC_COMMENT","\/**\n     * Add custom item (such as discount as line item, shipping as line item, etc)\n     *\n     * @param string $name\n     * @param int $qty\n     * @param float $amount\n     * @param string|null $identifier\n     * @return void\n     * @api\n     *\/",229],["T_WHITESPACE","\n    ",238],["T_PUBLIC","public",239],["T_WHITESPACE"," ",239],["T_FUNCTION","function",239],["T_WHITESPACE"," ",239],["T_STRING","addCustomItem",239],"(",["T_VARIABLE","$name",239],",",["T_WHITESPACE"," ",239],["T_VARIABLE","$qty",239],",",["T_WHITESPACE"," ",239],["T_VARIABLE","$amount",239],",",["T_WHITESPACE"," ",239],["T_VARIABLE","$identifier",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_STRING","null",239],")",["T_WHITESPACE","\n    ",239],"{",["T_WHITESPACE","\n        ",240],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","_customItems",241],"[","]",["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","_createItemFromData",241],"(",["T_VARIABLE","$name",241],",",["T_WHITESPACE"," ",241],["T_VARIABLE","$qty",241],",",["T_WHITESPACE"," ",241],["T_VARIABLE","$amount",241],",",["T_WHITESPACE"," ",241],["T_VARIABLE","$identifier",241],")",";",["T_WHITESPACE","\n    ",241],"}",["T_WHITESPACE","\n\n    ",242],["T_DOC_COMMENT","\/**\n     * Get all cart items\n     *\n     * @return array\n     * @api\n     *\/",244],["T_WHITESPACE","\n    ",249],["T_PUBLIC","public",250],["T_WHITESPACE"," ",250],["T_FUNCTION","function",250],["T_WHITESPACE"," ",250],["T_STRING","getAllItems",250],"(",")",["T_WHITESPACE","\n    ",250],"{",["T_WHITESPACE","\n        ",251],["T_VARIABLE","$this",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","_collectItemsAndAmounts",252],"(",")",";",["T_WHITESPACE","\n        ",252],["T_RETURN","return",253],["T_WHITESPACE"," ",253],["T_STRING","array_merge",253],"(",["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","_salesModelItems",253],",",["T_WHITESPACE"," ",253],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","_customItems",253],")",";",["T_WHITESPACE","\n    ",253],"}",["T_WHITESPACE","\n\n    ",254],["T_DOC_COMMENT","\/**\n     * Get shipping, tax, subtotal and discount amounts all together\n     *\n     * @return array\n     * @api\n     *\/",256],["T_WHITESPACE","\n    ",261],["T_PUBLIC","public",262],["T_WHITESPACE"," ",262],["T_FUNCTION","function",262],["T_WHITESPACE"," ",262],["T_STRING","getAmounts",262],"(",")",["T_WHITESPACE","\n    ",262],"{",["T_WHITESPACE","\n        ",263],["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","_collectItemsAndAmounts",264],"(",")",";",["T_WHITESPACE","\n\n        ",264],["T_RETURN","return",266],["T_WHITESPACE"," ",266],["T_VARIABLE","$this",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","_amounts",266],";",["T_WHITESPACE","\n    ",266],"}",["T_WHITESPACE","\n\n    ",267],["T_DOC_COMMENT","\/**\n     * Specify that shipping should be transferred as cart item\n     *\n     * @return void\n     * @api\n     *\/",269],["T_WHITESPACE","\n    ",274],["T_PUBLIC","public",275],["T_WHITESPACE"," ",275],["T_FUNCTION","function",275],["T_WHITESPACE"," ",275],["T_STRING","setTransferShippingAsItem",275],"(",")",["T_WHITESPACE","\n    ",275],"{",["T_WHITESPACE","\n        ",276],["T_VARIABLE","$this",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","_setTransferFlag",277],"(",["T_STRING","self",277],["T_DOUBLE_COLON","::",277],["T_STRING","AMOUNT_SHIPPING",277],",",["T_WHITESPACE"," ",277],["T_STRING","true",277],")",";",["T_WHITESPACE","\n    ",277],"}",["T_WHITESPACE","\n\n    ",278],["T_DOC_COMMENT","\/**\n     * Specify that discount should be transferred as cart item\n     *\n     * @return void\n     * @api\n     *\/",280],["T_WHITESPACE","\n    ",285],["T_PUBLIC","public",286],["T_WHITESPACE"," ",286],["T_FUNCTION","function",286],["T_WHITESPACE"," ",286],["T_STRING","setTransferDiscountAsItem",286],"(",")",["T_WHITESPACE","\n    ",286],"{",["T_WHITESPACE","\n        ",287],["T_VARIABLE","$this",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","_setTransferFlag",288],"(",["T_STRING","self",288],["T_DOUBLE_COLON","::",288],["T_STRING","AMOUNT_DISCOUNT",288],",",["T_WHITESPACE"," ",288],["T_STRING","true",288],")",";",["T_WHITESPACE","\n    ",288],"}",["T_WHITESPACE","\n\n    ",289],["T_DOC_COMMENT","\/**\n     * Collect all items, discounts, taxes, shipping to cart\n     *\n     * @return void\n     *\/",291],["T_WHITESPACE","\n    ",295],["T_PROTECTED","protected",296],["T_WHITESPACE"," ",296],["T_FUNCTION","function",296],["T_WHITESPACE"," ",296],["T_STRING","_collectItemsAndAmounts",296],"(",")",["T_WHITESPACE","\n    ",296],"{",["T_WHITESPACE","\n        ",297],["T_IF","if",298],["T_WHITESPACE"," ",298],"(","!",["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","_itemsCollectingRequired",298],")",["T_WHITESPACE"," ",298],"{",["T_WHITESPACE","\n            ",298],["T_RETURN","return",299],";",["T_WHITESPACE","\n        ",299],"}",["T_WHITESPACE","\n\n        ",300],["T_VARIABLE","$this",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","_itemsCollectingRequired",302],["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],["T_STRING","false",302],";",["T_WHITESPACE","\n\n        ",302],["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","_salesModelItems",304],["T_WHITESPACE"," ",304],"=",["T_WHITESPACE"," ",304],"[","]",";",["T_WHITESPACE","\n        ",304],["T_VARIABLE","$this",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","_customItems",305],["T_WHITESPACE"," ",305],"=",["T_WHITESPACE"," ",305],"[","]",";",["T_WHITESPACE","\n\n        ",305],["T_VARIABLE","$this",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","_resetAmounts",307],"(",")",";",["T_WHITESPACE","\n\n        ",307],["T_VARIABLE","$this",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","_eventManager",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","dispatch",309],"(",["T_CONSTANT_ENCAPSED_STRING","'payment_cart_collect_items_and_amounts'",309],",",["T_WHITESPACE"," ",309],"[",["T_CONSTANT_ENCAPSED_STRING","'cart'",309],["T_WHITESPACE"," ",309],["T_DOUBLE_ARROW","=>",309],["T_WHITESPACE"," ",309],["T_VARIABLE","$this",309],"]",")",";",["T_WHITESPACE","\n\n        ",309],["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","_importItemsFromSalesModel",311],"(",")",";",["T_WHITESPACE","\n        ",311],["T_VARIABLE","$this",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","_calculateCustomItemsSubtotal",312],"(",")",";",["T_WHITESPACE","\n    ",312],"}",["T_WHITESPACE","\n\n    ",313],["T_DOC_COMMENT","\/**\n     * Import items from sales model\n     *\n     * @return void\n     *\/",315],["T_WHITESPACE","\n    ",319],["T_PROTECTED","protected",320],["T_WHITESPACE"," ",320],["T_FUNCTION","function",320],["T_WHITESPACE"," ",320],["T_STRING","_importItemsFromSalesModel",320],"(",")",["T_WHITESPACE","\n    ",320],"{",["T_WHITESPACE","\n        ",321],["T_VARIABLE","$this",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","_salesModelItems",322],["T_WHITESPACE"," ",322],"=",["T_WHITESPACE"," ",322],"[","]",";",["T_WHITESPACE","\n\n        ",322],["T_FOREACH","foreach",324],["T_WHITESPACE"," ",324],"(",["T_VARIABLE","$this",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","_salesModel",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","getAllItems",324],"(",")",["T_WHITESPACE"," ",324],["T_AS","as",324],["T_WHITESPACE"," ",324],["T_VARIABLE","$item",324],")",["T_WHITESPACE"," ",324],"{",["T_WHITESPACE","\n            ",324],["T_IF","if",325],["T_WHITESPACE"," ",325],"(",["T_VARIABLE","$item",325],["T_OBJECT_OPERATOR","->",325],["T_STRING","getParentItem",325],"(",")",")",["T_WHITESPACE"," ",325],"{",["T_WHITESPACE","\n                ",325],["T_CONTINUE","continue",326],";",["T_WHITESPACE","\n            ",326],"}",["T_WHITESPACE","\n\n            ",327],["T_VARIABLE","$this",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","_salesModelItems",329],"[","]",["T_WHITESPACE"," ",329],"=",["T_WHITESPACE"," ",329],["T_VARIABLE","$this",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","_createItemFromData",329],"(",["T_WHITESPACE","\n                ",329],["T_VARIABLE","$item",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","getName",330],"(",")",",",["T_WHITESPACE","\n                ",330],["T_VARIABLE","$item",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","getQty",331],"(",")",",",["T_WHITESPACE","\n                ",331],["T_VARIABLE","$item",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","getPrice",332],"(",")",",",["T_WHITESPACE","\n                ",332],["T_VARIABLE","$item",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","getOriginalItem",333],"(",")",["T_OBJECT_OPERATOR","->",333],["T_STRING","getId",333],"(",")",["T_WHITESPACE","\n            ",333],")",";",["T_WHITESPACE","\n        ",334],"}",["T_WHITESPACE","\n\n        ",335],["T_VARIABLE","$this",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","addSubtotal",337],"(",["T_VARIABLE","$this",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","_salesModel",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","getBaseSubtotal",337],"(",")",")",";",["T_WHITESPACE","\n        ",337],["T_VARIABLE","$this",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","addTax",338],"(",["T_VARIABLE","$this",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","_salesModel",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","getBaseTaxAmount",338],"(",")",")",";",["T_WHITESPACE","\n        ",338],["T_VARIABLE","$this",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","addShipping",339],"(",["T_VARIABLE","$this",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","_salesModel",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","getBaseShippingAmount",339],"(",")",")",";",["T_WHITESPACE","\n        ",339],["T_VARIABLE","$this",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","addDiscount",340],"(",["T_STRING","abs",340],"(",["T_VARIABLE","$this",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","_salesModel",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","getBaseDiscountAmount",340],"(",")",")",")",";",["T_WHITESPACE","\n    ",340],"}",["T_WHITESPACE","\n\n    ",341],["T_DOC_COMMENT","\/**\n     * Calculate subtotal from custom items\n     *\n     * @return void\n     *\/",343],["T_WHITESPACE","\n    ",347],["T_PROTECTED","protected",348],["T_WHITESPACE"," ",348],["T_FUNCTION","function",348],["T_WHITESPACE"," ",348],["T_STRING","_calculateCustomItemsSubtotal",348],"(",")",["T_WHITESPACE","\n    ",348],"{",["T_WHITESPACE","\n        ",349],["T_IF","if",350],["T_WHITESPACE"," ",350],"(","!",["T_EMPTY","empty",350],"(",["T_VARIABLE","$this",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","_transferFlags",350],"[",["T_STRING","self",350],["T_DOUBLE_COLON","::",350],["T_STRING","AMOUNT_DISCOUNT",350],"]",")",["T_WHITESPACE"," ",350],["T_BOOLEAN_AND","&&",350],["T_WHITESPACE"," ",350],["T_VARIABLE","$this",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","getDiscount",350],"(",")",")",["T_WHITESPACE"," ",350],"{",["T_WHITESPACE","\n            ",350],["T_VARIABLE","$this",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","addCustomItem",351],"(",["T_STRING","__",351],"(",["T_CONSTANT_ENCAPSED_STRING","'Discount'",351],")",",",["T_WHITESPACE"," ",351],["T_LNUMBER","1",351],",",["T_WHITESPACE"," ",351],"-",["T_DNUMBER","1.00",351],["T_WHITESPACE"," ",351],"*",["T_WHITESPACE"," ",351],["T_VARIABLE","$this",351],["T_OBJECT_OPERATOR","->",351],["T_STRING","getDiscount",351],"(",")",")",";",["T_WHITESPACE","\n            ",351],["T_VARIABLE","$this",352],["T_OBJECT_OPERATOR","->",352],["T_STRING","setDiscount",352],"(",["T_LNUMBER","0",352],")",";",["T_WHITESPACE","\n        ",352],"}",["T_WHITESPACE","\n\n        ",353],["T_IF","if",355],["T_WHITESPACE"," ",355],"(","!",["T_EMPTY","empty",355],"(",["T_VARIABLE","$this",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","_transferFlags",355],"[",["T_STRING","self",355],["T_DOUBLE_COLON","::",355],["T_STRING","AMOUNT_SHIPPING",355],"]",")",["T_WHITESPACE"," ",355],["T_BOOLEAN_AND","&&",355],["T_WHITESPACE"," ",355],["T_VARIABLE","$this",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","getShipping",355],"(",")",")",["T_WHITESPACE"," ",355],"{",["T_WHITESPACE","\n            ",355],["T_VARIABLE","$this",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","addCustomItem",356],"(",["T_STRING","__",356],"(",["T_CONSTANT_ENCAPSED_STRING","'Shipping'",356],")",",",["T_WHITESPACE"," ",356],["T_LNUMBER","1",356],",",["T_WHITESPACE"," ",356],["T_VARIABLE","$this",356],["T_OBJECT_OPERATOR","->",356],["T_STRING","getShipping",356],"(",")",")",";",["T_WHITESPACE","\n            ",356],["T_VARIABLE","$this",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","setShipping",357],"(",["T_LNUMBER","0",357],")",";",["T_WHITESPACE","\n        ",357],"}",["T_WHITESPACE","\n\n        ",358],["T_FOREACH","foreach",360],["T_WHITESPACE"," ",360],"(",["T_VARIABLE","$this",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","_customItems",360],["T_WHITESPACE"," ",360],["T_AS","as",360],["T_WHITESPACE"," ",360],["T_VARIABLE","$item",360],")",["T_WHITESPACE"," ",360],"{",["T_WHITESPACE","\n            ",360],["T_VARIABLE","$this",361],["T_OBJECT_OPERATOR","->",361],["T_STRING","_amounts",361],"[",["T_STRING","self",361],["T_DOUBLE_COLON","::",361],["T_STRING","AMOUNT_SUBTOTAL",361],"]",["T_WHITESPACE"," ",361],["T_PLUS_EQUAL","+=",361],["T_WHITESPACE"," ",361],["T_VARIABLE","$item",361],["T_OBJECT_OPERATOR","->",361],["T_STRING","getAmount",361],"(",")",";",["T_WHITESPACE","\n        ",361],"}",["T_WHITESPACE","\n    ",362],"}",["T_WHITESPACE","\n\n    ",363],["T_DOC_COMMENT","\/**\n     * @param string $flagType\n     * @param bool $value\n     * @return void\n     *\/",365],["T_WHITESPACE","\n    ",369],["T_PROTECTED","protected",370],["T_WHITESPACE"," ",370],["T_FUNCTION","function",370],["T_WHITESPACE"," ",370],["T_STRING","_setTransferFlag",370],"(",["T_VARIABLE","$flagType",370],",",["T_WHITESPACE"," ",370],["T_VARIABLE","$value",370],")",["T_WHITESPACE","\n    ",370],"{",["T_WHITESPACE","\n        ",371],["T_VARIABLE","$this",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","_transferFlags",372],"[",["T_VARIABLE","$flagType",372],"]",["T_WHITESPACE"," ",372],"=",["T_WHITESPACE"," ",372],["T_BOOL_CAST","(bool)",372],["T_VARIABLE","$value",372],";",["T_WHITESPACE","\n        ",372],["T_VARIABLE","$this",373],["T_OBJECT_OPERATOR","->",373],["T_STRING","_itemsCollectingRequired",373],["T_WHITESPACE"," ",373],"=",["T_WHITESPACE"," ",373],["T_STRING","true",373],";",["T_WHITESPACE","\n    ",373],"}",["T_WHITESPACE","\n\n    ",374],["T_DOC_COMMENT","\/**\n     * @param string $amountType\n     * @param float $amount\n     * @return void\n     *\/",376],["T_WHITESPACE","\n    ",380],["T_PROTECTED","protected",381],["T_WHITESPACE"," ",381],["T_FUNCTION","function",381],["T_WHITESPACE"," ",381],["T_STRING","_setAmount",381],"(",["T_VARIABLE","$amountType",381],",",["T_WHITESPACE"," ",381],["T_VARIABLE","$amount",381],")",["T_WHITESPACE","\n    ",381],"{",["T_WHITESPACE","\n        ",382],["T_VARIABLE","$this",383],["T_OBJECT_OPERATOR","->",383],["T_STRING","_amounts",383],"[",["T_VARIABLE","$amountType",383],"]",["T_WHITESPACE"," ",383],"=",["T_WHITESPACE"," ",383],["T_DOUBLE_CAST","(double)",383],["T_VARIABLE","$amount",383],";",["T_WHITESPACE","\n    ",383],"}",["T_WHITESPACE","\n\n    ",384],["T_DOC_COMMENT","\/**\n     * @param string $amountType\n     * @param float $amount\n     * @return void\n     *\/",386],["T_WHITESPACE","\n    ",390],["T_PROTECTED","protected",391],["T_WHITESPACE"," ",391],["T_FUNCTION","function",391],["T_WHITESPACE"," ",391],["T_STRING","_addAmount",391],"(",["T_VARIABLE","$amountType",391],",",["T_WHITESPACE"," ",391],["T_VARIABLE","$amount",391],")",["T_WHITESPACE","\n    ",391],"{",["T_WHITESPACE","\n        ",392],["T_VARIABLE","$this",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","_amounts",393],"[",["T_VARIABLE","$amountType",393],"]",["T_WHITESPACE"," ",393],["T_PLUS_EQUAL","+=",393],["T_WHITESPACE"," ",393],["T_DOUBLE_CAST","(double)",393],["T_VARIABLE","$amount",393],";",["T_WHITESPACE","\n    ",393],"}",["T_WHITESPACE","\n\n    ",394],["T_DOC_COMMENT","\/**\n     * Get amount of specified type\n     *\n     * @param string $amountType\n     * @return float\n     *\/",396],["T_WHITESPACE","\n    ",401],["T_PROTECTED","protected",402],["T_WHITESPACE"," ",402],["T_FUNCTION","function",402],["T_WHITESPACE"," ",402],["T_STRING","_getAmount",402],"(",["T_VARIABLE","$amountType",402],")",["T_WHITESPACE","\n    ",402],"{",["T_WHITESPACE","\n        ",403],["T_RETURN","return",404],["T_WHITESPACE"," ",404],["T_VARIABLE","$this",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","_amounts",404],"[",["T_VARIABLE","$amountType",404],"]",";",["T_WHITESPACE","\n    ",404],"}",["T_WHITESPACE","\n\n    ",405],["T_DOC_COMMENT","\/**\n     * Create item object from item data\n     *\n     * @param string $name\n     * @param int $qty\n     * @param float $amount\n     * @param null|string $identifier\n     * @return \\Magento\\Framework\\DataObject\n     *\/",407],["T_WHITESPACE","\n    ",415],["T_PROTECTED","protected",416],["T_WHITESPACE"," ",416],["T_FUNCTION","function",416],["T_WHITESPACE"," ",416],["T_STRING","_createItemFromData",416],"(",["T_VARIABLE","$name",416],",",["T_WHITESPACE"," ",416],["T_VARIABLE","$qty",416],",",["T_WHITESPACE"," ",416],["T_VARIABLE","$amount",416],",",["T_WHITESPACE"," ",416],["T_VARIABLE","$identifier",416],["T_WHITESPACE"," ",416],"=",["T_WHITESPACE"," ",416],["T_STRING","null",416],")",["T_WHITESPACE","\n    ",416],"{",["T_WHITESPACE","\n        ",417],["T_VARIABLE","$item",418],["T_WHITESPACE"," ",418],"=",["T_WHITESPACE"," ",418],["T_NEW","new",418],["T_WHITESPACE"," ",418],["T_NS_SEPARATOR","\\",418],["T_STRING","Magento",418],["T_NS_SEPARATOR","\\",418],["T_STRING","Framework",418],["T_NS_SEPARATOR","\\",418],["T_STRING","DataObject",418],"(","[",["T_CONSTANT_ENCAPSED_STRING","'name'",418],["T_WHITESPACE"," ",418],["T_DOUBLE_ARROW","=>",418],["T_WHITESPACE"," ",418],["T_VARIABLE","$name",418],",",["T_WHITESPACE"," ",418],["T_CONSTANT_ENCAPSED_STRING","'qty'",418],["T_WHITESPACE"," ",418],["T_DOUBLE_ARROW","=>",418],["T_WHITESPACE"," ",418],["T_VARIABLE","$qty",418],",",["T_WHITESPACE"," ",418],["T_CONSTANT_ENCAPSED_STRING","'amount'",418],["T_WHITESPACE"," ",418],["T_DOUBLE_ARROW","=>",418],["T_WHITESPACE"," ",418],["T_DOUBLE_CAST","(double)",418],["T_VARIABLE","$amount",418],"]",")",";",["T_WHITESPACE","\n\n        ",418],["T_IF","if",420],["T_WHITESPACE"," ",420],"(",["T_VARIABLE","$identifier",420],")",["T_WHITESPACE"," ",420],"{",["T_WHITESPACE","\n            ",420],["T_VARIABLE","$item",421],["T_OBJECT_OPERATOR","->",421],["T_STRING","setData",421],"(",["T_CONSTANT_ENCAPSED_STRING","'id'",421],",",["T_WHITESPACE"," ",421],["T_VARIABLE","$identifier",421],")",";",["T_WHITESPACE","\n        ",421],"}",["T_WHITESPACE","\n\n        ",422],["T_RETURN","return",424],["T_WHITESPACE"," ",424],["T_VARIABLE","$item",424],";",["T_WHITESPACE","\n    ",424],"}",["T_WHITESPACE","\n\n    ",425],["T_DOC_COMMENT","\/**\n     * Set all amount types to zero\n     *\n     * @return void\n     *\/",427],["T_WHITESPACE","\n    ",431],["T_PROTECTED","protected",432],["T_WHITESPACE"," ",432],["T_FUNCTION","function",432],["T_WHITESPACE"," ",432],["T_STRING","_resetAmounts",432],"(",")",["T_WHITESPACE","\n    ",432],"{",["T_WHITESPACE","\n        ",433],["T_VARIABLE","$this",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","_amounts",434],["T_WHITESPACE"," ",434],"=",["T_WHITESPACE"," ",434],"[",["T_WHITESPACE","\n            ",434],["T_STRING","self",435],["T_DOUBLE_COLON","::",435],["T_STRING","AMOUNT_DISCOUNT",435],["T_WHITESPACE"," ",435],["T_DOUBLE_ARROW","=>",435],["T_WHITESPACE"," ",435],["T_LNUMBER","0",435],",",["T_WHITESPACE","\n            ",435],["T_STRING","self",436],["T_DOUBLE_COLON","::",436],["T_STRING","AMOUNT_SHIPPING",436],["T_WHITESPACE"," ",436],["T_DOUBLE_ARROW","=>",436],["T_WHITESPACE"," ",436],["T_LNUMBER","0",436],",",["T_WHITESPACE","\n            ",436],["T_STRING","self",437],["T_DOUBLE_COLON","::",437],["T_STRING","AMOUNT_SUBTOTAL",437],["T_WHITESPACE"," ",437],["T_DOUBLE_ARROW","=>",437],["T_WHITESPACE"," ",437],["T_LNUMBER","0",437],",",["T_WHITESPACE","\n            ",437],["T_STRING","self",438],["T_DOUBLE_COLON","::",438],["T_STRING","AMOUNT_TAX",438],["T_WHITESPACE"," ",438],["T_DOUBLE_ARROW","=>",438],["T_WHITESPACE"," ",438],["T_LNUMBER","0",438],",",["T_WHITESPACE","\n        ",438],"]",";",["T_WHITESPACE","\n    ",439],"}",["T_WHITESPACE","\n",440],"}",["T_WHITESPACE","\n",441]]