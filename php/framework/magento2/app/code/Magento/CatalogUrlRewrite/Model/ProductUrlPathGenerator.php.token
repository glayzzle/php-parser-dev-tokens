[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","CatalogUrlRewrite",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Store",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Model",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Store",8],";",["T_WHITESPACE","\n\n",8],["T_CLASS","class",10],["T_WHITESPACE"," ",10],["T_STRING","ProductUrlPathGenerator",10],["T_WHITESPACE","\n",10],"{",["T_WHITESPACE","\n    ",11],["T_CONST","const",12],["T_WHITESPACE"," ",12],["T_STRING","XML_PATH_PRODUCT_URL_SUFFIX",12],["T_WHITESPACE"," ",12],"=",["T_WHITESPACE"," ",12],["T_CONSTANT_ENCAPSED_STRING","'catalog\/seo\/product_url_suffix'",12],";",["T_WHITESPACE","\n\n    ",12],["T_DOC_COMMENT","\/**\n     * Cache for product rewrite suffix\n     *\n     * @var array\n     *\/",14],["T_WHITESPACE","\n    ",18],["T_PROTECTED","protected",19],["T_WHITESPACE"," ",19],["T_VARIABLE","$productUrlSuffix",19],["T_WHITESPACE"," ",19],"=",["T_WHITESPACE"," ",19],"[","]",";",["T_WHITESPACE","\n\n    ",19],["T_DOC_COMMENT","\/** @var \\Magento\\Store\\Model\\StoreManagerInterface *\/",21],["T_WHITESPACE","\n    ",21],["T_PROTECTED","protected",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$storeManager",22],";",["T_WHITESPACE","\n\n    ",22],["T_DOC_COMMENT","\/** @var \\Magento\\Framework\\App\\Config\\ScopeConfigInterface *\/",24],["T_WHITESPACE","\n    ",24],["T_PROTECTED","protected",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$scopeConfig",25],";",["T_WHITESPACE","\n\n    ",25],["T_DOC_COMMENT","\/** @var \\Magento\\CatalogUrlRewrite\\Model\\CategoryUrlPathGenerator *\/",27],["T_WHITESPACE","\n    ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$categoryUrlPathGenerator",28],";",["T_WHITESPACE","\n\n    ",28],["T_DOC_COMMENT","\/** @var \\Magento\\Catalog\\Api\\ProductRepositoryInterface *\/",30],["T_WHITESPACE","\n    ",30],["T_PROTECTED","protected",31],["T_WHITESPACE"," ",31],["T_VARIABLE","$productRepository",31],";",["T_WHITESPACE","\n\n    ",31],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Store\\Model\\StoreManagerInterface $storeManager\n     * @param \\Magento\\Framework\\App\\Config\\ScopeConfigInterface $scopeConfig\n     * @param CategoryUrlPathGenerator $categoryUrlPathGenerator\n     * @param \\Magento\\Catalog\\Api\\ProductRepositoryInterface $productRepository\n     *\/",33],["T_WHITESPACE","\n    ",38],["T_PUBLIC","public",39],["T_WHITESPACE"," ",39],["T_FUNCTION","function",39],["T_WHITESPACE"," ",39],["T_STRING","__construct",39],"(",["T_WHITESPACE","\n        ",39],["T_NS_SEPARATOR","\\",40],["T_STRING","Magento",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Store",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Model",40],["T_NS_SEPARATOR","\\",40],["T_STRING","StoreManagerInterface",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$storeManager",40],",",["T_WHITESPACE","\n        ",40],["T_NS_SEPARATOR","\\",41],["T_STRING","Magento",41],["T_NS_SEPARATOR","\\",41],["T_STRING","Framework",41],["T_NS_SEPARATOR","\\",41],["T_STRING","App",41],["T_NS_SEPARATOR","\\",41],["T_STRING","Config",41],["T_NS_SEPARATOR","\\",41],["T_STRING","ScopeConfigInterface",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$scopeConfig",41],",",["T_WHITESPACE","\n        ",41],["T_NS_SEPARATOR","\\",42],["T_STRING","Magento",42],["T_NS_SEPARATOR","\\",42],["T_STRING","CatalogUrlRewrite",42],["T_NS_SEPARATOR","\\",42],["T_STRING","Model",42],["T_NS_SEPARATOR","\\",42],["T_STRING","CategoryUrlPathGenerator",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$categoryUrlPathGenerator",42],",",["T_WHITESPACE","\n        ",42],["T_NS_SEPARATOR","\\",43],["T_STRING","Magento",43],["T_NS_SEPARATOR","\\",43],["T_STRING","Catalog",43],["T_NS_SEPARATOR","\\",43],["T_STRING","Api",43],["T_NS_SEPARATOR","\\",43],["T_STRING","ProductRepositoryInterface",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$productRepository",43],["T_WHITESPACE","\n    ",43],")",["T_WHITESPACE"," ",44],"{",["T_WHITESPACE","\n        ",44],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","storeManager",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_VARIABLE","$storeManager",45],";",["T_WHITESPACE","\n        ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","scopeConfig",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$scopeConfig",46],";",["T_WHITESPACE","\n        ",46],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","categoryUrlPathGenerator",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$categoryUrlPathGenerator",47],";",["T_WHITESPACE","\n        ",47],["T_VARIABLE","$this",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","productRepository",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$productRepository",48],";",["T_WHITESPACE","\n    ",48],"}",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Retrieve Product Url path (with category if exists)\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @param \\Magento\\Catalog\\Model\\Category $category\n     *\n     * @return string\n     *\/",51],["T_WHITESPACE","\n    ",58],["T_PUBLIC","public",59],["T_WHITESPACE"," ",59],["T_FUNCTION","function",59],["T_WHITESPACE"," ",59],["T_STRING","getUrlPath",59],"(",["T_VARIABLE","$product",59],",",["T_WHITESPACE"," ",59],["T_VARIABLE","$category",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_STRING","null",59],")",["T_WHITESPACE","\n    ",59],"{",["T_WHITESPACE","\n        ",60],["T_VARIABLE","$path",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_VARIABLE","$product",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","getData",61],"(",["T_CONSTANT_ENCAPSED_STRING","'url_path'",61],")",";",["T_WHITESPACE","\n        ",61],["T_IF","if",62],["T_WHITESPACE"," ",62],"(",["T_VARIABLE","$path",62],["T_WHITESPACE"," ",62],["T_IS_IDENTICAL","===",62],["T_WHITESPACE"," ",62],["T_STRING","null",62],")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n            ",62],["T_VARIABLE","$path",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_VARIABLE","$product",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","getUrlKey",63],"(",")",["T_WHITESPACE","\n                ",63],"?",["T_WHITESPACE"," ",64],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","prepareProductUrlKey",64],"(",["T_VARIABLE","$product",64],")",["T_WHITESPACE","\n                ",64],":",["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","prepareProductDefaultUrlKey",65],"(",["T_VARIABLE","$product",65],")",";",["T_WHITESPACE","\n        ",65],"}",["T_WHITESPACE","\n        ",66],["T_RETURN","return",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$category",67],["T_WHITESPACE"," ",67],["T_IS_IDENTICAL","===",67],["T_WHITESPACE"," ",67],["T_STRING","null",67],["T_WHITESPACE","\n            ",67],"?",["T_WHITESPACE"," ",68],["T_VARIABLE","$path",68],["T_WHITESPACE","\n            ",68],":",["T_WHITESPACE"," ",69],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","categoryUrlPathGenerator",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getUrlPath",69],"(",["T_VARIABLE","$category",69],")",["T_WHITESPACE"," ",69],".",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'\/'",69],["T_WHITESPACE"," ",69],".",["T_WHITESPACE"," ",69],["T_VARIABLE","$path",69],";",["T_WHITESPACE","\n    ",69],"}",["T_WHITESPACE","\n\n    ",70],["T_DOC_COMMENT","\/**\n     * Prepare URL Key with stored product data (fallback for \"Use Default Value\" logic)\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return string\n     *\/",72],["T_WHITESPACE","\n    ",77],["T_PROTECTED","protected",78],["T_WHITESPACE"," ",78],["T_FUNCTION","function",78],["T_WHITESPACE"," ",78],["T_STRING","prepareProductDefaultUrlKey",78],"(",["T_NS_SEPARATOR","\\",78],["T_STRING","Magento",78],["T_NS_SEPARATOR","\\",78],["T_STRING","Catalog",78],["T_NS_SEPARATOR","\\",78],["T_STRING","Model",78],["T_NS_SEPARATOR","\\",78],["T_STRING","Product",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$product",78],")",["T_WHITESPACE","\n    ",78],"{",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$storedProduct",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","productRepository",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getById",80],"(",["T_VARIABLE","$product",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getId",80],"(",")",")",";",["T_WHITESPACE","\n        ",80],["T_VARIABLE","$storedUrlKey",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$storedProduct",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getUrlKey",81],"(",")",";",["T_WHITESPACE","\n        ",81],["T_RETURN","return",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$storedUrlKey",82],["T_WHITESPACE"," ",82],"?",":",["T_WHITESPACE"," ",82],["T_VARIABLE","$product",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","formatUrlKey",82],"(",["T_VARIABLE","$storedProduct",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","getName",82],"(",")",")",";",["T_WHITESPACE","\n    ",82],"}",["T_WHITESPACE","\n\n    ",83],["T_DOC_COMMENT","\/**\n     * Retrieve Product Url path with suffix\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @param int $storeId\n     * @param \\Magento\\Catalog\\Model\\Category $category\n     * @return string\n     *\/",85],["T_WHITESPACE","\n    ",92],["T_PUBLIC","public",93],["T_WHITESPACE"," ",93],["T_FUNCTION","function",93],["T_WHITESPACE"," ",93],["T_STRING","getUrlPathWithSuffix",93],"(",["T_VARIABLE","$product",93],",",["T_WHITESPACE"," ",93],["T_VARIABLE","$storeId",93],",",["T_WHITESPACE"," ",93],["T_VARIABLE","$category",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_STRING","null",93],")",["T_WHITESPACE","\n    ",93],"{",["T_WHITESPACE","\n        ",94],["T_RETURN","return",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getUrlPath",95],"(",["T_VARIABLE","$product",95],",",["T_WHITESPACE"," ",95],["T_VARIABLE","$category",95],")",["T_WHITESPACE"," ",95],".",["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getProductUrlSuffix",95],"(",["T_VARIABLE","$storeId",95],")",";",["T_WHITESPACE","\n    ",95],"}",["T_WHITESPACE","\n\n    ",96],["T_DOC_COMMENT","\/**\n     * Get canonical product url path\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @param \\Magento\\Catalog\\Model\\Category|null $category\n     * @return string\n     *\/",98],["T_WHITESPACE","\n    ",104],["T_PUBLIC","public",105],["T_WHITESPACE"," ",105],["T_FUNCTION","function",105],["T_WHITESPACE"," ",105],["T_STRING","getCanonicalUrlPath",105],"(",["T_VARIABLE","$product",105],",",["T_WHITESPACE"," ",105],["T_VARIABLE","$category",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],["T_STRING","null",105],")",["T_WHITESPACE","\n    ",105],"{",["T_WHITESPACE","\n        ",106],["T_VARIABLE","$path",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE","  ",107],["T_CONSTANT_ENCAPSED_STRING","'catalog\/product\/view\/id\/'",107],["T_WHITESPACE"," ",107],".",["T_WHITESPACE"," ",107],["T_VARIABLE","$product",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","getId",107],"(",")",";",["T_WHITESPACE","\n        ",107],["T_RETURN","return",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$category",108],["T_WHITESPACE"," ",108],"?",["T_WHITESPACE"," ",108],["T_VARIABLE","$path",108],["T_WHITESPACE"," ",108],".",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'\/category\/'",108],["T_WHITESPACE"," ",108],".",["T_WHITESPACE"," ",108],["T_VARIABLE","$category",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getId",108],"(",")",["T_WHITESPACE"," ",108],":",["T_WHITESPACE"," ",108],["T_VARIABLE","$path",108],";",["T_WHITESPACE","\n    ",108],"}",["T_WHITESPACE","\n\n    ",109],["T_DOC_COMMENT","\/**\n     * Generate product url key based on url_key entered by merchant or product name\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return string\n     *\/",111],["T_WHITESPACE","\n    ",116],["T_PUBLIC","public",117],["T_WHITESPACE"," ",117],["T_FUNCTION","function",117],["T_WHITESPACE"," ",117],["T_STRING","getUrlKey",117],"(",["T_VARIABLE","$product",117],")",["T_WHITESPACE","\n    ",117],"{",["T_WHITESPACE","\n        ",118],["T_RETURN","return",119],["T_WHITESPACE"," ",119],["T_VARIABLE","$product",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","getUrlKey",119],"(",")",["T_WHITESPACE"," ",119],["T_IS_IDENTICAL","===",119],["T_WHITESPACE"," ",119],["T_STRING","false",119],["T_WHITESPACE"," ",119],"?",["T_WHITESPACE"," ",119],["T_STRING","false",119],["T_WHITESPACE"," ",119],":",["T_WHITESPACE"," ",119],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","prepareProductUrlKey",119],"(",["T_VARIABLE","$product",119],")",";",["T_WHITESPACE","\n    ",119],"}",["T_WHITESPACE","\n\n    ",120],["T_DOC_COMMENT","\/**\n     * Prepare url key for product\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return string\n     *\/",122],["T_WHITESPACE","\n    ",127],["T_PROTECTED","protected",128],["T_WHITESPACE"," ",128],["T_FUNCTION","function",128],["T_WHITESPACE"," ",128],["T_STRING","prepareProductUrlKey",128],"(",["T_NS_SEPARATOR","\\",128],["T_STRING","Magento",128],["T_NS_SEPARATOR","\\",128],["T_STRING","Catalog",128],["T_NS_SEPARATOR","\\",128],["T_STRING","Model",128],["T_NS_SEPARATOR","\\",128],["T_STRING","Product",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$product",128],")",["T_WHITESPACE","\n    ",128],"{",["T_WHITESPACE","\n        ",129],["T_VARIABLE","$urlKey",130],["T_WHITESPACE"," ",130],"=",["T_WHITESPACE"," ",130],["T_VARIABLE","$product",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","getUrlKey",130],"(",")",";",["T_WHITESPACE","\n        ",130],["T_RETURN","return",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$product",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","formatUrlKey",131],"(",["T_VARIABLE","$urlKey",131],["T_WHITESPACE"," ",131],["T_IS_IDENTICAL","===",131],["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","''",131],["T_WHITESPACE"," ",131],["T_BOOLEAN_OR","||",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$urlKey",131],["T_WHITESPACE"," ",131],["T_IS_IDENTICAL","===",131],["T_WHITESPACE"," ",131],["T_STRING","null",131],["T_WHITESPACE"," ",131],"?",["T_WHITESPACE"," ",131],["T_VARIABLE","$product",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","getName",131],"(",")",["T_WHITESPACE"," ",131],":",["T_WHITESPACE"," ",131],["T_VARIABLE","$urlKey",131],")",";",["T_WHITESPACE","\n    ",131],"}",["T_WHITESPACE","\n\n    ",132],["T_DOC_COMMENT","\/**\n     * Retrieve product rewrite suffix for store\n     *\n     * @param int $storeId\n     * @return string\n     *\/",134],["T_WHITESPACE","\n    ",139],["T_PROTECTED","protected",140],["T_WHITESPACE"," ",140],["T_FUNCTION","function",140],["T_WHITESPACE"," ",140],["T_STRING","getProductUrlSuffix",140],"(",["T_VARIABLE","$storeId",140],["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_STRING","null",140],")",["T_WHITESPACE","\n    ",140],"{",["T_WHITESPACE","\n        ",141],["T_IF","if",142],["T_WHITESPACE"," ",142],"(",["T_VARIABLE","$storeId",142],["T_WHITESPACE"," ",142],["T_IS_IDENTICAL","===",142],["T_WHITESPACE"," ",142],["T_STRING","null",142],")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n            ",142],["T_VARIABLE","$storeId",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","storeManager",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getStore",143],"(",")",["T_OBJECT_OPERATOR","->",143],["T_STRING","getId",143],"(",")",";",["T_WHITESPACE","\n        ",143],"}",["T_WHITESPACE","\n\n        ",144],["T_IF","if",146],["T_WHITESPACE"," ",146],"(","!",["T_ISSET","isset",146],"(",["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","productUrlSuffix",146],"[",["T_VARIABLE","$storeId",146],"]",")",")",["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n            ",146],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","productUrlSuffix",147],"[",["T_VARIABLE","$storeId",147],"]",["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","scopeConfig",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","getValue",147],"(",["T_WHITESPACE","\n                ",147],["T_STRING","self",148],["T_DOUBLE_COLON","::",148],["T_STRING","XML_PATH_PRODUCT_URL_SUFFIX",148],",",["T_WHITESPACE","\n                ",148],["T_NS_SEPARATOR","\\",149],["T_STRING","Magento",149],["T_NS_SEPARATOR","\\",149],["T_STRING","Store",149],["T_NS_SEPARATOR","\\",149],["T_STRING","Model",149],["T_NS_SEPARATOR","\\",149],["T_STRING","ScopeInterface",149],["T_DOUBLE_COLON","::",149],["T_STRING","SCOPE_STORE",149],",",["T_WHITESPACE","\n                ",149],["T_VARIABLE","$storeId",150],["T_WHITESPACE","\n            ",150],")",";",["T_WHITESPACE","\n        ",151],"}",["T_WHITESPACE","\n        ",152],["T_RETURN","return",153],["T_WHITESPACE"," ",153],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","productUrlSuffix",153],"[",["T_VARIABLE","$storeId",153],"]",";",["T_WHITESPACE","\n    ",153],"}",["T_WHITESPACE","\n",154],"}",["T_WHITESPACE","\n",155]]