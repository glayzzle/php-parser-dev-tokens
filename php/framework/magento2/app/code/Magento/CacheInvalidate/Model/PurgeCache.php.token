[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","CacheInvalidate",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Cache",8],["T_NS_SEPARATOR","\\",8],["T_STRING","InvalidateLogger",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","App",9],["T_NS_SEPARATOR","\\",9],["T_STRING","DeploymentConfig",9],";",["T_WHITESPACE","\n\n",9],["T_CLASS","class",11],["T_WHITESPACE"," ",11],["T_STRING","PurgeCache",11],["T_WHITESPACE","\n",11],"{",["T_WHITESPACE","\n    ",12],["T_CONST","const",13],["T_WHITESPACE"," ",13],["T_STRING","HEADER_X_MAGENTO_TAGS_PATTERN",13],["T_WHITESPACE"," ",13],"=",["T_WHITESPACE"," ",13],["T_CONSTANT_ENCAPSED_STRING","'X-Magento-Tags-Pattern'",13],";",["T_WHITESPACE","\n\n    ",13],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\PageCache\\Model\\Cache\\Server\n     *\/",15],["T_WHITESPACE","\n    ",17],["T_PROTECTED","protected",18],["T_WHITESPACE"," ",18],["T_VARIABLE","$cacheServer",18],";",["T_WHITESPACE","\n\n    ",18],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\CacheInvalidate\\Model\\SocketFactory\n     *\/",20],["T_WHITESPACE","\n    ",22],["T_PROTECTED","protected",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$socketAdapterFactory",23],";",["T_WHITESPACE","\n\n    ",23],["T_DOC_COMMENT","\/**\n     * @var InvalidateLogger\n     *\/",25],["T_WHITESPACE","\n    ",27],["T_PRIVATE","private",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$logger",28],";",["T_WHITESPACE","\n\n    ",28],["T_DOC_COMMENT","\/**\n     * Constructor\n     *\n     * @param \\Magento\\PageCache\\Model\\Cache\\Server $cacheServer\n     * @param \\Magento\\CacheInvalidate\\Model\\SocketFactory $socketAdapterFactory\n     * @param InvalidateLogger $logger\n     *\/",30],["T_WHITESPACE","\n    ",36],["T_PUBLIC","public",37],["T_WHITESPACE"," ",37],["T_FUNCTION","function",37],["T_WHITESPACE"," ",37],["T_STRING","__construct",37],"(",["T_WHITESPACE","\n        ",37],["T_NS_SEPARATOR","\\",38],["T_STRING","Magento",38],["T_NS_SEPARATOR","\\",38],["T_STRING","PageCache",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Model",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Cache",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Server",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$cacheServer",38],",",["T_WHITESPACE","\n        ",38],["T_NS_SEPARATOR","\\",39],["T_STRING","Magento",39],["T_NS_SEPARATOR","\\",39],["T_STRING","CacheInvalidate",39],["T_NS_SEPARATOR","\\",39],["T_STRING","Model",39],["T_NS_SEPARATOR","\\",39],["T_STRING","SocketFactory",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$socketAdapterFactory",39],",",["T_WHITESPACE","\n        ",39],["T_STRING","InvalidateLogger",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$logger",40],["T_WHITESPACE","\n    ",40],")",["T_WHITESPACE"," ",41],"{",["T_WHITESPACE","\n        ",41],["T_VARIABLE","$this",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","cacheServer",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_VARIABLE","$cacheServer",42],";",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","socketAdapterFactory",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_VARIABLE","$socketAdapterFactory",43],";",["T_WHITESPACE","\n        ",43],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","logger",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_VARIABLE","$logger",44],";",["T_WHITESPACE","\n    ",44],"}",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * Send curl purge request\n     * to invalidate cache by tags pattern\n     *\n     * @param string $tagsPattern\n     * @return bool Return true if successful; otherwise return false\n     *\/",47],["T_WHITESPACE","\n    ",53],["T_PUBLIC","public",54],["T_WHITESPACE"," ",54],["T_FUNCTION","function",54],["T_WHITESPACE"," ",54],["T_STRING","sendPurgeRequest",54],"(",["T_VARIABLE","$tagsPattern",54],")",["T_WHITESPACE","\n    ",54],"{",["T_WHITESPACE","\n        ",55],["T_VARIABLE","$socketAdapter",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","socketAdapterFactory",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","create",56],"(",")",";",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$servers",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","cacheServer",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","getUris",57],"(",")",";",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$headers",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],"[",["T_STRING","self",58],["T_DOUBLE_COLON","::",58],["T_STRING","HEADER_X_MAGENTO_TAGS_PATTERN",58],["T_WHITESPACE"," ",58],["T_DOUBLE_ARROW","=>",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$tagsPattern",58],"]",";",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$socketAdapter",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","setOptions",59],"(","[",["T_CONSTANT_ENCAPSED_STRING","'timeout'",59],["T_WHITESPACE"," ",59],["T_DOUBLE_ARROW","=>",59],["T_WHITESPACE"," ",59],["T_LNUMBER","10",59],"]",")",";",["T_WHITESPACE","\n        ",59],["T_FOREACH","foreach",60],["T_WHITESPACE"," ",60],"(",["T_VARIABLE","$servers",60],["T_WHITESPACE"," ",60],["T_AS","as",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$server",60],")",["T_WHITESPACE"," ",60],"{",["T_WHITESPACE","\n            ",60],["T_TRY","try",61],["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n                ",61],["T_VARIABLE","$socketAdapter",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","connect",62],"(",["T_VARIABLE","$server",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","getHost",62],"(",")",",",["T_WHITESPACE"," ",62],["T_VARIABLE","$server",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","getPort",62],"(",")",")",";",["T_WHITESPACE","\n                ",62],["T_VARIABLE","$socketAdapter",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","write",63],"(",["T_WHITESPACE","\n                    ",63],["T_CONSTANT_ENCAPSED_STRING","'PURGE'",64],",",["T_WHITESPACE","\n                    ",64],["T_VARIABLE","$server",65],",",["T_WHITESPACE","\n                    ",65],["T_CONSTANT_ENCAPSED_STRING","'1.1'",66],",",["T_WHITESPACE","\n                    ",66],["T_VARIABLE","$headers",67],["T_WHITESPACE","\n                ",67],")",";",["T_WHITESPACE","\n                ",68],["T_VARIABLE","$socketAdapter",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","close",69],"(",")",";",["T_WHITESPACE","\n            ",69],"}",["T_WHITESPACE"," ",70],["T_CATCH","catch",70],["T_WHITESPACE"," ",70],"(",["T_NS_SEPARATOR","\\",70],["T_STRING","Exception",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$e",70],")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n                ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","logger",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","critical",71],"(",["T_VARIABLE","$e",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getMessage",71],"(",")",",",["T_WHITESPACE"," ",71],["T_STRING","compact",71],"(",["T_CONSTANT_ENCAPSED_STRING","'server'",71],",",["T_WHITESPACE"," ",71],["T_CONSTANT_ENCAPSED_STRING","'tagsPattern'",71],")",")",";",["T_WHITESPACE","\n                ",71],["T_RETURN","return",72],["T_WHITESPACE"," ",72],["T_STRING","false",72],";",["T_WHITESPACE","\n            ",72],"}",["T_WHITESPACE","\n        ",73],"}",["T_WHITESPACE","\n\n        ",74],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","logger",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","execute",76],"(",["T_STRING","compact",76],"(",["T_CONSTANT_ENCAPSED_STRING","'servers'",76],",",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'tagsPattern'",76],")",")",";",["T_WHITESPACE","\n        ",76],["T_RETURN","return",77],["T_WHITESPACE"," ",77],["T_STRING","true",77],";",["T_WHITESPACE","\n    ",77],"}",["T_WHITESPACE","\n",78],"}",["T_WHITESPACE","\n",79]]