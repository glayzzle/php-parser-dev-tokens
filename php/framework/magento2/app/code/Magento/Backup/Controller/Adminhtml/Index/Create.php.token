[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n *\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",6],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Backup",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Controller",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Adminhtml",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Index",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","App",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Filesystem",9],["T_NS_SEPARATOR","\\",9],["T_STRING","DirectoryList",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Filesystem",10],";",["T_WHITESPACE","\n\n",10],["T_CLASS","class",12],["T_WHITESPACE"," ",12],["T_STRING","Create",12],["T_WHITESPACE"," ",12],["T_EXTENDS","extends",12],["T_WHITESPACE"," ",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Backup",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Controller",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Adminhtml",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Index",12],["T_WHITESPACE","\n",12],"{",["T_WHITESPACE","\n    ",13],["T_DOC_COMMENT","\/**\n     * Create backup action\n     *\n     * @return void|\\Magento\\Backend\\App\\Action\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     *\/",14],["T_WHITESPACE","\n    ",19],["T_PUBLIC","public",20],["T_WHITESPACE"," ",20],["T_FUNCTION","function",20],["T_WHITESPACE"," ",20],["T_STRING","execute",20],"(",")",["T_WHITESPACE","\n    ",20],"{",["T_WHITESPACE","\n        ",21],["T_IF","if",22],["T_WHITESPACE"," ",22],"(","!",["T_VARIABLE","$this",22],["T_OBJECT_OPERATOR","->",22],["T_STRING","getRequest",22],"(",")",["T_OBJECT_OPERATOR","->",22],["T_STRING","isAjax",22],"(",")",")",["T_WHITESPACE"," ",22],"{",["T_WHITESPACE","\n            ",22],["T_RETURN","return",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$this",23],["T_OBJECT_OPERATOR","->",23],["T_STRING","_redirect",23],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/index'",23],")",";",["T_WHITESPACE","\n        ",23],"}",["T_WHITESPACE","\n\n        ",24],["T_VARIABLE","$response",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_NEW","new",26],["T_WHITESPACE"," ",26],["T_NS_SEPARATOR","\\",26],["T_STRING","Magento",26],["T_NS_SEPARATOR","\\",26],["T_STRING","Framework",26],["T_NS_SEPARATOR","\\",26],["T_STRING","DataObject",26],"(",")",";",["T_WHITESPACE","\n\n        ",26],["T_DOC_COMMENT","\/**\n         * @var \\Magento\\Backup\\Helper\\Data $helper\n         *\/",28],["T_WHITESPACE","\n        ",30],["T_VARIABLE","$helper",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_VARIABLE","$this",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","_objectManager",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","get",31],"(",["T_NS_SEPARATOR","\\",31],["T_STRING","Magento",31],["T_NS_SEPARATOR","\\",31],["T_STRING","Backup",31],["T_NS_SEPARATOR","\\",31],["T_STRING","Helper",31],["T_NS_SEPARATOR","\\",31],["T_STRING","Data",31],["T_DOUBLE_COLON","::",31],["T_CLASS","class",31],")",";",["T_WHITESPACE","\n\n        ",31],["T_TRY","try",33],["T_WHITESPACE"," ",33],"{",["T_WHITESPACE","\n            ",33],["T_VARIABLE","$type",34],["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","getRequest",34],"(",")",["T_OBJECT_OPERATOR","->",34],["T_STRING","getParam",34],"(",["T_CONSTANT_ENCAPSED_STRING","'type'",34],")",";",["T_WHITESPACE","\n\n            ",34],["T_IF","if",36],["T_WHITESPACE"," ",36],"(",["T_VARIABLE","$type",36],["T_WHITESPACE"," ",36],["T_IS_EQUAL","==",36],["T_WHITESPACE"," ",36],["T_NS_SEPARATOR","\\",36],["T_STRING","Magento",36],["T_NS_SEPARATOR","\\",36],["T_STRING","Framework",36],["T_NS_SEPARATOR","\\",36],["T_STRING","Backup",36],["T_NS_SEPARATOR","\\",36],["T_STRING","Factory",36],["T_DOUBLE_COLON","::",36],["T_STRING","TYPE_SYSTEM_SNAPSHOT",36],["T_WHITESPACE"," ",36],["T_BOOLEAN_AND","&&",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","getRequest",36],"(",")",["T_OBJECT_OPERATOR","->",36],["T_STRING","getParam",36],"(",["T_WHITESPACE","\n                ",36],["T_CONSTANT_ENCAPSED_STRING","'exclude_media'",37],["T_WHITESPACE","\n            ",37],")",["T_WHITESPACE","\n            ",38],")",["T_WHITESPACE"," ",39],"{",["T_WHITESPACE","\n                ",39],["T_VARIABLE","$type",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Magento",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Framework",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Backup",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Factory",40],["T_DOUBLE_COLON","::",40],["T_STRING","TYPE_SNAPSHOT_WITHOUT_MEDIA",40],";",["T_WHITESPACE","\n            ",40],"}",["T_WHITESPACE","\n\n            ",41],["T_VARIABLE","$backupManager",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_VARIABLE","$this",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","_backupFactory",43],["T_OBJECT_OPERATOR","->",43],["T_STRING","create",43],"(",["T_WHITESPACE","\n                ",43],["T_VARIABLE","$type",44],["T_WHITESPACE","\n            ",44],")",["T_OBJECT_OPERATOR","->",45],["T_STRING","setBackupExtension",45],"(",["T_WHITESPACE","\n                ",45],["T_VARIABLE","$helper",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","getExtensionByType",46],"(",["T_VARIABLE","$type",46],")",["T_WHITESPACE","\n            ",46],")",["T_OBJECT_OPERATOR","->",47],["T_STRING","setTime",47],"(",["T_WHITESPACE","\n                ",47],["T_STRING","time",48],"(",")",["T_WHITESPACE","\n            ",48],")",["T_OBJECT_OPERATOR","->",49],["T_STRING","setBackupsDir",49],"(",["T_WHITESPACE","\n                ",49],["T_VARIABLE","$helper",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","getBackupsDir",50],"(",")",["T_WHITESPACE","\n            ",50],")",";",["T_WHITESPACE","\n\n            ",51],["T_VARIABLE","$backupManager",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","setName",53],"(",["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","getRequest",53],"(",")",["T_OBJECT_OPERATOR","->",53],["T_STRING","getParam",53],"(",["T_CONSTANT_ENCAPSED_STRING","'backup_name'",53],")",")",";",["T_WHITESPACE","\n\n            ",53],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","_coreRegistry",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","register",55],"(",["T_CONSTANT_ENCAPSED_STRING","'backup_manager'",55],",",["T_WHITESPACE"," ",55],["T_VARIABLE","$backupManager",55],")",";",["T_WHITESPACE","\n\n            ",55],["T_IF","if",57],["T_WHITESPACE"," ",57],"(",["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","getRequest",57],"(",")",["T_OBJECT_OPERATOR","->",57],["T_STRING","getParam",57],"(",["T_CONSTANT_ENCAPSED_STRING","'maintenance_mode'",57],")",")",["T_WHITESPACE"," ",57],"{",["T_WHITESPACE","\n                ",57],["T_IF","if",58],["T_WHITESPACE"," ",58],"(","!",["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","maintenanceMode",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","set",58],"(",["T_STRING","true",58],")",")",["T_WHITESPACE"," ",58],"{",["T_WHITESPACE","\n                    ",58],["T_VARIABLE","$response",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","setError",59],"(",["T_WHITESPACE","\n                        ",59],["T_STRING","__",60],"(",["T_WHITESPACE","\n                            ",60],["T_CONSTANT_ENCAPSED_STRING","'You need more permissions to activate maintenance mode right now.'",61],["T_WHITESPACE","\n                        ",61],")",["T_WHITESPACE"," ",62],".",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","' '",62],["T_WHITESPACE"," ",62],".",["T_WHITESPACE"," ",62],["T_STRING","__",62],"(",["T_WHITESPACE","\n                            ",62],["T_CONSTANT_ENCAPSED_STRING","'To create the backup, please deselect '",63],["T_WHITESPACE","\n                            ",63],".",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'\"Put store into maintenance mode\" or update your permissions.'",64],["T_WHITESPACE","\n                        ",64],")",["T_WHITESPACE","\n                    ",65],")",";",["T_WHITESPACE","\n                    ",66],["T_VARIABLE","$backupManager",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","setErrorMessage",67],"(",["T_WHITESPACE","\n                        ",67],["T_STRING","__",68],"(",["T_CONSTANT_ENCAPSED_STRING","\"Something went wrong while putting your store into maintenance mode.\"",68],")",["T_WHITESPACE","\n                    ",68],")",";",["T_WHITESPACE","\n                    ",69],["T_RETURN","return",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getResponse",70],"(",")",["T_OBJECT_OPERATOR","->",70],["T_STRING","representJson",70],"(",["T_VARIABLE","$response",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","toJson",70],"(",")",")",";",["T_WHITESPACE","\n                ",70],"}",["T_WHITESPACE","\n            ",71],"}",["T_WHITESPACE","\n\n            ",72],["T_IF","if",74],["T_WHITESPACE"," ",74],"(",["T_VARIABLE","$type",74],["T_WHITESPACE"," ",74],["T_IS_NOT_EQUAL","!=",74],["T_WHITESPACE"," ",74],["T_NS_SEPARATOR","\\",74],["T_STRING","Magento",74],["T_NS_SEPARATOR","\\",74],["T_STRING","Framework",74],["T_NS_SEPARATOR","\\",74],["T_STRING","Backup",74],["T_NS_SEPARATOR","\\",74],["T_STRING","Factory",74],["T_DOUBLE_COLON","::",74],["T_STRING","TYPE_DB",74],")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n                ",74],["T_DOC_COMMENT","\/** @var Filesystem $filesystem *\/",75],["T_WHITESPACE","\n                ",75],["T_VARIABLE","$filesystem",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","_objectManager",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","get",76],"(",["T_NS_SEPARATOR","\\",76],["T_STRING","Magento",76],["T_NS_SEPARATOR","\\",76],["T_STRING","Framework",76],["T_NS_SEPARATOR","\\",76],["T_STRING","Filesystem",76],["T_DOUBLE_COLON","::",76],["T_CLASS","class",76],")",";",["T_WHITESPACE","\n                ",76],["T_VARIABLE","$backupManager",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","setRootDir",77],"(",["T_VARIABLE","$filesystem",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getDirectoryRead",77],"(",["T_STRING","DirectoryList",77],["T_DOUBLE_COLON","::",77],["T_STRING","ROOT",77],")",["T_OBJECT_OPERATOR","->",77],["T_STRING","getAbsolutePath",77],"(",")",")",["T_WHITESPACE","\n                    ",77],["T_OBJECT_OPERATOR","->",78],["T_STRING","addIgnorePaths",78],"(",["T_VARIABLE","$helper",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getBackupIgnorePaths",78],"(",")",")",";",["T_WHITESPACE","\n            ",78],"}",["T_WHITESPACE","\n\n            ",79],["T_VARIABLE","$successMessage",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$helper",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getCreateSuccessMessageByType",81],"(",["T_VARIABLE","$type",81],")",";",["T_WHITESPACE","\n\n            ",81],["T_VARIABLE","$backupManager",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","create",83],"(",")",";",["T_WHITESPACE","\n\n            ",83],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","messageManager",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","addSuccess",85],"(",["T_VARIABLE","$successMessage",85],")",";",["T_WHITESPACE","\n\n            ",85],["T_VARIABLE","$response",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","setRedirectUrl",87],"(",["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getUrl",87],"(",["T_CONSTANT_ENCAPSED_STRING","'*\/*\/index'",87],")",")",";",["T_WHITESPACE","\n        ",87],"}",["T_WHITESPACE"," ",88],["T_CATCH","catch",88],["T_WHITESPACE"," ",88],"(",["T_NS_SEPARATOR","\\",88],["T_STRING","Magento",88],["T_NS_SEPARATOR","\\",88],["T_STRING","Framework",88],["T_NS_SEPARATOR","\\",88],["T_STRING","Backup",88],["T_NS_SEPARATOR","\\",88],["T_STRING","Exception",88],["T_NS_SEPARATOR","\\",88],["T_STRING","NotEnoughFreeSpace",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$e",88],")",["T_WHITESPACE"," ",88],"{",["T_WHITESPACE","\n            ",88],["T_VARIABLE","$errorMessage",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_STRING","__",89],"(",["T_CONSTANT_ENCAPSED_STRING","'You need more free space to create a backup.'",89],")",";",["T_WHITESPACE","\n        ",89],"}",["T_WHITESPACE"," ",90],["T_CATCH","catch",90],["T_WHITESPACE"," ",90],"(",["T_NS_SEPARATOR","\\",90],["T_STRING","Magento",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Framework",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Backup",90],["T_NS_SEPARATOR","\\",90],["T_STRING","Exception",90],["T_NS_SEPARATOR","\\",90],["T_STRING","NotEnoughPermissions",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$e",90],")",["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n            ",90],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","_objectManager",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","get",91],"(",["T_NS_SEPARATOR","\\",91],["T_STRING","Psr",91],["T_NS_SEPARATOR","\\",91],["T_STRING","Log",91],["T_NS_SEPARATOR","\\",91],["T_STRING","LoggerInterface",91],["T_DOUBLE_COLON","::",91],["T_CLASS","class",91],")",["T_OBJECT_OPERATOR","->",91],["T_STRING","info",91],"(",["T_VARIABLE","$e",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getMessage",91],"(",")",")",";",["T_WHITESPACE","\n            ",91],["T_VARIABLE","$errorMessage",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_STRING","__",92],"(",["T_CONSTANT_ENCAPSED_STRING","'You need more permissions to create a backup.'",92],")",";",["T_WHITESPACE","\n        ",92],"}",["T_WHITESPACE"," ",93],["T_CATCH","catch",93],["T_WHITESPACE"," ",93],"(",["T_NS_SEPARATOR","\\",93],["T_STRING","Exception",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$e",93],")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n            ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","_objectManager",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","get",94],"(",["T_NS_SEPARATOR","\\",94],["T_STRING","Psr",94],["T_NS_SEPARATOR","\\",94],["T_STRING","Log",94],["T_NS_SEPARATOR","\\",94],["T_STRING","LoggerInterface",94],["T_DOUBLE_COLON","::",94],["T_CLASS","class",94],")",["T_OBJECT_OPERATOR","->",94],["T_STRING","info",94],"(",["T_VARIABLE","$e",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getMessage",94],"(",")",")",";",["T_WHITESPACE","\n            ",94],["T_VARIABLE","$errorMessage",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_STRING","__",95],"(",["T_CONSTANT_ENCAPSED_STRING","'We can\\'t create the backup right now.'",95],")",";",["T_WHITESPACE","\n        ",95],"}",["T_WHITESPACE","\n\n        ",96],["T_IF","if",98],["T_WHITESPACE"," ",98],"(","!",["T_EMPTY","empty",98],"(",["T_VARIABLE","$errorMessage",98],")",")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n            ",98],["T_VARIABLE","$response",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","setError",99],"(",["T_VARIABLE","$errorMessage",99],")",";",["T_WHITESPACE","\n            ",99],["T_VARIABLE","$backupManager",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","setErrorMessage",100],"(",["T_VARIABLE","$errorMessage",100],")",";",["T_WHITESPACE","\n        ",100],"}",["T_WHITESPACE","\n\n        ",101],["T_IF","if",103],["T_WHITESPACE"," ",103],"(",["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getRequest",103],"(",")",["T_OBJECT_OPERATOR","->",103],["T_STRING","getParam",103],"(",["T_CONSTANT_ENCAPSED_STRING","'maintenance_mode'",103],")",")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n            ",103],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","maintenanceMode",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","set",104],"(",["T_STRING","false",104],")",";",["T_WHITESPACE","\n        ",104],"}",["T_WHITESPACE","\n\n        ",105],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","getResponse",107],"(",")",["T_OBJECT_OPERATOR","->",107],["T_STRING","representJson",107],"(",["T_VARIABLE","$response",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","toJson",107],"(",")",")",";",["T_WHITESPACE","\n    ",107],"}",["T_WHITESPACE","\n",108],"}",["T_WHITESPACE","\n",109]]