[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","User",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Observer",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Backend",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Backend",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Model",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Auth",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Session",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Backend",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Model",10],["T_NS_SEPARATOR","\\",10],["T_STRING","UrlInterface",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Framework",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Encryption",11],["T_NS_SEPARATOR","\\",11],["T_STRING","EncryptorInterface",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Framework",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Event",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Observer",12],["T_WHITESPACE"," ",12],["T_AS","as",12],["T_WHITESPACE"," ",12],["T_STRING","EventObserver",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Framework",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Exception",13],["T_NS_SEPARATOR","\\",13],["T_STRING","State",13],["T_NS_SEPARATOR","\\",13],["T_STRING","UserLockedException",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Framework",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Message",14],["T_NS_SEPARATOR","\\",14],["T_STRING","ManagerInterface",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Magento",15],["T_NS_SEPARATOR","\\",15],["T_STRING","User",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Model",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Backend",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Config",15],["T_NS_SEPARATOR","\\",15],["T_STRING","ObserverConfig",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Magento",16],["T_NS_SEPARATOR","\\",16],["T_STRING","User",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Model",16],["T_NS_SEPARATOR","\\",16],["T_STRING","ResourceModel",16],["T_NS_SEPARATOR","\\",16],["T_STRING","User",16],["T_WHITESPACE"," ",16],["T_AS","as",16],["T_WHITESPACE"," ",16],["T_STRING","ResourceUser",16],";",["T_WHITESPACE","\n",16],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Magento",17],["T_NS_SEPARATOR","\\",17],["T_STRING","User",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Model",17],["T_NS_SEPARATOR","\\",17],["T_STRING","User",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Magento",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Framework",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Event",18],["T_NS_SEPARATOR","\\",18],["T_STRING","ObserverInterface",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Magento",19],["T_NS_SEPARATOR","\\",19],["T_STRING","User",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Model",19],["T_NS_SEPARATOR","\\",19],["T_STRING","UserFactory",19],";",["T_WHITESPACE","\n\n",19],["T_DOC_COMMENT","\/**\n * User backend observer model for authentication\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",21],["T_WHITESPACE","\n",24],["T_CLASS","class",25],["T_WHITESPACE"," ",25],["T_STRING","AuthObserver",25],["T_WHITESPACE"," ",25],["T_IMPLEMENTS","implements",25],["T_WHITESPACE"," ",25],["T_STRING","ObserverInterface",25],["T_WHITESPACE","\n",25],"{",["T_WHITESPACE","\n    ",26],["T_DOC_COMMENT","\/**\n     * Backend configuration interface\n     *\n     * @var ObserverConfig\n     *\/",27],["T_WHITESPACE","\n    ",31],["T_PROTECTED","protected",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$observerConfig",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * Admin user resource model\n     *\n     * @var ResourceUser\n     *\/",34],["T_WHITESPACE","\n    ",38],["T_PROTECTED","protected",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$userResource",39],";",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * Backend url interface\n     *\n     * @var UrlInterface\n     *\/",41],["T_WHITESPACE","\n    ",45],["T_PROTECTED","protected",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$url",46],";",["T_WHITESPACE","\n\n    ",46],["T_DOC_COMMENT","\/**\n     * Backend authorization session\n     *\n     * @var Session\n     *\/",48],["T_WHITESPACE","\n    ",52],["T_PROTECTED","protected",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$authSession",53],";",["T_WHITESPACE","\n\n    ",53],["T_DOC_COMMENT","\/**\n     * Factory class for user model\n     *\n     * @var UserFactory\n     *\/",55],["T_WHITESPACE","\n    ",59],["T_PROTECTED","protected",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$userFactory",60],";",["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * Encryption model\n     *\n     * @var EncryptorInterface\n     *\/",62],["T_WHITESPACE","\n    ",66],["T_PROTECTED","protected",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$encryptor",67],";",["T_WHITESPACE","\n\n    ",67],["T_DOC_COMMENT","\/**\n     * Message manager interface\n     *\n     * @var ManagerInterface\n     *\/",69],["T_WHITESPACE","\n    ",73],["T_PROTECTED","protected",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$messageManager",74],";",["T_WHITESPACE","\n\n    ",74],["T_DOC_COMMENT","\/**\n     * @param ObserverConfig $observerConfig\n     * @param ResourceUser $userResource\n     * @param UrlInterface $url\n     * @param Session $authSession\n     * @param UserFactory $userFactory\n     * @param EncryptorInterface $encryptor\n     * @param ManagerInterface $messageManager\n     *\/",76],["T_WHITESPACE","\n    ",84],["T_PUBLIC","public",85],["T_WHITESPACE"," ",85],["T_FUNCTION","function",85],["T_WHITESPACE"," ",85],["T_STRING","__construct",85],"(",["T_WHITESPACE","\n        ",85],["T_STRING","ObserverConfig",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$observerConfig",86],",",["T_WHITESPACE","\n        ",86],["T_STRING","ResourceUser",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$userResource",87],",",["T_WHITESPACE","\n        ",87],["T_STRING","UrlInterface",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$url",88],",",["T_WHITESPACE","\n        ",88],["T_STRING","Session",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$authSession",89],",",["T_WHITESPACE","\n        ",89],["T_STRING","UserFactory",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$userFactory",90],",",["T_WHITESPACE","\n        ",90],["T_STRING","EncryptorInterface",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$encryptor",91],",",["T_WHITESPACE","\n        ",91],["T_STRING","ManagerInterface",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$messageManager",92],["T_WHITESPACE","\n    ",92],")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","observerConfig",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_VARIABLE","$observerConfig",94],";",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","userResource",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$userResource",95],";",["T_WHITESPACE","\n        ",95],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","url",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$url",96],";",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","authSession",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$authSession",97],";",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","userFactory",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$userFactory",98],";",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","encryptor",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_VARIABLE","$encryptor",99],";",["T_WHITESPACE","\n        ",99],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","messageManager",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$messageManager",100],";",["T_WHITESPACE","\n    ",100],"}",["T_WHITESPACE","\n\n    ",101],["T_DOC_COMMENT","\/**\n     * Admin locking and password hashing upgrade logic implementation\n     *\n     * @param EventObserver $observer\n     * @return void\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     *\/",103],["T_WHITESPACE","\n    ",109],["T_PUBLIC","public",110],["T_WHITESPACE"," ",110],["T_FUNCTION","function",110],["T_WHITESPACE"," ",110],["T_STRING","execute",110],"(",["T_STRING","EventObserver",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$observer",110],")",["T_WHITESPACE","\n    ",110],"{",["T_WHITESPACE","\n        ",111],["T_VARIABLE","$password",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$observer",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","getEvent",112],"(",")",["T_OBJECT_OPERATOR","->",112],["T_STRING","getPassword",112],"(",")",";",["T_WHITESPACE","\n        ",112],["T_DOC_COMMENT","\/** @var User $user *\/",113],["T_WHITESPACE","\n        ",113],["T_VARIABLE","$user",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_VARIABLE","$observer",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","getEvent",114],"(",")",["T_OBJECT_OPERATOR","->",114],["T_STRING","getUser",114],"(",")",";",["T_WHITESPACE","\n        ",114],["T_VARIABLE","$authResult",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$observer",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","getEvent",115],"(",")",["T_OBJECT_OPERATOR","->",115],["T_STRING","getResult",115],"(",")",";",["T_WHITESPACE","\n\n        ",115],["T_IF","if",117],["T_WHITESPACE"," ",117],"(","!",["T_VARIABLE","$authResult",117],["T_WHITESPACE"," ",117],["T_BOOLEAN_AND","&&",117],["T_WHITESPACE"," ",117],["T_VARIABLE","$user",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getId",117],"(",")",")",["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n            ",117],["T_COMMENT","\/\/ update locking information regardless whether user locked or not\n",118],["T_WHITESPACE","            ",119],["T_VARIABLE","$this",119],["T_OBJECT_OPERATOR","->",119],["T_STRING","_updateLockingInformation",119],"(",["T_VARIABLE","$user",119],")",";",["T_WHITESPACE","\n        ",119],"}",["T_WHITESPACE","\n\n        ",120],["T_COMMENT","\/\/ check whether user is locked\n",122],["T_WHITESPACE","        ",123],["T_VARIABLE","$lockExpires",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$user",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getLockExpires",123],"(",")",";",["T_WHITESPACE","\n        ",123],["T_IF","if",124],["T_WHITESPACE"," ",124],"(",["T_VARIABLE","$lockExpires",124],")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n            ",124],["T_VARIABLE","$lockExpires",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_NEW","new",125],["T_WHITESPACE"," ",125],["T_NS_SEPARATOR","\\",125],["T_STRING","DateTime",125],"(",["T_VARIABLE","$lockExpires",125],")",";",["T_WHITESPACE","\n            ",125],["T_IF","if",126],["T_WHITESPACE"," ",126],"(",["T_VARIABLE","$lockExpires",126],["T_WHITESPACE"," ",126],">",["T_WHITESPACE"," ",126],["T_NEW","new",126],["T_WHITESPACE"," ",126],["T_NS_SEPARATOR","\\",126],["T_STRING","DateTime",126],"(",")",")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n                ",126],["T_THROW","throw",127],["T_WHITESPACE"," ",127],["T_NEW","new",127],["T_WHITESPACE"," ",127],["T_STRING","UserLockedException",127],"(",["T_WHITESPACE","\n                    ",127],["T_STRING","__",128],"(",["T_CONSTANT_ENCAPSED_STRING","'You did not sign in correctly or your account is temporarily disabled.'",128],")",["T_WHITESPACE","\n                ",128],")",";",["T_WHITESPACE","\n            ",129],"}",["T_WHITESPACE","\n        ",130],"}",["T_WHITESPACE","\n\n        ",131],["T_IF","if",133],["T_WHITESPACE"," ",133],"(","!",["T_VARIABLE","$authResult",133],")",["T_WHITESPACE"," ",133],"{",["T_WHITESPACE","\n            ",133],["T_RETURN","return",134],";",["T_WHITESPACE","\n        ",134],"}",["T_WHITESPACE","\n\n        ",135],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","userResource",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","unlock",137],"(",["T_VARIABLE","$user",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","getId",137],"(",")",")",";",["T_WHITESPACE","\n\n        ",137],["T_VARIABLE","$latestPassword",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","userResource",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getLatestPassword",139],"(",["T_VARIABLE","$user",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","getId",139],"(",")",")",";",["T_WHITESPACE","\n        ",139],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","_checkExpiredPassword",140],"(",["T_VARIABLE","$latestPassword",140],")",";",["T_WHITESPACE","\n\n        ",140],["T_IF","if",142],["T_WHITESPACE"," ",142],"(","!",["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","encryptor",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","validateHashVersion",142],"(",["T_VARIABLE","$user",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","getPassword",142],"(",")",",",["T_WHITESPACE"," ",142],["T_STRING","true",142],")",")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n            ",142],["T_VARIABLE","$user",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","setPassword",143],"(",["T_VARIABLE","$password",143],")",["T_WHITESPACE","\n                ",143],["T_OBJECT_OPERATOR","->",144],["T_STRING","setData",144],"(",["T_CONSTANT_ENCAPSED_STRING","'force_new_password'",144],",",["T_WHITESPACE"," ",144],["T_STRING","true",144],")",["T_WHITESPACE","\n                ",144],["T_OBJECT_OPERATOR","->",145],["T_STRING","save",145],"(",")",";",["T_WHITESPACE","\n        ",145],"}",["T_WHITESPACE","\n    ",146],"}",["T_WHITESPACE","\n\n    ",147],["T_DOC_COMMENT","\/**\n     * Update locking information for the user\n     *\n     * @param \\Magento\\User\\Model\\User $user\n     * @return void\n     *\/",149],["T_WHITESPACE","\n    ",154],["T_PRIVATE","private",155],["T_WHITESPACE"," ",155],["T_FUNCTION","function",155],["T_WHITESPACE"," ",155],["T_STRING","_updateLockingInformation",155],"(",["T_VARIABLE","$user",155],")",["T_WHITESPACE","\n    ",155],"{",["T_WHITESPACE","\n        ",156],["T_VARIABLE","$now",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_NEW","new",157],["T_WHITESPACE"," ",157],["T_NS_SEPARATOR","\\",157],["T_STRING","DateTime",157],"(",")",";",["T_WHITESPACE","\n        ",157],["T_VARIABLE","$lockThreshold",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","observerConfig",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","getAdminLockThreshold",158],"(",")",";",["T_WHITESPACE","\n        ",158],["T_VARIABLE","$maxFailures",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","observerConfig",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","getMaxFailures",159],"(",")",";",["T_WHITESPACE","\n        ",159],["T_IF","if",160],["T_WHITESPACE"," ",160],"(","!","(",["T_VARIABLE","$lockThreshold",160],["T_WHITESPACE"," ",160],["T_BOOLEAN_AND","&&",160],["T_WHITESPACE"," ",160],["T_VARIABLE","$maxFailures",160],")",")",["T_WHITESPACE"," ",160],"{",["T_WHITESPACE","\n            ",160],["T_RETURN","return",161],";",["T_WHITESPACE","\n        ",161],"}",["T_WHITESPACE","\n        ",162],["T_VARIABLE","$failuresNum",163],["T_WHITESPACE"," ",163],"=",["T_WHITESPACE"," ",163],["T_INT_CAST","(int)",163],["T_VARIABLE","$user",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","getFailuresNum",163],"(",")",["T_WHITESPACE"," ",163],"+",["T_WHITESPACE"," ",163],["T_LNUMBER","1",163],";",["T_WHITESPACE","\n        ",163],["T_DOC_COMMENT","\/** @noinspection PhpAssignmentInConditionInspection *\/",164],["T_WHITESPACE","\n        ",164],["T_IF","if",165],["T_WHITESPACE"," ",165],"(",["T_VARIABLE","$firstFailureDate",165],["T_WHITESPACE"," ",165],"=",["T_WHITESPACE"," ",165],["T_VARIABLE","$user",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","getFirstFailure",165],"(",")",")",["T_WHITESPACE"," ",165],"{",["T_WHITESPACE","\n            ",165],["T_VARIABLE","$firstFailureDate",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_NEW","new",166],["T_WHITESPACE"," ",166],["T_NS_SEPARATOR","\\",166],["T_STRING","DateTime",166],"(",["T_VARIABLE","$firstFailureDate",166],")",";",["T_WHITESPACE","\n        ",166],"}",["T_WHITESPACE","\n\n        ",167],["T_VARIABLE","$newFirstFailureDate",169],["T_WHITESPACE"," ",169],"=",["T_WHITESPACE"," ",169],["T_STRING","false",169],";",["T_WHITESPACE","\n        ",169],["T_VARIABLE","$updateLockExpires",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_STRING","false",170],";",["T_WHITESPACE","\n        ",170],["T_VARIABLE","$lockThreshInterval",171],["T_WHITESPACE"," ",171],"=",["T_WHITESPACE"," ",171],["T_NEW","new",171],["T_WHITESPACE"," ",171],["T_NS_SEPARATOR","\\",171],["T_STRING","DateInterval",171],"(",["T_CONSTANT_ENCAPSED_STRING","'PT'",171],["T_WHITESPACE"," ",171],".",["T_WHITESPACE"," ",171],["T_VARIABLE","$lockThreshold",171],".",["T_CONSTANT_ENCAPSED_STRING","'S'",171],")",";",["T_WHITESPACE","\n        ",171],["T_COMMENT","\/\/ set first failure date when this is first failure or last first failure expired\n",172],["T_WHITESPACE","        ",173],["T_IF","if",173],["T_WHITESPACE"," ",173],"(",["T_LNUMBER","1",173],["T_WHITESPACE"," ",173],["T_IS_IDENTICAL","===",173],["T_WHITESPACE"," ",173],["T_VARIABLE","$failuresNum",173],["T_WHITESPACE"," ",173],["T_BOOLEAN_OR","||",173],["T_WHITESPACE"," ",173],"!",["T_VARIABLE","$firstFailureDate",173],["T_WHITESPACE"," ",173],["T_BOOLEAN_OR","||",173],["T_WHITESPACE"," ",173],["T_VARIABLE","$now",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","diff",173],"(",["T_VARIABLE","$firstFailureDate",173],")",["T_WHITESPACE"," ",173],">",["T_WHITESPACE"," ",173],["T_VARIABLE","$lockThreshInterval",173],")",["T_WHITESPACE"," ",173],"{",["T_WHITESPACE","\n            ",173],["T_VARIABLE","$newFirstFailureDate",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_VARIABLE","$now",174],";",["T_WHITESPACE","\n            ",174],["T_COMMENT","\/\/ otherwise lock user\n",175],["T_WHITESPACE","        ",176],"}",["T_WHITESPACE"," ",176],["T_ELSEIF","elseif",176],["T_WHITESPACE"," ",176],"(",["T_VARIABLE","$failuresNum",176],["T_WHITESPACE"," ",176],["T_IS_GREATER_OR_EQUAL",">=",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$maxFailures",176],")",["T_WHITESPACE"," ",176],"{",["T_WHITESPACE","\n            ",176],["T_VARIABLE","$updateLockExpires",177],["T_WHITESPACE"," ",177],"=",["T_WHITESPACE"," ",177],["T_VARIABLE","$now",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","add",177],"(",["T_VARIABLE","$lockThreshInterval",177],")",";",["T_WHITESPACE","\n        ",177],"}",["T_WHITESPACE","\n        ",178],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","userResource",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","updateFailure",179],"(",["T_VARIABLE","$user",179],",",["T_WHITESPACE"," ",179],["T_VARIABLE","$updateLockExpires",179],",",["T_WHITESPACE"," ",179],["T_VARIABLE","$newFirstFailureDate",179],")",";",["T_WHITESPACE","\n    ",179],"}",["T_WHITESPACE","\n\n    ",180],["T_DOC_COMMENT","\/**\n     * Check whether the latest password is expired\n     * Side-effect can be when passwords were changed with different lifetime configuration settings\n     *\n     * @param array $latestPassword\n     * @return void\n     *\/",182],["T_WHITESPACE","\n    ",188],["T_PRIVATE","private",189],["T_WHITESPACE"," ",189],["T_FUNCTION","function",189],["T_WHITESPACE"," ",189],["T_STRING","_checkExpiredPassword",189],"(",["T_VARIABLE","$latestPassword",189],")",["T_WHITESPACE","\n    ",189],"{",["T_WHITESPACE","\n        ",190],["T_IF","if",191],["T_WHITESPACE"," ",191],"(",["T_VARIABLE","$latestPassword",191],["T_WHITESPACE"," ",191],["T_BOOLEAN_AND","&&",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","observerConfig",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","_isLatestPasswordExpired",191],"(",["T_VARIABLE","$latestPassword",191],")",")",["T_WHITESPACE"," ",191],"{",["T_WHITESPACE","\n            ",191],["T_IF","if",192],["T_WHITESPACE"," ",192],"(",["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","observerConfig",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","isPasswordChangeForced",192],"(",")",")",["T_WHITESPACE"," ",192],"{",["T_WHITESPACE","\n                ",192],["T_VARIABLE","$message",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_STRING","__",193],"(",["T_CONSTANT_ENCAPSED_STRING","'It\\'s time to change your password.'",193],")",";",["T_WHITESPACE","\n            ",193],"}",["T_WHITESPACE"," ",194],["T_ELSE","else",194],["T_WHITESPACE"," ",194],"{",["T_WHITESPACE","\n                ",194],["T_VARIABLE","$myAccountUrl",195],["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","url",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","getUrl",195],"(",["T_CONSTANT_ENCAPSED_STRING","'adminhtml\/system_account\/'",195],")",";",["T_WHITESPACE","\n                ",195],["T_VARIABLE","$message",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_STRING","__",196],"(",["T_CONSTANT_ENCAPSED_STRING","'It\\'s time to <a href=\"%1\">change your password<\/a>.'",196],",",["T_WHITESPACE"," ",196],["T_VARIABLE","$myAccountUrl",196],")",";",["T_WHITESPACE","\n            ",196],"}",["T_WHITESPACE","\n            ",197],["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","messageManager",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","addNoticeMessage",198],"(",["T_VARIABLE","$message",198],")",";",["T_WHITESPACE","\n            ",198],["T_VARIABLE","$message",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","messageManager",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","getMessages",199],"(",")",["T_OBJECT_OPERATOR","->",199],["T_STRING","getLastAddedMessage",199],"(",")",";",["T_WHITESPACE","\n            ",199],["T_IF","if",200],["T_WHITESPACE"," ",200],"(",["T_VARIABLE","$message",200],")",["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n                ",200],["T_VARIABLE","$message",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","setIdentifier",201],"(",["T_CONSTANT_ENCAPSED_STRING","'magento_user_password_expired'",201],")",["T_OBJECT_OPERATOR","->",201],["T_STRING","setIsSticky",201],"(",["T_STRING","true",201],")",";",["T_WHITESPACE","\n                ",201],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","authSession",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","setPciAdminUserIsPasswordExpired",202],"(",["T_STRING","true",202],")",";",["T_WHITESPACE","\n            ",202],"}",["T_WHITESPACE","\n        ",203],"}",["T_WHITESPACE","\n    ",204],"}",["T_WHITESPACE","\n",205],"}",["T_WHITESPACE","\n",206]]