[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","User",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Model",7],["T_NS_SEPARATOR","\\",7],["T_STRING","ResourceModel",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Authorization",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Model",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Acl",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Role",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Group",9],["T_WHITESPACE"," ",9],["T_AS","as",9],["T_WHITESPACE"," ",9],["T_STRING","RoleGroup",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Authorization",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Model",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Acl",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Role",10],["T_NS_SEPARATOR","\\",10],["T_STRING","User",10],["T_WHITESPACE"," ",10],["T_AS","as",10],["T_WHITESPACE"," ",10],["T_STRING","RoleUser",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Authorization",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Model",11],["T_NS_SEPARATOR","\\",11],["T_STRING","UserContextInterface",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","User",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Model",12],["T_NS_SEPARATOR","\\",12],["T_STRING","User",12],["T_WHITESPACE"," ",12],["T_AS","as",12],["T_WHITESPACE"," ",12],["T_STRING","ModelUser",12],";",["T_WHITESPACE","\n\n",12],["T_DOC_COMMENT","\/**\n * ACL user resource\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",14],["T_WHITESPACE","\n",17],["T_CLASS","class",18],["T_WHITESPACE"," ",18],["T_STRING","User",18],["T_WHITESPACE"," ",18],["T_EXTENDS","extends",18],["T_WHITESPACE"," ",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Magento",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Framework",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Model",18],["T_NS_SEPARATOR","\\",18],["T_STRING","ResourceModel",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Db",18],["T_NS_SEPARATOR","\\",18],["T_STRING","AbstractDb",18],["T_WHITESPACE","\n",18],"{",["T_WHITESPACE","\n    ",19],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Acl\\CacheInterface\n     * @deprecated since 2.2 due to native serialization elimination.\n     * Use data cache \\Magento\\Framework\\Acl\\Data\\CacheInterface instead.\n     *\/",20],["T_WHITESPACE","\n    ",24],["T_PROTECTED","protected",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$_aclCache",25],";",["T_WHITESPACE","\n\n    ",25],["T_DOC_COMMENT","\/**\n     * Role model\n     *\n     * @var \\Magento\\Authorization\\Model\\RoleFactory\n     *\/",27],["T_WHITESPACE","\n    ",31],["T_PROTECTED","protected",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$_roleFactory",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Stdlib\\DateTime\n     *\/",34],["T_WHITESPACE","\n    ",36],["T_PROTECTED","protected",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$dateTime",37],";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Acl\\Data\\CacheInterface\n     *\/",39],["T_WHITESPACE","\n    ",41],["T_PRIVATE","private",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$aclDataCache",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Construct\n     *\n     * @param \\Magento\\Framework\\Model\\ResourceModel\\Db\\Context $context\n     * @param \\Magento\\Framework\\Acl\\CacheInterface $aclCache\n     * @param \\Magento\\Authorization\\Model\\RoleFactory $roleFactory\n     * @param \\Magento\\Framework\\Stdlib\\DateTime $dateTime\n     * @param string $connectionName\n     * @param \\Magento\\Framework\\Acl\\Data\\CacheInterface $aclDataCache\n     *\/",44],["T_WHITESPACE","\n    ",53],["T_PUBLIC","public",54],["T_WHITESPACE"," ",54],["T_FUNCTION","function",54],["T_WHITESPACE"," ",54],["T_STRING","__construct",54],"(",["T_WHITESPACE","\n        ",54],["T_NS_SEPARATOR","\\",55],["T_STRING","Magento",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Framework",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Model",55],["T_NS_SEPARATOR","\\",55],["T_STRING","ResourceModel",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Db",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Context",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$context",55],",",["T_WHITESPACE","\n        ",55],["T_NS_SEPARATOR","\\",56],["T_STRING","Magento",56],["T_NS_SEPARATOR","\\",56],["T_STRING","Framework",56],["T_NS_SEPARATOR","\\",56],["T_STRING","Acl",56],["T_NS_SEPARATOR","\\",56],["T_STRING","CacheInterface",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$aclCache",56],",",["T_WHITESPACE","\n        ",56],["T_NS_SEPARATOR","\\",57],["T_STRING","Magento",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Authorization",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Model",57],["T_NS_SEPARATOR","\\",57],["T_STRING","RoleFactory",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$roleFactory",57],",",["T_WHITESPACE","\n        ",57],["T_NS_SEPARATOR","\\",58],["T_STRING","Magento",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Framework",58],["T_NS_SEPARATOR","\\",58],["T_STRING","Stdlib",58],["T_NS_SEPARATOR","\\",58],["T_STRING","DateTime",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$dateTime",58],",",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$connectionName",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_STRING","null",59],",",["T_WHITESPACE","\n        ",59],["T_NS_SEPARATOR","\\",60],["T_STRING","Magento",60],["T_NS_SEPARATOR","\\",60],["T_STRING","Framework",60],["T_NS_SEPARATOR","\\",60],["T_STRING","Acl",60],["T_NS_SEPARATOR","\\",60],["T_STRING","Data",60],["T_NS_SEPARATOR","\\",60],["T_STRING","CacheInterface",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$aclDataCache",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_STRING","null",60],["T_WHITESPACE","\n    ",60],")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n        ",61],["T_STRING","parent",62],["T_DOUBLE_COLON","::",62],["T_STRING","__construct",62],"(",["T_VARIABLE","$context",62],",",["T_WHITESPACE"," ",62],["T_VARIABLE","$connectionName",62],")",";",["T_WHITESPACE","\n        ",62],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","_aclCache",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_VARIABLE","$aclCache",63],";",["T_WHITESPACE","\n        ",63],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","_roleFactory",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$roleFactory",64],";",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","dateTime",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$dateTime",65],";",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","aclDataCache",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$aclDataCache",66],["T_WHITESPACE"," ",66],"?",":",["T_WHITESPACE"," ",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Magento",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Framework",66],["T_NS_SEPARATOR","\\",66],["T_STRING","App",66],["T_NS_SEPARATOR","\\",66],["T_STRING","ObjectManager",66],["T_DOUBLE_COLON","::",66],["T_STRING","getInstance",66],"(",")",["T_OBJECT_OPERATOR","->",66],["T_STRING","get",66],"(",["T_WHITESPACE","\n            ",66],["T_NS_SEPARATOR","\\",67],["T_STRING","Magento",67],["T_NS_SEPARATOR","\\",67],["T_STRING","Framework",67],["T_NS_SEPARATOR","\\",67],["T_STRING","Acl",67],["T_NS_SEPARATOR","\\",67],["T_STRING","Data",67],["T_NS_SEPARATOR","\\",67],["T_STRING","CacheInterface",67],["T_DOUBLE_COLON","::",67],["T_CLASS","class",67],["T_WHITESPACE","\n        ",67],")",";",["T_WHITESPACE","\n    ",68],"}",["T_WHITESPACE","\n\n    ",69],["T_DOC_COMMENT","\/**\n     * Define main table\n     *\n     * @return void\n     *\/",71],["T_WHITESPACE","\n    ",75],["T_PROTECTED","protected",76],["T_WHITESPACE"," ",76],["T_FUNCTION","function",76],["T_WHITESPACE"," ",76],["T_STRING","_construct",76],"(",")",["T_WHITESPACE","\n    ",76],"{",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","_init",78],"(",["T_CONSTANT_ENCAPSED_STRING","'admin_user'",78],",",["T_WHITESPACE"," ",78],["T_CONSTANT_ENCAPSED_STRING","'user_id'",78],")",";",["T_WHITESPACE","\n    ",78],"}",["T_WHITESPACE","\n\n    ",79],["T_DOC_COMMENT","\/**\n     * Initialize unique fields\n     *\n     * @return $this\n     *\/",81],["T_WHITESPACE","\n    ",85],["T_PROTECTED","protected",86],["T_WHITESPACE"," ",86],["T_FUNCTION","function",86],["T_WHITESPACE"," ",86],["T_STRING","_initUniqueFields",86],"(",")",["T_WHITESPACE","\n    ",86],"{",["T_WHITESPACE","\n        ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","_uniqueFields",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],"[",["T_WHITESPACE","\n            ",88],"[",["T_CONSTANT_ENCAPSED_STRING","'field'",89],["T_WHITESPACE"," ",89],["T_DOUBLE_ARROW","=>",89],["T_WHITESPACE"," ",89],["T_CONSTANT_ENCAPSED_STRING","'email'",89],",",["T_WHITESPACE"," ",89],["T_CONSTANT_ENCAPSED_STRING","'title'",89],["T_WHITESPACE"," ",89],["T_DOUBLE_ARROW","=>",89],["T_WHITESPACE"," ",89],["T_STRING","__",89],"(",["T_CONSTANT_ENCAPSED_STRING","'Email'",89],")","]",",",["T_WHITESPACE","\n            ",89],"[",["T_CONSTANT_ENCAPSED_STRING","'field'",90],["T_WHITESPACE"," ",90],["T_DOUBLE_ARROW","=>",90],["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'username'",90],",",["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","'title'",90],["T_WHITESPACE"," ",90],["T_DOUBLE_ARROW","=>",90],["T_WHITESPACE"," ",90],["T_STRING","__",90],"(",["T_CONSTANT_ENCAPSED_STRING","'User Name'",90],")","]",",",["T_WHITESPACE","\n        ",90],"]",";",["T_WHITESPACE","\n        ",91],["T_RETURN","return",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],";",["T_WHITESPACE","\n    ",92],"}",["T_WHITESPACE","\n\n    ",93],["T_DOC_COMMENT","\/**\n     * Authenticate user by $username and $password\n     *\n     * @param ModelUser $user\n     * @return $this\n     *\/",95],["T_WHITESPACE","\n    ",100],["T_PUBLIC","public",101],["T_WHITESPACE"," ",101],["T_FUNCTION","function",101],["T_WHITESPACE"," ",101],["T_STRING","recordLogin",101],"(",["T_STRING","ModelUser",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$user",101],")",["T_WHITESPACE","\n    ",101],"{",["T_WHITESPACE","\n        ",102],["T_VARIABLE","$connection",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","getConnection",103],"(",")",";",["T_WHITESPACE","\n\n        ",103],["T_VARIABLE","$data",105],["T_WHITESPACE"," ",105],"=",["T_WHITESPACE"," ",105],"[",["T_WHITESPACE","\n            ",105],["T_CONSTANT_ENCAPSED_STRING","'logdate'",106],["T_WHITESPACE"," ",106],["T_DOUBLE_ARROW","=>",106],["T_WHITESPACE"," ",106],"(",["T_NEW","new",106],["T_WHITESPACE"," ",106],["T_NS_SEPARATOR","\\",106],["T_STRING","DateTime",106],"(",")",")",["T_OBJECT_OPERATOR","->",106],["T_STRING","format",106],"(",["T_NS_SEPARATOR","\\",106],["T_STRING","Magento",106],["T_NS_SEPARATOR","\\",106],["T_STRING","Framework",106],["T_NS_SEPARATOR","\\",106],["T_STRING","Stdlib",106],["T_NS_SEPARATOR","\\",106],["T_STRING","DateTime",106],["T_DOUBLE_COLON","::",106],["T_STRING","DATETIME_PHP_FORMAT",106],")",",",["T_WHITESPACE","\n            ",106],["T_CONSTANT_ENCAPSED_STRING","'lognum'",107],["T_WHITESPACE"," ",107],["T_DOUBLE_ARROW","=>",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$user",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","getLognum",107],"(",")",["T_WHITESPACE"," ",107],"+",["T_WHITESPACE"," ",107],["T_LNUMBER","1",107],",",["T_WHITESPACE","\n        ",107],"]",";",["T_WHITESPACE","\n\n        ",108],["T_VARIABLE","$condition",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],"[",["T_CONSTANT_ENCAPSED_STRING","'user_id = ?'",110],["T_WHITESPACE"," ",110],["T_DOUBLE_ARROW","=>",110],["T_WHITESPACE"," ",110],["T_INT_CAST","(int)",110],["T_VARIABLE","$user",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getUserId",110],"(",")","]",";",["T_WHITESPACE","\n\n        ",110],["T_VARIABLE","$connection",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","update",112],"(",["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","getMainTable",112],"(",")",",",["T_WHITESPACE"," ",112],["T_VARIABLE","$data",112],",",["T_WHITESPACE"," ",112],["T_VARIABLE","$condition",112],")",";",["T_WHITESPACE","\n\n        ",112],["T_RETURN","return",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$this",114],";",["T_WHITESPACE","\n    ",114],"}",["T_WHITESPACE","\n\n    ",115],["T_DOC_COMMENT","\/**\n     * Load data by specified username\n     *\n     * @param string $username\n     * @return array\n     *\/",117],["T_WHITESPACE","\n    ",122],["T_PUBLIC","public",123],["T_WHITESPACE"," ",123],["T_FUNCTION","function",123],["T_WHITESPACE"," ",123],["T_STRING","loadByUsername",123],"(",["T_VARIABLE","$username",123],")",["T_WHITESPACE","\n    ",123],"{",["T_WHITESPACE","\n        ",124],["T_VARIABLE","$connection",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","getConnection",125],"(",")",";",["T_WHITESPACE","\n\n        ",125],["T_VARIABLE","$select",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_VARIABLE","$connection",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","select",127],"(",")",["T_OBJECT_OPERATOR","->",127],["T_STRING","from",127],"(",["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","getMainTable",127],"(",")",")",["T_OBJECT_OPERATOR","->",127],["T_STRING","where",127],"(",["T_CONSTANT_ENCAPSED_STRING","'username=:username'",127],")",";",["T_WHITESPACE","\n\n        ",127],["T_VARIABLE","$binds",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],"[",["T_CONSTANT_ENCAPSED_STRING","'username'",129],["T_WHITESPACE"," ",129],["T_DOUBLE_ARROW","=>",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$username",129],"]",";",["T_WHITESPACE","\n\n        ",129],["T_RETURN","return",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$connection",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","fetchRow",131],"(",["T_VARIABLE","$select",131],",",["T_WHITESPACE"," ",131],["T_VARIABLE","$binds",131],")",";",["T_WHITESPACE","\n    ",131],"}",["T_WHITESPACE","\n\n    ",132],["T_DOC_COMMENT","\/**\n     * Check if user is assigned to any role\n     *\n     * @param int|ModelUser $user\n     * @return null|array\n     *\/",134],["T_WHITESPACE","\n    ",139],["T_PUBLIC","public",140],["T_WHITESPACE"," ",140],["T_FUNCTION","function",140],["T_WHITESPACE"," ",140],["T_STRING","hasAssigned2Role",140],"(",["T_VARIABLE","$user",140],")",["T_WHITESPACE","\n    ",140],"{",["T_WHITESPACE","\n        ",141],["T_IF","if",142],["T_WHITESPACE"," ",142],"(",["T_STRING","is_numeric",142],"(",["T_VARIABLE","$user",142],")",")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n            ",142],["T_VARIABLE","$userId",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_VARIABLE","$user",143],";",["T_WHITESPACE","\n        ",143],"}",["T_WHITESPACE"," ",144],["T_ELSEIF","elseif",144],["T_WHITESPACE"," ",144],"(",["T_VARIABLE","$user",144],["T_WHITESPACE"," ",144],["T_INSTANCEOF","instanceof",144],["T_WHITESPACE"," ",144],["T_NS_SEPARATOR","\\",144],["T_STRING","Magento",144],["T_NS_SEPARATOR","\\",144],["T_STRING","Framework",144],["T_NS_SEPARATOR","\\",144],["T_STRING","Model",144],["T_NS_SEPARATOR","\\",144],["T_STRING","AbstractModel",144],")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n            ",144],["T_VARIABLE","$userId",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_VARIABLE","$user",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getUserId",145],"(",")",";",["T_WHITESPACE","\n        ",145],"}",["T_WHITESPACE"," ",146],["T_ELSE","else",146],["T_WHITESPACE"," ",146],"{",["T_WHITESPACE","\n            ",146],["T_RETURN","return",147],["T_WHITESPACE"," ",147],["T_STRING","null",147],";",["T_WHITESPACE","\n        ",147],"}",["T_WHITESPACE","\n\n        ",148],["T_IF","if",150],["T_WHITESPACE"," ",150],"(",["T_VARIABLE","$userId",150],["T_WHITESPACE"," ",150],">",["T_WHITESPACE"," ",150],["T_LNUMBER","0",150],")",["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n            ",150],["T_VARIABLE","$connection",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","getConnection",151],"(",")",";",["T_WHITESPACE","\n\n            ",151],["T_VARIABLE","$select",153],["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_VARIABLE","$connection",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","select",153],"(",")",";",["T_WHITESPACE","\n            ",153],["T_VARIABLE","$select",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","from",154],"(",["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","getTable",154],"(",["T_CONSTANT_ENCAPSED_STRING","'authorization_role'",154],")",")",["T_WHITESPACE","\n                ",154],["T_OBJECT_OPERATOR","->",155],["T_STRING","where",155],"(",["T_CONSTANT_ENCAPSED_STRING","'parent_id > :parent_id'",155],")",["T_WHITESPACE","\n                ",155],["T_OBJECT_OPERATOR","->",156],["T_STRING","where",156],"(",["T_CONSTANT_ENCAPSED_STRING","'user_id = :user_id'",156],")",["T_WHITESPACE","\n                ",156],["T_OBJECT_OPERATOR","->",157],["T_STRING","where",157],"(",["T_CONSTANT_ENCAPSED_STRING","'user_type = :user_type'",157],")",";",["T_WHITESPACE","\n\n            ",157],["T_VARIABLE","$binds",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],"[",["T_CONSTANT_ENCAPSED_STRING","'parent_id'",159],["T_WHITESPACE"," ",159],["T_DOUBLE_ARROW","=>",159],["T_WHITESPACE"," ",159],["T_LNUMBER","0",159],",",["T_WHITESPACE"," ",159],["T_CONSTANT_ENCAPSED_STRING","'user_id'",159],["T_WHITESPACE"," ",159],["T_DOUBLE_ARROW","=>",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$userId",159],",",["T_WHITESPACE","\n                      ",159],["T_CONSTANT_ENCAPSED_STRING","'user_type'",160],["T_WHITESPACE"," ",160],["T_DOUBLE_ARROW","=>",160],["T_WHITESPACE"," ",160],["T_STRING","UserContextInterface",160],["T_DOUBLE_COLON","::",160],["T_STRING","USER_TYPE_ADMIN",160],["T_WHITESPACE","\n            ",160],"]",";",["T_WHITESPACE","\n\n            ",161],["T_RETURN","return",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$connection",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","fetchAll",163],"(",["T_VARIABLE","$select",163],",",["T_WHITESPACE"," ",163],["T_VARIABLE","$binds",163],")",";",["T_WHITESPACE","\n        ",163],"}",["T_WHITESPACE"," ",164],["T_ELSE","else",164],["T_WHITESPACE"," ",164],"{",["T_WHITESPACE","\n            ",164],["T_RETURN","return",165],["T_WHITESPACE"," ",165],["T_STRING","null",165],";",["T_WHITESPACE","\n        ",165],"}",["T_WHITESPACE","\n    ",166],"}",["T_WHITESPACE","\n\n    ",167],["T_DOC_COMMENT","\/**\n     * Unserialize user extra data after user save\n     *\n     * @param \\Magento\\Framework\\Model\\AbstractModel $user\n     * @return $this\n     *\/",169],["T_WHITESPACE","\n    ",174],["T_PROTECTED","protected",175],["T_WHITESPACE"," ",175],["T_FUNCTION","function",175],["T_WHITESPACE"," ",175],["T_STRING","_afterSave",175],"(",["T_NS_SEPARATOR","\\",175],["T_STRING","Magento",175],["T_NS_SEPARATOR","\\",175],["T_STRING","Framework",175],["T_NS_SEPARATOR","\\",175],["T_STRING","Model",175],["T_NS_SEPARATOR","\\",175],["T_STRING","AbstractModel",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$user",175],")",["T_WHITESPACE","\n    ",175],"{",["T_WHITESPACE","\n        ",176],["T_VARIABLE","$user",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","setExtra",177],"(",["T_STRING","unserialize",177],"(",["T_VARIABLE","$user",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","getExtra",177],"(",")",")",")",";",["T_WHITESPACE","\n        ",177],["T_IF","if",178],["T_WHITESPACE"," ",178],"(",["T_VARIABLE","$user",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","hasRoleId",178],"(",")",")",["T_WHITESPACE"," ",178],"{",["T_WHITESPACE","\n            ",178],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","_clearUserRoles",179],"(",["T_VARIABLE","$user",179],")",";",["T_WHITESPACE","\n            ",179],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","_createUserRole",180],"(",["T_VARIABLE","$user",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","getRoleId",180],"(",")",",",["T_WHITESPACE"," ",180],["T_VARIABLE","$user",180],")",";",["T_WHITESPACE","\n        ",180],"}",["T_WHITESPACE","\n        ",181],["T_RETURN","return",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$this",182],";",["T_WHITESPACE","\n    ",182],"}",["T_WHITESPACE","\n\n    ",183],["T_DOC_COMMENT","\/**\n     * Clear all user-specific roles of provided user\n     *\n     * @param ModelUser $user\n     * @return void\n     *\/",185],["T_WHITESPACE","\n    ",190],["T_PUBLIC","public",191],["T_WHITESPACE"," ",191],["T_FUNCTION","function",191],["T_WHITESPACE"," ",191],["T_STRING","_clearUserRoles",191],"(",["T_STRING","ModelUser",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$user",191],")",["T_WHITESPACE","\n    ",191],"{",["T_WHITESPACE","\n        ",192],["T_VARIABLE","$conditions",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],"[",["T_CONSTANT_ENCAPSED_STRING","'user_id = ?'",193],["T_WHITESPACE"," ",193],["T_DOUBLE_ARROW","=>",193],["T_WHITESPACE"," ",193],["T_INT_CAST","(int)",193],["T_VARIABLE","$user",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","getId",193],"(",")",",",["T_WHITESPACE"," ",193],["T_CONSTANT_ENCAPSED_STRING","'user_type = ?'",193],["T_WHITESPACE"," ",193],["T_DOUBLE_ARROW","=>",193],["T_WHITESPACE"," ",193],["T_STRING","UserContextInterface",193],["T_DOUBLE_COLON","::",193],["T_STRING","USER_TYPE_ADMIN",193],"]",";",["T_WHITESPACE","\n        ",193],["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","getConnection",194],"(",")",["T_OBJECT_OPERATOR","->",194],["T_STRING","delete",194],"(",["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","getTable",194],"(",["T_CONSTANT_ENCAPSED_STRING","'authorization_role'",194],")",",",["T_WHITESPACE"," ",194],["T_VARIABLE","$conditions",194],")",";",["T_WHITESPACE","\n    ",194],"}",["T_WHITESPACE","\n\n    ",195],["T_DOC_COMMENT","\/**\n     * Create role for provided user of provided type\n     *\n     * @param int $parentId\n     * @param ModelUser $user\n     * @return void\n     *\/",197],["T_WHITESPACE","\n    ",203],["T_PROTECTED","protected",204],["T_WHITESPACE"," ",204],["T_FUNCTION","function",204],["T_WHITESPACE"," ",204],["T_STRING","_createUserRole",204],"(",["T_VARIABLE","$parentId",204],",",["T_WHITESPACE"," ",204],["T_STRING","ModelUser",204],["T_WHITESPACE"," ",204],["T_VARIABLE","$user",204],")",["T_WHITESPACE","\n    ",204],"{",["T_WHITESPACE","\n        ",205],["T_IF","if",206],["T_WHITESPACE"," ",206],"(",["T_VARIABLE","$parentId",206],["T_WHITESPACE"," ",206],">",["T_WHITESPACE"," ",206],["T_LNUMBER","0",206],")",["T_WHITESPACE"," ",206],"{",["T_WHITESPACE","\n            ",206],["T_DOC_COMMENT","\/** @var \\Magento\\Authorization\\Model\\Role $parentRole *\/",207],["T_WHITESPACE","\n            ",207],["T_VARIABLE","$parentRole",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","_roleFactory",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","create",208],"(",")",["T_OBJECT_OPERATOR","->",208],["T_STRING","load",208],"(",["T_VARIABLE","$parentId",208],")",";",["T_WHITESPACE","\n        ",208],"}",["T_WHITESPACE"," ",209],["T_ELSE","else",209],["T_WHITESPACE"," ",209],"{",["T_WHITESPACE","\n            ",209],["T_VARIABLE","$role",210],["T_WHITESPACE"," ",210],"=",["T_WHITESPACE"," ",210],["T_NEW","new",210],["T_WHITESPACE"," ",210],["T_NS_SEPARATOR","\\",210],["T_STRING","Magento",210],["T_NS_SEPARATOR","\\",210],["T_STRING","Framework",210],["T_NS_SEPARATOR","\\",210],["T_STRING","DataObject",210],"(",")",";",["T_WHITESPACE","\n            ",210],["T_VARIABLE","$role",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","setTreeLevel",211],"(",["T_LNUMBER","0",211],")",";",["T_WHITESPACE","\n        ",211],"}",["T_WHITESPACE","\n\n        ",212],["T_IF","if",214],["T_WHITESPACE"," ",214],"(",["T_VARIABLE","$parentRole",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","getId",214],"(",")",")",["T_WHITESPACE"," ",214],"{",["T_WHITESPACE","\n            ",214],["T_VARIABLE","$data",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_NEW","new",215],["T_WHITESPACE"," ",215],["T_NS_SEPARATOR","\\",215],["T_STRING","Magento",215],["T_NS_SEPARATOR","\\",215],["T_STRING","Framework",215],["T_NS_SEPARATOR","\\",215],["T_STRING","DataObject",215],"(",["T_WHITESPACE","\n                ",215],"[",["T_WHITESPACE","\n                    ",216],["T_CONSTANT_ENCAPSED_STRING","'parent_id'",217],["T_WHITESPACE"," ",217],["T_DOUBLE_ARROW","=>",217],["T_WHITESPACE"," ",217],["T_VARIABLE","$parentRole",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","getId",217],"(",")",",",["T_WHITESPACE","\n                    ",217],["T_CONSTANT_ENCAPSED_STRING","'tree_level'",218],["T_WHITESPACE"," ",218],["T_DOUBLE_ARROW","=>",218],["T_WHITESPACE"," ",218],["T_VARIABLE","$parentRole",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","getTreeLevel",218],"(",")",["T_WHITESPACE"," ",218],"+",["T_WHITESPACE"," ",218],["T_LNUMBER","1",218],",",["T_WHITESPACE","\n                    ",218],["T_CONSTANT_ENCAPSED_STRING","'sort_order'",219],["T_WHITESPACE"," ",219],["T_DOUBLE_ARROW","=>",219],["T_WHITESPACE"," ",219],["T_LNUMBER","0",219],",",["T_WHITESPACE","\n                    ",219],["T_CONSTANT_ENCAPSED_STRING","'role_type'",220],["T_WHITESPACE"," ",220],["T_DOUBLE_ARROW","=>",220],["T_WHITESPACE"," ",220],["T_STRING","RoleUser",220],["T_DOUBLE_COLON","::",220],["T_STRING","ROLE_TYPE",220],",",["T_WHITESPACE","\n                    ",220],["T_CONSTANT_ENCAPSED_STRING","'user_id'",221],["T_WHITESPACE"," ",221],["T_DOUBLE_ARROW","=>",221],["T_WHITESPACE"," ",221],["T_VARIABLE","$user",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","getId",221],"(",")",",",["T_WHITESPACE","\n                    ",221],["T_CONSTANT_ENCAPSED_STRING","'user_type'",222],["T_WHITESPACE"," ",222],["T_DOUBLE_ARROW","=>",222],["T_WHITESPACE"," ",222],["T_STRING","UserContextInterface",222],["T_DOUBLE_COLON","::",222],["T_STRING","USER_TYPE_ADMIN",222],",",["T_WHITESPACE","\n                    ",222],["T_CONSTANT_ENCAPSED_STRING","'role_name'",223],["T_WHITESPACE"," ",223],["T_DOUBLE_ARROW","=>",223],["T_WHITESPACE"," ",223],["T_VARIABLE","$user",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","getFirstname",223],"(",")",",",["T_WHITESPACE","\n                ",223],"]",["T_WHITESPACE","\n            ",224],")",";",["T_WHITESPACE","\n\n            ",225],["T_VARIABLE","$insertData",227],["T_WHITESPACE"," ",227],"=",["T_WHITESPACE"," ",227],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","_prepareDataForTable",227],"(",["T_VARIABLE","$data",227],",",["T_WHITESPACE"," ",227],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","getTable",227],"(",["T_CONSTANT_ENCAPSED_STRING","'authorization_role'",227],")",")",";",["T_WHITESPACE","\n            ",227],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getConnection",228],"(",")",["T_OBJECT_OPERATOR","->",228],["T_STRING","insert",228],"(",["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getTable",228],"(",["T_CONSTANT_ENCAPSED_STRING","'authorization_role'",228],")",",",["T_WHITESPACE"," ",228],["T_VARIABLE","$insertData",228],")",";",["T_WHITESPACE","\n            ",228],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","aclDataCache",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","clean",229],"(",")",";",["T_WHITESPACE","\n        ",229],"}",["T_WHITESPACE","\n    ",230],"}",["T_WHITESPACE","\n\n    ",231],["T_DOC_COMMENT","\/**\n     * Unserialize user extra data after user load\n     *\n     * @param \\Magento\\Framework\\Model\\AbstractModel $user\n     * @return $this\n     *\/",233],["T_WHITESPACE","\n    ",238],["T_PROTECTED","protected",239],["T_WHITESPACE"," ",239],["T_FUNCTION","function",239],["T_WHITESPACE"," ",239],["T_STRING","_afterLoad",239],"(",["T_NS_SEPARATOR","\\",239],["T_STRING","Magento",239],["T_NS_SEPARATOR","\\",239],["T_STRING","Framework",239],["T_NS_SEPARATOR","\\",239],["T_STRING","Model",239],["T_NS_SEPARATOR","\\",239],["T_STRING","AbstractModel",239],["T_WHITESPACE"," ",239],["T_VARIABLE","$user",239],")",["T_WHITESPACE","\n    ",239],"{",["T_WHITESPACE","\n        ",240],["T_IF","if",241],["T_WHITESPACE"," ",241],"(",["T_STRING","is_string",241],"(",["T_VARIABLE","$user",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","getExtra",241],"(",")",")",")",["T_WHITESPACE"," ",241],"{",["T_WHITESPACE","\n            ",241],["T_VARIABLE","$user",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","setExtra",242],"(",["T_STRING","unserialize",242],"(",["T_VARIABLE","$user",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","getExtra",242],"(",")",")",")",";",["T_WHITESPACE","\n        ",242],"}",["T_WHITESPACE","\n        ",243],["T_RETURN","return",244],["T_WHITESPACE"," ",244],["T_STRING","parent",244],["T_DOUBLE_COLON","::",244],["T_STRING","_afterLoad",244],"(",["T_VARIABLE","$user",244],")",";",["T_WHITESPACE","\n    ",244],"}",["T_WHITESPACE","\n\n    ",245],["T_DOC_COMMENT","\/**\n     * Delete user role record with user\n     *\n     * @param \\Magento\\Framework\\Model\\AbstractModel $user\n     * @return bool\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     *\/",247],["T_WHITESPACE","\n    ",253],["T_PUBLIC","public",254],["T_WHITESPACE"," ",254],["T_FUNCTION","function",254],["T_WHITESPACE"," ",254],["T_STRING","delete",254],"(",["T_NS_SEPARATOR","\\",254],["T_STRING","Magento",254],["T_NS_SEPARATOR","\\",254],["T_STRING","Framework",254],["T_NS_SEPARATOR","\\",254],["T_STRING","Model",254],["T_NS_SEPARATOR","\\",254],["T_STRING","AbstractModel",254],["T_WHITESPACE"," ",254],["T_VARIABLE","$user",254],")",["T_WHITESPACE","\n    ",254],"{",["T_WHITESPACE","\n        ",255],["T_VARIABLE","$this",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","_beforeDelete",256],"(",["T_VARIABLE","$user",256],")",";",["T_WHITESPACE","\n        ",256],["T_VARIABLE","$connection",257],["T_WHITESPACE"," ",257],"=",["T_WHITESPACE"," ",257],["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","getConnection",257],"(",")",";",["T_WHITESPACE","\n\n        ",257],["T_VARIABLE","$uid",259],["T_WHITESPACE"," ",259],"=",["T_WHITESPACE"," ",259],["T_VARIABLE","$user",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","getId",259],"(",")",";",["T_WHITESPACE","\n        ",259],["T_VARIABLE","$connection",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","beginTransaction",260],"(",")",";",["T_WHITESPACE","\n        ",260],["T_TRY","try",261],["T_WHITESPACE"," ",261],"{",["T_WHITESPACE","\n            ",261],["T_VARIABLE","$connection",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","delete",262],"(",["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","getMainTable",262],"(",")",",",["T_WHITESPACE"," ",262],"[",["T_CONSTANT_ENCAPSED_STRING","'user_id = ?'",262],["T_WHITESPACE"," ",262],["T_DOUBLE_ARROW","=>",262],["T_WHITESPACE"," ",262],["T_VARIABLE","$uid",262],"]",")",";",["T_WHITESPACE","\n            ",262],["T_VARIABLE","$connection",263],["T_OBJECT_OPERATOR","->",263],["T_STRING","delete",263],"(",["T_WHITESPACE","\n                ",263],["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","getTable",264],"(",["T_CONSTANT_ENCAPSED_STRING","'authorization_role'",264],")",",",["T_WHITESPACE","\n                ",264],"[",["T_CONSTANT_ENCAPSED_STRING","'user_id = ?'",265],["T_WHITESPACE"," ",265],["T_DOUBLE_ARROW","=>",265],["T_WHITESPACE"," ",265],["T_VARIABLE","$uid",265],",",["T_WHITESPACE"," ",265],["T_CONSTANT_ENCAPSED_STRING","'user_type = ?'",265],["T_WHITESPACE"," ",265],["T_DOUBLE_ARROW","=>",265],["T_WHITESPACE"," ",265],["T_STRING","UserContextInterface",265],["T_DOUBLE_COLON","::",265],["T_STRING","USER_TYPE_ADMIN",265],"]",["T_WHITESPACE","\n            ",265],")",";",["T_WHITESPACE","\n        ",266],"}",["T_WHITESPACE"," ",267],["T_CATCH","catch",267],["T_WHITESPACE"," ",267],"(",["T_NS_SEPARATOR","\\",267],["T_STRING","Magento",267],["T_NS_SEPARATOR","\\",267],["T_STRING","Framework",267],["T_NS_SEPARATOR","\\",267],["T_STRING","Exception",267],["T_NS_SEPARATOR","\\",267],["T_STRING","LocalizedException",267],["T_WHITESPACE"," ",267],["T_VARIABLE","$e",267],")",["T_WHITESPACE"," ",267],"{",["T_WHITESPACE","\n            ",267],["T_THROW","throw",268],["T_WHITESPACE"," ",268],["T_VARIABLE","$e",268],";",["T_WHITESPACE","\n        ",268],"}",["T_WHITESPACE"," ",269],["T_CATCH","catch",269],["T_WHITESPACE"," ",269],"(",["T_NS_SEPARATOR","\\",269],["T_STRING","Exception",269],["T_WHITESPACE"," ",269],["T_VARIABLE","$e",269],")",["T_WHITESPACE"," ",269],"{",["T_WHITESPACE","\n            ",269],["T_VARIABLE","$connection",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","rollBack",270],"(",")",";",["T_WHITESPACE","\n            ",270],["T_RETURN","return",271],["T_WHITESPACE"," ",271],["T_STRING","false",271],";",["T_WHITESPACE","\n        ",271],"}",["T_WHITESPACE","\n        ",272],["T_VARIABLE","$connection",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","commit",273],"(",")",";",["T_WHITESPACE","\n        ",273],["T_VARIABLE","$this",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","_afterDelete",274],"(",["T_VARIABLE","$user",274],")",";",["T_WHITESPACE","\n        ",274],["T_RETURN","return",275],["T_WHITESPACE"," ",275],["T_STRING","true",275],";",["T_WHITESPACE","\n    ",275],"}",["T_WHITESPACE","\n\n    ",276],["T_DOC_COMMENT","\/**\n     * Get user roles\n     *\n     * @param \\Magento\\Framework\\Model\\AbstractModel $user\n     * @return array\n     *\/",278],["T_WHITESPACE","\n    ",283],["T_PUBLIC","public",284],["T_WHITESPACE"," ",284],["T_FUNCTION","function",284],["T_WHITESPACE"," ",284],["T_STRING","getRoles",284],"(",["T_NS_SEPARATOR","\\",284],["T_STRING","Magento",284],["T_NS_SEPARATOR","\\",284],["T_STRING","Framework",284],["T_NS_SEPARATOR","\\",284],["T_STRING","Model",284],["T_NS_SEPARATOR","\\",284],["T_STRING","AbstractModel",284],["T_WHITESPACE"," ",284],["T_VARIABLE","$user",284],")",["T_WHITESPACE","\n    ",284],"{",["T_WHITESPACE","\n        ",285],["T_IF","if",286],["T_WHITESPACE"," ",286],"(","!",["T_VARIABLE","$user",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","getId",286],"(",")",")",["T_WHITESPACE"," ",286],"{",["T_WHITESPACE","\n            ",286],["T_RETURN","return",287],["T_WHITESPACE"," ",287],"[","]",";",["T_WHITESPACE","\n        ",287],"}",["T_WHITESPACE","\n\n        ",288],["T_VARIABLE","$table",290],["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],["T_VARIABLE","$this",290],["T_OBJECT_OPERATOR","->",290],["T_STRING","getTable",290],"(",["T_CONSTANT_ENCAPSED_STRING","'authorization_role'",290],")",";",["T_WHITESPACE","\n        ",290],["T_VARIABLE","$connection",291],["T_WHITESPACE"," ",291],"=",["T_WHITESPACE"," ",291],["T_VARIABLE","$this",291],["T_OBJECT_OPERATOR","->",291],["T_STRING","getConnection",291],"(",")",";",["T_WHITESPACE","\n\n        ",291],["T_VARIABLE","$select",293],["T_WHITESPACE"," ",293],"=",["T_WHITESPACE"," ",293],["T_VARIABLE","$connection",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","select",293],"(",")",["T_OBJECT_OPERATOR","->",293],["T_STRING","from",293],"(",["T_WHITESPACE","\n            ",293],["T_VARIABLE","$table",294],",",["T_WHITESPACE","\n            ",294],"[","]",["T_WHITESPACE","\n        ",295],")",["T_OBJECT_OPERATOR","->",296],["T_STRING","joinLeft",296],"(",["T_WHITESPACE","\n            ",296],"[",["T_CONSTANT_ENCAPSED_STRING","'ar'",297],["T_WHITESPACE"," ",297],["T_DOUBLE_ARROW","=>",297],["T_WHITESPACE"," ",297],["T_VARIABLE","$table",297],"]",",",["T_WHITESPACE","\n            ",297],"\"",["T_ENCAPSED_AND_WHITESPACE","(ar.role_id = ",298],["T_CURLY_OPEN","{",298],["T_VARIABLE","$table",298],"}",["T_ENCAPSED_AND_WHITESPACE",".parent_id and ar.role_type = '",298],"\"",["T_WHITESPACE"," ",298],".",["T_WHITESPACE"," ",298],["T_STRING","RoleGroup",298],["T_DOUBLE_COLON","::",298],["T_STRING","ROLE_TYPE",298],["T_WHITESPACE"," ",298],".",["T_WHITESPACE"," ",298],["T_CONSTANT_ENCAPSED_STRING","\"')\"",298],",",["T_WHITESPACE","\n            ",298],"[",["T_CONSTANT_ENCAPSED_STRING","'role_id'",299],"]",["T_WHITESPACE","\n        ",299],")",["T_OBJECT_OPERATOR","->",300],["T_STRING","where",300],"(",["T_WHITESPACE","\n            ",300],"\"",["T_CURLY_OPEN","{",301],["T_VARIABLE","$table",301],"}",["T_ENCAPSED_AND_WHITESPACE",".user_id = :user_id",301],"\"",["T_WHITESPACE","\n        ",301],")",["T_OBJECT_OPERATOR","->",302],["T_STRING","where",302],"(",["T_WHITESPACE","\n            ",302],"\"",["T_CURLY_OPEN","{",303],["T_VARIABLE","$table",303],"}",["T_ENCAPSED_AND_WHITESPACE",".user_type = :user_type",303],"\"",["T_WHITESPACE","\n        ",303],")",";",["T_WHITESPACE","\n\n        ",304],["T_VARIABLE","$binds",306],["T_WHITESPACE"," ",306],"=",["T_WHITESPACE"," ",306],"[",["T_CONSTANT_ENCAPSED_STRING","'user_id'",306],["T_WHITESPACE"," ",306],["T_DOUBLE_ARROW","=>",306],["T_WHITESPACE"," ",306],["T_INT_CAST","(int)",306],["T_VARIABLE","$user",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","getId",306],"(",")",",",["T_WHITESPACE","\n                  ",306],["T_CONSTANT_ENCAPSED_STRING","'user_type'",307],["T_WHITESPACE"," ",307],["T_DOUBLE_ARROW","=>",307],["T_WHITESPACE"," ",307],["T_STRING","UserContextInterface",307],["T_DOUBLE_COLON","::",307],["T_STRING","USER_TYPE_ADMIN",307],["T_WHITESPACE","\n        ",307],"]",";",["T_WHITESPACE","\n\n        ",308],["T_VARIABLE","$roles",310],["T_WHITESPACE"," ",310],"=",["T_WHITESPACE"," ",310],["T_VARIABLE","$connection",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","fetchCol",310],"(",["T_VARIABLE","$select",310],",",["T_WHITESPACE"," ",310],["T_VARIABLE","$binds",310],")",";",["T_WHITESPACE","\n\n        ",310],["T_IF","if",312],["T_WHITESPACE"," ",312],"(",["T_VARIABLE","$roles",312],")",["T_WHITESPACE"," ",312],"{",["T_WHITESPACE","\n            ",312],["T_RETURN","return",313],["T_WHITESPACE"," ",313],["T_VARIABLE","$roles",313],";",["T_WHITESPACE","\n        ",313],"}",["T_WHITESPACE","\n\n        ",314],["T_RETURN","return",316],["T_WHITESPACE"," ",316],"[","]",";",["T_WHITESPACE","\n    ",316],"}",["T_WHITESPACE","\n\n    ",317],["T_DOC_COMMENT","\/**\n     * Delete user role\n     *\n     * @param \\Magento\\Framework\\Model\\AbstractModel $user\n     * @return $this\n     *\/",319],["T_WHITESPACE","\n    ",324],["T_PUBLIC","public",325],["T_WHITESPACE"," ",325],["T_FUNCTION","function",325],["T_WHITESPACE"," ",325],["T_STRING","deleteFromRole",325],"(",["T_NS_SEPARATOR","\\",325],["T_STRING","Magento",325],["T_NS_SEPARATOR","\\",325],["T_STRING","Framework",325],["T_NS_SEPARATOR","\\",325],["T_STRING","Model",325],["T_NS_SEPARATOR","\\",325],["T_STRING","AbstractModel",325],["T_WHITESPACE"," ",325],["T_VARIABLE","$user",325],")",["T_WHITESPACE","\n    ",325],"{",["T_WHITESPACE","\n        ",326],["T_IF","if",327],["T_WHITESPACE"," ",327],"(",["T_VARIABLE","$user",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","getUserId",327],"(",")",["T_WHITESPACE"," ",327],["T_IS_SMALLER_OR_EQUAL","<=",327],["T_WHITESPACE"," ",327],["T_LNUMBER","0",327],")",["T_WHITESPACE"," ",327],"{",["T_WHITESPACE","\n            ",327],["T_RETURN","return",328],["T_WHITESPACE"," ",328],["T_VARIABLE","$this",328],";",["T_WHITESPACE","\n        ",328],"}",["T_WHITESPACE","\n        ",329],["T_IF","if",330],["T_WHITESPACE"," ",330],"(",["T_VARIABLE","$user",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","getRoleId",330],"(",")",["T_WHITESPACE"," ",330],["T_IS_SMALLER_OR_EQUAL","<=",330],["T_WHITESPACE"," ",330],["T_LNUMBER","0",330],")",["T_WHITESPACE"," ",330],"{",["T_WHITESPACE","\n            ",330],["T_RETURN","return",331],["T_WHITESPACE"," ",331],["T_VARIABLE","$this",331],";",["T_WHITESPACE","\n        ",331],"}",["T_WHITESPACE","\n\n        ",332],["T_VARIABLE","$dbh",334],["T_WHITESPACE"," ",334],"=",["T_WHITESPACE"," ",334],["T_VARIABLE","$this",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","getConnection",334],"(",")",";",["T_WHITESPACE","\n\n        ",334],["T_VARIABLE","$condition",336],["T_WHITESPACE"," ",336],"=",["T_WHITESPACE"," ",336],"[",["T_WHITESPACE","\n            ",336],["T_CONSTANT_ENCAPSED_STRING","'user_id = ?'",337],["T_WHITESPACE"," ",337],["T_DOUBLE_ARROW","=>",337],["T_WHITESPACE"," ",337],["T_INT_CAST","(int)",337],["T_VARIABLE","$user",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","getId",337],"(",")",",",["T_WHITESPACE","\n            ",337],["T_CONSTANT_ENCAPSED_STRING","'parent_id = ?'",338],["T_WHITESPACE"," ",338],["T_DOUBLE_ARROW","=>",338],["T_WHITESPACE"," ",338],["T_INT_CAST","(int)",338],["T_VARIABLE","$user",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","getRoleId",338],"(",")",",",["T_WHITESPACE","\n            ",338],["T_CONSTANT_ENCAPSED_STRING","'user_type = ?'",339],["T_WHITESPACE"," ",339],["T_DOUBLE_ARROW","=>",339],["T_WHITESPACE"," ",339],["T_STRING","UserContextInterface",339],["T_DOUBLE_COLON","::",339],["T_STRING","USER_TYPE_ADMIN",339],["T_WHITESPACE","\n        ",339],"]",";",["T_WHITESPACE","\n\n        ",340],["T_VARIABLE","$dbh",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","delete",342],"(",["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","getTable",342],"(",["T_CONSTANT_ENCAPSED_STRING","'authorization_role'",342],")",",",["T_WHITESPACE"," ",342],["T_VARIABLE","$condition",342],")",";",["T_WHITESPACE","\n        ",342],["T_RETURN","return",343],["T_WHITESPACE"," ",343],["T_VARIABLE","$this",343],";",["T_WHITESPACE","\n    ",343],"}",["T_WHITESPACE","\n\n    ",344],["T_DOC_COMMENT","\/**\n     * Check if role user exists\n     *\n     * @param \\Magento\\Framework\\Model\\AbstractModel $user\n     * @return array\n     *\/",346],["T_WHITESPACE","\n    ",351],["T_PUBLIC","public",352],["T_WHITESPACE"," ",352],["T_FUNCTION","function",352],["T_WHITESPACE"," ",352],["T_STRING","roleUserExists",352],"(",["T_NS_SEPARATOR","\\",352],["T_STRING","Magento",352],["T_NS_SEPARATOR","\\",352],["T_STRING","Framework",352],["T_NS_SEPARATOR","\\",352],["T_STRING","Model",352],["T_NS_SEPARATOR","\\",352],["T_STRING","AbstractModel",352],["T_WHITESPACE"," ",352],["T_VARIABLE","$user",352],")",["T_WHITESPACE","\n    ",352],"{",["T_WHITESPACE","\n        ",353],["T_IF","if",354],["T_WHITESPACE"," ",354],"(",["T_VARIABLE","$user",354],["T_OBJECT_OPERATOR","->",354],["T_STRING","getUserId",354],"(",")",["T_WHITESPACE"," ",354],">",["T_WHITESPACE"," ",354],["T_LNUMBER","0",354],")",["T_WHITESPACE"," ",354],"{",["T_WHITESPACE","\n            ",354],["T_VARIABLE","$roleTable",355],["T_WHITESPACE"," ",355],"=",["T_WHITESPACE"," ",355],["T_VARIABLE","$this",355],["T_OBJECT_OPERATOR","->",355],["T_STRING","getTable",355],"(",["T_CONSTANT_ENCAPSED_STRING","'authorization_role'",355],")",";",["T_WHITESPACE","\n\n            ",355],["T_VARIABLE","$dbh",357],["T_WHITESPACE"," ",357],"=",["T_WHITESPACE"," ",357],["T_VARIABLE","$this",357],["T_OBJECT_OPERATOR","->",357],["T_STRING","getConnection",357],"(",")",";",["T_WHITESPACE","\n\n            ",357],["T_VARIABLE","$binds",359],["T_WHITESPACE"," ",359],"=",["T_WHITESPACE"," ",359],"[",["T_WHITESPACE","\n                ",359],["T_CONSTANT_ENCAPSED_STRING","'parent_id'",360],["T_WHITESPACE"," ",360],["T_DOUBLE_ARROW","=>",360],["T_WHITESPACE"," ",360],["T_VARIABLE","$user",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","getRoleId",360],"(",")",",",["T_WHITESPACE","\n                ",360],["T_CONSTANT_ENCAPSED_STRING","'user_id'",361],["T_WHITESPACE"," ",361],["T_DOUBLE_ARROW","=>",361],["T_WHITESPACE"," ",361],["T_VARIABLE","$user",361],["T_OBJECT_OPERATOR","->",361],["T_STRING","getUserId",361],"(",")",",",["T_WHITESPACE","\n                ",361],["T_CONSTANT_ENCAPSED_STRING","'user_type'",362],["T_WHITESPACE"," ",362],["T_DOUBLE_ARROW","=>",362],["T_WHITESPACE"," ",362],["T_STRING","UserContextInterface",362],["T_DOUBLE_COLON","::",362],["T_STRING","USER_TYPE_ADMIN",362],["T_WHITESPACE","\n            ",362],"]",";",["T_WHITESPACE","\n\n            ",363],["T_VARIABLE","$select",365],["T_WHITESPACE"," ",365],"=",["T_WHITESPACE"," ",365],["T_VARIABLE","$dbh",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","select",365],"(",")",["T_OBJECT_OPERATOR","->",365],["T_STRING","from",365],"(",["T_VARIABLE","$roleTable",365],")",["T_WHITESPACE","\n                ",365],["T_OBJECT_OPERATOR","->",366],["T_STRING","where",366],"(",["T_CONSTANT_ENCAPSED_STRING","'parent_id = :parent_id'",366],")",["T_WHITESPACE","\n                ",366],["T_OBJECT_OPERATOR","->",367],["T_STRING","where",367],"(",["T_CONSTANT_ENCAPSED_STRING","'user_type = :user_type'",367],")",["T_WHITESPACE","\n                ",367],["T_OBJECT_OPERATOR","->",368],["T_STRING","where",368],"(",["T_CONSTANT_ENCAPSED_STRING","'user_id = :user_id'",368],")",";",["T_WHITESPACE","\n\n            ",368],["T_RETURN","return",370],["T_WHITESPACE"," ",370],["T_VARIABLE","$dbh",370],["T_OBJECT_OPERATOR","->",370],["T_STRING","fetchCol",370],"(",["T_VARIABLE","$select",370],",",["T_WHITESPACE"," ",370],["T_VARIABLE","$binds",370],")",";",["T_WHITESPACE","\n        ",370],"}",["T_WHITESPACE"," ",371],["T_ELSE","else",371],["T_WHITESPACE"," ",371],"{",["T_WHITESPACE","\n            ",371],["T_RETURN","return",372],["T_WHITESPACE"," ",372],"[","]",";",["T_WHITESPACE","\n        ",372],"}",["T_WHITESPACE","\n    ",373],"}",["T_WHITESPACE","\n\n    ",374],["T_DOC_COMMENT","\/**\n     * Check if user exists\n     *\n     * @param \\Magento\\Framework\\Model\\AbstractModel $user\n     * @return array\n     *\/",376],["T_WHITESPACE","\n    ",381],["T_PUBLIC","public",382],["T_WHITESPACE"," ",382],["T_FUNCTION","function",382],["T_WHITESPACE"," ",382],["T_STRING","userExists",382],"(",["T_NS_SEPARATOR","\\",382],["T_STRING","Magento",382],["T_NS_SEPARATOR","\\",382],["T_STRING","Framework",382],["T_NS_SEPARATOR","\\",382],["T_STRING","Model",382],["T_NS_SEPARATOR","\\",382],["T_STRING","AbstractModel",382],["T_WHITESPACE"," ",382],["T_VARIABLE","$user",382],")",["T_WHITESPACE","\n    ",382],"{",["T_WHITESPACE","\n        ",383],["T_VARIABLE","$connection",384],["T_WHITESPACE"," ",384],"=",["T_WHITESPACE"," ",384],["T_VARIABLE","$this",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","getConnection",384],"(",")",";",["T_WHITESPACE","\n        ",384],["T_VARIABLE","$select",385],["T_WHITESPACE"," ",385],"=",["T_WHITESPACE"," ",385],["T_VARIABLE","$connection",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","select",385],"(",")",";",["T_WHITESPACE","\n\n        ",385],["T_VARIABLE","$binds",387],["T_WHITESPACE"," ",387],"=",["T_WHITESPACE"," ",387],"[",["T_WHITESPACE","\n            ",387],["T_CONSTANT_ENCAPSED_STRING","'username'",388],["T_WHITESPACE"," ",388],["T_DOUBLE_ARROW","=>",388],["T_WHITESPACE"," ",388],["T_VARIABLE","$user",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","getUsername",388],"(",")",",",["T_WHITESPACE","\n            ",388],["T_CONSTANT_ENCAPSED_STRING","'email'",389],["T_WHITESPACE"," ",389],["T_DOUBLE_ARROW","=>",389],["T_WHITESPACE"," ",389],["T_VARIABLE","$user",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","getEmail",389],"(",")",",",["T_WHITESPACE","\n            ",389],["T_CONSTANT_ENCAPSED_STRING","'user_id'",390],["T_WHITESPACE"," ",390],["T_DOUBLE_ARROW","=>",390],["T_WHITESPACE"," ",390],["T_INT_CAST","(int)",390],["T_VARIABLE","$user",390],["T_OBJECT_OPERATOR","->",390],["T_STRING","getId",390],"(",")",",",["T_WHITESPACE","\n        ",390],"]",";",["T_WHITESPACE","\n\n        ",391],["T_VARIABLE","$select",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","from",393],"(",["T_WHITESPACE","\n            ",393],["T_VARIABLE","$this",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","getMainTable",394],"(",")",["T_WHITESPACE","\n        ",394],")",["T_OBJECT_OPERATOR","->",395],["T_STRING","where",395],"(",["T_WHITESPACE","\n            ",395],["T_CONSTANT_ENCAPSED_STRING","'(username = :username OR email = :email)'",396],["T_WHITESPACE","\n        ",396],")",["T_OBJECT_OPERATOR","->",397],["T_STRING","where",397],"(",["T_WHITESPACE","\n            ",397],["T_CONSTANT_ENCAPSED_STRING","'user_id <> :user_id'",398],["T_WHITESPACE","\n        ",398],")",";",["T_WHITESPACE","\n\n        ",399],["T_RETURN","return",401],["T_WHITESPACE"," ",401],["T_VARIABLE","$connection",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","fetchRow",401],"(",["T_VARIABLE","$select",401],",",["T_WHITESPACE"," ",401],["T_VARIABLE","$binds",401],")",";",["T_WHITESPACE","\n    ",401],"}",["T_WHITESPACE","\n\n    ",402],["T_DOC_COMMENT","\/**\n     * Whether a user's identity is confirmed\n     *\n     * @param \\Magento\\Framework\\Model\\AbstractModel $user\n     * @return bool\n     *\/",404],["T_WHITESPACE","\n    ",409],["T_PUBLIC","public",410],["T_WHITESPACE"," ",410],["T_FUNCTION","function",410],["T_WHITESPACE"," ",410],["T_STRING","isUserUnique",410],"(",["T_NS_SEPARATOR","\\",410],["T_STRING","Magento",410],["T_NS_SEPARATOR","\\",410],["T_STRING","Framework",410],["T_NS_SEPARATOR","\\",410],["T_STRING","Model",410],["T_NS_SEPARATOR","\\",410],["T_STRING","AbstractModel",410],["T_WHITESPACE"," ",410],["T_VARIABLE","$user",410],")",["T_WHITESPACE","\n    ",410],"{",["T_WHITESPACE","\n        ",411],["T_RETURN","return",412],["T_WHITESPACE"," ",412],"!",["T_VARIABLE","$this",412],["T_OBJECT_OPERATOR","->",412],["T_STRING","userExists",412],"(",["T_VARIABLE","$user",412],")",";",["T_WHITESPACE","\n    ",412],"}",["T_WHITESPACE","\n\n    ",413],["T_DOC_COMMENT","\/**\n     * Save user extra data\n     *\n     * @param \\Magento\\Framework\\Model\\AbstractModel $object\n     * @param string $data\n     * @return $this\n     *\/",415],["T_WHITESPACE","\n    ",421],["T_PUBLIC","public",422],["T_WHITESPACE"," ",422],["T_FUNCTION","function",422],["T_WHITESPACE"," ",422],["T_STRING","saveExtra",422],"(",["T_VARIABLE","$object",422],",",["T_WHITESPACE"," ",422],["T_VARIABLE","$data",422],")",["T_WHITESPACE","\n    ",422],"{",["T_WHITESPACE","\n        ",423],["T_IF","if",424],["T_WHITESPACE"," ",424],"(",["T_VARIABLE","$object",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","getId",424],"(",")",")",["T_WHITESPACE"," ",424],"{",["T_WHITESPACE","\n            ",424],["T_VARIABLE","$this",425],["T_OBJECT_OPERATOR","->",425],["T_STRING","getConnection",425],"(",")",["T_OBJECT_OPERATOR","->",425],["T_STRING","update",425],"(",["T_WHITESPACE","\n                ",425],["T_VARIABLE","$this",426],["T_OBJECT_OPERATOR","->",426],["T_STRING","getMainTable",426],"(",")",",",["T_WHITESPACE","\n                ",426],"[",["T_CONSTANT_ENCAPSED_STRING","'extra'",427],["T_WHITESPACE"," ",427],["T_DOUBLE_ARROW","=>",427],["T_WHITESPACE"," ",427],["T_VARIABLE","$data",427],"]",",",["T_WHITESPACE","\n                ",427],"[",["T_CONSTANT_ENCAPSED_STRING","'user_id = ?'",428],["T_WHITESPACE"," ",428],["T_DOUBLE_ARROW","=>",428],["T_WHITESPACE"," ",428],["T_INT_CAST","(int)",428],["T_VARIABLE","$object",428],["T_OBJECT_OPERATOR","->",428],["T_STRING","getId",428],"(",")","]",["T_WHITESPACE","\n            ",428],")",";",["T_WHITESPACE","\n        ",429],"}",["T_WHITESPACE","\n\n        ",430],["T_RETURN","return",432],["T_WHITESPACE"," ",432],["T_VARIABLE","$this",432],";",["T_WHITESPACE","\n    ",432],"}",["T_WHITESPACE","\n\n    ",433],["T_DOC_COMMENT","\/**\n     * Retrieve the total user count bypassing any filters applied to collections\n     *\n     * @return int\n     *\/",435],["T_WHITESPACE","\n    ",439],["T_PUBLIC","public",440],["T_WHITESPACE"," ",440],["T_FUNCTION","function",440],["T_WHITESPACE"," ",440],["T_STRING","countAll",440],"(",")",["T_WHITESPACE","\n    ",440],"{",["T_WHITESPACE","\n        ",441],["T_VARIABLE","$connection",442],["T_WHITESPACE"," ",442],"=",["T_WHITESPACE"," ",442],["T_VARIABLE","$this",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","getConnection",442],"(",")",";",["T_WHITESPACE","\n        ",442],["T_VARIABLE","$select",443],["T_WHITESPACE"," ",443],"=",["T_WHITESPACE"," ",443],["T_VARIABLE","$connection",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","select",443],"(",")",";",["T_WHITESPACE","\n        ",443],["T_VARIABLE","$select",444],["T_OBJECT_OPERATOR","->",444],["T_STRING","from",444],"(",["T_VARIABLE","$this",444],["T_OBJECT_OPERATOR","->",444],["T_STRING","getMainTable",444],"(",")",",",["T_WHITESPACE"," ",444],["T_CONSTANT_ENCAPSED_STRING","'COUNT(*)'",444],")",";",["T_WHITESPACE","\n        ",444],["T_VARIABLE","$result",445],["T_WHITESPACE"," ",445],"=",["T_WHITESPACE"," ",445],["T_INT_CAST","(int)",445],["T_VARIABLE","$connection",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","fetchOne",445],"(",["T_VARIABLE","$select",445],")",";",["T_WHITESPACE","\n        ",445],["T_RETURN","return",446],["T_WHITESPACE"," ",446],["T_VARIABLE","$result",446],";",["T_WHITESPACE","\n    ",446],"}",["T_WHITESPACE","\n\n    ",447],["T_DOC_COMMENT","\/**\n     * Add validation rules to be applied before saving an entity\n     *\n     * @return \\Zend_Validate_Interface $validator\n     *\/",449],["T_WHITESPACE","\n    ",453],["T_PUBLIC","public",454],["T_WHITESPACE"," ",454],["T_FUNCTION","function",454],["T_WHITESPACE"," ",454],["T_STRING","getValidationRulesBeforeSave",454],"(",")",["T_WHITESPACE","\n    ",454],"{",["T_WHITESPACE","\n        ",455],["T_VARIABLE","$userIdentity",456],["T_WHITESPACE"," ",456],"=",["T_WHITESPACE"," ",456],["T_NEW","new",456],["T_WHITESPACE"," ",456],["T_NS_SEPARATOR","\\",456],["T_STRING","Zend_Validate_Callback",456],"(","[",["T_VARIABLE","$this",456],",",["T_WHITESPACE"," ",456],["T_CONSTANT_ENCAPSED_STRING","'isUserUnique'",456],"]",")",";",["T_WHITESPACE","\n        ",456],["T_VARIABLE","$userIdentity",457],["T_OBJECT_OPERATOR","->",457],["T_STRING","setMessage",457],"(",["T_WHITESPACE","\n            ",457],["T_STRING","__",458],"(",["T_CONSTANT_ENCAPSED_STRING","'A user with the same user name or email already exists.'",458],")",",",["T_WHITESPACE","\n            ",458],["T_NS_SEPARATOR","\\",459],["T_STRING","Zend_Validate_Callback",459],["T_DOUBLE_COLON","::",459],["T_STRING","INVALID_VALUE",459],["T_WHITESPACE","\n        ",459],")",";",["T_WHITESPACE","\n\n        ",460],["T_RETURN","return",462],["T_WHITESPACE"," ",462],["T_VARIABLE","$userIdentity",462],";",["T_WHITESPACE","\n    ",462],"}",["T_WHITESPACE","\n\n    ",463],["T_DOC_COMMENT","\/**\n     * Update role users ACL\n     *\n     * @param \\Magento\\Authorization\\Model\\Role $role\n     * @return bool\n     *\/",465],["T_WHITESPACE","\n    ",470],["T_PUBLIC","public",471],["T_WHITESPACE"," ",471],["T_FUNCTION","function",471],["T_WHITESPACE"," ",471],["T_STRING","updateRoleUsersAcl",471],"(",["T_NS_SEPARATOR","\\",471],["T_STRING","Magento",471],["T_NS_SEPARATOR","\\",471],["T_STRING","Authorization",471],["T_NS_SEPARATOR","\\",471],["T_STRING","Model",471],["T_NS_SEPARATOR","\\",471],["T_STRING","Role",471],["T_WHITESPACE"," ",471],["T_VARIABLE","$role",471],")",["T_WHITESPACE","\n    ",471],"{",["T_WHITESPACE","\n        ",472],["T_VARIABLE","$connection",473],["T_WHITESPACE"," ",473],"=",["T_WHITESPACE"," ",473],["T_VARIABLE","$this",473],["T_OBJECT_OPERATOR","->",473],["T_STRING","getConnection",473],"(",")",";",["T_WHITESPACE","\n        ",473],["T_VARIABLE","$users",474],["T_WHITESPACE"," ",474],"=",["T_WHITESPACE"," ",474],["T_VARIABLE","$role",474],["T_OBJECT_OPERATOR","->",474],["T_STRING","getRoleUsers",474],"(",")",";",["T_WHITESPACE","\n        ",474],["T_VARIABLE","$rowsCount",475],["T_WHITESPACE"," ",475],"=",["T_WHITESPACE"," ",475],["T_LNUMBER","0",475],";",["T_WHITESPACE","\n\n        ",475],["T_IF","if",477],["T_WHITESPACE"," ",477],"(",["T_STRING","sizeof",477],"(",["T_VARIABLE","$users",477],")",["T_WHITESPACE"," ",477],">",["T_WHITESPACE"," ",477],["T_LNUMBER","0",477],")",["T_WHITESPACE"," ",477],"{",["T_WHITESPACE","\n            ",477],["T_VARIABLE","$bind",478],["T_WHITESPACE"," ",478],"=",["T_WHITESPACE"," ",478],"[",["T_CONSTANT_ENCAPSED_STRING","'reload_acl_flag'",478],["T_WHITESPACE"," ",478],["T_DOUBLE_ARROW","=>",478],["T_WHITESPACE"," ",478],["T_LNUMBER","1",478],"]",";",["T_WHITESPACE","\n            ",478],["T_VARIABLE","$where",479],["T_WHITESPACE"," ",479],"=",["T_WHITESPACE"," ",479],"[",["T_CONSTANT_ENCAPSED_STRING","'user_id IN(?)'",479],["T_WHITESPACE"," ",479],["T_DOUBLE_ARROW","=>",479],["T_WHITESPACE"," ",479],["T_VARIABLE","$users",479],"]",";",["T_WHITESPACE","\n            ",479],["T_VARIABLE","$rowsCount",480],["T_WHITESPACE"," ",480],"=",["T_WHITESPACE"," ",480],["T_VARIABLE","$connection",480],["T_OBJECT_OPERATOR","->",480],["T_STRING","update",480],"(",["T_VARIABLE","$this",480],["T_OBJECT_OPERATOR","->",480],["T_STRING","getTable",480],"(",["T_CONSTANT_ENCAPSED_STRING","'admin_user'",480],")",",",["T_WHITESPACE"," ",480],["T_VARIABLE","$bind",480],",",["T_WHITESPACE"," ",480],["T_VARIABLE","$where",480],")",";",["T_WHITESPACE","\n        ",480],"}",["T_WHITESPACE","\n\n        ",481],["T_RETURN","return",483],["T_WHITESPACE"," ",483],["T_VARIABLE","$rowsCount",483],["T_WHITESPACE"," ",483],">",["T_WHITESPACE"," ",483],["T_LNUMBER","0",483],";",["T_WHITESPACE","\n    ",483],"}",["T_WHITESPACE","\n\n    ",484],["T_DOC_COMMENT","\/**\n     * Unlock specified user record(s)\n     *\n     * @param int|int[] $userIds\n     * @return int number of affected rows\n     *\/",486],["T_WHITESPACE","\n    ",491],["T_PUBLIC","public",492],["T_WHITESPACE"," ",492],["T_FUNCTION","function",492],["T_WHITESPACE"," ",492],["T_STRING","unlock",492],"(",["T_VARIABLE","$userIds",492],")",["T_WHITESPACE","\n    ",492],"{",["T_WHITESPACE","\n        ",493],["T_IF","if",494],["T_WHITESPACE"," ",494],"(","!",["T_STRING","is_array",494],"(",["T_VARIABLE","$userIds",494],")",")",["T_WHITESPACE"," ",494],"{",["T_WHITESPACE","\n            ",494],["T_VARIABLE","$userIds",495],["T_WHITESPACE"," ",495],"=",["T_WHITESPACE"," ",495],"[",["T_VARIABLE","$userIds",495],"]",";",["T_WHITESPACE","\n        ",495],"}",["T_WHITESPACE","\n        ",496],["T_RETURN","return",497],["T_WHITESPACE"," ",497],["T_VARIABLE","$this",497],["T_OBJECT_OPERATOR","->",497],["T_STRING","getConnection",497],"(",")",["T_OBJECT_OPERATOR","->",497],["T_STRING","update",497],"(",["T_WHITESPACE","\n            ",497],["T_VARIABLE","$this",498],["T_OBJECT_OPERATOR","->",498],["T_STRING","getMainTable",498],"(",")",",",["T_WHITESPACE","\n            ",498],"[",["T_CONSTANT_ENCAPSED_STRING","'failures_num'",499],["T_WHITESPACE"," ",499],["T_DOUBLE_ARROW","=>",499],["T_WHITESPACE"," ",499],["T_LNUMBER","0",499],",",["T_WHITESPACE"," ",499],["T_CONSTANT_ENCAPSED_STRING","'first_failure'",499],["T_WHITESPACE"," ",499],["T_DOUBLE_ARROW","=>",499],["T_WHITESPACE"," ",499],["T_STRING","null",499],",",["T_WHITESPACE"," ",499],["T_CONSTANT_ENCAPSED_STRING","'lock_expires'",499],["T_WHITESPACE"," ",499],["T_DOUBLE_ARROW","=>",499],["T_WHITESPACE"," ",499],["T_STRING","null",499],"]",",",["T_WHITESPACE","\n            ",499],["T_VARIABLE","$this",500],["T_OBJECT_OPERATOR","->",500],["T_STRING","getIdFieldName",500],"(",")",["T_WHITESPACE"," ",500],".",["T_WHITESPACE"," ",500],["T_CONSTANT_ENCAPSED_STRING","' IN ('",500],["T_WHITESPACE"," ",500],".",["T_WHITESPACE"," ",500],["T_VARIABLE","$this",500],["T_OBJECT_OPERATOR","->",500],["T_STRING","getConnection",500],"(",")",["T_OBJECT_OPERATOR","->",500],["T_STRING","quote",500],"(",["T_VARIABLE","$userIds",500],")",["T_WHITESPACE"," ",500],".",["T_WHITESPACE"," ",500],["T_CONSTANT_ENCAPSED_STRING","')'",500],["T_WHITESPACE","\n        ",500],")",";",["T_WHITESPACE","\n    ",501],"}",["T_WHITESPACE","\n\n    ",502],["T_DOC_COMMENT","\/**\n     * Lock specified user record(s)\n     *\n     * @param int|int[] $userIds\n     * @param int $exceptId\n     * @param int $lifetime\n     * @return int number of affected rows\n     *\/",504],["T_WHITESPACE","\n    ",511],["T_PUBLIC","public",512],["T_WHITESPACE"," ",512],["T_FUNCTION","function",512],["T_WHITESPACE"," ",512],["T_STRING","lock",512],"(",["T_VARIABLE","$userIds",512],",",["T_WHITESPACE"," ",512],["T_VARIABLE","$exceptId",512],",",["T_WHITESPACE"," ",512],["T_VARIABLE","$lifetime",512],")",["T_WHITESPACE","\n    ",512],"{",["T_WHITESPACE","\n        ",513],["T_IF","if",514],["T_WHITESPACE"," ",514],"(","!",["T_STRING","is_array",514],"(",["T_VARIABLE","$userIds",514],")",")",["T_WHITESPACE"," ",514],"{",["T_WHITESPACE","\n            ",514],["T_VARIABLE","$userIds",515],["T_WHITESPACE"," ",515],"=",["T_WHITESPACE"," ",515],"[",["T_VARIABLE","$userIds",515],"]",";",["T_WHITESPACE","\n        ",515],"}",["T_WHITESPACE","\n        ",516],["T_VARIABLE","$exceptId",517],["T_WHITESPACE"," ",517],"=",["T_WHITESPACE"," ",517],["T_INT_CAST","(int)",517],["T_VARIABLE","$exceptId",517],";",["T_WHITESPACE","\n        ",517],["T_RETURN","return",518],["T_WHITESPACE"," ",518],["T_VARIABLE","$this",518],["T_OBJECT_OPERATOR","->",518],["T_STRING","getConnection",518],"(",")",["T_OBJECT_OPERATOR","->",518],["T_STRING","update",518],"(",["T_WHITESPACE","\n            ",518],["T_VARIABLE","$this",519],["T_OBJECT_OPERATOR","->",519],["T_STRING","getMainTable",519],"(",")",",",["T_WHITESPACE","\n            ",519],"[",["T_CONSTANT_ENCAPSED_STRING","'lock_expires'",520],["T_WHITESPACE"," ",520],["T_DOUBLE_ARROW","=>",520],["T_WHITESPACE"," ",520],["T_VARIABLE","$this",520],["T_OBJECT_OPERATOR","->",520],["T_STRING","dateTime",520],["T_OBJECT_OPERATOR","->",520],["T_STRING","formatDate",520],"(",["T_STRING","time",520],"(",")",["T_WHITESPACE"," ",520],"+",["T_WHITESPACE"," ",520],["T_VARIABLE","$lifetime",520],")","]",",",["T_WHITESPACE","\n            ",520],"\"",["T_CURLY_OPEN","{",521],["T_VARIABLE","$this",521],["T_OBJECT_OPERATOR","->",521],["T_STRING","getIdFieldName",521],"(",")","}",["T_ENCAPSED_AND_WHITESPACE"," IN (",521],"\"",["T_WHITESPACE"," ",521],".",["T_WHITESPACE"," ",521],["T_VARIABLE","$this",521],["T_OBJECT_OPERATOR","->",521],["T_STRING","getConnection",521],"(",")",["T_OBJECT_OPERATOR","->",521],["T_STRING","quote",521],"(",["T_WHITESPACE","\n                ",521],["T_VARIABLE","$userIds",522],["T_WHITESPACE","\n            ",522],")",["T_WHITESPACE"," ",523],".",["T_WHITESPACE"," ",523],"\"",["T_ENCAPSED_AND_WHITESPACE",")\\n            AND ",523],["T_CURLY_OPEN","{",523],["T_VARIABLE","$this",523],["T_OBJECT_OPERATOR","->",523],["T_STRING","getIdFieldName",523],"(",")","}",["T_ENCAPSED_AND_WHITESPACE"," <> ",523],["T_CURLY_OPEN","{",523],["T_VARIABLE","$exceptId",523],"}","\"",["T_WHITESPACE","\n        ",523],")",";",["T_WHITESPACE","\n    ",524],"}",["T_WHITESPACE","\n\n    ",525],["T_DOC_COMMENT","\/**\n     * Increment failures count along with updating lock expire and first failure dates\n     *\n     * @param ModelUser $user\n     * @param int|bool $setLockExpires\n     * @param int|bool $setFirstFailure\n     * @return void\n     *\/",527],["T_WHITESPACE","\n    ",534],["T_PUBLIC","public",535],["T_WHITESPACE"," ",535],["T_FUNCTION","function",535],["T_WHITESPACE"," ",535],["T_STRING","updateFailure",535],"(",["T_VARIABLE","$user",535],",",["T_WHITESPACE"," ",535],["T_VARIABLE","$setLockExpires",535],["T_WHITESPACE"," ",535],"=",["T_WHITESPACE"," ",535],["T_STRING","false",535],",",["T_WHITESPACE"," ",535],["T_VARIABLE","$setFirstFailure",535],["T_WHITESPACE"," ",535],"=",["T_WHITESPACE"," ",535],["T_STRING","false",535],")",["T_WHITESPACE","\n    ",535],"{",["T_WHITESPACE","\n        ",536],["T_VARIABLE","$update",537],["T_WHITESPACE"," ",537],"=",["T_WHITESPACE"," ",537],"[",["T_CONSTANT_ENCAPSED_STRING","'failures_num'",537],["T_WHITESPACE"," ",537],["T_DOUBLE_ARROW","=>",537],["T_WHITESPACE"," ",537],["T_NEW","new",537],["T_WHITESPACE"," ",537],["T_NS_SEPARATOR","\\",537],["T_STRING","Zend_Db_Expr",537],"(",["T_CONSTANT_ENCAPSED_STRING","'failures_num + 1'",537],")","]",";",["T_WHITESPACE","\n        ",537],["T_IF","if",538],["T_WHITESPACE"," ",538],"(",["T_STRING","false",538],["T_WHITESPACE"," ",538],["T_IS_NOT_IDENTICAL","!==",538],["T_WHITESPACE"," ",538],["T_VARIABLE","$setFirstFailure",538],")",["T_WHITESPACE"," ",538],"{",["T_WHITESPACE","\n            ",538],["T_VARIABLE","$update",539],"[",["T_CONSTANT_ENCAPSED_STRING","'first_failure'",539],"]",["T_WHITESPACE"," ",539],"=",["T_WHITESPACE"," ",539],["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","dateTime",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","formatDate",539],"(",["T_VARIABLE","$setFirstFailure",539],")",";",["T_WHITESPACE","\n            ",539],["T_VARIABLE","$update",540],"[",["T_CONSTANT_ENCAPSED_STRING","'failures_num'",540],"]",["T_WHITESPACE"," ",540],"=",["T_WHITESPACE"," ",540],["T_LNUMBER","1",540],";",["T_WHITESPACE","\n        ",540],"}",["T_WHITESPACE","\n        ",541],["T_IF","if",542],["T_WHITESPACE"," ",542],"(",["T_STRING","false",542],["T_WHITESPACE"," ",542],["T_IS_NOT_IDENTICAL","!==",542],["T_WHITESPACE"," ",542],["T_VARIABLE","$setLockExpires",542],")",["T_WHITESPACE"," ",542],"{",["T_WHITESPACE","\n            ",542],["T_VARIABLE","$update",543],"[",["T_CONSTANT_ENCAPSED_STRING","'lock_expires'",543],"]",["T_WHITESPACE"," ",543],"=",["T_WHITESPACE"," ",543],["T_VARIABLE","$this",543],["T_OBJECT_OPERATOR","->",543],["T_STRING","dateTime",543],["T_OBJECT_OPERATOR","->",543],["T_STRING","formatDate",543],"(",["T_VARIABLE","$setLockExpires",543],")",";",["T_WHITESPACE","\n        ",543],"}",["T_WHITESPACE","\n        ",544],["T_VARIABLE","$this",545],["T_OBJECT_OPERATOR","->",545],["T_STRING","getConnection",545],"(",")",["T_OBJECT_OPERATOR","->",545],["T_STRING","update",545],"(",["T_WHITESPACE","\n            ",545],["T_VARIABLE","$this",546],["T_OBJECT_OPERATOR","->",546],["T_STRING","getMainTable",546],"(",")",",",["T_WHITESPACE","\n            ",546],["T_VARIABLE","$update",547],",",["T_WHITESPACE","\n            ",547],["T_VARIABLE","$this",548],["T_OBJECT_OPERATOR","->",548],["T_STRING","getConnection",548],"(",")",["T_OBJECT_OPERATOR","->",548],["T_STRING","quoteInto",548],"(","\"",["T_CURLY_OPEN","{",548],["T_VARIABLE","$this",548],["T_OBJECT_OPERATOR","->",548],["T_STRING","getIdFieldName",548],"(",")","}",["T_ENCAPSED_AND_WHITESPACE"," = ?",548],"\"",",",["T_WHITESPACE"," ",548],["T_VARIABLE","$user",548],["T_OBJECT_OPERATOR","->",548],["T_STRING","getId",548],"(",")",")",["T_WHITESPACE","\n        ",548],")",";",["T_WHITESPACE","\n    ",549],"}",["T_WHITESPACE","\n\n    ",550],["T_DOC_COMMENT","\/**\n     * Purge and get remaining old password hashes\n     *\n     * @param ModelUser $user\n     * @param int $retainLimit\n     * @return array\n     *\/",552],["T_WHITESPACE","\n    ",558],["T_PUBLIC","public",559],["T_WHITESPACE"," ",559],["T_FUNCTION","function",559],["T_WHITESPACE"," ",559],["T_STRING","getOldPasswords",559],"(",["T_VARIABLE","$user",559],",",["T_WHITESPACE"," ",559],["T_VARIABLE","$retainLimit",559],["T_WHITESPACE"," ",559],"=",["T_WHITESPACE"," ",559],["T_LNUMBER","4",559],")",["T_WHITESPACE","\n    ",559],"{",["T_WHITESPACE","\n        ",560],["T_VARIABLE","$userId",561],["T_WHITESPACE"," ",561],"=",["T_WHITESPACE"," ",561],["T_INT_CAST","(int)",561],["T_VARIABLE","$user",561],["T_OBJECT_OPERATOR","->",561],["T_STRING","getId",561],"(",")",";",["T_WHITESPACE","\n        ",561],["T_VARIABLE","$table",562],["T_WHITESPACE"," ",562],"=",["T_WHITESPACE"," ",562],["T_VARIABLE","$this",562],["T_OBJECT_OPERATOR","->",562],["T_STRING","getTable",562],"(",["T_CONSTANT_ENCAPSED_STRING","'admin_passwords'",562],")",";",["T_WHITESPACE","\n\n        ",562],["T_COMMENT","\/\/ purge expired passwords, except those which should be retained\n",564],["T_WHITESPACE","        ",565],["T_VARIABLE","$retainPasswordIds",565],["T_WHITESPACE"," ",565],"=",["T_WHITESPACE"," ",565],["T_VARIABLE","$this",565],["T_OBJECT_OPERATOR","->",565],["T_STRING","getConnection",565],"(",")",["T_OBJECT_OPERATOR","->",565],["T_STRING","fetchCol",565],"(",["T_WHITESPACE","\n            ",565],["T_VARIABLE","$this",566],["T_OBJECT_OPERATOR","->",566],["T_STRING","getConnection",566],"(",")",["T_WHITESPACE","\n                ",566],["T_OBJECT_OPERATOR","->",567],["T_STRING","select",567],"(",")",["T_WHITESPACE","\n                ",567],["T_OBJECT_OPERATOR","->",568],["T_STRING","from",568],"(",["T_VARIABLE","$table",568],",",["T_WHITESPACE"," ",568],["T_CONSTANT_ENCAPSED_STRING","'password_id'",568],")",["T_WHITESPACE","\n                ",568],["T_OBJECT_OPERATOR","->",569],["T_STRING","where",569],"(",["T_CONSTANT_ENCAPSED_STRING","'user_id = :user_id'",569],")",["T_WHITESPACE","\n                ",569],["T_OBJECT_OPERATOR","->",570],["T_STRING","order",570],"(",["T_CONSTANT_ENCAPSED_STRING","'expires '",570],["T_WHITESPACE"," ",570],".",["T_WHITESPACE"," ",570],["T_NS_SEPARATOR","\\",570],["T_STRING","Magento",570],["T_NS_SEPARATOR","\\",570],["T_STRING","Framework",570],["T_NS_SEPARATOR","\\",570],["T_STRING","DB",570],["T_NS_SEPARATOR","\\",570],["T_STRING","Select",570],["T_DOUBLE_COLON","::",570],["T_STRING","SQL_DESC",570],")",["T_WHITESPACE","\n                ",570],["T_OBJECT_OPERATOR","->",571],["T_STRING","order",571],"(",["T_CONSTANT_ENCAPSED_STRING","'password_id '",571],["T_WHITESPACE"," ",571],".",["T_WHITESPACE"," ",571],["T_NS_SEPARATOR","\\",571],["T_STRING","Magento",571],["T_NS_SEPARATOR","\\",571],["T_STRING","Framework",571],["T_NS_SEPARATOR","\\",571],["T_STRING","DB",571],["T_NS_SEPARATOR","\\",571],["T_STRING","Select",571],["T_DOUBLE_COLON","::",571],["T_STRING","SQL_DESC",571],")",["T_WHITESPACE","\n                ",571],["T_OBJECT_OPERATOR","->",572],["T_STRING","limit",572],"(",["T_VARIABLE","$retainLimit",572],")",",",["T_WHITESPACE","\n            ",572],"[",["T_CONSTANT_ENCAPSED_STRING","':user_id'",573],["T_WHITESPACE"," ",573],["T_DOUBLE_ARROW","=>",573],["T_WHITESPACE"," ",573],["T_VARIABLE","$userId",573],"]",["T_WHITESPACE","\n        ",573],")",";",["T_WHITESPACE","\n        ",574],["T_VARIABLE","$where",575],["T_WHITESPACE"," ",575],"=",["T_WHITESPACE"," ",575],"[",["T_CONSTANT_ENCAPSED_STRING","'user_id = ?'",575],["T_WHITESPACE"," ",575],["T_DOUBLE_ARROW","=>",575],["T_WHITESPACE"," ",575],["T_VARIABLE","$userId",575],",",["T_WHITESPACE"," ",575],["T_CONSTANT_ENCAPSED_STRING","'expires <= ?'",575],["T_WHITESPACE"," ",575],["T_DOUBLE_ARROW","=>",575],["T_WHITESPACE"," ",575],["T_STRING","time",575],"(",")","]",";",["T_WHITESPACE","\n        ",575],["T_IF","if",576],["T_WHITESPACE"," ",576],"(",["T_VARIABLE","$retainPasswordIds",576],")",["T_WHITESPACE"," ",576],"{",["T_WHITESPACE","\n            ",576],["T_VARIABLE","$where",577],"[",["T_CONSTANT_ENCAPSED_STRING","'password_id NOT IN (?)'",577],"]",["T_WHITESPACE"," ",577],"=",["T_WHITESPACE"," ",577],["T_VARIABLE","$retainPasswordIds",577],";",["T_WHITESPACE","\n        ",577],"}",["T_WHITESPACE","\n        ",578],["T_VARIABLE","$this",579],["T_OBJECT_OPERATOR","->",579],["T_STRING","getConnection",579],"(",")",["T_OBJECT_OPERATOR","->",579],["T_STRING","delete",579],"(",["T_VARIABLE","$table",579],",",["T_WHITESPACE"," ",579],["T_VARIABLE","$where",579],")",";",["T_WHITESPACE","\n\n        ",579],["T_COMMENT","\/\/ get all remaining passwords\n",581],["T_WHITESPACE","        ",582],["T_RETURN","return",582],["T_WHITESPACE"," ",582],["T_VARIABLE","$this",582],["T_OBJECT_OPERATOR","->",582],["T_STRING","getConnection",582],"(",")",["T_OBJECT_OPERATOR","->",582],["T_STRING","fetchCol",582],"(",["T_WHITESPACE","\n            ",582],["T_VARIABLE","$this",583],["T_OBJECT_OPERATOR","->",583],["T_STRING","getConnection",583],"(",")",["T_WHITESPACE","\n                ",583],["T_OBJECT_OPERATOR","->",584],["T_STRING","select",584],"(",")",["T_WHITESPACE","\n                ",584],["T_OBJECT_OPERATOR","->",585],["T_STRING","from",585],"(",["T_VARIABLE","$table",585],",",["T_WHITESPACE"," ",585],["T_CONSTANT_ENCAPSED_STRING","'password_hash'",585],")",["T_WHITESPACE","\n                ",585],["T_OBJECT_OPERATOR","->",586],["T_STRING","where",586],"(",["T_CONSTANT_ENCAPSED_STRING","'user_id = :user_id'",586],")",",",["T_WHITESPACE","\n            ",586],"[",["T_CONSTANT_ENCAPSED_STRING","':user_id'",587],["T_WHITESPACE"," ",587],["T_DOUBLE_ARROW","=>",587],["T_WHITESPACE"," ",587],["T_VARIABLE","$userId",587],"]",["T_WHITESPACE","\n        ",587],")",";",["T_WHITESPACE","\n    ",588],"}",["T_WHITESPACE","\n\n    ",589],["T_DOC_COMMENT","\/**\n     * Remember a password hash for further usage\n     *\n     * @param ModelUser $user\n     * @param string $passwordHash\n     * @param int $lifetime\n     * @return void\n     *\/",591],["T_WHITESPACE","\n    ",598],["T_PUBLIC","public",599],["T_WHITESPACE"," ",599],["T_FUNCTION","function",599],["T_WHITESPACE"," ",599],["T_STRING","trackPassword",599],"(",["T_VARIABLE","$user",599],",",["T_WHITESPACE"," ",599],["T_VARIABLE","$passwordHash",599],",",["T_WHITESPACE"," ",599],["T_VARIABLE","$lifetime",599],")",["T_WHITESPACE","\n    ",599],"{",["T_WHITESPACE","\n        ",600],["T_VARIABLE","$now",601],["T_WHITESPACE"," ",601],"=",["T_WHITESPACE"," ",601],["T_STRING","time",601],"(",")",";",["T_WHITESPACE","\n        ",601],["T_VARIABLE","$this",602],["T_OBJECT_OPERATOR","->",602],["T_STRING","getConnection",602],"(",")",["T_OBJECT_OPERATOR","->",602],["T_STRING","insert",602],"(",["T_WHITESPACE","\n            ",602],["T_VARIABLE","$this",603],["T_OBJECT_OPERATOR","->",603],["T_STRING","getTable",603],"(",["T_CONSTANT_ENCAPSED_STRING","'admin_passwords'",603],")",",",["T_WHITESPACE","\n            ",603],"[",["T_WHITESPACE","\n                ",604],["T_CONSTANT_ENCAPSED_STRING","'user_id'",605],["T_WHITESPACE"," ",605],["T_DOUBLE_ARROW","=>",605],["T_WHITESPACE"," ",605],["T_VARIABLE","$user",605],["T_OBJECT_OPERATOR","->",605],["T_STRING","getId",605],"(",")",",",["T_WHITESPACE","\n                ",605],["T_CONSTANT_ENCAPSED_STRING","'password_hash'",606],["T_WHITESPACE"," ",606],["T_DOUBLE_ARROW","=>",606],["T_WHITESPACE"," ",606],["T_VARIABLE","$passwordHash",606],",",["T_WHITESPACE","\n                ",606],["T_CONSTANT_ENCAPSED_STRING","'expires'",607],["T_WHITESPACE"," ",607],["T_DOUBLE_ARROW","=>",607],["T_WHITESPACE"," ",607],["T_VARIABLE","$now",607],["T_WHITESPACE"," ",607],"+",["T_WHITESPACE"," ",607],["T_VARIABLE","$lifetime",607],",",["T_WHITESPACE","\n                ",607],["T_CONSTANT_ENCAPSED_STRING","'last_updated'",608],["T_WHITESPACE"," ",608],["T_DOUBLE_ARROW","=>",608],["T_WHITESPACE"," ",608],["T_VARIABLE","$now",608],["T_WHITESPACE","\n            ",608],"]",["T_WHITESPACE","\n        ",609],")",";",["T_WHITESPACE","\n    ",610],"}",["T_WHITESPACE","\n\n    ",611],["T_DOC_COMMENT","\/**\n     * Get latest password for specified user id\n     * Possible false positive when password was changed several times with different lifetime configuration\n     *\n     * @param int $userId\n     * @return array\n     *\/",613],["T_WHITESPACE","\n    ",619],["T_PUBLIC","public",620],["T_WHITESPACE"," ",620],["T_FUNCTION","function",620],["T_WHITESPACE"," ",620],["T_STRING","getLatestPassword",620],"(",["T_VARIABLE","$userId",620],")",["T_WHITESPACE","\n    ",620],"{",["T_WHITESPACE","\n        ",621],["T_RETURN","return",622],["T_WHITESPACE"," ",622],["T_VARIABLE","$this",622],["T_OBJECT_OPERATOR","->",622],["T_STRING","getConnection",622],"(",")",["T_OBJECT_OPERATOR","->",622],["T_STRING","fetchRow",622],"(",["T_WHITESPACE","\n            ",622],["T_VARIABLE","$this",623],["T_OBJECT_OPERATOR","->",623],["T_STRING","getConnection",623],"(",")",["T_WHITESPACE","\n                ",623],["T_OBJECT_OPERATOR","->",624],["T_STRING","select",624],"(",")",["T_WHITESPACE","\n                ",624],["T_OBJECT_OPERATOR","->",625],["T_STRING","from",625],"(",["T_VARIABLE","$this",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","getTable",625],"(",["T_CONSTANT_ENCAPSED_STRING","'admin_passwords'",625],")",")",["T_WHITESPACE","\n                ",625],["T_OBJECT_OPERATOR","->",626],["T_STRING","where",626],"(",["T_CONSTANT_ENCAPSED_STRING","'user_id = :user_id'",626],")",["T_WHITESPACE","\n                ",626],["T_OBJECT_OPERATOR","->",627],["T_STRING","order",627],"(",["T_CONSTANT_ENCAPSED_STRING","'password_id '",627],["T_WHITESPACE"," ",627],".",["T_WHITESPACE"," ",627],["T_NS_SEPARATOR","\\",627],["T_STRING","Magento",627],["T_NS_SEPARATOR","\\",627],["T_STRING","Framework",627],["T_NS_SEPARATOR","\\",627],["T_STRING","DB",627],["T_NS_SEPARATOR","\\",627],["T_STRING","Select",627],["T_DOUBLE_COLON","::",627],["T_STRING","SQL_DESC",627],")",["T_WHITESPACE","\n                ",627],["T_OBJECT_OPERATOR","->",628],["T_STRING","limit",628],"(",["T_LNUMBER","1",628],")",",",["T_WHITESPACE","\n            ",628],"[",["T_CONSTANT_ENCAPSED_STRING","':user_id'",629],["T_WHITESPACE"," ",629],["T_DOUBLE_ARROW","=>",629],["T_WHITESPACE"," ",629],["T_VARIABLE","$userId",629],"]",["T_WHITESPACE","\n        ",629],")",";",["T_WHITESPACE","\n    ",630],"}",["T_WHITESPACE","\n",631],"}",["T_WHITESPACE","\n",632]]