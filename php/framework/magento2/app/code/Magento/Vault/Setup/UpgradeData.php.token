[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Vault",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Setup",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","App",8],["T_NS_SEPARATOR","\\",8],["T_STRING","ObjectManager",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","App",9],["T_NS_SEPARATOR","\\",9],["T_STRING","ResourceConnection",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","DB",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Adapter",10],["T_NS_SEPARATOR","\\",10],["T_STRING","AdapterInterface",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Framework",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Setup",11],["T_NS_SEPARATOR","\\",11],["T_STRING","ModuleContextInterface",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Framework",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Setup",12],["T_NS_SEPARATOR","\\",12],["T_STRING","ModuleDataSetupInterface",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Framework",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Setup",13],["T_NS_SEPARATOR","\\",13],["T_STRING","UpgradeDataInterface",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Vault",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Api",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Data",14],["T_NS_SEPARATOR","\\",14],["T_STRING","PaymentTokenInterface",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Magento",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Vault",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Model",15],["T_NS_SEPARATOR","\\",15],["T_STRING","CreditCardTokenFactory",15],";",["T_WHITESPACE","\n\n",15],["T_DOC_COMMENT","\/**\n * Class UpgradeData\n *\/",17],["T_WHITESPACE","\n",19],["T_CLASS","class",20],["T_WHITESPACE"," ",20],["T_STRING","UpgradeData",20],["T_WHITESPACE"," ",20],["T_IMPLEMENTS","implements",20],["T_WHITESPACE"," ",20],["T_STRING","UpgradeDataInterface",20],["T_WHITESPACE","\n",20],"{",["T_WHITESPACE","\n    ",21],["T_DOC_COMMENT","\/**\n     * Predefined name for sales connection\n     *\n     * @var string\n     *\/",22],["T_WHITESPACE","\n    ",26],["T_PRIVATE","private",27],["T_WHITESPACE"," ",27],["T_STATIC","static",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$salesConnectionName",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],["T_CONSTANT_ENCAPSED_STRING","'sales'",27],";",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * @inheritdoc\n     *\/",29],["T_WHITESPACE","\n    ",31],["T_PUBLIC","public",32],["T_WHITESPACE"," ",32],["T_FUNCTION","function",32],["T_WHITESPACE"," ",32],["T_STRING","upgrade",32],"(",["T_STRING","ModuleDataSetupInterface",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$setup",32],",",["T_WHITESPACE"," ",32],["T_STRING","ModuleContextInterface",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$context",32],")",["T_WHITESPACE","\n    ",32],"{",["T_WHITESPACE","\n        ",33],["T_VARIABLE","$setup",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","startSetup",34],"(",")",";",["T_WHITESPACE","\n\n        ",34],["T_COMMENT","\/\/ data update for Vault module < 2.0.1\n",36],["T_WHITESPACE","        ",37],["T_IF","if",37],["T_WHITESPACE"," ",37],"(",["T_STRING","version_compare",37],"(",["T_VARIABLE","$context",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","getVersion",37],"(",")",",",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'2.0.1'",37],",",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'<'",37],")",")",["T_WHITESPACE"," ",37],"{",["T_WHITESPACE","\n            ",37],["T_COMMENT","\/\/ update sets credit card as default token type\n",38],["T_WHITESPACE","            ",39],["T_VARIABLE","$setup",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","getConnection",39],"(",")",["T_OBJECT_OPERATOR","->",39],["T_STRING","update",39],"(",["T_VARIABLE","$setup",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","getTable",39],"(",["T_STRING","InstallSchema",39],["T_DOUBLE_COLON","::",39],["T_STRING","PAYMENT_TOKEN_TABLE",39],")",",",["T_WHITESPACE"," ",39],"[",["T_WHITESPACE","\n                ",39],["T_STRING","PaymentTokenInterface",40],["T_DOUBLE_COLON","::",40],["T_STRING","TYPE",40],["T_WHITESPACE"," ",40],["T_DOUBLE_ARROW","=>",40],["T_WHITESPACE"," ",40],["T_STRING","CreditCardTokenFactory",40],["T_DOUBLE_COLON","::",40],["T_STRING","TOKEN_TYPE_CREDIT_CARD",40],["T_WHITESPACE","\n            ",40],"]",",",["T_WHITESPACE"," ",41],["T_STRING","PaymentTokenInterface",41],["T_DOUBLE_COLON","::",41],["T_STRING","TYPE",41],["T_WHITESPACE"," ",41],".",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","' = \"\"'",41],")",";",["T_WHITESPACE","\n        ",41],"}",["T_WHITESPACE","\n\n        ",42],["T_COMMENT","\/\/ data update for Vault module < 2.0.2\n",44],["T_WHITESPACE","        ",45],["T_IF","if",45],["T_WHITESPACE"," ",45],"(",["T_STRING","version_compare",45],"(",["T_VARIABLE","$context",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","getVersion",45],"(",")",",",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'2.0.2'",45],",",["T_WHITESPACE"," ",45],["T_CONSTANT_ENCAPSED_STRING","'<'",45],")",")",["T_WHITESPACE"," ",45],"{",["T_WHITESPACE","\n            ",45],["T_COMMENT","\/\/ update converts additional info with token metadata to single dimensional array\n",46],["T_WHITESPACE","            ",47],["T_VARIABLE","$salesConnection",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_VARIABLE","$setup",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","getConnection",47],"(",["T_STRING","self",47],["T_DOUBLE_COLON","::",47],["T_VARIABLE","$salesConnectionName",47],")",";",["T_WHITESPACE","\n            ",47],["T_VARIABLE","$select",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_VARIABLE","$salesConnection",48],["T_OBJECT_OPERATOR","->",48],["T_STRING","select",48],"(",")",["T_WHITESPACE","\n                ",48],["T_OBJECT_OPERATOR","->",49],["T_STRING","from",49],"(",["T_VARIABLE","$setup",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","getTable",49],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_order_payment'",49],")",",",["T_WHITESPACE"," ",49],["T_CONSTANT_ENCAPSED_STRING","'entity_id'",49],")",["T_WHITESPACE","\n                ",49],["T_OBJECT_OPERATOR","->",50],["T_STRING","columns",50],"(","[",["T_CONSTANT_ENCAPSED_STRING","'additional_information'",50],"]",")",["T_WHITESPACE","\n                ",50],["T_OBJECT_OPERATOR","->",51],["T_STRING","where",51],"(",["T_CONSTANT_ENCAPSED_STRING","'additional_information LIKE ?'",51],",",["T_WHITESPACE"," ",51],["T_CONSTANT_ENCAPSED_STRING","'%token_metadata%'",51],")",";",["T_WHITESPACE","\n\n            ",51],["T_VARIABLE","$items",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$salesConnection",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","fetchAll",53],"(",["T_VARIABLE","$select",53],")",";",["T_WHITESPACE","\n            ",53],["T_FOREACH","foreach",54],["T_WHITESPACE"," ",54],"(",["T_VARIABLE","$items",54],["T_WHITESPACE"," ",54],["T_AS","as",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$item",54],")",["T_WHITESPACE"," ",54],"{",["T_WHITESPACE","\n                ",54],["T_VARIABLE","$additionalInfo",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","unserialize",55],"(",["T_VARIABLE","$item",55],"[",["T_CONSTANT_ENCAPSED_STRING","'additional_information'",55],"]",")",";",["T_WHITESPACE","\n                ",55],["T_VARIABLE","$additionalInfo",56],"[",["T_STRING","PaymentTokenInterface",56],["T_DOUBLE_COLON","::",56],["T_STRING","CUSTOMER_ID",56],"]",["T_WHITESPACE"," ",56],"=",["T_WHITESPACE","\n                    ",56],["T_VARIABLE","$additionalInfo",57],"[",["T_CONSTANT_ENCAPSED_STRING","'token_metadata'",57],"]","[",["T_STRING","PaymentTokenInterface",57],["T_DOUBLE_COLON","::",57],["T_STRING","CUSTOMER_ID",57],"]",";",["T_WHITESPACE","\n                ",57],["T_VARIABLE","$additionalInfo",58],"[",["T_STRING","PaymentTokenInterface",58],["T_DOUBLE_COLON","::",58],["T_STRING","PUBLIC_HASH",58],"]",["T_WHITESPACE"," ",58],"=",["T_WHITESPACE","\n                    ",58],["T_VARIABLE","$additionalInfo",59],"[",["T_CONSTANT_ENCAPSED_STRING","'token_metadata'",59],"]","[",["T_STRING","PaymentTokenInterface",59],["T_DOUBLE_COLON","::",59],["T_STRING","PUBLIC_HASH",59],"]",";",["T_WHITESPACE","\n                ",59],["T_UNSET","unset",60],"(",["T_VARIABLE","$additionalInfo",60],"[",["T_CONSTANT_ENCAPSED_STRING","'token_metadata'",60],"]",")",";",["T_WHITESPACE","\n\n                ",60],["T_VARIABLE","$salesConnection",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","update",62],"(",["T_WHITESPACE","\n                    ",62],["T_VARIABLE","$setup",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","getTable",63],"(",["T_CONSTANT_ENCAPSED_STRING","'sales_order_payment'",63],")",",",["T_WHITESPACE","\n                    ",63],"[",["T_CONSTANT_ENCAPSED_STRING","'additional_information'",64],["T_WHITESPACE"," ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_STRING","serialize",64],"(",["T_VARIABLE","$additionalInfo",64],")","]",",",["T_WHITESPACE","\n                    ",64],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id = ?'",65],["T_WHITESPACE"," ",65],["T_DOUBLE_ARROW","=>",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$item",65],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",65],"]","]",["T_WHITESPACE","\n                ",65],")",";",["T_WHITESPACE","\n            ",66],"}",["T_WHITESPACE","\n        ",67],"}",["T_WHITESPACE","\n\n        ",68],["T_VARIABLE","$setup",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","endSetup",70],"(",")",";",["T_WHITESPACE","\n    ",70],"}",["T_WHITESPACE","\n",71],"}",["T_WHITESPACE","\n",72]]