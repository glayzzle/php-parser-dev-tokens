[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Vault",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Api",8],["T_NS_SEPARATOR","\\",8],["T_STRING","FilterBuilder",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Api",9],["T_NS_SEPARATOR","\\",9],["T_STRING","SearchCriteriaBuilder",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Encryption",10],["T_NS_SEPARATOR","\\",10],["T_STRING","EncryptorInterface",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Framework",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Intl",11],["T_NS_SEPARATOR","\\",11],["T_STRING","DateTimeFactory",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Sales",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Api",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Data",12],["T_NS_SEPARATOR","\\",12],["T_STRING","OrderPaymentInterface",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Sales",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Model",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Order",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Payment",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Vault",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Api",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Data",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Magento",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Vault",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Api",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Data",15],["T_NS_SEPARATOR","\\",15],["T_STRING","PaymentTokenInterface",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Magento",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Vault",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Api",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Data",16],["T_NS_SEPARATOR","\\",16],["T_STRING","PaymentTokenSearchResultsInterfaceFactory",16],";",["T_WHITESPACE","\n",16],["T_USE","use",17],["T_WHITESPACE"," ",17],["T_STRING","Magento",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Vault",17],["T_NS_SEPARATOR","\\",17],["T_STRING","Api",17],["T_NS_SEPARATOR","\\",17],["T_STRING","PaymentTokenManagementInterface",17],";",["T_WHITESPACE","\n",17],["T_USE","use",18],["T_WHITESPACE"," ",18],["T_STRING","Magento",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Vault",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Api",18],["T_NS_SEPARATOR","\\",18],["T_STRING","PaymentTokenRepositoryInterface",18],";",["T_WHITESPACE","\n",18],["T_USE","use",19],["T_WHITESPACE"," ",19],["T_STRING","Magento",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Vault",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Model",19],["T_NS_SEPARATOR","\\",19],["T_STRING","ResourceModel",19],["T_NS_SEPARATOR","\\",19],["T_STRING","PaymentToken",19],["T_WHITESPACE"," ",19],["T_AS","as",19],["T_WHITESPACE"," ",19],["T_STRING","PaymentTokenResourceModel",19],";",["T_WHITESPACE","\n\n",19],["T_DOC_COMMENT","\/**\n * Vault payment token repository\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",21],["T_WHITESPACE","\n",24],["T_CLASS","class",25],["T_WHITESPACE"," ",25],["T_STRING","PaymentTokenManagement",25],["T_WHITESPACE"," ",25],["T_IMPLEMENTS","implements",25],["T_WHITESPACE"," ",25],["T_STRING","PaymentTokenManagementInterface",25],["T_WHITESPACE","\n",25],"{",["T_WHITESPACE","\n    ",26],["T_DOC_COMMENT","\/**\n     * @var PaymentTokenRepositoryInterface\n     *\/",27],["T_WHITESPACE","\n    ",29],["T_PROTECTED","protected",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$paymentTokenRepository",30],";",["T_WHITESPACE","\n\n    ",30],["T_DOC_COMMENT","\/**\n     * @var PaymentTokenResourceModel\n     *\/",32],["T_WHITESPACE","\n    ",34],["T_PROTECTED","protected",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$paymentTokenResourceModel",35],";",["T_WHITESPACE","\n\n    ",35],["T_DOC_COMMENT","\/**\n     * @var PaymentTokenResourceModel\n     *\/",37],["T_WHITESPACE","\n    ",39],["T_PROTECTED","protected",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$resourceModel",40],";",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/**\n     * @var PaymentTokenFactory\n     *\/",42],["T_WHITESPACE","\n    ",44],["T_PROTECTED","protected",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$paymentTokenFactory",45],";",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * @var PaymentTokenSearchResultsInterfaceFactory\n     *\/",47],["T_WHITESPACE","\n    ",49],["T_PROTECTED","protected",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$searchResultsFactory",50],";",["T_WHITESPACE","\n\n    ",50],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Api\\FilterBuilder\n     *\/",52],["T_WHITESPACE","\n    ",54],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$filterBuilder",55],";",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Api\\SearchCriteriaBuilder\n     *\/",57],["T_WHITESPACE","\n    ",59],["T_PROTECTED","protected",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$searchCriteriaBuilder",60],";",["T_WHITESPACE","\n\n    ",60],["T_DOC_COMMENT","\/**\n     * @var EncryptorInterface\n     *\/",62],["T_WHITESPACE","\n    ",64],["T_PRIVATE","private",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$encryptor",65],";",["T_WHITESPACE","\n\n    ",65],["T_DOC_COMMENT","\/**\n     * @var DateTimeFactory\n     *\/",67],["T_WHITESPACE","\n    ",69],["T_PRIVATE","private",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$dateTimeFactory",70],";",["T_WHITESPACE","\n\n    ",70],["T_DOC_COMMENT","\/**\n     * @param PaymentTokenRepositoryInterface $repository\n     * @param PaymentTokenResourceModel $paymentTokenResourceModel\n     * @param PaymentTokenFactory $paymentTokenFactory\n     * @param FilterBuilder $filterBuilder\n     * @param SearchCriteriaBuilder $searchCriteriaBuilder\n     * @param PaymentTokenSearchResultsInterfaceFactory $searchResultsFactory\n     * @param EncryptorInterface $encryptor\n     * @param DateTimeFactory $dateTimeFactory\n     *\/",72],["T_WHITESPACE","\n    ",81],["T_PUBLIC","public",82],["T_WHITESPACE"," ",82],["T_FUNCTION","function",82],["T_WHITESPACE"," ",82],["T_STRING","__construct",82],"(",["T_WHITESPACE","\n        ",82],["T_STRING","PaymentTokenRepositoryInterface",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$repository",83],",",["T_WHITESPACE","\n        ",83],["T_STRING","PaymentTokenResourceModel",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$paymentTokenResourceModel",84],",",["T_WHITESPACE","\n        ",84],["T_STRING","PaymentTokenFactory",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$paymentTokenFactory",85],",",["T_WHITESPACE","\n        ",85],["T_STRING","FilterBuilder",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$filterBuilder",86],",",["T_WHITESPACE","\n        ",86],["T_STRING","SearchCriteriaBuilder",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$searchCriteriaBuilder",87],",",["T_WHITESPACE","\n        ",87],["T_STRING","PaymentTokenSearchResultsInterfaceFactory",88],["T_WHITESPACE"," ",88],["T_VARIABLE","$searchResultsFactory",88],",",["T_WHITESPACE","\n        ",88],["T_STRING","EncryptorInterface",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$encryptor",89],",",["T_WHITESPACE","\n        ",89],["T_STRING","DateTimeFactory",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$dateTimeFactory",90],["T_WHITESPACE","\n    ",90],")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","paymentTokenRepository",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$repository",92],";",["T_WHITESPACE","\n        ",92],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","paymentTokenResourceModel",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$paymentTokenResourceModel",93],";",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","paymentTokenFactory",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_VARIABLE","$paymentTokenFactory",94],";",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","filterBuilder",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$filterBuilder",95],";",["T_WHITESPACE","\n        ",95],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","searchCriteriaBuilder",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$searchCriteriaBuilder",96],";",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","searchResultsFactory",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_VARIABLE","$searchResultsFactory",97],";",["T_WHITESPACE","\n        ",97],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","encryptor",98],["T_WHITESPACE"," ",98],"=",["T_WHITESPACE"," ",98],["T_VARIABLE","$encryptor",98],";",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","dateTimeFactory",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_VARIABLE","$dateTimeFactory",99],";",["T_WHITESPACE","\n    ",99],"}",["T_WHITESPACE","\n\n    ",100],["T_DOC_COMMENT","\/**\n     * Lists payment tokens that match specified search criteria.\n     *\n     * @param int $customerId Customer ID.\n     * @return \\Magento\\Vault\\Api\\Data\\PaymentTokenSearchResultsInterface[] Payment tokens search result interface.\n     *\/",102],["T_WHITESPACE","\n    ",107],["T_PUBLIC","public",108],["T_WHITESPACE"," ",108],["T_FUNCTION","function",108],["T_WHITESPACE"," ",108],["T_STRING","getListByCustomerId",108],"(",["T_VARIABLE","$customerId",108],")",["T_WHITESPACE","\n    ",108],"{",["T_WHITESPACE","\n        ",109],["T_VARIABLE","$filters",110],"[","]",["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","filterBuilder",110],["T_WHITESPACE","\n            ",110],["T_OBJECT_OPERATOR","->",111],["T_STRING","setField",111],"(",["T_STRING","PaymentTokenInterface",111],["T_DOUBLE_COLON","::",111],["T_STRING","CUSTOMER_ID",111],")",["T_WHITESPACE","\n            ",111],["T_OBJECT_OPERATOR","->",112],["T_STRING","setValue",112],"(",["T_VARIABLE","$customerId",112],")",["T_WHITESPACE","\n            ",112],["T_OBJECT_OPERATOR","->",113],["T_STRING","create",113],"(",")",";",["T_WHITESPACE","\n        ",113],["T_VARIABLE","$entities",114],["T_WHITESPACE"," ",114],"=",["T_WHITESPACE"," ",114],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","paymentTokenRepository",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","getList",114],"(",["T_WHITESPACE","\n            ",114],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","searchCriteriaBuilder",115],["T_WHITESPACE","\n                ",115],["T_OBJECT_OPERATOR","->",116],["T_STRING","addFilters",116],"(",["T_VARIABLE","$filters",116],")",["T_WHITESPACE","\n                ",116],["T_OBJECT_OPERATOR","->",117],["T_STRING","create",117],"(",")",["T_WHITESPACE","\n        ",117],")",["T_OBJECT_OPERATOR","->",118],["T_STRING","getItems",118],"(",")",";",["T_WHITESPACE","\n\n        ",118],["T_RETURN","return",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$entities",120],";",["T_WHITESPACE","\n    ",120],"}",["T_WHITESPACE","\n\n    ",121],["T_DOC_COMMENT","\/**\n     * Searches for all visible, non-expired tokens\n     *\n     * @param int $customerId\n     * @return Data\\PaymentTokenInterface[]\n     *\/",123],["T_WHITESPACE","\n    ",128],["T_PUBLIC","public",129],["T_WHITESPACE"," ",129],["T_FUNCTION","function",129],["T_WHITESPACE"," ",129],["T_STRING","getVisibleAvailableTokens",129],"(",["T_VARIABLE","$customerId",129],")",["T_WHITESPACE","\n    ",129],"{",["T_WHITESPACE","\n        ",130],["T_VARIABLE","$customerFilter",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],"[",["T_WHITESPACE","\n            ",131],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","filterBuilder",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","setField",132],"(",["T_STRING","PaymentTokenInterface",132],["T_DOUBLE_COLON","::",132],["T_STRING","CUSTOMER_ID",132],")",["T_WHITESPACE","\n                ",132],["T_OBJECT_OPERATOR","->",133],["T_STRING","setValue",133],"(",["T_VARIABLE","$customerId",133],")",["T_WHITESPACE","\n                ",133],["T_OBJECT_OPERATOR","->",134],["T_STRING","create",134],"(",")",["T_WHITESPACE","\n            ",134],"]",";",["T_WHITESPACE","\n        ",135],["T_VARIABLE","$visibleFilter",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],"[",["T_WHITESPACE","\n            ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","filterBuilder",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","setField",137],"(",["T_STRING","PaymentTokenInterface",137],["T_DOUBLE_COLON","::",137],["T_STRING","IS_VISIBLE",137],")",["T_WHITESPACE","\n                ",137],["T_OBJECT_OPERATOR","->",138],["T_STRING","setValue",138],"(",["T_LNUMBER","1",138],")",["T_WHITESPACE","\n                ",138],["T_OBJECT_OPERATOR","->",139],["T_STRING","create",139],"(",")",["T_WHITESPACE","\n            ",139],"]",";",["T_WHITESPACE","\n        ",140],["T_VARIABLE","$isActiveFilter",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],"[",["T_WHITESPACE","\n            ",141],["T_VARIABLE","$this",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","filterBuilder",142],["T_OBJECT_OPERATOR","->",142],["T_STRING","setField",142],"(",["T_STRING","PaymentTokenInterface",142],["T_DOUBLE_COLON","::",142],["T_STRING","IS_ACTIVE",142],")",["T_WHITESPACE","\n                ",142],["T_OBJECT_OPERATOR","->",143],["T_STRING","setValue",143],"(",["T_LNUMBER","1",143],")",["T_WHITESPACE","\n                ",143],["T_OBJECT_OPERATOR","->",144],["T_STRING","create",144],"(",")",["T_WHITESPACE","\n            ",144],"]",";",["T_WHITESPACE","\n        ",145],["T_VARIABLE","$expiresAtFilter",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],"[",["T_WHITESPACE","\n            ",146],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","filterBuilder",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","setField",147],"(",["T_STRING","PaymentTokenInterface",147],["T_DOUBLE_COLON","::",147],["T_STRING","EXPIRES_AT",147],")",["T_WHITESPACE","\n                ",147],["T_OBJECT_OPERATOR","->",148],["T_STRING","setConditionType",148],"(",["T_CONSTANT_ENCAPSED_STRING","'gt'",148],")",["T_WHITESPACE","\n                ",148],["T_OBJECT_OPERATOR","->",149],["T_STRING","setValue",149],"(",["T_WHITESPACE","\n                    ",149],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","dateTimeFactory",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","create",150],"(",["T_WHITESPACE","\n                        ",150],["T_CONSTANT_ENCAPSED_STRING","'now'",151],",",["T_WHITESPACE","\n                        ",151],["T_NEW","new",152],["T_WHITESPACE"," ",152],["T_NS_SEPARATOR","\\",152],["T_STRING","DateTimeZone",152],"(",["T_CONSTANT_ENCAPSED_STRING","'UTC'",152],")",["T_WHITESPACE","\n                    ",152],")",["T_OBJECT_OPERATOR","->",153],["T_STRING","format",153],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d 00:00:00'",153],")",["T_WHITESPACE","\n                ",153],")",["T_WHITESPACE","\n                ",154],["T_OBJECT_OPERATOR","->",155],["T_STRING","create",155],"(",")",["T_WHITESPACE","\n            ",155],"]",";",["T_WHITESPACE","\n        ",156],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","searchCriteriaBuilder",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","addFilters",157],"(",["T_VARIABLE","$customerFilter",157],")",";",["T_WHITESPACE","\n        ",157],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","searchCriteriaBuilder",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","addFilters",158],"(",["T_VARIABLE","$visibleFilter",158],")",";",["T_WHITESPACE","\n        ",158],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","searchCriteriaBuilder",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","addFilters",159],"(",["T_VARIABLE","$isActiveFilter",159],")",";",["T_WHITESPACE","\n        ",159],["T_COMMENT","\/\/ add filters to different filter groups in order to filter by AND expression\n",160],["T_WHITESPACE","        ",161],["T_VARIABLE","$searchCriteria",161],["T_WHITESPACE"," ",161],"=",["T_WHITESPACE"," ",161],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","searchCriteriaBuilder",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","addFilters",161],"(",["T_VARIABLE","$expiresAtFilter",161],")",["T_OBJECT_OPERATOR","->",161],["T_STRING","create",161],"(",")",";",["T_WHITESPACE","\n\n        ",161],["T_RETURN","return",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","paymentTokenRepository",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","getList",163],"(",["T_VARIABLE","$searchCriteria",163],")",["T_OBJECT_OPERATOR","->",163],["T_STRING","getItems",163],"(",")",";",["T_WHITESPACE","\n    ",163],"}",["T_WHITESPACE","\n\n    ",164],["T_DOC_COMMENT","\/**\n     * Get payment token by token Id.\n     *\n     * @param int $paymentId The payment token ID.\n     * @return PaymentTokenInterface|null Payment token interface.\n     *\/",166],["T_WHITESPACE","\n    ",171],["T_PUBLIC","public",172],["T_WHITESPACE"," ",172],["T_FUNCTION","function",172],["T_WHITESPACE"," ",172],["T_STRING","getByPaymentId",172],"(",["T_VARIABLE","$paymentId",172],")",["T_WHITESPACE","\n    ",172],"{",["T_WHITESPACE","\n        ",173],["T_VARIABLE","$tokenData",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","paymentTokenResourceModel",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","getByOrderPaymentId",174],"(",["T_VARIABLE","$paymentId",174],")",";",["T_WHITESPACE","\n        ",174],["T_VARIABLE","$tokenModel",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],"!",["T_EMPTY","empty",175],"(",["T_VARIABLE","$tokenData",175],")",["T_WHITESPACE"," ",175],"?",["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","paymentTokenFactory",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","create",175],"(","[",["T_CONSTANT_ENCAPSED_STRING","'data'",175],["T_WHITESPACE"," ",175],["T_DOUBLE_ARROW","=>",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$tokenData",175],"]",")",["T_WHITESPACE"," ",175],":",["T_WHITESPACE"," ",175],["T_STRING","null",175],";",["T_WHITESPACE","\n        ",175],["T_RETURN","return",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$tokenModel",176],";",["T_WHITESPACE","\n    ",176],"}",["T_WHITESPACE","\n\n    ",177],["T_DOC_COMMENT","\/**\n     * Get payment token by gateway token.\n     *\n     * @param string $token The gateway token.\n     * @param string $paymentMethodCode\n     * @param int $customerId Customer ID.\n     * @return PaymentTokenInterface|null Payment token interface.\n     *\/",179],["T_WHITESPACE","\n    ",186],["T_PUBLIC","public",187],["T_WHITESPACE"," ",187],["T_FUNCTION","function",187],["T_WHITESPACE"," ",187],["T_STRING","getByGatewayToken",187],"(",["T_VARIABLE","$token",187],",",["T_WHITESPACE"," ",187],["T_VARIABLE","$paymentMethodCode",187],",",["T_WHITESPACE"," ",187],["T_VARIABLE","$customerId",187],")",["T_WHITESPACE","\n    ",187],"{",["T_WHITESPACE","\n        ",188],["T_VARIABLE","$tokenData",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","paymentTokenResourceModel",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getByGatewayToken",189],"(",["T_VARIABLE","$token",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$paymentMethodCode",189],",",["T_WHITESPACE"," ",189],["T_VARIABLE","$customerId",189],")",";",["T_WHITESPACE","\n        ",189],["T_VARIABLE","$tokenModel",190],["T_WHITESPACE"," ",190],"=",["T_WHITESPACE"," ",190],"!",["T_EMPTY","empty",190],"(",["T_VARIABLE","$tokenData",190],")",["T_WHITESPACE"," ",190],"?",["T_WHITESPACE"," ",190],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","paymentTokenFactory",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","create",190],"(","[",["T_CONSTANT_ENCAPSED_STRING","'data'",190],["T_WHITESPACE"," ",190],["T_DOUBLE_ARROW","=>",190],["T_WHITESPACE"," ",190],["T_VARIABLE","$tokenData",190],"]",")",["T_WHITESPACE"," ",190],":",["T_WHITESPACE"," ",190],["T_STRING","null",190],";",["T_WHITESPACE","\n        ",190],["T_RETURN","return",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$tokenModel",191],";",["T_WHITESPACE","\n    ",191],"}",["T_WHITESPACE","\n\n    ",192],["T_DOC_COMMENT","\/**\n     * Get payment token by public hash.\n     *\n     * @param string $hash Public hash.\n     * @param int $customerId Customer ID.\n     * @return PaymentTokenInterface|null Payment token interface.\n     *\/",194],["T_WHITESPACE","\n    ",200],["T_PUBLIC","public",201],["T_WHITESPACE"," ",201],["T_FUNCTION","function",201],["T_WHITESPACE"," ",201],["T_STRING","getByPublicHash",201],"(",["T_VARIABLE","$hash",201],",",["T_WHITESPACE"," ",201],["T_VARIABLE","$customerId",201],")",["T_WHITESPACE","\n    ",201],"{",["T_WHITESPACE","\n        ",202],["T_VARIABLE","$tokenData",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","paymentTokenResourceModel",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","getByPublicHash",203],"(",["T_VARIABLE","$hash",203],",",["T_WHITESPACE"," ",203],["T_VARIABLE","$customerId",203],")",";",["T_WHITESPACE","\n        ",203],["T_VARIABLE","$tokenModel",204],["T_WHITESPACE"," ",204],"=",["T_WHITESPACE"," ",204],"!",["T_EMPTY","empty",204],"(",["T_VARIABLE","$tokenData",204],")",["T_WHITESPACE"," ",204],"?",["T_WHITESPACE"," ",204],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","paymentTokenFactory",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","create",204],"(","[",["T_CONSTANT_ENCAPSED_STRING","'data'",204],["T_WHITESPACE"," ",204],["T_DOUBLE_ARROW","=>",204],["T_WHITESPACE"," ",204],["T_VARIABLE","$tokenData",204],"]",")",["T_WHITESPACE"," ",204],":",["T_WHITESPACE"," ",204],["T_STRING","null",204],";",["T_WHITESPACE","\n        ",204],["T_RETURN","return",205],["T_WHITESPACE"," ",205],["T_VARIABLE","$tokenModel",205],";",["T_WHITESPACE","\n    ",205],"}",["T_WHITESPACE","\n\n    ",206],["T_DOC_COMMENT","\/**\n     * @param PaymentTokenInterface $token\n     * @param OrderPaymentInterface $payment\n     * @return bool\n     *\/",208],["T_WHITESPACE","\n    ",212],["T_PUBLIC","public",213],["T_WHITESPACE"," ",213],["T_FUNCTION","function",213],["T_WHITESPACE"," ",213],["T_STRING","saveTokenWithPaymentLink",213],"(",["T_STRING","PaymentTokenInterface",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$token",213],",",["T_WHITESPACE"," ",213],["T_STRING","OrderPaymentInterface",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$payment",213],")",["T_WHITESPACE","\n    ",213],"{",["T_WHITESPACE","\n        ",214],["T_VARIABLE","$tokenDuplicate",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","getByPublicHash",215],"(",["T_WHITESPACE","\n            ",215],["T_VARIABLE","$token",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","getPublicHash",216],"(",")",",",["T_WHITESPACE","\n            ",216],["T_VARIABLE","$token",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","getCustomerId",217],"(",")",["T_WHITESPACE","\n        ",217],")",";",["T_WHITESPACE","\n\n        ",218],["T_IF","if",220],["T_WHITESPACE"," ",220],"(","!",["T_EMPTY","empty",220],"(",["T_VARIABLE","$tokenDuplicate",220],")",")",["T_WHITESPACE"," ",220],"{",["T_WHITESPACE","\n            ",220],["T_IF","if",221],["T_WHITESPACE"," ",221],"(",["T_VARIABLE","$token",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","getIsVisible",221],"(",")",["T_WHITESPACE"," ",221],["T_BOOLEAN_OR","||",221],["T_WHITESPACE"," ",221],["T_VARIABLE","$tokenDuplicate",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","getIsVisible",221],"(",")",")",["T_WHITESPACE"," ",221],"{",["T_WHITESPACE","\n                ",221],["T_VARIABLE","$token",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","setEntityId",222],"(",["T_VARIABLE","$tokenDuplicate",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","getEntityId",222],"(",")",")",";",["T_WHITESPACE","\n                ",222],["T_VARIABLE","$token",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","setIsVisible",223],"(",["T_STRING","true",223],")",";",["T_WHITESPACE","\n            ",223],"}",["T_WHITESPACE"," ",224],["T_ELSEIF","elseif",224],["T_WHITESPACE"," ",224],"(",["T_VARIABLE","$token",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","getIsVisible",224],"(",")",["T_WHITESPACE"," ",224],["T_IS_IDENTICAL","===",224],["T_WHITESPACE"," ",224],["T_VARIABLE","$tokenDuplicate",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","getIsVisible",224],"(",")",")",["T_WHITESPACE"," ",224],"{",["T_WHITESPACE","\n                ",224],["T_VARIABLE","$token",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","setEntityId",225],"(",["T_VARIABLE","$tokenDuplicate",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","getEntityId",225],"(",")",")",";",["T_WHITESPACE","\n            ",225],"}",["T_WHITESPACE"," ",226],["T_ELSE","else",226],["T_WHITESPACE"," ",226],"{",["T_WHITESPACE","\n                ",226],["T_VARIABLE","$token",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","setPublicHash",227],"(",["T_WHITESPACE","\n                    ",227],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","encryptor",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getHash",228],"(",["T_WHITESPACE","\n                        ",228],["T_VARIABLE","$token",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","getPublicHash",229],"(",")",["T_WHITESPACE"," ",229],".",["T_WHITESPACE"," ",229],["T_VARIABLE","$token",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","getGatewayToken",229],"(",")",["T_WHITESPACE","\n                    ",229],")",["T_WHITESPACE","\n                ",230],")",";",["T_WHITESPACE","\n            ",231],"}",["T_WHITESPACE","\n        ",232],"}",["T_WHITESPACE","\n\n        ",233],["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","paymentTokenRepository",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","save",235],"(",["T_VARIABLE","$token",235],")",";",["T_WHITESPACE","\n\n        ",235],["T_VARIABLE","$result",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","addLinkToOrderPayment",237],"(",["T_VARIABLE","$token",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","getEntityId",237],"(",")",",",["T_WHITESPACE"," ",237],["T_VARIABLE","$payment",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","getEntityId",237],"(",")",")",";",["T_WHITESPACE","\n\n        ",237],["T_RETURN","return",239],["T_WHITESPACE"," ",239],["T_VARIABLE","$result",239],";",["T_WHITESPACE","\n    ",239],"}",["T_WHITESPACE","\n\n    ",240],["T_DOC_COMMENT","\/**\n     * Add link between payment token and order payment.\n     *\n     * @param int $paymentTokenId Payment token ID.\n     * @param int $orderPaymentId Order payment ID.\n     * @return bool\n     *\/",242],["T_WHITESPACE","\n    ",248],["T_PUBLIC","public",249],["T_WHITESPACE"," ",249],["T_FUNCTION","function",249],["T_WHITESPACE"," ",249],["T_STRING","addLinkToOrderPayment",249],"(",["T_VARIABLE","$paymentTokenId",249],",",["T_WHITESPACE"," ",249],["T_VARIABLE","$orderPaymentId",249],")",["T_WHITESPACE","\n    ",249],"{",["T_WHITESPACE","\n        ",250],["T_RETURN","return",251],["T_WHITESPACE"," ",251],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","paymentTokenResourceModel",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","addLinkToOrderPayment",251],"(",["T_VARIABLE","$paymentTokenId",251],",",["T_WHITESPACE"," ",251],["T_VARIABLE","$orderPaymentId",251],")",";",["T_WHITESPACE","\n    ",251],"}",["T_WHITESPACE","\n",252],"}",["T_WHITESPACE","\n",253]]