[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","SalesRule",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Model",7],["T_NS_SEPARATOR","\\",7],["T_STRING","ResourceModel",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Rule",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Quote",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Model",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Quote",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Address",9],";",["T_WHITESPACE","\n\n",9],["T_DOC_COMMENT","\/**\n * Sales Rules resource collection model.\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",11],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","Collection",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Magento",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Rule",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Model",15],["T_NS_SEPARATOR","\\",15],["T_STRING","ResourceModel",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Rule",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Collection",15],["T_NS_SEPARATOR","\\",15],["T_STRING","AbstractCollection",15],["T_WHITESPACE","\n",15],"{",["T_WHITESPACE","\n    ",16],["T_DOC_COMMENT","\/**\n     * Store associated with rule entities information map\n     *\n     * @var array\n     *\/",17],["T_WHITESPACE","\n    ",21],["T_PROTECTED","protected",22],["T_WHITESPACE"," ",22],["T_VARIABLE","$_associatedEntitiesMap",22],";",["T_WHITESPACE","\n\n    ",22],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\SalesRule\\Model\\ResourceModel\\Rule\\DateApplier\n     *\/",24],["T_WHITESPACE","\n    ",26],["T_PROTECTED","protected",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$dateApplier",27],";",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Stdlib\\DateTime\\TimezoneInterface\n     *\/",29],["T_WHITESPACE","\n    ",31],["T_PROTECTED","protected",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$_date",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\Data\\Collection\\EntityFactory $entityFactory\n     * @param \\Psr\\Log\\LoggerInterface $logger\n     * @param \\Magento\\Framework\\Data\\Collection\\Db\\FetchStrategyInterface $fetchStrategy\n     * @param \\Magento\\Framework\\Event\\ManagerInterface $eventManager\n     * @param \\Magento\\Framework\\Stdlib\\DateTime\\TimezoneInterface $date\n     * @param mixed $connection\n     * @param \\Magento\\Framework\\Model\\ResourceModel\\Db\\AbstractDb $resource\n     *\/",34],["T_WHITESPACE","\n    ",42],["T_PUBLIC","public",43],["T_WHITESPACE"," ",43],["T_FUNCTION","function",43],["T_WHITESPACE"," ",43],["T_STRING","__construct",43],"(",["T_WHITESPACE","\n        ",43],["T_NS_SEPARATOR","\\",44],["T_STRING","Magento",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Framework",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Data",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Collection",44],["T_NS_SEPARATOR","\\",44],["T_STRING","EntityFactory",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$entityFactory",44],",",["T_WHITESPACE","\n        ",44],["T_NS_SEPARATOR","\\",45],["T_STRING","Psr",45],["T_NS_SEPARATOR","\\",45],["T_STRING","Log",45],["T_NS_SEPARATOR","\\",45],["T_STRING","LoggerInterface",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$logger",45],",",["T_WHITESPACE","\n        ",45],["T_NS_SEPARATOR","\\",46],["T_STRING","Magento",46],["T_NS_SEPARATOR","\\",46],["T_STRING","Framework",46],["T_NS_SEPARATOR","\\",46],["T_STRING","Data",46],["T_NS_SEPARATOR","\\",46],["T_STRING","Collection",46],["T_NS_SEPARATOR","\\",46],["T_STRING","Db",46],["T_NS_SEPARATOR","\\",46],["T_STRING","FetchStrategyInterface",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$fetchStrategy",46],",",["T_WHITESPACE","\n        ",46],["T_NS_SEPARATOR","\\",47],["T_STRING","Magento",47],["T_NS_SEPARATOR","\\",47],["T_STRING","Framework",47],["T_NS_SEPARATOR","\\",47],["T_STRING","Event",47],["T_NS_SEPARATOR","\\",47],["T_STRING","ManagerInterface",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$eventManager",47],",",["T_WHITESPACE","\n        ",47],["T_NS_SEPARATOR","\\",48],["T_STRING","Magento",48],["T_NS_SEPARATOR","\\",48],["T_STRING","Framework",48],["T_NS_SEPARATOR","\\",48],["T_STRING","Stdlib",48],["T_NS_SEPARATOR","\\",48],["T_STRING","DateTime",48],["T_NS_SEPARATOR","\\",48],["T_STRING","TimezoneInterface",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$date",48],",",["T_WHITESPACE","\n        ",48],["T_NS_SEPARATOR","\\",49],["T_STRING","Magento",49],["T_NS_SEPARATOR","\\",49],["T_STRING","Framework",49],["T_NS_SEPARATOR","\\",49],["T_STRING","DB",49],["T_NS_SEPARATOR","\\",49],["T_STRING","Adapter",49],["T_NS_SEPARATOR","\\",49],["T_STRING","AdapterInterface",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$connection",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_STRING","null",49],",",["T_WHITESPACE","\n        ",49],["T_NS_SEPARATOR","\\",50],["T_STRING","Magento",50],["T_NS_SEPARATOR","\\",50],["T_STRING","Framework",50],["T_NS_SEPARATOR","\\",50],["T_STRING","Model",50],["T_NS_SEPARATOR","\\",50],["T_STRING","ResourceModel",50],["T_NS_SEPARATOR","\\",50],["T_STRING","Db",50],["T_NS_SEPARATOR","\\",50],["T_STRING","AbstractDb",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$resource",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_STRING","null",50],["T_WHITESPACE","\n    ",50],")",["T_WHITESPACE"," ",51],"{",["T_WHITESPACE","\n        ",51],["T_STRING","parent",52],["T_DOUBLE_COLON","::",52],["T_STRING","__construct",52],"(",["T_VARIABLE","$entityFactory",52],",",["T_WHITESPACE"," ",52],["T_VARIABLE","$logger",52],",",["T_WHITESPACE"," ",52],["T_VARIABLE","$fetchStrategy",52],",",["T_WHITESPACE"," ",52],["T_VARIABLE","$eventManager",52],",",["T_WHITESPACE"," ",52],["T_VARIABLE","$connection",52],",",["T_WHITESPACE"," ",52],["T_VARIABLE","$resource",52],")",";",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","_date",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$date",53],";",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","_associatedEntitiesMap",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","getAssociatedEntitiesMap",54],"(",")",";",["T_WHITESPACE","\n    ",54],"}",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * Set resource model and determine field mapping\n     *\n     * @return void\n     *\/",57],["T_WHITESPACE","\n    ",61],["T_PROTECTED","protected",62],["T_WHITESPACE"," ",62],["T_FUNCTION","function",62],["T_WHITESPACE"," ",62],["T_STRING","_construct",62],"(",")",["T_WHITESPACE","\n    ",62],"{",["T_WHITESPACE","\n        ",63],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","_init",64],"(",["T_NS_SEPARATOR","\\",64],["T_STRING","Magento",64],["T_NS_SEPARATOR","\\",64],["T_STRING","SalesRule",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Model",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Rule",64],["T_DOUBLE_COLON","::",64],["T_CLASS","class",64],",",["T_WHITESPACE"," ",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Magento",64],["T_NS_SEPARATOR","\\",64],["T_STRING","SalesRule",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Model",64],["T_NS_SEPARATOR","\\",64],["T_STRING","ResourceModel",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Rule",64],["T_DOUBLE_COLON","::",64],["T_CLASS","class",64],")",";",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","_map",65],"[",["T_CONSTANT_ENCAPSED_STRING","'fields'",65],"]","[",["T_CONSTANT_ENCAPSED_STRING","'rule_id'",65],"]",["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'main_table.rule_id'",65],";",["T_WHITESPACE","\n    ",65],"}",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * @param string $entityType\n     * @param string $objectField\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     * @return void\n     *\/",68],["T_WHITESPACE","\n    ",73],["T_PROTECTED","protected",74],["T_WHITESPACE"," ",74],["T_FUNCTION","function",74],["T_WHITESPACE"," ",74],["T_STRING","mapAssociatedEntities",74],"(",["T_VARIABLE","$entityType",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$objectField",74],")",["T_WHITESPACE","\n    ",74],"{",["T_WHITESPACE","\n        ",75],["T_IF","if",76],["T_WHITESPACE"," ",76],"(","!",["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","_items",76],")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n            ",76],["T_RETURN","return",77],";",["T_WHITESPACE","\n        ",77],"}",["T_WHITESPACE","\n\n        ",78],["T_VARIABLE","$entityInfo",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","_getAssociatedEntityInfo",80],"(",["T_VARIABLE","$entityType",80],")",";",["T_WHITESPACE","\n        ",80],["T_VARIABLE","$ruleIdField",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$entityInfo",81],"[",["T_CONSTANT_ENCAPSED_STRING","'rule_id_field'",81],"]",";",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$entityIds",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","getColumnValues",82],"(",["T_VARIABLE","$ruleIdField",82],")",";",["T_WHITESPACE","\n\n        ",82],["T_VARIABLE","$select",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getConnection",84],"(",")",["T_OBJECT_OPERATOR","->",84],["T_STRING","select",84],"(",")",["T_OBJECT_OPERATOR","->",84],["T_STRING","from",84],"(",["T_WHITESPACE","\n            ",84],["T_VARIABLE","$this",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","getTable",85],"(",["T_VARIABLE","$entityInfo",85],"[",["T_CONSTANT_ENCAPSED_STRING","'associations_table'",85],"]",")",["T_WHITESPACE","\n        ",85],")",["T_OBJECT_OPERATOR","->",86],["T_STRING","where",86],"(",["T_WHITESPACE","\n            ",86],["T_VARIABLE","$ruleIdField",87],["T_WHITESPACE"," ",87],".",["T_WHITESPACE"," ",87],["T_CONSTANT_ENCAPSED_STRING","' IN (?)'",87],",",["T_WHITESPACE","\n            ",87],["T_VARIABLE","$entityIds",88],["T_WHITESPACE","\n        ",88],")",";",["T_WHITESPACE","\n\n        ",89],["T_VARIABLE","$associatedEntities",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","getConnection",91],"(",")",["T_OBJECT_OPERATOR","->",91],["T_STRING","fetchAll",91],"(",["T_VARIABLE","$select",91],")",";",["T_WHITESPACE","\n\n        ",91],["T_STRING","array_map",93],"(",["T_FUNCTION","function",93],["T_WHITESPACE"," ",93],"(",["T_VARIABLE","$associatedEntity",93],")",["T_WHITESPACE"," ",93],["T_USE","use",93],["T_WHITESPACE"," ",93],"(",["T_VARIABLE","$entityInfo",93],",",["T_WHITESPACE"," ",93],["T_VARIABLE","$ruleIdField",93],",",["T_WHITESPACE"," ",93],["T_VARIABLE","$objectField",93],")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n            ",93],["T_VARIABLE","$item",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getItemByColumnValue",94],"(",["T_VARIABLE","$ruleIdField",94],",",["T_WHITESPACE"," ",94],["T_VARIABLE","$associatedEntity",94],"[",["T_VARIABLE","$ruleIdField",94],"]",")",";",["T_WHITESPACE","\n            ",94],["T_VARIABLE","$itemAssociatedValue",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$item",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getData",95],"(",["T_VARIABLE","$objectField",95],")",["T_WHITESPACE"," ",95],["T_IS_IDENTICAL","===",95],["T_WHITESPACE"," ",95],["T_STRING","null",95],["T_WHITESPACE"," ",95],"?",["T_WHITESPACE"," ",95],"[","]",["T_WHITESPACE"," ",95],":",["T_WHITESPACE"," ",95],["T_VARIABLE","$item",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getData",95],"(",["T_VARIABLE","$objectField",95],")",";",["T_WHITESPACE","\n            ",95],["T_VARIABLE","$itemAssociatedValue",96],"[","]",["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$associatedEntity",96],"[",["T_VARIABLE","$entityInfo",96],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id_field'",96],"]","]",";",["T_WHITESPACE","\n            ",96],["T_VARIABLE","$item",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","setData",97],"(",["T_VARIABLE","$objectField",97],",",["T_WHITESPACE"," ",97],["T_VARIABLE","$itemAssociatedValue",97],")",";",["T_WHITESPACE","\n        ",97],"}",",",["T_WHITESPACE"," ",98],["T_VARIABLE","$associatedEntities",98],")",";",["T_WHITESPACE","\n    ",98],"}",["T_WHITESPACE","\n\n    ",99],["T_DOC_COMMENT","\/**\n     * @return $this\n     * @throws \\Exception\n     *\/",101],["T_WHITESPACE","\n    ",104],["T_PROTECTED","protected",105],["T_WHITESPACE"," ",105],["T_FUNCTION","function",105],["T_WHITESPACE"," ",105],["T_STRING","_afterLoad",105],"(",")",["T_WHITESPACE","\n    ",105],"{",["T_WHITESPACE","\n        ",106],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","mapAssociatedEntities",107],"(",["T_CONSTANT_ENCAPSED_STRING","'website'",107],",",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'website_ids'",107],")",";",["T_WHITESPACE","\n        ",107],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","mapAssociatedEntities",108],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_group'",108],",",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'customer_group_ids'",108],")",";",["T_WHITESPACE","\n\n        ",108],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","setFlag",110],"(",["T_CONSTANT_ENCAPSED_STRING","'add_websites_to_result'",110],",",["T_WHITESPACE"," ",110],["T_STRING","false",110],")",";",["T_WHITESPACE","\n        ",110],["T_RETURN","return",111],["T_WHITESPACE"," ",111],["T_STRING","parent",111],["T_DOUBLE_COLON","::",111],["T_STRING","_afterLoad",111],"(",")",";",["T_WHITESPACE","\n    ",111],"}",["T_WHITESPACE","\n\n    ",112],["T_DOC_COMMENT","\/**\n     * Filter collection by specified website, customer group, coupon code, date.\n     * Filter collection to use only active rules.\n     * Involved sorting by sort_order column.\n     *\n     * @param int $websiteId\n     * @param int $customerGroupId\n     * @param string $couponCode\n     * @param string|null $now\n     * @param Address $address allow extensions to further filter out rules based on quote address\n     * @use $this->addWebsiteGroupDateFilter()\n     * @SuppressWarnings(PHPMD.UnusedFormalParameter)\n     * @return $this\n     *\/",114],["T_WHITESPACE","\n    ",127],["T_PUBLIC","public",128],["T_WHITESPACE"," ",128],["T_FUNCTION","function",128],["T_WHITESPACE"," ",128],["T_STRING","setValidationFilter",128],"(",["T_WHITESPACE","\n        ",128],["T_VARIABLE","$websiteId",129],",",["T_WHITESPACE","\n        ",129],["T_VARIABLE","$customerGroupId",130],",",["T_WHITESPACE","\n        ",130],["T_VARIABLE","$couponCode",131],["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_CONSTANT_ENCAPSED_STRING","''",131],",",["T_WHITESPACE","\n        ",131],["T_VARIABLE","$now",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_STRING","null",132],",",["T_WHITESPACE","\n        ",132],["T_STRING","Address",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$address",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_STRING","null",133],["T_WHITESPACE","\n    ",133],")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n        ",134],["T_IF","if",135],["T_WHITESPACE"," ",135],"(","!",["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getFlag",135],"(",["T_CONSTANT_ENCAPSED_STRING","'validation_filter'",135],")",")",["T_WHITESPACE"," ",135],"{",["T_WHITESPACE","\n            ",135],["T_COMMENT","\/* We need to overwrite joinLeft if coupon is applied *\/",136],["T_WHITESPACE","\n            ",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","getSelect",137],"(",")",["T_OBJECT_OPERATOR","->",137],["T_STRING","reset",137],"(",")",";",["T_WHITESPACE","\n            ",137],["T_STRING","parent",138],["T_DOUBLE_COLON","::",138],["T_STRING","_initSelect",138],"(",")",";",["T_WHITESPACE","\n\n            ",138],["T_VARIABLE","$this",140],["T_OBJECT_OPERATOR","->",140],["T_STRING","addWebsiteGroupDateFilter",140],"(",["T_VARIABLE","$websiteId",140],",",["T_WHITESPACE"," ",140],["T_VARIABLE","$customerGroupId",140],",",["T_WHITESPACE"," ",140],["T_VARIABLE","$now",140],")",";",["T_WHITESPACE","\n            ",140],["T_VARIABLE","$select",141],["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_VARIABLE","$this",141],["T_OBJECT_OPERATOR","->",141],["T_STRING","getSelect",141],"(",")",";",["T_WHITESPACE","\n\n            ",141],["T_VARIABLE","$connection",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","getConnection",143],"(",")",";",["T_WHITESPACE","\n            ",143],["T_IF","if",144],["T_WHITESPACE"," ",144],"(",["T_STRING","strlen",144],"(",["T_VARIABLE","$couponCode",144],")",")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n                ",144],["T_VARIABLE","$select",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","joinLeft",145],"(",["T_WHITESPACE","\n                    ",145],"[",["T_CONSTANT_ENCAPSED_STRING","'rule_coupons'",146],["T_WHITESPACE"," ",146],["T_DOUBLE_ARROW","=>",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","getTable",146],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule_coupon'",146],")","]",",",["T_WHITESPACE","\n                    ",146],["T_VARIABLE","$connection",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","quoteInto",147],"(",["T_WHITESPACE","\n                        ",147],["T_CONSTANT_ENCAPSED_STRING","'main_table.rule_id = rule_coupons.rule_id AND main_table.coupon_type != ?'",148],",",["T_WHITESPACE","\n                        ",148],["T_NS_SEPARATOR","\\",149],["T_STRING","Magento",149],["T_NS_SEPARATOR","\\",149],["T_STRING","SalesRule",149],["T_NS_SEPARATOR","\\",149],["T_STRING","Model",149],["T_NS_SEPARATOR","\\",149],["T_STRING","Rule",149],["T_DOUBLE_COLON","::",149],["T_STRING","COUPON_TYPE_NO_COUPON",149],["T_WHITESPACE","\n                    ",149],")",",",["T_WHITESPACE","\n                    ",150],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",151],"]",["T_WHITESPACE","\n                ",151],")",";",["T_WHITESPACE","\n\n                ",152],["T_VARIABLE","$noCouponWhereCondition",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_VARIABLE","$connection",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","quoteInto",154],"(",["T_WHITESPACE","\n                    ",154],["T_CONSTANT_ENCAPSED_STRING","'main_table.coupon_type = ? '",155],",",["T_WHITESPACE","\n                    ",155],["T_NS_SEPARATOR","\\",156],["T_STRING","Magento",156],["T_NS_SEPARATOR","\\",156],["T_STRING","SalesRule",156],["T_NS_SEPARATOR","\\",156],["T_STRING","Model",156],["T_NS_SEPARATOR","\\",156],["T_STRING","Rule",156],["T_DOUBLE_COLON","::",156],["T_STRING","COUPON_TYPE_NO_COUPON",156],["T_WHITESPACE","\n                ",156],")",";",["T_WHITESPACE","\n\n                ",157],["T_VARIABLE","$orWhereConditions",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],"[",["T_WHITESPACE","\n                    ",159],["T_VARIABLE","$connection",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","quoteInto",160],"(",["T_WHITESPACE","\n                        ",160],["T_CONSTANT_ENCAPSED_STRING","'(main_table.coupon_type = ? AND rule_coupons.type = 0)'",161],",",["T_WHITESPACE","\n                        ",161],["T_NS_SEPARATOR","\\",162],["T_STRING","Magento",162],["T_NS_SEPARATOR","\\",162],["T_STRING","SalesRule",162],["T_NS_SEPARATOR","\\",162],["T_STRING","Model",162],["T_NS_SEPARATOR","\\",162],["T_STRING","Rule",162],["T_DOUBLE_COLON","::",162],["T_STRING","COUPON_TYPE_AUTO",162],["T_WHITESPACE","\n                    ",162],")",",",["T_WHITESPACE","\n                    ",163],["T_VARIABLE","$connection",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","quoteInto",164],"(",["T_WHITESPACE","\n                        ",164],["T_CONSTANT_ENCAPSED_STRING","'(main_table.coupon_type = ? AND main_table.use_auto_generation = 1 AND rule_coupons.type = 1)'",165],",",["T_WHITESPACE","\n                        ",165],["T_NS_SEPARATOR","\\",166],["T_STRING","Magento",166],["T_NS_SEPARATOR","\\",166],["T_STRING","SalesRule",166],["T_NS_SEPARATOR","\\",166],["T_STRING","Model",166],["T_NS_SEPARATOR","\\",166],["T_STRING","Rule",166],["T_DOUBLE_COLON","::",166],["T_STRING","COUPON_TYPE_SPECIFIC",166],["T_WHITESPACE","\n                    ",166],")",",",["T_WHITESPACE","\n                    ",167],["T_VARIABLE","$connection",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","quoteInto",168],"(",["T_WHITESPACE","\n                        ",168],["T_CONSTANT_ENCAPSED_STRING","'(main_table.coupon_type = ? AND main_table.use_auto_generation = 0 AND rule_coupons.type = 0)'",169],",",["T_WHITESPACE","\n                        ",169],["T_NS_SEPARATOR","\\",170],["T_STRING","Magento",170],["T_NS_SEPARATOR","\\",170],["T_STRING","SalesRule",170],["T_NS_SEPARATOR","\\",170],["T_STRING","Model",170],["T_NS_SEPARATOR","\\",170],["T_STRING","Rule",170],["T_DOUBLE_COLON","::",170],["T_STRING","COUPON_TYPE_SPECIFIC",170],["T_WHITESPACE","\n                    ",170],")",",",["T_WHITESPACE","\n                ",171],"]",";",["T_WHITESPACE","\n\n                ",172],["T_VARIABLE","$andWhereConditions",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],"[",["T_WHITESPACE","\n                    ",174],["T_VARIABLE","$connection",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","quoteInto",175],"(",["T_WHITESPACE","\n                        ",175],["T_CONSTANT_ENCAPSED_STRING","'rule_coupons.code = ?'",176],",",["T_WHITESPACE","\n                        ",176],["T_VARIABLE","$couponCode",177],["T_WHITESPACE","\n                    ",177],")",",",["T_WHITESPACE","\n                    ",178],["T_VARIABLE","$connection",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","quoteInto",179],"(",["T_WHITESPACE","\n                        ",179],["T_CONSTANT_ENCAPSED_STRING","'(rule_coupons.expiration_date IS NULL OR rule_coupons.expiration_date >= ?)'",180],",",["T_WHITESPACE","\n                        ",180],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","_date",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","date",181],"(",")",["T_OBJECT_OPERATOR","->",181],["T_STRING","format",181],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d'",181],")",["T_WHITESPACE","\n                    ",181],")",",",["T_WHITESPACE","\n                ",182],"]",";",["T_WHITESPACE","\n\n                ",183],["T_VARIABLE","$orWhereCondition",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_STRING","implode",185],"(",["T_CONSTANT_ENCAPSED_STRING","' OR '",185],",",["T_WHITESPACE"," ",185],["T_VARIABLE","$orWhereConditions",185],")",";",["T_WHITESPACE","\n                ",185],["T_VARIABLE","$andWhereCondition",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_STRING","implode",186],"(",["T_CONSTANT_ENCAPSED_STRING","' AND '",186],",",["T_WHITESPACE"," ",186],["T_VARIABLE","$andWhereConditions",186],")",";",["T_WHITESPACE","\n\n                ",186],["T_VARIABLE","$select",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","where",188],"(",["T_WHITESPACE","\n                    ",188],["T_VARIABLE","$noCouponWhereCondition",189],["T_WHITESPACE"," ",189],".",["T_WHITESPACE"," ",189],["T_CONSTANT_ENCAPSED_STRING","' OR (('",189],["T_WHITESPACE"," ",189],".",["T_WHITESPACE"," ",189],["T_VARIABLE","$orWhereCondition",189],["T_WHITESPACE"," ",189],".",["T_WHITESPACE"," ",189],["T_CONSTANT_ENCAPSED_STRING","') AND '",189],["T_WHITESPACE"," ",189],".",["T_WHITESPACE"," ",189],["T_VARIABLE","$andWhereCondition",189],["T_WHITESPACE"," ",189],".",["T_WHITESPACE"," ",189],["T_CONSTANT_ENCAPSED_STRING","')'",189],["T_WHITESPACE","\n                ",189],")",";",["T_WHITESPACE","\n            ",190],"}",["T_WHITESPACE"," ",191],["T_ELSE","else",191],["T_WHITESPACE"," ",191],"{",["T_WHITESPACE","\n                ",191],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","addFieldToFilter",192],"(",["T_WHITESPACE","\n                    ",192],["T_CONSTANT_ENCAPSED_STRING","'main_table.coupon_type'",193],",",["T_WHITESPACE","\n                    ",193],["T_NS_SEPARATOR","\\",194],["T_STRING","Magento",194],["T_NS_SEPARATOR","\\",194],["T_STRING","SalesRule",194],["T_NS_SEPARATOR","\\",194],["T_STRING","Model",194],["T_NS_SEPARATOR","\\",194],["T_STRING","Rule",194],["T_DOUBLE_COLON","::",194],["T_STRING","COUPON_TYPE_NO_COUPON",194],["T_WHITESPACE","\n                ",194],")",";",["T_WHITESPACE","\n            ",195],"}",["T_WHITESPACE","\n            ",196],["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","setOrder",197],"(",["T_CONSTANT_ENCAPSED_STRING","'sort_order'",197],",",["T_WHITESPACE"," ",197],["T_STRING","self",197],["T_DOUBLE_COLON","::",197],["T_STRING","SORT_ORDER_ASC",197],")",";",["T_WHITESPACE","\n            ",197],["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","setFlag",198],"(",["T_CONSTANT_ENCAPSED_STRING","'validation_filter'",198],",",["T_WHITESPACE"," ",198],["T_STRING","true",198],")",";",["T_WHITESPACE","\n        ",198],"}",["T_WHITESPACE","\n\n        ",199],["T_RETURN","return",201],["T_WHITESPACE"," ",201],["T_VARIABLE","$this",201],";",["T_WHITESPACE","\n    ",201],"}",["T_WHITESPACE","\n\n    ",202],["T_DOC_COMMENT","\/**\n     * Filter collection by website(s), customer group(s) and date.\n     * Filter collection to only active rules.\n     * Sorting is not involved\n     *\n     * @param int $websiteId\n     * @param int $customerGroupId\n     * @param string|null $now\n     * @use $this->addWebsiteFilter()\n     * @return $this\n     *\/",204],["T_WHITESPACE","\n    ",214],["T_PUBLIC","public",215],["T_WHITESPACE"," ",215],["T_FUNCTION","function",215],["T_WHITESPACE"," ",215],["T_STRING","addWebsiteGroupDateFilter",215],"(",["T_VARIABLE","$websiteId",215],",",["T_WHITESPACE"," ",215],["T_VARIABLE","$customerGroupId",215],",",["T_WHITESPACE"," ",215],["T_VARIABLE","$now",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_STRING","null",215],")",["T_WHITESPACE","\n    ",215],"{",["T_WHITESPACE","\n        ",216],["T_IF","if",217],["T_WHITESPACE"," ",217],"(","!",["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","getFlag",217],"(",["T_CONSTANT_ENCAPSED_STRING","'website_group_date_filter'",217],")",")",["T_WHITESPACE"," ",217],"{",["T_WHITESPACE","\n            ",217],["T_IF","if",218],["T_WHITESPACE"," ",218],"(",["T_VARIABLE","$now",218],["T_WHITESPACE"," ",218],["T_IS_IDENTICAL","===",218],["T_WHITESPACE"," ",218],["T_STRING","null",218],")",["T_WHITESPACE"," ",218],"{",["T_WHITESPACE","\n                ",218],["T_VARIABLE","$now",219],["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","_date",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","date",219],"(",")",["T_OBJECT_OPERATOR","->",219],["T_STRING","format",219],"(",["T_CONSTANT_ENCAPSED_STRING","'Y-m-d'",219],")",";",["T_WHITESPACE","\n            ",219],"}",["T_WHITESPACE","\n\n            ",220],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","addWebsiteFilter",222],"(",["T_VARIABLE","$websiteId",222],")",";",["T_WHITESPACE","\n\n            ",222],["T_VARIABLE","$entityInfo",224],["T_WHITESPACE"," ",224],"=",["T_WHITESPACE"," ",224],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","_getAssociatedEntityInfo",224],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_group'",224],")",";",["T_WHITESPACE","\n            ",224],["T_VARIABLE","$connection",225],["T_WHITESPACE"," ",225],"=",["T_WHITESPACE"," ",225],["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","getConnection",225],"(",")",";",["T_WHITESPACE","\n            ",225],["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","getSelect",226],"(",")",["T_OBJECT_OPERATOR","->",226],["T_STRING","joinInner",226],"(",["T_WHITESPACE","\n                ",226],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_group_ids'",227],["T_WHITESPACE"," ",227],["T_DOUBLE_ARROW","=>",227],["T_WHITESPACE"," ",227],["T_VARIABLE","$this",227],["T_OBJECT_OPERATOR","->",227],["T_STRING","getTable",227],"(",["T_VARIABLE","$entityInfo",227],"[",["T_CONSTANT_ENCAPSED_STRING","'associations_table'",227],"]",")","]",",",["T_WHITESPACE","\n                ",227],["T_VARIABLE","$connection",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","quoteInto",228],"(",["T_WHITESPACE","\n                    ",228],["T_CONSTANT_ENCAPSED_STRING","'main_table.'",229],["T_WHITESPACE"," ",229],".",["T_WHITESPACE","\n                    ",229],["T_VARIABLE","$entityInfo",230],"[",["T_CONSTANT_ENCAPSED_STRING","'rule_id_field'",230],"]",["T_WHITESPACE"," ",230],".",["T_WHITESPACE","\n                    ",230],["T_CONSTANT_ENCAPSED_STRING","' = customer_group_ids.'",231],["T_WHITESPACE"," ",231],".",["T_WHITESPACE","\n                    ",231],["T_VARIABLE","$entityInfo",232],"[",["T_CONSTANT_ENCAPSED_STRING","'rule_id_field'",232],"]",["T_WHITESPACE"," ",232],".",["T_WHITESPACE","\n                    ",232],["T_CONSTANT_ENCAPSED_STRING","' AND customer_group_ids.'",233],["T_WHITESPACE"," ",233],".",["T_WHITESPACE","\n                    ",233],["T_VARIABLE","$entityInfo",234],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id_field'",234],"]",["T_WHITESPACE"," ",234],".",["T_WHITESPACE","\n                    ",234],["T_CONSTANT_ENCAPSED_STRING","' = ?'",235],",",["T_WHITESPACE","\n                    ",235],["T_INT_CAST","(int)",236],["T_VARIABLE","$customerGroupId",236],["T_WHITESPACE","\n                ",236],")",",",["T_WHITESPACE","\n                ",237],"[","]",["T_WHITESPACE","\n            ",238],")",";",["T_WHITESPACE","\n\n            ",239],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","getDateApplier",241],"(",")",["T_OBJECT_OPERATOR","->",241],["T_STRING","applyDate",241],"(",["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","getSelect",241],"(",")",",",["T_WHITESPACE"," ",241],["T_VARIABLE","$now",241],")",";",["T_WHITESPACE","\n\n            ",241],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","addIsActiveFilter",243],"(",")",";",["T_WHITESPACE","\n\n            ",243],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","setFlag",245],"(",["T_CONSTANT_ENCAPSED_STRING","'website_group_date_filter'",245],",",["T_WHITESPACE"," ",245],["T_STRING","true",245],")",";",["T_WHITESPACE","\n        ",245],"}",["T_WHITESPACE","\n\n        ",246],["T_RETURN","return",248],["T_WHITESPACE"," ",248],["T_VARIABLE","$this",248],";",["T_WHITESPACE","\n    ",248],"}",["T_WHITESPACE","\n\n    ",249],["T_DOC_COMMENT","\/**\n     * Add primary coupon to collection\n     *\n     * @return $this\n     *\/",251],["T_WHITESPACE","\n    ",255],["T_PUBLIC","public",256],["T_WHITESPACE"," ",256],["T_FUNCTION","function",256],["T_WHITESPACE"," ",256],["T_STRING","_initSelect",256],"(",")",["T_WHITESPACE","\n    ",256],"{",["T_WHITESPACE","\n        ",257],["T_STRING","parent",258],["T_DOUBLE_COLON","::",258],["T_STRING","_initSelect",258],"(",")",";",["T_WHITESPACE","\n        ",258],["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","getSelect",259],"(",")",["T_OBJECT_OPERATOR","->",259],["T_STRING","joinLeft",259],"(",["T_WHITESPACE","\n            ",259],"[",["T_CONSTANT_ENCAPSED_STRING","'rule_coupons'",260],["T_WHITESPACE"," ",260],["T_DOUBLE_ARROW","=>",260],["T_WHITESPACE"," ",260],["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","getTable",260],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule_coupon'",260],")","]",",",["T_WHITESPACE","\n            ",260],["T_CONSTANT_ENCAPSED_STRING","'main_table.rule_id = rule_coupons.rule_id AND rule_coupons.is_primary = 1'",261],",",["T_WHITESPACE","\n            ",261],"[",["T_CONSTANT_ENCAPSED_STRING","'code'",262],"]",["T_WHITESPACE","\n        ",262],")",";",["T_WHITESPACE","\n        ",263],["T_RETURN","return",264],["T_WHITESPACE"," ",264],["T_VARIABLE","$this",264],";",["T_WHITESPACE","\n    ",264],"}",["T_WHITESPACE","\n\n    ",265],["T_DOC_COMMENT","\/**\n     * Find product attribute in conditions or actions\n     *\n     * @param string $attributeCode\n     * @return $this\n     *\/",267],["T_WHITESPACE","\n    ",272],["T_PUBLIC","public",273],["T_WHITESPACE"," ",273],["T_FUNCTION","function",273],["T_WHITESPACE"," ",273],["T_STRING","addAttributeInConditionFilter",273],"(",["T_VARIABLE","$attributeCode",273],")",["T_WHITESPACE","\n    ",273],"{",["T_WHITESPACE","\n        ",274],["T_VARIABLE","$match",275],["T_WHITESPACE"," ",275],"=",["T_WHITESPACE"," ",275],["T_STRING","sprintf",275],"(",["T_CONSTANT_ENCAPSED_STRING","'%%%s%%'",275],",",["T_WHITESPACE"," ",275],["T_STRING","substr",275],"(",["T_STRING","serialize",275],"(","[",["T_CONSTANT_ENCAPSED_STRING","'attribute'",275],["T_WHITESPACE"," ",275],["T_DOUBLE_ARROW","=>",275],["T_WHITESPACE"," ",275],["T_VARIABLE","$attributeCode",275],"]",")",",",["T_WHITESPACE"," ",275],["T_LNUMBER","5",275],",",["T_WHITESPACE"," ",275],"-",["T_LNUMBER","1",275],")",")",";",["T_WHITESPACE","\n        ",275],["T_VARIABLE","$field",276],["T_WHITESPACE"," ",276],"=",["T_WHITESPACE"," ",276],["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","_getMappedField",276],"(",["T_CONSTANT_ENCAPSED_STRING","'conditions_serialized'",276],")",";",["T_WHITESPACE","\n        ",276],["T_VARIABLE","$cCond",277],["T_WHITESPACE"," ",277],"=",["T_WHITESPACE"," ",277],["T_VARIABLE","$this",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","_getConditionSql",277],"(",["T_VARIABLE","$field",277],",",["T_WHITESPACE"," ",277],"[",["T_CONSTANT_ENCAPSED_STRING","'like'",277],["T_WHITESPACE"," ",277],["T_DOUBLE_ARROW","=>",277],["T_WHITESPACE"," ",277],["T_VARIABLE","$match",277],"]",")",";",["T_WHITESPACE","\n        ",277],["T_VARIABLE","$field",278],["T_WHITESPACE"," ",278],"=",["T_WHITESPACE"," ",278],["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","_getMappedField",278],"(",["T_CONSTANT_ENCAPSED_STRING","'actions_serialized'",278],")",";",["T_WHITESPACE","\n        ",278],["T_VARIABLE","$aCond",279],["T_WHITESPACE"," ",279],"=",["T_WHITESPACE"," ",279],["T_VARIABLE","$this",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","_getConditionSql",279],"(",["T_VARIABLE","$field",279],",",["T_WHITESPACE"," ",279],"[",["T_CONSTANT_ENCAPSED_STRING","'like'",279],["T_WHITESPACE"," ",279],["T_DOUBLE_ARROW","=>",279],["T_WHITESPACE"," ",279],["T_VARIABLE","$match",279],"]",")",";",["T_WHITESPACE","\n\n        ",279],["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","getSelect",281],"(",")",["T_OBJECT_OPERATOR","->",281],["T_STRING","where",281],"(",["T_WHITESPACE","\n            ",281],["T_STRING","sprintf",282],"(",["T_CONSTANT_ENCAPSED_STRING","'(%s OR %s)'",282],",",["T_WHITESPACE"," ",282],["T_VARIABLE","$cCond",282],",",["T_WHITESPACE"," ",282],["T_VARIABLE","$aCond",282],")",",",["T_WHITESPACE","\n            ",282],["T_STRING","null",283],",",["T_WHITESPACE","\n            ",283],["T_NS_SEPARATOR","\\",284],["T_STRING","Magento",284],["T_NS_SEPARATOR","\\",284],["T_STRING","Framework",284],["T_NS_SEPARATOR","\\",284],["T_STRING","DB",284],["T_NS_SEPARATOR","\\",284],["T_STRING","Select",284],["T_DOUBLE_COLON","::",284],["T_STRING","TYPE_CONDITION",284],["T_WHITESPACE","\n        ",284],")",";",["T_WHITESPACE","\n\n        ",285],["T_RETURN","return",287],["T_WHITESPACE"," ",287],["T_VARIABLE","$this",287],";",["T_WHITESPACE","\n    ",287],"}",["T_WHITESPACE","\n\n    ",288],["T_DOC_COMMENT","\/**\n     * Excludes price rules with generated specific coupon codes from collection\n     *\n     * @return $this\n     *\/",290],["T_WHITESPACE","\n    ",294],["T_PUBLIC","public",295],["T_WHITESPACE"," ",295],["T_FUNCTION","function",295],["T_WHITESPACE"," ",295],["T_STRING","addAllowedSalesRulesFilter",295],"(",")",["T_WHITESPACE","\n    ",295],"{",["T_WHITESPACE","\n        ",296],["T_VARIABLE","$this",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","addFieldToFilter",297],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.use_auto_generation'",297],",",["T_WHITESPACE"," ",297],"[",["T_CONSTANT_ENCAPSED_STRING","'neq'",297],["T_WHITESPACE"," ",297],["T_DOUBLE_ARROW","=>",297],["T_WHITESPACE"," ",297],["T_LNUMBER","1",297],"]",")",";",["T_WHITESPACE","\n\n        ",297],["T_RETURN","return",299],["T_WHITESPACE"," ",299],["T_VARIABLE","$this",299],";",["T_WHITESPACE","\n    ",299],"}",["T_WHITESPACE","\n\n    ",300],["T_DOC_COMMENT","\/**\n     * Limit rules collection by specific customer group\n     *\n     * @param int $customerGroupId\n     * @return $this\n     *\/",302],["T_WHITESPACE","\n    ",307],["T_PUBLIC","public",308],["T_WHITESPACE"," ",308],["T_FUNCTION","function",308],["T_WHITESPACE"," ",308],["T_STRING","addCustomerGroupFilter",308],"(",["T_VARIABLE","$customerGroupId",308],")",["T_WHITESPACE","\n    ",308],"{",["T_WHITESPACE","\n        ",309],["T_VARIABLE","$entityInfo",310],["T_WHITESPACE"," ",310],"=",["T_WHITESPACE"," ",310],["T_VARIABLE","$this",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","_getAssociatedEntityInfo",310],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_group'",310],")",";",["T_WHITESPACE","\n        ",310],["T_IF","if",311],["T_WHITESPACE"," ",311],"(","!",["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","getFlag",311],"(",["T_CONSTANT_ENCAPSED_STRING","'is_customer_group_joined'",311],")",")",["T_WHITESPACE"," ",311],"{",["T_WHITESPACE","\n            ",311],["T_VARIABLE","$this",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","setFlag",312],"(",["T_CONSTANT_ENCAPSED_STRING","'is_customer_group_joined'",312],",",["T_WHITESPACE"," ",312],["T_STRING","true",312],")",";",["T_WHITESPACE","\n            ",312],["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","getSelect",313],"(",")",["T_OBJECT_OPERATOR","->",313],["T_STRING","join",313],"(",["T_WHITESPACE","\n                ",313],"[",["T_CONSTANT_ENCAPSED_STRING","'customer_group'",314],["T_WHITESPACE"," ",314],["T_DOUBLE_ARROW","=>",314],["T_WHITESPACE"," ",314],["T_VARIABLE","$this",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","getTable",314],"(",["T_VARIABLE","$entityInfo",314],"[",["T_CONSTANT_ENCAPSED_STRING","'associations_table'",314],"]",")","]",",",["T_WHITESPACE","\n                ",314],["T_VARIABLE","$this",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","getConnection",315],"(",")",["T_WHITESPACE","\n                    ",315],["T_OBJECT_OPERATOR","->",316],["T_STRING","quoteInto",316],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_group.'",316],["T_WHITESPACE"," ",316],".",["T_WHITESPACE"," ",316],["T_VARIABLE","$entityInfo",316],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id_field'",316],"]",["T_WHITESPACE"," ",316],".",["T_WHITESPACE"," ",316],["T_CONSTANT_ENCAPSED_STRING","' = ?'",316],",",["T_WHITESPACE"," ",316],["T_VARIABLE","$customerGroupId",316],")",["T_WHITESPACE","\n                ",316],".",["T_WHITESPACE"," ",317],["T_CONSTANT_ENCAPSED_STRING","' AND main_table.'",317],["T_WHITESPACE"," ",317],".",["T_WHITESPACE"," ",317],["T_VARIABLE","$entityInfo",317],"[",["T_CONSTANT_ENCAPSED_STRING","'rule_id_field'",317],"]",["T_WHITESPACE"," ",317],".",["T_WHITESPACE"," ",317],["T_CONSTANT_ENCAPSED_STRING","' = customer_group.'",317],["T_WHITESPACE","\n                ",317],".",["T_WHITESPACE"," ",318],["T_VARIABLE","$entityInfo",318],"[",["T_CONSTANT_ENCAPSED_STRING","'rule_id_field'",318],"]",",",["T_WHITESPACE","\n                ",318],"[","]",["T_WHITESPACE","\n            ",319],")",";",["T_WHITESPACE","\n        ",320],"}",["T_WHITESPACE","\n        ",321],["T_RETURN","return",322],["T_WHITESPACE"," ",322],["T_VARIABLE","$this",322],";",["T_WHITESPACE","\n    ",322],"}",["T_WHITESPACE","\n\n    ",323],["T_DOC_COMMENT","\/**\n     * @return array\n     * @deprecated\n     *\/",325],["T_WHITESPACE","\n    ",328],["T_PRIVATE","private",329],["T_WHITESPACE"," ",329],["T_FUNCTION","function",329],["T_WHITESPACE"," ",329],["T_STRING","getAssociatedEntitiesMap",329],"(",")",["T_WHITESPACE","\n    ",329],"{",["T_WHITESPACE","\n        ",330],["T_IF","if",331],["T_WHITESPACE"," ",331],"(","!",["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","_associatedEntitiesMap",331],")",["T_WHITESPACE"," ",331],"{",["T_WHITESPACE","\n            ",331],["T_VARIABLE","$this",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","_associatedEntitiesMap",332],["T_WHITESPACE"," ",332],"=",["T_WHITESPACE"," ",332],["T_NS_SEPARATOR","\\",332],["T_STRING","Magento",332],["T_NS_SEPARATOR","\\",332],["T_STRING","Framework",332],["T_NS_SEPARATOR","\\",332],["T_STRING","App",332],["T_NS_SEPARATOR","\\",332],["T_STRING","ObjectManager",332],["T_DOUBLE_COLON","::",332],["T_STRING","getInstance",332],"(",")",["T_WHITESPACE","\n                ",332],["T_OBJECT_OPERATOR","->",333],["T_STRING","get",333],"(",["T_NS_SEPARATOR","\\",333],["T_STRING","Magento",333],["T_NS_SEPARATOR","\\",333],["T_STRING","SalesRule",333],["T_NS_SEPARATOR","\\",333],["T_STRING","Model",333],["T_NS_SEPARATOR","\\",333],["T_STRING","ResourceModel",333],["T_NS_SEPARATOR","\\",333],["T_STRING","Rule",333],["T_NS_SEPARATOR","\\",333],["T_STRING","AssociatedEntityMap",333],["T_DOUBLE_COLON","::",333],["T_CLASS","class",333],")",["T_WHITESPACE","\n                ",333],["T_OBJECT_OPERATOR","->",334],["T_STRING","getData",334],"(",")",";",["T_WHITESPACE","\n        ",334],"}",["T_WHITESPACE","\n        ",335],["T_RETURN","return",336],["T_WHITESPACE"," ",336],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","_associatedEntitiesMap",336],";",["T_WHITESPACE","\n    ",336],"}",["T_WHITESPACE","\n\n    ",337],["T_DOC_COMMENT","\/**\n     * @return DateApplier\n     * @deprecated\n     *\/",339],["T_WHITESPACE","\n    ",342],["T_PRIVATE","private",343],["T_WHITESPACE"," ",343],["T_FUNCTION","function",343],["T_WHITESPACE"," ",343],["T_STRING","getDateApplier",343],"(",")",["T_WHITESPACE","\n    ",343],"{",["T_WHITESPACE","\n        ",344],["T_IF","if",345],["T_WHITESPACE"," ",345],"(",["T_STRING","null",345],["T_WHITESPACE"," ",345],["T_IS_IDENTICAL","===",345],["T_WHITESPACE"," ",345],["T_VARIABLE","$this",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","dateApplier",345],")",["T_WHITESPACE"," ",345],"{",["T_WHITESPACE","\n            ",345],["T_VARIABLE","$this",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","dateApplier",346],["T_WHITESPACE"," ",346],"=",["T_WHITESPACE"," ",346],["T_NS_SEPARATOR","\\",346],["T_STRING","Magento",346],["T_NS_SEPARATOR","\\",346],["T_STRING","Framework",346],["T_NS_SEPARATOR","\\",346],["T_STRING","App",346],["T_NS_SEPARATOR","\\",346],["T_STRING","ObjectManager",346],["T_DOUBLE_COLON","::",346],["T_STRING","getInstance",346],"(",")",["T_WHITESPACE","\n                ",346],["T_OBJECT_OPERATOR","->",347],["T_STRING","get",347],"(",["T_NS_SEPARATOR","\\",347],["T_STRING","Magento",347],["T_NS_SEPARATOR","\\",347],["T_STRING","SalesRule",347],["T_NS_SEPARATOR","\\",347],["T_STRING","Model",347],["T_NS_SEPARATOR","\\",347],["T_STRING","ResourceModel",347],["T_NS_SEPARATOR","\\",347],["T_STRING","Rule",347],["T_NS_SEPARATOR","\\",347],["T_STRING","DateApplier",347],["T_DOUBLE_COLON","::",347],["T_CLASS","class",347],")",";",["T_WHITESPACE","\n        ",347],"}",["T_WHITESPACE","\n\n        ",348],["T_RETURN","return",350],["T_WHITESPACE"," ",350],["T_VARIABLE","$this",350],["T_OBJECT_OPERATOR","->",350],["T_STRING","dateApplier",350],";",["T_WHITESPACE","\n    ",350],"}",["T_WHITESPACE","\n",351],"}",["T_WHITESPACE","\n",352]]