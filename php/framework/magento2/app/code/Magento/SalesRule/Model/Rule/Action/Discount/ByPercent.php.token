[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","SalesRule",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Rule",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Action",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Discount",6],";",["T_WHITESPACE","\n\n",6],["T_CLASS","class",8],["T_WHITESPACE"," ",8],["T_STRING","ByPercent",8],["T_WHITESPACE"," ",8],["T_EXTENDS","extends",8],["T_WHITESPACE"," ",8],["T_STRING","AbstractDiscount",8],["T_WHITESPACE","\n",8],"{",["T_WHITESPACE","\n    ",9],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\SalesRule\\Model\\Rule $rule\n     * @param \\Magento\\Quote\\Model\\Quote\\Item\\AbstractItem $item\n     * @param float $qty\n     * @return Data\n     *\/",10],["T_WHITESPACE","\n    ",15],["T_PUBLIC","public",16],["T_WHITESPACE"," ",16],["T_FUNCTION","function",16],["T_WHITESPACE"," ",16],["T_STRING","calculate",16],"(",["T_VARIABLE","$rule",16],",",["T_WHITESPACE"," ",16],["T_VARIABLE","$item",16],",",["T_WHITESPACE"," ",16],["T_VARIABLE","$qty",16],")",["T_WHITESPACE","\n    ",16],"{",["T_WHITESPACE","\n        ",17],["T_VARIABLE","$rulePercent",18],["T_WHITESPACE"," ",18],"=",["T_WHITESPACE"," ",18],["T_STRING","min",18],"(",["T_LNUMBER","100",18],",",["T_WHITESPACE"," ",18],["T_VARIABLE","$rule",18],["T_OBJECT_OPERATOR","->",18],["T_STRING","getDiscountAmount",18],"(",")",")",";",["T_WHITESPACE","\n        ",18],["T_VARIABLE","$discountData",19],["T_WHITESPACE"," ",19],"=",["T_WHITESPACE"," ",19],["T_VARIABLE","$this",19],["T_OBJECT_OPERATOR","->",19],["T_STRING","_calculate",19],"(",["T_VARIABLE","$rule",19],",",["T_WHITESPACE"," ",19],["T_VARIABLE","$item",19],",",["T_WHITESPACE"," ",19],["T_VARIABLE","$qty",19],",",["T_WHITESPACE"," ",19],["T_VARIABLE","$rulePercent",19],")",";",["T_WHITESPACE","\n\n        ",19],["T_RETURN","return",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$discountData",21],";",["T_WHITESPACE","\n    ",21],"}",["T_WHITESPACE","\n\n    ",22],["T_DOC_COMMENT","\/**\n     * @param float $qty\n     * @param \\Magento\\SalesRule\\Model\\Rule $rule\n     * @return float\n     *\/",24],["T_WHITESPACE","\n    ",28],["T_PUBLIC","public",29],["T_WHITESPACE"," ",29],["T_FUNCTION","function",29],["T_WHITESPACE"," ",29],["T_STRING","fixQuantity",29],"(",["T_VARIABLE","$qty",29],",",["T_WHITESPACE"," ",29],["T_VARIABLE","$rule",29],")",["T_WHITESPACE","\n    ",29],"{",["T_WHITESPACE","\n        ",30],["T_VARIABLE","$step",31],["T_WHITESPACE"," ",31],"=",["T_WHITESPACE"," ",31],["T_VARIABLE","$rule",31],["T_OBJECT_OPERATOR","->",31],["T_STRING","getDiscountStep",31],"(",")",";",["T_WHITESPACE","\n        ",31],["T_IF","if",32],["T_WHITESPACE"," ",32],"(",["T_VARIABLE","$step",32],")",["T_WHITESPACE"," ",32],"{",["T_WHITESPACE","\n            ",32],["T_VARIABLE","$qty",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_STRING","floor",33],"(",["T_VARIABLE","$qty",33],["T_WHITESPACE"," ",33],"\/",["T_WHITESPACE"," ",33],["T_VARIABLE","$step",33],")",["T_WHITESPACE"," ",33],"*",["T_WHITESPACE"," ",33],["T_VARIABLE","$step",33],";",["T_WHITESPACE","\n        ",33],"}",["T_WHITESPACE","\n\n        ",34],["T_RETURN","return",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$qty",36],";",["T_WHITESPACE","\n    ",36],"}",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\SalesRule\\Model\\Rule $rule\n     * @param \\Magento\\Quote\\Model\\Quote\\Item\\AbstractItem $item\n     * @param float $qty\n     * @param float $rulePercent\n     * @return Data\n     *\/",39],["T_WHITESPACE","\n    ",45],["T_PROTECTED","protected",46],["T_WHITESPACE"," ",46],["T_FUNCTION","function",46],["T_WHITESPACE"," ",46],["T_STRING","_calculate",46],"(",["T_VARIABLE","$rule",46],",",["T_WHITESPACE"," ",46],["T_VARIABLE","$item",46],",",["T_WHITESPACE"," ",46],["T_VARIABLE","$qty",46],",",["T_WHITESPACE"," ",46],["T_VARIABLE","$rulePercent",46],")",["T_WHITESPACE","\n    ",46],"{",["T_WHITESPACE","\n        ",47],["T_DOC_COMMENT","\/** @var \\Magento\\SalesRule\\Model\\Rule\\Action\\Discount\\Data $discountData *\/",48],["T_WHITESPACE","\n        ",48],["T_VARIABLE","$discountData",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","discountFactory",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","create",49],"(",")",";",["T_WHITESPACE","\n\n        ",49],["T_VARIABLE","$itemPrice",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","validator",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","getItemPrice",51],"(",["T_VARIABLE","$item",51],")",";",["T_WHITESPACE","\n        ",51],["T_VARIABLE","$baseItemPrice",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","validator",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","getItemBasePrice",52],"(",["T_VARIABLE","$item",52],")",";",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$itemOriginalPrice",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","validator",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","getItemOriginalPrice",53],"(",["T_VARIABLE","$item",53],")",";",["T_WHITESPACE","\n        ",53],["T_VARIABLE","$baseItemOriginalPrice",54],["T_WHITESPACE"," ",54],"=",["T_WHITESPACE"," ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","validator",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","getItemBaseOriginalPrice",54],"(",["T_VARIABLE","$item",54],")",";",["T_WHITESPACE","\n\n        ",54],["T_VARIABLE","$_rulePct",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$rulePercent",56],["T_WHITESPACE"," ",56],"\/",["T_WHITESPACE"," ",56],["T_LNUMBER","100",56],";",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$discountData",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","setAmount",57],"(","(",["T_VARIABLE","$qty",57],["T_WHITESPACE"," ",57],"*",["T_WHITESPACE"," ",57],["T_VARIABLE","$itemPrice",57],["T_WHITESPACE"," ",57],"-",["T_WHITESPACE"," ",57],["T_VARIABLE","$item",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","getDiscountAmount",57],"(",")",")",["T_WHITESPACE"," ",57],"*",["T_WHITESPACE"," ",57],["T_VARIABLE","$_rulePct",57],")",";",["T_WHITESPACE","\n        ",57],["T_VARIABLE","$discountData",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","setBaseAmount",58],"(","(",["T_VARIABLE","$qty",58],["T_WHITESPACE"," ",58],"*",["T_WHITESPACE"," ",58],["T_VARIABLE","$baseItemPrice",58],["T_WHITESPACE"," ",58],"-",["T_WHITESPACE"," ",58],["T_VARIABLE","$item",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","getBaseDiscountAmount",58],"(",")",")",["T_WHITESPACE"," ",58],"*",["T_WHITESPACE"," ",58],["T_VARIABLE","$_rulePct",58],")",";",["T_WHITESPACE","\n        ",58],["T_VARIABLE","$discountData",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","setOriginalAmount",59],"(","(",["T_VARIABLE","$qty",59],["T_WHITESPACE"," ",59],"*",["T_WHITESPACE"," ",59],["T_VARIABLE","$itemOriginalPrice",59],["T_WHITESPACE"," ",59],"-",["T_WHITESPACE"," ",59],["T_VARIABLE","$item",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","getDiscountAmount",59],"(",")",")",["T_WHITESPACE"," ",59],"*",["T_WHITESPACE"," ",59],["T_VARIABLE","$_rulePct",59],")",";",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$discountData",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","setBaseOriginalAmount",60],"(",["T_WHITESPACE","\n            ",60],"(",["T_VARIABLE","$qty",61],["T_WHITESPACE"," ",61],"*",["T_WHITESPACE"," ",61],["T_VARIABLE","$baseItemOriginalPrice",61],["T_WHITESPACE"," ",61],"-",["T_WHITESPACE"," ",61],["T_VARIABLE","$item",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","getBaseDiscountAmount",61],"(",")",")",["T_WHITESPACE"," ",61],"*",["T_WHITESPACE"," ",61],["T_VARIABLE","$_rulePct",61],["T_WHITESPACE","\n        ",61],")",";",["T_WHITESPACE","\n\n        ",62],["T_IF","if",64],["T_WHITESPACE"," ",64],"(","!",["T_VARIABLE","$rule",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","getDiscountQty",64],"(",")",["T_WHITESPACE"," ",64],["T_BOOLEAN_OR","||",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$rule",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","getDiscountQty",64],"(",")",["T_WHITESPACE"," ",64],">",["T_WHITESPACE"," ",64],["T_VARIABLE","$qty",64],")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n            ",64],["T_VARIABLE","$discountPercent",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_STRING","min",65],"(",["T_LNUMBER","100",65],",",["T_WHITESPACE"," ",65],["T_VARIABLE","$item",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getDiscountPercent",65],"(",")",["T_WHITESPACE"," ",65],"+",["T_WHITESPACE"," ",65],["T_VARIABLE","$rulePercent",65],")",";",["T_WHITESPACE","\n            ",65],["T_VARIABLE","$item",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","setDiscountPercent",66],"(",["T_VARIABLE","$discountPercent",66],")",";",["T_WHITESPACE","\n        ",66],"}",["T_WHITESPACE","\n\n        ",67],["T_RETURN","return",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$discountData",69],";",["T_WHITESPACE","\n    ",69],"}",["T_WHITESPACE","\n",70],"}",["T_WHITESPACE","\n",71]]