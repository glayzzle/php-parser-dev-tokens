[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","SalesRule",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","ResourceModel",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Report",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Rule report resource model\n *\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",8],["T_WHITESPACE","\n",12],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","Rule",13],["T_WHITESPACE"," ",13],["T_EXTENDS","extends",13],["T_WHITESPACE"," ",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Reports",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Model",13],["T_NS_SEPARATOR","\\",13],["T_STRING","ResourceModel",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Report",13],["T_NS_SEPARATOR","\\",13],["T_STRING","AbstractReport",13],["T_WHITESPACE","\n",13],"{",["T_WHITESPACE","\n    ",14],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\SalesRule\\Model\\ResourceModel\\Report\\Rule\\CreatedatFactory\n     *\/",15],["T_WHITESPACE","\n    ",17],["T_PROTECTED","protected",18],["T_WHITESPACE"," ",18],["T_VARIABLE","$_createdatFactory",18],";",["T_WHITESPACE","\n\n    ",18],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\SalesRule\\Model\\ResourceModel\\Report\\Rule\\UpdatedatFactory\n     *\/",20],["T_WHITESPACE","\n    ",22],["T_PROTECTED","protected",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$_updatedatFactory",23],";",["T_WHITESPACE","\n\n    ",23],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\Model\\ResourceModel\\Db\\Context $context\n     * @param \\Psr\\Log\\LoggerInterface $logger\n     * @param \\Magento\\Framework\\Stdlib\\DateTime\\TimezoneInterface $localeDate\n     * @param \\Magento\\Reports\\Model\\FlagFactory $reportsFlagFactory\n     * @param \\Magento\\Framework\\Stdlib\\DateTime\\Timezone\\Validator $timezoneValidator\n     * @param \\Magento\\Framework\\Stdlib\\DateTime\\DateTime $dateTime\n     * @param \\Magento\\SalesRule\\Model\\ResourceModel\\Report\\Rule\\CreatedatFactory $createdatFactory\n     * @param \\Magento\\SalesRule\\Model\\ResourceModel\\Report\\Rule\\UpdatedatFactory $updatedatFactory\n     * @param string $connectionName\n     *\/",25],["T_WHITESPACE","\n    ",35],["T_PUBLIC","public",36],["T_WHITESPACE"," ",36],["T_FUNCTION","function",36],["T_WHITESPACE"," ",36],["T_STRING","__construct",36],"(",["T_WHITESPACE","\n        ",36],["T_NS_SEPARATOR","\\",37],["T_STRING","Magento",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Framework",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Model",37],["T_NS_SEPARATOR","\\",37],["T_STRING","ResourceModel",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Db",37],["T_NS_SEPARATOR","\\",37],["T_STRING","Context",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$context",37],",",["T_WHITESPACE","\n        ",37],["T_NS_SEPARATOR","\\",38],["T_STRING","Psr",38],["T_NS_SEPARATOR","\\",38],["T_STRING","Log",38],["T_NS_SEPARATOR","\\",38],["T_STRING","LoggerInterface",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$logger",38],",",["T_WHITESPACE","\n        ",38],["T_NS_SEPARATOR","\\",39],["T_STRING","Magento",39],["T_NS_SEPARATOR","\\",39],["T_STRING","Framework",39],["T_NS_SEPARATOR","\\",39],["T_STRING","Stdlib",39],["T_NS_SEPARATOR","\\",39],["T_STRING","DateTime",39],["T_NS_SEPARATOR","\\",39],["T_STRING","TimezoneInterface",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$localeDate",39],",",["T_WHITESPACE","\n        ",39],["T_NS_SEPARATOR","\\",40],["T_STRING","Magento",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Reports",40],["T_NS_SEPARATOR","\\",40],["T_STRING","Model",40],["T_NS_SEPARATOR","\\",40],["T_STRING","FlagFactory",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$reportsFlagFactory",40],",",["T_WHITESPACE","\n        ",40],["T_NS_SEPARATOR","\\",41],["T_STRING","Magento",41],["T_NS_SEPARATOR","\\",41],["T_STRING","Framework",41],["T_NS_SEPARATOR","\\",41],["T_STRING","Stdlib",41],["T_NS_SEPARATOR","\\",41],["T_STRING","DateTime",41],["T_NS_SEPARATOR","\\",41],["T_STRING","Timezone",41],["T_NS_SEPARATOR","\\",41],["T_STRING","Validator",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$timezoneValidator",41],",",["T_WHITESPACE","\n        ",41],["T_NS_SEPARATOR","\\",42],["T_STRING","Magento",42],["T_NS_SEPARATOR","\\",42],["T_STRING","Framework",42],["T_NS_SEPARATOR","\\",42],["T_STRING","Stdlib",42],["T_NS_SEPARATOR","\\",42],["T_STRING","DateTime",42],["T_NS_SEPARATOR","\\",42],["T_STRING","DateTime",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$dateTime",42],",",["T_WHITESPACE","\n        ",42],["T_NS_SEPARATOR","\\",43],["T_STRING","Magento",43],["T_NS_SEPARATOR","\\",43],["T_STRING","SalesRule",43],["T_NS_SEPARATOR","\\",43],["T_STRING","Model",43],["T_NS_SEPARATOR","\\",43],["T_STRING","ResourceModel",43],["T_NS_SEPARATOR","\\",43],["T_STRING","Report",43],["T_NS_SEPARATOR","\\",43],["T_STRING","Rule",43],["T_NS_SEPARATOR","\\",43],["T_STRING","CreatedatFactory",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$createdatFactory",43],",",["T_WHITESPACE","\n        ",43],["T_NS_SEPARATOR","\\",44],["T_STRING","Magento",44],["T_NS_SEPARATOR","\\",44],["T_STRING","SalesRule",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Model",44],["T_NS_SEPARATOR","\\",44],["T_STRING","ResourceModel",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Report",44],["T_NS_SEPARATOR","\\",44],["T_STRING","Rule",44],["T_NS_SEPARATOR","\\",44],["T_STRING","UpdatedatFactory",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$updatedatFactory",44],",",["T_WHITESPACE","\n        ",44],["T_VARIABLE","$connectionName",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_STRING","null",45],["T_WHITESPACE","\n    ",45],")",["T_WHITESPACE"," ",46],"{",["T_WHITESPACE","\n        ",46],["T_STRING","parent",47],["T_DOUBLE_COLON","::",47],["T_STRING","__construct",47],"(",["T_WHITESPACE","\n            ",47],["T_VARIABLE","$context",48],",",["T_WHITESPACE","\n            ",48],["T_VARIABLE","$logger",49],",",["T_WHITESPACE","\n            ",49],["T_VARIABLE","$localeDate",50],",",["T_WHITESPACE","\n            ",50],["T_VARIABLE","$reportsFlagFactory",51],",",["T_WHITESPACE","\n            ",51],["T_VARIABLE","$timezoneValidator",52],",",["T_WHITESPACE","\n            ",52],["T_VARIABLE","$dateTime",53],",",["T_WHITESPACE","\n            ",53],["T_VARIABLE","$connectionName",54],["T_WHITESPACE","\n        ",54],")",";",["T_WHITESPACE","\n        ",55],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","_createdatFactory",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_VARIABLE","$createdatFactory",56],";",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","_updatedatFactory",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_VARIABLE","$updatedatFactory",57],";",["T_WHITESPACE","\n    ",57],"}",["T_WHITESPACE","\n\n    ",58],["T_DOC_COMMENT","\/**\n     * Resource Report Rule constructor\n     *\n     * @return void\n     *\/",60],["T_WHITESPACE","\n    ",64],["T_PROTECTED","protected",65],["T_WHITESPACE"," ",65],["T_FUNCTION","function",65],["T_WHITESPACE"," ",65],["T_STRING","_construct",65],"(",")",["T_WHITESPACE","\n    ",65],"{",["T_WHITESPACE","\n        ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","_setResource",67],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule'",67],")",";",["T_WHITESPACE","\n    ",67],"}",["T_WHITESPACE","\n\n    ",68],["T_DOC_COMMENT","\/**\n     * Aggregate Coupons data\n     *\n     * @param mixed|null $from\n     * @param mixed|null $to\n     * @return $this\n     *\/",70],["T_WHITESPACE","\n    ",76],["T_PUBLIC","public",77],["T_WHITESPACE"," ",77],["T_FUNCTION","function",77],["T_WHITESPACE"," ",77],["T_STRING","aggregate",77],"(",["T_VARIABLE","$from",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_STRING","null",77],",",["T_WHITESPACE"," ",77],["T_VARIABLE","$to",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_STRING","null",77],")",["T_WHITESPACE","\n    ",77],"{",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","_createdatFactory",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","create",79],"(",")",["T_OBJECT_OPERATOR","->",79],["T_STRING","aggregate",79],"(",["T_VARIABLE","$from",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$to",79],")",";",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","_updatedatFactory",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","create",80],"(",")",["T_OBJECT_OPERATOR","->",80],["T_STRING","aggregate",80],"(",["T_VARIABLE","$from",80],",",["T_WHITESPACE"," ",80],["T_VARIABLE","$to",80],")",";",["T_WHITESPACE","\n        ",80],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","_setFlagData",81],"(",["T_NS_SEPARATOR","\\",81],["T_STRING","Magento",81],["T_NS_SEPARATOR","\\",81],["T_STRING","Reports",81],["T_NS_SEPARATOR","\\",81],["T_STRING","Model",81],["T_NS_SEPARATOR","\\",81],["T_STRING","Flag",81],["T_DOUBLE_COLON","::",81],["T_STRING","REPORT_COUPONS_FLAG_CODE",81],")",";",["T_WHITESPACE","\n\n        ",81],["T_RETURN","return",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$this",83],";",["T_WHITESPACE","\n    ",83],"}",["T_WHITESPACE","\n\n    ",84],["T_DOC_COMMENT","\/**\n     * Get all unique Rule Names from aggregated coupons usage data\n     *\n     * @return array\n     *\/",86],["T_WHITESPACE","\n    ",90],["T_PUBLIC","public",91],["T_WHITESPACE"," ",91],["T_FUNCTION","function",91],["T_WHITESPACE"," ",91],["T_STRING","getUniqRulesNamesList",91],"(",")",["T_WHITESPACE","\n    ",91],"{",["T_WHITESPACE","\n        ",92],["T_VARIABLE","$connection",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getConnection",93],"(",")",";",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$tableName",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getTable",94],"(",["T_CONSTANT_ENCAPSED_STRING","'salesrule_coupon_aggregated'",94],")",";",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$select",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$connection",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","select",95],"(",")",["T_OBJECT_OPERATOR","->",95],["T_STRING","from",95],"(",["T_WHITESPACE","\n            ",95],["T_VARIABLE","$tableName",96],",",["T_WHITESPACE","\n            ",96],["T_NEW","new",97],["T_WHITESPACE"," ",97],["T_NS_SEPARATOR","\\",97],["T_STRING","Zend_Db_Expr",97],"(",["T_CONSTANT_ENCAPSED_STRING","'DISTINCT rule_name'",97],")",["T_WHITESPACE","\n        ",97],")",["T_OBJECT_OPERATOR","->",98],["T_STRING","where",98],"(",["T_WHITESPACE","\n            ",98],["T_CONSTANT_ENCAPSED_STRING","'rule_name IS NOT NULL'",99],["T_WHITESPACE","\n        ",99],")",["T_OBJECT_OPERATOR","->",100],["T_STRING","where",100],"(",["T_WHITESPACE","\n            ",100],["T_CONSTANT_ENCAPSED_STRING","'rule_name <> ?'",101],",",["T_WHITESPACE","\n            ",101],["T_CONSTANT_ENCAPSED_STRING","''",102],["T_WHITESPACE","\n        ",102],")",["T_OBJECT_OPERATOR","->",103],["T_STRING","order",103],"(",["T_WHITESPACE","\n            ",103],["T_CONSTANT_ENCAPSED_STRING","'rule_name ASC'",104],["T_WHITESPACE","\n        ",104],")",";",["T_WHITESPACE","\n\n        ",105],["T_VARIABLE","$rulesNames",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_VARIABLE","$connection",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","fetchAll",107],"(",["T_VARIABLE","$select",107],")",";",["T_WHITESPACE","\n\n        ",107],["T_VARIABLE","$result",109],["T_WHITESPACE"," ",109],"=",["T_WHITESPACE"," ",109],"[","]",";",["T_WHITESPACE","\n\n        ",109],["T_FOREACH","foreach",111],["T_WHITESPACE"," ",111],"(",["T_VARIABLE","$rulesNames",111],["T_WHITESPACE"," ",111],["T_AS","as",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$row",111],")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n            ",111],["T_VARIABLE","$result",112],"[","]",["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$row",112],"[",["T_CONSTANT_ENCAPSED_STRING","'rule_name'",112],"]",";",["T_WHITESPACE","\n        ",112],"}",["T_WHITESPACE","\n\n        ",113],["T_RETURN","return",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$result",115],";",["T_WHITESPACE","\n    ",115],"}",["T_WHITESPACE","\n",116],"}",["T_WHITESPACE","\n",117]]