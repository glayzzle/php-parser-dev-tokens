[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_COMMENT","\/\/ @codingStandardsIgnoreFile\n",7],["T_WHITESPACE","\n",8],["T_DOC_COMMENT","\/** @var $block \\Magento\\Bundle\\Block\\Adminhtml\\Catalog\\Product\\Edit\\Tab\\Bundle\\Option\\Selection *\/",9],["T_WHITESPACE","\n",9],["T_CLOSE_TAG","?>\n",10],["T_INLINE_HTML","<script id=\"bundle-option-selection-box-template\" type=\"text\/x-magento-template\">\n    <table class=\"admin__control-table\">\n        <thead>\n            <tr class=\"headings\">\n                <th class=\"col-draggable\"><\/th>\n                <th class=\"col-default\">",11],["T_OPEN_TAG","<?php ",16],["T_COMMENT","\/* @escapeNotVerified *\/",16],["T_WHITESPACE"," ",16],["T_ECHO","echo",16],["T_WHITESPACE"," ",16],["T_STRING","__",16],"(",["T_CONSTANT_ENCAPSED_STRING","'Default'",16],")",["T_WHITESPACE"," ",16],["T_CLOSE_TAG","?>",16],["T_INLINE_HTML","<\/th>\n                <th class=\"col-name\">",16],["T_OPEN_TAG","<?php ",17],["T_COMMENT","\/* @escapeNotVerified *\/",17],["T_WHITESPACE"," ",17],["T_ECHO","echo",17],["T_WHITESPACE"," ",17],["T_STRING","__",17],"(",["T_CONSTANT_ENCAPSED_STRING","'Name'",17],")",["T_WHITESPACE"," ",17],["T_CLOSE_TAG","?>",17],["T_INLINE_HTML","<\/th>\n                <th class=\"col-sku\">",17],["T_OPEN_TAG","<?php ",18],["T_COMMENT","\/* @escapeNotVerified *\/",18],["T_WHITESPACE"," ",18],["T_ECHO","echo",18],["T_WHITESPACE"," ",18],["T_STRING","__",18],"(",["T_CONSTANT_ENCAPSED_STRING","'SKU'",18],")",["T_WHITESPACE"," ",18],["T_CLOSE_TAG","?>",18],["T_INLINE_HTML","<\/th>\n            ",18],["T_OPEN_TAG","<?php ",19],["T_IF","if",19],["T_WHITESPACE"," ",19],"(",["T_VARIABLE","$block",19],["T_OBJECT_OPERATOR","->",19],["T_STRING","getCanReadPrice",19],"(",")",["T_WHITESPACE"," ",19],["T_IS_NOT_IDENTICAL","!==",19],["T_WHITESPACE"," ",19],["T_STRING","false",19],")",":",["T_WHITESPACE"," ",19],["T_CLOSE_TAG","?>\n",19],["T_INLINE_HTML","                <th class=\"col-price price-type-box\">",20],["T_OPEN_TAG","<?php ",20],["T_COMMENT","\/* @escapeNotVerified *\/",20],["T_WHITESPACE"," ",20],["T_ECHO","echo",20],["T_WHITESPACE"," ",20],["T_STRING","__",20],"(",["T_CONSTANT_ENCAPSED_STRING","'Price'",20],")",["T_WHITESPACE"," ",20],["T_CLOSE_TAG","?>",20],["T_INLINE_HTML","<\/th>\n                <th class=\"col-price price-type-box\">",20],["T_OPEN_TAG","<?php ",21],["T_COMMENT","\/* @escapeNotVerified *\/",21],["T_WHITESPACE"," ",21],["T_ECHO","echo",21],["T_WHITESPACE"," ",21],["T_STRING","__",21],"(",["T_CONSTANT_ENCAPSED_STRING","'Price Type'",21],")",["T_WHITESPACE"," ",21],["T_CLOSE_TAG","?>",21],["T_INLINE_HTML","<\/th>\n            ",21],["T_OPEN_TAG","<?php ",22],["T_ENDIF","endif",22],";",["T_WHITESPACE"," ",22],["T_CLOSE_TAG","?>\n",22],["T_INLINE_HTML","                <th class=\"col-qty\">",23],["T_OPEN_TAG","<?php ",23],["T_COMMENT","\/* @escapeNotVerified *\/",23],["T_WHITESPACE"," ",23],["T_ECHO","echo",23],["T_WHITESPACE"," ",23],["T_STRING","__",23],"(",["T_CONSTANT_ENCAPSED_STRING","'Default Quantity'",23],")",["T_WHITESPACE"," ",23],["T_CLOSE_TAG","?>",23],["T_INLINE_HTML","<\/th>\n                <th class=\"col-uqty qty-box\">",23],["T_OPEN_TAG","<?php ",24],["T_COMMENT","\/* @escapeNotVerified *\/",24],["T_WHITESPACE"," ",24],["T_ECHO","echo",24],["T_WHITESPACE"," ",24],["T_STRING","__",24],"(",["T_CONSTANT_ENCAPSED_STRING","'User Defined'",24],")",["T_WHITESPACE"," ",24],["T_CLOSE_TAG","?>",24],["T_INLINE_HTML","<\/th>\n                <th class=\"col-order type-order\" style=\"display:none\">",24],["T_OPEN_TAG","<?php ",25],["T_COMMENT","\/* @escapeNotVerified *\/",25],["T_WHITESPACE"," ",25],["T_ECHO","echo",25],["T_WHITESPACE"," ",25],["T_STRING","__",25],"(",["T_CONSTANT_ENCAPSED_STRING","'Position'",25],")",["T_WHITESPACE"," ",25],["T_CLOSE_TAG","?>",25],["T_INLINE_HTML","<\/th>\n                <th class=\"col-actions\"><\/th>\n            <\/tr>\n        <\/thead>\n        <tbody>\n        <\/tbody>\n    <\/table>\n<\/script>\n<script id=\"bundle-option-selection-row-template\" type=\"text\/x-magento-template\">\n    <td class=\"col-draggable\">\n        <span data-role=\"draggable-handle\" class=\"draggable-handle\"><\/span>\n        <input type=\"hidden\" id=\"",25],["T_OPEN_TAG","<?php ",36],["T_COMMENT","\/* @escapeNotVerified *\/",36],["T_WHITESPACE"," ",36],["T_ECHO","echo",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$block",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","getFieldId",36],"(",")",["T_WHITESPACE"," ",36],["T_CLOSE_TAG","?>",36],["T_INLINE_HTML","_id<%- data.index %>\"\n               name=\"",36],["T_OPEN_TAG","<?php ",37],["T_COMMENT","\/* @escapeNotVerified *\/",37],["T_WHITESPACE"," ",37],["T_ECHO","echo",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$block",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","getFieldName",37],"(",")",["T_WHITESPACE"," ",37],["T_CLOSE_TAG","?>",37],["T_INLINE_HTML","[<%- data.parentIndex %>][<%- data.index %>][selection_id]\"\n               value=\"<%- data.selection_id %>\"\/>\n        <input type=\"hidden\" name=\"",37],["T_OPEN_TAG","<?php ",39],["T_COMMENT","\/* @escapeNotVerified *\/",39],["T_WHITESPACE"," ",39],["T_ECHO","echo",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$block",39],["T_OBJECT_OPERATOR","->",39],["T_STRING","getFieldName",39],"(",")",["T_WHITESPACE"," ",39],["T_CLOSE_TAG","?>",39],["T_INLINE_HTML","[<%- data.parentIndex %>][<%- data.index %>][option_id]\"\n               value=\"<%- data.option_id %>\"\/>\n        <input type=\"hidden\" class=\"product\"\n               name=\"",39],["T_OPEN_TAG","<?php ",42],["T_COMMENT","\/* @escapeNotVerified *\/",42],["T_WHITESPACE"," ",42],["T_ECHO","echo",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$block",42],["T_OBJECT_OPERATOR","->",42],["T_STRING","getFieldName",42],"(",")",["T_WHITESPACE"," ",42],["T_CLOSE_TAG","?>",42],["T_INLINE_HTML","[<%- data.parentIndex %>][<%- data.index %>][product_id]\"\n               value=\"<%- data.product_id %>\"\/>\n        <input type=\"hidden\" name=\"",42],["T_OPEN_TAG","<?php ",44],["T_COMMENT","\/* @escapeNotVerified *\/",44],["T_WHITESPACE"," ",44],["T_ECHO","echo",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$block",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","getFieldName",44],"(",")",["T_WHITESPACE"," ",44],["T_CLOSE_TAG","?>",44],["T_INLINE_HTML","[<%- data.parentIndex %>][<%- data.index %>][delete]\"\n               value=\"\" class=\"delete\"\/>\n    <\/td>\n    <td class=\"col-default\">\n        <input onclick=\"bSelection.checkGroup(event)\" type=\"<%- data.option_type %>\" class=\"default\"\n               name=\"",44],["T_OPEN_TAG","<?php ",49],["T_COMMENT","\/* @escapeNotVerified *\/",49],["T_WHITESPACE"," ",49],["T_ECHO","echo",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$block",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","getFieldName",49],"(",")",["T_WHITESPACE"," ",49],["T_CLOSE_TAG","?>",49],["T_INLINE_HTML","[<%- data.parentIndex %>][<%- data.index %>][is_default]\"\n               value=\"1\" <%- data.checked %> \/>\n    <\/td>\n    <td class=\"col-name\"><%- data.name %><\/td>\n    <td class=\"col-sku\"><%- data.sku %><\/td>\n",49],["T_OPEN_TAG","<?php ",54],["T_IF","if",54],["T_WHITESPACE"," ",54],"(",["T_VARIABLE","$block",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","getCanReadPrice",54],"(",")",["T_WHITESPACE"," ",54],["T_IS_NOT_IDENTICAL","!==",54],["T_WHITESPACE"," ",54],["T_STRING","false",54],")",":",["T_WHITESPACE"," ",54],["T_CLOSE_TAG","?>\n",54],["T_INLINE_HTML","    <td class=\"col-price price-type-box\">\n        <input id=\"",55],["T_OPEN_TAG","<?php ",56],["T_COMMENT","\/* @escapeNotVerified *\/",56],["T_WHITESPACE"," ",56],["T_ECHO","echo",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$block",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","getFieldId",56],"(",")",["T_WHITESPACE"," ",56],["T_CLOSE_TAG","?>",56],["T_INLINE_HTML","_<%- data.index %>_price_value\"\n               class=\"input-text required-entry validate-zero-or-greater\" type=\"text\"\n               name=\"",56],["T_OPEN_TAG","<?php ",58],["T_COMMENT","\/* @escapeNotVerified *\/",58],["T_WHITESPACE"," ",58],["T_ECHO","echo",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$block",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","getFieldName",58],"(",")",["T_WHITESPACE"," ",58],["T_CLOSE_TAG","?>",58],["T_INLINE_HTML","[<%- data.parentIndex %>][<%- data.index %>][selection_price_value]\"\n               value=\"<%- data.selection_price_value %>\"\n            ",58],["T_OPEN_TAG","<?php ",60],["T_IF","if",60],["T_WHITESPACE"," ",60],"(",["T_VARIABLE","$block",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","getCanEditPrice",60],"(",")",["T_WHITESPACE"," ",60],["T_IS_IDENTICAL","===",60],["T_WHITESPACE"," ",60],["T_STRING","false",60],")",":",["T_WHITESPACE"," ",60],["T_CLOSE_TAG","?>\n",60],["T_INLINE_HTML","               disabled=\"disabled\"\n            ",61],["T_OPEN_TAG","<?php ",62],["T_ENDIF","endif",62],";",["T_WHITESPACE"," ",62],["T_CLOSE_TAG","?>",62],["T_INLINE_HTML","\/>\n    <\/td>\n    <td class=\"col-price price-type-box\">\n        ",62],["T_OPEN_TAG","<?php ",65],["T_ECHO","echo",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$block",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getPriceTypeSelectHtml",65],"(",")",["T_WHITESPACE"," ",65],["T_CLOSE_TAG","?>\n",65],["T_INLINE_HTML","        <div>",66],["T_OPEN_TAG","<?php ",66],["T_ECHO","echo",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$block",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getCheckboxScopeHtml",66],"(",")",["T_WHITESPACE"," ",66],["T_CLOSE_TAG","?>",66],["T_INLINE_HTML","<\/div>\n    <\/td>\n",66],["T_OPEN_TAG","<?php ",68],["T_ELSE","else",68],":",["T_WHITESPACE"," ",68],["T_CLOSE_TAG","?>\n",68],["T_INLINE_HTML","    <input type=\"hidden\" id=\"",69],["T_OPEN_TAG","<?php ",69],["T_COMMENT","\/* @escapeNotVerified *\/",69],["T_WHITESPACE"," ",69],["T_ECHO","echo",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$block",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","getFieldId",69],"(",")",";",["T_WHITESPACE"," ",69],["T_CLOSE_TAG","?>",69],["T_INLINE_HTML","_<%- data.index %>_price_value\"\n           name=\"",69],["T_OPEN_TAG","<?php ",70],["T_COMMENT","\/* @escapeNotVerified *\/",70],["T_WHITESPACE"," ",70],["T_ECHO","echo",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$block",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getFieldName",70],"(",")",";",["T_WHITESPACE"," ",70],["T_CLOSE_TAG","?>",70],["T_INLINE_HTML","[<%- data.parentIndex %>][<%- data.index %>][selection_price_value]\" value=\"0\" \/>\n    <input type=\"hidden\" id=\"",70],["T_OPEN_TAG","<?php ",71],["T_COMMENT","\/* @escapeNotVerified *\/",71],["T_WHITESPACE"," ",71],["T_ECHO","echo",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$block",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","getFieldId",71],"(",")",";",["T_WHITESPACE"," ",71],["T_CLOSE_TAG","?>",71],["T_INLINE_HTML","_<%- data.index %>_price_type\"\n           name=\"",71],["T_OPEN_TAG","<?php ",72],["T_COMMENT","\/* @escapeNotVerified *\/",72],["T_WHITESPACE"," ",72],["T_ECHO","echo",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$block",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","getFieldName",72],"(",")",";",["T_WHITESPACE"," ",72],["T_CLOSE_TAG","?>",72],["T_INLINE_HTML","[<%- data.parentIndex %>][<%- data.index %>][selection_price_type]\" value=\"0\" \/>\n    ",72],["T_OPEN_TAG","<?php ",73],["T_IF","if",73],["T_WHITESPACE"," ",73],"(",["T_VARIABLE","$block",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","isUsedWebsitePrice",73],"(",")",")",":",["T_WHITESPACE"," ",73],["T_CLOSE_TAG","?>\n",73],["T_INLINE_HTML","    <input type=\"hidden\" id=\"",74],["T_OPEN_TAG","<?php ",74],["T_COMMENT","\/* @escapeNotVerified *\/",74],["T_WHITESPACE"," ",74],["T_ECHO","echo",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$block",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","getFieldId",74],"(",")",";",["T_WHITESPACE"," ",74],["T_CLOSE_TAG","?>",74],["T_INLINE_HTML","_<%- data.index %>_price_scope\"\n           name=\"",74],["T_OPEN_TAG","<?php ",75],["T_COMMENT","\/* @escapeNotVerified *\/",75],["T_WHITESPACE"," ",75],["T_ECHO","echo",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$block",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getFieldName",75],"(",")",";",["T_WHITESPACE"," ",75],["T_CLOSE_TAG","?>",75],["T_INLINE_HTML","[<%- data.parentIndex %>][<%- data.index %>][default_price_scope]\" value=\"1\" \/>\n    ",75],["T_OPEN_TAG","<?php ",76],["T_ENDIF","endif",76],";",["T_WHITESPACE"," ",76],["T_CLOSE_TAG","?>\n",76],["T_OPEN_TAG","<?php ",77],["T_ENDIF","endif",77],";",["T_WHITESPACE"," ",77],["T_CLOSE_TAG","?>\n",77],["T_INLINE_HTML","    <td class=\"col-qty\">\n        <input class=\"input-text required-entry validate-greater-zero-based-on-option validate-zero-or-greater\" type=\"text\"\n               name=\"",78],["T_OPEN_TAG","<?php ",80],["T_COMMENT","\/* @escapeNotVerified *\/",80],["T_WHITESPACE"," ",80],["T_ECHO","echo",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$block",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getFieldName",80],"(",")",["T_WHITESPACE"," ",80],["T_CLOSE_TAG","?>",80],["T_INLINE_HTML","[<%- data.parentIndex %>][<%- data.index %>][selection_qty]\"\n               value=\"<%- data.selection_qty %>\" \/>\n    <\/td>\n    <td class=\"col-uqty qty-box\">\n        <input type=\"checkbox\" class=\"is-user-defined-qty\" checked=\"checked\" \/>\n        <span style=\"display:none\">",80],["T_OPEN_TAG","<?php ",85],["T_ECHO","echo",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$block",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","getQtyTypeSelectHtml",85],"(",")",["T_WHITESPACE"," ",85],["T_CLOSE_TAG","?>",85],["T_INLINE_HTML","<\/span>\n    <\/td>\n    <td class=\"col-order type-order\" style=\"display:none\">\n        <input class=\"input-text required-entry validate-zero-or-greater\" type=\"text\"\n               name=\"",85],["T_OPEN_TAG","<?php ",89],["T_COMMENT","\/* @escapeNotVerified *\/",89],["T_WHITESPACE"," ",89],["T_ECHO","echo",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$block",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getFieldName",89],"(",")",["T_WHITESPACE"," ",89],["T_CLOSE_TAG","?>",89],["T_INLINE_HTML","[<%- data.parentIndex %>][<%- data.index %>][position]\"\n               value=\"<%- data.position %>\" \/>\n    <\/td>\n    <td class=\"col-actions\">\n        <span title=\"Delete Row\">\n            ",89],["T_OPEN_TAG","<?php ",94],["T_ECHO","echo",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$block",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getSelectionDeleteButtonHtml",94],"(",")",["T_WHITESPACE"," ",94],["T_CLOSE_TAG","?>\n",94],["T_INLINE_HTML","        <\/span>\n    <\/td>\n<\/script>\n<script>\nrequire([\n    'jquery',\n    'mage\/template',\n    'prototype'\n], function(jQuery, mageTemplate){\nvar bundleTemplateBox = jQuery('#bundle-option-selection-box-template').html(),\n    bundleTemplateRow = jQuery('#bundle-option-selection-row-template').html();\n\nBundle.Selection = Class.create();\nBundle.Selection.prototype = {\n    idLabel : '",95],["T_OPEN_TAG","<?php ",109],["T_COMMENT","\/* @escapeNotVerified *\/",109],["T_WHITESPACE"," ",109],["T_ECHO","echo",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$block",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","getFieldId",109],"(",")",["T_WHITESPACE"," ",109],["T_CLOSE_TAG","?>",109],["T_INLINE_HTML","',\n    scopePrice : ",109],["T_OPEN_TAG","<?php ",110],["T_ECHO","echo",110],["T_WHITESPACE"," ",110],["T_INT_CAST","(int)",110],["T_VARIABLE","$block",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","isUsedWebsitePrice",110],"(",")",["T_WHITESPACE"," ",110],["T_CLOSE_TAG","?>",110],["T_INLINE_HTML",",\n    templateBox : '',\n    templateRow : '',\n    itemsCount : 0,\n    row : null,\n    gridSelection: new Hash(),\n    gridRemoval: new Hash(),\n    gridSelectedProductSkus: [],\n    selectionSearchUrl: '",110],["T_OPEN_TAG","<?php ",118],["T_COMMENT","\/* @escapeNotVerified *\/",118],["T_WHITESPACE"," ",118],["T_ECHO","echo",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$block",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","getSelectionSearchUrl",118],"(",")",["T_WHITESPACE"," ",118],["T_CLOSE_TAG","?>",118],["T_INLINE_HTML","',\n\n    initialize : function() {\n        this.templateBox = '<div class=\"tier form-list\" id=\"' + this.idLabel + '_box_<%- data.parentIndex %>\">' + bundleTemplateBox + '<\/div>';\n\n        this.templateRow = '<tr class=\"selection\" id=\"' + this.idLabel + '_row_<%- data.index %>\">' + bundleTemplateRow + '<\/tr>';\n    },\n\n    gridUpdateCallback: function () {\n        (function ($) {\n            var $grid = $('table[id^=bundle_selection_search_grid_]:visible');\n            $grid.find('.checkbox').prop({checked: false});\n\n            var checkRowBySku = function (sku) {\n                sku = $.trim(sku);\n                $grid.find('.sku').filter(function () {\n                    return $.trim($(this).text()) == sku;\n                }).closest('tr').find('.checkbox').prop({checked: true});\n            };\n            $.each(bSelection.gridSelection.values().pop().toArray(), function () {\n                checkRowBySku(this.pop().get('sku'));\n            });\n\n            $.each(bSelection.gridSelectedProductSkus, function () {\n                if (!bSelection.gridRemoval.get(this)) {\n                    checkRowBySku(this);\n                }\n            });\n        })(jQuery);\n    },\n\n    addRow : function (parentIndex, data) {\n        var box = null;\n        if (!(box = $(this.idLabel + '_box_' + parentIndex))) {\n            this.addBox(parentIndex);\n            box = $(this.idLabel + '_box_' + parentIndex);\n        } else {\n            box.show();\n        }\n\n        var option_type = $(bOption.idLabel + '_' + parentIndex + '_type');\n\n        if(!data){\n            var data = {};\n        }\n\n        if (data.can_read_price != undefined && !data.can_read_price) {\n            data.selection_price_value = '';\n        } else {\n            data.selection_price_value = Number(Math.round(data.selection_price_value + \"e+2\") + \"e-2\").toFixed(2);\n        }\n\n        data.index = this.itemsCount++;\n        data.parentIndex = parentIndex;\n\n        if (option_type.value == 'multi' || option_type.value == 'checkbox') {\n            data.option_type = 'checkbox';\n        } else {\n            data.option_type = 'radio';\n        }\n\n        if (data.is_default == 1) {\n            data.checked = 'checked=\"checked\"';\n        }\n\n        this.template = mageTemplate(this.templateRow);\n        var tbody = $$('#' + this.idLabel + '_box_' + parentIndex + ' tbody');\n\n        \/\/ replace <script to avoid evalScripts() execution\n        var escapedHTML = this.template({\n            data: data\n        }).replace(\/<(\\\/?)script\/g, '&lt;$1script');\n        \n        Element.insert(tbody[0], {bottom: escapedHTML});\n\n        if (data.selection_price_type) {\n            $A($(this.idLabel + '_'+data.index+'_price_type').options).each(function(option){\n                if (option.value==data.selection_price_type) option.selected = true;\n            });\n        }\n\n        if (data.selection_price_type) {\n            $A($(this.idLabel + '_'+data.index+'_can_change_qty').options).each(function(option){\n                if (option.value==data.selection_can_change_qty) option.selected = true;\n            });\n        }\n\n        var checkbox = $(this.idLabel + '_'+data.index+'_price_scope');\n        if (checkbox && this.scopePrice) {\n            if (data.price_scope === undefined) {\n                checkbox.up().hide();\n            } else if(!data.price_scope) {\n                checkbox.checked = true;\n                this.addScope(null, checkbox);\n            }\n        }\n\n        this.bindScopeCheckbox();\n\n        if (option_type.value == 'multi' || option_type.value == 'checkbox') {\n            \/**\n             * Hide not needed elements (user defined qty select box)\n             *\/\n            inputs = $A($$('#' + this.idLabel + '_box_' + data.parentIndex + ' .qty-box'));\n            inputs.each(\n                function(elem){\n                    elem.hide();\n                }\n            );\n        }\n\n        if (!$('price_type') || $('price_type').value != '1') {\n            \/**\n             * Hide not needed elements (price type select and price input)\n             *\/\n            inputs = $A($$('#' + this.idLabel + '_box_' + data.parentIndex + ' .price-type-box'));\n            inputs.each(\n                function(elem){\n                    elem.hide();\n                }\n            );\n        }\n\n        jQuery('#bundle_option_' + parentIndex + ' .no-products-message').hide();\n    },\n\n    bindScopeCheckbox : function(){\n        var checkboxes = $$('.bundle-option-price-scope-checkbox');\n        for (var i=0;i<checkboxes.length;i++) {\n            if (!$(checkboxes[i]).binded) {\n                $(checkboxes[i]).binded = true;\n                Event.observe(checkboxes[i], 'click', this.addScope.bind(this));\n            }\n        }\n    },\n\n    addScope : function(event, element){\n        if (element == undefined) {\n            element = $(Event.element(event));\n        }\n        var priceValue = $(element.id.sub('scope', 'value'));\n        var priceType = $(element.id.sub('scope', 'type'));\n\n        if (element.checked) {\n            priceValue.disable();\n            priceType.disable();\n        } else {\n            priceValue.enable();\n            priceType.enable();\n        }\n    },\n\n    addBox : function (parentIndex) {\n        var div = $(bOption.idLabel + '_' + parentIndex).down('.fieldset-alt');\n        this.template = mageTemplate(this.templateBox);\n        var data = {'parentIndex' : parentIndex};\n        Element.insert(div, {\n            'after': this.template({\n                data: data\n            })\n        });\n    },\n\n    remove : function(event) {\n        var element = Event.findElement(event, 'tr');\n        var container = Event.findElement(event, 'div');\n\n        if (element) {\n            Element.select(element, '.delete').each(function(elem){elem.value='1'});\n            Element.select(element, ['input', 'select']).each(function(elem){elem.hide()});\n            Element.removeClassName(element, 'selection');\n            Element.hide(element);\n\n            var selection = $$('#' + container.id + ' tr.selection');\n            if (container && selection && !selection.length) {\n                container.hide();\n                jQuery(element).closest('.option-box').find('.no-products-message').show();\n            }\n        }\n    },\n\n    checkGroup : function(event) {\n        var element = Event.element(event);\n        if (element.type == 'radio') {\n            var box = element.up('div');\n\n            var inputs = $$('div#' + box.id + ' input.default');\n            if (inputs) {\n                for (i=0; i< inputs.length; i++) {\n                    if (inputs[i].name != element.name) {\n                        inputs[i].checked = false;\n                    }\n                }\n            }\n        }\n    },\n\n    productGridRowInit : function(grid, row){\n        var checkbox = $(row).getElementsByClassName('checkbox')[0];\n        var inputs = $(row).getElementsByClassName('input-text');\n        for (var i = 0; i < inputs.length; i++) {\n            inputs[i].checkbox = checkbox;\n        }\n    },\n\n    productGridCheckboxCheck : function(grid, element, checked) {\n        var id = element.up('table').id.split('_')[4];\n        if (element.value > 0) {\n            var tr = element.parentNode.parentNode,\n                sku = jQuery.trim(tr.select('td.sku')[0].innerHTML);\n            if (element.checked) {\n                if (!this.gridSelection.get(id)) {\n                    this.gridSelection.set(id, $H({}));\n                }\n                this.gridSelection.get(id).set(element.value, $H({}));\n                this.gridSelection.get(id).get(element.value).set('name', tr.select('td.name')[0].innerHTML);\n                this.gridSelection.get(id).get(element.value).set('sku', sku);\n                this.gridRemoval.unset(sku);\n            } else {\n                this.gridSelection.get(id).unset(element.value);\n                this.gridRemoval.set(sku, 1);\n            }\n        }\n    },\n\n    productGridRowClick : function(grid, event) {\n        var trElement = Event.findElement(event, 'tr');\n        var isInput = Event.element(event).tagName == 'INPUT';\n        if (trElement) {\n            var checkbox = Element.select(trElement, 'input');\n            if (checkbox[0]) {\n                var checked = isInput ? checkbox[0].checked : !checkbox[0].checked;\n                grid.setCheckboxChecked(checkbox[0], checked);\n            }\n        }\n    }\n};\n\nbSelection = new Bundle.Selection();\n\n});\n<\/script>\n",118]]