[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_COMMENT","\/\/ @codingStandardsIgnoreFile\n",7],["T_WHITESPACE","\n",8],["T_NAMESPACE","namespace",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Bundle",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Model",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Product",9],";",["T_WHITESPACE","\n\n",9],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Catalog",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Api",11],["T_NS_SEPARATOR","\\",11],["T_STRING","ProductRepositoryInterface",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Framework",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Pricing",12],["T_NS_SEPARATOR","\\",12],["T_STRING","PriceCurrencyInterface",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Framework",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Serialize",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Serializer",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Json",13],";",["T_WHITESPACE","\n\n",13],["T_DOC_COMMENT","\/**\n * Bundle Type Model\n * @SuppressWarnings(PHPMD.TooManyFields)\n * @SuppressWarnings(PHPMD.ExcessiveClassComplexity)\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",15],["T_WHITESPACE","\n",20],["T_CLASS","class",21],["T_WHITESPACE"," ",21],["T_STRING","Type",21],["T_WHITESPACE"," ",21],["T_EXTENDS","extends",21],["T_WHITESPACE"," ",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Magento",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Catalog",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Model",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Product",21],["T_NS_SEPARATOR","\\",21],["T_STRING","Type",21],["T_NS_SEPARATOR","\\",21],["T_STRING","AbstractType",21],["T_WHITESPACE","\n",21],"{",["T_WHITESPACE","\n    ",22],["T_DOC_COMMENT","\/**\n     * Product type\n     *\/",23],["T_WHITESPACE","\n    ",25],["T_CONST","const",26],["T_WHITESPACE"," ",26],["T_STRING","TYPE_CODE",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","'bundle'",26],";",["T_WHITESPACE","\n\n    ",26],["T_DOC_COMMENT","\/**\n     * Product is composite\n     *\n     * @var bool\n     *\/",28],["T_WHITESPACE","\n    ",32],["T_PROTECTED","protected",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$_isComposite",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_STRING","true",33],";",["T_WHITESPACE","\n\n    ",33],["T_DOC_COMMENT","\/**\n     * Cache key for Options Collection\n     *\n     * @var string\n     *\/",35],["T_WHITESPACE","\n    ",39],["T_PROTECTED","protected",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$_keyOptionsCollection",40],["T_WHITESPACE"," ",40],"=",["T_WHITESPACE"," ",40],["T_CONSTANT_ENCAPSED_STRING","'_cache_instance_options_collection'",40],";",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/**\n     * Cache key for Selections Collection\n     *\n     * @var string\n     * @deprecated\n     *\/",42],["T_WHITESPACE","\n    ",47],["T_PROTECTED","protected",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$_keySelectionsCollection",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_CONSTANT_ENCAPSED_STRING","'_cache_instance_selections_collection'",48],";",["T_WHITESPACE","\n\n    ",48],["T_DOC_COMMENT","\/**\n     * Cache key for used Selections\n     *\n     * @var string\n     *\/",50],["T_WHITESPACE","\n    ",54],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$_keyUsedSelections",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_CONSTANT_ENCAPSED_STRING","'_cache_instance_used_selections'",55],";",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * Cache key for used selections ids\n     *\n     * @var string\n     *\/",57],["T_WHITESPACE","\n    ",61],["T_PROTECTED","protected",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$_keyUsedSelectionsIds",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_CONSTANT_ENCAPSED_STRING","'_cache_instance_used_selections_ids'",62],";",["T_WHITESPACE","\n\n    ",62],["T_DOC_COMMENT","\/**\n     * Cache key for used options\n     *\n     * @var string\n     *\/",64],["T_WHITESPACE","\n    ",68],["T_PROTECTED","protected",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$_keyUsedOptions",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'_cache_instance_used_options'",69],";",["T_WHITESPACE","\n\n    ",69],["T_DOC_COMMENT","\/**\n     * Cache key for used options ids\n     *\n     * @var string\n     *\/",71],["T_WHITESPACE","\n    ",75],["T_PROTECTED","protected",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$_keyUsedOptionsIds",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'_cache_instance_used_options_ids'",76],";",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * Product is possible to configure\n     *\n     * @var bool\n     *\/",78],["T_WHITESPACE","\n    ",82],["T_PROTECTED","protected",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$_canConfigure",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_STRING","true",83],";",["T_WHITESPACE","\n\n    ",83],["T_DOC_COMMENT","\/**\n     * Catalog data\n     *\n     * @var \\Magento\\Catalog\\Helper\\Data\n     *\/",85],["T_WHITESPACE","\n    ",89],["T_PROTECTED","protected",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$_catalogData",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_STRING","null",90],";",["T_WHITESPACE","\n\n    ",90],["T_DOC_COMMENT","\/**\n     * Catalog product\n     *\n     * @var \\Magento\\Catalog\\Helper\\Product\n     *\/",92],["T_WHITESPACE","\n    ",96],["T_PROTECTED","protected",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$_catalogProduct",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_STRING","null",97],";",["T_WHITESPACE","\n\n    ",97],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Store\\Model\\StoreManagerInterface\n     *\/",99],["T_WHITESPACE","\n    ",101],["T_PROTECTED","protected",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$_storeManager",102],";",["T_WHITESPACE","\n\n    ",102],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Bundle\\Model\\OptionFactory\n     *\/",104],["T_WHITESPACE","\n    ",106],["T_PROTECTED","protected",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$_bundleOption",107],";",["T_WHITESPACE","\n\n    ",107],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Bundle\\Model\\ResourceModel\\Selection\n     *\/",109],["T_WHITESPACE","\n    ",111],["T_PROTECTED","protected",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$_bundleSelection",112],";",["T_WHITESPACE","\n\n    ",112],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Catalog\\Model\\Config\n     *\/",114],["T_WHITESPACE","\n    ",116],["T_PROTECTED","protected",117],["T_WHITESPACE"," ",117],["T_VARIABLE","$_config",117],";",["T_WHITESPACE","\n\n    ",117],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Bundle\\Model\\ResourceModel\\Selection\\CollectionFactory\n     *\/",119],["T_WHITESPACE","\n    ",121],["T_PROTECTED","protected",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$_bundleCollection",122],";",["T_WHITESPACE","\n\n    ",122],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Bundle\\Model\\ResourceModel\\BundleFactory\n     *\/",124],["T_WHITESPACE","\n    ",126],["T_PROTECTED","protected",127],["T_WHITESPACE"," ",127],["T_VARIABLE","$_bundleFactory",127],";",["T_WHITESPACE","\n\n    ",127],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Bundle\\Model\\SelectionFactory $bundleModelSelection\n     *\/",129],["T_WHITESPACE","\n    ",131],["T_PROTECTED","protected",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$_bundleModelSelection",132],";",["T_WHITESPACE","\n\n    ",132],["T_DOC_COMMENT","\/**\n     * @var PriceCurrencyInterface\n     *\/",134],["T_WHITESPACE","\n    ",136],["T_PROTECTED","protected",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$priceCurrency",137],";",["T_WHITESPACE","\n\n    ",137],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\CatalogInventory\\Api\\StockRegistryInterface\n     *\/",139],["T_WHITESPACE","\n    ",141],["T_PROTECTED","protected",142],["T_WHITESPACE"," ",142],["T_VARIABLE","$_stockRegistry",142],";",["T_WHITESPACE","\n\n    ",142],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\CatalogInventory\\Api\\StockStateInterface\n     *\/",144],["T_WHITESPACE","\n    ",146],["T_PROTECTED","protected",147],["T_WHITESPACE"," ",147],["T_VARIABLE","$_stockState",147],";",["T_WHITESPACE","\n\n    ",147],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Catalog\\Model\\Product\\Option $catalogProductOption\n     * @param \\Magento\\Eav\\Model\\Config $eavConfig\n     * @param \\Magento\\Catalog\\Model\\Product\\Type $catalogProductType\n     * @param \\Magento\\Framework\\Event\\ManagerInterface $eventManager\n     * @param \\Magento\\MediaStorage\\Helper\\File\\Storage\\Database $fileStorageDb\n     * @param \\Magento\\Framework\\Filesystem $filesystem\n     * @param \\Magento\\Framework\\Registry $coreRegistry\n     * @param \\Psr\\Log\\LoggerInterface $logger\n     * @param ProductRepositoryInterface $productRepository\n     * @param \\Magento\\Catalog\\Helper\\Product $catalogProduct\n     * @param \\Magento\\Catalog\\Helper\\Data $catalogData\n     * @param \\Magento\\Bundle\\Model\\SelectionFactory $bundleModelSelection\n     * @param \\Magento\\Bundle\\Model\\ResourceModel\\BundleFactory $bundleFactory\n     * @param \\Magento\\Bundle\\Model\\ResourceModel\\Selection\\CollectionFactory $bundleCollection\n     * @param \\Magento\\Catalog\\Model\\Config $config\n     * @param \\Magento\\Bundle\\Model\\ResourceModel\\Selection $bundleSelection\n     * @param \\Magento\\Bundle\\Model\\OptionFactory $bundleOption\n     * @param \\Magento\\Store\\Model\\StoreManagerInterface $storeManager\n     * @param PriceCurrencyInterface $priceCurrency\n     * @param \\Magento\\CatalogInventory\\Api\\StockRegistryInterface $stockRegistry\n     * @param \\Magento\\CatalogInventory\\Api\\StockStateInterface $stockState\n     * @param \\Magento\\Framework\\Serialize\\Serializer\\Json $serializer\n     *\n     * @SuppressWarnings(PHPMD.ExcessiveParameterList)\n     *\/",149],["T_WHITESPACE","\n    ",174],["T_PUBLIC","public",175],["T_WHITESPACE"," ",175],["T_FUNCTION","function",175],["T_WHITESPACE"," ",175],["T_STRING","__construct",175],"(",["T_WHITESPACE","\n        ",175],["T_NS_SEPARATOR","\\",176],["T_STRING","Magento",176],["T_NS_SEPARATOR","\\",176],["T_STRING","Catalog",176],["T_NS_SEPARATOR","\\",176],["T_STRING","Model",176],["T_NS_SEPARATOR","\\",176],["T_STRING","Product",176],["T_NS_SEPARATOR","\\",176],["T_STRING","Option",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$catalogProductOption",176],",",["T_WHITESPACE","\n        ",176],["T_NS_SEPARATOR","\\",177],["T_STRING","Magento",177],["T_NS_SEPARATOR","\\",177],["T_STRING","Eav",177],["T_NS_SEPARATOR","\\",177],["T_STRING","Model",177],["T_NS_SEPARATOR","\\",177],["T_STRING","Config",177],["T_WHITESPACE"," ",177],["T_VARIABLE","$eavConfig",177],",",["T_WHITESPACE","\n        ",177],["T_NS_SEPARATOR","\\",178],["T_STRING","Magento",178],["T_NS_SEPARATOR","\\",178],["T_STRING","Catalog",178],["T_NS_SEPARATOR","\\",178],["T_STRING","Model",178],["T_NS_SEPARATOR","\\",178],["T_STRING","Product",178],["T_NS_SEPARATOR","\\",178],["T_STRING","Type",178],["T_WHITESPACE"," ",178],["T_VARIABLE","$catalogProductType",178],",",["T_WHITESPACE","\n        ",178],["T_NS_SEPARATOR","\\",179],["T_STRING","Magento",179],["T_NS_SEPARATOR","\\",179],["T_STRING","Framework",179],["T_NS_SEPARATOR","\\",179],["T_STRING","Event",179],["T_NS_SEPARATOR","\\",179],["T_STRING","ManagerInterface",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$eventManager",179],",",["T_WHITESPACE","\n        ",179],["T_NS_SEPARATOR","\\",180],["T_STRING","Magento",180],["T_NS_SEPARATOR","\\",180],["T_STRING","MediaStorage",180],["T_NS_SEPARATOR","\\",180],["T_STRING","Helper",180],["T_NS_SEPARATOR","\\",180],["T_STRING","File",180],["T_NS_SEPARATOR","\\",180],["T_STRING","Storage",180],["T_NS_SEPARATOR","\\",180],["T_STRING","Database",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$fileStorageDb",180],",",["T_WHITESPACE","\n        ",180],["T_NS_SEPARATOR","\\",181],["T_STRING","Magento",181],["T_NS_SEPARATOR","\\",181],["T_STRING","Framework",181],["T_NS_SEPARATOR","\\",181],["T_STRING","Filesystem",181],["T_WHITESPACE"," ",181],["T_VARIABLE","$filesystem",181],",",["T_WHITESPACE","\n        ",181],["T_NS_SEPARATOR","\\",182],["T_STRING","Magento",182],["T_NS_SEPARATOR","\\",182],["T_STRING","Framework",182],["T_NS_SEPARATOR","\\",182],["T_STRING","Registry",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$coreRegistry",182],",",["T_WHITESPACE","\n        ",182],["T_NS_SEPARATOR","\\",183],["T_STRING","Psr",183],["T_NS_SEPARATOR","\\",183],["T_STRING","Log",183],["T_NS_SEPARATOR","\\",183],["T_STRING","LoggerInterface",183],["T_WHITESPACE"," ",183],["T_VARIABLE","$logger",183],",",["T_WHITESPACE","\n        ",183],["T_STRING","ProductRepositoryInterface",184],["T_WHITESPACE"," ",184],["T_VARIABLE","$productRepository",184],",",["T_WHITESPACE","\n        ",184],["T_NS_SEPARATOR","\\",185],["T_STRING","Magento",185],["T_NS_SEPARATOR","\\",185],["T_STRING","Catalog",185],["T_NS_SEPARATOR","\\",185],["T_STRING","Helper",185],["T_NS_SEPARATOR","\\",185],["T_STRING","Product",185],["T_WHITESPACE"," ",185],["T_VARIABLE","$catalogProduct",185],",",["T_WHITESPACE","\n        ",185],["T_NS_SEPARATOR","\\",186],["T_STRING","Magento",186],["T_NS_SEPARATOR","\\",186],["T_STRING","Catalog",186],["T_NS_SEPARATOR","\\",186],["T_STRING","Helper",186],["T_NS_SEPARATOR","\\",186],["T_STRING","Data",186],["T_WHITESPACE"," ",186],["T_VARIABLE","$catalogData",186],",",["T_WHITESPACE","\n        ",186],["T_NS_SEPARATOR","\\",187],["T_STRING","Magento",187],["T_NS_SEPARATOR","\\",187],["T_STRING","Bundle",187],["T_NS_SEPARATOR","\\",187],["T_STRING","Model",187],["T_NS_SEPARATOR","\\",187],["T_STRING","SelectionFactory",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$bundleModelSelection",187],",",["T_WHITESPACE","\n        ",187],["T_NS_SEPARATOR","\\",188],["T_STRING","Magento",188],["T_NS_SEPARATOR","\\",188],["T_STRING","Bundle",188],["T_NS_SEPARATOR","\\",188],["T_STRING","Model",188],["T_NS_SEPARATOR","\\",188],["T_STRING","ResourceModel",188],["T_NS_SEPARATOR","\\",188],["T_STRING","BundleFactory",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$bundleFactory",188],",",["T_WHITESPACE","\n        ",188],["T_NS_SEPARATOR","\\",189],["T_STRING","Magento",189],["T_NS_SEPARATOR","\\",189],["T_STRING","Bundle",189],["T_NS_SEPARATOR","\\",189],["T_STRING","Model",189],["T_NS_SEPARATOR","\\",189],["T_STRING","ResourceModel",189],["T_NS_SEPARATOR","\\",189],["T_STRING","Selection",189],["T_NS_SEPARATOR","\\",189],["T_STRING","CollectionFactory",189],["T_WHITESPACE"," ",189],["T_VARIABLE","$bundleCollection",189],",",["T_WHITESPACE","\n        ",189],["T_NS_SEPARATOR","\\",190],["T_STRING","Magento",190],["T_NS_SEPARATOR","\\",190],["T_STRING","Catalog",190],["T_NS_SEPARATOR","\\",190],["T_STRING","Model",190],["T_NS_SEPARATOR","\\",190],["T_STRING","Config",190],["T_WHITESPACE"," ",190],["T_VARIABLE","$config",190],",",["T_WHITESPACE","\n        ",190],["T_NS_SEPARATOR","\\",191],["T_STRING","Magento",191],["T_NS_SEPARATOR","\\",191],["T_STRING","Bundle",191],["T_NS_SEPARATOR","\\",191],["T_STRING","Model",191],["T_NS_SEPARATOR","\\",191],["T_STRING","ResourceModel",191],["T_NS_SEPARATOR","\\",191],["T_STRING","Selection",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$bundleSelection",191],",",["T_WHITESPACE","\n        ",191],["T_NS_SEPARATOR","\\",192],["T_STRING","Magento",192],["T_NS_SEPARATOR","\\",192],["T_STRING","Bundle",192],["T_NS_SEPARATOR","\\",192],["T_STRING","Model",192],["T_NS_SEPARATOR","\\",192],["T_STRING","OptionFactory",192],["T_WHITESPACE"," ",192],["T_VARIABLE","$bundleOption",192],",",["T_WHITESPACE","\n        ",192],["T_NS_SEPARATOR","\\",193],["T_STRING","Magento",193],["T_NS_SEPARATOR","\\",193],["T_STRING","Store",193],["T_NS_SEPARATOR","\\",193],["T_STRING","Model",193],["T_NS_SEPARATOR","\\",193],["T_STRING","StoreManagerInterface",193],["T_WHITESPACE"," ",193],["T_VARIABLE","$storeManager",193],",",["T_WHITESPACE","\n        ",193],["T_STRING","PriceCurrencyInterface",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$priceCurrency",194],",",["T_WHITESPACE","\n        ",194],["T_NS_SEPARATOR","\\",195],["T_STRING","Magento",195],["T_NS_SEPARATOR","\\",195],["T_STRING","CatalogInventory",195],["T_NS_SEPARATOR","\\",195],["T_STRING","Api",195],["T_NS_SEPARATOR","\\",195],["T_STRING","StockRegistryInterface",195],["T_WHITESPACE"," ",195],["T_VARIABLE","$stockRegistry",195],",",["T_WHITESPACE","\n        ",195],["T_NS_SEPARATOR","\\",196],["T_STRING","Magento",196],["T_NS_SEPARATOR","\\",196],["T_STRING","CatalogInventory",196],["T_NS_SEPARATOR","\\",196],["T_STRING","Api",196],["T_NS_SEPARATOR","\\",196],["T_STRING","StockStateInterface",196],["T_WHITESPACE"," ",196],["T_VARIABLE","$stockState",196],",",["T_WHITESPACE","\n        ",196],["T_STRING","Json",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$serializer",197],["T_WHITESPACE"," ",197],"=",["T_WHITESPACE"," ",197],["T_STRING","null",197],["T_WHITESPACE","\n    ",197],")",["T_WHITESPACE"," ",198],"{",["T_WHITESPACE","\n        ",198],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","_catalogProduct",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_VARIABLE","$catalogProduct",199],";",["T_WHITESPACE","\n        ",199],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","_catalogData",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_VARIABLE","$catalogData",200],";",["T_WHITESPACE","\n        ",200],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","_storeManager",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_VARIABLE","$storeManager",201],";",["T_WHITESPACE","\n        ",201],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","_bundleOption",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_VARIABLE","$bundleOption",202],";",["T_WHITESPACE","\n        ",202],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","_bundleSelection",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_VARIABLE","$bundleSelection",203],";",["T_WHITESPACE","\n        ",203],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","_config",204],["T_WHITESPACE"," ",204],"=",["T_WHITESPACE"," ",204],["T_VARIABLE","$config",204],";",["T_WHITESPACE","\n        ",204],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","_bundleCollection",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_VARIABLE","$bundleCollection",205],";",["T_WHITESPACE","\n        ",205],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","_bundleFactory",206],["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],["T_VARIABLE","$bundleFactory",206],";",["T_WHITESPACE","\n        ",206],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","_bundleModelSelection",207],["T_WHITESPACE"," ",207],"=",["T_WHITESPACE"," ",207],["T_VARIABLE","$bundleModelSelection",207],";",["T_WHITESPACE","\n        ",207],["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","priceCurrency",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_VARIABLE","$priceCurrency",208],";",["T_WHITESPACE","\n        ",208],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","_stockRegistry",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_VARIABLE","$stockRegistry",209],";",["T_WHITESPACE","\n        ",209],["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","_stockState",210],["T_WHITESPACE"," ",210],"=",["T_WHITESPACE"," ",210],["T_VARIABLE","$stockState",210],";",["T_WHITESPACE","\n\n        ",210],["T_STRING","parent",212],["T_DOUBLE_COLON","::",212],["T_STRING","__construct",212],"(",["T_WHITESPACE","\n            ",212],["T_VARIABLE","$catalogProductOption",213],",",["T_WHITESPACE","\n            ",213],["T_VARIABLE","$eavConfig",214],",",["T_WHITESPACE","\n            ",214],["T_VARIABLE","$catalogProductType",215],",",["T_WHITESPACE","\n            ",215],["T_VARIABLE","$eventManager",216],",",["T_WHITESPACE","\n            ",216],["T_VARIABLE","$fileStorageDb",217],",",["T_WHITESPACE","\n            ",217],["T_VARIABLE","$filesystem",218],",",["T_WHITESPACE","\n            ",218],["T_VARIABLE","$coreRegistry",219],",",["T_WHITESPACE","\n            ",219],["T_VARIABLE","$logger",220],",",["T_WHITESPACE","\n            ",220],["T_VARIABLE","$productRepository",221],",",["T_WHITESPACE","\n            ",221],["T_VARIABLE","$serializer",222],["T_WHITESPACE","\n        ",222],")",";",["T_WHITESPACE","\n    ",223],"}",["T_WHITESPACE","\n\n    ",224],["T_DOC_COMMENT","\/**\n     * Return relation info about used products\n     *\n     * @return \\Magento\\Framework\\DataObject Object with information data\n     *\/",226],["T_WHITESPACE","\n    ",230],["T_PUBLIC","public",231],["T_WHITESPACE"," ",231],["T_FUNCTION","function",231],["T_WHITESPACE"," ",231],["T_STRING","getRelationInfo",231],"(",")",["T_WHITESPACE","\n    ",231],"{",["T_WHITESPACE","\n        ",232],["T_VARIABLE","$info",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_NEW","new",233],["T_WHITESPACE"," ",233],["T_NS_SEPARATOR","\\",233],["T_STRING","Magento",233],["T_NS_SEPARATOR","\\",233],["T_STRING","Framework",233],["T_NS_SEPARATOR","\\",233],["T_STRING","DataObject",233],"(",")",";",["T_WHITESPACE","\n        ",233],["T_VARIABLE","$info",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","setTable",234],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_bundle_selection'",234],")",["T_WHITESPACE","\n            ",234],["T_OBJECT_OPERATOR","->",235],["T_STRING","setParentFieldName",235],"(",["T_CONSTANT_ENCAPSED_STRING","'parent_product_id'",235],")",["T_WHITESPACE","\n            ",235],["T_OBJECT_OPERATOR","->",236],["T_STRING","setChildFieldName",236],"(",["T_CONSTANT_ENCAPSED_STRING","'product_id'",236],")",";",["T_WHITESPACE","\n\n        ",236],["T_RETURN","return",238],["T_WHITESPACE"," ",238],["T_VARIABLE","$info",238],";",["T_WHITESPACE","\n    ",238],"}",["T_WHITESPACE","\n\n    ",239],["T_DOC_COMMENT","\/**\n     * Retrieve Required children ids\n     * Return grouped array, ex array(\n     *   group => array(ids)\n     * )\n     *\n     * @param int $parentId\n     * @param bool $required\n     * @return array\n     *\/",241],["T_WHITESPACE","\n    ",250],["T_PUBLIC","public",251],["T_WHITESPACE"," ",251],["T_FUNCTION","function",251],["T_WHITESPACE"," ",251],["T_STRING","getChildrenIds",251],"(",["T_VARIABLE","$parentId",251],",",["T_WHITESPACE"," ",251],["T_VARIABLE","$required",251],["T_WHITESPACE"," ",251],"=",["T_WHITESPACE"," ",251],["T_STRING","true",251],")",["T_WHITESPACE","\n    ",251],"{",["T_WHITESPACE","\n        ",252],["T_RETURN","return",253],["T_WHITESPACE"," ",253],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","_bundleSelection",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","getChildrenIds",253],"(",["T_VARIABLE","$parentId",253],",",["T_WHITESPACE"," ",253],["T_VARIABLE","$required",253],")",";",["T_WHITESPACE","\n    ",253],"}",["T_WHITESPACE","\n\n    ",254],["T_DOC_COMMENT","\/**\n     * Retrieve parent ids array by required child\n     *\n     * @param int|array $childId\n     * @return array\n     *\/",256],["T_WHITESPACE","\n    ",261],["T_PUBLIC","public",262],["T_WHITESPACE"," ",262],["T_FUNCTION","function",262],["T_WHITESPACE"," ",262],["T_STRING","getParentIdsByChild",262],"(",["T_VARIABLE","$childId",262],")",["T_WHITESPACE","\n    ",262],"{",["T_WHITESPACE","\n        ",263],["T_RETURN","return",264],["T_WHITESPACE"," ",264],["T_VARIABLE","$this",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","_bundleSelection",264],["T_OBJECT_OPERATOR","->",264],["T_STRING","getParentIdsByChild",264],"(",["T_VARIABLE","$childId",264],")",";",["T_WHITESPACE","\n    ",264],"}",["T_WHITESPACE","\n\n    ",265],["T_DOC_COMMENT","\/**\n     * Return product sku based on sku_type attribute\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return string\n     *\/",267],["T_WHITESPACE","\n    ",272],["T_PUBLIC","public",273],["T_WHITESPACE"," ",273],["T_FUNCTION","function",273],["T_WHITESPACE"," ",273],["T_STRING","getSku",273],"(",["T_VARIABLE","$product",273],")",["T_WHITESPACE","\n    ",273],"{",["T_WHITESPACE","\n        ",274],["T_VARIABLE","$sku",275],["T_WHITESPACE"," ",275],"=",["T_WHITESPACE"," ",275],["T_STRING","parent",275],["T_DOUBLE_COLON","::",275],["T_STRING","getSku",275],"(",["T_VARIABLE","$product",275],")",";",["T_WHITESPACE","\n\n        ",275],["T_IF","if",277],["T_WHITESPACE"," ",277],"(",["T_VARIABLE","$product",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","getData",277],"(",["T_CONSTANT_ENCAPSED_STRING","'sku_type'",277],")",")",["T_WHITESPACE"," ",277],"{",["T_WHITESPACE","\n            ",277],["T_RETURN","return",278],["T_WHITESPACE"," ",278],["T_VARIABLE","$sku",278],";",["T_WHITESPACE","\n        ",278],"}",["T_WHITESPACE"," ",279],["T_ELSE","else",279],["T_WHITESPACE"," ",279],"{",["T_WHITESPACE","\n            ",279],["T_VARIABLE","$skuParts",280],["T_WHITESPACE"," ",280],"=",["T_WHITESPACE"," ",280],"[",["T_VARIABLE","$sku",280],"]",";",["T_WHITESPACE","\n\n            ",280],["T_IF","if",282],["T_WHITESPACE"," ",282],"(",["T_VARIABLE","$product",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","hasCustomOptions",282],"(",")",")",["T_WHITESPACE"," ",282],"{",["T_WHITESPACE","\n                ",282],["T_VARIABLE","$customOption",283],["T_WHITESPACE"," ",283],"=",["T_WHITESPACE"," ",283],["T_VARIABLE","$product",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","getCustomOption",283],"(",["T_CONSTANT_ENCAPSED_STRING","'bundle_selection_ids'",283],")",";",["T_WHITESPACE","\n                ",283],["T_VARIABLE","$selectionIds",284],["T_WHITESPACE"," ",284],"=",["T_WHITESPACE"," ",284],["T_VARIABLE","$this",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","serializer",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","unserialize",284],"(",["T_VARIABLE","$customOption",284],["T_OBJECT_OPERATOR","->",284],["T_STRING","getValue",284],"(",")",")",";",["T_WHITESPACE","\n                ",284],["T_IF","if",285],["T_WHITESPACE"," ",285],"(","!",["T_EMPTY","empty",285],"(",["T_VARIABLE","$selectionIds",285],")",")",["T_WHITESPACE"," ",285],"{",["T_WHITESPACE","\n                    ",285],["T_VARIABLE","$selections",286],["T_WHITESPACE"," ",286],"=",["T_WHITESPACE"," ",286],["T_VARIABLE","$this",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","getSelectionsByIds",286],"(",["T_VARIABLE","$selectionIds",286],",",["T_WHITESPACE"," ",286],["T_VARIABLE","$product",286],")",";",["T_WHITESPACE","\n                    ",286],["T_FOREACH","foreach",287],["T_WHITESPACE"," ",287],"(",["T_VARIABLE","$selections",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","getItems",287],"(",")",["T_WHITESPACE"," ",287],["T_AS","as",287],["T_WHITESPACE"," ",287],["T_VARIABLE","$selection",287],")",["T_WHITESPACE"," ",287],"{",["T_WHITESPACE","\n                        ",287],["T_VARIABLE","$skuParts",288],"[","]",["T_WHITESPACE"," ",288],"=",["T_WHITESPACE"," ",288],["T_VARIABLE","$selection",288],["T_OBJECT_OPERATOR","->",288],["T_STRING","getSku",288],"(",")",";",["T_WHITESPACE","\n                    ",288],"}",["T_WHITESPACE","\n                ",289],"}",["T_WHITESPACE","\n            ",290],"}",["T_WHITESPACE","\n\n            ",291],["T_RETURN","return",293],["T_WHITESPACE"," ",293],["T_STRING","implode",293],"(",["T_CONSTANT_ENCAPSED_STRING","'-'",293],",",["T_WHITESPACE"," ",293],["T_VARIABLE","$skuParts",293],")",";",["T_WHITESPACE","\n        ",293],"}",["T_WHITESPACE","\n    ",294],"}",["T_WHITESPACE","\n\n    ",295],["T_DOC_COMMENT","\/**\n     * Return product weight based on weight_type attribute\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return float\n     *\/",297],["T_WHITESPACE","\n    ",302],["T_PUBLIC","public",303],["T_WHITESPACE"," ",303],["T_FUNCTION","function",303],["T_WHITESPACE"," ",303],["T_STRING","getWeight",303],"(",["T_VARIABLE","$product",303],")",["T_WHITESPACE","\n    ",303],"{",["T_WHITESPACE","\n        ",304],["T_IF","if",305],["T_WHITESPACE"," ",305],"(",["T_VARIABLE","$product",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","getData",305],"(",["T_CONSTANT_ENCAPSED_STRING","'weight_type'",305],")",")",["T_WHITESPACE"," ",305],"{",["T_WHITESPACE","\n            ",305],["T_RETURN","return",306],["T_WHITESPACE"," ",306],["T_VARIABLE","$product",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","getData",306],"(",["T_CONSTANT_ENCAPSED_STRING","'weight'",306],")",";",["T_WHITESPACE","\n        ",306],"}",["T_WHITESPACE"," ",307],["T_ELSE","else",307],["T_WHITESPACE"," ",307],"{",["T_WHITESPACE","\n            ",307],["T_VARIABLE","$weight",308],["T_WHITESPACE"," ",308],"=",["T_WHITESPACE"," ",308],["T_LNUMBER","0",308],";",["T_WHITESPACE","\n\n            ",308],["T_IF","if",310],["T_WHITESPACE"," ",310],"(",["T_VARIABLE","$product",310],["T_OBJECT_OPERATOR","->",310],["T_STRING","hasCustomOptions",310],"(",")",")",["T_WHITESPACE"," ",310],"{",["T_WHITESPACE","\n                ",310],["T_VARIABLE","$customOption",311],["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],["T_VARIABLE","$product",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","getCustomOption",311],"(",["T_CONSTANT_ENCAPSED_STRING","'bundle_selection_ids'",311],")",";",["T_WHITESPACE","\n                ",311],["T_VARIABLE","$selectionIds",312],["T_WHITESPACE"," ",312],"=",["T_WHITESPACE"," ",312],["T_VARIABLE","$this",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","serializer",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","unserialize",312],"(",["T_VARIABLE","$customOption",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","getValue",312],"(",")",")",";",["T_WHITESPACE","\n                ",312],["T_VARIABLE","$selections",313],["T_WHITESPACE"," ",313],"=",["T_WHITESPACE"," ",313],["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","getSelectionsByIds",313],"(",["T_VARIABLE","$selectionIds",313],",",["T_WHITESPACE"," ",313],["T_VARIABLE","$product",313],")",";",["T_WHITESPACE","\n                ",313],["T_FOREACH","foreach",314],["T_WHITESPACE"," ",314],"(",["T_VARIABLE","$selections",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","getItems",314],"(",")",["T_WHITESPACE"," ",314],["T_AS","as",314],["T_WHITESPACE"," ",314],["T_VARIABLE","$selection",314],")",["T_WHITESPACE"," ",314],"{",["T_WHITESPACE","\n                    ",314],["T_VARIABLE","$qtyOption",315],["T_WHITESPACE"," ",315],"=",["T_WHITESPACE"," ",315],["T_VARIABLE","$product",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","getCustomOption",315],"(",["T_CONSTANT_ENCAPSED_STRING","'selection_qty_'",315],["T_WHITESPACE"," ",315],".",["T_WHITESPACE"," ",315],["T_VARIABLE","$selection",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","getSelectionId",315],"(",")",")",";",["T_WHITESPACE","\n                    ",315],["T_IF","if",316],["T_WHITESPACE"," ",316],"(",["T_VARIABLE","$qtyOption",316],")",["T_WHITESPACE"," ",316],"{",["T_WHITESPACE","\n                        ",316],["T_VARIABLE","$weight",317],["T_WHITESPACE"," ",317],["T_PLUS_EQUAL","+=",317],["T_WHITESPACE"," ",317],["T_VARIABLE","$selection",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","getWeight",317],"(",")",["T_WHITESPACE"," ",317],"*",["T_WHITESPACE"," ",317],["T_VARIABLE","$qtyOption",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","getValue",317],"(",")",";",["T_WHITESPACE","\n                    ",317],"}",["T_WHITESPACE"," ",318],["T_ELSE","else",318],["T_WHITESPACE"," ",318],"{",["T_WHITESPACE","\n                        ",318],["T_VARIABLE","$weight",319],["T_WHITESPACE"," ",319],["T_PLUS_EQUAL","+=",319],["T_WHITESPACE"," ",319],["T_VARIABLE","$selection",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","getWeight",319],"(",")",";",["T_WHITESPACE","\n                    ",319],"}",["T_WHITESPACE","\n                ",320],"}",["T_WHITESPACE","\n            ",321],"}",["T_WHITESPACE","\n\n            ",322],["T_RETURN","return",324],["T_WHITESPACE"," ",324],["T_VARIABLE","$weight",324],";",["T_WHITESPACE","\n        ",324],"}",["T_WHITESPACE","\n    ",325],"}",["T_WHITESPACE","\n\n    ",326],["T_DOC_COMMENT","\/**\n     * Check is virtual product\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return bool\n     *\/",328],["T_WHITESPACE","\n    ",333],["T_PUBLIC","public",334],["T_WHITESPACE"," ",334],["T_FUNCTION","function",334],["T_WHITESPACE"," ",334],["T_STRING","isVirtual",334],"(",["T_VARIABLE","$product",334],")",["T_WHITESPACE","\n    ",334],"{",["T_WHITESPACE","\n        ",335],["T_IF","if",336],["T_WHITESPACE"," ",336],"(",["T_VARIABLE","$product",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","hasCustomOptions",336],"(",")",")",["T_WHITESPACE"," ",336],"{",["T_WHITESPACE","\n            ",336],["T_VARIABLE","$customOption",337],["T_WHITESPACE"," ",337],"=",["T_WHITESPACE"," ",337],["T_VARIABLE","$product",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","getCustomOption",337],"(",["T_CONSTANT_ENCAPSED_STRING","'bundle_selection_ids'",337],")",";",["T_WHITESPACE","\n            ",337],["T_VARIABLE","$selectionIds",338],["T_WHITESPACE"," ",338],"=",["T_WHITESPACE"," ",338],["T_VARIABLE","$this",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","serializer",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","unserialize",338],"(",["T_VARIABLE","$customOption",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","getValue",338],"(",")",")",";",["T_WHITESPACE","\n            ",338],["T_VARIABLE","$selections",339],["T_WHITESPACE"," ",339],"=",["T_WHITESPACE"," ",339],["T_VARIABLE","$this",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","getSelectionsByIds",339],"(",["T_VARIABLE","$selectionIds",339],",",["T_WHITESPACE"," ",339],["T_VARIABLE","$product",339],")",";",["T_WHITESPACE","\n            ",339],["T_VARIABLE","$virtualCount",340],["T_WHITESPACE"," ",340],"=",["T_WHITESPACE"," ",340],["T_LNUMBER","0",340],";",["T_WHITESPACE","\n            ",340],["T_FOREACH","foreach",341],["T_WHITESPACE"," ",341],"(",["T_VARIABLE","$selections",341],["T_OBJECT_OPERATOR","->",341],["T_STRING","getItems",341],"(",")",["T_WHITESPACE"," ",341],["T_AS","as",341],["T_WHITESPACE"," ",341],["T_VARIABLE","$selection",341],")",["T_WHITESPACE"," ",341],"{",["T_WHITESPACE","\n                ",341],["T_IF","if",342],["T_WHITESPACE"," ",342],"(",["T_VARIABLE","$selection",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","isVirtual",342],"(",")",")",["T_WHITESPACE"," ",342],"{",["T_WHITESPACE","\n                    ",342],["T_VARIABLE","$virtualCount",343],["T_INC","++",343],";",["T_WHITESPACE","\n                ",343],"}",["T_WHITESPACE","\n            ",344],"}",["T_WHITESPACE","\n\n            ",345],["T_RETURN","return",347],["T_WHITESPACE"," ",347],["T_VARIABLE","$virtualCount",347],["T_WHITESPACE"," ",347],["T_IS_EQUAL","==",347],["T_WHITESPACE"," ",347],["T_STRING","count",347],"(",["T_VARIABLE","$selections",347],")",";",["T_WHITESPACE","\n        ",347],"}",["T_WHITESPACE","\n\n        ",348],["T_RETURN","return",350],["T_WHITESPACE"," ",350],["T_STRING","false",350],";",["T_WHITESPACE","\n    ",350],"}",["T_WHITESPACE","\n\n    ",351],["T_DOC_COMMENT","\/**\n     * Before save type related data\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return $this|void\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     *\/",353],["T_WHITESPACE","\n    ",359],["T_PUBLIC","public",360],["T_WHITESPACE"," ",360],["T_FUNCTION","function",360],["T_WHITESPACE"," ",360],["T_STRING","beforeSave",360],"(",["T_VARIABLE","$product",360],")",["T_WHITESPACE","\n    ",360],"{",["T_WHITESPACE","\n        ",361],["T_STRING","parent",362],["T_DOUBLE_COLON","::",362],["T_STRING","beforeSave",362],"(",["T_VARIABLE","$product",362],")",";",["T_WHITESPACE","\n\n        ",362],["T_COMMENT","\/\/ If bundle product has dynamic weight, than delete weight attribute\n",364],["T_WHITESPACE","        ",365],["T_IF","if",365],["T_WHITESPACE"," ",365],"(","!",["T_VARIABLE","$product",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","getData",365],"(",["T_CONSTANT_ENCAPSED_STRING","'weight_type'",365],")",["T_WHITESPACE"," ",365],["T_BOOLEAN_AND","&&",365],["T_WHITESPACE"," ",365],["T_VARIABLE","$product",365],["T_OBJECT_OPERATOR","->",365],["T_STRING","hasData",365],"(",["T_CONSTANT_ENCAPSED_STRING","'weight'",365],")",")",["T_WHITESPACE"," ",365],"{",["T_WHITESPACE","\n            ",365],["T_VARIABLE","$product",366],["T_OBJECT_OPERATOR","->",366],["T_STRING","setData",366],"(",["T_CONSTANT_ENCAPSED_STRING","'weight'",366],",",["T_WHITESPACE"," ",366],["T_STRING","false",366],")",";",["T_WHITESPACE","\n        ",366],"}",["T_WHITESPACE","\n\n        ",367],["T_IF","if",369],["T_WHITESPACE"," ",369],"(",["T_VARIABLE","$product",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","getPriceType",369],"(",")",["T_WHITESPACE"," ",369],["T_IS_EQUAL","==",369],["T_WHITESPACE"," ",369],["T_STRING","Price",369],["T_DOUBLE_COLON","::",369],["T_STRING","PRICE_TYPE_DYNAMIC",369],")",["T_WHITESPACE"," ",369],"{",["T_WHITESPACE","\n            ",369],["T_DOC_COMMENT","\/** unset product custom options for dynamic price *\/",370],["T_WHITESPACE","\n            ",370],["T_IF","if",371],["T_WHITESPACE"," ",371],"(",["T_VARIABLE","$product",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","hasData",371],"(",["T_CONSTANT_ENCAPSED_STRING","'product_options'",371],")",")",["T_WHITESPACE"," ",371],"{",["T_WHITESPACE","\n                ",371],["T_VARIABLE","$product",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","unsetData",372],"(",["T_CONSTANT_ENCAPSED_STRING","'product_options'",372],")",";",["T_WHITESPACE","\n            ",372],"}",["T_WHITESPACE","\n        ",373],"}",["T_WHITESPACE","\n\n        ",374],["T_VARIABLE","$product",376],["T_OBJECT_OPERATOR","->",376],["T_STRING","canAffectOptions",376],"(",["T_STRING","false",376],")",";",["T_WHITESPACE","\n\n        ",376],["T_IF","if",378],["T_WHITESPACE"," ",378],"(",["T_VARIABLE","$product",378],["T_OBJECT_OPERATOR","->",378],["T_STRING","getCanSaveBundleSelections",378],"(",")",")",["T_WHITESPACE"," ",378],"{",["T_WHITESPACE","\n            ",378],["T_VARIABLE","$product",379],["T_OBJECT_OPERATOR","->",379],["T_STRING","canAffectOptions",379],"(",["T_STRING","true",379],")",";",["T_WHITESPACE","\n            ",379],["T_VARIABLE","$selections",380],["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],["T_VARIABLE","$product",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","getBundleSelectionsData",380],"(",")",";",["T_WHITESPACE","\n            ",380],["T_IF","if",381],["T_WHITESPACE"," ",381],"(",["T_VARIABLE","$selections",381],["T_WHITESPACE"," ",381],["T_BOOLEAN_AND","&&",381],["T_WHITESPACE"," ",381],"!",["T_EMPTY","empty",381],"(",["T_VARIABLE","$selections",381],")",")",["T_WHITESPACE"," ",381],"{",["T_WHITESPACE","\n                ",381],["T_VARIABLE","$options",382],["T_WHITESPACE"," ",382],"=",["T_WHITESPACE"," ",382],["T_VARIABLE","$product",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","getBundleOptionsData",382],"(",")",";",["T_WHITESPACE","\n                ",382],["T_IF","if",383],["T_WHITESPACE"," ",383],"(",["T_VARIABLE","$options",383],")",["T_WHITESPACE"," ",383],"{",["T_WHITESPACE","\n                    ",383],["T_FOREACH","foreach",384],["T_WHITESPACE"," ",384],"(",["T_VARIABLE","$options",384],["T_WHITESPACE"," ",384],["T_AS","as",384],["T_WHITESPACE"," ",384],["T_VARIABLE","$option",384],")",["T_WHITESPACE"," ",384],"{",["T_WHITESPACE","\n                        ",384],["T_IF","if",385],["T_WHITESPACE"," ",385],"(",["T_EMPTY","empty",385],"(",["T_VARIABLE","$option",385],"[",["T_CONSTANT_ENCAPSED_STRING","'delete'",385],"]",")",["T_WHITESPACE"," ",385],["T_BOOLEAN_OR","||",385],["T_WHITESPACE"," ",385],["T_LNUMBER","1",385],["T_WHITESPACE"," ",385],["T_IS_NOT_EQUAL","!=",385],["T_WHITESPACE"," ",385],["T_INT_CAST","(int)",385],["T_VARIABLE","$option",385],"[",["T_CONSTANT_ENCAPSED_STRING","'delete'",385],"]",")",["T_WHITESPACE"," ",385],"{",["T_WHITESPACE","\n                            ",385],["T_VARIABLE","$product",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","setTypeHasOptions",386],"(",["T_STRING","true",386],")",";",["T_WHITESPACE","\n                            ",386],["T_IF","if",387],["T_WHITESPACE"," ",387],"(",["T_LNUMBER","1",387],["T_WHITESPACE"," ",387],["T_IS_EQUAL","==",387],["T_WHITESPACE"," ",387],["T_INT_CAST","(int)",387],["T_VARIABLE","$option",387],"[",["T_CONSTANT_ENCAPSED_STRING","'required'",387],"]",")",["T_WHITESPACE"," ",387],"{",["T_WHITESPACE","\n                                ",387],["T_VARIABLE","$product",388],["T_OBJECT_OPERATOR","->",388],["T_STRING","setTypeHasRequiredOptions",388],"(",["T_STRING","true",388],")",";",["T_WHITESPACE","\n                                ",388],["T_BREAK","break",389],";",["T_WHITESPACE","\n                            ",389],"}",["T_WHITESPACE","\n                        ",390],"}",["T_WHITESPACE","\n                    ",391],"}",["T_WHITESPACE","\n                ",392],"}",["T_WHITESPACE","\n            ",393],"}",["T_WHITESPACE","\n        ",394],"}",["T_WHITESPACE","\n    ",395],"}",["T_WHITESPACE","\n\n    ",396],["T_DOC_COMMENT","\/**\n     * Retrieve bundle options items\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return \\Magento\\Framework\\DataObject[]\n     *\/",398],["T_WHITESPACE","\n    ",403],["T_PUBLIC","public",404],["T_WHITESPACE"," ",404],["T_FUNCTION","function",404],["T_WHITESPACE"," ",404],["T_STRING","getOptions",404],"(",["T_VARIABLE","$product",404],")",["T_WHITESPACE","\n    ",404],"{",["T_WHITESPACE","\n        ",405],["T_RETURN","return",406],["T_WHITESPACE"," ",406],["T_VARIABLE","$this",406],["T_OBJECT_OPERATOR","->",406],["T_STRING","getOptionsCollection",406],"(",["T_VARIABLE","$product",406],")",["T_WHITESPACE","\n            ",406],["T_OBJECT_OPERATOR","->",407],["T_STRING","getItems",407],"(",")",";",["T_WHITESPACE","\n    ",407],"}",["T_WHITESPACE","\n\n    ",408],["T_DOC_COMMENT","\/**\n     * Retrieve bundle options ids\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return array\n     *\/",410],["T_WHITESPACE","\n    ",415],["T_PUBLIC","public",416],["T_WHITESPACE"," ",416],["T_FUNCTION","function",416],["T_WHITESPACE"," ",416],["T_STRING","getOptionsIds",416],"(",["T_VARIABLE","$product",416],")",["T_WHITESPACE","\n    ",416],"{",["T_WHITESPACE","\n        ",417],["T_RETURN","return",418],["T_WHITESPACE"," ",418],["T_VARIABLE","$this",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","getOptionsCollection",418],"(",["T_VARIABLE","$product",418],")",["T_WHITESPACE","\n            ",418],["T_OBJECT_OPERATOR","->",419],["T_STRING","getAllIds",419],"(",")",";",["T_WHITESPACE","\n    ",419],"}",["T_WHITESPACE","\n\n    ",420],["T_DOC_COMMENT","\/**\n     * Retrieve bundle option collection\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return \\Magento\\Bundle\\Model\\ResourceModel\\Option\\Collection\n     *\/",422],["T_WHITESPACE","\n    ",427],["T_PUBLIC","public",428],["T_WHITESPACE"," ",428],["T_FUNCTION","function",428],["T_WHITESPACE"," ",428],["T_STRING","getOptionsCollection",428],"(",["T_VARIABLE","$product",428],")",["T_WHITESPACE","\n    ",428],"{",["T_WHITESPACE","\n        ",429],["T_IF","if",430],["T_WHITESPACE"," ",430],"(","!",["T_VARIABLE","$product",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","hasData",430],"(",["T_VARIABLE","$this",430],["T_OBJECT_OPERATOR","->",430],["T_STRING","_keyOptionsCollection",430],")",")",["T_WHITESPACE"," ",430],"{",["T_WHITESPACE","\n            ",430],["T_DOC_COMMENT","\/** @var \\Magento\\Bundle\\Model\\ResourceModel\\Option\\Collection $optionsCollection *\/",431],["T_WHITESPACE","\n            ",431],["T_VARIABLE","$optionsCollection",432],["T_WHITESPACE"," ",432],"=",["T_WHITESPACE"," ",432],["T_VARIABLE","$this",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","_bundleOption",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","create",432],"(",")",["T_WHITESPACE","\n                ",432],["T_OBJECT_OPERATOR","->",433],["T_STRING","getResourceCollection",433],"(",")",";",["T_WHITESPACE","\n            ",433],["T_VARIABLE","$optionsCollection",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","setProductIdFilter",434],"(",["T_VARIABLE","$product",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","getEntityId",434],"(",")",")",";",["T_WHITESPACE","\n            ",434],["T_VARIABLE","$this",435],["T_OBJECT_OPERATOR","->",435],["T_STRING","setStoreFilter",435],"(",["T_VARIABLE","$product",435],["T_OBJECT_OPERATOR","->",435],["T_STRING","getStoreId",435],"(",")",",",["T_WHITESPACE"," ",435],["T_VARIABLE","$product",435],")",";",["T_WHITESPACE","\n            ",435],["T_VARIABLE","$optionsCollection",436],["T_OBJECT_OPERATOR","->",436],["T_STRING","setPositionOrder",436],"(",")",";",["T_WHITESPACE","\n            ",436],["T_VARIABLE","$storeId",437],["T_WHITESPACE"," ",437],"=",["T_WHITESPACE"," ",437],["T_VARIABLE","$this",437],["T_OBJECT_OPERATOR","->",437],["T_STRING","getStoreFilter",437],"(",["T_VARIABLE","$product",437],")",";",["T_WHITESPACE","\n            ",437],["T_IF","if",438],["T_WHITESPACE"," ",438],"(",["T_VARIABLE","$storeId",438],["T_WHITESPACE"," ",438],["T_INSTANCEOF","instanceof",438],["T_WHITESPACE"," ",438],["T_NS_SEPARATOR","\\",438],["T_STRING","Magento",438],["T_NS_SEPARATOR","\\",438],["T_STRING","Store",438],["T_NS_SEPARATOR","\\",438],["T_STRING","Model",438],["T_NS_SEPARATOR","\\",438],["T_STRING","Store",438],")",["T_WHITESPACE"," ",438],"{",["T_WHITESPACE","\n                ",438],["T_VARIABLE","$storeId",439],["T_WHITESPACE"," ",439],"=",["T_WHITESPACE"," ",439],["T_VARIABLE","$storeId",439],["T_OBJECT_OPERATOR","->",439],["T_STRING","getId",439],"(",")",";",["T_WHITESPACE","\n            ",439],"}",["T_WHITESPACE","\n\n            ",440],["T_VARIABLE","$optionsCollection",442],["T_OBJECT_OPERATOR","->",442],["T_STRING","joinValues",442],"(",["T_VARIABLE","$storeId",442],")",";",["T_WHITESPACE","\n            ",442],["T_VARIABLE","$product",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","setData",443],"(",["T_VARIABLE","$this",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","_keyOptionsCollection",443],",",["T_WHITESPACE"," ",443],["T_VARIABLE","$optionsCollection",443],")",";",["T_WHITESPACE","\n        ",443],"}",["T_WHITESPACE","\n\n        ",444],["T_RETURN","return",446],["T_WHITESPACE"," ",446],["T_VARIABLE","$product",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","getData",446],"(",["T_VARIABLE","$this",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","_keyOptionsCollection",446],")",";",["T_WHITESPACE","\n    ",446],"}",["T_WHITESPACE","\n\n    ",447],["T_DOC_COMMENT","\/**\n     * Retrieve bundle selections collection based on used options\n     *\n     * @param array $optionIds\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return \\Magento\\Bundle\\Model\\ResourceModel\\Selection\\Collection\n     *\/",449],["T_WHITESPACE","\n    ",455],["T_PUBLIC","public",456],["T_WHITESPACE"," ",456],["T_FUNCTION","function",456],["T_WHITESPACE"," ",456],["T_STRING","getSelectionsCollection",456],"(",["T_VARIABLE","$optionIds",456],",",["T_WHITESPACE"," ",456],["T_VARIABLE","$product",456],")",["T_WHITESPACE","\n    ",456],"{",["T_WHITESPACE","\n        ",457],["T_VARIABLE","$storeId",458],["T_WHITESPACE"," ",458],"=",["T_WHITESPACE"," ",458],["T_VARIABLE","$product",458],["T_OBJECT_OPERATOR","->",458],["T_STRING","getStoreId",458],"(",")",";",["T_WHITESPACE","\n        ",458],["T_VARIABLE","$selectionsCollection",459],["T_WHITESPACE"," ",459],"=",["T_WHITESPACE"," ",459],["T_VARIABLE","$this",459],["T_OBJECT_OPERATOR","->",459],["T_STRING","_bundleCollection",459],["T_OBJECT_OPERATOR","->",459],["T_STRING","create",459],"(",")",["T_WHITESPACE","\n            ",459],["T_OBJECT_OPERATOR","->",460],["T_STRING","addAttributeToSelect",460],"(",["T_VARIABLE","$this",460],["T_OBJECT_OPERATOR","->",460],["T_STRING","_config",460],["T_OBJECT_OPERATOR","->",460],["T_STRING","getProductAttributes",460],"(",")",")",["T_WHITESPACE","\n            ",460],["T_OBJECT_OPERATOR","->",461],["T_STRING","addAttributeToSelect",461],"(",["T_CONSTANT_ENCAPSED_STRING","'tax_class_id'",461],")",["T_WHITESPACE"," ",461],["T_COMMENT","\/\/used for calculation item taxes in Bundle with Dynamic Price\n",461],["T_WHITESPACE","            ",462],["T_OBJECT_OPERATOR","->",462],["T_STRING","setFlag",462],"(",["T_CONSTANT_ENCAPSED_STRING","'product_children'",462],",",["T_WHITESPACE"," ",462],["T_STRING","true",462],")",["T_WHITESPACE","\n            ",462],["T_OBJECT_OPERATOR","->",463],["T_STRING","setPositionOrder",463],"(",")",["T_WHITESPACE","\n            ",463],["T_OBJECT_OPERATOR","->",464],["T_STRING","addStoreFilter",464],"(",["T_VARIABLE","$this",464],["T_OBJECT_OPERATOR","->",464],["T_STRING","getStoreFilter",464],"(",["T_VARIABLE","$product",464],")",")",["T_WHITESPACE","\n            ",464],["T_OBJECT_OPERATOR","->",465],["T_STRING","setStoreId",465],"(",["T_VARIABLE","$storeId",465],")",["T_WHITESPACE","\n            ",465],["T_OBJECT_OPERATOR","->",466],["T_STRING","addFilterByRequiredOptions",466],"(",")",["T_WHITESPACE","\n            ",466],["T_OBJECT_OPERATOR","->",467],["T_STRING","setOptionIdsFilter",467],"(",["T_VARIABLE","$optionIds",467],")",";",["T_WHITESPACE","\n\n        ",467],["T_IF","if",469],["T_WHITESPACE"," ",469],"(","!",["T_VARIABLE","$this",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","_catalogData",469],["T_OBJECT_OPERATOR","->",469],["T_STRING","isPriceGlobal",469],"(",")",["T_WHITESPACE"," ",469],["T_BOOLEAN_AND","&&",469],["T_WHITESPACE"," ",469],["T_VARIABLE","$storeId",469],")",["T_WHITESPACE"," ",469],"{",["T_WHITESPACE","\n            ",469],["T_VARIABLE","$websiteId",470],["T_WHITESPACE"," ",470],"=",["T_WHITESPACE"," ",470],["T_VARIABLE","$this",470],["T_OBJECT_OPERATOR","->",470],["T_STRING","_storeManager",470],["T_OBJECT_OPERATOR","->",470],["T_STRING","getStore",470],"(",["T_VARIABLE","$storeId",470],")",["T_WHITESPACE","\n                ",470],["T_OBJECT_OPERATOR","->",471],["T_STRING","getWebsiteId",471],"(",")",";",["T_WHITESPACE","\n            ",471],["T_VARIABLE","$selectionsCollection",472],["T_OBJECT_OPERATOR","->",472],["T_STRING","joinPrices",472],"(",["T_VARIABLE","$websiteId",472],")",";",["T_WHITESPACE","\n        ",472],"}",["T_WHITESPACE","\n\n        ",473],["T_RETURN","return",475],["T_WHITESPACE"," ",475],["T_VARIABLE","$selectionsCollection",475],";",["T_WHITESPACE","\n    ",475],"}",["T_WHITESPACE","\n\n    ",476],["T_DOC_COMMENT","\/**\n     * Method is needed for specific actions to change given quote options values\n     * according current product type logic\n     * Example: the catalog inventory validation of decimal qty can change qty to int,\n     * so need to change quote item qty option value too.\n     *\n     * @param   array $options\n     * @param   \\Magento\\Framework\\DataObject $option\n     * @param   mixed $value\n     * @param   \\Magento\\Catalog\\Model\\Product $product\n     * @return $this\n     *\/",478],["T_WHITESPACE","\n    ",489],["T_PUBLIC","public",490],["T_WHITESPACE"," ",490],["T_FUNCTION","function",490],["T_WHITESPACE"," ",490],["T_STRING","updateQtyOption",490],"(",["T_VARIABLE","$options",490],",",["T_WHITESPACE"," ",490],["T_NS_SEPARATOR","\\",490],["T_STRING","Magento",490],["T_NS_SEPARATOR","\\",490],["T_STRING","Framework",490],["T_NS_SEPARATOR","\\",490],["T_STRING","DataObject",490],["T_WHITESPACE"," ",490],["T_VARIABLE","$option",490],",",["T_WHITESPACE"," ",490],["T_VARIABLE","$value",490],",",["T_WHITESPACE"," ",490],["T_VARIABLE","$product",490],")",["T_WHITESPACE","\n    ",490],"{",["T_WHITESPACE","\n        ",491],["T_VARIABLE","$optionProduct",492],["T_WHITESPACE"," ",492],"=",["T_WHITESPACE"," ",492],["T_VARIABLE","$option",492],["T_OBJECT_OPERATOR","->",492],["T_STRING","getProduct",492],"(",["T_VARIABLE","$product",492],")",";",["T_WHITESPACE","\n        ",492],["T_VARIABLE","$optionUpdateFlag",493],["T_WHITESPACE"," ",493],"=",["T_WHITESPACE"," ",493],["T_VARIABLE","$option",493],["T_OBJECT_OPERATOR","->",493],["T_STRING","getHasQtyOptionUpdate",493],"(",")",";",["T_WHITESPACE","\n        ",493],["T_VARIABLE","$optionCollection",494],["T_WHITESPACE"," ",494],"=",["T_WHITESPACE"," ",494],["T_VARIABLE","$this",494],["T_OBJECT_OPERATOR","->",494],["T_STRING","getOptionsCollection",494],"(",["T_VARIABLE","$product",494],")",";",["T_WHITESPACE","\n\n        ",494],["T_VARIABLE","$selections",496],["T_WHITESPACE"," ",496],"=",["T_WHITESPACE"," ",496],["T_VARIABLE","$this",496],["T_OBJECT_OPERATOR","->",496],["T_STRING","getSelectionsCollection",496],"(",["T_VARIABLE","$optionCollection",496],["T_OBJECT_OPERATOR","->",496],["T_STRING","getAllIds",496],"(",")",",",["T_WHITESPACE"," ",496],["T_VARIABLE","$product",496],")",";",["T_WHITESPACE","\n\n        ",496],["T_FOREACH","foreach",498],["T_WHITESPACE"," ",498],"(",["T_VARIABLE","$selections",498],["T_WHITESPACE"," ",498],["T_AS","as",498],["T_WHITESPACE"," ",498],["T_VARIABLE","$selection",498],")",["T_WHITESPACE"," ",498],"{",["T_WHITESPACE","\n            ",498],["T_IF","if",499],["T_WHITESPACE"," ",499],"(",["T_VARIABLE","$selection",499],["T_OBJECT_OPERATOR","->",499],["T_STRING","getProductId",499],"(",")",["T_WHITESPACE"," ",499],["T_IS_EQUAL","==",499],["T_WHITESPACE"," ",499],["T_VARIABLE","$optionProduct",499],["T_OBJECT_OPERATOR","->",499],["T_STRING","getId",499],"(",")",")",["T_WHITESPACE"," ",499],"{",["T_WHITESPACE","\n                ",499],["T_FOREACH","foreach",500],["T_WHITESPACE"," ",500],"(",["T_VARIABLE","$options",500],["T_WHITESPACE"," ",500],["T_AS","as",500],["T_WHITESPACE"," ",500],"&",["T_VARIABLE","$option",500],")",["T_WHITESPACE"," ",500],"{",["T_WHITESPACE","\n                    ",500],["T_IF","if",501],["T_WHITESPACE"," ",501],"(",["T_VARIABLE","$option",501],["T_OBJECT_OPERATOR","->",501],["T_STRING","getCode",501],"(",")",["T_WHITESPACE"," ",501],["T_IS_EQUAL","==",501],["T_WHITESPACE"," ",501],["T_CONSTANT_ENCAPSED_STRING","'selection_qty_'",501],["T_WHITESPACE"," ",501],".",["T_WHITESPACE"," ",501],["T_VARIABLE","$selection",501],["T_OBJECT_OPERATOR","->",501],["T_STRING","getSelectionId",501],"(",")",")",["T_WHITESPACE"," ",501],"{",["T_WHITESPACE","\n                        ",501],["T_IF","if",502],["T_WHITESPACE"," ",502],"(",["T_VARIABLE","$optionUpdateFlag",502],")",["T_WHITESPACE"," ",502],"{",["T_WHITESPACE","\n                            ",502],["T_VARIABLE","$option",503],["T_OBJECT_OPERATOR","->",503],["T_STRING","setValue",503],"(",["T_STRING","intval",503],"(",["T_VARIABLE","$option",503],["T_OBJECT_OPERATOR","->",503],["T_STRING","getValue",503],"(",")",")",")",";",["T_WHITESPACE","\n                        ",503],"}",["T_WHITESPACE"," ",504],["T_ELSE","else",504],["T_WHITESPACE"," ",504],"{",["T_WHITESPACE","\n                            ",504],["T_VARIABLE","$option",505],["T_OBJECT_OPERATOR","->",505],["T_STRING","setValue",505],"(",["T_VARIABLE","$value",505],")",";",["T_WHITESPACE","\n                        ",505],"}",["T_WHITESPACE","\n                    ",506],"}",["T_WHITESPACE","\n                ",507],"}",["T_WHITESPACE","\n            ",508],"}",["T_WHITESPACE","\n        ",509],"}",["T_WHITESPACE","\n\n        ",510],["T_RETURN","return",512],["T_WHITESPACE"," ",512],["T_VARIABLE","$this",512],";",["T_WHITESPACE","\n    ",512],"}",["T_WHITESPACE","\n\n    ",513],["T_DOC_COMMENT","\/**\n     * Prepare Quote Item Quantity\n     *\n     * @param mixed $qty\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return int\n     * @SuppressWarnings(PHPMD.UnusedFormalParameter)\n     *\/",515],["T_WHITESPACE","\n    ",522],["T_PUBLIC","public",523],["T_WHITESPACE"," ",523],["T_FUNCTION","function",523],["T_WHITESPACE"," ",523],["T_STRING","prepareQuoteItemQty",523],"(",["T_VARIABLE","$qty",523],",",["T_WHITESPACE"," ",523],["T_VARIABLE","$product",523],")",["T_WHITESPACE","\n    ",523],"{",["T_WHITESPACE","\n        ",524],["T_RETURN","return",525],["T_WHITESPACE"," ",525],["T_STRING","intval",525],"(",["T_VARIABLE","$qty",525],")",";",["T_WHITESPACE","\n    ",525],"}",["T_WHITESPACE","\n\n    ",526],["T_DOC_COMMENT","\/**\n     * Checking if we can sale this bundle\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return bool\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     * @SuppressWarnings(PHPMD.NPathComplexity)\n     *\/",528],["T_WHITESPACE","\n    ",535],["T_PUBLIC","public",536],["T_WHITESPACE"," ",536],["T_FUNCTION","function",536],["T_WHITESPACE"," ",536],["T_STRING","isSalable",536],"(",["T_VARIABLE","$product",536],")",["T_WHITESPACE","\n    ",536],"{",["T_WHITESPACE","\n        ",537],["T_IF","if",538],["T_WHITESPACE"," ",538],"(","!",["T_STRING","parent",538],["T_DOUBLE_COLON","::",538],["T_STRING","isSalable",538],"(",["T_VARIABLE","$product",538],")",")",["T_WHITESPACE"," ",538],"{",["T_WHITESPACE","\n            ",538],["T_RETURN","return",539],["T_WHITESPACE"," ",539],["T_STRING","false",539],";",["T_WHITESPACE","\n        ",539],"}",["T_WHITESPACE","\n\n        ",540],["T_IF","if",542],["T_WHITESPACE"," ",542],"(",["T_VARIABLE","$product",542],["T_OBJECT_OPERATOR","->",542],["T_STRING","hasData",542],"(",["T_CONSTANT_ENCAPSED_STRING","'all_items_salable'",542],")",")",["T_WHITESPACE"," ",542],"{",["T_WHITESPACE","\n            ",542],["T_RETURN","return",543],["T_WHITESPACE"," ",543],["T_VARIABLE","$product",543],["T_OBJECT_OPERATOR","->",543],["T_STRING","getData",543],"(",["T_CONSTANT_ENCAPSED_STRING","'all_items_salable'",543],")",";",["T_WHITESPACE","\n        ",543],"}",["T_WHITESPACE","\n\n        ",544],["T_VARIABLE","$isSalable",546],["T_WHITESPACE"," ",546],"=",["T_WHITESPACE"," ",546],["T_STRING","false",546],";",["T_WHITESPACE","\n        ",546],["T_FOREACH","foreach",547],["T_WHITESPACE"," ",547],"(",["T_VARIABLE","$this",547],["T_OBJECT_OPERATOR","->",547],["T_STRING","getOptionsCollection",547],"(",["T_VARIABLE","$product",547],")",["T_OBJECT_OPERATOR","->",547],["T_STRING","getItems",547],"(",")",["T_WHITESPACE"," ",547],["T_AS","as",547],["T_WHITESPACE"," ",547],["T_VARIABLE","$option",547],")",["T_WHITESPACE"," ",547],"{",["T_WHITESPACE","\n            ",547],["T_VARIABLE","$hasSalable",548],["T_WHITESPACE"," ",548],"=",["T_WHITESPACE"," ",548],["T_STRING","false",548],";",["T_WHITESPACE","\n\n            ",548],["T_VARIABLE","$selectionsCollection",550],["T_WHITESPACE"," ",550],"=",["T_WHITESPACE"," ",550],["T_VARIABLE","$this",550],["T_OBJECT_OPERATOR","->",550],["T_STRING","_bundleCollection",550],["T_OBJECT_OPERATOR","->",550],["T_STRING","create",550],"(",")",";",["T_WHITESPACE","\n            ",550],["T_VARIABLE","$selectionsCollection",551],["T_OBJECT_OPERATOR","->",551],["T_STRING","addAttributeToSelect",551],"(",["T_CONSTANT_ENCAPSED_STRING","'status'",551],")",";",["T_WHITESPACE","\n            ",551],["T_VARIABLE","$selectionsCollection",552],["T_OBJECT_OPERATOR","->",552],["T_STRING","addQuantityFilter",552],"(",")",";",["T_WHITESPACE","\n            ",552],["T_VARIABLE","$selectionsCollection",553],["T_OBJECT_OPERATOR","->",553],["T_STRING","setFlag",553],"(",["T_CONSTANT_ENCAPSED_STRING","'product_children'",553],",",["T_WHITESPACE"," ",553],["T_STRING","true",553],")",";",["T_WHITESPACE","\n            ",553],["T_VARIABLE","$selectionsCollection",554],["T_OBJECT_OPERATOR","->",554],["T_STRING","addFilterByRequiredOptions",554],"(",")",";",["T_WHITESPACE","\n            ",554],["T_VARIABLE","$selectionsCollection",555],["T_OBJECT_OPERATOR","->",555],["T_STRING","setOptionIdsFilter",555],"(","[",["T_VARIABLE","$option",555],["T_OBJECT_OPERATOR","->",555],["T_STRING","getId",555],"(",")","]",")",";",["T_WHITESPACE","\n\n            ",555],["T_FOREACH","foreach",557],["T_WHITESPACE"," ",557],"(",["T_VARIABLE","$selectionsCollection",557],["T_WHITESPACE"," ",557],["T_AS","as",557],["T_WHITESPACE"," ",557],["T_VARIABLE","$selection",557],")",["T_WHITESPACE"," ",557],"{",["T_WHITESPACE","\n                ",557],["T_IF","if",558],["T_WHITESPACE"," ",558],"(",["T_VARIABLE","$selection",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","isSalable",558],"(",")",")",["T_WHITESPACE"," ",558],"{",["T_WHITESPACE","\n                    ",558],["T_VARIABLE","$hasSalable",559],["T_WHITESPACE"," ",559],"=",["T_WHITESPACE"," ",559],["T_STRING","true",559],";",["T_WHITESPACE","\n                    ",559],["T_BREAK","break",560],";",["T_WHITESPACE","\n                ",560],"}",["T_WHITESPACE","\n            ",561],"}",["T_WHITESPACE","\n\n            ",562],["T_IF","if",564],["T_WHITESPACE"," ",564],"(",["T_VARIABLE","$hasSalable",564],")",["T_WHITESPACE"," ",564],"{",["T_WHITESPACE","\n                ",564],["T_VARIABLE","$isSalable",565],["T_WHITESPACE"," ",565],"=",["T_WHITESPACE"," ",565],["T_STRING","true",565],";",["T_WHITESPACE","\n            ",565],"}",["T_WHITESPACE","\n\n            ",566],["T_IF","if",568],["T_WHITESPACE"," ",568],"(","!",["T_VARIABLE","$hasSalable",568],["T_WHITESPACE"," ",568],["T_BOOLEAN_AND","&&",568],["T_WHITESPACE"," ",568],["T_VARIABLE","$option",568],["T_OBJECT_OPERATOR","->",568],["T_STRING","getRequired",568],"(",")",")",["T_WHITESPACE"," ",568],"{",["T_WHITESPACE","\n                ",568],["T_VARIABLE","$isSalable",569],["T_WHITESPACE"," ",569],"=",["T_WHITESPACE"," ",569],["T_STRING","false",569],";",["T_WHITESPACE","\n                ",569],["T_BREAK","break",570],";",["T_WHITESPACE","\n            ",570],"}",["T_WHITESPACE","\n        ",571],"}",["T_WHITESPACE","\n\n        ",572],["T_VARIABLE","$product",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","setData",574],"(",["T_CONSTANT_ENCAPSED_STRING","'all_items_salable'",574],",",["T_WHITESPACE"," ",574],["T_VARIABLE","$isSalable",574],")",";",["T_WHITESPACE","\n\n        ",574],["T_RETURN","return",576],["T_WHITESPACE"," ",576],["T_VARIABLE","$isSalable",576],";",["T_WHITESPACE","\n    ",576],"}",["T_WHITESPACE","\n\n    ",577],["T_DOC_COMMENT","\/**\n     * Prepare product and its configuration to be added to some products list.\n     * Perform standard preparation process and then prepare of bundle selections options.\n     *\n     * @param \\Magento\\Framework\\DataObject $buyRequest\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @param string $processMode\n     * @return \\Magento\\Framework\\Phrase|array|string\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     * @SuppressWarnings(PHPMD.NPathComplexity)\n     * @SuppressWarnings(PHPMD.ExcessiveMethodLength)\n     *\/",579],["T_WHITESPACE","\n    ",590],["T_PROTECTED","protected",591],["T_WHITESPACE"," ",591],["T_FUNCTION","function",591],["T_WHITESPACE"," ",591],["T_STRING","_prepareProduct",591],"(",["T_NS_SEPARATOR","\\",591],["T_STRING","Magento",591],["T_NS_SEPARATOR","\\",591],["T_STRING","Framework",591],["T_NS_SEPARATOR","\\",591],["T_STRING","DataObject",591],["T_WHITESPACE"," ",591],["T_VARIABLE","$buyRequest",591],",",["T_WHITESPACE"," ",591],["T_VARIABLE","$product",591],",",["T_WHITESPACE"," ",591],["T_VARIABLE","$processMode",591],")",["T_WHITESPACE","\n    ",591],"{",["T_WHITESPACE","\n        ",592],["T_VARIABLE","$result",593],["T_WHITESPACE"," ",593],"=",["T_WHITESPACE"," ",593],["T_STRING","parent",593],["T_DOUBLE_COLON","::",593],["T_STRING","_prepareProduct",593],"(",["T_VARIABLE","$buyRequest",593],",",["T_WHITESPACE"," ",593],["T_VARIABLE","$product",593],",",["T_WHITESPACE"," ",593],["T_VARIABLE","$processMode",593],")",";",["T_WHITESPACE","\n\n        ",593],["T_TRY","try",595],["T_WHITESPACE"," ",595],"{",["T_WHITESPACE","\n            ",595],["T_IF","if",596],["T_WHITESPACE"," ",596],"(",["T_STRING","is_string",596],"(",["T_VARIABLE","$result",596],")",")",["T_WHITESPACE"," ",596],"{",["T_WHITESPACE","\n                ",596],["T_THROW","throw",597],["T_WHITESPACE"," ",597],["T_NEW","new",597],["T_WHITESPACE"," ",597],["T_NS_SEPARATOR","\\",597],["T_STRING","Magento",597],["T_NS_SEPARATOR","\\",597],["T_STRING","Framework",597],["T_NS_SEPARATOR","\\",597],["T_STRING","Exception",597],["T_NS_SEPARATOR","\\",597],["T_STRING","LocalizedException",597],"(",["T_STRING","__",597],"(",["T_VARIABLE","$result",597],")",")",";",["T_WHITESPACE","\n            ",597],"}",["T_WHITESPACE","\n\n            ",598],["T_VARIABLE","$selections",600],["T_WHITESPACE"," ",600],"=",["T_WHITESPACE"," ",600],"[","]",";",["T_WHITESPACE","\n            ",600],["T_VARIABLE","$isStrictProcessMode",601],["T_WHITESPACE"," ",601],"=",["T_WHITESPACE"," ",601],["T_VARIABLE","$this",601],["T_OBJECT_OPERATOR","->",601],["T_STRING","_isStrictProcessMode",601],"(",["T_VARIABLE","$processMode",601],")",";",["T_WHITESPACE","\n\n            ",601],["T_VARIABLE","$skipSaleableCheck",603],["T_WHITESPACE"," ",603],"=",["T_WHITESPACE"," ",603],["T_VARIABLE","$this",603],["T_OBJECT_OPERATOR","->",603],["T_STRING","_catalogProduct",603],["T_OBJECT_OPERATOR","->",603],["T_STRING","getSkipSaleableCheck",603],"(",")",";",["T_WHITESPACE","\n            ",603],["T_VARIABLE","$_appendAllSelections",604],["T_WHITESPACE"," ",604],"=",["T_WHITESPACE"," ",604],["T_BOOL_CAST","(bool)",604],["T_VARIABLE","$product",604],["T_OBJECT_OPERATOR","->",604],["T_STRING","getSkipCheckRequiredOption",604],"(",")",["T_WHITESPACE"," ",604],["T_BOOLEAN_OR","||",604],["T_WHITESPACE"," ",604],["T_VARIABLE","$skipSaleableCheck",604],";",["T_WHITESPACE","\n\n            ",604],["T_VARIABLE","$options",606],["T_WHITESPACE"," ",606],"=",["T_WHITESPACE"," ",606],["T_VARIABLE","$buyRequest",606],["T_OBJECT_OPERATOR","->",606],["T_STRING","getBundleOption",606],"(",")",";",["T_WHITESPACE","\n            ",606],["T_IF","if",607],["T_WHITESPACE"," ",607],"(",["T_STRING","is_array",607],"(",["T_VARIABLE","$options",607],")",")",["T_WHITESPACE"," ",607],"{",["T_WHITESPACE","\n                ",607],["T_VARIABLE","$options",608],["T_WHITESPACE"," ",608],"=",["T_WHITESPACE"," ",608],["T_VARIABLE","$this",608],["T_OBJECT_OPERATOR","->",608],["T_STRING","recursiveIntval",608],"(",["T_VARIABLE","$options",608],")",";",["T_WHITESPACE","\n                ",608],["T_VARIABLE","$optionIds",609],["T_WHITESPACE"," ",609],"=",["T_WHITESPACE"," ",609],["T_STRING","array_keys",609],"(",["T_VARIABLE","$options",609],")",";",["T_WHITESPACE","\n\n                ",609],["T_IF","if",611],["T_WHITESPACE"," ",611],"(",["T_EMPTY","empty",611],"(",["T_VARIABLE","$optionIds",611],")",["T_WHITESPACE"," ",611],["T_BOOLEAN_AND","&&",611],["T_WHITESPACE"," ",611],["T_VARIABLE","$isStrictProcessMode",611],")",["T_WHITESPACE"," ",611],"{",["T_WHITESPACE","\n                    ",611],["T_THROW","throw",612],["T_WHITESPACE"," ",612],["T_NEW","new",612],["T_WHITESPACE"," ",612],["T_NS_SEPARATOR","\\",612],["T_STRING","Magento",612],["T_NS_SEPARATOR","\\",612],["T_STRING","Framework",612],["T_NS_SEPARATOR","\\",612],["T_STRING","Exception",612],["T_NS_SEPARATOR","\\",612],["T_STRING","LocalizedException",612],"(",["T_STRING","__",612],"(",["T_CONSTANT_ENCAPSED_STRING","'Please specify product option(s).'",612],")",")",";",["T_WHITESPACE","\n                ",612],"}",["T_WHITESPACE","\n\n                ",613],["T_VARIABLE","$product",615],["T_OBJECT_OPERATOR","->",615],["T_STRING","getTypeInstance",615],"(",")",["T_WHITESPACE","\n                    ",615],["T_OBJECT_OPERATOR","->",616],["T_STRING","setStoreFilter",616],"(",["T_VARIABLE","$product",616],["T_OBJECT_OPERATOR","->",616],["T_STRING","getStoreId",616],"(",")",",",["T_WHITESPACE"," ",616],["T_VARIABLE","$product",616],")",";",["T_WHITESPACE","\n                ",616],["T_VARIABLE","$optionsCollection",617],["T_WHITESPACE"," ",617],"=",["T_WHITESPACE"," ",617],["T_VARIABLE","$this",617],["T_OBJECT_OPERATOR","->",617],["T_STRING","getOptionsCollection",617],"(",["T_VARIABLE","$product",617],")",";",["T_WHITESPACE","\n                ",617],["T_VARIABLE","$this",618],["T_OBJECT_OPERATOR","->",618],["T_STRING","checkIsAllRequiredOptions",618],"(",["T_WHITESPACE","\n                    ",618],["T_VARIABLE","$product",619],",",["T_WHITESPACE","\n                    ",619],["T_VARIABLE","$isStrictProcessMode",620],",",["T_WHITESPACE","\n                    ",620],["T_VARIABLE","$optionsCollection",621],",",["T_WHITESPACE","\n                    ",621],["T_VARIABLE","$options",622],["T_WHITESPACE","\n                ",622],")",";",["T_WHITESPACE","\n\n                ",623],["T_VARIABLE","$selectionIds",625],["T_WHITESPACE"," ",625],"=",["T_WHITESPACE"," ",625],["T_VARIABLE","$this",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","multiToFlatArray",625],"(",["T_VARIABLE","$options",625],")",";",["T_WHITESPACE","\n                ",625],["T_COMMENT","\/\/ If product has not been configured yet then $selections array should be empty\n",626],["T_WHITESPACE","                ",627],["T_IF","if",627],["T_WHITESPACE"," ",627],"(","!",["T_EMPTY","empty",627],"(",["T_VARIABLE","$selectionIds",627],")",")",["T_WHITESPACE"," ",627],"{",["T_WHITESPACE","\n                    ",627],["T_VARIABLE","$selections",628],["T_WHITESPACE"," ",628],"=",["T_WHITESPACE"," ",628],["T_VARIABLE","$this",628],["T_OBJECT_OPERATOR","->",628],["T_STRING","getSelectionsByIds",628],"(",["T_VARIABLE","$selectionIds",628],",",["T_WHITESPACE"," ",628],["T_VARIABLE","$product",628],")",";",["T_WHITESPACE","\n\n                    ",628],["T_IF","if",630],["T_WHITESPACE"," ",630],"(",["T_STRING","count",630],"(",["T_VARIABLE","$selections",630],["T_OBJECT_OPERATOR","->",630],["T_STRING","getItems",630],"(",")",")",["T_WHITESPACE"," ",630],["T_IS_NOT_IDENTICAL","!==",630],["T_WHITESPACE"," ",630],["T_STRING","count",630],"(",["T_VARIABLE","$selectionIds",630],")",")",["T_WHITESPACE"," ",630],"{",["T_WHITESPACE","\n                        ",630],["T_THROW","throw",631],["T_WHITESPACE"," ",631],["T_NEW","new",631],["T_WHITESPACE"," ",631],["T_NS_SEPARATOR","\\",631],["T_STRING","Magento",631],["T_NS_SEPARATOR","\\",631],["T_STRING","Framework",631],["T_NS_SEPARATOR","\\",631],["T_STRING","Exception",631],["T_NS_SEPARATOR","\\",631],["T_STRING","LocalizedException",631],"(",["T_WHITESPACE","\n                            ",631],["T_STRING","__",632],"(",["T_CONSTANT_ENCAPSED_STRING","'The options you selected are not available.'",632],")",["T_WHITESPACE","\n                        ",632],")",";",["T_WHITESPACE","\n                    ",633],"}",["T_WHITESPACE","\n\n                    ",634],["T_COMMENT","\/\/ Check if added selections are still on sale\n",636],["T_WHITESPACE","                    ",637],["T_VARIABLE","$this",637],["T_OBJECT_OPERATOR","->",637],["T_STRING","checkSelectionsIsSale",637],"(",["T_WHITESPACE","\n                        ",637],["T_VARIABLE","$selections",638],",",["T_WHITESPACE","\n                        ",638],["T_VARIABLE","$skipSaleableCheck",639],",",["T_WHITESPACE","\n                        ",639],["T_VARIABLE","$optionsCollection",640],",",["T_WHITESPACE","\n                        ",640],["T_VARIABLE","$options",641],["T_WHITESPACE","\n                    ",641],")",";",["T_WHITESPACE","\n\n                    ",642],["T_VARIABLE","$optionsCollection",644],["T_OBJECT_OPERATOR","->",644],["T_STRING","appendSelections",644],"(",["T_VARIABLE","$selections",644],",",["T_WHITESPACE"," ",644],["T_STRING","false",644],",",["T_WHITESPACE"," ",644],["T_VARIABLE","$_appendAllSelections",644],")",";",["T_WHITESPACE","\n\n                    ",644],["T_VARIABLE","$selections",646],["T_WHITESPACE"," ",646],"=",["T_WHITESPACE"," ",646],["T_VARIABLE","$selections",646],["T_OBJECT_OPERATOR","->",646],["T_STRING","getItems",646],"(",")",";",["T_WHITESPACE","\n                ",646],"}",["T_WHITESPACE"," ",647],["T_ELSE","else",647],["T_WHITESPACE"," ",647],"{",["T_WHITESPACE","\n                    ",647],["T_VARIABLE","$selections",648],["T_WHITESPACE"," ",648],"=",["T_WHITESPACE"," ",648],"[","]",";",["T_WHITESPACE","\n                ",648],"}",["T_WHITESPACE","\n            ",649],"}",["T_WHITESPACE"," ",650],["T_ELSE","else",650],["T_WHITESPACE"," ",650],"{",["T_WHITESPACE","\n                ",650],["T_VARIABLE","$product",651],["T_OBJECT_OPERATOR","->",651],["T_STRING","setOptionsValidationFail",651],"(",["T_STRING","true",651],")",";",["T_WHITESPACE","\n                ",651],["T_VARIABLE","$product",652],["T_OBJECT_OPERATOR","->",652],["T_STRING","getTypeInstance",652],"(",")",["T_WHITESPACE","\n                    ",652],["T_OBJECT_OPERATOR","->",653],["T_STRING","setStoreFilter",653],"(",["T_VARIABLE","$product",653],["T_OBJECT_OPERATOR","->",653],["T_STRING","getStoreId",653],"(",")",",",["T_WHITESPACE"," ",653],["T_VARIABLE","$product",653],")",";",["T_WHITESPACE","\n\n                ",653],["T_VARIABLE","$optionCollection",655],["T_WHITESPACE"," ",655],"=",["T_WHITESPACE"," ",655],["T_VARIABLE","$product",655],["T_OBJECT_OPERATOR","->",655],["T_STRING","getTypeInstance",655],"(",")",["T_WHITESPACE","\n                    ",655],["T_OBJECT_OPERATOR","->",656],["T_STRING","getOptionsCollection",656],"(",["T_VARIABLE","$product",656],")",";",["T_WHITESPACE","\n                ",656],["T_VARIABLE","$optionIds",657],["T_WHITESPACE"," ",657],"=",["T_WHITESPACE"," ",657],["T_VARIABLE","$product",657],["T_OBJECT_OPERATOR","->",657],["T_STRING","getTypeInstance",657],"(",")",["T_WHITESPACE","\n                    ",657],["T_OBJECT_OPERATOR","->",658],["T_STRING","getOptionsIds",658],"(",["T_VARIABLE","$product",658],")",";",["T_WHITESPACE","\n                ",658],["T_VARIABLE","$selectionCollection",659],["T_WHITESPACE"," ",659],"=",["T_WHITESPACE"," ",659],["T_VARIABLE","$product",659],["T_OBJECT_OPERATOR","->",659],["T_STRING","getTypeInstance",659],"(",")",["T_WHITESPACE","\n                    ",659],["T_OBJECT_OPERATOR","->",660],["T_STRING","getSelectionsCollection",660],"(",["T_VARIABLE","$optionIds",660],",",["T_WHITESPACE"," ",660],["T_VARIABLE","$product",660],")",";",["T_WHITESPACE","\n                ",660],["T_VARIABLE","$options",661],["T_WHITESPACE"," ",661],"=",["T_WHITESPACE"," ",661],["T_VARIABLE","$optionCollection",661],["T_OBJECT_OPERATOR","->",661],["T_STRING","appendSelections",661],"(",["T_VARIABLE","$selectionCollection",661],",",["T_WHITESPACE"," ",661],["T_STRING","false",661],",",["T_WHITESPACE"," ",661],["T_VARIABLE","$_appendAllSelections",661],")",";",["T_WHITESPACE","\n\n                ",661],["T_VARIABLE","$selections",663],["T_WHITESPACE"," ",663],"=",["T_WHITESPACE"," ",663],["T_VARIABLE","$this",663],["T_OBJECT_OPERATOR","->",663],["T_STRING","mergeSelectionsWithOptions",663],"(",["T_VARIABLE","$options",663],",",["T_WHITESPACE"," ",663],["T_VARIABLE","$selections",663],")",";",["T_WHITESPACE","\n            ",663],"}",["T_WHITESPACE","\n            ",664],["T_IF","if",665],["T_WHITESPACE"," ",665],"(",["T_STRING","count",665],"(",["T_VARIABLE","$selections",665],")",["T_WHITESPACE"," ",665],">",["T_WHITESPACE"," ",665],["T_LNUMBER","0",665],["T_WHITESPACE"," ",665],["T_BOOLEAN_OR","||",665],["T_WHITESPACE"," ",665],"!",["T_VARIABLE","$isStrictProcessMode",665],")",["T_WHITESPACE"," ",665],"{",["T_WHITESPACE","\n                ",665],["T_VARIABLE","$uniqueKey",666],["T_WHITESPACE"," ",666],"=",["T_WHITESPACE"," ",666],"[",["T_VARIABLE","$product",666],["T_OBJECT_OPERATOR","->",666],["T_STRING","getId",666],"(",")","]",";",["T_WHITESPACE","\n                ",666],["T_VARIABLE","$selectionIds",667],["T_WHITESPACE"," ",667],"=",["T_WHITESPACE"," ",667],"[","]",";",["T_WHITESPACE","\n                ",667],["T_VARIABLE","$qtys",668],["T_WHITESPACE"," ",668],"=",["T_WHITESPACE"," ",668],["T_VARIABLE","$buyRequest",668],["T_OBJECT_OPERATOR","->",668],["T_STRING","getBundleOptionQty",668],"(",")",";",["T_WHITESPACE","\n\n                ",668],["T_COMMENT","\/\/ Shuffle selection array by option position\n",670],["T_WHITESPACE","                ",671],["T_STRING","usort",671],"(",["T_VARIABLE","$selections",671],",",["T_WHITESPACE"," ",671],"[",["T_VARIABLE","$this",671],",",["T_WHITESPACE"," ",671],["T_CONSTANT_ENCAPSED_STRING","'shakeSelections'",671],"]",")",";",["T_WHITESPACE","\n\n                ",671],["T_FOREACH","foreach",673],["T_WHITESPACE"," ",673],"(",["T_VARIABLE","$selections",673],["T_WHITESPACE"," ",673],["T_AS","as",673],["T_WHITESPACE"," ",673],["T_VARIABLE","$selection",673],")",["T_WHITESPACE"," ",673],"{",["T_WHITESPACE","\n                    ",673],["T_VARIABLE","$selectionOptionId",674],["T_WHITESPACE"," ",674],"=",["T_WHITESPACE"," ",674],["T_VARIABLE","$selection",674],["T_OBJECT_OPERATOR","->",674],["T_STRING","getOptionId",674],"(",")",";",["T_WHITESPACE","\n                    ",674],["T_VARIABLE","$qty",675],["T_WHITESPACE"," ",675],"=",["T_WHITESPACE"," ",675],["T_VARIABLE","$this",675],["T_OBJECT_OPERATOR","->",675],["T_STRING","getQty",675],"(",["T_VARIABLE","$selection",675],",",["T_WHITESPACE"," ",675],["T_VARIABLE","$qtys",675],",",["T_WHITESPACE"," ",675],["T_VARIABLE","$selectionOptionId",675],")",";",["T_WHITESPACE","\n\n                    ",675],["T_VARIABLE","$selectionId",677],["T_WHITESPACE"," ",677],"=",["T_WHITESPACE"," ",677],["T_VARIABLE","$selection",677],["T_OBJECT_OPERATOR","->",677],["T_STRING","getSelectionId",677],"(",")",";",["T_WHITESPACE","\n                    ",677],["T_VARIABLE","$product",678],["T_OBJECT_OPERATOR","->",678],["T_STRING","addCustomOption",678],"(",["T_CONSTANT_ENCAPSED_STRING","'selection_qty_'",678],["T_WHITESPACE"," ",678],".",["T_WHITESPACE"," ",678],["T_VARIABLE","$selectionId",678],",",["T_WHITESPACE"," ",678],["T_VARIABLE","$qty",678],",",["T_WHITESPACE"," ",678],["T_VARIABLE","$selection",678],")",";",["T_WHITESPACE","\n                    ",678],["T_VARIABLE","$selection",679],["T_OBJECT_OPERATOR","->",679],["T_STRING","addCustomOption",679],"(",["T_CONSTANT_ENCAPSED_STRING","'selection_id'",679],",",["T_WHITESPACE"," ",679],["T_VARIABLE","$selectionId",679],")",";",["T_WHITESPACE","\n\n                    ",679],["T_VARIABLE","$beforeQty",681],["T_WHITESPACE"," ",681],"=",["T_WHITESPACE"," ",681],["T_VARIABLE","$this",681],["T_OBJECT_OPERATOR","->",681],["T_STRING","getBeforeQty",681],"(",["T_VARIABLE","$product",681],",",["T_WHITESPACE"," ",681],["T_VARIABLE","$selection",681],")",";",["T_WHITESPACE","\n                    ",681],["T_VARIABLE","$product",682],["T_OBJECT_OPERATOR","->",682],["T_STRING","addCustomOption",682],"(",["T_CONSTANT_ENCAPSED_STRING","'product_qty_'",682],["T_WHITESPACE"," ",682],".",["T_WHITESPACE"," ",682],["T_VARIABLE","$selection",682],["T_OBJECT_OPERATOR","->",682],["T_STRING","getId",682],"(",")",",",["T_WHITESPACE"," ",682],["T_VARIABLE","$qty",682],["T_WHITESPACE"," ",682],"+",["T_WHITESPACE"," ",682],["T_VARIABLE","$beforeQty",682],",",["T_WHITESPACE"," ",682],["T_VARIABLE","$selection",682],")",";",["T_WHITESPACE","\n\n                    ",682],["T_COMMENT","\/*\n                     * Create extra attributes that will be converted to product options in order item\n                     * for selection (not for all bundle)\n                     *\/",684],["T_WHITESPACE","\n                    ",687],["T_VARIABLE","$price",688],["T_WHITESPACE"," ",688],"=",["T_WHITESPACE"," ",688],["T_VARIABLE","$product",688],["T_OBJECT_OPERATOR","->",688],["T_STRING","getPriceModel",688],"(",")",["T_WHITESPACE","\n                        ",688],["T_OBJECT_OPERATOR","->",689],["T_STRING","getSelectionFinalTotalPrice",689],"(",["T_VARIABLE","$product",689],",",["T_WHITESPACE"," ",689],["T_VARIABLE","$selection",689],",",["T_WHITESPACE"," ",689],["T_LNUMBER","0",689],",",["T_WHITESPACE"," ",689],["T_VARIABLE","$qty",689],")",";",["T_WHITESPACE","\n                    ",689],["T_VARIABLE","$attributes",690],["T_WHITESPACE"," ",690],"=",["T_WHITESPACE"," ",690],"[",["T_WHITESPACE","\n                        ",690],["T_CONSTANT_ENCAPSED_STRING","'price'",691],["T_WHITESPACE"," ",691],["T_DOUBLE_ARROW","=>",691],["T_WHITESPACE"," ",691],["T_VARIABLE","$this",691],["T_OBJECT_OPERATOR","->",691],["T_STRING","priceCurrency",691],["T_OBJECT_OPERATOR","->",691],["T_STRING","convert",691],"(",["T_VARIABLE","$price",691],")",",",["T_WHITESPACE","\n                        ",691],["T_CONSTANT_ENCAPSED_STRING","'qty'",692],["T_WHITESPACE"," ",692],["T_DOUBLE_ARROW","=>",692],["T_WHITESPACE"," ",692],["T_VARIABLE","$qty",692],",",["T_WHITESPACE","\n                        ",692],["T_CONSTANT_ENCAPSED_STRING","'option_label'",693],["T_WHITESPACE"," ",693],["T_DOUBLE_ARROW","=>",693],["T_WHITESPACE"," ",693],["T_VARIABLE","$selection",693],["T_OBJECT_OPERATOR","->",693],["T_STRING","getOption",693],"(",")",["T_WHITESPACE","\n                            ",693],["T_OBJECT_OPERATOR","->",694],["T_STRING","getTitle",694],"(",")",",",["T_WHITESPACE","\n                        ",694],["T_CONSTANT_ENCAPSED_STRING","'option_id'",695],["T_WHITESPACE"," ",695],["T_DOUBLE_ARROW","=>",695],["T_WHITESPACE"," ",695],["T_VARIABLE","$selection",695],["T_OBJECT_OPERATOR","->",695],["T_STRING","getOption",695],"(",")",["T_WHITESPACE","\n                            ",695],["T_OBJECT_OPERATOR","->",696],["T_STRING","getId",696],"(",")",",",["T_WHITESPACE","\n                    ",696],"]",";",["T_WHITESPACE","\n\n                    ",697],["T_VARIABLE","$_result",699],["T_WHITESPACE"," ",699],"=",["T_WHITESPACE"," ",699],["T_VARIABLE","$selection",699],["T_OBJECT_OPERATOR","->",699],["T_STRING","getTypeInstance",699],"(",")",["T_WHITESPACE","\n                        ",699],["T_OBJECT_OPERATOR","->",700],["T_STRING","prepareForCart",700],"(",["T_VARIABLE","$buyRequest",700],",",["T_WHITESPACE"," ",700],["T_VARIABLE","$selection",700],")",";",["T_WHITESPACE","\n                    ",700],["T_VARIABLE","$this",701],["T_OBJECT_OPERATOR","->",701],["T_STRING","checkIsResult",701],"(",["T_VARIABLE","$_result",701],")",";",["T_WHITESPACE","\n\n                    ",701],["T_VARIABLE","$result",703],"[","]",["T_WHITESPACE"," ",703],"=",["T_WHITESPACE"," ",703],["T_VARIABLE","$_result",703],"[",["T_LNUMBER","0",703],"]",["T_OBJECT_OPERATOR","->",703],["T_STRING","setParentProductId",703],"(",["T_VARIABLE","$product",703],["T_OBJECT_OPERATOR","->",703],["T_STRING","getId",703],"(",")",")",["T_WHITESPACE","\n                        ",703],["T_OBJECT_OPERATOR","->",704],["T_STRING","addCustomOption",704],"(",["T_WHITESPACE","\n                            ",704],["T_CONSTANT_ENCAPSED_STRING","'bundle_option_ids'",705],",",["T_WHITESPACE","\n                            ",705],["T_VARIABLE","$this",706],["T_OBJECT_OPERATOR","->",706],["T_STRING","serializer",706],["T_OBJECT_OPERATOR","->",706],["T_STRING","serialize",706],"(",["T_STRING","array_map",706],"(",["T_CONSTANT_ENCAPSED_STRING","'intval'",706],",",["T_WHITESPACE"," ",706],["T_VARIABLE","$optionIds",706],")",")",["T_WHITESPACE","\n                        ",706],")",["T_WHITESPACE","\n                        ",707],["T_OBJECT_OPERATOR","->",708],["T_STRING","addCustomOption",708],"(",["T_WHITESPACE","\n                            ",708],["T_CONSTANT_ENCAPSED_STRING","'bundle_selection_attributes'",709],",",["T_WHITESPACE","\n                            ",709],["T_VARIABLE","$this",710],["T_OBJECT_OPERATOR","->",710],["T_STRING","serializer",710],["T_OBJECT_OPERATOR","->",710],["T_STRING","serialize",710],"(",["T_VARIABLE","$attributes",710],")",["T_WHITESPACE","\n                        ",710],")",";",["T_WHITESPACE","\n\n                    ",711],["T_IF","if",713],["T_WHITESPACE"," ",713],"(",["T_VARIABLE","$isStrictProcessMode",713],")",["T_WHITESPACE"," ",713],"{",["T_WHITESPACE","\n                        ",713],["T_VARIABLE","$_result",714],"[",["T_LNUMBER","0",714],"]",["T_OBJECT_OPERATOR","->",714],["T_STRING","setCartQty",714],"(",["T_VARIABLE","$qty",714],")",";",["T_WHITESPACE","\n                    ",714],"}",["T_WHITESPACE","\n\n                    ",715],["T_VARIABLE","$resultSelectionId",717],["T_WHITESPACE"," ",717],"=",["T_WHITESPACE"," ",717],["T_VARIABLE","$_result",717],"[",["T_LNUMBER","0",717],"]",["T_OBJECT_OPERATOR","->",717],["T_STRING","getSelectionId",717],"(",")",";",["T_WHITESPACE","\n                    ",717],["T_VARIABLE","$selectionIds",718],"[","]",["T_WHITESPACE"," ",718],"=",["T_WHITESPACE"," ",718],["T_VARIABLE","$resultSelectionId",718],";",["T_WHITESPACE","\n                    ",718],["T_VARIABLE","$uniqueKey",719],"[","]",["T_WHITESPACE"," ",719],"=",["T_WHITESPACE"," ",719],["T_VARIABLE","$resultSelectionId",719],";",["T_WHITESPACE","\n                    ",719],["T_VARIABLE","$uniqueKey",720],"[","]",["T_WHITESPACE"," ",720],"=",["T_WHITESPACE"," ",720],["T_VARIABLE","$qty",720],";",["T_WHITESPACE","\n                ",720],"}",["T_WHITESPACE","\n\n                ",721],["T_COMMENT","\/\/ \"unique\" key for bundle selection and add it to selections and bundle for selections\n",723],["T_WHITESPACE","                ",724],["T_VARIABLE","$uniqueKey",724],["T_WHITESPACE"," ",724],"=",["T_WHITESPACE"," ",724],["T_STRING","implode",724],"(",["T_CONSTANT_ENCAPSED_STRING","'_'",724],",",["T_WHITESPACE"," ",724],["T_VARIABLE","$uniqueKey",724],")",";",["T_WHITESPACE","\n                ",724],["T_FOREACH","foreach",725],["T_WHITESPACE"," ",725],"(",["T_VARIABLE","$result",725],["T_WHITESPACE"," ",725],["T_AS","as",725],["T_WHITESPACE"," ",725],["T_VARIABLE","$item",725],")",["T_WHITESPACE"," ",725],"{",["T_WHITESPACE","\n                    ",725],["T_VARIABLE","$item",726],["T_OBJECT_OPERATOR","->",726],["T_STRING","addCustomOption",726],"(",["T_CONSTANT_ENCAPSED_STRING","'bundle_identity'",726],",",["T_WHITESPACE"," ",726],["T_VARIABLE","$uniqueKey",726],")",";",["T_WHITESPACE","\n                ",726],"}",["T_WHITESPACE","\n                ",727],["T_VARIABLE","$product",728],["T_OBJECT_OPERATOR","->",728],["T_STRING","addCustomOption",728],"(",["T_WHITESPACE","\n                    ",728],["T_CONSTANT_ENCAPSED_STRING","'bundle_option_ids'",729],",",["T_WHITESPACE","\n                    ",729],["T_VARIABLE","$this",730],["T_OBJECT_OPERATOR","->",730],["T_STRING","serializer",730],["T_OBJECT_OPERATOR","->",730],["T_STRING","serialize",730],"(",["T_WHITESPACE","\n                        ",730],["T_STRING","array_map",731],"(",["T_CONSTANT_ENCAPSED_STRING","'intval'",731],",",["T_WHITESPACE"," ",731],["T_VARIABLE","$optionIds",731],")",["T_WHITESPACE","\n                    ",731],")",["T_WHITESPACE","\n                ",732],")",";",["T_WHITESPACE","\n                ",733],["T_VARIABLE","$product",734],["T_OBJECT_OPERATOR","->",734],["T_STRING","addCustomOption",734],"(",["T_CONSTANT_ENCAPSED_STRING","'bundle_selection_ids'",734],",",["T_WHITESPACE"," ",734],["T_VARIABLE","$this",734],["T_OBJECT_OPERATOR","->",734],["T_STRING","serializer",734],["T_OBJECT_OPERATOR","->",734],["T_STRING","serialize",734],"(",["T_VARIABLE","$selectionIds",734],")",")",";",["T_WHITESPACE","\n\n                ",734],["T_RETURN","return",736],["T_WHITESPACE"," ",736],["T_VARIABLE","$result",736],";",["T_WHITESPACE","\n            ",736],"}",["T_WHITESPACE","\n        ",737],"}",["T_WHITESPACE"," ",738],["T_CATCH","catch",738],["T_WHITESPACE"," ",738],"(",["T_NS_SEPARATOR","\\",738],["T_STRING","Magento",738],["T_NS_SEPARATOR","\\",738],["T_STRING","Framework",738],["T_NS_SEPARATOR","\\",738],["T_STRING","Exception",738],["T_NS_SEPARATOR","\\",738],["T_STRING","LocalizedException",738],["T_WHITESPACE"," ",738],["T_VARIABLE","$e",738],")",["T_WHITESPACE"," ",738],"{",["T_WHITESPACE","\n            ",738],["T_RETURN","return",739],["T_WHITESPACE"," ",739],["T_VARIABLE","$e",739],["T_OBJECT_OPERATOR","->",739],["T_STRING","getMessage",739],"(",")",";",["T_WHITESPACE","\n        ",739],"}",["T_WHITESPACE","\n\n        ",740],["T_RETURN","return",742],["T_WHITESPACE"," ",742],["T_VARIABLE","$this",742],["T_OBJECT_OPERATOR","->",742],["T_STRING","getSpecifyOptionMessage",742],"(",")",";",["T_WHITESPACE","\n    ",742],"}",["T_WHITESPACE","\n\n    ",743],["T_DOC_COMMENT","\/**\n     * @param array $array\n     * @return int[]|int[][]\n     *\/",745],["T_WHITESPACE","\n    ",748],["T_PRIVATE","private",749],["T_WHITESPACE"," ",749],["T_FUNCTION","function",749],["T_WHITESPACE"," ",749],["T_STRING","recursiveIntval",749],"(",["T_ARRAY","array",749],["T_WHITESPACE"," ",749],["T_VARIABLE","$array",749],")",["T_WHITESPACE","\n    ",749],"{",["T_WHITESPACE","\n        ",750],["T_FOREACH","foreach",751],["T_WHITESPACE"," ",751],"(",["T_VARIABLE","$array",751],["T_WHITESPACE"," ",751],["T_AS","as",751],["T_WHITESPACE"," ",751],["T_VARIABLE","$key",751],["T_WHITESPACE"," ",751],["T_DOUBLE_ARROW","=>",751],["T_WHITESPACE"," ",751],["T_VARIABLE","$value",751],")",["T_WHITESPACE"," ",751],"{",["T_WHITESPACE","\n            ",751],["T_IF","if",752],["T_WHITESPACE"," ",752],"(",["T_STRING","is_array",752],"(",["T_VARIABLE","$value",752],")",")",["T_WHITESPACE"," ",752],"{",["T_WHITESPACE","\n                ",752],["T_VARIABLE","$array",753],"[",["T_VARIABLE","$key",753],"]",["T_WHITESPACE"," ",753],"=",["T_WHITESPACE"," ",753],["T_VARIABLE","$this",753],["T_OBJECT_OPERATOR","->",753],["T_STRING","recursiveIntval",753],"(",["T_VARIABLE","$value",753],")",";",["T_WHITESPACE","\n            ",753],"}",["T_WHITESPACE"," ",754],["T_ELSEIF","elseif",754],["T_WHITESPACE"," ",754],"(",["T_STRING","is_numeric",754],"(",["T_VARIABLE","$value",754],")",["T_WHITESPACE"," ",754],["T_BOOLEAN_AND","&&",754],["T_WHITESPACE"," ",754],["T_INT_CAST","(int)",754],["T_VARIABLE","$value",754],["T_WHITESPACE"," ",754],["T_IS_NOT_EQUAL","!=",754],["T_WHITESPACE"," ",754],["T_LNUMBER","0",754],")",["T_WHITESPACE"," ",754],"{",["T_WHITESPACE","\n                ",754],["T_VARIABLE","$array",755],"[",["T_VARIABLE","$key",755],"]",["T_WHITESPACE"," ",755],"=",["T_WHITESPACE"," ",755],["T_INT_CAST","(int)",755],["T_VARIABLE","$value",755],";",["T_WHITESPACE","\n            ",755],"}",["T_WHITESPACE"," ",756],["T_ELSE","else",756],["T_WHITESPACE"," ",756],"{",["T_WHITESPACE","\n                ",756],["T_UNSET","unset",757],"(",["T_VARIABLE","$array",757],"[",["T_VARIABLE","$key",757],"]",")",";",["T_WHITESPACE","\n            ",757],"}",["T_WHITESPACE","\n        ",758],"}",["T_WHITESPACE","\n\n        ",759],["T_RETURN","return",761],["T_WHITESPACE"," ",761],["T_VARIABLE","$array",761],";",["T_WHITESPACE","\n    ",761],"}",["T_WHITESPACE","\n\n    ",762],["T_DOC_COMMENT","\/**\n     * @param array $array\n     * @return int[]\n     *\/",764],["T_WHITESPACE","\n    ",767],["T_PRIVATE","private",768],["T_WHITESPACE"," ",768],["T_FUNCTION","function",768],["T_WHITESPACE"," ",768],["T_STRING","multiToFlatArray",768],"(",["T_ARRAY","array",768],["T_WHITESPACE"," ",768],["T_VARIABLE","$array",768],")",["T_WHITESPACE","\n    ",768],"{",["T_WHITESPACE","\n        ",769],["T_VARIABLE","$flatArray",770],["T_WHITESPACE"," ",770],"=",["T_WHITESPACE"," ",770],"[","]",";",["T_WHITESPACE","\n        ",770],["T_FOREACH","foreach",771],["T_WHITESPACE"," ",771],"(",["T_VARIABLE","$array",771],["T_WHITESPACE"," ",771],["T_AS","as",771],["T_WHITESPACE"," ",771],["T_VARIABLE","$key",771],["T_WHITESPACE"," ",771],["T_DOUBLE_ARROW","=>",771],["T_WHITESPACE"," ",771],["T_VARIABLE","$value",771],")",["T_WHITESPACE"," ",771],"{",["T_WHITESPACE","\n            ",771],["T_IF","if",772],["T_WHITESPACE"," ",772],"(",["T_STRING","is_array",772],"(",["T_VARIABLE","$value",772],")",")",["T_WHITESPACE"," ",772],"{",["T_WHITESPACE","\n                ",772],["T_VARIABLE","$flatArray",773],["T_WHITESPACE"," ",773],"=",["T_WHITESPACE"," ",773],["T_STRING","array_merge",773],"(",["T_VARIABLE","$flatArray",773],",",["T_WHITESPACE"," ",773],["T_VARIABLE","$this",773],["T_OBJECT_OPERATOR","->",773],["T_STRING","multiToFlatArray",773],"(",["T_VARIABLE","$value",773],")",")",";",["T_WHITESPACE","\n            ",773],"}",["T_WHITESPACE"," ",774],["T_ELSE","else",774],["T_WHITESPACE"," ",774],"{",["T_WHITESPACE","\n                ",774],["T_VARIABLE","$flatArray",775],"[",["T_VARIABLE","$key",775],"]",["T_WHITESPACE"," ",775],"=",["T_WHITESPACE"," ",775],["T_VARIABLE","$value",775],";",["T_WHITESPACE","\n            ",775],"}",["T_WHITESPACE","\n        ",776],"}",["T_WHITESPACE","\n\n        ",777],["T_RETURN","return",779],["T_WHITESPACE"," ",779],["T_VARIABLE","$flatArray",779],";",["T_WHITESPACE","\n    ",779],"}",["T_WHITESPACE","\n\n    ",780],["T_DOC_COMMENT","\/**\n     * Retrieve message for specify option(s)\n     *\n     * @return \\Magento\\Framework\\Phrase\n     *\/",782],["T_WHITESPACE","\n    ",786],["T_PUBLIC","public",787],["T_WHITESPACE"," ",787],["T_FUNCTION","function",787],["T_WHITESPACE"," ",787],["T_STRING","getSpecifyOptionMessage",787],"(",")",["T_WHITESPACE","\n    ",787],"{",["T_WHITESPACE","\n        ",788],["T_RETURN","return",789],["T_WHITESPACE"," ",789],["T_STRING","__",789],"(",["T_CONSTANT_ENCAPSED_STRING","'Please specify product option(s).'",789],")",";",["T_WHITESPACE","\n    ",789],"}",["T_WHITESPACE","\n\n    ",790],["T_DOC_COMMENT","\/**\n     * Retrieve bundle selections collection based on ids\n     *\n     * @param array $selectionIds\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return \\Magento\\Bundle\\Model\\ResourceModel\\Selection\\Collection\n     *\/",792],["T_WHITESPACE","\n    ",798],["T_PUBLIC","public",799],["T_WHITESPACE"," ",799],["T_FUNCTION","function",799],["T_WHITESPACE"," ",799],["T_STRING","getSelectionsByIds",799],"(",["T_VARIABLE","$selectionIds",799],",",["T_WHITESPACE"," ",799],["T_VARIABLE","$product",799],")",["T_WHITESPACE","\n    ",799],"{",["T_WHITESPACE","\n        ",800],["T_STRING","sort",801],"(",["T_VARIABLE","$selectionIds",801],")",";",["T_WHITESPACE","\n\n        ",801],["T_VARIABLE","$usedSelections",803],["T_WHITESPACE"," ",803],"=",["T_WHITESPACE"," ",803],["T_VARIABLE","$product",803],["T_OBJECT_OPERATOR","->",803],["T_STRING","getData",803],"(",["T_VARIABLE","$this",803],["T_OBJECT_OPERATOR","->",803],["T_STRING","_keyUsedSelections",803],")",";",["T_WHITESPACE","\n        ",803],["T_VARIABLE","$usedSelectionsIds",804],["T_WHITESPACE"," ",804],"=",["T_WHITESPACE"," ",804],["T_VARIABLE","$product",804],["T_OBJECT_OPERATOR","->",804],["T_STRING","getData",804],"(",["T_VARIABLE","$this",804],["T_OBJECT_OPERATOR","->",804],["T_STRING","_keyUsedSelectionsIds",804],")",";",["T_WHITESPACE","\n\n        ",804],["T_IF","if",806],["T_WHITESPACE"," ",806],"(","!",["T_VARIABLE","$usedSelections",806],["T_WHITESPACE"," ",806],["T_BOOLEAN_OR","||",806],["T_WHITESPACE"," ",806],["T_VARIABLE","$usedSelectionsIds",806],["T_WHITESPACE"," ",806],["T_IS_NOT_IDENTICAL","!==",806],["T_WHITESPACE"," ",806],["T_VARIABLE","$selectionIds",806],")",["T_WHITESPACE"," ",806],"{",["T_WHITESPACE","\n            ",806],["T_VARIABLE","$storeId",807],["T_WHITESPACE"," ",807],"=",["T_WHITESPACE"," ",807],["T_VARIABLE","$product",807],["T_OBJECT_OPERATOR","->",807],["T_STRING","getStoreId",807],"(",")",";",["T_WHITESPACE","\n            ",807],["T_VARIABLE","$usedSelections",808],["T_WHITESPACE"," ",808],"=",["T_WHITESPACE"," ",808],["T_VARIABLE","$this",808],["T_OBJECT_OPERATOR","->",808],["T_STRING","_bundleCollection",808],["T_WHITESPACE","\n                ",808],["T_OBJECT_OPERATOR","->",809],["T_STRING","create",809],"(",")",["T_WHITESPACE","\n                ",809],["T_OBJECT_OPERATOR","->",810],["T_STRING","addAttributeToSelect",810],"(",["T_CONSTANT_ENCAPSED_STRING","'*'",810],")",["T_WHITESPACE","\n                ",810],["T_OBJECT_OPERATOR","->",811],["T_STRING","setFlag",811],"(",["T_CONSTANT_ENCAPSED_STRING","'product_children'",811],",",["T_WHITESPACE"," ",811],["T_STRING","true",811],")",["T_WHITESPACE","\n                ",811],["T_OBJECT_OPERATOR","->",812],["T_STRING","addStoreFilter",812],"(",["T_VARIABLE","$this",812],["T_OBJECT_OPERATOR","->",812],["T_STRING","getStoreFilter",812],"(",["T_VARIABLE","$product",812],")",")",["T_WHITESPACE","\n                ",812],["T_OBJECT_OPERATOR","->",813],["T_STRING","setStoreId",813],"(",["T_VARIABLE","$storeId",813],")",["T_WHITESPACE","\n                ",813],["T_OBJECT_OPERATOR","->",814],["T_STRING","setPositionOrder",814],"(",")",["T_WHITESPACE","\n                ",814],["T_OBJECT_OPERATOR","->",815],["T_STRING","addFilterByRequiredOptions",815],"(",")",["T_WHITESPACE","\n                ",815],["T_OBJECT_OPERATOR","->",816],["T_STRING","setSelectionIdsFilter",816],"(",["T_VARIABLE","$selectionIds",816],")",";",["T_WHITESPACE","\n\n            ",816],["T_IF","if",818],["T_WHITESPACE"," ",818],"(","!",["T_VARIABLE","$this",818],["T_OBJECT_OPERATOR","->",818],["T_STRING","_catalogData",818],["T_OBJECT_OPERATOR","->",818],["T_STRING","isPriceGlobal",818],"(",")",["T_WHITESPACE"," ",818],["T_BOOLEAN_AND","&&",818],["T_WHITESPACE"," ",818],["T_VARIABLE","$storeId",818],")",["T_WHITESPACE"," ",818],"{",["T_WHITESPACE","\n                ",818],["T_VARIABLE","$websiteId",819],["T_WHITESPACE"," ",819],"=",["T_WHITESPACE"," ",819],["T_VARIABLE","$this",819],["T_OBJECT_OPERATOR","->",819],["T_STRING","_storeManager",819],["T_OBJECT_OPERATOR","->",819],["T_STRING","getStore",819],"(",["T_VARIABLE","$storeId",819],")",["T_WHITESPACE","\n                    ",819],["T_OBJECT_OPERATOR","->",820],["T_STRING","getWebsiteId",820],"(",")",";",["T_WHITESPACE","\n                ",820],["T_VARIABLE","$usedSelections",821],["T_OBJECT_OPERATOR","->",821],["T_STRING","joinPrices",821],"(",["T_VARIABLE","$websiteId",821],")",";",["T_WHITESPACE","\n            ",821],"}",["T_WHITESPACE","\n            ",822],["T_VARIABLE","$product",823],["T_OBJECT_OPERATOR","->",823],["T_STRING","setData",823],"(",["T_VARIABLE","$this",823],["T_OBJECT_OPERATOR","->",823],["T_STRING","_keyUsedSelections",823],",",["T_WHITESPACE"," ",823],["T_VARIABLE","$usedSelections",823],")",";",["T_WHITESPACE","\n            ",823],["T_VARIABLE","$product",824],["T_OBJECT_OPERATOR","->",824],["T_STRING","setData",824],"(",["T_VARIABLE","$this",824],["T_OBJECT_OPERATOR","->",824],["T_STRING","_keyUsedSelectionsIds",824],",",["T_WHITESPACE"," ",824],["T_VARIABLE","$selectionIds",824],")",";",["T_WHITESPACE","\n        ",824],"}",["T_WHITESPACE","\n\n        ",825],["T_RETURN","return",827],["T_WHITESPACE"," ",827],["T_VARIABLE","$usedSelections",827],";",["T_WHITESPACE","\n    ",827],"}",["T_WHITESPACE","\n\n    ",828],["T_DOC_COMMENT","\/**\n     * Retrieve bundle options collection based on ids\n     *\n     * @param array $optionIds\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return \\Magento\\Bundle\\Model\\ResourceModel\\Option\\Collection\n     *\/",830],["T_WHITESPACE","\n    ",836],["T_PUBLIC","public",837],["T_WHITESPACE"," ",837],["T_FUNCTION","function",837],["T_WHITESPACE"," ",837],["T_STRING","getOptionsByIds",837],"(",["T_VARIABLE","$optionIds",837],",",["T_WHITESPACE"," ",837],["T_VARIABLE","$product",837],")",["T_WHITESPACE","\n    ",837],"{",["T_WHITESPACE","\n        ",838],["T_STRING","sort",839],"(",["T_VARIABLE","$optionIds",839],")",";",["T_WHITESPACE","\n\n        ",839],["T_VARIABLE","$usedOptions",841],["T_WHITESPACE"," ",841],"=",["T_WHITESPACE"," ",841],["T_VARIABLE","$product",841],["T_OBJECT_OPERATOR","->",841],["T_STRING","getData",841],"(",["T_VARIABLE","$this",841],["T_OBJECT_OPERATOR","->",841],["T_STRING","_keyUsedOptions",841],")",";",["T_WHITESPACE","\n        ",841],["T_VARIABLE","$usedOptionsIds",842],["T_WHITESPACE"," ",842],"=",["T_WHITESPACE"," ",842],["T_VARIABLE","$product",842],["T_OBJECT_OPERATOR","->",842],["T_STRING","getData",842],"(",["T_VARIABLE","$this",842],["T_OBJECT_OPERATOR","->",842],["T_STRING","_keyUsedOptionsIds",842],")",";",["T_WHITESPACE","\n\n        ",842],["T_IF","if",844],["T_WHITESPACE"," ",844],"(",["T_WHITESPACE","\n            ",844],"!",["T_VARIABLE","$usedOptions",845],["T_WHITESPACE","\n            ",845],["T_BOOLEAN_OR","||",846],["T_WHITESPACE"," ",846],["T_VARIABLE","$this",846],["T_OBJECT_OPERATOR","->",846],["T_STRING","serializer",846],["T_OBJECT_OPERATOR","->",846],["T_STRING","serialize",846],"(",["T_VARIABLE","$usedOptionsIds",846],")",["T_WHITESPACE"," ",846],["T_IS_NOT_EQUAL","!=",846],["T_WHITESPACE"," ",846],["T_VARIABLE","$this",846],["T_OBJECT_OPERATOR","->",846],["T_STRING","serializer",846],["T_OBJECT_OPERATOR","->",846],["T_STRING","serialize",846],"(",["T_VARIABLE","$optionIds",846],")",["T_WHITESPACE","\n        ",846],")",["T_WHITESPACE"," ",847],"{",["T_WHITESPACE","\n            ",847],["T_VARIABLE","$usedOptions",848],["T_WHITESPACE"," ",848],"=",["T_WHITESPACE"," ",848],["T_VARIABLE","$this",848],["T_OBJECT_OPERATOR","->",848],["T_STRING","_bundleOption",848],["T_WHITESPACE","\n                ",848],["T_OBJECT_OPERATOR","->",849],["T_STRING","create",849],"(",")",["T_WHITESPACE","\n                ",849],["T_OBJECT_OPERATOR","->",850],["T_STRING","getResourceCollection",850],"(",")",["T_WHITESPACE","\n                ",850],["T_OBJECT_OPERATOR","->",851],["T_STRING","setProductIdFilter",851],"(",["T_VARIABLE","$product",851],["T_OBJECT_OPERATOR","->",851],["T_STRING","getId",851],"(",")",")",["T_WHITESPACE","\n                ",851],["T_OBJECT_OPERATOR","->",852],["T_STRING","setPositionOrder",852],"(",")",["T_WHITESPACE","\n                ",852],["T_OBJECT_OPERATOR","->",853],["T_STRING","joinValues",853],"(",["T_WHITESPACE","\n                    ",853],["T_VARIABLE","$this",854],["T_OBJECT_OPERATOR","->",854],["T_STRING","_storeManager",854],["T_OBJECT_OPERATOR","->",854],["T_STRING","getStore",854],"(",")",["T_WHITESPACE","\n                        ",854],["T_OBJECT_OPERATOR","->",855],["T_STRING","getId",855],"(",")",["T_WHITESPACE","\n                ",855],")",["T_WHITESPACE","\n                ",856],["T_OBJECT_OPERATOR","->",857],["T_STRING","setIdFilter",857],"(",["T_VARIABLE","$optionIds",857],")",";",["T_WHITESPACE","\n            ",857],["T_VARIABLE","$product",858],["T_OBJECT_OPERATOR","->",858],["T_STRING","setData",858],"(",["T_VARIABLE","$this",858],["T_OBJECT_OPERATOR","->",858],["T_STRING","_keyUsedOptions",858],",",["T_WHITESPACE"," ",858],["T_VARIABLE","$usedOptions",858],")",";",["T_WHITESPACE","\n            ",858],["T_VARIABLE","$product",859],["T_OBJECT_OPERATOR","->",859],["T_STRING","setData",859],"(",["T_VARIABLE","$this",859],["T_OBJECT_OPERATOR","->",859],["T_STRING","_keyUsedOptionsIds",859],",",["T_WHITESPACE"," ",859],["T_VARIABLE","$optionIds",859],")",";",["T_WHITESPACE","\n        ",859],"}",["T_WHITESPACE","\n\n        ",860],["T_RETURN","return",862],["T_WHITESPACE"," ",862],["T_VARIABLE","$usedOptions",862],";",["T_WHITESPACE","\n    ",862],"}",["T_WHITESPACE","\n\n    ",863],["T_DOC_COMMENT","\/**\n     * Prepare additional options\/information for order item which will be\n     * created from this product\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return array\n     *\/",865],["T_WHITESPACE","\n    ",871],["T_PUBLIC","public",872],["T_WHITESPACE"," ",872],["T_FUNCTION","function",872],["T_WHITESPACE"," ",872],["T_STRING","getOrderOptions",872],"(",["T_VARIABLE","$product",872],")",["T_WHITESPACE","\n    ",872],"{",["T_WHITESPACE","\n        ",873],["T_VARIABLE","$optionArr",874],["T_WHITESPACE"," ",874],"=",["T_WHITESPACE"," ",874],["T_STRING","parent",874],["T_DOUBLE_COLON","::",874],["T_STRING","getOrderOptions",874],"(",["T_VARIABLE","$product",874],")",";",["T_WHITESPACE","\n        ",874],["T_VARIABLE","$bundleOptions",875],["T_WHITESPACE"," ",875],"=",["T_WHITESPACE"," ",875],"[","]",";",["T_WHITESPACE","\n\n        ",875],["T_IF","if",877],["T_WHITESPACE"," ",877],"(",["T_VARIABLE","$product",877],["T_OBJECT_OPERATOR","->",877],["T_STRING","hasCustomOptions",877],"(",")",")",["T_WHITESPACE"," ",877],"{",["T_WHITESPACE","\n            ",877],["T_VARIABLE","$customOption",878],["T_WHITESPACE"," ",878],"=",["T_WHITESPACE"," ",878],["T_VARIABLE","$product",878],["T_OBJECT_OPERATOR","->",878],["T_STRING","getCustomOption",878],"(",["T_CONSTANT_ENCAPSED_STRING","'bundle_option_ids'",878],")",";",["T_WHITESPACE","\n            ",878],["T_VARIABLE","$optionIds",879],["T_WHITESPACE"," ",879],"=",["T_WHITESPACE"," ",879],["T_VARIABLE","$this",879],["T_OBJECT_OPERATOR","->",879],["T_STRING","serializer",879],["T_OBJECT_OPERATOR","->",879],["T_STRING","unserialize",879],"(",["T_VARIABLE","$customOption",879],["T_OBJECT_OPERATOR","->",879],["T_STRING","getValue",879],"(",")",")",";",["T_WHITESPACE","\n            ",879],["T_VARIABLE","$options",880],["T_WHITESPACE"," ",880],"=",["T_WHITESPACE"," ",880],["T_VARIABLE","$this",880],["T_OBJECT_OPERATOR","->",880],["T_STRING","getOptionsByIds",880],"(",["T_VARIABLE","$optionIds",880],",",["T_WHITESPACE"," ",880],["T_VARIABLE","$product",880],")",";",["T_WHITESPACE","\n            ",880],["T_VARIABLE","$customOption",881],["T_WHITESPACE"," ",881],"=",["T_WHITESPACE"," ",881],["T_VARIABLE","$product",881],["T_OBJECT_OPERATOR","->",881],["T_STRING","getCustomOption",881],"(",["T_CONSTANT_ENCAPSED_STRING","'bundle_selection_ids'",881],")",";",["T_WHITESPACE","\n            ",881],["T_VARIABLE","$selectionIds",882],["T_WHITESPACE"," ",882],"=",["T_WHITESPACE"," ",882],["T_VARIABLE","$this",882],["T_OBJECT_OPERATOR","->",882],["T_STRING","serializer",882],["T_OBJECT_OPERATOR","->",882],["T_STRING","unserialize",882],"(",["T_VARIABLE","$customOption",882],["T_OBJECT_OPERATOR","->",882],["T_STRING","getValue",882],"(",")",")",";",["T_WHITESPACE","\n            ",882],["T_VARIABLE","$selections",883],["T_WHITESPACE"," ",883],"=",["T_WHITESPACE"," ",883],["T_VARIABLE","$this",883],["T_OBJECT_OPERATOR","->",883],["T_STRING","getSelectionsByIds",883],"(",["T_VARIABLE","$selectionIds",883],",",["T_WHITESPACE"," ",883],["T_VARIABLE","$product",883],")",";",["T_WHITESPACE","\n            ",883],["T_FOREACH","foreach",884],["T_WHITESPACE"," ",884],"(",["T_VARIABLE","$selections",884],["T_OBJECT_OPERATOR","->",884],["T_STRING","getItems",884],"(",")",["T_WHITESPACE"," ",884],["T_AS","as",884],["T_WHITESPACE"," ",884],["T_VARIABLE","$selection",884],")",["T_WHITESPACE"," ",884],"{",["T_WHITESPACE","\n                ",884],["T_IF","if",885],["T_WHITESPACE"," ",885],"(",["T_VARIABLE","$selection",885],["T_OBJECT_OPERATOR","->",885],["T_STRING","isSalable",885],"(",")",")",["T_WHITESPACE"," ",885],"{",["T_WHITESPACE","\n                    ",885],["T_VARIABLE","$selectionQty",886],["T_WHITESPACE"," ",886],"=",["T_WHITESPACE"," ",886],["T_VARIABLE","$product",886],["T_OBJECT_OPERATOR","->",886],["T_STRING","getCustomOption",886],"(",["T_CONSTANT_ENCAPSED_STRING","'selection_qty_'",886],["T_WHITESPACE"," ",886],".",["T_WHITESPACE"," ",886],["T_VARIABLE","$selection",886],["T_OBJECT_OPERATOR","->",886],["T_STRING","getSelectionId",886],"(",")",")",";",["T_WHITESPACE","\n                    ",886],["T_IF","if",887],["T_WHITESPACE"," ",887],"(",["T_VARIABLE","$selectionQty",887],")",["T_WHITESPACE"," ",887],"{",["T_WHITESPACE","\n                        ",887],["T_VARIABLE","$price",888],["T_WHITESPACE"," ",888],"=",["T_WHITESPACE"," ",888],["T_VARIABLE","$product",888],["T_OBJECT_OPERATOR","->",888],["T_STRING","getPriceModel",888],"(",")",["T_WHITESPACE","\n                            ",888],["T_OBJECT_OPERATOR","->",889],["T_STRING","getSelectionFinalTotalPrice",889],"(",["T_WHITESPACE","\n                                ",889],["T_VARIABLE","$product",890],",",["T_WHITESPACE","\n                                ",890],["T_VARIABLE","$selection",891],",",["T_WHITESPACE","\n                                ",891],["T_LNUMBER","0",892],",",["T_WHITESPACE","\n                                ",892],["T_VARIABLE","$selectionQty",893],["T_OBJECT_OPERATOR","->",893],["T_STRING","getValue",893],"(",")",["T_WHITESPACE","\n                            ",893],")",";",["T_WHITESPACE","\n\n                        ",894],["T_VARIABLE","$option",896],["T_WHITESPACE"," ",896],"=",["T_WHITESPACE"," ",896],["T_VARIABLE","$options",896],["T_OBJECT_OPERATOR","->",896],["T_STRING","getItemById",896],"(",["T_VARIABLE","$selection",896],["T_OBJECT_OPERATOR","->",896],["T_STRING","getOptionId",896],"(",")",")",";",["T_WHITESPACE","\n                        ",896],["T_IF","if",897],["T_WHITESPACE"," ",897],"(","!",["T_ISSET","isset",897],"(",["T_VARIABLE","$bundleOptions",897],"[",["T_VARIABLE","$option",897],["T_OBJECT_OPERATOR","->",897],["T_STRING","getId",897],"(",")","]",")",")",["T_WHITESPACE"," ",897],"{",["T_WHITESPACE","\n                            ",897],["T_VARIABLE","$bundleOptions",898],"[",["T_VARIABLE","$option",898],["T_OBJECT_OPERATOR","->",898],["T_STRING","getId",898],"(",")","]",["T_WHITESPACE"," ",898],"=",["T_WHITESPACE"," ",898],"[",["T_WHITESPACE","\n                                ",898],["T_CONSTANT_ENCAPSED_STRING","'option_id'",899],["T_WHITESPACE"," ",899],["T_DOUBLE_ARROW","=>",899],["T_WHITESPACE"," ",899],["T_VARIABLE","$option",899],["T_OBJECT_OPERATOR","->",899],["T_STRING","getId",899],"(",")",",",["T_WHITESPACE","\n                                ",899],["T_CONSTANT_ENCAPSED_STRING","'label'",900],["T_WHITESPACE"," ",900],["T_DOUBLE_ARROW","=>",900],["T_WHITESPACE"," ",900],["T_VARIABLE","$option",900],["T_OBJECT_OPERATOR","->",900],["T_STRING","getTitle",900],"(",")",",",["T_WHITESPACE","\n                                ",900],["T_CONSTANT_ENCAPSED_STRING","'value'",901],["T_WHITESPACE"," ",901],["T_DOUBLE_ARROW","=>",901],["T_WHITESPACE"," ",901],"[","]",",",["T_WHITESPACE","\n                            ",901],"]",";",["T_WHITESPACE","\n                        ",902],"}",["T_WHITESPACE","\n\n                        ",903],["T_VARIABLE","$bundleOptions",905],"[",["T_VARIABLE","$option",905],["T_OBJECT_OPERATOR","->",905],["T_STRING","getId",905],"(",")","]","[",["T_CONSTANT_ENCAPSED_STRING","'value'",905],"]","[","]",["T_WHITESPACE"," ",905],"=",["T_WHITESPACE"," ",905],"[",["T_WHITESPACE","\n                            ",905],["T_CONSTANT_ENCAPSED_STRING","'title'",906],["T_WHITESPACE"," ",906],["T_DOUBLE_ARROW","=>",906],["T_WHITESPACE"," ",906],["T_VARIABLE","$selection",906],["T_OBJECT_OPERATOR","->",906],["T_STRING","getName",906],"(",")",",",["T_WHITESPACE","\n                            ",906],["T_CONSTANT_ENCAPSED_STRING","'qty'",907],["T_WHITESPACE"," ",907],["T_DOUBLE_ARROW","=>",907],["T_WHITESPACE"," ",907],["T_VARIABLE","$selectionQty",907],["T_OBJECT_OPERATOR","->",907],["T_STRING","getValue",907],"(",")",",",["T_WHITESPACE","\n                            ",907],["T_CONSTANT_ENCAPSED_STRING","'price'",908],["T_WHITESPACE"," ",908],["T_DOUBLE_ARROW","=>",908],["T_WHITESPACE"," ",908],["T_VARIABLE","$this",908],["T_OBJECT_OPERATOR","->",908],["T_STRING","priceCurrency",908],["T_OBJECT_OPERATOR","->",908],["T_STRING","convert",908],"(",["T_VARIABLE","$price",908],")",",",["T_WHITESPACE","\n                        ",908],"]",";",["T_WHITESPACE","\n                    ",909],"}",["T_WHITESPACE","\n                ",910],"}",["T_WHITESPACE","\n            ",911],"}",["T_WHITESPACE","\n        ",912],"}",["T_WHITESPACE","\n\n        ",913],["T_VARIABLE","$optionArr",915],"[",["T_CONSTANT_ENCAPSED_STRING","'bundle_options'",915],"]",["T_WHITESPACE"," ",915],"=",["T_WHITESPACE"," ",915],["T_VARIABLE","$bundleOptions",915],";",["T_WHITESPACE","\n\n        ",915],["T_DOC_COMMENT","\/**\n         * Product Prices calculations save\n         *\/",917],["T_WHITESPACE","\n        ",919],["T_IF","if",920],["T_WHITESPACE"," ",920],"(",["T_VARIABLE","$product",920],["T_OBJECT_OPERATOR","->",920],["T_STRING","getPriceType",920],"(",")",")",["T_WHITESPACE"," ",920],"{",["T_WHITESPACE","\n            ",920],["T_VARIABLE","$optionArr",921],"[",["T_CONSTANT_ENCAPSED_STRING","'product_calculations'",921],"]",["T_WHITESPACE"," ",921],"=",["T_WHITESPACE"," ",921],["T_STRING","self",921],["T_DOUBLE_COLON","::",921],["T_STRING","CALCULATE_PARENT",921],";",["T_WHITESPACE","\n        ",921],"}",["T_WHITESPACE"," ",922],["T_ELSE","else",922],["T_WHITESPACE"," ",922],"{",["T_WHITESPACE","\n            ",922],["T_VARIABLE","$optionArr",923],"[",["T_CONSTANT_ENCAPSED_STRING","'product_calculations'",923],"]",["T_WHITESPACE"," ",923],"=",["T_WHITESPACE"," ",923],["T_STRING","self",923],["T_DOUBLE_COLON","::",923],["T_STRING","CALCULATE_CHILD",923],";",["T_WHITESPACE","\n        ",923],"}",["T_WHITESPACE","\n\n        ",924],["T_VARIABLE","$optionArr",926],"[",["T_CONSTANT_ENCAPSED_STRING","'shipment_type'",926],"]",["T_WHITESPACE"," ",926],"=",["T_WHITESPACE"," ",926],["T_VARIABLE","$product",926],["T_OBJECT_OPERATOR","->",926],["T_STRING","getShipmentType",926],"(",")",";",["T_WHITESPACE","\n\n        ",926],["T_RETURN","return",928],["T_WHITESPACE"," ",928],["T_VARIABLE","$optionArr",928],";",["T_WHITESPACE","\n    ",928],"}",["T_WHITESPACE","\n\n    ",929],["T_DOC_COMMENT","\/**\n     * Sort selections method for usort function\n     * Sort selections by option position, selection position and selection id\n     *\n     * @param  \\Magento\\Catalog\\Model\\Product $firstItem\n     * @param  \\Magento\\Catalog\\Model\\Product $secondItem\n     * @return int\n     *\/",931],["T_WHITESPACE","\n    ",938],["T_PUBLIC","public",939],["T_WHITESPACE"," ",939],["T_FUNCTION","function",939],["T_WHITESPACE"," ",939],["T_STRING","shakeSelections",939],"(",["T_VARIABLE","$firstItem",939],",",["T_WHITESPACE"," ",939],["T_VARIABLE","$secondItem",939],")",["T_WHITESPACE","\n    ",939],"{",["T_WHITESPACE","\n        ",940],["T_VARIABLE","$aPosition",941],["T_WHITESPACE"," ",941],"=",["T_WHITESPACE"," ",941],"[",["T_WHITESPACE","\n            ",941],["T_VARIABLE","$firstItem",942],["T_OBJECT_OPERATOR","->",942],["T_STRING","getOption",942],"(",")",["T_WHITESPACE","\n                ",942],["T_OBJECT_OPERATOR","->",943],["T_STRING","getPosition",943],"(",")",",",["T_WHITESPACE","\n            ",943],["T_VARIABLE","$firstItem",944],["T_OBJECT_OPERATOR","->",944],["T_STRING","getOptionId",944],"(",")",",",["T_WHITESPACE","\n            ",944],["T_VARIABLE","$firstItem",945],["T_OBJECT_OPERATOR","->",945],["T_STRING","getPosition",945],"(",")",",",["T_WHITESPACE","\n            ",945],["T_VARIABLE","$firstItem",946],["T_OBJECT_OPERATOR","->",946],["T_STRING","getSelectionId",946],"(",")",",",["T_WHITESPACE","\n        ",946],"]",";",["T_WHITESPACE","\n        ",947],["T_VARIABLE","$bPosition",948],["T_WHITESPACE"," ",948],"=",["T_WHITESPACE"," ",948],"[",["T_WHITESPACE","\n            ",948],["T_VARIABLE","$secondItem",949],["T_OBJECT_OPERATOR","->",949],["T_STRING","getOption",949],"(",")",["T_WHITESPACE","\n                ",949],["T_OBJECT_OPERATOR","->",950],["T_STRING","getPosition",950],"(",")",",",["T_WHITESPACE","\n            ",950],["T_VARIABLE","$secondItem",951],["T_OBJECT_OPERATOR","->",951],["T_STRING","getOptionId",951],"(",")",",",["T_WHITESPACE","\n            ",951],["T_VARIABLE","$secondItem",952],["T_OBJECT_OPERATOR","->",952],["T_STRING","getPosition",952],"(",")",",",["T_WHITESPACE","\n            ",952],["T_VARIABLE","$secondItem",953],["T_OBJECT_OPERATOR","->",953],["T_STRING","getSelectionId",953],"(",")",",",["T_WHITESPACE","\n        ",953],"]",";",["T_WHITESPACE","\n        ",954],["T_IF","if",955],["T_WHITESPACE"," ",955],"(",["T_VARIABLE","$aPosition",955],["T_WHITESPACE"," ",955],["T_IS_EQUAL","==",955],["T_WHITESPACE"," ",955],["T_VARIABLE","$bPosition",955],")",["T_WHITESPACE"," ",955],"{",["T_WHITESPACE","\n            ",955],["T_RETURN","return",956],["T_WHITESPACE"," ",956],["T_LNUMBER","0",956],";",["T_WHITESPACE","\n        ",956],"}",["T_WHITESPACE"," ",957],["T_ELSE","else",957],["T_WHITESPACE"," ",957],"{",["T_WHITESPACE","\n            ",957],["T_RETURN","return",958],["T_WHITESPACE"," ",958],["T_VARIABLE","$aPosition",958],["T_WHITESPACE"," ",958],"<",["T_WHITESPACE"," ",958],["T_VARIABLE","$bPosition",958],["T_WHITESPACE"," ",958],"?",["T_WHITESPACE"," ",958],"-",["T_LNUMBER","1",958],["T_WHITESPACE"," ",958],":",["T_WHITESPACE"," ",958],["T_LNUMBER","1",958],";",["T_WHITESPACE","\n        ",958],"}",["T_WHITESPACE","\n    ",959],"}",["T_WHITESPACE","\n\n    ",960],["T_DOC_COMMENT","\/**\n     * Return true if product has options\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return bool\n     *\/",962],["T_WHITESPACE","\n    ",967],["T_PUBLIC","public",968],["T_WHITESPACE"," ",968],["T_FUNCTION","function",968],["T_WHITESPACE"," ",968],["T_STRING","hasOptions",968],"(",["T_VARIABLE","$product",968],")",["T_WHITESPACE","\n    ",968],"{",["T_WHITESPACE","\n        ",969],["T_VARIABLE","$this",970],["T_OBJECT_OPERATOR","->",970],["T_STRING","setStoreFilter",970],"(",["T_VARIABLE","$product",970],["T_OBJECT_OPERATOR","->",970],["T_STRING","getStoreId",970],"(",")",",",["T_WHITESPACE"," ",970],["T_VARIABLE","$product",970],")",";",["T_WHITESPACE","\n        ",970],["T_VARIABLE","$optionIds",971],["T_WHITESPACE"," ",971],"=",["T_WHITESPACE"," ",971],["T_VARIABLE","$this",971],["T_OBJECT_OPERATOR","->",971],["T_STRING","getOptionsCollection",971],"(",["T_VARIABLE","$product",971],")",["T_WHITESPACE","\n            ",971],["T_OBJECT_OPERATOR","->",972],["T_STRING","getAllIds",972],"(",")",";",["T_WHITESPACE","\n        ",972],["T_VARIABLE","$collection",973],["T_WHITESPACE"," ",973],"=",["T_WHITESPACE"," ",973],["T_VARIABLE","$this",973],["T_OBJECT_OPERATOR","->",973],["T_STRING","getSelectionsCollection",973],"(",["T_VARIABLE","$optionIds",973],",",["T_WHITESPACE"," ",973],["T_VARIABLE","$product",973],")",";",["T_WHITESPACE","\n\n        ",973],["T_IF","if",975],["T_WHITESPACE"," ",975],"(",["T_STRING","count",975],"(",["T_VARIABLE","$collection",975],")",["T_WHITESPACE"," ",975],">",["T_WHITESPACE"," ",975],["T_LNUMBER","0",975],["T_WHITESPACE"," ",975],["T_BOOLEAN_OR","||",975],["T_WHITESPACE"," ",975],["T_VARIABLE","$product",975],["T_OBJECT_OPERATOR","->",975],["T_STRING","getOptions",975],"(",")",")",["T_WHITESPACE"," ",975],"{",["T_WHITESPACE","\n            ",975],["T_RETURN","return",976],["T_WHITESPACE"," ",976],["T_STRING","true",976],";",["T_WHITESPACE","\n        ",976],"}",["T_WHITESPACE","\n\n        ",977],["T_RETURN","return",979],["T_WHITESPACE"," ",979],["T_STRING","false",979],";",["T_WHITESPACE","\n    ",979],"}",["T_WHITESPACE","\n\n    ",980],["T_DOC_COMMENT","\/**\n     * Allow for updates of children qty's\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return boolean true\n     * @SuppressWarnings(PHPMD.BooleanGetMethodName)\n     * @SuppressWarnings(PHPMD.UnusedFormalParameter)\n     *\/",982],["T_WHITESPACE","\n    ",989],["T_PUBLIC","public",990],["T_WHITESPACE"," ",990],["T_FUNCTION","function",990],["T_WHITESPACE"," ",990],["T_STRING","getForceChildItemQtyChanges",990],"(",["T_VARIABLE","$product",990],")",["T_WHITESPACE","\n    ",990],"{",["T_WHITESPACE","\n        ",991],["T_RETURN","return",992],["T_WHITESPACE"," ",992],["T_STRING","true",992],";",["T_WHITESPACE","\n    ",992],"}",["T_WHITESPACE","\n\n    ",993],["T_DOC_COMMENT","\/**\n     * Retrieve additional searchable data from type instance\n     * Using based on product id and store_id data\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return array\n     *\/",995],["T_WHITESPACE","\n    ",1001],["T_PUBLIC","public",1002],["T_WHITESPACE"," ",1002],["T_FUNCTION","function",1002],["T_WHITESPACE"," ",1002],["T_STRING","getSearchableData",1002],"(",["T_VARIABLE","$product",1002],")",["T_WHITESPACE","\n    ",1002],"{",["T_WHITESPACE","\n        ",1003],["T_VARIABLE","$searchData",1004],["T_WHITESPACE"," ",1004],"=",["T_WHITESPACE"," ",1004],["T_STRING","parent",1004],["T_DOUBLE_COLON","::",1004],["T_STRING","getSearchableData",1004],"(",["T_VARIABLE","$product",1004],")",";",["T_WHITESPACE","\n\n        ",1004],["T_VARIABLE","$optionSearchData",1006],["T_WHITESPACE"," ",1006],"=",["T_WHITESPACE"," ",1006],["T_VARIABLE","$this",1006],["T_OBJECT_OPERATOR","->",1006],["T_STRING","_bundleOption",1006],["T_OBJECT_OPERATOR","->",1006],["T_STRING","create",1006],"(",")",["T_WHITESPACE","\n            ",1006],["T_OBJECT_OPERATOR","->",1007],["T_STRING","getSearchableData",1007],"(",["T_WHITESPACE","\n                ",1007],["T_VARIABLE","$product",1008],["T_OBJECT_OPERATOR","->",1008],["T_STRING","getId",1008],"(",")",",",["T_WHITESPACE","\n                ",1008],["T_VARIABLE","$product",1009],["T_OBJECT_OPERATOR","->",1009],["T_STRING","getStoreId",1009],"(",")",["T_WHITESPACE","\n            ",1009],")",";",["T_WHITESPACE","\n        ",1010],["T_IF","if",1011],["T_WHITESPACE"," ",1011],"(",["T_VARIABLE","$optionSearchData",1011],")",["T_WHITESPACE"," ",1011],"{",["T_WHITESPACE","\n            ",1011],["T_VARIABLE","$searchData",1012],["T_WHITESPACE"," ",1012],"=",["T_WHITESPACE"," ",1012],["T_STRING","array_merge",1012],"(",["T_VARIABLE","$searchData",1012],",",["T_WHITESPACE"," ",1012],["T_VARIABLE","$optionSearchData",1012],")",";",["T_WHITESPACE","\n        ",1012],"}",["T_WHITESPACE","\n\n        ",1013],["T_RETURN","return",1015],["T_WHITESPACE"," ",1015],["T_VARIABLE","$searchData",1015],";",["T_WHITESPACE","\n    ",1015],"}",["T_WHITESPACE","\n\n    ",1016],["T_DOC_COMMENT","\/**\n     * Check if product can be bought\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return $this\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     *\/",1018],["T_WHITESPACE","\n    ",1024],["T_PUBLIC","public",1025],["T_WHITESPACE"," ",1025],["T_FUNCTION","function",1025],["T_WHITESPACE"," ",1025],["T_STRING","checkProductBuyState",1025],"(",["T_VARIABLE","$product",1025],")",["T_WHITESPACE","\n    ",1025],"{",["T_WHITESPACE","\n        ",1026],["T_STRING","parent",1027],["T_DOUBLE_COLON","::",1027],["T_STRING","checkProductBuyState",1027],"(",["T_VARIABLE","$product",1027],")",";",["T_WHITESPACE","\n        ",1027],["T_VARIABLE","$productOptionIds",1028],["T_WHITESPACE"," ",1028],"=",["T_WHITESPACE"," ",1028],["T_VARIABLE","$this",1028],["T_OBJECT_OPERATOR","->",1028],["T_STRING","getOptionsIds",1028],"(",["T_VARIABLE","$product",1028],")",";",["T_WHITESPACE","\n        ",1028],["T_VARIABLE","$productSelections",1029],["T_WHITESPACE"," ",1029],"=",["T_WHITESPACE"," ",1029],["T_VARIABLE","$this",1029],["T_OBJECT_OPERATOR","->",1029],["T_STRING","getSelectionsCollection",1029],"(",["T_VARIABLE","$productOptionIds",1029],",",["T_WHITESPACE"," ",1029],["T_VARIABLE","$product",1029],")",";",["T_WHITESPACE","\n        ",1029],["T_VARIABLE","$selectionIds",1030],["T_WHITESPACE"," ",1030],"=",["T_WHITESPACE"," ",1030],["T_VARIABLE","$product",1030],["T_OBJECT_OPERATOR","->",1030],["T_STRING","getCustomOption",1030],"(",["T_CONSTANT_ENCAPSED_STRING","'bundle_selection_ids'",1030],")",";",["T_WHITESPACE","\n        ",1030],["T_VARIABLE","$selectionIds",1031],["T_WHITESPACE"," ",1031],"=",["T_WHITESPACE"," ",1031],["T_VARIABLE","$this",1031],["T_OBJECT_OPERATOR","->",1031],["T_STRING","serializer",1031],["T_OBJECT_OPERATOR","->",1031],["T_STRING","unserialize",1031],"(",["T_VARIABLE","$selectionIds",1031],["T_OBJECT_OPERATOR","->",1031],["T_STRING","getValue",1031],"(",")",")",";",["T_WHITESPACE","\n        ",1031],["T_VARIABLE","$buyRequest",1032],["T_WHITESPACE"," ",1032],"=",["T_WHITESPACE"," ",1032],["T_VARIABLE","$product",1032],["T_OBJECT_OPERATOR","->",1032],["T_STRING","getCustomOption",1032],"(",["T_CONSTANT_ENCAPSED_STRING","'info_buyRequest'",1032],")",";",["T_WHITESPACE","\n \t \t",1032],["T_VARIABLE","$buyRequest",1033],["T_WHITESPACE"," ",1033],"=",["T_WHITESPACE"," ",1033],["T_NEW","new",1033],["T_WHITESPACE"," ",1033],["T_NS_SEPARATOR","\\",1033],["T_STRING","Magento",1033],["T_NS_SEPARATOR","\\",1033],["T_STRING","Framework",1033],["T_NS_SEPARATOR","\\",1033],["T_STRING","DataObject",1033],"(",["T_VARIABLE","$this",1033],["T_OBJECT_OPERATOR","->",1033],["T_STRING","serializer",1033],["T_OBJECT_OPERATOR","->",1033],["T_STRING","unserialize",1033],"(",["T_VARIABLE","$buyRequest",1033],["T_OBJECT_OPERATOR","->",1033],["T_STRING","getValue",1033],"(",")",")",")",";",["T_WHITESPACE","\n \t \t",1033],["T_VARIABLE","$bundleOption",1034],["T_WHITESPACE"," ",1034],"=",["T_WHITESPACE"," ",1034],["T_VARIABLE","$buyRequest",1034],["T_OBJECT_OPERATOR","->",1034],["T_STRING","getBundleOption",1034],"(",")",";",["T_WHITESPACE","\n\n        ",1034],["T_IF","if",1036],["T_WHITESPACE"," ",1036],"(",["T_EMPTY","empty",1036],"(",["T_VARIABLE","$bundleOption",1036],")",")",["T_WHITESPACE"," ",1036],"{",["T_WHITESPACE","\n            ",1036],["T_THROW","throw",1037],["T_WHITESPACE"," ",1037],["T_NEW","new",1037],["T_WHITESPACE"," ",1037],["T_NS_SEPARATOR","\\",1037],["T_STRING","Magento",1037],["T_NS_SEPARATOR","\\",1037],["T_STRING","Framework",1037],["T_NS_SEPARATOR","\\",1037],["T_STRING","Exception",1037],["T_NS_SEPARATOR","\\",1037],["T_STRING","LocalizedException",1037],"(",["T_VARIABLE","$this",1037],["T_OBJECT_OPERATOR","->",1037],["T_STRING","getSpecifyOptionMessage",1037],"(",")",")",";",["T_WHITESPACE","\n        ",1037],"}",["T_WHITESPACE","\n\n        ",1038],["T_VARIABLE","$skipSaleableCheck",1040],["T_WHITESPACE"," ",1040],"=",["T_WHITESPACE"," ",1040],["T_VARIABLE","$this",1040],["T_OBJECT_OPERATOR","->",1040],["T_STRING","_catalogProduct",1040],["T_OBJECT_OPERATOR","->",1040],["T_STRING","getSkipSaleableCheck",1040],"(",")",";",["T_WHITESPACE","\n        ",1040],["T_FOREACH","foreach",1041],["T_WHITESPACE"," ",1041],"(",["T_VARIABLE","$selectionIds",1041],["T_WHITESPACE"," ",1041],["T_AS","as",1041],["T_WHITESPACE"," ",1041],["T_VARIABLE","$selectionId",1041],")",["T_WHITESPACE"," ",1041],"{",["T_WHITESPACE","\n            ",1041],["T_COMMENT","\/* @var $selection \\Magento\\Bundle\\Model\\Selection *\/",1042],["T_WHITESPACE","\n            ",1042],["T_VARIABLE","$selection",1043],["T_WHITESPACE"," ",1043],"=",["T_WHITESPACE"," ",1043],["T_VARIABLE","$productSelections",1043],["T_OBJECT_OPERATOR","->",1043],["T_STRING","getItemById",1043],"(",["T_VARIABLE","$selectionId",1043],")",";",["T_WHITESPACE","\n            ",1043],["T_IF","if",1044],["T_WHITESPACE"," ",1044],"(","!",["T_VARIABLE","$selection",1044],["T_WHITESPACE"," ",1044],["T_BOOLEAN_OR","||",1044],["T_WHITESPACE"," ",1044],"!",["T_VARIABLE","$selection",1044],["T_OBJECT_OPERATOR","->",1044],["T_STRING","isSalable",1044],"(",")",["T_WHITESPACE"," ",1044],["T_BOOLEAN_AND","&&",1044],["T_WHITESPACE"," ",1044],"!",["T_VARIABLE","$skipSaleableCheck",1044],")",["T_WHITESPACE"," ",1044],"{",["T_WHITESPACE","\n                ",1044],["T_THROW","throw",1045],["T_WHITESPACE"," ",1045],["T_NEW","new",1045],["T_WHITESPACE"," ",1045],["T_NS_SEPARATOR","\\",1045],["T_STRING","Magento",1045],["T_NS_SEPARATOR","\\",1045],["T_STRING","Framework",1045],["T_NS_SEPARATOR","\\",1045],["T_STRING","Exception",1045],["T_NS_SEPARATOR","\\",1045],["T_STRING","LocalizedException",1045],"(",["T_WHITESPACE","\n                    ",1045],["T_STRING","__",1046],"(",["T_CONSTANT_ENCAPSED_STRING","'The required options you selected are not available.'",1046],")",["T_WHITESPACE","\n                ",1046],")",";",["T_WHITESPACE","\n            ",1047],"}",["T_WHITESPACE","\n        ",1048],"}",["T_WHITESPACE","\n\n        ",1049],["T_VARIABLE","$product",1051],["T_OBJECT_OPERATOR","->",1051],["T_STRING","getTypeInstance",1051],"(",")",["T_WHITESPACE","\n            ",1051],["T_OBJECT_OPERATOR","->",1052],["T_STRING","setStoreFilter",1052],"(",["T_VARIABLE","$product",1052],["T_OBJECT_OPERATOR","->",1052],["T_STRING","getStoreId",1052],"(",")",",",["T_WHITESPACE"," ",1052],["T_VARIABLE","$product",1052],")",";",["T_WHITESPACE","\n        ",1052],["T_VARIABLE","$optionsCollection",1053],["T_WHITESPACE"," ",1053],"=",["T_WHITESPACE"," ",1053],["T_VARIABLE","$this",1053],["T_OBJECT_OPERATOR","->",1053],["T_STRING","getOptionsCollection",1053],"(",["T_VARIABLE","$product",1053],")",";",["T_WHITESPACE","\n        ",1053],["T_FOREACH","foreach",1054],["T_WHITESPACE"," ",1054],"(",["T_VARIABLE","$optionsCollection",1054],["T_OBJECT_OPERATOR","->",1054],["T_STRING","getItems",1054],"(",")",["T_WHITESPACE"," ",1054],["T_AS","as",1054],["T_WHITESPACE"," ",1054],["T_VARIABLE","$option",1054],")",["T_WHITESPACE"," ",1054],"{",["T_WHITESPACE","\n            ",1054],["T_IF","if",1055],["T_WHITESPACE"," ",1055],"(",["T_VARIABLE","$option",1055],["T_OBJECT_OPERATOR","->",1055],["T_STRING","getRequired",1055],"(",")",["T_WHITESPACE"," ",1055],["T_BOOLEAN_AND","&&",1055],["T_WHITESPACE"," ",1055],["T_EMPTY","empty",1055],"(",["T_VARIABLE","$bundleOption",1055],"[",["T_VARIABLE","$option",1055],["T_OBJECT_OPERATOR","->",1055],["T_STRING","getId",1055],"(",")","]",")",")",["T_WHITESPACE"," ",1055],"{",["T_WHITESPACE","\n                ",1055],["T_THROW","throw",1056],["T_WHITESPACE"," ",1056],["T_NEW","new",1056],["T_WHITESPACE"," ",1056],["T_NS_SEPARATOR","\\",1056],["T_STRING","Magento",1056],["T_NS_SEPARATOR","\\",1056],["T_STRING","Framework",1056],["T_NS_SEPARATOR","\\",1056],["T_STRING","Exception",1056],["T_NS_SEPARATOR","\\",1056],["T_STRING","LocalizedException",1056],"(",["T_STRING","__",1056],"(",["T_CONSTANT_ENCAPSED_STRING","'Please select all required options.'",1056],")",")",";",["T_WHITESPACE","\n            ",1056],"}",["T_WHITESPACE","\n        ",1057],"}",["T_WHITESPACE","\n\n        ",1058],["T_RETURN","return",1060],["T_WHITESPACE"," ",1060],["T_VARIABLE","$this",1060],";",["T_WHITESPACE","\n    ",1060],"}",["T_WHITESPACE","\n\n    ",1061],["T_DOC_COMMENT","\/**\n     * Retrieve products divided into groups required to purchase\n     * At least one product in each group has to be purchased\n     *\n     * @param  \\Magento\\Catalog\\Model\\Product $product\n     * @return array\n     *\/",1063],["T_WHITESPACE","\n    ",1069],["T_PUBLIC","public",1070],["T_WHITESPACE"," ",1070],["T_FUNCTION","function",1070],["T_WHITESPACE"," ",1070],["T_STRING","getProductsToPurchaseByReqGroups",1070],"(",["T_VARIABLE","$product",1070],")",["T_WHITESPACE","\n    ",1070],"{",["T_WHITESPACE","\n        ",1071],["T_VARIABLE","$groups",1072],["T_WHITESPACE"," ",1072],"=",["T_WHITESPACE"," ",1072],"[","]",";",["T_WHITESPACE","\n        ",1072],["T_VARIABLE","$allProducts",1073],["T_WHITESPACE"," ",1073],"=",["T_WHITESPACE"," ",1073],"[","]",";",["T_WHITESPACE","\n        ",1073],["T_VARIABLE","$hasRequiredOptions",1074],["T_WHITESPACE"," ",1074],"=",["T_WHITESPACE"," ",1074],["T_STRING","false",1074],";",["T_WHITESPACE","\n        ",1074],["T_FOREACH","foreach",1075],["T_WHITESPACE"," ",1075],"(",["T_VARIABLE","$this",1075],["T_OBJECT_OPERATOR","->",1075],["T_STRING","getOptions",1075],"(",["T_VARIABLE","$product",1075],")",["T_WHITESPACE"," ",1075],["T_AS","as",1075],["T_WHITESPACE"," ",1075],["T_VARIABLE","$option",1075],")",["T_WHITESPACE"," ",1075],"{",["T_WHITESPACE","\n            ",1075],["T_VARIABLE","$groupProducts",1076],["T_WHITESPACE"," ",1076],"=",["T_WHITESPACE"," ",1076],"[","]",";",["T_WHITESPACE","\n            ",1076],["T_FOREACH","foreach",1077],["T_WHITESPACE"," ",1077],"(",["T_VARIABLE","$this",1077],["T_OBJECT_OPERATOR","->",1077],["T_STRING","getSelectionsCollection",1077],"(","[",["T_VARIABLE","$option",1077],["T_OBJECT_OPERATOR","->",1077],["T_STRING","getId",1077],"(",")","]",",",["T_WHITESPACE"," ",1077],["T_VARIABLE","$product",1077],")",["T_WHITESPACE"," ",1077],["T_AS","as",1077],["T_WHITESPACE"," ",1077],["T_VARIABLE","$childProduct",1077],")",["T_WHITESPACE"," ",1077],"{",["T_WHITESPACE","\n                ",1077],["T_VARIABLE","$groupProducts",1078],"[","]",["T_WHITESPACE"," ",1078],"=",["T_WHITESPACE"," ",1078],["T_VARIABLE","$childProduct",1078],";",["T_WHITESPACE","\n                ",1078],["T_VARIABLE","$allProducts",1079],"[","]",["T_WHITESPACE"," ",1079],"=",["T_WHITESPACE"," ",1079],["T_VARIABLE","$childProduct",1079],";",["T_WHITESPACE","\n            ",1079],"}",["T_WHITESPACE","\n            ",1080],["T_IF","if",1081],["T_WHITESPACE"," ",1081],"(",["T_VARIABLE","$option",1081],["T_OBJECT_OPERATOR","->",1081],["T_STRING","getRequired",1081],"(",")",")",["T_WHITESPACE"," ",1081],"{",["T_WHITESPACE","\n                ",1081],["T_VARIABLE","$groups",1082],"[","]",["T_WHITESPACE"," ",1082],"=",["T_WHITESPACE"," ",1082],["T_VARIABLE","$groupProducts",1082],";",["T_WHITESPACE","\n                ",1082],["T_VARIABLE","$hasRequiredOptions",1083],["T_WHITESPACE"," ",1083],"=",["T_WHITESPACE"," ",1083],["T_STRING","true",1083],";",["T_WHITESPACE","\n            ",1083],"}",["T_WHITESPACE","\n        ",1084],"}",["T_WHITESPACE","\n        ",1085],["T_IF","if",1086],["T_WHITESPACE"," ",1086],"(","!",["T_VARIABLE","$hasRequiredOptions",1086],")",["T_WHITESPACE"," ",1086],"{",["T_WHITESPACE","\n            ",1086],["T_VARIABLE","$groups",1087],["T_WHITESPACE"," ",1087],"=",["T_WHITESPACE"," ",1087],"[",["T_VARIABLE","$allProducts",1087],"]",";",["T_WHITESPACE","\n        ",1087],"}",["T_WHITESPACE","\n\n        ",1088],["T_RETURN","return",1090],["T_WHITESPACE"," ",1090],["T_VARIABLE","$groups",1090],";",["T_WHITESPACE","\n    ",1090],"}",["T_WHITESPACE","\n\n    ",1091],["T_DOC_COMMENT","\/**\n     * Prepare selected options for bundle product\n     *\n     * @param  \\Magento\\Catalog\\Model\\Product $product\n     * @param  \\Magento\\Framework\\DataObject $buyRequest\n     * @return array\n     * @SuppressWarnings(PHPMD.UnusedFormalParameter)\n     *\/",1093],["T_WHITESPACE","\n    ",1100],["T_PUBLIC","public",1101],["T_WHITESPACE"," ",1101],["T_FUNCTION","function",1101],["T_WHITESPACE"," ",1101],["T_STRING","processBuyRequest",1101],"(",["T_VARIABLE","$product",1101],",",["T_WHITESPACE"," ",1101],["T_VARIABLE","$buyRequest",1101],")",["T_WHITESPACE","\n    ",1101],"{",["T_WHITESPACE","\n        ",1102],["T_VARIABLE","$option",1103],["T_WHITESPACE"," ",1103],"=",["T_WHITESPACE"," ",1103],["T_VARIABLE","$buyRequest",1103],["T_OBJECT_OPERATOR","->",1103],["T_STRING","getBundleOption",1103],"(",")",";",["T_WHITESPACE","\n        ",1103],["T_VARIABLE","$optionQty",1104],["T_WHITESPACE"," ",1104],"=",["T_WHITESPACE"," ",1104],["T_VARIABLE","$buyRequest",1104],["T_OBJECT_OPERATOR","->",1104],["T_STRING","getBundleOptionQty",1104],"(",")",";",["T_WHITESPACE","\n\n        ",1104],["T_VARIABLE","$option",1106],["T_WHITESPACE"," ",1106],"=",["T_WHITESPACE"," ",1106],["T_STRING","is_array",1106],"(",["T_VARIABLE","$option",1106],")",["T_WHITESPACE"," ",1106],"?",["T_WHITESPACE"," ",1106],["T_STRING","array_filter",1106],"(",["T_VARIABLE","$option",1106],",",["T_WHITESPACE"," ",1106],["T_CONSTANT_ENCAPSED_STRING","'intval'",1106],")",["T_WHITESPACE"," ",1106],":",["T_WHITESPACE"," ",1106],"[","]",";",["T_WHITESPACE","\n        ",1106],["T_VARIABLE","$optionQty",1107],["T_WHITESPACE"," ",1107],"=",["T_WHITESPACE"," ",1107],["T_STRING","is_array",1107],"(",["T_VARIABLE","$optionQty",1107],")",["T_WHITESPACE"," ",1107],"?",["T_WHITESPACE"," ",1107],["T_STRING","array_filter",1107],"(",["T_VARIABLE","$optionQty",1107],",",["T_WHITESPACE"," ",1107],["T_CONSTANT_ENCAPSED_STRING","'intval'",1107],")",["T_WHITESPACE"," ",1107],":",["T_WHITESPACE"," ",1107],"[","]",";",["T_WHITESPACE","\n\n        ",1107],["T_VARIABLE","$options",1109],["T_WHITESPACE"," ",1109],"=",["T_WHITESPACE"," ",1109],"[",["T_CONSTANT_ENCAPSED_STRING","'bundle_option'",1109],["T_WHITESPACE"," ",1109],["T_DOUBLE_ARROW","=>",1109],["T_WHITESPACE"," ",1109],["T_VARIABLE","$option",1109],",",["T_WHITESPACE"," ",1109],["T_CONSTANT_ENCAPSED_STRING","'bundle_option_qty'",1109],["T_WHITESPACE"," ",1109],["T_DOUBLE_ARROW","=>",1109],["T_WHITESPACE"," ",1109],["T_VARIABLE","$optionQty",1109],"]",";",["T_WHITESPACE","\n\n        ",1109],["T_RETURN","return",1111],["T_WHITESPACE"," ",1111],["T_VARIABLE","$options",1111],";",["T_WHITESPACE","\n    ",1111],"}",["T_WHITESPACE","\n\n    ",1112],["T_DOC_COMMENT","\/**\n     * Check if product can be configured\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return bool\n     *\/",1114],["T_WHITESPACE","\n    ",1119],["T_PUBLIC","public",1120],["T_WHITESPACE"," ",1120],["T_FUNCTION","function",1120],["T_WHITESPACE"," ",1120],["T_STRING","canConfigure",1120],"(",["T_VARIABLE","$product",1120],")",["T_WHITESPACE","\n    ",1120],"{",["T_WHITESPACE","\n        ",1121],["T_RETURN","return",1122],["T_WHITESPACE"," ",1122],["T_VARIABLE","$product",1122],["T_WHITESPACE"," ",1122],["T_INSTANCEOF","instanceof",1122],["T_WHITESPACE"," ",1122],["T_NS_SEPARATOR","\\",1122],["T_STRING","Magento",1122],["T_NS_SEPARATOR","\\",1122],["T_STRING","Catalog",1122],["T_NS_SEPARATOR","\\",1122],["T_STRING","Model",1122],["T_NS_SEPARATOR","\\",1122],["T_STRING","Product",1122],["T_WHITESPACE"," ",1122],["T_BOOLEAN_AND","&&",1122],["T_WHITESPACE"," ",1122],["T_VARIABLE","$product",1122],["T_OBJECT_OPERATOR","->",1122],["T_STRING","isAvailable",1122],"(",")",["T_WHITESPACE"," ",1122],["T_BOOLEAN_AND","&&",1122],["T_WHITESPACE"," ",1122],["T_STRING","parent",1122],["T_DOUBLE_COLON","::",1122],["T_STRING","canConfigure",1122],"(",["T_WHITESPACE","\n            ",1122],["T_VARIABLE","$product",1123],["T_WHITESPACE","\n        ",1123],")",";",["T_WHITESPACE","\n    ",1124],"}",["T_WHITESPACE","\n\n    ",1125],["T_DOC_COMMENT","\/**\n     * Delete data specific for Bundle product type\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return void\n     * @SuppressWarnings(PHPMD.UnusedFormalParameter)\n     *\/",1127],["T_WHITESPACE","\n    ",1133],["T_PUBLIC","public",1134],["T_WHITESPACE"," ",1134],["T_FUNCTION","function",1134],["T_WHITESPACE"," ",1134],["T_STRING","deleteTypeSpecificData",1134],"(",["T_NS_SEPARATOR","\\",1134],["T_STRING","Magento",1134],["T_NS_SEPARATOR","\\",1134],["T_STRING","Catalog",1134],["T_NS_SEPARATOR","\\",1134],["T_STRING","Model",1134],["T_NS_SEPARATOR","\\",1134],["T_STRING","Product",1134],["T_WHITESPACE"," ",1134],["T_VARIABLE","$product",1134],")",["T_WHITESPACE","\n    ",1134],"{",["T_WHITESPACE","\n    ",1135],"}",["T_WHITESPACE","\n\n    ",1136],["T_DOC_COMMENT","\/**\n     * Return array of specific to type product entities\n     *\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return array\n     *\/",1138],["T_WHITESPACE","\n    ",1143],["T_PUBLIC","public",1144],["T_WHITESPACE"," ",1144],["T_FUNCTION","function",1144],["T_WHITESPACE"," ",1144],["T_STRING","getIdentities",1144],"(",["T_NS_SEPARATOR","\\",1144],["T_STRING","Magento",1144],["T_NS_SEPARATOR","\\",1144],["T_STRING","Catalog",1144],["T_NS_SEPARATOR","\\",1144],["T_STRING","Model",1144],["T_NS_SEPARATOR","\\",1144],["T_STRING","Product",1144],["T_WHITESPACE"," ",1144],["T_VARIABLE","$product",1144],")",["T_WHITESPACE","\n    ",1144],"{",["T_WHITESPACE","\n        ",1145],["T_VARIABLE","$identities",1146],["T_WHITESPACE"," ",1146],"=",["T_WHITESPACE"," ",1146],["T_STRING","parent",1146],["T_DOUBLE_COLON","::",1146],["T_STRING","getIdentities",1146],"(",["T_VARIABLE","$product",1146],")",";",["T_WHITESPACE","\n        ",1146],["T_DOC_COMMENT","\/** @var \\Magento\\Bundle\\Model\\Option $option *\/",1147],["T_WHITESPACE","\n        ",1147],["T_FOREACH","foreach",1148],["T_WHITESPACE"," ",1148],"(",["T_VARIABLE","$this",1148],["T_OBJECT_OPERATOR","->",1148],["T_STRING","getOptions",1148],"(",["T_VARIABLE","$product",1148],")",["T_WHITESPACE"," ",1148],["T_AS","as",1148],["T_WHITESPACE"," ",1148],["T_VARIABLE","$option",1148],")",["T_WHITESPACE"," ",1148],"{",["T_WHITESPACE","\n            ",1148],["T_IF","if",1149],["T_WHITESPACE"," ",1149],"(",["T_VARIABLE","$option",1149],["T_OBJECT_OPERATOR","->",1149],["T_STRING","getSelections",1149],"(",")",")",["T_WHITESPACE"," ",1149],"{",["T_WHITESPACE","\n                ",1149],["T_DOC_COMMENT","\/** @var \\Magento\\Catalog\\Model\\Product $selection *\/",1150],["T_WHITESPACE","\n                ",1150],["T_FOREACH","foreach",1151],["T_WHITESPACE"," ",1151],"(",["T_VARIABLE","$option",1151],["T_OBJECT_OPERATOR","->",1151],["T_STRING","getSelections",1151],"(",")",["T_WHITESPACE"," ",1151],["T_AS","as",1151],["T_WHITESPACE"," ",1151],["T_VARIABLE","$selection",1151],")",["T_WHITESPACE"," ",1151],"{",["T_WHITESPACE","\n                    ",1151],["T_VARIABLE","$identities",1152],["T_WHITESPACE"," ",1152],"=",["T_WHITESPACE"," ",1152],["T_STRING","array_merge",1152],"(",["T_VARIABLE","$identities",1152],",",["T_WHITESPACE"," ",1152],["T_VARIABLE","$selection",1152],["T_OBJECT_OPERATOR","->",1152],["T_STRING","getIdentities",1152],"(",")",")",";",["T_WHITESPACE","\n                ",1152],"}",["T_WHITESPACE","\n            ",1153],"}",["T_WHITESPACE","\n        ",1154],"}",["T_WHITESPACE","\n\n        ",1155],["T_RETURN","return",1157],["T_WHITESPACE"," ",1157],["T_VARIABLE","$identities",1157],";",["T_WHITESPACE","\n    ",1157],"}",["T_WHITESPACE","\n\n    ",1158],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\DataObject $selection\n     * @param int[] $qtys\n     * @param int $selectionOptionId\n     * @return float\n     *\/",1160],["T_WHITESPACE","\n    ",1165],["T_PROTECTED","protected",1166],["T_WHITESPACE"," ",1166],["T_FUNCTION","function",1166],["T_WHITESPACE"," ",1166],["T_STRING","getQty",1166],"(",["T_VARIABLE","$selection",1166],",",["T_WHITESPACE"," ",1166],["T_VARIABLE","$qtys",1166],",",["T_WHITESPACE"," ",1166],["T_VARIABLE","$selectionOptionId",1166],")",["T_WHITESPACE","\n    ",1166],"{",["T_WHITESPACE","\n        ",1167],["T_IF","if",1168],["T_WHITESPACE"," ",1168],"(",["T_VARIABLE","$selection",1168],["T_OBJECT_OPERATOR","->",1168],["T_STRING","getSelectionCanChangeQty",1168],"(",")",["T_WHITESPACE"," ",1168],["T_BOOLEAN_AND","&&",1168],["T_WHITESPACE"," ",1168],["T_ISSET","isset",1168],"(",["T_VARIABLE","$qtys",1168],"[",["T_VARIABLE","$selectionOptionId",1168],"]",")",")",["T_WHITESPACE"," ",1168],"{",["T_WHITESPACE","\n            ",1168],["T_VARIABLE","$qty",1169],["T_WHITESPACE"," ",1169],"=",["T_WHITESPACE"," ",1169],["T_DOUBLE_CAST","(float)",1169],["T_VARIABLE","$qtys",1169],"[",["T_VARIABLE","$selectionOptionId",1169],"]",["T_WHITESPACE"," ",1169],">",["T_WHITESPACE"," ",1169],["T_LNUMBER","0",1169],["T_WHITESPACE"," ",1169],"?",["T_WHITESPACE"," ",1169],["T_VARIABLE","$qtys",1169],"[",["T_VARIABLE","$selectionOptionId",1169],"]",["T_WHITESPACE"," ",1169],":",["T_WHITESPACE"," ",1169],["T_LNUMBER","1",1169],";",["T_WHITESPACE","\n        ",1169],"}",["T_WHITESPACE"," ",1170],["T_ELSE","else",1170],["T_WHITESPACE"," ",1170],"{",["T_WHITESPACE","\n            ",1170],["T_VARIABLE","$qty",1171],["T_WHITESPACE"," ",1171],"=",["T_WHITESPACE"," ",1171],["T_DOUBLE_CAST","(float)",1171],["T_VARIABLE","$selection",1171],["T_OBJECT_OPERATOR","->",1171],["T_STRING","getSelectionQty",1171],"(",")",["T_WHITESPACE"," ",1171],"?",["T_WHITESPACE"," ",1171],["T_VARIABLE","$selection",1171],["T_OBJECT_OPERATOR","->",1171],["T_STRING","getSelectionQty",1171],"(",")",["T_WHITESPACE"," ",1171],":",["T_WHITESPACE"," ",1171],["T_LNUMBER","1",1171],";",["T_WHITESPACE","\n        ",1171],"}",["T_WHITESPACE","\n        ",1172],["T_VARIABLE","$qty",1173],["T_WHITESPACE"," ",1173],"=",["T_WHITESPACE"," ",1173],["T_DOUBLE_CAST","(float)",1173],["T_VARIABLE","$qty",1173],";",["T_WHITESPACE","\n\n        ",1173],["T_RETURN","return",1175],["T_WHITESPACE"," ",1175],["T_VARIABLE","$qty",1175],";",["T_WHITESPACE","\n    ",1175],"}",["T_WHITESPACE","\n\n    ",1176],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @param \\Magento\\Framework\\DataObject $selection\n     * @return float|int\n     *\/",1178],["T_WHITESPACE","\n    ",1182],["T_PROTECTED","protected",1183],["T_WHITESPACE"," ",1183],["T_FUNCTION","function",1183],["T_WHITESPACE"," ",1183],["T_STRING","getBeforeQty",1183],"(",["T_VARIABLE","$product",1183],",",["T_WHITESPACE"," ",1183],["T_VARIABLE","$selection",1183],")",["T_WHITESPACE","\n    ",1183],"{",["T_WHITESPACE","\n        ",1184],["T_VARIABLE","$beforeQty",1185],["T_WHITESPACE"," ",1185],"=",["T_WHITESPACE"," ",1185],["T_LNUMBER","0",1185],";",["T_WHITESPACE","\n        ",1185],["T_VARIABLE","$customOption",1186],["T_WHITESPACE"," ",1186],"=",["T_WHITESPACE"," ",1186],["T_VARIABLE","$product",1186],["T_OBJECT_OPERATOR","->",1186],["T_STRING","getCustomOption",1186],"(",["T_CONSTANT_ENCAPSED_STRING","'product_qty_'",1186],["T_WHITESPACE"," ",1186],".",["T_WHITESPACE"," ",1186],["T_VARIABLE","$selection",1186],["T_OBJECT_OPERATOR","->",1186],["T_STRING","getId",1186],"(",")",")",";",["T_WHITESPACE","\n        ",1186],["T_IF","if",1187],["T_WHITESPACE"," ",1187],"(",["T_VARIABLE","$customOption",1187],["T_WHITESPACE"," ",1187],["T_BOOLEAN_AND","&&",1187],["T_WHITESPACE"," ",1187],["T_VARIABLE","$customOption",1187],["T_OBJECT_OPERATOR","->",1187],["T_STRING","getProduct",1187],"(",")",["T_OBJECT_OPERATOR","->",1187],["T_STRING","getId",1187],"(",")",["T_WHITESPACE"," ",1187],["T_IS_EQUAL","==",1187],["T_WHITESPACE"," ",1187],["T_VARIABLE","$selection",1187],["T_OBJECT_OPERATOR","->",1187],["T_STRING","getId",1187],"(",")",")",["T_WHITESPACE"," ",1187],"{",["T_WHITESPACE","\n            ",1187],["T_VARIABLE","$beforeQty",1188],["T_WHITESPACE"," ",1188],"=",["T_WHITESPACE"," ",1188],["T_DOUBLE_CAST","(float)",1188],["T_VARIABLE","$customOption",1188],["T_OBJECT_OPERATOR","->",1188],["T_STRING","getValue",1188],"(",")",";",["T_WHITESPACE","\n            ",1188],["T_RETURN","return",1189],["T_WHITESPACE"," ",1189],["T_VARIABLE","$beforeQty",1189],";",["T_WHITESPACE","\n        ",1189],"}",["T_WHITESPACE","\n\n        ",1190],["T_RETURN","return",1192],["T_WHITESPACE"," ",1192],["T_VARIABLE","$beforeQty",1192],";",["T_WHITESPACE","\n    ",1192],"}",["T_WHITESPACE","\n\n    ",1193],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @param bool $isStrictProcessMode\n     * @param \\Magento\\Bundle\\Model\\ResourceModel\\Option\\Collection $optionsCollection\n     * @param int[] $options\n     * @return void\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     *\/",1195],["T_WHITESPACE","\n    ",1202],["T_PROTECTED","protected",1203],["T_WHITESPACE"," ",1203],["T_FUNCTION","function",1203],["T_WHITESPACE"," ",1203],["T_STRING","checkIsAllRequiredOptions",1203],"(",["T_VARIABLE","$product",1203],",",["T_WHITESPACE"," ",1203],["T_VARIABLE","$isStrictProcessMode",1203],",",["T_WHITESPACE"," ",1203],["T_VARIABLE","$optionsCollection",1203],",",["T_WHITESPACE"," ",1203],["T_VARIABLE","$options",1203],")",["T_WHITESPACE","\n    ",1203],"{",["T_WHITESPACE","\n        ",1204],["T_IF","if",1205],["T_WHITESPACE"," ",1205],"(","!",["T_VARIABLE","$product",1205],["T_OBJECT_OPERATOR","->",1205],["T_STRING","getSkipCheckRequiredOption",1205],"(",")",["T_WHITESPACE"," ",1205],["T_BOOLEAN_AND","&&",1205],["T_WHITESPACE"," ",1205],["T_VARIABLE","$isStrictProcessMode",1205],")",["T_WHITESPACE"," ",1205],"{",["T_WHITESPACE","\n            ",1205],["T_FOREACH","foreach",1206],["T_WHITESPACE"," ",1206],"(",["T_VARIABLE","$optionsCollection",1206],["T_OBJECT_OPERATOR","->",1206],["T_STRING","getItems",1206],"(",")",["T_WHITESPACE"," ",1206],["T_AS","as",1206],["T_WHITESPACE"," ",1206],["T_VARIABLE","$option",1206],")",["T_WHITESPACE"," ",1206],"{",["T_WHITESPACE","\n                ",1206],["T_IF","if",1207],["T_WHITESPACE"," ",1207],"(",["T_VARIABLE","$option",1207],["T_OBJECT_OPERATOR","->",1207],["T_STRING","getRequired",1207],"(",")",["T_WHITESPACE"," ",1207],["T_BOOLEAN_AND","&&",1207],["T_WHITESPACE"," ",1207],"!",["T_ISSET","isset",1207],"(",["T_VARIABLE","$options",1207],"[",["T_VARIABLE","$option",1207],["T_OBJECT_OPERATOR","->",1207],["T_STRING","getId",1207],"(",")","]",")",")",["T_WHITESPACE"," ",1207],"{",["T_WHITESPACE","\n                    ",1207],["T_THROW","throw",1208],["T_WHITESPACE"," ",1208],["T_NEW","new",1208],["T_WHITESPACE"," ",1208],["T_NS_SEPARATOR","\\",1208],["T_STRING","Magento",1208],["T_NS_SEPARATOR","\\",1208],["T_STRING","Framework",1208],["T_NS_SEPARATOR","\\",1208],["T_STRING","Exception",1208],["T_NS_SEPARATOR","\\",1208],["T_STRING","LocalizedException",1208],"(",["T_STRING","__",1208],"(",["T_CONSTANT_ENCAPSED_STRING","'Please select all required options.'",1208],")",")",";",["T_WHITESPACE","\n                ",1208],"}",["T_WHITESPACE","\n            ",1209],"}",["T_WHITESPACE","\n        ",1210],"}",["T_WHITESPACE","\n    ",1211],"}",["T_WHITESPACE","\n\n    ",1212],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Bundle\\Model\\ResourceModel\\Selection\\Collection $selections\n     * @param bool $skipSaleableCheck\n     * @param \\Magento\\Bundle\\Model\\ResourceModel\\Option\\Collection $optionsCollection\n     * @param int[] $options\n     * @return void\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     *\/",1214],["T_WHITESPACE","\n    ",1221],["T_PROTECTED","protected",1222],["T_WHITESPACE"," ",1222],["T_FUNCTION","function",1222],["T_WHITESPACE"," ",1222],["T_STRING","checkSelectionsIsSale",1222],"(",["T_VARIABLE","$selections",1222],",",["T_WHITESPACE"," ",1222],["T_VARIABLE","$skipSaleableCheck",1222],",",["T_WHITESPACE"," ",1222],["T_VARIABLE","$optionsCollection",1222],",",["T_WHITESPACE"," ",1222],["T_VARIABLE","$options",1222],")",["T_WHITESPACE","\n    ",1222],"{",["T_WHITESPACE","\n        ",1223],["T_FOREACH","foreach",1224],["T_WHITESPACE"," ",1224],"(",["T_VARIABLE","$selections",1224],["T_OBJECT_OPERATOR","->",1224],["T_STRING","getItems",1224],"(",")",["T_WHITESPACE"," ",1224],["T_AS","as",1224],["T_WHITESPACE"," ",1224],["T_VARIABLE","$selection",1224],")",["T_WHITESPACE"," ",1224],"{",["T_WHITESPACE","\n            ",1224],["T_IF","if",1225],["T_WHITESPACE"," ",1225],"(","!",["T_VARIABLE","$selection",1225],["T_OBJECT_OPERATOR","->",1225],["T_STRING","isSalable",1225],"(",")",["T_WHITESPACE"," ",1225],["T_BOOLEAN_AND","&&",1225],["T_WHITESPACE"," ",1225],"!",["T_VARIABLE","$skipSaleableCheck",1225],")",["T_WHITESPACE"," ",1225],"{",["T_WHITESPACE","\n                ",1225],["T_VARIABLE","$_option",1226],["T_WHITESPACE"," ",1226],"=",["T_WHITESPACE"," ",1226],["T_VARIABLE","$optionsCollection",1226],["T_OBJECT_OPERATOR","->",1226],["T_STRING","getItemById",1226],"(",["T_VARIABLE","$selection",1226],["T_OBJECT_OPERATOR","->",1226],["T_STRING","getOptionId",1226],"(",")",")",";",["T_WHITESPACE","\n                ",1226],["T_VARIABLE","$optionId",1227],["T_WHITESPACE"," ",1227],"=",["T_WHITESPACE"," ",1227],["T_VARIABLE","$_option",1227],["T_OBJECT_OPERATOR","->",1227],["T_STRING","getId",1227],"(",")",";",["T_WHITESPACE","\n                ",1227],["T_IF","if",1228],["T_WHITESPACE"," ",1228],"(",["T_STRING","is_array",1228],"(",["T_VARIABLE","$options",1228],"[",["T_VARIABLE","$optionId",1228],"]",")",["T_WHITESPACE"," ",1228],["T_BOOLEAN_AND","&&",1228],["T_WHITESPACE"," ",1228],["T_STRING","count",1228],"(",["T_VARIABLE","$options",1228],"[",["T_VARIABLE","$optionId",1228],"]",")",["T_WHITESPACE"," ",1228],">",["T_WHITESPACE"," ",1228],["T_LNUMBER","1",1228],")",["T_WHITESPACE"," ",1228],"{",["T_WHITESPACE","\n                    ",1228],["T_VARIABLE","$moreSelections",1229],["T_WHITESPACE"," ",1229],"=",["T_WHITESPACE"," ",1229],["T_STRING","true",1229],";",["T_WHITESPACE","\n                ",1229],"}",["T_WHITESPACE"," ",1230],["T_ELSE","else",1230],["T_WHITESPACE"," ",1230],"{",["T_WHITESPACE","\n                    ",1230],["T_VARIABLE","$moreSelections",1231],["T_WHITESPACE"," ",1231],"=",["T_WHITESPACE"," ",1231],["T_STRING","false",1231],";",["T_WHITESPACE","\n                ",1231],"}",["T_WHITESPACE","\n                ",1232],["T_VARIABLE","$isMultiSelection",1233],["T_WHITESPACE"," ",1233],"=",["T_WHITESPACE"," ",1233],["T_VARIABLE","$_option",1233],["T_OBJECT_OPERATOR","->",1233],["T_STRING","isMultiSelection",1233],"(",")",";",["T_WHITESPACE","\n                ",1233],["T_IF","if",1234],["T_WHITESPACE"," ",1234],"(",["T_VARIABLE","$_option",1234],["T_OBJECT_OPERATOR","->",1234],["T_STRING","getRequired",1234],"(",")",["T_WHITESPACE"," ",1234],["T_BOOLEAN_AND","&&",1234],["T_WHITESPACE"," ",1234],"(","!",["T_VARIABLE","$isMultiSelection",1234],["T_WHITESPACE"," ",1234],["T_BOOLEAN_OR","||",1234],["T_WHITESPACE"," ",1234],"!",["T_VARIABLE","$moreSelections",1234],")",["T_WHITESPACE","\n                ",1234],")",["T_WHITESPACE"," ",1235],"{",["T_WHITESPACE","\n                    ",1235],["T_THROW","throw",1236],["T_WHITESPACE"," ",1236],["T_NEW","new",1236],["T_WHITESPACE"," ",1236],["T_NS_SEPARATOR","\\",1236],["T_STRING","Magento",1236],["T_NS_SEPARATOR","\\",1236],["T_STRING","Framework",1236],["T_NS_SEPARATOR","\\",1236],["T_STRING","Exception",1236],["T_NS_SEPARATOR","\\",1236],["T_STRING","LocalizedException",1236],"(",["T_WHITESPACE","\n                        ",1236],["T_STRING","__",1237],"(",["T_CONSTANT_ENCAPSED_STRING","'The required options you selected are not available.'",1237],")",["T_WHITESPACE","\n                    ",1237],")",";",["T_WHITESPACE","\n                ",1238],"}",["T_WHITESPACE","\n            ",1239],"}",["T_WHITESPACE","\n        ",1240],"}",["T_WHITESPACE","\n    ",1241],"}",["T_WHITESPACE","\n\n    ",1242],["T_DOC_COMMENT","\/**\n     * @param array $_result\n     * @return void\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     *\/",1244],["T_WHITESPACE","\n    ",1248],["T_PROTECTED","protected",1249],["T_WHITESPACE"," ",1249],["T_FUNCTION","function",1249],["T_WHITESPACE"," ",1249],["T_STRING","checkIsResult",1249],"(",["T_VARIABLE","$_result",1249],")",["T_WHITESPACE","\n    ",1249],"{",["T_WHITESPACE","\n        ",1250],["T_IF","if",1251],["T_WHITESPACE"," ",1251],"(",["T_STRING","is_string",1251],"(",["T_VARIABLE","$_result",1251],")",")",["T_WHITESPACE"," ",1251],"{",["T_WHITESPACE","\n            ",1251],["T_THROW","throw",1252],["T_WHITESPACE"," ",1252],["T_NEW","new",1252],["T_WHITESPACE"," ",1252],["T_NS_SEPARATOR","\\",1252],["T_STRING","Magento",1252],["T_NS_SEPARATOR","\\",1252],["T_STRING","Framework",1252],["T_NS_SEPARATOR","\\",1252],["T_STRING","Exception",1252],["T_NS_SEPARATOR","\\",1252],["T_STRING","LocalizedException",1252],"(",["T_STRING","__",1252],"(",["T_VARIABLE","$_result",1252],")",")",";",["T_WHITESPACE","\n        ",1252],"}",["T_WHITESPACE","\n\n        ",1253],["T_IF","if",1255],["T_WHITESPACE"," ",1255],"(","!",["T_ISSET","isset",1255],"(",["T_VARIABLE","$_result",1255],"[",["T_LNUMBER","0",1255],"]",")",")",["T_WHITESPACE"," ",1255],"{",["T_WHITESPACE","\n            ",1255],["T_THROW","throw",1256],["T_WHITESPACE"," ",1256],["T_NEW","new",1256],["T_WHITESPACE"," ",1256],["T_NS_SEPARATOR","\\",1256],["T_STRING","Magento",1256],["T_NS_SEPARATOR","\\",1256],["T_STRING","Framework",1256],["T_NS_SEPARATOR","\\",1256],["T_STRING","Exception",1256],["T_NS_SEPARATOR","\\",1256],["T_STRING","LocalizedException",1256],"(",["T_WHITESPACE","\n                ",1256],["T_STRING","__",1257],"(",["T_CONSTANT_ENCAPSED_STRING","'We can\\'t add this item to your shopping cart right now.'",1257],")",["T_WHITESPACE","\n            ",1257],")",";",["T_WHITESPACE","\n        ",1258],"}",["T_WHITESPACE","\n    ",1259],"}",["T_WHITESPACE","\n\n    ",1260],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Catalog\\Model\\Product\\Option[] $options\n     * @param \\Magento\\Framework\\DataObject[] $selections\n     * @return \\Magento\\Framework\\DataObject[]\n     *\/",1262],["T_WHITESPACE","\n    ",1266],["T_PROTECTED","protected",1267],["T_WHITESPACE"," ",1267],["T_FUNCTION","function",1267],["T_WHITESPACE"," ",1267],["T_STRING","mergeSelectionsWithOptions",1267],"(",["T_VARIABLE","$options",1267],",",["T_WHITESPACE"," ",1267],["T_VARIABLE","$selections",1267],")",["T_WHITESPACE","\n    ",1267],"{",["T_WHITESPACE","\n        ",1268],["T_FOREACH","foreach",1269],["T_WHITESPACE"," ",1269],"(",["T_VARIABLE","$options",1269],["T_WHITESPACE"," ",1269],["T_AS","as",1269],["T_WHITESPACE"," ",1269],["T_VARIABLE","$option",1269],")",["T_WHITESPACE"," ",1269],"{",["T_WHITESPACE","\n            ",1269],["T_IF","if",1270],["T_WHITESPACE"," ",1270],"(",["T_VARIABLE","$option",1270],["T_OBJECT_OPERATOR","->",1270],["T_STRING","getRequired",1270],"(",")",["T_WHITESPACE"," ",1270],["T_BOOLEAN_AND","&&",1270],["T_WHITESPACE"," ",1270],["T_STRING","count",1270],"(",["T_VARIABLE","$option",1270],["T_OBJECT_OPERATOR","->",1270],["T_STRING","getSelections",1270],"(",")",")",["T_WHITESPACE"," ",1270],["T_IS_EQUAL","==",1270],["T_WHITESPACE"," ",1270],["T_LNUMBER","1",1270],")",["T_WHITESPACE"," ",1270],"{",["T_WHITESPACE","\n                ",1270],["T_VARIABLE","$selections",1271],["T_WHITESPACE"," ",1271],"=",["T_WHITESPACE"," ",1271],["T_STRING","array_merge",1271],"(",["T_VARIABLE","$selections",1271],",",["T_WHITESPACE"," ",1271],["T_VARIABLE","$option",1271],["T_OBJECT_OPERATOR","->",1271],["T_STRING","getSelections",1271],"(",")",")",";",["T_WHITESPACE","\n            ",1271],"}",["T_WHITESPACE"," ",1272],["T_ELSE","else",1272],["T_WHITESPACE"," ",1272],"{",["T_WHITESPACE","\n                ",1272],["T_VARIABLE","$selections",1273],["T_WHITESPACE"," ",1273],"=",["T_WHITESPACE"," ",1273],"[","]",";",["T_WHITESPACE","\n                ",1273],["T_BREAK","break",1274],";",["T_WHITESPACE","\n            ",1274],"}",["T_WHITESPACE","\n        ",1275],"}",["T_WHITESPACE","\n\n        ",1276],["T_RETURN","return",1278],["T_WHITESPACE"," ",1278],["T_VARIABLE","$selections",1278],";",["T_WHITESPACE","\n    ",1278],"}",["T_WHITESPACE","\n",1279],"}",["T_WHITESPACE","\n",1280]]