[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n *\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",6],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Bundle",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Model",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Catalog",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Api",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Data",9],["T_NS_SEPARATOR","\\",9],["T_STRING","ProductInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Catalog",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Api",10],["T_NS_SEPARATOR","\\",10],["T_STRING","ProductRepositoryInterface",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Framework",11],["T_NS_SEPARATOR","\\",11],["T_STRING","App",11],["T_NS_SEPARATOR","\\",11],["T_STRING","ObjectManager",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Framework",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Exception",12],["T_NS_SEPARATOR","\\",12],["T_STRING","CouldNotSaveException",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Framework",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Exception",13],["T_NS_SEPARATOR","\\",13],["T_STRING","InputException",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Framework",14],["T_NS_SEPARATOR","\\",14],["T_STRING","EntityManager",14],["T_NS_SEPARATOR","\\",14],["T_STRING","MetadataPool",14],";",["T_WHITESPACE","\n\n",14],["T_DOC_COMMENT","\/**\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",16],["T_WHITESPACE","\n",18],["T_CLASS","class",19],["T_WHITESPACE"," ",19],["T_STRING","LinkManagement",19],["T_WHITESPACE"," ",19],["T_IMPLEMENTS","implements",19],["T_WHITESPACE"," ",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Magento",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Bundle",19],["T_NS_SEPARATOR","\\",19],["T_STRING","Api",19],["T_NS_SEPARATOR","\\",19],["T_STRING","ProductLinkManagementInterface",19],["T_WHITESPACE","\n",19],"{",["T_WHITESPACE","\n    ",20],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Catalog\\Api\\ProductRepositoryInterface\n     *\/",21],["T_WHITESPACE","\n    ",23],["T_PROTECTED","protected",24],["T_WHITESPACE"," ",24],["T_VARIABLE","$productRepository",24],";",["T_WHITESPACE","\n\n    ",24],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Bundle\\Api\\Data\\LinkInterfaceFactory\n     *\/",26],["T_WHITESPACE","\n    ",28],["T_PROTECTED","protected",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$linkFactory",29],";",["T_WHITESPACE","\n\n    ",29],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Bundle\\Model\\ResourceModel\\BundleFactory\n     *\/",31],["T_WHITESPACE","\n    ",33],["T_PROTECTED","protected",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$bundleFactory",34],";",["T_WHITESPACE","\n\n    ",34],["T_DOC_COMMENT","\/**\n     * @var SelectionFactory\n     *\/",36],["T_WHITESPACE","\n    ",38],["T_PROTECTED","protected",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$bundleSelection",39],";",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Bundle\\Model\\ResourceModel\\Option\\CollectionFactory\n     *\/",41],["T_WHITESPACE","\n    ",43],["T_PROTECTED","protected",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$optionCollection",44],";",["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Api\\DataObjectHelper\n     *\/",46],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$dataObjectHelper",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * @var MetadataPool\n     *\/",51],["T_WHITESPACE","\n    ",53],["T_PRIVATE","private",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$metadataPool",54],";",["T_WHITESPACE","\n\n    ",54],["T_DOC_COMMENT","\/**\n     * @param ProductRepositoryInterface $productRepository\n     * @param \\Magento\\Bundle\\Api\\Data\\LinkInterfaceFactory $linkFactory\n     * @param \\Magento\\Bundle\\Model\\SelectionFactory $bundleSelection\n     * @param \\Magento\\Bundle\\Model\\ResourceModel\\BundleFactory $bundleFactory\n     * @param \\Magento\\Bundle\\Model\\ResourceModel\\Option\\CollectionFactory $optionCollection\n     * @param \\Magento\\Store\\Model\\StoreManagerInterface $storeManager\n     * @param \\Magento\\Framework\\Api\\DataObjectHelper $dataObjectHelper\n     *\/",56],["T_WHITESPACE","\n    ",64],["T_PUBLIC","public",65],["T_WHITESPACE"," ",65],["T_FUNCTION","function",65],["T_WHITESPACE"," ",65],["T_STRING","__construct",65],"(",["T_WHITESPACE","\n        ",65],["T_STRING","ProductRepositoryInterface",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$productRepository",66],",",["T_WHITESPACE","\n        ",66],["T_NS_SEPARATOR","\\",67],["T_STRING","Magento",67],["T_NS_SEPARATOR","\\",67],["T_STRING","Bundle",67],["T_NS_SEPARATOR","\\",67],["T_STRING","Api",67],["T_NS_SEPARATOR","\\",67],["T_STRING","Data",67],["T_NS_SEPARATOR","\\",67],["T_STRING","LinkInterfaceFactory",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$linkFactory",67],",",["T_WHITESPACE","\n        ",67],["T_NS_SEPARATOR","\\",68],["T_STRING","Magento",68],["T_NS_SEPARATOR","\\",68],["T_STRING","Bundle",68],["T_NS_SEPARATOR","\\",68],["T_STRING","Model",68],["T_NS_SEPARATOR","\\",68],["T_STRING","SelectionFactory",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$bundleSelection",68],",",["T_WHITESPACE","\n        ",68],["T_NS_SEPARATOR","\\",69],["T_STRING","Magento",69],["T_NS_SEPARATOR","\\",69],["T_STRING","Bundle",69],["T_NS_SEPARATOR","\\",69],["T_STRING","Model",69],["T_NS_SEPARATOR","\\",69],["T_STRING","ResourceModel",69],["T_NS_SEPARATOR","\\",69],["T_STRING","BundleFactory",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$bundleFactory",69],",",["T_WHITESPACE","\n        ",69],["T_NS_SEPARATOR","\\",70],["T_STRING","Magento",70],["T_NS_SEPARATOR","\\",70],["T_STRING","Bundle",70],["T_NS_SEPARATOR","\\",70],["T_STRING","Model",70],["T_NS_SEPARATOR","\\",70],["T_STRING","ResourceModel",70],["T_NS_SEPARATOR","\\",70],["T_STRING","Option",70],["T_NS_SEPARATOR","\\",70],["T_STRING","CollectionFactory",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$optionCollection",70],",",["T_WHITESPACE","\n        ",70],["T_NS_SEPARATOR","\\",71],["T_STRING","Magento",71],["T_NS_SEPARATOR","\\",71],["T_STRING","Store",71],["T_NS_SEPARATOR","\\",71],["T_STRING","Model",71],["T_NS_SEPARATOR","\\",71],["T_STRING","StoreManagerInterface",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$storeManager",71],",",["T_WHITESPACE","\n        ",71],["T_NS_SEPARATOR","\\",72],["T_STRING","Magento",72],["T_NS_SEPARATOR","\\",72],["T_STRING","Framework",72],["T_NS_SEPARATOR","\\",72],["T_STRING","Api",72],["T_NS_SEPARATOR","\\",72],["T_STRING","DataObjectHelper",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$dataObjectHelper",72],["T_WHITESPACE","\n    ",72],")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n        ",73],["T_VARIABLE","$this",74],["T_OBJECT_OPERATOR","->",74],["T_STRING","productRepository",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_VARIABLE","$productRepository",74],";",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","linkFactory",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_VARIABLE","$linkFactory",75],";",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","bundleFactory",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$bundleFactory",76],";",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","bundleSelection",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE"," ",77],["T_VARIABLE","$bundleSelection",77],";",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","optionCollection",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$optionCollection",78],";",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","storeManager",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$storeManager",79],";",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","dataObjectHelper",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$dataObjectHelper",80],";",["T_WHITESPACE","\n    ",80],"}",["T_WHITESPACE","\n\n    ",81],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",83],["T_WHITESPACE","\n    ",85],["T_PUBLIC","public",86],["T_WHITESPACE"," ",86],["T_FUNCTION","function",86],["T_WHITESPACE"," ",86],["T_STRING","getChildren",86],"(",["T_VARIABLE","$productSku",86],",",["T_WHITESPACE"," ",86],["T_VARIABLE","$optionId",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE"," ",86],["T_STRING","null",86],")",["T_WHITESPACE","\n    ",86],"{",["T_WHITESPACE","\n        ",87],["T_VARIABLE","$product",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","productRepository",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","get",88],"(",["T_VARIABLE","$productSku",88],",",["T_WHITESPACE"," ",88],["T_STRING","true",88],")",";",["T_WHITESPACE","\n        ",88],["T_IF","if",89],["T_WHITESPACE"," ",89],"(",["T_VARIABLE","$product",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getTypeId",89],"(",")",["T_WHITESPACE"," ",89],["T_IS_NOT_EQUAL","!=",89],["T_WHITESPACE"," ",89],["T_NS_SEPARATOR","\\",89],["T_STRING","Magento",89],["T_NS_SEPARATOR","\\",89],["T_STRING","Catalog",89],["T_NS_SEPARATOR","\\",89],["T_STRING","Model",89],["T_NS_SEPARATOR","\\",89],["T_STRING","Product",89],["T_NS_SEPARATOR","\\",89],["T_STRING","Type",89],["T_DOUBLE_COLON","::",89],["T_STRING","TYPE_BUNDLE",89],")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n            ",89],["T_THROW","throw",90],["T_WHITESPACE"," ",90],["T_NEW","new",90],["T_WHITESPACE"," ",90],["T_STRING","InputException",90],"(",["T_STRING","__",90],"(",["T_CONSTANT_ENCAPSED_STRING","'Only implemented for bundle product'",90],")",")",";",["T_WHITESPACE","\n        ",90],"}",["T_WHITESPACE","\n\n        ",91],["T_VARIABLE","$childrenList",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],"[","]",";",["T_WHITESPACE","\n        ",93],["T_FOREACH","foreach",94],["T_WHITESPACE"," ",94],"(",["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getOptions",94],"(",["T_VARIABLE","$product",94],")",["T_WHITESPACE"," ",94],["T_AS","as",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$option",94],")",["T_WHITESPACE"," ",94],"{",["T_WHITESPACE","\n            ",94],["T_IF","if",95],["T_WHITESPACE"," ",95],"(","!",["T_VARIABLE","$option",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getSelections",95],"(",")",["T_WHITESPACE"," ",95],["T_BOOLEAN_OR","||",95],["T_WHITESPACE"," ",95],"(",["T_VARIABLE","$optionId",95],["T_WHITESPACE"," ",95],["T_IS_NOT_IDENTICAL","!==",95],["T_WHITESPACE"," ",95],["T_STRING","null",95],["T_WHITESPACE"," ",95],["T_BOOLEAN_AND","&&",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$option",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getOptionId",95],"(",")",["T_WHITESPACE"," ",95],["T_IS_NOT_EQUAL","!=",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$optionId",95],")",")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n                ",95],["T_CONTINUE","continue",96],";",["T_WHITESPACE","\n            ",96],"}",["T_WHITESPACE","\n            ",97],["T_DOC_COMMENT","\/** @var \\Magento\\Catalog\\Model\\Product $selection *\/",98],["T_WHITESPACE","\n            ",98],["T_FOREACH","foreach",99],["T_WHITESPACE"," ",99],"(",["T_VARIABLE","$option",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","getSelections",99],"(",")",["T_WHITESPACE"," ",99],["T_AS","as",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$selection",99],")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n                ",99],["T_VARIABLE","$childrenList",100],"[","]",["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","buildLink",100],"(",["T_VARIABLE","$selection",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$product",100],")",";",["T_WHITESPACE","\n            ",100],"}",["T_WHITESPACE","\n        ",101],"}",["T_WHITESPACE","\n        ",102],["T_RETURN","return",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$childrenList",103],";",["T_WHITESPACE","\n    ",103],"}",["T_WHITESPACE","\n\n    ",104],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",106],["T_WHITESPACE","\n    ",108],["T_PUBLIC","public",109],["T_WHITESPACE"," ",109],["T_FUNCTION","function",109],["T_WHITESPACE"," ",109],["T_STRING","addChildByProductSku",109],"(",["T_VARIABLE","$sku",109],",",["T_WHITESPACE"," ",109],["T_VARIABLE","$optionId",109],",",["T_WHITESPACE"," ",109],["T_NS_SEPARATOR","\\",109],["T_STRING","Magento",109],["T_NS_SEPARATOR","\\",109],["T_STRING","Bundle",109],["T_NS_SEPARATOR","\\",109],["T_STRING","Api",109],["T_NS_SEPARATOR","\\",109],["T_STRING","Data",109],["T_NS_SEPARATOR","\\",109],["T_STRING","LinkInterface",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$linkedProduct",109],")",["T_WHITESPACE","\n    ",109],"{",["T_WHITESPACE","\n        ",110],["T_DOC_COMMENT","\/** @var \\Magento\\Catalog\\Model\\Product $product *\/",111],["T_WHITESPACE","\n        ",111],["T_VARIABLE","$product",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_VARIABLE","$this",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","productRepository",112],["T_OBJECT_OPERATOR","->",112],["T_STRING","get",112],"(",["T_VARIABLE","$sku",112],",",["T_WHITESPACE"," ",112],["T_STRING","true",112],")",";",["T_WHITESPACE","\n        ",112],["T_RETURN","return",113],["T_WHITESPACE"," ",113],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","addChild",113],"(",["T_VARIABLE","$product",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$optionId",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$linkedProduct",113],")",";",["T_WHITESPACE","\n    ",113],"}",["T_WHITESPACE","\n\n    ",114],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     * @SuppressWarnings(PHPMD.NPathComplexity)\n     *\/",116],["T_WHITESPACE","\n    ",120],["T_PUBLIC","public",121],["T_WHITESPACE"," ",121],["T_FUNCTION","function",121],["T_WHITESPACE"," ",121],["T_STRING","saveChild",121],"(",["T_WHITESPACE","\n        ",121],["T_VARIABLE","$sku",122],",",["T_WHITESPACE","\n        ",122],["T_NS_SEPARATOR","\\",123],["T_STRING","Magento",123],["T_NS_SEPARATOR","\\",123],["T_STRING","Bundle",123],["T_NS_SEPARATOR","\\",123],["T_STRING","Api",123],["T_NS_SEPARATOR","\\",123],["T_STRING","Data",123],["T_NS_SEPARATOR","\\",123],["T_STRING","LinkInterface",123],["T_WHITESPACE"," ",123],["T_VARIABLE","$linkedProduct",123],["T_WHITESPACE","\n    ",123],")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n        ",124],["T_VARIABLE","$product",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","productRepository",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","get",125],"(",["T_VARIABLE","$sku",125],",",["T_WHITESPACE"," ",125],["T_STRING","true",125],")",";",["T_WHITESPACE","\n        ",125],["T_IF","if",126],["T_WHITESPACE"," ",126],"(",["T_VARIABLE","$product",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getTypeId",126],"(",")",["T_WHITESPACE"," ",126],["T_IS_NOT_EQUAL","!=",126],["T_WHITESPACE"," ",126],["T_NS_SEPARATOR","\\",126],["T_STRING","Magento",126],["T_NS_SEPARATOR","\\",126],["T_STRING","Catalog",126],["T_NS_SEPARATOR","\\",126],["T_STRING","Model",126],["T_NS_SEPARATOR","\\",126],["T_STRING","Product",126],["T_NS_SEPARATOR","\\",126],["T_STRING","Type",126],["T_DOUBLE_COLON","::",126],["T_STRING","TYPE_BUNDLE",126],")",["T_WHITESPACE"," ",126],"{",["T_WHITESPACE","\n            ",126],["T_THROW","throw",127],["T_WHITESPACE"," ",127],["T_NEW","new",127],["T_WHITESPACE"," ",127],["T_STRING","InputException",127],"(",["T_WHITESPACE","\n                ",127],["T_STRING","__",128],"(",["T_CONSTANT_ENCAPSED_STRING","'Product with specified sku: \"%1\" is not a bundle product'",128],",",["T_WHITESPACE"," ",128],"[",["T_VARIABLE","$product",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","getSku",128],"(",")","]",")",["T_WHITESPACE","\n            ",128],")",";",["T_WHITESPACE","\n        ",129],"}",["T_WHITESPACE","\n\n        ",130],["T_DOC_COMMENT","\/** @var \\Magento\\Catalog\\Model\\Product $linkProductModel *\/",132],["T_WHITESPACE","\n        ",132],["T_VARIABLE","$linkProductModel",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_VARIABLE","$this",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","productRepository",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","get",133],"(",["T_VARIABLE","$linkedProduct",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","getSku",133],"(",")",")",";",["T_WHITESPACE","\n        ",133],["T_IF","if",134],["T_WHITESPACE"," ",134],"(",["T_VARIABLE","$linkProductModel",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","isComposite",134],"(",")",")",["T_WHITESPACE"," ",134],"{",["T_WHITESPACE","\n            ",134],["T_THROW","throw",135],["T_WHITESPACE"," ",135],["T_NEW","new",135],["T_WHITESPACE"," ",135],["T_STRING","InputException",135],"(",["T_STRING","__",135],"(",["T_CONSTANT_ENCAPSED_STRING","'Bundle product could not contain another composite product'",135],")",")",";",["T_WHITESPACE","\n        ",135],"}",["T_WHITESPACE","\n\n        ",136],["T_IF","if",138],["T_WHITESPACE"," ",138],"(","!",["T_VARIABLE","$linkedProduct",138],["T_OBJECT_OPERATOR","->",138],["T_STRING","getId",138],"(",")",")",["T_WHITESPACE"," ",138],"{",["T_WHITESPACE","\n            ",138],["T_THROW","throw",139],["T_WHITESPACE"," ",139],["T_NEW","new",139],["T_WHITESPACE"," ",139],["T_STRING","InputException",139],"(",["T_STRING","__",139],"(",["T_CONSTANT_ENCAPSED_STRING","'Id field of product link is required'",139],")",")",";",["T_WHITESPACE","\n        ",139],"}",["T_WHITESPACE","\n\n        ",140],["T_DOC_COMMENT","\/** @var \\Magento\\Bundle\\Model\\Selection $selectionModel *\/",142],["T_WHITESPACE","\n        ",142],["T_VARIABLE","$selectionModel",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","bundleSelection",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","create",143],"(",")",";",["T_WHITESPACE","\n        ",143],["T_VARIABLE","$selectionModel",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","load",144],"(",["T_VARIABLE","$linkedProduct",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","getId",144],"(",")",")",";",["T_WHITESPACE","\n        ",144],["T_IF","if",145],["T_WHITESPACE"," ",145],"(","!",["T_VARIABLE","$selectionModel",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getId",145],"(",")",")",["T_WHITESPACE"," ",145],"{",["T_WHITESPACE","\n            ",145],["T_THROW","throw",146],["T_WHITESPACE"," ",146],["T_NEW","new",146],["T_WHITESPACE"," ",146],["T_STRING","InputException",146],"(",["T_STRING","__",146],"(",["T_CONSTANT_ENCAPSED_STRING","'Can not find product link with id \"%1\"'",146],",",["T_WHITESPACE"," ",146],"[",["T_VARIABLE","$linkedProduct",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","getId",146],"(",")","]",")",")",";",["T_WHITESPACE","\n        ",146],"}",["T_WHITESPACE","\n        ",147],["T_VARIABLE","$linkField",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","getMetadataPool",148],"(",")",["T_OBJECT_OPERATOR","->",148],["T_STRING","getMetadata",148],"(",["T_STRING","ProductInterface",148],["T_DOUBLE_COLON","::",148],["T_CLASS","class",148],")",["T_OBJECT_OPERATOR","->",148],["T_STRING","getLinkField",148],"(",")",";",["T_WHITESPACE","\n        ",148],["T_VARIABLE","$selectionModel",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","mapProductLinkToSelectionModel",149],"(",["T_WHITESPACE","\n            ",149],["T_VARIABLE","$selectionModel",150],",",["T_WHITESPACE","\n            ",150],["T_VARIABLE","$linkedProduct",151],",",["T_WHITESPACE","\n            ",151],["T_VARIABLE","$linkProductModel",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","getId",152],"(",")",",",["T_WHITESPACE","\n            ",152],["T_VARIABLE","$product",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","getData",153],"(",["T_VARIABLE","$linkField",153],")",["T_WHITESPACE","\n        ",153],")",";",["T_WHITESPACE","\n\n        ",154],["T_TRY","try",156],["T_WHITESPACE"," ",156],"{",["T_WHITESPACE","\n            ",156],["T_VARIABLE","$selectionModel",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","save",157],"(",")",";",["T_WHITESPACE","\n        ",157],"}",["T_WHITESPACE"," ",158],["T_CATCH","catch",158],["T_WHITESPACE"," ",158],"(",["T_NS_SEPARATOR","\\",158],["T_STRING","Exception",158],["T_WHITESPACE"," ",158],["T_VARIABLE","$e",158],")",["T_WHITESPACE"," ",158],"{",["T_WHITESPACE","\n            ",158],["T_THROW","throw",159],["T_WHITESPACE"," ",159],["T_NEW","new",159],["T_WHITESPACE"," ",159],["T_STRING","CouldNotSaveException",159],"(",["T_STRING","__",159],"(",["T_CONSTANT_ENCAPSED_STRING","'Could not save child: \"%1\"'",159],",",["T_WHITESPACE"," ",159],["T_VARIABLE","$e",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","getMessage",159],"(",")",")",",",["T_WHITESPACE"," ",159],["T_VARIABLE","$e",159],")",";",["T_WHITESPACE","\n        ",159],"}",["T_WHITESPACE","\n\n        ",160],["T_RETURN","return",162],["T_WHITESPACE"," ",162],["T_STRING","true",162],";",["T_WHITESPACE","\n    ",162],"}",["T_WHITESPACE","\n\n    ",163],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Bundle\\Model\\Selection $selectionModel\n     * @param \\Magento\\Bundle\\Api\\Data\\LinkInterface $productLink\n     * @param string $linkedProductId\n     * @param string $parentProductId\n     * @return \\Magento\\Bundle\\Model\\Selection\n     *\/",165],["T_WHITESPACE","\n    ",171],["T_PROTECTED","protected",172],["T_WHITESPACE"," ",172],["T_FUNCTION","function",172],["T_WHITESPACE"," ",172],["T_STRING","mapProductLinkToSelectionModel",172],"(",["T_WHITESPACE","\n        ",172],["T_NS_SEPARATOR","\\",173],["T_STRING","Magento",173],["T_NS_SEPARATOR","\\",173],["T_STRING","Bundle",173],["T_NS_SEPARATOR","\\",173],["T_STRING","Model",173],["T_NS_SEPARATOR","\\",173],["T_STRING","Selection",173],["T_WHITESPACE"," ",173],["T_VARIABLE","$selectionModel",173],",",["T_WHITESPACE","\n        ",173],["T_NS_SEPARATOR","\\",174],["T_STRING","Magento",174],["T_NS_SEPARATOR","\\",174],["T_STRING","Bundle",174],["T_NS_SEPARATOR","\\",174],["T_STRING","Api",174],["T_NS_SEPARATOR","\\",174],["T_STRING","Data",174],["T_NS_SEPARATOR","\\",174],["T_STRING","LinkInterface",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$productLink",174],",",["T_WHITESPACE","\n        ",174],["T_VARIABLE","$linkedProductId",175],",",["T_WHITESPACE","\n        ",175],["T_VARIABLE","$parentProductId",176],["T_WHITESPACE","\n    ",176],")",["T_WHITESPACE"," ",177],"{",["T_WHITESPACE","\n        ",177],["T_VARIABLE","$selectionModel",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","setProductId",178],"(",["T_VARIABLE","$linkedProductId",178],")",";",["T_WHITESPACE","\n        ",178],["T_VARIABLE","$selectionModel",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","setParentProductId",179],"(",["T_VARIABLE","$parentProductId",179],")",";",["T_WHITESPACE","\n        ",179],["T_IF","if",180],["T_WHITESPACE"," ",180],"(","(",["T_VARIABLE","$productLink",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","getOptionId",180],"(",")",["T_WHITESPACE"," ",180],["T_IS_NOT_IDENTICAL","!==",180],["T_WHITESPACE"," ",180],["T_STRING","null",180],")",")",["T_WHITESPACE"," ",180],"{",["T_WHITESPACE","\n            ",180],["T_VARIABLE","$selectionModel",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","setOptionId",181],"(",["T_VARIABLE","$productLink",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","getOptionId",181],"(",")",")",";",["T_WHITESPACE","\n        ",181],"}",["T_WHITESPACE","\n        ",182],["T_IF","if",183],["T_WHITESPACE"," ",183],"(",["T_VARIABLE","$productLink",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","getPosition",183],"(",")",["T_WHITESPACE"," ",183],["T_IS_NOT_IDENTICAL","!==",183],["T_WHITESPACE"," ",183],["T_STRING","null",183],")",["T_WHITESPACE"," ",183],"{",["T_WHITESPACE","\n            ",183],["T_VARIABLE","$selectionModel",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","setPosition",184],"(",["T_VARIABLE","$productLink",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","getPosition",184],"(",")",")",";",["T_WHITESPACE","\n        ",184],"}",["T_WHITESPACE","\n        ",185],["T_IF","if",186],["T_WHITESPACE"," ",186],"(",["T_VARIABLE","$productLink",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","getQty",186],"(",")",["T_WHITESPACE"," ",186],["T_IS_NOT_IDENTICAL","!==",186],["T_WHITESPACE"," ",186],["T_STRING","null",186],")",["T_WHITESPACE"," ",186],"{",["T_WHITESPACE","\n            ",186],["T_VARIABLE","$selectionModel",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","setSelectionQty",187],"(",["T_VARIABLE","$productLink",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","getQty",187],"(",")",")",";",["T_WHITESPACE","\n        ",187],"}",["T_WHITESPACE","\n        ",188],["T_IF","if",189],["T_WHITESPACE"," ",189],"(",["T_VARIABLE","$productLink",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getPriceType",189],"(",")",["T_WHITESPACE"," ",189],["T_IS_NOT_IDENTICAL","!==",189],["T_WHITESPACE"," ",189],["T_STRING","null",189],")",["T_WHITESPACE"," ",189],"{",["T_WHITESPACE","\n            ",189],["T_VARIABLE","$selectionModel",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","setSelectionPriceType",190],"(",["T_VARIABLE","$productLink",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","getPriceType",190],"(",")",")",";",["T_WHITESPACE","\n        ",190],"}",["T_WHITESPACE","\n        ",191],["T_IF","if",192],["T_WHITESPACE"," ",192],"(",["T_VARIABLE","$productLink",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","getPrice",192],"(",")",["T_WHITESPACE"," ",192],["T_IS_NOT_IDENTICAL","!==",192],["T_WHITESPACE"," ",192],["T_STRING","null",192],")",["T_WHITESPACE"," ",192],"{",["T_WHITESPACE","\n            ",192],["T_VARIABLE","$selectionModel",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","setSelectionPriceValue",193],"(",["T_VARIABLE","$productLink",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","getPrice",193],"(",")",")",";",["T_WHITESPACE","\n        ",193],"}",["T_WHITESPACE","\n        ",194],["T_IF","if",195],["T_WHITESPACE"," ",195],"(",["T_VARIABLE","$productLink",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","getCanChangeQuantity",195],"(",")",["T_WHITESPACE"," ",195],["T_IS_NOT_IDENTICAL","!==",195],["T_WHITESPACE"," ",195],["T_STRING","null",195],")",["T_WHITESPACE"," ",195],"{",["T_WHITESPACE","\n            ",195],["T_VARIABLE","$selectionModel",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","setSelectionCanChangeQty",196],"(",["T_VARIABLE","$productLink",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","getCanChangeQuantity",196],"(",")",")",";",["T_WHITESPACE","\n        ",196],"}",["T_WHITESPACE","\n        ",197],["T_IF","if",198],["T_WHITESPACE"," ",198],"(",["T_VARIABLE","$productLink",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","getIsDefault",198],"(",")",["T_WHITESPACE"," ",198],["T_IS_NOT_IDENTICAL","!==",198],["T_WHITESPACE"," ",198],["T_STRING","null",198],")",["T_WHITESPACE"," ",198],"{",["T_WHITESPACE","\n            ",198],["T_VARIABLE","$selectionModel",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","setIsDefault",199],"(",["T_VARIABLE","$productLink",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","getIsDefault",199],"(",")",")",";",["T_WHITESPACE","\n        ",199],"}",["T_WHITESPACE","\n\n        ",200],["T_RETURN","return",202],["T_WHITESPACE"," ",202],["T_VARIABLE","$selectionModel",202],";",["T_WHITESPACE","\n    ",202],"}",["T_WHITESPACE","\n\n    ",203],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     *\/",205],["T_WHITESPACE","\n    ",208],["T_PUBLIC","public",209],["T_WHITESPACE"," ",209],["T_FUNCTION","function",209],["T_WHITESPACE"," ",209],["T_STRING","addChild",209],"(",["T_WHITESPACE","\n        ",209],["T_NS_SEPARATOR","\\",210],["T_STRING","Magento",210],["T_NS_SEPARATOR","\\",210],["T_STRING","Catalog",210],["T_NS_SEPARATOR","\\",210],["T_STRING","Api",210],["T_NS_SEPARATOR","\\",210],["T_STRING","Data",210],["T_NS_SEPARATOR","\\",210],["T_STRING","ProductInterface",210],["T_WHITESPACE"," ",210],["T_VARIABLE","$product",210],",",["T_WHITESPACE","\n        ",210],["T_VARIABLE","$optionId",211],",",["T_WHITESPACE","\n        ",211],["T_NS_SEPARATOR","\\",212],["T_STRING","Magento",212],["T_NS_SEPARATOR","\\",212],["T_STRING","Bundle",212],["T_NS_SEPARATOR","\\",212],["T_STRING","Api",212],["T_NS_SEPARATOR","\\",212],["T_STRING","Data",212],["T_NS_SEPARATOR","\\",212],["T_STRING","LinkInterface",212],["T_WHITESPACE"," ",212],["T_VARIABLE","$linkedProduct",212],["T_WHITESPACE","\n    ",212],")",["T_WHITESPACE"," ",213],"{",["T_WHITESPACE","\n        ",213],["T_IF","if",214],["T_WHITESPACE"," ",214],"(",["T_VARIABLE","$product",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","getTypeId",214],"(",")",["T_WHITESPACE"," ",214],["T_IS_NOT_EQUAL","!=",214],["T_WHITESPACE"," ",214],["T_NS_SEPARATOR","\\",214],["T_STRING","Magento",214],["T_NS_SEPARATOR","\\",214],["T_STRING","Catalog",214],["T_NS_SEPARATOR","\\",214],["T_STRING","Model",214],["T_NS_SEPARATOR","\\",214],["T_STRING","Product",214],["T_NS_SEPARATOR","\\",214],["T_STRING","Type",214],["T_DOUBLE_COLON","::",214],["T_STRING","TYPE_BUNDLE",214],")",["T_WHITESPACE"," ",214],"{",["T_WHITESPACE","\n            ",214],["T_THROW","throw",215],["T_WHITESPACE"," ",215],["T_NEW","new",215],["T_WHITESPACE"," ",215],["T_STRING","InputException",215],"(",["T_WHITESPACE","\n                ",215],["T_STRING","__",216],"(",["T_CONSTANT_ENCAPSED_STRING","'Product with specified sku: \"%1\" is not a bundle product'",216],",",["T_WHITESPACE"," ",216],["T_VARIABLE","$product",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","getSku",216],"(",")",")",["T_WHITESPACE","\n            ",216],")",";",["T_WHITESPACE","\n        ",217],"}",["T_WHITESPACE","\n\n        ",218],["T_VARIABLE","$options",220],["T_WHITESPACE"," ",220],"=",["T_WHITESPACE"," ",220],["T_VARIABLE","$this",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","optionCollection",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","create",220],"(",")",";",["T_WHITESPACE","\n        ",220],["T_VARIABLE","$options",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","setIdFilter",221],"(",["T_VARIABLE","$optionId",221],")",";",["T_WHITESPACE","\n        ",221],["T_VARIABLE","$existingOption",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_VARIABLE","$options",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","getFirstItem",222],"(",")",";",["T_WHITESPACE","\n\n        ",222],["T_IF","if",224],["T_WHITESPACE"," ",224],"(","!",["T_VARIABLE","$existingOption",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","getId",224],"(",")",")",["T_WHITESPACE"," ",224],"{",["T_WHITESPACE","\n            ",224],["T_THROW","throw",225],["T_WHITESPACE"," ",225],["T_NEW","new",225],["T_WHITESPACE"," ",225],["T_STRING","InputException",225],"(",["T_WHITESPACE","\n                ",225],["T_STRING","__",226],"(",["T_WHITESPACE","\n                    ",226],["T_CONSTANT_ENCAPSED_STRING","'Product with specified sku: \"%1\" does not contain option: \"%2\"'",227],",",["T_WHITESPACE","\n                    ",227],"[",["T_VARIABLE","$product",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getSku",228],"(",")",",",["T_WHITESPACE"," ",228],["T_VARIABLE","$optionId",228],"]",["T_WHITESPACE","\n                ",228],")",["T_WHITESPACE","\n            ",229],")",";",["T_WHITESPACE","\n        ",230],"}",["T_WHITESPACE","\n\n        ",231],["T_VARIABLE","$linkField",233],["T_WHITESPACE"," ",233],"=",["T_WHITESPACE"," ",233],["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","getMetadataPool",233],"(",")",["T_OBJECT_OPERATOR","->",233],["T_STRING","getMetadata",233],"(",["T_STRING","ProductInterface",233],["T_DOUBLE_COLON","::",233],["T_CLASS","class",233],")",["T_OBJECT_OPERATOR","->",233],["T_STRING","getLinkField",233],"(",")",";",["T_WHITESPACE","\n        ",233],["T_COMMENT","\/* @var $resource \\Magento\\Bundle\\Model\\ResourceModel\\Bundle *\/",234],["T_WHITESPACE","\n        ",234],["T_VARIABLE","$resource",235],["T_WHITESPACE"," ",235],"=",["T_WHITESPACE"," ",235],["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","bundleFactory",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","create",235],"(",")",";",["T_WHITESPACE","\n        ",235],["T_VARIABLE","$selections",236],["T_WHITESPACE"," ",236],"=",["T_WHITESPACE"," ",236],["T_VARIABLE","$resource",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","getSelectionsData",236],"(",["T_VARIABLE","$product",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","getData",236],"(",["T_VARIABLE","$linkField",236],")",")",";",["T_WHITESPACE","\n        ",236],["T_DOC_COMMENT","\/** @var \\Magento\\Catalog\\Model\\Product $linkProductModel *\/",237],["T_WHITESPACE","\n        ",237],["T_VARIABLE","$linkProductModel",238],["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","productRepository",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","get",238],"(",["T_VARIABLE","$linkedProduct",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","getSku",238],"(",")",")",";",["T_WHITESPACE","\n        ",238],["T_IF","if",239],["T_WHITESPACE"," ",239],"(",["T_VARIABLE","$linkProductModel",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","isComposite",239],"(",")",")",["T_WHITESPACE"," ",239],"{",["T_WHITESPACE","\n            ",239],["T_THROW","throw",240],["T_WHITESPACE"," ",240],["T_NEW","new",240],["T_WHITESPACE"," ",240],["T_STRING","InputException",240],"(",["T_STRING","__",240],"(",["T_CONSTANT_ENCAPSED_STRING","'Bundle product could not contain another composite product'",240],")",")",";",["T_WHITESPACE","\n        ",240],"}",["T_WHITESPACE","\n\n        ",241],["T_IF","if",243],["T_WHITESPACE"," ",243],"(",["T_VARIABLE","$selections",243],")",["T_WHITESPACE"," ",243],"{",["T_WHITESPACE","\n            ",243],["T_FOREACH","foreach",244],["T_WHITESPACE"," ",244],"(",["T_VARIABLE","$selections",244],["T_WHITESPACE"," ",244],["T_AS","as",244],["T_WHITESPACE"," ",244],["T_VARIABLE","$selection",244],")",["T_WHITESPACE"," ",244],"{",["T_WHITESPACE","\n                ",244],["T_IF","if",245],["T_WHITESPACE"," ",245],"(",["T_VARIABLE","$selection",245],"[",["T_CONSTANT_ENCAPSED_STRING","'option_id'",245],"]",["T_WHITESPACE"," ",245],["T_IS_EQUAL","==",245],["T_WHITESPACE"," ",245],["T_VARIABLE","$optionId",245],["T_WHITESPACE"," ",245],["T_BOOLEAN_AND","&&",245],["T_WHITESPACE","\n                    ",245],["T_VARIABLE","$selection",246],"[",["T_CONSTANT_ENCAPSED_STRING","'product_id'",246],"]",["T_WHITESPACE"," ",246],["T_IS_EQUAL","==",246],["T_WHITESPACE"," ",246],["T_VARIABLE","$linkProductModel",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","getEntityId",246],"(",")",")",["T_WHITESPACE"," ",246],"{",["T_WHITESPACE","\n                    ",246],["T_IF","if",247],["T_WHITESPACE"," ",247],"(","!",["T_VARIABLE","$product",247],["T_OBJECT_OPERATOR","->",247],["T_STRING","getCopyFromView",247],"(",")",")",["T_WHITESPACE"," ",247],"{",["T_WHITESPACE","\n                        ",247],["T_THROW","throw",248],["T_WHITESPACE"," ",248],["T_NEW","new",248],["T_WHITESPACE"," ",248],["T_STRING","CouldNotSaveException",248],"(",["T_WHITESPACE","\n                            ",248],["T_STRING","__",249],"(",["T_WHITESPACE","\n                                ",249],["T_CONSTANT_ENCAPSED_STRING","'Child with specified sku: \"%1\" already assigned to product: \"%2\"'",250],",",["T_WHITESPACE","\n                                ",250],"[",["T_VARIABLE","$linkedProduct",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","getSku",251],"(",")",",",["T_WHITESPACE"," ",251],["T_VARIABLE","$product",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","getSku",251],"(",")","]",["T_WHITESPACE","\n                            ",251],")",["T_WHITESPACE","\n                        ",252],")",";",["T_WHITESPACE","\n                    ",253],"}",["T_WHITESPACE"," ",254],["T_ELSE","else",254],["T_WHITESPACE"," ",254],"{",["T_WHITESPACE","\n                        ",254],["T_RETURN","return",255],["T_WHITESPACE"," ",255],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","bundleSelection",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","create",255],"(",")",["T_OBJECT_OPERATOR","->",255],["T_STRING","load",255],"(",["T_VARIABLE","$linkProductModel",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","getEntityId",255],"(",")",")",";",["T_WHITESPACE","\n                    ",255],"}",["T_WHITESPACE","\n                ",256],"}",["T_WHITESPACE","\n            ",257],"}",["T_WHITESPACE","\n        ",258],"}",["T_WHITESPACE","\n\n        ",259],["T_VARIABLE","$selectionModel",261],["T_WHITESPACE"," ",261],"=",["T_WHITESPACE"," ",261],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","bundleSelection",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","create",261],"(",")",";",["T_WHITESPACE","\n        ",261],["T_VARIABLE","$selectionModel",262],["T_WHITESPACE"," ",262],"=",["T_WHITESPACE"," ",262],["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","mapProductLinkToSelectionModel",262],"(",["T_WHITESPACE","\n            ",262],["T_VARIABLE","$selectionModel",263],",",["T_WHITESPACE","\n            ",263],["T_VARIABLE","$linkedProduct",264],",",["T_WHITESPACE","\n            ",264],["T_VARIABLE","$linkProductModel",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","getEntityId",265],"(",")",",",["T_WHITESPACE","\n            ",265],["T_VARIABLE","$product",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","getData",266],"(",["T_VARIABLE","$linkField",266],")",["T_WHITESPACE","\n        ",266],")",";",["T_WHITESPACE","\n        ",267],["T_VARIABLE","$selectionModel",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","setOptionId",268],"(",["T_VARIABLE","$optionId",268],")",";",["T_WHITESPACE","\n\n        ",268],["T_TRY","try",270],["T_WHITESPACE"," ",270],"{",["T_WHITESPACE","\n            ",270],["T_VARIABLE","$selectionModel",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","save",271],"(",")",";",["T_WHITESPACE","\n            ",271],["T_VARIABLE","$resource",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","addProductRelation",272],"(",["T_VARIABLE","$product",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","getData",272],"(",["T_VARIABLE","$linkField",272],")",",",["T_WHITESPACE"," ",272],["T_VARIABLE","$linkProductModel",272],["T_OBJECT_OPERATOR","->",272],["T_STRING","getEntityId",272],"(",")",")",";",["T_WHITESPACE","\n        ",272],"}",["T_WHITESPACE"," ",273],["T_CATCH","catch",273],["T_WHITESPACE"," ",273],"(",["T_NS_SEPARATOR","\\",273],["T_STRING","Exception",273],["T_WHITESPACE"," ",273],["T_VARIABLE","$e",273],")",["T_WHITESPACE"," ",273],"{",["T_WHITESPACE","\n            ",273],["T_THROW","throw",274],["T_WHITESPACE"," ",274],["T_NEW","new",274],["T_WHITESPACE"," ",274],["T_STRING","CouldNotSaveException",274],"(",["T_STRING","__",274],"(",["T_CONSTANT_ENCAPSED_STRING","'Could not save child: \"%1\"'",274],",",["T_WHITESPACE"," ",274],["T_VARIABLE","$e",274],["T_OBJECT_OPERATOR","->",274],["T_STRING","getMessage",274],"(",")",")",",",["T_WHITESPACE"," ",274],["T_VARIABLE","$e",274],")",";",["T_WHITESPACE","\n        ",274],"}",["T_WHITESPACE","\n\n        ",275],["T_RETURN","return",277],["T_WHITESPACE"," ",277],["T_VARIABLE","$selectionModel",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","getId",277],"(",")",";",["T_WHITESPACE","\n    ",277],"}",["T_WHITESPACE","\n\n    ",278],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",280],["T_WHITESPACE","\n    ",282],["T_PUBLIC","public",283],["T_WHITESPACE"," ",283],["T_FUNCTION","function",283],["T_WHITESPACE"," ",283],["T_STRING","removeChild",283],"(",["T_VARIABLE","$sku",283],",",["T_WHITESPACE"," ",283],["T_VARIABLE","$optionId",283],",",["T_WHITESPACE"," ",283],["T_VARIABLE","$childSku",283],")",["T_WHITESPACE","\n    ",283],"{",["T_WHITESPACE","\n        ",284],["T_VARIABLE","$product",285],["T_WHITESPACE"," ",285],"=",["T_WHITESPACE"," ",285],["T_VARIABLE","$this",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","productRepository",285],["T_OBJECT_OPERATOR","->",285],["T_STRING","get",285],"(",["T_VARIABLE","$sku",285],",",["T_WHITESPACE"," ",285],["T_STRING","true",285],")",";",["T_WHITESPACE","\n\n        ",285],["T_IF","if",287],["T_WHITESPACE"," ",287],"(",["T_VARIABLE","$product",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","getTypeId",287],"(",")",["T_WHITESPACE"," ",287],["T_IS_NOT_EQUAL","!=",287],["T_WHITESPACE"," ",287],["T_NS_SEPARATOR","\\",287],["T_STRING","Magento",287],["T_NS_SEPARATOR","\\",287],["T_STRING","Catalog",287],["T_NS_SEPARATOR","\\",287],["T_STRING","Model",287],["T_NS_SEPARATOR","\\",287],["T_STRING","Product",287],["T_NS_SEPARATOR","\\",287],["T_STRING","Type",287],["T_DOUBLE_COLON","::",287],["T_STRING","TYPE_BUNDLE",287],")",["T_WHITESPACE"," ",287],"{",["T_WHITESPACE","\n            ",287],["T_THROW","throw",288],["T_WHITESPACE"," ",288],["T_NEW","new",288],["T_WHITESPACE"," ",288],["T_STRING","InputException",288],"(",["T_STRING","__",288],"(",["T_CONSTANT_ENCAPSED_STRING","'Product with specified sku: %1 is not a bundle product'",288],",",["T_WHITESPACE"," ",288],["T_VARIABLE","$sku",288],")",")",";",["T_WHITESPACE","\n        ",288],"}",["T_WHITESPACE","\n\n        ",289],["T_VARIABLE","$excludeSelectionIds",291],["T_WHITESPACE"," ",291],"=",["T_WHITESPACE"," ",291],"[","]",";",["T_WHITESPACE","\n        ",291],["T_VARIABLE","$usedProductIds",292],["T_WHITESPACE"," ",292],"=",["T_WHITESPACE"," ",292],"[","]",";",["T_WHITESPACE","\n        ",292],["T_VARIABLE","$removeSelectionIds",293],["T_WHITESPACE"," ",293],"=",["T_WHITESPACE"," ",293],"[","]",";",["T_WHITESPACE","\n        ",293],["T_FOREACH","foreach",294],["T_WHITESPACE"," ",294],"(",["T_VARIABLE","$this",294],["T_OBJECT_OPERATOR","->",294],["T_STRING","getOptions",294],"(",["T_VARIABLE","$product",294],")",["T_WHITESPACE"," ",294],["T_AS","as",294],["T_WHITESPACE"," ",294],["T_VARIABLE","$option",294],")",["T_WHITESPACE"," ",294],"{",["T_WHITESPACE","\n            ",294],["T_DOC_COMMENT","\/** @var \\Magento\\Bundle\\Model\\Selection $selection *\/",295],["T_WHITESPACE","\n            ",295],["T_FOREACH","foreach",296],["T_WHITESPACE"," ",296],"(",["T_VARIABLE","$option",296],["T_OBJECT_OPERATOR","->",296],["T_STRING","getSelections",296],"(",")",["T_WHITESPACE"," ",296],["T_AS","as",296],["T_WHITESPACE"," ",296],["T_VARIABLE","$selection",296],")",["T_WHITESPACE"," ",296],"{",["T_WHITESPACE","\n                ",296],["T_IF","if",297],["T_WHITESPACE"," ",297],"(","(",["T_STRING","strcasecmp",297],"(",["T_VARIABLE","$selection",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","getSku",297],"(",")",",",["T_WHITESPACE"," ",297],["T_VARIABLE","$childSku",297],")",["T_WHITESPACE"," ",297],["T_IS_EQUAL","==",297],["T_WHITESPACE"," ",297],["T_LNUMBER","0",297],")",["T_WHITESPACE"," ",297],["T_BOOLEAN_AND","&&",297],["T_WHITESPACE"," ",297],"(",["T_VARIABLE","$selection",297],["T_OBJECT_OPERATOR","->",297],["T_STRING","getOptionId",297],"(",")",["T_WHITESPACE"," ",297],["T_IS_EQUAL","==",297],["T_WHITESPACE"," ",297],["T_VARIABLE","$optionId",297],")",")",["T_WHITESPACE"," ",297],"{",["T_WHITESPACE","\n                    ",297],["T_VARIABLE","$removeSelectionIds",298],"[","]",["T_WHITESPACE"," ",298],"=",["T_WHITESPACE"," ",298],["T_VARIABLE","$selection",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","getSelectionId",298],"(",")",";",["T_WHITESPACE","\n                    ",298],["T_VARIABLE","$usedProductIds",299],"[","]",["T_WHITESPACE"," ",299],"=",["T_WHITESPACE"," ",299],["T_VARIABLE","$selection",299],["T_OBJECT_OPERATOR","->",299],["T_STRING","getProductId",299],"(",")",";",["T_WHITESPACE","\n                    ",299],["T_CONTINUE","continue",300],";",["T_WHITESPACE","\n                ",300],"}",["T_WHITESPACE","\n                ",301],["T_VARIABLE","$excludeSelectionIds",302],"[","]",["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],["T_VARIABLE","$selection",302],["T_OBJECT_OPERATOR","->",302],["T_STRING","getSelectionId",302],"(",")",";",["T_WHITESPACE","\n                ",302],["T_VARIABLE","$usedProductIds",303],"[","]",["T_WHITESPACE"," ",303],"=",["T_WHITESPACE"," ",303],["T_VARIABLE","$selection",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","getProductId",303],"(",")",";",["T_WHITESPACE","\n            ",303],"}",["T_WHITESPACE","\n        ",304],"}",["T_WHITESPACE","\n        ",305],["T_IF","if",306],["T_WHITESPACE"," ",306],"(",["T_EMPTY","empty",306],"(",["T_VARIABLE","$removeSelectionIds",306],")",")",["T_WHITESPACE"," ",306],"{",["T_WHITESPACE","\n            ",306],["T_THROW","throw",307],["T_WHITESPACE"," ",307],["T_NEW","new",307],["T_WHITESPACE"," ",307],["T_NS_SEPARATOR","\\",307],["T_STRING","Magento",307],["T_NS_SEPARATOR","\\",307],["T_STRING","Framework",307],["T_NS_SEPARATOR","\\",307],["T_STRING","Exception",307],["T_NS_SEPARATOR","\\",307],["T_STRING","NoSuchEntityException",307],"(",["T_WHITESPACE","\n                ",307],["T_STRING","__",308],"(",["T_CONSTANT_ENCAPSED_STRING","'Requested bundle option product doesn\\'t exist'",308],")",["T_WHITESPACE","\n            ",308],")",";",["T_WHITESPACE","\n        ",309],"}",["T_WHITESPACE","\n        ",310],["T_VARIABLE","$linkField",311],["T_WHITESPACE"," ",311],"=",["T_WHITESPACE"," ",311],["T_VARIABLE","$this",311],["T_OBJECT_OPERATOR","->",311],["T_STRING","getMetadataPool",311],"(",")",["T_OBJECT_OPERATOR","->",311],["T_STRING","getMetadata",311],"(",["T_STRING","ProductInterface",311],["T_DOUBLE_COLON","::",311],["T_CLASS","class",311],")",["T_OBJECT_OPERATOR","->",311],["T_STRING","getLinkField",311],"(",")",";",["T_WHITESPACE","\n        ",311],["T_COMMENT","\/* @var $resource \\Magento\\Bundle\\Model\\ResourceModel\\Bundle *\/",312],["T_WHITESPACE","\n        ",312],["T_VARIABLE","$resource",313],["T_WHITESPACE"," ",313],"=",["T_WHITESPACE"," ",313],["T_VARIABLE","$this",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","bundleFactory",313],["T_OBJECT_OPERATOR","->",313],["T_STRING","create",313],"(",")",";",["T_WHITESPACE","\n        ",313],["T_VARIABLE","$resource",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","dropAllUnneededSelections",314],"(",["T_VARIABLE","$product",314],["T_OBJECT_OPERATOR","->",314],["T_STRING","getData",314],"(",["T_VARIABLE","$linkField",314],")",",",["T_WHITESPACE"," ",314],["T_VARIABLE","$excludeSelectionIds",314],")",";",["T_WHITESPACE","\n        ",314],["T_VARIABLE","$resource",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","removeProductRelations",315],"(",["T_VARIABLE","$product",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","getData",315],"(",["T_VARIABLE","$linkField",315],")",",",["T_WHITESPACE"," ",315],["T_STRING","array_unique",315],"(",["T_VARIABLE","$usedProductIds",315],")",")",";",["T_WHITESPACE","\n\n        ",315],["T_RETURN","return",317],["T_WHITESPACE"," ",317],["T_STRING","true",317],";",["T_WHITESPACE","\n    ",317],"}",["T_WHITESPACE","\n\n    ",318],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Catalog\\Model\\Product $selection\n     * @param \\Magento\\Catalog\\Model\\Product $product\n     * @return \\Magento\\Bundle\\Api\\Data\\LinkInterface\n     *\/",320],["T_WHITESPACE","\n    ",324],["T_PRIVATE","private",325],["T_WHITESPACE"," ",325],["T_FUNCTION","function",325],["T_WHITESPACE"," ",325],["T_STRING","buildLink",325],"(",["T_NS_SEPARATOR","\\",325],["T_STRING","Magento",325],["T_NS_SEPARATOR","\\",325],["T_STRING","Catalog",325],["T_NS_SEPARATOR","\\",325],["T_STRING","Model",325],["T_NS_SEPARATOR","\\",325],["T_STRING","Product",325],["T_WHITESPACE"," ",325],["T_VARIABLE","$selection",325],",",["T_WHITESPACE"," ",325],["T_NS_SEPARATOR","\\",325],["T_STRING","Magento",325],["T_NS_SEPARATOR","\\",325],["T_STRING","Catalog",325],["T_NS_SEPARATOR","\\",325],["T_STRING","Model",325],["T_NS_SEPARATOR","\\",325],["T_STRING","Product",325],["T_WHITESPACE"," ",325],["T_VARIABLE","$product",325],")",["T_WHITESPACE","\n    ",325],"{",["T_WHITESPACE","\n        ",326],["T_VARIABLE","$selectionPriceType",327],["T_WHITESPACE"," ",327],"=",["T_WHITESPACE"," ",327],["T_VARIABLE","$selectionPrice",327],["T_WHITESPACE"," ",327],"=",["T_WHITESPACE"," ",327],["T_STRING","null",327],";",["T_WHITESPACE","\n\n        ",327],["T_DOC_COMMENT","\/** @var \\Magento\\Bundle\\Model\\Selection $product *\/",329],["T_WHITESPACE","\n        ",329],["T_IF","if",330],["T_WHITESPACE"," ",330],"(",["T_VARIABLE","$product",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","getPriceType",330],"(",")",")",["T_WHITESPACE"," ",330],"{",["T_WHITESPACE","\n            ",330],["T_VARIABLE","$selectionPriceType",331],["T_WHITESPACE"," ",331],"=",["T_WHITESPACE"," ",331],["T_VARIABLE","$selection",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","getSelectionPriceType",331],"(",")",";",["T_WHITESPACE","\n            ",331],["T_VARIABLE","$selectionPrice",332],["T_WHITESPACE"," ",332],"=",["T_WHITESPACE"," ",332],["T_VARIABLE","$selection",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","getSelectionPriceValue",332],"(",")",";",["T_WHITESPACE","\n        ",332],"}",["T_WHITESPACE","\n\n        ",333],["T_DOC_COMMENT","\/** @var \\Magento\\Bundle\\Api\\Data\\LinkInterface $link *\/",335],["T_WHITESPACE","\n        ",335],["T_VARIABLE","$link",336],["T_WHITESPACE"," ",336],"=",["T_WHITESPACE"," ",336],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","linkFactory",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","create",336],"(",")",";",["T_WHITESPACE","\n        ",336],["T_VARIABLE","$this",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","dataObjectHelper",337],["T_OBJECT_OPERATOR","->",337],["T_STRING","populateWithArray",337],"(",["T_WHITESPACE","\n            ",337],["T_VARIABLE","$link",338],",",["T_WHITESPACE","\n            ",338],["T_VARIABLE","$selection",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","getData",339],"(",")",",",["T_WHITESPACE","\n            ",339],["T_NS_SEPARATOR","\\",340],["T_STRING","Magento",340],["T_NS_SEPARATOR","\\",340],["T_STRING","Bundle",340],["T_NS_SEPARATOR","\\",340],["T_STRING","Api",340],["T_NS_SEPARATOR","\\",340],["T_STRING","Data",340],["T_NS_SEPARATOR","\\",340],["T_STRING","LinkInterface",340],["T_DOUBLE_COLON","::",340],["T_CLASS","class",340],["T_WHITESPACE","\n        ",340],")",";",["T_WHITESPACE","\n        ",341],["T_VARIABLE","$link",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","setIsDefault",342],"(",["T_VARIABLE","$selection",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","getIsDefault",342],"(",")",")",["T_WHITESPACE","\n            ",342],["T_OBJECT_OPERATOR","->",343],["T_STRING","setId",343],"(",["T_VARIABLE","$selection",343],["T_OBJECT_OPERATOR","->",343],["T_STRING","getSelectionId",343],"(",")",")",["T_WHITESPACE","\n            ",343],["T_OBJECT_OPERATOR","->",344],["T_STRING","setQty",344],"(",["T_VARIABLE","$selection",344],["T_OBJECT_OPERATOR","->",344],["T_STRING","getSelectionQty",344],"(",")",")",["T_WHITESPACE","\n            ",344],["T_OBJECT_OPERATOR","->",345],["T_STRING","setCanChangeQuantity",345],"(",["T_VARIABLE","$selection",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","getSelectionCanChangeQty",345],"(",")",")",["T_WHITESPACE","\n            ",345],["T_OBJECT_OPERATOR","->",346],["T_STRING","setPrice",346],"(",["T_VARIABLE","$selectionPrice",346],")",["T_WHITESPACE","\n            ",346],["T_OBJECT_OPERATOR","->",347],["T_STRING","setPriceType",347],"(",["T_VARIABLE","$selectionPriceType",347],")",";",["T_WHITESPACE","\n        ",347],["T_RETURN","return",348],["T_WHITESPACE"," ",348],["T_VARIABLE","$link",348],";",["T_WHITESPACE","\n    ",348],"}",["T_WHITESPACE","\n\n    ",349],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Catalog\\Api\\Data\\ProductInterface $product\n     * @return \\Magento\\Bundle\\Api\\Data\\OptionInterface[]\n     *\/",351],["T_WHITESPACE","\n    ",354],["T_PRIVATE","private",355],["T_WHITESPACE"," ",355],["T_FUNCTION","function",355],["T_WHITESPACE"," ",355],["T_STRING","getOptions",355],"(",["T_NS_SEPARATOR","\\",355],["T_STRING","Magento",355],["T_NS_SEPARATOR","\\",355],["T_STRING","Catalog",355],["T_NS_SEPARATOR","\\",355],["T_STRING","Api",355],["T_NS_SEPARATOR","\\",355],["T_STRING","Data",355],["T_NS_SEPARATOR","\\",355],["T_STRING","ProductInterface",355],["T_WHITESPACE"," ",355],["T_VARIABLE","$product",355],")",["T_WHITESPACE","\n    ",355],"{",["T_WHITESPACE","\n        ",356],["T_DOC_COMMENT","\/** @var \\Magento\\Bundle\\Model\\Product\\Type $productTypeInstance *\/",357],["T_WHITESPACE","\n        ",357],["T_VARIABLE","$productTypeInstance",358],["T_WHITESPACE"," ",358],"=",["T_WHITESPACE"," ",358],["T_VARIABLE","$product",358],["T_OBJECT_OPERATOR","->",358],["T_STRING","getTypeInstance",358],"(",")",";",["T_WHITESPACE","\n        ",358],["T_VARIABLE","$productTypeInstance",359],["T_OBJECT_OPERATOR","->",359],["T_STRING","setStoreFilter",359],"(",["T_WHITESPACE","\n            ",359],["T_VARIABLE","$product",360],["T_OBJECT_OPERATOR","->",360],["T_STRING","getStoreId",360],"(",")",",",["T_WHITESPACE","\n            ",360],["T_VARIABLE","$product",361],["T_WHITESPACE","\n        ",361],")",";",["T_WHITESPACE","\n\n        ",362],["T_VARIABLE","$optionCollection",364],["T_WHITESPACE"," ",364],"=",["T_WHITESPACE"," ",364],["T_VARIABLE","$productTypeInstance",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","getOptionsCollection",364],"(",["T_VARIABLE","$product",364],")",";",["T_WHITESPACE","\n\n        ",364],["T_VARIABLE","$selectionCollection",366],["T_WHITESPACE"," ",366],"=",["T_WHITESPACE"," ",366],["T_VARIABLE","$productTypeInstance",366],["T_OBJECT_OPERATOR","->",366],["T_STRING","getSelectionsCollection",366],"(",["T_WHITESPACE","\n            ",366],["T_VARIABLE","$productTypeInstance",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","getOptionsIds",367],"(",["T_VARIABLE","$product",367],")",",",["T_WHITESPACE","\n            ",367],["T_VARIABLE","$product",368],["T_WHITESPACE","\n        ",368],")",";",["T_WHITESPACE","\n\n        ",369],["T_VARIABLE","$options",371],["T_WHITESPACE"," ",371],"=",["T_WHITESPACE"," ",371],["T_VARIABLE","$optionCollection",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","appendSelections",371],"(",["T_VARIABLE","$selectionCollection",371],",",["T_WHITESPACE"," ",371],["T_STRING","true",371],")",";",["T_WHITESPACE","\n        ",371],["T_RETURN","return",372],["T_WHITESPACE"," ",372],["T_VARIABLE","$options",372],";",["T_WHITESPACE","\n    ",372],"}",["T_WHITESPACE","\n\n    ",373],["T_DOC_COMMENT","\/**\n     * Get MetadataPool instance\n     * @return MetadataPool\n     *\/",375],["T_WHITESPACE","\n    ",378],["T_PRIVATE","private",379],["T_WHITESPACE"," ",379],["T_FUNCTION","function",379],["T_WHITESPACE"," ",379],["T_STRING","getMetadataPool",379],"(",")",["T_WHITESPACE","\n    ",379],"{",["T_WHITESPACE","\n        ",380],["T_IF","if",381],["T_WHITESPACE"," ",381],"(","!",["T_VARIABLE","$this",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","metadataPool",381],")",["T_WHITESPACE"," ",381],"{",["T_WHITESPACE","\n            ",381],["T_VARIABLE","$this",382],["T_OBJECT_OPERATOR","->",382],["T_STRING","metadataPool",382],["T_WHITESPACE"," ",382],"=",["T_WHITESPACE"," ",382],["T_STRING","ObjectManager",382],["T_DOUBLE_COLON","::",382],["T_STRING","getInstance",382],"(",")",["T_OBJECT_OPERATOR","->",382],["T_STRING","get",382],"(",["T_STRING","MetadataPool",382],["T_DOUBLE_COLON","::",382],["T_CLASS","class",382],")",";",["T_WHITESPACE","\n        ",382],"}",["T_WHITESPACE","\n        ",383],["T_RETURN","return",384],["T_WHITESPACE"," ",384],["T_VARIABLE","$this",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","metadataPool",384],";",["T_WHITESPACE","\n    ",384],"}",["T_WHITESPACE","\n",385],"}",["T_WHITESPACE","\n",386]]