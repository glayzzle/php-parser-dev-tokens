[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Bundle",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","ResourceModel",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Indexer",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Catalog",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Api",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Data",8],["T_NS_SEPARATOR","\\",8],["T_STRING","ProductInterface",8],";",["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * Bundle Stock Status Indexer Resource Model\n *\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",10],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","Stock",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Magento",15],["T_NS_SEPARATOR","\\",15],["T_STRING","CatalogInventory",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Model",15],["T_NS_SEPARATOR","\\",15],["T_STRING","ResourceModel",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Indexer",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Stock",15],["T_NS_SEPARATOR","\\",15],["T_STRING","DefaultStock",15],["T_WHITESPACE","\n",15],"{",["T_WHITESPACE","\n    ",16],["T_DOC_COMMENT","\/**\n     * Reindex temporary (price result data) for defined product(s)\n     *\n     * @param int|array $entityIds\n     * @return $this\n     *\/",17],["T_WHITESPACE","\n    ",22],["T_PUBLIC","public",23],["T_WHITESPACE"," ",23],["T_FUNCTION","function",23],["T_WHITESPACE"," ",23],["T_STRING","reindexEntity",23],"(",["T_VARIABLE","$entityIds",23],")",["T_WHITESPACE","\n    ",23],"{",["T_WHITESPACE","\n        ",24],["T_VARIABLE","$this",25],["T_OBJECT_OPERATOR","->",25],["T_STRING","_updateIndex",25],"(",["T_VARIABLE","$entityIds",25],")",";",["T_WHITESPACE","\n\n        ",25],["T_RETURN","return",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$this",27],";",["T_WHITESPACE","\n    ",27],"}",["T_WHITESPACE","\n\n    ",28],["T_DOC_COMMENT","\/**\n     * Retrieve table name for temporary bundle option stock index\n     *\n     * @return string\n     *\/",30],["T_WHITESPACE","\n    ",34],["T_PROTECTED","protected",35],["T_WHITESPACE"," ",35],["T_FUNCTION","function",35],["T_WHITESPACE"," ",35],["T_STRING","_getBundleOptionTable",35],"(",")",["T_WHITESPACE","\n    ",35],"{",["T_WHITESPACE","\n        ",36],["T_RETURN","return",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$this",37],["T_OBJECT_OPERATOR","->",37],["T_STRING","getTable",37],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_bundle_stock_index'",37],")",";",["T_WHITESPACE","\n    ",37],"}",["T_WHITESPACE","\n\n    ",38],["T_DOC_COMMENT","\/**\n     * Prepare stock status per Bundle options, website and stock\n     *\n     * @param int|array $entityIds\n     * @param bool $usePrimaryTable use primary or temporary index table\n     * @return $this\n     *\/",40],["T_WHITESPACE","\n    ",46],["T_PROTECTED","protected",47],["T_WHITESPACE"," ",47],["T_FUNCTION","function",47],["T_WHITESPACE"," ",47],["T_STRING","_prepareBundleOptionStockData",47],"(",["T_VARIABLE","$entityIds",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_STRING","null",47],",",["T_WHITESPACE"," ",47],["T_VARIABLE","$usePrimaryTable",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_STRING","false",47],")",["T_WHITESPACE","\n    ",47],"{",["T_WHITESPACE","\n        ",48],["T_VARIABLE","$this",49],["T_OBJECT_OPERATOR","->",49],["T_STRING","_cleanBundleOptionStockData",49],"(",")",";",["T_WHITESPACE","\n        ",49],["T_VARIABLE","$linkField",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","getMetadataPool",50],"(",")",["T_OBJECT_OPERATOR","->",50],["T_STRING","getMetadata",50],"(",["T_STRING","ProductInterface",50],["T_DOUBLE_COLON","::",50],["T_CLASS","class",50],")",["T_OBJECT_OPERATOR","->",50],["T_STRING","getLinkField",50],"(",")",";",["T_WHITESPACE","\n        ",50],["T_VARIABLE","$idxTable",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$usePrimaryTable",51],["T_WHITESPACE"," ",51],"?",["T_WHITESPACE"," ",51],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","getMainTable",51],"(",")",["T_WHITESPACE"," ",51],":",["T_WHITESPACE"," ",51],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","getIdxTable",51],"(",")",";",["T_WHITESPACE","\n        ",51],["T_VARIABLE","$connection",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_VARIABLE","$this",52],["T_OBJECT_OPERATOR","->",52],["T_STRING","getConnection",52],"(",")",";",["T_WHITESPACE","\n        ",52],["T_VARIABLE","$select",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$connection",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","select",53],"(",")",["T_OBJECT_OPERATOR","->",53],["T_STRING","from",53],"(",["T_WHITESPACE","\n            ",53],"[",["T_CONSTANT_ENCAPSED_STRING","'product'",54],["T_WHITESPACE"," ",54],["T_DOUBLE_ARROW","=>",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$this",54],["T_OBJECT_OPERATOR","->",54],["T_STRING","getTable",54],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity'",54],")","]",",",["T_WHITESPACE","\n            ",54],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",55],"]",["T_WHITESPACE","\n        ",55],")",";",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$select",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","join",57],"(",["T_WHITESPACE","\n            ",57],"[",["T_CONSTANT_ENCAPSED_STRING","'bo'",58],["T_WHITESPACE"," ",58],["T_DOUBLE_ARROW","=>",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","getTable",58],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_bundle_option'",58],")","]",",",["T_WHITESPACE","\n            ",58],"\"",["T_ENCAPSED_AND_WHITESPACE","bo.parent_id = product.",59],["T_VARIABLE","$linkField",59],"\"",",",["T_WHITESPACE","\n            ",59],"[","]",["T_WHITESPACE","\n        ",60],")",";",["T_WHITESPACE","\n        ",61],["T_VARIABLE","$status",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_NEW","new",62],["T_WHITESPACE"," ",62],["T_NS_SEPARATOR","\\",62],["T_STRING","Zend_Db_Expr",62],"(",["T_WHITESPACE","\n            ",62],["T_CONSTANT_ENCAPSED_STRING","'MAX('",63],["T_WHITESPACE"," ",63],".",["T_WHITESPACE"," ",63],["T_VARIABLE","$connection",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","getCheckSql",63],"(",["T_CONSTANT_ENCAPSED_STRING","'e.required_options = 0'",63],",",["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","'i.stock_status'",63],",",["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","'0'",63],")",["T_WHITESPACE"," ",63],".",["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","')'",63],["T_WHITESPACE","\n        ",63],")",";",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$select",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","join",65],"(",["T_WHITESPACE","\n            ",65],"[",["T_CONSTANT_ENCAPSED_STRING","'cis'",66],["T_WHITESPACE"," ",66],["T_DOUBLE_ARROW","=>",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","getTable",66],"(",["T_CONSTANT_ENCAPSED_STRING","'cataloginventory_stock'",66],")","]",",",["T_WHITESPACE","\n            ",66],["T_CONSTANT_ENCAPSED_STRING","''",67],",",["T_WHITESPACE","\n            ",67],"[",["T_CONSTANT_ENCAPSED_STRING","'website_id'",68],",",["T_WHITESPACE"," ",68],["T_CONSTANT_ENCAPSED_STRING","'stock_id'",68],"]",["T_WHITESPACE","\n        ",68],")",["T_OBJECT_OPERATOR","->",69],["T_STRING","joinLeft",69],"(",["T_WHITESPACE","\n            ",69],"[",["T_CONSTANT_ENCAPSED_STRING","'bs'",70],["T_WHITESPACE"," ",70],["T_DOUBLE_ARROW","=>",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getTable",70],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_bundle_selection'",70],")","]",",",["T_WHITESPACE","\n            ",70],["T_CONSTANT_ENCAPSED_STRING","'bs.option_id = bo.option_id'",71],",",["T_WHITESPACE","\n            ",71],"[","]",["T_WHITESPACE","\n        ",72],")",["T_OBJECT_OPERATOR","->",73],["T_STRING","joinLeft",73],"(",["T_WHITESPACE","\n            ",73],"[",["T_CONSTANT_ENCAPSED_STRING","'i'",74],["T_WHITESPACE"," ",74],["T_DOUBLE_ARROW","=>",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$idxTable",74],"]",",",["T_WHITESPACE","\n            ",74],["T_CONSTANT_ENCAPSED_STRING","'i.product_id = bs.product_id AND i.website_id = cis.website_id AND i.stock_id = cis.stock_id'",75],",",["T_WHITESPACE","\n            ",75],"[","]",["T_WHITESPACE","\n        ",76],")",["T_OBJECT_OPERATOR","->",77],["T_STRING","joinLeft",77],"(",["T_WHITESPACE","\n            ",77],"[",["T_CONSTANT_ENCAPSED_STRING","'e'",78],["T_WHITESPACE"," ",78],["T_DOUBLE_ARROW","=>",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getTable",78],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity'",78],")","]",",",["T_WHITESPACE","\n            ",78],["T_CONSTANT_ENCAPSED_STRING","'e.entity_id = bs.product_id'",79],",",["T_WHITESPACE","\n            ",79],"[","]",["T_WHITESPACE","\n        ",80],")",["T_OBJECT_OPERATOR","->",81],["T_STRING","group",81],"(",["T_WHITESPACE","\n            ",81],"[",["T_CONSTANT_ENCAPSED_STRING","'product.entity_id'",82],",",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'cis.website_id'",82],",",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'cis.stock_id'",82],",",["T_WHITESPACE"," ",82],["T_CONSTANT_ENCAPSED_STRING","'bo.option_id'",82],"]",["T_WHITESPACE","\n        ",82],")",["T_OBJECT_OPERATOR","->",83],["T_STRING","columns",83],"(",["T_WHITESPACE","\n            ",83],"[",["T_CONSTANT_ENCAPSED_STRING","'option_id'",84],["T_WHITESPACE"," ",84],["T_DOUBLE_ARROW","=>",84],["T_WHITESPACE"," ",84],["T_CONSTANT_ENCAPSED_STRING","'bo.option_id'",84],",",["T_WHITESPACE"," ",84],["T_CONSTANT_ENCAPSED_STRING","'status'",84],["T_WHITESPACE"," ",84],["T_DOUBLE_ARROW","=>",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$status",84],"]",["T_WHITESPACE","\n        ",84],")",";",["T_WHITESPACE","\n\n        ",85],["T_IF","if",87],["T_WHITESPACE"," ",87],"(",["T_VARIABLE","$entityIds",87],["T_WHITESPACE"," ",87],["T_IS_NOT_IDENTICAL","!==",87],["T_WHITESPACE"," ",87],["T_STRING","null",87],")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n            ",87],["T_VARIABLE","$select",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","where",88],"(",["T_CONSTANT_ENCAPSED_STRING","'product.entity_id IN(?)'",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$entityIds",88],")",";",["T_WHITESPACE","\n        ",88],"}",["T_WHITESPACE","\n\n        ",89],["T_COMMENT","\/\/ clone select for bundle product without required bundle options\n",91],["T_WHITESPACE","        ",92],["T_VARIABLE","$selectNonRequired",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_CLONE","clone",92],["T_WHITESPACE"," ",92],["T_VARIABLE","$select",92],";",["T_WHITESPACE","\n\n        ",92],["T_VARIABLE","$select",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","where",94],"(",["T_CONSTANT_ENCAPSED_STRING","'bo.required = ?'",94],",",["T_WHITESPACE"," ",94],["T_LNUMBER","1",94],")",";",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$selectNonRequired",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","where",95],"(",["T_CONSTANT_ENCAPSED_STRING","'bo.required = ?'",95],",",["T_WHITESPACE"," ",95],["T_LNUMBER","0",95],")",["T_OBJECT_OPERATOR","->",95],["T_STRING","having",95],"(",["T_VARIABLE","$status",95],["T_WHITESPACE"," ",95],".",["T_WHITESPACE"," ",95],["T_CONSTANT_ENCAPSED_STRING","' = 1'",95],")",";",["T_WHITESPACE","\n        ",95],["T_VARIABLE","$query",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$select",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","insertFromSelect",96],"(",["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","_getBundleOptionTable",96],"(",")",")",";",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$connection",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","query",97],"(",["T_VARIABLE","$query",97],")",";",["T_WHITESPACE","\n\n        ",97],["T_VARIABLE","$query",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_VARIABLE","$selectNonRequired",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","insertFromSelect",99],"(",["T_VARIABLE","$this",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","_getBundleOptionTable",99],"(",")",")",";",["T_WHITESPACE","\n        ",99],["T_VARIABLE","$connection",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","query",100],"(",["T_VARIABLE","$query",100],")",";",["T_WHITESPACE","\n\n        ",100],["T_RETURN","return",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],";",["T_WHITESPACE","\n    ",102],"}",["T_WHITESPACE","\n\n    ",103],["T_DOC_COMMENT","\/**\n     * Get the select object for get stock status by product ids\n     *\n     * @param int|array $entityIds\n     * @param bool $usePrimaryTable use primary or temporary index table\n     * @return \\Magento\\Framework\\DB\\Select\n     *\/",105],["T_WHITESPACE","\n    ",111],["T_PROTECTED","protected",112],["T_WHITESPACE"," ",112],["T_FUNCTION","function",112],["T_WHITESPACE"," ",112],["T_STRING","_getStockStatusSelect",112],"(",["T_VARIABLE","$entityIds",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_STRING","null",112],",",["T_WHITESPACE"," ",112],["T_VARIABLE","$usePrimaryTable",112],["T_WHITESPACE"," ",112],"=",["T_WHITESPACE"," ",112],["T_STRING","false",112],")",["T_WHITESPACE","\n    ",112],"{",["T_WHITESPACE","\n        ",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","_prepareBundleOptionStockData",114],"(",["T_VARIABLE","$entityIds",114],",",["T_WHITESPACE"," ",114],["T_VARIABLE","$usePrimaryTable",114],")",";",["T_WHITESPACE","\n        ",114],["T_VARIABLE","$connection",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","getConnection",115],"(",")",";",["T_WHITESPACE","\n        ",115],["T_VARIABLE","$select",116],["T_WHITESPACE"," ",116],"=",["T_WHITESPACE"," ",116],["T_STRING","parent",116],["T_DOUBLE_COLON","::",116],["T_STRING","_getStockStatusSelect",116],"(",["T_VARIABLE","$entityIds",116],",",["T_WHITESPACE"," ",116],["T_VARIABLE","$usePrimaryTable",116],")",";",["T_WHITESPACE","\n        ",116],["T_VARIABLE","$select",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","reset",117],"(",["T_WHITESPACE","\n            ",117],["T_NS_SEPARATOR","\\",118],["T_STRING","Magento",118],["T_NS_SEPARATOR","\\",118],["T_STRING","Framework",118],["T_NS_SEPARATOR","\\",118],["T_STRING","DB",118],["T_NS_SEPARATOR","\\",118],["T_STRING","Select",118],["T_DOUBLE_COLON","::",118],["T_STRING","COLUMNS",118],["T_WHITESPACE","\n        ",118],")",["T_OBJECT_OPERATOR","->",119],["T_STRING","columns",119],"(",["T_WHITESPACE","\n            ",119],"[",["T_CONSTANT_ENCAPSED_STRING","'e.entity_id'",120],",",["T_WHITESPACE"," ",120],["T_CONSTANT_ENCAPSED_STRING","'cis.website_id'",120],",",["T_WHITESPACE"," ",120],["T_CONSTANT_ENCAPSED_STRING","'cis.stock_id'",120],"]",["T_WHITESPACE","\n        ",120],")",["T_OBJECT_OPERATOR","->",121],["T_STRING","joinLeft",121],"(",["T_WHITESPACE","\n            ",121],"[",["T_CONSTANT_ENCAPSED_STRING","'o'",122],["T_WHITESPACE"," ",122],["T_DOUBLE_ARROW","=>",122],["T_WHITESPACE"," ",122],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","_getBundleOptionTable",122],"(",")","]",",",["T_WHITESPACE","\n            ",122],["T_CONSTANT_ENCAPSED_STRING","'o.entity_id = e.entity_id AND o.website_id = cis.website_id AND o.stock_id = cis.stock_id'",123],",",["T_WHITESPACE","\n            ",123],"[","]",["T_WHITESPACE","\n        ",124],")",["T_OBJECT_OPERATOR","->",125],["T_STRING","columns",125],"(",["T_WHITESPACE","\n            ",125],"[",["T_CONSTANT_ENCAPSED_STRING","'qty'",126],["T_WHITESPACE"," ",126],["T_DOUBLE_ARROW","=>",126],["T_WHITESPACE"," ",126],["T_NEW","new",126],["T_WHITESPACE"," ",126],["T_NS_SEPARATOR","\\",126],["T_STRING","Zend_Db_Expr",126],"(",["T_CONSTANT_ENCAPSED_STRING","'0'",126],")","]",["T_WHITESPACE","\n        ",126],")",";",["T_WHITESPACE","\n\n        ",127],["T_VARIABLE","$statusExpr",129],["T_WHITESPACE"," ",129],"=",["T_WHITESPACE"," ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","getStatusExpression",129],"(",["T_VARIABLE","$connection",129],")",";",["T_WHITESPACE","\n        ",129],["T_VARIABLE","$select",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","columns",130],"(",["T_WHITESPACE","\n            ",130],"[",["T_WHITESPACE","\n                ",131],["T_CONSTANT_ENCAPSED_STRING","'status'",132],["T_WHITESPACE"," ",132],["T_DOUBLE_ARROW","=>",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$connection",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","getLeastSql",132],"(",["T_WHITESPACE","\n                    ",132],"[",["T_WHITESPACE","\n                        ",133],["T_NEW","new",134],["T_WHITESPACE"," ",134],["T_NS_SEPARATOR","\\",134],["T_STRING","Zend_Db_Expr",134],"(",["T_WHITESPACE","\n                            ",134],["T_CONSTANT_ENCAPSED_STRING","'MIN('",135],["T_WHITESPACE"," ",135],".",["T_WHITESPACE"," ",135],["T_VARIABLE","$connection",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getCheckSql",135],"(",["T_CONSTANT_ENCAPSED_STRING","'o.stock_status IS NOT NULL'",135],",",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","'o.stock_status'",135],",",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","'0'",135],")",["T_WHITESPACE"," ",135],".",["T_WHITESPACE"," ",135],["T_CONSTANT_ENCAPSED_STRING","')'",135],["T_WHITESPACE","\n                        ",135],")",",",["T_WHITESPACE","\n                        ",136],["T_NEW","new",137],["T_WHITESPACE"," ",137],["T_NS_SEPARATOR","\\",137],["T_STRING","Zend_Db_Expr",137],"(",["T_CONSTANT_ENCAPSED_STRING","'MIN('",137],["T_WHITESPACE"," ",137],".",["T_WHITESPACE"," ",137],["T_VARIABLE","$statusExpr",137],["T_WHITESPACE"," ",137],".",["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","')'",137],")",",",["T_WHITESPACE","\n                    ",137],"]",["T_WHITESPACE","\n                ",138],")",",",["T_WHITESPACE","\n            ",139],"]",["T_WHITESPACE","\n        ",140],")",";",["T_WHITESPACE","\n\n        ",141],["T_IF","if",143],["T_WHITESPACE"," ",143],"(",["T_VARIABLE","$entityIds",143],["T_WHITESPACE"," ",143],["T_IS_NOT_IDENTICAL","!==",143],["T_WHITESPACE"," ",143],["T_STRING","null",143],")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n            ",143],["T_VARIABLE","$select",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","where",144],"(",["T_CONSTANT_ENCAPSED_STRING","'e.entity_id IN(?)'",144],",",["T_WHITESPACE"," ",144],["T_VARIABLE","$entityIds",144],")",";",["T_WHITESPACE","\n        ",144],"}",["T_WHITESPACE","\n\n        ",145],["T_RETURN","return",147],["T_WHITESPACE"," ",147],["T_VARIABLE","$select",147],";",["T_WHITESPACE","\n    ",147],"}",["T_WHITESPACE","\n\n    ",148],["T_DOC_COMMENT","\/**\n     * Prepare stock status data in temporary index table\n     *\n     * @param int|array $entityIds  the product limitation\n     * @return $this\n     *\/",150],["T_WHITESPACE","\n    ",155],["T_PROTECTED","protected",156],["T_WHITESPACE"," ",156],["T_FUNCTION","function",156],["T_WHITESPACE"," ",156],["T_STRING","_prepareIndexTable",156],"(",["T_VARIABLE","$entityIds",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_STRING","null",156],")",["T_WHITESPACE","\n    ",156],"{",["T_WHITESPACE","\n        ",157],["T_STRING","parent",158],["T_DOUBLE_COLON","::",158],["T_STRING","_prepareIndexTable",158],"(",["T_VARIABLE","$entityIds",158],")",";",["T_WHITESPACE","\n        ",158],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","_cleanBundleOptionStockData",159],"(",")",";",["T_WHITESPACE","\n\n        ",159],["T_RETURN","return",161],["T_WHITESPACE"," ",161],["T_VARIABLE","$this",161],";",["T_WHITESPACE","\n    ",161],"}",["T_WHITESPACE","\n\n    ",162],["T_DOC_COMMENT","\/**\n     * Update Stock status index by product ids\n     *\n     * @param array|int $entityIds\n     * @return $this\n     *\/",164],["T_WHITESPACE","\n    ",169],["T_PROTECTED","protected",170],["T_WHITESPACE"," ",170],["T_FUNCTION","function",170],["T_WHITESPACE"," ",170],["T_STRING","_updateIndex",170],"(",["T_VARIABLE","$entityIds",170],")",["T_WHITESPACE","\n    ",170],"{",["T_WHITESPACE","\n        ",171],["T_STRING","parent",172],["T_DOUBLE_COLON","::",172],["T_STRING","_updateIndex",172],"(",["T_VARIABLE","$entityIds",172],")",";",["T_WHITESPACE","\n        ",172],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","_cleanBundleOptionStockData",173],"(",")",";",["T_WHITESPACE","\n\n        ",173],["T_RETURN","return",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],";",["T_WHITESPACE","\n    ",175],"}",["T_WHITESPACE","\n\n    ",176],["T_DOC_COMMENT","\/**\n     * Clean temporary bundle options stock data\n     *\n     * @return $this\n     *\/",178],["T_WHITESPACE","\n    ",182],["T_PROTECTED","protected",183],["T_WHITESPACE"," ",183],["T_FUNCTION","function",183],["T_WHITESPACE"," ",183],["T_STRING","_cleanBundleOptionStockData",183],"(",")",["T_WHITESPACE","\n    ",183],"{",["T_WHITESPACE","\n        ",184],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","getConnection",185],"(",")",["T_OBJECT_OPERATOR","->",185],["T_STRING","delete",185],"(",["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","_getBundleOptionTable",185],"(",")",")",";",["T_WHITESPACE","\n        ",185],["T_RETURN","return",186],["T_WHITESPACE"," ",186],["T_VARIABLE","$this",186],";",["T_WHITESPACE","\n    ",186],"}",["T_WHITESPACE","\n",187],"}",["T_WHITESPACE","\n",188]]