[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Integration",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Model",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Customer",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Api",9],["T_NS_SEPARATOR","\\",9],["T_STRING","AccountManagementInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Exception",10],["T_NS_SEPARATOR","\\",10],["T_STRING","LocalizedException",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Integration",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Model",11],["T_NS_SEPARATOR","\\",11],["T_STRING","CredentialsValidator",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Integration",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Model",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Oauth",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Token",12],["T_WHITESPACE"," ",12],["T_AS","as",12],["T_WHITESPACE"," ",12],["T_STRING","Token",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Integration",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Model",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Oauth",13],["T_NS_SEPARATOR","\\",13],["T_STRING","TokenFactory",13],["T_WHITESPACE"," ",13],["T_AS","as",13],["T_WHITESPACE"," ",13],["T_STRING","TokenModelFactory",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Integration",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Model",14],["T_NS_SEPARATOR","\\",14],["T_STRING","ResourceModel",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Oauth",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Token",14],["T_NS_SEPARATOR","\\",14],["T_STRING","CollectionFactory",14],["T_WHITESPACE"," ",14],["T_AS","as",14],["T_WHITESPACE"," ",14],["T_STRING","TokenCollectionFactory",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Magento",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Integration",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Model",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Oauth",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Token",15],["T_NS_SEPARATOR","\\",15],["T_STRING","RequestThrottler",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Magento",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Framework",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Exception",16],["T_NS_SEPARATOR","\\",16],["T_STRING","AuthenticationException",16],";",["T_WHITESPACE","\n\n",16],["T_CLASS","class",18],["T_WHITESPACE"," ",18],["T_STRING","CustomerTokenService",18],["T_WHITESPACE"," ",18],["T_IMPLEMENTS","implements",18],["T_WHITESPACE"," ",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Magento",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Integration",18],["T_NS_SEPARATOR","\\",18],["T_STRING","Api",18],["T_NS_SEPARATOR","\\",18],["T_STRING","CustomerTokenServiceInterface",18],["T_WHITESPACE","\n",18],"{",["T_WHITESPACE","\n    ",19],["T_DOC_COMMENT","\/**\n     * Token Model\n     *\n     * @var TokenModelFactory\n     *\/",20],["T_WHITESPACE","\n    ",24],["T_PRIVATE","private",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$tokenModelFactory",25],";",["T_WHITESPACE","\n\n    ",25],["T_DOC_COMMENT","\/**\n     * Customer Account Service\n     *\n     * @var AccountManagementInterface\n     *\/",27],["T_WHITESPACE","\n    ",31],["T_PRIVATE","private",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$accountManagement",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Integration\\Model\\CredentialsValidator\n     *\/",34],["T_WHITESPACE","\n    ",36],["T_PRIVATE","private",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$validatorHelper",37],";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * Token Collection Factory\n     *\n     * @var TokenCollectionFactory\n     *\/",39],["T_WHITESPACE","\n    ",43],["T_PRIVATE","private",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$tokenModelCollectionFactory",44],";",["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * @var RequestThrottler\n     *\/",46],["T_WHITESPACE","\n    ",48],["T_PRIVATE","private",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$requestThrottler",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Initialize service\n     *\n     * @param TokenModelFactory $tokenModelFactory\n     * @param AccountManagementInterface $accountManagement\n     * @param TokenCollectionFactory $tokenModelCollectionFactory\n     * @param \\Magento\\Integration\\Model\\CredentialsValidator $validatorHelper\n     *\/",51],["T_WHITESPACE","\n    ",58],["T_PUBLIC","public",59],["T_WHITESPACE"," ",59],["T_FUNCTION","function",59],["T_WHITESPACE"," ",59],["T_STRING","__construct",59],"(",["T_WHITESPACE","\n        ",59],["T_STRING","TokenModelFactory",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$tokenModelFactory",60],",",["T_WHITESPACE","\n        ",60],["T_STRING","AccountManagementInterface",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$accountManagement",61],",",["T_WHITESPACE","\n        ",61],["T_STRING","TokenCollectionFactory",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$tokenModelCollectionFactory",62],",",["T_WHITESPACE","\n        ",62],["T_STRING","CredentialsValidator",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$validatorHelper",63],["T_WHITESPACE","\n    ",63],")",["T_WHITESPACE"," ",64],"{",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","tokenModelFactory",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$tokenModelFactory",65],";",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","accountManagement",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$accountManagement",66],";",["T_WHITESPACE","\n        ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","tokenModelCollectionFactory",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$tokenModelCollectionFactory",67],";",["T_WHITESPACE","\n        ",67],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","validatorHelper",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$validatorHelper",68],";",["T_WHITESPACE","\n    ",68],"}",["T_WHITESPACE","\n\n    ",69],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",71],["T_WHITESPACE","\n    ",73],["T_PUBLIC","public",74],["T_WHITESPACE"," ",74],["T_FUNCTION","function",74],["T_WHITESPACE"," ",74],["T_STRING","createCustomerAccessToken",74],"(",["T_VARIABLE","$username",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$password",74],")",["T_WHITESPACE","\n    ",74],"{",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","validatorHelper",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","validate",76],"(",["T_VARIABLE","$username",76],",",["T_WHITESPACE"," ",76],["T_VARIABLE","$password",76],")",";",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getRequestThrottler",77],"(",")",["T_OBJECT_OPERATOR","->",77],["T_STRING","throttle",77],"(",["T_VARIABLE","$username",77],",",["T_WHITESPACE"," ",77],["T_STRING","RequestThrottler",77],["T_DOUBLE_COLON","::",77],["T_STRING","USER_TYPE_CUSTOMER",77],")",";",["T_WHITESPACE","\n        ",77],["T_TRY","try",78],["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n            ",78],["T_VARIABLE","$customerDataObject",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","accountManagement",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","authenticate",79],"(",["T_VARIABLE","$username",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$password",79],")",";",["T_WHITESPACE","\n        ",79],"}",["T_WHITESPACE"," ",80],["T_CATCH","catch",80],["T_WHITESPACE"," ",80],"(",["T_NS_SEPARATOR","\\",80],["T_STRING","Exception",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$e",80],")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n            ",80],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getRequestThrottler",81],"(",")",["T_OBJECT_OPERATOR","->",81],["T_STRING","logAuthenticationFailure",81],"(",["T_VARIABLE","$username",81],",",["T_WHITESPACE"," ",81],["T_STRING","RequestThrottler",81],["T_DOUBLE_COLON","::",81],["T_STRING","USER_TYPE_CUSTOMER",81],")",";",["T_WHITESPACE","\n            ",81],["T_THROW","throw",82],["T_WHITESPACE"," ",82],["T_NEW","new",82],["T_WHITESPACE"," ",82],["T_STRING","AuthenticationException",82],"(",["T_WHITESPACE","\n                ",82],["T_STRING","__",83],"(",["T_CONSTANT_ENCAPSED_STRING","'You did not sign in correctly or your account is temporarily disabled.'",83],")",["T_WHITESPACE","\n            ",83],")",";",["T_WHITESPACE","\n        ",84],"}",["T_WHITESPACE","\n        ",85],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getRequestThrottler",86],"(",")",["T_OBJECT_OPERATOR","->",86],["T_STRING","resetAuthenticationFailuresCount",86],"(",["T_VARIABLE","$username",86],",",["T_WHITESPACE"," ",86],["T_STRING","RequestThrottler",86],["T_DOUBLE_COLON","::",86],["T_STRING","USER_TYPE_CUSTOMER",86],")",";",["T_WHITESPACE","\n        ",86],["T_RETURN","return",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","tokenModelFactory",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","create",87],"(",")",["T_OBJECT_OPERATOR","->",87],["T_STRING","createCustomerToken",87],"(",["T_VARIABLE","$customerDataObject",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","getId",87],"(",")",")",["T_OBJECT_OPERATOR","->",87],["T_STRING","getToken",87],"(",")",";",["T_WHITESPACE","\n    ",87],"}",["T_WHITESPACE","\n\n    ",88],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",90],["T_WHITESPACE","\n    ",92],["T_PUBLIC","public",93],["T_WHITESPACE"," ",93],["T_FUNCTION","function",93],["T_WHITESPACE"," ",93],["T_STRING","revokeCustomerAccessToken",93],"(",["T_VARIABLE","$customerId",93],")",["T_WHITESPACE","\n    ",93],"{",["T_WHITESPACE","\n        ",94],["T_VARIABLE","$tokenCollection",95],["T_WHITESPACE"," ",95],"=",["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","tokenModelCollectionFactory",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","create",95],"(",")",["T_OBJECT_OPERATOR","->",95],["T_STRING","addFilterByCustomerId",95],"(",["T_VARIABLE","$customerId",95],")",";",["T_WHITESPACE","\n        ",95],["T_IF","if",96],["T_WHITESPACE"," ",96],"(",["T_VARIABLE","$tokenCollection",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","getSize",96],"(",")",["T_WHITESPACE"," ",96],["T_IS_EQUAL","==",96],["T_WHITESPACE"," ",96],["T_LNUMBER","0",96],")",["T_WHITESPACE"," ",96],"{",["T_WHITESPACE","\n            ",96],["T_THROW","throw",97],["T_WHITESPACE"," ",97],["T_NEW","new",97],["T_WHITESPACE"," ",97],["T_STRING","LocalizedException",97],"(",["T_STRING","__",97],"(",["T_CONSTANT_ENCAPSED_STRING","'This customer has no tokens.'",97],")",")",";",["T_WHITESPACE","\n        ",97],"}",["T_WHITESPACE","\n        ",98],["T_TRY","try",99],["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n            ",99],["T_FOREACH","foreach",100],["T_WHITESPACE"," ",100],"(",["T_VARIABLE","$tokenCollection",100],["T_WHITESPACE"," ",100],["T_AS","as",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$token",100],")",["T_WHITESPACE"," ",100],"{",["T_WHITESPACE","\n                ",100],["T_VARIABLE","$token",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","setRevoked",101],"(",["T_LNUMBER","1",101],")",["T_OBJECT_OPERATOR","->",101],["T_STRING","save",101],"(",")",";",["T_WHITESPACE","\n            ",101],"}",["T_WHITESPACE","\n        ",102],"}",["T_WHITESPACE"," ",103],["T_CATCH","catch",103],["T_WHITESPACE"," ",103],"(",["T_NS_SEPARATOR","\\",103],["T_STRING","Exception",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$e",103],")",["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n            ",103],["T_THROW","throw",104],["T_WHITESPACE"," ",104],["T_NEW","new",104],["T_WHITESPACE"," ",104],["T_STRING","LocalizedException",104],"(",["T_STRING","__",104],"(",["T_CONSTANT_ENCAPSED_STRING","'The tokens could not be revoked.'",104],")",")",";",["T_WHITESPACE","\n        ",104],"}",["T_WHITESPACE","\n        ",105],["T_RETURN","return",106],["T_WHITESPACE"," ",106],["T_STRING","true",106],";",["T_WHITESPACE","\n    ",106],"}",["T_WHITESPACE","\n\n    ",107],["T_DOC_COMMENT","\/**\n     * Get request throttler instance\n     *\n     * @return RequestThrottler\n     * @deprecated\n     *\/",109],["T_WHITESPACE","\n    ",114],["T_PRIVATE","private",115],["T_WHITESPACE"," ",115],["T_FUNCTION","function",115],["T_WHITESPACE"," ",115],["T_STRING","getRequestThrottler",115],"(",")",["T_WHITESPACE","\n    ",115],"{",["T_WHITESPACE","\n        ",116],["T_IF","if",117],["T_WHITESPACE"," ",117],"(","!",["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","requestThrottler",117],["T_WHITESPACE"," ",117],["T_INSTANCEOF","instanceof",117],["T_WHITESPACE"," ",117],["T_STRING","RequestThrottler",117],")",["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n            ",117],["T_RETURN","return",118],["T_WHITESPACE"," ",118],["T_NS_SEPARATOR","\\",118],["T_STRING","Magento",118],["T_NS_SEPARATOR","\\",118],["T_STRING","Framework",118],["T_NS_SEPARATOR","\\",118],["T_STRING","App",118],["T_NS_SEPARATOR","\\",118],["T_STRING","ObjectManager",118],["T_DOUBLE_COLON","::",118],["T_STRING","getInstance",118],"(",")",["T_OBJECT_OPERATOR","->",118],["T_STRING","get",118],"(",["T_STRING","RequestThrottler",118],["T_DOUBLE_COLON","::",118],["T_CLASS","class",118],")",";",["T_WHITESPACE","\n        ",118],"}",["T_WHITESPACE","\n        ",119],["T_RETURN","return",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","requestThrottler",120],";",["T_WHITESPACE","\n    ",120],"}",["T_WHITESPACE","\n",121],"}",["T_WHITESPACE","\n",122]]