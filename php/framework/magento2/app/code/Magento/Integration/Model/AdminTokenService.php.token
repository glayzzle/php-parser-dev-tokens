[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Integration",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Model",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Exception",9],["T_NS_SEPARATOR","\\",9],["T_STRING","AuthenticationException",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Exception",10],["T_NS_SEPARATOR","\\",10],["T_STRING","LocalizedException",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Integration",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Model",11],["T_NS_SEPARATOR","\\",11],["T_STRING","CredentialsValidator",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Integration",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Model",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Oauth",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Token",12],["T_WHITESPACE"," ",12],["T_AS","as",12],["T_WHITESPACE"," ",12],["T_STRING","Token",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Integration",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Model",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Oauth",13],["T_NS_SEPARATOR","\\",13],["T_STRING","TokenFactory",13],["T_WHITESPACE"," ",13],["T_AS","as",13],["T_WHITESPACE"," ",13],["T_STRING","TokenModelFactory",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Integration",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Model",14],["T_NS_SEPARATOR","\\",14],["T_STRING","ResourceModel",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Oauth",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Token",14],["T_NS_SEPARATOR","\\",14],["T_STRING","CollectionFactory",14],["T_WHITESPACE"," ",14],["T_AS","as",14],["T_WHITESPACE"," ",14],["T_STRING","TokenCollectionFactory",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Magento",15],["T_NS_SEPARATOR","\\",15],["T_STRING","User",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Model",15],["T_NS_SEPARATOR","\\",15],["T_STRING","User",15],["T_WHITESPACE"," ",15],["T_AS","as",15],["T_WHITESPACE"," ",15],["T_STRING","UserModel",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Magento",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Integration",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Model",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Oauth",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Token",16],["T_NS_SEPARATOR","\\",16],["T_STRING","RequestThrottler",16],";",["T_WHITESPACE","\n\n",16],["T_DOC_COMMENT","\/**\n * Class to handle token generation for Admins\n *\n *\/",18],["T_WHITESPACE","\n",21],["T_CLASS","class",22],["T_WHITESPACE"," ",22],["T_STRING","AdminTokenService",22],["T_WHITESPACE"," ",22],["T_IMPLEMENTS","implements",22],["T_WHITESPACE"," ",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Magento",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Integration",22],["T_NS_SEPARATOR","\\",22],["T_STRING","Api",22],["T_NS_SEPARATOR","\\",22],["T_STRING","AdminTokenServiceInterface",22],["T_WHITESPACE","\n",22],"{",["T_WHITESPACE","\n    ",23],["T_DOC_COMMENT","\/**\n     * Token Model\n     *a\n     * @var TokenModelFactory\n     *\/",24],["T_WHITESPACE","\n    ",28],["T_PRIVATE","private",29],["T_WHITESPACE"," ",29],["T_VARIABLE","$tokenModelFactory",29],";",["T_WHITESPACE","\n\n    ",29],["T_DOC_COMMENT","\/**\n     * User Model\n     *\n     * @var UserModel\n     *\/",31],["T_WHITESPACE","\n    ",35],["T_PRIVATE","private",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$userModel",36],";",["T_WHITESPACE","\n\n    ",36],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Integration\\Model\\CredentialsValidator\n     *\/",38],["T_WHITESPACE","\n    ",40],["T_PRIVATE","private",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$validatorHelper",41],";",["T_WHITESPACE","\n\n    ",41],["T_DOC_COMMENT","\/**\n     * Token Collection Factory\n     *\n     * @var TokenCollectionFactory\n     *\/",43],["T_WHITESPACE","\n    ",47],["T_PRIVATE","private",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$tokenModelCollectionFactory",48],";",["T_WHITESPACE","\n\n    ",48],["T_DOC_COMMENT","\/**\n     * @var RequestThrottler\n     *\/",50],["T_WHITESPACE","\n    ",52],["T_PRIVATE","private",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$requestThrottler",53],";",["T_WHITESPACE","\n\n    ",53],["T_DOC_COMMENT","\/**\n     * Initialize service\n     *\n     * @param TokenModelFactory $tokenModelFactory\n     * @param UserModel $userModel\n     * @param TokenCollectionFactory $tokenModelCollectionFactory\n     * @param \\Magento\\Integration\\Model\\CredentialsValidator $validatorHelper\n     *\/",55],["T_WHITESPACE","\n    ",62],["T_PUBLIC","public",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","__construct",63],"(",["T_WHITESPACE","\n        ",63],["T_STRING","TokenModelFactory",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$tokenModelFactory",64],",",["T_WHITESPACE","\n        ",64],["T_STRING","UserModel",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$userModel",65],",",["T_WHITESPACE","\n        ",65],["T_STRING","TokenCollectionFactory",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$tokenModelCollectionFactory",66],",",["T_WHITESPACE","\n        ",66],["T_STRING","CredentialsValidator",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$validatorHelper",67],["T_WHITESPACE","\n    ",67],")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n        ",68],["T_VARIABLE","$this",69],["T_OBJECT_OPERATOR","->",69],["T_STRING","tokenModelFactory",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],["T_VARIABLE","$tokenModelFactory",69],";",["T_WHITESPACE","\n        ",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","userModel",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$userModel",70],";",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","tokenModelCollectionFactory",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$tokenModelCollectionFactory",71],";",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","validatorHelper",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_VARIABLE","$validatorHelper",72],";",["T_WHITESPACE","\n    ",72],"}",["T_WHITESPACE","\n\n    ",73],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",75],["T_WHITESPACE","\n    ",77],["T_PUBLIC","public",78],["T_WHITESPACE"," ",78],["T_FUNCTION","function",78],["T_WHITESPACE"," ",78],["T_STRING","createAdminAccessToken",78],"(",["T_VARIABLE","$username",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$password",78],")",["T_WHITESPACE","\n    ",78],"{",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","validatorHelper",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","validate",80],"(",["T_VARIABLE","$username",80],",",["T_WHITESPACE"," ",80],["T_VARIABLE","$password",80],")",";",["T_WHITESPACE","\n        ",80],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","getRequestThrottler",81],"(",")",["T_OBJECT_OPERATOR","->",81],["T_STRING","throttle",81],"(",["T_VARIABLE","$username",81],",",["T_WHITESPACE"," ",81],["T_STRING","RequestThrottler",81],["T_DOUBLE_COLON","::",81],["T_STRING","USER_TYPE_ADMIN",81],")",";",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","userModel",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","login",82],"(",["T_VARIABLE","$username",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$password",82],")",";",["T_WHITESPACE","\n        ",82],["T_IF","if",83],["T_WHITESPACE"," ",83],"(","!",["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","userModel",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","getId",83],"(",")",")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n            ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getRequestThrottler",84],"(",")",["T_OBJECT_OPERATOR","->",84],["T_STRING","logAuthenticationFailure",84],"(",["T_VARIABLE","$username",84],",",["T_WHITESPACE"," ",84],["T_STRING","RequestThrottler",84],["T_DOUBLE_COLON","::",84],["T_STRING","USER_TYPE_ADMIN",84],")",";",["T_WHITESPACE","\n            ",84],["T_COMMENT","\/*\n             * This message is same as one thrown in \\Magento\\Backend\\Model\\Auth to keep the behavior consistent.\n             * Constant cannot be created in Auth Model since it uses legacy translation that doesn't support it.\n             * Need to make sure that this is refactored once exception handling is updated in Auth Model.\n             *\/",85],["T_WHITESPACE","\n            ",89],["T_THROW","throw",90],["T_WHITESPACE"," ",90],["T_NEW","new",90],["T_WHITESPACE"," ",90],["T_STRING","AuthenticationException",90],"(",["T_WHITESPACE","\n                ",90],["T_STRING","__",91],"(",["T_CONSTANT_ENCAPSED_STRING","'You did not sign in correctly or your account is temporarily disabled.'",91],")",["T_WHITESPACE","\n            ",91],")",";",["T_WHITESPACE","\n        ",92],"}",["T_WHITESPACE","\n        ",93],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getRequestThrottler",94],"(",")",["T_OBJECT_OPERATOR","->",94],["T_STRING","resetAuthenticationFailuresCount",94],"(",["T_VARIABLE","$username",94],",",["T_WHITESPACE"," ",94],["T_STRING","RequestThrottler",94],["T_DOUBLE_COLON","::",94],["T_STRING","USER_TYPE_ADMIN",94],")",";",["T_WHITESPACE","\n        ",94],["T_RETURN","return",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","tokenModelFactory",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","create",95],"(",")",["T_OBJECT_OPERATOR","->",95],["T_STRING","createAdminToken",95],"(",["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","userModel",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getId",95],"(",")",")",["T_OBJECT_OPERATOR","->",95],["T_STRING","getToken",95],"(",")",";",["T_WHITESPACE","\n    ",95],"}",["T_WHITESPACE","\n\n    ",96],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",98],["T_WHITESPACE","\n    ",100],["T_PUBLIC","public",101],["T_WHITESPACE"," ",101],["T_FUNCTION","function",101],["T_WHITESPACE"," ",101],["T_STRING","revokeAdminAccessToken",101],"(",["T_VARIABLE","$adminId",101],")",["T_WHITESPACE","\n    ",101],"{",["T_WHITESPACE","\n        ",102],["T_VARIABLE","$tokenCollection",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","tokenModelCollectionFactory",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","create",103],"(",")",["T_OBJECT_OPERATOR","->",103],["T_STRING","addFilterByAdminId",103],"(",["T_VARIABLE","$adminId",103],")",";",["T_WHITESPACE","\n        ",103],["T_IF","if",104],["T_WHITESPACE"," ",104],"(",["T_VARIABLE","$tokenCollection",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","getSize",104],"(",")",["T_WHITESPACE"," ",104],["T_IS_EQUAL","==",104],["T_WHITESPACE"," ",104],["T_LNUMBER","0",104],")",["T_WHITESPACE"," ",104],"{",["T_WHITESPACE","\n            ",104],["T_THROW","throw",105],["T_WHITESPACE"," ",105],["T_NEW","new",105],["T_WHITESPACE"," ",105],["T_STRING","LocalizedException",105],"(",["T_STRING","__",105],"(",["T_CONSTANT_ENCAPSED_STRING","'This user has no tokens.'",105],")",")",";",["T_WHITESPACE","\n        ",105],"}",["T_WHITESPACE","\n        ",106],["T_TRY","try",107],["T_WHITESPACE"," ",107],"{",["T_WHITESPACE","\n            ",107],["T_FOREACH","foreach",108],["T_WHITESPACE"," ",108],"(",["T_VARIABLE","$tokenCollection",108],["T_WHITESPACE"," ",108],["T_AS","as",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$token",108],")",["T_WHITESPACE"," ",108],"{",["T_WHITESPACE","\n                ",108],["T_VARIABLE","$token",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","setRevoked",109],"(",["T_LNUMBER","1",109],")",["T_OBJECT_OPERATOR","->",109],["T_STRING","save",109],"(",")",";",["T_WHITESPACE","\n            ",109],"}",["T_WHITESPACE","\n        ",110],"}",["T_WHITESPACE"," ",111],["T_CATCH","catch",111],["T_WHITESPACE"," ",111],"(",["T_NS_SEPARATOR","\\",111],["T_STRING","Exception",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$e",111],")",["T_WHITESPACE"," ",111],"{",["T_WHITESPACE","\n            ",111],["T_THROW","throw",112],["T_WHITESPACE"," ",112],["T_NEW","new",112],["T_WHITESPACE"," ",112],["T_STRING","LocalizedException",112],"(",["T_STRING","__",112],"(",["T_CONSTANT_ENCAPSED_STRING","'The tokens could not be revoked.'",112],")",")",";",["T_WHITESPACE","\n        ",112],"}",["T_WHITESPACE","\n        ",113],["T_RETURN","return",114],["T_WHITESPACE"," ",114],["T_STRING","true",114],";",["T_WHITESPACE","\n    ",114],"}",["T_WHITESPACE","\n\n    ",115],["T_DOC_COMMENT","\/**\n     * Get request throttler instance\n     *\n     * @return RequestThrottler\n     * @deprecated\n     *\/",117],["T_WHITESPACE","\n    ",122],["T_PRIVATE","private",123],["T_WHITESPACE"," ",123],["T_FUNCTION","function",123],["T_WHITESPACE"," ",123],["T_STRING","getRequestThrottler",123],"(",")",["T_WHITESPACE","\n    ",123],"{",["T_WHITESPACE","\n        ",124],["T_IF","if",125],["T_WHITESPACE"," ",125],"(","!",["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","requestThrottler",125],["T_WHITESPACE"," ",125],["T_INSTANCEOF","instanceof",125],["T_WHITESPACE"," ",125],["T_STRING","RequestThrottler",125],")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n            ",125],["T_RETURN","return",126],["T_WHITESPACE"," ",126],["T_NS_SEPARATOR","\\",126],["T_STRING","Magento",126],["T_NS_SEPARATOR","\\",126],["T_STRING","Framework",126],["T_NS_SEPARATOR","\\",126],["T_STRING","App",126],["T_NS_SEPARATOR","\\",126],["T_STRING","ObjectManager",126],["T_DOUBLE_COLON","::",126],["T_STRING","getInstance",126],"(",")",["T_OBJECT_OPERATOR","->",126],["T_STRING","get",126],"(",["T_STRING","RequestThrottler",126],["T_DOUBLE_COLON","::",126],["T_CLASS","class",126],")",";",["T_WHITESPACE","\n        ",126],"}",["T_WHITESPACE","\n        ",127],["T_RETURN","return",128],["T_WHITESPACE"," ",128],["T_VARIABLE","$this",128],["T_OBJECT_OPERATOR","->",128],["T_STRING","requestThrottler",128],";",["T_WHITESPACE","\n    ",128],"}",["T_WHITESPACE","\n",129],"}",["T_WHITESPACE","\n",130]]