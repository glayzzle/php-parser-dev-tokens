[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Security",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Exception",8],["T_NS_SEPARATOR","\\",8],["T_STRING","SecurityViolationException",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","HTTP",9],["T_NS_SEPARATOR","\\",9],["T_STRING","PhpEnvironment",9],["T_NS_SEPARATOR","\\",9],["T_STRING","RemoteAddress",9],";",["T_WHITESPACE","\n\n",9],["T_DOC_COMMENT","\/**\n * Security Control Manager Model\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",11],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","SecurityManager",15],["T_WHITESPACE","\n",15],"{",["T_WHITESPACE","\n    ",16],["T_DOC_COMMENT","\/**\n     * Security control records time life\n     *\/",17],["T_WHITESPACE","\n    ",19],["T_CONST","const",20],["T_WHITESPACE"," ",20],["T_STRING","SECURITY_CONTROL_RECORDS_LIFE_TIME",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE","  ",20],["T_LNUMBER","86400",20],";",["T_WHITESPACE","\n\n    ",20],["T_DOC_COMMENT","\/**\n     * @var ConfigInterface\n     *\/",22],["T_WHITESPACE","\n    ",24],["T_PROTECTED","protected",25],["T_WHITESPACE"," ",25],["T_VARIABLE","$securityConfig",25],";",["T_WHITESPACE","\n\n    ",25],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Security\\Model\\PasswordResetRequestEventFactory\n     *\/",27],["T_WHITESPACE","\n    ",29],["T_PROTECTED","protected",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$passwordResetRequestEventFactory",30],";",["T_WHITESPACE","\n\n    ",30],["T_DOC_COMMENT","\/**\n     * @var ResourceModel\\PasswordResetRequestEvent\\CollectionFactory\n     *\/",32],["T_WHITESPACE","\n    ",34],["T_PROTECTED","protected",35],["T_WHITESPACE"," ",35],["T_VARIABLE","$passwordResetRequestEventCollectionFactory",35],";",["T_WHITESPACE","\n\n    ",35],["T_DOC_COMMENT","\/**\n     * @var array\n     *\/",37],["T_WHITESPACE","\n    ",39],["T_PROTECTED","protected",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$securityCheckers",40],";",["T_WHITESPACE","\n\n    ",40],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Event\\ManagerInterface\n     *\/",42],["T_WHITESPACE","\n    ",44],["T_PRIVATE","private",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$eventManager",45],";",["T_WHITESPACE","\n\n    ",45],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Stdlib\\DateTime\\DateTime\n     *\/",47],["T_WHITESPACE","\n    ",49],["T_PRIVATE","private",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$dateTime",50],";",["T_WHITESPACE","\n\n    ",50],["T_DOC_COMMENT","\/**\n     * @var RemoteAddress\n     *\/",52],["T_WHITESPACE","\n    ",54],["T_PRIVATE","private",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$remoteAddress",55],";",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * SecurityManager constructor.\n     *\n     * @param ConfigInterface $securityConfig\n     * @param \\Magento\\Security\\Model\\PasswordResetRequestEventFactory $passwordResetRequestEventFactory\n     * @param ResourceModel\\PasswordResetRequestEvent\\CollectionFactory $passwordResetRequestEventCollectionFactory\n     * @param \\Magento\\Framework\\Event\\ManagerInterface $eventManager\n     * @param \\Magento\\Framework\\Stdlib\\DateTime\\DateTime $dateTime\n     * @param RemoteAddress $remoteAddress\n     * @param array $securityCheckers\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     *\/",57],["T_WHITESPACE","\n    ",68],["T_PUBLIC","public",69],["T_WHITESPACE"," ",69],["T_FUNCTION","function",69],["T_WHITESPACE"," ",69],["T_STRING","__construct",69],"(",["T_WHITESPACE","\n        ",69],["T_STRING","ConfigInterface",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$securityConfig",70],",",["T_WHITESPACE","\n        ",70],["T_NS_SEPARATOR","\\",71],["T_STRING","Magento",71],["T_NS_SEPARATOR","\\",71],["T_STRING","Security",71],["T_NS_SEPARATOR","\\",71],["T_STRING","Model",71],["T_NS_SEPARATOR","\\",71],["T_STRING","PasswordResetRequestEventFactory",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$passwordResetRequestEventFactory",71],",",["T_WHITESPACE","\n        ",71],["T_STRING","ResourceModel",72],["T_NS_SEPARATOR","\\",72],["T_STRING","PasswordResetRequestEvent",72],["T_NS_SEPARATOR","\\",72],["T_STRING","CollectionFactory",72],["T_WHITESPACE"," ",72],["T_VARIABLE","$passwordResetRequestEventCollectionFactory",72],",",["T_WHITESPACE","\n        ",72],["T_NS_SEPARATOR","\\",73],["T_STRING","Magento",73],["T_NS_SEPARATOR","\\",73],["T_STRING","Framework",73],["T_NS_SEPARATOR","\\",73],["T_STRING","Event",73],["T_NS_SEPARATOR","\\",73],["T_STRING","ManagerInterface",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$eventManager",73],",",["T_WHITESPACE","\n        ",73],["T_NS_SEPARATOR","\\",74],["T_STRING","Magento",74],["T_NS_SEPARATOR","\\",74],["T_STRING","Framework",74],["T_NS_SEPARATOR","\\",74],["T_STRING","Stdlib",74],["T_NS_SEPARATOR","\\",74],["T_STRING","DateTime",74],["T_NS_SEPARATOR","\\",74],["T_STRING","DateTime",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$dateTime",74],",",["T_WHITESPACE","\n        ",74],["T_STRING","RemoteAddress",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$remoteAddress",75],",",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$securityCheckers",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],"[","]",["T_WHITESPACE","\n    ",76],")",["T_WHITESPACE"," ",77],"{",["T_WHITESPACE","\n        ",77],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","securityConfig",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$securityConfig",78],";",["T_WHITESPACE","\n        ",78],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","passwordResetRequestEventFactory",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$passwordResetRequestEventFactory",79],";",["T_WHITESPACE","\n        ",79],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","passwordResetRequestEventCollectionFactory",80],["T_WHITESPACE"," ",80],"=",["T_WHITESPACE"," ",80],["T_VARIABLE","$passwordResetRequestEventCollectionFactory",80],";",["T_WHITESPACE","\n        ",80],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","securityCheckers",81],["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_VARIABLE","$securityCheckers",81],";",["T_WHITESPACE","\n        ",81],["T_VARIABLE","$this",82],["T_OBJECT_OPERATOR","->",82],["T_STRING","eventManager",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$eventManager",82],";",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$this",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","dateTime",83],["T_WHITESPACE"," ",83],"=",["T_WHITESPACE"," ",83],["T_VARIABLE","$dateTime",83],";",["T_WHITESPACE","\n        ",83],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","remoteAddress",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$remoteAddress",84],";",["T_WHITESPACE","\n\n        ",84],["T_FOREACH","foreach",86],["T_WHITESPACE"," ",86],"(",["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","securityCheckers",86],["T_WHITESPACE"," ",86],["T_AS","as",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$checker",86],")",["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n            ",86],["T_IF","if",87],["T_WHITESPACE"," ",87],"(","!","(",["T_VARIABLE","$checker",87],["T_WHITESPACE"," ",87],["T_INSTANCEOF","instanceof",87],["T_WHITESPACE"," ",87],["T_NS_SEPARATOR","\\",87],["T_STRING","Magento",87],["T_NS_SEPARATOR","\\",87],["T_STRING","Security",87],["T_NS_SEPARATOR","\\",87],["T_STRING","Model",87],["T_NS_SEPARATOR","\\",87],["T_STRING","SecurityChecker",87],["T_NS_SEPARATOR","\\",87],["T_STRING","SecurityCheckerInterface",87],")",")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n                ",87],["T_THROW","throw",88],["T_WHITESPACE"," ",88],["T_NEW","new",88],["T_WHITESPACE"," ",88],["T_NS_SEPARATOR","\\",88],["T_STRING","Magento",88],["T_NS_SEPARATOR","\\",88],["T_STRING","Framework",88],["T_NS_SEPARATOR","\\",88],["T_STRING","Exception",88],["T_NS_SEPARATOR","\\",88],["T_STRING","LocalizedException",88],"(",["T_WHITESPACE","\n                    ",88],["T_STRING","__",89],"(",["T_CONSTANT_ENCAPSED_STRING","'Incorrect Security Checker class. It has to implement SecurityCheckerInterface'",89],")",["T_WHITESPACE","\n                ",89],")",";",["T_WHITESPACE","\n            ",90],"}",["T_WHITESPACE","\n        ",91],"}",["T_WHITESPACE","\n    ",92],"}",["T_WHITESPACE","\n\n    ",93],["T_DOC_COMMENT","\/**\n     * Perform security check\n     *\n     * @param int $requestType\n     * @param string|null $accountReference\n     * @param int|null $longIp\n     * @return $this\n     * @throws SecurityViolationException\n     *\/",95],["T_WHITESPACE","\n    ",103],["T_PUBLIC","public",104],["T_WHITESPACE"," ",104],["T_FUNCTION","function",104],["T_WHITESPACE"," ",104],["T_STRING","performSecurityCheck",104],"(",["T_VARIABLE","$requestType",104],",",["T_WHITESPACE"," ",104],["T_VARIABLE","$accountReference",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_STRING","null",104],",",["T_WHITESPACE"," ",104],["T_VARIABLE","$longIp",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_STRING","null",104],")",["T_WHITESPACE","\n    ",104],"{",["T_WHITESPACE","\n        ",105],["T_IF","if",106],["T_WHITESPACE"," ",106],"(",["T_STRING","null",106],["T_WHITESPACE"," ",106],["T_IS_IDENTICAL","===",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$longIp",106],")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n            ",106],["T_VARIABLE","$longIp",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","remoteAddress",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","getRemoteAddress",107],"(",")",";",["T_WHITESPACE","\n        ",107],"}",["T_WHITESPACE","\n        ",108],["T_FOREACH","foreach",109],["T_WHITESPACE"," ",109],"(",["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","securityCheckers",109],["T_WHITESPACE"," ",109],["T_AS","as",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$checker",109],")",["T_WHITESPACE"," ",109],"{",["T_WHITESPACE","\n            ",109],["T_VARIABLE","$checker",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","check",110],"(",["T_VARIABLE","$requestType",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$accountReference",110],",",["T_WHITESPACE"," ",110],["T_VARIABLE","$longIp",110],")",";",["T_WHITESPACE","\n        ",110],"}",["T_WHITESPACE","\n\n        ",111],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","createNewPasswordResetRequestEventRecord",113],"(",["T_VARIABLE","$requestType",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$accountReference",113],",",["T_WHITESPACE"," ",113],["T_VARIABLE","$longIp",113],")",";",["T_WHITESPACE","\n\n        ",113],["T_RETURN","return",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$this",115],";",["T_WHITESPACE","\n    ",115],"}",["T_WHITESPACE","\n\n    ",116],["T_DOC_COMMENT","\/**\n     * Clean expired Admin Sessions\n     *\n     * @return $this\n     *\/",118],["T_WHITESPACE","\n    ",122],["T_PUBLIC","public",123],["T_WHITESPACE"," ",123],["T_FUNCTION","function",123],["T_WHITESPACE"," ",123],["T_STRING","cleanExpiredRecords",123],"(",")",["T_WHITESPACE","\n    ",123],"{",["T_WHITESPACE","\n        ",124],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","passwordResetRequestEventCollectionFactory",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","create",125],"(",")",["T_OBJECT_OPERATOR","->",125],["T_STRING","deleteRecordsOlderThen",125],"(",["T_WHITESPACE","\n            ",125],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","dateTime",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","gmtTimestamp",126],"(",")",["T_WHITESPACE"," ",126],"-",["T_WHITESPACE"," ",126],["T_STRING","self",126],["T_DOUBLE_COLON","::",126],["T_STRING","SECURITY_CONTROL_RECORDS_LIFE_TIME",126],["T_WHITESPACE","\n        ",126],")",";",["T_WHITESPACE","\n\n        ",127],["T_RETURN","return",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$this",129],";",["T_WHITESPACE","\n    ",129],"}",["T_WHITESPACE","\n\n    ",130],["T_DOC_COMMENT","\/**\n     * Create new password reset request record\n     *\n     * @param int $requestType\n     * @param string|null $accountReference\n     * @param int $longIp\n     * @return PasswordResetRequestEvent\n     *\/",132],["T_WHITESPACE","\n    ",139],["T_PROTECTED","protected",140],["T_WHITESPACE"," ",140],["T_FUNCTION","function",140],["T_WHITESPACE"," ",140],["T_STRING","createNewPasswordResetRequestEventRecord",140],"(",["T_VARIABLE","$requestType",140],",",["T_WHITESPACE"," ",140],["T_VARIABLE","$accountReference",140],",",["T_WHITESPACE"," ",140],["T_VARIABLE","$longIp",140],")",["T_WHITESPACE","\n    ",140],"{",["T_WHITESPACE","\n        ",141],["T_DOC_COMMENT","\/** @var \\Magento\\Security\\Model\\PasswordResetRequestEventFactory $passwordResetRequestEvent *\/",142],["T_WHITESPACE","\n        ",142],["T_VARIABLE","$passwordResetRequestEvent",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","passwordResetRequestEventFactory",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","create",143],"(",")",";",["T_WHITESPACE","\n        ",143],["T_VARIABLE","$passwordResetRequestEvent",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","setRequestType",144],"(",["T_VARIABLE","$requestType",144],")",["T_WHITESPACE","\n            ",144],["T_OBJECT_OPERATOR","->",145],["T_STRING","setAccountReference",145],"(",["T_VARIABLE","$accountReference",145],")",["T_WHITESPACE","\n            ",145],["T_OBJECT_OPERATOR","->",146],["T_STRING","setIp",146],"(",["T_VARIABLE","$longIp",146],")",["T_WHITESPACE","\n            ",146],["T_OBJECT_OPERATOR","->",147],["T_STRING","save",147],"(",")",";",["T_WHITESPACE","\n\n        ",147],["T_RETURN","return",149],["T_WHITESPACE"," ",149],["T_VARIABLE","$passwordResetRequestEvent",149],";",["T_WHITESPACE","\n    ",149],"}",["T_WHITESPACE","\n",150],"}",["T_WHITESPACE","\n",151]]