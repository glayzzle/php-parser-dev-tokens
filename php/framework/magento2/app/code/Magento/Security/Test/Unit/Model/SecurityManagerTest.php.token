[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Security",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Test",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Unit",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Framework",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Stdlib",8],["T_NS_SEPARATOR","\\",8],["T_STRING","DateTime",8],["T_NS_SEPARATOR","\\",8],["T_STRING","DateTime",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","TestFramework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Unit",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Helper",9],["T_NS_SEPARATOR","\\",9],["T_STRING","ObjectManager",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Security",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Model",10],["T_NS_SEPARATOR","\\",10],["T_STRING","ConfigInterface",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Framework",11],["T_NS_SEPARATOR","\\",11],["T_STRING","HTTP",11],["T_NS_SEPARATOR","\\",11],["T_STRING","PhpEnvironment",11],["T_NS_SEPARATOR","\\",11],["T_STRING","RemoteAddress",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Security",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Model",12],["T_NS_SEPARATOR","\\",12],["T_STRING","SecurityManager",12],";",["T_WHITESPACE","\n\n",12],["T_DOC_COMMENT","\/**\n * Test class for \\Magento\\Security\\Model\\SecurityManager testing\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",14],["T_WHITESPACE","\n",17],["T_CLASS","class",18],["T_WHITESPACE"," ",18],["T_STRING","SecurityManagerTest",18],["T_WHITESPACE"," ",18],["T_EXTENDS","extends",18],["T_WHITESPACE"," ",18],["T_NS_SEPARATOR","\\",18],["T_STRING","PHPUnit_Framework_TestCase",18],["T_WHITESPACE","\n",18],"{",["T_WHITESPACE","\n    ",19],["T_DOC_COMMENT","\/** @var  \\Magento\\Security\\Model\\SecurityManager *\/",20],["T_WHITESPACE","\n    ",20],["T_PROTECTED","protected",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$model",21],";",["T_WHITESPACE","\n\n    ",21],["T_DOC_COMMENT","\/** @var ConfigInterface *\/",23],["T_WHITESPACE","\n    ",23],["T_PROTECTED","protected",24],["T_WHITESPACE"," ",24],["T_VARIABLE","$securityConfigMock",24],";",["T_WHITESPACE","\n\n    ",24],["T_DOC_COMMENT","\/** @var \\Magento\\Security\\Model\\ResourceModel\\PasswordResetRequestEvent\\CollectionFactory *\/",26],["T_WHITESPACE","\n    ",26],["T_PROTECTED","protected",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$passwordResetRequestEventCollectionFactoryMock",27],";",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/** @var \\Magento\\Security\\Model\\ResourceModel\\PasswordResetRequestEvent\\Collection *\/",29],["T_WHITESPACE","\n    ",29],["T_PROTECTED","protected",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$passwordResetRequestEventCollectionMock",30],";",["T_WHITESPACE","\n\n    ",30],["T_DOC_COMMENT","\/** @var \\Magento\\Security\\Model\\PasswordResetRequestEventFactory *\/",32],["T_WHITESPACE","\n    ",32],["T_PROTECTED","protected",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$passwordResetRequestEventFactoryMock",33],";",["T_WHITESPACE","\n\n    ",33],["T_DOC_COMMENT","\/** @var \\Magento\\Security\\Model\\PasswordResetRequestEvent *\/",35],["T_WHITESPACE","\n    ",35],["T_PROTECTED","protected",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$passwordResetRequestEventMock",36],";",["T_WHITESPACE","\n\n    ",36],["T_DOC_COMMENT","\/** @var  \\Magento\\Framework\\TestFramework\\Unit\\Helper\\ObjectManager *\/",38],["T_WHITESPACE","\n    ",38],["T_PROTECTED","protected",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$objectManager",39],";",["T_WHITESPACE","\n\n    ",39],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Event\\ManagerInterface|\\PHPUnit_Framework_MockObject_MockObject\n     *\/",41],["T_WHITESPACE","\n    ",43],["T_PROTECTED","protected",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$eventManagerMock",44],";",["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * @var DateTime\n     *\/",46],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$dateTimeMock",49],";",["T_WHITESPACE","\n\n    ",49],["T_COMMENT","\/*\n     * @var RemoteAddress\n     *\/",51],["T_WHITESPACE","\n    ",53],["T_PROTECTED","protected",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$remoteAddressMock",54],";",["T_WHITESPACE","\n\n    ",54],["T_DOC_COMMENT","\/**\n     * Init mocks for tests\n     * @return void\n     *\/",56],["T_WHITESPACE","\n    ",59],["T_PUBLIC","public",60],["T_WHITESPACE"," ",60],["T_FUNCTION","function",60],["T_WHITESPACE"," ",60],["T_STRING","setUp",60],"(",")",["T_WHITESPACE","\n    ",60],"{",["T_WHITESPACE","\n        ",61],["T_VARIABLE","$this",62],["T_OBJECT_OPERATOR","->",62],["T_STRING","objectManager",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_NEW","new",62],["T_WHITESPACE"," ",62],["T_STRING","ObjectManager",62],"(",["T_VARIABLE","$this",62],")",";",["T_WHITESPACE","\n\n        ",62],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","securityConfigMock",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE","  ",64],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","getMockBuilder",64],"(",["T_NS_SEPARATOR","\\",64],["T_STRING","Magento",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Security",64],["T_NS_SEPARATOR","\\",64],["T_STRING","Model",64],["T_NS_SEPARATOR","\\",64],["T_STRING","ConfigInterface",64],["T_DOUBLE_COLON","::",64],["T_CLASS","class",64],")",["T_WHITESPACE","\n            ",64],["T_OBJECT_OPERATOR","->",65],["T_STRING","disableOriginalConstructor",65],"(",")",["T_WHITESPACE","\n            ",65],["T_OBJECT_OPERATOR","->",66],["T_STRING","getMock",66],"(",")",";",["T_WHITESPACE","\n\n        ",66],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","passwordResetRequestEventCollectionFactoryMock",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","getMock",68],"(",["T_WHITESPACE","\n            ",68],["T_NS_SEPARATOR","\\",69],["T_STRING","Magento",69],["T_NS_SEPARATOR","\\",69],["T_STRING","Security",69],["T_NS_SEPARATOR","\\",69],["T_STRING","Model",69],["T_NS_SEPARATOR","\\",69],["T_STRING","ResourceModel",69],["T_NS_SEPARATOR","\\",69],["T_STRING","PasswordResetRequestEvent",69],["T_NS_SEPARATOR","\\",69],["T_STRING","CollectionFactory",69],["T_DOUBLE_COLON","::",69],["T_CLASS","class",69],",",["T_WHITESPACE","\n            ",69],"[",["T_CONSTANT_ENCAPSED_STRING","'create'",70],"]",",",["T_WHITESPACE","\n            ",70],"[","]",",",["T_WHITESPACE","\n            ",71],["T_CONSTANT_ENCAPSED_STRING","''",72],",",["T_WHITESPACE","\n            ",72],["T_STRING","false",73],["T_WHITESPACE","\n        ",73],")",";",["T_WHITESPACE","\n\n        ",74],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","passwordResetRequestEventCollectionMock",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getMock",76],"(",["T_WHITESPACE","\n            ",76],["T_NS_SEPARATOR","\\",77],["T_STRING","Magento",77],["T_NS_SEPARATOR","\\",77],["T_STRING","Security",77],["T_NS_SEPARATOR","\\",77],["T_STRING","Model",77],["T_NS_SEPARATOR","\\",77],["T_STRING","ResourceModel",77],["T_NS_SEPARATOR","\\",77],["T_STRING","PasswordResetRequestEvent",77],["T_NS_SEPARATOR","\\",77],["T_STRING","Collection",77],["T_DOUBLE_COLON","::",77],["T_CLASS","class",77],",",["T_WHITESPACE","\n            ",77],"[",["T_CONSTANT_ENCAPSED_STRING","'deleteRecordsOlderThen'",78],"]",",",["T_WHITESPACE","\n            ",78],"[","]",",",["T_WHITESPACE","\n            ",79],["T_CONSTANT_ENCAPSED_STRING","''",80],",",["T_WHITESPACE","\n            ",80],["T_STRING","false",81],["T_WHITESPACE","\n        ",81],")",";",["T_WHITESPACE","\n\n        ",82],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","passwordResetRequestEventFactoryMock",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","getMock",84],"(",["T_WHITESPACE","\n            ",84],["T_NS_SEPARATOR","\\",85],["T_STRING","Magento",85],["T_NS_SEPARATOR","\\",85],["T_STRING","Security",85],["T_NS_SEPARATOR","\\",85],["T_STRING","Model",85],["T_NS_SEPARATOR","\\",85],["T_STRING","PasswordResetRequestEventFactory",85],["T_DOUBLE_COLON","::",85],["T_CLASS","class",85],",",["T_WHITESPACE","\n            ",85],"[",["T_CONSTANT_ENCAPSED_STRING","'create'",86],"]",",",["T_WHITESPACE","\n            ",86],"[","]",",",["T_WHITESPACE","\n            ",87],["T_CONSTANT_ENCAPSED_STRING","''",88],",",["T_WHITESPACE","\n            ",88],["T_STRING","false",89],["T_WHITESPACE","\n        ",89],")",";",["T_WHITESPACE","\n\n        ",90],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","passwordResetRequestEventMock",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getMock",92],"(",["T_WHITESPACE","\n            ",92],["T_NS_SEPARATOR","\\",93],["T_STRING","Magento",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Security",93],["T_NS_SEPARATOR","\\",93],["T_STRING","Model",93],["T_NS_SEPARATOR","\\",93],["T_STRING","PasswordResetRequestEvent",93],["T_DOUBLE_COLON","::",93],["T_CLASS","class",93],",",["T_WHITESPACE","\n            ",93],"[",["T_CONSTANT_ENCAPSED_STRING","'setRequestType'",94],",",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'setAccountReference'",94],",",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'setIp'",94],",",["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'save'",94],"]",",",["T_WHITESPACE","\n            ",94],"[","]",",",["T_WHITESPACE","\n            ",95],["T_CONSTANT_ENCAPSED_STRING","''",96],",",["T_WHITESPACE","\n            ",96],["T_STRING","false",97],["T_WHITESPACE","\n        ",97],")",";",["T_WHITESPACE","\n\n        ",98],["T_VARIABLE","$securityChecker",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getMock",100],"(",["T_WHITESPACE","\n            ",100],["T_NS_SEPARATOR","\\",101],["T_STRING","Magento",101],["T_NS_SEPARATOR","\\",101],["T_STRING","Security",101],["T_NS_SEPARATOR","\\",101],["T_STRING","Model",101],["T_NS_SEPARATOR","\\",101],["T_STRING","SecurityChecker",101],["T_NS_SEPARATOR","\\",101],["T_STRING","SecurityCheckerInterface",101],["T_DOUBLE_COLON","::",101],["T_CLASS","class",101],",",["T_WHITESPACE","\n            ",101],"[","]",",",["T_WHITESPACE","\n            ",102],"[","]",",",["T_WHITESPACE","\n            ",103],["T_CONSTANT_ENCAPSED_STRING","''",104],",",["T_WHITESPACE","\n            ",104],["T_STRING","false",105],["T_WHITESPACE","\n        ",105],")",";",["T_WHITESPACE","\n\n        ",106],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","eventManagerMock",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_VARIABLE","$this",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","getMockForAbstractClass",108],"(",["T_WHITESPACE","\n            ",108],["T_NS_SEPARATOR","\\",109],["T_STRING","Magento",109],["T_NS_SEPARATOR","\\",109],["T_STRING","Framework",109],["T_NS_SEPARATOR","\\",109],["T_STRING","Event",109],["T_NS_SEPARATOR","\\",109],["T_STRING","ManagerInterface",109],["T_DOUBLE_COLON","::",109],["T_CLASS","class",109],",",["T_WHITESPACE","\n            ",109],"[","]",",",["T_WHITESPACE","\n            ",110],["T_CONSTANT_ENCAPSED_STRING","''",111],",",["T_WHITESPACE","\n            ",111],["T_STRING","false",112],",",["T_WHITESPACE","\n            ",112],["T_STRING","true",113],",",["T_WHITESPACE","\n            ",113],["T_STRING","true",114],",",["T_WHITESPACE","\n            ",114],"[",["T_CONSTANT_ENCAPSED_STRING","'dispatch'",115],"]",["T_WHITESPACE","\n        ",115],")",";",["T_WHITESPACE","\n\n        ",116],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","dateTimeMock",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE","  ",118],["T_VARIABLE","$this",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","getMockBuilder",118],"(",["T_STRING","DateTime",118],["T_DOUBLE_COLON","::",118],["T_CLASS","class",118],")",["T_WHITESPACE","\n            ",118],["T_OBJECT_OPERATOR","->",119],["T_STRING","disableOriginalConstructor",119],"(",")",["T_WHITESPACE","\n            ",119],["T_OBJECT_OPERATOR","->",120],["T_STRING","getMock",120],"(",")",";",["T_WHITESPACE","\n\n        ",120],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","remoteAddressMock",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE","  ",122],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","getMockBuilder",122],"(",["T_STRING","RemoteAddress",122],["T_DOUBLE_COLON","::",122],["T_CLASS","class",122],")",["T_WHITESPACE","\n            ",122],["T_OBJECT_OPERATOR","->",123],["T_STRING","disableOriginalConstructor",123],"(",")",["T_WHITESPACE","\n            ",123],["T_OBJECT_OPERATOR","->",124],["T_STRING","getMock",124],"(",")",";",["T_WHITESPACE","\n\n        ",124],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","model",126],["T_WHITESPACE"," ",126],"=",["T_WHITESPACE"," ",126],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","objectManager",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getObject",126],"(",["T_WHITESPACE","\n            ",126],["T_STRING","SecurityManager",127],["T_DOUBLE_COLON","::",127],["T_CLASS","class",127],",",["T_WHITESPACE","\n            ",127],"[",["T_WHITESPACE","\n                ",128],["T_CONSTANT_ENCAPSED_STRING","'securityConfig'",129],["T_WHITESPACE"," ",129],["T_DOUBLE_ARROW","=>",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","securityConfigMock",129],",",["T_WHITESPACE","\n                ",129],["T_CONSTANT_ENCAPSED_STRING","'passwordResetRequestEventFactory'",130],["T_WHITESPACE"," ",130],["T_DOUBLE_ARROW","=>",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$this",130],["T_OBJECT_OPERATOR","->",130],["T_STRING","passwordResetRequestEventFactoryMock",130],",",["T_WHITESPACE","\n                ",130],["T_CONSTANT_ENCAPSED_STRING","'passwordResetRequestEventCollectionFactory'",131],["T_WHITESPACE"," ",131],["T_DOUBLE_ARROW","=>",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","passwordResetRequestEventCollectionFactoryMock",131],",",["T_WHITESPACE","\n                ",131],["T_CONSTANT_ENCAPSED_STRING","'eventManager'",132],["T_WHITESPACE"," ",132],["T_DOUBLE_ARROW","=>",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","eventManagerMock",132],",",["T_WHITESPACE","\n                ",132],["T_CONSTANT_ENCAPSED_STRING","'securityCheckers'",133],["T_WHITESPACE"," ",133],["T_DOUBLE_ARROW","=>",133],["T_WHITESPACE"," ",133],"[",["T_VARIABLE","$securityChecker",133],"]",",",["T_WHITESPACE","\n                ",133],["T_CONSTANT_ENCAPSED_STRING","'dateTime'",134],["T_WHITESPACE"," ",134],["T_DOUBLE_ARROW","=>",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","dateTimeMock",134],",",["T_WHITESPACE","\n                ",134],["T_CONSTANT_ENCAPSED_STRING","'remoteAddress'",135],["T_WHITESPACE"," ",135],["T_DOUBLE_ARROW","=>",135],["T_WHITESPACE"," ",135],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","remoteAddressMock",135],["T_WHITESPACE","\n            ",135],"]",["T_WHITESPACE","\n        ",136],")",";",["T_WHITESPACE","\n    ",137],"}",["T_WHITESPACE","\n\n    ",138],["T_DOC_COMMENT","\/**\n     * @return void\n     *\/",140],["T_WHITESPACE","\n    ",142],["T_PUBLIC","public",143],["T_WHITESPACE"," ",143],["T_FUNCTION","function",143],["T_WHITESPACE"," ",143],["T_STRING","testConstructorException",143],"(",")",["T_WHITESPACE","\n    ",143],"{",["T_WHITESPACE","\n        ",144],["T_VARIABLE","$securityChecker",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getMock",145],"(",["T_WHITESPACE","\n            ",145],["T_NS_SEPARATOR","\\",146],["T_STRING","Magento",146],["T_NS_SEPARATOR","\\",146],["T_STRING","Framework",146],["T_NS_SEPARATOR","\\",146],["T_STRING","Message",146],["T_NS_SEPARATOR","\\",146],["T_STRING","ManagerInterface",146],["T_DOUBLE_COLON","::",146],["T_CLASS","class",146],",",["T_WHITESPACE","\n            ",146],"[","]",",",["T_WHITESPACE","\n            ",147],"[","]",",",["T_WHITESPACE","\n            ",148],["T_CONSTANT_ENCAPSED_STRING","''",149],",",["T_WHITESPACE","\n            ",149],["T_STRING","false",150],["T_WHITESPACE","\n        ",150],")",";",["T_WHITESPACE","\n\n        ",151],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","setExpectedException",153],"(",["T_WHITESPACE","\n            ",153],["T_NS_SEPARATOR","\\",154],["T_STRING","Magento",154],["T_NS_SEPARATOR","\\",154],["T_STRING","Framework",154],["T_NS_SEPARATOR","\\",154],["T_STRING","Exception",154],["T_NS_SEPARATOR","\\",154],["T_STRING","LocalizedException",154],["T_DOUBLE_COLON","::",154],["T_CLASS","class",154],",",["T_WHITESPACE","\n            ",154],["T_STRING","__",155],"(",["T_CONSTANT_ENCAPSED_STRING","'Incorrect Security Checker class. It has to implement SecurityCheckerInterface'",155],")",["T_WHITESPACE","\n        ",155],")",";",["T_WHITESPACE","\n\n        ",156],["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","model",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","__construct",158],"(",["T_WHITESPACE","\n            ",158],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","securityConfigMock",159],",",["T_WHITESPACE","\n            ",159],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","passwordResetRequestEventFactoryMock",160],",",["T_WHITESPACE","\n            ",160],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","passwordResetRequestEventCollectionFactoryMock",161],",",["T_WHITESPACE","\n            ",161],["T_VARIABLE","$this",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","eventManagerMock",162],",",["T_WHITESPACE","\n            ",162],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","dateTimeMock",163],",",["T_WHITESPACE","\n            ",163],["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","remoteAddressMock",164],",",["T_WHITESPACE","\n            ",164],"[",["T_VARIABLE","$securityChecker",165],"]",["T_WHITESPACE","\n        ",165],")",";",["T_WHITESPACE","\n    ",166],"}",["T_WHITESPACE","\n\n    ",167],["T_DOC_COMMENT","\/**\n     * @return void\n     *\/",169],["T_WHITESPACE","\n    ",171],["T_PUBLIC","public",172],["T_WHITESPACE"," ",172],["T_FUNCTION","function",172],["T_WHITESPACE"," ",172],["T_STRING","testPerformSecurityCheck",172],"(",")",["T_WHITESPACE","\n    ",172],"{",["T_WHITESPACE","\n        ",173],["T_VARIABLE","$requestType",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_NS_SEPARATOR","\\",174],["T_STRING","Magento",174],["T_NS_SEPARATOR","\\",174],["T_STRING","Security",174],["T_NS_SEPARATOR","\\",174],["T_STRING","Model",174],["T_NS_SEPARATOR","\\",174],["T_STRING","PasswordResetRequestEvent",174],["T_DOUBLE_COLON","::",174],["T_STRING","CUSTOMER_PASSWORD_RESET_REQUEST",174],";",["T_WHITESPACE","\n        ",174],["T_VARIABLE","$accountReference",175],["T_WHITESPACE"," ",175],"=",["T_WHITESPACE"," ",175],["T_NS_SEPARATOR","\\",175],["T_STRING","Magento",175],["T_NS_SEPARATOR","\\",175],["T_STRING","Security",175],["T_NS_SEPARATOR","\\",175],["T_STRING","Model",175],["T_NS_SEPARATOR","\\",175],["T_STRING","Config",175],["T_NS_SEPARATOR","\\",175],["T_STRING","Source",175],["T_NS_SEPARATOR","\\",175],["T_STRING","ResetMethod",175],["T_DOUBLE_COLON","::",175],["T_STRING","OPTION_BY_IP_AND_EMAIL",175],";",["T_WHITESPACE","\n        ",175],["T_VARIABLE","$longIp",176],["T_WHITESPACE"," ",176],"=",["T_WHITESPACE"," ",176],["T_LNUMBER","12345",176],";",["T_WHITESPACE","\n\n        ",176],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","remoteAddressMock",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","expects",178],"(",["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","once",178],"(",")",")",["T_WHITESPACE","\n            ",178],["T_OBJECT_OPERATOR","->",179],["T_STRING","method",179],"(",["T_CONSTANT_ENCAPSED_STRING","'getRemoteAddress'",179],")",["T_WHITESPACE","\n            ",179],["T_OBJECT_OPERATOR","->",180],["T_STRING","will",180],"(",["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","returnValue",180],"(",["T_VARIABLE","$longIp",180],")",")",";",["T_WHITESPACE","\n\n        ",180],["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","passwordResetRequestEventFactoryMock",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","expects",182],"(",["T_VARIABLE","$this",182],["T_OBJECT_OPERATOR","->",182],["T_STRING","once",182],"(",")",")",["T_WHITESPACE","\n            ",182],["T_OBJECT_OPERATOR","->",183],["T_STRING","method",183],"(",["T_CONSTANT_ENCAPSED_STRING","'create'",183],")",["T_WHITESPACE","\n            ",183],["T_OBJECT_OPERATOR","->",184],["T_STRING","willReturn",184],"(",["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","passwordResetRequestEventMock",184],")",";",["T_WHITESPACE","\n\n        ",184],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","passwordResetRequestEventMock",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","expects",186],"(",["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","once",186],"(",")",")",["T_WHITESPACE","\n            ",186],["T_OBJECT_OPERATOR","->",187],["T_STRING","method",187],"(",["T_CONSTANT_ENCAPSED_STRING","'setRequestType'",187],")",["T_WHITESPACE","\n            ",187],["T_OBJECT_OPERATOR","->",188],["T_STRING","with",188],"(",["T_VARIABLE","$requestType",188],")",["T_WHITESPACE","\n            ",188],["T_OBJECT_OPERATOR","->",189],["T_STRING","willReturnSelf",189],"(",")",";",["T_WHITESPACE","\n\n        ",189],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","passwordResetRequestEventMock",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","expects",191],"(",["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","once",191],"(",")",")",["T_WHITESPACE","\n            ",191],["T_OBJECT_OPERATOR","->",192],["T_STRING","method",192],"(",["T_CONSTANT_ENCAPSED_STRING","'setAccountReference'",192],")",["T_WHITESPACE","\n            ",192],["T_OBJECT_OPERATOR","->",193],["T_STRING","with",193],"(",["T_VARIABLE","$accountReference",193],")",["T_WHITESPACE","\n            ",193],["T_OBJECT_OPERATOR","->",194],["T_STRING","willReturnSelf",194],"(",")",";",["T_WHITESPACE","\n\n        ",194],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","passwordResetRequestEventMock",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","expects",196],"(",["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","once",196],"(",")",")",["T_WHITESPACE","\n            ",196],["T_OBJECT_OPERATOR","->",197],["T_STRING","method",197],"(",["T_CONSTANT_ENCAPSED_STRING","'setIp'",197],")",["T_WHITESPACE","\n            ",197],["T_OBJECT_OPERATOR","->",198],["T_STRING","with",198],"(",["T_VARIABLE","$longIp",198],")",["T_WHITESPACE","\n            ",198],["T_OBJECT_OPERATOR","->",199],["T_STRING","willReturnSelf",199],"(",")",";",["T_WHITESPACE","\n\n        ",199],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","passwordResetRequestEventMock",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","expects",201],"(",["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","once",201],"(",")",")",["T_WHITESPACE","\n            ",201],["T_OBJECT_OPERATOR","->",202],["T_STRING","method",202],"(",["T_CONSTANT_ENCAPSED_STRING","'save'",202],")",["T_WHITESPACE","\n            ",202],["T_OBJECT_OPERATOR","->",203],["T_STRING","willReturnSelf",203],"(",")",";",["T_WHITESPACE","\n\n        ",203],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","model",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","performSecurityCheck",205],"(",["T_VARIABLE","$requestType",205],",",["T_WHITESPACE"," ",205],["T_VARIABLE","$accountReference",205],")",";",["T_WHITESPACE","\n    ",205],"}",["T_WHITESPACE","\n\n    ",206],["T_DOC_COMMENT","\/**\n     * @return void\n     *\/",208],["T_WHITESPACE","\n    ",210],["T_PUBLIC","public",211],["T_WHITESPACE"," ",211],["T_FUNCTION","function",211],["T_WHITESPACE"," ",211],["T_STRING","testCleanExpiredRecords",211],"(",")",["T_WHITESPACE","\n    ",211],"{",["T_WHITESPACE","\n        ",212],["T_VARIABLE","$timestamp",213],["T_WHITESPACE"," ",213],"=",["T_WHITESPACE"," ",213],["T_STRING","time",213],"(",")",";",["T_WHITESPACE","\n\n        ",213],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","passwordResetRequestEventCollectionFactoryMock",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","expects",215],"(",["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","once",215],"(",")",")",["T_WHITESPACE","\n            ",215],["T_OBJECT_OPERATOR","->",216],["T_STRING","method",216],"(",["T_CONSTANT_ENCAPSED_STRING","'create'",216],")",["T_WHITESPACE","\n            ",216],["T_OBJECT_OPERATOR","->",217],["T_STRING","willReturn",217],"(",["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","passwordResetRequestEventCollectionMock",217],")",";",["T_WHITESPACE","\n\n        ",217],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","dateTimeMock",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","expects",219],"(",["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","once",219],"(",")",")",["T_WHITESPACE","\n            ",219],["T_OBJECT_OPERATOR","->",220],["T_STRING","method",220],"(",["T_CONSTANT_ENCAPSED_STRING","'gmtTimestamp'",220],")",["T_WHITESPACE","\n            ",220],["T_OBJECT_OPERATOR","->",221],["T_STRING","willReturn",221],"(",["T_VARIABLE","$timestamp",221],")",";",["T_WHITESPACE","\n\n        ",221],["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","passwordResetRequestEventCollectionMock",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","expects",223],"(",["T_VARIABLE","$this",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","once",223],"(",")",")",["T_WHITESPACE","\n            ",223],["T_OBJECT_OPERATOR","->",224],["T_STRING","method",224],"(",["T_CONSTANT_ENCAPSED_STRING","'deleteRecordsOlderThen'",224],")",["T_WHITESPACE","\n            ",224],["T_OBJECT_OPERATOR","->",225],["T_STRING","with",225],"(",["T_WHITESPACE","\n                ",225],["T_VARIABLE","$timestamp",226],["T_WHITESPACE"," ",226],"-",["T_WHITESPACE"," ",226],["T_NS_SEPARATOR","\\",226],["T_STRING","Magento",226],["T_NS_SEPARATOR","\\",226],["T_STRING","Security",226],["T_NS_SEPARATOR","\\",226],["T_STRING","Model",226],["T_NS_SEPARATOR","\\",226],["T_STRING","SecurityManager",226],["T_DOUBLE_COLON","::",226],["T_STRING","SECURITY_CONTROL_RECORDS_LIFE_TIME",226],["T_WHITESPACE","\n            ",226],")",["T_WHITESPACE","\n            ",227],["T_OBJECT_OPERATOR","->",228],["T_STRING","willReturnSelf",228],"(",")",";",["T_WHITESPACE","\n\n        ",228],["T_VARIABLE","$this",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","model",230],["T_OBJECT_OPERATOR","->",230],["T_STRING","cleanExpiredRecords",230],"(",")",";",["T_WHITESPACE","\n    ",230],"}",["T_WHITESPACE","\n",231],"}",["T_WHITESPACE","\n",232]]