[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Security",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Test",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Unit",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Model",7],["T_NS_SEPARATOR","\\",7],["T_STRING","SecurityChecker",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","TestFramework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Unit",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Helper",9],["T_NS_SEPARATOR","\\",9],["T_STRING","ObjectManager",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Security",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Model",10],["T_NS_SEPARATOR","\\",10],["T_STRING","ConfigInterface",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Security",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Model",11],["T_NS_SEPARATOR","\\",11],["T_STRING","ResourceModel",11],["T_NS_SEPARATOR","\\",11],["T_STRING","PasswordResetRequestEvent",11],["T_NS_SEPARATOR","\\",11],["T_STRING","CollectionFactory",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Security",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Model",12],["T_NS_SEPARATOR","\\",12],["T_STRING","ResourceModel",12],["T_NS_SEPARATOR","\\",12],["T_STRING","PasswordResetRequestEvent",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Collection",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Framework",13],["T_NS_SEPARATOR","\\",13],["T_STRING","HTTP",13],["T_NS_SEPARATOR","\\",13],["T_STRING","PhpEnvironment",13],["T_NS_SEPARATOR","\\",13],["T_STRING","RemoteAddress",13],";",["T_WHITESPACE","\n\n",13],["T_DOC_COMMENT","\/**\n * Test class for \\Magento\\Security\\Model\\SecurityChecker\\Quantity testing\n *\/",15],["T_WHITESPACE","\n",17],["T_CLASS","class",18],["T_WHITESPACE"," ",18],["T_STRING","QuantityTest",18],["T_WHITESPACE"," ",18],["T_EXTENDS","extends",18],["T_WHITESPACE"," ",18],["T_NS_SEPARATOR","\\",18],["T_STRING","PHPUnit_Framework_TestCase",18],["T_WHITESPACE","\n",18],"{",["T_WHITESPACE","\n    ",19],["T_DOC_COMMENT","\/**\n     * @var  \\Magento\\Security\\Model\\SecurityChecker\\Quantity\n     *\/",20],["T_WHITESPACE","\n    ",22],["T_PROTECTED","protected",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$model",23],";",["T_WHITESPACE","\n\n    ",23],["T_DOC_COMMENT","\/**\n     * @var ConfigInterface | \\PHPUnit_Framework_MockObject_MockObject\n     *\/",25],["T_WHITESPACE","\n    ",27],["T_PROTECTED","protected",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$securityConfigMock",28],";",["T_WHITESPACE","\n\n    ",28],["T_DOC_COMMENT","\/**\n     * @var CollectionFactory | \\PHPUnit_Framework_MockObject_MockObject\n     *\/",30],["T_WHITESPACE","\n    ",32],["T_PROTECTED","protected",33],["T_WHITESPACE"," ",33],["T_VARIABLE","$collectionFactoryMock",33],";",["T_WHITESPACE","\n\n    ",33],["T_DOC_COMMENT","\/**\n     * @var Collection | \\PHPUnit_Framework_MockObject_MockObject\n     *\/",35],["T_WHITESPACE","\n    ",37],["T_PROTECTED","protected",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$collectionMock",38],";",["T_WHITESPACE","\n\n    ",38],["T_DOC_COMMENT","\/**\n     * @var  \\Magento\\Framework\\TestFramework\\Unit\\Helper\\ObjectManager\n     *\/",40],["T_WHITESPACE","\n    ",42],["T_PROTECTED","protected",43],["T_WHITESPACE"," ",43],["T_VARIABLE","$objectManager",43],";",["T_WHITESPACE","\n\n    ",43],["T_COMMENT","\/*\n     * @var RemoteAddress\n     *\/",45],["T_WHITESPACE","\n    ",47],["T_PROTECTED","protected",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$remoteAddressMock",48],";",["T_WHITESPACE","\n\n    ",48],["T_DOC_COMMENT","\/**\n     * Init mocks for tests\n     * @return void\n     *\/",50],["T_WHITESPACE","\n    ",53],["T_PUBLIC","public",54],["T_WHITESPACE"," ",54],["T_FUNCTION","function",54],["T_WHITESPACE"," ",54],["T_STRING","setUp",54],"(",")",["T_WHITESPACE","\n    ",54],"{",["T_WHITESPACE","\n        ",55],["T_VARIABLE","$this",56],["T_OBJECT_OPERATOR","->",56],["T_STRING","objectManager",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_NEW","new",56],["T_WHITESPACE"," ",56],["T_STRING","ObjectManager",56],"(",["T_VARIABLE","$this",56],")",";",["T_WHITESPACE","\n        ",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","securityConfigMock",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE","  ",57],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","getMockBuilder",57],"(",["T_NS_SEPARATOR","\\",57],["T_STRING","Magento",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Security",57],["T_NS_SEPARATOR","\\",57],["T_STRING","Model",57],["T_NS_SEPARATOR","\\",57],["T_STRING","ConfigInterface",57],["T_DOUBLE_COLON","::",57],["T_CLASS","class",57],")",["T_WHITESPACE","\n            ",57],["T_OBJECT_OPERATOR","->",58],["T_STRING","disableOriginalConstructor",58],"(",")",["T_WHITESPACE","\n            ",58],["T_OBJECT_OPERATOR","->",59],["T_STRING","setMethods",59],"(","[","]",")",["T_WHITESPACE","\n            ",59],["T_OBJECT_OPERATOR","->",60],["T_STRING","getMock",60],"(",")",";",["T_WHITESPACE","\n        ",60],["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","securityConfigMock",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","expects",61],"(",["T_VARIABLE","$this",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","any",61],"(",")",")",["T_WHITESPACE","\n            ",61],["T_OBJECT_OPERATOR","->",62],["T_STRING","method",62],"(",["T_CONSTANT_ENCAPSED_STRING","'getScopeByEventType'",62],")",["T_WHITESPACE","\n            ",62],["T_OBJECT_OPERATOR","->",63],["T_STRING","willReturnMap",63],"(",["T_WHITESPACE","\n                ",63],"[",["T_WHITESPACE","\n                    ",64],"[",["T_LNUMBER","0",65],",",["T_WHITESPACE"," ",65],["T_LNUMBER","1",65],"]",",",["T_WHITESPACE","\n                    ",65],"[",["T_LNUMBER","1",66],",",["T_WHITESPACE"," ",66],["T_LNUMBER","0",66],"]",["T_WHITESPACE","\n                ",66],"]",["T_WHITESPACE","\n            ",67],")",";",["T_WHITESPACE","\n\n        ",68],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","collectionFactoryMock",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","getMock",70],"(",["T_WHITESPACE","\n            ",70],["T_NS_SEPARATOR","\\",71],["T_STRING","Magento",71],["T_NS_SEPARATOR","\\",71],["T_STRING","Security",71],["T_NS_SEPARATOR","\\",71],["T_STRING","Model",71],["T_NS_SEPARATOR","\\",71],["T_STRING","ResourceModel",71],["T_NS_SEPARATOR","\\",71],["T_STRING","PasswordResetRequestEvent",71],["T_NS_SEPARATOR","\\",71],["T_STRING","CollectionFactory",71],["T_DOUBLE_COLON","::",71],["T_CLASS","class",71],",",["T_WHITESPACE","\n            ",71],"[",["T_CONSTANT_ENCAPSED_STRING","'create'",72],"]",",",["T_WHITESPACE","\n            ",72],"[","]",",",["T_WHITESPACE","\n            ",73],["T_CONSTANT_ENCAPSED_STRING","''",74],",",["T_WHITESPACE","\n            ",74],["T_STRING","false",75],["T_WHITESPACE","\n        ",75],")",";",["T_WHITESPACE","\n\n        ",76],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","collectionMock",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","getMock",78],"(",["T_WHITESPACE","\n            ",78],["T_NS_SEPARATOR","\\",79],["T_STRING","Magento",79],["T_NS_SEPARATOR","\\",79],["T_STRING","Security",79],["T_NS_SEPARATOR","\\",79],["T_STRING","Model",79],["T_NS_SEPARATOR","\\",79],["T_STRING","ResourceModel",79],["T_NS_SEPARATOR","\\",79],["T_STRING","PasswordResetRequestEvent",79],["T_NS_SEPARATOR","\\",79],["T_STRING","Collection",79],["T_DOUBLE_COLON","::",79],["T_CLASS","class",79],",",["T_WHITESPACE","\n            ",79],"[",["T_CONSTANT_ENCAPSED_STRING","'addFieldToFilter'",80],",",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'filterByLifetime'",80],",",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'count'",80],"]",",",["T_WHITESPACE","\n            ",80],"[","]",",",["T_WHITESPACE","\n            ",81],["T_CONSTANT_ENCAPSED_STRING","''",82],",",["T_WHITESPACE","\n            ",82],["T_STRING","false",83],["T_WHITESPACE","\n        ",83],")",";",["T_WHITESPACE","\n\n        ",84],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","remoteAddressMock",86],["T_WHITESPACE"," ",86],"=",["T_WHITESPACE","  ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getMockBuilder",86],"(",["T_STRING","RemoteAddress",86],["T_DOUBLE_COLON","::",86],["T_CLASS","class",86],")",["T_WHITESPACE","\n            ",86],["T_OBJECT_OPERATOR","->",87],["T_STRING","disableOriginalConstructor",87],"(",")",["T_WHITESPACE","\n            ",87],["T_OBJECT_OPERATOR","->",88],["T_STRING","getMock",88],"(",")",";",["T_WHITESPACE","\n\n        ",88],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","model",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","objectManager",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","getObject",90],"(",["T_WHITESPACE","\n            ",90],["T_NS_SEPARATOR","\\",91],["T_STRING","Magento",91],["T_NS_SEPARATOR","\\",91],["T_STRING","Security",91],["T_NS_SEPARATOR","\\",91],["T_STRING","Model",91],["T_NS_SEPARATOR","\\",91],["T_STRING","SecurityChecker",91],["T_NS_SEPARATOR","\\",91],["T_STRING","Quantity",91],["T_DOUBLE_COLON","::",91],["T_CLASS","class",91],",",["T_WHITESPACE","\n            ",91],"[",["T_WHITESPACE","\n                ",92],["T_CONSTANT_ENCAPSED_STRING","'securityConfig'",93],["T_WHITESPACE"," ",93],["T_DOUBLE_ARROW","=>",93],["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","securityConfigMock",93],",",["T_WHITESPACE","\n                ",93],["T_CONSTANT_ENCAPSED_STRING","'collectionFactory'",94],["T_WHITESPACE"," ",94],["T_DOUBLE_ARROW","=>",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","collectionFactoryMock",94],",",["T_WHITESPACE","\n                ",94],["T_CONSTANT_ENCAPSED_STRING","'remoteAddress'",95],["T_WHITESPACE"," ",95],["T_DOUBLE_ARROW","=>",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","remoteAddressMock",95],["T_WHITESPACE","\n            ",95],"]",["T_WHITESPACE","\n        ",96],")",";",["T_WHITESPACE","\n    ",97],"}",["T_WHITESPACE","\n\n    ",98],["T_DOC_COMMENT","\/**\n     * @param int $securityEventType\n     * @param int $requestsMethod\n     * @dataProvider dataProviderSecurityEventTypeWithRequestsMethod\n     *\/",100],["T_WHITESPACE","\n    ",104],["T_PUBLIC","public",105],["T_WHITESPACE"," ",105],["T_FUNCTION","function",105],["T_WHITESPACE"," ",105],["T_STRING","testCheck",105],"(",["T_VARIABLE","$securityEventType",105],",",["T_WHITESPACE"," ",105],["T_VARIABLE","$requestsMethod",105],")",["T_WHITESPACE","\n    ",105],"{",["T_WHITESPACE","\n        ",106],["T_VARIABLE","$limitNumberPasswordResetRequests",107],["T_WHITESPACE"," ",107],"=",["T_WHITESPACE"," ",107],["T_LNUMBER","10",107],";",["T_WHITESPACE","\n\n        ",107],["T_VARIABLE","$this",109],["T_OBJECT_OPERATOR","->",109],["T_STRING","prepareTestCheck",109],"(",["T_VARIABLE","$requestsMethod",109],",",["T_WHITESPACE"," ",109],["T_VARIABLE","$limitNumberPasswordResetRequests",109],")",";",["T_WHITESPACE","\n\n        ",109],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","collectionMock",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","expects",111],"(",["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","once",111],"(",")",")",["T_WHITESPACE","\n            ",111],["T_OBJECT_OPERATOR","->",112],["T_STRING","method",112],"(",["T_CONSTANT_ENCAPSED_STRING","'count'",112],")",["T_WHITESPACE","\n            ",112],["T_OBJECT_OPERATOR","->",113],["T_STRING","willReturn",113],"(",["T_VARIABLE","$limitNumberPasswordResetRequests",113],["T_WHITESPACE"," ",113],"-",["T_WHITESPACE"," ",113],["T_LNUMBER","1",113],")",";",["T_WHITESPACE","\n\n        ",113],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","model",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","check",115],"(",["T_VARIABLE","$securityEventType",115],")",";",["T_WHITESPACE","\n    ",115],"}",["T_WHITESPACE","\n\n    ",116],["T_DOC_COMMENT","\/**\n     * @param int $securityEventType\n     * @param int $requestsMethod\n     * @dataProvider dataProviderSecurityEventTypeWithRequestsMethod\n     * @expectedException \\Magento\\Framework\\Exception\\SecurityViolationException\n     * @expectedExceptionMessage Too many password reset requests. Please wait and try again or contact test@host.com.\n     *\/",118],["T_WHITESPACE","\n    ",124],["T_PUBLIC","public",125],["T_WHITESPACE"," ",125],["T_FUNCTION","function",125],["T_WHITESPACE"," ",125],["T_STRING","testCheckException",125],"(",["T_VARIABLE","$securityEventType",125],",",["T_WHITESPACE"," ",125],["T_VARIABLE","$requestsMethod",125],")",["T_WHITESPACE","\n    ",125],"{",["T_WHITESPACE","\n        ",126],["T_VARIABLE","$limitNumberPasswordResetRequests",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_LNUMBER","10",127],";",["T_WHITESPACE","\n\n        ",127],["T_VARIABLE","$this",129],["T_OBJECT_OPERATOR","->",129],["T_STRING","prepareTestCheck",129],"(",["T_VARIABLE","$requestsMethod",129],",",["T_WHITESPACE"," ",129],["T_VARIABLE","$limitNumberPasswordResetRequests",129],")",";",["T_WHITESPACE","\n\n        ",129],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","collectionMock",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","expects",131],"(",["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","once",131],"(",")",")",["T_WHITESPACE","\n            ",131],["T_OBJECT_OPERATOR","->",132],["T_STRING","method",132],"(",["T_CONSTANT_ENCAPSED_STRING","'count'",132],")",["T_WHITESPACE","\n            ",132],["T_OBJECT_OPERATOR","->",133],["T_STRING","willReturn",133],"(",["T_VARIABLE","$limitNumberPasswordResetRequests",133],")",";",["T_WHITESPACE","\n\n        ",133],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","model",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","check",135],"(",["T_VARIABLE","$securityEventType",135],")",";",["T_WHITESPACE","\n    ",135],"}",["T_WHITESPACE","\n\n    ",136],["T_DOC_COMMENT","\/**\n     * @return array\n     *\/",138],["T_WHITESPACE","\n    ",140],["T_PUBLIC","public",141],["T_WHITESPACE"," ",141],["T_FUNCTION","function",141],["T_WHITESPACE"," ",141],["T_STRING","dataProviderSecurityEventTypeWithRequestsMethod",141],"(",")",["T_WHITESPACE","\n    ",141],"{",["T_WHITESPACE","\n        ",142],["T_RETURN","return",143],["T_WHITESPACE"," ",143],"[",["T_WHITESPACE","\n            ",143],"[",["T_WHITESPACE","\n                ",144],["T_NS_SEPARATOR","\\",145],["T_STRING","Magento",145],["T_NS_SEPARATOR","\\",145],["T_STRING","Security",145],["T_NS_SEPARATOR","\\",145],["T_STRING","Model",145],["T_NS_SEPARATOR","\\",145],["T_STRING","PasswordResetRequestEvent",145],["T_DOUBLE_COLON","::",145],["T_STRING","CUSTOMER_PASSWORD_RESET_REQUEST",145],",",["T_WHITESPACE","\n                ",145],["T_NS_SEPARATOR","\\",146],["T_STRING","Magento",146],["T_NS_SEPARATOR","\\",146],["T_STRING","Security",146],["T_NS_SEPARATOR","\\",146],["T_STRING","Model",146],["T_NS_SEPARATOR","\\",146],["T_STRING","Config",146],["T_NS_SEPARATOR","\\",146],["T_STRING","Source",146],["T_NS_SEPARATOR","\\",146],["T_STRING","ResetMethod",146],["T_DOUBLE_COLON","::",146],["T_STRING","OPTION_BY_IP_AND_EMAIL",146],["T_WHITESPACE","\n            ",146],"]",",",["T_WHITESPACE","\n            ",147],"[",["T_WHITESPACE","\n                ",148],["T_NS_SEPARATOR","\\",149],["T_STRING","Magento",149],["T_NS_SEPARATOR","\\",149],["T_STRING","Security",149],["T_NS_SEPARATOR","\\",149],["T_STRING","Model",149],["T_NS_SEPARATOR","\\",149],["T_STRING","PasswordResetRequestEvent",149],["T_DOUBLE_COLON","::",149],["T_STRING","CUSTOMER_PASSWORD_RESET_REQUEST",149],",",["T_WHITESPACE","\n                ",149],["T_NS_SEPARATOR","\\",150],["T_STRING","Magento",150],["T_NS_SEPARATOR","\\",150],["T_STRING","Security",150],["T_NS_SEPARATOR","\\",150],["T_STRING","Model",150],["T_NS_SEPARATOR","\\",150],["T_STRING","Config",150],["T_NS_SEPARATOR","\\",150],["T_STRING","Source",150],["T_NS_SEPARATOR","\\",150],["T_STRING","ResetMethod",150],["T_DOUBLE_COLON","::",150],["T_STRING","OPTION_BY_IP",150],["T_WHITESPACE","\n            ",150],"]",",",["T_WHITESPACE","\n            ",151],"[",["T_WHITESPACE","\n                ",152],["T_NS_SEPARATOR","\\",153],["T_STRING","Magento",153],["T_NS_SEPARATOR","\\",153],["T_STRING","Security",153],["T_NS_SEPARATOR","\\",153],["T_STRING","Model",153],["T_NS_SEPARATOR","\\",153],["T_STRING","PasswordResetRequestEvent",153],["T_DOUBLE_COLON","::",153],["T_STRING","CUSTOMER_PASSWORD_RESET_REQUEST",153],",",["T_WHITESPACE","\n                ",153],["T_NS_SEPARATOR","\\",154],["T_STRING","Magento",154],["T_NS_SEPARATOR","\\",154],["T_STRING","Security",154],["T_NS_SEPARATOR","\\",154],["T_STRING","Model",154],["T_NS_SEPARATOR","\\",154],["T_STRING","Config",154],["T_NS_SEPARATOR","\\",154],["T_STRING","Source",154],["T_NS_SEPARATOR","\\",154],["T_STRING","ResetMethod",154],["T_DOUBLE_COLON","::",154],["T_STRING","OPTION_BY_EMAIL",154],["T_WHITESPACE","\n            ",154],"]",",",["T_WHITESPACE","\n            ",155],"[",["T_WHITESPACE","\n                ",156],["T_NS_SEPARATOR","\\",157],["T_STRING","Magento",157],["T_NS_SEPARATOR","\\",157],["T_STRING","Security",157],["T_NS_SEPARATOR","\\",157],["T_STRING","Model",157],["T_NS_SEPARATOR","\\",157],["T_STRING","PasswordResetRequestEvent",157],["T_DOUBLE_COLON","::",157],["T_STRING","ADMIN_PASSWORD_RESET_REQUEST",157],",",["T_WHITESPACE","\n                ",157],["T_NS_SEPARATOR","\\",158],["T_STRING","Magento",158],["T_NS_SEPARATOR","\\",158],["T_STRING","Security",158],["T_NS_SEPARATOR","\\",158],["T_STRING","Model",158],["T_NS_SEPARATOR","\\",158],["T_STRING","Config",158],["T_NS_SEPARATOR","\\",158],["T_STRING","Source",158],["T_NS_SEPARATOR","\\",158],["T_STRING","ResetMethod",158],["T_DOUBLE_COLON","::",158],["T_STRING","OPTION_BY_IP_AND_EMAIL",158],["T_WHITESPACE","\n            ",158],"]",",",["T_WHITESPACE","\n            ",159],"[",["T_WHITESPACE","\n                ",160],["T_NS_SEPARATOR","\\",161],["T_STRING","Magento",161],["T_NS_SEPARATOR","\\",161],["T_STRING","Security",161],["T_NS_SEPARATOR","\\",161],["T_STRING","Model",161],["T_NS_SEPARATOR","\\",161],["T_STRING","PasswordResetRequestEvent",161],["T_DOUBLE_COLON","::",161],["T_STRING","ADMIN_PASSWORD_RESET_REQUEST",161],",",["T_WHITESPACE","\n                ",161],["T_NS_SEPARATOR","\\",162],["T_STRING","Magento",162],["T_NS_SEPARATOR","\\",162],["T_STRING","Security",162],["T_NS_SEPARATOR","\\",162],["T_STRING","Model",162],["T_NS_SEPARATOR","\\",162],["T_STRING","Config",162],["T_NS_SEPARATOR","\\",162],["T_STRING","Source",162],["T_NS_SEPARATOR","\\",162],["T_STRING","ResetMethod",162],["T_DOUBLE_COLON","::",162],["T_STRING","OPTION_BY_IP",162],["T_WHITESPACE","\n            ",162],"]",",",["T_WHITESPACE","\n            ",163],"[",["T_WHITESPACE","\n                ",164],["T_NS_SEPARATOR","\\",165],["T_STRING","Magento",165],["T_NS_SEPARATOR","\\",165],["T_STRING","Security",165],["T_NS_SEPARATOR","\\",165],["T_STRING","Model",165],["T_NS_SEPARATOR","\\",165],["T_STRING","PasswordResetRequestEvent",165],["T_DOUBLE_COLON","::",165],["T_STRING","ADMIN_PASSWORD_RESET_REQUEST",165],",",["T_WHITESPACE","\n                ",165],["T_NS_SEPARATOR","\\",166],["T_STRING","Magento",166],["T_NS_SEPARATOR","\\",166],["T_STRING","Security",166],["T_NS_SEPARATOR","\\",166],["T_STRING","Model",166],["T_NS_SEPARATOR","\\",166],["T_STRING","Config",166],["T_NS_SEPARATOR","\\",166],["T_STRING","Source",166],["T_NS_SEPARATOR","\\",166],["T_STRING","ResetMethod",166],["T_DOUBLE_COLON","::",166],["T_STRING","OPTION_BY_EMAIL",166],["T_WHITESPACE","\n            ",166],"]",["T_WHITESPACE","\n        ",167],"]",";",["T_WHITESPACE","\n    ",168],"}",["T_WHITESPACE","\n\n    ",169],["T_DOC_COMMENT","\/**\n     * @param int $requestsMethod\n     * @param int $limitNumberPasswordResetRequests\n     *\/",171],["T_WHITESPACE","\n    ",174],["T_PROTECTED","protected",175],["T_WHITESPACE"," ",175],["T_FUNCTION","function",175],["T_WHITESPACE"," ",175],["T_STRING","prepareTestCheck",175],"(",["T_VARIABLE","$requestsMethod",175],",",["T_WHITESPACE"," ",175],["T_VARIABLE","$limitNumberPasswordResetRequests",175],")",["T_WHITESPACE","\n    ",175],"{",["T_WHITESPACE","\n        ",176],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","remoteAddressMock",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","expects",177],"(",["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","any",177],"(",")",")",["T_WHITESPACE","\n            ",177],["T_OBJECT_OPERATOR","->",178],["T_STRING","method",178],"(",["T_CONSTANT_ENCAPSED_STRING","'getRemoteAddress'",178],")",["T_WHITESPACE","\n            ",178],["T_OBJECT_OPERATOR","->",179],["T_STRING","will",179],"(",["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","returnValue",179],"(",["T_LNUMBER","12345",179],")",")",";",["T_WHITESPACE","\n\n        ",179],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","securityConfigMock",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","expects",181],"(",["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","any",181],"(",")",")",["T_WHITESPACE","\n            ",181],["T_OBJECT_OPERATOR","->",182],["T_STRING","method",182],"(",["T_CONSTANT_ENCAPSED_STRING","'getPasswordResetProtectionType'",182],")",["T_WHITESPACE","\n            ",182],["T_OBJECT_OPERATOR","->",183],["T_STRING","will",183],"(",["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","returnValue",183],"(",["T_VARIABLE","$requestsMethod",183],")",")",";",["T_WHITESPACE","\n\n        ",183],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","securityConfigMock",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","expects",185],"(",["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","once",185],"(",")",")",["T_WHITESPACE","\n            ",185],["T_OBJECT_OPERATOR","->",186],["T_STRING","method",186],"(",["T_CONSTANT_ENCAPSED_STRING","'getMaxNumberPasswordResetRequests'",186],")",["T_WHITESPACE","\n            ",186],["T_OBJECT_OPERATOR","->",187],["T_STRING","will",187],"(",["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","returnValue",187],"(",["T_VARIABLE","$limitNumberPasswordResetRequests",187],")",")",";",["T_WHITESPACE","\n\n        ",187],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","securityConfigMock",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","expects",189],"(",["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","any",189],"(",")",")",["T_WHITESPACE","\n            ",189],["T_OBJECT_OPERATOR","->",190],["T_STRING","method",190],"(",["T_CONSTANT_ENCAPSED_STRING","'getCustomerServiceEmail'",190],")",["T_WHITESPACE","\n            ",190],["T_OBJECT_OPERATOR","->",191],["T_STRING","will",191],"(",["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","returnValue",191],"(",["T_CONSTANT_ENCAPSED_STRING","'test@host.com'",191],")",")",";",["T_WHITESPACE","\n\n        ",191],["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","collectionFactoryMock",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","expects",193],"(",["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","once",193],"(",")",")",["T_WHITESPACE","\n            ",193],["T_OBJECT_OPERATOR","->",194],["T_STRING","method",194],"(",["T_CONSTANT_ENCAPSED_STRING","'create'",194],")",["T_WHITESPACE","\n            ",194],["T_OBJECT_OPERATOR","->",195],["T_STRING","willReturn",195],"(",["T_VARIABLE","$this",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","collectionMock",195],")",";",["T_WHITESPACE","\n\n        ",195],["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","collectionMock",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","expects",197],"(",["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","any",197],"(",")",")",["T_WHITESPACE","\n            ",197],["T_OBJECT_OPERATOR","->",198],["T_STRING","method",198],"(",["T_CONSTANT_ENCAPSED_STRING","'addFieldToFilter'",198],")",["T_WHITESPACE","\n            ",198],["T_OBJECT_OPERATOR","->",199],["T_STRING","willReturnSelf",199],"(",")",";",["T_WHITESPACE","\n\n        ",199],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","collectionMock",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","expects",201],"(",["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","once",201],"(",")",")",["T_WHITESPACE","\n            ",201],["T_OBJECT_OPERATOR","->",202],["T_STRING","method",202],"(",["T_CONSTANT_ENCAPSED_STRING","'filterByLifetime'",202],")",["T_WHITESPACE","\n            ",202],["T_OBJECT_OPERATOR","->",203],["T_STRING","willReturnSelf",203],"(",")",";",["T_WHITESPACE","\n    ",203],"}",["T_WHITESPACE","\n",204],"}",["T_WHITESPACE","\n",205]]