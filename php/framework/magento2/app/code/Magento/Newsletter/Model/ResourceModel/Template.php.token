[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_COMMENT","\/\/ @codingStandardsIgnoreFile\n",7],["T_WHITESPACE","\n",8],["T_NAMESPACE","namespace",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Newsletter",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Model",9],["T_NS_SEPARATOR","\\",9],["T_STRING","ResourceModel",9],";",["T_WHITESPACE","\n\n",9],["T_DOC_COMMENT","\/**\n * Newsletter template resource model\n *\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",11],["T_WHITESPACE","\n",15],["T_CLASS","class",16],["T_WHITESPACE"," ",16],["T_STRING","Template",16],["T_WHITESPACE"," ",16],["T_EXTENDS","extends",16],["T_WHITESPACE"," ",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Magento",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Framework",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Model",16],["T_NS_SEPARATOR","\\",16],["T_STRING","ResourceModel",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Db",16],["T_NS_SEPARATOR","\\",16],["T_STRING","AbstractDb",16],["T_WHITESPACE","\n",16],"{",["T_WHITESPACE","\n    ",17],["T_DOC_COMMENT","\/**\n     * Date\n     *\n     * @var \\Magento\\Framework\\Stdlib\\DateTime\\DateTime\n     *\/",18],["T_WHITESPACE","\n    ",22],["T_PROTECTED","protected",23],["T_WHITESPACE"," ",23],["T_VARIABLE","$_date",23],";",["T_WHITESPACE","\n\n    ",23],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\Model\\ResourceModel\\Db\\Context $context\n     * @param \\Magento\\Framework\\Stdlib\\DateTime\\DateTime $date\n     * @param string $connectionName\n     *\/",25],["T_WHITESPACE","\n    ",29],["T_PUBLIC","public",30],["T_WHITESPACE"," ",30],["T_FUNCTION","function",30],["T_WHITESPACE"," ",30],["T_STRING","__construct",30],"(",["T_WHITESPACE","\n        ",30],["T_NS_SEPARATOR","\\",31],["T_STRING","Magento",31],["T_NS_SEPARATOR","\\",31],["T_STRING","Framework",31],["T_NS_SEPARATOR","\\",31],["T_STRING","Model",31],["T_NS_SEPARATOR","\\",31],["T_STRING","ResourceModel",31],["T_NS_SEPARATOR","\\",31],["T_STRING","Db",31],["T_NS_SEPARATOR","\\",31],["T_STRING","Context",31],["T_WHITESPACE"," ",31],["T_VARIABLE","$context",31],",",["T_WHITESPACE","\n        ",31],["T_NS_SEPARATOR","\\",32],["T_STRING","Magento",32],["T_NS_SEPARATOR","\\",32],["T_STRING","Framework",32],["T_NS_SEPARATOR","\\",32],["T_STRING","Stdlib",32],["T_NS_SEPARATOR","\\",32],["T_STRING","DateTime",32],["T_NS_SEPARATOR","\\",32],["T_STRING","DateTime",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$date",32],",",["T_WHITESPACE","\n        ",32],["T_VARIABLE","$connectionName",33],["T_WHITESPACE"," ",33],"=",["T_WHITESPACE"," ",33],["T_STRING","null",33],["T_WHITESPACE","\n    ",33],")",["T_WHITESPACE"," ",34],"{",["T_WHITESPACE","\n        ",34],["T_STRING","parent",35],["T_DOUBLE_COLON","::",35],["T_STRING","__construct",35],"(",["T_VARIABLE","$context",35],",",["T_WHITESPACE"," ",35],["T_VARIABLE","$connectionName",35],")",";",["T_WHITESPACE","\n        ",35],["T_VARIABLE","$this",36],["T_OBJECT_OPERATOR","->",36],["T_STRING","_date",36],["T_WHITESPACE"," ",36],"=",["T_WHITESPACE"," ",36],["T_VARIABLE","$date",36],";",["T_WHITESPACE","\n    ",36],"}",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * Initialize connection\n     *\n     * @return void\n     *\/",39],["T_WHITESPACE","\n    ",43],["T_PROTECTED","protected",44],["T_WHITESPACE"," ",44],["T_FUNCTION","function",44],["T_WHITESPACE"," ",44],["T_STRING","_construct",44],"(",")",["T_WHITESPACE","\n    ",44],"{",["T_WHITESPACE","\n        ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","_init",46],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter_template'",46],",",["T_WHITESPACE"," ",46],["T_CONSTANT_ENCAPSED_STRING","'template_id'",46],")",";",["T_WHITESPACE","\n    ",46],"}",["T_WHITESPACE","\n\n    ",47],["T_DOC_COMMENT","\/**\n     * Check usage of template in queue\n     *\n     * @param \\Magento\\Newsletter\\Model\\Template $template\n     * @return boolean\n     *\/",49],["T_WHITESPACE","\n    ",54],["T_PUBLIC","public",55],["T_WHITESPACE"," ",55],["T_FUNCTION","function",55],["T_WHITESPACE"," ",55],["T_STRING","checkUsageInQueue",55],"(",["T_NS_SEPARATOR","\\",55],["T_STRING","Magento",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Newsletter",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Model",55],["T_NS_SEPARATOR","\\",55],["T_STRING","Template",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$template",55],")",["T_WHITESPACE","\n    ",55],"{",["T_WHITESPACE","\n        ",56],["T_IF","if",57],["T_WHITESPACE"," ",57],"(",["T_VARIABLE","$template",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","getTemplateActual",57],"(",")",["T_WHITESPACE"," ",57],["T_IS_NOT_IDENTICAL","!==",57],["T_WHITESPACE"," ",57],["T_LNUMBER","0",57],["T_WHITESPACE"," ",57],["T_BOOLEAN_AND","&&",57],["T_WHITESPACE"," ",57],"!",["T_VARIABLE","$template",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","getIsSystem",57],"(",")",")",["T_WHITESPACE"," ",57],"{",["T_WHITESPACE","\n            ",57],["T_VARIABLE","$select",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_VARIABLE","$this",58],["T_OBJECT_OPERATOR","->",58],["T_STRING","getConnection",58],"(",")",["T_OBJECT_OPERATOR","->",58],["T_STRING","select",58],"(",")",["T_OBJECT_OPERATOR","->",58],["T_STRING","from",58],"(",["T_WHITESPACE","\n                ",58],["T_VARIABLE","$this",59],["T_OBJECT_OPERATOR","->",59],["T_STRING","getTable",59],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter_queue'",59],")",",",["T_WHITESPACE","\n                ",59],["T_NEW","new",60],["T_WHITESPACE"," ",60],["T_NS_SEPARATOR","\\",60],["T_STRING","Zend_Db_Expr",60],"(",["T_CONSTANT_ENCAPSED_STRING","'COUNT(queue_id)'",60],")",["T_WHITESPACE","\n            ",60],")",["T_OBJECT_OPERATOR","->",61],["T_STRING","where",61],"(",["T_WHITESPACE","\n                ",61],["T_CONSTANT_ENCAPSED_STRING","'template_id = :template_id'",62],["T_WHITESPACE","\n            ",62],")",";",["T_WHITESPACE","\n\n            ",63],["T_VARIABLE","$countOfQueue",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getConnection",65],"(",")",["T_OBJECT_OPERATOR","->",65],["T_STRING","fetchOne",65],"(",["T_VARIABLE","$select",65],",",["T_WHITESPACE"," ",65],"[",["T_CONSTANT_ENCAPSED_STRING","'template_id'",65],["T_WHITESPACE"," ",65],["T_DOUBLE_ARROW","=>",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$template",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getId",65],"(",")","]",")",";",["T_WHITESPACE","\n\n            ",65],["T_RETURN","return",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$countOfQueue",67],["T_WHITESPACE"," ",67],">",["T_WHITESPACE"," ",67],["T_LNUMBER","0",67],";",["T_WHITESPACE","\n        ",67],"}",["T_WHITESPACE"," ",68],["T_ELSEIF","elseif",68],["T_WHITESPACE"," ",68],"(",["T_VARIABLE","$template",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","getIsSystem",68],"(",")",")",["T_WHITESPACE"," ",68],"{",["T_WHITESPACE","\n            ",68],["T_RETURN","return",69],["T_WHITESPACE"," ",69],["T_STRING","false",69],";",["T_WHITESPACE","\n        ",69],"}",["T_WHITESPACE"," ",70],["T_ELSE","else",70],["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n            ",70],["T_RETURN","return",71],["T_WHITESPACE"," ",71],["T_STRING","true",71],";",["T_WHITESPACE","\n        ",71],"}",["T_WHITESPACE","\n    ",72],"}",["T_WHITESPACE","\n\n    ",73],["T_DOC_COMMENT","\/**\n     * Check usage of template code in other templates\n     *\n     * @param \\Magento\\Newsletter\\Model\\Template $template\n     * @return boolean\n     *\/",75],["T_WHITESPACE","\n    ",80],["T_PUBLIC","public",81],["T_WHITESPACE"," ",81],["T_FUNCTION","function",81],["T_WHITESPACE"," ",81],["T_STRING","checkCodeUsage",81],"(",["T_NS_SEPARATOR","\\",81],["T_STRING","Magento",81],["T_NS_SEPARATOR","\\",81],["T_STRING","Newsletter",81],["T_NS_SEPARATOR","\\",81],["T_STRING","Model",81],["T_NS_SEPARATOR","\\",81],["T_STRING","Template",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$template",81],")",["T_WHITESPACE","\n    ",81],"{",["T_WHITESPACE","\n        ",82],["T_IF","if",83],["T_WHITESPACE"," ",83],"(",["T_VARIABLE","$template",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","getTemplateActual",83],"(",")",["T_WHITESPACE"," ",83],["T_IS_NOT_EQUAL","!=",83],["T_WHITESPACE"," ",83],["T_LNUMBER","0",83],["T_WHITESPACE"," ",83],["T_BOOLEAN_OR","||",83],["T_WHITESPACE"," ",83],["T_STRING","is_null",83],"(",["T_VARIABLE","$template",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","getTemplateActual",83],"(",")",")",")",["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n            ",83],["T_VARIABLE","$bind",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],"[",["T_WHITESPACE","\n                ",84],["T_CONSTANT_ENCAPSED_STRING","'template_id'",85],["T_WHITESPACE"," ",85],["T_DOUBLE_ARROW","=>",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$template",85],["T_OBJECT_OPERATOR","->",85],["T_STRING","getId",85],"(",")",",",["T_WHITESPACE","\n                ",85],["T_CONSTANT_ENCAPSED_STRING","'template_code'",86],["T_WHITESPACE"," ",86],["T_DOUBLE_ARROW","=>",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$template",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","getTemplateCode",86],"(",")",",",["T_WHITESPACE","\n                ",86],["T_CONSTANT_ENCAPSED_STRING","'template_actual'",87],["T_WHITESPACE"," ",87],["T_DOUBLE_ARROW","=>",87],["T_WHITESPACE"," ",87],["T_LNUMBER","1",87],",",["T_WHITESPACE","\n            ",87],"]",";",["T_WHITESPACE","\n            ",88],["T_VARIABLE","$select",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","getConnection",89],"(",")",["T_OBJECT_OPERATOR","->",89],["T_STRING","select",89],"(",")",["T_OBJECT_OPERATOR","->",89],["T_STRING","from",89],"(",["T_WHITESPACE","\n                ",89],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","getMainTable",90],"(",")",",",["T_WHITESPACE","\n                ",90],["T_NEW","new",91],["T_WHITESPACE"," ",91],["T_NS_SEPARATOR","\\",91],["T_STRING","Zend_Db_Expr",91],"(",["T_CONSTANT_ENCAPSED_STRING","'COUNT(template_id)'",91],")",["T_WHITESPACE","\n            ",91],")",["T_OBJECT_OPERATOR","->",92],["T_STRING","where",92],"(",["T_WHITESPACE","\n                ",92],["T_CONSTANT_ENCAPSED_STRING","'template_id != :template_id'",93],["T_WHITESPACE","\n            ",93],")",["T_OBJECT_OPERATOR","->",94],["T_STRING","where",94],"(",["T_WHITESPACE","\n                ",94],["T_CONSTANT_ENCAPSED_STRING","'template_code = :template_code'",95],["T_WHITESPACE","\n            ",95],")",["T_OBJECT_OPERATOR","->",96],["T_STRING","where",96],"(",["T_WHITESPACE","\n                ",96],["T_CONSTANT_ENCAPSED_STRING","'template_actual = :template_actual'",97],["T_WHITESPACE","\n            ",97],")",";",["T_WHITESPACE","\n\n            ",98],["T_VARIABLE","$countOfCodes",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getConnection",100],"(",")",["T_OBJECT_OPERATOR","->",100],["T_STRING","fetchOne",100],"(",["T_VARIABLE","$select",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$bind",100],")",";",["T_WHITESPACE","\n\n            ",100],["T_RETURN","return",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$countOfCodes",102],["T_WHITESPACE"," ",102],">",["T_WHITESPACE"," ",102],["T_LNUMBER","0",102],";",["T_WHITESPACE","\n        ",102],"}",["T_WHITESPACE"," ",103],["T_ELSE","else",103],["T_WHITESPACE"," ",103],"{",["T_WHITESPACE","\n            ",103],["T_RETURN","return",104],["T_WHITESPACE"," ",104],["T_STRING","false",104],";",["T_WHITESPACE","\n        ",104],"}",["T_WHITESPACE","\n    ",105],"}",["T_WHITESPACE","\n\n    ",106],["T_DOC_COMMENT","\/**\n     * Perform actions before object save\n     *\n     * @param \\Magento\\Framework\\Model\\AbstractModel $object\n     * @return $this\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     *\/",108],["T_WHITESPACE","\n    ",114],["T_PROTECTED","protected",115],["T_WHITESPACE"," ",115],["T_FUNCTION","function",115],["T_WHITESPACE"," ",115],["T_STRING","_beforeSave",115],"(",["T_NS_SEPARATOR","\\",115],["T_STRING","Magento",115],["T_NS_SEPARATOR","\\",115],["T_STRING","Framework",115],["T_NS_SEPARATOR","\\",115],["T_STRING","Model",115],["T_NS_SEPARATOR","\\",115],["T_STRING","AbstractModel",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$object",115],")",["T_WHITESPACE","\n    ",115],"{",["T_WHITESPACE","\n        ",116],["T_IF","if",117],["T_WHITESPACE"," ",117],"(",["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","checkCodeUsage",117],"(",["T_VARIABLE","$object",117],")",")",["T_WHITESPACE"," ",117],"{",["T_WHITESPACE","\n            ",117],["T_THROW","throw",118],["T_WHITESPACE"," ",118],["T_NEW","new",118],["T_WHITESPACE"," ",118],["T_NS_SEPARATOR","\\",118],["T_STRING","Magento",118],["T_NS_SEPARATOR","\\",118],["T_STRING","Framework",118],["T_NS_SEPARATOR","\\",118],["T_STRING","Exception",118],["T_NS_SEPARATOR","\\",118],["T_STRING","LocalizedException",118],"(",["T_STRING","__",118],"(",["T_CONSTANT_ENCAPSED_STRING","'Duplicate template code'",118],")",")",";",["T_WHITESPACE","\n        ",118],"}",["T_WHITESPACE","\n\n        ",119],["T_IF","if",121],["T_WHITESPACE"," ",121],"(","!",["T_VARIABLE","$object",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","hasTemplateActual",121],"(",")",")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n            ",121],["T_VARIABLE","$object",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","setTemplateActual",122],"(",["T_LNUMBER","1",122],")",";",["T_WHITESPACE","\n        ",122],"}",["T_WHITESPACE","\n        ",123],["T_IF","if",124],["T_WHITESPACE"," ",124],"(","!",["T_VARIABLE","$object",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","hasAddedAt",124],"(",")",")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n            ",124],["T_VARIABLE","$object",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","setAddedAt",125],"(",["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","_date",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","gmtDate",125],"(",")",")",";",["T_WHITESPACE","\n        ",125],"}",["T_WHITESPACE","\n        ",126],["T_VARIABLE","$object",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","setModifiedAt",127],"(",["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","_date",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","gmtDate",127],"(",")",")",";",["T_WHITESPACE","\n\n        ",127],["T_RETURN","return",129],["T_WHITESPACE"," ",129],["T_STRING","parent",129],["T_DOUBLE_COLON","::",129],["T_STRING","_beforeSave",129],"(",["T_VARIABLE","$object",129],")",";",["T_WHITESPACE","\n    ",129],"}",["T_WHITESPACE","\n",130],"}",["T_WHITESPACE","\n",131]]