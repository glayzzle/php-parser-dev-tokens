[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Newsletter",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],["T_NS_SEPARATOR","\\",6],["T_STRING","ResourceModel",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Queue",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * Newsletter queue collection.\n *\n * @author      Magento Core Team <core@magentocommerce.com>\n *\/",8],["T_WHITESPACE","\n",12],["T_CLASS","class",13],["T_WHITESPACE"," ",13],["T_STRING","Collection",13],["T_WHITESPACE"," ",13],["T_EXTENDS","extends",13],["T_WHITESPACE"," ",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Framework",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Model",13],["T_NS_SEPARATOR","\\",13],["T_STRING","ResourceModel",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Db",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Collection",13],["T_NS_SEPARATOR","\\",13],["T_STRING","AbstractCollection",13],["T_WHITESPACE","\n",13],"{",["T_WHITESPACE","\n    ",14],["T_DOC_COMMENT","\/**\n     * True when subscribers info joined\n     *\n     * @var bool\n     *\/",15],["T_WHITESPACE","\n    ",19],["T_PROTECTED","protected",20],["T_WHITESPACE"," ",20],["T_VARIABLE","$_addSubscribersFlag",20],["T_WHITESPACE"," ",20],"=",["T_WHITESPACE"," ",20],["T_STRING","false",20],";",["T_WHITESPACE","\n\n    ",20],["T_DOC_COMMENT","\/**\n     * True when filtered by store\n     *\n     * @var bool\n     *\/",22],["T_WHITESPACE","\n    ",26],["T_PROTECTED","protected",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$_isStoreFilter",27],["T_WHITESPACE"," ",27],"=",["T_WHITESPACE"," ",27],["T_STRING","false",27],";",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * Date\n     *\n     * @var \\Magento\\Framework\\Stdlib\\DateTime\\DateTime\n     *\/",29],["T_WHITESPACE","\n    ",33],["T_PROTECTED","protected",34],["T_WHITESPACE"," ",34],["T_VARIABLE","$_date",34],";",["T_WHITESPACE","\n\n    ",34],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Framework\\Data\\Collection\\EntityFactory $entityFactory\n     * @param \\Psr\\Log\\LoggerInterface $logger\n     * @param \\Magento\\Framework\\Data\\Collection\\Db\\FetchStrategyInterface $fetchStrategy\n     * @param \\Magento\\Framework\\Event\\ManagerInterface $eventManager\n     * @param \\Magento\\Framework\\Stdlib\\DateTime\\DateTime $date\n     * @param \\Magento\\Framework\\DB\\Adapter\\AdapterInterface $connection\n     * @param \\Magento\\Framework\\Model\\ResourceModel\\Db\\AbstractDb $resource\n     *\/",36],["T_WHITESPACE","\n    ",44],["T_PUBLIC","public",45],["T_WHITESPACE"," ",45],["T_FUNCTION","function",45],["T_WHITESPACE"," ",45],["T_STRING","__construct",45],"(",["T_WHITESPACE","\n        ",45],["T_NS_SEPARATOR","\\",46],["T_STRING","Magento",46],["T_NS_SEPARATOR","\\",46],["T_STRING","Framework",46],["T_NS_SEPARATOR","\\",46],["T_STRING","Data",46],["T_NS_SEPARATOR","\\",46],["T_STRING","Collection",46],["T_NS_SEPARATOR","\\",46],["T_STRING","EntityFactory",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$entityFactory",46],",",["T_WHITESPACE","\n        ",46],["T_NS_SEPARATOR","\\",47],["T_STRING","Psr",47],["T_NS_SEPARATOR","\\",47],["T_STRING","Log",47],["T_NS_SEPARATOR","\\",47],["T_STRING","LoggerInterface",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$logger",47],",",["T_WHITESPACE","\n        ",47],["T_NS_SEPARATOR","\\",48],["T_STRING","Magento",48],["T_NS_SEPARATOR","\\",48],["T_STRING","Framework",48],["T_NS_SEPARATOR","\\",48],["T_STRING","Data",48],["T_NS_SEPARATOR","\\",48],["T_STRING","Collection",48],["T_NS_SEPARATOR","\\",48],["T_STRING","Db",48],["T_NS_SEPARATOR","\\",48],["T_STRING","FetchStrategyInterface",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$fetchStrategy",48],",",["T_WHITESPACE","\n        ",48],["T_NS_SEPARATOR","\\",49],["T_STRING","Magento",49],["T_NS_SEPARATOR","\\",49],["T_STRING","Framework",49],["T_NS_SEPARATOR","\\",49],["T_STRING","Event",49],["T_NS_SEPARATOR","\\",49],["T_STRING","ManagerInterface",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$eventManager",49],",",["T_WHITESPACE","\n        ",49],["T_NS_SEPARATOR","\\",50],["T_STRING","Magento",50],["T_NS_SEPARATOR","\\",50],["T_STRING","Framework",50],["T_NS_SEPARATOR","\\",50],["T_STRING","Stdlib",50],["T_NS_SEPARATOR","\\",50],["T_STRING","DateTime",50],["T_NS_SEPARATOR","\\",50],["T_STRING","DateTime",50],["T_WHITESPACE"," ",50],["T_VARIABLE","$date",50],",",["T_WHITESPACE","\n        ",50],["T_NS_SEPARATOR","\\",51],["T_STRING","Magento",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Framework",51],["T_NS_SEPARATOR","\\",51],["T_STRING","DB",51],["T_NS_SEPARATOR","\\",51],["T_STRING","Adapter",51],["T_NS_SEPARATOR","\\",51],["T_STRING","AdapterInterface",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$connection",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_STRING","null",51],",",["T_WHITESPACE","\n        ",51],["T_NS_SEPARATOR","\\",52],["T_STRING","Magento",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Framework",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Model",52],["T_NS_SEPARATOR","\\",52],["T_STRING","ResourceModel",52],["T_NS_SEPARATOR","\\",52],["T_STRING","Db",52],["T_NS_SEPARATOR","\\",52],["T_STRING","AbstractDb",52],["T_WHITESPACE"," ",52],["T_VARIABLE","$resource",52],["T_WHITESPACE"," ",52],"=",["T_WHITESPACE"," ",52],["T_STRING","null",52],["T_WHITESPACE","\n    ",52],")",["T_WHITESPACE"," ",53],"{",["T_WHITESPACE","\n        ",53],["T_STRING","parent",54],["T_DOUBLE_COLON","::",54],["T_STRING","__construct",54],"(",["T_VARIABLE","$entityFactory",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$logger",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$fetchStrategy",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$eventManager",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$connection",54],",",["T_WHITESPACE"," ",54],["T_VARIABLE","$resource",54],")",";",["T_WHITESPACE","\n        ",54],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","_date",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_VARIABLE","$date",55],";",["T_WHITESPACE","\n    ",55],"}",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * Initializes collection\n     *\n     * @return void\n     *\/",58],["T_WHITESPACE","\n    ",62],["T_PROTECTED","protected",63],["T_WHITESPACE"," ",63],["T_FUNCTION","function",63],["T_WHITESPACE"," ",63],["T_STRING","_construct",63],"(",")",["T_WHITESPACE","\n    ",63],"{",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","_map",65],"[",["T_CONSTANT_ENCAPSED_STRING","'fields'",65],"]","[",["T_CONSTANT_ENCAPSED_STRING","'queue_id'",65],"]",["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_CONSTANT_ENCAPSED_STRING","'main_table.queue_id'",65],";",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","_init",66],"(",["T_NS_SEPARATOR","\\",66],["T_STRING","Magento",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Newsletter",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Model",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Queue",66],["T_DOUBLE_COLON","::",66],["T_CLASS","class",66],",",["T_WHITESPACE"," ",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Magento",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Newsletter",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Model",66],["T_NS_SEPARATOR","\\",66],["T_STRING","ResourceModel",66],["T_NS_SEPARATOR","\\",66],["T_STRING","Queue",66],["T_DOUBLE_COLON","::",66],["T_CLASS","class",66],")",";",["T_WHITESPACE","\n    ",66],"}",["T_WHITESPACE","\n\n    ",67],["T_DOC_COMMENT","\/**\n     * Joines templates information\n     *\n     * @return $this\n     *\/",69],["T_WHITESPACE","\n    ",73],["T_PUBLIC","public",74],["T_WHITESPACE"," ",74],["T_FUNCTION","function",74],["T_WHITESPACE"," ",74],["T_STRING","addTemplateInfo",74],"(",")",["T_WHITESPACE","\n    ",74],"{",["T_WHITESPACE","\n        ",75],["T_VARIABLE","$this",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getSelect",76],"(",")",["T_OBJECT_OPERATOR","->",76],["T_STRING","joinLeft",76],"(",["T_WHITESPACE","\n            ",76],"[",["T_CONSTANT_ENCAPSED_STRING","'template'",77],["T_WHITESPACE"," ",77],["T_DOUBLE_ARROW","=>",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","getTable",77],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter_template'",77],")","]",",",["T_WHITESPACE","\n            ",77],["T_CONSTANT_ENCAPSED_STRING","'template.template_id=main_table.template_id'",78],",",["T_WHITESPACE","\n            ",78],"[",["T_CONSTANT_ENCAPSED_STRING","'template_subject'",79],",",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'template_sender_name'",79],",",["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'template_sender_email'",79],"]",["T_WHITESPACE","\n        ",79],")",";",["T_WHITESPACE","\n        ",80],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","_joinedTables",81],"[",["T_CONSTANT_ENCAPSED_STRING","'template'",81],"]",["T_WHITESPACE"," ",81],"=",["T_WHITESPACE"," ",81],["T_STRING","true",81],";",["T_WHITESPACE","\n        ",81],["T_RETURN","return",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$this",82],";",["T_WHITESPACE","\n    ",82],"}",["T_WHITESPACE","\n\n    ",83],["T_DOC_COMMENT","\/**\n     * Adds subscribers info to selelect\n     *\n     * @return $this\n     *\/",85],["T_WHITESPACE","\n    ",89],["T_PROTECTED","protected",90],["T_WHITESPACE"," ",90],["T_FUNCTION","function",90],["T_WHITESPACE"," ",90],["T_STRING","_addSubscriberInfoToSelect",90],"(",")",["T_WHITESPACE","\n    ",90],"{",["T_WHITESPACE","\n        ",91],["T_DOC_COMMENT","\/** @var $select \\Magento\\Framework\\DB\\Select *\/",92],["T_WHITESPACE","\n        ",92],["T_VARIABLE","$select",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getConnection",93],"(",")",["T_OBJECT_OPERATOR","->",93],["T_STRING","select",93],"(",")",["T_OBJECT_OPERATOR","->",93],["T_STRING","from",93],"(",["T_WHITESPACE","\n            ",93],"[",["T_CONSTANT_ENCAPSED_STRING","'qlt'",94],["T_WHITESPACE"," ",94],["T_DOUBLE_ARROW","=>",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getTable",94],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter_queue_link'",94],")","]",",",["T_WHITESPACE","\n            ",94],["T_CONSTANT_ENCAPSED_STRING","'COUNT(qlt.queue_link_id)'",95],["T_WHITESPACE","\n        ",95],")",["T_OBJECT_OPERATOR","->",96],["T_STRING","where",96],"(",["T_WHITESPACE","\n            ",96],["T_CONSTANT_ENCAPSED_STRING","'qlt.queue_id = main_table.queue_id'",97],["T_WHITESPACE","\n        ",97],")",";",["T_WHITESPACE","\n        ",98],["T_VARIABLE","$totalExpr",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_NEW","new",99],["T_WHITESPACE"," ",99],["T_NS_SEPARATOR","\\",99],["T_STRING","Zend_Db_Expr",99],"(",["T_STRING","sprintf",99],"(",["T_CONSTANT_ENCAPSED_STRING","'(%s)'",99],",",["T_WHITESPACE"," ",99],["T_VARIABLE","$select",99],["T_OBJECT_OPERATOR","->",99],["T_STRING","assemble",99],"(",")",")",")",";",["T_WHITESPACE","\n        ",99],["T_VARIABLE","$select",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","getConnection",100],"(",")",["T_OBJECT_OPERATOR","->",100],["T_STRING","select",100],"(",")",["T_OBJECT_OPERATOR","->",100],["T_STRING","from",100],"(",["T_WHITESPACE","\n            ",100],"[",["T_CONSTANT_ENCAPSED_STRING","'qls'",101],["T_WHITESPACE"," ",101],["T_DOUBLE_ARROW","=>",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$this",101],["T_OBJECT_OPERATOR","->",101],["T_STRING","getTable",101],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter_queue_link'",101],")","]",",",["T_WHITESPACE","\n            ",101],["T_CONSTANT_ENCAPSED_STRING","'COUNT(qls.queue_link_id)'",102],["T_WHITESPACE","\n        ",102],")",["T_OBJECT_OPERATOR","->",103],["T_STRING","where",103],"(",["T_WHITESPACE","\n            ",103],["T_CONSTANT_ENCAPSED_STRING","'qls.queue_id = main_table.queue_id'",104],["T_WHITESPACE","\n        ",104],")",["T_OBJECT_OPERATOR","->",105],["T_STRING","where",105],"(",["T_WHITESPACE","\n            ",105],["T_CONSTANT_ENCAPSED_STRING","'qls.letter_sent_at IS NOT NULL'",106],["T_WHITESPACE","\n        ",106],")",";",["T_WHITESPACE","\n        ",107],["T_VARIABLE","$sentExpr",108],["T_WHITESPACE"," ",108],"=",["T_WHITESPACE"," ",108],["T_NEW","new",108],["T_WHITESPACE"," ",108],["T_NS_SEPARATOR","\\",108],["T_STRING","Zend_Db_Expr",108],"(",["T_STRING","sprintf",108],"(",["T_CONSTANT_ENCAPSED_STRING","'(%s)'",108],",",["T_WHITESPACE"," ",108],["T_VARIABLE","$select",108],["T_OBJECT_OPERATOR","->",108],["T_STRING","assemble",108],"(",")",")",")",";",["T_WHITESPACE","\n\n        ",108],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getSelect",110],"(",")",["T_OBJECT_OPERATOR","->",110],["T_STRING","columns",110],"(","[",["T_CONSTANT_ENCAPSED_STRING","'subscribers_sent'",110],["T_WHITESPACE"," ",110],["T_DOUBLE_ARROW","=>",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$sentExpr",110],",",["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'subscribers_total'",110],["T_WHITESPACE"," ",110],["T_DOUBLE_ARROW","=>",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$totalExpr",110],"]",")",";",["T_WHITESPACE","\n        ",110],["T_RETURN","return",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],";",["T_WHITESPACE","\n    ",111],"}",["T_WHITESPACE","\n\n    ",112],["T_DOC_COMMENT","\/**\n     * Adds subscribers info to select and loads collection\n     *\n     * @param bool $printQuery\n     * @param bool $logQuery\n     * @return $this\n     *\/",114],["T_WHITESPACE","\n    ",120],["T_PUBLIC","public",121],["T_WHITESPACE"," ",121],["T_FUNCTION","function",121],["T_WHITESPACE"," ",121],["T_STRING","load",121],"(",["T_VARIABLE","$printQuery",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_STRING","false",121],",",["T_WHITESPACE"," ",121],["T_VARIABLE","$logQuery",121],["T_WHITESPACE"," ",121],"=",["T_WHITESPACE"," ",121],["T_STRING","false",121],")",["T_WHITESPACE","\n    ",121],"{",["T_WHITESPACE","\n        ",122],["T_IF","if",123],["T_WHITESPACE"," ",123],"(",["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","_addSubscribersFlag",123],["T_WHITESPACE"," ",123],["T_BOOLEAN_AND","&&",123],["T_WHITESPACE"," ",123],"!",["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","isLoaded",123],"(",")",")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n            ",123],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","_addSubscriberInfoToSelect",124],"(",")",";",["T_WHITESPACE","\n        ",124],"}",["T_WHITESPACE","\n        ",125],["T_RETURN","return",126],["T_WHITESPACE"," ",126],["T_STRING","parent",126],["T_DOUBLE_COLON","::",126],["T_STRING","load",126],"(",["T_VARIABLE","$printQuery",126],",",["T_WHITESPACE"," ",126],["T_VARIABLE","$logQuery",126],")",";",["T_WHITESPACE","\n    ",126],"}",["T_WHITESPACE","\n\n    ",127],["T_DOC_COMMENT","\/**\n     * Joines subscribers information\n     *\n     * @return $this\n     *\/",129],["T_WHITESPACE","\n    ",133],["T_PUBLIC","public",134],["T_WHITESPACE"," ",134],["T_FUNCTION","function",134],["T_WHITESPACE"," ",134],["T_STRING","addSubscribersInfo",134],"(",")",["T_WHITESPACE","\n    ",134],"{",["T_WHITESPACE","\n        ",135],["T_VARIABLE","$this",136],["T_OBJECT_OPERATOR","->",136],["T_STRING","_addSubscribersFlag",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_STRING","true",136],";",["T_WHITESPACE","\n        ",136],["T_RETURN","return",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$this",137],";",["T_WHITESPACE","\n    ",137],"}",["T_WHITESPACE","\n\n    ",138],["T_DOC_COMMENT","\/**\n     * Checks if field is 'subscribers_total', 'subscribers_sent'\n     * to add specific filter or adds reguler filter\n     *\n     * @param string $field\n     * @param null|string|array $condition\n     * @return $this\n     *\/",140],["T_WHITESPACE","\n    ",147],["T_PUBLIC","public",148],["T_WHITESPACE"," ",148],["T_FUNCTION","function",148],["T_WHITESPACE"," ",148],["T_STRING","addFieldToFilter",148],"(",["T_VARIABLE","$field",148],",",["T_WHITESPACE"," ",148],["T_VARIABLE","$condition",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_STRING","null",148],")",["T_WHITESPACE","\n    ",148],"{",["T_WHITESPACE","\n        ",149],["T_IF","if",150],["T_WHITESPACE"," ",150],"(",["T_STRING","in_array",150],"(",["T_VARIABLE","$field",150],",",["T_WHITESPACE"," ",150],"[",["T_CONSTANT_ENCAPSED_STRING","'subscribers_total'",150],",",["T_WHITESPACE"," ",150],["T_CONSTANT_ENCAPSED_STRING","'subscribers_sent'",150],"]",")",")",["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n            ",150],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","addFieldToFilter",151],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.queue_id'",151],",",["T_WHITESPACE"," ",151],"[",["T_CONSTANT_ENCAPSED_STRING","'in'",151],["T_WHITESPACE"," ",151],["T_DOUBLE_ARROW","=>",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","_getIdsFromLink",151],"(",["T_VARIABLE","$field",151],",",["T_WHITESPACE"," ",151],["T_VARIABLE","$condition",151],")","]",")",";",["T_WHITESPACE","\n            ",151],["T_RETURN","return",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$this",152],";",["T_WHITESPACE","\n        ",152],"}",["T_WHITESPACE"," ",153],["T_ELSE","else",153],["T_WHITESPACE"," ",153],"{",["T_WHITESPACE","\n            ",153],["T_RETURN","return",154],["T_WHITESPACE"," ",154],["T_STRING","parent",154],["T_DOUBLE_COLON","::",154],["T_STRING","addFieldToFilter",154],"(",["T_VARIABLE","$field",154],",",["T_WHITESPACE"," ",154],["T_VARIABLE","$condition",154],")",";",["T_WHITESPACE","\n        ",154],"}",["T_WHITESPACE","\n    ",155],"}",["T_WHITESPACE","\n\n    ",156],["T_DOC_COMMENT","\/**\n     * Returns ids from queue_link table\n     *\n     * @param string $field\n     * @param null|string|array $condition\n     * @return array\n     *\/",158],["T_WHITESPACE","\n    ",164],["T_PROTECTED","protected",165],["T_WHITESPACE"," ",165],["T_FUNCTION","function",165],["T_WHITESPACE"," ",165],["T_STRING","_getIdsFromLink",165],"(",["T_VARIABLE","$field",165],",",["T_WHITESPACE"," ",165],["T_VARIABLE","$condition",165],")",["T_WHITESPACE","\n    ",165],"{",["T_WHITESPACE","\n        ",166],["T_VARIABLE","$select",167],["T_WHITESPACE"," ",167],"=",["T_WHITESPACE"," ",167],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","getConnection",167],"(",")",["T_OBJECT_OPERATOR","->",167],["T_STRING","select",167],"(",")",["T_OBJECT_OPERATOR","->",167],["T_STRING","from",167],"(",["T_WHITESPACE","\n            ",167],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","getTable",168],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter_queue_link'",168],")",",",["T_WHITESPACE","\n            ",168],"[",["T_CONSTANT_ENCAPSED_STRING","'queue_id'",169],",",["T_WHITESPACE"," ",169],["T_CONSTANT_ENCAPSED_STRING","'total'",169],["T_WHITESPACE"," ",169],["T_DOUBLE_ARROW","=>",169],["T_WHITESPACE"," ",169],["T_NEW","new",169],["T_WHITESPACE"," ",169],["T_NS_SEPARATOR","\\",169],["T_STRING","Zend_Db_Expr",169],"(",["T_CONSTANT_ENCAPSED_STRING","'COUNT(queue_link_id)'",169],")","]",["T_WHITESPACE","\n        ",169],")",["T_OBJECT_OPERATOR","->",170],["T_STRING","group",170],"(",["T_WHITESPACE","\n            ",170],["T_CONSTANT_ENCAPSED_STRING","'queue_id'",171],["T_WHITESPACE","\n        ",171],")",["T_OBJECT_OPERATOR","->",172],["T_STRING","having",172],"(",["T_WHITESPACE","\n            ",172],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","_getConditionSql",173],"(",["T_CONSTANT_ENCAPSED_STRING","'total'",173],",",["T_WHITESPACE"," ",173],["T_VARIABLE","$condition",173],")",["T_WHITESPACE","\n        ",173],")",";",["T_WHITESPACE","\n\n        ",174],["T_IF","if",176],["T_WHITESPACE"," ",176],"(",["T_VARIABLE","$field",176],["T_WHITESPACE"," ",176],["T_IS_EQUAL","==",176],["T_WHITESPACE"," ",176],["T_CONSTANT_ENCAPSED_STRING","'subscribers_sent'",176],")",["T_WHITESPACE"," ",176],"{",["T_WHITESPACE","\n            ",176],["T_VARIABLE","$select",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","where",177],"(",["T_CONSTANT_ENCAPSED_STRING","'letter_sent_at IS NOT NULL'",177],")",";",["T_WHITESPACE","\n        ",177],"}",["T_WHITESPACE","\n\n        ",178],["T_VARIABLE","$idList",180],["T_WHITESPACE"," ",180],"=",["T_WHITESPACE"," ",180],["T_VARIABLE","$this",180],["T_OBJECT_OPERATOR","->",180],["T_STRING","getConnection",180],"(",")",["T_OBJECT_OPERATOR","->",180],["T_STRING","fetchCol",180],"(",["T_VARIABLE","$select",180],")",";",["T_WHITESPACE","\n\n        ",180],["T_IF","if",182],["T_WHITESPACE"," ",182],"(",["T_STRING","count",182],"(",["T_VARIABLE","$idList",182],")",")",["T_WHITESPACE"," ",182],"{",["T_WHITESPACE","\n            ",182],["T_RETURN","return",183],["T_WHITESPACE"," ",183],["T_VARIABLE","$idList",183],";",["T_WHITESPACE","\n        ",183],"}",["T_WHITESPACE","\n\n        ",184],["T_RETURN","return",186],["T_WHITESPACE"," ",186],"[",["T_LNUMBER","0",186],"]",";",["T_WHITESPACE","\n    ",186],"}",["T_WHITESPACE","\n\n    ",187],["T_DOC_COMMENT","\/**\n     * Set filter for queue by subscriber.\n     *\n     * @param int $subscriberId\n     * @return $this\n     *\/",189],["T_WHITESPACE","\n    ",194],["T_PUBLIC","public",195],["T_WHITESPACE"," ",195],["T_FUNCTION","function",195],["T_WHITESPACE"," ",195],["T_STRING","addSubscriberFilter",195],"(",["T_VARIABLE","$subscriberId",195],")",["T_WHITESPACE","\n    ",195],"{",["T_WHITESPACE","\n        ",196],["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","getSelect",197],"(",")",["T_OBJECT_OPERATOR","->",197],["T_STRING","join",197],"(",["T_WHITESPACE","\n            ",197],"[",["T_CONSTANT_ENCAPSED_STRING","'link'",198],["T_WHITESPACE"," ",198],["T_DOUBLE_ARROW","=>",198],["T_WHITESPACE"," ",198],["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","getTable",198],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter_queue_link'",198],")","]",",",["T_WHITESPACE","\n            ",198],["T_CONSTANT_ENCAPSED_STRING","'main_table.queue_id=link.queue_id'",199],",",["T_WHITESPACE","\n            ",199],"[",["T_CONSTANT_ENCAPSED_STRING","'letter_sent_at'",200],"]",["T_WHITESPACE","\n        ",200],")",["T_OBJECT_OPERATOR","->",201],["T_STRING","where",201],"(",["T_WHITESPACE","\n            ",201],["T_CONSTANT_ENCAPSED_STRING","'link.subscriber_id = ?'",202],",",["T_WHITESPACE","\n            ",202],["T_VARIABLE","$subscriberId",203],["T_WHITESPACE","\n        ",203],")",";",["T_WHITESPACE","\n\n        ",204],["T_RETURN","return",206],["T_WHITESPACE"," ",206],["T_VARIABLE","$this",206],";",["T_WHITESPACE","\n    ",206],"}",["T_WHITESPACE","\n\n    ",207],["T_DOC_COMMENT","\/**\n     * Add filter by only ready fot sending item\n     *\n     * @return $this\n     *\/",209],["T_WHITESPACE","\n    ",213],["T_PUBLIC","public",214],["T_WHITESPACE"," ",214],["T_FUNCTION","function",214],["T_WHITESPACE"," ",214],["T_STRING","addOnlyForSendingFilter",214],"(",")",["T_WHITESPACE","\n    ",214],"{",["T_WHITESPACE","\n        ",215],["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","getSelect",216],"(",")",["T_OBJECT_OPERATOR","->",216],["T_STRING","where",216],"(",["T_WHITESPACE","\n            ",216],["T_CONSTANT_ENCAPSED_STRING","'main_table.queue_status in (?)'",217],",",["T_WHITESPACE","\n            ",217],"[",["T_NS_SEPARATOR","\\",218],["T_STRING","Magento",218],["T_NS_SEPARATOR","\\",218],["T_STRING","Newsletter",218],["T_NS_SEPARATOR","\\",218],["T_STRING","Model",218],["T_NS_SEPARATOR","\\",218],["T_STRING","Queue",218],["T_DOUBLE_COLON","::",218],["T_STRING","STATUS_SENDING",218],",",["T_WHITESPACE"," ",218],["T_NS_SEPARATOR","\\",218],["T_STRING","Magento",218],["T_NS_SEPARATOR","\\",218],["T_STRING","Newsletter",218],["T_NS_SEPARATOR","\\",218],["T_STRING","Model",218],["T_NS_SEPARATOR","\\",218],["T_STRING","Queue",218],["T_DOUBLE_COLON","::",218],["T_STRING","STATUS_NEVER",218],"]",["T_WHITESPACE","\n        ",218],")",["T_OBJECT_OPERATOR","->",219],["T_STRING","where",219],"(",["T_WHITESPACE","\n            ",219],["T_CONSTANT_ENCAPSED_STRING","'main_table.queue_start_at < ?'",220],",",["T_WHITESPACE","\n            ",220],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","_date",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","gmtdate",221],"(",")",["T_WHITESPACE","\n        ",221],")",["T_OBJECT_OPERATOR","->",222],["T_STRING","where",222],"(",["T_WHITESPACE","\n            ",222],["T_CONSTANT_ENCAPSED_STRING","'main_table.queue_start_at IS NOT NULL'",223],["T_WHITESPACE","\n        ",223],")",";",["T_WHITESPACE","\n\n        ",224],["T_RETURN","return",226],["T_WHITESPACE"," ",226],["T_VARIABLE","$this",226],";",["T_WHITESPACE","\n    ",226],"}",["T_WHITESPACE","\n\n    ",227],["T_DOC_COMMENT","\/**\n     * Add filter by only not sent items\n     *\n     * @return $this\n     *\/",229],["T_WHITESPACE","\n    ",233],["T_PUBLIC","public",234],["T_WHITESPACE"," ",234],["T_FUNCTION","function",234],["T_WHITESPACE"," ",234],["T_STRING","addOnlyUnsentFilter",234],"(",")",["T_WHITESPACE","\n    ",234],"{",["T_WHITESPACE","\n        ",235],["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","addFieldToFilter",236],"(",["T_CONSTANT_ENCAPSED_STRING","'main_table.queue_status'",236],",",["T_WHITESPACE"," ",236],["T_NS_SEPARATOR","\\",236],["T_STRING","Magento",236],["T_NS_SEPARATOR","\\",236],["T_STRING","Newsletter",236],["T_NS_SEPARATOR","\\",236],["T_STRING","Model",236],["T_NS_SEPARATOR","\\",236],["T_STRING","Queue",236],["T_DOUBLE_COLON","::",236],["T_STRING","STATUS_NEVER",236],")",";",["T_WHITESPACE","\n\n        ",236],["T_RETURN","return",238],["T_WHITESPACE"," ",238],["T_VARIABLE","$this",238],";",["T_WHITESPACE","\n    ",238],"}",["T_WHITESPACE","\n\n    ",239],["T_DOC_COMMENT","\/**\n     * Returns options array\n     *\n     * @return array\n     *\/",241],["T_WHITESPACE","\n    ",245],["T_PUBLIC","public",246],["T_WHITESPACE"," ",246],["T_FUNCTION","function",246],["T_WHITESPACE"," ",246],["T_STRING","toOptionArray",246],"(",")",["T_WHITESPACE","\n    ",246],"{",["T_WHITESPACE","\n        ",247],["T_RETURN","return",248],["T_WHITESPACE"," ",248],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","_toOptionArray",248],"(",["T_CONSTANT_ENCAPSED_STRING","'queue_id'",248],",",["T_WHITESPACE"," ",248],["T_CONSTANT_ENCAPSED_STRING","'template_subject'",248],")",";",["T_WHITESPACE","\n    ",248],"}",["T_WHITESPACE","\n\n    ",249],["T_DOC_COMMENT","\/**\n     * Filter collection by specified store ids\n     *\n     * @param int[]|int $storeIds\n     * @return $this\n     *\/",251],["T_WHITESPACE","\n    ",256],["T_PUBLIC","public",257],["T_WHITESPACE"," ",257],["T_FUNCTION","function",257],["T_WHITESPACE"," ",257],["T_STRING","addStoreFilter",257],"(",["T_VARIABLE","$storeIds",257],")",["T_WHITESPACE","\n    ",257],"{",["T_WHITESPACE","\n        ",258],["T_IF","if",259],["T_WHITESPACE"," ",259],"(","!",["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","_isStoreFilter",259],")",["T_WHITESPACE"," ",259],"{",["T_WHITESPACE","\n            ",259],["T_VARIABLE","$this",260],["T_OBJECT_OPERATOR","->",260],["T_STRING","getSelect",260],"(",")",["T_OBJECT_OPERATOR","->",260],["T_STRING","joinInner",260],"(",["T_WHITESPACE","\n                ",260],"[",["T_CONSTANT_ENCAPSED_STRING","'store_link'",261],["T_WHITESPACE"," ",261],["T_DOUBLE_ARROW","=>",261],["T_WHITESPACE"," ",261],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","getTable",261],"(",["T_CONSTANT_ENCAPSED_STRING","'newsletter_queue_store_link'",261],")","]",",",["T_WHITESPACE","\n                ",261],["T_CONSTANT_ENCAPSED_STRING","'main_table.queue_id = store_link.queue_id'",262],",",["T_WHITESPACE","\n                ",262],"[","]",["T_WHITESPACE","\n            ",263],")",["T_OBJECT_OPERATOR","->",264],["T_STRING","where",264],"(",["T_WHITESPACE","\n                ",264],["T_CONSTANT_ENCAPSED_STRING","'store_link.store_id IN (?)'",265],",",["T_WHITESPACE","\n                ",265],["T_VARIABLE","$storeIds",266],["T_WHITESPACE","\n            ",266],")",["T_OBJECT_OPERATOR","->",267],["T_STRING","group",267],"(",["T_WHITESPACE","\n                ",267],["T_CONSTANT_ENCAPSED_STRING","'main_table.queue_id'",268],["T_WHITESPACE","\n            ",268],")",";",["T_WHITESPACE","\n            ",269],["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","_isStoreFilter",270],["T_WHITESPACE"," ",270],"=",["T_WHITESPACE"," ",270],["T_STRING","true",270],";",["T_WHITESPACE","\n        ",270],"}",["T_WHITESPACE","\n        ",271],["T_RETURN","return",272],["T_WHITESPACE"," ",272],["T_VARIABLE","$this",272],";",["T_WHITESPACE","\n    ",272],"}",["T_WHITESPACE","\n",273],"}",["T_WHITESPACE","\n",274]]