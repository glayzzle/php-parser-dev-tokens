[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_COMMENT","\/\/ @codingStandardsIgnoreFile\n",7],["T_WHITESPACE","\n",8],["T_NAMESPACE","namespace",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Multishipping",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Model",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Checkout",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Type",9],";",["T_WHITESPACE","\n\n",9],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Customer",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Api",11],["T_NS_SEPARATOR","\\",11],["T_STRING","AddressRepositoryInterface",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Framework",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Pricing",12],["T_NS_SEPARATOR","\\",12],["T_STRING","PriceCurrencyInterface",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Sales",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Model",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Order",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Email",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Sender",13],["T_NS_SEPARATOR","\\",13],["T_STRING","OrderSender",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Framework",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Exception",14],["T_NS_SEPARATOR","\\",14],["T_STRING","LocalizedException",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Magento",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Framework",15],["T_NS_SEPARATOR","\\",15],["T_STRING","App",15],["T_NS_SEPARATOR","\\",15],["T_STRING","ObjectManager",15],";",["T_WHITESPACE","\n\n",15],["T_DOC_COMMENT","\/**\n * Multishipping checkout model\n * @SuppressWarnings(PHPMD.TooManyFields)\n * @SuppressWarnings(PHPMD.ExcessiveClassComplexity)\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",17],["T_WHITESPACE","\n",22],["T_CLASS","class",23],["T_WHITESPACE"," ",23],["T_STRING","Multishipping",23],["T_WHITESPACE"," ",23],["T_EXTENDS","extends",23],["T_WHITESPACE"," ",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Magento",23],["T_NS_SEPARATOR","\\",23],["T_STRING","Framework",23],["T_NS_SEPARATOR","\\",23],["T_STRING","DataObject",23],["T_WHITESPACE","\n",23],"{",["T_WHITESPACE","\n    ",24],["T_DOC_COMMENT","\/**\n     * Quote shipping addresses items cache\n     *\n     * @var array\n     *\/",25],["T_WHITESPACE","\n    ",29],["T_PROTECTED","protected",30],["T_WHITESPACE"," ",30],["T_VARIABLE","$_quoteShippingAddressesItems",30],";",["T_WHITESPACE","\n\n    ",30],["T_DOC_COMMENT","\/**\n     * Core event manager proxy\n     *\n     * @var \\Magento\\Framework\\Event\\ManagerInterface\n     *\/",32],["T_WHITESPACE","\n    ",36],["T_PROTECTED","protected",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$_eventManager",37],["T_WHITESPACE"," ",37],"=",["T_WHITESPACE"," ",37],["T_STRING","null",37],";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * Core store config\n     *\n     * @var \\Magento\\Framework\\App\\Config\\ScopeConfigInterface\n     *\/",39],["T_WHITESPACE","\n    ",43],["T_PROTECTED","protected",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$_scopeConfig",44],";",["T_WHITESPACE","\n\n    ",44],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Session\\Generic\n     *\/",46],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_session",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Store\\Model\\StoreManagerInterface\n     *\/",51],["T_WHITESPACE","\n    ",53],["T_PROTECTED","protected",54],["T_WHITESPACE"," ",54],["T_VARIABLE","$_storeManager",54],";",["T_WHITESPACE","\n\n    ",54],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Model\\Quote\\AddressFactory\n     *\/",56],["T_WHITESPACE","\n    ",58],["T_PROTECTED","protected",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$_addressFactory",59],";",["T_WHITESPACE","\n\n    ",59],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Payment\\Model\\Method\\SpecificationInterface\n     *\/",61],["T_WHITESPACE","\n    ",63],["T_PROTECTED","protected",64],["T_WHITESPACE"," ",64],["T_VARIABLE","$paymentSpecification",64],";",["T_WHITESPACE","\n\n    ",64],["T_DOC_COMMENT","\/**\n     * Initialize dependencies.\n     *\n     * @var \\Magento\\Multishipping\\Helper\\Data\n     *\/",66],["T_WHITESPACE","\n    ",70],["T_PROTECTED","protected",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$helper",71],";",["T_WHITESPACE","\n\n    ",71],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Checkout\\Model\\Session\n     *\/",73],["T_WHITESPACE","\n    ",75],["T_PROTECTED","protected",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$_checkoutSession",76],";",["T_WHITESPACE","\n\n    ",76],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Customer\\Model\\Session\n     *\/",78],["T_WHITESPACE","\n    ",80],["T_PROTECTED","protected",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$_customerSession",81],";",["T_WHITESPACE","\n\n    ",81],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Sales\\Model\\OrderFactory\n     *\/",83],["T_WHITESPACE","\n    ",85],["T_PROTECTED","protected",86],["T_WHITESPACE"," ",86],["T_VARIABLE","$_orderFactory",86],";",["T_WHITESPACE","\n\n    ",86],["T_DOC_COMMENT","\/**\n     * @var AddressRepositoryInterface\n     *\/",88],["T_WHITESPACE","\n    ",90],["T_PROTECTED","protected",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$addressRepository",91],";",["T_WHITESPACE","\n\n    ",91],["T_DOC_COMMENT","\/**\n     * @var OrderSender\n     *\/",93],["T_WHITESPACE","\n    ",95],["T_PROTECTED","protected",96],["T_WHITESPACE"," ",96],["T_VARIABLE","$orderSender",96],";",["T_WHITESPACE","\n\n    ",96],["T_DOC_COMMENT","\/**\n     * @var PriceCurrencyInterface\n     *\/",98],["T_WHITESPACE","\n    ",100],["T_PROTECTED","protected",101],["T_WHITESPACE"," ",101],["T_VARIABLE","$priceCurrency",101],";",["T_WHITESPACE","\n\n    ",101],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Api\\CartRepositoryInterface\n     *\/",103],["T_WHITESPACE","\n    ",105],["T_PROTECTED","protected",106],["T_WHITESPACE"," ",106],["T_VARIABLE","$quoteRepository",106],";",["T_WHITESPACE","\n\n    ",106],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Api\\SearchCriteriaBuilder\n     *\/",108],["T_WHITESPACE","\n    ",110],["T_PROTECTED","protected",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$searchCriteriaBuilder",111],";",["T_WHITESPACE","\n\n    ",111],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Api\\FilterBuilder\n     *\/",113],["T_WHITESPACE","\n    ",115],["T_PROTECTED","protected",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$filterBuilder",116],";",["T_WHITESPACE","\n\n    ",116],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Model\\Quote\\Address\\ToOrder\n     *\/",118],["T_WHITESPACE","\n    ",120],["T_PROTECTED","protected",121],["T_WHITESPACE"," ",121],["T_VARIABLE","$quoteAddressToOrder",121],";",["T_WHITESPACE","\n\n    ",121],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Model\\Quote\\Item\\ToOrderItem\n     *\/",123],["T_WHITESPACE","\n    ",125],["T_PROTECTED","protected",126],["T_WHITESPACE"," ",126],["T_VARIABLE","$quoteItemToOrderItem",126],";",["T_WHITESPACE","\n\n    ",126],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Model\\Quote\\Payment\\ToOrderPayment\n     *\/",128],["T_WHITESPACE","\n    ",130],["T_PROTECTED","protected",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$quotePaymentToOrderPayment",131],";",["T_WHITESPACE","\n\n    ",131],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Model\\Quote\\Address\\ToOrderAddress\n     *\/",133],["T_WHITESPACE","\n    ",135],["T_PROTECTED","protected",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$quoteAddressToOrderAddress",136],";",["T_WHITESPACE","\n\n    ",136],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Model\\Quote\\TotalsCollector\n     *\/",138],["T_WHITESPACE","\n    ",140],["T_PROTECTED","protected",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$totalsCollector",141],";",["T_WHITESPACE","\n\n    ",141],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Api\\Data\\CartExtensionFactory\n     *\/",143],["T_WHITESPACE","\n    ",145],["T_PRIVATE","private",146],["T_WHITESPACE"," ",146],["T_VARIABLE","$cartExtensionFactory",146],";",["T_WHITESPACE","\n\n    ",146],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Quote\\Model\\Quote\\ShippingAssignment\\ShippingAssignmentProcessor\n     *\/",148],["T_WHITESPACE","\n    ",150],["T_PRIVATE","private",151],["T_WHITESPACE"," ",151],["T_VARIABLE","$shippingAssignmentProcessor",151],";",["T_WHITESPACE","\n\n    ",151],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Checkout\\Model\\Session $checkoutSession\n     * @param \\Magento\\Customer\\Model\\Session $customerSession\n     * @param \\Magento\\Sales\\Model\\OrderFactory $orderFactory\n     * @param AddressRepositoryInterface $addressRepository\n     * @param \\Magento\\Framework\\Event\\ManagerInterface $eventManager\n     * @param \\Magento\\Framework\\App\\Config\\ScopeConfigInterface $scopeConfig\n     * @param \\Magento\\Framework\\Session\\Generic $session\n     * @param \\Magento\\Quote\\Model\\Quote\\AddressFactory $addressFactory\n     * @param \\Magento\\Quote\\Model\\Quote\\Address\\ToOrder $quoteAddressToOrder\n     * @param \\Magento\\Quote\\Model\\Quote\\Address\\ToOrderAddress $quoteAddressToOrderAddress\n     * @param \\Magento\\Quote\\Model\\Quote\\Payment\\ToOrderPayment $quotePaymentToOrderPayment\n     * @param \\Magento\\Quote\\Model\\Quote\\Item\\ToOrderItem $quoteItemToOrderItem\n     * @param \\Magento\\Store\\Model\\StoreManagerInterface $storeManager\n     * @param \\Magento\\Payment\\Model\\Method\\SpecificationInterface $paymentSpecification\n     * @param \\Magento\\Multishipping\\Helper\\Data $helper\n     * @param OrderSender $orderSender\n     * @param PriceCurrencyInterface $priceCurrency\n     * @param \\Magento\\Quote\\Api\\CartRepositoryInterface $quoteRepository\n     * @param \\Magento\\Framework\\Api\\SearchCriteriaBuilder $searchCriteriaBuilder\n     * @param \\Magento\\Framework\\Api\\FilterBuilder $filterBuilder\n     * @param \\Magento\\Quote\\Model\\Quote\\TotalsCollector $totalsCollector\n     * @param array $data\n     * @SuppressWarnings(PHPMD.ExcessiveParameterList)\n     *\/",153],["T_WHITESPACE","\n    ",177],["T_PUBLIC","public",178],["T_WHITESPACE"," ",178],["T_FUNCTION","function",178],["T_WHITESPACE"," ",178],["T_STRING","__construct",178],"(",["T_WHITESPACE","\n        ",178],["T_NS_SEPARATOR","\\",179],["T_STRING","Magento",179],["T_NS_SEPARATOR","\\",179],["T_STRING","Checkout",179],["T_NS_SEPARATOR","\\",179],["T_STRING","Model",179],["T_NS_SEPARATOR","\\",179],["T_STRING","Session",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$checkoutSession",179],",",["T_WHITESPACE","\n        ",179],["T_NS_SEPARATOR","\\",180],["T_STRING","Magento",180],["T_NS_SEPARATOR","\\",180],["T_STRING","Customer",180],["T_NS_SEPARATOR","\\",180],["T_STRING","Model",180],["T_NS_SEPARATOR","\\",180],["T_STRING","Session",180],["T_WHITESPACE"," ",180],["T_VARIABLE","$customerSession",180],",",["T_WHITESPACE","\n        ",180],["T_NS_SEPARATOR","\\",181],["T_STRING","Magento",181],["T_NS_SEPARATOR","\\",181],["T_STRING","Sales",181],["T_NS_SEPARATOR","\\",181],["T_STRING","Model",181],["T_NS_SEPARATOR","\\",181],["T_STRING","OrderFactory",181],["T_WHITESPACE"," ",181],["T_VARIABLE","$orderFactory",181],",",["T_WHITESPACE","\n        ",181],["T_STRING","AddressRepositoryInterface",182],["T_WHITESPACE"," ",182],["T_VARIABLE","$addressRepository",182],",",["T_WHITESPACE","\n        ",182],["T_NS_SEPARATOR","\\",183],["T_STRING","Magento",183],["T_NS_SEPARATOR","\\",183],["T_STRING","Framework",183],["T_NS_SEPARATOR","\\",183],["T_STRING","Event",183],["T_NS_SEPARATOR","\\",183],["T_STRING","ManagerInterface",183],["T_WHITESPACE"," ",183],["T_VARIABLE","$eventManager",183],",",["T_WHITESPACE","\n        ",183],["T_NS_SEPARATOR","\\",184],["T_STRING","Magento",184],["T_NS_SEPARATOR","\\",184],["T_STRING","Framework",184],["T_NS_SEPARATOR","\\",184],["T_STRING","App",184],["T_NS_SEPARATOR","\\",184],["T_STRING","Config",184],["T_NS_SEPARATOR","\\",184],["T_STRING","ScopeConfigInterface",184],["T_WHITESPACE"," ",184],["T_VARIABLE","$scopeConfig",184],",",["T_WHITESPACE","\n        ",184],["T_NS_SEPARATOR","\\",185],["T_STRING","Magento",185],["T_NS_SEPARATOR","\\",185],["T_STRING","Framework",185],["T_NS_SEPARATOR","\\",185],["T_STRING","Session",185],["T_NS_SEPARATOR","\\",185],["T_STRING","Generic",185],["T_WHITESPACE"," ",185],["T_VARIABLE","$session",185],",",["T_WHITESPACE","\n        ",185],["T_NS_SEPARATOR","\\",186],["T_STRING","Magento",186],["T_NS_SEPARATOR","\\",186],["T_STRING","Quote",186],["T_NS_SEPARATOR","\\",186],["T_STRING","Model",186],["T_NS_SEPARATOR","\\",186],["T_STRING","Quote",186],["T_NS_SEPARATOR","\\",186],["T_STRING","AddressFactory",186],["T_WHITESPACE"," ",186],["T_VARIABLE","$addressFactory",186],",",["T_WHITESPACE","\n        ",186],["T_NS_SEPARATOR","\\",187],["T_STRING","Magento",187],["T_NS_SEPARATOR","\\",187],["T_STRING","Quote",187],["T_NS_SEPARATOR","\\",187],["T_STRING","Model",187],["T_NS_SEPARATOR","\\",187],["T_STRING","Quote",187],["T_NS_SEPARATOR","\\",187],["T_STRING","Address",187],["T_NS_SEPARATOR","\\",187],["T_STRING","ToOrder",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$quoteAddressToOrder",187],",",["T_WHITESPACE","\n        ",187],["T_NS_SEPARATOR","\\",188],["T_STRING","Magento",188],["T_NS_SEPARATOR","\\",188],["T_STRING","Quote",188],["T_NS_SEPARATOR","\\",188],["T_STRING","Model",188],["T_NS_SEPARATOR","\\",188],["T_STRING","Quote",188],["T_NS_SEPARATOR","\\",188],["T_STRING","Address",188],["T_NS_SEPARATOR","\\",188],["T_STRING","ToOrderAddress",188],["T_WHITESPACE"," ",188],["T_VARIABLE","$quoteAddressToOrderAddress",188],",",["T_WHITESPACE","\n        ",188],["T_NS_SEPARATOR","\\",189],["T_STRING","Magento",189],["T_NS_SEPARATOR","\\",189],["T_STRING","Quote",189],["T_NS_SEPARATOR","\\",189],["T_STRING","Model",189],["T_NS_SEPARATOR","\\",189],["T_STRING","Quote",189],["T_NS_SEPARATOR","\\",189],["T_STRING","Payment",189],["T_NS_SEPARATOR","\\",189],["T_STRING","ToOrderPayment",189],["T_WHITESPACE"," ",189],["T_VARIABLE","$quotePaymentToOrderPayment",189],",",["T_WHITESPACE","\n        ",189],["T_NS_SEPARATOR","\\",190],["T_STRING","Magento",190],["T_NS_SEPARATOR","\\",190],["T_STRING","Quote",190],["T_NS_SEPARATOR","\\",190],["T_STRING","Model",190],["T_NS_SEPARATOR","\\",190],["T_STRING","Quote",190],["T_NS_SEPARATOR","\\",190],["T_STRING","Item",190],["T_NS_SEPARATOR","\\",190],["T_STRING","ToOrderItem",190],["T_WHITESPACE"," ",190],["T_VARIABLE","$quoteItemToOrderItem",190],",",["T_WHITESPACE","\n        ",190],["T_NS_SEPARATOR","\\",191],["T_STRING","Magento",191],["T_NS_SEPARATOR","\\",191],["T_STRING","Store",191],["T_NS_SEPARATOR","\\",191],["T_STRING","Model",191],["T_NS_SEPARATOR","\\",191],["T_STRING","StoreManagerInterface",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$storeManager",191],",",["T_WHITESPACE","\n        ",191],["T_NS_SEPARATOR","\\",192],["T_STRING","Magento",192],["T_NS_SEPARATOR","\\",192],["T_STRING","Payment",192],["T_NS_SEPARATOR","\\",192],["T_STRING","Model",192],["T_NS_SEPARATOR","\\",192],["T_STRING","Method",192],["T_NS_SEPARATOR","\\",192],["T_STRING","SpecificationInterface",192],["T_WHITESPACE"," ",192],["T_VARIABLE","$paymentSpecification",192],",",["T_WHITESPACE","\n        ",192],["T_NS_SEPARATOR","\\",193],["T_STRING","Magento",193],["T_NS_SEPARATOR","\\",193],["T_STRING","Multishipping",193],["T_NS_SEPARATOR","\\",193],["T_STRING","Helper",193],["T_NS_SEPARATOR","\\",193],["T_STRING","Data",193],["T_WHITESPACE"," ",193],["T_VARIABLE","$helper",193],",",["T_WHITESPACE","\n        ",193],["T_STRING","OrderSender",194],["T_WHITESPACE"," ",194],["T_VARIABLE","$orderSender",194],",",["T_WHITESPACE","\n        ",194],["T_STRING","PriceCurrencyInterface",195],["T_WHITESPACE"," ",195],["T_VARIABLE","$priceCurrency",195],",",["T_WHITESPACE","\n        ",195],["T_NS_SEPARATOR","\\",196],["T_STRING","Magento",196],["T_NS_SEPARATOR","\\",196],["T_STRING","Quote",196],["T_NS_SEPARATOR","\\",196],["T_STRING","Api",196],["T_NS_SEPARATOR","\\",196],["T_STRING","CartRepositoryInterface",196],["T_WHITESPACE"," ",196],["T_VARIABLE","$quoteRepository",196],",",["T_WHITESPACE","\n        ",196],["T_NS_SEPARATOR","\\",197],["T_STRING","Magento",197],["T_NS_SEPARATOR","\\",197],["T_STRING","Framework",197],["T_NS_SEPARATOR","\\",197],["T_STRING","Api",197],["T_NS_SEPARATOR","\\",197],["T_STRING","SearchCriteriaBuilder",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$searchCriteriaBuilder",197],",",["T_WHITESPACE","\n        ",197],["T_NS_SEPARATOR","\\",198],["T_STRING","Magento",198],["T_NS_SEPARATOR","\\",198],["T_STRING","Framework",198],["T_NS_SEPARATOR","\\",198],["T_STRING","Api",198],["T_NS_SEPARATOR","\\",198],["T_STRING","FilterBuilder",198],["T_WHITESPACE"," ",198],["T_VARIABLE","$filterBuilder",198],",",["T_WHITESPACE","\n        ",198],["T_NS_SEPARATOR","\\",199],["T_STRING","Magento",199],["T_NS_SEPARATOR","\\",199],["T_STRING","Quote",199],["T_NS_SEPARATOR","\\",199],["T_STRING","Model",199],["T_NS_SEPARATOR","\\",199],["T_STRING","Quote",199],["T_NS_SEPARATOR","\\",199],["T_STRING","TotalsCollector",199],["T_WHITESPACE"," ",199],["T_VARIABLE","$totalsCollector",199],",",["T_WHITESPACE","\n        ",199],["T_ARRAY","array",200],["T_WHITESPACE"," ",200],["T_VARIABLE","$data",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],"[","]",["T_WHITESPACE","\n    ",200],")",["T_WHITESPACE"," ",201],"{",["T_WHITESPACE","\n        ",201],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","_eventManager",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_VARIABLE","$eventManager",202],";",["T_WHITESPACE","\n        ",202],["T_VARIABLE","$this",203],["T_OBJECT_OPERATOR","->",203],["T_STRING","_scopeConfig",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_VARIABLE","$scopeConfig",203],";",["T_WHITESPACE","\n        ",203],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","_session",204],["T_WHITESPACE"," ",204],"=",["T_WHITESPACE"," ",204],["T_VARIABLE","$session",204],";",["T_WHITESPACE","\n        ",204],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","_addressFactory",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_VARIABLE","$addressFactory",205],";",["T_WHITESPACE","\n        ",205],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","_storeManager",206],["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],["T_VARIABLE","$storeManager",206],";",["T_WHITESPACE","\n        ",206],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","paymentSpecification",207],["T_WHITESPACE"," ",207],"=",["T_WHITESPACE"," ",207],["T_VARIABLE","$paymentSpecification",207],";",["T_WHITESPACE","\n        ",207],["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","helper",208],["T_WHITESPACE"," ",208],"=",["T_WHITESPACE"," ",208],["T_VARIABLE","$helper",208],";",["T_WHITESPACE","\n        ",208],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","_checkoutSession",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_VARIABLE","$checkoutSession",209],";",["T_WHITESPACE","\n        ",209],["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","_customerSession",210],["T_WHITESPACE"," ",210],"=",["T_WHITESPACE"," ",210],["T_VARIABLE","$customerSession",210],";",["T_WHITESPACE","\n        ",210],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","_orderFactory",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_VARIABLE","$orderFactory",211],";",["T_WHITESPACE","\n        ",211],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","addressRepository",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_VARIABLE","$addressRepository",212],";",["T_WHITESPACE","\n        ",212],["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","orderSender",213],["T_WHITESPACE"," ",213],"=",["T_WHITESPACE"," ",213],["T_VARIABLE","$orderSender",213],";",["T_WHITESPACE","\n        ",213],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","priceCurrency",214],["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_VARIABLE","$priceCurrency",214],";",["T_WHITESPACE","\n        ",214],["T_VARIABLE","$this",215],["T_OBJECT_OPERATOR","->",215],["T_STRING","quoteRepository",215],["T_WHITESPACE"," ",215],"=",["T_WHITESPACE"," ",215],["T_VARIABLE","$quoteRepository",215],";",["T_WHITESPACE","\n        ",215],["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","searchCriteriaBuilder",216],["T_WHITESPACE"," ",216],"=",["T_WHITESPACE"," ",216],["T_VARIABLE","$searchCriteriaBuilder",216],";",["T_WHITESPACE","\n        ",216],["T_VARIABLE","$this",217],["T_OBJECT_OPERATOR","->",217],["T_STRING","filterBuilder",217],["T_WHITESPACE"," ",217],"=",["T_WHITESPACE"," ",217],["T_VARIABLE","$filterBuilder",217],";",["T_WHITESPACE","\n        ",217],["T_VARIABLE","$this",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","quoteAddressToOrder",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_VARIABLE","$quoteAddressToOrder",218],";",["T_WHITESPACE","\n        ",218],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","quoteItemToOrderItem",219],["T_WHITESPACE"," ",219],"=",["T_WHITESPACE"," ",219],["T_VARIABLE","$quoteItemToOrderItem",219],";",["T_WHITESPACE","\n        ",219],["T_VARIABLE","$this",220],["T_OBJECT_OPERATOR","->",220],["T_STRING","quotePaymentToOrderPayment",220],["T_WHITESPACE"," ",220],"=",["T_WHITESPACE"," ",220],["T_VARIABLE","$quotePaymentToOrderPayment",220],";",["T_WHITESPACE","\n        ",220],["T_VARIABLE","$this",221],["T_OBJECT_OPERATOR","->",221],["T_STRING","quoteAddressToOrderAddress",221],["T_WHITESPACE"," ",221],"=",["T_WHITESPACE"," ",221],["T_VARIABLE","$quoteAddressToOrderAddress",221],";",["T_WHITESPACE","\n        ",221],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","totalsCollector",222],["T_WHITESPACE"," ",222],"=",["T_WHITESPACE"," ",222],["T_VARIABLE","$totalsCollector",222],";",["T_WHITESPACE","\n        ",222],["T_STRING","parent",223],["T_DOUBLE_COLON","::",223],["T_STRING","__construct",223],"(",["T_VARIABLE","$data",223],")",";",["T_WHITESPACE","\n        ",223],["T_VARIABLE","$this",224],["T_OBJECT_OPERATOR","->",224],["T_STRING","_init",224],"(",")",";",["T_WHITESPACE","\n    ",224],"}",["T_WHITESPACE","\n\n    ",225],["T_DOC_COMMENT","\/**\n     * Initialize multishipping checkout.\n     * Split virtual\/not virtual items between default billing\/shipping addresses\n     *\n     * @return \\Magento\\Multishipping\\Model\\Checkout\\Type\\Multishipping\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     *\/",227],["T_WHITESPACE","\n    ",233],["T_PROTECTED","protected",234],["T_WHITESPACE"," ",234],["T_FUNCTION","function",234],["T_WHITESPACE"," ",234],["T_STRING","_init",234],"(",")",["T_WHITESPACE","\n    ",234],"{",["T_WHITESPACE","\n        ",235],["T_DOC_COMMENT","\/**\n         * reset quote shipping addresses and items\n         *\/",236],["T_WHITESPACE","\n        ",238],["T_VARIABLE","$quote",239],["T_WHITESPACE"," ",239],"=",["T_WHITESPACE"," ",239],["T_VARIABLE","$this",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","getQuote",239],"(",")",";",["T_WHITESPACE","\n        ",239],["T_IF","if",240],["T_WHITESPACE"," ",240],"(","!",["T_VARIABLE","$this",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","getCustomer",240],"(",")",["T_OBJECT_OPERATOR","->",240],["T_STRING","getId",240],"(",")",")",["T_WHITESPACE"," ",240],"{",["T_WHITESPACE","\n            ",240],["T_RETURN","return",241],["T_WHITESPACE"," ",241],["T_VARIABLE","$this",241],";",["T_WHITESPACE","\n        ",241],"}",["T_WHITESPACE","\n\n        ",242],["T_IF","if",244],["T_WHITESPACE"," ",244],"(",["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","getCheckoutSession",244],"(",")",["T_OBJECT_OPERATOR","->",244],["T_STRING","getCheckoutState",244],"(",")",["T_WHITESPACE"," ",244],["T_IS_IDENTICAL","===",244],["T_WHITESPACE"," ",244],["T_NS_SEPARATOR","\\",244],["T_STRING","Magento",244],["T_NS_SEPARATOR","\\",244],["T_STRING","Checkout",244],["T_NS_SEPARATOR","\\",244],["T_STRING","Model",244],["T_NS_SEPARATOR","\\",244],["T_STRING","Session",244],["T_DOUBLE_COLON","::",244],["T_STRING","CHECKOUT_STATE_BEGIN",244],["T_WHITESPACE","\n        ",244],")",["T_WHITESPACE"," ",245],"{",["T_WHITESPACE","\n            ",245],["T_VARIABLE","$this",246],["T_OBJECT_OPERATOR","->",246],["T_STRING","getCheckoutSession",246],"(",")",["T_OBJECT_OPERATOR","->",246],["T_STRING","setCheckoutState",246],"(",["T_STRING","true",246],")",";",["T_WHITESPACE","\n            ",246],["T_DOC_COMMENT","\/**\n             * Remove all addresses\n             *\/",247],["T_WHITESPACE","\n            ",249],["T_VARIABLE","$addresses",250],["T_WHITESPACE"," ",250],"=",["T_WHITESPACE"," ",250],["T_VARIABLE","$quote",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","getAllAddresses",250],"(",")",";",["T_WHITESPACE","\n            ",250],["T_FOREACH","foreach",251],["T_WHITESPACE"," ",251],"(",["T_VARIABLE","$addresses",251],["T_WHITESPACE"," ",251],["T_AS","as",251],["T_WHITESPACE"," ",251],["T_VARIABLE","$address",251],")",["T_WHITESPACE"," ",251],"{",["T_WHITESPACE","\n                ",251],["T_VARIABLE","$quote",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","removeAddress",252],"(",["T_VARIABLE","$address",252],["T_OBJECT_OPERATOR","->",252],["T_STRING","getId",252],"(",")",")",";",["T_WHITESPACE","\n            ",252],"}",["T_WHITESPACE","\n\n            ",253],["T_VARIABLE","$defaultShippingId",255],["T_WHITESPACE"," ",255],"=",["T_WHITESPACE"," ",255],["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","getCustomerDefaultShippingAddress",255],"(",")",";",["T_WHITESPACE","\n            ",255],["T_IF","if",256],["T_WHITESPACE"," ",256],"(",["T_VARIABLE","$defaultShippingId",256],")",["T_WHITESPACE"," ",256],"{",["T_WHITESPACE","\n                ",256],["T_VARIABLE","$quote",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","getShippingAddress",257],"(",")",["T_OBJECT_OPERATOR","->",257],["T_STRING","importCustomerAddressData",257],"(",["T_WHITESPACE","\n                    ",257],["T_VARIABLE","$this",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","addressRepository",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","getById",258],"(",["T_VARIABLE","$defaultShippingId",258],")",["T_WHITESPACE","\n                ",258],")",";",["T_WHITESPACE","\n\n                ",259],["T_FOREACH","foreach",261],["T_WHITESPACE"," ",261],"(",["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","getQuoteItems",261],"(",")",["T_WHITESPACE"," ",261],["T_AS","as",261],["T_WHITESPACE"," ",261],["T_VARIABLE","$item",261],")",["T_WHITESPACE"," ",261],"{",["T_WHITESPACE","\n                    ",261],["T_DOC_COMMENT","\/**\n                     * Items with parent id we add in importQuoteItem method.\n                     * Skip virtual items\n                     *\/",262],["T_WHITESPACE","\n                    ",265],["T_IF","if",266],["T_WHITESPACE"," ",266],"(",["T_VARIABLE","$item",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","getParentItemId",266],"(",")",["T_WHITESPACE"," ",266],["T_BOOLEAN_OR","||",266],["T_WHITESPACE"," ",266],["T_VARIABLE","$item",266],["T_OBJECT_OPERATOR","->",266],["T_STRING","getProduct",266],"(",")",["T_OBJECT_OPERATOR","->",266],["T_STRING","getIsVirtual",266],"(",")",")",["T_WHITESPACE"," ",266],"{",["T_WHITESPACE","\n                        ",266],["T_CONTINUE","continue",267],";",["T_WHITESPACE","\n                    ",267],"}",["T_WHITESPACE","\n                    ",268],["T_VARIABLE","$quote",269],["T_OBJECT_OPERATOR","->",269],["T_STRING","getShippingAddress",269],"(",")",["T_OBJECT_OPERATOR","->",269],["T_STRING","addItem",269],"(",["T_VARIABLE","$item",269],")",";",["T_WHITESPACE","\n                ",269],"}",["T_WHITESPACE","\n            ",270],"}",["T_WHITESPACE","\n\n            ",271],["T_VARIABLE","$defaultBillingAddressId",273],["T_WHITESPACE"," ",273],"=",["T_WHITESPACE"," ",273],["T_VARIABLE","$this",273],["T_OBJECT_OPERATOR","->",273],["T_STRING","getCustomerDefaultBillingAddress",273],"(",")",";",["T_WHITESPACE","\n            ",273],["T_IF","if",274],["T_WHITESPACE"," ",274],"(",["T_VARIABLE","$defaultBillingAddressId",274],")",["T_WHITESPACE"," ",274],"{",["T_WHITESPACE","\n                ",274],["T_VARIABLE","$quote",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","getBillingAddress",275],"(",")",["T_OBJECT_OPERATOR","->",275],["T_STRING","importCustomerAddressData",275],"(",["T_WHITESPACE","\n                    ",275],["T_VARIABLE","$this",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","addressRepository",276],["T_OBJECT_OPERATOR","->",276],["T_STRING","getById",276],"(",["T_VARIABLE","$defaultBillingAddressId",276],")",["T_WHITESPACE","\n                ",276],")",";",["T_WHITESPACE","\n                ",277],["T_FOREACH","foreach",278],["T_WHITESPACE"," ",278],"(",["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","getQuoteItems",278],"(",")",["T_WHITESPACE"," ",278],["T_AS","as",278],["T_WHITESPACE"," ",278],["T_VARIABLE","$item",278],")",["T_WHITESPACE"," ",278],"{",["T_WHITESPACE","\n                    ",278],["T_IF","if",279],["T_WHITESPACE"," ",279],"(",["T_VARIABLE","$item",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","getParentItemId",279],"(",")",")",["T_WHITESPACE"," ",279],"{",["T_WHITESPACE","\n                        ",279],["T_CONTINUE","continue",280],";",["T_WHITESPACE","\n                    ",280],"}",["T_WHITESPACE","\n                    ",281],["T_IF","if",282],["T_WHITESPACE"," ",282],"(",["T_VARIABLE","$item",282],["T_OBJECT_OPERATOR","->",282],["T_STRING","getProduct",282],"(",")",["T_OBJECT_OPERATOR","->",282],["T_STRING","getIsVirtual",282],"(",")",")",["T_WHITESPACE"," ",282],"{",["T_WHITESPACE","\n                        ",282],["T_VARIABLE","$quote",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","getBillingAddress",283],"(",")",["T_OBJECT_OPERATOR","->",283],["T_STRING","addItem",283],"(",["T_VARIABLE","$item",283],")",";",["T_WHITESPACE","\n                    ",283],"}",["T_WHITESPACE","\n                ",284],"}",["T_WHITESPACE","\n            ",285],"}",["T_WHITESPACE","\n            ",286],["T_VARIABLE","$this",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","save",287],"(",")",";",["T_WHITESPACE","\n        ",287],"}",["T_WHITESPACE","\n        ",288],["T_RETURN","return",289],["T_WHITESPACE"," ",289],["T_VARIABLE","$this",289],";",["T_WHITESPACE","\n    ",289],"}",["T_WHITESPACE","\n\n    ",290],["T_DOC_COMMENT","\/**\n     * Get quote items assigned to different quote addresses populated per item qty.\n     * Based on result array we can display each item separately\n     *\n     * @return array\n     *\/",292],["T_WHITESPACE","\n    ",297],["T_PUBLIC","public",298],["T_WHITESPACE"," ",298],["T_FUNCTION","function",298],["T_WHITESPACE"," ",298],["T_STRING","getQuoteShippingAddressesItems",298],"(",")",["T_WHITESPACE","\n    ",298],"{",["T_WHITESPACE","\n        ",299],["T_IF","if",300],["T_WHITESPACE"," ",300],"(",["T_VARIABLE","$this",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","_quoteShippingAddressesItems",300],["T_WHITESPACE"," ",300],["T_IS_NOT_IDENTICAL","!==",300],["T_WHITESPACE"," ",300],["T_STRING","null",300],")",["T_WHITESPACE"," ",300],"{",["T_WHITESPACE","\n            ",300],["T_RETURN","return",301],["T_WHITESPACE"," ",301],["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","_quoteShippingAddressesItems",301],";",["T_WHITESPACE","\n        ",301],"}",["T_WHITESPACE","\n        ",302],["T_VARIABLE","$this",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","_quoteShippingAddressesItems",303],["T_WHITESPACE"," ",303],"=",["T_WHITESPACE"," ",303],["T_VARIABLE","$this",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","getQuote",303],"(",")",["T_OBJECT_OPERATOR","->",303],["T_STRING","getShippingAddressesItems",303],"(",")",";",["T_WHITESPACE","\n        ",303],["T_RETURN","return",304],["T_WHITESPACE"," ",304],["T_VARIABLE","$this",304],["T_OBJECT_OPERATOR","->",304],["T_STRING","_quoteShippingAddressesItems",304],";",["T_WHITESPACE","\n    ",304],"}",["T_WHITESPACE","\n\n    ",305],["T_DOC_COMMENT","\/**\n     * Remove item from address\n     *\n     * @param int $addressId\n     * @param int $itemId\n     * @return \\Magento\\Multishipping\\Model\\Checkout\\Type\\Multishipping\n     *\/",307],["T_WHITESPACE","\n    ",313],["T_PUBLIC","public",314],["T_WHITESPACE"," ",314],["T_FUNCTION","function",314],["T_WHITESPACE"," ",314],["T_STRING","removeAddressItem",314],"(",["T_VARIABLE","$addressId",314],",",["T_WHITESPACE"," ",314],["T_VARIABLE","$itemId",314],")",["T_WHITESPACE","\n    ",314],"{",["T_WHITESPACE","\n        ",315],["T_VARIABLE","$address",316],["T_WHITESPACE"," ",316],"=",["T_WHITESPACE"," ",316],["T_VARIABLE","$this",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","getQuote",316],"(",")",["T_OBJECT_OPERATOR","->",316],["T_STRING","getAddressById",316],"(",["T_VARIABLE","$addressId",316],")",";",["T_WHITESPACE","\n        ",316],["T_COMMENT","\/* @var $address \\Magento\\Quote\\Model\\Quote\\Address *\/",317],["T_WHITESPACE","\n        ",317],["T_IF","if",318],["T_WHITESPACE"," ",318],"(",["T_VARIABLE","$address",318],")",["T_WHITESPACE"," ",318],"{",["T_WHITESPACE","\n            ",318],["T_VARIABLE","$item",319],["T_WHITESPACE"," ",319],"=",["T_WHITESPACE"," ",319],["T_VARIABLE","$address",319],["T_OBJECT_OPERATOR","->",319],["T_STRING","getValidItemById",319],"(",["T_VARIABLE","$itemId",319],")",";",["T_WHITESPACE","\n            ",319],["T_IF","if",320],["T_WHITESPACE"," ",320],"(",["T_VARIABLE","$item",320],")",["T_WHITESPACE"," ",320],"{",["T_WHITESPACE","\n                ",320],["T_IF","if",321],["T_WHITESPACE"," ",321],"(",["T_VARIABLE","$item",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","getQty",321],"(",")",["T_WHITESPACE"," ",321],">",["T_WHITESPACE"," ",321],["T_LNUMBER","1",321],["T_WHITESPACE"," ",321],["T_BOOLEAN_AND","&&",321],["T_WHITESPACE"," ",321],"!",["T_VARIABLE","$item",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","getProduct",321],"(",")",["T_OBJECT_OPERATOR","->",321],["T_STRING","getIsVirtual",321],"(",")",")",["T_WHITESPACE"," ",321],"{",["T_WHITESPACE","\n                    ",321],["T_VARIABLE","$item",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","setQty",322],"(",["T_VARIABLE","$item",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","getQty",322],"(",")",["T_WHITESPACE"," ",322],"-",["T_WHITESPACE"," ",322],["T_LNUMBER","1",322],")",";",["T_WHITESPACE","\n                ",322],"}",["T_WHITESPACE"," ",323],["T_ELSE","else",323],["T_WHITESPACE"," ",323],"{",["T_WHITESPACE","\n                    ",323],["T_VARIABLE","$address",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","removeItem",324],"(",["T_VARIABLE","$item",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","getId",324],"(",")",")",";",["T_WHITESPACE","\n                ",324],"}",["T_WHITESPACE","\n\n                ",325],["T_DOC_COMMENT","\/**\n                 * Require shipping rate recollect\n                 *\/",327],["T_WHITESPACE","\n                ",329],["T_VARIABLE","$address",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","setCollectShippingRates",330],"(",["T_BOOL_CAST","(bool)",330],["T_VARIABLE","$this",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","getCollectRatesFlag",330],"(",")",")",";",["T_WHITESPACE","\n\n                ",330],["T_IF","if",332],["T_WHITESPACE"," ",332],"(",["T_STRING","count",332],"(",["T_VARIABLE","$address",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","getAllItems",332],"(",")",")",["T_WHITESPACE"," ",332],["T_IS_EQUAL","==",332],["T_WHITESPACE"," ",332],["T_LNUMBER","0",332],")",["T_WHITESPACE"," ",332],"{",["T_WHITESPACE","\n                    ",332],["T_VARIABLE","$address",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","isDeleted",333],"(",["T_STRING","true",333],")",";",["T_WHITESPACE","\n                ",333],"}",["T_WHITESPACE","\n\n                ",334],["T_VARIABLE","$quoteItem",336],["T_WHITESPACE"," ",336],"=",["T_WHITESPACE"," ",336],["T_VARIABLE","$this",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","getQuote",336],"(",")",["T_OBJECT_OPERATOR","->",336],["T_STRING","getItemById",336],"(",["T_VARIABLE","$item",336],["T_OBJECT_OPERATOR","->",336],["T_STRING","getQuoteItemId",336],"(",")",")",";",["T_WHITESPACE","\n                ",336],["T_IF","if",337],["T_WHITESPACE"," ",337],"(",["T_VARIABLE","$quoteItem",337],")",["T_WHITESPACE"," ",337],"{",["T_WHITESPACE","\n                    ",337],["T_VARIABLE","$newItemQty",338],["T_WHITESPACE"," ",338],"=",["T_WHITESPACE"," ",338],["T_VARIABLE","$quoteItem",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","getQty",338],"(",")",["T_WHITESPACE"," ",338],"-",["T_WHITESPACE"," ",338],["T_LNUMBER","1",338],";",["T_WHITESPACE","\n                    ",338],["T_IF","if",339],["T_WHITESPACE"," ",339],"(",["T_VARIABLE","$newItemQty",339],["T_WHITESPACE"," ",339],">",["T_WHITESPACE"," ",339],["T_LNUMBER","0",339],["T_WHITESPACE"," ",339],["T_BOOLEAN_AND","&&",339],["T_WHITESPACE"," ",339],"!",["T_VARIABLE","$item",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","getProduct",339],"(",")",["T_OBJECT_OPERATOR","->",339],["T_STRING","getIsVirtual",339],"(",")",")",["T_WHITESPACE"," ",339],"{",["T_WHITESPACE","\n                        ",339],["T_VARIABLE","$quoteItem",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","setQty",340],"(",["T_VARIABLE","$quoteItem",340],["T_OBJECT_OPERATOR","->",340],["T_STRING","getQty",340],"(",")",["T_WHITESPACE"," ",340],"-",["T_WHITESPACE"," ",340],["T_LNUMBER","1",340],")",";",["T_WHITESPACE","\n                    ",340],"}",["T_WHITESPACE"," ",341],["T_ELSE","else",341],["T_WHITESPACE"," ",341],"{",["T_WHITESPACE","\n                        ",341],["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","getQuote",342],"(",")",["T_OBJECT_OPERATOR","->",342],["T_STRING","removeItem",342],"(",["T_VARIABLE","$quoteItem",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","getId",342],"(",")",")",";",["T_WHITESPACE","\n                    ",342],"}",["T_WHITESPACE","\n                ",343],"}",["T_WHITESPACE","\n                ",344],["T_VARIABLE","$this",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","save",345],"(",")",";",["T_WHITESPACE","\n            ",345],"}",["T_WHITESPACE","\n        ",346],"}",["T_WHITESPACE","\n        ",347],["T_RETURN","return",348],["T_WHITESPACE"," ",348],["T_VARIABLE","$this",348],";",["T_WHITESPACE","\n    ",348],"}",["T_WHITESPACE","\n\n    ",349],["T_DOC_COMMENT","\/**\n     * Assign quote items to addresses and specify items qty\n     *\n     * array structure:\n     * array(\n     *      $quoteItemId => array(\n     *          'qty'       => $qty,\n     *          'address'   => $customerAddressId\n     *      )\n     * )\n     *\n     * @param array $info\n     * @return \\Magento\\Multishipping\\Model\\Checkout\\Type\\Multishipping\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     * @SuppressWarnings(PHPMD.NPathComplexity)\n     *\/",351],["T_WHITESPACE","\n    ",367],["T_PUBLIC","public",368],["T_WHITESPACE"," ",368],["T_FUNCTION","function",368],["T_WHITESPACE"," ",368],["T_STRING","setShippingItemsInformation",368],"(",["T_VARIABLE","$info",368],")",["T_WHITESPACE","\n    ",368],"{",["T_WHITESPACE","\n        ",369],["T_IF","if",370],["T_WHITESPACE"," ",370],"(",["T_STRING","is_array",370],"(",["T_VARIABLE","$info",370],")",")",["T_WHITESPACE"," ",370],"{",["T_WHITESPACE","\n            ",370],["T_VARIABLE","$allQty",371],["T_WHITESPACE"," ",371],"=",["T_WHITESPACE"," ",371],["T_LNUMBER","0",371],";",["T_WHITESPACE","\n            ",371],["T_VARIABLE","$itemsInfo",372],["T_WHITESPACE"," ",372],"=",["T_WHITESPACE"," ",372],"[","]",";",["T_WHITESPACE","\n            ",372],["T_FOREACH","foreach",373],["T_WHITESPACE"," ",373],"(",["T_VARIABLE","$info",373],["T_WHITESPACE"," ",373],["T_AS","as",373],["T_WHITESPACE"," ",373],["T_VARIABLE","$itemData",373],")",["T_WHITESPACE"," ",373],"{",["T_WHITESPACE","\n                ",373],["T_FOREACH","foreach",374],["T_WHITESPACE"," ",374],"(",["T_VARIABLE","$itemData",374],["T_WHITESPACE"," ",374],["T_AS","as",374],["T_WHITESPACE"," ",374],["T_VARIABLE","$quoteItemId",374],["T_WHITESPACE"," ",374],["T_DOUBLE_ARROW","=>",374],["T_WHITESPACE"," ",374],["T_VARIABLE","$data",374],")",["T_WHITESPACE"," ",374],"{",["T_WHITESPACE","\n                    ",374],["T_VARIABLE","$allQty",375],["T_WHITESPACE"," ",375],["T_PLUS_EQUAL","+=",375],["T_WHITESPACE"," ",375],["T_VARIABLE","$data",375],"[",["T_CONSTANT_ENCAPSED_STRING","'qty'",375],"]",";",["T_WHITESPACE","\n                    ",375],["T_VARIABLE","$itemsInfo",376],"[",["T_VARIABLE","$quoteItemId",376],"]",["T_WHITESPACE"," ",376],"=",["T_WHITESPACE"," ",376],["T_VARIABLE","$data",376],";",["T_WHITESPACE","\n                ",376],"}",["T_WHITESPACE","\n            ",377],"}",["T_WHITESPACE","\n\n            ",378],["T_VARIABLE","$maxQty",380],["T_WHITESPACE"," ",380],"=",["T_WHITESPACE"," ",380],["T_VARIABLE","$this",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","helper",380],["T_OBJECT_OPERATOR","->",380],["T_STRING","getMaximumQty",380],"(",")",";",["T_WHITESPACE","\n            ",380],["T_IF","if",381],["T_WHITESPACE"," ",381],"(",["T_VARIABLE","$allQty",381],["T_WHITESPACE"," ",381],">",["T_WHITESPACE"," ",381],["T_VARIABLE","$maxQty",381],")",["T_WHITESPACE"," ",381],"{",["T_WHITESPACE","\n                ",381],["T_THROW","throw",382],["T_WHITESPACE"," ",382],["T_NEW","new",382],["T_WHITESPACE"," ",382],["T_NS_SEPARATOR","\\",382],["T_STRING","Magento",382],["T_NS_SEPARATOR","\\",382],["T_STRING","Framework",382],["T_NS_SEPARATOR","\\",382],["T_STRING","Exception",382],["T_NS_SEPARATOR","\\",382],["T_STRING","LocalizedException",382],"(",["T_WHITESPACE","\n                    ",382],["T_STRING","__",383],"(",["T_CONSTANT_ENCAPSED_STRING","'Maximum qty allowed for Shipping to multiple addresses is %1'",383],",",["T_WHITESPACE"," ",383],["T_VARIABLE","$maxQty",383],")",["T_WHITESPACE","\n                ",383],")",";",["T_WHITESPACE","\n            ",384],"}",["T_WHITESPACE","\n            ",385],["T_VARIABLE","$quote",386],["T_WHITESPACE"," ",386],"=",["T_WHITESPACE"," ",386],["T_VARIABLE","$this",386],["T_OBJECT_OPERATOR","->",386],["T_STRING","getQuote",386],"(",")",";",["T_WHITESPACE","\n            ",386],["T_VARIABLE","$addresses",387],["T_WHITESPACE"," ",387],"=",["T_WHITESPACE"," ",387],["T_VARIABLE","$quote",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","getAllShippingAddresses",387],"(",")",";",["T_WHITESPACE","\n            ",387],["T_FOREACH","foreach",388],["T_WHITESPACE"," ",388],"(",["T_VARIABLE","$addresses",388],["T_WHITESPACE"," ",388],["T_AS","as",388],["T_WHITESPACE"," ",388],["T_VARIABLE","$address",388],")",["T_WHITESPACE"," ",388],"{",["T_WHITESPACE","\n                ",388],["T_VARIABLE","$quote",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","removeAddress",389],"(",["T_VARIABLE","$address",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","getId",389],"(",")",")",";",["T_WHITESPACE","\n            ",389],"}",["T_WHITESPACE","\n\n            ",390],["T_FOREACH","foreach",392],["T_WHITESPACE"," ",392],"(",["T_VARIABLE","$info",392],["T_WHITESPACE"," ",392],["T_AS","as",392],["T_WHITESPACE"," ",392],["T_VARIABLE","$itemData",392],")",["T_WHITESPACE"," ",392],"{",["T_WHITESPACE","\n                ",392],["T_FOREACH","foreach",393],["T_WHITESPACE"," ",393],"(",["T_VARIABLE","$itemData",393],["T_WHITESPACE"," ",393],["T_AS","as",393],["T_WHITESPACE"," ",393],["T_VARIABLE","$quoteItemId",393],["T_WHITESPACE"," ",393],["T_DOUBLE_ARROW","=>",393],["T_WHITESPACE"," ",393],["T_VARIABLE","$data",393],")",["T_WHITESPACE"," ",393],"{",["T_WHITESPACE","\n                    ",393],["T_VARIABLE","$this",394],["T_OBJECT_OPERATOR","->",394],["T_STRING","_addShippingItem",394],"(",["T_VARIABLE","$quoteItemId",394],",",["T_WHITESPACE"," ",394],["T_VARIABLE","$data",394],")",";",["T_WHITESPACE","\n                ",394],"}",["T_WHITESPACE","\n            ",395],"}",["T_WHITESPACE","\n\n            ",396],["T_VARIABLE","$this",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","prepareShippingAssignment",398],"(",["T_VARIABLE","$quote",398],")",";",["T_WHITESPACE","\n\n            ",398],["T_DOC_COMMENT","\/**\n             * Delete all not virtual quote items which are not added to shipping address\n             * MultishippingQty should be defined for each quote item when it processed with _addShippingItem\n             *\/",400],["T_WHITESPACE","\n            ",403],["T_FOREACH","foreach",404],["T_WHITESPACE"," ",404],"(",["T_VARIABLE","$quote",404],["T_OBJECT_OPERATOR","->",404],["T_STRING","getAllItems",404],"(",")",["T_WHITESPACE"," ",404],["T_AS","as",404],["T_WHITESPACE"," ",404],["T_VARIABLE","$_item",404],")",["T_WHITESPACE"," ",404],"{",["T_WHITESPACE","\n                ",404],["T_IF","if",405],["T_WHITESPACE"," ",405],"(","!",["T_VARIABLE","$_item",405],["T_OBJECT_OPERATOR","->",405],["T_STRING","getProduct",405],"(",")",["T_OBJECT_OPERATOR","->",405],["T_STRING","getIsVirtual",405],"(",")",["T_WHITESPACE"," ",405],["T_BOOLEAN_AND","&&",405],["T_WHITESPACE"," ",405],"!",["T_VARIABLE","$_item",405],["T_OBJECT_OPERATOR","->",405],["T_STRING","getParentItem",405],"(",")",["T_WHITESPACE"," ",405],["T_BOOLEAN_AND","&&",405],["T_WHITESPACE"," ",405],"!",["T_VARIABLE","$_item",405],["T_OBJECT_OPERATOR","->",405],["T_STRING","getMultishippingQty",405],"(",")",["T_WHITESPACE","\n                ",405],")",["T_WHITESPACE"," ",406],"{",["T_WHITESPACE","\n                    ",406],["T_VARIABLE","$quote",407],["T_OBJECT_OPERATOR","->",407],["T_STRING","removeItem",407],"(",["T_VARIABLE","$_item",407],["T_OBJECT_OPERATOR","->",407],["T_STRING","getId",407],"(",")",")",";",["T_WHITESPACE","\n                ",407],"}",["T_WHITESPACE","\n            ",408],"}",["T_WHITESPACE","\n\n            ",409],["T_VARIABLE","$billingAddress",411],["T_WHITESPACE"," ",411],"=",["T_WHITESPACE"," ",411],["T_VARIABLE","$quote",411],["T_OBJECT_OPERATOR","->",411],["T_STRING","getBillingAddress",411],"(",")",";",["T_WHITESPACE","\n            ",411],["T_IF","if",412],["T_WHITESPACE"," ",412],"(",["T_VARIABLE","$billingAddress",412],")",["T_WHITESPACE"," ",412],"{",["T_WHITESPACE","\n                ",412],["T_VARIABLE","$quote",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","removeAddress",413],"(",["T_VARIABLE","$billingAddress",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","getId",413],"(",")",")",";",["T_WHITESPACE","\n            ",413],"}",["T_WHITESPACE","\n\n            ",414],["T_VARIABLE","$customerDefaultBillingId",416],["T_WHITESPACE"," ",416],"=",["T_WHITESPACE"," ",416],["T_VARIABLE","$this",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","getCustomerDefaultBillingAddress",416],"(",")",";",["T_WHITESPACE","\n            ",416],["T_IF","if",417],["T_WHITESPACE"," ",417],"(",["T_VARIABLE","$customerDefaultBillingId",417],")",["T_WHITESPACE"," ",417],"{",["T_WHITESPACE","\n                ",417],["T_VARIABLE","$quote",418],["T_OBJECT_OPERATOR","->",418],["T_STRING","getBillingAddress",418],"(",")",["T_OBJECT_OPERATOR","->",418],["T_STRING","importCustomerAddressData",418],"(",["T_WHITESPACE","\n                    ",418],["T_VARIABLE","$this",419],["T_OBJECT_OPERATOR","->",419],["T_STRING","addressRepository",419],["T_OBJECT_OPERATOR","->",419],["T_STRING","getById",419],"(",["T_VARIABLE","$customerDefaultBillingId",419],")",["T_WHITESPACE","\n                ",419],")",";",["T_WHITESPACE","\n            ",420],"}",["T_WHITESPACE","\n\n            ",421],["T_FOREACH","foreach",423],["T_WHITESPACE"," ",423],"(",["T_VARIABLE","$quote",423],["T_OBJECT_OPERATOR","->",423],["T_STRING","getAllItems",423],"(",")",["T_WHITESPACE"," ",423],["T_AS","as",423],["T_WHITESPACE"," ",423],["T_VARIABLE","$_item",423],")",["T_WHITESPACE"," ",423],"{",["T_WHITESPACE","\n                ",423],["T_IF","if",424],["T_WHITESPACE"," ",424],"(","!",["T_VARIABLE","$_item",424],["T_OBJECT_OPERATOR","->",424],["T_STRING","getProduct",424],"(",")",["T_OBJECT_OPERATOR","->",424],["T_STRING","getIsVirtual",424],"(",")",")",["T_WHITESPACE"," ",424],"{",["T_WHITESPACE","\n                    ",424],["T_CONTINUE","continue",425],";",["T_WHITESPACE","\n                ",425],"}",["T_WHITESPACE","\n\n                ",426],["T_IF","if",428],["T_WHITESPACE"," ",428],"(",["T_ISSET","isset",428],"(",["T_VARIABLE","$itemsInfo",428],"[",["T_VARIABLE","$_item",428],["T_OBJECT_OPERATOR","->",428],["T_STRING","getId",428],"(",")","]","[",["T_CONSTANT_ENCAPSED_STRING","'qty'",428],"]",")",")",["T_WHITESPACE"," ",428],"{",["T_WHITESPACE","\n                    ",428],["T_VARIABLE","$qty",429],["T_WHITESPACE"," ",429],"=",["T_WHITESPACE"," ",429],["T_INT_CAST","(int)",429],["T_VARIABLE","$itemsInfo",429],"[",["T_VARIABLE","$_item",429],["T_OBJECT_OPERATOR","->",429],["T_STRING","getId",429],"(",")","]","[",["T_CONSTANT_ENCAPSED_STRING","'qty'",429],"]",";",["T_WHITESPACE","\n                    ",429],["T_IF","if",430],["T_WHITESPACE"," ",430],"(",["T_VARIABLE","$qty",430],")",["T_WHITESPACE"," ",430],"{",["T_WHITESPACE","\n                        ",430],["T_VARIABLE","$_item",431],["T_OBJECT_OPERATOR","->",431],["T_STRING","setQty",431],"(",["T_VARIABLE","$qty",431],")",";",["T_WHITESPACE","\n                        ",431],["T_VARIABLE","$quote",432],["T_OBJECT_OPERATOR","->",432],["T_STRING","getBillingAddress",432],"(",")",["T_OBJECT_OPERATOR","->",432],["T_STRING","addItem",432],"(",["T_VARIABLE","$_item",432],")",";",["T_WHITESPACE","\n                    ",432],"}",["T_WHITESPACE"," ",433],["T_ELSE","else",433],["T_WHITESPACE"," ",433],"{",["T_WHITESPACE","\n                        ",433],["T_VARIABLE","$_item",434],["T_OBJECT_OPERATOR","->",434],["T_STRING","setQty",434],"(",["T_LNUMBER","0",434],")",";",["T_WHITESPACE","\n                        ",434],["T_VARIABLE","$quote",435],["T_OBJECT_OPERATOR","->",435],["T_STRING","removeItem",435],"(",["T_VARIABLE","$_item",435],["T_OBJECT_OPERATOR","->",435],["T_STRING","getId",435],"(",")",")",";",["T_WHITESPACE","\n                    ",435],"}",["T_WHITESPACE","\n                ",436],"}",["T_WHITESPACE","\n            ",437],"}",["T_WHITESPACE","\n\n            ",438],["T_VARIABLE","$this",440],["T_OBJECT_OPERATOR","->",440],["T_STRING","save",440],"(",")",";",["T_WHITESPACE","\n            ",440],["T_VARIABLE","$this",441],["T_OBJECT_OPERATOR","->",441],["T_STRING","_eventManager",441],["T_OBJECT_OPERATOR","->",441],["T_STRING","dispatch",441],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout_type_multishipping_set_shipping_items'",441],",",["T_WHITESPACE"," ",441],"[",["T_CONSTANT_ENCAPSED_STRING","'quote'",441],["T_WHITESPACE"," ",441],["T_DOUBLE_ARROW","=>",441],["T_WHITESPACE"," ",441],["T_VARIABLE","$quote",441],"]",")",";",["T_WHITESPACE","\n        ",441],"}",["T_WHITESPACE","\n        ",442],["T_RETURN","return",443],["T_WHITESPACE"," ",443],["T_VARIABLE","$this",443],";",["T_WHITESPACE","\n    ",443],"}",["T_WHITESPACE","\n\n    ",444],["T_DOC_COMMENT","\/**\n     * Add quote item to specific shipping address based on customer address id\n     *\n     * @param int $quoteItemId\n     * @param array $data array('qty'=>$qty, 'address'=>$customerAddressId)\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     * @return \\Magento\\Multishipping\\Model\\Checkout\\Type\\Multishipping\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     * @SuppressWarnings(PHPMD.NPathComplexity)\n     *\/",446],["T_WHITESPACE","\n    ",455],["T_PROTECTED","protected",456],["T_WHITESPACE"," ",456],["T_FUNCTION","function",456],["T_WHITESPACE"," ",456],["T_STRING","_addShippingItem",456],"(",["T_VARIABLE","$quoteItemId",456],",",["T_WHITESPACE"," ",456],["T_VARIABLE","$data",456],")",["T_WHITESPACE","\n    ",456],"{",["T_WHITESPACE","\n        ",457],["T_VARIABLE","$qty",458],["T_WHITESPACE"," ",458],"=",["T_WHITESPACE"," ",458],["T_ISSET","isset",458],"(",["T_VARIABLE","$data",458],"[",["T_CONSTANT_ENCAPSED_STRING","'qty'",458],"]",")",["T_WHITESPACE"," ",458],"?",["T_WHITESPACE"," ",458],["T_INT_CAST","(int)",458],["T_VARIABLE","$data",458],"[",["T_CONSTANT_ENCAPSED_STRING","'qty'",458],"]",["T_WHITESPACE"," ",458],":",["T_WHITESPACE"," ",458],["T_LNUMBER","1",458],";",["T_WHITESPACE","\n        ",458],["T_COMMENT","\/\/$qty       = $qty > 0 ? $qty : 1;\n",459],["T_WHITESPACE","        ",460],["T_VARIABLE","$addressId",460],["T_WHITESPACE"," ",460],"=",["T_WHITESPACE"," ",460],["T_ISSET","isset",460],"(",["T_VARIABLE","$data",460],"[",["T_CONSTANT_ENCAPSED_STRING","'address'",460],"]",")",["T_WHITESPACE"," ",460],"?",["T_WHITESPACE"," ",460],["T_VARIABLE","$data",460],"[",["T_CONSTANT_ENCAPSED_STRING","'address'",460],"]",["T_WHITESPACE"," ",460],":",["T_WHITESPACE"," ",460],["T_STRING","false",460],";",["T_WHITESPACE","\n        ",460],["T_VARIABLE","$quoteItem",461],["T_WHITESPACE"," ",461],"=",["T_WHITESPACE"," ",461],["T_VARIABLE","$this",461],["T_OBJECT_OPERATOR","->",461],["T_STRING","getQuote",461],"(",")",["T_OBJECT_OPERATOR","->",461],["T_STRING","getItemById",461],"(",["T_VARIABLE","$quoteItemId",461],")",";",["T_WHITESPACE","\n\n        ",461],["T_IF","if",463],["T_WHITESPACE"," ",463],"(",["T_VARIABLE","$addressId",463],["T_WHITESPACE"," ",463],["T_BOOLEAN_AND","&&",463],["T_WHITESPACE"," ",463],["T_VARIABLE","$quoteItem",463],")",["T_WHITESPACE"," ",463],"{",["T_WHITESPACE","\n            ",463],["T_IF","if",464],["T_WHITESPACE"," ",464],"(","!",["T_VARIABLE","$this",464],["T_OBJECT_OPERATOR","->",464],["T_STRING","isAddressIdApplicable",464],"(",["T_VARIABLE","$addressId",464],")",")",["T_WHITESPACE"," ",464],"{",["T_WHITESPACE","\n                ",464],["T_THROW","throw",465],["T_WHITESPACE"," ",465],["T_NEW","new",465],["T_WHITESPACE"," ",465],["T_STRING","LocalizedException",465],"(",["T_STRING","__",465],"(",["T_CONSTANT_ENCAPSED_STRING","'Please check shipping address information.'",465],")",")",";",["T_WHITESPACE","\n            ",465],"}",["T_WHITESPACE","\n\n            ",466],["T_DOC_COMMENT","\/**\n             * Skip item processing if qty 0\n             *\/",468],["T_WHITESPACE","\n            ",470],["T_IF","if",471],["T_WHITESPACE"," ",471],"(",["T_VARIABLE","$qty",471],["T_WHITESPACE"," ",471],["T_IS_IDENTICAL","===",471],["T_WHITESPACE"," ",471],["T_LNUMBER","0",471],")",["T_WHITESPACE"," ",471],"{",["T_WHITESPACE","\n                ",471],["T_RETURN","return",472],["T_WHITESPACE"," ",472],["T_VARIABLE","$this",472],";",["T_WHITESPACE","\n            ",472],"}",["T_WHITESPACE","\n            ",473],["T_VARIABLE","$quoteItem",474],["T_OBJECT_OPERATOR","->",474],["T_STRING","setMultishippingQty",474],"(",["T_INT_CAST","(int)",474],["T_VARIABLE","$quoteItem",474],["T_OBJECT_OPERATOR","->",474],["T_STRING","getMultishippingQty",474],"(",")",["T_WHITESPACE"," ",474],"+",["T_WHITESPACE"," ",474],["T_VARIABLE","$qty",474],")",";",["T_WHITESPACE","\n            ",474],["T_VARIABLE","$quoteItem",475],["T_OBJECT_OPERATOR","->",475],["T_STRING","setQty",475],"(",["T_VARIABLE","$quoteItem",475],["T_OBJECT_OPERATOR","->",475],["T_STRING","getMultishippingQty",475],"(",")",")",";",["T_WHITESPACE","\n            ",475],["T_TRY","try",476],["T_WHITESPACE"," ",476],"{",["T_WHITESPACE","\n                ",476],["T_VARIABLE","$address",477],["T_WHITESPACE"," ",477],"=",["T_WHITESPACE"," ",477],["T_VARIABLE","$this",477],["T_OBJECT_OPERATOR","->",477],["T_STRING","addressRepository",477],["T_OBJECT_OPERATOR","->",477],["T_STRING","getById",477],"(",["T_VARIABLE","$addressId",477],")",";",["T_WHITESPACE","\n            ",477],"}",["T_WHITESPACE"," ",478],["T_CATCH","catch",478],["T_WHITESPACE"," ",478],"(",["T_NS_SEPARATOR","\\",478],["T_STRING","Exception",478],["T_WHITESPACE"," ",478],["T_VARIABLE","$e",478],")",["T_WHITESPACE"," ",478],"{",["T_WHITESPACE","\n            ",478],"}",["T_WHITESPACE","\n            ",479],["T_IF","if",480],["T_WHITESPACE"," ",480],"(",["T_ISSET","isset",480],"(",["T_VARIABLE","$address",480],")",")",["T_WHITESPACE"," ",480],"{",["T_WHITESPACE","\n                ",480],["T_IF","if",481],["T_WHITESPACE"," ",481],"(","!","(",["T_VARIABLE","$quoteAddress",481],["T_WHITESPACE"," ",481],"=",["T_WHITESPACE"," ",481],["T_VARIABLE","$this",481],["T_OBJECT_OPERATOR","->",481],["T_STRING","getQuote",481],"(",")",["T_OBJECT_OPERATOR","->",481],["T_STRING","getShippingAddressByCustomerAddressId",481],"(",["T_VARIABLE","$address",481],["T_OBJECT_OPERATOR","->",481],["T_STRING","getId",481],"(",")",")",")",")",["T_WHITESPACE"," ",481],"{",["T_WHITESPACE","\n                    ",481],["T_VARIABLE","$quoteAddress",482],["T_WHITESPACE"," ",482],"=",["T_WHITESPACE"," ",482],["T_VARIABLE","$this",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","_addressFactory",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","create",482],"(",")",["T_OBJECT_OPERATOR","->",482],["T_STRING","importCustomerAddressData",482],"(",["T_VARIABLE","$address",482],")",";",["T_WHITESPACE","\n                    ",482],["T_VARIABLE","$this",483],["T_OBJECT_OPERATOR","->",483],["T_STRING","getQuote",483],"(",")",["T_OBJECT_OPERATOR","->",483],["T_STRING","addShippingAddress",483],"(",["T_VARIABLE","$quoteAddress",483],")",";",["T_WHITESPACE","\n                ",483],"}",["T_WHITESPACE","\n\n                ",484],["T_VARIABLE","$quoteAddress",486],["T_WHITESPACE"," ",486],"=",["T_WHITESPACE"," ",486],["T_VARIABLE","$this",486],["T_OBJECT_OPERATOR","->",486],["T_STRING","getQuote",486],"(",")",["T_OBJECT_OPERATOR","->",486],["T_STRING","getShippingAddressByCustomerAddressId",486],"(",["T_VARIABLE","$address",486],["T_OBJECT_OPERATOR","->",486],["T_STRING","getId",486],"(",")",")",";",["T_WHITESPACE","\n                ",486],["T_VARIABLE","$quoteAddress",487],["T_OBJECT_OPERATOR","->",487],["T_STRING","setCustomerAddressId",487],"(",["T_VARIABLE","$addressId",487],")",";",["T_WHITESPACE","\n                ",487],["T_VARIABLE","$quoteAddressItem",488],["T_WHITESPACE"," ",488],"=",["T_WHITESPACE"," ",488],["T_VARIABLE","$quoteAddress",488],["T_OBJECT_OPERATOR","->",488],["T_STRING","getItemByQuoteItemId",488],"(",["T_VARIABLE","$quoteItemId",488],")",";",["T_WHITESPACE","\n                ",488],["T_IF","if",489],["T_WHITESPACE"," ",489],"(",["T_VARIABLE","$quoteAddressItem",489],")",["T_WHITESPACE"," ",489],"{",["T_WHITESPACE","\n                    ",489],["T_VARIABLE","$quoteAddressItem",490],["T_OBJECT_OPERATOR","->",490],["T_STRING","setQty",490],"(",["T_INT_CAST","(int)",490],"(",["T_VARIABLE","$quoteAddressItem",490],["T_OBJECT_OPERATOR","->",490],["T_STRING","getQty",490],"(",")",["T_WHITESPACE"," ",490],"+",["T_WHITESPACE"," ",490],["T_VARIABLE","$qty",490],")",")",";",["T_WHITESPACE","\n                ",490],"}",["T_WHITESPACE"," ",491],["T_ELSE","else",491],["T_WHITESPACE"," ",491],"{",["T_WHITESPACE","\n                    ",491],["T_VARIABLE","$quoteAddress",492],["T_OBJECT_OPERATOR","->",492],["T_STRING","addItem",492],"(",["T_VARIABLE","$quoteItem",492],",",["T_WHITESPACE"," ",492],["T_VARIABLE","$qty",492],")",";",["T_WHITESPACE","\n                ",492],"}",["T_WHITESPACE","\n                ",493],["T_DOC_COMMENT","\/**\n                 * Require shipping rate recollect\n                 *\/",494],["T_WHITESPACE","\n                ",496],["T_VARIABLE","$quoteAddress",497],["T_OBJECT_OPERATOR","->",497],["T_STRING","setCollectShippingRates",497],"(",["T_BOOL_CAST","(bool)",497],["T_VARIABLE","$this",497],["T_OBJECT_OPERATOR","->",497],["T_STRING","getCollectRatesFlag",497],"(",")",")",";",["T_WHITESPACE","\n            ",497],"}",["T_WHITESPACE","\n        ",498],"}",["T_WHITESPACE","\n        ",499],["T_RETURN","return",500],["T_WHITESPACE"," ",500],["T_VARIABLE","$this",500],";",["T_WHITESPACE","\n    ",500],"}",["T_WHITESPACE","\n\n    ",501],["T_DOC_COMMENT","\/**\n     * Reimport customer address info to quote shipping address\n     *\n     * @param int $addressId customer address id\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     * @return \\Magento\\Multishipping\\Model\\Checkout\\Type\\Multishipping\n     *\/",503],["T_WHITESPACE","\n    ",509],["T_PUBLIC","public",510],["T_WHITESPACE"," ",510],["T_FUNCTION","function",510],["T_WHITESPACE"," ",510],["T_STRING","updateQuoteCustomerShippingAddress",510],"(",["T_VARIABLE","$addressId",510],")",["T_WHITESPACE","\n    ",510],"{",["T_WHITESPACE","\n        ",511],["T_IF","if",512],["T_WHITESPACE"," ",512],"(","!",["T_VARIABLE","$this",512],["T_OBJECT_OPERATOR","->",512],["T_STRING","isAddressIdApplicable",512],"(",["T_VARIABLE","$addressId",512],")",")",["T_WHITESPACE"," ",512],"{",["T_WHITESPACE","\n            ",512],["T_THROW","throw",513],["T_WHITESPACE"," ",513],["T_NEW","new",513],["T_WHITESPACE"," ",513],["T_STRING","LocalizedException",513],"(",["T_STRING","__",513],"(",["T_CONSTANT_ENCAPSED_STRING","'Please check shipping address information.'",513],")",")",";",["T_WHITESPACE","\n        ",513],"}",["T_WHITESPACE","\n        ",514],["T_TRY","try",515],["T_WHITESPACE"," ",515],"{",["T_WHITESPACE","\n            ",515],["T_VARIABLE","$address",516],["T_WHITESPACE"," ",516],"=",["T_WHITESPACE"," ",516],["T_VARIABLE","$this",516],["T_OBJECT_OPERATOR","->",516],["T_STRING","addressRepository",516],["T_OBJECT_OPERATOR","->",516],["T_STRING","getById",516],"(",["T_VARIABLE","$addressId",516],")",";",["T_WHITESPACE","\n        ",516],"}",["T_WHITESPACE"," ",517],["T_CATCH","catch",517],["T_WHITESPACE"," ",517],"(",["T_NS_SEPARATOR","\\",517],["T_STRING","Exception",517],["T_WHITESPACE"," ",517],["T_VARIABLE","$e",517],")",["T_WHITESPACE"," ",517],"{",["T_WHITESPACE","\n            ",517],["T_COMMENT","\/\/\n",518],["T_WHITESPACE","        ",519],"}",["T_WHITESPACE","\n        ",519],["T_IF","if",520],["T_WHITESPACE"," ",520],"(",["T_ISSET","isset",520],"(",["T_VARIABLE","$address",520],")",")",["T_WHITESPACE"," ",520],"{",["T_WHITESPACE","\n            ",520],["T_VARIABLE","$quoteAddress",521],["T_WHITESPACE"," ",521],"=",["T_WHITESPACE"," ",521],["T_VARIABLE","$this",521],["T_OBJECT_OPERATOR","->",521],["T_STRING","getQuote",521],"(",")",["T_OBJECT_OPERATOR","->",521],["T_STRING","getShippingAddressByCustomerAddressId",521],"(",["T_VARIABLE","$addressId",521],")",";",["T_WHITESPACE","\n            ",521],["T_VARIABLE","$quoteAddress",522],["T_OBJECT_OPERATOR","->",522],["T_STRING","setCollectShippingRates",522],"(",["T_STRING","true",522],")",["T_OBJECT_OPERATOR","->",522],["T_STRING","importCustomerAddressData",522],"(",["T_VARIABLE","$address",522],")",";",["T_WHITESPACE","\n            ",522],["T_VARIABLE","$this",523],["T_OBJECT_OPERATOR","->",523],["T_STRING","totalsCollector",523],["T_OBJECT_OPERATOR","->",523],["T_STRING","collectAddressTotals",523],"(",["T_VARIABLE","$this",523],["T_OBJECT_OPERATOR","->",523],["T_STRING","getQuote",523],"(",")",",",["T_WHITESPACE"," ",523],["T_VARIABLE","$quoteAddress",523],")",";",["T_WHITESPACE","\n            ",523],["T_VARIABLE","$this",524],["T_OBJECT_OPERATOR","->",524],["T_STRING","quoteRepository",524],["T_OBJECT_OPERATOR","->",524],["T_STRING","save",524],"(",["T_VARIABLE","$this",524],["T_OBJECT_OPERATOR","->",524],["T_STRING","getQuote",524],"(",")",")",";",["T_WHITESPACE","\n        ",524],"}",["T_WHITESPACE","\n\n        ",525],["T_RETURN","return",527],["T_WHITESPACE"," ",527],["T_VARIABLE","$this",527],";",["T_WHITESPACE","\n    ",527],"}",["T_WHITESPACE","\n\n    ",528],["T_DOC_COMMENT","\/**\n     * Reimport customer billing address to quote\n     *\n     * @param int $addressId customer address id\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     * @return \\Magento\\Multishipping\\Model\\Checkout\\Type\\Multishipping\n     *\/",530],["T_WHITESPACE","\n    ",536],["T_PUBLIC","public",537],["T_WHITESPACE"," ",537],["T_FUNCTION","function",537],["T_WHITESPACE"," ",537],["T_STRING","setQuoteCustomerBillingAddress",537],"(",["T_VARIABLE","$addressId",537],")",["T_WHITESPACE","\n    ",537],"{",["T_WHITESPACE","\n        ",538],["T_IF","if",539],["T_WHITESPACE"," ",539],"(","!",["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","isAddressIdApplicable",539],"(",["T_VARIABLE","$addressId",539],")",")",["T_WHITESPACE"," ",539],"{",["T_WHITESPACE","\n            ",539],["T_THROW","throw",540],["T_WHITESPACE"," ",540],["T_NEW","new",540],["T_WHITESPACE"," ",540],["T_STRING","LocalizedException",540],"(",["T_STRING","__",540],"(",["T_CONSTANT_ENCAPSED_STRING","'Please check billing address information.'",540],")",")",";",["T_WHITESPACE","\n        ",540],"}",["T_WHITESPACE","\n        ",541],["T_TRY","try",542],["T_WHITESPACE"," ",542],"{",["T_WHITESPACE","\n            ",542],["T_VARIABLE","$address",543],["T_WHITESPACE"," ",543],"=",["T_WHITESPACE"," ",543],["T_VARIABLE","$this",543],["T_OBJECT_OPERATOR","->",543],["T_STRING","addressRepository",543],["T_OBJECT_OPERATOR","->",543],["T_STRING","getById",543],"(",["T_VARIABLE","$addressId",543],")",";",["T_WHITESPACE","\n        ",543],"}",["T_WHITESPACE"," ",544],["T_CATCH","catch",544],["T_WHITESPACE"," ",544],"(",["T_NS_SEPARATOR","\\",544],["T_STRING","Exception",544],["T_WHITESPACE"," ",544],["T_VARIABLE","$e",544],")",["T_WHITESPACE"," ",544],"{",["T_WHITESPACE","\n            ",544],["T_COMMENT","\/\/\n",545],["T_WHITESPACE","        ",546],"}",["T_WHITESPACE","\n        ",546],["T_IF","if",547],["T_WHITESPACE"," ",547],"(",["T_ISSET","isset",547],"(",["T_VARIABLE","$address",547],")",")",["T_WHITESPACE"," ",547],"{",["T_WHITESPACE","\n            ",547],["T_VARIABLE","$quoteAddress",548],["T_WHITESPACE"," ",548],"=",["T_WHITESPACE"," ",548],["T_VARIABLE","$this",548],["T_OBJECT_OPERATOR","->",548],["T_STRING","getQuote",548],"(",")",["T_OBJECT_OPERATOR","->",548],["T_STRING","getBillingAddress",548],"(",["T_VARIABLE","$addressId",548],")",["T_OBJECT_OPERATOR","->",548],["T_STRING","importCustomerAddressData",548],"(",["T_VARIABLE","$address",548],")",";",["T_WHITESPACE","\n            ",548],["T_VARIABLE","$this",549],["T_OBJECT_OPERATOR","->",549],["T_STRING","totalsCollector",549],["T_OBJECT_OPERATOR","->",549],["T_STRING","collectAddressTotals",549],"(",["T_VARIABLE","$this",549],["T_OBJECT_OPERATOR","->",549],["T_STRING","getQuote",549],"(",")",",",["T_WHITESPACE"," ",549],["T_VARIABLE","$quoteAddress",549],")",";",["T_WHITESPACE","\n            ",549],["T_VARIABLE","$this",550],["T_OBJECT_OPERATOR","->",550],["T_STRING","getQuote",550],"(",")",["T_OBJECT_OPERATOR","->",550],["T_STRING","collectTotals",550],"(",")",";",["T_WHITESPACE","\n            ",550],["T_VARIABLE","$this",551],["T_OBJECT_OPERATOR","->",551],["T_STRING","quoteRepository",551],["T_OBJECT_OPERATOR","->",551],["T_STRING","save",551],"(",["T_VARIABLE","$this",551],["T_OBJECT_OPERATOR","->",551],["T_STRING","getQuote",551],"(",")",")",";",["T_WHITESPACE","\n        ",551],"}",["T_WHITESPACE","\n\n        ",552],["T_RETURN","return",554],["T_WHITESPACE"," ",554],["T_VARIABLE","$this",554],";",["T_WHITESPACE","\n    ",554],"}",["T_WHITESPACE","\n\n    ",555],["T_DOC_COMMENT","\/**\n     * Assign shipping methods to addresses\n     *\n     * @param  array $methods\n     * @return \\Magento\\Multishipping\\Model\\Checkout\\Type\\Multishipping\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     *\/",557],["T_WHITESPACE","\n    ",563],["T_PUBLIC","public",564],["T_WHITESPACE"," ",564],["T_FUNCTION","function",564],["T_WHITESPACE"," ",564],["T_STRING","setShippingMethods",564],"(",["T_VARIABLE","$methods",564],")",["T_WHITESPACE","\n    ",564],"{",["T_WHITESPACE","\n        ",565],["T_VARIABLE","$quote",566],["T_WHITESPACE"," ",566],"=",["T_WHITESPACE"," ",566],["T_VARIABLE","$this",566],["T_OBJECT_OPERATOR","->",566],["T_STRING","getQuote",566],"(",")",";",["T_WHITESPACE","\n        ",566],["T_VARIABLE","$addresses",567],["T_WHITESPACE"," ",567],"=",["T_WHITESPACE"," ",567],["T_VARIABLE","$quote",567],["T_OBJECT_OPERATOR","->",567],["T_STRING","getAllShippingAddresses",567],"(",")",";",["T_WHITESPACE","\n        ",567],["T_DOC_COMMENT","\/** @var  \\Magento\\Quote\\Model\\Quote\\Address $address *\/",568],["T_WHITESPACE","\n        ",568],["T_FOREACH","foreach",569],["T_WHITESPACE"," ",569],"(",["T_VARIABLE","$addresses",569],["T_WHITESPACE"," ",569],["T_AS","as",569],["T_WHITESPACE"," ",569],["T_VARIABLE","$address",569],")",["T_WHITESPACE"," ",569],"{",["T_WHITESPACE","\n            ",569],["T_VARIABLE","$addressId",570],["T_WHITESPACE"," ",570],"=",["T_WHITESPACE"," ",570],["T_VARIABLE","$address",570],["T_OBJECT_OPERATOR","->",570],["T_STRING","getId",570],"(",")",";",["T_WHITESPACE","\n            ",570],["T_IF","if",571],["T_WHITESPACE"," ",571],"(",["T_ISSET","isset",571],"(",["T_VARIABLE","$methods",571],"[",["T_VARIABLE","$addressId",571],"]",")",")",["T_WHITESPACE"," ",571],"{",["T_WHITESPACE","\n                ",571],["T_VARIABLE","$address",572],["T_OBJECT_OPERATOR","->",572],["T_STRING","setShippingMethod",572],"(",["T_VARIABLE","$methods",572],"[",["T_VARIABLE","$addressId",572],"]",")",";",["T_WHITESPACE","\n            ",572],"}",["T_WHITESPACE"," ",573],["T_ELSEIF","elseif",573],["T_WHITESPACE"," ",573],"(","!",["T_VARIABLE","$address",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","getShippingMethod",573],"(",")",")",["T_WHITESPACE"," ",573],"{",["T_WHITESPACE","\n                ",573],["T_THROW","throw",574],["T_WHITESPACE"," ",574],["T_NEW","new",574],["T_WHITESPACE"," ",574],["T_NS_SEPARATOR","\\",574],["T_STRING","Magento",574],["T_NS_SEPARATOR","\\",574],["T_STRING","Framework",574],["T_NS_SEPARATOR","\\",574],["T_STRING","Exception",574],["T_NS_SEPARATOR","\\",574],["T_STRING","LocalizedException",574],"(",["T_WHITESPACE","\n                    ",574],["T_STRING","__",575],"(",["T_CONSTANT_ENCAPSED_STRING","'Please select shipping methods for all addresses.'",575],")",["T_WHITESPACE","\n                ",575],")",";",["T_WHITESPACE","\n            ",576],"}",["T_WHITESPACE","\n        ",577],"}",["T_WHITESPACE","\n        ",578],["T_VARIABLE","$this",579],["T_OBJECT_OPERATOR","->",579],["T_STRING","prepareShippingAssignment",579],"(",["T_VARIABLE","$quote",579],")",";",["T_WHITESPACE","\n        ",579],["T_VARIABLE","$this",580],["T_OBJECT_OPERATOR","->",580],["T_STRING","save",580],"(",")",";",["T_WHITESPACE","\n        ",580],["T_RETURN","return",581],["T_WHITESPACE"," ",581],["T_VARIABLE","$this",581],";",["T_WHITESPACE","\n    ",581],"}",["T_WHITESPACE","\n\n    ",582],["T_DOC_COMMENT","\/**\n     * Set payment method info to quote payment\n     *\n     * @param array $payment\n     * @return \\Magento\\Multishipping\\Model\\Checkout\\Type\\Multishipping\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     *\/",584],["T_WHITESPACE","\n    ",590],["T_PUBLIC","public",591],["T_WHITESPACE"," ",591],["T_FUNCTION","function",591],["T_WHITESPACE"," ",591],["T_STRING","setPaymentMethod",591],"(",["T_VARIABLE","$payment",591],")",["T_WHITESPACE","\n    ",591],"{",["T_WHITESPACE","\n        ",592],["T_IF","if",593],["T_WHITESPACE"," ",593],"(","!",["T_ISSET","isset",593],"(",["T_VARIABLE","$payment",593],"[",["T_CONSTANT_ENCAPSED_STRING","'method'",593],"]",")",")",["T_WHITESPACE"," ",593],"{",["T_WHITESPACE","\n            ",593],["T_THROW","throw",594],["T_WHITESPACE"," ",594],["T_NEW","new",594],["T_WHITESPACE"," ",594],["T_NS_SEPARATOR","\\",594],["T_STRING","Magento",594],["T_NS_SEPARATOR","\\",594],["T_STRING","Framework",594],["T_NS_SEPARATOR","\\",594],["T_STRING","Exception",594],["T_NS_SEPARATOR","\\",594],["T_STRING","LocalizedException",594],"(",["T_WHITESPACE","\n                ",594],["T_STRING","__",595],"(",["T_CONSTANT_ENCAPSED_STRING","'A payment method is not defined.'",595],")",["T_WHITESPACE","\n            ",595],")",";",["T_WHITESPACE","\n        ",596],"}",["T_WHITESPACE","\n        ",597],["T_IF","if",598],["T_WHITESPACE"," ",598],"(","!",["T_VARIABLE","$this",598],["T_OBJECT_OPERATOR","->",598],["T_STRING","paymentSpecification",598],["T_OBJECT_OPERATOR","->",598],["T_STRING","isSatisfiedBy",598],"(",["T_VARIABLE","$payment",598],"[",["T_CONSTANT_ENCAPSED_STRING","'method'",598],"]",")",")",["T_WHITESPACE"," ",598],"{",["T_WHITESPACE","\n            ",598],["T_THROW","throw",599],["T_WHITESPACE"," ",599],["T_NEW","new",599],["T_WHITESPACE"," ",599],["T_NS_SEPARATOR","\\",599],["T_STRING","Magento",599],["T_NS_SEPARATOR","\\",599],["T_STRING","Framework",599],["T_NS_SEPARATOR","\\",599],["T_STRING","Exception",599],["T_NS_SEPARATOR","\\",599],["T_STRING","LocalizedException",599],"(",["T_WHITESPACE","\n                ",599],["T_STRING","__",600],"(",["T_CONSTANT_ENCAPSED_STRING","'The requested payment method is not available for multishipping.'",600],")",["T_WHITESPACE","\n            ",600],")",";",["T_WHITESPACE","\n        ",601],"}",["T_WHITESPACE","\n        ",602],["T_VARIABLE","$quote",603],["T_WHITESPACE"," ",603],"=",["T_WHITESPACE"," ",603],["T_VARIABLE","$this",603],["T_OBJECT_OPERATOR","->",603],["T_STRING","getQuote",603],"(",")",";",["T_WHITESPACE","\n        ",603],["T_VARIABLE","$quote",604],["T_OBJECT_OPERATOR","->",604],["T_STRING","getPayment",604],"(",")",["T_OBJECT_OPERATOR","->",604],["T_STRING","importData",604],"(",["T_VARIABLE","$payment",604],")",";",["T_WHITESPACE","\n        ",604],["T_COMMENT","\/\/ shipping totals may be affected by payment method\n",605],["T_WHITESPACE","        ",606],["T_IF","if",606],["T_WHITESPACE"," ",606],"(","!",["T_VARIABLE","$quote",606],["T_OBJECT_OPERATOR","->",606],["T_STRING","isVirtual",606],"(",")",["T_WHITESPACE"," ",606],["T_BOOLEAN_AND","&&",606],["T_WHITESPACE"," ",606],["T_VARIABLE","$quote",606],["T_OBJECT_OPERATOR","->",606],["T_STRING","getShippingAddress",606],"(",")",")",["T_WHITESPACE"," ",606],"{",["T_WHITESPACE","\n            ",606],["T_VARIABLE","$quote",607],["T_OBJECT_OPERATOR","->",607],["T_STRING","getShippingAddress",607],"(",")",["T_OBJECT_OPERATOR","->",607],["T_STRING","setCollectShippingRates",607],"(",["T_STRING","true",607],")",";",["T_WHITESPACE","\n            ",607],["T_VARIABLE","$quote",608],["T_OBJECT_OPERATOR","->",608],["T_STRING","setTotalsCollectedFlag",608],"(",["T_STRING","false",608],")",["T_OBJECT_OPERATOR","->",608],["T_STRING","collectTotals",608],"(",")",";",["T_WHITESPACE","\n        ",608],"}",["T_WHITESPACE","\n        ",609],["T_VARIABLE","$this",610],["T_OBJECT_OPERATOR","->",610],["T_STRING","quoteRepository",610],["T_OBJECT_OPERATOR","->",610],["T_STRING","save",610],"(",["T_VARIABLE","$quote",610],")",";",["T_WHITESPACE","\n        ",610],["T_RETURN","return",611],["T_WHITESPACE"," ",611],["T_VARIABLE","$this",611],";",["T_WHITESPACE","\n    ",611],"}",["T_WHITESPACE","\n\n    ",612],["T_DOC_COMMENT","\/**\n     * Prepare order based on quote address\n     *\n     * @param   \\Magento\\Quote\\Model\\Quote\\Address $address\n     * @return  \\Magento\\Sales\\Model\\Order\n     * @throws  \\Magento\\Checkout\\Exception\n     *\/",614],["T_WHITESPACE","\n    ",620],["T_PROTECTED","protected",621],["T_WHITESPACE"," ",621],["T_FUNCTION","function",621],["T_WHITESPACE"," ",621],["T_STRING","_prepareOrder",621],"(",["T_NS_SEPARATOR","\\",621],["T_STRING","Magento",621],["T_NS_SEPARATOR","\\",621],["T_STRING","Quote",621],["T_NS_SEPARATOR","\\",621],["T_STRING","Model",621],["T_NS_SEPARATOR","\\",621],["T_STRING","Quote",621],["T_NS_SEPARATOR","\\",621],["T_STRING","Address",621],["T_WHITESPACE"," ",621],["T_VARIABLE","$address",621],")",["T_WHITESPACE","\n    ",621],"{",["T_WHITESPACE","\n        ",622],["T_VARIABLE","$quote",623],["T_WHITESPACE"," ",623],"=",["T_WHITESPACE"," ",623],["T_VARIABLE","$this",623],["T_OBJECT_OPERATOR","->",623],["T_STRING","getQuote",623],"(",")",";",["T_WHITESPACE","\n        ",623],["T_VARIABLE","$quote",624],["T_OBJECT_OPERATOR","->",624],["T_STRING","unsReservedOrderId",624],"(",")",";",["T_WHITESPACE","\n        ",624],["T_VARIABLE","$quote",625],["T_OBJECT_OPERATOR","->",625],["T_STRING","reserveOrderId",625],"(",")",";",["T_WHITESPACE","\n        ",625],["T_VARIABLE","$quote",626],["T_OBJECT_OPERATOR","->",626],["T_STRING","collectTotals",626],"(",")",";",["T_WHITESPACE","\n\n        ",626],["T_VARIABLE","$order",628],["T_WHITESPACE"," ",628],"=",["T_WHITESPACE"," ",628],["T_VARIABLE","$this",628],["T_OBJECT_OPERATOR","->",628],["T_STRING","quoteAddressToOrder",628],["T_OBJECT_OPERATOR","->",628],["T_STRING","convert",628],"(",["T_VARIABLE","$address",628],")",";",["T_WHITESPACE","\n        ",628],["T_VARIABLE","$order",629],["T_OBJECT_OPERATOR","->",629],["T_STRING","setQuote",629],"(",["T_VARIABLE","$quote",629],")",";",["T_WHITESPACE","\n        ",629],["T_VARIABLE","$order",630],["T_OBJECT_OPERATOR","->",630],["T_STRING","setBillingAddress",630],"(",["T_VARIABLE","$this",630],["T_OBJECT_OPERATOR","->",630],["T_STRING","quoteAddressToOrderAddress",630],["T_OBJECT_OPERATOR","->",630],["T_STRING","convert",630],"(",["T_VARIABLE","$quote",630],["T_OBJECT_OPERATOR","->",630],["T_STRING","getBillingAddress",630],"(",")",")",")",";",["T_WHITESPACE","\n\n        ",630],["T_IF","if",632],["T_WHITESPACE"," ",632],"(",["T_VARIABLE","$address",632],["T_OBJECT_OPERATOR","->",632],["T_STRING","getAddressType",632],"(",")",["T_WHITESPACE"," ",632],["T_IS_EQUAL","==",632],["T_WHITESPACE"," ",632],["T_CONSTANT_ENCAPSED_STRING","'billing'",632],")",["T_WHITESPACE"," ",632],"{",["T_WHITESPACE","\n            ",632],["T_VARIABLE","$order",633],["T_OBJECT_OPERATOR","->",633],["T_STRING","setIsVirtual",633],"(",["T_LNUMBER","1",633],")",";",["T_WHITESPACE","\n        ",633],"}",["T_WHITESPACE"," ",634],["T_ELSE","else",634],["T_WHITESPACE"," ",634],"{",["T_WHITESPACE","\n            ",634],["T_VARIABLE","$order",635],["T_OBJECT_OPERATOR","->",635],["T_STRING","setShippingAddress",635],"(",["T_VARIABLE","$this",635],["T_OBJECT_OPERATOR","->",635],["T_STRING","quoteAddressToOrderAddress",635],["T_OBJECT_OPERATOR","->",635],["T_STRING","convert",635],"(",["T_VARIABLE","$address",635],")",")",";",["T_WHITESPACE","\n        ",635],"}",["T_WHITESPACE","\n\n        ",636],["T_VARIABLE","$order",638],["T_OBJECT_OPERATOR","->",638],["T_STRING","setPayment",638],"(",["T_VARIABLE","$this",638],["T_OBJECT_OPERATOR","->",638],["T_STRING","quotePaymentToOrderPayment",638],["T_OBJECT_OPERATOR","->",638],["T_STRING","convert",638],"(",["T_VARIABLE","$quote",638],["T_OBJECT_OPERATOR","->",638],["T_STRING","getPayment",638],"(",")",")",")",";",["T_WHITESPACE","\n        ",638],["T_IF","if",639],["T_WHITESPACE"," ",639],"(",["T_VARIABLE","$this",639],["T_OBJECT_OPERATOR","->",639],["T_STRING","priceCurrency",639],["T_OBJECT_OPERATOR","->",639],["T_STRING","round",639],"(",["T_VARIABLE","$address",639],["T_OBJECT_OPERATOR","->",639],["T_STRING","getGrandTotal",639],"(",")",")",["T_WHITESPACE"," ",639],["T_IS_EQUAL","==",639],["T_WHITESPACE"," ",639],["T_LNUMBER","0",639],")",["T_WHITESPACE"," ",639],"{",["T_WHITESPACE","\n            ",639],["T_VARIABLE","$order",640],["T_OBJECT_OPERATOR","->",640],["T_STRING","getPayment",640],"(",")",["T_OBJECT_OPERATOR","->",640],["T_STRING","setMethod",640],"(",["T_CONSTANT_ENCAPSED_STRING","'free'",640],")",";",["T_WHITESPACE","\n        ",640],"}",["T_WHITESPACE","\n\n        ",641],["T_FOREACH","foreach",643],["T_WHITESPACE"," ",643],"(",["T_VARIABLE","$address",643],["T_OBJECT_OPERATOR","->",643],["T_STRING","getAllItems",643],"(",")",["T_WHITESPACE"," ",643],["T_AS","as",643],["T_WHITESPACE"," ",643],["T_VARIABLE","$item",643],")",["T_WHITESPACE"," ",643],"{",["T_WHITESPACE","\n            ",643],["T_VARIABLE","$_quoteItem",644],["T_WHITESPACE"," ",644],"=",["T_WHITESPACE"," ",644],["T_VARIABLE","$item",644],["T_OBJECT_OPERATOR","->",644],["T_STRING","getQuoteItem",644],"(",")",";",["T_WHITESPACE","\n            ",644],["T_IF","if",645],["T_WHITESPACE"," ",645],"(","!",["T_VARIABLE","$_quoteItem",645],")",["T_WHITESPACE"," ",645],"{",["T_WHITESPACE","\n                ",645],["T_THROW","throw",646],["T_WHITESPACE"," ",646],["T_NEW","new",646],["T_WHITESPACE"," ",646],["T_NS_SEPARATOR","\\",646],["T_STRING","Magento",646],["T_NS_SEPARATOR","\\",646],["T_STRING","Checkout",646],["T_NS_SEPARATOR","\\",646],["T_STRING","Exception",646],"(",["T_WHITESPACE","\n                    ",646],["T_STRING","__",647],"(",["T_CONSTANT_ENCAPSED_STRING","'Item not found or already ordered'",647],")",["T_WHITESPACE","\n                ",647],")",";",["T_WHITESPACE","\n            ",648],"}",["T_WHITESPACE","\n            ",649],["T_VARIABLE","$item",650],["T_OBJECT_OPERATOR","->",650],["T_STRING","setProductType",650],"(",["T_WHITESPACE","\n                ",650],["T_VARIABLE","$_quoteItem",651],["T_OBJECT_OPERATOR","->",651],["T_STRING","getProductType",651],"(",")",["T_WHITESPACE","\n            ",651],")",["T_OBJECT_OPERATOR","->",652],["T_STRING","setProductOptions",652],"(",["T_WHITESPACE","\n                ",652],["T_VARIABLE","$_quoteItem",653],["T_OBJECT_OPERATOR","->",653],["T_STRING","getProduct",653],"(",")",["T_OBJECT_OPERATOR","->",653],["T_STRING","getTypeInstance",653],"(",")",["T_OBJECT_OPERATOR","->",653],["T_STRING","getOrderOptions",653],"(",["T_VARIABLE","$_quoteItem",653],["T_OBJECT_OPERATOR","->",653],["T_STRING","getProduct",653],"(",")",")",["T_WHITESPACE","\n            ",653],")",";",["T_WHITESPACE","\n            ",654],["T_VARIABLE","$orderItem",655],["T_WHITESPACE"," ",655],"=",["T_WHITESPACE"," ",655],["T_VARIABLE","$this",655],["T_OBJECT_OPERATOR","->",655],["T_STRING","quoteItemToOrderItem",655],["T_OBJECT_OPERATOR","->",655],["T_STRING","convert",655],"(",["T_VARIABLE","$item",655],")",";",["T_WHITESPACE","\n            ",655],["T_IF","if",656],["T_WHITESPACE"," ",656],"(",["T_VARIABLE","$item",656],["T_OBJECT_OPERATOR","->",656],["T_STRING","getParentItem",656],"(",")",")",["T_WHITESPACE"," ",656],"{",["T_WHITESPACE","\n                ",656],["T_VARIABLE","$orderItem",657],["T_OBJECT_OPERATOR","->",657],["T_STRING","setParentItem",657],"(",["T_VARIABLE","$order",657],["T_OBJECT_OPERATOR","->",657],["T_STRING","getItemByQuoteItemId",657],"(",["T_VARIABLE","$item",657],["T_OBJECT_OPERATOR","->",657],["T_STRING","getParentItem",657],"(",")",["T_OBJECT_OPERATOR","->",657],["T_STRING","getId",657],"(",")",")",")",";",["T_WHITESPACE","\n            ",657],"}",["T_WHITESPACE","\n            ",658],["T_VARIABLE","$order",659],["T_OBJECT_OPERATOR","->",659],["T_STRING","addItem",659],"(",["T_VARIABLE","$orderItem",659],")",";",["T_WHITESPACE","\n        ",659],"}",["T_WHITESPACE","\n\n        ",660],["T_RETURN","return",662],["T_WHITESPACE"," ",662],["T_VARIABLE","$order",662],";",["T_WHITESPACE","\n    ",662],"}",["T_WHITESPACE","\n\n    ",663],["T_DOC_COMMENT","\/**\n     * Validate quote data\n     *\n     * @return \\Magento\\Multishipping\\Model\\Checkout\\Type\\Multishipping\n     * @throws \\Magento\\Framework\\Exception\\LocalizedException\n     *\/",665],["T_WHITESPACE","\n    ",670],["T_PROTECTED","protected",671],["T_WHITESPACE"," ",671],["T_FUNCTION","function",671],["T_WHITESPACE"," ",671],["T_STRING","_validate",671],"(",")",["T_WHITESPACE","\n    ",671],"{",["T_WHITESPACE","\n        ",672],["T_VARIABLE","$quote",673],["T_WHITESPACE"," ",673],"=",["T_WHITESPACE"," ",673],["T_VARIABLE","$this",673],["T_OBJECT_OPERATOR","->",673],["T_STRING","getQuote",673],"(",")",";",["T_WHITESPACE","\n\n        ",673],["T_DOC_COMMENT","\/** @var $paymentMethod \\Magento\\Payment\\Model\\Method\\AbstractMethod *\/",675],["T_WHITESPACE","\n        ",675],["T_VARIABLE","$paymentMethod",676],["T_WHITESPACE"," ",676],"=",["T_WHITESPACE"," ",676],["T_VARIABLE","$quote",676],["T_OBJECT_OPERATOR","->",676],["T_STRING","getPayment",676],"(",")",["T_OBJECT_OPERATOR","->",676],["T_STRING","getMethodInstance",676],"(",")",";",["T_WHITESPACE","\n        ",676],["T_IF","if",677],["T_WHITESPACE"," ",677],"(","!",["T_VARIABLE","$paymentMethod",677],["T_OBJECT_OPERATOR","->",677],["T_STRING","isAvailable",677],"(",["T_VARIABLE","$quote",677],")",")",["T_WHITESPACE"," ",677],"{",["T_WHITESPACE","\n            ",677],["T_THROW","throw",678],["T_WHITESPACE"," ",678],["T_NEW","new",678],["T_WHITESPACE"," ",678],["T_NS_SEPARATOR","\\",678],["T_STRING","Magento",678],["T_NS_SEPARATOR","\\",678],["T_STRING","Framework",678],["T_NS_SEPARATOR","\\",678],["T_STRING","Exception",678],["T_NS_SEPARATOR","\\",678],["T_STRING","LocalizedException",678],"(",["T_WHITESPACE","\n                ",678],["T_STRING","__",679],"(",["T_CONSTANT_ENCAPSED_STRING","'Please specify a payment method.'",679],")",["T_WHITESPACE","\n            ",679],")",";",["T_WHITESPACE","\n        ",680],"}",["T_WHITESPACE","\n\n        ",681],["T_VARIABLE","$addresses",683],["T_WHITESPACE"," ",683],"=",["T_WHITESPACE"," ",683],["T_VARIABLE","$quote",683],["T_OBJECT_OPERATOR","->",683],["T_STRING","getAllShippingAddresses",683],"(",")",";",["T_WHITESPACE","\n        ",683],["T_FOREACH","foreach",684],["T_WHITESPACE"," ",684],"(",["T_VARIABLE","$addresses",684],["T_WHITESPACE"," ",684],["T_AS","as",684],["T_WHITESPACE"," ",684],["T_VARIABLE","$address",684],")",["T_WHITESPACE"," ",684],"{",["T_WHITESPACE","\n            ",684],["T_VARIABLE","$addressValidation",685],["T_WHITESPACE"," ",685],"=",["T_WHITESPACE"," ",685],["T_VARIABLE","$address",685],["T_OBJECT_OPERATOR","->",685],["T_STRING","validate",685],"(",")",";",["T_WHITESPACE","\n            ",685],["T_IF","if",686],["T_WHITESPACE"," ",686],"(",["T_VARIABLE","$addressValidation",686],["T_WHITESPACE"," ",686],["T_IS_NOT_IDENTICAL","!==",686],["T_WHITESPACE"," ",686],["T_STRING","true",686],")",["T_WHITESPACE"," ",686],"{",["T_WHITESPACE","\n                ",686],["T_THROW","throw",687],["T_WHITESPACE"," ",687],["T_NEW","new",687],["T_WHITESPACE"," ",687],["T_NS_SEPARATOR","\\",687],["T_STRING","Magento",687],["T_NS_SEPARATOR","\\",687],["T_STRING","Framework",687],["T_NS_SEPARATOR","\\",687],["T_STRING","Exception",687],["T_NS_SEPARATOR","\\",687],["T_STRING","LocalizedException",687],"(",["T_WHITESPACE","\n                    ",687],["T_STRING","__",688],"(",["T_CONSTANT_ENCAPSED_STRING","'Please check shipping addresses information.'",688],")",["T_WHITESPACE","\n                ",688],")",";",["T_WHITESPACE","\n            ",689],"}",["T_WHITESPACE","\n            ",690],["T_VARIABLE","$method",691],["T_WHITESPACE"," ",691],"=",["T_WHITESPACE"," ",691],["T_VARIABLE","$address",691],["T_OBJECT_OPERATOR","->",691],["T_STRING","getShippingMethod",691],"(",")",";",["T_WHITESPACE","\n            ",691],["T_VARIABLE","$rate",692],["T_WHITESPACE"," ",692],"=",["T_WHITESPACE"," ",692],["T_VARIABLE","$address",692],["T_OBJECT_OPERATOR","->",692],["T_STRING","getShippingRateByCode",692],"(",["T_VARIABLE","$method",692],")",";",["T_WHITESPACE","\n            ",692],["T_IF","if",693],["T_WHITESPACE"," ",693],"(","!",["T_VARIABLE","$method",693],["T_WHITESPACE"," ",693],["T_BOOLEAN_OR","||",693],["T_WHITESPACE"," ",693],"!",["T_VARIABLE","$rate",693],")",["T_WHITESPACE"," ",693],"{",["T_WHITESPACE","\n                ",693],["T_THROW","throw",694],["T_WHITESPACE"," ",694],["T_NEW","new",694],["T_WHITESPACE"," ",694],["T_NS_SEPARATOR","\\",694],["T_STRING","Magento",694],["T_NS_SEPARATOR","\\",694],["T_STRING","Framework",694],["T_NS_SEPARATOR","\\",694],["T_STRING","Exception",694],["T_NS_SEPARATOR","\\",694],["T_STRING","LocalizedException",694],"(",["T_WHITESPACE","\n                    ",694],["T_STRING","__",695],"(",["T_CONSTANT_ENCAPSED_STRING","'Please specify shipping methods for all addresses.'",695],")",["T_WHITESPACE","\n                ",695],")",";",["T_WHITESPACE","\n            ",696],"}",["T_WHITESPACE","\n        ",697],"}",["T_WHITESPACE","\n        ",698],["T_VARIABLE","$addressValidation",699],["T_WHITESPACE"," ",699],"=",["T_WHITESPACE"," ",699],["T_VARIABLE","$quote",699],["T_OBJECT_OPERATOR","->",699],["T_STRING","getBillingAddress",699],"(",")",["T_OBJECT_OPERATOR","->",699],["T_STRING","validate",699],"(",")",";",["T_WHITESPACE","\n        ",699],["T_IF","if",700],["T_WHITESPACE"," ",700],"(",["T_VARIABLE","$addressValidation",700],["T_WHITESPACE"," ",700],["T_IS_NOT_IDENTICAL","!==",700],["T_WHITESPACE"," ",700],["T_STRING","true",700],")",["T_WHITESPACE"," ",700],"{",["T_WHITESPACE","\n            ",700],["T_THROW","throw",701],["T_WHITESPACE"," ",701],["T_NEW","new",701],["T_WHITESPACE"," ",701],["T_NS_SEPARATOR","\\",701],["T_STRING","Magento",701],["T_NS_SEPARATOR","\\",701],["T_STRING","Framework",701],["T_NS_SEPARATOR","\\",701],["T_STRING","Exception",701],["T_NS_SEPARATOR","\\",701],["T_STRING","LocalizedException",701],"(",["T_STRING","__",701],"(",["T_CONSTANT_ENCAPSED_STRING","'Please check billing address information.'",701],")",")",";",["T_WHITESPACE","\n        ",701],"}",["T_WHITESPACE","\n        ",702],["T_RETURN","return",703],["T_WHITESPACE"," ",703],["T_VARIABLE","$this",703],";",["T_WHITESPACE","\n    ",703],"}",["T_WHITESPACE","\n\n    ",704],["T_DOC_COMMENT","\/**\n     * Create orders per each quote address\n     *\n     * @return \\Magento\\Multishipping\\Model\\Checkout\\Type\\Multishipping\n     * @throws \\Exception\n     *\/",706],["T_WHITESPACE","\n    ",711],["T_PUBLIC","public",712],["T_WHITESPACE"," ",712],["T_FUNCTION","function",712],["T_WHITESPACE"," ",712],["T_STRING","createOrders",712],"(",")",["T_WHITESPACE","\n    ",712],"{",["T_WHITESPACE","\n        ",713],["T_VARIABLE","$orderIds",714],["T_WHITESPACE"," ",714],"=",["T_WHITESPACE"," ",714],"[","]",";",["T_WHITESPACE","\n        ",714],["T_VARIABLE","$this",715],["T_OBJECT_OPERATOR","->",715],["T_STRING","_validate",715],"(",")",";",["T_WHITESPACE","\n        ",715],["T_VARIABLE","$shippingAddresses",716],["T_WHITESPACE"," ",716],"=",["T_WHITESPACE"," ",716],["T_VARIABLE","$this",716],["T_OBJECT_OPERATOR","->",716],["T_STRING","getQuote",716],"(",")",["T_OBJECT_OPERATOR","->",716],["T_STRING","getAllShippingAddresses",716],"(",")",";",["T_WHITESPACE","\n        ",716],["T_VARIABLE","$orders",717],["T_WHITESPACE"," ",717],"=",["T_WHITESPACE"," ",717],"[","]",";",["T_WHITESPACE","\n\n        ",717],["T_IF","if",719],["T_WHITESPACE"," ",719],"(",["T_VARIABLE","$this",719],["T_OBJECT_OPERATOR","->",719],["T_STRING","getQuote",719],"(",")",["T_OBJECT_OPERATOR","->",719],["T_STRING","hasVirtualItems",719],"(",")",")",["T_WHITESPACE"," ",719],"{",["T_WHITESPACE","\n            ",719],["T_VARIABLE","$shippingAddresses",720],"[","]",["T_WHITESPACE"," ",720],"=",["T_WHITESPACE"," ",720],["T_VARIABLE","$this",720],["T_OBJECT_OPERATOR","->",720],["T_STRING","getQuote",720],"(",")",["T_OBJECT_OPERATOR","->",720],["T_STRING","getBillingAddress",720],"(",")",";",["T_WHITESPACE","\n        ",720],"}",["T_WHITESPACE","\n\n        ",721],["T_TRY","try",723],["T_WHITESPACE"," ",723],"{",["T_WHITESPACE","\n            ",723],["T_FOREACH","foreach",724],["T_WHITESPACE"," ",724],"(",["T_VARIABLE","$shippingAddresses",724],["T_WHITESPACE"," ",724],["T_AS","as",724],["T_WHITESPACE"," ",724],["T_VARIABLE","$address",724],")",["T_WHITESPACE"," ",724],"{",["T_WHITESPACE","\n                ",724],["T_VARIABLE","$order",725],["T_WHITESPACE"," ",725],"=",["T_WHITESPACE"," ",725],["T_VARIABLE","$this",725],["T_OBJECT_OPERATOR","->",725],["T_STRING","_prepareOrder",725],"(",["T_VARIABLE","$address",725],")",";",["T_WHITESPACE","\n\n                ",725],["T_VARIABLE","$orders",727],"[","]",["T_WHITESPACE"," ",727],"=",["T_WHITESPACE"," ",727],["T_VARIABLE","$order",727],";",["T_WHITESPACE","\n                ",727],["T_VARIABLE","$this",728],["T_OBJECT_OPERATOR","->",728],["T_STRING","_eventManager",728],["T_OBJECT_OPERATOR","->",728],["T_STRING","dispatch",728],"(",["T_WHITESPACE","\n                    ",728],["T_CONSTANT_ENCAPSED_STRING","'checkout_type_multishipping_create_orders_single'",729],",",["T_WHITESPACE","\n                    ",729],"[",["T_CONSTANT_ENCAPSED_STRING","'order'",730],["T_WHITESPACE"," ",730],["T_DOUBLE_ARROW","=>",730],["T_WHITESPACE"," ",730],["T_VARIABLE","$order",730],",",["T_WHITESPACE"," ",730],["T_CONSTANT_ENCAPSED_STRING","'address'",730],["T_WHITESPACE"," ",730],["T_DOUBLE_ARROW","=>",730],["T_WHITESPACE"," ",730],["T_VARIABLE","$address",730],",",["T_WHITESPACE"," ",730],["T_CONSTANT_ENCAPSED_STRING","'quote'",730],["T_WHITESPACE"," ",730],["T_DOUBLE_ARROW","=>",730],["T_WHITESPACE"," ",730],["T_VARIABLE","$this",730],["T_OBJECT_OPERATOR","->",730],["T_STRING","getQuote",730],"(",")","]",["T_WHITESPACE","\n                ",730],")",";",["T_WHITESPACE","\n            ",731],"}",["T_WHITESPACE","\n\n            ",732],["T_FOREACH","foreach",734],["T_WHITESPACE"," ",734],"(",["T_VARIABLE","$orders",734],["T_WHITESPACE"," ",734],["T_AS","as",734],["T_WHITESPACE"," ",734],["T_VARIABLE","$order",734],")",["T_WHITESPACE"," ",734],"{",["T_WHITESPACE","\n                ",734],["T_VARIABLE","$order",735],["T_OBJECT_OPERATOR","->",735],["T_STRING","place",735],"(",")",";",["T_WHITESPACE","\n                ",735],["T_VARIABLE","$order",736],["T_OBJECT_OPERATOR","->",736],["T_STRING","save",736],"(",")",";",["T_WHITESPACE","\n                ",736],["T_IF","if",737],["T_WHITESPACE"," ",737],"(",["T_VARIABLE","$order",737],["T_OBJECT_OPERATOR","->",737],["T_STRING","getCanSendNewEmailFlag",737],"(",")",")",["T_WHITESPACE"," ",737],"{",["T_WHITESPACE","\n                    ",737],["T_VARIABLE","$this",738],["T_OBJECT_OPERATOR","->",738],["T_STRING","orderSender",738],["T_OBJECT_OPERATOR","->",738],["T_STRING","send",738],"(",["T_VARIABLE","$order",738],")",";",["T_WHITESPACE","\n                ",738],"}",["T_WHITESPACE","\n                ",739],["T_VARIABLE","$orderIds",740],"[",["T_VARIABLE","$order",740],["T_OBJECT_OPERATOR","->",740],["T_STRING","getId",740],"(",")","]",["T_WHITESPACE"," ",740],"=",["T_WHITESPACE"," ",740],["T_VARIABLE","$order",740],["T_OBJECT_OPERATOR","->",740],["T_STRING","getIncrementId",740],"(",")",";",["T_WHITESPACE","\n            ",740],"}",["T_WHITESPACE","\n\n            ",741],["T_VARIABLE","$this",743],["T_OBJECT_OPERATOR","->",743],["T_STRING","_session",743],["T_OBJECT_OPERATOR","->",743],["T_STRING","setOrderIds",743],"(",["T_VARIABLE","$orderIds",743],")",";",["T_WHITESPACE","\n            ",743],["T_VARIABLE","$this",744],["T_OBJECT_OPERATOR","->",744],["T_STRING","_checkoutSession",744],["T_OBJECT_OPERATOR","->",744],["T_STRING","setLastQuoteId",744],"(",["T_VARIABLE","$this",744],["T_OBJECT_OPERATOR","->",744],["T_STRING","getQuote",744],"(",")",["T_OBJECT_OPERATOR","->",744],["T_STRING","getId",744],"(",")",")",";",["T_WHITESPACE","\n\n            ",744],["T_VARIABLE","$this",746],["T_OBJECT_OPERATOR","->",746],["T_STRING","getQuote",746],"(",")",["T_OBJECT_OPERATOR","->",746],["T_STRING","setIsActive",746],"(",["T_STRING","false",746],")",";",["T_WHITESPACE","\n            ",746],["T_VARIABLE","$this",747],["T_OBJECT_OPERATOR","->",747],["T_STRING","quoteRepository",747],["T_OBJECT_OPERATOR","->",747],["T_STRING","save",747],"(",["T_VARIABLE","$this",747],["T_OBJECT_OPERATOR","->",747],["T_STRING","getQuote",747],"(",")",")",";",["T_WHITESPACE","\n\n            ",747],["T_VARIABLE","$this",749],["T_OBJECT_OPERATOR","->",749],["T_STRING","_eventManager",749],["T_OBJECT_OPERATOR","->",749],["T_STRING","dispatch",749],"(",["T_WHITESPACE","\n                ",749],["T_CONSTANT_ENCAPSED_STRING","'checkout_submit_all_after'",750],",",["T_WHITESPACE","\n                ",750],"[",["T_CONSTANT_ENCAPSED_STRING","'orders'",751],["T_WHITESPACE"," ",751],["T_DOUBLE_ARROW","=>",751],["T_WHITESPACE"," ",751],["T_VARIABLE","$orders",751],",",["T_WHITESPACE"," ",751],["T_CONSTANT_ENCAPSED_STRING","'quote'",751],["T_WHITESPACE"," ",751],["T_DOUBLE_ARROW","=>",751],["T_WHITESPACE"," ",751],["T_VARIABLE","$this",751],["T_OBJECT_OPERATOR","->",751],["T_STRING","getQuote",751],"(",")","]",["T_WHITESPACE","\n            ",751],")",";",["T_WHITESPACE","\n\n            ",752],["T_RETURN","return",754],["T_WHITESPACE"," ",754],["T_VARIABLE","$this",754],";",["T_WHITESPACE","\n        ",754],"}",["T_WHITESPACE"," ",755],["T_CATCH","catch",755],["T_WHITESPACE"," ",755],"(",["T_NS_SEPARATOR","\\",755],["T_STRING","Exception",755],["T_WHITESPACE"," ",755],["T_VARIABLE","$e",755],")",["T_WHITESPACE"," ",755],"{",["T_WHITESPACE","\n            ",755],["T_VARIABLE","$this",756],["T_OBJECT_OPERATOR","->",756],["T_STRING","_eventManager",756],["T_OBJECT_OPERATOR","->",756],["T_STRING","dispatch",756],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout_multishipping_refund_all'",756],",",["T_WHITESPACE"," ",756],"[",["T_CONSTANT_ENCAPSED_STRING","'orders'",756],["T_WHITESPACE"," ",756],["T_DOUBLE_ARROW","=>",756],["T_WHITESPACE"," ",756],["T_VARIABLE","$orders",756],"]",")",";",["T_WHITESPACE","\n            ",756],["T_THROW","throw",757],["T_WHITESPACE"," ",757],["T_VARIABLE","$e",757],";",["T_WHITESPACE","\n        ",757],"}",["T_WHITESPACE","\n    ",758],"}",["T_WHITESPACE","\n\n    ",759],["T_DOC_COMMENT","\/**\n     * Collect quote totals and save quote object\n     *\n     * @return \\Magento\\Multishipping\\Model\\Checkout\\Type\\Multishipping\n     *\/",761],["T_WHITESPACE","\n    ",765],["T_PUBLIC","public",766],["T_WHITESPACE"," ",766],["T_FUNCTION","function",766],["T_WHITESPACE"," ",766],["T_STRING","save",766],"(",")",["T_WHITESPACE","\n    ",766],"{",["T_WHITESPACE","\n        ",767],["T_VARIABLE","$this",768],["T_OBJECT_OPERATOR","->",768],["T_STRING","getQuote",768],"(",")",["T_OBJECT_OPERATOR","->",768],["T_STRING","collectTotals",768],"(",")",";",["T_WHITESPACE","\n        ",768],["T_VARIABLE","$this",769],["T_OBJECT_OPERATOR","->",769],["T_STRING","quoteRepository",769],["T_OBJECT_OPERATOR","->",769],["T_STRING","save",769],"(",["T_VARIABLE","$this",769],["T_OBJECT_OPERATOR","->",769],["T_STRING","getQuote",769],"(",")",")",";",["T_WHITESPACE","\n        ",769],["T_RETURN","return",770],["T_WHITESPACE"," ",770],["T_VARIABLE","$this",770],";",["T_WHITESPACE","\n    ",770],"}",["T_WHITESPACE","\n\n    ",771],["T_DOC_COMMENT","\/**\n     * Specify BEGIN state in checkout session whot allow reinit multishipping checkout\n     *\n     * @return \\Magento\\Multishipping\\Model\\Checkout\\Type\\Multishipping\n     *\/",773],["T_WHITESPACE","\n    ",777],["T_PUBLIC","public",778],["T_WHITESPACE"," ",778],["T_FUNCTION","function",778],["T_WHITESPACE"," ",778],["T_STRING","reset",778],"(",")",["T_WHITESPACE","\n    ",778],"{",["T_WHITESPACE","\n        ",779],["T_VARIABLE","$this",780],["T_OBJECT_OPERATOR","->",780],["T_STRING","getCheckoutSession",780],"(",")",["T_OBJECT_OPERATOR","->",780],["T_STRING","setCheckoutState",780],"(",["T_NS_SEPARATOR","\\",780],["T_STRING","Magento",780],["T_NS_SEPARATOR","\\",780],["T_STRING","Checkout",780],["T_NS_SEPARATOR","\\",780],["T_STRING","Model",780],["T_NS_SEPARATOR","\\",780],["T_STRING","Session",780],["T_DOUBLE_COLON","::",780],["T_STRING","CHECKOUT_STATE_BEGIN",780],")",";",["T_WHITESPACE","\n        ",780],["T_RETURN","return",781],["T_WHITESPACE"," ",781],["T_VARIABLE","$this",781],";",["T_WHITESPACE","\n    ",781],"}",["T_WHITESPACE","\n\n    ",782],["T_DOC_COMMENT","\/**\n     * Check if quote amount is allowed for multishipping checkout\n     *\n     * @return bool\n     *\/",784],["T_WHITESPACE","\n    ",788],["T_PUBLIC","public",789],["T_WHITESPACE"," ",789],["T_FUNCTION","function",789],["T_WHITESPACE"," ",789],["T_STRING","validateMinimumAmount",789],"(",")",["T_WHITESPACE","\n    ",789],"{",["T_WHITESPACE","\n        ",790],["T_RETURN","return",791],["T_WHITESPACE"," ",791],"!","(",["T_VARIABLE","$this",791],["T_OBJECT_OPERATOR","->",791],["T_STRING","_scopeConfig",791],["T_OBJECT_OPERATOR","->",791],["T_STRING","isSetFlag",791],"(",["T_WHITESPACE","\n            ",791],["T_CONSTANT_ENCAPSED_STRING","'sales\/minimum_order\/active'",792],",",["T_WHITESPACE","\n            ",792],["T_NS_SEPARATOR","\\",793],["T_STRING","Magento",793],["T_NS_SEPARATOR","\\",793],["T_STRING","Store",793],["T_NS_SEPARATOR","\\",793],["T_STRING","Model",793],["T_NS_SEPARATOR","\\",793],["T_STRING","ScopeInterface",793],["T_DOUBLE_COLON","::",793],["T_STRING","SCOPE_STORE",793],["T_WHITESPACE","\n        ",793],")",["T_WHITESPACE"," ",794],["T_BOOLEAN_AND","&&",794],["T_WHITESPACE"," ",794],["T_VARIABLE","$this",794],["T_OBJECT_OPERATOR","->",794],["T_STRING","_scopeConfig",794],["T_OBJECT_OPERATOR","->",794],["T_STRING","isSetFlag",794],"(",["T_WHITESPACE","\n            ",794],["T_CONSTANT_ENCAPSED_STRING","'sales\/minimum_order\/multi_address'",795],",",["T_WHITESPACE","\n            ",795],["T_NS_SEPARATOR","\\",796],["T_STRING","Magento",796],["T_NS_SEPARATOR","\\",796],["T_STRING","Store",796],["T_NS_SEPARATOR","\\",796],["T_STRING","Model",796],["T_NS_SEPARATOR","\\",796],["T_STRING","ScopeInterface",796],["T_DOUBLE_COLON","::",796],["T_STRING","SCOPE_STORE",796],["T_WHITESPACE","\n        ",796],")",["T_WHITESPACE"," ",797],["T_BOOLEAN_AND","&&",797],["T_WHITESPACE"," ",797],"!",["T_VARIABLE","$this",797],["T_OBJECT_OPERATOR","->",797],["T_STRING","getQuote",797],"(",")",["T_OBJECT_OPERATOR","->",797],["T_STRING","validateMinimumAmount",797],"(",")",")",";",["T_WHITESPACE","\n    ",797],"}",["T_WHITESPACE","\n\n    ",798],["T_DOC_COMMENT","\/**\n     * Get notification message for case when multishipping checkout is not allowed\n     *\n     * @return string\n     *\/",800],["T_WHITESPACE","\n    ",804],["T_PUBLIC","public",805],["T_WHITESPACE"," ",805],["T_FUNCTION","function",805],["T_WHITESPACE"," ",805],["T_STRING","getMinimumAmountDescription",805],"(",")",["T_WHITESPACE","\n    ",805],"{",["T_WHITESPACE","\n        ",806],["T_VARIABLE","$descr",807],["T_WHITESPACE"," ",807],"=",["T_WHITESPACE"," ",807],["T_VARIABLE","$this",807],["T_OBJECT_OPERATOR","->",807],["T_STRING","_scopeConfig",807],["T_OBJECT_OPERATOR","->",807],["T_STRING","getValue",807],"(",["T_WHITESPACE","\n            ",807],["T_CONSTANT_ENCAPSED_STRING","'sales\/minimum_order\/multi_address_description'",808],",",["T_WHITESPACE","\n            ",808],["T_NS_SEPARATOR","\\",809],["T_STRING","Magento",809],["T_NS_SEPARATOR","\\",809],["T_STRING","Store",809],["T_NS_SEPARATOR","\\",809],["T_STRING","Model",809],["T_NS_SEPARATOR","\\",809],["T_STRING","ScopeInterface",809],["T_DOUBLE_COLON","::",809],["T_STRING","SCOPE_STORE",809],["T_WHITESPACE","\n        ",809],")",";",["T_WHITESPACE","\n        ",810],["T_IF","if",811],["T_WHITESPACE"," ",811],"(",["T_EMPTY","empty",811],"(",["T_VARIABLE","$descr",811],")",")",["T_WHITESPACE"," ",811],"{",["T_WHITESPACE","\n            ",811],["T_VARIABLE","$descr",812],["T_WHITESPACE"," ",812],"=",["T_WHITESPACE"," ",812],["T_VARIABLE","$this",812],["T_OBJECT_OPERATOR","->",812],["T_STRING","_scopeConfig",812],["T_OBJECT_OPERATOR","->",812],["T_STRING","getValue",812],"(",["T_WHITESPACE","\n                ",812],["T_CONSTANT_ENCAPSED_STRING","'sales\/minimum_order\/description'",813],",",["T_WHITESPACE","\n                ",813],["T_NS_SEPARATOR","\\",814],["T_STRING","Magento",814],["T_NS_SEPARATOR","\\",814],["T_STRING","Store",814],["T_NS_SEPARATOR","\\",814],["T_STRING","Model",814],["T_NS_SEPARATOR","\\",814],["T_STRING","ScopeInterface",814],["T_DOUBLE_COLON","::",814],["T_STRING","SCOPE_STORE",814],["T_WHITESPACE","\n            ",814],")",";",["T_WHITESPACE","\n        ",815],"}",["T_WHITESPACE","\n        ",816],["T_RETURN","return",817],["T_WHITESPACE"," ",817],["T_VARIABLE","$descr",817],";",["T_WHITESPACE","\n    ",817],"}",["T_WHITESPACE","\n\n    ",818],["T_DOC_COMMENT","\/**\n     * @return string\n     *\/",820],["T_WHITESPACE","\n    ",822],["T_PUBLIC","public",823],["T_WHITESPACE"," ",823],["T_FUNCTION","function",823],["T_WHITESPACE"," ",823],["T_STRING","getMinimumAmountError",823],"(",")",["T_WHITESPACE","\n    ",823],"{",["T_WHITESPACE","\n        ",824],["T_VARIABLE","$error",825],["T_WHITESPACE"," ",825],"=",["T_WHITESPACE"," ",825],["T_VARIABLE","$this",825],["T_OBJECT_OPERATOR","->",825],["T_STRING","_scopeConfig",825],["T_OBJECT_OPERATOR","->",825],["T_STRING","getValue",825],"(",["T_WHITESPACE","\n            ",825],["T_CONSTANT_ENCAPSED_STRING","'sales\/minimum_order\/multi_address_error_message'",826],",",["T_WHITESPACE","\n            ",826],["T_NS_SEPARATOR","\\",827],["T_STRING","Magento",827],["T_NS_SEPARATOR","\\",827],["T_STRING","Store",827],["T_NS_SEPARATOR","\\",827],["T_STRING","Model",827],["T_NS_SEPARATOR","\\",827],["T_STRING","ScopeInterface",827],["T_DOUBLE_COLON","::",827],["T_STRING","SCOPE_STORE",827],["T_WHITESPACE","\n        ",827],")",";",["T_WHITESPACE","\n        ",828],["T_IF","if",829],["T_WHITESPACE"," ",829],"(",["T_EMPTY","empty",829],"(",["T_VARIABLE","$error",829],")",")",["T_WHITESPACE"," ",829],"{",["T_WHITESPACE","\n            ",829],["T_VARIABLE","$error",830],["T_WHITESPACE"," ",830],"=",["T_WHITESPACE"," ",830],["T_VARIABLE","$this",830],["T_OBJECT_OPERATOR","->",830],["T_STRING","_scopeConfig",830],["T_OBJECT_OPERATOR","->",830],["T_STRING","getValue",830],"(",["T_WHITESPACE","\n                ",830],["T_CONSTANT_ENCAPSED_STRING","'sales\/minimum_order\/error_message'",831],",",["T_WHITESPACE","\n                ",831],["T_NS_SEPARATOR","\\",832],["T_STRING","Magento",832],["T_NS_SEPARATOR","\\",832],["T_STRING","Store",832],["T_NS_SEPARATOR","\\",832],["T_STRING","Model",832],["T_NS_SEPARATOR","\\",832],["T_STRING","ScopeInterface",832],["T_DOUBLE_COLON","::",832],["T_STRING","SCOPE_STORE",832],["T_WHITESPACE","\n            ",832],")",";",["T_WHITESPACE","\n        ",833],"}",["T_WHITESPACE","\n        ",834],["T_RETURN","return",835],["T_WHITESPACE"," ",835],["T_VARIABLE","$error",835],";",["T_WHITESPACE","\n    ",835],"}",["T_WHITESPACE","\n\n    ",836],["T_DOC_COMMENT","\/**\n     * Get order IDs created during checkout\n     *\n     * @param bool $asAssoc\n     * @return array\n     *\/",838],["T_WHITESPACE","\n    ",843],["T_PUBLIC","public",844],["T_WHITESPACE"," ",844],["T_FUNCTION","function",844],["T_WHITESPACE"," ",844],["T_STRING","getOrderIds",844],"(",["T_VARIABLE","$asAssoc",844],["T_WHITESPACE"," ",844],"=",["T_WHITESPACE"," ",844],["T_STRING","false",844],")",["T_WHITESPACE","\n    ",844],"{",["T_WHITESPACE","\n        ",845],["T_VARIABLE","$idsAssoc",846],["T_WHITESPACE"," ",846],"=",["T_WHITESPACE"," ",846],["T_VARIABLE","$this",846],["T_OBJECT_OPERATOR","->",846],["T_STRING","_session",846],["T_OBJECT_OPERATOR","->",846],["T_STRING","getOrderIds",846],"(",")",";",["T_WHITESPACE","\n        ",846],["T_RETURN","return",847],["T_WHITESPACE"," ",847],["T_VARIABLE","$asAssoc",847],["T_WHITESPACE"," ",847],"?",["T_WHITESPACE"," ",847],["T_VARIABLE","$idsAssoc",847],["T_WHITESPACE"," ",847],":",["T_WHITESPACE"," ",847],["T_STRING","array_keys",847],"(",["T_VARIABLE","$idsAssoc",847],")",";",["T_WHITESPACE","\n    ",847],"}",["T_WHITESPACE","\n\n    ",848],["T_DOC_COMMENT","\/**\n     * Retrieve customer default billing address\n     *\n     * @return int|null\n     *\/",850],["T_WHITESPACE","\n    ",854],["T_PUBLIC","public",855],["T_WHITESPACE"," ",855],["T_FUNCTION","function",855],["T_WHITESPACE"," ",855],["T_STRING","getCustomerDefaultBillingAddress",855],"(",")",["T_WHITESPACE","\n    ",855],"{",["T_WHITESPACE","\n        ",856],["T_VARIABLE","$defaultAddressId",857],["T_WHITESPACE"," ",857],"=",["T_WHITESPACE"," ",857],["T_VARIABLE","$this",857],["T_OBJECT_OPERATOR","->",857],["T_STRING","getCustomer",857],"(",")",["T_OBJECT_OPERATOR","->",857],["T_STRING","getDefaultBilling",857],"(",")",";",["T_WHITESPACE","\n        ",857],["T_RETURN","return",858],["T_WHITESPACE"," ",858],["T_VARIABLE","$this",858],["T_OBJECT_OPERATOR","->",858],["T_STRING","getDefaultAddressByDataKey",858],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_default_billing_address'",858],",",["T_WHITESPACE"," ",858],["T_VARIABLE","$defaultAddressId",858],")",";",["T_WHITESPACE","\n    ",858],"}",["T_WHITESPACE","\n\n    ",859],["T_DOC_COMMENT","\/**\n     * Retrieve customer default shipping address\n     *\n     * @return int|null\n     *\/",861],["T_WHITESPACE","\n    ",865],["T_PUBLIC","public",866],["T_WHITESPACE"," ",866],["T_FUNCTION","function",866],["T_WHITESPACE"," ",866],["T_STRING","getCustomerDefaultShippingAddress",866],"(",")",["T_WHITESPACE","\n    ",866],"{",["T_WHITESPACE","\n        ",867],["T_VARIABLE","$defaultAddressId",868],["T_WHITESPACE"," ",868],"=",["T_WHITESPACE"," ",868],["T_VARIABLE","$this",868],["T_OBJECT_OPERATOR","->",868],["T_STRING","getCustomer",868],"(",")",["T_OBJECT_OPERATOR","->",868],["T_STRING","getDefaultShipping",868],"(",")",";",["T_WHITESPACE","\n        ",868],["T_RETURN","return",869],["T_WHITESPACE"," ",869],["T_VARIABLE","$this",869],["T_OBJECT_OPERATOR","->",869],["T_STRING","getDefaultAddressByDataKey",869],"(",["T_CONSTANT_ENCAPSED_STRING","'customer_default_shipping_address'",869],",",["T_WHITESPACE"," ",869],["T_VARIABLE","$defaultAddressId",869],")",";",["T_WHITESPACE","\n    ",869],"}",["T_WHITESPACE","\n\n    ",870],["T_DOC_COMMENT","\/**\n     * Retrieve customer default address by data key\n     *\n     * @param string $key\n     * @param string|null $defaultAddressIdFromCustomer\n     * @return int|null\n     *\/",872],["T_WHITESPACE","\n    ",878],["T_PRIVATE","private",879],["T_WHITESPACE"," ",879],["T_FUNCTION","function",879],["T_WHITESPACE"," ",879],["T_STRING","getDefaultAddressByDataKey",879],"(",["T_VARIABLE","$key",879],",",["T_WHITESPACE"," ",879],["T_VARIABLE","$defaultAddressIdFromCustomer",879],")",["T_WHITESPACE","\n    ",879],"{",["T_WHITESPACE","\n        ",880],["T_VARIABLE","$addressId",881],["T_WHITESPACE"," ",881],"=",["T_WHITESPACE"," ",881],["T_VARIABLE","$this",881],["T_OBJECT_OPERATOR","->",881],["T_STRING","getData",881],"(",["T_VARIABLE","$key",881],")",";",["T_WHITESPACE","\n        ",881],["T_IF","if",882],["T_WHITESPACE"," ",882],"(",["T_STRING","is_null",882],"(",["T_VARIABLE","$addressId",882],")",")",["T_WHITESPACE"," ",882],"{",["T_WHITESPACE","\n            ",882],["T_VARIABLE","$addressId",883],["T_WHITESPACE"," ",883],"=",["T_WHITESPACE"," ",883],["T_VARIABLE","$defaultAddressIdFromCustomer",883],";",["T_WHITESPACE","\n            ",883],["T_IF","if",884],["T_WHITESPACE"," ",884],"(","!",["T_VARIABLE","$addressId",884],")",["T_WHITESPACE"," ",884],"{",["T_WHITESPACE","\n                ",884],["T_DOC_COMMENT","\/** Default address is not available, try to find any customer address *\/",885],["T_WHITESPACE","\n                ",885],["T_VARIABLE","$filter",886],["T_WHITESPACE"," ",886],"=",["T_WHITESPACE","  ",886],["T_VARIABLE","$this",886],["T_OBJECT_OPERATOR","->",886],["T_STRING","filterBuilder",886],["T_OBJECT_OPERATOR","->",886],["T_STRING","setField",886],"(",["T_CONSTANT_ENCAPSED_STRING","'parent_id'",886],")",["T_WHITESPACE","\n                    ",886],["T_OBJECT_OPERATOR","->",887],["T_STRING","setValue",887],"(",["T_VARIABLE","$this",887],["T_OBJECT_OPERATOR","->",887],["T_STRING","getCustomer",887],"(",")",["T_OBJECT_OPERATOR","->",887],["T_STRING","getId",887],"(",")",")",["T_WHITESPACE","\n                    ",887],["T_OBJECT_OPERATOR","->",888],["T_STRING","setConditionType",888],"(",["T_CONSTANT_ENCAPSED_STRING","'eq'",888],")",["T_WHITESPACE","\n                    ",888],["T_OBJECT_OPERATOR","->",889],["T_STRING","create",889],"(",")",";",["T_WHITESPACE","\n                ",889],["T_VARIABLE","$addresses",890],["T_WHITESPACE"," ",890],"=",["T_WHITESPACE"," ",890],["T_ARRAY_CAST","(array)",890],"(",["T_VARIABLE","$this",890],["T_OBJECT_OPERATOR","->",890],["T_STRING","addressRepository",890],["T_OBJECT_OPERATOR","->",890],["T_STRING","getList",890],"(",["T_WHITESPACE","\n                    ",890],["T_VARIABLE","$this",891],["T_OBJECT_OPERATOR","->",891],["T_STRING","searchCriteriaBuilder",891],["T_OBJECT_OPERATOR","->",891],["T_STRING","addFilters",891],"(","[",["T_VARIABLE","$filter",891],"]",")",["T_OBJECT_OPERATOR","->",891],["T_STRING","create",891],"(",")",["T_WHITESPACE","\n                ",891],")",["T_OBJECT_OPERATOR","->",892],["T_STRING","getItems",892],"(",")",")",";",["T_WHITESPACE","\n                ",892],["T_IF","if",893],["T_WHITESPACE"," ",893],"(",["T_VARIABLE","$addresses",893],")",["T_WHITESPACE"," ",893],"{",["T_WHITESPACE","\n                    ",893],["T_VARIABLE","$address",894],["T_WHITESPACE"," ",894],"=",["T_WHITESPACE"," ",894],["T_STRING","reset",894],"(",["T_VARIABLE","$addresses",894],")",";",["T_WHITESPACE","\n                    ",894],["T_VARIABLE","$addressId",895],["T_WHITESPACE"," ",895],"=",["T_WHITESPACE"," ",895],["T_VARIABLE","$address",895],["T_OBJECT_OPERATOR","->",895],["T_STRING","getId",895],"(",")",";",["T_WHITESPACE","\n                ",895],"}",["T_WHITESPACE","\n            ",896],"}",["T_WHITESPACE","\n            ",897],["T_VARIABLE","$this",898],["T_OBJECT_OPERATOR","->",898],["T_STRING","setData",898],"(",["T_VARIABLE","$key",898],",",["T_WHITESPACE"," ",898],["T_VARIABLE","$addressId",898],")",";",["T_WHITESPACE","\n        ",898],"}",["T_WHITESPACE","\n\n        ",899],["T_RETURN","return",901],["T_WHITESPACE"," ",901],["T_VARIABLE","$addressId",901],";",["T_WHITESPACE","\n    ",901],"}",["T_WHITESPACE","\n\n    ",902],["T_DOC_COMMENT","\/**\n     * Retrieve checkout session model\n     *\n     * @return \\Magento\\Checkout\\Model\\Session\n     *\/",904],["T_WHITESPACE","\n    ",908],["T_PUBLIC","public",909],["T_WHITESPACE"," ",909],["T_FUNCTION","function",909],["T_WHITESPACE"," ",909],["T_STRING","getCheckoutSession",909],"(",")",["T_WHITESPACE","\n    ",909],"{",["T_WHITESPACE","\n        ",910],["T_VARIABLE","$checkout",911],["T_WHITESPACE"," ",911],"=",["T_WHITESPACE"," ",911],["T_VARIABLE","$this",911],["T_OBJECT_OPERATOR","->",911],["T_STRING","getData",911],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout_session'",911],")",";",["T_WHITESPACE","\n        ",911],["T_IF","if",912],["T_WHITESPACE"," ",912],"(",["T_STRING","is_null",912],"(",["T_VARIABLE","$checkout",912],")",")",["T_WHITESPACE"," ",912],"{",["T_WHITESPACE","\n            ",912],["T_VARIABLE","$checkout",913],["T_WHITESPACE"," ",913],"=",["T_WHITESPACE"," ",913],["T_VARIABLE","$this",913],["T_OBJECT_OPERATOR","->",913],["T_STRING","_checkoutSession",913],";",["T_WHITESPACE","\n            ",913],["T_VARIABLE","$this",914],["T_OBJECT_OPERATOR","->",914],["T_STRING","setData",914],"(",["T_CONSTANT_ENCAPSED_STRING","'checkout_session'",914],",",["T_WHITESPACE"," ",914],["T_VARIABLE","$checkout",914],")",";",["T_WHITESPACE","\n        ",914],"}",["T_WHITESPACE","\n        ",915],["T_RETURN","return",916],["T_WHITESPACE"," ",916],["T_VARIABLE","$checkout",916],";",["T_WHITESPACE","\n    ",916],"}",["T_WHITESPACE","\n\n    ",917],["T_DOC_COMMENT","\/**\n     * Retrieve quote model\n     *\n     * @return \\Magento\\Quote\\Model\\Quote\n     *\/",919],["T_WHITESPACE","\n    ",923],["T_PUBLIC","public",924],["T_WHITESPACE"," ",924],["T_FUNCTION","function",924],["T_WHITESPACE"," ",924],["T_STRING","getQuote",924],"(",")",["T_WHITESPACE","\n    ",924],"{",["T_WHITESPACE","\n        ",925],["T_RETURN","return",926],["T_WHITESPACE"," ",926],["T_VARIABLE","$this",926],["T_OBJECT_OPERATOR","->",926],["T_STRING","getCheckoutSession",926],"(",")",["T_OBJECT_OPERATOR","->",926],["T_STRING","getQuote",926],"(",")",";",["T_WHITESPACE","\n    ",926],"}",["T_WHITESPACE","\n\n    ",927],["T_DOC_COMMENT","\/**\n     * Retrieve quote items\n     *\n     * @return \\Magento\\Quote\\Model\\Quote\\Item[]\n     *\/",929],["T_WHITESPACE","\n    ",933],["T_PUBLIC","public",934],["T_WHITESPACE"," ",934],["T_FUNCTION","function",934],["T_WHITESPACE"," ",934],["T_STRING","getQuoteItems",934],"(",")",["T_WHITESPACE","\n    ",934],"{",["T_WHITESPACE","\n        ",935],["T_RETURN","return",936],["T_WHITESPACE"," ",936],["T_VARIABLE","$this",936],["T_OBJECT_OPERATOR","->",936],["T_STRING","getQuote",936],"(",")",["T_OBJECT_OPERATOR","->",936],["T_STRING","getAllItems",936],"(",")",";",["T_WHITESPACE","\n    ",936],"}",["T_WHITESPACE","\n\n    ",937],["T_DOC_COMMENT","\/**\n     * Retrieve customer session model\n     *\n     * @return \\Magento\\Customer\\Model\\Session\n     *\/",939],["T_WHITESPACE","\n    ",943],["T_PUBLIC","public",944],["T_WHITESPACE"," ",944],["T_FUNCTION","function",944],["T_WHITESPACE"," ",944],["T_STRING","getCustomerSession",944],"(",")",["T_WHITESPACE","\n    ",944],"{",["T_WHITESPACE","\n        ",945],["T_RETURN","return",946],["T_WHITESPACE"," ",946],["T_VARIABLE","$this",946],["T_OBJECT_OPERATOR","->",946],["T_STRING","_customerSession",946],";",["T_WHITESPACE","\n    ",946],"}",["T_WHITESPACE","\n\n    ",947],["T_DOC_COMMENT","\/**\n     * Retrieve customer object\n     *\n     * @return \\Magento\\Customer\\Api\\Data\\CustomerInterface\n     *\/",949],["T_WHITESPACE","\n    ",953],["T_PUBLIC","public",954],["T_WHITESPACE"," ",954],["T_FUNCTION","function",954],["T_WHITESPACE"," ",954],["T_STRING","getCustomer",954],"(",")",["T_WHITESPACE","\n    ",954],"{",["T_WHITESPACE","\n        ",955],["T_RETURN","return",956],["T_WHITESPACE"," ",956],["T_VARIABLE","$this",956],["T_OBJECT_OPERATOR","->",956],["T_STRING","_customerSession",956],["T_OBJECT_OPERATOR","->",956],["T_STRING","getCustomerDataObject",956],"(",")",";",["T_WHITESPACE","\n    ",956],"}",["T_WHITESPACE","\n\n    ",957],["T_DOC_COMMENT","\/**\n     * Check if specified address ID belongs to customer.\n     *\n     * @param $addressId\n     * @return bool\n     *\/",959],["T_WHITESPACE","\n    ",964],["T_PROTECTED","protected",965],["T_WHITESPACE"," ",965],["T_FUNCTION","function",965],["T_WHITESPACE"," ",965],["T_STRING","isAddressIdApplicable",965],"(",["T_VARIABLE","$addressId",965],")",["T_WHITESPACE","\n    ",965],"{",["T_WHITESPACE","\n        ",966],["T_VARIABLE","$applicableAddressIds",967],["T_WHITESPACE"," ",967],"=",["T_WHITESPACE"," ",967],["T_STRING","array_map",967],"(",["T_FUNCTION","function",967],"(",["T_VARIABLE","$address",967],")",["T_WHITESPACE"," ",967],"{",["T_WHITESPACE","\n            ",967],["T_DOC_COMMENT","\/** @var \\Magento\\Customer\\Api\\Data\\AddressInterface $address *\/",968],["T_WHITESPACE","\n            ",968],["T_RETURN","return",969],["T_WHITESPACE"," ",969],["T_VARIABLE","$address",969],["T_OBJECT_OPERATOR","->",969],["T_STRING","getId",969],"(",")",";",["T_WHITESPACE","\n        ",969],"}",",",["T_WHITESPACE"," ",970],["T_VARIABLE","$this",970],["T_OBJECT_OPERATOR","->",970],["T_STRING","getCustomer",970],"(",")",["T_OBJECT_OPERATOR","->",970],["T_STRING","getAddresses",970],"(",")",")",";",["T_WHITESPACE","\n        ",970],["T_RETURN","return",971],["T_WHITESPACE"," ",971],"!",["T_STRING","is_numeric",971],"(",["T_VARIABLE","$addressId",971],")",["T_WHITESPACE"," ",971],["T_BOOLEAN_OR","||",971],["T_WHITESPACE"," ",971],["T_STRING","in_array",971],"(",["T_VARIABLE","$addressId",971],",",["T_WHITESPACE"," ",971],["T_VARIABLE","$applicableAddressIds",971],")",";",["T_WHITESPACE","\n    ",971],"}",["T_WHITESPACE","\n\n    ",972],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Quote\\Model\\Quote $quote\n     * @return \\Magento\\Quote\\Model\\Quote\n     *\/",974],["T_WHITESPACE","\n    ",977],["T_PRIVATE","private",978],["T_WHITESPACE"," ",978],["T_FUNCTION","function",978],["T_WHITESPACE"," ",978],["T_STRING","prepareShippingAssignment",978],"(",["T_VARIABLE","$quote",978],")",["T_WHITESPACE","\n    ",978],"{",["T_WHITESPACE","\n        ",979],["T_VARIABLE","$cartExtension",980],["T_WHITESPACE"," ",980],"=",["T_WHITESPACE"," ",980],["T_VARIABLE","$quote",980],["T_OBJECT_OPERATOR","->",980],["T_STRING","getExtensionAttributes",980],"(",")",";",["T_WHITESPACE","\n        ",980],["T_IF","if",981],["T_WHITESPACE"," ",981],"(",["T_VARIABLE","$cartExtension",981],["T_WHITESPACE"," ",981],["T_IS_IDENTICAL","===",981],["T_WHITESPACE"," ",981],["T_STRING","null",981],")",["T_WHITESPACE"," ",981],"{",["T_WHITESPACE","\n            ",981],["T_VARIABLE","$cartExtension",982],["T_WHITESPACE"," ",982],"=",["T_WHITESPACE"," ",982],["T_VARIABLE","$this",982],["T_OBJECT_OPERATOR","->",982],["T_STRING","getCartExtensionFactory",982],"(",")",["T_OBJECT_OPERATOR","->",982],["T_STRING","create",982],"(",")",";",["T_WHITESPACE","\n        ",982],"}",["T_WHITESPACE","\n        ",983],["T_DOC_COMMENT","\/** @var \\Magento\\Quote\\Api\\Data\\ShippingAssignmentInterface $shippingAssignment *\/",984],["T_WHITESPACE","\n        ",984],["T_VARIABLE","$shippingAssignment",985],["T_WHITESPACE"," ",985],"=",["T_WHITESPACE"," ",985],["T_VARIABLE","$this",985],["T_OBJECT_OPERATOR","->",985],["T_STRING","getShippingAssignmentProcessor",985],"(",")",["T_OBJECT_OPERATOR","->",985],["T_STRING","create",985],"(",["T_VARIABLE","$quote",985],")",";",["T_WHITESPACE","\n        ",985],["T_VARIABLE","$shipping",986],["T_WHITESPACE"," ",986],"=",["T_WHITESPACE"," ",986],["T_VARIABLE","$shippingAssignment",986],["T_OBJECT_OPERATOR","->",986],["T_STRING","getShipping",986],"(",")",";",["T_WHITESPACE","\n\n        ",986],["T_VARIABLE","$shipping",988],["T_OBJECT_OPERATOR","->",988],["T_STRING","setMethod",988],"(",["T_STRING","null",988],")",";",["T_WHITESPACE","\n        ",988],["T_VARIABLE","$shippingAssignment",989],["T_OBJECT_OPERATOR","->",989],["T_STRING","setShipping",989],"(",["T_VARIABLE","$shipping",989],")",";",["T_WHITESPACE","\n        ",989],["T_VARIABLE","$cartExtension",990],["T_OBJECT_OPERATOR","->",990],["T_STRING","setShippingAssignments",990],"(","[",["T_VARIABLE","$shippingAssignment",990],"]",")",";",["T_WHITESPACE","\n        ",990],["T_RETURN","return",991],["T_WHITESPACE"," ",991],["T_VARIABLE","$quote",991],["T_OBJECT_OPERATOR","->",991],["T_STRING","setExtensionAttributes",991],"(",["T_VARIABLE","$cartExtension",991],")",";",["T_WHITESPACE","\n    ",991],"}",["T_WHITESPACE","\n\n    ",992],["T_DOC_COMMENT","\/**\n     * @return \\Magento\\Quote\\Api\\Data\\CartExtensionFactory\n     *\/",994],["T_WHITESPACE","\n    ",996],["T_PRIVATE","private",997],["T_WHITESPACE"," ",997],["T_FUNCTION","function",997],["T_WHITESPACE"," ",997],["T_STRING","getCartExtensionFactory",997],"(",")",["T_WHITESPACE","\n    ",997],"{",["T_WHITESPACE","\n        ",998],["T_IF","if",999],["T_WHITESPACE"," ",999],"(","!",["T_VARIABLE","$this",999],["T_OBJECT_OPERATOR","->",999],["T_STRING","cartExtensionFactory",999],")",["T_WHITESPACE"," ",999],"{",["T_WHITESPACE","\n            ",999],["T_VARIABLE","$this",1000],["T_OBJECT_OPERATOR","->",1000],["T_STRING","cartExtensionFactory",1000],["T_WHITESPACE"," ",1000],"=",["T_WHITESPACE"," ",1000],["T_STRING","ObjectManager",1000],["T_DOUBLE_COLON","::",1000],["T_STRING","getInstance",1000],"(",")",["T_WHITESPACE","\n                ",1000],["T_OBJECT_OPERATOR","->",1001],["T_STRING","get",1001],"(",["T_NS_SEPARATOR","\\",1001],["T_STRING","Magento",1001],["T_NS_SEPARATOR","\\",1001],["T_STRING","Quote",1001],["T_NS_SEPARATOR","\\",1001],["T_STRING","Api",1001],["T_NS_SEPARATOR","\\",1001],["T_STRING","Data",1001],["T_NS_SEPARATOR","\\",1001],["T_STRING","CartExtensionFactory",1001],["T_DOUBLE_COLON","::",1001],["T_CLASS","class",1001],")",";",["T_WHITESPACE","\n        ",1001],"}",["T_WHITESPACE","\n        ",1002],["T_RETURN","return",1003],["T_WHITESPACE"," ",1003],["T_VARIABLE","$this",1003],["T_OBJECT_OPERATOR","->",1003],["T_STRING","cartExtensionFactory",1003],";",["T_WHITESPACE","\n    ",1003],"}",["T_WHITESPACE","\n\n    ",1004],["T_DOC_COMMENT","\/**\n     * @return \\Magento\\Quote\\Model\\Quote\\ShippingAssignment\\ShippingAssignmentProcessor\n     *\/",1006],["T_WHITESPACE","\n    ",1008],["T_PRIVATE","private",1009],["T_WHITESPACE"," ",1009],["T_FUNCTION","function",1009],["T_WHITESPACE"," ",1009],["T_STRING","getShippingAssignmentProcessor",1009],"(",")",["T_WHITESPACE","\n    ",1009],"{",["T_WHITESPACE","\n        ",1010],["T_IF","if",1011],["T_WHITESPACE"," ",1011],"(","!",["T_VARIABLE","$this",1011],["T_OBJECT_OPERATOR","->",1011],["T_STRING","shippingAssignmentProcessor",1011],")",["T_WHITESPACE"," ",1011],"{",["T_WHITESPACE","\n            ",1011],["T_VARIABLE","$this",1012],["T_OBJECT_OPERATOR","->",1012],["T_STRING","shippingAssignmentProcessor",1012],["T_WHITESPACE"," ",1012],"=",["T_WHITESPACE"," ",1012],["T_STRING","ObjectManager",1012],["T_DOUBLE_COLON","::",1012],["T_STRING","getInstance",1012],"(",")",["T_WHITESPACE","\n                ",1012],["T_OBJECT_OPERATOR","->",1013],["T_STRING","get",1013],"(",["T_NS_SEPARATOR","\\",1013],["T_STRING","Magento",1013],["T_NS_SEPARATOR","\\",1013],["T_STRING","Quote",1013],["T_NS_SEPARATOR","\\",1013],["T_STRING","Model",1013],["T_NS_SEPARATOR","\\",1013],["T_STRING","Quote",1013],["T_NS_SEPARATOR","\\",1013],["T_STRING","ShippingAssignment",1013],["T_NS_SEPARATOR","\\",1013],["T_STRING","ShippingAssignmentProcessor",1013],["T_DOUBLE_COLON","::",1013],["T_CLASS","class",1013],")",";",["T_WHITESPACE","\n        ",1013],"}",["T_WHITESPACE","\n        ",1014],["T_RETURN","return",1015],["T_WHITESPACE"," ",1015],["T_VARIABLE","$this",1015],["T_OBJECT_OPERATOR","->",1015],["T_STRING","shippingAssignmentProcessor",1015],";",["T_WHITESPACE","\n    ",1015],"}",["T_WHITESPACE","\n",1016],"}",["T_WHITESPACE","\n",1017]]