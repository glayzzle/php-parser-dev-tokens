[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","ProductAlert",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Model",6],";",["T_WHITESPACE","\n\n",6],["T_DOC_COMMENT","\/**\n * ProductAlert observer\n *\n * @author     Magento Core Team <core@magentocommerce.com>\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",8],["T_WHITESPACE","\n",13],["T_CLASS","class",14],["T_WHITESPACE"," ",14],["T_STRING","Observer",14],["T_WHITESPACE","\n",14],"{",["T_WHITESPACE","\n    ",15],["T_DOC_COMMENT","\/**\n     * Error email template configuration\n     *\/",16],["T_WHITESPACE","\n    ",18],["T_CONST","const",19],["T_WHITESPACE"," ",19],["T_STRING","XML_PATH_ERROR_TEMPLATE",19],["T_WHITESPACE"," ",19],"=",["T_WHITESPACE"," ",19],["T_CONSTANT_ENCAPSED_STRING","'catalog\/productalert_cron\/error_email_template'",19],";",["T_WHITESPACE","\n\n    ",19],["T_DOC_COMMENT","\/**\n     * Error email identity configuration\n     *\/",21],["T_WHITESPACE","\n    ",23],["T_CONST","const",24],["T_WHITESPACE"," ",24],["T_STRING","XML_PATH_ERROR_IDENTITY",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","'catalog\/productalert_cron\/error_email_identity'",24],";",["T_WHITESPACE","\n\n    ",24],["T_DOC_COMMENT","\/**\n     * 'Send error emails to' configuration\n     *\/",26],["T_WHITESPACE","\n    ",28],["T_CONST","const",29],["T_WHITESPACE"," ",29],["T_STRING","XML_PATH_ERROR_RECIPIENT",29],["T_WHITESPACE"," ",29],"=",["T_WHITESPACE"," ",29],["T_CONSTANT_ENCAPSED_STRING","'catalog\/productalert_cron\/error_email'",29],";",["T_WHITESPACE","\n\n    ",29],["T_DOC_COMMENT","\/**\n     * Allow price alert\n     *\n     *\/",31],["T_WHITESPACE","\n    ",34],["T_CONST","const",35],["T_WHITESPACE"," ",35],["T_STRING","XML_PATH_PRICE_ALLOW",35],["T_WHITESPACE"," ",35],"=",["T_WHITESPACE"," ",35],["T_CONSTANT_ENCAPSED_STRING","'catalog\/productalert\/allow_price'",35],";",["T_WHITESPACE","\n\n    ",35],["T_DOC_COMMENT","\/**\n     * Allow stock alert\n     *\n     *\/",37],["T_WHITESPACE","\n    ",40],["T_CONST","const",41],["T_WHITESPACE"," ",41],["T_STRING","XML_PATH_STOCK_ALLOW",41],["T_WHITESPACE"," ",41],"=",["T_WHITESPACE"," ",41],["T_CONSTANT_ENCAPSED_STRING","'catalog\/productalert\/allow_stock'",41],";",["T_WHITESPACE","\n\n    ",41],["T_DOC_COMMENT","\/**\n     * Website collection array\n     *\n     * @var array\n     *\/",43],["T_WHITESPACE","\n    ",47],["T_PROTECTED","protected",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$_websites",48],";",["T_WHITESPACE","\n\n    ",48],["T_DOC_COMMENT","\/**\n     * Warning (exception) errors array\n     *\n     * @var array\n     *\/",50],["T_WHITESPACE","\n    ",54],["T_PROTECTED","protected",55],["T_WHITESPACE"," ",55],["T_VARIABLE","$_errors",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],"[","]",";",["T_WHITESPACE","\n\n    ",55],["T_DOC_COMMENT","\/**\n     * Catalog data\n     *\n     * @var \\Magento\\Catalog\\Helper\\Data\n     *\/",57],["T_WHITESPACE","\n    ",61],["T_PROTECTED","protected",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$_catalogData",62],["T_WHITESPACE"," ",62],"=",["T_WHITESPACE"," ",62],["T_STRING","null",62],";",["T_WHITESPACE","\n\n    ",62],["T_DOC_COMMENT","\/**\n     * Core store config\n     *\n     * @var \\Magento\\Framework\\App\\Config\\ScopeConfigInterface\n     *\/",64],["T_WHITESPACE","\n    ",68],["T_PROTECTED","protected",69],["T_WHITESPACE"," ",69],["T_VARIABLE","$_scopeConfig",69],";",["T_WHITESPACE","\n\n    ",69],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Store\\Model\\StoreManagerInterface\n     *\/",71],["T_WHITESPACE","\n    ",73],["T_PROTECTED","protected",74],["T_WHITESPACE"," ",74],["T_VARIABLE","$_storeManager",74],";",["T_WHITESPACE","\n\n    ",74],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\ProductAlert\\Model\\ResourceModel\\Price\\CollectionFactory\n     *\/",76],["T_WHITESPACE","\n    ",78],["T_PROTECTED","protected",79],["T_WHITESPACE"," ",79],["T_VARIABLE","$_priceColFactory",79],";",["T_WHITESPACE","\n\n    ",79],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Customer\\Api\\CustomerRepositoryInterface\n     *\/",81],["T_WHITESPACE","\n    ",83],["T_PROTECTED","protected",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$customerRepository",84],";",["T_WHITESPACE","\n\n    ",84],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Catalog\\Api\\ProductRepositoryInterface\n     *\/",86],["T_WHITESPACE","\n    ",88],["T_PROTECTED","protected",89],["T_WHITESPACE"," ",89],["T_VARIABLE","$productRepository",89],";",["T_WHITESPACE","\n\n    ",89],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Stdlib\\DateTime\\DateTimeFactory\n     *\/",91],["T_WHITESPACE","\n    ",93],["T_PROTECTED","protected",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$_dateFactory",94],";",["T_WHITESPACE","\n\n    ",94],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\ProductAlert\\Model\\ResourceModel\\Stock\\CollectionFactory\n     *\/",96],["T_WHITESPACE","\n    ",98],["T_PROTECTED","protected",99],["T_WHITESPACE"," ",99],["T_VARIABLE","$_stockColFactory",99],";",["T_WHITESPACE","\n\n    ",99],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Mail\\Template\\TransportBuilder\n     *\/",101],["T_WHITESPACE","\n    ",103],["T_PROTECTED","protected",104],["T_WHITESPACE"," ",104],["T_VARIABLE","$_transportBuilder",104],";",["T_WHITESPACE","\n\n    ",104],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\ProductAlert\\Model\\EmailFactory\n     *\/",106],["T_WHITESPACE","\n    ",108],["T_PROTECTED","protected",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$_emailFactory",109],";",["T_WHITESPACE","\n\n    ",109],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Translate\\Inline\\StateInterface\n     *\/",111],["T_WHITESPACE","\n    ",113],["T_PROTECTED","protected",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$inlineTranslation",114],";",["T_WHITESPACE","\n\n    ",114],["T_DOC_COMMENT","\/**\n     * @param \\Magento\\Catalog\\Helper\\Data $catalogData\n     * @param \\Magento\\Framework\\App\\Config\\ScopeConfigInterface $scopeConfig\n     * @param \\Magento\\Store\\Model\\StoreManagerInterface $storeManager\n     * @param \\Magento\\ProductAlert\\Model\\ResourceModel\\Price\\CollectionFactory $priceColFactory\n     * @param \\Magento\\Customer\\Api\\CustomerRepositoryInterface $customerRepository\n     * @param \\Magento\\Catalog\\Api\\ProductRepositoryInterface $productRepository\n     * @param \\Magento\\Framework\\Stdlib\\DateTime\\DateTimeFactory $dateFactory\n     * @param \\Magento\\ProductAlert\\Model\\ResourceModel\\Stock\\CollectionFactory $stockColFactory\n     * @param \\Magento\\Framework\\Mail\\Template\\TransportBuilder $transportBuilder\n     * @param \\Magento\\ProductAlert\\Model\\EmailFactory $emailFactory\n     * @param \\Magento\\Framework\\Translate\\Inline\\StateInterface $inlineTranslation\n     * @SuppressWarnings(PHPMD.ExcessiveParameterList)\n     *\/",116],["T_WHITESPACE","\n    ",129],["T_PUBLIC","public",130],["T_WHITESPACE"," ",130],["T_FUNCTION","function",130],["T_WHITESPACE"," ",130],["T_STRING","__construct",130],"(",["T_WHITESPACE","\n        ",130],["T_NS_SEPARATOR","\\",131],["T_STRING","Magento",131],["T_NS_SEPARATOR","\\",131],["T_STRING","Catalog",131],["T_NS_SEPARATOR","\\",131],["T_STRING","Helper",131],["T_NS_SEPARATOR","\\",131],["T_STRING","Data",131],["T_WHITESPACE"," ",131],["T_VARIABLE","$catalogData",131],",",["T_WHITESPACE","\n        ",131],["T_NS_SEPARATOR","\\",132],["T_STRING","Magento",132],["T_NS_SEPARATOR","\\",132],["T_STRING","Framework",132],["T_NS_SEPARATOR","\\",132],["T_STRING","App",132],["T_NS_SEPARATOR","\\",132],["T_STRING","Config",132],["T_NS_SEPARATOR","\\",132],["T_STRING","ScopeConfigInterface",132],["T_WHITESPACE"," ",132],["T_VARIABLE","$scopeConfig",132],",",["T_WHITESPACE","\n        ",132],["T_NS_SEPARATOR","\\",133],["T_STRING","Magento",133],["T_NS_SEPARATOR","\\",133],["T_STRING","Store",133],["T_NS_SEPARATOR","\\",133],["T_STRING","Model",133],["T_NS_SEPARATOR","\\",133],["T_STRING","StoreManagerInterface",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$storeManager",133],",",["T_WHITESPACE","\n        ",133],["T_NS_SEPARATOR","\\",134],["T_STRING","Magento",134],["T_NS_SEPARATOR","\\",134],["T_STRING","ProductAlert",134],["T_NS_SEPARATOR","\\",134],["T_STRING","Model",134],["T_NS_SEPARATOR","\\",134],["T_STRING","ResourceModel",134],["T_NS_SEPARATOR","\\",134],["T_STRING","Price",134],["T_NS_SEPARATOR","\\",134],["T_STRING","CollectionFactory",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$priceColFactory",134],",",["T_WHITESPACE","\n        ",134],["T_NS_SEPARATOR","\\",135],["T_STRING","Magento",135],["T_NS_SEPARATOR","\\",135],["T_STRING","Customer",135],["T_NS_SEPARATOR","\\",135],["T_STRING","Api",135],["T_NS_SEPARATOR","\\",135],["T_STRING","CustomerRepositoryInterface",135],["T_WHITESPACE"," ",135],["T_VARIABLE","$customerRepository",135],",",["T_WHITESPACE","\n        ",135],["T_NS_SEPARATOR","\\",136],["T_STRING","Magento",136],["T_NS_SEPARATOR","\\",136],["T_STRING","Catalog",136],["T_NS_SEPARATOR","\\",136],["T_STRING","Api",136],["T_NS_SEPARATOR","\\",136],["T_STRING","ProductRepositoryInterface",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$productRepository",136],",",["T_WHITESPACE","\n        ",136],["T_NS_SEPARATOR","\\",137],["T_STRING","Magento",137],["T_NS_SEPARATOR","\\",137],["T_STRING","Framework",137],["T_NS_SEPARATOR","\\",137],["T_STRING","Stdlib",137],["T_NS_SEPARATOR","\\",137],["T_STRING","DateTime",137],["T_NS_SEPARATOR","\\",137],["T_STRING","DateTimeFactory",137],["T_WHITESPACE"," ",137],["T_VARIABLE","$dateFactory",137],",",["T_WHITESPACE","\n        ",137],["T_NS_SEPARATOR","\\",138],["T_STRING","Magento",138],["T_NS_SEPARATOR","\\",138],["T_STRING","ProductAlert",138],["T_NS_SEPARATOR","\\",138],["T_STRING","Model",138],["T_NS_SEPARATOR","\\",138],["T_STRING","ResourceModel",138],["T_NS_SEPARATOR","\\",138],["T_STRING","Stock",138],["T_NS_SEPARATOR","\\",138],["T_STRING","CollectionFactory",138],["T_WHITESPACE"," ",138],["T_VARIABLE","$stockColFactory",138],",",["T_WHITESPACE","\n        ",138],["T_NS_SEPARATOR","\\",139],["T_STRING","Magento",139],["T_NS_SEPARATOR","\\",139],["T_STRING","Framework",139],["T_NS_SEPARATOR","\\",139],["T_STRING","Mail",139],["T_NS_SEPARATOR","\\",139],["T_STRING","Template",139],["T_NS_SEPARATOR","\\",139],["T_STRING","TransportBuilder",139],["T_WHITESPACE"," ",139],["T_VARIABLE","$transportBuilder",139],",",["T_WHITESPACE","\n        ",139],["T_NS_SEPARATOR","\\",140],["T_STRING","Magento",140],["T_NS_SEPARATOR","\\",140],["T_STRING","ProductAlert",140],["T_NS_SEPARATOR","\\",140],["T_STRING","Model",140],["T_NS_SEPARATOR","\\",140],["T_STRING","EmailFactory",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$emailFactory",140],",",["T_WHITESPACE","\n        ",140],["T_NS_SEPARATOR","\\",141],["T_STRING","Magento",141],["T_NS_SEPARATOR","\\",141],["T_STRING","Framework",141],["T_NS_SEPARATOR","\\",141],["T_STRING","Translate",141],["T_NS_SEPARATOR","\\",141],["T_STRING","Inline",141],["T_NS_SEPARATOR","\\",141],["T_STRING","StateInterface",141],["T_WHITESPACE"," ",141],["T_VARIABLE","$inlineTranslation",141],["T_WHITESPACE","\n    ",141],")",["T_WHITESPACE"," ",142],"{",["T_WHITESPACE","\n        ",142],["T_VARIABLE","$this",143],["T_OBJECT_OPERATOR","->",143],["T_STRING","_catalogData",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_VARIABLE","$catalogData",143],";",["T_WHITESPACE","\n        ",143],["T_VARIABLE","$this",144],["T_OBJECT_OPERATOR","->",144],["T_STRING","_scopeConfig",144],["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_VARIABLE","$scopeConfig",144],";",["T_WHITESPACE","\n        ",144],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","_storeManager",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_VARIABLE","$storeManager",145],";",["T_WHITESPACE","\n        ",145],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","_priceColFactory",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_VARIABLE","$priceColFactory",146],";",["T_WHITESPACE","\n        ",146],["T_VARIABLE","$this",147],["T_OBJECT_OPERATOR","->",147],["T_STRING","customerRepository",147],["T_WHITESPACE"," ",147],"=",["T_WHITESPACE"," ",147],["T_VARIABLE","$customerRepository",147],";",["T_WHITESPACE","\n        ",147],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","productRepository",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_VARIABLE","$productRepository",148],";",["T_WHITESPACE","\n        ",148],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","_dateFactory",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_VARIABLE","$dateFactory",149],";",["T_WHITESPACE","\n        ",149],["T_VARIABLE","$this",150],["T_OBJECT_OPERATOR","->",150],["T_STRING","_stockColFactory",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],["T_VARIABLE","$stockColFactory",150],";",["T_WHITESPACE","\n        ",150],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","_transportBuilder",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_VARIABLE","$transportBuilder",151],";",["T_WHITESPACE","\n        ",151],["T_VARIABLE","$this",152],["T_OBJECT_OPERATOR","->",152],["T_STRING","_emailFactory",152],["T_WHITESPACE"," ",152],"=",["T_WHITESPACE"," ",152],["T_VARIABLE","$emailFactory",152],";",["T_WHITESPACE","\n        ",152],["T_VARIABLE","$this",153],["T_OBJECT_OPERATOR","->",153],["T_STRING","inlineTranslation",153],["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_VARIABLE","$inlineTranslation",153],";",["T_WHITESPACE","\n    ",153],"}",["T_WHITESPACE","\n\n    ",154],["T_DOC_COMMENT","\/**\n     * Retrieve website collection array\n     *\n     * @return array\n     * @throws \\Exception\n     *\/",156],["T_WHITESPACE","\n    ",161],["T_PROTECTED","protected",162],["T_WHITESPACE"," ",162],["T_FUNCTION","function",162],["T_WHITESPACE"," ",162],["T_STRING","_getWebsites",162],"(",")",["T_WHITESPACE","\n    ",162],"{",["T_WHITESPACE","\n        ",163],["T_IF","if",164],["T_WHITESPACE"," ",164],"(",["T_VARIABLE","$this",164],["T_OBJECT_OPERATOR","->",164],["T_STRING","_websites",164],["T_WHITESPACE"," ",164],["T_IS_IDENTICAL","===",164],["T_WHITESPACE"," ",164],["T_STRING","null",164],")",["T_WHITESPACE"," ",164],"{",["T_WHITESPACE","\n            ",164],["T_TRY","try",165],["T_WHITESPACE"," ",165],"{",["T_WHITESPACE","\n                ",165],["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","_websites",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_VARIABLE","$this",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","_storeManager",166],["T_OBJECT_OPERATOR","->",166],["T_STRING","getWebsites",166],"(",")",";",["T_WHITESPACE","\n            ",166],"}",["T_WHITESPACE"," ",167],["T_CATCH","catch",167],["T_WHITESPACE"," ",167],"(",["T_NS_SEPARATOR","\\",167],["T_STRING","Exception",167],["T_WHITESPACE"," ",167],["T_VARIABLE","$e",167],")",["T_WHITESPACE"," ",167],"{",["T_WHITESPACE","\n                ",167],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","_errors",168],"[","]",["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_VARIABLE","$e",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","getMessage",168],"(",")",";",["T_WHITESPACE","\n                ",168],["T_THROW","throw",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$e",169],";",["T_WHITESPACE","\n            ",169],"}",["T_WHITESPACE","\n        ",170],"}",["T_WHITESPACE","\n        ",171],["T_RETURN","return",172],["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","_websites",172],";",["T_WHITESPACE","\n    ",172],"}",["T_WHITESPACE","\n\n    ",173],["T_DOC_COMMENT","\/**\n     * Process price emails\n     *\n     * @param \\Magento\\ProductAlert\\Model\\Email $email\n     * @return $this\n     * @throws \\Exception\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     * @SuppressWarnings(PHPMD.NPathComplexity)\n     *\/",175],["T_WHITESPACE","\n    ",183],["T_PROTECTED","protected",184],["T_WHITESPACE"," ",184],["T_FUNCTION","function",184],["T_WHITESPACE"," ",184],["T_STRING","_processPrice",184],"(",["T_NS_SEPARATOR","\\",184],["T_STRING","Magento",184],["T_NS_SEPARATOR","\\",184],["T_STRING","ProductAlert",184],["T_NS_SEPARATOR","\\",184],["T_STRING","Model",184],["T_NS_SEPARATOR","\\",184],["T_STRING","Email",184],["T_WHITESPACE"," ",184],["T_VARIABLE","$email",184],")",["T_WHITESPACE","\n    ",184],"{",["T_WHITESPACE","\n        ",185],["T_VARIABLE","$email",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","setType",186],"(",["T_CONSTANT_ENCAPSED_STRING","'price'",186],")",";",["T_WHITESPACE","\n        ",186],["T_FOREACH","foreach",187],["T_WHITESPACE"," ",187],"(",["T_VARIABLE","$this",187],["T_OBJECT_OPERATOR","->",187],["T_STRING","_getWebsites",187],"(",")",["T_WHITESPACE"," ",187],["T_AS","as",187],["T_WHITESPACE"," ",187],["T_VARIABLE","$website",187],")",["T_WHITESPACE"," ",187],"{",["T_WHITESPACE","\n            ",187],["T_COMMENT","\/* @var $website \\Magento\\Store\\Model\\Website *\/",188],["T_WHITESPACE","\n            ",188],["T_IF","if",189],["T_WHITESPACE"," ",189],"(","!",["T_VARIABLE","$website",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getDefaultGroup",189],"(",")",["T_WHITESPACE"," ",189],["T_BOOLEAN_OR","||",189],["T_WHITESPACE"," ",189],"!",["T_VARIABLE","$website",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","getDefaultGroup",189],"(",")",["T_OBJECT_OPERATOR","->",189],["T_STRING","getDefaultStore",189],"(",")",")",["T_WHITESPACE"," ",189],"{",["T_WHITESPACE","\n                ",189],["T_CONTINUE","continue",190],";",["T_WHITESPACE","\n            ",190],"}",["T_WHITESPACE","\n            ",191],["T_IF","if",192],["T_WHITESPACE"," ",192],"(","!",["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","_scopeConfig",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","getValue",192],"(",["T_WHITESPACE","\n                ",192],["T_STRING","self",193],["T_DOUBLE_COLON","::",193],["T_STRING","XML_PATH_PRICE_ALLOW",193],",",["T_WHITESPACE","\n                ",193],["T_NS_SEPARATOR","\\",194],["T_STRING","Magento",194],["T_NS_SEPARATOR","\\",194],["T_STRING","Store",194],["T_NS_SEPARATOR","\\",194],["T_STRING","Model",194],["T_NS_SEPARATOR","\\",194],["T_STRING","ScopeInterface",194],["T_DOUBLE_COLON","::",194],["T_STRING","SCOPE_STORE",194],",",["T_WHITESPACE","\n                ",194],["T_VARIABLE","$website",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","getDefaultGroup",195],"(",")",["T_OBJECT_OPERATOR","->",195],["T_STRING","getDefaultStore",195],"(",")",["T_OBJECT_OPERATOR","->",195],["T_STRING","getId",195],"(",")",["T_WHITESPACE","\n            ",195],")",["T_WHITESPACE","\n            ",196],")",["T_WHITESPACE"," ",197],"{",["T_WHITESPACE","\n                ",197],["T_CONTINUE","continue",198],";",["T_WHITESPACE","\n            ",198],"}",["T_WHITESPACE","\n            ",199],["T_TRY","try",200],["T_WHITESPACE"," ",200],"{",["T_WHITESPACE","\n                ",200],["T_VARIABLE","$collection",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_VARIABLE","$this",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","_priceColFactory",201],["T_OBJECT_OPERATOR","->",201],["T_STRING","create",201],"(",")",["T_OBJECT_OPERATOR","->",201],["T_STRING","addWebsiteFilter",201],"(",["T_WHITESPACE","\n                    ",201],["T_VARIABLE","$website",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","getId",202],"(",")",["T_WHITESPACE","\n                ",202],")",["T_OBJECT_OPERATOR","->",203],["T_STRING","setCustomerOrder",203],"(",")",";",["T_WHITESPACE","\n            ",203],"}",["T_WHITESPACE"," ",204],["T_CATCH","catch",204],["T_WHITESPACE"," ",204],"(",["T_NS_SEPARATOR","\\",204],["T_STRING","Exception",204],["T_WHITESPACE"," ",204],["T_VARIABLE","$e",204],")",["T_WHITESPACE"," ",204],"{",["T_WHITESPACE","\n                ",204],["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","_errors",205],"[","]",["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],["T_VARIABLE","$e",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","getMessage",205],"(",")",";",["T_WHITESPACE","\n                ",205],["T_THROW","throw",206],["T_WHITESPACE"," ",206],["T_VARIABLE","$e",206],";",["T_WHITESPACE","\n            ",206],"}",["T_WHITESPACE","\n\n            ",207],["T_VARIABLE","$previousCustomer",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_STRING","null",209],";",["T_WHITESPACE","\n            ",209],["T_VARIABLE","$email",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","setWebsite",210],"(",["T_VARIABLE","$website",210],")",";",["T_WHITESPACE","\n            ",210],["T_FOREACH","foreach",211],["T_WHITESPACE"," ",211],"(",["T_VARIABLE","$collection",211],["T_WHITESPACE"," ",211],["T_AS","as",211],["T_WHITESPACE"," ",211],["T_VARIABLE","$alert",211],")",["T_WHITESPACE"," ",211],"{",["T_WHITESPACE","\n                ",211],["T_TRY","try",212],["T_WHITESPACE"," ",212],"{",["T_WHITESPACE","\n                    ",212],["T_IF","if",213],["T_WHITESPACE"," ",213],"(","!",["T_VARIABLE","$previousCustomer",213],["T_WHITESPACE"," ",213],["T_BOOLEAN_OR","||",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$previousCustomer",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","getId",213],"(",")",["T_WHITESPACE"," ",213],["T_IS_NOT_EQUAL","!=",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$alert",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","getCustomerId",213],"(",")",")",["T_WHITESPACE"," ",213],"{",["T_WHITESPACE","\n                        ",213],["T_VARIABLE","$customer",214],["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],["T_VARIABLE","$this",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","customerRepository",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","getById",214],"(",["T_VARIABLE","$alert",214],["T_OBJECT_OPERATOR","->",214],["T_STRING","getCustomerId",214],"(",")",")",";",["T_WHITESPACE","\n                        ",214],["T_IF","if",215],["T_WHITESPACE"," ",215],"(",["T_VARIABLE","$previousCustomer",215],")",["T_WHITESPACE"," ",215],"{",["T_WHITESPACE","\n                            ",215],["T_VARIABLE","$email",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","send",216],"(",")",";",["T_WHITESPACE","\n                        ",216],"}",["T_WHITESPACE","\n                        ",217],["T_IF","if",218],["T_WHITESPACE"," ",218],"(","!",["T_VARIABLE","$customer",218],")",["T_WHITESPACE"," ",218],"{",["T_WHITESPACE","\n                            ",218],["T_CONTINUE","continue",219],";",["T_WHITESPACE","\n                        ",219],"}",["T_WHITESPACE","\n                        ",220],["T_VARIABLE","$previousCustomer",221],["T_WHITESPACE"," ",221],"=",["T_WHITESPACE"," ",221],["T_VARIABLE","$customer",221],";",["T_WHITESPACE","\n                        ",221],["T_VARIABLE","$email",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","clean",222],"(",")",";",["T_WHITESPACE","\n                        ",222],["T_VARIABLE","$email",223],["T_OBJECT_OPERATOR","->",223],["T_STRING","setCustomerData",223],"(",["T_VARIABLE","$customer",223],")",";",["T_WHITESPACE","\n                    ",223],"}",["T_WHITESPACE"," ",224],["T_ELSE","else",224],["T_WHITESPACE"," ",224],"{",["T_WHITESPACE","\n                        ",224],["T_VARIABLE","$customer",225],["T_WHITESPACE"," ",225],"=",["T_WHITESPACE"," ",225],["T_VARIABLE","$previousCustomer",225],";",["T_WHITESPACE","\n                    ",225],"}",["T_WHITESPACE","\n\n                    ",226],["T_VARIABLE","$product",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","productRepository",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getById",228],"(",["T_WHITESPACE","\n                        ",228],["T_VARIABLE","$alert",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","getProductId",229],"(",")",",",["T_WHITESPACE","\n                        ",229],["T_STRING","false",230],",",["T_WHITESPACE","\n                        ",230],["T_VARIABLE","$website",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","getDefaultStore",231],"(",")",["T_OBJECT_OPERATOR","->",231],["T_STRING","getId",231],"(",")",["T_WHITESPACE","\n                    ",231],")",";",["T_WHITESPACE","\n\n                    ",232],["T_VARIABLE","$product",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","setCustomerGroupId",234],"(",["T_VARIABLE","$customer",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","getGroupId",234],"(",")",")",";",["T_WHITESPACE","\n                    ",234],["T_IF","if",235],["T_WHITESPACE"," ",235],"(",["T_VARIABLE","$alert",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","getPrice",235],"(",")",["T_WHITESPACE"," ",235],">",["T_WHITESPACE"," ",235],["T_VARIABLE","$product",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","getFinalPrice",235],"(",")",")",["T_WHITESPACE"," ",235],"{",["T_WHITESPACE","\n                        ",235],["T_VARIABLE","$productPrice",236],["T_WHITESPACE"," ",236],"=",["T_WHITESPACE"," ",236],["T_VARIABLE","$product",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","getFinalPrice",236],"(",")",";",["T_WHITESPACE","\n                        ",236],["T_VARIABLE","$product",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","setFinalPrice",237],"(",["T_VARIABLE","$this",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","_catalogData",237],["T_OBJECT_OPERATOR","->",237],["T_STRING","getTaxPrice",237],"(",["T_VARIABLE","$product",237],",",["T_WHITESPACE"," ",237],["T_VARIABLE","$productPrice",237],")",")",";",["T_WHITESPACE","\n                        ",237],["T_VARIABLE","$product",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","setPrice",238],"(",["T_VARIABLE","$this",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","_catalogData",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","getTaxPrice",238],"(",["T_VARIABLE","$product",238],",",["T_WHITESPACE"," ",238],["T_VARIABLE","$product",238],["T_OBJECT_OPERATOR","->",238],["T_STRING","getPrice",238],"(",")",")",")",";",["T_WHITESPACE","\n                        ",238],["T_VARIABLE","$email",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","addPriceProduct",239],"(",["T_VARIABLE","$product",239],")",";",["T_WHITESPACE","\n\n                        ",239],["T_VARIABLE","$alert",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","setPrice",241],"(",["T_VARIABLE","$productPrice",241],")",";",["T_WHITESPACE","\n                        ",241],["T_VARIABLE","$alert",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","setLastSendDate",242],"(",["T_VARIABLE","$this",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","_dateFactory",242],["T_OBJECT_OPERATOR","->",242],["T_STRING","create",242],"(",")",["T_OBJECT_OPERATOR","->",242],["T_STRING","gmtDate",242],"(",")",")",";",["T_WHITESPACE","\n                        ",242],["T_VARIABLE","$alert",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","setSendCount",243],"(",["T_VARIABLE","$alert",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","getSendCount",243],"(",")",["T_WHITESPACE"," ",243],"+",["T_WHITESPACE"," ",243],["T_LNUMBER","1",243],")",";",["T_WHITESPACE","\n                        ",243],["T_VARIABLE","$alert",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","setStatus",244],"(",["T_LNUMBER","1",244],")",";",["T_WHITESPACE","\n                        ",244],["T_VARIABLE","$alert",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","save",245],"(",")",";",["T_WHITESPACE","\n                    ",245],"}",["T_WHITESPACE","\n                ",246],"}",["T_WHITESPACE"," ",247],["T_CATCH","catch",247],["T_WHITESPACE"," ",247],"(",["T_NS_SEPARATOR","\\",247],["T_STRING","Exception",247],["T_WHITESPACE"," ",247],["T_VARIABLE","$e",247],")",["T_WHITESPACE"," ",247],"{",["T_WHITESPACE","\n                    ",247],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","_errors",248],"[","]",["T_WHITESPACE"," ",248],"=",["T_WHITESPACE"," ",248],["T_VARIABLE","$e",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","getMessage",248],"(",")",";",["T_WHITESPACE","\n                    ",248],["T_THROW","throw",249],["T_WHITESPACE"," ",249],["T_VARIABLE","$e",249],";",["T_WHITESPACE","\n                ",249],"}",["T_WHITESPACE","\n            ",250],"}",["T_WHITESPACE","\n            ",251],["T_IF","if",252],["T_WHITESPACE"," ",252],"(",["T_VARIABLE","$previousCustomer",252],")",["T_WHITESPACE"," ",252],"{",["T_WHITESPACE","\n                ",252],["T_TRY","try",253],["T_WHITESPACE"," ",253],"{",["T_WHITESPACE","\n                    ",253],["T_VARIABLE","$email",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","send",254],"(",")",";",["T_WHITESPACE","\n                ",254],"}",["T_WHITESPACE"," ",255],["T_CATCH","catch",255],["T_WHITESPACE"," ",255],"(",["T_NS_SEPARATOR","\\",255],["T_STRING","Exception",255],["T_WHITESPACE"," ",255],["T_VARIABLE","$e",255],")",["T_WHITESPACE"," ",255],"{",["T_WHITESPACE","\n                    ",255],["T_VARIABLE","$this",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","_errors",256],"[","]",["T_WHITESPACE"," ",256],"=",["T_WHITESPACE"," ",256],["T_VARIABLE","$e",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","getMessage",256],"(",")",";",["T_WHITESPACE","\n                    ",256],["T_THROW","throw",257],["T_WHITESPACE"," ",257],["T_VARIABLE","$e",257],";",["T_WHITESPACE","\n                ",257],"}",["T_WHITESPACE","\n            ",258],"}",["T_WHITESPACE","\n        ",259],"}",["T_WHITESPACE","\n        ",260],["T_RETURN","return",261],["T_WHITESPACE"," ",261],["T_VARIABLE","$this",261],";",["T_WHITESPACE","\n    ",261],"}",["T_WHITESPACE","\n\n    ",262],["T_DOC_COMMENT","\/**\n     * Process stock emails\n     *\n     * @param \\Magento\\ProductAlert\\Model\\Email $email\n     * @return $this\n     * @throws \\Exception\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     * @SuppressWarnings(PHPMD.NPathComplexity)\n     *\/",264],["T_WHITESPACE","\n    ",272],["T_PROTECTED","protected",273],["T_WHITESPACE"," ",273],["T_FUNCTION","function",273],["T_WHITESPACE"," ",273],["T_STRING","_processStock",273],"(",["T_NS_SEPARATOR","\\",273],["T_STRING","Magento",273],["T_NS_SEPARATOR","\\",273],["T_STRING","ProductAlert",273],["T_NS_SEPARATOR","\\",273],["T_STRING","Model",273],["T_NS_SEPARATOR","\\",273],["T_STRING","Email",273],["T_WHITESPACE"," ",273],["T_VARIABLE","$email",273],")",["T_WHITESPACE","\n    ",273],"{",["T_WHITESPACE","\n        ",274],["T_VARIABLE","$email",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","setType",275],"(",["T_CONSTANT_ENCAPSED_STRING","'stock'",275],")",";",["T_WHITESPACE","\n\n        ",275],["T_FOREACH","foreach",277],["T_WHITESPACE"," ",277],"(",["T_VARIABLE","$this",277],["T_OBJECT_OPERATOR","->",277],["T_STRING","_getWebsites",277],"(",")",["T_WHITESPACE"," ",277],["T_AS","as",277],["T_WHITESPACE"," ",277],["T_VARIABLE","$website",277],")",["T_WHITESPACE"," ",277],"{",["T_WHITESPACE","\n            ",277],["T_COMMENT","\/* @var $website \\Magento\\Store\\Model\\Website *\/",278],["T_WHITESPACE","\n\n            ",278],["T_IF","if",280],["T_WHITESPACE"," ",280],"(","!",["T_VARIABLE","$website",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","getDefaultGroup",280],"(",")",["T_WHITESPACE"," ",280],["T_BOOLEAN_OR","||",280],["T_WHITESPACE"," ",280],"!",["T_VARIABLE","$website",280],["T_OBJECT_OPERATOR","->",280],["T_STRING","getDefaultGroup",280],"(",")",["T_OBJECT_OPERATOR","->",280],["T_STRING","getDefaultStore",280],"(",")",")",["T_WHITESPACE"," ",280],"{",["T_WHITESPACE","\n                ",280],["T_CONTINUE","continue",281],";",["T_WHITESPACE","\n            ",281],"}",["T_WHITESPACE","\n            ",282],["T_IF","if",283],["T_WHITESPACE"," ",283],"(","!",["T_VARIABLE","$this",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","_scopeConfig",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","getValue",283],"(",["T_WHITESPACE","\n                ",283],["T_STRING","self",284],["T_DOUBLE_COLON","::",284],["T_STRING","XML_PATH_STOCK_ALLOW",284],",",["T_WHITESPACE","\n                ",284],["T_NS_SEPARATOR","\\",285],["T_STRING","Magento",285],["T_NS_SEPARATOR","\\",285],["T_STRING","Store",285],["T_NS_SEPARATOR","\\",285],["T_STRING","Model",285],["T_NS_SEPARATOR","\\",285],["T_STRING","ScopeInterface",285],["T_DOUBLE_COLON","::",285],["T_STRING","SCOPE_STORE",285],",",["T_WHITESPACE","\n                ",285],["T_VARIABLE","$website",286],["T_OBJECT_OPERATOR","->",286],["T_STRING","getDefaultGroup",286],"(",")",["T_OBJECT_OPERATOR","->",286],["T_STRING","getDefaultStore",286],"(",")",["T_OBJECT_OPERATOR","->",286],["T_STRING","getId",286],"(",")",["T_WHITESPACE","\n            ",286],")",["T_WHITESPACE","\n            ",287],")",["T_WHITESPACE"," ",288],"{",["T_WHITESPACE","\n                ",288],["T_CONTINUE","continue",289],";",["T_WHITESPACE","\n            ",289],"}",["T_WHITESPACE","\n            ",290],["T_TRY","try",291],["T_WHITESPACE"," ",291],"{",["T_WHITESPACE","\n                ",291],["T_VARIABLE","$collection",292],["T_WHITESPACE"," ",292],"=",["T_WHITESPACE"," ",292],["T_VARIABLE","$this",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","_stockColFactory",292],["T_OBJECT_OPERATOR","->",292],["T_STRING","create",292],"(",")",["T_OBJECT_OPERATOR","->",292],["T_STRING","addWebsiteFilter",292],"(",["T_WHITESPACE","\n                    ",292],["T_VARIABLE","$website",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","getId",293],"(",")",["T_WHITESPACE","\n                ",293],")",["T_OBJECT_OPERATOR","->",294],["T_STRING","addStatusFilter",294],"(",["T_WHITESPACE","\n                    ",294],["T_LNUMBER","0",295],["T_WHITESPACE","\n                ",295],")",["T_OBJECT_OPERATOR","->",296],["T_STRING","setCustomerOrder",296],"(",")",";",["T_WHITESPACE","\n            ",296],"}",["T_WHITESPACE"," ",297],["T_CATCH","catch",297],["T_WHITESPACE"," ",297],"(",["T_NS_SEPARATOR","\\",297],["T_STRING","Exception",297],["T_WHITESPACE"," ",297],["T_VARIABLE","$e",297],")",["T_WHITESPACE"," ",297],"{",["T_WHITESPACE","\n                ",297],["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","_errors",298],"[","]",["T_WHITESPACE"," ",298],"=",["T_WHITESPACE"," ",298],["T_VARIABLE","$e",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","getMessage",298],"(",")",";",["T_WHITESPACE","\n                ",298],["T_THROW","throw",299],["T_WHITESPACE"," ",299],["T_VARIABLE","$e",299],";",["T_WHITESPACE","\n            ",299],"}",["T_WHITESPACE","\n\n            ",300],["T_VARIABLE","$previousCustomer",302],["T_WHITESPACE"," ",302],"=",["T_WHITESPACE"," ",302],["T_STRING","null",302],";",["T_WHITESPACE","\n            ",302],["T_VARIABLE","$email",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","setWebsite",303],"(",["T_VARIABLE","$website",303],")",";",["T_WHITESPACE","\n            ",303],["T_FOREACH","foreach",304],["T_WHITESPACE"," ",304],"(",["T_VARIABLE","$collection",304],["T_WHITESPACE"," ",304],["T_AS","as",304],["T_WHITESPACE"," ",304],["T_VARIABLE","$alert",304],")",["T_WHITESPACE"," ",304],"{",["T_WHITESPACE","\n                ",304],["T_TRY","try",305],["T_WHITESPACE"," ",305],"{",["T_WHITESPACE","\n                    ",305],["T_IF","if",306],["T_WHITESPACE"," ",306],"(","!",["T_VARIABLE","$previousCustomer",306],["T_WHITESPACE"," ",306],["T_BOOLEAN_OR","||",306],["T_WHITESPACE"," ",306],["T_VARIABLE","$previousCustomer",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","getId",306],"(",")",["T_WHITESPACE"," ",306],["T_IS_NOT_EQUAL","!=",306],["T_WHITESPACE"," ",306],["T_VARIABLE","$alert",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","getCustomerId",306],"(",")",")",["T_WHITESPACE"," ",306],"{",["T_WHITESPACE","\n                        ",306],["T_VARIABLE","$customer",307],["T_WHITESPACE"," ",307],"=",["T_WHITESPACE"," ",307],["T_VARIABLE","$this",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","customerRepository",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","getById",307],"(",["T_VARIABLE","$alert",307],["T_OBJECT_OPERATOR","->",307],["T_STRING","getCustomerId",307],"(",")",")",";",["T_WHITESPACE","\n                        ",307],["T_IF","if",308],["T_WHITESPACE"," ",308],"(",["T_VARIABLE","$previousCustomer",308],")",["T_WHITESPACE"," ",308],"{",["T_WHITESPACE","\n                            ",308],["T_VARIABLE","$email",309],["T_OBJECT_OPERATOR","->",309],["T_STRING","send",309],"(",")",";",["T_WHITESPACE","\n                        ",309],"}",["T_WHITESPACE","\n                        ",310],["T_IF","if",311],["T_WHITESPACE"," ",311],"(","!",["T_VARIABLE","$customer",311],")",["T_WHITESPACE"," ",311],"{",["T_WHITESPACE","\n                            ",311],["T_CONTINUE","continue",312],";",["T_WHITESPACE","\n                        ",312],"}",["T_WHITESPACE","\n                        ",313],["T_VARIABLE","$previousCustomer",314],["T_WHITESPACE"," ",314],"=",["T_WHITESPACE"," ",314],["T_VARIABLE","$customer",314],";",["T_WHITESPACE","\n                        ",314],["T_VARIABLE","$email",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","clean",315],"(",")",";",["T_WHITESPACE","\n                        ",315],["T_VARIABLE","$email",316],["T_OBJECT_OPERATOR","->",316],["T_STRING","setCustomerData",316],"(",["T_VARIABLE","$customer",316],")",";",["T_WHITESPACE","\n                    ",316],"}",["T_WHITESPACE"," ",317],["T_ELSE","else",317],["T_WHITESPACE"," ",317],"{",["T_WHITESPACE","\n                        ",317],["T_VARIABLE","$customer",318],["T_WHITESPACE"," ",318],"=",["T_WHITESPACE"," ",318],["T_VARIABLE","$previousCustomer",318],";",["T_WHITESPACE","\n                    ",318],"}",["T_WHITESPACE","\n\n                    ",319],["T_VARIABLE","$product",321],["T_WHITESPACE"," ",321],"=",["T_WHITESPACE"," ",321],["T_VARIABLE","$this",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","productRepository",321],["T_OBJECT_OPERATOR","->",321],["T_STRING","getById",321],"(",["T_WHITESPACE","\n                        ",321],["T_VARIABLE","$alert",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","getProductId",322],"(",")",",",["T_WHITESPACE","\n                        ",322],["T_STRING","false",323],",",["T_WHITESPACE","\n                        ",323],["T_VARIABLE","$website",324],["T_OBJECT_OPERATOR","->",324],["T_STRING","getDefaultStore",324],"(",")",["T_OBJECT_OPERATOR","->",324],["T_STRING","getId",324],"(",")",["T_WHITESPACE","\n                    ",324],")",";",["T_WHITESPACE","\n\n                    ",325],["T_VARIABLE","$product",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","setCustomerGroupId",327],"(",["T_VARIABLE","$customer",327],["T_OBJECT_OPERATOR","->",327],["T_STRING","getGroupId",327],"(",")",")",";",["T_WHITESPACE","\n\n                    ",327],["T_IF","if",329],["T_WHITESPACE"," ",329],"(",["T_VARIABLE","$product",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","isSalable",329],"(",")",")",["T_WHITESPACE"," ",329],"{",["T_WHITESPACE","\n                        ",329],["T_VARIABLE","$email",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","addStockProduct",330],"(",["T_VARIABLE","$product",330],")",";",["T_WHITESPACE","\n\n                        ",330],["T_VARIABLE","$alert",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","setSendDate",332],"(",["T_VARIABLE","$this",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","_dateFactory",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","create",332],"(",")",["T_OBJECT_OPERATOR","->",332],["T_STRING","gmtDate",332],"(",")",")",";",["T_WHITESPACE","\n                        ",332],["T_VARIABLE","$alert",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","setSendCount",333],"(",["T_VARIABLE","$alert",333],["T_OBJECT_OPERATOR","->",333],["T_STRING","getSendCount",333],"(",")",["T_WHITESPACE"," ",333],"+",["T_WHITESPACE"," ",333],["T_LNUMBER","1",333],")",";",["T_WHITESPACE","\n                        ",333],["T_VARIABLE","$alert",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","setStatus",334],"(",["T_LNUMBER","1",334],")",";",["T_WHITESPACE","\n                        ",334],["T_VARIABLE","$alert",335],["T_OBJECT_OPERATOR","->",335],["T_STRING","save",335],"(",")",";",["T_WHITESPACE","\n                    ",335],"}",["T_WHITESPACE","\n                ",336],"}",["T_WHITESPACE"," ",337],["T_CATCH","catch",337],["T_WHITESPACE"," ",337],"(",["T_NS_SEPARATOR","\\",337],["T_STRING","Exception",337],["T_WHITESPACE"," ",337],["T_VARIABLE","$e",337],")",["T_WHITESPACE"," ",337],"{",["T_WHITESPACE","\n                    ",337],["T_VARIABLE","$this",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","_errors",338],"[","]",["T_WHITESPACE"," ",338],"=",["T_WHITESPACE"," ",338],["T_VARIABLE","$e",338],["T_OBJECT_OPERATOR","->",338],["T_STRING","getMessage",338],"(",")",";",["T_WHITESPACE","\n                    ",338],["T_THROW","throw",339],["T_WHITESPACE"," ",339],["T_VARIABLE","$e",339],";",["T_WHITESPACE","\n                ",339],"}",["T_WHITESPACE","\n            ",340],"}",["T_WHITESPACE","\n\n            ",341],["T_IF","if",343],["T_WHITESPACE"," ",343],"(",["T_VARIABLE","$previousCustomer",343],")",["T_WHITESPACE"," ",343],"{",["T_WHITESPACE","\n                ",343],["T_TRY","try",344],["T_WHITESPACE"," ",344],"{",["T_WHITESPACE","\n                    ",344],["T_VARIABLE","$email",345],["T_OBJECT_OPERATOR","->",345],["T_STRING","send",345],"(",")",";",["T_WHITESPACE","\n                ",345],"}",["T_WHITESPACE"," ",346],["T_CATCH","catch",346],["T_WHITESPACE"," ",346],"(",["T_NS_SEPARATOR","\\",346],["T_STRING","Exception",346],["T_WHITESPACE"," ",346],["T_VARIABLE","$e",346],")",["T_WHITESPACE"," ",346],"{",["T_WHITESPACE","\n                    ",346],["T_VARIABLE","$this",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","_errors",347],"[","]",["T_WHITESPACE"," ",347],"=",["T_WHITESPACE"," ",347],["T_VARIABLE","$e",347],["T_OBJECT_OPERATOR","->",347],["T_STRING","getMessage",347],"(",")",";",["T_WHITESPACE","\n                    ",347],["T_THROW","throw",348],["T_WHITESPACE"," ",348],["T_VARIABLE","$e",348],";",["T_WHITESPACE","\n                ",348],"}",["T_WHITESPACE","\n            ",349],"}",["T_WHITESPACE","\n        ",350],"}",["T_WHITESPACE","\n\n        ",351],["T_RETURN","return",353],["T_WHITESPACE"," ",353],["T_VARIABLE","$this",353],";",["T_WHITESPACE","\n    ",353],"}",["T_WHITESPACE","\n\n    ",354],["T_DOC_COMMENT","\/**\n     * Send email to administrator if error\n     *\n     * @return $this\n     *\/",356],["T_WHITESPACE","\n    ",360],["T_PROTECTED","protected",361],["T_WHITESPACE"," ",361],["T_FUNCTION","function",361],["T_WHITESPACE"," ",361],["T_STRING","_sendErrorEmail",361],"(",")",["T_WHITESPACE","\n    ",361],"{",["T_WHITESPACE","\n        ",362],["T_IF","if",363],["T_WHITESPACE"," ",363],"(",["T_STRING","count",363],"(",["T_VARIABLE","$this",363],["T_OBJECT_OPERATOR","->",363],["T_STRING","_errors",363],")",")",["T_WHITESPACE"," ",363],"{",["T_WHITESPACE","\n            ",363],["T_IF","if",364],["T_WHITESPACE"," ",364],"(","!",["T_VARIABLE","$this",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","_scopeConfig",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","getValue",364],"(",["T_WHITESPACE","\n                ",364],["T_STRING","self",365],["T_DOUBLE_COLON","::",365],["T_STRING","XML_PATH_ERROR_TEMPLATE",365],",",["T_WHITESPACE","\n                ",365],["T_NS_SEPARATOR","\\",366],["T_STRING","Magento",366],["T_NS_SEPARATOR","\\",366],["T_STRING","Store",366],["T_NS_SEPARATOR","\\",366],["T_STRING","Model",366],["T_NS_SEPARATOR","\\",366],["T_STRING","ScopeInterface",366],["T_DOUBLE_COLON","::",366],["T_STRING","SCOPE_STORE",366],["T_WHITESPACE","\n            ",366],")",["T_WHITESPACE","\n            ",367],")",["T_WHITESPACE"," ",368],"{",["T_WHITESPACE","\n                ",368],["T_RETURN","return",369],["T_WHITESPACE"," ",369],["T_VARIABLE","$this",369],";",["T_WHITESPACE","\n            ",369],"}",["T_WHITESPACE","\n\n            ",370],["T_VARIABLE","$this",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","inlineTranslation",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","suspend",372],"(",")",";",["T_WHITESPACE","\n\n            ",372],["T_VARIABLE","$transport",374],["T_WHITESPACE"," ",374],"=",["T_WHITESPACE"," ",374],["T_VARIABLE","$this",374],["T_OBJECT_OPERATOR","->",374],["T_STRING","_transportBuilder",374],["T_OBJECT_OPERATOR","->",374],["T_STRING","setTemplateIdentifier",374],"(",["T_WHITESPACE","\n                ",374],["T_VARIABLE","$this",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","_scopeConfig",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","getValue",375],"(",["T_WHITESPACE","\n                    ",375],["T_STRING","self",376],["T_DOUBLE_COLON","::",376],["T_STRING","XML_PATH_ERROR_TEMPLATE",376],",",["T_WHITESPACE","\n                    ",376],["T_NS_SEPARATOR","\\",377],["T_STRING","Magento",377],["T_NS_SEPARATOR","\\",377],["T_STRING","Store",377],["T_NS_SEPARATOR","\\",377],["T_STRING","Model",377],["T_NS_SEPARATOR","\\",377],["T_STRING","ScopeInterface",377],["T_DOUBLE_COLON","::",377],["T_STRING","SCOPE_STORE",377],["T_WHITESPACE","\n                ",377],")",["T_WHITESPACE","\n            ",378],")",["T_OBJECT_OPERATOR","->",379],["T_STRING","setTemplateOptions",379],"(",["T_WHITESPACE","\n                ",379],"[",["T_WHITESPACE","\n                    ",380],["T_CONSTANT_ENCAPSED_STRING","'area'",381],["T_WHITESPACE"," ",381],["T_DOUBLE_ARROW","=>",381],["T_WHITESPACE"," ",381],["T_NS_SEPARATOR","\\",381],["T_STRING","Magento",381],["T_NS_SEPARATOR","\\",381],["T_STRING","Backend",381],["T_NS_SEPARATOR","\\",381],["T_STRING","App",381],["T_NS_SEPARATOR","\\",381],["T_STRING","Area",381],["T_NS_SEPARATOR","\\",381],["T_STRING","FrontNameResolver",381],["T_DOUBLE_COLON","::",381],["T_STRING","AREA_CODE",381],",",["T_WHITESPACE","\n                    ",381],["T_CONSTANT_ENCAPSED_STRING","'store'",382],["T_WHITESPACE"," ",382],["T_DOUBLE_ARROW","=>",382],["T_WHITESPACE"," ",382],["T_NS_SEPARATOR","\\",382],["T_STRING","Magento",382],["T_NS_SEPARATOR","\\",382],["T_STRING","Store",382],["T_NS_SEPARATOR","\\",382],["T_STRING","Model",382],["T_NS_SEPARATOR","\\",382],["T_STRING","Store",382],["T_DOUBLE_COLON","::",382],["T_STRING","DEFAULT_STORE_ID",382],",",["T_WHITESPACE","\n                ",382],"]",["T_WHITESPACE","\n            ",383],")",["T_OBJECT_OPERATOR","->",384],["T_STRING","setTemplateVars",384],"(",["T_WHITESPACE","\n                ",384],"[",["T_CONSTANT_ENCAPSED_STRING","'warnings'",385],["T_WHITESPACE"," ",385],["T_DOUBLE_ARROW","=>",385],["T_WHITESPACE"," ",385],["T_STRING","join",385],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",385],",",["T_WHITESPACE"," ",385],["T_VARIABLE","$this",385],["T_OBJECT_OPERATOR","->",385],["T_STRING","_errors",385],")","]",["T_WHITESPACE","\n            ",385],")",["T_OBJECT_OPERATOR","->",386],["T_STRING","setFrom",386],"(",["T_WHITESPACE","\n                ",386],["T_VARIABLE","$this",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","_scopeConfig",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","getValue",387],"(",["T_WHITESPACE","\n                    ",387],["T_STRING","self",388],["T_DOUBLE_COLON","::",388],["T_STRING","XML_PATH_ERROR_IDENTITY",388],",",["T_WHITESPACE","\n                    ",388],["T_NS_SEPARATOR","\\",389],["T_STRING","Magento",389],["T_NS_SEPARATOR","\\",389],["T_STRING","Store",389],["T_NS_SEPARATOR","\\",389],["T_STRING","Model",389],["T_NS_SEPARATOR","\\",389],["T_STRING","ScopeInterface",389],["T_DOUBLE_COLON","::",389],["T_STRING","SCOPE_STORE",389],["T_WHITESPACE","\n                ",389],")",["T_WHITESPACE","\n            ",390],")",["T_OBJECT_OPERATOR","->",391],["T_STRING","addTo",391],"(",["T_WHITESPACE","\n                ",391],["T_VARIABLE","$this",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","_scopeConfig",392],["T_OBJECT_OPERATOR","->",392],["T_STRING","getValue",392],"(",["T_WHITESPACE","\n                    ",392],["T_STRING","self",393],["T_DOUBLE_COLON","::",393],["T_STRING","XML_PATH_ERROR_RECIPIENT",393],",",["T_WHITESPACE","\n                    ",393],["T_NS_SEPARATOR","\\",394],["T_STRING","Magento",394],["T_NS_SEPARATOR","\\",394],["T_STRING","Store",394],["T_NS_SEPARATOR","\\",394],["T_STRING","Model",394],["T_NS_SEPARATOR","\\",394],["T_STRING","ScopeInterface",394],["T_DOUBLE_COLON","::",394],["T_STRING","SCOPE_STORE",394],["T_WHITESPACE","\n                ",394],")",["T_WHITESPACE","\n            ",395],")",["T_OBJECT_OPERATOR","->",396],["T_STRING","getTransport",396],"(",")",";",["T_WHITESPACE","\n\n            ",396],["T_VARIABLE","$transport",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","sendMessage",398],"(",")",";",["T_WHITESPACE","\n\n            ",398],["T_VARIABLE","$this",400],["T_OBJECT_OPERATOR","->",400],["T_STRING","inlineTranslation",400],["T_OBJECT_OPERATOR","->",400],["T_STRING","resume",400],"(",")",";",["T_WHITESPACE","\n            ",400],["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","_errors",401],"[","]",["T_WHITESPACE"," ",401],"=",["T_WHITESPACE"," ",401],"[","]",";",["T_WHITESPACE","\n        ",401],"}",["T_WHITESPACE","\n        ",402],["T_RETURN","return",403],["T_WHITESPACE"," ",403],["T_VARIABLE","$this",403],";",["T_WHITESPACE","\n    ",403],"}",["T_WHITESPACE","\n\n    ",404],["T_DOC_COMMENT","\/**\n     * Run process send product alerts\n     *\n     * @return $this\n     *\/",406],["T_WHITESPACE","\n    ",410],["T_PUBLIC","public",411],["T_WHITESPACE"," ",411],["T_FUNCTION","function",411],["T_WHITESPACE"," ",411],["T_STRING","process",411],"(",")",["T_WHITESPACE","\n    ",411],"{",["T_WHITESPACE","\n        ",412],["T_COMMENT","\/* @var $email \\Magento\\ProductAlert\\Model\\Email *\/",413],["T_WHITESPACE","\n        ",413],["T_VARIABLE","$email",414],["T_WHITESPACE"," ",414],"=",["T_WHITESPACE"," ",414],["T_VARIABLE","$this",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","_emailFactory",414],["T_OBJECT_OPERATOR","->",414],["T_STRING","create",414],"(",")",";",["T_WHITESPACE","\n        ",414],["T_VARIABLE","$this",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","_processPrice",415],"(",["T_VARIABLE","$email",415],")",";",["T_WHITESPACE","\n        ",415],["T_VARIABLE","$this",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","_processStock",416],"(",["T_VARIABLE","$email",416],")",";",["T_WHITESPACE","\n        ",416],["T_VARIABLE","$this",417],["T_OBJECT_OPERATOR","->",417],["T_STRING","_sendErrorEmail",417],"(",")",";",["T_WHITESPACE","\n\n        ",417],["T_RETURN","return",419],["T_WHITESPACE"," ",419],["T_VARIABLE","$this",419],";",["T_WHITESPACE","\n    ",419],"}",["T_WHITESPACE","\n",420],"}",["T_WHITESPACE","\n",421]]