[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n",5],["T_NAMESPACE","namespace",6],["T_WHITESPACE"," ",6],["T_STRING","Magento",6],["T_NS_SEPARATOR","\\",6],["T_STRING","CatalogInventory",6],["T_NS_SEPARATOR","\\",6],["T_STRING","Setup",6],";",["T_WHITESPACE","\n\n",6],["T_USE","use",8],["T_WHITESPACE"," ",8],["T_STRING","Magento",8],["T_NS_SEPARATOR","\\",8],["T_STRING","CatalogInventory",8],["T_NS_SEPARATOR","\\",8],["T_STRING","Api",8],["T_NS_SEPARATOR","\\",8],["T_STRING","StockConfigurationInterface",8],";",["T_WHITESPACE","\n",8],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","DB",9],["T_NS_SEPARATOR","\\",9],["T_STRING","DataConverter",9],["T_NS_SEPARATOR","\\",9],["T_STRING","SerializedToJson",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Framework",10],["T_NS_SEPARATOR","\\",10],["T_STRING","DB",10],["T_NS_SEPARATOR","\\",10],["T_STRING","FieldDataConverterFactory",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Framework",11],["T_NS_SEPARATOR","\\",11],["T_STRING","DB",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Select",11],["T_NS_SEPARATOR","\\",11],["T_STRING","QueryModifierFactory",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Framework",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Indexer",12],["T_NS_SEPARATOR","\\",12],["T_STRING","AbstractProcessor",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Framework",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Setup",13],["T_NS_SEPARATOR","\\",13],["T_STRING","UpgradeDataInterface",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Framework",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Setup",14],["T_NS_SEPARATOR","\\",14],["T_STRING","ModuleContextInterface",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Magento",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Framework",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Setup",15],["T_NS_SEPARATOR","\\",15],["T_STRING","ModuleDataSetupInterface",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Magento",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Store",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Model",16],["T_NS_SEPARATOR","\\",16],["T_STRING","StoreManagerInterface",16],";",["T_WHITESPACE","\n\n",16],["T_DOC_COMMENT","\/**\n * Upgrade Data script\n * @codeCoverageIgnore\n *\/",18],["T_WHITESPACE","\n",21],["T_CLASS","class",22],["T_WHITESPACE"," ",22],["T_STRING","UpgradeData",22],["T_WHITESPACE"," ",22],["T_IMPLEMENTS","implements",22],["T_WHITESPACE"," ",22],["T_STRING","UpgradeDataInterface",22],["T_WHITESPACE","\n",22],"{",["T_WHITESPACE","\n    ",23],["T_DOC_COMMENT","\/**\n     * @var StockConfigurationInterface\n     *\/",24],["T_WHITESPACE","\n    ",26],["T_PRIVATE","private",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$configuration",27],";",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * @var AbstractProcessor\n     *\/",29],["T_WHITESPACE","\n    ",31],["T_PRIVATE","private",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$indexerProcessor",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * @var StoreManagerInterface\n     *\/",34],["T_WHITESPACE","\n    ",36],["T_PRIVATE","private",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$storeManager",37],";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * @var FieldDataConverterFactory\n     *\/",39],["T_WHITESPACE","\n    ",41],["T_PRIVATE","private",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$fieldDataConverterFactory",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * @var QueryModifierFactory\n     *\/",44],["T_WHITESPACE","\n    ",46],["T_PRIVATE","private",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$queryModifierFactory",47],";",["T_WHITESPACE","\n\n    ",47],["T_DOC_COMMENT","\/**\n     * @param StockConfigurationInterface $configuration\n     * @param StoreManagerInterface $storeManager\n     * @param AbstractProcessor $indexerProcessor\n     * @param FieldDataConverterFactory $fieldDataConverterFactory\n     * @param QueryModifierFactory $queryModifierFactory\n     *\/",49],["T_WHITESPACE","\n    ",55],["T_PUBLIC","public",56],["T_WHITESPACE"," ",56],["T_FUNCTION","function",56],["T_WHITESPACE"," ",56],["T_STRING","__construct",56],"(",["T_WHITESPACE","\n        ",56],["T_STRING","StockConfigurationInterface",57],["T_WHITESPACE"," ",57],["T_VARIABLE","$configuration",57],",",["T_WHITESPACE","\n        ",57],["T_STRING","StoreManagerInterface",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$storeManager",58],",",["T_WHITESPACE","\n        ",58],["T_STRING","AbstractProcessor",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$indexerProcessor",59],",",["T_WHITESPACE","\n        ",59],["T_STRING","FieldDataConverterFactory",60],["T_WHITESPACE"," ",60],["T_VARIABLE","$fieldDataConverterFactory",60],",",["T_WHITESPACE","\n        ",60],["T_STRING","QueryModifierFactory",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$queryModifierFactory",61],["T_WHITESPACE","\n    ",61],")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n        ",62],["T_VARIABLE","$this",63],["T_OBJECT_OPERATOR","->",63],["T_STRING","configuration",63],["T_WHITESPACE"," ",63],"=",["T_WHITESPACE"," ",63],["T_VARIABLE","$configuration",63],";",["T_WHITESPACE","\n        ",63],["T_VARIABLE","$this",64],["T_OBJECT_OPERATOR","->",64],["T_STRING","storeManager",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_VARIABLE","$storeManager",64],";",["T_WHITESPACE","\n        ",64],["T_VARIABLE","$this",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","indexerProcessor",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_VARIABLE","$indexerProcessor",65],";",["T_WHITESPACE","\n        ",65],["T_VARIABLE","$this",66],["T_OBJECT_OPERATOR","->",66],["T_STRING","fieldDataConverterFactory",66],["T_WHITESPACE"," ",66],"=",["T_WHITESPACE"," ",66],["T_VARIABLE","$fieldDataConverterFactory",66],";",["T_WHITESPACE","\n        ",66],["T_VARIABLE","$this",67],["T_OBJECT_OPERATOR","->",67],["T_STRING","queryModifierFactory",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_VARIABLE","$queryModifierFactory",67],";",["T_WHITESPACE","\n    ",67],"}",["T_WHITESPACE","\n\n    ",68],["T_DOC_COMMENT","\/**\n     * {@inheritdoc}\n     *\/",70],["T_WHITESPACE","\n    ",72],["T_PUBLIC","public",73],["T_WHITESPACE"," ",73],["T_FUNCTION","function",73],["T_WHITESPACE"," ",73],["T_STRING","upgrade",73],"(",["T_STRING","ModuleDataSetupInterface",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$setup",73],",",["T_WHITESPACE"," ",73],["T_STRING","ModuleContextInterface",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$context",73],")",["T_WHITESPACE","\n    ",73],"{",["T_WHITESPACE","\n        ",74],["T_VARIABLE","$setup",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","startSetup",75],"(",")",";",["T_WHITESPACE","\n        ",75],["T_IF","if",76],["T_WHITESPACE"," ",76],"(",["T_STRING","version_compare",76],"(",["T_VARIABLE","$context",76],["T_OBJECT_OPERATOR","->",76],["T_STRING","getVersion",76],"(",")",",",["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'2.2.0'",76],")",["T_WHITESPACE"," ",76],"<",["T_WHITESPACE"," ",76],["T_LNUMBER","0",76],")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n            ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","upgradeCatalogInventoryStockItem",77],"(",["T_VARIABLE","$setup",77],")",";",["T_WHITESPACE","\n        ",77],"}",["T_WHITESPACE","\n\n        ",78],["T_IF","if",80],["T_WHITESPACE"," ",80],"(",["T_STRING","version_compare",80],"(",["T_VARIABLE","$context",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","getVersion",80],"(",")",",",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'2.2.1'",80],",",["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'<'",80],")",")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n            ",80],["T_VARIABLE","$this",81],["T_OBJECT_OPERATOR","->",81],["T_STRING","convertSerializedDataToJson",81],"(",["T_VARIABLE","$setup",81],")",";",["T_WHITESPACE","\n        ",81],"}",["T_WHITESPACE","\n        ",82],["T_VARIABLE","$setup",83],["T_OBJECT_OPERATOR","->",83],["T_STRING","endSetup",83],"(",")",";",["T_WHITESPACE","\n    ",83],"}",["T_WHITESPACE","\n\n    ",84],["T_DOC_COMMENT","\/**\n     * @param ModuleDataSetupInterface $setup\n     * @return void\n     *\/",86],["T_WHITESPACE","\n    ",89],["T_PRIVATE","private",90],["T_WHITESPACE"," ",90],["T_FUNCTION","function",90],["T_WHITESPACE"," ",90],["T_STRING","upgradeCatalogInventoryStockItem",90],"(",["T_VARIABLE","$setup",90],")",["T_WHITESPACE","\n    ",90],"{",["T_WHITESPACE","\n        ",91],["T_VARIABLE","$setup",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","getConnection",92],"(",")",["T_OBJECT_OPERATOR","->",92],["T_STRING","update",92],"(",["T_WHITESPACE","\n            ",92],["T_VARIABLE","$setup",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getTable",93],"(",["T_CONSTANT_ENCAPSED_STRING","'cataloginventory_stock_item'",93],")",",",["T_WHITESPACE","\n            ",93],"[",["T_CONSTANT_ENCAPSED_STRING","'website_id'",94],["T_WHITESPACE"," ",94],["T_DOUBLE_ARROW","=>",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","configuration",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getDefaultScopeId",94],"(",")","]",",",["T_WHITESPACE","\n            ",94],"[",["T_CONSTANT_ENCAPSED_STRING","'website_id = ?'",95],["T_WHITESPACE"," ",95],["T_DOUBLE_ARROW","=>",95],["T_WHITESPACE"," ",95],["T_VARIABLE","$this",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","storeManager",95],["T_OBJECT_OPERATOR","->",95],["T_STRING","getWebsite",95],"(",")",["T_OBJECT_OPERATOR","->",95],["T_STRING","getId",95],"(",")","]",["T_WHITESPACE","\n        ",95],")",";",["T_WHITESPACE","\n        ",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","indexerProcessor",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","getIndexer",97],"(",")",["T_OBJECT_OPERATOR","->",97],["T_STRING","invalidate",97],"(",")",";",["T_WHITESPACE","\n    ",97],"}",["T_WHITESPACE","\n\n    ",98],["T_DOC_COMMENT","\/**\n     * Upgrade data to version 2.2.1, converts row data in the core_config_data table that uses the\n     * path cataloginventory\/item_options\/min_sale_qty from serialized to JSON. Stored value may not be\n     * serialized, so validate data format before executing update.\n     *\n     * @param ModuleDataSetupInterface $setup\n     * @return void\n     *\/",100],["T_WHITESPACE","\n    ",107],["T_PRIVATE","private",108],["T_WHITESPACE"," ",108],["T_FUNCTION","function",108],["T_WHITESPACE"," ",108],["T_STRING","convertSerializedDataToJson",108],"(",["T_STRING","ModuleDataSetupInterface",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$setup",108],")",["T_WHITESPACE","\n    ",108],"{",["T_WHITESPACE","\n        ",109],["T_VARIABLE","$select",110],["T_WHITESPACE"," ",110],"=",["T_WHITESPACE"," ",110],["T_VARIABLE","$setup",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","getConnection",110],"(",")",["T_WHITESPACE","\n            ",110],["T_OBJECT_OPERATOR","->",111],["T_STRING","select",111],"(",")",["T_WHITESPACE","\n            ",111],["T_OBJECT_OPERATOR","->",112],["T_STRING","from",112],"(",["T_WHITESPACE","\n                ",112],["T_VARIABLE","$setup",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","getTable",113],"(",["T_CONSTANT_ENCAPSED_STRING","'core_config_data'",113],")",",",["T_WHITESPACE","\n                ",113],"[",["T_CONSTANT_ENCAPSED_STRING","'config_id'",114],",",["T_WHITESPACE"," ",114],["T_CONSTANT_ENCAPSED_STRING","'value'",114],"]",["T_WHITESPACE","\n            ",114],")",["T_WHITESPACE","\n            ",115],["T_OBJECT_OPERATOR","->",116],["T_STRING","where",116],"(",["T_CONSTANT_ENCAPSED_STRING","'path = ?'",116],",",["T_WHITESPACE"," ",116],["T_CONSTANT_ENCAPSED_STRING","'cataloginventory\/item_options\/min_sale_qty'",116],")",";",["T_WHITESPACE","\n\n        ",116],["T_VARIABLE","$rows",118],["T_WHITESPACE"," ",118],"=",["T_WHITESPACE"," ",118],["T_VARIABLE","$setup",118],["T_OBJECT_OPERATOR","->",118],["T_STRING","getConnection",118],"(",")",["T_OBJECT_OPERATOR","->",118],["T_STRING","fetchAssoc",118],"(",["T_VARIABLE","$select",118],")",";",["T_WHITESPACE","\n        ",118],["T_VARIABLE","$serializedRows",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_STRING","array_filter",119],"(",["T_VARIABLE","$rows",119],",",["T_WHITESPACE"," ",119],["T_FUNCTION","function",119],["T_WHITESPACE"," ",119],"(",["T_VARIABLE","$row",119],")",["T_WHITESPACE"," ",119],"{",["T_WHITESPACE","\n            ",119],["T_RETURN","return",120],["T_WHITESPACE"," ",120],["T_VARIABLE","$this",120],["T_OBJECT_OPERATOR","->",120],["T_STRING","isSerialized",120],"(",["T_VARIABLE","$row",120],"[",["T_CONSTANT_ENCAPSED_STRING","'value'",120],"]",")",";",["T_WHITESPACE","\n        ",120],"}",")",";",["T_WHITESPACE","\n\n        ",121],["T_VARIABLE","$fieldDataConverter",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","fieldDataConverterFactory",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","create",123],"(",["T_STRING","SerializedToJson",123],["T_DOUBLE_COLON","::",123],["T_CLASS","class",123],")",";",["T_WHITESPACE","\n        ",123],["T_VARIABLE","$queryModifier",124],["T_WHITESPACE"," ",124],"=",["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","queryModifierFactory",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","create",124],"(",["T_WHITESPACE","\n            ",124],["T_CONSTANT_ENCAPSED_STRING","'in'",125],",",["T_WHITESPACE","\n            ",125],"[",["T_WHITESPACE","\n                ",126],["T_CONSTANT_ENCAPSED_STRING","'values'",127],["T_WHITESPACE"," ",127],["T_DOUBLE_ARROW","=>",127],["T_WHITESPACE"," ",127],"[",["T_WHITESPACE","\n                    ",127],["T_CONSTANT_ENCAPSED_STRING","'config_id'",128],["T_WHITESPACE"," ",128],["T_DOUBLE_ARROW","=>",128],["T_WHITESPACE"," ",128],["T_STRING","array_keys",128],"(",["T_VARIABLE","$serializedRows",128],")",["T_WHITESPACE","\n                ",128],"]",["T_WHITESPACE","\n            ",129],"]",["T_WHITESPACE","\n        ",130],")",";",["T_WHITESPACE","\n\n        ",131],["T_VARIABLE","$fieldDataConverter",133],["T_OBJECT_OPERATOR","->",133],["T_STRING","convert",133],"(",["T_WHITESPACE","\n            ",133],["T_VARIABLE","$setup",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","getConnection",134],"(",")",",",["T_WHITESPACE","\n            ",134],["T_VARIABLE","$setup",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","getTable",135],"(",["T_CONSTANT_ENCAPSED_STRING","'core_config_data'",135],")",",",["T_WHITESPACE","\n            ",135],["T_CONSTANT_ENCAPSED_STRING","'config_id'",136],",",["T_WHITESPACE","\n            ",136],["T_CONSTANT_ENCAPSED_STRING","'value'",137],",",["T_WHITESPACE","\n            ",137],["T_VARIABLE","$queryModifier",138],["T_WHITESPACE","\n        ",138],")",";",["T_WHITESPACE","\n    ",139],"}",["T_WHITESPACE","\n\n    ",140],["T_DOC_COMMENT","\/**\n     * Check if value is a serialized string\n     *\n     * @param string $value\n     * @return boolean\n     *\/",142],["T_WHITESPACE","\n    ",147],["T_PRIVATE","private",148],["T_WHITESPACE"," ",148],["T_FUNCTION","function",148],["T_WHITESPACE"," ",148],["T_STRING","isSerialized",148],"(",["T_VARIABLE","$value",148],")",["T_WHITESPACE","\n    ",148],"{",["T_WHITESPACE","\n        ",149],["T_RETURN","return",150],["T_WHITESPACE"," ",150],["T_BOOL_CAST","(boolean)",150],["T_WHITESPACE"," ",150],["T_STRING","preg_match",150],"(",["T_CONSTANT_ENCAPSED_STRING","'\/^((s|i|d|b|a|O|C):|N;)\/'",150],",",["T_WHITESPACE"," ",150],["T_VARIABLE","$value",150],")",";",["T_WHITESPACE","\n    ",150],"}",["T_WHITESPACE","\n",151],"}",["T_WHITESPACE","\n",152]]