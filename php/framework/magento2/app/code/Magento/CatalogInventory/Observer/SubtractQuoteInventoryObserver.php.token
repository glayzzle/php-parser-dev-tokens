[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_NAMESPACE","namespace",7],["T_WHITESPACE"," ",7],["T_STRING","Magento",7],["T_NS_SEPARATOR","\\",7],["T_STRING","CatalogInventory",7],["T_NS_SEPARATOR","\\",7],["T_STRING","Observer",7],";",["T_WHITESPACE","\n\n",7],["T_USE","use",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Framework",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Event",9],["T_NS_SEPARATOR","\\",9],["T_STRING","ObserverInterface",9],";",["T_WHITESPACE","\n",9],["T_USE","use",10],["T_WHITESPACE"," ",10],["T_STRING","Magento",10],["T_NS_SEPARATOR","\\",10],["T_STRING","CatalogInventory",10],["T_NS_SEPARATOR","\\",10],["T_STRING","Api",10],["T_NS_SEPARATOR","\\",10],["T_STRING","StockManagementInterface",10],";",["T_WHITESPACE","\n",10],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Framework",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Event",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Observer",11],["T_WHITESPACE"," ",11],["T_AS","as",11],["T_WHITESPACE"," ",11],["T_STRING","EventObserver",11],";",["T_WHITESPACE","\n\n",11],["T_DOC_COMMENT","\/**\n * Catalog inventory module observer\n *\/",13],["T_WHITESPACE","\n",15],["T_CLASS","class",16],["T_WHITESPACE"," ",16],["T_STRING","SubtractQuoteInventoryObserver",16],["T_WHITESPACE"," ",16],["T_IMPLEMENTS","implements",16],["T_WHITESPACE"," ",16],["T_STRING","ObserverInterface",16],["T_WHITESPACE","\n",16],"{",["T_WHITESPACE","\n    ",17],["T_DOC_COMMENT","\/**\n     * @var StockManagementInterface\n     *\/",18],["T_WHITESPACE","\n    ",20],["T_PROTECTED","protected",21],["T_WHITESPACE"," ",21],["T_VARIABLE","$stockManagement",21],";",["T_WHITESPACE","\n\n    ",21],["T_DOC_COMMENT","\/**\n     * @var ProductQty\n     *\/",23],["T_WHITESPACE","\n    ",25],["T_PROTECTED","protected",26],["T_WHITESPACE"," ",26],["T_VARIABLE","$productQty",26],";",["T_WHITESPACE","\n\n    ",26],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\CatalogInventory\\Observer\\ItemsForReindex\n     *\/",28],["T_WHITESPACE","\n    ",30],["T_PROTECTED","protected",31],["T_WHITESPACE"," ",31],["T_VARIABLE","$itemsForReindex",31],";",["T_WHITESPACE","\n\n    ",31],["T_DOC_COMMENT","\/**\n     * SubtractQuoteInventoryObserver constructor.\n     * @param StockManagementInterface $stockManagement\n     * @param ProductQty $productQty\n     * @param ItemsForReindex $itemsForReindex\n     *\/",33],["T_WHITESPACE","\n    ",38],["T_PUBLIC","public",39],["T_WHITESPACE"," ",39],["T_FUNCTION","function",39],["T_WHITESPACE"," ",39],["T_STRING","__construct",39],"(",["T_WHITESPACE","\n        ",39],["T_STRING","StockManagementInterface",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$stockManagement",40],",",["T_WHITESPACE","\n        ",40],["T_STRING","ProductQty",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$productQty",41],",",["T_WHITESPACE","\n        ",41],["T_STRING","ItemsForReindex",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$itemsForReindex",42],["T_WHITESPACE","\n    ",42],")",["T_WHITESPACE"," ",43],"{",["T_WHITESPACE","\n        ",43],["T_VARIABLE","$this",44],["T_OBJECT_OPERATOR","->",44],["T_STRING","stockManagement",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_VARIABLE","$stockManagement",44],";",["T_WHITESPACE","\n        ",44],["T_VARIABLE","$this",45],["T_OBJECT_OPERATOR","->",45],["T_STRING","productQty",45],["T_WHITESPACE"," ",45],"=",["T_WHITESPACE"," ",45],["T_VARIABLE","$productQty",45],";",["T_WHITESPACE","\n        ",45],["T_VARIABLE","$this",46],["T_OBJECT_OPERATOR","->",46],["T_STRING","itemsForReindex",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_VARIABLE","$itemsForReindex",46],";",["T_WHITESPACE","\n    ",46],"}",["T_WHITESPACE","\n\n    ",47],["T_DOC_COMMENT","\/**\n     * Subtract quote items qtys from stock items related with quote items products.\n     *\n     * Used before order placing to make order save\/place transaction smaller\n     * Also called after every successful order placement to ensure subtraction of inventory\n     *\n     * @param EventObserver $observer\n     * @return $this\n     *\/",49],["T_WHITESPACE","\n    ",57],["T_PUBLIC","public",58],["T_WHITESPACE"," ",58],["T_FUNCTION","function",58],["T_WHITESPACE"," ",58],["T_STRING","execute",58],"(",["T_STRING","EventObserver",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$observer",58],")",["T_WHITESPACE","\n    ",58],"{",["T_WHITESPACE","\n        ",59],["T_DOC_COMMENT","\/** @var \\Magento\\Quote\\Model\\Quote $quote *\/",60],["T_WHITESPACE","\n        ",60],["T_VARIABLE","$quote",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_VARIABLE","$observer",61],["T_OBJECT_OPERATOR","->",61],["T_STRING","getEvent",61],"(",")",["T_OBJECT_OPERATOR","->",61],["T_STRING","getQuote",61],"(",")",";",["T_WHITESPACE","\n\n        ",61],["T_COMMENT","\/\/ Maybe we've already processed this quote in some event during order placement\n",63],["T_WHITESPACE","        ",64],["T_COMMENT","\/\/ e.g. call in event 'sales_model_service_quote_submit_before' and later in 'checkout_submit_all_after'\n",64],["T_WHITESPACE","        ",65],["T_IF","if",65],["T_WHITESPACE"," ",65],"(",["T_VARIABLE","$quote",65],["T_OBJECT_OPERATOR","->",65],["T_STRING","getInventoryProcessed",65],"(",")",")",["T_WHITESPACE"," ",65],"{",["T_WHITESPACE","\n            ",65],["T_RETURN","return",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$this",66],";",["T_WHITESPACE","\n        ",66],"}",["T_WHITESPACE","\n        ",67],["T_VARIABLE","$items",68],["T_WHITESPACE"," ",68],"=",["T_WHITESPACE"," ",68],["T_VARIABLE","$this",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","productQty",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","getProductQty",68],"(",["T_VARIABLE","$quote",68],["T_OBJECT_OPERATOR","->",68],["T_STRING","getAllItems",68],"(",")",")",";",["T_WHITESPACE","\n\n        ",68],["T_DOC_COMMENT","\/**\n         * Remember items\n         *\/",70],["T_WHITESPACE","\n        ",72],["T_VARIABLE","$itemsForReindex",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","stockManagement",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","registerProductsSale",73],"(",["T_WHITESPACE","\n            ",73],["T_VARIABLE","$items",74],",",["T_WHITESPACE","\n            ",74],["T_VARIABLE","$quote",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","getStore",75],"(",")",["T_OBJECT_OPERATOR","->",75],["T_STRING","getWebsiteId",75],"(",")",["T_WHITESPACE","\n        ",75],")",";",["T_WHITESPACE","\n        ",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","itemsForReindex",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","setItems",77],"(",["T_VARIABLE","$itemsForReindex",77],")",";",["T_WHITESPACE","\n\n        ",77],["T_VARIABLE","$quote",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","setInventoryProcessed",79],"(",["T_STRING","true",79],")",";",["T_WHITESPACE","\n        ",79],["T_RETURN","return",80],["T_WHITESPACE"," ",80],["T_VARIABLE","$this",80],";",["T_WHITESPACE","\n    ",80],"}",["T_WHITESPACE","\n",81],"}",["T_WHITESPACE","\n",82]]