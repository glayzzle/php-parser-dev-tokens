[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * @category    Magento\n * @package     Magento_CatalogInventory\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",7],["T_NAMESPACE","namespace",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","CatalogInventory",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Model",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Indexer",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Stock",9],";",["T_WHITESPACE","\n\n",9],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Framework",11],["T_NS_SEPARATOR","\\",11],["T_STRING","App",11],["T_NS_SEPARATOR","\\",11],["T_STRING","ObjectManager",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Framework",12],["T_NS_SEPARATOR","\\",12],["T_STRING","App",12],["T_NS_SEPARATOR","\\",12],["T_STRING","ResourceConnection",12],";",["T_WHITESPACE","\n\n",12],["T_DOC_COMMENT","\/**\n * Abstract action reindex class\n *\n * @package Magento\\CatalogInventory\\Model\\Indexer\\Stock\n *\/",14],["T_WHITESPACE","\n",18],["T_ABSTRACT","abstract",19],["T_WHITESPACE"," ",19],["T_CLASS","class",19],["T_WHITESPACE"," ",19],["T_STRING","AbstractAction",19],["T_WHITESPACE","\n",19],"{",["T_WHITESPACE","\n    ",20],["T_DOC_COMMENT","\/**\n     * Resource instance\n     *\n     * @var Resource\n     *\/",21],["T_WHITESPACE","\n    ",25],["T_PROTECTED","protected",26],["T_WHITESPACE"," ",26],["T_VARIABLE","$_resource",26],";",["T_WHITESPACE","\n\n    ",26],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\CatalogInventory\\Model\\ResourceModel\\Indexer\\StockFactory\n     *\/",28],["T_WHITESPACE","\n    ",30],["T_PROTECTED","protected",31],["T_WHITESPACE"," ",31],["T_VARIABLE","$_indexerFactory",31],";",["T_WHITESPACE","\n\n    ",31],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Catalog\\Model\\Product\\Type\n     *\/",33],["T_WHITESPACE","\n    ",35],["T_PROTECTED","protected",36],["T_WHITESPACE"," ",36],["T_VARIABLE","$_catalogProductType",36],";",["T_WHITESPACE","\n\n    ",36],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\DB\\Adapter\\AdapterInterface\n     *\/",38],["T_WHITESPACE","\n    ",40],["T_PROTECTED","protected",41],["T_WHITESPACE"," ",41],["T_VARIABLE","$_connection",41],";",["T_WHITESPACE","\n\n    ",41],["T_DOC_COMMENT","\/**\n     * Stock Indexer models per product type\n     * Sorted by priority\n     *\n     * @var array\n     *\/",43],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$_indexers",49],["T_WHITESPACE"," ",49],"=",["T_WHITESPACE"," ",49],"[","]",";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Flag that defines if need to use \"_idx\" index table suffix instead of \"_tmp\"\n     *\n     * @var bool\n     *\/",51],["T_WHITESPACE","\n    ",55],["T_PROTECTED","protected",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$_isNeedUseIdxTable",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],["T_STRING","false",56],";",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Indexer\\CacheContext\n     *\/",58],["T_WHITESPACE","\n    ",60],["T_PRIVATE","private",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$cacheContext",61],";",["T_WHITESPACE","\n\n    ",61],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\Framework\\Event\\ManagerInterface\n     *\/",63],["T_WHITESPACE","\n    ",65],["T_PRIVATE","private",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$eventManager",66],";",["T_WHITESPACE","\n\n    ",66],["T_DOC_COMMENT","\/**\n     * @var CacheCleaner\n     *\/",68],["T_WHITESPACE","\n    ",70],["T_PRIVATE","private",71],["T_WHITESPACE"," ",71],["T_VARIABLE","$cacheCleaner",71],";",["T_WHITESPACE","\n\n    ",71],["T_DOC_COMMENT","\/**\n     * @param ResourceConnection $resource\n     * @param \\Magento\\CatalogInventory\\Model\\ResourceModel\\Indexer\\StockFactory $indexerFactory\n     * @param \\Magento\\Catalog\\Model\\Product\\Type $catalogProductType\n     * @param \\Magento\\Framework\\Indexer\\CacheContext $cacheContext\n     * @param \\Magento\\Framework\\Event\\ManagerInterface $eventManager\n     *\/",73],["T_WHITESPACE","\n    ",79],["T_PUBLIC","public",80],["T_WHITESPACE"," ",80],["T_FUNCTION","function",80],["T_WHITESPACE"," ",80],["T_STRING","__construct",80],"(",["T_WHITESPACE","\n        ",80],["T_STRING","ResourceConnection",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$resource",81],",",["T_WHITESPACE","\n        ",81],["T_NS_SEPARATOR","\\",82],["T_STRING","Magento",82],["T_NS_SEPARATOR","\\",82],["T_STRING","CatalogInventory",82],["T_NS_SEPARATOR","\\",82],["T_STRING","Model",82],["T_NS_SEPARATOR","\\",82],["T_STRING","ResourceModel",82],["T_NS_SEPARATOR","\\",82],["T_STRING","Indexer",82],["T_NS_SEPARATOR","\\",82],["T_STRING","StockFactory",82],["T_WHITESPACE"," ",82],["T_VARIABLE","$indexerFactory",82],",",["T_WHITESPACE","\n        ",82],["T_NS_SEPARATOR","\\",83],["T_STRING","Magento",83],["T_NS_SEPARATOR","\\",83],["T_STRING","Catalog",83],["T_NS_SEPARATOR","\\",83],["T_STRING","Model",83],["T_NS_SEPARATOR","\\",83],["T_STRING","Product",83],["T_NS_SEPARATOR","\\",83],["T_STRING","Type",83],["T_WHITESPACE"," ",83],["T_VARIABLE","$catalogProductType",83],",",["T_WHITESPACE","\n        ",83],["T_NS_SEPARATOR","\\",84],["T_STRING","Magento",84],["T_NS_SEPARATOR","\\",84],["T_STRING","Framework",84],["T_NS_SEPARATOR","\\",84],["T_STRING","Indexer",84],["T_NS_SEPARATOR","\\",84],["T_STRING","CacheContext",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$cacheContext",84],",",["T_WHITESPACE","\n        ",84],["T_NS_SEPARATOR","\\",85],["T_STRING","Magento",85],["T_NS_SEPARATOR","\\",85],["T_STRING","Framework",85],["T_NS_SEPARATOR","\\",85],["T_STRING","Event",85],["T_NS_SEPARATOR","\\",85],["T_STRING","ManagerInterface",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$eventManager",85],["T_WHITESPACE","\n    ",85],")",["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n        ",86],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","_resource",87],["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_VARIABLE","$resource",87],";",["T_WHITESPACE","\n        ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","_indexerFactory",88],["T_WHITESPACE"," ",88],"=",["T_WHITESPACE"," ",88],["T_VARIABLE","$indexerFactory",88],";",["T_WHITESPACE","\n        ",88],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","_catalogProductType",89],["T_WHITESPACE"," ",89],"=",["T_WHITESPACE"," ",89],["T_VARIABLE","$catalogProductType",89],";",["T_WHITESPACE","\n        ",89],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","cacheContext",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$cacheContext",90],";",["T_WHITESPACE","\n        ",90],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","eventManager",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_VARIABLE","$eventManager",91],";",["T_WHITESPACE","\n    ",91],"}",["T_WHITESPACE","\n\n    ",92],["T_DOC_COMMENT","\/**\n     * Execute action for given ids\n     *\n     * @param array|int $ids\n     *\n     * @return void\n     *\/",94],["T_WHITESPACE","\n    ",100],["T_ABSTRACT","abstract",101],["T_WHITESPACE"," ",101],["T_PUBLIC","public",101],["T_WHITESPACE"," ",101],["T_FUNCTION","function",101],["T_WHITESPACE"," ",101],["T_STRING","execute",101],"(",["T_VARIABLE","$ids",101],")",";",["T_WHITESPACE","\n\n    ",101],["T_DOC_COMMENT","\/**\n     * Retrieve connection instance\n     *\n     * @return bool|\\Magento\\Framework\\DB\\Adapter\\AdapterInterface\n     *\/",103],["T_WHITESPACE","\n    ",107],["T_PROTECTED","protected",108],["T_WHITESPACE"," ",108],["T_FUNCTION","function",108],["T_WHITESPACE"," ",108],["T_STRING","_getConnection",108],"(",")",["T_WHITESPACE","\n    ",108],"{",["T_WHITESPACE","\n        ",109],["T_IF","if",110],["T_WHITESPACE"," ",110],"(",["T_STRING","null",110],["T_WHITESPACE"," ",110],["T_IS_IDENTICAL","===",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$this",110],["T_OBJECT_OPERATOR","->",110],["T_STRING","_connection",110],")",["T_WHITESPACE"," ",110],"{",["T_WHITESPACE","\n            ",110],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","_connection",111],["T_WHITESPACE"," ",111],"=",["T_WHITESPACE"," ",111],["T_VARIABLE","$this",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","_resource",111],["T_OBJECT_OPERATOR","->",111],["T_STRING","getConnection",111],"(",")",";",["T_WHITESPACE","\n        ",111],"}",["T_WHITESPACE","\n        ",112],["T_RETURN","return",113],["T_WHITESPACE"," ",113],["T_VARIABLE","$this",113],["T_OBJECT_OPERATOR","->",113],["T_STRING","_connection",113],";",["T_WHITESPACE","\n    ",113],"}",["T_WHITESPACE","\n\n    ",114],["T_DOC_COMMENT","\/**\n     * Retrieve Stock Indexer Models per Product Type\n     *\n     * @return \\Magento\\CatalogInventory\\Model\\ResourceModel\\Indexer\\Stock\\StockInterface[]\n     *\/",116],["T_WHITESPACE","\n    ",120],["T_PROTECTED","protected",121],["T_WHITESPACE"," ",121],["T_FUNCTION","function",121],["T_WHITESPACE"," ",121],["T_STRING","_getTypeIndexers",121],"(",")",["T_WHITESPACE","\n    ",121],"{",["T_WHITESPACE","\n        ",122],["T_IF","if",123],["T_WHITESPACE"," ",123],"(",["T_EMPTY","empty",123],"(",["T_VARIABLE","$this",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","_indexers",123],")",")",["T_WHITESPACE"," ",123],"{",["T_WHITESPACE","\n            ",123],["T_FOREACH","foreach",124],["T_WHITESPACE"," ",124],"(",["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","_catalogProductType",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","getTypesByPriority",124],"(",")",["T_WHITESPACE"," ",124],["T_AS","as",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$typeId",124],["T_WHITESPACE"," ",124],["T_DOUBLE_ARROW","=>",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$typeInfo",124],")",["T_WHITESPACE"," ",124],"{",["T_WHITESPACE","\n                ",124],["T_VARIABLE","$indexerClassName",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_ISSET","isset",125],"(",["T_VARIABLE","$typeInfo",125],"[",["T_CONSTANT_ENCAPSED_STRING","'stock_indexer'",125],"]",")",["T_WHITESPACE"," ",125],"?",["T_WHITESPACE"," ",125],["T_VARIABLE","$typeInfo",125],"[",["T_CONSTANT_ENCAPSED_STRING","'stock_indexer'",125],"]",["T_WHITESPACE"," ",125],":",["T_WHITESPACE"," ",125],["T_CONSTANT_ENCAPSED_STRING","''",125],";",["T_WHITESPACE","\n\n                ",125],["T_VARIABLE","$indexer",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","_indexerFactory",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","create",127],"(",["T_VARIABLE","$indexerClassName",127],")",["T_WHITESPACE","\n                    ",127],["T_OBJECT_OPERATOR","->",128],["T_STRING","setTypeId",128],"(",["T_VARIABLE","$typeId",128],")",["T_WHITESPACE","\n                    ",128],["T_OBJECT_OPERATOR","->",129],["T_STRING","setIsComposite",129],"(","!",["T_EMPTY","empty",129],"(",["T_VARIABLE","$typeInfo",129],"[",["T_CONSTANT_ENCAPSED_STRING","'composite'",129],"]",")",")",";",["T_WHITESPACE","\n\n                ",129],["T_VARIABLE","$this",131],["T_OBJECT_OPERATOR","->",131],["T_STRING","_indexers",131],"[",["T_VARIABLE","$typeId",131],"]",["T_WHITESPACE"," ",131],"=",["T_WHITESPACE"," ",131],["T_VARIABLE","$indexer",131],";",["T_WHITESPACE","\n            ",131],"}",["T_WHITESPACE","\n        ",132],"}",["T_WHITESPACE","\n        ",133],["T_RETURN","return",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$this",134],["T_OBJECT_OPERATOR","->",134],["T_STRING","_indexers",134],";",["T_WHITESPACE","\n    ",134],"}",["T_WHITESPACE","\n\n    ",135],["T_DOC_COMMENT","\/**\n     * Returns table name for given entity\n     *\n     * @param string $entityName\n     * @return string\n     *\/",137],["T_WHITESPACE","\n    ",142],["T_PROTECTED","protected",143],["T_WHITESPACE"," ",143],["T_FUNCTION","function",143],["T_WHITESPACE"," ",143],["T_STRING","_getTable",143],"(",["T_VARIABLE","$entityName",143],")",["T_WHITESPACE","\n    ",143],"{",["T_WHITESPACE","\n        ",144],["T_RETURN","return",145],["T_WHITESPACE"," ",145],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","_resource",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","getTableName",145],"(",["T_VARIABLE","$entityName",145],")",";",["T_WHITESPACE","\n    ",145],"}",["T_WHITESPACE","\n\n    ",146],["T_DOC_COMMENT","\/**\n     * Retrieve product relations by children\n     *\n     * @param int|array $childIds\n     * @return array\n     *\/",148],["T_WHITESPACE","\n    ",153],["T_PUBLIC","public",154],["T_WHITESPACE"," ",154],["T_FUNCTION","function",154],["T_WHITESPACE"," ",154],["T_STRING","getRelationsByChild",154],"(",["T_VARIABLE","$childIds",154],")",["T_WHITESPACE","\n    ",154],"{",["T_WHITESPACE","\n        ",155],["T_VARIABLE","$connection",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_VARIABLE","$this",156],["T_OBJECT_OPERATOR","->",156],["T_STRING","_getConnection",156],"(",")",";",["T_WHITESPACE","\n        ",156],["T_VARIABLE","$select",157],["T_WHITESPACE"," ",157],"=",["T_WHITESPACE"," ",157],["T_VARIABLE","$connection",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","select",157],"(",")",["T_WHITESPACE","\n            ",157],["T_OBJECT_OPERATOR","->",158],["T_STRING","from",158],"(",["T_VARIABLE","$this",158],["T_OBJECT_OPERATOR","->",158],["T_STRING","_getTable",158],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_relation'",158],")",",",["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","'parent_id'",158],")",["T_WHITESPACE","\n            ",158],["T_OBJECT_OPERATOR","->",159],["T_STRING","where",159],"(",["T_CONSTANT_ENCAPSED_STRING","'child_id IN(?)'",159],",",["T_WHITESPACE"," ",159],["T_VARIABLE","$childIds",159],")",";",["T_WHITESPACE","\n\n        ",159],["T_RETURN","return",161],["T_WHITESPACE"," ",161],["T_VARIABLE","$connection",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","fetchCol",161],"(",["T_VARIABLE","$select",161],")",";",["T_WHITESPACE","\n    ",161],"}",["T_WHITESPACE","\n\n    ",162],["T_DOC_COMMENT","\/**\n     * Reindex all\n     *\n     * @return void\n     *\/",164],["T_WHITESPACE","\n    ",168],["T_PUBLIC","public",169],["T_WHITESPACE"," ",169],["T_FUNCTION","function",169],["T_WHITESPACE"," ",169],["T_STRING","reindexAll",169],"(",")",["T_WHITESPACE","\n    ",169],"{",["T_WHITESPACE","\n        ",170],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","useIdxTable",171],"(",["T_STRING","true",171],")",";",["T_WHITESPACE","\n        ",171],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","clearTemporaryIndexTable",172],"(",")",";",["T_WHITESPACE","\n\n        ",172],["T_FOREACH","foreach",174],["T_WHITESPACE"," ",174],"(",["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","_getTypeIndexers",174],"(",")",["T_WHITESPACE"," ",174],["T_AS","as",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$indexer",174],")",["T_WHITESPACE"," ",174],"{",["T_WHITESPACE","\n            ",174],["T_VARIABLE","$indexer",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","reindexAll",175],"(",")",";",["T_WHITESPACE","\n        ",175],"}",["T_WHITESPACE","\n\n        ",176],["T_VARIABLE","$this",178],["T_OBJECT_OPERATOR","->",178],["T_STRING","_syncData",178],"(",")",";",["T_WHITESPACE","\n    ",178],"}",["T_WHITESPACE","\n\n    ",179],["T_DOC_COMMENT","\/**\n     * Synchronize data between index storage and original storage\n     *\n     * @return $this\n     *\/",181],["T_WHITESPACE","\n    ",185],["T_PROTECTED","protected",186],["T_WHITESPACE"," ",186],["T_FUNCTION","function",186],["T_WHITESPACE"," ",186],["T_STRING","_syncData",186],"(",")",["T_WHITESPACE","\n    ",186],"{",["T_WHITESPACE","\n        ",187],["T_VARIABLE","$idxTableName",188],["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","_getIdxTable",188],"(",")",";",["T_WHITESPACE","\n        ",188],["T_VARIABLE","$tableName",189],["T_WHITESPACE"," ",189],"=",["T_WHITESPACE"," ",189],["T_VARIABLE","$this",189],["T_OBJECT_OPERATOR","->",189],["T_STRING","_getTable",189],"(",["T_CONSTANT_ENCAPSED_STRING","'cataloginventory_stock_status'",189],")",";",["T_WHITESPACE","\n\n        ",189],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","_deleteOldRelations",191],"(",["T_VARIABLE","$tableName",191],")",";",["T_WHITESPACE","\n\n        ",191],["T_VARIABLE","$columns",193],["T_WHITESPACE"," ",193],"=",["T_WHITESPACE"," ",193],["T_STRING","array_keys",193],"(",["T_VARIABLE","$this",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","_connection",193],["T_OBJECT_OPERATOR","->",193],["T_STRING","describeTable",193],"(",["T_VARIABLE","$idxTableName",193],")",")",";",["T_WHITESPACE","\n        ",193],["T_VARIABLE","$select",194],["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],["T_VARIABLE","$this",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","_connection",194],["T_OBJECT_OPERATOR","->",194],["T_STRING","select",194],"(",")",["T_OBJECT_OPERATOR","->",194],["T_STRING","from",194],"(",["T_VARIABLE","$idxTableName",194],",",["T_WHITESPACE"," ",194],["T_VARIABLE","$columns",194],")",";",["T_WHITESPACE","\n        ",194],["T_VARIABLE","$query",195],["T_WHITESPACE"," ",195],"=",["T_WHITESPACE"," ",195],["T_VARIABLE","$select",195],["T_OBJECT_OPERATOR","->",195],["T_STRING","insertFromSelect",195],"(",["T_VARIABLE","$tableName",195],",",["T_WHITESPACE"," ",195],["T_VARIABLE","$columns",195],")",";",["T_WHITESPACE","\n        ",195],["T_VARIABLE","$this",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","_connection",196],["T_OBJECT_OPERATOR","->",196],["T_STRING","query",196],"(",["T_VARIABLE","$query",196],")",";",["T_WHITESPACE","\n        ",196],["T_RETURN","return",197],["T_WHITESPACE"," ",197],["T_VARIABLE","$this",197],";",["T_WHITESPACE","\n    ",197],"}",["T_WHITESPACE","\n\n    ",198],["T_DOC_COMMENT","\/**\n     * Delete old relations\n     *\n     * @param string $tableName\n     *\n     * @return void\n     *\/",200],["T_WHITESPACE","\n    ",206],["T_PROTECTED","protected",207],["T_WHITESPACE"," ",207],["T_FUNCTION","function",207],["T_WHITESPACE"," ",207],["T_STRING","_deleteOldRelations",207],"(",["T_VARIABLE","$tableName",207],")",["T_WHITESPACE","\n    ",207],"{",["T_WHITESPACE","\n        ",208],["T_VARIABLE","$select",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","_connection",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","select",209],"(",")",["T_WHITESPACE","\n            ",209],["T_OBJECT_OPERATOR","->",210],["T_STRING","from",210],"(","[",["T_CONSTANT_ENCAPSED_STRING","'s'",210],["T_WHITESPACE"," ",210],["T_DOUBLE_ARROW","=>",210],["T_WHITESPACE"," ",210],["T_VARIABLE","$tableName",210],"]",")",["T_WHITESPACE","\n            ",210],["T_OBJECT_OPERATOR","->",211],["T_STRING","joinLeft",211],"(",["T_WHITESPACE","\n                ",211],"[",["T_CONSTANT_ENCAPSED_STRING","'w'",212],["T_WHITESPACE"," ",212],["T_DOUBLE_ARROW","=>",212],["T_WHITESPACE"," ",212],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","_getTable",212],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_website'",212],")","]",",",["T_WHITESPACE","\n                ",212],["T_CONSTANT_ENCAPSED_STRING","'s.product_id = w.product_id AND s.website_id = w.website_id'",213],",",["T_WHITESPACE","\n                ",213],"[","]",["T_WHITESPACE","\n            ",214],")",["T_WHITESPACE","\n            ",215],["T_OBJECT_OPERATOR","->",216],["T_STRING","where",216],"(",["T_CONSTANT_ENCAPSED_STRING","'w.product_id IS NULL'",216],")",";",["T_WHITESPACE","\n\n        ",216],["T_VARIABLE","$sql",218],["T_WHITESPACE"," ",218],"=",["T_WHITESPACE"," ",218],["T_VARIABLE","$select",218],["T_OBJECT_OPERATOR","->",218],["T_STRING","deleteFromSelect",218],"(",["T_CONSTANT_ENCAPSED_STRING","'s'",218],")",";",["T_WHITESPACE","\n        ",218],["T_VARIABLE","$this",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","_connection",219],["T_OBJECT_OPERATOR","->",219],["T_STRING","query",219],"(",["T_VARIABLE","$sql",219],")",";",["T_WHITESPACE","\n    ",219],"}",["T_WHITESPACE","\n\n    ",220],["T_DOC_COMMENT","\/**\n     * Refresh entities index\n     *\n     * @param array $productIds\n     * @return $this\n     *\/",222],["T_WHITESPACE","\n    ",227],["T_PROTECTED","protected",228],["T_WHITESPACE"," ",228],["T_FUNCTION","function",228],["T_WHITESPACE"," ",228],["T_STRING","_reindexRows",228],"(",["T_VARIABLE","$productIds",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],"[","]",")",["T_WHITESPACE","\n    ",228],"{",["T_WHITESPACE","\n        ",229],["T_IF","if",230],["T_WHITESPACE"," ",230],"(","!",["T_STRING","is_array",230],"(",["T_VARIABLE","$productIds",230],")",")",["T_WHITESPACE"," ",230],"{",["T_WHITESPACE","\n            ",230],["T_VARIABLE","$productIds",231],["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],"[",["T_VARIABLE","$productIds",231],"]",";",["T_WHITESPACE","\n        ",231],"}",["T_WHITESPACE","\n\n        ",232],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","getCacheCleaner",234],"(",")",["T_OBJECT_OPERATOR","->",234],["T_STRING","clean",234],"(",["T_VARIABLE","$productIds",234],",",["T_WHITESPACE"," ",234],["T_FUNCTION","function",234],["T_WHITESPACE"," ",234],"(",")",["T_WHITESPACE"," ",234],["T_USE","use",234],["T_WHITESPACE"," ",234],"(",["T_VARIABLE","$productIds",234],")",["T_WHITESPACE"," ",234],"{",["T_WHITESPACE","\n            ",234],["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","doReindex",235],"(",["T_VARIABLE","$productIds",235],")",";",["T_WHITESPACE","\n        ",235],"}",")",";",["T_WHITESPACE","\n\n        ",236],["T_RETURN","return",238],["T_WHITESPACE"," ",238],["T_VARIABLE","$this",238],";",["T_WHITESPACE","\n    ",238],"}",["T_WHITESPACE","\n\n    ",239],["T_DOC_COMMENT","\/**\n     * Refresh entities index\n     *\n     * @param array $productIds\n     * @return void\n     *\/",241],["T_WHITESPACE","\n    ",246],["T_PRIVATE","private",247],["T_WHITESPACE"," ",247],["T_FUNCTION","function",247],["T_WHITESPACE"," ",247],["T_STRING","doReindex",247],"(",["T_VARIABLE","$productIds",247],["T_WHITESPACE"," ",247],"=",["T_WHITESPACE"," ",247],"[","]",")",["T_WHITESPACE","\n    ",247],"{",["T_WHITESPACE","\n        ",248],["T_VARIABLE","$connection",249],["T_WHITESPACE"," ",249],"=",["T_WHITESPACE"," ",249],["T_VARIABLE","$this",249],["T_OBJECT_OPERATOR","->",249],["T_STRING","_getConnection",249],"(",")",";",["T_WHITESPACE","\n\n        ",249],["T_VARIABLE","$parentIds",251],["T_WHITESPACE"," ",251],"=",["T_WHITESPACE"," ",251],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","getRelationsByChild",251],"(",["T_VARIABLE","$productIds",251],")",";",["T_WHITESPACE","\n        ",251],["T_VARIABLE","$processIds",252],["T_WHITESPACE"," ",252],"=",["T_WHITESPACE"," ",252],["T_VARIABLE","$parentIds",252],["T_WHITESPACE"," ",252],"?",["T_WHITESPACE"," ",252],["T_STRING","array_merge",252],"(",["T_VARIABLE","$parentIds",252],",",["T_WHITESPACE"," ",252],["T_VARIABLE","$productIds",252],")",["T_WHITESPACE"," ",252],":",["T_WHITESPACE"," ",252],["T_VARIABLE","$productIds",252],";",["T_WHITESPACE","\n\n        ",252],["T_COMMENT","\/\/ retrieve product types by processIds\n",254],["T_WHITESPACE","        ",255],["T_VARIABLE","$select",255],["T_WHITESPACE"," ",255],"=",["T_WHITESPACE"," ",255],["T_VARIABLE","$connection",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","select",255],"(",")",["T_WHITESPACE","\n            ",255],["T_OBJECT_OPERATOR","->",256],["T_STRING","from",256],"(",["T_VARIABLE","$this",256],["T_OBJECT_OPERATOR","->",256],["T_STRING","_getTable",256],"(",["T_CONSTANT_ENCAPSED_STRING","'catalog_product_entity'",256],")",",",["T_WHITESPACE"," ",256],"[",["T_CONSTANT_ENCAPSED_STRING","'entity_id'",256],",",["T_WHITESPACE"," ",256],["T_CONSTANT_ENCAPSED_STRING","'type_id'",256],"]",")",["T_WHITESPACE","\n            ",256],["T_OBJECT_OPERATOR","->",257],["T_STRING","where",257],"(",["T_CONSTANT_ENCAPSED_STRING","'entity_id IN(?)'",257],",",["T_WHITESPACE"," ",257],["T_VARIABLE","$processIds",257],")",";",["T_WHITESPACE","\n        ",257],["T_VARIABLE","$pairs",258],["T_WHITESPACE"," ",258],"=",["T_WHITESPACE"," ",258],["T_VARIABLE","$connection",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","fetchPairs",258],"(",["T_VARIABLE","$select",258],")",";",["T_WHITESPACE","\n\n        ",258],["T_VARIABLE","$byType",260],["T_WHITESPACE"," ",260],"=",["T_WHITESPACE"," ",260],"[","]",";",["T_WHITESPACE","\n        ",260],["T_FOREACH","foreach",261],["T_WHITESPACE"," ",261],"(",["T_VARIABLE","$pairs",261],["T_WHITESPACE"," ",261],["T_AS","as",261],["T_WHITESPACE"," ",261],["T_VARIABLE","$productId",261],["T_WHITESPACE"," ",261],["T_DOUBLE_ARROW","=>",261],["T_WHITESPACE"," ",261],["T_VARIABLE","$typeId",261],")",["T_WHITESPACE"," ",261],"{",["T_WHITESPACE","\n            ",261],["T_VARIABLE","$byType",262],"[",["T_VARIABLE","$typeId",262],"]","[",["T_VARIABLE","$productId",262],"]",["T_WHITESPACE"," ",262],"=",["T_WHITESPACE"," ",262],["T_VARIABLE","$productId",262],";",["T_WHITESPACE","\n        ",262],"}",["T_WHITESPACE","\n\n        ",263],["T_VARIABLE","$indexers",265],["T_WHITESPACE"," ",265],"=",["T_WHITESPACE"," ",265],["T_VARIABLE","$this",265],["T_OBJECT_OPERATOR","->",265],["T_STRING","_getTypeIndexers",265],"(",")",";",["T_WHITESPACE","\n        ",265],["T_FOREACH","foreach",266],["T_WHITESPACE"," ",266],"(",["T_VARIABLE","$indexers",266],["T_WHITESPACE"," ",266],["T_AS","as",266],["T_WHITESPACE"," ",266],["T_VARIABLE","$indexer",266],")",["T_WHITESPACE"," ",266],"{",["T_WHITESPACE","\n            ",266],["T_IF","if",267],["T_WHITESPACE"," ",267],"(",["T_ISSET","isset",267],"(",["T_VARIABLE","$byType",267],"[",["T_VARIABLE","$indexer",267],["T_OBJECT_OPERATOR","->",267],["T_STRING","getTypeId",267],"(",")","]",")",")",["T_WHITESPACE"," ",267],"{",["T_WHITESPACE","\n                ",267],["T_VARIABLE","$indexer",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","reindexEntity",268],"(",["T_VARIABLE","$byType",268],"[",["T_VARIABLE","$indexer",268],["T_OBJECT_OPERATOR","->",268],["T_STRING","getTypeId",268],"(",")","]",")",";",["T_WHITESPACE","\n            ",268],"}",["T_WHITESPACE","\n        ",269],"}",["T_WHITESPACE","\n    ",270],"}",["T_WHITESPACE","\n\n    ",271],["T_DOC_COMMENT","\/**\n     * @return CacheCleaner\n     *\/",273],["T_WHITESPACE","\n    ",275],["T_PRIVATE","private",276],["T_WHITESPACE"," ",276],["T_FUNCTION","function",276],["T_WHITESPACE"," ",276],["T_STRING","getCacheCleaner",276],"(",")",["T_WHITESPACE","\n    ",276],"{",["T_WHITESPACE","\n        ",277],["T_IF","if",278],["T_WHITESPACE"," ",278],"(",["T_STRING","null",278],["T_WHITESPACE"," ",278],["T_IS_IDENTICAL","===",278],["T_WHITESPACE"," ",278],["T_VARIABLE","$this",278],["T_OBJECT_OPERATOR","->",278],["T_STRING","cacheCleaner",278],")",["T_WHITESPACE"," ",278],"{",["T_WHITESPACE","\n            ",278],["T_VARIABLE","$this",279],["T_OBJECT_OPERATOR","->",279],["T_STRING","cacheCleaner",279],["T_WHITESPACE"," ",279],"=",["T_WHITESPACE"," ",279],["T_STRING","ObjectManager",279],["T_DOUBLE_COLON","::",279],["T_STRING","getInstance",279],"(",")",["T_OBJECT_OPERATOR","->",279],["T_STRING","get",279],"(",["T_STRING","CacheCleaner",279],["T_DOUBLE_COLON","::",279],["T_CLASS","class",279],")",";",["T_WHITESPACE","\n        ",279],"}",["T_WHITESPACE","\n        ",280],["T_RETURN","return",281],["T_WHITESPACE"," ",281],["T_VARIABLE","$this",281],["T_OBJECT_OPERATOR","->",281],["T_STRING","cacheCleaner",281],";",["T_WHITESPACE","\n    ",281],"}",["T_WHITESPACE","\n\n    ",282],["T_DOC_COMMENT","\/**\n     * Set or get what either \"_idx\" or \"_tmp\" suffixed temporary index table need to use\n     *\n     * @param bool|null $value\n     * @return bool\n     *\/",284],["T_WHITESPACE","\n    ",289],["T_PUBLIC","public",290],["T_WHITESPACE"," ",290],["T_FUNCTION","function",290],["T_WHITESPACE"," ",290],["T_STRING","useIdxTable",290],"(",["T_VARIABLE","$value",290],["T_WHITESPACE"," ",290],"=",["T_WHITESPACE"," ",290],["T_STRING","null",290],")",["T_WHITESPACE","\n    ",290],"{",["T_WHITESPACE","\n        ",291],["T_IF","if",292],["T_WHITESPACE"," ",292],"(",["T_VARIABLE","$value",292],["T_WHITESPACE"," ",292],["T_IS_NOT_IDENTICAL","!==",292],["T_WHITESPACE"," ",292],["T_STRING","null",292],")",["T_WHITESPACE"," ",292],"{",["T_WHITESPACE","\n            ",292],["T_VARIABLE","$this",293],["T_OBJECT_OPERATOR","->",293],["T_STRING","_isNeedUseIdxTable",293],["T_WHITESPACE"," ",293],"=",["T_WHITESPACE"," ",293],["T_BOOL_CAST","(bool)",293],["T_VARIABLE","$value",293],";",["T_WHITESPACE","\n        ",293],"}",["T_WHITESPACE","\n        ",294],["T_RETURN","return",295],["T_WHITESPACE"," ",295],["T_VARIABLE","$this",295],["T_OBJECT_OPERATOR","->",295],["T_STRING","_isNeedUseIdxTable",295],";",["T_WHITESPACE","\n    ",295],"}",["T_WHITESPACE","\n\n    ",296],["T_DOC_COMMENT","\/**\n     * Retrieve temporary index table name\n     *\n     * @return string\n     *\/",298],["T_WHITESPACE","\n    ",302],["T_PROTECTED","protected",303],["T_WHITESPACE"," ",303],["T_FUNCTION","function",303],["T_WHITESPACE"," ",303],["T_STRING","_getIdxTable",303],"(",")",["T_WHITESPACE","\n    ",303],"{",["T_WHITESPACE","\n        ",304],["T_IF","if",305],["T_WHITESPACE"," ",305],"(",["T_VARIABLE","$this",305],["T_OBJECT_OPERATOR","->",305],["T_STRING","useIdxTable",305],"(",")",")",["T_WHITESPACE"," ",305],"{",["T_WHITESPACE","\n            ",305],["T_RETURN","return",306],["T_WHITESPACE"," ",306],["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","_getTable",306],"(",["T_CONSTANT_ENCAPSED_STRING","'cataloginventory_stock_status_idx'",306],")",";",["T_WHITESPACE","\n        ",306],"}",["T_WHITESPACE","\n        ",307],["T_RETURN","return",308],["T_WHITESPACE"," ",308],["T_VARIABLE","$this",308],["T_OBJECT_OPERATOR","->",308],["T_STRING","_getTable",308],"(",["T_CONSTANT_ENCAPSED_STRING","'cataloginventory_stock_status_tmp'",308],")",";",["T_WHITESPACE","\n    ",308],"}",["T_WHITESPACE","\n\n    ",309],["T_DOC_COMMENT","\/**\n     * Clean up temporary index table\n     *\n     * @return void\n     *\/",311],["T_WHITESPACE","\n    ",315],["T_PUBLIC","public",316],["T_WHITESPACE"," ",316],["T_FUNCTION","function",316],["T_WHITESPACE"," ",316],["T_STRING","clearTemporaryIndexTable",316],"(",")",["T_WHITESPACE","\n    ",316],"{",["T_WHITESPACE","\n        ",317],["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","_getConnection",318],"(",")",["T_OBJECT_OPERATOR","->",318],["T_STRING","delete",318],"(",["T_VARIABLE","$this",318],["T_OBJECT_OPERATOR","->",318],["T_STRING","_getIdxTable",318],"(",")",")",";",["T_WHITESPACE","\n    ",318],"}",["T_WHITESPACE","\n",319],"}",["T_WHITESPACE","\n",320]]