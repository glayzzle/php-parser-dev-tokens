[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Copyright \u00c2\u00a9 2013-2017 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n *\/",2],["T_WHITESPACE","\n\n",5],["T_COMMENT","\/\/ @codingStandardsIgnoreFile\n",7],["T_WHITESPACE","\n",8],["T_NAMESPACE","namespace",9],["T_WHITESPACE"," ",9],["T_STRING","Magento",9],["T_NS_SEPARATOR","\\",9],["T_STRING","CatalogInventory",9],["T_NS_SEPARATOR","\\",9],["T_STRING","Model",9],";",["T_WHITESPACE","\n\n",9],["T_USE","use",11],["T_WHITESPACE"," ",11],["T_STRING","Magento",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Catalog",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Model",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Product",11],["T_NS_SEPARATOR","\\",11],["T_STRING","Type",11],["T_WHITESPACE"," ",11],["T_AS","as",11],["T_WHITESPACE"," ",11],["T_STRING","ProductType",11],";",["T_WHITESPACE","\n",11],["T_USE","use",12],["T_WHITESPACE"," ",12],["T_STRING","Magento",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Catalog",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Model",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Product",12],["T_NS_SEPARATOR","\\",12],["T_STRING","Website",12],["T_WHITESPACE"," ",12],["T_AS","as",12],["T_WHITESPACE"," ",12],["T_STRING","ProductWebsite",12],";",["T_WHITESPACE","\n",12],["T_USE","use",13],["T_WHITESPACE"," ",13],["T_STRING","Magento",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Catalog",13],["T_NS_SEPARATOR","\\",13],["T_STRING","Model",13],["T_NS_SEPARATOR","\\",13],["T_STRING","ProductFactory",13],";",["T_WHITESPACE","\n",13],["T_USE","use",14],["T_WHITESPACE"," ",14],["T_STRING","Magento",14],["T_NS_SEPARATOR","\\",14],["T_STRING","CatalogInventory",14],["T_NS_SEPARATOR","\\",14],["T_STRING","Api",14],["T_NS_SEPARATOR","\\",14],["T_STRING","StockIndexInterface",14],";",["T_WHITESPACE","\n",14],["T_USE","use",15],["T_WHITESPACE"," ",15],["T_STRING","Magento",15],["T_NS_SEPARATOR","\\",15],["T_STRING","CatalogInventory",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Model",15],["T_NS_SEPARATOR","\\",15],["T_STRING","Spi",15],["T_NS_SEPARATOR","\\",15],["T_STRING","StockRegistryProviderInterface",15],";",["T_WHITESPACE","\n",15],["T_USE","use",16],["T_WHITESPACE"," ",16],["T_STRING","Magento",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Catalog",16],["T_NS_SEPARATOR","\\",16],["T_STRING","Api",16],["T_NS_SEPARATOR","\\",16],["T_STRING","ProductRepositoryInterface",16],";",["T_WHITESPACE","\n\n",16],["T_DOC_COMMENT","\/**\n * Class StockIndex\n * @SuppressWarnings(PHPMD.CouplingBetweenObjects)\n *\/",18],["T_WHITESPACE","\n",21],["T_CLASS","class",22],["T_WHITESPACE"," ",22],["T_STRING","StockIndex",22],["T_WHITESPACE"," ",22],["T_IMPLEMENTS","implements",22],["T_WHITESPACE"," ",22],["T_STRING","StockIndexInterface",22],["T_WHITESPACE","\n",22],"{",["T_WHITESPACE","\n    ",23],["T_DOC_COMMENT","\/**\n     * @var StockRegistryProviderInterface\n     *\/",24],["T_WHITESPACE","\n    ",26],["T_PROTECTED","protected",27],["T_WHITESPACE"," ",27],["T_VARIABLE","$stockRegistryProvider",27],";",["T_WHITESPACE","\n\n    ",27],["T_DOC_COMMENT","\/**\n     * @var ProductRepositoryInterface\n     *\/",29],["T_WHITESPACE","\n    ",31],["T_PROTECTED","protected",32],["T_WHITESPACE"," ",32],["T_VARIABLE","$productRepository",32],";",["T_WHITESPACE","\n\n    ",32],["T_DOC_COMMENT","\/**\n     * @var \\Magento\\CatalogInventory\\Model\\ResourceModel\\Stock\\Status\n     *\/",34],["T_WHITESPACE","\n    ",36],["T_PROTECTED","protected",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$stockStatusResource",37],";",["T_WHITESPACE","\n\n    ",37],["T_DOC_COMMENT","\/**\n     * @var ProductType\n     *\/",39],["T_WHITESPACE","\n    ",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_VARIABLE","$productType",42],";",["T_WHITESPACE","\n\n    ",42],["T_DOC_COMMENT","\/**\n     * Retrieve website models\n     *\n     * @var array\n     *\/",44],["T_WHITESPACE","\n    ",48],["T_PROTECTED","protected",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$websites",49],";",["T_WHITESPACE","\n\n    ",49],["T_DOC_COMMENT","\/**\n     * Product Type Instances cache\n     *\n     * @var array\n     *\/",51],["T_WHITESPACE","\n    ",55],["T_PROTECTED","protected",56],["T_WHITESPACE"," ",56],["T_VARIABLE","$productTypes",56],["T_WHITESPACE"," ",56],"=",["T_WHITESPACE"," ",56],"[","]",";",["T_WHITESPACE","\n\n    ",56],["T_DOC_COMMENT","\/**\n     * @param StockRegistryProviderInterface $stockRegistryProvider\n     * @param ProductRepositoryInterface $productRepository\n     * @param ProductWebsite $productWebsite\n     * @param ProductType $productType\n     *\/",58],["T_WHITESPACE","\n    ",63],["T_PUBLIC","public",64],["T_WHITESPACE"," ",64],["T_FUNCTION","function",64],["T_WHITESPACE"," ",64],["T_STRING","__construct",64],"(",["T_WHITESPACE","\n        ",64],["T_STRING","StockRegistryProviderInterface",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$stockRegistryProvider",65],",",["T_WHITESPACE","\n        ",65],["T_STRING","ProductRepositoryInterface",66],["T_WHITESPACE"," ",66],["T_VARIABLE","$productRepository",66],",",["T_WHITESPACE","\n        ",66],["T_STRING","ProductWebsite",67],["T_WHITESPACE"," ",67],["T_VARIABLE","$productWebsite",67],",",["T_WHITESPACE","\n        ",67],["T_STRING","ProductType",68],["T_WHITESPACE"," ",68],["T_VARIABLE","$productType",68],["T_WHITESPACE","\n    ",68],")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n        ",69],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","stockRegistryProvider",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$stockRegistryProvider",70],";",["T_WHITESPACE","\n        ",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","productRepository",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$productRepository",71],";",["T_WHITESPACE","\n        ",71],["T_VARIABLE","$this",72],["T_OBJECT_OPERATOR","->",72],["T_STRING","productWebsite",72],["T_WHITESPACE"," ",72],"=",["T_WHITESPACE"," ",72],["T_VARIABLE","$productWebsite",72],";",["T_WHITESPACE","\n        ",72],["T_VARIABLE","$this",73],["T_OBJECT_OPERATOR","->",73],["T_STRING","productType",73],["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_VARIABLE","$productType",73],";",["T_WHITESPACE","\n    ",73],"}",["T_WHITESPACE","\n\n    ",74],["T_DOC_COMMENT","\/**\n     * Rebuild stock index of the given website\n     *\n     * @param int $productId\n     * @param int $scopeId\n     * @deprecated\n     * @return true\n     * @SuppressWarnings(PHPMD.UnusedLocalVariable)\n     *\/",76],["T_WHITESPACE","\n    ",84],["T_PUBLIC","public",85],["T_WHITESPACE"," ",85],["T_FUNCTION","function",85],["T_WHITESPACE"," ",85],["T_STRING","rebuild",85],"(",["T_VARIABLE","$productId",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_STRING","null",85],",",["T_WHITESPACE"," ",85],["T_VARIABLE","$scopeId",85],["T_WHITESPACE"," ",85],"=",["T_WHITESPACE"," ",85],["T_STRING","null",85],")",["T_WHITESPACE","\n    ",85],"{",["T_WHITESPACE","\n        ",86],["T_IF","if",87],["T_WHITESPACE"," ",87],"(",["T_VARIABLE","$productId",87],["T_WHITESPACE"," ",87],["T_IS_NOT_IDENTICAL","!==",87],["T_WHITESPACE"," ",87],["T_STRING","null",87],")",["T_WHITESPACE"," ",87],"{",["T_WHITESPACE","\n            ",87],["T_VARIABLE","$this",88],["T_OBJECT_OPERATOR","->",88],["T_STRING","updateProductStockStatus",88],"(",["T_VARIABLE","$productId",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$scopeId",88],")",";",["T_WHITESPACE","\n        ",88],"}",["T_WHITESPACE"," ",89],["T_ELSE","else",89],["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n            ",89],["T_VARIABLE","$lastProductId",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_LNUMBER","0",90],";",["T_WHITESPACE","\n            ",90],["T_WHILE","while",91],["T_WHITESPACE"," ",91],"(",["T_STRING","true",91],")",["T_WHITESPACE"," ",91],"{",["T_WHITESPACE","\n                ",91],["T_DOC_COMMENT","\/** @var \\Magento\\CatalogInventory\\Model\\ResourceModel\\Stock\\Status $resource *\/",92],["T_WHITESPACE","\n                ",92],["T_VARIABLE","$resource",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","getStockStatusResource",93],"(",")",";",["T_WHITESPACE","\n                ",93],["T_VARIABLE","$productCollection",94],["T_WHITESPACE"," ",94],"=",["T_WHITESPACE"," ",94],["T_VARIABLE","$resource",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","getProductCollection",94],"(",["T_VARIABLE","$lastProductId",94],")",";",["T_WHITESPACE","\n                ",94],["T_IF","if",95],["T_WHITESPACE"," ",95],"(","!",["T_VARIABLE","$productCollection",95],")",["T_WHITESPACE"," ",95],"{",["T_WHITESPACE","\n                    ",95],["T_BREAK","break",96],";",["T_WHITESPACE","\n                ",96],"}",["T_WHITESPACE","\n                ",97],["T_FOREACH","foreach",98],["T_WHITESPACE"," ",98],"(",["T_VARIABLE","$productCollection",98],["T_WHITESPACE"," ",98],["T_AS","as",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$productId",98],["T_WHITESPACE"," ",98],["T_DOUBLE_ARROW","=>",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$productType",98],")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n                    ",98],["T_VARIABLE","$lastProductId",99],["T_WHITESPACE"," ",99],"=",["T_WHITESPACE"," ",99],["T_VARIABLE","$productId",99],";",["T_WHITESPACE","\n                    ",99],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","updateProductStockStatus",100],"(",["T_VARIABLE","$productId",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$scopeId",100],")",";",["T_WHITESPACE","\n                ",100],"}",["T_WHITESPACE","\n            ",101],"}",["T_WHITESPACE","\n        ",102],"}",["T_WHITESPACE","\n        ",103],["T_RETURN","return",104],["T_WHITESPACE"," ",104],["T_STRING","true",104],";",["T_WHITESPACE","\n    ",104],"}",["T_WHITESPACE","\n\n    ",105],["T_DOC_COMMENT","\/**\n     * Update product status from stock item\n     *\n     * @param int $productId\n     * @param int $websiteId\n     * @deprecated\n     * @return void\n     *\/",107],["T_WHITESPACE","\n    ",114],["T_PUBLIC","public",115],["T_WHITESPACE"," ",115],["T_FUNCTION","function",115],["T_WHITESPACE"," ",115],["T_STRING","updateProductStockStatus",115],"(",["T_VARIABLE","$productId",115],",",["T_WHITESPACE"," ",115],["T_VARIABLE","$websiteId",115],")",["T_WHITESPACE","\n    ",115],"{",["T_WHITESPACE","\n        ",116],["T_VARIABLE","$item",117],["T_WHITESPACE"," ",117],"=",["T_WHITESPACE"," ",117],["T_VARIABLE","$this",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","stockRegistryProvider",117],["T_OBJECT_OPERATOR","->",117],["T_STRING","getStockItem",117],"(",["T_VARIABLE","$productId",117],",",["T_WHITESPACE"," ",117],["T_VARIABLE","$websiteId",117],")",";",["T_WHITESPACE","\n\n        ",117],["T_VARIABLE","$status",119],["T_WHITESPACE"," ",119],"=",["T_WHITESPACE"," ",119],["T_NS_SEPARATOR","\\",119],["T_STRING","Magento",119],["T_NS_SEPARATOR","\\",119],["T_STRING","CatalogInventory",119],["T_NS_SEPARATOR","\\",119],["T_STRING","Model",119],["T_NS_SEPARATOR","\\",119],["T_STRING","Stock",119],["T_NS_SEPARATOR","\\",119],["T_STRING","Status",119],["T_DOUBLE_COLON","::",119],["T_STRING","STATUS_IN_STOCK",119],";",["T_WHITESPACE","\n        ",119],["T_VARIABLE","$qty",120],["T_WHITESPACE"," ",120],"=",["T_WHITESPACE"," ",120],["T_LNUMBER","0",120],";",["T_WHITESPACE","\n        ",120],["T_IF","if",121],["T_WHITESPACE"," ",121],"(",["T_VARIABLE","$item",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","getItemId",121],"(",")",")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n            ",121],["T_VARIABLE","$status",122],["T_WHITESPACE"," ",122],"=",["T_WHITESPACE"," ",122],["T_VARIABLE","$item",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","getIsInStock",122],"(",")",";",["T_WHITESPACE","\n            ",122],["T_VARIABLE","$qty",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_VARIABLE","$item",123],["T_OBJECT_OPERATOR","->",123],["T_STRING","getQty",123],"(",")",";",["T_WHITESPACE","\n        ",123],"}",["T_WHITESPACE","\n        ",124],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","processChildren",125],"(",["T_VARIABLE","$productId",125],",",["T_WHITESPACE"," ",125],["T_VARIABLE","$item",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","getWebsiteId",125],"(",")",",",["T_WHITESPACE"," ",125],["T_VARIABLE","$qty",125],",",["T_WHITESPACE"," ",125],["T_VARIABLE","$status",125],")",";",["T_WHITESPACE","\n        ",125],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","processParents",126],"(",["T_VARIABLE","$productId",126],",",["T_WHITESPACE"," ",126],["T_VARIABLE","$item",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","getWebsiteId",126],"(",")",")",";",["T_WHITESPACE","\n    ",126],"}",["T_WHITESPACE","\n\n    ",127],["T_DOC_COMMENT","\/**\n     * Process children stock status\n     *\n     * @param int $productId\n     * @param int $websiteId\n     * @param int $qty\n     * @param int $status\n     * @return $this\n     * @SuppressWarnings(PHPMD.CyclomaticComplexity)\n     *\/",129],["T_WHITESPACE","\n    ",138],["T_PROTECTED","protected",139],["T_WHITESPACE"," ",139],["T_FUNCTION","function",139],["T_WHITESPACE"," ",139],["T_STRING","processChildren",139],"(",["T_WHITESPACE","\n        ",139],["T_VARIABLE","$productId",140],",",["T_WHITESPACE","\n        ",140],["T_VARIABLE","$websiteId",141],",",["T_WHITESPACE","\n        ",141],["T_VARIABLE","$qty",142],["T_WHITESPACE"," ",142],"=",["T_WHITESPACE"," ",142],["T_LNUMBER","0",142],",",["T_WHITESPACE","\n        ",142],["T_VARIABLE","$status",143],["T_WHITESPACE"," ",143],"=",["T_WHITESPACE"," ",143],["T_NS_SEPARATOR","\\",143],["T_STRING","Magento",143],["T_NS_SEPARATOR","\\",143],["T_STRING","CatalogInventory",143],["T_NS_SEPARATOR","\\",143],["T_STRING","Model",143],["T_NS_SEPARATOR","\\",143],["T_STRING","Stock",143],["T_NS_SEPARATOR","\\",143],["T_STRING","Status",143],["T_DOUBLE_COLON","::",143],["T_STRING","STATUS_IN_STOCK",143],["T_WHITESPACE","\n    ",143],")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n        ",144],["T_IF","if",145],["T_WHITESPACE"," ",145],"(",["T_VARIABLE","$status",145],["T_WHITESPACE"," ",145],["T_IS_EQUAL","==",145],["T_WHITESPACE"," ",145],["T_NS_SEPARATOR","\\",145],["T_STRING","Magento",145],["T_NS_SEPARATOR","\\",145],["T_STRING","CatalogInventory",145],["T_NS_SEPARATOR","\\",145],["T_STRING","Model",145],["T_NS_SEPARATOR","\\",145],["T_STRING","Stock",145],["T_NS_SEPARATOR","\\",145],["T_STRING","Status",145],["T_DOUBLE_COLON","::",145],["T_STRING","STATUS_OUT_OF_STOCK",145],")",["T_WHITESPACE"," ",145],"{",["T_WHITESPACE","\n            ",145],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","getStockStatusResource",146],"(",")",["T_OBJECT_OPERATOR","->",146],["T_STRING","saveProductStatus",146],"(",["T_VARIABLE","$productId",146],",",["T_WHITESPACE"," ",146],["T_VARIABLE","$status",146],",",["T_WHITESPACE"," ",146],["T_VARIABLE","$qty",146],",",["T_WHITESPACE"," ",146],["T_VARIABLE","$websiteId",146],")",";",["T_WHITESPACE","\n            ",146],["T_RETURN","return",147],";",["T_WHITESPACE","\n        ",147],"}",["T_WHITESPACE","\n\n        ",148],["T_VARIABLE","$statuses",150],["T_WHITESPACE"," ",150],"=",["T_WHITESPACE"," ",150],"[","]",";",["T_WHITESPACE","\n        ",150],["T_VARIABLE","$websitesWithStores",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","getWebsitesWithDefaultStores",151],"(",["T_VARIABLE","$websiteId",151],")",";",["T_WHITESPACE","\n\n        ",151],["T_FOREACH","foreach",153],["T_WHITESPACE"," ",153],"(",["T_STRING","array_keys",153],"(",["T_VARIABLE","$websitesWithStores",153],")",["T_WHITESPACE"," ",153],["T_AS","as",153],["T_WHITESPACE"," ",153],["T_VARIABLE","$websiteId",153],")",["T_WHITESPACE"," ",153],"{",["T_WHITESPACE","\n            ",153],["T_COMMENT","\/* @var $website \\Magento\\Store\\Model\\Website *\/",154],["T_WHITESPACE","\n            ",154],["T_VARIABLE","$statuses",155],"[",["T_VARIABLE","$websiteId",155],"]",["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_VARIABLE","$status",155],";",["T_WHITESPACE","\n        ",155],"}",["T_WHITESPACE","\n\n        ",156],["T_DOC_COMMENT","\/** @var \\Magento\\Catalog\\Model\\Product $product *\/",158],["T_WHITESPACE","\n        ",158],["T_VARIABLE","$product",159],["T_WHITESPACE"," ",159],"=",["T_WHITESPACE"," ",159],["T_VARIABLE","$this",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","productRepository",159],["T_OBJECT_OPERATOR","->",159],["T_STRING","getById",159],"(",["T_VARIABLE","$productId",159],")",";",["T_WHITESPACE","\n        ",159],["T_VARIABLE","$typeInstance",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_VARIABLE","$product",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","getTypeInstance",160],"(",")",";",["T_WHITESPACE","\n\n        ",160],["T_VARIABLE","$requiredChildrenIds",162],["T_WHITESPACE"," ",162],"=",["T_WHITESPACE"," ",162],["T_VARIABLE","$typeInstance",162],["T_OBJECT_OPERATOR","->",162],["T_STRING","getChildrenIds",162],"(",["T_VARIABLE","$productId",162],",",["T_WHITESPACE"," ",162],["T_STRING","true",162],")",";",["T_WHITESPACE","\n        ",162],["T_IF","if",163],["T_WHITESPACE"," ",163],"(",["T_VARIABLE","$requiredChildrenIds",163],")",["T_WHITESPACE"," ",163],"{",["T_WHITESPACE","\n            ",163],["T_VARIABLE","$childrenIds",164],["T_WHITESPACE"," ",164],"=",["T_WHITESPACE"," ",164],"[","]",";",["T_WHITESPACE","\n            ",164],["T_FOREACH","foreach",165],["T_WHITESPACE"," ",165],"(",["T_VARIABLE","$requiredChildrenIds",165],["T_WHITESPACE"," ",165],["T_AS","as",165],["T_WHITESPACE"," ",165],["T_VARIABLE","$groupedChildrenIds",165],")",["T_WHITESPACE"," ",165],"{",["T_WHITESPACE","\n                ",165],["T_VARIABLE","$childrenIds",166],["T_WHITESPACE"," ",166],"=",["T_WHITESPACE"," ",166],["T_STRING","array_merge",166],"(",["T_VARIABLE","$childrenIds",166],",",["T_WHITESPACE"," ",166],["T_VARIABLE","$groupedChildrenIds",166],")",";",["T_WHITESPACE","\n            ",166],"}",["T_WHITESPACE","\n            ",167],["T_VARIABLE","$childrenWebsites",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","productWebsite",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","getWebsites",168],"(",["T_VARIABLE","$childrenIds",168],")",";",["T_WHITESPACE","\n            ",168],["T_FOREACH","foreach",169],["T_WHITESPACE"," ",169],"(",["T_VARIABLE","$websitesWithStores",169],["T_WHITESPACE"," ",169],["T_AS","as",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$websiteId",169],["T_WHITESPACE"," ",169],["T_DOUBLE_ARROW","=>",169],["T_WHITESPACE"," ",169],["T_VARIABLE","$storeId",169],")",["T_WHITESPACE"," ",169],"{",["T_WHITESPACE","\n                ",169],["T_VARIABLE","$childrenStatus",170],["T_WHITESPACE"," ",170],"=",["T_WHITESPACE"," ",170],["T_VARIABLE","$this",170],["T_OBJECT_OPERATOR","->",170],["T_STRING","getStockStatusResource",170],"(",")",["T_OBJECT_OPERATOR","->",170],["T_STRING","getProductStatus",170],"(",["T_VARIABLE","$childrenIds",170],",",["T_WHITESPACE"," ",170],["T_VARIABLE","$storeId",170],")",";",["T_WHITESPACE","\n                ",170],["T_VARIABLE","$childrenStock",171],["T_WHITESPACE"," ",171],"=",["T_WHITESPACE"," ",171],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","getStockStatusResource",171],"(",")",["T_OBJECT_OPERATOR","->",171],["T_STRING","getProductsStockStatuses",171],"(",["T_VARIABLE","$childrenIds",171],",",["T_WHITESPACE"," ",171],["T_VARIABLE","$websiteId",171],")",";",["T_WHITESPACE","\n                ",171],["T_VARIABLE","$websiteStatus",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_VARIABLE","$statuses",172],"[",["T_VARIABLE","$websiteId",172],"]",";",["T_WHITESPACE","\n                ",172],["T_FOREACH","foreach",173],["T_WHITESPACE"," ",173],"(",["T_VARIABLE","$requiredChildrenIds",173],["T_WHITESPACE"," ",173],["T_AS","as",173],["T_WHITESPACE"," ",173],["T_VARIABLE","$groupedChildrenIds",173],")",["T_WHITESPACE"," ",173],"{",["T_WHITESPACE","\n                    ",173],["T_VARIABLE","$optionStatus",174],["T_WHITESPACE"," ",174],"=",["T_WHITESPACE"," ",174],["T_STRING","false",174],";",["T_WHITESPACE","\n                    ",174],["T_FOREACH","foreach",175],["T_WHITESPACE"," ",175],"(",["T_VARIABLE","$groupedChildrenIds",175],["T_WHITESPACE"," ",175],["T_AS","as",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$childId",175],")",["T_WHITESPACE"," ",175],"{",["T_WHITESPACE","\n                        ",175],["T_IF","if",176],["T_WHITESPACE"," ",176],"(",["T_ISSET","isset",176],"(",["T_VARIABLE","$childrenStatus",176],"[",["T_VARIABLE","$childId",176],"]",")",["T_WHITESPACE","\n                            ",176],["T_BOOLEAN_AND","&&",177],["T_WHITESPACE"," ",177],["T_ISSET","isset",177],"(",["T_VARIABLE","$childrenWebsites",177],"[",["T_VARIABLE","$childId",177],"]",")",["T_WHITESPACE","\n                            ",177],["T_BOOLEAN_AND","&&",178],["T_WHITESPACE"," ",178],["T_STRING","in_array",178],"(",["T_VARIABLE","$websiteId",178],",",["T_WHITESPACE"," ",178],["T_VARIABLE","$childrenWebsites",178],"[",["T_VARIABLE","$childId",178],"]",")",["T_WHITESPACE","\n                            ",178],["T_BOOLEAN_AND","&&",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$childrenStatus",179],"[",["T_VARIABLE","$childId",179],"]",["T_WHITESPACE"," ",179],["T_IS_EQUAL","==",179],["T_WHITESPACE"," ",179],["T_NS_SEPARATOR","\\",179],["T_STRING","Magento",179],["T_NS_SEPARATOR","\\",179],["T_STRING","Catalog",179],["T_NS_SEPARATOR","\\",179],["T_STRING","Model",179],["T_NS_SEPARATOR","\\",179],["T_STRING","Product",179],["T_NS_SEPARATOR","\\",179],["T_STRING","Attribute",179],["T_NS_SEPARATOR","\\",179],["T_STRING","Source",179],["T_NS_SEPARATOR","\\",179],["T_STRING","Status",179],["T_DOUBLE_COLON","::",179],["T_STRING","STATUS_ENABLED",179],["T_WHITESPACE","\n                            ",179],["T_BOOLEAN_AND","&&",180],["T_WHITESPACE"," ",180],["T_ISSET","isset",180],"(",["T_VARIABLE","$childrenStock",180],"[",["T_VARIABLE","$childId",180],"]",")",["T_WHITESPACE","\n                            ",180],["T_BOOLEAN_AND","&&",181],["T_WHITESPACE"," ",181],["T_VARIABLE","$childrenStock",181],"[",["T_VARIABLE","$childId",181],"]",["T_WHITESPACE"," ",181],["T_IS_EQUAL","==",181],["T_WHITESPACE"," ",181],["T_NS_SEPARATOR","\\",181],["T_STRING","Magento",181],["T_NS_SEPARATOR","\\",181],["T_STRING","CatalogInventory",181],["T_NS_SEPARATOR","\\",181],["T_STRING","Model",181],["T_NS_SEPARATOR","\\",181],["T_STRING","Stock",181],["T_NS_SEPARATOR","\\",181],["T_STRING","Status",181],["T_DOUBLE_COLON","::",181],["T_STRING","STATUS_IN_STOCK",181],["T_WHITESPACE","\n                        ",181],")",["T_WHITESPACE"," ",182],"{",["T_WHITESPACE","\n                            ",182],["T_VARIABLE","$optionStatus",183],["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_STRING","true",183],";",["T_WHITESPACE","\n                        ",183],"}",["T_WHITESPACE","\n                    ",184],"}",["T_WHITESPACE","\n                    ",185],["T_VARIABLE","$websiteStatus",186],["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_VARIABLE","$websiteStatus",186],["T_WHITESPACE"," ",186],["T_BOOLEAN_AND","&&",186],["T_WHITESPACE"," ",186],["T_VARIABLE","$optionStatus",186],";",["T_WHITESPACE","\n                ",186],"}",["T_WHITESPACE","\n                ",187],["T_VARIABLE","$statuses",188],"[",["T_VARIABLE","$websiteId",188],"]",["T_WHITESPACE"," ",188],"=",["T_WHITESPACE"," ",188],["T_INT_CAST","(int)",188],["T_VARIABLE","$websiteStatus",188],";",["T_WHITESPACE","\n            ",188],"}",["T_WHITESPACE","\n        ",189],"}",["T_WHITESPACE","\n        ",190],["T_FOREACH","foreach",191],["T_WHITESPACE"," ",191],"(",["T_VARIABLE","$statuses",191],["T_WHITESPACE"," ",191],["T_AS","as",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$websiteId",191],["T_WHITESPACE"," ",191],["T_DOUBLE_ARROW","=>",191],["T_WHITESPACE"," ",191],["T_VARIABLE","$websiteStatus",191],")",["T_WHITESPACE"," ",191],"{",["T_WHITESPACE","\n            ",191],["T_VARIABLE","$this",192],["T_OBJECT_OPERATOR","->",192],["T_STRING","getStockStatusResource",192],"(",")",["T_OBJECT_OPERATOR","->",192],["T_STRING","saveProductStatus",192],"(",["T_VARIABLE","$productId",192],",",["T_WHITESPACE"," ",192],["T_VARIABLE","$websiteStatus",192],",",["T_WHITESPACE"," ",192],["T_VARIABLE","$qty",192],",",["T_WHITESPACE"," ",192],["T_VARIABLE","$websiteId",192],")",";",["T_WHITESPACE","\n        ",192],"}",["T_WHITESPACE","\n    ",193],"}",["T_WHITESPACE","\n\n    ",194],["T_DOC_COMMENT","\/**\n     * Retrieve website models\n     *\n     * @param int|null $websiteId\n     * @return array\n     *\/",196],["T_WHITESPACE","\n    ",201],["T_PROTECTED","protected",202],["T_WHITESPACE"," ",202],["T_FUNCTION","function",202],["T_WHITESPACE"," ",202],["T_STRING","getWebsitesWithDefaultStores",202],"(",["T_VARIABLE","$websiteId",202],["T_WHITESPACE"," ",202],"=",["T_WHITESPACE"," ",202],["T_STRING","null",202],")",["T_WHITESPACE","\n    ",202],"{",["T_WHITESPACE","\n        ",203],["T_IF","if",204],["T_WHITESPACE"," ",204],"(",["T_STRING","is_null",204],"(",["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","websites",204],")",")",["T_WHITESPACE"," ",204],"{",["T_WHITESPACE","\n            ",204],["T_DOC_COMMENT","\/** @var \\Magento\\CatalogInventory\\Model\\ResourceModel\\Stock\\Status $resource *\/",205],["T_WHITESPACE","\n            ",205],["T_VARIABLE","$resource",206],["T_WHITESPACE"," ",206],"=",["T_WHITESPACE"," ",206],["T_VARIABLE","$this",206],["T_OBJECT_OPERATOR","->",206],["T_STRING","getStockStatusResource",206],"(",")",";",["T_WHITESPACE","\n            ",206],["T_VARIABLE","$this",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","websites",207],["T_WHITESPACE"," ",207],"=",["T_WHITESPACE"," ",207],["T_VARIABLE","$resource",207],["T_OBJECT_OPERATOR","->",207],["T_STRING","getWebsiteStores",207],"(",")",";",["T_WHITESPACE","\n        ",207],"}",["T_WHITESPACE","\n        ",208],["T_VARIABLE","$websites",209],["T_WHITESPACE"," ",209],"=",["T_WHITESPACE"," ",209],["T_VARIABLE","$this",209],["T_OBJECT_OPERATOR","->",209],["T_STRING","websites",209],";",["T_WHITESPACE","\n        ",209],["T_IF","if",210],["T_WHITESPACE"," ",210],"(","!",["T_STRING","is_null",210],"(",["T_VARIABLE","$websiteId",210],")",["T_WHITESPACE"," ",210],["T_BOOLEAN_AND","&&",210],["T_WHITESPACE"," ",210],["T_ISSET","isset",210],"(",["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","websites",210],"[",["T_VARIABLE","$websiteId",210],"]",")",")",["T_WHITESPACE"," ",210],"{",["T_WHITESPACE","\n            ",210],["T_VARIABLE","$websites",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],"[",["T_VARIABLE","$websiteId",211],["T_WHITESPACE"," ",211],["T_DOUBLE_ARROW","=>",211],["T_WHITESPACE"," ",211],["T_VARIABLE","$this",211],["T_OBJECT_OPERATOR","->",211],["T_STRING","websites",211],"[",["T_VARIABLE","$websiteId",211],"]","]",";",["T_WHITESPACE","\n        ",211],"}",["T_WHITESPACE","\n        ",212],["T_RETURN","return",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$websites",213],";",["T_WHITESPACE","\n    ",213],"}",["T_WHITESPACE","\n\n    ",214],["T_DOC_COMMENT","\/**\n     * Process Parents by child\n     *\n     * @param int $productId\n     * @param int $websiteId\n     * @return $this\n     *\/",216],["T_WHITESPACE","\n    ",222],["T_PROTECTED","protected",223],["T_WHITESPACE"," ",223],["T_FUNCTION","function",223],["T_WHITESPACE"," ",223],["T_STRING","processParents",223],"(",["T_VARIABLE","$productId",223],",",["T_WHITESPACE"," ",223],["T_VARIABLE","$websiteId",223],")",["T_WHITESPACE","\n    ",223],"{",["T_WHITESPACE","\n        ",224],["T_VARIABLE","$parentIds",225],["T_WHITESPACE"," ",225],"=",["T_WHITESPACE"," ",225],"[","]",";",["T_WHITESPACE","\n        ",225],["T_FOREACH","foreach",226],["T_WHITESPACE"," ",226],"(",["T_VARIABLE","$this",226],["T_OBJECT_OPERATOR","->",226],["T_STRING","getProductTypeInstances",226],"(",")",["T_WHITESPACE"," ",226],["T_AS","as",226],["T_WHITESPACE"," ",226],["T_VARIABLE","$typeInstance",226],")",["T_WHITESPACE"," ",226],"{",["T_WHITESPACE","\n            ",226],["T_COMMENT","\/* @var $typeInstance AbstractType *\/",227],["T_WHITESPACE","\n            ",227],["T_VARIABLE","$parentIds",228],["T_WHITESPACE"," ",228],"=",["T_WHITESPACE"," ",228],["T_STRING","array_merge",228],"(",["T_VARIABLE","$parentIds",228],",",["T_WHITESPACE"," ",228],["T_VARIABLE","$typeInstance",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","getParentIdsByChild",228],"(",["T_VARIABLE","$productId",228],")",")",";",["T_WHITESPACE","\n        ",228],"}",["T_WHITESPACE","\n\n        ",229],["T_IF","if",231],["T_WHITESPACE"," ",231],"(","!",["T_VARIABLE","$parentIds",231],")",["T_WHITESPACE"," ",231],"{",["T_WHITESPACE","\n            ",231],["T_RETURN","return",232],["T_WHITESPACE"," ",232],["T_VARIABLE","$this",232],";",["T_WHITESPACE","\n        ",232],"}",["T_WHITESPACE","\n\n        ",233],["T_FOREACH","foreach",235],["T_WHITESPACE"," ",235],"(",["T_VARIABLE","$parentIds",235],["T_WHITESPACE"," ",235],["T_AS","as",235],["T_WHITESPACE"," ",235],["T_VARIABLE","$parentId",235],")",["T_WHITESPACE"," ",235],"{",["T_WHITESPACE","\n            ",235],["T_VARIABLE","$item",236],["T_WHITESPACE"," ",236],"=",["T_WHITESPACE"," ",236],["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","stockRegistryProvider",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","getStockItem",236],"(",["T_VARIABLE","$parentId",236],",",["T_WHITESPACE"," ",236],["T_VARIABLE","$websiteId",236],")",";",["T_WHITESPACE","\n            ",236],["T_VARIABLE","$status",237],["T_WHITESPACE"," ",237],"=",["T_WHITESPACE"," ",237],["T_NS_SEPARATOR","\\",237],["T_STRING","Magento",237],["T_NS_SEPARATOR","\\",237],["T_STRING","CatalogInventory",237],["T_NS_SEPARATOR","\\",237],["T_STRING","Model",237],["T_NS_SEPARATOR","\\",237],["T_STRING","Stock",237],["T_NS_SEPARATOR","\\",237],["T_STRING","Status",237],["T_DOUBLE_COLON","::",237],["T_STRING","STATUS_IN_STOCK",237],";",["T_WHITESPACE","\n            ",237],["T_VARIABLE","$qty",238],["T_WHITESPACE"," ",238],"=",["T_WHITESPACE"," ",238],["T_LNUMBER","0",238],";",["T_WHITESPACE","\n            ",238],["T_IF","if",239],["T_WHITESPACE"," ",239],"(",["T_VARIABLE","$item",239],["T_OBJECT_OPERATOR","->",239],["T_STRING","getItemId",239],"(",")",")",["T_WHITESPACE"," ",239],"{",["T_WHITESPACE","\n                ",239],["T_VARIABLE","$status",240],["T_WHITESPACE"," ",240],"=",["T_WHITESPACE"," ",240],["T_VARIABLE","$item",240],["T_OBJECT_OPERATOR","->",240],["T_STRING","getIsInStock",240],"(",")",";",["T_WHITESPACE","\n                ",240],["T_VARIABLE","$qty",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_VARIABLE","$item",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","getQty",241],"(",")",";",["T_WHITESPACE","\n            ",241],"}",["T_WHITESPACE","\n            ",242],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","processChildren",243],"(",["T_VARIABLE","$parentId",243],",",["T_WHITESPACE"," ",243],["T_VARIABLE","$websiteId",243],",",["T_WHITESPACE"," ",243],["T_VARIABLE","$qty",243],",",["T_WHITESPACE"," ",243],["T_VARIABLE","$status",243],")",";",["T_WHITESPACE","\n        ",243],"}",["T_WHITESPACE","\n    ",244],"}",["T_WHITESPACE","\n\n    ",245],["T_DOC_COMMENT","\/**\n     * Retrieve Product Type Instances\n     * as key - type code, value - instance model\n     *\n     * @return array\n     *\/",247],["T_WHITESPACE","\n    ",252],["T_PROTECTED","protected",253],["T_WHITESPACE"," ",253],["T_FUNCTION","function",253],["T_WHITESPACE"," ",253],["T_STRING","getProductTypeInstances",253],"(",")",["T_WHITESPACE","\n    ",253],"{",["T_WHITESPACE","\n        ",254],["T_IF","if",255],["T_WHITESPACE"," ",255],"(",["T_EMPTY","empty",255],"(",["T_VARIABLE","$this",255],["T_OBJECT_OPERATOR","->",255],["T_STRING","productTypes",255],")",")",["T_WHITESPACE"," ",255],"{",["T_WHITESPACE","\n            ",255],["T_VARIABLE","$productEmulator",256],["T_WHITESPACE"," ",256],"=",["T_WHITESPACE"," ",256],["T_NEW","new",256],["T_WHITESPACE"," ",256],["T_NS_SEPARATOR","\\",256],["T_STRING","Magento",256],["T_NS_SEPARATOR","\\",256],["T_STRING","Framework",256],["T_NS_SEPARATOR","\\",256],["T_STRING","DataObject",256],"(",")",";",["T_WHITESPACE","\n            ",256],["T_FOREACH","foreach",257],["T_WHITESPACE"," ",257],"(",["T_STRING","array_keys",257],"(",["T_VARIABLE","$this",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","productType",257],["T_OBJECT_OPERATOR","->",257],["T_STRING","getTypes",257],"(",")",")",["T_WHITESPACE"," ",257],["T_AS","as",257],["T_WHITESPACE"," ",257],["T_VARIABLE","$typeId",257],")",["T_WHITESPACE"," ",257],"{",["T_WHITESPACE","\n                ",257],["T_VARIABLE","$productEmulator",258],["T_OBJECT_OPERATOR","->",258],["T_STRING","setTypeId",258],"(",["T_VARIABLE","$typeId",258],")",";",["T_WHITESPACE","\n                ",258],["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","productTypes",259],"[",["T_VARIABLE","$typeId",259],"]",["T_WHITESPACE"," ",259],"=",["T_WHITESPACE"," ",259],["T_VARIABLE","$this",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","productType",259],["T_OBJECT_OPERATOR","->",259],["T_STRING","factory",259],"(",["T_VARIABLE","$productEmulator",259],")",";",["T_WHITESPACE","\n            ",259],"}",["T_WHITESPACE","\n        ",260],"}",["T_WHITESPACE","\n        ",261],["T_RETURN","return",262],["T_WHITESPACE"," ",262],["T_VARIABLE","$this",262],["T_OBJECT_OPERATOR","->",262],["T_STRING","productTypes",262],";",["T_WHITESPACE","\n    ",262],"}",["T_WHITESPACE","\n\n    ",263],["T_DOC_COMMENT","\/**\n     * @return \\Magento\\CatalogInventory\\Model\\ResourceModel\\Stock\\Status\n     *\/",265],["T_WHITESPACE","\n    ",267],["T_PROTECTED","protected",268],["T_WHITESPACE"," ",268],["T_FUNCTION","function",268],["T_WHITESPACE"," ",268],["T_STRING","getStockStatusResource",268],"(",")",["T_WHITESPACE","\n    ",268],"{",["T_WHITESPACE","\n        ",269],["T_IF","if",270],["T_WHITESPACE"," ",270],"(",["T_EMPTY","empty",270],"(",["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","stockStatusResource",270],")",")",["T_WHITESPACE"," ",270],"{",["T_WHITESPACE","\n            ",270],["T_VARIABLE","$this",271],["T_OBJECT_OPERATOR","->",271],["T_STRING","stockStatusResource",271],["T_WHITESPACE"," ",271],"=",["T_WHITESPACE"," ",271],["T_NS_SEPARATOR","\\",271],["T_STRING","Magento",271],["T_NS_SEPARATOR","\\",271],["T_STRING","Framework",271],["T_NS_SEPARATOR","\\",271],["T_STRING","App",271],["T_NS_SEPARATOR","\\",271],["T_STRING","ObjectManager",271],["T_DOUBLE_COLON","::",271],["T_STRING","getInstance",271],"(",")",["T_OBJECT_OPERATOR","->",271],["T_STRING","get",271],"(",["T_WHITESPACE","\r\n                ",271],["T_NS_SEPARATOR","\\",272],["T_STRING","Magento",272],["T_NS_SEPARATOR","\\",272],["T_STRING","CatalogInventory",272],["T_NS_SEPARATOR","\\",272],["T_STRING","Model",272],["T_NS_SEPARATOR","\\",272],["T_STRING","ResourceModel",272],["T_NS_SEPARATOR","\\",272],["T_STRING","Stock",272],["T_NS_SEPARATOR","\\",272],["T_STRING","Status",272],["T_DOUBLE_COLON","::",272],["T_CLASS","class",272],["T_WHITESPACE","\n            ",272],")",";",["T_WHITESPACE","\n        ",273],"}",["T_WHITESPACE","\n        ",274],["T_RETURN","return",275],["T_WHITESPACE"," ",275],["T_VARIABLE","$this",275],["T_OBJECT_OPERATOR","->",275],["T_STRING","stockStatusResource",275],";",["T_WHITESPACE","\n    ",275],"}",["T_WHITESPACE","\n",276],"}",["T_WHITESPACE","\n",277]]