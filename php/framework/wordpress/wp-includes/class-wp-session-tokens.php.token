[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Session API: WP_Session_Tokens class\n *\n * @package WordPress\n * @subpackage Session\n * @since 4.7.0\n *\/",2],["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * Abstract class for managing user session tokens.\n *\n * @since 4.0.0\n *\/",10],["T_WHITESPACE","\n",14],["T_ABSTRACT","abstract",15],["T_WHITESPACE"," ",15],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","WP_Session_Tokens",15],["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n\n\t",15],["T_DOC_COMMENT","\/**\n\t * User ID.\n\t *\n\t * @since 4.0.0\n\t * @access protected\n\t * @var int User ID.\n\t *\/",17],["T_WHITESPACE","\n\t",23],["T_PROTECTED","protected",24],["T_WHITESPACE"," ",24],["T_VARIABLE","$user_id",24],";",["T_WHITESPACE","\n\n\t",24],["T_DOC_COMMENT","\/**\n\t * Protected constructor.\n\t *\n\t * @since 4.0.0\n\t *\n\t * @param int $user_id User whose session to manage.\n\t *\/",26],["T_WHITESPACE","\n\t",32],["T_PROTECTED","protected",33],["T_WHITESPACE"," ",33],["T_FUNCTION","function",33],["T_WHITESPACE"," ",33],["T_STRING","__construct",33],"(",["T_WHITESPACE"," ",33],["T_VARIABLE","$user_id",33],["T_WHITESPACE"," ",33],")",["T_WHITESPACE"," ",33],"{",["T_WHITESPACE","\n\t\t",33],["T_VARIABLE","$this",34],["T_OBJECT_OPERATOR","->",34],["T_STRING","user_id",34],["T_WHITESPACE"," ",34],"=",["T_WHITESPACE"," ",34],["T_VARIABLE","$user_id",34],";",["T_WHITESPACE","\n\t",34],"}",["T_WHITESPACE","\n\n\t",35],["T_DOC_COMMENT","\/**\n\t * Get a session token manager instance for a user.\n\t *\n\t * This method contains a filter that allows a plugin to swap out\n\t * the session manager for a subclass of WP_Session_Tokens.\n\t *\n\t * @since 4.0.0\n\t * @access public\n\t * @static\n\t *\n\t * @param int $user_id User whose session to manage.\n\t *\/",37],["T_WHITESPACE","\n\t",48],["T_FINAL","final",49],["T_WHITESPACE"," ",49],["T_PUBLIC","public",49],["T_WHITESPACE"," ",49],["T_STATIC","static",49],["T_WHITESPACE"," ",49],["T_FUNCTION","function",49],["T_WHITESPACE"," ",49],["T_STRING","get_instance",49],"(",["T_WHITESPACE"," ",49],["T_VARIABLE","$user_id",49],["T_WHITESPACE"," ",49],")",["T_WHITESPACE"," ",49],"{",["T_WHITESPACE","\n\t\t",49],["T_DOC_COMMENT","\/**\n\t\t * Filters the session token manager used.\n\t\t *\n\t\t * @since 4.0.0\n\t\t *\n\t\t * @param string $session Name of class to use as the manager.\n\t\t *                        Default 'WP_User_Meta_Session_Tokens'.\n\t\t *\/",50],["T_WHITESPACE","\n\t\t",57],["T_VARIABLE","$manager",58],["T_WHITESPACE"," ",58],"=",["T_WHITESPACE"," ",58],["T_STRING","apply_filters",58],"(",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'session_token_manager'",58],",",["T_WHITESPACE"," ",58],["T_CONSTANT_ENCAPSED_STRING","'WP_User_Meta_Session_Tokens'",58],["T_WHITESPACE"," ",58],")",";",["T_WHITESPACE","\n\t\t",58],["T_RETURN","return",59],["T_WHITESPACE"," ",59],["T_NEW","new",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$manager",59],"(",["T_WHITESPACE"," ",59],["T_VARIABLE","$user_id",59],["T_WHITESPACE"," ",59],")",";",["T_WHITESPACE","\n\t",59],"}",["T_WHITESPACE","\n\n\t",60],["T_DOC_COMMENT","\/**\n\t * Hashes a session token for storage.\n\t *\n\t * @since 4.0.0\n\t * @access private\n\t *\n\t * @param string $token Session token to hash.\n\t * @return string A hash of the session token (a verifier).\n\t *\/",62],["T_WHITESPACE","\n\t",70],["T_FINAL","final",71],["T_WHITESPACE"," ",71],["T_PRIVATE","private",71],["T_WHITESPACE"," ",71],["T_FUNCTION","function",71],["T_WHITESPACE"," ",71],["T_STRING","hash_token",71],"(",["T_WHITESPACE"," ",71],["T_VARIABLE","$token",71],["T_WHITESPACE"," ",71],")",["T_WHITESPACE"," ",71],"{",["T_WHITESPACE","\n\t\t",71],["T_COMMENT","\/\/ If ext\/hash is not present, use sha1() instead.\n",72],["T_WHITESPACE","\t\t",73],["T_IF","if",73],["T_WHITESPACE"," ",73],"(",["T_WHITESPACE"," ",73],["T_STRING","function_exists",73],"(",["T_WHITESPACE"," ",73],["T_CONSTANT_ENCAPSED_STRING","'hash'",73],["T_WHITESPACE"," ",73],")",["T_WHITESPACE"," ",73],")",["T_WHITESPACE"," ",73],"{",["T_WHITESPACE","\n\t\t\t",73],["T_RETURN","return",74],["T_WHITESPACE"," ",74],["T_STRING","hash",74],"(",["T_WHITESPACE"," ",74],["T_CONSTANT_ENCAPSED_STRING","'sha256'",74],",",["T_WHITESPACE"," ",74],["T_VARIABLE","$token",74],["T_WHITESPACE"," ",74],")",";",["T_WHITESPACE","\n\t\t",74],"}",["T_WHITESPACE"," ",75],["T_ELSE","else",75],["T_WHITESPACE"," ",75],"{",["T_WHITESPACE","\n\t\t\t",75],["T_RETURN","return",76],["T_WHITESPACE"," ",76],["T_STRING","sha1",76],"(",["T_WHITESPACE"," ",76],["T_VARIABLE","$token",76],["T_WHITESPACE"," ",76],")",";",["T_WHITESPACE","\n\t\t",76],"}",["T_WHITESPACE","\n\t",77],"}",["T_WHITESPACE","\n\n\t",78],["T_DOC_COMMENT","\/**\n\t * Get a user's session.\n\t *\n\t * @since 4.0.0\n\t * @access public\n\t *\n\t * @param string $token Session token\n\t * @return array User session\n\t *\/",80],["T_WHITESPACE","\n\t",88],["T_FINAL","final",89],["T_WHITESPACE"," ",89],["T_PUBLIC","public",89],["T_WHITESPACE"," ",89],["T_FUNCTION","function",89],["T_WHITESPACE"," ",89],["T_STRING","get",89],"(",["T_WHITESPACE"," ",89],["T_VARIABLE","$token",89],["T_WHITESPACE"," ",89],")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n\t\t",89],["T_VARIABLE","$verifier",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","hash_token",90],"(",["T_WHITESPACE"," ",90],["T_VARIABLE","$token",90],["T_WHITESPACE"," ",90],")",";",["T_WHITESPACE","\n\t\t",90],["T_RETURN","return",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","get_session",91],"(",["T_WHITESPACE"," ",91],["T_VARIABLE","$verifier",91],["T_WHITESPACE"," ",91],")",";",["T_WHITESPACE","\n\t",91],"}",["T_WHITESPACE","\n\n\t",92],["T_DOC_COMMENT","\/**\n\t * Validate a user's session token as authentic.\n\t *\n\t * Checks that the given token is present and hasn't expired.\n\t *\n\t * @since 4.0.0\n\t * @access public\n\t *\n\t * @param string $token Token to verify.\n\t * @return bool Whether the token is valid for the user.\n\t *\/",94],["T_WHITESPACE","\n\t",104],["T_FINAL","final",105],["T_WHITESPACE"," ",105],["T_PUBLIC","public",105],["T_WHITESPACE"," ",105],["T_FUNCTION","function",105],["T_WHITESPACE"," ",105],["T_STRING","verify",105],"(",["T_WHITESPACE"," ",105],["T_VARIABLE","$token",105],["T_WHITESPACE"," ",105],")",["T_WHITESPACE"," ",105],"{",["T_WHITESPACE","\n\t\t",105],["T_VARIABLE","$verifier",106],["T_WHITESPACE"," ",106],"=",["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","hash_token",106],"(",["T_WHITESPACE"," ",106],["T_VARIABLE","$token",106],["T_WHITESPACE"," ",106],")",";",["T_WHITESPACE","\n\t\t",106],["T_RETURN","return",107],["T_WHITESPACE"," ",107],["T_BOOL_CAST","(bool)",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","get_session",107],"(",["T_WHITESPACE"," ",107],["T_VARIABLE","$verifier",107],["T_WHITESPACE"," ",107],")",";",["T_WHITESPACE","\n\t",107],"}",["T_WHITESPACE","\n\n\t",108],["T_DOC_COMMENT","\/**\n\t * Generate a session token and attach session information to it.\n\t *\n\t * A session token is a long, random string. It is used in a cookie\n\t * link that cookie to an expiration time and to ensure the cookie\n\t * becomes invalidated upon logout.\n\t *\n\t * This function generates a token and stores it with the associated\n\t * expiration time (and potentially other session information via the\n\t * {@see 'attach_session_information'} filter).\n\t *\n\t * @since 4.0.0\n\t * @access public\n\t *\n\t * @param int $expiration Session expiration timestamp.\n\t * @return string Session token.\n\t *\/",110],["T_WHITESPACE","\n\t",126],["T_FINAL","final",127],["T_WHITESPACE"," ",127],["T_PUBLIC","public",127],["T_WHITESPACE"," ",127],["T_FUNCTION","function",127],["T_WHITESPACE"," ",127],["T_STRING","create",127],"(",["T_WHITESPACE"," ",127],["T_VARIABLE","$expiration",127],["T_WHITESPACE"," ",127],")",["T_WHITESPACE"," ",127],"{",["T_WHITESPACE","\n\t\t",127],["T_DOC_COMMENT","\/**\n\t\t * Filters the information attached to the newly created session.\n\t\t *\n\t\t * Could be used in the future to attach information such as\n\t\t * IP address or user agent to a session.\n\t\t *\n\t\t * @since 4.0.0\n\t\t *\n\t\t * @param array $session Array of extra data.\n\t\t * @param int   $user_id User ID.\n\t\t *\/",128],["T_WHITESPACE","\n\t\t",138],["T_VARIABLE","$session",139],["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_STRING","apply_filters",139],"(",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","'attach_session_information'",139],",",["T_WHITESPACE"," ",139],["T_ARRAY","array",139],"(",")",",",["T_WHITESPACE"," ",139],["T_VARIABLE","$this",139],["T_OBJECT_OPERATOR","->",139],["T_STRING","user_id",139],["T_WHITESPACE"," ",139],")",";",["T_WHITESPACE","\n\t\t",139],["T_VARIABLE","$session",140],"[",["T_CONSTANT_ENCAPSED_STRING","'expiration'",140],"]",["T_WHITESPACE"," ",140],"=",["T_WHITESPACE"," ",140],["T_VARIABLE","$expiration",140],";",["T_WHITESPACE","\n\n\t\t",140],["T_COMMENT","\/\/ IP address.\n",142],["T_WHITESPACE","\t\t",143],["T_IF","if",143],["T_WHITESPACE"," ",143],"(",["T_WHITESPACE"," ",143],"!",["T_EMPTY","empty",143],"(",["T_WHITESPACE"," ",143],["T_VARIABLE","$_SERVER",143],"[",["T_CONSTANT_ENCAPSED_STRING","'REMOTE_ADDR'",143],"]",["T_WHITESPACE"," ",143],")",["T_WHITESPACE"," ",143],")",["T_WHITESPACE"," ",143],"{",["T_WHITESPACE","\n\t\t\t",143],["T_VARIABLE","$session",144],"[",["T_CONSTANT_ENCAPSED_STRING","'ip'",144],"]",["T_WHITESPACE"," ",144],"=",["T_WHITESPACE"," ",144],["T_VARIABLE","$_SERVER",144],"[",["T_CONSTANT_ENCAPSED_STRING","'REMOTE_ADDR'",144],"]",";",["T_WHITESPACE","\n\t\t",144],"}",["T_WHITESPACE","\n\n\t\t",145],["T_COMMENT","\/\/ User-agent.\n",147],["T_WHITESPACE","\t\t",148],["T_IF","if",148],["T_WHITESPACE"," ",148],"(",["T_WHITESPACE"," ",148],"!",["T_WHITESPACE"," ",148],["T_EMPTY","empty",148],"(",["T_WHITESPACE"," ",148],["T_VARIABLE","$_SERVER",148],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_USER_AGENT'",148],"]",["T_WHITESPACE"," ",148],")",["T_WHITESPACE"," ",148],")",["T_WHITESPACE"," ",148],"{",["T_WHITESPACE","\n\t\t\t",148],["T_VARIABLE","$session",149],"[",["T_CONSTANT_ENCAPSED_STRING","'ua'",149],"]",["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_STRING","wp_unslash",149],"(",["T_WHITESPACE"," ",149],["T_VARIABLE","$_SERVER",149],"[",["T_CONSTANT_ENCAPSED_STRING","'HTTP_USER_AGENT'",149],"]",["T_WHITESPACE"," ",149],")",";",["T_WHITESPACE","\n\t\t",149],"}",["T_WHITESPACE","\n\n\t\t",150],["T_COMMENT","\/\/ Timestamp\n",152],["T_WHITESPACE","\t\t",153],["T_VARIABLE","$session",153],"[",["T_CONSTANT_ENCAPSED_STRING","'login'",153],"]",["T_WHITESPACE"," ",153],"=",["T_WHITESPACE"," ",153],["T_STRING","time",153],"(",")",";",["T_WHITESPACE","\n\n\t\t",153],["T_VARIABLE","$token",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_STRING","wp_generate_password",155],"(",["T_WHITESPACE"," ",155],["T_LNUMBER","43",155],",",["T_WHITESPACE"," ",155],["T_STRING","false",155],",",["T_WHITESPACE"," ",155],["T_STRING","false",155],["T_WHITESPACE"," ",155],")",";",["T_WHITESPACE","\n\n\t\t",155],["T_VARIABLE","$this",157],["T_OBJECT_OPERATOR","->",157],["T_STRING","update",157],"(",["T_WHITESPACE"," ",157],["T_VARIABLE","$token",157],",",["T_WHITESPACE"," ",157],["T_VARIABLE","$session",157],["T_WHITESPACE"," ",157],")",";",["T_WHITESPACE","\n\n\t\t",157],["T_RETURN","return",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$token",159],";",["T_WHITESPACE","\n\t",159],"}",["T_WHITESPACE","\n\n\t",160],["T_DOC_COMMENT","\/**\n\t * Update a session token.\n\t *\n\t * @since 4.0.0\n\t * @access public\n\t *\n\t * @param string $token Session token to update.\n\t * @param array  $session Session information.\n\t *\/",162],["T_WHITESPACE","\n\t",170],["T_FINAL","final",171],["T_WHITESPACE"," ",171],["T_PUBLIC","public",171],["T_WHITESPACE"," ",171],["T_FUNCTION","function",171],["T_WHITESPACE"," ",171],["T_STRING","update",171],"(",["T_WHITESPACE"," ",171],["T_VARIABLE","$token",171],",",["T_WHITESPACE"," ",171],["T_VARIABLE","$session",171],["T_WHITESPACE"," ",171],")",["T_WHITESPACE"," ",171],"{",["T_WHITESPACE","\n\t\t",171],["T_VARIABLE","$verifier",172],["T_WHITESPACE"," ",172],"=",["T_WHITESPACE"," ",172],["T_VARIABLE","$this",172],["T_OBJECT_OPERATOR","->",172],["T_STRING","hash_token",172],"(",["T_WHITESPACE"," ",172],["T_VARIABLE","$token",172],["T_WHITESPACE"," ",172],")",";",["T_WHITESPACE","\n\t\t",172],["T_VARIABLE","$this",173],["T_OBJECT_OPERATOR","->",173],["T_STRING","update_session",173],"(",["T_WHITESPACE"," ",173],["T_VARIABLE","$verifier",173],",",["T_WHITESPACE"," ",173],["T_VARIABLE","$session",173],["T_WHITESPACE"," ",173],")",";",["T_WHITESPACE","\n\t",173],"}",["T_WHITESPACE","\n\n\t",174],["T_DOC_COMMENT","\/**\n\t * Destroy a session token.\n\t *\n\t * @since 4.0.0\n\t * @access public\n\t *\n\t * @param string $token Session token to destroy.\n\t *\/",176],["T_WHITESPACE","\n\t",183],["T_FINAL","final",184],["T_WHITESPACE"," ",184],["T_PUBLIC","public",184],["T_WHITESPACE"," ",184],["T_FUNCTION","function",184],["T_WHITESPACE"," ",184],["T_STRING","destroy",184],"(",["T_WHITESPACE"," ",184],["T_VARIABLE","$token",184],["T_WHITESPACE"," ",184],")",["T_WHITESPACE"," ",184],"{",["T_WHITESPACE","\n\t\t",184],["T_VARIABLE","$verifier",185],["T_WHITESPACE"," ",185],"=",["T_WHITESPACE"," ",185],["T_VARIABLE","$this",185],["T_OBJECT_OPERATOR","->",185],["T_STRING","hash_token",185],"(",["T_WHITESPACE"," ",185],["T_VARIABLE","$token",185],["T_WHITESPACE"," ",185],")",";",["T_WHITESPACE","\n\t\t",185],["T_VARIABLE","$this",186],["T_OBJECT_OPERATOR","->",186],["T_STRING","update_session",186],"(",["T_WHITESPACE"," ",186],["T_VARIABLE","$verifier",186],",",["T_WHITESPACE"," ",186],["T_STRING","null",186],["T_WHITESPACE"," ",186],")",";",["T_WHITESPACE","\n\t",186],"}",["T_WHITESPACE","\n\n\t",187],["T_DOC_COMMENT","\/**\n\t * Destroy all session tokens for this user,\n\t * except a single token, presumably the one in use.\n\t *\n\t * @since 4.0.0\n\t * @access public\n\t *\n\t * @param string $token_to_keep Session token to keep.\n\t *\/",189],["T_WHITESPACE","\n\t",197],["T_FINAL","final",198],["T_WHITESPACE"," ",198],["T_PUBLIC","public",198],["T_WHITESPACE"," ",198],["T_FUNCTION","function",198],["T_WHITESPACE"," ",198],["T_STRING","destroy_others",198],"(",["T_WHITESPACE"," ",198],["T_VARIABLE","$token_to_keep",198],["T_WHITESPACE"," ",198],")",["T_WHITESPACE"," ",198],"{",["T_WHITESPACE","\n\t\t",198],["T_VARIABLE","$verifier",199],["T_WHITESPACE"," ",199],"=",["T_WHITESPACE"," ",199],["T_VARIABLE","$this",199],["T_OBJECT_OPERATOR","->",199],["T_STRING","hash_token",199],"(",["T_WHITESPACE"," ",199],["T_VARIABLE","$token_to_keep",199],["T_WHITESPACE"," ",199],")",";",["T_WHITESPACE","\n\t\t",199],["T_VARIABLE","$session",200],["T_WHITESPACE"," ",200],"=",["T_WHITESPACE"," ",200],["T_VARIABLE","$this",200],["T_OBJECT_OPERATOR","->",200],["T_STRING","get_session",200],"(",["T_WHITESPACE"," ",200],["T_VARIABLE","$verifier",200],["T_WHITESPACE"," ",200],")",";",["T_WHITESPACE","\n\t\t",200],["T_IF","if",201],["T_WHITESPACE"," ",201],"(",["T_WHITESPACE"," ",201],["T_VARIABLE","$session",201],["T_WHITESPACE"," ",201],")",["T_WHITESPACE"," ",201],"{",["T_WHITESPACE","\n\t\t\t",201],["T_VARIABLE","$this",202],["T_OBJECT_OPERATOR","->",202],["T_STRING","destroy_other_sessions",202],"(",["T_WHITESPACE"," ",202],["T_VARIABLE","$verifier",202],["T_WHITESPACE"," ",202],")",";",["T_WHITESPACE","\n\t\t",202],"}",["T_WHITESPACE"," ",203],["T_ELSE","else",203],["T_WHITESPACE"," ",203],"{",["T_WHITESPACE","\n\t\t\t",203],["T_VARIABLE","$this",204],["T_OBJECT_OPERATOR","->",204],["T_STRING","destroy_all_sessions",204],"(",")",";",["T_WHITESPACE","\n\t\t",204],"}",["T_WHITESPACE","\n\t",205],"}",["T_WHITESPACE","\n\n\t",206],["T_DOC_COMMENT","\/**\n\t * Determine whether a session token is still valid,\n\t * based on expiration.\n\t *\n\t * @since 4.0.0\n\t * @access protected\n\t *\n\t * @param array $session Session to check.\n\t * @return bool Whether session is valid.\n\t *\/",208],["T_WHITESPACE","\n\t",217],["T_FINAL","final",218],["T_WHITESPACE"," ",218],["T_PROTECTED","protected",218],["T_WHITESPACE"," ",218],["T_FUNCTION","function",218],["T_WHITESPACE"," ",218],["T_STRING","is_still_valid",218],"(",["T_WHITESPACE"," ",218],["T_VARIABLE","$session",218],["T_WHITESPACE"," ",218],")",["T_WHITESPACE"," ",218],"{",["T_WHITESPACE","\n\t\t",218],["T_RETURN","return",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$session",219],"[",["T_CONSTANT_ENCAPSED_STRING","'expiration'",219],"]",["T_WHITESPACE"," ",219],["T_IS_GREATER_OR_EQUAL",">=",219],["T_WHITESPACE"," ",219],["T_STRING","time",219],"(",")",";",["T_WHITESPACE","\n\t",219],"}",["T_WHITESPACE","\n\n\t",220],["T_DOC_COMMENT","\/**\n\t * Destroy all session tokens for a user.\n\t *\n\t * @since 4.0.0\n\t * @access public\n\t *\/",222],["T_WHITESPACE","\n\t",227],["T_FINAL","final",228],["T_WHITESPACE"," ",228],["T_PUBLIC","public",228],["T_WHITESPACE"," ",228],["T_FUNCTION","function",228],["T_WHITESPACE"," ",228],["T_STRING","destroy_all",228],"(",")",["T_WHITESPACE"," ",228],"{",["T_WHITESPACE","\n\t\t",228],["T_VARIABLE","$this",229],["T_OBJECT_OPERATOR","->",229],["T_STRING","destroy_all_sessions",229],"(",")",";",["T_WHITESPACE","\n\t",229],"}",["T_WHITESPACE","\n\n\t",230],["T_DOC_COMMENT","\/**\n\t * Destroy all session tokens for all users.\n\t *\n\t * @since 4.0.0\n\t * @access public\n\t * @static\n\t *\/",232],["T_WHITESPACE","\n\t",238],["T_FINAL","final",239],["T_WHITESPACE"," ",239],["T_PUBLIC","public",239],["T_WHITESPACE"," ",239],["T_STATIC","static",239],["T_WHITESPACE"," ",239],["T_FUNCTION","function",239],["T_WHITESPACE"," ",239],["T_STRING","destroy_all_for_all_users",239],"(",")",["T_WHITESPACE"," ",239],"{",["T_WHITESPACE","\n\t\t",239],["T_DOC_COMMENT","\/** This filter is documented in wp-includes\/class-wp-session-tokens.php *\/",240],["T_WHITESPACE","\n\t\t",240],["T_VARIABLE","$manager",241],["T_WHITESPACE"," ",241],"=",["T_WHITESPACE"," ",241],["T_STRING","apply_filters",241],"(",["T_WHITESPACE"," ",241],["T_CONSTANT_ENCAPSED_STRING","'session_token_manager'",241],",",["T_WHITESPACE"," ",241],["T_CONSTANT_ENCAPSED_STRING","'WP_User_Meta_Session_Tokens'",241],["T_WHITESPACE"," ",241],")",";",["T_WHITESPACE","\n\t\t",241],["T_STRING","call_user_func",242],"(",["T_WHITESPACE"," ",242],["T_ARRAY","array",242],"(",["T_WHITESPACE"," ",242],["T_VARIABLE","$manager",242],",",["T_WHITESPACE"," ",242],["T_CONSTANT_ENCAPSED_STRING","'drop_sessions'",242],["T_WHITESPACE"," ",242],")",["T_WHITESPACE"," ",242],")",";",["T_WHITESPACE","\n\t",242],"}",["T_WHITESPACE","\n\n\t",243],["T_DOC_COMMENT","\/**\n\t * Retrieve all sessions of a user.\n\t *\n\t * @since 4.0.0\n\t * @access public\n\t *\n\t * @return array Sessions of a user.\n\t *\/",245],["T_WHITESPACE","\n\t",252],["T_FINAL","final",253],["T_WHITESPACE"," ",253],["T_PUBLIC","public",253],["T_WHITESPACE"," ",253],["T_FUNCTION","function",253],["T_WHITESPACE"," ",253],["T_STRING","get_all",253],"(",")",["T_WHITESPACE"," ",253],"{",["T_WHITESPACE","\n\t\t",253],["T_RETURN","return",254],["T_WHITESPACE"," ",254],["T_STRING","array_values",254],"(",["T_WHITESPACE"," ",254],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","get_sessions",254],"(",")",["T_WHITESPACE"," ",254],")",";",["T_WHITESPACE","\n\t",254],"}",["T_WHITESPACE","\n\n\t",255],["T_DOC_COMMENT","\/**\n\t * This method should retrieve all sessions of a user, keyed by verifier.\n\t *\n\t * @since 4.0.0\n\t * @access protected\n\t *\n\t * @return array Sessions of a user, keyed by verifier.\n\t *\/",257],["T_WHITESPACE","\n\t",264],["T_ABSTRACT","abstract",265],["T_WHITESPACE"," ",265],["T_PROTECTED","protected",265],["T_WHITESPACE"," ",265],["T_FUNCTION","function",265],["T_WHITESPACE"," ",265],["T_STRING","get_sessions",265],"(",")",";",["T_WHITESPACE","\n\n\t",265],["T_DOC_COMMENT","\/**\n\t * This method should look up a session by its verifier (token hash).\n\t *\n\t * @since 4.0.0\n\t * @access protected\n\t *\n\t * @param string $verifier Verifier of the session to retrieve.\n\t * @return array|null The session, or null if it does not exist.\n\t *\/",267],["T_WHITESPACE","\n\t",275],["T_ABSTRACT","abstract",276],["T_WHITESPACE"," ",276],["T_PROTECTED","protected",276],["T_WHITESPACE"," ",276],["T_FUNCTION","function",276],["T_WHITESPACE"," ",276],["T_STRING","get_session",276],"(",["T_WHITESPACE"," ",276],["T_VARIABLE","$verifier",276],["T_WHITESPACE"," ",276],")",";",["T_WHITESPACE","\n\n\t",276],["T_DOC_COMMENT","\/**\n\t * This method should update a session by its verifier.\n\t *\n\t * Omitting the second argument should destroy the session.\n\t *\n\t * @since 4.0.0\n\t * @access protected\n\t *\n\t * @param string $verifier Verifier of the session to update.\n\t * @param array  $session  Optional. Session. Omitting this argument destroys the session.\n\t *\/",278],["T_WHITESPACE","\n\t",288],["T_ABSTRACT","abstract",289],["T_WHITESPACE"," ",289],["T_PROTECTED","protected",289],["T_WHITESPACE"," ",289],["T_FUNCTION","function",289],["T_WHITESPACE"," ",289],["T_STRING","update_session",289],"(",["T_WHITESPACE"," ",289],["T_VARIABLE","$verifier",289],",",["T_WHITESPACE"," ",289],["T_VARIABLE","$session",289],["T_WHITESPACE"," ",289],"=",["T_WHITESPACE"," ",289],["T_STRING","null",289],["T_WHITESPACE"," ",289],")",";",["T_WHITESPACE","\n\n\t",289],["T_DOC_COMMENT","\/**\n\t * This method should destroy all session tokens for this user,\n\t * except a single session passed.\n\t *\n\t * @since 4.0.0\n\t * @access protected\n\t *\n\t * @param string $verifier Verifier of the session to keep.\n\t *\/",291],["T_WHITESPACE","\n\t",299],["T_ABSTRACT","abstract",300],["T_WHITESPACE"," ",300],["T_PROTECTED","protected",300],["T_WHITESPACE"," ",300],["T_FUNCTION","function",300],["T_WHITESPACE"," ",300],["T_STRING","destroy_other_sessions",300],"(",["T_WHITESPACE"," ",300],["T_VARIABLE","$verifier",300],["T_WHITESPACE"," ",300],")",";",["T_WHITESPACE","\n\n\t",300],["T_DOC_COMMENT","\/**\n\t * This method should destroy all sessions for a user.\n\t *\n\t * @since 4.0.0\n\t * @access protected\n\t *\/",302],["T_WHITESPACE","\n\t",307],["T_ABSTRACT","abstract",308],["T_WHITESPACE"," ",308],["T_PROTECTED","protected",308],["T_WHITESPACE"," ",308],["T_FUNCTION","function",308],["T_WHITESPACE"," ",308],["T_STRING","destroy_all_sessions",308],"(",")",";",["T_WHITESPACE","\n\n\t",308],["T_DOC_COMMENT","\/**\n\t * This static method should destroy all session tokens for all users.\n\t *\n\t * @since 4.0.0\n\t * @access public\n\t * @static\n\t *\/",310],["T_WHITESPACE","\n\t",316],["T_PUBLIC","public",317],["T_WHITESPACE"," ",317],["T_STATIC","static",317],["T_WHITESPACE"," ",317],["T_FUNCTION","function",317],["T_WHITESPACE"," ",317],["T_STRING","drop_sessions",317],"(",")",["T_WHITESPACE"," ",317],"{","}",["T_WHITESPACE","\n",317],"}",["T_WHITESPACE","\n",318]]