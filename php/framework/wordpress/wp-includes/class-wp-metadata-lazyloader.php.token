[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Meta API: WP_Metadata_Lazyloader class\n *\n * @package WordPress\n * @subpackage Meta\n * @since 4.5.0\n *\/",2],["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * Core class used for lazy-loading object metadata.\n *\n * When loading many objects of a given type, such as posts in a WP_Query loop, it often makes\n * sense to prime various metadata caches at the beginning of the loop. This means fetching all\n * relevant metadata with a single database query, a technique that has the potential to improve\n * performance dramatically in some cases.\n *\n * In cases where the given metadata may not even be used in the loop, we can improve performance\n * even more by only priming the metadata cache for affected items the first time a piece of metadata\n * is requested - ie, by lazy-loading it. So, for example, comment meta may not be loaded into the\n * cache in the comments section of a post until the first time get_comment_meta() is called in the\n * context of the comment loop.\n *\n * WP uses the WP_Metadata_Lazyloader class to queue objects for metadata cache priming. The class\n * then detects the relevant get_*_meta() function call, and queries the metadata of all queued objects.\n *\n * Do not access this class directly. Use the wp_metadata_lazyloader() function.\n *\n * @since 4.5.0\n *\/",10],["T_WHITESPACE","\n",30],["T_CLASS","class",31],["T_WHITESPACE"," ",31],["T_STRING","WP_Metadata_Lazyloader",31],["T_WHITESPACE"," ",31],"{",["T_WHITESPACE","\n\t",31],["T_DOC_COMMENT","\/**\n\t * Pending objects queue.\n\t *\n\t * @since 4.5.0\n\t * @access protected\n\t * @var array\n\t *\/",32],["T_WHITESPACE","\n\t",38],["T_PROTECTED","protected",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$pending_objects",39],";",["T_WHITESPACE","\n\n\t",39],["T_DOC_COMMENT","\/**\n\t * Settings for supported object types.\n\t *\n\t * @since 4.5.0\n\t * @access protected\n\t * @var array\n\t *\/",41],["T_WHITESPACE","\n\t",47],["T_PROTECTED","protected",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$settings",48],["T_WHITESPACE"," ",48],"=",["T_WHITESPACE"," ",48],["T_ARRAY","array",48],"(",")",";",["T_WHITESPACE","\n\n\t",48],["T_DOC_COMMENT","\/**\n\t * Constructor.\n\t *\n\t * @since 4.5.0\n\t * @access public\n\t *\/",50],["T_WHITESPACE","\n\t",55],["T_PUBLIC","public",56],["T_WHITESPACE"," ",56],["T_FUNCTION","function",56],["T_WHITESPACE"," ",56],["T_STRING","__construct",56],"(",")",["T_WHITESPACE"," ",56],"{",["T_WHITESPACE","\n\t\t",56],["T_VARIABLE","$this",57],["T_OBJECT_OPERATOR","->",57],["T_STRING","settings",57],["T_WHITESPACE"," ",57],"=",["T_WHITESPACE"," ",57],["T_ARRAY","array",57],"(",["T_WHITESPACE","\n\t\t\t",57],["T_CONSTANT_ENCAPSED_STRING","'term'",58],["T_WHITESPACE"," ",58],["T_DOUBLE_ARROW","=>",58],["T_WHITESPACE"," ",58],["T_ARRAY","array",58],"(",["T_WHITESPACE","\n\t\t\t\t",58],["T_CONSTANT_ENCAPSED_STRING","'filter'",59],["T_WHITESPACE","   ",59],["T_DOUBLE_ARROW","=>",59],["T_WHITESPACE"," ",59],["T_CONSTANT_ENCAPSED_STRING","'get_term_metadata'",59],",",["T_WHITESPACE","\n\t\t\t\t",59],["T_CONSTANT_ENCAPSED_STRING","'callback'",60],["T_WHITESPACE"," ",60],["T_DOUBLE_ARROW","=>",60],["T_WHITESPACE"," ",60],["T_ARRAY","array",60],"(",["T_WHITESPACE"," ",60],["T_VARIABLE","$this",60],",",["T_WHITESPACE"," ",60],["T_CONSTANT_ENCAPSED_STRING","'lazyload_term_meta'",60],["T_WHITESPACE"," ",60],")",",",["T_WHITESPACE","\n\t\t\t",60],")",",",["T_WHITESPACE","\n\t\t\t",61],["T_CONSTANT_ENCAPSED_STRING","'comment'",62],["T_WHITESPACE"," ",62],["T_DOUBLE_ARROW","=>",62],["T_WHITESPACE"," ",62],["T_ARRAY","array",62],"(",["T_WHITESPACE","\n\t\t\t\t",62],["T_CONSTANT_ENCAPSED_STRING","'filter'",63],["T_WHITESPACE","   ",63],["T_DOUBLE_ARROW","=>",63],["T_WHITESPACE"," ",63],["T_CONSTANT_ENCAPSED_STRING","'get_comment_metadata'",63],",",["T_WHITESPACE","\n\t\t\t\t",63],["T_CONSTANT_ENCAPSED_STRING","'callback'",64],["T_WHITESPACE"," ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_ARRAY","array",64],"(",["T_WHITESPACE"," ",64],["T_VARIABLE","$this",64],",",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'lazyload_comment_meta'",64],["T_WHITESPACE"," ",64],")",",",["T_WHITESPACE","\n\t\t\t",64],")",",",["T_WHITESPACE","\n\t\t",65],")",";",["T_WHITESPACE","\n\t",66],"}",["T_WHITESPACE","\n\n\t",67],["T_DOC_COMMENT","\/**\n\t * Adds objects to the metadata lazy-load queue.\n\t *\n\t * @since 4.5.0\n\t * @access public\n\t *\n\t * @param string $object_type Type of object whose meta is to be lazy-loaded. Accepts 'term' or 'comment'.\n\t * @param array  $object_ids  Array of object IDs.\n\t * @return bool|WP_Error True on success, WP_Error on failure.\n\t *\/",69],["T_WHITESPACE","\n\t",78],["T_PUBLIC","public",79],["T_WHITESPACE"," ",79],["T_FUNCTION","function",79],["T_WHITESPACE"," ",79],["T_STRING","queue_objects",79],"(",["T_WHITESPACE"," ",79],["T_VARIABLE","$object_type",79],",",["T_WHITESPACE"," ",79],["T_VARIABLE","$object_ids",79],["T_WHITESPACE"," ",79],")",["T_WHITESPACE"," ",79],"{",["T_WHITESPACE","\n\t\t",79],["T_IF","if",80],["T_WHITESPACE"," ",80],"(",["T_WHITESPACE"," ",80],"!",["T_WHITESPACE"," ",80],["T_ISSET","isset",80],"(",["T_WHITESPACE"," ",80],["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","settings",80],"[",["T_WHITESPACE"," ",80],["T_VARIABLE","$object_type",80],["T_WHITESPACE"," ",80],"]",["T_WHITESPACE"," ",80],")",["T_WHITESPACE"," ",80],")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n\t\t\t",80],["T_RETURN","return",81],["T_WHITESPACE"," ",81],["T_NEW","new",81],["T_WHITESPACE"," ",81],["T_STRING","WP_Error",81],"(",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'invalid_object_type'",81],",",["T_WHITESPACE"," ",81],["T_STRING","__",81],"(",["T_WHITESPACE"," ",81],["T_CONSTANT_ENCAPSED_STRING","'Invalid object type'",81],["T_WHITESPACE"," ",81],")",["T_WHITESPACE"," ",81],")",";",["T_WHITESPACE","\n\t\t",81],"}",["T_WHITESPACE","\n\n\t\t",82],["T_VARIABLE","$type_settings",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","settings",84],"[",["T_WHITESPACE"," ",84],["T_VARIABLE","$object_type",84],["T_WHITESPACE"," ",84],"]",";",["T_WHITESPACE","\n\n\t\t",84],["T_IF","if",86],["T_WHITESPACE"," ",86],"(",["T_WHITESPACE"," ",86],"!",["T_WHITESPACE"," ",86],["T_ISSET","isset",86],"(",["T_WHITESPACE"," ",86],["T_VARIABLE","$this",86],["T_OBJECT_OPERATOR","->",86],["T_STRING","pending_objects",86],"[",["T_WHITESPACE"," ",86],["T_VARIABLE","$object_type",86],["T_WHITESPACE"," ",86],"]",["T_WHITESPACE"," ",86],")",["T_WHITESPACE"," ",86],")",["T_WHITESPACE"," ",86],"{",["T_WHITESPACE","\n\t\t\t",86],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","pending_objects",87],"[",["T_WHITESPACE"," ",87],["T_VARIABLE","$object_type",87],["T_WHITESPACE"," ",87],"]",["T_WHITESPACE"," ",87],"=",["T_WHITESPACE"," ",87],["T_ARRAY","array",87],"(",")",";",["T_WHITESPACE","\n\t\t",87],"}",["T_WHITESPACE","\n\n\t\t",88],["T_FOREACH","foreach",90],["T_WHITESPACE"," ",90],"(",["T_WHITESPACE"," ",90],["T_VARIABLE","$object_ids",90],["T_WHITESPACE"," ",90],["T_AS","as",90],["T_WHITESPACE"," ",90],["T_VARIABLE","$object_id",90],["T_WHITESPACE"," ",90],")",["T_WHITESPACE"," ",90],"{",["T_WHITESPACE","\n\t\t\t",90],["T_COMMENT","\/\/ Keyed by ID for faster lookup.\n",91],["T_WHITESPACE","\t\t\t",92],["T_IF","if",92],["T_WHITESPACE"," ",92],"(",["T_WHITESPACE"," ",92],"!",["T_WHITESPACE"," ",92],["T_ISSET","isset",92],"(",["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","pending_objects",92],"[",["T_WHITESPACE"," ",92],["T_VARIABLE","$object_type",92],["T_WHITESPACE"," ",92],"]","[",["T_WHITESPACE"," ",92],["T_VARIABLE","$object_id",92],["T_WHITESPACE"," ",92],"]",["T_WHITESPACE"," ",92],")",["T_WHITESPACE"," ",92],")",["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n\t\t\t\t",92],["T_VARIABLE","$this",93],["T_OBJECT_OPERATOR","->",93],["T_STRING","pending_objects",93],"[",["T_WHITESPACE"," ",93],["T_VARIABLE","$object_type",93],["T_WHITESPACE"," ",93],"]","[",["T_WHITESPACE"," ",93],["T_VARIABLE","$object_id",93],["T_WHITESPACE"," ",93],"]",["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_LNUMBER","1",93],";",["T_WHITESPACE","\n\t\t\t",93],"}",["T_WHITESPACE","\n\t\t",94],"}",["T_WHITESPACE","\n\n\t\t",95],["T_STRING","add_filter",97],"(",["T_WHITESPACE"," ",97],["T_VARIABLE","$type_settings",97],"[",["T_CONSTANT_ENCAPSED_STRING","'filter'",97],"]",",",["T_WHITESPACE"," ",97],["T_VARIABLE","$type_settings",97],"[",["T_CONSTANT_ENCAPSED_STRING","'callback'",97],"]",["T_WHITESPACE"," ",97],")",";",["T_WHITESPACE","\n\n\t\t",97],["T_DOC_COMMENT","\/**\n\t\t * Fires after objects are added to the metadata lazy-load queue.\n\t\t *\n\t\t * @since 4.5.0\n\t\t *\n\t\t * @param array                  $object_ids  Object IDs.\n\t\t * @param string                 $object_type Type of object being queued.\n\t\t * @param WP_Metadata_Lazyloader $lazyloader  The lazy-loader object.\n\t\t *\/",99],["T_WHITESPACE","\n\t\t",107],["T_STRING","do_action",108],"(",["T_WHITESPACE"," ",108],["T_CONSTANT_ENCAPSED_STRING","'metadata_lazyloader_queued_objects'",108],",",["T_WHITESPACE"," ",108],["T_VARIABLE","$object_ids",108],",",["T_WHITESPACE"," ",108],["T_VARIABLE","$object_type",108],",",["T_WHITESPACE"," ",108],["T_VARIABLE","$this",108],["T_WHITESPACE"," ",108],")",";",["T_WHITESPACE","\n\t",108],"}",["T_WHITESPACE","\n\n\t",109],["T_DOC_COMMENT","\/**\n\t * Resets lazy-load queue for a given object type.\n\t *\n\t * @since 4.5.0\n\t * @access public\n\t *\n\t * @param string $object_type Object type. Accepts 'comment' or 'term'.\n\t * @return bool|WP_Error True on success, WP_Error on failure.\n\t *\/",111],["T_WHITESPACE","\n\t",119],["T_PUBLIC","public",120],["T_WHITESPACE"," ",120],["T_FUNCTION","function",120],["T_WHITESPACE"," ",120],["T_STRING","reset_queue",120],"(",["T_WHITESPACE"," ",120],["T_VARIABLE","$object_type",120],["T_WHITESPACE"," ",120],")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n\t\t",120],["T_IF","if",121],["T_WHITESPACE"," ",121],"(",["T_WHITESPACE"," ",121],"!",["T_WHITESPACE"," ",121],["T_ISSET","isset",121],"(",["T_WHITESPACE"," ",121],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","settings",121],"[",["T_WHITESPACE"," ",121],["T_VARIABLE","$object_type",121],["T_WHITESPACE"," ",121],"]",["T_WHITESPACE"," ",121],")",["T_WHITESPACE"," ",121],")",["T_WHITESPACE"," ",121],"{",["T_WHITESPACE","\n\t\t\t",121],["T_RETURN","return",122],["T_WHITESPACE"," ",122],["T_NEW","new",122],["T_WHITESPACE"," ",122],["T_STRING","WP_Error",122],"(",["T_WHITESPACE"," ",122],["T_CONSTANT_ENCAPSED_STRING","'invalid_object_type'",122],",",["T_WHITESPACE"," ",122],["T_STRING","__",122],"(",["T_WHITESPACE"," ",122],["T_CONSTANT_ENCAPSED_STRING","'Invalid object type'",122],["T_WHITESPACE"," ",122],")",["T_WHITESPACE"," ",122],")",";",["T_WHITESPACE","\n\t\t",122],"}",["T_WHITESPACE","\n\n\t\t",123],["T_VARIABLE","$type_settings",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","settings",125],"[",["T_WHITESPACE"," ",125],["T_VARIABLE","$object_type",125],["T_WHITESPACE"," ",125],"]",";",["T_WHITESPACE","\n\n\t\t",125],["T_VARIABLE","$this",127],["T_OBJECT_OPERATOR","->",127],["T_STRING","pending_objects",127],"[",["T_WHITESPACE"," ",127],["T_VARIABLE","$object_type",127],["T_WHITESPACE"," ",127],"]",["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_ARRAY","array",127],"(",")",";",["T_WHITESPACE","\n\t\t",127],["T_STRING","remove_filter",128],"(",["T_WHITESPACE"," ",128],["T_VARIABLE","$type_settings",128],"[",["T_CONSTANT_ENCAPSED_STRING","'filter'",128],"]",",",["T_WHITESPACE"," ",128],["T_VARIABLE","$type_settings",128],"[",["T_CONSTANT_ENCAPSED_STRING","'callback'",128],"]",["T_WHITESPACE"," ",128],")",";",["T_WHITESPACE","\n\t",128],"}",["T_WHITESPACE","\n\n\t",129],["T_DOC_COMMENT","\/**\n\t * Lazy-loads term meta for queued terms.\n\t *\n\t * This method is public so that it can be used as a filter callback. As a rule, there\n\t * is no need to invoke it directly.\n\t *\n\t * @since 4.5.0\n\t * @access public\n\t *\n\t * @param mixed $check The `$check` param passed from the 'get_term_metadata' hook.\n\t * @return mixed In order not to short-circuit `get_metadata()`. Generally, this is `null`, but it could be\n\t *               another value if filtered by a plugin.\n\t *\/",131],["T_WHITESPACE","\n\t",143],["T_PUBLIC","public",144],["T_WHITESPACE"," ",144],["T_FUNCTION","function",144],["T_WHITESPACE"," ",144],["T_STRING","lazyload_term_meta",144],"(",["T_WHITESPACE"," ",144],["T_VARIABLE","$check",144],["T_WHITESPACE"," ",144],")",["T_WHITESPACE"," ",144],"{",["T_WHITESPACE","\n\t\t",144],["T_IF","if",145],["T_WHITESPACE"," ",145],"(",["T_WHITESPACE"," ",145],"!",["T_WHITESPACE"," ",145],["T_EMPTY","empty",145],"(",["T_WHITESPACE"," ",145],["T_VARIABLE","$this",145],["T_OBJECT_OPERATOR","->",145],["T_STRING","pending_objects",145],"[",["T_CONSTANT_ENCAPSED_STRING","'term'",145],"]",["T_WHITESPACE"," ",145],")",["T_WHITESPACE"," ",145],")",["T_WHITESPACE"," ",145],"{",["T_WHITESPACE","\n\t\t\t",145],["T_STRING","update_termmeta_cache",146],"(",["T_WHITESPACE"," ",146],["T_STRING","array_keys",146],"(",["T_WHITESPACE"," ",146],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","pending_objects",146],"[",["T_CONSTANT_ENCAPSED_STRING","'term'",146],"]",["T_WHITESPACE"," ",146],")",["T_WHITESPACE"," ",146],")",";",["T_WHITESPACE","\n\n\t\t\t",146],["T_COMMENT","\/\/ No need to run again for this set of terms.\n",148],["T_WHITESPACE","\t\t\t",149],["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","reset_queue",149],"(",["T_WHITESPACE"," ",149],["T_CONSTANT_ENCAPSED_STRING","'term'",149],["T_WHITESPACE"," ",149],")",";",["T_WHITESPACE","\n\t\t",149],"}",["T_WHITESPACE","\n\n\t\t",150],["T_RETURN","return",152],["T_WHITESPACE"," ",152],["T_VARIABLE","$check",152],";",["T_WHITESPACE","\n\t",152],"}",["T_WHITESPACE","\n\n\t",153],["T_DOC_COMMENT","\/**\n\t * Lazy-loads comment meta for queued comments.\n\t *\n\t * This method is public so that it can be used as a filter callback. As a rule, there is no need to invoke it\n\t * directly, from either inside or outside the `WP_Query` object.\n\t *\n\t * @since 4.5.0\n\t *\n\t * @param mixed $check The `$check` param passed from the {@see 'get_comment_metadata'} hook.\n\t * @return mixed The original value of `$check`, so as not to short-circuit `get_comment_metadata()`.\n\t *\/",155],["T_WHITESPACE","\n\t",165],["T_PUBLIC","public",166],["T_WHITESPACE"," ",166],["T_FUNCTION","function",166],["T_WHITESPACE"," ",166],["T_STRING","lazyload_comment_meta",166],"(",["T_WHITESPACE"," ",166],["T_VARIABLE","$check",166],["T_WHITESPACE"," ",166],")",["T_WHITESPACE"," ",166],"{",["T_WHITESPACE","\n\t\t",166],["T_IF","if",167],["T_WHITESPACE"," ",167],"(",["T_WHITESPACE"," ",167],"!",["T_WHITESPACE"," ",167],["T_EMPTY","empty",167],"(",["T_WHITESPACE"," ",167],["T_VARIABLE","$this",167],["T_OBJECT_OPERATOR","->",167],["T_STRING","pending_objects",167],"[",["T_CONSTANT_ENCAPSED_STRING","'comment'",167],"]",["T_WHITESPACE"," ",167],")",["T_WHITESPACE"," ",167],")",["T_WHITESPACE"," ",167],"{",["T_WHITESPACE","\n\t\t\t",167],["T_STRING","update_meta_cache",168],"(",["T_WHITESPACE"," ",168],["T_CONSTANT_ENCAPSED_STRING","'comment'",168],",",["T_WHITESPACE"," ",168],["T_STRING","array_keys",168],"(",["T_WHITESPACE"," ",168],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","pending_objects",168],"[",["T_CONSTANT_ENCAPSED_STRING","'comment'",168],"]",["T_WHITESPACE"," ",168],")",["T_WHITESPACE"," ",168],")",";",["T_WHITESPACE","\n\n\t\t\t",168],["T_COMMENT","\/\/ No need to run again for this set of comments.\n",170],["T_WHITESPACE","\t\t\t",171],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","reset_queue",171],"(",["T_WHITESPACE"," ",171],["T_CONSTANT_ENCAPSED_STRING","'comment'",171],["T_WHITESPACE"," ",171],")",";",["T_WHITESPACE","\n\t\t",171],"}",["T_WHITESPACE","\n\n\t\t",172],["T_RETURN","return",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$check",174],";",["T_WHITESPACE","\n\t",174],"}",["T_WHITESPACE","\n",175],"}",["T_WHITESPACE","\n",176]]