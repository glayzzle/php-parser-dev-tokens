[["T_OPEN_TAG","<?php\n",1],["T_WHITESPACE","\n",2],["T_DOC_COMMENT","\/**\n * Deprecated. Use WP_HTTP (http.php) instead.\n *\/",3],["T_WHITESPACE","\n",5],["T_STRING","_deprecated_file",6],"(",["T_WHITESPACE"," ",6],["T_STRING","basename",6],"(",["T_WHITESPACE"," ",6],["T_FILE","__FILE__",6],["T_WHITESPACE"," ",6],")",",",["T_WHITESPACE"," ",6],["T_CONSTANT_ENCAPSED_STRING","'3.0.0'",6],",",["T_WHITESPACE"," ",6],["T_STRING","WPINC",6],["T_WHITESPACE"," ",6],".",["T_WHITESPACE"," ",6],["T_CONSTANT_ENCAPSED_STRING","'\/http.php'",6],["T_WHITESPACE"," ",6],")",";",["T_WHITESPACE","\n\n",6],["T_IF","if",8],["T_WHITESPACE"," ",8],"(",["T_WHITESPACE"," ",8],"!",["T_WHITESPACE"," ",8],["T_STRING","class_exists",8],"(",["T_WHITESPACE"," ",8],["T_CONSTANT_ENCAPSED_STRING","'Snoopy'",8],",",["T_WHITESPACE"," ",8],["T_STRING","false",8],["T_WHITESPACE"," ",8],")",["T_WHITESPACE"," ",8],")",["T_WHITESPACE"," ",8],":",["T_WHITESPACE","\n",8],["T_COMMENT","\/*************************************************\n\nSnoopy - the PHP net client\nAuthor: Monte Ohrt <monte@ispi.net>\nCopyright (c): 1999-2008 New Digital Group, all rights reserved\nVersion: 1.2.4\n\n * This library is free software; you can redistribute it and\/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2.1 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n\nYou may contact the author of Snoopy by e-mail at:\nmonte@ohrt.com\n\nThe latest version of Snoopy can be obtained from:\nhttp:\/\/snoopy.sourceforge.net\/\n\n*************************************************\/",9],["T_WHITESPACE","\n\n",36],["T_CLASS","class",38],["T_WHITESPACE"," ",38],["T_STRING","Snoopy",38],["T_WHITESPACE","\n",38],"{",["T_WHITESPACE","\n\t",39],["T_COMMENT","\/**** Public variables ****\/",40],["T_WHITESPACE","\n\n\t",40],["T_COMMENT","\/* user definable vars *\/",42],["T_WHITESPACE","\n\n\t",42],["T_VAR","var",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$host",44],["T_WHITESPACE","\t\t\t",44],"=",["T_WHITESPACE","\t",44],["T_CONSTANT_ENCAPSED_STRING","\"www.php.net\"",44],";",["T_WHITESPACE","\t\t",44],["T_COMMENT","\/\/ host name we are connecting to\n",44],["T_WHITESPACE","\t",45],["T_VAR","var",45],["T_WHITESPACE"," ",45],["T_VARIABLE","$port",45],["T_WHITESPACE","\t\t\t",45],"=",["T_WHITESPACE","\t",45],["T_LNUMBER","80",45],";",["T_WHITESPACE","\t\t\t\t\t",45],["T_COMMENT","\/\/ port we are connecting to\n",45],["T_WHITESPACE","\t",46],["T_VAR","var",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$proxy_host",46],["T_WHITESPACE","\t\t",46],"=",["T_WHITESPACE","\t",46],["T_CONSTANT_ENCAPSED_STRING","\"\"",46],";",["T_WHITESPACE","\t\t\t\t\t",46],["T_COMMENT","\/\/ proxy host to use\n",46],["T_WHITESPACE","\t",47],["T_VAR","var",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$proxy_port",47],["T_WHITESPACE","\t\t",47],"=",["T_WHITESPACE","\t",47],["T_CONSTANT_ENCAPSED_STRING","\"\"",47],";",["T_WHITESPACE","\t\t\t\t\t",47],["T_COMMENT","\/\/ proxy port to use\n",47],["T_WHITESPACE","\t",48],["T_VAR","var",48],["T_WHITESPACE"," ",48],["T_VARIABLE","$proxy_user",48],["T_WHITESPACE","\t\t",48],"=",["T_WHITESPACE","\t",48],["T_CONSTANT_ENCAPSED_STRING","\"\"",48],";",["T_WHITESPACE","\t\t\t\t\t",48],["T_COMMENT","\/\/ proxy user to use\n",48],["T_WHITESPACE","\t",49],["T_VAR","var",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$proxy_pass",49],["T_WHITESPACE","\t\t",49],"=",["T_WHITESPACE","\t",49],["T_CONSTANT_ENCAPSED_STRING","\"\"",49],";",["T_WHITESPACE","\t\t\t\t\t",49],["T_COMMENT","\/\/ proxy password to use\n",49],["T_WHITESPACE","\n\t",50],["T_VAR","var",51],["T_WHITESPACE"," ",51],["T_VARIABLE","$agent",51],["T_WHITESPACE","\t\t\t",51],"=",["T_WHITESPACE","\t",51],["T_CONSTANT_ENCAPSED_STRING","\"Snoopy v1.2.4\"",51],";",["T_WHITESPACE","\t",51],["T_COMMENT","\/\/ agent we masquerade as\n",51],["T_WHITESPACE","\t",52],["T_VAR","var",52],["T_WHITESPACE","\t",52],["T_VARIABLE","$referer",52],["T_WHITESPACE","\t\t",52],"=",["T_WHITESPACE","\t",52],["T_CONSTANT_ENCAPSED_STRING","\"\"",52],";",["T_WHITESPACE","\t\t\t\t\t",52],["T_COMMENT","\/\/ referer info to pass\n",52],["T_WHITESPACE","\t",53],["T_VAR","var",53],["T_WHITESPACE"," ",53],["T_VARIABLE","$cookies",53],["T_WHITESPACE","\t\t",53],"=",["T_WHITESPACE","\t",53],["T_ARRAY","array",53],"(",")",";",["T_WHITESPACE","\t\t\t",53],["T_COMMENT","\/\/ array of cookies to pass\n",53],["T_WHITESPACE","\t\t\t\t\t\t\t\t\t\t\t\t",54],["T_COMMENT","\/\/ $cookies[\"username\"]=\"joe\";\n",54],["T_WHITESPACE","\t",55],["T_VAR","var",55],["T_WHITESPACE","\t",55],["T_VARIABLE","$rawheaders",55],["T_WHITESPACE","\t\t",55],"=",["T_WHITESPACE","\t",55],["T_ARRAY","array",55],"(",")",";",["T_WHITESPACE","\t\t\t",55],["T_COMMENT","\/\/ array of raw headers to send\n",55],["T_WHITESPACE","\t\t\t\t\t\t\t\t\t\t\t\t",56],["T_COMMENT","\/\/ $rawheaders[\"Content-type\"]=\"text\/html\";\n",56],["T_WHITESPACE","\n\t",57],["T_VAR","var",58],["T_WHITESPACE"," ",58],["T_VARIABLE","$maxredirs",58],["T_WHITESPACE","\t\t",58],"=",["T_WHITESPACE","\t",58],["T_LNUMBER","5",58],";",["T_WHITESPACE","\t\t\t\t\t",58],["T_COMMENT","\/\/ http redirection depth maximum. 0 = disallow\n",58],["T_WHITESPACE","\t",59],["T_VAR","var",59],["T_WHITESPACE"," ",59],["T_VARIABLE","$lastredirectaddr",59],["T_WHITESPACE","\t",59],"=",["T_WHITESPACE","\t",59],["T_CONSTANT_ENCAPSED_STRING","\"\"",59],";",["T_WHITESPACE","\t\t\t\t",59],["T_COMMENT","\/\/ contains address of last redirected address\n",59],["T_WHITESPACE","\t",60],["T_VAR","var",60],["T_WHITESPACE","\t",60],["T_VARIABLE","$offsiteok",60],["T_WHITESPACE","\t\t",60],"=",["T_WHITESPACE","\t",60],["T_STRING","true",60],";",["T_WHITESPACE","\t\t\t\t",60],["T_COMMENT","\/\/ allows redirection off-site\n",60],["T_WHITESPACE","\t",61],["T_VAR","var",61],["T_WHITESPACE"," ",61],["T_VARIABLE","$maxframes",61],["T_WHITESPACE","\t\t",61],"=",["T_WHITESPACE","\t",61],["T_LNUMBER","0",61],";",["T_WHITESPACE","\t\t\t\t\t",61],["T_COMMENT","\/\/ frame content depth maximum. 0 = disallow\n",61],["T_WHITESPACE","\t",62],["T_VAR","var",62],["T_WHITESPACE"," ",62],["T_VARIABLE","$expandlinks",62],["T_WHITESPACE","\t",62],"=",["T_WHITESPACE","\t",62],["T_STRING","true",62],";",["T_WHITESPACE","\t\t\t\t",62],["T_COMMENT","\/\/ expand links to fully qualified URLs.\n",62],["T_WHITESPACE","\t\t\t\t\t\t\t\t\t\t\t\t",63],["T_COMMENT","\/\/ this only applies to fetchlinks()\n",63],["T_WHITESPACE","\t\t\t\t\t\t\t\t\t\t\t\t",64],["T_COMMENT","\/\/ submitlinks(), and submittext()\n",64],["T_WHITESPACE","\t",65],["T_VAR","var",65],["T_WHITESPACE"," ",65],["T_VARIABLE","$passcookies",65],["T_WHITESPACE","\t",65],"=",["T_WHITESPACE","\t",65],["T_STRING","true",65],";",["T_WHITESPACE","\t\t\t\t",65],["T_COMMENT","\/\/ pass set cookies back through redirects\n",65],["T_WHITESPACE","\t\t\t\t\t\t\t\t\t\t\t\t",66],["T_COMMENT","\/\/ NOTE: this currently does not respect\n",66],["T_WHITESPACE","\t\t\t\t\t\t\t\t\t\t\t\t",67],["T_COMMENT","\/\/ dates, domains or paths.\n",67],["T_WHITESPACE","\n\t",68],["T_VAR","var",69],["T_WHITESPACE","\t",69],["T_VARIABLE","$user",69],["T_WHITESPACE","\t\t\t",69],"=",["T_WHITESPACE","\t",69],["T_CONSTANT_ENCAPSED_STRING","\"\"",69],";",["T_WHITESPACE","\t\t\t\t\t",69],["T_COMMENT","\/\/ user for http authentication\n",69],["T_WHITESPACE","\t",70],["T_VAR","var",70],["T_WHITESPACE","\t",70],["T_VARIABLE","$pass",70],["T_WHITESPACE","\t\t\t",70],"=",["T_WHITESPACE","\t",70],["T_CONSTANT_ENCAPSED_STRING","\"\"",70],";",["T_WHITESPACE","\t\t\t\t\t",70],["T_COMMENT","\/\/ password for http authentication\n",70],["T_WHITESPACE","\n\t",71],["T_COMMENT","\/\/ http accept types\n",72],["T_WHITESPACE","\t",73],["T_VAR","var",73],["T_WHITESPACE"," ",73],["T_VARIABLE","$accept",73],["T_WHITESPACE","\t\t\t",73],"=",["T_WHITESPACE","\t",73],["T_CONSTANT_ENCAPSED_STRING","\"image\/gif, image\/x-xbitmap, image\/jpeg, image\/pjpeg, *\/*\"",73],";",["T_WHITESPACE","\n\n\t",73],["T_VAR","var",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$results",75],["T_WHITESPACE","\t\t",75],"=",["T_WHITESPACE","\t",75],["T_CONSTANT_ENCAPSED_STRING","\"\"",75],";",["T_WHITESPACE","\t\t\t\t\t",75],["T_COMMENT","\/\/ where the content is put\n",75],["T_WHITESPACE","\n\t",76],["T_VAR","var",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$error",77],["T_WHITESPACE","\t\t\t",77],"=",["T_WHITESPACE","\t",77],["T_CONSTANT_ENCAPSED_STRING","\"\"",77],";",["T_WHITESPACE","\t\t\t\t\t",77],["T_COMMENT","\/\/ error messages sent here\n",77],["T_WHITESPACE","\t",78],["T_VAR","var",78],["T_WHITESPACE","\t",78],["T_VARIABLE","$response_code",78],["T_WHITESPACE","\t",78],"=",["T_WHITESPACE","\t",78],["T_CONSTANT_ENCAPSED_STRING","\"\"",78],";",["T_WHITESPACE","\t\t\t\t\t",78],["T_COMMENT","\/\/ response code returned from server\n",78],["T_WHITESPACE","\t",79],["T_VAR","var",79],["T_WHITESPACE","\t",79],["T_VARIABLE","$headers",79],["T_WHITESPACE","\t\t",79],"=",["T_WHITESPACE","\t",79],["T_ARRAY","array",79],"(",")",";",["T_WHITESPACE","\t\t\t",79],["T_COMMENT","\/\/ headers returned from server sent here\n",79],["T_WHITESPACE","\t",80],["T_VAR","var",80],["T_WHITESPACE","\t",80],["T_VARIABLE","$maxlength",80],["T_WHITESPACE","\t\t",80],"=",["T_WHITESPACE","\t",80],["T_LNUMBER","500000",80],";",["T_WHITESPACE","\t\t\t\t",80],["T_COMMENT","\/\/ max return data length (body)\n",80],["T_WHITESPACE","\t",81],["T_VAR","var",81],["T_WHITESPACE"," ",81],["T_VARIABLE","$read_timeout",81],["T_WHITESPACE","\t",81],"=",["T_WHITESPACE","\t",81],["T_LNUMBER","0",81],";",["T_WHITESPACE","\t\t\t\t\t",81],["T_COMMENT","\/\/ timeout on read operations, in seconds\n",81],["T_WHITESPACE","\t\t\t\t\t\t\t\t\t\t\t\t",82],["T_COMMENT","\/\/ supported only since PHP 4 Beta 4\n",82],["T_WHITESPACE","\t\t\t\t\t\t\t\t\t\t\t\t",83],["T_COMMENT","\/\/ set to 0 to disallow timeouts\n",83],["T_WHITESPACE","\t",84],["T_VAR","var",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$timed_out",84],["T_WHITESPACE","\t\t",84],"=",["T_WHITESPACE","\t",84],["T_STRING","false",84],";",["T_WHITESPACE","\t\t\t\t",84],["T_COMMENT","\/\/ if a read operation timed out\n",84],["T_WHITESPACE","\t",85],["T_VAR","var",85],["T_WHITESPACE","\t",85],["T_VARIABLE","$status",85],["T_WHITESPACE","\t\t\t",85],"=",["T_WHITESPACE","\t",85],["T_LNUMBER","0",85],";",["T_WHITESPACE","\t\t\t\t\t",85],["T_COMMENT","\/\/ http request status\n",85],["T_WHITESPACE","\n\t",86],["T_VAR","var",87],["T_WHITESPACE"," ",87],["T_VARIABLE","$temp_dir",87],["T_WHITESPACE","\t\t",87],"=",["T_WHITESPACE","\t",87],["T_CONSTANT_ENCAPSED_STRING","\"\/tmp\"",87],";",["T_WHITESPACE","\t\t\t\t",87],["T_COMMENT","\/\/ temporary directory that the webserver\n",87],["T_WHITESPACE","\t\t\t\t\t\t\t\t\t\t\t\t",88],["T_COMMENT","\/\/ has permission to write to.\n",88],["T_WHITESPACE","\t\t\t\t\t\t\t\t\t\t\t\t",89],["T_COMMENT","\/\/ under Windows, this should be C:\\temp\n",89],["T_WHITESPACE","\n\t",90],["T_VAR","var",91],["T_WHITESPACE","\t",91],["T_VARIABLE","$curl_path",91],["T_WHITESPACE","\t\t",91],"=",["T_WHITESPACE","\t",91],["T_CONSTANT_ENCAPSED_STRING","\"\/usr\/local\/bin\/curl\"",91],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t\t\t\t",91],["T_COMMENT","\/\/ Snoopy will use cURL for fetching\n",92],["T_WHITESPACE","\t\t\t\t\t\t\t\t\t\t\t\t",93],["T_COMMENT","\/\/ SSL content if a full system path to\n",93],["T_WHITESPACE","\t\t\t\t\t\t\t\t\t\t\t\t",94],["T_COMMENT","\/\/ the cURL binary is supplied here.\n",94],["T_WHITESPACE","\t\t\t\t\t\t\t\t\t\t\t\t",95],["T_COMMENT","\/\/ set to false if you do not have\n",95],["T_WHITESPACE","\t\t\t\t\t\t\t\t\t\t\t\t",96],["T_COMMENT","\/\/ cURL installed. See http:\/\/curl.haxx.se\n",96],["T_WHITESPACE","\t\t\t\t\t\t\t\t\t\t\t\t",97],["T_COMMENT","\/\/ for details on installing cURL.\n",97],["T_WHITESPACE","\t\t\t\t\t\t\t\t\t\t\t\t",98],["T_COMMENT","\/\/ Snoopy does *not* use the cURL\n",98],["T_WHITESPACE","\t\t\t\t\t\t\t\t\t\t\t\t",99],["T_COMMENT","\/\/ library functions built into php,\n",99],["T_WHITESPACE","\t\t\t\t\t\t\t\t\t\t\t\t",100],["T_COMMENT","\/\/ as these functions are not stable\n",100],["T_WHITESPACE","\t\t\t\t\t\t\t\t\t\t\t\t",101],["T_COMMENT","\/\/ as of this Snoopy release.\n",101],["T_WHITESPACE","\n\t",102],["T_COMMENT","\/**** Private variables ****\/",103],["T_WHITESPACE","\n\n\t",103],["T_VAR","var",105],["T_WHITESPACE","\t",105],["T_VARIABLE","$_maxlinelen",105],["T_WHITESPACE","\t",105],"=",["T_WHITESPACE","\t",105],["T_LNUMBER","4096",105],";",["T_WHITESPACE","\t\t\t\t",105],["T_COMMENT","\/\/ max line length (headers)\n",105],["T_WHITESPACE","\n\t",106],["T_VAR","var",107],["T_WHITESPACE"," ",107],["T_VARIABLE","$_httpmethod",107],["T_WHITESPACE","\t",107],"=",["T_WHITESPACE","\t",107],["T_CONSTANT_ENCAPSED_STRING","\"GET\"",107],";",["T_WHITESPACE","\t\t\t\t",107],["T_COMMENT","\/\/ default http request method\n",107],["T_WHITESPACE","\t",108],["T_VAR","var",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$_httpversion",108],["T_WHITESPACE","\t",108],"=",["T_WHITESPACE","\t",108],["T_CONSTANT_ENCAPSED_STRING","\"HTTP\/1.0\"",108],";",["T_WHITESPACE","\t\t\t",108],["T_COMMENT","\/\/ default http request version\n",108],["T_WHITESPACE","\t",109],["T_VAR","var",109],["T_WHITESPACE"," ",109],["T_VARIABLE","$_submit_method",109],["T_WHITESPACE","\t",109],"=",["T_WHITESPACE","\t",109],["T_CONSTANT_ENCAPSED_STRING","\"POST\"",109],";",["T_WHITESPACE","\t\t\t\t",109],["T_COMMENT","\/\/ default submit method\n",109],["T_WHITESPACE","\t",110],["T_VAR","var",110],["T_WHITESPACE"," ",110],["T_VARIABLE","$_submit_type",110],["T_WHITESPACE","\t",110],"=",["T_WHITESPACE","\t",110],["T_CONSTANT_ENCAPSED_STRING","\"application\/x-www-form-urlencoded\"",110],";",["T_WHITESPACE","\t",110],["T_COMMENT","\/\/ default submit type\n",110],["T_WHITESPACE","\t",111],["T_VAR","var",111],["T_WHITESPACE"," ",111],["T_VARIABLE","$_mime_boundary",111],["T_WHITESPACE","\t",111],"=",["T_WHITESPACE","   ",111],["T_CONSTANT_ENCAPSED_STRING","\"\"",111],";",["T_WHITESPACE","\t\t\t\t\t",111],["T_COMMENT","\/\/ MIME boundary for multipart\/form-data submit type\n",111],["T_WHITESPACE","\t",112],["T_VAR","var",112],["T_WHITESPACE"," ",112],["T_VARIABLE","$_redirectaddr",112],["T_WHITESPACE","\t",112],"=",["T_WHITESPACE","\t",112],["T_STRING","false",112],";",["T_WHITESPACE","\t\t\t\t",112],["T_COMMENT","\/\/ will be set if page fetched is a redirect\n",112],["T_WHITESPACE","\t",113],["T_VAR","var",113],["T_WHITESPACE"," ",113],["T_VARIABLE","$_redirectdepth",113],["T_WHITESPACE","\t",113],"=",["T_WHITESPACE","\t",113],["T_LNUMBER","0",113],";",["T_WHITESPACE","\t\t\t\t\t",113],["T_COMMENT","\/\/ increments on an http redirect\n",113],["T_WHITESPACE","\t",114],["T_VAR","var",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$_frameurls",114],["T_WHITESPACE","\t\t",114],"=",["T_WHITESPACE"," \t",114],["T_ARRAY","array",114],"(",")",";",["T_WHITESPACE","\t\t\t",114],["T_COMMENT","\/\/ frame src urls\n",114],["T_WHITESPACE","\t",115],["T_VAR","var",115],["T_WHITESPACE"," ",115],["T_VARIABLE","$_framedepth",115],["T_WHITESPACE","\t",115],"=",["T_WHITESPACE","\t",115],["T_LNUMBER","0",115],";",["T_WHITESPACE","\t\t\t\t\t",115],["T_COMMENT","\/\/ increments on frame depth\n",115],["T_WHITESPACE","\n\t",116],["T_VAR","var",117],["T_WHITESPACE"," ",117],["T_VARIABLE","$_isproxy",117],["T_WHITESPACE","\t\t",117],"=",["T_WHITESPACE","\t",117],["T_STRING","false",117],";",["T_WHITESPACE","\t\t\t\t",117],["T_COMMENT","\/\/ set if using a proxy server\n",117],["T_WHITESPACE","\t",118],["T_VAR","var",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$_fp_timeout",118],["T_WHITESPACE","\t",118],"=",["T_WHITESPACE","\t",118],["T_LNUMBER","30",118],";",["T_WHITESPACE","\t\t\t\t\t",118],["T_COMMENT","\/\/ timeout for socket connection\n",118],["T_WHITESPACE","\n",119],["T_COMMENT","\/*======================================================================*\\\n\tFunction:\tfetch\n\tPurpose:\tfetch the contents of a web page\n\t\t\t\t(and possibly other protocols in the\n\t\t\t\tfuture like ftp, nntp, gopher, etc.)\n\tInput:\t\t$URI\tthe location of the page to fetch\n\tOutput:\t\t$this->results\tthe output text from the fetch\n\\*======================================================================*\/",120],["T_WHITESPACE","\n\n\t",127],["T_FUNCTION","function",129],["T_WHITESPACE"," ",129],["T_STRING","fetch",129],"(",["T_VARIABLE","$URI",129],")",["T_WHITESPACE","\n\t",129],"{",["T_WHITESPACE","\n\n\t\t",130],["T_COMMENT","\/\/preg_match(\"|^([^:]+):\/\/([^:\/]+)(:[\\d]+)*(.*)|\",$URI,$URI_PARTS);\n",132],["T_WHITESPACE","\t\t",133],["T_VARIABLE","$URI_PARTS",133],["T_WHITESPACE"," ",133],"=",["T_WHITESPACE"," ",133],["T_STRING","parse_url",133],"(",["T_VARIABLE","$URI",133],")",";",["T_WHITESPACE","\n\t\t",133],["T_IF","if",134],["T_WHITESPACE"," ",134],"(","!",["T_EMPTY","empty",134],"(",["T_VARIABLE","$URI_PARTS",134],"[",["T_CONSTANT_ENCAPSED_STRING","\"user\"",134],"]",")",")",["T_WHITESPACE","\n\t\t\t",134],["T_VARIABLE","$this",135],["T_OBJECT_OPERATOR","->",135],["T_STRING","user",135],["T_WHITESPACE"," ",135],"=",["T_WHITESPACE"," ",135],["T_VARIABLE","$URI_PARTS",135],"[",["T_CONSTANT_ENCAPSED_STRING","\"user\"",135],"]",";",["T_WHITESPACE","\n\t\t",135],["T_IF","if",136],["T_WHITESPACE"," ",136],"(","!",["T_EMPTY","empty",136],"(",["T_VARIABLE","$URI_PARTS",136],"[",["T_CONSTANT_ENCAPSED_STRING","\"pass\"",136],"]",")",")",["T_WHITESPACE","\n\t\t\t",136],["T_VARIABLE","$this",137],["T_OBJECT_OPERATOR","->",137],["T_STRING","pass",137],["T_WHITESPACE"," ",137],"=",["T_WHITESPACE"," ",137],["T_VARIABLE","$URI_PARTS",137],"[",["T_CONSTANT_ENCAPSED_STRING","\"pass\"",137],"]",";",["T_WHITESPACE","\n\t\t",137],["T_IF","if",138],["T_WHITESPACE"," ",138],"(",["T_EMPTY","empty",138],"(",["T_VARIABLE","$URI_PARTS",138],"[",["T_CONSTANT_ENCAPSED_STRING","\"query\"",138],"]",")",")",["T_WHITESPACE","\n\t\t\t",138],["T_VARIABLE","$URI_PARTS",139],"[",["T_CONSTANT_ENCAPSED_STRING","\"query\"",139],"]",["T_WHITESPACE"," ",139],"=",["T_WHITESPACE"," ",139],["T_CONSTANT_ENCAPSED_STRING","''",139],";",["T_WHITESPACE","\n\t\t",139],["T_IF","if",140],["T_WHITESPACE"," ",140],"(",["T_EMPTY","empty",140],"(",["T_VARIABLE","$URI_PARTS",140],"[",["T_CONSTANT_ENCAPSED_STRING","\"path\"",140],"]",")",")",["T_WHITESPACE","\n\t\t\t",140],["T_VARIABLE","$URI_PARTS",141],"[",["T_CONSTANT_ENCAPSED_STRING","\"path\"",141],"]",["T_WHITESPACE"," ",141],"=",["T_WHITESPACE"," ",141],["T_CONSTANT_ENCAPSED_STRING","''",141],";",["T_WHITESPACE","\n\n\t\t",141],["T_SWITCH","switch",143],"(",["T_STRING","strtolower",143],"(",["T_VARIABLE","$URI_PARTS",143],"[",["T_CONSTANT_ENCAPSED_STRING","\"scheme\"",143],"]",")",")",["T_WHITESPACE","\n\t\t",143],"{",["T_WHITESPACE","\n\t\t\t",144],["T_CASE","case",145],["T_WHITESPACE"," ",145],["T_CONSTANT_ENCAPSED_STRING","\"http\"",145],":",["T_WHITESPACE","\n\t\t\t\t",145],["T_VARIABLE","$this",146],["T_OBJECT_OPERATOR","->",146],["T_STRING","host",146],["T_WHITESPACE"," ",146],"=",["T_WHITESPACE"," ",146],["T_VARIABLE","$URI_PARTS",146],"[",["T_CONSTANT_ENCAPSED_STRING","\"host\"",146],"]",";",["T_WHITESPACE","\n\t\t\t\t",146],["T_IF","if",147],"(","!",["T_EMPTY","empty",147],"(",["T_VARIABLE","$URI_PARTS",147],"[",["T_CONSTANT_ENCAPSED_STRING","\"port\"",147],"]",")",")",["T_WHITESPACE","\n\t\t\t\t\t",147],["T_VARIABLE","$this",148],["T_OBJECT_OPERATOR","->",148],["T_STRING","port",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_VARIABLE","$URI_PARTS",148],"[",["T_CONSTANT_ENCAPSED_STRING","\"port\"",148],"]",";",["T_WHITESPACE","\n\t\t\t\t",148],["T_IF","if",149],"(",["T_VARIABLE","$this",149],["T_OBJECT_OPERATOR","->",149],["T_STRING","_connect",149],"(",["T_VARIABLE","$fp",149],")",")",["T_WHITESPACE","\n\t\t\t\t",149],"{",["T_WHITESPACE","\n\t\t\t\t\t",150],["T_IF","if",151],"(",["T_VARIABLE","$this",151],["T_OBJECT_OPERATOR","->",151],["T_STRING","_isproxy",151],")",["T_WHITESPACE","\n\t\t\t\t\t",151],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",152],["T_COMMENT","\/\/ using proxy, send entire URI\n",153],["T_WHITESPACE","\t\t\t\t\t\t",154],["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","_httprequest",154],"(",["T_VARIABLE","$URI",154],",",["T_VARIABLE","$fp",154],",",["T_VARIABLE","$URI",154],",",["T_VARIABLE","$this",154],["T_OBJECT_OPERATOR","->",154],["T_STRING","_httpmethod",154],")",";",["T_WHITESPACE","\n\t\t\t\t\t",154],"}",["T_WHITESPACE","\n\t\t\t\t\t",155],["T_ELSE","else",156],["T_WHITESPACE","\n\t\t\t\t\t",156],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",157],["T_VARIABLE","$path",158],["T_WHITESPACE"," ",158],"=",["T_WHITESPACE"," ",158],["T_VARIABLE","$URI_PARTS",158],"[",["T_CONSTANT_ENCAPSED_STRING","\"path\"",158],"]",".","(",["T_VARIABLE","$URI_PARTS",158],"[",["T_CONSTANT_ENCAPSED_STRING","\"query\"",158],"]",["T_WHITESPACE"," ",158],"?",["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","\"?\"",158],".",["T_VARIABLE","$URI_PARTS",158],"[",["T_CONSTANT_ENCAPSED_STRING","\"query\"",158],"]",["T_WHITESPACE"," ",158],":",["T_WHITESPACE"," ",158],["T_CONSTANT_ENCAPSED_STRING","\"\"",158],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t",158],["T_COMMENT","\/\/ no proxy, send only the path\n",159],["T_WHITESPACE","\t\t\t\t\t\t",160],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","_httprequest",160],"(",["T_VARIABLE","$path",160],",",["T_WHITESPACE"," ",160],["T_VARIABLE","$fp",160],",",["T_WHITESPACE"," ",160],["T_VARIABLE","$URI",160],",",["T_WHITESPACE"," ",160],["T_VARIABLE","$this",160],["T_OBJECT_OPERATOR","->",160],["T_STRING","_httpmethod",160],")",";",["T_WHITESPACE","\n\t\t\t\t\t",160],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",161],["T_VARIABLE","$this",163],["T_OBJECT_OPERATOR","->",163],["T_STRING","_disconnect",163],"(",["T_VARIABLE","$fp",163],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",163],["T_IF","if",165],"(",["T_VARIABLE","$this",165],["T_OBJECT_OPERATOR","->",165],["T_STRING","_redirectaddr",165],")",["T_WHITESPACE","\n\t\t\t\t\t",165],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",166],["T_COMMENT","\/* url was redirected, check if we've hit the max depth *\/",167],["T_WHITESPACE","\n\t\t\t\t\t\t",167],["T_IF","if",168],"(",["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","maxredirs",168],["T_WHITESPACE"," ",168],">",["T_WHITESPACE"," ",168],["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","_redirectdepth",168],")",["T_WHITESPACE","\n\t\t\t\t\t\t",168],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",169],["T_COMMENT","\/\/ only follow redirect if it's on this site, or offsiteok is true\n",170],["T_WHITESPACE","\t\t\t\t\t\t\t",171],["T_IF","if",171],"(",["T_STRING","preg_match",171],"(",["T_CONSTANT_ENCAPSED_STRING","\"|^http:\/\/\"",171],".",["T_STRING","preg_quote",171],"(",["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","host",171],")",".",["T_CONSTANT_ENCAPSED_STRING","\"|i\"",171],",",["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","_redirectaddr",171],")",["T_WHITESPACE"," ",171],["T_BOOLEAN_OR","||",171],["T_WHITESPACE"," ",171],["T_VARIABLE","$this",171],["T_OBJECT_OPERATOR","->",171],["T_STRING","offsiteok",171],")",["T_WHITESPACE","\n\t\t\t\t\t\t\t",171],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",172],["T_COMMENT","\/* follow the redirect *\/",173],["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",173],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","_redirectdepth",174],["T_INC","++",174],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",174],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","lastredirectaddr",175],"=",["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","_redirectaddr",175],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",175],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","fetch",176],"(",["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","_redirectaddr",176],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",176],"}",["T_WHITESPACE","\n\t\t\t\t\t\t",177],"}",["T_WHITESPACE","\n\t\t\t\t\t",178],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",179],["T_IF","if",181],"(",["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","_framedepth",181],["T_WHITESPACE"," ",181],"<",["T_WHITESPACE"," ",181],["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","maxframes",181],["T_WHITESPACE"," ",181],["T_BOOLEAN_AND","&&",181],["T_WHITESPACE"," ",181],["T_STRING","count",181],"(",["T_VARIABLE","$this",181],["T_OBJECT_OPERATOR","->",181],["T_STRING","_frameurls",181],")",["T_WHITESPACE"," ",181],">",["T_WHITESPACE"," ",181],["T_LNUMBER","0",181],")",["T_WHITESPACE","\n\t\t\t\t\t",181],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",182],["T_VARIABLE","$frameurls",183],["T_WHITESPACE"," ",183],"=",["T_WHITESPACE"," ",183],["T_VARIABLE","$this",183],["T_OBJECT_OPERATOR","->",183],["T_STRING","_frameurls",183],";",["T_WHITESPACE","\n\t\t\t\t\t\t",183],["T_VARIABLE","$this",184],["T_OBJECT_OPERATOR","->",184],["T_STRING","_frameurls",184],["T_WHITESPACE"," ",184],"=",["T_WHITESPACE"," ",184],["T_ARRAY","array",184],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t",184],["T_WHILE","while",186],"(",["T_LIST","list",186],"(",",",["T_VARIABLE","$frameurl",186],")",["T_WHITESPACE"," ",186],"=",["T_WHITESPACE"," ",186],["T_STRING","each",186],"(",["T_VARIABLE","$frameurls",186],")",")",["T_WHITESPACE","\n\t\t\t\t\t\t",186],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",187],["T_IF","if",188],"(",["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","_framedepth",188],["T_WHITESPACE"," ",188],"<",["T_WHITESPACE"," ",188],["T_VARIABLE","$this",188],["T_OBJECT_OPERATOR","->",188],["T_STRING","maxframes",188],")",["T_WHITESPACE","\n\t\t\t\t\t\t\t",188],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",189],["T_VARIABLE","$this",190],["T_OBJECT_OPERATOR","->",190],["T_STRING","fetch",190],"(",["T_VARIABLE","$frameurl",190],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",190],["T_VARIABLE","$this",191],["T_OBJECT_OPERATOR","->",191],["T_STRING","_framedepth",191],["T_INC","++",191],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",191],"}",["T_WHITESPACE","\n\t\t\t\t\t\t\t",192],["T_ELSE","else",193],["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",193],["T_BREAK","break",194],";",["T_WHITESPACE","\n\t\t\t\t\t\t",194],"}",["T_WHITESPACE","\n\t\t\t\t\t",195],"}",["T_WHITESPACE","\n\t\t\t\t",196],"}",["T_WHITESPACE","\n\t\t\t\t",197],["T_ELSE","else",198],["T_WHITESPACE","\n\t\t\t\t",198],"{",["T_WHITESPACE","\n\t\t\t\t\t",199],["T_RETURN","return",200],["T_WHITESPACE"," ",200],["T_STRING","false",200],";",["T_WHITESPACE","\n\t\t\t\t",200],"}",["T_WHITESPACE","\n\t\t\t\t",201],["T_RETURN","return",202],["T_WHITESPACE"," ",202],["T_STRING","true",202],";",["T_WHITESPACE","\n\t\t\t\t",202],["T_BREAK","break",203],";",["T_WHITESPACE","\n\t\t\t",203],["T_CASE","case",204],["T_WHITESPACE"," ",204],["T_CONSTANT_ENCAPSED_STRING","\"https\"",204],":",["T_WHITESPACE","\n\t\t\t\t",204],["T_IF","if",205],"(","!",["T_VARIABLE","$this",205],["T_OBJECT_OPERATOR","->",205],["T_STRING","curl_path",205],")",["T_WHITESPACE","\n\t\t\t\t\t",205],["T_RETURN","return",206],["T_WHITESPACE"," ",206],["T_STRING","false",206],";",["T_WHITESPACE","\n\t\t\t\t",206],["T_IF","if",207],"(",["T_STRING","function_exists",207],"(",["T_CONSTANT_ENCAPSED_STRING","\"is_executable\"",207],")",")",["T_WHITESPACE","\n\t\t\t\t    ",207],["T_IF","if",208],["T_WHITESPACE"," ",208],"(","!",["T_STRING","is_executable",208],"(",["T_VARIABLE","$this",208],["T_OBJECT_OPERATOR","->",208],["T_STRING","curl_path",208],")",")",["T_WHITESPACE","\n\t\t\t\t        ",208],["T_RETURN","return",209],["T_WHITESPACE"," ",209],["T_STRING","false",209],";",["T_WHITESPACE","\n\t\t\t\t",209],["T_VARIABLE","$this",210],["T_OBJECT_OPERATOR","->",210],["T_STRING","host",210],["T_WHITESPACE"," ",210],"=",["T_WHITESPACE"," ",210],["T_VARIABLE","$URI_PARTS",210],"[",["T_CONSTANT_ENCAPSED_STRING","\"host\"",210],"]",";",["T_WHITESPACE","\n\t\t\t\t",210],["T_IF","if",211],"(","!",["T_EMPTY","empty",211],"(",["T_VARIABLE","$URI_PARTS",211],"[",["T_CONSTANT_ENCAPSED_STRING","\"port\"",211],"]",")",")",["T_WHITESPACE","\n\t\t\t\t\t",211],["T_VARIABLE","$this",212],["T_OBJECT_OPERATOR","->",212],["T_STRING","port",212],["T_WHITESPACE"," ",212],"=",["T_WHITESPACE"," ",212],["T_VARIABLE","$URI_PARTS",212],"[",["T_CONSTANT_ENCAPSED_STRING","\"port\"",212],"]",";",["T_WHITESPACE","\n\t\t\t\t",212],["T_IF","if",213],"(",["T_VARIABLE","$this",213],["T_OBJECT_OPERATOR","->",213],["T_STRING","_isproxy",213],")",["T_WHITESPACE","\n\t\t\t\t",213],"{",["T_WHITESPACE","\n\t\t\t\t\t",214],["T_COMMENT","\/\/ using proxy, send entire URI\n",215],["T_WHITESPACE","\t\t\t\t\t",216],["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","_httpsrequest",216],"(",["T_VARIABLE","$URI",216],",",["T_VARIABLE","$URI",216],",",["T_VARIABLE","$this",216],["T_OBJECT_OPERATOR","->",216],["T_STRING","_httpmethod",216],")",";",["T_WHITESPACE","\n\t\t\t\t",216],"}",["T_WHITESPACE","\n\t\t\t\t",217],["T_ELSE","else",218],["T_WHITESPACE","\n\t\t\t\t",218],"{",["T_WHITESPACE","\n\t\t\t\t\t",219],["T_VARIABLE","$path",220],["T_WHITESPACE"," ",220],"=",["T_WHITESPACE"," ",220],["T_VARIABLE","$URI_PARTS",220],"[",["T_CONSTANT_ENCAPSED_STRING","\"path\"",220],"]",".","(",["T_VARIABLE","$URI_PARTS",220],"[",["T_CONSTANT_ENCAPSED_STRING","\"query\"",220],"]",["T_WHITESPACE"," ",220],"?",["T_WHITESPACE"," ",220],["T_CONSTANT_ENCAPSED_STRING","\"?\"",220],".",["T_VARIABLE","$URI_PARTS",220],"[",["T_CONSTANT_ENCAPSED_STRING","\"query\"",220],"]",["T_WHITESPACE"," ",220],":",["T_WHITESPACE"," ",220],["T_CONSTANT_ENCAPSED_STRING","\"\"",220],")",";",["T_WHITESPACE","\n\t\t\t\t\t",220],["T_COMMENT","\/\/ no proxy, send only the path\n",221],["T_WHITESPACE","\t\t\t\t\t",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","_httpsrequest",222],"(",["T_VARIABLE","$path",222],",",["T_WHITESPACE"," ",222],["T_VARIABLE","$URI",222],",",["T_WHITESPACE"," ",222],["T_VARIABLE","$this",222],["T_OBJECT_OPERATOR","->",222],["T_STRING","_httpmethod",222],")",";",["T_WHITESPACE","\n\t\t\t\t",222],"}",["T_WHITESPACE","\n\n\t\t\t\t",223],["T_IF","if",225],"(",["T_VARIABLE","$this",225],["T_OBJECT_OPERATOR","->",225],["T_STRING","_redirectaddr",225],")",["T_WHITESPACE","\n\t\t\t\t",225],"{",["T_WHITESPACE","\n\t\t\t\t\t",226],["T_COMMENT","\/* url was redirected, check if we've hit the max depth *\/",227],["T_WHITESPACE","\n\t\t\t\t\t",227],["T_IF","if",228],"(",["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","maxredirs",228],["T_WHITESPACE"," ",228],">",["T_WHITESPACE"," ",228],["T_VARIABLE","$this",228],["T_OBJECT_OPERATOR","->",228],["T_STRING","_redirectdepth",228],")",["T_WHITESPACE","\n\t\t\t\t\t",228],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",229],["T_COMMENT","\/\/ only follow redirect if it's on this site, or offsiteok is true\n",230],["T_WHITESPACE","\t\t\t\t\t\t",231],["T_IF","if",231],"(",["T_STRING","preg_match",231],"(",["T_CONSTANT_ENCAPSED_STRING","\"|^http:\/\/\"",231],".",["T_STRING","preg_quote",231],"(",["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","host",231],")",".",["T_CONSTANT_ENCAPSED_STRING","\"|i\"",231],",",["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","_redirectaddr",231],")",["T_WHITESPACE"," ",231],["T_BOOLEAN_OR","||",231],["T_WHITESPACE"," ",231],["T_VARIABLE","$this",231],["T_OBJECT_OPERATOR","->",231],["T_STRING","offsiteok",231],")",["T_WHITESPACE","\n\t\t\t\t\t\t",231],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",232],["T_COMMENT","\/* follow the redirect *\/",233],["T_WHITESPACE","\n\t\t\t\t\t\t\t",233],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","_redirectdepth",234],["T_INC","++",234],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",234],["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","lastredirectaddr",235],"=",["T_VARIABLE","$this",235],["T_OBJECT_OPERATOR","->",235],["T_STRING","_redirectaddr",235],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",235],["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","fetch",236],"(",["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","_redirectaddr",236],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t",236],"}",["T_WHITESPACE","\n\t\t\t\t\t",237],"}",["T_WHITESPACE","\n\t\t\t\t",238],"}",["T_WHITESPACE","\n\n\t\t\t\t",239],["T_IF","if",241],"(",["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","_framedepth",241],["T_WHITESPACE"," ",241],"<",["T_WHITESPACE"," ",241],["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","maxframes",241],["T_WHITESPACE"," ",241],["T_BOOLEAN_AND","&&",241],["T_WHITESPACE"," ",241],["T_STRING","count",241],"(",["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","_frameurls",241],")",["T_WHITESPACE"," ",241],">",["T_WHITESPACE"," ",241],["T_LNUMBER","0",241],")",["T_WHITESPACE","\n\t\t\t\t",241],"{",["T_WHITESPACE","\n\t\t\t\t\t",242],["T_VARIABLE","$frameurls",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","_frameurls",243],";",["T_WHITESPACE","\n\t\t\t\t\t",243],["T_VARIABLE","$this",244],["T_OBJECT_OPERATOR","->",244],["T_STRING","_frameurls",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE"," ",244],["T_ARRAY","array",244],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",244],["T_WHILE","while",246],"(",["T_LIST","list",246],"(",",",["T_VARIABLE","$frameurl",246],")",["T_WHITESPACE"," ",246],"=",["T_WHITESPACE"," ",246],["T_STRING","each",246],"(",["T_VARIABLE","$frameurls",246],")",")",["T_WHITESPACE","\n\t\t\t\t\t",246],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",247],["T_IF","if",248],"(",["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","_framedepth",248],["T_WHITESPACE"," ",248],"<",["T_WHITESPACE"," ",248],["T_VARIABLE","$this",248],["T_OBJECT_OPERATOR","->",248],["T_STRING","maxframes",248],")",["T_WHITESPACE","\n\t\t\t\t\t\t",248],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",249],["T_VARIABLE","$this",250],["T_OBJECT_OPERATOR","->",250],["T_STRING","fetch",250],"(",["T_VARIABLE","$frameurl",250],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",250],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","_framedepth",251],["T_INC","++",251],";",["T_WHITESPACE","\n\t\t\t\t\t\t",251],"}",["T_WHITESPACE","\n\t\t\t\t\t\t",252],["T_ELSE","else",253],["T_WHITESPACE","\n\t\t\t\t\t\t\t",253],["T_BREAK","break",254],";",["T_WHITESPACE","\n\t\t\t\t\t",254],"}",["T_WHITESPACE","\n\t\t\t\t",255],"}",["T_WHITESPACE","\n\t\t\t\t",256],["T_RETURN","return",257],["T_WHITESPACE"," ",257],["T_STRING","true",257],";",["T_WHITESPACE","\n\t\t\t\t",257],["T_BREAK","break",258],";",["T_WHITESPACE","\n\t\t\t",258],["T_DEFAULT","default",259],":",["T_WHITESPACE","\n\t\t\t\t",259],["T_COMMENT","\/\/ not a valid protocol\n",260],["T_WHITESPACE","\t\t\t\t",261],["T_VARIABLE","$this",261],["T_OBJECT_OPERATOR","->",261],["T_STRING","error",261],["T_WHITESPACE","\t",261],"=",["T_WHITESPACE","\t",261],["T_CONSTANT_ENCAPSED_STRING","'Invalid protocol \"'",261],".",["T_VARIABLE","$URI_PARTS",261],"[",["T_CONSTANT_ENCAPSED_STRING","\"scheme\"",261],"]",".",["T_CONSTANT_ENCAPSED_STRING","'\"\\n'",261],";",["T_WHITESPACE","\n\t\t\t\t",261],["T_RETURN","return",262],["T_WHITESPACE"," ",262],["T_STRING","false",262],";",["T_WHITESPACE","\n\t\t\t\t",262],["T_BREAK","break",263],";",["T_WHITESPACE","\n\t\t",263],"}",["T_WHITESPACE","\n\t\t",264],["T_RETURN","return",265],["T_WHITESPACE"," ",265],["T_STRING","true",265],";",["T_WHITESPACE","\n\t",265],"}",["T_WHITESPACE","\n\n",266],["T_COMMENT","\/*======================================================================*\\\n\tFunction:\tsubmit\n\tPurpose:\tsubmit an http form\n\tInput:\t\t$URI\tthe location to post the data\n\t\t\t\t$formvars\tthe formvars to use.\n\t\t\t\t\tformat: $formvars[\"var\"] = \"val\";\n\t\t\t\t$formfiles  an array of files to submit\n\t\t\t\t\tformat: $formfiles[\"var\"] = \"\/dir\/filename.ext\";\n\tOutput:\t\t$this->results\tthe text output from the post\n\\*======================================================================*\/",268],["T_WHITESPACE","\n\n\t",277],["T_FUNCTION","function",279],["T_WHITESPACE"," ",279],["T_STRING","submit",279],"(",["T_VARIABLE","$URI",279],",",["T_WHITESPACE"," ",279],["T_VARIABLE","$formvars",279],"=",["T_CONSTANT_ENCAPSED_STRING","\"\"",279],",",["T_WHITESPACE"," ",279],["T_VARIABLE","$formfiles",279],"=",["T_CONSTANT_ENCAPSED_STRING","\"\"",279],")",["T_WHITESPACE","\n\t",279],"{",["T_WHITESPACE","\n\t\t",280],["T_UNSET","unset",281],"(",["T_VARIABLE","$postdata",281],")",";",["T_WHITESPACE","\n\n\t\t",281],["T_VARIABLE","$postdata",283],["T_WHITESPACE"," ",283],"=",["T_WHITESPACE"," ",283],["T_VARIABLE","$this",283],["T_OBJECT_OPERATOR","->",283],["T_STRING","_prepare_post_body",283],"(",["T_VARIABLE","$formvars",283],",",["T_WHITESPACE"," ",283],["T_VARIABLE","$formfiles",283],")",";",["T_WHITESPACE","\n\n\t\t",283],["T_VARIABLE","$URI_PARTS",285],["T_WHITESPACE"," ",285],"=",["T_WHITESPACE"," ",285],["T_STRING","parse_url",285],"(",["T_VARIABLE","$URI",285],")",";",["T_WHITESPACE","\n\t\t",285],["T_IF","if",286],["T_WHITESPACE"," ",286],"(","!",["T_EMPTY","empty",286],"(",["T_VARIABLE","$URI_PARTS",286],"[",["T_CONSTANT_ENCAPSED_STRING","\"user\"",286],"]",")",")",["T_WHITESPACE","\n\t\t\t",286],["T_VARIABLE","$this",287],["T_OBJECT_OPERATOR","->",287],["T_STRING","user",287],["T_WHITESPACE"," ",287],"=",["T_WHITESPACE"," ",287],["T_VARIABLE","$URI_PARTS",287],"[",["T_CONSTANT_ENCAPSED_STRING","\"user\"",287],"]",";",["T_WHITESPACE","\n\t\t",287],["T_IF","if",288],["T_WHITESPACE"," ",288],"(","!",["T_EMPTY","empty",288],"(",["T_VARIABLE","$URI_PARTS",288],"[",["T_CONSTANT_ENCAPSED_STRING","\"pass\"",288],"]",")",")",["T_WHITESPACE","\n\t\t\t",288],["T_VARIABLE","$this",289],["T_OBJECT_OPERATOR","->",289],["T_STRING","pass",289],["T_WHITESPACE"," ",289],"=",["T_WHITESPACE"," ",289],["T_VARIABLE","$URI_PARTS",289],"[",["T_CONSTANT_ENCAPSED_STRING","\"pass\"",289],"]",";",["T_WHITESPACE","\n\t\t",289],["T_IF","if",290],["T_WHITESPACE"," ",290],"(",["T_EMPTY","empty",290],"(",["T_VARIABLE","$URI_PARTS",290],"[",["T_CONSTANT_ENCAPSED_STRING","\"query\"",290],"]",")",")",["T_WHITESPACE","\n\t\t\t",290],["T_VARIABLE","$URI_PARTS",291],"[",["T_CONSTANT_ENCAPSED_STRING","\"query\"",291],"]",["T_WHITESPACE"," ",291],"=",["T_WHITESPACE"," ",291],["T_CONSTANT_ENCAPSED_STRING","''",291],";",["T_WHITESPACE","\n\t\t",291],["T_IF","if",292],["T_WHITESPACE"," ",292],"(",["T_EMPTY","empty",292],"(",["T_VARIABLE","$URI_PARTS",292],"[",["T_CONSTANT_ENCAPSED_STRING","\"path\"",292],"]",")",")",["T_WHITESPACE","\n\t\t\t",292],["T_VARIABLE","$URI_PARTS",293],"[",["T_CONSTANT_ENCAPSED_STRING","\"path\"",293],"]",["T_WHITESPACE"," ",293],"=",["T_WHITESPACE"," ",293],["T_CONSTANT_ENCAPSED_STRING","''",293],";",["T_WHITESPACE","\n\n\t\t",293],["T_SWITCH","switch",295],"(",["T_STRING","strtolower",295],"(",["T_VARIABLE","$URI_PARTS",295],"[",["T_CONSTANT_ENCAPSED_STRING","\"scheme\"",295],"]",")",")",["T_WHITESPACE","\n\t\t",295],"{",["T_WHITESPACE","\n\t\t\t",296],["T_CASE","case",297],["T_WHITESPACE"," ",297],["T_CONSTANT_ENCAPSED_STRING","\"http\"",297],":",["T_WHITESPACE","\n\t\t\t\t",297],["T_VARIABLE","$this",298],["T_OBJECT_OPERATOR","->",298],["T_STRING","host",298],["T_WHITESPACE"," ",298],"=",["T_WHITESPACE"," ",298],["T_VARIABLE","$URI_PARTS",298],"[",["T_CONSTANT_ENCAPSED_STRING","\"host\"",298],"]",";",["T_WHITESPACE","\n\t\t\t\t",298],["T_IF","if",299],"(","!",["T_EMPTY","empty",299],"(",["T_VARIABLE","$URI_PARTS",299],"[",["T_CONSTANT_ENCAPSED_STRING","\"port\"",299],"]",")",")",["T_WHITESPACE","\n\t\t\t\t\t",299],["T_VARIABLE","$this",300],["T_OBJECT_OPERATOR","->",300],["T_STRING","port",300],["T_WHITESPACE"," ",300],"=",["T_WHITESPACE"," ",300],["T_VARIABLE","$URI_PARTS",300],"[",["T_CONSTANT_ENCAPSED_STRING","\"port\"",300],"]",";",["T_WHITESPACE","\n\t\t\t\t",300],["T_IF","if",301],"(",["T_VARIABLE","$this",301],["T_OBJECT_OPERATOR","->",301],["T_STRING","_connect",301],"(",["T_VARIABLE","$fp",301],")",")",["T_WHITESPACE","\n\t\t\t\t",301],"{",["T_WHITESPACE","\n\t\t\t\t\t",302],["T_IF","if",303],"(",["T_VARIABLE","$this",303],["T_OBJECT_OPERATOR","->",303],["T_STRING","_isproxy",303],")",["T_WHITESPACE","\n\t\t\t\t\t",303],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",304],["T_COMMENT","\/\/ using proxy, send entire URI\n",305],["T_WHITESPACE","\t\t\t\t\t\t",306],["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","_httprequest",306],"(",["T_VARIABLE","$URI",306],",",["T_VARIABLE","$fp",306],",",["T_VARIABLE","$URI",306],",",["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","_submit_method",306],",",["T_VARIABLE","$this",306],["T_OBJECT_OPERATOR","->",306],["T_STRING","_submit_type",306],",",["T_VARIABLE","$postdata",306],")",";",["T_WHITESPACE","\n\t\t\t\t\t",306],"}",["T_WHITESPACE","\n\t\t\t\t\t",307],["T_ELSE","else",308],["T_WHITESPACE","\n\t\t\t\t\t",308],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",309],["T_VARIABLE","$path",310],["T_WHITESPACE"," ",310],"=",["T_WHITESPACE"," ",310],["T_VARIABLE","$URI_PARTS",310],"[",["T_CONSTANT_ENCAPSED_STRING","\"path\"",310],"]",".","(",["T_VARIABLE","$URI_PARTS",310],"[",["T_CONSTANT_ENCAPSED_STRING","\"query\"",310],"]",["T_WHITESPACE"," ",310],"?",["T_WHITESPACE"," ",310],["T_CONSTANT_ENCAPSED_STRING","\"?\"",310],".",["T_VARIABLE","$URI_PARTS",310],"[",["T_CONSTANT_ENCAPSED_STRING","\"query\"",310],"]",["T_WHITESPACE"," ",310],":",["T_WHITESPACE"," ",310],["T_CONSTANT_ENCAPSED_STRING","\"\"",310],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t",310],["T_COMMENT","\/\/ no proxy, send only the path\n",311],["T_WHITESPACE","\t\t\t\t\t\t",312],["T_VARIABLE","$this",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","_httprequest",312],"(",["T_VARIABLE","$path",312],",",["T_WHITESPACE"," ",312],["T_VARIABLE","$fp",312],",",["T_WHITESPACE"," ",312],["T_VARIABLE","$URI",312],",",["T_WHITESPACE"," ",312],["T_VARIABLE","$this",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","_submit_method",312],",",["T_WHITESPACE"," ",312],["T_VARIABLE","$this",312],["T_OBJECT_OPERATOR","->",312],["T_STRING","_submit_type",312],",",["T_WHITESPACE"," ",312],["T_VARIABLE","$postdata",312],")",";",["T_WHITESPACE","\n\t\t\t\t\t",312],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",313],["T_VARIABLE","$this",315],["T_OBJECT_OPERATOR","->",315],["T_STRING","_disconnect",315],"(",["T_VARIABLE","$fp",315],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",315],["T_IF","if",317],"(",["T_VARIABLE","$this",317],["T_OBJECT_OPERATOR","->",317],["T_STRING","_redirectaddr",317],")",["T_WHITESPACE","\n\t\t\t\t\t",317],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",318],["T_COMMENT","\/* url was redirected, check if we've hit the max depth *\/",319],["T_WHITESPACE","\n\t\t\t\t\t\t",319],["T_IF","if",320],"(",["T_VARIABLE","$this",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","maxredirs",320],["T_WHITESPACE"," ",320],">",["T_WHITESPACE"," ",320],["T_VARIABLE","$this",320],["T_OBJECT_OPERATOR","->",320],["T_STRING","_redirectdepth",320],")",["T_WHITESPACE","\n\t\t\t\t\t\t",320],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",321],["T_IF","if",322],"(","!",["T_STRING","preg_match",322],"(",["T_CONSTANT_ENCAPSED_STRING","\"|^\"",322],".",["T_VARIABLE","$URI_PARTS",322],"[",["T_CONSTANT_ENCAPSED_STRING","\"scheme\"",322],"]",".",["T_CONSTANT_ENCAPSED_STRING","\":\/\/|\"",322],",",["T_WHITESPACE"," ",322],["T_VARIABLE","$this",322],["T_OBJECT_OPERATOR","->",322],["T_STRING","_redirectaddr",322],")",")",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",322],["T_VARIABLE","$this",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","_redirectaddr",323],["T_WHITESPACE"," ",323],"=",["T_WHITESPACE"," ",323],["T_VARIABLE","$this",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","_expandlinks",323],"(",["T_VARIABLE","$this",323],["T_OBJECT_OPERATOR","->",323],["T_STRING","_redirectaddr",323],",",["T_VARIABLE","$URI_PARTS",323],"[",["T_CONSTANT_ENCAPSED_STRING","\"scheme\"",323],"]",".",["T_CONSTANT_ENCAPSED_STRING","\":\/\/\"",323],".",["T_VARIABLE","$URI_PARTS",323],"[",["T_CONSTANT_ENCAPSED_STRING","\"host\"",323],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t\t",323],["T_COMMENT","\/\/ only follow redirect if it's on this site, or offsiteok is true\n",325],["T_WHITESPACE","\t\t\t\t\t\t\t",326],["T_IF","if",326],"(",["T_STRING","preg_match",326],"(",["T_CONSTANT_ENCAPSED_STRING","\"|^http:\/\/\"",326],".",["T_STRING","preg_quote",326],"(",["T_VARIABLE","$this",326],["T_OBJECT_OPERATOR","->",326],["T_STRING","host",326],")",".",["T_CONSTANT_ENCAPSED_STRING","\"|i\"",326],",",["T_VARIABLE","$this",326],["T_OBJECT_OPERATOR","->",326],["T_STRING","_redirectaddr",326],")",["T_WHITESPACE"," ",326],["T_BOOLEAN_OR","||",326],["T_WHITESPACE"," ",326],["T_VARIABLE","$this",326],["T_OBJECT_OPERATOR","->",326],["T_STRING","offsiteok",326],")",["T_WHITESPACE","\n\t\t\t\t\t\t\t",326],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",327],["T_COMMENT","\/* follow the redirect *\/",328],["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",328],["T_VARIABLE","$this",329],["T_OBJECT_OPERATOR","->",329],["T_STRING","_redirectdepth",329],["T_INC","++",329],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",329],["T_VARIABLE","$this",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","lastredirectaddr",330],"=",["T_VARIABLE","$this",330],["T_OBJECT_OPERATOR","->",330],["T_STRING","_redirectaddr",330],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",330],["T_IF","if",331],"(",["T_WHITESPACE"," ",331],["T_STRING","strpos",331],"(",["T_WHITESPACE"," ",331],["T_VARIABLE","$this",331],["T_OBJECT_OPERATOR","->",331],["T_STRING","_redirectaddr",331],",",["T_WHITESPACE"," ",331],["T_CONSTANT_ENCAPSED_STRING","\"?\"",331],["T_WHITESPACE"," ",331],")",["T_WHITESPACE"," ",331],">",["T_WHITESPACE"," ",331],["T_LNUMBER","0",331],["T_WHITESPACE"," ",331],")",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",331],["T_VARIABLE","$this",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","fetch",332],"(",["T_VARIABLE","$this",332],["T_OBJECT_OPERATOR","->",332],["T_STRING","_redirectaddr",332],")",";",["T_WHITESPACE"," ",332],["T_COMMENT","\/\/ the redirect has changed the request method from post to get\n",332],["T_WHITESPACE","\t\t\t\t\t\t\t\t",333],["T_ELSE","else",333],["T_WHITESPACE","\n\t\t\t\t\t\t\t\t\t",333],["T_VARIABLE","$this",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","submit",334],"(",["T_VARIABLE","$this",334],["T_OBJECT_OPERATOR","->",334],["T_STRING","_redirectaddr",334],",",["T_VARIABLE","$formvars",334],",",["T_WHITESPACE"," ",334],["T_VARIABLE","$formfiles",334],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",334],"}",["T_WHITESPACE","\n\t\t\t\t\t\t",335],"}",["T_WHITESPACE","\n\t\t\t\t\t",336],"}",["T_WHITESPACE","\n\n\t\t\t\t\t",337],["T_IF","if",339],"(",["T_VARIABLE","$this",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","_framedepth",339],["T_WHITESPACE"," ",339],"<",["T_WHITESPACE"," ",339],["T_VARIABLE","$this",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","maxframes",339],["T_WHITESPACE"," ",339],["T_BOOLEAN_AND","&&",339],["T_WHITESPACE"," ",339],["T_STRING","count",339],"(",["T_VARIABLE","$this",339],["T_OBJECT_OPERATOR","->",339],["T_STRING","_frameurls",339],")",["T_WHITESPACE"," ",339],">",["T_WHITESPACE"," ",339],["T_LNUMBER","0",339],")",["T_WHITESPACE","\n\t\t\t\t\t",339],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",340],["T_VARIABLE","$frameurls",341],["T_WHITESPACE"," ",341],"=",["T_WHITESPACE"," ",341],["T_VARIABLE","$this",341],["T_OBJECT_OPERATOR","->",341],["T_STRING","_frameurls",341],";",["T_WHITESPACE","\n\t\t\t\t\t\t",341],["T_VARIABLE","$this",342],["T_OBJECT_OPERATOR","->",342],["T_STRING","_frameurls",342],["T_WHITESPACE"," ",342],"=",["T_WHITESPACE"," ",342],["T_ARRAY","array",342],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t",342],["T_WHILE","while",344],"(",["T_LIST","list",344],"(",",",["T_VARIABLE","$frameurl",344],")",["T_WHITESPACE"," ",344],"=",["T_WHITESPACE"," ",344],["T_STRING","each",344],"(",["T_VARIABLE","$frameurls",344],")",")",["T_WHITESPACE","\n\t\t\t\t\t\t",344],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",345],["T_IF","if",346],"(",["T_VARIABLE","$this",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","_framedepth",346],["T_WHITESPACE"," ",346],"<",["T_WHITESPACE"," ",346],["T_VARIABLE","$this",346],["T_OBJECT_OPERATOR","->",346],["T_STRING","maxframes",346],")",["T_WHITESPACE","\n\t\t\t\t\t\t\t",346],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",347],["T_VARIABLE","$this",348],["T_OBJECT_OPERATOR","->",348],["T_STRING","fetch",348],"(",["T_VARIABLE","$frameurl",348],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",348],["T_VARIABLE","$this",349],["T_OBJECT_OPERATOR","->",349],["T_STRING","_framedepth",349],["T_INC","++",349],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",349],"}",["T_WHITESPACE","\n\t\t\t\t\t\t\t",350],["T_ELSE","else",351],["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",351],["T_BREAK","break",352],";",["T_WHITESPACE","\n\t\t\t\t\t\t",352],"}",["T_WHITESPACE","\n\t\t\t\t\t",353],"}",["T_WHITESPACE","\n\n\t\t\t\t",354],"}",["T_WHITESPACE","\n\t\t\t\t",356],["T_ELSE","else",357],["T_WHITESPACE","\n\t\t\t\t",357],"{",["T_WHITESPACE","\n\t\t\t\t\t",358],["T_RETURN","return",359],["T_WHITESPACE"," ",359],["T_STRING","false",359],";",["T_WHITESPACE","\n\t\t\t\t",359],"}",["T_WHITESPACE","\n\t\t\t\t",360],["T_RETURN","return",361],["T_WHITESPACE"," ",361],["T_STRING","true",361],";",["T_WHITESPACE","\n\t\t\t\t",361],["T_BREAK","break",362],";",["T_WHITESPACE","\n\t\t\t",362],["T_CASE","case",363],["T_WHITESPACE"," ",363],["T_CONSTANT_ENCAPSED_STRING","\"https\"",363],":",["T_WHITESPACE","\n\t\t\t\t",363],["T_IF","if",364],"(","!",["T_VARIABLE","$this",364],["T_OBJECT_OPERATOR","->",364],["T_STRING","curl_path",364],")",["T_WHITESPACE","\n\t\t\t\t\t",364],["T_RETURN","return",365],["T_WHITESPACE"," ",365],["T_STRING","false",365],";",["T_WHITESPACE","\n\t\t\t\t",365],["T_IF","if",366],"(",["T_STRING","function_exists",366],"(",["T_CONSTANT_ENCAPSED_STRING","\"is_executable\"",366],")",")",["T_WHITESPACE","\n\t\t\t\t    ",366],["T_IF","if",367],["T_WHITESPACE"," ",367],"(","!",["T_STRING","is_executable",367],"(",["T_VARIABLE","$this",367],["T_OBJECT_OPERATOR","->",367],["T_STRING","curl_path",367],")",")",["T_WHITESPACE","\n\t\t\t\t        ",367],["T_RETURN","return",368],["T_WHITESPACE"," ",368],["T_STRING","false",368],";",["T_WHITESPACE","\n\t\t\t\t",368],["T_VARIABLE","$this",369],["T_OBJECT_OPERATOR","->",369],["T_STRING","host",369],["T_WHITESPACE"," ",369],"=",["T_WHITESPACE"," ",369],["T_VARIABLE","$URI_PARTS",369],"[",["T_CONSTANT_ENCAPSED_STRING","\"host\"",369],"]",";",["T_WHITESPACE","\n\t\t\t\t",369],["T_IF","if",370],"(","!",["T_EMPTY","empty",370],"(",["T_VARIABLE","$URI_PARTS",370],"[",["T_CONSTANT_ENCAPSED_STRING","\"port\"",370],"]",")",")",["T_WHITESPACE","\n\t\t\t\t\t",370],["T_VARIABLE","$this",371],["T_OBJECT_OPERATOR","->",371],["T_STRING","port",371],["T_WHITESPACE"," ",371],"=",["T_WHITESPACE"," ",371],["T_VARIABLE","$URI_PARTS",371],"[",["T_CONSTANT_ENCAPSED_STRING","\"port\"",371],"]",";",["T_WHITESPACE","\n\t\t\t\t",371],["T_IF","if",372],"(",["T_VARIABLE","$this",372],["T_OBJECT_OPERATOR","->",372],["T_STRING","_isproxy",372],")",["T_WHITESPACE","\n\t\t\t\t",372],"{",["T_WHITESPACE","\n\t\t\t\t\t",373],["T_COMMENT","\/\/ using proxy, send entire URI\n",374],["T_WHITESPACE","\t\t\t\t\t",375],["T_VARIABLE","$this",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","_httpsrequest",375],"(",["T_VARIABLE","$URI",375],",",["T_WHITESPACE"," ",375],["T_VARIABLE","$URI",375],",",["T_WHITESPACE"," ",375],["T_VARIABLE","$this",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","_submit_method",375],",",["T_WHITESPACE"," ",375],["T_VARIABLE","$this",375],["T_OBJECT_OPERATOR","->",375],["T_STRING","_submit_type",375],",",["T_WHITESPACE"," ",375],["T_VARIABLE","$postdata",375],")",";",["T_WHITESPACE","\n\t\t\t\t",375],"}",["T_WHITESPACE","\n\t\t\t\t",376],["T_ELSE","else",377],["T_WHITESPACE","\n\t\t\t\t",377],"{",["T_WHITESPACE","\n\t\t\t\t\t",378],["T_VARIABLE","$path",379],["T_WHITESPACE"," ",379],"=",["T_WHITESPACE"," ",379],["T_VARIABLE","$URI_PARTS",379],"[",["T_CONSTANT_ENCAPSED_STRING","\"path\"",379],"]",".","(",["T_VARIABLE","$URI_PARTS",379],"[",["T_CONSTANT_ENCAPSED_STRING","\"query\"",379],"]",["T_WHITESPACE"," ",379],"?",["T_WHITESPACE"," ",379],["T_CONSTANT_ENCAPSED_STRING","\"?\"",379],".",["T_VARIABLE","$URI_PARTS",379],"[",["T_CONSTANT_ENCAPSED_STRING","\"query\"",379],"]",["T_WHITESPACE"," ",379],":",["T_WHITESPACE"," ",379],["T_CONSTANT_ENCAPSED_STRING","\"\"",379],")",";",["T_WHITESPACE","\n\t\t\t\t\t",379],["T_COMMENT","\/\/ no proxy, send only the path\n",380],["T_WHITESPACE","\t\t\t\t\t",381],["T_VARIABLE","$this",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","_httpsrequest",381],"(",["T_VARIABLE","$path",381],",",["T_WHITESPACE"," ",381],["T_VARIABLE","$URI",381],",",["T_WHITESPACE"," ",381],["T_VARIABLE","$this",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","_submit_method",381],",",["T_WHITESPACE"," ",381],["T_VARIABLE","$this",381],["T_OBJECT_OPERATOR","->",381],["T_STRING","_submit_type",381],",",["T_WHITESPACE"," ",381],["T_VARIABLE","$postdata",381],")",";",["T_WHITESPACE","\n\t\t\t\t",381],"}",["T_WHITESPACE","\n\n\t\t\t\t",382],["T_IF","if",384],"(",["T_VARIABLE","$this",384],["T_OBJECT_OPERATOR","->",384],["T_STRING","_redirectaddr",384],")",["T_WHITESPACE","\n\t\t\t\t",384],"{",["T_WHITESPACE","\n\t\t\t\t\t",385],["T_COMMENT","\/* url was redirected, check if we've hit the max depth *\/",386],["T_WHITESPACE","\n\t\t\t\t\t",386],["T_IF","if",387],"(",["T_VARIABLE","$this",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","maxredirs",387],["T_WHITESPACE"," ",387],">",["T_WHITESPACE"," ",387],["T_VARIABLE","$this",387],["T_OBJECT_OPERATOR","->",387],["T_STRING","_redirectdepth",387],")",["T_WHITESPACE","\n\t\t\t\t\t",387],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",388],["T_IF","if",389],"(","!",["T_STRING","preg_match",389],"(",["T_CONSTANT_ENCAPSED_STRING","\"|^\"",389],".",["T_VARIABLE","$URI_PARTS",389],"[",["T_CONSTANT_ENCAPSED_STRING","\"scheme\"",389],"]",".",["T_CONSTANT_ENCAPSED_STRING","\":\/\/|\"",389],",",["T_WHITESPACE"," ",389],["T_VARIABLE","$this",389],["T_OBJECT_OPERATOR","->",389],["T_STRING","_redirectaddr",389],")",")",["T_WHITESPACE","\n\t\t\t\t\t\t\t",389],["T_VARIABLE","$this",390],["T_OBJECT_OPERATOR","->",390],["T_STRING","_redirectaddr",390],["T_WHITESPACE"," ",390],"=",["T_WHITESPACE"," ",390],["T_VARIABLE","$this",390],["T_OBJECT_OPERATOR","->",390],["T_STRING","_expandlinks",390],"(",["T_VARIABLE","$this",390],["T_OBJECT_OPERATOR","->",390],["T_STRING","_redirectaddr",390],",",["T_VARIABLE","$URI_PARTS",390],"[",["T_CONSTANT_ENCAPSED_STRING","\"scheme\"",390],"]",".",["T_CONSTANT_ENCAPSED_STRING","\":\/\/\"",390],".",["T_VARIABLE","$URI_PARTS",390],"[",["T_CONSTANT_ENCAPSED_STRING","\"host\"",390],"]",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t",390],["T_COMMENT","\/\/ only follow redirect if it's on this site, or offsiteok is true\n",392],["T_WHITESPACE","\t\t\t\t\t\t",393],["T_IF","if",393],"(",["T_STRING","preg_match",393],"(",["T_CONSTANT_ENCAPSED_STRING","\"|^http:\/\/\"",393],".",["T_STRING","preg_quote",393],"(",["T_VARIABLE","$this",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","host",393],")",".",["T_CONSTANT_ENCAPSED_STRING","\"|i\"",393],",",["T_VARIABLE","$this",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","_redirectaddr",393],")",["T_WHITESPACE"," ",393],["T_BOOLEAN_OR","||",393],["T_WHITESPACE"," ",393],["T_VARIABLE","$this",393],["T_OBJECT_OPERATOR","->",393],["T_STRING","offsiteok",393],")",["T_WHITESPACE","\n\t\t\t\t\t\t",393],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",394],["T_COMMENT","\/* follow the redirect *\/",395],["T_WHITESPACE","\n\t\t\t\t\t\t\t",395],["T_VARIABLE","$this",396],["T_OBJECT_OPERATOR","->",396],["T_STRING","_redirectdepth",396],["T_INC","++",396],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",396],["T_VARIABLE","$this",397],["T_OBJECT_OPERATOR","->",397],["T_STRING","lastredirectaddr",397],"=",["T_VARIABLE","$this",397],["T_OBJECT_OPERATOR","->",397],["T_STRING","_redirectaddr",397],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",397],["T_IF","if",398],"(",["T_WHITESPACE"," ",398],["T_STRING","strpos",398],"(",["T_WHITESPACE"," ",398],["T_VARIABLE","$this",398],["T_OBJECT_OPERATOR","->",398],["T_STRING","_redirectaddr",398],",",["T_WHITESPACE"," ",398],["T_CONSTANT_ENCAPSED_STRING","\"?\"",398],["T_WHITESPACE"," ",398],")",["T_WHITESPACE"," ",398],">",["T_WHITESPACE"," ",398],["T_LNUMBER","0",398],["T_WHITESPACE"," ",398],")",["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",398],["T_VARIABLE","$this",399],["T_OBJECT_OPERATOR","->",399],["T_STRING","fetch",399],"(",["T_VARIABLE","$this",399],["T_OBJECT_OPERATOR","->",399],["T_STRING","_redirectaddr",399],")",";",["T_WHITESPACE"," ",399],["T_COMMENT","\/\/ the redirect has changed the request method from post to get\n",399],["T_WHITESPACE","\t\t\t\t\t\t\t",400],["T_ELSE","else",400],["T_WHITESPACE","\n\t\t\t\t\t\t\t\t",400],["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","submit",401],"(",["T_VARIABLE","$this",401],["T_OBJECT_OPERATOR","->",401],["T_STRING","_redirectaddr",401],",",["T_VARIABLE","$formvars",401],",",["T_WHITESPACE"," ",401],["T_VARIABLE","$formfiles",401],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t",401],"}",["T_WHITESPACE","\n\t\t\t\t\t",402],"}",["T_WHITESPACE","\n\t\t\t\t",403],"}",["T_WHITESPACE","\n\n\t\t\t\t",404],["T_IF","if",406],"(",["T_VARIABLE","$this",406],["T_OBJECT_OPERATOR","->",406],["T_STRING","_framedepth",406],["T_WHITESPACE"," ",406],"<",["T_WHITESPACE"," ",406],["T_VARIABLE","$this",406],["T_OBJECT_OPERATOR","->",406],["T_STRING","maxframes",406],["T_WHITESPACE"," ",406],["T_BOOLEAN_AND","&&",406],["T_WHITESPACE"," ",406],["T_STRING","count",406],"(",["T_VARIABLE","$this",406],["T_OBJECT_OPERATOR","->",406],["T_STRING","_frameurls",406],")",["T_WHITESPACE"," ",406],">",["T_WHITESPACE"," ",406],["T_LNUMBER","0",406],")",["T_WHITESPACE","\n\t\t\t\t",406],"{",["T_WHITESPACE","\n\t\t\t\t\t",407],["T_VARIABLE","$frameurls",408],["T_WHITESPACE"," ",408],"=",["T_WHITESPACE"," ",408],["T_VARIABLE","$this",408],["T_OBJECT_OPERATOR","->",408],["T_STRING","_frameurls",408],";",["T_WHITESPACE","\n\t\t\t\t\t",408],["T_VARIABLE","$this",409],["T_OBJECT_OPERATOR","->",409],["T_STRING","_frameurls",409],["T_WHITESPACE"," ",409],"=",["T_WHITESPACE"," ",409],["T_ARRAY","array",409],"(",")",";",["T_WHITESPACE","\n\n\t\t\t\t\t",409],["T_WHILE","while",411],"(",["T_LIST","list",411],"(",",",["T_VARIABLE","$frameurl",411],")",["T_WHITESPACE"," ",411],"=",["T_WHITESPACE"," ",411],["T_STRING","each",411],"(",["T_VARIABLE","$frameurls",411],")",")",["T_WHITESPACE","\n\t\t\t\t\t",411],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",412],["T_IF","if",413],"(",["T_VARIABLE","$this",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","_framedepth",413],["T_WHITESPACE"," ",413],"<",["T_WHITESPACE"," ",413],["T_VARIABLE","$this",413],["T_OBJECT_OPERATOR","->",413],["T_STRING","maxframes",413],")",["T_WHITESPACE","\n\t\t\t\t\t\t",413],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",414],["T_VARIABLE","$this",415],["T_OBJECT_OPERATOR","->",415],["T_STRING","fetch",415],"(",["T_VARIABLE","$frameurl",415],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",415],["T_VARIABLE","$this",416],["T_OBJECT_OPERATOR","->",416],["T_STRING","_framedepth",416],["T_INC","++",416],";",["T_WHITESPACE","\n\t\t\t\t\t\t",416],"}",["T_WHITESPACE","\n\t\t\t\t\t\t",417],["T_ELSE","else",418],["T_WHITESPACE","\n\t\t\t\t\t\t\t",418],["T_BREAK","break",419],";",["T_WHITESPACE","\n\t\t\t\t\t",419],"}",["T_WHITESPACE","\n\t\t\t\t",420],"}",["T_WHITESPACE","\n\t\t\t\t",421],["T_RETURN","return",422],["T_WHITESPACE"," ",422],["T_STRING","true",422],";",["T_WHITESPACE","\n\t\t\t\t",422],["T_BREAK","break",423],";",["T_WHITESPACE","\n\n\t\t\t",423],["T_DEFAULT","default",425],":",["T_WHITESPACE","\n\t\t\t\t",425],["T_COMMENT","\/\/ not a valid protocol\n",426],["T_WHITESPACE","\t\t\t\t",427],["T_VARIABLE","$this",427],["T_OBJECT_OPERATOR","->",427],["T_STRING","error",427],["T_WHITESPACE","\t",427],"=",["T_WHITESPACE","\t",427],["T_CONSTANT_ENCAPSED_STRING","'Invalid protocol \"'",427],".",["T_VARIABLE","$URI_PARTS",427],"[",["T_CONSTANT_ENCAPSED_STRING","\"scheme\"",427],"]",".",["T_CONSTANT_ENCAPSED_STRING","'\"\\n'",427],";",["T_WHITESPACE","\n\t\t\t\t",427],["T_RETURN","return",428],["T_WHITESPACE"," ",428],["T_STRING","false",428],";",["T_WHITESPACE","\n\t\t\t\t",428],["T_BREAK","break",429],";",["T_WHITESPACE","\n\t\t",429],"}",["T_WHITESPACE","\n\t\t",430],["T_RETURN","return",431],["T_WHITESPACE"," ",431],["T_STRING","true",431],";",["T_WHITESPACE","\n\t",431],"}",["T_WHITESPACE","\n\n",432],["T_COMMENT","\/*======================================================================*\\\n\tFunction:\tfetchlinks\n\tPurpose:\tfetch the links from a web page\n\tInput:\t\t$URI\twhere you are fetching from\n\tOutput:\t\t$this->results\tan array of the URLs\n\\*======================================================================*\/",434],["T_WHITESPACE","\n\n\t",439],["T_FUNCTION","function",441],["T_WHITESPACE"," ",441],["T_STRING","fetchlinks",441],"(",["T_VARIABLE","$URI",441],")",["T_WHITESPACE","\n\t",441],"{",["T_WHITESPACE","\n\t\t",442],["T_IF","if",443],["T_WHITESPACE"," ",443],"(",["T_VARIABLE","$this",443],["T_OBJECT_OPERATOR","->",443],["T_STRING","fetch",443],"(",["T_VARIABLE","$URI",443],")",")",["T_WHITESPACE","\n\t\t",443],"{",["T_WHITESPACE","\n\t\t\t",444],["T_IF","if",445],"(",["T_VARIABLE","$this",445],["T_OBJECT_OPERATOR","->",445],["T_STRING","lastredirectaddr",445],")",["T_WHITESPACE","\n\t\t\t\t",445],["T_VARIABLE","$URI",446],["T_WHITESPACE"," ",446],"=",["T_WHITESPACE"," ",446],["T_VARIABLE","$this",446],["T_OBJECT_OPERATOR","->",446],["T_STRING","lastredirectaddr",446],";",["T_WHITESPACE","\n\t\t\t",446],["T_IF","if",447],"(",["T_STRING","is_array",447],"(",["T_VARIABLE","$this",447],["T_OBJECT_OPERATOR","->",447],["T_STRING","results",447],")",")",["T_WHITESPACE","\n\t\t\t",447],"{",["T_WHITESPACE","\n\t\t\t\t",448],["T_FOR","for",449],"(",["T_VARIABLE","$x",449],"=",["T_LNUMBER","0",449],";",["T_VARIABLE","$x",449],"<",["T_STRING","count",449],"(",["T_VARIABLE","$this",449],["T_OBJECT_OPERATOR","->",449],["T_STRING","results",449],")",";",["T_VARIABLE","$x",449],["T_INC","++",449],")",["T_WHITESPACE","\n\t\t\t\t\t",449],["T_VARIABLE","$this",450],["T_OBJECT_OPERATOR","->",450],["T_STRING","results",450],"[",["T_VARIABLE","$x",450],"]",["T_WHITESPACE"," ",450],"=",["T_WHITESPACE"," ",450],["T_VARIABLE","$this",450],["T_OBJECT_OPERATOR","->",450],["T_STRING","_striplinks",450],"(",["T_VARIABLE","$this",450],["T_OBJECT_OPERATOR","->",450],["T_STRING","results",450],"[",["T_VARIABLE","$x",450],"]",")",";",["T_WHITESPACE","\n\t\t\t",450],"}",["T_WHITESPACE","\n\t\t\t",451],["T_ELSE","else",452],["T_WHITESPACE","\n\t\t\t\t",452],["T_VARIABLE","$this",453],["T_OBJECT_OPERATOR","->",453],["T_STRING","results",453],["T_WHITESPACE"," ",453],"=",["T_WHITESPACE"," ",453],["T_VARIABLE","$this",453],["T_OBJECT_OPERATOR","->",453],["T_STRING","_striplinks",453],"(",["T_VARIABLE","$this",453],["T_OBJECT_OPERATOR","->",453],["T_STRING","results",453],")",";",["T_WHITESPACE","\n\n\t\t\t",453],["T_IF","if",455],"(",["T_VARIABLE","$this",455],["T_OBJECT_OPERATOR","->",455],["T_STRING","expandlinks",455],")",["T_WHITESPACE","\n\t\t\t\t",455],["T_VARIABLE","$this",456],["T_OBJECT_OPERATOR","->",456],["T_STRING","results",456],["T_WHITESPACE"," ",456],"=",["T_WHITESPACE"," ",456],["T_VARIABLE","$this",456],["T_OBJECT_OPERATOR","->",456],["T_STRING","_expandlinks",456],"(",["T_VARIABLE","$this",456],["T_OBJECT_OPERATOR","->",456],["T_STRING","results",456],",",["T_WHITESPACE"," ",456],["T_VARIABLE","$URI",456],")",";",["T_WHITESPACE","\n\t\t\t",456],["T_RETURN","return",457],["T_WHITESPACE"," ",457],["T_STRING","true",457],";",["T_WHITESPACE","\n\t\t",457],"}",["T_WHITESPACE","\n\t\t",458],["T_ELSE","else",459],["T_WHITESPACE","\n\t\t\t",459],["T_RETURN","return",460],["T_WHITESPACE"," ",460],["T_STRING","false",460],";",["T_WHITESPACE","\n\t",460],"}",["T_WHITESPACE","\n\n",461],["T_COMMENT","\/*======================================================================*\\\n\tFunction:\tfetchform\n\tPurpose:\tfetch the form elements from a web page\n\tInput:\t\t$URI\twhere you are fetching from\n\tOutput:\t\t$this->results\tthe resulting html form\n\\*======================================================================*\/",463],["T_WHITESPACE","\n\n\t",468],["T_FUNCTION","function",470],["T_WHITESPACE"," ",470],["T_STRING","fetchform",470],"(",["T_VARIABLE","$URI",470],")",["T_WHITESPACE","\n\t",470],"{",["T_WHITESPACE","\n\n\t\t",471],["T_IF","if",473],["T_WHITESPACE"," ",473],"(",["T_VARIABLE","$this",473],["T_OBJECT_OPERATOR","->",473],["T_STRING","fetch",473],"(",["T_VARIABLE","$URI",473],")",")",["T_WHITESPACE","\n\t\t",473],"{",["T_WHITESPACE","\n\n\t\t\t",474],["T_IF","if",476],"(",["T_STRING","is_array",476],"(",["T_VARIABLE","$this",476],["T_OBJECT_OPERATOR","->",476],["T_STRING","results",476],")",")",["T_WHITESPACE","\n\t\t\t",476],"{",["T_WHITESPACE","\n\t\t\t\t",477],["T_FOR","for",478],"(",["T_VARIABLE","$x",478],"=",["T_LNUMBER","0",478],";",["T_VARIABLE","$x",478],"<",["T_STRING","count",478],"(",["T_VARIABLE","$this",478],["T_OBJECT_OPERATOR","->",478],["T_STRING","results",478],")",";",["T_VARIABLE","$x",478],["T_INC","++",478],")",["T_WHITESPACE","\n\t\t\t\t\t",478],["T_VARIABLE","$this",479],["T_OBJECT_OPERATOR","->",479],["T_STRING","results",479],"[",["T_VARIABLE","$x",479],"]",["T_WHITESPACE"," ",479],"=",["T_WHITESPACE"," ",479],["T_VARIABLE","$this",479],["T_OBJECT_OPERATOR","->",479],["T_STRING","_stripform",479],"(",["T_VARIABLE","$this",479],["T_OBJECT_OPERATOR","->",479],["T_STRING","results",479],"[",["T_VARIABLE","$x",479],"]",")",";",["T_WHITESPACE","\n\t\t\t",479],"}",["T_WHITESPACE","\n\t\t\t",480],["T_ELSE","else",481],["T_WHITESPACE","\n\t\t\t\t",481],["T_VARIABLE","$this",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","results",482],["T_WHITESPACE"," ",482],"=",["T_WHITESPACE"," ",482],["T_VARIABLE","$this",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","_stripform",482],"(",["T_VARIABLE","$this",482],["T_OBJECT_OPERATOR","->",482],["T_STRING","results",482],")",";",["T_WHITESPACE","\n\n\t\t\t",482],["T_RETURN","return",484],["T_WHITESPACE"," ",484],["T_STRING","true",484],";",["T_WHITESPACE","\n\t\t",484],"}",["T_WHITESPACE","\n\t\t",485],["T_ELSE","else",486],["T_WHITESPACE","\n\t\t\t",486],["T_RETURN","return",487],["T_WHITESPACE"," ",487],["T_STRING","false",487],";",["T_WHITESPACE","\n\t",487],"}",["T_WHITESPACE","\n\n\n",488],["T_COMMENT","\/*======================================================================*\\\n\tFunction:\tfetchtext\n\tPurpose:\tfetch the text from a web page, stripping the links\n\tInput:\t\t$URI\twhere you are fetching from\n\tOutput:\t\t$this->results\tthe text from the web page\n\\*======================================================================*\/",491],["T_WHITESPACE","\n\n\t",496],["T_FUNCTION","function",498],["T_WHITESPACE"," ",498],["T_STRING","fetchtext",498],"(",["T_VARIABLE","$URI",498],")",["T_WHITESPACE","\n\t",498],"{",["T_WHITESPACE","\n\t\t",499],["T_IF","if",500],"(",["T_VARIABLE","$this",500],["T_OBJECT_OPERATOR","->",500],["T_STRING","fetch",500],"(",["T_VARIABLE","$URI",500],")",")",["T_WHITESPACE","\n\t\t",500],"{",["T_WHITESPACE","\n\t\t\t",501],["T_IF","if",502],"(",["T_STRING","is_array",502],"(",["T_VARIABLE","$this",502],["T_OBJECT_OPERATOR","->",502],["T_STRING","results",502],")",")",["T_WHITESPACE","\n\t\t\t",502],"{",["T_WHITESPACE","\n\t\t\t\t",503],["T_FOR","for",504],"(",["T_VARIABLE","$x",504],"=",["T_LNUMBER","0",504],";",["T_VARIABLE","$x",504],"<",["T_STRING","count",504],"(",["T_VARIABLE","$this",504],["T_OBJECT_OPERATOR","->",504],["T_STRING","results",504],")",";",["T_VARIABLE","$x",504],["T_INC","++",504],")",["T_WHITESPACE","\n\t\t\t\t\t",504],["T_VARIABLE","$this",505],["T_OBJECT_OPERATOR","->",505],["T_STRING","results",505],"[",["T_VARIABLE","$x",505],"]",["T_WHITESPACE"," ",505],"=",["T_WHITESPACE"," ",505],["T_VARIABLE","$this",505],["T_OBJECT_OPERATOR","->",505],["T_STRING","_striptext",505],"(",["T_VARIABLE","$this",505],["T_OBJECT_OPERATOR","->",505],["T_STRING","results",505],"[",["T_VARIABLE","$x",505],"]",")",";",["T_WHITESPACE","\n\t\t\t",505],"}",["T_WHITESPACE","\n\t\t\t",506],["T_ELSE","else",507],["T_WHITESPACE","\n\t\t\t\t",507],["T_VARIABLE","$this",508],["T_OBJECT_OPERATOR","->",508],["T_STRING","results",508],["T_WHITESPACE"," ",508],"=",["T_WHITESPACE"," ",508],["T_VARIABLE","$this",508],["T_OBJECT_OPERATOR","->",508],["T_STRING","_striptext",508],"(",["T_VARIABLE","$this",508],["T_OBJECT_OPERATOR","->",508],["T_STRING","results",508],")",";",["T_WHITESPACE","\n\t\t\t",508],["T_RETURN","return",509],["T_WHITESPACE"," ",509],["T_STRING","true",509],";",["T_WHITESPACE","\n\t\t",509],"}",["T_WHITESPACE","\n\t\t",510],["T_ELSE","else",511],["T_WHITESPACE","\n\t\t\t",511],["T_RETURN","return",512],["T_WHITESPACE"," ",512],["T_STRING","false",512],";",["T_WHITESPACE","\n\t",512],"}",["T_WHITESPACE","\n\n",513],["T_COMMENT","\/*======================================================================*\\\n\tFunction:\tsubmitlinks\n\tPurpose:\tgrab links from a form submission\n\tInput:\t\t$URI\twhere you are submitting from\n\tOutput:\t\t$this->results\tan array of the links from the post\n\\*======================================================================*\/",515],["T_WHITESPACE","\n\n\t",520],["T_FUNCTION","function",522],["T_WHITESPACE"," ",522],["T_STRING","submitlinks",522],"(",["T_VARIABLE","$URI",522],",",["T_WHITESPACE"," ",522],["T_VARIABLE","$formvars",522],"=",["T_CONSTANT_ENCAPSED_STRING","\"\"",522],",",["T_WHITESPACE"," ",522],["T_VARIABLE","$formfiles",522],"=",["T_CONSTANT_ENCAPSED_STRING","\"\"",522],")",["T_WHITESPACE","\n\t",522],"{",["T_WHITESPACE","\n\t\t",523],["T_IF","if",524],"(",["T_VARIABLE","$this",524],["T_OBJECT_OPERATOR","->",524],["T_STRING","submit",524],"(",["T_VARIABLE","$URI",524],",",["T_VARIABLE","$formvars",524],",",["T_WHITESPACE"," ",524],["T_VARIABLE","$formfiles",524],")",")",["T_WHITESPACE","\n\t\t",524],"{",["T_WHITESPACE","\n\t\t\t",525],["T_IF","if",526],"(",["T_VARIABLE","$this",526],["T_OBJECT_OPERATOR","->",526],["T_STRING","lastredirectaddr",526],")",["T_WHITESPACE","\n\t\t\t\t",526],["T_VARIABLE","$URI",527],["T_WHITESPACE"," ",527],"=",["T_WHITESPACE"," ",527],["T_VARIABLE","$this",527],["T_OBJECT_OPERATOR","->",527],["T_STRING","lastredirectaddr",527],";",["T_WHITESPACE","\n\t\t\t",527],["T_IF","if",528],"(",["T_STRING","is_array",528],"(",["T_VARIABLE","$this",528],["T_OBJECT_OPERATOR","->",528],["T_STRING","results",528],")",")",["T_WHITESPACE","\n\t\t\t",528],"{",["T_WHITESPACE","\n\t\t\t\t",529],["T_FOR","for",530],"(",["T_VARIABLE","$x",530],"=",["T_LNUMBER","0",530],";",["T_VARIABLE","$x",530],"<",["T_STRING","count",530],"(",["T_VARIABLE","$this",530],["T_OBJECT_OPERATOR","->",530],["T_STRING","results",530],")",";",["T_VARIABLE","$x",530],["T_INC","++",530],")",["T_WHITESPACE","\n\t\t\t\t",530],"{",["T_WHITESPACE","\n\t\t\t\t\t",531],["T_VARIABLE","$this",532],["T_OBJECT_OPERATOR","->",532],["T_STRING","results",532],"[",["T_VARIABLE","$x",532],"]",["T_WHITESPACE"," ",532],"=",["T_WHITESPACE"," ",532],["T_VARIABLE","$this",532],["T_OBJECT_OPERATOR","->",532],["T_STRING","_striplinks",532],"(",["T_VARIABLE","$this",532],["T_OBJECT_OPERATOR","->",532],["T_STRING","results",532],"[",["T_VARIABLE","$x",532],"]",")",";",["T_WHITESPACE","\n\t\t\t\t\t",532],["T_IF","if",533],"(",["T_VARIABLE","$this",533],["T_OBJECT_OPERATOR","->",533],["T_STRING","expandlinks",533],")",["T_WHITESPACE","\n\t\t\t\t\t\t",533],["T_VARIABLE","$this",534],["T_OBJECT_OPERATOR","->",534],["T_STRING","results",534],"[",["T_VARIABLE","$x",534],"]",["T_WHITESPACE"," ",534],"=",["T_WHITESPACE"," ",534],["T_VARIABLE","$this",534],["T_OBJECT_OPERATOR","->",534],["T_STRING","_expandlinks",534],"(",["T_VARIABLE","$this",534],["T_OBJECT_OPERATOR","->",534],["T_STRING","results",534],"[",["T_VARIABLE","$x",534],"]",",",["T_VARIABLE","$URI",534],")",";",["T_WHITESPACE","\n\t\t\t\t",534],"}",["T_WHITESPACE","\n\t\t\t",535],"}",["T_WHITESPACE","\n\t\t\t",536],["T_ELSE","else",537],["T_WHITESPACE","\n\t\t\t",537],"{",["T_WHITESPACE","\n\t\t\t\t",538],["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","results",539],["T_WHITESPACE"," ",539],"=",["T_WHITESPACE"," ",539],["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","_striplinks",539],"(",["T_VARIABLE","$this",539],["T_OBJECT_OPERATOR","->",539],["T_STRING","results",539],")",";",["T_WHITESPACE","\n\t\t\t\t",539],["T_IF","if",540],"(",["T_VARIABLE","$this",540],["T_OBJECT_OPERATOR","->",540],["T_STRING","expandlinks",540],")",["T_WHITESPACE","\n\t\t\t\t\t",540],["T_VARIABLE","$this",541],["T_OBJECT_OPERATOR","->",541],["T_STRING","results",541],["T_WHITESPACE"," ",541],"=",["T_WHITESPACE"," ",541],["T_VARIABLE","$this",541],["T_OBJECT_OPERATOR","->",541],["T_STRING","_expandlinks",541],"(",["T_VARIABLE","$this",541],["T_OBJECT_OPERATOR","->",541],["T_STRING","results",541],",",["T_VARIABLE","$URI",541],")",";",["T_WHITESPACE","\n\t\t\t",541],"}",["T_WHITESPACE","\n\t\t\t",542],["T_RETURN","return",543],["T_WHITESPACE"," ",543],["T_STRING","true",543],";",["T_WHITESPACE","\n\t\t",543],"}",["T_WHITESPACE","\n\t\t",544],["T_ELSE","else",545],["T_WHITESPACE","\n\t\t\t",545],["T_RETURN","return",546],["T_WHITESPACE"," ",546],["T_STRING","false",546],";",["T_WHITESPACE","\n\t",546],"}",["T_WHITESPACE","\n\n",547],["T_COMMENT","\/*======================================================================*\\\n\tFunction:\tsubmittext\n\tPurpose:\tgrab text from a form submission\n\tInput:\t\t$URI\twhere you are submitting from\n\tOutput:\t\t$this->results\tthe text from the web page\n\\*======================================================================*\/",549],["T_WHITESPACE","\n\n\t",554],["T_FUNCTION","function",556],["T_WHITESPACE"," ",556],["T_STRING","submittext",556],"(",["T_VARIABLE","$URI",556],",",["T_WHITESPACE"," ",556],["T_VARIABLE","$formvars",556],["T_WHITESPACE"," ",556],"=",["T_WHITESPACE"," ",556],["T_CONSTANT_ENCAPSED_STRING","\"\"",556],",",["T_WHITESPACE"," ",556],["T_VARIABLE","$formfiles",556],["T_WHITESPACE"," ",556],"=",["T_WHITESPACE"," ",556],["T_CONSTANT_ENCAPSED_STRING","\"\"",556],")",["T_WHITESPACE","\n\t",556],"{",["T_WHITESPACE","\n\t\t",557],["T_IF","if",558],"(",["T_VARIABLE","$this",558],["T_OBJECT_OPERATOR","->",558],["T_STRING","submit",558],"(",["T_VARIABLE","$URI",558],",",["T_VARIABLE","$formvars",558],",",["T_WHITESPACE"," ",558],["T_VARIABLE","$formfiles",558],")",")",["T_WHITESPACE","\n\t\t",558],"{",["T_WHITESPACE","\n\t\t\t",559],["T_IF","if",560],"(",["T_VARIABLE","$this",560],["T_OBJECT_OPERATOR","->",560],["T_STRING","lastredirectaddr",560],")",["T_WHITESPACE","\n\t\t\t\t",560],["T_VARIABLE","$URI",561],["T_WHITESPACE"," ",561],"=",["T_WHITESPACE"," ",561],["T_VARIABLE","$this",561],["T_OBJECT_OPERATOR","->",561],["T_STRING","lastredirectaddr",561],";",["T_WHITESPACE","\n\t\t\t",561],["T_IF","if",562],"(",["T_STRING","is_array",562],"(",["T_VARIABLE","$this",562],["T_OBJECT_OPERATOR","->",562],["T_STRING","results",562],")",")",["T_WHITESPACE","\n\t\t\t",562],"{",["T_WHITESPACE","\n\t\t\t\t",563],["T_FOR","for",564],"(",["T_VARIABLE","$x",564],"=",["T_LNUMBER","0",564],";",["T_VARIABLE","$x",564],"<",["T_STRING","count",564],"(",["T_VARIABLE","$this",564],["T_OBJECT_OPERATOR","->",564],["T_STRING","results",564],")",";",["T_VARIABLE","$x",564],["T_INC","++",564],")",["T_WHITESPACE","\n\t\t\t\t",564],"{",["T_WHITESPACE","\n\t\t\t\t\t",565],["T_VARIABLE","$this",566],["T_OBJECT_OPERATOR","->",566],["T_STRING","results",566],"[",["T_VARIABLE","$x",566],"]",["T_WHITESPACE"," ",566],"=",["T_WHITESPACE"," ",566],["T_VARIABLE","$this",566],["T_OBJECT_OPERATOR","->",566],["T_STRING","_striptext",566],"(",["T_VARIABLE","$this",566],["T_OBJECT_OPERATOR","->",566],["T_STRING","results",566],"[",["T_VARIABLE","$x",566],"]",")",";",["T_WHITESPACE","\n\t\t\t\t\t",566],["T_IF","if",567],"(",["T_VARIABLE","$this",567],["T_OBJECT_OPERATOR","->",567],["T_STRING","expandlinks",567],")",["T_WHITESPACE","\n\t\t\t\t\t\t",567],["T_VARIABLE","$this",568],["T_OBJECT_OPERATOR","->",568],["T_STRING","results",568],"[",["T_VARIABLE","$x",568],"]",["T_WHITESPACE"," ",568],"=",["T_WHITESPACE"," ",568],["T_VARIABLE","$this",568],["T_OBJECT_OPERATOR","->",568],["T_STRING","_expandlinks",568],"(",["T_VARIABLE","$this",568],["T_OBJECT_OPERATOR","->",568],["T_STRING","results",568],"[",["T_VARIABLE","$x",568],"]",",",["T_VARIABLE","$URI",568],")",";",["T_WHITESPACE","\n\t\t\t\t",568],"}",["T_WHITESPACE","\n\t\t\t",569],"}",["T_WHITESPACE","\n\t\t\t",570],["T_ELSE","else",571],["T_WHITESPACE","\n\t\t\t",571],"{",["T_WHITESPACE","\n\t\t\t\t",572],["T_VARIABLE","$this",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","results",573],["T_WHITESPACE"," ",573],"=",["T_WHITESPACE"," ",573],["T_VARIABLE","$this",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","_striptext",573],"(",["T_VARIABLE","$this",573],["T_OBJECT_OPERATOR","->",573],["T_STRING","results",573],")",";",["T_WHITESPACE","\n\t\t\t\t",573],["T_IF","if",574],"(",["T_VARIABLE","$this",574],["T_OBJECT_OPERATOR","->",574],["T_STRING","expandlinks",574],")",["T_WHITESPACE","\n\t\t\t\t\t",574],["T_VARIABLE","$this",575],["T_OBJECT_OPERATOR","->",575],["T_STRING","results",575],["T_WHITESPACE"," ",575],"=",["T_WHITESPACE"," ",575],["T_VARIABLE","$this",575],["T_OBJECT_OPERATOR","->",575],["T_STRING","_expandlinks",575],"(",["T_VARIABLE","$this",575],["T_OBJECT_OPERATOR","->",575],["T_STRING","results",575],",",["T_VARIABLE","$URI",575],")",";",["T_WHITESPACE","\n\t\t\t",575],"}",["T_WHITESPACE","\n\t\t\t",576],["T_RETURN","return",577],["T_WHITESPACE"," ",577],["T_STRING","true",577],";",["T_WHITESPACE","\n\t\t",577],"}",["T_WHITESPACE","\n\t\t",578],["T_ELSE","else",579],["T_WHITESPACE","\n\t\t\t",579],["T_RETURN","return",580],["T_WHITESPACE"," ",580],["T_STRING","false",580],";",["T_WHITESPACE","\n\t",580],"}",["T_WHITESPACE","\n\n\n\n",581],["T_COMMENT","\/*======================================================================*\\\n\tFunction:\tset_submit_multipart\n\tPurpose:\tSet the form submission content type to\n\t\t\t\tmultipart\/form-data\n\\*======================================================================*\/",585],["T_WHITESPACE","\n\t",589],["T_FUNCTION","function",590],["T_WHITESPACE"," ",590],["T_STRING","set_submit_multipart",590],"(",")",["T_WHITESPACE","\n\t",590],"{",["T_WHITESPACE","\n\t\t",591],["T_VARIABLE","$this",592],["T_OBJECT_OPERATOR","->",592],["T_STRING","_submit_type",592],["T_WHITESPACE"," ",592],"=",["T_WHITESPACE"," ",592],["T_CONSTANT_ENCAPSED_STRING","\"multipart\/form-data\"",592],";",["T_WHITESPACE","\n\t",592],"}",["T_WHITESPACE","\n\n\n",593],["T_COMMENT","\/*======================================================================*\\\n\tFunction:\tset_submit_normal\n\tPurpose:\tSet the form submission content type to\n\t\t\t\tapplication\/x-www-form-urlencoded\n\\*======================================================================*\/",596],["T_WHITESPACE","\n\t",600],["T_FUNCTION","function",601],["T_WHITESPACE"," ",601],["T_STRING","set_submit_normal",601],"(",")",["T_WHITESPACE","\n\t",601],"{",["T_WHITESPACE","\n\t\t",602],["T_VARIABLE","$this",603],["T_OBJECT_OPERATOR","->",603],["T_STRING","_submit_type",603],["T_WHITESPACE"," ",603],"=",["T_WHITESPACE"," ",603],["T_CONSTANT_ENCAPSED_STRING","\"application\/x-www-form-urlencoded\"",603],";",["T_WHITESPACE","\n\t",603],"}",["T_WHITESPACE","\n\n\n\n\n",604],["T_COMMENT","\/*======================================================================*\\\n\tPrivate functions\n\\*======================================================================*\/",609],["T_WHITESPACE","\n\n\n",611],["T_COMMENT","\/*======================================================================*\\\n\tFunction:\t_striplinks\n\tPurpose:\tstrip the hyperlinks from an html document\n\tInput:\t\t$document\tdocument to strip.\n\tOutput:\t\t$match\t\tan array of the links\n\\*======================================================================*\/",614],["T_WHITESPACE","\n\n\t",619],["T_FUNCTION","function",621],["T_WHITESPACE"," ",621],["T_STRING","_striplinks",621],"(",["T_VARIABLE","$document",621],")",["T_WHITESPACE","\n\t",621],"{",["T_WHITESPACE","\n\t\t",622],["T_STRING","preg_match_all",623],"(",["T_CONSTANT_ENCAPSED_STRING","\"'<\\s*a\\s.*?href\\s*=\\s*\t\t\t# find <a href=\n\t\t\t\t\t\t([\\\"\\'])?\t\t\t\t\t# find single or double quote\n\t\t\t\t\t\t(?(1) (.*?)\\\\1 | ([^\\s\\>]+))\t\t# if quote found, match up to next matching\n\t\t\t\t\t\t\t\t\t\t\t\t\t# quote, otherwise match up to next space\n\t\t\t\t\t\t'isx\"",623],",",["T_VARIABLE","$document",627],",",["T_VARIABLE","$links",627],")",";",["T_WHITESPACE","\n\n\n\t\t",627],["T_COMMENT","\/\/ catenate the non-empty matches from the conditional subpattern\n",630],["T_WHITESPACE","\n\t\t",631],["T_WHILE","while",632],"(",["T_LIST","list",632],"(",["T_VARIABLE","$key",632],",",["T_VARIABLE","$val",632],")",["T_WHITESPACE"," ",632],"=",["T_WHITESPACE"," ",632],["T_STRING","each",632],"(",["T_VARIABLE","$links",632],"[",["T_LNUMBER","2",632],"]",")",")",["T_WHITESPACE","\n\t\t",632],"{",["T_WHITESPACE","\n\t\t\t",633],["T_IF","if",634],"(","!",["T_EMPTY","empty",634],"(",["T_VARIABLE","$val",634],")",")",["T_WHITESPACE","\n\t\t\t\t",634],["T_VARIABLE","$match",635],"[","]",["T_WHITESPACE"," ",635],"=",["T_WHITESPACE"," ",635],["T_VARIABLE","$val",635],";",["T_WHITESPACE","\n\t\t",635],"}",["T_WHITESPACE","\n\n\t\t",636],["T_WHILE","while",638],"(",["T_LIST","list",638],"(",["T_VARIABLE","$key",638],",",["T_VARIABLE","$val",638],")",["T_WHITESPACE"," ",638],"=",["T_WHITESPACE"," ",638],["T_STRING","each",638],"(",["T_VARIABLE","$links",638],"[",["T_LNUMBER","3",638],"]",")",")",["T_WHITESPACE","\n\t\t",638],"{",["T_WHITESPACE","\n\t\t\t",639],["T_IF","if",640],"(","!",["T_EMPTY","empty",640],"(",["T_VARIABLE","$val",640],")",")",["T_WHITESPACE","\n\t\t\t\t",640],["T_VARIABLE","$match",641],"[","]",["T_WHITESPACE"," ",641],"=",["T_WHITESPACE"," ",641],["T_VARIABLE","$val",641],";",["T_WHITESPACE","\n\t\t",641],"}",["T_WHITESPACE","\n\n\t\t",642],["T_COMMENT","\/\/ return the links\n",644],["T_WHITESPACE","\t\t",645],["T_RETURN","return",645],["T_WHITESPACE"," ",645],["T_VARIABLE","$match",645],";",["T_WHITESPACE","\n\t",645],"}",["T_WHITESPACE","\n\n",646],["T_COMMENT","\/*======================================================================*\\\n\tFunction:\t_stripform\n\tPurpose:\tstrip the form elements from an html document\n\tInput:\t\t$document\tdocument to strip.\n\tOutput:\t\t$match\t\tan array of the links\n\\*======================================================================*\/",648],["T_WHITESPACE","\n\n\t",653],["T_FUNCTION","function",655],["T_WHITESPACE"," ",655],["T_STRING","_stripform",655],"(",["T_VARIABLE","$document",655],")",["T_WHITESPACE","\n\t",655],"{",["T_WHITESPACE","\n\t\t",656],["T_STRING","preg_match_all",657],"(",["T_CONSTANT_ENCAPSED_STRING","\"'<\\\/?(FORM|INPUT|SELECT|TEXTAREA|(OPTION))[^<>]*>(?(2)(.*(?=<\\\/?(option|select)[^<>]*>[\\r\\n]*)|(?=[\\r\\n]*))|(?=[\\r\\n]*))'Usi\"",657],",",["T_VARIABLE","$document",657],",",["T_VARIABLE","$elements",657],")",";",["T_WHITESPACE","\n\n\t\t",657],["T_COMMENT","\/\/ catenate the matches\n",659],["T_WHITESPACE","\t\t",660],["T_VARIABLE","$match",660],["T_WHITESPACE"," ",660],"=",["T_WHITESPACE"," ",660],["T_STRING","implode",660],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",660],",",["T_VARIABLE","$elements",660],"[",["T_LNUMBER","0",660],"]",")",";",["T_WHITESPACE","\n\n\t\t",660],["T_COMMENT","\/\/ return the links\n",662],["T_WHITESPACE","\t\t",663],["T_RETURN","return",663],["T_WHITESPACE"," ",663],["T_VARIABLE","$match",663],";",["T_WHITESPACE","\n\t",663],"}",["T_WHITESPACE","\n\n\n\n",664],["T_COMMENT","\/*======================================================================*\\\n\tFunction:\t_striptext\n\tPurpose:\tstrip the text from an html document\n\tInput:\t\t$document\tdocument to strip.\n\tOutput:\t\t$text\t\tthe resulting text\n\\*======================================================================*\/",668],["T_WHITESPACE","\n\n\t",673],["T_FUNCTION","function",675],["T_WHITESPACE"," ",675],["T_STRING","_striptext",675],"(",["T_VARIABLE","$document",675],")",["T_WHITESPACE","\n\t",675],"{",["T_WHITESPACE","\n\n\t\t",676],["T_COMMENT","\/\/ I didn't use preg eval (\/\/e) since that is only available in PHP 4.0.\n",678],["T_WHITESPACE","\t\t",679],["T_COMMENT","\/\/ so, list your entities one by one here. I included some of the\n",679],["T_WHITESPACE","\t\t",680],["T_COMMENT","\/\/ more common ones.\n",680],["T_WHITESPACE","\n\t\t",681],["T_VARIABLE","$search",682],["T_WHITESPACE"," ",682],"=",["T_WHITESPACE"," ",682],["T_ARRAY","array",682],"(",["T_CONSTANT_ENCAPSED_STRING","\"'<script[^>]*?>.*?<\/script>'si\"",682],",",["T_WHITESPACE","\t",682],["T_COMMENT","\/\/ strip out javascript\n",682],["T_WHITESPACE","\t\t\t\t\t\t",683],["T_CONSTANT_ENCAPSED_STRING","\"'<[\\\/\\!]*?[^<>]*?>'si\"",683],",",["T_WHITESPACE","\t\t\t",683],["T_COMMENT","\/\/ strip out html tags\n",683],["T_WHITESPACE","\t\t\t\t\t\t",684],["T_CONSTANT_ENCAPSED_STRING","\"'([\\r\\n])[\\s]+'\"",684],",",["T_WHITESPACE","\t\t\t\t\t",684],["T_COMMENT","\/\/ strip out white space\n",684],["T_WHITESPACE","\t\t\t\t\t\t",685],["T_CONSTANT_ENCAPSED_STRING","\"'&(quot|#34|#034|#x22);'i\"",685],",",["T_WHITESPACE","\t\t",685],["T_COMMENT","\/\/ replace html entities\n",685],["T_WHITESPACE","\t\t\t\t\t\t",686],["T_CONSTANT_ENCAPSED_STRING","\"'&(amp|#38|#038|#x26);'i\"",686],",",["T_WHITESPACE","\t\t\t",686],["T_COMMENT","\/\/ added hexadecimal values\n",686],["T_WHITESPACE","\t\t\t\t\t\t",687],["T_CONSTANT_ENCAPSED_STRING","\"'&(lt|#60|#060|#x3c);'i\"",687],",",["T_WHITESPACE","\n\t\t\t\t\t\t",687],["T_CONSTANT_ENCAPSED_STRING","\"'&(gt|#62|#062|#x3e);'i\"",688],",",["T_WHITESPACE","\n\t\t\t\t\t\t",688],["T_CONSTANT_ENCAPSED_STRING","\"'&(nbsp|#160|#xa0);'i\"",689],",",["T_WHITESPACE","\n\t\t\t\t\t\t",689],["T_CONSTANT_ENCAPSED_STRING","\"'&(iexcl|#161);'i\"",690],",",["T_WHITESPACE","\n\t\t\t\t\t\t",690],["T_CONSTANT_ENCAPSED_STRING","\"'&(cent|#162);'i\"",691],",",["T_WHITESPACE","\n\t\t\t\t\t\t",691],["T_CONSTANT_ENCAPSED_STRING","\"'&(pound|#163);'i\"",692],",",["T_WHITESPACE","\n\t\t\t\t\t\t",692],["T_CONSTANT_ENCAPSED_STRING","\"'&(copy|#169);'i\"",693],",",["T_WHITESPACE","\n\t\t\t\t\t\t",693],["T_CONSTANT_ENCAPSED_STRING","\"'&(reg|#174);'i\"",694],",",["T_WHITESPACE","\n\t\t\t\t\t\t",694],["T_CONSTANT_ENCAPSED_STRING","\"'&(deg|#176);'i\"",695],",",["T_WHITESPACE","\n\t\t\t\t\t\t",695],["T_CONSTANT_ENCAPSED_STRING","\"'&(#39|#039|#x27);'\"",696],",",["T_WHITESPACE","\n\t\t\t\t\t\t",696],["T_CONSTANT_ENCAPSED_STRING","\"'&(euro|#8364);'i\"",697],",",["T_WHITESPACE","\t\t\t\t",697],["T_COMMENT","\/\/ europe\n",697],["T_WHITESPACE","\t\t\t\t\t\t",698],["T_CONSTANT_ENCAPSED_STRING","\"'&a(uml|UML);'\"",698],",",["T_WHITESPACE","\t\t\t\t\t",698],["T_COMMENT","\/\/ german\n",698],["T_WHITESPACE","\t\t\t\t\t\t",699],["T_CONSTANT_ENCAPSED_STRING","\"'&o(uml|UML);'\"",699],",",["T_WHITESPACE","\n\t\t\t\t\t\t",699],["T_CONSTANT_ENCAPSED_STRING","\"'&u(uml|UML);'\"",700],",",["T_WHITESPACE","\n\t\t\t\t\t\t",700],["T_CONSTANT_ENCAPSED_STRING","\"'&A(uml|UML);'\"",701],",",["T_WHITESPACE","\n\t\t\t\t\t\t",701],["T_CONSTANT_ENCAPSED_STRING","\"'&O(uml|UML);'\"",702],",",["T_WHITESPACE","\n\t\t\t\t\t\t",702],["T_CONSTANT_ENCAPSED_STRING","\"'&U(uml|UML);'\"",703],",",["T_WHITESPACE","\n\t\t\t\t\t\t",703],["T_CONSTANT_ENCAPSED_STRING","\"'&szlig;'i\"",704],",",["T_WHITESPACE","\n\t\t\t\t\t\t",704],")",";",["T_WHITESPACE","\n\t\t",705],["T_VARIABLE","$replace",706],["T_WHITESPACE"," ",706],"=",["T_WHITESPACE"," ",706],["T_ARRAY","array",706],"(",["T_WHITESPACE","\t",706],["T_CONSTANT_ENCAPSED_STRING","\"\"",706],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",706],["T_CONSTANT_ENCAPSED_STRING","\"\"",707],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",707],["T_CONSTANT_ENCAPSED_STRING","\"\\\\1\"",708],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",708],["T_CONSTANT_ENCAPSED_STRING","\"\\\"\"",709],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",709],["T_CONSTANT_ENCAPSED_STRING","\"&\"",710],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",710],["T_CONSTANT_ENCAPSED_STRING","\"<\"",711],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",711],["T_CONSTANT_ENCAPSED_STRING","\">\"",712],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",712],["T_CONSTANT_ENCAPSED_STRING","\" \"",713],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",713],["T_STRING","chr",714],"(",["T_LNUMBER","161",714],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",714],["T_STRING","chr",715],"(",["T_LNUMBER","162",715],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",715],["T_STRING","chr",716],"(",["T_LNUMBER","163",716],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",716],["T_STRING","chr",717],"(",["T_LNUMBER","169",717],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",717],["T_STRING","chr",718],"(",["T_LNUMBER","174",718],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",718],["T_STRING","chr",719],"(",["T_LNUMBER","176",719],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",719],["T_STRING","chr",720],"(",["T_LNUMBER","39",720],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",720],["T_STRING","chr",721],"(",["T_LNUMBER","128",721],")",",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",721],["T_STRING","chr",722],"(",["T_LNUMBER","0xE4",722],")",",",["T_WHITESPACE"," ",722],["T_COMMENT","\/\/ ANSI &auml;\n",722],["T_WHITESPACE","\t\t\t\t\t\t\t",723],["T_STRING","chr",723],"(",["T_LNUMBER","0xF6",723],")",",",["T_WHITESPACE"," ",723],["T_COMMENT","\/\/ ANSI &ouml;\n",723],["T_WHITESPACE","\t\t\t\t\t\t\t",724],["T_STRING","chr",724],"(",["T_LNUMBER","0xFC",724],")",",",["T_WHITESPACE"," ",724],["T_COMMENT","\/\/ ANSI &uuml;\n",724],["T_WHITESPACE","\t\t\t\t\t\t\t",725],["T_STRING","chr",725],"(",["T_LNUMBER","0xC4",725],")",",",["T_WHITESPACE"," ",725],["T_COMMENT","\/\/ ANSI &Auml;\n",725],["T_WHITESPACE","\t\t\t\t\t\t\t",726],["T_STRING","chr",726],"(",["T_LNUMBER","0xD6",726],")",",",["T_WHITESPACE"," ",726],["T_COMMENT","\/\/ ANSI &Ouml;\n",726],["T_WHITESPACE","\t\t\t\t\t\t\t",727],["T_STRING","chr",727],"(",["T_LNUMBER","0xDC",727],")",",",["T_WHITESPACE"," ",727],["T_COMMENT","\/\/ ANSI &Uuml;\n",727],["T_WHITESPACE","\t\t\t\t\t\t\t",728],["T_STRING","chr",728],"(",["T_LNUMBER","0xDF",728],")",",",["T_WHITESPACE"," ",728],["T_COMMENT","\/\/ ANSI &szlig;\n",728],["T_WHITESPACE","\t\t\t\t\t\t",729],")",";",["T_WHITESPACE","\n\n\t\t",729],["T_VARIABLE","$text",731],["T_WHITESPACE"," ",731],"=",["T_WHITESPACE"," ",731],["T_STRING","preg_replace",731],"(",["T_VARIABLE","$search",731],",",["T_VARIABLE","$replace",731],",",["T_VARIABLE","$document",731],")",";",["T_WHITESPACE","\n\n\t\t",731],["T_RETURN","return",733],["T_WHITESPACE"," ",733],["T_VARIABLE","$text",733],";",["T_WHITESPACE","\n\t",733],"}",["T_WHITESPACE","\n\n",734],["T_COMMENT","\/*======================================================================*\\\n\tFunction:\t_expandlinks\n\tPurpose:\texpand each link into a fully qualified URL\n\tInput:\t\t$links\t\t\tthe links to qualify\n\t\t\t\t$URI\t\t\tthe full URI to get the base from\n\tOutput:\t\t$expandedLinks\tthe expanded links\n\\*======================================================================*\/",736],["T_WHITESPACE","\n\n\t",742],["T_FUNCTION","function",744],["T_WHITESPACE"," ",744],["T_STRING","_expandlinks",744],"(",["T_VARIABLE","$links",744],",",["T_VARIABLE","$URI",744],")",["T_WHITESPACE","\n\t",744],"{",["T_WHITESPACE","\n\n\t\t",745],["T_STRING","preg_match",747],"(",["T_CONSTANT_ENCAPSED_STRING","\"\/^[^\\?]+\/\"",747],",",["T_VARIABLE","$URI",747],",",["T_VARIABLE","$match",747],")",";",["T_WHITESPACE","\n\n\t\t",747],["T_VARIABLE","$match",749],["T_WHITESPACE"," ",749],"=",["T_WHITESPACE"," ",749],["T_STRING","preg_replace",749],"(",["T_CONSTANT_ENCAPSED_STRING","\"|\/[^\\\/\\.]+\\.[^\\\/\\.]+$|\"",749],",",["T_CONSTANT_ENCAPSED_STRING","\"\"",749],",",["T_VARIABLE","$match",749],"[",["T_LNUMBER","0",749],"]",")",";",["T_WHITESPACE","\n\t\t",749],["T_VARIABLE","$match",750],["T_WHITESPACE"," ",750],"=",["T_WHITESPACE"," ",750],["T_STRING","preg_replace",750],"(",["T_CONSTANT_ENCAPSED_STRING","\"|\/$|\"",750],",",["T_CONSTANT_ENCAPSED_STRING","\"\"",750],",",["T_VARIABLE","$match",750],")",";",["T_WHITESPACE","\n\t\t",750],["T_VARIABLE","$match_part",751],["T_WHITESPACE"," ",751],"=",["T_WHITESPACE"," ",751],["T_STRING","parse_url",751],"(",["T_VARIABLE","$match",751],")",";",["T_WHITESPACE","\n\t\t",751],["T_VARIABLE","$match_root",752],["T_WHITESPACE"," ",752],"=",["T_WHITESPACE","\n\t\t",752],["T_VARIABLE","$match_part",753],"[",["T_CONSTANT_ENCAPSED_STRING","\"scheme\"",753],"]",".",["T_CONSTANT_ENCAPSED_STRING","\":\/\/\"",753],".",["T_VARIABLE","$match_part",753],"[",["T_CONSTANT_ENCAPSED_STRING","\"host\"",753],"]",";",["T_WHITESPACE","\n\n\t\t",753],["T_VARIABLE","$search",755],["T_WHITESPACE"," ",755],"=",["T_WHITESPACE"," ",755],["T_ARRAY","array",755],"(",["T_WHITESPACE"," \t",755],["T_CONSTANT_ENCAPSED_STRING","\"|^http:\/\/\"",755],".",["T_STRING","preg_quote",755],"(",["T_VARIABLE","$this",755],["T_OBJECT_OPERATOR","->",755],["T_STRING","host",755],")",".",["T_CONSTANT_ENCAPSED_STRING","\"|i\"",755],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",755],["T_CONSTANT_ENCAPSED_STRING","\"|^(\\\/)|i\"",756],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",756],["T_CONSTANT_ENCAPSED_STRING","\"|^(?!http:\/\/)(?!mailto:)|i\"",757],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",757],["T_CONSTANT_ENCAPSED_STRING","\"|\/\\.\/|\"",758],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",758],["T_CONSTANT_ENCAPSED_STRING","\"|\/[^\\\/]+\/\\.\\.\/|\"",759],["T_WHITESPACE","\n\t\t\t\t\t\t",759],")",";",["T_WHITESPACE","\n\n\t\t",760],["T_VARIABLE","$replace",762],["T_WHITESPACE"," ",762],"=",["T_WHITESPACE"," ",762],["T_ARRAY","array",762],"(",["T_WHITESPACE","\t",762],["T_CONSTANT_ENCAPSED_STRING","\"\"",762],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",762],["T_VARIABLE","$match_root",763],".",["T_CONSTANT_ENCAPSED_STRING","\"\/\"",763],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",763],["T_VARIABLE","$match",764],".",["T_CONSTANT_ENCAPSED_STRING","\"\/\"",764],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",764],["T_CONSTANT_ENCAPSED_STRING","\"\/\"",765],",",["T_WHITESPACE","\n\t\t\t\t\t\t\t",765],["T_CONSTANT_ENCAPSED_STRING","\"\/\"",766],["T_WHITESPACE","\n\t\t\t\t\t\t",766],")",";",["T_WHITESPACE","\n\n\t\t",767],["T_VARIABLE","$expandedLinks",769],["T_WHITESPACE"," ",769],"=",["T_WHITESPACE"," ",769],["T_STRING","preg_replace",769],"(",["T_VARIABLE","$search",769],",",["T_VARIABLE","$replace",769],",",["T_VARIABLE","$links",769],")",";",["T_WHITESPACE","\n\n\t\t",769],["T_RETURN","return",771],["T_WHITESPACE"," ",771],["T_VARIABLE","$expandedLinks",771],";",["T_WHITESPACE","\n\t",771],"}",["T_WHITESPACE","\n\n",772],["T_COMMENT","\/*======================================================================*\\\n\tFunction:\t_httprequest\n\tPurpose:\tgo get the http data from the server\n\tInput:\t\t$url\t\tthe url to fetch\n\t\t\t\t$fp\t\t\tthe current open file pointer\n\t\t\t\t$URI\t\tthe full URI\n\t\t\t\t$body\t\tbody contents to send if any (POST)\n\tOutput:\n\\*======================================================================*\/",774],["T_WHITESPACE","\n\n\t",782],["T_FUNCTION","function",784],["T_WHITESPACE"," ",784],["T_STRING","_httprequest",784],"(",["T_VARIABLE","$url",784],",",["T_VARIABLE","$fp",784],",",["T_VARIABLE","$URI",784],",",["T_VARIABLE","$http_method",784],",",["T_VARIABLE","$content_type",784],"=",["T_CONSTANT_ENCAPSED_STRING","\"\"",784],",",["T_VARIABLE","$body",784],"=",["T_CONSTANT_ENCAPSED_STRING","\"\"",784],")",["T_WHITESPACE","\n\t",784],"{",["T_WHITESPACE","\n\t\t",785],["T_VARIABLE","$cookie_headers",786],["T_WHITESPACE"," ",786],"=",["T_WHITESPACE"," ",786],["T_CONSTANT_ENCAPSED_STRING","''",786],";",["T_WHITESPACE","\n\t\t",786],["T_IF","if",787],"(",["T_VARIABLE","$this",787],["T_OBJECT_OPERATOR","->",787],["T_STRING","passcookies",787],["T_WHITESPACE"," ",787],["T_BOOLEAN_AND","&&",787],["T_WHITESPACE"," ",787],["T_VARIABLE","$this",787],["T_OBJECT_OPERATOR","->",787],["T_STRING","_redirectaddr",787],")",["T_WHITESPACE","\n\t\t\t",787],["T_VARIABLE","$this",788],["T_OBJECT_OPERATOR","->",788],["T_STRING","setcookies",788],"(",")",";",["T_WHITESPACE","\n\n\t\t",788],["T_VARIABLE","$URI_PARTS",790],["T_WHITESPACE"," ",790],"=",["T_WHITESPACE"," ",790],["T_STRING","parse_url",790],"(",["T_VARIABLE","$URI",790],")",";",["T_WHITESPACE","\n\t\t",790],["T_IF","if",791],"(",["T_EMPTY","empty",791],"(",["T_VARIABLE","$url",791],")",")",["T_WHITESPACE","\n\t\t\t",791],["T_VARIABLE","$url",792],["T_WHITESPACE"," ",792],"=",["T_WHITESPACE"," ",792],["T_CONSTANT_ENCAPSED_STRING","\"\/\"",792],";",["T_WHITESPACE","\n\t\t",792],["T_VARIABLE","$headers",793],["T_WHITESPACE"," ",793],"=",["T_WHITESPACE"," ",793],["T_VARIABLE","$http_method",793],".",["T_CONSTANT_ENCAPSED_STRING","\" \"",793],".",["T_VARIABLE","$url",793],".",["T_CONSTANT_ENCAPSED_STRING","\" \"",793],".",["T_VARIABLE","$this",793],["T_OBJECT_OPERATOR","->",793],["T_STRING","_httpversion",793],".",["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",793],";",["T_WHITESPACE","\n\t\t",793],["T_IF","if",794],"(","!",["T_EMPTY","empty",794],"(",["T_VARIABLE","$this",794],["T_OBJECT_OPERATOR","->",794],["T_STRING","agent",794],")",")",["T_WHITESPACE","\n\t\t\t",794],["T_VARIABLE","$headers",795],["T_WHITESPACE"," ",795],["T_CONCAT_EQUAL",".=",795],["T_WHITESPACE"," ",795],["T_CONSTANT_ENCAPSED_STRING","\"User-Agent: \"",795],".",["T_VARIABLE","$this",795],["T_OBJECT_OPERATOR","->",795],["T_STRING","agent",795],".",["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",795],";",["T_WHITESPACE","\n\t\t",795],["T_IF","if",796],"(","!",["T_EMPTY","empty",796],"(",["T_VARIABLE","$this",796],["T_OBJECT_OPERATOR","->",796],["T_STRING","host",796],")",["T_WHITESPACE"," ",796],["T_BOOLEAN_AND","&&",796],["T_WHITESPACE"," ",796],"!",["T_ISSET","isset",796],"(",["T_VARIABLE","$this",796],["T_OBJECT_OPERATOR","->",796],["T_STRING","rawheaders",796],"[",["T_CONSTANT_ENCAPSED_STRING","'Host'",796],"]",")",")",["T_WHITESPACE"," ",796],"{",["T_WHITESPACE","\n\t\t\t",796],["T_VARIABLE","$headers",797],["T_WHITESPACE"," ",797],["T_CONCAT_EQUAL",".=",797],["T_WHITESPACE"," ",797],["T_CONSTANT_ENCAPSED_STRING","\"Host: \"",797],".",["T_VARIABLE","$this",797],["T_OBJECT_OPERATOR","->",797],["T_STRING","host",797],";",["T_WHITESPACE","\n\t\t\t",797],["T_IF","if",798],"(","!",["T_EMPTY","empty",798],"(",["T_VARIABLE","$this",798],["T_OBJECT_OPERATOR","->",798],["T_STRING","port",798],")",["T_WHITESPACE"," ",798],["T_BOOLEAN_AND","&&",798],["T_WHITESPACE"," ",798],["T_VARIABLE","$this",798],["T_OBJECT_OPERATOR","->",798],["T_STRING","port",798],["T_WHITESPACE"," ",798],["T_IS_NOT_EQUAL","!=",798],["T_WHITESPACE"," ",798],["T_LNUMBER","80",798],")",["T_WHITESPACE","\n\t\t\t\t",798],["T_VARIABLE","$headers",799],["T_WHITESPACE"," ",799],["T_CONCAT_EQUAL",".=",799],["T_WHITESPACE"," ",799],["T_CONSTANT_ENCAPSED_STRING","\":\"",799],".",["T_VARIABLE","$this",799],["T_OBJECT_OPERATOR","->",799],["T_STRING","port",799],";",["T_WHITESPACE","\n\t\t\t",799],["T_VARIABLE","$headers",800],["T_WHITESPACE"," ",800],["T_CONCAT_EQUAL",".=",800],["T_WHITESPACE"," ",800],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",800],";",["T_WHITESPACE","\n\t\t",800],"}",["T_WHITESPACE","\n\t\t",801],["T_IF","if",802],"(","!",["T_EMPTY","empty",802],"(",["T_VARIABLE","$this",802],["T_OBJECT_OPERATOR","->",802],["T_STRING","accept",802],")",")",["T_WHITESPACE","\n\t\t\t",802],["T_VARIABLE","$headers",803],["T_WHITESPACE"," ",803],["T_CONCAT_EQUAL",".=",803],["T_WHITESPACE"," ",803],["T_CONSTANT_ENCAPSED_STRING","\"Accept: \"",803],".",["T_VARIABLE","$this",803],["T_OBJECT_OPERATOR","->",803],["T_STRING","accept",803],".",["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",803],";",["T_WHITESPACE","\n\t\t",803],["T_IF","if",804],"(","!",["T_EMPTY","empty",804],"(",["T_VARIABLE","$this",804],["T_OBJECT_OPERATOR","->",804],["T_STRING","referer",804],")",")",["T_WHITESPACE","\n\t\t\t",804],["T_VARIABLE","$headers",805],["T_WHITESPACE"," ",805],["T_CONCAT_EQUAL",".=",805],["T_WHITESPACE"," ",805],["T_CONSTANT_ENCAPSED_STRING","\"Referer: \"",805],".",["T_VARIABLE","$this",805],["T_OBJECT_OPERATOR","->",805],["T_STRING","referer",805],".",["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",805],";",["T_WHITESPACE","\n\t\t",805],["T_IF","if",806],"(","!",["T_EMPTY","empty",806],"(",["T_VARIABLE","$this",806],["T_OBJECT_OPERATOR","->",806],["T_STRING","cookies",806],")",")",["T_WHITESPACE","\n\t\t",806],"{",["T_WHITESPACE","\n\t\t\t",807],["T_IF","if",808],"(","!",["T_STRING","is_array",808],"(",["T_VARIABLE","$this",808],["T_OBJECT_OPERATOR","->",808],["T_STRING","cookies",808],")",")",["T_WHITESPACE","\n\t\t\t\t",808],["T_VARIABLE","$this",809],["T_OBJECT_OPERATOR","->",809],["T_STRING","cookies",809],["T_WHITESPACE"," ",809],"=",["T_WHITESPACE"," ",809],["T_ARRAY_CAST","(array)",809],["T_VARIABLE","$this",809],["T_OBJECT_OPERATOR","->",809],["T_STRING","cookies",809],";",["T_WHITESPACE","\n\n\t\t\t",809],["T_STRING","reset",811],"(",["T_VARIABLE","$this",811],["T_OBJECT_OPERATOR","->",811],["T_STRING","cookies",811],")",";",["T_WHITESPACE","\n\t\t\t",811],["T_IF","if",812],["T_WHITESPACE"," ",812],"(",["T_WHITESPACE"," ",812],["T_STRING","count",812],"(",["T_VARIABLE","$this",812],["T_OBJECT_OPERATOR","->",812],["T_STRING","cookies",812],")",["T_WHITESPACE"," ",812],">",["T_WHITESPACE"," ",812],["T_LNUMBER","0",812],["T_WHITESPACE"," ",812],")",["T_WHITESPACE"," ",812],"{",["T_WHITESPACE","\n\t\t\t\t",812],["T_VARIABLE","$cookie_headers",813],["T_WHITESPACE"," ",813],["T_CONCAT_EQUAL",".=",813],["T_WHITESPACE"," ",813],["T_CONSTANT_ENCAPSED_STRING","'Cookie: '",813],";",["T_WHITESPACE","\n\t\t\t\t",813],["T_FOREACH","foreach",814],["T_WHITESPACE"," ",814],"(",["T_WHITESPACE"," ",814],["T_VARIABLE","$this",814],["T_OBJECT_OPERATOR","->",814],["T_STRING","cookies",814],["T_WHITESPACE"," ",814],["T_AS","as",814],["T_WHITESPACE"," ",814],["T_VARIABLE","$cookieKey",814],["T_WHITESPACE"," ",814],["T_DOUBLE_ARROW","=>",814],["T_WHITESPACE"," ",814],["T_VARIABLE","$cookieVal",814],["T_WHITESPACE"," ",814],")",["T_WHITESPACE"," ",814],"{",["T_WHITESPACE","\n\t\t\t\t",814],["T_VARIABLE","$cookie_headers",815],["T_WHITESPACE"," ",815],["T_CONCAT_EQUAL",".=",815],["T_WHITESPACE"," ",815],["T_VARIABLE","$cookieKey",815],".",["T_CONSTANT_ENCAPSED_STRING","\"=\"",815],".",["T_STRING","urlencode",815],"(",["T_VARIABLE","$cookieVal",815],")",".",["T_CONSTANT_ENCAPSED_STRING","\"; \"",815],";",["T_WHITESPACE","\n\t\t\t\t",815],"}",["T_WHITESPACE","\n\t\t\t\t",816],["T_VARIABLE","$headers",817],["T_WHITESPACE"," ",817],["T_CONCAT_EQUAL",".=",817],["T_WHITESPACE"," ",817],["T_STRING","substr",817],"(",["T_VARIABLE","$cookie_headers",817],",",["T_LNUMBER","0",817],",","-",["T_LNUMBER","2",817],")",["T_WHITESPACE"," ",817],".",["T_WHITESPACE"," ",817],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",817],";",["T_WHITESPACE","\n\t\t\t",817],"}",["T_WHITESPACE","\n\t\t",818],"}",["T_WHITESPACE","\n\t\t",819],["T_IF","if",820],"(","!",["T_EMPTY","empty",820],"(",["T_VARIABLE","$this",820],["T_OBJECT_OPERATOR","->",820],["T_STRING","rawheaders",820],")",")",["T_WHITESPACE","\n\t\t",820],"{",["T_WHITESPACE","\n\t\t\t",821],["T_IF","if",822],"(","!",["T_STRING","is_array",822],"(",["T_VARIABLE","$this",822],["T_OBJECT_OPERATOR","->",822],["T_STRING","rawheaders",822],")",")",["T_WHITESPACE","\n\t\t\t\t",822],["T_VARIABLE","$this",823],["T_OBJECT_OPERATOR","->",823],["T_STRING","rawheaders",823],["T_WHITESPACE"," ",823],"=",["T_WHITESPACE"," ",823],["T_ARRAY_CAST","(array)",823],["T_VARIABLE","$this",823],["T_OBJECT_OPERATOR","->",823],["T_STRING","rawheaders",823],";",["T_WHITESPACE","\n\t\t\t",823],["T_WHILE","while",824],"(",["T_LIST","list",824],"(",["T_VARIABLE","$headerKey",824],",",["T_VARIABLE","$headerVal",824],")",["T_WHITESPACE"," ",824],"=",["T_WHITESPACE"," ",824],["T_STRING","each",824],"(",["T_VARIABLE","$this",824],["T_OBJECT_OPERATOR","->",824],["T_STRING","rawheaders",824],")",")",["T_WHITESPACE","\n\t\t\t\t",824],["T_VARIABLE","$headers",825],["T_WHITESPACE"," ",825],["T_CONCAT_EQUAL",".=",825],["T_WHITESPACE"," ",825],["T_VARIABLE","$headerKey",825],".",["T_CONSTANT_ENCAPSED_STRING","\": \"",825],".",["T_VARIABLE","$headerVal",825],".",["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",825],";",["T_WHITESPACE","\n\t\t",825],"}",["T_WHITESPACE","\n\t\t",826],["T_IF","if",827],"(","!",["T_EMPTY","empty",827],"(",["T_VARIABLE","$content_type",827],")",")",["T_WHITESPACE"," ",827],"{",["T_WHITESPACE","\n\t\t\t",827],["T_VARIABLE","$headers",828],["T_WHITESPACE"," ",828],["T_CONCAT_EQUAL",".=",828],["T_WHITESPACE"," ",828],"\"",["T_ENCAPSED_AND_WHITESPACE","Content-type: ",828],["T_VARIABLE","$content_type",828],"\"",";",["T_WHITESPACE","\n\t\t\t",828],["T_IF","if",829],["T_WHITESPACE"," ",829],"(",["T_VARIABLE","$content_type",829],["T_WHITESPACE"," ",829],["T_IS_EQUAL","==",829],["T_WHITESPACE"," ",829],["T_CONSTANT_ENCAPSED_STRING","\"multipart\/form-data\"",829],")",["T_WHITESPACE","\n\t\t\t\t",829],["T_VARIABLE","$headers",830],["T_WHITESPACE"," ",830],["T_CONCAT_EQUAL",".=",830],["T_WHITESPACE"," ",830],["T_CONSTANT_ENCAPSED_STRING","\"; boundary=\"",830],".",["T_VARIABLE","$this",830],["T_OBJECT_OPERATOR","->",830],["T_STRING","_mime_boundary",830],";",["T_WHITESPACE","\n\t\t\t",830],["T_VARIABLE","$headers",831],["T_WHITESPACE"," ",831],["T_CONCAT_EQUAL",".=",831],["T_WHITESPACE"," ",831],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",831],";",["T_WHITESPACE","\n\t\t",831],"}",["T_WHITESPACE","\n\t\t",832],["T_IF","if",833],"(","!",["T_EMPTY","empty",833],"(",["T_VARIABLE","$body",833],")",")",["T_WHITESPACE","\n\t\t\t",833],["T_VARIABLE","$headers",834],["T_WHITESPACE"," ",834],["T_CONCAT_EQUAL",".=",834],["T_WHITESPACE"," ",834],["T_CONSTANT_ENCAPSED_STRING","\"Content-length: \"",834],".",["T_STRING","strlen",834],"(",["T_VARIABLE","$body",834],")",".",["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",834],";",["T_WHITESPACE","\n\t\t",834],["T_IF","if",835],"(","!",["T_EMPTY","empty",835],"(",["T_VARIABLE","$this",835],["T_OBJECT_OPERATOR","->",835],["T_STRING","user",835],")",["T_WHITESPACE"," ",835],["T_BOOLEAN_OR","||",835],["T_WHITESPACE"," ",835],"!",["T_EMPTY","empty",835],"(",["T_VARIABLE","$this",835],["T_OBJECT_OPERATOR","->",835],["T_STRING","pass",835],")",")",["T_WHITESPACE","\n\t\t\t",835],["T_VARIABLE","$headers",836],["T_WHITESPACE"," ",836],["T_CONCAT_EQUAL",".=",836],["T_WHITESPACE"," ",836],["T_CONSTANT_ENCAPSED_STRING","\"Authorization: Basic \"",836],".",["T_STRING","base64_encode",836],"(",["T_VARIABLE","$this",836],["T_OBJECT_OPERATOR","->",836],["T_STRING","user",836],".",["T_CONSTANT_ENCAPSED_STRING","\":\"",836],".",["T_VARIABLE","$this",836],["T_OBJECT_OPERATOR","->",836],["T_STRING","pass",836],")",".",["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",836],";",["T_WHITESPACE","\n\n\t\t",836],["T_COMMENT","\/\/add proxy auth headers\n",838],["T_WHITESPACE","\t\t",839],["T_IF","if",839],"(","!",["T_EMPTY","empty",839],"(",["T_VARIABLE","$this",839],["T_OBJECT_OPERATOR","->",839],["T_STRING","proxy_user",839],")",")",["T_WHITESPACE","\n\t\t\t",839],["T_VARIABLE","$headers",840],["T_WHITESPACE"," ",840],["T_CONCAT_EQUAL",".=",840],["T_WHITESPACE"," ",840],["T_CONSTANT_ENCAPSED_STRING","'Proxy-Authorization: '",840],["T_WHITESPACE"," ",840],".",["T_WHITESPACE"," ",840],["T_CONSTANT_ENCAPSED_STRING","'Basic '",840],["T_WHITESPACE"," ",840],".",["T_WHITESPACE"," ",840],["T_STRING","base64_encode",840],"(",["T_VARIABLE","$this",840],["T_OBJECT_OPERATOR","->",840],["T_STRING","proxy_user",840],["T_WHITESPACE"," ",840],".",["T_WHITESPACE"," ",840],["T_CONSTANT_ENCAPSED_STRING","':'",840],["T_WHITESPACE"," ",840],".",["T_WHITESPACE"," ",840],["T_VARIABLE","$this",840],["T_OBJECT_OPERATOR","->",840],["T_STRING","proxy_pass",840],")",".",["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",840],";",["T_WHITESPACE","\n\n\n\t\t",840],["T_VARIABLE","$headers",843],["T_WHITESPACE"," ",843],["T_CONCAT_EQUAL",".=",843],["T_WHITESPACE"," ",843],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",843],";",["T_WHITESPACE","\n\n\t\t",843],["T_COMMENT","\/\/ set the read timeout if needed\n",845],["T_WHITESPACE","\t\t",846],["T_IF","if",846],["T_WHITESPACE"," ",846],"(",["T_VARIABLE","$this",846],["T_OBJECT_OPERATOR","->",846],["T_STRING","read_timeout",846],["T_WHITESPACE"," ",846],">",["T_WHITESPACE"," ",846],["T_LNUMBER","0",846],")",["T_WHITESPACE","\n\t\t\t",846],["T_STRING","socket_set_timeout",847],"(",["T_VARIABLE","$fp",847],",",["T_WHITESPACE"," ",847],["T_VARIABLE","$this",847],["T_OBJECT_OPERATOR","->",847],["T_STRING","read_timeout",847],")",";",["T_WHITESPACE","\n\t\t",847],["T_VARIABLE","$this",848],["T_OBJECT_OPERATOR","->",848],["T_STRING","timed_out",848],["T_WHITESPACE"," ",848],"=",["T_WHITESPACE"," ",848],["T_STRING","false",848],";",["T_WHITESPACE","\n\n\t\t",848],["T_STRING","fwrite",850],"(",["T_VARIABLE","$fp",850],",",["T_VARIABLE","$headers",850],".",["T_VARIABLE","$body",850],",",["T_STRING","strlen",850],"(",["T_VARIABLE","$headers",850],".",["T_VARIABLE","$body",850],")",")",";",["T_WHITESPACE","\n\n\t\t",850],["T_VARIABLE","$this",852],["T_OBJECT_OPERATOR","->",852],["T_STRING","_redirectaddr",852],["T_WHITESPACE"," ",852],"=",["T_WHITESPACE"," ",852],["T_STRING","false",852],";",["T_WHITESPACE","\n\t\t",852],["T_UNSET","unset",853],"(",["T_VARIABLE","$this",853],["T_OBJECT_OPERATOR","->",853],["T_STRING","headers",853],")",";",["T_WHITESPACE","\n\n\t\t",853],["T_WHILE","while",855],"(",["T_VARIABLE","$currentHeader",855],["T_WHITESPACE"," ",855],"=",["T_WHITESPACE"," ",855],["T_STRING","fgets",855],"(",["T_VARIABLE","$fp",855],",",["T_VARIABLE","$this",855],["T_OBJECT_OPERATOR","->",855],["T_STRING","_maxlinelen",855],")",")",["T_WHITESPACE","\n\t\t",855],"{",["T_WHITESPACE","\n\t\t\t",856],["T_IF","if",857],["T_WHITESPACE"," ",857],"(",["T_VARIABLE","$this",857],["T_OBJECT_OPERATOR","->",857],["T_STRING","read_timeout",857],["T_WHITESPACE"," ",857],">",["T_WHITESPACE"," ",857],["T_LNUMBER","0",857],["T_WHITESPACE"," ",857],["T_BOOLEAN_AND","&&",857],["T_WHITESPACE"," ",857],["T_VARIABLE","$this",857],["T_OBJECT_OPERATOR","->",857],["T_STRING","_check_timeout",857],"(",["T_VARIABLE","$fp",857],")",")",["T_WHITESPACE","\n\t\t\t",857],"{",["T_WHITESPACE","\n\t\t\t\t",858],["T_VARIABLE","$this",859],["T_OBJECT_OPERATOR","->",859],["T_STRING","status",859],"=","-",["T_LNUMBER","100",859],";",["T_WHITESPACE","\n\t\t\t\t",859],["T_RETURN","return",860],["T_WHITESPACE"," ",860],["T_STRING","false",860],";",["T_WHITESPACE","\n\t\t\t",860],"}",["T_WHITESPACE","\n\n\t\t\t",861],["T_IF","if",863],"(",["T_VARIABLE","$currentHeader",863],["T_WHITESPACE"," ",863],["T_IS_EQUAL","==",863],["T_WHITESPACE"," ",863],["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",863],")",["T_WHITESPACE","\n\t\t\t\t",863],["T_BREAK","break",864],";",["T_WHITESPACE","\n\n\t\t\t",864],["T_COMMENT","\/\/ if a header begins with Location: or URI:, set the redirect\n",866],["T_WHITESPACE","\t\t\t",867],["T_IF","if",867],"(",["T_STRING","preg_match",867],"(",["T_CONSTANT_ENCAPSED_STRING","\"\/^(Location:|URI:)\/i\"",867],",",["T_VARIABLE","$currentHeader",867],")",")",["T_WHITESPACE","\n\t\t\t",867],"{",["T_WHITESPACE","\n\t\t\t\t",868],["T_COMMENT","\/\/ get URL portion of the redirect\n",869],["T_WHITESPACE","\t\t\t\t",870],["T_STRING","preg_match",870],"(",["T_CONSTANT_ENCAPSED_STRING","\"\/^(Location:|URI:)[ ]+(.*)\/i\"",870],",",["T_STRING","chop",870],"(",["T_VARIABLE","$currentHeader",870],")",",",["T_VARIABLE","$matches",870],")",";",["T_WHITESPACE","\n\t\t\t\t",870],["T_COMMENT","\/\/ look for :\/\/ in the Location header to see if hostname is included\n",871],["T_WHITESPACE","\t\t\t\t",872],["T_IF","if",872],"(","!",["T_STRING","preg_match",872],"(",["T_CONSTANT_ENCAPSED_STRING","\"|\\:\\\/\\\/|\"",872],",",["T_VARIABLE","$matches",872],"[",["T_LNUMBER","2",872],"]",")",")",["T_WHITESPACE","\n\t\t\t\t",872],"{",["T_WHITESPACE","\n\t\t\t\t\t",873],["T_COMMENT","\/\/ no host in the path, so prepend\n",874],["T_WHITESPACE","\t\t\t\t\t",875],["T_VARIABLE","$this",875],["T_OBJECT_OPERATOR","->",875],["T_STRING","_redirectaddr",875],["T_WHITESPACE"," ",875],"=",["T_WHITESPACE"," ",875],["T_VARIABLE","$URI_PARTS",875],"[",["T_CONSTANT_ENCAPSED_STRING","\"scheme\"",875],"]",".",["T_CONSTANT_ENCAPSED_STRING","\":\/\/\"",875],".",["T_VARIABLE","$this",875],["T_OBJECT_OPERATOR","->",875],["T_STRING","host",875],".",["T_CONSTANT_ENCAPSED_STRING","\":\"",875],".",["T_VARIABLE","$this",875],["T_OBJECT_OPERATOR","->",875],["T_STRING","port",875],";",["T_WHITESPACE","\n\t\t\t\t\t",875],["T_COMMENT","\/\/ eliminate double slash\n",876],["T_WHITESPACE","\t\t\t\t\t",877],["T_IF","if",877],"(","!",["T_STRING","preg_match",877],"(",["T_CONSTANT_ENCAPSED_STRING","\"|^\/|\"",877],",",["T_VARIABLE","$matches",877],"[",["T_LNUMBER","2",877],"]",")",")",["T_WHITESPACE","\n\t\t\t\t\t\t\t",877],["T_VARIABLE","$this",878],["T_OBJECT_OPERATOR","->",878],["T_STRING","_redirectaddr",878],["T_WHITESPACE"," ",878],["T_CONCAT_EQUAL",".=",878],["T_WHITESPACE"," ",878],["T_CONSTANT_ENCAPSED_STRING","\"\/\"",878],".",["T_VARIABLE","$matches",878],"[",["T_LNUMBER","2",878],"]",";",["T_WHITESPACE","\n\t\t\t\t\t",878],["T_ELSE","else",879],["T_WHITESPACE","\n\t\t\t\t\t\t\t",879],["T_VARIABLE","$this",880],["T_OBJECT_OPERATOR","->",880],["T_STRING","_redirectaddr",880],["T_WHITESPACE"," ",880],["T_CONCAT_EQUAL",".=",880],["T_WHITESPACE"," ",880],["T_VARIABLE","$matches",880],"[",["T_LNUMBER","2",880],"]",";",["T_WHITESPACE","\n\t\t\t\t",880],"}",["T_WHITESPACE","\n\t\t\t\t",881],["T_ELSE","else",882],["T_WHITESPACE","\n\t\t\t\t\t",882],["T_VARIABLE","$this",883],["T_OBJECT_OPERATOR","->",883],["T_STRING","_redirectaddr",883],["T_WHITESPACE"," ",883],"=",["T_WHITESPACE"," ",883],["T_VARIABLE","$matches",883],"[",["T_LNUMBER","2",883],"]",";",["T_WHITESPACE","\n\t\t\t",883],"}",["T_WHITESPACE","\n\n\t\t\t",884],["T_IF","if",886],"(",["T_STRING","preg_match",886],"(",["T_CONSTANT_ENCAPSED_STRING","\"|^HTTP\/|\"",886],",",["T_VARIABLE","$currentHeader",886],")",")",["T_WHITESPACE","\n\t\t\t",886],"{",["T_WHITESPACE","\n                ",887],["T_IF","if",888],"(",["T_STRING","preg_match",888],"(",["T_CONSTANT_ENCAPSED_STRING","\"|^HTTP\/[^\\s]*\\s(.*?)\\s|\"",888],",",["T_VARIABLE","$currentHeader",888],",",["T_WHITESPACE"," ",888],["T_VARIABLE","$status",888],")",")",["T_WHITESPACE","\n\t\t\t\t",888],"{",["T_WHITESPACE","\n\t\t\t\t\t",889],["T_VARIABLE","$this",890],["T_OBJECT_OPERATOR","->",890],["T_STRING","status",890],"=",["T_WHITESPACE"," ",890],["T_VARIABLE","$status",890],"[",["T_LNUMBER","1",890],"]",";",["T_WHITESPACE","\n                ",890],"}",["T_WHITESPACE","\n\t\t\t\t",891],["T_VARIABLE","$this",892],["T_OBJECT_OPERATOR","->",892],["T_STRING","response_code",892],["T_WHITESPACE"," ",892],"=",["T_WHITESPACE"," ",892],["T_VARIABLE","$currentHeader",892],";",["T_WHITESPACE","\n\t\t\t",892],"}",["T_WHITESPACE","\n\n\t\t\t",893],["T_VARIABLE","$this",895],["T_OBJECT_OPERATOR","->",895],["T_STRING","headers",895],"[","]",["T_WHITESPACE"," ",895],"=",["T_WHITESPACE"," ",895],["T_VARIABLE","$currentHeader",895],";",["T_WHITESPACE","\n\t\t",895],"}",["T_WHITESPACE","\n\n\t\t",896],["T_VARIABLE","$results",898],["T_WHITESPACE"," ",898],"=",["T_WHITESPACE"," ",898],["T_CONSTANT_ENCAPSED_STRING","''",898],";",["T_WHITESPACE","\n\t\t",898],["T_DO","do",899],["T_WHITESPACE"," ",899],"{",["T_WHITESPACE","\n    \t\t",899],["T_VARIABLE","$_data",900],["T_WHITESPACE"," ",900],"=",["T_WHITESPACE"," ",900],["T_STRING","fread",900],"(",["T_VARIABLE","$fp",900],",",["T_WHITESPACE"," ",900],["T_VARIABLE","$this",900],["T_OBJECT_OPERATOR","->",900],["T_STRING","maxlength",900],")",";",["T_WHITESPACE","\n    \t\t",900],["T_IF","if",901],["T_WHITESPACE"," ",901],"(",["T_STRING","strlen",901],"(",["T_VARIABLE","$_data",901],")",["T_WHITESPACE"," ",901],["T_IS_EQUAL","==",901],["T_WHITESPACE"," ",901],["T_LNUMBER","0",901],")",["T_WHITESPACE"," ",901],"{",["T_WHITESPACE","\n        \t\t",901],["T_BREAK","break",902],";",["T_WHITESPACE","\n    \t\t",902],"}",["T_WHITESPACE","\n    \t\t",903],["T_VARIABLE","$results",904],["T_WHITESPACE"," ",904],["T_CONCAT_EQUAL",".=",904],["T_WHITESPACE"," ",904],["T_VARIABLE","$_data",904],";",["T_WHITESPACE","\n\t\t",904],"}",["T_WHITESPACE"," ",905],["T_WHILE","while",905],"(",["T_STRING","true",905],")",";",["T_WHITESPACE","\n\n\t\t",905],["T_IF","if",907],["T_WHITESPACE"," ",907],"(",["T_VARIABLE","$this",907],["T_OBJECT_OPERATOR","->",907],["T_STRING","read_timeout",907],["T_WHITESPACE"," ",907],">",["T_WHITESPACE"," ",907],["T_LNUMBER","0",907],["T_WHITESPACE"," ",907],["T_BOOLEAN_AND","&&",907],["T_WHITESPACE"," ",907],["T_VARIABLE","$this",907],["T_OBJECT_OPERATOR","->",907],["T_STRING","_check_timeout",907],"(",["T_VARIABLE","$fp",907],")",")",["T_WHITESPACE","\n\t\t",907],"{",["T_WHITESPACE","\n\t\t\t",908],["T_VARIABLE","$this",909],["T_OBJECT_OPERATOR","->",909],["T_STRING","status",909],"=","-",["T_LNUMBER","100",909],";",["T_WHITESPACE","\n\t\t\t",909],["T_RETURN","return",910],["T_WHITESPACE"," ",910],["T_STRING","false",910],";",["T_WHITESPACE","\n\t\t",910],"}",["T_WHITESPACE","\n\n\t\t",911],["T_COMMENT","\/\/ check if there is a redirect meta tag\n",913],["T_WHITESPACE","\n\t\t",914],["T_IF","if",915],"(",["T_STRING","preg_match",915],"(",["T_CONSTANT_ENCAPSED_STRING","\"'<meta[\\s]*http-equiv[^>]*?content[\\s]*=[\\s]*[\\\"\\']?\\d+;[\\s]*URL[\\s]*=[\\s]*([^\\\"\\']*?)[\\\"\\']?>'i\"",915],",",["T_VARIABLE","$results",915],",",["T_VARIABLE","$match",915],")",")",["T_WHITESPACE","\n\n\t\t",915],"{",["T_WHITESPACE","\n\t\t\t",917],["T_VARIABLE","$this",918],["T_OBJECT_OPERATOR","->",918],["T_STRING","_redirectaddr",918],["T_WHITESPACE"," ",918],"=",["T_WHITESPACE"," ",918],["T_VARIABLE","$this",918],["T_OBJECT_OPERATOR","->",918],["T_STRING","_expandlinks",918],"(",["T_VARIABLE","$match",918],"[",["T_LNUMBER","1",918],"]",",",["T_VARIABLE","$URI",918],")",";",["T_WHITESPACE","\n\t\t",918],"}",["T_WHITESPACE","\n\n\t\t",919],["T_COMMENT","\/\/ have we hit our frame depth and is there frame src to fetch?\n",921],["T_WHITESPACE","\t\t",922],["T_IF","if",922],"(","(",["T_VARIABLE","$this",922],["T_OBJECT_OPERATOR","->",922],["T_STRING","_framedepth",922],["T_WHITESPACE"," ",922],"<",["T_WHITESPACE"," ",922],["T_VARIABLE","$this",922],["T_OBJECT_OPERATOR","->",922],["T_STRING","maxframes",922],")",["T_WHITESPACE"," ",922],["T_BOOLEAN_AND","&&",922],["T_WHITESPACE"," ",922],["T_STRING","preg_match_all",922],"(",["T_CONSTANT_ENCAPSED_STRING","\"'<frame\\s+.*src[\\s]*=[\\'\\\"]?([^\\'\\\"\\>]+)'i\"",922],",",["T_VARIABLE","$results",922],",",["T_VARIABLE","$match",922],")",")",["T_WHITESPACE","\n\t\t",922],"{",["T_WHITESPACE","\n\t\t\t",923],["T_VARIABLE","$this",924],["T_OBJECT_OPERATOR","->",924],["T_STRING","results",924],"[","]",["T_WHITESPACE"," ",924],"=",["T_WHITESPACE"," ",924],["T_VARIABLE","$results",924],";",["T_WHITESPACE","\n\t\t\t",924],["T_FOR","for",925],"(",["T_VARIABLE","$x",925],"=",["T_LNUMBER","0",925],";",["T_WHITESPACE"," ",925],["T_VARIABLE","$x",925],"<",["T_STRING","count",925],"(",["T_VARIABLE","$match",925],"[",["T_LNUMBER","1",925],"]",")",";",["T_WHITESPACE"," ",925],["T_VARIABLE","$x",925],["T_INC","++",925],")",["T_WHITESPACE","\n\t\t\t\t",925],["T_VARIABLE","$this",926],["T_OBJECT_OPERATOR","->",926],["T_STRING","_frameurls",926],"[","]",["T_WHITESPACE"," ",926],"=",["T_WHITESPACE"," ",926],["T_VARIABLE","$this",926],["T_OBJECT_OPERATOR","->",926],["T_STRING","_expandlinks",926],"(",["T_VARIABLE","$match",926],"[",["T_LNUMBER","1",926],"]","[",["T_VARIABLE","$x",926],"]",",",["T_VARIABLE","$URI_PARTS",926],"[",["T_CONSTANT_ENCAPSED_STRING","\"scheme\"",926],"]",".",["T_CONSTANT_ENCAPSED_STRING","\":\/\/\"",926],".",["T_VARIABLE","$this",926],["T_OBJECT_OPERATOR","->",926],["T_STRING","host",926],")",";",["T_WHITESPACE","\n\t\t",926],"}",["T_WHITESPACE","\n\t\t",927],["T_COMMENT","\/\/ have we already fetched framed content?\n",928],["T_WHITESPACE","\t\t",929],["T_ELSEIF","elseif",929],"(",["T_STRING","is_array",929],"(",["T_VARIABLE","$this",929],["T_OBJECT_OPERATOR","->",929],["T_STRING","results",929],")",")",["T_WHITESPACE","\n\t\t\t",929],["T_VARIABLE","$this",930],["T_OBJECT_OPERATOR","->",930],["T_STRING","results",930],"[","]",["T_WHITESPACE"," ",930],"=",["T_WHITESPACE"," ",930],["T_VARIABLE","$results",930],";",["T_WHITESPACE","\n\t\t",930],["T_COMMENT","\/\/ no framed content\n",931],["T_WHITESPACE","\t\t",932],["T_ELSE","else",932],["T_WHITESPACE","\n\t\t\t",932],["T_VARIABLE","$this",933],["T_OBJECT_OPERATOR","->",933],["T_STRING","results",933],["T_WHITESPACE"," ",933],"=",["T_WHITESPACE"," ",933],["T_VARIABLE","$results",933],";",["T_WHITESPACE","\n\n\t\t",933],["T_RETURN","return",935],["T_WHITESPACE"," ",935],["T_STRING","true",935],";",["T_WHITESPACE","\n\t",935],"}",["T_WHITESPACE","\n\n",936],["T_COMMENT","\/*======================================================================*\\\n\tFunction:\t_httpsrequest\n\tPurpose:\tgo get the https data from the server using curl\n\tInput:\t\t$url\t\tthe url to fetch\n\t\t\t\t$URI\t\tthe full URI\n\t\t\t\t$body\t\tbody contents to send if any (POST)\n\tOutput:\n\\*======================================================================*\/",938],["T_WHITESPACE","\n\n\t",945],["T_FUNCTION","function",947],["T_WHITESPACE"," ",947],["T_STRING","_httpsrequest",947],"(",["T_VARIABLE","$url",947],",",["T_VARIABLE","$URI",947],",",["T_VARIABLE","$http_method",947],",",["T_VARIABLE","$content_type",947],"=",["T_CONSTANT_ENCAPSED_STRING","\"\"",947],",",["T_VARIABLE","$body",947],"=",["T_CONSTANT_ENCAPSED_STRING","\"\"",947],")",["T_WHITESPACE","\n\t",947],"{",["T_WHITESPACE","\n\t\t",948],["T_IF","if",949],"(",["T_VARIABLE","$this",949],["T_OBJECT_OPERATOR","->",949],["T_STRING","passcookies",949],["T_WHITESPACE"," ",949],["T_BOOLEAN_AND","&&",949],["T_WHITESPACE"," ",949],["T_VARIABLE","$this",949],["T_OBJECT_OPERATOR","->",949],["T_STRING","_redirectaddr",949],")",["T_WHITESPACE","\n\t\t\t",949],["T_VARIABLE","$this",950],["T_OBJECT_OPERATOR","->",950],["T_STRING","setcookies",950],"(",")",";",["T_WHITESPACE","\n\n\t\t",950],["T_VARIABLE","$headers",952],["T_WHITESPACE"," ",952],"=",["T_WHITESPACE"," ",952],["T_ARRAY","array",952],"(",")",";",["T_WHITESPACE","\n\n\t\t",952],["T_VARIABLE","$URI_PARTS",954],["T_WHITESPACE"," ",954],"=",["T_WHITESPACE"," ",954],["T_STRING","parse_url",954],"(",["T_VARIABLE","$URI",954],")",";",["T_WHITESPACE","\n\t\t",954],["T_IF","if",955],"(",["T_EMPTY","empty",955],"(",["T_VARIABLE","$url",955],")",")",["T_WHITESPACE","\n\t\t\t",955],["T_VARIABLE","$url",956],["T_WHITESPACE"," ",956],"=",["T_WHITESPACE"," ",956],["T_CONSTANT_ENCAPSED_STRING","\"\/\"",956],";",["T_WHITESPACE","\n\t\t",956],["T_COMMENT","\/\/ GET ... header not needed for curl\n",957],["T_WHITESPACE","\t\t",958],["T_COMMENT","\/\/$headers[] = $http_method.\" \".$url.\" \".$this->_httpversion;\n",958],["T_WHITESPACE","\t\t",959],["T_IF","if",959],"(","!",["T_EMPTY","empty",959],"(",["T_VARIABLE","$this",959],["T_OBJECT_OPERATOR","->",959],["T_STRING","agent",959],")",")",["T_WHITESPACE","\n\t\t\t",959],["T_VARIABLE","$headers",960],"[","]",["T_WHITESPACE"," ",960],"=",["T_WHITESPACE"," ",960],["T_CONSTANT_ENCAPSED_STRING","\"User-Agent: \"",960],".",["T_VARIABLE","$this",960],["T_OBJECT_OPERATOR","->",960],["T_STRING","agent",960],";",["T_WHITESPACE","\n\t\t",960],["T_IF","if",961],"(","!",["T_EMPTY","empty",961],"(",["T_VARIABLE","$this",961],["T_OBJECT_OPERATOR","->",961],["T_STRING","host",961],")",")",["T_WHITESPACE","\n\t\t\t",961],["T_IF","if",962],"(","!",["T_EMPTY","empty",962],"(",["T_VARIABLE","$this",962],["T_OBJECT_OPERATOR","->",962],["T_STRING","port",962],")",")",["T_WHITESPACE","\n\t\t\t\t",962],["T_VARIABLE","$headers",963],"[","]",["T_WHITESPACE"," ",963],"=",["T_WHITESPACE"," ",963],["T_CONSTANT_ENCAPSED_STRING","\"Host: \"",963],".",["T_VARIABLE","$this",963],["T_OBJECT_OPERATOR","->",963],["T_STRING","host",963],".",["T_CONSTANT_ENCAPSED_STRING","\":\"",963],".",["T_VARIABLE","$this",963],["T_OBJECT_OPERATOR","->",963],["T_STRING","port",963],";",["T_WHITESPACE","\n\t\t\t",963],["T_ELSE","else",964],["T_WHITESPACE","\n\t\t\t\t",964],["T_VARIABLE","$headers",965],"[","]",["T_WHITESPACE"," ",965],"=",["T_WHITESPACE"," ",965],["T_CONSTANT_ENCAPSED_STRING","\"Host: \"",965],".",["T_VARIABLE","$this",965],["T_OBJECT_OPERATOR","->",965],["T_STRING","host",965],";",["T_WHITESPACE","\n\t\t",965],["T_IF","if",966],"(","!",["T_EMPTY","empty",966],"(",["T_VARIABLE","$this",966],["T_OBJECT_OPERATOR","->",966],["T_STRING","accept",966],")",")",["T_WHITESPACE","\n\t\t\t",966],["T_VARIABLE","$headers",967],"[","]",["T_WHITESPACE"," ",967],"=",["T_WHITESPACE"," ",967],["T_CONSTANT_ENCAPSED_STRING","\"Accept: \"",967],".",["T_VARIABLE","$this",967],["T_OBJECT_OPERATOR","->",967],["T_STRING","accept",967],";",["T_WHITESPACE","\n\t\t",967],["T_IF","if",968],"(","!",["T_EMPTY","empty",968],"(",["T_VARIABLE","$this",968],["T_OBJECT_OPERATOR","->",968],["T_STRING","referer",968],")",")",["T_WHITESPACE","\n\t\t\t",968],["T_VARIABLE","$headers",969],"[","]",["T_WHITESPACE"," ",969],"=",["T_WHITESPACE"," ",969],["T_CONSTANT_ENCAPSED_STRING","\"Referer: \"",969],".",["T_VARIABLE","$this",969],["T_OBJECT_OPERATOR","->",969],["T_STRING","referer",969],";",["T_WHITESPACE","\n\t\t",969],["T_IF","if",970],"(","!",["T_EMPTY","empty",970],"(",["T_VARIABLE","$this",970],["T_OBJECT_OPERATOR","->",970],["T_STRING","cookies",970],")",")",["T_WHITESPACE","\n\t\t",970],"{",["T_WHITESPACE","\n\t\t\t",971],["T_IF","if",972],"(","!",["T_STRING","is_array",972],"(",["T_VARIABLE","$this",972],["T_OBJECT_OPERATOR","->",972],["T_STRING","cookies",972],")",")",["T_WHITESPACE","\n\t\t\t\t",972],["T_VARIABLE","$this",973],["T_OBJECT_OPERATOR","->",973],["T_STRING","cookies",973],["T_WHITESPACE"," ",973],"=",["T_WHITESPACE"," ",973],["T_ARRAY_CAST","(array)",973],["T_VARIABLE","$this",973],["T_OBJECT_OPERATOR","->",973],["T_STRING","cookies",973],";",["T_WHITESPACE","\n\n\t\t\t",973],["T_STRING","reset",975],"(",["T_VARIABLE","$this",975],["T_OBJECT_OPERATOR","->",975],["T_STRING","cookies",975],")",";",["T_WHITESPACE","\n\t\t\t",975],["T_IF","if",976],["T_WHITESPACE"," ",976],"(",["T_WHITESPACE"," ",976],["T_STRING","count",976],"(",["T_VARIABLE","$this",976],["T_OBJECT_OPERATOR","->",976],["T_STRING","cookies",976],")",["T_WHITESPACE"," ",976],">",["T_WHITESPACE"," ",976],["T_LNUMBER","0",976],["T_WHITESPACE"," ",976],")",["T_WHITESPACE"," ",976],"{",["T_WHITESPACE","\n\t\t\t\t",976],["T_VARIABLE","$cookie_str",977],["T_WHITESPACE"," ",977],"=",["T_WHITESPACE"," ",977],["T_CONSTANT_ENCAPSED_STRING","'Cookie: '",977],";",["T_WHITESPACE","\n\t\t\t\t",977],["T_FOREACH","foreach",978],["T_WHITESPACE"," ",978],"(",["T_WHITESPACE"," ",978],["T_VARIABLE","$this",978],["T_OBJECT_OPERATOR","->",978],["T_STRING","cookies",978],["T_WHITESPACE"," ",978],["T_AS","as",978],["T_WHITESPACE"," ",978],["T_VARIABLE","$cookieKey",978],["T_WHITESPACE"," ",978],["T_DOUBLE_ARROW","=>",978],["T_WHITESPACE"," ",978],["T_VARIABLE","$cookieVal",978],["T_WHITESPACE"," ",978],")",["T_WHITESPACE"," ",978],"{",["T_WHITESPACE","\n\t\t\t\t",978],["T_VARIABLE","$cookie_str",979],["T_WHITESPACE"," ",979],["T_CONCAT_EQUAL",".=",979],["T_WHITESPACE"," ",979],["T_VARIABLE","$cookieKey",979],".",["T_CONSTANT_ENCAPSED_STRING","\"=\"",979],".",["T_STRING","urlencode",979],"(",["T_VARIABLE","$cookieVal",979],")",".",["T_CONSTANT_ENCAPSED_STRING","\"; \"",979],";",["T_WHITESPACE","\n\t\t\t\t",979],"}",["T_WHITESPACE","\n\t\t\t\t",980],["T_VARIABLE","$headers",981],"[","]",["T_WHITESPACE"," ",981],"=",["T_WHITESPACE"," ",981],["T_STRING","substr",981],"(",["T_VARIABLE","$cookie_str",981],",",["T_LNUMBER","0",981],",","-",["T_LNUMBER","2",981],")",";",["T_WHITESPACE","\n\t\t\t",981],"}",["T_WHITESPACE","\n\t\t",982],"}",["T_WHITESPACE","\n\t\t",983],["T_IF","if",984],"(","!",["T_EMPTY","empty",984],"(",["T_VARIABLE","$this",984],["T_OBJECT_OPERATOR","->",984],["T_STRING","rawheaders",984],")",")",["T_WHITESPACE","\n\t\t",984],"{",["T_WHITESPACE","\n\t\t\t",985],["T_IF","if",986],"(","!",["T_STRING","is_array",986],"(",["T_VARIABLE","$this",986],["T_OBJECT_OPERATOR","->",986],["T_STRING","rawheaders",986],")",")",["T_WHITESPACE","\n\t\t\t\t",986],["T_VARIABLE","$this",987],["T_OBJECT_OPERATOR","->",987],["T_STRING","rawheaders",987],["T_WHITESPACE"," ",987],"=",["T_WHITESPACE"," ",987],["T_ARRAY_CAST","(array)",987],["T_VARIABLE","$this",987],["T_OBJECT_OPERATOR","->",987],["T_STRING","rawheaders",987],";",["T_WHITESPACE","\n\t\t\t",987],["T_WHILE","while",988],"(",["T_LIST","list",988],"(",["T_VARIABLE","$headerKey",988],",",["T_VARIABLE","$headerVal",988],")",["T_WHITESPACE"," ",988],"=",["T_WHITESPACE"," ",988],["T_STRING","each",988],"(",["T_VARIABLE","$this",988],["T_OBJECT_OPERATOR","->",988],["T_STRING","rawheaders",988],")",")",["T_WHITESPACE","\n\t\t\t\t",988],["T_VARIABLE","$headers",989],"[","]",["T_WHITESPACE"," ",989],"=",["T_WHITESPACE"," ",989],["T_VARIABLE","$headerKey",989],".",["T_CONSTANT_ENCAPSED_STRING","\": \"",989],".",["T_VARIABLE","$headerVal",989],";",["T_WHITESPACE","\n\t\t",989],"}",["T_WHITESPACE","\n\t\t",990],["T_IF","if",991],"(","!",["T_EMPTY","empty",991],"(",["T_VARIABLE","$content_type",991],")",")",["T_WHITESPACE"," ",991],"{",["T_WHITESPACE","\n\t\t\t",991],["T_IF","if",992],["T_WHITESPACE"," ",992],"(",["T_VARIABLE","$content_type",992],["T_WHITESPACE"," ",992],["T_IS_EQUAL","==",992],["T_WHITESPACE"," ",992],["T_CONSTANT_ENCAPSED_STRING","\"multipart\/form-data\"",992],")",["T_WHITESPACE","\n\t\t\t\t",992],["T_VARIABLE","$headers",993],"[","]",["T_WHITESPACE"," ",993],"=",["T_WHITESPACE"," ",993],"\"",["T_ENCAPSED_AND_WHITESPACE","Content-type: ",993],["T_VARIABLE","$content_type",993],["T_ENCAPSED_AND_WHITESPACE","; boundary=",993],"\"",".",["T_VARIABLE","$this",993],["T_OBJECT_OPERATOR","->",993],["T_STRING","_mime_boundary",993],";",["T_WHITESPACE","\n\t\t\t",993],["T_ELSE","else",994],["T_WHITESPACE","\n\t\t\t\t",994],["T_VARIABLE","$headers",995],"[","]",["T_WHITESPACE"," ",995],"=",["T_WHITESPACE"," ",995],"\"",["T_ENCAPSED_AND_WHITESPACE","Content-type: ",995],["T_VARIABLE","$content_type",995],"\"",";",["T_WHITESPACE","\n\t\t",995],"}",["T_WHITESPACE","\n\t\t",996],["T_IF","if",997],"(","!",["T_EMPTY","empty",997],"(",["T_VARIABLE","$body",997],")",")",["T_WHITESPACE","\n\t\t\t",997],["T_VARIABLE","$headers",998],"[","]",["T_WHITESPACE"," ",998],"=",["T_WHITESPACE"," ",998],["T_CONSTANT_ENCAPSED_STRING","\"Content-length: \"",998],".",["T_STRING","strlen",998],"(",["T_VARIABLE","$body",998],")",";",["T_WHITESPACE","\n\t\t",998],["T_IF","if",999],"(","!",["T_EMPTY","empty",999],"(",["T_VARIABLE","$this",999],["T_OBJECT_OPERATOR","->",999],["T_STRING","user",999],")",["T_WHITESPACE"," ",999],["T_BOOLEAN_OR","||",999],["T_WHITESPACE"," ",999],"!",["T_EMPTY","empty",999],"(",["T_VARIABLE","$this",999],["T_OBJECT_OPERATOR","->",999],["T_STRING","pass",999],")",")",["T_WHITESPACE","\n\t\t\t",999],["T_VARIABLE","$headers",1000],"[","]",["T_WHITESPACE"," ",1000],"=",["T_WHITESPACE"," ",1000],["T_CONSTANT_ENCAPSED_STRING","\"Authorization: BASIC \"",1000],".",["T_STRING","base64_encode",1000],"(",["T_VARIABLE","$this",1000],["T_OBJECT_OPERATOR","->",1000],["T_STRING","user",1000],".",["T_CONSTANT_ENCAPSED_STRING","\":\"",1000],".",["T_VARIABLE","$this",1000],["T_OBJECT_OPERATOR","->",1000],["T_STRING","pass",1000],")",";",["T_WHITESPACE","\n\n\t\t",1000],["T_VARIABLE","$headerfile",1002],["T_WHITESPACE"," ",1002],"=",["T_WHITESPACE"," ",1002],["T_STRING","tempnam",1002],"(",["T_WHITESPACE"," ",1002],["T_VARIABLE","$this",1002],["T_OBJECT_OPERATOR","->",1002],["T_STRING","temp_dir",1002],",",["T_WHITESPACE"," ",1002],["T_CONSTANT_ENCAPSED_STRING","\"sno\"",1002],["T_WHITESPACE"," ",1002],")",";",["T_WHITESPACE","\n\t\t",1002],["T_VARIABLE","$cmdline_params",1003],["T_WHITESPACE"," ",1003],"=",["T_WHITESPACE"," ",1003],["T_CONSTANT_ENCAPSED_STRING","'-k -D '",1003],["T_WHITESPACE"," ",1003],".",["T_WHITESPACE"," ",1003],["T_STRING","escapeshellarg",1003],"(",["T_WHITESPACE"," ",1003],["T_VARIABLE","$headerfile",1003],["T_WHITESPACE"," ",1003],")",";",["T_WHITESPACE","\n\n\t\t",1003],["T_FOREACH","foreach",1005],["T_WHITESPACE"," ",1005],"(",["T_WHITESPACE"," ",1005],["T_VARIABLE","$headers",1005],["T_WHITESPACE"," ",1005],["T_AS","as",1005],["T_WHITESPACE"," ",1005],["T_VARIABLE","$header",1005],["T_WHITESPACE"," ",1005],")",["T_WHITESPACE"," ",1005],"{",["T_WHITESPACE","\n\t\t\t",1005],["T_VARIABLE","$cmdline_params",1006],["T_WHITESPACE"," ",1006],["T_CONCAT_EQUAL",".=",1006],["T_WHITESPACE"," ",1006],["T_CONSTANT_ENCAPSED_STRING","' -H '",1006],["T_WHITESPACE"," ",1006],".",["T_WHITESPACE"," ",1006],["T_STRING","escapeshellarg",1006],"(",["T_WHITESPACE"," ",1006],["T_VARIABLE","$header",1006],["T_WHITESPACE"," ",1006],")",";",["T_WHITESPACE","\n\t\t",1006],"}",["T_WHITESPACE","\n\n\t\t",1007],["T_IF","if",1009],["T_WHITESPACE"," ",1009],"(",["T_WHITESPACE"," ",1009],"!",["T_WHITESPACE"," ",1009],["T_EMPTY","empty",1009],"(",["T_WHITESPACE"," ",1009],["T_VARIABLE","$body",1009],["T_WHITESPACE"," ",1009],")",["T_WHITESPACE"," ",1009],")",["T_WHITESPACE"," ",1009],"{",["T_WHITESPACE","\n\t\t\t",1009],["T_VARIABLE","$cmdline_params",1010],["T_WHITESPACE"," ",1010],["T_CONCAT_EQUAL",".=",1010],["T_WHITESPACE"," ",1010],["T_CONSTANT_ENCAPSED_STRING","' -d '",1010],["T_WHITESPACE"," ",1010],".",["T_WHITESPACE"," ",1010],["T_STRING","escapeshellarg",1010],"(",["T_WHITESPACE"," ",1010],["T_VARIABLE","$body",1010],["T_WHITESPACE"," ",1010],")",";",["T_WHITESPACE","\n\t\t",1010],"}",["T_WHITESPACE","\n\n\t\t",1011],["T_IF","if",1013],["T_WHITESPACE"," ",1013],"(",["T_WHITESPACE"," ",1013],["T_VARIABLE","$this",1013],["T_OBJECT_OPERATOR","->",1013],["T_STRING","read_timeout",1013],["T_WHITESPACE"," ",1013],">",["T_WHITESPACE"," ",1013],["T_LNUMBER","0",1013],["T_WHITESPACE"," ",1013],")",["T_WHITESPACE"," ",1013],"{",["T_WHITESPACE","\n\t\t\t",1013],["T_VARIABLE","$cmdline_params",1014],["T_WHITESPACE"," ",1014],["T_CONCAT_EQUAL",".=",1014],["T_WHITESPACE"," ",1014],["T_CONSTANT_ENCAPSED_STRING","' -m '",1014],["T_WHITESPACE"," ",1014],".",["T_WHITESPACE"," ",1014],["T_STRING","escapeshellarg",1014],"(",["T_WHITESPACE"," ",1014],["T_VARIABLE","$this",1014],["T_OBJECT_OPERATOR","->",1014],["T_STRING","read_timeout",1014],["T_WHITESPACE"," ",1014],")",";",["T_WHITESPACE","\n\t\t",1014],"}",["T_WHITESPACE","\n\n\n\t\t",1015],["T_STRING","exec",1018],"(",["T_WHITESPACE"," ",1018],["T_VARIABLE","$this",1018],["T_OBJECT_OPERATOR","->",1018],["T_STRING","curl_path",1018],["T_WHITESPACE"," ",1018],".",["T_WHITESPACE"," ",1018],["T_CONSTANT_ENCAPSED_STRING","' '",1018],["T_WHITESPACE"," ",1018],".",["T_WHITESPACE"," ",1018],["T_VARIABLE","$cmdline_params",1018],["T_WHITESPACE"," ",1018],".",["T_WHITESPACE"," ",1018],["T_CONSTANT_ENCAPSED_STRING","' '",1018],["T_WHITESPACE"," ",1018],".",["T_WHITESPACE"," ",1018],["T_STRING","escapeshellarg",1018],"(",["T_WHITESPACE"," ",1018],["T_VARIABLE","$URI",1018],["T_WHITESPACE"," ",1018],")",",",["T_WHITESPACE"," ",1018],["T_VARIABLE","$results",1018],",",["T_WHITESPACE"," ",1018],["T_VARIABLE","$return",1018],["T_WHITESPACE"," ",1018],")",";",["T_WHITESPACE","\n\n\t\t",1018],["T_IF","if",1020],"(",["T_VARIABLE","$return",1020],")",["T_WHITESPACE","\n\t\t",1020],"{",["T_WHITESPACE","\n\t\t\t",1021],["T_VARIABLE","$this",1022],["T_OBJECT_OPERATOR","->",1022],["T_STRING","error",1022],["T_WHITESPACE"," ",1022],"=",["T_WHITESPACE"," ",1022],"\"",["T_ENCAPSED_AND_WHITESPACE","Error: cURL could not retrieve the document, error ",1022],["T_VARIABLE","$return",1022],["T_ENCAPSED_AND_WHITESPACE",".",1022],"\"",";",["T_WHITESPACE","\n\t\t\t",1022],["T_RETURN","return",1023],["T_WHITESPACE"," ",1023],["T_STRING","false",1023],";",["T_WHITESPACE","\n\t\t",1023],"}",["T_WHITESPACE","\n\n\n\t\t",1024],["T_VARIABLE","$results",1027],["T_WHITESPACE"," ",1027],"=",["T_WHITESPACE"," ",1027],["T_STRING","implode",1027],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",1027],",",["T_VARIABLE","$results",1027],")",";",["T_WHITESPACE","\n\n\t\t",1027],["T_VARIABLE","$result_headers",1029],["T_WHITESPACE"," ",1029],"=",["T_WHITESPACE"," ",1029],["T_STRING","file",1029],"(","\"",["T_VARIABLE","$headerfile",1029],"\"",")",";",["T_WHITESPACE","\n\n\t\t",1029],["T_VARIABLE","$this",1031],["T_OBJECT_OPERATOR","->",1031],["T_STRING","_redirectaddr",1031],["T_WHITESPACE"," ",1031],"=",["T_WHITESPACE"," ",1031],["T_STRING","false",1031],";",["T_WHITESPACE","\n\t\t",1031],["T_UNSET","unset",1032],"(",["T_VARIABLE","$this",1032],["T_OBJECT_OPERATOR","->",1032],["T_STRING","headers",1032],")",";",["T_WHITESPACE","\n\n\t\t",1032],["T_FOR","for",1034],"(",["T_VARIABLE","$currentHeader",1034],["T_WHITESPACE"," ",1034],"=",["T_WHITESPACE"," ",1034],["T_LNUMBER","0",1034],";",["T_WHITESPACE"," ",1034],["T_VARIABLE","$currentHeader",1034],["T_WHITESPACE"," ",1034],"<",["T_WHITESPACE"," ",1034],["T_STRING","count",1034],"(",["T_VARIABLE","$result_headers",1034],")",";",["T_WHITESPACE"," ",1034],["T_VARIABLE","$currentHeader",1034],["T_INC","++",1034],")",["T_WHITESPACE","\n\t\t",1034],"{",["T_WHITESPACE","\n\n\t\t\t",1035],["T_COMMENT","\/\/ if a header begins with Location: or URI:, set the redirect\n",1037],["T_WHITESPACE","\t\t\t",1038],["T_IF","if",1038],"(",["T_STRING","preg_match",1038],"(",["T_CONSTANT_ENCAPSED_STRING","\"\/^(Location: |URI: )\/i\"",1038],",",["T_VARIABLE","$result_headers",1038],"[",["T_VARIABLE","$currentHeader",1038],"]",")",")",["T_WHITESPACE","\n\t\t\t",1038],"{",["T_WHITESPACE","\n\t\t\t\t",1039],["T_COMMENT","\/\/ get URL portion of the redirect\n",1040],["T_WHITESPACE","\t\t\t\t",1041],["T_STRING","preg_match",1041],"(",["T_CONSTANT_ENCAPSED_STRING","\"\/^(Location: |URI:)\\s+(.*)\/\"",1041],",",["T_STRING","chop",1041],"(",["T_VARIABLE","$result_headers",1041],"[",["T_VARIABLE","$currentHeader",1041],"]",")",",",["T_VARIABLE","$matches",1041],")",";",["T_WHITESPACE","\n\t\t\t\t",1041],["T_COMMENT","\/\/ look for :\/\/ in the Location header to see if hostname is included\n",1042],["T_WHITESPACE","\t\t\t\t",1043],["T_IF","if",1043],"(","!",["T_STRING","preg_match",1043],"(",["T_CONSTANT_ENCAPSED_STRING","\"|\\:\\\/\\\/|\"",1043],",",["T_VARIABLE","$matches",1043],"[",["T_LNUMBER","2",1043],"]",")",")",["T_WHITESPACE","\n\t\t\t\t",1043],"{",["T_WHITESPACE","\n\t\t\t\t\t",1044],["T_COMMENT","\/\/ no host in the path, so prepend\n",1045],["T_WHITESPACE","\t\t\t\t\t",1046],["T_VARIABLE","$this",1046],["T_OBJECT_OPERATOR","->",1046],["T_STRING","_redirectaddr",1046],["T_WHITESPACE"," ",1046],"=",["T_WHITESPACE"," ",1046],["T_VARIABLE","$URI_PARTS",1046],"[",["T_CONSTANT_ENCAPSED_STRING","\"scheme\"",1046],"]",".",["T_CONSTANT_ENCAPSED_STRING","\":\/\/\"",1046],".",["T_VARIABLE","$this",1046],["T_OBJECT_OPERATOR","->",1046],["T_STRING","host",1046],".",["T_CONSTANT_ENCAPSED_STRING","\":\"",1046],".",["T_VARIABLE","$this",1046],["T_OBJECT_OPERATOR","->",1046],["T_STRING","port",1046],";",["T_WHITESPACE","\n\t\t\t\t\t",1046],["T_COMMENT","\/\/ eliminate double slash\n",1047],["T_WHITESPACE","\t\t\t\t\t",1048],["T_IF","if",1048],"(","!",["T_STRING","preg_match",1048],"(",["T_CONSTANT_ENCAPSED_STRING","\"|^\/|\"",1048],",",["T_VARIABLE","$matches",1048],"[",["T_LNUMBER","2",1048],"]",")",")",["T_WHITESPACE","\n\t\t\t\t\t\t\t",1048],["T_VARIABLE","$this",1049],["T_OBJECT_OPERATOR","->",1049],["T_STRING","_redirectaddr",1049],["T_WHITESPACE"," ",1049],["T_CONCAT_EQUAL",".=",1049],["T_WHITESPACE"," ",1049],["T_CONSTANT_ENCAPSED_STRING","\"\/\"",1049],".",["T_VARIABLE","$matches",1049],"[",["T_LNUMBER","2",1049],"]",";",["T_WHITESPACE","\n\t\t\t\t\t",1049],["T_ELSE","else",1050],["T_WHITESPACE","\n\t\t\t\t\t\t\t",1050],["T_VARIABLE","$this",1051],["T_OBJECT_OPERATOR","->",1051],["T_STRING","_redirectaddr",1051],["T_WHITESPACE"," ",1051],["T_CONCAT_EQUAL",".=",1051],["T_WHITESPACE"," ",1051],["T_VARIABLE","$matches",1051],"[",["T_LNUMBER","2",1051],"]",";",["T_WHITESPACE","\n\t\t\t\t",1051],"}",["T_WHITESPACE","\n\t\t\t\t",1052],["T_ELSE","else",1053],["T_WHITESPACE","\n\t\t\t\t\t",1053],["T_VARIABLE","$this",1054],["T_OBJECT_OPERATOR","->",1054],["T_STRING","_redirectaddr",1054],["T_WHITESPACE"," ",1054],"=",["T_WHITESPACE"," ",1054],["T_VARIABLE","$matches",1054],"[",["T_LNUMBER","2",1054],"]",";",["T_WHITESPACE","\n\t\t\t",1054],"}",["T_WHITESPACE","\n\n\t\t\t",1055],["T_IF","if",1057],"(",["T_STRING","preg_match",1057],"(",["T_CONSTANT_ENCAPSED_STRING","\"|^HTTP\/|\"",1057],",",["T_VARIABLE","$result_headers",1057],"[",["T_VARIABLE","$currentHeader",1057],"]",")",")",["T_WHITESPACE","\n\t\t\t\t",1057],["T_VARIABLE","$this",1058],["T_OBJECT_OPERATOR","->",1058],["T_STRING","response_code",1058],["T_WHITESPACE"," ",1058],"=",["T_WHITESPACE"," ",1058],["T_VARIABLE","$result_headers",1058],"[",["T_VARIABLE","$currentHeader",1058],"]",";",["T_WHITESPACE","\n\n\t\t\t",1058],["T_VARIABLE","$this",1060],["T_OBJECT_OPERATOR","->",1060],["T_STRING","headers",1060],"[","]",["T_WHITESPACE"," ",1060],"=",["T_WHITESPACE"," ",1060],["T_VARIABLE","$result_headers",1060],"[",["T_VARIABLE","$currentHeader",1060],"]",";",["T_WHITESPACE","\n\t\t",1060],"}",["T_WHITESPACE","\n\n\t\t",1061],["T_COMMENT","\/\/ check if there is a redirect meta tag\n",1063],["T_WHITESPACE","\n\t\t",1064],["T_IF","if",1065],"(",["T_STRING","preg_match",1065],"(",["T_CONSTANT_ENCAPSED_STRING","\"'<meta[\\s]*http-equiv[^>]*?content[\\s]*=[\\s]*[\\\"\\']?\\d+;[\\s]*URL[\\s]*=[\\s]*([^\\\"\\']*?)[\\\"\\']?>'i\"",1065],",",["T_VARIABLE","$results",1065],",",["T_VARIABLE","$match",1065],")",")",["T_WHITESPACE","\n\t\t",1065],"{",["T_WHITESPACE","\n\t\t\t",1066],["T_VARIABLE","$this",1067],["T_OBJECT_OPERATOR","->",1067],["T_STRING","_redirectaddr",1067],["T_WHITESPACE"," ",1067],"=",["T_WHITESPACE"," ",1067],["T_VARIABLE","$this",1067],["T_OBJECT_OPERATOR","->",1067],["T_STRING","_expandlinks",1067],"(",["T_VARIABLE","$match",1067],"[",["T_LNUMBER","1",1067],"]",",",["T_VARIABLE","$URI",1067],")",";",["T_WHITESPACE","\n\t\t",1067],"}",["T_WHITESPACE","\n\n\t\t",1068],["T_COMMENT","\/\/ have we hit our frame depth and is there frame src to fetch?\n",1070],["T_WHITESPACE","\t\t",1071],["T_IF","if",1071],"(","(",["T_VARIABLE","$this",1071],["T_OBJECT_OPERATOR","->",1071],["T_STRING","_framedepth",1071],["T_WHITESPACE"," ",1071],"<",["T_WHITESPACE"," ",1071],["T_VARIABLE","$this",1071],["T_OBJECT_OPERATOR","->",1071],["T_STRING","maxframes",1071],")",["T_WHITESPACE"," ",1071],["T_BOOLEAN_AND","&&",1071],["T_WHITESPACE"," ",1071],["T_STRING","preg_match_all",1071],"(",["T_CONSTANT_ENCAPSED_STRING","\"'<frame\\s+.*src[\\s]*=[\\'\\\"]?([^\\'\\\"\\>]+)'i\"",1071],",",["T_VARIABLE","$results",1071],",",["T_VARIABLE","$match",1071],")",")",["T_WHITESPACE","\n\t\t",1071],"{",["T_WHITESPACE","\n\t\t\t",1072],["T_VARIABLE","$this",1073],["T_OBJECT_OPERATOR","->",1073],["T_STRING","results",1073],"[","]",["T_WHITESPACE"," ",1073],"=",["T_WHITESPACE"," ",1073],["T_VARIABLE","$results",1073],";",["T_WHITESPACE","\n\t\t\t",1073],["T_FOR","for",1074],"(",["T_VARIABLE","$x",1074],"=",["T_LNUMBER","0",1074],";",["T_WHITESPACE"," ",1074],["T_VARIABLE","$x",1074],"<",["T_STRING","count",1074],"(",["T_VARIABLE","$match",1074],"[",["T_LNUMBER","1",1074],"]",")",";",["T_WHITESPACE"," ",1074],["T_VARIABLE","$x",1074],["T_INC","++",1074],")",["T_WHITESPACE","\n\t\t\t\t",1074],["T_VARIABLE","$this",1075],["T_OBJECT_OPERATOR","->",1075],["T_STRING","_frameurls",1075],"[","]",["T_WHITESPACE"," ",1075],"=",["T_WHITESPACE"," ",1075],["T_VARIABLE","$this",1075],["T_OBJECT_OPERATOR","->",1075],["T_STRING","_expandlinks",1075],"(",["T_VARIABLE","$match",1075],"[",["T_LNUMBER","1",1075],"]","[",["T_VARIABLE","$x",1075],"]",",",["T_VARIABLE","$URI_PARTS",1075],"[",["T_CONSTANT_ENCAPSED_STRING","\"scheme\"",1075],"]",".",["T_CONSTANT_ENCAPSED_STRING","\":\/\/\"",1075],".",["T_VARIABLE","$this",1075],["T_OBJECT_OPERATOR","->",1075],["T_STRING","host",1075],")",";",["T_WHITESPACE","\n\t\t",1075],"}",["T_WHITESPACE","\n\t\t",1076],["T_COMMENT","\/\/ have we already fetched framed content?\n",1077],["T_WHITESPACE","\t\t",1078],["T_ELSEIF","elseif",1078],"(",["T_STRING","is_array",1078],"(",["T_VARIABLE","$this",1078],["T_OBJECT_OPERATOR","->",1078],["T_STRING","results",1078],")",")",["T_WHITESPACE","\n\t\t\t",1078],["T_VARIABLE","$this",1079],["T_OBJECT_OPERATOR","->",1079],["T_STRING","results",1079],"[","]",["T_WHITESPACE"," ",1079],"=",["T_WHITESPACE"," ",1079],["T_VARIABLE","$results",1079],";",["T_WHITESPACE","\n\t\t",1079],["T_COMMENT","\/\/ no framed content\n",1080],["T_WHITESPACE","\t\t",1081],["T_ELSE","else",1081],["T_WHITESPACE","\n\t\t\t",1081],["T_VARIABLE","$this",1082],["T_OBJECT_OPERATOR","->",1082],["T_STRING","results",1082],["T_WHITESPACE"," ",1082],"=",["T_WHITESPACE"," ",1082],["T_VARIABLE","$results",1082],";",["T_WHITESPACE","\n\n\t\t",1082],["T_STRING","unlink",1084],"(","\"",["T_VARIABLE","$headerfile",1084],"\"",")",";",["T_WHITESPACE","\n\n\t\t",1084],["T_RETURN","return",1086],["T_WHITESPACE"," ",1086],["T_STRING","true",1086],";",["T_WHITESPACE","\n\t",1086],"}",["T_WHITESPACE","\n\n",1087],["T_COMMENT","\/*======================================================================*\\\n\tFunction:\tsetcookies()\n\tPurpose:\tset cookies for a redirection\n\\*======================================================================*\/",1089],["T_WHITESPACE","\n\n\t",1092],["T_FUNCTION","function",1094],["T_WHITESPACE"," ",1094],["T_STRING","setcookies",1094],"(",")",["T_WHITESPACE","\n\t",1094],"{",["T_WHITESPACE","\n\t\t",1095],["T_FOR","for",1096],"(",["T_VARIABLE","$x",1096],"=",["T_LNUMBER","0",1096],";",["T_WHITESPACE"," ",1096],["T_VARIABLE","$x",1096],"<",["T_STRING","count",1096],"(",["T_VARIABLE","$this",1096],["T_OBJECT_OPERATOR","->",1096],["T_STRING","headers",1096],")",";",["T_WHITESPACE"," ",1096],["T_VARIABLE","$x",1096],["T_INC","++",1096],")",["T_WHITESPACE","\n\t\t",1096],"{",["T_WHITESPACE","\n\t\t",1097],["T_IF","if",1098],"(",["T_STRING","preg_match",1098],"(",["T_CONSTANT_ENCAPSED_STRING","'\/^set-cookie:[\\s]+([^=]+)=([^;]+)\/i'",1098],",",["T_WHITESPACE"," ",1098],["T_VARIABLE","$this",1098],["T_OBJECT_OPERATOR","->",1098],["T_STRING","headers",1098],"[",["T_VARIABLE","$x",1098],"]",",",["T_VARIABLE","$match",1098],")",")",["T_WHITESPACE","\n\t\t\t",1098],["T_VARIABLE","$this",1099],["T_OBJECT_OPERATOR","->",1099],["T_STRING","cookies",1099],"[",["T_VARIABLE","$match",1099],"[",["T_LNUMBER","1",1099],"]","]",["T_WHITESPACE"," ",1099],"=",["T_WHITESPACE"," ",1099],["T_STRING","urldecode",1099],"(",["T_VARIABLE","$match",1099],"[",["T_LNUMBER","2",1099],"]",")",";",["T_WHITESPACE","\n\t\t",1099],"}",["T_WHITESPACE","\n\t",1100],"}",["T_WHITESPACE","\n\n\n",1101],["T_COMMENT","\/*======================================================================*\\\n\tFunction:\t_check_timeout\n\tPurpose:\tchecks whether timeout has occurred\n\tInput:\t\t$fp\tfile pointer\n\\*======================================================================*\/",1104],["T_WHITESPACE","\n\n\t",1108],["T_FUNCTION","function",1110],["T_WHITESPACE"," ",1110],["T_STRING","_check_timeout",1110],"(",["T_VARIABLE","$fp",1110],")",["T_WHITESPACE","\n\t",1110],"{",["T_WHITESPACE","\n\t\t",1111],["T_IF","if",1112],["T_WHITESPACE"," ",1112],"(",["T_VARIABLE","$this",1112],["T_OBJECT_OPERATOR","->",1112],["T_STRING","read_timeout",1112],["T_WHITESPACE"," ",1112],">",["T_WHITESPACE"," ",1112],["T_LNUMBER","0",1112],")",["T_WHITESPACE"," ",1112],"{",["T_WHITESPACE","\n\t\t\t",1112],["T_VARIABLE","$fp_status",1113],["T_WHITESPACE"," ",1113],"=",["T_WHITESPACE"," ",1113],["T_STRING","socket_get_status",1113],"(",["T_VARIABLE","$fp",1113],")",";",["T_WHITESPACE","\n\t\t\t",1113],["T_IF","if",1114],["T_WHITESPACE"," ",1114],"(",["T_VARIABLE","$fp_status",1114],"[",["T_CONSTANT_ENCAPSED_STRING","\"timed_out\"",1114],"]",")",["T_WHITESPACE"," ",1114],"{",["T_WHITESPACE","\n\t\t\t\t",1114],["T_VARIABLE","$this",1115],["T_OBJECT_OPERATOR","->",1115],["T_STRING","timed_out",1115],["T_WHITESPACE"," ",1115],"=",["T_WHITESPACE"," ",1115],["T_STRING","true",1115],";",["T_WHITESPACE","\n\t\t\t\t",1115],["T_RETURN","return",1116],["T_WHITESPACE"," ",1116],["T_STRING","true",1116],";",["T_WHITESPACE","\n\t\t\t",1116],"}",["T_WHITESPACE","\n\t\t",1117],"}",["T_WHITESPACE","\n\t\t",1118],["T_RETURN","return",1119],["T_WHITESPACE"," ",1119],["T_STRING","false",1119],";",["T_WHITESPACE","\n\t",1119],"}",["T_WHITESPACE","\n\n",1120],["T_COMMENT","\/*======================================================================*\\\n\tFunction:\t_connect\n\tPurpose:\tmake a socket connection\n\tInput:\t\t$fp\tfile pointer\n\\*======================================================================*\/",1122],["T_WHITESPACE","\n\n\t",1126],["T_FUNCTION","function",1128],["T_WHITESPACE"," ",1128],["T_STRING","_connect",1128],"(","&",["T_VARIABLE","$fp",1128],")",["T_WHITESPACE","\n\t",1128],"{",["T_WHITESPACE","\n\t\t",1129],["T_IF","if",1130],"(","!",["T_EMPTY","empty",1130],"(",["T_VARIABLE","$this",1130],["T_OBJECT_OPERATOR","->",1130],["T_STRING","proxy_host",1130],")",["T_WHITESPACE"," ",1130],["T_BOOLEAN_AND","&&",1130],["T_WHITESPACE"," ",1130],"!",["T_EMPTY","empty",1130],"(",["T_VARIABLE","$this",1130],["T_OBJECT_OPERATOR","->",1130],["T_STRING","proxy_port",1130],")",")",["T_WHITESPACE","\n\t\t\t",1130],"{",["T_WHITESPACE","\n\t\t\t\t",1131],["T_VARIABLE","$this",1132],["T_OBJECT_OPERATOR","->",1132],["T_STRING","_isproxy",1132],["T_WHITESPACE"," ",1132],"=",["T_WHITESPACE"," ",1132],["T_STRING","true",1132],";",["T_WHITESPACE","\n\n\t\t\t\t",1132],["T_VARIABLE","$host",1134],["T_WHITESPACE"," ",1134],"=",["T_WHITESPACE"," ",1134],["T_VARIABLE","$this",1134],["T_OBJECT_OPERATOR","->",1134],["T_STRING","proxy_host",1134],";",["T_WHITESPACE","\n\t\t\t\t",1134],["T_VARIABLE","$port",1135],["T_WHITESPACE"," ",1135],"=",["T_WHITESPACE"," ",1135],["T_VARIABLE","$this",1135],["T_OBJECT_OPERATOR","->",1135],["T_STRING","proxy_port",1135],";",["T_WHITESPACE","\n\t\t\t",1135],"}",["T_WHITESPACE","\n\t\t",1136],["T_ELSE","else",1137],["T_WHITESPACE","\n\t\t",1137],"{",["T_WHITESPACE","\n\t\t\t",1138],["T_VARIABLE","$host",1139],["T_WHITESPACE"," ",1139],"=",["T_WHITESPACE"," ",1139],["T_VARIABLE","$this",1139],["T_OBJECT_OPERATOR","->",1139],["T_STRING","host",1139],";",["T_WHITESPACE","\n\t\t\t",1139],["T_VARIABLE","$port",1140],["T_WHITESPACE"," ",1140],"=",["T_WHITESPACE"," ",1140],["T_VARIABLE","$this",1140],["T_OBJECT_OPERATOR","->",1140],["T_STRING","port",1140],";",["T_WHITESPACE","\n\t\t",1140],"}",["T_WHITESPACE","\n\n\t\t",1141],["T_VARIABLE","$this",1143],["T_OBJECT_OPERATOR","->",1143],["T_STRING","status",1143],["T_WHITESPACE"," ",1143],"=",["T_WHITESPACE"," ",1143],["T_LNUMBER","0",1143],";",["T_WHITESPACE","\n\n\t\t",1143],["T_IF","if",1145],"(",["T_VARIABLE","$fp",1145],["T_WHITESPACE"," ",1145],"=",["T_WHITESPACE"," ",1145],["T_STRING","fsockopen",1145],"(",["T_WHITESPACE","\n\t\t\t\t\t",1145],["T_VARIABLE","$host",1146],",",["T_WHITESPACE","\n\t\t\t\t\t",1146],["T_VARIABLE","$port",1147],",",["T_WHITESPACE","\n\t\t\t\t\t",1147],["T_VARIABLE","$errno",1148],",",["T_WHITESPACE","\n\t\t\t\t\t",1148],["T_VARIABLE","$errstr",1149],",",["T_WHITESPACE","\n\t\t\t\t\t",1149],["T_VARIABLE","$this",1150],["T_OBJECT_OPERATOR","->",1150],["T_STRING","_fp_timeout",1150],["T_WHITESPACE","\n\t\t\t\t\t",1150],")",")",["T_WHITESPACE","\n\t\t",1151],"{",["T_WHITESPACE","\n\t\t\t",1152],["T_COMMENT","\/\/ socket connection succeeded\n",1153],["T_WHITESPACE","\n\t\t\t",1154],["T_RETURN","return",1155],["T_WHITESPACE"," ",1155],["T_STRING","true",1155],";",["T_WHITESPACE","\n\t\t",1155],"}",["T_WHITESPACE","\n\t\t",1156],["T_ELSE","else",1157],["T_WHITESPACE","\n\t\t",1157],"{",["T_WHITESPACE","\n\t\t\t",1158],["T_COMMENT","\/\/ socket connection failed\n",1159],["T_WHITESPACE","\t\t\t",1160],["T_VARIABLE","$this",1160],["T_OBJECT_OPERATOR","->",1160],["T_STRING","status",1160],["T_WHITESPACE"," ",1160],"=",["T_WHITESPACE"," ",1160],["T_VARIABLE","$errno",1160],";",["T_WHITESPACE","\n\t\t\t",1160],["T_SWITCH","switch",1161],"(",["T_VARIABLE","$errno",1161],")",["T_WHITESPACE","\n\t\t\t",1161],"{",["T_WHITESPACE","\n\t\t\t\t",1162],["T_CASE","case",1163],["T_WHITESPACE"," ",1163],"-",["T_LNUMBER","3",1163],":",["T_WHITESPACE","\n\t\t\t\t\t",1163],["T_VARIABLE","$this",1164],["T_OBJECT_OPERATOR","->",1164],["T_STRING","error",1164],"=",["T_CONSTANT_ENCAPSED_STRING","\"socket creation failed (-3)\"",1164],";",["T_WHITESPACE","\n\t\t\t\t",1164],["T_CASE","case",1165],["T_WHITESPACE"," ",1165],"-",["T_LNUMBER","4",1165],":",["T_WHITESPACE","\n\t\t\t\t\t",1165],["T_VARIABLE","$this",1166],["T_OBJECT_OPERATOR","->",1166],["T_STRING","error",1166],"=",["T_CONSTANT_ENCAPSED_STRING","\"dns lookup failure (-4)\"",1166],";",["T_WHITESPACE","\n\t\t\t\t",1166],["T_CASE","case",1167],["T_WHITESPACE"," ",1167],"-",["T_LNUMBER","5",1167],":",["T_WHITESPACE","\n\t\t\t\t\t",1167],["T_VARIABLE","$this",1168],["T_OBJECT_OPERATOR","->",1168],["T_STRING","error",1168],"=",["T_CONSTANT_ENCAPSED_STRING","\"connection refused or timed out (-5)\"",1168],";",["T_WHITESPACE","\n\t\t\t\t",1168],["T_DEFAULT","default",1169],":",["T_WHITESPACE","\n\t\t\t\t\t",1169],["T_VARIABLE","$this",1170],["T_OBJECT_OPERATOR","->",1170],["T_STRING","error",1170],"=",["T_CONSTANT_ENCAPSED_STRING","\"connection failed (\"",1170],".",["T_VARIABLE","$errno",1170],".",["T_CONSTANT_ENCAPSED_STRING","\")\"",1170],";",["T_WHITESPACE","\n\t\t\t",1170],"}",["T_WHITESPACE","\n\t\t\t",1171],["T_RETURN","return",1172],["T_WHITESPACE"," ",1172],["T_STRING","false",1172],";",["T_WHITESPACE","\n\t\t",1172],"}",["T_WHITESPACE","\n\t",1173],"}",["T_WHITESPACE","\n",1174],["T_COMMENT","\/*======================================================================*\\\n\tFunction:\t_disconnect\n\tPurpose:\tdisconnect a socket connection\n\tInput:\t\t$fp\tfile pointer\n\\*======================================================================*\/",1175],["T_WHITESPACE","\n\n\t",1179],["T_FUNCTION","function",1181],["T_WHITESPACE"," ",1181],["T_STRING","_disconnect",1181],"(",["T_VARIABLE","$fp",1181],")",["T_WHITESPACE","\n\t",1181],"{",["T_WHITESPACE","\n\t\t",1182],["T_RETURN","return",1183],"(",["T_STRING","fclose",1183],"(",["T_VARIABLE","$fp",1183],")",")",";",["T_WHITESPACE","\n\t",1183],"}",["T_WHITESPACE","\n\n\n",1184],["T_COMMENT","\/*======================================================================*\\\n\tFunction:\t_prepare_post_body\n\tPurpose:\tPrepare post body according to encoding type\n\tInput:\t\t$formvars  - form variables\n\t\t\t\t$formfiles - form upload files\n\tOutput:\t\tpost body\n\\*======================================================================*\/",1187],["T_WHITESPACE","\n\n\t",1193],["T_FUNCTION","function",1195],["T_WHITESPACE"," ",1195],["T_STRING","_prepare_post_body",1195],"(",["T_VARIABLE","$formvars",1195],",",["T_WHITESPACE"," ",1195],["T_VARIABLE","$formfiles",1195],")",["T_WHITESPACE","\n\t",1195],"{",["T_WHITESPACE","\n\t\t",1196],["T_STRING","settype",1197],"(",["T_VARIABLE","$formvars",1197],",",["T_WHITESPACE"," ",1197],["T_CONSTANT_ENCAPSED_STRING","\"array\"",1197],")",";",["T_WHITESPACE","\n\t\t",1197],["T_STRING","settype",1198],"(",["T_VARIABLE","$formfiles",1198],",",["T_WHITESPACE"," ",1198],["T_CONSTANT_ENCAPSED_STRING","\"array\"",1198],")",";",["T_WHITESPACE","\n\t\t",1198],["T_VARIABLE","$postdata",1199],["T_WHITESPACE"," ",1199],"=",["T_WHITESPACE"," ",1199],["T_CONSTANT_ENCAPSED_STRING","''",1199],";",["T_WHITESPACE","\n\n\t\t",1199],["T_IF","if",1201],["T_WHITESPACE"," ",1201],"(",["T_STRING","count",1201],"(",["T_VARIABLE","$formvars",1201],")",["T_WHITESPACE"," ",1201],["T_IS_EQUAL","==",1201],["T_WHITESPACE"," ",1201],["T_LNUMBER","0",1201],["T_WHITESPACE"," ",1201],["T_BOOLEAN_AND","&&",1201],["T_WHITESPACE"," ",1201],["T_STRING","count",1201],"(",["T_VARIABLE","$formfiles",1201],")",["T_WHITESPACE"," ",1201],["T_IS_EQUAL","==",1201],["T_WHITESPACE"," ",1201],["T_LNUMBER","0",1201],")",["T_WHITESPACE","\n\t\t\t",1201],["T_RETURN","return",1202],";",["T_WHITESPACE","\n\n\t\t",1202],["T_SWITCH","switch",1204],["T_WHITESPACE"," ",1204],"(",["T_VARIABLE","$this",1204],["T_OBJECT_OPERATOR","->",1204],["T_STRING","_submit_type",1204],")",["T_WHITESPACE"," ",1204],"{",["T_WHITESPACE","\n\t\t\t",1204],["T_CASE","case",1205],["T_WHITESPACE"," ",1205],["T_CONSTANT_ENCAPSED_STRING","\"application\/x-www-form-urlencoded\"",1205],":",["T_WHITESPACE","\n\t\t\t\t",1205],["T_STRING","reset",1206],"(",["T_VARIABLE","$formvars",1206],")",";",["T_WHITESPACE","\n\t\t\t\t",1206],["T_WHILE","while",1207],"(",["T_LIST","list",1207],"(",["T_VARIABLE","$key",1207],",",["T_VARIABLE","$val",1207],")",["T_WHITESPACE"," ",1207],"=",["T_WHITESPACE"," ",1207],["T_STRING","each",1207],"(",["T_VARIABLE","$formvars",1207],")",")",["T_WHITESPACE"," ",1207],"{",["T_WHITESPACE","\n\t\t\t\t\t",1207],["T_IF","if",1208],["T_WHITESPACE"," ",1208],"(",["T_STRING","is_array",1208],"(",["T_VARIABLE","$val",1208],")",["T_WHITESPACE"," ",1208],["T_BOOLEAN_OR","||",1208],["T_WHITESPACE"," ",1208],["T_STRING","is_object",1208],"(",["T_VARIABLE","$val",1208],")",")",["T_WHITESPACE"," ",1208],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",1208],["T_WHILE","while",1209],["T_WHITESPACE"," ",1209],"(",["T_LIST","list",1209],"(",["T_VARIABLE","$cur_key",1209],",",["T_WHITESPACE"," ",1209],["T_VARIABLE","$cur_val",1209],")",["T_WHITESPACE"," ",1209],"=",["T_WHITESPACE"," ",1209],["T_STRING","each",1209],"(",["T_VARIABLE","$val",1209],")",")",["T_WHITESPACE"," ",1209],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",1209],["T_VARIABLE","$postdata",1210],["T_WHITESPACE"," ",1210],["T_CONCAT_EQUAL",".=",1210],["T_WHITESPACE"," ",1210],["T_STRING","urlencode",1210],"(",["T_VARIABLE","$key",1210],")",".",["T_CONSTANT_ENCAPSED_STRING","\"[]=\"",1210],".",["T_STRING","urlencode",1210],"(",["T_VARIABLE","$cur_val",1210],")",".",["T_CONSTANT_ENCAPSED_STRING","\"&\"",1210],";",["T_WHITESPACE","\n\t\t\t\t\t\t",1210],"}",["T_WHITESPACE","\n\t\t\t\t\t",1211],"}",["T_WHITESPACE"," ",1212],["T_ELSE","else",1212],["T_WHITESPACE","\n\t\t\t\t\t\t",1212],["T_VARIABLE","$postdata",1213],["T_WHITESPACE"," ",1213],["T_CONCAT_EQUAL",".=",1213],["T_WHITESPACE"," ",1213],["T_STRING","urlencode",1213],"(",["T_VARIABLE","$key",1213],")",".",["T_CONSTANT_ENCAPSED_STRING","\"=\"",1213],".",["T_STRING","urlencode",1213],"(",["T_VARIABLE","$val",1213],")",".",["T_CONSTANT_ENCAPSED_STRING","\"&\"",1213],";",["T_WHITESPACE","\n\t\t\t\t",1213],"}",["T_WHITESPACE","\n\t\t\t\t",1214],["T_BREAK","break",1215],";",["T_WHITESPACE","\n\n\t\t\t",1215],["T_CASE","case",1217],["T_WHITESPACE"," ",1217],["T_CONSTANT_ENCAPSED_STRING","\"multipart\/form-data\"",1217],":",["T_WHITESPACE","\n\t\t\t\t",1217],["T_VARIABLE","$this",1218],["T_OBJECT_OPERATOR","->",1218],["T_STRING","_mime_boundary",1218],["T_WHITESPACE"," ",1218],"=",["T_WHITESPACE"," ",1218],["T_CONSTANT_ENCAPSED_STRING","\"Snoopy\"",1218],".",["T_STRING","md5",1218],"(",["T_STRING","uniqid",1218],"(",["T_STRING","microtime",1218],"(",")",")",")",";",["T_WHITESPACE","\n\n\t\t\t\t",1218],["T_STRING","reset",1220],"(",["T_VARIABLE","$formvars",1220],")",";",["T_WHITESPACE","\n\t\t\t\t",1220],["T_WHILE","while",1221],"(",["T_LIST","list",1221],"(",["T_VARIABLE","$key",1221],",",["T_VARIABLE","$val",1221],")",["T_WHITESPACE"," ",1221],"=",["T_WHITESPACE"," ",1221],["T_STRING","each",1221],"(",["T_VARIABLE","$formvars",1221],")",")",["T_WHITESPACE"," ",1221],"{",["T_WHITESPACE","\n\t\t\t\t\t",1221],["T_IF","if",1222],["T_WHITESPACE"," ",1222],"(",["T_STRING","is_array",1222],"(",["T_VARIABLE","$val",1222],")",["T_WHITESPACE"," ",1222],["T_BOOLEAN_OR","||",1222],["T_WHITESPACE"," ",1222],["T_STRING","is_object",1222],"(",["T_VARIABLE","$val",1222],")",")",["T_WHITESPACE"," ",1222],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",1222],["T_WHILE","while",1223],["T_WHITESPACE"," ",1223],"(",["T_LIST","list",1223],"(",["T_VARIABLE","$cur_key",1223],",",["T_WHITESPACE"," ",1223],["T_VARIABLE","$cur_val",1223],")",["T_WHITESPACE"," ",1223],"=",["T_WHITESPACE"," ",1223],["T_STRING","each",1223],"(",["T_VARIABLE","$val",1223],")",")",["T_WHITESPACE"," ",1223],"{",["T_WHITESPACE","\n\t\t\t\t\t\t\t",1223],["T_VARIABLE","$postdata",1224],["T_WHITESPACE"," ",1224],["T_CONCAT_EQUAL",".=",1224],["T_WHITESPACE"," ",1224],["T_CONSTANT_ENCAPSED_STRING","\"--\"",1224],".",["T_VARIABLE","$this",1224],["T_OBJECT_OPERATOR","->",1224],["T_STRING","_mime_boundary",1224],".",["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",1224],";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",1224],["T_VARIABLE","$postdata",1225],["T_WHITESPACE"," ",1225],["T_CONCAT_EQUAL",".=",1225],["T_WHITESPACE"," ",1225],"\"",["T_ENCAPSED_AND_WHITESPACE","Content-Disposition: form-data; name=\\\"",1225],["T_VARIABLE","$key",1225],["T_ENCAPSED_AND_WHITESPACE","\\[\\]\\\"\\r\\n\\r\\n",1225],"\"",";",["T_WHITESPACE","\n\t\t\t\t\t\t\t",1225],["T_VARIABLE","$postdata",1226],["T_WHITESPACE"," ",1226],["T_CONCAT_EQUAL",".=",1226],["T_WHITESPACE"," ",1226],"\"",["T_VARIABLE","$cur_val",1226],["T_ENCAPSED_AND_WHITESPACE","\\r\\n",1226],"\"",";",["T_WHITESPACE","\n\t\t\t\t\t\t",1226],"}",["T_WHITESPACE","\n\t\t\t\t\t",1227],"}",["T_WHITESPACE"," ",1228],["T_ELSE","else",1228],["T_WHITESPACE"," ",1228],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",1228],["T_VARIABLE","$postdata",1229],["T_WHITESPACE"," ",1229],["T_CONCAT_EQUAL",".=",1229],["T_WHITESPACE"," ",1229],["T_CONSTANT_ENCAPSED_STRING","\"--\"",1229],".",["T_VARIABLE","$this",1229],["T_OBJECT_OPERATOR","->",1229],["T_STRING","_mime_boundary",1229],".",["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",1229],";",["T_WHITESPACE","\n\t\t\t\t\t\t",1229],["T_VARIABLE","$postdata",1230],["T_WHITESPACE"," ",1230],["T_CONCAT_EQUAL",".=",1230],["T_WHITESPACE"," ",1230],"\"",["T_ENCAPSED_AND_WHITESPACE","Content-Disposition: form-data; name=\\\"",1230],["T_VARIABLE","$key",1230],["T_ENCAPSED_AND_WHITESPACE","\\\"\\r\\n\\r\\n",1230],"\"",";",["T_WHITESPACE","\n\t\t\t\t\t\t",1230],["T_VARIABLE","$postdata",1231],["T_WHITESPACE"," ",1231],["T_CONCAT_EQUAL",".=",1231],["T_WHITESPACE"," ",1231],"\"",["T_VARIABLE","$val",1231],["T_ENCAPSED_AND_WHITESPACE","\\r\\n",1231],"\"",";",["T_WHITESPACE","\n\t\t\t\t\t",1231],"}",["T_WHITESPACE","\n\t\t\t\t",1232],"}",["T_WHITESPACE","\n\n\t\t\t\t",1233],["T_STRING","reset",1235],"(",["T_VARIABLE","$formfiles",1235],")",";",["T_WHITESPACE","\n\t\t\t\t",1235],["T_WHILE","while",1236],["T_WHITESPACE"," ",1236],"(",["T_LIST","list",1236],"(",["T_VARIABLE","$field_name",1236],",",["T_WHITESPACE"," ",1236],["T_VARIABLE","$file_names",1236],")",["T_WHITESPACE"," ",1236],"=",["T_WHITESPACE"," ",1236],["T_STRING","each",1236],"(",["T_VARIABLE","$formfiles",1236],")",")",["T_WHITESPACE"," ",1236],"{",["T_WHITESPACE","\n\t\t\t\t\t",1236],["T_STRING","settype",1237],"(",["T_VARIABLE","$file_names",1237],",",["T_WHITESPACE"," ",1237],["T_CONSTANT_ENCAPSED_STRING","\"array\"",1237],")",";",["T_WHITESPACE","\n\t\t\t\t\t",1237],["T_WHILE","while",1238],["T_WHITESPACE"," ",1238],"(",["T_LIST","list",1238],"(",",",["T_WHITESPACE"," ",1238],["T_VARIABLE","$file_name",1238],")",["T_WHITESPACE"," ",1238],"=",["T_WHITESPACE"," ",1238],["T_STRING","each",1238],"(",["T_VARIABLE","$file_names",1238],")",")",["T_WHITESPACE"," ",1238],"{",["T_WHITESPACE","\n\t\t\t\t\t\t",1238],["T_IF","if",1239],["T_WHITESPACE"," ",1239],"(","!",["T_STRING","is_readable",1239],"(",["T_VARIABLE","$file_name",1239],")",")",["T_WHITESPACE"," ",1239],["T_CONTINUE","continue",1239],";",["T_WHITESPACE","\n\n\t\t\t\t\t\t",1239],["T_VARIABLE","$fp",1241],["T_WHITESPACE"," ",1241],"=",["T_WHITESPACE"," ",1241],["T_STRING","fopen",1241],"(",["T_VARIABLE","$file_name",1241],",",["T_WHITESPACE"," ",1241],["T_CONSTANT_ENCAPSED_STRING","\"r\"",1241],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t",1241],["T_VARIABLE","$file_content",1242],["T_WHITESPACE"," ",1242],"=",["T_WHITESPACE"," ",1242],["T_STRING","fread",1242],"(",["T_VARIABLE","$fp",1242],",",["T_WHITESPACE"," ",1242],["T_STRING","filesize",1242],"(",["T_VARIABLE","$file_name",1242],")",")",";",["T_WHITESPACE","\n\t\t\t\t\t\t",1242],["T_STRING","fclose",1243],"(",["T_VARIABLE","$fp",1243],")",";",["T_WHITESPACE","\n\t\t\t\t\t\t",1243],["T_VARIABLE","$base_name",1244],["T_WHITESPACE"," ",1244],"=",["T_WHITESPACE"," ",1244],["T_STRING","basename",1244],"(",["T_VARIABLE","$file_name",1244],")",";",["T_WHITESPACE","\n\n\t\t\t\t\t\t",1244],["T_VARIABLE","$postdata",1246],["T_WHITESPACE"," ",1246],["T_CONCAT_EQUAL",".=",1246],["T_WHITESPACE"," ",1246],["T_CONSTANT_ENCAPSED_STRING","\"--\"",1246],".",["T_VARIABLE","$this",1246],["T_OBJECT_OPERATOR","->",1246],["T_STRING","_mime_boundary",1246],".",["T_CONSTANT_ENCAPSED_STRING","\"\\r\\n\"",1246],";",["T_WHITESPACE","\n\t\t\t\t\t\t",1246],["T_VARIABLE","$postdata",1247],["T_WHITESPACE"," ",1247],["T_CONCAT_EQUAL",".=",1247],["T_WHITESPACE"," ",1247],"\"",["T_ENCAPSED_AND_WHITESPACE","Content-Disposition: form-data; name=\\\"",1247],["T_VARIABLE","$field_name",1247],["T_ENCAPSED_AND_WHITESPACE","\\\"; filename=\\\"",1247],["T_VARIABLE","$base_name",1247],["T_ENCAPSED_AND_WHITESPACE","\\\"\\r\\n\\r\\n",1247],"\"",";",["T_WHITESPACE","\n\t\t\t\t\t\t",1247],["T_VARIABLE","$postdata",1248],["T_WHITESPACE"," ",1248],["T_CONCAT_EQUAL",".=",1248],["T_WHITESPACE"," ",1248],"\"",["T_VARIABLE","$file_content",1248],["T_ENCAPSED_AND_WHITESPACE","\\r\\n",1248],"\"",";",["T_WHITESPACE","\n\t\t\t\t\t",1248],"}",["T_WHITESPACE","\n\t\t\t\t",1249],"}",["T_WHITESPACE","\n\t\t\t\t",1250],["T_VARIABLE","$postdata",1251],["T_WHITESPACE"," ",1251],["T_CONCAT_EQUAL",".=",1251],["T_WHITESPACE"," ",1251],["T_CONSTANT_ENCAPSED_STRING","\"--\"",1251],".",["T_VARIABLE","$this",1251],["T_OBJECT_OPERATOR","->",1251],["T_STRING","_mime_boundary",1251],".",["T_CONSTANT_ENCAPSED_STRING","\"--\\r\\n\"",1251],";",["T_WHITESPACE","\n\t\t\t\t",1251],["T_BREAK","break",1252],";",["T_WHITESPACE","\n\t\t",1252],"}",["T_WHITESPACE","\n\n\t\t",1253],["T_RETURN","return",1255],["T_WHITESPACE"," ",1255],["T_VARIABLE","$postdata",1255],";",["T_WHITESPACE","\n\t",1255],"}",["T_WHITESPACE","\n",1256],"}",["T_WHITESPACE","\n",1257],["T_ENDIF","endif",1258],";",["T_WHITESPACE","\n",1258],["T_CLOSE_TAG","?>\n",1259]]