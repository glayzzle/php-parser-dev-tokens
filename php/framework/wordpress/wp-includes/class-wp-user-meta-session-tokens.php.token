[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Session API: WP_User_Meta_Session_Tokens class\n *\n * @package WordPress\n * @subpackage Session\n * @since 4.7.0\n *\/",2],["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * Meta-based user sessions token manager.\n *\n * @since 4.0.0\n *\/",10],["T_WHITESPACE","\n",14],["T_CLASS","class",15],["T_WHITESPACE"," ",15],["T_STRING","WP_User_Meta_Session_Tokens",15],["T_WHITESPACE"," ",15],["T_EXTENDS","extends",15],["T_WHITESPACE"," ",15],["T_STRING","WP_Session_Tokens",15],["T_WHITESPACE"," ",15],"{",["T_WHITESPACE","\n\n\t",15],["T_DOC_COMMENT","\/**\n\t * Get all sessions of a user.\n\t *\n\t * @since 4.0.0\n\t * @access protected\n\t *\n\t * @return array Sessions of a user.\n\t *\/",17],["T_WHITESPACE","\n\t",24],["T_PROTECTED","protected",25],["T_WHITESPACE"," ",25],["T_FUNCTION","function",25],["T_WHITESPACE"," ",25],["T_STRING","get_sessions",25],"(",")",["T_WHITESPACE"," ",25],"{",["T_WHITESPACE","\n\t\t",25],["T_VARIABLE","$sessions",26],["T_WHITESPACE"," ",26],"=",["T_WHITESPACE"," ",26],["T_STRING","get_user_meta",26],"(",["T_WHITESPACE"," ",26],["T_VARIABLE","$this",26],["T_OBJECT_OPERATOR","->",26],["T_STRING","user_id",26],",",["T_WHITESPACE"," ",26],["T_CONSTANT_ENCAPSED_STRING","'session_tokens'",26],",",["T_WHITESPACE"," ",26],["T_STRING","true",26],["T_WHITESPACE"," ",26],")",";",["T_WHITESPACE","\n\n\t\t",26],["T_IF","if",28],["T_WHITESPACE"," ",28],"(",["T_WHITESPACE"," ",28],"!",["T_WHITESPACE"," ",28],["T_STRING","is_array",28],"(",["T_WHITESPACE"," ",28],["T_VARIABLE","$sessions",28],["T_WHITESPACE"," ",28],")",["T_WHITESPACE"," ",28],")",["T_WHITESPACE"," ",28],"{",["T_WHITESPACE","\n\t\t\t",28],["T_RETURN","return",29],["T_WHITESPACE"," ",29],["T_ARRAY","array",29],"(",")",";",["T_WHITESPACE","\n\t\t",29],"}",["T_WHITESPACE","\n\n\t\t",30],["T_VARIABLE","$sessions",32],["T_WHITESPACE"," ",32],"=",["T_WHITESPACE"," ",32],["T_STRING","array_map",32],"(",["T_WHITESPACE"," ",32],["T_ARRAY","array",32],"(",["T_WHITESPACE"," ",32],["T_VARIABLE","$this",32],",",["T_WHITESPACE"," ",32],["T_CONSTANT_ENCAPSED_STRING","'prepare_session'",32],["T_WHITESPACE"," ",32],")",",",["T_WHITESPACE"," ",32],["T_VARIABLE","$sessions",32],["T_WHITESPACE"," ",32],")",";",["T_WHITESPACE","\n\t\t",32],["T_RETURN","return",33],["T_WHITESPACE"," ",33],["T_STRING","array_filter",33],"(",["T_WHITESPACE"," ",33],["T_VARIABLE","$sessions",33],",",["T_WHITESPACE"," ",33],["T_ARRAY","array",33],"(",["T_WHITESPACE"," ",33],["T_VARIABLE","$this",33],",",["T_WHITESPACE"," ",33],["T_CONSTANT_ENCAPSED_STRING","'is_still_valid'",33],["T_WHITESPACE"," ",33],")",["T_WHITESPACE"," ",33],")",";",["T_WHITESPACE","\n\t",33],"}",["T_WHITESPACE","\n\n\t",34],["T_DOC_COMMENT","\/**\n\t * Converts an expiration to an array of session information.\n\t *\n\t * @param mixed $session Session or expiration.\n\t * @return array Session.\n\t *\/",36],["T_WHITESPACE","\n\t",41],["T_PROTECTED","protected",42],["T_WHITESPACE"," ",42],["T_FUNCTION","function",42],["T_WHITESPACE"," ",42],["T_STRING","prepare_session",42],"(",["T_WHITESPACE"," ",42],["T_VARIABLE","$session",42],["T_WHITESPACE"," ",42],")",["T_WHITESPACE"," ",42],"{",["T_WHITESPACE","\n\t\t",42],["T_IF","if",43],["T_WHITESPACE"," ",43],"(",["T_WHITESPACE"," ",43],["T_STRING","is_int",43],"(",["T_WHITESPACE"," ",43],["T_VARIABLE","$session",43],["T_WHITESPACE"," ",43],")",["T_WHITESPACE"," ",43],")",["T_WHITESPACE"," ",43],"{",["T_WHITESPACE","\n\t\t\t",43],["T_RETURN","return",44],["T_WHITESPACE"," ",44],["T_ARRAY","array",44],"(",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'expiration'",44],["T_WHITESPACE"," ",44],["T_DOUBLE_ARROW","=>",44],["T_WHITESPACE"," ",44],["T_VARIABLE","$session",44],["T_WHITESPACE"," ",44],")",";",["T_WHITESPACE","\n\t\t",44],"}",["T_WHITESPACE","\n\n\t\t",45],["T_RETURN","return",47],["T_WHITESPACE"," ",47],["T_VARIABLE","$session",47],";",["T_WHITESPACE","\n\t",47],"}",["T_WHITESPACE","\n\n\t",48],["T_DOC_COMMENT","\/**\n\t * Retrieve a session by its verifier (token hash).\n\t *\n\t * @since 4.0.0\n\t * @access protected\n\t *\n\t * @param string $verifier Verifier of the session to retrieve.\n\t * @return array|null The session, or null if it does not exist\n\t *\/",50],["T_WHITESPACE","\n\t",58],["T_PROTECTED","protected",59],["T_WHITESPACE"," ",59],["T_FUNCTION","function",59],["T_WHITESPACE"," ",59],["T_STRING","get_session",59],"(",["T_WHITESPACE"," ",59],["T_VARIABLE","$verifier",59],["T_WHITESPACE"," ",59],")",["T_WHITESPACE"," ",59],"{",["T_WHITESPACE","\n\t\t",59],["T_VARIABLE","$sessions",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_VARIABLE","$this",60],["T_OBJECT_OPERATOR","->",60],["T_STRING","get_sessions",60],"(",")",";",["T_WHITESPACE","\n\n\t\t",60],["T_IF","if",62],["T_WHITESPACE"," ",62],"(",["T_WHITESPACE"," ",62],["T_ISSET","isset",62],"(",["T_WHITESPACE"," ",62],["T_VARIABLE","$sessions",62],"[",["T_WHITESPACE"," ",62],["T_VARIABLE","$verifier",62],["T_WHITESPACE"," ",62],"]",["T_WHITESPACE"," ",62],")",["T_WHITESPACE"," ",62],")",["T_WHITESPACE"," ",62],"{",["T_WHITESPACE","\n\t\t\t",62],["T_RETURN","return",63],["T_WHITESPACE"," ",63],["T_VARIABLE","$sessions",63],"[",["T_WHITESPACE"," ",63],["T_VARIABLE","$verifier",63],["T_WHITESPACE"," ",63],"]",";",["T_WHITESPACE","\n\t\t",63],"}",["T_WHITESPACE","\n\n\t\t",64],["T_RETURN","return",66],["T_WHITESPACE"," ",66],["T_STRING","null",66],";",["T_WHITESPACE","\n\t",66],"}",["T_WHITESPACE","\n\n\t",67],["T_DOC_COMMENT","\/**\n\t * Update a session by its verifier.\n\t *\n\t * @since 4.0.0\n\t * @access protected\n\t *\n\t * @param string $verifier Verifier of the session to update.\n\t * @param array  $session  Optional. Session. Omitting this argument destroys the session.\n\t *\/",69],["T_WHITESPACE","\n\t",77],["T_PROTECTED","protected",78],["T_WHITESPACE"," ",78],["T_FUNCTION","function",78],["T_WHITESPACE"," ",78],["T_STRING","update_session",78],"(",["T_WHITESPACE"," ",78],["T_VARIABLE","$verifier",78],",",["T_WHITESPACE"," ",78],["T_VARIABLE","$session",78],["T_WHITESPACE"," ",78],"=",["T_WHITESPACE"," ",78],["T_STRING","null",78],["T_WHITESPACE"," ",78],")",["T_WHITESPACE"," ",78],"{",["T_WHITESPACE","\n\t\t",78],["T_VARIABLE","$sessions",79],["T_WHITESPACE"," ",79],"=",["T_WHITESPACE"," ",79],["T_VARIABLE","$this",79],["T_OBJECT_OPERATOR","->",79],["T_STRING","get_sessions",79],"(",")",";",["T_WHITESPACE","\n\n\t\t",79],["T_IF","if",81],["T_WHITESPACE"," ",81],"(",["T_WHITESPACE"," ",81],["T_VARIABLE","$session",81],["T_WHITESPACE"," ",81],")",["T_WHITESPACE"," ",81],"{",["T_WHITESPACE","\n\t\t\t",81],["T_VARIABLE","$sessions",82],"[",["T_WHITESPACE"," ",82],["T_VARIABLE","$verifier",82],["T_WHITESPACE"," ",82],"]",["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_VARIABLE","$session",82],";",["T_WHITESPACE","\n\t\t",82],"}",["T_WHITESPACE"," ",83],["T_ELSE","else",83],["T_WHITESPACE"," ",83],"{",["T_WHITESPACE","\n\t\t\t",83],["T_UNSET","unset",84],"(",["T_WHITESPACE"," ",84],["T_VARIABLE","$sessions",84],"[",["T_WHITESPACE"," ",84],["T_VARIABLE","$verifier",84],["T_WHITESPACE"," ",84],"]",["T_WHITESPACE"," ",84],")",";",["T_WHITESPACE","\n\t\t",84],"}",["T_WHITESPACE","\n\n\t\t",85],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","update_sessions",87],"(",["T_WHITESPACE"," ",87],["T_VARIABLE","$sessions",87],["T_WHITESPACE"," ",87],")",";",["T_WHITESPACE","\n\t",87],"}",["T_WHITESPACE","\n\n\t",88],["T_DOC_COMMENT","\/**\n\t * Update a user's sessions in the usermeta table.\n\t *\n\t * @since 4.0.0\n\t * @access protected\n\t *\n\t * @param array $sessions Sessions.\n\t *\/",90],["T_WHITESPACE","\n\t",97],["T_PROTECTED","protected",98],["T_WHITESPACE"," ",98],["T_FUNCTION","function",98],["T_WHITESPACE"," ",98],["T_STRING","update_sessions",98],"(",["T_WHITESPACE"," ",98],["T_VARIABLE","$sessions",98],["T_WHITESPACE"," ",98],")",["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n\t\t",98],["T_IF","if",99],["T_WHITESPACE"," ",99],"(",["T_WHITESPACE"," ",99],["T_VARIABLE","$sessions",99],["T_WHITESPACE"," ",99],")",["T_WHITESPACE"," ",99],"{",["T_WHITESPACE","\n\t\t\t",99],["T_STRING","update_user_meta",100],"(",["T_WHITESPACE"," ",100],["T_VARIABLE","$this",100],["T_OBJECT_OPERATOR","->",100],["T_STRING","user_id",100],",",["T_WHITESPACE"," ",100],["T_CONSTANT_ENCAPSED_STRING","'session_tokens'",100],",",["T_WHITESPACE"," ",100],["T_VARIABLE","$sessions",100],["T_WHITESPACE"," ",100],")",";",["T_WHITESPACE","\n\t\t",100],"}",["T_WHITESPACE"," ",101],["T_ELSE","else",101],["T_WHITESPACE"," ",101],"{",["T_WHITESPACE","\n\t\t\t",101],["T_STRING","delete_user_meta",102],"(",["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","user_id",102],",",["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'session_tokens'",102],["T_WHITESPACE"," ",102],")",";",["T_WHITESPACE","\n\t\t",102],"}",["T_WHITESPACE","\n\t",103],"}",["T_WHITESPACE","\n\n\t",104],["T_DOC_COMMENT","\/**\n\t * Destroy all session tokens for a user, except a single session passed.\n\t *\n\t * @since 4.0.0\n\t * @access protected\n\t *\n\t * @param string $verifier Verifier of the session to keep.\n\t *\/",106],["T_WHITESPACE","\n\t",113],["T_PROTECTED","protected",114],["T_WHITESPACE"," ",114],["T_FUNCTION","function",114],["T_WHITESPACE"," ",114],["T_STRING","destroy_other_sessions",114],"(",["T_WHITESPACE"," ",114],["T_VARIABLE","$verifier",114],["T_WHITESPACE"," ",114],")",["T_WHITESPACE"," ",114],"{",["T_WHITESPACE","\n\t\t",114],["T_VARIABLE","$session",115],["T_WHITESPACE"," ",115],"=",["T_WHITESPACE"," ",115],["T_VARIABLE","$this",115],["T_OBJECT_OPERATOR","->",115],["T_STRING","get_session",115],"(",["T_WHITESPACE"," ",115],["T_VARIABLE","$verifier",115],["T_WHITESPACE"," ",115],")",";",["T_WHITESPACE","\n\t\t",115],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","update_sessions",116],"(",["T_WHITESPACE"," ",116],["T_ARRAY","array",116],"(",["T_WHITESPACE"," ",116],["T_VARIABLE","$verifier",116],["T_WHITESPACE"," ",116],["T_DOUBLE_ARROW","=>",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$session",116],["T_WHITESPACE"," ",116],")",["T_WHITESPACE"," ",116],")",";",["T_WHITESPACE","\n\t",116],"}",["T_WHITESPACE","\n\n\t",117],["T_DOC_COMMENT","\/**\n\t * Destroy all session tokens for a user.\n\t *\n\t * @since 4.0.0\n\t * @access protected\n\t *\/",119],["T_WHITESPACE","\n\t",124],["T_PROTECTED","protected",125],["T_WHITESPACE"," ",125],["T_FUNCTION","function",125],["T_WHITESPACE"," ",125],["T_STRING","destroy_all_sessions",125],"(",")",["T_WHITESPACE"," ",125],"{",["T_WHITESPACE","\n\t\t",125],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","update_sessions",126],"(",["T_WHITESPACE"," ",126],["T_ARRAY","array",126],"(",")",["T_WHITESPACE"," ",126],")",";",["T_WHITESPACE","\n\t",126],"}",["T_WHITESPACE","\n\n\t",127],["T_DOC_COMMENT","\/**\n\t * Destroy all session tokens for all users.\n\t *\n\t * @since 4.0.0\n\t * @access public\n\t * @static\n\t *\/",129],["T_WHITESPACE","\n\t",135],["T_PUBLIC","public",136],["T_WHITESPACE"," ",136],["T_STATIC","static",136],["T_WHITESPACE"," ",136],["T_FUNCTION","function",136],["T_WHITESPACE"," ",136],["T_STRING","drop_sessions",136],"(",")",["T_WHITESPACE"," ",136],"{",["T_WHITESPACE","\n\t\t",136],["T_STRING","delete_metadata",137],"(",["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'user'",137],",",["T_WHITESPACE"," ",137],["T_LNUMBER","0",137],",",["T_WHITESPACE"," ",137],["T_CONSTANT_ENCAPSED_STRING","'session_tokens'",137],",",["T_WHITESPACE"," ",137],["T_STRING","false",137],",",["T_WHITESPACE"," ",137],["T_STRING","true",137],["T_WHITESPACE"," ",137],")",";",["T_WHITESPACE","\n\t",137],"}",["T_WHITESPACE","\n",138],"}",["T_WHITESPACE","\n",139]]