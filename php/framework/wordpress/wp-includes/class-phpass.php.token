[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Portable PHP password hashing framework.\n * @package phpass\n * @since 2.5.0\n * @version 0.3 \/ WordPress\n * @link http:\/\/www.openwall.com\/phpass\/\n *\/",2],["T_WHITESPACE","\n\n",8],["T_COMMENT","#\n",10],["T_COMMENT","# Written by Solar Designer <solar at openwall.com> in 2004-2006 and placed in\n",11],["T_COMMENT","# the public domain.  Revised in subsequent years, still public domain.\n",12],["T_COMMENT","#\n",13],["T_COMMENT","# There's absolutely no warranty.\n",14],["T_COMMENT","#\n",15],["T_COMMENT","# Please be sure to update the Version line if you edit this file in any way.\n",16],["T_COMMENT","# It is suggested that you leave the main version number intact, but indicate\n",17],["T_COMMENT","# your project name (after the slash) and add your own revision information.\n",18],["T_COMMENT","#\n",19],["T_COMMENT","# Please do not change the \"private\" password hashing method implemented in\n",20],["T_COMMENT","# here, thereby making your hashes incompatible.  However, if you must, please\n",21],["T_COMMENT","# change the hash type identifier (the \"$P$\") to something different.\n",22],["T_COMMENT","#\n",23],["T_COMMENT","# Obviously, since this code is in the public domain, the above are not\n",24],["T_COMMENT","# requirements (there can be none), but merely suggestions.\n",25],["T_COMMENT","#\n",26],["T_WHITESPACE","\n",27],["T_DOC_COMMENT","\/**\n * Portable PHP password hashing framework.\n *\n * @package phpass\n * @version 0.3 \/ WordPress\n * @link http:\/\/www.openwall.com\/phpass\/\n * @since 2.5.0\n *\/",28],["T_WHITESPACE","\n",35],["T_CLASS","class",36],["T_WHITESPACE"," ",36],["T_STRING","PasswordHash",36],["T_WHITESPACE"," ",36],"{",["T_WHITESPACE","\n\t",36],["T_VAR","var",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$itoa64",37],";",["T_WHITESPACE","\n\t",37],["T_VAR","var",38],["T_WHITESPACE"," ",38],["T_VARIABLE","$iteration_count_log2",38],";",["T_WHITESPACE","\n\t",38],["T_VAR","var",39],["T_WHITESPACE"," ",39],["T_VARIABLE","$portable_hashes",39],";",["T_WHITESPACE","\n\t",39],["T_VAR","var",40],["T_WHITESPACE"," ",40],["T_VARIABLE","$random_state",40],";",["T_WHITESPACE","\n\n\t",40],["T_DOC_COMMENT","\/**\n\t * PHP5 constructor.\n\t *\/",42],["T_WHITESPACE","\n\t",44],["T_FUNCTION","function",45],["T_WHITESPACE"," ",45],["T_STRING","__construct",45],"(",["T_WHITESPACE"," ",45],["T_VARIABLE","$iteration_count_log2",45],",",["T_WHITESPACE"," ",45],["T_VARIABLE","$portable_hashes",45],["T_WHITESPACE"," ",45],")",["T_WHITESPACE","\n\t",45],"{",["T_WHITESPACE","\n\t\t",46],["T_VARIABLE","$this",47],["T_OBJECT_OPERATOR","->",47],["T_STRING","itoa64",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_CONSTANT_ENCAPSED_STRING","'.\/0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'",47],";",["T_WHITESPACE","\n\n\t\t",47],["T_IF","if",49],["T_WHITESPACE"," ",49],"(",["T_VARIABLE","$iteration_count_log2",49],["T_WHITESPACE"," ",49],"<",["T_WHITESPACE"," ",49],["T_LNUMBER","4",49],["T_WHITESPACE"," ",49],["T_BOOLEAN_OR","||",49],["T_WHITESPACE"," ",49],["T_VARIABLE","$iteration_count_log2",49],["T_WHITESPACE"," ",49],">",["T_WHITESPACE"," ",49],["T_LNUMBER","31",49],")",["T_WHITESPACE","\n\t\t\t",49],["T_VARIABLE","$iteration_count_log2",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_LNUMBER","8",50],";",["T_WHITESPACE","\n\t\t",50],["T_VARIABLE","$this",51],["T_OBJECT_OPERATOR","->",51],["T_STRING","iteration_count_log2",51],["T_WHITESPACE"," ",51],"=",["T_WHITESPACE"," ",51],["T_VARIABLE","$iteration_count_log2",51],";",["T_WHITESPACE","\n\n\t\t",51],["T_VARIABLE","$this",53],["T_OBJECT_OPERATOR","->",53],["T_STRING","portable_hashes",53],["T_WHITESPACE"," ",53],"=",["T_WHITESPACE"," ",53],["T_VARIABLE","$portable_hashes",53],";",["T_WHITESPACE","\n\n\t\t",53],["T_VARIABLE","$this",55],["T_OBJECT_OPERATOR","->",55],["T_STRING","random_state",55],["T_WHITESPACE"," ",55],"=",["T_WHITESPACE"," ",55],["T_STRING","microtime",55],"(",")",["T_WHITESPACE"," ",55],".",["T_WHITESPACE"," ",55],["T_STRING","uniqid",55],"(",["T_STRING","rand",55],"(",")",",",["T_WHITESPACE"," ",55],["T_STRING","TRUE",55],")",";",["T_WHITESPACE"," ",55],["T_COMMENT","\/\/ removed getmypid() for compatibility reasons\n",55],["T_WHITESPACE","\t",56],"}",["T_WHITESPACE","\n\n\t",56],["T_DOC_COMMENT","\/**\n\t * PHP4 constructor.\n\t *\/",58],["T_WHITESPACE","\n\t",60],["T_PUBLIC","public",61],["T_WHITESPACE"," ",61],["T_FUNCTION","function",61],["T_WHITESPACE"," ",61],["T_STRING","PasswordHash",61],"(",["T_WHITESPACE"," ",61],["T_VARIABLE","$iteration_count_log2",61],",",["T_WHITESPACE"," ",61],["T_VARIABLE","$portable_hashes",61],["T_WHITESPACE"," ",61],")",["T_WHITESPACE"," ",61],"{",["T_WHITESPACE","\n\t\t",61],["T_STRING","self",62],["T_DOUBLE_COLON","::",62],["T_STRING","__construct",62],"(",["T_WHITESPACE"," ",62],["T_VARIABLE","$iteration_count_log2",62],",",["T_WHITESPACE"," ",62],["T_VARIABLE","$portable_hashes",62],["T_WHITESPACE"," ",62],")",";",["T_WHITESPACE","\n\t",62],"}",["T_WHITESPACE","\n\n\t",63],["T_FUNCTION","function",65],["T_WHITESPACE"," ",65],["T_STRING","get_random_bytes",65],"(",["T_VARIABLE","$count",65],")",["T_WHITESPACE","\n\t",65],"{",["T_WHITESPACE","\n\t\t",66],["T_VARIABLE","$output",67],["T_WHITESPACE"," ",67],"=",["T_WHITESPACE"," ",67],["T_CONSTANT_ENCAPSED_STRING","''",67],";",["T_WHITESPACE","\n\t\t",67],["T_IF","if",68],["T_WHITESPACE"," ",68],"(",["T_WHITESPACE"," ",68],"@",["T_STRING","is_readable",68],"(",["T_CONSTANT_ENCAPSED_STRING","'\/dev\/urandom'",68],")",["T_WHITESPACE"," ",68],["T_BOOLEAN_AND","&&",68],["T_WHITESPACE","\n\t\t    ",68],"(",["T_VARIABLE","$fh",69],["T_WHITESPACE"," ",69],"=",["T_WHITESPACE"," ",69],"@",["T_STRING","fopen",69],"(",["T_CONSTANT_ENCAPSED_STRING","'\/dev\/urandom'",69],",",["T_WHITESPACE"," ",69],["T_CONSTANT_ENCAPSED_STRING","'rb'",69],")",")",")",["T_WHITESPACE"," ",69],"{",["T_WHITESPACE","\n\t\t\t",69],["T_VARIABLE","$output",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_STRING","fread",70],"(",["T_VARIABLE","$fh",70],",",["T_WHITESPACE"," ",70],["T_VARIABLE","$count",70],")",";",["T_WHITESPACE","\n\t\t\t",70],["T_STRING","fclose",71],"(",["T_VARIABLE","$fh",71],")",";",["T_WHITESPACE","\n\t\t",71],"}",["T_WHITESPACE","\n\n\t\t",72],["T_IF","if",74],["T_WHITESPACE"," ",74],"(",["T_STRING","strlen",74],"(",["T_VARIABLE","$output",74],")",["T_WHITESPACE"," ",74],"<",["T_WHITESPACE"," ",74],["T_VARIABLE","$count",74],")",["T_WHITESPACE"," ",74],"{",["T_WHITESPACE","\n\t\t\t",74],["T_VARIABLE","$output",75],["T_WHITESPACE"," ",75],"=",["T_WHITESPACE"," ",75],["T_CONSTANT_ENCAPSED_STRING","''",75],";",["T_WHITESPACE","\n\t\t\t",75],["T_FOR","for",76],["T_WHITESPACE"," ",76],"(",["T_VARIABLE","$i",76],["T_WHITESPACE"," ",76],"=",["T_WHITESPACE"," ",76],["T_LNUMBER","0",76],";",["T_WHITESPACE"," ",76],["T_VARIABLE","$i",76],["T_WHITESPACE"," ",76],"<",["T_WHITESPACE"," ",76],["T_VARIABLE","$count",76],";",["T_WHITESPACE"," ",76],["T_VARIABLE","$i",76],["T_WHITESPACE"," ",76],["T_PLUS_EQUAL","+=",76],["T_WHITESPACE"," ",76],["T_LNUMBER","16",76],")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n\t\t\t\t",76],["T_VARIABLE","$this",77],["T_OBJECT_OPERATOR","->",77],["T_STRING","random_state",77],["T_WHITESPACE"," ",77],"=",["T_WHITESPACE","\n\t\t\t\t    ",77],["T_STRING","md5",78],"(",["T_STRING","microtime",78],"(",")",["T_WHITESPACE"," ",78],".",["T_WHITESPACE"," ",78],["T_VARIABLE","$this",78],["T_OBJECT_OPERATOR","->",78],["T_STRING","random_state",78],")",";",["T_WHITESPACE","\n\t\t\t\t",78],["T_VARIABLE","$output",79],["T_WHITESPACE"," ",79],["T_CONCAT_EQUAL",".=",79],["T_WHITESPACE","\n\t\t\t\t    ",79],["T_STRING","pack",80],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",80],",",["T_WHITESPACE"," ",80],["T_STRING","md5",80],"(",["T_VARIABLE","$this",80],["T_OBJECT_OPERATOR","->",80],["T_STRING","random_state",80],")",")",";",["T_WHITESPACE","\n\t\t\t",80],"}",["T_WHITESPACE","\n\t\t\t",81],["T_VARIABLE","$output",82],["T_WHITESPACE"," ",82],"=",["T_WHITESPACE"," ",82],["T_STRING","substr",82],"(",["T_VARIABLE","$output",82],",",["T_WHITESPACE"," ",82],["T_LNUMBER","0",82],",",["T_WHITESPACE"," ",82],["T_VARIABLE","$count",82],")",";",["T_WHITESPACE","\n\t\t",82],"}",["T_WHITESPACE","\n\n\t\t",83],["T_RETURN","return",85],["T_WHITESPACE"," ",85],["T_VARIABLE","$output",85],";",["T_WHITESPACE","\n\t",85],"}",["T_WHITESPACE","\n\n\t",86],["T_FUNCTION","function",88],["T_WHITESPACE"," ",88],["T_STRING","encode64",88],"(",["T_VARIABLE","$input",88],",",["T_WHITESPACE"," ",88],["T_VARIABLE","$count",88],")",["T_WHITESPACE","\n\t",88],"{",["T_WHITESPACE","\n\t\t",89],["T_VARIABLE","$output",90],["T_WHITESPACE"," ",90],"=",["T_WHITESPACE"," ",90],["T_CONSTANT_ENCAPSED_STRING","''",90],";",["T_WHITESPACE","\n\t\t",90],["T_VARIABLE","$i",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_LNUMBER","0",91],";",["T_WHITESPACE","\n\t\t",91],["T_DO","do",92],["T_WHITESPACE"," ",92],"{",["T_WHITESPACE","\n\t\t\t",92],["T_VARIABLE","$value",93],["T_WHITESPACE"," ",93],"=",["T_WHITESPACE"," ",93],["T_STRING","ord",93],"(",["T_VARIABLE","$input",93],"[",["T_VARIABLE","$i",93],["T_INC","++",93],"]",")",";",["T_WHITESPACE","\n\t\t\t",93],["T_VARIABLE","$output",94],["T_WHITESPACE"," ",94],["T_CONCAT_EQUAL",".=",94],["T_WHITESPACE"," ",94],["T_VARIABLE","$this",94],["T_OBJECT_OPERATOR","->",94],["T_STRING","itoa64",94],"[",["T_VARIABLE","$value",94],["T_WHITESPACE"," ",94],"&",["T_WHITESPACE"," ",94],["T_LNUMBER","0x3f",94],"]",";",["T_WHITESPACE","\n\t\t\t",94],["T_IF","if",95],["T_WHITESPACE"," ",95],"(",["T_VARIABLE","$i",95],["T_WHITESPACE"," ",95],"<",["T_WHITESPACE"," ",95],["T_VARIABLE","$count",95],")",["T_WHITESPACE","\n\t\t\t\t",95],["T_VARIABLE","$value",96],["T_WHITESPACE"," ",96],["T_OR_EQUAL","|=",96],["T_WHITESPACE"," ",96],["T_STRING","ord",96],"(",["T_VARIABLE","$input",96],"[",["T_VARIABLE","$i",96],"]",")",["T_WHITESPACE"," ",96],["T_SL","<<",96],["T_WHITESPACE"," ",96],["T_LNUMBER","8",96],";",["T_WHITESPACE","\n\t\t\t",96],["T_VARIABLE","$output",97],["T_WHITESPACE"," ",97],["T_CONCAT_EQUAL",".=",97],["T_WHITESPACE"," ",97],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","itoa64",97],"[","(",["T_VARIABLE","$value",97],["T_WHITESPACE"," ",97],["T_SR",">>",97],["T_WHITESPACE"," ",97],["T_LNUMBER","6",97],")",["T_WHITESPACE"," ",97],"&",["T_WHITESPACE"," ",97],["T_LNUMBER","0x3f",97],"]",";",["T_WHITESPACE","\n\t\t\t",97],["T_IF","if",98],["T_WHITESPACE"," ",98],"(",["T_VARIABLE","$i",98],["T_INC","++",98],["T_WHITESPACE"," ",98],["T_IS_GREATER_OR_EQUAL",">=",98],["T_WHITESPACE"," ",98],["T_VARIABLE","$count",98],")",["T_WHITESPACE","\n\t\t\t\t",98],["T_BREAK","break",99],";",["T_WHITESPACE","\n\t\t\t",99],["T_IF","if",100],["T_WHITESPACE"," ",100],"(",["T_VARIABLE","$i",100],["T_WHITESPACE"," ",100],"<",["T_WHITESPACE"," ",100],["T_VARIABLE","$count",100],")",["T_WHITESPACE","\n\t\t\t\t",100],["T_VARIABLE","$value",101],["T_WHITESPACE"," ",101],["T_OR_EQUAL","|=",101],["T_WHITESPACE"," ",101],["T_STRING","ord",101],"(",["T_VARIABLE","$input",101],"[",["T_VARIABLE","$i",101],"]",")",["T_WHITESPACE"," ",101],["T_SL","<<",101],["T_WHITESPACE"," ",101],["T_LNUMBER","16",101],";",["T_WHITESPACE","\n\t\t\t",101],["T_VARIABLE","$output",102],["T_WHITESPACE"," ",102],["T_CONCAT_EQUAL",".=",102],["T_WHITESPACE"," ",102],["T_VARIABLE","$this",102],["T_OBJECT_OPERATOR","->",102],["T_STRING","itoa64",102],"[","(",["T_VARIABLE","$value",102],["T_WHITESPACE"," ",102],["T_SR",">>",102],["T_WHITESPACE"," ",102],["T_LNUMBER","12",102],")",["T_WHITESPACE"," ",102],"&",["T_WHITESPACE"," ",102],["T_LNUMBER","0x3f",102],"]",";",["T_WHITESPACE","\n\t\t\t",102],["T_IF","if",103],["T_WHITESPACE"," ",103],"(",["T_VARIABLE","$i",103],["T_INC","++",103],["T_WHITESPACE"," ",103],["T_IS_GREATER_OR_EQUAL",">=",103],["T_WHITESPACE"," ",103],["T_VARIABLE","$count",103],")",["T_WHITESPACE","\n\t\t\t\t",103],["T_BREAK","break",104],";",["T_WHITESPACE","\n\t\t\t",104],["T_VARIABLE","$output",105],["T_WHITESPACE"," ",105],["T_CONCAT_EQUAL",".=",105],["T_WHITESPACE"," ",105],["T_VARIABLE","$this",105],["T_OBJECT_OPERATOR","->",105],["T_STRING","itoa64",105],"[","(",["T_VARIABLE","$value",105],["T_WHITESPACE"," ",105],["T_SR",">>",105],["T_WHITESPACE"," ",105],["T_LNUMBER","18",105],")",["T_WHITESPACE"," ",105],"&",["T_WHITESPACE"," ",105],["T_LNUMBER","0x3f",105],"]",";",["T_WHITESPACE","\n\t\t",105],"}",["T_WHITESPACE"," ",106],["T_WHILE","while",106],["T_WHITESPACE"," ",106],"(",["T_VARIABLE","$i",106],["T_WHITESPACE"," ",106],"<",["T_WHITESPACE"," ",106],["T_VARIABLE","$count",106],")",";",["T_WHITESPACE","\n\n\t\t",106],["T_RETURN","return",108],["T_WHITESPACE"," ",108],["T_VARIABLE","$output",108],";",["T_WHITESPACE","\n\t",108],"}",["T_WHITESPACE","\n\n\t",109],["T_FUNCTION","function",111],["T_WHITESPACE"," ",111],["T_STRING","gensalt_private",111],"(",["T_VARIABLE","$input",111],")",["T_WHITESPACE","\n\t",111],"{",["T_WHITESPACE","\n\t\t",112],["T_VARIABLE","$output",113],["T_WHITESPACE"," ",113],"=",["T_WHITESPACE"," ",113],["T_CONSTANT_ENCAPSED_STRING","'$P$'",113],";",["T_WHITESPACE","\n\t\t",113],["T_VARIABLE","$output",114],["T_WHITESPACE"," ",114],["T_CONCAT_EQUAL",".=",114],["T_WHITESPACE"," ",114],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","itoa64",114],"[",["T_STRING","min",114],"(",["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","iteration_count_log2",114],["T_WHITESPACE"," ",114],"+",["T_WHITESPACE","\n\t\t\t",114],"(","(",["T_STRING","PHP_VERSION",115],["T_WHITESPACE"," ",115],["T_IS_GREATER_OR_EQUAL",">=",115],["T_WHITESPACE"," ",115],["T_CONSTANT_ENCAPSED_STRING","'5'",115],")",["T_WHITESPACE"," ",115],"?",["T_WHITESPACE"," ",115],["T_LNUMBER","5",115],["T_WHITESPACE"," ",115],":",["T_WHITESPACE"," ",115],["T_LNUMBER","3",115],")",",",["T_WHITESPACE"," ",115],["T_LNUMBER","30",115],")","]",";",["T_WHITESPACE","\n\t\t",115],["T_VARIABLE","$output",116],["T_WHITESPACE"," ",116],["T_CONCAT_EQUAL",".=",116],["T_WHITESPACE"," ",116],["T_VARIABLE","$this",116],["T_OBJECT_OPERATOR","->",116],["T_STRING","encode64",116],"(",["T_VARIABLE","$input",116],",",["T_WHITESPACE"," ",116],["T_LNUMBER","6",116],")",";",["T_WHITESPACE","\n\n\t\t",116],["T_RETURN","return",118],["T_WHITESPACE"," ",118],["T_VARIABLE","$output",118],";",["T_WHITESPACE","\n\t",118],"}",["T_WHITESPACE","\n\n\t",119],["T_FUNCTION","function",121],["T_WHITESPACE"," ",121],["T_STRING","crypt_private",121],"(",["T_VARIABLE","$password",121],",",["T_WHITESPACE"," ",121],["T_VARIABLE","$setting",121],")",["T_WHITESPACE","\n\t",121],"{",["T_WHITESPACE","\n\t\t",122],["T_VARIABLE","$output",123],["T_WHITESPACE"," ",123],"=",["T_WHITESPACE"," ",123],["T_CONSTANT_ENCAPSED_STRING","'*0'",123],";",["T_WHITESPACE","\n\t\t",123],["T_IF","if",124],["T_WHITESPACE"," ",124],"(",["T_STRING","substr",124],"(",["T_VARIABLE","$setting",124],",",["T_WHITESPACE"," ",124],["T_LNUMBER","0",124],",",["T_WHITESPACE"," ",124],["T_LNUMBER","2",124],")",["T_WHITESPACE"," ",124],["T_IS_EQUAL","==",124],["T_WHITESPACE"," ",124],["T_VARIABLE","$output",124],")",["T_WHITESPACE","\n\t\t\t",124],["T_VARIABLE","$output",125],["T_WHITESPACE"," ",125],"=",["T_WHITESPACE"," ",125],["T_CONSTANT_ENCAPSED_STRING","'*1'",125],";",["T_WHITESPACE","\n\n\t\t",125],["T_VARIABLE","$id",127],["T_WHITESPACE"," ",127],"=",["T_WHITESPACE"," ",127],["T_STRING","substr",127],"(",["T_VARIABLE","$setting",127],",",["T_WHITESPACE"," ",127],["T_LNUMBER","0",127],",",["T_WHITESPACE"," ",127],["T_LNUMBER","3",127],")",";",["T_WHITESPACE","\n\t\t",127],["T_COMMENT","# We use \"$P$\", phpBB3 uses \"$H$\" for the same thing\n",128],["T_WHITESPACE","\t\t",129],["T_IF","if",129],["T_WHITESPACE"," ",129],"(",["T_VARIABLE","$id",129],["T_WHITESPACE"," ",129],["T_IS_NOT_EQUAL","!=",129],["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","'$P$'",129],["T_WHITESPACE"," ",129],["T_BOOLEAN_AND","&&",129],["T_WHITESPACE"," ",129],["T_VARIABLE","$id",129],["T_WHITESPACE"," ",129],["T_IS_NOT_EQUAL","!=",129],["T_WHITESPACE"," ",129],["T_CONSTANT_ENCAPSED_STRING","'$H$'",129],")",["T_WHITESPACE","\n\t\t\t",129],["T_RETURN","return",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$output",130],";",["T_WHITESPACE","\n\n\t\t",130],["T_VARIABLE","$count_log2",132],["T_WHITESPACE"," ",132],"=",["T_WHITESPACE"," ",132],["T_STRING","strpos",132],"(",["T_VARIABLE","$this",132],["T_OBJECT_OPERATOR","->",132],["T_STRING","itoa64",132],",",["T_WHITESPACE"," ",132],["T_VARIABLE","$setting",132],"[",["T_LNUMBER","3",132],"]",")",";",["T_WHITESPACE","\n\t\t",132],["T_IF","if",133],["T_WHITESPACE"," ",133],"(",["T_VARIABLE","$count_log2",133],["T_WHITESPACE"," ",133],"<",["T_WHITESPACE"," ",133],["T_LNUMBER","7",133],["T_WHITESPACE"," ",133],["T_BOOLEAN_OR","||",133],["T_WHITESPACE"," ",133],["T_VARIABLE","$count_log2",133],["T_WHITESPACE"," ",133],">",["T_WHITESPACE"," ",133],["T_LNUMBER","30",133],")",["T_WHITESPACE","\n\t\t\t",133],["T_RETURN","return",134],["T_WHITESPACE"," ",134],["T_VARIABLE","$output",134],";",["T_WHITESPACE","\n\n\t\t",134],["T_VARIABLE","$count",136],["T_WHITESPACE"," ",136],"=",["T_WHITESPACE"," ",136],["T_LNUMBER","1",136],["T_WHITESPACE"," ",136],["T_SL","<<",136],["T_WHITESPACE"," ",136],["T_VARIABLE","$count_log2",136],";",["T_WHITESPACE","\n\n\t\t",136],["T_VARIABLE","$salt",138],["T_WHITESPACE"," ",138],"=",["T_WHITESPACE"," ",138],["T_STRING","substr",138],"(",["T_VARIABLE","$setting",138],",",["T_WHITESPACE"," ",138],["T_LNUMBER","4",138],",",["T_WHITESPACE"," ",138],["T_LNUMBER","8",138],")",";",["T_WHITESPACE","\n\t\t",138],["T_IF","if",139],["T_WHITESPACE"," ",139],"(",["T_STRING","strlen",139],"(",["T_VARIABLE","$salt",139],")",["T_WHITESPACE"," ",139],["T_IS_NOT_EQUAL","!=",139],["T_WHITESPACE"," ",139],["T_LNUMBER","8",139],")",["T_WHITESPACE","\n\t\t\t",139],["T_RETURN","return",140],["T_WHITESPACE"," ",140],["T_VARIABLE","$output",140],";",["T_WHITESPACE","\n\n\t\t",140],["T_COMMENT","# We're kind of forced to use MD5 here since it's the only\n",142],["T_WHITESPACE","\t\t",143],["T_COMMENT","# cryptographic primitive available in all versions of PHP\n",143],["T_WHITESPACE","\t\t",144],["T_COMMENT","# currently in use.  To implement our own low-level crypto\n",144],["T_WHITESPACE","\t\t",145],["T_COMMENT","# in PHP would result in much worse performance and\n",145],["T_WHITESPACE","\t\t",146],["T_COMMENT","# consequently in lower iteration counts and hashes that are\n",146],["T_WHITESPACE","\t\t",147],["T_COMMENT","# quicker to crack (by non-PHP code).\n",147],["T_WHITESPACE","\t\t",148],["T_IF","if",148],["T_WHITESPACE"," ",148],"(",["T_STRING","PHP_VERSION",148],["T_WHITESPACE"," ",148],["T_IS_GREATER_OR_EQUAL",">=",148],["T_WHITESPACE"," ",148],["T_CONSTANT_ENCAPSED_STRING","'5'",148],")",["T_WHITESPACE"," ",148],"{",["T_WHITESPACE","\n\t\t\t",148],["T_VARIABLE","$hash",149],["T_WHITESPACE"," ",149],"=",["T_WHITESPACE"," ",149],["T_STRING","md5",149],"(",["T_VARIABLE","$salt",149],["T_WHITESPACE"," ",149],".",["T_WHITESPACE"," ",149],["T_VARIABLE","$password",149],",",["T_WHITESPACE"," ",149],["T_STRING","TRUE",149],")",";",["T_WHITESPACE","\n\t\t\t",149],["T_DO","do",150],["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n\t\t\t\t",150],["T_VARIABLE","$hash",151],["T_WHITESPACE"," ",151],"=",["T_WHITESPACE"," ",151],["T_STRING","md5",151],"(",["T_VARIABLE","$hash",151],["T_WHITESPACE"," ",151],".",["T_WHITESPACE"," ",151],["T_VARIABLE","$password",151],",",["T_WHITESPACE"," ",151],["T_STRING","TRUE",151],")",";",["T_WHITESPACE","\n\t\t\t",151],"}",["T_WHITESPACE"," ",152],["T_WHILE","while",152],["T_WHITESPACE"," ",152],"(",["T_DEC","--",152],["T_VARIABLE","$count",152],")",";",["T_WHITESPACE","\n\t\t",152],"}",["T_WHITESPACE"," ",153],["T_ELSE","else",153],["T_WHITESPACE"," ",153],"{",["T_WHITESPACE","\n\t\t\t",153],["T_VARIABLE","$hash",154],["T_WHITESPACE"," ",154],"=",["T_WHITESPACE"," ",154],["T_STRING","pack",154],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",154],",",["T_WHITESPACE"," ",154],["T_STRING","md5",154],"(",["T_VARIABLE","$salt",154],["T_WHITESPACE"," ",154],".",["T_WHITESPACE"," ",154],["T_VARIABLE","$password",154],")",")",";",["T_WHITESPACE","\n\t\t\t",154],["T_DO","do",155],["T_WHITESPACE"," ",155],"{",["T_WHITESPACE","\n\t\t\t\t",155],["T_VARIABLE","$hash",156],["T_WHITESPACE"," ",156],"=",["T_WHITESPACE"," ",156],["T_STRING","pack",156],"(",["T_CONSTANT_ENCAPSED_STRING","'H*'",156],",",["T_WHITESPACE"," ",156],["T_STRING","md5",156],"(",["T_VARIABLE","$hash",156],["T_WHITESPACE"," ",156],".",["T_WHITESPACE"," ",156],["T_VARIABLE","$password",156],")",")",";",["T_WHITESPACE","\n\t\t\t",156],"}",["T_WHITESPACE"," ",157],["T_WHILE","while",157],["T_WHITESPACE"," ",157],"(",["T_DEC","--",157],["T_VARIABLE","$count",157],")",";",["T_WHITESPACE","\n\t\t",157],"}",["T_WHITESPACE","\n\n\t\t",158],["T_VARIABLE","$output",160],["T_WHITESPACE"," ",160],"=",["T_WHITESPACE"," ",160],["T_STRING","substr",160],"(",["T_VARIABLE","$setting",160],",",["T_WHITESPACE"," ",160],["T_LNUMBER","0",160],",",["T_WHITESPACE"," ",160],["T_LNUMBER","12",160],")",";",["T_WHITESPACE","\n\t\t",160],["T_VARIABLE","$output",161],["T_WHITESPACE"," ",161],["T_CONCAT_EQUAL",".=",161],["T_WHITESPACE"," ",161],["T_VARIABLE","$this",161],["T_OBJECT_OPERATOR","->",161],["T_STRING","encode64",161],"(",["T_VARIABLE","$hash",161],",",["T_WHITESPACE"," ",161],["T_LNUMBER","16",161],")",";",["T_WHITESPACE","\n\n\t\t",161],["T_RETURN","return",163],["T_WHITESPACE"," ",163],["T_VARIABLE","$output",163],";",["T_WHITESPACE","\n\t",163],"}",["T_WHITESPACE","\n\n\t",164],["T_FUNCTION","function",166],["T_WHITESPACE"," ",166],["T_STRING","gensalt_extended",166],"(",["T_VARIABLE","$input",166],")",["T_WHITESPACE","\n\t",166],"{",["T_WHITESPACE","\n\t\t",167],["T_VARIABLE","$count_log2",168],["T_WHITESPACE"," ",168],"=",["T_WHITESPACE"," ",168],["T_STRING","min",168],"(",["T_VARIABLE","$this",168],["T_OBJECT_OPERATOR","->",168],["T_STRING","iteration_count_log2",168],["T_WHITESPACE"," ",168],"+",["T_WHITESPACE"," ",168],["T_LNUMBER","8",168],",",["T_WHITESPACE"," ",168],["T_LNUMBER","24",168],")",";",["T_WHITESPACE","\n\t\t",168],["T_COMMENT","# This should be odd to not reveal weak DES keys, and the\n",169],["T_WHITESPACE","\t\t",170],["T_COMMENT","# maximum valid value is (2**24 - 1) which is odd anyway.\n",170],["T_WHITESPACE","\t\t",171],["T_VARIABLE","$count",171],["T_WHITESPACE"," ",171],"=",["T_WHITESPACE"," ",171],"(",["T_LNUMBER","1",171],["T_WHITESPACE"," ",171],["T_SL","<<",171],["T_WHITESPACE"," ",171],["T_VARIABLE","$count_log2",171],")",["T_WHITESPACE"," ",171],"-",["T_WHITESPACE"," ",171],["T_LNUMBER","1",171],";",["T_WHITESPACE","\n\n\t\t",171],["T_VARIABLE","$output",173],["T_WHITESPACE"," ",173],"=",["T_WHITESPACE"," ",173],["T_CONSTANT_ENCAPSED_STRING","'_'",173],";",["T_WHITESPACE","\n\t\t",173],["T_VARIABLE","$output",174],["T_WHITESPACE"," ",174],["T_CONCAT_EQUAL",".=",174],["T_WHITESPACE"," ",174],["T_VARIABLE","$this",174],["T_OBJECT_OPERATOR","->",174],["T_STRING","itoa64",174],"[",["T_VARIABLE","$count",174],["T_WHITESPACE"," ",174],"&",["T_WHITESPACE"," ",174],["T_LNUMBER","0x3f",174],"]",";",["T_WHITESPACE","\n\t\t",174],["T_VARIABLE","$output",175],["T_WHITESPACE"," ",175],["T_CONCAT_EQUAL",".=",175],["T_WHITESPACE"," ",175],["T_VARIABLE","$this",175],["T_OBJECT_OPERATOR","->",175],["T_STRING","itoa64",175],"[","(",["T_VARIABLE","$count",175],["T_WHITESPACE"," ",175],["T_SR",">>",175],["T_WHITESPACE"," ",175],["T_LNUMBER","6",175],")",["T_WHITESPACE"," ",175],"&",["T_WHITESPACE"," ",175],["T_LNUMBER","0x3f",175],"]",";",["T_WHITESPACE","\n\t\t",175],["T_VARIABLE","$output",176],["T_WHITESPACE"," ",176],["T_CONCAT_EQUAL",".=",176],["T_WHITESPACE"," ",176],["T_VARIABLE","$this",176],["T_OBJECT_OPERATOR","->",176],["T_STRING","itoa64",176],"[","(",["T_VARIABLE","$count",176],["T_WHITESPACE"," ",176],["T_SR",">>",176],["T_WHITESPACE"," ",176],["T_LNUMBER","12",176],")",["T_WHITESPACE"," ",176],"&",["T_WHITESPACE"," ",176],["T_LNUMBER","0x3f",176],"]",";",["T_WHITESPACE","\n\t\t",176],["T_VARIABLE","$output",177],["T_WHITESPACE"," ",177],["T_CONCAT_EQUAL",".=",177],["T_WHITESPACE"," ",177],["T_VARIABLE","$this",177],["T_OBJECT_OPERATOR","->",177],["T_STRING","itoa64",177],"[","(",["T_VARIABLE","$count",177],["T_WHITESPACE"," ",177],["T_SR",">>",177],["T_WHITESPACE"," ",177],["T_LNUMBER","18",177],")",["T_WHITESPACE"," ",177],"&",["T_WHITESPACE"," ",177],["T_LNUMBER","0x3f",177],"]",";",["T_WHITESPACE","\n\n\t\t",177],["T_VARIABLE","$output",179],["T_WHITESPACE"," ",179],["T_CONCAT_EQUAL",".=",179],["T_WHITESPACE"," ",179],["T_VARIABLE","$this",179],["T_OBJECT_OPERATOR","->",179],["T_STRING","encode64",179],"(",["T_VARIABLE","$input",179],",",["T_WHITESPACE"," ",179],["T_LNUMBER","3",179],")",";",["T_WHITESPACE","\n\n\t\t",179],["T_RETURN","return",181],["T_WHITESPACE"," ",181],["T_VARIABLE","$output",181],";",["T_WHITESPACE","\n\t",181],"}",["T_WHITESPACE","\n\n\t",182],["T_FUNCTION","function",184],["T_WHITESPACE"," ",184],["T_STRING","gensalt_blowfish",184],"(",["T_VARIABLE","$input",184],")",["T_WHITESPACE","\n\t",184],"{",["T_WHITESPACE","\n\t\t",185],["T_COMMENT","# This one needs to use a different order of characters and a\n",186],["T_WHITESPACE","\t\t",187],["T_COMMENT","# different encoding scheme from the one in encode64() above.\n",187],["T_WHITESPACE","\t\t",188],["T_COMMENT","# We care because the last character in our encoded string will\n",188],["T_WHITESPACE","\t\t",189],["T_COMMENT","# only represent 2 bits.  While two known implementations of\n",189],["T_WHITESPACE","\t\t",190],["T_COMMENT","# bcrypt will happily accept and correct a salt string which\n",190],["T_WHITESPACE","\t\t",191],["T_COMMENT","# has the 4 unused bits set to non-zero, we do not want to take\n",191],["T_WHITESPACE","\t\t",192],["T_COMMENT","# chances and we also do not want to waste an additional byte\n",192],["T_WHITESPACE","\t\t",193],["T_COMMENT","# of entropy.\n",193],["T_WHITESPACE","\t\t",194],["T_VARIABLE","$itoa64",194],["T_WHITESPACE"," ",194],"=",["T_WHITESPACE"," ",194],["T_CONSTANT_ENCAPSED_STRING","'.\/ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'",194],";",["T_WHITESPACE","\n\n\t\t",194],["T_VARIABLE","$output",196],["T_WHITESPACE"," ",196],"=",["T_WHITESPACE"," ",196],["T_CONSTANT_ENCAPSED_STRING","'$2a$'",196],";",["T_WHITESPACE","\n\t\t",196],["T_VARIABLE","$output",197],["T_WHITESPACE"," ",197],["T_CONCAT_EQUAL",".=",197],["T_WHITESPACE"," ",197],["T_STRING","chr",197],"(",["T_STRING","ord",197],"(",["T_CONSTANT_ENCAPSED_STRING","'0'",197],")",["T_WHITESPACE"," ",197],"+",["T_WHITESPACE"," ",197],["T_VARIABLE","$this",197],["T_OBJECT_OPERATOR","->",197],["T_STRING","iteration_count_log2",197],["T_WHITESPACE"," ",197],"\/",["T_WHITESPACE"," ",197],["T_LNUMBER","10",197],")",";",["T_WHITESPACE","\n\t\t",197],["T_VARIABLE","$output",198],["T_WHITESPACE"," ",198],["T_CONCAT_EQUAL",".=",198],["T_WHITESPACE"," ",198],["T_STRING","chr",198],"(",["T_STRING","ord",198],"(",["T_CONSTANT_ENCAPSED_STRING","'0'",198],")",["T_WHITESPACE"," ",198],"+",["T_WHITESPACE"," ",198],["T_VARIABLE","$this",198],["T_OBJECT_OPERATOR","->",198],["T_STRING","iteration_count_log2",198],["T_WHITESPACE"," ",198],"%",["T_WHITESPACE"," ",198],["T_LNUMBER","10",198],")",";",["T_WHITESPACE","\n\t\t",198],["T_VARIABLE","$output",199],["T_WHITESPACE"," ",199],["T_CONCAT_EQUAL",".=",199],["T_WHITESPACE"," ",199],["T_CONSTANT_ENCAPSED_STRING","'$'",199],";",["T_WHITESPACE","\n\n\t\t",199],["T_VARIABLE","$i",201],["T_WHITESPACE"," ",201],"=",["T_WHITESPACE"," ",201],["T_LNUMBER","0",201],";",["T_WHITESPACE","\n\t\t",201],["T_DO","do",202],["T_WHITESPACE"," ",202],"{",["T_WHITESPACE","\n\t\t\t",202],["T_VARIABLE","$c1",203],["T_WHITESPACE"," ",203],"=",["T_WHITESPACE"," ",203],["T_STRING","ord",203],"(",["T_VARIABLE","$input",203],"[",["T_VARIABLE","$i",203],["T_INC","++",203],"]",")",";",["T_WHITESPACE","\n\t\t\t",203],["T_VARIABLE","$output",204],["T_WHITESPACE"," ",204],["T_CONCAT_EQUAL",".=",204],["T_WHITESPACE"," ",204],["T_VARIABLE","$itoa64",204],"[",["T_VARIABLE","$c1",204],["T_WHITESPACE"," ",204],["T_SR",">>",204],["T_WHITESPACE"," ",204],["T_LNUMBER","2",204],"]",";",["T_WHITESPACE","\n\t\t\t",204],["T_VARIABLE","$c1",205],["T_WHITESPACE"," ",205],"=",["T_WHITESPACE"," ",205],"(",["T_VARIABLE","$c1",205],["T_WHITESPACE"," ",205],"&",["T_WHITESPACE"," ",205],["T_LNUMBER","0x03",205],")",["T_WHITESPACE"," ",205],["T_SL","<<",205],["T_WHITESPACE"," ",205],["T_LNUMBER","4",205],";",["T_WHITESPACE","\n\t\t\t",205],["T_IF","if",206],["T_WHITESPACE"," ",206],"(",["T_VARIABLE","$i",206],["T_WHITESPACE"," ",206],["T_IS_GREATER_OR_EQUAL",">=",206],["T_WHITESPACE"," ",206],["T_LNUMBER","16",206],")",["T_WHITESPACE"," ",206],"{",["T_WHITESPACE","\n\t\t\t\t",206],["T_VARIABLE","$output",207],["T_WHITESPACE"," ",207],["T_CONCAT_EQUAL",".=",207],["T_WHITESPACE"," ",207],["T_VARIABLE","$itoa64",207],"[",["T_VARIABLE","$c1",207],"]",";",["T_WHITESPACE","\n\t\t\t\t",207],["T_BREAK","break",208],";",["T_WHITESPACE","\n\t\t\t",208],"}",["T_WHITESPACE","\n\n\t\t\t",209],["T_VARIABLE","$c2",211],["T_WHITESPACE"," ",211],"=",["T_WHITESPACE"," ",211],["T_STRING","ord",211],"(",["T_VARIABLE","$input",211],"[",["T_VARIABLE","$i",211],["T_INC","++",211],"]",")",";",["T_WHITESPACE","\n\t\t\t",211],["T_VARIABLE","$c1",212],["T_WHITESPACE"," ",212],["T_OR_EQUAL","|=",212],["T_WHITESPACE"," ",212],["T_VARIABLE","$c2",212],["T_WHITESPACE"," ",212],["T_SR",">>",212],["T_WHITESPACE"," ",212],["T_LNUMBER","4",212],";",["T_WHITESPACE","\n\t\t\t",212],["T_VARIABLE","$output",213],["T_WHITESPACE"," ",213],["T_CONCAT_EQUAL",".=",213],["T_WHITESPACE"," ",213],["T_VARIABLE","$itoa64",213],"[",["T_VARIABLE","$c1",213],"]",";",["T_WHITESPACE","\n\t\t\t",213],["T_VARIABLE","$c1",214],["T_WHITESPACE"," ",214],"=",["T_WHITESPACE"," ",214],"(",["T_VARIABLE","$c2",214],["T_WHITESPACE"," ",214],"&",["T_WHITESPACE"," ",214],["T_LNUMBER","0x0f",214],")",["T_WHITESPACE"," ",214],["T_SL","<<",214],["T_WHITESPACE"," ",214],["T_LNUMBER","2",214],";",["T_WHITESPACE","\n\n\t\t\t",214],["T_VARIABLE","$c2",216],["T_WHITESPACE"," ",216],"=",["T_WHITESPACE"," ",216],["T_STRING","ord",216],"(",["T_VARIABLE","$input",216],"[",["T_VARIABLE","$i",216],["T_INC","++",216],"]",")",";",["T_WHITESPACE","\n\t\t\t",216],["T_VARIABLE","$c1",217],["T_WHITESPACE"," ",217],["T_OR_EQUAL","|=",217],["T_WHITESPACE"," ",217],["T_VARIABLE","$c2",217],["T_WHITESPACE"," ",217],["T_SR",">>",217],["T_WHITESPACE"," ",217],["T_LNUMBER","6",217],";",["T_WHITESPACE","\n\t\t\t",217],["T_VARIABLE","$output",218],["T_WHITESPACE"," ",218],["T_CONCAT_EQUAL",".=",218],["T_WHITESPACE"," ",218],["T_VARIABLE","$itoa64",218],"[",["T_VARIABLE","$c1",218],"]",";",["T_WHITESPACE","\n\t\t\t",218],["T_VARIABLE","$output",219],["T_WHITESPACE"," ",219],["T_CONCAT_EQUAL",".=",219],["T_WHITESPACE"," ",219],["T_VARIABLE","$itoa64",219],"[",["T_VARIABLE","$c2",219],["T_WHITESPACE"," ",219],"&",["T_WHITESPACE"," ",219],["T_LNUMBER","0x3f",219],"]",";",["T_WHITESPACE","\n\t\t",219],"}",["T_WHITESPACE"," ",220],["T_WHILE","while",220],["T_WHITESPACE"," ",220],"(",["T_LNUMBER","1",220],")",";",["T_WHITESPACE","\n\n\t\t",220],["T_RETURN","return",222],["T_WHITESPACE"," ",222],["T_VARIABLE","$output",222],";",["T_WHITESPACE","\n\t",222],"}",["T_WHITESPACE","\n\n\t",223],["T_FUNCTION","function",225],["T_WHITESPACE"," ",225],["T_STRING","HashPassword",225],"(",["T_VARIABLE","$password",225],")",["T_WHITESPACE","\n\t",225],"{",["T_WHITESPACE","\n\t\t",226],["T_IF","if",227],["T_WHITESPACE"," ",227],"(",["T_WHITESPACE"," ",227],["T_STRING","strlen",227],"(",["T_WHITESPACE"," ",227],["T_VARIABLE","$password",227],["T_WHITESPACE"," ",227],")",["T_WHITESPACE"," ",227],">",["T_WHITESPACE"," ",227],["T_LNUMBER","4096",227],["T_WHITESPACE"," ",227],")",["T_WHITESPACE"," ",227],"{",["T_WHITESPACE","\n\t\t\t",227],["T_RETURN","return",228],["T_WHITESPACE"," ",228],["T_CONSTANT_ENCAPSED_STRING","'*'",228],";",["T_WHITESPACE","\n\t\t",228],"}",["T_WHITESPACE","\n\n\t\t",229],["T_VARIABLE","$random",231],["T_WHITESPACE"," ",231],"=",["T_WHITESPACE"," ",231],["T_CONSTANT_ENCAPSED_STRING","''",231],";",["T_WHITESPACE","\n\n\t\t",231],["T_IF","if",233],["T_WHITESPACE"," ",233],"(",["T_STRING","CRYPT_BLOWFISH",233],["T_WHITESPACE"," ",233],["T_IS_EQUAL","==",233],["T_WHITESPACE"," ",233],["T_LNUMBER","1",233],["T_WHITESPACE"," ",233],["T_BOOLEAN_AND","&&",233],["T_WHITESPACE"," ",233],"!",["T_VARIABLE","$this",233],["T_OBJECT_OPERATOR","->",233],["T_STRING","portable_hashes",233],")",["T_WHITESPACE"," ",233],"{",["T_WHITESPACE","\n\t\t\t",233],["T_VARIABLE","$random",234],["T_WHITESPACE"," ",234],"=",["T_WHITESPACE"," ",234],["T_VARIABLE","$this",234],["T_OBJECT_OPERATOR","->",234],["T_STRING","get_random_bytes",234],"(",["T_LNUMBER","16",234],")",";",["T_WHITESPACE","\n\t\t\t",234],["T_VARIABLE","$hash",235],["T_WHITESPACE"," ",235],"=",["T_WHITESPACE","\n\t\t\t    ",235],["T_STRING","crypt",236],"(",["T_VARIABLE","$password",236],",",["T_WHITESPACE"," ",236],["T_VARIABLE","$this",236],["T_OBJECT_OPERATOR","->",236],["T_STRING","gensalt_blowfish",236],"(",["T_VARIABLE","$random",236],")",")",";",["T_WHITESPACE","\n\t\t\t",236],["T_IF","if",237],["T_WHITESPACE"," ",237],"(",["T_STRING","strlen",237],"(",["T_VARIABLE","$hash",237],")",["T_WHITESPACE"," ",237],["T_IS_EQUAL","==",237],["T_WHITESPACE"," ",237],["T_LNUMBER","60",237],")",["T_WHITESPACE","\n\t\t\t\t",237],["T_RETURN","return",238],["T_WHITESPACE"," ",238],["T_VARIABLE","$hash",238],";",["T_WHITESPACE","\n\t\t",238],"}",["T_WHITESPACE","\n\n\t\t",239],["T_IF","if",241],["T_WHITESPACE"," ",241],"(",["T_STRING","CRYPT_EXT_DES",241],["T_WHITESPACE"," ",241],["T_IS_EQUAL","==",241],["T_WHITESPACE"," ",241],["T_LNUMBER","1",241],["T_WHITESPACE"," ",241],["T_BOOLEAN_AND","&&",241],["T_WHITESPACE"," ",241],"!",["T_VARIABLE","$this",241],["T_OBJECT_OPERATOR","->",241],["T_STRING","portable_hashes",241],")",["T_WHITESPACE"," ",241],"{",["T_WHITESPACE","\n\t\t\t",241],["T_IF","if",242],["T_WHITESPACE"," ",242],"(",["T_STRING","strlen",242],"(",["T_VARIABLE","$random",242],")",["T_WHITESPACE"," ",242],"<",["T_WHITESPACE"," ",242],["T_LNUMBER","3",242],")",["T_WHITESPACE","\n\t\t\t\t",242],["T_VARIABLE","$random",243],["T_WHITESPACE"," ",243],"=",["T_WHITESPACE"," ",243],["T_VARIABLE","$this",243],["T_OBJECT_OPERATOR","->",243],["T_STRING","get_random_bytes",243],"(",["T_LNUMBER","3",243],")",";",["T_WHITESPACE","\n\t\t\t",243],["T_VARIABLE","$hash",244],["T_WHITESPACE"," ",244],"=",["T_WHITESPACE","\n\t\t\t    ",244],["T_STRING","crypt",245],"(",["T_VARIABLE","$password",245],",",["T_WHITESPACE"," ",245],["T_VARIABLE","$this",245],["T_OBJECT_OPERATOR","->",245],["T_STRING","gensalt_extended",245],"(",["T_VARIABLE","$random",245],")",")",";",["T_WHITESPACE","\n\t\t\t",245],["T_IF","if",246],["T_WHITESPACE"," ",246],"(",["T_STRING","strlen",246],"(",["T_VARIABLE","$hash",246],")",["T_WHITESPACE"," ",246],["T_IS_EQUAL","==",246],["T_WHITESPACE"," ",246],["T_LNUMBER","20",246],")",["T_WHITESPACE","\n\t\t\t\t",246],["T_RETURN","return",247],["T_WHITESPACE"," ",247],["T_VARIABLE","$hash",247],";",["T_WHITESPACE","\n\t\t",247],"}",["T_WHITESPACE","\n\n\t\t",248],["T_IF","if",250],["T_WHITESPACE"," ",250],"(",["T_STRING","strlen",250],"(",["T_VARIABLE","$random",250],")",["T_WHITESPACE"," ",250],"<",["T_WHITESPACE"," ",250],["T_LNUMBER","6",250],")",["T_WHITESPACE","\n\t\t\t",250],["T_VARIABLE","$random",251],["T_WHITESPACE"," ",251],"=",["T_WHITESPACE"," ",251],["T_VARIABLE","$this",251],["T_OBJECT_OPERATOR","->",251],["T_STRING","get_random_bytes",251],"(",["T_LNUMBER","6",251],")",";",["T_WHITESPACE","\n\t\t",251],["T_VARIABLE","$hash",252],["T_WHITESPACE"," ",252],"=",["T_WHITESPACE","\n\t\t    ",252],["T_VARIABLE","$this",253],["T_OBJECT_OPERATOR","->",253],["T_STRING","crypt_private",253],"(",["T_VARIABLE","$password",253],",",["T_WHITESPACE","\n\t\t    ",253],["T_VARIABLE","$this",254],["T_OBJECT_OPERATOR","->",254],["T_STRING","gensalt_private",254],"(",["T_VARIABLE","$random",254],")",")",";",["T_WHITESPACE","\n\t\t",254],["T_IF","if",255],["T_WHITESPACE"," ",255],"(",["T_STRING","strlen",255],"(",["T_VARIABLE","$hash",255],")",["T_WHITESPACE"," ",255],["T_IS_EQUAL","==",255],["T_WHITESPACE"," ",255],["T_LNUMBER","34",255],")",["T_WHITESPACE","\n\t\t\t",255],["T_RETURN","return",256],["T_WHITESPACE"," ",256],["T_VARIABLE","$hash",256],";",["T_WHITESPACE","\n\n\t\t",256],["T_COMMENT","# Returning '*' on error is safe here, but would _not_ be safe\n",258],["T_WHITESPACE","\t\t",259],["T_COMMENT","# in a crypt(3)-like function used _both_ for generating new\n",259],["T_WHITESPACE","\t\t",260],["T_COMMENT","# hashes and for validating passwords against existing hashes.\n",260],["T_WHITESPACE","\t\t",261],["T_RETURN","return",261],["T_WHITESPACE"," ",261],["T_CONSTANT_ENCAPSED_STRING","'*'",261],";",["T_WHITESPACE","\n\t",261],"}",["T_WHITESPACE","\n\n\t",262],["T_FUNCTION","function",264],["T_WHITESPACE"," ",264],["T_STRING","CheckPassword",264],"(",["T_VARIABLE","$password",264],",",["T_WHITESPACE"," ",264],["T_VARIABLE","$stored_hash",264],")",["T_WHITESPACE","\n\t",264],"{",["T_WHITESPACE","\n\t\t",265],["T_IF","if",266],["T_WHITESPACE"," ",266],"(",["T_WHITESPACE"," ",266],["T_STRING","strlen",266],"(",["T_WHITESPACE"," ",266],["T_VARIABLE","$password",266],["T_WHITESPACE"," ",266],")",["T_WHITESPACE"," ",266],">",["T_WHITESPACE"," ",266],["T_LNUMBER","4096",266],["T_WHITESPACE"," ",266],")",["T_WHITESPACE"," ",266],"{",["T_WHITESPACE","\n\t\t\t",266],["T_RETURN","return",267],["T_WHITESPACE"," ",267],["T_STRING","false",267],";",["T_WHITESPACE","\n\t\t",267],"}",["T_WHITESPACE","\n\n\t\t",268],["T_VARIABLE","$hash",270],["T_WHITESPACE"," ",270],"=",["T_WHITESPACE"," ",270],["T_VARIABLE","$this",270],["T_OBJECT_OPERATOR","->",270],["T_STRING","crypt_private",270],"(",["T_VARIABLE","$password",270],",",["T_WHITESPACE"," ",270],["T_VARIABLE","$stored_hash",270],")",";",["T_WHITESPACE","\n\t\t",270],["T_IF","if",271],["T_WHITESPACE"," ",271],"(",["T_VARIABLE","$hash",271],"[",["T_LNUMBER","0",271],"]",["T_WHITESPACE"," ",271],["T_IS_EQUAL","==",271],["T_WHITESPACE"," ",271],["T_CONSTANT_ENCAPSED_STRING","'*'",271],")",["T_WHITESPACE","\n\t\t\t",271],["T_VARIABLE","$hash",272],["T_WHITESPACE"," ",272],"=",["T_WHITESPACE"," ",272],["T_STRING","crypt",272],"(",["T_VARIABLE","$password",272],",",["T_WHITESPACE"," ",272],["T_VARIABLE","$stored_hash",272],")",";",["T_WHITESPACE","\n\n\t\t",272],["T_RETURN","return",274],["T_WHITESPACE"," ",274],["T_VARIABLE","$hash",274],["T_WHITESPACE"," ",274],["T_IS_IDENTICAL","===",274],["T_WHITESPACE"," ",274],["T_VARIABLE","$stored_hash",274],";",["T_WHITESPACE","\n\t",274],"}",["T_WHITESPACE","\n",275],"}"]