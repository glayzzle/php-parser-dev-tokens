[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Class used internally by Diff to actually compute the diffs.\n *\n * This class uses the Unix `diff` program via shell_exec to compute the\n * differences between the two input arrays.\n *\n * Copyright 2007-2010 The Horde Project (http:\/\/www.horde.org\/)\n *\n * See the enclosed file COPYING for license information (LGPL). If you did\n * not receive this file, see http:\/\/opensource.org\/licenses\/lgpl-license.php.\n *\n * @author  Milian Wolff <mail@milianw.de>\n * @package Text_Diff\n * @since   0.3.0\n *\/",2],["T_WHITESPACE","\n",16],["T_CLASS","class",17],["T_WHITESPACE"," ",17],["T_STRING","Text_Diff_Engine_shell",17],["T_WHITESPACE"," ",17],"{",["T_WHITESPACE","\n\n    ",17],["T_DOC_COMMENT","\/**\n     * Path to the diff executable\n     *\n     * @var string\n     *\/",19],["T_WHITESPACE","\n    ",23],["T_VAR","var",24],["T_WHITESPACE"," ",24],["T_VARIABLE","$_diffCommand",24],["T_WHITESPACE"," ",24],"=",["T_WHITESPACE"," ",24],["T_CONSTANT_ENCAPSED_STRING","'diff'",24],";",["T_WHITESPACE","\n\n    ",24],["T_DOC_COMMENT","\/**\n     * Returns the array of differences.\n     *\n     * @param array $from_lines lines of text from old file\n     * @param array $to_lines   lines of text from new file\n     *\n     * @return array all changes made (array with Text_Diff_Op_* objects)\n     *\/",26],["T_WHITESPACE","\n    ",33],["T_FUNCTION","function",34],["T_WHITESPACE"," ",34],["T_STRING","diff",34],"(",["T_VARIABLE","$from_lines",34],",",["T_WHITESPACE"," ",34],["T_VARIABLE","$to_lines",34],")",["T_WHITESPACE","\n    ",34],"{",["T_WHITESPACE","\n        ",35],["T_STRING","array_walk",36],"(",["T_VARIABLE","$from_lines",36],",",["T_WHITESPACE"," ",36],["T_ARRAY","array",36],"(",["T_CONSTANT_ENCAPSED_STRING","'Text_Diff'",36],",",["T_WHITESPACE"," ",36],["T_CONSTANT_ENCAPSED_STRING","'trimNewlines'",36],")",")",";",["T_WHITESPACE","\n        ",36],["T_STRING","array_walk",37],"(",["T_VARIABLE","$to_lines",37],",",["T_WHITESPACE"," ",37],["T_ARRAY","array",37],"(",["T_CONSTANT_ENCAPSED_STRING","'Text_Diff'",37],",",["T_WHITESPACE"," ",37],["T_CONSTANT_ENCAPSED_STRING","'trimNewlines'",37],")",")",";",["T_WHITESPACE","\n\n        ",37],["T_VARIABLE","$temp_dir",39],["T_WHITESPACE"," ",39],"=",["T_WHITESPACE"," ",39],["T_STRING","Text_Diff",39],["T_DOUBLE_COLON","::",39],["T_STRING","_getTempDir",39],"(",")",";",["T_WHITESPACE","\n\n        ",39],["T_COMMENT","\/\/ Execute gnu diff or similar to get a standard diff file.\n",41],["T_WHITESPACE","        ",42],["T_VARIABLE","$from_file",42],["T_WHITESPACE"," ",42],"=",["T_WHITESPACE"," ",42],["T_STRING","tempnam",42],"(",["T_VARIABLE","$temp_dir",42],",",["T_WHITESPACE"," ",42],["T_CONSTANT_ENCAPSED_STRING","'Text_Diff'",42],")",";",["T_WHITESPACE","\n        ",42],["T_VARIABLE","$to_file",43],["T_WHITESPACE"," ",43],"=",["T_WHITESPACE"," ",43],["T_STRING","tempnam",43],"(",["T_VARIABLE","$temp_dir",43],",",["T_WHITESPACE"," ",43],["T_CONSTANT_ENCAPSED_STRING","'Text_Diff'",43],")",";",["T_WHITESPACE","\n        ",43],["T_VARIABLE","$fp",44],["T_WHITESPACE"," ",44],"=",["T_WHITESPACE"," ",44],["T_STRING","fopen",44],"(",["T_VARIABLE","$from_file",44],",",["T_WHITESPACE"," ",44],["T_CONSTANT_ENCAPSED_STRING","'w'",44],")",";",["T_WHITESPACE","\n        ",44],["T_STRING","fwrite",45],"(",["T_VARIABLE","$fp",45],",",["T_WHITESPACE"," ",45],["T_STRING","implode",45],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",45],",",["T_WHITESPACE"," ",45],["T_VARIABLE","$from_lines",45],")",")",";",["T_WHITESPACE","\n        ",45],["T_STRING","fclose",46],"(",["T_VARIABLE","$fp",46],")",";",["T_WHITESPACE","\n        ",46],["T_VARIABLE","$fp",47],["T_WHITESPACE"," ",47],"=",["T_WHITESPACE"," ",47],["T_STRING","fopen",47],"(",["T_VARIABLE","$to_file",47],",",["T_WHITESPACE"," ",47],["T_CONSTANT_ENCAPSED_STRING","'w'",47],")",";",["T_WHITESPACE","\n        ",47],["T_STRING","fwrite",48],"(",["T_VARIABLE","$fp",48],",",["T_WHITESPACE"," ",48],["T_STRING","implode",48],"(",["T_CONSTANT_ENCAPSED_STRING","\"\\n\"",48],",",["T_WHITESPACE"," ",48],["T_VARIABLE","$to_lines",48],")",")",";",["T_WHITESPACE","\n        ",48],["T_STRING","fclose",49],"(",["T_VARIABLE","$fp",49],")",";",["T_WHITESPACE","\n        ",49],["T_VARIABLE","$diff",50],["T_WHITESPACE"," ",50],"=",["T_WHITESPACE"," ",50],["T_STRING","shell_exec",50],"(",["T_VARIABLE","$this",50],["T_OBJECT_OPERATOR","->",50],["T_STRING","_diffCommand",50],["T_WHITESPACE"," ",50],".",["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","' '",50],["T_WHITESPACE"," ",50],".",["T_WHITESPACE"," ",50],["T_VARIABLE","$from_file",50],["T_WHITESPACE"," ",50],".",["T_WHITESPACE"," ",50],["T_CONSTANT_ENCAPSED_STRING","' '",50],["T_WHITESPACE"," ",50],".",["T_WHITESPACE"," ",50],["T_VARIABLE","$to_file",50],")",";",["T_WHITESPACE","\n        ",50],["T_STRING","unlink",51],"(",["T_VARIABLE","$from_file",51],")",";",["T_WHITESPACE","\n        ",51],["T_STRING","unlink",52],"(",["T_VARIABLE","$to_file",52],")",";",["T_WHITESPACE","\n\n        ",52],["T_IF","if",54],["T_WHITESPACE"," ",54],"(",["T_STRING","is_null",54],"(",["T_VARIABLE","$diff",54],")",")",["T_WHITESPACE"," ",54],"{",["T_WHITESPACE","\n            ",54],["T_COMMENT","\/\/ No changes were made\n",55],["T_WHITESPACE","            ",56],["T_RETURN","return",56],["T_WHITESPACE"," ",56],["T_ARRAY","array",56],"(",["T_NEW","new",56],["T_WHITESPACE"," ",56],["T_STRING","Text_Diff_Op_copy",56],"(",["T_VARIABLE","$from_lines",56],")",")",";",["T_WHITESPACE","\n        ",56],"}",["T_WHITESPACE","\n\n        ",57],["T_VARIABLE","$from_line_no",59],["T_WHITESPACE"," ",59],"=",["T_WHITESPACE"," ",59],["T_LNUMBER","1",59],";",["T_WHITESPACE","\n        ",59],["T_VARIABLE","$to_line_no",60],["T_WHITESPACE"," ",60],"=",["T_WHITESPACE"," ",60],["T_LNUMBER","1",60],";",["T_WHITESPACE","\n        ",60],["T_VARIABLE","$edits",61],["T_WHITESPACE"," ",61],"=",["T_WHITESPACE"," ",61],["T_ARRAY","array",61],"(",")",";",["T_WHITESPACE","\n\n        ",61],["T_COMMENT","\/\/ Get changed lines by parsing something like:\n",63],["T_WHITESPACE","        ",64],["T_COMMENT","\/\/ 0a1,2\n",64],["T_WHITESPACE","        ",65],["T_COMMENT","\/\/ 1,2c4,6\n",65],["T_WHITESPACE","        ",66],["T_COMMENT","\/\/ 1,5d6\n",66],["T_WHITESPACE","        ",67],["T_STRING","preg_match_all",67],"(",["T_CONSTANT_ENCAPSED_STRING","'#^(\\d+)(?:,(\\d+))?([adc])(\\d+)(?:,(\\d+))?$#m'",67],",",["T_WHITESPACE"," ",67],["T_VARIABLE","$diff",67],",",["T_WHITESPACE","\n            ",67],["T_VARIABLE","$matches",68],",",["T_WHITESPACE"," ",68],["T_STRING","PREG_SET_ORDER",68],")",";",["T_WHITESPACE","\n\n        ",68],["T_FOREACH","foreach",70],["T_WHITESPACE"," ",70],"(",["T_VARIABLE","$matches",70],["T_WHITESPACE"," ",70],["T_AS","as",70],["T_WHITESPACE"," ",70],["T_VARIABLE","$match",70],")",["T_WHITESPACE"," ",70],"{",["T_WHITESPACE","\n            ",70],["T_IF","if",71],["T_WHITESPACE"," ",71],"(","!",["T_ISSET","isset",71],"(",["T_VARIABLE","$match",71],"[",["T_LNUMBER","5",71],"]",")",")",["T_WHITESPACE"," ",71],"{",["T_WHITESPACE","\n                ",71],["T_COMMENT","\/\/ This paren is not set every time (see regex).\n",72],["T_WHITESPACE","                ",73],["T_VARIABLE","$match",73],"[",["T_LNUMBER","5",73],"]",["T_WHITESPACE"," ",73],"=",["T_WHITESPACE"," ",73],["T_STRING","false",73],";",["T_WHITESPACE","\n            ",73],"}",["T_WHITESPACE","\n\n            ",74],["T_IF","if",76],["T_WHITESPACE"," ",76],"(",["T_VARIABLE","$match",76],"[",["T_LNUMBER","3",76],"]",["T_WHITESPACE"," ",76],["T_IS_EQUAL","==",76],["T_WHITESPACE"," ",76],["T_CONSTANT_ENCAPSED_STRING","'a'",76],")",["T_WHITESPACE"," ",76],"{",["T_WHITESPACE","\n                ",76],["T_VARIABLE","$from_line_no",77],["T_DEC","--",77],";",["T_WHITESPACE","\n            ",77],"}",["T_WHITESPACE","\n\n            ",78],["T_IF","if",80],["T_WHITESPACE"," ",80],"(",["T_VARIABLE","$match",80],"[",["T_LNUMBER","3",80],"]",["T_WHITESPACE"," ",80],["T_IS_EQUAL","==",80],["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'d'",80],")",["T_WHITESPACE"," ",80],"{",["T_WHITESPACE","\n                ",80],["T_VARIABLE","$to_line_no",81],["T_DEC","--",81],";",["T_WHITESPACE","\n            ",81],"}",["T_WHITESPACE","\n\n            ",82],["T_IF","if",84],["T_WHITESPACE"," ",84],"(",["T_VARIABLE","$from_line_no",84],["T_WHITESPACE"," ",84],"<",["T_WHITESPACE"," ",84],["T_VARIABLE","$match",84],"[",["T_LNUMBER","1",84],"]",["T_WHITESPACE"," ",84],["T_BOOLEAN_OR","||",84],["T_WHITESPACE"," ",84],["T_VARIABLE","$to_line_no",84],["T_WHITESPACE"," ",84],"<",["T_WHITESPACE"," ",84],["T_VARIABLE","$match",84],"[",["T_LNUMBER","4",84],"]",")",["T_WHITESPACE"," ",84],"{",["T_WHITESPACE","\n                ",84],["T_COMMENT","\/\/ copied lines\n",85],["T_WHITESPACE","                ",86],["T_STRING","assert",86],"(",["T_CONSTANT_ENCAPSED_STRING","'$match[1] - $from_line_no == $match[4] - $to_line_no'",86],")",";",["T_WHITESPACE","\n                ",86],["T_STRING","array_push",87],"(",["T_VARIABLE","$edits",87],",",["T_WHITESPACE","\n                    ",87],["T_NEW","new",88],["T_WHITESPACE"," ",88],["T_STRING","Text_Diff_Op_copy",88],"(",["T_WHITESPACE","\n                        ",88],["T_VARIABLE","$this",89],["T_OBJECT_OPERATOR","->",89],["T_STRING","_getLines",89],"(",["T_VARIABLE","$from_lines",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$from_line_no",89],",",["T_WHITESPACE"," ",89],["T_VARIABLE","$match",89],"[",["T_LNUMBER","1",89],"]",["T_WHITESPACE"," ",89],"-",["T_WHITESPACE"," ",89],["T_LNUMBER","1",89],")",",",["T_WHITESPACE","\n                        ",89],["T_VARIABLE","$this",90],["T_OBJECT_OPERATOR","->",90],["T_STRING","_getLines",90],"(",["T_VARIABLE","$to_lines",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$to_line_no",90],",",["T_WHITESPACE"," ",90],["T_VARIABLE","$match",90],"[",["T_LNUMBER","4",90],"]",["T_WHITESPACE"," ",90],"-",["T_WHITESPACE"," ",90],["T_LNUMBER","1",90],")",")",")",";",["T_WHITESPACE","\n            ",90],"}",["T_WHITESPACE","\n\n            ",91],["T_SWITCH","switch",93],["T_WHITESPACE"," ",93],"(",["T_VARIABLE","$match",93],"[",["T_LNUMBER","3",93],"]",")",["T_WHITESPACE"," ",93],"{",["T_WHITESPACE","\n            ",93],["T_CASE","case",94],["T_WHITESPACE"," ",94],["T_CONSTANT_ENCAPSED_STRING","'d'",94],":",["T_WHITESPACE","\n                ",94],["T_COMMENT","\/\/ deleted lines\n",95],["T_WHITESPACE","                ",96],["T_STRING","array_push",96],"(",["T_VARIABLE","$edits",96],",",["T_WHITESPACE","\n                    ",96],["T_NEW","new",97],["T_WHITESPACE"," ",97],["T_STRING","Text_Diff_Op_delete",97],"(",["T_WHITESPACE","\n                        ",97],["T_VARIABLE","$this",98],["T_OBJECT_OPERATOR","->",98],["T_STRING","_getLines",98],"(",["T_VARIABLE","$from_lines",98],",",["T_WHITESPACE"," ",98],["T_VARIABLE","$from_line_no",98],",",["T_WHITESPACE"," ",98],["T_VARIABLE","$match",98],"[",["T_LNUMBER","2",98],"]",")",")",")",";",["T_WHITESPACE","\n                ",98],["T_VARIABLE","$to_line_no",99],["T_INC","++",99],";",["T_WHITESPACE","\n                ",99],["T_BREAK","break",100],";",["T_WHITESPACE","\n\n            ",100],["T_CASE","case",102],["T_WHITESPACE"," ",102],["T_CONSTANT_ENCAPSED_STRING","'c'",102],":",["T_WHITESPACE","\n                ",102],["T_COMMENT","\/\/ changed lines\n",103],["T_WHITESPACE","                ",104],["T_STRING","array_push",104],"(",["T_VARIABLE","$edits",104],",",["T_WHITESPACE","\n                    ",104],["T_NEW","new",105],["T_WHITESPACE"," ",105],["T_STRING","Text_Diff_Op_change",105],"(",["T_WHITESPACE","\n                        ",105],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","_getLines",106],"(",["T_VARIABLE","$from_lines",106],",",["T_WHITESPACE"," ",106],["T_VARIABLE","$from_line_no",106],",",["T_WHITESPACE"," ",106],["T_VARIABLE","$match",106],"[",["T_LNUMBER","2",106],"]",")",",",["T_WHITESPACE","\n                        ",106],["T_VARIABLE","$this",107],["T_OBJECT_OPERATOR","->",107],["T_STRING","_getLines",107],"(",["T_VARIABLE","$to_lines",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$to_line_no",107],",",["T_WHITESPACE"," ",107],["T_VARIABLE","$match",107],"[",["T_LNUMBER","5",107],"]",")",")",")",";",["T_WHITESPACE","\n                ",107],["T_BREAK","break",108],";",["T_WHITESPACE","\n\n            ",108],["T_CASE","case",110],["T_WHITESPACE"," ",110],["T_CONSTANT_ENCAPSED_STRING","'a'",110],":",["T_WHITESPACE","\n                ",110],["T_COMMENT","\/\/ added lines\n",111],["T_WHITESPACE","                ",112],["T_STRING","array_push",112],"(",["T_VARIABLE","$edits",112],",",["T_WHITESPACE","\n                    ",112],["T_NEW","new",113],["T_WHITESPACE"," ",113],["T_STRING","Text_Diff_Op_add",113],"(",["T_WHITESPACE","\n                        ",113],["T_VARIABLE","$this",114],["T_OBJECT_OPERATOR","->",114],["T_STRING","_getLines",114],"(",["T_VARIABLE","$to_lines",114],",",["T_WHITESPACE"," ",114],["T_VARIABLE","$to_line_no",114],",",["T_WHITESPACE"," ",114],["T_VARIABLE","$match",114],"[",["T_LNUMBER","5",114],"]",")",")",")",";",["T_WHITESPACE","\n                ",114],["T_VARIABLE","$from_line_no",115],["T_INC","++",115],";",["T_WHITESPACE","\n                ",115],["T_BREAK","break",116],";",["T_WHITESPACE","\n            ",116],"}",["T_WHITESPACE","\n        ",117],"}",["T_WHITESPACE","\n\n        ",118],["T_IF","if",120],["T_WHITESPACE"," ",120],"(","!",["T_EMPTY","empty",120],"(",["T_VARIABLE","$from_lines",120],")",")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n            ",120],["T_COMMENT","\/\/ Some lines might still be pending. Add them as copied\n",121],["T_WHITESPACE","            ",122],["T_STRING","array_push",122],"(",["T_VARIABLE","$edits",122],",",["T_WHITESPACE","\n                ",122],["T_NEW","new",123],["T_WHITESPACE"," ",123],["T_STRING","Text_Diff_Op_copy",123],"(",["T_WHITESPACE","\n                    ",123],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","_getLines",124],"(",["T_VARIABLE","$from_lines",124],",",["T_WHITESPACE"," ",124],["T_VARIABLE","$from_line_no",124],",",["T_WHITESPACE","\n                                     ",124],["T_VARIABLE","$from_line_no",125],["T_WHITESPACE"," ",125],"+",["T_WHITESPACE"," ",125],["T_STRING","count",125],"(",["T_VARIABLE","$from_lines",125],")",["T_WHITESPACE"," ",125],"-",["T_WHITESPACE"," ",125],["T_LNUMBER","1",125],")",",",["T_WHITESPACE","\n                    ",125],["T_VARIABLE","$this",126],["T_OBJECT_OPERATOR","->",126],["T_STRING","_getLines",126],"(",["T_VARIABLE","$to_lines",126],",",["T_WHITESPACE"," ",126],["T_VARIABLE","$to_line_no",126],",",["T_WHITESPACE","\n                                     ",126],["T_VARIABLE","$to_line_no",127],["T_WHITESPACE"," ",127],"+",["T_WHITESPACE"," ",127],["T_STRING","count",127],"(",["T_VARIABLE","$to_lines",127],")",["T_WHITESPACE"," ",127],"-",["T_WHITESPACE"," ",127],["T_LNUMBER","1",127],")",")",")",";",["T_WHITESPACE","\n        ",127],"}",["T_WHITESPACE","\n\n        ",128],["T_RETURN","return",130],["T_WHITESPACE"," ",130],["T_VARIABLE","$edits",130],";",["T_WHITESPACE","\n    ",130],"}",["T_WHITESPACE","\n\n    ",131],["T_DOC_COMMENT","\/**\n     * Get lines from either the old or new text\n     *\n     * @access private\n     *\n     * @param array &$text_lines Either $from_lines or $to_lines\n     * @param int   &$line_no    Current line number\n     * @param int   $end         Optional end line, when we want to chop more\n     *                           than one line.\n     *\n     * @return array The chopped lines\n     *\/",133],["T_WHITESPACE","\n    ",144],["T_FUNCTION","function",145],["T_WHITESPACE"," ",145],["T_STRING","_getLines",145],"(","&",["T_VARIABLE","$text_lines",145],",",["T_WHITESPACE"," ",145],"&",["T_VARIABLE","$line_no",145],",",["T_WHITESPACE"," ",145],["T_VARIABLE","$end",145],["T_WHITESPACE"," ",145],"=",["T_WHITESPACE"," ",145],["T_STRING","false",145],")",["T_WHITESPACE","\n    ",145],"{",["T_WHITESPACE","\n        ",146],["T_IF","if",147],["T_WHITESPACE"," ",147],"(","!",["T_EMPTY","empty",147],"(",["T_VARIABLE","$end",147],")",")",["T_WHITESPACE"," ",147],"{",["T_WHITESPACE","\n            ",147],["T_VARIABLE","$lines",148],["T_WHITESPACE"," ",148],"=",["T_WHITESPACE"," ",148],["T_ARRAY","array",148],"(",")",";",["T_WHITESPACE","\n            ",148],["T_COMMENT","\/\/ We can shift even more\n",149],["T_WHITESPACE","            ",150],["T_WHILE","while",150],["T_WHITESPACE"," ",150],"(",["T_VARIABLE","$line_no",150],["T_WHITESPACE"," ",150],["T_IS_SMALLER_OR_EQUAL","<=",150],["T_WHITESPACE"," ",150],["T_VARIABLE","$end",150],")",["T_WHITESPACE"," ",150],"{",["T_WHITESPACE","\n                ",150],["T_STRING","array_push",151],"(",["T_VARIABLE","$lines",151],",",["T_WHITESPACE"," ",151],["T_STRING","array_shift",151],"(",["T_VARIABLE","$text_lines",151],")",")",";",["T_WHITESPACE","\n                ",151],["T_VARIABLE","$line_no",152],["T_INC","++",152],";",["T_WHITESPACE","\n            ",152],"}",["T_WHITESPACE","\n        ",153],"}",["T_WHITESPACE"," ",154],["T_ELSE","else",154],["T_WHITESPACE"," ",154],"{",["T_WHITESPACE","\n            ",154],["T_VARIABLE","$lines",155],["T_WHITESPACE"," ",155],"=",["T_WHITESPACE"," ",155],["T_ARRAY","array",155],"(",["T_STRING","array_shift",155],"(",["T_VARIABLE","$text_lines",155],")",")",";",["T_WHITESPACE","\n            ",155],["T_VARIABLE","$line_no",156],["T_INC","++",156],";",["T_WHITESPACE","\n        ",156],"}",["T_WHITESPACE","\n\n        ",157],["T_RETURN","return",159],["T_WHITESPACE"," ",159],["T_VARIABLE","$lines",159],";",["T_WHITESPACE","\n    ",159],"}",["T_WHITESPACE","\n\n",160],"}",["T_WHITESPACE","\n",162]]