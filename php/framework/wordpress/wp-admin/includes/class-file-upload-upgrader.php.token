[["T_OPEN_TAG","<?php\n",1],["T_DOC_COMMENT","\/**\n * Upgrade API: File_Upload_Upgrader class\n *\n * @package WordPress\n * @subpackage Upgrader\n * @since 4.6.0\n *\/",2],["T_WHITESPACE","\n\n",8],["T_DOC_COMMENT","\/**\n * Core class used for handling file uploads.\n *\n * This class handles the upload process and passes it as if it's a local file\n * to the Upgrade\/Installer functions.\n *\n * @since 2.8.0\n * @since 4.6.0 Moved to its own file from wp-admin\/includes\/class-wp-upgrader.php.\n *\/",10],["T_WHITESPACE","\n",18],["T_CLASS","class",19],["T_WHITESPACE"," ",19],["T_STRING","File_Upload_Upgrader",19],["T_WHITESPACE"," ",19],"{",["T_WHITESPACE","\n\n\t",19],["T_DOC_COMMENT","\/**\n\t * The full path to the file package.\n\t *\n\t * @since 2.8.0\n\t * @access public\n\t * @var string $package\n\t *\/",21],["T_WHITESPACE","\n\t",27],["T_PUBLIC","public",28],["T_WHITESPACE"," ",28],["T_VARIABLE","$package",28],";",["T_WHITESPACE","\n\n\t",28],["T_DOC_COMMENT","\/**\n\t * The name of the file.\n\t *\n\t * @since 2.8.0\n\t * @access public\n\t * @var string $filename\n\t *\/",30],["T_WHITESPACE","\n\t",36],["T_PUBLIC","public",37],["T_WHITESPACE"," ",37],["T_VARIABLE","$filename",37],";",["T_WHITESPACE","\n\n\t",37],["T_DOC_COMMENT","\/**\n\t * The ID of the attachment post for this file.\n\t *\n\t * @since 3.3.0\n\t * @access public\n\t * @var int $id\n\t *\/",39],["T_WHITESPACE","\n\t",45],["T_PUBLIC","public",46],["T_WHITESPACE"," ",46],["T_VARIABLE","$id",46],["T_WHITESPACE"," ",46],"=",["T_WHITESPACE"," ",46],["T_LNUMBER","0",46],";",["T_WHITESPACE","\n\n\t",46],["T_DOC_COMMENT","\/**\n\t * Construct the upgrader for a form.\n\t *\n\t * @since 2.8.0\n\t * @access public\n\t *\n\t * @param string $form      The name of the form the file was uploaded from.\n\t * @param string $urlholder The name of the `GET` parameter that holds the filename.\n\t *\/",48],["T_WHITESPACE","\n\t",56],["T_PUBLIC","public",57],["T_WHITESPACE"," ",57],["T_FUNCTION","function",57],["T_WHITESPACE"," ",57],["T_STRING","__construct",57],"(",["T_WHITESPACE"," ",57],["T_VARIABLE","$form",57],",",["T_WHITESPACE"," ",57],["T_VARIABLE","$urlholder",57],["T_WHITESPACE"," ",57],")",["T_WHITESPACE"," ",57],"{",["T_WHITESPACE","\n\n\t\t",57],["T_IF","if",59],["T_WHITESPACE"," ",59],"(",["T_WHITESPACE"," ",59],["T_EMPTY","empty",59],"(",["T_VARIABLE","$_FILES",59],"[",["T_VARIABLE","$form",59],"]","[",["T_CONSTANT_ENCAPSED_STRING","'name'",59],"]",")",["T_WHITESPACE"," ",59],["T_BOOLEAN_AND","&&",59],["T_WHITESPACE"," ",59],["T_EMPTY","empty",59],"(",["T_VARIABLE","$_GET",59],"[",["T_VARIABLE","$urlholder",59],"]",")",["T_WHITESPACE"," ",59],")",["T_WHITESPACE","\n\t\t\t",59],["T_STRING","wp_die",60],"(",["T_STRING","__",60],"(",["T_CONSTANT_ENCAPSED_STRING","'Please select a file'",60],")",")",";",["T_WHITESPACE","\n\n\t\t",60],["T_COMMENT","\/\/Handle a newly uploaded file, Else assume it's already been uploaded\n",62],["T_WHITESPACE","\t\t",63],["T_IF","if",63],["T_WHITESPACE"," ",63],"(",["T_WHITESPACE"," ",63],"!",["T_WHITESPACE"," ",63],["T_EMPTY","empty",63],"(",["T_VARIABLE","$_FILES",63],")",["T_WHITESPACE"," ",63],")",["T_WHITESPACE"," ",63],"{",["T_WHITESPACE","\n\t\t\t",63],["T_VARIABLE","$overrides",64],["T_WHITESPACE"," ",64],"=",["T_WHITESPACE"," ",64],["T_ARRAY","array",64],"(",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'test_form'",64],["T_WHITESPACE"," ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_STRING","false",64],",",["T_WHITESPACE"," ",64],["T_CONSTANT_ENCAPSED_STRING","'test_type'",64],["T_WHITESPACE"," ",64],["T_DOUBLE_ARROW","=>",64],["T_WHITESPACE"," ",64],["T_STRING","false",64],["T_WHITESPACE"," ",64],")",";",["T_WHITESPACE","\n\t\t\t",64],["T_VARIABLE","$file",65],["T_WHITESPACE"," ",65],"=",["T_WHITESPACE"," ",65],["T_STRING","wp_handle_upload",65],"(",["T_WHITESPACE"," ",65],["T_VARIABLE","$_FILES",65],"[",["T_VARIABLE","$form",65],"]",",",["T_WHITESPACE"," ",65],["T_VARIABLE","$overrides",65],["T_WHITESPACE"," ",65],")",";",["T_WHITESPACE","\n\n\t\t\t",65],["T_IF","if",67],["T_WHITESPACE"," ",67],"(",["T_WHITESPACE"," ",67],["T_ISSET","isset",67],"(",["T_WHITESPACE"," ",67],["T_VARIABLE","$file",67],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",67],"]",["T_WHITESPACE"," ",67],")",["T_WHITESPACE"," ",67],")",["T_WHITESPACE","\n\t\t\t\t",67],["T_STRING","wp_die",68],"(",["T_WHITESPACE"," ",68],["T_VARIABLE","$file",68],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",68],"]",["T_WHITESPACE"," ",68],")",";",["T_WHITESPACE","\n\n\t\t\t",68],["T_VARIABLE","$this",70],["T_OBJECT_OPERATOR","->",70],["T_STRING","filename",70],["T_WHITESPACE"," ",70],"=",["T_WHITESPACE"," ",70],["T_VARIABLE","$_FILES",70],"[",["T_VARIABLE","$form",70],"]","[",["T_CONSTANT_ENCAPSED_STRING","'name'",70],"]",";",["T_WHITESPACE","\n\t\t\t",70],["T_VARIABLE","$this",71],["T_OBJECT_OPERATOR","->",71],["T_STRING","package",71],["T_WHITESPACE"," ",71],"=",["T_WHITESPACE"," ",71],["T_VARIABLE","$file",71],"[",["T_CONSTANT_ENCAPSED_STRING","'file'",71],"]",";",["T_WHITESPACE","\n\n\t\t\t",71],["T_COMMENT","\/\/ Construct the object array\n",73],["T_WHITESPACE","\t\t\t",74],["T_VARIABLE","$object",74],["T_WHITESPACE"," ",74],"=",["T_WHITESPACE"," ",74],["T_ARRAY","array",74],"(",["T_WHITESPACE","\n\t\t\t\t",74],["T_CONSTANT_ENCAPSED_STRING","'post_title'",75],["T_WHITESPACE"," ",75],["T_DOUBLE_ARROW","=>",75],["T_WHITESPACE"," ",75],["T_VARIABLE","$this",75],["T_OBJECT_OPERATOR","->",75],["T_STRING","filename",75],",",["T_WHITESPACE","\n\t\t\t\t",75],["T_CONSTANT_ENCAPSED_STRING","'post_content'",76],["T_WHITESPACE"," ",76],["T_DOUBLE_ARROW","=>",76],["T_WHITESPACE"," ",76],["T_VARIABLE","$file",76],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",76],"]",",",["T_WHITESPACE","\n\t\t\t\t",76],["T_CONSTANT_ENCAPSED_STRING","'post_mime_type'",77],["T_WHITESPACE"," ",77],["T_DOUBLE_ARROW","=>",77],["T_WHITESPACE"," ",77],["T_VARIABLE","$file",77],"[",["T_CONSTANT_ENCAPSED_STRING","'type'",77],"]",",",["T_WHITESPACE","\n\t\t\t\t",77],["T_CONSTANT_ENCAPSED_STRING","'guid'",78],["T_WHITESPACE"," ",78],["T_DOUBLE_ARROW","=>",78],["T_WHITESPACE"," ",78],["T_VARIABLE","$file",78],"[",["T_CONSTANT_ENCAPSED_STRING","'url'",78],"]",",",["T_WHITESPACE","\n\t\t\t\t",78],["T_CONSTANT_ENCAPSED_STRING","'context'",79],["T_WHITESPACE"," ",79],["T_DOUBLE_ARROW","=>",79],["T_WHITESPACE"," ",79],["T_CONSTANT_ENCAPSED_STRING","'upgrader'",79],",",["T_WHITESPACE","\n\t\t\t\t",79],["T_CONSTANT_ENCAPSED_STRING","'post_status'",80],["T_WHITESPACE"," ",80],["T_DOUBLE_ARROW","=>",80],["T_WHITESPACE"," ",80],["T_CONSTANT_ENCAPSED_STRING","'private'",80],["T_WHITESPACE","\n\t\t\t",80],")",";",["T_WHITESPACE","\n\n\t\t\t",81],["T_COMMENT","\/\/ Save the data.\n",83],["T_WHITESPACE","\t\t\t",84],["T_VARIABLE","$this",84],["T_OBJECT_OPERATOR","->",84],["T_STRING","id",84],["T_WHITESPACE"," ",84],"=",["T_WHITESPACE"," ",84],["T_STRING","wp_insert_attachment",84],"(",["T_WHITESPACE"," ",84],["T_VARIABLE","$object",84],",",["T_WHITESPACE"," ",84],["T_VARIABLE","$file",84],"[",["T_CONSTANT_ENCAPSED_STRING","'file'",84],"]",["T_WHITESPACE"," ",84],")",";",["T_WHITESPACE","\n\n\t\t\t",84],["T_COMMENT","\/\/ Schedule a cleanup for 2 hours from now in case of failed install.\n",86],["T_WHITESPACE","\t\t\t",87],["T_STRING","wp_schedule_single_event",87],"(",["T_WHITESPACE"," ",87],["T_STRING","time",87],"(",")",["T_WHITESPACE"," ",87],"+",["T_WHITESPACE"," ",87],["T_LNUMBER","2",87],["T_WHITESPACE"," ",87],"*",["T_WHITESPACE"," ",87],["T_STRING","HOUR_IN_SECONDS",87],",",["T_WHITESPACE"," ",87],["T_CONSTANT_ENCAPSED_STRING","'upgrader_scheduled_cleanup'",87],",",["T_WHITESPACE"," ",87],["T_ARRAY","array",87],"(",["T_WHITESPACE"," ",87],["T_VARIABLE","$this",87],["T_OBJECT_OPERATOR","->",87],["T_STRING","id",87],["T_WHITESPACE"," ",87],")",["T_WHITESPACE"," ",87],")",";",["T_WHITESPACE","\n\n\t\t",87],"}",["T_WHITESPACE"," ",89],["T_ELSEIF","elseif",89],["T_WHITESPACE"," ",89],"(",["T_WHITESPACE"," ",89],["T_STRING","is_numeric",89],"(",["T_WHITESPACE"," ",89],["T_VARIABLE","$_GET",89],"[",["T_VARIABLE","$urlholder",89],"]",["T_WHITESPACE"," ",89],")",["T_WHITESPACE"," ",89],")",["T_WHITESPACE"," ",89],"{",["T_WHITESPACE","\n\t\t\t",89],["T_COMMENT","\/\/ Numeric Package = previously uploaded file, see above.\n",90],["T_WHITESPACE","\t\t\t",91],["T_VARIABLE","$this",91],["T_OBJECT_OPERATOR","->",91],["T_STRING","id",91],["T_WHITESPACE"," ",91],"=",["T_WHITESPACE"," ",91],["T_INT_CAST","(int)",91],["T_WHITESPACE"," ",91],["T_VARIABLE","$_GET",91],"[",["T_VARIABLE","$urlholder",91],"]",";",["T_WHITESPACE","\n\t\t\t",91],["T_VARIABLE","$attachment",92],["T_WHITESPACE"," ",92],"=",["T_WHITESPACE"," ",92],["T_STRING","get_post",92],"(",["T_WHITESPACE"," ",92],["T_VARIABLE","$this",92],["T_OBJECT_OPERATOR","->",92],["T_STRING","id",92],["T_WHITESPACE"," ",92],")",";",["T_WHITESPACE","\n\t\t\t",92],["T_IF","if",93],["T_WHITESPACE"," ",93],"(",["T_WHITESPACE"," ",93],["T_EMPTY","empty",93],"(",["T_VARIABLE","$attachment",93],")",["T_WHITESPACE"," ",93],")",["T_WHITESPACE","\n\t\t\t\t",93],["T_STRING","wp_die",94],"(",["T_STRING","__",94],"(",["T_CONSTANT_ENCAPSED_STRING","'Please select a file'",94],")",")",";",["T_WHITESPACE","\n\n\t\t\t",94],["T_VARIABLE","$this",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","filename",96],["T_WHITESPACE"," ",96],"=",["T_WHITESPACE"," ",96],["T_VARIABLE","$attachment",96],["T_OBJECT_OPERATOR","->",96],["T_STRING","post_title",96],";",["T_WHITESPACE","\n\t\t\t",96],["T_VARIABLE","$this",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","package",97],["T_WHITESPACE"," ",97],"=",["T_WHITESPACE"," ",97],["T_STRING","get_attached_file",97],"(",["T_WHITESPACE"," ",97],["T_VARIABLE","$attachment",97],["T_OBJECT_OPERATOR","->",97],["T_STRING","ID",97],["T_WHITESPACE"," ",97],")",";",["T_WHITESPACE","\n\t\t",97],"}",["T_WHITESPACE"," ",98],["T_ELSE","else",98],["T_WHITESPACE"," ",98],"{",["T_WHITESPACE","\n\t\t\t",98],["T_COMMENT","\/\/ Else, It's set to something, Back compat for plugins using the old (pre-3.3) File_Uploader handler.\n",99],["T_WHITESPACE","\t\t\t",100],["T_IF","if",100],["T_WHITESPACE"," ",100],"(",["T_WHITESPACE"," ",100],"!",["T_WHITESPACE"," ",100],"(",["T_WHITESPACE"," ",100],"(",["T_WHITESPACE"," ",100],["T_VARIABLE","$uploads",100],["T_WHITESPACE"," ",100],"=",["T_WHITESPACE"," ",100],["T_STRING","wp_upload_dir",100],"(",")",["T_WHITESPACE"," ",100],")",["T_WHITESPACE"," ",100],["T_BOOLEAN_AND","&&",100],["T_WHITESPACE"," ",100],["T_STRING","false",100],["T_WHITESPACE"," ",100],["T_IS_IDENTICAL","===",100],["T_WHITESPACE"," ",100],["T_VARIABLE","$uploads",100],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",100],"]",["T_WHITESPACE"," ",100],")",["T_WHITESPACE"," ",100],")",["T_WHITESPACE","\n\t\t\t\t",100],["T_STRING","wp_die",101],"(",["T_WHITESPACE"," ",101],["T_VARIABLE","$uploads",101],"[",["T_CONSTANT_ENCAPSED_STRING","'error'",101],"]",["T_WHITESPACE"," ",101],")",";",["T_WHITESPACE","\n\n\t\t\t",101],["T_VARIABLE","$this",103],["T_OBJECT_OPERATOR","->",103],["T_STRING","filename",103],["T_WHITESPACE"," ",103],"=",["T_WHITESPACE"," ",103],["T_STRING","sanitize_file_name",103],"(",["T_WHITESPACE"," ",103],["T_VARIABLE","$_GET",103],"[",["T_WHITESPACE"," ",103],["T_VARIABLE","$urlholder",103],["T_WHITESPACE"," ",103],"]",["T_WHITESPACE"," ",103],")",";",["T_WHITESPACE","\n\t\t\t",103],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","package",104],["T_WHITESPACE"," ",104],"=",["T_WHITESPACE"," ",104],["T_VARIABLE","$uploads",104],"[",["T_CONSTANT_ENCAPSED_STRING","'basedir'",104],"]",["T_WHITESPACE"," ",104],".",["T_WHITESPACE"," ",104],["T_CONSTANT_ENCAPSED_STRING","'\/'",104],["T_WHITESPACE"," ",104],".",["T_WHITESPACE"," ",104],["T_VARIABLE","$this",104],["T_OBJECT_OPERATOR","->",104],["T_STRING","filename",104],";",["T_WHITESPACE","\n\n\t\t\t",104],["T_IF","if",106],["T_WHITESPACE"," ",106],"(",["T_WHITESPACE"," ",106],["T_LNUMBER","0",106],["T_WHITESPACE"," ",106],["T_IS_NOT_IDENTICAL","!==",106],["T_WHITESPACE"," ",106],["T_STRING","strpos",106],"(",["T_WHITESPACE"," ",106],["T_STRING","realpath",106],"(",["T_WHITESPACE"," ",106],["T_VARIABLE","$this",106],["T_OBJECT_OPERATOR","->",106],["T_STRING","package",106],["T_WHITESPACE"," ",106],")",",",["T_WHITESPACE"," ",106],["T_STRING","realpath",106],"(",["T_WHITESPACE"," ",106],["T_VARIABLE","$uploads",106],"[",["T_CONSTANT_ENCAPSED_STRING","'basedir'",106],"]",["T_WHITESPACE"," ",106],")",["T_WHITESPACE"," ",106],")",["T_WHITESPACE"," ",106],")",["T_WHITESPACE"," ",106],"{",["T_WHITESPACE","\n\t\t\t\t",106],["T_STRING","wp_die",107],"(",["T_WHITESPACE"," ",107],["T_STRING","__",107],"(",["T_WHITESPACE"," ",107],["T_CONSTANT_ENCAPSED_STRING","'Please select a file'",107],["T_WHITESPACE"," ",107],")",["T_WHITESPACE"," ",107],")",";",["T_WHITESPACE","\n\t\t\t",107],"}",["T_WHITESPACE","\n\t\t",108],"}",["T_WHITESPACE","\n\t",109],"}",["T_WHITESPACE","\n\n\t",110],["T_DOC_COMMENT","\/**\n\t * Delete the attachment\/uploaded file.\n\t *\n\t * @since 3.2.2\n\t * @access public\n\t *\n\t * @return bool Whether the cleanup was successful.\n\t *\/",112],["T_WHITESPACE","\n\t",119],["T_PUBLIC","public",120],["T_WHITESPACE"," ",120],["T_FUNCTION","function",120],["T_WHITESPACE"," ",120],["T_STRING","cleanup",120],"(",")",["T_WHITESPACE"," ",120],"{",["T_WHITESPACE","\n\t\t",120],["T_IF","if",121],["T_WHITESPACE"," ",121],"(",["T_WHITESPACE"," ",121],["T_VARIABLE","$this",121],["T_OBJECT_OPERATOR","->",121],["T_STRING","id",121],["T_WHITESPACE"," ",121],")",["T_WHITESPACE","\n\t\t\t",121],["T_STRING","wp_delete_attachment",122],"(",["T_WHITESPACE"," ",122],["T_VARIABLE","$this",122],["T_OBJECT_OPERATOR","->",122],["T_STRING","id",122],["T_WHITESPACE"," ",122],")",";",["T_WHITESPACE","\n\n\t\t",122],["T_ELSEIF","elseif",124],["T_WHITESPACE"," ",124],"(",["T_WHITESPACE"," ",124],["T_STRING","file_exists",124],"(",["T_WHITESPACE"," ",124],["T_VARIABLE","$this",124],["T_OBJECT_OPERATOR","->",124],["T_STRING","package",124],["T_WHITESPACE"," ",124],")",["T_WHITESPACE"," ",124],")",["T_WHITESPACE","\n\t\t\t",124],["T_RETURN","return",125],["T_WHITESPACE"," ",125],"@",["T_STRING","unlink",125],"(",["T_WHITESPACE"," ",125],["T_VARIABLE","$this",125],["T_OBJECT_OPERATOR","->",125],["T_STRING","package",125],["T_WHITESPACE"," ",125],")",";",["T_WHITESPACE","\n\n\t\t",125],["T_RETURN","return",127],["T_WHITESPACE"," ",127],["T_STRING","true",127],";",["T_WHITESPACE","\n\t",127],"}",["T_WHITESPACE","\n",128],"}",["T_WHITESPACE","\n",129]]